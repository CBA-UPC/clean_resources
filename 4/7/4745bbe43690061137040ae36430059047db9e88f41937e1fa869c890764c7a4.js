(function(e,t){'use strict';var i=function(t){e._aries=e._aries||{},e._aries.ima=e._aries.ima||{constructor:this.constructor,registry:{}};var a=parseInt(1e10*Math.random());e._aries.ima.registry[a]={},this._registry=e._aries.ima.registry[a],this._config=t,_.call(this),g.call(this),this._log("start initialization"),this._log("config:",t),e._aries.ugs=e._aries.ugs||{constructor:E,registry:{}},e._aries.ugs.registry.instance=e._aries.ugs.registry.instance||new E,this._ugs=e._aries.ugs.registry.instance,e._aries.cssMap=e._aries.cssMap||{constructor:v,registry:{}},e._aries.cssMap.registry.instance=e._aries.cssMap.registry.instance||new v,this._cssMap=e._aries.cssMap.registry.instance,this._clarifyClientDetails(),this._clientDetails.invocation.method===i.CLIENT_DETAILS.invocation.methods.iframe&&"enabled"===this._config.adSlot.stage.proscenium.stylesMirroring&&this._createAspectRatioElements();var n=function(){if(""!==this._config.adSlot.placement.targetNode||e.Mercury){clearInterval(r),this._adSlot=this._adSlot||new o(this);var t=function(){e.VASTClient&&"undefined"!=typeof this._adSlot.getReferenceNode()&&e.google&&e.google.ima&&(clearInterval(i),this._playback||(this._playback=new l(this),this.emit(new u("loaded"))))}.bind(this);t();var i=setInterval(t,50)}}.bind(this);n();var r=setInterval(n,50);this._log("finish initialization")};i.PREFIX="aries_",i.CLIENT_DETAILS={invocation:{methods:{direct:0,iframe:1}},autoplay:{notSupports:0,muted:1,unmuted:2}},i.prototype._clarifyClientDetails=function(){this._log("start clarifying client details");var t=e.top===e;if(!t){for(var o=[],a=e.frameElement;a&&(o.push(a),a=a.ownerDocument.defaultView.frameElement,!!a););var n=o[o.length-1]}this._clientDetails={invocation:{method:i.CLIENT_DETAILS.invocation.methods[t?"direct":"iframe"],baseElement:n,frameAncestorsHierarchy:o}},this._detectVideoAutoPlaySupport(),this.once("autoPlaySupportClarified",bind(this))},i.prototype._createAspectRatioElements=function(){this._clientDetails.invocation.frameAncestorsHierarchy.forEach(function(e){var i=t.createElement("img");i.style.width="100%",i.style.height="100%",i.style.opacity=0,i.style.display="none",e.insertAdjacentElement("beforebegin",i)})},i.prototype.setFrameAspectRatio=function(e,t){if(this._clientDetails.invocation.method===i.CLIENT_DETAILS.invocation.methods.iframe&&"enabled"===this._config.adSlot.stage.proscenium.stylesMirroring){var o=this._clientDetails.invocation.frameAncestorsHierarchy;o.forEach(function(i){var o=i.previousElementSibling;parseInt(o.style.maxWidth)?o.style.setProperty("max-width",t.width+"px","important"):o.dataset.maxWidth=t.width+"px",parseInt(o.style.maxHeight)?o.style.setProperty("max-height",t.height+"px","important"):o.dataset.maxHeight=t.height+"px",o.src=e.src})}},i.prototype._detectVideoAutoPlaySupport=function(){var e=function(e){var i=t.createElement("video");return i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline",""),i.playsinline=!0,i.webkitPlaysinline=!0,e&&(i.setAttribute("muted",""),i.muted=!0),new Promise(.catch(function(){}),Promise.resolve(!i.paused)};e(!0).then(function(t){t?e().then(function(e){e?(this._clientDetails.autoplay=i.CLIENT_DETAILS.autoplay.unmuted,this._info("any form of autoplay is supported")):(this._clientDetails.autoplay=i.CLIENT_DETAILS.autoplay.muted,this._info("only muted autoplay is supported")),this.emit(new u("autoPlaySupportClarified"))}.bind(this)):(this._clientDetails.autoplay=i.CLIENT_DETAILS.autoplay.notSupports,this._info("autoplay in any form is not supported"),this.emit(new u("autoPlaySupportClarified")))}.bind(this))},i.prototype.getRegistry=function(){return this._registry},i.prototype.getConfig=function(){return this._config},i.prototype.getUGS=i.prototype.getCssMap=function(){return this._cssMap},i.prototype.getClientDetails=function(){return this._clientDetails},i.prototype.getAdSlot=function(){return this._adSlot},i.prototype.getPlayback=function(){return this._playback},i.prototype.destroy=function(){var e=this._adSlot.getStage().getProscenium(),t=function(){this.off(),this._playback.destroy(function(){var e=this._adSlot.getStage().getElement();e.parentNode&&e.parentNode.removeChild(e)}.bind(this))}.bind(this);return"collapsed"===e.getState()?void t():void(e.getElement().addEventListener("transitionend",t),e.setState("collapsed"))};var o=function(e){this._ima=e,g.call(this),this._log("start initialization"),this._config=e.getConfig().adSlot,this._log("config:",this._config),this._log("trying to retrieve element "+this._config.selector),this._retrieveSlot(this._config.placement.targetNode,function(){this._stage=new a(this)}.bind(this)),this._log("finish initialization")};o.prototype._retrieveSlot=function(i,o){if(!this._targetNode){if("string"==typeof i){if(""===i)return void e.Mercury.getContentNode().then(function(e){var t=this.getElementXPath(e),i=this._config.placement.cachingEndpoint.replace(/(?:(\{zoneid\})|(\{selector\:base64\})|(\{referer\}))/gm,function(e){return"{zoneid}"===e?this._ima.getConfig().analytics.placementID:"{selector:base64}"===e?btoa(t):"{referer}"===e?encodeURIComponent(location.href):void 0});new Image().src=i,this._config.placement.targetNode=e,this._retrieveSlot(e,o)}.bind(this));if(~i.indexOf("||")){var a=!1,n=o;o=var r=i.split("||");return void r.forEach(bind(this))}var s=this._config.placement.context||t,l="/"===i.substring(0,1)?this.getElementsByXPath(s,i)[0]:s.querySelectorAll(i)[0];if(l)this._targetNode=l;else return void setTimeout(this._retrieveSlot.bind(this,i,o),50)}else this._targetNode=i;this._retrieveReferenceNode(),this._log("element successfully retrieved"),o()}},o.prototype.getElementXPath=function(e){return e&&e.id?"//*[@id=\""+e.id+"\"]":this.getElementTreeXPath(e)},o.prototype.getElementTreeXPath=function(e){for(var t=[];e&&e.nodeType==Node.ELEMENT_NODE;e=e.parentNode){for(var i=0,o=!1,a=e.previousSibling;a;a=a.previousSibling)a.nodeType!=Node.DOCUMENT_TYPE_NODE&&a.nodeName==e.nodeName&&++i;for(var n=e.nextSibling;n&&!o;n=n.nextSibling)n.nodeName==e.nodeName&&(o=!0);var r=(e.prefix?e.prefix+":":"")+e.localName,s=i||o?"["+(i+1)+"]":"";t.splice(0,0,r+s)}return t.length?"/"+t.join("/"):null},o.prototype.getElementsByXPath=function(e,t){try{return this.evaluateXPath(e,t)}catch(e){return[]}},o.prototype.evaluateXPath=function(e,t,o,a){o===void 0&&(o=e),a===void 0&&(a=XPathResult.ANY_TYPE);var n=e.evaluate(t,o,null,a,null),r=[];switch(n.resultType){case XPathResult.NUMBER_TYPE:return n.numberValue;case XPathResult.STRING_TYPE:return n.stringValue;case XPathResult.BOOLEAN_TYPE:return n.booleanValue;case XPathResult.UNORDERED_NODE_ITERATOR_TYPE:case XPathResult.ORDERED_NODE_ITERATOR_TYPE:for(var s=n.iterateNext();s;s=n.iterateNext())r.push(s);return r;case XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:case XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:for(var l=0;l<n.snapshotLength;++l)r.push(n.snapshotItem(l));return r;case XPathResult.ANY_UNORDERED_NODE_TYPE:case XPathResult.FIRST_ORDERED_NODE_TYPE:return n.singleNodeValue;}},o.prototype._retrieveReferenceNode=function(){var e=this._config.placement.position;if(e.constant){if("latest"===e.constant.beforeChild)this._referenceNode=null;else{var t="last"===e.constant.beforeChild?this._targetNode.childNodes.length-1:Math.min(this._targetNode.childNodes.length-1,+e.constant.beforeChild);this._referenceNode=this._targetNode.childNodes[t]||null}}else if(e.inViewport)var i=setInterval(function(){var t=Array.prototype.slice.call(this._targetNode.children).filter(;if(0<t.length){if(clearInterval(i),"latest"===e.inViewport)return void(this._referenceNode=t[t.length-1].nextSibling);var o="last"===e.inViewport.beforeChild?t.length-1:Math.min(0,t.length-1,+e.inViewport.beforeChild);this._referenceNode=t[o]||null}}.bind(this),50)},o.prototype.getIMA=function(){return this._ima},o.prototype.getConfig=function(){return this._config},o.prototype.getTargetNode=function(){return this._targetNode},o.prototype.getReferenceNode=function(){return this._referenceNode},o.prototype.getStage=function(){return this._stage};var a=function(e){this._adSlot=e,this._ima=e.getIMA(),g.call(this),_.call(this),this._log("start initialization"),this._config=e.getConfig().stage,this._log("config:",this._config),this._invocationDetails=this._ima.getClientDetails().invocation,this._createElement(),new h(this._config.properties,a._propertiesHandlers).applyTo(this),this._proscenium=new n(this),this._log("finish initialization")};a._propertiesHandlers={stretched:function(){this._element.classList.add(i.PREFIX+"stretched"),this._log("apply \"stretched\" property");var t=this._adSlot.getTargetNode();/absolute|relative|fixed|sticky/i.test(e.getComputedStyle(t).position)||(t.style.position="relative",this._log("add relative position to ad slot:",t.attributes.style))},filled:function(e,t){this._element.style.backgroundColor=t.color,this._log("apply \"filled\" property, color - "+t.color)},fixed:function(e,t){var o=+t.margin[0]||0,a=+t.margin[1]||0,n=t.position.split(" ");this._element.style.cssText+=[{left:"left: "+o+"px; right: auto;",center:"right: 50%; transform: translateX(50%); left: auto;",right:"right: "+o+"px; left: auto;"}[n[0]],{top:"top: "+a+"px; bottom: auto;",center:"bottom: 50%; transform: translateY(50%); top: auto;",bottom:"bottom: "+a+"px; top: auto;"}[n[1]]].join(" "),"center"===n[0]&&"center"===n[1]&&(this._element.style.transform="translate(50%, 50%)"),this._element.classList.add(i.PREFIX+"fixed"),"left"===n[0]&&this._element.classList.add(i.PREFIX+"expandToRight"),this._log("apply \"fixed\" property, position - "+t.position),e.defineDestroy(function(){this._element.classList.remove(i.PREFIX+"fixed"),this._element.style.top=null,this._element.style.right=null,this._element.style.bottom=null,this._element.style.left=null,this._element.style.transform=null}.bind(this))},sticky:function(o,n){if(n.condition()){var r,s=!1;this._ima.once("loaded",function(){var o;this._invocationDetails.method===i.CLIENT_DETAILS.invocation.methods.iframe?(r=t.createElement("div"),this._invocationDetails.baseElement.parentNode.insertAdjacentElement("beforebegin",r),o=r):o=this._ima.getAdSlot().getTargetNode(),e.inViewWindow=o.ownerDocument.defaultView;var a=e.inView();this._ima.getPlayback().once("AdStarted",function(){if(n.offset){var e,t,i=n.offset.split(" "),r=this._element.getBoundingClientRect(),l=function(e,t){var i=r["vertical"===t?"height":"width"],o=e.split("%");if(1<o.length){var a=o[0]/100,n=+(o[1]||0);return i*a+n}return e};1===i.length?(e=l(i[0],"horizontal"),t=l(i[0],"vertical"),a.offset({top:-1*t,right:-1*e,bottom:-1*t,left:-1*e})):2===i.length?(e=l(i[1],"horizontal"),t=l(i[0],"vertical"),a.offset({top:-1*t,right:-1*e,bottom:-1*t,left:-1*e})):a.offset({top:-1*l(i[0],"vertical"),right:-1*l(i[1],"horizontal"),bottom:-1*l(i[2],"vertical"),left:-1*l(i[3],"horizontal")})}var d=0;a(o).on("enter",,a(o).on("exit",function(){s||"disabled"!==n.stickOnlyOnce&&("enabled"!==n.stickOnlyOnce||0!==d)||(s=!0,d++,m())}),a.is(o)||(s=!0,d++,m()),this._configureUiElements=g,this._enableSticky=m,this._disableSticky=y}.bind(this)),this._destroySticky=function(){a(o).once("enter",,a(o).off("exit",m)}.bind(this),this._ima.once("complete",this._destroySticky)}.bind(this));var l,p,c,_={defineDestroy:,g=function(e){if("enable"===e){var t=n.reconfigure.adSlot.stage.proscenium.uiElements;if(!t)return;var o=this._proscenium.getUIElements();if(!o)return;var a,r=o.getElements(),s=this._config.proscenium.uiElements;s.controls.close&&t.controls.close&&(a=t.controls.close,a.position=s.controls.close.position,r.closeControl.style.width=t.controls.close.size+"px",r.closeControl.style.height=t.controls.close.size+"px",r.closeControl.classList[t.controls.close.visible?"remove":"add"](i.PREFIX+"hidden"),o.setPosition(r.closeControl,t.controls.close)),s.controls.volume&&t.controls.volume&&(a=t.controls.volume,a.position=s.controls.volume.position,r.volumeControl.style.width=t.controls.volume.size+"px",r.volumeControl.style.height=t.controls.volume.size+"px"),s.caption&&t.caption&&(a=t.caption,a.position=s.caption.position,r.caption.style.fontSize=t.caption.fontSize+"px",o.setPosition(r.caption,t.caption)),s.brandIcon&&t.brandIcon&&(a=t.brandIcon,a.position=s.brandIcon.position,r.brandIcon.style.width=t.brandIcon.height+"px",r.brandIcon.style.height=t.brandIcon.height+"px",o.setPosition(r.brandIcon,t.brandIcon)),o.setMargins()}else{var l=this._config.proscenium.uiElements;if(!l)return;var o=this._proscenium.getUIElements();if(!o)return;var r=o.getElements();if(l.controls.close){r.closeControl.style.width=l.controls.close.size+"px",r.closeControl.style.height=l.controls.close.size+"px";var d=l.controls.close.visible&&l.controls.close.isAppeared;r.closeControl.classList[d?"remove":"add"](i.PREFIX+"hidden"),o.setPosition(r.closeControl,l.controls.close)}l.controls.volume&&(r.volumeControl.style.width=l.controls.volume.size+"px",r.volumeControl.style.height=l.controls.volume.size+"px"),l.caption&&(r.caption.style.fontSize=l.caption.fontSize+"px",o.setPosition(r.caption,l.caption)),l.brandIcon&&(r.brandIcon.style.width=l.brandIcon.height+"px",r.brandIcon.style.height=l.brandIcon.height+"px",o.setPosition(r.brandIcon,l.brandIcon)),o.setMargins()}}.bind(this),m=function(){if(e.__vidvertoDisableSticky&&e.__vidvertoDisableSticky(),this._stickyEnabled=!0,e.__vidvertoDisableSticky=this.__disableSticky,clearTimeout(p),this._adSlot.getTargetNode().style.height=this._adSlot.getTargetNode().getBoundingClientRect().height+"px",a._propertiesHandlers.fixed.call(this,_,n.reconfigure.adSlot.stage.properties.fixed),this._element.classList.remove(i.PREFIX+"horizontalAxis"),this._element.classList.add(i.PREFIX+"verticalAxis",i.PREFIX+"sticky"),this._proscenium.getElement().style.margin=0,n.reconfigure.adSlot.stage.proscenium.maxDimensions){var t=n.reconfigure.adSlot.stage.proscenium.maxDimensions.width,o=n.reconfigure.adSlot.stage.proscenium.maxDimensions.height;this._proscenium.getElement().style.maxWidth=t+"px",this._proscenium.getElement().style.maxHeight=o+"px";try{var r,s=this._ima.getPlayback()._activeAd._videoPlayer._aspectRatioElement.getBoundingClientRect(),l=s.width/s.height;r=t/o>=l?{width:o*l,height:o}:{width:t,height:t/l},this._ima.getPlayback().getAdUnit().resizeAd(r.width,r.height,"normal")}catch(t){}var c=this._ima.getPlayback().getNaturalVideo();if(c){var m=c.getAspectRatio(),y=n.reconfigure.adSlot.stage.proscenium.maxDimensions.width;c._createAspectRatioEl(y,y/m)}}g("enable")}.bind(this),y=function(){if(this._stickyEnabled){this._stickyEnabled=!1,e.__vidvertoDisableSticky=void 0,p=setTimeout(bind(this),1e3),l&&l(),this._element.classList.remove(i.PREFIX+"verticalAxis",i.PREFIX+"sticky"),this._element.classList.add(i.PREFIX+"horizontalAxis");var t=this._config.proscenium.maxDimensions.width,o=this._config.proscenium.maxDimensions.height;this._proscenium.getElement().style.maxWidth=t?t+"px":"initial",this._proscenium.getElement().style.maxHeight=o?o+"px":"initial";try{var a=this._ima.getPlayback()._activeAd._dimensions;this._ima.getPlayback().getAdUnit().resizeAd(a.width,a.height,"normal")}catch(t){}var n=this._ima.getPlayback().getNaturalVideo();if(n){var r=n.getAspectRatio(),s=this._config.proscenium.maxDimensions.width;n._createAspectRatioEl(s,s/r)}g("disable")}}.bind(this);if(n.unstickDelay){var h=m,u=y,f=+n.reconfigure.adSlot.stage.properties.fixed.margin[1]||0;m=function(){s=!0,c=setTimeout(y,1e3*n.unstickDelay);var e=Math.ceil(this._element.getBoundingClientRect().height);n.reconfigure.adSlot.stage.properties.fixed.margin[1]=-e+f,h(),requestAnimationFrame(function(){requestAnimationFrame(function(){this._element.style.transition="top 0.2s ease 0s",this._element.style.top=f+"px",this._element.style.width="100%",this._element.style.background="#000"}.bind(this))}.bind(this))}.bind(this),y=function(){s=!1,clearTimeout(c);var e=Math.ceil(this._element.getBoundingClientRect().height);this._element.style.transition="top 0.2s ease 0s",this._element.style.top=-e+f+"px",this._element.style.width="auto",this._element.style.background="initial",setTimeout(u,200)}.bind(this)}}},parallax:function(i,o){this._ima.once("loaded",function(){this._ima.getPlayback().once("AdStarted",function(){var i,a=t.documentElement.clientHeight,n=a/2+o.initialOffset,r=this._element,s=this.getProscenium().getVideoWrapper(),l=this._ima.getCssMap().getRules(s).transform,d=function(){if(!(i&&25>Date.now()-i)){i=Date.now();var e=r.getBoundingClientRect().height,t=r.getBoundingClientRect().top,o=e/2+t-a/2;s.style.transform=(l||"")+" translateY("+-1*(o/(a/2/n)-o)/2+"px)"}}.bind(this),p=function(){e.addEventListener("scroll",d)};e.inViewWindow=this._invocationDetails.baseElement.ownerDocument.defaultView;var c=e.inView();c(r).on("enter",p),c(r).on("exit",,c.is(r)&&(p(),d())}.bind(this))}.bind(this))}},a.prototype._createElement=function(){this._element=t.createElement("div"),this._element.classList.add(i.PREFIX+"stage",i.PREFIX+this._config.mainAxis+"Axis");var e=t.createElement("div");e.appendChild(this._element),this._adSlot.getTargetNode().insertBefore(e,this._adSlot.getReferenceNode()),this._adSlot._targetNode=e,this._log("create element:",this._element),this._invocationDetails.baseElement=this._invocationDetails.baseElement||this._element},a.prototype.getAdSlot=function(){return this._adSlot},a.prototype.getIMA=function(){return this._ima},a.prototype.getConfig=function(){return this._config},a.prototype.getElement=function(){return this._element},a.prototype.getProperties=function(){return this._properties},a.prototype.getProscenium=function(){return this._proscenium},a.prototype.destroy=function(e){this._element.parentNode.removeChild(this._element),e()};var n=function(e){this._stage=e,this._ima=e.getIMA(),_.call(this),g.call(this),this._log("start initialization"),this._config=e.getConfig().proscenium,this._log("config:",this._config),this._createElement(),new h(this._config.properties,n._propertiesHandlers).applyTo(this),this._log("finish initialization")};n._propertiesHandlers={stretched:function(){this._element.classList.add(i.PREFIX+"stretched"),this._log("apply \"stretched\" property")},filled:a._propertiesHandlers.filled,animated:function(e,t){var o=function(e){var o="beforeExpanded"===e.getName()?"in":"out",a="beforeExpanded"===e.getName()?"out":"in";t[a]&&t[a].type&&this._element.classList.remove(i.PREFIX+t[a].type+"Animation");t[o]&&t[o].type&&(this._element.classList.add(i.PREFIX+t[o].type+"Animation"),this._element.style.transitionDuration=t[o].duration+"s",this._element.style.transitionTimingFunction=t[o].timingFunction)};this.once("beforeExpanded",o,this),this.once("beforeCollapsed",o,this),e.defineDestroy(function(){this.off("beforeExpanded",o,this),this.off("beforeCollapsed",o,this)}.bind(this)),this._log("apply \"animated\" property")},pullOut:function(e,t){this._stage.getElement().style.maxHeight=0;var i={offset:t.offset,unitEl:this._stage.getElement()},o=new r(i);this._ima.once("loaded",function(){var e=this._ima.getPlayback();e.on("AdLoaded",function(){var t=e._activeAd||e._preloadedAds[0];o.setMaxHeight(t.getDimensions().height),o.observeUnitPosition()}.bind(this))}.bind(this))}},n.prototype._createElement=function(){this._element=t.createElement("div"),this._element.classList.add(i.PREFIX+"proscenium"),this._stage.getElement().appendChild(this._element),this._log("create element:",this._element),this._enableStylesMirroring(),this._prepareState(),this._setBoundaryDimensions(),this._setPosition(),this._createVideoWrapper(),this._createUIElements(),this._calculateMaxDimensions()},n.prototype._enableStylesMirroring=function(){if("enabled"===this._config.stylesMirroring){var e=this._ima.getClientDetails().invocation;if(e.method===i.CLIENT_DETAILS.invocation.methods.iframe&&e.frameAncestorsHierarchy.length){var t=["display","z-index","width","height","font-size","top","right","bottom","left","position"],o=["display","top","right","bottom","left","transform"],a=["max-width","max-height","margin","margin-top","margin-right","margin-bottom","margin-left","transition-duration","transition-timing-function","transition-property"],n={top:!0,right:!0,bottom:!0,left:!0},r=new MutationObserver(function(){if(this._stage.getElement().ownerDocument.contains(this._stage.getElement())){var i=this._ima.getCssMap().getRules(this._stage.getElement()),r=this._ima.getCssMap().getRules(this._element);e.frameAncestorsHierarchy.forEach(function(s,l){s.style.setProperty("position","absolute","important"),s.style.setProperty("width","100%","important"),s.style.setProperty("height","100%","important"),s.style.setProperty("border","0","important");var d=this._stage.getProperties().hasProperty("fixed")?"fixed":"relative";s.parentNode.style.setProperty("position",d,"important"),t.forEach(function(t){if("undefined"!=typeof i[t]||~["top","right","bottom","left"].indexOf(t)){if(~["top","right","bottom","left"].indexOf(t)){if(l!==e.frameAncestorsHierarchy.length-1)return;if(!n[t])return void(n[t]=!0);if("auto"===this._stage.getElement().style[t])return;this._stage.getElement().style[t]="auto",n[t]=!1}var o="undefined"==typeof i[t]?"auto":i[t].split("!important")[0];s.parentNode.style.setProperty(t,o,"important")}}.bind(this)),o.forEach(function(e){"undefined"==typeof r[e]||s.style.setProperty(e,r[e].split("!important")[0],"important")}),a.forEach(function(e){return parseInt(r[e])&&("max-width"===e&&s.previousElementSibling.dataset.maxWidth||"max-height"===e&&s.previousElementSibling.dataset.maxHeight)?void s.previousElementSibling.style.setProperty(e,s.previousElementSibling.dataset["max-width"===e?"maxWidth":"maxHeight"],"important"):void("undefined"==typeof r[e]||s.previousElementSibling.style.setProperty(e,r[e].split("!important")[0],"important"))})}.bind(this))}}.bind(this)),s={attributes:!0,attributeFilter:["style","class","id"]};r.observe(this._stage.getElement(),s),r.observe(this._element,s)}}},n.prototype._prepareState=function(){this.on("beforeExpanded",function(){this._stage.getElement().style.visibility="initial",this._element.style.opacity=1}.bind(this)),this.on("expanded",function(){this._element.style.overflow="initial"},this),this.on("beforeCollapsed",bind(this)),this._element.addEventListener("transitionend",function(){this.emit(new u(this._state))}.bind(this)),this._config.properties.animated||this.on(["beforeExpanded","beforeCollapsed"],this),this.setState(this._config.states.initial,!0)},n.prototype._setBoundaryDimensions=function(){this._config.maxDimensions.width&&(this._element.style.maxWidth=this._config.maxDimensions.width+"px"),this._config.maxDimensions.height&&(this._element.style.maxHeight=this._config.maxDimensions.height+"px")},n.prototype._setPosition=function(){var e=this._config.position.split(" "),t=i.PREFIX+("center"===e[0]?"hcenter":e[0]),o=i.PREFIX+("center"===e[1]?"vcenter":e[1]);this._element.classList.add(t,o)},n.prototype._createVideoWrapper=function(){var e=t.createElement("div");e.classList.add(i.PREFIX+"videoWrapper"),this._element.appendChild(e),this._videoWrapper=e},n.prototype._createUIElements=function(){this._ima.once("loaded",function(){this._ima.getPlayback().once("AdStarted",bind(this))}.bind(this))},n.prototype._calculateMaxDimensions=function(){var o=this._ima.getClientDetails(),a=this._config.minDimensions;if(this._stage.getProperties().hasProperty("fixed")){var n=o.invocation.method===i.CLIENT_DETAILS.invocation.methods.iframe?o.invocation.baseElement.ownerDocument:t,r=n.documentElement.clientWidth,s=n.documentElement.clientHeight;return this._maxDimensions={width:Math.min(this._config.maxDimensions.width||1/0,a.width>r?1/0:r),height:Math.min(this._config.maxDimensions.height||1/0,a.height>s?1/0:s)},void this.emit(new u("maxDimensionsCalculated"))}for(var l=o.invocation.baseElement,d={width:0,height:0};l;){var p=parseInt(e.getComputedStyle(l).width),c=parseInt(e.getComputedStyle(l).height);if(d={width:!d.width&&p>=a.width?p:d.width,height:!d.height&&c>=a.height?c:d.height},d.width&&d.height)break;l=l.parentElement}this._maxDimensions={width:Math.min(this._config.maxDimensions.width||1/0,d.width||1/0),height:Math.min(this._config.maxDimensions.height||1/0,d.height||1/0)},this.emit(new u("maxDimensionsCalculated"))},n.prototype.createResizeObserver=function(){var e=t.createElement("iframe");e.classList.add(i.PREFIX+"resizeObserver"),this._element.insertAdjacentElement("beforebegin",e);var o=e.document||e.contentDocument||e.contentWindow.document,a=o.getElementsByTagName("body")[0];a.style.padding=0,a.style.margin=0,o.defaultView.addEventListener("resize",function(){var t=e.getBoundingClientRect();this.emit(new u("resize",t))}.bind(this))},n.prototype.getIMA=function(){return this._ima},n.prototype.getConfig=function(){return this._config},n.prototype.getElement=function(){return this._element},n.prototype.getVideoWrapper=function(){return this._videoWrapper},n.prototype.getMaxDimensions=function(){return this._maxDimensions},n.prototype.getUIElements=function(){return this._uiElements},n.prototype.getState=function(){return this._state},n.prototype.setState=function(e,t){this._state=e,t&&"expanded"!==e||this.emit(new u("before"+e.charAt(0).toUpperCase()+e.slice(1)));var o="collapsed"===e?"add":"remove";this._element.classList[o](i.PREFIX+"collapsed")},n.prototype.getProperties=function(){return this._properties},n.prototype.destroy=function(e){this._element.parentNode.removeChild(this._element),e()};var r=function(e){this._config=e,this._unit=e.unitEl,this._defineInitialValues(),this._setUpScrollingInterceptor()};r.CONST={POSITION:{ABOVE:"above",INSIDE:"inside",BELOW:"below"}},r.prototype._defineInitialValues=function(){this._clientHeight=t.documentElement.clientHeight,this._unitMaxHeight=parseFloat(this._unit.style.maxHeight)||0},r.prototype._setUpScrollingInterceptor=function(){this._scrollingInterceptor=new S,this._scrollingInterceptor.on("scroll",this._onScroll.bind(this)),this._scrollingInterceptor.on("scroll:"+S.CONST.STATUS.INTERCEPTED,this._onInterceptedScroll.bind(this))},r.prototype._onScroll=r.prototype._onInterceptedScroll=r.prototype._canExpand=function(e){if(!this._scrollingParameters)return!1;var t=this._scrollingParameters.direction.y===A.CONST.DIRECTION.Y.DOWN,i=A.CONST.EDGE[t?"BOTTOM":"TOP"],o=this._windowScrollingHandler.inViewport(this._unit,i,this._config.offset),a=this._unitMaxHeight<this._config.maxHeight;return this._checkThreshold()&&(!e||e===i)&&o&&a},r.prototype._checkThreshold=function(){var e=this._scrollingParameters.direction.y===A.CONST.DIRECTION.Y.DOWN,t=this._unit.getBoundingClientRect().top,i=this._unit.getBoundingClientRect().height,o=t+i>this._config.maxHeight/2,a=t+this._config.maxHeight/2<this._clientHeight;return e?o:a},r.prototype._expandUnit=function(){var e=this._unitMaxHeight+this._scrollingParameters.delta.y>this._config.maxHeight?this._config.maxHeight-this._unitMaxHeight:this._scrollingParameters.delta.y;this._unitMaxHeight+=e,this._unit.style.maxHeight=this._unitMaxHeight+"px",this._scrollingParameters.direction.y===A.CONST.DIRECTION.Y.DOWN&&this._windowScrollingHandler.increaseScroll({x:0,y:e})},r.prototype._onEnterViewport=function(e){var t=e.getData();this._canExpand(t)&&this._scrollingInterceptor.intercept()},r.prototype.observeUnitPosition=function(){this._windowScrollingHandler=new A(e),this._windowScrollingHandler.observeViewportIntersection(this._unit,this._config.offset),this._windowScrollingHandler.observeMotionInViewport(this._unit,this._config.offset),this._windowScrollingHandler.on(["enter","motion"],this._onEnterViewport.bind(this))},r.prototype.setMaxHeight=var s=function(e){this._proscenium=e,this._ima=e.getIMA(),g.call(this),this._log("start initialization"),this._config=e.getConfig().uiElements,this._log("config:",this._config),this._createElement(),new h(this._config.properties,s._propertiesHandlers).applyTo(this),this._log("finish initialization")};s._propertiesHandlers={stretched:n._propertiesHandlers.stretched},s.prototype._createElement=function(){this._element=t.createElement("div"),this._element.classList.add(i.PREFIX+"uiElements"),this._proscenium.getElement().appendChild(this._element),this._log("create element:",this._element),this._uiElements={},this._createControls(),this._createBrandIcon(),this._createCaption(),this.setMargins()},s.prototype._createControls=function(){this._config.controls&&Object.keys(this._config.controls).forEach(function(e){var o=this._config.controls[e],a=t.createElement("div");a.classList.add(i.PREFIX+"controlIcon",i.PREFIX+e+"Control"),a.style.width=o.size+"px",a.style.height=o.size+"px",this._element.appendChild(a),this._uiElements[e+"Control"]=a,this.setPosition(a,o),this["_process"+e.charAt(0).toUpperCase()+e.slice(1)+"Control"](a,o)}.bind(this))},s.prototype._processCloseControl=function(e,t){t.inverse&&e.classList.add(i.PREFIX+"inverse");var o=function(e){e&&e.stopPropagation();var t=this._ima.getPlayback(),o=t.getAdUnit();if(t._naturalVideoStarted)t.getNaturalVideo().pause(),a._stickyEnabled||this._ima.destroy(new Function);else if(o.pauseAd(),!a._stickyEnabled)if(a.getProperties().hasProperty("fixed")&&a.getConfig().useSemiCollapse){a.getElement().classList.add(i.PREFIX+"semiCollapsed");var n=function(){a.getElement().removeEventListener("click",n),a.getElement().classList.remove(i.PREFIX+"semiCollapsed"),o.resumeAd()}.bind(this);a.getElement().addEventListener("click",n,!1)}else o.emitVPAIDEvent("AdClose"),this._ima.destroy(new Function);t._isPaused=!0,a._stickyEnabled&&a._disableSticky()}.bind(this),a=this._ima.getAdSlot().getStage();if(a.__disableSticky=o,e.classList.add(i.PREFIX+"hidden"),e.addEventListener("click",o),t.visible){var n=function(){e.classList.remove(i.PREFIX+"hidden"),t.isAppeared=!0};this._ima.once("loaded",function(){this._ima.getPlayback().once("AdLoaded",function(){this._closeControlAppearanceTimeout=setTimeout(n,1e3*t.appearanceDelay)}.bind(this))}.bind(this))}},s.prototype._processVolumeControl=function(e,t){e.classList.add(i.PREFIX+"mutedSpeaker"),this._addVolumeControlListeners(t)},s.prototype._addVolumeControlListeners=function(e){this._ima.once("loaded",function(){var e=!0,t="muted";this._ima.getPlayback().on("AdVolumeChange",function(){e=0===this._ima.getPlayback().getAdVolume();"muted"===t&&e||"unmuted"===t&&!e||(this._uiElements.volumeControl.classList.remove(i.PREFIX+t+"Speaker"),t=e?"muted":"unmuted",this._uiElements.volumeControl.classList.add(i.PREFIX+t+"Speaker"))}.bind(this))}.bind(this));var t=e.maxLevel||.3;this._uiElements.volumeControl.addEventListener("click",function(){var e=this._ima.getPlayback().getAdVolume();this._ima.getPlayback().setAdVolume(0<e?0:t,!0)}.bind(this))},s.prototype._createBrandIcon=function(){var e=this._config.brandIcon;if(e){var o=t.createElement("a");o.classList.add(i.PREFIX+"brandIcon"),o.style.width=e.height+"px",o.style.height=e.height+"px",o.href=this._config.brandIcon.url,o.target="_blank",this._element.appendChild(o),this._uiElements.brandIcon=o,this.setPosition(o,e)}},s.prototype._createCaption=function(){var e=this._config.caption;if(e){var o=t.createElement("div");o.classList.add(i.PREFIX+"caption"),o.style.fontSize=e.fontSize+"px",o.innerText=e.text,this._element.appendChild(o),this._uiElements.caption=o,this.setPosition(o,e)}},s.prototype.setPosition=function(e,t){var o=t.position.split(" "),a=e.getBoundingClientRect().height,n={left:"left: "+(t.outside?0:t.margin)+"px;",right:"right: "+(t.outside?0:t.margin)+"px;"},r={top:"top: "+(t.outside?"-"+(a+t.margin):t.margin)+"px;",bottom:"bottom: "+(t.outside?"-"+(a+t.margin):t.margin)+"px;"};e.style.cssText+=(n[o[0]]||"")+(r[o[1]]||""),"center"===o[0]&&e.classList.add(i.PREFIX+"hcenter"),"center"===o[1]&&e.classList.add(i.PREFIX+"vcenter")},s.prototype.setMargins=function(){var e={top:0,right:0,bottom:0,left:0};Object.keys(this._uiElements).forEach(function(t){e.top=Math.min(parseFloat(this._uiElements[t].style.top)||1/0,e.top),e.right=Math.min(parseFloat(this._uiElements[t].style.right)||1/0,e.right),e.bottom=Math.min(parseFloat(this._uiElements[t].style.bottom)||1/0,e.bottom),e.left=Math.min(parseFloat(this._uiElements[t].style.left)||1/0,e.left)}.bind(this)),Object.keys(e).forEach(function(t){0<=e[t]||(this._proscenium.getElement().style["margin"+t.charAt(0).toUpperCase()+t.slice(1)]=Math.abs(e[t])+"px")}.bind(this))},s.prototype.getConfig=function(){return this._config},s.prototype.getElements=function(){return this._uiElements},s.prototype.destroy=function(){this._closeControlAppearanceTimeout&&clearTimeout(this._closeControlAppearanceTimeout),this._element.parentNode.removeChild(this._element)};var l=function(e){this._ima=e,_.call(this),g.call(this),m.call(this),this._log("start initialization"),this._config=e.getConfig().playback,this._log("config:",this._config),this._params={},this._ads=[],this._preloadedAds=[],this._processedThreads=[],this._rotations=0,this._config.ad.usePods&&0<this._config.hb.length?(this._hbUnits=this._makeAdUnits(),vpbjs.que.push(function(){this._config.pubid&&vpbjs.setConfig({schain:{validation:"relaxed",config:{ver:"1.0",complete:1,nodes:[{asi:location.hostname,sid:"bdc-"+this._config.pubid,hp:1}]}}}),vpbjs.addAdUnits(this._hbUnits),this._hbUnitCodes=this._hbUnits.map(,vpbjs.setConfig({cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},userSync:{filterSettings:{all:{bidders:"*",filter:"include"}}},floors:{},currency:{adServerCurrency:"USD",defaultRates:{USD:{EUR:.9201324990798675}}}}),vpbjs.requestBids({adUnitCodes:this._hbUnitCodes,bidsBackHandler:this._selectBid.bind(this)})}.bind(this))):this._finishInitialization()};l.prototype._finishInitialization=function(){if(new y(this._config.strategy,l._strategiesHandlers).applyTo(this),this._config.naturalVideo.playlist=d.cleanUpPlaylist(this._config.naturalVideo.playlist),this._config.naturalVideo.playlist.length&&this._config.naturalVideo.playlist[0].file){var e=function(){this._naturalVideo=new d(this);var e=this._ima.getAdSlot().getStage().getProscenium().getVideoWrapper();e.appendChild(this._naturalVideo.getElement())}.bind(this);"initial"===this._config.naturalVideo.initialization?e():this.once("AdLoaded",e)}this._tagsList=this._processTags(this._config.tags),this._tagsListInitialLength=this._tagsList.length,this._tagsSet=new Set(this._tagsList),this._log("tags list processed:",this._tagsList),this._resolve(),this._log("finish initialization")},l.prototype._makeAdUnits=function(){return this._config.hb.map(function(e){return{code:e.adId,mediaTypes:e.mediaTypes,floors:{schema:{fields:["mediaType"]},values:{"*":e.floorCpm},default:e.floorCpm},bids:e.bids}})},l.prototype._selectBid=function(){var e=vpbjs.getAdserverTargeting(),t={};this._hbUnitCodes.forEach(function(i){var o=e[i];if(o&&o.hb_adid){vpbjs.markWinningBidAsUsed({adUnitCode:i});var a=vpbjs.getBidResponsesForAdUnitCode(i).bids[0];t[i]={vastUrl:a.vastUrl,cpm:a.cpm,currency:a.currency,netRevenue:a.netRevenue}}}),this._updateAdPodUrl(t),this._finishInitialization()},l.prototype._updateAdPodUrl=function(e){this._config.tags.pre.pod=this._config.tags.pre.pod+"?bids="+encodeURIComponent(JSON.stringify(e))},l._strategiesHandlers={linear:function(e,t){return l._strategiesHandlers.multiThread.call(this,e,{maxThreads:1,maxRotations:t.maxRotations})},multiThread:function(e,t){var i=this,o=function(){this._maxRotations=Math.min(t.maxRotations||1/0,this._tagsListInitialLength),this._maxRotations||setTimeout(this._onAdComplete.bind(this,new u("failed")),0);var e=this._getActiveThreads(),n=this._maxRotations-this._rotations-(t.smartThreads?e.length:0),r=t.smartThreads&&t.maxRotations?t.maxRotations:1/0,s=Math.min(t.maxThreads||r,this._tagsList.length),l=Math.min(s,n);if(!l)return void(0!==this._rotations||this._passbackProcessed||(this._passbackProcessed=!0,this._tagsList=this._config.tags.pre.passbacks.filter(Boolean),o.call(this)));this._log("run "+l+" new thread(s)");for(var d=0;d<l;d++)a()},a=this._resolve.bind(this);this._resolve=o.bind(this);var n=p.prototype._process;p.prototype._process=function(){this.once("failed",o,i),this.once("preloaded",function(){this.getAdUnit().once("AdStarted",function(){this._rotations++,o.call(this)},i)},this),n.call(this),this._conveyor.pushBefore(this._prepareToStartAd,{func:function(e){var t=this._playback.getPreloadedAds(),i=t[t.indexOf(this)-1],o=Array.prototype.slice(arguments,2),a=function(){return a=function(){},e.apply(null,o)};return i?void(i.getAdUnit().once("AdStopped",a),i.once("failed",a)):void a()},context:this})},this._log("apply \""+(1===t.maxThreads?"linear":"multiThread")+"\" strategy")}},l.prototype._getActiveThreads=function(){return this._ads.filter(function(e){return!~this._processedThreads.indexOf(e)}.bind(this))},l.prototype._processTags=function(e){var t="ima_sdk"===this._config.ad.handler&&this._config.ad.usePods?[e.pre.pod]:"ima_sdk"===this._config.ad.handler&&this._config.ad.useVmap?[e.pre.vmap]:e.pre.list.filter(;return t},l.prototype._resolve=function(){var e=new p(this);e.once("failed",this),e.once("preloaded",this),this._applyStrategiesTo(e),"ima_sdk"!==this._config.ad.handler||this._appliedAdOpportunityTracker||(e.getConveyor().pushBefore(e._resolveVASTAdTag,{func:function(e){new Image().src=this._playback.getConfig().tags.pre.list[0],e()},context:e}),this._appliedAdOpportunityTracker=!0),e.getConveyor().run(),this._ads.push(e)},l.prototype._onAdComplete=function(e){if((e=e||this._latestEvent,this._latestEvent=e,"failed"!==e.getName()&&(this._lastSuccessEvent=e),!this._activeAd)&&!((this._tagsList.length||this._getActiveThreads().length)&&this._rotations<this._maxRotations)){var t=this._ima.getAdSlot().getStage().getProscenium();if(this._naturalVideo&&!this._naturalVideoEnded&&(this._rotations||"expanded"===t.getConfig().states.initial))return void this._playNaturalVideo();e="failed"===e.getName()?this._lastSuccessEvent||new f("AdError"):e,this.emit(e),"AdStopped"!==e.getName()&&"AdError"!==e.getName()&&this.emit(new f("AdStopped")),this._ima.emit(new u("complete")),(0<this._rotations||this._naturalVideoEnded)&&"expanded"===t.getConfig().states.final||(this._ima.destroy(),this._passback())}},l.prototype._onAdPreloaded=function(e){this._preloadedAds.push(e),e.getAdUnit().once("AdStarted",this._onAdStarted.bind(this,e)),e.getAdUnit().once("AdStopped",function(t){e===this._activeAd&&(this._activeAd=null),this._onAdComplete(t)},this),m.EVENTS.forEach(function(t){~["AdError","AdLoaded","AdStarted","AdStopped"].indexOf(t)||e.getAdUnit().on(t,this.emit,this)}.bind(this));this._adLoaded||(this._adLoaded=!0,this.emit(new f("AdLoaded")))},l.prototype._onAdStarted=function(e){this._activeAd=e,this._processedThreads.push(e),this._ima.getAdSlot().getStage().getProscenium().once("expanded",function(){var e=this._ima.getAdSlot().getStage().getProscenium().getElement().getBoundingClientRect();this.getAdUnit().emitVPAIDEvent("AdSize",{unit_size:e.width+"x"+e.height})}.bind(this));this._adStarted||(this._adStarted=!0,this.emit(new f("AdStarted")))},l.prototype._applyStrategiesTo=function(e){this._strategies=this._strategies||[];var t=e.getConfig();Object.keys(p._strategiesHandlers).forEach(function(i){if(t.strategies[i]){var o=this._strategies[i]||new y(t.strategies[i],p._strategiesHandlers[i]);o.applyTo(e),this._strategies[i]=o}}.bind(this))},l.prototype._playNaturalVideo=function(){var e=this._ima.getClientDetails().invocation.frameAncestorsHierarchy,t=this._ima.getAdSlot().getStage().getProscenium();"enabled"===t.getConfig().stylesMirroring&&e&&e.forEach(function(e){e.previousSibling.style.display="block"}),this._ima.setFrameAspectRatio(this._naturalVideo._aspectRatioEl,this._naturalVideo._dimensions),this._naturalVideo.play(),this._naturalVideoStarted=!0;var i=t.getVideoWrapper().childNodes;Array.prototype.slice.call(i).forEach(,this._naturalVideo.getElement().style.display="inline-block",this._naturalVideo.getElement().style.opacity=1,this._naturalVideo.getElement().style.position="relative",this._naturalVideo.getElement().style.top="",this._naturalVideo.getElement().style.zIndex="","collapsed"===t.getState()&&t.setState("expanded"),this._naturalVideo.once("ended",bind(this))},l.prototype._passback=function(){!this._config.passback||this._rotations||(this._log("passing back"),this._config.passback.call(this._ima.getConfig()))},l.prototype.getVASTAdTag=l.prototype.subscribe=function(e,t,i){this._callbacks=this._callbacks||[];var o=function(o){var a=[];if("AdError"===t)a=[o.getMessage?o.getMessage():""];else{var n=o.getData();n&&Object.keys(n).forEach(}e.apply(i,a)};this._callbacks.push({callback:e,wrapper:o}),this.on(t,o),this._log("client subscribes to "+t+" event",e)},l.prototype.unsubscribe=function(e,t){this._callbacks.forEach(function(i){i.callback!==e||this.off(t,e)}.bind(this)),this._log("client unsubscribes from "+t+" event",e)},l.prototype.setAdVolume=function(e,t){!t||e!==+e||0>e||1<e||(this._log("setting playback volume level to "+e),this._params.volume=e,this._preloadedAds.forEach(function(t){t.setAdVolume(e)}))},l.prototype.getAdVolume=l.prototype.getIMA=function(){return this._ima},l.prototype.getConfig=function(){return this._config},l.prototype.getParams=function(){return this._params},l.prototype.getPreloadedAds=function(){return this._preloadedAds},l.prototype.getAdUnit=function(){return this._activeAd?this._activeAd.getAdUnit():this._preloadedAds.length?this._preloadedAds[0].getAdUnit():null},l.prototype.getNaturalVideo=function(){return this._naturalVideo},l.prototype._scheduleStart=l.prototype._startIfPossible=function(){var e=Object.keys(this._starts);for(var t of e){var i=Array.from(this._tagsSet).indexOf(t);if(0===i){this._tagsSet.delete(t);var o=this._starts[t];o();break}}},l.prototype.destroy=function(e){this.off();var t=this._preloadedAds.length,i=0,o=function(){++i!==t||e()};this._preloadedAds.forEach(};var d=function(e){this._playback=e,this._ima=e.getIMA(),this._proscenium=this._ima.getAdSlot().getStage().getProscenium(),_.call(this),g.call(this),this._log("start initialization"),this._config=e.getConfig().naturalVideo,this._createPlayer(),this._createLogo(),this._createYoutubePromotion(),this._setUpEventListener(),this._prepareContainer(),this._log("finish initialization")};d.prototype._createPlayer=function(){var e=t.createElement("div");e.style.cssText="position: relative; min-width: 100%;",this._applyAdsToMediaItems();var i={media:this._config.playlist,playlist:{}};this._player=new VidvertoPlayer(e,i),this._container=e},d.prototype._createLogo=function(){if(this._config.logo&&this._config.logo.src){var e=t.createElement("a");e.style.cssText="position:absolute;right:10px;top:10px;display:inline-block;z-index:1",this._config.logo.href?e.href=this._config.logo.href:(e.href="javascript://",e.addEventListener("click",);var i=t.createElement("img");i.style.cssText="max-height:30px",i.src=this._config.logo.src,e.appendChild(i),this._container.appendChild(e)}},d.prototype._createYoutubePromotion=function(){const e=this._config.youtube;if(e&&e.channelUrl){var t=e.channelUrl+(e.subscriptionPopup?"?sub_confirmation=1&feature=subscribe-embed-click":""),i="<a href=\""+t+"\" class=\"ytbtn\" target=\"_blank\"><span class=\"ytsubscribe\">"+e.buttonText+"</span></a>";this._container.insertAdjacentHTML("beforeend",i)}},d.prototype._applyAdsToMediaItems=function(){this._config.playlist=this._config.playlist.map(function(e){return e.ads=[],this._playback.getConfig().tags.mid[0]&&e.ads.push({id:1,time:this._config.midrollTime,repeat:this._config.repeat,url:this._playback.getConfig().tags.mid[0]}),this._playback.getConfig().tags.post[0]&&e.ads.push({id:2,time:"99%",url:this._playback.getConfig().tags.post[0]}),e}.bind(this))},d.cleanUpPlaylist=d.prototype._prepareContainer=function(){this._proscenium.once("maxDimensionsCalculated",function(){var e=this._proscenium.getMaxDimensions();this._createAspectRatioEl(e.width,e.height)}.bind(this))},d.prototype._setUpEventListener=function(){this._player.once("loadedmetadata",bind(this));var e,t=!1;this._player.on("timeupdate",function(){if(e=this._player.playlist.current,t&&3>this._player.currentTime&&(t=!1),!t&&3<=this._player.currentTime){var i=this._config.playlist[e].onProgress;i&&(new Image().src=i),t=!0}}.bind(this)),this._player.on("ended",function(){this.emit(new u("ended"));var t=this._config.playlist[e].onEnded;t&&(new Image().src=t)}.bind(this))},d.prototype._createAspectRatioEl=function(e,i){this._aspectRatioElWidth=e,this._aspectRatioElHeight=i,this._aspectRatio=e/i;var o=16/9;this._aspectRatioEl&&this._aspectRatioEl.parentNode.removeChild(this._aspectRatioEl),this._dimensions=o>=this._aspectRatio?{width:e,height:e/o}:{width:i*o,height:i},this._aspectRatioEl=t.createElement("img"),this._aspectRatioEl.src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22"+this._dimensions.width+"%22%20height%3D%22"+this._dimensions.height+"%22%3E%3C%2Fsvg%3E",this._aspectRatioEl.style.minWidth="100%",this._aspectRatioEl.style.width="100%",this._container.insertAdjacentElement("afterbegin",this._aspectRatioEl)},d.prototype.play=function(){if(!this._canPlay)return void this._player.once("loadedmetadata",this.play.bind(this));var e=this._proscenium.getUIElements(),t=this._ima._config.adSlot.stage.proscenium.playerUiElements;if(!e){this._proscenium._uiElements=new s(this._proscenium);var e=this._proscenium.getUIElements()}if(e){e.getConfig().controls.close&&!t.controls.close&&(e.getConfig().controls.close.visible=!1);var o=this._ima.getAdSlot().getStage().getProscenium().getProperties();Object.keys(e.getElements()).forEach(function(a){return"closeControl"===a&&o.hasProperty("sticky")?void 0:"closeControl"===a&&t.controls.close?void e.getElements()[a].classList.remove(i.PREFIX+"hidden"):void("volumeControl"===a&&t.controls.volume||"brandIcon"===a&&t.brandIcon||"caption"===a&&t.caption||e.getElements()[a].classList.add(i.PREFIX+"hidden"))}.bind(this))}if(this._ima.getAdSlot().getStage()._stickyEnabled&&this._ima.getAdSlot().getStage()._configureUiElements("enable"),!this._playedBefore){this._playedBefore=!0;var a=this._ima.getConfig().playback.ad.strategies.volume,n=a.onReady?"onReady":"onHover",r={onReady:function(e){var t=0<+e.level&&this._ima._clientDetails.autoplay===i.CLIENT_DETAILS.autoplay.unmuted?+e.level:0;l(t),0==t&&(this._player.muted=!0)},onHover:function(e){l(0),0==+e.level&&(this._player.muted=!0),this._ima.once("autoPlaySupportClarified",function(){if(this._ima._clientDetails.autoplay===i.CLIENT_DETAILS.autoplay.unmuted){var t="out",o=function(){"over"===t||(t="over",l(+e.level,e.transition))}.bind(this),a=function(){"out"===t||(t="out",l(0,e.transition))}.bind(this);this._container.addEventListener("mouseover",o),this._container.addEventListener("mouseout",a)}}.bind(this))}};this._params={};var l=function(e,t){if(this._transitionIntervalID&&clearInterval(this._transitionIntervalID),!t||"smooth"!==t&&"smooth"!==t.type)return this._player.volume=e,void(this._params.volume=e);var i=1e3*t.duration||1e3,o=Math.ceil(i/20),a="undefined"==typeof this._params.volume?0:this._params.volume,n=this._player.volume,r=(e-a)/o;this._transitionIntervalID=setInterval(function(){var t=Math.abs(e-n)>Math.abs(r)?r:e-n;n+=t,this._player.volume=n,n===e&&clearInterval(this._transitionIntervalID)}.bind(this),20),this._params.volume=e}.bind(this);r[n].call(this,a[n])}this._player.play()},d.prototype.pause=function(){this._player.pause()},d.prototype.getElement=function(){return this._container},d.prototype.getAspectRatio=function(){return this._aspectRatio};var p=function(t){this._playback=t,this._ima=t.getIMA(),_.call(this),g.call(this),this._log("start initialization"),this._config=t.getConfig().ad,this._log("config:",this._config),this._params={},this._clientDetails=this._ima.getClientDetails(),this._vastAdTag=t.getVASTAdTag(),this._proscenium=this._ima.getAdSlot().getStage().getProscenium(),this._videoPlayer=new c(this),this._vastClient=new e.VASTClient(this._videoPlayer),this._process(),this._log("finish initialization")};p._strategiesHandlers={resolveVASTAdTag:{onReady:function(){},inViewport:function(o,a,n){n=n||"_resolveVASTAdTag";var r;"_prepareToStartAd"===n&&a.prioritize&&this._conveyor.pushBefore(this[n],{func:function(e){var t=Array.prototype.slice(arguments,2);r=function(){return e.apply(null,t)},this._playback._scheduleStart(this._vastAdTag,r),this._playback._startIfPossible(),this._adUnit.once(["AdStopped","AdError"],function(){this._playback._startIfPossible()}.bind(this))},context:this});var s=this._clientDetails.invocation.method===i.CLIENT_DETAILS.invocation.methods.direct?this._playback.getIMA().getAdSlot().getStage().getElement():this._clientDetails.invocation.baseElement;e.inViewWindow=s.ownerDocument.defaultView;var l=e.inView();this._conveyor.pushBefore(this[n],{func:function(i){var n=Array.prototype.slice(arguments,2);r=function(){return i.apply(null,n)},this.once("AdStarted",o.shift);var d=a.container||e.aries_kowalsking_test_container;if(d){s=t.querySelector(d);var p=t.documentElement.clientHeight-a.offset;return l.offset({top:p,right:0,bottom:p,left:0}),void(l.is(s)?l(s).once("exit",r):r())}if(a.offset){var c=a.offset,_=c;if(~String.prototype.indexOf.call(a.offset,"%")){var g=a.offset.split("%")[0]/100;c=this._dimensions.width*g,_=this._dimensions.height*g}l.offset({top:-1*_,right:-1*c,bottom:-1*_,left:-1*c})}l.is(s)?r():l(s).once("enter",r)},context:this}),o.defineDestroy(function(){this._conveyor.cut(methodPrefix),r&&(l(s).off("enter",r),r())}.bind(this))},float:function(){}},preloadMediaFile:{onReady:function(){},inViewport:function(){p._strategiesHandlers.resolveVASTAdTag.inViewport.apply(this,Array.prototype.slice.call(arguments).concat("_preloadMediaFile"))}},startAd:{onReady:function(e,t){var i;t.prioritize&&this._conveyor.pushBefore(this._prepareToStartAd,{func:function(e){var t=Array.prototype.slice(arguments,2);i=function(){return e.apply(null,t)},this._playback._scheduleStart(this._vastAdTag,i),this._playback._startIfPossible(),this._adUnit.once(["AdStopped","AdError"],bind(this))},context:this})},inViewport:function(){p._strategiesHandlers.resolveVASTAdTag.inViewport.apply(this,Array.prototype.slice.call(arguments).concat("_prepareToStartAd"))},externally:function(e){this._playback._startHandlers=this._playback._startHandlers||[];var t=function(e){this._playback._startHandlers.push({handler:e,context:this,args:Array.prototype.slice.call(arguments,2)}),this._playback.emit(new u("queuedStartHandler"))};this._conveyor.pushBefore(this._prepareToStartAd,{func:t,context:this}),l.prototype.startAd=function(){var t=function(){if(this._startHandlers.length){var t=this._startHandlers.shift();t.handler.apply(t.context,t.args),e.shift()}}.bind(this);this.once("queuedStartHandler",t),t()},e.defineDestroy(function(){this._conveyor.cut(t),this._playback._startHandlers.forEach(,this._playback._startHandlers=[],l.prototype.startAd=new Function}.bind(this))},float:function(){var i=t.querySelectorAll("#main-container p"),o=[];e.inViewWindow=e;var a,n=e.inView(),r=e.pageYOffset||t.documentElement.scrollTop,s=!0,l=function(){var i=e.pageYOffset||t.documentElement.scrollTop;s=r<i,r=i};e.addEventListener("scroll",l),this._conveyor.pushBefore(this._prepareToStartAd,{func:function(t){var r=d=function(e){o=o.filter(,p()};n.offset({top:160,bottom:160,left:0,right:0}),n(i).on("enter",r),n(i).on("exit",d);var p=function(){a&&clearTimeout(a),a=setTimeout(function(){e.removeEventListener("scroll",l),n(i).off("enter",r),n(i).off("exit",d),o.sort(function(e,t){var i=e.getBoundingClientRect().top,o=t.getBoundingClientRect().top;return i-o}),o[s?o.length-1:0].parentNode.insertBefore(this._ima.getAdSlot().getTargetNode(),o[s?o.length-1:0]),t()}.bind(this),100)}.bind(this)},context:this})},onVisibility:function(e,t){var i,o,a;this._conveyor.pushBefore(this._startAd,{func:function(e){var n=Array.prototype.slice(arguments,2);o=a=function(e){var n=e.getData().height,r=this._playback._activeAd||this._playback._preloadedAds[0],s=r.getDimensions().height,l=t.portion;~l.indexOf("%")&&(l=parseFloat(l.split("%")[0])/100*s);n<parseFloat(l)||(i.off("resize",a),o())}.bind(this),i=this._ima.getAdSlot().getStage().getProscenium(),i.createResizeObserver(),i.on("resize",a)},context:this}),e.defineDestroy(function(){this._conveyor.cut(methodPrefix),o&&(i.off("resize",a),o())}.bind(this))}},resumeAd:{inViewport:function(o,a){var n=this._clientDetails.invocation.method===i.CLIENT_DETAILS.invocation.methods.direct?this._playback.getIMA().getAdSlot().getStage().getElement():this._clientDetails.invocation.baseElement;e.inViewWindow=n.ownerDocument.defaultView;var r=e.inView(),s=function(){if(this._playback._pauseNeeded=!1,this._ima.getPlayback()._naturalVideoStarted)this._ima.getPlayback().getNaturalVideo().play();else{if(!this._playback._isPaused||!this.getAdUnit())return;this._playback._isPaused=!1,this.getAdUnit().resumeAd()}}.bind(this);this._conveyor.pushBefore(this._startAd,{func:function(i){var o=Array.prototype.slice(arguments,2);this.getAdUnit().once("AdStarted",function(){var i=a.container||e.aries_kowalsking_test_container;if(i){n=t.querySelector(i);var o=t.documentElement.clientHeight-a.offset;r.offset({top:o,right:0,bottom:o,left:0})}if(a.offset){var l=a.offset,d=l;if(~String.prototype.indexOf.call(a.offset,"%")){var p=a.offset.split("%")[0]/100;l=this._dimensions.width*p,d=this._dimensions.height*p}r.offset({top:-1*d,right:-1*l,bottom:-1*d,left:-1*l})}r.is(n)&&s(),r(n).on("enter",s)}.bind(this)),i(o)},context:this})}},pauseAd:{outViewport:function(o,a){var n=this._clientDetails.invocation.method===i.CLIENT_DETAILS.invocation.methods.direct?this._playback.getIMA().getAdSlot().getStage().getElement():this._clientDetails.invocation.baseElement;e.inViewWindow=n.ownerDocument.defaultView;var r=e.inView(),s=function(){if(this._ima.getPlayback()._naturalVideoStarted)this._ima.getPlayback().getNaturalVideo().pause();else{if(this._playback._isPaused||!this.getAdUnit())return;this._playback._isPaused=!0,this.getAdUnit().pauseAd()}}.bind(this);this._conveyor.pushBefore(this._startAd,{func:function(i){var o=Array.prototype.slice(arguments,2);this.getAdUnit().once("AdStarted",function(){var i=a.container||e.aries_kowalsking_test_container;if(i){n=t.querySelector(i);var o=t.documentElement.clientHeight-a.offset;r.offset({top:o,right:0,bottom:o,left:0})}if(a.offset){var l=a.offset,d=l;if(~String.prototype.indexOf.call(a.offset,"%")){var p=a.offset.split("%")[0]/100;l=this._dimensions.width*p,d=this._dimensions.height*p}r.offset({top:-1*d,right:-1*l,bottom:-1*d,left:-1*l})}r.is(n)||s(),r(n).on("exit",s)}.bind(this)),i(o)},context:this})},outViewportOnAdComplete:function(o,a){var n=this._clientDetails.invocation.method===i.CLIENT_DETAILS.invocation.methods.direct?this._playback.getIMA().getAdSlot().getStage().getElement():this._clientDetails.invocation.baseElement;e.inViewWindow=n.ownerDocument.defaultView;var r=e.inView();this._vastClient.once("mediaFilePreloaded",function(){this._vastClient._adsManager.addEventListener(google.ima.AdEvent.Type.AD_PROGRESS,function(e){this._playback._pauseNeeded&&95<100*(e.getAdData().currentTime/e.getAdData().duration)&&(this._playback._isPaused=!0,this.getAdUnit().pauseAd())}.bind(this))}.bind(this));var s=function(){this._ima.getPlayback()._naturalVideoStarted?this._ima.getPlayback().getNaturalVideo().pause():this._playback._pauseNeeded=!0}.bind(this);this._conveyor.pushBefore(this._startAd,{func:function(i){var o=Array.prototype.slice(arguments,2);this.getAdUnit().once("AdStarted",function(){e.getAdUnit=this.getAdUnit(),e.playback=this._playback;var i=a.container||e.aries_kowalsking_test_container;if(i){n=t.querySelector(i);var o=t.documentElement.clientHeight-a.offset;r.offset({top:o,right:0,bottom:o,left:0})}if(a.offset){var l=a.offset,d=l;if(~String.prototype.indexOf.call(a.offset,"%")){var p=a.offset.split("%")[0]/100;l=this._dimensions.width*p,d=this._dimensions.height*p}r.offset({top:-1*d,right:-1*l,bottom:-1*d,left:-1*l})}r.is(n)||s(),r(n).on("exit",s)}.bind(this)),i(o)},context:this})}},volume:{onReady:function(e,t){this.once("preloaded",function(){var e=0<+t.level&&this._ima._clientDetails.autoplay===i.CLIENT_DETAILS.autoplay.unmuted?+t.level:0;this.setAdVolume(e)}.bind(this))},onHover:function(e,t){this._ima.once("autoPlaySupportClarified",function(){if(this._ima._clientDetails.autoplay===i.CLIENT_DETAILS.autoplay.unmuted){var e="out",o=function(){"over"===e||(e="over",this.setAdVolume(+t.level,t.transition))}.bind(this),a=function(){"out"===e||(e="out",this.setAdVolume(0,t.transition))}.bind(this);this._videoPlayer._videoPlayer.addEventListener("mouseover",o),this._videoPlayer._videoPlayer.addEventListener("mouseout",a)}}.bind(this))}}},p.prototype._resolveVASTAdTag=function(e,t){this._log("start resolving VAST ad tag",this._vastAdTag),this._proscenium.once("maxDimensionsCalculated",function(){var e=this._ima._config.playback.naturalVideo.playlist.reduce((e,t)=>{var i=t.duration||0;return e+i},0);this._vastClient.resolveVASTAdTag({vastAdTagURI:this._vastAdTag,maxDimensions:this._proscenium.getMaxDimensions(),timeout:1e3*this._config.timeouts.resolve,handler:this._config.handler,useVmap:this._config.useVmap,contentDuration:e})},this),this._vastClient.once("vastAdTagResolved",function(t){this._mediaFile=t.getData(),this._info("VAST ad tag resolved",this._vastAdTag,this._mediaFile),this._calculateDimensions(),this._videoPlayer.setDimensions(this._dimensions),e()},this),this._vastClient.once("failedVASTAdTagResolving",t)},p.prototype._calculateDimensions=function(e,t){t=!("undefined"!=typeof t)||t;var i=this._proscenium.getMaxDimensions();e=e||{width:this._mediaFile.getAttribute("width"),height:this._mediaFile.getAttribute("height")};var o=e.width/e.height,a=i.width/i.height;this._dimensions=o>=a?{width:i.width,height:i.width/o}:{width:i.height*o,height:i.height},t||(this._dimensions.width=Math.min(this._dimensions.width,e.width),this._dimensions.height=Math.min(this._dimensions.height,e.height)),this._playback.emit(new u("dimensionsCalculated",this._dimensions))},p.prototype._preloadMediaFile=function(e,t){this._log("start preloading media file",this._mediaFile,this._vastAdTag),this._vastClient.preloadMediaFile({dimensions:this._dimensions,timeout:1e3*this._config.timeouts.preload}),this._vastClient.once("mediaFilePreloaded",function(i){this._adUnit=i.getData(),this._log("media file preloaded",this._adUnit,this._vastAdTag),this._adUnit.once("AdError",t),this.emit(new u("preloaded")),this._adUnit.on("AdSizeChange",function(){var e=this._adUnit.getAdWidth()/this._adUnit.getAdHeight(),t=this._dimensions.width/this._dimensions.height;e!==t&&(this._calculateDimensions({width:this._adUnit.getAdWidth(),height:this._adUnit.getAdHeight()},!1),this._videoPlayer.setDimensions(this._dimensions),this._adUnit.resizeAd(this._dimensions.width,this._dimensions.height,"normal"))}.bind(this)),e()},this),this._vastClient.once("failedMediaFilePreloading",t)},p.prototype._prepareToStartAd=function(e){var t=this._ima.getClientDetails().invocation.frameAncestorsHierarchy;"enabled"===this._proscenium.getConfig().stylesMirroring&&t&&t.forEach(;var o=this._proscenium.getVideoWrapper().childNodes;Array.prototype.slice.call(o).forEach(function(e){e.style.opacity=0,e.style.position="absolute",e.style.top=0,e.style.zIndex=-1}),this._videoPlayer.getElement().parentNode.style.opacity=1,this._videoPlayer.getElement().parentNode.style.position="relative",this._videoPlayer.getElement().parentNode.style.top="",this._videoPlayer.getElement().parentNode.style.zIndex="",this._videoPlayer.getElement().parentNode.classList.remove(i.PREFIX+"prepared"),"collapsed"===this._proscenium.getState()&&this._proscenium.setState("expanded"),this._proscenium.once("beforeExpanded",e)},p.prototype._startAd=function(e){this._playback.getNaturalVideo()&&this._playback.getNaturalVideo().pause(),this._adUnit.startAd(),this._adUnit.once("AdStarted",function(){this._setAutoSkip(),this._proscenium.getUIElements().getElements().volumeControl&&(this._proscenium.getUIElements().getElements().volumeControl.style.display=!1===this._isVastParamEnabled("volumeControl")?"none":"initial")},this),this._adUnit.once("AdStopped",e)},p.prototype._isVastParamEnabled=function(e){for(var t=this._adUnit.getVASTRegistry(),i=t.getActiveLayer(),o={};i;){var a=i.getLink("creative");if(a&&a.hasChild("CreativeExtensions")){var n=a.getCreativeExtensions().getCreativeExtension();n=Array.isArray(n)?n:[n];var r=n.filter(;r.forEach(function(e){var t=e._childs.Param;t&&(t=Array.isArray(t)?t:[t],t.forEach()})}i=i.get("parentLayer")}return o[e]},p.prototype._setAutoSkip=function(){if(!1!==this._isVastParamEnabled("autoSkip")){var e=this._config.autoSkip;if(this._log("autoskip config:",e,this._vastAdTag),!(Math.random()>e.probability)){var t=1e3*(Math.random()*(e.range[1]-e.range[0])+e.range[0]);this._log("set autoskip in "+t+"ms"),this._autoSkipTimeout=setTimeout(function(){this._adUnit&&("ima_sdk"===this._config.handler?this._config.useVmap?this._adUnit.discardAdBreak():this._config.usePods?this._adUnit.skipAd():this._adUnit.stopAd():this._adUnit.skipAd(),this._log("autoskipped",this._vastAdTag))}.bind(this),t)}}},p.prototype._process=function(){this._conveyor=new b({func:this._resolveVASTAdTag,context:this},{func:this._preloadMediaFile,context:this},{func:this._prepareToStartAd,context:this},{func:this._startAd,context:this}),this._conveyor.once(["success","fail"],function(e){"fail"===e.getName()&&this.emit(new u("failed")),this.destroy()},this)},p.prototype.setAdVolume=function(e,t){if(this._adUnit){if(this._transitionIntervalID&&clearInterval(this._transitionIntervalID),!t||"smooth"!==t&&"smooth"!==t.type)return this._adUnit.setAdVolume(e,!0),void(this._params.volume=e);var i=1e3*t.duration||1e3,o=Math.ceil(i/20),a="undefined"==typeof this._params.volume?this._playback.getParams().volume||0:this._params.volume,n=this._adUnit.getAdVolume(),r=(e-a)/o;this._transitionIntervalID=setInterval(function(){var t=Math.abs(e-n)>Math.abs(r)?r:e-n;n+=t,this._adUnit.setAdVolume(n),n===e&&clearInterval(this._transitionIntervalID)}.bind(this),20),this._params.volume=e}},p.prototype.getIMA=function(){return this._ima},p.prototype.getConfig=function(){return this._config},p.prototype.getParams=function(){return this._params},p.prototype.getConveyor=function(){return this._conveyor},p.prototype.getAdUnit=function(){return this._adUnit},p.prototype.getMediaFile=function(){return this._mediaFile},p.prototype.getDimensions=function(){return this._dimensions},p.prototype.destroy=var c=function(e){this._ad=e,this._ima=e.getIMA(),g.call(this),this._log("start initialization"),this._config=e.getConfig().videoPlayer,this._log("config:",this._config),this._layers=[],this._create(),this._log("finish initialization")};c._propertiesHandlers={stretched:,c.prototype._create=function(){var e=t.createElement("div");e.classList.add(i.PREFIX+"videoPlayer"),e.classList.add(i.PREFIX+"prepared"),this._createAspectRatioElement(),this._createVideoElement(),e.appendChild(this._aspectRatioElement),e.appendChild(this._videoElement),this._ima.getAdSlot().getStage().getProscenium().getVideoWrapper().appendChild(e),this._videoPlayer=e},c.prototype._createVideoElement=function(){var e=t.createElement("video");e.setAttribute("playsinline",""),e.preload="metadata",e.muted=!0;var i=d.cleanUpPlaylist(this._ima.getConfig().playback.naturalVideo.playlist);i.length&&i[0].file&&(e.src=i[0].file),e.addEventListener("loadedmetadata",function(){var t=e.videoWidth/e.videoHeight;if(this._dimensions){var i=this._dimensions.width/this._dimensions.height;t!=i&&(this._ad._calculateDimensions({width:e.videoWidth,height:e.videoHeight}),this.setDimensions(this._ad.getDimensions()),this._ad.getAdUnit().resizeAd(this._dimensions.width,this._dimensions.height,"normal"))}}.bind(this)),this._videoElement=e},c.prototype._createAspectRatioElement=function(){this._aspectRatioElement=t.createElement("img"),this._aspectRatioElement.className=i.PREFIX+"aspectRatio",this._aspectRatioSvg=t.createElement("svg"),this._aspectRatioSvg.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._aspectRatioSvg.setAttribute("src","data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22640%22%20height%3D%22360%22%3E%3C%2Fsvg%3E")},c.prototype._setAspectRatio=function(){this._aspectRatioSvg.setAttribute("width",this._dimensions.width),this._aspectRatioSvg.setAttribute("height",this._dimensions.height),this._aspectRatioElement.src="data:image/svg+xml,"+encodeURIComponent(this._aspectRatioSvg.outerHTML),this._ima.setFrameAspectRatio(this._aspectRatioElement,this._dimensions)},c.prototype.setDimensions=function(e){e.width&&(this._videoPlayer.style.maxWidth=e.width+"px"),e.width&&(this._videoPlayer.style.maxHeight=e.height+"px"),this._dimensions=e,this._setAspectRatio()},c.prototype.createLayer=function(e){var o=t.createElement("div");return o.classList.add(i.PREFIX+"wrapperLayer",i.PREFIX+e),this._videoPlayer.appendChild(o),this._layers[e]=o,o},c.prototype.getLayer=c.prototype.removeLayer=function(e){this._layers[e].parentNode.removeChild(this._layers[e]),delete this._layers[e]},c.prototype.getConfig=function(){return this._config},c.prototype.getElement=var _=function(){Object.keys(_.prototype).forEach(bind(this)),this._listeners=[],this._emittedEvents=[]};_.prototype.emit=function(e,t){this._emittedEvents.push(e);var i=e.getName(),o=this._listeners.length-1;this._listeners.forEach(function(o){t&&t.key&&t.handler&&t!==o||!~o.key.indexOf(i)||(o.iterations++,o.maxIterations&&o.maxIterations===o.iterations&&this.off(o.key,o.handler,o.context),o.handler.call(o.context,e))}.bind(this))},_.prototype.on=function(e,t,i,o){e=Array.isArray(e)?e:[e],this._listeners.push({key:e,handler:t,context:i,iterations:0,maxIterations:o}),e.forEach(function(e){this._emittedEvents.forEach(function(t){t.getName()!==e||this.emit(t,this._listeners[this._listeners.length-1])}.bind(this))}.bind(this))},_.prototype.once=_.prototype.off=function(e,t,i){return e?Array.isArray(e)?void e.forEach(bind(this)):void this._listeners.forEach(function(o,a){i&&i!==o.context||t&&t!==o.handler||!~o.key.indexOf(e)||(o.key.splice(o.key.indexOf(e),1),!o.key.length&&delete this._listeners[a])}.bind(this)):void(this._listeners=[])};var g=function(){Object.keys(g.prototype).forEach(function(e){this.constructor.prototype[e]=g.prototype[e]}.bind(this)),this._registry=this._registry||this._ima.getRegistry(),this._registry.loggable=this._registry.loggable||{log:this._config.analytics.log,gaTrackingID:this._config.analytics.gaTrackingID,placementID:this._config.analytics.placementID},this._enableGA()};g.prototype._enableGA=function(){if(!this._registry.loggable.gaTrackerID&&this._registry.loggable.gaTrackingID){var o=i.PREFIX+Math.ceil(1e6*Math.random());((e,t,"script","//www.google-analytics.com/analytics.js","ga"),e.ga("create",this._registry.loggable.gaTrackingID,"auto",o),e.ga(o+".set",{dimension1:this._registry.loggable.placementID}),e.ga(o+".send","pageview"),this._registry.loggable.gaTrackerID=o}},g.prototype._pushToGA=function(t){this._registry.loggable.gaTrackerID&&e.ga(this._registry.loggable.gaTrackerID+".send",{hitType:"event",eventCategory:"tech",eventAction:t,nonInteraction:!0})},g.prototype._log=function(){if(this._pushToGA.apply(this,arguments),!!this._registry.loggable.log){var t=Array.prototype.slice.call(arguments);t[0]=this._registry.loggable.placementID+"::"+this.constructor.name+"::"+t[0],e.console.log.apply(e.console.log,t)}},g.prototype._info=function(){if(this._pushToGA.apply(this,arguments),!!this._registry.loggable.log){var t=Array.prototype.slice.call(arguments);t[0]=this._registry.loggable.placementID+"::"+this.constructor.name+"::"+t[0],e.console.log.apply(e.console.log,t)}},g.prototype._warn=function(){if(this._pushToGA.apply(this,arguments),!!this._registry.loggable.log){var t=Array.prototype.slice.call(arguments);t[0]=this._registry.loggable.placementID+"::"+this.constructor.name+"::"+t[0],e.console.warn.apply(e.console.warn,t)}};var m=function(){var e=Array.prototype.concat.call(m.METHODS,m.GETTERS,m.SETTERS);e.forEach(function(e){this.constructor.prototype[e]||(this.constructor.prototype[e]=function(){var t=this.getAdUnit();return t?t[e].apply(t,arguments):void 0})}.bind(this)),this._setUpEvents=function(){var e=this.getAdUnit();e&&m.EVENTS.forEach(function(t){e.subscribe(function(){this.emit(new f(t,arguments))},t,this)}.bind(this))}};m.METHODS=["startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd"],m.GETTERS=["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"],m.SETTERS=["setAdVolume"],m.EVENTS=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"];var y=function(e,t){this._configs=e,this._handlers=t,this._targets=[],this._destroyHandlers=[],this._prepareHandler()};y.prototype._prepareHandler=function(){var e=Object.keys(this._configs),t=e.indexOf(this._handlerName),i=e[++t];i&&(this._config=this._configs[i],this._handler=this._handlers[i],this._handlerName=i)},y.prototype.applyTo=function(e){this._targets.push(e),e._strategies=this;this._handler&&this._handler.call(e,this,this._config)},y.prototype.shift=function(){if(this._config.sequence&&"first"===this._config.sequence){var e=this._handlerName;this._prepareHandler(),e===this._handlerName||(this._targets.forEach(function(e){this._handler.call(e,this,this._config)}.bind(this)),this._destroyHandlers.forEach(function(e){e()}))}},y.prototype.defineDestroy=function(e){this._destroyHandlers.push(e)};var h=function(){y.apply(this,arguments)};h.prototype=Object.create(y.prototype),h.prototype.constructor=h,h.prototype.applyTo=function(e){for(this._targets.push(e),e._properties=this;this._handler;)this._handler.call(e,this,this._config),this._handler=null,this._prepareHandler()},h.prototype.hasProperty=var u=u.prototype.getName=function(){return this._name},u.prototype.getData=function(){return this._data};var f=f.prototype=Object.create(u.prototype),f.prototype.constructor=f;var b=function(){_.call(this),this._queue=[],arguments.length&&this.push.apply(this,arguments)};b.prototype.push=function(){this._queue=Array.prototype.concat.apply(this._queue,arguments)},b.prototype.pushBefore=function(e){for(var t=Array.prototype.slice.call(arguments,1),o=-1,a=0;a<this._queue.length;a++)if(this._queue[a].func===e){o=a;break}return~o?void Array.prototype.splice.apply(this._queue,Array.prototype.concat.call([o,0],t)):void this.push.apply(this,t)},b.prototype.cut=b.prototype.run=function(){var e=this._queue.shift(),t=this.emit.bind(this,new u("success")),i=this.emit.bind(this,new u("fail")),o=this._queue.length?this.run.bind(this):t,a=Array.prototype.concat.apply([o,i],arguments);e.func.apply(e.context,a)};var E=E.prototype._setUpEventListeners=function(){e.addEventListener("click",this._makeActors.bind(this)),e.addEventListener("touchend",this._makeActors.bind(this))},E.prototype._removeEventListeners=E.prototype._makeActors=function(){this._clearTimeouts();for(var e,t=1;20>=t;t++)e=setTimeout(this._resolveCommandsQueue.bind(this),50*t),this._timeouts.push(e)},E.prototype._clearTimeouts=E.prototype._resolveCommandsQueue=function(){var e=this._commandsQueue;this._commandsQueue=[],e.forEach(},E.prototype.push=E.prototype.destroy=var v=v.prototype._loadStyles=function(){var e=t.createElement("style");e.appendChild(t.createTextNode(".aries_stage.aries_verticalAxis.aries_semiCollapsed>div{filter:blur(10px);max-width:25px!important}.aries_stage.aries_verticalAxis.aries_semiCollapsed::after{cursor:pointer;content:\"\";display:block;position:absolute;top:0;width:100%;height:100%;background:center/contain no-repeat url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0ibGF5ZXJfMSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTM5IDEzOTsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDEzOSAxMzkiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOm5vbmU7c3Ryb2tlOiNmZmZmZmY7c3Ryb2tlLXdpZHRoOjE2O3N0cm9rZS1taXRlcmxpbWl0OjEwO308L3N0eWxlPjxwb2x5bGluZSBjbGFzcz0ic3QwIiBpZD0iWE1MSURfNl8iIHBvaW50cz0iNzguNSwyMy41IDYwLjUsNjkuNSA3OC41LDExNS41ICIvPjwvc3ZnPg==),rgba(0,0,0,.3)}.aries_stage.aries_verticalAxis.aries_semiCollapsed.aries_expandToRight::after{transform:rotate(180deg)}.aries_prepared .aries_aspectRatio{width:1px!important;height:1px!important}.aries_ima_sdk iframe{position:absolute!important;top:0;left:0;z-index:2}.aries_wrapperLayer.aries_adSlot.aries_ima_sdk>div{z-index:1!important;}.aries_stage{display:flex;flex-direction:row;font-size:0;overflow:hidden;visibility:hidden;position:relative}.aries_stage.aries_fixed{z-index:2147483647}.aries_stage.aries_horizontalAxis{width:100%;height:auto}.aries_stage.aries_verticalAxis{width:auto;height:100%}.aries_verticalAxis .aries_collapsed{max-width:0!important;margin:0!important}.aries_horizontalAxis .aries_collapsed{max-height:1px!important;margin:0!important}.aries_stage.aries_horizontalAxis.aries_fixed{width:auto}.aries_stage.aries_verticalAxis.aries_fixed{height:auto}.aries_proscenium{position:relative;border:0;display:inline-block;overflow:hidden;opacity:0}.aries_videoWrapper,.aries_uiElements{width:100%;height:100%;top:0;left:0;position:absolute}.aries_uiElements{pointer-events:none}.aries_videoWrapper{position:static;transition:transform .2s}.aries_videoPlayer{opacity:0;width:100%;height:100%;position:relative;left:50%;transform:translateX(-50%)}.aries_videoPlayer video{width:100%;height:100%;object-position:0;object-fit:cover}.aries_videoPlayer img.aries_aspectRatio{min-width:100%;min-height:100%;max-width:initial;max-height:initial}.aries_sticky .aries_videoPlayer video,.aries_sticky .aries_videoPlayer img.aries_aspectRatio{width:100%}.aries_videoPlayer video,.aries_wrapperLayer{position:absolute;top:0;left:0}.aries_wrapperLayer{pointer-events:none;width:100%;height:100%}.aries_wrapperLayer *{pointer-events:all}.aries_wrapperLayer.aries_clickThroughLayer a{display:block;width:100%;height:100%}.aries_wrapperLayer.aries_skipButtonLayer .aries_preSkipButton,.aries_wrapperLayer.aries_skipButtonLayer .aries_skipButton{position:absolute;bottom:20%;right:0;background:rgba(0,0,0,0.8);color:#e6e6e6;font-family:arial,sans-serif;text-align:center}.aries_wrapperLayer.aries_skipButtonLayer .aries_preSkipButton{min-width:155px;padding:6px;font-size:11px;line-height:21px}.aries_wrapperLayer.aries_skipButtonLayer .aries_skipButton{display:none;padding:7px 6px 7px 10px;cursor:pointer}.aries_wrapperLayer.aries_skipButtonLayer .aries_skipButton .aries_skipButtonText{float:left;font-size:18px;line-height:18px;margin:2px 2px 0 0}.aries_wrapperLayer.aries_skipButtonLayer .aries_skipButton::after{content:'';display:inline-block;width:24px;height:24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAABGdBTUEAALGPC/xhBQAAAAJiS0dEAP+Hj8y/AAAAZElEQVQ4y+3SwQmDQBBGYRFy9mYLSRXWEyvRRtKBbdhDUoTH8HkVllX+u++48GD2zTTNTYiPrnhDXeBnyAT+Zo9EgNUrE9iMmQCLvhTas2jXWY8jvbNPP5OsU5L1my0uPY2bCjtXdo6mqRVtTgAAAABJRU5ErkJggg==)}.aries_controlIcon{position:absolute;border-radius:3px;background-size:65%;border:1px solid rgba(0,0,0,0.05);cursor:pointer;pointer-events:auto}.aries_controlIcon.aries_closeControl{background:url(data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2220%22%20height%3D%2220%22%20fill%3D%22%23fff%22%3E%3Cpath%20d%3D%22M10.707%2010.5l5.646-5.646c.195-.195.195-.512%200-.707s-.512-.195-.707%200L10%209.793%204.354%204.147c-.195-.195-.512-.195-.707%200s-.195.512%200%20.707L9.293%2010.5l-5.646%205.646c-.195.195-.195.512%200%20.707.098.098.226.146.354.146s.256-.049.354-.146l5.646-5.646%205.646%205.646c.098.098.226.146.354.146s.256-.049.354-.146c.195-.195.195-.512%200-.707L10.709%2010.5z%22%2F%3E%3C%2Fsvg%3E) no-repeat center,rgba(0,0,0,0.5);background-size:80%}.aries_controlIcon.aries_mutedSpeaker,.aries_controlIcon.aries_unmutedSpeaker{background:url(data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2220%22%20fill%3D%22%23fff%22%3E%3Cpath%20d%3D%22M13.653%2014.881c-.145%200-.289-.063-.388-.184-.174-.214-.142-.529.072-.703C14.394%2013.135%2015%2011.861%2015%2010.501s-.606-2.633-1.662-3.493c-.214-.174-.247-.489-.072-.703s.489-.247.703-.072C15.26%207.283%2016%208.839%2016%2010.502s-.74%203.218-2.031%204.269c-.093.075-.204.112-.315.112zM11.762%2012.552c-.145%200-.289-.063-.388-.184-.174-.214-.142-.529.072-.703.352-.287.554-.711.554-1.164s-.202-.878-.554-1.164c-.214-.174-.247-.489-.072-.703s.489-.247.703-.072c.587.477.923%201.184.923%201.94s-.337%201.463-.923%201.94c-.093.075-.204.112-.315.112zM8.15%203.207c-.247%200-.494.104-.736.309L3.316%206.999H1.5c-.827%200-1.5.673-1.5%201.5v4c0%20.827.673%201.5%201.5%201.5h1.816l4.098%203.483c.241.205.489.309.736.309.272%200%20.516-.132.67-.362.119-.179.18-.408.18-.68v-12.5c0-.72-.427-1.043-.85-1.043zM1%2012.5v-4c0-.276.224-.5.5-.5H3v5H1.5c-.276%200-.5-.224-.5-.5zm7%204.169l-4-3.4V7.731l4-3.4v12.338z%22%2F%3E%3C%2Fsvg%3E) no-repeat center,rgba(0,0,0,0.5)}.aries_controlIcon.aries_mutedSpeaker{background:url(data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%2220%22%20fill%3D%22%23fff%22%3E%3Cpath%20d%3D%22M8.15%203.207c-.247%200-.494.104-.736.309L3.316%206.999H1.5c-.827%200-1.5.673-1.5%201.5v4c0%20.827.673%201.5%201.5%201.5h1.816l4.098%203.483c.241.205.489.309.736.309.272%200%20.516-.132.67-.362.119-.179.18-.408.18-.68v-12.5c0-.72-.427-1.043-.85-1.043zM1%2012.5v-4c0-.276.224-.5.5-.5H3v5H1.5c-.276%200-.5-.224-.5-.5zm7%204.169l-4-3.4V7.731l4-3.4v12.338z%22%2F%3E%3C%2Fsvg%3E) no-repeat center,rgba(0,0,0,0.5);background-size:34%}.aries_brandIcon{position:absolute;cursor:pointer;background:url(\"data:image/svg+xml;utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20270%20270%22%3E%3Cpath%20d%3D%22M48%200h174c27%200%2048%2022%2048%2048v174c0%2027-21%2048-48%2048H48c-26%200-48-21-48-48V48C0%2022%2022%200%2048%200z%22%2F%3E%3Cg%20fill%3D%22%23fff%22%3E%3Cpath%20d%3D%22M111%20228c17%200%2033-9%2040-26l54-116h-7c-16%201-33%2010-39%2027l-54%20115h6z%22%2F%3E%3Cpath%20fill-rule%3D%22evenodd%22%20d%3D%22m57%20142%2046%2083%203-8c4-9%206-17%206-25s-2-15-6-24c-8-15-25-26-42-26h-7zM196%2042c-9%200-17%208-17%2017s8%2017%2017%2017%2017-8%2017-17-8-17-17-17z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\") no-repeat center;pointer-events:auto}.aries_caption{position:absolute;color:#bbb;text-transform:uppercase;font-family:sans-serif;line-height:1}.aries_stretched{width:100%!important;height:100%!important}.aries_fixed{position:fixed}.aries_hidden{visibility:hidden}.aries_left{left:0}.aries_hcenter{left:50%;transform:translateX(-50%)}.aries_right{right:0}.aries_top{top:0}.aries_vcenter{align-self:center}.aries_bottom{top:100%;transform:translateY(-100%)}.aries_hcenter.aries_bottom{transform:translate(-50%,-100%)}.aries_rollAnimation{transition-property:max-width,max-height,margin}.aries_fadeAnimation{transition-property:opacity}.aries_fadeAnimation.aries_collapsed{opacity:0!important;max-width:initial!important;max-height:initial!important}.aries_VPAID,.aries_wrapperLayer.aries_adSlot>div{border:0;min-width:100%;min-height:100%}.aries_wrapperLayer.aries_adSlot>div{top:0;z-index:-1}.aries_scrollTrack{position:fixed;top:0;left:0;width:100%;height:100%;overflow:scroll;z-index:2147483647;visibility:hidden}.aries_pageShadow{width:100%;height:100%;background:rgba(0,0,0,.2)}.aries_resizeObserver{position:absolute;left:0;top:0;width:100%;height:100%;border:0}.mox,.vidverto{position:absolute!important;top:0!important;left:0!important;width:100%!important;height:100%!important}.aries_stage .ytbtn{position:absolute!important;left:7px!important;bottom:55px!important;z-index:10!important;border-radius:3px;background-color:#c00;border:none;color:#fff;text-align:center;font-family:inherit;font-size:.9rem;font-weight:300;padding:3px 6px;max-width:220px;transition:.5s;cursor:pointer;margin:4px;line-height:initial}.aries_stage .ytbtn span{cursor:pointer;display:inline-block;position:relative;transition:.5s}.aries_stage .ytbtn span::after{content:\"\xBB\";position:absolute;opacity:0;top:0;right:-5px;transition:.5s}.aries_stage .ytbtn:hover span{padding-right:15px}.aries_stage .ytbtn:hover span::after{opacity:1;right:0}"));var i=t.getElementsByTagName("script")[0];i.insertAdjacentElement("beforebegin",e),this._cssRules=Array.prototype.slice.call(e.sheet.rules||e.sheet.cssRules||[])},v.prototype._retrieveRules=function(e,t){e.split(";").forEach(function(e){if(e.trim()){var i=e.split(":"),o=i[0].trim(),a=i[1].trim();t[o]&&~t[o].indexOf("important")&&!~a.indexOf("important")||(t[o]=a)}}.bind(this))},v.prototype._normalize=function(e){if("undefined"!=typeof e.inset){var t=e.inset.split(" ");e.top=t[0],e.right=t[1],e.bottom=t[2],e.left=t[3]}},v.prototype.getRules=function(e){var i={};return this._cssRules.forEach(function(o){var a=Array.prototype.slice.call(t.querySelectorAll(o.selectorText));~a.indexOf(e)&&this._retrieveRules(o.style.cssText,i)}.bind(this)),this._retrieveRules(e.style.cssText,i),this._normalize(i),i};var A=function(e){_.call(this),this._root=e,this._updateOffset(),this._defineInitialValues(),this._bindListener()};A.CONST={DIRECTION:{X:{LEFT:"left",NONE:"none",RIGHT:"right"},Y:{UP:"up",NONE:"none",DOWN:"down"}},EDGE:{TOP:"top",BOTTOM:"bottom"}},A.prototype._updateOffset=function(){this._offset=this._root===e?{top:e.pageYOffset||t.documentElement.scrollTop,left:e.pageXOffset||t.documentElement.scrollLeft}:{top:this._root.scrollTop,left:this._root.scrollLeft}},A.prototype._defineInitialValues=function(){this._t=Date.now(),this._S=this._offset},A.prototype._bindListener=function(){this._root.addEventListener("scroll",function(){this._updateOffset(),this._collectDeltas(),this._calculateParameters(),this.emit(new u("scroll",this))}.bind(this),{passive:!0})},A.prototype._collectDeltas=function(){this._deltas=this._deltas||[];var e=Date.now(),t=this._offset;this._deltas.push({t:e-this._t,S:{x:t.left-this._S.left,y:t.top-this._S.top}}),this._t=e,this._S={left:t.left,top:t.top}},A.prototype._calculateParameters=function(){this._parameters=this._parameters||{};var e=this._deltas[this._deltas.length-1],t=0===e.S.x?"NONE":0>e.S.x?"LEFT":"RIGHT",i=0===e.S.y?"NONE":0>e.S.y?"UP":"DOWN";this._parameters.direction={x:A.CONST.DIRECTION.X[t],y:A.CONST.DIRECTION.Y[i]},this._parameters.delta={t:e.t,x:Math.abs(e.S.x),y:Math.abs(e.S.y)}},A.prototype._prepareTarget=function(e){e.style.position="relative";var i=t.createElement("div"),o=t.createElement("div");i.style.cssText="position: absolute; top: 0; width: 100%;",o.style.cssText="position: absolute; bottom: 0; width: 100%;",e.insertAdjacentElement("afterbegin",i),e.insertAdjacentElement("beforeend",o)},A.prototype._createInViewHandler=function(t){e.inViewWindow=e;var i=e.inView();return i.offset({top:t,bottom:t,left:0,right:0}),i},A.prototype.observeViewportIntersection=function(e,t){this._prepareTarget(e);var i=this._createInViewHandler(t),o=this._createInViewHandler(t);i(e.firstChild).on("enter",this.emit.bind(this,new u("enter",A.CONST.EDGE.TOP))),i(e.firstChild).on("exit",this.emit.bind(this,new u("exit",A.CONST.EDGE.TOP))),o(e.lastChild).on("enter",this.emit.bind(this,new u("enter",A.CONST.EDGE.BOTTOM))),o(e.lastChild).on("exit",this.emit.bind(this,new u("exit",A.CONST.EDGE.BOTTOM)))},A.prototype.observeMotionInViewport=function(e,t){var i=this._createInViewHandler(t);this.on("scroll",function(){var t=i.is(e.firstChild),o=i.is(e.lastChild),a=t||o,n=a&&!(t&&o)?A.CONST.EDGE[t?"TOP":"BOTTOM"]:null;a&&this.emit(new u("motion",n))}.bind(this))},A.prototype.inViewport=function(e,t,i){var o=this._createInViewHandler(i);return o.is(e[t===A.CONST.EDGE.TOP?"firstChild":"lastChild"])},A.prototype.getParameters=function(){return this._parameters},A.prototype.getOffset=function(){return this._offset},A.prototype.increaseScroll=function(e){this._root.scrollTo(this._offset.left+e.x,this._offset.top+e.y)};var S=function(){_.call(this),this._status=S.CONST.STATUS.PASSIVE,this._body=t.getElementsByTagName("body")[0],this._createScrollTrack(),this._setUpScrollingServices(),this._bindListeners()};S.CONST={STATUS:{PASSIVE:"passive",PREPARED:"prepared",INTERCEPTED:"intercepted"}},S.prototype._createScrollTrack=function(){this._scrollTrack=t.createElement("div"),this._scrollTrack.classList.add(i.PREFIX+"scrollTrack"),this._pageShadow=t.createElement("div"),this._pageShadow.classList.add(i.PREFIX+"pageShadow"),this._scrollTrack.appendChild(this._pageShadow),this._body.appendChild(this._scrollTrack)},S.prototype._setUpScrollingServices=function(){this._windowScrollingHandler=new A(e),this._trackScrollingHandler=new A(this._scrollTrack)},S.prototype._bindListeners=function(){this._windowScrollingHandler.on("scroll",this._onScroll.bind(this,S.CONST.STATUS.PASSIVE)),this._trackScrollingHandler.on("scroll",this._onScroll.bind(this,S.CONST.STATUS.INTERCEPTED))},S.prototype._onScroll=function(e,t){if(this._status===S.CONST.STATUS.PREPARED)return void(this._status=S.CONST.STATUS.INTERCEPTED);var i=t.getData();this.emit(new u("scroll",i.getParameters())),this.emit(new u("scroll:"+e,i.getParameters()))},S.prototype._updateScrollTrack=function(){this._updatePageShadow(),this._body.appendChild(this._scrollTrack);var e=this._windowScrollingHandler.getOffset().top;this._scrollTrack.scrollTo(0,e)},S.prototype._updatePageShadow=function(){var e=t.documentElement,i=Math.max(this._body.scrollHeight,this._body.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight);this._pageShadow.style.height=i+"px"},S.prototype._enableScrollTrack=function(){this._initialBodyOverflow=this._body.style.overflow,this._body.style.overflow="hidden",this._scrollTrack.style.visibility="visible"},S.prototype._disableScrollTrack=function(){this._body.style.overflow=this._initialBodyOverflow,this._scrollTrack.style.visibility=""},S.prototype.intercept=function(){this._status!==S.CONST.STATUS.PASSIVE||(this._status=S.CONST.STATUS.PREPARED,this._updateScrollTrack(),this._enableScrollTrack())},S.prototype.cancelInterception=function(){this._status===S.CONST.STATUS.PASSIVE||(this._status=S.CONST.STATUS.PASSIVE,this._disableScrollTrack())},e.IMA=i})(window,document);