"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2342],{36637:(e,i,a)=>{a.d(i,{g:()=>s});var n=a(69736),l=a(63068),t=a(11527);const s=e=>{let{children:i}=e;return(0,t.jsx)(n.x,{variant:"bodySmall",className:l.Z.pretitle,children:i})}},66873:(e,i,a)=>{a.d(i,{x:()=>u});var n=a(50959),l=a(76950),t=a(50540),s=a(30374),r=a(2990),o=a(71459),d=a(8499),c=a(11527);const u=e=>{let{children:i,action:a,uri:u}=e;const m=(0,t.g)(),g=(0,r.j)();let h;const b=()=>{const e={triggerId:d.K,triggerAction:{type:a}};o.y.set((i=>({...i,...e}))),g.storeAction(s.wH,{operation:l.pT.ADD,uris:[u]})};try{h=n.Children.only(i)}catch(v){return(0,c.jsx)(c.Fragment,{children:i})}return m?n.cloneElement(h,{onClick:b}):(0,c.jsx)(c.Fragment,{children:i})}},30521:(e,i,a)=>{a.r(i),a.d(i,{default:()=>Ge});a(75930),a(92027),a(86277),a(65484),a(35174),a(96241);var n=a(50959),l=a(82187),t=a.n(l),s=a(75390),r=a(29132),o=a(75802),d=a(69736),c=a(87025),u=a(80859),m=a(10226),g=a(93175),h=a(85648),b=a(29770),v=a(20580),k=a(16972),p=a(41038),x=a(97922),y=a(81639),j=a(16118),f=a(91643),N=a(57986),I=a(20069);const S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"queryAlbumMerch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"albumUnion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"merch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumMerchItem"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumMerchItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Merch"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]};var w=a(18118);const A="iEG0moJ3mt1_j9Lho7MA";var C=a(11527);const L=e=>{var i;let{albumName:a,albumURI:n}=e;const{data:l}=(t={uri:n},s={gcTime:5*I.y},(0,I.a)(S,t,s));var t,s;const r=null!=l&&l.albumUnion&&"merch"in l.albumUnion?null==l||null===(i=l.albumUnion)||void 0===i||null===(i=i.merch)||void 0===i?void 0:i.items:[];return r&&(null==r?void 0:r.length)>0?(0,C.jsx)("div",{className:"contentSpacing",children:(0,C.jsx)("div",{className:A,children:(0,C.jsx)(w.s,{id:a,uri:n,merchItems:r,merchVariant:"Album page merch items"})})}):null};var P=a(19848),U=a(32793),F=a(47262),M=a(66713),T=a(23255),R=a(22527),E=a(29673),B=a(80626),V=a(82857),O=a(43104),D=a(80683),z=a(67408),_=a(22795),q=a(47895),Q=a(15842),Y=a(66205),Z=a(38338),H=a(57562),W=a(97013),K=a(66873),X=a(66819),$=a(13734),J=a(9443),G=a(64222),ee=a(91529),ie=a(25230),ae=a(72417);const ne="n8Bz0c0v17whD3KfMdOk",le="zddjxV2lX9ukNM5QXloA",te="lVqlPjQLuQhK2flsxB78",se="O_EguRjsZ4uI1hHamkOA",re="jcaQQxoVnuuhtVwDJU1R",oe="fLS8v3_EfBadEerbGVoR",de="in4OjUTflcsoj9RUpf05",ce="xaPiqLlyzjAbzAaXfU1y",ue="vveb4Rn0dK_r8YUM7L_n",me=n.memo((function(e){var i;let{uri:a,togglePlay:l,isPlaying:t,isActive:s,spec:r,logger:o,backgroundColor:d,name:c,artists:u,isPlayable:m,sharingInfo:g}=e;const b=(0,$.o)(),p=(0,J.k)(),x=(0,_.y)(),y=(0,n.useMemo)((()=>r.actionBarFactory()),[r]),[j,f]=(0,_.Z)(a),I=(0,n.useCallback)((()=>{const e=(0,G.aK)({isPlaying:t,isActive:s,spec:y.playButtonFactory(),logger:o,uri:a});l({loggingParams:e})}),[t,s,l,y,o,a]),S=(0,n.useCallback)((async()=>{let e;const i=y.saveButtonFactory();e=j?i.hitDislike({itemToBeDisliked:a}):i.hitLike({itemToBeLiked:a}),o.logInteraction(e),b({targetUri:a,intent:j?"unsave":"save",type:"click"});try{await f(!j)}catch{}}),[b,a,j,f,y,o]),w=(0,ae.Q)(),A=(0,X.j)();return(0,C.jsx)(Q.o,{backgroundColor:d,children:(0,C.jsxs)(Y.F,{children:[(0,C.jsx)(N.$,{onClick:I,disabled:!m,isPlaying:t,size:A,uri:a}),w&&(0,C.jsx)(B.Nh,{spec:y,children:(0,C.jsx)(ie.K,{entityName:c,contextUri:a,activationPlacement:"bottomEnd",size:A})}),(0,C.jsx)(K.x,{uri:a,action:ee.sr.SAVE_ALBUM,children:(0,C.jsx)(Z.H,{isAdded:!!j,onClick:S,disabled:!(p||null!=x&&x.getCapabilities().canModifyOffline),size:A})}),(0,C.jsx)(H.o,{uri:a,isFollowing:!!j,onClick:(e,i)=>(0,G.l7)(i,y.downloadButtonFactory(),o,a),onFollow:S,size:A}),(0,C.jsx)(v.yj,{onShow:()=>(0,G.qq)(y,o),menu:(0,C.jsx)(k.Y,{uri:a,artistUri:null==u||null===(i=u[0])||void 0===i?void 0:i.uri,sharingInfo:g}),children:(0,C.jsx)(W.z,{label:h.ag.get("more.label.context",c),size:A})}),(0,C.jsx)("div",{className:ue,children:(0,C.jsx)(D.F,{property:q.FM,renderNewExperience:()=>(0,C.jsx)(z.A,{options:[],onSelect:()=>{},selected:null,enableViewModeMenu:!0})})})]})})}));var ge=a(41981);const he=864e5,be=365.25*he;var ve=a(36637),ke=a(9108),pe=a(36255),xe=a(39600),ye=a(40234),je=a(58301),fe=a(17676);var Ne=a(1142),Ie=a(48948),Se=a(11317),we=a(51450),Ae=a(50540),Ce=a(24071),Le=a(95504),Pe=a(91530),Ue=a(87350);var Fe=a(62116),Me=a(90779),Te=a(40537),Re=a(80515),Ee=a(58912);const Be="TCmZzqInstJMZjkHgnw3",Ve="PeNI572tTpqsN23o3QhJ",Oe="oUsSfFiifMPXqW0kHjR6",De="XKvEMQZlPfPncTqiitM5",ze="GdbPVlmUCW0Q6ZZ0z0wh",_e="Hu7O5y7x5c7wUYFbnIoS",qe=n.memo((function(e){const{images:i,title:a,isOpen:l,onClose:t}=e,s=(0,n.useMemo)((()=>(0,Ee.X)(i,{desiredSize:1e4})),[i]);return s?(0,C.jsx)(Te.Z,{className:Be,isOpen:l,onRequestClose:t,animation:{modal:{base:De,afterOpen:ze,beforeClose:_e}},animated:!0,children:(0,C.jsxs)("div",{style:{"--image-width":`${s.width}px`,"--image-height":`${s.height}px`},className:Ve,children:[(0,C.jsx)(Re.E,{loading:"eager",alt:a,src:s.url,className:Oe}),(0,C.jsx)(Me.o,{onClick:t,semanticColor:"textBase",children:h.ag.get("web-player.cover-art-modal.close")})]})}):null}));var Qe=a(6807),Ye=a(14892);const Ze=e=>{let{releases:i}=e;return(0,C.jsx)(Qe.v,{children:i.map((e=>(0,C.jsx)(Ye.s,{role:"menuitem",to:(0,Se.EC)(e.uri).toURLPath(!0),children:e.name},e.uri)))})};var He=a(43192),We=a(50760),Ke=a(78947);const Xe=n.lazy((()=>a.e(4373).then(a.bind(a,4373))));function $e(e){switch(e){case We.V.Single:return h.ag.get("single");case We.V.Ep:return h.ag.get("ep");case We.V.Compilation:return h.ag.get("compilation");case We.V.Audiobook:return h.ag.get("card.tag.audiobook");case We.V.Album:default:return h.ag.get("album")}}const Je=e=>{var i,a,l,f,I,S,w,A,T,D;let{uri:z,album:_}=e;const q=(0,o.TH)(),{spec:Q,logger:Y,UBIFragment:Z}=(0,B.fU)(g.w,{data:{uri:z}}),H=(0,n.useMemo)((()=>Q.trackListFactory()),[Q]),W=(0,n.useMemo)((()=>Q.moreByArtistShelfFactory()),[Q]),K=_.moreAlbumsByArtist,X=parseInt(new URLSearchParams((0,o.TH)().search).get("index")||"0",10),$=(0,U.Y)(z),{usePlayContextItem:J,togglePlay:G,isPlaying:ee,isActive:ie}=(0,R.n)({uri:$},{featureIdentifier:"album"}),ae=(0,n.useCallback)(((e,i)=>{if(Q){const e=Q.headerFactory().artistNameFactory().hitUiNavigate({destination:i.creator.uri});Y.logInteraction(e)}}),[Y,Q]),{isOpen:ue,openModal:Me,closeModal:Te}=(()=>{const[e,i]=(0,n.useState)(!1);return{isOpen:e,openModal:(0,n.useCallback)((()=>i(!0)),[]),closeModal:(0,n.useCallback)((()=>i(!1)),[])}})(),Re=(0,m.W6)(fe.DUY,{loadingValue:!1})?{onClick:Me,ariaLabel:h.ag.get("web-player.album.open_coverart_modal")}:{},Ee=(0,n.useCallback)((()=>new URLSearchParams(q.search.slice(1)).get("highlight")||""),[q.search]),Be=_.uri,Ve=_.name,Oe=_.albumType,De=null===(i=_.release)||void 0===i?void 0:i.date,ze=null===(a=_.release)||void 0===a?void 0:a.precision,_e=_.nrTracks,Qe=_.images,Ye=null===(l=_.extractedColors)||void 0===l?void 0:l.colorRaw.hex,He=_.artists,We=_.isPlayable,Je=_.isCatalogueRestricted,Ge=_.copyright.items,ei=_.courtesyLine,ii=_.duration.durationMs,ai=_.duration.isEstimate,ni=Ee(),li=(null===(f=(0,r.v9)(Ue.Gg).overrides)||void 0===f?void 0:f.locale)??h.ag.getLocaleForTranslation(),ti=(0,Fe.k)({uri:z,type:"locale"}),si=(0,E.OT)({albumName:Ve,albumType:Oe,albumArtists:He.map((e=>e.name)).join(h.ag.getSeparator()),shouldLocalize:ti,i18n:h.ag});(0,F.Y5)(Ye||null);const{albumILRAboveEnabled:ri,albumILRBelowEnabled:oi}=(()=>{const e=(0,je.E)(),i=(0,o.TH)(),a=(0,m.W6)(fe.t2x),n=(0,xe.vI)(ye.k.ILRAlbumAbove,i),l=(0,xe.vI)(ye.k.ILRAlbumBelow,i);return e?{albumILRAboveEnabled:!l&&(n||a===fe.wPk.ABOVE),albumILRBelowEnabled:!n&&(l||a===fe.wPk.BELOW)}:{albumILRAboveEnabled:!1,albumILRBelowEnabled:!1}})(),di=function(e){return(0,n.useMemo)((()=>{if(null==e||!e.date)return null;if("day"===e.precision){const i=new Date(e.date),a=(new Date).getTime()-i.getTime(),n=a%be;return n<3.5*he||n>312552e5?Math.round(a/be):null}return null}),[e])}(_.release),{isCompactMode:ci}=(0,P.mJ)(),ui=(e=>{const i=(0,Ae.g)(),a=(0,Ce.s4)(),l=(0,m.W6)(fe.t2x),t=(0,r.v9)(Ue.n5),s=(0,r.v9)(Pe.rZ);return(0,n.useCallback)((async()=>{if(!(0,Se.YF)(e))return;const n={category:"album_ilr_component_visible",action:"viewed",variant:l,label:"dwp",os:(0,Le.y)(),context:e,country:t?s:"",sp_t:(0,we.vQ)("sp_t")};i?a.send((0,Ie.k)(n)):a.send((0,Ne.x)(n))}),[e,s,a,i,t,l])})(z),{ref:mi,inView:gi}=(0,s.YD)({threshold:0});return(0,n.useEffect)((()=>{gi&&ui()}),[gi,ui]),(0,C.jsxs)("section",{className:ne,"data-testid":"album-page",children:[(0,C.jsx)(p.$,{children:si}),null!==di?(0,C.jsx)(n.Suspense,{fallback:null,children:(0,C.jsx)(Xe,{colorLight:null==_||null===(I=_.extractedColors)||void 0===I?void 0:I.colorLight.hex,colorDark:null==_||null===(S=_.extractedColors)||void 0===S?void 0:S.colorDark.hex,name:Ve,years:di})}):null,(0,C.jsxs)(x.gF,{backgroundColor:Ye,children:[(0,C.jsxs)(y.W,{children:[(0,C.jsx)(N.$,{size:"medium",onClick:()=>G(),disabled:!We,isPlaying:ee,uri:z}),(0,C.jsx)(j.i,{text:Ve,dragUri:z,dragLabel:Ve})]}),(0,C.jsx)(v._P,{menu:(0,C.jsx)(k.Y,{uri:_.uri,artistUri:null==He||null===(w=He[0])||void 0===w?void 0:w.uri,sharingInfo:_.sharingInfo}),children:(0,C.jsx)(x.Oz,{dragUri:Be,images:Qe,name:Ve,placeholderType:"album",...Re})}),(0,C.jsxs)(x.sP,{children:[(0,C.jsx)(ve.g,{children:$e(Oe)}),(0,C.jsx)(v._P,{menu:(0,C.jsx)(k.Y,{uri:_.uri,artistUri:null==He||null===(A=He[0])||void 0===A?void 0:A.uri,sharingInfo:_.sharingInfo}),children:(0,C.jsx)(x.xd,{dragUri:_.uri,dragLabel:_.name,scaleAtMinWidth:x.vz,children:Ve})}),(0,C.jsx)(x.QS,{creators:He,onCreatorClick:ae,releaseDate:De,releaseDatePrecision:ze,totalItems:_e,durationMilliseconds:ii,isEstimatedDuration:ai,hasTracks:!0})]})]}),(0,C.jsx)(me,{backgroundColor:Ye,uri:z,togglePlay:G,isPlaying:ee,isActive:ie,spec:Q,logger:Y,sharingInfo:_.sharingInfo,name:_.name,artists:_.artists,isPlayable:_.isPlayable}),Je?(0,C.jsxs)("div",{className:le,children:[(0,C.jsx)(d.x,{as:"h2",variant:"bodyMediumBold",className:te,children:h.ag.get("windowed.product-album-header")}),(0,C.jsx)("div",{className:se,children:h.ag.get("windowed.product-album-description")})]}):null,(0,C.jsxs)("div",{className:"contentSpacing",children:[(0,C.jsx)(Z,{spec:H,children:(0,C.jsx)(ge.L,{ariaLabel:Ve,nrTracks:(0,Ke.y)(_.discs)?_.discs.totalCount+_e:_e,discs:_.discs,albumUri:Be,highlightUri:ni,scrollToIndex:X,usePlayContextItem:J,initalTracks:_.items,isCompactMode:ci})}),(0,C.jsxs)("div",{className:de,children:[(0,C.jsxs)("div",{children:[De&&(0,C.jsx)(d.x,{as:"p",variant:"bodySmall",children:(0,O.BI)((0,O.RX)(De),li,{year:"numeric",month:"long",day:"numeric"},ze)}),(0,C.jsx)(M.k,{copyrights:Ge,courtesyLine:ei})]}),_.releases.items.length>0&&(0,C.jsx)(v.xV,{menu:(0,C.jsx)(Ze,{releases:_.releases.items}),children:(e,i,a)=>(0,C.jsxs)("button",{ref:a,className:oe,type:"button",onClick:i,children:[(0,C.jsx)(d.x,{variant:"bodySmall",children:h.ag.get("album-page.more-releases",_.releases.items.length)}),e?(0,C.jsx)(c.U,{size:"small"}):(0,C.jsx)(u.i,{size:"small"})]})})]})]}),ri&&(0,C.jsx)("div",{className:t()("contentSpacing",ce),"data-testid":"placeholder-album-ilr-above",children:(0,C.jsx)(ke.y,{subtitle:h.ag.get("internal-link-recommender.based-on-this-album"),uri:_.uri,inViewRef:mi,entityType:V.p.ALBUM})}),(0,C.jsx)(L,{albumName:Ve,albumURI:Be}),(0,C.jsxs)(C.Fragment,{children:[(null==K?void 0:K.length)>0&&(0,C.jsx)("div",{className:"contentSpacing",children:(0,C.jsx)(Z,{spec:W,children:(0,C.jsx)(pe.q,{index:0,id:"more-albums",className:re,title:h.ag.get("album-page.more-by-artist",null==He||null===(T=He[0])||void 0===T?void 0:T.name),total:K.length,seeAllUri:`${null==He||null===(D=He[0])||void 0===D?void 0:D.uri.replace("artist","app:artist")}:discography`,seeAllLabel:h.ag.get("artist-page.show-discography"),alwaysShowSeeAll:!0,children:K.map(((e,i)=>(0,C.jsx)(b.i,{index:i,artists:He,images:e.images||[],name:e.name,uri:e.uri,year:e.year,type:e.albumType,sharingInfo:e.sharingInfo},e.uri)))})})}),oi&&(0,C.jsx)("div",{className:t()("contentSpacing",ce),"data-testid":"placeholder-album-ilr-below",children:(0,C.jsx)(ke.y,{subtitle:h.ag.get("internal-link-recommender.based-on-this-album"),uri:_.uri,inViewRef:mi,entityType:V.p.ALBUM})})]}),(0,C.jsx)(qe,{title:si,isOpen:ue,onClose:Te,images:Qe})]})},Ge=n.memo((function(){const{albumId:e}=(0,o.UO)(),i=`spotify:album:${e}`,{loading:a,error:n,data:l,canLoadOffline:t}=(0,He.j)(i);return a||!l?(0,C.jsx)(f.h,{hasError:null!==n,loadOffline:t,errorMessage:h.ag.get("error.not_found.title.album")}):(0,C.jsx)(T.fd,{surface:T.Tg.ALBUM,uris:[i],children:(0,C.jsx)(Je,{uri:i,album:l})})}))},39600:(e,i,a)=>{a.d(i,{vI:()=>n});a(75930),a(86277),a(65484),a(35174),a(96241);const n=(e,i)=>{const a=i?new URLSearchParams(i.search):void 0;return"1"===(null==a?void 0:a.get(e))}},40234:(e,i,a)=>{a.d(i,{k:()=>n});let n=function(e){return e.I18nSEO="i18nSEO",e.RTPTrackCredits="rtpv2p2",e.I18nAdditionalPages="i18nap",e.RichPlaylistPages="rpp",e.ILRAlbum="ilra",e.ILRAlbumAbove="ilraa",e.ILRAlbumBelow="ilrab",e.ILRShow="ilrs",e.PlaylistInternalTrackLinks="pitl",e.PlaylistInternalTrackAndArtistLinks="pital",e}({})}}]);
//# sourceMappingURL=xpui-routes-album.c0793f37.js.map