/*! 2021-04-21 11:10:05 AM */
window.livechat=window.livechat||{},window.livechat.VERSION="1.0.0",Object.defineProperty(Array.prototype,"nativeReduce",{enumerable:!1,value:nativeReduce});var nativeReduce=function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,n=Object(this),i=n.length>>>0,r=0;if(2==arguments.length)t=arguments[1];else{for(;r<i&&!r in n;)r++;if(i<=r)throw new TypeError("Reduce of empty array with no initial value");t=n[r++]}for(;r<i;r++)r in n&&(t=e(t,n[r],r,n));return t},livechat=livechat||{};if(window.io&&(window.previous_io=window.io),function(e){var t,C;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.io={1:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,n){var o=e("./url"),i=e("socket.io-parser"),s=e("./manager"),a=e("debug")("socket.io-client");t.exports=n=r;var c=n.managers={};function r(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n=o(e),i=n.source,r=n.id;return(t.forceNew||t["force new connection"]||!1===t.multiplex?(a("ignoring socket cache for %s",i),s(i,t)):(c[r]||(a("new io instance for %s",i),c[r]=s(i,t)),c[r])).socket(n.path)}n.protocol=i.protocol,n.connect=r,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(e,t,n){e("./url");var a=e("engine.io-client"),i=e("./socket"),r=e("component-emitter"),o=e("socket.io-parser"),c=e("./on"),s=e("component-bind"),l=(e("object-component"),e("debug")("socket.io-client:manager")),u=e("indexof"),h=e("backo2");t.exports=d).prototype.emitAll=d.prototype.updateSocketIds=r(d.prototype),d.prototype.reconnection=d.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=d.prototype.timeout=d.prototype.maybeReconnectOnOpen=d.prototype.open=d.prototype.connect=d.prototype.onopen=d.prototype.ondata=function(e){this.decoder.add(e)},d.prototype.ondecoded=function(e){this.emit("packet",e)},d.prototype.onerror=d.prototype.socket=d.prototype.destroy=d.prototype.packet=d.prototype.processPacketQueue=d.prototype.cleanup=d.prototype.close=d.prototype.disconnect=d.prototype.onclose=d.prototype.reconnect=d.prototype.onreconnect=,{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[{}],5:[function(e,t,n){var o=e("socket.io-parser"),i=e("component-emitter"),s=e("to-array"),r=e("./on"),a=e("component-bind"),c=e("debug")("socket.io-client:socket"),l=e("has-binary");t.exports=d;var u={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},h=i.prototype.emit;(d.prototype),d.prototype.subEvents=d.prototype.open=d.prototype.connect=d.prototype.send=d.prototype.emit=d.prototype.packet=d.prototype.onopen=d.prototype.onclose=d.prototype.onpacket=d.prototype.onevent=d.prototype.ack=d.prototype.onack=d.prototype.onconnect=d.prototype.emitBuffered=d.prototype.ondisconnect=d.prototype.destroy=d.prototype.close=d.prototype.disconnect=,{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(e,t,n){(function(i){var r=e("parseuri"),o=e("debug")("socket.io-client:url");t.exports=function(e,t){var n=e,t=t||i.location;return null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.hostname+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/",n.id=n.protocol+"://"+n.host+":"+n.port,n.href=n.protocol+"://"+n.host+(t&&t.port==n.port?"":":"+n.port),n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:44}],7:[function(e,t,n){t.exports=i).prototype.duration=i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(e){this.ms=e},i.prototype.setMax=function(e){this.max=e},i.prototype.setJitter=function(e){this.jitter=e}},{}],8:[{}],9:[function(e,t,n){t.exports=i).prototype.on=i.prototype.addEventListener=i.prototype.once=i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=i.prototype.emit=i.prototype.listeners=i.prototype.hasListeners=,{}],10:[function(e,t,n){t.exports=o).names=[],o.skips=[],o.enable=o.disable=function(){o.enable("")},o.humanize=o.enabled=try{window.localStorage&&o.enable(localStorage.debug)}catch(e){}},{}],11:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":12}],12:[{"./socket":13,"engine.io-parser":25}],13:[function(t,l,e){(function(i){var r=t("./transports"),e=t("component-emitter"),h=t("debug")("engine.io-client:socket"),o=t("indexof"),s=t("engine.io-parser"),a=t("parseuri"),n=t("parsejson"),c=t("parseqs");l.exports=d).priorWebsocketSuccess=!1,e(d.prototype),d.protocol=s.protocol,(d.Socket=d).Transport=t("./transport"),d.transports=t("./transports"),d.parser=t("engine.io-parser"),d.prototype.createTransport=function(e){h('creating transport "%s"',e);var t=this.query);t.EIO=s.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new r[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return n},d.prototype.open=d.prototype.setTransport=d.prototype.probe=d.prototype.onOpen=d.prototype.onPacket=d.prototype.onHandshake=d.prototype.onHeartbeat=d.prototype.setPing=d.prototype.ping=function(){this.sendPacket("ping")},d.prototype.onDrain=d.prototype.flush=d.prototype.write=d.prototype.send=d.prototype.sendPacket=d.prototype.close=d.prototype.onError=d.prototype.onClose=d.prototype.filterUpgrades=).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[{"component-emitter":9,"engine.io-parser":25}],15:[{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(s,a,e){(function(n){var i=s("./polling"),e=s("component-inherit");a.exports=t;var r,l=/\n/g,u=/\\n/g;function o(){}(t,i),t.prototype.supportsBinary=!1,t.prototype.doClose=t.prototype.doPoll=t.prototype.doWrite=).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(e,t,n){var i=e("../transport"),r=e("parseqs"),o=e("engine.io-parser"),s=e("component-inherit"),a=e("debug")("engine.io-client:polling");t.exports=l;var c=null!=new(e("xmlhttprequest"))({xdomain:!1}).responseType;(l,i),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=l.prototype.poll=l.prototype.onData=l.prototype.doClose=l.prototype.write=l.prototype.uri=,{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(e,t,n){var i=e("../transport"),r=e("engine.io-parser"),o=e("parseqs"),s=e("component-inherit"),a=e("debug")("engine.io-client:websocket"),c=e("ws");.exports=l,s(l,i),l.prototype.name="websocket",l.prototype.supportsBinary=!0,l.prototype.doOpen=l.prototype.addEventListeners="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(l.prototype.onData=,l.prototype.write=l.prototype.onClose=l.prototype.doClose=l.prototype.uri=l.prototype.check=,{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[{"has-cors":40}],21:[{}],22:[function(e,t,o){o=t.exports=e("./debug")).log=o.formatArgs=o.save=o.load=n,o.useColors=o.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],o.formatters.j=function(e){return JSON.stringify(e)},o.enable(n())},{"./debug":23}],23:[function(e,t,a){(a=t.exports=function(e){function t(){}function i(){var r=i,e=+new Date,t=e-(c||e);r.diff=t,r.prev=c,r.curr=e,c=e,null==r.useColors&&(r.useColors=a.useColors()),null==r.color&&r.useColors&&(r.color=a.colors[l++%a.colors.length]);var o=Array.prototype.slice.call(arguments);o[0]=a.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var s=0;o[0]=o[0].replace(/%([a-z%])/g,,"function"==typeof a.formatArgs&&(o=a.formatArgs.apply(r,o));var n=i.log||a.log||console.log.bind(console);n.apply(r,o)}i.enabled=!(t.enabled=!1);var n=a.enabled(e)?i:t;return n.namespace=e,n}).coerce=a.disable=function(){a.enable("")},a.enable=a.enabled=a.humanize=e("ms"),a.names=[],a.skips=[],a.formatters={};var c,l=0},{ms:24}],24:[function(e,t,n){var r=36e5,o=864e5;.exports=function(e,t){return t=t||{},"string"==typeof e?function(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"y":return 315576e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"h":return n*r;case"minutes":case"minute":case"m":return 6e4*n;case"seconds":case"second":case"s":return 1e3*n;case"ms":return n}}}(e):t.long?s(i=e,o,"day")||s(i,r,"hour")||s(i,6e4,"minute")||s(i,1e3,"second")||i+" ms":o<=(n=e)?Math.round(n/o)+"d":r<=n?Math.round(n/r)+"h":6e4<=n?Math.round(n/6e4)+"m":1e3<=n?Math.round(n/1e3)+"s":n+"ms";var n,i}},{}],25:[function(i,e,m){(function(l){var e=i("./keys"),r=i("has-binary"),p=i("arraybuffer.slice"),o=i("base64-arraybuffer"),a=i("after"),u=i("utf8"),t=navigator.userAgent.match(/Android/i),n=/PhantomJS/i.test(navigator.userAgent),h=t||n;m.protocol=3;var d=m.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},s=e(d),f={type:"error",data:"parser error"},g=i("blob");.encodePacket=m.encodeBase64Packet=m.decodePacket=function(e,t,n){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return m.decodeBase64Packet(e.substr(1),t);if(n)try{e=u.decode(e)}catch(e){return f}var i=e.charAt(0);return Number(i)==i&&s[i]?1<e.length?{type:s[i],data:e.substring(1)}:{type:s[i]}:f}var r=new Uint8Array(e),i=r[0],o=p(e,1);return g&&"blob"===t&&(o=new g([o])),{type:s[i],data:o}},m.decodeBase64Packet=m.encodePayload=m.decodePayload=function(e,t,n){if("string"!=typeof e)return m.decodePayloadAsBinary(e,t,n);var i;if("function"==typeof t&&(n=t,t=null),""==e)return n(f,0,1);for(var r,o,s="",a=0,c=e.length;a<c;a++){var l=e.charAt(a);if(":"!=l)s+=l;else{if(""==s||s!=(r=Number(s)))return n(f,0,1);if(o=e.substr(a+1,r),s!=o.length)return n(f,0,1);if(o.length){if(i=m.decodePacket(o,t,!0),f.type==i.type&&f.data==i.data)return n(f,0,1);var u=n(i,a+r,c);if(!1===u)return}a+=r,s=""}}return""!=s?n(f,0,1):void 0},m.encodePayloadAsArrayBuffer=function(e,i){if(!e.length)return i(new ArrayBuffer(0));c(e,},m.encodePayloadAsBlob=function(e,n){c(e,function(e,c){m.encodePacket(e,!0,!0,},},m.decodePayloadAsBinary=function(e,n,i){"function"==typeof n&&(i=n,n=null);for(var t=e,r=[],o=!1;0<t.byteLength;){for(var s=new Uint8Array(t),a=0===s[0],c="",l=1;255!=s[l];l++){if(310<c.length){o=!0;break}c+=s[l]}if(o)return i(f,0,1);t=p(t,2+c.length),c=parseInt(c);var u=p(t,0,c);if(a)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var h=new Uint8Array(u);u="";for(var l=0;l<h.length;l++)u+=String.fromCharCode(h[l])}r.push(u),t=p(t,c)}var d=r.length;r.forEach(}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[{}],27:[{}],28:[{}],29:[{}],30:[function(e,o,t){(function(e){var r=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,t=function(){try{var e=new Blob(["hi"]);return 2==e.size}catch(e){return!1}}(),n=r&&r.prototype.append&&r.prototype.getBlob;.exports=t?e.Blob:n?i:void 0}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[{isarray:32}],32:[{}],33:[function(e,y,b){(function(v){!function(e){var t="object"==typeof b&&b,n="object"==typeof y&&y&&y.exports==t&&y,i="object"==typeof v&&v;i.global!==i&&i.window!==i||(e=i);var o,s,a,c=String.fromCharCode;unction r(e){for(var t,n=e.length,i=-1,r="";++i<n;)65535<(t=e[i])&&(r+=c((t-=65536)>>>10&1023|55296),t=56320|1023&t),r+=c(t);return r}ction p(){var e,t,n,i;if(s<a)throw Error("Invalid byte index");if(a==s)return!1;if(e=255&o[a],a++,0==(128&e))return e;if(192==(224&e)){var r=d();if(128<=(i=(31&e)<<6|r))return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if(r=d(),t=d(),2048<=(i=(15&e)<<12|r<<6|t))return i;throw Error("Invalid continuation byte")}if(240==(248&e)&&(r=d(),t=d(),n=d(),65536<=(i=(15&e)<<18|r<<12|t<<6|n)&&i<=1114111))return i;throw Error("Invalid UTF-8 detected")}var f={version:"2.0.0",encode:function(e){for(var t,n=l(e),i=n.length,r=-1,o="";++r<i;)t=n[r],o+=h(t);return o},decode:function(e){o=l(e),s=o.length,a=0;for(var t,n=[];!1!==(t=p());)n.push(t);return r(n)}};if(t&&!t.nodeType)if(n)n.exports=f;else{var g={}.hasOwnProperty;for(var m in f)g.call(f,m)&&(t[m]=f[m])}else e.utf8=f}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[{}],35:[{}],36:[{}],37:[{}],38:[{isarray:39}],39:[function(e,t,n){t.exports=e(32)},{}],40:[{global:41}],41:[{}],42:[{}],43:[{}],44:[{}],45:[function(e,t,n){(function(u){var h=e("isarray"),d=e("./is-buffer");n.deconstructPacket=function(e){var s=[],t=e.data,n=e;return n.data=function e(t){if(!t)return t;if(d(t)){var n={_placeholder:!0,num:s.length};return s.push(t),n}if(h(t)){for(var i=new Array(t.length),r=0;r<t.length;r++)i[r]=e(t[r]);return i}if("object"!=typeof t||t instanceof Date)return t;var i={};for(var o in t)i[o]=e(t[o]);return i}(t),n.attachments=s.length,{packet:n,buffers:s}},n.reconstructPacket=function(e,o){return e.data=function e(t){if(t&&t._placeholder){var n=o[t.num];return n}if(h(t)){for(var i=0;i<t.length;i++)t[i]=e(t[i]);return t}if(t&&"object"==typeof t){for(var r in t)t[r]=e(t[r]);return t}return t}(e.data),e.attachments=void 0,e},n.removeBlobs=).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(e,t,s){var a=e("debug")("socket.io-parser"),c=e("json3"),n=(e("isarray"),e("component-emitter")),o=e("./binary"),i=e("./is-buffer");function r(){}otocol=4,s.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],s.CONNECT=0,s.DISCONNECT=1,s.EVENT=2,s.ACK=3,s.ERROR=4,s.BINARY_EVENT=5,s.BINARY_ACK=6,s.Encoder=r,s.Decoder=u,r.prototype.encode=function(e,t){if(a("encoding packet %j",e),s.BINARY_EVENT==e.type||s.BINARY_ACK==e.type)i=e,r=t,o.removeBlobs(i,;else{var n=l(e);t([n])}var i,r},n(u.prototype),u.prototype.add=function(e){var t;if("string"==typeof e)t=function(e){var t={},n=0;if(t.type=Number(e.charAt(0)),null==s.types[t.type])return d();if(s.BINARY_EVENT==t.type||s.BINARY_ACK==t.type){for(var i="";"-"!=e.charAt(++n)&&(i+=e.charAt(n),n!=e.length););if(i!=Number(i)||"-"!=e.charAt(n))throw new Error("Illegal attachments");t.attachments=Number(i)}if("/"==e.charAt(n+1))for(t.nsp="";++n;){var r=e.charAt(n);if(","==r)break;if(t.nsp+=r,n==e.length)break}else t.nsp="/";var o=e.charAt(n+1);if(""!==o&&Number(o)==o){for(t.id="";++n;){var r=e.charAt(n);if(null==r||Number(r)!=r){--n;break}if(t.id+=e.charAt(n),n==e.length)break}t.id=Number(t.id)}if(e.charAt(++n))try{t.data=c.parse(e.substr(n))}catch(e){return d()}return a("decoded %s as %j",e,t),t}(e),s.BINARY_EVENT==t.type||s.BINARY_ACK==t.type?(this.reconstructor=new h(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!i(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}},u.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=h.prototype.finishedReconstruction=,{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[{}],48:[{}],49:[function(e,t,w){!function(e){var k,T,S,x={}.toString,t=!1,n="object"==typeof JSON&&JSON,c="object"==typeof w&&w&&!w.nodeType&&w;c&&n?(c.stringify=n.stringify,c.parse=n.parse):c=e.JSON=n||{};var l=new Date(-0xc782b5b800cec);try{l=-109252==l.getUTCFullYear()&&0===l.getUTCMonth()&&1===l.getUTCDate()&&10==l.getUTCHours()&&37==l.getUTCMinutes()&&6==l.getUTCSeconds()&&708==l.getUTCMilliseconds()}catch(e){}function u(e){if(u[e]!==S)return u[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=u("json-stringify")&&u("json-parse");else{var n,i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var r=c.stringify,o="function"==typeof r&&l;if(o){(n=function(){return 1}).toJSON=n;try{o="0"===r(0)&&"0"===r(new Number)&&'""'==r(new String)&&r(x)===S&&r(S)===S&&r()===S&&"1"===r(n)&&"[1]"==r([n])&&"[null]"==r([S])&&"null"==r(null)&&"[null,null,null]"==r([S,x,null])&&r({a:[n,!0,!1,null,"\0\b\n\f\r "]})==i&&"1"===r(null,n)&&"[\n 1,\n 2\n]"==r([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==r(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==r(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==r(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==r(new Date(-1))}catch(e){o=!1}}t=o}if("json-parse"==e){var s=c.parse;if("function"==typeof s)try{if(0===s("0")&&!s(!1)){var a=5==(n=s(i)).a.length&&1===n.a[0];if(a){try{a=!s('" "')}catch(e){}if(a)try{a=1!==s("01")}catch(e){}if(a)try{a=1!==s("1.")}catch(e){}}}}catch(e){a=!1}t=a}}return u[e]=!!t}if(!u("json")){var h="[object Function]",E="[object Number]",N="[object String]",P="[object Array]",a=u("bug-string-char-index");if(!l)var A=Math.floor,i=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(e,t){return i[t]+365*(e-1970)+A((e-1969+(t=+(1<t)))/4)-A((e-1901+t)/100)+A((e-1601+t)/400)};(k={}.hasOwnProperty)||(k=function(e){var n,t={};return k=(t.__proto__=null,t.__proto__={toString:1},t).toString!=x?function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(n=t.constructor,function(e){var t=(this.constructor||n).prototype;return e in this&&!(e in t&&this[e]===t[e])}),t=null,k.call(this,e)});var d={boolean:1,number:1,string:1,undefined:1};if(T=function(e,t){var n,l,i,r=0;for(i in(n=function(){this.valueOf=0}).prototype.valueOf=0,l=new n)k.call(l,i)&&r++;return n=l=null,(T=r?2==r?function(e,t){var n,i={},r=x.call(e)==h;for(n in e)r&&"prototype"==n||k.call(i,n)||!(i[n]=1)||!k.call(e,n)||t(n)}:function(e,t){var n,i,r=x.call(e)==h;for(n in e)r&&"prototype"==n||!k.call(e,n)||(i="constructor"===n)||t(n);(i||k.call(e,n="constructor"))&&t(n)}:(l=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],)(e,t)},!u("json-stringify")){var p={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},I=function(e,t){return("000000"+(t||0)).slice(-e)},M=function(e){var t,n='"',i=0,r=e.length,o=10<r&&a;for(o&&(t=e.split(""));i<r;i++){var s=e.charCodeAt(i);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=p[s];break;default:if(s<32){n+="\\u00"+I(2,s.toString(16));break}n+=o?t[i]:a?e.charAt(i):e[i]}}return n+'"'},D=function(e,t,n,i,r,o,s){var a,c,l,u,h,d,p,f,g,m,v,y,b,w,C,_;try{a=t[e]}catch(e){}if("object"==typeof a&&a)if("[object Date]"!=(c=x.call(a))||k.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=E&&c!=N&&c!=P||k.call(a,"toJSON"))&&(a=a.toJSON(e));else if(-1/0<a&&a<1/0){if(O){for(h=A(a/864e5),l=A(h/365.2425)+1970-1;O(l+1,0)<=h;l++);for(u=A((h-O(l,0))/30.42);O(l,u+1)<=h;u++);h=1+h-O(l,u),p=A((d=(a%864e5+864e5)%864e5)/36e5)%24,f=A(d/6e4)%60,g=A(d/1e3)%60,m=d%1e3}else l=a.getUTCFullYear(),u=a.getUTCMonth(),h=a.getUTCDate(),p=a.getUTCHours(),f=a.getUTCMinutes(),g=a.getUTCSeconds(),m=a.getUTCMilliseconds();a=(l<=0||1e4<=l?(l<0?"-":"+")+I(6,l<0?-l:l):I(4,l))+"-"+I(2,u+1)+"-"+I(2,h)+"T"+I(2,p)+":"+I(2,f)+":"+I(2,g)+"."+I(3,m)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if("[object Boolean]"==(c=x.call(a)))return""+a;if(c==E)return-1/0<a&&a<1/0?""+a:"null";if(c==N)return M(""+a);if("object"==typeof a){for(w=s.length;w--;)if(s[w]===a)throw TypeError();if(s.push(a),v=[],C=o,o+=r,c==P){for(b=0,w=a.length;b<w;b++)y=D(b,a,n,i,r,o,s),v.push(y===S?"null":y);_=v.length?r?"[\n"+o+v.join(",\n"+o)+"\n"+C+"]":"["+v.join(",")+"]":"[]"}else T(i||a,function(e){var t=D(e,a,n,i,r,o,s);t!==S&&v.push(M(e)+":"+(r?" ":"")+t)}),_=v.length?r?"{\n"+o+v.join(",\n"+o)+"\n"+C+"}":"{"+v.join(",")+"}":"{}";return s.pop(),_}};c.stringify=function(e,t,n){var i,r,o,s;if("function"==typeof t||"object"==typeof t&&t)if((s=x.call(t))==h)r=t;else if(s==P){o={};for(var a,c=0,l=t.length;c<l;a=t[c++],((s=x.call(a))==N||s==E)&&(o[a]=1));}if(n)if((s=x.call(n))==E){if(0<(n-=n%1))for(i="",10<n&&(n=10);i.length<n;i+=" ");}else s==N&&(i=n.length<=10?n:n.slice(0,10));return D("",((a={})[""]=e,a),r,o,i,"",[])}}if(!u("json-parse")){var f,g,m=String.fromCharCode,v={92:"\\",34:'"',47:"/",98:"\b",116:" ",110:"\n",102:"\f",114:"\r"},y=function(){throw f=g=null,SyntaxError()},r=o=function(e){var t,n;if("$"==e&&y(),"string"==typeof e){if("@"==(a?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=r());n||(n=!0))n&&(","==e?"]"==(e=r())&&y():y()),","==e&&y(),t.push(o(e));return t}if("{"==e){for(t={};"}"!=(e=r());n||(n=!0))n&&(","==e?"}"==(e=r())&&y():y()),","!=e&&"string"==typeof e&&"@"==(a?e.charAt(0):e[0])&&":"==r()||y(),t[e.slice(1)]=o(r());return t}y()}return e},s=function(e,t,n){var i=b(e,t,n);i===S?delete e[t]:e[t]=i},b=function(e,t,n){var i,r=e[t];if("object"==typeof r&&r)if(x.call(r)==P)for(i=r.length;i--;)s(r,i,n);else T(r,function(e){s(r,e,n)});return n.call(e,t,r)};c.parse=function(e,t){var n,i;return f=0,g=""+e,n=o(r()),"$"!=r()&&y(),f=g=null,t&&x.call(t)==h?b(((i={})[""]=n,i),"",t):n}}}t&&C(function(){return c})}(this)},{}],50:[{}]},{},[1])(1)}(),livechat.io=window.io,window.io=window.previous_io,function(e,t){e.Pusher=function(){return function(){ar e=n.prototype;n.instances=[],n.isReady=!1,n.debug=n.warn=n.ready=e.channel=function(e){return this.channels.find(e)},e.allChannels=function(){return this.channels.all()},e.connect=e.disconnect=e.bind=function(e,t){return this.global_emitter.bind(e,t),this},e.bind_all=function(e){return this.global_emitter.bind_all(e),this},e.subscribeAll=e.subscribe=e.unsubscribe=e.send_event=e.isEncrypted=n.HTTP={},this.Pusher=n}.call(this),call(this),function(){Pusher.Util={now:defer:extend:stringify:arrayIndexOf:objectApply:keys:values:apply:map:mapObject:filter:filterObject:flatten:any:all:method:getWindow:function(){return window},getDocument:getLocalStorage:getClientFeatures:addWindowListener:function(e,t){var n=Pusher.Util.getWindow();void 0!==n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent("on"+e,t)},removeWindowListener:isXHRSupported:isXDRSupported:}.call(this),function(){Pusher.VERSION="3.0.0",Pusher.PROTOCOL=7,Pusher.host="ws.pusherapp.com",Pusher.ws_port=80,Pusher.wss_port=443,Pusher.sockjs_host="sockjs.pusher.com",Pusher.sockjs_http_port=80,Pusher.sockjs_https_port=443,Pusher.sockjs_path="/pusher",Pusher.stats_host="stats.pusher.com",Pusher.channel_auth_endpoint="/pusher/auth",Pusher.channel_auth_transport="ajax",Pusher.activity_timeout=12e4,Pusher.pong_timeout=3e4,Pusher.unavailable_timeout=1e4,Pusher.cdn_http="http://js.pusher.com/",Pusher.cdn_https="https://js.pusher.com/",Pusher.dependency_suffix=".min",Pusher.getDefaultStrategy=.call(this),call(this),call(this),call(this),function(){ar t=e.prototype;t.create=function(e){this.lastId++;var t=this.lastId,n=this.prefix+t,i=this.name+"["+t+"]",r=!1,o=return{number:t,id:n,name:i,callback:this[t]=o}},t.remove=Pusher.ScriptReceiverFactory=e,Pusher.ScriptReceivers=new e("_pusher_script_","Pusher.ScriptReceivers")}.call(this),call(this),call(this),function(){unction t(){!e)}Pusher.DependenciesReceivers=new Pusher.ScriptReceiverFactory("_pusher_dependencies","Pusher.DependenciesReceivers"),Pusher.Dependencies=new Pusher.DependencyLoader({cdn_http:Pusher.cdn_http,cdn_https:Pusher.cdn_https,version:Pusher.VERSION,suffix:Pusher.dependency_suffix,receivers:Pusher.DependenciesReceivers}),window.JSON?t():Pusher.Dependencies.load("json2",{},t)}(),function(){for(var n=String.fromCharCode,e=0;e<64;e++)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e);var t=i=r=window.btoa||Pusher.Base64={encode:}.call(this),function(){ar t=e.prototype;t.send=function(e){if(!this.request){var t=Pusher.Util.filterObject(this.data,;t=Pusher.Util.map(Pusher.Util.flatten((n=t,Pusher.Util.mapObject(n,)),Pusher.Util.method("join","=")).join("&"),this.request=new Pusher.ScriptRequest(this.url+"/"+e.number+"?"+t),this.request.send(e)}var n},t.cleanup=function(){this.request&&this.request.cleanup()},Pusher.JSONPRequest=e}.call(this),call(this),call(this),function(){function e(e){this.strategies=e}ar t=e.prototype;t.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},t.connect=function(e,o){return t=this.strategies,r=e,s=function(i,r){return function(e,t){var n;(r[i].error=e)?(n=r,Pusher.Util.all(n,&&o(!0)):(Pusher.Util.apply(r,,o(null,t))}},n=Pusher.Util.map(t,,{abort:forceMinPriority:;var t,r,s,n},Pusher.BestConnectedEverStrategy=e}.call(this),call(this),call(this),call(this),call(this),function(){ar t=e.prototype;t.isSupported=t.connect=t.tryStrategy=Pusher.SequentialStrategy=e}.call(this),call(this),function(){sher.URLSchemes={ws:{getInitial:,sockjs:{getInitial:getPath:,http:{getInitial:}}.call(this),function(){ar t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},t.supportsPing=t.initialize=t.connect=t.close=t.send=t.ping=t.onOpen=t.onError=t.onClose=t.onMessage=t.onActivity=t.bindListeners=t.unbindListeners=t.changeState=t.buildTimelineMessage=Pusher.TransportConnection=e}.call(this),call(this),function(){Pusher.WSTransport=new Pusher.Transport({urls:Pusher.URLSchemes.ws,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(window.WebSocket||window.MozWebSocket)},isSupported:getSocket:),Pusher.SockJSTransport=new Pusher.Transport({file:"sockjs",urls:Pusher.URLSchemes.sockjs,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:getSocket:beforeOpen:);var e={urls:Pusher.URLSchemes.http,handlesActivityChecks:!1,supportsPing:!0,isInitialized:,t=Pusher.Util.extend({getSocket:function(e){return Pusher.HTTP.getStreamingSocket(e)}},e),n=(e=Pusher.Util.extend({getSocket:,e),{file:"xhr",isSupported:Pusher.Util.isXHRSupported}),i={file:"xdr",isSupported:;Pusher.XHRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},t,n)),Pusher.XDRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},t,i)),Pusher.XHRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},e,n)),Pusher.XDRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},e,i))}.call(this),function(){ar t=e.prototype;t.createConnection=function(e,t,n,i){var r=this;i=Pusher.Util.extend({},i,{activityTimeout:r.pingDelay});var o=r.transport.createConnection(e,t,n,i),s=null,a=c=return o.bind("open",a),o},t.isSupported=Pusher.AssistantToTheTransportManager=e}.call(this),call(this),function(){unction i(e,t){if("string"!=typeof e[0]||":"!==e[0].charAt(0))return e,t);var n=t[e[0].slice(1)];if(1<e.length){if("function"!=typeof n)throw"Calling non-function "+e[0];var i=[Pusher.Util.extend({},t)].concat(Pusher.Util.map(e.slice(1),);return n.apply(this,i)}return[n,t]}function o(e,t){if("string"!=typeof e)return"object"==typeof e&&e instanceof Array&&0<e.length?i(e,t):[e,t];var n;if("string"==typeof e&&":"===e.charAt(0)){if(void 0===(n=t[e.slice(1)]))throw"Undefined symbol "+e;n=[n,t]}else n=[e,t];return n}var a={ws:Pusher.WSTransport,sockjs:Pusher.SockJSTransport,xhr_streaming:Pusher.XHRStreamingTransport,xdr_streaming:Pusher.XDRStreamingTransport,xhr_polling:Pusher.XHRPollingTransport,xdr_polling:Pusher.XDRPollingTransport},c={isSupported:connect:,n={extend:def:def_transport:function(e,t,n,i,r,o){var s=a[n];if(!s)throw new Pusher.Errors.UnsupportedTransport(n);return n=e.enabledTransports&&-1===Pusher.Util.arrayIndexOf(e.enabledTransports,t)||e.disabledTransports&&-1!==Pusher.Util.arrayIndexOf(e.disabledTransports,t)?c:new Pusher.TransportStrategy(t,i,o?o.getAssistant(s):s,Pusher.Util.extend({key:e.key,encrypted:e.encrypted,timeline:e.timeline,ignoreNullOrigin:e.ignoreNullOrigin},r)),(i=e.def(e,t,n)[1]).transports=e.transports||{},i.transports[t]=n,[void 0,i]},transport_manager:e(function(e,t){return new Pusher.TransportManager(t)}),sequential:e(,cached:e(,first_connected:e(,best_connected_ever:e(,delayed:e(,"if":e(,is_supported:e(};Pusher.StrategyBuilder={build:}.call(this),function(){Pusher.Protocol={decodeMessage:encodeMessage:processHandshake:getCloseAction:getCloseError:}.call(this),call(this),call(this),function(){ar t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.connect=t.send=t.send_event=t.disconnect=t.isEncrypted=function(){return this.encrypted},t.startConnecting=t.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},t.disconnectInternally=t.updateStrategy=t.retryIn=t.clearRetryTimer=t.setUnavailableTimer=t.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},t.sendActivityCheck=t.resetActivityCheck=t.stopActivityCheck=t.buildConnectionCallbacks=t.buildHandshakeCallbacks=t.buildErrorCallbacks=t.setConnection=t.abandonConnection=t.updateState=function(e,t){var n=this.state;n!==(this.state=e)&&(Pusher.debug("State changed",n+" -> "+e),this.timeline.info({state:e,params:t}),this.emit("state_change",{previous:n,current:e}),this.emit(e,t))},t.shouldRetry=Pusher.ConnectionManager=e}.call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this),Pusher}()}(this),this,function(){return [function(e,t,n){n(1);var o=n(2),i=n(3),r=n(4),h=n(5),s=n(8),d="PubNub-JS-Web/"+r.version;window.console||(window.console=window.console||{}),console.log||(console.log=console.error=(window.opera||{}).postError||function(){});var a=function(){var i={},e=!1;try{e=window.localStorage}catch(e){return}var n=function(e){return-1===document.cookie.indexOf(e)?null:((document.cookie||"").match(RegExp(e+"=([^;]+)"))||[])[1]||null},r=function(e,t){document.cookie=e+"="+t+"; expires=Thu, 1 Aug "+((new Date).getFullYear()+1)+" 20:00:00 UTC; path=/"},o=function(){try{return r("pnctest","1"),"1"===n("pnctest")}catch(e){return!1}}();return{get:function(t){try{return e?e.getItem(t):o?n(t):i[t]}catch(e){return i[t]}},set:function(t,n){try{if(e)return e.setItem(t,n)&&0;o&&r(t,n),i[t]=n}catch(e){i[t]=n}}}}();function c(e,t){return i.HmacSHA256(e,t).toString(i.enc.Base64)}function l(e){return document.getElementById(e)}unction p(e,t){var n=[];return h.each(e.split(/\s+/),function(e){h.each((t||document).getElementsByTagName(e),function(e){n.push(e)})}),n}function f(e,n,i){h.each(e.split(","),function(e){var t=function(e){e||(e=window.event),i(e)||(e.cancelBubble=!0,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())};n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent?n.attachEvent("on"+e,t):n["on"+e]=t})}unction m(e,t,n){if(!n)return e&&e.getAttribute&&e.getAttribute(t);e.setAttribute(t,n)}function v(e,t){for(var n in t)if(t.hasOwnProperty(n))try{e.style[n]=t[n]+(0<"|width|height|top|left|".indexOf(n)&&"number"==typeof t[n]?"px":"")}catch(e){return}}ar b={list:{},unbind:bind:fire:function(e,t){h.each(b.list[e]||[],}};function w(e){var n,i,r=0,t=0,o=e.timeout||h.DEF_TIMEOUT,s=e.data||{},a=e.fail||function(){},c=e.success||function(){},l=function(e,t){r||(r=1,clearTimeout(i),n&&(n.onerror=n.onload=null,n.abort&&n.abort(),n=null),e&&a(t))};i=h.timeout(o);try{(n="undefined"!=typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest).onerror=n.onabort=function(){l(1,n.responseText||{error:"Network Connection Error"})},n.onload=n.onloadend=function(){if(!t){var e;t=1,clearTimeout(i);try{e=JSON.parse(n.responseText)}catch(e){return l(1)}c(e)}},s.pnsdk=d;var u=h.build_url(e.url,s);n.open("GET",u,!0),n.timeout=o,n.send()}catch(e){l(1,{error:"XHR Failed",stacktrace:e})}return l}function C(){if(!("onLine"in navigator))return 1;try{return navigator.onLine}catch(e){return!0}}function _(e){return"sendBeacon"in navigator&&navigator.sendBeacon(e)}var k=function(e){var t=e.leave_on_unload||0;e.xdr=w,e.db=a,e.error=e.error||u,e._is_online=C,e.hmac_SHA256=c,e.crypto_obj=o(),e.sendBeacon=_,e.params={pnsdk:d};var n=i=h.PN_API(e);for(var r in i)i.hasOwnProperty(r)&&(n[r]=i[r]);return n.css=v,n.$=l,n.create=y,n.bind=f,n.head=g,n.search=p,n.attr=m,n.events=b,((n.init=n).secure=n).crypto_obj=o(),n.WS=s,n.PNmessage=h.PNmessage,n.supplant=h.supplant,f("beforeunload",window,function(){return t&&n["each-channel"](,!0}),n.ready(),e.notest||(f("offline",window,n.offline),f("offline",document,n.offline)),n};((k.init=k).secure=k).crypto_obj=o(),k.WS=s,k.db=a,k.PNmessage=h.PNmessage,k.uuid=h.uuid,k.css=v,k.$=l,k.create=l,k.bind=f,k.head=g,k.search=p,k.attr=m,k.events=b,k.map=h.map,k.each=h.each,k.grep=h.grep,k.supplant=h.supplant,k.now=h.now,k.unique=h.unique,k.updater=h.updater,window.jQuery&&(window.jQuery.PUBNUBVisitor=k),e.exports=k},function(module,exports){(function(){window.JSON&&window.JSON.stringify||function(){function toJSON(e){try{return this.valueOf()}catch(e){return null}}window.JSON||(window.JSON={});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;unction str(e,t){var n,i,r,o,s,a=gap,c=t[e];switch(c&&"object"==typeof c&&(c=toJSON.call(c,e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(o=c.length,n=0;n<o;n+=1)s[n]=str(n,c)||"null";return r=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;n<o;n+=1)"string"==typeof(i=rep[n])&&(r=str(i,c))&&s.push(quote(i)+(gap?": ":":")+r);else for(i in c)Object.hasOwnProperty.call(c,i)&&(r=str(i,c))&&s.push(quote(i)+(gap?": ":":")+r);return r=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,r}}"function"!=typeof JSON.stringify&&(JSON.stringify=,"function"!=typeof JSON.parse&&(JSON.parse=}()}).call(window)},function(e,t,n){var d=n(3);e.exports=function(){var t=["hex","utf8","base64","binary"],n=[128,256],i=["ecb","cbc"],r=!0,o="utf8",s=256,a="cbc";function c(e){return(e=e||{}).hasOwnProperty("encryptKey")||(e.encryptKey=r),e.hasOwnProperty("keyEncoding")||(e.keyEncoding=o),e.hasOwnProperty("keyLength")||(e.keyLength=s),e.hasOwnProperty("mode")||(e.mode=a),-1==t.indexOf(e.keyEncoding.toLowerCase())&&(e.keyEncoding=o),-1==n.indexOf(parseInt(e.keyLength,10))&&(e.keyLength=s),-1==i.indexOf(e.mode.toLowerCase())&&(e.mode=a),e}function l(e,t){var n,i,r;return n=e,e="base64"===(i=t).keyEncoding?d.enc.Base64.parse(n):"hex"===i.keyEncoding?d.enc.Hex.parse(n):n,t.encryptKey?d.enc.Utf8.parse((r=e,d.SHA256(r).toString(d.enc.Hex)).slice(0,32)):e}unction h(e){return"cbc"===e.mode?d.enc.Utf8.parse("0123456789012345"):null}return{encrypt:function(e,t,n){if(!t)return e;var i=h(n=c(n)),r=u(n),o=l(t,n),s=JSON.stringify(e);return d.AES.encrypt(s,o,{iv:i,mode:r}).ciphertext.toString(d.enc.Base64)||e},decrypt:function(e,t,n){if(!t)return e;var i=h(n=c(n)),r=u(n),o=l(t,n);try{var s=d.enc.Base64.parse(e),a=d.AES.decrypt({ciphertext:s},o,{iv:i,mode:r}).toString(d.enc.Utf8);return JSON.parse(a)}catch(e){return}}}}},function(e,t){var n,l,i,c,r,o,s,u,a,h,N=N||Math);!Math),l=(n=N).enc.Utf8,n.algo.HMAC=n.lib.Base.extend({init:reset:update:finalize:),c=(i=N).lib.WordArray,i.enc.Base64={stringify:parse:_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},Math),s=(r=(o=N).lib).Base,u=r.WordArray,a=(r=o.algo).EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:r.MD5,iterations:1}),init:compute:),o.EvpKDF=N.lib.Cipher||),),N.mode.ECB=((h=N.lib.BlockCipherMode.extend()).Encryptor=h.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),h.Decryptor=h.extend({processBlock:),h),e.exports=N},function(e,t){e.exports={name:"pubnub",preferGlobal:!1,version:"3.15.2",author:"PubNub <support@pubnub.com>",description:"Publish & Subscribe Real-time Messaging with PubNub",contributors:[{name:"Stephen Blum",email:"stephen@pubnub.com"}],bin:{},scripts:{test:"grunt test --force"},main:"./node.js/pubnub.js",browser:"./modern/dist/pubnub.js",repository:{type:"git",url:"git://github.com/pubnub/javascript.git"},keywords:["cloud","publish","subscribe","websockets","comet","bosh","xmpp","real-time","messaging"],dependencies:{agentkeepalive:"~0.2",lodash:"^4.1.0"},noAnalyze:!1,devDependencies:{chai:"^3.5.0",eslint:"2.4.0","eslint-config-airbnb":"^6.0.2","eslint-plugin-flowtype":"^2.1.0","eslint-plugin-mocha":"^2.0.0","eslint-plugin-react":"^4.1.0","flow-bin":"^0.22.0",grunt:"^0.4.5","grunt-contrib-clean":"^1.0.0","grunt-contrib-copy":"^0.8.2","grunt-contrib-uglify":"^0.11.1","grunt-env":"^0.4.4","grunt-eslint":"^18.0.0","grunt-flow":"^1.0.3","grunt-karma":"^0.12.1","grunt-mocha-istanbul":"^3.0.1","grunt-text-replace":"^0.4.0","grunt-webpack":"^1.0.11","imports-loader":"^0.6.5",isparta:"^4.0.0","json-loader":"^0.5.4",karma:"^0.13.21","karma-chai":"^0.1.0","karma-mocha":"^0.2.1","karma-phantomjs-launcher":"^1.0.0","karma-spec-reporter":"0.0.24","load-grunt-tasks":"^3.4.0",mocha:"^2.4.5",nock:"^1.1.0","node-uuid":"^1.4.7",nodeunit:"^0.9.0","phantomjs-prebuilt":"^2.1.4",proxyquire:"^1.7.4",sinon:"^1.17.2","uglify-js":"^2.6.1",underscore:"^1.7.0",webpack:"^1.12.13","webpack-dev-server":"^1.14.1"},bundleDependencies:[],license:"MIT",engine:{node:">=0.8"},files:["core","node.js","modern","CHANGELOG","FUTURE.md","LICENSE","README.md"]}},function(e,t,n){var i=n(4),r=n(6),de=n(7),o=1,pe=!1,fe=[],ge="-pnpres",me=1e3,ve=i.version;function ye(){return"x"+ ++o+ +new Date}var s,be=(s=Math.floor(20*Math.random()),function(e,t){return 0<e.indexOf("pubsub.")&&e.replace("pubsub","ps"+(t?de.generateUUID().split("-")[0]:++s<20?s:s=1))||e});function we(e,n){var i=[];return de.each(e,function(e,t){n?e.search("-pnpres")<0&&t.subscribed&&i.push(e):t.subscribed&&i.push(e)}),i.sort()}function Ce(e,n){var i=[];return de.each(e,function(e,t){n?e.search("-pnpres")<0&&t.subscribed&&i.push(e):t.subscribed&&i.push(e)}),i.sort()}function _e(){pe||(pe=1,de.each(fe,)}e.exports={PN_API:function(e){var n,i,C=+e.windowing||10,_=(+e.timeout||310)*me,r=(+e.keepalive||60)*me,o=e.timecheck||0,d=e.noleave||0,g=e.publish_key,k=e.subscribe_key,T=e.auth_key||"",m=e.secret_key||"",v=e.hmac_SHA256,p=e.ssl?"s":"",S="http"+p+"://"+(e.origin||"pubsub.pubnub.com"),x=be(S),E=be(S),N=function(){},y=[],h=!0,P=0,A=0,O=0,I=0,M=e.restore||0,D=0,L=!1,B={},R={},j={},t=null,U=Y(e.heartbeat||e.pnexpires||0,e.error),s=e.heartbeat_interval||U/2-1,a=!1,c=e.no_wait_for_pending,f=e["compatible_3.5"]||!1,z=e.xdr,l=e.params||{},F=e.error||function(){},u=e._is_online||function(){return 1},V=e.jsonp_cb||H=e.db||{get:function(){},set:function(){}},b=e.cipher_key,q=e.uuid||!e.unique_uuid&&H&&H.get(k+"uuid")||"",W=e.instance_id||!1,G="",w=e.shutdown,J=void 0===e.use_send_beacon||e.use_send_beacon?e.sendBeacon:null;2===U&&(s=1);var X=e.crypto_obj||{encrypt:function(e,t){return e},decrypt:;function K(n){return n||(n={}),de.each(l,,n}function $(e){return(t=e,n=[],de.each(t,,n).sort();var t,n}function Q(e){var t="",n=$(e);for(var i in n){var r=n[i];t+=r+"="+de.pamEncode(e[r]),i!=n.length-1&&(t+="&")}return t}function Y(e,t,n){var i=!1;if(void 0===e)return t;if("number"==typeof e)i=!(5<e||0==e);else{if("boolean"==typeof e)return e?30:0;i=!0}return i?(n&&n("Presence Heartbeat value invalid. Valid range ( x > 5 or x = 0). Current Value : "+(t||5)),t||5):e}function Z(e,t){return X.encrypt(e,t||b)||e}function ee(e,t){return X.decrypt(e,t||b)||X.decrypt(e,b)||e}function te(){clearTimeout(t),!s||500<=s||s<1||!we(B,!0).length&&!Ce(R,!0).length?a=!1:(a=!0,le.presence_heartbeat({callback:function(e){t=de.timeout(te,s*me)},error:function(e){F&&F("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(e)),t=de.timeout(te,s*me)}}))}unction ie(e){if(c){if(!y.length)return}else{if(e&&(y.sending=0),y.sending||!y.length)return;y.sending=1}z(y.shift())}function re(n){var i=0;return de.each(Ce(R),function(e){var t=R[e];t&&(i++,(n||function(){})(t))}),i}function oe(n){var i=0;return de.each(we(B),function(e){var t=B[e];t&&(i++,(n||function(){})(t))}),i}function se(e,t,n){if("object"==typeof e){if(e.error){var i={};return e.message&&(i.message=e.message),e.payload&&(i.payload=e.payload),void(n&&n(i))}if(e.payload)return void(e.next_page?t&&t(e.payload,e.next_page):t&&t(e.payload))}t&&t(e)}function ae(e,t){if("object"==typeof e&&e.error){var n={};return e.message&&(n.message=e.message),e.payload&&(n.payload=e.payload),void(t&&t(n))}t&&t(e)}function ce(e,t,n,i){t=e.callback||t;var r=e.error||F,o=V();(i=i||{}).auth||(i.auth=e.auth_key||T);var s=[x,"v1","channel-registration","sub-key",k];s.push.apply(s,n),o&&(i.callback=o),z({callback:o,data:K(i),success:function(e){se(e,t,r)},fail:function(e){ae(e,r)},url:s})}var le={LEAVE:function(e,t,n,i,r){var o,s,a={uuid:q,auth:n||T},c=be(S),l=(i=i||function(){},r||function(){}),u=V();if(0<e.indexOf(ge))return!0;if(f){if(!p)return!1;if("0"==u)return!1}if(d)return!1;if("0"!=u&&(a.callback=u),W&&(a.instanceid=G),o=[c,"v2","presence","sub_key",k,"channel",de.encode(e),"leave"],s=K(a),J){var h=de.buildURL(o,s);if(J(h))return i&&i({status:200,action:"leave",message:"OK",service:"Presence"}),!0}return z({blocking:t||p,callback:u,data:s,success:function(e){se(e,i,l)},fail:function(e){ae(e,l)},url:o}),!0},LEAVE_GROUP:function(e,t,n,i,r){var o,s,a={uuid:q,auth:n||T},c=be(S),l=(i=i||function(){},r||function(){}),u=V();if(0<e.indexOf(ge))return!0;if(f){if(!p)return!1;if("0"==u)return!1}if(d)return!1;if("0"!=u&&(a.callback=u),e&&0<e.length&&(a["channel-group"]=e),W&&(a.instanceid=G),o=[c,"v2","presence","sub_key",k,"channel",de.encode(","),"leave"],s=K(a),J){var h=de.buildURL(o,s);if(J(h))return i&&i({status:200,action:"leave",message:"OK",service:"Presence"}),!0}return z({blocking:t||p,callback:u,data:s,success:function(e){se(e,i,l)},fail:function(e){ae(e,l)},url:o}),!0},set_resumed:function(e){L=e},get_cipher_key:function(){return b},set_cipher_key:function(e){b=e},raw_encrypt:function(e,t){return Z(e,t)},raw_decrypt:get_heartbeat:function(){return U},set_heartbeat:function(e,t){U=Y(e,U,F),s=t||U/2-1,2==U&&(s=1),N(),te()},get_heartbeat_interval:function(){return s},set_heartbeat_interval:function(e){s=e,te()},get_version:function(){return ve},getGcmMessageObject:getApnsMessageObject:function(e){var t={aps:{badge:1,alert:""}};for(var n in e)n[t]=e[n];return t},_add_param:channel_group:function(e,t){var n,i,r=e.channel_group,o=(t=t||e.callback,e.channels||e.channel),s=e.cloak,a=[],c={},l=e.mode||"add";if(r){var u=r.split(":");i=1<u.length?(n="*"===u[0]?null:u[0],u[1]):u[0]}n&&a.push("namespace")&&a.push(de.encode(n)),a.push("channel-group"),i&&"*"!==i&&a.push(i),o?(de.isArray(o)&&(o=o.join(",")),c[l]=o,c.cloak=h?"true":"false"):"remove"===l&&a.push("remove"),void 0!==s&&(c.cloak=s?"true":"false"),ce(e,t,a,c)},channel_group_list_groups:function(e,t){var n;(n=e.namespace||e.ns||e.channel_group||null)&&(e.channel_group=n+":*"),le.channel_group(e,t)},channel_group_list_channels:function(e,t){if(!e.channel_group)return F("Missing Channel Group");le.channel_group(e,t)},channel_group_remove_channel:function(e,t){return e.channel_group?e.channel||e.channels?(e.mode="remove",void le.channel_group(e,t)):F("Missing Channel"):F("Missing Channel Group")},channel_group_remove_group:function(e,t){return e.channel_group?e.channel?F("Use channel_group_remove_channel if you want to remove a channel from a group."):(e.mode="remove",void le.channel_group(e,t)):F("Missing Channel Group")},channel_group_add_channel:function(e,t){return e.channel_group?e.channel||e.channels?void le.channel_group(e,t):F("Missing Channel"):F("Missing Channel Group")},channel_group_cloak:function(e,t){void 0!==e.cloak?(h=e.cloak,le.channel_group(e,t)):t(h)},channel_group_list_namespaces:function(e,t){ce(e,t,["namespace"])},channel_group_remove_namespace:function(e,t){ce(e,t,["namespace",e.namespace,"remove"])},history:function(e,s){s=e.callback||s;var t=e.count||e.limit||100,n=e.reverse||"false",a=e.error||function(){},i=e.auth_key||T,c=e.cipher_key,r=e.channel,o=e.channel_group,l=e.start,u=e.end,h=e.include_token,d=e.string_message_token||!1,p={},f=V();return r||o?s?k?(p.stringtoken="true",p.count=t,p.reverse=n,p.auth=i,o&&(p["channel-group"]=o,r||(r=",")),f&&(p.callback=f),l&&(p.start=l),u&&(p.end=u),h&&(p.include_token="true"),d&&(p.string_message_token="true"),void z({callback:f,data:K(p),success:function(e){if("object"==typeof e&&e.error)a({message:e.message,payload:e.payload});else{for(var t=e[0],n=[],i=0;i<t.length;i++)if(h){var r=ee(t[i].message,c),o=t[i].timetoken;try{n.push({message:JSON.parse(r),timetoken:o})}catch(e){n.push({message:r,timetoken:o})}}else{r=ee(t[i],c);try{n.push(JSON.parse(r))}catch(e){n.push(r)}}s([n,e[1],e[2]])}},fail:function(e){ae(e,a)},url:[x,"v2","history","sub-key",k,"channel",de.encode(r)]})):F("Missing Subscribe Key"):F("Missing Callback"):F("Missing Channel")},replay:function(e,t){t=t||e.callback||function(){};var n=e.auth_key||T,i=e.source,r=e.destination,o=e.error||e.error||function(){},s=e.stop,a=e.start,c=e.end,l=e.reverse,u=e.limit,h=V(),d={};return i?r?g?k?("0"!=h&&(d.callback=h),s&&(d.stop="all"),l&&(d.reverse="true"),a&&(d.start=a),c&&(d.end=c),u&&(d.count=u),d.auth=n,void z({callback:h,success:function(e){se(e,t,o)},fail:url:[x,"v1","replay",g,k,i,r],data:K(d)})):F("Missing Subscribe Key"):F("Missing Publish Key"):F("Missing Destination Channel"):F("Missing Source Channel")},auth:function(e){T=e,N()},time:function(t){var e=V(),n={uuid:q,auth:T};W&&(n.instanceid=G),z({callback:e,data:K(n),url:[x,"time",e],success:fail:function(){t(0)}})},publish:function(e,t){var n=e.message;if(!n)return F("Missing Message");t=t||e.callback||n.callback||e.success||function(){};var i,r,o=e.channel||n.channel,s=e.meta||e.metadata,a=e.auth_key||T,c=e.cipher_key,l=e.error||n.error||function(){},u=e.post||!1,h=!("store_in_history"in e)||e.store_in_history,d=!("replicate"in e)||e.replicate,p=V(),f="push";return e.prepend&&(f="unshift"),o?g?k?(n.getPubnubMessage&&(n=n.getPubnubMessage()),n=JSON.stringify(Z(n,c)),r=[x,"publish",g,k,0,de.encode(o),p,de.encode(n)],i={uuid:q,auth:a},s&&"object"==typeof s&&(i.meta=JSON.stringify(s)),h||(i.store="0"),d||(i.norep="true"),W&&(i.instanceid=G),y[f]({callback:p,url:r,data:K(i),fail:success:mode:u?"POST":"GET"}),void ie()):F("Missing Subscribe Key"):F("Missing Publish Key"):F("Missing Channel")},fire:function(e,t){e.store_in_history=!1,e.replicate=!1,le.publish(e,t)},unsubscribe:function(e,t){var n=e.channel,i=e.channel_group,r=e.auth_key||T,o=(t=t||e.callback||function(){},e.error||function(){});if(!n&&!i)return F("Missing Channel or Channel Group");if(!k)return F("Missing Subscribe Key");if(n){var s=de.isArray(n)?n:(""+n).split(","),a=[],c=[];if(de.each(s,function(e){B[e]&&a.push(e)}),0==a.length)return void t({action:"leave"});de.each(a,function(e){c.push(e+ge)}),de.each(a.concat(c),function(e){e in B&&delete B[e],e in j&&delete j[e]}),0===B.length&&0===R.length&&(D=0);var l=!0;pe&&(l=le.LEAVE(a.join(","),0,r,t,o)),l||t({action:"leave"})}if(i){var u=de.isArray(i)?i:(""+i).split(","),h=[],d=[];if(de.each(u,,0==h.length)return void t({action:"leave"});de.each(h,,de.each(h.concat(d),,0===B.length&&0===R.length&&(D=0),l=!0,pe&&(l=le.LEAVE_GROUP(h.join(","),0,r,t,o)),l||t({action:"leave"})}N()},subscribe:function(t,i){var e=t.channel,n=t.channel_group,r=(i=(i=i||t.callback)||t.message,t.connect||function(){}),o=t.reconnect||function(){},s=t.disconnect||function(){},a=t.error||a||function(){},c=t.idle||function(){},l=t.presence||0,u=t.noheresync||0,h=t.backfill||0,d=t.timetoken||0,p=t.timeout||_,f=t.windowing||C,g=t.state,m=t.heartbeat||t.pnexpires,v=t.heartbeat_interval,y=t.restore||M;if(T=t.auth_key||T,M=y,D=d,!e&&!n)return F("Missing Channel");if(!i)return F("Missing Callback");if(!k)return F("Missing Subscribe Key");function b(t){t?de.timeout(N,f):(x=be(S,1),E=be(S,1),de.timeout(function(){le.time(b)},me)),oe(function(e){if(t&&e.disconnected)return e.disconnected=0,e.reconnect(e.name);t||e.disconnected||(e.disconnected=1,e.disconnect(e.name))}),re(function(e){if(t&&e.disconnected)return e.disconnected=0,e.reconnect(e.name);t||e.disconnected||(e.disconnected=1,e.disconnect(e.name))})}function w(){var e=V(),t=we(B).join(","),n=Ce(R).join(",");if(t||n){t||(t=","),ue();var i=K({uuid:q,auth:T});n&&(i["channel-group"]=n),2<JSON.stringify(j).length&&(i.state=JSON.stringify(j)),U&&(i.heartbeat=U),W&&(i.instanceid=G),ne(),I=z({timeout:p,callback:e,fail:function(t){t&&t.error&&t.service?(ae(t,a),b(!1)):le.time(function(e){!e&&ae(t,a),b(e)})},data:K(i),url:[E,"subscribe",k,de.encode(t),e,D],success:function(o){if(!o||"object"==typeof o&&"error"in o&&o.error)return a(o),de.timeout(N,me);if(c(o[1]),D=!D&&M&&H.get(k)||o[1],oe(function(e){e.connected||(e.connected=1,e.connect(e.name))}),re(,L&&!M)return D=0,L=!1,H.set(k,0),void de.timeout(w,f);h&&(D=1e4,h=0),H.set(k,o[1]);var e,i=function(){var e="",t="";3<o.length?(e=o[3],t=o[2]):e=2<o.length?o[2]:de.map(we(B),function(e){return de.map(Array(o[0].length).join(",").split(","),function(){return e})}).join(",");var i=e.split(","),r=t?t.split(","):[];return function(){var e=i.shift()||O,t=r.shift(),n=[(t?(e&&0<=e.indexOf("-pnpres")&&t.indexOf("-pnpres")<0&&(t+="-pnpres"),R[t]||B[t]||{callback:function(){}}):B[e]).callback||A,e.split(ge)[0]];return t&&n.push(t.split(ge)[0]),n}}(),r=(e=+o[1],de.rnow()-P-e/1e4);de.each(o[0],function(e){var t=i(),n=ee(e,B[t[1]]?B[t[1]].cipher_key:null);t[0]&&t[0](n,o,t[2]||t[1],r,t[1])}),de.timeout(w,f)}})}}if((m||0===m||v||0===v)&&le.set_heartbeat(m,v),e&&de.each((e.join?e.join(","):""+e).split(","),function(n){var e=B[n]||{};B[O=n]={name:n,connected:e.connected,disconnected:e.disconnected,subscribed:1,callback:A=i,cipher_key:t.cipher_key,connect:r,disconnect:s,reconnect:o},g&&(j[n]=n in g?g[n]:g),l&&(le.subscribe({channel:n+ge,callback:l,restore:y}),e.subscribed||u||le.here_now({channel:n,data:K({uuid:q,auth:T}),callback:function(t){de.each("uuids"in t?t.uuids:[],function(e){l({action:"join",uuid:e,timestamp:Math.floor(de.rnow()/1e3),occupancy:t.occupancy||1},t,n)})}}))}),n&&de.each((n.join?n.join(","):""+n).split(","),function(n){var e=R[n]||{};R[n]={name:n,connected:e.connected,disconnected:e.disconnected,subscribed:1,callback:A=i,cipher_key:t.cipher_key,connect:r,disconnect:s,reconnect:o},l&&(le.subscribe({channel_group:n+ge,callback:l,restore:y,auth_key:T}),e.subscribed||u||le.here_now({channel_group:n,data:K({uuid:q,auth:T}),callback:function(t){de.each("uuids"in t?t.uuids:[],function(e){l({action:"join",uuid:e,timestamp:Math.floor(de.rnow()/1e3),occupancy:t.occupancy||1},t,n)})}}))}),N=!pe)return fe.push(N);N()},here_now:function(e,t){t=e.callback||t;var n=e.debug,i=e.error||function(){},r=e.auth_key||T,o=e.channel,s=e.channel_group,a=V(),c=!("uuids"in e)||e.uuids,l=e.state,u={uuid:q,auth:r};if(c||(u.disable_uuids=1),l&&(u.state=1),!t)return F("Missing Callback");if(!k)return F("Missing Subscribe Key");var h=[x,"v2","presence","sub_key",k];o&&h.push("channel")&&h.push(de.encode(o)),"0"!=a&&(u.callback=a),s&&(u["channel-group"]=s,!o&&h.push("channel")&&h.push(",")),W&&(u.instanceid=G),z({callback:a,data:K(u),success:function(e){se(e,t,i)},fail:function(e){ae(e,i)},debug:n,url:h})},where_now:function(e,t){t=e.callback||t;var n=e.error||function(){},i=e.auth_key||T,r=V(),o=e.uuid||q,s={auth:i};return t?k?("0"!=r&&(s.callback=r),W&&(s.instanceid=G),void z({callback:r,data:K(s),success:function(e){se(e,t,n)},fail:function(e){ae(e,n)},url:[x,"v2","presence","sub_key",k,"uuid",de.encode(o)]})):F("Missing Subscribe Key"):F("Missing Callback")},state:function(e,t){t=e.callback||t||function(e){};var n,i=e.error||function(){},r=e.auth_key||T,o=V(),s=e.state,a=e.uuid||q,c=e.channel,l=e.channel_group,u=K({auth:r});return k?a?c||l?("0"!=o&&(u.callback=o),void 0!==c&&B[c]&&B[c].subscribed&&s&&(j[c]=s),void 0!==l&&R[l]&&R[l].subscribed&&(s&&(j[l]=s),u["channel-group"]=l,c||(c=",")),u.state=JSON.stringify(s),W&&(u.instanceid=G),n=s?[x,"v2","presence","sub-key",k,"channel",c,"uuid",a,"data"]:[x,"v2","presence","sub-key",k,"channel",c,"uuid",de.encode(a)],void z({callback:o,data:K(u),success:function(e){se(e,t,i)},fail:function(e){ae(e,i)},url:n})):F("Missing Channel"):F("Missing UUID"):F("Missing Subscribe Key")},grant:function(e,t){t=e.callback||t;var n=e.error||function(){},i=e.channel||e.channels,r=e.channel_group,o=V(),s=e.ttl,a=e.read?"1":"0",c=e.write?"1":"0",l=e.manage?"1":"0",u=e.auth_key||e.auth_keys;if(!t)return F("Missing Callback");if(!k)return F("Missing Subscribe Key");if(!g)return F("Missing Publish Key");if(!m)return F("Missing Secret Key");var h=Math.floor((new Date).getTime()/1e3),d=k+"\n"+g+"\ngrant\n",p={w:c,r:a,timestamp:h};e.manage&&(p.m=l),de.isArray(i)&&(i=i.join(",")),de.isArray(u)&&(u=u.join(",")),void 0!==i&&null!=i&&0<i.length&&(p.channel=i),void 0!==r&&null!=r&&0<r.length&&(p["channel-group"]=r),"0"!=o&&(p.callback=o),(s||0===s)&&(p.ttl=s),u&&(p.auth=u),p=K(p),u||delete p.auth,d+=Q(p);var f=v(d,m);f=(f=f.replace(/\+/g,"-")).replace(/\//g,"_"),p.signature=f,z({callback:o,data:p,success:function(e){se(e,t,n)},fail:function(e){ae(e,n)},url:[x,"v1","auth","grant","sub-key",k]})},mobile_gw_provision:function(e){var t,n,i=e.callback||function(){},r=e.auth_key||T,o=e.error||function(){},s=V(),a=e.channel,c=e.op,l=e.gw_type,u=e.device_id;return u?l?c?a?k?(n=[x,"v1/push/sub-key",k,"devices",u],t={uuid:q,auth:r,type:l},"add"==c?t.add=a:"remove"==c&&(t.remove=a),W&&(t.instanceid=G),void z({callback:s,data:t,success:function(e){se(e,i,o)},fail:function(e){ae(e,o)},url:n})):F("Missing Subscribe Key"):F("Missing gw destination Channel (channel)"):F("Missing GW Operation (op: add or remove)"):F("Missing GW Type (gw_type: gcm or apns)"):F("Missing Device ID (device_id)")},audit:function(e,t){t=e.callback||t;var n=e.error||function(){},i=e.channel,r=e.channel_group,o=e.auth_key,s=V();if(!t)return F("Missing Callback");if(!k)return F("Missing Subscribe Key");if(!g)return F("Missing Publish Key");if(!m)return F("Missing Secret Key");var a=Math.floor((new Date).getTime()/1e3),c=k+"\n"+g+"\naudit\n",l={timestamp:a};"0"!=s&&(l.callback=s),void 0!==i&&null!=i&&0<i.length&&(l.channel=i),void 0!==r&&null!=r&&0<r.length&&(l["channel-group"]=r),o&&(l.auth=o),l=K(l),o||delete l.auth,c+=Q(l);var u=v(c,m);u=(u=u.replace(/\+/g,"-")).replace(/\//g,"_"),l.signature=u,z({callback:s,data:l,success:function(e){se(e,t,n)},fail:function(e){ae(e,n)},url:[x,"v1","auth","audit","sub-key",k]})},revoke:function(e,t){e.read=!1,e.write=!1,le.grant(e,t)},set_uuid:get_uuid:function(){return q},isArray:function(e){return de.isArray(e)},get_subscribed_channels:presence_heartbeat:function(e){var t=e.callback||function(){},n=e.error||function(){},i=V(),r={uuid:q,auth:T};2<JSON.stringify(j).length&&(r.state=JSON.stringify(j)),0<U&&U<320&&(r.heartbeat=U),"0"!=i&&(r.callback=i);var o=de.encode(we(B,!0).join(",")),s=Ce(R,!0).join(",");o||(o=","),s&&(r["channel-group"]=s),W&&(r.instanceid=G),z({callback:i,data:K(r),url:[x,"v2","presence","sub-key",k,"channel",o,"heartbeat"],success:function(e){se(e,t,n)},fail:)},stop_timers:shutdown:xdr:z,ready:_e,db:H,uuid:de.generateUUID,map:de.map,each:de.each,"each-channel":oe,grep:de.grep,offline:supplant:de.supplant,now:de.rnow,unique:ye,updater:de.updater};function ue(e,t){I&&I(e,t),I=null,clearTimeout(n),clearTimeout(i)}function he(i,e){var r=de.rnow();function t(e){if(e){var t=e/1e4,n=(de.rnow()-r)/2;P=de.rnow()-(t+n),i&&i(P)}}e&&t(e)||le.time(t)}return q||(q=le.uuid()),G||(G=le.uuid()),H.set(k+"uuid",q),n=de.timeout(function e(){u()||ue(1,{error:"Offline. Please check your network settings."}),n&&clearTimeout(n),n=de.timeout(e,me)},me),i=de.timeout(function t(){o&&le.time(function(e){he(function(){},e),e||ue(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),i&&clearTimeout(i),i=de.timeout(t,r)})},r),t=de.timeout(ne,(s-3)*me),he(),le},unique:ye,PNmessage:function(e){var r=e||{apns:{}};return r.getPubnubMessage=function(){var e={};if(Object.keys(r.apns).length){for(var t in e.pn_apns={aps:{alert:r.apns.alert,badge:r.apns.badge}},r.apns)e.pn_apns[t]=r.apns[t];var n=["badge","alert"];for(var t in n)delete e.pn_apns[n[t]]}for(var t in r.gcm&&(e.pn_gcm={data:r.gcm}),r)e[t]=r[t];var i=["apns","gcm","publish","channel","callback","error"];for(var t in i)delete e[i[t]];return e},r.publish=function(){var e=r.getPubnubMessage();r.pubnub&&r.channel&&r.pubnub.publish({message:e,channel:r.channel,callback:r.callback,error:r.error})},r},DEF_TIMEOUT:15e3,timeout:de.timeout,build_url:de.buildURL,each:de.each,uuid:de.generateUUID,URLBIT:r.URLBIT,grep:de.grep,supplant:de.supplant,now:de.rnow,updater:de.updater,map:de.map}},function(e,t,n){var r=n(6),i=/{([\w\-]+)}/g;unction s(e){return!!e&&"string"!=typeof e&&(Array.isArray&&Array.isArray(e)||"number"==typeof e.length)}function a(e,t){if(e&&t)if(s(e))for(var n=0,i=e.length;n<i;)t.call(e[n],e[n],n++);else for(var n in e)e.hasOwnProperty&&e.hasOwnProperty(n)&&t.call(e[n],n,e[n])}.exports={buildURL:function(e,t){var n=e.join(r.URLBIT),i=[];return t?(a(t,function(e,t){var n="object"==typeof t?JSON.stringify(t):t;null!=t&&0<c(n).length&&i.push(e+"="+c(n))}),n+="?"+i.join(r.PARAMSBIT)):n},encode:c,each:a,updater:function(e,t){var n,i=0,r=function(){i+t>o()?(clearTimeout(n),n=setTimeout(r,t)):(i=o(),e())};return r},rnow:o,isArray:s,map:function(e,n){var i=[];return a(e||[],,i},pamEncode:generateUUID:function(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,;return e&&e(t),t},timeout:function(e,t){if("undefined"!=typeof setTimeout)return setTimeout(e,t)},supplant:function(e,n){return e.replace(i,},grep:function(e,t){var n=[];return a(e||[],,n}}},function(e,t){var o=function(e,t){if(!(this instanceof o))return new o(e,t);var n=this,i=(e=n.url=e||"",n.protocol=t||"Sec-WebSocket-Protocol",e.split("/")),r={ssl:"wss:"===i[0],origin:i[2],publish_key:i[3],subscribe_key:i[4],channel:i[5]};if(n.CONNECTING=0,n.OPEN=1,n.CLOSING=2,n.CLOSED=3,n.CLOSE_NORMAL=1e3,n.CLOSE_GOING_AWAY=1001,n.CLOSE_PROTOCOL_ERROR=1002,n.CLOSE_UNSUPPORTED=1003,n.CLOSE_TOO_LARGE=1004,n.CLOSE_NO_STATUS=1005,n.CLOSE_ABNORMAL=1006,n.onclose=n.onerror=n.onmessage=n.onopen=n.onsend=function(){},n.binaryType="",n.extensions="",n.bufferedAmount=0,n.trasnmitting=!1,n.buffer=[],n.readyState=n.CONNECTING,!e)return n.readyState=n.CLOSED,n.onclose({code:n.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),n;n.pubnub=PUBNUBVisitor.init(r),n.pubnub.setup=r,n.setup=r,n.pubnub.subscribe({restore:!1,channel:r.channel,disconnect:n.onerror,reconnect:n.onopen,error:callback:function(e){n.onmessage({data:e})},connect:)};o.prototype.send=function(e){var t=this;t.pubnub.publish({channel:t.pubnub.setup.channel,message:e,callback:)},o.prototype.close=function(){var e=this;e.pubnub.unsubscribe({channel:e.pubnub.setup.channel}),e.readyState=e.CLOSED,e.onclose({})},e.exports=o}])}),!jsonStringify){var jsonStringify=JSON.stringify;JSON.stringify=function(){var e=Array.prototype.toJSON;delete Array.prototype.toJSON;var t=jsonStringify.apply(this,arguments);return Object.defineProperty(Array.prototype,"toJSON",{enumerable:!1,value:e,configurable:!0}),t}}function(I,M){var D=I.document,L=I.navigator,e=I.location,x=function(){var n,e,t,i,h=r=I.jQuery,o=I.$,a=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,s=/\S/,c=/^\s+/,l=/\s+$/,u=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,d=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,f=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,g=/(?:^|:|,)(?:\s*\[)+/g,m=/(webkit)[ \/]([\w.]+)/,v=/(opera)(?:.*version)?[ \/]([\w.]+)/,y=/(msie) ([\w.]+)/,b=/(mozilla)(?:.*? rv:([\w.]+))?/,w=/-([a-z]|[0-9])/gi,C=/^-ms-/,_=k=L.userAgent,T=Object.prototype.toString,S=Object.prototype.hasOwnProperty,x=Array.prototype.push,E=Array.prototype.slice,N=String.prototype.trim,P=Array.prototype.indexOf,A={};eturn h.fn=h.prototype={constructor:h,init:function(e,t,n){var i,r,o,s;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("body"===e&&!t&&D.body)return this.context=D,this[0]=D.body,this.selector=e,this.length=1,this;if("string"!=typeof e)return h.isFunction(e)?n.ready(e):(e.selector!==M&&(this.selector=e.selector,this.context=e.context),h.makeArray(e,this));if(!(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:a.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1])return s=(t=t instanceof h?t[0]:t)?t.ownerDocument||t:D,(o=u.exec(e))?h.isPlainObject(t)?(e=[D.createElement(o[1])],h.fn.attr.call(e,t,!0)):e=[s.createElement(o[1])]:e=((o=h.buildFragment([i[1]],[s])).cacheable?h.clone(o.fragment):o.fragment).childNodes,h.merge(this,e);if((r=D.getElementById(i[2]))&&r.parentNode){if(r.id!==i[2])return n.find(e);this.length=1,this[0]=r}return this.context=D,this.selector=e,this},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:get:pushStack:each:ready:eq:first:last:slice:map:end:push:x,sort:[].sort,splice:[].splice},h.fn.init.prototype=h.fn,h.extend=h.fn.extend=h.extend({noConflict:isReady:!1,readyWait:1,holdReady:ready:bindReady:isFunction:function(e){return"function"===h.type(e)},isArray:Array.isArray||isWindow:isNumeric:type:isPlainObject:isEmptyObject:error:parseJSON:parseXML:noop:function(){},globalEval:camelCase:nodeName:each:trim:N?makeArray:inArray:merge:grep:map:guid:1,proxy:access:function(e,t,n,i,r,o,s){var a,c=null==n,l=0,u=e.length;if(n&&"object"==typeof n){for(l in n)h.access(e,t,l,n[l],1,o,i);r=1}else if(i!==M){if(a=s===M&&h.isFunction(i),c&&(t=a?(a=t,:(t.call(e,i),null)),t)for(;l<u;l++)t(e[l],n,a?i.call(e[l],l,t(e[l],n)):i,s);r=1}return r?e:c?t.call(e):u?t(e[0],n):o},now:uaMatch:sub:browser:{}}),h.each("Boolean Number String Function Array Date RegExp Object".split(" "),,(e=h.uaMatch(k)).browser&&(h.browser[e.browser]=!0,h.browser.version=e.version),h.browser.webkit&&(h.browser.safari=!0),s.test("")&&(c=/^[\s\xA0]+/,l=/[\s\xA0]+$/),n=h(D),D.addEventListener?i:D.attachEvent&&(i),h}(),f={};x.Callbacks=function(o){o=o?f[o]|(o):{};var n,i,r,s,a,c,l=[],u=[],h,d=function(e,t){for(t=t||[],n=!o.memory||[e,t],r=i=!0,c=s||0,s=0,a=l.length;l&&c<a;c++)if(!1===l[c].apply(e,t)&&o.stopOnFalse){n=!0;break}r=!1,l&&(o.once?!0===n?p.disable():l=[]:u&&u.length&&(n=u.shift(),p.fireWith(n[0],n[1])))},p={add,remove,has,empty,disable,disabled:function(){return!l},lock,locked,fireWith,fire,fired};return p};var u=[].slice;x.extend({Deferred,when:function(e){var n=u.call(arguments,0),t=0,i=n.length,r=new Array(i),o=i,s=i<=1&&e&&x.isFunction(e.promise)?e:x.Deferred(),a=s.promise()f(1<i){for(;t<i;t++)n[t]&&n[t].promise&&x.isFunction(n[t].promise)?n[t].promise().then(c(t),s.reject,l(t)):--o;o||s.resolveWith(s,n)}else s!==e&&s.resolveWith(s,i?[e]:[]);return a}}),x.support();var r=/^(?:\{.*\}|\[.*\])$/,o=/([A-Z])/gextend({cache:{},uuid:0,expando:"jQuery"+(x.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData,data,removeData,_data,acceptData}),x.fn.extend({data:function(n,e){var i,r,t,o,s,a=this[0],c=0,l=null;if(n!==M)return"object"==typeof n?this.each(function(){x.data(this,n)}):((i=n.split(".",2))[1]=i[1]?"."+i[1]:"",r=i[1]+"!",x.access(this,null,e,1<arguments.length,null,!1));if(this.length&&(l=x.data(a),1===a.nodeType&&!x._data(a,"parsedAttrs"))){for(s=(t=a.attributes).length;c<s;c++)0===(o=t[c].name).indexOf("data-")&&(o=x.camelCase(o.substring(5)),h(a,o,l[o]));x._data(a,"parsedAttrs",!0)}return l},removeData:function(e){return this.each(function(){x.removeData(this,e)})}}),x.extend({_mark,_unmark,queue,dequeue}),x.fn.extend({queue,dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay,clearQueue,promise});var c,l,i,p=/[\n\t\r]/g,g=/\s+/,n=/\r/g,a=/^(?:button|input)$/i,m=/^(?:button|input|object|select|textarea)$/i,v=/^a(?:rea)?$/i,y=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,b=x.support.getSetAttribute;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,1<arguments.length)},removeAttr,prop,removeProp,addClass,removeClass,toggleClass,hasClass,val}),x.extend({valHooks:{option:{get},select:{get,set}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr,removeAttr,attrHooks:{type:{set},value:{get,set}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop,propHooks:{tabIndex:{get}}}),x.attrHooks.tabindex=x.propHooks.tabIndex,l={get,set},b||(i={name:!0,id:!0,coords:!0},c=x.valHooks.button={get,set},x.attrHooks.tabindex.set=c.set,x.each(["width","height"]),x.attrHooks.contenteditable={get:c.get,set}),x.support.hrefNormalized||x.each(["href","src","width","height"]),x.support.style||(x.attrHooks.style={get,set}),x.support.optSelected||(x.propHooks.selected=x.extend(x.propHooks.selected,{get})),x.support.enctype||(x.propFix.enctype="encoding"),x.support.checkOn||x.each(["radio","checkbox"]),x.each(["radio","checkbox"]);var w=/^(?:textarea|input|select)$/i,C=/^([^\.]*)?(?:\.(.+))?$/,t=/(?:^|\s)hover(\.\S+)?\b/,_=/^key/,k=/^(?:mouse|contextmenu)|click/,T=/^(?:focusinfocus|focusoutblur)$/,S=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,E;function N(){return!1x.event={add:function(e,t,n,i,r){var o,s,a,c,l,u,h,d,p,f,g;if(3!==e.nodeType&&8!==e.nodeType&&t&&n&&(o=x._data(e))){for(n.handler&&(n=(p=n).handler,r=p.selector),n.guid||(n.guid=x.guid++),(a=o.events)||(o.events=a={}),(s=o.handle)||(o.handle=s,s.elem=e),t=x.trim(E(t)).split(" "),c=0;c<t.length;c++)u=(l=C.exec(t[c])||[])[1],h=(l[2]||"").split(".").sort(),g=x.event.special[u]||{},u=(r?g.delegateType:g.bindType)||u,g=x.event.special[u]||{},d=x.extend({type:u,origType:l[1],data:i,handler:n,guid:n.guid,selector:r,quick:r&&(m=r,v=void 0,v=S.exec(m),v&&(v[1]=(v[1]||"").toLowerCase(),v[3]=v[3]&&new RegExp("(?:^|\\s)"+v[3]+"(?:\\s|$)")),v),namespace:h.join(".")},p),(f=a[u])||((f=a[u]=[]).delegateCount=0,g.setup&&!1!==g.setup.call(e,i,h,s)||(e.addEventListener?e.addEventListener(u,s,!1):e.attachEvent&&e.attachEvent("on"+u,s))),g.add&&(g.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),r?f.splice(f.delegateCount++,0,d):f.push(d),x.event.global[u]=!0;var m,v;e=null}},global:{},remove,customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(e,t,n,i){if(!n||3!==n.nodeType&&8!==n.nodeType){var r,o,s,a,c,l,u,h,d,p,f=e.type||e,g=[];if(!T.test(f+x.event.triggered)&&(0<=f.indexOf("!")&&(f=f.slice(0,-1),o=!0),0<=f.indexOf(".")&&(f=(g=f.split(".")).shift(),g.sort()),n&&!x.event.customEvent[f]||x.event.global[f]))if((e="object"==typeof e?e[x.expando]?e:new x.Event(f,e):new x.Event(f)).type=f,e.isTrigger=!0,e.exclusive=o,e.namespace=g.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,l=f.indexOf(":")<0?"on"+f:"",n){if(e.result=M,e.target||(e.target=n),(t=null!=t?x.makeArray(t):[]).unshift(e),!(u=x.event.special[f]||{}).trigger||!1!==u.trigger.apply(n,t)){if(d=[[n,u.bindType||f]],!i&&!u.noBubble&&!x.isWindow(n)){for(p=u.delegateType||f,a=T.test(p+f)?n:n.parentNode,c=null;a;a=a.parentNode)d.push([a,p]),c=a;c&&c===n.ownerDocument&&d.push([c.defaultView||c.parentWindow||I,p])}for(s=0;s<d.length&&!e.isPropagationStopped();s++)a=d[s][0],e.type=d[s][1],(h=(x._data(a,"events")||{})[e.type]&&x._data(a,"handle"))&&h.apply(a,t),(h=l&&a[l])&&x.acceptData(a)&&!1===h.apply(a,t)&&e.preventDefault();return e.type=f,i||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(n.ownerDocument,t)||"click"===f&&x.nodeName(n,"a")||!x.acceptData(n)||l&&n[f]&&("focus"!==f&&"blur"!==f||0!==e.target.offsetWidth)&&!x.isWindow(n)&&((c=n[l])&&(n[l]=null),n[x.event.triggered=f](),x.event.triggered=M,c&&(n[l]=c)),e.result}}else for(s in r=x.cache)r[s].events&&r[s].events[f]&&x.event.trigger(e,t,r[s].handle.elem,!0)}},dispatch:function(e){e=x.event.fix(e||I.event);var t,n,i,r,o,s,a,c,l,u,h=(x._data(this,"events")||{})[e.type]||[],d=h.delegateCount,p=[].slice.call(arguments,0),f=!e.exclusive&&!e.namespace,g=x.event.special[e.type]||{},m=[];if((p[0]=e).delegateTarget=this,!g.preDispatch||!1!==g.preDispatch.call(this,e)){if(d&&(!e.button||"click"!==e.type))for((r=x(this)).context=this.ownerDocument||this,i=e.target;i!=this;i=i.parentNode||this)if(!0!==i.disabled){for(s={},c=[],r[0]=i,t=0;t<d;t++)s[u=(l=h[t]).selector]===M&&(s[u]=l.quick?(v=i,y=l.quick,void 0,b=v.attributes||{},(!y[1]||v.nodeName.toLowerCase()===y[1])&&(!y[2]||(b.id||{}).value===y[2])&&(!y[3]||y[3].test((b.class||{}).value))):r.is(u)),s[u]&&c.push(l);c.length&&m.push({elem:i,matches:c})}var v,y,b;for(h.length>d&&m.push({elem:this,matches:h.slice(d)}),t=0;t<m.length&&!e.isPropagationStopped();t++)for(a=m[t],e.currentTarget=a.elem,n=0;n<a.matches.length&&!e.isImmediatePropagationStopped();n++)l=a.matches[n],(f||!e.namespace&&!l.namespace||e.namespace_re&&e.namespace_re.test(l.namespace))&&(e.data=l.data,e.handleObj=l,(o=((x.event.special[l.origType]||{}).handle||l.handler).apply(a.elem,p))!==M&&!1===(e.result=o)&&(e.preventDefault(),e.stopPropagation()));return g.postDispatch&&g.postDispatch.call(this,e),e.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter},fix,special:{ready:{setup:x.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup,teardown}},simulate},x.event.handle=x.event.dispatch,x.removeEvent=D.removeEventListener,x.Event,x.Event.prototype={preventDefault,stopPropagation,stopImmediatePropagation,isDefaultPrevented:N,isPropagationStopped:N,isImmediatePropagationStopped:N},x.each({mouseenter:"mouseover",mouseleave:"mouseout"}),x.support.submitBubbles||(x.event.special.submit={setup,postDispatch,teardown}),x.support.changeBubbles||(x.event.special.change={setup,handle,teardown}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"}),x.fn.extend({on,one,off,bind,unbind,live,die,delegate,undelegate,trigger,triggerHandler,toggle,hover}),x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" ")),function(){var v=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,u="sizcache"+(Math.random()+"").replace(".",""),s=0,y=Object.prototype.toString,h=!1,n=!0,l=/\\/g,o=/\r\n/g,c=/\W/;[0,0].sort);var b;b.uniqueSort,b.matches,b.matchesSelector,b.find,b.filter,b.error;var d=b.getText,w=b.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{class:"className",for:"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type},relative:{"+",">","":function(e,t,n){var i,r=s++,o=T;"string"!=typeof t||c.test(t)||(i=t=t.toLowerCase(),o=k),o("parentNode",t,r,e,i,n)},"~"},find:{ID,NAME,TAG},preFilter:{CLASS,ID,TAG,CHILD,ATTR,PSEUDO,POS},filters:{enabled,disabled:function(e){return!0===e.disabled},checked,selected,parent,empty,has,header:function(e){return/h\d/i.test(e.nodeName)},text,radio:function(e){return"input"===e.nodeName.toLowerCase()&&"radio"===e.type},checkbox:function(e){return"input"===e.nodeName.toLowerCase()&&"checkbox"===e.type},file:function(e){return"input"===e.nodeName.toLowerCase()&&"file"===e.type},password:function(e){return"input"===e.nodeName.toLowerCase()&&"password"===e.type},submit:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"submit"===e.type},image,reset,button,input,focus},setFilters:{first,last,even:function(e,t){return t%2==0},odd,lt,gt,nth:function(e,t,n){return n[3]-0===t},eq},filter:{PSEUDO,CHILD,ID,TAG,CLASS,ATTR,POS}},C=w.match.POS,e;for(var t in w.match)w.match[t]=new RegExp(w.match[t].source+/(?![^\[]*\])(?![^\(]*\))/.source),w.leftMatch[t]=new RegExp(/(^(?:.|\r|\n)*?)/.source+w.match[t].source.replace(/\\(\d+)/g,e));w.match.globalPOS=C;var i,p,r,a,f,g,m,_;try{Array.prototype.slice.call(D.documentElement.childNodes,0)[0].nodeType}catch(e){_.documentElement.compareDocumentPosition?i:(i,p),r=D.createElement("div"),a="script"+(new Date).getTime(),f=D.documentElement,r.innerHTML="<a name='"+a+"'/>",f.insertBefore(r,f.firstChild),D.getElementById(a)&&(w.find.ID,w.filter.ID),f.removeChild(r),f=r=null,(g=D.createElement("div")).appendChild(D.createComment("")),0<g.getElementsByTagName("*").length&&(w.find.TAG),g.innerHTML="<a href='#'></a>",g.firstChild&&void 0!==g.firstChild.getAttribute&&"#"!==g.firstChild.getAttribute("href")&&(w.attrHandle.href),g=null,D.querySelectorAll&()(),(m=D.createElement("div")).innerHTML="<div class='test e'></div><div class='test'></div>",m.getElementsByClassName&&0!==m.getElementsByClassName("e").length&&(m.lastChild.className="e",1!==m.getElementsByClassName("e").length&&(w.order.splice(1,0,"CLASS"),w.find.CLASS,m=null)),D.documentElement.contains?b.contains:D.documentElement.compareDocumentPosition?b.contains:b.contains=function(){return!1},b.isXML;var S;b.attr=x.attr,b.selectors.attrMap={},x.find=b,x.expr=b.selectors,x.expr[":"]=x.expr.filters,x.unique=b.uniqueSort,x.text=b.getText,x.isXMLDoc=b.isXML,x.contains=b.contains}();var A=/Until$/,O=/^(?:parents|prevUntil|prevAll)/,B=/,/,R=/^.[^:#\[\.,]*$/,j=Array.prototype.slice,U=x.expr.match.globalPOS,z={children:!0,contents:!0,next:!0,prev:!0}fn.extend({find,has,not:function(e){return this.pushStack(V(this,e,!1),"not",e)},filter,is,closest,index,add,andSelf}),x.each({parent,parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return x.nth(e,2,"nextSibling")},prev,nextAll:function(e){return x.dir(e,"nextSibling")},prevAll,nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil,siblings,children,contents}),x.extend({filter,dir,nth,sibling});var q="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,G=/^\s+/,J=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,X=/<([\w:]+)/,K=/<tbody/i,$=/<|&#?\w+;/,Q=/<(?:script|style)/i,Y=/<(?:script|object|embed|option|style)/i,Z=new RegExp("<(?:"+q+")[\\s/>]","i"),ee=/checked\s*(?:[^=]|=\s*.checked.)/i,te=/\/(java|ecma)script/i,ne=/^\s*<!(?:\[CDATA\[|\-\-)/,ie={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},re=H(D)ptgroup=ie.option,ie.tbody=ie.tfoot=ie.colgroup=ie.caption=ie.thead,ie.th=ie.td,x.support.htmlSerialize||(ie._default=[1,"div<div>","</div>"]),x.fn.extend({text,wrapAll,wrapInner,wrap,unwrap,append,prepend,before,after,remove,empty,clone,html,replaceWith,detach,domManip:function(n,i,r){var e,t,o,s,a,c=n[0],l=[];if(!x.support.checkClone&&3===arguments.length&&"string"==typeof c&&ee.test(c))return this.each);if(x.isFunction(c))return this.each);if(this[0]){if(s=c&&c.parentNode,t=1===(o=(e=x.support.parentNode&&s&&11===s.nodeType&&s.childNodes.length===this.length?{fragment:s}:x.buildFragment(n,this,l)).fragment).childNodes.length?o=o.firstChild:o.firstChild){i=i&&x.nodeName(t,"tr");for(var u=0,h=this.length,d=h-1;u<h;u++)r.call(i?(a=this[u],t,x.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a):this[u],e.cacheable||1<h&&u<d?x.clone(o,!0,!0):o)}l.length&&x.each(l)}return this}}),x.buildFragment,x.fragments={},x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"}),x.extend({clone:function(e,t,n){var i,r,o,s,a,c=x.support.html5Clone||x.isXMLDoc(e)||!Z.test("<"+e.nodeName+">")?e.cloneNode(!0):(s=e,a=D.createElement("div"),re.appendChild(a),a.innerHTML=s.outerHTML,a.firstChild);if(!(x.support.noCloneEvent&&x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(se(e,c),i=ae(e),r=ae(c),o=0;i[o];++o)r[o]&&se(i[o],r[o]);if(t&&(oe(e,c),n))for(i=ae(e),r=ae(c),o=0;i[o];++o)oe(i[o],r[o]);return i=r=null,c},clean:function(e,t,n,i){var r,o,s,a=[];void 0===(t=t||D).createElement&&(t=t.ownerDocument||t[0]&&t[0].ownerDocument||D);for(var c,l=0;null!=(c=e[l]);l++)if("number"==typeof c&&(c+=""),c){if("string"==typeof c)if($.test(c)){c=c.replace(J,"<$1></$2>");var u,h=(X.exec(c)||["",""])[1].toLowerCase(),d=ie[h]||ie._default,p=d[0],f=t.createElement("div"),g=re.childNodes;for(t===D?re.appendChild(f):H(t).appendChild(f),f.innerHTML=d[1]+c+d[2];p--;)f=f.lastChild;if(!x.support.tbody){var m=K.test(c),v="table"!==h||m?"<table>"!==d[1]||m?[]:f.childNodes:f.firstChild&&f.firstChild.childNodes;for(s=v.length-1;0<=s;--s)x.nodeName(v[s],"tbody")&&!v[s].childNodes.length&&v[s].parentNode.removeChild(v[s])}!x.support.leadingWhitespace&&G.test(c)&&f.insertBefore(t.createTextNode(G.exec(c)[0]),f.firstChild),c=f.childNodes,f&&(f.parentNode.removeChild(f),0<g.length&&(u=g[g.length-1])&&u.parentNode&&u.parentNode.removeChild(u))}else c=t.createTextNode(c);var y;if(!x.support.appendChecked)if(c[0]&&"number"==typeof(y=c.length))for(s=0;s<y;s++)le(c[s]);else le(c);c.nodeType?a.push(c):a=x.merge(a,c)}if(n)for(r,l=0;a[l];l++)if(o=a[l],i&&x.nodeName(o,"script")&&(!o.type||te.test(o.type)))i.push(o.parentNode?o.parentNode.removeChild(o):o);else{if(1===o.nodeType){var b=x.grep(o.getElementsByTagName("script"),r);a.splice.apply(a,[l+1,0].concat(b))}n.appendChild(o)}return a},cleanData});var ue,he,de,pe=/alpha\([^)]*\)/i,fe=/opacity=([^)]*)/,ge=/([A-Z]|^ms)/g,me=/^[\-+]?(?:\d*\.)?\d+$/i,ve=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,ye=/^([\-+])=([\-+.\de]+)/,be=/^margin/,we={position:"absolute",visibility:"hidden",display:"block"},Ce=["Top","Right","Bottom","Left"];function _e(e,t,n){var i="width"===t?e.offsetWidth:e.offsetHeight,r="width"===t?1:0;if(0<i){if("border"!==n)for(;r<4;r+=2)n||(i-=parseFloat(x.css(e,"padding"+Ce[r]))||0),"margin"===n?i+=parseFloat(x.css(e,n+Ce[r]))||0:i-=parseFloat(x.css(e,"border"+Ce[r]+"Width"))||0;return i+"px"}if(((i=ue(e,t))<0||null==i)&&(i=e.style[t]),ve.test(i))return i;if(i=parseFloat(i)||0,n)for(;r<4;r+=2)i+=parseFloat(x.css(e,"padding"+Ce[r]))||0,"padding"!==n&&(i+=parseFloat(x.css(e,"border"+Ce[r]+"Width"))||0),"margin"===n&&(i+=parseFloat(x.css(e,n+Ce[r]))||0);return i+"px"}x.fn.css,x.extend({cssHooks:{opacity:{get}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:x.support.cssFloat?"cssFloat":"styleFloat"},style,css,swap}),x.curCSS=x.css,D.defaultView&&D.defaultView.getComputedStyle&&(he),D.documentElement.currentStyle&&(de),ue=he||de,x.each(["height","width"]),x.support.opacity||(x.cssHooks.opacity={get,set}),x),x.expr&&x.expr.filters&&(x.expr.filters.hidden,x.expr.filters.visible),x.each({margin:"",padding:"",border:"Width"});var ke,Te,Se=/%20/g,xe=/\[\]$/,Ee=/\r?\n/g,Ne=/#.*$/,Pe=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ae=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Oe=/^(?:GET|HEAD)$/,Ie=/^\/\//,Me=/\?/,De=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Le=/^(?:select|textarea)/i,Be=/\s+/,Re=/([?&])_=[^&]*/,je=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Ue=x.fn.load,ze={},Fe={},Ve=["*/"]+["*"];try{ke=e.href}catch(e){(ke=D.createElement("a")).href="",ke=ke.hreffunction qe(e,t,n,i,r,o){(o=o||{})[r=r||t.dataTypes[0]]=!0;for(var s,a=e[r],c=0,l=a?a.length:0,u=e===ze;c<l&&(u||!s);c++)"string"==typeof(s=a[c](t,n,i))&&(s=!u||o[s]?M:(t.dataTypes.unshift(s),qe(e,t,n,i,s,o)));return!u&&s||o["*"]||(s=qe(e,t,n,i,"*",o)),se=je.exec(ke.toLowerCase())||[],x.fn.extend({load,serialize,serializeArray}),x.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" ")),x.each(["get","post"]),x.extend({getScript,getJSON,ajaxSetup,ajaxSettings:{url:ke,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(Te[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Ve},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":I.String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:He(ze),ajaxTransport:He(Fe),ajax:function(e,t){"object"==typeof e&&(t=e,e=M),t=t||{};var h,d,n,p,f,i,g,r,m=x.ajaxSetup({},t),v=m.context||m,y=v!==m&&(v.nodeType||v instanceof x)?x(v):x.event,b=x.Deferred(),w=x.Callbacks("once memory"),C=m.statusCode||{},o={},s={},_=0,k={readyState:0,setRequestHeader,getAllResponseHeaders,getResponseHeader,overrideMimeType,abort};function a(e,t,n,i){if(2!==_){_=2,f&&clearTimeout(f),p=M,d=i||"",k.readyState=0<e?4:0;var r,o,s,a,c,l=t,u=n(m,k,n):M;if(200<=e&&e<300||304===e)if(m.ifModified&&((a=k.getResponseHeader("Last-Modified"))&&(x.lastModified[h]=a),(c=k.getResponseHeader("Etag"))&&(x.etag[h]=c)),304===e)l="notmodified",r=!0;else try{o(m,u),l="success",r=!0}catch(e){l="parsererror",s=e}else(s=l)&&!e||(l="error",e<0&&(e=0));k.status=e,k.statusText=""+(t||l),r?b.resolveWith(v,[o,l,k]):b.rejectWith(v,[k,l,s]),k.statusCode(C),C=M,g&&y.trigger("ajax"+(r?"Success":"Error"),[k,m,r?o:s]),w.fireWith(v,[k,l]),g&&(y.trigger("ajaxComplete",[k,m]),--x.active||x.event.trigger("ajaxStop"))}}if(b.promise(k),k.success=k.done,k.error=k.fail,k.complete=w.add,k.statusCode,m.url=((e||m.url)+"").replace(Ne,"").replace(Ie,Te[1]+"//"),m.dataTypes=x.trim(m.dataType||"*").toLowerCase().split(Be),null==m.crossDomain&&(i=je.exec(m.url.toLowerCase()),m.crossDomain=!(!i||i[1]==Te[1]&&i[2]==Te[2]&&(i[3]||("http:"===i[1]?80:443))==(Te[3]||("http:"===Te[1]?80:443)))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=x.param(m.data,m.traditional)),qe(ze,m,t,k),2===_)return!1;if(g=m.global,m.type=m.type.toUpperCase(),m.hasContent=!Oe.test(m.type),g&&0==x.active++&&x.event.trigger("ajaxStart"),!m.hasContent&&(m.data&&(m.url+=(Me.test(m.url)?"&":"?")+m.data,delete m.data),h=m.url,!1===m.cache)){var c=x.now(),l=m.url.replace(Re,"$1_="+c);m.url=l+(l===m.url?(Me.test(m.url)?"&":"?")+"_="+c:"")}for(r in(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&k.setRequestHeader("Content-Type",m.contentType),m.ifModified&&(h=h||m.url,x.lastModified[h]&&k.setRequestHeader("If-Modified-Since",x.lastModified[h]),x.etag[h]&&k.setRequestHeader("If-None-Match",x.etag[h])),k.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Ve+"; q=0.01":""):m.accepts["*"]),m.headers)k.setRequestHeader(r,m.headers[r]);if(m.beforeSend&&(!1===m.beforeSend.call(v,k,m)||2===_))return k.abort(),!1;for(r in{success:1,error:1,complete:1})k[r](m[r]);if(p=qe(Fe,m,t,k)){k.readyState=1,g&&y.trigger("ajaxSend",[k,m]),m.async&&0<m.timeout&&(f=setTimeout(function(){k.abort("timeout")},m.timeout));try{_=1,p.send(o,a)}catch(e){if(!(_<2))throw e;a(-1,e)}}else a(-1,"No Transport");return k},param}),x.extend({active:0,lastModified:{},etag:{}});var Je=x.now(),Xe=/(\=)\?(&|$)|\?\?/i;x.ajaxSetup({jsonp:"callback",jsonpCallback}),x.ajaxPrefilter("json jsonp"),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script"}}),x.ajaxPrefilter("script"),x.ajaxTransport("script");var Ke,$e,Qe=!!I.ActiveXObject&,Ye=0x.ajaxSettings.xhr=I.ActiveXObject:Ze,$e=x.ajaxSettings.xhr(),x.extend(x.support,{ajax:!!$e,cors:!!$e&&"withCredentials"in $e}),x.support.ajax&&x.ajaxTransport);var et,tt,nt,it,rt={},ot=/^(?:toggle|show|hide)$/,st=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,at=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]]n.extend({show,hide,_toggle:x.fn.toggle,toggle,fadeTo,animate,stop}),x.each({slideDown:ut("show",1),slideUp:ut("hide",1),slideToggle:ut("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}}),x.extend({speed,easing:{linear:function(e){return e},swing},timers:[],fx}),x.fx.prototype={update,cur,custom,show,hide,step},x.extend(x.fx,{tick,interval:13,stop,speeds:{slow:600,fast:200,_default:400},step:{opacity,_default}}),x.each(at.concat.apply([],at)),x.expr&&x.expr.filters&&(x.expr.filters.animated);var dt,pt=/^t(?:able|d|h)$/i,ft=/^(?:body|html)$/idt="getBoundingClientRect"in D.documentElement,x.fn.offset,x.offset={bodyOffset,setOffset},x.fn.extend({position,offsetParent}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"}),x.each({Height:"height",Width:"width"}),I.jQuery=I.$=x}(window),$&&$.noConflict&&$.noConflict(),jQuery&&jQuery.noConflict&&(window.livechat=window.livechat||{},window.livechat.jQuery=jQuery.noConflict(!0)),function(){var e=this,t=e._,s={},r=Array.prototype,n=Object.prototype,i=Function.prototype,o=r.push,a=r.slice,c=r.concat,h=n.toString,l=n.hasOwnProperty,u=r.forEach,d=r.map,p=r.reduce,f=r.reduceRight,g=r.filter,m=r.every,v=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,C=Object.keys,_=i.bind,k;e._=k,(window._=k).VERSION="1.4.3";var T=k.each=k.forEach;k.map=k.collect;var S="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject,k.reduceRight=k.foldr,k.find=k.detect,k.filter=k.select,k.reject,k.every=k.all;var x=k.some=k.any;k.contains=k.include,k.invoke,k.pluck,k.where,k.max,k.min,k.shuffle;var E;k.sortBy;var N;k.groupBy,k.countBy,k.sortedIndex,k.toArray,k.size,k.first=k.head=k.take,k.initial,k.last,k.rest=k.tail=k.drop,k.compact;var P;k.flatten,k.without,k.uniq=k.unique,k.union,k.intersection,k.difference,k.zip,k.object,k.indexOf,k.lastIndexOf,k.range;var A=function(){};k.bind,k.bindAll,k.memoize,k.delay,k.defer,k.throttle,k.debounce,k.once,k.wrap,k.compose,k.after,k.keys=C|,k.values,k.pairs,k.invert,k.functions=k.methods,k.extend,k.pick,k.omit,k.defaults,k.clone,k.tap;var O;k.isEqual,k.isEmpty,k.isElement,k.isArray=w|,k.isObject,T(["Arguments","Function","String","Number","Date","RegExp"]),k.isArguments(arguments)||(k.isArguments),"function"!=typeof/./&&(k.isFunction),k.isFinite,k.isNaN,k.isBoolean,k.isNull,k.isUndefined,k.has,k.noConflict,k.identity,k.times,k.random;var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=k.invert(I.escape);var M={escape:new RegExp("["+k.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(I.unescape).join("|")+")","g")};k.each(["escape","unescape"]),k.result,k.mixin;var D=0;k.uniqueId,k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template,k.chain;var j;k.mixin(k),T(["pop","push","reverse","shift","sort","splice","unshift"]),T(["concat","join","slice"]),k.extend(k.prototype,{chain,value})}.call(this),"undefined"!=typeof _&&_.noConflict&&(window.livechat._=_.noConflict()),function(e){var t;window.livechat.Constants=new t,t=null}(),function(u){var e=function(){this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};e.prototype.encode,e.prototype.decode,e.prototype._utf8_encode,e.prototype._utf8_decode=function(e){var t,n,i,r="",o=0;for(t=n=i=0;o<e.length;)(t=e.charCodeAt(o))<128?(r+=String.fromCharCode(t),o++):191<t&&t<224?(n=e.charCodeAt(o+1),r+=String.fromCharCode((31&t)<<6|63&n),o+=2):(n=e.charCodeAt(o+1),i=e.charCodeAt(o+2),r+=String.fromCharCode((15&t)<<12|(63&n)<<6|63&i),o+=3);return r},u.Base64=new e}(window.livechat),function(e,t){var n,i,r;window.livechat.Autolinker=((n=function(e){for(var t in e=e||{})e.hasOwnProperty(t)&&(this[t]=e[t])}).prototype={constructor:n,newWindow:!0,stripPrefix:!1,twitter:!1,email:!1,urls:!0,className:"",matcherRegex:(i=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,r=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,new RegExp(["(",/(^|[^\w])@(\w{1,15})/.source,")","|","(",/(?:[\-;:&=\+\$,\w\.]+@)/.source,i.source,r.source,")","|","(","(?:","(?:",/(?:[A-Za-z]{3,9}:(?:\/\/)?)/.source,i.source,")","|","(?:","(.?//)?",/(?:www\.)/.source,i.source,")","|","(?:","(.?//)?",i.source,r.source,")",")",/(?:[\-A-Za-z0-9+&@#\/%?=~_()|!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|])?/.source,")"].join(""),"gi")),protocolRelativeRegex:/(.)?\/\//,htmlRegex:new RegExp(["<(/)?","("+/[0-9a-zA-Z:]+/.source+")","(?:","\\s+",/[^\s\0"'>\/=\x01-\x1F\x7F]+/.source,"(?:\\s*=\\s*"+/(?:".*?"|'.*?'|[^'"=<>`\s]+)/.source+")?",")*","\\s*/?",">"].join(""),"g"),urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,link,processHtml:function(e){for(var t,n,i=this.htmlRegex,r=0,o=0,s=[];null!==(t=i.exec(e));){var a=t[0],c=t[2],l=!!t[1];n=e.substring(r,t.index),r=t.index+a.length,"a"===c?l?0===(o=Math.max(o-1,0))&&s.push(n):(o++,s.push(this.processTextNode(n))):0===o?s.push(this.processTextNode(n)):s.push(n),s.push(a)}if(r<e.length){var u=this.processTextNode(e.substring(r));s.push(u)}return s.join("")},processTextNode:function(e){var _=this,t=this.matcherRegex,k=this.twitter,T=this.email,S=this.urls;return e.replace(t,function(e,t,n,i,r,o,s,a){var c=t,l=n,u=i,h=r,d=o,p=s||a,f="",g="";if(c&&!k||h&&!T||d&&!S||d&&-1===d.indexOf(".")||d&&/^[A-Za-z]{3,9}:/.test(d)&&!/:.*?[A-Za-z]/.test(d)||p&&/^[\w]\/\//.test(p))return e;if(")"===e.charAt(e.length-1)){var m=e.match(/\(/g),v=e.match(/\)/g);(m&&m.length||0)<(v&&v.length||0)&&(e=e.substr(0,e.length-1),g=")")}var y,b=e,w=e;if(c)y="twitter",f=l,b="https://twitter.com/"+u,w="@"+u;else if(h)y="email",b="mailto:"+h,w=h;else if(y="url",p){var C=new RegExp("^"+_.protocolRelativeRegex.source);f=(p.match(C)[1]||"")+f,b=b.replace(C,"//"),w=w.replace(C,"")}else/^[A-Za-z]{3,9}:/i.test(b)||(b="http://"+b);return f+_.createAnchorTag(y,b,w)+g})},createAnchorTag:function(e,t,n){return"<a "+this.createAnchorAttrsStr(e,t)+">"+(n=this.processAnchorText(n))+"</a>"},createAnchorAttrsStr:function(e,t){var n=['href="'+t+'"',' rel="noopener noreferrer" '],i=this.createCssClass(e);return i&&n.push('class="'+i+'"'),this.newWindow&&n.push('target="_blank"'),n.join(" ")},createCssClass,processAnchorText:function(e){return this.stripPrefix&&(e=this.stripUrlPrefix(e)),e=this.removeTrailingSlash(e),e=this.doTruncate(e)},stripUrlPrefix,removeTrailingSlash,doTruncate:function(e){var t=this.truncate;return t&&e.length>t&&(e=e.substring(0,t-2)+".."),e}},n.link,n)}(),function(){var j={function:!0,object:!0},U=j[typeof window]&&window||this,e=void 0var t=U.JSON,n=U.JSON3,i=!1,r=z(U,U.JSON3={noConflict});U.JSON={parse:r.parse,stringify:r.stringify}}.call(this),function(t){var e=function(){};e.prototype.setItem,e.prototype.getItem,e.prototype.removeItem,e.prototype.encode=function(e){return e?t.Base64.encode(e):e},e.prototype.decode,t.Cache=new e,e=null}(window.livechat),function(e){var t=function(){};t.prototype.getCookie,t.prototype.setCookie=function(e,t,n,i,r,o){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var s="";if(n)switch(n.constructor){case Number:if(n===1/0)s="; expires=Fri, 31 Dec 9999 23:59:59 GMT";else{var a=new Date;a.setTime(a.getTime()+n),s="; expires="+a.toUTCString()}break;case String:s="; expires="+n;break;case Date:s="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+s+(o?"; domain="+o:"")+(i?"; path="+i:"; path=/")+(r?"; secure":""),!0},t.prototype.removeCookie,t.prototype.hasCookie,t.prototype.cookieKeys,e.Cookies=new t,t=null}(window.livechat),function(e){var t=function(){this.timezone={"International Date Line West":{tz:"-11",dst:"0"},"Midway Island":{tz:"-11",dst:"0"},"American Samoa":{tz:"-11",dst:"0"},Hawaii:{tz:"-10",dst:"0"},Alaska:{tz:"-9",dst:"3"},"America/Los_Angeles":{tz:"-8",dst:"3"},"Pacific Time (US & Canada)":{tz:"-8",dst:"3"},Tijuana:{tz:"-8",dst:"3"},Arizona:{tz:"-7",dst:"0"},Chihuahua:{tz:"-7",dst:"4"},Mazatlan:{tz:"-7",dst:"4"},"Mountain Time (US & Canada)":{tz:"-7",dst:"3"},"America/Chicago":{tz:"-6",dst:"3"},"Central America":{tz:"-6",dst:"3"},"Central Time (US & Canada)":{tz:"-6",dst:"3"},Guadalajara:{tz:"-6",dst:"4"},"Mexico City":{tz:"-6",dst:"4"},Monterrey:{tz:"-6",dst:"4"},Saskatchewan:{tz:"-6",dst:"0"},"America/Bogota":{tz:"-5",dst:"0"},Bogota:{tz:"-5",dst:"0"},"Eastern Time (US & Canada)":{tz:"-5",dst:"3"},"Indiana (East)":{tz:"-5",dst:"3"},Lima:{tz:"-5",dst:"0"},Quito:{tz:"-5",dst:"0"},Caracas:{tz:"-4.5",dst:"0"},"Atlantic Time (Canada)":{tz:"-4",dst:"3"},"La Paz":{tz:"-4",dst:"0"},Santiago:{tz:"-4",dst:"10"},Newfoundland:{tz:"-3.5",dst:"3"},Brasilia:{tz:"-3",dst:"9"},"Buenos Aires":{tz:"-3",dst:"0"},Georgetown:{tz:"-4",dst:"0"},Greenland:{tz:"-3",dst:"12"},"Mid-Atlantic":{tz:"-2",dst:"0"},Azores:{tz:"-1",dst:"11"},"Cape Verde Is.":{tz:"-1",dst:"0"},Casablanca:{tz:"0",dst:"1"},Dublin:{tz:"0",dst:"11"},Edinburgh:{tz:"0",dst:"11"},"Europe/London":{tz:"0",dst:"11"},Lisbon:{tz:"0",dst:"11"},London:{tz:"0",dst:"11"},Monrovia:{tz:"0",dst:"0"},UTC:{tz:"0",dst:"0"},Amsterdam:{tz:"1",dst:"1"},Belgrade:{tz:"1",dst:"1"},Berlin:{tz:"1",dst:"1"},Bern:{tz:"1",dst:"1"},Bratislava:{tz:"1",dst:"1"},Brussels:{tz:"1",dst:"1"},Budapest:{tz:"1",dst:"1"},Copenhagen:{tz:"1",dst:"1"},Ljubljana:{tz:"1",dst:"1"},Madrid:{tz:"1",dst:"1"},Paris:{tz:"1",dst:"1"},Prague:{tz:"1",dst:"1"},Rome:{tz:"1",dst:"1"},Sarajevo:{tz:"1",dst:"1"},Skopje:{tz:"1",dst:"1"},Stockholm:{tz:"1",dst:"1"},Vienna:{tz:"1",dst:"1"},Warsaw:{tz:"1",dst:"1"},"West Central Africa":{tz:"1",dst:"0"},Zagreb:{tz:"1",dst:"1"},Athens:{tz:"2",dst:"2"},Bucharest:{tz:"2",dst:"2"},Cairo:{tz:"2",dst:"0"},Harare:{tz:"2",dst:"0"},Helsinki:{tz:"2",dst:"2"},Istanbul:{tz:"2",dst:"2"},Jerusalem:{tz:"2",dst:"8"},Kyiv:{tz:"2",dst:"2"},Minsk:{tz:"2",dst:"13"},Pretoria:{tz:"2",dst:"0"},Riga:{tz:"2",dst:"2"},Sofia:{tz:"2",dst:"2"},Tallinn:{tz:"2",dst:"2"},Vilnius:{tz:"2",dst:"2"},Baghdad:{tz:"3",dst:"0"},Kuwait:{tz:"3",dst:"0"},Moscow:{tz:"3",dst:"13"},Nairobi:{tz:"3",dst:"0"},Riyadh:{tz:"3",dst:"0"},"St. Petersburg":{tz:"3",dst:"13"},Volgograd:{tz:"3",dst:"13"},Tehran:{tz:"3.5",dst:"7"},"Abu Dhabi":{tz:"4",dst:"0"},Baku:{tz:"4",dst:"1"},Muscat:{tz:"4",dst:"0"},Tbilisi:{tz:"4",dst:"0"},Yerevan:{tz:"4",dst:"0"},Kabul:{tz:"4.5",dst:"0"},Ekaterinburg:{tz:"5",dst:"13"},Islamabad:{tz:"5",dst:"0"},Karachi:{tz:"5",dst:"0"},Tashkent:{tz:"5",dst:"0"},Chennai:{tz:"5.5",dst:"0"},Kolkata:{tz:"5.5",dst:"0"},Mumbai:{tz:"5.5",dst:"0"},"New Delhi":{tz:"5.5",dst:"0"},"Sri Jayawardenepura":{tz:"5.5",dst:"0"},Kathmandu:{tz:"5.75",dst:"0"},Almaty:{tz:"6",dst:"0"},Astana:{tz:"6",dst:"0"},Dhaka:{tz:"6",dst:"0"},Novosibirsk:{tz:"6",dst:"13"},Rangoon:{tz:"6.5",dst:"0"},Bangkok:{tz:"7",dst:"0"},Hanoi:{tz:"7",dst:"0"},Jakarta:{tz:"7",dst:"0"},Krasnoyarsk:{tz:"7",dst:"13"},Beijing:{tz:"8",dst:"0"},Chongqing:{tz:"8",dst:"0"},"Hong Kong":{tz:"8",dst:"0"},Irkutsk:{tz:"8",dst:"13"},"Kuala Lumpur":{tz:"8",dst:"0"},Perth:{tz:"8",dst:"0"},Singapore:{tz:"8",dst:"0"},Taipei:{tz:"8",dst:"0"},"Ulaan Bataar":{tz:"8",dst:"0"},Urumqi:{tz:"8",dst:"0"},Osaka:{tz:"9",dst:"0"},Sapporo:{tz:"9",dst:"0"},Seoul:{tz:"9",dst:"0"},Tokyo:{tz:"9",dst:"0"},Yakutsk:{tz:"9",dst:"13"},"Adelaide (CT)":{tz:"9.5",dst:"5"},Adelaide:{tz:"9.5",dst:"5"},Darwin:{tz:"9.5",dst:"0"},Brisbane:{tz:"10",dst:"0"},Canberra:{tz:"10",dst:"5"},Guam:{tz:"10",dst:"0"},Hobart:{tz:"10",dst:"5"},Melbourne:{tz:"10",dst:"5"},"Port Moresby":{tz:"10",dst:"0"},Sydney:{tz:"10",dst:"5"},Vladivostok:{tz:"10",dst:"13"},Magadan:{tz:"11",dst:"13"},"New Caledonia":{tz:"11",dst:"0"},"Solomon Is.":{tz:"11",dst:"0"},Auckland:{tz:"12",dst:"6"},Fiji:{tz:"12",dst:"0"},Kamchatka:{tz:"12",dst:"0"},"Marshall Is.":{tz:"12",dst:"0"},Wellington:{tz:"12",dst:"6"},"Nuku'alofa":{tz:"13",dst:"0"}},this.dstTypes={1:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"2",endHour:"3",startDay:"0",endDay:"0"},2:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"3",endHour:"4",startDay:"0",endDay:"0"},3:{startMonth:"2",endMonth:"10",startPeriod:"14",endPeriod:"7",startHour:"2",endHour:"2",startDay:"0",endDay:"0"},4:{startMonth:"3",endMonth:"9",startPeriod:"7",endPeriod:"30",startHour:"2",endHour:"2",startDay:"0",endDay:"0"},5:{startMonth:"3",endMonth:"9",startPeriod:"7",endPeriod:"7",startHour:"3",endHour:"2",startDay:"0",endDay:"0"},6:{startMonth:"3",endMonth:"8",startPeriod:"7",endPeriod:"30",startHour:"3",endHour:"2",startDay:"0",endDay:"0"},7:{startMonth:"2",endMonth:"8",startHour:"0",endHour:"0"},8:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"2",endHour:"2",startDay:"5",endDay:"0"},9:{startMonth:"1",endMonth:"9",startPeriod:"29",endPeriod:"31",startHour:"0",endHour:"0",startDay:"0",endDay:"0"},10:{startMonth:"3",endMonth:"8",startPeriod:"30",endPeriod:"7",startHour:"0",endHour:"0",startDay:"0",endDay:"0"},11:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"1",endHour:"2",startDay:"0",endDay:"0"},12:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"22",endHour:"23",startDay:"6",endDay:"6"}}};t.prototype.getMonthName,t.prototype.timeFormat=function(e){var t=Number(e.match(/^(\d+)/)[1]),n=Number(e.match(/:(\d+)/)[1]),i=e.match(/\s(.*)$/)[1];return"pm"==i&&t<12&&(t+=12),"am"==i&&12==t&&(t-=12),60*t+n},t.prototype.setDST=function(e,t,n,i,r,o,s){var a=(new Date).getFullYear();if(t.setFullYear(a),n.setFullYear(a),7==e)t.setDate(i),n.setDate(r);else{t.setDate(i);var c=t.getDay(),l=Number(i)-c,u=l-7+Number(o);c!=o&&(8==e||12==e?o<=i-l?t.setDate(l+Number(o)):t.setDate(u):t.setDate(l-Number(o))),n.setDate(r),u=(l=r-(c=n.getDay()))-7+Number(s),c!=s&&(12==e?s<=r-l?n.setDate(l+Number(s)):n.setDate(u):n.setDate(l-Number(s)))}},t.prototype.dstTime=function(e){var t=!1,n=new Date,i=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds()).getTime()-n.getTime(),r=new Date,o=Math.floor(60*this.timezone[e].tz*60*1e3),s=this.timezone[e].dst;if(0==s||13==s)13==s&&(t=!0);else{var a=this.dstTypes[s],c=new Date;c.setTime(c.getTime()+i);var l=new Date,u=new Date;new Date;switch(l.setMonth(a.startMonth),l.setHours(1),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0),u.setMonth(a.endMonth),u.setHours(1),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),Number(s)){case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 9:case 10:case 11:case 12:"Baku"==e?(l.setHours(4),u.setHours(5)):"Azores"==e?(l.setHours(12),u.setHours(1)):(l.setHours(a.startHour),u.setHours(a.endHour)),this.setDST(s,l,u,a.startPeriod,a.endPeriod,a.startDay,a.endDay);break;case 7:l.setHours(a.startHour),u.setHours(a.endHour);var h=end=22;this.setDST(s,l,u,h,end)}5==s||6==s||9==s||10==s?c.getTime()>l.getTime()&&c.getTime()<u.getTime()||(t=!0):c.getTime()>l.getTime()&&c.getTime()<u.getTime()&&(t=!0)}return r.setTime(r.getTime()+o+i+(t?36e5:0)),r},t.prototype.isBusinessHour=function(e){if("null"==e||!e)return!0;var t=JSON.parse(e),n=this.dstTime(t.time_zone),i=new Date(n),r=i.getDate(),o=this.getMonthName(i.getMonth()),s=t.holiday_data;for(var a in s)if(s.hasOwnProperty(a)&&s[a][0]==o+" "+r)return!1;var c=i.getDay(),l=i.getHours(),u=i.getMinutes(),h=t.business_time_data.working_hours[c];if(!h)return!1;var d=h.beginning_of_workday,p=this.timeFormat(d),f=h.end_of_workday,g=this.timeFormat(f);return!((l=60*l+u)<p||g<=l)},e.BusinessHours=new t}(window.livechat),function(t){t.jQuery;var e=function(){};e.prototype.parseAddress=function(e){var t=e[0].address_components;if(t&&t instanceof Array){for(var n={latitude:window.Geo.lat,longitude:window.Geo.lon,source:"google",ipAddress:window.Geo.IP},i={},r=0;r<t.length;r++){if(t[r].types&&t[r].types instanceof Array)switch(t[r].types[0]){case"locality":i.city=t[r].long_name;break;case"administrative_area_level_1":i.region=t[r].long_name;break;case"country":i.country=t[r].long_name,i.country_code=t[r].short_name}n.address=i}return n}},e.prototype.trimInvalidData=function(e){return t.JSON3.parse(t.JSON3.stringify(e).replace("undefined",""))},e.prototype.fetch,t.Location=new e,e=null}(window.livechat),function(e){e.jQuery;var t=function(){this.data={browser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],os:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identitiy:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"},{string:navigator.userAgent,subString:"Android",identity:"Android"}]}};t.prototype.detect=function(e){e({browser:this.search(this.data.browser),version:this.search(navigator.userAgent)||this.search(navigator.appVersion),os:this.search(this.data.os)})},t.prototype.search,e.Browser=new t}(window.livechat),function(e){var t=function(){this.token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,this.timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,this.timezoneClip=/[^-+\dA-Z]/g,this.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},this.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]}};t.prototype.pad,t.prototype.format=function(e,t,n){if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(t=e,e=void 0),e=e?new Date(e):new Date,isNaN(e))throw SyntaxError("invalid date");"UTC:"==(t=String(this.masks[t]||t||this.masks.default)).slice(0,4)&&(t=t.slice(4),n=!0);var i=n?"getUTC":"get",r=e[i+"Date"](),o=e[i+"Day"](),s=e[i+"Month"](),a=e[i+"FullYear"](),c=e[i+"Hours"](),l=e[i+"Minutes"](),u=e[i+"Seconds"](),h=e[i+"Milliseconds"](),d=n?0:e.getTimezoneOffset(),p={d:r,dd:this.pad(r),ddd:this.i18n.dayNames[o],dddd:this.i18n.dayNames[o+7],m:s+1,mm:this.pad(s+1),mmm:this.i18n.monthNames[s],mmmm:this.i18n.monthNames[s+12],yy:String(a).slice(2),yyyy:a,h:c%12||12,hh:this.pad(c%12||12),H:c,HH:this.pad(c),M:l,MM:this.pad(l),s:u,ss:this.pad(u),l:this.pad(h,3),L:this.pad(99<h?Math.round(h/10):h),t:c<12?"a":"p",tt:c<12?"am":"pm",T:c<12?"A":"P",TT:c<12?"AM":"PM",Z:n?"UTC":(String(e).match(this.timezone)||[""]).pop().replace(this.timezoneClip,""),o:(0<d?"-":"+")+this.pad(100*Math.floor(Math.abs(d)/60)+Math.abs(d)%60,4),S:["th","st","nd","rd"][3<r%10?0:(r%100-r%10!=10)*r%10]};return t.replace(this.token)},e.DateFormatter=new t,t=null}(window.livechat),function(){"use strict"var t=e.prototypehis.globalEventListeners=[],t.globalEventListeners=this.globalEventListeners,t.getListeners,t.flattenListeners,t.getListenersAsObject,t.addListener,t.addGlobalListener=function(e){var t="object"==typeof e;-1==o(window.livechat.globalEventListeners,e)&&window.livechat.globalEventListeners.push(t?e:{listener:e,once:!1})},t.on=n("addListener"),t.addOnceListener,t.once=n("addOnceListener"),t.defineEvent,t.defineEvents,t.removeListener,t.off=n("removeListener"),t.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},t.removeListeners,t.manipulateListeners,t.removeEvent,t.removeAllListeners=n("removeEvent"),t.emitEvent,t.triggerGloablEvent=function(e,t){var n=window.livechat.globalEventListeners.length,i=[e];Array.prototype.push.apply(i,t);for(var r=0;r<n;r++)window.livechat.globalEventListeners[r].listener.apply(this,i)},t.trigger=n("emitEvent"),t.emit,t.setOnceReturnValue,t._getOnceReturnValue,t._getEvents,this.EventEmitter=e}.call(window.livechat),"undefined"!=typeof exports&&"undefined"!=typeof require&&"undefined"==typeof setTimeout&&(setTimeout=require("timers").setTimeout,clearTimeout=require("timers").clearTimeout),AbstractChannel.subclass=function(e){var t;for(var n in t.prototype=new AbstractChannel,e)e.hasOwnProperty(n)&&(t.prototype[n]=e[n]);return t},AbstractChannel.prototype={onmessage:null,rawdata:!1,onclose:null,onopen:null,closed:!1,baseConstructor,send:function(e){if(this.closed)throw"Cannot send to a closed connection";this._ready()?this._send(e):this._buffer.push(e)},_flush,_incoming:function(t){if("o"!=t){if(!this.rawdata&&"object"!=typeof t)try{t=JSON.parse(t)}catch(e){throw console.error("Got invalid JSON data:",t.substr(0,40)),e}this.onmessage&&this.onmessage(t)}}};var WebSocketChannel=AbstractChannel.subclass({constructor:function(e){0===e.search(/^https?:/i)&&(e=e.replace(/^http/i,"ws")),this.address=e,this.socket=null,this._reopening=!1,this.pingIntervalId=null},toString:function(){var e="[WebSocketChannel to "+this.address;return this.socket?e+=" readyState: "+this.socket.readyState:e+=" (socket unopened)",this.closed&&(e+=" CLOSED"),e+"]"},close:function(){this.closed=!0,this.socket?this.socket.close():this.onclose&&this.onclose()},_send,_ready,_setupConnection:function(){this.closed||(this.socket=new WebSocket(this.address),this.socket.onopen=function(){this._flush(),!this._reopening&&this.onopen&&this.onopen(),pingSocket=this.socket,this.pingIntervalId=setInterval,3e4),this._reopening=!1}.bind(this),this.socket.onclose=function(e){this.socket=null,clearInterval(this.pingIntervalId),console.error("WebSocket close",e.wasClean?"clean":"unclean","code:",e.code,"reason:",e.reason||"none"),this.closed||(this._reopening=!0,this._setupConnection())}.bind(this),this.socket.onmessage.bind(this),this.socket.onerror.bind(this))}}),SocketIoChannel=AbstractChannel.subclass({constructor,toString:function(){var e="[SocketIoChannel to "+this.address;return this.socket?this.socket.connected?e+=" CONNECTED":e+=" CLOSED":e+=" (socket unopened)",e+"]"},close,_send:function(e){try{"websocket"!=this.socket.io.engine.transport.name&&e.body&&(e.body=encodeURIComponent(JSON.stringify(e.body)),e.datatype="bytearray"),this.socket.emit("message",e)}catch(e){console.error(e)}},_ready,_setupConnection:function(){var e;e=livechat&&livechat.io?livechat.io:io;var t=["?role=",this.role,"&i=",this.viewerId.toString(),"&s=",this.sdata,"&siteId=",this.siteId,"&room=",this.room.toString()].join("");this.socket=e(OneClickCbUtils.safeSessionGetItem("cobrowsingChannel")+t,{forceNew:!0});var n=function(){this.socket.emit("join",{room:this.room,role:this.role,i:this.viewerId.toString(),s:this.sdata,siteId:this.siteId,chatId:this.chatId}),this._flush()}.bind(this);this.socket.on("connect",n);var i.bind(this);this.socket.on("message",i)}}),PostMessageChannel=AbstractChannel.subclass({_pingPollPeriod:100,_pingPollIncrease:100,_pingMax:2e3,constructor:function(e,t){this.expectedOrigin=t,this._pingReceived=!1,this._receiveMessage=this._receiveMessage.bind(this),e&&this.bindWindow(e,!0),this._pingFailures=0},toString:function(){var e="[PostMessageChannel";return this.window?e+=" to window "+this.window:e+=" not bound to a window",this.window&&!this._pingReceived&&(e+=" still establishing"),e+"]"},bindWindow:function(e,t){this.window&&(this.close(),this.closed=!1),e&&e.contentWindow&&(e=e.contentWindow),this.window=e;var n=this.window;"undefined"!=typeof window&&(n=window),n.addEventListener("message",this._receiveMessage,!1),t||this._setupConnection()},_send:function(e){this.window.postMessage(e,this.expectedOrigin||"*")},_ready,_setupConnection:function(){if(!this.closed&&!this._pingReceived&&this.window){this._pingFailures++,this._send("hello");var e=this._pingPollPeriod+this._pingPollIncrease*this._pingFailures;e=e>this._pingPollMax?this._pingPollMax:e,this._pingTimeout=setTimeout(this._setupConnection.bind(this),e)}},_receiveMessage:function(e){if(e.source===this.window)if(this.expectedOrigin&&e.origin!=this.expectedOrigin)console.info("Expected message from",this.expectedOrigin,"but got message from",e.origin);else{if(this.expectedOrigin||(this.expectedOrigin=e.origin),"hello"==e.data)return this._pingReceived=!0,this._pingTimeout&&(clearTimeout(this._pingTimeout),this._pingTimeout=null),this.onopen&&this.onopen(),void this._flush();this._incoming(e.data)}},close:function(){this.closed=!0,this._pingReceived=!1,this._pingTimeout&&clearTimeout(this._pingTimeout),window.removeEventListener("message",this._receiveMessage,!1),this.onclose&&this.onclose()}}),PostMessageIncomingChannel=AbstractChannel.subclass({constructor:function(e){this.source=null,this.expectedOrigin=e,this._receiveMessage=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessage,!1)},toString:function(){var e="[PostMessageIncomingChannel";return this.source?e+=" bound to source "+e:e+=" awaiting source",e+"]"},_send:function(e){for(var t=0;t<this._buffer.length;t++)this.source.postMessage(this._buffer[t],this.expectedOrigin);this._buffer=[],this.source.postMessage(e,this.expectedOrigin)},_ready,_setupConnection,_receiveMessage:function(e){this.expectedOrigin&&"*"!=this.expectedOrigin&&e.origin!=this.expectedOrigin?console.info("Expected message from",this.expectedOrigin,"but got message from",e.origin):(this.expectedOrigin||(this.expectedOrigin=e.origin),this.source||(this.source=e.source),"hello"!=e.data?this._incoming(e.data):this.source.postMessage("hello",this.expectedOrigin))},close:function(){this.closed=!0,window.removeEventListener("message",this._receiveMessage,!1),this._pingTimeout&&clearTimeout(this._pingTimeout),this.onclose&&this.onclose()}}),CHROME_CHANNEL_EVENT="BrowserMirrorChromeChannel",ChromePostMessageChannel=AbstractChannel.subclass({_pingPollPeriod:100,constructor:function(e,t,n){this.expectedOrigin=n,this._pingReceived=!1,this.doc=t,e&&this.bindWindow(e,!0),this._receiveMessage=this._receiveMessage.bind(this),this.doc.addEventListener(CHROME_CHANNEL_EVENT,this._receiveMessage,!1,!0)},toString:function(){var e="[ChromePostMessageChannel";return this.window?e+=" to window "+this.window:e+=" not bound to a window",this.window&&!this._pingReceived&&(e+=" still establishing"),e+"]"},bindWindow:function(e,t){this.window&&this.close(),e&&e.contentWindow&&(e=e.contentWindow),this.window=e,t||this._setupConnection()},_send:function(e){this.window.postMessage(e,this.expectedOrigin||"*")},_ready:function(){return this.window&&this.pingReceived},_setupConnection:function(){this.closed||this._pingReceived||!this.window||(this._send("hello"),this._pingTimeout=setTimeout(this._setupConnection.bind(this),this._pingPollPeriod))},_receiveMessage:function(e){var t=e.target,n=t.getAttribute("data-payload");if(t.parentNode.removeChild(t),t=null,"hello"==n)return this._pingReceived=!0,this._pingTimeout&&(clearTimeout(this._pingTimeout),this._pingTimeout=null),this.onopen&&this.onopen(),void this._flush();self._incoming(n)},close:function(){this.closed=!0,this.doc.remoteEventListener(CHROME_CHANNEL_EVENT,this._receiveMessage,!1,!0),this._pingTimeout&&clearTimeout(this._pingTimeout),this.onclose&&this.onclose()}}),ChromePostMessageIncomingChannel=AbstractChannel.subclass({constructor,toString:function(){return"[ChromePostMessageIncomingChannel]"},_ready,_send:function(e){var t=document.createEvent("Events");t.initEvent(CHROME_CHANNEL_EVENT,!0,!1);var n=document.createElement("BrowserMirrorPayloadElement");n.setAttribute("data-payload",e),document.head.appendChild(n),n.dispatchEvent(t)},_setupConnection:function(){},_receiveMessage:function(e){e.source||e.origin||("hello"!=e.data?this._incoming(e.data):this._ready()?this._send("hello"):setTimeout.bind(this),100))},close:function(){this.closed=!0,window.removeEventListener("message",this._receiveMessage,!1),this.onclose&&this.onclose()}}),PortChannel=AbstractChannel.subclass({constructor:function(e,t){this.prefix=t||"",this.port=e,this._incoming=this._incoming.bind(this),this._remoteOpened=this._remoteOpened.bind(this),this._remoteClosed=this._remoteClosed.bind(this),this._gotHello=!1},toString:function(){var e="[PortChannel";return e+=" port: "+this.port.toString(),this.prefix&&(e+=' prefix: "'+this.prefix+'"'),e+="]"},_setupConnection:function(){this.port.on(this.prefix+"Send",this._incoming),this.port.on(this.prefix+"Opened",this._remoteOpened),this.port.on(this.prefix+"Closed",this._remoteClosed),this.port.emit("Opened")},destroy:function(){this.port.removeListener(this.prefix+"Send",this._incoming),this.port.removeListener(this.prefix+"Opened",this._remoteOpened),this.port.removeListener(this.prefix+"Closed",this._remoteClosed)},_ready:function(){return this._gotHello},_remoteOpened:function(e){this._gotHello=!0,e||this.port.emit("Opened",!0),this.onopen&&this.onopen(),this._flush()},_remoteClosed:function(){this._gotHello=!1,this.onclose&&this.onclose(),this.destroy()},close,_send}),PortProxyChannel=AbstractChannel.subclass({constructor:function(e,t){this.prefix=e||"",this.self=t||self,this._incoming=this._incoming.bind(this),this._remoteOpened=this._remoteOpened.bind(this)},toString:function(){var e="[PortProxyChannel";return"undefined"!=typeof self&&this.self===self||(e+=" bound to self "+this.self),this.prefix&&(e+=' with prefix "'+this.prefix+'"'),e+"]"},_setupConnection:function(){this.self.port.on(this.prefix+"IncomingData",this._incoming),this.self.port.on(this.prefix+"Opened",this._remoteOpened)},_ready:function(){return!0},_send,close:function(){try{this.self.port.emit(this.prefix+"Close")}catch(e){console.log("Error on close",e,e.name)}this.self.port.removeListener(this.prefix+"IncomingData",this._incoming),this.self.port.removeListener(this.prefix+"Opened",this._remoteOpened),this.closed=!0,this.onclose&&this.onclose()},_remoteOpened});function PortIncomingChannel(t,n,i){function e(e){t.send(e)}function r(){i.port.removeListener(n+"SendData",e),i.port.removeListener(n+"Close",r),t.close()}return n=n||"",(i=i||self).port.on(n+"SendData",e),i.port.on(n+"Close",r),t.rawdata=!0,t.onmessage,t.onopen=function(){i.port.emit(n+"Opened")},t.onclose,{close:r}}function EchoProxy(e,t,n){var r=[];function i(n,e,i){function t(){for(var e=[n],t=0;t<arguments.length;t++)e.push(arguments[t]);i.port.emit.apply(i.port,e)}e.port.on(n,t),r.push([e.port,n,t])}return i((n=n||"")+"IncomingData",t,e),i(n+"Opened",t,e),i(n+"Closed",t,e),i(n+"SendData",e,t),i(n+"Close",e,t),{close:function(){for(var e=0;e<r.length;e++)r[e][0].removeListener(r[e][1],r[e][2])},send:function(e){"string"!=typeof e&&(e=JSON.stringify(e)),t.port.emit(n+"SendData",e)}}}function getElementPosition(e){for(var t=0,n=0;e;)e.offsetTop&&(t+=e.offsetTop),e.offsetLeft&&(n+=e.offsetLeft),e=e.offsetParent;return{top:t,left:n}}function doOnLoad(e){"complete"==this.document.readyState?e():window.addEventListener("load",e,!1)}function getScreenRange(e){for(var t=(e=e||document).defaultView,n=t.pageYOffset,i=n+t.innerHeight,r=iterNodes(document.body),o=!0,s=null,a=null,c=0,l=0;;){var u=r();if(!u)break;if(!u.jsmirrorHide&&u.jsmirrorId&&u.nodeType==document.ELEMENT_NODE){for(var h=0,d=u;d;)d.offsetTop&&(h+=d.offsetTop),d=d.offsetParent;if(o){if(n<h){s=a=u,o=!1,c=n-h;continue}}else{if(h+u.clientHeight>i)break;l=i-(h+u.clientHeight),a=u}}}return{start:s,end:a,startOffsetTop:c,endOffsetTop:l}}function iterNodes(e){var n=[[e,null]],i=0;return function(){if(!n[i])return null;var e=n[i];if(null===e[1]){if(!(t=e[0]))throw"weird item in stack";t.nodeType==this.document.ELEMENT_NODE&&t.childNodes.length?n[i]=[t.childNodes,0]:(n[i]=null,i--)}else{var t;if(!(t=e[0][e[1]]))throw"weird item in stack";t.nodeType==this.document.ELEMENT_NODE&&t.childNodes.length?e[1]>=e[0].length-1?n[i]=[t.childNodes,0]:(e[1]++,n[++i]=[t.childNodes,0]):e[1]>=e[0].length-1?(n[i]=null,i--):e[1]++}return t}}function expandRange(e){var n={start:e.startContainer,end:e.endContainer,startOffset:e.startOffset,endOffset:e.endOffset,startText:!1,endText:!1};function t(e){if(n[e].nodeType==this.document.TEXT_NODE)for(;;){var t=n[e].previousSibling;if(null===t){n[e]=n[e].parentNode,n[e+"Text"]="inner";break}if(t.nodeType==this.document.ELEMENT_NODE){n[e]=t,n[e+"Text"]="after";break}t.nodeType==this.document.TEXT_NODE&&(n[e]=t,n[e+"Offset"]+=t.nodeValue.length)}}return t("start"),t("end"),n}function showRange(e,t){var n;if(e.start!=e.end||"inner"!=e.startText||"inner"!=e.endText){"inner"==e.startText?e.start=splitTextAfter(e.start.childNodes[0],e.startOffset):"after"==e.startText?e.start=splitTextAfter(e.start.nextSibling,e.startOffset):e.startOffset&&(n=e.start.childNodes[e.startOffset])&&(e.start=n),"inner"==e.endText?e.end=splitTextBefore(e.end.childNodes[0],e.endOffset):"after"==e.endText?e.end=splitTextBefore(e.end.nextSibling,e.endOffset):e.endOffset&&(n=e.end.childNodes[e.endOffset])&&(e.end=n);for(var i=e.start;;){if(t(i),null===(i=getNextElement(i))){OneClickCbUtils.cobrowseLog(OneClickCbUtils.WARN,"pos fell out to null",e.start);break}for(;containsElement(i,e.end);)i=i.childNodes[0];if(i==e.end){t(i);break}}}else{t(splitTextBetween(e.start,e.startOffset,e.endOffset))}}function containsElement(e,t){if(e==t)return!1;if(e.nodeType!=this.document.ELEMENT_NODE)return!1;for(var n=0;n<e.childNodes.length;n++){if(e.childNodes[n]==t)return!0;if(containsElement(e.childNodes[n],t))return!0}return!1}function getNextElement(e){if(e.childNodes&&e.childNodes.length)return e.childNodes[0];for(;!e.nextSibling;)if(!(e=e.parentNode))return OneClickCbUtils.cobrowseLog(OneClickCbUtils.WARN,"no parent"),null;return e.nextSibling}function splitTextBefore(e,t){var n=this.document.createElement("span");n.artificialRangeElement=!0;var i="";if(e.nodeType!=this.document.TEXT_NODE)throw"Unexpected node: "+e;for(;e.nodeValue.length<t;){i+=e.nodeValue,t-=e.nodeValue.length;var r=e;e=e.nextSibling,r.parentNode.removeChild(r)}i+=e.nodeValue.substr(0,t);var o=e.nodeValue.substr(t,e.nodeValue.length-t);return e.nodeValue=o,n.appendChild(this.document.createTextNode(i)),e.parentNode.insertBefore(n,e),n}function splitTextAfter(e,t){for(;e.nodeValue.length<t;){if(e.nodeValue,t-=e.nodeValue.length,!e.nextSibling){OneClickCbUtils.cobrowseLog(OneClickCbUtils.WARN,"Could not get "+t+"chars from element",e);break}e=e.nextSibling}var n=e.nodeValue.substr(t,e.nodeValue.length-t);e.nodeValue=e.nodeValue.substr(0,t);var i=this.document.createElement("span");i.artificialRangeElement=!0;var r=i;i.appendChild(this.document.createTextNode(n)),e.parentNode.insertBefore(i,e.nextSibling);for(var o=i.nextSibling;o;)if(o.nodeType==this.document.TEXT_NODE)if(i){var s=o;o=o.nextSibling,i.appendChild(s)}else{(i=this.document.createElement("span")).artificialRangeElement=!0;s=o;o=o.nextSibling,s.parentNode.insertBefore(i,s),i.appendChild(s)}else i=null,o=o.nextSibling;return r}function splitTextBetween(e,t,n){if(n<t)throw"Unexpected range: "+t+" to "+n;for(var i=n-t,r="",o="",s="",a=!0,c=!1,l=[],u=0;u<e.childNodes.length;u++){var h=e.childNodes[u];if(h.nodeType==this.document.TEXT_NODE){l.push(h);var d=h.nodeValue;a&&d.length<t?(r+=d,t-=d.length):a&&(r+=d.substr(0,t),a=!1,d=d.substr(t,d.length-t)),a||c||(d.length<i?(s+=d,i-=d.length):(s+=d.substr(0,i),d=d.substr(i,d.length-i),c=!0)),c&&(o+=d)}else{if(c)break;OneClickCbUtils.cobrowseLog(OneClickCbUtils.WARN,"Unexpected element",h)}}var p=this.document.createTextNode(r),f=this.document.createTextNode(o),g=this.document.createElement("span");for(g.artificialRangeElement=!0,g.appendChild(this.document.createTextNode(s)),u=0;u<l.length;u++)e.removeChild(l[u]);return e.insertBefore(f,e.childNodes[0]),e.insertBefore(g,f),e.insertBefore(p,g),g}"undefined"!=typeof exports&&(exports.EchoProxy=EchoProxy,exports.PostMessageChannel=PostMessageChannel,exports.ChromePostMessageChannel=ChromePostMessageChannel,exports.PostMessageIncomingChannel=PostMessageIncomingChannel,exports.PortChannel=PortChannel,exports.PortProxyChannel=PortProxyChannel);var TEMPORARY_HIGHLIGHT_DELAY=1e4;function temporaryHighlight(e,t,n,i){var r=e.ownerDocument;t=t||0,n=n||0;var o=getElementPosition(e),s=this.document.createElement("div");function a(){null!==s&&(r.body.removeChild(s),s=null)}return s.style.backgroundColor="transparent",s.style.border="2px solid #f00",s.style.position="absolute",s.style.width="100px",s.style.height="100px",s.style.borderRadius="50px",s.style.top=o.top+t-50+"px",s.style.left=o.left+n-50+"px",s.jsmirrorHide=!0,r.body.appendChild(s),setTimeout(a,TEMPORARY_HIGHLIGHT_DELAY),a}function binder(t,n,i){i=t.name;return function(){try{var e=t.apply(n||this,arguments)}catch(e){throw console.warn(i+"() raised:",e+""),e}return void 0!==e&&console.log(i+"() returned:",JSON.stringify(e)),e}}var chatjQuery=chatjQuery||livechat.jQuery||jQuery,ELEMENT_NODE;if(!window.Freeze)var Freeze={};Freeze._inputTags={INPUT:!0,TEXTAREA:!0,SELECT:!0,OPTION:!0},Freeze.eventListenerWrapper=function(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent("on"+t,n)},Freeze.removeEventListener,Freeze.isMaster,Freeze.scrolledElements=[],setInterval(function(){if(Freeze.isMaster()&&Freeze.scrolledElements.length){var e=!(msg={type:"elScroll",body:{elScroll:{}}});for(i=0;i<Freeze.scrolledElements.length;i++)el=Freeze.scrolledElements[i],9==el.nodeType?Freeze.elementTracker.scrollEventListener():(msg.body.elScroll[el.jsmirrorId]={top:el.scrollTop,left:el.scrollLeft},e=!0);e&&Freeze.elementTracker.send(msg),Freeze.scrolledElements=[]}},100),Freeze._scrollEvents=function(e){var t=e.target||e.scrElement;-1==Freeze.scrolledElements.indexOf(t)&&Freeze.scrolledElements.push(t)},Freeze._changeEvent=function(e){Freeze.isMaster()&&Freeze.elementTracker.send({type:"change",body:{target:e.target.jsmirrorId,value:e.target.value}})},Freeze.attachChangeEvent=function(e){try{if(Freeze._inputTags[e.tagName]){var t;if("INPUT"==e.tagName){if(e.type&&"password"==e.type.toLowerCase())return;var n=chatjQuery(e).attr("value");void 0!==n&&0!=n||(current_value=chatjQuery(e).val(),chatjQuery(e).attr("value",current_value))}t=Freeze.canSendValue(e)?"keyup":"change",Freeze.eventListenerWrapper(e,t,Freeze._changeEvent,!1)}else e.isContentEditable&&Freeze.eventListenerWrapper(e,"change",Freeze._changeEvent,!1)}catch(e){console.log("changeEvent error"+e)}},Freeze.modifierPressed=!1,Freeze.attachKeyBoardEvents=function(e){downResponder=function(e){var t=e.target||e.srcElement,n=e.keyCode||e.which;return"Meta"==e.keyIdentifier||"Meta"==e.key||17==n?(this.modifierPressed=!0,allow=!0):this.modifierPressed?(this.modifierPressed=!1,allow=!0):allow="lc_chat_input_container"==t.id||OneClickCbUtils.allowKeyBoardEvents()||"msg-box"==t.id,allow},eventResponder=function(e){var t=e.target||e.srcElement;return"lc_chat_input_container"==t.id||OneClickCbUtils.allowKeyBoardEvents()||"msg-box"==t.id},e.onkeypress=e.onkeyup=eventResponder,e.onkeydown=downResponder,Freeze.eventListenerWrapper(e,"keydown",downResponder,!0),Freeze.eventListenerWrapper(e,"keyup",eventResponder,!0),Freeze.eventListenerWrapper(e,"keypress",eventResponder,!0)},Freeze.makeId=function e(t){return this.attachChangeEvent(t),this.attachKeyBoardEvents(t),this.eventListenerWrapper(t,"scroll",this._scrollEvents,!1),"el"+e.counter++},Freeze.makeId.counter=1e3,Freeze.skipElementsOKEmpty={LINK:!0,STYLE:!0,HEAD:!0,META:!0,BODY:!0,APPLET:!0,BASE:!0,BASEFONT:!0,BDO:!0,BR:!0,OBJECT:!0,TD:!0,TR:!0,TH:!0,THEAD:!0,TITLE:!0,I:!0,B:!0,SPAN:!0,A:!0,INPUT:!0},Freeze.voidElements={AREA:!0,BASE:!0,BR:!0,COL:!0,COMMAND:!0,EMBED:!0,HR:!0,IMG:!0,INPUT:!0,KEYGEN:!0,LINK:!0,META:!0,PARAM:!0,SOURCE:!0,TRACK:!0,WBR:!0},Freeze.skipElementsBadTags={SCRIPT:!0,NOSCRIPT:!0,IFRAME:!0},Freeze.skipElement=function(e){if(e.isSVG&&1==e.isSVG)return!1;var t=e.tagName;if(Freeze.skipElementsBadTags[t]||e.jsmirrorHide||"webSocketContainer"==e.id)return!0;if(e.id){var n=["cb-block-canvas","oneclick-canvas-wrapper","oneclick-canvas-wrapper","oneclick-background-canvas","oneclick-annotation-button","oneclick-annotation-canvas","oneclick-annotation-toolbar","oneclick-master-cursor","oneclick-client-cursor","oneclick-cobrowse-button","oneclick-cobrowse-url","oneclick-cobrowse-tc","oneclick-cobrowse-gc","lc_chat_layout","lc_cb_actions","livechat_layout","scroll-to-top"];try{for(var i=0;i<n.length;i++)if(-1!=e.id.search(n[i]))return!0}catch(e){console.log("error: search for ",n[i],"undefined")}}return!((!e.style||"none"!=e.style.display||chatjQuery(e).is(":visible"))&&(0!==e.clientWidth||0!==e.clientHeight||Freeze.skipElementsOKEmpty[t]||e.childNodes.length))},Freeze.serializeDocument=function(){for(var e=document,t=e.childNodes[0],n=0;n<e.childNodes.length;n++)if(e.childNodes[n].tagName&&("HTML"==e.childNodes[n].tagName||"html"==e.childNodes[n].tagName)){t=e.childNodes[n];break}return{href:location.href,htmlAttrs:Freeze.serializeAttributes(t),head:Freeze.serializeElement(e.head),body:Freeze.serializeElement(e.body),hash:location.hash||""}},Freeze.cssTextList=[],Freeze.getInlineCSS=function(){for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];t.href||this.addCSSRules(t)}return this.cssTextList},Freeze.addCSSRules=function(e){for(var t=0;t<e.cssRules.length;t++){var n=e.cssRules[t];n.type==n.MEDIA_RULE?this.addCSSRules(n):n.type==n.STYLE_RULE&&-1!=n.cssText.search("grid-stack")&&this.cssTextList.push(n.cssText)}},Freeze.elementTracker={},Freeze.trackElement=function(e){var t=this.makeId(e);e.jsmirrorId=t,this.elementTracker.elements[t]=e},Freeze.serializeElement=function(t,e){if("svg"==t.tagName&&(t.isSVG=!0),t.jsmirrorId||Freeze.trackElement(t),"CANVAS"==t.tagName)return["IMG",t.jsmirrorId,{src:t.toDataURL("image/png")},[]];var n,i=this.serializeAttributes(t);if("IFRAME"==t.tagName){var r;n=[];try{r=this.staticHTML(t.contentWindow.document.documentElement)}catch(e){return console.warn("Had to skip iframe for permission reasons:",e+"","src:",t.src),["SPAN",t.jsmirrorId,{},[]]}i.src=this.encodeData("text/html",r)}else for(var o=(n=this.normalChildren(t)).length,s=0;s<o;s++){"string"!=typeof n[s]&&(n[s]=this.serializeElement(n[s]))}var a=[t.tagName.replace(/[^a-zA-Z0-9]/g,""),t.jsmirrorId,i,n,t.parentNode.jsmirrorId];return e&&a.push(t.innerHTML),a},Freeze.normalChildren=function(e){for(var t=[],n=e.childNodes,i=n.length,r=0;r<i;r++){var o=n[r];if(o.isSVG=e.isSVG,!this.skipElement(o))if(o.nodeType==this.TEXT_NODE){var s=o.nodeValue;if(!s)continue;r&&"string"==typeof t[t.length-1]?t[t.length-1]+=s:t.push(s)}else o.nodeType==this.ELEMENT_NODE&&t.push(o)}return t},Freeze.filterInnerHTML=function(e){for(var t=[e[0],e[1],e[2],[]],n=0;n<e[3].length;n++)"string"==typeof e[3][n]?t[3].push(e[3][n]):t[3].push(this.filterInnerHTML(e[3][n]));return t},Freeze.canSendValue=function(e){return!("TEXTAREA"!=e.tagName&&("INPUT"!=e.tagName||!e.type||"text"!=e.type.toLowerCase()&&"email"!=e.type.toLowerCase()))},Freeze.isCheckedElement=function(e){return!(!e||"INPUT"!=e.tagName||!e.type||"checkbox"!=e.type.toLowerCase()&&"radio"!=e.type.toLowerCase())},Freeze.serializeAttributes=function(e){var t={};if(e.attributes)for(var n=e.attributes.length,i=0;i<n;i++){var r=e.attributes[i].name;if("on"!=r.substr(0,2).toLowerCase())if("href"==r||"src"==r||"value"==r)t[r]=e[r];else if("HTML"==e.tagName&&"class"==r){var o=e.attributes[i].nodeValue;o=o.replace("lc-cb-container-vi",""),t[r]=o}else t[r]=e.attributes[i].nodeValue}return Freeze.canSendValue(e)&&(t.value=e.value),this.isCheckedElement(e)?t.checked=e.checked:"SELECT"==e.tagName&&(t.value=e.value),t},Freeze.compareAttributes=function(e,t){var n=0;t.tagName;for(var i in e)if(e.hasOwnProperty(i)){var r;if(n++,"href"==i||"src"==i||"value"==i||"checked"==i&&this.isCheckedElement(t)){if(r=t[i],t.hasAttribute(i)||n--,t.critValue&&t.critValue!==r)return!1}else r=t.getAttribute(i);if(r!=e[i])return-1!=e[i].indexOf(r)&&"stylesheet"==e.rel}var o=t.attributes.length;if(o==n)return!0;for(i=0;i<o;i++){"on"==t.attributes[i].name.substr(0,2).toLowerCase()&&n++}return n==o},Freeze.compareAttributes2=function(e,t){var n,i=this.serializeAttributes(t),r=!0;for(n in e)e[n]!=i[n]&&(r=!1);for(n in i)e[n]!=i[n]&&(r=!1);var o=this.compareAttributes(e,t);return r!=o&&console.log("Disagreement",t.tagName,r,o),r},Freeze.htmlQuote=function(e){return e?-1==e.search(/[&<"]/)?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):e},Freeze.encodeData,Freeze.staticHTML=function(e){if("CANVAS"==e.tagName)return'<IMG SRC="'+this.htmlQuote(e.toDataURL("image/png"))+'">';var t=null;if("IFRAME"==e.tagName)try{var n=this.staticHTML(e.contentWindow.document.documentElement);t=this.encodeData("text/html",n)}catch(e){console.warn("Had to skip iframe for permission reasons:",e+"")}var i,r="<"+e.tagName,o=e.attributes;if(o&&(i=o.length))for(var s=0;s<i;s++){var a,c=o[s].name;if("on"!=c.substr(0,2).toLowerCase())a="src"==c&&t?t:"href"==c||"src"==c||"value"==c?e[c]:o[s].nodeValue,r+=" "+c+'="'+this.htmlQuote(a)+'"'}return r+=">",this.voidElements[e.tagName]||(r+=this.staticChildren(e),r+="</"+e.tagName+">"),r},Freeze.getAttributes=function(e){var t=[],n=e.attributes;if(n&&n.length)for(var i=n.length,r=0;r<i;r++){var o,s=n[r].name;if("on"!=s.substr(0,2).toLowerCase())o="href"==s||"src"==s||"value"==s?e[s]:n[r].nodeValue,t.push([s,o])}return t},Freeze.TEXT_NODE=document.TEXT_NODE,Freeze.ELEMENT_NODE=document.ELEMENT_NODE,Freeze.staticChildren=function(e){for(var t="",n=e.childNodes,i=n.length,r=0;r<i;r++){var o=n[r];if(o.isSVG=e.isSVG,!this.skipElement(o))if(o.nodeType==this.TEXT_NODE){var s=o.nodeValue;t+=this.htmlQuote(s)}else o.nodeType==this.ELEMENT_NODE&&(t+=this.staticHTML(o))}return t},Freeze.applyDiff=function(e){for(var t,n,i,r=0;r<e.length;r++){var o=e[r],s=o[0],a=Freeze.getElement(o[1]);if(a){if("attrs"===s&&Freeze.setAttributes(a,o[2]),"deletetext-"===s||"delete-"===s||"delete-+"==s)for(;a.previousSibling&&a.previousSibling.nodeType==document.TEXT_NODE;)a.parentNode.removeChild(a.previousSibling);if("delete+"===s)for(;a.nextSibling&&a.nextSibling.nodeType==document.TEXT_NODE;)a.parentNode.removeChild(a.nextSibling);if("delete"!==s&&"delete-"!==s&&"delete+"!==s&&"delete-+"!==s||a.parentNode.removeChild(a),"delete_last_text"===s){if(!a.childNodes.length){console.warn("Tried to delete_last_text of element with no children",o);continue}var c=a.childNodes[a.childNodes.length-1];if(c.nodeType!=document.TEXT_NODE){console.warn("Got command that deletes something that isn't text",o,c);continue}a.removeChild(c)}if("replace_text"===s)if(1!==a.childNodes.length||a.childNodes[0].nodeType!==document.TEXT_NODE){for(;a.childNodes;)a.removeChild(a.childNodes[0]);a.appendChild(document.createTextNode(o[2]))}else a.childNodes[0].nodeValue=o[2];if("insert_before"===s)for(n=(t=o[2]).length-1;0<=n;n--)i="string"==typeof t[n]?document.createTextNode(t[n]):Freeze.deserializeElement(t[n]),a.parentNode.insertBefore(i,a);if("append_to"===s)for(t=o[2],n=0;n<t.length;n++)i="string"==typeof t[n]?document.createTextNode(t[n]):Freeze.deserializeElement(t[n]),a.appendChild(i)}else console.warn("Got diff command for element that does not exist",o)}},Freeze.unfreeze=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3];if(e.tagName==n){Freeze.setAttributes(e,r),e.jsmirrorId=i;for(var s=0,a=0;a<o.length;a++){var c=a+s,l=e.childNodes[c];if(l){if(l.jsmirrorHide||"webSocketContainer"==l.id){s++,a--;continue}"string"==typeof o[a]?l.nodeType!=document.TEXT_NODE?l.parentNode.replaceChild(document.createTextNode(o[a]),l):l.nodeValue=o[a]:Freeze.unfreeze(l,o[a])}else e.appendChild(Freeze.deserializeElement(o[a]))}for(;e.childNodes.length-s>o.length;){var u=e.childNodes[o.length+s];u.jsmirrorHide||"webSocketContainer"==u.id?s++:e.removeChild(u)}}else e.parentNode.replaceChild(Freeze.deserializeElement(t),e)},Freeze.deserializeElement=function(e){if("string"==typeof e)return document.createTextNode(e);var t,n,i,r=e[0],o=e[1],s=e[2],a=e[3];if("\x3c!--COMMENT--\x3e"==r)return n=a&&a.length?a[0]:"",(t=document.createComment(n)).jsmirrorId=o,t;t=document.createElement(r);try{for(i in s)s.hasOwnProperty(i)&&t.setAttribute(i,s[i])}catch(e){console.warn("bad attrs",s,JSON.stringify(s))}if(void 0===a)throw console.warn("Bad children",e),"Bad children list";for(i=0;i<a.length;i++){var c=a[i];"string"==typeof c?t.appendChild(document.createTextNode(c)):t.appendChild(Freeze.deserializeElement(c))}return t.jsmirrorId=o,t},Freeze.setAttributes=function(e,t){var n=0;for(var i in t)t.hasOwnProperty(i)&&(n++,"checked"==i&&this.isCheckedElement(e)?e.checked=t[i]:(e.setAttribute(i,t[i]),"value"==i&&(e.value=t[i])));if(e.attributes||(console.trace(),console.log("el.attributes?",e,e.tagName)),e.attributes.length>n){var r=[];for(i=0;i<e.attributes.length;i++)t.hasOwnProperty(e.attributes[i].name)||r.push(e.attributes[i].name);for(i=0;i<r.length;i++)console.debug("removing attr",r[i]),e.removeAttribute(r[i])}},Freeze.setBase=function(e){for(var t=document.getElementsByTagName("base"),n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);var i=document.createElement("base");i.href=e,document.head.appendChild(i)},Freeze._elements={},Freeze.getElement=function(e){return Freeze._elements[e]},Freeze.refreshElements=function(){function r(e,t){e[t.jsmirrorId]=t;for(var n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];i.nodeType===document.ELEMENT_NODE&&r(e,i)}}Freeze._elements={},r(Freeze._elements,document.head),r(Freeze._elements,document.body)},OneClickCbUtils={master:null,appCallBack:null,tabId:null,log:{VERBOSE:10,DEBUG:20,INFO:30,NOTIFY:40,WARN:50,ERROR:50,CRITICAL:60},cleanUpSession:function(){this.master&&this.master.cleanUp(),this.master=null},safeSessionGetItem,safeSessionSetItem,generateId,generateRoom:function(){return text=this.generateId(),this.safeSessionSetItem("room",text),text},getRoom,setMaster:function(e){return this.safeSessionSetItem("cbMaster",e),this.safeSessionGetItem("cbMaster")},getMaster:function(e){return"true"===(this.safeSessionGetItem("cbMaster")||this.setMaster(e))},setSessionParameters:function(e,t,n,i,r,o){e||t||n||i||r||o||OneClickFakeAccounts&&(fakeVisitor=OneClickFakeAccounts.getFakeVisitor(),e=fakeVisitor.name,t=fakeVisitor.role,n=fakeVisitor.viewerId,i=fakeVisitor.sdata,r=fakeVisitor.siteId,o=fakeVisitor.chatId),this.safeSessionSetItem("cbName",e),this.safeSessionSetItem("cbRole",t),this.safeSessionSetItem("cbViewerId",n),this.safeSessionSetItem("cbSdata",i),this.safeSessionSetItem("cbSiteId",r),this.safeSessionSetItem("cbChatId",o)},getSessionParameters,isCobrowseActive,cobrowsingStart:function(e,t,n,i,r,o){this.isCobrowseActive()||(this.setSessionParameters(e,t,n,i,r,o),this.master=new Master(document))},cobrowsingEnd,cobrowseAutoRestart:function(){this.master||(this.master=new Master(document))},allowKeyBoardEvents,getCobrowseLink:function(){return this.master&&this.isCobrowseActive()?displayText=window.location.protocol+"//"+this.safeSessionGetItem("cobrowsingApp")+"/cb_view/"+this.master.room:displayText="cobrowsing is off.",displayText},takeControl:function(){return this.master&&this.master.takeControl()},giveControl,setCallback:function(e){this.appCallBack=e},callBack:function(e,t){this.appCallBack?this.appCallBack(e,t):alert(t)},setCobrowsingServer,cobrowseLog:function(e){var t=this.log.DEBUG;if(e>this.log.WARN&&console.trace&&console.trace(),"undefined"!=typeof console&&!(e<t)){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r="log";if(e>=this.log.ERROR&&console.error?r="error":e>=this.log.INFO&&console.info?r="info":console.debug&&(r="debug"),console[r]||(r="log"),console[r].apply)try{console[r].apply(console,n)}catch(e){console[r].apply(console,["Could not log: "+e])}else console.log(n)}}};var chatjQuery=chatjQuery||livechat.jQuery||jQuery;function adaptCanvas(){try{dw=chatjQuery(window).width(),dh=chatjQuery(window).height(),chatjQuery("#oneclick-canvas-wrapper").width(dw).height(dh),resizeCanvas("#oneclick-annotation-canvas",dw,dh),resizeCanvas("#oneclick-background-canvas",dw,dh)}catch(e){console.log(e)}}function windowWidthHeightListener(){var e=OneClickCbUtils.master;width=chatjQuery(window).width(),height=chatjQuery(window).height(),!e||e.windowTimeout||e.windowWidth==width&&e.windowHeight==height||(adaptCanvas(),e.send({type:"window",body:{window:{w:width,h:height}}}),e.windowWidth=width,e.windowHeight=height,e.windowTimeout=setTimeout(function(){e.windowTimeout=null},1e3))}function resizeCanvas(e,t,n){var i=chatjQuery(e);if(i.length){var r=i[0],o=r.width,s=r.height,a=r.getContext("2d"),c=a.getImageData(0,0,o,s);i.prop({width:t-4,height:n-4}),a.putImageData(c,0,0),a.scale(t/o,n/s)}}function createCanvas(e,t,n){if(window.LIVECHAT_SUPPORT&&(t=1051),!document.getElementById(e))return canvas=document.createElement("canvas"),canvas.id=e,canvas.width=chatjQuery(document).width(),canvas.height=chatjQuery(document).height(),canvas.style.display=n,canvas.style.zIndex=t,canvas.style.position="absolute",canvas.style.top="0px",canvas.style.left="0px",document.body.appendChild(canvas),canvas}function Master(t){this.room=OneClickCbUtils.getRoom(),this.srcId=OneClickCbUtils.generateId(),this.cbMaster=OneClickCbUtils.getMaster(!0),this.helloComplete=!1,session=OneClickCbUtils.getSessionParameters(),this.name=session.name,this.role=session.role,this.viewerId=session.viewerId,this.sdata=session.sdata,this.siteId=session.siteId,this.chatId=session.chatId,this.channel=new SocketIoChannel(this.room,this.role,this.viewerId,this.sdata,this.siteId,this.chatId),this.channel.onmessage=this.processCommand,this.document=t,ELEMENT_NODE=this.document.ELEMENT_NODE,this.elements={},this.mouse={x:0,y:0},this.mouseTimeout=null;var n=this;this.mouseEventListenerCallback=function(e){n.mouseEventListener(e)},Freeze.eventListenerWrapper(t,"mousemove",this.mouseEventListenerCallback,!1),this.scrollTop=this.scrollTopGS(),this.scrollLeft=this.scrollLeftGS(),this.scrollEventListenerCallback,Freeze.eventListenerWrapper(t,"scroll",this.scrollEventListenerCallback,!1),(Freeze.elementTracker=this).sendDocInterval=setInterval(binder(this.sendDoc,this),1e3),this.send({type:"masterHello"}),this.sendMasterHelloTimeout=setInterval(binder(this.sendMasterHello,this),1e3),this.send({type:"href",body:{href:location.href}}),this.send({type:"cursor",body:{cursor:{position:this.mouse,name:this.name}}}),this.scrollEventListener(),windowWidthHeightListener(),this.cbMaster?cbBlock="none":cbBlock="block","complete"==t.readyState?(createCanvas("cb-block-canvas","99990",cbBlock),chatjQuery(window).resize(windowWidthHeightListener)):(Freeze.eventListenerWrapper(window,"load",function(){OneClickCbUtils.isCobrowseActive()&&createCanvas("cb-block-canvas","99990",cbBlock)},!1),chatjQuery(t).ready)),this.displayClickWrapper,Freeze.eventListenerWrapper(t,"click",this.displayClickWrapper,!1),OneClickCbUtils.safeSessionSetItem("1click-cobrowsing","true"),this.currentFaultCount=0,this.maxFaultCount=3,this.faultRecoverTimeOut=null,this.noReflectionElements=[],this.syncHRefCount=0,this.maxSyncHRef=5}Master.prototype={toString,send:function(e){e.master=this.cbMaster,e.srcId=this.srcId,this.channel.send(e)},sendDoc:function(){windowWidthHeightListener(),this.checkDocumentWidthHeight(),this.clearNoReflectionElements();var e=Freeze.serializeDocument(),t={},n=JSON.stringify(e);if(!this.lastSentDoc||this.lastSentDoc!=n)if(this.lastSentDoc){var i=[],r=this.diffDocuments(this.lastSentDocData.head,this.document.head,i);if(null===r?i=null:null===(r=this.diffDocuments(this.lastSentDocData.body,this.document.body,i,!1))&&(i=null),null===i||!i.length&&1!=i.noReflection)OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"Sending complete document",null===i?"fault":"diff failure"),t.type="doc",t.body={doc:e},t.css={sheet:Freeze.getInlineCSS()},this.lastSentDoc=n,this.lastSentDocData=e;else if(i&&i.length){OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"Diffs:");for(var o=0;o<i.length;o++)OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"...diff",this.diffRepr([i[o]]));t.type="diffs",t.body={diffs:i},t.css={sheet:Freeze.getInlineCSS()},this.lastSentDoc=n,this.lastSentDocData=e}else OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"No updates to send/should not happen")}else t.type="doc",t.body={doc:e},t.css={sheet:Freeze.getInlineCSS()},this.lastSentDoc=n,this.lastSentDocData=e;t.body&&(this.send(t),Freeze.cssTextList=[]),this.syncHRefCount+=1,this.syncHRefCount>=this.maxSyncHRef&&(this.syncHRefCount=0,t.type="HrefNow",t.body={HrefNow:location.href},this.send(t))},diffDocuments:function(e,t,n){if("svg"==t.tagName&&(t.isSVG=!0),!t)throw"Got bad current argument: "+t;void 0===n&&(n=[]),t.jsmirrorId||(OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"Got diffDocuments element without an id",t),t.jsmirrorId=Freeze.makeId(t),this.elements[t.jsmirrorId]=t);var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4];if(i!=t.tagName)return OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"got tag name change",i,t.tagName),null;if(Freeze.compareAttributes(o,t)||(currentAttributes=Freeze.serializeAttributes(t),t.noReflection&&(t.critValue?t.critValue===t.value?delete currentAttributes.value:delete t.critValue:delete currentAttributes.value),n.push(["attrs",t.jsmirrorId,currentAttributes])),r!=t.jsmirrorId)return OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"Tag ids don't match",r,t.jsmirrorId,t),null;if(!this.cbMaster&&t.noReflection)return n.noReflection=!0,n;if(void 0!==a&&t.innerHTML==a)return n;var c=Freeze.normalChildren(t),l=c.length,u=s.length;if(1===l&&1===u&&"string"==typeof c[0]&&"string"==typeof s[0])return s[0]!==c[0]&&n.push(["replace_text",t.jsmirrorId,c[0]]),n;for(var h=0,d=0;h<u||d<l;)if("string"!=typeof s[h]||s[h]!==c[d]){var p=this.findNextMatch(s,c,h,d);null===p&&(p=[u,l]);var f=p[0],g=p[1];if(h<f)if(h+1==f&&"string"==typeof s[h])u<=f?n.push(["delete_last_text",t.jsmirrorId]):n.push(["deletetext-",s[h+1][1]]);else for(var m="string"==typeof s[h],v=h;v<f;v++)if("string"!=typeof s[v]){var y="delete";v==h+1&&m&&(y+="-"),v+1<s&&"string"==typeof s[v+1]&&(y+="+"),n.push([y,s[v][1],s[v][4]])}if(d<g){var b=[];for(v=d;v<g;v++)"string"==typeof c[v]?b.push(c[v]):(c[v].jsmirrorId||(c[v].jsmirrorId=Freeze.makeId(c[v]),this.elements[c[v].jsmirrorId]=c[v]),b.push(Freeze.serializeElement(c[v])));c[g]?n.push(["insert_before",c[g],b]):n.push(["append_to",t.jsmirrorId,b])}s[f]&&this.diffDocuments(s[f],c[g],n),d=g+1,h=f+1}else h++,d++;return n},findNextMatch:function(e,t,n,i){if(n>=e.length||i>=t.length)return null;for(;"string"==typeof t[i]||!t[i].jsmirrorId;)if(++i>=t.length)return null;var r=n,o=t[i].jsmirrorId;if(!o)for(;r<e.length;){if("string"!=typeof e[r]&&o==e[r][1])return[r,i];r++}for(;"string"==typeof e[n];)if(++n>=e.length)return null;for(o=e[n][1],r=i;r<t.length;){if("string"!=typeof t[r]&&o==t[r].jsmirrorId)return[n,r];r++}return this.findNextMatch(e,t,n+1,i+1)},processCommand:function(e){var t=OneClickCbUtils.master;if(t&&e.srcId!=t.srcId){"bytearray"==e.datatype?payload=JSON.parse(decodeURIComponent(e.body)):payload=e.body;var n=e.type;"event"==n?t.processEvent(payload.event):"getDoc"==n||"reloadDoc"==n?t.processGetDoc():"getResolution"==n?t.processGetResolution():"change"==n?t.processChange(payload):"contentEditable"==n?t.processContentEditable(payload):"highlight"==n?t.processHighlight(payload.highlight):"cursor"==n?t.processCursor(e.clientId,payload):"scroll"==n?t.processScroll(payload):"elScroll"==n?t.processElScroll(payload.elScroll):"takeControl"==n?t.processTakeControl(e):"giveControl"==n?t.helloComplete?t.becomeMaster(e):OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.INFO,"hello is not complete, so not doing giveControl"):"controlTransferComplete"==n?t.processControlTransferComplete(e):"annotation"==n?t.processAnnotation(payload):"bye"==n?t.processBye(e):"cbStop"==n?t.processCbStop():"helloComplete"==n?t.helloComplete=!0:console.log("missed msgs",e)}},triggerMostButtons:function(e,t){!e||"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName||this.triggerMouseEvent(e,"focus"),this.triggerMouseEvent(e,"mouseover"),this.triggerMouseEvent(e,"mousedown"),this.triggerMouseEvent(e,"mouseup"),this.dispatchEvent(t,e),Freeze.isCheckedElement(e)&&this.triggerMouseEvent(e,"blur")},triggerMouseEvent:function(e,t){var n=document.createEvent("MouseEvents");n.initEvent(t,!0,!0),this.dispatchEvent(n,e)},processEvent:function(e){var t=this.deserializeEvent(e);if("MouseEvent"==t.module&&"click"==t.type){var n=e.target||e.srcElement;this.triggerMostButtons(n,t),n.getAttribute("href")&&n.getAttribute("href").startsWith("#")&&setTimeout(this.scrollEventListener(),200)}else{if("keypress"==t.type){e.type="keydown";var i=this.deserializeEvent(e);this.dispatchEvent(i,e.target)}if(this.dispatchEvent(t,e.target),"keypress"==t.type){e.type="keyup";var r=this.deserializeEvent(e);this.dispatchEvent(r,e.target)}}},serializeEvent:function(e){var t={};for(var n in e){var i=e[n];if((n.toUpperCase()!=n||"number"!=typeof i)&&"function"!=typeof i&&i!==window){if(i&&"object"==typeof i)try{var r=i.jsmirrorId;if(!r)continue;i={jsmirrorId:r}}catch(e){OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"could not get jsmirrorId",i,n,e);continue}t[n]=i}}t.cancelable=e.cancelable,t.canBubble=e.canBubble;var o=e+"";return o=o.substr(o.indexOf(" ")+1,o.length-o.indexOf(" ")-2),t.module=o,t},deserializeEvent:function(e){var t;"PointerEvent"==e.module&&(e.module="MouseEvent");var n=this.document.createEvent(e.module);for(var i in e)if(e.hasOwnProperty(i)){if((t=e[i])&&"object"==typeof t&&t.jsmirrorId){var r=this.getElement(t.jsmirrorId)||null;r||OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"Could not find element",t.jsmirrorId),t=r}e[i]=t}for(i in this.initEvent(n,e,e.module),e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n},initEvent:function(e,t,n){if(n in this.eventAliases&&(n=this.eventAliases[n]),"UIEvents"===n)e.initUIEvent(t.type,t.canBubble||!0,t.cancelable||!0,t.view||window,t.detail);else if("MouseEvents"==n)OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.INFO,{type:t.type,canBubble:t.canBubble||!0,cancelable:t.cancelable||!0,view:this.document.defaultView,detail:void 0===t.detail?1:this.detail,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,button:t.button,relatedTraget:t.relatedTarget||null}),e.initMouseEvent(t.type,t.canBubble||!0,t.cancelable||!0,this.document.defaultView,1,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget||null);else if("HTMLEvents"==n)e.initEvent(t.type,t.canBubble||!0,t.cancelable||!0);else if("KeyboardEvent"==n){e[e.initKeyboardEvent?"initKeyboardEvent":"initKeyEvent"](t.type,t.canBubble||!0,t.cancelable||!0,t.view||window,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.keyCode,t.charCode)}},eventAliases:{UIEvent:"UIEvents",KeyEvents:"KeyboardEvent",Event:"HTMLEvents",Events:"HTMLEvents",MouseScrollEvents:"MouseEvents",MouseEvent:"MouseEvents",HTMLEvent:"HTMLEvents",PopupEvents:"MouseEvents"},dispatchEvent:function(e,t){if(OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.INFO,"Dispatching internal event",e.type,e,t),Freeze.isCheckedElement(t)&&(e.doNotTrack=!0),t&&!t.dispatchEvent&&(OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"huh",e,t,t===window),t=window),t){var n=t.dispatchEvent(e);OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"should do default",n,e.type,t.tagName,t.href),n&&t["on"+e.type]&&t["on"+e.type](e),n&&"click"==e.type&&this.doDefaultAction(e,t)}else this.document.dispatchEvent(e)},doDefaultAction:function(e,t){if("A"!==t.tagName)(t=t.parentNode)&&this.doDefaultAction(e,t);else if(t.href){var n=t.href,i="";-1!=n.indexOf("#")&&(i=n.substr(n.indexOf("#"),n.length),n=n.substr(0,n.indexOf("#")));var r=location.href;if(-1!=r.indexOf("#")&&(r=r.substr(0,r.indexOf("#"))),n===r||-1!=t.target.indexOf("_blank"))return location.hash=i,void this.send({type:"baseHash",body:{baseHash:i,href:location.href}});location.href=t.href}},setNoReflection:function(e){-1===this.noReflectionElements.indexOf(e)&&(e.noReflection=!0,this.noReflectionElements.push(e))},processChange:function(e){var t=this.getElement(e.target);this.setNoReflection(t),t.value=e.value,t.critValue=e.value;var n=this.document.createEvent("UIEvent");n.initUIEvent("change",!0,!0,window,{});var i=t.dispatchEvent(n);i&&t.onchange&&t.onchange(n),(n=this.document.createEvent("KeyboardEvent"))[n.initKeyboardEvent?"initKeyboardEvent":"initKeyEvent"]("keyup",!0,!0,window,!1,!1,!1,!1,0,0),(i=t.dispatchEvent(n))&&t.onkeyup&&t.onkeyup(n)},processContentEditable:function(e){var t=this.getElement(e.target);t&&(t.innerHTML=e.value,this.setNoReflection(t))},processHighlight:function(e){var t=this.getElement(e.target);t&&this.temporaryHighlight(t,e.offsetTop,e.offsetLeft,e.mode||"remote")},processCursor:function(e,t){var n,i;if(e){i="oneclick-client-cursor"+e,cursorIdName=i+"-name",n=t.cursor.name||"",cursorIdImg=i+"-image";var r=document.getElementById(i),o=t.cursor.position;if(null===r){var s=this.appendHTML('<div class="lcb-cursor-pointer" id="'+i+'" style="z-index:99999;top:'+o.y+"px;left:"+o.x+'px;position:absolute;"><div class="lcb-cursor-image"><img class="lcb-cursor-img" id="'+cursorIdImg+'"  src="" alt/></div><div class="lcb-cursor-name" id="'+cursorIdName+'">'+n+"</div></div></div>");null!==document.body&&(document.body.appendChild(s),window.livechat&&window.livechat.Chat&&livechat.Chat.setAgentCursorPictureCobrowsing())}else chatjQuery("#"+cursorIdName).text(" "+n+" "),r.style.top=o.y+"px",r.style.left=o.x-22+"px"}},appendHTML,processScroll:function(e){this.scrollTopGS(e.scroll.position.t),this.scrollLeftGS(e.scroll.position.l)},processElScroll:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=this.getElement(t);n&&(n.scrollTop=e[t].top,n.scrollLeft=e[t].left)}},processControlTransferComplete:function(e){e.dstId==this.srcId&&OneClickCbUtils.callBack("info","control transfer complete")},processAnnotation:function(e){if(canvas=document.getElementById("oneclick-annotation-canvas"),canvas){var t=e.data;"start"===t?this.canvasChange("block"):"end"===t?this.canvasChange("none"):"clear"===t?this.canvasClear(e,canvas):"wb-on"===t?chatjQuery("#oneclick-canvas-wrapper").css({opacity:1}):"wb-off"===t?chatjQuery("#oneclick-canvas-wrapper").css({opacity:.01}):this.canvasDraw(e)}},canvasChange:function(e){chatjQuery("#oneclick-canvas-wrapper").css({display:e,opacity:.01}),chatjQuery("#oneclick-annotation-canvas").css({display:e}),chatjQuery("#oneclick-background-canvas").css({display:e}),chatjQuery("#oneclick-annotation-toolbar").css({display:e})},canvasClear:function(e,t){var n=chatjQuery("oneclick-background-canvas");if(n.length){n[0].getContext("2d");bgCanvasContext.clearRect(0,0,t.width,t.height)}e.admin&&t.getContext("2d").clearRect(0,0,t.width,t.height)},canvasDraw:function(e){"none"==document.getElementById("oneclick-canvas-wrapper").style.display&&this.canvasChange("block");var t=chatjQuery("oneclick-background-canvas");if(t.length){t[0].getContext("2d");if(e.context){var n=e.context.split(":");bgCanvasContext.lineWidth=n[0],bgCanvasContext.strokeStyle=n[1]}bgCanvasContext.beginPath();var i=e.data.split(","),r=i[0].split("#");bgCanvasContext.moveTo(r[0],r[1]);for(var o=1;o<i.length;o++){var s=i[o].split("#");bgCanvasContext.lineTo(s[0],s[1]),bgCanvasContext.stroke()}}},processBye:function(e){var t=e.clientId;t&&(cursorId="#oneclick-client-cursor"+t,chatjQuery(cursorId).remove())},doFaultRecovery:function(){this.faultRecoverTimeOut||(this.currentFaultCount+=1,this.currentFaultCount>=this.maxFaultCount&&this.sendDocWithTimeout())},processGetDoc,sendDocWithTimeout:function(){var e=Freeze.serializeDocument(),t=JSON.stringify(e);this.lastSentDoc=t,this.lastSentDocData=e;var n={type:"doc"};n.body={doc:e},n.css={sheet:Freeze.getInlineCSS()},Freeze.cssTextList=[],this.send(n);var i=this;this.faultRecoverTimeOut=setTimeout,15e3)},processGetResolution:function(){this.windowWidth=this.windowHeight=null,windowWidthHeightListener()},getElement:function(e){return e&&"object"==typeof e&&e.jsmirrorId&&(e=e.jsmirrorId),this.elements[e]||(this.doFaultRecovery(),console.warn("Could not find element",e)),this.elements[e]||null},processCbStop,CbStop:function(){msg={type:"cbStop"},this.channel.send(msg),this.cleanUp()},mouseEventListener:function(e){var t=this,n=(e.clientX||e.pageX)+this.scrollLeftGS(),i=(e.clientY||e.pageY)+this.scrollTopGS();t.mouse.x==n&&t.mouse.y==i||(t.mouse.x=n,t.mouse.y=i,null===t.mouseTimeout&&(t.mouseTimeout=setTimeout(function(){t.mouseTimeout=null,t.send({type:"cursor",body:{cursor:{position:t.mouse,name:t.name}}})},250)))},scrollTopGS:function(t){if(void 0===t){try{t=this.document.documentElement.scrollTop||this.document.body.scrollTop}catch(e){t=0}return t}if(this.document.documentElement)try{this.document.documentElement.scrollTop=t}catch(e){}if(this.document.body)try{this.document.body.scrollTop=t}catch(e){}},scrollLeftGS:function(t){if(void 0===t){try{t=this.document.documentElement.scrollLeft||this.document.body.scrollLeft}catch(e){t=0}return t}if(this.document.documentElement)try{this.document.documentElement.scrollLeft=t}catch(e){}if(this.document.body)try{this.document.body.scrollLeft=t}catch(e){}},scrollEventListener:function(){this.scrollTop=this.scrollTopGS(),this.scrollLeft=this.scrollLeftGS(),this.send({type:"scroll",body:{scroll:{position:{t:this.scrollTop,l:this.scrollLeft}}}})},checkDocumentWidthHeight:function(){try{dw=chatjQuery(document).width(),dh=chatjQuery(document).height(),this.dw==dw&&this.dh==dh||(this.dw=dw,this.dh=dh,resizeCanvas("#cb-block-canvas",dw,dh))}catch(e){console.log(e)}},clearNoReflectionElements:function(){if(this.cbMaster){for(i=0;i<this.noReflectionElements.length;i++)el=this.noReflectionElements[i],delete el.noReflection,el.isContentEditable&&el.jsmirrorId&&(el.jsmirrorId=Freeze.makeId(el),this.elements[el.jsmirrorId]=el);this.noReflectionElements=[]}},setMasterParams:function(){this.cbMaster=!0,OneClickCbUtils.setMaster(!0),this.scrollEventListener(),chatjQuery("#cb-block-canvas").hide()},processTakeControl:function(e){console.log("processTabControl",e),"agent"==e.role?this.becomeFollower():"visitor"==e.role?0==this.cbMaster&&(this.setMasterParams(),OneClickCbUtils.callBack("info","Agent has given the control to you.")):console.error("unexpected role for takeControl",e)},becomeFollower:function(){this.cbMaster&&(this.cbMaster=!1,OneClickCbUtils.setMaster(!1),chatjQuery("#cb-block-canvas").show(),OneClickCbUtils.callBack("info","Agent has taken the control back."))},takeControl:function(){return this.setMasterParams(),msg={type:"takeControl"},msg.master=this.cbMaster,msg.role="visitor",this.channel.send(msg),!0},becomeMaster:function(e){this.setMasterParams(),msg={type:"controlTransferComplete"},msg.master=this.cbMaster,msg.srcId=this.srcId,msg.dstId=e.srcId,this.channel.send(msg),OneClickCbUtils.callBack("info","Agent has given the control to you.")},giveControl:function(){return!!this.cbMaster&&(msg={type:"giveControl"},msg.master=this.cbMaster,msg.srcId=this.srcId,this.channel.send(msg),this.cbMaster=!1,OneClickCbUtils.setMaster(!1),chatjQuery("#cb-block-canvas").show(),!0)},sendMasterHello:function(){!this.helloComplete&&OneClickCbUtils.isCobrowseActive()?this.send({type:"masterHello"}):clearInterval(this.sendMasterHelloTimeout)},getClickPosition:function(e){var t=0,n=0;return((e=e||window.event).clientX||e.clientY)&&document.body&&null!=document.body.scrollLeft&&(t=e.clientX+document.body.scrollLeft,n=e.clientY+document.body.scrollTop),(e.clientX||e.clientY)&&"CSS1Compat"==document.compatMode&&document.documentElement&&null!=document.documentElement.scrollLeft&&(t=e.clientX+document.documentElement.scrollLeft,n=e.clientY+document.documentElement.scrollTop),(e.pageX||e.pageY)&&(t=e.pageX,n=e.pageY),{clickX:t,clickY:n}},cloneClick:function(){return templateClick=chatjQuery("#oneclick-template-cursor"),templateClick.length||(templateClick=chatjQuery("<div/>",{id:"oneclick-template-cursor"}).addClass("lc-cb-touch-bg-vi").appendTo("body").hide()),templateClone=templateClick.clone(),templateClone.attr("id",null),templateClone},displayClick:function(e){var t=e.target||e.srcElement;if(!e.doNotTrack){if(t){if("cb-block-canvas"==t.id)return;if(Freeze.isCheckedElement(t)){var n=this.serializeEvent(event);this.send({type:"event",body:{event:n}})}}var i=this.getClickPosition(e),r=this.cloneClick();chatjQuery(document.body).append(r),r.css({top:i.clickY,left:i.clickX,borderColor:"red",display:"block"}),setTimeout(function(){r.addClass("freshdesk-hover")},400),setTimeout(function(){r.remove()},2e3)}},deleteMirrorIds:function(e){for(var t in e)e.hasOwnProperty(t)&&(el=e[t],el.jsmirrorId&&delete el.jsmirrorId)},diffRepr:function(t){for(var e="",n=0;n<t.length;n++){e&&(e+="\n");var i=t[n][0],r=t[n][1];if(window.OneClickCbUtils.master||window.mirror)try{var o=(window.OneClickCbUtils.master||window.mirror).getElement(r);o&&(r=o.tagName+":"+r)}catch(e){console.log(t);continue}"attrs"===i?e+="attrs("+r+")="+this.keys(t[n][2],!0).join(","):"delete"==i.substr(0,6)?e+=i+"("+r+")":(e+=i+"("+r+")="+t[n][2].length+"/"+parseInt(JSON.stringify(t[n][2]).length,10),e+="\n    "+JSON.stringify(t[n][2]))}return e},keys:function(e,t){var n=[];for(var i in e)n.push(i);return t&&n.sort(),n},cleanUp:function(){try{clearInterval(this.sendDocInterval),Freeze.removeEventListener(document,"mousemove",this.mouseEventListenerCallback,!1),Freeze.removeEventListener(document,"scroll",this.scrollEventListenerCallback,!1),Freeze.removeEventListener(document,"click",this.displayClickWrapper,!1),chatjQuery(window).off("resize",windowWidthHeightListener),msg={type:"cobrowseEnd"},this.send(msg),chatjQuery("div").filter).remove(),chatjQuery("#cb-block-canvas").hide(),Freeze.elementTracker=null,this.deleteMirrorIds(this.elements),Freeze.makeId.counter=1e3,OneClickCbUtils.safeSessionSetItem("1click-cobrowsing","false"),OneClickCbUtils.setMaster(!0);var e=this;setTimeout(function(){e.channel.close()},1e3)}catch(e){console.error(e)}}},OneClickCbUtils.isCobrowseActive()&&OneClickCbUtils.cobrowseAutoRestart(),function(){var e,t;e=window.livechat,t=function(){function e(e,t){this.name=e,this.label=t.title,this.options=t.options,this.setVisibility(t.show),this.setValidator(e),this.value=null}return e.prototype.getValue,e.prototype.setVisibility=function(e){this.visibility=e,this.visibility&&"string"==typeof this.visibility&&(this.visibility=parseInt(this.visibility,10)),this.visibility||(this.visibility=0)},e.prototype.isRequired=function(){return 2===this.visibility},e.prototype.isNotRequired=function(){return 2!==this.visibility},e.prototype.isShown=function(){return 1===this.visibility},e.prototype.isHidden,e.prototype.isValid=function(e){var t;return t=e||this.value,this.validator(t)},e.prototype.setValidator=function(e){switch(e){case"name":this.validator=function(){return this.isNotRequired()&&!this.value||this.value&&this.value.length<=100};break;case"email":this.validator=function(){var e;return e=/^([a-zA-Z0-9_\'\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,this.isNotRequired()&&!this.value||this.value&&e.test(this.value)};break;case"phone":this.validator=function(){return this.isNotRequired()&&!this.value||this.value&&this.value.match(/^[0-9\-\(\)\s+]+$/)};break;case"textfield":this.validator=function(){return this.isNotRequired()&&!this.value||this.value&&0<this.value.length};break;case"textarea":this.name="textarea",this.validator=function(e){return this.isNotRequired()&&!this.value||this.value&&0<this.value.length};break;case"dropdown":this.validator=function(e){return this.isNotRequired()&&"-1"===this.value||this.value&&"-1"!==this.value};break;default:this.validator=function(){return!1}}},e}(),e.Field=t}.call(this),window.livechat=window.livechat||{},window.livechat.templates=window.livechat.templates||{},livechat.templates.chat='<div id="lc_chat_layout" class="lc-collapsed lc-prechat lc-support-widget <%= widgetPosition %>"><div id="lc_chat_header" class="<%= widgetColors.classes%> lc-header-bg"><img id="lc_agent_profile_pic" src="" class="lc-profile-pic"/><span id="lc_chat_title"><%= widgetTitle %></span><span id="lc-close" class="lc-close" title="Close"><i>&plus;</i></span><span id="lc_minimize" class="lc-minimize" title="Minimize"><i>&minus;</i></span></div><div id="lc_chat_container"><div id="lc_chat_window" class="lc-chat-window"><div class="overlay-bg"><div class="loader-desc"><%= loaderMessage %>...</div><div class="sloader"></div></div><div id="lc_chat_message_window"></div><div id="lc_chat_notification_window"></div><textarea id="lc_chat_input_container" tabindex="-1" placeholder="<%= messageBoxPlaceholder%>"></textarea><button id="lc_button_send" title="send"></button></div></div><div class="lc-end-chat hide"><p> </p><div class="lc-ec-choices"><button id="lc-ec-cancel" class="lc-ec-yes lc-ec-cancel"></button><button id="lc-ec-ok" class="lc-ec-no lc-ec-ok"></button></div></div></div><ul id="lc_cb_actions_vi" class="lc-cb-actions-vi"><li><div class="lc-cb-profile-vi"><img title="Username"/></div><div class="lc-cb-profile-info-vi"><div class="lc-cb-control-mode-vi"><p><%=livechat.defaultMessages.cb_viewing_screen_vi%></p><span class="lc-cb-give-control-vi" title="Give Control"><%=livechat.defaultMessages.cb_give_control_vi%></span></div><div class="lc-cb-view-mode-vi"><p><%=livechat.defaultMessages.cb_controlling_screen_vi%></p><p class="subtext"><%=livechat.defaultMessages.cb_view_mode_subtext%></p></div></div><div class="lc-cb-session-request-vi"><p> <%=livechat.defaultMessages.cb_visitor_session_request%></p><button id="deny_cb_session_vi" class="lc-cb-session-deny-vi" >Deny</button><button id="allow_cb_session_vi" class="lc-cb-session-allow-vi">Allow</button></div><div class="lc-cb-notification-vi"><p><%=livechat.defaultMessages.cobrowsing_agent_request_control%> </p><button id="deny_cb_vi" class="lc-cb-button-deny-vi" >Deny</button><button id="allow_cb_vi" class="lc-cb-button-allow-vi">Allow</button></div></li><li class="lc-cb-stop-vi" title="Stop Screen Sharing"><i class="lcb-cross">+</i><span><%=livechat.defaultMessages.cobrowsing_stop_request%></span></li></ul>',livechat.templates.message='<p class="<%=message.class%>"><span class="lc-msg-block"><span class="lc-msg"><% if(message.type === \'typing\'){ %><span class=\'lc-typing-dots\'><span></span><span></span><span></span></span><% }else{%><%=message.content%></span><% if(message.time) {%><span class="lc-time"><%=message.time%></span><% } %><% } %><% if(message.chatId ) {%><span id="<%=message.id%>" createdAt= "<%= new Date(message.createdAt) %>" actualCreatedAt= "<%= message.actualCreatedAt %>" actualReceivedAt= "<%=message.actualReceivedAt %>" style="display: none;"></span><% } %></span></p>',livechat.templates.notification='<p id="<%= notification.id%>" class="<%= notification.class%>" ><%= notification.content %></p>',livechat.templates.offline='<div id="lc_offline_chat_form" class="lc-offline-form"><p><%= nonAvailabilityMessage %></p><ul class="lc-form-field-wrap"><%livechat._.each(fields, function(field){ %><li class="lc-textfield-wrap"><label for="lc_chat_offline_<%=field.name%>" class="lc-chat-required"><%= field.label%><span> *</span></label><% if(field.name == "textarea"){ %><textarea type="text" id="lc_chat_offline_textarea"><%if(msg){ %><%= msg %> <% } %></textarea><% }else{ %><input type="text" maxlength="50" id="lc_chat_offline_<%=field.name%>" value="<%=field.getValue()%>"><% } %></li><% })%></ul><div id="lc_button_holder" class="lc-button-holder"><button id="lc_offline_submit"  class="lc-button-submit"></button></div></div>',livechat.templates.prechat='<div id="lc_prechat_form" class="lc-pre-form"><p><%= preChatMessage %></p><ul class="lc-form-field-wrap"><%livechat._.each(fields, function(field){ %><% if(!field.isHidden()) { %><li class="lc-textfield-wrap"><% if(field.isRequired()) { %><label for="lc_chat_<%=field.name%>" class="lc-chat-required"><%=field.label%><span> *</span></label><% }else{ %><label for="lc_chat_<%=field.name%>"><%=field.label%></label><% } %><% if(field.name == "dropdown") { %><div class="lc-select"><span><%= (field.getValue() || "...") %></span><select id="lc_chat_<%=field.name%>" ><option <%= (field.getValue() ? "" : "selected" )%> value="-1" >...</option><%livechat._.each(field.options, function(option) { %><option <%= ((field.getValue() === option) ? "selected" : "") %> value="<%= option%>" ><%= option%></option><% })%></select></div><% } else{ if (field.name == "name" || field.name == "textfield"){ %><input type="text" maxlength="100" id="lc_chat_<%=field.name%>" value="<%=field.getValue()%>"><% } else { %><input type="text" maxlength="50" id="lc_chat_<%=field.name%>" value="<%=field.getValue()%>"><% } } %></li><% } %><% });%></ul><div id="lc_button_holder" class="lc-button-holder"><button id="lc_prechat_submit" class="lc-button-submit"></button></div></div>',function(){var r,n,e,i;r=window.livechat,n=r.Constants,r.Browser,r.jQuery,i=r._,e=function(){function e(){this.id=null,this.name=null,this.email=null,this.phone=null,this.textfield=null,this.dropdown=null,this.chatId=null,this.blocked=!1,this.session=null,this.visitCount=0,this.recentChatId=null,this.autoConnectTimer=null,this.forceDisconnectTimer=null}return e.prototype.initialize=function(){this.chat=r.Chat,this.chatView=r.ChatView,this.widget=r.Widget,this.migrateOldCookies(),this.id=this.getId(),!window.LIVECHAT_SUPPORT&&this.id||this.initizlizeId(),this.hasValues(window.FRESHCHAT_VISITORINFO)?this.setVisitorProperties(window.FRESHCHAT_VISITORINFO):(this.setName(r.Cache.getItem("livechat_vname")),this.setEmail(r.Cache.getItem("livechat_vemail")),this.setPhone(r.Cache.getItem("livechat_vphone")),this.setTextfield(r.Cache.getItem("livechat_vtextfield")),this.setDropdown(r.Cache.getItem("livechat_vdropdown")),this.visitCount=r.Cache.getItem("livechat_vcount")),this.setSession()},e.prototype.initizlizeId,e.prototype.getId=function(){return this.id||r.Cache.getItem("livechat_vid")},e.prototype.getName=function(){return this.name||r.Cache.getItem("livechat_vname")},e.prototype.getEmail=function(){return this.email||r.Cache.getItem("livechat_vemail")},e.prototype.getPhone=function(){return this.phone||r.Cache.getItem("livechat_vphone")},e.prototype.getTextfield=function(){return this.textfield||r.Cache.getItem("livechat_vtextfield")},e.prototype.getDropdown=function(){var e;return(e=r.Cache.getItem("livechat_vdropdown"))&&"-1"===e&&(e=null),e},e.prototype.getSupportDropdown=function(){var e;return this.widget.preChatFields.dropdown&&(e="active"===SUBSCRIPTION_STATE?this.widget.preChatFields.dropdown.options[1]:this.widget.preChatFields.dropdown.options[0]),e},e.prototype.getVisitCount=function(){return this.visitCount||r.Cache.getItem("livechat_vcount")},e.prototype.getDiconnectedFlag=function(){return r.Cache.getItem("livechat_vdisconnected")},e.prototype.setId=function(e){e&&r.Cache.setItem("livechat_vid",this.id=e)},e.prototype.setName=function(e){e&&r.Cache.setItem("livechat_vname",this.name=e)},e.prototype.setEmail=function(e){/^([a-zA-Z0-9_;\&\#\'\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)&&r.Cache.setItem("livechat_vemail",this.email=e)},e.prototype.setPhone=function(e){e&&/^[0-9\-\(\)\s+]+$/.test(e)&&r.Cache.setItem("livechat_vphone",this.phone=e)},e.prototype.setTextfield=function(e){e?r.Cache.setItem("livechat_vtextfield",this.textfield=e):r.Cache.removeItem("livechat_vtextfield")},e.prototype.setDropdown=function(e){e&&-1!==e&&"-1"!==e?r.Cache.setItem("livechat_vdropdown",this.dropdown=e):r.Cache.removeItem("livechat_vdropdown")},e.prototype.incrementVisitCount=function(){++this.visitCount,r.Cache.setItem("livechat_vcount",""+this.visitCount)},e.prototype.setDisconnectedFlag=function(){return r.Cache.setItem("livechat_vdisconnected",(new Date).toString())},e.prototype.removeDisconnectedFlag,e.prototype.generateVisitorId=function(){return"visitor"+(window.LIVECHAT_SUPPORT&&CURRENT_USER.id&&CURRENT_ACCOUNT.id?CURRENT_ACCOUNT.id+"x"+CURRENT_USER.id:Math.round(Math.random()*(new Date).getTime()))},e.prototype.setVisitorProperties=function(e){var t;for(t in(e=i.omit(e,["created_at","updated_at"])).textfield=e.custom_field1,e.dropdown=e.custom_field2,delete e.custom_field1,delete e.custom_field2,e)new Function("self","return self.set"+t.replace(/\w\S*/g))(this)(e[t])},e.prototype.hasValues=function(e){return 0<(e?i.compact(i.values(e)):"").length},e.prototype.clearDetails=function(){this.id=null,this.name=null,this.email=null,this.phone=null,this.textfield=null,this.dropdown=null,this.visitCount=null,this.chatId=null,this.blocked=!1,this.session=null,r.Cache.removeItem("livechat_vid"),r.Cache.removeItem("livechat_vname"),r.Cache.removeItem("livechat_vemail"),r.Cache.removeItem("livechat_vphone"),r.Cache.removeItem("livechat_vtextfield"),r.Cache.removeItem("livechat_vdropdown"),r.Cache.removeItem("livechat_vcount"),this.initizlizeId()},e.prototype.migrateOldCookies=function(){var e,t,n,i;for(i in t={fc_vid:"livechat_vid",fc_vname:"livechat_vname",fc_vmail:"livechat_vemail",fc_vphone:"livechat_vphone",fc_vtextfield:"livechat_vtextfield",fc_vdropdown:"livechat_vdropdown",fc_vcount:"livechat_vcount",fc_agent:"livechat_agent_name"})n=t[i],(e=r.Cookies.getCookie(i))&&r.Cache.setItem(n,e)},e.prototype.setSession=function(){var e,n;(e=r.Cache.getItem("livechat_session"))?this.session=JSON.parse(e):(this.session={},r.Location.fetch((n=this,function(e){n.session.location=e,r.Browser.detect(function(e){var t;n.session.browser=e,(t={}).is_tablet=!!navigator.userAgent.match(/(iPad|SCH-I800|xoom|kindle)/i),t.is_phone=!t.is_tablet&&!!navigator.userAgent.match(/(iPhone|iPod|blackberry|android 0.5|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i),t.is_mobile=t.is_tablet||t.is_phone,n.session.device=t,n.session.locale=n.getLocale(),n.session.visitedPage=encodeURI(window.location.href),n.session.referer=document.referrer,r.Cache.setItem("livechat_session",r.JSON3.stringify(n.session))})})))},e.prototype.getLocale=function(){var e,t;return 2===(e=((t=window.navigator).language||t.browserLanguage||t.systemLanguage||t.userLanguage||"").split("-")).length?{language:e[0].toLowerCase(),country:e[1].toLowerCase()}:e?{language:e[0].toLowerCase(),country:null}:{language:null,country:null}},e.prototype.startAutoConnectTimer=function(){this.autoConnectTimer=setTimeout(function(){r.client.connect()},n.TIME.AUTO_CONNECT)},e.prototype.stopAutoConnectTimer=function(){clearTimeout(this.autoConnectTimer),this.autoConnectTimer=null},e.prototype.startForceDisconnectTimer=function(e){var t;this.forceDisconnectTimer=setTimeout((t=this,function(){t.chat.isActive()?t.startForceDisconnectTimer(n.TIME.CHECK_CHAT):r.client.isConnected()&&(t.stopForceDisconnectTimer(),r.client.primary.pushToVisitorTabs("force disconnect",{force_disconnect:!0}))}),e)},e.prototype.stopForceDisconnectTimer=function(){clearTimeout(this.forceDisconnectTimer),this.forceDisconnectTimer=null},e.prototype.connectionRequest=function(){var e;(e=this.chatView.getVisitorDetails()).widget_id=this.widget.id,e.recentChatId=this.recentChatId,e.current_session=this.session,e.isReturningVisitor=0<this.visitCount,e.visitorLimitReached=this.widget.visitorLimitReached,r.client.pushToServer("connection request",e)},e.prototype.block=function(e){this.blocked=!0,r.client.primary.pushToVisitorTabs("force disconnect",{force_disconnect:!0})},e.prototype.unblock=function(){this.blocked=!1},e.prototype.isReturnVisitor=function(){var e;return r.client?r.client.primary.isInReturningVisitorChannel():null!=(e=r.Cache.getItem("livechat_vcount"))?e:{true:!1}},e.prototype.resetVisitor=function(){this.stopAutoConnectTimer(),r.Visitor=new e},e}(),r.Visitor=new e}.call(this),function(){var l,u,e,a,c=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(l=window.livechat).Constants,u=l.jQuery,a=l._,e=function(){function e(){this.name=null,this.id=null,this.name=null,this.show=!1,this.active=!1,this.debug=null,this.nodeUrl=null,this.siteId=null,this.siteUrl=null,this.teamstatus=!1,this.environment=null,this.windowPosition=null,this.windowOffset=null,this.windowColor=null,this.proactiveChat=null,this.proactiveTime=null,this.title=null,this.welcomeMessage=null,this.messageBoxPlaceholder=null,this.waitingMessage=null,this.moreWaitingMessage=null,this.trasferredMessage=null,this.thanksMessage=null,this.loaderMessage=null,this.nonAvailabilityMessage=null,this.nonAvailabilityLinkUrl=null,this.nonAvailabilityCustomLink=null,this.preChatForm=!1,this.preChatMessage=null,this.businessCalendar=null,this.offlineChat=!1,this.offlineChatSettings=null,this.hideWidget=!1,this.assetUrlPrefix=null,this.sessionHash=null,this.preChatFields=null,this.offlineChatFields=null,this.soundEnabled=!0,this.helpdeskName=null,this.visitorLimitReached=!1}return e.prototype.initialize=function(){var e;try{e=u.parseJSON(l.Base64.decode(window.livechat_setting||window.livechatSettings||window.freshchat_setting))}catch(e){return void console.log("Error in parsing widget setting")}this.id=e.widget_id,this.name=e.name,this.siteId=e.fc_id,this.siteUrl=e.weburl,this.environment=e.environment,this.debug=e.debug,this.initializeNodeUrl(e.nodeurl)},e.prototype.initializeNodeUrl=function(e){var t,n,i,r;e=e.replace("https://","").replace(":443",""),"development"===this.environment?(this.nodeUrl="http://"+e+":4000",this.photosUrl="http://"+this.siteUrl+":3000"):"staging"===this.environment?(this.nodeUrl="https:"===(null!=(t=window.location)?t.protocol:void 0)?"https://"+e+":443":"http://"+e+":80",this.photosUrl="https:"===(null!=(n=window.location)?n.protocol:void 0)?"https://"+this.siteUrl+":443":"http://"+this.siteUrl+":80"):(this.nodeUrl="http:"===(null!=(i=window.location)?i.protocol:void 0)&&this.isLegacyIEVersion?"http://"+e+":80":"https://"+e+":443",this.photosUrl="http:"===(null!=(r=window.location)?r.protocol:void 0)&&this.isLegacyIEVersion?"http://"+this.siteUrl+":80":"https://"+this.siteUrl+":443")},e.prototype.isLegacyIEVersion=function(){var e,t;return-1!==(e=navigator.userAgent.toLowerCase()).indexOf("msie")&&(8===(t=parseInt(e.split("msie")[1]))||9===t)},e.prototype.isInBusinessHours=function(){return!this.businessCalendar||l.BusinessHours.isBusinessHour(this.businessCalendar)},e.prototype.updateSettings=function(e,t){var n,i,r;try{n=u.parseJSON(l.Base64.decode(window.livechat_setting||window.livechatSettings||window.freshchat_setting)),r=u.parseJSON(e.widget_preferences)}catch(e){return void console.log("Error in parsing the widget livechat_setting")}i=e.defaultMessages,this.id=this.id||e.id||e.widget_id,this.name=this.name||e.name,this.siteId=this.siteId||e.site_id,this.active=e.active||!1,this.teamstatus=t,this.windowColor=r.window_color||i.widget_preferences.window_color,this.windowOffset=r.window_offset||i.widget_preferences.window_offset,this.me=n.me?n.me:"Me",this.proactiveTime=e.proactive_time,this.proactiveChat=e.proactive_chat,this.businessCalendar=e.business_calendar,this.windowPosition=r.window_position||i.widget_preferences.window_position,this.title=r.header||i.widget_preferences.header,this.messageBoxPlaceholder=r.text_place||i.widget_preferences.text_place,this.welcomeMessage=r.welcome_message||i.widget_preferences.welcome_message,this.moreWaitingMessage=r.wait_message||i.widget_preferences.wait_message,this.thanksMessage=r.thank_message||i.widget_preferences.thank_message,this.loaderMessage=i.widget_preferences.loader_message,this.endChatConfirmMessage=r.end_chat_confirm_msg||i.widget_preferences.end_chat_confirm_msg,this.agentNetworkDisconnectMessage=r.agent_network_disconnect_msg||i.widget_preferences.agent_network_disconnect_msg,this.preChatForm=e.prechat_form||!1,this.preChatMessage=e.prechat_message||i.prechat_message,this.sessionHash=e.sessionHash,this.helpdeskName=n.helpdeskname,OneClickCbUtils.setCobrowsingServer(e.cobrowsingSocketServer,e.cobrowsingRailsApp),this.assetUrlPrefix="development"===this.environment?this.nodeUrl:e.cloudfront,l.Sound.initialize(),l.defaultMessages=e.cbDefaultMessages,this.setPreChatFields(e,i.prechat_fields),this.setOfflineSettings(e,i.offline_chat),this.setNonAvailabilitySettings(e,i.non_availability_message),this.trasferredMessage=r.agent_transfer_msg_to_visitor||i.widget_preferences.agent_transfer_msg_to_visitor},e.prototype.setOfflineSettings=function(e,t){var n,i,r,o,s,a,c;for(i in e.offline_chat?(this.offlineChatSettings=JSON.parse(e.offline_chat),this.offlineChatSettings=this.setDefaults(this.offlineChatSettings,t)):this.offlineChatSettings=t,this.teamstatus&&this.isInBusinessHours()||("1"===this.offlineChatSettings.show||!this.teamstatus&&this.isInBusinessHours()&&"2"!==this.offlineChatSettings.show||window.LIVECHAT_SUPPORT?(this.offlineChat=!0,this.preChatForm=!1):this.hideWidget=!0),this.offlineChatFields={},c=l.Visitor,o=this.offlineChatSettings.form)s=o[i],"message"===i&&(i="textarea"),n=new l.Field(i,{title:s,show:2}),c[r="get"+i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()]&&(a=c[r].call(c)),a&&"null"!==a&&(n.value=a),this.offlineChatFields[i]=n},e.prototype.setPreChatFields=function(e,t){var n,i,r,o,s,a,c;for(r in this.preChatFields={},c=l.Visitor,n=e.prechat_fields?(n=JSON.parse(e.prechat_fields),this.setDefaults(n,t)):t)s=n[r],i=new l.Field(r,s),c[o="get"+r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()]&&(a=c[o].call(c)),a&&"null"!==a&&(i.value=a),this.preChatFields[r]=i},e.prototype.setNonAvailabilitySettings=function(e,t){var n,i,r,o,s,a,c;a=e.non_availability_message,n=t.text,c=/#(.*?)#/g,a?"string"==typeof(a=u.parseJSON(a)).customLink&&(a.customLink=parseInt(a.customLink,10)):a=t,r=(s=a.text?a.text:n)?s.match(c):"",o=a.customLinkUrl,r&&o&&(s=a.customLink&&!this.offlineChat?(i="<a class='ticket_link' target='_blank' href="+(-1===o.indexOf("://")?"//"+o:o)+">"+r[0].substring(1,r[0].length-1)+"</a>",s.replace(r[0],i)):s.replace(r[0],r[0].substring(1,r[0].length-1))),this.nonAvailabilityMessage=s,this.nonAvailabilityCustomLink=a.customLink,this.nonAvailabilityLinkUrl=a.customLinkUrl},e.prototype.setDefaults=function(t,n){var e,i,r,o,s;for(i in e=a.keys(n),s=a.keys(t),t)if(t.hasOwnProperty(i))for(o in r=t[i])r.hasOwnProperty(o)&&""===r[o]&&(t[i][o]=n[i][o]);return livechat._.each(e,function(e){if(c.call(s,e)<0)return t[e]=n[e]}),t},e.prototype.disableSound=function(){},e.prototype.sitesToSkipAutoConnect,e.prototype.resetWidget=function(){l.Widget=new e},e}(),l.Widget=new e}.call(this),function(){var r,n,e;(r=window.livechat).Constants,n=r.jQuery,r._,e=function(){function e(){this.visitor=r.Visitor,this.widget=r.Widget,this.id=null,this.type=null,this.pings=[],this.pingSent=!1,this.missed=!1,this.offline=!1,this.agentId=null,this.agentName=null,this.agentNameCached=null,this.cachedPing=null,this.cachedPingTime=null,this.closed=!1,this.active=!1,this.proactive=!1,this.ongoing=!1,this.agentDisconnected=!1,this.agentNetworkDisconnected=!1,this.messageHistory=[],this.visitorClosedChat=!1}return e.prototype.initialize,e.prototype.initializeCachedPing=function(){var e;e=r.Cache.getItem("pingStatus"),this.pings=[];try{e?(e=JSON.parse(e),(new Date).getTime()-e.pingCreatedAt>=r.Constants.TIME.PING_STORAGE_TIMEOUT+r.Constants.TIME.PING_STORAGE_GRACE_TIME||e.userId!==this.visitor.getId()?(this.removeCachedPing(),e=null):(this.cachedPing=e,this.cachedPing.isProactive&&(this.proactive=this.cachedPing.isProactive),this.pings.push(this.cachedPing),this.cachedPingTime=this.cachedPing.pingCreatedAt)):this.cachedPing=null}catch(e){this.cachedPing=null}},e.prototype.pushToCachedPing=function(e,t){this.cachedPing=this.cachedPing||{ping:!0,pingCreatedAt:(new Date).getTime(),userId:this.visitor.getId(),msg:[]},this.visitor.getId()!==this.cachedPing.userId&&(this.cachedPing.userId=this.visitor.getId(),this.cachedPing.pingCreatedAt=(new Date).getTime()),e&&this.cachedPing.msg.push(e),this.cachedPing.isProactive=t,r.Cache.setItem("pingStatus",JSON.stringify(this.cachedPing))},e.prototype.getCachedPing=function(){return this.cachedPing},e.prototype.removeCachedPing,e.prototype.setRecentChatDetails=function(e){(e.active||e.ongoing)&&(this.id=e.chatId,this.ongoing=e.ongoing,this.active=e.active,e.agentId&&(this.agentId=e.agentId),e.agentName&&(this.agentName=e.agentName),e.hasOwnProperty("closed")&&(this.closed=e.closed))},e.prototype.getAgentName,e.prototype.setAgentName=function(e,t){e&&(this.agentName=e,r.Cache.setItem("livechat_agent_name",e))},e.prototype.clearAgentName=function(){this.agentName=null,r.Cache.removeItem("livechat_agent_name")},e.prototype.isInActive,e.prototype.isActive=function(){return!this.visitor.blocked&&(this.ongoing||this.active)},e.prototype.fetchTranscript=function(e){var t;t={userId:this.visitor.getId(),siteId:this.widget.siteId,code:"fd",chatId:this.id},n.ajax({type:"GET",url:this.widget.nodeUrl+"/visitors/chatTranscript",data:t,dataType:"json",cache:!1,success:e,error:function(e,t,n){window.console&&console.log&&console.log("error getting visitor transcript",n)}})},e.prototype.sendMessage=function(e){var t,n,i;i=this.visitor.getName()||this.visitor.getId(),t=this.visitor.session?this.visitor.session.location:null,n={id:this.id,msg:e,username:i,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:this.ongoing,widget_id:this.widget.id,widget_name:this.widget.name,location:t,current_session:this.visitor.session,socket:r.client.getAuxiliarySocketId(),actualCreatedAt:(new Date).toUTCString(),dropdown:this.visitor.getDropdown(),visitorLimitReached:this.widget.visitorLimitReached},r.client.pushToServer("my_msg_visitor",n)},e.prototype.addMessageToHistory=function(e){return this.messageHistory.push(e)},e.prototype.isADuplicateMessage=function(t){return livechat._.find(this.messageHistory)},e.prototype.setAgentProfilePicture=function(){n("#lc_chat_header #lc_agent_profile_pic").attr("src",this.widget.photosUrl+"/users/"+this.agentId+"/profile_image")},e.prototype.setAgentCursorPictureCobrowsing=function(){n(".lcb-cursor-img").attr("src",this.widget.photosUrl+"/users/"+this.agentId+"/profile_image")},e.prototype.clearAgentProfilePicture,e.prototype.resetChat=function(){this.removeCachedPing(),r.Chat=new e},e}(),r.Chat=new e}.call(this),function(){var n,e;n=window.livechat,e=function(){function e(){this.widget=n.Widget,this.initialized=!1,this.audioElement=null}return e.prototype.initialize=function(){return this.initialized=!0,this.audioElement=document.createElement("audio"),this.audioElement.src=this.widget.assetUrlPrefix+"/sound/message_alert.mp3"},e.prototype.play=function(e,t){!n.Cookies.getCookie(e)&&this.initialized&&(n.Cookies.setCookie(e,!0,5e3),this.audioElement.play(t))},e.prototype.resetSound=function(){n.Sound=new e},e}(),n.Sound=new e}.call(this),function(){var s,e,r={}.hasOwnProperty;(s=window.livechat)._,s.jQuery,e=function(e){function t(){this.visitor=s.Visitor,this.widget=s.Widget,this.chat=s.Chat,this.chatView=s.ChatView,this.coBrowseView=s.CoBrowseView,this.namespace="/visitor",this.connection=null}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,s.EventEmitter),t.prototype.connect=function(e){var t,n,i;this.isConnected()?e&&e():this.connection?this.connection.io.connect():(n=this.widget.nodeUrl+this.namespace,t=["siteid="+this.widget.siteId,"s="+this.widget.sessionHash,"c=fd","i="+this.visitor.getId(),"w_id="+this.widget.id,"r="+this.visitor.getVisitCount()].join("&"),!1===window.livechat.cookieTest&&(t=t+"&cookieVisitor="+window.livechat.cookieTest),(i={forceNew:!0}).reconnectionAttempts=window._lc_reconnect_attempt,this.connection=s.io.connect(n+"?"+t,i),this.initializeLogger(),this.bindEvents())},t.prototype.initializeLogger=function(){var e,n,i,t;4===this.widget.debug&&(localStorage.debug="socket.io-client:socket",e=this.connection.emit,this.connection.emit=(t=this,function(){console.log(new Date,"***","emit",Array.prototype.slice.call(arguments)),e.apply(t.connection,arguments)}),n=this.connection.onevent,this.connection.onevent=(i=this,function(e){var t;t=e.data||[],console.log(new Date,"***","onevent",t),n.call(i.connection,e)}))},t.prototype.bindEvents=function(){var e,t,n,i,r,o;this.connection.on("connect",(e=this,function(){e.chatView.connect()})),this.connection.on("error",(t=this,function(e){4===t.widget.debug&&window.console&&console.log&&console.error("Unable to connect ",e)})),this.connection.on("disconnect",(n=this,function(e){n.chatView.disableInputContainer(),n.visitor.stopForceDisconnectTimer(),n.chat.id=""})),this.connection.on("connection accepted",(i=this,function(e){s.client.primary.isConnected()&&i.chatView.disableLoader(),s.client.triggerGloablEvent("visitor-connection-accepted",[e])})),this.connection.on("join",(r=this,function(e){r.pushToServer("join room",{id:e.roomId}),r.chatView.stopAgentDisconnectTimer()})),this.connection.on("leave",(o=this))},t.prototype.isConnected=function(){var e;return null!=(e=this.connection)?e.connected:void 0},t.prototype.disconnect,t.prototype.pushToServer=function(e,t){this.connection.emit(e,t)},t.prototype.getSocketId,t}(),s.SocketConnection=e}.call(this),function(){var n,e,i=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;n=window.livechat,e=function(e){function t(){this.reset=i(this.reset,this),this.bindCustomEvents=i(this.bindCustomEvents,this),this.sound=n.Sound,this.visitor=n.Visitor,this.widget=n.Widget,this.chat=n.Chat,this.connection=null}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,n.EventEmitter),t.prototype.connectToReturnOrOnline=function(){},t.prototype.subscribeConversationChannel=function(){},t.prototype.subscribeChatChannel=function(){},t.prototype.getReturnVisitorChannel=function(){},t.prototype.unSubscribeFromChannel=function(){},t.prototype.unsubscribeFromAllChannels=function(){},t.prototype.bindCustomEvents=function(){var e;(e=this._getEvents())["chat-closed"]||this.on("chat-closed"),e["visitor-connection-accepted"]||this.on("visitor-connection-accepted",function(e){return e&&this.chat.setRecentChatDetails(e),this.chatView.isChatInProgress(),this.chat.ongoing?(this.chat.removeCachedPing(),this.chat.pings=[],e&&e.visitorClosedChat?this.chat.loadTranscript=!1:this.chat.loadTranscript=!0,this.subscribeChatChannel(this.chat.id),this.subscribeConversationChannel(),this.chatView.postChatConnectedEvents(e)):(this.chatView.enableInputContainer(),this.chatView.sendPingMessages())})},t.prototype.reset=function(){this.sound=n.Sound,this.visitor=n.Visitor,this.widget=n.Widget,this.chat=n.Chat,this.unsubscribeFromAllChannels(),this.disconnect(),this.removeEvent("chat-closed"),this.removeEvent("visitor-connection-accepted")},t}(),n.Abstract=e}.call(this),function(){var n;(n=window.livechat).chatEvents={visitor_new_msg:function(e){var t;e.socket&&e.socket!==n.client.getAuxiliarySocketId()&&(e.content=e.msg,this.chatView.addMessage(e),n.MainView.pageActive||this.sound.play("messageAlert",e.id),this.chatView.flashPageTitle(e.name,e.content)),e.userId!==this.visitor.getId()&&(n.client.pushToServer("msg received",t={id:e.id,chatId:e.chatId,actualReceivedAt:(new Date).toUTCString()}),this.chatView.hideTyping(),this.chatView.addMessageReceivedAt(t.id,t.actualReceivedAt))},typing:function(e){this.visitor.getId()!==e.userId&&this.chatView.showTyping(e)}}}.call(this),function(){var t,n;t=window.livechat,n=t.jQuery,t.visitorEvents={"ping accepted":function(e){var t;this.chat.proactive=!1,this.chatView.reason=null,this.chatView.postChatConnectedEvents(e),n("#lc-close").removeClass("hide"),this.chatView.triggerEvent("fd_lc_ping_accepted"),this.chat.removeCachedPing(),this.subscribeConversationChannel(e.id),this.subscribeChatChannel(e.id),t=n("#lc_chat_layout"),n("#chat-widget").length&&!t.is(":visible")&&t.show()},"chat close":function(e){e.chatId===this.chat.id&&t.client.triggerGloablEvent("chat-closed",[e]),this.chatView.triggerEvent("fd_lc_chat_closed")},"update chat":function(e){e&&e.chatId&&(e.agentName=this.chat.agentNameCached,this.chatView.postChatConnectedEvents(e),this.subscribeConversationChannel(e.chatId),this.subscribeChatChannel(e.chatId))},"ping initiated":function(e){e.clearChatCookie&&(this.chat.active=!1),this.chatView.startWaitingMessageAndTimer()},transfer:function(e){t.client.pushToServer("leave room",{id:this.chat.id}),this.unSubscribeFromChatChannel(this.chat.id),t.client.pushToServer("join room",{id:e.id}),this.subscribeChatChannel(e.id),this.chatView.postChatConnectedEvents(e),this.chatView.showChatTransferredMessage()},"agent connect":function(e){this.chatView.agentConnected(e)},"agents available":function(e){this.chatView.updateWaitingAndNonAvailabilityTimers(e)},"blocked visitor":function(e){this.visitor.block(e)},"unblocked visitor":function(e){this.visitor.unblock(e)},"update details":function(e){this.visitor.setVisitorProperties(e)},"agent network disconnect":function(e){this.chatView.agentNetworkDisconnected(e)},"agent network connect":function(e){this.chatView.agentNetworkConnected(e)},"agent disconnect":function(e){this.chatView.agentDisconnected(e)},"force disconnect":function(e){e.force_disconnect&&t.client.disconnect(),this.chatView.disableInputContainer(),this.visitor.stopForceDisconnectTimer()},"cobrowse start":function(e){t.CoBrowseView.setLocalStorage("CBVisitorReqStartTime",0),this.coBrowseView.cbTimerHandle&&window.clearInterval(t.CoBrowseView.cbTimerHandle),this.coBrowseView.requestCoBrowsingSession(e)},"cobrowse stop":function(e){this.coBrowseView.cobrowsingEnd(e)},"cobrowse request cancelled":function(){this.coBrowseView.coBrowsingRequestCancelled()},"cobrowse control request":function(){this.coBrowseView.coBrowseControlRequest()},"ping received ack"}}.call(this),function(){var a,o,s,e,c,r={}.hasOwnProperty;a=window.livechat,s=a.Constants,o=a.jQuery,c=a._,e=function(e){function i(e){var t,n;this.bindEvents=(t=this.bindEvents,n=this,function(){return t.apply(n,arguments)}),this.appKeys=e,this.chatView=a.ChatView,this.coBrowseView=a.CoBrowseView,this.visitor=a.Visitor,this.client=a.client,i.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(i,a.Abstract),i.prototype.connect=function(e){var t,n,i;this.visitor.removeDisconnectedFlag(),n={authEndpoint:this.widget.nodeUrl+"/visitors/grantPermissions",authTransport:"jsonp",auth:{params:{userId:this.visitor.getId(),siteId:this.widget.siteId}}},4===this.widget.debug&&(Pusher.log=function(e){return console.log("Recevied Message ---\x3e",e)}),console.log("appKeys ===>",this.appKeys),t=this.appKeys,c.isObject(this.appKeys)&&(t=this.appKeys.key,this.appKeys.cluster&&(n.cluster=this.appKeys.cluster)),this.connection=new Pusher(t,n),this.connection.connection.bind("state_change",(i=this,function(e){if(e&&"unavailable"===e.current)return i.visitor.setDisconnectedFlag()})),this.bindCustomEvents(),this.subscribeToUserChannel(e)},i.prototype.disconnect=function(){this.connection.disconnect()},i.prototype.isConnected,i.prototype.connectToReturnOrOnline=function(e){if(window.LIVECHAT_SUPPORT)return e&&e();this.chat.id&&!this.chat.closed?this.subscribeConversationChannel(this.chat.id,e):0<this.visitor.getVisitCount()?this.subscribeToChannel(this.getReturnVisitorChannelName(),e):this.subscribeToChannel(this.getOnlineChannelName(),e)},i.prototype.subscribeConversationChannel=function(e,t){this.chat.ongoing=!0,this.subscribeToChannel(this.getConversationChannelName(),t),this.unSubscribeFromChannel(this.getOnlineChannelName()),this.unSubscribeFromChannel(this.getReturnVisitorChannelName())},i.prototype.subscribeToUserChannel=function(t){var e,n,r;this.visitorPrivateChannel=this.subscribeToChannel(this.getUserChannelName(),(r=this,function(){var e,n,i;return t?(r.connection.connected=!0,a.client.auxiliary.isConnected()&&r.chatView.disableLoader(),t(),void(t=null)):r.visitor.getDiconnectedFlag()?(e="siteId="+r.widget.siteId+"&vid="+r.visitor.getId()+"&c=fd",r.widget.id&&(e=e+"&widget_id="+r.widget.id),i=r.chatView.getVisitorDetails(),r.visitor.getDiconnectedFlag()&&Math.abs(new Date(r.visitor.getDiconnectedFlag())-new Date)>s.TIME.CURRENT_VISITOR_TIME_OUT&&!(0<r.visitor.getVisitCount())&&(r.visitor.incrementVisitCount(),i.isReturningVisitor=!0,n=!0),r.visitor.removeDisconnectedFlag(),o.ajax({type:"GET",url:r.widget.nodeUrl+"/visitors/getChatDataOnReconnect",data:e,dataType:"json",cache:!1,success:function(e){var t;r.connection.connected=!0,(t=e.data)&&t.closed?r.switchChannelsOnChatClose(t.chatId,function(e){e&&a.client.auxiliary.isConnected()&&setTimeout(function(){a.client.pushToServer("change_visitor_type",i)},s.TIME.CHANGE_VISITOR_TIME_OUT)}):t?t&&!t.closed&&n&&a.client.auxiliary.isConnected()&&setTimeout(function(){a.client.pushToServer("change_visitor_type",i)},s.TIME.CHANGE_VISITOR_TIME_OUT):r.connectToChannelOnChatClose(function(e){e&&a.client.auxiliary.isConnected()&&setTimeout(function(){a.client.pushToServer("change_visitor_type",i)},s.TIME.CHANGE_VISITOR_TIME_OUT)})},error:function(){window.console&&console.log&&console.log("Error while fetching chat details")}})):void 0})),this.connectToReturnOrOnline(),n=["connection accepted","join","leave","join chat room"],e=c.chain({}).extend(a.visitorEvents).omit(n).value(),this.bindEvents(e)},i.prototype.subscribeChatChannel=function(e,t){var n,i,r,o,s;if(s=!1,(n=this.connection.channel(this.getChatChannelName(e)))&&n.subscribed||(s=!0),t&&t(s),i=this.subscribeToChannel(this.getChatChannelName(e)))for(r in o=a.chatEvents)o[r],i.bind(r,a.chatEvents[r].bind(this))},i.prototype.unSubscribeFromChatChannel,i.prototype.unsubscribeFromAllChannels=function(){var e,t;e=c.pluck(this.connection.channels.channels,"name"),c.each(e,(t=this,function(e){return t.unSubscribeFromChannel(e)}))},i.prototype.subscribeToChannel=function(t,e){var n,i,r;try{return(n=this.connection.channel(t))&&n.subscribed?void(e&&e()):(r=this.connection.subscribe(t),e&&(r.bind("pusher:subscription_succeeded",e),r.bind("pusher:subscription_error",e)),r)}catch(e){i=e,window.console&&console.log&&console.log("Error in while subscribing to channel -> "+t,i)}},i.prototype.unSubscribeFromChannel=function(t){var e,n;try{if((e=this.connection.channel(t))&&e.subscribed)return this.connection.unsubscribe(t)}catch(e){n=e,window.console&&console.log&&console.log("Error in while subscribing to channel -> "+t,n)}},i.prototype.switchChannelsOnChatClose=function(e,t){this.unSubscribeFromChatChannel(e),this.connection.channel(this.getUserChannelName()),this.unSubscribeFromChannel(this.getConversationChannelName()),t&&t(!1)},i.prototype.isInReturningVisitorChannel=function(e){var t,n;return n=!1,(t=this.connection.channel(this.getReturnVisitorChannelName()))&&t.subscribed&&(n=!0),n},i.prototype.connectToChannelOnChatClose=function(e){var t,n;n=this.connection.channel(this.getReturnVisitorChannelName()),t=this.connection.channel(this.getOnlineChannelName()),this.getOnlineChannelName(),0<this.visitor.getVisitCount()?n&&n.subscribed?e&&e(!1):(this.subscribeToChannel(this.getReturnVisitorChannelName()),e&&e(!0),t&&t.subscribed&&this.unSubscribeFromChannel(this.getOnlineChannelName())):t&&t.subscribed?e&&e(!1):(this.subscribeToChannel(this.getOnlineChannelName()),e&&e(!0))},i.prototype.bindEvents=function(e){var t;for(t in e)e[t],this.visitorPrivateChannel.bind(t,e[t].bind(this))},i.prototype.pushToVisitorTabs=function(e,t){this.connection.channel(this.getUserChannelName()).trigger("client-"+e,t),a.visitorEvents[e].call(this,t)},i.prototype.getReturnVisitorChannel=function(){return pusherInstance.channel(this.getReturnVisitorChannelName())},i.prototype.getReturnVisitorChannelName=function(){return"private-visitors-"+this.widget.siteId+"-return-"+this.visitor.getId()},i.prototype.getConversationChannelName=function(){return"private-visitors-"+this.widget.siteId+"-conversation-"+this.visitor.getId()},i.prototype.getOnlineChannelName=function(){return"private-visitors-"+this.widget.siteId+"-online-"+this.visitor.getId()},i.prototype.getUserChannelName=function(){return"private-"+this.widget.siteId+"-"+this.visitor.getId()},i.prototype.getChatChannelName,i}(),a.PusherConnection=e}.call(this),function(){var o,s,a,e,i,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,c=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};o=window.livechat,a=o.Constants,s=o.jQuery,i=o._,e=function(e){function t(e){this.receiveMessage=n(this.receiveMessage,this),this.unSubscribeFromChatChannel=n(this.unSubscribeFromChatChannel,this),this.disconnect=n(this.disconnect,this),this.bindEvents=n(this.bindEvents,this),this.appKeys=e,this.chatView=o.ChatView,this.coBrowseView=o.CoBrowseView,this.visitor=o.Visitor,this.client=o.client,t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,o.Abstract),t.prototype.connect=function(t){var e,n,i;n=this.widget.siteId+":"+this.visitor.getId(),e={siteId:this.widget.siteId,authKey:n},s.ajax({type:"GET",url:this.widget.nodeUrl+"/visitors/grantPermissions",data:e,dataType:"jsonp",crossDomain:!0,jsonpCallback:"jsonpCallback",cache:!1,context:this,success:(i=this,function(e){"success"===(null!=e?e.status:void 0)&&(i.connection=PUBNUBVisitor.init({publish_key:i.appKeys.publish_key,subscribe_key:i.appKeys.subscribe_key,uuid:n,auth_key:n,instance_id:!0,ssl:!0}),i.bindCustomEvents(),i.subscribeToChatChannelGroup(function(){i.subscribeToUserChannel(t)}))}),error:function(){window.console&&console.log&&console.log("error in granting pubnub permissions")}})},t.prototype.subscribeToChatChannelGroup=function(e){var t;this.connection.channel_group_add_channel({callback:(t=this,function(){t.connection.subscribe({channel_group:t.getChatsGroupName(),message:t.receiveMessage,connect:function(){t.connection.channel_group_remove_channel({channel_group:t.getChatsGroupName(),channel:"dummy",callback:function(){}}),t.bindEvents(o.chatEvents),e&&e()}})}),error:function(e){window.console&&console.log&&console.log("Error creating group ",e)},channel:"dummy",channel_group:this.getChatsGroupName()})},t.prototype.bindEvents=function(e){var t;for(t in e)e[t],this.connection.events.list[t]||this.connection.events.bind(t,e[t].bind(this))},t.prototype.subscribeToUserChannel=function(e){var r,t,n;this.connection.subscribe({channel:this.getUserChannelName(),heartbeat:60,callback:this.receiveMessage,connect:this.onUserChannelSubscriptionSuccess((n=this,function(){if(window.LIVECHAT_SUPPORT)return e&&e();n.connectToReturnOrOnline(e)})),disconnect:(t=this),reconnect:(r=this,function(){var e,n,i;e="siteId="+r.widget.siteId+"&vid="+r.visitor.getId()+"&c=fd",r.widget.id&&(e=e+"&widget_id="+r.widget.id),i=r.chatView.getVisitorDetails(),Math.abs(new Date(r.visitor.getDiconnectedFlag())-new Date)>a.TIME.CURRENT_VISITOR_TIME_OUT&&!(0<r.visitor.getVisitCount())&&(r.visitor.incrementVisitCount(),i.isReturningVisitor=!0,n=!0),s.ajax({type:"GET",url:r.widget.nodeUrl+"/visitors/getChatDataOnReconnect",data:e,dataType:"json",cache:!1,success:function(e){var t;r.connection.connected=!0,(t=e.data)&&t.closed?r.switchChannelsOnChatClose(t.chatId,function(e){e&&o.client.auxiliary.isConnected()&&setTimeout(function(){o.client.pushToServer("change_visitor_type",i)},a.TIME.CHANGE_VISITOR_TIME_OUT)}):t?t&&!t.closed&&n&&o.client.auxiliary.isConnected()&&setTimeout(function(){o.client.pushToServer("change_visitor_type",i)},a.TIME.CHANGE_VISITOR_TIME_OUT):r.connectToChannelOnChatClose(function(e){e&&o.client.auxiliary.isConnected()&&setTimeout,a.TIME.CHANGE_VISITOR_TIME_OUT)})},error})}),error:function(e){window.console&&console.log&&console.log("error subscribe channel user id",e)}})},t.prototype.onUserChannelSubscriptionSuccess=function(e){var t,n;o.client.auxiliary.isConnected()&&this.chatView.disableLoader(),this.connection.connected=!0,n=["connection accepted","join","leave","join chat room"],t=i.chain({}).extend(o.visitorEvents).omit(n).value(),this.bindEvents(t),e&&e()},t.prototype.disconnect=function(){this.connection.unsubscribe({channel:this.connection.get_subscribed_channels(),channel_group:this.getChatsGroupName()}),this.connection.connected=!1},t.prototype.isConnected,t.prototype.connectToReturnOrOnline=function(e){this.chat.id&&!this.chat.closed?this.subscribeConversationChannel(this.chat.id,e):0<this.visitor.getVisitCount()?this.subscribeToChannel(this.getReturnVisitorChannelName(),e):this.subscribeToChannel(this.getOnlineChannelName(),e)},t.prototype.connectToChannelOnChatClose=function(e){var t,n,i;if(window.LIVECHAT_SUPPORT)return e&&e(!1);i=this.connection.get_subscribed_channels(),t=this.getOnlineChannelName(),0<this.visitor.getVisitCount()?(n=this.getReturnVisitorChannelName(),c.call(i,n)<0?(this.subscribeToChannel(this.getReturnVisitorChannelName(),function(){return e&&e(!0)}),0<=c.call(i,t)&&this.unSubscribeFromChannel(this.getOnlineChannelName())):e&&e(!1)):c.call(i,t)<0?this.subscribeToChannel(this.getOnlineChannelName()):e&&e(!1)},t.prototype.subscribeConversationChannel=function(e,t){var n,i,r,o;this.chat.ongoing=!0,o=this.connection.get_subscribed_channels(),n=this.getConversationChannelName(),0<=c.call(o,n)?t&&t():this.connection.subscribe({channel:this.getConversationChannelName(),state:{chatId:e},heartbeat:60,connect:function(){t&&t()},callback:this.receiveMessage,error:function(e){window.console&&console.log&&console.log("error subscribe channel user id",e),t&&t()}}),i=this.getOnlineChannelName(),0<=c.call(o,i)&&this.unSubscribeFromChannel(this.getOnlineChannelName()),r=this.getReturnVisitorChannelName(),0<=c.call(o,r)&&this.unSubscribeFromChannel(this.getReturnVisitorChannelName())},t.prototype.subscribeChatChannel=function(n){var t,i;this.connection.channel_group_list_channels({channel_group:this.getChatsGroupName(),callback:(i=this,function(e){var t;t=i.getChatChannelName(n),c.call(e.channels,t)<0?i.connection.channel_group_remove_channel({channel_group:i.getChatsGroupName(),channels:e.channels,callback:function(){return i.connection.state({channel:i.getConversationChannelName(),state:{chatId:n}}),i.connection.channel_group_add_channel({channel_group:i.getChatsGroupName(),channel:t})}}):console.log("The chat channel("+t+") is already present in the channel group(@getChatsGroupName()) - ",e)}),error:(t=this,function(e){console.log("Error while getching the channel group list of channels ",e),t.connection.channel_group_add_channel({channel_group:t.getChatsGroupName(),channel:t.getChatChannelName(n)})})})},t.prototype.unSubscribeFromChatChannel=function(e){this.connection.channel_group_remove_channel({channel_group:this.getChatsGroupName(),channel:this.getChatChannelName(e),callback:function(){}})},t.prototype.unsubscribeFromAllChannels=function(){this.connection.unsubscribe({channel:[this.getConversationChannelName(),this.getReturnVisitorChannelName(),this.getOnlineChannelName(),this.getUserChannelName()]})},t.prototype.receiveMessage=function(e,t,n){4===this.widget.debug&&console.log("Received message ---\x3e ",e,t,n),this.connection.events.fire(e.type,e.data)},t.prototype.subscribeToChannel=function(t,n){var i,e;try{e=this.connection.get_subscribed_channels(),0<=c.call(e,t)?n&&n():this.connection.subscribe({channel:t,callback:this.receiveMessage,heartbeat:60,connect,error:function(e){window.console&&console.log&&console.log("error subscribe channel user id",e),n&&n()}})}catch(e){i=e,window.console&&console.log&&console.log("Error in while subscribing to channel -> "+t,i)}},t.prototype.unSubscribeFromChannel=function(t){var n;try{this.connection.unsubscribe({channel:t})}catch(e){n=e,window.console&&console.log&&console.log("Error in while subscribing to channel -> "+t,n)}},t.prototype.isInReturningVisitorChannel=function(e){var n,i;n=!1,this.connection.where_now({uuid:this.widget.siteId+":"+this.visitor.getId(),callback:(i=this,function(e){var t;return t=i.getReturnVisitorChannelName(),0<=c.call(e,t)&&(n=!0),n}),error:function(e){return n}})},t.prototype.switchChannelsOnChatClose=function(e,t){var n;this.unSubscribeFromChatChannel(e),n=this.getConversationChannelName(),0<=c.call(this.connection.get_subscribed_channels(),n)&&this.unSubscribeFromChannel(this.getConversationChannelName()),t&&t(!1)},t.prototype.pushToVisitorTabs=function(e,t){return this.connection.publish({channel:this.getUserChannelName(),message:{type:e,data:t}})},t.prototype.getReturnVisitorChannelName=function(){return this.widget.siteId+".presence:return"},t.prototype.getConversationChannelName=function(){return this.widget.siteId+".presence:conversation"},t.prototype.getOnlineChannelName,t.prototype.getUserChannelName=function(){return this.widget.siteId+"."+this.visitor.getId()+".private"},t.prototype.getChatChannelName,t.prototype.getChatsGroupName=function(){return this.widget.siteId+":"+this.visitor.getId()+".chat"},t}(),o.PubNubConnection=e}.call(this),function(){var i,e,r,o=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty;(i=window.livechat).Constants,i.jQuery,r=i._,e=function(e){function t(e,t,n){switch(this.connectAuxiliaryClient=o(this.connectAuxiliaryClient,this),this.connectPrimaryClient=o(this.connectPrimaryClient,this),this.connect=o(this.connect,this),this.visitor=i.Visitor,this.widget=i.Widget,this.chat=i.Chat,this.chatView=i.ChatView,this.coBrowseView=i.CoBrowseView,this.appKeys=n,e){case"pubnub":this.primary=new i.PubNubConnection(this.appKeys);break;case"pusher":this.primary=new i.PusherConnection(this.appKeys)}switch(t){case"socket":this.auxiliary=new i.SocketConnection}}return(t,i.EventEmitter),t.prototype.connect=function(e){this.chatView.enableLoader(),this.bindGlobalListener(),this.isPrimaryClientConnected()?this.connectAuxiliaryClient():this.connectPrimaryClient(this.connectAuxiliaryClient)},t.prototype.pushToServer=function(e,t){this.auxiliary.pushToServer(e,t)},t.prototype.isConnected,t.prototype.connectPrimaryClient=function(e){this.primary.connect(e)},t.prototype.connectAuxiliaryClient=function(e){this.auxiliary.connect(e)},t.prototype.isPrimaryClientConnected=function(){return this.primary.isConnected()},t.prototype.isAuxiliaryClientConnected=function(){return this.auxiliary.isConnected()},t.prototype.disconnect,t.prototype.disconnectPrimaryClient=function(){this.primary.disconnect()},t.prototype.disconnectAuxiliaryClient=function(){this.auxiliary.disconnect()},t.prototype.getAuxiliarySocketId=function(){return this.auxiliary.getSocketId()},t.prototype.bindGlobalListener=function(){var n;this.addGlobalListener((n=this,function(){var e,t;e=arguments[0],t=r.rest(arguments),n.primary.trigger(e,t),n.auxiliary.trigger(e,t)}))},t}(),i._Client=e}.call(this),function(){var l,u,r,e,h,t;l=window.livechat,r=l.Constants,u=l.jQuery,h=l._,e=function(){function e(){this.showTyping=t(this.showTyping,this),this.triggerTyping=t(this.triggerTyping,this),this.postChatConnectedEvents=t(this.postChatConnectedEvents,this),this.visitor=l.Visitor,this.widget=l.Widget,this.chat=l.Chat,this.pageTitle=document.title,this.titleTimer=null,this.chatExpireTimer=null,this.reason=null,this.close="#lc-close",this.endChatPopUp=".lc-end-chat",this.forceMinimized=!1}return e.prototype.initialize,e.prototype.connect=function(){this.enableInputContainer(),this.visitor.stopAutoConnectTimer(),this.visitor.startForceDisconnectTimer(r.TIME.FORCE_DISCONNECT),this.visitor.connectionRequest(),this.enableClose()},e.prototype.postChatConnectedEvents=function(t){var n;this.chat.id=t.chatId||t.id,this.chat.agentId=t.agentId,this.chat.agentNetworkDisconnected=!1,this.chat.agentDisconnected=!1,this.chat.closed=!1,t.agentName&&this.setAgentName(t.agentName),this.chatExpireTimerOff(),this.stopMoreWaitingTimer(),this.stopNonAvailabilityTimer(),l.OfflineView.stopOfflineSubmitTimer(),this.chat.setAgentProfilePicture(),(this.widget.offlineChat&&!l.OfflineView.messageSent||this.widget.preChatForm)&&(this.widget.offlineChat=!1,u("#lc_chat_layout").addClass("lc-chat").removeClass("lc-prechat lc-offline"),u("#lc_chat_title").html(this.getTitle())),u("#lc-close").removeClass("hide"),t.visitorClosedChat?this.disableClose():this.enableClose(),this.chat.loadTranscript&&(this.chat.loadTranscript=!1,this.disableInputContainer(),this.chat.fetchTranscript((n=this,function(e){(null!=e?e.data:void 0)&&n.updateTranscript(e.data,t.closed),n.enableInputContainer(),n.sendPingMessages()})))},e.prototype.updateTranscript=function(e,t){var n,i,r,o,s,a,c;if(0<(s=(r=u("#lc_chat_message_window")).find("p")).length&&s.remove(),o=e.history,!((c=h(o).sortBy(function(e){return+new Date(e.createdAt)})).length<0)){for(t&&this.isMaximized()||this.isMobileBrowser?this.collapse():!t&&this.isMinimized()&&this.expand(!1),this.clearNotifications(),n=0,i=c.length;n<i;n++)(a=c[n]).content=a.msg,r.append(h.template(l.templates.message,{message:this.prepareMessage(a)}));r.scrollTop(r.get(0).scrollHeight)}},e.prototype.sendPingMessages=function(){var t,e,n,i;i=this.chat.pings,t=!1,0<i.length&&(n={},0<(e=(e=u.map(i,function(e){if(e.fromMsg&&(t=!0,delete e.fromMsg),(null!=e?e.pingCreatedAt:void 0)&&(n.pingCreatedAt=e.pingCreatedAt),null!=e?e.msg:void 0)return e.msg}).join("\n")).replace(/^(\r?\n|\r)/g,"")).length&&(n.msg=e),this.chat.pings=[],this.sendMessageOrPing(n,!t))},e.prototype.sendMessageOrPing=function(e,t){l.client.isConnected()?(this.chat.visitorClosedChat&&(e.visitorClosedChat=!0,e.agentId=this.chat.agentId),this.chat.isActive()&&!t?(this.chat.sendMessage(e.msg),this.addMessage({name:this.widget.me,content:e.msg})):(t?this.sendPing(e,t):this.sendPing(e),e.msg&&this.addMessage({name:this.widget.me,content:e.msg})),this.chat.visitorClosedChat=!1):(e.fromMsg=!0,this.chat.pings.push(e),l.client.connect())},e.prototype.sendPing=function(e,t){var n,i;this.chat.pingSent=!0,this.startWaitingMessageAndTimer(),this.startNonAvailabilityTimer(),n=this.getVisitorDetails(),this.chat.pushToCachedPing(!t||n.isProactive?e.msg:null,n.isProactive),n.msg=e.msg,n.detailsFromPreChatForm=null!=(i=e.detailsFromPreChatForm)&&i,n.visitorLimitReached=this.widget.visitorLimitReached,l.client.pushToServer("visitor ping",n)},e.prototype.showWelcomeMessage=function(){0<u("#lc_chat_message_window .lc_welcome_message").length||0<u("#lc_chat_message_window .lc-msg-block").length||this.addDefaultMessage(this.widget.welcomeMessage,"welcome")},e.prototype.getVisitorDetails=function(){var e,t,n,i,r;return r=this.visitor.getName()||this.visitor.getId(),n=null!=(i=this.visitor.session)?i.location:void 0,window.LIVECHAT_SUPPORT?(e=this.visitor.getSupportDropdown(),t=!0):e=this.visitor.getDropdown(),e&&(e=this.escapeSpecialCharacters(e)),{name:r,email:this.visitor.getEmail(),phone:this.visitor.getPhone(),textfield:this.visitor.getTextfield(),dropdown:e,widget_name:this.widget.name,isProactive:this.chat.proactive,location:n,returnVisitor:this.visitor.isReturnVisitor(),title:document.title,appSupport:t}},e.prototype.escapeSpecialCharacters,e.prototype.addMessageReceivedAt,e.prototype.addMessage=function(e,t){var n;u(this.endChatPopUp).hasClass("hide")||(u(this.endChatPopUp).addClass("hide"),u(this.close).removeAttr("disabled",!0),u(this.close).css("pointer-events","auto")),e.id&&this.chat.isADuplicateMessage(e)||(this.chat.addMessageToHistory(e),this.clearNotifications(),t||(e.content=l.MainView.escapeHtml(e.content)),e=this.prepareMessage(e),n=u("#lc_chat_message_window"),"lc-guest"===e.class&&l.isMobileBrowser&&u("#lc_chat_input_container").blur(),n.append(h.template(l.templates.message,{message:e})),this.agentDisconnectTimer&&this.showAgentDisconnectMessage(this.widget.agentNetworkDisconnectMessage),n.scrollTop(n.get(0).scrollHeight))},e.prototype.addDefaultMessage=function(e,t){var n,i;i=!(n="lc-guest"),"welcome"===t&&(n+=" lc_welcome_message"),"non availability"===t&&(i=!0),this.addMessage({content:e,class:n,createdAt:new Date},i)},e.prototype.addNotification=function(e,t){var n,i;this.clearNotifications(),i={content:e,class:t?"lc-notification-message lc-nm-active":"lc-notification-message",id:"lc_notification_message"},(n=u("#lc_chat_message_window")).append(h.template(l.templates.notification,{notification:i})),n.scrollTop(n.get(0).scrollHeight)},e.prototype.clearNotifications,e.prototype.addPresistNotification=function(e){var t,n;this.clearNotifications(),n={content:e,class:"lc-notification-message",id:"lc_presist_message"},(t=u("#lc_chat_message_window")).append(h.template(l.templates.notification,{notification:n})),t.scrollTop(t.get(0).scrollHeight)},e.prototype.prepareMessage=function(e){return e.time=l.DateFormatter.format(new Date(e.createdAt||new Date),"hh:MM TT"),e.class||(e.class=e.userId&&0!==e.userId.search("visitor")?"lc-guest":"lc-self"),"typing"!==e.type&&(e.content=l.Autolinker.link(e.content.replace(/\n/g,"<br>"))),e},e.prototype.startWaitingMessageAndTimer=function(){var e;this.moreWaitingTimer||(e=r.TIME.WAIT_MESSAGE,this.chat.cachedPingTime&&(e=(e-=(new Date).getTime()-this.chat.cachedPingTime)<0?0:e),this.startMoreWaitingTimer(e))},e.prototype.startMoreWaitingTimer=function(e){var t;this.moreWaitingTimer||this.widget.moreWaitingMessage&&(this.moreWaitingTimer=setTimeout((t=this),e))},e.prototype.stopMoreWaitingTimer=function(){clearTimeout(this.moreWaitingTimer),this.moreWaitingTimer=null},e.prototype.startNonAvailabilityTimer=function(){var e,t;this.nonAvailabilityTimer||(e=r.TIME.NON_AVAILABILITY,this.chat.cachedPingTime&&(t=(new Date).getTime()-this.chat.cachedPingTime,e-=(new Date).getTime()-this.chat.cachedPingTime,t<0&&(e+=t),e<0&&(e=0)),this.nonAvailabilityTimer=setTimeout(this.showNonAvailabilityMessage.bind(this),e))},e.prototype.showNonAvailabilityMessage=function(){this.chat.missed=!0,this.widget.nonAvailabilityCustomLink?(this.disableInputContainer(),this.addDefaultMessage(this.widget.nonAvailabilityMessage,"non availability"),this.setTitle(this.widget.offlineChatSettings.messages.title),l.OfflineView.sendOfflineChatEvent(null,!1),this.chat.removeCachedPing()):l.OfflineView.render(!0)},e.prototype.stopNonAvailabilityTimer=function(){clearTimeout(this.nonAvailabilityTimer),this.nonAvailabilityTimer=null},e.prototype.updateWaitingAndNonAvailabilityTimers=function(e){e.status||("unavailable in groups"===e.reason||"agents unavailable"===e.reason?(this.reason="agents_unavailable",this.stopNonAvailabilityTimer(),this.showNonAvailabilityMessage(),this.chat.missed=!1):"Chat limit reached for agents in routed groups"!==e.reason&&"Chat limit reached for all agents"!==e.reason||"agents_limit_reached"!==this.reason&&(this.reason="agents_limit_reached",this.stopMoreWaitingTimer(),this.startMoreWaitingTimer(0)))},e.prototype.disableClose=function(){if(!window.LIVECHAT_SUPPORT)return u(".lc-close").attr("disabled",!0),u(".lc-close").css("pointer-events","none")},e.prototype.enableClose=function(){return u("#lc-close").removeAttr("disabled"),u("#lc-close").css("pointer-events","auto")},e.prototype.showChatClose,e.prototype.enableInputContainer=function(){u("#lc_chat_input_container").prop("disabled",!1)},e.prototype.disableInputContainer,e.prototype.enableLoader=function(){this.disableInputContainer(),u("#lc_chat_message_window p").hide(),u(".overlay-bg").show()},e.prototype.disableLoader=function(){this.enableInputContainer(),u("#lc_chat_message_window p").show(),u(".overlay-bg").hide()},e.prototype.isMinimized=function(){return u("#lc_chat_layout").hasClass("lc-collapsed")},e.prototype.isMaximized,e.prototype.getTitle=function(){var e,t;return t=this.chat.active&&!this.chat.closed?this.chat.getAgentName():this.widget.title,this.widget.offlineChat&&(e=this.widget.offlineChatSettings.messages,t=l.OfflineView.messageSent?e.thank_header:e.title),t},e.prototype.setTitle=function(e){var t,n;n=u("#lc_chat_layout").find("#lc_chat_title"),t=e||this.getTitle(),n.html(t)},e.prototype.setAgentName,e.prototype.clearAgentName,e.prototype.triggerTyping=function(){var e;this.triggerTypingTimer||(l.client.pushToServer("typing",{id:this.chat.id,userId:this.visitor.getId()}),this.triggerTypingTimer=setTimeout((e=this),r.TIME.TYPING))},e.prototype.showTyping=function(e){var t,n;t={createAt:new Date,photo:e.photo,name:e.name,type:"typing",class:"lc-guest"},u(this.endChatPopUp).hasClass("hide")||(u(this.endChatPopUp).addClass("hide"),u(this.close).removeAttr("disabled",!0),u(this.close).css("pointer-events","auto")),0===u(".lc-typing-dots").length&&(this.addMessage(t),this.typingTimer=setTimeout((n=this,function(){n.hideTyping()}),r.TIME.TYPING))},e.prototype.hideTyping=function(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null),u("#lc_chat_message_window .lc-typing-dots").closest("p").remove()},e.prototype.agentConnected=function(e){this.setAgentName(e.agentName),u("#lc_chat_header").removeClass("lc-inactive"),this.clearNotifications(),this.agentDisconnectTimer&&this.stopAgentDisconnectTimer(),this.stopAgentNetworkDisconnectTimer()},e.prototype.agentDisconnected=function(e){var t;this.showAgentDisconnectMessage(this.widget.agentNetworkDisconnectMessage),u("#lc_chat_header").addClass("lc-inactive"),this.agentDisconnectTimer||(this.agentDisconnectTimer=setTimeout((t=this),r.TIME.AGENT_LEFT))},e.prototype.agentNetworkDisconnected=function(e){var t;this.showAgentDisconnectMessage(this.widget.agentNetworkDisconnectMessage),this.stopAgentDisconnectTimer(),this.stopAgentNetworkDisconnectTimer(),u("#lc_chat_header").addClass("lc-inactive"),this.agentNetworkDisconnectTimer||(this.agentNetworkDisconnectTimer=setTimeout((t=this,function(){e.agentId=t.chat.agentId,t.chat.agentNetworkDisconnected=!0}),r.TIME.AGENT_NETWORK_DISCONNECT))},e.prototype.stopAgentDisconnectTimer=function(){this.agentDisconnectTimer&&(clearTimeout(this.agentDisconnectTimer),this.agentDisconnectTimer=null,this.chat.agentDisconnected=!1)},e.prototype.stopAgentNetworkDisconnectTimer,e.prototype.agentNetworkConnected=function(e){u("#lc_chat_header").removeClass("lc-inactive"),u("#lc_agent_left_msg").remove(),this.stopAgentNetworkDisconnectTimer()},e.prototype.chatExpireTimerOn=function(e,t){var n,i;this.chatExpireTimer||(n=e&&0<=e?e:r.TIME.CHAT_EXPIRE,this.chatExpireTimer=setTimeout((i=this,function(){i.chat.id=null,i.chat.active=!1,i.chat.agentNameCached=null,i.clearAgentName()}),n))},e.prototype.chatExpireTimerOff=function(){clearTimeout(this.chatExpireTimer),this.chatExpireTimer=null,this.chat.active=!0,this.chat.agentNameCached=null},e.prototype.closeSupport=function(){return this.widget.offlineChat&&(this.widget.offlineChat=!1),l.CoBrowseView.setLocalStorage("livechat_support","false"),u("#lc_cb_actions_vi").remove(),u("#lc_chat_layout").remove()},e.prototype.closeChat=function(e){var t;this.chat.ongoing&&(this.chat.isInActive()?(t={type:"visitor",userId:e.agentId,siteId:this.widget.siteId,chatId:e.chatId,visitorId:this.visitor.getId(),fromVisitor:!0,closed:!0,url:this.widget.siteUrl,closeByVistior:!0},l.client.pushToServer("visitor endchat",t)):e.closeByVistior&&((t=e).closed=!0,l.client.pushToServer("visitor endchat",t))),window.LIVECHAT_SUPPORT&&(this.closeSupport(),l.client&&l.client.primary&&l.client.primary.pushToVisitorTabs("force disconnect",{force_disconnect:!0}),this.visitor.resetVisitor(),this.widget.resetWidget(),this.chat.resetChat(),l.Sound.resetSound(),l.ChatView.resetChatView(),l.OfflineView.resetOfflineView(),l.CoBrowseView.resetCoBrowseView(),l.MainView.resetMainView())},e.prototype.postChatCloseEvents=function(e){var t;t=null,this.chat.ongoing=!1,this.chat.closed=!0,e.emptyChat&&(t=0),this.chat.agentNameCached=this.chat.getAgentName(),this.chatExpireTimerOn(t),this.chat.agentNetworkDisconnected?(this.chat.id="",this.showAgentLeftMessage(this.widget.agentDisconnectedMessage,e.CbActive),this.disableClose()):this.chat.agentDisconnected?this.disableClose():e.visitorClosedChat||e.isClosedByVisitor||(this.widget.thanksMessage&&this.addDefaultMessage(this.widget.thanksMessage),this.disableClose()),e.visitorClosedChat&&(u(".lc-end-chat").addClass("hide"),u("#lc_chat_message_window").empty(),this.disableClose(),this.collapse(),this.chat.visitorClosedChat=!0),this.setTitle(),this.chat.clearAgentProfilePicture()},e.prototype.showAgentLeftMessage=function(e,t){var n,i;n=e||this.widget.agentLeftMessage,t?this.addNotification(livechat.defaultMessages.cobrowsing_stop_msg):n&&(i=this.chat.getAgentName(),n=(n=n.replace("{{agent_name}}",i).replace("$",i)).replace("{{helpdesk_name}}",this.widget.helpdeskName||""),this.addNotification(n))},e.prototype.showAgentDisconnectMessage=function(e){var t;return t=this.chat.getAgentName(),e=(e=e.replace(/{{agent_name}}/g,t).replace("$",t)).replace(/{{helpdesk_name}}/g,this.widget.helpdeskName||""),u("#lc_agent_profile_pic,#lc_chat_title").addClass("inactive"),this.addNotification(e,!0)},e.prototype.showChatTransferredMessage=function(){var e,t;(e=this.widget.trasferredMessage)&&(t=this.chat.getAgentName(),e=(e=e.replace("{{agent_name}}",t).replace("$",t)).replace("{{helpdesk_name}}",this.widget.helpdeskName||""),this.addPresistNotification(e))},e.prototype.expand=function(e){var t,n,i,r,o;r=u("#lc_chat_layout"),n=u("#lc_chat_container"),i=u("#lc_chat_header"),e&&!window.LIVECHAT_SUPPORT?(t="lc-expanded lc-prechat",o="lc-collapsed lc-alert lc-chat lc-offline",r.find("#lc_prechat_form").length||(l.MainView.renderPreChatForm(),l.MainView.registerPreChatFormDOMEvents(),l.MainView.registerCoBrowseDOMEvents()),u("#lc-close").addClass("hide")):this.widget.offlineChat?(t="lc-expanded lc-offline",o="lc-collapsed lc-alert lc-prechat lc-chat",u("#lc-close").addClass("hide")):(t="lc-expanded lc-chat",o="lc-collapsed lc-alert lc-prechat lc-offline"),this.isChatInProgress(),r.removeClass(o).addClass(t),this.isMobileBrowser||this.isSmallWindow()||r.css("height",n.outerHeight()+i.outerHeight()+"px"),this.setTitle(),this.chat.cachedPing||this.widget.offlineChat||this.showWelcomeMessage(),u(":focus").is("input")||l.isMobileBrowser||this.setInputElementFocus(),window.LIVECHAT_SUPPORT&&this.showChatClose()},e.prototype.collapse=function(){var e,t;t=u("#lc_chat_layout"),e=u("#lc_chat_header"),t.removeClass("lc-expanded "+this.blinkStyle()).addClass("lc-collapsed"),this.isChatInProgress(),this.isMobileBrowser||this.isSmallWindow()||t.css("height",e.outerHeight()+"px"),this.setTitle()},e.prototype.blinkStyle,e.prototype.setInputElementFocus=function(){var e,t;t=u("#lc_chat_"+(this.offline?"name":"offline_name")),e=t.length?t.attr("id"):"lc_chat_input_container",setTimeout,600)},e.prototype.flashPageTitle=function(e,t){var n,i;n=e+": "+t,this.cancelFlashTitleTimer(),this.titleTimer=setInterval((i=this),1e3),this.isMinimized()&&u("#lc_chat_layout").addClass(this.blinkStyle()).find("#lc_chat_title").html(n)},e.prototype.cancelFlashTitleTimer,e.prototype.startFlashTitleTimer=function(e){document.title=document.title===this.pageTitle?e:this.pageTitle,l.MainView.pageActive&&(document.title=this.pageTitle,this.cancelFlashTitleTimer())},e.prototype.endChat=function(){var e;return e={siteId:this.widget.siteId,userId:this.chat.agentId,username:this.chat.getAgentName(),chatId:this.chat.id,type:"visitor",participantId:this.visitor.getId(),fromVisitor:!0,url:this.widget.siteUrl,closeByVistior:!0},this.closeChat(e)},e.prototype.isChatInProgress=function(){return this.chat.isActive()&&!this.chat.closed?(u("#lc_chat_layout").addClass("lc-active"),this.enableClose()):(u("#lc_chat_layout").removeClass("lc-active"),this.disableClose())},e.prototype.resetChatView=function(){this.stopMoreWaitingTimer(),this.stopNonAvailabilityTimer(),this.stopAgentDisconnectTimer(),this.stopAgentNetworkDisconnectTimer(),l.ChatView=new e},e.prototype.isSmallWindow,e.prototype.triggerEvent=function(e,t){var n;window.Event&&document.dispatchEvent&&((n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,t),document.dispatchEvent(n))},e}(),l.ChatView=new e}.call(this),function(){var l,u,i,e,n,s=[].indexOf|;l=window.livechat,i=l.Constants,u=l.jQuery,n=l._,e=function(){function e(){this.widget=l.Widget,this.visitor=l.Visitor,this.chat=l.Chat,this.sound=l.Sound,this.chatView=l.ChatView,this.messageSent=!1,this.chatId=null}return e.prototype.render=function(e){var t;this.widget.offlineChat=!0,window.LIVECHAT_SUPPORT||u("#lc-close").addClass("hide"),u("#lc_chat_layout").removeClass("lc-prechat lc-chat lc-offline").addClass("lc-offline"),t={nonAvailabilityMessage:this.widget.nonAvailabilityMessage,fields:this.widget.offlineChatFields},this.chat&&this.chat.cachedPing&&this.chat.cachedPing.msg&&this.chat.cachedPing.msg.length?t.msg=this.chat.cachedPing.msg.join("\n"):t.msg="",u("#lc_chat_layout #lc_chat_window").before(n.template(l.templates.offline,t)),this.chatView.setTitle(this.widget.offlineChatSettings.messages.title),this.registerWidgetDOMEvents(),this.chat.missed&&this.startOfflineSubmitTimer()},e.prototype.registerWidgetDOMEvents=function(){return u("#lc_offline_submit").on("click",(e=this,function(){e.createOfflineChat()}));var e},e.prototype.startOfflineSubmitTimer=function(){var e,t,n;this.offlineSubmitTimer||(t=0,(e=this.chat.getCachedPing())&&(t=(new Date).getTime()-(e.pingCreatedAt+2*i.TIME.WAIT_MESSAGE)),this.offlineSubmitTimer=setTimeout((n=this,function(){n.offlineSubmitTimer&&(n.sendOfflineChatEvent(null,!1),n.chat.removeCachedPing())}),i.TIME.MISSED_CHAT_FORM-t))},e.prototype.sendOfflineChatEvent=function(e,t,i){var n;(n=this.chatView.getVisitorDetails()).widgetId=this.widget.id,n.siteId=this.widget.siteId,n.id=this.visitor.getId(),n.chatType=this.chat.missed?"missed":"offline",n.createTicket=t,this.messageSent&&this.chatId&&(n.chatId=this.chatId),this.messageSent=!0,n.message=e||void 0,u.ajax({type:"POST",url:this.widget.nodeUrl+"/visitors/missedChat",data:n,dataType:"json",cache:!1,context:this,success:function(e){var t;return this.chat.active=!1,(null!=e&&null!=(t=e.data)?t.chatId:void 0)&&(this.chatId=e.data.chatId),l.client&&l.client.primary&&l.client.primary.pushToVisitorTabs("force disconnect",{force_disconnect:!0}),i(!0)},error:function(e,t,n){return window.console&&console.log&&console.log("error getting ",n,", responseText: ",e.responseText),i(!1,e.responseText)}})},e.prototype.createOfflineChat=function(){var e,n;this.validateOfflineForm()&&(this.saveOfflineFormFields(),this.chat.removeCachedPing(),this.stopOfflineSubmitTimer(),e=u("#lc_chat_offline_textarea").val(),this.sendOfflineChatEvent(e,!0,(n=this,function(e,t){return e?n.showThanksMessage():n.showErrorMessage(t)})))},e.prototype.validateOfflineForm=function(){var e,t,n,i,r,o,s,a,c;for(i={},o=!0,s=0,a=(c=u("#lc_offline_chat_form input, #lc_offline_chat_form textarea")).length;s<a;s++)if(e=c[s],n=(e=u(e)).attr("id").replace("lc_chat_offline_",""),r=u.trim(e.val()),i[n]=l.MainView.escapeHtml(r),(t=this.widget.offlineChatFields[n]).value=l.MainView.escapeHtml(r),!t.isValid()){e.addClass("lc-input-error"),o=!1;break}return o},e.prototype.saveOfflineFormFields=function(){var e,t,n,i,r,o;for(t in o=["textarea"],i=this.widget.offlineChatFields)r=(e=i[t]).name,s.call(o,r)<0&&(n="set"+e.name.charAt(0).toUpperCase()+e.name.substr(1).toLowerCase(),this.visitor[n].call(this.visitor,e.value))},e.prototype.stopOfflineSubmitTimer=function(){window.clearTimeout(this.offlineSubmitTimer=null)},e.prototype.showThanksMessage=function(){var e,t,n;t=u("#lc_chat_layout"),e=u("#lc_chat_header"),n=this.widget.offlineChatSettings.messages,u("#lc_chat_title").html(n.thank_header),u("#lc_chat_container").html("<p class='lc-offline-message'>"+n.thank+"<p>"),t.addClass("lc-thank-message"),u(".lc-thank-message").css("height",u(".lc-offline-message").outerHeight()+e.outerHeight()+"px")},e.prototype.showErrorMessage=function(e){var t,n,i,r;t=(e=JSON.parse(e)).message,i=u("#lc_chat_layout"),n=u("#lc_chat_header"),r=this.widget.offlineChatSettings.messages,u("#lc_chat_title").html(r.thank_header),u("#lc_chat_container").html("<p class='lc-offline-message'>"+t+"<p>"),i.addClass("lc-thank-message"),u(".lc-thank-message").css("height",u(".lc-offline-message").outerHeight()+n.outerHeight()+"px")},e.prototype.resetOfflineView=function(){this.stopOfflineSubmitTimer(),l.OfflineView=new e},e}(),l.OfflineView=new e}.call(this),function(){var o,s,n,e;o=window.livechat,n=o.Constants,s=o.jQuery,o._,e=function(){function e(){this.visitor=o.Visitor,this.cache=o.Cache,this.chatView=o.ChatView,this.mainView=o.MainView,this.widget=o.Widget,this.tabId=this.generateTabId(),window.addEventListener("storage",this.message_receive,!1)}return e.prototype.initialize=function(){var e;s("html").addClass("lc-cb-container-vi"),OneClickCbUtils.setCallback(function(e,t){switch(t){case"control transfer complete":return s("html").addClass("lc-cb-controlling-vi");case"Agent has given the control to you.":return s("html").removeClass("lc-cb-controlling-vi");case"control transferred to agent":case"Agent has taken the control back.":return s("html").addClass("lc-cb-controlling-vi");case"cbStop":return o.CoBrowseView.coBrowseStopped()}}),OneClickCbUtils.isCobrowseActive()&&(e="true"+(new Date).getTime(),this.setLocalStorage("cb_initiate",e),this.cobrowsingStart("cobrowsing is on"),OneClickCbUtils.master.cbMaster||s("html").addClass("lc-cb-controlling-vi")),"true"===this.getLocalStorage("CBSessionRequest")?this.requestCoBrowsingSession():"true"===sessionStorage.getItem("CBControlRequest")&&s("html").addClass("lc-cb-notify-vi ").removeClass("lc-cb-default-vi ")},e.prototype.requestCoBrowsingSession=function(e){var t;if(!this.unsupportedProtocol(e)&&(e&&e.location_protocol&&this.cache.setItem("livechat_cb_agent_protocol",e.location_protocol),!OneClickCbUtils.isCobrowseActive()&&!this.isAgentBusy()))return s("html").addClass("lc-cb-container-vi lc-cb-active-vi lc-cb-request-vi"),this.setLocalStorage("CBSessionRequest","true"),e&&e.id&&this.setLocalStorage("CBSessionRequestChatId",e.id),t=0,null!==this.getLocalStorage("CBVisitorReqStartTime")&&0!==this.getLocalStorage("CBVisitorReqStartTime")?t=Date.now()-this.getLocalStorage("CBVisitorReqStartTime"):this.setLocalStorage("CBVisitorReqStartTime",Date.now()),0<(t=n.TIME.CB_REQ_TIMEOUT-t)?this.cbTimerHandle=window.setTimeout(this.clearReq,t):(s("html").removeClass("lc-cb-active-vi lc-cb-request-vi"),o.CoBrowseView.setLocalStorage("CBSessionRequest","false"),this.setLocalStorage("CBVisitorReqStartTime",0)),this.disableCobrowsingButton()},e.prototype.clearReq=function(){var e;o.CoBrowseView.setLocalStorage("CBVisitorReqStartTime",0),OneClickCbUtils.isCobrowseActive()||(o.CoBrowseView.cbTimerHandle&&window.clearInterval(o.CoBrowseView.cbTimerHandle),s("html").removeClass("lc-cb-active-vi lc-cb-request-vi"),o.CoBrowseView.setLocalStorage("CBSessionRequest","false"),e={id:o.CoBrowseView.chatView.chat.id,userName:o.CoBrowseView.visitor.getName()||o.CoBrowseView.visitor.getId(),agentId:o.CoBrowseView.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(e.socket=o.client.chat_socket.io.engine.id),o.client.pushToServer("cobrowse session timeout",e))},e.prototype.setLocalStorage=function(e,t){var n;if(this.getLocalStorage(e)!==t)return n={id:this.tabId,value:t},n=JSON.stringify(n),this.cache.setItem(e,n)},e.prototype.getLocalStorage=function(e){var t,n;try{if(t=this.cache.getItem(e))return JSON.parse(t).value}catch(e){n=e,console.log("parsing failed with error:",n)}return null},e.prototype.generateTabId=function(){var e;return e=OneClickCbUtils.tabId?OneClickCbUtils.tabId:OneClickCbUtils.generateId(),OneClickCbUtils.tabId=e},e.prototype.unsupportedProtocol=function(e){var t,n;return(n=void 0!==e&&"https:"===e.location_protocol&&e.location_protocol!==window.location.protocol)&&(t={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(t.socket=o.client.chat_socket.io.engine.id),this.setLocalStorage("CBSessionRequest","false"),o.client.pushToServer("cobrowse upsupported protocol",t)),n},e.prototype.isAgentBusy=function(){var e,t;return(e="true"===sessionStorage.getItem("CBActive")||"PENDING"===sessionStorage.getItem("CBRequest"))&&(t={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(t.socket=o.client.chat_socket.io.engine.id),this.setLocalStorage("CBSessionRequest","false"),o.client.pushToServer("cobrowse agent busy",t)),e},e.prototype.cobrowsingRequestAccepted=function(){return this.chatView.addNotification(livechat.defaultMessages.cobrowsing_start_msg),this.cobrowsingStart(),this.sendCoBrowseLink(this.getCobrowseLink()),s("html").removeClass("lc-cb-request-vi"),s("html").addClass("lc-cb-default-vi lc-cb-controlling-vi"),createCanvas("cb-block-canvas","99990","block"),chatjQuery("#cb-block-canvas").show(),this.setLocalStorage("CBSessionRequest","false")},e.prototype.cobrowsingRequestDenied=function(){return this.coBrowseSessionRejected(),s("html").removeClass("lc-cb-active-vi lc-cb-request-vi lc-cb-controlling-vi"),this.enableCobrowsingButton()},e.prototype.cobrowsingStart=function(){var e,t,n,i;return t=this.visitor.name||this.cache.getItem("livechat_vname"),this.chatView.agentName||this.cache.getItem("livechat_agent_name"),i=this.widget.siteId,e=this.getLocalStorage("CBSessionRequestChatId")||this.chatView.chat.id,n=sessionStorage.getItem("cbSdata")||this.widget.sessionHash,OneClickCbUtils.cobrowsingStart(t,"visitor",0,n,i,e),OneClickCbUtils.callBack("info","started"),s("html").addClass("lc-cb-container-vi lc-cb-active-vi lc-cb-default-vi "),this.disableCobrowsingButton()},e.prototype.cobrowsingEnd=function(e){if("true"===this.getLocalStorage("CBSessionRequest")&&this.cobrowsingRequestDenied(),OneClickCbUtils.isCobrowseActive())return OneClickCbUtils.cobrowsingEnd(),this.coBrowseStopped(e)},e.prototype.getCobrowseLink=function(){return OneClickCbUtils.getCobrowseLink()},e.prototype.takeControl=function(){OneClickCbUtils.takeControl()?alert("now you are in control of page"):alert("Sorry, you are not master or cobrowsing hasn't been started yet")},e.prototype.giveControl=function(){OneClickCbUtils.giveControl()?OneClickCbUtils.callBack("info","GIVE CONTROL"):OneClickCbUtils.callBack("info","CONTROL GIVEN")},e.prototype.sendCoBrowseLink=function(e){return this.coBrowseStarted(e)},e.prototype.coBrowseStarted=function(e){var t;return t={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,agentId:this.chatView.chat.agentId,actualCreatedAt:(new Date).toUTCString(),signal:"started",roomName:OneClickCbUtils.getRoom(),coBrowsingURL:e},o.client.chat_socket&&(t.socket=o.client.chat_socket.io.engine.id),o.client.pushToServer("cobrowse started",t)},e.prototype.coBrowseStopped=function(e){var t;return this.cleanUpView(),this.enableCobrowsingButton(),t={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(t.socket=o.client.chat_socket.io.engine.id),void 0!==e&&void 0!==e.closeEvent||this.chatView.addNotification(livechat.defaultMessages.cobrowsing_stop_msg),o.client.pushToServer("cobrowse stopped",t)},e.prototype.cleanUpView,e.prototype.coBrowseSessionRejected=function(){var e;return e={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(e.socket=o.client.chat_socket.io.engine.id),this.setLocalStorage("CBSessionRequest","false"),o.client.pushToServer("cobrowse session rejected",e)},e.prototype.coBrowsingRequestCancelled=function(){var e;return s("html").removeClass("lc-cb-active-vi lc-cb-request-vi lc-cb-controlling-vi"),this.enableCobrowsingButton(),e={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(e.socket=o.client.chat_socket.io.engine.id),this.chatView.addNotification(livechat.defaultMessages.cobrowsing_cancel_visitor_msg),this.setLocalStorage("CBSessionRequest","false"),o.client.pushToServer("cobrowse request cancelled",e)},e.prototype.coBrowseControlRequest=function(){if(OneClickCbUtils.isCobrowseActive())return sessionStorage.setItem("CBControlRequest",!0),s("html").addClass("lc-cb-notify-vi ").removeClass("lc-cb-default-vi ")},e.prototype.denyCBSessionControl=function(){var e;return s("html").removeClass("lc-cb-notify-vi ").addClass("lc-cb-default-vi "),sessionStorage.removeItem("CBControlRequest"),e={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(e.socket=o.client.chat_socket.io.engine.id),o.client.pushToServer("cobrowse control rejected",e)},e.prototype.allowRequestedControl=function(){return s("html").removeClass("lc-cb-notify-vi ").addClass("lc-cb-default-vi "),sessionStorage.removeItem("CBControlRequest"),this.giveControl()},e.prototype.parseEvent=function(e){var t,n,i;try{return i=o.Cache.decode(e),(n=JSON.parse(i))?n.id===o.CoBrowseView.tabId?"same_tab":n.value:"null"}catch(e){return t=e,console.log("livechat error:",t),"null"}},e.prototype.message_receive=function(e){var t,n,i,r;if("CBSessionRequest"===e.key)"null"!==(t=o.CoBrowseView.parseEvent(e.newValue))&&"false"!==t||s("html").removeClass("lc-cb-active-vi lc-cb-request-vi lc-cb-controlling-vi");else if("livechat_support"===e.key){if(i=o.CoBrowseView.parseEvent(e.newValue),r=o.CoBrowseView.parseEvent(e.oldValue),"true"===i)return void o.MainView.render();"false"!==i&&"null"!==i||"true"!==r&&"same_tab"!==r||(o.CoBrowseView.cobrowsingEnd(),o.ChatView.endChat())}else if("cb_initiate"===e.key){if("same_tab"!==(t=o.CoBrowseView.parseEvent(e.newValue))&&OneClickCbUtils.isCobrowseActive())return n="true"+(new Date).getTime(),o.CoBrowseView.setLocalStorage("cb_initiate_stop",n)}else if("cb_initiate_stop"===e.key&&"same_tab"!==(t=o.CoBrowseView.parseEvent(e.newValue)))return o.CoBrowseView.resetCoBrowsing()},e.prototype.resetCoBrowsing=function(){if(OneClickCbUtils.isCobrowseActive())return OneClickCbUtils.cleanUpSession(),s("html").removeClass("lc-cb-active-vi lc-cb-controlling-vi lc-cb-default-vi"),this.enableCobrowsingButton()},e.prototype.disableCobrowsingButton,e.prototype.enableCobrowsingButton=function(){if(window.LIVECHAT_SUPPORT)return s(".lc-cb-btn").removeClass("disabled ")},e.prototype.resetCoBrowseView,e}(),o.CoBrowseView=new e}.call(this),function(){var a,l,e,n,c=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(a=window.livechat).Constants,l=a.jQuery,n=a._,e=function(){function e(){this.visitor=a.Visitor,this.widget=a.Widget,this.chat=a.Chat,this.chatView=a.ChatView,this.coBrowseView=a.CoBrowseView,this.offlineView=a.OfflineView,this.pageActive=!0,this.isMobileBrowser=!1,this.mainLayout="#lc_chat_layout",this.header="#lc_chat_header",this.container="#lc_chat_container",this.customWidget="#chat-widget",this.chatWindow="#lc_chat_window",this.close="#lc-close",this.closeConform="#lc-ec-ok",this.closeCanel="#lc-ec-cancel",this.endChatPopUp=".lc-end-chat"}return e.prototype.render=function(){this.visitor.initialize(),this.widget.initialize(),this.chat.initialize(),this.checkMobileBrowser(),this.chatView.initialize(),this.teamstatus(),this.coBrowseView.initialize(),this.triggerFDLCWidgetLoaded()},e.prototype.renderAgentSupport=function(){if("true"!==a.CoBrowseView.getLocalStorage("livechat_support"))return a.CoBrowseView.setLocalStorage("livechat_support","true"),this.render();this.chatView.expand(!1)},e.prototype.checkMobileBrowser=function(){var e;return e=navigator.userAgent||navigator.vendor||window.opera,this.isMobileBrowser=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)),this.isMobileBrowser},e.prototype.teamstatus=function(e){var t,i;t="siteId="+this.widget.siteId+"&vid="+this.visitor.getId()+"&c=fd",this.widget.id&&(t=t+"&widget_id="+this.widget.id),l.ajax({type:"GET",url:this.widget.nodeUrl+"/visitors/teamstatus",data:t,dataType:"json",cache:!1,success:(i=this,function(e){var t,n;!e||e.data&&e.data.disabledOrBlocked?console.log("Chat Disabled or Visitor blocked!"):((n=e.data).isVisitorLimitReached&&(i.widget.visitorLimitReached=!0),n.setting&&i.widget.updateSettings(n.setting,n.teamstatus),n.recentChatDetails&&i.chat.setRecentChatDetails(n.recentChatDetails),i.visitor.recentChatId=null!=(t=n.recentChatDetails)?t.chatId:void 0,n.isReturnVisitor&&!i.visitor.getVisitCount()&&i.visitor.incrementVisitCount(),i.widget.hideWidget?(i.hideCustomChatWidget(),i.hideNormalChatWidget()):(i.renderWidget(),i.registerWidgetDOMEvents(),i.customChatWidgetExists()&&i.chat.isInActive()&&i.hideNormalChatWidget(),i.widget.offlineChat?(i.offlineView.render(!1),window.LIVECHAT_SUPPORT&&(i.chatView.expand(!1),i.chatView.showChatClose())):(i.registerWindowDOMEvents(),i.registerCoBrowseDOMEvents(),window.LIVECHAT_SUPPORT||(i.renderPreChatForm(),i.registerPreChatFormDOMEvents()),i.registerTextContainerDOMEvents(),a.client=new a._Client(n.primary,n.auxiliary,n.appKeys),i.chat.isActive()||i.chat.cachedPing||window.LIVECHAT_SUPPORT?(i.isMobileBrowser?i.chatView.collapse():(i.chat.ongoing||i.chat.cachedPing||window.LIVECHAT_SUPPORT)&&i.chatView.expand(!1),a.client.connect(),window.LIVECHAT_SUPPORT&&i.chatView.showChatClose()):(i.startProactiveTimer(),i.triggerEventDocument(),-1===i.widget.sitesToSkipAutoConnect().indexOf(i.widget.siteId)&&(n.isVisitorLimitReached||i.visitor.startAutoConnectTimer())))))}),error:function(){window.console&&console.log&&console.log("Error while fetching agent's availability status")}})},e.prototype.startProactiveTimer=function(){var e;this.widget.proactiveChat&&-1<this.widget.proactiveTime&&(this.proactiveTimer=setTimeout((e=this,function(){e.chatView.isMinimized()&&!e.chatView.forceMinimized&&(l("#lc_chat_layout").show(),e.chat.proactive=!0,e.chatView.expand(!1))}),1e3*this.widget.proactiveTime))},e.prototype.hideCustomChatWidget=function(){l(this.customWidget).hide()},e.prototype.customChatWidgetExists,e.prototype.hideNormalChatWidget,e.prototype.renderWidget=function(){var e;e={widgetPosition:this.widgetPosition(),widgetColors:this.widgetColors(),widgetTitle:this.widgetTitle(),loaderMessage:this.widget.loaderMessage,messageBoxPlaceholder:this.widget.messageBoxPlaceholder},l("body").append(n.template(a.templates.chat,e))},e.prototype.widgetPosition=function(){var e,t,n,i;return n=this.widget.windowOffset,i="Bottom Left"===this.widget.windowPosition?"left:":"right:",e=this.mainLayout+" {"+i+n+"px} ",l("head").append("<style type='text/css'>"+e+"</style>"),t="Bottom Left"===this.widget.windowPosition?"lc-align-left":"lc-align-right",this.isMobileBrowser?t:""},e.prototype.widgetColors=function(){var e,t,n,i,r,o,s;return i=this.widget.windowColor,t=this.convert2Hex(i,30),400<(s=parseInt(i.substr(1,2),16)+parseInt(i.substr(3,2),16)+parseInt(i.substr(5,2),16))&&(e="lc-dark-icon"),r=400<s?r="#000000":"#FFFFFF",o=" "+this.mainLayout+" "+this.header+" {color:"+r+";background-color:"+i+"} ",n=" "+this.mainLayout+" "+this.container+"  {border-color: "+t+"} ",l("head").append("<style type='text/css'> "+o+" /*"+n+"*/ </style>"),{classes:e}},e.prototype.widgetTitle=function(){return this.chat.active&&!this.chat.closed?this.chat.getAgentName():this.widget.title},e.prototype.triggerCookieTest=function(){return window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname),l("#fc_chat_layout, #lc_chat_layout").append('<iframe id="testCookie" src='+window.livechat.Widget.nodeUrl+"/cookieTest?origin="+encodeURIComponent(window.location.origin)+' style="display:none"></iframe>'),window.addEventListener("message",function(e){var t;livechat.Widget.nodeUrl&&(t=window.livechat.Widget.nodeUrl.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n]+)/im),e.origin===t[0]&&(window.livechat.cookieTest=e.data))},!1)},e.prototype.triggerEventDocument=function(){var e;window.Event&&document.dispatchEvent&&((e=document.createEvent("CustomEvent")).initCustomEvent("lc_widget_loaded",!1,!0,!1),document.dispatchEvent(e))},e.prototype.triggerFDLCWidgetLoaded=function(){var e;window.Event&&document.dispatchEvent&&((e=document.createEvent("CustomEvent")).initCustomEvent("fd_lc_widget_loaded",!1,!0,!1),document.dispatchEvent(e))},e.prototype.convert2Hex=function(e,t){return e=e.replace("#",""),"rgba("+parseInt(e.substring(0,2),16)+","+parseInt(e.substring(2,4),16)+","+parseInt(e.substring(4,6),16)+","+(t/=100)+")"},e.prototype.renderPreChatForm=function(){var e,t;e=l(this.mainLayout),this.canShowPreform()&&(t={preChatMessage:this.widget.preChatMessage,fields:this.widget.preChatFields},e.find(this.chatWindow).before(n.template(a.templates.prechat,t)))},e.prototype.startChat=function(){this.validateForm()&&(this.saveFormFields(),this.chatView.expand(!1),this.chatView.sendMessageOrPing({detailsFromPreChatForm:!0}))},e.prototype.validateForm=function(){var e,t,n,i,r,o,s,a,c;for(i={},o=!0,s=0,a=(c=l("#lc_prechat_form input, #lc_prechat_form select")).length;s<a;s++)if(e=c[s],n=(e=l(e)).attr("id").replace("lc_chat_",""),r=l.trim(e.val()),i[n]=r,(t=this.widget.preChatFields[n]).value=r,!t.isValid()){"dropdown"===n?e.parent().addClass("lc-input-error"):e.addClass("lc-input-error"),o=!1;break}return o},e.prototype.saveFormFields=function(){var e,t,n,i,r,o,s,a;for(n in a=["textarea"],s=["name","email"],t=this.widget.offlineChat?this.widget.offlineChatFields:this.widget.preChatFields)r=(e=t[n]).name,c.call(a,r)<0&&e.value&&(i="set"+e.name.charAt(0).toUpperCase()+e.name.substr(1).toLowerCase(),this.visitor[i].call(this.visitor,this.escapeHtml(e.value)),o=e.name,0<=c.call(s,o)&&(this.widget.offlineChat?this.widget.preChatFields[n].value=e.value:this.widget.offlineChatFields[n].value=e.value))},e.prototype.registerPreChatFormDOMEvents=function(){var t,e;return l("#lc_prechat_form :input").on("keydown",(t=this,function(e){l(e.target).removeClass("lc-input-error"),13!==e.keyCode||e.shiftKey||(e.preventDefault(),t.startChat())})),l("#lc_prechat_submit").on("click",(e=this,function(){e.startChat()})),l("#lc_prechat_form").on("change","select",function(e){var t,n;(n=l(e.target)).parent().removeClass("lc-input-error"),"-1"!==(t=n.val())&&-1!==t||(t="..."),n.prev().html(t)}),l("#lc_chat_message_window").on("mousewheel",function(e){var t;if(0===(t=e.originalEvent.wheelDelta||-e.originalEvent.detail))return!1;l("#lc_chat_message_window").get(0).scrollTop+=30*(t<0?1:-1),e.preventDefault()})},e.prototype.registerCoBrowseDOMEvents=function(){var e,t,n,i,r,o,s;return l(".lc-cb-stop-vi").on("click",(e=this,function(){e.coBrowseView.cobrowsingEnd()})),l(".lc-cb-take-control-vi").on("click",(t=this,function(){t.coBrowseView.takeControl()})),l(".lc-cb-give-control-vi").on("click",(n=this,function(){n.coBrowseView.giveControl()})),l("#deny_cb_session_vi").on("click",(i=this,function(){i.coBrowseView.cobrowsingRequestDenied()})),l("#allow_cb_session_vi").on("click",(r=this,function(){r.coBrowseView.cobrowsingRequestAccepted()})),l(".lc-cb-button-allow-vi").on("click",(o=this,function(){o.coBrowseView.allowRequestedControl()})),l(".lc-cb-button-deny-vi").on("click",(s=this,function(){s.coBrowseView.denyCBSessionControl()}))},e.prototype.registerTextContainerDOMEvents=function(){var n,i,r;(n=l("#lc_chat_input_container")).on("keydown",(i=this,function(e){var t;13!==e.keyCode||e.shiftKey?i.isValidKey(e)&&i.chat.isActive()&&i.chatView.triggerTyping():(e.preventDefault(),(t=l.trim(n.val()))&&(i.chatView.sendMessageOrPing({msg:t}),n.val("")),self.isMobileBrowser&&n.blur())})),l("#lc_button_send").on("click",(r=this,function(e){var t;n=l("#lc_chat_input_container"),(t=l.trim(n.val()))&&(r.chatView.sendMessageOrPing({msg:t}),n.val(""))}))},e.prototype.registerWidgetDOMEvents=function(){var e,t,n,i,r,o,s;l(window).focus((t=this,function(){t.pageActive=!0})).blur((e=this,function(){e.pageActive=!1})),l(this.header).on("click",(n=this,function(e){n.chatView.isMinimized()?(n.chatView.forceMinimized=!1,n.chatView.expand(n.canShowPreform())):(n.chatView.forceMinimized=!0,n.chatView.collapse())})),l(this.close).on("click",(i=this,function(e){return e.stopPropagation(),i.chatView.isMinimized()&&i.chatView.expand(),window.LIVECHAT_SUPPORT&&a.Widget.offlineChat&&l(".lc-offline-message").is(":visible")?i.chatView.endChat():(l(i.endChatPopUp+" p").html(i.widget.endChatConfirmMessage),l(i.endChatPopUp).removeClass("hide"))})),l(this.closeCanel).on("click",(r=this,function(e){return l(r.endChatPopUp).addClass("hide"),l(r.close).removeAttr("disabled",!0),l(r.close).css("pointer-events","auto")})),l(this.closeConform).on("click",(o=this,function(e){return o.coBrowseView.cobrowsingEnd(),o.chatView.endChat(),o.chatView.collapse()})),l(this.customWidget).click((s=this,function(){l(s.mainLayout).is(":visible")||(l(s.mainLayout).toggle(),s.chatView.forceMinimized=!1,s.chatView.expand(s.canShowPreform()))}))},e.prototype.registerWindowDOMEvents=function(){var e;l(window).on("beforeunload",(e=this,function(){a.client.isConnected()&&(a.client.pushToServer("visitor unload",{chatId:e.chat.id,pageUnload:!0,agentId:e.chat.agentId}),e.chat.isActive()&&e.chatView.chatExpireTimerOn(null,!0),a.client.disconnect()),window.LIVECHAT_SUPPORT&&a.Cache.removeItem("livechat_vid")}))},e.prototype.isValidKey=function(e){var t,n;return t=!0,n=[9,16,17,18,27,37,38,39,40,224],(""===l(e.target).val()||e.metaKey||e.ctrlKey||0<=n.indexOf(e.keyCode))&&(t=!1),t},e.prototype.escapeHtml=function(e){var t;return t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},String(e).replace(/[&<>"']/g,function(e){return t[e]})},e.prototype.canShowPreform=function(){return this.widget.preChatForm&&this.chat.isInActive()&&!this.chat.pingSent},e.prototype.resetMainView=function(){a.client&&a.client.primary&&a.client.primary.reset(),a.MainView=new e},e}(),a.MainView=new e}.call(this),function(){var e;(e=window.livechat).JSON3=JSON3.noConflict(),e.MainView.render()}.call(this);