;/*!visitor/common/lib/json3.js*/
(function(){ar a="function"==typeof define&&define.amd,h={"function":!0,object:!0},g=h[typeof exports]&&exports&&!exports.nodeType&&exports,y=h[typeof window]&&window||this,b=g&&h[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(y&&(!b||b.global!==b&&b.window!==b&&b.self!==b||(y=b)),g&&!a)c(y,g);else{var v=y.JSON,C=y.JSON3,S=!1,O=c(y,y.JSON3={noConflict:);y.JSON?(y.JSON.parse||(y.JSON.parse=O.parse),y.JSON.stringify||(y.JSON.stringify=O.stringify)):y.JSON={parse:O.parse,stringify:O.stringify}}}).call(this);
;/*!visitor/common/js/cometd.js*/
(function(){this.org=this.org||{},org.cometd={},org.cometd.JSON={},org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(){throw"Abstract"},org.cometd.Utils={},org.cometd.Utils.isString=function(a){return void 0===a||null===a?!1:"string"==typeof a||a instanceof String},org.cometd.Utils.isArray=function(a){return void 0===a||null===a?!1:a instanceof Array},org.cometd.Utils.inArray=org.cometd.Utils.setTimeout=function(a,c,g){return window.setTimeout(g)},org.cometd.Utils.clearTimeout=function(a){window.clearTimeout(a)},org.cometd.TransportRegistry=function(){var a=[],c={};this.getTransportTypes=this.findTransportTypes=function(g,h,v){for(var b=[],i=0;i<a.length;++i){var T=a[i];c[T].accept(g,h,v)===!0&&b.push(T)}return b},this.negotiateTransport=function(g,h,v,b){for(var i=0;i<a.length;++i)for(var T=a[i],y=0;y<g.length;++y)if(T===g[y]){var _=c[T];if(_.accept(h,v,b)===!0)return _}return null},this.add=this.find=this.remove=this.clear=this.reset=function(){for(var i=0;i<a.length;++i)c[a[i]].reset()}},org.cometd.Transport=function(){var a,c;this.registered=this.unregistered=this._debug=function(){c._debug.apply(c,arguments)},this._mixin=function(){return c._mixin.apply(c,arguments)},this.getConfiguration=function(){return c.getConfiguration()},this.getAdvice=function(){return c.getAdvice()},this.setTimeout=this.clearTimeout=this.convertToMessages=function(a){if(org.cometd.Utils.isString(a))try{return org.cometd.JSON.fromJSON(a)}catch(x){throw this._debug("Could not convert to JSON the following string",'"'+a+'"'),x}if(org.cometd.Utils.isArray(a))return a;if(void 0===a||null===a)return[];if(a instanceof Object)return[a];throw"Conversion Error "+a+", typeof "+typeof a},this.accept=function(){throw"Abstract"},this.getType=function(){return a},this.send=function(){throw"Abstract"},this.reset=function(){this._debug("Transport",a,"reset")},this.abort=this.toString=,org.cometd.Transport.derive=org.cometd.RequestTransport=function(){unction c(a,c){if(this.transportSend(a,c),c.expired=!1,!a.sync){var g=this.getConfiguration().maxNetworkDelay,h=g;c.metaConnect===!0&&(h+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",h,"ms for the response, maxNetworkDelay",g);var v=this;c.timeout=this.setTimeout(h)}}nction v(c,h){var v=org.cometd.Utils.inArray(c,k);if(v>=0&&k.splice(v,1),C.length>0){var b=C.shift(),T=b[0],y=b[1];if(this._debug("Transport dequeued request",y.id),h)this.getConfiguration().autoBatch&&a.call(this,T),g.call(this,T),this._debug("Transport completed request",c.id,T);else{var _=this;this.setTimeout(0)}}}function b(a){if(null!==w)throw"Concurrent metaConnect requests not allowed, request id="+w.id+" not yet completed";var g=++_;this._debug("Transport",this.getType(),"metaConnect send, request",g,"envelope",a);var h={id:g,metaConnect:!0,envelope:a};c.call(this,a,h),w=h}var T=new org.cometd.Transport,y=org.cometd.Transport.derive(T),_=0,w=null,k=[],C=[];return y.complete=y.transportSend=function(){throw"Abstract"},y.transportSuccess=y.transportFailure=y.send=y.abort=function(){T.abort();for(var i=0;i<k.length;++i){var a=k[i];a&&(this._debug("Aborting request",a),this.abortXHR(a.xhr)||this.transportFailure(a.envelope,a,{reason:"abort"}))}w&&(this._debug("Aborting metaConnect request",w),this.abortXHR(w.xhr)||this.transportFailure(w.envelope,w,{reason:"abort"})),this.reset()},y.reset=function(){T.reset(),w=null,k=[],C=[]},y.abortXHR=function(a){if(a)try{var c=a.readyState;return a.abort(),c!==XMLHttpRequest.UNSENT}catch(x){this._debug(x)}return!1},y.xhrStatus=y},org.cometd.LongPollingTransport=function(){var a=new org.cometd.RequestTransport,c=org.cometd.Transport.derive(a),g=!0;return c.accept=c.xhrSend=function(){throw"Abstract"},c.transportSend=function(a,c){this._debug("Transport",this.getType(),"sending request",c.id,"envelope",a);var h=this;try{var v=!0;c.xhr=this.xhrSend({transport:this,url:a.url,sync:a.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(a.messages),onSuccess:onError:),v=!1}catch(x){g=!1,this.setTimeout(function(){h.transportFailure(a,c,{exception:x})},0)}},c.reset=c},org.cometd.CallbackPollingTransport=function(){ar c=new org.cometd.RequestTransport,g=org.cometd.Transport.derive(c),h=2e3;return g.accept=function(){return!0},g.jsonpSend=g.transportSend=function(c,g){for(var v=this,b=0,T=c.messages.length,y=[];T>0;){var _=org.cometd.JSON.toJSON(c.messages.slice(b,b+T)),w=c.url.length+encodeURI(_).length;if(w>h){if(1===T){var x="Bayeux message too big ("+w+" bytes, max is "+h+") for transport "+this.getType();return void this.setTimeout(a.call(this,c,g,x),0)}--T}else y.push(T),b+=T,T=c.messages.length-b}var k=c;if(y.length>1){var C=0,S=y[0];this._debug("Transport",this.getType(),"split",c.messages.length,"messages into",y.join(" + ")),k=this._mixin(!1,{},c),k.messages=c.messages.slice(C,S),k.onSuccess=c.onSuccess,k.onFailure=c.onFailure;for(var i=1;i<y.length;++i){var U=this._mixin(!1,{},c);C=S,S+=y[i],U.messages=c.messages.slice(C,S),U.onSuccess=c.onSuccess,U.onFailure=c.onFailure,this.send(U,g.metaConnect)}}this._debug("Transport",this.getType(),"sending request",g.id,"envelope",k);try{var I=!0;this.jsonpSend({transport:this,url:k.url,sync:k.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(k.messages),onSuccess:onError:),I=!1}catch(R){this.setTimeout(0)}},g},org.cometd.WebSocketTransport=function(){function a(){if(!C){C=!0;var a=h.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",a);var c;try{var g=h.getConfiguration().protocol;c=g?new org.cometd.WebSocket(a,g):new org.cometd.WebSocket(a),window._self_webSocket=c}catch(x){throw T=!1,this._debug("Exception while creating WebSocket object",x),x}_=h.getConfiguration().stickyReconnect!==!1;var v=this,b=null,y=h.getConfiguration().connectTimeout;y>0&&(b=this.setTimeout(function(){b=null,v._debug("Transport",v.getType(),"timed out while connecting to URL",a,":",y,"ms");var g={code:1e3,reason:"Connect Timeout"};v.webSocketClose(c,g.code,g.reason),v.onClose(c,g)},y));var w=function(){v._debug("WebSocket opened",c),C=!1,b&&(v.clearTimeout(b),b=null),S?(h._warn("Closing Extra WebSocket Connections",c,S),v.webSocketClose(c,1e3,"Extra Connection")):v.onOpen(c)},k=function(a){a=a||{code:1e3},v._debug("WebSocket closing",c,a),C=!1,b&&(v.clearTimeout(b),b=null),null!==S&&c!==S?v._debug("Closed Extra WebSocket Connection",c):v.onClose(c,a)},U=function(a){v._debug("WebSocket message",a,c),c!==S&&h._warn("Extra WebSocket Connections",c,S),v.onMessage(c,a)};c.onopen=w,c.onclose=k,c.onerror=c.onmessage=U,this._debug("Transport",this.getType(),"configured callbacks on",c)}}function c(a,c,g){var h=org.cometd.JSON.toJSON(c.messages);a.send(h),this._debug("Transport",this.getType(),"sent",c,"metaConnect =",g);var v=this.getConfiguration().maxNetworkDelay,b=v;g&&(b+=this.getAdvice().timeout,U=!0);for(var T=this,y=[],i=0;i<c.messages.length;++i)!function(){var g=c.messages[i];g.id&&(y.push(g.id),k[g.id]=this.setTimeout(function(){T._debug("Transport",T.getType(),"timing out message",g.id,"after",b,"on",a);var c={code:1e3,reason:"Message Timeout"};T.webSocketClose(a,c.code,c.reason),T.onClose(a,c)},b))}();this._debug("Transport",this.getType(),"waiting at most",b,"ms for messages",y,"maxNetworkDelay",v,", timeouts:",k)}function g(g,h,v){try{null===g?a.call(this):c.call(this,g,h,v)}catch(x){this.setTimeout(function(){h.onFailure(g,h.messages,{exception:x})},0)}}var h,v=new org.cometd.Transport,b=org.cometd.Transport.derive(v),T=!0,y=!1,_=!0,w={},k={},C=!1,S=null,U=!1,I=null;return b.reset=function(){v.reset(),T=!0,y=!1,_=!0,w={},k={},C=!1,U=!1},b.onOpen=function(a){this._debug("Transport",this.getType(),"opened",a),S=a,y=!0,this._debug("Sending pending messages",w);for(var g in w){var h=w[g],v=h[0];if(v){var b=h[1];I=v.onSuccess,c.call(this,a,v,b)}}},b.onMessage=function(a,c){this._debug("Transport",this.getType(),"received websocket message",c,a);for(var g=!1,h=this.convertToMessages(c.data),v=[],i=0;i<h.length;++i){var b=h[i];if((/^\/meta\//.test(b.channel)||void 0===b.data)&&b.id){v.push(b.id);var T=k[b.id];T&&(this.clearTimeout(T),delete k[b.id],this._debug("Transport",this.getType(),"removed timeout for message",b.id,", timeouts",k))}"/meta/connect"===b.channel&&(U=!1),"/meta/disconnect"!==b.channel||U||(g=!0)}for(var y=!1,_=0;_<v.length;++_){var C=v[_];for(var S in w){var R=S.split(","),E=org.cometd.Utils.inArray(C,R);if(E>=0){y=!0,R.splice(E,1);var L=w[S][0],A=w[S][1];delete w[S],R.length>0&&(w[R.join(",")]=[L,A]);break}}}y&&this._debug("Transport",this.getType(),"removed envelope, envelopes",w),I.call(this,h),g&&this.webSocketClose(a,1e3,"Disconnect")},b.onClose=function(a,c){this._debug("Transport",this.getType(),"closed",a,c),T=_&&y;var g=k;k={};for(var h in g)this.clearTimeout(g[h]);var v=w;w={};for(var b in v){var C=v[b][0],I=v[b][1];I&&(U=!1),C.onFailure(a,C.messages,{websocketCode:c.code,reason:c.reason})}S=null},b.registered=b.accept=function(){return T&&!!org.cometd.WebSocket&&h.websocketEnabled!==!1},b.send=function(a,c){this._debug("Transport",this.getType(),"sending",a,"metaConnect =",c);for(var h=[],i=0;i<a.messages.length;++i){var v=a.messages[i];v.id&&h.push(v.id)}w[h.join(",")]=[a,c],this._debug("Transport",this.getType(),"stored envelope, envelopes",w),g.call(this,S,a,c)},b.webSocketClose=function(a,c,g){try{a.close(c,g)}catch(x){this._debug(x)}},b.abort=function(){if(v.abort(),S){var a={code:1001,reason:"Abort"};this.webSocketClose(S,a.code,a.reason),this.onClose(S,a)}this.reset()},b},org.cometd.CometD=function(a){function c(a,c){try{return a[c]}catch(x){return void 0}}unction h(a){return void 0===a||null===a?!1:"function"==typeof a}nction T(a){kt._debug("Configuring cometd object with",a),g(a)&&(a={url:a}),a||(a={}),Ht=kt._mixin(!1,Ht,a);var c=kt.getURL();if(!c)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var h=/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(c),v=h[2],b=h[8],T=h[9];if(St=kt._isCrossDomain(v),Ht.appendMessageTypeToURL)if(void 0!==T&&T.length>0)kt._info("Appending message type to URI "+b+T+" is not supported, disabling 'appendMessageTypeToURL' configuration"),Ht.appendMessageTypeToURL=!1;else{var y=b.split("/"),_=y.length-1;b.match(/\/$/)&&(_-=1),y[_].indexOf(".")>=0&&(kt._info("Appending message type to URI "+b+" is not supported, disabling 'appendMessageTypeToURL' configuration"),Ht.appendMessageTypeToURL=!1)}}nction w(){for(var a in Ft){var c=Ft[a];if(c)for(var i=0;i<c.length;++i)_(c[i])}}nction S(){var a=++Rt;return""+a}unction I(a){for(var i=0;i<Ot.length&&(void 0!==a&&null!==a);++i){var c=Ht.reverseIncomingExtensions?Ot.length-1-i:i,g=Ot[c],v=g.extension.incoming;if(h(v)){var b=U(g.extension,v,g.name,a,!1);a=void 0===b?a:b}}return a}function R(a){for(var i=0;i<Ot.length&&(void 0!==a&&null!==a);++i){var c=Ot[i],g=c.extension.outgoing;if(h(g)){var v=U(c.extension,g,c.name,a,!0);a=void 0===v?a:v}}return a}function E(a,c){var g=Ft[a];if(g&&g.length>0)for(var i=0;i<g.length;++i){var v=g[i];if(v)try{v.callback.call(v.scope,c)}catch(x){var b=kt.onListenerException;if(h(b)){kt._debug("Invoking listener exception handler",v,x);try{b.call(kt,x,v,v.listener,c)}catch(T){kt._info("Exception during execution of listener exception handler",v,T)}}else kt._info("Exception during execution of listener",v,c,x)}}}function L(a,c){E(a,c);for(var g=a.split("/"),h=g.length-1,i=h;i>0;--i){var v=g.slice(0,i).join("/")+"/*";i===h&&E(v,c),v+="*",E(v,c)}}function A(){null!==Mt&&org.cometd.Utils.clearTimeout(Mt),Mt=null}function F(a){A();var c=Bt.interval+Nt;kt._debug("Function scheduled in",c,"ms, interval =",Bt.interval,"backoff =",Nt,a),Mt=org.cometd.Utils.setTimeout(kt,a,c)}function N(a,c,g,h){for(var i=0;i<c.length;++i){var v=c[i],b=v.id;Et&&(v.clientId=Et),v=R(v),void 0!==v&&null!==v?(v.id=b,c[i]=v):(delete Jt[b],c.splice(i--,1))}if(0!==c.length){var T=kt.getURL();Ht.appendMessageTypeToURL&&(T.match(/\/$/)||(T+="/"),h&&(T+=h));var y={url:T,sync:a,messages:c,onSuccess:onFailure:;kt._debug("Send",y),_t.send(y,g)}}function M(a){qt>0||At===!0?Lt.push(a):N(!1,[a],!1)}unction B(){Nt<Ht.maxBackoff&&(Nt+=Ht.backoffIncrement)}function J(){++qt,kt._debug("Starting batch, depth",qt)}function D(){var a=Lt;Lt=[],a.length>0&&N(!1,a,!1)}function W(){if(--qt,kt._debug("Ending batch, depth",qt),0>qt)throw"Calls to startBatch() and endBatch() are not paired";0!==qt||C()||At||D()}function j(){if(!C()){var a={id:S(),channel:"/meta/connect",connectionType:_t.getType()};jt||(a.advice={timeout:0}),k("connecting"),kt._debug("Connect sent",a),N(!1,[a],!0,"connect"),k("connected")}}function H(){k("connecting"),F(function(){j()})}unction P(a){if(A(),a&&_t&&_t.abort(),Et=null,k("disconnected"),qt=0,O(),_t=null,Lt.length>0){var c=Lt;Lt=[],Pt.call(kt,void 0,c,{reason:"Disconnected"})}}unction $(a,c){h(a)&&(c=a,a=void 0),Et=null,w(),C()?(Ut.reset(),X(Ht.advice)):X(kt._mixin(!1,Bt,{reconnect:"retry"})),qt=0,At=!0,xt=a,wt=c;var g="1.0",v=kt.getURL(),b=Ut.findTransportTypes(g,St,v),T={id:S(),version:g,minimumVersion:g,channel:"/meta/handshake",supportedConnectionTypes:b,advice:{timeout:Bt.timeout,interval:Bt.interval}},y=kt._mixin(!1,{},xt,T);if(kt._putCallback(y.id,c),!_t&&(_t=Ut.negotiateTransport(b,g,St,v),!_t)){var _="Could not find initial transport among: "+Ut.getTransportTypes();throw kt._warn(_),_}kt._debug("Initial transport is",_t.getType()),k("handshaking"),kt._debug("Handshake sent",y),N(!1,[y],!1,"handshake")}function V(){k("handshaking"),At=!0,F(}nction Q(a){var c=Dt[a.id];if(delete Dt[a.id],kt._debug("Handling remote call response for",a,"with context",c),c){var g=c.timeout;g&&org.cometd.Utils.clearTimeout(g);var v=c.callback;if(h(v))return G(v,a),!0}return!1}function Y(a){K(a),L("/meta/handshake",a),L("/meta/unsuccessful",a);var c=!C()&&"none"!==Bt.reconnect;c?(B(),V()):P(!0)}function Z(a){if(a.successful){Et=a.clientId;var c=kt.getURL(),g=Ut.negotiateTransport(a.supportedConnectionTypes,a.version,St,c);if(null===g){var h="Could not negotiate transport with server; client=["+Ut.findTransportTypes(a.version,St,c)+"], server=["+a.supportedConnectionTypes+"]",v=kt.getTransport();return z(v.getType(),null,{reason:h,connectionType:v.getType(),transport:v}),kt._warn(h),void P(!0)}_t!==g&&(kt._debug("Transport",_t.getType(),"->",g.getType()),_t=g),At=!1,D(),a.reestablish=Wt,Wt=!0,K(a),L("/meta/handshake",a);var b=C()?"none":Bt.reconnect;switch(b){case"retry":O(),H();break;case"none":P(!0);break;default:throw"Unrecognized advice action "+b}}else Y(a)}function et(a){var c="1.0",g=kt.getURL(),h=kt.getTransport(),v=Ut.findTransportTypes(c,St,g),b=Ut.negotiateTransport(v,c,St,g);b?(kt._debug("Transport",h.getType(),"->",b.getType()),z(h.getType(),b.getType(),a.failure),Y(a),_t=b):(z(h.getType(),null,a.failure),kt._warn("Could not negotiate transport; client=["+v+"]"),P(!0),Y(a))}function tt(a){L("/meta/connect",a),L("/meta/unsuccessful",a);var c=C()?"none":Bt.reconnect;switch(c){case"retry":H(),B();break;case"handshake":Ut.reset(),O(),V();break;case"none":P(!0);break;default:throw"Unrecognized advice action"+c}}function nt(a){if(jt=a.successful){L("/meta/connect",a);var c=C()?"none":Bt.reconnect;switch(c){case"retry":O(),H();break;case"none":P(!1);break;default:throw"Unrecognized advice action "+c}}else tt(a)}nction st(a){a.successful?(P(!1),K(a),L("/meta/disconnect",a)):ot(a)}function at(a){ot(a)}function ct(a){var c=Ft[a.subscription];if(c)for(var i=c.length-1;i>=0;--i){var g=c[i];if(g&&!g.listener){delete c[i],kt._debug("Removed failed subscription",g);break}}K(a),L("/meta/subscribe",a),L("/meta/unsuccessful",a)}function ut(a){a.successful?(K(a),L("/meta/subscribe",a)):ct(a)}function lt(a){ct(a)}unction dt(a){a.successful?(K(a),L("/meta/unsubscribe",a)):gt(a)}function ht(a){gt(a)}unction pt(a){void 0!==a.data?Q(a)||L(a.channel,a):void 0===a.successful?kt._warn("Unknown Bayeux Message",a):a.successful?(K(a),L("/meta/publish",a)):ft(a)}unction vt(a){if(a=I(a),void 0!==a&&null!==a){X(a.advice);var c=a.channel;switch(c){case"/meta/handshake":Z(a);break;case"/meta/connect":nt(a);break;case"/meta/disconnect":st(a);break;case"/meta/subscribe":ut(a);break;case"/meta/unsubscribe":dt(a);break;default:pt(a)}}}function bt(a){var c=Ft[a];if(c)for(var i=0;i<c.length;++i)if(c[i])return!0;return!1}unction yt(a,c,g,h){var v=Tt(c,g);kt._debug("Adding",h?"listener":"subscription","on",a,"with scope",v.scope,"and callback",v.method);var b={channel:a,scope:v.scope,callback:v.method,listener:h},T=Ft[a];return T||(T=[],Ft[a]=T),b.id=T.push(b)-1,kt._debug("Added",h?"listener":"subscription",b),b[0]=a,b[1]=b.id,b}var _t,xt,wt,kt=this,Ct=a||"default",St=!1,Ut=new org.cometd.TransportRegistry,It="disconnected",Rt=0,Et=null,qt=0,Lt=[],At=!1,Ft={},Nt=0,Mt=null,Ot=[],Bt={},Jt={},Dt={},Wt=!1,jt=!1,Ht={protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",reverseIncomingExtensions:!0,maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,advice:{timeout:6e4,interval:0,reconnect:"retry"}};this._mixin=function(a,g){for(var h=g||{},i=2;i<arguments.length;++i){var v=arguments[i];if(void 0!==v&&null!==v)for(var b in v){var T=c(v,b),y=c(h,b);if(T!==g&&void 0!==T)if(a&&"object"==typeof T&&null!==T)if(T instanceof Array)h[b]=this._mixin(a,y instanceof Array?y:[],T);else{var _="object"!=typeof y||y instanceof Array?{}:y;h[b]=this._mixin(a,_,T)}else h[b]=T}}return h},this._warn=this._info=this._debug=this._isCrossDomain=var Xt,Pt;this.send=M,this._getCallback=this._putCallback=this.receive=vt,Xt=function(a){kt._debug("Received",a);for(var i=0;i<a.length;++i){var c=a[i];vt(c)}},Pt=this.registerTransport=this.getTransportTypes=function(){return Ut.getTransportTypes()},this.unregisterTransport=this.unregisterTransports=function(){Ut.clear()},this.findTransport=function(a){return Ut.find(a)},this.configure=this.init=this.handshake=function(a,c){k("disconnected"),Wt=!1,$(a,c)},this.disconnect=function(a,c,g){if(!C()){"boolean"!=typeof a&&(g=c,c=a,a=!1),h(c)&&(g=c,c=void 0);var v={id:S(),channel:"/meta/disconnect"},b=this._mixin(!1,{},c,v);kt._putCallback(b.id,g),k("disconnecting"),N(a===!0,[b],!1,"disconnect")}},this.startBatch=function(){J()},this.endBatch=function(){W()},this.batch=this.addListener=this.removeListener=this.clearListeners=this.subscribe=this.unsubscribe=this.resubscribe=function(a,c){return _(a),a?this.subscribe(a.channel,a.scope,a.callback,c):void 0},this.clearSubscriptions=function(){w()},this.publish=function(a,c,v,b){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!g(a))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(a))throw"Illegal argument: cannot publish to meta channels";if(C())throw"Illegal state: already disconnected";h(c)?(b=c,c=v={}):h(v)&&(b=v,v={});var T={id:S(),channel:a,data:c},y=this._mixin(!1,{},v,T);kt._putCallback(y.id,b),M(y)},this.remoteCall=function(a,c,v,b){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!g(a))throw"Illegal argument type: target must be a string";if(C())throw"Illegal state: already disconnected";if(h(c)?(b=c,c={},v=Ht.maxNetworkDelay):h(v)&&(b=v,v=Ht.maxNetworkDelay),"number"!=typeof v)throw"Illegal argument type: timeout must be a number";a.match(/^\//)||(a="/"+a);var T="/service"+a,y={id:S(),channel:T,data:c},_={callback:b};v>0&&(_.timeout=org.cometd.Utils.setTimeout(kt,v),kt._debug("Scheduled remote call timeout",y,"in",v,"ms")),Dt[y.id]=_,M(y)},this.getStatus=function(){return It},this.isDisconnected=C,this.setBackoffIncrement=function(a){Ht.backoffIncrement=a},this.getBackoffIncrement=function(){return Ht.backoffIncrement},this.getBackoffPeriod=function(){return Nt},this.setLogLevel=function(a){Ht.logLevel=a},this.registerExtension=function(a,c){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!g(a))throw"Illegal argument type: extension name must be a string";for(var v=!1,i=0;i<Ot.length;++i){var b=Ot[i];if(b.name===a){v=!0;break}}return v?(this._info("Could not register extension with name",a,"since another extension with the same name already exists"),!1):(Ot.push({name:a,extension:c}),this._debug("Registered extension",a),h(c.registered)&&c.registered(a,this),!0)},this.unregisterExtension=this.getExtension=this.getName=function(){return Ct},this.getClientId=function(){return Et},this.getURL=function(){if(_t&&"object"==typeof Ht.urls){var a=Ht.urls[_t.getType()];if(a)return a}return Ht.url},this.getTransport=this.getConfiguration=function(){return this._mixin(!0,{},Ht)},this.getAdvice=org.cometd.WebSocket=window.WebSocket}}).call(this);
;/*!visitor/common/js/query.js*/
!function(){var a=function(){function a(a){return a._zid||(a._zid=wt++)}function c(a){!J.createElement;var c=J.createElement("div");try{return!!a(c)}catch(e){return!1}finally{c.parentNode&&c.parentNode.removeChild(c),c=null}}function h(a,c,v){var y=c&&c.ownerDocument,v=v||[];return a?a.nodeType||a==window.document||a==window?(this.context=a,this.results=[a],this.length=1,this):lt(a)?"undefined"!=typeof Et?this.readyList.push(a):a():a instanceof h?a:((c?c.ownerDocument||c:z)!==J&&I(c),c=c||J,this.selector=a,this.context=c,this.results=g(a,c,v,y),void(this.length=this.results.length)):(this.length=0,this.results=this.results||v,this)}function g(a,c,h,g){if(!a)return h;var m,i,v,y,E,N=c?c.nodeType:9;if(y=F.exec(a),11!==N&&y)if(m=y[1]){if(9===N){if(!(v=c.getElementById(m)))return h;if(v.id===m)return h.push(v),h}else if(c.ownerDocument&&(v=c.ownerDocument.getElementById(m))&&H(c,v)&&v.id===m)return h.push(v),h}else{if(m=y[2])return(T=$.find.TAG(m,c))&&W.apply(h,T),h;if((m=y[3])&&G.getElementsByClassName&&c.getElementsByClassName)return W.apply(h,c.getElementsByClassName(m)),h}if(1!==N&&(g=c,E=a),E)try{return W.apply(h,g.querySelectorAll(E)),h}catch(w){}finally{}if(!y)return h;var b,T=$.find.TAG("*",c),C=T.length;if(i=0,b=y[2]){var S=[];if(h=c.getElementsByTagName(b),v=Nt,"*"===b){for(;v=h[i++];)1===v.nodeType&&S.push(v);return S}return h}for(var j=tt.CLASS,B=j(y[3]);i!==C&&null!=(v=T[i]);i++)v&&1===v.nodeType&&B(v)&&h.push(v);return h}ction N(a,c,h){for(var g in c)h&&(mt(c[g])||ft(c[g]))?(mt(c[g])&&!mt(a[g])&&(a[g]={}),ft(c[g])&&!ft(a[g])&&(a[g]=[]),N(a[g],c[g],h)):c[g]!==Nt&&(a[g]=c[g])}unction w(c,h,g,v){function y(c){return!(!c||h.e&&c.e!=h.e||h.ns&&!E.test(c.ns)||g&&a(c.fn)!==a(g)||v&&c.sel!=v)}if(h=b(h),h.ns)var E=T(h.ns);for(var N=bt[a(c)]||[],w=[],i=0;i<N.length;i++)y(N[i])&&w.push(N[i]);return w}tion j(c,h,g,v,y,E,N){var w=a(c),T=bt[w]||(bt[w]=[]);O.fn.each(h.split(/\s/),function(i,a){if("ready"==a)return O(J).ready(g);var h=b(a);h.fn=g,h.sel=y,h.e in St&&(g=,h.del=E;var w=E||g;h.proxy=h.i=T.length,T.push(h),"addEventListener"in c?c.addEventListener(S(h.e),h.proxy,C(h,N)):c.attachEvent("on"+S(h.e),h.proxy)})}function B(c,h,g,v,y){var E=a(c);O.fn.each((h||"").split(/\s/),function(i,a){O.fn.each(w(c,a,g,v),function(a,h){delete bt[E][h.i],"removeEventListener"in c?c.removeEventListener(S(h.e),h.proxy,C(h,y)):c.detachEvent("on"+S(h.e),h.proxy)})})}nction D(){}var O,P,H,I,k=[],F=(k.concat,/^(?:#([\w-\/_]+)|(\w+)|\.([\w-]+))$/),M=/^[^{]+\{\s*\[native \w/,R=/[\t\r\n\f]/g,U=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,_=/\S+/g,$={find:{},filter:{}},z=window.document,J=window.document,X="echatQuery"+1*new Date,G={},V=[],Q=(V.pop,V.push,V.slice),W=V.push,Y=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),Z=K="[\\x20\\t\\r\\n\\f]",et=function(){I()},tt={TAG:CLASS:function(a){var c=new RegExp("(^|"+K+")"+a+"("+K+"|$)");return };G.getElementsByTagName=c(function(a){return a.appendChild(J.createComment("")),!a.getElementsByTagName("*").length}),I=function(a){var h,g,v=a?a.ownerDocument||a:z;return v===J||9!==v.nodeType||!v.documentElement,J=v,P=J.documentElement,(g=J.defaultView)&&g.top!==g&&(g.addEventListener?g.addEventListener("unload",et,!1):g.attachEvent&&g.attachEvent("onunload",et)),G.attributes=c(,G.getElementsByTagName=c(,G.getElementsByClassName=M.test(v.getElementsByClassName),G.getById=c(,G.getById?($.find.ID=function(a,c){if("undefined"!=typeof c.getElementById){var m=c.getElementById(a);return m?[m]:[]}},$.filter.ID=:(delete $.find.ID,$.filter.ID=,G.qsa=M.test(v.querySelectorAll),$.find.TAG=G.getElementsByTagName?function(a,c){for(var h,g=[],i=0,v=z.getElementsByTagName(a);h=v[i++];)1===h.nodeType&&H(c,h)&&g.push(h);return g},$.find.CLASS=G.getElementsByClassName&&h=M.test(P.compareDocumentPosition),H=h||M.test(P.contains)?function(a,c){if(!a||!c)return!1;var h=9===a.nodeType?a.documentElement:a,g=c&&c.parentNode;return a===g||!(!g||1!==g.nodeType||!(h.contains?h.contains(g):a.compareDocumentPosition&&16&a.compareDocumentPosition(g)))}:function(a,c){if(!a)return!1;if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1},v},I(),O=var nt=0,it=/(\=)\?(&|$)|\?\?/i;O.ajaxJSONP=function(a,c){function h(e,h){O(N).remove(),e&&"error"==e.type||!g?a.error&&a.error(null,h||"error",T,a,c):a.success&&a.success(g[0],T,a,c),window[E]=w,g&&lt(w)&&w(g[0]),w=g=Nt}if(!("type"in a))return O.ajax(a);var g,v=window.document,y=a.jsonpCallback,E=(lt(y)?y():y)||"jsonp"+ ++nt,N=v.createElement("script"),w=window[E],b=function(c){a.errorSwitch?a.errorSwitch():h({type:"error",timeout:1}),O(script).triggerHandler("error",c||"abort")},T={abort:b};c&&c.promise(T);v.getElementsByTagName("head")[0];window[E]=function(){g=arguments};var C="$1"+E+"$2";a.url=a.url.replace(it,C);var p="";if(a.data){for(var S in a.data){var d="string"==typeof a.data[S]?a.data[S]:JSON.stringify(a.data[S]);p="&"+S+"="+encodeURIComponent(d)}p&&(p=p.substring(1),p+="&")}a.url+=(/\?/.test(a.url)?"&":"?")+p+(a.jsonpCB||"jsonp")+"="+E;var j="onload"in N;return j?(N.onload=h,N.onerror=function(){h({type:"error"})}):N.onreadystatechange=function(){/loaded|complete/.test(N.readyState)&&h()},a.beforeSend&&a.beforeSend(T)===!1?T:(N.src=a.url,v.getElementsByTagName("head")[0].appendChild(N),a.timeout>0&&(abortTimeout=setTimeout(a.timeout)),T)};var st=function(){var a=navigator.userAgent.match(/rv:([\d.]+)/i),c=!1;return a&&a[1]&&a[1]>=11&&(c=!0),function(a){return c&&!a.url.match(/\.(json|js|png|jpeg)$/i)}}();O.ajax=O._ajax=function(o){function a(){var a;try{a=new XMLHttpRequest}catch(e){for(var c=["Msxml3.XMLHTTP","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],i=0,h=c.length;h>i;i++)try{a=new ActiveXObject(c[i]);break}catch(e){continue}}return a}if("jsonp"==o.jsonp||"JSONP"==o.jsonp||"jsonp"==o.type||"JSONP"==o.type)return O.ajaxJSONP(o,o.deferred);var c=a();c.onreadystatechange=function(){4==c.readyState&&(200==c.status?o.success&&o.success(c.responseText):0==c.status&&o.errorSwitch?o.errorSwitch():o.error&&o.error(c,c.responseText))};var d=o.data,h="";if(d&&"[object object]"==Object.prototype.toString.apply(d).toLowerCase())for(var g in d)h+="&"+g+"="+encodeURIComponent(d[g]);h&&o.type.match(/get/i)&&(o.url+=-1!=o.url.indexOf("?")?h:"?"+h.substring(1),h="",d=null),window.XMLHttpRequest?d||(d=null):d||(d=Nt),c.open(o.type.toUpperCase(),o.url,!0),o.timeout&&(c.timeout=o.timeout);try{var v=o.xhrFields||(st(o)?{withCredentials:!0}:Nt);for(i in v)c[i]=o.xhrFields[i]}catch(e){}if(o.header)for(var y in o.header)c.setRequestHeader(y,o.header[y]);return o.header&&(o.header["Content-Type"]||o.header["Content-type"]||o.header["content-type"])&&o.contentType===!1||c.setRequestHeader("Content-type",o.contentType||"application/json;charset=UTF-8;"),o.beforeSend&&o.beforeSend(c),c.onAbort=function(){},c.send(h?h.substring(1):d),c};var ot,at=/^-ms-/,ut=/-([\da-z])/gi,ct=!function(){var a,c,h;a=J.createElement("div"),a.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",h=a.getElementsByTagName("a")[0],c=h&&h.style,c=c.cssText="float:left;opacity:.5",ot={"float":c.cssFloat?"cssFloat":"styleFloat"},a=null,h=null}();var lt=function(a){return null==a?!1:"function"==typeof a||"[object Function]"===Object.prototype.toString.call(a)},ft=function(a){return"[object Array]"===Object.prototype.toString.apply(a)},dt=ht={},pt=ht.toString,mt=function(a){return E(a)&&!y(a)&&Object.getPrototypeOf(a)==Object.prototype},gt=O.extend=function(a,c,h){for(var g in c)h&&(mt(c[g])||ft(c[g]))?(mt(c[g])&&!mt(a[g])&&(a[g]={}),ft(c[g])&&!ft(a[g])&&(a[g]=[]),N(a[g],c[g],h)):c[g]!==Nt&&(a[g]=c[g]);return a},O.oldCookie=O.cookie=function(a,c,h){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(c))||null===c||c===Nt)){if(h=O.extend({},h),(null===c||c===Nt)&&(h.expires=-1),"number"==typeof h.expires){var g=h.expires,t=h.expires=new Date;t.setDate(t.getDate()+g)}return c=String(c),J.cookie=[encodeURIComponent(a),"=",h.raw?c:encodeURIComponent(c),h.expires?"; expires="+h.expires.toUTCString():"","; path="+(h.path||"/"),h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}h=c||{};for(var v,y=h.raw?decodeURIComponent,E=J.cookie.split("; "),i=0;v=E[i]&&E[i].split("=");i++)if(y(v[0])===a)return y(v[1]||"");return null},O.toJSON=JSON.stringify;var vt={src:!0,href:!0},yt={isFunction:lt,isArray:ft,isString:dt,isObject:E,isPlainObject:mt,trim:gt,contains:H,readyList:[],find:function(a){var c={};return this.each(function(i,g){h.call(c,a,g,c.results)}),c},match:function(a,c){var g=new h(c),v=null;return g.each(function(i,c){return c==a||H(c,a)?(v=c,!0):void 0}),v},parents:function(a){var c,g,v,y,m;if(a&&this.results&&this.results.length>0&&(c=F.exec(a))&&((m=c[1])?g=function(a){return a.id==m}:(m=c[2])?(m=m.toUpperCase(),g=:(m=c[3])&&(g=function(a){if(a.className){for(var c=a.className.split(" "),i=0;i<c.length;i++)if(c[i]==m)return!0;return!1}}),g))for(v=this.results[0];y=v.parentNode;){if(g(y))return new h(y,this.context,[]);v=y}return new h(null,this.context,[])},html:function(a){return a||""===a?this.each(:this.results&&this.results[0]?this.results[0].innerHTML:null},text:function(a){return"string"==typeof a?this.each(function(i,c){"string"==typeof c.textContent?c.textContent=a:c.innerText=a}):this.results&&this.results[0]?this.results[0].textContent||this.results[0].innerText:null},append:function(a){if(a){if(dt(a)){var c=J.createElement("div");c.innerHTML=a;var h=c.childNodes;this.each(function(i,a){for(var c,i=0;c=h[i++];)1==c.nodeType&&(c=c.cloneNode(!0),a.appendChild(c))})}else this.each(;return this}},insertBefore:function(a,c){if(a){var h;if(dt(a)){var g=J.createElement("div");g.innerHTML=a;var v=g.childNodes;this.each(function(i,a){for(var g,i=0;g=v[i++];)1==g.nodeType&&(g=g.cloneNode(!0),h=c||a.childNodes[0],h?a.insertBefore(g,h):a.appendChild(g))})}else this.each(function(i,g){h=c||g.childNodes[0],h?g.insertBefore(a,h):g.appendChild(a)});return this}},show:function(){return this.each(function(i,a){a.style.display="block"}),this},hide:function(){return this.each(,this},removeClass:function(a){for(var c,h,g,v,y=this.results.length,E=0,i=0,N=(a||"").match(_)||[];y>i;i++)if(c=this.results[i],h=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(R," "):"")){for(E=0;g=N[E++];)for(;h.indexOf(" "+g+" ")>=0;)h=h.replace(" "+g+" "," ");v=a?gt(h):"",c.className!==v&&(c.className=v)}else c.className="";return this},addClass:function(a){for(var c,h,g,v,y=this.results.length,E=0,i=0,N=(a||"").match(_)||[];y>i;i++)if(c=this.results[i],h=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(R," "):"")){for(E=0;g=N[E++];)for(;h.indexOf(" "+g+" ")<0;)h+=g+" ";v=a?gt(h):"",c.className!==v&&(c.className=v)}else c.className=a;return this},attr:function(a,c){if(!a)return this;if("undefined"==typeof c){if("string"==typeof a)return this.results&&this.results.length>0?this.getAttr(this.results[0],a):"";var h=this.results?this.results.length:0;for(var g in a)for(var i=0;h>i;i++){var v=this.results[i];vt[g]?v[g]=a[g]:v.setAttribute(g+"",a[g])}}else for(var h=this.results?this.results.length:0,i=0;h>i;i++){var v=this.results[i];v.setAttribute(a,c),vt[a]?v[a]=c:v.setAttribute(a,c)}return this},css:function(a,c){if(!a)return this;if("undefined"==typeof c)if("string"==typeof a)this.css(a,0===c?"0":"inherit");else for(var h=this.results?this.results.length:0,i=0;h>i;i++)for(var g in a){var n=ct(g);n=ot[n]||n;var v=this.results[i];try{v.style[n]=a[g]}catch(e){}}else try{for(var h=this.results?this.results.length:0,i=0;h>i;i++){var n=ct(a);n=ot[n]||n;var v=this.results[i];v.style[n]=c}}catch(e){return this}return this},remove:function(){for(var a=this.results?this.results.length:0,i=0;a>i;i++){var c=this.results[i];c.parentNode.removeChild(c)}return this.length=0,this.results=[],this},removeAttr:function(a){return this.each(function(i,c){c.setAttribute(a,""),c.removeAttribute(a)})},ready:function(){for(var a,i=0;this.readyList&&(a=this.readyList[i]);)a.call(window),i++;return this},hasClass:function(a){for(var c=this.results?this.results.length:0,h=[],g=tt.CLASS(a),i=0;c>i;i++){var v=this.results[i];g(v)&&h.push(v)}return h.length},max:width:function(){return this.results&&this.results[0]?yt.max(this.results[0].offsetWidth,this.results[0].clientWidth):null},height:function(){return this.results&&this.results[0]?yt.max(this.results[0].offsetHeight,this.results[0].clientHeight):null},val:function(a){return"undefined"==typeof a?this.results&&this.results[0]?this.results[0].value:null:(this.results&&this.results[0]?this.results[0].value=a+"":null,this)},getAttr:each:function(a,c){if(ft(a))for(var i=0;i<a.length&&!c.call(a[i],i,a[i]);i++);else if(lt(a)){c=a,a=this.results||[];for(var i=0;i<a.length&&!c.call(a[i],i,a[i]);i++);}else for(var i in a)if(c.call(a[i],i,a[i]))break;return this}},Et=function(){function a(){v.removeEventListener("DOMContentLoaded",a,!1),v.removeEventListener("load",a,!1),g()}function c(){"complete"==v.readyState&&(v.detachEvent("onreadystatechange",c),v.detachEvent("onload",h),g())}ar g=v=window.document;if(v.addEventListener)v.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1);else if(v.attachEvent)v.attachEvent("onreadystatechange",c),window.attachEvent("onload",h);else if(v.lastChild==v.body)return g();var l=v.getElementsByTagName("body")||[];l.length>0&&g()};Et(),O.fn=yt,O.each=yt.each;var Nt,wt=1,Q=Array.prototype.slice,bt={},xt={},Tt="onfocusin"in window,Ct={focus:"focusin",blur:"focusout"},St={mouseenter:"mouseover",mouseleave:"mouseout"};xt.click=xt.mousedown=xt.mouseup=xt.mousemove="MouseEvents",O.event={add:j,remove:B},O.proxy=O.fn.bind=function(a,c,h){return this.on(a,c,h)},O.fn.unbind=O.fn.one=var jt=function(){return!0},Bt=At=/^([A-Z]|returnValue$|layer[XY]$)/,Lt={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};O.fn.delegate=function(a,c,h){return this.on(c,a,h)},O.fn.undelegate=O.fn.live=function(a,c){return O(J.getElementsByTagName("body")[0]).delegate(this.selector,a,c),this},O.fn.die=function(a,c){return O(J.getElementsByTagName("body")[0]).undelegate(this.selector,a,c),this},O.fn.on=function(a,c,h,g,v){var y,E,N=this;return a&&!dt(a)?(O.each(a,,N):(dt(c)||lt(g)||g===!1||(g=h,h=c,c=Nt),(g===Nt||h===!1)&&(g=h,h=Nt),g===!1&&(g=Bt),N.each(function(N,w){v&&(y=,c&&(E=function(e){e=e||window.event;var a,h=e.target||e.srcElement,v=yt.match(h,c);return v&&v!==w?(a=O.extend(L(e),{currentTarget:v,liveFired:w}),(y||g).apply(v,[a].concat(Q.call(arguments,1)))):void 0}),j(w,a,g,h,c,E||y)}))},O.fn.off=O.fn.trigger=function(a,c){return a=dt(a)||mt(a)?O.Event(a):A(a),a._args=c,this.each(},O.fn.triggerHandler=O.fn.each("focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" "),function(i,a){O.fn[a]=),O.Event=O.fn.autoHeight=function(){function a(a){a.style.height="auto",a.style.height=a.scrollHeight+"px"}this.each(function(){O(this).on("keyup",})},O.isBoolean=D,O.isDate=D,O.isFunction=D,O.isNaN=D,O.isNumber=D,O.isObject=D,O.isRegExp=D,O.isString=D,O.isUndefined=D;for(var Dt=O,Ot="Array Boolean Date NaN Number Function Object RegExp Undefined".split(" "),i=0;i<Ot.length;i++){var Pt=Ot[i];Dt["is"+Pt]=function(a){return function(c){return c!==c?"NaN"===a?!0:!1:RegExp(a).test(Object.prototype.toString.call(c))}}(Pt)}return h.prototype=O.fn,O}();window.EChatQuery=a}();
;/*!visitor/common/js/qcometd.js*/
!function(a,c){!function(a,c){function h(a,c){if(c)for(var h in c)"content-type"!==h.toLowerCase()&&a.setRequestHeader(h,c[h])}function k(){var k=new c.LongPollingTransport,g=c.Transport.derive(k);return g.xhrSend=function(c){return a.ajax({url:c.url,async:c.sync!==!0,type:"POST",contentType:"application/json;charset=UTF-8",data:c.body,global:!1,xhrFields:{withCredentials:!0},beforeSend:function(a){try{a.withCredentials=!0}catch(e){}return h(a,c.headers),!0},success:c.onSuccess,error:function(a,h,k){c.onError(h,k)},errorSwitch:function(){c.onError("no answer",{liketimeout:1})}})},g}function g(){var k=new c.CallbackPollingTransport,g=c.Transport.derive(k);return g.jsonpSend=function(c){return a.ajax({url:c.url,async:c.sync!==!0,type:"GET",dataType:"jsonp",jsonp:"jsonp",data:{message:c.body},beforeSend:success:c.onSuccess,error:errorSwitch:)},g}return"undefined"!=typeof JSON&&(c.JSON.toJSON=JSON.stringify,c.JSON.fromJSON=JSON.parse),a.CometD=function(a){var h=new c.CometD(a);return c.WebSocket&&h.registerTransport("websocket",new c.WebSocketTransport),h.registerTransport("long-polling",new k),navigator.userAgent.match(/msie/i)&&h.registerTransport("callback-polling",new g),h},a.cometd=new a.CometD,a.cometd}(a,c.cometd),function(a){return a.AckExtension=function(){ar c,h=!1,k=-1;this.registered=function(h,k){c=k,a("AckExtension: executing registration callback")},this.unregistered=this.incoming=function(c){var g=c.channel;if("/meta/handshake"==g)h=c.ext&&c.ext.ack,a("AckExtension: server supports acks",h);else if("/meta/connect"==g&&c.successful&&h){var y=c.ext;y&&"number"==typeof y.ack&&(k=y.ack,a("AckExtension: server sent ack id",k))}return c},this.outgoing=function(g){var y=g.channel;return"/meta/handshake"==y?(g.ext||(g.ext={}),g.ext.ack=c&&c.ackEnabled!==!1,k=-1):"/meta/connect"==y&&h&&(g.ext||(g.ext={}),g.ext.ack=k,a("AckExtension: client sending ack id",k)),g}}}(c.cometd),function(a,c){var h=new a;return c.registerExtension("ack",h),h}(c.cometd.AckExtension,a.cometd),function(a,c){return c&&(a.COOKIE||(a.COOKIE={},a.COOKIE.set=c,a.COOKIE.get=c)),a.ReloadExtension=function(c){function h(c){if(O.handshakeResponse){R=!0;var h=y.getTransport();h&&h.abort(),g(c),O.cookiePath=E;var k=a.JSON.toJSON(O);v("Reload extension saving cookie value",k),a.COOKIE.set(b,k,{"max-age":T,path:E,expires:new Date((new Date).getTime()+1e3*T)})}}unction g(a){a&&("number"==typeof a.cookieMaxAge&&(T=a.cookieMaxAge),"string"==typeof a.cookieName&&(b=a.cookieName),"string"==typeof a.cookiePath&&(E=a.cookiePath))}var y,v,O={},b="org.cometd.reload",E="/",T=5,w=!1,R=!1;this.configure=g,this.registered=function(a,c){y=c,y.reload=h,v=y._debug},this.unregistered=this.outgoing=function(c){switch(c.channel){case"/meta/handshake":O={},O.url=y.getURL();var h=a.COOKIE.get(b);if(v("Reload extension found cookie value",h),h)try{var g=a.JSON.fromJSON(h);if(a.COOKIE.set(b,"",{"max-age":-1,path:g.cookiePath,expires:-1}),g.handshakeResponse&&k(g)){v("Reload extension restoring state",g);var E=y._getCallback(c.id);return setTimeout(function(){v("Reload extension replaying handshake response",g.handshakeResponse),O.handshakeResponse=g.handshakeResponse,O.transportType=g.transportType,y._putCallback(c.id,E);var a=y._mixin(!0,{},O.handshakeResponse,{id:c.id,ext:{reload:!0}});a.supportedConnectionTypes=[O.transportType],y.receive(a),v("Reload extension replayed handshake response",a)},0),w||(w=!0,y.startBatch()),null}v("Reload extension could not restore state",g)}catch(x){v("Reload extension error while trying to restore cookie",x)}break;case"/meta/connect":if(R===!0)return v("Reload extension aborting /meta/connect during reload"),null;O.transportType||(O.transportType=c.connectionType,v("Reload extension tracked transport type",O.transportType));break;case"/meta/disconnect":O={}}return c},this.incoming=function(a){if(a.successful)switch(a.channel){case"/meta/handshake":O.handshakeResponse||(O.handshakeResponse=a,v("Reload extension tracked handshake response",a));break;case"/meta/connect":w&&(w=!1,y.endBatch());break;case"/meta/disconnect":O={}}return a},g(c)}}(c.cometd,a.cookie),function(a,c,h){var k=new c;return h.registerExtension("reload",k),k}(c.cometd,c.cometd.ReloadExtension,a.cometd)}(EChatQuery,org);
;/*!visitor/common/js/util.js*/
!function($){"undefined"==typeof window.ECHATObjKeyMap&&(window.ECHATObjKeyMap={});var UTIL=function(justBase){unction _isPointerEventType(e,a){return e.type=="pointer"+a||e.type.toLowerCase()=="mspointer"+a||e.type=="mouse"+a}function _isPrimaryTouch(a){var t=a.type.indexOf("mouse")>-1||("touch"==a.pointerType||a.pointerType==a.MSPOINTER_TYPE_TOUCH)&&a.isPrimary;return t}this.ECHATConfig={contextPath:"/mychat/visitor"};var _self=this;if(this.bot=/spider|bot/i.test(navigator.userAgent),this.subMap={},this.eventMap={},this.setSub=this.removeSub=function(a){delete this.subMap["string"==typeof a?a:a.KEY]},this.publish=function(a){var c=this.subMap;for(var h in c){var g=ECHATObjKeyMap[h];if(g&&g.eventMap&&g.eventMap[a]){var v=g.eventMap[a];if(this.isArray(v))for(var i=0;i<v.length;i++)v[i]&v[i].apply(g,arguments)}}},this.subscribe=this.unSubscribeAll=this.unSubscribe=function(a){if(this.isArray(a))for(var i=0;i<a.length;i++)delete this.eventMap[a[i]];else delete this.eventMap[a]},this.isArray=this.throttle=function(a,c,h){var g,v=Date.now();return function y(w){var b=this,S=arguments,I=Date.now();g&&clearTimeout(g),I-v>=c?(a.apply(b,S),v=Date.now()):h&&(g=setTimeout(y,c),w&&"function"==typeof w&&w(g))}},this.debounce=this.getQueryString=function(a){var c,h=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),r=location.search.substr(1).match(h);if(null!=r){try{c=decodeURIComponent(r[2])}catch(g){}return c}},this.escapeRegExp=function(){var a=/[\\^$.*+?()[\]{}|]/g,c=new RegExp(a.source);return (),this.addMapParams=function(a){var c,h=[];for(var c in a)h.push(c+"="+encodeURIComponent(a[c]||""));return h.join("&")},this.packParam=function(a){var c,h="";for(var g in a)c=0===a[g]||a[g]===!1?a[g]+"":a[g]||"",c&&(h+=(h?"&":"")+g+"="+encodeURIComponent(c));return h},this.getQueryParams=function(a){var c={};"string"!=typeof a&&(a=location.search),-1!=a.indexOf("#")&&(a=a.substring(0,a.indexOf("#"))),-1!=a.indexOf("?")&&(a=a.substring(a.indexOf("?")+1));for(var h,g=a.split("&"),v=g.length,i=0;v>i;i++)if(g[i]&&(h=g[i].split("="),h[0]&&h[1])){try{c[h[0]]=decodeURIComponent(h[1])}catch(y){}c[h[0].toLowerCase()]=c[h[0]]}if(c.visEvt)try{var w=JSON.parse(c.visEvt);w&&w.eventId&&(c.eventId=w.eventId,c.eventid=w.eventId)}catch(e){}return c},this.findMsgLiByMsg=function(a){return a.mid&&document.getElementById(a.mid)||a.id&&document.getElementById(a.id)||a.identityKey&&document.getElementById(a.identityKey)||a.fileIdentity&&document.getElementById(a.fileIdentity)||a.clientFileId&&document.getElementById(a.clientFileId)},this.queryParams=this.getQueryParams(),this.companyId=this.getQueryString("companyid"),this.getBackground=function(a,c){var h=[],g=parseInt(c||100)/100,v=(a||"rgb(255,255,255)").toLocaleLowerCase().trim();if(0==v.indexOf("rgb"))v=v.replace("rgb","rgba").replace(")",","+g+")");else if(0==v.indexOf("#")){v=v.replace("#","").split("");for(var i=0;i<v.length;i++)3==v.length?h.push(parseInt("0x"+v[i]+v[i])):i%2==0&&h.push(parseInt("0x"+v[i]+v[i+1]));h.push(g),v="rgba("+h.join()+")"}return v},this.hasStorage=function(){var a;try{if(!window.localStorage)return!1;if(window.localStorage.setItem("echt_test_storage","ok"),a=window.localStorage.getItem("echt_test_storage"),!a)return!1;a&&window.localStorage.removeItem("echt_test_storage")}catch(e){return!1}return!0}(),this.hasCookie=function(){$.cookie("echt_test_cookie","ok");var a=$.cookie("echt_test_cookie");return a?($.cookie("echt_test_cookie",null),!0):!1}(),$.store=function(a){return a?function(a,c,h){if(!a)return null;try{return arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(c))||null===c||void 0===c)?(h=$.extend({},h),(null===c||void 0===c)&&(h.expires=-1),c=String(c),h.session?window.sessionStorage.setItem(a,c):window.localStorage.setItem(a,c),c):(h=c||{},h.local?window.localStorage.getItem(a):h.session?window.sessionStorage.getItem(a):window.localStorage.getItem(a)||window.sessionStorage.getItem(a)||$.cookie(a))}catch(e){try{window.localStorage.removeItem(a),$.store(a,c,h)}catch(e){_self.hasStorage=!1}}}:$.cookie}(this.hasStorage),$.cookie=function(a){return a?function(a,c,h){if(!a)return null;var g={echat_referrer:1,echat_firsturl:1,echat_firsttitle:1};if(!window.ECHAT||!g[a])return $.oldCookie.apply($,arguments);try{if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(c))||null===c||void 0===c)){var v;return null===c||void 0===c?(v=c,window.localStorage.removeItem(a)):(window.localStorage.setItem(a,c),v="--1"),$.oldCookie.call($,a,v,h),c}var y=$.oldCookie.apply($,arguments);return"--1"==y?window.localStorage.getItem(a):(y&&y.length>3&&($.oldCookie.call($,a,"--1"),window.localStorage.setItem(a,y)),y)}catch(e){return $.oldCookie.apply($,arguments)}}:(this.hasStorage),this.changeTitleFun=function(){if("title"in document)return function(a){document.title=a};var a,t=_$s("title");return t&&t[0]?a=t[0]:(a=document.createElement("title"),_$s("head")[0].appendChild(a)),"textContent"in a?function(a){_$s("title")[0].textContent=a}:"innerText"in a?function(a){_$s("title")[0].innerText=a}:function(){}}(document),!justBase){this.checkDomain=function(a,c){unction g(a){var c=a.match(/[.]?([^.]+[.][^.]+)$/);return c?c[1]:h(a)}if(!a||!c||!c.length)return!1;a=g(a);for(var i=0;i<c.length;i++)if(c[i]&&(a==h(c[i])||a==g(c[i])))return!0;return!1},this.getDeviceInfo=function(){function G(){var a=/mobile|kgbrowser|(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i,c=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,h=C||D||window.opera,g=a.test(h)||c.test(h.substr(0,4));return g}nction T(){return E&&y.test(D)&&(!z.test(C)||/samsung/i.test(C))}function Y(){var a=1.2,c=640,h=window.document.documentElement.clientWidth,g=window.document.documentElement.clientHeight,v=h/g>a,y=window.screen.width,w=window.screen.height,b=!1;v&&w>y&&(b=!0,y=window.screen.height,w=window.screen.width);var S=window.innerWidth,I=h/y;window.devicePixelRatio&&T()&&y>c?I*=window.devicePixelRatio:R()&&(I*=1.5);var $=h/S/I;return $=($/a).toFixed(2),(y/S).toFixed(2)}function Z(){var a=window,c=a.document.documentElement,g=a.document.body,v=null,y={top:0,left:0};if(h(c.getBoundingClientRect)&&(h(a.getComputedStyle)?"relative"==a.getComputedStyle(g).position?v=g:"relative"==a.getComputedStyle(c).position&&(v=c):g.currentStyle?"relative"==g.currentStyle.position?v=g:"relative"==c.currentStyle.position&&(v=c):"relative"==g.style.position?v=g:"relative"==c.style.position&&(v=c)),v){var w=v.getBoundingClientRect();y.top=w.top+a.pageYOffset-c.clientTop,y.left=w.left+a.pageXOffset-c.clientLeft}return y}_self.deviceInfo=F;var b=_self,f=b.indexOf=function(){function a(a){if(null==this)throw new TypeError;var c=Object(this),h=c.length>>>0;if(0===h)return-1;var g=0;if(arguments.length>0&&(g=Number(arguments[1]),g!=g?g=0:0!=g&&1/0!=g&&g!=-1/0&&(g=(g>0||-1)*Math.floor(Math.abs(g)))),g>=h)return-1;for(var v=g>=0?g:Math.max(h-Math.abs(g),0);h>v;v++)if(v in c&&c[v]===a)return v;return-1}ar x=Array.prototype.indexOf;return"function"==typeof x&&/\[native code\]/.test(x.toString())||(x=a),c}(),h=b.isFunction=function(){function x(a){return"function"==typeof a}return x}(),i=b.isString=function(){eturn x}(),q=b.Browser=function(){unction $g(){return window.innerHeight!==a?window.innerHeight:document.documentElement?document.documentElement.offsetHeight:document.getElementsByTagName("body").length?document.getElementsByTagName("body")[0].clientHeight:0}function $h(){return window.innerWidth!==a?window.innerWidth:document.documentElement?document.documentElement.offsetWidth:document.getElementsByTagName("body").length?document.getElementsByTagName("body")[0].clientWidth:0}function $o(){var a,c=x.plugins&&x.plugins[$k];if(c)return a=x.mimeTypes&&x.mimeTypes[$m],a&&!a.enabledPlugin?null:c.description;if(window.ActiveXObject)try{return c=new window.ActiveXObject($l),c.AllowScriptAccess="always",c.GetVariable("$version")}catch(h){}}function $p(){var a=x.mimeTypes;return A?Q?!1:"javaEnabled"in x&&x.javaEnabled():a&&(a=a[$n])&&(a=a.enabledPlugin)?a.name:void 0}function $q(){if(!k(S))return S;var a=document.createElement("div"),c=document.createElement("div"),h=a.style,g=c.style;return h.overflow="auto",h.width=h.height="100px",h.position="absolute",h.top="-1000px",g.width="100%",g.height="200px",a.appendChild(c),document.body.appendChild(a),S=a.offsetWidth-a.clientWidth,document.body.removeChild(a),S}function $r(){try{return eval("false")}catch($u){return!0}}function $s(){for(var a=3,c=document.createElement("div"),h=c.getElementsByTagName("i");c.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->",h[0];);return a>4?a:document.documentMode}var x=navigator,y=x.userAgent.toLowerCase(),osVersion=0,z=+(/trident.*rv:? *([0-9]+)/.exec(y)||[])[1]||!1,A=$s(),zz=/edge/.exec(y)||!A&&!!window.StyleMedia||!1,B=8==A,C=7==A,D=6==A,E=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera)||/webkit/.test(y)&&(/opr/.test(y)||/opera/.test(y)),F="Google Inc."==navigator.vendor,G="Apple Computer, Inc."==navigator.vendor,H=!A&&(F||G||/webkit|khtml/.test(y)),I=+/\d+/.exec(/firefox\/\d+/i.exec(navigator.userAgent)||""),J=y.indexOf("firefox/2")>-1,K=y.indexOf("firefox/3")>-1,L=-1!=y.indexOf("iphone"),M=-1!=y.indexOf("ipod"),N=-1!=y.indexOf("ipad"),O=L||N||M,Q=-1!=y.indexOf("wp7"),kgBrowser=-1!=y.indexOf("kgbrowser"),meizu=-1!=y.indexOf("mzbrowser"),P=meizu||-1!=y.indexOf("android"),R=O||P||Q||kgBrowser||meizu,S,uc=-1!=y.indexOf("ucbrowser"),liebao=-1!=y.indexOf("lbbroser")||y.indexOf("liebao")>-1,qq=-1!=y.indexOf("qqbrowser"),sogou=-1!=y.indexOf("metasr")||-1!=y.indexOf("sogou"),f360=y.match(/360|qhbrowser|qihoobrowser/i),maxth=-1!=y.indexOf("maxthon"),baidu=-1!=y.indexOf("bidubrowser")||-1!=y.indexOf("baidubrowser")||-1!=y.indexOf("baidu"),weixin=-1!=y.indexOf("micromessenger"),chromeIphone=L&&-1!=y.indexOf("crios"),T=A&&"msie"||I&&"firefox"||E&&"opera"||uc&&"uc"||liebao&&"liebao"||qq&&"qq"||zz&&"edge"||sogou&&"sogou"||f360&&"360"||maxth&&"maxth"||baidu&&"baidu"||weixin&&"weixin"||chromeIphone&&"chrome"||G&&"safari"||F&&"chrome"||H&&"chrome",U,V=A&&!W,W="CSS1Compat"==document.compatMode,X=!W,Y=A&&X&&document.documentElement&&!!document.documentElement.style.setExpression,Z=document.documentMode||A,$$=-1!=y.indexOf("windows")||-1!=y.indexOf("win32"),$_=-1!=y.indexOf("macintosh")||-1!=y.indexOf("mac os x")||-1!=window.navigator.platform.indexOf("Mac"),$a="https:"==document.location.protocol,$b=x.language||x.browserLanguage||x.userLanguage||x.systemLanguage,$c={noBoxSizing:7>=Z,ie:{cssBottomRight:D,cssFixed:D||Y,buggyCSS:D||Y}},$d="textContent"in document.createElement("div"),$e=!1;try{window.CustomEvent&&/\[native code\]/.test(window.CustomEvent.toString())&&(new window.CustomEvent("testevent",{bubbles:!1,cancelable:!0,detail:!0}),$e=!0)}catch($u){}switch(T){case"opera":U=+/\d+/.exec(new RegExp("opr[ /]\\d+").exec(y)||"");break;case"msie":case"firefox":case"chrome":U=U||+/\d+/.exec(new RegExp(T+"[ /]\\d+").exec(y)||"");break;case"baidu":U=+/\d+/.exec(new RegExp("bidubrowser[ /]\\d+").exec(y)||"");break;case"maxth":U=+/\d+/.exec(new RegExp("maxthon[ /]\\d+").exec(y)||"");break;case"qq":U=+/\d+/.exec(new RegExp("qqbrowser[ /]\\d+").exec(y)||"");break;case"liebao":U=+/\d+/.exec(new RegExp("lbbroser[ /]\\d+").exec(y)||"");break;case"uc":U=+/\d+/.exec(new RegExp("ucbrowser[ /]\\d+").exec(y)||"");break;case"sogou":U=+/\d+/.exec(new RegExp("metasr[ /]\\d+").exec(y)||"");break;default:U=+/\d+/.exec(/version[ \/]\d+/.exec(y)||"")}if(O&&(osVersion=+/\d+/.exec(new RegExp("iphone os \\d+").exec(y)||"")),D){var $i=[];$c.leaksMemory=var $j=$c.leaksMemory.remove=window.attachEvent("onunload",$j)}var $k="Shockwave Flash",$l="ShockwaveFlash.ShockwaveFlash",$m="application/x-shockwave-flash",$n="application/x-java-vm",$t={browser:T,version:U,osVersion:osVersion,isStrict:W,isQuirks:X,isOpera:E,isSafari:G,isWebKit:H,isChrome:!E&&F,isAndroid:P,isIPhone:L,isIPod:M,isIPad:N,isIOS:O,isWP7:Q,isMobile:R,isEdge:zz,isNewIE:z,isIE:A,isIE6:D,isIE7:C,isIE8:B,isFF:I,isFF2:J,isFF3:K,isBorderBox:V,isCustomEvents:$e,engineIE:Z,bugs:$c,isWindows:$$,isXP:/windows nt 5.1/.test(y),isMac:$_,isLinux:/Linux/.test(navigator.platform),isSecure:$a,secureURL:$f,hasFlash:$o(),hasJava:$p(),language:$b,getScrollbarSize:$q,getWindowClientHeight:$g,getWindowClientWidth:$h,isTextContent:$d,hasCSP:$r()};return $t.isPC=!$t.isMobile&&($t.isWindows||$t.isMac||$t.isEdge||$t.isLinux),$t}(),x=b.__$$__jx_ui_HTMLElement,y=/google inc\./i,z=/chrome/i,A=/apple computer, inc\./i,B=/crios/i,C=window.navigator.userAgent||"",D=window.navigator.vendor||"",F={checkLandscape:L,getZoomLevel:Y,getOffset:Z},E=G();_self.Device=F}();var isMobilePage=window.mobilePage||-1!=location.href.split("?")[0].indexOf("/visitor/mobile/")&&!ECHATObjKeyMap.outerId;_self.Device.media=_self.Browser.isMobile||isMobilePage||!_self.Browser.isPC?2:1,_self.Device.OS=this.Browser.isWindows&&"Windows"||this.Browser.isIPhone&&"iPhone"||this.Browser.isIPad&&"IPAD"||this.Browser.isIPod&&"IPOD"||this.Browser.isMac&&"OSX"||this.Browser.isAndroid&&"Android"||this.Device.isWP&&"Windows Phone"||this.Browser.isLinux&&"Linux"||"others",this.hasTranslate=this.Browser.isMobile,this.setTransform=function(x,a){var c="translate("+x+"px,"+a+"px)";$(this).css(_self.hasTranslate?{"-webkit-transform":c,"-o-transfrom":c,"-ms-transform":c,"-moz-transform":c,transform:c}:{left:x+"px",top:a+"px"})},this.setScale=function(){function a(){{var a=_self.deviceInfo.getZoomLevel();(1/a).toFixed(2),window.pageXOffset,window.pageYOffset,window.innerWidth,window.innerHeight,c[0].clientWidth,c[0].clientHeight}return}var c=this;a()};var _clearSlct="getSelection"in window?function(){window.getSelection().removeAllRanges()}:function(){document.selection.empty()};this.pageSlide=function(a,c){$(a).attr("x","0"),$(document).on("mousedown touchstart",a,function(e){e=e||window.event;var a=!1;if(!(a=_isPointerEventType(e,"down"))||_isPrimaryTouch(e)){e=a?e:e.touches&&e.touches[0]||e;var h={};h.x2=void 0,h.y2=void 0;var g=0,v=0,y=0,w=$(this),b=this.parentNode.clientWidth,S=b/8,I=parseInt(w.attr("x")||this.offsetLeft)||0,k=this.clientWidth,E=-k+b-20,C=20;h.x1=e.clientX,h.y1=e.clientY,w.removeClass("transition");var T=b=parseInt(k/parseInt(k/b)),document.body.addEventListener&&document.body.addEventListener("touchmove",T,{passive:!1});var _=function(e){if(w){e=a?e:e.touches&&e.touches[0]||e,h.x2=e.clientX,h.y2=e.clientY,g=h.x2-h.x1,v=h.y2-h.y1;var x=g+I;x=x>C?C:E>x?E:x,_self.setTransform.call(w,x,0),w.attr("x2",x),_clearSlct(),e.originalEvent&&(e=e.originalEvent),e.cancelable=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}},M=function(e){if(_clearSlct(),w){w.addClass("transition");var a=0;if(0==y&&S<Math.abs(g)){{parseInt(w.attr("x2"))}g>=S&&0>=I+b?(_self.setTransform.call(w,I+b,0),w.attr("x",I+b),a=-1):-S>=g&&I-b+k>b/10?(_self.setTransform.call(w,I-b,0),w.attr("x",I-b),a=1):_self.setTransform.call(w,I,0)}else _self.setTransform.call(w,I,0);var r=c&&c(a);return $(document).off("mousemover mousemove touchmove pointermove",_).off("mouseup touchend pointerup",M),w=null,_clearSlct(),r===!1?(e.stopPropagation&&e.stopPropagation,e.preventDefault&&e.preventDefault(),!1):void(document.body.removeEventListener&&document.body.removeEventListener("touchmove",T))}};$(document).on("mousemover mousemove touchmove pointermove",_).on("mouseup touchend pointerup",M)}})},this.getCSSRule=function(a,c,h){if(h=h||window.document,a=a.toLowerCase(),h.styleSheets)for(var i=0;i<h.styleSheets.length;i++){var g=h.styleSheets[i],v=0,y=!1;do{if(y=g.cssRules?g.cssRules[v]:g.rules&&g.rules[v],y&&y.selectorText&&y.selectorText.toLowerCase()==a)return"delete"==c?(g.cssRules?g.deleteRule(v):g.removeRule(v),!0):y;v++}while(y)}return!1},this.killCSSRule=this.addCSSRule=function(a){return document.styleSheets&&(this.getCSSRule(a)||(document.styleSheets[0].addRule?document.styleSheets[0].addRule(a,null,0):document.styleSheets[0].insertRule(a+" { }",0))),this.getCSSRule(a)},this.addJS=function(a,c){function h(a){g.onload=g.onerror=g.onreadystatechange=null,v.removeChild(g),c&&c(a,g.innerHTML),g=null}var g=document.createElement("script");g.setAttribute("type","text/javascript");var v=document.getElementsByTagName("head")[0],y="onload"in g;y?(g.onload=h,g.onerror=:g.onreadystatechange=function(){/loaded|complete/.test(g.readyState)&&h()},g.src=a,v.appendChild(g)},this.addCSS=function(a){var c=document.createElement("link");c.rel="stylesheet",c.type="text/css",c.href=a,c.media="screen";var h=document.getElementsByTagName("head")[0];h.appendChild(c)},this.base64encode=function(a){var c,i,h,g,v,y,w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(h=a.length,i=0,c="";h>i;){if(g=255&a.charCodeAt(i++),i==h){c+=w.charAt(g>>2),c+=w.charAt((3&g)<<4),c+="==";break}if(v=a.charCodeAt(i++),i==h){c+=w.charAt(g>>2),c+=w.charAt((3&g)<<4|(240&v)>>4),c+=w.charAt((15&v)<<2),c+="=";break}y=a.charCodeAt(i++),c+=w.charAt(g>>2),c+=w.charAt((3&g)<<4|(240&v)>>4),c+=w.charAt((15&v)<<2|(192&y)>>6),c+=w.charAt(63&y)}return c},this.iScrollParam={bounce:!this.Browser.isIOS||this.Browser.osVersion<13,preventDefault:!1,preventDefaultException:/^(A|PRE|INPUT|TEXTAREA|BUTTON|SELECT|LABEL)$/,tap:!1,click:!1,mouseWheel:!0,fadeScrollbars:!1},this.parseMsgByRule=function(a,c,h){function g(a,c){return a&&(a+"").replace(/<(?:.|\s)*?>/gi,"").substring(0,c||100)}function v(a){if(!a)return a;var c=this.emo;return c&&(a=a.replace(y,function(a){var h=(arguments[0],a.charCodeAt(0)),l=a.charCodeAt(1),e=((h-55296<<10)+(l-56320)+65536).toString(16);return c[e]?'<img class="img-emo" src="/res/emoji/32/'+e+'.png" />':c[h+"_"+l]?'<img class="img-emo" src="/res/emoji/32/'+(h+"_"+l)+'.png" />':a})),a=a.replace(w,function(a){var h=a.replace(/^\[#([\d\w_]+)#\]/g,"$1");return c&&c[h]||!c?'<img class="img-emo" src="/res/emoji/32/'+h+'.png" />':a})}if(c&&a){var y=this.regFace,w=this.regEmo||new RegExp("\\[#[a-z0-9A-Z]+(_[a-z0-9A-Z]+)*#\\]","g"),b=1,S=c[a.mt||0];return S?S=S.replace(/\$\{([^,]+),?([^,]+)?,?([^,]+)?,?([^,]+)?\}/g,function(c,h,g,v,y){if(b="1"==y?1:0,!g&&!v)return a[h];v=parseInt(v);var w=a[h];return w?(v>0&&w.replace(/\[#([^#]+)#\]/g,function(a,c,h){return v>h&&h+a.length>=v?v+=a.length-1:v>h&&(v+=a.length-1),a}),a[h].substring(g,v)):""}):(S=a.content)||(S=c[0]),(b||h&&h.notPlainText)&&(S=g(S)),y?S&&(S=v(S)):S&&(S=S.replace(w,"[face]")),S}},this.lastMsgRule={0:"",604:"",605:"",621:"",622:"",640:"${content,0,30,1}",641:"[]",642:"[]",647:"${content,0,30,1}",648:":${position}",653:"[]",657:"[]",673:"",674:"",675:"",676:"",10011:"[]",864:"${content,0,30,1}",865:"[]",866:"[]",680:"[]"},this.formatUnreadMsg=function(a){function c(a){this.needHttps&&a.companyLogo&&(a.companyLogo=a.companyLogo.replace(/^http:/,this.needHttps)),"undefined"!=typeof a.unreadMsgNumber&&(a.unreadMsgCount=a.unreadMsgNumber),a.lastMsg=JSON.parse(a.lastMsgContent),a.msgContent=h.parseMsgByRule(a.lastMsg,g)}var h=this;if(!a.lastMsgContent)return{mt:a.mt,companyId:a.companyId,unreadMsgCount:a.unreadMsgNumber||a.unreadMsgCount||0};var g=this.lastMsgRule;return c(a),{chatUrl:(this.loaderHost||location.origin)+"/visitor/mobile/chat.html?companyId="+a.companyId+"&platformSign="+encodeURIComponent(a.signature)+(this.queryParams.fvMsg?"&fvMsg="+encodeURIComponent(this.queryParams.fvMsg):"")+"&metaData="+encodeURIComponent(this.queryParams.metaData)+"&myData="+encodeURIComponent(this.queryParams.myData),msgId:a.mid,platformId:a.platformId||void 0,mt:a.mt,companyId:a.companyId,companyLogo:a.companyLogo,companyName:a.companyName,msgContent:a.msgContent,unreadMsgCount:a.unreadMsgCount}},this.sendMsgboxUnread=function(){function a(a){if(!w&&_self.visitorId){var c;y.cookieName="unreadNewMsg_"+_self.visitorId,y.readySendName="unreadNewMsgMap_"+_self.visitorId,$.cookie(y.readySendName,""),y.cookieValue=$.cookie(y.cookieName),y.readySend=$.store(y.readySendName),y.readySend?y.readySend=JSON.parse(y.readySend):(y.readySend={order:[]},$.store(y.readySendName,'{ "order": [] }')),y.cookieValue&&(c=y.cookieValue.split("_")[0],y.readySend[c]&&v(y.readySend[c])),w=a}}function c(){y.readySend=$.store(y.readySendName),y.readySend=y.readySend?JSON.parse(y.readySend):{order:[]}}function h(a,h){c();var g=y.readySend.order;if(0===h){if(a.mid&&(y.readySend.lastMid=a.mid),g.length>0){y.readySend[a.mid]=void 0,delete y.readySend[a.mid];for(var i=0;i<g.length;i++)g[i]==a.mid&&g.splice(i,1)}}else if(!y.readySend[a.mid]&&(y.readySend[a.mid]=a,y.readySend.order.unshift(a.mid),y.readySend.order.length>10)){for(var i=10;i<g.length;i++)y.readySend[g[i]]=void 0,delete y.readySend[g[i]];y.readySend.order.length=10}$.store(y.readySendName,JSON.stringify(y.readySend))}function g(a){if(a&&(y.queue.push(a),h(a,1)),0!=y.queue.length){var c=$.cookie(y.cookieName);c&&(y.checkTimer||y.timeoutTimer)?y.checkTimer||y.timeoutTimer||(y.timeoutTimer=setTimeout(function(){y.timeoutTimer=null,g()},300)):(!c&&y.checkTimer&&clearTimeout(y.checkTimer),!c&&y.timeoutTimer&&clearTimeout(y.timeoutTimer),v(y.queue.shift()))}}function v(a){if(a){if(c(),y.readySend.lastMid&&y.readySend.lastMid>=a.mid)return g();y.cookieValue=a.mid+"_"+y.pageTag,$.cookie(y.coosetTimeout(function(){y.checkTimer=null;var c=$.cookie(y.cookieName);c==y.cookieValue&&(w(a),$.cookie(y.cookieName,""),h(a,0)),$.cookie(y.cookieName)?y.timeoutTimer=setTimeout(function(){y.timeoutTimer=null,g()},300):g()},200)}}var y={cookieName:"",cookieValue:"",readySendName:"",readySend:{lastMid:"",order:[123],123:{}},queue:[],pageTag:(new Date).getTime(),checkTimer:null,timeoutTimer:null},w=null;return{send:g,queue:y.queue,init:a}}(),$(document).on("drag",function(e){return e=e||window.event,e.preventDefault&&e.preventDefault(),!1})}};UTIL.prototype.serverAdaptor={fuzzyBrandI18nRes:function(){}},window.SDK||(UTIL.prototype.serverAdaptor=new function(){var a=1,c={1:"/visitor/capture/CaptureInstall.exe?",2:"/visitor/capture/file/CaptureInstall.exe?"},h={1:"jietu.echatsoft.com:",2:"127.0.0.1:"},g={captureInstall:{2:"captureInstallNoBrand"}},v={1:"30127,30128",2:"30101,30101"};this.getCaptureFilePath=function(){var h="/visitor/capture/CaptureInstall.exe?";return"undefined"!=typeof a&&(h=c[a]||h),h},this.getCaptureServer=function(){var c="jietu.echatsoft.com:";return"undec),c},this.fuzzyBrang)h=g[v][a],h&&(c[v]=c[h])},this.getCaptureSSL=function(){return 1!=a?!1:"https:"==location.protocol},this.getCapturePort=function(){return v[a||1]},this.getCaptureMark=function(){return 1==a?"echatsoft.com":""}}),UTIL.prototype.clearPrevStorage=function(){var a=!0,c=EChatQuery,h=["ECHAT_HIS_{companyId}_{visitorId}","ECHAT_HIS_{companyId}_{visitorId}_staff","ECHAT_{companyId}_{chatVisitorId}_chatStatus","ECHAT_{companyId}_{chatVisitorId}_mid_read","ECHAT_{companyId}_{chatVisitorId}_mid_read_click","ECHAT_{companyId}_{chatVisitorId}_staffHead","ECHAT_{companyId}_{visitorId}_mid","ECHAT_{companyId}_{visitorId}_ENTRY_HIS","unreadNewMsgMap_{visitorId}","unreadNewMsg_{visitorId}"];return function(g,v,y){if(this.hasStorage&&a&&v&&g){a=!0;var w,i,b="ECHAT_{companyId}_visitorId".replace("{companyId}",g),S=c.store(b);if(!S)return void c.store(b,v);if(S!=v&&!S.match(/vip/)&&!v.match(/vip/)){try{for(i=0;i<h.lengthplace("{chatVisitorId}",y),localStorage.removeItem(w)}catch(e){}c.store(b,v)}}}}(),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.toString().replace(/(^\s+)|(\s+$)/g,"")}),Date.prototype.format=function(a){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in o)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?o[c]:("00"+o[c]).substr((""+o[c]).length)));return a},window.UTIL=UTIL,"undefined"==typeof console&&(window.console={log:function(){}})}(EChatQuery);
;/*!visitor/surfer/js/connect.js*/
!function(a){function c(){function c(){P=!1;var c=F.dataHost+F.ECHATConfig.contextPath;a.cometd.websocketEnabled=O,window.ltIE10?a.cometd.unregisterTransport("long-polling"):(a.cometd.unregisterTransport("long-polling"),a.cometd.unregisterTransport("callback-polling")),a.cometd.configure({url:c,websocketEnabled:O});var v="";"undefined"!=typeof encryptVID&&(v=encryptVID),"undefined"!=typeof chatVisitorId&&(F.chatVisitorId=chatVisitorId),F.platformSign=F.queryParams.platformSign||void 0;var h={from:1,companyId:F.companyId,encryptVId:v,metaData:F.metaData||void 0,formData:F.formData||void 0,myData:F.myDa|void 0,vip:F.vip?1:0,platformSign:F.platformSign,lan:F.queryParams.lan||navigator.language||navigator.browserLanguage||void 0};a.cometd.handshake({data:h}),z&&clearTimeout(z),z=setTimeout){window._echatConfig.echatServers.length&&window._echatConfig.checkNet({serverHost:F.dataHost,errorSwitch:function(){z&&clearTimeout(z),F.switchServer(2)}})}function v(){}function h(a){F.publini&&(F.unSubscribe(["sendVisitorEvent","visitorCommonEvent"]),C(),a.cometd.disconnect(),P=!0),F.publish("__newEvent",{act:200,eventAction:"Chat_End"})}function g(){F.hasInit=!1,F.unSubscribe("sendVisitorEvent")}function k(){if(!F.hasInit){F.hasInit=!0;{setTimeout(function(){F.hasInit=!1},2e3)}F.unSubscribe("sendVisitorEvent"),F.subscribe("sendVisitorEvent",function(c,b,v){switch(b.et+""){case"101":break;case"102":break;case"107":}J||a.cometd.getStatus().match(/connected|connecting/i)?a.cometd.publish("/service/visitor/event",b,v):F.msgQueue.push({channel:"/service/visitor/event",message:b,callback:v})}),F.publish("initSurfer")}}function w(){F.unSubscribe(["sendVisitorEvent","visitorCommonEvent"]),C(),a.cometd.disconnect(),P=!0}function C(c){return c?(Q=null,U=null,H=null,L=null,N=null,A=null,void(j=null)):(j&&a.cometd.unsubscribe(j),j=null,Q&&a.cometd.unsubscribe(Q),Q=null,H&&a.cometd.unsubscribe(H),H=null,U&&a.cometd.unsubscribe(U),U=null,L&&a.cometd.unsubscribe(L),L=null,N&&a.cometd.unsubscribe(N),N=null,A&&a.cometd.unsubscribe(A),void(A=null))}function y(){U||(U=a.cometd.subscribe("/visitor/selfmsg",F,F.receiveTrack)),j||(j=a.cometd.subscribe("/visitor/session/"+F.companyId+"/"+F.visitorId+"/"+F.sessionId,F,F.receiveTrack))}function S(){return F.isMini?void(H||(H=a.cometd.subscribe("/visitor/chat/"+F.companyId+"/"+F.visitorId,F,F.receiveTrack))):(L=a.cometd.subscribe("/visitor/track/"+F.companyId,F,F.receiveTrack),Q=a.cometd.subscribe("/visitor/track/"+F.companyId+"/"+F.visitorId,F,F.receiveTrack),N||F.routeId&&(N=a.cometd.subscribe("/visitor/route/track/"+F.companyId+"/"+F.routeId,F,F.receiveTrack)),void("undefined"!=typeof F.subscribeUnread&&"0"==F.subscribeUnread||!F.platformId||A||(A=a.cometd.subscribe("/visitor/unread/"+F.platformId+"/"+F.visitorId,F,F.receiveTrack))))}function T(c){a.cometd.batch(function(){y()}),F.preClientId=F.curClientId,F.curClientId=c.clientId,c.data&&c.data.visitorId&&(F.visitorId=c.data.visitorId),F.isMini&&(S(),F.miniParam&&(F.miniParam.visitorId=F.visitorId,F.publish("handlePureInnerChat",F.miniParam),delete F.miniParam))}function D(){for(F.receive({data:{user:"system",chat:"Connection to Server Opened"}}),k();F.msgQueue.length>0&&J;){var c=F.msgQueue[0];a.cometd.publish(c.channel,c.data,c.callback),F.msgQueue.shift()}}function V(){F.receive({data:{user:"system",chat:"Connection to Server Closed"}})}fs();if(P||"disconnecting"==b)P=!0,J=!1,V();else{var h=J;J=c.successful===!0,J&&z&&(clearTimeout(z),z=null),!h&&J?D():(h&&!J&&v(),"402::Unknown client"==c.error?(C(1),g()):J||G(function(a){z&&clearTimeout(z),z=a}))}}function _(a){z&&(clearTimeout(z),za.failure&&(1002==a.failure.websocketCode||a.failure.exception&&(a.failure.exception.liketimeout||a.failurul&&a.data&&F.receiveTrack(a),a.successful&&T(a)}function M(a){return}UTIL.call(this,!0);var P,H,L,Q,U,N,j,A,F=this,J=!1,O=!0,z=null,B=null,G=null;this.msgQueue=[],G=F.throttle(function(){z&&clearTimeout(z),b()},6e3,!1),this.switchServer=function(b,v){if(O=1==window._echatConfig.transport,v=v||window._echatConfig&&window._echatConfig.nextServer(1)){F.dataHost=v,B&&clearTimeout(B);try{"disconnected"!=a.cometd.getStatus()&&(P=!0,C()),a.cometd.disconnect(!0),a.cometd.getTransport().abort()}catch(e){}B=setTimeout(c,100)}},this.join=function(){F.isMini=!1;var a=window._echatConfig.isInCdn(F.dataHost);return!a&&window._echatConfig.priority>0?F.switchServer(1,window._echatConfig.currentServer):(O=a?1==window._echatConfig.transport:O,void c())},this.join_mini=function(){F.isMini=!0,"disconnected"==EChatQuery.cometd.getStatus()&&(O=window._echatConfig.isInCdn(F.dataHost)?1==window._echatConfig.transport:O,c())},F.subscribe("initMiniChat",function(c,b){"disconnected"==a.cometd.getStatus()&&(F.join_mini(),F.miniParam=a.extend(b,{chatVisitorId:F.chatVisitorId,status:1,chatStatus:2}))}),this.receiveTrack=function(c){var b=c.data;switch(b.mt+""){case"600":F.visitorId=b.visitorId,F.sessionId=b.sessionId,F.platformId=b.platformId,b.chatDataHost=F.dataHost,F.publish("handshake",b),M(b);break;case"601":F.publish("staffInvite",b);break;case"602":F.publish("staffChat",b);break;case"603":F.publish("companyState",b);break;case"604":h(b),F.publish("staffInfo",b);break;case"605":I(b);break;case"696":case"671":F.publish("visitorInfo",b);break;case"640":case"641":case"642":case"655":case"680":case"10011":F.publish("getMsg",b);break;case"699":F.publish("getFileTokenParams",b);break;case"10010":case"647":F.publish("getSysMsg",b);break;case"648":F.publish("queuePostion",b);break;case"654":Q?F.publish("companyState",b):(F.visitorId=b.visitorId,F.routeId=b.routeId,1==b.independentJS&&(F.isMini=!0),S(),F.publish("startSurfer",b),2==b.chatStatus&&h(b));var v=b.externalLink?b.externalLink[0]:{};if(v.extLink&&v.keyword){var g=document.createElement("a");g.className="echatLink",g.href=v.extLink,g.innerText=v.keyword,document.body.appendChild(g)}break;case"685":F.publish("getNewUnreadMsgCount",b);break;case"684":F.publish("getNewUnreadMsgCount",b);break;case"923":var k=b.newVisitorId,w=b.oldVisitorId;F.visitorId=k,F.metaData=b.metaData,F.formData=b.formData,F.myData=b.myData,F.info=b.info,F.isMini||(w!=k&&(Q?a.cometd.unsubscribe(Q,void 0,function(){Q=a.cometd.subscribe("/visitor/track/"+F.companyId+"/"+F.visitorId,F,F.receiveTrack)}):Q=a.cometd.subscribe("/visitor/track/"+F.companyId+"/"+F.visitorId,F,F.receiveTrack)),F.publish("refreshVisitor",{visitorId:b.newVisitorId,metaData:b.metaData,formData:b.formData,myData:b.myData,info:b.info}));break;case"10009":return void a.cometd.disconnect()}},this.receive=function(){},F.subscribe("endSurfer",w),a.cometd.addListener("/meta/handshake",_),a.cometd.addListener("/meta/connect",E)}window.Connect=c}(EChatQuery);
;/*!visitor/surfer/js/surferClass.js*/
!function(a){var c=function(){function c(){var c=_.getChatLink();_.chatParam=c.params;var h=_.chatLink=c.chatLink;_.miniLink=c.miniLink,_.Browser.isMobile||(a("#ECHAT_icon_link").attr("href",h),a("#ECHAT_invite_accept").attr("href",h),a("#ECHAT_invite_mask").attr("href",h),a(".echat-menu-item-max").attr("href",h))}function h(a,c,h,v,g){var w={};return c?-1!=a.indexOf("left")?(w.marginLeft=c+"px",w.marginRight="auto"):(w.marginRight=c+"px",w.marginLeft="auto"):(w.marginLeft="auto",w.marginRight="auto"),h?-1!=a.indexOf("center")?(w.marginTop=-(g||0)/2+parseInt(h)+"px",w.marginBottom="auto"):-1!=a.indexOf("bottom")?(w.marginBottom=h+"px",w.marginTop="auto"):-1!=a.indexOf("top")&&(w.marginTop=h+"px",w.marginBottom="auto"):(-1!=a.indexOf("center")&&(w.marginTop=-(g||0)/2+"px",w.marginBottom="auto"),w.marginLeft="auto",w.marginRight="auto"),w}function v(){function c(){a(g).removeClass("echat-moving"),g.removeAttribute("unselectable"),a(g).off("mouseup",c),a(g).off("mousemove",v),a(g).off("mouseout",h)}function h(a){var h=a.toElement||{};"html"==(h.nodeName||h.tagName).toLowerCase()&&c(a)}function v(c){a(b).css({left:_.left+c.clientX-y.x+"px",right:"auto",bottom:_.bottom+y.y-c.clientY+"px",top:"auto",marginLeft:0,marginRight:0})}var g=document.body,w=document.getElementById("ECHAT_menu"),b=document.getElementById("ECHAT_mini"),_={},y={};a(w).on("mousedown",function(w){a(g).addClass("echat-moving"),g.setAttribute("unselectable","on");w.target;_.left=b.offsetLeft,_.bottom=parseInt(b.style.bottom)||0,y.x=w.clientX,y.y=w.clientY,a(g).on("mousemove",v),a(g).on("mouseup",c),a(g).on("mouseout",h)})}function g(a){return a?(a+"").replace(/<(?:.|\s)*?>/gi,""):a}function w(c){if(_.miniUnfold){_.needHttps&&(c.url=c.url.replace(/^http:/,_.needHttps)),c.url=_.addExternalParam(c.url),c.url=_.addEchatInnerFrameParam(c.url);var h=document.getElementById("ECHAT_mini"),v="",g=document.getElementById("ECHAT_mini_site"),w=window.innerWidth,b=h.offsetLeft,y=h.clientWidth;"number"!=typeof w&&(w="CSS1Compat"==document.compatMode?document.documentElement.clientWidth:document.body.clientWidth),v=b>w-y-b?"echat-site-left":"echat-site-right",_.Browser.isMobile||(h.style.width=document.getElementById("ECHAT_mini_win").clientWidth+"px");var C='<div class="echat-site-back"><div class="echat-site-title" '+(c.themeColor?'style="color:'+c.themeColor+";":"")+'" title="'+(c.title||"")+'">'+(c.title||"")+'</div><a class="echat-site-back-icon"></a></div><iframe id="ECHAT_site_iframe" name="echatSiteIframe" class="echat-site-iframe" src="'+c.url+'" allowtransparency="true" border="0" frameborder="0"></iframe>';if(g){a("#ECHAT_mini_site").html(C),a("#ECHAT_mini_site").addClass("echat-hidden");var I=a("#ECHAT_site_iframe").attr("src");I!=c.url&&a("#ECHAT_site_iframe").attr("src",c.url),setTimeout(function(){a("#ECHAT_mini_site").removeClass("echat-hidden")},120)}else{var T=document.createElement("DIV");T.className="echat-mini-site echat-hidden "+v,T.id="ECHAT_mini_site",h.appendChild(T),T.innerHTML=C,setTimeout(function(){a("#ECHAT_mini_site").removeClass("echat-hidden")},30)}_.postMessage({innerURL:"opening"})}}function b(a){var c=a.src.toUpperCase();if("PNG"==c.substring(c.length-3,c.length)){var h=a.id?"id='"+a.id+"' ":"",v=a.className?"class='"+a.className+"' ":"",g=a.title?"title='"+a.title+"' ":"title='"+a.alt+"' ",w="display:inline-block;"+a.style.cssText;"left"==a.align&&(w="float:left;"+w),"right"==a.align&&(w="float:right;"+w),a.parentElement.href&&(w="cursor:hand;"+w);var b="<span "+h+v+g+' style="width:'+(a.width||a.clientWidth)+"px; height:"+(a.height||a.clientHeight)+"px;"+w+";filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale');\"></span>";a.outerHTML=b}}UTIL.call(this);var _=this;this.msgNum=0,this.hasMini=!1,this.staffInvite=0,this.ie6=/MSIE 6/g.test(navigator.userAgent),_.ltIE9=_.Browser.isIE&&_.Browser.version<9,this.companyOff=!1,this.Browser.isMobile&&-1!=navigator.userAgent.toLowerCase().indexOf("huawei")&&(this.isHuawei=!0),this.getDocumentTitle=function(){if("title"in document)return document.title||"";var a,t=document.getElementsByTagName("title");return t&&t[0]?(a=t[0],"textContent"in a?a.textContent||"":"innerText"in a?a.innerText||"":""):(a=document.createElement("title"),document.getElementsByTagName("head")[0].appendChild(a),"")},this.documentTitle=this.getDocumentTitle(),this.subscribe("initSurfer",function(){if(_.ltIE9||"undefined"!=typeof _.initMid)_.sendBaseInfo();else var t=0,a=setInterval(function(){t++,("undefined"!=typeof _.initMid||t>10)&&(clearInterval(a),_.sendBaseInfo())},50)}),this.subscribe("refreshVisitor",function(a,h){_.visitorId=h.visitorId,_.metaData=_.queryParams.metaData=h.metaData,_.formData=_.queryParams.formData=h.formData,_.myData=_.queryParams.myData=h.myData,_.info=_.queryParams.info=h.info,c()}),this.subscribe("visitorInfo",function(c,h){var v=_.visitorInfo?a.extend(_.visitorInfo,h):h;delete v.mid,delete v.mst,delete v.rph,delete v.tm,delete v.mt,delete v.vcs,delete v.visitorId,_.visitorInfo=v,_.publish("__newEvent",{act:100,eventAction:"visitorTrackInfo",eventLabel:v})}),this.hasNative=function(){return"undefined"!=typeof window.EchatJsBridge||window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.callEchatNative}(),this.__nativeAPI=function(a,c){if(this.hasNative&&a)try{var h={functionName:a};"undefined"!=typeof c&&(h.value=c),"undefined"!=typeof EchatJsBridge?EchatJsBridge.callEchatNative(JSON.stringify(h)):window.webkit&&window.webkit.messageHandlers.callEchatNative.postMessage(JSON.stringify(h))}catch(e){}},function(){function a(a){var c;return c="string"==typeof a?JSON.parse(a+""):a}function c(c){try{var v=a(c);v.functionName&&(h[v.functionName]?h[v.functionName](v.value):(_.postMessage({action:"echatPageService",params:v}),("setLinkOpener"==v.functionName||"setMediaPlayer"==v.functionName)&&(_.chatAppCache[v.functionName]=v)))}catch(e){}}_.chatAppCache={};var h={};if(window.callEchatJs){var v=window.callEchatJs;window.callEchatJs=function(){c.apply(window,arguments),v.apply(window,arguments)}}else window.callEchatJs=c}(),this.showTip=function(){if(!document.all){var c=".leave-tip{position:absolute;top:140px;left:0;z-index:2147483647;font-size:1.4rem;text-align:center;width:100%;-moz-transition:all 500ms ease-in-out;-webkit-transition:all 500ms ease-in-out;-o-transition:all 500ms ease-in-out;-ms-transition:all 500ms ease-in-out;transition:all 500ms ease-in-out;}body .tiphide{opacity:0;visibility:hidden;}.leave-tip-content{position:relative;display:inline-block;margin:0 10px;line-height:24px;padding:5px 18px;word-wrap:break-word;overflow:hidden;background:rgba(0,0,0,0.5);color:#FFF;border-radius:18px;}.leave-tip-content .info-con{display:inline;padding:0;word-break: break-all;}";if(document.all)window.style=c,document.createStyleSheet("javascript:style"),window.style="";else{var h=document.createElement("style");h.type="text/css",h.innerHTML=c,document.getElementsByTagName("HEAD").item(0).appendChild(h)}var v=document.getElementById("leave-tip")||document.createElement("div");return v.id="leave_tip",v.className="leave-tip tiphide",document.getElementsByTagName("body").length&&document.getElementsByTagName("body")[0].appendChild(v),function(c){_.tipTimer&&clearTimeout(_.tipTimer);var h=document.getElementById("leave_tip");h.innerHTML='<div class="leave-tip-content"><div class="info-con" id="leave_tip_con">'+c+"</div></div>",h.className="leave-tip",_.tipTimer=setTimeout(function(){a("#leave_tip").addClass("tiphide")},3e3)}}}(),this.subscribe("handshake",function(h,v){function g(c){var h,v="",g=!1,w=location.host,_=a.cookie("echat_referrer")||"",y=a.cookie("echat_referrer_timer"),C=a.cookie("echat_referrer_pre"),I=!_;return I?(_=c,a.cookie("echat_referrer_timer","echat_referrer_timeout",{expires:1}),a.cookie("echat_referrer",_),a.cookie("echat_referrer_pre","")):(null!=c&&(h=b(c))&&h!=w&&c!=_&&c!=C&&(_=c,g=!0,a.cookie("echat_referrer_timer","echat_referrer_timeout",{expires:1}),a.cookie("echat_referrer",_),a.cookie("echat_referrer_pre","")),g||"direct"==_||y||(a.cookie("echat_referrer_pre",_),_="direct",a.cookie("echat_referrer",_))),"direct"!=_&&_&&(v=_),v}var w=_.dataHost;w!=v.chatDataHost&&(_.dataHost=v.chatDataHost,c()),_.visitorId=v.rotocol+"//"+v.apiServerDomain,_.__nativeAPI("sendVisitorId",{visitorId:_.visitorId,encryptVId:window.encryptVID}),_.hasNative&&setTimeout(function(){_.postBridgeMessage({platformInit:!0,visitorId:v.visitorId})}),this.unSubscribe("getNewUnreadMsgCount"),this.subscribe("getNewUnreadMsgCount",function(a,c){return(500002==c.platformId||500003==c.platformId||20==c.platformId)&&_.showTip("685"+c.lastMsgContent),c=_.formatUnreadMsg(c),_.publish("__newEvent",{act:100,eventAction:"platformNewMsg",eventLabel:c}),_.postBridgeMessage({platformNewMsg:c}),(c.mt=685)?void _.publish("__msgboxUnreadCount",c.unreadMsgCount):void 0});var b=function(a){return a?(-1!=a.indexOf("://")&&(a=a.substr(a.indexOf("://")+3)),-1!=a.indexOf("/")&&(a=a.substring(0,a.indexOf("/"))),a):void 0};_.referrer=g(document.referrer)}),this.subscribe("startSurfer",function(c,h){_.companyOff=2==h.status?!0:!1,_.visitorId=h.visitorId;var v=_.hasParsedParam,g=_.miniWinParam=h.chatBoxExtInfo,w=_.Device.getZoomLevel();if(!_.partScreen&&g&&g.chatBoxTopMargin&&parseInt(g.chatBoxTopMargin)>0&&(_.partScreen=parseInt(g.chatBoxTopMargin),(w>1.1||.9>w)&&(_.partScreen=_.partScreen/w)),h.independentJS&&(_.isMini=!0),(h.chatButtonInfo||h.mobileChatButtonInfo)&&_.parseParam(h),1!=_.Device.media||_.Browser.isMobile||_.setViewImgBox(),!v&&_.Browser.isMobile){var b=_.Device.getZoomLevel();1!=b&&a(".echat").css("zoom",1/b)}g&&1!=_.echatInnerFrame&&(_.pcMiniWinParam=a.extend({min:1==g.enableMinimizeBtn,max:1==g.enableMaximizeBtn,close:1==g.enableCloseBtn,width:g.floatingWindowWidth||400,height:g.floatingWindowHeight||550},_.pcMiniWinParam),g.minimizeBtnImg&&a(".echat-menu-item-min").css("background","inherit").html('<img src="'+(_.needHttps?g.minimizeBtnImg.replace(/^http:/i,_.needHttps):g.minimizeBtnImg)+'"/>'),g.maximizeBtnImg&&a(".echat-menu-item-max").css("background","inherit").html('<img src="'+(_.needHttps?g.maximizeBtnImg.replace(/^http:/i,_.needHttps):g.maximizeBtnImg)+'"/>'),g.chatEndBtnImg&&a(".echat-menu-item-close").css("background","inherit").html('<img src="'+(_.needHttps?g.chatEndBtnImg.replace(/^http:/i,_.needHttps):g.chatEndBtnImg)+'"/>'),_.companyOff||1!=g.enableOnlinePopAfterLoad||setTimeout(function(){!_.hasMini&&_.miniChat(void 0,8)},1e3*(parseInt(g.onlineAutoPopLoadTime)||0)),_.companyOff&&1==g.enableOfflinePopAfterLoad&&setTimeout(function(){!_.hasMini&&_.miniChat(void 0,8)},1e3*(parseInt(g.offlineAutoPopLoadTime)||0))),v||_.initTrailEvent(),(1==h.chatStatus||1==_.echatInnerFrame)&&(_.inviteTimeout&&clearTimeout(_.inviteTimeout),a("#ECHAT_invite").hide()),_.chatStatus=h.chatStatus,(_.isMini&&2!=_.chatStatus||1==_.echatInnerFrame)&&(_.inviteTimeout&&clearTimeout(_.inviteTimeout),_.publish("endSurfer")),_.isReady||(_.isReady=!0,_.publish("__ready")),_.isMini||1!=h.chatStatus&&2!=h.chatStatus||!_.visitorEventObj||(_.publish("sendVisitorEvent",_.visitorEventObj),_.visitorEventObj=null);var y=h.unreadMsgNumber||h.mNumber;if(y){if(_.setDocumentTitle("s"),_.miniUnfold)return;_.msgNum+=parseInt(y),a(".echat-mini-num").html(_.msgNum>9?"9+":_.msgNum).show(),_.publish("__newMsg",_.msgNum)}_.publish("__newEvent",{act:100,eventAction:"staffStatus",eventLabel:h.status}),setTimeout(function(){_.hasMini||a.cookie("ECHAT_"+_.companyId+"_"+_.visitorId+"_miniHide","0")},2e3)}),this.subscribe("staffInfo",function(a,c){var h=c.staffDetailInfo||{};_.chatStatus=2,_.staffLabel={staffId:c.staffId,staffNickName:c.staffNickName||"",staffPhone:h.staffPhone||"",staffHead:h.staffHead||"",staffInfo:h.staffInfo||""},_.publish("__newEvent",{act:100,eventAction:"chatStaffInfo",eventLabel:JSON.stringify({staffId:c.staffId,staffNickName:c.staffNickName||"",staffHead:h.staffHead||"",staffInfo:h.staffInfo||"",recordId:"1_"+c.talkId})})}),this.sendBaseInfo=function(){var c=_.initMid,h=a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read");c&&h&&(c=Math.max(c,h)),c="undefined"!=c&&c?parseInt(c):void 0,_.checkTitle(),this.baseInfo={et:101,companyId:_.companyId,page:location.href,title:_.documentTitle,referrer:_.referrer||"",media:_.Device.media,browserName:_.Browser.browser,browserVersion:_.Browser.version,osName:_.Device.OS,firstEnterUrl:_.firstUrl,firstEnterTitle:_.firstTitle,echatTag:_.echatTag||void 0,screenResolution:window.screen.width+"x"+window.screen.height,mid:c},_.bot&&(this.baseInfo.bot=1),ECHATObjKeyMap.cometdId.preClientId&&(this.baseInfo.preClientId=ECHATObjKeyMap.cometdId.preClientId),this.publish("sendVisitorEvent",this.baseInfo)};var y=location.href;this.getChatLink=function(a){function c(c){for(var h,i=0;i<c.length;i++)h=c[i],("undefined"!=typeof _.queryParams[h]||"undefined"!=typeof a[h])&&(g+="&"+h+"="+encodeURIComponent("undefined"!=typeof a[h]?a[h]:_.queryParams[h]))}a=a||{};var h,v,g;(h=a.chatWindowParam||_.chatWindowParam)&&(h=JSON.stringify({maxWidth:h.maxWidth,maxHeight:h.maxHeight,bgColor:h.bgColor,bgImage:h.bgImage,bgRepeat:h.bgRepeat})),v=a.visEvt||_.visitorEventData||_.visEvt,"object"==typeof v&&(v=JSON.stringify(v)),g="?companyId="+_.companyId,1==a.autoPop&&(g+="&autoPop=1&autoChat="+a.autoChat),g+="&encryptVID="+encodeURIComponent(window.encryptVID||"")+"&chatVisitorId="+encodeURIComponent(window.chatVisitorId||"")+(1==a.acceptInvite?"&acceptInvite=1":""),c(["routeEntranceId","platformSign","metaData","formData","myData","info","echatTag","fastQuestion","lan","defaultLan","pushInfo","subscribeUnread","acdStaffId","acdType","echatTitleBar","businessUrl","businessIcon","fm","multipleFile"]),_.checkTitle(),g+=(h?"&chatWindowParam="+encodeURIComponent(h):"")+(v?"&visEvt="+encodeURIComponent(v):"")+"&enterUrl="+encodeURIComponent(y)+"&enterTitle="+encodeURIComponent(_.documentTitle)+"&firstUrl="+encodeURIComponent(_.firstUrl)+"&firstTitle="+encodeURIComponent(_.firstTitle)+(_.referrer?"&referrer="+encodeURIComponent(_.referrer):"")+(_.echatIframeDisable?"&echatIframeDisable="+(_.echatIframeDisable||""):"")+"&fromHost="+encodeURIComponent(window.location.protocol+"//"+window.location.host)+(_.dataHost?"&dataHost="+encodeURIComponent(_.dataHost):"");var w=this.loaderHost+"/visitor/",b=_.Device.getZoomLevel();return{chatLink:w+(_.Browser.isMobile?"mobile/chat.html":"pc/chat.html")+g,miniLink:w+(_.Browser.isMobile?.9>b|b>1.1?"mobile/miniMB2.html":"mobile/miniMB.html":"pc/miniPC.html")+g,params:g}},this.initMiniHTML=function(){if(!document.getElementById("ECHAT_mini_chat")){var c;if(_.data={icon:{enable:0},invite:{enable:0}},_.Browser.isMobile?0==a("#echat_mini_holder").results.length&&(c='<div class="echat-mini-holder echat-hide" id="echat_mini_holder"></div>'):0==a("#ECHAT_mini").results.length&&(c='<div id="ECHAT_mini" class="echat echat-mini echat-hide echat-left-bottom" style="margin: 0px 10px 23px; display: block;">  <div id="ECHAT_mini_win" class="echat echat-mini-win">  <div id="ECHAT_menu" class="echat-mini-btn echat-menu"><div class="echat-menu-list"><a draggable="false" class="echat-menu-item echat-menu-item-min" onclick="ECHAT.hideMiniChat(this)" onmousedown="return false" href="javascript:;"><img src="'+_.loaderHost+'/res/style/e/s3/mini_min.png"/></a><a draggable="false" class="echat-menu-item echat-menu-item-max" onclick="return ECHAT.maxMiniChat(this)" ><img src="'+_.loaderHost+'/res/style/e/s3/mini_max.png"/></a><a draggable="false" class="echat-menu-item echat-menu-item-close" onclick="ECHAT.closeMiniChat(this)" href="javascript:;"><img src="'+_.loaderHost+'/res/style/e/s3/mini_close.png"/></a></div></div>    <iframe id="ECHAT_mini_chat" name="ECHAT_mini_chat" scrolling="no" border="0" allowtransparency="true" frameborder="0" ondragstart="return false" onselectstart="return false" onselect="if(document.selection)document.selection.empty()" oncopy="document.selection.empty()" onbeforecopy="return false"></iframe> </div><div id="echat_mm" class="echat-movable-cover"></div></div>'),!c)return;var h=document.createElement("div");h.innerHTML=c;for(var v,g=document.getElementsByTagName("body")[0],w=h.childNodes,i=0;v=w[i++];)1==v.nodeType&&(v=v.cloneNode(!0),g.appendChild(v));w=null,h=null}},this.initCheckChatStatus=function(){},this.initCheckNewMsg=function(){},this.parseParamMobile=function(c,v){var g=document.createElement("div"),w="",b=null;if(c.icon.buttonCanClose=0,c.icon){if("0"==c.icon.mobileType&&1==c.icon.buttonEnable){var y=v.offline?c.icon.buttonOfflineImg:c.icon.buttonOnlineImg,C=new Image;C.onload=function(){var v=a("#ECHAT_icon"),g=a("#ECHAT_icon_link"),w=this.width/2,b=this.height/2,_=h(c.icon.buttonDir||"right-center",c.icon.buttonSideMargin||0,c.icon.buttonBottomMargin||0,w,b);_.width=w+"px",_.height=b+"px",_.display="block",v.css(_),g.css({width:w+"px",height:b+"px"})},b='<div id="ECHAT_icon" class="echat echat-icon echat-'+(0!=c.icon.buttonDir&&c.icon.buttonDir?c.icon.buttonDir:"right-center")+'" style="display:none;"><div id="ECHAT_icon_link" class="echat-icon-link"  onclick="return ECHAT.miniChat(this,1)""> <img id="ECHAT_icon_img"  alt="'+ECHAT.LANG.iconTitle+'" class="echat-icon-img big_icon_inv" src="'+y+'"/><span class="echat-mini-num"></span></div></div>'}else if("1"==c.icon.mobileType&&1==c.icon.mobileTextEnable){var I=v.offline?c.icon.mobileOfflineTxt:c.icon.mobileOnlineTxt;b=' <div id="ECHAT_icon" class="echat echat-icon echat-icon-mb echat-'+c.icon.mobileDir+'" style="text-align:center;display:block;margin:'+(c.icon.mobileBottomMargin||0)+"px "+(c.icon.mobileSideMargin||0)+'px !important;">   <div id="ECHAT_icon_linkmb2" class="echat-icon-mb-text"    style="display:block;background: '+(c.icon.mobileBackColor||"false")+';color: #ffffff;"    onclick="return ECHAT.miniChat(this,2)">'+(I||ECHAT.LANG.clickChat)+' </div><div class="echat-mini-num"></div></div>'}!c.icon.renderId&&b&&(w+=b,b=null)}if(_.initInvite=function(h){_.initInvite=null;var v=new Image;v.onload=function(){var v=this.width/2,g=this.height/2;a("#ECHAT_invite").css({width:v+"px",height:g+"px",marginLeft:-v/2+"px",marginTop:-g/2+"px"}),"0"!=c.invite.enable?(_.inviteTimeout&&clearTimeout(_.inviteTimeout),_.hasMini||_.companyOff||(_.inviteTimeout=setTimeout(function(){var c=a("#ECHAT_invite");c.css({visibility:"visible"}),_.hasMini||_.companyOff||(c.show(),_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Show"}))},c.invite.inviteDelaySeconds?1e3*parseInt(c.invite.inviteDelaySeconds):0))):h?(a("#ECHAT_invite").css({visibility:"visible"}).show(),_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Show"})):a("#ECHAT_invite").hide().css({visibility:"visible"})};var g,w;c.invite.inviteAccpetBtnImg&&(g=new Image,g.onload=function(){a("#ECHAT_invite_accept").css({width:this.width/2+"px",height:this.height/2+"px",lineHeight:this.height/2+"px",background:"url("+c.invite.inviteAccpetBtnImg+") no-repeat",backgroundSize:this.width/2+"px,"+this.height/2+"px"})}),"1"==c.invite.inviteCanCancel&&c.invite.inviteCancelBtnImg&&(w=new Image,w.onload=function(){a("#ECHAT_invite_reject").css({width:this.width/2+"px",height:this.height/2+"px",lineHeight:this.height/2+"px",background:"url("+c.invite.inviteCancelBtnImg+") no-repeat",backgroundSize:this.width/2+"px,"+this.height/2+"px"})});var b=("1"==c.invite.inviteType?'  <img id="ECHAT_invite_bg"  class="echat-invite-bg" src="'+c.invite.inviteBackImg+'"/>  <div class="echat-invite-container">    <div class="echat-invite-title" style="'+(c.invite.inviteTitlePos||"")+';">'+(c.invite.inviteTitleTxt||"")+'</div>    <div class="echat-invite-text" style="'+(c.invite.inviteContentPos||"")+';">'+(c.invite.inviteContentTxt||"")+'</div>  </div>   <div id="ECHAT_invite_accept" class="echat-invite-accept" style="'+(c.invite.inviteAcceptBtnPos||"")+';" onclick="return ECHAT.miniChat(this,3)">     <span>'+(c.invite.inviteAcceptTxt||"&nbsp;")+"</span></div>"+("1"==c.invite.inviteCanCancel?'   <div id="ECHAT_invite_reject" class="echat-invite-reject" style="'+(c.invite.inviteCancelBtnPos||"")+';" onclick="ECHAT.rejectInvite(this,1)">'+(c.invite.inviteCancelTxt||"")+"</div>":""):'<div class="echat_invite_mask" id="ECHAT_invite_mask" onclick="return ECHAT.miniChat(this,3)" >  <img id="ECHAT_invite_bg" class="echat-invite-bg big_icon_inv" src="'+c.invite.inviteBackImg+'"/></div>')+("1"==c.invite.inviteCanClose&&c.invite.inviteCloseBtnImg?'<div id="ECHAT_invite_close" class="echat-invite-close cursor-p" style="'+c.invite.inviteCloseBtnPos+';line-height:0;" onclick="ECHAT.rejectInvite(this,2)"><img class="cursor-p button_icon" alt="'+ECHAT.LANG.close+'" src="'+c.invite.inviteCloseBtnImg+"\" onload=\"this.style.width=this.naturalWidth/2+'px';this.style.height=this.naturalHeight/2+'px';\"/></div>":"")+"</div>";v&&(v.src=c.invite.inviteBackImg),g&&(g.src=c.invite.inviteAccpetBtnImg),w&&(w.src=c.invite.inviteCancelBtnImg),document.getElementById("ECHAT_invite").innerHTML=b},"0"!=c.invite.enable&&setTimeout(_.initInvite,10),w+='<div id="ECHAT_invite" class="echat echat-invite '+("0"==c.invite.inviteType?"allimg":"")+'" style="visibility:hidden;display:'+(v.offline?"none;":"block;")+'"></div>',0==a("#echat_mini_holder").results.length&&(w=w+'<div class="echat-mini-holder echat-hide" id="echat_mini_holder">'+("file:"==location.protocol?'<div class="echat-mini-close" onclick="ECHAT.hideMiniChat()"></div>':"")+"</div>"),b){var T=document.createElement("div");T.id="ECHAT_icon_wrap",T.className="echat-icon-static",T.innerHTML=b,document.getElementById(c.icon.renderId).appendChild(T)}var E=navigator.userAgent.toLowerCase(),H=E.match(/bidubrowser|baidubrowser/i);if(_.Browser.isAndroid&&H&&a("body").addClass("android-bidubrowser"),_.isHuawei?(a("body").addClass("huawei"),_.Browser.isAndroid&&-1!=E.indexOf("baiduboxapp")&&a("body").addClass("android-baiduboxapp")):_.Browser.isIOS&&-1!=E.indexOf("baidubrowser")?a("body").addClass("ios-baidubrowser"):_.Browser.isAndroid&&E.match(/lite baiduboxapp/i)?a("body").addClass("android-lite-baiduboxapp"):_.Browser.isAndroid&&E.match(/baiduboxapp/i)?a("body").addClass("android-baiduboxapp"):_.Browser.isAndroid&&E.match(/vivobrowser/i)&&_.Browser.version<66&&a("body").addClass("android-vivo"),_.Browser.isAndroid&&H){var A="0"==c.icon.mobileType?c.icon.buttonDir:c.icon.mobileDir;A=-1!=A.indexOf("top")?0:-1!=A.indexOf("center")?.5:1,window.addEventListener("scroll",function(){var c=a("body").results[0].scrollTop;a("#ECHAT_icon").css("top",window.innerHeight*A+c+"px"),a("#ECHAT_invite").css("top",.5*window.innerHeight+c+"px")});var M=a("body").results[0].scrollTop;a("#ECHAT_icon").css("top",window.innerHeight*A+M+"px"),a("#ECHAT_invite").css("top",.5*window.innerHeight+M+"px")}g.innerHTML=w;for(var S,k=documen];)1==S.nodeType&&(S=S.cloneNode(!0),k.appendChild(S));B=null,k=null,C&&(C.src=y),document.getElementById("echat_mini_holder").addEventListener("touchmove",function(e){return e.preventDefault&&e.preventDefault(),!1},!1)},this.parseParam=function(c){if(_.hasParsedParam)return void _.publish("companyState",c);if(_.hasParsedParam=!0,1==_.Device.media)var g={invite:c.inviteBoxInfo,icon:c.chatButtonInfo};else var g={invite:c.mobileInviteBoxInfo,icon:c.mobileChatButtonInfo};var w=this.data={offline:_.companyOff,blacklist:!1,themeColor:g.icon.innerColor,textColor:"#FFFFFF",miniToBlank:!1,invite:g.invite,icon:g.icon};1==_.echatInnerFrame&&(w.invite.enable="0");var b=_.getChatLink();_.chatParam=b.params;var y=_.chatLink=b.chatLink;if(_.miniLink=b.miniLink,_.needHttps){var C,I;if(g.invite){C=["inviteAccpetBtnImg","inviteBackImg","inviteCancelBtnImg","inviteCloseBtnImg"];for(var i=0;i<C.length;i++)I=g.invite[C[i]],I&&(g.invite[C[i]]=I.replace(/^http:/,_.needHttps))}if(g.icon){C=["buttonCloseIconImg","buttonOfflineImg","buttonOnlineImg","innerOfflineImg","innerOnlineImg"];for(var i=0;i<C.length;i++)I=g.icon[C[i]],I&&(g.icon[C[i]]=I.replace(/^http:/,_.needHttps))}}if(1!=_.Device.media||_.Browser.isMobile)return this.parseParamMobile(g,w,_.chatLink,_.miniLink);var T=document.createElement("div"),E="",H=null;if(g.icon.buttonCanClose=0,g.icon&&1==g.icon.buttonEnable){var A=w.offline?g.icon.buttonOfflineImg:g.icon.buttonOnlineImg,M=new Image;M.onload=function(){var c=a("#ECHAT_icon"),v=a("#ECHAT_icon_link");"0"==g.icon.buttonEnable?c.hide():c.show();var w=this.width,b=this.height,y=h(g.icon.buttonDir||"right-center",g.icon.buttonSideMargin||0,g.icon.buttonBottomMargin||0,w,b);if(y.width=w+"px",y.height=b+"px",c.css(y),v.css({width:w+"px",height:b+"px"}),correctPNG(document.getElementById("ECHAT_icon_img")),_.ie6){var C=document.getElementById("ECHAT_icon_img");C.style.width=w+"px",C.style.height=b+"px"}},H='<div id="ECHAT_icon" class="echat echat-icon echat-'+(0!=g.icon.buttonDir&&g.icon.buttonDir?g.icon.buttonDir:"right-center")+'" style="display:none;">'+("0"==g.icon.buttonOpenType?'<div target="_blank" id="ECHAT_icon_link" class="echat-icon-link" href="'+y+'" onclick="return ECHAT.miniChat(this,0)"><img id="ECHAT_icon_img" alt="'+ECHAT.LANG.iconTitle+'" class="echat-icon-img" src="'+A+'" /><span class="echat-mini-num"></span></div>':'<a target="_blank" id="ECHAT_icon_link" class="echat-icon-link" href="'+y+'" onclick="return ECHAT.iconChat(this)"><img id="ECHAT_icon_img" alt="'+ECHAT.LANG.iconTitle+'" class="echat-icon-img" src="'+A+'" /><span class="echat-mini-num"></span></a>')+"</div>",g.icon.renderId||(E+=H,H=null)}_.initInvite=function(c){_.initInvite=null;var h=new Image;h.onload=function(){var h=this.width,v=this.height;if(a("#ECHAT_invite").css({width:h+"px",height:v+"px",marginLeft:-h/2+"px",marginTop:-v/2+"px"}),correctPNG(document.getElementById("ECHAT_invite_bg")),_.ie6){var w=document.getElementById("ECHAT_invite_bg");w.style.width=h+"px",w.style.height=h+"px"}"0"!=g.invite.enable?(_.inviteTimeout&&clearTimeout(_.inviteTimeout),_.hasMini||_.companyOff||(_.inviteTimeout=setTimeout(function(){var c=a("#ECHAT_invite");c.css({visibility:"visible"}),_.hasMini||_.companyOff||(c.show(),_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Show"}))},g.invite.inviteDelaySeconds?1e3*parseInt(g.invite.inviteDelaySeconds):0))):c?(a("#ECHAT_invite").css({visibility:"visible"}).show(),_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Show"})):a("#ECHAT_invite").hide().css({visibility:"visible"})};var v,w;g.invite.inviteAccpetBtnImg&&(v=new Image,v.onload=function(){a("#ECHAT_invite_accept").css({width:this.width+"px",height:this.height+"px",lineHeight:this.height+"px",background:"url("+g.invite.inviteAccpetBtnImg+") no-repeat"})}),"1"==g.invite.inviteCanCancel&&g.invite.inviteCancelBtnImg&&(w=new Image,w.onload=function(){a("#ECHAT_invite_reject").css({width:this.width+"px",height:this.height+"px",lineHeight:this.height+"px",background:"url("+g.invite.inviteCancelBtnImg+") no-repeat"})});var b=("1"==g.invite.inviteType?'  <img id="ECHAT_invite_bg" class="echat-invite-bg" src="'+g.invite.inviteBackImg+'"/>  <div class="echat-invite-container">    <div class="echat-invite-title" style="'+(g.invite.inviteTitlePos||"")+';">'+(g.invite.inviteTitleTxt||"")+'</div>    <div class="echat-invite-text" style="'+(g.invite.inviteContentPos||"")+';">'+(g.invite.inviteContentTxt||"")+'</div>  </div>   <a id="ECHAT_invite_accept" class="echat-invite-accept" style="'+(g.invite.inviteAcceptBtnPos||"")+';" onclick="return ECHAT.inviteChat(this)" href="'+y+'" target="_blank">     <span>'+(g.invite.inviteAcceptTxt||"&nbsp;")+"</span></a>"+("1"==g.invite.inviteCanCancel?'   <div id="ECHAT_invite_reject" class="echat-invite-reject" style="'+(g.invite.inviteCancelBtnPos||"")+';" onclick="ECHAT.rejectInvite(this,1)">'+(g.invite.inviteCancelTxt||"")+"</div>":""):'<a target="_blank" class="echat_invite_mask" id="ECHAT_invite_mask" href="'+y+'" onclick="return ECHAT.inviteChat(this)">  <img id="ECHAT_invite_bg" class="echat-invite-bg" src="'+g.invite.inviteBackImg+'"/></a>')+("1"==g.invite.inviteCanClose&&g.invite.inviteCloseBtnImg?'<div id="ECHAT_invite_close" class="echat-invite-close cursor-p" style="'+g.invite.inviteCloseBtnPos+';" onclick="ECHAT.rejectInvite(this,2)"><img onload="correctPNG(this)" class="cursor-p" alt="'+ECHAT.LANG.close+'" src="'+g.invite.inviteCloseBtnImg+'"/></div>':"");h&&(h.src=g.invite.inviteBackImg),v&&(v.src=g.invite.inviteAccpetBtnImg),w&&(w.src=g.invite.inviteCancelBtnImg),document.getElementById("ECHAT_invite").innerHTML=b},"0"!=g.invite.enable&&setTimeout(_.initInvite,10),E+='<div id="ECHAT_invite" class="echat echat-invite '+("0"==g.invite.inviteType?"allimg":"")+'" style="visibility:hidden;display:'+(w.offline?"none;":"block;")+'"></div>';var S=w.offline?g.icon.innerOfflineTxt:g.icon.innerOnlineTxt,k=w.offline?g.icon.innerOfflineImg:g.icon.innerOnlineImg,B=["margin:0 "+(g.icon.innerSideMargin||10)+"px "+(g.icon.innerBottomMargin?g.icon.innerBottomMargin+"px;":"0;"),w.themeColor?"background-color:"+w.themeColor+";":""];if(E=E+'  <a  id="ECHAT_mini_icon" style="display:'+("0"==g.icon.innerEnable?"none;":"block;")+B.join("")+';"  class="echat echat-mini echat-mini-icon cursor-p  echat-'+(0!=g.icon.innerDir&&g.icon.innerDir?g.icon.innerDir:"left-bottom")+'" onclick="return ECHAT.miniChat(this,2)">'+(k?'    <div class="echat-mini-img cursor-p"  style="display:'+(k?"block":"none")+';"><img width="26"  height="18" onload="correctPNG(this)" class="echat-mini-img-img" src="'+(k||"")+'"/></div>':"")+'    <div class="echat-mini-text cursor-p" style="padding-left:'+(k?"44":"14")+'px;">'+(S||ECHAT.LANG.clickChat)+'</div>    <div class="echat-mini-num"></div>  </a>',0==a("#ECHAT_mini").results.length&&(B.splice(B.length-1,1),E=E+'<div id="ECHAT_mini" class="echat echat-mini echat-hide echat-mini-pc echat-'+(0!=g.icon.innerDir&&g.icon.innerDir?g.icon.innerDir:"left-bottom")+' " style="'+B.join("")+'">  <div id="ECHAT_mini_win" class="echat echat-mini-win">    <div id="ECHAT_menu"  class="echat-mini-btn echat-menu" ><div class="echat-menu-list"><a draggable="false" class="echat-menu-item echat-menu-item-min" onclick="ECHAT.hideMiniChat(this)" href="javascript:;"></a><a draggable="false" class="echat-menu-item echat-menu-item-max" onclick="return ECHAT.maxMiniChat(this)" target="_blank" href="'+_.chatLink+'" ></a><a draggable="false" class="echat-menu-item echat-menu-item-close" onclick="ECHAT.closeMiniChat(this)" href="javascript:;"></a></div></div>    <iframe id="ECHAT_mini_chat" name="ECHAT_mini_chat" scrolling="no" border="0" allowtransparency="true" frameborder="0" ondragstart="return false" onselectstart="return false" onselect="if(document.selection)document.selection.empty()" oncopy="document.selection.empty()" onbeforecopy="return false"></iframe>  </div><div id="echat_mm" class="echat-movable-cover"></div></div>'),H){var I=document.createElement("div");I.id="ECHAT_icon_wrap",I.className="echat-icon-static",I.innerHTML=H,document.getElementById(g.icon.renderId).appendChild(I)}this.coverFlash(),T.innerHTML=E;for(var L,P=document.getElemenodes,i=0;L=D[i++];)1==L.nodeType&&(L=L.cloneNode(!0),P.appendChild(L));D=null,P=null,M&&(M.src=A),_.ie6&&_.parseIE6Png(),v(g.icon),a("#ECHAT_mini").on("click",".echat-site-back-icon",function(){_.hideInnerURLPage()})},this.setViewImgBox=function(){var a='<div id="ECHAT_IMG_VIEW" class="ECHAT_IMG_VIEW hide" draggable="false"><div class="img-play-close"></div><div class="img-play-foot"><div class="img-play-pre img-play-btn"><i class="img-play-pre-icon"></i></div><div class="img-play-next img-play-btn cursor-p"><i class="img-play-next-icon"></i></div><a class="img-play-download img-play-btn cursor-p" target="downFile"><i class="img-play-download-icon"></i></a><div class="img-play-rotate img-play-btn cursor-p"><i class="img-play-rotate-icon"></i></div></div><div class="img-play-resize"></div><div id="echat_img_play_loading" class="img-play-loading"></div><ul id="echat_img_play_list" class="clearfix img-play-list transition"></ul></div>',c=document.getElementsByTagName("body")[0],h=document.createElement("div");
h.innerHTML=a,c.appendChild(h.childNodes[0])},this.showImg=function(){var c=arguments[0].imgList,h=arguments[0].imgIndex,v=document.documentElement.clientHeight||a("body")[0].clientHeight||window.innerHeight,g=document.documentElement.clientWidth||a("body")[0].clientWidth||window.innerWidth,w=g>800?800:g-20,b=v>680?680:v-20;_.imgLength=c.length,_.imgIndex=h,_.setPreNext(),_.initSlideImgFlag||_.initSlideImg(),a("#echat_img_play_list").css({width:w*c.length+"px",height:b-100+"px",left:-w*_.imgIndex+"px"}).html(c.join("")),a("#echat_img_play_list li").css({width:w+"px",height:b-100+"px",lineHeight:b-100+"px"}),a(".img-play-btn").removeClass("hover-btn"),a(".img-play-close").removeClass("hover"),a("#img_dot_list").removeClass("hover"),a("#ECHAT_IMG_VIEW").css({width:w+"px",height:b+"px",left:(g-w)/2+"px",top:(v-b)/2+"px"}).removeClass("hide");var y=a(a(a("#echat_img_play_list").find("li").results[h]).find("img").results[0]),C=y.attr("attname"),I=y.attr("bigimg")||y.attr("big"),T=I.match(/[^\/]+\.[\w]+$/);a(".img-play-download").attr("href",I+(-1==I.indexOf("?")?"?":"&")+"attname="+((C?C:T?T[0]:0)||"Echat"+(new Date).format("yyyyMMddhhmmss")+".png"))},this.getFileUploadInfo=function(c,h){function v(a){var c={uploadUrl:a.uploadUrl,uploadHttpsUrl:a.uploadHttpsUrl,formMap:a.formMap,headerMap:a.headerMap,maxFileSize:a.maxFileSize||5120};h&&"function"==typeof h?h(c):_.publish("__newEvent",{act:100,eventAction:"setFileUploadInfo",eventLabel:c})}c="string"==typeof c?JSON.parse(c+""):c||{};var g=c.fileType||0,w=c.voiceDuration&&parseInt(c.voiceDuration);return"disconnected"==EChatQuery.cometd.getStatus()tf?"+_.packParam({from:1,companyId:_.companyId,encryptVId:window.encryptVID,metaData:_.metaCB:"jsonpCallback",success:function(a){a&&a.successful&&v(a.result)},error:function(){}}):(_.unSubscribe("getFileTokenParams"),_.subscribe("getFileTokenParams",function(a,c){_.unSubscribe("getFileTokenParams"),v(c)}),void _.publish("sendVisitorEvent",{et:128,ft:g,voiceDuration:w||void 0}))},this.setPreNext=function(){0==_.imgIndex?a(".img-play-pre").addClass("disabled"):a(".img-play-pre").removeClass("disabled"),_.imgIndex==_.imgLength-1?a(".img-play-next").addClass("disabled"):a(".img-play-next").removeClass("disabled")},this.initSlideImg=function(){function c(p,c){if(!(0>p||p>_.imgLength-1||p==_.imgIndex)){var h=a(a(a("#echat_img_play_list").find("li").results[p]).find("img").results[0]),v=h.attr("attname"),g=h.attr("bigimg")||h.attr("big");if(h.attr("loaded"))a("#echat_img_play_loading").hide();else{a("#echat_img_play_loading").show();var w=new Image;h.css({top:0,left:0}),w.onload=function(){h.css("visibility","hidden"),h.attr("src",h.attr("bigimg")),w.onload=null,w=null,h=null},w.src=g}var b=g.match(/[^\/]+\.[\w]+$/);if(a(".img-play-download").attr("href",g+(-1==g.indexOf("?")?"?":"&")+"attname="+((v?v:b?b[0]:0)||"Echat"+(new Date).format("yyyyMMddhhmmss")+".png")),c){var ul=a("#echat_img_play_list"),y=a(a("#echat_img_play_list").find("li").results[0]).width();_.setTransform.call(ul,-y*p,0),ul.attr("x",-y*p)}_.imgIndex=p,_.setPreNext()}}function h(){}function v(){function c(e){if(I){var x=T.x-(e.pageX||e.clientX),c=T.y-(e.pageY||e.clientY);x=v.width-x,c=v.height-c,200>x&&(x=200),200>c&&(c=200),b.css({width:x+"px",height:c+"px"}),a("#echat_img_play_list li").css({width:x+"px",height:c-100+"px",lineHeight:c-100+"px"}),a("#echat_img_play_list").css({width:x*a("#echat_img_play_list li").length+"px",height:c+"px",left:-x*_.imgIndex+"px"}),(x-8<h.width||c-100<h.height)&&g.css({width:x-8+"px"})}w()}var h,v,g,C=a(".img-play-resize"),I=0,T={x:0,y:0};C.on("mousedown",function(e){g=a(a(a("#echat_img_play_list").find("li").results[_.imgIndex]).find("img").results[0]),I=1,T={x:e.pageX||e.clientX,y:e.pageY||e.clientY},v={width:b.width(),height:b.height()},h={width:g.results[0].naturalWidth,height:g.results[0].naturalHeight},e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),w(),y.on("mousemove",c)}),y.on("mouseup",function(){I&&(I=0,y.off("mousemove",c))}),a(window).on("resize",function(){var c=document.documentElement.clientHeight||a("body")[0].clientHeight||window.innerHeight,h=document.documentElement.clientWidth||a("body")[0].clientWidth||window.innerWidth,v={width:b.width(),height:b.height()};b.css({top:(c-v.height)/2+"px",left:(h-v.width)/2+"px"})})}function g(){function c(e){if(T){var a={};h.width<v.width&&(a.left=v.offsetLeft+(e.pageX||e.clientX)-E.x+"px"),h.height<v.height&&(a.top=v.offsetTop+(e.pageY||e.clientY)-E.y+"px"),g.css(a),C=1}else if(I){var c=e.pageX-E.x,_=e.pageY-E.y;b.css({left:h.left+c+"px",top:h.top+_+"px"})}w()}var h,v,g,I=0,T=0,E={};b.on("mousedown",function(e){g=a(a(a("#echat_img_play_list").find("li").results[_.imgIndex]).find("img").results[0]),h={width:b.width(),left:b.results[0].offsetLeft,top:b.results[0].offsetTop,height:b.height()},v={width:g.results[0].clientWidth,height:g.results[0].clientHeight,offsetLeft:g.results[0].offsetLeft,offsetTop:g.results[0].offsetTop},E={x:e.pageX||e.clientX,y:e.pageY||e.clientY},h.width<v.width||h.height-100<v.height?T=1:I=1,y.on("mousemove",c),e.stopPropagation&&e.stopPropagation(),w()}),y.on("mouseup",function(){(T||I)&&(T=0,I=0,g=null,y.off("mousemove",c))})}_.initSlideImgFlag=!0,window.centerImg=function(c,h){a("#echat_img_play_loading").hide();a("#ECHAT_IMG_VIEW").height();c.style.visibility="visible",h&&(a(c).attr("loaded","loaded"),c.onload=null)},a("#ECHAT_IMG_VIEW").on("click",".img-play-pre",function(){c(_.imgIndex-1,!0)}).on("click",".img-play-next",function(){c(_.imgIndex+1,!0)}).on("click",".img-play-close",function(){a("#ECHAT_IMG_VIEW").addClass("hide"),_.imgIndex=0}).on("click",".img-play-rotate",function(){var c=a(a(a("#echat_img_play_list").find("li").results[_.imgIndex]).find("img").results[0]);c.hasClass("rotate-90")?(c.removeClass("rotate-90"),c.addClass("rotate-180")):c.hasClass("rotate-180")?(c.removeClass("rotaterotate-270")?c.removeClass("rotate-270"):c.addClass("rotate-90")}).on("mouseover",".img-play-btn",function(){a(this).addClamouseover",function(){a(this).addClass("hover"),a("#ECHAT_IMG_VIEW .img-play-foot").addClass("hover")}).on("mouseout",fIEW .img-play-foot").removeClasose").addClass("hover")}).on("mouseout",function(){a(".img-play-close").removeClass("hover")});var w="getSelection"in window?function(){window.getSelection().removeAllRanges()}:function(){document.selection.empty()},b=a("#ECHAT_IMG_VIEW"),y=a("body");v();var C=0;g();var I=2;a("#ECHAT_IMG_VIEW").on("mousewheel","img",function(e){var c=this,v=c.width-e.deltaY/1.5;return 30>v&&(v=30),v>c.naturalWidth*I&&(v=c.naturalWidth*I),a(c).css({maxWidth:"10000px",maxHeight:"10000px",width:v+"px"}),h(),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}),a("#ECHAT_IMG_VIEW").on("keydown",function(e){var a=e.keyCode;return a>=37&&40>=a?(e.preventDefault||e.preventDefault(),!1):void 0}),a(document).on("keydown",function(e){e=e||window.event,e=e||window.event;var h=e.keyCode||e.which||e.charCode||0;37!=h&&39!=h||a("#ECHAT_IMG_VIEW").hasClass("hide")||(37==h?c(_.imgIndex-1,!0):39==h&&c(_.imgIndex+1,!0))})},this.setTransform=function(x,c){a(this).css({left:x+"px",top:c+"px"})},this.coverFlash=function(){},this.showInvite=function(){},this.showIcon=function(){},this.init=function(){},this.postBridgeMessage=function(a){window.addEventListener&&document.getElementById("echatBridgeIframe")&&(document.getElementById("echatBridgeIframe").contentWindow||document.frames.echatBridgeIframe).postMessage(a,"*")},this.subscribe("_openChat",function(a,c){if("blank"==c.type);else if("inner"==c.type);else if("default"==c.type){if(!_.Browser.isMobile&&_.openEchatWin&&!_.openEchatWin.closed)try{return void _.openEchatWin.focus()}catch(e){}if(1==_.echatInnerFrame&&!_.mixedCompany)return void _.postChatMessage({evt:"echatjs",type:"openChat"});var h;if("invite"==c.from&&(h={acceptInvite:1}),_.Browser.isMobile)_.openEchatWin=window.open(_.getChatLink(h).chatLink);else{if((2==_.chatStatus||1==_.chatStatus||"undefined"==typeof _.chatStatus)&&(_.targetWinName="ECHAT_WIN"+(new Date).getTime()),_.queryParams.chatWindowParam)return ECHAT.customNewWinChat(_.queryParams);var v=(window.screen.height-30-600)/2,g=(window.screen.width-10-900)/2;_.openEchatWin=window.open(_.getChatLink(h).chatLink,_.targetWinName,"width=900,height=600,top="+v+",left="+g+",directories=no,menubar=no,toolbar=no")}}}),this.msgBoxPageBack=function(){this.msgBoxWindow?this.msgBoxWindow.postMessage({evt:"echatjs",name:"msgBoxPageBack"},"*"):_.publish("__newEvent",{act:100,eventAction:"echatPageStatus",eventLabel:{event:3}})},_.canRefresh=!1,window.addEventListener&&(_.postMessageSources=[],window.addEventListener("message",function(e){if(e.data){var h=e.data,v=e.source;if("echatjs"!=h.evt){if(_.checkDomain(e.origin,[_.dataHost,_.loaderHost]))if("initWxSDK"!=h.type){if("echatViewImg"==h.type&&h.imgList&&h.imgList.length)return _.showImg(h);if("wxSwipeImage"==h.type)return void wx.previewImage({current:h.url[h.index||0],urls:h.url});if("msgbox"==h.type)return void("msgboxReady"==h.name?_.msgBoxWindow=v:"echatPageStatus"==h.name&&h.data&&_.publish("__newEvent",{act:100,eventAction:"echatPageStatus",eventLabel:h.data}));if(_.loaderHost&&e.origin==_.loaderHost){if(e.data&&e.data.isBridge)return _.handleBridge(e.data);if(2==e.data)_.canRefresh=!1;else if("miniReady"==e.data){if(_.miniReady=!0,_.postMessage({action:"sendMiniShowStatus",miniShow:_.miniUnfold,partScreen:_.partScreen,hasNative:_.hasNative}),_.visitorId&&!_.hasInitLocalHistory){var g="CHAT_HIS_"+_.companyId+"_"+_.visitorId;_.postMessage({type:"initLocalHistory",key:g,value:window.localStorage.getItem(g)||"",robotPhoneChatBox:window.localStorage.getItem("ECHAT_"+_.companyId+"_robotPhoneChatBox")||"",mobileChatBoxInfo:window.localStorage.getItem("ECHAT_"+_.companyId+"_mobileChatBoxInfo")||""}),_.hasInitLocalHistory=!0}for(var w in _.chatAppCache)_.postMessage({action:"echatPageService",params:_.chatAppCache[w]})}else if(3==e.data)_.canRefresh=!0;else if("hideMBmini"==e.data||"hideMini"==e.data)_.hideMiniChat();else if("hideMBminiNoBack"==e.data)_.hideMiniChat(!0,!0);else if("topScroll"==e.data);else if("inputScroll"==h.type)_.handleKeyboard.focus(h);else if("inputScrollStop"==e.data)_.handleKeyboard.blur(h);else if("noheader"==h.type)0===h.value?a("#echat_mini_holder").addClass("echat-hasheader"):a("#echat_mini_holder").removeClass("echat-hasheader");else if("toLeaveMessage"==e.data)a(".echat-staff").addClass("echat-hide");else if(100==e.data.act||200==e.data.act){if(100==e.data.act){if("chatStaffInfo"==e.data.eventAction||EChatQuery.cometd.getStatus().match(/connected|connecting/i)&&e.data.eventAction.match(/newMsg|newSysMsg|queuePostion/i))return;if("chatStaffInfo"==e.data.eventAction){var h=JSON.parse(e.data.eventLabel);delete h.userSetStaffPhoto,_.staffLabel=h}else"chatStatus"==e.data.eventAction&&(e.data.eventLabel.match(/^end/)?(_.chatStatus=4,_.staffLabel=""):"workorder"==e.data.eventLabel?_.chatStatus=0:"chatting"==e.data.eventLabel?(_.chatStatus=2,!_.isMini||a.cometd&&"disconnected"!=a.cometd.getStatus()||_.publish("initMiniChat",{fromInner:!0}),_.visitorEventData="",c()):e.data.eventLabel.match(/^leave/)?_.chatStatus=0:"waiting"==e.data.eventLabel&&(_.chatStatus=1,_.visitorEventData="",c()),_.miniChatStatus=e.data.eventLabel)}_.publish("__newEvent",e.data)}else 300==e.data.act?_.handleInnerURLPage(e.data):"native"==h.action&&h.params?_.__nativeAPI(h.params.functionName,h.params.value):"bridgePlatformNewMsg"==h.type&&h.data?(_.__nativeAPI("platformNewMsg",h.data),(500002==h.data.platformId||500003==h.data.platformId||20==h.data.platformId)&&_.showTip("platformNewMsg"+h.data.msgContent)):"initLocalHistory"==h.type?(!_.hasInitLocalHistory&&_.postMessage({type:"initLocalHistory",key:h.key,value:window.localStorage.getItem(h.key)||"",robotPhoneChatBox:window.localStorage.getItem("ECHAT_"+_.companyId+"_robotPhoneChatBox")||"",mobileChatBoxInfo:window.localStorage.getItem("ECHAT_"+_.companyId+"_mobileChatBoxInfo")||""}),_.hasInitLocalHistory=!0):"updateLocalHistory"==h.type||"updateLocalChatbox"==h.type?_.hasStorage&&a.store(h.key,h.value):"staffSendEvt"==h.type?_.publish("staffSendEvt",h.msg):"visitorSendEvt"==h.type?_.publish("visitorSendEvt",h.msg):"getStartChat"==h.type?_.publish("getStartChat",h.msg):"getPosMsg"==h.type&&_.publish("getPosMsg",h.msg);return!1}}else if("function"==typeof define&&(define.amd||define.cmd)&&"function"==typeof require)try{{require([h.src],function(a){window.wx=window.wx||a,_.postMessage({action:"hasWxSdk"})})}}catch(e){}else _.addJS(h.src,function(a){a!==!0&&_.postMessage({action:"hasWxSdk"})})}else{if("iframeScrollTo"==h.type&&_.postMessage({action:h.action,msg:{instance:h.msg.instance,distance:h.msg.distance,type:h.msg.type}}),!_.checkDomain(e.origin,[_.dataHost,_.loaderHost,location.host]))return;if("echatInnerFrame"==h.type&&v)try{var b={type:"echatInnerFrameCallback",companyId:_.companyId,visitorId:_.visitorId,chatVisitorId:window.chatVisitorId,encryptVID:window.encryptVID,metaData:_.metaData||""};v.postMessage(b,h.origin),-1==_.postMessageSources.indexOf(v)&&_.postMessageSources.push(v)}catch(e){}else"openChat"==h.type?h.arguments?_.openChatWindow(void 0,h.arguments.option,h.arguments.windowOptions):(_.postMessage({evt:"echatjs",type:"openChat"}),_.miniChat()):"closeFramePage"==h.type?(_.hideInnerURLPage(),_.__nativeAPI("closeUrlView")):"sendTextMsg"==h.type&&_.postMessage({evt:"echatjs",type:"sendTextMsg",content:h.content})}}},!0)),this.initTrailEvent=function(){function h(){_.initInvite&&_.initInvite(!0),setTimeout(function(){_.staffInvite++,_.inviteTimeout&&clearTimeout(_.inviteTimeout),a("#ECHAT_invite").show().css({visibility:"visible"})}),_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Show"})}function v(c,h){if(c.mid&&!b[c.mid]){b[c.mid]=1;var v;if("680"==c.mt&&(v='<a target="_blank" href="'+c.pushUrlDetail.url+'">'+c.pushUrlDetail.urlName+"</a>"),v=v||_.parseMsgByRule(c,w),v&&_.publish("__newEvent",{act:100,eventAction:1==h?"newMsg":"newSysMsg",eventLabel:v}),!_.Browser.isMobile){var g=a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read_click"),y=_.bridgeData&&_.bridgeData.midClick;g=y>g?y:g,(!g||g<c.mid)&&_.setDocumentTitle("s")}_.lasMid=_.lasMid||a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read")||0,_.lasGetMid=c.mid,_.miniUnfold&&c.mid?a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read",c.mid):"605"!=c.mt&&(_.msgNum++,a(".echat-mini-num").html(_.msgNum>9?"9+":_.msgNum).show(),_.publish("__newMsg",_.msgNum))}}function g(c,v){_.unSubscribe("staffInvite"),_.subscribe("staffInvite",h),_.chatStatus=4,_.staffLabel="",v&&v.content&&_.publish("getSysMsg",v),a.cookie("ECHAT_"+_.companyId+"_"+_.visitorId+"_miniHide","0")}this.subscribe("companyState",function(c,h){var v=_.companyOff;_.companyOff=2==h.status?!0:!1,v&&!_.companyOff?(_.offToOn=!0,_.onToOff=!1):!v&&_.companyOff?(_.onToOff=!0,_.offToOn=!1):(_.onToOff=!1,_.offToOn=!1),_.companyOff?(_.inviteTimeout&&clearTimeout(_.inviteTimeout),a("#ECHAT_invite").hide(),a(".echat-icon-img").attr("src",_.data.icon.buttonOfflineImg),a(".echat-mini-text").html(_.data.icon.innerOfflineTxt),a(".echat-mini-img-img").attr("src",_.data.icon.innerOfflineImg),a("#ECHAT_icon_linkmb2").html(_.data.icon.mobileOfflineTxt)):(a(".echat-icon-img").attr("src",_.data.icon.buttonOnlineImg),a(".echat-mini-text").html(_.data.icon.innerOnlineTxt),a(".echat-mini-img-img").attr("src",_.data.icon.innerOnlineImg),a("#ECHAT_icon_linkmb2").html(_.data.icon.mobileOnlineTxt),1==_.data.invite.enable&&(_.inviteTimeout&&clearTimeout(_.inviteTimeout),_.offToOn&&a("#ECHAT_invite").show().css({visibility:"visible"}),_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Show"}))),_.publish("__newEvent",{act:100,eventAction:"staffStatus",eventLabel:h.status})}),this.subscribe("staffChat",function(a,c){var h=_.companyOff;h&&(_.offToOn=!0,_.onToOff=!1),_.miniChat(void 0,5),_.postMessage({action:"staffChat",msg:c}),h&&(_.onToOff=!0,_.offToOn=!1)});var w={0:ECHAT.LANG.newMsg,605:"${content,0,200,1}",640:"${content,0,200,1}",641:ECHAT.LANG.imageMsg,642:ECHAT.LANG.fileMsg,647:"${content,0,200,1}",10011:ECHAT.LANG.customMsg,865:ECHAT.LANG.imageMsg,866:ECHAT.LANG.fileMsg};_.unSubscribe("getMsg"),_.unSubscribe("getSysMsg");var b={};_.subscribe("getMsg",function(a,c){if("10011"==c.mt){if(3==c.mst)return _.publish("getSysMsg",c);if(1==c.mst)return}v(c,1)}),_.subscribe("getSysMsg",function(a,c){return"647"==c.mt&&5==c.type?_.publish("getMsg",c):void(("647"!=c.mt||6!=c.type&&8!=c.type&&9!=c.type)&&v(c,2))}),_.subscribe("queuePostion",function(a,c){_.publish("__newEvent",{act:100,eventAction:"queuePostion",eventLabel:c.position||""})}),_.subscribe("visitorSendEvt",function(a,c){_.publish("__newEvent",{act:100,eventAction:"visitorSendMsg",eventLabel:c})}),_.subscribe("staffSendEvt",function(a,c){_.publish("__newEvent",{act:100,eventAction:"staffSendMsg",eventLabel:c})}),_.unSubscribe("__newMsg");var y=0;_.subscribe("__newMsg",function(a,c){y!=c&&(y=c,_.miniWinParam&&c>0&&!_.companyOff&&1==_.miniWinParam.enableOnlineChatWhenMsg&&_.miniChat(void 0,9))}),_.subscribe("clearGetMsg",function(c,h){_.msgNum=0,a(".echat-mini-num").hide().html(""),_.publish("__newMsg",_.msgNum),h&&h.mid&&a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read",h.mid)}),this.updateBridgeRead=function(a){window.addEventListener&&document.getElementById("echatBridgeIframe")&&(document.getElementById("echatBridgeIframe").contentWindow||document.frames.echatBridgeIframe).postMessage({update:!0,updateType:a.type,updateValue:a.value},"*")},this.subscribe("startChat",function(h,v){_.visitorEventData="",c(),2==v.chatStatus,_.miniUnfold&&4==_.chatStatus&&_.canRefresh&&_.restartMiniChat(),_.chatStatus=2,_.inviteTimeout&&clearTimeout(_.inviteTimeout),a("#ECHAT_invite").hide(),_.unSubscribe("staffInvite"),a(".echat-staff").removeClass("echat-hide")}),_.subscribe("endChat",g),this.subscribe("staffInvite",h),this.subscribe("_rejectInvite",function(){_.publish("sendVisitorEvent",{et:102,content:ECHAT.LANG.rejectInvite})})},this.supportPartScreen=function(){var a=navigator.userAgent.toLocaleLowerCase();if(_.Device.isIOS){if(-1!=a.indexOf("baidubrowser"))return!1}else _.Browser.isAndroid&&-1!=a.indexOf("baiduboxapp");return!0}(),this.hasPartScreen=!1,this.setMobilePageHeight=function(c){var h=c?c-0:!1;_.partScreen=h;var v=_.Device.getZoomLevel();(v>1.1||.9>v)&&(_.partScreen=h="number"==typeof h?_.partScreen/v:80/v);var g,w=document.documentElement;if(w&&a(w).removeClass("echat-html"),_.Browser.isMobile&&_.partScreen&&_.supportPartScreen){a("body").removeClass("echat-body-hide");var b="";"number"==typeof h?(b=h+"px",g="calc(100% - "+h+"px)"):_.partScreen&&(b="80px",g="calc(100% - 80px)"),a("#ECHAT_mini_chat").css({top:b,height:g}),a("body").addClass("echat-body-fix"),_.hasPartScreen=!0,a("#echat_mini_holder").addClass("echat-hastopheight")}else _.Browser.isMobile&&(a("body").removeClass("echat-body-fix"),a("#ECHAT_mini_chat").css({top:0,height:"100%"}))},this.rejectInvite=function(c,h){a("#ECHAT_invite").hide(),_.staffInvite&&_.publish("_rejectInvite"),2==_.data.invite.inviteTimes&&_.data.invite.inviteRepeat>0&&(_.inviteTimeout=setTimeout(function(){a("#ECHAT_invite").show().css({visibility:"visible"}),_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Show"}),_.data.invite.inviteRepeat=+_.data.invite.inviteRepeat-1},_.data.invite.inviteIntervalSeconds?1e3*+_.data.invite.inviteIntervalSeconds:5e3)),1==h?_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Refuse"}):2==h&&_.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Close"})},this.iconChat=function(){return _.publish("_openChat",{type:"default",from:"icon"}),!1},this.inviteChat=function(){return _.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Agree"}),_.publish("_openChat",{type:"default",from:"invite"}),!1},this.maxMiniChat=function(){return _.publish("_openChat",{type:"default",from:"mini"}),window.event&&window.event.preventDefault&&window.event.preventDefault(),!1},this.restartMiniChat=function(){this.miniUnfold=!0,_.miniLink=_.getChatLink(arguments[2]).miniLink,_.hasMini&&_.setMiniSrc(_.miniLink+"&time="+(new Date).getTime()+"#TOECHAT",{replace:!0})},this.sendTextMsg=function(a,c){if("undefined"!=typeof a){a+="";var h=!0;if(c||(c=function(){}),window.isEchatSdk)return _.sendTextMsgApi(a,c);h=1==_.echatInnerFrame?_.postChatMessage({evt:"echatjs",type:"sendTextMsg",content:a}):_.postMessage({evt:"echatjs",type:"sendTextMsg",content:a}),c({successful:h,msg:""})}},this.addStaffMsg=function(c,h){var v=(_.lasGetMid||_.initMid)+(new Date).getTime()%1e6/1e6,g=a.extend(c,{outerMsg:1,mt:640,mid:v,id:v,tm:(new Date).getTime()});c.mt&&(g.mt=c.mt),(1==_.chatStatus||2==_.chatStatus)&&(_.publish("getMsg",g),_.postMessage({evt:"echatPlugin",type:"addStaffMsg",msg:g,autoMsg:h}))},this.closeFramePage=function(){_.__nativeAPI("closeUrlView"),_.postChatMessage({evt:"echatjs",type:"closeFramePage",url:location.href})},this.ltIE9=_.Browser.isIE&&_.Browser.version<9,this.ltIE8=_.Browser.isIE&&_.Browser.version<8,this.initScale=function(){if(_.Browser.isMobile){var c=_.Device.getZoomLevel();1!=c&&a(".echat").css("zoom",1/c)}_.initScale=!1;for(var h,v=document.getEle"),i=0;i<v.length;i++)if(h=v[i],"viewport"==h.name||"viewport"==h.getAttribute("name")){h.setAttribute("id","echatTempViewport"),_.viewportContent=h.getAttribute("content");break}_.toggleViewport=function(a){return}},this.miniChat=function(c,h,v,g){if(1==_.echatInnerFrame)return void(_.mixedCompany?_.openEchatWin=window.open(_.getChatLink(v).chatLink):_.postChatMessage({evt:"echatjs",type:"openChat"}));var w={event:7,eventValue:{companyId:_.companyId,companyName:_.companyName}};_.__nativeAPI("echatPageStatus",w),_.publish("__newEvent",{act:100,eventAction:"echatPageStatus",eventLabel:w}),_.initScale&&_.initScale();var b=!this.miniUnfold,y=_.hasMini;0==a("#ECHAT_mini_chat").results.length&&_.initMiniHTML(),this.miniUnfold=!0,_.toggleViewport&&_.toggleViewport(!0);var C=6==h||!y&&_.visitorId&&(5==h||7==h)&&4!=_.chatStatus&&!_.Browser.isMobile&&1==a.cookie("ECHAT_"+_.companyId+"_"+_.visitorId+"_miniHide");!_.Browser.isMobile||y||6!=h&&7!=h||(C=!0),b||(C=!1),_.autoShowMini=8==h||9==h||10==h,C||(a("#ECHAT_mini_icon").hide(),a.cookie("ECHAT_"+_.companyId+"_"+_.visitorId+"_miniHide","0")),_.inviteTimeout&&clearTimeout(_.inviteTimeout),a("#ECHAT_invite").hide();var I=_.data;if(c&&c.nodeType&&I.miniToBlank)return a(c).attr("target","_blank").attr("href",_.getChatLink(v).chatLink),a("#ECHAT_icon").hide(),_.publish("_openChat",{type:"blank",from:"mini"}),!0;_.Browser.isMobile&&b&&(_.windowLastTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,document.body.scrollTop=0,window.scrollTo(0,0));var T=a("body").hasClass("echat-win-show"),E=!1;if(_.hasMini)2!=_.chatStatus&&1!=_.chatStatus&&_.miniLink.replace("&miniInitHide=1","")!=_.getChatLink(v).miniLink?(_.miniLink=_.getChatLink(v).miniLink,_.setMiniSrc(_.miniLink,{replace:!0}),E=!1):!_.isMini&&_.ltIE9||"leaveToUrl"==!_.miniChatStatus?(_.offToOn||4==_.chatStatus||5==h)&&_.restartMiniChat.dedup=1,v.visEvt.customizeMsgType=2,_.pushVisitorEvent(v.visEvt,!1,!0))),_.offToOn=!1;else{if(_.hasMini=!0,a(".echat-menu-item").on("mousedown",function(e){e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0}),_.Browser.isMobile){a("body").addClass("echat-win-show");var H=document.documentElement;H&&a(H).addClass("echat-html"),_.partScreen||a("body").addClass("echat-body-hide")}_.initHistoryLength=window.history.length||0,8==h&&2!=_.chatStatus&&(v=v||{},v.autoPop="1",v.autoChat=_.miniWinParam&&1==_.miniWinParam.enableOnlineChatWhenPop?"1":"0"),_.miniLink=_.getChatLink(v).miniLink,C&&(_.miniLink+="&miniInitHide=1"),_.setMiniSrc(_.miniLink)}2!=_.chatStatus&&1!=_.chatStatus&&3!=_.chatStatus&&(_.chatStatus=0);var A={},M=document.getElementById("ECHAT_mini"),S="auto !important",k="px !important";if(!_.Browser.isMobile&&!y){_.pcMiniWinParam=a.extend({left:void 0,right:void 0,bottom:void 0,width:400,height:550,min:!0,max:!0,close:!0},_.pcMiniWinParam),g=a.extend(_.pcMiniWinParam,g||{}),A.width=(g&&g.width||400)+k,A.height=(g&&g.height||550)+k,g&&(g.left?(A.left=g.left+k,A.right=S,A.marginLeft="0px",A.marginRight="0px"):g.right&&(A.left=S,A.right=g.right+k,A.marginLeft="0px",A.marginRight="0px"),g.bottom?(A.bottom=g.bottom+k,A.top=S):g.top&&(A.bottom=S,A.top=g.top+k),g.min===!1?a(".echat-menu-item-min").addClass("hide"):a(".echat-menu-item-min").removeClass("hide"),g.max===!1?a(".echat-menu-item-max").addClass("hide"):a(".echat-menu-item-max").removeClass("hide"),g.close===!1?a(".echat-menu-item-close").addClass("hide"):a(".echat-menu-item-close").removeClass("hide"));var B="";for(var c in A)B+=";"+c+":"+A[c];M.style.cssText=M.style.cssText+B}if(M=null,a("#echat_mini_holder").removeClass("echat-hide"),_.Browser.isMobile){history.pushState&&!_.autoShowMini?T||C||(_.lastHash="#TOECHAT"+(new Date).getTime(),setTimeout(function(){history.pushState({title:ECHAT.LANG.onlineStaff},ECHAT.LANG.onlineStaff,location.href+_.lastHash)},0)):_.lastHash=void 0,a("body").addClass("echat-win-show");var H=document.documentElement;H&&a(H).addClass("echat-html"),_.partScreen&&_.supportPartScreen?_.partScreen&&a("body").addClass("echat-body-fix"):a("body").addClass("echat-body-hide")}if(b&&!C){var L=a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read");_.lasGetMid&&(!L||_.lasGetMid>parseInt(L))&&a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read",_.lasGetMid),_.lasGetMid&&a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read_click",_.lasGetMid)}return C?(_.hideMiniChat(void 0,void 0,!0),_.postMessage({action:"showMiniChat",mayNeedRestart:E,type:h,hide:!0})):(a("#ECHAT_mini").show(),this.miniUnfold=!0,_.publish("__showMiniWin",1),_.publish("__newEvent",{act:100,eventAction:"showMiniWin",eventLabel:""}),_.publish("clearGetMsg"),_.postMessage({action:"showMiniChat",mayNeedRestart:E,type:h})),_.scrollHeight=document.body.scrollHeight,!1},this.getMobileTopHeight=function(){var a;return _.Browser.isMobile&&(a=_.partScreen?_.partScreen-0:"",a&&_.supportPartScreen&&("number"==typeof a?a="top:"+a+"px;height:"+("calc(100% - "+a+"px);"):_.partScreen&&(a="top:80px;height:calc(100% - 80px);"))),a||""},this.setMiniSrc=function(c,h){if(c){var v,g=_.getMobileTopHeight();_.Browser.isMobile?(v='<iframe id="ECHAT_mini_chat" src="'+c+'" style="display: none;'+g+'" name="ECHAT_mini_chat" scrolling="auto" border="0" allowtransparency="true" frameborder="0"></iframe>',document.getElementById("ECHAT_mini_chat")?h&&h.replace?(a("#ECHAT_mini_chat").remove(),a("#echat_mini_holder").append(v)):document.getElementById("ECHAT_mini_chat").setAttribute("src",c):a("#echat_mini_holder").append(v),g&&a("#echat_mini_holder").addClass("echat-hastopheight")):document.getElementById("ECHAT_mini_chat").setAttribute("src",c)}},this.hideMiniChat=function(c,h,v){if(_.toggleViewport&&_.toggleViewport(!1),_.hideInnerURLPage(),a.cookie("ECHAT_"+_.companyId+"_"+_.visitorId+"_miniHide","1"),this.miniUnfold!==!1){if(_.postMessage({action:"hideMiniChat"}),_.__nativeAPI("echatPageStatus",{event:8}),_.publish("__newEvent",{act:100,eventAction:"echatPageStatus",eventLabel:{event:8}}),this.miniUnfold=!1,v||_.publish("clearGetMsg"),a("#ECHAT_mini").hide(),a("#echat_mini_holder").addClass("echat-hide"),1==_.data.icon.innerEnable&&a("#ECHAT_mini_icon").show(),_.Browser.isMobile){if(!_.autoShowMini&&!h&&c!==!0&&history.pushState&&a("body").hasClass("echat-win-show")){if(a("body").removeClass("echat-win-show").removeClass("echat-body-hide"),"MicroMessenger"!=navigator.userAgent.match(/MicroMessenger/i)&&!navigator.userAgent.match(/MQQBrowser/i))try{_.lastHash&&(_.initHistoryLength<window.history.length||-1!=location.href.indexOf(_.lastHash))&&history.back()}catch(e){}}else a("body").removeClass("echat-win-show").removeClass("echat-body-hide");var g=document.documentElement;g&&a(g).removeClass("echat-html")}else _.publish("__newEvent",{act:100,eventAction:"visitorHide",eventLabel:""});return _.Browser.isMobile&&"undefined"!=typeof _.windowLastTop&&setTimeout(function(){document.body.scrollTop=_.windowLastTop,window.scrollTo(0,_.windowLastTop)},20),_.miniWinParam&&4!=_.chatStatus&&(_.autoPopTimer&&clearTimeout(_.autoPopTimer),_.companyOff&&1==_.miniWinParam.enableOfflinePopAfterHide?_.autoPopTimer=setTimeout(function(){_.miniChat(void 0,8)},1e3*(parseInt(_.miniWinParam.offlineAutoPopHideTime)||0)):_.companyOff||1!=_.miniWinParam.enableOnlinePopAfterHide||(_.autoPopTimer=setTimeout(function(){_.miniChat(void 0,8)},1e3*(parseInt(_.miniWinParam.onlineAutoPopHideTime)||0)))),window.event&&window.event.preventDefault&&window.event.preventDefault(),!0}},this.targetWinName="ECHAT_WIN",this.openChatWindow=function(e,a,c){if(a=a||{},!_.Browser.isMobile&&_.openEchatWin&&!_.openEchatWin.closed)try{return void _.openEchatWin.focus()}catch(h){}if(1==_.echatInnerFrame&&!_.mixedCompany)return void _.postChatMessage({evt:"echatjs",type:"openChat",arguments:{option:a,windowOptions:c}});var v,g=_.getChatLink(a).chatLink;if(c){var w=window.screen.width/2,b=window.screen.height-100,y=w>900?900:w;y=600>y?600:y,b=b>600?600:b,b=500>b?500:b;var C=parseInt(c.height||_.queryParams.chatWindowParam&&_.queryParams.chatWindowParam.height||b),I=parseInt(c.width||_.queryParams.chatWindowParam&&_.queryParams.chatWindowParam.width||y),T=(window.screen.height-30-C)/2,E=(window.screen.width-10-I)/2,H=c.features||"width="+I+",height="+C+",top="+T+",left="+E+",di r ecto r ies=no ,menubar=no,t o olbar=no";return _.Browser.isMobile?_.openEchatWin=v=window.open(g,void 0,H):((2==_.chatStatus||1==_.chatStatus||"undefined"==typeof _.chatStatus)&&(_.targetWinName="ECHAT_WIN"+(new Date).getTime(),c.name&&(c.name=c.name+(new Date).getTime())),_.openEchatWin=v=window.open(g,c.name||_.targetWinName,H)),v}return _.Browser.isMobile&&!_.mixedCompany?_.miniChat(void 0,4,a):(_.openEchatWin=v=window.open(g),v)},this.surferEndChat=function(a){"disconnected"!=EChatQuery.cometd.getStatus()&&window.ltIE10||!_.postMessage({action:"closeChat",param:a||{}})?_.publish("sendVisitorEvent",{et:107,content:ECHAT.LANG.closeInner}):"disconnected"==EChatQuery.cometd.getStatus()&&_.publish("endChat")},this.pageTitle=_.documentTitle||"",this.titles=[ECHAT.LANG.newMsg,this.pageTitle],this.showChangeTitle=!1,this.setPageTitle=function(a){return a?(this.documentTitle=a,this.pageTitle=a,this.titles[1]=a,!0):void 0};var C=function(){var c=a.cookie("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read");_.miniUnfold&&_.lasGetMid&&c&&_.lasGetMid==parseInt(c)&&(a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read_click",_.lasGetMid),_.updateBridgeRead({update:!0,type:"_mid_read_click",value:_.lasGetMid})),_.showChangeTitle=!1,_.setDocumentTitle("c")};a(window).on("focus",C).on("blur",function(){_.showChangeTitle=!0});var I="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null,T=I&&I.replace(/hidden/i,"visibilitychangeur",function(){_.showChangeTitle=!0}),I&&document.addEventListener(T,function(){document[I]?_.showChange("mouseover keydown touchstart",C).on("mouseout",function(){_.showChangeTitle=!0}),a("#ECHAT_mini_chat").on("mouseover keydown touchend",C);var E=function(){if("title"in document)return function(a){document.title=a};var a,t=document.getElementsByTagName("title");reElementsByTagName("head")[0].appendChild(a)),"textContent"in a?function(a){document.getElementsByTagName("title")[0].textContent=a
}:"innerText"in a?function(a){document.getElementsByTagName("title")[0].innerText=a}:function(){}}(document);this.checkTitle=function(){var a=_.getDocumentTitle();a!==_.titles[0]&&a!==_.titles[1]&&_.setPageTitle(a)},this.setDocumentTitle=function(a){if(_.showChangeTitle&&"c"!=a){if(_.checkTitle(),E(_.titles[0]),!_.pageTitleTimer){var i=1;_.pageTitleTimer=setInterval(function(){_.checkTitle(),E(_.titles[i++%2])},800)}}else _.checkTitle(),E(_.pageTitle),clearInterval(_.pageTitleTimer),_.pageTitleTimer=null},this.refreshVisitorMetaData=function(c,h,v){c&&("disconnected"==EChatQuery.cometd.getStatus()||_.isMini===!0||1==_.echatInnerFrame?!function(){var g={from:1,companyId:_.coID,metaData:c,myData:h};a._ajax({url:_.apiServerDomain+"/refreshVisitorMetaData?"+_.packParam(g),type:"jsonp",jsonpCB:"jsonpCallback",success:function(){v&&v({successful:!0}})}})}():_.publish("sendVisitorEvent",{et:125,metaData:c,myData:h},function(a){"function"==typeof v&&v({successful:a.successful,msg:""})}))},this.getVisitorId=function(){return _.visitorId||void 0},this.getChatPageUrl=function(a){return a?_.getChatLink(a).chatLink:_.chatLink||_.getChatLink().chatLink},this.sendTextMsgApi=function(c,h){if(c){h||(h=function(){}Id:_.vptVID,metaData:_.metaData,content:c};_.metaData&&(v.myData=_.myData);var g=_.apiServerDomain+"/stm?"+_.packParam(v);a._ajax({url:g,type:"jsonp",jsonpCB:"jsonpCallback",success:function(a){h({successful:!0,msg:a})},error:function(a){h({successful:!1})}})}},this.pushVisitorEvent=function(h,v,w){function b(a){var c;return c="string"!=typeof a?{customizeMsgType:a.customizeMsgType||1,question:a.question,dedup:2==a.customizeMsgType?1:0,eventId:a.eventId,title:g(a.title),content:a.content,imageUrl:a.imageUrl,url:a.url,urlForVisitor:a.urlForVisitor,urlForStaff:a.urlForStaff,memo:g(a.memo),visibility:a.visibility,urlEnableForVisitor:a.urlEnableForVisitor,closeURLPage:a.closeURLPage,visEvt:"object"==typeof a.visEvt?JSON.stringify(a.visEvt):a.visEvt}:{dedup:0,visEvt:a}}v||(v=function(){});var y=b(h);2==_.chatStatus||1==_.chatStatus||w||(_.visitorEventData=y.visEvt||JSON.stringify(y),c()),"disconnected"==EChatQuery.cometd.getStatus()||_.isMini===!0||1==_.echatInnerFrame?!function(){y=a.extend({companyId:_.companyId,encryptVID:window.encryptVID,metaData:_.metaData,info:_.info},y),_.metaData&&(y.myData=_.myData),window.isEchatSdk&&(y.from=3);var c=_.dataHost+"/cms?"+_.packParam(y);_.addJS(c,function(a,c_.chatStatus||1==_.chatStatus?(y.et=126,_.publish("sendVisitorEvent",y,function(a){v({successful:a.successful,msg:""})})):(_.visitorEventObj=y,v({successful:!1,msg:""}))},this.parseIE6Png=function(){function a(){c.onreadystatechange=null,h.removeChild(c),c=null,setTimeout(function(){DD_belatedPNG.fix(".echat-invite-reject,.echat-invite-accept,.echat-menu-item-icon,.fr"),correctPNG(!1)},500)}var c=document.createElement("script");c.setAttribute("type","text/javascript");var h=document.getElementsByTagName("head")[0];c.onreadystatechange=function(){c.readyState&&/loaded|complete/.test(c.readyState)&&a()},c.src=this.loaderHost+"/visitor/common/lib/DD_belatedPNG_0.0.8a.js",h.appendChild(c)},this.handleInnerURLPage=function(a){"open"==a.type?w(a):_.hideInnerURLPage(a)},this.initBridge=function(){function c(){var h=a.cookie("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read");h&&_.lasGetMid&&(h==_.lasGetMid||h>_.lasGetMid)&&_.publish("clearGetMsg");var w=a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read_click");w!=g&&(g=w,_.setDocumentTitle("c")),v=setTimeout(c,1e3)}var h="";if("undefined"!=typeof encryptVID&&(h=encryptVID),"undefined"!=typeof chatVisitorId&&(_.chatVisitorId=chatVisitorId),!_.Browser.isMobile){var v,g;v=setTimeout(c,1e3);var w=_.bridgeData={},b=_.loaderHost+"/visitor/surfer/bridge.html?companyId="+_.companyId+"&visitorId="+encodeURIComponent(_.chatVisitorId)+"&fromHost="+encodeURIComponent(location.origin),y=document.createElement("div");y.style.cssText="display:none",y.innerHTML='<iframe id="echatBridgeIframe" name="echatBridgeIframe" src="'+b+'"></iframe>',document.getElementsByTagName("body")[0].appendChild(y),_.handleBridge=function(c){"undefined"==typeof _.chatStatus&&2==c.chatStatus&&1==_.queryParams.mini&&(_.chatStatus=c.chatStatus,w.chatStatus=c.chatStatus,_.publish("initMiniChat",c)),"undefined"==typeof w.mid?(w.mid=Math.max(c.mid,a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read")||0),_.initMid=w.mid):(c.mid&&w.mid!=c.mid&&(w.mid=c.mid,_.publish("clearGetMsg",c)),w.midClick||(w.midClick=a.store("ECHAT_"+_.companyId+"_"+window.chatVisitorId+"_mid_read_click")||""),c.midClick&&w.midClick!=c.midClick&&(w.midClick=c.midClick,_.setDocumentTitle("c")),2==c.chatStatus&&2!=_.chatStatus&&"undefined"!=typeof _.chatStatus&&(_.chatStatus=c.chatStatus,w.chatStatus=c.chatStatus,_.publish("initMiniChat",c)),w.chatStatus!=c.chatStatus&&(_.chatStatus=c.chatStatus),c.staffHead&&w.staffHead!=c.staffHead&&(w.staffHead=c.staffHead,_.publish("handlePureInnerChat_staffHead",c)))}}},this.subscribe("handlePureInnerChat",function(a,h){h.fromInner||!_.Browser.isMobile&&!h.refresh||_.miniChat(void 0,h.refresh?7:6,void 0),"undefined"!=typeof h.chatStatus&&(_.chatStatus=h.chatStatus),2==_.chatStatus&&(_.visitorEventData="",c())}),this.subscribe("handlePureInnerChat_staffHead",function(){}),this.addEchatInnerFrameParam=function(a){if(a){var c=a.split("#"),h=c[1]||"",v=c[0],g=-1==v.indexOf("?")?0:1;return v+(g?"&":"?")+"echatInnerFrame=1"+(h?"#":"")+h}},this.addExternalParam=function(a){isplit("#"),h=c[0],v="+encodeURIComponent(window.encryptVID)+"&echatChatVisitorId="+encodeURIComponent(window.chatVisitorId)+"&echatCompanyId="+_.companyId}},this.hideInnerURLPage=function(){a("#ECHAT_mini_site").remove(),_.postMessage({innerURL:"closed"})},this.posInnerURLPage=function(){},this.setChatLanRes=function(a){_.postMessage({action:"extendLanRes",lanRes:a})},this.postMessage=function(a){if(!_.hasMini||!_.miniReady)return!1;try{return(document.getElementById("ECHAT_mini_chat").contentWindow||document.frames.ECHAT_mini_chat).postMessage(a,_.loaderHost||"*"),!0}catch(e){}return!1},this.postChatMessage=function(a){if(!a||window.top==window.self)return!1;try{return a.origin=location.protocol+"//"+location.host,window.parent.postMessage(a,"*"),!0}catch(e){}return!1},this.handleKeyboard=function(){function c(c){w=0,b=0;var h="";return y=!0,v&&clearTimeout(v),c.lastMinInnerHeight?(E=H,g&&clearInterval(g),void _.postMessage({action:"innerConsole",msg:""+E})):(a("#echat_mini_holder").addClass("echat-input-focus"),function M(){w=Math.max(w,document.body.scrollTop),H=Math.min(H,window.innerHeight),g=setTimeout(M,1)}(),_.Browser.isAndroid||(v=setTimeout(function(){function c(){(A.innerHeight==window.innerHeight||T-window.innerHeight>100&&2*window.innerHeight-T>50*I)&&(k=40*I)}if(g&&clearInterval(g),v=null,y){b=window.innerHeight;var M=document.getElementById("echat_mini_holder").getBoundingClientRect().bottom,S=T-b,k=0;if(_.postMessage({action:"innerConsole",msg:";00:bottom"+document.getElementById("echat_mini_holder").getBoundingClientRect().bottom+";"+window.innerHeight+";nowInnerHeight"+b+";minInnerHeight"+H+";"+w+"</br>"}),S>100&&(M-b>5||-5>M-b)?h+="<1>":S>5&&b>H?(k=b-H,h+="<2>"):_.partScreen&&T==b&&b-H>100?(k=b-H,h+="<2-2>"):document.body.scrollTop>100&&document.body.scrollTop<w?(k=w-document.body.scrollTop,h+="<3>"):S>100&&E?(k=b-E,0==k&&c(),h+="<4>"):(h+="<5>",k=0,T-window.innerHeight>100&&A.firstIn&&!A.innerHeight&&M>300*I&&(A.innerHeight=window.innerHeight,a.cookie("input_fix_first",A.innerHeight)),"uc"!=C&&c()),k>5||-5>k){h+=k+"<>;","uc"==C?_.postMessage("inputScrollBack"):document.getElementById("echat_mini_holder").style.height="calc(100% - "+k+"px)";var B=document.createElement("div");B.ct=k+"px",document.getElementById("echat_mini_holder").appendChild(B)}_.postMessage({action:"innerConsole",msg:h+";now bottom"+document.getElementById("echat_mini_holder").getBoundingClientRect().bottom+";bottom"+M+";firstFocus"+JSON.stringify(A)+";"+window.innerHeight+";"+b+";"+H+";"+w+"</br>"})}},650)),void setTimeout(function(){_.focusH=window.innerHeight},500))}function h(){y=!1,_.focusH=0,A.firstIn=!1,v&&clearTimeout(v),a("#echat_mini_holder").removeClass("echat-input-focus"),document.getElementById("echat_mini_holder").style.height="100%",a(".echat-fix-input").remove(),_.Browser.isMobile&&_.Browser.isIOS&&(document.body.scrollTop=0,window.scrollTo(0,0)),window.blur()}if(!_.Browser.isMobile||!window.addEventListener)return{};{var v,g,w,b,y=!1,C=_.Browser.browser,I=1/_.Device.getZoomLevel(),T=window.innerHeight,E=0,H=T,A={innerHeight:a.cookie("input_fix_first")||0,firstIn:!0};!function(){if(_.Browser.isAndroid)return null;var c=a.cookie("input_fix_inner");return c&&JSON.parse(c)||{}}()}return"safari"==C&&-1==navigator.userAgent.indexOf("Safari")&&(C="iosApp"),window.addEventListener("resize",function(){_.focusH&&window.innerHeight-_.focusH>150&&(a("#echat_mini_holder").removeClass("echat-input-focus"),_.postMessage({action:"blurInput",from:"resize"}))}),window.addEventListener("scroll",function(){!_.Browser.isAndroid&&y&&null===v&&(T-window.innerHeight>100&&E?c(-1):document.body.scrollTop<w&&c(-1))}),{focus:c,blur:h}}();var H=[];window.correctPNG=function(a){if(_.ie6&&(a&&H.push(a),"undefined"!=typeof DD_belatedPNG)){for(var i=0;i<H.length;i++){var c=H[i];"echat-mini-img-img"==c.className?b(c):DD_belatedPNG.fixPng(H[i])}H=[]}}};window.Surfer=c}(EChatQuery);
;/*!visitor/surfer/js/surfer.js*/
!function($){function initLang(a,c){function h(a){if(!a)return"";var c=a.replace("-",""),h="",g=a.split("-")[0],v={zhhk:"zhtw",zhmo:"zhtw",zhcht:"zhtw",zhhant:"zhtw",zhsg:"zhcn",jp:"ja"};if(w[c])h=c;else if(v[c])h=v[c];else for(var y in w)if(0==y.indexOf(g)){h=y;break}return h}var w={zhcn:{iconTitle:"",clickChat:"",invite:"",close:"",unfoldIcon:"",foldIcon:"",closeInner:"",rejectInvite:"",onlineStaff:"",newMsg:"...",imageMsg:"[]",fileMsg:"[]",customMsg:"[]"},enus:{iconTitle:"Conversation icon",clickChat:"Click for inqueries",invite:"Invitation window",close:"shut down",unfoldIcon:"Expand icon",foldIcon:"Close icon",closeInner:"The visitor ends the conversation from the inside page",rejectInvite:"Visitor declined to invite",onlineStaff:"Online Service",newMsg:"There is a new message...",imageMsg:"[image]",fileMsg:"[file]",customMsg:"[New Message]"},ja:{iconTitle:"",clickChat:"",invite:"",close:"",unfoldIcon:"",foldIcon:"",closeInner:"",rejectInvite:"",onlineStaff:"",newMsg:"...",imageMsg:"[]",fileMsg:"[]",customMsg:"[]"},ko:{iconTitle:" ",clickChat:" .",invite:" ",close:"",unfoldIcon:" ",foldIcon:" ",closeInner:"    .",rejectInvite:"  .",onlineStaff:"  ",newMsg:"   ...",imageMsg:"[]",fileMsg:"[]",customMsg:"[ ]"},de:{iconTitle:"Unterhaltungssymbol",clickChat:"Klicken Sie hier, um sich zu beraten",invite:"Einladungsfenster",close:"Schlieen",unfoldIcon:"Erweitern Sie das Symbol",foldIcon:"Schlieen Sie das Symbol",closeInner:"Der Besucher beendet die Konversation von der inneren Seite",rejectInvite:"Der Besucher lehnte eine Einladung ab",onlineStaff:"Online-Kundenservice",newMsg:"Sie haben neue Nachrichten ...",imageMsg:"[Bild]",fileMsg:"[Datei]",customMsg:"[Graphische Nachricht]"},fr:{iconTitle:"Icne de conversation",clickChat:"Cliquez pour consulter",invite:"Fentre d'invitation",close:"Fermer",unfoldIcon:"Dvelopper l'icne",foldIcon:"Icne de fermeture",closeInner:"Le visiteur termine la conversation depuis la page intrieure",rejectInvite:"Le visiteur a refus d'inviter",onlineStaff:"Service clientle en ligne",newMsg:"Vous avez de nouvelles nouvelles ...",imageMsg:"[photo]",fileMsg:"[Documentation]",customMsg:"[Message graphique]"},zhtw:{iconTitle:"",clickChat:"",invite:"",close:"",unfoldIcon:"",foldIcon:"",closeInner:"",rejectInvite:"",onlineStaff:"",newMsg:"...",imageMsg:"[]",fileMsg:"[]",customMsg:"[]"}},g=window.lanName=a||navigator.language||navigator.browserLanguage||"zh-CN";g=g.toLowerCase();var v=h(g);return v||(v=c&&h(c)||"enus"),w[v]}function getQueryParams(a){var c={};if("string"!=typeof a)return c;-1!=a.indexOf("#")&&(a=a.substring(0,a.indexOf("#"))),-1!=a.indexOf("?")&&(a=a.substring(a.indexOf("?")+1));for(var h,w=a.split("&"),g=w.length,i=0;g>i;i++)if(w[i]&&(h=w[i].split("="),h[0]&&h[1])){try{c[h[0]]=decodeURIComponent(h[1])}catch(v){}c[h[0].toLowerCase()]=c[h[0]]}return c}function initEchatApi(){function a(a){var c;if("object"!=typeof a)return{};c=a;var h={},w={mestion:1,companyId:1,echatTag:1,myData:1,metaData:1,formData:1,info:1,routeEntranceId:1,subscribeUnread:1,lan:1,defaultLan:1,visEvt:1,pcMiniWinParam:2,chatWindowParam:2,partScreen:1,platformSign:1,loaderHost:1,pushInfo:1,echatIframeDisable:1,echatInnerFrame:1,acdStaffId:1,usinessIcon:1,fm:1,multipleFile:1};for(var g in c)w[g]&&("domain"==g?(h.dataHost=initURLParam.param.dataHost=location.protocol+"//"+c.domain,initURLParam.param.loaderHost||(initURLParam.param.loaderHost=h.dataHost)):("metaData"==g||"info"==g)&&(h.vip=initURLParam.param.vip=1),h[g]=initURLParam.param[g]=w[g]>1?"object"==typeof c[g]?c[g]:"string"==typeof c[g]?JSON.parse(c[g]):void 0:"object"==typeof c[g]?JSON.stringify(c[g]):c[g]);return initUR.extend(initURwindow[__topName]=function(){var a,c=arguments,h=c[0];if(ec[h]){a=[];for(var i=1;i<c.length;i++)a[i-1]=c[i];return ec[h].apply(ec,a)}},window[__topName].isInit=!0,ec.initParam=function(c){c&&a(c)},ec.on=function(a){if(a){if("function"==typeof a.init)if(ec.isInit)try{a.init()}catch(e){}else outer.subscribe("__init",function(c,h){try{a.init(h)}catch(e){}});if("function"==typeof a.ready)if(ec.isReady&&ec.isReady())try{a.ready()}catch(e){}else outer.subscribe("__ready",function(c,h){try{a.ready(h)}catch(e){}});var c;"function"==typeof a.newMsg&&outer.subscribe("__newMsg",function(h,w){if("undefined"==typeof c||c!=w){c=w;try{a.newMsg(w)}catch(e){}}}),"function"==typeof a.msgboxUnreadUpdate&&outer.subscribe("__msgboxUnreadCount",function(c,h){h=h||0;try{a.msgboxUnreadUpdate(h)}catch(e){}}),"function"==typeof a.newEvent&&outer.subscribe("__newEvent",function(c,h){100==h.act?h.eventCategory="echat":200==h.act&&(h.eventCategory="analytics"),setTimeout(function(){a.newEvent(h)},1)})}},ec.off=function(a){a&&outer.unSubscribe(a)},window.ECHAT={on:ec.on,off:ec.off},"function"==typeof initUserEchat&&initUserEchat.q)for(var c=initUserEchat.q,i=0;i<c.length;i++)("initParam"==c[i][0]||"on"==c[i][0])&&(window[__topName].apply(window[__topName],c[i]),c[i][0]=void 0);outer.subscribe("__ready",function(){try{if("function"==typeof initUserEchat&&initUserEchat.q)for(var a=initUserEchat.q,i=0;i<a.length;i++)a[i][0]&&window[__topName].apply(window[__topName],a[i])}catch(e){}})}function readyEchatApi(a){function c(a){var c;c="string"==typeof a?{echatTag:a}:"object"==typeof a?a:{};var h={},w={visEvt:1,lan:1,defaultLan:1,echatTag:1,info:1,myData:1,metaData:1,formData:1,fastQuestion:1,routeEntranceId:1,subscribeUnread:1,echatTitleBar:1,businessUrl:1,businessIcon:1,fm:1,openFromUser:1,acdStaffId:1,acdType:1,pcMiniWinParam:2,chatWindowParam:2,partScreen:1,platformSign:1,pushInfo:1,echatIframeDisable:1,multipleFile:1};for(var g in c)w[g]&&(h[g]=w[g]>1?"object"==typeof c[g]?c[g]:"string"==typeof c[g]?JSON.parse(c[g]):void 0:"object"==typeof c[g]?JSON.stringify(c[g]):c[g]);return h}a.ec=ec,ec.isInit=!0,ec.isReady=function(){return a.isReady},ec.customOpenChat=function(h){var w=c(h);return outer.publish("__newEvent",{act:200,eventAction:"Button Clicked"}),a.openChafunction(h,w){var g,v,y=c(h);return outer.publish("__newEvent",{act:200,eventAction:"Button Clicked"}),w=w||h&&h.windowOptions,w||(h=h||{},v=h.chatWinw=g&&(g.features||g.width||g.height||g.name)?g:{features:h.features,width:h.width,height:h.height,name:h.ustomMiniChat=functi&(g=h.pcMiniWinPaction:"Button Clicked"});var v="undefined"==typeof w.openFromUser?1:1==w.openFromUser;return a.miniChat(void 0,v?4:10,w,g)},ec.customInvnitInvite(!0),$("#Eible"}),outer.pub"Chat_Invite_Shoinvite").hide().css({visibility:"hidden"}),outer.publish("__newEvent",{act:200,eventAction:"Chat_Invite_Close",from:"plugin"})},ec.pushVisitorEvent=function(c,h){c&&a.pushVisitorEvent(c,h)},ec.getChatPageUrl=function(h){return h&&(h=c(h)),a.getChatPageUrl(h)},ec.getEchatVisitorId=function(){return a.getVisitorId()},ec.getEchatEncryptVIds=function(){return{encryptVID:window.encryptVID,chatVisitorId:window.chatVisitorId}},ec.refreshVisitorMetaData=function(){return a.refreshVisitorMetaData.apply(a,arguments)},ec.setPageTitle=function(c){return c&&a.setPageTitle(c)},ec.setMobilePageTop=function(c){a.setMobilePageHeight(c)},ec.getMiniStatus=function(){return a.miniUnfold?"=a.chatStatus?0:a.chatStatus},ec.getUnReadMsgCount=function(){return a.msgNum},ec.getChatStaffInfo=function(){return a.staffLabel},ec.setFastQuestion=function(c){return a.fastQuestion=c||""},ec.setChatLanRes=function(c){return a.setChatLanRes(c)},ec.rejectInvite=function(c,h){return a.rejectInvite(c,h)},ec.iconChat=function(){return outer.publish("__newEvent",{act:200,eventAction:"Button Clicked"}),a.iconChat()},ec.inviteChat=function(){return outer.publish("__newEvent",{act:200,evnviteChat()},ec.miniChat=function(){return outer.publish("__newEvent",{act:200,eventAction:"Button Clicked"}),a.miniChat.apply(a,arguments)},ec.hideMiniChat=function(){return a.hideMiniChat()},ec.closeMiniChat=function(c){return c||(c={}),(4==a.chatStatus||"leaveToUrl"==a.miniChatStatus)&&a.hideMiniChat(),a.surferEndChat({directClose:c.directClose,evaluate:c.evaluate}),window.event&&window.event.preventDefault&&window.event.preventDefault(),!0},ec.maxMiniChat=function(){return a.hideMiniChat(),a.maxMiniChat()},ec.sendTextMsg=function(){return a.sendTextMsg.apply(a,arguments)},ec.addStaffMsg=function(c,h){return a.addStaffMsg({content:c,mt:640==h||647==h?h:void 0})},ec.closeFramePage=function(){return a.closeFramePage.apply(a,arguments)},ec.msgBoxPageBack=function(){return a.msgBoxPageBack.apply(a,arguments)},ec.showImg=function(){return a.showImg.apply(a,arguments)},ec.getFileUploadInfo=function(){return a.getFileUploadInfo.apply(a,arguments)},window.ECHAT.isInit=!0,window.ECHAT.isReady=function(){return ec.isReady()},window.ECHAT.customOpenChat=function(){return ec.customOpenChat.apply(ec,arguments)},window.ECHAT.customNewWinChat=function(){return ec.customNewWinChat.apply(ec,arguments)},window.ECHAT.customMiniChat=function(){return ec.customMiniChat.apply(ec,arguments)},window.ECHAT.customInvite=function(){return ec.customInvite.apply(ec,arguments)},window.ECHAT.closeInvite=function(){return ec.closeInvite.apply(ec,arguments)},window.ECHAT.refreshVisitorMetaData=function(){return ec.refreshVisitorMetaData.apply(ec,arguments)},window.ECHAT.pushVisitorEvent=function(){return ec.pushVisitorEvent.apply(ec,arguments)},window.ECHAT.getChatPageUrl=function(){return ec.getChatPageUrl.apply(ec,arguments)},window.ECHAT.getEchatVisitorId=function(){return ec.getEchatVisitorId.apply(ec,arguments)},window.ECHAT.getEchatEncryptVIds=function(){return ec.getEchatEncryptVIds.apply(ec,arguments)},window.ECHAT.setPageTitle=function(){return ec.setPageTitle.apply(ec,arguments)},window.ECHAT.setMobilePageTop=function(){return ec.setMobilePageTop.apply(ec,arguments)},window.ECHAT.getMiniStatus=function(){return ec.getMiniStatus.apply(ec,arguments)},window.ECHAT.getChatStatus=function(){return ec.getChatStatus.apply(ec,arguments)},window.ECHAT.getUnReadMsgCount=function(){return ec.getUnReadMsgCount.apply(ec,arguments)},window.ECHAT.getChatStaffInfo=function(){return ec.getChatStaffInfo.apply(ec,arguments)},window.ECHAT.setFastQuestion=function(){return ec.setFastQuestion.apply(ec,arguments)},window.ECHAT.setChatLanResdow.ECHAT.rejectInvite=function(){return ec.rejectInvite.apply(ec,arguments)},window.ECHAT.iconChat=function(){return ec.iconChat.apply(ec,arguments)},window.ECHAT.inviteChat=function(){return ec.inviteChat.apply(ec,arguments)},window.ECHAT.miniChat=function(){return ec.miniChat.apply(ec,arguments)},window.ECHAT.hideMiniChat=function(){return ec.hideMiniChat.apply(ec,arguments)},window.ECHAT.closeMiniChat=function(){return ec.closeMiniChat.apply(ec,arguments)},window.ECHAT.maxMiniChat=function(){return ec.maxMiniChat.apply(ec,arguments)},window.ECHAT.sendTextMsg=function(){return ec.sendTextMsg.apply(ec,arguments)},window.ECHAT.addStaffMsg=function(){return ec.addStaffMsg.apply(ec,arguments)},window.ECHAT.closeFramePage=function(){return ec.closeFramePage.apply(ec,arguments)},window.ECHAT.msgBoxPageBack=function(){return ec.msgBoxPageBack.apply(ec,arguments)},window.ECHAT.showImg=function(){return ec.showImg.apply(ec,arguments)},window.ECHAT.getFileUploadInfo=function(){return ec.getFileUploadInfo.apply(ec,arguments)}}function initAutoSend(a,c){function h(){function h(){if(g){var I=w(c.random,c.list),C=c.list[I];if(C){var S="undefined"==typeof C.intervalTime?2e3:1e3*C.intervalTime;v=setTimeout(function(){C.content&&a.addStaffMsg(C.content,1),y.push(I),y.length<c.list.length&&h()},S)}}}function w(a,c){if(!a)return y.length;for(var h,w=c.length,g=y.length,v=[],I=0;w>I;I++){for(var i=0;g>i&&y[i]!==I;i++);i==g&&v.push(I)}return h=parseInt(Math.random()*v.length),v[h]}g||(g=!0,h())}function w(){g&&(v&&clearTimeout(v),v=null,g=!1,y=[])}if(c&&c.list&&c.list.length){c.random=1==c.random,a.subscribe("getPosMsg",h),a.subscribe("getStartChat",h),a.subscribe("visitorSendEvt",w),a.subscribe("endChat",w);var g=!1,v=null,y=[]}}function initService(a){function c(){$("body").hasClass("echat-win-show")&&h.hideMiniChat(!0)}if(!hasInit){hasInit=!0;var h=new Surfer,w=new Connect;a&&a.inChatPage&&(h.inChatPage=!0),ECHATObjKeyMap.cometdId=w,ECHATObjKeyMap.surferId=h,w.setSub("surferId"),h.setSub("cometdId"),h.setSub("surferId"),h.setSub("outerId"),h.connect=w,w.surfer=h,outer.initPostIframeMessage&&outer.initPostIframeMessage(h),readyEchatApi(h);var g=document.createElement("link");g.rel="stylesheet",g.type="text/css",g.href=initURLParam.param.loaderHost+"/visitor/surfer/css/surfer_e331501.css",g.media="screen";var v=document.getElementsByTagName("head")[0];v.appendChild(g),$.cookie(initURLParam.param.domain+"_"+initURLParam.param.companyId+"_encryptVID",encryptVID,{domain:mainDomain}),$.cookie(initURLParam.param.domain+"_"+initURLParam.param.companyId+"_chatVisitorId",chatVisitorId,{domain:mainDomain}),setEnterCookie(h),setEnterCookie=null,initURLParam.setParam(h),initURLParam.setParam(w),initURLParam.setParam(window.ECHATConfig),h.apiSram||{},initURLParam.param={},initAutoSend(h,h.qu&&a.encryptVID?(h.visitorId=a.visitorId,w.visitorId=w.visitorId,1==h.queryParams.mini||window.isEchatSdk||a.metaData||!h.metaData?(window.isEchatSdk&&(h.metaData=a.metaData,h.myData=a.myData,h.formData=a.formData),outer.publish("__init"),h.isReady=!0,h.publish("__ready")):(h.initBridge(),w.join(),outer.publish("__init"),h.unSubscribe("handshake"),h.subscribe("handshake",function(){h.publish("endSurfer"),h.isReady=!0,h.publish("__ready"),w.unSubscribe("initMiniChat")}))):1==h.echatInnerFrame||outer.mixedCompany||1==h.queryParams.mini||"521778"==h.companyId?(1==h.queryParams.mini&&h.initBridge(),outer.publish("__init"),h.isReady=!0,h.publish("__ready"),h.mixedCompany=outer.mixedCompany):(h.initvent=!0,-1!=h.loaderHost.indexOf("https:")&&(h.needHttps="https:",w.needHttps="https:"),h.Browser.isMobile&&history.pushState&&setTimeout(function(){window.addEventListener("popstate",function(){c()})},2e3),h.__nativeAPI("echatPageStatus",{event:5})}}function initConnect(){}function init(){window.isEchatClient||$(function(){window.encryptVID=locationParam.echatEncryptVID&&locationParam.echatCompanyId==initURLParam.param.companyId?locationParam.echatEncryptVID:$.cookie(initURLParam.param.domain+"_"+initURLParam.param.companyId+"_encryptVID"),window.chatVisitorId=locationParam.echatChatVisitorId&&locationParam.echatCompanyId==initURLParam.param.companyId?locationParam.echatChatVisitorId:$.cookie(initURLParam.param.domain+"_"+initURLParam.param.companyId+"_chatVisitorId"),window.encryptVID&&window.chatVisitorId&&window.chatVisitorId+""!="null"&&window.encryptVID+""!="null"?initService():_getVisitorIdAndInit(initURLParam.param.dataHost,initURLParam.param.companyId,1,function(a){initURLParam.param.dataHost=a,initService()})})}function getJson(a){var c;return c="string"==typeof a?JSON.parse(a+""):a}function echatJsForNative(a){try{var c=getJson(a);"setVisitorInfo"==c.functionName&&window.setVisitorInfo&&window.setVisitorInfo(getJson(a.value))}catch(e){}}var ec={},locationParam=getQueryParams(window.location.href),loaderHost,_getVisitorIdAndInit,_switchServer;!function(){function backupServer(){window._echatConfig.echatServers=window._echatConfig.echatServersBackup.concat([])}function getServer(a,c,h){var w,g=window._echatConfig,v=c?g.apiServers:g.echatServers;return"undefined"!=typeof g&&(a||g.priority)&&v&&v.length&&(w=(h||location.protocol)+"//"+v[0],c?lastApiServer=w:lastServer=w,useServerHost(c,w),v.splice(0,1)),window._echatConfig.currentServer=lastServer,window._echatConfig.currentApiServer=lastApiServer,w}function useServerHost(a,c){var h=window._echatConfig;a?window._echatConfig.currentApiServer=lastApiServer=c:window._echatConfig.currentServer=lastServer=c,h.usedSever?h.usedSever.push(c):h.usedSever=[c]}function findInList(a,c,h){var w=window._echatConfig,g=h?w.apiServers:w.echatServers||[],v=a.replace(/http[s]?:\/\//,"");if(a)for(var i=0;i<g.length;i++)if(g[i]==v)return c&&g.splice(i,1),c&&useServerHost(h,a),a;return""}function _ajax(option){function XHR(){var a;try{a=new XMLHttpRequest}catch(e){for(var c=["Msxml3.XMLHTTP","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],i=0,h=c.length;h>i;i++)try{a=new ActiveXObject(c[i]);break}catch(e){continue}}return a}function timeoutOrAbort(){option.errorSwitch&&option.errorSwitch(),option.errorSwitch=null,xhr.abort()}if(isIE&&isIE[1]<9&&("JSONP"==option.type||"jsonp"==option.type))return _jsonp(option);var xhr=XHR();xhr.onreadystatechange=function(){if(4==xhr.readyState){if(200==xhr.status)if("initysc"==option.fix&&-1!=option.url.indexOf("/ysc")){if(-1!=xhr.responseText.indexOf("encryptVID"))try{eval(xhr.responseText)}catch(e){}chatVisitorId&&encryptVID&&(window.encryptVID=encryptVID,window.chatVisitorId=chatVisitorId,option.success&&option.success())}else option.success&&option.success(xhr.responseText);else 0==xhr.status?option.errorSwitch&&option.errorSwitch():option.error&&option.error();option.errorSwitch=null}};var d=option.data,str="";if(d&&"[object object]"==Object.prototype.toString.apply(d).toLowerCase())for(var key in d)str+="&"+key+"="+encodeURIComponent(d[key]);str&&option.type.match(/get/i)&&(option.url+=-1!=option.url.indexOf("?")?str:"?"+str.substring(1),str="",d=null),window.XMLHttpRequest?d||(d=null):d||(d=void 0),xhr.open((("jsonp"==option.type||"JSONP"==option.type?"get":option.type)||"get").toUpperCase(),option.url,!0),xhr.timeout=option.timeout||timeout;try{var xhrFields=option.xhrFieldsredentials:!0}:void 0);if(xhrFields)for(i in xhrFields)xhr[i]=xhrFields[i]}catch(e){}if(option.header)for(var name in option.header)xhr.setRequestHeader(name,option.ion.header["Content-Type"]||option.heaion.header["content-type"])||xhr.setRequestHeader("Content-Type",option.contentType||"text/plain;charset=UTF-8;"),option.beforeSend&&option.beforeSend(xhr),xhr.send(str?str.substring(1):d),option.timeout&&option.errorSwitch&&setTimeout(timeoutOrAbort,option.timeout+100),{xhr:xhr,option:option,abort:timeoutOrAbort}}function isFuncttion"==typeof a||"[objction _jsonp(a,c){function h(e,h){return a.errorSwitch=null,"initysc"!=a.fix||e&&"error"==e.type?(I.parentNode.removeChild(,c):a.success&oid(C=g=void 0)):void setTimeout(function(){a.success&&a.success()},20)}var w=window.document;a.timeout=a.timeout||timeout;var g,v=a.jsonpCallback,y=(isFunction(v)?v():v)||"jsonp"+ ++jsonpID,I=w.createElement("script"),C=window[y],S=function(){I.parentNode.removeChild(I)},E={abort:S};c&&c.promise(E),window[y]=function(){g=arguments};var b="$1"+y+"$2";a.url=a.url.replace(jsre,b);var p="";if(a.data){for(var _ in a.data){var d="string"==typeof a.data[_]?a.data[_]:JSON.stringify(a.data[_]);p="&"+_+"="+encodeURIComponent(d)}p&&(p=p.substring(1),p+="&")}a.url+=(/\?/.test(a.url)?"&":"?")+p+(a.jsonpCB||"jsonp")+"="+y;var T="onload"in I;return T?(I.onload=h,I.onerror=function(){h({type:"error"})}):I.onreadystatechange=function(){/loaded|complete/.test(I.readyState)&&h()},a.beforeSend&&a.beforeSend(E)===!1?E:(I.src=a.url,w.getElementsByTagName("head")[0].appendChild(I),abortTimeout=setTimeout(function(){a.errorSwitch&&a.errorSwitch(),a.errorSwitch=null},a.timeout),E)}function isApi(a){return!!a.match(/http[s]?:\/\/[^.]+api./i)}function _sendLog(a,c){a.token="Wpgs2jhjpUf7fkM",_ajax({type:"post",timeout:3e3,contentType:"application/x-www-form-urlencoded; charset=UTF-8",xhrFields:{withCredentials:!0},url:"https://chatapi.rainbowred.com/vgcc",data:a,success:c.success,error:c.error})}function _storeLog(a,c){try{return c?localStorage.setItem(a,c):localStorage.removeItem(a),!0}catch(e){if(c){var h=new Date;h.setDate(h.getDate()+30),document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(c)+";path=/;expires="+h.toUTCString()}else document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT ; path=/";return!0}}function _getStoreLog(a){var c="";try{return c=localStorage.getItem(a)}catch(e){for(var h=document.cookie.split(";"),i=0;i<h.length;i++)if(h[i].match(/^key=/))return place(/^key=/,""))}return c}function add(){window.EChatQuery.ajaxBackUp=window.EChatQuery.ajax,window.EChatQuery._ajax=_switchServer}function hasNoVid(){return!window.encryptVID||!window.chatVisitorId||window.chatVisitorId+""=="null"||window.encryptVID+""=="null"}function sendYscError(a){var c="errorYscLog_"+a,h=_getStoreLog(c);h&&(_sendLog({companyId:a,type:"ysc-error",data:h},{success:function(){_storeLog(c,"")}}),sendYscError=null)}function addYscError(a,c){if(1==a||22==a||23==a){var h,w="errorYscLog_"+a,g=_getStoreLog(w),v={tm:yscTm,readyState:c.readyState,status:c.stxt:c.statusText,responseType:c.responseType,responseHeaders:c.getAllResponseHeaders(),responseXML:c.responseXML,responseText:c.responseText};g?(g=JSON.parse(g),g.push(v)):g=[v],h=JSON.stringify(g),_storeLog(w,h),lastYscError!=h&&(lastYscError=h,console.log("lastYscError",lastYscError),console.log("logStr",h),_sendLog({companyId:a,type:"ysc-error",data:h},{success:function(){_storeLog(w,"")}}))}}var console=window.console,isDji=location.href.match(/(\/dji\/)|(\/ryze\/)/);window._echatConfig={echatServers:["e1.echatsoft.com","e2.echatsoft.com","e3.echatsoft.com"],apiServers:["eapi.echatsoft.com"],priority:0,cipher:"",transport:1,desc:"transport: 1websocket, 2longpolling; priority: cdn first",ss:"e.echatsoft.com"};var lastServer,lastApiServer,timeout=3e3,isIE=window.navigator.userAgent.match(/MSIE (\d)/i);window._echatConfig.isInCdn=findInList;var isNeedCredentcial=function(){var a=navigator.userAgent.match(/rv:([\d.]+)/i),c=!1;return a&&a[1]&&a[1]>=11&&(c=!0),function(a){return c&&!a.url.match(/\.(json|js|png|jpeg)$/i)}}(),jsonpID=0,abortTimeout,jsre=/(\=)\?(&|$)|\?\?/i,checking=0;window._echatConfig.checkNet=function(a){function c(c,g){return function(){h[c]=g,w++,2==w&&(1===h.json&&0===h.one?a.errorSwitch&&a.errorSwitch():1===h.json&&1===h.one?a.success&&a.success():a.error&&a.error(),checking=0)}}if(!checking&&!isDji){checking=1;var h={json:0,one:0},w=0;_ajax({type:"jsonp",timeout:timeout,url:("undefined"==typeof loaderHost?"":loaderHost)+"/res/servicecdns.json",success:c("json",1),error:c("json",0),errorSwitch:c("json",0)}),_ajax({url:a.serverHost+"/one",type:"get",timeout:timeout,success:c("one",1),error:c("one",0),errorSwitch:c("one",0)})}},_switchServer=function(a){var c=a.needSwitch||isApi(a.url),h=a.url,w=isApi(a.url)?lastApiServer:lastServer;return!c&&window.EChatQuery&&window.EChatQuery.ajax?window.EChatQuery.ajax(a):(w&&(h=h.replace(/^http[s]?:\/\/[^\/]+/i,w)),a.contentType&&!a.header&&(a.header={"Content-Type":a.contentType}),void _ajax({type:a.type,timeout:a.timeout||5e3,header:a.header,data:a.data,url:h,success:function(c){if("string"==typeof c&&c.length>4)try{c=JSON.parse(c)}catch(e){}a.success&&a.success(c)},error:a.error,errorSwitch:function(){getServer(0,isApi(a.url),a.url.match(/^http[s]?:/i)[0])&&_switchServer(a)}}))},window.addEventListener?window.addEventListener("load",add):window.attachEvent("onload",add),window._echatConfig.nextServer=getServer,window._echatConfig.backupServer=backupServer,(!isIE||isIE[1]>=9)&&!isDji&&setTimeout(function(){_ajax({type:"jsonp",timeout:3e3,url:("undefined"==typeof loaderHost?"":loaderHost)+"/res/servicecdns.json",success:function(a){if("string"==typeof a){var c=window._echatConfig,h=c.priority;if(a=JSON.parse(a),window._echatConfig.echatServers=a.echatServers,window._echatConfig.echatServersBackup=a.echatServers.concat([]),window._echatConfig.apiServers=a.apiServers,window._echatConfig.priority=a.priority,c.usedSever)for(var i=0;i<c.usedSever.length;i++){for(var w=0;w<a.echatServers.length;w++)if(a.echatServers[w]==c.usedSever[i]){a.echatServers.splice(w,1);break}for(var w=0;w<a.apiServers.length;w++)if(a.apiServers[w]==c.usedSever[i]){a.apiServers.splice(w,1);break}}if(!h&&a.priority>0)if(window.encryptVID&&window.chatVisitorId&&window.chatVisitorId+""!="null"&&window.encryptVID+""!="null"){var g=window.ECHATObjKeyMap&&ECHATObjKeyMap.cometdId;g&&g.switchServer(1,lastServer)}else lastInitParam&&lastInitParam[2]&&yscTimer&&yscTimer.abort()}}})},10);var lastInitParam,yscTimer=!1,yscTime=0,yscTm=0,lastYscError="";_getVisitorIdAndInit=function(a,c,h,w){function g(){if(yscTimer){var h=yscTimer.xhr;if(yscTimer=!1,hasNoVid()){if(isDji)return console.log("ysc"),void _getVisitorIdAndInit(a,c,0,w);window._echatConfig.checkNet({serverHost:a,errorSwitch:fu"),_getVisitorIdAndInit(getServer(1,0,v),c,0,w)},success:function(){console.log("ysc"),_getVisitorIdAndInit(a,c,0,w)}})}else w&&w(a),w=null;addYscError(c,h)}}if(!(yscTime>15)){yscTime++,sendYscError&&sendYscError(c),lastInitParam=[a,c,h,w];var v=a?a.match(/^http[s]?:/i)[0]:"";if(h&&window._echatConfig.priority>0){var y=findInList(a,!0);y||(y=getServer(1,0,v),y&&(a=y)),list=void 0,hostTemp=void 0}if(!a)return void console.log("ysc:");if(yscTimer)return void console.log(a," ");yscTm=(new Date).getTime(),yscTimer=_ajax({type:"jsonp",fix:"initysc",timeout:3e3,xhrFields:{withCredentials:!0},url:a+"/ysc?companyId="+c+"&t="+yscTm,success:function(){return yscTimer=!1,hasNoVid()?_getVisitorIdAndInit(getServer(1,0,v),c,0,w):(window.localStorage.setItem("chatVisitorId",window.chatVisitorId),window.localStorage.setItem("encryptVID",window.encryptVID),w&&w(a),void(w=null))},errorSwitch:g,error:g})}}}();var initURLParam=function(){function a(a){var m=a.match(C);return m&&m[0].substr(1)}function c(a){return a.hasAttribute?a.src:a.getAttribute("src",4)}function h(a){var c=/^(http[s]?:\/\/[^\/]+).*/g.exec(a)[1];return"https:"==location.protocol&&(c=c.replace("http:","https:")),c}function w(a){var c=/^(http[s]?:\/\/[^\/]+).*/g.exec(a)[1];return c.replace(/^http[s]?:\/\//i,"")}{var g,v,y,I,C=/[?#][^?#]*/,S="undefined"==typeof window&&"undefined"!=typeof importScripts&&isFunction(importScripts),E=/^(about|blob):/;!location.href||E.test(location.href)?"":a(location.href)}if(S){var b;try{var _=new Error;throw _}catch(e){b=e.stack.split("\n")}b.shift();for(var m,T=/.*?((?:http|https|file)(?::\/{2}[\w]+)(?:[\/|\.]?)(?:[^\s"]*)).*?/i,M=/(.*?):\d+:\d+\)?$/;b.length>0;){var P=b.shift();if(m=T.exec(P),null!=m)break}var A;if(null!=m)var A=M.exec(m[1])[1];g=A}else{var j=document,V=j.scripts,H=j.getElementById("echatmodulejs")||j.getElementById(window._join_name_used+"modulejs")||V[V.length-1]||{};g=c(H)||""}g&&-1==g.indexOf("//")&&(g=location.protocol+"//"+g);var L=window[window._join_name_used+"Server"];if("undefined"!=typeof L&&"[object Array]"===Object.prototype.toString.apply(L)){var r=parseInt(Math.random()*L.length);(r||0===r)&&L[r]&&(v=L[r])}else window._echatConfig&&window._echatConfig.ss&&(v=window._echatConfig.ss);g&&(y=h(g),v||(v=w(y).replace(/^([^\.]+)s\./,"$1.").replace(/\/\/www\.echatsoft\./,"//e.echatsoft.").replace(/\/\/www\.rainbowred\./,"//v.rainbowred."))),!g&&v&&(g=y=location.protocol+"//"+(v.match(/^([^\.]+)s\./)?v:v.replace(/^([^\.]+)\./,"$1s."))),I=y.split("//")[1];var U=getQueryParams(g),p={param:{},setParam:function(a){if(a){for(var c in p.param)"undefined"!=typeof p.param[c]&&(a[c]=p.param[c]);"1"==p.param.mini&&(a.isMini=!0)}}};p.param.dataHost=(-1!=y.indexOf("https:")?"https:":"http:")+"//"+v,p.param.loaderHost=loaderHost=y;for(var k=["companyId","lan","defaultLan","echatTag","metadata","formdata","info","myData","routeEntranceId","subscribeUnread","echatTitleBar","businessUrl","businessIcon","fm","visEvt","mini","echatInnerFrame","pushInfo","platformSign","echatIframeDisable","multipleFile"],i=0,D=k.length;D>i;i++)p.param[k[i]]=U[k[i].toLowerCase()]||void 0;p.param.domain=I,p.param.vip=p.param.metaData||p.param.info?1:void 0;try{p.param.pcMiniWinParam=U.pcMiniWinParam?JSON.parse(U.pcMiniWinParam):{},p.param.chatWindowParam=U.chatWindowParam?JSON.parse(U.chatWindowParam):void 0}catch(e){}return p.param.queryParams=U,U.partscreen&&(p.param.partScreen=U.partscreen),window.top!=window&&-1!=location.href.indexOf("echatInnerFrame=1")&&(p.param.echatInnerFrame=1),p}(),__topName=window._join_name_used||"_echat",initUserEchat=window[__topName],setEnterCookie=function(a){var f=$.cookie("echat_firsturl");f||($.cookie("echat_firsturl",location.href),$.cookie("echat_firsttitle",function(){if("title"in document)return document.title||"";var a,t=document.getElementsByTagName("title");return t&&t[0]?(a=t[0],"textContent"in a?a.textContent||"":"innerText"in a?a.innerText||"":""):(a=document.createElement("title"),document.getElementsByTagName("head")[0].appendChild(a),"")}(document))),a.firstUrl=$.cookie("echat_firsturl"),a.firstTitle=$.cookie("echat_firsttitle")||""},outer=ECHATObjKeyMap.outerId;outer||(outer={},UTIL.call(outer,!0),ECHATObjKeyMap.outerId=outer,outer.setSub("outerId"));var hasInit=!1,mainDomain=function(){var a=location.host;return a.split(".").length>2?a.replace(/(^[^.]+.)|(:\.+$)/,""):a}();if(!window[__topName]||!window[__topName].isrror",{msg:"There is not companyId"});if(12363!=initURLParam.param.companyId||location.host.match(/(ledmary\.net|ledmary.com|mrled\.cn|mrledipsly.com)$/)){if(ECHAT.LANG=initLang(initURLParam.param.lan,initURLParam.param.defaultLan),window.isEchatSdk=function(){var a;return window.EchatJsBridge&&EchatJsBridge.callEchatNative?(a=EchatJsBridge.callEchatNative(JSON.stringify({functionName:"isSDKWebview"})),a&&"null"!=a&&(1==a.isSDKWebview||1==JSON.parse(a).isSDKWebview)):navigator.userAgent.match(/Echat_WKWeb/i)}(),(window.isEchatSdk||window.top!=self&&window.addEventListener)&&(window.top.postMessage({evt:"echatjs",type:"echatInnerFrame",origin:location.protocol+"//"+location.host},"*"),outer.initInnerSurfer=function(a){outer.initInnerSurfer=null,a&&a.encryptVID&&(initURLParam.param.echatInnerFrame=1,initURLParam.param.companyId!=a.companyId?(outer.mixedCompany=!0,init()):(window.encryptVID=a.encryptVID,window.chatVisitorId=a.chatVisitorId,initService(a)))},isEchatSdk)){if(window.callEchatJs){var temp=window.callEchatJs;window.callEchatJs=function(){echatJsForNative.apply(window,arguments),temp.apply(window,arguments)}}else window.callEchatJs=echatJsForNative;return window.setVisitorInfo=function(a){a="string"==typeof a?JSON.parse(a+""):a,outer.initInnerSurfer&&outer.initInnerSurfer(a),delete window.setVisitorInfo},void(window.EchatJsBridge?EchatJsBridge.callEchatNative('{"functionName": "getVisitorId","callback":"setVisitorInfo"}'):window.webkit&&window.webkit.messageHandlers.callEchatNative.postMessage('{"functionName": "getVisitorId","callback":"setVisitorInfo"}'))}window.top!=self&&window.addEventListener?(setTimeout(function(){outer.hadInitEvent||(outer.initInnerSurfer=null,init())
},300),setTimeout(function(){try{window.parent.postMessage({evt:"echatjs",type:"echatInnerFrame",origin:location.protocol+"//"+location.host},"*")}catch(e){}},50),window.addEventListener&&window.addEventListener("message",function(e){e.data&&(e.data&&"echatInnerFrameCallback"==e.data.type?(!outer.initInnerSurfer,outer.initInnerSurfer&&outer.initInnerSurfer(e.data)):"echatClient"==e.data.type&&(outer.initInnerSurfer=null,window.&&outer.initInnerSurfer(e.data))})):(window.addEventListener&&window.addEventListener("message",function(e){if(e.data){var a=e.data,c=e.source;"echatjs"!=atInnerFrameCallback",companyId:h.companyId,visitorId:h.visitorId,chatVisitorId:window.chatVisitorId,encryptVID:window.encryptVID,metaData:h.metaData||""},a.origin)}catch(e){}})}}),init())}}}(EChatQuery);
;/*!visitor/common/js/iframeScroll.js*/
!function(){function a(e){I=!0,e.stopPropagation();var a=e.touches?e.touches[0]:e;y=parseInt(a.screenY)}function c(e){e.stopPropagation(),objTouches=e.touches?e.touches[0]:e,0===y&&(y=parseInt(objTouches.screenY)),disty=parseInt(objTouches.screenY)-y,S=(new Date).getTime(),(Math.abs(disty)>10&&S-T>50||!T)&&(T=(new Date).getTime(),y=parseInt(objTouches.screenY),top&&I&&top.postMessage({evt:"echatjs",type:"iframeScrollTo",action:"iframeScrollTo",msg:{instance:"chatScroll",distance:disty}},"*")),e.cancelable&&e.preventDefault()}function h(e){e.stopPropagation(),g()}function g(){y=0,top&&top.postMessage({evt:"echatjs",type:"iframeScrollTo",action:"iframeScrollTo",msg:{instance:"chatScroll",distance:"",type:"end"}},"*")}function v(g){g.addEventListener("touchstart",a,!0),g.addEventListener("touchmove",c,!0),g.addEventListener("touchend",h,!0),g.addEventListener("touchcancel",h,!0)}var T,S,y=0,I=!0;document.onreadystatechange=function(){var a=document.location.href,c=!0;if(-1==a.indexOf("&echatInnerFrame=1")&&-1==a.indexOf("?echatInnerFrame=1")&&(c=!1),"complete"===document.readyState&&c){var h={isIOS:navigator.userAgent.match(/(iphone)|(ipod)|(ipad)/i),osVersion:(navigator.userAgent.match(/Version\/(\d+)/i)||[])[1]};if(h.isIOS&&h.osVersion>=13||self===top)return;v(window),window.addEventListener("scroll",function(e){e.stopPropagation(),I=!1;var a=e.target;a.scrollTop+a.clientHeight>=a.scrollHeight?(I=!0,e.preventDefault()):0===a.scrollTop&&(I=!0,e.preventDefault())},!0)}}}();