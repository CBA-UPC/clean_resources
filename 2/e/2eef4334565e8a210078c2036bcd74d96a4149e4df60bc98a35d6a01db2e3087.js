(self.webpackChunktama_web=self.webpackChunktama_web||[]).push([[313],{64087:(e,t,n)=>{"use strict";n.d(t,{H_:()=>N,WK:()=>O,dC:()=>k,nx:()=>S,qA:()=>E});var o=n(41185),r=n(66062),a=n(18274),m=n(55752),i=n.n(m),c=n(5663),l=n.n(c),s=n(26946),p=n.n(s),d=n(73614),g=n(11622),u=n(43044),f=n(2412),y=n(44909),b=n(64132),h=n(70317),x=n(97781);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}nction C(e){return{type:x.Mb,payload:{error:e},error:!0}}var E=(0,a.H)({ttl:200},((e,t,n,o)=>function(){var a=(0,r.Z)((function*(r,a,m){var{fetchr:c}=m,s=i()(a(),["commentState","commentMap",n]);if(s)return r(_(s));try{var p=yield c.read("blogSingleComment").params({blogId:e,entryId:t,commentId:n,amebaId:o}).end(),{data:u}=p;if(l()(u))return r(C({message:"Not Found"}));if(!("comment_author"in u))if(u.comment_url){var[y]=(0,f.d)([u.comment_url]);yield r(d.Rs(y));var b=i()(a(),["bloggerState","bloggerMap",y,"profile"],{});u.comment_author=(0,f.E)(u,b)}else u.comment_author=(0,f.E)(u);if(u.image=i()(u,["comment_author","profile_image_url"],""),!(!1!==i()(a(),["deviceState","isEmojiSupported"])))try{var h={[n]:u},x=yield(0,g.t5)(h);Object.assign(u,x[n])}catch(T){console.warn(T)}return r(_(u))}catch(T){return console.warn(T),r(C(T))}}));return ()));function k(e){var{commentName:t,commentText:n}=e,o=(0,y.nL)(t),r=(0,y.xW)(n),a=!o.valid||!r.valid,[m=""]=r.errorMessages,i=(0,b.j)(n);return{type:x.NX,payload:{commentText:n,commentTextErrorMessage:m,commentTextLength:i,disableSendButton:a}}}function S(e){var{commentName:t,commentText:n}=e,o=(0,y.nL)(t),r=(0,y.xW)(n),a=!o.valid||!r.valid,[m=""]=o.errorMessages,i=(0,b.j)(t);return{type:x.NU,payload:{commentName:t,commentNameErrorMessage:m,commentNameLength:i,disableSendButton:a}}}var O=(0,a.H)({ttl:200},(e=>{var{amebaId:t,amebloToken:n,entryId:o,inReplyToCommentId:a,recaptchaToken:m,sessionUserNickname:c,enableFiltering:l=!1}=e;return function(){var e=(0,r.Z)((function*(e,r){var{commentName:s,commentText:d}=i()(r(),["replyCommentState","componentState"],{}),g={amebaId:t,commentText:d,entryId:parseInt(o,10),inReplyToCommentId:parseInt(a,10),recaptchaToken:m,enableFiltering:l};try{return e(function(e){return{type:x.m_,payload:{commentNameKey:p()("@tama-web/entryReplyComment/SEND_REPLY_COMMENT/SUCCESS_NAME"),commentTextKey:p()("@tama-web/entryReplyComment/SEND_REPLY_COMMENT/SUCCESS_TEXT"),data:e}}}((0,h.jl)(r())?yield(0,u.S)(v(v({},g),{},{amebloToken:n,commentName:c})):yield(0,u.y)(v(v({},g),{},{commentName:s}))))}catch(f){return e(function(e){return{type:x.E,payload:{error:e},error:!0}}(f))}}));return ()}))},80313:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:);var o,r,a=n(3e4),m=n(15329),i=n(41185),c=n(66062),l=n(76955),s=n(9580),p=n.n(s),d=n(55752),g=n.n(d),u=n(66948),f=n(97175),y=n(45525),b=n(51650),h=n(78168),x=n(19008),T=n(37111),v=n(44909),N=n(70317),_=n(73614),C=n(64087),E=n(12942),k=n(67492),S=n(90926),O=(n(91938),n(59226)),I=n.n(O),w=n(50518),M=n.n(w),Z=n(85819),j=n(5563),L=n(48516),P=n(7216),R=n(64177),F=n(73052),A=n(32019),U=n(20777),B=n(76030),H=n(79138),K=n.n(H),D=function(e){var{amebloOneTimeToken:t,canCommentMemberOnly:n,commentErrorMessage:m,commentNameErrorMessage:i,commentNameFilterError:c,commentNameKey:s,commentNameLength:p,commentNameMaxLength:d,commentTextErrorMessage:g,commentTextFilterError:u,commentTextKey:f,commentTextLength:y,commentTextMaxLength:b,defaultCommentName:h,defaultCommentText:x,isLoggedIn:T,isPostedComment:v,profileImageUrl:N,profileNickname:_,replyTo:C,onChangeName:E,onChangeText:k}=e,S=(0,Z.I)(),[O,w]=(0,l.useState)(!1),[H,D]=(0,l.useState)(!1),[q,X]=(0,l.useState)(!1);(0,l.useEffect)((()=>{O&&(c||u)&&X(!0)}),[c,u,O]);var Y,z=c||u,V=z?"comment_violation_dialog":"comment_first_dialog",W=(0,l.useCallback)((()=>{D(!0),S((0,j.iG)({sectionId:V}))}),[D]),G=(0,l.useCallback)((()=>{D(!1),w(!0),e.onClickSend(),S((0,j.XI)({sectionId:V}))}),[e.onClickSend,w,D]),Q=(0,l.useCallback)((,[X,D]),$=(0,l.useCallback)((,[e.onClickSend,w]),J=(0,l.useCallback)((()=>{X(!1),S((0,j.XI)({sectionId:V}))}),[X]);Y=T?""!==g||y<=0:""!==i||p<=0||""!==g||y<=0;var ee="js-comment-textarea";return(0,a.Z)("section",{className:K().SpEntryPostReplyCommentBlock},void 0,n&&!T?(0,a.Z)(A.x,{amebloOneTimeToken:t,pageType:"Reply"}):(0,a.Z)(l.Fragment,{},void 0,(0,a.Z)("div",{className:K().ProfileBlock},void 0,(0,a.Z)("label",{className:K().LabelBlock,htmlFor:ee},void 0,(0,a.Z)(U.v,{imageUrl:N,nickname:_}),(0,a.Z)("span",{className:K().Comment},void 0,"\u30b3\u30e1\u30f3\u30c8",!T&&(0,a.Z)("span",{className:K().Required},void 0,o||(o=(0,a.Z)("span",{"aria-hidden":"true"},void 0,"*")),"\u5fc5\u9808"))),!T&&(0,a.Z)(L.Z,{className:K().LoginLink,targetUrl:"".concat(window.process.env.HTTP_PATH_BLOG_AMEBA,"/ucs/logininput.do")},void 0,"\u30ed\u30b0\u30a4\u30f3",(0,a.Z)(I(),{"aria-hidden":!0,className:K().LoginIcon}))),(0,a.Z)("div",{className:K().ReplyBlock},void 0,(0,a.Z)(M(),{"aria-hidden":!0,className:K().ReplyIcon}),(0,a.Z)("span",{className:K().ReplyTo},void 0,C),(0,a.Z)("span",{className:K().ReplyToSuffix},void 0,"\u3055\u3093\u3078\u306e\u8fd4\u4fe1")),(0,a.Z)(B.F,{className:K().SpEntryCommentTextArea,currentLength:y,defaultValue:x,errorMessage:g,filterError:u,maxLength:b,placeholder:"\u8fd4\u4fe1\u3092\u66f8\u304f",textareaId:ee,onChange:k},f),(0,a.Z)("noscript",{},void 0,(0,a.Z)("p",{className:K().NoScriptNotice},void 0,"\u30b3\u30e1\u30f3\u30c8\u3092\u66f8\u304f\u306b\u306f\u7aef\u672b\u306eJavaScript\u3092\u30aa\u30f3\u306b\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044")),(0,a.Z)("div",{},void 0,!T&&(0,a.Z)(F.X,{className:K().SpEntryCommentInput,currentLength:p,defaultValue:h,errorMessage:i,filterError:c,maxLength:d,placeholder:"\u304a\u540d\u524d\u3092\u5165\u529b",onChange:E},s),""!==m&&!z&&(0,a.Z)("p",{"aria-live":"polite",className:K().CommentErrorMessage,role:"alert"},void 0,r||(r=(0,a.Z)("span",{"aria-hidden":"true"},void 0,"*")),m),!T&&(0,a.Z)("div",{className:K().TermsBlock},void 0,(0,a.Z)("a",{className:K().TermsLink,href:"https://helps.ameba.jp/rules/post_104.html"},void 0,"\u5229\u7528\u898f\u7d04"),"\u306b\u540c\u610f\u3057\u3066\u9001\u4fe1\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044"),(0,a.Z)("div",{className:K().SendButtonBlock},void 0,(0,a.Z)("button",{className:K().SendButton,disabled:Y,type:"button",onClick:v?$:W},void 0,"\u9001\u4fe1"))),(0,a.Z)(P.Z,{contentLabel:"\u30b3\u30e1\u30f3\u30c8\u6295\u7a3f\u306b\u95a2\u3059\u308b\u30c0\u30a4\u30a2\u30ed\u30b0",formContent:(0,a.Z)(l.Fragment,{},void 0,(0,a.Z)("div",{className:K().Button},void 0,(0,a.Z)(R.ZP,{appearance:R.OR.PRIMARY,label:z?"\u30b3\u30e1\u30f3\u30c8\u753b\u9762\u306b\u623b\u308b":"\u3053\u306e\u307e\u307e\u9001\u4fe1\u3059\u308b",roundness:R.a6.MAX,onClick:z?J:G})),!z&&(0,a.Z)("div",{className:K().Button},void 0,(0,a.Z)(R.ZP,{appearance:R.OR.SECONDARY,label:"\u30ad\u30e3\u30f3\u30bb\u30eb",roundness:R.a6.MAX,onClick:Q}))),heading:"\u76f8\u624b\u306e\u6c17\u6301\u3061\u306b\u5bc4\u308a\u6dfb\u3063\u305f\u30b3\u30e1\u30f3\u30c8\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304b\uff1f",isOpen:H||q,mainContent:"\u30b3\u30e1\u30f3\u30c8\u3092\u898b\u8fd4\u3059\u3088\u3046\u3054\u5354\u529b\u304a\u9858\u3044\u3057\u307e\u3059",onRequestClose:Q})))};D.defaultProps={amebloOneTimeToken:"",canCommentMemberOnly:!1,commentErrorMessage:"",commentNameErrorMessage:"",commentNameFilterError:!1,commentNameLength:0,commentTextErrorMessage:"",commentTextFilterError:!1,commentTextLength:0,defaultCommentName:"",defaultCommentText:"",profileImageUrl:"",isPostedComment:!1};var q=l.memo(D);nction z(){return(z=(0,c.Z)((function*(e){var{dispatch:t,getState:n,match:o}=e,{amebaId:r,entryId:a,commentId:m}=o.params,i=yield t((0,_.Rs)(r));if(i&&i.error)"Not Found"===g()(i,"payload.error.message")?t((0,E.Qn)(r)):t((0,E.$F)(r));else{var c=g()(n(),["bloggerState","bloggerMap",r],{}),l=g()(n(),["bloggerState","blogMap",c.blog],{});if(l&&l.blog_id){var{blog_id:s}=l,p=yield t((0,C.qA)(s,a,m,r));"Not Found"===g()(p,["payload","error","message"])&&t((0,E.Qn)(r))}else t((0,E.Qn)(r))}}))).apply(this,arguments)}function V(){return(V=(0,c.Z)((function*(e){var{dispatch:t,getState:n}=e;yield t((0,S.h$)());var o=g()(n(),["userState","sessionUser","amebaId"],"");yield t((0,_.Rs)(o))}))).apply(this,arguments)}var W=l.memo((function(e){var{amebloOneTimeToken:t,canCommentMemberOnly:n,commentErrorMessage:o,commentNameErrorMessage:r,commentNameFilterError:m,commentNameKey:i,commentNameLength:c,commentTextErrorMessage:s,commentTextFilterError:p,commentTextKey:d,commentTextLength:g,defaultCommentText:u,isLoggedIn:f,isPostedComment:y,profileImageUrl:b,profileNickname:h,replyTo:T,onChangeName:N,onChangeText:_,onClickSend:C}=e;return(0,l.useEffect)((()=>{"undefined"==typeof grecaptcha&&(0,x.v)("https://www.google.com/recaptcha/enterprise.js?render=".concat(window.process.env.RECAPTCHA_V3_SITE_KEY))})),(0,a.Z)(q,{amebloOneTimeToken:t,canCommentMemberOnly:n,commentErrorMessage:o,commentNameErrorMessage:r,commentNameFilterError:m,commentNameKey:i,commentNameLength:c,commentNameMaxLength:v.xq,commentTextErrorMessage:s,commentTextFilterError:p,commentTextKey:d||u,commentTextLength:g,commentTextMaxLength:v.lL,defaultCommentText:u,isLoggedIn:f,isPostedComment:y,profileImageUrl:b,profileNickname:h,replyTo:T,onChangeName:N,onChangeText:_,onClickSend:C})})),G=(0,h.ee)((0,y.w1)(K()),(0,f.provideHooks)({defer:function(e){return z.apply(this,arguments)},done:function(e){return V.apply(this,arguments)}}),(0,u.$j)((function(e,t){var{match:n}=t,{amebaId:o,entryId:r,commentId:a}=n.params||{},m=g()(e,["bloggerState","bloggerMap",o,"blog"],""),i="ameba_only"===g()(e,["bloggerState","blogMap",m,"deny_comment"],""),{commentErrorMessage:c,commentName:l,commentNameErrorMessage:s,commentNameFilterError:p,commentNameKey:d,commentNameLength:u,commentText:f,commentTextErrorMessage:y,commentTextFilterError:b,commentTextKey:h,commentTextLength:x}=g()(e,["replyCommentState","componentState"],{}),T=(0,N.jl)(e),v=T?g()(e,["amebloTokenState","amebloToken"],""):"",_=g()(e,["amebloTokenState","amebloOneTimeToken"],""),C=g()(e,["userState","sessionUser","amebaId"],""),E=g()(e,["bloggerState","bloggerMap",C],{}),k=g()(E,["profile","image_filepath"],""),S=g()(E,["profile","nickname"],""),O=g()(e,["replyCommentState","replyComment","data","comment_name"]),I="\uff1e".concat(O,"\n"),w=g()(e,["bloggerState","bloggerMap",o,"image_auth","comment_image_auth"],!0),M=null;try{M="undefined"!=typeof window&&JSON.parse(window.localStorage.getItem("posted_comment"))}catch(Z){console.error(Z),M=!1}return Y(Y({},{amebaId:o,amebloToken:v,commentId:a,commentName:l,commentText:f,entryId:r,isRequiredImageAuth:w,sessionUserAmebaId:C,sessionUserNickname:S}),{},{amebloOneTimeToken:_,canCommentMemberOnly:i,commentErrorMessage:c,commentName:l,commentNameErrorMessage:s,commentNameFilterError:p,commentNameKey:d,commentNameLength:u,commentText:f,commentTextErrorMessage:y,commentTextFilterError:b,commentTextKey:h,commentTextLength:x,defaultCommentText:I,isLoggedIn:T,isPostedComment:M,profileImageUrl:k,profileNickname:S,replyTo:O})}),(function(e,t){var{match:n}=t;return{baseOnChangeReplyName(t){e((0,C.nx)(t))},baseOnChangeReplyTextbaseOnClickSendReply:function(){var t=(0,c.Z)((function*(t){if(t.clearComment&&(yield e((0,C.H_)())),!(yield e((0,C.WK)(t))).error){var{amebaId:o,entryId:r}=n.params;yield e((0,k.B)("\u30b3\u30e1\u30f3\u30c8\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f")),yield new Promise((),yield e((0,k.i)()),window.location.pathname="/".concat(o,"/comment-").concat(r,"/")}}));return ()}}),(function(e,t,n){var{amebaId:o,amebloToken:r,entryId:a,commentId:i,isLoggedIn:l,isPostedComment:s,isRequiredImageAuth:d,sessionUserAmebaId:g,sessionUserNickname:u,commentTextFilterError:f,commentNameFilterError:y}=e,{baseOnChangeReplyName:b,baseOnChangeReplyText:h,baseOnClickSendReply:x}=t,T=(0,m.Z)(t,["baseOnChangeReplyName","baseOnChangeReplyText","baseOnClickSendReply"]);return Y(Y(Y(Y({},n),e),T),{},{commentName:l?u:e.commentName,onChangeName(t){var n=t.target.value;b({commentName:n,commentText:e.commentText})},onChangeText(t){var n=t.target.value;h({commentName:e.commentName,commentText:n})},onClickSend:p()((0,c.Z)((function*(){var e={amebaId:o,amebloToken:r,entryId:a,inReplyToCommentId:i,sessionUserNickname:u,enableFiltering:!0};try{s||window.localStorage.setItem("posted_comment",!0)}catch(n){console.error(n)}if(l&&g&&(e.sessionUserAmebaId=g),(f||y)&&(e.clearComment=f||y),d){if("undefined"==typeof grecaptcha)return;yield new Promise(();var t=yield window.grecaptcha.enterprise.execute(window.process.env.RECAPTCHA_V3_SITE_KEY,{action:"homepage"});e.recaptchaToken=t}x(e)})),500)})})),(0,b.lB)(["match","location"]))(W)},82251:(e,t,n)=>{var o=n(18300),r=n(2966),a=o(();a.i(r,"",!0),a.push([e.id,"._2AjjKa9X{background-color:#fff;border-top:1px solid #e2e2e2;padding:16px 16px 24px}._3VnTfprs{flex-direction:row;justify-content:space-between}._16TXKv3i,._3VnTfprs{align-items:center;display:flex}._16TXKv3i{color:#333;flex-grow:1;font-size:16px}._28hiiVvu,._VsjHFj5d{margin-left:8px}._VsjHFj5d{color:#757575;font-size:12px}._2vQH_dMl:link,._2vQH_dMl:visited{align-items:center;color:#2d8c3c;display:flex;font-size:12px;font-weight:700}._1x717xNg{margin-left:4px}._2g_bWy05{align-items:center;color:#333;display:flex;font-size:16px;margin-bottom:16px;margin-top:24px}._2P-O7Nkx{font-size:20px;margin-right:8px}._3rs7aXWS{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._3GHnsHaY{margin-left:8px;white-space:nowrap}._2DE0Umpb{margin-top:8px}._1EhEIua-{line-height:1.4}._3kNZ3tZo,._1EhEIua-{color:#f24c3b;font-size:12px;font-weight:700}._3kNZ3tZo{margin-top:8px;text-align:left}._3pofsozh,._1qbAU87Y{margin-top:24px}._1qbAU87Y{color:#757575;font-size:12px;text-align:center}._IzTMUitE{color:#757575;text-decoration:underline}._5rIrWuYx{margin-top:16px;padding:0 64px}._q5CHcOND{background-color:#2d8c3c;border-radius:40px;box-sizing:border-box;color:#fff;display:block;font-weight:700;margin:0 auto;padding:16px 0;transition:background-color .2s ease 0s;width:100%}@media (prefers-reduced-motion:reduce){._q5CHcOND{transition-duration:0s}}._q5CHcOND[disabled]{background-color:#aaa}._Z_ulrGxe{}._Z_ulrGxe+._Z_ulrGxe{margin-top:-8px}._Z_ulrGxe:last-child{margin-bottom:0}",""]),a.locals={SpEntryPostReplyCommentBlock:"_2AjjKa9X",ProfileBlock:"_3VnTfprs",LabelBlock:"_16TXKv3i",Comment:"_28hiiVvu",Required:"_VsjHFj5d",LoginLink:"_2vQH_dMl",LoginIcon:"_1x717xNg",ReplyBlock:"_2g_bWy05",ReplyIcon:"_2P-O7Nkx",ReplyTo:"_3rs7aXWS",ReplyToSuffix:"_3GHnsHaY",SpEntryCommentTextArea:"_2DE0Umpb",NoScriptNotice:"_1EhEIua-",CommentErrorMessage:"_3kNZ3tZo",SpEntryCommentInput:"_3pofsozh",TermsBlock:"_1qbAU87Y",TermsLink:"_IzTMUitE",SendButtonBlock:"_5rIrWuYx",SendButton:"_q5CHcOND",Button:"_Z_ulrGxe "+r.locals.FormContent},e.exports=a},79138:(e,t,n)=>{var o=n(82251),r=Object.assign||a=Object.defineProperty||"string"==typeof o&&(o=[[e.id,o,""]]),e.exports=function(e){var t=r({},e.locals||{});return a(t,"_",{value:),a(t,"toString",{value:function(){return"function"==typeof e.toString?e.toString():""}}),t}(o)}}]);