!this,function(){"use strict"; o="$default_instance",c=2,n=4096,a=1e3,v="$identify",m="$groupidentify",f="amplitude_lastEventId",h="amplitude_lastEventTime",y="amplitude_lastIdentifyId",_="amplitude_lastSequenceNumber",w="amplitude_sessionId",b="amplitude_deviceId",I="amplitude_optOut",S="amplitude_userId",i="amplitude_cookie_test",s="revenue_amount",u="$productId",p="$quantity",d="$price",l="$revenueType",E="amp_device_id",O="referrer",N="utm_source",x="utm_medium",k="utm_campaign",A="utm_term",T="utm_content",P=q=R={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:_encode:decode:_decode:,C=Object.prototype.toString;ar e,D={DISABLE:0,ERROR:1,WARN:2,INFO:3},U=D.WARN,M={error:function(e){U>=D.ERROR&&z(e)},warn:function(e){U>=D.WARN&&z(e)},info:,z=B=G=K=["nan","function","arguments","regexp","element"],V=F=L=W=M,$=J=Q=X=H=Z=G,Y=ee=te={expirationDays:void 0,domain:void 0},ne=ie=re=oe=se=ae={reset:options:get:re,set:oe,remove:se};if())e=window.localStorage;else if(window.globalStorage)try{e=window.globalStorage[window.location.hostname]}catch(e){}else if("undefined"!=typeof document){var ue=document.createElement("div"),pe="localStorage";ue.style.display="none",document.getElementsByTagName("head")[0].appendChild(ue),ue.addBehavior&&(ue.addBehavior("#default#userdata"),e={length:0,setItem:getItem:removeItem:clear:key:,ue.load(pe),e.length=ue.XMLDocument.documentElement.attributes.length)}e||(e={length:0,setItem:getItem:function(e){},removeItem:function(e){},clear:function(){},key:);var ce=e,de=de.prototype._cookiesEnabled=de.prototype.getStorage=var le="$clearAll",fe=fe.prototype.add=fe.prototype.append=function(e,t){return this._addOperation("$append",e,t),this},fe.prototype.clearAll=fe.prototype.prepend=function(e,t){return this._addOperation("$prepend",e,t),this},fe.prototype.set=function(e,t){return this._addOperation("$set",e,t),this},fe.prototype.setOnce=fe.prototype.unset=fe.prototype._addOperation=var he="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};ar ve=ge(,me=ye=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var be=)?Object.assign:Ie="%[a-f0-9]{2}";new RegExp(Ie,"gi"),new RegExp("("+Ie+")+","gi");ar Ee=Oe=Oe.prototype.send=var Ne=Ne.prototype.setProductId=Ne.prototype.setQuantity=function(e){return"number"!==j(e)?W.error("Unsupported type for quantity: "+j(e)+", expecting number"):this._quantity=parseInt(e),this},Ne.prototype.setPrice=function(e){return"number"!==j(e)?W.error("Unsupported type for price: "+j(e)+", expecting number"):this._price=e,this},Ne.prototype.setRevenueType=Ne.prototype.setEventProperties=Ne.prototype._isValidRevenue=Ne.prototype._toJSONObject=var xe,ke=ge(,Ae=(ke.UAParser,"5.8.0-gitbook1.10.1"),Te={apiEndpoint:"app.gitbook.com/__amp/",batchEvents:!1,cookieExpiration:3650,cookieName:"amplitude_id",deviceIdFromUrlParam:!1,domain:"",eventUploadPeriodMillis:3e4,eventUploadThreshold:30,forceHttps:!0,includeGclid:!1,includeReferrer:!1,includeUtm:!1,language:{language:navigator&&(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage)||void 0}.language,logLevel:"WARN",optOut:!1,onError:function(){},platform:"Web",savedMaxCount:1e3,saveEvents:!0,saveParamsReferrerOncePerSession:!0,secureCookie:!1,sessionTimeout:18e5,trackingOptions:{city:!0,country:!0,carrier:!0,device_manufacturer:!0,device_model:!0,dma:!0,ip_address:!0,language:!0,os_name:!0,os_version:!0,platform:!0,region:!0,version_name:!0},unsetParamsReferrerOnNewSession:!1,unsentKey:"amplitude_unsent",unsentIdentifyKey:"amplitude_unsent_identify",uploadBatchSize:100},Pe=Pe.prototype.Identify=fe,Pe.prototype.Revenue=Ne,Pe.prototype.init=function(e,p,c,t){var d=this;if("string"!==j(e)||$(e))W.error("Invalid apiKey. Please re-initialize with a valid apiKey");else try{this.options.apiKey=e,this._storageSuffix="_"+e+this._legacyStorageSuffix;var n=!!this.cookieStorage.get(this.options.cookieName+this._storageSuffix);if(c&&c.deferInitialization&&!n)return void this._deferInitialization(e,p,c,t);qe(this.options,c),"string"===j(this.options.logLevel)&&L(this.options.logLevel);var i=Be(this);this._apiPropertiesTrackingOptions=0<Object.keys(i).length?{tracking_options:i}:{},this.cookieStorage.options({expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie}),this.options.domain=this.cookieStorage.options().domain,this._instanceName===o&&Re(this),Ce(this),this._pendingReadStorage=!0;var r=function(e){d.options.deviceId="object"===j(c)&&"string"===j(c.deviceId)&&!$(c.deviceId)&&c.deviceId||d.options.deviceIdFromUrlParam&&d._getDeviceIdFromUrlParam(d._getUrlParams())||d.options.deviceId||e||d.generateDeviceId(),d.options.userId="string"===j(p)&&!$(p)&&p||"number"===j(p)&&p.toString()||d.options.userId||null;var t=(new Date).getTime();if((!d._sessionId||!d._lastEventTime||t-d._lastEventTime>d.options.sessionTimeout)&&(d.options.unsetParamsReferrerOnNewSession&&d._unsetUTMParams(),d._newSession=!0,d._sessionId=t,d.options.saveParamsReferrerOncePerSession&&d._trackParamsAndReferrer()),d.options.saveParamsReferrerOncePerSession||d._trackParamsAndReferrer(),d.options.saveEvents){for(var n=0;n<d._unsentEvents.length;n++){var i=d._unsentEvents[n].event_properties,r=d._unsentEvents[n].groups;d._unsentEvents[n].event_properties=Z(i),d._unsentEvents[n].groups=X(r)}for(var o=0;o<d._unsentIdentifys.length;o++){var s=d._unsentIdentifys[o].user_properties,a=d._unsentIdentifys[o].groups;d._unsentIdentifys[o].user_properties=Z(s),d._unsentIdentifys[o].groups=X(a)}}d._lastEventTime=t,De(d),d._pendingReadStorage=!1,d._sendEventsIfReady();for(var u=0;u<d._onInit.length;u++)d._onInit[u]();d._onInit=[],d._isInitialized=!0};this.options.saveEvents&&(this._unsentEvents=this._loadSavedUnsentEvents(this.options.unsentKey).concat(this._unsentEvents),this._unsentIdentifys=this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).concat(this._unsentIdentifys)),r(),this.runQueuedFunctions(),"function"===j(t)&&t(this)}catch(e){W.error(e),this.options.onError(e)}},Pe.prototype._migrateUnsentEvents=Pe.prototype._trackParamsAndReferrer=var qe=Pe.prototype.runQueuedFunctions=Pe.prototype._apiKeySet=Pe.prototype._loadSavedUnsentEvents=Pe.prototype._parseSavedUnsentEventsString=Pe.prototype.isNewSession=function(){return this._newSession},Pe.prototype.onInit=Pe.prototype.getSessionId=Pe.prototype.nextEventId=function(){return this._eventId++,this._eventId},Pe.prototype.nextIdentifyId=function(){return this._identifyId++,this._identifyId},Pe.prototype.nextSequenceNumber=Pe.prototype._unsentCount=Pe.prototype._sendEventsIfReady=Pe.prototype._getFromStorage=Pe.prototype._setInStorage=var Re=Ce=je=De=Pe.prototype._initUtmData=Pe.prototype._unsetUTMParams=var Ue=Pe.prototype._getReferrer=function(){return document.referrer},Pe.prototype._getUrlParams=Pe.prototype._saveGclid=Pe.prototype._getDeviceIdFromUrlParam=Pe.prototype._getReferringDomain=Pe.prototype._saveReferrer=Pe.prototype.saveEvents=Pe.prototype.setDomain=function(e){if(this._shouldDeferCall())return this._q.push(["setDomain"].concat(Array.prototype.slice.call(arguments,0)));if(H(e,"domain","string"))try{this.cookieStorage.options({expirationDays:this.options.cookieExpiration,secure:this.options.secureCookie,domain:e}),this.options.domain=this.cookieStorage.options().domain,Ce(this),De(this)}catch(e){W.error(e)}},Pe.prototype.setUserId=Pe.prototype.setGroup=Pe.prototype.setOptOut=Pe.prototype.setSessionId=Pe.prototype.resetSessionId=Pe.prototype.regenerateDeviceId=function(){if(this._shouldDeferCall())return this._q.push(["regenerateDeviceId"].concat(Array.prototype.slice.call(arguments,0)));this.setDeviceId(this.generateDeviceId())},Pe.prototype.generateDeviceId=function(){return )+"R"},Pe.prototype.setDeviceId=function(e,t){if(!t&&this._shouldDeferCall())return this._q.push(["setDeviceId"].concat(Array.prototype.slice.call(arguments,0)));if(H(e,"deviceId","string"))try{$(e)||(this.options.deviceId=""+e,De(this))}catch(e){W.error(e)}},Pe.prototype.setUserProperties=Pe.prototype.clearUserProperties=var Me=Pe.prototype.identify=Pe.prototype.groupIdentify=Pe.prototype.setVersionName=Pe.prototype._logEvent=function(e,t,n,i,r,o,s,a){if(Ce(this),e)if(this.options.optOut)"function"===j(a)&&a(0,"No request sent",{reason:"optOut is set to true"});else try{var u;u=e===v||e===m?this.nextIdentifyId():this.nextEventId();var p=this.nextSequenceNumber(),c="number"===j(s)?s:(new Date).getTime();(!this._sessionId||!this._lastEventTime||c-this._lastEventTime>this.options.sessionTimeout)&&(this._sessionId=c),this._lastEventTime=c,De(this);var d=this._ua.browser.name,l=this._ua.browser.major,f=this._ua.os.name;i=i||{},n=g({},n||{},g({},this._apiPropertiesTrackingOptions)),t=t||{},r=r||{},o=o||{};var h={device_id:this.options.deviceId,user_id:this.options.userId,timestamp:c,event_id:u,session_id:this._sessionId||-1,event_type:e,version_name:ze(this,"version_name")&&this.options.versionName||null,platform:ze(this,"platform")?this.options.platform:null,os_name:ze(this,"os_name")&&d||null,os_version:ze(this,"os_version")&&l||null,device_model:ze(this,"device_model")&&f||null,device_manufacturer:(ze(this,"device_manufacturer"),null),language:ze(this,"language")?this.options.language:null,carrier:(ze(this,"carrier"),null),api_properties:n,event_properties:Q(Z(t)),user_properties:Q(Z(i)),uuid:this.generateDeviceId(),library:{name:"amplitude-js",version:Ae},sequence_number:p,groups:Q(X(r)),group_properties:Q(Z(o)),user_agent:this._userAgent};return e===v||e===m?(this._unsentIdentifys.push(h),this._limitEventsQueued(this._unsentIdentifys)):(this._unsentEvents.push(h),this._limitEventsQueued(this._unsentEvents)),this.options.saveEvents&&this.saveEvents(),this._sendEventsIfReady(a)||"function"!==j(a)||a(0,"No request sent",{reason:"No events to send or upload queued"}),u}catch(e){W.error(e)}else"function"===j(a)&&a(0,"No request sent",{reason:"Missing eventType"})};var ze=Be=Pe.prototype._limitEventsQueued=Pe.prototype.logEvent=Pe.prototype.logEventWithTimestamp=Pe.prototype.logEventWithGroups=var Ge=Pe.prototype.logRevenueV2=Pe.prototype.logRevenue=Pe.prototype.removeEvents=var Ke=Pe.prototype.sendEvents=Pe.prototype._mergeEventsAndIdentifys=Pe.prototype.setGlobalUserProperties=Pe.prototype.__VERSION__=Ae,Pe.prototype._shouldDeferCall=Pe.prototype._deferInitialization=Pe.prototype.enableTracking=var Ve=Ve.prototype.Identify=fe,Ve.prototype.Revenue=Ne,Ve.prototype.getInstance=Ve.prototype.runQueuedFunctions=Ve.prototype.init=Ve.prototype.isNewSession=function(){return this.getInstance().isNewSession()},Ve.prototype.getSessionId=function(){return this.getInstance().getSessionId()},Ve.prototype.nextEventId=function(){return this.getInstance().nextEventId()},Ve.prototype.nextIdentifyId=function(){return this.getInstance().nextIdentifyId()},Ve.prototype.nextSequenceNumber=Ve.prototype.saveEvents=function(){this.getInstance().saveEvents()},Ve.prototype.setDomain=function(e){this.getInstance().setDomain(e)},Ve.prototype.setUserId=function(e){this.getInstance().setUserId(e)},Ve.prototype.setGroup=function(e,t){this.getInstance().setGroup(e,t)},Ve.prototype.setOptOut=function(e){this.getInstance().setOptOut(e)},Ve.prototype.regenerateDeviceId=function(){this.getInstance().regenerateDeviceId()},Ve.prototype.setDeviceId=function(e){this.getInstance().setDeviceId(e)},Ve.prototype.setUserProperties=function(e){this.getInstance().setUserProperties(e)},Ve.prototype.clearUserProperties=Ve.prototype.identify=function(e,t){this.getInstance().identify(e,t)},Ve.prototype.setVersionName=function(e){this.getInstance().setVersionName(e)},Ve.prototype.logEvent=function(e,t,n){return this.getInstance().logEvent(e,t,n)},Ve.prototype.logEventWithGroups=Ve.prototype.logRevenueV2=Ve.prototype.logRevenue=Ve.prototype.removeEvents=Ve.prototype.sendEvents=function(e){this.getInstance().sendEvents(e)},Ve.prototype.setGlobalUserProperties=Ve.prototype.__VERSION__=Ae;var Fe=window.amplitude||{},Le=new Ve;for(var We in Le._q=Fe._q||[],Fe._iq)Fe._iq.hasOwnProperty(We)&&(Le.getInstance(We)._q=Fe._iq[We]._q||[]);return Le.runQueuedFunctions(),Le});
