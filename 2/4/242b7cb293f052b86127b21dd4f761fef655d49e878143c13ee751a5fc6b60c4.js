(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[658],{EIj1:LJgF:Y1uq:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeLivePersonaEditorAsync",(function(){return ye})),n.d(t,"initializeLivePersonaCardAsync",(function(){return ke})),n.d(t,"freeBootstrapperMemory",(function(){return Te})),n.d(t,"fetchLokiConfigAsync",(function(){return Ie}));var r=3e5,o=function(){return function(e,t,n,r,o,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=o,this.numberOfRetries=i}}();function i(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}var a,s="LokiAuthToken";function c(e,t,n){return new Promise((function(r,a){e?(i(s,e,n),r(e)):t((function(e,t){e?(i(s,e,n),r(e)):a(new o("GetAuthTokenError","Auth token is undefined",t))}),(function(e,t,n){var r=function(e,t){var n=/^AADSTS\d+?:/.test(e),r=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||r}(e,n)?e:"";a(new o("GetAuthTokenError",r,t,n))}))}))}function u(e,t){var n=e);return n||(n=function(e){switch(e){case"Df":return a.Dogfood;case"Msit":return a.MSIT;case"Blackforest":return a.Blackforest;case"GccModerate":return a.GccModerate;case"GccHigh":return a.GccHigh;case"DoD":return a.DOD;case"Gallatin":return a.Gallatin;case"Prod":return a.TopLevel;case"AG08":return a.AG08;case"AG09":return a.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return function(e){return e}(e)}}(t)),n}!a||(a={}));var l="{0}/api/v1/livepersonacard/configuration?cultureName={1}",f=n("QjXU");function d(e){return!e)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e||"")}function p(){for(var e=function(){return"object"==typeof window&&window.crypto&&function(){var e=new Uint8Array(31);return window.crypto.getRandomValues(e),e}()||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}()}(),t=0,n="",r=0;r<36;r++)switch(r){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[r-t]%4+8).toString(16);break;default:n+=(e[r-t]%16).toString(16)}return n}function v(e,t){void 0===t&&(t=window);var n="";if(t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search);n=r&&t.decodeURIComponent(r[1].replace(/\+/g," "))||""}return n}var h="LivePersonaEditorBranchOverride",g="LivePersonaCardVersionOverride",m="MidgardVersion",y="MidgardBranch",C="HostAppConfiguration",w="LivePersonaEditorVersionOverride",b=),P=function(e,t,n,r,o,i,a){return void 0===o&&(o={}),void 0===i&&(i=6e4),new Promise((function(s,c){var u,l=new XMLHttpRequest,f=function(e,t){var n=v("ClientTypeOverride",t)||e.clientType,r=v("MidgardOnlyOverrideCatalog",t),o=v(C,t),i=v(m,t);return{clientTypeOverride:n,hostAppConfigurationQSP:o,versionOverride:(r?"":i)||v(g,t)||e.versionOverride||"",lpeVersionOverride:(r?"":i)||v(w,t),lpeBranchOverride:v(h,t),midgardBranchOverride:r?"":v(y,t)}}(n,r),d=f.clientTypeOverride,P=f.hostAppConfigurationQSP,L=f.versionOverride,k=f.lpeVersionOverride,T=f.lpeBranchOverride,I=f.midgardBranchOverride;l.open("GET",e,!0),l.setRequestHeader("Authorization","Bearer "+t),l.setRequestHeader("Accept","application/json");var O=null!==(u=o.requestId)&&void 0!==u?u:p();if(l.setRequestHeader("X-RootCorrelationId",O),l.setRequestHeader("X-CorrelationId",O),l.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),l.setRequestHeader("X-ClientFeature",n.clientFeature),l.setRequestHeader("X-ClientArchitectureVersion","v2"),l.setRequestHeader("X-ClientScenario","GetConfiguration"),a&&l.setRequestHeader("X-LPCVersion",a),d&&l.setRequestHeader("X-ClientType",d),n.app&&l.setRequestHeader("X-HostAppApp",n.app),n.platform&&l.setRequestHeader("X-HostAppPlatform",n.platform),n.hostAppRing&&l.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&l.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&l.setRequestHeader("X-HostAppConfiguration",JSON.stringify(n.hostAppConfiguration)),P){var A={};P.split(";").forEach((),l.setRequestHeader(C,JSON.stringify(A))}r&&r.React&&r.React.version&&r.ReactDOM&&l.setRequestHeader("X-HostAppReactVersion",r.React.version),L&&(l.setRequestHeader(g,L),l.setRequestHeader(m,L)),k&&l.setRequestHeader("X-".concat(w),k),T&&l.setRequestHeader("X-".concat(h),T),I&&(l.setRequestHeader(y,I),l.setRequestHeader("X-".concat(y),I)),l.addEventListener("load",(function(){if(200===l.status)try{var e=JSON.parse(l.response);e.RootCorrelationId=O,e.LokiVersion=l.getResponseHeader("x-serverversion")||"",s(e)}catch(e){c(new b("GetLokiConfigError","Failed to parse initialization config.",O))}else c(new b("GetLokiConfigError","Couldn't retrieve initialization config. Status code is ".concat(l.status),O,!1,l.status))})),l.addEventListener("error",(function(){c(new b("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",O))})),l.addEventListener("timeout",(function(){c(new b("GetLokiConfigError","Loki config request timed out after ".concat(i," ms."),O))})),l.timeout=i,l.send()}))};function L(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}var k=function(){return(k=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function T(e,t,n){var r,o=L("LivePersonaCardCultureOverride",n),i=function(e,t,n,r){var o=u(e,t);return r?l.replace("{0}",r).replace("{1}",n):l.replace("{0}",o).replace("{1}",n)}(t.region,t.complianceEnvironment,o||t.culture,null===(r=t.options)||void 0===r?void 0:r.lokiUrlOverride);return P(i,e,k(k({},t),{clientFeature:"LivePersonaCard"}),n)}function I(e,t,n){var r=function(e,t){var n=t||e.culture,r=u(e.region,e.complianceEnvironment);return"{0}/api/v1/livepersonaeditor/configuration?cultureName={1}".replace("{0}",r).replace("{1}",n)}(t,L("LivePersonaEditorCultureOverride",n));return P(r,e,k(k({},t),{clientFeature:"LivePersonaEditor"}),n)}var O=n("rlv/"),A=function(e){var t;return(t={})[e]="SCRUBBED",t};function x(e,t,n){var r,o,i;void 0===n&&(n=A);var a=Object.keys(e).filter((),s=Object(f.__assign)({},e);try{for(var c=Object(f.__values)(a),u=c.next();!u.done;u=c.next()){var l=u.value,d=s[l];if("object"!=typeof d||Array.isArray(d))s=Object.assign(s,n(l,s[l]));else{var p=x(s[l],t,n);s=Object.assign(s,((i={})[l]=p,i))}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}return s}function R(e,t,n,r){return(Object(O.a)(r)?r(e):r)?x(e,t,n):e}var S=n("6jEx"),E=["app","bootstrapperVersion","clientContextType","clientType","complianceEnvironment","culture","ErrorMessage","ErrorType","flights","hostAppRing","hostAppVersion","IsClientOnline","isConsumer","isConsumer","IsExpected","lokiUrl","name","Perf_AuthRequestDuration","Perf_GetAuthTokenDuration","Perf_GetAuthTokenFromStartDuration","Perf_GetLokiConfigDuration","Perf_GetLokiConfigFromStartDuration","Perf_GetLpcBundlesDuration","Perf_GetLpcBundlesFromStartDuration","Perf_GetLpeBundlesDuration","Perf_GetLpeBundlesFromStartDuration","Perf_InitConfigRequestDuration","Perf_LpcBundleRequestDuration","Perf_LpcStringsRequestDuration","Perf_StartLpcDuration","Perf_StartLpcFromStartDuration","platform","region","settings","versionOverride"],D=function(){return(D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function G(){var e={};return{setContextProperty:getContextProperties:function(){return e},createTelemetryEvent:function(t,n){var r=D({},t);r.properties=Object.assign(r.properties,e);var o=R(r,E,(function(e){var t;return(t={})[e]="EUPI_SCRUBBED",t}),n);return{name:o.name,data:D({},o.properties)}}}}function _(e,t){var n=new Map,r=e.telemetryCollectorUrlOneDs,o=function(n){var o={disableCookiesUsage:!0,instrumentationKey:n,extensions:[],extensionConfig:[],channelConfiguration:{autoFlushEventsLimit:50,ignoreMc1Ms0CookieProcessing:!0,overrideEndpointUrl:r},propertyConfiguration:{serviceName:e.app,sessionAsGuid:!0,populateBrowserInfo:!0}},i=new S.a;return i.initialize(o,[]),function(){var n=e.region,r=e.clientType,o=e.clientContextType,i=e.complianceEnvironment,a=e.versionOverride,s=e.hostAppRing,c=e.hostAppVersion,u=e.app,l=e.platform,f=e.isConsumer,d=void 0!==f&&f,p=e.clientCorrelationId;t.setContextProperty("culture",e.culture),t.setContextProperty("region",n),t.setContextProperty("clientType",r),t.setContextProperty("clientContextType",o),t.setContextProperty("bootstrapperVersion","1.20230622.2.0"),t.setContextProperty("complianceEnvironment",i),t.setContextProperty("isConsumer",JSON.stringify(d)),t.setContextProperty("versionOverride",a||""),t.setContextProperty("hostAppRing",s||""),t.setContextProperty("hostAppVersion",c||""),u&&t.setContextProperty("app",u),l&&t.setContextProperty("platform",l),t.setContextProperty("clientCorrelationId",p)}(),i},i=function(e,i){var a=n.get(e);a||(a=o(e));var s=t.createTelemetryEvent(i,();a.track(s),a.flush()};return{logEvent:i,logVerboseEvent:updateContextWithLokiConfig:function(e,i){var a=i.ClientTelemetryCollectorUrls;(null==a?void 0:a.OneDs)&&(r=a.OneDs),n.get(e)||n.set(e,o(e));var s=i.LokiUrl,c=i.Flights,u=i.Settings,l=i.TenantAadObjectId,f=i.UserAadObjectId,d=i.UserPuid;s&&t.setContextProperty("lokiUrl",s),c&&t.setContextProperty("flights",c.join(",")),d&&t.setContextProperty("userPuid",d),f&&t.setContextProperty("userAadObjectId",f),l&&t.setContextProperty("tenantAadObjectId",l),u&&t.setContextProperty("settings",JSON.stringify(u))}}}var j,U=new RegExp("https?://(localhost|local\\.teams\\.(office|live)\\.com)(:|/|$)"),W=z=["https://res.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud"];function F(e,t){var n=new URL("https://midgardbranches.blob.core.windows.net/lpc/refs/heads/"),r=t&&"/_next/"!==t&&"/"!==t?new URL(t):void 0,o=new URL(e,document.baseURI).origin;if(o===n.origin||r&&o===r.origin||function(e){return z.includes(e)}(o)||U.test(o))return e;throw new Error("TrustedType policy does not allow loading scripts from ".concat(o,", only from ").concat(n.origin,", ").concat(null==r?void 0:r.origin," and localhost."))}var H="data-is-midgard-bootstrapper-script";function M(e,t,n,r,o){var i=this;void 0===r&&(r=!1),void 0===o&&(o=!1);var a=0,s=function(e,t){return function(e,t,n,r){return new(n||(n=Promise))((function(t,o){function i(e){try{s(r.next(e))}catch(e){o(e)}}function a(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(i,a)}s((r=r.apply(e,[])).next())}))}(i,0,void 0,(function(){var i;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,6]),[4,q(e,t,r,o,n)];case 1:return c.sent(),[3,6];case 2:return i=c.sent(),a<2?(a++,[4,s(e,t)]):[3,4];case 3:return c.sent(),[3,5];case 4:throw i.numberOfRetries=a,i;case 5:return[3,6];case 6:return[2]}}))}))};return s(e,t)}function q(e,t,n,r,i){return new Promise((function(a,s){t||s(new o("StartLivePersonaCardError","targetWindow is undefined in appendScriptToDocumentAsync"));var c=t.document.querySelectorAll("script[".concat(H,"]"));if(r&&2===c.length)a();else{var u=function(e,t,n){void 0===t&&(t=W()),void 0===n&&(n=!0);var r,o=null,i=function(){if(void 0===j&&(j=null,"undefined"!=typeof self&&self.trustedTypes))try{j=self.trustedTypes.createPolicy("@1js/midgard-trusted-types",{createHTML:function(e){return e},createScript:createScriptURL:)}catch(e){}return j}();try{o=n&&i?i.createScriptURL(e,t):F(e,t)}catch(e){r=e.message}return{error:r,url:o,trustedTypeAvailable:!!i}}(e,void 0,n);if(u.error)return s(new o("LoadScriptError",u.error));var l=t.document.createElement("script");l.type="text/javascript",l.charset="utf-8",l.setAttribute(H,""),l.crossOrigin="anonymous",l.src=u.url,l.addEventListener("load",(function(){i&&i({name:"LoadScriptSuccess",properties:{isLPCDefined:!!t.LPC,lpcWindowId:t.lpcWindowId}}),a()})),l.addEventListener("error",(function(){i&&i({name:"LoadScriptFailure",properties:{isLPCDefined:!!t.LPC,lpcWindowId:t.lpcWindowId}}),s(new o("LoadScriptError","Unexpected error while loading script on page, lpcWindowId:"+t.lpcWindowId))})),t.document.body.appendChild(l)}}))}var B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},V=new WeakMap;function X(e){var t=e.targetWindow||window,n=V.get(t);return n?n.bootstrapperConfig=B(B({},n.bootstrapperConfig),e):(n={bootstrapperConfig:B(B({},e),{targetWindow:t}),oneDsLogger:_(e,G()),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0,abandonInitializationPromise:void 0}).bootstrapperConfig.targetWindow.lpcWindowId=p(),V.set(t,n),n}var N=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},J=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Q=0;function $(e,t,n){return N(this,void 0,void 0,(function(){var r,o;return J(this,(function(i){switch(i.label){case 0:return(o=X(t)).lpcConfig?(r=o.lpcConfig,[3,3]):[3,1];case 1:return[4,K(e,t,n)];case 2:r=i.sent(),o.lpcConfig=r,i.label=3;case 3:return[2,r]}}))}))}function K(e,t,n){return N(this,void 0,void 0,(function(){var r,o;return J(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,T(e,t,n)];case 1:return r=i.sent(),[3,8];case 2:return(o=i.sent()).statusCode&&401===o.statusCode?[4,c(void 0,t.getAuthToken,n)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return Q<2?(Q++,[4,K(e,t,n)]):[3,6];case 5:return r=i.sent(),[3,7];case 6:throw o.numberOfRetries=Q,o;case 7:return[3,8];case 8:return[2,r]}}))}))}function Y(e,t,n,r,o){var i=e.ResourceUrls||[];if(0===i.length){var a=e.Resources?null==e?void 0:e.Resources["livepersonacard_with-react"]:"";"OwaPeopleHub"===e.Workload&&(a=e.Resources?e.Resources["livepersonacard_without-react"]:""),i=[e.Resources?e.Resources.livepersonacardstrings:"",a].filter((function(e){return""!==e}))}return Promise.all(i.map(()).then((function(){return i}))}var Z=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function ee(e,t){var n=this,r=t.targetWindow;return new Promise((function(i,a){setTimeout((function(){return function(e,t,n,r){return new(n||(n=Promise))((function(t,o){function i(e){try{s(r.next(e))}catch(e){o(e)}}function a(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(i,a)}s((r=r.apply(e,[])).next())}))}(n,0,void 0,(function(){var n,s;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),r||a(new o("StartLivePersonaCardError","targetWindow is undefined in startLivePersonaCardAsync")),r.LPC||a(new o("StartLivePersonaCardError","targetWindow.LPC is undefined., lpcWindowId:"+r.lpcWindowId)),r.LivePersonaCardStrings&&r.LivePersonaCardStrings.strings||r.LivePersonaCardStringsLpcMini&&r.LivePersonaCardStringsLpcMini.strings||a(new o("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined, lpcWindowId:"+r.lpcWindowId)),n=function(e,t){var n,r,o,i=t.targetWindow;return{accountId:t.accountId,refreshAuthToken:te(t.getAuthToken),contextType:t.clientContextType,strings:i.LivePersonaCardStringsLpcMini&&i.LivePersonaCardStringsLpcMini.strings||i.LivePersonaCardStrings&&i.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId&&d(t.clientCorrelationId)?t.clientCorrelationId:"00000000-0000-0000-0000-000000000000",activeFlights:e.Flights?Z([],e.Flights,!0):[],isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,setConfigurationManagerForTesting:t.setConfigurationManagerForTesting,lokiUrl:(null===(n=t.options)||void 0===n?void 0:n.lokiUrlOverride)||e.LokiUrl||"",lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId||"",userAadObjectId:e.UserAadObjectId||"",userPuid:e.UserPuid||"",ecsConfigIds:e.EcsConfigIds?Z([],e.EcsConfigIds,!0):[],ecsETag:e.EcsEtag||"",loggedInUserUpn:e.Upn||"",loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName||"",app:t.app,platform:t.platform,telemetryCollectorUrlAria:(null===(r=e.ClientTelemetryCollectorUrls)||void 0===r?void 0:r.Aria)||t.telemetryCollectorUrlAria,telemetryCollectorUrlOneDs:(null===(o=e.ClientTelemetryCollectorUrls)||void 0===o?void 0:o.OneDs)||t.telemetryCollectorUrlOneDs,versionOverride:t.versionOverride}}(e,t),[4,r.LPC.start(n)];case 1:return c.sent(),i(),[3,3];case 2:return s=c.sent(),a(new o("StartLivePersonaCardError",s.name)),[3,3];case 3:return[2]}}))}))}),0)}))}function te(e){return function(t){e((,(function(e,n){t("",e,n,void 0)}))}}function ne(e){switch(e.complianceEnvironment){case"Blackforest":return"e5ad760145754ffc9704e67c800087f2-accc9196-f40d-49fd-8968-2e6240e5d84c-7381";case"GccHigh":return"e5ad760145754ffc9704e67c800087f2-3831d322-8b62-464b-8147-272e41908150-7184";case"DoD":return"e5ad760145754ffc9704e67c800087f2-27405810-62d9-4796-a308-28b057a92523-6970";case"Gallatin":return"e5ad760145754ffc9704e67c800087f2-97d9a12c-35b6-4ec7-9bb9-d00d7b5d28d2-7079";case"AG08":case"AG09":return"";case"GccModerate":case"Prod":default:return"e5ad760145754ffc9704e67c800087f2-994e0432-dd0e-4a24-9a3d-bb9d8a6b83f3-7303"}}function re(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}var oe=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-start"))}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-end")),this.targetWindow.performance.measure(e,"".concat(e,"-start"),"".concat(e,"-end"));var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach((function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=Math.round(t.duration);-1!==n.indexOf("authtoken/loki")||-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?e.timings.Perf_AuthRequestDuration=r:-1!==n.indexOf("/lpc/versionless/livepersonacard_")?e.timings.Perf_LpcBundleRequestDuration=r:-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?e.timings.Perf_LpcStringsRequestDuration=r:-1!==n.indexOf("/api/v1/configuration/")&&(e.timings.Perf_InitConfigRequestDuration=r)}}))}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}(),ie=["Df","Msit","Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09","Unknown"],ae=["msit","df"];function se(e){return void 0===e||"string"!=typeof e||""===e||null===e}function ce(e){var t="";if(e){var n=[];se(e.culture)&&n.push("culture"),se(e.clientType)&&n.push("clientType"),se(e.clientContextType)&&n.push("clientContextType"),se(e.clientCorrelationId)&&n.push("clientCorrelationId"),function(e){return void 0===e||"function"!=typeof e}(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): ".concat(n.join(", "),". Check the values and types you're passing. ")),e.region&&-1===ae.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, "+"and ".concat(ae.join(", ")," for pre-production environments. ")),-1===ie.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: ".concat(ie.join(", "),". We currently don't support other Sovereign Clouds."))}else t="Config must be defined.";if(t)throw new o("ValidateBootstrapperConfigError",t)}var ue=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},le=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},fe=0;function de(e,t,n){return ue(this,void 0,void 0,(function(){var r,o;return le(this,(function(i){switch(i.label){case 0:return(o=X(t)).lpeConfig?(r=o.lpeConfig,[3,3]):[3,1];case 1:return[4,pe(e,t,n)];case 2:r=i.sent(),o.lpeConfig=r,i.label=3;case 3:return[2,r]}}))}))}function pe(e,t,n){return ue(this,void 0,void 0,(function(){var r,o;return le(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,I(e,t,n)];case 1:return r=i.sent(),[3,8];case 2:return(o=i.sent()).statusCode&&401===o.statusCode?[4,c(void 0,t.getAuthToken,n)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return fe<2?(fe++,[4,de(e,t,n)]):[3,6];case 5:return r=i.sent(),[3,7];case 6:throw o.numberOfRetries=fe,o;case 7:return[3,8];case 8:return[2,r]}}))}))}function ve(e,t){var n,r,o,i=e.Flights?[],e.Flights,!0):[],a=(null===(n=e.Resources)||void 0===n?void 0:n.livepersonaeditorstrings)||"",s=(null===(r=e.Resources)||void 0===r?void 0:r["livepersonaeditor_with-react"])||"",c=(null===(o=e.Resources)||void 0===o?void 0:o["livepersonaeditor_without-react"])||"",u=[a,i.indexOf("withreact")>-1?s:c].filter(();return Promise.all(u.map(()).then(()}var he=function(){return(he=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ge=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},me=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function ye(e){return ge(this,void 0,void 0,(function(){var t,n,o,i=this;return me(this,(function(a){return t=new oe(window),n=X(e),o=!n.forceRefreshLpeInitializationPromise&&n.lpeInitializationPromise||(n.lpeInitializationPromise=new Promise((function(n,r){return ge(i,void 0,void 0,(function(){var i,a,s,u,l,f;return me(this,(function(d){switch(d.label){case 0:i=ne(e),d.label=1;case 1:return d.trys.push([1,5,,6]),ce(e),t.startCustomTiming("Perf_GetAuthTokenDuration"),[4,c(e.authToken,e.getAuthToken,window)];case 2:return a=d.sent(),t.endCustomTiming("Perf_GetAuthTokenDuration"),t.measureFromStart("Perf_GetAuthTokenFromStartDuration"),t.startCustomTiming("Perf_GetLokiConfigDuration"),[4,de(a,e,window)];case 3:return s=d.sent(),t.endCustomTiming("Perf_GetLokiConfigDuration"),t.measureFromStart("Perf_GetLokiConfigFromStartDuration"),t.startCustomTiming("Perf_GetLpeBundlesDuration"),[4,ve(s,window)];case 4:return d.sent(),t.endCustomTiming("Perf_GetLpeBundlesDuration"),t.measureFromStart("Perf_GetLpeBundlesFromStartDuration"),o().updateContextWithLokiConfig(i,s),o().logEvent(i,{name:"initializeLivePersonaEditor_success",properties:he(he({},t.getAllTimings()),{RootCorrelationId:s.RootCorrelationId,isConsumer:"".concat(e.isConsumer)})}),n(s),[3,6];case 5:return u=d.sent(),l=u,f=t.getAllTimings(),o().logEvent(i,{name:"initializeLivePersonaEditor_failure",properties:he(he(he({},re(l)),f),{isConsumer:"".concat(e.isConsumer)})}),r("Failed to initialize Live Persona Editor: ".concat(l.name," ").concat(l.message)),[3,6];case 6:return[2]}}))}))})),n.lpeInitializationPromise.catch((function(){setTimeout((,r)}))),[2,n.lpeInitializationPromise]}))}))}var Ce=we=be=try{var Pe=window.document.createElement("link"),Le=Boolean("onmscontentzoom"in window.document);Pe.rel=Le?"dns-prefetch":"preconnect",Pe.href="https://res-1.cdn.office.net/",window.document.head.appendChild(Pe)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}function ke(e){return we(this,void 0,void 0,(function(){var t,n,o,i,a=this;return be(this,(function(s){return!(t=X(e)).forceRefreshInitializationPromise&&t.initializationPromise||(n=i=new oe(o=t.bootstrapperConfig.targetWindow),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise((function(r,s){return we(a,void 0,void 0,(function(){var a,u,l,f,d,p,v,h,g,m;return be(this,(function(y){switch(y.label){case 0:t.abandonInitializationPromise=function(){var t,r={name:"LPCInitializationAbandonmentError",message:"Live persona card initialization was abandoned",isExpected:!0},c=i.getAllTimings();null===(t=n())||void 0===t||t.logEvent(a,{name:"initializeLivePersonaCard_failure",properties:Ce(Ce(Ce({},re(r)),c),{isConsumer:"".concat(e.isConsumer),lpcWindowId:o.lpcWindowId})}),s("Failed to initialize Live Persona Card: ".concat(r.name," ").concat(r.message))},a=ne(e),y.label=1;case 1:return y.trys.push([1,6,,7]),ce(e),i.startCustomTiming("Perf_GetAuthTokenDuration"),[4,c(e.authToken,e.getAuthToken,o)];case 2:return u=y.sent(),i.endCustomTiming("Perf_GetAuthTokenDuration"),i.measureFromStart("Perf_GetAuthTokenFromStartDuration"),i.startCustomTiming("Perf_GetLokiConfigDuration"),[4,$(u,e,o)];case 3:return l=y.sent(),i.endCustomTiming("Perf_GetLokiConfigDuration"),i.measureFromStart("Perf_GetLokiConfigFromStartDuration"),i.startCustomTiming("Perf_GetLpcBundlesDuration"),null===(p=n())||void 0===p||p.updateContextWithLokiConfig(a,l),[4,Y(l,o,(function(e){var t;null===(t=n())||void 0===t||t.logVerboseEvent(a,e)}),null===(v=e.options)||void 0===v?void 0:v.isTrustedTypesEnabled,null===(h=e.options)||void 0===h?void 0:h.isReuseScriptsEnabled)];case 4:return y.sent(),i.endCustomTiming("Perf_GetLpcBundlesDuration"),i.measureFromStart("Perf_GetLpcBundlesFromStartDuration"),i.startCustomTiming("Perf_StartLpcDuration"),[4,ee(l,t.bootstrapperConfig)];case 5:return y.sent(),i.endCustomTiming("Perf_StartLpcDuration"),i.measureFromStart("Perf_StartLpcFromStartDuration"),null===(g=n())||void 0===g||g.logEvent(a,{name:"initializeLivePersonaCard_success",properties:Ce(Ce({},i.getAllTimings()),{RootCorrelationId:l.RootCorrelationId,isConsumer:"".concat(e.isConsumer),lpcWindowId:o.lpcWindowId})}),r(),[3,7];case 6:return f=y.sent(),d=i.getAllTimings(),null===(m=n())||void 0===m||m.logEvent(a,{name:"initializeLivePersonaCard_failure",properties:Ce(Ce(Ce({},re(f)),d),{isConsumer:"".concat(e.isConsumer),lpcWindowId:o.lpcWindowId})}),s("Failed to initialize Live Persona Card: ".concat(f.name," ").concat(f.message)),[3,7];case 7:return t.abandonInitializationPromise=void 0,[2]}}))}))})),t.initializationPromise.catch((function(){t.forceRefreshInitializationTimeout=window.setTimeout((,r)}))),[2,t.initializationPromise]}))}))}function Te(e){!function(e){var t,n,r=V.get(e);if(r){var o=r.bootstrapperConfig.targetWindow,i=null===(t=r.bootstrapperConfig.options)||void 0===t?void 0:t.isReuseScriptsEnabled;if(o&&(o.LPC&&o.LPC.cleanUp&&o.LPC.cleanUp(),!i)){delete o.LPC,delete o.LivePersonaCardHoverTarget,delete o.LivePersonaCardHoverTargetV2,delete o.LivePersonaCardStrings,delete o.LivePersonaCardStringsLpcMini,delete o.MeetingInsightsV2,delete o.MidgardBootstrapper,delete o.PersonaInsightRing,delete o.LPE,delete o.lpcWindowId;try{o.document.querySelectorAll("script[".concat(H,"]")).forEach(()}catch(e){console.warn("midgard-bootstrapper:deleteBootstrapperInstance(): Failed removing one or more script tags")}}null===(n=r.abandonInitializationPromise)||void 0===n||n.call(r),delete r.bootstrapperConfig.targetWindow,delete r.oneDsLogger,delete r.bootstrapperConfig,delete r.initializationPromise,delete r.abandonInitializationPromise,clearTimeout(r.forceRefreshInitializationTimeout)}V.delete(e)}(e)}function Ie(e){return we(this,void 0,void 0,(function(){var t;return be(this,(function(n){switch(n.label){case 0:return t=X(e),[4,c(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,$(n.sent(),e,t.bootstrapperConfig.targetWindow)]}}))}))}},fw7a:ifxd:"rlv/":uiL9:]);
//# sourceMappingURL=vendors~midgard-bootstrapper.060daebf64f406e8b416.chunk.v7.js.map