!function(){var Y="vast",Z="-1",t="time",d="[ERRORCODE]",E="vmap",ee=5e3,te=15e3,ie="jwp",re="jwpspotx",ne="autostartNotAllowed",se="viewable",ae=5,l="paused",oe="playing",de="adPodError",r="viewable",le="adBidRequest",ue="adBidResponse",he="adBreakEnd",n="adBreakIgnored",pe="adBreakStart",s="adClick",ce="adComplete",me="adError",fe="adImpression",ve="adLoaded",u="adMeta",o="adPause",h="adPlay",ye="adRequest",ge="adSchedule",Ae="adSkipped",e="adStarted",p="clickthrough",Pe="external",i=Pe,a="click",c="play",m="error",f="complete",v=[fe,me,de],y=[e,ce,fe,s,Ae,me,h,o,u],g=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},A=function(){function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}}(),ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},P=function(){function a(e,t,i,r,n){var s=this;g(this,a),this.player=e,this.state=e.state,this.vpaidURL=i,this.adTag=r,this.adParams=n.adParams,this.vpaidControls=n.vpaidControls,this.remainingTimeInterval=null,this.type="vpaid",this.instream=t||e.createInstream(),this.vpaidState={linear:!1,expanded:!1,remainingTime:-1},this.paused=!1,ke(this,e.Events),this.setMuteCallback=function(){s.handleMute?s.setMute():s.handleMute=!0},this.playerContainer=this.player.getContainer(),n.adOptOut?setTimeout(function(){s.sendEvent("error",{message:"Conditional ad rejected",code:408})},0):this.iframe=function(e,t,i,r){var n=document.createElement("iframe");n.setAttribute("gesture","media"),n.setAttribute("allow","autoplay"),n.src="javascript:false",e.style(n,{border:0,width:"100%",height:"100%",position:"absolute",overflow:"hidden"}),n.scrolling="no",i.querySelector(".jw-media").appendChild(n);var s=n.contentWindow.document;return s.open().write("\n    <body onload=\"\n        var js = document.createElement('script');\n        js.src = '"+t+"';\n        js.addEventListener('load', function() { window.myCallback(); });\n        document.body.appendChild(js);\"\n    style=\"margin: 0\">"),n.contentWindow.myCallback=r,s.close(),n}(e.utils,this.vpaidURL,this.playerContainer,this.callback.bind(this))}return a.prototype.sendEvent=function(e,t){(t=t||{}).tag||(t.tag=this.adTag),this.trigger(e,t)},a.prototype.sendTimeEvent=function(e,t,i){var r=t.getAdDuration(),n=t.getAdRemainingTime(),s=ke({duration:r},i);this.sendEvent(e,s),0<n&&(s.position=r-n,this.trigger("time",s))},a.prototype.handleQuartile=function(e,t){this.sendTimeEvent("quartile",e,{quartile:t})},a.prototype.genEvent=function(t){var i=this;return function(e){i.on(t,e)}},a.prototype.setMute=function(){var e=0===this.vpaidAd.getAdVolume();this.player.getMute()!==e&&this.player.setMute(e)},a.prototype.userActive=function(){var e=this.player.utils.hasClass(this.playerContainer,"jw-flag-time-slider-above");this.player.utils.style(this.iframe,{bottom:e?66:60})},a.prototype.userInactive=function(){"paused"!==this.player.getState()&&this.player.utils.style(this.iframe,{bottom:"0.5em"})},a.prototype.prepareNonlinearAd=function(){var e=!this.player.utils.hasClass(this.playerContainer,"jw-flag-user-inactive");if(this.player.utils.style(this.iframe,{height:150}),this.resize(null,150),this.userActive(e),this.player.on("userActive",this.userActive,this),this.player.on("userInactive",this.userInactive,this),this.instream){this.instream.noResume=!0,this.instream.applyProviderListeners(null),this.instream.destroy(),this.instream=null;var t=this.playerContainer.querySelector(".jw-media"),i=t.querySelector("video,audio");t.insertBefore(i,this.iframe),i.play()}},a.prototype.progressInterval=function(t){var i=this;if(clearInterval(this.remainingTimeInterval),t&&t.getAdRemainingTime){var r=-1;this.remainingTimeInterval=setInterval(function(){var e=t.getAdRemainingTime();isNaN(e)||e<=0||r===e||(r=e,i.sendTimeEvent("remainingTimeChange",t,{remainingTime:e}))},250)}},a.prototype.genListeners=function(e){var r=this;return{AdLoaded:function(){e.setAdVolume(r.getPlayerVolume()),e.startAd()},AdStarted:function(){e.getAdLinear()?r.vpaidControls?r.progressInterval(e):(r.instream=r.instream||r.player.createInstream(),r.instream.hide()):r.prepareNonlinearAd(),r.sendEvent("impression",{linear:e.getAdLinear()?"linear":"nonlinear"}),r.sendEvent("play",{oldstate:"buffering",newstate:oe,linear:e.getAdLinear()?"linear":"nonlinear"}),r.handleMute=!0,e.subscribe(r.setMuteCallback,"AdVolumeChange",e)},AdVideoStart:function(){r.sendEvent("started")},AdStopped:function(){r.sendEvent("stopped")},AdPaused:function(){r.paused||(r.paused=!0,r.sendEvent("pause",{newstate:l,oldstate:oe}))},AdPlaying:function(){r.paused&&(r.paused=!1,r.sendEvent("play",{newstate:oe,oldstate:l,linear:e.getAdLinear()?"linear":"nonlinear"}))},AdLinearChange:function(){e.getAdLinear()?(r.player.utils.style(r.iframe,{height:"100%"}),r.player.off(null,null,r),r.instream=r.instream||r.player.createInstream(),r.instream.init(),r.vpaidControls||r.instream.hide()):r.prepareNonlinearAd()},AdDurationChange:function(){r.sendTimeEvent("remainingTimeChange",e,{isDurationChange:!0,remainingTime:e.getAdRemainingTime()})},AdRemainingTimeChange:function(){r.sendTimeEvent("remainingTimeChange",e,{remainingTime:e.getAdRemainingTime()})},AdExpandedChange:function(){r.sendEvent("expandedChange",{expanded:e.getAdExpanded()})},AdSkipped:function(){r.sendEvent("skipped")},AdVideoFirstQuartile:function(){r.handleQuartile(e,1)},AdVideoMidpoint:function(){r.handleQuartile(e,2)},AdVideoThirdQuartile:function(){r.handleQuartile(e,3)},AdVideoComplete:function(){r.sendEvent("complete")},AdUserClose:function(){r.sendEvent("close")},AdClickThru:function(e,t,i){r.sendEvent("click",{id:t,url:e,playerHandles:i})},AdError:function(e){var t=function(e){if(e){var t=e.match(/\b(?:[34])[0-9]{2}\b/);if(t)return parseInt(t[0],10);if(e.match(/timeout/i))return e.match(/vpaid|vast/i)?301:402;if(e.match(/found/i))return 401;if(e.match(/supported/i))return 403;if(e.match(/(?:displaying|media file)/i))return 405}return 901}(e);r.sendEvent("error",{message:e,code:t,adErrorCode:5e4+t})}}},a.prototype.callback=function(){var t=this.vpaidAd=this.iframe.contentWindow.getVPAIDAd(),e=t.handshakeVersion("2.0");if(parseFloat(e)<1)throw new Error("Invalid vpaid version in handshake");var i=this.genListeners(t);Object.keys(i).forEach(function(e){t.subscribe(i[e],e,t)}),this.listeners=i;var r={AdParameters:this.adParams},n=this.playerContainer.querySelector(".jw-media"),s=this.instream.getMediaElement(),a=this.iframe.contentWindow.document.createElement("div");a.className="jw-vpaid-wrapper",a.style.height="100%",this.iframe.contentWindow.document.body.appendChild(a);var o={videoSlot:s,slot:a};t.initAd(n.clientWidth,n.clientHeight,"normal",1e3,r,o),t.setAdVolume(this.getPlayerVolume())},a.prototype.play=function(){this.vpaidAd.resumeAd()},a.prototype.pause=function(){this.vpaidAd.pauseAd()},a.prototype.stop=function(){if(this.vpaidAd)try{this.vpaidAd.stopAd()}catch(e){}},a.prototype.getPlayerVolume=function(){return this.player.getMute()?0:this.player.getVolume()/100},a.prototype.setVolume=function(e){this.handleMute=!1,this.vpaidAd.setAdVolume(e/100)},a.prototype.resize=function(e,t){if(this.vpaidAd&&this.vpaidAd.resizeAd){var i=this.player.getFullscreen()||document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen?"fullscreen":"normal";this.vpaidAd.resizeAd(e||this.player.getWidth(),t||this.player.getHeight(),i)}},a.prototype.destroy=function(){if(this.removeEvents(),clearInterval(this.remainingTimeInterval),this.vpaidAd)try{var t=this.listeners,i=this.vpaidAd;Object.keys(t).forEach(function(e){i.unsubscribe(t[e],e,i)}),i.unsubscribe(this.setMuteCallback,"AdVolumeChange",i)}catch(e){}this.iframe&&this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),this.vpaidAd=null,this.player=null,this.instream=null},a.prototype.removeEvents=function(){this.player&&this.player.off(null,null,this),this.off()},a.prototype.attachMedia=function(){},a.prototype.detachMedia=function(){},a.prototype.volume=function(){},a.prototype.mute=function(){},a.prototype.getState=function(){return this.vpaidState.linear?this.paused?l:oe:"idle"},a}();var be={},k=[];var b=function(){function o(e,t,i,r){var n=this;g(this,o);var s,a=e||{};this.map=a,this.debugTrackFn=t,this.trackerPlayerUtils=(s=i,{getPosition:function(){return s.getPosition()},getFile:function(){return s.getPlaylistItem().file}}),this.trackingFilter=r,this.lastQuartile=0,this.progressEvents=[],this.breakStarted=!1,this.started=!1,this.firedError=!1,this.hasComp=!1,be._.map(a,function(e,t){if(a.hasOwnProperty(t)&&0===t.indexOf("progress")){var i=""+t.split("_")[1],r={key:t,offset:i,tracked:!1,percentage:!1};/^\d+%$/.test(i)?(r.percentage=!0,r.offset=parseFloat(i)):r.offset=be.utils.seconds(i),n.progressEvents.push(r)}}),this.setFactories()}return o.prototype.getUrls=function(e){return this.map.hasOwnProperty(e)?this.map[e]:[]},o.prototype.addUrl=function(e,t){this.map.hasOwnProperty(e)||(this.map[e]=[]),this.map[e].push(t)},o.prototype.trackPings=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=this.getUrls(e),r=this.trackingFilter,n=[],s=[],a=[];if(i.length){t=this.replaceMacros(t),i.forEach(function(i){if(i){if(be._.each(t,function(e,t){i=i.replace(t,e)}),r&&!1===r(i))return void s.push(i);var e=new Image;e.src=i,n.push(i),a.push(e)}}),Array.prototype.push.apply(k,a);for(var o=k.length;o--&&(k[o].width||k[o].complete);)k.length=o}"function"==typeof this.debugTrackFn&&this.debugTrackFn({type:"ping",data:{pingType:e,urls:n,filteredUrls:s,images:a}})},o.prototype.replaceMacros=function(e){var t,i,r,n,s,a,o;return e["[TIMESTAMP]"]=encodeURIComponent((t=new Date,i=t.getTime(),r=t.getTimezoneOffset()/60,n=6e4*t.getTimezoneOffset(),new Date(i-n).toISOString().slice(0,-1)+(0<r?"-":"+")+("0"+r).slice(-2))),e["[CACHEBUSTING]"]=Math.random().toString().slice(2,10),e["[ASSETURI]"]=encodeURIComponent(this.trackerPlayerUtils.getFile()),e["[CONTENTPLAYHEAD]"]=encodeURIComponent((s=this.trackerPlayerUtils.getPosition(),a=("0"+Math.floor(s/3600)).slice(-2),o=("0"+Math.floor((s-3600*a)/60)).slice(-2),a+":"+o+":"+("0"+Math.floor(s-3600*a-60*o)).slice(-2)+"."+(s%1).toFixed(3).toString().slice(2,5))),e},o.prototype.start=function(){this.started=!0,this.trackPings("start")},o.prototype.breakStart=function(){this.breakStarted=!0,this.trackPings("breakStart")},o.prototype.time=function(e,t){if(!(t<=1)){for(var i=(4*e+.05)/t|0;i>this.lastQuartile&&this.lastQuartile<3;)this.lastQuartile++,1===this.lastQuartile?this.trackPings("firstQuartile"):2===this.lastQuartile?this.trackPings("midpoint"):3===this.lastQuartile&&this.trackPings("thirdQuartile");this.trackProgress(e,t)}},o.prototype.trackProgress=function(e,t){for(var i=this.progressEvents.length;i--;){var r=this.progressEvents[i];if(!r.tracked){var n=r.offset;r.percentage&&(n=t*n/100),n<=e&&(r.tracked=!0,this.trackPings(r.key))}}},o.prototype.error=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:900;this.firedError=!0;var t={};t[d]=e,this.trackPings("error",t)},o.prototype.factory=function(e){var t=this;return function(){t.trackPings(e)}},o.prototype.setFactories=function(){this.creativeView=this.factory("creativeView"),this.click=this.factory("click"),this.skip=this.factory("skip"),this.complete=this.factory("complete"),this.pause=this.factory("pause"),this.resume=this.factory("resume"),this.mute=this.factory("mute"),this.unmute=this.factory("unmute"),this.fullscreen=this.factory("fullscreen"),this.expand=this.factory("expand"),this.collapse=this.factory("collapse"),this.acceptInvitation=this.factory("acceptInvitation"),this.close=this.factory("close"),this.rewind=this.factory("rewind"),this.impression=this.factory("impression"),this.breakEnd=this.factory("breakEnd")},o}();function we(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:900,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:60900,r={};return r.message=e,r.code=t,r.adErrorCode=i,r}function _e(e){return new Array(e+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,e)}function w(e,t){e.wrappedTags&&(t.wrapperAdSystem=e.wrapper||"",t.tag=e.wrappedTags.pop(),t.wrappedTags=e.wrappedTags),t.adsystem=e.adsystem||""}function Te(e,t,i){var r=e.vmap?e.vmap:e.adschedule||e.adbreak;if(r&&i[r.breakid]){var n=i[r.breakid],s=n.bid.getEventObject(Y,n.bidders,e);e.mediationLayerAdServer=s.mediationLayerAdServer,e.bidders=s.bidders,s.floorPriceCents&&(e.floorPriceCents=s.floorPriceCents)}return e}var Ie=function(){function a(e,t,i,r,n,s){g(this,a),this.player=t,this.staticPlayer=i,this.companion=r,this.playlistItemManager=n,this.optionalParams=s,this.debugTrackFn=s.debugTrackFn,this.scheduledAd=e.scheduledAd(),this.vastBuffet=e.adBuffet(),this.vastAdPod=e.adPod(),this.vastAd=this.vastBuffet.length?this.vastBuffet[0]:null,this.adType=null,this.vpaidPlayer=null,this.instreamPlayer=null,this.blockingInstreamPlayer=null,this.mediaType=null,this.adPodItems=null,this.creativeTimeout=null,this.vastOptions=null,this.duration=0,this.position=0,this.adPodIndex=0,this.initialIndex=0,this.viewablePlayedTime=0,this.adViewableImpressionHandler=t.utils.noop,this.lastPosition=null,this.reason=null,ke(this,t.Events)}return a.prototype.init=function(e,t){return this.init=function(){throw new Error("Adplayer can only be initialized once")},this.blockingInstreamPlayer=e,this.reason=t,!!this.prepareAdPod()&&(this.player.on("fullscreen",this.playerFullscreenHandler,this),this.player.on("volume",this.playerVolumeHandler,this),this.player.on("mute",this.muteHandler,this),this.player.on("resize",this.playerResizeHandler,this),this.playAd())},a.prototype.prepareAdPod=function(){var t=this,e=null,i=0,r=[];if(this.vastAd&&(C(this.vastAd,this.debugTrackFn,this.player,this.optionalParams.trackingFilter),(e=this.prepareAdPodItem(this.vastAd))&&"vpaid"===e.adType&&!S(this.vastAd)&&(e=null)),this.vastAdPod)for(var n=null,s=0;s<this.vastAdPod.length;s++){var a=this.vastAdPod[s];C(a,this.debugTrackFn,this.player,this.optionalParams.trackingFilter);var o=this.prepareAdPodItem(a);if(o){if(n!==o.adType&&"instream"===n)break;if(n=o.adType,"vpaid"!==o.adType||S(a)){var d=r.length+i===s;o&&d&&r.push(o)}else i++}else i++}if(!r.length&&!e)return this.adError("No Compatible Creatives",403),!1;var l=void 0;return r.length?(l=r,this.vastOptions=[],l.forEach(function(e){t.vastOptions.push(t.getInstreamOptions(e.vastAd))})):(l=e,this.vastOptions=this.getInstreamOptions(this.vastAd)),this.adPodItems=l,!(this.adPodIndex=0)},a.prototype.prepareAdPodItem=function(e){e.tracker.linear="linear";var t=(""+e.media[0].adType).toLowerCase()||"instream";"vpaid"!==t||S(e)||(t="instream");var i={vastAd:e,sources:[],adType:t};this.scheduledAd.skipoffset&&(i.skipoffset=this.scheduledAd.skipoffset);var r,n,s=e.media,a={};if(be._.each(s,function(e){i.sources.push({file:e.file,mimeType:e.type,type:(""+e.type).replace(/^(?:video|audio)\/(?:x-)?/,"")}),a[e.file]={width:e.width||0,height:e.height||0}}),"instream"===t&&(i.sources=(r=i.sources,n=void 0,n=jwplayer.api.availableProviders.filter(function(e){return"flash"!==e.name}),r.filter(function(t){return n.some(function(e){return e.supports(t)})}))),0===i.sources.length)return null;this.mediaType=(""+i.sources[0].mimeType).toLowerCase(),i.vastAd.selectedMedia=i.sources[0];var o=this.player.getSafeRegion(!0),d=null,l=null;return i.sources.forEach(function(e){var t=a[e.file];t.width<=o.width&&(!d||t.width>a[d.file].width)&&(d=e),t.width>=o.width&&(!l||t.width<a[l.file].width)&&(l=e)}),d?(i.vastAd.selectedMedia=d).default=!0:l&&((i.vastAd.selectedMedia=l).default=!0),i},a.prototype.getInstreamOptions=function(e){var t=0<=this.optionalParams.skipoffset?this.optionalParams.skipoffset:null;return{skipoffset:e.skipoffset||this.scheduledAd.skipoffset||t,skipMessage:this.optionalParams.skipMessage,skipText:this.optionalParams.skipText}},a.prototype.getVastAd=function(e){if(this.adPodItems){var t=void 0;if((t=this.adPodItems.length?this.adPodItems[e]:this.adPodItems).vastAd)return t.vastAd}else if(this.vastAdPod&&this.vastAdPod.length)return this.vastAdPod[e];return this.vastAd},a.prototype.adError=function(e,t,i){clearTimeout(this.creativeTimeout);var r=this.getVastAd(this.adPodIndex),n=we(e,t,i=i||(t?1e4+t:null));(n.creativeId=r.creativeId||"",_(r,n),T(r,n),this.vastAdPod&&this.adPodIndex<this.vastAdPod.length-1)?this.triggerEvent("adPodError",n):(r.tracker.error(n.code),w(r,n),this.addConditionalAdData(n),this.triggerEvent(me,n))},a.prototype.playAd=function(){var e=this.adPodItems[this.adPodIndex]||this.adPodItems;if(this.adType=e.adType,this.blockingInstreamPlayer){var t=this.optionalParams.loadingAd;this.blockingInstreamPlayer.setText(t)}if("vpaid"===this.adType)return this.playVpaid(e.vastAd);if("static"===this.adType)return this.playStatic(),!0;var i=Array.isArray(this.adPodItems)?this.adPodItems.slice(this.adPodIndex):this.adPodItems,r=Array.isArray(this.vastOptions)?this.vastOptions.slice(this.adPodIndex):this.vastOptions;return this.initialIndex=this.adPodIndex,this.playInstream(i,r)},a.prototype.clearVpaidBlocking=function(){if(this.vpaidPlayer.instream){var e=this.vpaidPlayer.instream;this.vpaidPlayer.instream=null,this.clearBlocking(e)}},a.prototype.clearBlocking=function(e){(e=e||this.blockingInstreamPlayer)&&e!==this.instreamPlayer&&e.destroy()},a.prototype.getState=function(){return this.instreamPlayer?this.instreamPlayer.getState():this.vpaidPlayer?this.vpaidPlayer.getState():""},a.prototype.clearNonlinear=function(){this.staticPlayer.stop(),this.vpaidPlayer&&(this.clearVpaidBlocking(),this.vpaidPlayer&&(this.vpaidPlayer.stop(),this.vpaidPlayer.destroy(),this.vpaidPlayer=null))},a.prototype.destroy=function(){if(clearTimeout(this.creativeTimeout),this.off(),this.removePlayerListeners(),clearTimeout(this.creativeTimeout),this.instreamPlayer){var e=this.instreamPlayer;this.instreamPlayer=null,this.clearBlocking(e)}this.vpaidPlayer&&(this.clearVpaidBlocking(),this.vpaidPlayer&&(this.vpaidPlayer.destroy(),this.vpaidPlayer=null)),this.clearNonlinear(),this.player=null,this.instreamPlayer=null,this.scheduledAd=null,this.vastBuffet=null,this.vastAd=null,this.vastAdPod=null},a.prototype.pause=function(e){var t=e.reason;this.reason=t||Pe,this.instreamPlayer?this.instreamPlayer.pause():this.vpaidPlayer&&this.vpaidPlayer.pause()},a.prototype.play=function(e){var t=e.reason;this.reason=t||Pe,this.instreamPlayer?this.instreamPlayer.play():this.vpaidPlayer&&this.vpaidPlayer.play()},a.prototype.removePlayerListeners=function(){this.player&&(this.player.off("fullscreen",this.playerFullscreenHandler,this),this.player.off("volume",this.playerVolumeHandler,this),this.player.off("mute",this.muteHandler,this),this.player.off(r,this.viewableHandler,this)),this.instreamPlayer&&this.instreamPlayer.off(null,null,this),this.vpaidPlayer&&(this.vpaidPlayer.removeEvents(),this.clearVpaidBlocking(),this.vpaidPlayer&&(this.vpaidPlayer.destroy(),this.vpaidPlayer=null)),this.staticPlayer.stop(),this.staticPlayer.removeEvents()},a.prototype.adEventObject=function(e){var t=this.playlistItemManager.getAdEventObject(this.scheduledAd);if(t.viewable=this.player.getViewable(),this.adPodItems&&this.adPodItems.length&&(t.sequence=this.adPodIndex+1,t.podcount=this.adPodItems.length),this.mediaType&&(t.creativetype=this.mediaType),this.scheduledAd._vmap&&(t.vmap=this.scheduledAd._vmap),-1!==y.indexOf(e)){var i=this.getVastAd(this.adPodIndex);t.universalAdIdRegistry=i.universalAdIdRegistry,t.universalAdIdValue=i.universalAdIdValue,t.categories=i.categories}return t},a.prototype.playStatic=function(){this.vastAd.tracker.linear="nonlinear";var e=this.vastAd.media[0];this.vastAd.selectedMedia=e;var t=this.vastAd.clickthrough||"",i=this.staticPlayer;i.removeEvents(),i.on("play",this.impressionHandler,this),i.on("play",this.playHandler,this),i.on("complete",this.combinedCompleteHandler,this),i.on("click",this.clickStaticHandler,this),i.on("error",this.staticErrorHandler,this),this.playlistItemManager.addStaticOffset(this.scheduledAd._offSet),i.playAd(e.file,t,e.minDuration,this.scheduledAd._currentTag,this.scheduledAd.requestTimeout),this.clearBlocking()},a.prototype.creativeAdError=function(e,t,i){this.adError(e,t,i),this.adPodItems&&this.adPodItems.length-1>this.adPodIndex&&(this.vpaidPlayer&&(this.vpaidPlayer.destroy(),this.vpaidPlayer=null),this.adPodIndex++,this.scheduledAd._adPodIndex=this.adPodIndex,this.playAd())},a.prototype.playVpaid=function(e){var t=this;clearTimeout(this.creativeTimeout),this.creativeTimeout=setTimeout(function(){t.creativeAdError("VPAID tag communication timeout",900,50004)},this.scheduledAd.creativeTimeout);var i=S(this.vastAd=e),r=this.optionalParams.conditionaladoptout&&e.conditionalAd;if(this.vastAd.selectedMedia=i,this.mediaType=i.type,"flash"===I(i))return this.creativeAdError("Flash creatives are not supported",403,10403),!1;var n={adParams:this.vastAd.adParams,vpaidControls:this.optionalParams.vpaidcontrols,adOptOut:r};return this.vpaidPlayer=new P(this.player,this.blockingInstreamPlayer,i.file,this.scheduledAd._currentTag,n),this.blockingInstreamPlayer&&this.blockingInstreamPlayer.applyProviderListeners(this.vpaidPlayer),this.vpaidPlayer.on("play",this.playHandler,this),this.vpaidPlayer.on("pause",this.pauseHandler,this),this.vpaidPlayer.on("quartile",this.quartileHandler,this),this.vpaidPlayer.on("remainingTimeChange",this.remainingTimeHandler,this),this.vpaidPlayer.on("click",this.clickVpaidHandler,this),this.vpaidPlayer.on("error",this.playbackErrorHandler,this),this.vpaidPlayer.on("impression",this.impressionHandler,this),this.vpaidPlayer.on("expandedChange",this.vpaidExpandedHandler,this),this.vpaidPlayer.on("close",this.adCloseHandler,this),this.vpaidPlayer.on("skipped",this.vpaidAdSkipped,this),this.vpaidPlayer.on("stopped",this.endOfVpaidAdHandler,this),this.vpaidPlayer.on("complete",this.adCompleteHandler,this),this.vpaidPlayer.on("started",this.adStartedHandler,this),this.setupSkipButton(e),!0},a.prototype.setupSkipButton=function(e){var t="skipoffset"in e?be.utils.seconds(e.skipoffset):-1,i=0<=this.optionalParams.skipoffset?this.optionalParams.skipoffset:t;0<=i&&this.blockingInstreamPlayer&&(this.blockingInstreamPlayer.off(Ae,this.skipVpaidAd,this),this.blockingInstreamPlayer.setupSkipButton(i,this.optionalParams,be.utils.noop),this.blockingInstreamPlayer.on(Ae,this.skipVpaidAd,this))},a.prototype.playInstream=function(e,t){var i=this,r=this.player.getEnvironment().OS;return r.android&&2===r.version.major&&3===r.version.minor?(this.adError("Android 2.3 not supported",900,60007),!1):(clearTimeout(this.creativeTimeout),this.creativeTimeout=setTimeout(function(){i.creativeAdError("VAST tag communication timeout",900,60004)},this.scheduledAd.creativeTimeout),this.blockingInstreamPlayer?this.instreamPlayer=this.blockingInstreamPlayer:this.instreamPlayer=this.player.createInstream().init(),this.instreamPlayer.on("play",this.playHandler,this),this.instreamPlayer.on("pause",this.pauseHandler,this),this.instreamPlayer.on("time",this.timeHandler,this),this.instreamPlayer.on("playlistItem",this.playlistItemHandler,this),this.instreamPlayer.on("complete",this.adCompleteHandler,this),this.instreamPlayer.on("playlistComplete",this.endOfAdBreakHandler,this),this.instreamPlayer.on("mute",this.muteHandler,this),this.instreamPlayer.on("instreamClick",this.clickInstreamHandler,this),this.instreamPlayer.on("adSkipped",this.adSkipped,this),this.instreamPlayer.on("error",this.playbackErrorHandler,this),this.instreamPlayer.on("mediaError",this.playbackErrorHandler,this),this.instreamPlayer.on("destroyed",function(){i.instreamPlayer=null},this),this.instreamPlayer.loadItem(e,t),this.clearBlocking(),!0)},a.prototype.playerFullscreenHandler=function(e){var t=this.getVastAd(this.adPodIndex).tracker;e.fullscreen&&t.started&&t.fullscreen()},a.prototype.playerResizeHandler=function(e){this.vpaidPlayer&&this.vpaidPlayer.resize(e.width,e.height)},a.prototype.playerVolumeHandler=function(e){this.vpaidPlayer&&this.vpaidPlayer.setVolume(e.volume)},a.prototype.playlistItemHandler=function(e){this.instreamPlayer&&(this.scheduledAd._adPodIndex=this.adPodIndex=e.index+this.initialIndex)},a.prototype.impressionHandler=function(e){var t=this.getVastAd(this.adPodIndex),i=t.tracker;i.impression();var r={};r.adposition=this.scheduledAd._position||"",r.adtitle=t.adTitle||"",r.creativeId=t.creativeId||"",w(t,r),r.vastversion=t.vastversion,r.clickThroughUrl=t.clickthrough,r.duration=t.duration||0,r.mediafile={file:t.selectedMedia.file},r.linear=e.linear||i.linear,this.addConditionalAdData(r),_(t,r),T(t,r),this.triggerEvent(fe,r),this.setupViewableListener()},a.prototype.setupViewableListener=function(){this.player.off(r,this.viewableHandler,this),this.player.on(r,this.viewableHandler,this),this.viewableHandler({viewable:this.player.getViewable()})},a.prototype.viewableHandler=function(e){e.viewable?(this.viewablePlayedTime=0,this.lastPosition=null,this.adViewableImpressionHandler=this.adViewableHandler):this.adViewableImpressionHandler=this.player.utils.noop},a.prototype.playHandler=function(e){clearTimeout(this.creativeTimeout);var t,i,r=this.getVastAd(this.adPodIndex),n=r.tracker,s=void 0;if(n.started)e.oldstate===l&&(n.resume(),this.dispatchPlay(e));else{this.vpaidPlayer&&(n.linear=e.linear),this.instreamPlayer&&this.impressionHandler({linear:n.linear});var a=ke({linear:n.linear},this.getInstreamOptions(r));a.adMessage=this.optionalParams.dynamicMessage||"",a.clickThroughUrl=r.clickthrough,a.sequence&&(a.podMessage=this.optionalParams.podMessage||""),r.adTitle&&(a.adtitle=r.adTitle),r.companions&&(a.companions=r.companions),T(r,a),this.triggerEvent(u,a),r.companions&&((s={}).companions=(i=r.companions,be._.map(i,function(e){var t="iframe"===e.type||"html"===e.type?e.type:"static",i=void 0;return e.trackers&&e.trackers.creativeView&&e.trackers.creativeView.length&&(i=e.trackers.creativeView),{width:e.width,height:e.height,type:t,resource:e.source,creativeview:i,click:e.clickthrough}})),s.universalAdIdRegistry=r.companionUniversalAdIdRegistry,s.universalAdIdValue=r.companionUniversalAdIdValue,this.triggerEvent("adCompanions",s));var o=this.companion,d=void 0;9<be.utils.flashVersion()?d=r.companions:(t=r.companions,d=be._.filter(t,function(e){return e.type.indexOf("flash")<0})),this.optionalParams.companion&&d&&d.length&&(n.hasComp=o.addCompanion(this.optionalParams.companion,d)),n.start(),n.creativeView(),this.dispatchPlay(e)}},a.prototype.dispatchPlay=function(e){"static"===this.adType||"vpaid"===this.adType&&"linear"!==e.linear||(null===this.reason&&"vpaid"===this.adType&&(this.reason=i),this.setState(e))},a.prototype.pauseHandler=function(e){clearTimeout(this.creativeTimeout),this.getVastAd(this.adPodIndex).tracker.pause(),null===this.reason&&"vpaid"===this.adType&&(this.reason=i),this.setState(e)},a.prototype.setState=function(e){var t=e.newstate,i=t===oe,r=this.adEventObject(i?h:o);(r.newstate=t,null!==this.reason)&&(r[i?"playReason":"pauseReason"]=this.reason,this.reason=null);this.vpaidPlayer?this.vpaidPlayer.trigger("state",r):this.instreamPlayer.setEventData(r)},a.prototype.remainingTimeHandler=function(e){e.duration?this.duration=e.duration:this.duration=Math.max(1,this.duration,e.remainingTime);var t=0<=e.remainingTime?this.duration-e.remainingTime:0;this.timeHandler({position:t,duration:this.duration,isDurationChange:e.isDurationChange})},a.prototype.quartileHandler=function(e){if(e.duration)this.duration=e.duration;else{var t=4*e.remainingTime/(4-e.quartile);this.duration=Math.max(this.duration,1,t)}this.timeHandler({position:this.duration*e.quartile*.25,duration:this.duration})},a.prototype.adViewableHandler=function(e){var t=e.position;null===this.lastPosition&&(this.lastPosition=t);var i=t-this.lastPosition;this.lastPosition=t,i=Math.min(Math.max(0,i),4),this.viewablePlayedTime+=i,2<=this.viewablePlayedTime&&(this.player.off(r,this.viewableHandler,this),this.adViewableImpressionHandler=this.player.utils.noop,this.triggerEvent("adViewableImpression",{}))},a.prototype.timeHandler=function(e){var t=this.getVastAd(this.adPodIndex),i=e.position,r=e.duration;this.adViewableImpressionHandler(e);var n=r-i,s=t.tracker,a=this.optionalParams.dynamicMessage||"",o=this.optionalParams.podMessage||"";if(a&&0<n){if(a=a.replace(/(\b)xx(s?\b)/gi,"$1"+Math.ceil(n)+"$2"),this.adPodItems&&1<this.adPodItems.length&&o){var d=this.adPodIndex+1;a=(o=(o=o.replace(/__AD_POD_CURRENT__/g,""+d)).replace(/__AD_POD_LENGTH__/g,""+this.adPodItems.length))+" "+a}this.instreamPlayer?this.instreamPlayer.setText(a):this.vpaidPlayer&&this.vpaidPlayer.instream&&this.vpaidPlayer.instream.setText(a)}if(!e.isDurationChange){s&&s.time(i,r);var l={};l.position=this.position=i,l.duration=r,this.triggerEvent("adTime",l)}},a.prototype.combinedCompleteHandler=function(){this.adCompleteHandler(),this.endOfAdBreakHandler()},a.prototype.adCompleteHandler=function(){clearTimeout(this.viewableTimeout);var e=this.getVastAd(this.adPodIndex).tracker;e.firedError||(e.complete(),this.triggerEvent(ce))},a.prototype.adCloseHandler=function(){clearTimeout(this.viewableTimeout);var e=this.getVastAd(this.adPodIndex).tracker;e.firedError||e.close()},a.prototype.adStartedHandler=function(){this.triggerEvent(e)},a.prototype.endOfVpaidAdHandler=function(){if(clearTimeout(this.viewableTimeout),this.adPodItems&&this.adPodItems.length-1>this.adPodIndex)return this.vpaidPlayer&&(this.vpaidPlayer.destroy(),this.vpaidPlayer=null),this.adPodIndex++,void this.playAd();this.endOfAdBreakHandler()},a.prototype.endOfAdBreakHandler=function(){this.removePlayerListeners(),this.trigger(ce)},a.prototype.muteHandler=function(e){var t=this.getVastAd(this.adPodIndex).tracker;t&&(e.mute?t.mute():t.unmute(),this.vpaidPlayer&&this.vpaidPlayer.setVolume(e.mute?0:this.player.getVolume()))},a.prototype.clickStaticHandler=function(){var e=this.getVastAd(this.adPodIndex);this.player.pause({reason:p}),this.clickThrough(e)},a.prototype.clickVpaidHandler=function(e){var t=this.getVastAd(this.adPodIndex),i=!0;e&&void 0!==e.url&&(!1===e.playerHandles&&(i=!1),t.clickthrough=e.url),this.clickThrough(t,i)},a.prototype.clickInstreamHandler=function(){this.instreamPlayer.getState()!==l&&this.clickThrough(this.getVastAd(this.adPodIndex))},a.prototype.clickThrough=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.tracker.click();var i={};e.clickthrough&&(i.clickThroughUrl=e.clickthrough),this.reason=p,this.triggerEvent(s,i),window.jwcast&&window.jwcast.player.id||e.clickthrough&&t&&window.open(e.clickthrough)},a.prototype.skipVpaidAd=function(){this.endOfVpaidAdHandler(),this.vpaidAdSkipped()},a.prototype.vpaidAdSkipped=function(){this.adSkipped(),this.endOfVpaidAdHandler()},a.prototype.adSkipped=function(){clearTimeout(this.viewableTimeout);var e=this.getVastAd(this.adPodIndex);e.tracker.skip();var t=this.optionalParams.skipoffset;this.triggerEvent(Ae,{duration:e.duration,skipoffset:t,position:this.position,watchedPastSkipPoint:this.position-t})},a.prototype.playbackErrorHandler=function(e){var t=e.message||"Error Playing Ad Tag",i=e.code;(!i||i<=4)&&(i=400),this.vpaidPlayer&&"function"==typeof this.vpaidPlayer.off?(this.vpaidPlayer.off(),this.creativeAdError(t,i,e.adErrorCode)):this.adError(t,i,e.adErrorCode)},a.prototype.staticErrorHandler=function(){this.adError("Unable to fetch NonLinear resource",502)},a.prototype.vpaidExpandedHandler=function(e){var t=this.getVastAd(this.adPodIndex).tracker;e.expanded?t.expand():t.collapse()},a.prototype.triggerEvent=function(e,t){var i=this.adEventObject(e);t&&ke(i,t),this.trigger(e,i),-1===v.indexOf(e)&&this.player.trigger(e,i)},a.prototype.addConditionalAdData=function(e){this.vastAd&&(e.conditionalAd=this.vastAd.conditionalAd),this.vastAdPod&&this.vastAdPod.length&&(e.conditionalAd=this.vastAdPod[this.adPodIndex].conditionalAd),e.conditionalAdOptOut=this.optionalParams.conditionaladoptout},a}();function _(e,t){"boolean"==typeof e.mediaFileCompliance&&(t.mediaFileCompliance=e.mediaFileCompliance,e.nonComplianceReasons&&(t.nonComplianceReasons=e.nonComplianceReasons))}function T(e,t){t.request=e.request,t.response=e.response}function I(e){return"application/javascript"===(t=e).type||"application/x-javascript"===t.type?"html5":"flash";var t}function S(e){for(var t=void 0,i=0;i<e.media.length;i++){var r=e.media[i];if("html5"===I(r)){t=r;break}}return t}function C(e,t,i,r){e.tracker=new b(e.trackers,t,i,r)}var Ee=function(){function i(e,t){g(this,i),this.debugTrackFn=e,this.div=null,this.elem=null,this.environment=t}return i.prototype.addCompanion=function(e,t){if(this.div=e,this.elem=document.getElementById(this.div.id),!this.elem)return!1;for(var i=0;i<t.length;i++)if(this.fitsDiv(t[i]))return this.placeCompanion(t[i]),!0;return!1},i.prototype.removeCompanion=function(){this.elem.innerHTML=""},i.prototype.sendPings=function(e){(e=e.creativeView)&&(e.forEach(function(e){(new Image).src=e}),"function"==typeof this.debugTrackFn&&this.debugTrackFn({type:"companion",data:{trackers:e}}))},i.prototype.placeCompanion=function(e){if(this.removeCompanion(),"html"===e.type){var t=document.createElement("div");t.innerHTML=e.source;var i=t.getElementsByTagName("script");return i.length&&be._.map(i,function(e){new be.utils.scriptloader(e.src).load(),e.parentElement.removeChild(e)}),this.elem.appendChild(t),void this.sendPings(e.trackers)}if("iframe"===e.type){var r=document.createElement("iframe");return r.height=this.div.height,r.width=this.div.width,r.src=e.source,r.scrolling="no",r.style.border="none",r.marginWidth=0,r.marginHeight=0,this.sendPings(e.trackers),this.elem.innerHTML="",void this.elem.appendChild(r)}if("application/x-shockwave-flash"===e.type){var n=document.createElement("object");return n.setAttribute("type","application/x-shockwave-flash"),n.setAttribute("data",e.source),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("tabindex",0),R(n,"allowfullscreen","true"),R(n,"allowscriptaccess","always"),R(n,"seamlesstabbing","true"),R(n,"wmode","opaque"),this.elem.appendChild(n),void this.sendPings(e.trackers)}var s=new Image;s.src=e.source,be.utils.exists(e.clickthrough)&&(s.onclick=function(){window.open(e.clickthrough,"_blank").focus()}),this.elem.innerHTML="",this.elem.appendChild(s),this.sendPings(e.trackers)},i.prototype.fitsDiv=function(e){return e.width===this.div.width&&e.height===this.div.height},i}();function R(e,t,i){var r=document.createElement("param");r.setAttribute("name",t),r.setAttribute("value",i),e.appendChild(r)}var Se=Date.now||function(){return(new Date).getTime()};function x(e,t,i){var r=we(t,1002,11002);r.id=i,e.push(r)}function M(){var e=new Error("No AdBreaks in VMAP");throw e.adErrorCode=60005,e}var V=function(){function t(e){g(this,t),this._parsedAds=[],this._error=null,this._version=null,e&&this.parse(e)}return t.prototype.parsedAds=function(){return this._parsedAds},t.prototype.error=function(){return this._error},t.prototype.version=function(){return this._version},t.prototype.parse=function(i,r){var n=this,e=void 0,s=void 0;"VAST"===i.nodeName?e=i:(e=O(i,"VAST")[0])||(e=O(i,"VideoAdServingTemplate")[0]),e||this.throwError(101,"Invalid VAST response"),s="VideoAdServingTemplate"===e.tagName?1:parseFloat(B(e,"version")||0),this._version=s;var t,a=O(e,"Ad"),o=be._.map(a,function(e){var t=n.parseAd(s,e);return t.vastversion=s,t.response=i,t.request=r||null,t});this._parsedAds=o,this._parsedAds.length||(t=O(e,"Error"),be._.each(t,function(e){var t=H(e).replace(d,303),i=new Image;i.src=t}))},t.prototype.parseAd=function(e,t,i){i=i||{};var r,n,s,a,o=O(t,"InLine")[0],d=O(t,"Wrapper")[0],l=o||d,u=l?H(O(l,"AdTitle")[0]):"",h=void 0;return i.sequence=B(t,"sequence"),i.adTitle=u,(!e||4.1<e||e<2)&&this.throwError(102,"Vast version not supported"),4===e&&(i.conditionalAd=!!B(t,"conditionalAd")),l?(j(l,"Impression",(h=function(e){var t=O(O(e,"Creatives")[0],"Creative"),_={},T={trackers:_};T.adsystem=H(O(e,"AdSystem")[0]);var i=O(e,"Category");return T.categories=be._.map(i,function(e){return H(e)}),be._.each(t,function(e){var t=O(e,"Linear")[0],i=O(e,"NonLinear")[0],r=O(O(e,"TrackingEvents")[0],"Tracking"),n=O(e,"UniversalAdId")[0],s=B(n,"idRegistry")||"unknown",a=B(n,"idValue")||"unknown";T.creativeId=B(e,"id"),t||i?(be._.each(r,function(e){L(_,e)}),T.universalAdIdRegistry=s,T.universalAdIdValue=a):(T.companionUniversalAdIdRegistry=s,T.companionUniversalAdIdValue=a);var o,d,l,u,h,p,c,m,f,v,y=H(O(e,"AdParameters")[0]);if(y&&(T.adParams=y),t){var g=O(t,"VideoClicks")[0],A=H(O(g,"ClickThrough")[0]),P=O(g,"ClickTracking"),k=B(t,"skipoffset"),b=H(O(t,"Duration")[0]);be._.each(P,function(e){q(_,"click",H(e))}),b&&(T.duration=be.utils.seconds(b)),A&&(T.clickthrough=A),k&&(T.skipoffset=k),m=T,f=O(O(t,"MediaFiles")[0],"MediaFile"),v=m.media?m.media:[],m.media=v.concat(be._.map(f,function(e){return{type:B(e,"type"),file:H(e),adType:B(e,"apiFramework")||"",width:parseInt(B(e,"width"),10)||0,height:parseInt(B(e,"height"),10)||0}}).filter(function(e){return e.file}))}else if(i){var w=H(O(i,"NonLinearClickThrough")[0]);w&&(T.clickthrough=w),h=T,p=[],(c=O(u=e,"StaticResource")[0])&&(p.push({type:B(c,"creativeType"),file:H(c),adType:B(O(u,"NonLinear")[0],"apiFramework")||"static",minDuration:B(O(u,"NonLinear")[0],"minSuggestedDuration")||"00:00:00"}),h.media=p)}else o=T,d=O(O(e,"CompanionAds")[0],"Companion"),l=o.companions?o.companions:[],be._.each(d,function(e){var t=O(e,"StaticResource")[0],i=O(e,"IFrameResource")[0],r=O(e,"HTMLResource")[0],n={},s=void 0,a=void 0;if(t)s=B(t,"creativeType"),a=H(t);else if(i)s="iframe",a=H(i);else{if(!r)return;s="html",a=H(r)}var o=O(O(e,"TrackingEvents")[0],"Tracking");be._.each(o,function(e){var t=B(e,"event");q(n,t,H(e))});var d=H(O(e,"CompanionClickThrough")[0]);l.push({width:parseInt(B(e,"width"),10),height:parseInt(B(e,"height"),10),type:s,source:a,trackers:n,clickthrough:d})}),o.companions=l}),T}(l)).trackers),j(l,"Error",h.trackers),s=h,a={},be._.each(s.media,function(e){var t=e.type,i="application/x-mpegURL"===t||"vnd.apple.mpegURL"===t;"vpaid"===e.adType.toLowerCase()||i||(a[t]=a[t]||0,a[t]++)}),s.mediaFileCompliance=!0,be._.each(a,function(e,t){e<3&&(s.mediaFileCompliance=!1,s.nonComplianceReasons=s.nonComplianceReasons||[],s.nonComplianceReasons.push(t+" has only "+e+" qualities"))}),d&&(h.wrappedURI=H(O(d,"VASTAdTagURI")[0])||H(O(d,"VASTAdTagURL")[0]),h.followAdditionalWrappers=JSON.parse(B(d,"followAdditionalWrappers")),h.allowMultipleAds=JSON.parse(B(d,"allowMultipleAds")),h.fallbackOnNoAd=JSON.parse(B(d,"fallbackOnNoAd"))),r=h,n=ke({},i),be.utils.foreach(r,function(e,t){be.utils.exists(n[e])?Array.isArray(t)?n[e]=n[e].concat(t):"object"===be.utils.typeOf(t)?n[e]=ke(n[e],r[e]):n[e]=t:n[e]=t}),h=n):2===e?this.throwError(900,"Invalid VAST response",60001):this.throwError(101,"Invalid VAST response",10101),h},t.prototype.throwError=function(e,t,i){var r=this,n=we(t,e,i=i||1e4+e);throw n.toString=function(){return r.code+" "+r.message},this._error=n,this._error},t}();function O(e,t,i){var r=[];return e&&(r=e.getElementsByTagName(t),i&&r&&0===r.length&&(r=e.getElementsByTagName(i+":"+t))),r}function B(e,t){return e?e.getAttribute(t):null}function L(e,t){var i=B(t,"event");"progress"===i&&(i=i+"_"+B(t,"offset"));q(e,i,H(t))}function H(e){if(e){var t=e.textContent||e.text;if(t)return be.utils.trim(t)}return""}function q(e,t,i){e[t]||(e[t]=[]),i&&e[t].push(i)}function j(e,t,i){var r=O(e,t);be._.each(r,function(e){q(i,t.toLowerCase(),H(e))})}function D(e){e.onload=e.onreadystatechange=e.onerror=null,"abort"in e&&e.abort()}var Ce=function(){function t(e){g(this,t),this.preRoll=null,this.vmap=null,this.postRoll=null,this.midRolls=[],this.playedMidRolls=[],this.adRules=e,this.duration=0,this._vmapPromise=null,this._vmapXHR=null}return t.prototype.load=function(s,a){var o=this;return this._vmapPromise||(null!==this._vmapXHR&&(D(this._vmapXHR),this._vmapXHR=null),this._vmapPromise=new Promise(function(e,n){o._vmapXHR=s.utils.ajax({url:a,withCredentials:!0,retryWithoutCredentials:!0,requireValidXML:!0,timeout:o.requestTimeout},e,function(e,t,i,r){return n(r)})}).then(function(e){return o._vmapXHR=null,function(e,t){var i=[],r=O(e,"VMAP",E);if(!r.length)throw new Error("No VMAP tag in response");B(r[0],"version")||x(i,"VMAP Schema Error: version missing from VMAP tag",Z);var n=O(e,"AdBreak",E);n.length||M();for(var s=e.lookupNamespaceURI(E),a=0;a<n.length;a++){var o={},d={},l=n[a],u=B(l,"timeOffset"),h=B(l,"breakId"),p=B(l,"breakType"),c=B(O(l,"AdSource",E)[0],"id"),m=O(l,"AdTagURI",E)[0],f=O(l,"VASTData",E)[0]||O(l,"VASTAdData",E)[0],v=B(m,"templateType"),y=H(m),g=(w=l,_="Tracking",T=E,I=void 0,I=[],(b=s)||w?I=w.getElementsByTagNameNS?w.getElementsByTagNameNS(b,_):w.getElementsByTagName(T+":"+_):I);if(p||x(i,"VMAP Schema Error: missing breakType on AdBreak",h),f||v||x(i,"VMAP Schema Error: missing templateType on AdBreak",h),u||x(i,"VMAP Schema Error: missing timeOffset on AdBreak",h),o._type=p,o._vmap={id:c,breakid:h,timeoffset:u},f)o._adXML=O(f,"VAST")[0];else{if("vast2"!==v&&"vast3"!==v&&"vast4"!==v)continue;o._adQueue=[y],o._waterfallIndex=0}var A=[];if(g)for(var P=0;P<g.length;P++){L(d,g[P]);var k=B(g[P],"event");A.push(k)}switch((A.indexOf("breakStart")<0||A.indexOf("breakEnd")<0||A.indexOf("error")<0)&&x(i,"Tracking events are missing breakStart, breakEnd, or error for AdBreak",h),o._trackers=d,o._type=p,u){case"start":o._offSet="pre",t.setPreRoll(o);break;case"100%":case"end":o._offSet="post",t.setPostRoll(o);break;default:if(/^#/.test(u))break;/^\d\d?(?:\.\d+)?%$/.test(u)?o._offSet=u:o._offSet=be.utils.seconds(u),t.addMidRoll(o)}}var b,w,_,T,I;return t.preRoll||t.midRolls.length||t.postRoll||M(),t.sort(null,!0),i}(e.responseXML,o).map(function(e){return e.vmap=a,e})}).catch(function(e){o._vmapXHR=null;var t=void 0;if(e.message)t=we("VMAP Schema Error: "+e.message,1002,e.adErrorCode||11002);else{var i={1:{code:1007,message:"Timeout"},602:{code:1e3,message:"Invalid XML"},default:{code:1008,message:s.getConfig().localization.errors[e.key]}},r=i[e.code]||i.default;s.utils.log(r.message),t=we("Error Loading VMAP Schedule",r.code,r.code+1e4)}throw t.id=Z,t.vmap=a,t})),this._vmapPromise},t.prototype.canWaterfall=function(e){return e._adQueue&&e._waterfallIndex+1<e._adQueue.length},t.prototype.setPreRoll=function(e){this.preRoll=e},t.prototype.getPreRoll=function(e){return e&&"none"===this.adRules.startOnSeek?null:F(this.preRoll,this.requestTimeout,this.creativeTimeout)},t.prototype.getPostRoll=function(e){var t=F(this.postRoll,this.requestTimeout,this.creativeTimeout);return this.adRules.timeBetweenAdsAllowsAdPlayback(t,e)?t:null},t.prototype.getMidRollAtIndex=function(e){return F(this.midRolls[e],this.requestTimeout,this.creativeTimeout)},t.prototype.getLastMidRollIndexBetweenTime=function(e,t,i){if(t<e)return null;this.sort(i);for(var r=this.midRolls.length;r--;){var n=this.midRolls[r],s=N(this.midRolls[r]._offSet,i);if(s<=e)return null;if(s<=t){var a=F(n,this.requestTimeout,this.creativeTimeout);if(!this.adRules.timeBetweenAdsAllowsAdPlayback(a))return null;if(!this.adRules.timeBetweenAds){if(0<=this.playedMidRolls.indexOf(r))return null;this.playedMidRolls.push(r)}return r}}return null},t.prototype.peek=function(e,t,i){if(this.midRolls.length>this.playedMidRolls.length){this.sort(i);for(var r=0;this.midRolls[r];){var n=N(this.midRolls[r]._offSet,i);if(e<=n&&-1===this.playedMidRolls.indexOf(r)){var s=Se()+1e3*(n-e);return n<=t&&this.adRules.timeBetweenAdsAllowsAdPlayback(null,s)?r:null}r+=1}}var a=Se()+1e3*(i-e);return this.postRoll&&i<=t&&this.adRules.timeBetweenAdsAllowsAdPlayback(null,a)?-1:null},t.prototype.getNextMidrollIndex=function(e,t,i){if(this.adRules.timeBetweenAds||this.adRules.startOnSeek)return this.getLastMidRollIndexBetweenTime(e,t,i);if(this.midRolls.length>this.playedMidRolls.length){var r=this.getClosestIndex(t,i);if(0<=r&&this.playedMidRolls.indexOf(r)<0)return this.playedMidRolls.push(r),r}return null},t.prototype.getMidRolls=function(){var t=this;return this.midRolls.map(function(e){return F(e,t.requestTimeout,t.creativeTimeout)})},t.prototype.reset=function(){null!==this._vmapXHR&&(D(this._vmapXHR),this._vmapXHR=null),this.playedMidRolls=[],this.duration=0},t.prototype.addMidRoll=function(e){this.midRolls.push(e),this.duration=0},t.prototype.setPostRoll=function(e){this.postRoll=e},t.prototype.sort=function(i,e){(!i||i<1)&&(i=1),(this.duration!==i||e)&&(this.duration=i,this.midRolls.sort(function(e,t){return N(e._offSet,i)-N(t._offSet,i)}),function(e,t){for(var i=0;i<e.length;i++){var r=e[i];t?r._vmap.item=i+1:r._adbreak={item:i+1,tags:r._adQueue,breakid:r._breakId}}}(this.getAllAds(),e))},t.prototype.getAllAds=function(){var e=this.preRoll?[this.preRoll]:[],t=this.postRoll?[this.postRoll]:[];return e.concat(this.midRolls,t)},t.prototype.getAdScheduleEventObject=function(){var e=this.getAllAds(),r=[],t={tag:this.getVMAP(),client:"vast",adbreaks:[]};return be.utils.foreach(e,function(e,t){var i={type:t._type,offset:t._offSet};t._vmap?i.vmap=t._vmap:i.adbreak=ke({},t._adbreak),r.push(i)}),t.adbreaks=r,t},t.prototype.setVMAP=function(e){this.vmap=e},t.prototype.isVMAP=function(){return!!this.vmap},t.prototype.getVMAP=function(){return this.vmap},t.prototype.getClosestIndex=function(e,t){this.sort(t);for(var i=this.midRolls.length;i--;)if(e>=N(this.midRolls[i]._offSet,t))return i;return-1},t}();function F(e,t,i){var r=void 0;if(be.utils.foreach(e,function(e,t){(r=r||{})[e]="_adQueue"===e?t.slice():t}),r)return r.requestTimeout=t,r.creativeTimeout=i,r._errors=[],r._waterfallIndex=0,r}function N(e,t){return"%"===e.toString().slice(-1)?t*parseFloat(e.slice(0,-1))/100:parseFloat(e)}var Re=function(){function e(){g(this,e)}return e.prototype.getSchedule=function(e,t){var i=new Ce(t);if(i.requestTimeout=X(e.requestTimeout,ee),i.creativeTimeout=X(e.creativeTimeout,te),e.tag)i.setPreRoll({_offSet:"pre",_adQueue:U(e.tag),_waterfallIndex:0});else if("string"==typeof e.vastxml)i.setPreRoll({_offSet:"pre",_adXML:e.vastxml});else{if("string"==typeof e.schedule)return i.setVMAP(e.schedule),i;if("string"==typeof e.adschedule)return i.setVMAP(e.adschedule),i;!function(d,l){var u=l.schedule||l.adschedule;if(!u)return;Object.keys(u).forEach(function(e){var t=u[e];t.ad&&(ke(t,t.ad),delete t.ad);var i=function(e){if("start"===e||"0%"===e||!e&&0!==e)return"pre";if("end"===e||"100%"===e)return"post";if("pre"===e||"post"===e||-1<be._.indexOf(e,"%"))return e;var t=be.utils.seconds(e);if("number"==typeof t)return t;return!1}(t.offset),r=X(t.requestTimeout,ee),n=X(t.creativeTimeout,te),s={_offSet:i,_type:t.type,_breakId:e,requestTimeout:r,creativeTimeout:n};!1===i&&be.utils.log("Error: ad offset format not supported",i);var a=t.skipoffset||l.skipoffset;if(void 0!==a&&(s.skipoffset=a),t.tag){var o=function(e,t){if(!t)return e;var i=0<=e.indexOf("?")?"&":"?",r="cust_params=",n=e.indexOf(r),s=r.length,a="",o="";if(be.utils.foreach(t,function(e,t){a=""+a+o+e+"="+t,o="&"}),a=encodeURIComponent(a),0<=n){var d=e.substr(0,n+s),l=e.substr(n+s);return""+d+a+"%26"+l}return""+e+i+"cust_params="+a}(t.tag,t.custParams);s._adQueue=U(o),s._waterfallIndex=0}else{if("string"!=typeof t.vastxml)return void be.utils.log("Error: no ad tag provided");s._adXML=t.vastxml}switch(i){case"pre":d.setPreRoll(s);break;case"post":d.setPostRoll(s);break;default:d.addMidRoll(s)}})}(i,e)}return i.sort(),i},e.prototype.getOptParams=function(e,t){var i={cuetext:t.cuetext,dynamicMessage:t.admessage,loadingAd:t.loadingAd,podMessage:t.podmessage,skipoffset:e.skipoffset||-1,skipMessage:t.skipmessage,skipText:t.skiptext,vpaidcontrols:e.vpaidcontrols||!1,conditionaladoptout:e.conditionaladoptout||!1,requestFilter:e.requestFilter,trackingFilter:e.trackingFilter},r=e.companiondiv;return r&&(i.companion={id:r.id,height:r.height,width:r.width}),i},e.prototype.getAdRules=function(e){var t=e.rules||{},i=parseInt(t.frequency,10);return{startOn:t.startOn||1,frequency:isNaN(i)?1:i,timeBetweenAds:t.timeBetweenAds||0,startOnSeek:t.startOnSeek||null}},e}();function U(e){return"string"==typeof e?[e]:Array.isArray(e)?e.slice(0):e}function X(e,t){return 0===e?1/0:e||t}var Q=/^((https?:)?\/\/)?(secure)?pubads\.g\.doubleclick\.net\/gampad\/ads\?[\S]*$/;function xe(e,t,i){if(!e)return e;var r,n,s,a,o,d,l=(n=(r=t).getConfig(),{playerHeight:r.getHeight()||n.height||"",playerWidth:r.getWidth()||n.width||"",itemDuration:(s=r.getDuration(),a=3,o=Math.pow(10,a),Math.round(s*o)/o||""),item:n.playlist[r.getPlaylistIndex()]||{}}),u=l.item,h=window.location.href;e=W(e=W(e=W(e=W(e=W(e=W(e=W(e=W(e,"__random-number__",Math.random()*Math.pow(10,18)),"__timestamp__",(new Date).getTime()),"__page-url__",encodeURIComponent(h)),"__referrer__",encodeURIComponent(document.referrer)),"__player-height__",l.playerHeight),"__player-width__",l.playerWidth),"__item-duration__",l.itemDuration),"__domain__",encodeURIComponent((d=(d=window.location.href).match(new RegExp(/^[^/]*:\/\/\/?([^\/]*)/)))&&1<d.length?d[1]:""));for(var p=(e=i.companion?W(e,"__companion-div__",i.companion.id):W(e,"__companion-div__","")).match(new RegExp(/__item-[a-z 0-9 A-Z]*__/g)),c=0;p&&c<p.length;c++){var m=p[c],f=m.substring(7,m.length-2);if(u.hasOwnProperty(f)&&"string"==typeof u[f]){var v=u[f];1e3<v.length&&(v=v.substring(0,1e3)),e=W(e,m,encodeURIComponent(v))}else e=W(e,m,"")}return e=function(e,t,i){Q.test(e)&&(e=e+"&vpa="+t+"&vpmute="+i);return e}(e,t.getConfig().autostart?1:0,t.getMute()?1:0)}function W(e,t,i){return e.replace(t,i)}var z,J=function(){function d(e,t,i,r,n){g(this,d),this._scheduledAd=e,this.player=t,this.options=i||{},this.wrapperOptions=r||{followAdditionalAds:!0,allowMultipleAds:!0},this.debugTrackFn=n,ke(this,t.Events),this._history=[],this.loadedAds=[],this.parser=null,this.promise=null,this.xmlhttp=null}return d.prototype.load=function(t){var i=this;if(null===this.promise){this._history.push(t);var r=this.options.requestFilter;this.promise=new Promise(function(e,n){i.xmlhttp=be.utils.ajax({url:t,withCredentials:!0,retryWithoutCredentials:!0,requireValidXML:!0,timeout:i._scheduledAd.requestTimeout,requestFilter:r},e,function(e,t,i,r){return n(r)})}).catch(function(e){if(null!==i.player)throw i.ajaxError(e,t)}).then(function(e){if(null!==i.player)return i.parseXMLString(e.responseXML||e.responseText,t)})}return this.promise},d.prototype.destroy=function(){var e;(e=this.xmlhttp)&&(e.onload=null,e.onreadystatechange=null,e.onerror=null,e.abort&&e.abort()),this.player=null,this.xmlhttp=null},d.prototype.scheduledAd=function(){return this._scheduledAd},d.prototype.allAds=function(){return this.loadedAds},d.prototype.adPod=function(){var t=[];return this.loadedAds.forEach(function(e){e.sequence&&t.push(e)}),t.sort(function(e,t){return e.sequence-t.sequence}),t},d.prototype.adBuffet=function(){var t=[];return this.loadedAds.forEach(function(e){e.sequence||t.push(e)}),t},d.prototype.history=function(){return this._history},d.prototype.parseXMLString=function(i,a){var o=this;return null===this.parser&&(this.parser=new V),new Promise(function(e){var t=function(e){if(t=e,"object"==typeof Node?t instanceof Node:t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName)return e;var t;return be.utils.parseXML(e)}(i);return o.parser.parse(t,o.xmlhttp),e(o.parser.parsedAds())}).catch(function(e){if(null!==o.player){var t=e.code||900,i=e.adErrorCode||1e4+t;throw o.sendErrorEvent(e.message,t,i,a)}}).then(function(e){if(null===o.player)return null;if(0===e.length){var t=2===o.parser.version(),i=t?900:101,r=t?60001:10101;throw o.sendErrorEvent("Ad Tag Empty",i,r,a)}var n=e.filter(function(e){return!e.sequence});o.wrapperOptions.allowMultipleAds?o.loadedAds=e:o.loadedAds=n,o.options.wrapper=o.options.wrapper||[],o.options.adsystem&&o.options.wrapper.push(o.options.adsystem),o.options.adsystem=o.loadedAds[0].adsystem;var s=[];return e.forEach(function(a){if(a.wrappedURI){if(!1===o.wrapperOptions.followAdditionalWrappers)return;o.options.wrappedTags=o.options.wrappedTags||[o._scheduledAd._currentTag],o.options.wrappedTags.push(a.wrappedURI);var e=new d(o._scheduledAd,o.player,o.options,{fallbackOnNoAd:a.fallbackOnNoAd,allowMultipleAds:a.allowMultipleAds,followAdditionalWrappers:a.followAdditionalWrappers},o.debugTrackFn).load(a.wrappedURI).then(function(e){var n,t,s,i=(n=a,t=e.allAds(),s=[],be.utils.foreach(t,function(e,t){var i,r;n.companions&&(t.companions=(t.companions?t.companions:[]).concat(n.companions)),n.trackers&&(t.trackers=(i=t.trackers,r=n.trackers,i=i||{},be.utils.foreach(r,function(e,t){i[e]?i[e]=i[e].concat(t):i[e]=t}),i)),n.sequence&&(t.sequence=n.sequence),s.push(t)}),s),r=o.loadedAds.indexOf(a);Array.prototype.splice.apply(o.loadedAds,[r,1].concat(i))}).catch(function(e){var t=o.sendAdpodErrorEvent(e.message,e.code,e.adErrorCode,e.url),i=a.fallbackOnNoAd&&a.sequence&&n.length&&"Ad Tag Empty"===t.message,r=o.loadedAds.indexOf(a);if(i)return a.loadError=t,void e.vloader.destroy();if(o.loadedAds.splice(r,1),e.vloader.destroy(),t.type!==de)throw t;o.trigger(de,t)});s.push(e)}else 1<o.options.wrapper.length&&(a.wrapper=o.options.wrapper,a.wrappedTags=o.options.wrappedTags)}),Promise.all(s)}).then(function(){if(null===o.player)return null;var n=o.loadedAds.filter(function(e){return!e.sequence});o.loadedAds.forEach(function(e,t){if(e.loadError)if(n.length){var i=o.loadedAds[t+1],r=i&&!i.sequence?i:n[0];o.loadedAds[t]=ke({},r,{sequence:e.sequence})}else o.trigger(de,e.loadError)});var t=o.loadedAds.slice(0),e=t.length;t.forEach(function(e){e.media&&e.media.length||t.length--});var i=0===e,r=t.length!==e;if(i||r)throw o.sendErrorEvent("Ad Tag Empty",101,10101,o._history[o._history.length-1]);return o})},d.prototype.ajaxError=function(e,t){if(this.player.getAdBlock())return this.sendErrorEvent("Ad playback blocked by an ad blocker",900,60003,t);var i=e.code;if(601===i||602===i)return this.sendErrorEvent("Invalid XML",100,10100,t);if(1===i||404===i)return this.sendErrorEvent("VAST could not be loaded",301,10301,t);var r=this.options.wrappedTags&&this.options.wrappedTags.length,n=r?303:900,s=r?10303:60006;return this.sendErrorEvent(e.message||"Error loading file",n,s,t)},d.prototype.firstUrl=function(){return this._history&&this._history.length?this._history[0]:""},d.prototype.sendAdpodErrorEvent=function(e,t,i,r){if(1===this.loadedAds.length)return this.sendErrorEvent(e,t,i,r);var n=we(e,t,i);return n.type=de,n.vloader=this,n.url=this.firstUrl()||r,this.wrappedTags=r,n},d.prototype.sendErrorEvent=function(e,t,i,r){var n=we(e,t,i);return n.vloader=this,n.url=this.firstUrl()||r,this.options.wrappedTags&&(n.wrapperAdSystem=this.options.wrapper||"",n.wrappedTags=this.options.wrappedTags),n.adsystem=this.options.adsystem||"",this.trackError(n),n},d.prototype.trackError=function(e){var t=e.vloader.allAds();if(t&&t.length){var i=t[0];if(i){var r=i.trackers;if(r&&r.error)new b(r,this.debugTrackFn,this.player,this.options.trackingFilter).error(e.code)}}},d}();var $=2e3,K=3500,G="usd",Me=1,Ve="//c.amazon-adsystem.com/aax2/apstag.js",Oe="video",Be="3.0.0",Le="//js-sec.indexww.com/htv/htv-jwplayer.min.js",He="//js.spotx.tv/directsdk/v1/",qe="//search.spotxchange.com/ad/vast.html?key=",je="dfp",De="jwp",Fe="jwpspotx",Ne="jwpdfp",Ue=De,Xe="APS",Qe="Index",We="SpotX",ze=((z={})[[je]]=[Xe,"FAN",Qe,We],z[[De]]=["FAN",We],z[[Ne]]=[We],z[[Fe]]=[We],z),Je="Error loading script",$e="bid",Ke="error",Ge="invalid",Ye="noBid",Ze=0,et=1,tt=3,it=5,rt=[{message:"SpotX :: Unable to find ad",result:Ye,code:Ze},{message:Je,result:Ke,code:6},{message:"Invalid options: 'slot' is required",code:300},{message:"Invalid options: 'slot' must be part of DOM",code:301},{message:"Invalid options: 'channel_id' is required.",code:302},{message:"Invalid options: 'content_width' and 'content_height' are required when no 'video_slot' is provided.",code:303},{message:"Invalid options: 'content_width' provided but 'content_height' is not.",code:304},{message:"Invalid options: 'content_height' provided but 'content_width' is not.",code:305},{message:"Invalid options: 'custom' must be an object.",code:306},{message:"Invalid options: 'token' must be an object.",code:307},{message:"Invalid options: 'ados' must be an object.",code:308},{message:"Invalid options: 'contentPageUrl' must be a string.",code:309},{message:"Invalid options: 'demand_source_timeout' must be a number.",code:310},{message:"Invalid options: 'total_bid_timeout' must be a number.",code:311}],nt=320,st=[{message:"Incorrect domain",code:321},{message:"unsupported_platform",code:322},{message:"Request_URL_noncompliant",code:323},{message:"Application not authorised for header bidding",code:324},{message:"pageurl is required",code:325},{message:"adformats",code:326}],at=Date.now||function(){return(new Date).getTime()};function ot(n,s){return new Promise(function(t,e){setTimeout(e,s);var i=document.createElement("script");i.onload=i.onreadystatechange=function(e){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(t(e),i.onload=i.onreadystatechange=null,r&&i.parentNode&&r.removeChild(i))},i.onerror=e,i.type="text/javascript",i.charset="utf-8",i.async=!0,i.timeout=s,i.src=n;var r=document.getElementsByTagName("head")[0]||document.documentElement;r.insertBefore(i,r.firstChild)}).catch(function(){return Promise.reject({message:Je})})}var dt=encodeURIComponent(window.location.href),lt={requestBids:function(e,f,i){var v=e.id,r=(t=v,n=f.playerWidth,s=f.playerHeight,["https://an.facebook.com/v2/placementbid.json?&placementids[]="+t,"&playerwidth="+n,"&playerheight="+s,"&adformats[]="+Oe,"&SDK[]="+Be,"&pageurl="+dt,"$random="+Math.random()*Math.pow(10,18)].join(""));var t,n,s;if(!function(e,t,i,r){if(!r)return!1;return e===je||t&&i===G}(f.mediationLayerAdServer,f.floorPriceCents,f.floorPriceCurrency||G,r))return Promise.resolve({result:Ge,code:tt});return new Promise(function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4===this.readyState&&(e(this),t=null)},t.open("GET",r),t.withCredentials=!0,t.send(null),i.then(function(){t&&(t.abort(),t=null)})}).then(function(e){if(200!==e.status)return{result:Ke,code:it,message:"Invalid response (status "+e.status+")"};var t,i,r=JSON.parse(e.responseText),n=r.errors,s=r.request_id;if(n&&n.length)return{result:Ge,code:(t=n[0],i=st.filter(function(e){return 0<=t.indexOf(e.message)})[0],i?i.code:nt),requestId:s};var a=r.bids;if(!a||!a[v]||!a[v][0])return{result:Ye,code:Ze,requestId:s};var o=a[v][0],d=o.bid_price_cents,l=o.bid_id;if(f.mediationLayerAdServer===je)return{result:$e,code:et,tag:f.tag,custParams:{jwFANBidPrice:Math.round(d/100),jwFANBidID:l},requestId:s};var u,h,p,c,m={result:$e,code:et,priceInCents:d,priceCurrency:o.bid_price_currency,requestId:s};return d>=f.floorPriceCents&&(m.tag=(u=v,h=l,p=f.playerWidth,c=f.playerHeight,["https://an.facebook.com/v1/instream/vast.xml?placementid="+u,"&playerwidth="+p,"&playerheight="+c,"&SDK[]="+Be,"&bidid="+h,"&pageurl="+dt].join(""))),m}).catch(function(e){return{result:Ke,code:it,message:"FAN header bidding failed: "+e}})},getCustomResponse:function(){return{}}};var ut=null;function ht(){return null===ut&&(ut=Promise.resolve(window.apstag).then(function(e){return e&&e.init&&e.fetchBids?e:ot(["file"===document.location.protocol?"https:":"",Ve].join(""),K).then(function(){return window.apstag})}).catch(function(e){throw ut=null,e})),ut}var pt=null,ct=null;function mt(e){if(null===ct){var t=at(),i=pt||window.SpotX;if(i&&i.DirectAdOS)return ct=Promise.resolve({SpotX:i,loadingTime:0});var r=["file"===document.location.protocol?"https:":"",He,e,".js"].join("");(ct="function"==typeof require?(n=r,s=K,new Promise(function(e,t){setTimeout(t,s),require([n],e,t)}).catch(function(){return Promise.reject({message:Je})})).then(function(e){return{SpotX:pt=e,loadingTime:at()-t}}).catch(function(){return ft(r,t)}):ft(r,t)).catch(function(){ct=null})}var n,s;return ct}function ft(e,t){return ot(e,K).then(function(){return{SpotX:window.SpotX,loadingTime:at()-t}})}var vt=void 0,yt={requestBids:function(e,l){if(!e.id)return Promise.resolve({result:Ge,code:302});var t={channel_id:e.id,slot:l.playerContainer,content_width:l.playerWidth,content_height:l.playerHeight,player_vendor:"SpotXJW",player_vendor_id:l.playerId,ad_volume:l.adVolume,ad_mute:l.mute?1:0,autoplay:l.autoplay,blocked_autoplay_override_mode:l.autoplayAdsMuted,start_delay:function(e){if("start"===e||"0%"===e||!e||"pre"===e||"00:00:00"===e)return 0;if("end"===e||"100%"===e||"post"===e)return-2;if("string"==typeof e&&0<=e.indexOf("%"))return-1;var t=parseInt(e);return 0<t?t:-1}(l.offset)},s=ke({placement:1,hide_skin:!0,no_vpaid_ads:!1},e.optionalParams,t);e.passFloorPrice&&l.floorPriceCents&&(s.price_floor=l.floorPriceCents/100);return mt(e.id).then(function(e){var t=e.SpotX,i=e.loadingTime;vt=i;var r=new t.DirectAdOS(s),n=at();return r.getAdServerKVPs().then(function(e){return{response:e,bidNetworkStartTime:n}})}).then(function(e){var t=e.response,i=e.bidNetworkStartTime,r=at()-i,n=t.spotx_ad_key,s={spotx_bid:t.spotx_bid,spotx_ad_key:n},a=100*parseFloat(t.spotx_bid),o={result:$e,code:et,priceInCents:a,custParams:s,scriptLoadingTime:vt,bidNetworkResponseTime:r};if(l.mediationLayerAdServer===je)return o;var d=["file:"===document.location.protocol?"https:":"",qe,n].join("");return ke(o,{tag:d,tagKey:n})}).catch(function(t){var e=rt.filter(function(e){return e.message===t.message})[0];return e?{result:e.result||Ge,code:e.code,scriptLoadingTime:vt}:{result:Ke,message:"SpotX header bidding failed: "+t,code:it,scriptLoadingTime:vt}})},getCustomResponse:function(){return{scriptLoadingTime:vt}}};var gt=null;function At(t){return null===gt&&(gt=Promise.resolve(window.indexapi).then(function(e){return e||ot(["file"===document.location.protocol?"https:":"",t||Le].join(""),K).then(function(){return window.indexapi})}).catch(function(e){throw gt=null,e})),gt}var Pt,kt={requestBids:function(e,r){if(!e.id&&!e.script)return Promise.resolve({result:Ge,code:tt});var t=ke({videoCommonArgs:{protocols:[2,3,5,6],mimes:["video/mp4","video/webm","application/javascript"],apiList:[1,2]},siteID:e.id},e);return At().then(function(e){return new Promise(function(i){e.deferQueue=e.deferQueue||[],e.deferQueue.push(function(){e.solicitIndexVideoAds(r.tag,function(e,t){i({updatedTag:e,indexTargeting:t})},t)})})}).then(function(e){var t=e.indexTargeting;return void 0!==t?{result:$e,code:et,tag:r.tag,custParams:t}:{result:Ye,code:Ze}}).catch(function(e){return{result:Ke,code:it,message:"Index Exchange header bidding failed: "+e}})},getCustomResponse:function(){return{}}};var bt=((Pt={})[[Xe]]={requestBids:function(i,r){if(!i.id||!i.slotID)return Promise.resolve({result:Ge,code:tt});return ht().then(function(t){return t.init({id:i.pubId,adServer:i.adServer}),new Promise(function(e){t.fetchBids({slots:[{slotID:i.slotID}],timeout:r.bidTimeout},e)})}).then(function(e){return e&&e[0]&&e[0].slotID===i.slotID?{result:$e,code:et,tag:r.tag,custParams:{amznbid:e[0].amznbid,amzniid:e[0].amzniid}}:{result:Ye,code:Ze}}).catch(function(e){return{result:Ke,code:it,message:"Amazon header bidding failed: "+e}})},getCustomResponse:function(){return{}}},Pt[["FAN"]]=lt,Pt[[Qe]]=kt,Pt[[We]]=yt,Pt);var wt=function(){function h(){var e,t,i,r,n=this,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=s.settings,o=void 0===a?{}:a,d=s.bidders,l=void 0===d?[]:d,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(g(this,h),this.settings=(e=o,i=ke({bidTimeout:$,offset:"",playerContainer:(t=u).container,playerHeight:t.height||0,playerWidth:t.width||0,tag:""},t,e),ze[i.mediationLayerAdServer]||(i.mediationLayerAdServer=Ue),i.mediationLayerAdServer===Fe&&(i.floorPriceCents=Me),i),this.bidders=l.reduce(function(e,t){return t.name&&(e[t.name]=ke(t,t.custom_params)),e},{}),"pre"!==this.settings.offset&&0!==parseInt(this.settings.offset))&&(this.bidders=this.bidders[We]?((r={})[[We]]=this.bidders[We],r):{});this.bidders[Xe]&&this.bidders[Xe].id&&this.bidders[Xe].slotID&&ht(),this.bidders[Qe]&&(this.bidders[Qe].script||this.bidders[Qe].id)&&At(this.bidders[Qe].script),this.bidders[We]&&this.bidders[We].id&&mt(this.bidders[We].id),this._bidRequest=null,this._currentTimeout=null,this._onCancelTrigger=null,this.onCancel=new Promise(function(e){n._onCancelTrigger=e})}return h.prototype.start=function(){var e,n,o,t,i;return this._bidRequest||(this._bidRequest=(e={config:this.bidders,settings:this.settings,onCancel:this.onCancel},n=e.config,o=e.settings,t=e.onCancel,i=ze[o.mediationLayerAdServer].filter(function(e){return n[e]}).map(function(i){var r=at();return Promise.race([bt[i].requestBids(n[i],o,t),t]).then(function(e){var t=bt[i].getCustomResponse();return ke({},n[i],e,t,{timeForBidResponse:at()-r|0})})}),Promise.all(i).then(function(e){var t=o.mediationLayerAdServer===je||o.mediationLayerAdServer===Ne,i=o.mediationLayerAdServer===De||o.mediationLayerAdServer===Ne||o.mediationLayerAdServer===Fe,r={priceInCents:o.floorPriceCents,timeForBidResponse:1/0},n=[],s={},a={};return a.bidders=e.map(function(e){return t||(e.winner=!1),e.result===$e&&(n.push(e),ke(s,e.custParams),i&&(e.priceInCents>r.priceInCents||e.priceInCents===r&&e.timeForBidResponse<r.timeForBidResponse)&&(r=a.result=e)),e}),i&&r.name?r.winner=!0:t&&n.length&&(a.result={tag:o.tag,custParams:s}),a}))),this._bidRequest},h.prototype.stop=function(){var t=this;clearTimeout(this._currentTimeout),this._onCancelTrigger({result:"abort",code:4}),this._bidRequest=null,this._currentTimeout=null,this._onCancelTrigger=null,this.onCancel=new Promise(function(e){t._onCancelTrigger=e})},h.prototype.getEventObject=function(e,t,i){var r=i.offset,n=i.adBreakId,s=i.adPlayId,a=this.settings.mediationLayerAdServer,o=t||[];"pre"!==r&&0!==parseInt(r)&&(o=o.filter(function(e){return e.name===We}));var d={client:e,offset:r,mediationLayerAdServer:a,bidders:o,adBreakId:n,adPlayId:s,bidTimeout:this.settings.bidTimeout},l=this.settings.floorPriceCents;l&&a!==Fe&&a!==je&&(d.floorPriceCents=l);var u=this.settings.floorPriceCurrency;return u&&(d.floorPriceCurrency=u),d},h.prototype.then=function(e){return this._bidRequest?this._bidRequest.then(e,e):null},h.prototype.timeout=function(){clearTimeout(this._currentTimeout),this._currentTimeout=setTimeout(this._onCancelTrigger,this.settings.bidTimeout,{result:"timeout",code:2})},h}(),_t=0,Tt=function(){function a(i,e,t,r,n){var s=this;g(this,a),this.config=r,this.item=t,this.params=n,this.player=i,this.schedule=e,this.adIds={},this.vmapPromise=null,this._preRollPromise=null,this._midRollPromise={},this._postRollPromise=null,this.vmapTracker=null,this._errors=[],this._vloaderQueue=[],this._staticAdsOffset=[],this.bids=[],this.bidsPromise=null,this.bidsResult={},this._debugTrackFn=r.debug&&r.trackFn?r.trackFn:null,ke(this,i.Events),this.trigger=function(e,t){return t.item=s.item,i.Events.trigger.call(s,e,t)}}return a.prototype.init=function(e){var t=this,i=this.schedule,r=i.isVMAP();return r&&(this.vmapPromise=i._vmapPromise.catch(this.player.utils.noop)),this.bidsPromise=null===e?this.vmapPromise||Promise.resolve():r?this.vmapPromise.then(function(){return t.isDestroyed()?null:t._createBidsPromise(e)}):this._createBidsPromise(e),this.bidsPromise},a.prototype._createBidsPromise=function(i){var d=this,r=this.player,e=parseInt(i.bidOnBreaks,10);return e=0<e?e:1/0,this.bids=this.schedule.getAllAds().slice(0,e).map(function(n){var s=new wt(i,{offset:n._offSet,width:r.getWidth(),height:r.getHeight(),container:r.getContainer(),playerId:r.id,autoplay:r.getConfig().autostart,autoplayAdsMuted:d.config.autoplayadsmuted,adVolume:r.getVolume(),mute:r.getMute()});s.start();var e=d.getAdIds(n),a=e.adBreakId,o=e.adPlayId,t=s.getEventObject(Y,i.bidders,{offset:n._offSet,adBreakId:a,adPlayId:o});return d.trigger(le,t),s.then(function(e){var t=e.bidders,i=e.result;if(!d.isDestroyed()){i&&!i.error&&i.tag&&(n._adQueue=n._adQueue||[],n._adQueue[0]=i.tag,n._adXML=null),d.bidsResult[n._vmap?n._vmap.breakid:n._breakId]={bid:s,bidders:t};var r=s.getEventObject(Y,t,{offset:n._offSet,adBreakId:a,adPlayId:o});d.trigger(ue,r)}}),s}),Promise.all(this.bids)},a.prototype.getAdIds=function(e){var t=e._offSet;this.adIds[t]=this.adIds[t]||{adBreakId:_e(12),adPlayIds:{}};var i=this.adIds[t].adPlayIds,r="p"+(e._adPodIndex||0)+"w"+e._waterfallIndex,n=i[r];return n||(i[r]=n=_e(12)),{adBreakId:this.adIds[t].adBreakId,adPlayId:n}},a.prototype.loadPreRoll=function(){var t=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return null===this._preRollPromise&&(this._preRollPromise=this.bidsPromise.then(function(){if(!t.isDestroyed()){var e=t.schedule.getPreRoll(i.startTime);return e?(e._position="pre",t.loadAd(e,i)):void 0}})),this._preRollPromise},a.prototype.loadMidRollAtIndex=function(t,i){var r=this;return this._midRollPromise[t]||(this._midRollPromise[t]=this.bidsPromise.then(function(){if(!r.isDestroyed()){var e=r.schedule.getMidRollAtIndex(t);return e?(e._position="mid",r.loadAd(e,i)):void 0}})),this._midRollPromise[t]},a.prototype.loadPostRoll=function(){var t=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return null===this._postRollPromise&&(this._postRollPromise=this.bidsPromise.then(function(){if(!t.isDestroyed()){var e=t.schedule.getPostRoll(i.startTime);return e?(e._position="post",t.loadAd(e,i)):void 0}})),this._postRollPromise},a.prototype.loadAd=function(e){var t=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=this.player.utils;if(e._id=e._id||_e(12),this.config.preloadAds&&(e._preload=e._preload||i.preload||!1),e._vmapTracker=this.getVMAPTracker(e),e._adXML)e.currentTag=e._currentTag||"clientloadedtag_"+_t++;else if(!e._adQueue)return void r.log("scheduled ad has no url or xml",e);var n=e._adXML?this._loadXML(e,i):this._loadTag(e,i);return n.then(function(){return t.isDestroyed()?null:t._dispatchAdLoaded(e)}).catch(r.noop),n.catch(function(){return t.isDestroyed()?null:t._dispatchAdLoaded(e)}).catch(r.noop),n.catch(function(e){return t.isDestroyed()?null:t._vloaderWaterfall(e,i)})},a.prototype.getVMAPTracker=function(e){if(!e._vmapTracker){var t=new b(e._trackers,this._debugTrackFn,this.player,this.config.trackingFilter);e._vmapTracker=this.vmapTracker=t}return e._vmapTracker},a.prototype._loadTag=function(e,t){var i=e._adQueue[e._waterfallIndex],r=xe(i,this.player,this.params);if(e._currentTag=r,"function"==typeof this._debugTrackFn&&this._debugTrackFn({type:"tagReplacement",data:{actualTag:r,originalTag:i}}),t.adBlock)throw this._adBlockDetected(e);var n=this._createVastLoader(e).load(r);return this._dispatchAdRequest(e,r),n},a.prototype._loadXML=function(e,t){if(e._currentTag=e._currentTag||e._adXML.toString(),t.adBlock)throw this._adBlockError(e);var i=this._createVastLoader(e).parseXMLString(e._adXML);return this._dispatchAdRequest(e,e._currentTag),i},a.prototype._adBlockError=function(e){var t=this.getAdEventObject(e),i=we("Ad playback blocked by an ad blocker",900,600003);return ke(t,i)},a.prototype._dispatchAdRequest=function(e,t){this.trigger(ye,this.getAdEventObject(e,t))},a.prototype._dispatchAdLoaded=function(e){this.trigger(ve,this.getAdEventObject(e))},a.prototype._vloaderWaterfall=function(e,t){var i=e.vloader;this.removeVastLoader(i);var r=this._getVloaderErrorObject(e);return this.adWaterfall(i,t,r)},a.prototype.adWaterfall=function(e,t,i){var r=e.scheduledAd();if(this.schedule.canWaterfall(r))return r._waterfallIndex+=1,this._enqueueAdError(r,i),this.loadAd(r,t);throw i},a.prototype.getAdEventObject=function(e,t){return ke((r=t,n={},void 0!==(i=e)._preload&&(n.preloadAds=i._preload),void 0!==i.skipoffset&&(n.skipoffset=i.skipoffset),i._adbreak&&(n.adschedule=i._adbreak,n.adschedule.offset=i._offSet),ke(n,{id:i._id,tag:r||i._currentTag,client:Y,adposition:i._position,offset:i._offSet,witem:i._waterfallIndex+1,wcount:i._adQueue?i._adQueue.length:1})),this.getAdIds(e));var i,r,n},a.prototype.addStaticOffset=function(e){this._staticAdsOffset.push(e)},a.prototype.clearAdIds=function(e){this._staticAdsOffset.indexOf(e._offSet)<0&&(this.adIds[e._offSet]=null)},a.prototype._createVastLoader=function(i){var r=this,e=this.config,t=new J(i,this.player,{requestFilter:e.requestFilter,trackingFilter:e.trackingFilter});return this._vloaderQueue.push(t),t.on(de,function(e){var t=r._getVloaderErrorObject(e);r._enqueueAdError(i,t)}),t},a.prototype._getVloaderErrorObject=function(e){var t=e.vloader,i=this.getAdEventObject(t.scheduledAd(),e.url),r=we(e.message,e.code,e.adErrorCode);return ke(i,r),e.wrappedTags&&e.wrappedTags!==e.url&&(e.wrapperAdSystem&&e.wrapperAdSystem.length!==e.wrappedTags.length&&(e.wrapperAdSystem.push(e.adsystem),e.adsystem=""),i.tag=e.wrappedTags.pop(),i.wrappedTags=e.wrappedTags,i.adsystem=e.adsystem,i.wrapperAdSystem=e.wrapperAdSystem),i},a.prototype._enqueueAdError=function(e,t){this._errors.push(t),e._preload||this.dequeueAdErrors()},a.prototype.dequeueAdErrors=function(){var t=this;this._errors.forEach(function(e){return t.trigger(me,e)}),this._errors.splice(0)},a.prototype.removeVastLoader=function(e){var t=this._vloaderQueue.indexOf(e);-1!==t&&(e.destroy(),this._vloaderQueue.splice(t,1))},a.prototype.isDestroyed=function(){return null===this.player},a.prototype.destroy=function(){this.bids.forEach(function(e){return e.stop()}),this._vloaderQueue.forEach(function(e){return e.destroy()}),this.player=null},a}(),It=document.createElement("img"),Et=document.createElement("img");It.src=Et.src='data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="32" fill="%23191919"/><line stroke="%23CCC" stroke-width="6" x1="32" y1="20" x2="32" y2="44"/><line stroke="%23CCC" stroke-width="6" x1="20" y1="32" x2="44" y2="32"/></svg>',It.className="jw-vast-nonlinear-open-button",Et.className="jw-vast-nonlinear-close-button";var St={cursor:"pointer",position:"absolute",margin:"auto",left:0,right:0,bottom:0,display:"block"},Ct="opacity 0.2s",Rt={"-webkit-transition":Ct,transition:Ct};function xt(e,t){be.utils.style(e,{opacity:t||1})}function Mt(e){be.utils.style(e,{opacity:0})}function Vt(){xt(Et)}function Ot(){xt(Et,.75)}function Bt(){xt(It)}function Lt(){xt(It,.5)}var Ht=function(){function s(e,t,i,r,n){g(this,s),this.player=e,this.environment=e.getEnvironment(),this.div=r,this.staticURL=t,this.clickURL=i,this.loadTimer=-1,this.animationTimer=-1,this.banner=null,ke(this,e.Events),this.banner=document.createElement("img"),this.banner.className="jw-banner",this.banner.id=this.player.id+"_vast_static",Mt([Et,It]),this.remove(It),this.div.appendChild(this.banner),this.div.appendChild(Et),this.loadTimer=setTimeout(this.imageLoadError.bind(this),n),this.banner.onerror=this.imageLoadError.bind(this),this.banner.onload=this.onLoaded.bind(this),this.banner.src=this.staticURL}return s.prototype.onLoaded=function(){clearTimeout(this.loadTimer),0!==this.banner.naturalWidth?(this.removeBannerEventListeners(),be.utils.style(Et,{top:-this.banner.height-8,bottom:this.banner.height-8,left:this.banner.width},!0),be.utils.style(It,{top:-16},!0),xt([this.div,this.banner]),xt(Et,.75),new be.utils.UI(this.banner).on("click tap",this.sendClick.bind(this)),this.environment.OS.mobile&&(this.div.onmouseover=Vt,this.div.onmouseout=Ot),Et.onclick=Et.ontouchstart=this.collapse.bind(this),It.onclick=It.ontouchstart=this.expand.bind(this),this.trigger(c)):this.imageLoadError()},s.prototype.imageLoadError=function(){clearTimeout(this.loadTimer),this.trigger(m),this.removeBanner()},s.prototype.sendClick=function(){this.trigger(a)},s.prototype.collapse=function(e){var t=this;-1===this.animationTimer&&(e.preventDefault(),this.div.onmouseover=this.div.onmouseout=null,Mt([this.banner,Et,It]),this.div.appendChild(It),this.animationTimer=setTimeout(function(){t.remove(t.banner),t.remove(Et),xt(It,.5),t.div.onmouseover=Bt,t.div.onmouseout=Lt,t.animationTimer=-1},250))},s.prototype.expand=function(e){var t=this;-1===this.animationTimer&&(e.preventDefault(),this.div.onmouseover=this.div.onmouseout=null,this.div.appendChild(this.banner),this.div.appendChild(Et),this.animationTimer=setTimeout(function(){xt([t.banner,Et]),t.div.onmouseover=Vt,t.div.onmouseout=Ot,t.animationTimer=-1},50),Mt(It))},s.prototype.remove=function(e){this.div.contains(e)&&this.div.removeChild(e)},s.prototype.removeBannerEventListeners=function(){this.banner.onload=this.banner.onerror=null},s.prototype.removeBanner=function(){this.removeBannerEventListeners(),this.remove(this.banner)},s.prototype.removeListeners=function(){clearTimeout(this.loadTimer),clearTimeout(this.animationTimer),this.div.onmouseover=this.div.onmouseout=Et.onclick=It.onclick=null,this.off(),this.removeBannerEventListeners()},s.prototype.stop=function(){Mt([this.div,this.banner,Et,It]),setTimeout(this.removeBanner.bind(this),400),this.remove(Et),this.remove(It)},s}(),qt=function(){function i(e,t){g(this,i),this.player=e,this.div=t,this.startTime=0,this.minDur=0,this.environment=e.getEnvironment(),ke(this,e.Events),this.type="static",e.on("time",this.dispatchTime,this)}return i.prototype.playAd=function(e,t,i,r,n){this.minDur=be.utils.seconds(i),this.adTag=r,this.static&&(this.static.removeListeners(),this.static.stop()),this.div.style.opacity=0,this.div.style.visibility="visible";var s=this.environment.Browser.firefox?{}:Rt;be.utils.style(this.div,be.utils.extend({top:"",position:"absolute",width:"100%"},s)),be.utils.style([Et,It],ke({width:"18px",height:"18px",opacity:.75},St,s)),be.utils.style(Et,{transform:"rotate(45deg)"}),this.static=new Ht(this.player,e,t,this.div,n),this.static.on(c,this.startAd,this),this.static.on(a,this.clickHandler,this),this.static.on(m,this.errorHandler,this)},i.prototype.dispatchTime=function(e){this.trigger(t,e)},i.prototype.startAd=function(){this.startTime=this.player.getPosition(),0<this.minDur&&(0===this.startTime?this.on(t,this.startTimingAd,this):this.on(t,this.timeAd,this)),this.sendEvent(c)},i.prototype.startTimingAd=function(e){this.startTime=e.position,this.off(t,this.startTimingAd,this),this.on(t,this.timeAd,this)},i.prototype.timeAd=function(e){e.position-this.startTime>this.minDur&&(this.off(t,this.timeAd,this),this.stop())},i.prototype.clickHandler=function(){this.sendEvent(a)},i.prototype.errorHandler=function(){this.sendEvent(m)},i.prototype.sendEvent=function(e,t){(t=t||{}).tag=t.tag||this.adTag,this.trigger(e,t)},i.prototype.removeEvents=function(){this.off()},i.prototype.getState=function(){return oe},i.prototype.stop=function(){this.startTime&&this.static&&(this.startTime=0,this.minDur=0,this.off(t,this.startTimingAd,this),this.off(t,this.timeAd,this),this.static.removeListeners(),this.static.stop(),this.sendEvent(f))},i.prototype.pause=function(){},i}(),jt=function(){function i(e,t){g(this,i),this.player=e,this.options=t,this.ignoreStartOnSeek=!1,this.reset(),t.timeBetweenAds&&e.on({adBreakStart:this.handleAdBreakStart,adSkipped:this.handleAdSkipped,adComplete:this.handleAdComplete,adBreakEnd:this.handleAdBreakEnd,destroyPlugin:this.destroy},this)}return i.prototype.clearStartOnSeek=function(){this.ignoreStartOnSeek=!0},i.prototype.sendAdBreakIgnored=function(e,t){var i,r;e&&this.player.trigger(n,(r=t,{id:(i=e)._breakId,tag:i._adQueue&&0<i._adQueue.length?i._adQueue[0]:i._adXML,client:Y,offset:i._offSet,timeSinceLastAd:r,type:n}))},i.prototype.rulesAllowAdPlayback=function(e){var t=this.options,i=0===t.frequency&&1===e,r=e>=t.startOn&&(e-t.startOn)%t.frequency==0;return i||r},i.prototype.handleAdBreakStart=function(){this.adSkipped=!1,this.adComplete=!1},i.prototype.handleAdComplete=function(){this.adComplete=!0},i.prototype.handleAdSkipped=function(){this.adSkipped=!0},i.prototype.handleAdBreakEnd=function(){!this.adSkipped&&this.adComplete&&(this.recentCompletedAdTime=Se())},i.prototype.timeBetweenAdsAllowsAdPlayback=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Se();if(this.options.timeBetweenAds){var i=(t-this.recentCompletedAdTime)/1e3;if(i<this.options.timeBetweenAds)return this.sendAdBreakIgnored(e,i),!1}return!0},i.prototype.reset=function(){this.ignoreStartOnSeek=!1,this.recentCompletedAdTime=0},i.prototype.destroy=function(){this.player.off(null,null,this)},A(i,[{key:"timeBetweenAds",get:function(){return this.options.timeBetweenAds}},{key:"startOnSeek",get:function(){return this.ignoreStartOnSeek?null:this.options.startOnSeek}}]),i}(),Dt={};function Ft(e,r){var n=this,t=Dt[r];return t||(this.jwplayerEntitlements=function(e,t,i){var r={canPlayAds:!0},n=new e.key(t),s=n.edition();if("unlimited"===s)return i(r);var a=n.token(),o=["//","entitlements.jwplayer.com","/",a,".json"];"file:"===window.location.protocol&&o.unshift("https:"),e.ajax(o.join(""),function(e){r.canPlayAds=!e||!e.response||!1!==e.response.canPlayAds,i(r)},function(){i(r)},{timeout:1e4,responseType:"json"})},Dt[r]=new Promise(function(t,i){n.jwplayerEntitlements(e,r,function(e){e.canPlayAds?t():i({message:"Ad Limit Reached"})})}))}(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)(Y,"8.1",function(d,l,t){var u=be.utils=d.utils,h=be._=d._,r=d.getConfig(),e=r.key,n=d.getEnvironment(),s=l.debug&&l.trackFn?l.trackFn:null,p=this,c=null,i=l.bids&&l.bids.settings?l.bids.settings.mediationLayerAdServer||ie:null;if((i===ie||i===re)&&l.bids.bidders){var a=l.bids.bidders;a.length&&(c=ke({},l.bids,{bidders:a}))}var m={},o=!1,f=!1,v=void 0,y=[],g=!1,A=void 0,P=void 0,k=void 0,b=void 0,w=0,_=0,T=!1,I=null,E=!1,S=void 0,C=new Re,R=new jt(d,C.getAdRules(l)),x=new jwplayer.utils.Timer;this.version="8.5.5",this.bidsVersion="0.1.8";var M=new Ce(R),V=C.getSchedule(l,R);if(V.isVMAP()){var O=xe(V.getVMAP(),d,m);V.load(d,O).catch(u.noop)}function B(e){H(),L(e);var t=v;Promise.resolve(e).then(function(){if(!t.isDestroyed())return t.loadAd(e,{adBlock:T})}).then(function(e){return t.isDestroyed()?null:D(e,Pe)}).catch(function(e){return t.isDestroyed()?null:z(e)})}function L(e){var t=v.getVMAPTracker(e),i=v.getAdEventObject(e);b.once("destroyed",function(){x.clear("adBreakStart"),t.breakEnd(),d.trigger(he,i),v&&v.clearAdIds(e)}),x.tick("adBreakStart"),t.breakStart(),d.trigger(pe,i)}function H(){b||(b=d.createInstream().init()).setText(null)}function q(t,e){var i,r,n,s=(r=t,n=e,R.rulesAllowAdPlayback(n)?h.isObject(r)&&r.adschedule?C.getSchedule(r,R):V:M),a=new Tt(d,s,t,l,m);if(a.on(((i={})[[le]]=function(e){return d.trigger(le,e)},i[[ue]]=function(e){return d.trigger(ue,e)},i[[ye]]=W,i[[ve]]=Q,i[[me]]=J,i),p),s.isVMAP()){var o=xe(s.getVMAP(),d,m);s.load(d,o).then(function(e){a.isDestroyed()||e.forEach(function(e){return d.trigger(me,e)})}).catch(function(e){return a.isDestroyed()?null:z(e)})}return a.init(c).then(function(){if(!a.isDestroyed()){var e=a.schedule.getAdScheduleEventObject();e.adbreaks=e.adbreaks.map(function(e){return Te(e,a.schedule,a.bidsResult)}),e.item=t,d.trigger(ge,e)}}),a}function j(){v&&(v.schedule.reset(),v.off(null,null,p),v.destroy(),v=null),F(),X(),U(),R.reset(),d.setCues([]),_=0,f=!1}function D(e,t){if(e){var i=e.scheduledAd();return v.dequeueAdErrors(),"nonlinear"===i._type&&X(),function(n,s){0===n.scheduledAd()._waterfallIndex&&U(),v.removeVastLoader(n);var e=new Promise(function(e,t){var i=new Ie(n,d,P,k,v,m);i.on(me,t),i.on(fe,N),i.on(de,J);var r=i.init(b,s);if(!r)return i.destroy(),e();A=b,b=null,i.on(ce,e),i.on(Ae,e),y.push(i)}),t=v;return e.catch(function(e){if(!t.isDestroyed())return b=b||A,t.adWaterfall(n,{adBlock:T},e).then(function(e){return t.isDestroyed()?null:D(e,s)})})}(e,t)}X()}function F(){y.forEach(function(e){return e.destroy()}),y.splice(0)}function N(e){$(e)&&(x.tick("adImpression"+e.id),e.timeLoading=x.between("adBreakStart","adImpression"+e.id)),Te(e,v.schedule,v.bidsResult),d.trigger(fe,e)}function U(){y.length&&y[y.length-1].clearNonlinear()}function X(){if(b||A){var e=b||A;b=null,e.destroy()}A=null}function Q(e){var t=e.id;x.tick("adLoaded"+t),e.timeLoading=x.between("adLoading"+t,"adLoaded"+t),d.trigger(ve,e)}function W(e){Te(e,v.schedule,v.bidsResult),d.trigger(ye,e),x.tick("adLoading"+e.id)}function z(e){v.dequeueAdErrors(),J(e),F(),X()}function J(e){$(e)&&(x.tick("adError"+e.id),e.timeLoading=x.between("adBreakStart","adError"+e.id)),ke(e,{client:Y}),v.vmapTracker&&v.vmapTracker.error(e.code),Te(e,v.schedule,v.bidsResult),50004!==e.adErrorCode&&50901!==e.adErrorCode||!d.getAdBlock()||(T=!0),o?d.trigger(me,e):d.once("playlistItem",function(){d.trigger(me,e)},p)}function $(e){return void 0===e.podcount||1===e.sequence}function K(e){var t=e.getMidRolls(),i=[];t.length&&u.foreach(t,function(e,t){"nonlinear"!==t._type&&i.push({begin:t._offSet,text:m.cuetext})}),d.setCues(i)}ke(this,d.Events),u.addClass(t,"jw-plugin-vast"),d.on({ready:function(){var i=this;if(o=!0,P=new qt(d,t),k=new Ee(s,n),r.localization=d.getConfig().localization,(m=C.getOptParams(l,r.localization.advertising)).debugTrackFn=s,G.catch(function(e){j(),d.off(null,null,i),d.playAd=u.noop;var t=we("Ad Error: "+e.message,null,60002);t.code=void 0,t.id=Z,t.client=Y,t.tag="",d.trigger(me,t)}),l.preloadAds){var e=d.getPlugin("related");e&&e.on("nextUp",function(e){e&&"discovery"===e.mode&&(S=e)})}},beforePlay:function(i){if(!g&&!f){f=!0,v.bids.forEach(function(e){return e.timeout()});var t=(i||{}).startTime||d.getPosition();_=t||_;var e=v.schedule.getPreRoll(t);if(e||v.vmapPromise){(null!==v.vmapPromise||e&&"nonlinear"!==e._type)&&H();var r=v;r.bidsPromise.then(function(){if(!r.isDestroyed()){var e=r.schedule.getPreRoll(t);e&&"nonlinear"!==e._type&&L(e)}}),t?"none"===R.startOnSeek&&(v._preRollPromise=null):R.clearStartOnSeek(),r.loadPreRoll({adBlock:T,startTime:t}).then(function(e){var t=i&&i.playReason?i.playReason:Pe;return r.isDestroyed()?null:D(e,t)}).catch(function(e){return r.isDestroyed()?null:z(e)})}}},cast:function(e){g=!!e.active},play:function(e){p.trigger(oe,e)},time:function(e){if(!g&&0!==e.duration){var t=v.schedule.getNextMidrollIndex(_,e.position,e.duration);if(_=e.position,null!==t){var i=v.schedule.getMidRollAtIndex(t);"nonlinear"!==i._type&&(H(),L(i));var r=v;r.loadMidRollAtIndex(t,{adBlock:T}).then(function(e){return r.isDestroyed()?null:D(e)}).catch(function(e){return r.isDestroyed()?null:z(e)})}else if(l.preloadAds){var n=e.position+ae,s=v.schedule.peek(e.position,n,e.duration);if(null!==s&&0<=s)v.loadMidRollAtIndex(s,{adBlock:T,preload:!0}).catch(u.noop);else if(-1===s){var a=Se()+1e3*(e.duration-e.position);v.loadPostRoll({adBlock:T,preload:!0,startTime:a}).catch(u.noop)}else if(null===I&&n>e.duration){var o=d.getPlaylistItem(d.getPlaylistIndex()+1);E=!o,(o||S)&&((I=q(o||S,w+1)).loadPreRoll({adBlock:T,preload:!0}).catch(u.noop),S=null)}}}},beforeComplete:function(){if(!g){var e=v.schedule.getPostRoll();if(e){"nonlinear"!==e._type&&(H(),L(e));var t=v;t.loadPostRoll({adBlock:T}).then(function(e){return t.isDestroyed()?null:D(e)}).catch(function(e){return t.isDestroyed()?null:z(e)})}}},playlistItem:function(e){w+=1,j();var t=d.getPlaylistItem(e.index);if(I&&t!==I.item&&!1===E&&(I.off(null,null,p),I.destroy(),I=null),v=I||q(t,w),I=null,v.schedule.isVMAP()?v.vmapPromise.then(function(){v.isDestroyed()||K(v.schedule)}).catch(u.noop):K(v.schedule),l.preloadAds&&1===w){var i=r.autostart;!1===i||i===se&&0===d.getViewable()?v.loadPreRoll({adBlock:T,preload:!0}).catch(u.noop):d.once(ne,function(){v.loadPreRoll({adBlock:T,preload:!0}).catch(u.noop)})}},playlistComplete:j,complete:function(){U(),f=!1},destroyPlugin:j},this),d.pauseAd=function(e,t){if(e="boolean"!=typeof e||e,y.length){var i=y[y.length-1];e?i.pause(t||{}):i.play(t||{})}},d.playAd=function(e){U();var t=void 0,i=0===m.requestTimeout?1/0:m.requestTimeout,r=0===m.creativeTimeout?1/0:m.creativeTimeout;t=Array.isArray(e)?e.slice(0):[e];var n,s={_id:_e(12),_adQueue:t,_waterfallIndex:0,_offset:0,_position:(n=d,n.isBeforePlay()||0===n.getPosition()&&"idle"===n.getState()?"pre":n.isBeforeComplete()||n.getPosition()===n.getDuration()?"post":"mid"),requestTimeout:i||ee,creativeTimeout:r||te};v?B(s):d.once("playlistItem",function(){return B(s)})};var G=Ft.call(this,u,e);G.catch(u.noop),this.destroy=j})}();
