!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[5717],{1539:(e,a,t)=>{t.d(a,{Z:()=>x});var s=t(54138),r=t.n(s),n=t(5754),i=t.n(n),l=t(95004),o=t(44009),c=t(98181),d=t(91086),u=t(11476),p=t(63583),h=t.n(p);let m={alert:"yFmaH",icon:"n8yJq",leftContent:"O2b5p",details:"u8HQ3",title:"agHCR",message:"sPAXn",actions:"dhNbz",action:"B8pBx",seperator:"UFrll"};var b=t(2629),g=e=>{switch(e){case"success":return{background:h().glassGreen15};case"warning":return{background:h().betamaxOrange15};case"error":return{background:h().rokrRed15};default:return{background:h().dreamcastBlue15}}},f=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;switch(e){case"success":return v(null!=a?a:(0,b.jsx)(c.Z,{colors:{primary:h().paletteGreen}}),h().glassGreen);case"warning":return v(null!=a?a:(0,b.jsx)(u.Z,{colors:{primary:h().paletteOrange}}),h().betamaxOrange);case"error":return v(null!=a?a:(0,b.jsx)(u.Z,{colors:{primary:h().paletteRed}}),h().rokrRed);default:return v(null!=a?a:(0,b.jsx)(d.Z,{colors:{primary:h().paletteBlue}}),h().dreamcastBlue)}},v=let x=e=>{var a=e.theme,t=e.title,s=e.message,n=e.wrapperClassName,l=e.firstAction,c=e.secondAction,d=e.icon,u=e.children;return(0,b.jsxs)("div",{style:r()({},g(a)),className:i()(m.alert,n),children:[(0,b.jsx)("div",{className:m.leftContent,children:(0,b.jsx)("div",{className:m.icon,children:d?f(a,d):f(a)})}),(0,b.jsxs)("div",{className:m.details,children:[t&&(0,b.jsx)("label",{className:m.title,children:t}),(0,b.jsx)("label",{className:m.message,children:s}),u?(0,b.jsx)("div",{children:u}):void 0,l&&(0,b.jsxs)("div",{className:m.actions,children:[(0,b.jsx)(o.Z,{label:l[0],onClick:l[1],children:(0,b.jsx)("h2",{className:m.action,children:l[0]})}),c&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("label",{className:m.seperator,children:"•"}),(0,b.jsx)(o.Z,{label:c[0],onClick:c[1],children:(0,b.jsx)("h2",{className:m.action,children:c[0]})})]})]})]})]})}},85085:(e,a,t)=>{t.d(a,{Z:()=>j});var s=t(50209),r=t.n(s),n=t(95004),i=t(5754),l=t.n(i),o=t(36343),c=(0,o.q)("badge-ask");c.defaultProps={size:{width:14,height:14}};var d=t(72314),u=(0,o.q)("badge-follow");u.defaultProps={size:{width:14,height:14}};var p=(0,o.q)("badge-like");p.defaultProps={size:{width:14,height:14}};var h=(0,o.q)("badge-mention");h.defaultProps={size:{width:14,height:14}};var m=(0,o.q)("post-flagged");m.defaultProps={size:{width:14,height:14}};var b=(0,o.q)("badge-reblog");b.defaultProps={size:{width:14,height:14}};var g=(0,o.q)("badge-reply");g.defaultProps={size:{width:14,height:14}};var f=(0,o.q)("badge-tip");f.defaultProps={size:{width:14,height:14}};var v=t(17901);let x={whiteIcon:"CvcGO",border:"fe_1j",badge:"D9Rbd"};var w=t(2629);class y extends n.Component{render(){var e=this.props,a=e.icon,t=e.backgroundColor;return(0,w.jsx)("div",{className:x.badge,style:{backgroundColor:t},children:a})}}r()(y,"ofType",(e,a)=>{switch(e){case v.w.PostCommunityLabel:case v.w.Reblog:case v.w.Like:case v.w.Reply:case v.w.Follower:case v.w.Ask:case v.w.Tip:case v.w.Blaze:return y[e](a);case v.w.UserMention:case v.w.NoteMention:return y.mention(a);default:return null}}),r()(y,"reblog",e=>(0,w.jsx)("div",{children:(0,w.jsx)(b,{className:l()(x.whiteIcon,{[x.border]:null==e?void 0:e.withBorder})})})),r()(y,"like",e=>(0,w.jsx)("div",{children:(0,w.jsx)(p,{className:l()(x.whiteIcon,{[x.border]:null==e?void 0:e.withBorder})})})),r()(y,"reply",e=>(0,w.jsx)("div",{children:(0,w.jsx)(g,{className:l()(x.whiteIcon,{[x.border]:null==e?void 0:e.withBorder})})})),r()(y,"follower",e=>(0,w.jsx)("div",{children:(0,w.jsx)(u,{className:l()(x.whiteIcon,{[x.border]:null==e?void 0:e.withBorder})})})),r()(y,"mention",e=>(0,w.jsx)("div",{children:(0,w.jsx)(h,{className:l()(x.whiteIcon,{[x.border]:null==e?void 0:e.withBorder})})})),r()(y,"ask",e=>(0,w.jsx)("div",{children:(0,w.jsx)(c,{className:l()({[x.border]:null==e?void 0:e.withBorder})})})),r()(y,"tip",e=>(0,w.jsx)("div",{children:(0,w.jsx)(f,{className:l()(x.whiteIcon,{[x.border]:null==e?void 0:e.withBorder})})})),r()(y,"blaze",e=>(0,w.jsx)("div",{children:(0,w.jsx)(d.Z,{className:l()(x.whiteIcon,{[x.border]:null==e?void 0:e.withBorder})})})),r()(y,"postcommunitylabel",e=>(0,w.jsx)("div",{children:(0,w.jsx)(m,{className:l()(x.whiteIcon,{[x.border]:null==e?void 0:e.withBorder})})}));let j=y},72314:(e,a,t)=>{t.d(a,{Z:()=>r});var s=(0,t(36343).q)("badge-blaze");s.defaultProps={size:{width:14,height:14}};let r=s},91086:(e,a,t)=>{t.d(a,{Z:()=>r});var s=(0,t(36343).q)("info-circle");s.defaultProps={size:{width:24,height:24}};let r=s},37560:(e,a,t)=>{t.d(a,{Z:()=>c});var s=t(50209),r=t.n(s),n=t(95004),i=t(36485),l=t(2629);class o extends n.Component{render(){var e=this.props,a=e.className,t=e.src,s=e.title,r=e.queryParams,n=e.scrolling,o=e.frameBorder,c=e.style,d=e.onLoad,u=e.placementId,p=e.allow,h=e.allowFullScreen;return(0,l.jsx)("iframe",{className:a,name:u,title:s,src:(0,i.Z)(t,r),scrolling:n,frameBorder:o,style:c,onLoad:d,allow:p,allowFullScreen:h})}}r()(o,"defaultProps",{className:"",queryParams:{},scrolling:"no",frameBorder:0});let c=o},48678:(e,a,t)=>{t.r(a),t.d(a,{default:()=>R,successfulCheckoutSignal:()=>E});var s=t(33970),r=t.n(s),n=t(5754),i=t.n(n),l=t(95004),o=t(1539),c=t(45222),d=t(85085),u=t(2474),p=t(98478),h=t(37560),m=t(6135),b=t(18488),g=t(17276),f=t.n(g),v=t(33590),x=t(68087),w=t(78667),y=t(88926),j=t(2629);let k=e=>{var a=e.isSelected,t=e.onClickAmount,s=e.tippingAmount,r=(0,w.bp)(),n=r._c,o=r._getPriceInCurrency,c=(0,l.useCallback},[t,s]),d=s.sku===x.Jd?n("Label for a button that allows a user to enter a free-form, custom tip amount","Custom"):(0,y.T4)(s.priceCents,"USD",o);return(0,j.jsxs)("button",{onClick:c,className:i()("S3oJu",{c5N5n:a}),role:"tab","aria-selected":a,"aria-labelledby":d,children:[(0,j.jsx)("img",{srcSet:`${s.icons[2].url} ${s.icons[2].width}w, ${s.icons[1].url} ${s.icons[1].width}w`,sizes:`(min-resolution: 1.3) ${s.icons[2].width}w, ${s.icons[1].width}w`,src:s.icons[1].url,style:{width:s.icons[1].width},alt:""}),(0,j.jsx)("span",{className:"iIxf7",id:d,children:d})]},s.sku)};var C=t(54382),N=t(93613),P=t(63583),S=t.n(P);let Z={amounts:"G6eCM",customAmount:"Li42W",header:"USbmT",close:"VaU0f",displayAmount:"Ye4RL",currencyWrapper:"wL4PL",currency:"pSFCY",isHidden:"ABFVo"},L=e=>{var a=e.onSetAmount,t=e.onInvalidTip,s=(0,w.bp)(),n=s._c,o=s._getPriceInCurrency,c=s.apiFetch,d=(0,N.V)().toggleToast,u=(0,l.useState)(0),h=r()(u,2),b=h[0],g=h[1],P=(0,l.useState)(!1),L=r()(P,2),_=L[0],B=L[1],T=(0,l.useState)(""),z=r()(T,2),A=z[0],U=z[1],I=(0,l.useState)(!1),D=r()(I,2),M=D[0],F=D[1],E=(0,v.a)({queryKey:["tipping-amounts"],queryFn:()=>{var e;return f()().async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f()().awrap(c("/v2/tipping/price_points"));case 2:return e=a.sent.response,a.abrupt("return",e);case 5:case"end":return a.stop()}},null,null,null,Promise)},staleTime:36e5,refetchOnMount:"always"}),R=(0,l.useCallback)((e,s)=>{if(E.data){var r=!1;Number.isNaN(e)&&(r=!0);var n=E.data,i=n.tipPriceLimits,l=i.minCents,c=i.maxCents,u=n.dailyTipAmountRemainingCents;e>c||e<l?(d((0,j.jsx)(C.ZP,{params:{min:(0,y.T4)(l,"USD",o),max:(0,y.T4)(c,"USD",o)},children:"Tip amount should be between [min] and [max]"}),"error",s),r=!0):e>u&&(d((0,j.jsx)(C.ZP,{params:{remaining:(0,y.T4)(u,"USD",o)},children:"Daily tip amount remaining: [remaining]"}),"error",s),r=!0),t(r),a(e)}},[o,E,a,d,t]),q=(0,l.useCallback)(e=>{var a=e.target.value,t=/[0-9.]/,s=a.split("").ma)).join("");R(Math.round(100*parseFloat(s)),x.Jd),U(`$${s}`),F(!0)},[R]),$=(0,l.useCallback)(()=>{M||(U("$"),t(!0))},[M,t]),G=(0,l.useCallback},[b,a]),W=(0,l.useCallback)(e=>{if(R(e.priceCents,e.sku),x.Jd===e.sku){B(!0),U((0,y.T4)(e.priceCents,"USD",o));return}g(e.priceCents)},[R,o]),Y=(0,l.useCallbackb,[b]);if((0,l.useEffect)(()=>{E.isSuccess&&!b&&W(E.data.tipPricePoints[0])},[E,b,W]),E.isPending)return(0,j.jsx)("div",{children:(0,j.jsx)(m.Z,{})});if(!E.isSuccess||!E.data)return null;var H=E.data.tipPricePoints;return(0,j.jsxs)("div",{className:Z.amounts,children:[(0,j.jsxs)("div",{className:i()(Z.customAmount,{[Z.isHidden]:!_}),"data-testid":"customAmount",children:[(0,j.jsx)("header",{className:Z.header,children:(0,j.jsx)(C.ZP,{comment:"Title for a screen where a user can enter a custom tip amount",children:"Custom Amount"})}),(0,j.jsx)("input",{className:Z.displayAmount,type:"text",value:A,onChange:q,onFocus:$,title:n("title of text input where a user can enter a custom tip amount","Enter a custom amount")}),(0,j.jsx)("div",{className:Z.currencyWrapper,children:(0,j.jsx)("span",{className:Z.currency,children:"USD"})}),(0,j.jsx)("button",{className:Z.close,onClick:G,"aria-label":n("label for a button where a user can close a form where they enter a custom tip amount","Remove custom amount"),children:(0,j.jsx)(p.Z,{size:{width:10,height:10},colors:{primary:S().paletteGray65}})})]}),(0,j.jsx)("div",{className:i()({[Z.isHidden]:_}),children:H.map(e=>(0,j.jsx)(k,{tippingAmount:e,isSelected:Y(e),onClickAmount:W},e.sku))})]})};var _=t(15608),B=t(34438),T=t(37236),z=t(43523),A=t(17901),U=t(85795),I=t(22424),D=t(399),M=t(68782);let F={tippingForm:"_cgy7",wrapper:"kx1rz",hidden:"MrcPV",title:"v4bMH",closeButton:"XowdV",backButton:"oWVDl",flex:"dvxux",anonymousLabel:"BOK98",messageWrapper:"uAmIP",editorWrapper:"sa00V",disabled:"sUS_9",messageInfo:"H_wbp",alertWrapper:"uVUFJ",iframe:"TPxWA"};var E="after-checkout";let R=e=>{var a=e.avatar,t=e.blogname,s=e.canDoReply,n=e.postId,g=e.onClose,f=e.replyText,v=(0,w.bp)(),x=v.apiFetch,y=v._c,k=v._t,P=(0,I.wL)().logEvent,Z=(0,N.V)().toggleToast,R=(0,l.useState)(0),q=r()(R,2),$=q[0],G=q[1],W=(0,l.useState)(f),Y=r()(W,2),H=Y[0],O=Y[1],V=(0,l.useState)(!1),J=r()(V,2),K=J[0],Q=J[1],X=(0,l.useState)(!1),ee=r()(X,2),ea=ee[0],et=ee[1],es=(0,l.useState)(void 0),er=r()(es,2),en=er[0],ei=er[1],el=(0,l.useState)(!1),eo=r()(el,2),ec=eo[0],ed=eo[1],eu=(0,l.useState)(!1),ep=r()(eu,2),eh=ep[0],em=ep[1];(0,l.useEffect));var eb=(0,j.jsx)("a",{href:"https://tumblr.zendesk.com/hc/articles/4417356885527",target:"_blank",rel:"noopener noreferrer"}),eg=e=>{e.data===E&&(P({eventName:z.J.TipPaymentSuccess,eventDetails:{type:"web",anonymous:ea,hasMessage:!!H,amount:$}}),g(),Z((0,j.jsx)(C.ZP,{comment:"Message a user sees after successfully tipping an other user",params:{blogname:t},children:"You did that! Thanks for tipping [blogname]! Your generosity will help support them while they create more weird and wonderful content for us to enjoy."}),"success"))},ef=(0,l.useCallback)(()=>{Q(!0),ed(!0),(0,U.ZP)(x).generateTippingCheckoutUrl(t,{tip_amount_cents:$,is_anonymous:ea,post_id:n,tip_message:H,host:window.location.host,path:(0,B.SS)({peeprBlogname:t,peeprPostId:null==n?void 0:n.toString()})}).fetch().the}).catch(()=>{Q(!1),ed(!1),Z((0,M.U)((0,D.Pk)(k)),"error")})},[k,$,x,t,ea,H,n,Z]),ev=(0,l.useCallback},[]),ex=(0,l.useCallback},[]),ew=(0,l.useCallback),[g]);return(0,j.jsxs)("div",{className:F.tippingForm,children:[!en&&(0,j.jsx)("h2",{className:F.title,children:(0,j.jsx)(C.ZP,{comment:"Message shown on the header of the dialog that lets users choose the amount they want to tip",params:{blogname:t},children:"Tip [blogname]"})}),en&&(0,j.jsx)("button",{className:F.backButton,"aria-label":y("Label for a button that will allow a user to change their tip before completing the transaction","Go back and edit your tip"),onClick:ev,children:(0,j.jsx)(u.Mq,{colors:{primary:S().paletteGray65},size:{width:13,height:13}})}),(0,j.jsx)("button",{onClick:ew,className:F.closeButton,"aria-label":y("Label for a button that will allow a user to cancel their tip before completing the transaction","Cancel tip"),children:(0,j.jsx)(p.Z,{colors:{primary:S().paletteGray65},size:{width:13,height:13}})}),(0,j.jsxs)("div",{className:i()(F.wrapper,{[F.hidden]:void 0!==en}),children:[(0,j.jsx)(L,{onSetAmount:G,onInvalidTip:em}),(0,j.jsxs)("div",{className:F.flex,children:[(0,j.jsx)("span",{id:"anonymousLabel",className:F.anonymousLabel,children:y("Label for a toggle that allows a user to tip an other user anonymously","Give anonymously")}),(0,j.jsx)(_.Z,{controlled:!0,labelledBy:"anonymousLabel",checked:ea,onChange:()=>{ee),O("")}})]}),(0,j.jsxs)("div",{className:i()(F.messageWrapper,F.flex),children:[(0,j.jsx)(c.Z,{imageResponse:a,dimension:36,avatarShape:T.o.Circle,badge:d.Z.ofType(A.w.Reply),isAnonymous:ea,badgeBorder:!0}),(0,j.jsx)("input",{className:i()(F.editorWrapper,{[F.disabled]:ea||!s}),disabled:ea||!s,maxLength:475,placeholder:y("Placeholder for a text input that allows a user to leave message while tipping an other user","Add a message (optional)"),onChang},readOnly:ea,value:H})]}),!s&&(0,j.jsx)(o.Z,{wrapperClassName:F.alertWrapper,theme:"info",message:(0,j.jsx)(C.ZP,{comment:"Alert text notifying user that replies have been disabled for the recipient blog, they cannot add a custom message.",components:{helpLink:eb},children:"Messages have been disabled for this blog. [helpLink]Questions[/helpLink]?"})}),ea&&s&&(0,j.jsx)(o.Z,{wrapperClassName:F.alertWrapper,theme:"info",message:(0,j.jsx)(C.ZP,{comment:"Alert text notifying user that if they chose to tip anonymously, they cannot add a custom message.",components:{helpLink:eb},children:"You can’t message anonymously. [helpLink]Questions[/helpLink]?"})}),s&&!ea&&(0,j.jsxs)("p",{className:F.messageInfo,children:[n&&(0,j.jsx)(C.ZP,{comment:"Label for a text input",components:{helpLink:eb},children:"Your message will be added to the post replies and visible to everyone on or off Tumblr. [helpLink]Questions[/helpLink]?"}),!n&&(0,j.jsx)(C.ZP,{comment:"Label for a text input",components:{helpLink:eb},params:{blogname:t},children:"Your message will be sent to [blogname]. [helpLink]Questions[/helpLink]?"})]}),(0,j.jsx)(b.Z,{size:"entireWidth",onClick:ef,textColor:S().paletteWhite,backgroundColor:S().paletteAccent,disabledBackgroundColor:S().paletteAccentTransparent25,disabledTextColor:S().paletteTransparentWhite25,disabled:K||eh,isRounded:!0,children:y("label for a button that brings user to a checkout page","Next")})]}),ec&&(0,j.jsx)("div",{className:F.iframe,children:(0,j.jsx)(m.Z,{centerOrientation:"horizontalAndVertical",color:S().paletteGray40})}),en&&(0,j.jsx)(h.Z,{className:i()(F.iframe,{[F.hidden]:ec}),title:"checkout",src:en,scrolling:"auto",onLoad:ex})]})}},15608:(e,a,t)=>{t.d(a,{Z:()=>h});var s=t(50209),r=t.n(s),n=t(5754),i=t.n(n),l=t(95004),o=t(45051),c=t(63583);let d={toggle:"Bs6U3",small:"KDgcr",switch:"xmMz6",slider:"UZrDG",checked:"U_rPn",medium:"Ld5wO",large:"gcGa_",disabled:"RHCmM"};var u=t(2629);class p extends l.PureComponent{constructor(){super(...arguments),r()(this,"state",{checked:!!this.props.checked}),r()(this,"stopEventPropagati))}),r()(this,"toggle",e=>{this.props.controlled||this.setStd})),this.props.onChange(e)})}render(){var e=this.props.controlled?this.props.checked:this.state.checked,a=this.props,t=a.name,s=a.color,r=a.className,n=a.size,l=a.disabled,o=a.labelledBy,c=a.id,p=e?{backgroundColor:s}:void 0;return(0,u.jsx)("div",{className:i()("Bs6U3",r,d[n]),children:(0,u.jsxs)("label",{className:"xmMz6",children:[(0,u.jsx)("input",{type:"checkbox","aria-checked":e,onChange:this.toggle,onClick:this.stopEventPropagation,disabled:l,checked:e,name:t,"aria-labelledby":o,id:c,"data-testid":this.props["data-testid"]}),(0,u.jsx)("span",{style:p,className:i()("UZrDG",{RHCmM:l,U_rPn:e})})]})})}}r()(p,"defaultProps",{onChange:o.Z,checked:!1,disabled:!1,size:"medium",color:c.paletteBlue});let h=p},88926:(e,a,t)=>{t.d(a,{Ar:()=>v,C5:()=>c,GX:()=>f,PP:()=>m,Pz:()=>u,T4:()=>p,VU:()=>h,aJ:()=>d,o$:()=>b,pZ:()=>g=>o});var s=t(67023),r=t(52153),n=t(42946),i=t(4870),l=t(78667);function o(e){return e.includes("refresh=tru")}function d(e,a){return`${Math.floor((e-a)/e*100)}`}function u(e){var a,t=e.response,s=t.cardNetwork,r=t.expiryMonth,n=t.expiryYear,i=t.lastFour,l=t.links,o=t.type;return{ccNumber:i&&`•••• ${i}`,ccType:s,ccExpiryMonth:r,ccExpiryYear:n,isInvalid:(()=>{if("paypal"===o)return!1;if(!i||!s||!r||!n)return!0;var e=new Date,a=new Date;return a.setMonth(r),a.setDate(-1),a.setFullYear(n),e>a})(),type:o,updateUrl:(null==l||null===(a=l.updatePaymentMethodUrl)||void 0===a?void 0:a.href)||""}}var p=(e,a,t)=>t(e/100,a),h=(e,a)=>{var t=(0,l.bp)()._c,s=m(e);return e.period===i.zF.Year?a?t("Subscription price per year","%1$s/year",[s]):t("Subscription price per year (abbreviated)","%1$s/yr",[s]):a?t("Subscription price per month","%1$s/month",[s]):t("Subscription price per month (abbreviated)","%1$s/mo",[s])},m=e=>{var a=(0,l.bp)()._getPriceInCurrency;return p(e.price,e.currencyCode,a)},b=function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.C.Notes,r=(0,l.bp)()._getLocaleDateString,n=e[a];return n?r(new Date(1e3*nSuccessful}function f(e){return e.stripeDashboardUrl?e.stripeDashboardUrl:e.stripeKycUrl?e.stripeKycUrl:null}function v(e){var a=e.startTime;if(e.status!==i.Ti.OnHold)return!1;var t=5*n.y.Minute;return Date.now()/1e3-a<t}}}]);