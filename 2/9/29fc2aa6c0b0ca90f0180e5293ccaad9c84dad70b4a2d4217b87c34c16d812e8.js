!this,(function(e){"use strict";
/** @preserve ESPN WatchSDK 4.5.10 */typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};ar _=I((),P=Object.freeze({__proto__:null,default:_,__moduleExports:_}),S=I((function(e,t){
/*!
   * @overview es6-promise - a tiny implementation of Promises/A+.
   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
   * @license   Licensed under MIT license
   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
   * @version   v4.2.8+1e68dce6
   */
e.exports=function(){ar t=Array.isArray?Array.isArray:n=0,i=void 0,r=void 0,a=s="undefined"!=typeof window?window:void 0,o=s||{},c=o.MutationObserver||o.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;ar h=new Array(1e3);ar f,m,g,y,v=void 0;v=function(){return process.nextTick(p)}:c?(m=0,g=new c(p),y=document.createTextNode(""),g.observe(y,{characterData:!0}),v=:l?((f=new MessageChannel).port1.onmessage=p,v=:v=void 0===s?):d();var _=Math.random().toString(36).substring(2);function P(){}ar L=);var j=);return j.prototype.then=b,j.all=j.race=j.resolve=I,j.reject=j._setScheduler=function(e){r=e},j._setAsap=j._asap=a,j.polyfill=j.Promise=j,j}()}));function T(e,t){return t=t||{},new S((function(n,i){var r=new XMLHttpRequest;for(var a in r.open(t.method||"get",e,!0),t.headers)r.setRequestHeader(a,t.headers[a]);function s(){var e,t=[],n=[],i={};return r.getAllResponseHeaders().replace(/^(.*?):\s*?([\s\S]*?)$/gm,(),{ok:2==(r.status/100|0),status:r.status,statusText:r.statusText,url:r.responseURL,clone:s,text:json:function(){return S.resolve(r.responseText).then(()},blob:headers:{keys:function(){return t},entries:get:has:}}r.withCredentials="include"===t.credentials,r.onload=r.onreadystatechange=function(){try{4===r.readyState&&(200===(e=r).status||201===e.status||202===e.status||204===e.status||0===e.status&&e.responseText&&""!==e.responseText?n(s()):i(s()))}catch(e){r.abort()}var e},r.onerror=i,r.send(t.body)}))}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var k=ar E=M=I((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var s=n[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],r=function(t){t=t;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},a=0;a<t;a+=4){var o=r(4294967296*(n||e.random()));n=987654071*o(),i.push(4294967296*o()|0)}return new s.init(i,t)}}),o=i.enc={},c=o.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(n,t/2)}},u=o.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(n,t)}},l=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),c=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,u=e.min(4*c,r);if(c){for(var l=0;l<c;l+=a)this._doProcessBlock(i,l);var d=i.splice(0,c);n.sigBytes-=u}return new s.init(d,u)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(r.Hasher=d.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math),n)})),L=I((function(e,t){var n,i,r;e.exports=(i=(n=r=M).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],a=0;a<n;a+=3)for(var s=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<n;o++)r.push(i.charAt(s>>>6*(3-o)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var o=e.indexOf(s);-1!==o&&(t=o)}return function(e,t,n){for(var r=[],a=0,s=0;s<t;s++)if(s%4){var o=n[e.charCodeAt(s-1)]<<s%4*2,c=n[e.charCodeAt(s)]>>>6-s%4*2;r[a>>>2]|=(o|c)<<24-a%4*8,a++}return i.create(r,a)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)})),j=I((function(e,t){e.exports=M.enc.Utf8}));ar x,R="live",F="vod",H="accountId",B="applicationId",z="applicationPlatform",V="channel",G="contentType",q="contractType",K="deviceModel",W="hba",Y="mobileDevice",J="programmerName",Q="ship",$="region",X=function(){function e(e,t,n,i,r){t&&n&&i&&(this.programmer=e,this.applicationId=t,this.identityProvider=encodeURIComponent(n),this.subject=encodeURIComponent(i),this.metadata=r||{},this.serviceUrl="https://streams.adobeprimetime.com/v2",this.requestHeaders=U(t),this.heartbeatIntervalId=null,this.messages={})}return e.fetchMetadataKeys=function(t,n){return C(this,void 0,void 0,(function(){var i,r,a,s,o,c;return O(this,(function(u){switch(u.label){case 0:i=n+"/metadata",r=U(t),a={method:"GET",headers:r},u.label=1;case 1:return u.trys.push([1,5,,6]),[4,T(i,a)];case 2:return(s=u.sent())?[4,s.json()]:[3,4];case 3:return o=u.sent(),e.setLocalStorageByAppID(o,t),[2,!0];case 4:return[2,!1];case 5:return c=u.sent(),console.log("fetchMetadataKeys error: "+c),[2,!1];case 6:return[2]}}))}))},e.setLocalStorageByAppID=Object.defineProperty(e.prototype,"metadataKeys",{get:enumerable:!1,configurable:!0}),e.prototype.getMetadataKeysFromLocalStorage_=function(e){var t="AdobeCM.metadata."+e,n=[];try{n=JSON.parse(localStorage.getItem(t))||[]}catch(e){console.error("AdobeCM getMetadataKeys error: "+e)}return n},e.prototype.start=function(){return C(this,void 0,void 0,(function(){var e;return O(this,(function(t){switch(t.label){case 0:return[4,this.createSession()];case 1:return(e=t.sent())?(this.scheduleHeartbeat(),[2,e]):[2,null]}}))}))},e.prototype.startWithSession=e.prototype.stop=e.prototype.createSession=function(e){return void 0===e&&(e=[]),C(this,void 0,void 0,(function(){var t,n,i,r,a,s,o,c,u,l;return O(this,(function(d){switch(d.label){case 0:_.debug("AdobeConcurrencyMonitorV2.createSession"),t=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject,n=E({"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.requestHeaders),e.length>0&&(n["X-Terminate"]=e.join(",")),i=this.getMetadata(),r=Object.keys(i).map((function(e){return e+"="+encodeURIComponent(i[e])})).join("&"),a={method:"POST",headers:n,body:r},d.label=1;case 1:return d.trys.push([1,3,,5]),[4,this.fetchRequest(t,a,!0)];case 2:if(!(s=d.sent()))throw"fetchRequest failed";if(o=s.sessionId)return this.sessionId=o,_.debug("AdobeConcurrencyMonitorV2.createSession sessionId:",o),[2,o];throw c=s.status,u=s.json,{status:c,json:u};case 3:return l=d.sent(),_.error("AdobeConcurrencyMonitorV2.createSession error: ",l),[4,this.handleError(l,!1)];case 4:return[2,d.sent()];case 5:return[2]}}))}))},e.prototype.heartbeat=function(){return C(this,void 0,void 0,(function(){var e,t,n,i,r,a,s;return O(this,(function(o){switch(o.label){case 0:if(!(e=this.sessionId))return[2];_.debug("AdobeConcurrencyMonitorV2.heartbeat",e),t=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+e,n={method:"POST",headers:this.requestHeaders},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchRequest(t,n,!1)];case 2:if(!(i=o.sent()))throw"fetchRequest failed";if(i.error)throw r=i.status,a=i.json,{status:r,json:a};return this.scheduleHeartbeat(),[3,4];case 3:return s=o.sent(),_.error("AdobeConcurrencyMonitorV2.heartbeat error: ",s),[2,this.handleError(s,!0)];case 4:return[2]}}))}))},e.prototype.scheduleHeartbeat=function(){var e=this;_.debug("AdobeConcurrencyMonitorV2.scheduleHeartbeat"),clearTimeout(this.heartbeatIntervalId),this.heartbeatIntervalId=window.setTimeout((function(){e.heartbeat()}),45e3)},e.prototype.fetchRequest=function(e,t,n){return C(this,void 0,void 0,(function(){var i,r,a,s,o;return O(this,(function(c){switch(c.label){case 0:return c.trys.push([0,4,,7]),[4,T(e,t)];case 1:return i=c.sent(),(r=i.status)>=200&&r<300?[3,3]:[4,i.clone().json().catch((function(){return!!i.text()||null}))];case 2:return o=c.sent(),[2,{status:r,json:o,error:!0}];case 3:return a=void 0,n&&(a=i.headers.get("location").trim()),[2,{sessionId:a,status:r,error:!1}];case 4:return s=c.sent(),console.error("AdobeCM fetchRequest: "+s),s&&409===s.status&&"function"==typeof s.json?[4,s.json()]:[3,6];case 5:return[2,{status:409,json:o=c.sent(),error:!0}];case 6:return[2,s];case 7:return[2]}}))}))},e.prototype.terminateSession=function(){return C(this,void 0,void 0,(function(){var e,t,n,i,r;return O(this,(function(a){switch(a.label){case 0:if(!(e=this.sessionId))return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,T(t=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+e,{method:"DELETE",headers:this.requestHeaders})];case 2:if(n=a.sent(),!((i=n.status)>=200&&i<300))throw new Error("Error - url: "+t+", status: "+i);return[3,4];case 3:return r=a.sent(),console.error("AdobeCM TerminateSession "+r),[3,4];case 4:return[2]}}))}))},e.prototype.handleError=function(e,t){_.debug("AdobeConcurrencyMonitorV2.handleError",e);var n=e.status,i=e.json;switch(n){case 400:return this.handleError400_(i);case 409:return this.handleError409_(i,t);case 410:return this.handleError410_(i,t)}},e.prototype.handleError400_=function(t){return C(this,void 0,void 0,(function(){var n,i;return O(this,(function(r){switch(r.label){case 0:return n=t&&t.obligations||[],!!n.find(()?[4,e.fetchMetadataKeys(this.applicationId,this.serviceUrl)]:[3,2];case 1:if(r.sent(),i=this.metadata,Object.keys(i).length>=this.metadataKeys.length)return[2,this.start()];r.label=2;case 2:return[2,null]}}))}))},e.prototype.handleError409_=function(e,t){try{var n=(e&&e.associatedAdvice||[]).find((function(e){return"rule-violation"===e.type}));if(n){var i=n.message,r=this.messages[i]||i,a=new Error(r),s=!!(e.obligations||[]).find((function(e){return"logout"===e.action}));if(_.debug("AdobeConcurrencyMonitorV2.handleError",409,a,s),!t)throw a;this.onError(a,s)}}catch(a){throw _.debug("AdobeConcurrencyMonitorV2.handleError409_: "+a),a}return null},e.prototype.handleError410_=function(e,t){if(!e)return this.start();try{var n=(e&&e.associatedAdvice||[]).find((function(e){return"remote-termination"===e.type}));if(n){var i=n.message,r=this.messages[i]||i,a=new Error(r),s=!!e.obligations.find((function(e){return"logout"===e.action}));if(_.debug("AdobeConcurrencyMonitorV2.handleError",410,a,s),!t)throw a;this.onError(a,s)}}catch(a){throw _.debug("AdobeConcurrencyMonitorV2.handleError410_: "+a),a}return null},e.prototype.getMetadata=function(){var e=this;return this.metadataKeys.reduce((,{})},e.prototype.onError=e}();function Z(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,Z)}function ee(){}!x||(x={})),ee.prototype={on:once:emit:off:;var te=ee,ne=ee;te.TinyEmitter=ne;var ie=function(e){c(n,e);var t=h(n);function n(){return i(this,n),t.apply(this,arguments)}return a(n,[{key:"getConfiguration",value:]),n}(te),re=!1;try{re="caches"in self}catch(e){}var ae="UPDATED",se=function(e){c(r,e);var t=h(r);function r(){var e;if(i(this,r),(e=t.call(this))._bootstrap=null,e._cache=null,re)caches.open("watchsdk-cache").then((function(t){e._cache=t,t&&t.match("bootstrap").then(().then(()}));else{var n=localStorage.getItem("BootstrapManager.bootstrap");try{var a=JSON.parse(j.stringify(L.parse(n)));e._bootstrap=a}catch(t){try{var s=JSON.parse(n);e._bootstrap=s}catch(e){}}}return e}return a(r,[{key:"bootstrap",get:function(){return this._bootstrap}},{key:"update",value:function(e){var t=this;return T(e).then((function(e){return e.json()})).then((function(e){if(_.debug("BootstrapManager.update() ".concat(JSON.stringify(e,null,2))),t._bootstrap=e,t._cache&&t._cache.put("bootstrap",new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json"}})),!re){var n=L.stringify(j.parse(JSON.stringify(e)));localStorage.setItem("BootstrapManager.bootstrap",n)}t.emit(ae,t._bootstrap)}))}},{key:"getConfiguration",value:function(e,t){var i=this.bootstrap,r=i&&i[e]||{};if(t){var a=Object.keys(r).filter(().reduce((,{});r=n(n({},t),a)}return r}}]),r}(ie);se.shared=new se;var oe,ce=new(a((function e(t,n,r,a){i(this,e),this.enabled=t,this.serviceUrl=n,this.applicationId=null,this.applications=r,this.messages=a})))(!0,"https://streams.adobeprimetime.com/v2",{chromecast:{applicationId:"4c6fd925-7d06-4dbd-9edb-720962619882"},appletv:{applicationId:"eebe77ee-3064-4b4a-b89b-fef248a474be"},samsungtv:{applicationId:"0e3d9128-cdf7-4464-9952-55434ead1e8e"},web:{applicationId:"3bfbbbdf-be8e-40be-9540-97a73469ada2"},ps4:{applicationId:"41e7539c-d38f-4c20-856a-8db2de060287"},comcastflex:{applicationId:"8c1ffe19-f278-4ace-8fc4-833d0ce5c638"}},{}),ue="https://a.espncdn.com/connected-devices/app-configurations/espn-js-sdk-2.0.config.json",le={appletv:"dniqxcl2cnjuzgl04vuek1mm",chromecast:"1q86jvqka85r41w7daunp5ipgb",comcastflex:"flex-web-gk2lbqnmoddq1cjz4c7idqeka",comcastx1:"x1-web_ek3rjw4nlqxm1fo1a76xlwivr",comcastxclass:"watch-sdk-xclass_fparjzlo4iam15wy3pgpigulv",ps4:"kbjoe0y9awb41guc2nzey04ji",samsungtv:"csrf56z30hke1aozrm00ad50g",web:"uiqlbgzdwuru14v627vdusswb"},de=function(e){var t=se.shared.getConfiguration("adobeCM",ce);if(!1!==t.enabled){var n=t.applications&&t.applications[e],i=t.applicationId||n&&n.applicationId,r=t.serviceUrl;X.fetchMetadataKeys(i,r)}},he=function(){eturn a(e,null,[{key:"init",value:function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.partner=t,e.platform=n,e.version=i,e.deviceId=e.deviceId||Z(),_.debug(this.toString());var a=r&&r.bootstrapUrl||ue;se.shared.update(a).finally(()}},{key:"partner",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.partner")},set:function(e){localStorage.setItem("ESPNWatchSDK.Client.partner",e)}},{key:"platform",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.platform")},set:function(e){localStorage.setItem("ESPNWatchSDK.Client.platform",e)}},{key:"version",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.version")},set:function(e){localStorage.setItem("ESPNWatchSDK.Client.version",e)}},{key:"deviceId",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.deviceId")},set:,{key:"toString",value:,{key:"apiKey",get:function(){return se.shared.getConfiguration("shield",{apiKeys:le}).apiKeys[e.platform]||"mbmhfdgflphg14wss50rny3ct"}}]),e}();!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(oe||(oe={}));var pe,fe=oe;!function(e){e.linear="linear",e.event="event"}(pe||(pe={}));var me,ge=pe;!function(e){e.stitchedPreroll="stitchedPreroll"}(me||(me={}));var ye,ve=me;!function(e){e.live="live",e.onDemand="onDemand"}(ye||(ye={}));var be,we=ye;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(be||(be={}));var Ie,_e=be;!function(e){e.shortform="shortform",e.longform="longform"}(Ie||(Ie={}));var Pe,Se=Ie;!function(e){e.audio="audio",e.video="video"}(Pe||(Pe={}));var Te,ke=Pe;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(Te||(Te={}));var Ae,Ee=Te;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(Ae||(Ae={}));var Ce,Oe=Ae;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(Ce||(Ce={}));var De=Ce;Re=new Set(["ESPN","ESPN2"]);r Be;function ze(e,t,n,i){if(!t)return{};let r,a,s,o=null;const c=null==e?void 0:e.streamType;(null==e?void 0:e.brand)===Be.natGeo?o=t):(r=He(t,n,c),a=t,n),s=t,n,i),o=t,n));const u={};return u[_e.nielsen]=r,u[_e.comscore]=a,u[_e.conviva]=s,u[_e.heartbeats]=o,u}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.fast="fast",e.unknown="000"}(Be||(Be={}));const Ve=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"];lass qe{constructor(){this.configuration_=qe.defaultConfiguration}get configuration(){return this.configuration_}set configuration(e){this.configuration_=e}getMediaItems(e,t){return C(this,void 0,void 0,(function*(){return yield qe.fetchMediaItems(e,t,this.configuration)}))}tatic getPromiseMediaItems(e,t,n,i){return C(this,void 0,void 0,(function*(){const r=e,t,n,i.countryCode,i.languageCode);try{const a=yield T(r),s=yield a.json();let{airing:o}=s.data;const{airings:c}=s.data;if(c){const t=e.simulcastAiringId?o=c.filter(t)[0]}const u=s.data.VOD,l=o||u;if(!l)throw new Error("No results found.");const d=function(e,t,n){const{id:i,name:r,description:a,duration:s,image:o,eventId:c,requiresLinearPlayback:u,authTypes:l,source:d,prerollSource:h,packages:p,language:f,mrss:m,seekInSeconds:g,tracking:y,simulcastAiringId:v,network:b,status:w,cerebroId:I,syndicatable:_}=e,P=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?we.live:we.onDemand,S=((d.authorizationType);let T=new Ne(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===ve.stitchedPreroll&&h&&(T=new Ne(h.url,De.none),T.variant=ve.stitchedPreroll);const k=u?fe.linearPlayback:fe.all,A=y&&y.trackingId||i,E=new Ue(i,r,s,f,T);if(E.authenticationTypes=l.map(e=>{switch(e){case"DIRECT":return Oe.direct;case"OPEN":return Oe.open;case"MVPD":return Oe.mvpd;case"ISP":return Oe.isp;default:return Oe.none}}),E.description=a,E.isSyndicatable=_,Array.isArray(E.images)&&(null==o?void 0:o.url)&&E.images.push(new Le(o.url)),E.mrss=m,b){const e="linear"===b.type?ge.linear:ge.event;E.network=new Me(b.id,e,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=P,E.supportedMediaCommands=k,E.brand=E.brand?E.brand:"espn",E.references={eventId:c,simulcastAiringId:v,trackingId:A,cerebroId:I},E.type=ke.video,E.entityType=t,E.apiSource=Ee.graphQL,E.packages=(p||[]).map(,E.tracking=ze(E,e,t,T),E}(l,e.entityType,i);if(e.resumeTime&&(d.seekInSeconds=e.resumeTime),!d.source.url){const e="OVER"===l.status.toUpperCase(),r=l.network&&l.network.type===ge.linear,a=l.network&&l.network.id;if(e&&r&&a)return qe.retryGetMediaItems(a,t,n,i);throw new Error("No playable url")}return d}catch(e){return _.warn("Failed to retrieve MediaItem from GraphQL: "+e),null}}))}qe.defaultConfiguration=new Ge(Ee.graphQL);onst We=Object.freeze({}),Ye=Object.freeze({}),Je=Ee.itemFeed,Qe="abcn",$e={lf:"longform",sf:"shortform",live:"longform"},Xe={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},Ze={name:"abc_news_live",type:"linear"},et=["HLS_ALL","PDL_MED","PDL_LOW"];ar nt=new RegExp("(%[a-f0-9]{2})|([^%]+?)","gi"),it=new RegExp("(%[a-f0-9]{2})+","gi");r st=n elenreturn n},ut=I((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?st(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=ot(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=ot(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:ct(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}}));ut.extract,ut.parse,ut.stringify,ut.parseUrl,ut.stringifyUrl,ut.pick,uull}}))}}lt.defaultConfiguration=new Ge(Ee.new qe}}}var ht,ervals=t})))({intervals:{DEFAULT:2,ESPN_PLUS:0,ESPN_PLUS_MLB:0,ESPN_PLUS_NHL:0}}),ft=fation=pt}return a(e,[{key:"configuration",get:function(){return this._configuration},set:function(e){this._configuration=e}},{key:"shouldPreroll",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=this.configuration.intervals.DEFAULT||0,r=(n||[]ntervalrvals[e]}));0===r.length&&r.push(i);var a=Math.min.apply(Math,y(r));return a>0&&e.prerollCount>=a-1}}],[{key:"prerollCount",get:function(){var e=localStorage.getItem("PrerollManager.prerollCount");try{return JSON.parse(e)||0}catch(e){return 0}},set:function(e){localStorage.setItem("PrerollManager.prerollCount",JSON.stringify(e))}}]),e}(),mt=function(e){c(n,e);var t=h(n);function n(){return i(this,n),t.apply(this,arguments)}return a(n,[{key:"configuration",get:function(){var e=se.shared.getConfiguration("preRoll",pt);return _.debug("PrerollManager.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(u(n.prototype),"configuration",e,this,!0)}}],[{key:"prerollCount",get:function(){return ft.prerollClCount=e}}]),n}(ft),gt=function(e){c(n,e);vguments)}return a(n,[{key:"name",get:function(){return this.title}},{key:"eventId",get:function(){return this.references.eventId}},{key:"trackingId",get:function(){return this.references.trackingId}},{key:"simulcastAiringId",get:function(){return this.references.simulcastAiringId}},{key:"airingId",get:function(){return this.id}},{key:"requiresLinearPlayback",get:function(){return this.supportedMediaCommands===fe.linearPlayback}},{key:"convivaContentMetadata",get:function(){return this.tracking&&this.tracking[_e.conviva]}},{key:"trackingInfo",get:function(){return this.tracking&&this.tracking[_e.heartbeats]}},{key:"nielsenMetadata",get:function(){return this.tracking&&this.tracking[_e.nielsen]}}],[{key:"fromObject",value:function(e){var t=new n(e.id,e.title,e.duration,e.language,e.source);if(o(t,Ue.fromObject(e)),t.sourrn null}}(t.source.type);t.source.authorizationType=i}return t}}]),n}(Ue),yt=function(e){c(n,e);var t=h(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee.graphQL;return i(this,n),(e=t.call(this)).prerollManager=new mt,e.apiSource=r,e.configurationKey=r===Ee.graphQL?"graphqlapi":null,e.apiSource_=r,e.watchSDKServiceUrl_=e.getServiceUrlInParam_(),e.configuration=new Ge(e.apiSource_,e.watchSDKServiceUrl_),e}return a(n,[{key:"configuration",get:function(){if(this.watchSDKServiceUrl_)return new Ge(this.apiSource_,this.watchSDKServiceUrl_);var e=se.shared.getConfiguration(this.configurationKey,n.defaultConfiguration);return _.debug("MediaItemAPI.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(u(n.prototype),"configuration",e,this,!0)}},{key:"getServiceUrlInParam_",value:function(){var e=new URL(window.location.href);return e&&e.searchParams.get("_watchSDKServiceUrl")}},{key:"getMediaItems",value:function(e,t){var i=t||{},r=i.entitlements||[];return this.prerollManager.shouldPreroll(r)&&(i.sourceVariant=ve.stitchedPreroll),f(u(n.prototype),"getMediaItems",this).call(this,e,i).then((function(e){var t=e||[],n=dPreroll})).length;return n>0?mt.prerollCount=0:mt.prerollCount+=t.length-n,t.map((function(e){return gt.fromObject(e)}))}))}}]),n}(dt),vt={device:{advertisingId:"0000-0000-0000-0000-0000",devType:"web"}};!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(ht||(ht={}));var bt,wt=ht;!function(e){e.linear="linear",e.event="event"}(bt||(bt={}));var It,_t=bt;!function(e){e.stitchedPreroll="stitchedPreroll"}(It||(It={}));var Pt,St=It;!function(e){e.live="live",e.onDemand="onDemand"}(Pt||(Pt={}));var Tt,kt=Pt;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(Tt||(Tt={}));var At,Et=Tt;!function(e){e.shortform="shortform",e.longform="longform"}(At||(At={}));var Ct,Ot=At;!function(e){e.audio="audio",e.video="video"}(Ct||(Ct={}));var Dt,Nt=Ct;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(Dt||(Dt={}));var Mt,Lt=Dt;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(Mt||(Mt={}));var jt,Ut=Mt;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(jt||(jt={}));var xt=jt,Rt=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,xt[i],r,a,s,o,c,u)},e}(),Ft=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=_t[t.type];return new e(t.id,n,t.name,t.resource)},e}(),Ht=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),Bt=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),zt=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=wt.all,this.images=[],this.type=Nt.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===_t.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===kt.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=Rt.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return Ht.fromObject(e)})),i.mrss=t.mrss,i.network=Ft.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=kt[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return Bt.fromObject(e)})),i.tier=t.tier,i.type=Nt[t.type],i.entityType=Ot[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var Vt,Gt=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=Ot.shortform:this.entityType=Ot.longform,this.type=Nt.video}return e.prototype.toString=function(e){return e==Lt.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringFnel="+e}},e}();function qt(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===Vt.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=Ct.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===Ot.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===Ot.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===Ot.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===Ot.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===_t.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=Vt.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,g=e.coverageType,y=e.brands,v={};if(v.ContentDuration=n,t===Ot.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(y)&&y.length){var w=y[0],I=w.id,_=w.name,P=w.type;v["a.media.asset"]=I,v["a.media.show"]=_,v["a.media.genre"]=P}}else if(t===Ot.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}g&&(v.VideoTypeDetail=g)}return v}(t,n));var c={};return c[Et.nielsen]=r,c[Et.comscore]=a,c[Et.conviva]=s,c[Et.heartbeats]=o,c}function Kt(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<wn="000"}(Vt||(Vt={}));var Wt=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Yt=function(e,t,n,i){e==Lt.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Wt):e==Lt.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===Lt.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},Jt=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return O(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new Gt(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.at,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof zt}))).length?[2,Kt(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,g;return O(this,(function(y){switch(y.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===Ot.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,y.sent().json()];case 3:if(s=y.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcasAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,g=e.seekInSeconds,y=e.tracking,v=e.simulcastAiringId,b=e.network,w=e.status,I=e.cerebroId,_=e.syndicatable,P=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?kt.live:kt.o.shield}}(d.authorizationType),T=new Rt(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===St.stitchedPreroll&&h&&((T=new Rt(h.url,xt.none)).variant=St.stitchedPreroll);var k=u?wt.linearPlayback:wt.all,A=y&&y.trackingId||i,E=new zt(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return Ut.direct;case"OPEN":return Ut.open;case"MVPD":return Ut.mvpd;case"ISP":return Ut.isp;default:return Ut.none}})),E.description=a,E.isSyndicatable=_,o&&o.url&&E.images.push(new Ht(o.url)),E.mrss=m,b){var C="linear"===b.type?_t.linear:_t.event;E.network=new Ft(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=P,E.supportedMediaCommands=k,E.brand=E.brand?E.brand:"espn",E.tracking=qt(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:A,cerebroId:I},E.type=Nt.video,E.entityType=t,E.apiSource=Lt.graphQL,E.packages=(p|(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===_t.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),_.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return O(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=Gt.identifierStringForNetwork(t,Lt.graphQL),s=new Gt(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof zt==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),_.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new Yt(Lt.graphQL),e}();var Qt=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Gt(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof zt}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,g=new Rt(a.url,m),y=new zt(t,n,r,l,g);return y.authenticationTypUt.none}})),y.description=i,d&&(y.network=new Ft(d.id,d.type,d.name,d.resource)),y.streamType=c,y.brand=h,y.tracking=qt(y.brand,e,f,g),y.images=p,y.type=s,y.entityType=f,y.apiSource=Lt.cfa,y}(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Yt(Lt.cfa),e}(),$t=Object.freeze({}),Xt=Object.freeze({}),Zt=Lt.itemFeed,en={lf:"longform",sf:"shortform",live:"longform"},tn={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},nn={name:"abc_news_live",type:"linear"},rn=["HLS_ALL","PDL_MED","PDL_LOW"];function an(e){var t,n,i,r=(e||$t).channel||$t,a=r.item||$t,s=a["media-group"]||$t,o=s["media-content"]||Xt,c=s["media-title"],u=(function(e){for(var t,n,i=rn.length,r=e.length,a=0;a<i;a++)for(var s=rn[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||$t)["@attributes"]||$t,l=(s["media-thumbnail"]||$t)["@attributes"]||$t,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,g=u.duration,y=u.url,v=u.medium,b=(a.omniture||$t).channel||"",w=D(String(b).split(":"),1)[0],I=tn[b]||tn[void 0===w?"abcn":w]||"abcnews",_="vod"===p,P="live"===p,S=en[a.videoContentType]||(_?"shortform":"longform"),T=c||h,k=r.language||"en";try{n=(t=D(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var A="akamai live stream"!==a.mediatype||_?{}:E(E({},nn),{id:d}),C={id:d,apiSource:Zt,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:A,show:{title:T},title:T,duration:g,language:k,source:{url:y,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:I,type:"video"===v?"video":"audio",entityType:S,streamType:P?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:g,streamURL:y,custom:{contentId:d,assetType:_?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:g,isFullEpisode:"shortform"===S||P?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return zt.fromObject(C)}var(e,r,i)}})),cn=(on.extract,on.parse,on.stringify,on.parseUrl,on.stringifyUrl,on.pick,on.exclude,fguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:returnew Gt(e)})),r=i.serviceUrl,[4,S.atem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof zt}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=on.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,an(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Yt(Lt.itemFeed),e}());!function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return O(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return O(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?Qt:e.match("abcnews")?cn:Jt,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}();!function(e){e.localStorage="LOCAL_STORAGE",e.sessionStorage="SESSION_STORAGE"}(sn||(sn={}));var un,ln=sn,dn=function(){function e(e,t,n,i){this.id=e,this.name=t,this.logoUrl=n,this.websiteUrl=i}return e.prototypeeUrl+">"},e.fsiteUrd="mvpd"}(un||(un={}));var hn,pn,fn=function(){function e(e,t,n,i){void 0===i&&(i={}),this.authenticationType=e,this.authenticatedProvider=t,this.authenticatedIdentity=n,this.customData=i}return e.CustomDataKey=uayload=t};(hn=e.AdProvider||(e.AdProvider={})).standard="default",hn.googleAdManager="gam",(pn=e.AdEnvironment||(e.AdEnvironment={})).standard="default",pn.prod="prod",pn.development="dev";function gn(e,t){void 0===t&&(t=4e3);var n="undefined"!=typeof window&&window,i=n&&n.document,r=i&&i.getElementsByTagName&&i.getElementsByTagName("head")[0],a=i&&i.body,s=r||a;return s&&e?new S((function(n,i){var r=document.createElement("script"),a=[],o=null,c=function(){aturn e()})),a=null,clearTimeout(o),o=null},u=function(e){c(c(),i(e)};r.type="text/javascript",r.src=e,r.addEventListener("load",u),a.push((function(){return r.removeEventListener("load",u)})),r.addEventListener("error",lrror",l)})),o=setTimeout((function(){return l(new Error("Timeout ("+t+") while fetching "+e))}),4e3),s.appendChild(r)})):S.reject()}var yn,vn,bn,wn=Object.freeze({}),In=Object.freeze(""),_n="undefined"!=typeof window&&error(e)},Sn=function(){return C(this,void 0,void 0,(function(){var e,t,n;return O(this,(function(i){switch(i.label){case 0:if(e=yn||_n.goog&&_n.goog.pal,t=_n&&_n.bc,e)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,gn("https://imasdk.googleapis.com/pal/sdkloader/pal.js")];case 2:return i.sent(),[3,4];case 3:return n=i.sent(),Pn(n),[3,4];case 4:(e=_n.goog&&_n.goog.pal)&&(yn=e),!t&&_n.bc&&(_n.bc=null),i.label=5;case 5:return[2,e||wn]}}))}))};function Tn(e,t,n,i,r){return void 0===t&&(t=3e3),void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===r&&(r=Sn),C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h;return O(this,(function(p){switch(p.label){case 0:if(a=i&&bn||In)return[3,10];s=void 0,o=void 0,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,r()];case 2:return(c=p.sent())&&(s=c.NonceLoader,o=c.NonceRequest),[3,4];case 3:return u=p.sent(),Pn(u),[3,4];case 4:if(i&&bn||!s||!o)return[3,10];l=void 0,p.label=5;case 5:return p.trys.push([5,7,,8]),vn=!vn||n?new s:vn,d=Object.assign(new o,function(e){var t=D(String(e.videoPlayerSize||"640x480").split("x"),2),n=t[0],i=t[1];return{adWillAutoPlay:e.isAutoplay,adWillPlayMuted:e.isMute,continuousPlayback:"vod"===e.videoDeliveryMethod,descriptionUrl:e.descriptionUrl||In,iconsSupported:e.vastIconsSupported,playerType:e.videoPlayerType||In,playerVersion:e.videoPlayerVersion||In,ppid:e.ppid||e.swid||In,videoHeight:parseInt(i,10),videoWidth:parseInt(n,10)}}(e)),[4,vn.loadNonceManager(d)];case 6:return l=p.sent(),[3,8];case 7:return h=p.sent(),Pn(h),[3,8];case 8:return l?[4,l.getNonce()]:[3,10];case 9:(!(a=p.sent())||Number(t)>0&&String(a).length>t)&&(a=In),a&&(bn=a),p.label=10;case 10:return[2,a]}}))}?"1l!=e?e:t},En=function(){function t(t,n,i,r,a,s,o,c,u,l,d,h,p,f,m,g,y,v,b,w,I,_,P,S,T,k,A,E,C,O,D,N,M,L,j,U,x,R,F,H,B,z,V,G,q,K,W,Y,J,Q,$,X,Z,ee,te,ne,ie,re,ae,se,oe,ce,ue,le,de,he,pe,fe,me){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a="espn"),void 0===s&&(s=null),void 0===o&&(o=null),void 0===c&&(c=null),void 0===u&&(u=null),void 0===l&&(l=null),void 0===d&&(d=null),void 0===h&&(h=null),void 0===p&&(p=null),void 0===f&&(f=null),void 0===m&&(m=null),void 0===g&&(g=null),void 0===y&&(y=!1),void 0===v&&(v=null),void 0===b&&(b=null),void 0===w&&(w=!1),void 0===I&&(I=!1),void 0===_&&(_=null),void 0===P&&(P=null),void 0===S&&(S=null),void 0===T&&(T=null),void 0===k&&(k=null),void 0===A&&(A=null),void 0===E&&(E=null),void 0===C&&(C=null),void 0===O&&(O=!1),void 0===D&&(D=null),void 0===N&&(N=null),void 0===M&&(M=null),void 0===L&&(L=null),void 0===j&&(j=null),void 0===U&&(U=null),void 0===x&&(x=null),void 0===R&&(R=null),void 0===F&&(F=null),void 0===H&&(H=null),void 0===B&&(B=null),void 0===z&&(z=null),void 0===V&&(V=null),void 0===G&&(G=null),void 0===q&&(q=null),void 0===K&&(K=null),void 0===W&&(W=null),void 0===Y&&(Y=null),void 0===J&&(J=null),void 0===Q&&(Q=null),void 0===$&&($=null),void 0===X&&(X=null),void 0===Z&&(Z=null),void 0===ee&&(ee=null),void 0===te&&(te=!1),void 0===ne&&(ne=null),void 0===ie&&(ie=null),void 0===re&&(re=null),void 0===ae&&(ae=null),void 0===se&&(se={}),void 0===oe&&(oe=null),void 0===ce&&(ce=null),void 0===ue&&(ue=null),void 0===le&&(le=null),void 0===de&&(de=e.AdEnvironment.standard),void 0===he&&(he=e.AdProvider.standard),void 0===pe&&(pe=null),void 0===fe&&(fe=null),void 0===me&&(me=null),this.aff=t,this.alt=n,this.accessLevel=i,this.adRule=r,this.an=a,this.beacType=s,this.collection=o,this.cbp=c,this.descriptionUrl=u,this.edition=l,this.fcap=d,this.hashedIp=h,this.hl=p,this.isAuth=f,this.idType=m,this.impl=g,this.isLat=y,this.iu=v,this.msid=b,this.npa=w,this.ltd=I,this.nlsnPlat=_,this.output=P,this.palNonce=S,this.playlist=T,this.ppid=k,this.rdid=A,this.tags=E,this.transId=C,this.tfcd=O,this.url=D,this.varResolution=N,this.vpa=M,this.vpi=L,this.vadFormat=j,this.vpmute=U,this.authenticationProvider=x,this.bundleId=R,this.deviceOS=F,this.deviceType=H,this.isAutoplay=B,this.isMute=z,this.language=V,this.nielsenAppId=G,this.nielsenDeviceGroup=q,this.noAds=K,this.objectId=W,this.pageType=Y,this.platform=J,this.stitchingProvider=Q,this.swid=$,this.testAdTargeting=X,this.tag=Z,this.unid=ee,this.vastIconsSupported=te,this.videoDeliveryMethod=ne,this.videoPlayerSize=ie,this.videoPlayerType=re,this.videoPlayerVersion=ae,this.userInfo=se,this.isDoNotTrackEnabled=oe,this.pp=ce,this.cmsid=ue,this.vid=le,this.adEnvironment=de,this.adProvider=he,this.usPrivacy=pe,this.additionalConsent=fe,this.rdp=me}return t.prototype.merge=function(t){return t?(this.adRule=t.adRule||this.adRule,this.an=t.an||this.an,this.descriptionUrl=t.descriptionUrl||this.descriptionUrl,this.fcap=t.fcap||this.fcap,this.hashedIp=t.hashedIp||this.hashedIp,this.hl=t.hl||this.hl,this.idType=t.idType||this.idType,this.isLat=An(t.isLat,this.isLat),this.iu=t.iu||this.iu,this.msid=t.msid||this.msid,this.npa=An(t.npa,this.npa),this.ltd=An(t.ltd,this.ltd),this.output=t.output||this.output,this.ppid=t.ppid||this.ppid,this.rdid=t.rdid||this.rdid,this.rdp=t.rdp||this.rdp,this.tfcd=t.tfcd||this.tfcd,this.url=t.url||this.url,this.vpa=t.vpa||this.vpa,this.vpi=t.vpi||this.vpi,this.vadFormat=t.vadFormat||this.vadFormat,this.vpmute=An(t.vpmute,this.vpmute),this.authenticationProvider=t.authenticationProvider||this.authenticationProvider,this.bundleId=t.bundleId||this.bundleId,this.deviceOS=t.deviceOS||this.deviceOS,this.deviceType=t.deviceType||this.deviceType,this.isAutoplay=An(t.isAutoplay,this.isAutoplay),this.isMute=An(t.isMute,this.isMute),this.language=t.language||this.language,this.palNonce=t.palNonce||this.palNonce,this.nielsenAppId=t.nielsenAppId||this.nielsenAppId,this.nielsenDeviceGroup=t.nielsenDeviceGroup||this.nielsenDeviceGroup,this.noAds=An(t.noAds,this.noAds),this.objectId=t.objectId||this.objectId,this.platform=t.platform||this.platform,this.stitchingProvider=t.stitchingProvider||this.stitchingProvider,this.swid=t.swid||this.swid,this.tags=t.tags||this.tags,this.testAdTargeting=t.testAdTargeting||this.testAdTargeting,this.unid=t.unid||this.unid,this.alt=t.alt||this.alt,this.beacType=t.beacType||this.beacType,this.transId=t.transId||this.transId,this.accessLevel=t.accessLevel||this.accessLevel,this.varResolution=t.varResolution||this.varResolution,this.nlsnPlat=t.nlsnPlat||this.nlsnPlat,this.tag=t.tag||this.tag,this.aff=t.aff||this.aff,this.playlist=t.playlist||this.playlist,this.cbp=t.cbp||this.cbp,this.collection=t.collection||this.collection,this.impl=t.impl||this.impl,this.isAuth=t.isAuth||this.isAuth,this.pageType=t.pageType||this.pageType,this.vastIconsSupported=An(t.vastIconsSupported,this.vastIconsSupported),this.videoDeliveryMethod=t.videoDeliveryMethod||this.videoDeliveryMethod,this.videoPlayerSize=t.videoPlayerSize||this.videoPlayerSize,this.videoPlayerType=t.videoPlayerType||this.videoPlayerType,this.videoPlayerVersion=t.videoPlayerVersion||this.videoPlayerVersion,this.isDoNotTrackEnabled=An(t.isDoNotTrackEnabled,this.isDoNotTrackEnabled),this.pp=t.pp||this.pp,this.cmsid=t.cmsid||this.cmsid,this.usPrivacy=t.usPrivacy||this.usPrivacy,this.additionalConsent=t.additionalConsent||this.additionalConsent,this.vid=t.vid||this.vid,this.userInfo?Object.assign(this.userInfo,t.userInfo):this.userInfo=t.userInfo,this.adEnvironment=t.adEnvironment!==e.AdEnvironment.standard?t.adEnvironment:this.adEnvironment,this.adProvider=t.adProvider!==e.AdProvider.standard?t.adProvider:this.adProvider,this):this},t.prototype.dictionaryForStartSession=function(){var t={};return t["ad.tfcd"]=kn(this.tfcd),t["ad.is_lat"]=kn(this.isLat),t["ad.idtype"]=this.idType,t["ad.rdid"]=this.rdid,t["ad.ppid"]=this.ppid||this.swid,t["ad.description_url"]=this.descriptionUrl,t["ad.hl"]=this.hl,t["ad.paln"]=this.palNonce,t["ad.npa"]=kn(this.npa),t["ad.ltd"]=kn(this.ltd),t["ad.msid"]=this.msid,t["ad.an"]=this.an,t["ad.url"]=this.url,t["ad.us_privacy"]=this.usPrivacy,t["ad.cust_params.d_us_privacy"]=this.usPrivacy,t["ad.rdp"]=null!==this.rdp?this.rdp:"1YYY"===this.usPrivacy?"1":null,t.authp=this.authenticationProvider,t.bundleId=this.bundleId,t.devOS=this.deviceOS,t.devType=this.deviceType,t.fcap=this.fcap,t.isAutoplay=kn(this.isAutoplay),t.isMute=kn(this.isMute),t.nlsnAppID=this.nielsenAppId,t.plt=this.platform,t.swid=this.swid,t.unid=this.unid,t.vps=this.videoPlayerSize,this.adEnvironment!==e.AdEnvironment.standard&&(t.adEnv=this.adEnvironment),this.adProvider!==e.AdProvider.standard&&(t.adProvider=this.adProvider),Object.assign(t,this.userInfo),Object.keys(t).forEach((function(e){return null===t[e]&&delete t[e]})),t},t.prototype.dictionaryForBrightcove=function(){var e={};e.bundleId=this.bundleId,e.devOS=this.deviceOS,e.devType=this.deviceType,e.isAutoplay=kn(this.isAutoplay),e.isMute=kn(this.isMute),e.plt=this.platform,e.swid=this.swid,e.vps=this.videoPlayerSize,e.d_id=this.rdid,e.vdm=this.videoDeliveryMethod||"vod",e.stp=this.stitchingProvider||"brightcove";var t=Object.keys(e).filter((function(t){return null!==e[t]})).map((function(t){return t+"="+e[t]})).join("&"),n={};return n.UMADPARAMiu=this.iu,n.UMADPARAMis_lat=kn(this.isLat),n.UMADPARAMidtype=this.idType,n.UMADPARAMrdid=this.rdid,n.UMADPARAMppid=this.ppid||this.swid,n.UMADPARAMdescription_url=this.descriptionUrl,n.UMADPARAMhl=this.hl,n.UMADPARAMnpa=kn(this.npa),n.UMADPARAMltd=kn(this.ltd),n.UMADPARAMmsid=this.msid,n.UMADPARAMan=this.an,n.UMADPARAMurl=this.url,n.UMADPARAMvpa=kn(this.vpa),n.UMADPARAMvpmute=kn(this.vpmute),n.UMPTPARAMcust_params=t,Object.assign(n,this.userInfo),Object.keys(n).forEach((function(e){return null===n[e]&&delete n[e]})),n},t.prototype.dictionaryForAdEngine=function(){var t={};switch(t.sect=this.iu,t.npa=kn(this.npa),t.ltd=kn(this.ltd),t.lat=kn(this.isLat),t.idtype=this.idType,t.devId=this.rdid,t.ppid=this.ppid||this.swid,t.app=this.an,t.tfcd=kn(this.tfcd),t.devOS=this.deviceOS,t.devType=this.deviceType,t.isAutoplay=kn(this.isAutoplay),t.isMute=kn(this.isMute),t.plt=this.platform,t.swid=this.swid,t.unid=this.unid,t.vps=this.videoPlayerSize,t.bundle=this.msid,t.hl=this.hl,t.UID=this.swid,t.vdm=this.videoDeliveryMethod,t.url=this.url,this.adEnvironment){case e.AdEnvironment.development:t.env="qa";break;case e.AdEnvironment.prod:t.env="prod";break;case e.AdEnvironment.standard:}switch(this.adProvider){case e.AdProvider.googleAdManager:t.ads="google";break;case e.AdProvider.standard:}return Object.assign(t,this.userInfo),Object.keys(t).forEach((function(e){return null===t[e]&&delete t[e]})),t},t.prototype.dictionaryForImaSdk=function(){var t={};t.authp=this.authenticationProvider,t.d_us_privacy=this.usPrivacy,t.devOS=this.deviceOS,t.devType=this.deviceType,t.ed=this.edition,t.hip=this.hashedIp,t.isAutoplay=kn(this.isAutoplay),t.isDnt=kn(this.isDoNotTrackEnabled),t.isMute=kn(this.isMute),t.lang=this.language,t.nlsnAppID=this.nielsenAppId,t.nlsnDevGrp=this.nielsenDeviceGroup,t.noad=this.noAds,t.objid=this.objectId,t.plt=this.platform,t.pgtyp=this.pageType,t.swid=this.swid,t.tag=this.tags,t.tstAdTar=this.testAdTargeting,t.unid=this.unid,t.vdm=this.videoDeliveryMethod||"vod",t.vps=this.videoPlayerSize;var n=Object.keys(t).filter((function(e){return null!==t[e]})).map((function(e){return e+"="+t[e]})).join("&"),i={};return i.ad_rule=this.adRule,i.cmsid=this.cmsid,i.description_url=this.descriptionUrl,i.hl=this.hl,i.iu=this.iu,i.npa=kn(this.npa),i.output=this.output,i.ltd=kn(this.ltd),i.pp=this.pp,i.ppid=this.ppid,i.rdp=this.rdp,i.tfcd=kn(this.tfcd),i.us_privacy=this.usPrivacy,i.addtl_consent=this.additionalConsent,i.vid=this.vid,i.vpa=kn(this.vpa),i.cust_params=n,i.gdfp_req="1",i.env="vp",i.sz="640x480",this.adEnvironment!==e.AdEnvironment.standard&&(i.adEnv=this.adEnvironment),Object.keys(i).forEach((function(e){return null===i[e]&&delete i[e]})),i},t.prototype.dictionaryForEntertainment=function(){var e={};e.ed=this.edition,e.devOS=this.deviceOS,e.devType=this.deviceType,e.hip=this.hashedIp,e.isAutoplay=kn(this.isAutoplay),e.isDnt=kn(this.isDoNotTrackEnabled),e.isMute=kn(this.isMute),e.lang=this.language,e.nlsnAppID=this.nielsenAppId,e.nlsnDevGrp=this.nielsenDeviceGroup,e.nlsnPlat=this.nlsnPlat,e.noad=this.noAds,e.objid=this.objectId,e.pgtyp=this.pageType,e.plt=this.platform,e.swid=this.swid||this.ppid,e.tag=this.tags,e.tstAdTar=this.testAdTargeting,e.unid=this.unid,e.vdm=this.videoDeliveryMethod||"vod",e.vps=this.videoPlayerSize,e.alt=this.alt,e.beacType=this.beacType,e.transId=this.transId,e.accesslevel=this.accessLevel,e.isAuth=this.isAuth,e.fcap=this.fcap,e.var=this.varResolution,e.tag=this.tag,e.aff=this.aff,e.authp=this.authenticationProvider,e.playlist=this.playlist,e.cbp=this.cbp,e.collection=this.collection,e.impl=this.impl;var t=Object.keys(el!==e[t"="+e[t]})).join("&"),n={};return n.addtl_consent=this.additionalConsent,n.ad_rule=this.adRule,n.cmsid=this.cmsid,n.description_url=this.descriptionUrl,n.hl=this.hl,n.iu=this.iu,n.npa=kn(this.npa),n.output=this.output,n.ltd=kn(this.ltd),n.pp=this.pp,n.ppid=this.ppid,n.tfcd=kn(this.tfcd),n.vid=this.vid,n.vpa=kn(this.vpa),n.cust_params=t,n.output=this.output,n.vad_format=this.vadFormat,n.vpi=this.vpi,n.url=this.url,n.us_privacy=this.usPrivacy,n.gdfp_req="1",n.env="vp",n.sz="640x480",Object.keys(n)ete n[e]})),n},t.ppidForSwid=function(e){return e},t.getGooglePalNonce=Tn,t}(),Cn=fs.tier=t}return e.prototypetier+">"},e.f,t.tier)},e}();function On(e,t,n){if(!e||!t||!n)return e;var i="</item></channel></rss>",r=-1;return-1!==(r=e.indexOf(i))&&-1===e.indexOf("shield:affiliateId")&&(e=e.slice(0,r)+"<shield:affiliateId>"+t+"</shield:affiliateId>"+e.slice(r)),-1!==(r=e.indexOf(i))&&-1===e.indexOf("shield:airingId")&&-1!==e.indexOf("shield:affiliateId")&&(e=e.slice(0,r)+"<shield:airingId>"+n+"</shield:airingId>"+e.slice(r)),e}var Dn,Nn=new function(e,t,n,i){this.preauthorizeNetworksEnabled=e,this.preauthorizeNetworks=t,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),Mn=(function(){function e(e,t,n,i){void 0===i&&(i={}),this.partner=e,this.platform=t,this.requestorId=n,this.options=i,this.adobePass=null,this.providerDataSource=null,this.configuration=Nn}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAuthenticaicated")},set:function(e){localStorage.setItem("AdobePassAuthenticator.isAuthenticated",JSON.stringify(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("AdobePassAuthenticator.authenticatedIdentity")},set:function(e){e?localStorage.setItem("AdobePassAuthenticator.authenticatedIdentity",e):localStorage.removeItem("AdobePassAuthenticator.authenticatedIdentity")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedPackage",{get:function(){var e=localStorage.getItem("AdobePassAuthenticator.authenticatedPackage");try{return Cn.fromObject(JSON.parse(e))}catch(e){return null}},set:function(e){e?localStorage.setItem("AdobePassAuthenticator.authenticatedPackage",JSON.stringify(e)):localStorage.removeItem("AdobePassAuthenticator.authenticatedPackage")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedProvider",{get:function(){var e=localStorage.getItem("AdobePassAuthenticator.authenticatedProvider");try{return dn.fromObject(JSON.parse(e))}catch(e){return null}},set:function(e){e?localStorage.setItem("AdobePassAuthenticator.authenticatedProvider",JSON.stringify(e)):localStorage.removeItem("AdobePassAuthenticator.authenticatedProvider")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wasPreviouslyAuthenticaed")||!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preauthorizedResources",{get:function(){if(!this.isAuthenticated)return[];var e=localStorage.getItem("AdobePassAuthenticator.preauthorizedResources");try{return JSON.parse(e)}catch(e){return[]}},enumerable:!1,configurable:!0}),e.prototype.checkAuthentication=function(){var e=this;_.debug("AdobePassAuthenticator.checkAuthentication");var t=this.adobePass;return t?t.checkAuthentication().then((function(n){return e.isAuthenticated=n,n?(localStorage.setItem("AdobePassAuthenticator.wasPreviouslyAuthenticated","true"),e.getPreauthorizedResourcegify(e))})),t.getUserMetadata().then((function(t){var n=t.data,i=n.upstreamUserID,r=n.mvpd,a=n.packageId,s=n.tier;return e.authenticatedIdentity=i,(a||s)&&(e.authenticatedPackage=new Cn(a,s)),e.providerDataSource?e.providerDataSource.getProvider(r).then((function(t){var n=t.getPreferredLogoUrl(e.partner);return e.authenticatedProvider=new dn(r,t.name,n,t.websiteUrl),!0})).catch((function(){return e.authenticatedProvider=new dn(r,r,null,null),!0})):(e.authenticatedProvider=new dn(r,r,null,null),S.resolve(!0))}))):(e.authenticatedIdentity=null,e.authenticatedProvider=null,e.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources"),S.resolve(!1))}olve(!1)})):S.resolve(!1)},e.prototype.authenticate=function(){var e=this;if(!this.currentRegistrationCode)return S.reject(new Error("Use getRegistrationCode first."));_.debug("AdobePassAuthenticator.authenticate currentRegistrationCode: "+this.currentRegistrationCode.code);var t=this.currentRegistrationCode.expires;return t&&Date.now()>t?S.reject(new Error("Your activation code has expired.")):new S((function(t,n){e.authenticateTimer_=setTimeout((function(){e.checkAuthentication().then((function(e){t(e)})).catch((function(e){n(e)}))}),5e3)ticate()}))},e.prototype.cancelAuthenticate=function(){_.debug("AdobePassAuthenticator.cancelAuthenticate"),this.authenticateTimer_&&clearTimeout(this.authenticateTimer_)},e.prototype.deauthenticate=function(){this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources");var e=this.adobePass;return e?e.logout():S.resolve(!1)},e.prototype.getRegistrationCode=function(){var e=this;_.debug("AdobePassAuthenticator.getRegistrationCode");var t=this.adobePass;return t?t.createRegistrationCode().then((function(t){return e.currentRegistrationCode=t,t?t.code:""})):S.reject(new Error("adobe pass not configured"))},e.prototype.checkAuthorization=function(e){var t=this;if(-1===e.authenticationTypes.indexOf(Ut.mvpd)||!this.isAuthenticated)return S.resolve(new mn(!1,null));var n=e.mrss,i=this.authenticatedPackage&&this.authenticatedPackage.id;i&&(n=On(n,i,e.id));var r=n,a=this.adobePass;return a.authorizeToken(r)})).then((function(e){var n,i=e.serializedToken,a=((n={})[fn.CustomDataKey.token]=i,n[fn.CustomDataKey.tokenType]="ADOBEPASS",n[fn.CustomDataKey.resource]=r,n[fn.CustomDataKey.requestor]=t.requestorId,n),s=new fn(Ut.mvpd,t.authenticatedProvider,t.authenticatedIdentity,a);return new mn(!0,s)})).catch((function(e){try{return e.json().then((function(e){var n=t.configuration.adobeAuthErrorRegex,i=new RegExp(n),r=e.message,a=e.details,s="This channel is not part of your TV package.";return i.test(r)?a&&(s=a):s=r,S.reject(new Error(s))}))}catch(e){return S.reject(new Error("There was an unexpected error."))}}))},e.prototype.getPreauthorizedResources=function(){var e=this.configuration,t=e.preauthorizeNetworksEnabled,n=e.preauthorizeNetworks,i=e.preauthorizeNetworksMapping;if(!1===t){var r=n;return Object.keys(i).forEach((function(e){var t=i[e];-1!==r.indexOf(e)&&-1===r.indexOf(t)&&r.push(t)})),S.resolve(r)}return 0===n.length?S.resolve([]):this.adobePass.preauthorize(n).then((function(e){var t=e.resourcethorized})).map((function(e){return e.id}));return Object.keys(i).forEach((function(e){var n=i[e];-1!==t.indexOf(e)&&-1===t.indexOf(n)&&t.push(n)})),t}))},e.defaultConfiguration=Nn}(),I((function(e,t){var n;e.exporeturn i}(Math),n)}),u.SHn))}}HmacS.Base64)}))),jn=function(){function e(e,t,n,i,r,a,s,o,c){this.id=e,this.name=t,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=s,this.availability=o,this.accessType=c,this.id=e,this.name=t,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=s,this.availability=o,this.accessType=c}return e.prototype.getPreferredLogoUrl=function(e){var t=this.images.filter((function(e){return"COLOR_NEGATIVE"===e.type})).map((function(e){return e.type}))[0],n=this.images.filter((function(e){return"BW_NEGATIVE"===e.type})).map((function(e){return e.type}))[0]||t;return n?"https://s.secure.espncdn.com/stitcher/watch/clients/"+e+"-web/providers/"+this.adobeId+".png?height=40&imageType="+n:this.images.filter((function(e){return"DESKTOP"===e.type})).map((function(e){return e.href}))[0]||null},e.prototypebeId+"ve="tve"}(Dn||(Dn={}));variceUrl=e};function Rn(e,t){var n=e.tier||99,i=t.tier||99;if(n<i)return-1;if(n>i)return 1;var r=e.rank||9999,a=t.rank||9999;if(r<a)return-1;if(r>a)return 1;var s=e.name.toLowerCase(),o=t.name.toLowerCase();return s<o?-1:s>o?1:0}var Fn={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function Hn(e,t){if(!e)return null;var n=e.id,i=e.name,r=e.websiteUrl,a=e.adobeId,s=e.logos,o=e.accessType,c=function(e){return Object.keys(e&&!!e[te:Fn[t]}}))}(s),u=e.countrieerCase()}))[0],l=u&&u.tier,d=u&&u.rank;return new jn(n,i,a,l,r,c,d,null,o)}function Bn(e,t){return e.rows?e..data,t)})).sort(Rn):[Hn(e,t)]}var zn={};zn[Un.mvpd]="adobeId",zn[Un.isp]="ispId",zn[Un.tve]="id";var Vn=new xn("https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),Gn=(function(){function e(e){this.locationProvider=e||{getCoturn"us"}},this.applicationId=null,this.configuration=Vn}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(e){this.applicationId_=e},enumerable:!0,configurable:!0}),e.prototype.getProvider=function(e,t,n){return void 0===n&&(n={}),C(this,void 0,void 0,(function(){var i,r,a,s;return O(this,(function(o){switch(o.label){case 0:return i=t||Un.mvpd,r=zn[i]||"adobeId",n[r]=e,[4,this.getProviders(n)];case 1:if(a=o.sent(),!(s=a[0]))throw new Error("Unable to find provider.");return[2,s]}}))}))},e.prototype.getProviders=function(e){return void 0===e&&(e={}),C(this,void 0,void 0,(function(){var t,n,i,r,a,s,o;return O(this,(function(c){switch(c.label){case 0:t=this.configuration.serviceUrl,n=-1===t.indexOf("?")?"?":"&",i=this.applic)?"US":e}(this.locationProvider.getCountryCode().toUpperCase()),e.country=r,i&&(e.application=i),a=Object.keys(e).map((function(t){if("id"!==t)return t+"="+encodeURIComponent(e[t])})).join("&"),s=""+t+n+a,e.id&&(o=t.split("?"),s=o[0]+"/"+e.id+"?"+o[1]),c.label=1;case 1:return c.trys.push([1,4,,5]),[4,T(s)];case 2:return[4,c.sent().json()];case 3:return[2,Bn(c.sent(),r)];case 4:return c.sent(),[2,[]];case 5:return[2]}}))}))},e.defaultConfiguration=Vn}(),fplatform}Object.defineProperty(e.prototype,"preauthorizedResources",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAuthenticaokention(e){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedIdententientity")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedProvider",{get:function(){var e=localStorage.getItem("TokenAuthenticator.authenticatedProvider");try{return dn.fromObject(JSON.parse(e))}catch(e){return null}},set:function(e){e?localStorage.setItem("TokenAuthenticator.authenticatedProvider",JSON.stringify(e)):localStorage.removeItem("TokenAuthenticator.authenticatedProvider")},enumerable:!1,configurable:!0}),e.prototype.setToken=function(e,t,n,i){this.token=e,this.tokenType=t,this.resource=n,this.zipcode=i},e.prototype.checkAuthentication=function(){var e=this,t=this.authenticatedProviderId;if(!t||this.authenticatedProvider&&t===this.authenticatedProvider.id)return S.resolve(this.isAuthenticated);if(!this.providerDataSource)return this.authenticatedProvider=new dn(t,t,null,null),S.resolve(this.isAuthenticated);var n,i="ADOBEPASS"===(n=this.tokenType)?Un.mvpd:"DEVICE"===n?Un.isp:"AUTHTOKEN"===n?Un.mvpd:null;return this.providerDataSource.getProvider(t,i).then((function(n){var i=n.getPreferredLogoUrl(e.partner);return e.authenticatedProvider=new dn(t,n.name,i,n.websiteUrl),S.resolve(e.isAuthenticated)})).catch((function(){return e.authenticatedProvider=new dn(t,t,null,null),S.resolve(e.isAuthenticated)}))},e.prototype.authenticate=function(e){var t=e.authenticatedProviderId,n=e.authenticatedIdentity,i=e.token,r=e.tokenType,a=e.zipcode;return this.authenticatedProviderId=t,this.authenticatedIdentity=n,this.setToken(i,r,null,a),this.checkAuthentication()},e.prototype.deauthenticate=function(){return this.authenticatedProvider=null,this.authenticatedIdentity=null,this.token=null,this.tokenType=null,this.resource=null,this.zipcode=null,S.resolve(!0)},e.prototype.checkAuthorization=function(e){var t,n,i="ADOBEPASS"===(n=this.tokenType)?Ut.mvpd:"DEVICE"===n?Ut.isp:"BAM"===n?Ut.direct:"AUTHTOKEN"===n||"GATEKEEPER"===n?Ut.mvpd:null;if(!this.isAuthenticated||-1===e.authenticationTypes.indexOf(i)&&"DEVICE"!==this.tokenType&&"GATEKEEPER"!==this.tokenType)return S.resolve(new mn(!1,null));var r=((t={})[fn.CustomDataKey.token]=this.token,t[fn.CustomDataKey.tokenType]=this.tokenType,t);this.zipcode&&(r.zipcode=this.zipcode),this.resource&&(r.resource=this.resource);var a=new fn(i,this.authenticatedProvider,this.authenticatedIdentity,r),s=new mn(!0,a);return S.resolve(enc.Utgify(e))},Kn={production:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyZGJmZWM4My03OWE1LTQyNzEtYTVmZC04NTZjYTMxMjRjNjMiLCJuYmYiOjE1NDAyMTI3NjEsImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjEyNzYxfQ.yaK3r4AI2uLVvsyN1GLzqzgzRlxMPtasSaiYYBV0wIstqih5tvjTmeoLmi8Xy9Kp_U7Md-bOffwiyK3srHkpUkhhwXLH2x6RPjmS1tPmhaG7-3LBcHTf2ySPvXhVf7cN4ngldawK4tdtLtsw6rF_JoZE2yaC6XbS2F51nXSFEDDnOQWIHEQRG3aYAj-38P2CLGf7g-Yfhbp5cKXeksHHQ90u3eOO4WH0EAjc9oO47h33U8KMEXxJbvjV5J8Va2G2fQSgLDZ013NBI3kQnE313qgqQh2feQILkyCENpB7g-TVBreAjOaH1fU471htSoGGYepcAXv-UDtpgitDiLy7CQ",staging:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhMmRjNjgyMC1kZGNkLTQ4NGEtOTdlNS0xZjJiZmQzOGI4YzgiLCJuYmYiOjE1NDAyMjIwNTksImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjIyMDU5fQ.YgX4ecGCgLCaZS7uwRQYZ8UR5EwT7GIl-glFbwU122bO1JYZSmbIX8YJSfmYth_scyeg-15BYWNftV9lOcmCe8VwIsQMJMIZKaF8qSIj5OfuTOBpNZNBpDAp5dC3zG7Zp1xLe3z-T0Y18-0BGj2yhGcJxBz4gtLXQ30Bw0LEIJ89nXCQaXFTq9N6zhDzMfkFJNnSNEvEmvcQqB4bFPIqn2is8427oQDU4D0XYvvTtx9eb5hmzKc9MbBG-8KRBA62BqdHomA5UA4kBYJKpe-8B2hO07Adi2bZoo5wP_VLNAnAxANWNXaGQYHMDjHDrHbbvuKHBudHgKxAuKpIdC7UrArRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),Yn="mvpd",Jn="upstreamUserID",Qn="packageId",$n="tier",Xn="hba_status",Zn={},ei=function(){function e(t,n,i,r,a){this.partner=t,this.platform=n,this.requestorId=i,this.options=r,this.configuration=Wn;var s=r||{},o=s.environment,c=void 0===o?e.Environment.PRODUCTION:o,u=s.errorEventHandlerName,l=void 0===u?"AEErrorHandler":u;this.accessEnabler=null,this.environment=c,this.errorEventHandlerName=l,this.resolveEntitlementLoaded_=null,this.resolveCheckAuthenticationCompletions_=[],this.resolveAuthenticate_=null,this.resolveDeauthenticate_=null,this.resolveAuthorization_=null,this.resolvePreauthorizes_=[],this.resolveAuthenticateMetadataDependencies_={},this.softwareStatements=a||Kn,this.delegate=null,this.providerDataSource=null,this.storage=localStorage,this.state_={};try{var d=this.storage.getItem("watchsdk.web_adobe_pass_authenticator.state"),h=JSON.parse(d);h.authenticatedProvider&&(h.authenticatedProvider=dn.fromObject(h.authenticatedProvider)),h.authenticatedPackage&&(h.authenticatedPackage=Cn.fromObject(h.authenticatedPackage)),this.state_=h}catch(e){}this.initialization_=this.initialize(),window.tokenRequestFailed=this.tokenRequestFailed.bind(this)}return Object.defineProperty(e.prototype,"configuraturatation_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAuthenticaString()},set:function(e){this.state_.isAuthenticated=e,qn(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedIdentity",{get:function(){return this.state_.authenticatedIdentity},set:function(e){if(!e)return delete this.state_.authenticatedIdentity,void qn(this.state_.toString,this.storage);this.state_.authenticatedIdentity=e,qn(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedPackage",{get:function(){return this.state_.authenticatedPackage},set:function(e){if(!e)return delete this.state_.authenticatedPackage,void qn(this.state_,this.storage);this.state_.authenticatedPackage=e,qn(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedProviProvider},set:function(e){if(!e)return delete this.state_.authenticatedProvider,void qn(this.state_,this.storage);this.state_.authenticatedProvider=e,qn(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wasPreviouslyAuthenticated",{get:function(){var e,t;return"true"===(null===(t=null===(e=this.state_)||void 0===e?void 0:e.wasPreviouslyAuthenticated)||void 0===t?void 0:t.toString())||!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preauthorizedResoururces:[]},enumerable:!0,configurable:!0}),e.prototype.checkAuthentication=function(){var e=this;return _.debug("AdobePassAuthenticator.checkAuthentication"),this.accessEnabler?new S((function(t){e.resolveCheckAuthenticationCompletions_.push((function(e){t(e)})),e.accessEnabler.checkAuthentication()})):S.reject(null)},e.prototype.authenticate=function(e){var t=this;if(_.debug("AdobePassClient.authenticate"),!this.accessEnabler)return S.reject(null);var n=e&&e.redirectUrl||window.location.href;return new S((function(e){t.resolveAuthenticate_=function(t){e(t)},t.accessEnabler.getAuthentication(n)}))},e.prototype.deauthenticate=function(){var e=this;return _.debug("AdobePassAuthenticator.deauthenticate"),this.accessEnabler?new S((function(t){e.resolveDeauthenticate_=function(e){t(e)},e.accessEnabler.logout()})):S.reject(null)},e.prototype.checkAuthorization=function(e){var t,n=this;if(_.debug("AdobePassClient.checkAuthorization "+e),-1===(null===(t=e.authenticationTypes)||void 0===t?void 0:t.indexOf(Ut.mvpd))||!this.isAuthenticated){var i=new mn(!1,null);return S.resolve(i)}var r=e.mrss,a=this.authenticatedPackage&&this.authenticatedPackage.id;a&&(r=On(r,a,e.id));var s=r;return new S((function(e,t){n.resolveAuthorization_=function(i){var r,a=i.token,s=i.resourceId,o=i.errorId,c=i.message;if(a||!o){var u=((r={})[fn.CustomDataKey.token]=Ln.stringify(Gn.parse(a)),r[fn.CustomDataKey.tokenType]="ADOBEPASS",r[fn.CustomDataKey.resource]=s,r),l=new fn(Ut.mvpd,n.authenticatedProvider,n.authenticatedIdentity,u),d=new mn(!0,l);e(d)}else t(new Error(c||o))},n.accessEnabler.getAuthorization(s)}))},e.prototype.sevider(e)},Object.defineProperty(e.prototype,"isHomeBasedAatus||!1},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){var e=this,t=this.environment;return function(e,t){var n=window&&window.document;if(!n)return S.reject();if(window.Adobe&&window.Adobe.AccessEnabler){var i=new window.Adobe.AccessEnabler(t);return S.resolve(i)}return new S((function(i,r){var a=n.createElement("script");a.id="ae_js",a.type="text/javascript",a.async=!0,a.src=e,a.addEventListener("load",(function(){var e=new window.Adobe.AccessEnabler(t);i(e)})),a.addEventListeneron(){r()})),n.getElementsByTagName("head")[0].appendChild(a)}))}(Zn[t],this.softwareStatements[esolve()})).then((function(){retulbacks()}))}))},e.prototype.bindAccessEnablerCallbacks=function(){window.entitlementLoaded=this.entitlementLoaded.bind(this),window.setAuthenticationStatus=this.setAuthenticationStatus.bind(this),window.setMetadataStatus=this.setMetadataStatus.bind(this),window.displayProviderDialog=this.displayProviderDialog.bind(this),window.setConfig=this.setConfig.bind(this),window.sendTrackingData=this.sendTrackingData.bind(this),window.preauthorizedResources=this.handlePreauthorizedResources.bind(this),window.selectedProvider=this.selectedProvider.bind(this),window.setToken=this.setToken.bind(this),window[this.errorEventHandlerName]=this.handleAccessEnablerError.bind(this)},e.prototype.entitlementLoaded=function(){_.debug("AdobePassAuthenticator.entitlementLoaded"),this.accessEnabler&&(this.accessEnabler.bind("errorEvent",this.errorEventHandlerName),this.accessEnabler.setRequestor(this.requestorId),this.resolveEntitlementLoaded_&&(this.resolveEntitlementLoaded_(!0),this.resolveEntitlementLoaded_=null))},e.prototype.setAuthenticationStatus=function(e,t){var n=this;if(_.debug("AdobePassAuthenticator.setAuthenticationStatus",e,t),this.isAuthenticated=!!e,this.isAuthenticated){this.accessEnabler.getMetadata(Jn);var i=[Qn,$n,Xn,Yn].map((function(e){return new S((function(t){n.resolveAuthenticateMetadataDependencies_[e]=function(e){t(e)},n.accessEnabler.getMetadata(e)}(e),null}))}));i.push(this.getPreauthorizedResourcesources=e}))),S.all(i).then((function(){n.resolveCheckAuthenticationCompletions_.forEach((function(e){e(n.isAuthenticated)})),n.resolveCheckAuthenticationCompletions_=[],n.resolveAuthenticate_&&(n.resolveAuthenticate_(n.isAuthenticated),n.resolveAuthenticate_=null)}))}else this.authenticatedIdentity=null,this.authenticatedPackage=null,this.authenticatedProvider=null,this.hbaStatus=null,this.state_.preauthorizedResources=[],this.resolveCheckAuthenticationCompletions_ticated)})),this.resolveCheckAuthenticationCompletions_=[],this.resolveDeauthenticate_&&(this.resolveDeauthenticate_(this.isAuthenticated),this.resolveDeauthenticate_=null)},e.prototype.setMetadataStatus=function(e,t,n){var i=this;switch(_.debug("AdobePassAuthenticator.setMetadataStatus",e,n),e){case Yn:var r=n;this.providerDataSource?this.providerDataSource.getProvider(r).then((function(t){var a=t.images||[],s=a.filter((function(e){return"COLOR_NEGATIVE"===e.type})).map((function(e){return e.href}))[0],o===e.type})).map((function(e){return e.href}))[0]||n e.href}))[0];i.authenticatedProvider=new dn(r,t.name,o,t.websiteUrl),i.authenticatedProvider.isHomeBasedAuth=i.hbaStatus,i.resolveAuthenticateMetadata_(e,n)})).catch((function(){i.authenticatedProvider=new dn(r,r,null,null),i.resolveAuthenticateMetadata_(e,n)})):(this.authenticatedProvider=new dn(r,r,null,null),this.resolveAuthenticateMetadata_(e,n));break;case Jn:this.authenticatedIdentity=n,this.resolveAuthenticateMetadata_(e,n);break;case Xn:this.hbaStatus="true"===n,this.resolveAuthenticateMetadata_(e,n);break;case Qn:case $n:if(n){var a=this.authenticatedPackage||new Cn(null,null);e===Qn?a.id=n:e===$n&&(a.tier=n),this.authenticatedPackage=a}this.resolveAuthenticateMetadata_(e,n)}},e.prototype.displayProviderDialog=function(e){var t=this;_.debug("AdobePassAuthenticator.displayProviderDialog",e),this.providerDataSource&&this.providerDataSource.getProvidervider(e)}))},e.prototype.ction(){},e.prototype.sendTrackingData=function(e,t){if("authenticationDetection"===e){var n={success:t[0],mvpd:t[1],guid:t[2],isTokenCached:t[3],deviceType:t[4],clientType:t[5],os:t[6]};_.debug("AdobePassAuthenticator.sendTrackingData",e,n)}},e.prototype.handlePreauthorizedResources=function(e){_.debug("AdobePassAuthenticator.preauthorizedResources",e);var t=this.resolvePreauthorizes_.shift();t&&t(e)},e.prototype.selectedProvider=function(e){var t=e.MVPD,n=e.AEstate_;_.debug("AdobePassAuthenticator.selectedProvider mvpd: "+t+", aeState: "+n)},e.prototype.setToken=function(e,t){_.debug("Requested resource: "+e+" tokenResult: "+t),this.resolveAuthorization_&&(this.resolveAuthorization_({resourceId:e,token:t}),this.resolveAuthorization_=null)},e.prototype.handleAccessEnablerError=function(e){var t=e.errorId,n=e.message;switch(_.debug("AdobePassAuthenticator.handleAccessEnablerError errorId: "+t+", message: "+n),t){case"Z100":_.error("Failure to authorize: "+n);var i=this.configuration.adobeAuthErrorRegex,r=new RegExp(i).test(n)?"This channel is not part of your TV package.":n;this.resolveAuthorization_&&(this.resolveAuthorization_({errorId:t,message:r}),this.resolveAuthorization_=null);break;case"N130":this.checkAuthentication()}},e.prototype.tokenRequFailed")},e.prototype.resolveAuthenticateMetadata_=function(e,t){var n=this.resolveAuthenticateMetadataDependencies_[e];n&&(n(t),delete this.resolveAuthenticateMetadataDependencies_[e])},e.prototype.getPreauthorizedResources_=function(){var e=this;_.debug("AdobePassAuthenticator.getPreauthorizedResources_");var t=this.configuration,n=t.preauthorizeNetworksEnabled,i=t.preauthorizeNetworks,r=t.preauthorizeNetworksMapping;if(!1===n){var a=i;return Object.keys(r).forEach((function(e){var t=r[e];-1!==a.indexOf(e)&&-1===a.indexOf(t)&&a.push(t)})),S.resolve(a)}if(0===i.length||!0!==this.isAuthenticated)return S.resolve([]);if(!this.accessEnabler)return S.reject(null);var s=function e(t,n){return t.length?N([t.slice(0,n)],e(t.slice(n),n)):[]}(i,5),o=[],c=s.map((function(t){return new S((function(n(e){n(e)})),e.accessEnabler.checkPreauthorizedResources(t)}return[]}))}));return this.resolvePreauthorizes_=o,S.allt)}),[])}))},e.defaultConfiguration=Wn,e}();ei.Environment={PRODUCTION:"production",STAGING:"staging"},ei.EventType={PREAUTHORIZED:"preauthorized",NOT_PREAUTHORIZED:"not_preauthorized"},Zn[ei.Environment.PRODUCTION]="https://entitlement.auth.adobe.com/entitlement/v4/AccessEnabler.js",Zn[ei.Environment.STAGING]="https://entitlement.auth-staging.adobe.com/entitlement/v4/AccessEnabler.js";var ti,ni=function(e){c(n,e);var t=h(n);function n(e,r,a,s,o){var c;return i(this,n),(c=t.call(this)).partner=e,c.platform=r,c.requestorId=a,c.options=s,c.softwareStatements=o,c}return a(n,[{key:"configuration",get:function(){var e=se.shared.getConfiguration("adobePass",ei.defaultConfiguration);return _.debug("WebAdobePassAuthenticator.getConfiguration ".concat(JSON.stringify(e)this,!0)}}]layback"}(ti||(ti={}));var ii,ri=ti;!function(e){e.linear="linear",e.event="event"}(ii||(ii={}));var Preroll"}(ai||(ai={}));var oi,ci=ai;!function(e){e.live="live",e.onDemand="onDemand"}(oi||(oi={}));var ui,li=oi;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(ui||(ui={}));var di,hi=ui;!function(e){e.shortform="shortform",e.longform="longform"}(di||(di={}));var ="video"}(pi||(pi={}));var temFeed"}(mi||(mi={}));var yi,vi=mi;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(yi||(yi={}));var tlement"}(bi||(bi={}));var Ii=bi,_i=fariant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,Ii[i],r,a,s,o,c,u)},e}(),Pi=fsource=i}return e.fromObject=function(t){if(!t)return null;var n=si[t.type];return new e(t.id,n,t.name,t.resource)},e}(),Si=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),Ti=fs.name=e}return Object.defineProperty(e.prototype,"logoe+".png"},enumerable:!1,configurable:!0}),e.fme):null},e}(),ki=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=ri.all,this.images=[],this.type=gi.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLini.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isL=li.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=_i.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return Si.fromObject(e)})),i.mrss=t.mrss,i.network=Pi.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=li[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return Ti.fromObject(e)})),i.tier=t.tier,i.type=gi[t.type],i.entityType=fi[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var Ai,Ei=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=fi.shortform:this.entityType=fi.longform,this.type=gi.video}return e.prototype.toString=function(e){return e==vi.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case vi.cfa:return"natgeo://playVideo?videoID="+e;case vi.itemFeed:return"abcnews://playVideo?playChannel="+e;case vi.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function Ci(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===Ai.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=pi.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===fi.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===fi.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===fi.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===fi.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===si.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=Ai.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,g=e.coverageType,y=e.brands,v={};if(v.ContentDuration=n,t===fi.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(y)&&y.length){var w=y[0],I=w.id,_=w.name,P=w.type;v["a.media.asset"]=I,v["a.media.show"]=_,v["a.media.genre"]=P}}else if(t===fi.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}g&&(v.VideoTypeDetail=g)}return v}(t,n));var c={};return c[hi.nielsen]=r,c[hi.comscore]=a,c[hi.conviva]=s,c[hi.heartbeats]=o,c}function Oi(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(Ai||(Ai={}));var Di=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Ni=function(e,t,n,i){e==vi.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Di):e==vi.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===vi.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},Mi=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return O(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new Ei(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof ki}))).length?[2,Oi(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,g;return O(this,(function(y){switch(y.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===fi.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,y.sent().json()];case 3:if(s=y.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,g=e.seekInSeconds,y=e.tracking,v=e.simulcastAiringId,b=e.network,w=e.status,I=e.cerebroId,_=e.syndicatable,P=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?li.live:li.onDemand,S=function(e){switch(e){case"NONE":return Ii.none;case"START_SESSION":return Ii.startSession;case"BAM":return Ii.bam;case"SHIELD":return Ii.shield}}(d.authorizationType),T=new _i(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===ci.stitchedPreroll&&h&&((T=new _i(h.url,Ii.none)).variant=ci.stitchedPreroll);var k=u?ri.linearPlayback:ri.all,A=y&&y.trackingId||i,E=new ki(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return wi.direct;case"OPEN":return wi.open;case"MVPD":return wi.mvpd;case"ISP":return wi.isp;default:return wi.none}})),E.description=a,E.isSyndicatable=_,o&&o.url&&E.images.push(new Si(o.url)),E.mrss=m,b){var C="linear"===b.type?si.linear:si.event;E.network=new Pi(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=P,E.supportedMediaCommands=k,E.brand=E.brand?E.brand:"espn",E.tracking=Ci(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:A,cerebroId:I},E.type=gi.video,E.entityType=t,E.apiSource=vi.graphQL,E.packages=(p||[]).map((function(e){return new Ti(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===si.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),_.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return O(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=Ei.identifierStringForNetwork(t,vi.graphQL),s=new Ei(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof ki==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),_.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new Ni(vi.graphQL),e}();var Li=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Ei(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof ki}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,g=new _i(a.url,m),y=new ki(t,n,r,l,g);return y.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return wi.direct;case"OPEN":return wi.open;case"MVPD":return wi.mvpd;case"ISP":return wi.isp;default:return wi.none}})),y.description=i,d&&(y.network=new Pi(d.id,d.type,d.name,d.resource)),y.streamType=c,y.brand=h,y.tracking=Ci(y.brand,e,f,g),y.images=p,y.type=s,y.entityType=f,y.apiSource=vi.cfa,y}(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Ni(vi.cfa),e}(),ji=Object.freeze({}),Ui=Object.freeze({}),xi=vi.itemFeed,Ri={lf:"longform",sf:"shortform",live:"longform"},Fi={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},Hi={name:"abc_news_live",type:"linear"},Bi=["HLS_ALL","PDL_MED","PDL_LOW"];function zi(e){var t,n,i,r=(e||ji).channel||ji,a=r.item||ji,s=a["media-group"]||ji,o=s["media-content"]||Ui,c=s["media-title"],u=(function(e){for(var t,n,i=Bi.length,r=e.length,a=0;a<i;a++)for(var s=Bi[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||ji)["@attributes"]||ji,l=(s["media-thumbnail"]||ji)["@attributes"]||ji,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,g=u.duration,y=u.url,v=u.medium,b=(a.omniture||ji).channel||"",w=D(String(b).split(":"),1)[0],I=Fi[b]||Fi[void 0===w?"abcn":w]||"abcnews",_="vod"===p,P="live"===p,S=Ri[a.videoContentType]||(_?"shortform":"longform"),T=c||h,k=r.language||"en";try{n=(t=D(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var A="akamai live stream"!==a.mediatype||_?{}:E(E({},Hi),{id:d}),C={id:d,apiSource:xi,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:A,show:{title:T},title:T,duration:g,language:k,source:{url:y,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:I,type:"video"===v?"video":"audio",entityType:S,streamType:P?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:g,streamURL:y,custom:{contentId:d,assetType:_?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:g,isFullEpisode:"shortform"===S||P?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return ki.fromObject(C)}var Vi,Gi=I((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?st(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=ot(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=ot(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:ct(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),qi=(Gi.extract,Gi.parse,Gi.stringify,Gi.parseUrl,Gi.stringifyUrl,Gi.pick,Gi.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Ei(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof ki}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=Gi.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,zi(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Ni(vi.itemFeed),e}()),Ki=(function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return O(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return O(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?Li:e.match("abcnews")?qi:Mi,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}(),function(e,t,n){this.contentType=e,this.keySystem=t,this.licenseUrl=n});!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(Vi||(Vi={}));var Wi,Yi=Vi;!function(e){e.linear="linear",e.event="event"}(Wi||(Wi={}));var Ji,Qi=Wi;!function(e){e.stitchedPreroll="stitchedPreroll"}(Ji||(Ji={}));var $i,Xi=Ji;!function(e){e.live="live",e.onDemand="onDemand"}($i||($i={}));var Zi,er=$i;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(Zi||(Zi={}));var tr,nr=Zi;!function(e){e.shortform="shortform",e.longform="longform"}(tr||(tr={}));var ir,rr=tr;!function(e){e.audio="audio",e.video="video"}(ir||(ir={}));var ar,sr=ir;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(ar||(ar={}));var or,cr=ar;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(or||(or={}));var ur,lr=or;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(ur||(ur={}));var dr=ur,hr=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,dr[i],r,a,s,o,c,u)},e}(),pr=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=Qi[t.type];return new e(t.id,n,t.name,t.resource)},e}(),fr=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),mr=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),gr=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=Yi.all,this.images=[],this.type=sr.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===Qi.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===er.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=hr.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return fr.fromObject(e)})),i.mrss=t.mrss,i.network=pr.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=er[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return mr.fromObject(e)})),i.tier=t.tier,i.type=sr[t.type],i.entityType=rr[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var yr,vr=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=rr.shortform:this.entityType=rr.longform,this.type=sr.video}return e.prototype.toString=function(e){return e==cr.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case cr.cfa:return"natgeo://playVideo?videoID="+e;case cr.itemFeed:return"abcnews://playVideo?playChannel="+e;case cr.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function br(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===yr.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=ir.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===rr.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===rr.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===rr.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===rr.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===Qi.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=yr.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,g=e.coverageType,y=e.brands,v={};if(v.ContentDuration=n,t===rr.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(y)&&y.length){var w=y[0],I=w.id,_=w.name,P=w.type;v["a.media.asset"]=I,v["a.media.show"]=_,v["a.media.genre"]=P}}else if(t===rr.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}g&&(v.VideoTypeDetail=g)}return v}(t,n));var c={};return c[nr.nielsen]=r,c[nr.comscore]=a,c[nr.conviva]=s,c[nr.heartbeats]=o,c}function wr(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(yr||(yr={}));var Ir=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],_r=function(e,t,n,i){e==cr.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Ir):e==cr.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===cr.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},Pr=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return O(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new vr(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof gr}))).length?[2,wr(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,g;return O(this,(function(y){switch(y.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===rr.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,y.sent().json()];case 3:if(s=y.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,g=e.seekInSeconds,y=e.tracking,v=e.simulcastAiringId,b=e.network,w=e.status,I=e.cerebroId,_=e.syndicatable,P=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?er.live:er.onDemand,S=function(e){switch(e){case"NONE":return dr.none;case"START_SESSION":return dr.startSession;case"BAM":return dr.bam;case"SHIELD":return dr.shield}}(d.authorizationType),T=new hr(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===Xi.stitchedPreroll&&h&&((T=new hr(h.url,dr.none)).variant=Xi.stitchedPreroll);var k=u?Yi.linearPlayback:Yi.all,A=y&&y.trackingId||i,E=new gr(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return lr.direct;case"OPEN":return lr.open;case"MVPD":return lr.mvpd;case"ISP":return lr.isp;default:return lr.none}})),E.description=a,E.isSyndicatable=_,o&&o.url&&E.images.push(new fr(o.url)),E.mrss=m,b){var C="linear"===b.type?Qi.linear:Qi.event;E.network=new pr(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=P,E.supportedMediaCommands=k,E.brand=E.brand?E.brand:"espn",E.tracking=br(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:A,cerebroId:I},E.type=sr.video,E.entityType=t,E.apiSource=cr.graphQL,E.packages=(p||[]).map((function(e){return new mr(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===Qi.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),_.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return O(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=vr.identifierStringForNetwork(t,cr.graphQL),s=new vr(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof gr==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),_.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new _r(cr.graphQL),e}();var Sr=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new vr(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof gr}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,g=new hr(a.url,m),y=new gr(t,n,r,l,g);return y.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return lr.direct;case"OPEN":return lr.open;case"MVPD":return lr.mvpd;case"ISP":return lr.isp;default:return lr.none}})),y.description=i,d&&(y.network=new pr(d.id,d.type,d.name,d.resource)),y.streamType=c,y.brand=h,y.tracking=br(y.brand,e,f,g),y.images=p,y.type=s,y.entityType=f,y.apiSource=cr.cfa,y}(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new _r(cr.cfa),e}(),Tr=Object.freeze({}),kr=Object.freeze({}),Ar=cr.itemFeed,Er={lf:"longform",sf:"shortform",live:"longform"},Cr={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},Or={name:"abc_news_live",type:"linear"},Dr=["HLS_ALL","PDL_MED","PDL_LOW"];function Nr(e){var t,n,i,r=(e||Tr).channel||Tr,a=r.item||Tr,s=a["media-group"]||Tr,o=s["media-content"]||kr,c=s["media-title"],u=(function(e){for(var t,n,i=Dr.length,r=e.length,a=0;a<i;a++)for(var s=Dr[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||Tr)["@attributes"]||Tr,l=(s["media-thumbnail"]||Tr)["@attributes"]||Tr,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,g=u.duration,y=u.url,v=u.medium,b=(a.omniture||Tr).channel||"",w=D(String(b).split(":"),1)[0],I=Cr[b]||Cr[void 0===w?"abcn":w]||"abcnews",_="vod"===p,P="live"===p,S=Er[a.videoContentType]||(_?"shortform":"longform"),T=c||h,k=r.language||"en";try{n=(t=D(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var A="akamai live stream"!==a.mediatype||_?{}:E(E({},Or),{id:d}),C={id:d,apiSource:Ar,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:A,show:{title:T},title:T,duration:g,language:k,source:{url:y,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:I,type:"video"===v?"video":"audio",entityType:S,streamType:P?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:g,streamURL:y,custom:{contentId:d,assetType:_?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:g,isFullEpisode:"shortform"===S||P?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return gr.fromObject(C)}var Mr,Lr=I((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?st(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=ot(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=ot(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:ct(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),jr=(Lr.extract,Lr.parse,Lr.stringify,Lr.parseUrl,Lr.stringifyUrl,Lr.pick,Lr.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new vr(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof gr}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=Lr.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,Nr(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new _r(cr.itemFeed),e}()),Ur=(function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return O(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return O(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?Sr:e.match("abcnews")?jr:Pr,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}(),fracks=[]}return Object.defineProperty(e.prototype,"convivaContentMetadign(t,n)},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"<PlaybackSession playbackUrl:"+this.playbackUrl+", authenticationType:"+this.authenticationType+", authenticatedProvider:"+this.authenticatedProvider+">"},e}());!function(e){e.none="none",e.fairPlay="fairplay",e.playReady="playready",e.widevine="widevine"}(Mr||(Mr={}));var xr,Rr=Mr;!function(e){e.none="HLS",e.hlsFairplay="HLS_FAIRPLAY",e.dashPlayReady="DASH_PLAYREADY",e.dashWidevine="DASH_WIDEVINE"}(xr||(xr={}));var Fr,Hr=xr,Br=function(){function e(){}return e.prototype.initPlaybackSession=function(e,t,n){var i=e.source.url;if(e.source.variant===Xi.stitchedPreroll){var r=t.dictionaryForBrightcove();Object.keys(r).forEach((function(e){i=function(e,t,n){var i=-1===n.indexOf("?")?"?":"&";return n+i+e+"="+encodeURIComponent(t)}(e,r[e].toString(),i)}))}_.debug(i,e);var a=new Ur(i);return a.mediaItem=e,a.seekToTime=e.seekInSeconds,a.authenticationType=n.authenticationType,a.authenticatedProvider=n.authenticatedProvider,a.authenticatedIdentity=n.authenticatedIdentity,S.resolve(a)},e.SHA256)})),Vr=ftadata=n}return e.prototype.withSession=function(e){var t=e.authenticationType,n=e.authenticatedIdentity,i=e.authenticatedProvider,r=e.mediaItem;if(t!==lr.mvpd)return this;var a=n,s=i&&i.id;return this.metadata[H]=a,this.metadata[V]=r.network&&r.network.id,this.metadata[G]=r.streamType===er.live?R:F,this.metadata[q]="",this.metadata[W]=!!e.authenticatedProvider&&e.authenticatedProvider.isHomeBasedAuth,this.subject=a,this.identityProvider=s,this},e.prototype.withLocatioull,this},e.prototype.withServiceUrl=function(e){return this.serviceUrl=e,this},e.prototype.wits=e,this},e.protots||{}),e},e}(),Gr=function(){function e(e,t){this.partner=e,this.platform=t}return e.prototype.startSession=function(e,t,n,i,r,a){var s=["partner="+this.partner,"platform="+this.platform,"token="+encodeURIComponent(n),"tokenType="+i,"v=2.0.0","ttl=21600"];if(r){var o=L.stringify(j.parse(r));s.push("resource="+encodeURIComponent(o))}a&&Object.keys(a)t(a[e]))}));var c=/swid=*/g;s.some((function(e){return c.test(e)}))||s.push("swid="+encodeURIComponent(t));return T(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:s.join("&")}).then((function(e){return e.json()})).then((function(e){if(!e.session)throw new Error(e.message||"An unexpected error occurred. ["+e.abbreviation+"]");return e})).catch((function(e){if(e.message)throw new Error(e.message);return e.json().then((function(e){throw new Error(e.message||"An unexpected error occurred. ["+e.abbreviation+"]")}))}))},e}(),qr=function(){function e(e){this.authButler=e}return e.prototype.initPlaybackSession=function(e,t,n){var i=e.source.url;e.source.startSessionUrl&&e.source.type===dr.shield&&(i=e.source.startSessionUrl);try{var r=window&&window.location.protocol;r&&"https:"===r&&(i=i.replace(/^http(s?):/,r))}catch(e){}var a=n.customData,s=a.token,o=a.tokenType,c=a.resource,u=void 0===c?e.mrss:c,l=t&&t.swid,d=this.authButler;if(!d)throw new Error("startSession support not configured");return d.startSession(i,l,s,o,u,t.dictionaryForStartSession()).then((function(t){var i=function(e,t){var n=e.playbackUrl,i=new Ur(n);return i.token=t,i}(t,s);return i.mediaItem=e,i.seekToTime=e.seekInSeconds,i.authenticationType=n.authenticationType,i.authenticatedProvider=n.authenticatedProvider,i.authenticatedIdentity=n.authenticatedIdentity,i}))},e}(),Kr=function(){function e(){}return e.prototype.initPlaybasolve(i)},e}(),Wr="ADOBEPASS",Yr="JWT",Jr="AUTHTOKEN",Qr=function(e){if(e instanceof Error)throw e;return e.json&&e.json().then((function(e){var t=e.message||"An unexpected error occurred. ["+e.exception+"]";throw"com.espn.watch.api.AccessDeniedException"===e.exception&&(t="This content is not available for your package or region."),new Error(t)}))},$r=function(){function e(e,t){this.drmSupport=Hr.none,this.palEnabled=!1,this.palMaxLength=3e3,this.serviceUrl="https://watch.auth.api.espn.com",this.apiKey=e,this.serviceUrl=t||"https://watch.auth.api.espn.com"}return e.prototype.getAsset=function(e,t,n,i,r){var a=this.serviceUrl+"/video/auth/media/"+e+"/asset";return this.getAssetForUrl(a,t,n,i,r)},e.prototype.getAssetForUrl=function(e,t,n,i,r){var a=r||{},s={"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},o=-1===e.indexOf("?")?"?":"&",c=""+e+o+"apikey="+this.apiKey;if(t)if(n===Wr){if(a.adobeToken=t,i){var u=L.stringify(j.parse(i));a.adobeResource=u}}else n==Yr?s.Authorization="Bearer "+t:n==Jr?(o=-1===c.indexOf("?")?"?":"&",c=""+c+o+"authtoken="+t):a.token=t;return a.drmSupport=this.drmSupport,T(c,{method:"POST",headers:s,credentials:"include",body:Object.keys(a).map((function(e){return e+"="+encodeURIComponent(a[e])})).join("&"e.json()})).then((function(e){if(!e.stream){var t=e.message||"An unexpected error occurred.";throw new Error(t)}return e})).catch(Qr)},e.defaultServiceUrl="https://watch.auth.api.espn.com",e}(),Xr=function(){function e(e){this.shieldAPI=e}return e.prototype.initPlaybackSession=function(e,t,n){return C(this,void 0,void 0,(function(){var i,r,a,s,o,c,u,l,d,h,p,f,m,g,y,v,b,w,I,_;return O(this,(function(P){switch(P.label){case 0:if(!(i=this.shieldAPI))throw new Error("shield support not configured");if(r=i.palEnabled,a=i.palMaxLength,s=n.customData.token,o=n.customData.zipcode,c=n.customData,l=(u=void 0===c?{}:c).tokenType,d=u.resource,h=void 0===d?e.mrss:d,!r||null!==t.palNonce)return[3,4];P.label=1;case 1:return P.trys.push([1,3,,4]),p=t,[4,En.getGooglePalNonce(t,a)];case 2:return p.palNonce=P.sent(),[3,4];case 3:return f=P.sent(),console.warn(f),[3,4];case 4:return m=t.dictionaryForStartSession(),o&&(m.zipcode=o),g=e.source.url,[4,i.getAssetForUrl(g,s,l,h,m)];case 5:return y=P.sent(),v=y.stream,b=y.captions,w=y.streamInfo,I=y.gatekeeperToken,(_=new Ur(v)).mediaItem=e,_.seekToTime=e.seekInSeconds,_.authenticationType=n.authenticationType,_.authenticatedProvider=n.authenticatedProvider,_.authenticatedIdentity=n.authenticatedIdentity,_.token=I,_.playbackConfig=function(e){if(!e)return null;var t=e.streamType,n=e.licenseAcquisitionUrl,i=e.certificateUrl;switch(t){case"DASH_PLAYREADY":return new Ki("application/dash+xml",Mr.playReady,n);case"DASH_WIDEVINE":return new Ki("application/dash+xml",Mr.widevine,n);case"HLS_FAIRPLAY":return new Ki("application/x-mpegURL",Mr.fairPlay,i);case"HLS":return new Ki("application/x-mpegURL",Mr.none);default:return null}}(w),_.ttt"),[t]}(b),[2,_]}}))}))},e}(),Zr=function(){function e(){this.partner=null,this.platform=null,this.apiKey=null,this.deviceId=null,this.authenticators={},this.authorizers={},this.playbackSessionFactories={},this.playbackSessionFactories[Ii.none]=new Kr}return e.prototype.getAuthenticator=function(e){return this.authenticators[e]},e.prototype.setAuthenticator=function(e,t){var n=this;this.convertToArray(t).forEach((function(t){n.authenticators[t.toString()]=e}))},e.prototype.getAuthorizer=function(e){return this.authorizers[e]},e.prototype.setAuthorizer=function(e,t){var n=this;this.convertToArray(t)ing()]=e}))},e.prototype.getPlaybackSessiories[e]},e.prototype.setPlaybackSessiies[t]=e},e.prototype.checkAuthentication=function(){var e=this,t=Object.keys(this.authenticators).map((function(t){var n=e.authenticators[t];return n.checkAuthentication().then((function(e){return _.debug(t+" authenticator","isAuthenticated: "+e,"authenticatedProvider: "+n.authenticatedProvider),e})).catch((function(){return!1}))}));return S.all0===e}))}))},e.prototype.isAuthenticatedForMediaItem=function(e){var t=this;return e.authenticationTypes.length<1||-1!==e.authenticationTypes.indexOf(wi.none)||e.authenticationTypes.map((function(e){return t.authenticators[e]})).filter((function(e){return e})).some((function(e){return e.isAuthenticated}))},e.prototype.isAuthenticatedWitnticated},e.prototype.authenticateWiticate(t)},e.prototype.checkAuthorization=function(e,t){var n=this;if(e.authenticationTypes&&e.authenticationTypes.length<1||-1!==e.authenticationTypes.indexOf(wi.none)){var i=new dn(e.id,e.title,e.images[0].url,e.source.url),r=new fn(wi.none,i,e.id,{}),a=new mn(!0,r);return S.resolve(a)}var s=[wi.open,wi.mvpd,wi.direct,wi.ispdexOf(t)})),o=s.map((function(e){return n.authorizers[e]})rization}));return _.debug("mediaItem.authTypes:",s),0===o.length?S.reject(new Error("no authorizer configured to support authTypes: "+e.authenticationTypes)):function e(t,n,i,r){return void 0===r&&(r=[]),i.shift().checkAuthorization(t,n).then((function(a){return a.success?a:i.length<1?r.length>0?S.reject(null):a:e(t,n,i,r)})).catch((function(a){if(i.length>0)return a&&r.push(a),e(t,n,i,r);var s=r[0]||a;if(s)throw s}))}(e,t,o)},e.prototype.initPlaybackSession=function(e,t){var n=this;return!e.source.type&&e.authenticationTypes.length>0?S.reject(new Error("This event is not currently available.")):this.checkAuthorization(e,t).then((function(i){var r,a,s;_.debug("AuthenticationManager.initPlaybackSession.checkAuthorization result:",i.success);var o=i.success,c=i.payload;if(!o)throw new Error("Not authorized.");if(!(null===(r=null==e?void 0:e.source)||void 0===r?void 0:r.type))throw new Error("Media Item source type is missing.");var u=n.playbackSessionFactories[null===(a=null==e?void 0:e.source)||void 0===a?void 0:a.type];if(!u)throw new Error("SessionFactory for source type '"+(null===(s=null==e?void 0:e.source)||void 0===s?void 0:s.type)+"' is missing.");var l=new En;return l.authenticationProvider=i.payload.authenticatedProvider&&i.payload.authenticatedProvider.id,l.merge(t),u.initPlaybackSession(e,l,c).then((function(e){_.debug("AuthenticationManager.initPlaybackSession",e);var t=n.concurrencyMonitorBuilder&&n.concurrencyMonitorBuilder.withSession(e).build();return t?t.createSessioonId=t,e})):e}))}))},Object.defineProperty(e.prototype,"authStaious"),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preauthorizedResources",{get:function(){var e=this;return Object.keys(this.authenticators).map((function(t){return e.authenticators[t].preauthorizedResources})).reduce((function(e,t){return e.concat(t)}),[]f(e)===t}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryAuthenticatedProvider",{get:function(){var e=this;return[wi.mvpd,wi.isp].map((function(t){return e.getAuthenticator(t)})).filter((function(e){return e.isAuthenticated})).map((function(e){return e.authenticatedProvider}))[0]},enumerable:!1,configurable:!0}),e.prototype.conveush(e),t},e}();Zr.AuthenticateOptionsKey={redirectUrl:"redirectUrl"},function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(Fr||(Fr={}));var ea,ta=Fr;!function(e){e.linear="linear",e.event="event"}(ea||(ea={}));var na,ia=ea;!function(e){e.stitchedPreroll="stitchedPreroll"}(na||(na={}));var ra,aa=na;!function(e){e.live="live",e.onDemand="onDemand"}(ra||(ra={}));var sa,oa=ra;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(sa||(sa={}));var ca,ua=sa;!function(e){e.shortform="shortform",e.longform="longform"}(ca||(ca={}));var la,da=ca;!function(e){e.audio="audio",e.video="video"}(la||(la={}));var ha,pa=la;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(ha||(ha={}));var fa,ma=ha;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(fa||(fa={}));var ga,ya=fa;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(ga||(ga={}));var va=ga,ba=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,va[i],r,a,s,o,c,u)},e}(),wa=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=ia[t.type];return new e(t.id,n,t.name,t.resource)},e}(),Ia=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),_a=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),Pa=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=ta.all,this.images=[],this.type=pa.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===ia.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===oa.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=ba.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return Ia.fromObject(e)})),i.mrss=t.mrss,i.network=wa.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=oa[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return _a.fromObject(e)})),i.tier=t.tier,i.type=pa[t.type],i.entityType=da[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var Sa,Ta=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=da.shortform:this.entityType=da.longform,this.type=pa.video}return e.prototype.toString=function(e){return e==ma.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case ma.cfa:return"natgeo://playVideo?videoID="+e;case ma.itemFeed:return"abcnews://playVideo?playChannel="+e;case ma.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function ka(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===Sa.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=la.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===da.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===da.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===da.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===da.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===ia.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=Sa.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,g=e.coverageType,y=e.brands,v={};if(v.ContentDuration=n,t===da.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(y)&&y.length){var w=y[0],I=w.id,_=w.name,P=w.type;v["a.media.asset"]=I,v["a.media.show"]=_,v["a.media.genre"]=P}}else if(t===da.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}g&&(v.VideoTypeDetail=g)}return v}(t,n));var c={};return c[ua.nielsen]=r,c[ua.comscore]=a,c[ua.conviva]=s,c[ua.heartbeats]=o,c}function Aa(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(Sa||(Sa={}));var Ea=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Ca=function(e,t,n,i){e==ma.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Ea):e==ma.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===ma.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},Oa=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return O(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new Ta(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof Pa}))).length?[2,Aa(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,g;return O(this,(function(y){switch(y.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===da.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,y.sent().json()];case 3:if(s=y.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,g=e.seekInSeconds,y=e.tracking,v=e.simulcastAiringId,b=e.network,w=e.status,I=e.cerebroId,_=e.syndicatable,P=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?oa.live:oa.onDemand,S=function(e){switch(e){case"NONE":return va.none;case"START_SESSION":return va.startSession;case"BAM":return va.bam;case"SHIELD":return va.shield}}(d.authorizationType),T=new ba(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===aa.stitchedPreroll&&h&&((T=new ba(h.url,va.none)).variant=aa.stitchedPreroll);var k=u?ta.linearPlayback:ta.all,A=y&&y.trackingId||i,E=new Pa(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return ya.direct;case"OPEN":return ya.open;case"MVPD":return ya.mvpd;case"ISP":return ya.isp;default:return ya.none}})),E.description=a,E.isSyndicatable=_,o&&o.url&&E.images.push(new Ia(o.url)),E.mrss=m,b){var C="linear"===b.type?ia.linear:ia.event;E.network=new wa(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=P,E.supportedMediaCommands=k,E.brand=E.brand?E.brand:"espn",E.tracking=ka(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:A,cerebroId:I},E.type=pa.video,E.entityType=t,E.apiSource=ma.graphQL,E.packages=(p||[]).map((function(e){return new _a(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===ia.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),_.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return O(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=Ta.identifierStringForNetwork(t,ma.graphQL),s=new Ta(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof Pa==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),_.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new Ca(ma.graphQL),e}();var Da=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Ta(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof Pa}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,g=new ba(a.url,m),y=new Pa(t,n,r,l,g);return y.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return ya.direct;case"OPEN":return ya.open;case"MVPD":return ya.mvpd;case"ISP":return ya.isp;default:return ya.none}})),y.description=i,d&&(y.network=new wa(d.id,d.type,d.name,d.resource)),y.streamType=c,y.brand=h,y.tracking=ka(y.brand,e,f,g),y.images=p,y.type=s,y.entityType=f,y.apiSource=ma.cfa,y}(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Ca(ma.cfa),e}(),Na=Object.freeze({}),Ma=Object.freeze({}),La=ma.itemFeed,ja={lf:"longform",sf:"shortform",live:"longform"},Ua={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},xa={name:"abc_news_live",type:"linear"},Ra=["HLS_ALL","PDL_MED","PDL_LOW"];function Fa(e){var t,n,i,r=(e||Na).channel||Na,a=r.item||Na,s=a["media-group"]||Na,o=s["media-content"]||Ma,c=s["media-title"],u=(function(e){for(var t,n,i=Ra.length,r=e.length,a=0;a<i;a++)for(var s=Ra[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||Na)["@attributes"]||Na,l=(s["media-thumbnail"]||Na)["@attributes"]||Na,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,g=u.duration,y=u.url,v=u.medium,b=(a.omniture||Na).channel||"",w=D(String(b).split(":"),1)[0],I=Ua[b]||Ua[void 0===w?"abcn":w]||"abcnews",_="vod"===p,P="live"===p,S=ja[a.videoContentType]||(_?"shortform":"longform"),T=c||h,k=r.language||"en";try{n=(t=D(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var A="akamai live stream"!==a.mediatype||_?{}:E(E({},xa),{id:d}),C={id:d,apiSource:La,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:A,show:{title:T},title:T,duration:g,language:k,source:{url:y,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:I,type:"video"===v?"video":"audio",entityType:S,streamType:P?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:g,streamURL:y,custom:{contentId:d,assetType:_?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:g,isFullEpisode:"shortform"===S||P?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return Pa.fromObject(C)}var Ha=I((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?st(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=ot(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=ot(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:ct(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),Ba=(Ha.extract,Ha.parse,Ha.stringify,Ha.parseUrl,Ha.stringifyUrl,Ha.pick,Ha.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Ta(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof Pa}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=Ha.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,Fa(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Ca(ma.itemFeed),e}()),za=(function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return O(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return O(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?Da:e.match("abcnews")?Ba:Oa,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}(),function(){function e(){this.isAuthenticated=!0,this.authenticatedIdentity=null,this.authenticatedProvider=null,this.preauthorizedResources=this.isAuthenticated?["espn_free"]:[]}return e.prototype.checkAuthentication=function(){return S.resolve(!0)},e.prototype.authenticate=function(){return S.resolve(!0)},e.prototype.deauthenticate=function(){return S.resolve(!0)},e.prototype.checkAuthorization=function(e){var t;if(-1===e.authenticationTypes.indexOf(ya.open)||!this.isAuthenticated)return S.resolve(new mn(!1,null));var n=((t={})[fn.CustomDataKey.token]="IA==",t[fn.CustomDataKey.tokenType]="DEVICE",t),i=new fn(ya.open,this.authenticatedProvider,this.authenticatedIdentity,n),r=new mn(!0,i);return S.resolve(r)},e}()),Va=function(){function e(t,n,r){i(this,e),this.id=t,this.profile=n,this.preferences=r}return a(e,[{key:"favoriteSports",get:function(){return this.preferencea.teamId})).map((function(e){return e.metadata}))}},{key:"favoriteTeams",get:function(){return this.preferences.filter((function(e){return e.metadata.teamInfo})).map((function(e){return e.metadata}))}},{key:"fantasyPreferepe.id}))}},{key:"isLeagueManager",get:function(){return this.preferences.some((function(e){var t=e.metadata&&e.metadata.entry&&e.metadata.entry;return t&&!0===t.isLeagueManager}))}},{key:"toStri.id,">")}}],[{key:"fromJson",value:function(t){if(!t)return null;var n=Ga.fromJson(t.profile),i=t.preferences.map((function(e){return Wa.fromJson(e)}));return new e(t.id,n,i)}}]),e}(),Ga=function(){function e(t,n,r){i(this,e),this.isInsider=t,this.hasNotificationPreferences=n,this.settings=r}return a(e,[{key:"toStrices,">")}}],[{key:"fromJson",value:function(t){if(!t)return null;var n=qa.fromJson(t.settings);return new e(t.isInsider,t.hasNotificationPreferences,n)}}]),e}(),qa=function(){function e(t){i(this,e),this.videoAutoStart=t}return a(e,null,[{key:"fromJson",value:function(t){return t?new e(Ka.fromJson(t.videoAutoStart)):null}}]),e}(),Ka=function(){function e(t){i(this,e),this.value=t}return a(e,null,[{key:"fromJson",value:function(t){return t?new e(t.value):null}}]),e}(),Wa=function(){function e(t,n,r){i(this,e),this.id=t,this.metadata=n,this.type=r}return a(e,null,[{key:"fromJson",value:function(t){if(!t)return null;var n=Ja.fromJson(t.metaData||t.metadata),i=Ya.fromJson(t.type);return new e(t.id,n,i)}}]),e}(),Ya=fs.code=r}return a(e,null,[{key:"fromJsde):null}}]),e}(),Ja=f.entry=a}return a(e,[{key:"uid",get:function(){if(this.teamInfo)return this.teamInfo.uid;var e=null;return this.sportId&&(e="s:".concat(this.sportId),this.teamId&&(e="".concat(e,"~t:").concat(this.teamId))),e}}],[{key:"fromJson",value:function(t){if(!t)return null;var n=null;if(t.teamInfo)n=new Xa(t.teamInfo.uid,t.teamInfo.name,t.teamInfo.fullName,t.teamInfo.logoUrl,t.teamInfo.darkLogoUrl,t.teamInfo.scoreboardLogoUrl,t.teamInfo.scoreboardDarkLogoUrl);else if(t.team){var i=t.team,r=i.coreData.logoefault")})).map((function(e){return e.href}))[0],a=i.coreData.logos.filter((function(e){return-1!==e.rel.indexOf("dark")&&-1===e.rel.indexOf("scoreboard")})).map((function(e){return e.href}))[0],s=i.coreData.logos.filter((function(e){return-1!==e.rel.indexOf("scoreboard")&&-1===e.rel.indexOf("dark")})).map((function(e){return e.href}))[0],o=i.coreData.logo("dark")})).map((function(e){return e.href}))[0];n=new Xa(i.uid,i.name,i.text,r,a||r,s||r,o||a||r)}var c=Qa.fromJson(t.entry);return new e(t.sportId,t.teamId,n,c)}}]),e}(),Qa=fgroups=t}return a(e,[{key:"isLeagueMannager}))}}],[{key:"fromJson",value:function(t){return t?new e((t.groups||[]).map((function(e){return $a.fromJson(e)}))):null}}]),e}(),$a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i(this,e),this.groupManager=t}return a(e,null,[{key:"fromJson",value:function(t){return t?new e(t.groupManager):null}}]),e}(),Xa=a((function e(t,n,r,a,s,o,c){i(this,e),this.uid=t,this.name=n,this.fullName=r,this.logoUrl=a,this.darkLogoUrl=s,this.scoreboardLogoUrl=o,this.scoreboardDarkLogoUrl=c})),Za=fv2/fans"}return a(e,[{key:"getFan",value:function(e){var t=he.platform,n=this.serviceUrl||"https://fan.api.espn.com/apis/v2/fans";return T("".concat(n,"/").concat(encodeURIComponent(e),"?prefType=sports&prefType=teams&prefType=fantasy&coreData=logos"),{method:"GET",headers:{"X-Personalization-Source":"espn-watchsdk-js-".concat(t)}}).then((function(e){return e.json()})).then((function(e){return Va.fromJson(e)}))}}]),e}(),es=function(e){c(n,e);var t=h(n);function n(){return i(this,n),t.apply(this,arguments)}return a(n,null,[{key:"getFan",value:function(e){var t=se.shared.getConfiguration("fanApi",{serviceUrl:"https://fan.api.espn.com/apis/v2/fans"}).serviceUrl,n=new Za;return n.serviceUrl=t,n.getFan(e)}}]),n}(Za);localStorage.getItem("FanManager.anonSwid")||T("https://log.espn.com/log?srvc=sz&silent&returnBody=SWID&responseType=JSON").then((function(e){return e.json()Swid",t)}));var ts,ns=function(){function e(){i(this,e)}return a(e,null,[{key:"swid",get:function(){return localStorage.getItem("FanManager.anonSwid")}}]),e}(),is=function(){function e(){i(this,e)}return a(e,null,[{key:"|ns.swid},set:function(e){if(!e)return localStorage.removeItem("FanManager.swid"),void localStorage.removeItem("FanManager.fan");localStorage.setItem("FanManager.swid",e)}},{key:"fan",get:function(){var e=localStorage.getItem("FanManager.fan");try{return Va.fromJson(JSON.parse(e))}catch(e){return null}}},{key:"update",value:function(){var t=localStorage.getItem("FanManager.swid");return t?es.getFanfy(e)),e})):S.resolve(e.fan)}}]),e}(),rs=function(){function e(e,t,n,i,r,a,s,o,c){this.id=e,this.name=t,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=s,this.availability=o,this.accessType=c,this.id=e,this.name=t,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=s,this.availability=o,this.accessType=c}return e.prototype.getPreferredLogoUrl=function(e){var t=this.images.filter((function(e){return"COLOR_NEGATIVE"===e.type})).map((function(e){return e.type}))[0],n=this.images.filter((function(e){return"BW_NEGATIVE"===e.type})).map((function(e){return e.type}))[0]||t;return n?"https://s.secure.espncdn.com/stitcher/watch/clients/"+e+"-web/providers/"+this.adobeId+".png?height=40&imageType="+n:this.images.filter((function(e){return"DESKTOP"===e.type})).map((function(e){return e.href}))[0]||null},e.prototype.toString=function(){return"<Provider id:"+this.id+", name:"+this.name+", adobeId:"+this.adobeId+">"},e}();!function(e){e.mvpd="mvpd",e.isp="isp",e.tve="tve"}(ts||(ts={}));var as=ts,ss=function(e){this.serviceUrl=e,this.serviceUrl=e};function os(e,t){var n=e.tier||99,i=t.tier||99;if(n<i)return-1;if(n>i)return 1;var r=e.rank||9999,a=t.rank||9999;if(r<a)return-1;if(r>a)return 1;var s=e.name.toLowerCase(),o=t.name.toLowerCase();return s<o?-1:s>o?1:0}var cs={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function us(e,t){if(!e)return null;var n=e.id,i=e.name,r=e.websiteUrl,a=e.adobeId,s=e.logos,o=e.accessType,c=function(e){return Object.keys(e).filter((function(t){return cs[t]&&!!e[t]})).map((function(t){return{href:e[t].trim(),type:cs[t]}}))}(s),u=e.countries.filter((function(e){return e.countryCode.toLowerCase()===t.toLowerCase()}))[0],l=u&&u.tier,d=u&&u.rank;return new rs(n,i,a,l,r,c,d,null,o)}function ls(e,t){return e.rows?e.rows.map((function(e){return us(e.data,t)})).sort(os):[us(e,t)]}var ds={};ds[as.mvpd]="adobeId",ds[as.isp]="ispId",ds[as.tve]="id";var hs,ps=new ss("https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),fs=function(){function e(e){this.locationProvider=e||{getCountryCode:function(){return"us"}},this.applicationId=null,this.configuration=ps}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(e){this.applicationId_=e},enumerable:!0,configurable:!0}),e.prototype.getProvider=function(e,t,n){return void 0===n&&(n={}),C(this,void 0,void 0,(function(){var i,r,a,s;return O(this,(function(o){switch(o.label){case 0:return i=t||as.mvpd,r=ds[i]||"adobeId",n[r]=e,[4,this.getProviders(n)];case 1:if(a=o.sent(),!(s=a[0]))throw new Error("Unable to find provider.");return[2,s]}}))}))},e.prototype.getProviders=function(e){return void 0===e&&(e={}),C(this,void 0,void 0,(function(){var t,n,i,r,a,s,o;return O(this,(function(c){switch(c.label){case 0:t=this.configuration.serviceUrl,n=-1===t.indexOf("?")?"?":"&",i=this.applicationId,r=function(e){return-1!==["PR","GU","VI"].indexOf(e)?"US":e}(this.locationProvider.getCountryCode().toUpperCase()),e.country=r,i&&(e.application=i),a=Object.keys(e).map((function(t){if("id"!==t)return t+"="+encodeURIComponent(e[t])})).join("&"),s=""+t+n+a,e.id&&(o=t.split("?"),s=o[0]+"/"+e.id+"?"+o[1]),c.label=1;case 1:return c.trys.push([1,4,,5]),[4,T(s)];case 2:return[4,c.sent().json()];case 3:return[2,ls(c.sent(),r)];case 4:return c.sent(),[2,[]];case 5:return[2]}}))}))},e.defaultConfiguration=p){}}]s"}}]),n}(ms),ys=function(e){c(r,e);var t=h(r);function r(e){return i(this,r),t.call(this,e||new gs)}return a(r,[{key:"configuration",get:function(){var e=se.shared.getConfiguration("provider",n({applicationKeyMap:{}},fs.defaultConfiguration));return _.debug("ESPNAffiliateAPI.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(u(r.prototype),"configuration",e,this,!0)}},{key:"applicationId",get:functio"VI"===e}(this.locationProvider.getCountryCode().toUpperCase())&&"web"===he.platform?"".concat(he.partner,"_").concat(he.platform):"".concat(he.platform),t=this.configuration.applicationKeyMap||{};return t[e]&&(e=t[e]),_.debug("ESPNAffiliateAPI.getApplicationId ".concat(e)),e},set:function(e){g(u(r.prototype),"applicationId",e,this,!0)}}]),r}(fs),vs=function(){function e(){i(this,e)}return a(e,null,[{key:"getBuilder",value:function(){var e,t=se.shared.getConfiguration("adobeCM",ce);if(!1===t.enabled)return null;var n=he.platform,i=t.applications&&t.applications[n],r=t.applicationId||i&&i.applicationId,a=(s(e={},B,r),s(e,z,n),s(e,K,""),s(e,Y,"false"),s(e,J,"ESPN"),e);return new Vr("ESPN",r,a).withServiceUrl(t.serviceUrl).withMessages(t.messages||{})}}]),e}();!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(hs||(hs={}));var bs,ws=hs;!function(e){e.linear="linear",e.event="event"}(bs||(bs={}));var Is,_s=bs;!function(e){e.stitchedPreroll="stitchedPreroll"}(Is||(Is={}));var Ps,Ss=Is;!function(e){e.live="live",e.onDemand="onDemand"}(Ps||(Ps={}));var Ts,ks=Ps;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(Ts||(Ts={}));var As,Es=Ts;!function(e){e.shortform="shortform",e.longform="longform"}(As||(As={}));var Cs,Os=As;!function(e){e.audio="audio",e.video="video"}(Cs||(Cs={}));var Ds,Ns=Cs;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(Ds||(Ds={}));var Ms,Ls=Ds;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(Ms||(Ms={}));var js,Us=Ms;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(js||(js={}));var xs=js,Rs=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,xs[i],r,a,s,o,c,u)},e}(),Fs=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=_s[t.type];return new e(t.id,n,t.name,t.resource)},e}(),Hs=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),Bs=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),zs=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=ws.all,this.images=[],this.type=Ns.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===_s.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===ks.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=Rs.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return Hs.fromObject(e)})),i.mrss=t.mrss,i.network=Fs.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=ks[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return Bs.fromObject(e)})),i.tier=t.tier,i.type=Ns[t.type],i.entityType=Os[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var Vs,Gs=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=Os.shortform:this.entityType=Os.longform,this.type=Ns.video}return e.prototype.toString=function(e){return e==Ls.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case Ls.cfa:return"natgeo://playVideo?videoID="+e;case Ls.itemFeed:return"abcnews://playVideo?playChannel="+e;case Ls.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function qs(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===Vs.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=Cs.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===Os.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===Os.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===Os.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===Os.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===_s.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=Vs.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,g=e.coverageType,y=e.brands,v={};if(v.ContentDuration=n,t===Os.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(y)&&y.length){var w=y[0],I=w.id,_=w.name,P=w.type;v["a.media.asset"]=I,v["a.media.show"]=_,v["a.media.genre"]=P}}else if(t===Os.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}g&&(v.VideoTypeDetail=g)}return v}(t,n));var c={};return c[Es.nielsen]=r,c[Es.comscore]=a,c[Es.conviva]=s,c[Es.heartbeats]=o,c}function Ks(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(Vs||(Vs={}));var Ws=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Ys=function(e,t,n,i){e==Ls.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Ws):e==Ls.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===Ls.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},Js=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return O(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new Gs(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof zs}))).length?[2,Ks(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,g;return O(this,(function(y){switch(y.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===Os.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,y.sent().json()];case 3:if(s=y.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,g=e.seekInSeconds,y=e.tracking,v=e.simulcastAiringId,b=e.network,w=e.status,I=e.cerebroId,_=e.syndicatable,P=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?ks.live:ks.onDemand,S=function(e){switch(e){case"NONE":return xs.none;case"START_SESSION":return xs.startSession;case"BAM":return xs.bam;case"SHIELD":return xs.shield}}(d.authorizationType),T=new Rs(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===Ss.stitchedPreroll&&h&&((T=new Rs(h.url,xs.none)).variant=Ss.stitchedPreroll);var k=u?ws.linearPlayback:ws.all,A=y&&y.trackingId||i,E=new zs(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return Us.direct;case"OPEN":return Us.open;case"MVPD":return Us.mvpd;case"ISP":return Us.isp;default:return Us.none}})),E.description=a,E.isSyndicatable=_,o&&o.url&&E.images.push(new Hs(o.url)),E.mrss=m,b){var C="linear"===b.type?_s.linear:_s.event;E.network=new Fs(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=P,E.supportedMediaCommands=k,E.brand=E.brand?E.brand:"espn",E.tracking=qs(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:A,cerebroId:I},E.type=Ns.video,E.entityType=t,E.apiSource=Ls.graphQL,E.packages=(p||[]).map((function(e){return new Bs(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===_s.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),_.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return O(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=Gs.identifierStringForNetwork(t,Ls.graphQL),s=new Gs(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof zs==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),_.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new Ys(Ls.graphQL),e}();var Qs=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Gs(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof zs}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,g=new Rs(a.url,m),y=new zs(t,n,r,l,g);return y.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return Us.direct;case"OPEN":return Us.open;case"MVPD":return Us.mvpd;case"ISP":return Us.isp;default:return Us.none}})),y.description=i,d&&(y.network=new Fs(d.id,d.type,d.name,d.resource)),y.streamType=c,y.brand=h,y.tracking=qs(y.brand,e,f,g),y.images=p,y.type=s,y.entityType=f,y.apiSource=Ls.cfa,y}(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Ys(Ls.cfa),e}(),$s=Object.freeze({}),Xs=Object.freeze({}),Zs=Ls.itemFeed,eo={lf:"longform",sf:"shortform",live:"longform"},to={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},no={name:"abc_news_live",type:"linear"},io=["HLS_ALL","PDL_MED","PDL_LOW"];function ro(e){var t,n,i,r=(e||$s).channel||$s,a=r.item||$s,s=a["media-group"]||$s,o=s["media-content"]||Xs,c=s["media-title"],u=(function(e){for(var t,n,i=io.length,r=e.length,a=0;a<i;a++)for(var s=io[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||$s)["@attributes"]||$s,l=(s["media-thumbnail"]||$s)["@attributes"]||$s,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,g=u.duration,y=u.url,v=u.medium,b=(a.omniture||$s).channel||"",w=D(String(b).split(":"),1)[0],I=to[b]||to[void 0===w?"abcn":w]||"abcnews",_="vod"===p,P="live"===p,S=eo[a.videoContentType]||(_?"shortform":"longform"),T=c||h,k=r.language||"en";try{n=(t=D(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var A="akamai live stream"!==a.mediatype||_?{}:E(E({},no),{id:d}),C={id:d,apiSource:Zs,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:A,show:{title:T},title:T,duration:g,language:k,source:{url:y,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:I,type:"video"===v?"video":"audio",entityType:S,streamType:P?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:g,streamURL:y,custom:{contentId:d,assetType:_?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:g,isFullEpisode:"shortform"===S||P?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return zs.fromObject(C)}var ao,so=I((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?st(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=ot(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=ot(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:ct(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),oo=(so.extract,so.parse,so.stringify,so.parseUrl,so.stringifyUrl,so.pick,so.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Gs(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof zs}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=so.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,ro(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Ys(Ls.itemFeed),e}()),co=(function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return O(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return O(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?Qs:e.match("abcnews")?oo:Js,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}(),function(e,t){t.setItem("watchsdk.isp_authenticator.state",JSON.stringify(e))}),uo=new function(e){this.userDataServiceUrl=e}("https://broadband.espn.com/espn3/auth/watchespn/user"),lo=function(){function e(e,t,n){switch(this.partner=e,this.platform=t,this.providerDataSource=null,this.configuration=uo,n){case ln.localStorage:this.storage=localStorage;break;case ln.sessionStorage:this.storage=sessionStorage;break;default:this.storage=localStorage}this.state_={};try{var i=this.storage.getItem("watchsdk.isp_authenticator.state");i||(i=function(e){var t="true"===e.getItem("ISPAuthenticator.isAuthenticated"),n=e.getItem("ISPAuthenticator.authenticatedIdentity"),i=null;try{i=JSON.parse(e.getItem("ISPAuthenticator.authenticatedProvider"))}catch(e){}var r={isAuthenticated:t,authenticatedIdentity:n,authenticatedProvider:i};return e.removeItem("ISPAuthenticator.isAuthenticated"),e.removeItem("ISPAuthenticator.authenticatedIdentity"),e.removeItem("ISPAuthenticator.authenticatedProvider"),r}(this.storage),co(this.state_,this.storage));var r=JSON.parse(i.toString());r.authenticatedProvider&&(r.authenticatedProvider=dn.fromObject(r.authenticatedProvider)),this.state_=r}catch(e){}}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAuthenticated",{get:function(){return"true"===this.state_.isAuthenticated||!0===this.state_.isAuthenticated},set:function(e){this.state_.isAuthenticated=e,co(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedIdentity",{get:function(){return this.state_.authenticatedIdentity},set:function(e){if(!e)return delete this.state_.authenticatedIdentity,void co(this.state_,this.storage);this.state_.authenticatedIdentity=e,co(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(e){if(!e)return delete this.state_.authenticatedProvider,void co(this.state_,this.storage);this.state_.authenticatedProvider=e,co(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preauthorizedResourpn3"]:[]},enumerable:!0,configurable:!0}),e.prototype.checkAuthentication=function(){var e=this,t=this.configuration.userDataServiceUrl;return T(t+"?partner="+this.partner+"&platform="+this.platform).then((function(e){return e.json()})).then((function(n){var i=n.user&&n.user.authentication&&n.user.authentication.isp;if(i){e.isAuthenticated=!0;var r=i.name;return e.providerDataSource?e.providerDataSource.getProvider(r,as.isp).then((function(n){var i=n.getPreferredLogoUrl(e.partner);return e.authenticatedProvider=new dn(r,n.name,i,t),!0})).catch((function(){return e.authenticatedProvider=new dn(r,r,null,t),!0})):(e.authenticatedProvider=new dn(r,r,null,t),S.resolve(!0))}return!1}))},e.prototype.authenticate=function(){return S.resolve(!0)},e.prototype.deauthenticate=function(){return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,S.resolve(!0)},e.prototype.checkAuthorization=function(e){var t;if(-1===e.authenticationTypes.indexOf(Us.isp)||!this.isAuthenticated)return S.resolve(new mn(!1,null));var n=((t={})[fn.CustomDataKey.token]="IA==",t[fn.CustomDataKey.tokenType]="DEVICE",t),i=new fn(Us.isp,this.authenticatedProvider,this.authenticatedIdentity,n),r=new mn(!0,i);return S.resolve(r)},e.defaultConfiguration=uo,e}(),ho=function(e){c(n,e);var t=h(n);function n(){return i(this,n),t.apply(this,arguments)}return a(n,[{key:"configuration",get:function(){var e=se.shared.getConfiguration("authorization",lo.defaultConfiguration);return _.debug("ISPAuthenticator.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(u(n.prototype),"configuration",e,this,!0)}}]),n}(lo),po=function(e){c(n,e);var t=h(n);function n(e,r){var a;i(this,n),(a=t.call(this)).partner=he.partner,a.platform=he.platform,a.apiKey=he.apiKey,a.deviceId=he.deviceId;var s=new ys(e),o={deviceId:a.deviceId,deviceType:he.platform},c=new ni(a.partner,a.platform,"ESPN",o,{production:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyZGJmZWM4My03OWE1LTQyNzEtYTVmZC04NTZjYTMxMjRjNjMiLCJuYmYiOjE1NDAyMTI3NjEsImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjEyNzYxfQ.yaK3r4AI2uLVvsyN1GLzqzgzRlxMPtasSaiYYBV0wIstqih5tvjTmeoLmi8Xy9Kp_U7Md-bOffwiyK3srHkpUkhhwXLH2x6RPjmS1tPmhaG7-3LBcHTf2ySPvXhVf7cN4ngldawK4tdtLtsw6rF_JoZE2yaC6XbS2F51nXSFEDDnOQWIHEQRG3aYAj-38P2CLGf7g-Yfhbp5cKXeksHHQ90u3eOO4WH0EAjc9oO47h33U8KMEXxJbvjV5J8Va2G2fQSgLDZ013NBI3kQnE313qgqQh2feQILkyCENpB7g-TVBreAjOaH1fU471htSoGGYepcAXv-UDtpgitDiLy7CQ",staging:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhMmRjNjgyMC1kZGNkLTQ4NGEtOTdlNS0xZjJiZmQzOGI4YzgiLCJuYmYiOjE1NDAyMjIwNTksImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjIyMDU5fQ.YgX4ecGCgLCaZS7uwRQYZ8UR5EwT7GIl-glFbwU122bO1JYZSmbIX8YJSfmYth_scyeg-15BYWNftV9lOcmCe8VwIsQMJMIZKaF8qSIj5OfuTOBpNZNBpDAp5dC3zG7Zp1xLe3z-T0Y18-0BGj2yhGcJxBz4gtLXQ30Bw0LEIJ89nXCQaXFTq9N6zhDzMfkFJNnSNEvEmvcQqB4bFPIqn2is8427oQDU4D0XYvvTtx9eb5hmzKc9MbBG-8KRBA62BqdHomA5UA4kBYJKpe-8B2hO07Adi2bZoo5wP_VLNAnAxANWNXaGQYHMDjHDrHbbvuKHBudHgKxAuKpIdC7UrA"});c.providerDataSource=s;var u="web"===a.platform?ln.sessionStorage:ln.localStorage,l=new ho(a.partner,a.platform,u);l.providerDataSource=s;var d=new za;a.authenticators[Oe.mvpd]=c,a.authenticators[Oe.isp]=l,a.authenticators[Oe.open]=d,a.authorizers[Oe.mvpd]=c,a.authorizers[Oe.isp]=l,a.authorizers[Oe.open]=d,a.concurrencyMonitorBuilder=vs.getBuilder();var h={apiKey:a.apiKey,serviceUrl:$r.defaultServiceUrl},p=se.shared.getConfiguration("shield",h),f=new $r(p.apiKey),m=function(){var e={apiKey:a.apiKey,serviceUrl:$r.defaultServiceUrl},t=se.shared.getConfiguration("shield",e);f.apiKey=t.apiKey,f.serviceUrl=t.serviceUrl};m();var g=new Xr(f);a.playbackSessionFactories[De.shield]=g;var y=new Gr(a.partner,a.platform),v=new qr(y);a.playbackSessionFactories[De.startSession]=v;var b=new Br;return a.playbackSessionFactories[De.none]=b,a.drmSupport=r,se.shared.on(ae,(function(){var e=se.shared.getConfiguration("adobeCM");m();var t=new Xr(f);a.playbackSessionFactories[De.shield]=t,a.concurrencyMonitorBuilder=a.concurrencyMonitorBuilder||vs.getBuilder(),a.concurrencyMonitorBuilder=a.concurrencyMonitorBuilder.withServiceUrl(e.serviceUrl)})),a}return a(n,[{key:"drmSupport",set:function(e){var t=this;Object.keys(this.playbackSessionFactories).map((function(e){return t.playbackSessionFactories[e]}))pport=e)}))}},{key:"initPlaybackSession",value:function(e,t){var i=is.swid||ns.swid;(arguments.length<=3?void 0:arguments[3])&&Object.keys(Hr).map((function(e){return Hr[e]})).indexOf(arguments.length<=3?void 0:arguments[3])&&(this.drmSupport=arguments.length<=3?void 0:arguments[3]);var r=new En;return r.swid=i,r.platform=this.platform,r.merge(t),f(u(n.prototype),"initPlaybackSession",this).call(this,e,r)}},{key:"advertisingId",get:function(){var e=localStorage.getItem("AuthenticationManager.advertisingId");return e||(e=vt&&vt.device.advertisingId,this.advertisingId=e),e},set:function(e){localStorage.setItem("AuthenticationManager.advertisingId",e)}}]),n}(Zr);!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(ao||(ao={}));var fo,mo=ao;!function(e){e.linear="linear",e.event="event"}(fo||(fo={}));var go,yo=fo;!function(e){e.stitchedPreroll="stitchedPreroll"}(go||(go={}));var vo,bo=go;!function(e){e.live="live",e.onDemand="onDemand"}(vo||(vo={}));var wo,Io=vo;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(wo||(wo={}));var _o,Po=wo;!function(e){e.shortform="shortform",e.longform="longform"}(_o||(_o={}));var So,To=_o;!function(e){e.audio="audio",e.video="video"}(So||(So={}));var ko,Ao=So;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(ko||(ko={}));var Eo,Co=ko;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(Eo||(Eo={}));var Oo,Do=Eo;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(Oo||(Oo={}));var No=Oo,Mo=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,No[i],r,a,s,o,c,u)},e}(),Lo=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=yo[t.type];return new e(t.id,n,t.name,t.resource)},e}(),jo=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),Uo=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),xo=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=mo.all,this.images=[],this.type=Ao.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===yo.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===Io.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=Mo.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return jo.fromObject(e)})),i.mrss=t.mrss,i.network=Lo.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=Io[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return Uo.fromObject(e)})),i.tier=t.tier,i.type=Ao[t.type],i.entityType=To[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var Ro,Fo=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=To.shortform:this.entityType=To.longform,this.type=Ao.video}return e.prototype.toString=function(e){return e==Co.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case Co.cfa:return"natgeo://playVideo?videoID="+e;case Co.itemFeed:return"abcnews://playVideo?playChannel="+e;case Co.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function Ho(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===Ro.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=So.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===To.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===To.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===To.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===To.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===yo.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=Ro.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,g=e.coverageType,y=e.brands,v={};if(v.ContentDuration=n,t===To.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(y)&&y.length){var w=y[0],I=w.id,_=w.name,P=w.type;v["a.media.asset"]=I,v["a.media.show"]=_,v["a.media.genre"]=P}}else if(t===To.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}g&&(v.VideoTypeDetail=g)}return v}(t,n));var c={};return c[Po.nielsen]=r,c[Po.comscore]=a,c[Po.conviva]=s,c[Po.heartbeats]=o,c}function Bo(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(Ro||(Ro={}));var zo=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Vo=function(e,t,n,i){e==Co.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||zo):e==Co.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===Co.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},Go=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return O(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new Fo(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof xo}))).length?[2,Bo(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,g;return O(this,(function(y){switch(y.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===To.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,y.sent().json()];case 3:if(s=y.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,g=e.seekInSeconds,y=e.tracking,v=e.simulcastAiringId,b=e.network,w=e.status,I=e.cerebroId,_=e.syndicatable,P=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?Io.live:Io.onDemand,S=function(e){switch(e){case"NONE":return No.none;case"START_SESSION":return No.startSession;case"BAM":return No.bam;case"SHIELD":return No.shield}}(d.authorizationType),T=new Mo(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===bo.stitchedPreroll&&h&&((T=new Mo(h.url,No.none)).variant=bo.stitchedPreroll);var k=u?mo.linearPlayback:mo.all,A=y&&y.trackingId||i,E=new xo(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return Do.direct;case"OPEN":return Do.open;case"MVPD":return Do.mvpd;case"ISP":return Do.isp;default:return Do.none}})),E.description=a,E.isSyndicatable=_,o&&o.url&&E.images.push(new jo(o.url)),E.mrss=m,b){var C="linear"===b.type?yo.linear:yo.event;E.network=new Lo(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=P,E.supportedMediaCommands=k,E.brand=E.brand?E.brand:"espn",E.tracking=Ho(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:A,cerebroId:I},E.type=Ao.video,E.entityType=t,E.apiSource=Co.graphQL,E.packages=(p||[]).map((function(e){return new Uo(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===yo.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),_.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return O(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=Fo.identifierStringForNetwork(t,Co.graphQL),s=new Fo(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof xo==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),_.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new Vo(Co.graphQL),e}();var qo=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Fo(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof xo}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,g=new Mo(a.url,m),y=new xo(t,n,r,l,g);return y.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return Do.direct;case"OPEN":return Do.open;case"MVPD":return Do.mvpd;case"ISP":return Do.isp;default:return Do.none}})),y.description=i,d&&(y.network=new Lo(d.id,d.type,d.name,d.resource)),y.streamType=c,y.brand=h,y.tracking=Ho(y.brand,e,f,g),y.images=p,y.type=s,y.entityType=f,y.apiSource=Co.cfa,y}(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Vo(Co.cfa),e}(),Ko=Object.freeze({}),Wo=Object.freeze({}),Yo=Co.itemFeed,Jo={lf:"longform",sf:"shortform",live:"longform"},Qo={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},$o={name:"abc_news_live",type:"linear"},Xo=["HLS_ALL","PDL_MED","PDL_LOW"];function Zo(e){var t,n,i,r=(e||Ko).channel||Ko,a=r.item||Ko,s=a["media-group"]||Ko,o=s["media-content"]||Wo,c=s["media-title"],u=(function(e){for(var t,n,i=Xo.length,r=e.length,a=0;a<i;a++)for(var s=Xo[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||Ko)["@attributes"]||Ko,l=(s["media-thumbnail"]||Ko)["@attributes"]||Ko,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,g=u.duration,y=u.url,v=u.medium,b=(a.omniture||Ko).channel||"",w=D(String(b).split(":"),1)[0],I=Qo[b]||Qo[void 0===w?"abcn":w]||"abcnews",_="vod"===p,P="live"===p,S=Jo[a.videoContentType]||(_?"shortform":"longform"),T=c||h,k=r.language||"en";try{n=(t=D(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var A="akamai live stream"!==a.mediatype||_?{}:E(E({},$o),{id:d}),C={id:d,apiSource:Yo,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:A,show:{title:T},title:T,duration:g,language:k,source:{url:y,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:I,type:"video"===v?"video":"audio",entityType:S,streamType:P?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:g,streamURL:y,custom:{contentId:d,assetType:_?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:g,isFullEpisode:"shortform"===S||P?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return xo.fromObject(C)}var ec,tc=I((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?st(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=ot(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=ot(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:ct(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),nc=(tc.extract,tc.parse,tc.stringify,tc.parseUrl,tc.stringifyUrl,tc.pick,tc.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Fo(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof xo}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=tc.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,Zo(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Vo(Co.itemFeed),e}()),ic=function(){function e(){}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return O(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return O(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?qo:e.match("abcnews")?nc:Go,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))},e}(),rc=function(){function e(e,t){this.mediaItem=e,this.mediaItemDataSource=t}return e.prototype.start=function(){var e=this;this.mediaItem.isLinear&&this.mediaItem.isLive&&(this.intervalId=setInterval((function(){e.checkProgramChange()}),6e4))},e.protoervalId)},e.prototype.checkProgramChange=function(){var e=this;if(this.mediaItem&&this.mediaItemDataSource){var t=this.mediaItem.network&&this.mediaItem.network.id;if(t){var n=this.mediaItem.apiSource?this.mediaItem.apiSource==Co.graphQL?Co.graphQL:Co.cfa:Co.graphQL,i=Fo.identifierStringForNetwork(t,n);this.mediaItemDataSource.getMediaItems([i],{}).then((function(t){var n=Array.isArray(t)&&t[0];n&&(e.mediaItem.id!==n.id&&e.mediaItem.references.simulcastAiringId!==n.references.simulcastAiringId&&(e.mediaItem=n,e.onProgramChange(n)))}))}}},e.prototype.onProgramChange=function(e){},e}();!function(e){e.willStartPlaying="atv.player.willStartPlaying",e.didStopPlaying="atv.player.didStopPlaying",e.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",e.playerStateChanged="atv.player.playerStateChanged",e.playerTimeDidChange="atv.player.playerTimeDidChange"}(ec||(ec={}));var ac,sc,oc=ec;!function(e){e.priv="PRIV",e.txxx="TXXX"}(ac||(ac={})),function(e){e.program="PROGRAM",e.commercial="COMMERCIAL",e.slate="SLATE"}(sc||(sc={}));var cc,uc=function(e,t,n){void 0===e&&(e="com.espn.authnet.heartbeat"),void 0===t&&(t="com.espn.authnet.transition"),void 0===n&&(n="www.nielsen.com"),this.heartbeat=e,this.transition=t,this.nielsenWatermark=n},lc=function(e,t,n){this.tag=e,this.owner=t,this.dataValue=n};!function(e){e.start="start",e.playing="playing",e.pause="pause",e.seeking="seeking",e.stalled="stalled",e.stop="stop",e.timedMetadata="timedMetadata",e.currentTime="currentTime",e.loadedMetadata="loadedMetadata"}(cc||(cc={}));var dc,hc=cc,pc=function(){function e(e,t){this.certificateUrl=t,this.requests=[],this.bindSecureKeyDelivery(e||atv.secureKeyDelivery||{})}return e.prototype.bindSecureKeyDelivery=function(e){e.fetchCertificate=this.fetchCertificate.bind(this),e.fetchAssetID=this.fetchAssetID.bind(this),e.fetchKeys=this.fetchKeys.bind(this),e.cancelAllRequests=this.cancelAllRequests.bind(this)},e.prototype.fetchCertificate=function(e,t){var n=this;_.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",e);var i=this.certificateUrl;if(i){var r=new XMLHttpRequest;r.open("GET",i),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var e=r.responseDataAsBase64;_.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",e),t.success(e)}else t.failure(r.status);n.requests.splice(n.requests.indexOf(r),1)}},this.requests.push(r),r.send(null)}else t.failure("invalid certificate url")},e.prototype.fetchAssetID=function(e,t){var n=/[?&]c=([^&]+)&*/.exec(e);if(!n||n.length<2)t.failure("Error parsing assetId "+e);else{var i=n[1];_.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",e,i),t.success(i,!1)}},e.prototype.fetchKeys=function(e,t,n){var i=this,r=e.replace("skd://","https://"),a=JSON.stringify({spc:t});_.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",r);var s=new XMLHttpRequest;s.open("POST",r),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status)try{var e=JSON.parse(s.responseText).ckc;n.success(e)}catch(e){n.failure("invalid JSON")}else n.failure(s.status);i.requests.splice(i.requests.indexOf(s),1)}},this.requests.push(s),s.send(a)},e.prototype.cancelAllRequests=function(){_.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.forEach((function(e){e.abort&&e.abort()})),this.requests=[]},e}();(function(e){function t(t,n,i){var r=e.call(this)||this;if(!n)throw new Error("bus must be supplied");return r.bus=n,r.secureKeyDelivery=new pc(i),r.bindEventListeners(),r}A(t,e),t.prototype.bindEventListeners=function(){var e=this;this.bus.on(oc.willStartPlaying,(function(){atv.player.observeTimedMetadataKeys(),e.emit(hc.start)})),this.bus.on(oc.playerStateChanged,(function(t,n){switch(_.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",t,n),t){case atv.player.states.FastForwarding:e.emit(hc.seeking,n);break;case atv.player.states.Loading:e.emit(hc.stalled,n);break;case atv.player.states.Paused:e.emit(hc.pause,n);break;case atv.player.states.Playing:e.emit(hc.playing,n);break;case atv.player.states.Rewinding:e.emit(hc.seeking,n)}})),this.bus.on(oc.onTimedMetadataChanged,(function(t){var n=t.key,i=t.extraAttributes.info,r=t.dataValue,a=r&&j.stringify(L.parse(r))||"";a.replace("\0",""),e.emit(hc.timedMetadata,new lc(n,i,a))})),this.bus.on(oc.didStopPlaying,(function(){e.emit(hc.stop),e.cleanup()})),this.bus.on(oc.playerTimeDidChange,(function(t){e.emit(hc.currentTime,t)}))},Object.defineProperty(t.prototype,"playbackConfig",{set:function(e){if(e){var t=e.licenseUrl;_.debug("AtvlPlayerAdaptor setPlaybackConfig",t,e.protectionSystem),t&&(this.secureKeyDelivery.certificateUrl=t)}},enumerable:!1,configurable:!0}),t.prototype.stop=function(e){var t=e.message;atv.player.stopWithReason("Video Playback Has Stopped",t)},t.prototype.cleanup=function(){this.bus.off(oc.willStartPlaying),this.bus.off(oc.onTimedMetadataChanged),this.bus.off(oc.didStopPlaying)}})(ne),function(e){function t(t,n){var i=e.call(this)||this;return t?(i.nativePlayer=t,i.bus=t.getEventBus(),i.constants=n,i.id3MetadataOwner=new uc,i.unsubscribers=[],i.bindEventListeners(),i):i}A(t,e),t.prototype.bindEventListeners=function(){var e=this;this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.ID3,this,(function(t){void 0===t&&(t={});var n=t.sample?t.sample.data:t,i=n instanceof Uint8Array?String.fromCharCode.apply(String,N(n)):n,r=["PRIV","TXXX"].find((function(e){return i.includes(e)}))||null,a=Object.keys(e.id3MetadataOwner).map((function(t){return e.id3MetadataOwner[t]})).find((function(e){return i.includes(e)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new lc(r,a,s);e.emit(hc.timedMetadata,o)}))),this.alreadyStarted=!1,this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PLAYING,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),e.alreadyStarted?e.emit(hc.playing):(e.emit(hc.start),e.emit(hc.playing),e.alreadyStarted=!0)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,this,(function(t){var n=t/1e3;e.emit(hc.currentTime,n)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PAUSE,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.PAUSE"),e.emit(hc.pause)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKING,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING"),e.emit(hc.seeking)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),e.emit(hc.stalled)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),e.emit(hc.playing)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.COMPLETE,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),e.emit(hc.stop),e.cleanup()})))},t.prototype.stop=function(e){e&&_.warn("BAMTizenPlayerAdaptor.stop",e.message),this.nativePlayer.stop(),this.cleanup()},t.prototype.cleanup=function(){this.alreadyStarted=!1,this.unsubscribers.forEach((function(e){return"function"==typeof e&&e()})),this.unsubscribers=[]}}(ne),function(e){function t(t){var n=e.call(this)||this;return t?(n.nativePlayer=t,n.id3MetadataOwner=new uc,n.bindEventListeners(),n):n}A(t,e),t.prototype.bindEventListeners=function(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)},t.prototype.loadCompleteHandler=function(e){_.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",e),this.emit(hc.start)},t.prototype.id3Handler=function(e){var t=this;if(_.debug("ChromecastPlayerAdaptor._id3Handler",e),e.detail&&(e.segmentData=e.detail),e.segmentData){var n=String.fromCharCode.apply(String,N(e.segmentData));_.trace("ChromecastPlayerAdaptor._id3Handler",n);var i=["PRIV","TXXX"].find((function(e){return n.includes(e)}))||null,r=Object.keys(this.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(e){return n.includes(e)}))||null,a=r?n.substring(n.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):null,s=new lc(i,r,a);_.trace("ChromecastPlayerAdaptor._id3Handler","tag:",i,"owner:",r,"dataValue:",a),this.emit(hc.timedMetadata,s)}},t.prototype.timeUpdateHandler=function(e){var t=e.currentMediaTime;this.emit(hc.currentTime,t)},t.prototype.playingHandler=function(e){var t=e.currentMediaTime;this.emit(hc.playing,t)},t.prototype.pauseHandler=function(e){var t=e.currentMediaTime;this.emit(hc.pause,t)},t.prototype.mediaFinishedHandler=function(e){_.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",e),this.emit(hc.stop),this.cleanup()},t.prototype.stop=function(e){e&&_.warn("ChromecastPlayerAdaptor.stop",e.message)},t.prototype.cleanup=function(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))}}(ne),function(e){function t(t){var n=e.call(this)||this;return n.nativePlayer=t,n.bindEventListeners(),n}A(t,e),t.prototype.bindEventListeners=function(){var e=this;this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeek=this.onSeek.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeek),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.addEventListener("loadedmetadata",this.onLoadedMetadata),this.nativePlayer.textTracks.onaddtrack=function(t){var n=t.track;n&&"metadata"===n.kind&&n.addEventListener("cuechange",(function(t){var n=t.target;if(n&&"metadata"===n.kind){for(var i=[],r=0;r<n.activeCues.length;r++){var a=n.activeCues[r];i.push(a.value)}i.map((function(t){var n=t.key,i=t.info,r=t.data;r instanceof ArrayBuffer&&(r=String.fromCharCode.apply(null,new Uint8Array(r)));var a=new lc(n,i,r);_.trace("HTML5PlayerAdaptor timedMetadata",a),e.emit(hc.timedMetadata,a)}))}}))}):_.error("Native Player wasn't passed to HTML5PlayerAdaptor")},t.prototype.onPlay=function(e){this.emit(hc.start,e.timeStamp)},t.prototype.onPause=function(e){this.emit(hc.pause,e.timeStamp)},t.prototype.onSeek=function(e){this.emit(hc.seeking,e.timeStamp)},t.prototype.onError=function(){this.emit(hc.stop),this.cleanup()},t.prototype.onCurrentTime=function(e){this.emit(hc.currentTime,e.timeStamp)},t.prototype.onStalled=function(e){this.emit(hc.stalled,e.timeStamp)},t.prototype.onLoadedMetadata=function(){var e=this.nativePlayer;this.emit(hc.loadedMetadata,{duration:e.duration,videoWidth:e.videoWidth,videoHeight:e.videoHeight})},t.prototype.stop=function(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(hc.stop),this.cleanup()},t.prototype.cleanup=function(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeek),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop),this.nativePlayer.removeEventListener("loadedmetadata",this.onLoadedMetadata)}}(ne);!function(e){e.opened="opened",e.playing="playing",e.ended="ended",e.timedMetadata="timedMetadata",e.error="error",e.timeUpdate="timeUpdate",e.stalled="stalled",e.paused="paused",e.seeking="seeking"}(dc||(dc={}));var fc,mc,gc,yc,vc=dc,bc=(function(e){function t(t,n){var i=e.call(this)||this;if(!t)throw new Error("nativePlayer must be supplied");return i.nativePlayer=t,i.bus=n,i.bindEventListeners(),i}A(t,e),t.prototype.bindEventListeners=function(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(vc.opened,this.onOpened),this.bus.on(vc.playing,this.onPlaying),this.bus.on(vc.paused,this.onPaused),this.bus.on(vc.timedMetadata,this.onTimedMetadata),this.bus.on(vc.ended,this.onEnded),this.bus.on(vc.error,this.onError),this.bus.on(vc.timeUpdate,this.onTimeUpdate),this.bus.on(vc.stalled,this.onStalled),this.bus.on(vc.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)},t.prototype.onSeeking=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onSeeking",e),this.emit(hc.seeking,e)},t.prototype.onStalled=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onStalled",e),this.emit(hc.stalled,e)},t.prototype.onTimeUpdate=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onTimeUpdate",e),this.emit(hc.currentTime,e)},t.prototype.onError=function(e){_.debug("TrilithiumPlayerAdaptor.onError",e),this.emit(hc.stop),this.cleanup()},t.prototype.onEnded=function(){this.emit(hc.stop),this.cleanup()},t.prototype.onTimedMetadata=function(e,t,n){var i=t,r=n.toString(),a=j.stringify(L.parse(n.toString("base64"))),s=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;_.debug("TrilithiumPlayerAdaptor.onTimedMetadata "+i+" "+r+" "+s);var o=new lc(i,r,s);this.emit(hc.timedMetadata,o)},t.prototype.onOpened=function(e){e&&(_.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(hc.start))},t.prototype.onPlaying=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onPlaying",e),this.emit(hc.playing,e)},t.prototype.onPaused=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onPaused",e),this.emit(hc.pause,e)},t.prototype.stop=function(e){e&&_.warn("TrilithiumPlayerAdaptor.stop",e.message)},t.prototype.cleanup=function(){this.bus&&(this.bus.off(vc.opened),this.bus.off(vc.playing),this.bus.off(vc.timedMetadata),this.bus.off(vc.ended),this.bus.off(vc.error),this.bus.off(vc.timeUpdate),this.bus.off(vc.stalled))}}(ne),6),wc=7,Ic=11,_c=12,Pc=(function(e){function t(t){var n=e.call(this)||this;return n.nativePlayer=t,n.id3MetadataOwner=new uc,n}A(t,e),t.prototype.onTimedMetaData=function(e){var t=this,n=e.data,i=String.fromCharCode.apply(null,n),r=["PRIV","TXXX"].find((function(e){return i.includes(e)}))||null,a=Object.keys(this.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(e){return i.includes(e)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new lc(r,a,s);_.trace("AampUvePlayerAdapter timedMetadata",o),this.emit(hc.timedMetadata,o)},t.prototype.onPlaybackStateChanged=function(e){switch(e.state){case bc:this.emit(hc.pause);break;case wc:this.emit(hc.seeking);break;case _c:case Ic:this.emit(hc.stop),this.cleanup()}},t.prototype.onPlay=function(){this.emit(hc.start)},t.prototype.onCurrentTime=function(e){this.emit(hc.currentTime,e.positionMiliseconds)},t.prototype.onError=function(){this.emit(hc.stop),this.cleanup()},t.prototype.stop=function(){this.emit(hc.stop),this.cleanup()},t.prototype.cleanup=function(){}}(ne),function(){function e(e,t,n){var i=this;this.adobeConcurrencyBuilder=n,this.session=e,this.playerAdaptor=t,this.adobeConcurrencyBuilder&&this.initConcurrencyMonitor(),this.initProgramChangeMonitor(),this.playerAdaptor.on(.start()})),this.playerAdaptor.onleanup()}))}return e.prototype.initConcurrencyMonitor=function(){var e=this,t=this.session,n=t.concurrencyMonitorSessionId,i=this.adobeConcurrencyBuilder.withSession(t).build();i&&(t.concurrencyMonitorSessionId&&i.startWithSession(n),i.onError=function(t,n){e.playerAdaptor.stop(t),e.onStop(t),n&&e.onDeauthenticate(Do.mvpd)},this.adobeConcurrencyMonitor=i)},e.prototype.initProgramChangeMonitor=function(){var e=this,t=new ic,n=new rc(this.session.mediaItem,t);n.onProgramChange=function(t){var n=e.session.token,i=t.mrss;if(n){var r=e.shield;r?r.getAsset(t.id,n,"GATEKEEPER",i,{}).then((function(n){n&&(e.session.mediaItem=t,e.session.token=n.gatekeeperToken,e.nielsenTrackingManager&&(e.nielsenTrackingManager.mediaItem=t),e.onUpdatedMediaItem(t))}nStop(t)})):_.warn("shield support not configured")}else _.warn("token missing. skipping program change re-auth.")},this.programChangeMonitor=n},e.prototype.cleanup=function(){_.debug("PlaybackManager.cleanup"),this.playerAdaptor.off(hc.start),this.playerAdaptor.off(hc.stop),this.adobeConcurrencyMonitor&&this.adobeConcurrencyMonitor.stop(),this.programChangeMonitor&&this.programChangeMonitor.stop(),this.nielsenTrackingManager&&this.nielsenTrackingManager.stop()},e.prototype.onDeauthenticate=function(e){},e.prototype.onUpdatedMediaItem=function(e){},e.prototype.onStop=function(e){},e}()),Sc=function(e){c(n,e);var t=h(n);function n(e,r,a,s){var o;i(this,n);var c=he.apiKey;(o=t.call(this,e,r,a)).nielsenTrackingManager=s;var u=new $r,l=function(){var e={apiKey:c,serviceUrl:$r.defaultServiceUrl},t=se.shared.getConfiguration("shield",e);u.apiKey=t.apiKey,u.serviceUrl=t.serviceUrl};return l(),se.shared.on(ae,l),o.shield=u,o}return a(n)}(Pc);!function(e){e.localStorage="LOCAL_STORAGE",e.sessionStorage="SESSION_STORAGE"}(fc|iteUrl)}}!function(e){e.token="token",e.tokenType="tokenType",e.resource="resource",e.requestor="requestor",e.fullToken="fullToken",e.zipcode="zipcode",e.mvpd="mvpd"}(mc|mData=i}}kc.CustomDyload=t}}!function(e){e.standard="default",e.googleAdManager="gam"}(gc||(gc={})),function(e){e.standard="default",e.prod="prod",e.development="dev"}(yc||(yc={}));Object.freeze({}),Object.freeze("");var Ec;!function(e){e.immutable="immutable",e.mutable="mutable"}(Ec||(Ec={}));var Cc,Oc,Dc=I((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var s=n[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],r=function(t){t=t;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},a=0;a<t;a+=4){var o=r(4294967296*(n||e.random()));n=987654071*o(),i.push(4294967296*o()|0)}return new s.init(i,t)}}),o=i.enc={},c=o.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(n,t/2)}},u=o.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(n,t)}},l=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),c=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,u=e.min(4*c,r);if(c){for(var l=0;l<c;l+=a)this._doProcessBlock(i,l);var d=i.splice(0,c);n.sigBytes-=u}return new s.init(d,u)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(r.Hasher=d.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math),n)}));I((function(e,t){var n,i,r,a,s,o,c,u;e.exports=(i=(n=u=Dc).lib,r=i.WordArray,a=i.Hasher,s=n.algo,o=[],c=s.SHA1=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],s=n[3],c=n[4],u=0;u<80;u++){if(u<16)o[u]=0|e[t+u];else{var l=o[u-3]^o[u-8]^o[u-14]^o[u-16];o[u]=l<<1|l>>>31}var d=(i<<5|i>>>27)+c+o[u];d+=u<20?1518500249+(r&a|~r&s):u<40?1859775393+(r^a^s):u<60?(r&a|r&s|a&s)-1894007588:(r^a^s)-899497514,c=s,s=a,a=r<<30|r>>>2,r=i,i=d}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=a._createHelper(c),n.HmacSHA1=a._createHmacHelper(c),u.SHA1)})),I((function(e,t){var n,i,r;e.exports=(i=(n=Dc).lib.Base,r=n.enc.Utf8,void(n.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),s=this._iKey=t.clone(),o=a.words,c=s.words,u=0;u<n;u++)o[u]^=1549556828,c[u]^=909522486;a.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),I((function(e,t){e.exports=Dc.HmacSHA1})),I((function(e,t){var n,i,r;e.exports=(i=(n=r=Dc).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],a=0;a<n;a+=3)for(var s=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<n;o++)r.push(i.charAt(s>>>6*(3-o)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var o=e.indexOf(s);-1!==o&&(t=o)}return function(e,t,n){for(var r=[],a=0,s=0;s<t;s++)if(s%4){var o=n[e.charCodeAt(s-1)]<<s%4*2,c=n[e.charCodeAt(s)]>>>6-s%4*2;r[a>>>2]|=(o|c)<<24-a%4*8,a++}return i.create(r,a)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Bawn="000"}(Cc||(Cc={})),function(e){e.mvpd="mvpd",e.isp="isp",e.tve="tve"}(Oc||(Oc={}));var Nc=Oc;const Mc={};Mc[Nc.mvpd]="adobeId",Mc[Nc.isp]="ispId",Mc[Nc.tve]="id";var Lc;!function(e){e.willStartPlaying="atv.player.willStartPlaying",e.didStopPlaying="atv.player.didStopPlaying",e.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",e.playerStateChanged="atv.player.playerStateChanged",e.playerTimeDidChange="atv.player.playerTimeDidChange"}(Lc||(Lc={}));var jc,Uc,xc,Rc=Lc;!function(e){e.priv="PRIV",e.txxx="TXXX"}(jc||(jc={})),function(e){e.program="PROGRAM",e.commercial="COMMERCIAL",e.slate="SLATE"}(Uc||(Uc={}))ermark=n}his.id=tetadata"}(xc||(xc={}));var zc,Vc=xc;class Gc{constructor(e,t){this.certificateUrl=t,this.requests=[],this.bindSecureKeyDelivery(e||atv.secureKeyDelivery||{})}bindSecureKeyDelivery(e){e.fetchCertificate=this.fetchCertificate.bind(this),e.fetchAssetID=this.fetchAssetID.bind(this),e.fetchKeys=this.fetchKeys.bind(this),e.cancelAllRequests=this.cancelAllRequests.bind(this)}fetchCertificate(e,t){_.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",e);const n=this.certificateUrl;if(!n)return void t.failure("invalid certificate url");const i=new XMLHttpRequest;i.open("GET",n),i.onreadystatechange=()=>{if(4===i.readyState){if(200===i.status){const e=i.responseDataAsBase64;_.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",e),t.success(e)}else t.failure(i.status);this.requests.splice(this.requests.indexOf(i),1)}},this.requests.push(i),i.send(null)}fetchAssetID(e,t){const n=/[?&]c=([^&]+)&*/.exec(e);if(!n||n.length<2)return void t.failure("Error parsing assetId "+e);const i=n[1];_.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",e,i),t.success(i,!1)}fetchKeys(e,t,n){const i=e.replace("skd://","https://"),r=JSON.stringify({spc:t});_.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",i);const a=new XMLHttpRequest;a.open("POST",i),a.setRequestHeader("Content-Type","application/json"),a.onreadystatechange=()=>{if(4===a.readyState){if(200===a.status)try{const e=JSON.parse(a.responseText),{ckc:t}=e;n.success(t)}catch(e){n.failure("invalid JSON")}else n.failure(a.status);this.requests.splice(this.requests.indexOf(a),1)}},this.requests.push(a),a.send(r)}cancelAllRequests(){_.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.request.abort()}),this.requests=[]}}!function(e){e.opened="opened",e.playing="playing",e.ended="ended",e.timedMetadata="timedMetadata",e.error="error",e.timeUpdate="timeUpdate",e.stalled="stalled",e.paused="paused",e.seeking="seeking"}(zc||(zc={}));var qc=zc;var tsPath=t}("https://tve.dtci.technology","entitlements");!function(e){e.badToken="badToken",e.other="other"}(Kc||(Kc={}));var Yc,Jc=ftsPath=t}return e.prototype.getEntitlements=function(e){return C(this,void 0,void 0,(function(){var t,n,i,r,a;return O(this,(function(s){switch(s.label){case 0:t=this.serviceUrl+"/"+this.entitlementsPath,n={user_token:e},i=Object.keys(n).map((function(e){return e+"="+encodeURIComponent(n[e])})).join("&"),r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:i},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,T(t,r)];case 2:return[4,s.sent().json()];case 3:return[2,s.sent()];case 4:return a=s.sent(),console.error("Error retrieving Entitlements from DTCITVEntitlementAPI: "+a),[3,5];case 5:return[2]}}))}))},e.prototype.logout=function(e,t,n){return C(this,void 0,void 0,(function(){var i,r,a,s,o;return O(this,(function(c){switch(c.label){case 0:i=this.serviceUrl+"/affiliates/"+e+"/logout",r={user_token:t},n&&(r.redirect_uri=n),a=Object.keys(r).map((function(e){return e+"="+encodeURIComponent(r[e])})).join("&"),s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:a},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,T(i,s)];case 2:return c.sent(),[2,!0];case 3:return o=c.sent(),console.error("Error logging out of affiliate account DTCITVEntitlementAPI: "+o),[2,!1];case 4:return[2]}}))}))},e.prototype.tokenIsValid=function(e){try{var t=function(e){var t=e.split("."),n=j.stringify(L.parse(t[1]));return JSON.parse(n)}(e);if(!t.exp)return!0;var n=new Date;return!(new Date(1e3*t.exp)<n)}catch(e){return!1}},e}();!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(Yc||(Yc={}));var Qc,$c=Yc;!function(e){e.linear="linear",e.event="event"}(Qc||(Qc={}));var Xc,Zc=Qc;!function(e){e.stitchedPreroll="stitchedPreroll"}(Xc||(Xc={}));var eu,tu=Xc;!function(e){e.live="live",e.onDemand="onDemand"}(eu||(eu={}));var nu,iu=eu;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(nu||(nu={}));var ru,au=nu;!function(e){e.shortform="shortform",e.longform="longform"}(ru||(ru={}));var su,ou=ru;!function(e){e.audio="audio",e.video="video"}(su||(su={}));var cu,uu=su;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(cu||(cu={}));var lu,du=cu;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(lu||(lu={}));var hu,pu=lu;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(hu||(hu={}));var fu=hu,mu=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,fu[i],r,a,s,o,c,u)},e}(),gu=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=Zc[t.type];return new e(t.id,n,t.name,t.resource)},e}(),yu=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),vu=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),bu=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=$c.all,this.images=[],this.type=uu.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===Zc.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===iu.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=mu.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return yu.fromObject(e)})),i.mrss=t.mrss,i.network=gu.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=iu[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return vu.fromObject(e)})),i.tier=t.tier,i.type=uu[t.type],i.entityType=ou[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var wu,Iu=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=ou.shortform:this.entityType=ou.longform,this.type=uu.video}return e.prototype.toString=function(e){return e==du.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case du.cfa:return"natgeo://playVideo?videoID="+e;case du.itemFeed:return"abcnews://playVideo?playChannel="+e;case du.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function _u(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===wu.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=su.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===ou.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===ou.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===ou.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===ou.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===Zc.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=wu.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,g=e.coverageType,y=e.brands,v={};if(v.ContentDuration=n,t===ou.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(y)&&y.length){var w=y[0],I=w.id,_=w.name,P=w.type;v["a.media.asset"]=I,v["a.media.show"]=_,v["a.media.genre"]=P}}else if(t===ou.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}g&&(v.VideoTypeDetail=g)}return v}(t,n));var c={};return c[au.nielsen]=r,c[au.comscore]=a,c[au.conviva]=s,c[au.heartbeats]=o,c}function Pu(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(wu||(wu={}));var Su=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Tu=function(e,t,n,i){e==du.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Su):e==du.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===du.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},ku=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return O(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new Iu(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof bu}))).length?[2,Pu(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,g;return O(this,(function(y){switch(y.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===ou.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,y.sent().json()];case 3:if(s=y.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,g=e.seekInSeconds,y=e.tracking,v=e.simulcastAiringId,b=e.network,w=e.status,I=e.cerebroId,_=e.syndicatable,P=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?iu.live:iu.onDemand,S=function(e){switch(e){case"NONE":return fu.none;case"START_SESSION":return fu.startSession;case"BAM":return fu.bam;case"SHIELD":return fu.shield}}(d.authorizationType),T=new mu(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===tu.stitchedPreroll&&h&&((T=new mu(h.url,fu.none)).variant=tu.stitchedPreroll);var k=u?$c.linearPlayback:$c.all,A=y&&y.trackingId||i,E=new bu(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return pu.direct;case"OPEN":return pu.open;case"MVPD":return pu.mvpd;case"ISP":return pu.isp;default:return pu.none}})),E.description=a,E.isSyndicatable=_,o&&o.url&&E.images.push(new yu(o.url)),E.mrss=m,b){var C="linear"===b.type?Zc.linear:Zc.event;E.network=new gu(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=P,E.supportedMediaCommands=k,E.brand=E.brand?E.brand:"espn",E.tracking=_u(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:A,cerebroId:I},E.type=uu.video,E.entityType=t,E.apiSource=du.graphQL,E.packages=(p||[]).map((function(e){return new vu(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===Zc.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),_.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return O(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=Iu.identifierStringForNetwork(t,du.graphQL),s=new Iu(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof bu==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),_.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new Tu(du.graphQL),e}();var Au=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Iu(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof bu}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,g=new mu(a.url,m),y=new bu(t,n,r,l,g);return y.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return pu.direct;case"OPEN":return pu.open;case"MVPD":return pu.mvpd;case"ISP":return pu.isp;default:return pu.none}})),y.description=i,d&&(y.network=new gu(d.id,d.type,d.name,d.resource)),y.streamType=c,y.brand=h,y.tracking=_u(y.brand,e,f,g),y.images=p,y.type=s,y.entityType=f,y.apiSource=du.cfa,y}(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Tu(du.cfa),e}(),Eu=Object.freeze({}),Cu=Object.freeze({}),Ou=du.itemFeed,Du={lf:"longform",sf:"shortform",live:"longform"},Nu={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},Mu={name:"abc_news_live",type:"linear"},Lu=["HLS_ALL","PDL_MED","PDL_LOW"];function ju(e){var t,n,i,r=(e||Eu).channel||Eu,a=r.item||Eu,s=a["media-group"]||Eu,o=s["media-content"]||Cu,c=s["media-title"],u=(function(e){for(var t,n,i=Lu.length,r=e.length,a=0;a<i;a++)for(var s=Lu[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||Eu)["@attributes"]||Eu,l=(s["media-thumbnail"]||Eu)["@attributes"]||Eu,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,g=u.duration,y=u.url,v=u.medium,b=(a.omniture||Eu).channel||"",w=D(String(b).split(":"),1)[0],I=Nu[b]||Nu[void 0===w?"abcn":w]||"abcnews",_="vod"===p,P="live"===p,S=Du[a.videoContentType]||(_?"shortform":"longform"),T=c||h,k=r.language||"en";try{n=(t=D(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var A="akamai live stream"!==a.mediatype||_?{}:E(E({},Mu),{id:d}),C={id:d,apiSource:Ou,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:A,show:{title:T},title:T,duration:g,language:k,source:{url:y,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:I,type:"video"===v?"video":"audio",entityType:S,streamType:P?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:g,streamURL:y,custom:{contentId:d,assetType:_?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:g,isFullEpisode:"shortform"===S||P?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return bu.fromObject(C)}var Uu=I((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?st(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=ot(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=ot(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:ct(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),xu=(Uu.extract,Uu.parse,Uu.stringify,Uu.parseUrl,Uu.stringifyUrl,Uu.pick,Uu.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return O(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return O(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Iu(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof bu}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return O(this,(function(a){switch(a.label){case 0:n=Uu.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,ju(i)];case 4:return r=a.sent(),_.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Tu(du.itemFeed),e}()),Ru=(function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return O(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return O(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?Au:e.match("abcnews")?xu:ku,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}(),function(e,t){t.setItem("watchsdk.tve_authenticator.state",JSON.stringify(e))}),Fu=function(e){c(n,e);var t=h(n);function n(e,r){var a;return i(this,n),(a=t.call(this,e,r)).providerDataSource=new ys(r),a}return a(n)}(function(){function e(e,t){this.identityTokenProvider=e,this.locationProvider=t,this.authenticationUrl="https://www.espn.com/watch/auth",this.edition="espn-nl-nl",this.storage=localStorage,this.tveAPI=new Jc(Wc.serviceUrl,Wc.entitlementsPath),this.delegate=null,this.providerDataSource=null,window.displayProviderDialog=this.displayProviderDialog.bind(this);try{var n=this.storage.getItem("watchsdk.tve_authenticator.state"),i=JSON.parse(n);this.state_=i||{}}catch(e){}}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAuthenticated",{get:function(){return this.state_.isAuthenticated},set:function(e){this.state_.isAuthenticated=e,Ru(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedIdentity",{get:function(){var e,t;return null===(t=null===(e=this.state_.entitlements)||void 0===e?void 0:e.accounts[0])||void 0===t?void 0:t.id},set:function(e){this.state_.authenticatedIdentity=e,Ru(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(e){if(!e)return delete this.state_.authenticatedProvider,void Ru(this.state_,this.storage);this.state_.authenticatedProvider=e,Ru(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entitlements",{get:function(){return this.state_.entitlements},set:function(e){if(!e)return delete this.state_.entitlements,void Ru(this.state_,this.storage);this.state_.entitlements=e,Ru(this.state_,this.storage)},enumerable:!0,configurable:!0}),e.prototype.checkAuthentication=function(){return C(this,void 0,void 0,(function(){var e,t,n,i=this;return O(this,(function(r){switch(r.label){case 0:return _.debug("TVEAuthenticator.checkAuthentication"),(e=this.identityTokenProvider.getIdentityToken())?(t=this,[4,this.tveAPI.getEntitlements(e)]):[2,S.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:return t.entitlements=r.sent(),this.entitlements?(n=this.entitlements.accounts[0])?(this.isAuthenticated=!(!e||!n),this.authenticatedProvider=new dn(n.affiliate.id,n.affiliate.name,null,null),this.providerDataSource?[2,this.providerDataSource.getProvider(n.affiliate.id,as.mvpd).then((function(e){var t=e&&e.images||[],r=t.filter((function(e){return"COLOR_NEGATIVE"===e.type})).map((function(e){return e.href}))[0],a=t.filter((function(e){return"BW_NEGATIVE"===e.type})).map((function(e){return e.href}))[0]||r||t.map((function(e){return e.href}))[0];return i.authenticatedProvider=new dn(e.adobeId||n.affiliate.id,n.affiliate.name,a,e.websiteUrl),i.isAuthenticated}nticated}))]:[2,S.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,S.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,S.reject(new Error("TVEAuthenticator.NotEntitled"))])}}))}))},e.prototype.authenticate=function(e){var t=this,n=this.providerId,i=this.accessType,r=this.edition,a=e&&e.redirectUrl||window.location.href,s=this.identityTokenProvider.getIdentityToken();return new S((function(e){var o;if(t.resolveAuthenticate_=function(t){e(t)},!n)return t.redirectUrl=a,t.displayProviderDialog(),S.resolve(!1);var c=null===(o=t.locationProvider.getCountryCode())||void 0===o?void 0:o.toLowerCase(),u={mvpd:n,redirectUrl:a,country:c};r&&(u["edition-view"]=r),i&&(u.accessType=i);var l=Object.keynt(u[e])})).join("&"),d=-1===t.authenticationUrl.indexOf("?")?"?":"&",h=""+t.authenticationUrl+d+l;s&&(h=h+"#oneIdToken="+s),window.location.href=h}))},e.prototype.deauthenticate=function(){var e=this.entitlements.accounts[0].affiliate.id,t=this.identityTokenProvider.getIdentityToken();return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.entitlements=null,t?this.tveAPI.logout(e,t,nulreturn!0})):S.resolve(!0)},e.prototype.checkAuthorization=function(){return C(this,void 0,void 0,(function(){var e,t,n,i,r,a;return O(this,(function(s){switch(s.label){case 0:return(e=this.identityTokenProvider.getIdentityToken())?this.isAuthenticated?this.entitlements&&this.tveAPI.tokenIsValid(this.entitlements.token)?[3,2]:(t=this,[4,this.tveAPI.getEntitlements(e)]):[2,S.reject(new Error("TVEAuthenticator.AuthenticationRequired"))]:[2,S.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:t.entitlements=s.sent(),s.label=2;case 2:return this.entitlements&&this.tveAPI.tokenIsValid(this.entitlements.token)?((a={})[fn.CustomDataKey.token]=this.entitlements.token,a[fn.CustomDataKey.tokenType]="JWT",n=a,i=new fn(pu.mvpd,this.authenticatedProvider,this.authenticatedIdentity,n),r=new mn(!0,i),[2,S.resolve(r)]):[2,S.reject(new Error("TVEAuthenticator.NotEntitled"))]}}))}))},e.prototype.displayProviderDialog=function(){var e=this;_.debug("TVEAuthenticator.displayProviderDialog"),this.providerDataSource&&this.providerDataSource.getProviders().then((function(t){e.delegate&&e.delegate.selectProvider&&e.delegate.selectProvider(t)}))},e.prototype.setProvider=function(e,t){var n=this;_.debug("TVEAuthenticator.setProvider"),this.providerId=e,this.accessType=t,this.authenticate({redirectUrl:this.redirectUre_=null)}))},e.defaultConfiguration=Wcurn a(n)}(te),Bu=function(){function e(t,n){i(this,e),this.playerAdaptor=t,this.mediaItem=n,this.id3MetadataOwner=new Fc,this._currentContentType=null,this._currentAdId=null,this._lastHeartbeatTime=null,this._initialHeartbeatTimer=null,this._heartbeatTimer=null,this._currentPlayerTime=0,this._initialPlayerTime=null,this._isPlaying=!1,this._handleStart=this._handleStart.bind(this),this.playerAdaptor.on(Vc.start,this._handleStart),this._handlePlaying=this._handlePlaying.bind(this),this.playerAdaptor.on(Vc.playing,this._handlePlaying),this._handlePaused=this._handlePaused.bind(this),this.playerAdaptor.on(Vc.pause,this._handlePaused),this.playerAdaptor.on(Vc.stalled,this._handlePaused),this.playerAdaptor.on(Vc.seeking,this._handlePaused),this._handlePlayerCurrentTime=this._handlePlayerCurrentTime.bind(this),this.playerAdaptor.on(Vc.currentTime,this._handlePlayerCurrentTime),this._handleTimedMetadata=this._handleTimedMetadata.bind(this),this.playerAdaptor.on(Vc.timedMetadata,this._handleTimedMetadata),this._handleStop=this._handleStop.bind(this),this.playerAdaptor.on(Vc.stop,this._handleStop)}return a(e,[{key:"currentContentType",get:function(){return this._currentContentType},set:function(e){if(this._currentContentType!==e){var t=this._currentContentType;this._currentContentType=e;var n=this._currentPlayerTime;t||(n=this._initialPlayerTime||0),this.onContentTypeChanged&&this.onContentTypeChanged(e,t,n,this._currentAdId)}}},{key:"onContentTypeChang,t,n,i){}},{key:"stop",value:function(){this.playerAdaptor.off(Vc.start),this.playerAdaptor.off(Vc.playing),this.playerAdaptor.off(Vc.pause),this.playerAdaptor.off(Vc.stalled),this.playerAdaptor.off(Vc.seeking),this.playerAdaptor.off(Vc.timedMetadata),this.playerAdaptor.off(Vc.currentTime),this.playerAdaptor.off(Vc.stop)}},{key:"_handleStart",value:function(){if(_.debug("AdBreakMonitor._handleStart"),!0!==this.mediaItem.source.hasEspnId3Heartbeats)return _.debug("AdBreakMonitor._handleStart hasEspnId3Heartbeats !== true, setting currentContentType to content.",this._currentPlayerTime,this._initialPlayerTime,this.mediaItem.source.hasEspnId3Heartbeats),void(this.currentContentType=e.ContentType.content);this._scheduleInitialHeartbeatTimer()}},{key:"_handlePlaying",value:function(){this._isPlaying=!0}},{key:"_handlePausaying=!1}},{key:"_handleTimedMetadata",value:function(e){if(!0===this.mediaItem.source.hasEspnId3Heartbeats&&e.tag===jc.priv&&e.owner===this.id3MetadataOwner.heartbeat){_.debug("AdBreakMonitor._handleTimedMetadata",JSON.stringify(e));var t=function(e){var t;try{t=JSON.parse(e.dataValue)}catch(e){return null}return t.length?t.map((function(e){return new Hc(e.type,e.id)})):null}(e);t&&this._handleHeartbeats(t)}}},{key:"_handlePlayerCurrentTime",value:function(e){var t=Math.floor(e);null===this._initialPlayerTime&&(this._initialPlayerTime=t),this._currentPlayerTime=t}},{key:"_handleSttTimer()}},{key:"_handleHeartbeats",value:function(t){_.debug("AdBreakMonitor._handleHeartbeats",JSON.stringify(t)),this._invalidateInitialHeartbeatTimer(),this._lastHeartbeatTime=Date.now();var n=t.every((function(e){return e.isContent()}))?e.ContentType.content:e.ContentType.ad;n===e.ContentType.ad&&(this._currentAdId=function(e){returl!==e.id}))||null}(t)),this.currentContentType=n,this._scheduleHeartbeatTimer()}},{key:"_scheduleInitialHeartbeatTimer",value:function(){var e=this;_.debug("AdBreakMonitor._scheduleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),this._initialHeartbeatTimer=setInterval((function(){e._handleInitialHeartbeatTimer()}),15e3)}},{key:"_invalidateInitialHeartbeatTimer",value:function(){this._initialHeartbeatTimer&&(clearInterval(this._initialHeartbeatTimer),this._initialHeartbeatTimer=null)}},{key:"_handleInitialHeartbeatTimer",value:function(){if(_.debug("AdBreakMonitor._handleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),!1!==this._isPlaying){if(!this.currentContentType){var t=e.ContentType.ad;this._currentAdId="1",this.currentContentType=t}}else this._scheduleInitialHeartbeatTimer()}},{key:"_scheduleHeartbeatTim)}),1e4)}},{key:"_invalidateHeartbeatTimer=null)}},{key:"_handleHeartbeatTimer",value:function(){var t=Date.now();if(_.debug("AdBreakMonitor._handleHeartbeatTimer"),!1!==this._isPlaying){if(this._lastHeartbeatTime&&t-this._lastHeartbeatTime>2e4){_.debug("AdBreakMonitor._handleHeartbeatTimer [now - this._lastHeartbeatTime]: ",t-this._lastHeartbeatTime);var n=e.ContentType.ad;this._currentAdId="1",this.currentContentType=n}this._scheduleHeartbeatTimer()}else this._scheduleHeartbeatTimer()}}]),e}();Bu.ContentType={ad:"ad",content:"content"};var zu={production:"PROD",testing:"TESTING"},Vu={};Vu[zu.production]="https://cloudapi.imrworldwide.com/nmapi/v2",Vu[zu.testing]="https://sandbox-cloudapi.imrworldwide.com/nmapi/v2";var Gu=function(){function e(t,n,r,a,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:zu.production;i(this,e);var c=t instanceof e.Configuration||t===Object(t)?t:new e.Configuration(t,n,r,a,s,o);_.debug("NielsenCloudAPIClient.constructor",JSON.stringify(c)),this.configuration=c,this.sessionId=Z()}return a(e,[{key:"configuration",get:function(){return this._configuration},set:function(e){e&&(this.appId=e.appId,this.devInfo={devId:!1===e.isOptOut?e.deviceId:"",apn:e.appName,apv:"".concat(e.appVersion),uoo:"".concat(e.isOptOut)},this.env=e.environment,this._configuration=e)}},{key:"isVizioApp",get:function(){var e;return"ESPN Vizio"===(null===(e=this.configuration)||void 0===e?void 0:e.appName)}},{key:"isTizeappName)}},{key:"isTizenOrVVizioApp}},{key:"primaryLinearNetworks",get:function(){return new Set(["ESPN","ESPN2"])}},{key:"sendEvent",value:function(e,t,n,i,r){var a,s={devInfo:this.devInfo,metadata:{},event:e,position:isNaN(t)||null===t?"".concat(t):"".concat(Math.floor(t)),type:n,utc:"".concat(Date.now())},o=i.tracking[_e.nielsen],c=null==i||null===(a=i.network)||void 0===a?void 0:a.name,u=null==i?void 0:i.streamType;if(this.isTizenOrVizio){var l="2";this.shouldSetAdLoadTypeToOne(u,c)&&(l="1"),o.adloadtype=l,o.vcid&&delete o.vcid,o.admodel&&delete o.admodel}this.isTizenApp&&u===we.onDemand&&(o.subbrand="c17"),this.isVizioApp&&this.shouldUpldateSubbrand(u,c)&&(o.subbrand="b01"),i&&(s.metadata.content=o),n===Bu.ContentType.ad&&(s.metadata.ad=r);var d="".concat(Vu[this.env],"/").concat(this.appId,"/").concat(this.sessionId,"/a?b=").concat(encodeURIComponent(JSON.stringify(s)));_.debug("NielsenCloudAPIClient.sendEvent url:",d),_.debug("NielsenCloudAPIClient.sendEvent payload:",JSON.stringify(s)),Tstatus))})).catch((function(e){_.warn("NielsenCloudAPIClient.sendEvent response.error: ".concat(e&&e.message))}))}},{key:"shouldSetAdLoadTypeToOne",value:function(e,t){return e===we.live&&(this.primaryLinearNetworks.has(t)||this.isEspnPlus(t))}},{key:"shouldUpldateSubbrand",value:function(e,t){return e===we.live&&this.isNotPrimaryLinearNetworksOrEspnPlus(t)}},{key:"isNotPrimaryLinearNetworksOrEspnPlPN+"!==e}},{key:"isEspnPlPN+"===e}},{key:"closeSession",value:function(){this.sendEvent(e.EventType.delete,"","",null,null)}}]),e}();Gu.AssetType={content:"content",ad:"ad"},Gu.EventType={playhead:"playhead",complete:"complete",delete:"delete"},Gu.Environment=zu,Gu.Configuonment=o}));var qu,Ku=function(){function e(t,n,r){var a=this;i(this,e),this.cloudAPIClient=t,this.playerAdaptor=n;var s=gt.fromObject(r)||r;if(s.entityType===Se.longform||this.cloudAPIClient.isTizenOrVizio){this.mediaItem=s,this.currentPlayerTime=null,this.lastContentBeaconTime=null,this._isPlayerPlaying=!1,this.playerAdaptor.on(Vc.playing,(function(e){if(_.debug("NielsenTrackingManager PlayerAdaptorEvent.playing currentTime = ".concat(e,", this.currentPlayerTime = ").concat(a.currentPlayerTime)),e){var t=Math.floor(e);a.currentPlayerTime=t}a.isPlayerPlaying=!0})),this.playerAdaptor.on(Vc.seeking,(function(e){_.debug("NielsenTrackingManager PlayerAdaptorEvent.seeking currentTime = ".concat(e,", this.currentPlayerTime = ").concat(a.currentPlayerTime)),a.isPlayerPlaying=!1,a._massageAndReportTime(e)})),this.playerAdaptor.on(Vc.seeked,(function(e){_.debug("NielsenTrackingManager PlayerAdaptorEvent.seeked currentTime = ".concat(e,", this.currentPlayerTime = ").concat(a.currentPlayerTime)),a.isPlayerPlaying=!0,a.lastContentBeaconTime=Math.floor(e),a._massageAndReportTime(e)})),this.playerAdaptor.on(Vc.pause,(function(e){_.debug("NielsenTrackingManager PlayerAdaptorEvent.pause currentTime = ".concat(e,", this.currentPlayerTime = ").concat(a.currentPlayerTime)),a.isPlayerPlaying=!1,a._massageAndReportTime(e)})),this.playerAdaptor.on(Vc.currentTime,(function(e){var t=Math.floor(e);a.currentPlayerTime=t;var n=a.currentContentType;if(n&&a.isPlayerPlaying){var i=t-a.currentContentStartTime;0!==i&&i%10==0&&t!==a.lastContentBeaconTime&&t>a.lastContentBeaconTime&&(a.lastContentBeaconTime=t,_.debug("NielsenTrackingManager PlayerAdaptorEvent.currentTime sending playhead 10 second beacon ",t),a._sendPlayheadEvent(n,t))}})),this.playerAdaptor.on(Vc.stop,(function(){_.debug("NielsenTrackingManager PlayerAdaptorEvent.stop, this.currentPlayerTime",a.currentPlayerTime),a.isPlayerPlaying=!1,a._massageAndReportTime(a.currentPlayerTime),a.stop()})),this.currentContentType=null,this.currentContentStartTime=0,this.totalAdTime=0,this.currentAdInfo=null;var o=new Bu(n,r);o.onContentTypeChanged=function(e,t,n){if(_.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged from",t,"to",e),t){_.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead before contentType change");var i=a._getPlayheadPosition(t,n,!0);a.cloudAPIClient.sendEvent(Gu.EventType.playhead,i,t,a.mediaItem,a.currentAdInfo)}_.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead after contentType change");var r=t&&!a.mediaItem.isLive?0:a._getPlayheadPosition(e,n),s={assetid:"1",type:0===r?"preroll":"midroll"},o=e===Bu.ContentType.ad?s:null;a.cloudAPIClient.sendEvent(Gu.EventType.playhead,r,e,a.mediaItem,o),a.currentContentType=e,a.currentContentStartTime=n,a.currentAdInfo=o,a.lastContentBeaconTime=n},this.adBreakMonitor=o}}return a(e,[{key:"mediaItem",get:function(){return this._mediaItem},set:function(e){if(this._mediaItem){this._sendPlayheadEventForCurrentPlayerTimeAndContentType();var t=this._getPlayheadPosition(Bu.ContentType.content,this.currentPlayerTime);_.debug("NielsenTrackingManager setMediaItem sending complete"),this.cloudAPIClient.sendEvent(Gu.EventType.complete,t,Gu.AssetType.content,this._mediaItem)}this._mediaItem=e,this.adBreakMonitor&&(this.adBreakMonitor.mediaItem=e)}},{key:"isPlayerPlaying",get:function(){return this._isPlayerPlatType())}},{key:"stop",value:function(){this.playerAdaptor.off(Vc.currentTime),this.playerAdaptor.off(Vc.stop),this.adBreakMonitor&&this.adBreakMonitor.stop(),this.mediaItem=null}},{key:"_massageAndReportTime",value:function(e){if(e){var t=Math.floor(e);this.currentPlayerTime=t,this._sendPlayheadEvent(this.currentContentType,t)}}},{key:"_getPlayheadPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.mediaItem&&this.mediaItem.isLive)return Math.floor(Date.now()/1e3);if(e===Bu.ContentType.ad){if(n){var i=t-this.currentContentStartTime;return this.totalAdTime+=i,i}return 0}return t-this.totalAdTime}},{key:"_sendPlayheadEventForCurrentPlayerTimeAndContentType",value:function(){var e=this.currentPlayerTime,t=this.currentContentType;t&&e!==this.lastContentBeaconTime&&e>this.lastContentBeaconTime&&(this.lastContentBeaconTime=e,_.debug("NielsenTrackingManager _sendPlayheadEventForCurrentPlayerTimeAndContentType sending playhead beacon",e),this._sendPlayheadEvent(t,e))}},{key:"_sendPlayheadEvent",value:function(e,t){var n=t-this.currentContentStartTime,i=e!==Bu.ContentType.ad||this.mediaItem.isLive?this._getPlayheadPosition(e,t):n,r=e===Bu.ContentType.ad?this.currentAdInfo:null;this.cloudAPIClient.sendEvent(Gu.EventType.playhead,i,e,this.mediaItem,r)}}]),e}(),Wu=fntent=!1}return e.prototype.setntent=!1},e.prototype.firstPlay=function(e){this.didFirstPlay=!0},e.prototype.firstPlayntent=!0},e.protontent(e)},e.prototype.loadedMetadata=function(e){},e.prototype.pause=function(e){},e.prototype.complete=function(e){},e.prototype.seek=function(e){},e.prototype.release=function(e){},e.prototype.progressChange=function(e){},e.prototype.buffer=function(e){},e.prototype.error=function(e){},e.prototype.adBreakStart=function(e){},e.prototype.adBreakEnd=function(e){},e.prototyptem=null},e}();!function(e){e.willStartPlaying="atv.player.willStartPlaying",e.didStopPlaying="atv.player.didStopPlaying",e.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",e.playerStateChanged="atv.player.playerStateChanged",e.playerTimeDidChange="atv.player.playerTimeDidChange"}(qu||(qu={}));var Yu,Ju,Qu=qu;!function(e){e.priv="PRIV",e.txxx="TXXX"}(Yu||(Yu={})),function(e){e.program="PROGRAM",e.commercial="COMMERCIAL",e.slate="SLATE"}(Ju||(Ju={}));var $u,Xu=function(e,t,n){void 0===e&&(e="com.espn.authnet.heartbeat"),void 0===t&&(t="com.espn.authnet.transition"),void 0===n&&(n="www.nielsen.com"),this.heartbeat=e,this.transition=t,this.nielsenWatermaValue=n};!function(e){e.start="start",e.playing="playing",e.pause="pause",e.seeking="seeking",e.stalled="stalled",e.stop="stop",e.timedMetadata="timedMetadata",e.currentTime="currentTime",e.loadedMetadata="loadedMetadata"}($u||($u={}));var el,tl=$u,nl=function(){function e(e,t){this.certificateUrl=t,this.requests=[],this.bindSecureKeyDelivery(e||atv.secureKeyDelivery||{})}return e.prototype.bindSecureKend(this)},e.prototype.fetchCertificate=function(e,t){var n=this;_.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",e);var i=this.certificateUrl;if(i){var r=new XMLHttpRequest;r.open("GET",i),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var e=r.responseDataAsBase64;_.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",e),t.success(e)}else t.failure(r.status);n.requests.splice(n.requests.indexOf(r),1)}},this.requests.push(r),r.send(null)}else t.failure("invalid certificate url")},e.prototype.fetchAssetID=function(e,t){var n=/[?&]c=([^&]+)&*/.exec(e);if(!n||n.length<2)t.failure("Error parsing assetId "+e);else{var i=n[1];_.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",e,i),t.success(i,!1)}},e.prototype.fetchKeys=function(e,t,n){var i=this,r=e.replace("skd://","https://"),a=JSON.stringify({spc:t});_.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",r);var s=new XMLHttpRequest;s.open("POST",r),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status)try{var e=JSON.parse(s.responseText).ckc;n.success(e)}catch(e){n.failure("invalid JSON")}else n.failure(s.status);i.requests.splice(i.requests.indexOf(s),1)}},this.requests.push(s),s.send(a)},e.prototype.cancelAllRequests=function(){_.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.abort()})),this.requests=[]},e}();(function(e){function t(t,n,i){var r=e.call(this)||this;if(!n)throw new Error("bus must be supplied");return r.bus=n,r.secureKeyDelivery=new nl(i),r.bindEventListeners(),r}A(t,e),t.prototype.bindEventListeners=function(){var e=this;this.bus.on(Qu.willStarl.start)})),this.bus.on(Qu.playerStateChanged,(function(t,n){switch(_.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",t,n),t){case atv.player.states.FastForwarding:e.emit(tl.seeking,n);break;case atv.player.states.Loading:e.emit(tl.stalled,n);break;case atv.player.states.Paused:e.emit(tl.pause,n);break;case atv.player.states.Playing:e.emit(tl.playing,n);break;case atv.player.states.Rewinding:e.emit(tl.seeking,n)}})),this.bus.on(Qu.onTimedMetadataChanged,(function(t){var n=t.key,i=t.extraAttributes.info,r=t.dataValue,a=r&&j.stringify(L.parse(r))||"";a.replace("\0",""),e.emit(tl.timedMetadata,new Zu(n,i,a))})),this.bus.on(Qu.didStoleanup()})),this.bus.on(Qu.playerTimeDtTime,t)}))},Object.defineProperty(t.prototype,"playbackConfig",{set:function(e){if(e){var t=e.licenseUrl;_.debug("AtvlPlayerAdaptor setPlaybackConfig",t,e.protectionSystem),t&&(this.secureKeyDelivery.certificateUrl=t)}},enumerable:!1,configurable:!0}),t.protopped",t)},t.prototype.cleanup=function(){this.bus.off(Qu.willStartPlaying),this.bus.off(Qu.onTimedMetadataChanged),this.bus.off(Qu.didStopPlaying)}})(ne),function(e){function t(t,n){var i=e.call(this)||this;return t?(i.nativePlayer=t,i.bus=t.getEventBus(),i.constants=n,i.id3MetadataOwner=new Xu,i.unsubscribers=[],i.bindEventListeners(),i):i}A(t,e),t.prototype.bindEventListeners=function(){var e=this;this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.ID3,this,(function(t){void 0===t&&(t={});var n=t.sample?t.sample.data:t,i=n instanceof Uint8Array?String.fromCharCode.apply(String,N(n)):n,r=["PRIV","TXXX"].find((function(e){return i.includes(e)}))||null,a=Object.keys(e.id3MetadataOwner).map((function(t){return e.id3MetadataOwner[t]})).find((function(e){return i.includes(e)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new Zu(r,a,s);e.emit(tl.timedMetadata,o)}))),this.alreadyStarted=!1,this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PLAYING,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),e.alreadyStarted?e.emit(tl.playing):(e.emit(tl.start),e.emit(tl.playing),e.alreadyStarted=!0)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,this,(function(t){var n=t/1e3;e.emit(tl.currentTime,n)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PAUSE,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.PAUSE"),e.emit(tl.pause)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKING,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING"),e.emit(tl.seeking)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),e.emit(tl.stalled)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_playing)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.COMPLETE,this,(function(){_.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),e.emit(tl.stop),e.cleanup()})))},t.prototype.stop=function(e){e&&_.warn("BAMTizenPlayerAdaptor.stop",e.message),this.nativePlayer.stop(),this.cleanup()},t.prototype.cleanup=function(){this.alreadyStarted=!1,this.unsubscribersf e&&e()})),this.unsubscribers=[]}}(ne),function(e){function t(t){var n=e.call(this)||this;return t?(n.nativePlayer=t,n.id3MetadataOwner=new Xu,n.bindEventListeners(),n):n}A(t,e),t.prototype.bindEventListeners=function(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)},t.prototype.loadCompleteHandler=function(e){_.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",e),this.emit(tl.start)},t.prototype.id3Handler=function(e){var t=this;if(_.debug("ChromecastPlayerAdaptor._id3Handler",e),e.detail&&(e.segmentData=e.detail),e.segmentData){var n=String.fromCharCode.apply(String,N(e.segmentData));_.trace("ChromecastPlayerAdaptor._id3Handler",n);var i=["PRIV","TXXX"].find((function(e){return n.includes(e)}))||null,r=Object.keys(this.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(e){return n.includes(e)}))||null,a=r?n.substring(n.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):null,s=new Zu(i,r,a);_.trace("ChromecastPlayerAdaptor._id3Handler","tag:",i,"owner:",r,"dataValue:",a),this.emit(tl.timedMetadata,s)}},t.prototype.timeUpdateHandler=function(e){var t=e.currentMediaTime;this.emit(tl.currentTime,t)},t.prototype.playingHandler=function(e){var t=e.currentMediaTime;this.emit(tl.playing,t)},t.prototype.pauseHandler=function(e){var t=e.currentMediaTime;this.emit(tl.pause,t)},t.prototype.mediaFinishedHandler=function(e){_.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",e),this.emit(tl.stop),this.cleanup()},t.prototype.stop=function(e){e&&_.warn("ChromecastPlayerAdaptor.stop",e.message)},t.prototype.cleanup=function(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))}}(ne),funers(),n}A(t,e),t.prototype.bindEventListeners=function(){var e=this;this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeek=this.onSeek.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeek),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.addEventListener("loadedmetadata",this.onLoadedMetadata),this.nativePlayer.textTracks.onaddtrack=function(t){var n=t.track;n&&"metadata"===n.kind&&n.addEventListener("cuechange",(function(t){var n=t.target;if(n&&"metadata"===n.kind){for(var i=[],r=0;r<n.activeCues.length;r++){var a=n.activeCues[r];i.push(a.value)}i.map((function(t){var n=t.key,i=t.info,r=t.data;r instanceof ArrayBuffer&&(r=String.fromCharCode.apply(null,new Uint8Array(r)));var a=new Zu(n,i,r);_.trace("HTML5PlayerAdaptor timedMetadata",a),e.emit(tl.timedMetadata,a)}))}}))}):_.error("Native Player wasn't passed to HTML5PlayerAdaptor")},t.prototype.onPlay=function(e){this.emit(tl.start,e.timeStamp)},t.prototype.onPause=function(e){this.emit(tl.pause,e.timeStamp)},t.prototype.onSeek=function(e){this.emit(tl.seeking,e.timeStamp)},t.prototype.onError=function(){this.emit(tl.stop),this.cleanup()},t.prototype.onCurrentTime=function(e){this.emit(tl.currentTime,e.timeStamp)},t.prototype.onStalled=function(e){this.emit(tl.stalled,e.timeStamp)},t.prototype.onLoadedMetadata=function(){var e=this.nativePlayer;this.emit(tl.loadedMetadata,{duration:e.duration,videoWidth:e.videoWidth,videoHeight:e.videoHeight})},t.prototype.stop=function(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(tl.stop),this.cleanup()},t.prototypetadatseeking"}(el||(el={}));var il=el,rl=(function(e){function t(t,n){var i=e.call(this)||this;if(!t)throw new Error("nativePlayer must be supplied");return i.nativePlayer=t,i.bus=n,i.bindEventListeners(),i}A(t,e),t.prototype.bindEventListeners=function(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(il.opened,this.onOpened),this.bus.on(il.playing,this.onPlaying),this.bus.on(il.paused,this.onPaused),this.bus.on(il.timedMetadata,this.onTimedMetadata),this.bus.on(il.ended,this.onEnded),this.bus.on(il.error,this.onError),this.bus.on(il.timeUpdate,this.onTimeUpdate),this.bus.on(il.stalled,this.onStalled),this.bus.on(il.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)},t.prototype.onSeeking=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onSeeking",e),this.emit(tl.seeking,e)},t.prototype.onStalled=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onStalled",e),this.emit(tl.stalled,e)},t.prototype.onTimeUpdate=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onTimeUpdate",e),this.emit(tl.currentTime,e)},t.prototype.onError=function(e){_.debug("TrilithiumPlayerAdaptor.onError",e),this.emit(tl.stop),this.cleanup()},t.prototype.onEnded=function(){this.emit(tl.stop),this.cleanup()},t.prototype.onTimedMetadata=function(e,t,n){var i=t,r=n.toString(),a=j.stringify(L.parse(n.toString("base64"))),s=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;_.debug("TrilithiumPlayerAdaptor.onTimedMetadata "+i+" "+r+" "+s);var o=new Zu(i,r,s);this.emit(tl.timedMetadata,o)},t.prototype.onOpened=function(e){e&&(_.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(tl.start))},t.prototype.onPlaying=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onPlaying",e),this.emit(tl.playing,e)},t.prototype.onPaused=function(){var e=this.nativePlayer.currentTime;_.debug("TrilithiumPlayerAdaptor.onPaused",e),this.emit(tl.pause,e)},t.prototype.stop=function(e){e&&_.warn("TrilithiumPlayerAdaptor.stop",e.message)},t.prototype.cleanup=function(){this.bus&&(this.bus.off(il.opened),this.bus.off(il.playing),this.bus.off(il.timedMetadata),this.bus.off(il.ended),this.bus.off(il.error),this.bus.off(il.timeUpdate),this.bus.off(il.stalled))}}(ne),6),al=7,sl=11,ol=12,cl=(funew Xu,n}A(t,e),t.prototype.onTimedMetaData=function(e){var t=this,n=e.data,i=String.fromCharCode.apply(null,n),r=["PRIV","TXXX"].find((function(e){return i.includes(e)}))||null,a=Object.keys(this.id3MetadataOwOwner[e]})).find((function(e){return i.includes(e)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new Zu(r,a,s);_.trace("AampUvePlayerAdapter timedMetadata",o),this.emit(tl.timedMetadata,o)},t.prototype.onPlaybackStateChanged=function(e){switch(e.state){case rl:this.emit(tl.pause);break;case al:this.emit(tl.seeking);break;case ol:case sl:this.emit(tl.stop),this.cleanup()}},t.prototyl.start)},t.prototype.onCuseconds)},t.prototype.onError=function(){this.emit(tl.stop),this.cleanup()},t.protoleanup()},t.prototype.cleanup=function(){}}(ne),{PLAY:tl.start,PLAYING:tl.playing,PAUSE:tl.pause,COMPLETE:"complete",LOADED_METADATA:"loadedMetadata",SEEK:"seeked",RELEASE:"dispose",PROGRESS_CHANGE:tl.currentTime,BUFFER:"buffer",ERROR:"error",AD_BREAK_START:"adBreakStart",AD_BREAK_END:"adBreakEnd"});function ul(e){return e&&"object"==typeof e&&"timeStamp"in e?e.timeStamp:parseInt(e,10)}var ll=function(){function e(e,t,n){this.playerAdaptor=e,this.plugins=[],this.config=n,this.play=this.play.bind(this),this.playing=this.playing.bind(this),this.loadedMetadata=this.loadedMetadata.bind(this),this.pause=this.pause.bind(this),this.complete=this.complete.bind(this),this.seek=this.seek.bind(this),this.release=this.release.bind(this),this.progressChange=this.progressChange.bind(this),this.buffer=this.buffer.bind(this),this.error=this.error.bind(this),this.adBreakStart=this.adBreakStart.bind(this),this.adBreakEnd=this.adBreakEnd.bind(this),this.addPlugins(t),this.bindEventListeners()}return e.prototype.setMediaItem=function(e){this.callOnPlugins("setMediaItem",e)},e.prototype.addPlugins=function(e){var t=this;e&&e.length&&elugin(e)}))},e.prototype..push(t)},e.prototype.play=function(e){this.callOnPlugins("play",ul(e))},e.prototype.playing=function(e){this.callOnPlugins("playing",ul(e))},e.prototype.pause=function(e){this.callOnPlugins("pause",ul(e))},e.prototype.complete=function(e){this.callOnPlugins("complete",ul(e))},e.prototype.loadedata",e)},e.prototype.seek=function(e){this.callOnPlugins("seek",ul(e))},e.prototype.release=function(e){this.callOnPlugins("release",ul(e))},e.prototype.progressChange=function(e){this.callOnPlugins("progressChange",ul(e))},e.prototype.buffer=function(e){this.callOnPlugins("buffer",ul(e))},e.prototype.error=function(e){this.callOnPlugins("error",ul(e))},e.prototype.adBreakStart=function(e){this.callOnPlugins("adBreakStart",ul(e))},e.prototype.a",ul(e))},e.prototype.bindEventListeners=function(){this.playerAdaptor.on(cl.PLAY,this.play),this.playerAdaptor.on(cl.PLAYING,this.playing),this.playerAdaptor.on(cl.PAUSE,this.pause),this.playerAdaptor.on(cl.COMPLETE,this.complete),this.playerAdaptor.on(cl.LOADED_METADATA,this.loadedMetadata),this.playerAdaptor.on(cl.SEEK,this.seek),this.playerAdaptor.on(cl.RELEASE,this.release),this.playerAdaptor.on(cl.PROGRESS_CHANGE,this.progressChange),this.playerAdaptor.on(cl.BUFFER,this.buffer),this.playerAdaptor.on(cl.ERROR,this.error),this.playerAdaptor.on(cl.AD_BREAK_START,this.adBreakStart),this.playerAdaptor.on(cl.AD_BREAK_END,this.adBreakEnd)},e.prototype.unbindEventreakEnd)},e.prototype.callOnPlugins=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.plugins.forEach((function(n){if("function"==typeof n[e])try{n[e].apply(n,t)}catch(e){_.error(e)}}))},e.prototype.dispose=function(){this.unbindEventListeners(),this.pluginsispose()})),this.plugins=null,this.playerAdaptor=null,this.config=null},e}();const dl=trace(e)}};var hl;(hl=e.QueueMode||(e.QueueMode={})).first="first",hl.last="last",hl.all="all";const pl={maxAttempts:3,persistSession:!0,retryTimeout:6e4,SESSION_KEY_PREFIX:"ResilientRemoteStorage",queueMode:e.QueueMode.all};const fl={Accept:"application/json","Cache-Control":"no-cache","Content-Type":"application/json",Pragma:"no-cache"},ml={swid:null,bu:null,contentSource:null,s2:null,source:null,endpointTemplate:"https://fan.core.api.espn.com/apis/v2/progress/{{SWID}}/{{BUSINESS_UNIT}}/{{CONTENT_SOURCE}}/{{CONTENT_ID}}",completePercentThreshold:97,fetchCredentials:"include"},gl={espn:0,marvel:2},yl={espn:{longform:0}};Vc.start,Vc.playing,Vc.pause,Vc.currentTime;const vl={interval:15e3,debounce:250,minimumProgressBeforeTrabl=()=>{};e.AdobeConcurrencyMonitorBuilder=Vr,e.AdvertisingInfo=En,e.AtvlPlayerAdaptor=class extends ne{constructor(e,t,n){if(super(),!t)throw new Error("bus must be supplied");this.bus=t,this.secureKeyDelivery=new Gc(n),this.bindEventListeners()}bindEventListeners(){this.bus.on(Rc.willStartPlaying,()=>{atv.player.observeTimedMetadataKeys(),this.emit(Vc.start)}),this.bus.on(Rc.playerStateChanged,(e,t)=>{switch(_.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",e,t),e){case atv.player.states.FastForwarding:this.emit(Vc.seeking,t);break;case atv.player.states.Loading:this.emit(Vc.stalled,t);break;case atv.player.states.Paused:this.emit(Vc.pause,t);break;case atv.player.states.Playing:this.emit(Vc.playing,t);break;case atv.player.states.Rewinding:this.emit(Vc.seeking,t)}}),this.bus.on(Rc.onTimedMetadataChanged,e=>{const t=e.key,n=e.extraAttributes.info,{dataValue:i}=e,r=i&&j.stringify(L.parse(i))||"";r.replace("\0",""),this.emit(Vc.timedMetadata,new Bc(t,n,r))}),this.bus.on(Rc.didStleanup()}),this.bus.on(Rc.playerTimetTime,e)})}set playbackConfig(e){if(!e)return;const{licenseUrl:t}=e;_.debug("AtvlPlayerAdaptor setPlaybackConfig",t,e.protectionSystem),t&&(this.secureKeyDelivery.certificateUrl=t)}stop(e){const{message:t}=e;atv.player.stopWithReason("Video Playback Has Stopped",Playing)}},e.AtvlPlayerEvent=Rc,e.AtvlPlayerEventBus=Hu,e.AuthenticationManager=po,e.AuthenticationType=Oe,e.BAMTizenPlayerAdaptor=class extends ne{constructor(e,t){super(),e&&(this.nativePlayer=e,this.bus=e.getEventBus(),this.constants=t,this.id3MetadataOwner=new Fc,this.unsubscribers=[],this.bindEventListeners())}bindEventListeners(){this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.ID3,this,(e={})=>{const t=e.sample?e.sample.data:e,n=t instanceof Uint8Array?String.fromCharCode(...t):t,i=["PRIV","TXXX"].find(e=>n.includes(e))||null,r=Object.keys(this.id3MetadataOwner).map(e=>this.id3MetadataOwner[e]).find(e=>n.includes(e))||null,a=r?n.substring(n.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):null,s=new Bc(i,r,a);this.emit(Vc.timedMetadata,s)})),this.alreadyStarted=!1,this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PLAYING,this,()=>{_.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),this.alreadyStarted?this.emit(Vc.playing):(this.emit(Vc.start),this.emit(Vc.playing),this.alreadyStarted=!0)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,this,e=>{const t=e/1e3;this.emit(Vc.currentTime,t)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PAUSED,this,()=>{_.trace("BAMTizenPlayerAdaptor Events.Player.PAUSED");const e=this.getCurrentTime();this.emit(Vc.pause,e)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKING,this,()=>{_.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING");const e=this.getCurrentTime();this.emit(Vc.seeking,e)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKED,this,()=>{_.trace("BAMTizenPlayerAdaptor Events.Player.SEEKED");const e=this.getCurrentTime();this.emit(Vc.seeked,e)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,this,()=>{_.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),this.emit(Vc.stalled)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,this,()=>{_.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),this.emit(Vc.playing)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.COMPLETE,this,()=>{_.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),this.emit(Vc.stop),this.cleanup()}))}getCurrentTime(){let e=null;const t=this.nativePlayer&&this.nativePlayer.getCurrentPlayer?this.nativePlayer.getCurrentPlayer():null;return e=t&&t.getCurrentTime?t.getCurrentTime():null,e=isNaN(e)?null:e/1e3,e}stop(e){e&&_.warn("BAMTizenPlayerAdaptor.stop",e.message),this.nativePlayer.stop(),this.cleanup()}cleanup(){this.alreadyStarted=!1,this.unsubscribers.forEach(e=>"function"==typeof e&&e()),this.unsubscribers=[]}},e.BootstrappedESPNAffiliateAPI=ys,e.CallbackStor,t,atem=null}},e.ChromecastPlayerAdaptor=class extends ne{constructor(e){super(),e&&(this.nativePlayer=e,this.id3MetadataOwner=new Fc,this.bindEventListeners())}bindEventListeners(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)}loadComplc.start)}id3Handler(e){if(_.debug("ChromecastPlayerAdaptor._id3Handler",e),e.detail&&(e.segmentData=e.detail),!e.segmentData)return;const t=String.fromCharCode(...e.segmentData);_.trace("ChromecastPlayerAdaptor._id3Handler",t);const n=["PRIV","TXXX"].find(e=>t.includes(e))||null,i=Object.keys(this.id3MetadataOaOwnercludes(e))||null,r=i?t.substring(t.lastIndexOf(i)+i.length).trim().replace(/\0/g,""):null,a=new Bc(n,i,r);_.trace("ChromecastPlayerAdaptor._id3Handler","tag:",n,"owner:",i,"dataValue:",r),this.emit(Vc.timedMetadata,a)}timeUpdateHandler(e){const t=e.currentMediaTime;this.emit(Vc.currentTime,t)}playingHandler(e){const t=e.currentMediaTime;this.emit(Vc.playing,t)}pauseHandler(e){const t=e.currentMediaTime;this.emit(Vc.pause,t)}mediaFinishedHandler(e){_.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",e),this.emit(Vc.stop),this.cleamessage)}cleanup(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))}},e.Client=he,e.DRMKeySystem=Rr,e.DRMSupport=Hr,e.DTCITVEntitlementAPI=Jc,e.DomesticLocationProvider=gs,e.DrmSupport=Hr,e.FanManager=is,e.FuseStorage=class exte))})}resilientFetch(t,n){return new S(i=>{if(this.waitForResume_){const r={url:t,params:n};return this.queueMode===e.QueueMode.all?this.queuedFetchArgs.push(r):(this.queueMode===e.QueueMode.first&&!this.queuedFetchArgs.length||this.queueMode===e.QueueMode.last)&&(this.queuedFetchArgs[0]=r),this.drainQueueWhenResumed().then(i)}T(mpts=0,e)).then.th t>=i}hideProgress(e,t){return this.updateProgresnull}},e.HTML5PlayerAdaptor=class eteners()}bindEventListeners(){this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeeking=this.onSeeking.bind(this),this.onSeeked=this.onSeeked.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeeking),this.nativePlayer.addEventListener("seeked",this.onSeeked),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.addEventListener("loadedmetadata",this.onLoadedMetadata),this.nativePlayer.textTracks.onaddtrack=e=>{const t=e.track;t&&"metadata"===t.kind&&t.addEventListener("cuechange",e=>{const t=e.target;if(!t||"metadata"!==t.kind)return;const n=[];for(let e=0;e<t.activeCues.length;e++){const i=t.activeCues[e];n.push(i.value)}n.map(e=>{const t=e.key,n=e.info;let i=e.data;i instanceof ArrayBuffer&&(i=String.fromCharCode.apply(null,new Uint8Array(i)));const r=new Bc(t,n,i);_.trace("HTML5PlayerAdaptor timedMetadata",r),this.emit(Vc.timedMetadata,r)})})}):_.error("Native Player wasn't passed to HTML5PlayerAdaptor")}onPlay(e){this.emit(Vc.start,e.timeStamp)}onPause(e){this.emit(Vc.pause,e.timeStamp)}onSeeking(e){this.emit(Vc.seeking,e.timeStamp)}onSeeked(e){this.emit(Vc.seeked,e.timeStamp)}onError(){this.emit(Vc.stop),this.cleanup()}onCurrentTime(e){this.emit(Vc.currentTime,e.tmeStamp)}onLoadedMetadata(){const e=this.nativePlayer;this.emit(Vc.loadedMetadata,{duration:e.duration,videoWidth:e.videoWidth,videoHeight:e.videoHeight})}stop(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(Vc.stop),this.cleanup()}cleanup(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeeking),this.nativePlayer.removeEventListener("seeked",this.onSeeked),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop),this.nativePlayer.removeEventListener("loadedmetadata",this.onLoadedMetadata)}},e.LocationProvider=ms,e.MediaItemAPI=yt,e.MediaItemAuthenticationType=Oe,e.MediaItemSourceType=De,e.MediaItemTrackingType=_e,e.NielsenCloudAPIClient=Gu,e.NielsenTrackingManager=Ku,e.PlaybackConfig=Ki,e.PlaybackCoordinator=Pc,e.PlaybackManager=Sc,e.PlayerEventBus=Hu,e.PlayerPlugin=Wu,e.PlayerPluginManager=ll,e.ProgressTracker=class extetent=!1}firstPlay(e){this.didFirtent(e)}loadedMetadata(e){}pause(e){}complete(e){}seek(e){}release(e){}progressChange(e){}buffer(e){}error(e){}adBreakStart(e){}adBreakEnd(e){}dispose(){this.delegate=null,this.config=null,this.mediaIt(t)}setContentDuration(e){this.contentDress_(e)}pause(e){this.debouncedSavePros_(e,!0)}seek(e){this.debouncedSaveProgress_(e)}release(e){this.debouncedSaveProess_(e))}resumedProgressChange(e){this.throttledSaveProll}},e.ShieldAPI=$r,e.TVEAuthenticator=Fu,e.TokenAuthenticator=class{constructor(e){this.authenticatedProviderId=null,this.providerDataSource=null,this.partner=e.partner,this.platform=eity")}set authenticatedIdentity(e){e?localStorage.setItem("TokenAuthenticator.authenticatedIdentity",e):localStorage.removeItem("TokenAuthenticator.authenticatedIdentity")}get authenticatedProvider(){const e=localStorage.getItem("TokenAuthenticator.authenticatedProvider");try{return Tc.fromObject(JSON.parse(e))}catch(e){return null}}set authenticatedProvider(e){e?localStorage.setItem("TokenAuthenticator.authenticatedProvider",JSON.stringify(e)):localStorage.removeItem("TokenAuthenticator.authenticatedProvider")}setToken(e,t,n,i){this.token=e,this.tokenType=t,this.resource=n,this.zipcode=i}checkAuthentication(){const e=this.authenticatedProviderId;if(!e||this.authenticatedProvider&&e===this.authenticatedProvider.id)return S.resolve(this.isAuthenticated);if(!this.providerDataSource)return this.authenticatedProvider=new Tc(e,e,null,null),S.resolve(this.isAuthenticated);const t="ADOBEPASS"===(n=this.tokenType)?Nc.mvpd:"DEVICE"===n?Nc.isp:"AUTHTOKEN"===n?Nc.mvpd:null;var n;return this.providerDataSource.getProvider(e,t).then(t=>{const n=t.getPreferredLogoUrl(this.partner);return this.authenticatedProvider=new Tc(e,t.name,n,t.websiteUrl),S.resolve(this.isAuthenticated)}).catch(()=>(this.authenticatedProvider=new Tc(e,e,null,null),S.resolve(this.isAuthenticated)))}authenticate({authenticatedProviderId:e,authenticatedIdentity:t,token:n,tokenType:i,zipcode:r}){return this.authenticatedProviderId=e,this.authenticatedIdentity=t,this.setToken(n,i,null,r),this.checkAuthentication()}deauthenticate(){return this.authenticatedProvider=null,this.authenticatedIdentity=null,this.token=null,this.tokenType=null,this.resource=null,this.zipcode=null,S.resolve(!0)}checkAuthorization(e)"JWT"===e)(n=this.tokenType)?Oe.mvpd:"DEVICE"===n?Oe.isp:"BAM"===n?Oe.direct:null;var n;if(!this.isAuthenticated||-1===e.authenticationTypes.indexOf(t)&&"DEVICE"!==this.tokenType&&"GATEKEEPER"!==this.tokenType)return S.resolve(new Ac(!1,null));const i={[kc.CustomDataKey.token]:this.token,[kc.CustomDataKey.tokenType]:this.tokenType};this.zipcode&&(i.zipcode=this.zipcode),this.resource&&(i.resource=this.resource);const r=new kc(t,this.authenticatedProvider,this.authenticatedIdentity,i),a=new Ac(!0,r);return S.resolve(a)}},e.TrilithiumPlayerAdaptor=class extends ne{constructor(e,t){if(super(),!e)throw new Error("nativePlayer must be supplied");this.nativePlayer=e,this.bus=t,this.bindEventListeners()}bindEventListeners(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(qc.opened,this.onOpened),this.bus.on(qc.playing,this.onPlaying),this.bus.on(qc.paused,this.onPaused),this.bus.on(qc.timedMetadata,this.onTimedMetadata),this.bus.on(qc.ended,this.onEnded),this.bus.on(qc.error,this.onError),this.bus.on(qc.timeUpdate,this.onTimeUpdate),this.bus.on(qc.stalled,this.onStalled),this.bus.on(qc.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)}onSeeking(){const{currentTime:e}=this.nativePlayer;_.debug("TrilithiumPlayerAdaptor.onSeeking",e),this.emit(Vc.seeking,e)}onStalled(){const{currentTime:e}=this.nativePlayer;_.debug("TrilithiumPlayerAdaptor.onStalled",e),this.emit(Vc.stalled,e)}onTimeUpdate(){const{currentTime:e}=this.nativePlayer;_.debug("TrilithiumPlayerAdaptor.onTimeUpdate",e),this.emit(Vc.currentTime,e)}onError(e){_.debug("TrilithiumPlayerAdaptor.onError",e),this.emit(Vc.stop),this.leanup()}onTimedMetadata(e,t,n){const i=t,r=n.toString(),a=j.stringify(L.parse(n.toString("base64"))),s=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;_.debug(`TrilithiumPlayerAdaptor.onTimedMetadata ${i} ${r} ${s}`);const o=new Bc(i,r,s);this.emit(Vc.timedMetadata,o)}onOpened(e){e&&(_.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(Vc.start))}onPlaying(){const{currentTime:e}=this.nativePlayer;_.debug("TrilithiumPlayerAdaptor.onPlaying",e),this.emit(Vc.playing,e)}onPaused(){const{currentTime:e}=this.nativePlayer;_.debug("TrilithiumPlayerAdaptor.onPaused",e),this.emit(Vc.pause,e)}stop(e){e&&_.warn("TrilithiumPlayerAdaptor.stop",e.message)}cleanup(){this.bus&&(this.bus.off(qc.opened),this.bus.off(qc.playing),this.bus.off(qc.timedMetadata),this.bus.off(qc.ended),this.bus.off(qc.error),this.bus.off(qc.timeUpdate),this.bus.off(qc.stalled))}},e.TrilithiumPlayerEvent=qc,e.log=P,e.uuid=Z,Object.defineProperty(e,"__esModule",{value:!0})}));
