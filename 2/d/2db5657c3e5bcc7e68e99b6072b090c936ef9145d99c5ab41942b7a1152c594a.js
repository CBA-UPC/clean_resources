(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[621],{dz0V:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var l=n("31lE"),i=n("CMIS"),o=n("hhzZ"),s=(n("hZW2"),n("cgnd"),function(){eturn t.prototype.ngAfterViewInit=function(){var t=this;try{this.startTabGuardrail=this.getGuardrail(!0),this.startScanGuardrail=this.getGuardrail(!1),this.parent=this.renderer.parentNode(this.elementRef.nativeElement),this.renderer.insertBefore(this.parent,this.startTabGuardrail,this.elementRef.nativeElement),this.renderer.insertBefore(this.parent,this.startScanGuardrail,this.elementRef.nativeElement);var e=this.renderer.nextSibling(this.elementRef.nativeElement);this.endTabGuardrail=this.getGuardrail(!0),this.endScanGuardrail=this.getGuardrail(!1),e?this.renderer.insertBefore(this.parent,this.endTabGuardrail,e):this.renderer.appendChild(this.parent,this.endTabGuardrail),this.renderer.insertBefore(this.parent,this.endScanGuardrail,this.endTabGuardrail),this.documentService.nativeDocument.addEventListener("focus",(function(e){return t.onFocus(e)}),!0),this.lastFocusedElement=this.documentService.nativeDocument.activeElement}catch(t){this.instrumentError(t,"Open")}},t.prototype.ngOnDestroy=function(){this.documentService.nativeDocument.removeEventListener("focus",this.onFocus,!0),this.parent&&(this.startTabGuardrail&&this.renderer.removeChild(this.parent,this.startTabGuardrail),this.startScanGuardrail&&this.renderer.removeChild(this.parent,this.startScanGuardrail),this.endTabGuardrail&&this.renderer.removeChild(this.parent,this.endTabGuardrail),this.endScanGuardrail&&this.renderer.removeChild(this.parent,this.endScanGuardrail))},t.prototype.getGuardrail=function(t){var e=this.renderer.createElement("div");return this.renderer.setProperty(e,"tabIndex",t?0:-1),this.renderer.setStyle(e,"width",0),this.renderer.setStyle(e,"height",0),e},t.prototype.onFocus=function(t){try{if(this.ignoreFocusChanges||this.elementRef.nativeElement.contains(t.target))return void(this.lastFocusedElement=t.target);if(t.target===this.startScanGuardrail)return void this.focusElement(this.endScanGuardrail);if(t.target===this.endScanGuardrail)return void this.focusElement(this.startScanGuardrail);var e=this.elementRef.nativeElement.querySelector("#"+this.startId),n=this.elementRef.nativeElement.querySelector("#"+this.endId);if(!e||!n)return void(this.lastFocusedElement=t.target);this.focusElement(this.lastFocusedElement&&this.elementRef.nativeElement.contains(this.lastFocusedElement)&&t.target===this.startTabGuardrail?n:e)}catch(t){this.lastFocusedElement=this.documentService.nativeDocument.activeElement,this.instrumentError(t,"Focus")}},t.prototype.focusElement=function(t){this.ignoreFocusChanges=!0;try{t.focus()}catch(t){}this.ignoreFocusChanges=!1},t.prototype.instrumentError=function(t,e){if(t){var n={};n.Error=new o.d(t.toString(),this.clientStartupConfigService.config.logPiiInClearText?l.AWTPiiKind.NotSet:l.AWTPiiKind.GenericData),n.Action=e,this.instrumentationService.logGenericEvent("Focus_Context_Error",n),Object(i.a)({eventName:"Focus_Context",errorType:"Focus_Context_Error",message:t.toString(),debugInfo:"Action: "+e})}},t}())},vvW8:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var l=n("HQCr"),i=(n("hhzZ"),function(){eturn t.prototype.onClick=function(t){if(!t.defaultPrevented&&this.clickData){var e=this.clickData.params.ElementId||"Unknown",n=this.clickData.params.Referral,i=this.clickData.params.Area;this.instrumentationService.logClickEvent(this.clickData.eventName,e,i,n,"Web",this.clickData.params,this.clickData.metrics),Object(l.a)(e,i||"Other",n,"Other","Click",this.clickData.eventName)}},t.prototype.ngOnInit=t}())},ynE4:function(t,e,n){"use strict";n.r(e),n.d(e,"UploadDialogModuleNgFactory",();var l=n("keVe"),i=n("PZOQ"),o=n("hhzZ"),s=n("hZW2"),r=n("cgnd"),a=n("PBJH"),u=n("24t9"),c=n("k+kJ"),d=n("JScD"),p=n("uG5N"),h=(n("1BRG"),function(){eturn t.prototype.ngOnInit=function(){var t=this;if(this.uploadConfigService.config){var e=this.uploadConfigService.config.commonResources;this.uploadCompleteSubtitle=e.completedSubtitle,this.uploadCompleteTitle=e.completedTitle,this.showCompleted=!1,this.uploadPercentage=0,this.uploadResourcesSubscription=this.uploadManagerService.uploadResources.subscribe((),this.uploadSessionSubscription=this.uploadManagerService.uploadSession.subscribe((),this.keyListener=this.renderer.listen(this.documentService.nativeDocument,"keyup",(function(e){var n=u.a.getKey(e);t.show&&3===n&&t.cancel()}))}},t.prototype.ngOnDestroy=function(){this.uploadResourcesSubscription&&this.uploadResourcesSubscription.unsubscribe(),this.uploadSessionSubscription&&this.uploadSessionSubscription.unsubscribe(),this.uploadProgressSubscription&&this.uploadProgressSubscription.unsubscribe(),this.keyListener&&this.keyListener()},t.prototype.cancel=t.prototype.updateDialog=function(t){var e=this.uploadConfigService.config.commonResources;this.uploadSessionState=t,this.showCompleted=!!t&&t.state===c.c.Completed,this.cancelButtonText=this.showCompleted||t&&t.state===c.c.Failed?e.closeButtonTitle:e.cancelButtonTitle,this.cancelButtonAriaLabel=this.showCompleted?e.closeButtonAriaLabel:e.cancelButtonAriaLabel,this.show=!!t&&(t.state===c.c.Started||t.state===c.c.Failed||t.state===c.c.Completed),this.cancelEnabled=!!this.uploadSessionState&&(this.uploadSessionState.state!==c.c.Completed||this.showCompleted||"cloudtest"===this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment),this.cancelClickData=this.getCancelClickData(),this.showTip=!!t&&t.uploadSource===c.d.Button&&this.uploadConfigService.config.dragAndDropEnabled,this.updateProgress(),this.checkAndInstrumentImpression(),this.lastKnownState=t},t.prototype.updateProgress=function(){this.uploadSessionState&&this.lastKnownState&&this.uploadSessionState===this.lastKnownState||this.resetProgress()},t.prototype.resetProgress=function(){var t=this;if(this.uploadProgressSubscription&&this.uploadProgressSubscription.unsubscribe(),!this.uploadSessionState)return this.progressText="",this.uploadPercentage=0,void(this.uploadProgressSubscription=null);this.uploadProgressSubscription=this.uploadSessionState.getProgress().subscribe((function(e){t.progressText=t.getProgressText(e),t.uploadPercentage=e.percentage}))},t.prototype.getCancelClickData=function(){if(!this.cancelEnabled)return null;var t=this.uploadSessionState.finished()?"Close":"Cancel",e={};return e.UploadSessionId=this.uploadSessionState.sessionId,e.ElementId="upload-cancel",e.Action=t,e.Area=o.b.UploadDialog,e.Latency=Math.ceil(this.uploadSessionState.duration).toString(),e.ItemCategory=c.d[this.uploadSessionState.uploadSource],{eventName:"Upload_Click",params:e,metrics:[]}},t.prototype.getProgressText=function(t){var e=this.localDataSizePipe.transform(t.loaded),n=this.localDataSizePipe.transform(t.total);return this.locService.format(this.uploadConfigService.config.commonResources.progressText,e,n)},t.prototype.updateUploadResources=t.prototype.checkAndInstrumentImpression=function(){if(this.uploadSessionState&&(!this.lastKnownState||this.uploadSessionState.state!==this.lastKnownState.state))if(this.uploadSessionState.state===c.c.Started)(t={}).UploadSessionId=this.uploadSessionState.sessionId,t.ImpressionId="progress",t.ItemCategory=c.d[this.uploadSessionState.uploadSource],this.instrumentationService.logImpressionEvent("Upload_Dialog_Impression",t);else if(this.uploadSessionState.state===c.c.Failed){var t,e=this.uploadSessionState.error;(t={}).UploadSessionId=this.uploadSessionState.sessionId,t.Error=c.a[e&&e.type?e.type:c.a.Unknown],t.ItemCount=(e&&e.recourseAction?2:1).toString(),t.ImpressionId="error",t.ItemCategory=c.d[this.uploadSessionState.uploadSource],this.instrumentationService.logImpressionEvent("Upload_Dialog_Impression",t)}},t}()),S=h,g=),b=n("fYis"),m=n("TOqr"),f=n("vvW8"),v=n("dz0V"),C=l.Fb({encapsulation:2,styles:[],data:{}});function y(t){return l.jc(0,[(t()(),l.Hb(0,0,null,null,8,"div",[],null,null,null,null,null)),(t()(),l.Hb(1,0,null,null,1,"div",[["id","upload-dialog-subtitle"]],null,null,null,null,null)),(t()(),l.gc(2,null,["",""])),(t()(),l.Hb(3,0,null,null,3,"div",[["class","progress-bar"]],null,null,null,null,null)),(t()(),l.Hb(4,0,null,null,2,"div",[["class","progress-bar__content ms-bgc-tp"]],null,null,null,null,null)),l.Gb(5,278528,null,0,m.n,[l.o,l.y,l.K],{ngStyle:[0,"ngStyle"]},null),l.Zb(6,{width:0}),(t()(),l.Hb(7,0,null,null,1,"div",[["class","progress-text ms-fcl-ns"]],null,null,null,null,null)),(t()(),l.gc(8,null,["",""]))],(function(t,e){var n=t(e,6,0,e.component.uploadPercentage+"%");t(e,5,0,n)}),()}function k(t){return l.jc(0,[(t()(),l.Hb(0,0,null,null,1,"div",[["class","upload-subtitle ms-fcl-ns"],["id","upload-dialog-subtitle"]],null,null,null,null,null)),(t()(),l.gc(1,null,[" "," "]))],null,(function(t,e){var n=e.component;t(e,1,0,n.showCompleted?n.uploadCompleteSubtitle:n.uploadSessionState.error.message)}))}function I(t){return l.jc(0,[(t()(),l.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),(t()(),l.Hb(1,0,null,null,1,"div",[["class","upload-tip"]],null,null,null,null,null)),(t()(),l.gc(2,null,["",""]))],null,(function(t,e){t(e,2,0,e.component.dragAndDropTip)}))}function E(t){return l.jc(0,[(t()(),l.Hb(0,0,null,null,3,"button",[["class","generic-button ms-bgc-tp ms-fcl-w generic-button--fluent generic-button--fluent--primary generic-button--bordered ms-bgc-w-h ms-bgc-w-a ms-fcl-tp-h ms-fcl-tp-a"],["id","upload-recourse"]],[[1,"aria-label",0]],[[null,"click"]],(function(t,e,n){var i=!0,o=t.component;return"click"===e&&(i=!1!==l.Wb(t,1).onClick(n)&&i),"click"===e&&(i=!1!==(null==o.uploadSessionState.error||null==o.uploadSessionState.error.recourseAction?null:o.uploadSessionState.error.recourseAction.action())&&i),i}),null,null)),l.Gb(1,81920,null,0,f.a,[o.a,l.o],{clickData:[0,"clickData"]},null),(t()(),l.Hb(2,0,null,null,1,"span",[["class","generic-button__text"]],null,null,null,null,null)),(t()(),l.gc(3,null,["",""]))],(function(t,e){var n=e.component;t(e,1,0,null==n.uploadSessionState.error||null==n.uploadSessionState.error.recourseAction?null:n.uploadSessionState.error.recourseAction.clickData)}),(function(t,e){var n=e.component;t(e,0,0,null==n.uploadSessionState.error||null==n.uploadSessionState.error.recourseAction?null:n.uploadSessionState.error.recourseAction.ariaLabel),t(e,3,0,n.uploadSessionState.error.recourseAction.text)}))}function w(t){return l.jc(0,[(t()(),l.Hb(0,0,null,null,21,"div",[["aria-labelledby","upload-dialog-title upload-dialog-subtitle"],["aria-live","polite"],["aria-modal","true"],["class","page-overlay"],["endId","upload-cancel"],["ohpFocusContext",""],["role","alertdialog"]],null,null,null,null,null)),l.Gb(1,4341760,null,0,v.a,[s.a,l.o,o.a,l.K,r.b],{startId:[0,"startId"],endId:[1,"endId"]},null),(t()(),l.Hb(2,0,null,null,0,"div",[["class","page-overlay__background ms-bgc-nd"]],null,null,null,null,null)),(t()(),l.Hb(3,0,null,null,18,"div",[["class","dialog ms-bgc-w"]],null,null,null,null,null)),(t()(),l.Hb(4,0,null,null,1,"h2",[["class","dialog__title--fluent ms-fcl-ns"],["id","upload-dialog-title"]],null,null,null,null,null)),(t()(),l.gc(5,null,["",""])),(t()(),l.Hb(6,0,null,null,6,"div",[["class","dialog__content-container ms-fcl-nd"]],null,null,null,null,null)),(t()(),l.qb(16777216,null,null,1,null,y)),l.Gb(8,16384,null,0,m.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(t()(),l.qb(16777216,null,null,1,null,k)),l.Gb(10,16384,null,0,m.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(t()(),l.qb(16777216,null,null,1,null,I)),l.Gb(12,16384,null,0,m.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(t()(),l.Hb(13,0,null,null,8,"div",[["class","dialog__actions upload-actions"]],null,null,null,null,null)),(t()(),l.qb(16777216,null,null,1,null,E)),l.Gb(15,16384,null,0,m.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(t()(),l.Hb(16,0,null,null,5,"button",[["autofocus",""],["class","generic-button generic-button--fluent generic-button--fluent--secondary generic-button--bordered ms-bgc-w ms-bgc-tp-h ms-bgc-tp-a ms-fcl-tp ms-fcl-w-h ms-fcl-w-a"],["id","upload-cancel"]],[[1,"aria-label",0]],[[null,"click"]],(function(t,e,n){var i=!0,o=t.component;return"click"===e&&(i=!1!==l.Wb(t,19).onClick(n)&&i),"click"===e&&(i=!1!==o.cancel()&&i),i}),null,null)),l.Gb(17,278528,null,0,m.i,[l.x,l.y,l.o,l.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),l.Zb(18,{"generic-button--disabled":0}),l.Gb(19,81920,null,0,f.a,[o.a,l.o],{clickData:[0,"clickData"]},null),(t()(),l.Hb(20,0,null,null,1,"span",[["class","generic-button__text"]],null,null,null,null,null)),(t()(),l.gc(21,null,["",""]))],(function(t,e){var n=e.component;t(e,1,0,null!=n.uploadSessionState.error&&n.uploadSessionState.error.recourseAction?"upload-recourse":"upload-cancel","upload-cancel"),t(e,8,0,!(n.uploadSessionState.error||n.showCompleted)),t(e,10,0,n.uploadSessionState.error||n.showCompleted),t(e,12,0,!(n.uploadSessionState.error||n.showCompleted)&&n.showTip&&n.dragAndDropTip),t(e,15,0,null==n.uploadSessionState.error?null:n.uploadSessionState.error.recourseAction);var l=t(e,18,0,!n.cancelEnabled);t(e,17,0,"generic-button generic-button--fluent generic-button--fluent--secondary generic-button--bordered ms-bgc-w ms-bgc-tp-h ms-bgc-tp-a ms-fcl-tp ms-fcl-w-h ms-fcl-w-a",l),t(e,19,0,n.cancelClickData)}),(function(t,e){var n=e.component;t(e,5,0,n.uploadSessionState.error?n.uploadSessionState.error.title:n.showCompleted?n.uploadCompleteTitle:n.uploadProgressTitle),t(e,16,0,n.cancelButtonAriaLabel),t(e,21,0,n.cancelButtonText)}))}ar D=l.Db("ohp-upload-dialog",h,(function(t){return l.jc(0,[(t()(),l.Hb(0,0,null,null,1,"ohp-upload-dialog",[],null,null,null,G,C)),l.Gb(1,245760,null,0,h,[s.a,o.a,i.a,a.a,l.K,r.b,d.a,p.a],null,null)],(,null)}),{},{},[]),T=n("+P5Z"),P=n("xIlw"),A=n("+a0u"),U=n("lQwO"),_=n("CfLe"),F=n("ej7j"),x=n("X+PR"),R=n("VY7U"),H=n("CCRL"),W=l.Eb(g,[],(function(t){return l.Tb([l.Ub(512,l.k,l.hb,[[8,[b.a,D]],[3,l.k],l.D]),l.Ub(4608,m.m,m.l,[l.z]),l.Ub(1073742336,m.c,m.c,[]),l.Ub(1073742336,T.a,T.a,[]),l.Ub(1073742336,P.a,P.a,[]),l.Ub(1073742336,A.a,A.a,[]),l.Ub(1073742336,U.a,U.a,[]),l.Ub(1073742336,_.a,_.a,[]),l.Ub(1073742336,F.a,F.a,[]),l.Ub(1073742336,x.o,x.o,[[2,x.u],[2,x.n]]),l.Ub(1073742336,R.a,R.a,[]),l.Ub(1073742336,g,g,[]),l.Ub(256,H.a,S,[])])}))}}]);
//# sourceMappingURL=upload-dialog.702d1d15c2880e383da1.chunk.v7.js.map