![function(e,t,n){var r;!function(i,o){"use strict";unction s(e,t){for(var n,r=t.length,i=e.length;r>i;)n=t[--r],t.splice(r,1),n.unmount()}ction p(e,t,n){T(e,"each");var r,i=typeof E(e,"no-reorder")!==oe||T(e,"no-reorder"),o=N(e),p=ee[o]||{tmpl:w(e)},h=ue.test(o),f=e.parentNode,g=document.createTextNode(""),m=M(e),y="option"===o.toLowerCase(),v=[],b=[],k="VIRTUAL"==e.tagName;n=ge.loopKeys(n),f.insertBefore(g,e),t.one("before-mount",.on("update",function(){var w=ge(n.val,t),x=document.createDocumentFragment();B(w)||(r=w||!1,w=r?Object.keys(w).map(:[]);for(var _=0,T=w.length;_<T;_++){var S=w[_],E=i&&typeof S==ae&&!r,A=b.indexOf(S),M=~A&&E?A:_,C=v[M];S=!r&&n.key?a(n,S,_):S,!E&&!C||E&&!~A||!C?(C=new d(p,{parent:t,isLoop:!0,hasImpl:!!ee[o],root:h?f:e.cloneNode(),item:S},e.innerHTML),C.mount(),k&&(C._root=C.root.firstChild),_!=v.length&&v[_]?(k?u(C,f,v[_]):f.insertBefore(C.root,v[_].root),b.splice(_,0,S)):k?u(C,x):x.appendChild(C.root),v.splice(_,0,C),M=_):C.update(S,!0),M!==_&&E&&v[_]&&(k?l(C,f,v[_],e.childNodes.length):f.insertBefore(C.root,v[_].root),n.pos&&(C[n.pos]=_),v.splice(_,0,v.splice(M,1)[0]),b.splice(_,0,b.splice(M,1)[0]),!m&&C.tags&&c(C,_)),C._item=S,O(C,"_parent",t)}if(s(w,v),y){if(f.appendChild(x),fe&&!f.multiple)for(var I=0;I<f.length;I++)if(f[I].__riot1374){f.selectedIndex=I,delete f[I].__riot1374;break}}else f.insertBefore(x,g);m&&(t.tags[o]=v),b=w.slice()})}function h(e,t,n,r){z(e,function(e){if(1==e.nodeType){if(e.isLoop=e.isLoop||e.parentNode&&e.parentNode.isLoop||E(e,"each")?1:0,n){var i=M(e);i&&!e.isLoop&&n.push(R(i,{root:e,parent:t},e.innerHTML,t))}e.isLoop&&!r||Q(e,t,[])}})}function f(e,t,n){(e,function(e){var n,i=e.nodeType;if(3==i&&"STYLE"!=e.parentNode.tagName&&r(e,e.nodeValue),1==i)return(n=E(e,"each"))?(p(e,t,n),!1):(v(e.attributes,,!M(e)&&void 0)})}function d(e,t,n){function r(){var e=m&&g?l:d||l;v(E.attributes,function(t){var n=t.value;p[S(t.name)]=ge.hasExpr(n)?ge(n,e):n}),v(Object.keys(C),}function i(e){for(var t in w)typeof l[t]!==se&&P(l,t)&&(l[t]=e[t])}function a(){l.parent&&g&&v(Object.keys(l.parent),function(e){var t=!le.test(e)&&j(I,e);(typeof l[e]===se||t)&&(t||I.push(e),l[e]=l.parent[e])})}r u,l=J.observable(this),p=G(t.opts)||{},d=t.parent,g=t.isLoop,m=t.hasImpl,w=D(t.item),k=[],x=[],E=t.root,M=E.tagName.toLowerCase(),C={},I=[];e.name&&E._tag&&E._tag.unmount(!0),this.isMounted=!1,E.isLoop=g,E._tag=this,O(this,"_riot_id",++K),L(this,{parent:d,root:E,opts:p},w),O(this,"tags",{}),v(E.attributes,,u=me(e.tmpl,n),O(this,"update",function(e,t){return e=D(e),a(),e&&_(w)&&(i(e),w=e),L(l,e),r(),l.trigger("update",e),y(k,l),t&&l.parent?l.parent.one("updated",function(){l.trigger("updated")}):ve(function(){l.trigger("updated")}),this}),O(this,"mixin",function(){return v(arguments,function(e){var t;e=typeof e===oe?J.mixin(e):e,b(e)?(t=new e,e=e.prototype):t=e,v(Object.getOwnPropertyNames(e),,t.init&&t.init.bind(l)()}),this}),O(this,"mount",function(){r();var t=J.mixin(te);if(t)for(var n in t)t.hasOwnProperty(n)&&l.mixin(t[n]);if(e.fn&&e.fn.call(l,p),f(u,l,k),c(!0),e.attrs&&U(e.attrs,,(e.attrs||m)&&f(l.root,l,k),l.parent&&!g||l.update(w),l.trigger("before-mount"),g&&!m)E=u.firstChild;else{for(;u.firstChild;)E.appendChild(u.firstChild);E.stub&&(E=d.root)}O(l,"root",E),g&&h(l.root,l.parent,null,!0),!l.parent||l.parent.isMounted?(l.isMounted=!0,l.trigger("mount")):l.parent.one("mount",}),O(this,"unmount",function(e){var t,n=E,r=n.parentNode,i=X.indexOf(l);if(l.trigger("before-unmount"),~i&&X.splice(i,1),r){if(d)t=F(d),B(t.tags[M])?v(t.tags[M],:t.tags[M]=o;else for(;n.firstChild;)n.removeChild(n.firstChild);e?(T(r,ie),T(r,re)):r.removeChild(n)}this._virts&&v(this._virts,,l.trigger("unmount"),c(),l.off("*"),l.isMounted=!1,delete E._tag}),h(u,this,x)}function g(e,t,n,r){n[e]=function(e){var o,a=r._parent,s=r._item;if(!s)for(;a&&!s;)s=a._item,a=a._parent;e=e||i.event,P(e,"currentTarget")&&(e.currentTarget=n),P(e,"target")&&(e.target=e.srcElement),P(e,"which")&&(e.which=e.charCode||e.keyCode),e.item=s,!0===t.call(r,e)||/radio|check/.test(n.type)||(e.preventDefault&&e.preventDefault(),e.returnValue=!1),e.preventUpdate||(o=s?F(a):r,o.update())}}unction y(e,t){v(e,function(e,n){var r=e.dom,i=e.attr,o=ge(e.expr,t),a=e.dom.parentNode;if(e.bool?o=!!o:null==o&&(o=""),e.value!==o){if(e.value=o,!i)return o+="",void(a&&("TEXTAREA"===a.tagName?(a.value=o,he||(r.nodeValue=o)):r.nodeValue=o));if("value"===i)return void(r.value=o);if(T(r,i),b(o))g(i,o,r,t);else if("if"==i){var s=e.stub,c=function(){m(r.parentNode,r,s)};o?s&&(!),r.inStub=!1,q(r)||z(r,):(s=e.stub=s||document.createTextNode(""),r.parentNode?c():(t.parent||t).one("updated",c),r.inStub=!0)}else"show"===i?r.style.display=o?"":"none":"hide"===i?r.style.display=o?"none":"":e.bool?(r[i]=o,o&&A(r,i,i),fe&&"selected"===i&&"OPTION"===r.tagName&&(r.__riot1374=o)):(0===o||o&&typeof o!==ae)&&(Z(i,ne)&&i!=re&&(i=i.slice(ne.length)),A(r,i,o))}})}function v(e,t){for(var n,r=e?e.length:0,i=0;i<r;i++)null!=(n=e[i])&&!1===t(n,i)&&i--;return e}unction w(e){if(e.outerHTML)return e.outerHTML;var t=H("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function k(e,t){if(typeof e.innerHTML!=se)e.innerHTML=t;else{var n=(new DOMParser).parseFromString(t,"application/xml");e.appendChild(e.ownerDocument.importNode(n.documentElement,!0))}} I(e,t,n){var r,i=e.parent;i&&(r=i.tags[t],B(r)?r.splice(n,0,r.splice(r.indexOf(e),1)[0]):C(e,t,i))}function R(e,t,n,r){var i=new d(e,t,n),o=N(t.root),a=F(r);return i.parent=a,i._parent=r,C(i,o,a),a!==r&&C(i,o,r),t.root.innerHTML="",i}nction N(e){var t=M(e),n=E(e,"name");return n&&!ge.hasExpr(n)?n:t?t.name:e.tagName.toLowerCase()}tion D(e){if(!(e instanceof d||e&&typeof e.trigger==ce))return e;var t={};for(var n in e)le.test(n)||(t[n]=e[n]);return t}unction U(e,t){for(var n,r=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;n=r.exec(e);)t(n[1].toLowerCase(),n[2]||n[3]||n[4])}nction W(e,t){return(t||document).querySelectorAll(e)}ction Q(e,t,n){var r,i=Y(e),o=i&&(ge.hasExpr(i)?t.one("mount",:o(t[i]))}unction $(e,t,n){var r=ee[t],i=e._innerHTML=e._innerHTML||e.innerHTML;return e.innerHTML="",r&&e&&(r=new d(r,{root:e,opts:n},i)),r&&r.mount&&(r.mount(),j(X,r)||X.push(r)),r}var J={version:"v2.4.1",settings:{}},K=0,X=[],ee={},te="__global_mixin",ne="riot-",re=ne+"tag",ie="data-is",oe="string",ae="object",se="undefined",ce="function",ue=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?|opt(?:ion|group))$/,le=/^(?:_(?:item|id|parent)|update|root|(?:un)?mount|mixin|is(?:Mounted|Loop)|tags|parent|opts|trigger|o(?:n|ff|ne))$/,pe=["altGlyph","animate","animateColor","circle","clipPath","defs","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","filter","font","foreignObject","g","glyph","glyphRef","image","line","linearGradient","marker","mask","missing-glyph","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","switch","symbol","text","textPath","tref","tspan","use"],he=0|(i&&i.document||{}).documentMode,fe=i&&!!i.InstallTrigger;J.observable=function(e){function t(e,t){for(var n,r,i=e.split(" "),o=i.length,a=0;a<o;a++)n=i[a],r=n.indexOf("."),n&&t(~r?n.substring(0,r):n,a,~r?n.slice(r+1):null)}e=e||{};var n={},r=Array.prototype.slice;return Object.defineProperties(e,{on:{value:function(r,i){return"function"!=typeof i?e:(t(r,function(e,t,r){(n[e]=n[e]||[]).push(i),i.typed=t>0,i.ns=r}),e)},enumerable:!1,writable:!1,configurable:!1},off:{value:function(r,i){return"*"!=r||i?t(r,function(e,t,r){if(i||r)for(var o,a=n[e],s=0;o=a&&a[s];++s)(o==i||r&&o.ns==r)&&a.splice(s--,1);else delete n[e]}):n={},e},enumerable:!1,writable:!1,configurable:!1},one:{value:function(t,n){eturn e.on(t,r)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(i){for(var o,a=arguments.length-1,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c+1];return t(i,function(t,i,a){o=r.call(n[t]||[],0);for(var c,u=0;c=o[u];++u)c.busy||(c.busy=1,a&&c.ns!=a||c.apply(e,c.typed?[t].concat(s):s),o[u]!==c&&u--,c.busy=0);n["*"]&&"*"!=t&&e.trigger.apply(e,["*",t].concat(s))}),e},enumerable:!1,writable:!1,configurable:!1}}),e},function(e){ction o(e){d=r(p,1),A[w](_,d),A[w](T,d),M[w](F,h),e&&p(!0)}nction c(e){return"string"==typeof e}nction p(e){var t=0==B;if(!(E<=B)&&(B++,j.push(,t)){for(;j.length;)j[0](),j.shift();B=0}}function h(e){if(!(1!=e.which||e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){for(var t=e.target;t&&"A"!=t.nodeName;)t=t.parentNode;!t||"A"!=t.nodeName||t[k]("download")||!t[k]("href")||t.target&&"_self"!=t.target||-1==t.href.indexOf(I.href.match(b)[0])||(t.href==I.href||t.href.split("#")[0]!=I.href.split("#")[0]&&("#"==g||0===u(t.href).indexOf(g))&&f(l(t.href),t.title||M.title))&&e.preventDefault()}}ar d,g,m,y,v,b=/^.+?\/\/+[^\/]+/,w="addEventListener",k="hasAttribute",x="replace",_="popstate",T="hashchange",S="trigger",E=3,A=void 0!==i&&i,M="undefined"!=typeof document&&document,C=A&&history,I=A&&(C.location||A.location),R=a.prototype,F=M&&M.ontouchstart?"touchstart":"click",O=!1,N=e.observable(),L=!1,j=[],B=0;R.m=R.s=R.e=function(e){this.$.concat("@").some(function(t){var n=("@"==t?y:v)(s(e),s(t));if(void 0!==n)return this[S].apply(null,[t].concat(n)),L=!0},this)},R.r=var P=new a,D=P.m.bind(P);D.create=D.base=D.exec=D.parser=D.query=function(){var e={};return(I.href||m)[x](/[?&](.+?)=([^&]*)/g,,e},D.stop=function(){O&&(A&&(A.removeEventListener(_,d),A.removeEventListener(T,d),M.removeEventListener(F,h)),N[S]("stop"),O=!1)},D.start=D.base(),D.parser(),e.route=D}(J);var de=function(e){nction r(e){if(e===f)return d;var t=e.split(" ");if(2!==t.length||/[\x00-\x1F<>a-zA-Z0-9'",;\\]/.test(e))throw new Error('Unsupported brackets "'+e+'"');return t=t.concat(e.replace(/(?=[[\]()*+?.^$|])/g,"\\").split(" ")),t[4]=n(t[1].length>1?/{[\S\s]*?}/:d[4],t),t[5]=n(e.length>3?/\\({|})/g:d[5],t),t[6]=n(d[6],t),t[7]=RegExp("\\\\("+t[3]+")|([[({])|("+t[3]+")|"+p,u),t[8]=e,t}nction a(e){var t;e=e||{},t=e.brackets,Object.defineProperty(e,"brackets",{set:o,get:function(){return g},enumerable:!0}),c=e,o(t)}var s,c,u="g",l=/"[^"\\]*(?:\\[\S\s][^"\\]*)*"|'[^'\\]*(?:\\[\S\s][^'\\]*)*'/g,p=l.source+"|"+/(?:\breturn\s+|(?:[$\w\)\]]|\+\+|--)\s*(\/)(?![*\/]))/.source+"|"+/\/(?=[^*\/])[^[\/\\]*(?:(?:\[(?:\\.|[^\]\\]*)*\]|\\.)[^[\/\\]*)*?(\/)[gim]*/.source,h={"(":RegExp("([()])|"+p,u),"[":RegExp("([[\\]])|"+p,u),"{":RegExp("([{}])|"+p,u)},f="{ }",d=["{","}","{","}",/{[^}]*}/,/\\([{}])/g,/\\({)|{/g,RegExp("\\\\(})|([[({])|(})|"+p,u),f,/^\s*{\^?\s*([$\w]+)(?:\s*,\s*(\S+))?\s+in\s+(\S.*)\s*}/,/(^|[^\\]){=[\S\s]*?}/],g=void 0,m=[];return i.split=function(e,t,n){||(n=m);var i,o,a,s,c=[],u=n[6];for(o=a=u.lastIndex=0;i=u.exec(e);){if(s=i.index,o){if(i[2]){u.lastIndex=function(e,t,n){var r,i=h[t];for(i.lastIndex=n,n=1;(r=i.exec(e))&&(!r[1]||(r[1]===t?++n:--n)););return n?e.length:i.lastIndex}(e,i[2],u.lastIndex);continue}if(!i[3])continue}i[1]||(r(e.slice(a,s)),a=u.lastIndex,u=n[6+(o^=1)],u.lastIndex=a)}return e&&a<e.length&&r(e.slice(a)),c},i.hasExpr=i.loopKeys=i.array=Object.defineProperty(i,"settings",{set:a,get:function(){return c}}),i.settings=void 0!==J&&J.settings||{},i.set=o,i.R_STRINGS=l,i.R_MLCOMMS=/\/\*[^*]*\*+(?:[^*\/][^*]*\*+)*\//g,i.S_QBLOCKS=p,i}(),ge=function(){function e(e,r){return e?(s[e]||(s[e]=n(e))).call(r,t):e}unction n(e){var t=r(e);return"try{return "!==t.slice(0,11)&&(t="return "+t),new Function("E",t+";")}function r(e){var t,n=[],r=de.split(e.replace(p,'"'),1);if(r.length>2||r[0]){var i,a,s=[];for(i=a=0;i<r.length;++i)(t=r[i])&&(t=1&i?o(t,1,n):'"'+t.replace(/\\/g,"\\\\").replace(/\r\n?|\n/g,"\\n").replace(/"/g,'\\"')+'"')&&(s[a++]=t);t=a<2?s[0]:"["+s.join(",")+'].join("")'}else t=o(r[1],0,n);return n[0]&&(t=t.replace(h,),t}function o(e,t,n){if(e=e.replace(l,.replace(/\s+/g," ").trim().replace(/\ ?([[\({},?\.:])\ ?/g,"$1")){for(var r,i=[],o=0;e&&(r=e.match(u))&&!r.index;){var s,p,h=/,|([[{(])|$/g;for(e=RegExp.rightContext,s=r[2]?n[r[2]].slice(1,-1).trim().replace(/\s+/g," "):r[1];p=(r=h.exec(e))[1];)!function(t,n){var r,i=1,o=f[t];for(o.lastIndex=n.lastIndex;r=o.exec(e);)if(r[0]===t)++i;else if(!--i)break;n.lastIndex=i?e.length:o.lastIndex}(p,h);p=e.slice(0,r.index),e=RegExp.rightContext,i[o++]=a(p,1,s)}e=o?o>1?"["+i.join(",")+'].join(" ").trim()':i[0]:a(e,t)}return e}ar s={};e.haveRaw=de.hasRaw,e.hasExpr=de.hasExpr,e.loopKeys=de.loopKeys,e.errorHandler=null;var c="⁗",u=/^(?:(-?[_A-Za-z\xA0-\xFF][-\w\xA0-\xFF]*)|\u2057(\d+)~):/,l=RegExp(de.S_QBLOCKS,"g"),p=/\u2057/g,h=/\u2057(\d+)~/g,f={"(":/[()]/g,"[":/[[\]]/g,"{":/[{}]/g},d='"in this?this:'+("object"!=typeof i?"global":"window")+").",g=/[,{][$\w]+:|(^ *|[^$\w\.])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\w]))([$_A-Za-z][$\w]*)/g,m=/^(?=(\.[$\w]+))\1(?:[^.[(]|$)/;return e.parse=function(e){return e},e.version=de.version="v2.4.0",e}(),me=function(){function e(e,r){var i=e&&e.match(/^\s*<([-\w]+)/),o=i&&i[1].toLowerCase(),a=H("div",x(o));return e=n(e,r),c.test(o)?a=t(a,e,o):k(a,e),a.stub=!0,a}function t(e,t,n){var r="o"===n[0],i=r?"select>":"table>";if(e.innerHTML="<"+i+t.trim()+"</"+i,i=e.firstChild,r)i.selectedIndex=-1;else{var o=s[n];o&&1===i.childElementCount&&(i=V(o,i))}return i}function n(e,t){if(!r.test(e))return e;var n={};return t=t&&t.replace(}).trim(),e.replace(}).replace(})}var r=/<yield\b/i,i=/<yield\s*(?:\/>|>([\S\s]*?)<\/yield\s*>|>)/gi,o=/<yield\s+to=['"]([^'">]*)['"]\s*>([\S\s]*?)<\/yield\s*>/gi,a=/<yield\s+from=['"]?([-\w]+)['"]?\s*(?:\/>|>([\S\s]*?)<\/yield\s*>)/gi,s={tr:"tbody",th:"tr",td:"tr",col:"colgroup"},c=he&&he<10?ue:/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?)$/;return e}(),y}(J),v}(i||{});J.util={brackets:de,tmpl:ge},J.mixin=function(){var e={},t=e[te]={},n=0;return function(r,i,o){if(_(r))return void J.mixin("__unnamed_"+n++,r,!0);var a=o?t:e;if(!i){if(typeof a[r]===se)throw new Error("Unregistered mixin: "+r);return a[r]}b(i)?(L(i.prototype,a[r]||{}),a[r]=i):a[r]=L(a[r]||{},i)}}(),J.ta},J.tag},J.mount=function(e,t,n){function r(e){var t="";return v(e,function(e){/[^-\w]/.test(e)||(e=e.trim().toLowerCase(),t+=",["+ie+'="'+e+'"],['+re+'="'+e+'"]')}),}function o(e){if(e.tagName){var r=E(e,ie)||E(e,re);t&&r!==t&&(r=t,A(e,ie,t),A(e,re,t));var i=$(e,r||e.tagName.toLowerCase(),n);i&&c.push(i)}else e.length&&v(e,o)}var a,s,c=[];if(ye.inject(),_(t)&&(n=t,t=0),typeof e===oe?("*"===e?e=s=i():e+=r(e.split(/, */)),a=e?W(e):[]):a=e,"*"===t){if(t=s||i(),a.tagName)a=W(t,a);else{var u=[];v(}),a=u}t=0}return o(a),c},J.updat},J.vdom=X,J.Tag=d,typeof t===ae?e.exports=J:"function"===ce&&typeof n(481)!==se?(r=function(){return J}.call(t,n,t,e))!==o&&(e.exports=r):i.riot=J}("undefined"!=typeof window?window:void 0)},function(e,t,n){"use strict";(function(e}function i(){return i=c()(a.a.mark(function t(n,r,i){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new e(function(e,t){n.trigger(r,c()(a.a.mark(function n(){var r,o,s,c,u=arguments;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(n.prev=0,r=u.length,o=new Array(r),s=0;s<r;s++)o[s]=u[s];return n.next=4,i(o);case 4:c=n.sent,e(c),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),t(n.t0);case 11:case"end":return n.stop()}},n,this,[[0,8]])})))}));case 1:case"end":return t.stop()}},t,this)})),i.apply(this,arguments)}n.d(t,"a",function(){return u}),t.b=r;var o=n(17),a=n.n(o),s=n(16),c=n.n(s),u={_stores:{},addStor},rese}};["on","one","off","trigger"].forEach(function(e){u[e]=c()(a.a.mark(function t(){var n,r=arguments;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=[].slice.call(r),t.abrupt("return",this._stores[n.shift()][e].apply(null,n));case 2:case"end":return t.stop()}},t,this)}))})}).call(t,n(11))},function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(1),c=n.n(s),u=n(100),l=n.n(u),p=n(9),h=n(177),f=n(28),d=new(function(){function e(){i()(this,e),c.a.observable(this),this._tenantId="",this._conversationId="",this._userId="",this._staticEndpoint="",this._apiEndpoint="",this._liveAgentEndpoint="",this._messageEndpoint="",this._mobile="",this._inputComponent="",this._envPrefix="",this._device="",this._version="",this._fullScreen=!1,this._additional=null,this._unreadMessagesCount=0,this._embedded=!1,this._chatLoading=!1,this._wallMessage="";var t=f.a.getDid();t||f.a.setDid(l()("".concat(navigator.userAgent).concat(+new Date).concat(Math.random()))),this._did=t||f.a.getDid(),this.on(h.a.setEnv,this._setEnv.bind(this)),this.on(h.a.iframeAdjust,this._iframeAdjust.bind(this)),this.on(h.a.setUnreadMessagesCount,this._setUnreadMessagesCount.bind(this)),this.on(h.a.setChatLoading,this._setChatLoading.bind(this)),this.on(h.a.setWallMessage,this._setWallMessage.bind(this));var n=f.a.get();if(n){var r=n.customer;r.id&&(this._userId=r.id),r.conversationId&&(this._conversationId=r.conversationId)}}return a()(e,[{key:"tenantId",get:function(){return this._tenantId}},{key:"conversationId",get:function(){return this._conversationId}},{key:"userId",get:function(){return this._userId}},{key:"staticEndpoint",get:function(){return this._staticEndpoint}},{key:"apiEndpoint",get:function(){return this._apiEndpoint}},{key:"liveAgentEndpoint",get:function(){return this._liveAgentEndpoint}},{key:"messageEndpoint",get:function(){return this._messageEndpoint}},{key:"mobile",get:function(){return this._mobile}},{key:"inputComponent",get:function(){return this._inputComponent}},{key:"envPrefix",get:function(){return this._envPrefix}},{key:"device",get:function(){return this._device}},{key:"version",get:function(){return this._version}},{key:"fullScreen",get:function(){return this._fullScreen}},{key:"unreadMessagesCount",get:function(){return this._unreadMessagesCount}},{key:"embedded",get:function(){return this._embedded}},{key:"chatLoading",get:function(){return this._chatLoading}},{key:"wallMessage",get:function(){return this._wallMessage}},{key:"did",get:function(){return this._did}},{key:"additional",ge}},{key:"customCSSEndpoint",ge}}]),a()(e,[{key:"_setEnv",value:function(e){var t=this,n=e(this);Object.keys(n).forEach(function(e){var r=n[e];t["_".concat(e)]=r})}},{key:"_iframeAdjust",value:function(e){p.a.trigger("Env",this.ActionTypes.iframeAdjust)}},{key:"_additionalPropertyCheck",value:function(e){if(!e)return null;return Object.keys(e).filter(function(t){return!(!e[t]||100<String(e[t]).length)||(console.warn("".concat(t,", 顧客データ(CRM)のパラメータは1文字以上す")),!1)}).reduce(function(t,n){return t[n]=String(e[n]),t},{})}},{key:"_setUnreadMessagesCount",value:function(e){this._unreadMessagesCount=e(this._unreadMessagesCount),p.a.trigger("Env",this.ActionTypes.setUnreadMessagesCount,this._unreadMessagesCount)}},{key:"_setChatLoading",value:function(e){var t=e(),n=t.flag;this._chatLoading=n,p.a.trigger("Env",this.ActionTypes.setChatLoading)}},{key:"_setWallMessage",value:function(e){var t=e(),n=t.message;this._wallMessage=n,p.a.trigger("Env",this.ActionTypes.setWallMessage)}}]),e}());d.ActionTypes={iframeAdjust:"env_store_iframeadjust",setUnreadMessagesCount:"env_store_setunreadmessagescount",setChatLoading:"env_store_setchatloading",setWallMessage:"env_store_setwallmessage"},p.a.addStore("Env",d),t.a=d},function(e,t,n){(function(t,r){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   4.0.typeof e&&null!=constructor===t)return e;var n=new t(h);return w(n,e),n}function h(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new Type){var t=this,n=new t(h);return _(n,e),n}function B(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operath(e){}if("[object Promise]"===n&&!t.cast)){return"[object Array]"===Objecd 0,G=function(e,t){K[H]=e,K[H+1]=t,2===(H+=2)&&(V?V(u):X())},Y="undefined"!=typeof window?window:void 0,Q=Y||{},Z=Q.MutationObserver||Q.WebKitMutationObserver,$="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),J="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"unoid n t..port1.onmesseturn W=e.runOnLoop||e.runOnContext,s()}catch(e){return c()}}():c();var ee=Math.random().toString(36).substring(16),te=void 0,n_input,n=0;this._state=function(t){return t(e)n):this._result[t]=n),0===settledAt(ne,t,e)},function(e){return n._settledAt(re,t,e)})},D.all=N,D.race=L,D.resolve=p,D.reject=j,D._setScheduler=o,Dstructor:D,then:l,catch:function(e){return this.then(ne.exports=function(e){return s(e){n(c,t,o,a,s,"throw",e)}var c=e.apply(r,i);a(void 0)})}}e,&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r,i,o=n(379),a=n.n(o),s=n(2),c=n.n(s),u=n(3),l=n.n(u),p=n(172),h=n.n(p),f=(n(9),n(178)),d=n(131),g=n(435),m=n(27),y=n(427),v=n.i(m.a)((i=function(){function e(){c()(this,e)}return l()(e,[{key:"setup",value:function(e,t){n.i(g.a)(),rg4js("apiKey","EYhM0bnqeWZ+KM4jf0km7w=="),rg4js("enableCrashReporting",!0),rg4js("options",{excludedHostnames:["localhost","127.0.0.1"]}),e=e||new Object({customer:{}});var r=e.customer.id||null,i=e.customer.conversationId||null;this.pushTag(this.widgetNotMountedKey),this.pushTag(this.widgetNotOpenedKey),this.setTenant(t),r?(rg4js("setUser",{identifier:r,isAnonymous:!1}),this.setUser(r)):this.pushTag(this.userNotCreatedKey),i?this.setConversation(i):this.pushTag(this.conversationNotCreated)}},{key:"sendError",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.pushTag(this.widgetExplicitFlag),d.a.trigger(f.a.sendError,function(){rg4js("send",{error:e,customData:r}),t.removeTag(t.widgetExplicitFlag,!0)})}},{key:"setUser",value:function(e){var t=this;d.a.trigger(f.a.setUser,function(){return rg4js("setUser",{identifier:e,isAnonymous:!1}),t.pushTag("userId:".concat(e)),e})}},{key:"setConversation",value:function(e){var t=this;d.a.trigger(f.a.setConversation,function(n){return rg4js("withCustomData",{conversationId:e,tenantId:n}),t.pushTag("conversationId:".concat(e)),e})}},{key:"setTenant",value:function(e){var t=this;d.a.trigger(f.a.setTenant,function(n){return rg4js("withCustomData",{conversationId:n,tenantId:e}),t.pushTag("tenantId:".concat(e)),e})}},{key:"pushTag",value:function(e){d.a.trigger(f.a.pushTag,function(t,n){var r="".concat(+new Date);return t.push("".concat(e,"@").concat(r)),n[r]=e,rg4js("withTags",t),{tags:t,logs:n}})}},{key:"removeTag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];d.a.trigger(f.a.removeTag,function(n){return n.some(function(r,i){if(t){new RegExp(e).test(r)&&n.splice(i,1)}else r===e&&n.splice(i,1)}),n})}},{key:"pushReceivedMessageId",value:function(e){d.a.trigger(f.a.pushReceivedMessageId,function(t){return a()(t).concat([e])})}},{key:"setPushReceivedMessageIdsFlag",value:function(e){d.a.trigger(f.a.setPushReceivedMessageIdsFlag,function(t){return e})}},{key:"pushWidgetOpened",value:function(){this.pushTag(this.widgetOpened)}},{key:"pushWidgetClosed",value:function(){this.pushTag(this.widgetClosed)}},{key:"pushSentMessage",value:function(e){this.pushTag("".concat(this.widgetSentMsg,":").concat(e))}},{key:"pushRepliedQuickReplies",value:function(e){var t=e.title,n=e.path;this.pushTag("".concat(this.widgetRepliedQuickReplies,":").concat(t," (").concat(n,")"))}},{key:"pushWidgetMounted",value:function(){this.pushTag(this.widgetMounted)}},{key:"pushConversationClosed",value:function(){this.pushTag(this.widgetConversationClosed)}},{key:"pushConversationReseted",value:function(e){this.pushTag("".concat(this.widgetConversationReseted,"-").concat(e))}},{key:"pushSentMissedMessage",value:function(){this.pushTag(this.widgetSentMissedMsg)}},{key:"pushRequestError",value:function(e,t){var n=this.widgetRequestError.replace(/CAUSE/,e).replace(/RESPONCE/,t);this.pushTag(n)}},{key:"pushSendMessagesFromAiMessenger",value:function(){this.pushTag(this.widgetSendMessagesFromAiMessenger)}},{key:"pushSendButtonTriggered",value:function(){this.pushTag(this.widgetSendButtonTriggered)}},{key:"pushShiftedEnterKeyTriggeredFromInputField",value:function(){this.pushTag(this.widgetShiftedEnterKeyTriggeredFromInputField)}},{key:"pushSendButtonTriggeredFromSPInput",value:function(){this.pushTag(this.widgetSendButtonTriggeredFromSPInput)}},{key:"pushSubmitErrorResend",value:function(){this.pushTag(this.,value:function(){this.pushTag(this.widgetSubmitErrorRemove)}},{key:"erasePushedLogs",value:function(){d.a.trigger(f.a.erasePushedLogs,function(e){return{}})}},{key:"erasePushedReceivedMessageIds",vigger(f.a.erasePushedReceivedMessageIds,function(e){return[]})}},{key:"widgetNotMountedKey",get:function(){return"widget-not-mounted"}},{key:"widgetNotOpenedKey",get:function(){return"widget-not-opened"}},{key:"userNotCreatedKey",get:function(){return"user-not-created"}},{key:"conversationNotCreated",get:function(){return"conversation-not-created"}},{key:"widgetMounted",get:function(){return"widget-mounted"}},{key:"widgetOpened",get:function(){return"widget-opened"}},{key:"widgetClosed",get:function(){return"widget-closed"}},{key:"widgetSentMsg",get:function(){return"widget-sent-msg"}},{key:"widgetRepliedQuickReplies",get:function(){return"widget-replied-quickreplies"}},{key:"widgetConversationClosed",get:function(){return"widget-conversation-closed"}},{key:"widgetConversationReseted",get:function(){return"widget-conversation-reseted"}},{key:"widgetSentMissedMsg",get:function(){return"widget-sent-missed-msg"}},{key:"widgetRequestError",get:function(){return"widget-request-error[CAUSE_RESPONCE]"}},{key:"widgetSendMessagesFromAiMessenger",get:function(){return"widget-sent-msg-from-AIMessenger"}},{key:"widgetSendButtonTriggered",get:function(){return"widget-send-button-triggered"}},{key:"widgetShiftedEnterKeyTriggeredFromInputField",get:function(){return"widget-shifted-enterkey-triggered-from-inputfield"}},{key:"widgetSendButtonTriggeredFromSPInput",get:function(){return"widget-send-button-triggered-from-spinput"}},{key:"widgetSubmitErrorResend",get:function(){return"widget-submit-error-resend"}},{key:"widgetSubmitErrorRemove",get:function(){return"widget-submit-error-remove"}},{key:"widgetExplicitFlag",get:function(){return"widget_explicit_flag"}}]),e}(),h()(i.prototype,"sendError",[y.a],Object.getOwnPropertyDescriptor(i.prototype,"sendError"),i.prototype),r=i))||r},function(e,t,n){"use stricteProperty(e,"instance",{get:function(){return t||(t=new e),t}})}t.a=r},function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(59),c=n(46),u=n(56),l="__aim_web__".concat(u.a.tenantId),p="__aim_web_".concat(u.b),h=null,f=function(){function e(){i()(this,e)}return a()(e,null,[{key:"set",value:function(e){c.a.setItem(p,e),h=null}},{key:"get",value:function(e){if(h)return h;if(!c.a.hasItem(p)){var t=s.a.getItem(l)||s.a.getItem("__swallow-web__")||s.a.getItem("__aim_web__");if(t)return c.a.setItem(p,t),s.a.removeItem(l),s.a.removeItem("__swallow-web__"),s.a.removeItem("__aim_web__"),h=this._checkTenantId(JSON.parse(t))}return c.a.getItem(p)?h=this._checkTenantId(JSON.parse(c.a.getItem(p))):e}},{key:"remove",value:function(){s.a.removeItem(l),s.a.removeItem("__swallow-web__"),s.a.removeItem("__aim_web__"),c.a.removeItem(p)}},{key:"setTenantId",value:function(e){var t=this.get();t?(t.customer.tenantId=e,this.set(t)):this.set({customer:{tenantId:e}})}},{key:"setConversationId",value:function(e){var t=this.get();t?(t.customer.conversationId=e,this.set(t)):this.set({customer:{conversationId:e}})}},{key:"setAdditional",value:function(e){var t=e?btoa(encodeURIComponent(JSON.stringify(e))):null,n=this.get();return n?n.customer.additional===t?{isChange:!1}:(n.customer.additional=t,t(){var e=this.get();return e&&e.customer?e.customer.did:null}},{key:"setDid",value:function(e){var t=this.get();if(t&&t.customer){if(t.customer.did)return;t.customer.did=e,this.set(t)}else this.set({customer:{did:e}})}},{key:"removeConversationId",value:function(){var e=this.get();delete e.customer.conversationId,this.set(e)}},{key:"_checkTenantId",value:function(e){return e&&e.customer&&e.customer.tenantId!=window.parent.swallow_widget_initial_configs.tenantId&&(e.customer.tenantId=window.parent.swae],a={};a[e]=t(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},function(e,t,n){"use strict";var r=n(92),i=n.n(r),o=n(2),a=n.n(o),s=n(3),c=n.n(s),u=n(1),l=n.n(u),p=n(9),h=n(181),f=n(130),d=(n(28),new(function(){function e(){a()(this,e),l.a.observable(this),this._assignee="bot",this._errors=[],this._messages={},this._lastMessage=null,this._delayedQueue=[],this._delayed=!1,this._initialMessage=!0,this._dummyMessages=[],this._updateStoper=null,this._typingEnable=!0,this._typingStartTimerId=null,this._typingEndTimerIds=[],this._skippedFirstMessage=!1,this._boundConversation=!1,this._catchWelcomeMessage=!1,this._missedMessage=null,this._typingActors=[],this._nonCustomerMessagesCount=0,this._isEmbeddedConversationTriggered=!1,this._talksMounted=!1,this._messagesQueue=[],this._messageTimerIds={},this._conversationReady=!1,this._conversationCount=0,this._welcomeMessages=window.swallow_welcome_message_config||{attachments:[{mediaType:"plainText",payload:"・・・"}]},this._yconnectAuthUrl="",this.on(h.a.setYconnectAuthUrl,this._setYconnectAuthUrl.bind(this)),this.on(h.a.unboundStream,this._unboundStream.bind(this)),this.on(h.a.incrementConversationCount,this._incrementConversationCount.bind(this)),this.on(h.a.getWelcomeMessages,this._getWelcomeMessages.bind(this)),this.on(h.a.pushError,this._pushError.bind(this)),this.on(h.a.resetError,this._resetError.bind(this)),this.on(h.a.pushDelayedQueue,this._pushDelayedQueue.bind(this)),this.on(h.a.consumeDelayedQueue,this._consumeDelayedQueue.bind(this)),this.on(h.a.pushMessage,this._pushMessage.bind(this)),this.on(h.a.pushNewMessage,this._pushNewMessage.bind(this)),this.on(h.a.pushWelcomeMessage,this._pushWelcomeMessage.bind(this)),this.on(h.a.pushTyping,this._pushTyping.bind(this)),this.on(h.a.setTypingEnable,this._setTypingEnable.bind(this)),this.on(h.a.setTypingActors,this._setTypingActors.bind(this)),this.on(h.a.removeMessage,this._removeMessage.bind(this)),this.on(h.a.removeNewMessage,this._removeNewMessage.bind(this)),this.on(h.a.removeTyping,this._removeTyping.bind(this)),this.on(h.a.removeAllMessages,this._removeAllMessages.bind(this)),this.on(h.a.setTypingStartTimer,this._setTypingStartTimer.bind(this)),this.on(h.a.clearTypingStartTimer,this._clearTypingStartTimer.bind(this)),this.on(h.a.setTypingEndTimer,this._setTypingEndTimer.bind(this)),this.on(h.a.clearAllTypingEndTimer,this._clearAllTypingEndTimer.bind(this)),this.on(h.a.unsetTypingActor,this._unsetTypingActor.bind(this)),this.on(h.a.update,this._update.bind(this)),this.on(h.a.scrollDown,this._scrollDown.bind(this)),this.on(h.a.moveDown,this._moveDown.bind(this)),this.on(h.a.addErrorFlag,this._addErrorFlag.bind(this)),this.on(h.a.conversationReset,this._conversationReset.bind(this)),this.on(h.a.quickRepliyHandler,this._quickRepliyHandler.bind(this)),this.on(h.a.adjustFirstChildBottomMargin,this._adjustFirstChildBottomMargin.bind(this)),this.on(h.a.setSkippedFirstMessage,this._setSkippedFirstMessage.bind(this)),this.on(h.a.setBoundConversation,this._setBoundConversation.bind(this)),this.on(h.a.setCatchWelcomeMessage,this._setCatchWelcomeMessage.bind(this)),this.on(h.a.checkReadMessages,this._checkReadMessages.bind(this)),this.on(h.a.setNonCustomerMessagesCount,this._setNonCustomerMessagesCount.bind(this)),this.on(h.a.startEmbeddedConversation,this._startEmbeddedConversation.bind(this)),this.on(h.a.sendMessagesFromAiMessenger,this._sendMessagesFromAiMessenger.bind(this)),this.on(h.a.setTalksMountedFlag,this._setTalksMountedFlag.bind(this)),this.on(h.a.waitingTalksDom,this._waitingTalksDom.bind(this)),this.on(h.a.postSubmitErrorMessages,this._postSubmitErrorMessages.bind(this)),this.on(h.a.setMessageTimer,this._setMessageTimer.bind(this)),this.on(h.a.clearMessageTimer,this._clearMessageTimer.bind(this)),this.on(h.a.setConversationReady,this._setConversationReady.bind(this)),this.on(h.a.changeAssigneeStatus,this._changeAssigneeStatus.bind(this))}return c()(e,[{key:"messages",get:function(){return this._messages}},{key:"isLastMessageFromCustomer",get:function(){return this._lastMessage.sender&&"customer"===this._lastMessage.sender.senderType}},{key:"isLastMessageTyping",get:function(){return this._lastMessage.attachment&&"typing"===this._ge.attachment&&"yconnect"===this._lastMessage.attachment.mediaType}},{key:"isLastMessageImageUplodable",get:function(){return!!this._lastMessage.meta&&!!this._lastMessathis._lastMessage.meta&&!!this._lastMessage.meta.isMarkdownEnabled}},{key:"isLastMessageCarousel",get:function(){return!!this._lastMessage.attachment&&"carousel"===this._lastMessage.attachment.mediaType}},{key:"conversationCount",get:function(){return this._conversationCount}},{key:"dummyMessages",get:function(){return this._dummyMessages}},{key:"newMessages",get:function(){return this._messages.new}},{key:"typingEnable",get:function(){return this._typingEnable}},{key:"skippedFirstMessage",get:function(){return this._skippedFirstMessage}},{key:"boundConversation",get:function(){return this._boundConversation}},{key:"catchWelcomeMessage",get:function(){return this._catchWelcomeMessage}},{key:"missedMessage","typingActors",get:function(){return this._typingActors.join(", ")}},{key:"nonCustomerMessagesCount",get:function(){return this._nonCustomerMessagesCount}},{key:"isEmbeddedConversationTriggered",get:function(){return this._isEmbeddedConversationTriggered}},{key:"conversationReady",get:function(){return this._conversationReady}},{keyeturn this._initialMessage},set:function(e){this._initialMessage=e}},{key:"s._delayed}},{key:"delayed",set:function(e){return this._delayed=e}},{key:"delayedQueue",get:function(){return this._delayedQueue}},{key:"erro{key:"isAssignedToBot",get:function(){return"bot"===this._assignee}}]),c()(e,[{key:"_unboundStream",value:function(){p.a.trigger("Talks",this.ActionTypes.unboundStream)}},{key:"_incrementConversationCount",value:function(e){this._conversationCount=e(this._conversationCount)}},{key:"_changeAssigneeStatus",value:function(e){this._assignee=e(this._assignee),p.a.trigger("Talks",this.ActionTypes.notifyAssigneeChanged,this._assignee)}},{key:"_pushError",value:function(e){this._errors=e(this._errors),p.a.trigger("Talks",this.ActionTypes.pushError,this._errors)}},{key:"_getWelcomeMessages",vameMessages)}},{key:"_resetError""_pushDelayedQueue",value:function(e){this._delayedQueue.push(e())}},{key:"_consumeDelayedQueue",value:function(e){var t=this._delayedQueue.shift();t&&e(t),this._delayedQueue.length||(this._delayed=!1)}},{key:"_pushMessage",value:function(e){var t=e(this._messages),n=t.message,r=t.messages,i=t.willUpdate,o=t.delay,a=void 0!==o&&o;this._toggleInput(n),a||(this._updateMessages(r),p.a.trigger("Talks",this.ActionTypes.pushMessage,{willUpdate:i,message:n}))}},{key:"_pushWelcomeMessage",value:function(e){var t=e(this._messages),n=i()(t,2),r=n[0],o=n[1];this._updateMessages(r),this._toggleInput({body:o}),p.a.trigger("Talks",this.ActionTypes.pushNewMessage)}},{key:"_pushNewMessage",value:function(e){var t=e(this._messages,this._dummyMessages),n=t.messages,r=t.dummyMessages;this._updateMessages(n),this._dummyMessages=r,p.a.trigger("Talks",this.ActionTypes.pushNewMessage)}},{key:"_pushTyping",value:function(e){this._updateMessages(e(this._messages)),p.a.trigger("Talks",this.ActionTypes.pushTyping)}},{key:"_setTypingEnable",value:function(e){this._typingEnable=e(this._typingEnable)}},{key:"_setTypingActors",value:function(e){this._typingActors=e(this._typingActors),p.a.trigger("Talks",this.ActionTypes.setTypingActors)}},{key:"_unsetTypingActor",value:function(e){this._typingActors=e(this._typingActors),p.a.trigger("Talks",this.ActionTypes.setTypingActors)}},{key:"_unsetTypingActor",value:function(e){this._typingActors=e(this._typingActors),p.a.trigger("Talks",this.ActionTypes.setTypingActors)}},{key:"_removeMessage",value:function(e){this._updateMessages(e(this._messages)),p.a.trigger("Talks",this.ActionTypes.removeMessage)}},{key:"_removeNewMessage",value:function(e){var t=e(this._messages,this._dummyMessages),n=t.messages,r=t.dummyMessages;this._updateMessages(n),this._dummyMessages=r,p.a.trigger("Talks",this.ActionTypes.removeNewMessage)}},{key:"_removeTyping",value:function(e){this._updateMessages(e(this._messages)),p.a.trigger("Talks",this.ActionTypes.removeTyping)}},{key:"_removeAllMessages",value:function(e){this._updateMessages(e(this._messages)),p.a.trigger("Talks",this.ActionTypes.removeAllMessages)}},{key:"_setTypingStartTimer",value:function(e){this._typingStartTimerId=e(this._typingStartTimerId)}},{key:"_clearTypingStartTimer",value:function(e){e(this._typingStartTimerId)}},{key:"_setTypingEndTimer",value:function(e){this._typingEndTimerIds=e(this._typingEndTimerIds)}},{key:"_clearAllTypingEndTimer",value:function(e){this._typingEndTimerIds=e(this._typingEndTimerIds)}},{key:"_update",value:function(e){var t=this;this._updateStoper||(this._updateStoper=setTimeout(function(){t._updateStoper=null,p.a.trigger("Talks",t.ActionTypes.update)},100))}},{key:"_scrollDown",value:function(){p.a.trn",value:function(){p.a.trigger("Talks",this.ActionTypes.moveDown)}},{key:"_addErrorFlag",value:function(e){this._updateMessages(e(this._messages,this._dummyMessages)),p.a.trigger("Talks",this.ActionTypes.addErrorFlag)}},{key:"_conversationReset",value:function(e,t){p.a.trigger("Talks",this.ActionTypes.conversationReset,e,t)}},{key:"_quickRepliyHandler",value:function(e){e(this._messages)}},{key:"_adjustFirstChildBottomMargin",value:function(e){e(),p.a.trigger("Talks",this.ActionTypes.adjustFirstChildBottomMargin)}},{key:"_setSkippedFirstMessage",value:function(e){this._skippedFirstMessage=e(!0)}},{key:"_setBoundConversation",value:function(e){this._boundConversation=e(this._boundConversation)}},{key:"_setCatchWelcomeMessage",value:function(e){this._catchWelcomeMessage=e(this._catchWelcomeMessage)}},{key:"_checkReadMessages",value:function(e){this._nonCustomerMessagesCount=e(this._nonCustomerMessagesCount)}},{key:"_setNonCustomerMessagesCount",value:function(e){this._nonCustomerMessagesCount=e(this._nonCustomerMessagesCount)}},{key:"_startEmbeddedConversation",value:function(e){e(this._isEmbeddedConversationTriggered)&&p.a.trigger("Talks",this.ActionTypes.isEmbeddedConversationTriggered),this._isEmbeddedConversationTriggered=!0}},{key:"_sendMessagesFromAiMessenger",value:function(e){var t=e();this._talksMounted?p.a.trigger("Talks",this.ActionTypes.sendMessagesFromAiMessenger,t):this._messagesQueue.push(t)}},{key:"_setTalksMountedFlag",value:function(e){this._talksMounted=e(this._talksMounted)}},{key:"_waitin){p.a.trigger("Talks",t.ActionTypes.sendMessagesFromAiMessenger,e)})}},{key:"_postSubmitErrorMessages",value:function(e){var t=e(this._messages),n=t.sendMessages,r=t.messages;this._updateMessages(r),p.a.trigger("Talks",this.ActionTypes.postSubmitErrorMessages,n)}},{key:"_setMessageTimer",value:function(e){this._messageey:"_clearMessageTimer",value:function(e){e(this._messageTimerIds)}},{key:"_setConversationReady",value:function(e){this._conversationReady=e(this._conversationReady)}},{key:"_setYconnectAuthUrl",value:function(e){this._yconnectAuthUrl=e(this._yconnectAuthUrl),p.a.trigger("Talks",this.ActionTypes.setYconnectAuthUrl,this._yconnectAuthUrl)}},{key:"_updateMessages",value:function(e){this._messages=e;var t=Object.keys(e),n=t.sort(),r=n[n.length-1]===f.a.TYPING?n[n.length-2]:n[n.length-1],i=e[r];this._lastMessage=i,this._messages=e}},{key:"_toggleInput",value:function(e){e&&e.body&&p.a.trigger("Talks",this.ActionTypes.toggleInput,(e.body.meta||{textInput:null}).textInput)}}]),e}()));d.ActionTypes={notifyAssigneeChanged:"talks_store_notify_assignee_changed",resetError:"talks_store_reseterror",pushError:"talks_store_pusherror",pushMessage:"talks_store_pushmessage",pushWelcomeMessage:"talks_store_pushwelcomemessage",pushNewMessage:"talks_store_pushnewmessage",pushTyping:"talks_store_pushtyping",removeMessage:"talks_store_removemessage",removeNewMessage:"talks_store_removenewmessage",removeTyping:"talks_store_removetyping",setTypingActors:"talks_store_settypingactors",removeAllMessages:"talks_store_removeallmessages",update:"talks_store_update",scrollDown:"talks_store_scrolldown",moveDown:"talks_store_movedown",addErrorFlag:"talks_store_adderrorflag",conversationReset:"talks_store_conversationreset",adjustFirstChildBottomMargin:"talks_store_adjustfirstchildbottommargin",isEmbeddedConversationTriggered:"talks_store_isembeddedconversationtriggered",sendMessagesFromAiMessenger:"talks_store_sendMessagesFromAiMessenger",waitingTalksDom:"talks_store_waitingtalksdom",postSubmitErrorMessages:"talks_store_postsubmiterrormessages",startConversationDelegate:"talks_store_startconversationdelegate",unboundStream:"talks_store_unboundStream",toggleInput:"talks_store_toggleInput",setYconnectAuthUrl:"talks_store_set_yconnect_auth_url"},p.a.addStore("Talks",d),t.a=d},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return O});var r,i=n(92),o=n.n(i),a=n(17),s=n.n(a),c=n(79),u=n.n(c),l=n(16),p=n.n(l),h=n(2),f=n.n(h),d=n(3),g=n.n(d),m=n(9),y=n(181),v=n(32),b=n(72),w=n(93),k=n(26),x=n(73),_=(n(69),n(28)),T=n(133),S=n(27),E=n(75),A=n(438),M=(n(185),n(130)),C=new b.a,I=new w.a,R=new k.a,F=E.a.instance,O=n.i(S.a)(r=function(){function t(){f()(this,t)}return g()(t,[{key:"pushMessage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreDelay:!1};this.adjustFirstChildBottomMargin(),this.checkReadMessages(e),v.a.trigger(y.a.pushMessage,function(r){var i=(r[M.a.TYPING],!0),o=t.processDelayedMessage(e,e.val(),n),a=o&&o.meta&&o.meta.isWelcomeMessage;return o?("customer"===e.key||a&&!v.a.catchWelcomeMessage?i=!1:(t.setCatchWelcomeMessage(!1),r[e.key]=o,o.key=e.key,t.removeNewMessage(o),r[M.a.NEW]&&delete r[M.a.NEW],r[M.a.TYPING]&&"customer"!==r[e.key].sender.senderType&&(t.clearTypingStartTimer(),delete r[M.a.TYPING])),{message:{key:e.key,body:o},messages:r,willUpdate:i}):{message:null,messages:r,willUpdate:i,delay:!0}})}},{key:"notifyChangeAssigneeStatus",value:function(e){v.a.trigger(y.a.changeAssigneeStatus,function(t){return e})}},{key:"pushWelcomeMessage",value:function(e,t){v.a.trigger(y.a.pushWelcomeMessage,function(n){return n["".concat(v.a.conversationCount,"_").concat(M.a.WELCOME_MSG,"_").concat(t)]=e,[n,e]})}},{key:"pushAllWelcomeMessage",value:function(t){var r=this;return new e(function(i){v.a.trigger(y.a.getWelcomeMessages,function(){var i=p()(s.a.mark(function i(o){return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(o.attachments){i.next=4;break}if(o.attachment){i.next=3;break}return i.abrupt("return");case 3:o.attachments=[o.attachment];case 4:return t&&(o.attachments[0].payload.text?o.attachments[0].payload.text+="\n".concat(t):o.attachments[0].payload+="\n".concat(t)),i.next=7,o.attachments.reduce(function(){var e=p()(s.a.mark(function e(t,i,a){var c,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return e.next=4,r.processDelayedWelcomeMessage(i);case 4:c=e.sent,l=n.i(x.d)(c,"bot"),l.meta=u()({},l.meta,o.meta),r.pushWelco},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}(),e.resolve(null));case 7:case"end":return i.stop()}},i,this)}));return function(e){return i.apply(this,arguments)}}()),i()})}},{key:"pushNewMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M.a.NEW;v.a.trigger(y.a.pushNewMessage,function(n,r){var i=A.a.encode("".concat(JSON.stringify(e.attachment)).concat(+new Date));return F.add(e,i),e.sign=i,r.push(e),r.forEach(function(e,r){n["".concat(t===M.a.NEW?t:"".concat(v.a.conversationCount,"_").concat(t),"_").concat(r)]=e}),{messages:n,dummyMessages:r}})}},{key:"unboundStream",value:function(){v.a.trigger(y.a.unboundStream,function(){})}},{key:"incrementConversatio{v.a.trigger(y.a.incrementConversationCount,function(e){return e+1})}},{key:"pushError",valuy.a.pushError,function(t){return t.filter}},{key:"resetError",value:function(e){v.a.trigger(y.a.resetError)}},{key:"processDelayedMessage",value:function(e,t,r){var i=this,o=r.ignoreDelay,a=t.attachment;if(!a)return t;if(!o&&v.a.isDelayed)return"typing"===a.mediaType?t:(v.a.trigger(y.a.pushDelayedQueue,funtion(){return{attachment:s.attachment,meta:t.meta,sender:t.sender}},key:e.key};return v.a.isInitialMessage?u.val():(v.a.isDela("bot"),0),setTimeout(function(){i.pushMessage(u,{ignoreDelay:!0})},c),null)}return t}},{key:"processDelayedWelcomeMessage",vaay?new e(function(e){setTimeout(function(){e(t.payload.attachment)},t.payload.delay)}):e.resolve(t)}},{key:"consumeDelayQueue",value:function(){var e=this;r.consumeDelayedQueue,function(t){e.pushMessage(t,{ignoreDelay:!0})})})}},{key:"removeNewMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M.a.NEW,n=e.meta,r=void 0===n?{}:n,i=r.clientOriginMessageId;v.a.trigger(y.a.removeNewMessage,function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=-1;return i?(r.every(function(e,t){var n=e.meta;return(void 0===n?{}:n).clientOriginMessageId!==i||(o=t,!1)}),v.a.isInitialMessage):o=r.map(function(e){return"quickReplyPostback"===e.attachment.mediaType&&(e.attachment.mediaType="plainText",e.attachment.payload=e.attachment.payload.text),JSON.stringify(e.attachment)}).indexOf(JSON.stringify(e.attachment)),0<=o&&(delete n["".concat(t===M.a.NEW?t:"".concat(v.a.conversationCount,"_").concat(t),"_").concat(o)],delete r[o]),{messages:n,dummyMessages:r}})}},{key:"pushTyping",value:function(e,t){var n=setTimeout(function(){v.a.trigger(y.a.pushTyping,function(t){return t[M.a.TYPING]=e,t})},t);this.setTypingStartTimer(n)}},{key:"removeTyping",value:function(){this.clearAllTypingEndTimer(),v.a.trigger(y.a.removeTyping,function(e){return e&&e[M.a.TYPING]&&delete e[M.a.TYPING],e})}},{key:"setTypingActors",value:function(e){v.a.trigger(y.a.setTypingActors,function(){return e})}},{key:"setTypingEnable",value:function(e){v.a.trigger(y.a.setTypingEnable,function(){return e})}},{v.a.trigger(y.a.removeMessage,function(t){return delete t[e.key],t})}},{key:"re:function(){v.a.trigger(y.a.removeAllMessages,function(e){return{}})}},{key:"setTypingStartTimer",value:function(e){v.a.trigger(y.a.setTypingStartTimer,function(){return e})}},{key:"clearTypin{v.a.trigger(y.a.clearTypingStartTimer,function(e){clearTimeout(e)})}},{key:"setTypingEndTimer",value:function(e,t){var n=this;this.clearAllTypingEndTimer(),v.a.trigger(y.a.setT(new Date).getTime(),o=setTimeout(function(){n.unsetTypingActor(e)},i);return r.push(o),r})}},{key:"clearAllTypingEndTimer",value:function(){er,function(e){return e.forEach(function(e){return clearTimeout(e)}),[]})}},{key:"unsetTypingActor",value:funActor,function(t){return t.some(function(n,r){n===e&&t.splice(r,1)}),t})}},{key:"update",value:function(){v.a.trigger(y.a.update)}},{key:"scrollDown",value:function(){v.a.trigger(y.a.scrollDown)}},{key:"moveDown",value:function(){v.a.trigger(y.a.moveDown)}},{key:"addErrorFlag",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?argumentn(r,i){var o=i.map(function(e){return JSON.stringify(e.attachment)}).indexOf(JSON.stringify(e.attachment));if(0<=o){var a="".concat(n===M.a.NEW?M.a.NEW:"".concat(v.a.conversationCount,"_").concat(n),"_").concat(o);r[a]&&(r[a].submitError=!0,t.removeTyping(),t.clearTypingStartTimer())}return r})}},{key:"conversationReset",value:function(t){var n=this,r=t.key,i=t.retryHash;return new e(function(e,t){n.setBoundConversation(!1);var o=_.a.get();delete o.customer.conversationId,_.a.set(o),R.pushConversationReseted(r),I.setEnv({conversationId:""})esCount(0),v.a.trigger(y.a.conversationReset,function(){return e()},i)})}},{key:"quickRepliyHandler",value:function(e){v.a.trigger(y.a.quickRepliyHandler,function(t){e.root.style.marginBottom="";var n=Object.keys(t).sort(),r=t[n[n.length-1]];r.attachment&&"quickReplies"==r.attachment.mediaType&&C.implement()})}},{key:"adjustFirstChildBottomMargin",value:function(){v.a.trigger(y.a.adjustFirstChildBottomMargin,function(){})}},{key:"setBoundConversation",value:function(e){v.a.trigger(y.a.setBoundConversation,function(){return e})}},{key:"setCatchWelcomeMessage",value:function(e){v.a.trigger(y.a.setCatchWelcomeMessage,function(){return e})}},{key:"checkReadMessages",value:function(e){var t=e.val();if(!("customer"===e.key||t.sender&&"customer"===t.sender.senderType)){var n=T.a.get(),r=n.open,i=T.a.getUnreeads(i)),v.a.trigger(y.a.checkReadMessages,function(e){return e+=1}),this.countReadMessages()}}},{key:"countReadMessages",value:function(){var e=T.a.getUnreads();if(e){var t=v.a.nonCustomerMessagesges",value:function(){T.a.setUnreads(v.a.nonCustomerMessagesCount)}},{key:"setNonCustomerMessagesCount",value:function(e){v.a.trigger(y.a.checkReadMessages,function(t){return e})}},{key:"startEmbeddedConven(){v.a.trigger(y.a.startEmbeddedConversation,function(e){return!e})}},{key:"sendMessagesFromAiMessenger",value:function(){var e=window.parent.aiMessenger._messagesQueue;e.length<=0||v.a.trigger(y.a.sendMessagesFromAiMessenger,function(){return e})}},{key:"setTalksMountedFlag",value:function(e){v.a.trigger(y.a.setTaom",value:function(){v.a.trigger(y.a.waitingTalksDom,function(){})}},{key:"postSubmitErrorMessages",value:function(e,t){v.a.trigger(y.a.postSubmitErrorMessages,function(n){return e?(n[t].submitError=!1,{sendMessages:[e],messages:n}):{sendMessages:[]}})}},{key:"setMessageTimer",value:function(e){var t=this;v.a.trigger(y.a.setMessageTimer,function(n){var r=setTimeout(function(){var n=F.getMessages(),r=n.messages;if(r[e]){var i=r[e].message;t.addErrorFlag(i)}},3e3);return n[e]=r,n})}},{key:"clearMessageTimer",value:function(){var e=p()(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.i(m.b)(v.a,y.a.clearMessageTimer,function(e){var n=o()ages,s=Object.keys(a).filter(function(e){return a[e].messageId===t})[0];if(s&&r[s]){var c=r[s];clearTimeout(c),delete r[s]}return r});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),R.sendError(e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()},{key:"setConverction(e){v.a.trigger(y.a.setConversationReady,function(t){return e})}},{key:"setYconnectAuthUrl",value:function(e){v.a.trigger(y.a.settring:Oe}),N[u]=R?I:F,r||R||h(_,de,F)}}else e.exports=function(){}},function(e,t,n){"u,r){n.d(t,"b",function(){return J}),n.d(t,"a",function(){return ee});var i,o,a,s=n(92),c=n.n(s),u=n(172),l=n.n(u),p=n(67),h=n.n(p),f=n(17),d=n.n(f),g=n(16),m=n.n(g),y=n(2),v=n.n(y),b=n(3),w=n.n(b),k=n(100),x=n.n(k),_=n(9),T=n(180),S=n(436),E=n(10),A=n(131),M=n(28),C=n(186),I=n(132),R=n(442),F=n(27),O=n(428),N=n(75),L=n(95),j=(n(56),n(182)),B=n(74),P=n(26),D=n(33),z=n(93),U=n(134),q=n(184),H=n(73),W=new P.a,V=D.a.instance,G=new z.a,Y=N.a.instance,Q=q.a.instance,Z="defaultErrorHandler",$=0,J={CREATE_CUSTOMER:"request_key_createcustomer",CREATE_CONVERSATION:"request_key_createconversation",CLOSE_CONVERSATION:"request_key_closeconversation",CREATE_MESSAGE:"request_key_createmessage",RESET_FRAME:"request_key_resetframe",POSTBACK:"request_key_postback",REFRESH_TOKEN:"request_key_refreshtoken",CONVERSATION_RESET:"request_key_conversationreset",FIREBASE_AUTH:"request_key_firebaseauth",SEND_TYPING:"request_send_typing",SEND_CUSTOMER_TYPING:"request_send_customer_typing",YCONNECT_REDIRECT_URL:"request_yconnect_redirect_url"},K={text:"string",boolean:"boolean"},X=n.i(F.a)(i=function(){function t(){var e,r=this;v()(this,t),this._errorMap=(e={},h()(e,J.CREATE_CUSTOMER,h()({401:function(){var e=m()(d.a.mark(function e(t){var n,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.parameter,i=t.retryHash,e.prev=1,W.pushRequestError(J.CREATE_CUSTOMER,401),e.next=5,r.createCustomer({parameter:n,retryHash:i});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),r.catchError({methodName:J.CREATE_CUSTOMER,sendBody:n,reason:e.t0});case 10:case"end":return e.stop()}},e,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),500:function(){var e=m()(d.a.mark(function e(t){var n,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.parameter,i=t.retryHash,e.prev=1,W.pushRequestError(J.CREATE_CUSTOMER,500),e.next=5,r.createCustomer({parameter:n,retryHash:i});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),r.catchError({methodName:J.CREATE_CUSTOMER,sendBody:n,reason:e.t0});case 10:case"end":return e.stop()}},e,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}()},Z,function(){var e=m()(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.parameter,r=t.retryHash,e.prev=1,W.pushRequestError(J.CREATE_CUSTOMER,0),e.next=5,this.createCustomer({parameter:n,retryHash:r});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this.catchError({methodName:J.CREATE_CUSTOMER,sendBody:n,reason:e.t0});case 10:case"end":return e.stop()}},e,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}())),h()(e,J.CREATE_CONVERSATION,h()({401:function(){var e=m()(d.a.mark(function e(t){var n,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.parameter,i=t.retryHash,e.prev=1,W.pushRequestError(J.CREATE_CONVERSATION,401),e.next=5,r._refreshToken();case 5:return e.next=7,r.createConversation({parameter:n,retryHash:i});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r.catchError({methodName:J.CREATE_CONVERSATION,sendBody:n,reason:e.t0});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),500:function(){var e=m()(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.retryHash,e.prev=1,W.pushRequestError(J.CREATE_CONVERSATION,500),e.next=5,r.waitRetry(J.CREATE_CONVERSATION);case 5:V.conversationReset({key:"from-create-conversation-error",retryHash:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r.catchError({methodName:J.CREATE_CONVERSATION,sendBody:null,reason:e.t0});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t){return e.apply(this,arguments)}}()},Z,function(){var e=m()(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.parameter,r=t.retryHash,e.prev=1,e.next=4,this._refreshToken();case 4:return e.next=6,this.createConversation({parameter:n,retryHash:r});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.catchError({methodName:J.CREATE_CONVERSATION,sendBody:n,reason:e.t0});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t){return e.apply(this,arguments)}}())),h()(e,J.SEND_TYPING,h()({401:function(){var e=m()(d.a.mark(function e(t){var i,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.parameter,o=t.retryHash,e.prev=1,W.pushRequestError(J.SEND_TYPING,401),e.next=5,r._refreshToken();case 5:return e.next=7,n.i(R.a)();case 7:if(!e.sent){e.next=11;break}V.conversationReset({key:"from-send-typing-error",retryHash:o}),e.next=13;break;case 11:return e.next=13,r.sendTyping({parameter:i,retryHash:o});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),r.catchError({methodName:J.SEND_TYPING,sendBody:i,reason:e.t0});case 18:case"end":return e.stop()}},e,this,[[1,15]])}));return function(t){return e.apply(this,arguments)}}(),500:function(){var e=m()(d.a.mark(function e(t){var i,o,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.retryHash,e.prev=1,W.pushRequestError(J.SEND_TYPING,500),e.next=5,r.waitRetry(J.SEND_TYPING);case 5:return o=E.a.tenantId,a=E.a.conversationId,e.next=8,n.i(R.a)();case 8:if(!e.sent){e.next=10;break}V.conversationReset({key:"from-send-typing-error",retryHash:i});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.catchError({methodName:J.SEND_TYPING,sendBody:null,reason:e.t0});case 15:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}()},Z,function(){var e=m()(d.a.mark(function e(t){var r,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.parameter,i=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.SEND_TYPING);case 4:return e.next=6,this._refreshToken();case 6:return e.next=8,n.i(R.a)();case 8:if(!e.sent){e.next=12;break}V.conversationReset({key:"from-send-typing-error",retryHash:i}),e.next=14;break;case 12:return e.next=14,this.sendTyping({parameter:r,retryHash:i});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),this.catchError({methodName:J.SEND_TYPING,sendBody:r,reason:e.t0});case 19:case"end":return e.stop()}},e,this,[[1,16]])}));return function(t){return e.apply(this,arguments)}}())),h()(e,J.SEND_CUSTOMER_TYPING,h()({401:function(){var e=m()(d.a.mark(function e(t){var i,o,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.chatActorId,o=t.typingParam,a=t.retryHash,e.prev=1,W.pushRequestError(J.SEND_CUSTOMER_TYPING,401),e.next=5,r._refreshToken();case 5:return e.next=7,n.i(R.a)();case 7:if(!e.sent){e.next=11;break}V.conversationReset({key:"from-send-typing-error",retryHash:a}),e.next=13;break;case 11:return e.next=13,r.sendCustomerTyping({chatActorId:i,typingParam:o,retryHash:a});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),r.catchError({methodName:J.SEND_CUSTOMER_TYPING,sendBody:parameter,reason:e.t0});case 18:case"end":return e.stop()}},e,this,[[1,15]])}));return function(t){return e.apply(this,arguments)}}(),500:function(){var e=m()(d.a.mark(function e(t){var i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.retryHash,e.prev=1,W.pushRequestError(J.SEND_CUSTOMER_TYPING,500),e.next=5,r.waitRetry(J.SEND_CUSTOMER_TYPING);case 5:return e.next=7,n.i(R.a)({tenantId:tenantId,conversationId:conversationId});case 7:if(!e.sent){e.next=9;break}V.conversationReset({key:"from-send-typing-error",retryHash:i});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),r.catchError({methodName:J.SEND_CUSTOMER_TYPING,sendBody:null,reason:e.t0});case 14:case"end":return e.stop()}},e,this,[[1,11]])}));return function(t){return e.apply(this,arguments)}}()},Z,function(){var e=m()(d.a.mark(function e(t){var r,i,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.chatActorId,i=t.typingParam,o=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.SEND_CUSTOMER_TYPING);case 4:return e.next=6,this._refreshToken();case 6:return e.next=8,n.i(R.a)();case 8:if(!e.sent){e.next=12;break}V.conversationReset({key:"from-send-typing-error",retryHash:o}),e.next=14;break;case 12:return e.next=14,this.sendCustomerTyping({chatActorId:r,typingParam:i,retryHash:o});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),this.catchError({methodName:J.SEND_CUSTOMER_TYPING,sendBody:parameter,reason:e.t0});case 19:case"end":return e.stop()}},e,this,[[1,16]])}));return function(t){return e.apply(this,arguments)}}())),h()(e,J.CREATE_MESSAGE,h()({401:function(){var e=m()(d.a.mark(function e(t){var i,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.message,o=t.retryHash,e.prev=1,W.pushRequestError(J.CREATE_MESSAGE,401),e.next=5,r._refreshToken();case 5:return e.next=7,n.i(R.a)();case 7:if(!e.sent){e.next=11;break}V.conversationReset({key:"from-send-typing-error",retryHash:o}),e.next=13;break;case 11:return e.next=13,r.createMessage({message:i,retryHash:o});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),r.catchError({methodName:J.CREATE_MESSAGE,sendBody:i,reason:e.t0});case 18:case"end":return e.stop()}},e,this,[[1,15]])}));return function(t){return e.apply(this,arguments)}}(),500:function(){var e=m()(d.a.mark(function e(t){var i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.retryHash,e.prev=1,W.pushRequestError(J.CREATE_MESSAGE,500),e.next=5,n.i(R.a)();case 5:if(!e.sent){e.next=9;break}V.conversationReset({key:"from-send-typing-error",retryHash:i}),e.next=11;break;case 9:return e.next=11,r.waitRetry(J.CONVERSATION_RESET);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.catchError({methodName:J.CREATE_MESSAGE,sendBody:null,reason:e.t0});case 16:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}()},Z,function(){var e=m()(d.a.mark(function e(t){var r,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.message,i=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.CREATE_MESSAGE);case 4:return e.next=6,this._refreshToken();case 6:return e.next=8,n.i(R.a)();case 8:if(!e.sent){e.next=12;break}V.conversationReset({key:"from-send-typing-error",retryHash:i}),e.next=14;break;case 12:return e.next=14,this.createMessage({message:r,retryHash:i});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),this.catchError({methodName:J.CREATE_MESSAGE,sendBody:r,reason:e.t0});case 19:case"end":return e.stop()}},e,this,[[1,16]])}));return function(t){return e.apply(this,arguments)}}())),h()(e,J.POSTBACK,h()({401:function(){var e=m()(d.a.mark(function e(t){var i,o,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.message,o=t.item,a=t.retryHash,e.prev=1,W.pushRequestError(J.POSTBACK,401),e.next=5,r._refreshToken();case 5:return V.removeNewMessage(r._postBackToDummyObject(o)),e.next=8,n.i(R.a)();case 8:if(!e.sent){e.next=12;break}V.conversationReset({key:"from-send-typing-error",retryHash:a}),e.next=14;break;case 12:return e.next=14,r.postBack({message:i,item:o,retryHash:a});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),r.catchError({methodName:J.POSTBACK,sendBody:{message:i,item:o},reason:e.t0});case 19:case"end":return e.stop()}},e,this,[[1,16]])}));return function(t){return e.apply(this,arguments)}}(),500:function(){var e=m()(d.a.mark(function e(t){var i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.retryHash,e.prev=1,W.pushRequestError(J.POSTBACK,500),e.next=5,n.i(R.a)();case 5:if(!e.sent){e.next=9;break}V.conversationReset({key:"from-send-typing-error",retryHash:i}),e.next=12;break;case 9:return e.next=11,r.waitRetry(J.CONVERSATION_RESET);case 11:V.conversationReset({key:"from-create-postback-error",retryHash:i});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),r.catchError({methodName:J.POSTBACK,sendBody:null,reason:e.t0});case 17:case"end":return e.stop()}},e,this,[[1,14]])}));return function(t){return e.apply(this,arguments)}}()},Z,function(){var e=m()(d.a.mark(function e(t){var r,i,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.message,i=t.item,o=t.retryHash,e.prev=1,e.next=4,this._refreshToken();case 4:return V.removeNewMessage(this._postBackToDummyObject(i)),e.next=7,n.i(R.a)();case 7:if(!e.sent){e.next=9;break}V.conversationReset({key:"from-send-typing-error",retryHash:o});case 9:this.postBack({message:r,item:i,retryHash:o}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),this.catchError({methodName:J.POSTBACK,sendBody:null,reason:e.t0});case 15:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}())),e);for(var i in this._errorMap)if(!this._errorMap[i][Z])throw new Error("".concat(Z," is not implemented in ").concat(i))}return w()(t,[{key:"request",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=location.href;return n&&n.headers?n.headers["X-AIM-Referer"]=i:n.headers={"X-AIM-Referer":parent.location.href},n.headers["X-AIM-DID"]=E.a.did,r&&(n.headers["X-AIM-RI"]=r),n.refererDisabled&&(delete n.refererDisabled,delete n.headers["X-AIM-Referer"]),e(t,n)}},{key:"createCustomer",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s,c,u=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.parameter,i=t.retryHash,e.prev=1,o=M.a.get(),a=o.customer,e.next=5,this.waitRetry(J.CREATE_CUSTOMER);case 5:return s=Q.getRetryCount(J.CREATE_CUSTOMER),c=r.additional&&0!==Object.keys(r.additional).length?JSON.stringify(r):null,e.next=9,n.i(_.b)(S.a,T.a.createCustomer,function(){var e=m()(d.a.mark(function e(t){var n,o,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.request(t,{method:"POST",body:c},"".concat(i,"_").concat(s));case 2:return n=e.sent,e.next=5,U.a.create(n);case 5:return o=e.sent,e.next=8,u.responseFilter({methodName:J.CREATE_CUSTOMER,response:o,args:{parameter:r,retryHash:i}});case 8:l=o.response,l.customer.tenantId=a.tenantId,M.a.set(l),W.setUser(l.customer.id),G.setEnv({userId:l.customer.id});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.catchError({methodName:"createCustomer",sendBody:null,reason:e.t0});case 14:case"end":return e.stop()}},e,this,[[1,11]])}));return function(t){return e.apply(this,arguments)}}()},{key:"createConversation",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s,c=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.parameter,i=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.CREATE_CONVERSATION);case 4:return e.next=6,this._apiAuth();case 6:return o=I.a.get(),a=Q.getRetryCount(J.CREATE_CONVERSATION),s={},r.additional&&0!==Object.keys(r.additional).length&&(s.additional=r.additional),parent.aiMessenger.botName&&(s.botName=parent.aiMessenger.botName),e.next=13,n.i(_.b)(S.a,T.a.createConversation,function(){var e=m()(d.a.mark(function e(t){var n,u,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.request(t,{method:"POST",headers:{Authorization:"Bearer ".concat(o.access_token)},body:JSON.stringify(s)},"".concat(i,"_").concat(a));case 2:return n=e.sent,e.next=5,U.a.create(n);case 5:return u=e.sent,e.next=8,c.responseFilter({methodName:J.CREATE_CONVERSATION,response:u,args:{parameter:r,retryHash:i}});case 8:l=u.response.conversation.id,M.a.setConversationId(l),W.setConversation(l),G.setEnv({conversationId:l});case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 13:e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(1),this.catchError({methodName:"createConversation",sentBody:r,reason:e.t0}),new Error("createConversation",e.t0);case 19:case"end":return e.stop()}},e,this,[[1,15]])}));return function(t){return e.apply(this,arguments)}}()},{key:"closeConversation",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.parameter,i=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.CLOSE_CONVERSATION);case 4:return e.next=6,this._apiAuth();case 6:return o=I.a.get(),a=Q.getRetryCount(J.CLOSE_CONVERSATION),e.next=10,n.i(_.b)(S.a,T.a.closeConversation,function(){var e=m()(d.a.mark(function e(t){var n,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.request("".concat(t,"/").concat(r.conversationId),{method:"POST",headers:{Authorization:"Bearer ".concat(o.access_token),"X-HTTP-Method-Override":"DELETE"}},"".concat(i,"_").concat(a));case 2:return n=e.sent,e.next=5,U.a.create(n);case 5:return c=e.sent,e.next=8,s.responseFilter({methodName:J.CLOSE_CONVERSATION,response:c,args:{parameter:r,retryHash:i}});case 8:M.a.setConversationId(null),G.setEnv({conversationId:null}),W.pushConversationClosed(),V.setConversationReady(!1);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 10:e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(1),this.catchError({methodName:"closeConversation",sentBody:r,reason:e.t0}),new Error("closeConversation",e.t0);case 16:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}()},{key:"sendTyping",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.parameter,i=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.SEND_TYPING);case 4:return e.next=6,this._apiAuth();case 6:return o=I.a.get(),a=Q.getRetryCount(J.SEND_TYPING),e.next=10,n.i(_.b)(S.a,T.a.sendTyping,function(){var e=m()(d.a.mark(function e(t){var n,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.request(t,{method:"POST",headers:{Authorization:"Bearer ".concat(o.access_token)},body:JSON.stringify(r)},"".concat(i,"_").concat(a));case 2:return n=e.sent,e.next=5,U.a.create(n);case 5:return c=e.sent,e.next=8,s.responseFilter({methodName:J.SEND_TYPING,response:c,args:{parameter:r,retryHash:i}});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 10:e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(1),this.catchError({methodName:"sendTyping",sentBody:r,reason:e.t0}),new Error("sendTyping",e.t0);case 16:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}()},{key:"resetFrame",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.CREATE_MESSAGE);case 4:return e.next=6,this._apiAuth();case 6:return i=I.a.get(),o=message.sign,a=Q.getRetryCount(J.CREATE_MESSAGE),e.next=11,n.i(_.b)(S.a,T.a.resetFrame,function(){var e=m()(d.a.mark(function e(t){var n,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.request(t,{method:"DELETE",headers:{Authorization:"Bearer ".concat(i.access_token)}},"".concat(r,"_").concat(a));case 2:return n=e.sent,e.next=5,U.a.create(n);case 5:return o=e.sent,e.next=8,s.responseFilter({methodName:J.RESET_FRAME,response:o,args:{retryHash:r}});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 11:e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(1),this.catchError({methodName:"resetFrame",sentBody:{},reason:e.t0}),new Error("resetFrame",e.t0);case 17:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"createMessage",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s,c,u,l,p,h=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.message,i=t.retryHash,o=t.isFile,a=void 0!==o&&o,e.prev=1,e.next=4,this.waitRetry(J.CREATE_MESSAGE);case 4:return e.next=6,this._apiAuth();case 6:return c=I.a.get(),u=r.sign,l=Q.getRetryCount(J.CREATE_MESSAGE),e.next=11,n.i(_.b)(S.a,a?T.a.createImage:T.a.createMessage,function(){var e=m()(d.a.mark(function e(t){var n,o,p;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a?(s=new FormData,s.append("attachment",r.file)):s={customer:{id:E.a.userId},message:r},n={Authorization:"Bearer ".concat(c.access_token)},r.meta&&r.meta.clientOriginMessageId&&(n["X-AIM-CLIENT-ORIGIN-MESSAGE-ID"]=r.meta.clientOriginMessageId),e.next=5,h.request(t,{method:"POST",headers:n,body:a?s:JSON.stringify(s)},"".concat(i,"_").concat(l));case 5:return o=e.sent,e.next=8,U.a.create(o);case 8:return p=e.sent,e.next=11,h.responseFilter({methodName:J.CREATE_MESSAGE,response:p,args:{message:r,retryHash:i}});case 11:p.ok&&(Y.updateMessageId(u,p.response),V.setMessageTimer(u));case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),p=s.message,V.addErrorFlag(p);case 17:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"postBack",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s,c,u,l,p=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.message,i=t.item,o=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.POSTBACK);case 4:return e.next=6,this._apiAuth();case 6:if(a=I.a.get(),s=r.sign,c=i.payload?JSON.stringify(i.payload):null,u=E.a.conversationId,l=Q.getRetryCount(J.POSTBACK),!u){e.next=15;break}return i.path=i.path.replace(/\{conversation_id\}/,u),e.next=15,n.i(_.b)(S.a,T.a.postBack,function(){var e=m()(d.a.mark(function e(t){var n,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.request("".concat(t).concat(i.path),{method:"POST",headers:{Authorization:"Bearer ".concat(a.access_token)},body:c},"".concat(o,"_").concat(l));case 2:return n=e.sent,e.next=5,U.a.create(n);case 5:return u=e.sent,e.next=8,p.responseFilter({methodName:J.POSTBACK,response:u,args:{message:r,item:i,retryHash:o}});case 8:u.ok&&(Y.updateMessageId(s,u.response),V.setMessageTimer(s));case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),navigator.onLine?this.catchError({methodName:"postBack",sendBody:{message:r,item:i},reason:e.t0}):V.addErrorFlag(r);case 20:case"end":return e.stop()}},e,this,[[1,17]])}));return function(t){return e.apply(this,arguments)}}()},{key:"sendCustomerTyping",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s,c,u=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.chatActorId,i=t.typingParam,o=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.SEND_CUSTOMER_TYPING);case 4:return e.next=6,this._apiAuth();case 6:return a=I.a.get(),s=message.sign,c=Q.getRetryCount(J.SEND_CUSTOMER_TYPING),e.next=11,n.i(_.b)(S.a,T.a.sendCustomerTyping,function(){var e=m()(d.a.mark(function e(t){var n,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.request("".concat(t,"/").concat(r),{method:"POST",headers:{Authorization:"Bearer ".concat(a.access_token)},body:JSON.stringify(i)},"".concat(o,"_").concat(c));case 2:return n=e.sent,e.next=5,U.a.create(n);case 5:return s=e.sent,e.next=8,u.responseFilter({methodName:J.SEND_CUSTOMER_TYPING,response:s,args:{message:message,typingParam:i,retryHash:o}});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),navigator.onLine?this.catchError({methodName:"sendCustomerTyping",sendBody:{message:message},reason:e.t0}):V.addErrorFlag(message);case 16:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"yconnectRedirectUrl",value:function(){var e=m()(d.a.mark(function e(t){var r,i,o,a,s,c,u=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,i=t.redirectUrl,o=t.retryHash,e.prev=1,e.next=4,this.waitRetry(J.YCONNECT_REDIRECT_URL);case 4:return e.next=6,this._apiAuth();case 6:return a=I.a.get(),s=message.sign,c=Q.getRetryCount(J.SEND_CUSTOMER_TYPING),e.next=11,n.i(_.b)(S.a,T.a.yconnectRedirectUrl,function(){var e=m()(d.a.mark(function e(t){var n,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.request(t,{method:"POST",headers:{Authorization:"Bearer ".concat(a.access_token)},body:JSON.stringify({yConnect:{conversationId:r,redirectUrl:i}})},"".concat(o,"_").concat(c));case 2:return n=e.sent,e.next=5,U.a.create(n);case 5:return s=e.sent,e.next=8,u.responseFilter({methodName:J.YCONNECT_REDIRECT_URL,response:s,args:{conversationId:r,redirectUrl:i,retryHash:o}});case 8:s.ok&&V.setYconnectAuthUrl(s.response.authorizationUrl);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),navigator.onLine?this.catchError({methodName:"sendCustomerTyping",sendBody:{conversationId:r,redirectUrl:i},reason:e.t0}):V.addErrorFlag(message);case 16:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"pushLogs",value:function(){var e=this;S.a.trigger(T.a.pushLogs,function(){var t=m()(d.a.mark(function t(n){var r,i,o,a,s,c,u,l,p,h,f,g;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=M.a.get({customer:{}}),i=r.customer,o=I.a.get(),a=Y.getMessages(),s=a.messages,c=E.a.userId,u=E.a.tenantId,l=E.a.conversationId,p=A.a.logs,h=A.a.receivedMessages,f=JSON.stringify({sequence:$,userId:c,tenantId:u,conversationId:l,logs:p,receivedMessages:h,customerInfo:i,authInfo:o,messagesInfo:s}),f>524288e3&&(f=f.slice(0,524288e3)),t.next=10,e.request(n,{method:"POST",refererDisabled:!0,body:f});case 10:g=t.sent,g.ok&&(W.erasePushedLogs(),W.erasePushedReceivedMessageIds(),$+=1),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),e.sendError(t.t0,"pushLogs");case 17:case"end":return t.stop()}},t,this,[[0,14]])}));return function(e){return t.apply(this,arguments)}}())}},{key:"_apiAuth",value:function(){var e=m()(d.a.mark(function e(){var t,r,i,o,a=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){var e=m()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Q.add("_apiAuth"),e.next=3,a.waitRetry("_apiAuth");case 3:return e.next=5,a._apiAuth();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),e.prev=1,e.next=4,j.a.checkFirebaseAuth();case 4:if(I.a.isExists()){e.next=15;break}if(i=M.a.get(),o=i.customer,!o.id||!o.passToken){e.next=12;break}return t="client_id=".concat(o.tenantId,"&grant_type=password&username=").concat(o.id,"&password=").concat(o.passToken),e.next=10,n.i(_.b)(S.a,T.a.apiAuth,function(){var e=m()(d.a.mark(function e(n){var i,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.request(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});case 3:return i=e.sent,e.next=6,U.a.create(i);case 6:if(o=e.sent,o.ok){e.next=13;break}return e.next=10,r();case 10:return e.abrupt("return",e.sent);case 13:I.a.set(o.response);case 14:e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(0),e.next=20,r();case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}},e,this,[[0,16]])}));return function(t){return e.apply(this,arguments)}}());case 10:e.next=13;break;case 12:throw new Error("customer.id or/and customer.passToken not found.");case 13:e.next=18;break;case 15:if(!I.a.isExpired()){e.next=18;break}return e.next=18,this._refreshToken();case 18:e.next=23;break;case 20:return e.prev=20,e.t0=e.catch(1),e.abrupt("return",this.catchError({methodName:"apiAuth",sendBody:t,reason:e.t0}));case 23:case"end":return e.stop()}},e,this,[[1,20]])}));return function(){return e.apply(this,arguments)}}()},{key:"_refreshToken",value:function(){var e=m()(d.a.mark(function e(){var t,r,i,o,a=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=M.a.get(),i=r.customer,o=I.a.get(),t="client_id=".concat(i.tenantId,"&grant_type=refresh_token&refresh_token=").concat(o.refresh_token),e.next=6,this.waitRetry(J.REFRESH_TOKEN);case 6:return e.next=8,n.i(_.b)(S.a,T.a.apiAuth,function(){var e=m()(d.a.mark(function e(n){var r,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.request(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});case 2:return r=e.sent,e.next=5,U.a.create(r);case 5:if(i=e.sent,401!==i.status){e.next=10;break}return I.a.remove(),e.next=10,a._apiAuth();case 10:I.a.set(i.response);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),this.catchError({methodName:"refreshToken",sendBody:t,reason:e.t0});case 13:case"end":return e.stop()}},e,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"responseFilter",value:function(){var e=m()(d.a.mark(function e(t){var n,i,o,a=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.methodName,i=t.response,o=t.args,e.abrupt("return",new r(function(){var e=m()(d.a.mark(function e(t,r){var s,c,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i||!i.ok){e.next=5;break}return Q.clear(n),e.abrupt("return",t(i.response));case 5:return s=a._errorMap[n][i.status],s||(c=i.response,u="responseFilter:".concat(n),W.pushRequestError("".concat(u,"-").concat(c),i.status),s=a._errorMap[n][Z].bind(a)),Q.add(n),s(o),e.abrupt("return",r("reject from responseFilter."));case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"waitRetry",value:function(){var e=m()(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Q.getWaitTipt("return",new r(function(e){setTimeout(function(){return e()},n)}));case 5:throw G.setWallMessage('<p>現在エラーが起きております。再読込してもう一度お試しください</p><div class="reload-button" onclick="window.parent.aiMessenger.resetWidget();">再読込</div>'),this.catchError({methodName:"waitRetry",sendBody:null,reason:"Retry timeout"}),new Error("Retry timeout");case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_postBackToDummyObject",value:function(e){return e||e.title?{attachment:{mediaType:"quickReplyPostback",payload:e.title}}:{}}},{key:"catchError",value:function(e){var t=e.methodName,n=e.sendBody,i=e.reason;return this.sendError(i,t),r.reject(n)}},{key:"sendError",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];W.sendError(new Error(e),n)}}]),t}())||i,ee=n.i(F.a)((a=function(){function e(){v()(this,e),this.internalRequestAction=X.instance,this._updateCustomerStateQueue=[],this._retryHashSeeds=[];for(var t in J)this._retryHashSeeds[J[t]]=Math.random()}return w()(e,[{key:"startConversation",value:function(){var e=m()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.createCustomer();case 3:return e.next=5,this.createConversation();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",this.catchError({methodName:"startConversation",sendBody:null,reason:e.t0}));case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"setConversationResetFlag",value:function(e){S.a.trigger(T.a.setConversationResetFlag,function(t){returunction(){return new r(function(e,t){return M.a.get()||S.a.trigger(T.a.createEmptyCustomer,function(t){return M.a.setTenantId(t),e()}),e()})}},{key:"createCustomer",value:function(){var e=m()(d.a.mark(function e(){var t,n,r,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._createEmptyCustomer();case 3:if(t=M.a.get(),n=t.customer,r=this.parameterFilter({additional:E.a.additional}),n.id){e.next=9;break}return i=this._makeRetryHash(J.CREATE_CUSTOMER),e.next=9,this.internalRequestAction.createCustomer({parameter:r,retryHash:i});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.catchError({methodName:"createCustomer",sendBody:null,reason:e.t0});case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"createConversation",value:function(){var e=m()(d.a.mark(function e(){var t,n,i,o,a,s=this,c=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{retryHash:null},n=t.retryHash,e.prev=1,e.next=4,this._createEmptyCustomer();case 4:if(i=M.a.get(),o=i.customer,a=this.parameterFilter({additional:E.a.additional}),o.conversationId){e.next=20;break}return n||(n=this._makeRetryHash(J.CREATE_CONVERSATION)),e.next=10,this.internalRequestAction.createConversation({parameter:a,retryHash:n});case 10:return this.sendBufferedDummies(),this.bindConversation(E.a.conversationId),this.setase 15:return e.next=17,r.all(this._updateCustomerStateQueue.map(function(e){var t=e.key,n=e.value;return s.updateCustomerState(t,n)}));case 17:this._updateCustomerStateQueue.length=0,e.next=21;break;case 20:G.setEnv({conversationId:o.conversationId});case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(1),this.catchError({methodName:"createConversation",sendBody:null,reason:e.t0});case 26:case"end":return e.stop()}},e,this,[[1,23]])}));return function(){return e.apply(this,arguments)}}()},{key:"sendTyping",value:function(){var e=m()(d.a.mark(function e(t){var n,r,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._createEmptyCustomer();case 3:return e.next=5,this.conversationResetCheck();case 5:if(n=e.sent,r=this.parameterFilter({position:0,text:t||""}),n){e.next=11;break}return i=this._makeRetryHash(J.SEND_TYPING),e.next=11,this.internalRequestAction.sendTyping({parameter:r,retryHash:i});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),this.catchError({methodName:"sendTyping",sendBody:null,reason:e.t0});case 16:case"end":return e.stop()}},e,this,[[0,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"resetFrame",value:function(){var e=m()(d.a.mark(function e(){var t,r,i,o,a,s=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(s.length>0&&void 0!==s[0])||s[0],e.prev=1,e.next=4,this._createEmptyCustomer();case 4:return e.next=6,this.conversationResetCheck();case 6:if(r=M.a.get({customer:null}),i=r.customer,o=this._makeRetryHash(J.CREATE_CUSTOMER),"restart"!==Customize.restartType){e.next=14;break}return V.pushTyping(n.i(H.a)("bot")),e.next=12,this.internalRequestAction.resetFrame({retryHash:o});case 12:e.next=24;break;case 14:return V.incrementConversationCount(),V.pushTyping(n.i(H.a)("bot")),a={conversationId:i.conversationId},e.next=19,this.internalRequestAction.closeConversation({parameter:a,retryHash:o});case 19:return this.setConversationResetFlag(!0),V.setCatchWelcomeMessage(t),V.unboundStream(),e.next=24,this.createConversation();case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(1),this.catchError({methodName:"createCustomer",sendBody:null,reason:e.t0});case 29:case"end":return e.stop()}},e,this,[[1,26]])}));return function(){return e.apply(this,arguments)}}()},{key:"createMessage",value:function(){var e=m()(d.a.mark(function e(t){var n,r,i,o=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],e.prev=1,e.next=4,this._createEmptyCustomer();case 4:return e.next=6,this.conversationResetCheck();case 6:r=e.sent,r||(i=this._makeRetryHash(J.CREATE_MESSAGE),this.internalRequestAction.createMessage({message:t,retryHash:i,isFile:n})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),this.catchError({methodName:"createMessage",sendBody:null,reason:e.t0});case 13:case"end":return e.stop()}},e,this,[[1,10]])}));return function(t){return e.apply(this,arguments)}}()},{key:"postBack",value:function(){var e=m()(d.a.mark(function e(t){var n,r,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,V.startEmbeddedConversation(),n=B.a.insertDummy(t.title,!1,t.payload.message),e.next=5,this._createEmptyCustomer();case 5:return e.next=7,this.conversationResetCheck();case 7:r=e.sent,r||(i=this._makeRetryHash(J.POSTBACK),this.internalRequestAction.postBack({message:n,item:t,retryHash:i})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.catchError({methodName:"postBack",sendBody:null,reason:e.t0});case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(t){return e.apply(this,arguments)}}()},{key:"sendCustomerTyping",value:function(){var e=m()(d.a.mark(function e(t){var n,r,i,o,a,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.text,r=t.on,e.prev=1,e.next=4,this._createEmptyCustomer();case 4:return e.next=6,this.conversationResetCheck();case 6:i=e.sent,o=M.a.get({customer:null}),a=o.customer,!i&&a.id&&(s=this._makeRetryHash(J.POSTBACK),this.internalRequestAction.sendCustomerTyping({chatActorId:a.id,typingParam:{text:n,off:!r,at:Date.now()},retryHash:s})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.catchError({methodName:"sendCustomerTyping",sendBody:null,reason:e.t0});case 14:case"end":return e.stop()}},e,this,[[1,11]])}));return function(t){return e.apply(this,arguments)}}()},{key:"yconnectRedirectUrl",value:function(){var e=m()(d.a.mark(function e(t){var n,r,i,o,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.redirectUrl,e.prev=1,e.next=4,this._createEmptyCustomer();case 4:return e.next=6,this.conversationResetCheck();case 6:r=e.sent,i=M.a.get({customer:null}),o=i.customer,!r&&o.id&&(a=this._makeRetryHash(J.POSTBACK),this.internalRequestAction.yconnectRedirectUrl({conversationId:o.conversationId,redirectUrl:n,retryHash:a})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.catchError({methodName:"yconnectRedirectUrl",sendBody:null,reason:e.t0})]])}));return function(t){return e.apply(this,arguments)}}()},{key:"pushLogs",value:function(){this.internalRequestAction.pushLogs()}},{key:"initCustomerStateOnMount",value:function(){var e=m()(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=M.a.get({customer:null}),!((n=t.customer)&&n.id&&n.conversationId)){e.next=4;break}return e.next=4,this._setDefaultCustomerState();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateCustomerState",value:function(){var e=m()(d.a.mark(function e(t,r){var i,o,a=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=M.a.get({customer:null}),(o=i.customer)&&o.id&&o.conversationId){e.next=3;break}return e.abrupt("return",this._updateCustomerStateQueue.push({key:t,value:r}));case 3:return e.abrupt("return",n.i(_.b)(S.a,T.a.updateCustomerState,function(){var e=m()(d.a.mark(function e(inction(e){for(;;)switch(e.prev=e.next){case 0:if(s=c()(i,2),u=s[0],l=s[1],p=-1,l.items.some(function(e,n){return e.key===t&&(p=n,!0)}),!(p>-1)){e.next=27;break}if(h=l.items[p],f=n.i(C.a)(r).toLowerCase(),K[h.typedValue.valueType]!==f){e.next=24;break}if(h.value=r,g=a._convertCustomerStateToUpdateJSON(t,String(r),o.id),a._isValidCustomerState(g)){e.next=11;break}return e.abrupt("return");case 11:return m=JSON.stringify(g),y=I.a.get(),e.prev=13,e.next=16,a.request(u,{method:"PATCH",headers:{Authorization:"Bearer ".concat(y.access_token)},body:m});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(13),e.next=22,a.catchError({methodName:"updateCustomerState",sendBody:m,reason:e.t0});case 22:e.next=25;break;case 24:console.error("key ".concat(t," type is expected '").concat(h.type,"', but got '").concat(f,"'"));case 25:e.next=28;break;case 27:console.error("Specified key '".concat(t,"' is invalid key."));case 28:return e.abrupt("return");case 29:case"end":return e.stop()}},e,this,[[13,18]])}));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"_setDefaultCustomerState",value:function(){var e=m()(d.a.mark(function e(){var t,r=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._convertCustomerStateToRequestJSON(window.parent.aiMessenger.defaultCustomerState,M.a.get().customer.id),e.next=3,n.i(_.b)(S.a,T.a.updateCustomerState,function(){var e=m()(d.a.mark(function e(n){var i,o,a,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c()(n,1),o=i[0],r._isValidCustomerState(t)){e.next=3;break}return e.abrupt("return",t);case 3:return e.prev=3,a=JSON.stringify(t),s=I.a.get(),e.next=8,r.request(o,{method:"POST",headers:{Authorization:"Bearer ".concat(s.access_token)},body:a});case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(3),e.next=14,r.catchError({methodName:"setDefaultCustomerState",sendBody:body,reason:e.t0});case 14:case"end":return e.stop()}},e,this,[[3,10]])}));return function(t){return e.apply(this,arguments)}}());case 3:S.a.trigger(T.a.setCustomerState,function(){return t});chis)}));return function(){return e.apply(this,arguments)}}()},{key:"_isValidCustomerState",value:function(e){return e.items.length>0}},{key:"_convertCustomerStateToUpdateJSON",value:function(e,t,n){return{id:n,url:parent.location.href,items:[{key:e,value:t}]}}},{key:"_convertCustomerStateToRequestJSON",value:function(e,t){return{id:t,url:parent.location.href,items:function(){var t=[];for(var n in e){var r=e[n],i=r.displayName,o=r.type,a=r.defaultValue;t.push({key:n,typedValue:{displayName:i,valueType:o,initialValue:String(a)}})}return t}()}}},{key:"setAdditional",value:function(e){var t=this,r=window.parent.aiMessenger._additionalQueue;e&&r.unshift(e),r&&(r.forEach(function(e){G.setEnv({additional:n.i(L.a)(e)}),S.a.trigger(T.a.setAdditional,function(){var e=m()(d.a.mark(function e(n,r){var i,o,a,s,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=M.a.setAdditional(n),!(o=i.isChange)){e.next=17;break}if(null===(a=n&&0!==Object.keys(n).length?JSON.stringify({additional:n}):null)){e.next=17;break}return s=I.a.get(),e.prev=5,e.next=8,t.request("".concat(r),{method:"PATCH",headers:{Authorization:"Bearer ".concat(s.access_token)},body:a});case 8:return c=e.sent,e.abrupt("return",c);case 12:return e.prev=12,e.t0=e.catch(5),e.next=16,t.catchError({methodName:"setAdditional",sendBody:a,reason:e.t0});case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}},e,this,[[5,12]])}));return function(t,n){return e.apply(this,arguments)}}())}),window.parent.aiMessenger._additionalQueue=[])}},{key:"bindConversation",value:function(e){S.a.trigger(T.a.bindConversation,function(t){_.a.trigger("Talks","talks:bindConversation",{tenantId:t,conversationId:e})})}},{key:"conversationResetCheck",value:function(){var e=m()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=S.a.conversationResetFlag,e.t0){e.next=5;break}return e.next=4,n.i(R.a)();case 4:e.t0=e.sent;case 5:if(!e.t0){e.next=12;break}return e.next=8,V.conversationReset({key:"from-conversation-reset-check",retryHash:"from-conversation-reset-check"});case 8:return this.setConversationResetFlag(!1),e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parameterFilter",value:function(e){var t=e.additional;if(t&&0===Object.keys(t).length)return delete e.additional,e;for(var n inferedDummies",value:func(t){t.forEach(function(t){e.createMessage(t)})})}},{key:"request",value:function(e,t){return this.internalReon(e){return this.internn(){return this.internalRequestAction._apiAuth()}},{key:"waitRetry",value:function(e){return this.internalRequestAction.waitRetry(e)}},{key:"_makeRetryHash",value:function(e){return this._retryHashSeeds[e]=Math.random(),x()(te.retryHashSeeds[e])}},{key:"retryHashSeeds",get:function(){return this._retryHashSeeds}}]),e}(),l()(a.prototype,"createCustomer",[O.a],Object.getOwnPropertyDescriptor(a.prototype,"createCustomer"),a.prototype),l()(a.prototype,"createConversation",[O.a],Object.getOwnPropertyDescriptor(a.prototturn i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){n(1).tag2("yield","","messages .message { margin: 0px 25px; position: relative; display: -webkit-flex; display: -ms-flexbox; display: flex; -webkit-align-items: flex-start; -ms-flex-align: start; align-items: flex-start; } messages .message.customer { -webkit-flex-direction: row-reverse; -ms-flex-direction: row-reverse; flex-direction: row-reverse; } _:-ms-input-placeholder, :root .message .message-balloon { max-width: 100%; } messages .message .message-balloon { padding: 10px 10px; margin: 0px; display: inline-block; word-break: break-word; box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.35); } messages .message .message-balloon p { margin: 0px; } .message .message-balloon p:empty { margin-bottom: 1em; } .message .message-balloon-wrapper { display: -webkit-flex; display: -ms-flexbox; display: flex; align-items: initial; } .bot .message-balloon-wrapper, .operator .message-balloon-wrapper { -webkit-flex-direction: row; -ms-flex-direction: row; flex-direction: row; } .customer .message-balloon-wrapper { -webkit-flex-direction: row-reverse; -ms-flex-direction: row-reverse; flex-direction: row-reverse; } @supports (-webkit-appearance:none) { .message-balloon-wrapper { width: 100%; } } _:-moz-tree-row(hover), .message-balloon-wrapper { width: 100%; } _:-ms-fullscreen, :root .message-balloon-wrapper { width: 100%; } .message.customer .message-balloon-wrapper { -webkit-align-items: flex-end; -ms-flex-align: end; align-items: flex-end; } .message .message-balloon-wrapper::after { content: attr(data-information); color: black; opacity: 0.3; display: block; clear: both; height: 18px; font-size: small; } .message .not-show-date::after { content: none !important; } .message.customer .message-balloon-wrapper::after { text-align: right; } .message.bot .message-balloon { color: #6F6F6F; background: #FFFFFF; min-width: 150px; border-radius: 2px 23px 23px 23px; } .message.operator .message-balloon { color: #6F6F6F; background: #FFFFFF; min-width: 150px; border-radius: 2px 23px 23px 23px; } .message.customer .message-balloon { background: #337FFF; min-width: 150px; border-radius: 23px 2px 23px 23px; } .show-date-on-bottom .message-balloon-wrapper { flex-direction: column; align-items: flex-start; } .show-date-on-bottom.message .message-balloon-wrapper:after { margin: 5px 0 0 10px !important; } .show-date-on-bottom.customer .message-balloon-wrapper:after { margin: 5px 10px 0 0 !important; } rawContent { white-space: pre-wrap; }",'to="mediaTypeBaseStyle"',function(e){})},function(e,t,n){"use strict";function r(e){return Object.prototype.toString.call(e).match(/\[object ([^]+)\]/)[1].toLowerCase()}n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u});var i=n(2),o=n.n(i),a=n(3),s=n.n(a),c=function(){function e(){o()(this,e)}return s()(e,null,[{kstringify(t)),window.localStorage.setItem(e,t)}},{key:"getItem",value:function(e){return this.hasItemeItem",value:functiction(e){return e in var t in window.localStorage)e.push(t);return e}}]),e}(),u=function(){function e(t){o()(this,e),this.keyName=t,this.cachedValue=null}return s()(e,[{key:"update",value:function(e){c.setItem(this.keyName,e),this.cachedValue=null}},{key:"set",value:function(e,t){var n=this.get();n[e]=t,c.setItem(this.keyName,n),this.cachedValue=null}},{key:"get",value:function(){return this.cachedValue?this.cachedValue:c.hasItem(this.keyName)?this.cachedValue=JSON.parse(c.getItem(this.keyName)):{[e],c.setItem(this.keyName,t),this.cachedValue=null}},{key:"reset",value:function(){c.removeItem(torts=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return l});var r=n(55),i=n.n(r),o="object"!==("undefined"==typeof aimWidgetEnv?"undefined":i()(aimWidgetEnv)),a=o?parent:window,s=a.aimWidgetEnv,c=a.swa:s.envPrefix,l="".concat(u,"_").concat(c.tenantId)},function(e,t,n){"use strict";function r(e,t){return O.parse({source:e,mobile:t})}function i(e,t){if(Customize.talks["open-link-new-window"]||t)try{window.open(e).location.href=e}catch(t){rg4js("onAfterSend",function(t){window.parent.loc"jumpToLink Error")})}else window.parent.location.href=e}function o(e){for(var t,n=T.map(function(e){return"not(".concat(e.name,")")}).join(":");t=e.querySelector("*:".concat(n));){if(S[t.tagName.toLowerCase()]!==_.ERASE)for(;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.parentNode.removeChild(t)}T.forEach(function(t){var n=t.name,r=t.attrs,i=e.querySelectorAll(n.forEach(function(e){var t=e.attributes;Array.prototype.slice.call(t).forEach(function(e){0===r.filter(function(t){return t===e.name}).length&&t.removeNamedItem(e)}),"A"===e.nodeName&&(e.classList.add(k),e.setAttribute("data-link",e.href))})})}function a(){N||(N=!0,document.documentElement.addEventListener("click",function(e){for(var t=e.target;t&&t!==document.body&&t!==document.documentElment;){if(1===t.nodeType&&t.classList&&t.classList.contains("aim-link")){var n=t.getAttribute("data-link");return n||(n=t.getAttribute("href")),e.preventDefault(),void(window.parent.aiMessenger.runFunctions("linkClicked",n)&&i(n))}t=t.parentElement}}))}function s(e){var t=document.createDocumentFragment(),n=t.appendChild(document.createElement("div"));return n.innerHTML=e,o(n),n.innerHTML}n.d(t,"a",function(){return P});var c=n(174),u=n.n(c),l=n(91),p=n.n(l),h=n(173),f=n.n(h),d=n(2),g=n.n(d),m=n(3),y=ngfm:!0,breaks:!0,smartLists:!0,smartypants:!1,xhtml:!0}),b.a.use({renderer:{paragraph:function(e){return"<span>".concat(e,"</span>")},link:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b.a.Renderer.prototype.link.apply(this,t).replace(/^<a/,'<a class="aim-link" ')}},tokenizer:{space:function(e){var t=/^ *\n/.exec(e);if(t||(t=/\n$/.exec(e)),t)return{type:"html",raw:t[0],text:"<br/>"}}}});var k="aim-link",x={"<":"&lt;",">":"&gt;","&#":"&#","&":"&amp;","'":"&#039;",'"':"&quot;"},_={ERASE:1,ONLY_TEXT:2},T=[{name:"a",attrs:["href"]},{name:"b",attrs:[""]}],S={script:_.ERASE,xmp:_.ERASE,iframe:_.ERASE,object:_.ERASE,button:_.ERASE,inpuLINK:2,LITERAL:3}),A=function(){function e(t){var n=t.type,r=t.parent,i=t.mobile;g()(this,e),this.type=n,this.parent=r,this.mobile=i}return y()(e,[{key:"toHTML",value:function(){return""}},{key:"_toString",value:function(){return""}}]),e}(),M=function(eis,t),n=u()(this,p()(t).call(this,e)),n.children=[],n}return f()(t,e),y()(t,[{key:"addChild",value:function(e){this.children.push(e)}},{key:"fail",value:function(){if(this.parent){var e=this.parent.children.indexOf(this);e>-1&&(this.parent.children[e]=new C({value:this._toString(),parent:this.parent,mobile:this.mobile}))}return this.parent}},{key:"toHTML",value:function(){switch(this.type){case E.ROOT:return this.children.reduce(function(e,t){return e+=t.toHTML()},"");case E.STRONG:return'<b class="aim-strong" '.concat(this.children[1]?'style="font-size: '.concat(this._childToHTML(1),';"'):"",">").concat(this._childToHTML(0),"</b>");case E.LINK:return'<a href="'.concat(this._childToString(1),'" data-link="').concat(this._childToString(1),'" class="').concat(k,'">').concat(this._childToHTML(0),"</a>");default:return""}}},{key:"_toString",value:function(){switch(this.type){case E.STRONG:return"{{".concat(E[this.type].toLowerCase(),"$").concat(this._childToHTML(0),"}");case E.LINK:return"{{".concat(E[this.type].toLowerCase(),"$").concat(this._childToHTML(0),"$").concat(this._childToString(1dren[e]?this.children[e]._toString():""}},{key:"_childToHTML",value:function(e){return this.children[e]?this.children[e].toHTML():""}}]),t}(A),C=function(e){function t(e){var n,r=e.value,i=e.parent,o=e.mobile,a=e.parse,s=void 0===a||a;return g()(thise:E.LITERAL,parent:i,mobile:o})),n.value=r,n.parse=s,n}return f()(t,e),y()(t,[{key:"toHTML",valuest(e)?e=e.replace(R,function(e,t){return'<a href="'.concat(t,'" data-link="').concat(t,'" class="').concat(k,'">').concat(t,"</a>")}):F.test(e)&&"no"!==this.mobile&&(e=e.replace(F,'<a href="javascript:void(0)" data-link="tel:$$1$2$3" class="'.concat(k,'">$1-$2-$3</a>')))),e}}]),t}(A),I=function(){function e(){g()(this,e),this._parsed=null,this._root=null,this._cursor=0,this._literalBuffer=[]}return y()(e,[{key:"parse",value:function(e){var t=e.source,n=e.mobile;for(this._literalBuffer.length=0,this._cursor=0,this._source=t.replace(/(<)|(>)|(&#)|(&)|(')|(")/g,function(e){return x[e]}),this._origin=this._source,this._mobile=n,this._root=new M({type:E.ROOT,mobile:this._mobile});this._cursor<this._source.length;)this._parseQuotes(this._root,!0,!1);return this._root.toHTML()}},{key:"_parseQuotes",value:function(e,t,n){for(var r=!1;this._cursor<this._source.length;){var i=this._source[this._cursor];switch(i){case"{":if(!r&&"{"===this._source[this._cursor+1]){if(this._addLiteral(e,t),this._cursor+=2,this._parseExprs(e))return;continue}this._literalBuffer.push(i);break;case"\\":r=!r,r||this._literalBuffer.push("\\"),this._cursor++;continue;case"$":if(!r&&n)return void this._addLiteral(e,t);this._literalBuffer.push(i);break;case"}":if(e!==this._root&&!r&&"}"===this._source[this._cursor+1])return void this._addLiteral(e,t);this._literalBuffer.push(i);break;default:this._literalBuffer.push(i)}r=!1,this._cursor++}this._literalBuffer.length&&this._addLiteral(e,t)}},{key:"_parseQuote",value:function(e){for(var t=!1;this._cursor<this._source.length;){var n=this._source[this._cursor];if(!t&&("}"===n&&"}"===this._source[this._cursor+1]||"$"===n))break;"\\"===n&&(t=!t)?this._cursor++:(t=!1,this._literalBuffer.push(n),this._cursor++)}return!!this._literalBuffer.length&&(this._addLiteral(e,!1),!0)}},{key:"_addLiteral",value:function(e,t){this._literalBuffer.length&&(e.addChild(new C({value:this._literalBuffer.join(""),parent:e,parse:t})),this._literalBuffer.length=0)}},{key:"_parseExprs",value:function(e){var t=this._source.slice(this._cursor,this._source.length).match(/(link)|(strong)/);return t&&t.length?(t[1]?(this._cursor+=t[1].length,this._parseLink(e)):(this._cursor+=t[2].length,this._parseStrong(e)),!0):(this._literalBuffer.push("{{"),this._addLiteral(e),!1)}},{key:"_parseLink",value:function(e){var t=new M({type:E.LINK,parent:e});e.addChild(t);var n=this._source[this._cursor++];"$"===n?(this._parseQuotes(t,!1,!0),n=this._source[this._cursor++],"$"===n&&this._parseQuote(t)?(n=this._source[this._cursor],"}"!==n||"}"!==this._source[this._cursor+1]?t.fail():this._cursor+=2):t.fail()):t.fail()}},{key:"_parseStrong",value:function(e){var t=new M({type:E.STRONG,parent:e});e.addChild(t);var n=this._source[this._cursor++];"$"===n?(this._parseQuotes(t,!1,!0),n=this._source[this._cursor],"$"===n?(this._cursor++,this._parseQuote(t,!1,!0)?(n=this._source[this._cursor],"}"!==n||"}"!==this._source[this._cursor+1]?t.fail():this._cursor+=2):t.fail()):"}"!==n||"}"!==this._source[this._cursor+1]?t.fail():this._cursor+=2):t.fail()}}]),e}(),R=/(https?:\/\/([\w/:%#\$\?\(\)~\.=\+\-]|\&amp;)+)/gim,F=/(\d{2,4})-(\d{2,4})-(\d{3,4})/gim,O=new I,N=!1,L=/{\$[^}]+}/,j={},B=function(e){return e.replace(/\[\[runtime\]\]([\ion(ereturn Object.keys(e).filter(function(n){return!(t&&!e[n])}).map(function(t){return"".concat(t,"=").concat(encodeURIComponent(e[t]))}).join("&")},ignoreUnreplaced:function(e){return Object.keys(e).reduce(function(t,n){return L.test(e[n])||(t[n]=e[n]),t},{})},assign:function(e,t){return Object.assign(e,t)}})})},P=function(){function e(){g()(this,e)}return y()(e,null,[{key:"convertAuto",value:function(e){return a(),j[e]?j[e]:j[e]=B(e).split("\n").map(function(e){return r(e)})}},{key:"convertToSafeTemplateExprs",value:function(e,t){return t&&(a(),e=b()(e)),e.replace(/(\{)|(\})|(\&\#)/g,function(e,t,n,r){return t?"aim_tmpl@@":n?"@@aim_tmpl":r?"@aim_ref@":e})}},{key:"restoreSafeTemplateExprs",value:function(e){return e.replace(/(aim_tmpl\@\@)|(\@\@aim_tmpl)|(\@aim_ref\@)/g,function(e,t,n,r){return t?"{":n?"}":r?"&#":e})}},{key:"convertText",value:function(e){if(a(),j[e])return j[e];var t=[],n=B(e).replace(/\[\[html\]\]([\s\S]+?)\[\[\/html\]\]/g,function(e,n){return n?(t.push(n),"$$".concat(t.length-1,"$$").concat("__$$DELIM$$__")):e}).split("\n").reduce(function(e,t){var n=t.split("__$$DELIM$$__");return e.concat(n.map(function(e){if(e.indexOf("$$")>-1)return{html:!0,text:e};var t=r(e);return{html:t!==e,text:t}}))},[]);return t.length?j[e]=t.map(function(e){return s(e).replace(/^\s+|\s+$/g,"")}).reduce(function(e,t,n){var i="$$".concat(n,"$$");return e.map(function(e){var n=e.html,o=e.text;return n?{html:n,text:o.replace(i,t)}:{html:n,text:r(o)}})},n).map(function(e){return e.text}):j[e]=n.map(function(e){return e.text})}}]),e}()},,function(e,t,n){"use strict";n.d(t,"a",fu.cookie.replace(new Re:a="; expires="+n.toGMTStm",value:function(e,t)"hasItem",value:fun|\s*;)[^\{function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.exports=n},,function(e,t,n){"usc").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";var r,i=n(2),o=n.n(i),a=n(3),s=n.n(a),c=n(1),u=n.n(c),l=(n(9),n(179)),p=n(9turn s()(e,[{key:"implement",value:function(){p.a.trigger(l.a.implement,function(e){u.a.mount("quickReplyField","qr-implantation",e)})}},{key:"mount",value:function(){p.a.trigger(l.a.mount,function(){})}},{key:"setReplies",value:function(e){p.a.trigger(l.a.setReplies,function(){return e})}},{key:"show",value:functiorn!0})}},{key:"hide",value:function(e){var t=e.animation,n=void 0===t||t;p.a.trigger(l.a.hide,function(){return{show:!1,animation:n}})}},{key:"allClear",value:function(){p.a.trigger(l.a.allClear,function(e){})}}]),e}())||r;t.a=f},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"customer",r=c.a.get({customer:{id:"dummy"}});return{attachment:e,meta:{clientOriginMessageId:n.i(s.a)()},sender:{senderType:t,id:r.customer.id},createdAt:(new Date).getTime()}}function i(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],c.a.get({customer:{id:"dummy"}});return r({mediaType:"plainText",payload:e})}function o(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],c.a.get({customer:{id:"dummy"}});return r({mediaType:"image",payload:{imageType:"plainImage",url:URL.createObjectURL(e)}})}function a(){return{attachment:{mediaType:"typing"},sender:{senderType:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"operator"}}}t.d=r,t.b=i,t.c=o,t.a=a;var s=n(185),c=n(28)},function(e,t,n){"use strict";(function(e){var r=n(55),i=n.n(r),o=n(17),a=n.n(o),s=n(16),c=n.n(s),u=n(100),l=(n.n(u),n(1)),p=n.n(l),h=(n(9),n(202),n(32)),f=n(33),d=n(72),g=n(41),m=n(26),y=n(73),v=(new d.a,new f.a),b=new m.a,w=/image\/(?:png|jpeg|gif|webp)/,k={messages:{},postMessages:function(){var e=c()(a.a.mark(function e(t){var n,r,i,o=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],r=!(o.length>2&&void 0!==o[2])||o[2],t=k.trimInput(t),n=k.insertDummy(t,n,!1,r),i=g.a.instance,e.abrupt("return",i.createMessage(n));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),postFile:function(){var t=c()(a.a.mark(function t(n){var r,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(w.test(n.type)){t.next=3;break}return v.pushError("対応していないファイルです。\n送信可能な画像ファイルはPNG/JPEG/GIF形式です"),t.abrupt("return",e.reject());case 3:return r=k.insertDummy(n,null,!1,!0),i=g.a.instance,r.file=n,t.abrupt("return",i.createMessage(r,!0));case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),insertDummy:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a="undefined"!=typeof File&&e instanceof File;if("string"==typeof e?(e=k.trimInput(e),t||(t=r||n.i(y.b)(e),"quickReplyPostback"===t.attachment.mediaType&&(t.sender={senderType:"customer"}))):a&&(t=n.i(y.c)(e)),o&&(v.pushNewMessage(t),!a&&h.a.isAssignedToBot&&v.pushTyping(n.i(y.a)("bot"),0)),h.a.typingEnable&&!a&&(null===r||!r.attachment||"object"===i()(r.attachment.payload)&&!r.attachment.payload.quickReply.payload.match(/^CALL_OPERATOR:.*:(.*)$/))){v.setTypingActors(["bot"]);var s=n.i(y.a)("bot"),c=Math.floor(1e3*Math.random())+500;v.pushTyping(s,c)}return"NECESSARY"==RegExp.$1&&v.setTypingEnable(!1),t},sendMessagesFromAwrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=g.a.instance,i=e.all([r.startConversation()].concat(n.map(function(e){return b.pushSendMessagesFromAiMessenger(),k.pt("return",i);case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),trimInput:function(e){return e.trim().replace(/^[　]+|[　]+$/g,"").substr(0,1e3)}};p.a.mixin("messages",k),t.a=k}).call(t,n(11))},function(e,t,n){"use strict";n.d(t,"a",function(){return x});var r,i=n(67),o=n.n(i),a=n(2),s=n.n(a),c=n(3),u=n.n(c),l=n(174),p=n.n(l),h=n(91),f=n.n(h),d=n(372),g=n.n(d),m=n(173),y=n.n(m),v=n(46),b=n(27),w=n(56),k="__aim_messages_info_".concat(w.b),x=n.i(b.a)(r=function(e){function t(){var e;return s()(this,t),e=p()(this,f()(t).call(this,k)),e._removeQueue=[],e}return y()(t,e),u()(t,[{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unsigned-".concat(+new Date),n=this.getMessages(),r=n.messages;r[t]={message:e},this.setMessages(r)}},{key:"updateMessageId",value:function(e,t){var n=t.messageId,r=t.messageHash,i=this.getMessages(),o=i.messages;if(o[e])if(-1===this._removeQueue.indexOf(e)){var a=o[e].message;o[e]={message:a,messageId:n,messageHash:r}}else delete o[e];this.setMessages(o)}},{key:"remove",value:function(e){var t=this.getMessages(),n=t.messages;for(var r in n)n[r].messageId==n)}},{key:"removeBySign",value:function(e){var t=this.getMessages(),n=t.messages;n[e]&&delete n[e],this.setMessages(n)}},{key:"reset",value:function(){g()(f()(t.prototype),"reset",this).call(this)}},{key:"getMessages",value:function(){return g()(f()(t.prototype),"isExists",this).call(this,"messages")?g()(f()(t.prototype),"get",this).call(this,"messages"):o()({},"messages",{})}},{key:"setMessages",value:function(";n.d(t,"a",function(){return u});var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=[1],c=[],u=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];i()(thiey:"get",value:function(){return this._flag?s:c}},{key:"or",value:function(t){return t||(t=!1),t instanceof e&&(t=t.valueOf()),this._flag||t?s:c}},{key:"not",value:function(){return this._flag?c:s}},{key:"set",value:function(e){return this._flag=e}},{key:"valueOf",value:function(){return this._flag}}]),e}()},,function(e,t,n){(function(t,n){(function(){!function(e){"use strict";function n(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e=String(e)),e}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return v.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function a(e){if(e.bodyUsed)return t.reject(new TypeError("Already read"));e.bodyUsed=!0}function s(e){return new t(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function c(e){var t=new FileReader,n=s(t);return t.readAsArrayBuffer(e),n}function u(e){var t=new FileReader,n=s(t);return t.readAsText(e),n}function l(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function p(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(v.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(v.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(v.arrayBuffer&&v.blob&&w(e))this._bodyArrayBuffer=p(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!k(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=p(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return t.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return t.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return t.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?a(this)||t.resolve(this._bodyArrayBuffer):this.blob().then(c)}),this.text=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return t.resolve(l(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return t.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(e){var t=e.toUpperCase();return x.indexOf(t)>-1?t:e}function d(e,t){t=t||{};var n=t.body;if(e instanceof d){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=f(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function g(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function m(e){var t=new o;return e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new o(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var v={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(v.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=function(e){return e&&DataView.prototype.isPrototypeOf(e)},k=ArrayBuffer.isView||function(e){return e&&b.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,t){e=n(e),t=r(t);var i=this.map[e];this.map[e]=i?i+","+t:t},o.prototype.delete=function(e){delete this.map[n(e)]},o.prototype.get=function(e){return e=n(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(n(e))},o.prototype.set=function(e,t){this.map[n(e)]=r(t)},o.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),i(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),i(e)},v.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var x=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},h.call(d.prototype),h.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];y.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=d,e.Response=y,e.fetch=function(e,n){return new t(function(t,r){var i=new d(e,n),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:m(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var n="response"in o?o.response:o.responseText;t(new y(n,e))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials&&(o.withCredentials=!0),"responseType"in o&&v.blob&&(o.responseType="blob"),i.headers.forEach(function(e,t){o.Object.getOwnPropertySymf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){function r(e,t){return i(e)||o(e,t)||a()}var i=n(369),o=n(374),a=n(375);e.exports=r},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=(n(9),n(177)),c=n(10),u=function(){function e(){i()(this,e)}return a()(e,[{key:"setEnv",value:function(e){c.a.trigger(s.a.setEnv,function(t){return e})}},{key:"iframeAdjust",value:function(){c.a.trigger(s.a.iframeAdjust,function(){})}},{key:"setUnreadMessagesCount",value:function(e){c.a.trigger(s.a.setUnreadMessagesCkey:"setChatLoading",value:function(e){c.a.trigger(s.a.setChatLoading,function(){return{flag:e}})}},{key:"setWallMessage",value:function(e){c.a.trigger(s.a.setWallMessage,function(){return{message:e}})}}]),e}()},function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(1),c=n.n(s),u=n(9),l=n(179),p=new(function(){function e(){i()(this,e),c.a.observable(this),this._replies={},this._quickReplyShow=!1,this.on(l.a.implement,this._implement.bind(this)),this.on(l.a.mount,this._mount.bind(this)),this.on(l.a.setReplies,this._setReplies.bind(this)),this.on(l.a.show,this._show.bind(this)),this.on(l.a.hide,this._hide.bind(this)),this.on(l.a.allClear,this._allClear.bind(this))}return a()(e,[{key:"replies",get:function(){return this._replies}},{key:"quickReplyShow",get:function(){return this._quickReplyShow}}]),a()(e,[{key:"_implement",value:function(e){e(this._replies),u.a.trigger("QuickReplies",this.ActionTypes.implement)}},{key:"_mount",value:function(e){u.a.trigger("QuickReplies",this.ActionTypes.mount)}},{key:"_setReplies",value:function(e){this._replies=e(this._replies)}},{key:"_show",value:function(e){this._quickReplyShow=e(this._quickReplyShow),u.a.trigger("QuickReplies",this.ActionTypes.show)}},{key:"_hide",value:function(e){var t=e(this._quickReplyShow),n=t.show,r=t.animation;this._quickReplyShow=n,u.a.trigger("QuickReplies",this.ActionTypes.hide,r)}},{key:"_allClear",value:function(e){u.a.trigger("QuickReplies",this.ActionTypes.allClear)}}]),e}());p.ActionTypes={implement:"quickreplies_store_implement",mount:"quickreplies_store_mount",replies:"quickreplies_store_replies",show:"quickreplies_store_show",hide:"quickreplies_store_hide",allClear:"quickreplies_store_allClear"},u.a.addStore("QuickReplies",p),t.a=p},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){for(var t in e)e[t]="".concat(e[t]);return e}},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r,i=n(2),o=n.n(i),a=n(3),s=n.n(a),c=n(27),u=n.i(c.a)(r=function(){function e(){o()(this,e)}return s()(e,[{key:"ua",get:function(){nction(){return this._device}},{key:"version",get:function(){return this._version}},{key:"isViewable",get:function(){return this._isViewable}},{key:"isMobile",get:function(){return"PC"!==this._device}}]),s()(e,[{key:"init",value:function(e){this._ua=e(window.navigator.userAgent),this._initConf=window.swallow_widget_initial_configs||parent.window.swall._getVersion(this._ua),this._isViewable=this._getViewable(this._ua,this._initConf.viewable)}},{key:"_getDevice",value:function(e){return/Android/.test(e)?"Android":/iP(hone|od|ad)/.test(e)?"iOS":"PC"}},{key:"_getViewable",value:function(e,t){return this._deviceViewableCheck(e,t)&&this._ieViewableCheck(e)&&this._androidViewableCheck(e)&&this._iosViewableCheck(e)&&this._localStorageCheck()}},{key:"_getVersion",value:function(e){switch(this._getDevice(e)){case"Android":return this._getAndroidVersion(e);case"iOS":return this._getIosVersion(e);default:return 0}}},{key:"_deviceViewableCheck",value:function(e,t){return!(t.indexOf(this._getDevice(e).toLowE/.test(e)||/Trident/.test(e)){if(parseFloat(e.match(/(MSIE\s|rv:)([\d\.]+)/)[2])<=9)return!1}return!0}},{key:"_getAndroidVersion",value:function(e){return parseFloat(e.slice(e.indexOf("Android")+8))}},{key:"_androidViewableCheck",value:function(e){if(/Android/.test(e)){if(this._getAndroidVersion(e)<4.4)return!1;if(/Linux; U;/.test(e)&&!/Chrome/.test(e))return!1}return!0}},{key:"_getIosVersion",value:function(e){var t=e.match(/iP(hone|od|ad).+?OS (\w+){1,3}/);return parse)<8)return!1}retion(e,t){f(this,4,e,c,t,aect.getOwnPropertyNames(r).indexOf("regeneratorRuntime"rict";function r(e,t,n,r){var i=t&&t.proe.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(b.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=y,t.done=!0,t};return r.next=r}}return{next:m}}function m(){return{value:y,done:!0}}var y,v=Object.prototype,b=v.hasOwnProperty,w="function"==typeof Symbol?Symbol:{},k=w.iterator||"@@iterator",x=w.asyncIterator||"@@asyncIterator",_=w.toStringTag||"@@toStringTag",T="object"==typeof e,S=n.regeneratorRuntime;if(S)return void(T&&(e.exports=S));S=n.regeneratorRuntime=T?e.exports:{},S.wrap=r;var E="suspendedStart",A="suspendedYield",M="executing",C="completed",I={},R={};R[k]=function(){retureate(RnstructoFunction"===(t.displayName||t.name))},S.mark=function(e){return Object.setPrototreturn{__await:e}},c(u.prototype),u.prototype[x]=function(){return this},S.AsyncIterator=u,S.async=function(urn this},N.toString=function(){return"[objeon(e)his.tryEntries.for,!0);iflyLoc")&&ompleteethod=n.afterLoc),f(r return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:g(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=y),I}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())}).call(t,n(11))},function(e,t,n){"use strict";var r=n(45),i=(n.n(r),n(395)),o=(n.n(i),n(57));n(1).tag2("chat-messaage-balloon",'<yield from="chatMessaageBalloonStyle"></yield> <yield from="mediaTypeBaseStyle"></yield> <div class="message-balloon html-message"> <rawcontent content="{content}"></rawcontent> </div>',"","",function(e){var t=this;this.content="",this.on("mount",function(){t.content=e.markdown?e.payload:t.parent.createHTMLReplacedText(o.a.restoreSafeTemplateExprs(e.payload),"customer"===e.sender).map(function(e){return t.parent.convertToSafeTemplateExprs(e)}).join("\n"),t.update()})})},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=String.fromCharCode(0xfffffffffffff),i={TYPING:"".concat(r,"-typing"),NEW:"".concat(r,"-new"),WELCOME_MSG:"0000-welcome-msg"}},function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(1),c=n.n(s),u=n(9),l=n(178),p=new(function(){function e(){i()(this,e),c.a.observable(this),this._tenantId="",this._userId="",this._conversationId="",this._tags=[],this._logs={},this._receivedMessages=[],this._pushReceivedMessageIdsFlag=!1,this.on(l.a.sendError,this._sendError.bind(this)),this.on(l.a.setUser,this._setUser.bind(this)),this.on(l.a.setConversation,this._setConversation.bind(this)),this.on(l.a.setTenant,this._setTenant.bind(this)),this.on(l.a.pushTag,this._pushTag.bind(this)),this.on(l.a.removeTag,this._removeTag.bind(this)),this.on(l.a.pushReceivedMessageId,this._pushReceivedMessageId.bind(this)),this.on(l.a.erasePushedLogs,this._erasePushedLogs.bind(this)),this.on(l.a.erasePushedReceivedMessageIds,this._erasePushedReceivedMessageIds.bind(this)),this.on(l.a.setPushReceivedMessageIdsFlag,this._setPushReceivedMessageIdsFlag.bind(this))}return a()(e,[{key:"userId",get:function(){return this._userId}},{key:"tenantId",get:function(){return this._tenantId}},{key:"conversationId",get:function(){return this._conversationId}},{key:"tags",get:function()ogs}},{key:"widgetOpened",get:function(){return this._widgetOpened}},{key:"receivedMessages",get:function(){return this._receivedMessages}}]),a()(e,[{key:"_sendError",value:function(e){e(this.userId,this.tenantId,this.conversationId)}},{key:"_setUser",value:function(e){this._userId=e(this._tenantId,this._conversationId)}},{key:"_setConversation",value:function(e){this._conversationId=e(this._tenantId,this._userId)}},{key:"_setTenant",value:function(e){this._tenantId=e(this._userId,this._conversationId)}},{key:"_pushTag",value:function(e){var t=e(this._tags,this._logs),n=t.tags,r=t.logs;this._tags=n,this._logs=r}},{key:"_removeTag",value:function(e){this._tags=e(this._tags)}},{key:"_pushReceivedMessageId",value:function(e){this._receivedMessages=e(this._receivedMessages),this._pushReceivedMessageIdsFlag&&u.a.trigger("Error",this.ActionTypes.pushReceivedMessageId)}},{key:"_setPushReceivedMessageIdsFlag",value:function(e){this._pushReceivedMessageIdsFlag=e(this._pushReceivedMessageIdsFlag)}},{key:"_erasePushedLogs",value:function(e){this._logs=e(this._logs)}},{key:"_erasePushedReceivedMessageIds",value:function(e){this._receivedMessages=e(this._receivedMessages)}}]),e}());p.ActionTypes={pushReceivedMessageId:"error_store_pushreceivedmessageid"},u.a.addStore("Error",p),t.a=p},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=(n(59),n(46)),c=n(56),u="__aim_auth_".concat(c.b),l=null,p=function(){function e(){i()(this,e)}return a()(e,null,[{key:"set",value:function(e){e.expirationDate=e.expirationDate=Date.now()+1e3*e.expires_in,s.a.setItem(u,e),l=null}},{key:"get",value:function(){return l||(s.a.hasItem(u)?l=JSON.parse(s.a.getItem(u)):null)}},{key:"remove",value:function(){s.a.removeItem(u),l=null}},{key:"isExists",value:function(){return!!this.get()}},{key:"isExpired",value:function(){var e=this.get();return!!e&&e.expirationDate<Date.now()}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return g});var r=n(67),i=n.n(r),o=n(2),a=n.n(o),s=n(3),c=n.n(s),u=n(46),l=n(10),p=n(56),h="__aim_widget_status_".concat(p.b),f=null,d=null,g=function(){function e(){a()(this,e)}return c()(e,null,[{key:"set",value:function(e,t){var n=this.get();n[e]=t,u.a.setItem(h,n),f=null}},{key:"get",value:function(){return f||(u.a.hasItem(h)?f=JSON.parse(u.a.getItem(h)):{})}},{key:"setUnreads",value:function(e){this.get();if(l.a.conversationId){var t=this.get();t.readMessagesCount&&t.readMessagesCount[l.a.conversationId]?t.readMessagesCount[l.a.conversationId]=e:t.readMessagesCount=i()({},l.a.conversationId,e),u.a.setItem(h,t),d=null}}},{key:"getUnreads",value:function(){if(l.a.conversationId){if(d)return d;if(u.a.hasItem(h)){var e=JSrsationId&&e.readMessagCount[l.a.conversationId]}}return 0}},{key:"remove",value:function(e){var t=this.get();delete t[e],u.a.setItem(h,t),f=null}},{key:"reset",value:function(.get()}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(17),i=n.n(r),o=n(16),a=n.n(o),s=n(2),c=n.n(s),u=n(3),l=n.n(u),p=function(){function e(t,n,r){c()(this,e),this._ok=t,this._status=n,this._response=r}return l()(e,[{key:"ok",get:function(){return this._ok}},{key:"status",get:function(){return this._status}},{key:"response",get:function(){return this._response}}]),e}(),h=function(){function e(){c()(this,e)}return l()(e,null,[{key:"create",value:function(){var e=a()(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.ok?t.json():t.text(var t=this,n=I0),o=n.slice().reverse().red,t,n){function r(e,t){if("function"!=type or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}var i=n(377);e.exports=r},function(e,t,n){function r(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?o(e):t}var i=n(55),o=n(371);e.exports=r},function(e,t,n){n(1).tag2("yield","",".loading-wrapper { opacity: 0; } .loading-wrapper.loading { opacity: 1; } .loading-wrapper .loader { width: 100%; height: 100%; margin: 0; z-index: 99; backface-visibility: hidden; transform-style: preserve-3d; animation: 0.2s fade-for-loading-wrapper ease alternate; -webkit-animation: 0.2s fade-for-loading-wrapper ease alternate; transition: opacity 0.2s; } .loading-wrapper .loader .bit { width: 100%; height: 100%; box-shadow: none; border: 1px solid #0cf; border-radius: 50%; border-left-color: transparent; backface-visibility: hidden; transform-style: preserve-3d; animation: 0.75s linear infinite spin; -webkit-animation: 0.75s linear infinite spin; } .loading-wrapper .loader .bit:after { left: -1px; top: -1px; display: block; position: absolute; content: ''; width: 100%; height: 100%; border: inherit; border-radius: inherit; border-color: transparent; border-top-color: #ff9900; backface-visibility: hidden; transform-style: preserve-3d; animation: 1.75s linear reverse infinite spin; -webkit-animation: 1.75s linear reverse infinite spin; } .loading-wrapper .loader { margin: 0 !important; } @keyframes fade-for-loading-wrapper { 0% { opacity: 0 } 100% { opacity: 1 } } @-webkit-keyframes fade-for-loading-wrapper { 0% { opacity: 0 } 100% { opacity: 1 } } @keyframes spin { 0% { transform: rotate(0deg); -webkit-transform: rotate(0deg); } 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg); } } @-webkit-keyframes spin { 0% { transform: rotate(0deg); -webkit-transform: rotate(0deg); } 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg); } }",'to="loaderBitStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","",'plainText { width: 100%; display: block; margin-right: 5px; margin-bottom: 0px; white-space: normal; word-break: break-all; font-family: "Helveticica,"ヒラギノ角ゴ Pro W3","Hiragino Kaku Gothic Pro","メイリオ",Meiryo,"Meiryo UI","ＭＳ Ｐゴシック","MS PGothic",sans-serif; } plainText:after { content: ""; display: block; clear: both; height: 0px; width: 0px; }','to="plainTextStonReady:"talks_action_setconversationready",getWelcomeMessages:"talks_action_getwelcomemessages",incrementConversationCount:"talks_action_increment_conversationcount",unboundStream:"talks_action_unbound_stream",setYconnectAuthUrl:"talks_action_set_yconnect_auth_url"}},function(e,t,n){"use strict";(function(e){var r=n(17),i=n.n(r),o=n(16),a=n.n(o),s=n(1),c=n.n(s),u=(n(9),n(74),n(69)),l=n(10),p=n(32),h=n(33),f=n(26),d=n(41),g=n(93),m=n(132),y=n(28),v=n(440),b=n(75),w=n(184),k=n(73),x=h.a.instance,_=new f.a,T=new g.a,S=b.a.instance,E=w.a.instance,A=null,M={prefix:"",init:function(){var t=a()(i.a.mark(function t(){var n,r,o=this;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,void 0!==l.a.envPrefix&&"undefined"!=l.a.envPrefix&&(M.prefix="".concat(l.a.envPrefix,"/")),!((n=y.a.get())&&n.customer&&n.customer.conversationId)){t.next=12;break}retunext=8,this.authFirebase();case 8:T.setEnv({conversationId:r.conversationId}),this.bindConversation(r.tenantId,r.conversationId).then(function(){T.setChatLoading(!1),x.sendMessagesFromAiMessenger(),o.waitFirstChildAdded()}).catch(function(e){_.sendError(new Error(e))}),t.next=13;break;case 12:x.sendMessagesFromAiMessenger();case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),"prod"!==l.a.envPrefix&&console.error(t.t0),_.sendError(new Error(t.t0),t.t0);case 19:return t.abrupt("return",e.resolve());case 20:case"end":return t.stop()}},t,this,[[0,15]])}));return function(){return t.apply(this,arguments)}}(),authFirebase:function(){var e=a()(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.a.instance,e.prev=1,e.next=4,t.waitRetry(d.b.FIREBASE_AUTH);case 4:return v.a.set(),e.next=7,t.apiAuth();case 7:return n=m.a.get(),e.next=10,firebase.auth().signInWithCustomToken(n.firebaseToken);case 10:e.next=19;break;case 12:return e.prev=12,e.t0=e.catch(1),m.a.removeuth();case 17:E.isTimeout(d.b.FIREBASE_AUTH)||(E.add(d.b.FIREBASE_AUTH),this.authFirebase()),_.sendError(new 12]])}));return function(){return e.apply(this,arguments)}}(),unboundStream:function(){A&&A()},checkFirebaseAuth:function(){var t=this;return A&&v.a.isChanged()?(A(),A=null,firebase.auth().signOut().then(function(){return t.init()},function(e){return console.error(e)})):e.resolve()},isConversationClosed:function(){var e=a()(i.a.mark(function e(t){var n,r,o,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.archives,e.prev=1,e.next=4,n.once("value");case 4:if(r=e.sent,o=r.val(),!(a=o.customer)||a.id!==l.a.userId){e.next=15;break}return x.conversationReset({key:"from-firebase-mixin",retryHash:"from-firebase-mixin"}),x.removeAllMessages(),e.next=12,x.pushAllWelcomeMessage(parent.aiMessenger.welcomeMessageTextAdditions);case 12:return e.abrupt("return",!0);case 15:return T.setChatLoading(!1),e.abrupt("return",!1);case 17:e.next=24;break;case 19:return e.prev=19,e.t0=e.catch(1),T.setChatLoading(!1),e.abrupt("return",!1);case 24:case"end":return e.stop()}},e,this,[[1,19]])}));return function(t){return e.apply(this,arguments)}}(),bindConversation:function(t,r){var o=this;return d.a.instance.setAdditional(l.a.additional),new e(function(){var e=a()(i.a.mark(function e(s,c){var h,f,g,m,v,b,w,T,E,C;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r||p.a.boundConversation){e.next=37;break}return x.setBoundConversation(!0),h=firebase.database().ref("".concat(M.prefix).concat(t,"/messages/").concat(r)).orderByChild("createdAt"),f=firebase.database().ref("".concat(M.prefix).concat(t,"/conversations/").concat(r)),g=firebase.database().ref("".concat(M.prefix).concat(t,"/conversationEvents/").concat(r,"/typingActors")),m=firebase.database().ref("".concat(M.prefix).concat(t,"/conversationEvents/").concat(r,"/status")),v=firebase.database().ref("".concat(M.prefix).concat(t,"/archives/").concat(r)),e.prev=7,e.next=10,o.isConversationClosed({archives:v});case 10:if(b=e.sent,x.setConversationReady(!b),!b){e.next=16;break}return e.abrupt("return",c("conversation was closed"));case 16:x.sendMessagesFromAiMessenger();case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),_.sendError(new Error(e.t0),e.t0);case 22:return w=1/0,T=0,E=1e3,C=function e(){T<=w&&(T=Date.now(),setTimeout(e,E)),p.a.isInitialMessage=!1},setTimeout(C,E),h.on("child_added",function(){var e=a()(i.a.mark(function e(t,n){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("customer"!==t.key){e.next=2;break}return e.abrupt("return");case 2:return isFinite(w)||t.key,e.next=7,x.clearMessageTimer(r);case 7:S.remove(r);case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()),h.on("child_changed",function(e,t){x.pushMessage(e)}),h.on("child_removed",function(e,t){x.removeMessage(e)}),f.on("value",function(e,t){var n=e.val();x.notifyChangeAssigneeStatus(n.assignee.actor),"bot"!==n.assignee.actor?x.setTypingEnable(!1):x.setTypingEnable(!0),null===n&&(y.a.removeConversationId(),l.a.inputComponent.setDisable())}),g.on("value",function(e,t){x.clearAllTypingEndTimer();var r=e.val();if(r&&0!==Object.keys(r).length){var i=[];if(Object.keys(r).forEach(function(e){i.push(r[e].chatActor),x.setTypingEndTimer(r[e].chatActor,r[e].expiresAt)}),!n.i(u.a)("typing")){var o=Math.floor(1e3*Math.random())+500;x.setTypingActors(["operator"]);var a=n.i(k.a)();x.pushTyping(a,o)}x.setTypingActors(i)}else x.removeTyping()}),m.on("value",function(e,t){"closed"===e.val()&&(_.pushConversationClosed(),x.setConversationReady(!1),d.a.instance.setConversationResetFlag(!0))}),A=function(){x.setBoundConversation(!1),x.setConversationReady(!1),h.off("child_added"),h.oabrupt("return",s());case 37:return e.abrupt("return",c());case 38:case"end":return e.stop()}},e,this,[[7,19]])}));return function(t,n){return e.apply(this,arguments)}}())},waitFirlag(!0)},1e3)}};c.a.mixin("firebase",M),t.a=M}).call(t,n(11))},,function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r,i=n(2),o=n.n(i),a=n(3),s=n.n._fetchRetryCount={},this._totalWaitTime={}}return s()(e,[{key:"add",value:function(e){this._initRetryCount(e),this._fetchRetryCount[e]+=1,this(e){this._fetchRetryCount[e]=0,this._totalWaitTime[e]=0}},{key:"getWaitTime",value:function(e){return this._initRetryCount(e),1e3*Math.pow(2,this._fetchRetryCount[e])-1e3}},{key:"getRetryCount",value:function(e){return this._initRetryCount(e),this._fetchRetryCount[e]}},{key:"isTimeout",value:function(e){return this._initRetryCount(e),12e4<=this._totalWaitTime[e]}},{key:"_initRetryCount",value:function(e){void 0==emponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=n},,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(9),i=n(94),o=n(72),a=n(41),s=n(10),c=n(26),u=n(57),l=n(69),p=n(45),h=(n.n(p),n(398)),f=(n.n(h),n(129),n(1));f.tag2("quickreply",'<yield from="quickReplyStyle"></yield> <yield from="mediaTypeBaseStyle"></yield> <div class="message {opts.sender} {opts.showDateOnBottom? \'show-date-on-bottom\': \'\'}"> <div class="message-balloon-wrapper {opts.showDate? \'\': \'not-show-date\'}" data-dateformat="relative" data-information="{this.diffTime(opts.datetime)}"> <chat-messaage-balloonateExprs(opts.payload.text, !!opts.md)}"></chat-messaage-balloon> </div> </div>',"","",function(e){this.mixin("mediaType"),this.mobile=s.a.mobile;var t=new o.a;this.on("mount",function(){if(e.payload.buttons){var n=e.payload.buttons.filter(function(e){return!!e.title});t.setReplies({buttons:n})}})}),f.tag2("qr-implantation",'<div class="{this.className}"> <p onclick="{select}" each="{opts.buttons}"> <span class="backface">{title}</span> <span class="frontface">{title}</span> </p> </div>',"","",function(e){var t=this;this.convertToSafeTemplateExprs=u.a.convertToSafeTemplateExprs,this.className="qr-scroll-area ".concat(window.Customize.talks["vertical-quickreplies"]?"qr-vertical":"");var p=new o.a,h=new a.a,f=new c.a,d=n.i(l.a)("messages");this.on("mount",function(){"no"===s.a.mobile||window.Customize.talks["vertical-quickreplies"].mount()}),r.a.one("QuickReplies{p.show()}),r.a.one("QuickReplies",i.a.ActionTypes.show,function(){t.root.classList.add("show"),Array.prototype.forEach.call(n.i(l.b)("p",t.root),function(e){setTimeout(function(){e.className+="pullup"},500*Math.random())}),setTimeout(function(){t.initTop=d.scrollTop},500)}),r.a.one("QuickReplies",i.a.ActionTypes.turn void t.unmount(!0);t.root.style.height=getComputedStyle(t.root).height,setTimeout(function(){t.root.style.height="0px",setTimeout(function(){t.root.style.height="",t.unmount(!0)},200)},100)}),r.a.on("QuickReplies",i.a.ActionTypes.allClear,function(){t.allClear()}),this.select=function(e){var t=window.parent.aiMessenger;Array.prototype.forEach.call(n.i(l.b)("p",this.root),function(t){t.onclick=void 0,t!=e.target&&(t.className="fadeOut")}),e.target.parentElement.className="pop";var r=e.item;setTimeout(function(){p.hide({}),setTimeout(function(){t.runFunctions("replyClic00)}.bind(this)})},function(e,t,n){"use strict";t.a={submit:"spinput_action_submit",delegateSubmit:"spinput_action_delegatesubmit",setInputValue:"spinput_action_set_input_value",eraseInputValue:"spinput_action_erase_input_value",blurInput:"spinput_action_blur_input"}},function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(1),a=n.n(o),s=n(9),c=new function e(){i()(this,e),a.a.observable(this)};s.a.addStore("Dummy",c)},function(e,t,n){"use strict";n.d(t,"a",function(){return i});/**
 * @fileOverview
 * @name is-css-available.js
 * @author Taketoshi Aono
 * @license
 */
var r=null,i=function(){if(null!=r)return r;var e=document.body.appendChild(document.createElemen This is probabln(319),n(171),n(315),n(316),n(317),n(318),n(170),n(251),n(320),n(355),n(356),n(344),n(345),n(350),n(353),n(354),n(348),n(351),n(349),n(352),n(346),n(347),n(300),n(301),n(302),n(303),n(304),n(307),n(305),n(306),n(308),n(309),n(310),n(311).includes},function(e,t,n){n(358),e.exports=n(13).Obje.data=p=!p}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t){e.exports=Object.is||function(e,tr(r.P,"Array",{copyWithin:n(144)}),n(60)("copyWithin")},function(e,t,n){"use strict";var r=n(0),i=n(29)(4);r(r.P+r.F*!n(25)([].every,!0),"Array"ndexOf(1,-0)<0;r(r.P+r.F*(c||!n(25)(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),n=a(t.length,t,n){"use strict";var r=n(0),i=n(103);r(r.S+r.F*n(4)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.lengtharguments[1])}})},function(e,t,non(e,t,n){var r=n(8)("toPrimitive"),i=Date.prototype;r in i|S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(M(function(){return-5!=i(4294967295,5)||2!=i.length}),"Mat(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(0);rb=w[k])&&!i(f,b)&&p(f,b,l(d,b));f.prototype=g,g.constructor=f,n=n(0),i=n(151),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=90071992nction(){return"1"!==a.call(1,void 0)})||!i(function(){a.ca{var r=n(0);r(r.S+r.F,"Object",{assign:n(157)})},function(e,t,n){var r=n(0);r(r.S,"Object",{create:n(48)})},function(e,)("freeze",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(22),i=n(30).f("getOwnPropertyNames",function(){return n(159).f})},function(e,t,n){var r=n(23),i=n(50);n(31)("getProble",function(e){return function(t){return!!r(t)&&(!e||e!e&&e(t)}})},function(e,t,n){var r=n(6);n(31)("isSealed",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n)n e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(0);r(r.S,"Object",{setPrototype0),o=n(50),a=n(20),s=n(0),c=n(6),u=n(7);s(s.S,"Reflect",{get:r.writable||!p(f))return!1;if(c=o.f(f,t)){if(c.get||c.set||!1===c.writable)return!1;c.value=n,i.f(f,t,c)}else i.f(f,t,u(0,n));return!0}return void 0!==d),p=non(){return h[n(8)("match")]=!1,oid 0===t;return!n&&r&&e.constructor===u&&o?e:i(f?new l(r&&!o?e.source:e,t):l((r=e instanceof u)?e.source:e,r&&o?c.call(e):t),n?this:p,u)};for(var d=a(l),g=0;d.length>g;)!function(e){e in u||o(u,e,{configurable:!0,get:function(){return l[e]},set:function(t){!=a.name&&s(function(){return a.call(this)})},function(e,t,n){"use strict";var r=n(147),i=n(66);e.exports=n(82)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";n(19)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},function(e,t,n){"use strict";n(19)("big"=n(15),o=n(119),a="".endsWith;r(r.P+r.F*n(106)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),s=void 0===n?r:Math.min(i(n),r),c=String(e);return a?a.call(t,c,s):t.slice(s-c.length,s)===c}})},function(e,t,n){"use strict";n(19)("fixed",function(e){retur(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){"use strict"turn function(t){return e(this,"a","href",t)}})},function(e,t,n){var r=n(0),i=n(22),o=n(15);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=o(t.length),r=argumenct";var r=n(0),i=n(15),o=n(119),a="".startsWith;r(r.P+r.F*n(106)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=Strie);for(var n=a(this).byteLength,r=s(e,n),i=s(void 0===t?n:t,n),o=new(p(this,h))(c(i-r)),u=new f(this),l=new f(o),d=0;r<i;)l.setUint8(d++,u.getUint8(r++));return o}}),n(64)("ArrayBuffer")},function(e,t,n){var r=n(0);r(r.G+r.W+r.F*!n(89).ABV,{DataView:n(123).DataView})},function(e,t,n){n(40)("Float32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(40)("Float64",8,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(40)("Int16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(40)("Int32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},functionents.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}}(13),o=n(5),a=n(87),s=n(165);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:){function n(e){);return e}e.exports=n},function(ect.getOwnPrope)}e.exports=n},function(e,t){function n(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).ble instance")}erable instance")}e.exporn e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){function r(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}var i=n(91);e.exports=r},function(e,t,n){function r(e){return i(e)||o(e)||a()}var i=n(370),o=n(373),a=n(376);e.exports=r},function(e,t,n){n(1).tag2("yield","",'body { font-family: "Helvetica Neue",Helvetica,"ヒラギノ角ゴ Pro W3","Hiragino Kaku Gothic Pro","メイリオ",Meiryo,"Meiryo UI","ＭＳ Ｐゴシック","MS PGothic",sans-serif; font-size: 12px; -webkit-text-size-adjust: none; overflow: hidden; margin: 0px; width: 100vw; margin-top: 20px; } .chat-embedded-body { margin-top: 0px; } chat { width: 100%; height: 100%; display: -webkit-flex; display: flex; -webkit-justify-content: flex-end; justify-content: flex-end; -webkit-align-items: center; align-items: center; } chat.expanded { width: 100%; height: 100%; } #chat.display-none { display: none; } #chat.hiding { opacity: 0; -webkit-transform: scale3d(0.8, 0.8, 1); transform: scale3d(0.8, 0.8, 1); } #chat { display: -webkit-flex; display: flex; -webkit-flex-direction: column; flex-direction: column; z-index: 5; overflow: hidden; opacity: 1; border-radius: 4px; width: 100%; height: 100%; background: #FFFFFF; transition: opacity 100ms ease-in-out 50ms, -webkit-transform 150ms ease-out; transition: opacity 100ms ease-in-out 50ms, transform 150ms ease-out; transition: opacity 100ms ease-in-out 50ms, transform 150ms ease-out, -webkit-transform 150ms ease-out; } chatinline #chat { border: 1px solid #CCC; box-sizing: border-box; } #chat .title { float: left; color: white; font-weight: bold; padding: 1.3% 0px 0px 10px; } #chat-floating { z-index: 10; width: 60px; height: 60px; background: #0099FF; background-repeat: no-repeat; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAAqCAYAAADrhujJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAolJREFUeNrkWu1xgzAMBa4DsEE9AhuETNB0AzJB6QSlE6SdwGxAMgFskHQCsgHZwJXvROrzERI7/spVdzrCjxg/S5aeZEfRP5XYxCCMsRQeOWgGugBN8fecHFEPoD/8GcfxIfgVA7AEtATdM3MygFLQVYiAC9CW2ZcetEJv8gp4hZNxLYOXBUCXbpl/GZxtAbTywMIS6mIvhyr7e10/vgQaHjTwxMJT3xJS4Ennz8mUez8A6Ah5gvY8EzmQPQjoUXgMKnX++CS9fyDrClFO6N6yLAB8rerysWTtPiCgHegOqWxnenDR4m8BgOXc/Ru01g1aOhbn1iYe3fgdwNYTwXYsfp4vFD4nLHL4onUwxlE1b3sjJHJORuJENckTp9Ub3LpXQeeeQBcTpKk3vKgkNOCFw3qgCgV4KXw7c1QPNOKWEoMbc5WmIAAtR9DwaB1yh/O3E4n7upC10K5qHBMm7tkbGfjOwYe3QropPaVP3i4jrpnbeszVfF97pMf12eJoiS8HNHQkJT5rglwuSz+RAdmhiX9unkV+hSTSxDj9e0UaaFO8V4DJhFUOY+S10M5KRZcPCjiC3/K2jgXL50IV5lO2ycx+7BC8yfz+Iux1n1bf3eqilcHeeCpQVS8dWtX9SbDaMVYwGFxQlYXPdAMUwXr3nsIiE8ajwYOeakXjxHuNSRBhnNLBAWRmI00RRQ9o5aMg3PM2anJ7B45Y6xo5+MPeQGPArW9rP90BulCwMlEYN8WxqcLlA4p1gF25MSW1piaDizEXDFsXoK8dIVtb/SuXFCqboMuZ49vC1e2FmWsppekPpVLgGfDdGdiZrCJfRKJG5oTRdo9ASyt50dwijEGxCXWe3uRXgAEA5SdRBeQjcaIAAAAASUVORK5CYII=\'); background-position: center center; background-size: 50%; border-radius: 50%; box-shadow: 0 0 5px rgba(0, 0, 0, 0.4); cursor: pointer; -webkit-flex-shrink: 0; flex-shrink: 0; -webkit-justify-content: flex-end; justify-content: flex-end; -webkit-align-items: flex-end; align-items: flex-end; transition: all 80ms; display: -webkit-flex; display: flex; } #chat-floating.hide { display: none; } #chat-floating img { margin-top: 18px; border: none; outline: none; }','to="chatStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","error-field { transition: all 0.4s; position: relative; width: 100%; background: #FF6600; color: #FFF; max-height: 0px; } .error-field-visible { z-index: 9999; max-height: 100vh; } error-field pre { max-height: 20vh; overflow: hidden; font-size: 14px; padding: 15px; } error-field .close-btn { position: absolute; right: 10px; top: 10px; height: 15px; width: 15px; cursor: pointer; } error-field .close-btn > img { width: 100%; height: 100%; } error-field .close-btn line { stroke: #FFF !important; }",'to="errorFieldStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","header { z-index: 6; } _:-ms-input-placeholder, :root header { position: absolute; width: 100%; z-index: 6; } header-default { width: 100%; height: 40px; background-color: #FFF; border-bottom: 1px solid #CCC; color: #6F6F6F; align-items: center; flex-shrink: 0; display: -webkit-flex; display: -ms-flexbox; display: flex; -webkit-justify-content: space-between; justify-content: space-between; -ms-flex-pack: justify; -ms-flex-align: center; -webkit-align-items: center; } header-default .close-btn { height: 15px; width: 15px; margin: 0px 15px; cursor: pointer; } .header-menu { display: flex; align-items: center; justify-content: flex-end; } refresh-button { height: 25px; width: 25px; margin: 0px 15px 0 0; cursor: pointer; } refresh-button+.close-btn { margin-left: 0px; } .close-btn > img { width: 100%; height: 100%; }",'to="headerDefaultStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","refresh-button { cursor: pointer; } svg.refresh-button { width: 25px; } svg.refresh-button path { transition: all 0.3s; fill: #666; }",'to="refreshButtonStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","closeButton .close-button-stroke { fill: none; stroke: #6f6f6f; stroke-linecap: round; stroke-miterlimit: 40; }",'to="closeButtonStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","deleteImage svg { height: 100%; }",'to="deleteImageStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","",".arc-box { width: 100px; height: 100px; overflow: hidden; } .arc-box .slide-box { -webkit-animation: slide .5s steps(24) infinite alternate; animation: slide .5s steps(24) infinite alternate; } .slide-box svg { -ms-animation: rotation 0.45s linear infinite; -webkit-animation: rotation 0.45s linear infinite; animation: rotation 0.45s linear infinite; } svg .arc-path { fill: none; stroke: #6F6F6F; stroke-width: 6; stroke-linecap: round; } @keyframes slide { 100% { transform: translate3d(0px, -2400px, 0px); } } @-webkit-keyframes slide { 100% { -webkit-transform: translateY(-2400px); } } @keyframes rotation { 100% { transform: rotate3d(0, 0, 1, 360deg); } } @-ms-keyframes rotation { 100% { -ms-transform: rotate(360deg); } } @-webkit-keyframes rotation { 100% { -webkit-transform: rotate(360deg); } }",'to="loadingArcStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","refreshImage svg { height: 100%; }",'to="refreshImageStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","sendButtonImg { display: -webkit-inline-flex; display: -ms-inline-flexbox; display: inline-flex; -webkit-align-items: center; -ms-flex-align: center; align-items: center; cursor: pointer; } sendButtonImg.pc-view { height: 100%; display: -webkit-flex; display: -ms-flexbox; display: flex; -webkit-justify-content: center; -ms-flex-pack: center; justify-content: center; -webkit-align-items: center; -ms-flex-align: center; align-items: center; } sendButtonImg .circle { border-radius: 50%; width: 32px; height: 32px; border: 2px solid white; box-shadow: 0 0 3px rgba(0, 0, 0, 0.4); background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAUFJREFUeNrMl/0NgjAQxbXhf9lAR2ADuoluoiO4gbCBTiBuABOIE6gT4DW5Jhc+KqXXwiUvJKQNv9x719B10zSrJZXAZ4E6LAVIVQq6gGrQCbSbhUhZBiqa/spAEtcEkfjDuwfdsWvKzjikZabaEjszn3YKy/Ub7NrT1xAIh73tIYjnBqJ2HkFvtFNyAJWgLwOcHoJy6hCsWye1CmuCkvjcOAB+sWtntNYaqK+4IB8IdnUF4oZ8ka59uIC4IHOEK3wADUFKApoOrKu0ncIjTIxAWmMm7hMxfjxpdWM7Yl+OnSn1i8gxKzYfp6E+Y3Y6oY4CjbyqG0IYx54CJQSA41CcdDBqIO5Rq4gtVhUxg3RCOgeQMaQhgUaF1DeQdUh9AU0O6dRrUG24BiUhr0G6QzU5bVlD6mKZl5C6/sLOXj8BBgBFCkOJob3TNgAAAABJRU5ErkJggg=='); background-repeat: no-repeat; background-size: 60%; background-color: #337FFF; z-index: 1; background-position: center center; } sendButtonImg .square { width: 100%; height: 100%; min-width: 50px; min-height: 28px; text-align: center; background-color: #337fff; color: white; font-weight: bold; box-shadow: 0 0 3px rgba(0, 0, 0, 0.4); z-index: 0; font-size: 16px; border-radius: 3px; white-space: nowrap; position: relative; background-repeat: no-repeat; background-size: cover; display: -webkit-flex; display: -ms-flexbox; display: flex; -webkit-justify-content: center; -ms-flex-pack: center; justify-content: center; -webkit-align-items: center; -ms-flex-align: center; align-items: center; } sendButtonImg.pc-view .square { border-radius: 3px; margin: 0px; min-width: initial; } .square .send-text { opacity: 1; transition: opacity 200ms ease-out; } .square .send-text.loading { opacity: 0; } sendButtonImg.disabled .square { opacity: 0.3; } sendButtonImg.pc-view.disabled .square { opacity: 0.3; }",'to="sendButtonImgStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","uploadImageButtonImg { position: absolute; top: 0px; width: 40px; height: 40px; left: 0px; } uploadImageButtonImg span { width: 100%; height: 100%; padding: 0px; margin: 0px; border: 0; outline: none; display: block; cursor: pointer; } uploadImageButtonImg span svg { width: 40px; height: 40px; } uploadImageButtonImg span svg path { fill: #0099FF; } uploadImageButtonImg input { width: 0px; height: 0px; visibility: hidden; z-index: -1; position: absolute; }",'to="uploadImageButtonImgStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","",".yconnectLogin { margin: 10px; } .yconnectImg { display: block; border-radius: 4px; background-color: #fff; background-repeat: no-repeat; background-size: 40px 40px; background-position: 8px center; text-decoration: none; cursor: pointer; border: 1px solid #f03; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAACUUlEQVR42u2bYY3EIBCFKwEJlUByBiqhEiphJeCgEioBCUhYCZWAhF6bzCWbze6VKTBA876Ef3tleMDMMHBdBwAAAAAAAAAAAAAAAAAAAACHrfvxe9sE2+NuAm7CbbibgM/MgrmXtuxN3XUr98fq2Nu0N7M3e0Hc4/e6oTEfYx1zd6KZfnJsSMDXcVkSVJUW8fhdX6lPfr6N6b+d9IgZR6yILqKfNaOA+qWfOfBvDnvmVCIODGNNhF8yFHBcZJrl6Rvm3bUwJ8qldrziKQtN3hKyWshGfRIwORPRp/aJhrECVKI+1clqNIxvPXLvpBAjFqnlT+I9U6VOjPRszZa3ngwq2Sye9MNOzOl7daRkAdsqyhiK/OsX1zBl9uGuk4CR3rDyQwoa/su20hH2Wm7KI3UkCj3qqYjvuVifFGjn3EnDSEyXi8FpTmDjKJk5XDHQBYo4MYPFlMi+5YptkgIqhj/UgcEiZTK+hp6VS4qoOTkWbSt/JrKQXXUUexmZvosJNol99FJbrc1eLTnlcOInSb+vrlLOTLJzi9cXOe8Kl7988qpHmEtZay+bP0snryfp1VC7gK5k2eikeGBbuLgpLeAkVii9qYC2qcBRoYBetFB6QwF7isK2xbvr4gJ+CChD1xI1CdgkJQS81QswiYunL8c2T/W/sWXxxO9f/ymauipXJjlmRefev+dx88U3Lv7De0JDbYo8dWy1Cij1stUF2GKqrjY3IOBa5V1HJQIuAbZo8ruuqZJVpROryB/b2/1nAAAAAAAAAAAAAAAAAAAAgAC/4u5ma+7MJ2AAAAAASUVORK5CYII=); width: 194px; } .yconnectText { cursor: pointer; display: block; margin-left: 56px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; font-family: sans-serif; font-size: 20px; font-weight: bold; text-align: center; letter-spacing: -1px; white-space: nowrap; border-left: 1px solid #f03; background: #f03; color: #fff; height: 36px; line-height: 36px; }",'to="yconnectButtonStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","information-wall { position: absolute; align-items: center; justify-content: center; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 10; background-color: #ffffff; color: #6F6F6F; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; display: -webkit-flex; display: -ms-flexbox; display: flex; -ms-flex-pack: center; -webkit-justify-content: center; justify-content: center; -webkit-align-items: center; -ms-flex-align: center; align-items: center; -webkit-flex-direction: column; -ms-flex-direction: column; flex-direction: column; } information-wall > span { padding: 0px 25px; text-align: center; } information-wall .reload-button { background-color: #ff7f50; border-radius: 2px; color: #ffffff; display: inline-block; cursor: pointer; padding: 5px 10px; }",'to="informationWallStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","talks { height: 100%; transform: scale(1.0); transition: all 0.2s; overflow-x: hidden; overflow-y: auto; padding-bottom: 10px; -webkit-overflow-scrolling: touch; display: -webkit-flex; display: flex; -webkit-flex-direction: column; flex-direction: column; -webkit-justify-content: space-between; justify-content: space-between; } @media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) { talks { display: block; margin-top: 40px; } } .message.bot::before { content: ''; display: inline-block; width: 24px; height: 24px; border-radius: 50%; box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.35); background-color: #F6F6F6; background-size: cover; background-position: center; z-index: 10; position: relative; flex-shrink: 0; } .message.operator::before { content: ''; display: inline-block; width: 24px; height: 24px; border-radius: 50%; background-color: #F6F6F6; background-size: cover; background-position: center; z-index: 10; position: relative; flex-shrink: 0; } .message.customer::before { content: ''; display: inline-block; width: 24px; height: 24px; border-radius: 50%; background-color: #F6F6F6; background-size: cover; background-position: center; z-index: 10; position: relative; flex-shrink: 0; } @keyframes approach { 0% { opacity: 0; transform:scale(0.8); } 80% { opacity: 1; } 100% { opacity: 1; transform:scale(1.0); } }",'to="talksStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","buttonTag { padding: 0 25px; margin-bottom: 0px; word-break: break-all; } buttonTag .button { display: block; text-align: center; border-top: solid 1px rgba(0, 0, 0, 0.1); color: #00ccff; padding: 10px 0; cursor: pointer; } .loading-wrapper { width: 14px; height: 14px; display: inline-block; transition: opacity 0.2s; }",'to="buttonTagStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","",'carousel { overflow: hidden; border-radius: 3px; margin: 10px 20px; font-size: 12px; display: flex; position: relative; max-width: 100vw; display: -webkit-flex; display: -ms-flexbox; font-family: monospace; } carousel *:not(html) { -webkit-transform: translate3d(0, 0, 0); } .panel-wrapper { transform: translate3d(0px, 0px, 0px); display: flex; transition: transform 0.3s ease-out; display: -webkit-flex; display: -ms-flexbox; } .panel-wrapper .panel { width: 150px; flex: none; box-sizing: border-box; border: 1px solid #D1D1D1; border-left: none; -ms-flex: none; } .panel-wrapper .panel:first-child { border-left: 1px solid #D1D1D1; } .panel .panel-image { width: 100%; height: 125px; background-position: 50% 50%; background-size: contain; background-repeat: no-repeat; } .panel .panelTitle { padding: 2px 3px; } .panel .panelTitle p { margin: 2px; line-height: 1.5em; color: rgba(0, 0, 0, 0.4); word-break: break-all; } .panel .buttons { display: flex; background: white; display: -webkit-flex; display: -ms-flexbox; } .panel .buttons a { color: #00ccff; width: 100%; white-space: nowrap; margin: 8px; line-height: 1.5em; text-overflow: ellipsis; overflow: hidden; text-align: center; cursor: pointer; display: inline-block; } .panel div { border-bottom: 1px solid #D1D1D1; } .panel div:last-child { border-bottom: none; } .carousel-paging { position: absolute; top:0px; bottom: 0px; } .carousel-paging.left { left: -1px; transform: scale(-1, 1); } .carousel-paging.right { right: -1px; } .carousel-paging > .holder { display: flex; justify-content: flex-start; flex-direction: column; height: 100%; display: -webkit-flex; display: -ms-flexbox; -webkit-justify-content: flex-start; -ms-flex-pack: start; -webkit-flex-direction: column; -ms-flex-direction: column; } .holder span { left: 0px; margin-top: 40px; } .holder span > a { width: 30px; height: 30px; background: #FFFFFF; display: block; cursor: pointer; border: 1px solid #D1D1D1; background-position: 50% 50%; background-repeat: no-repeat; background-size: 50%; border-radius: 3px 0px 0px 3px; background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDUwIDUwIiBoZWlnaHQ9IjUwcHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MCA1MCIgd2lkdGg9IjUwcHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIvPjxwb2x5Z29uIHBvaW50cz0iMTUsMi43NSAxMi45MTQsNC44MzYgMzMuMDc4LDI1IDEyLjkxNCw0NS4xNjQgMTUsNDcuMjUgMzcuMjUsMjUgIi8+PC9zdmc+"); }','to="carouselStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","",".aim-strong { font-weight: bold; font-size: 1.4em; } chat-messaage-balloon { display: -webkit-flex; display: flex; max-width: 100% !important; } _:-ms-input-placeholder, :root chat-messaage-balloon { max-width: none; } .message-balloon { position: relative; z-index: 3; } .message-balloon div { position: relative; z-index: 10; } .bot chat-messaage-balloon, .operator chat-messaage-balloon { -webkit-justify-content: flex-start; justify-content: flex-start; } .customer chat-messaage-balloon { -webkit-justify-content: flex-end; justify-content: flex-end; } chat-messaage-balloon::before, chat-messaage-balloon::after { display: block; position: absolute; width: 10px; height: 10px; -webkit-transform: rotate(45deg); transform: rotate(45deg); top: 15px; background-color: white; box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.35); } chat-messaage-balloon::before { z-index: 1; } chat-messaage-balloon::after { box-shadow: none; z-index: 5; }",'to="chatMessaageBalloonStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","imageTag { display: block; margin-bottom: 0px; word-break: break-all; } imageTag .message .message-balloon-wrapper { margin: 0px 10px; -webkit-flex-direction: column !important; -ms-flex-direction: column !important; flex-direction: column !important; min-height: 1px !important; } imageTag .message .image-box { width: 100%; min-width: 200px !important; min-height: 200px !important; background-size: contain !important; background-repeat: no-repeat !important; cursor: pointer; } imageTag .message .image-item { flex-shrink: 0 !important; } imageTag .message.bot .image-box, imageTag .message.operator .image-box { background-position: left; } imageTag .message.customer .image-box { background-position: right; } imageTag .message.bot .image-box, imageTag .message.operator .image-box { border-radius: 2px 20px 20px 20px; }",'to="imageStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","messages { flex-shrink: 0; } .talk { margin-top: 28px; width: 100%; } .talk.offsetDown { opacity: 1; transform: translate3d(0px, 0px, 0px); animation: scroll-up 100ms cubic-bezier(0.15, 0.57, 0.62, 0.96); } @keyframes scroll-up { from { opacity: 0; transform: translate3d(0px, 80px, 0px); } to { opacity: 1; transform: translate3d(0px, 0px, 0px); } } @-webkit-keyframes scroll-up { from { opacity: 0; transform: translate3d(0px, 80px, 0px); } to { opacity: 1; transform: translate3d(0px, 0px, 0px); } } .talk[sender='customer']::after { text-align: right; }",'to="messagesStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","quickReply { width: 100%; display: block; margin-bottom: 0px; word-break: break-all; } quickReply .button { display: block; text-align: center; border-top: solid 1px rgba(0, 0, 0, 0.1); color: #00ccff; padding: 10px 0; cursor: pointer; } quickReplyField { display: none; flex-shrink: 0; z-index: 1; width: 100%; margin-top: 15px; text-align: center; transform-origin: center bottom 0px; transition: height 200ms ease-out; } quickReplyField.mobile .qr-scroll-area { width: 100%; white-space: nowrap; overflow-x: scroll; -webkit-overflow-scrolling: touch; } quickReplyField.show { display: block; } quickReplyField p { opacity: 0; display: inline-block; padding: 5px 15px; background-color: #FFFFFF; color: #00ccff; border: 1px solid #00ccff; border-radius: 5px; transform: translateY(0px); margin: 8px 5px; cursor: pointer; position: relative; top: 0px; left: 0px; white-space: nowrap; } quickReplyField p .frontface { position: absolute; width: 100%; height: 100%; color: #00ccff; border: 1px solid #00ccff; background: #FFFFFF; top: 0px; left: 0px; border-radius: 5px; margin: -1px 0px 0px -1px; z-index: 3; display: -webkit-flex; display: -ms-flexbox; display: flex; -webkit-align-items: center; align-items: center; -webkit-justify-content: center; justify-content: center; -ms-flex-pack: center; } quickReplyField p:hover .frontface { opacity: 0; } quickReplyField p::before, quickReplyField p::after { display: block; position: absolute; width: 7px; height: 7px; -webkit-transform: rotate(45deg); -ms-transform: rotate(45deg); transform: rotate(45deg); box-sizing: border-box; top: 10px; top: 8px\\9; background-color: white; border: 1px solid #00ccff; } @media all and (-ms-high-contrast:none) { *::-ms-backdrop, quickReplyField p::before, quickReplyField p::after { top: 8px !important; } } quickReplyField p:hover::before, quickReplyField p:hover::after { background-color: #00ccff; } quickReplyField p::before { z-index: 1; } quickReplyField p::after { border: none; z-index: 5; right: -3px; } quickReplyField p.pullup { transform: translateY(0px); opacity: 1; animation: reply-pullup 300ms cubic-bezier(0, 0, 0, 1) 0s; } .qr-vertical>p { display: block !important; border-radius: 4px !important; white-space: normal !important; } .qr-vertical>p>span.frontface { border-radius: 4px !important; } quickReplyField p.pop { opacity: 0; transition: opacity 500ms cubic-bezier(0, 0, 0, 1) 250ms; } quickReplyField p.pop .frontface, p.pop::after { opacity: 0; animation: reply-pop 500ms cubic-bezier(0, 0, 0, 1) 0s; } quickReplyField p.fadeOut { opacity: 0; transition: opacity 500ms; } @keyframes reply-pullup { 0% { opacity: 0; transform:translateY(20px); } 80% { transform:translateY(-5px); } 100% { opacity: 1; transform:translateY(0px); } } @keyframes reply-pop { 0% { opacity: 0; } 20% { opacity: 1; } 40% { opacity: 0; } 60% { opacity: 1; } 100% { opacity: 0; } }",'to="quickReplyStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","submitError { display: flex; margin: 9px 10px; } submitError div { display: -webkit-flex; display: -ms-flexbox; display: flex; -webkit-justify-content: center; justify-content: center; -webkit-align-items: center; align-items: center; border-radius: 50%; margin: 0px 4px; cursor: pointer; animation: 0.3s submitError-show ease alternate; width: 20px; height: 20px; } _:-ms-input-placeholder, :root submitError div { display: block; } submitError div.resend { border: 2px solid #00d854; } submitError div.delete { border: 2px solid #ff4833; } @keyframes submitError-show { 0% { opacity: 0; width: 5px; } 100% { opacity: 1; width: 20px; } }",'to="submitErrorStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","typing { padding-top: 10px; margin-bottom: 10px; word-break: break-all; display: block; position: relative; } typing .message { z-index: 3; } typing .message .message-balloon { min-width: initial !important; padding: 10px 16px; } typing::before, typing::after { display: block; position: absolute; width: 10px; height: 10px; -webkit-transform: rotate(45deg); transform: rotate(45deg); z-index: 1; top: 20px; background-color: white; box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.35); } typing::after { box-shadow: none; z-index: 5; } typing div span { display: inline-block; width: 6px; height: 6px; background-color: #6F6F6F; border-radius: 50%; box-sizing: border-box; position: relative; -webkit-transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); } typing div span:not(:nth-child(1)) { margin-left: 6px; } typing div span:nth-child(1) { -webkit-animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 0ms; animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 0ms; } typing div span:nth-child(2) { -webkit-animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 200ms; animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 200ms; } typing div span:nth-child(3) { -webkit-animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 400ms; animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 400ms; } @-webkit-keyframes dot-anim { 0% { -webkit-transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); } 25% { -webkit-transform: translate3d(0px, -6px, 0px) scale3d(1, 1.3, 1); transform: translate3d(0px, -6px, 0px) scale3d(1, 1.3, 1); } 50% { -webkit-transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); } } @keyframes dot-anim { 0% { -webkit-transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); } 25% { -webkit-transform: translate3d(0px, -6px, 0px) scale3d(1, 1.3, 1); transform: translate3d(0px, -6px, 0px) scale3d(1, 1.3, 1); } 50% { -webkit-transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1); } }",'to="typingStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","videoTag { display: block; margin-bottom: 0px; word-break: break-all; } videoTag .message .message-balloon-wrapper { -webkit-flex-direction: column !important; -ms-flex-direction: column !important; flex-direction: column !important; } _:-ms-input-placeholder, :root videoTag .message .message-balloon-wrapper { display: block; } videoTag .message .video-wrapper { margin: 0px 10px; box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.35); border-radius: 10px; overflow: hidden; } .video-wrapper video { width: 100%; } imageTag .message.bot .image-box, imageTag .message.operator .video-wrapper { border-radius: 2px 20px 20px 20px; }",'to="videoStyle"',function(e){})},function(e,t,n){"use strict";var r=n(381),i=(n.n(r),n(9)),o=(n(10),n(76),n(32)),a=n(33);n(1).tag2("error-field",'<yield from="errorFieldStyle"></yield> <div> <div class="close-btn" onclick="{this.handleClose}" riot-style="{closeButtonCss}"> <closebutton></closebuttv>',"","",function(e){var t=this;this.errorMessages=[],this.closeButtonCss=Customize.header.sho right: initial;":"",i.a.on("Talks",o.a.ActionTypes.pushError,function(e){t.errorMessages=e,t.update(),setTimeout(function(){t.root.classList.add("error-field-visible")},10)}),this.handleClose=function(){this.root.classList.remove("error-field-visible"),setTimeout(function(){a.a.instance.resetError()},400)}.bind(this)})},function(e,t,n){"use strict";n(404);n(1).tag2("header",'<header-default close="{this.close}" showrefreshbutton="{this.showRefreshButton}" each="{this.headerTag === \'headerDefault\'? [true]: []}" onbeforerefresh="{beforeRefresh}" onafterrefresh="{afterRefresh}"></header-default>',"","",function(e){var t=this;this.showRefreshButton=e.showrefreshbutton,this.headerTag=Customize.header.component,this.close=e.close,this.beforeRefresh=e.onbeforerefresh,this.afterRefresh=e.onafterrefresh,this.on("update",function(){t.showRefreshButton=e.showrefreshbutton,t.update()})})},function(e,t,n){"use strict";var r=n(382),i=(n.n(r),n(406),n(405),n(41)),o=n(76),a=n(10);n(1).tag2("header-default",'<yield from="headerDefaultStyle"></yield> <div style="min-width: 70px;min-height:10px"> <div class="header-menu"> <div></div> <div class="close-btn"></div> </div> </div> <div class="header" riot-style="{this.headerTextStyle}"> <p>{this.getHeaderText()}</p> </div> <div style="min-width: 70px;min-height: 10px;"> <div class="header-menu"> <refresh-button onclick="{this.refresh}" each="{this.showRefreshButtonFlag.get()}"></refresh-button> <div class="close-btn" onclick="{this.closeTrigger}" riot-style="{this.backButtonHidden? (this.showRefreshButtonFlag.get()? \'display: none\' : \'visibility: hidden\'): \'\'}"> <closebutton></closebutton> </div> </div> </div>',"",'riot-style="{this.headerStyle}"',function(e){var t=this;this.showRefreshButtonFlag=new o.a(Customize.header.showRefreshButton&&e.showrefreshbutton),this.backButtonHidden=a.a.fullScreen||a.a.embedded,this.headerStyle=Customize.header.hideTitle?"background: transparent !important;border: none;":"",this.e?"visibility: hidden":"",thifresh,this.refreshing=!1,this.on("update",function(){t.showRefreshButtonFlag.set(Customize.header.showRefreshButton&&e.showrefreshbutto{return Customize.header.text}.bind(this),this.closeTrigger=function(){e.close(),parent.aiMessenger.runFunctions("close")}.bind(this),this.refresh=function(){var e=this;this.refreshing||(this.refreshing=!0,this.beforeRefresh(),i.a.instance.resetFrame().then(function(){e.afterRefresh(),e.refreshing=!1}))}.bind(this)})},function(e,t,n){"use strict";var r=n(383);n.n(r);n(1).tag2("refresh-button",'<yield from="refreshButtonStyle"></yield> <div riot-style="{this.buttonStyle}"> <svg class="refresh-button" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 128 128"><title>最初からやり直す</title><g id="アイコン"><path d="M101.29,60.5l4.21-35L90.19,36.65A40,40,0,0,0,62.44,25.5c-22,0-39.94,17.72-39.94,39.5s17.92,39.5,39.94,39.5A39.93,39.93,0,0,0,101,75.36,6.62,6.62,0,0,0,97,72c-3-1-6.06,1.86-6.06,1.86a29.82,29.82,0,1,1-28.5-38.41A29.92,29.92,0,0,1,82,42.65L66.26,54.08Z"></path></g></svg> </div>',"","",function(e){this.buttonStyle=Customize.header.hideTitle?"background: ".concat(Customize.header["background-color"]||"#EEE",";border-radius: 100px;box-shadow: 0px 0px 2px rgba(0,0,0,0.5)"):""})},function(e,t,n){"use strict";var r=n(384);n.n(r);n(1).tag2("closebutton",'<yield from="closeButtonStyle"></yield> <?xml version="1.0" encoding="utf-8"?> <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewbox="0 0 10 10" style="enable-background:new 0 0 10 10;" xml:space="preserve"> <g> <line class="close-button-stroke" x1="0.7" y1="0.7" x2="9.3" y2="9.3"></line> <line class="close-button-stroke" x1="9.3" y1="0.7" x2="0.7" y2="9.3"></line> </g> </svg>',"","",function(e){})},function(e,t,n){"use strict";var r=n(385);n.n(r);n(1).tag2("deleteimage",'<yield from="refreshImageStyle"></yield> <?xml version="1.0" ?> <svg id="delete-image-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewbox="0 0 23.3 23.3" style="enable-background:new 0 0 23.3 23.3;" xml:space="preserve"> <path d="M16,11.7l6.6-6.6c1-1,1-2.5,0-3.5l-0.9-0.9c-1-1-2.5-1-3.5,0l-6.6,6.6L5.1,0.7c-1-1-2.5-1-3.5,0L0.7,1.6c-1,1-1,2.5,0,3.5l6.6,6.6l-6.6,6.6c-1,1-1,2.5,0,3.5l0.9,0.9c1,1,2.5,1,3.5,0l6.6-6.6l6.6,6.6c1,1,2.5,1,3.5,0l0.9-0.9c1-1,1-2.5,0-3.5L16,11.7z"></path> </svg>',"","",function(e){if(e.imgStyle)for(var t in e.imgStyle)this["delete-image-svg"].style[t]=e.imgStyle[t]})},function(e,t,n){"use strict";var r=n(386);n.n(r);n(1).tag2("loading-arc",'<yield from="loadingArcStyle"></yield> <div class="arc-box"> <div class="slide-box"> <svg each="{d in this.data}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 100 100"> <path class="arc-path" riot-d="M {this.circleCenter + Math.cos(this.circleAngle*d) * this.circleRadius},{this.circleCenter - MathleRadius} A {this.circleRadius},{this.circleRadius} 0 0 1 {this.circleCenter + Math.cos(this.circleAngle*-d) * this.circleRadius},{this.circleCenter - Math.sin(this.circleAngle*-d) * this.circleRadius}"></path> </svg> </div> </div>',"","",function(e){this.data=Array.from(new Array(24)).map(function(e,t){return parseFloat(t)}),this.circleCenter=50,this.circleRadius=40,this.circleAngle=Math.PI/48,e.scale&&(this.root.style.transform="scale(".concat(e.scale,")"))})},function(e,t,n){"use strict";var r=n(387);n.n(r);n(1).tag2("refreshimage",'<yield from="refreshImageStyle"></yield> <?xml version="1.0" encoding="utf-8"?> <svg id="refresh-image-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewbox="0 0 27.1 27.4" style="enable-background:new 0 0 27.1 27.4;" xml:space="preserve"> <path d="M27.1,12.9c-1.5,0-3,0-4.5,0c0.3,2.6-0.6,5.3-2.6,7.3c-3.5,3.5-9.3,3.5-12.8,0c-3.5-3.5-3.5-9.3,0-12.8c3-3,7.6-3.4,11.1-1.3c-1.2,1.2-2.6,2.5-2.6,2.5c-1,1.1,0,1.8,0.7,1.8h8.8c0.3,0,0.6-0.3,0.6-0.6V1.1c0-0.8-0.9-1.6-1.8-0.7c0,0-1.5,1.5-2.5,2.5C16.2-1,8.8-0.5,4,4.3c-5.3,5.3-5.3,13.9,0,19.2c5.3,5.3,13.9,5.3,19.2,0C26,20.6,27.4,16.7,27.1,12.9z"></path> </svg>',"","",function(e){if(e.imgStyle)for(var t in e.imgStyle)this["refresh-image-svg"].style[t]=e.imgStyle[t]})},function(;i.tag2("yield","","",'from="sendButtonImgStyle"',function(e){}),i.tag2("sendbuttonimg",'<div class="square" riot-style="{this.customStyle}"> <span show="{opts.loading}"> <yield></yield> </span> <span class="send-text {opts.loading ? \'loading\' : \'\'}">送信</span> </div>',"","",function(e){this.customStyle=e.customStyle||""})},function(e,t,n){"use strict";var r=n(92),i=n.n(r),o=n(389),a=(n.n(o),n(76)),s=n(1);s.tag2("yield","","",'from="uploadImageButtonImgStyle"',function(e){}),s.tag2("uploadimagebuttonimg",'<div class="image"> <yield></yield> <label> <input type="file" onchange="{handleChange}" each="{removeSelectedFileFlag.get()}"> <span> <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 128 128"><title>picture</title><g id="アイコン"><path d="M94.51,43.93H68.91V39.43c0-.9-.74-1.23-1.64-1.23H46.39c-.9,0-2,.33-2,1.23v4.51H33.49a7.93,7.93,0,0,0-8,8.06V80.92c0,4.51,3.48,8.88,8,8.88h61c4.51,0,8-4.38,8-8.88V52A7.93,7.93,0,0,0,94.51,43.93ZM64,81.82A15.36,15.36,0,1,1,79.36,66.46,15.38,15.38,0,0,1,64,81.82ZM97.59,53.76a1.64,1.64,0,0,1-1.64,1.64H79.56a1.64,1.64,0,0,1-1.64-1.64V50.48a1.64,1.64,0,0,1,1.64-1.64H95.95a1.64,1.64,0,0,1,1.64,1.64ZM72.81,66.46A8.81,8.81,0,1,1,64,57.65,8.82,8.82,0,0,1,72.81,66.46Z"></path></g></svg> </span> </label> </div>',"","",function(e){this.removeSelectedFileFlag=new a.a,this.handleChange=function(t){var n=t.target;if(1===n.nodeType&&"INPUT"===n.nodeName){var r=n.files;if(r&&r.length>0){var o=i()(r,1),a=o[0];e.onfileselected&&e.onfileselected(a),this.removeSelectedFileFlag.set(!1),this.update(),this.removeSelectedFileFlag.set(!0),this.update()}}}.bind(this)})},function(e,t,n){"use strict";var r=n(390),i=(n.n(r),n(1));i.tag2("yield","","",'from="yconnectButtonStyle"',function(e){}),i.tag2("yconnectbutton",'<div class="yconnectLogin"> <span class="yconnectImg" style="width:194px;"> <span class="yconnectText" style="height:36px;line-height:36px;">ログイン</span> </span> </div>',"","",function(e){})},function(e,t,n){"use strict";var r=n(391);n.n(r),n(408);n(1).tag2("information-wall",'<yield from="informationWallStyle"></yield> <loading-arc show="{this.isLoading}" scale="{1.0}"></loading-arc> <span id="message" show="{this.messageFlag}"></span>',"","",function(e){var t=this;this.messageFlag=!1,this.on("update",function(){t.isLoading=e.loading,t.message.innerHTML=e.message,e.message&&(t.messageFlag=!0)})})},function(e,t,n){"use strict";var r=n(17),i=n.n(r),o=n(16),a=n.n(o),s=n(9),c=n(10),u=n(131),l=n(94),p=n(32),h=n(33),f=n(41),d=n(26),g=n(69),m=(n(73),n(441)),y=(n(182),n(74),n(402),n(419),n(392)),v=(n.n(y),n(1)),b=f.a.instance,w=d.a.instance;v.tag2("talks",'<yield from="talksStyle"></yield> <messages messages="{messages}" show-date-on-bottom="{opts.showDateOnBottom}"></messages> <quickreplyfield riot-tag="quickReplyField"></quickreplyfield>',"",'disable="{!messages}"'e","messages");var r=new h.a,o=parseInt(c.a.version,10);this.on("mount",a()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.pushAllWelcomeMessage(parent.aiMessenger.welcomeMessageTextAdditions);case 2:r.setCatchWelcomeMessage(!1),setInterval(function(){l.a.quickReplyShow||t.update()},6e4),window.sendMessage=r.sendMessagesFromAiMessenger,r.setTalksMountedFlag(!0),r.waitingTalksDom(),o>=12.1&&o<12.2&&"iOS"===c.a.device&&(a=document.querySelector("talks"),n.i(m.a)(a,a.parentElement));case 8:case"end":return e.stop()}},e,this)}))),s.a.on("Talks",p.a.ActionTypes.pushMessage,function(e){var t=e.willUpdate,n=e.message;t&&("customer"===n.body.sender.senderType&&w.pushReceivedMessageId(n.key),r.update(),r.consumeDelayQueue())}),s.a.on("Talks",p.a.ActionTypes.pushNewMessage,function(){r.update(),setTimeout(function(){n.i(g.a)(".talk:last-child")&&n.i(g.a)(".talk:last-child").classList.add("offsetDown")},100)}),s.a.on("Talks",p.a.ActionTypes.ate),s.a.on("Talks",p.a.ActionTypes.removeMessage,r.update),s.a.on("Talks",p.a.ActionTypes.removeTyping,r.update),s.a.on("Talks",p.a.ActionTypes.removeAllMessages,r.update),s.a.on("Talks",p.a.ActionTypes.addErrorFlag,r.update),s.a.on("Talks",p.a.ActionTypes.conversationReset,function(e,t){b.createConversation({retryHash:t}).then(function(){e()})}),s.a.on("Talks",p.a.ActionTypes.unboundStream,function(){t.unboundStream()}),s.a.on("Talks",p.a.ActionTypes.update,function(){t.messages=p.a.messages,t.update(),r.quickRepliyHa),s.a.on("Talks",p.a.ActionTypes.scrollDown,function(){var e=t.root.scrollHeight-t.root.clientHeight-t.root.scrollTop,n=0===e?500:0;setTtInterval(function(){t.root.scrollTop+=i,(r-=i)<=0&&clearInterval(o)},5)},50)}),s.a.on("Talks",p.a.ActionTypes.moveDown,function(){t.root.scrollTop=t.root.scrollHeight}),s.a.on("Talks",p.a.ActionTypes.adjustFirstChildBottomMargin,function(){Array.prototype.forEach.call(n.i(g.b)(".talk:not(:last-child)"),function(e){e&&(e.style.marginBottom="")})}),s.a.on("Talks","talks:bindConversation",function(e){var n=e.tenantId,r=e.conversationId;t.conversationId=r,t.authFirebase().then(function(){t.bindConversation(n,r)})}),s.a.on("Talks",p.a.ActionTypes.isEmbeddedConversationTriggered,function(){b.startConversation()}),s.a.on("Talks",p.a.ActionTypes.postSubmitErrorMessages,function(e){e.forEach(function(e){delete e.submitError,t.postMessages("",e,!1)})}),s.a.on("Talks",p.a.ActionTypes.sendMessagesFromAiMessenger,function(e){t.sendMessagesFromAiMessenger(e)}),s.a.on("Error",u.a.ActionTypes.pushReceivedMessageId,function(){b.pushLogs()})})},function(e,t,n){"use strict";var r=n(175),i=(n.n(r),n(45)),o=(n.n(i),n(393));n.n(o),n(10);n(1).tag2("buttontag",'<yield from="loaderBitStyle"></yield> <yield from="buttonTagStyle"></yield> <yield from="mediaTypeBaseStyle"></yield> <div class="message {opts.sender}"> <div class="eachLine"> <p each="{line in opts.payload.text.split(\'\\n\')}">{line}</p> </dibuttons}" onclick="{select}"> <span hide="{fetchLoading}">{title}</span> <span show="{fetchLoading}"> <div class="loading-wrapper {fetchLoading ? \'loading\' : \'\'}"> <div class="loader"> <div class="bit"></div> </div> </div> </span> </div> </div>',"","",function(e){this.mixin("mediaType"),this.select=function(e){var t=e.item;this.postBack(t)}.bind(this)})},function(e,t,n){"use strict";var r=n(79),i=n.n(r),o=n(394),a=(n.n(o),n(69)),s=n(26),c=n(41),u=(n(439),n(1)),l=new s.a,p=c.a.instance;u.tag2("carousel",'<yield from="carouselStyle"></yield> <div class="panel-wrapper" riot-style="transform: translate3d({this.wrapperLeft + 0.5}px, 0px, 0px);"> <div each="{el, i in opts.payload.elements}" class="panel {buttons.length === 1? \'link-panel\': \'\'}"> <span style="display: none;">{this.parent.panelCheck()}</span> <div class="panel-image" riot-style="background-image: url(\'{el.imageUrl}\')"></div> <div class="panelTitle" name="panelTitle"> <p>{el.title.length > 15? el.title.slice(0, 15) + \'...\': el.title}</p> <p each="{message in (typeof el.subtitle === \'string\'? [el.subtitle.length > 50? el.subtitle.slice(0, 50) + \'...\': el.subtitle]: el.subtitle.length > 50? el.subtitle.slice(0, 50) + \'...\': el.subtitle)}">{message}</p> </div> <div class="buttons" each="{button in el.buttons}"> <a onclick="{buttonPress.bind(this, i)}"> {button.title} </a> </div> </div> </div> <div class="carousel-paging left" if="{this.currentPanel !== 0}"> <div class="holder" onclick="{carouselPaging.bind(null, \'backward\')}"> <span> <a href="javascript:void(0)"></a> </span> </div> </div> <div class="carousel-paging right" if="{this.currentPanel !== (this.panelCount - 2) && this.panelCount !== 1}"> <div class="holder" onclick="{carouselPaging.bind(null, \'forward\')}"> <span> <a href="javascript:void(0)"></a> </span> </div> </div>',"",'class="{this.dummyClass}"',func0,this.panelCMap=[];this.initialzied=!1,this.on("mount",function(){setTimea.a)("#chat").style.display="block";var e=Array.isArray(t.panelTitle)?t.panelTitle:[t.panelTitle],r=e.reduce(function(e,t){return e>t.clientHeight?e:t.clientHeight},0);e.forEach(function(e){return e.style.height="".concat(r,"px")}),n.i(a.a)("#chat").style.display=""}},100)}),this.panelCheck=function(t){this.panelCount=e.payload.elements.length}.bind(this),this.carouselPaging=function(e){"forward"===e?(this.currentPanel+=1,this.panelCount-2<this.currentPanel&&(this.currentPanel=this.panelCount-2)):(this.currentPanel-=1,this.currentPanel<0&&(this.currentPanel=0)),this.wrapperLeft=150*-this.currentPanel,this.update()}.bind(this),this.buttonPress=function(e,t){t.stopPropagation();var n=t.item.button;this.panelAction(n,e)}.bind(this),this.panelAction=function(t,n){var r=window.parent.aiMessenger;switch(t.type){case"link":r.runFunctions("linkClicked",t.url)&&window.open(t.url);break;case"postback":if(!this.updatePanelCheckedState())return;var o=t.payload.message.attachment.payload.quickReply;if(o&&"string"==typeof o.payload)try{o.payload=JSON.stringify(i()({},JSON.parse(o.payload),{title:e.payload.elements[n].title,subtitle:e.payload.elements[n].subtitle}))}catch(e){}r.runFunctions("buttonClicked",t.title)&&p.postBack(t);break;default:var a=new Error("PanelAction target undefined");l.sendError(a)}}.bind(this),this.updatePanelCheckedState=function(){return!(!e.islast||this.panelClicked)&&(this.panelClicked=!0)}.bind(this)})},function(e,t,n){n(1).tag2("image-popup",'<div style="width: calc(100% - 40px);height: calc(100% - 40px);position: absolute;background-repeat: no-repeat;background-color: #FFF;border-radius: 8px;box-shadow: 0px 2px 10px rgba(0,0,0,0.1);top:20px;left:20px;" id="aim-image-popup-content"> <div onclick="{close}" style=" position: absolute; top: -15px; right: -15px; width:30px; height:30px; background-repeat: no-repeat; background-size: 100%; background-position: center; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAP1BMVEVHcExERERERERERERERERERERERERERERERERERERERERERERERERERERERET///9nZ2f09PSKioq4uLhbW1sCw7cjAAAADnRSTlMA4DDQgBBX8CDAcJBAsC3Szd8AAAORSURBVHjazZvbloMgDEWxoojaaGH+/1vnYaatrYI5AcW8u84uBchVKYF1ox6sNfQyY+2gx06dYaNeKn+asXo8VLzrLe2a7buj1GtiWn0AQ3snyO5tTvWmrwi2qm9yyWtDIjO6KSmfCaGtKMmqtL3QWUo2m3AiNGUxLf35NWWyWrQIraFsZgQ7YaCsNqCHr6bMVkMH8lZRdqtugL6hA8zcyurzCVo6zFiH4UYH2q3c+nP/hWP19wmaig62Kn4f1HS41Sfev/Ct3NIpFjyMnTkHwHTlNkB0G2g6zTZ9pI5OtK0/IeZ/eodrOB/zVLET4KcJJnDT5JGTELsC/TTBBG6aogSrC1Hv6IME7u8bz96HjdnThwjc85swgWmYC/DSBwjc+xvPW4LwAiz02QRu+Y1nLUHP0mcSuM9vggT9AiB4BOYHTPCl/5iDB4F1B8AEbP3lXRDL/4AEgD7dea8ARIDov1+EnnIRYPqvbbjnB7AJQP2nX7D/DjMJUP3nf9BTHgJc//8/4CSiGAQC/X+3gHW97hJI9ImUUmqkHAQyfRoBXzRKINQnzdwCewRSfbJKKX40EiQQ65PBvPEAgVyfqOPuwQhBij6NYDy0QZCkTxqNyFcEafo0KDQh/02Qpk8WBogSwPpkFZ4TCBPg+mQUUTYCgT6RBCBAINKXAWwSyPSFABsEQn0pwIpAqi8GcN8r4M4FcOs94M4EcFunwJ0H4LbvAXcWgAvdhBICwVXswm8BTmDwx8jFXkOYAH8Nv9//RxqBRR2Slf8xpxEMoEu24f+kEWjMKd30v5IIRsgtD/h/KQQdEpgE/U85gUFCs4j/KyawQHAa9b+lBJofnu/4/0KCkZ2g2I0/ZATsFA0j/pEQWG6SihV/CQh6ZpqOGf/hBB0vUcmOP1GCmpeqBeJfkKBnJauh+Bsj6DjpejD+RwjunIIFnH8ACFpGyUaQ/2ATVIyi1SyJv74J5p0tGC3beUn890kQqpp9Vi6DT6KXxJ9LAh97CKHKJRL/vgl4dUtO7RaLv58EzMptvHzvJfH/H0FYf93PFLkLvCT/MD+i1fsWauHwkvzH/PB7jgC/ieVHEnj/cF6BK7XxlG9kKt/KVbyZrXw7X/mGxvItncWbWsu39ZZvbC7f2l2+ub18e3/5AYfyIx7lh1wuMOZTftCp/KjXBYbdyo/7XWDgsfzI5wWGXi8w9nuFwecLjH5fYfj9iPH/X3P3zMlCyTdfAAAAAElFTkSuQmCC\'); border-radius:,function(){t.update();var e=new Image;e.onload=function(){var n=t["aim-image-popup-content"].style;n.backgroundImage="url(".concat(t.imageUrl,")");var r="window"===Customize.chat.imageZoomType?function(){return{width:top.window.innerWidth,height:top.window.innerHeight}}:function(){return document.querySelector("#chat").getBou.width>=o-40,c=e.height>=a-40;s||c?(n.backgroundSize="contain",c&&!s?n.width="".concat(e.width,"px"):!c&&s&&(n.height="".concat(e.height,"px"))):(n.backgroundSize="auto",n.width="".concat(e.width,"px"),n.height="".concat(e.height,"px")),n.backgroundPosition="center"},e.src=t.imageUrl}),this.close=function(){e.onClose.apply(this),this.unmount()}.bind(this)})},function(e,t,n){"use strict";var r=n(45),i=(n.n(r),n(396)),o=(n.n(i),n(10)),a=n(417),s=(n.n(a),n(1));s.tag2("imagetag",'<yield from="mediaTypeBaseStyle"></yield> <yield from="imageStyle"></yield> <div class="message {opts.sender} {opts.showDateOnBottom? \'show-date-on-bottom\': \'\'}" onclick="{openImage}"> <div class="message-balloon-wrapper {opts.showDate? \'\': \'not-show-date\'}" data-dateformat="relative" data-information="{this.diffTime(opts.datetime)}"> <div class="image-box" riot-style="background-image: url({typeof opts.payload === \'string\'? opts.payload: opts.payload.url})"></div> <img class="image-item" riot-src="{typeof opts.payload === \'string\'? opts.payload: opts.payload.url}"> </div> </div>',"","",function(e){this.mixin("mediaType"),this.mobile=o.a.mobile;var t=!1;this.openImage=function(){if(!t){t=!0;var n=document.createElement("imagePopup");n.style.width="100%",n.style.height="calc(100% - 15px)",n.style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.zIndex=2147483648,n.style.backgroundColor="rgba(255,255,255,0.6)",n.style.backdropFilter="blur(20px)",n.style.justifyContent="center",n.style.alignItems="center",n.style.display="flex","window"===Customize.chat.imageZoomType?top.document.body.appendChild(n):document.querySelector("#chat").appendChild(n),s.mount(n,"image-popup",{imageUrl:"string"==typeof e.payload?e.payload:e.payload.url,onClose:function(){t=!1}})}}.bind(this)})},function(e,t,n){"use strict";var r=(n(10),n(72),n(57)),i=n(130),o=(n(432),n(74),n(433),n(434),n(422),n(420),n(416),n(415),n(424),n(200),n(421),n(423),n(418),n(425),n(397));n.n(o);n(1).tag2("messages",'<yield from="messagesStyle"></yield> <div class="talk" each="{message in this.displayMessages}"> <submiterror each="{message.submitError ? [true]:[]}" message="{message}"></submiterror> <carousel each="{message.attachment.mediaType == \'carousel\' ? [true]:[]}" datetime="{message.createdAt}" payload="{message.attachment.payload}" islast="{this.displayMessages[this.displayMessages.length - 1] === message}" show-date-on-bottom="{this.showDateOnBottom}" show-date="{!parent.isWelcomeMessage(message.key)}"></carousel> <buttontag each="{message.attachment.mediaType == \'button\' ? [true]:[]}" datetime="{message.createdAt}" payload="{message.attachment.payload}" sender="{sender.senderType}" show-date-on-bottom="{this.showDateOnBottom}" show-date="{!parent.isWelcomeMessage(message.key)}"></buttontag> <quickreply each="{message.attachment.mediaType == \'quickReplies\' || message.attachment.mediaType == \'quickReplyPostback\' ? [true]:[]}" datetime="{message.createdAt}" payload="{message.attachment.payload}" md="{message.meta.isMarkdownEnabled}" sender="{message.sender.senderType}" show-date-on-bottom="{this.showDateOnBottom}" show-date="{!parent.isWelcomeMessage(message.key)}"></quickreply> <imagetag each="{message.attachment.mediaType == \'image\' ? [true]:[]}" datetime="{message.createdAt}" payload="{message.attachment.payload}" sender="{message.sender.senderType}" show-date-on-bottom="{this.showDateOnBottom}" show-date="{!parent.isWelcomeMessage(message.key)}"></imagetag> <videotag each="{message.attachment.mediaType == \'video\' ? [true]:[]}" datetime="{message.createdAt}" payload="{message.attachment.payload}" sender="{message.sender.senderType}" show-date-on-bottom="{this.showDateOnBottom}" show-date="{!parent.isWelcomeMessage(message.key)}"></videotag> <typing each="{message.attachment.mediaType == \'typing\' ? [true]:[]}" class="{message.sender.senderType}" datetime="{message.createdAt}" payload="{message.attachment.payload}" sender="{message.sender.senderType}" show-date-on-bottom="{this.showDateOnBottom}"></typing> <yconnecttag each="{message.attachment.mediaType == \'yconnect\' ? [true]:[]}" datetime="{message.createdAt}" payload="{message.attachment.payload}" sender="{message.sender.senderType}" show-date-on-bottom="{this.showDateOnBottom}"></yconnecttag> <aim-plaintext each="{message.attachment.mediaType == \'plainText\' ? [true]:[]}" datetime="{message.createdAt}" markdown="{!!message.meta.isMarkmessage.attachment.payload, message.meta? !!message.meta.isMarkdownEnabled: false)}" sender="{message.sender.senderType}" show-date-on-bottom="{this.showDateOnBottom}laintext> </div>',"","",function(e){var t=this;this.isWelcomeMessage=function(e){return 0===e.indexOf(i.a.WELCOME_MSG)},this.convertToSafeTemplateExprs=r.a.convertToSafeTemplateExprs,this.showDateOnBottom=e.showDateOnBottom,this.mixin("date","mediaType","quickReplies"),this.on("mount",function(){t.showDateOnBottom=e.showDateOnBottom,t.update()}),this.on("update",function(){e.messages&&(t.displayMessages=Object.keys(e.messages).sort().map(function(t){return e.messages[t].key=t,e.messages[t]}),t.checkLastMessage(t.displayMessages))})})},function(e,t,n){"use strict";var r=n(45),i=(n.n(r),n(176)),o=(n.n(i),n(57)),a=(n(129),n(10));n(1).tag2("aim-plaintext",'<yield from="plainTextStyle"></yield> <yield from="mediaTypeBaseStyle"></yield> <div class="message {opts.sender} {opts.showDateOnBottom? \'show-date-on-bottom\': \'\'}"> <div class="message-balloon-wrapper {opts.showDate? \'\': \'not-show-date\'}" data-dateformat="relative" data-information="{this.diffTime(opts.datetime)}"> <chat-messaage-balloon payload="{payload}" sender="{opts.sender}" markdown="{opts.markdown}"></chat-messaage-balloon> </div> </div>',"","",function.a.mobile,this.on("mount",funrtToSafeTemplateExprs(e?e.payload||"":""),t.update()})})},function(e,t,n){"use strict";var r=n(57);n(1).tag2("rawcontent",'<span class="content"></span>',"","",function(e){var t=this,n=function(){t.root.innerHTML=e.content.split("\n").map(function(e){return r.a.restoreSafeTemplateExprs(e)}).join("\n")};this.on("mount",function(){n(),t.update()})})},function(e,t,n){"use strict";var r=n(399),i=(n.n(r),n(175)),o=(n.n(i),n(409),n(407),n(33)),a=n(26),s=n(75),c=n(1),u=o.a.instance,l=a.a.instance,p=s.a.instance;c.tag2("submiterror",'<yield from="loaderBitStyle"></yield> <yield from="submitErrorStyle"></yield> <div class="delete" onclick="{removeMessage}"> <deleteimage img-style="{this.deleteImageStyle}"></deleteimage> </div> <div class="resend" onclick="{resend}"> <refreshimage img-style="{this.refreshImageStyle}"></refreshimage> </div>',"","",function(e){this.refreshImageStyle={height:"60%",fill:Customize.talks["resend-fail-message-color"]},this.deleteImageStyle={height:"40%",fill:Customize.talks["delete-fail-message-color"]},this.resend=function(){l.pushSubmitErrorResend();var t=e.message.key;u.postSubmitErrorMessages(e.message,t)}.bind(this),this.removeMessage=function(){l.pushSubmitErrorRemove();var t=e.sign;p.removeBySign(t),u.removeNewMessage(e.message)}.bind(this)})},function(e,t,n){"use strict";var r=n(9),i=n(45),o=(n.n(i),n(400)),a=(n.n(o),n(74),n(10)),s=n(33),c=n(32);n(1).tag2("typing",'<yield from="typingStyle"></yield> <yield from="mediaTypeBaseStyle"></yield> <div class="message {opts.sender}"> <div class="message-balloon"> <div> <span></span> <span></span> <span></span> </div> </div> </div>',"",'data-information=" "',function(e){var t=this;this.mixin("mediaType"),this.mobile=a.a.mobile;var n=new s.a;this.on("mount",function(){t.applyTypingActor()}),r.a.on("Talks",c.a.ActionTypes.setTypingActors,function(){t.applyTypingActor()}),this.applyTypingActor=function(){c.a.typingActors?this.root.parentElement:n.removeTyping()}.bind(this)})},function(e,t,n){"use strict";var r=n(45),i=(n.n(r),n(401)),o=(n.n(i),n(10));n(1).tag2("videotag",'<yield from="mediaTypeBaseStyle"></yield> <yield from="videoStyle"></yield> <div class="message {opts.sender} {opts.showDateOnBottom? \'show-date-on-bottom\': \'\'}"> <div class="message-balloon-wrapper {opts.showDate? \'\': \'not-show-date\'}" data-dateformat="relative" data-information="{this.diffTime(opts.datetime)}"> <div class="video-wrapper"> <video __controls="{true}" __autoplay="{false}" riot-src="{opts.payload.url}"> <source riot-src="{opts.payload.url}"> </video> </div> </div> </div>',"","",function(e){this.mixin("mediaType"),this.mobile=o.a.mobile})},function(e,t,n){"use strict";var r=n(9),i=n(45),o=(n.n(i),n(176)),a=(n.n(o),n(57),n(129),n(412),n(41)),s=n(32),c=n(1),u=a.a.instance;c.tag2("yconnecttag",'<yield from="plainTextStyle"></yield> <yield from="mediaTypeBaseStyle"></yield> <yield from="chatMessaageBalloonStyle"></yield> <div class="message {opts.sender} {opts.showDateOnBottom? \'show-date-on-bottom\': \'\'}"> <div class="message-balloon-wrapper" data-dateformat="relative" data-information="{this.diffTime(opts.datetime)}"> <div class="message-balloon html-message"> <yconnectbutton onclick="{onClickButton}"></yconnectbutton> </div> </div> </div>',"","",function(e){this.onClickButton=function(){u.yconnectRedirectUrl({redirectUrl:""oncat(location.host).concat(location.pathname).concat(location.search.length?-1===location.search.indexOf("_aimwidget")?"".concat(location.search,"&_aimwidget=1"):location.search.replace(/_aimwidget=[^&]+/,"_aimwidget=1"):"?_aimwidget=1").concat(location.hash)})},r.a.on("Talks",s.a.ActionTypes.setYconnectAuthUrl,function(e){top.location.href=e})})},,function(e,t,n){"use strict";function r(e,t,n){var r=n.value.bind(e);n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"prod"!==i.a.envPrefix&&t.forEach(function(e){console.error(e)}),r.apply(void 0,t)}}t.a=r;var i=n(10)},function(e,t,n){"use strict";function r(e,t,n){var r=n.value;n.value=s()(o.a.mark(function e(){var t,n,i,a=this,s=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=s.length,n=new Array(t),i=0;i<t;i++)n[ly(a,n)});casnd":return e.stop()}},e,this)}))}t.a=r;var i=n(17),o=n.n(i),a=n(16),s=n.n(a),c=n(444),u=c.a.instance},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(431),c=n(96),u=n(203),l=function(e){var t=parseInt(e,10);return isFinite(t)?t:0},p=function(){function e(t){i()(this,e),this._customProperty=t}return a()(e,[{key:"e);[this._createChatStyle(),this._createChatPositionStyle(),this._minimizationStyle(),this._createBalloonStyle(),this._createIconImages(),this._createHeaderStyle(),this._createTalksStyle(),this._createTalksIconStyle(),this._createTalksDirectionStyle(),this._createInputStyle()].forEach(function(e){return t.appendChild(document.createTextNode(e))}),this._injectTo(t,e)}},{key:"setIframeZoom",value:function(){var e=this,t=window.parent.aiMessenger;t&&(this._setIframeZoom(t),window.parent.addEventListener("orientationchange",function(n){e._setIframeZoom(t)}))}},{key:"setIframeStyle",value:function(){var e=window.parent.aiMessenger;e&&this._updatePosition(e)}},{key:"_setIframeZoom",value:function(e){var t;t=window.parent.orientation?window.parent.orientation:window.parent.screen.orientation&&window.parent.screen.orientation.angle?window.parent.screen.orientation.angle:0,90===Math.abs(t)?e._aimWidget.style.zoom=this._customProperty._iframe.zoom.landscape:e._aimWidget.style.zoom=this._customProperty._iframe.zoom.portrait}},{key:"_updatePosition",value:function(e){n.i(u.a)()?(e._aimWidget.style.bottom="calc(env(safe-area-inset-bottom) + ".concat(this._customProperty.distanceFromScreenBottomEdge,")"),"right-bottom"===this._customProperty.chatStyle.position?e._aimWidget.style.right="calc(env(safe-area-inset-right) + ".concat(this._customProperty.distanceFromScreenSideEdge,")"):e._aimWidget.style.left="calc(env(safe-area-inset-left) + ".concat(this._customProperty.distanceFromScreenSideEdge,")")):(e._aimWidget.style.bottom=this._customProperty.distanceFromScreenBottomEdge,"right-bottom"===this._customProperty.chatStyle.position?e._aimWidget.style.right=this._customProperty.distanceFromScreenSideEdge:e._aimWidget.style.left=this._customProperty.distanceFromScreenSideEdge)}},{key:"_injectTo",value:function(e,t){t.getElementsByTagName("head")[0].appendChild(e)}},{key:"_createChatStyle",value:function(){var e=this._customProperty.chatStyle;return"body {\n      ".concat(e["font-size"]?"font-size: ".concat(e["font-size"]," !important;"):"","\n      ").concat(e["font-family"]?"font-family: ".concat(e["font-family"]," !important;"):"","\n    }\n    \n    a:link { \n      ").concat(e["link-color"]?"color: ".concat(e["link-color"]," !important;"):"","\n    }\n    \n    a:hover {\n      ").concat(e["link-color"]?"color: ".concat(e["link-color"]," !important;"):"","\n    }\n    \n    a:active {\n      ").concat(e["link-color"]?"color: ".concat(e["link-color"]," !important; }"):"","\n    }\n        \n    a:visited { \n      ").concat(e["visited-link-color"]?"color: ".concat(e["visited-link-color"]," !important;"):"","\n    }\n    \n    #chat-floating {\n      ").concat(e["border-radius"]||0==e["border-radius"]?"border-radius: ".concat(e["border-radius"],"px !important;"):"","\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n      ").concat(e["background-size"]||0==e["background-size"]?"background-size: ".concat(e["background-size"],"% !important;"):"","\n      ").concat(e["background-image"]?"background-image: url(".concat(e["background-image"],") !important;"):"","\n      ").concat(e.width||0==e.width?"width: ".concat(e.width,"px !important;"):"","\n      ").concat(e.height||0==e.height?"height: ".concat(e.height,"px !important;"):"","\n      ").concat(e.opacity||0==e.opacity?"opacity: ".concat(e.opacity," !important;"):"","\n      ").concat(e["box-shadow"]?"box-shadow: ".concat(e["box-shadow"]," !important;"):"","\n    }\n\n    balloon {\n      ").concat(e.opacity?"opacity: ".concat(e.opacity," !important;"):"","\n    }\n\n    loading-arc .arc-path {\n      ").concat(e["loading-color"]?"stroke: ".concat(e["loading-color"]," !important;"):"","\n    }")}},{key:"_createChatPositionStyle",value:function(){switch(this._customProperty.chatStyle.position){case"right-bottom":return"\n          chat, chatsp {\n            -webkit-flex-direction: row !important;\n            flex-direction: row !important;\n          }\n          \n          #chat-floating {\n            margin: 3px 5px 3px 0px; !important;\n          }\n          balloon {\n            margin: 4px 20px 4px 0px; !important;\n          }\n          \n          minimizeButton {\n            right: 0px !important;\n            padding: 15px 0px 15px 15px;\n            width: 30px;\n            box-sizing: border-box;\n          }";case"left-bottom":return window.parent.aiMessenger.aimWidget.style.right="initial","\n          chat, chatsp {\n            -webkit-flex-direction: row-reverse !important;\n            flex-direction: row-reverse !important;\n          }\n          \n          #chat-floating {\n            margin: 3px 0px 3px 5px !important;\n          }\n          \n          .balloon-opening {\n            left: ".concat(-7,"px !important;\n          }\n          \n          balloon {\n            margin: 4px 4px 4px 20px !important;\n          }\n          \n          minimizeButton {\n            left: 0px !important;\n            padding: 15px 0px;\n            width: 30px;\n          }\n        ")}}},{key:"_minimizationStyle",value:function(){var e=this._customProperty.minimizationStyle;return"miniFloat {\n      ".concat(e.visibility?"visibility: ".concat(e.visibility," !important;"):"","\n    }\n    \n    miniFloat #float {\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }")}},{key:"_createBalloonStyle",value:function(){var e=this._customProperty.balloonStyle;return"balloon .balloon-body {\n      ".concat(e["font-color"]?"color: ".concat(e["font-color"]," !important;"):"","\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n      ").concat(e.scale||0==e.scale?"transform: scale(".concat(e.scale,") !important;"):"","\n      ").concat(e["transform-origin"]?"transform-origin: ".concat(e["transform-origin"]," !important;"):"","\n    }\n\n    balloon .balloon-opening {\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }\n\n    balloon .balloon-body.typing span {\n      ").concat(e["font-color"]?"background-color: ".concat(e["font-color"]," !important;"):"","\n    }\n\n    chat {\n      ").concat(e["align-items"]?"align-items: ".concat(e["align-items"]," !important;"):"","\n      ").concat(e["-ms-flex-align"]?"-ms-flex-align: ".concat(e["-ms-flex-align"]," !important;"):"","\n    }\n    \n    chatSp {\n      align-items: ").concat(e["align-items"]," !important;\n      -ms-flex-align: ").concat(e["-ms-flex-align"]," !important;\n    }")}},{key:"_createIconImages",value:function(){var e=this._customProperty.botCharacter,t=(this._customProperty.botCharacterBorder,this._customProperty.operatorCharacter),n=this._customProperty.customerCharacter;return".message.bot::before {\n      ".concat(e?'background-image: url("'.concat(e,'") !important;'):"display: none !important","\n    }\n    \n    .message.bot {\n      ").concat(e?"margin: 0px 10px !important":"",";\n    }\n    \n    .message.operator::before {\n      ").concat(t?'background-image: url("'.concat(t,'") !important;'):"display: none !","\n    }\n    \n    .message.operator {\n      ").concat(t?"margin: 0px 10px !important":"",";\n    }\n\n    .message.customer::before {\n      ").concat(n?'background-image: url("'.concat(n,'") !important;'):"display: none !important","\n    }\n\n    .message.customer {\n      ").concat(n?"margin: 0px 10px !important":"",";\n    }\n\n    ")}},{key:"_createHeaderStyle",value:function(){var e=this._customProperty.headerStyle;return"header-default {\n      ".concat(e["font-color"]?"color: ".concat(e["font-color"]," !important;"):"","\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }\n    closeButton .close-button-stroke {\n      ").concat(e["background-color"]?"stroke: ".concat(n.i(s.a)(e["background-color"])," !important;"):"","\n    }\n    svg.refresh-button path {\n      ").concat(e["refresh-button-color"]?"fill: ".concat(e["refresh-button-color"]):"","\n    }\n    ").concat(c.a.instance.isMobile?"":"refresh-button:hover svg.refresh-button path {\n      ".concat(e["refresh-button-hover-color"]?"fill: ".concat(e["refresh-button-hover-color"]):"","\n    }"))}},{key:"_createTalksStyle",value:function(){var e=this._customProperty.talksStyle;return"talks {\n      ".concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }\n    \n    .message .message-balloon {\n      ").concat(e["box-shadow"]?"box-shadow: ".concat(e["box-shadow"]," !important;"):"","\n    }\n    \n    chat-messaage-balloon::before, typing::before {\n      ").concat(e["box-shadow"]?"box-shadow: ".concat(e["box-shadow"]," !important;"):"","\n    }\n\n    .message.customer .message-balloon {\n      ").concat(e["customer-balloon"]?"background-color: ".concat(e["customer-balloon"]," !important;"):"","\n      ").concat(e["customer-balloon-text"]?"color: ".concat(e["customer-balloon-text"]," !important;"):"","\n    }\n    \n    .customer chat-messaage-balloon::before, .customer chat-messaage-balloon::after {\n      ").concat(e["customer-balloon"]?"background-color: ".concat(e["customer-balloon"]," !important;"):"","\n    }\n\n    .message.operator .message-balloon {\n      ").concat(e["operator-balloon"]?"background-color: ".concat(e["operator-balloon"]," !important;"):"","\n      ").concat(e["operator-balloon-text"]?"color: ".concat(e["operator-balloon-text"]," !important;"):"","\n    }\n    \n    .operator chat-messaage-balloon::before, .operator chat-messaage-balloon::after, typing.operator::after {\n      ").concat(e["operator-balloon"]?"background-color: ".concat(e["operator-balloon"]," !important;"):"","\n    }\n\n    .message.bot .message-balloon {\n      ").concat(e["bot-balloon"]?"background-color: ".concat(e["bot-balloon"]," !important;"):"","\n      ").concat(e["bot-balloon-text"]?"color: ".concat(e["bot-balloon-text"]," !important;"):"","\n    }\n    \n    .bot chat-messaage-balloon::before, .bot chat-messaage-balloon::after, typing.bot::after {\n      ").concat(e["bot-balloon"]?"background-color: ".concat(e["bot-balloon"]," !important;"):"","\n    }\n\n    quickReplyField p .frontface {\n      ").concat(e["quickreplies-font-color"]?"color: ".concat(e["quickreplies-font-color"]," !important;"):"","\n      ").concat(e["quickreplies-border-color"]?"border: 1px solid ".concat(e["quickreplies-border-color"]," !important;"):"","\n      ").concat(e["quickreplies-background-color"]?"background-color: ".concat(e["quickreplies-background-color"]," !important;"):"","\n    }\n    \n    quickReplyField p::before {\n      ").concat(e["quickreplies-border-color"]?"background-color: ".concat(e["quickreplies-border-color"]," !important;"):"","\n      ").concat(e["quickreplies-border-color"]?"border: 1px solid ".concat(e["quickreplies-border-color"]," !important;"):"","\n    }\n    \n    quickReplyField p::after {\n      ").concat(e["quickreplies-background-color"]?"background-color: ".concat(e["quickreplies-background-color"]," !important;"):"","\n    }\n    \n    quickReplyField p:hover::after {\n      ").concat(e["quickreplies-font-color"]?"background-color: ".concat(e["quickreplies-active-bg-color"]||e["quickreplies-font-color"]," !important;"):"","\n    }\n    \n    quickReplyField p:hover.pop::after {\n      ").concat(e["quickreplies-background-color"]?"background-color: ".concat(e["quickreplies-active-bg-color"]||e["quickreplies-background-color"]," !important;"):"","\n    }\n\n    quickReplyField p {\n      ").concat(e["quickreplies-background-color"]?"color: ".concat(e["quickreplies-active-font-color"]||e["quickreplies-background-color"]," !important;"):"","\n      ").concat(e["quickreplies-border-color"]?"border: 1px solid ".concat(e["quickreplies-border-color"]," !important;"):"","\n      ").concat(e["quickreplies-font-color"]?"background-color: ".concat(e["quickreplies-active-bg-color"]||e["quickreplies-font-color"]," !important;"):"","\n    }\n\n    buttonTag .button {\n      ").concat(e["button-text-color"]?"color: ".concat(e["button-text-color"]," !important;"):"","\n    }\n\n    .buttons a {\n      ").concat(e["button-text-color"]?"color: ".concat(e["button-text-color"]," !important;"):"","\n    }\n\n    typing p span {\n      ").concat(e["bot-balloon-text"]?"background-color: ".concat(e["bot-balloon-text"]," !important;"):"","\n    }\n\n    inputfield #input-wrapper {\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }\n\n    spInput {\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }\n\n    .talksPreview {\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }\n    \n    .input-wrapper {\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }\n\n    inputfield {\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n    }\n\n    inputFieldDefault:before {\n      ").concat(e["background-color"]?"background: linear-gradient(rgba(255, 255, 255, 0.0) 0%, ".concat(e["background-color"]," 50%) !important;"):"","\n    }\n   \n    inputButton:before {\n      ").concat(e["background-color"]?"background: linear-gradient(rgba(255, 255, 255, 0.0) 0%, ".concat(e["background-color"]," 50%) !important;"):"","\n    }\n\n    submitError div.resend {\n      border-color: ").concat(e["resend-fail-message-color"]," !important;\n    }\n\n    submitError div.delete {\n      border-color: ").concat(e["delete-fail-message-color"]," !important;\n    }\n            \n    .message-balloon-wrapper .image-box {\n      display: ").concat(e["expand-image"]?"none":"block"," !important;\n    }\n          \n    .message-balloon-wrapper .image-item {\n      display: ").concat(e["expand-image"]?"block":"none"," !important;\n      width: 100%;\n    }")}},{key:"_createTalksIconStyle",value:function(){var e=this._customProperty.talksStyle,t=e["icon-position"],n=e["customer-icon-width"],r=e["customer-icon-height"],i=e["bot-icon-width"],o=e["bot-icon-height"],a=e["operator-icon-width"],s=e["operator-icon-height"],c=this._customProperty.botCharacter,u=this._customProperty.botCharacterBorder,l=this._customProperty.operatorCharacter,p=this._customProperty.customerCharacter;switch(a=l?a:"0px",i=c?i:"0px",t){case"side":return".message::before { /* iOS8用修正 */\n          -webkit-flex-shrink: 0;\n        }\n        .message.bot::before {\n          width: ".concat(i," !important;\n          height: ").concat(o," !important;\n          border-radius: ").concat(u||"0"," !important;\n          box-shadow: none !important;\n          background-color: transparent !important;\n        }\n\n        .message.operator::before {\n          width: ").concat(a," !important;\n          height: ").concat(s," !important;\n          border-radius: 0 !important;\n          box-shadow: none !important;\n          background-color: transparent !important;\n        }\n\n        .message.customer::before {\n          width: ").concat(n," !important;\n          height: ").concat(r," !important;\n          border-radius: 0 !important;\n          box-shadow: none !important;\n          background-color: transparent !important;\n        }\n\n        .message.bot {\n          ").concat(c?"":"margin: 0px 10px !important;","\n        }\n\n        .message.operator {\n          ").concat(l?"":"margin: 0px 10px !important;","\n        }\n\n        .message.customer {\n          ").concat(p?"":"margin: 0px 10px !important;","\n        }\n        \n        .message .message-balloon {\n          margin: 0px 12px !important;\n        }\n        \n        .message .message-balloon-wrapper::after {\n          margin: 0px -5px !important;\n        }\n        \n        chat-messaage-balloon::before, chat-messaage-balloon::after,\n        typing::before, typing::after,\n        quickReplyField p::before, quickReplyField p::after {\n          ").concat(e["quickreplies-no-arrow"]?"":"content: ''",";\n        }\n\n        quickReplyField p {\n          margin: 8px 7px !important;\n        }");case"shoulder":return".message.bot::before {\n          margin-top: -10px !important;\n        }\n\n        .message.operator::before {\n          margin-top: -10px !important;\n        }\n\n        .message.customer::before {\n          margin-top: -10px !important;\n        }\n\n        .message .message-balloon {\n          margin: 0px -12px !important;\n        }\n\n        .message .image-box {\n          margin: 0px -12px !important;\n        }\n\n        .message .message-balloon-wrapper::after {\n          margin: 5px 18px 0px 18px !important;\n        }\n\n        chat-messaage-balloon {\n          max-width: 95% !important;\n        }"}}},{key:"_createTalksDirectionStyle",value:function(){var e=this._customProperty.talksStyle,t=e.direction,n=e["icon-position"],r=l(e["customer-icon-width"]),i=l(e["customer-icon-height"]),o=l(e["bot-icon-width"]),a=l(e["bot-icon-height"]),s=l(e["operator-icon-width"]),c=l(e["operator-icon-height"]),u=this._customProperty.botCharacter,p=this._customProperty.operatorCharacter,h=this._customProperty.customerCharacter,f="side"===n?10:0,d="side"===n?5:23,g=r>0&&i>0&&!!h,m=s>0&&c>0&&!!p,y=o>0&&a>0&&!!u;return m||(s=0),y||(o=0),"normal"===t?".customer .message-balloon {\n        ".concat("side"===n?"border-radius: ".concat(d,"px !important;"):"","\n      }\n\n      .operator .message-balloon {\n        ").concat("side"===n?"".concat(m?"":"margin-left: 2px !important"):""," \n      }\n\n      .bot .message-balloon {\n        ").concat("side"===n?"".concat(y?"":"margin-left: 2px !important"):""," \n      }\n\n      .bot .message-balloon, .operator .message-balloon {\n         ").concat("side"===n?"border-radius: ".concat(d,"px !important;"):"","\n       }\n\n      .bot .image-box, .operator .image-box {\n        ").concat("side"===n?"border-radius: ".concat(d,"px !important;"):"","\n      }\n      \n      .message.customer::before {\n        margin-left: ").concat(h?f:0,"px;\n      }\n      \n      .message.bot::before {\n        margin-right: ").concat(u?f:0,"px;\n      }\n      \n      .message.operator::before {\n        margin-right: ").concat(p?f:10,"px;\n      }\n      \n      .customer chat-messaage-balloon::before, .customer chat-messaage-balloon::after {\n        right: ").concat(r+(g?f:0)+7,"px !important;\n      }\n      \n      .bot chat-messaage-balloon::before, .bot chat-messaage-balloon::after {\n        left: ").concat(o+(y?f:0)+7,"px !important;\n      }\n      \n      .operator chat-messaage-balloon::before, .operator chat-messaage-balloon::after {\n        left: ").concat(s+(m?f:0)+7,"px !important;\n      }\n      \n      typing.bot::before, typing.bot::after {\n        left: ").concat(o+(y?f:0)+17,"px !important;\n      }\n      \n      typing.operator::before, typing.operator::after {\n        left: ").concat(s+(m?f:0)+17,"px !important;\n      }\n\n      quickReplyField p::before {\n        right: ").concat(-4,"px;\n      }\n      \n      quickReplyField p::after {\n        right: ").concat(-3,"px;\n      }\n      \n      quickReplyField p,  quickReplyField p .frontface {\n        border-radius: ").concat(d,"px ").concat("side"===n?d:2,"px ").concat(d,"px ").concat(d,"px !important;\n      }\n\n      .show-date-on-bottom.customer .message-balloon-wrapper {\n        align-items: flex-end;\n      }\n      .show-date-on-bottom.operator .message-balloon-wrapper,\n      .show-date-on-bottom.bot .message-balloon-wrapper {\n        align-items: self-start;\n      }\n\n      submitError {\n        float: right !important;\n      }"):".bot .message-balloon-wrapper, .operator .message-balloon-wrapper {\n        max-width: 100%;\n        display: flex !important;\n      }\n      \n      .customer .message-balloon-wrapper {\n        max-width: 100%;\n        display: flex !important;\n      }\n\n      .show-date-on-bottom.customer .message-balloon-wrapper {\n        align-items: flex-start;\n      }\n      .show-date-on-bottom.operator .message-balloon-wrapper,\n      .show-date-on-bottom.bot .message-balloon-wrapper {\n        align-items: flex-end;\n      }\n\n      .bot chat-messaage-balloon, .operator chat-messaage-balloon {\n        max-width: 100%;\n        -ms-flex-pack: end !important;\n        -webkit-justify-content: flex-end !important;\n        justify-content: flex-end !important;\n      }\n      \n      .customer chat-messaage-balloon {\n        -ms-flex-pack: start !important;\n        -webkit-justify-content: flex-start !important;\n        justify-content: flex-start !important;\n      }\n\n      .message.bot, .message.operator {\n        -webkit-flex-direction: row-reverse !important;\n        -ms-flex-direction: row-reverse !important;\n        flex-direction: row-reverse !important;\n      }\n\n      .bot .message-balloon, .operator .message-balloon {\n        max-width: 100%;\n        border-radius: ".concat(d,"px ").concat("side"===n?d:2,"px ").concat(d,"px ").concat(d,"px !important;\n      }\n\n      .bot .image-box, .operator .image-box {\n        border-radius: ").concat(d,"px ").concat("side"===n?d:2,"px ").concat(d,"px ").concat(d,"px !important;\n      }\n\n      .message.customer {\n        -webkit-flex-direction: row !important;\n        -ms-flex-direction: row !important;\n        flex-direction: row !important;\n      }\n\n      .customer.message .message-balloon-wrapper::after {\n        position: relative;\n        left: 10px;\n      }\n\n      .bot.message .message-balloon-wrapper::after,\n      .operator.message .message-balloon-wrapper::after {\n        position: relative;\n        right: 10px;\n      }\n\n      .customer .message-balloon {\n        max-width: 100%;\n        border-radius: ").concat("side"===n?d:2,"px ").concat(d,"px ").concat(d,"px ").concat(d,"px !important;\n      }\n\n      quickReplyField p, quickReplyField p .frontface {\n        border-radius: ").concat("side"===n?d:2,"px ").concat(d,"px ").concat(d,"px ").concat(d,"px !important;\n      }\n      \n      .message.customer::before {\n        margin-right: ").concat(h?f:0,"px;\n      }\n      \n      .message.bot::before {\n        margin-left: ").concat(u?f:0,"px;\n      }\n      \n      .message.operator::before {\n        margin-left: ").concat(p?f:0,"px;\n      }\n      \n      .customer chat-messaage-balloon::before, .customer chat-messaage-balloon::after {\n        left: ").concat(r+(g?f:0)+7,"px !important;\n      }\n      \n      .bot chat-messaage-balloon::before, .bot chat-messaage-balloon::after {\n        right: ").concat(o+(y?f:0)+7,"px !important;\n      }\n      \n      .operator chat-messaage-balloon::before, .operator chat-messaage-balloon::after {\n        right: ").concat(s+(m?f:0)+7,"px !important;\n      }\n      \n      typing.bot::before, typing.bot::after {\n        right: ").concat(o+(y?f:0)+17,"px !important;\n      }\n      \n      typing.operator::before, typing.operator::after {\n        right: ").concat(s+(m?f:0)+17,"px !important;\n      }\n\n      quickReplyField p::before {\n        left: ").concat(-4,"px;\n      }\n      \n      quickReplyField p::after {\n        left: ").concat(-3,"px;\n      }\n\n      submitError {\n        float: left !important;\n      }\n\n      imageTag .message.bot .image-box, imageTag .message.operator .image-box {\n        background-position: right !important;\n      }\n  \n      imageTag .message.customer .image-box {\n        background-position: left !important;\n      }")}},{key:"_createInputStyle",value:function(){var e=this._customProperty.inputStyle;return"#send-btn .send-btn-image {\n      ".concat(e["background-image"]?"background-image: url('".concat(e["background-image"],"') !important;"):"","\n    }\n\n    uploadImageButtonImg span svg path {\n      fill: ").concat(e["image-upload-button-fill-color"]," !important\n    }\n\n    sendButtonImg .square {\n      ").concat(e.color?"color: ".concat(e.color," !important;"):"","\n      ").concat(e["background-color"]?"background-color: ".concat(e["background-color"]," !important;"):"","\n      ").concat(e["background-image"]?"background-image: url(".concat(e["background-image"],") !important;"):"","\n    }\n\n    .input-wrapper textarea {\n      ").concat(e["font-size"]?"font-size: ".concat(e["font-size"]," !important;"):"","\n    }\n    \n    input-button-text-field {\n      ").concat(e["sp-input-background-color"]?"background-color: ".concat(e["sp-input-background-color"]," !important;"):"","\n    }\n\n    input-button-text-field textarea {\n      ").concat(e["sp-input-font-color"]?"color: ".concat(e["sp-input-font-color"]," !important;"):"","\n    }")}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return g});var r=n(55),i=n.n(r),o=n(2),a=n.n(o),s=n(3),c=n.n(s),u=n(445),l=window.parent.location.href,p=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\&\|]/g,h=/\\\*+/g,f=/\\\++/g,d=function(e){for(var t in e)try{var n=e[t];e[t]="string"==typeof n?Function("return ".concat(n))():n}catch(n){e[t]=null}},g=function(){function e(t){var r=this;a()(this,e);var o=window.parent.aimWidgetEnv;this._css={newWindowUrl:null,acceptDomain:[],distanceFromScreenBottom:"5px",distanceFromScreenSideEdge:"5px",restartType:"restart",iframe:{zoom:{portrait:"initial",landscape:"initial"}},chat:{position:"right-bottom",height:60,width:60,"loading-color":"#6F6F6F","font-size":"12px","font-family":'"Helvetica Neue",Helvetica,"ヒラギノ角ゴ Pro W3","Hiragino Kaku Gothic Pro","メイリオ",Meiryo,"Meiryo UI","ＭＳ Ｐゴシック","MS PGothic",sans-serif',hideUserInput:!1,imageUplodable:!1,imageZoomType:"chat",disableImageUploadOperatorPermission:!1},minimization:{},balloon:{enable:!0,text:"何かお困りでしょうか？"},botCharacter:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuODrOOCpOODpOODvF8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDY0IDY0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA2NCA2NDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOiM2NjY2NjY7fS5zdDF7ZGlzcGxheTpub25lO30uc3Qye2Rpc3BsYXk6aW5saW5lO30uc3Qze2Rpc3BsYXk6aW5saW5lO2NsaXAtcGF0aDp1cmwoI1NWR0lEXzJfKTtmaWxsOiM2NjY2NjY7fS5zdDR7Y2xpcC1wYXRoOnVybCgjU1ZHSURfNF8pO308L3N0eWxlPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zMiwyYzE2LjUsMCwzMCwxMy41LDMwLDMwUzQ4LjUsNjIsMzIsNjJTMiw0OC41LDIsMzJTMTUuNSwyLDMyLDIgTTMyLDBDMTQuMywwLDAsMTQuMywwLDMyczE0LjMsMzIsMzIsMzJzMzItMTQuMywzMi0zMlM0OS43LDAsMzIsMEwzMiwweiIvPjwvZz48ZyBjbGFzcz0ic3QxIj48ZGVmcz48cGF0aCBpZD0iU1ZHSURfMV8iIGQ9Ik01MS40LDYyLjVsMC4xLTQuNWMwLDAsMCwwLTAuMSwwLjF2MC4xYzAtMC4yLTAuMS0wLjQtMC4xLTAuNWMtMS45LTYtNi44LTUuNS0xMy42LTEwLjJjLTAuMi0wLjIsMC4zLTAuNC0wLjYtMC41di00YzItMi42LDMuNi01LjUsNC44LTguNWMwLjktMC44LDEuNS0xLjgsMS44LTIuOWMwLjctMiwwLjYtNC0wLjItNC4zYy0wLjMtMC4yLTAuNywwLTEuMSwwLjRjLTAuMS0wLjYtMC4zLTEuMy0wLjUtMS45bDAuNy0wLjRjMCwwLTIuMy0xMi42LTcuNC0xMi43Yy01LjItMC4xLTYsMi4yLTYsMi4ycy0yLjUtMS40LTYsMS40Yy0zLjQsMi44LTIuOSwxMC40LTIuOSwxMC40aDAuNGMtMC4xLDAuMy0wLjEsMC42LTAuMiwwLjljLTAuMy0wLjMtMC43LTAuNS0xLjEtMC4zYy0wLjgsMC40LTAuOSwyLjMtMC4yLDQuNGMwLjMsMS4xLDAuOSwyLjEsMS43LDIuOWMxLjIsMywyLjgsNS45LDQuNyw4LjV2My44YzAsMC4xLTAuNCwwLjItMC42LDAuM2MtOCw0LjQtMTIuOCwzLjMtMTQuNiw5LjhjLTAuMSwwLjQtMC4yLDAuOC0wLjIsMS4yYy0wLjQtMC4zLTAuMSwyLjYtMC40LDIuM2wtMC42LDEuNGM2LjEsNC40LDEzLjYsNy4xLDIxLjcsNy4xQzM4LjUsNjguNyw0NS42LDY2LjQsNTEuNCw2Mi41eiIvPjwvZGVmcz48Y2xpcFBhdGggaWQ9IlNWR0lEXzJfIiBjbGFzcz0ic3QyIj48dXNlIHhsaW5rOmhyZWY9IiNTVkdJRF8xXyIgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIvPjwvY2xpcFBhdGg+PGNpcmNsZSBjbGFzcz0ic3QzIiBjeD0iMzIiIGN5PSIzMiIgcj0iMzIiLz48L2c+PGc+PGRlZnM+PGNpcmNsZSBpZD0iU1ZHSURfM18iIGN4PSIzMiIgY3k9IjMyIiByPSIzMiIvPjwvZGVmcz48Y2xpcFBhdGggaWQ9IlNWR0lEXzRfIj48dXNlIHhsaW5rOmhyZWY9IiNTVkdJRF8zXyIgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIvPjwvY2xpcFBhdGg+PGcgaWQ9IuOCouOCpOOCs+ODsyIgY2xhc3M9InN0NCI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTM0LDIzLjljLTAuMS0xLjctMC40LTMuNC0wLjgtNWMtMC43LTEuOS0xLjYtMy43LTIuNy01LjRjMS0xLjMsMS42LTIuOCwxLjUtNC40YzAtMy45LTMuMS03LjEtNy03LjFjLTMuOSwwLTcuMSwzLjEtNy4xLDdjMCwzLjksMy4xLDcuMSw3LDcuMWMwLDAsMCwwLDAuMSwwYzAuNiwwLDEuMi0wLjEsMS44LTAuMmMwLjksMS40LDEuNywyLjgsMi4zLDQuNGMwLjMsMS4yLDAuNSwyLjUsMC42LDMuN2MtMTQuNSwxLjYtMjYsMTguNC0yNiwzOS40aDU2LjdDNjAuNCw0Mi4yLDQ4LjcsMjUuMywzNCwyMy45eiBNMjEuNCw1Mi43Yy0zLjIsMC01LjgtMi43LTUuOC01LjljMC0zLjIsMi43LTUuOCw1LjktNS44YzMuMiwwLDUuOCwyLjYsNS44LDUuOEMyNy4zLDUwLjEsMjQuNiw1Mi43LDIxLjQsNTIuN0MyMS40LDUyLjcsMjEuNCw1Mi43LDIxLjQsNTIuN3ogTTQyLjIsNTIuN2MtMy4yLDAtNS44LTIuNy01LjgtNS45YzAtMy4yLDIuNy01LjgsNS45LTUuOGMzLjIsMCw1LjgsMi42LDUuOCw1LjhDNDgsNTAuMSw0NS40LDUyLjcsNDIuMiw1Mi43QzQyLjIsNTIuNyw0Mi4yLDUyLjcsNDIuMiw1Mi43eiIvPjwvZz48L2c+PC9zdmc+",botCharacterBorder:"",operatorCharacter:"",customerCharacter:"",header:{component:"headerDefault",text:"AI Messengerサポートチーム",showRefreshButton:!1,"refresh-button-color":"#666","refresh-button-hover-color":"#00CCFF",hideTitle:!1},talks:{"icon-position":"shoulder",direction:"normal","customer-icon-width":"40px","customer-icon-height":"40px","operator-icon-width":"40px","operator-icon-height":"40px","bot-icon-width":"40px","bot-icon-height":"40px","box-shadow":"0px 0px 2px rgba(0, 0, 0, 0.35)","open-link-new-window":!0,"resend-fail-message-color":"#00d854","delete-fail-message-color":"#ff4833",enableHtmlMessage:!1,"quickreplies-no-arrow":!1,"vertical-quickreplies":!1,"expand-image":!1,"background-color":"#ffffff"},input:{component:"inputFieldDefault","background-color":"#337fff",color:"#FFFFFF","font-size":"12px","sp-input-background-color":"#F7F7F7","sp-input-font-color":"#797878","image-upload-button-fill-color":"#0099FF",masking:[],typing:"none"},firebase:{apiKey:o.apiKey,authDomain:o.authDomain,databaseURL:o.databaseURL,storageBucket:o.storageBucket}},void 0===t?window.Customize=this._css:(this._css=n.i(u.a)(this._css,t),this._css.override&&Object.keys(this._css.override).some(function(e){var t=e.replace(p,"\\$&").replace(h,".*").replace(f,".+");return!!new RegExp(t).test(l)&&(r._css=n.i(u.a)(r._css,r._css.override[e]),!0)}),window.Customize=this._css),this._chatWidth=this._css.chat.width,this._chatHeight=this._css.chat.height,this._iframe=this._css.iframe,this._balloonEnable=this._css.balloon.enable,this._balloonText=this._css.balloon.text,this._headerText=this._css.header.text,this._newWindowUrl=this._css.newWindowUrl,this._acceptDomain=this._css.acceptDomain,this._distanceFromScreenBottomEdge="number"==typeof this._css.distanceFromScreenBottomEdge?"".concat(this._css.distanceFromScreenBottomEdge,"px"):"string"==typeof this._css.distanceFromScreenBottomEdge?this._css.distanceFromScreenBottomEdge:"5px",this._distanceFromScreenSideEdge="number"==typeof this._css.distanceFromScreenSideEdge?"".concat(this._css.distanceFromScreenSideEdge,"px"):i()(this._css.distanceFromScreenSideEdge)?this._css.distanceFromScreenSideEdge:"5px",this._firebase=this._css.firebase,this._domain=this._css.domain;var s=this._css.callbacks;s&&(d(s),s.onImmediate&&s.onImmediate(parent.aiMessenger,window.Customize),s.onBeforeMount&&parent.aiMessenger.on("beforeMount",s.onBeforeMount),s.onOpen&&parent.aiMessenger.on("open",s.onOpen),s.onClose&&parent.aiMessenger.on("close",s.onClose),s.onStartConversation&&parent.aiMessenger.on("startConversation",s.onStartConversation),s.onLoad&&parent.aion("mount",s.onMount),s.onReplyClicked&&parent.aiMessenger.on("replyClicked",s.onReplyClicked),s.onButtonClicked&&parent.aiMessenger.on("buttonClicked",s.onButtonClicked),s.onLinkClicked&&parent.aiMessenger.on("linkClicked",s.onLinkClicked))}return c()(e,[{key:"expandImage",get:function(){return this._css.talks["expand-image"]}},{key:"verticalQuickReplies",get:function(){return this._css.talks["vertical-quickreplies"]}},{key:"chatStyle",get:function(){return this._css.chat}},{key:"minimizationStyle",get:function(){return this._css.minimization}},{key:"balloonStyle",get:function(){return this._css.balloon}},{key:"botCharacter",get:function(){return this._css.botCharacter}},{key:"botCharacterBorder",get:function(){return this._css.botCharacterBorder}},{key:"operatorCharacter",get:function(){return this._css.operatorCharacter}},{key:"customerCharacter",get:function(){return this._css.customerCharacter}},{key:"headerStyle",get:function(){return this._css.header}},{key:"talksStyle",get:function(){return this._css.talks}},{key:"inputStyle",get:function(){return this._css.input}},{key:"acceptDomain",get:function(){return this._acceptDomain}},{key:"balloonEnable",get:function(){return this._balloonEnable}},{key:key:"firebaseConfig",get:function(){return this._firebase}}]),e}()},function(e,t,n){"use strict";function r(e){var t=/^#/.test(e)?i(e):o(e);return t&&a(t)<.5?"#FFFFFF":"#6F6F6F"}t.a=r;var i=function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},o=function(e){var t=e.replace(/[^\d,]/g,"").split(",");return t?{r:t[0],g:t[1],b:t[2]}:null},a=function(e){var t=e.r/255,n=e.g/255,r=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}},function(e,t,n){"use strict";var r=n(1),i=n.n(r),o={format:function(e,t){return t||(t="YYYY-MM-DD hh:mm"),e=new Date(e),t=t.replace(/YYYY/g,e.getFullYear()),t=t.replace(/MM/g,("0"+(e.getMonth()+1)).slice(-2)),t=t.replace(/DD/g,("0"+e.getDate()).slice(-2)),t=t.replace(/hh/g,("0"+e.getHours()).slice(-2)),t=t.replace(/mm/g,("0"+e.getMinutes()).slice(-2)),t=t.replace(/ss/g,("0"+e.getSeconds()).slice(-2)),"".concat(t,"　")},diffTime:function(e){var t=(new Date-e)/1e3/60/60,n=t/24;if(1<=n)return"".concat(Math.floor(n),"日前");if(1<=t)return"".concat(Math.floor(t),"時間前");var r=60*o.getDecimal(t);return 1<=r?"".concat(Math.floor(r),"分前"):"たった今"},getDecimal:function(e){return parseFloat("0."+String(e).split(".")[1])},dateFormatToggle:function(e,t){t.target.getAttribute("data-dateformat")&&("relative"==t.target.getAttribute("da))},setNormalFormat:function(e,t){t.target.setAttribute("data-information",o.format(e)),t.target.setAttribute("data-dateformat","normal")},setRelativeFormat:function(e,t){t.target.setAttribute("data-information",o.diffTime(e)),t.target.setAttribute("data-dateformat","relative")}};i.a.mixin("date",o)},function(e,t,n){"use strict";var r=n(1),i=n.n(r),o=n(57),a={createHTMLReplacedText:function(e,t){;i.a.mixin("mediaType",a)},function(e,t,n){"use strict";var r=n(1),i=n.n(r),o=n(72),a={quickRepliesAction:o.a.instance,checkLastMessage:function(e){var t=e[e.lengtnimation:!1})}};i.a.mixin("quickReplies",a)},function(e,t,n){"use strict";function r(){!function(e,t,n,r,i,o,a,s){e.RaygunObject=i,e[i]=e[i]||function(){(e[i].o=e[i].o||[]).push(arguments)},o=t.createElement(n),a=t.getElementsByTagName(n)[0],o.async=1,o.src="//cdn.raygun.io/raygun4js/raygun.min.js",a.parentNode.insertBefore(o,a),s=e.onerror,e.onerror=function(t,n,r,o,a){s&&s(t,n,r,o,a),a||(a=new Error(t)),e[i].q=e[i].q||[],e[i].q.push({e:a})}}(window,document,"script",0,"rg4js")}t.a=r},function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(1),c=n.n(s),u=n(9),l=n(180),p=n(10),h=n(32),f=n(33),d=(f.a.instance,new(function(){function e(){i()(this,e),c.a.observable(this),this._fetchLoading=!1,this._conversationResetFlag=!1,this._customerState=null,this.on(l.a.yconnectRedirectUrl,this._yconnectRedirectUrl),this.on(l.a.setCustomerState,this._setCustomerState),this.on(l.a.updateCustomerState,this._updateCustomerState),this.on(l.a.setConversationResetFlag,this._setConversationResetFlag.bind(this)),this.on(l.a.resetFrame,this._resetFrame.bind(this)),this.on(l.a.createEmptyCustomer,this._createEmptyCustomer.bind(this)),this.on(l.a.createCustomer,this._createCustomer.bind(this)),this.on(l.a.createConversation,this._createConversation.bind(this)),this.on(l.a.closeConversation,this._closeConversation.bind(this)),this.on(l.a.sendTyping,this._sendTyping.bind(this)),this.on(l.a.sendCustomerTyping,this._sendCustomerTyping.bind(this)),this.on(l.a.createImage,this._createImage.bind(this)),this.on(l.a.createMessage,this._createMessage.bind(this)),this.on(l.a.postBack,this._postBack.bind(this)),this.on(l.a.pushLogs,this._pushLogs.bind(this)),this.on(l.a.setAdditional,this._setAdditional.bind(this)),this.on(l.a.apiAuth,this._apiAuth.bind(this)),this.on(l.a.refreshToken,this._refreshToken.bind(this)),this.on(l.a.bindConversation,this._bindConversation.bind(this)),this.on(l.a.sendBufferedDummies,this._sendBufferedDummies.bind(this))}return a()(e,[{key:"createCustomerHost",get:function(){return"/v1/tenants/".concat(p.a.tenantId,"/customers")}},{key:"typingHost",get:function(){return"/liveagent/v1/tenants/".concat(p.a.tenantId,"/typing")}},{key:"oauthHost",get:function(){return"/v1/tenants/".concat(p.a.tenantId,"/oauth/token")}},{key:"createConversationHost",get:function(){return"/v1/tenants/".concat(p.a.tenantId,"/conversations")}},{key:"customerTypingHost",get:function(){return"/v1/tenants/".concat(p.a.tenantId,"/conversations/").concat(p.a.conversationId,"/typingCustomer")}enants/".concat(p.a.tenantId,"/conversations/").concat(p.a.conversationId,"/messages")}},{key:"callOperatorHost",get:function(){return"/v1/tenants/".concat(p.a.tereturn"/v2/tenants/".concat(p.a.tenastBackHost",get:function(){return"/v2/tenants/".concat(p.a.tenantId)}},{key:"setAdditionalHost",get:function(){return"/v1/tenants/".concat(p.a.tenantId,"/customers/").concat(p.a.userId,"/addition")}},{key:"setCustomerStateHost",get:function(){retntId,"/customers/").concat(p.a.userId,"/plHost",get:function(){return"/v1/tenants/".concat(p.a.tenantId,"/yconnect/redirect-url")}},{key:"fetchLoading",get:function(){return this._fetchLoading}},{key:"conversationdBufferedDummies",get:function(){return this._sendBufferedDummies}},{key:"pushLogsHost",get:function(){return"/chat-status"}}]),a()(e,[{key:"_setCustomerState",value:function(e){this._customerState=e()}},{key:"_updateCustomerState",value:function(e){e("".concat(p.a.apiEndpoint).concat(this.setCustomerStateHost),this._customerState)}},{key:"_setConversationResetFlag",value:function(e){this._conversationResetFlag=e(this._conversationResetFlag)}},{key:"_createEmptyCustomer",value:function(e){e(p.a.tenantId)}},{key:"_createCustomer",value:function(e){e("".concat(p.a.apiEndpoint).concat(this.createCustomerHost))}},{key:"_createConversation",value:function(e){e("".concat(p.a.apiEndpoint).concat(this.createConversationHost))}},{key:"_closeConversation",value:function(e){e("".concat(p.a.apiEndpoint).concat(this.createConversationHost))}},{key:"_sendTyping",value:function(e){if(p.a.conversationId){e("".concat(p.a.liveAgentEndpoint).concat(this.typingHost,"/").concat(p.a.conversationId))}}},{key:"_sendCustomerTyping",value:function(e){p.a.conversationId&&e("".concat(p.a.messageEndpoint).concat(this.customerTypingHost))}},{key:"_createMessage",value:function(e){if(p.a.conversationId){e("".concat(p.a.messageEndpoint).concat(this.createMessageHost))}}},{key:"_createImage",value:function(e){if(p.a.conversationId){e("".concat(p.a.messageEndpoint).concat(this.createMessageHost,"/content"))}}},{key:"_resetFrame",value:function(e){p.a.conversationId&&e("".concat(p.a.messageEndpoint).concat(this.resetFrame))}},{key:"_postBack",value:function(e){e("".concat(p.a.messageEndpoint).concat(this.postBackHost))}},{key:"_pushLogs",value:function(e){e("".concat(p.a.stHost))}},{key:"_setAdditional",value:function(e){var t="".concat(p.a.apiEndpoint).concat(this.setAdditionalHost);e(p.a.additional,t)}},{key:"_apiAuth",value:function(e){e("".concat(p.a.apiEndpoint).concat(this.oauthHost))}},{key:"_refreshToken",value:function(e){e("".concat(p.a.apiEndpoint).concat(this.oauthHost))}},{key:"_bindConversation",value:function(e){e(p.a.tenantId)}},{key:"_sendBufferedDummies",value:function(e){e(h.a.dummyMessages)}},{key:"_yconnectRedirectUrl",value:function(e){e("".concat(p.a.messageEndpoint).concat(this.yconnectRedirectUrlHost))}}]),e}()));d.ActionTypes={},u.a.addStore("Request",d),t.a=d},function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(1),c=n.n(s),u=n(9),l=n(201),p={phone:/(?:0\d-\d{4}-\d{4})|(?:0\d{3}-\d{2}-\d{4})|(?:\(0\d\)\d{4}-\d{4})|(?:\(0\d{3}\)\d{2}-\d{4})|(?:(070|080|090)-\d{4}-\d{4})|(?:050-\d{4}-\d{4})|(?:0120-\d{3}-\d{3})|(?:\d{10}|\d{11})/g,email:/[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*/g,myNumber:/\d{12}/g,drivingLicence:/\d{12}/g,passport:/[a-zA-Z]{2}\d{7}/g,residentCode:/\d{11}/},h=Array(10).join("•"),f=new(function(){function e(){i()(this,e),c.a.observable(this),this._inputValue="",this.on(l.a.submit,this._submit.bind(this)),this.on(l.a.setInputValue,this._setValue.bind(this)),this.on(l.a.eraseInputValue,this._eraseInputValue.bind(this)),this.on(l.a.blurInput,this._blurInput.bind(this))}return a()(e,[{key:"inputValue",get:function(){return this._inputValue}}]),a()(e,[{key:"setMaskingMethod",value:function(e){this._maskingMethods="all"===e?Object.keys(p):e}},{key:"_submit",value:function(e){this._inputValue=e(this._inputValue),u.a.trigger("SpInput",this.ActionTypes.submit)}},{key:"_setValue",value:function(e){this._inputValue=e(this._inputValue),this._inputValue=this._maskingMethods.reduce(function(e,t){var n=p[t];return n?e.replace(n,h):(console.error("Invalid masking method ".concat(t)),e)},this._inputValue),u.a.trigger("SpInput",this.ActionTypes.setInputValue)}},{key:"_eraseInputValue",value:function(e){this._inputValue=e(this._inputValue),u.a.trigger("SpInput",this.ActionTypes.eraseInputValue)}},{key:"_blurInput",value:function(e){e(),u.a.trigger("SpInput",this.ActionTypes.blurInput)}}]),e}());f.Actialue:"spiaseInputValue:"spinput_store_erase_input_value",blurInput:"spinput_store_blur_input"},u.a.addStore("SpInput",f),t.a=f},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(2),i=n.n(r),(){function e(){i()(this,e)}return a()(e,null,[{key:"encode",value:function(e){return btoa(encodeURIComponent(e))}},{key:"decode",value:function(e){return decodeURIComponent(atob(e))}}]),e}()},function(e,t,n){"use strict"},function(e,t,n){"use strict";n.n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(46),c=n(59),u=window.parent.swallow_widget_initial_configs.tenantId,l="__aim_dirty__",p=function(){function e(){i()(this,e)}return a()(e,null,[{key:"set",value:function(){c.a.removeItem(l),s.a.setItem(l,u)}},{key:"isChanged",value:function(){return s.a.hasItem(l)&&s.a.getItem(l)!==u}}]),e}()},function(e,t,n){"use strict";function r(e,t){var n=0;e.addEventListener("touchstart",function(e){n=e.touches[0].clientY}),t.addEventListener("touchmove",function(e){var t=e.touches[0].clientY,r=e.target.scrollTop,i=n-t<0?"up":"down";0===r&&"up"===i?e.preventDefault():r>=e.target.scrollHeight-e.target.offsetHeight&&"down"===i&&e.preventDefault(),n=t})}t.a=r},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(17),i=n.n(r),o=n(16),a=n.n(o),s=n(10),c=function(){var e=a()(i.a.mark(function e(){var t,n,r,o;rerev=e.next){case 0:return console.log(s.a),t=firebase.database().ref("".concat(s.a.envPrefix,"/").concat(s.a.tenantId,"/archives/").concat(s.a.conversationId)),e.prev=2,e.next=5,t.once("value");case 5:return n=e.sent,r=n.val(),o=r.customer,e.abrupt("return",o&&o.id===s.a.userId);case 11:return e.prev=11,e.t0=e.catch(2),e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,this,[[2,11]])}));return function(){return e.apply(this,arguments)}}()},,function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return f});var r,i=n(17),o=n.n(i),a=n(16),s=n.n(a),c=n(2),u=n.n(c),l=n(3),p=n.n(l),h=n(27),f=n.i(h.a)(r=function(){function=!,[{key:"acquire",value:function(){var t=s()(o.a.mark(function t(n){var r=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.locked){t.next=4;break}return t.abrupt("return",new e(function(){var e=s()(o.a.mark(function e(t,i){var a,s,c,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r.locked=!0,r.stack=(new Error).stack,a=n.l(e){r.locked=!1,i(e)},u=a>=1?n(s,c):n(),0!==a||!u.then){e.next=11;break}return e.abrupt("return",u.then(s,c));case 11:if(0!==a||u.then){e.next=13;break}thuire must be function that return Promise or accept one or two arguments.");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),i(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])}));return function(t,n){return e.apply(this,arguments)}}()));case 4:return t.abrupt("return",e.reject("This Function is locked in ".concat(this.stack,".")));case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),t}())||r}).call(t,n(11))},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(186),i=function eeInt(e.substr(n,2),16));ret,,,,,,,,,,,,,,,,, n(e){return!!e.constructotion t(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);==n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[nest(n)&&(n=u(t,n));try{n=encodeUe]||(O.test(e)?F[" "+e]=e+"/":F[" "+e]=h(e,"/",!0)),e=F[" "+e];var n=-1===e.indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(N,"$1")+t:"/"==e){var t=e.match(/^\s+/);return null===t?e:t[0].length>=r.length?e.slice(r.length):e}).join("\n")}function v(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function b(e){var t,n,r="",i=e.length;for(t=0;t<i;t+,t,n){if(void 0===e||null===e)throw new Error("marked(): input parameter is undefined or null");if("st({},w.defaults,t||{}),pe(t),n){var r,i=t.highlight;try{r=ee.lex(e,t)}catch(e){return n(e)}var o=function(e){var o;if(!e)try{o=ue.parse(r,t)}catch(t){e=t}return t.highlight=i,e?n(e):n(null,o)};if(!i||i.length<3)return o();if(delete t.highlight,!r.length)return o();var a=0;return w.ssage+"",!0)+"</pre>";throw e}}var k=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){function t(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrngPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function n(t){e.exports.defaults{defaults:t(),getDefaults:t,changeDefaults:n}}),x=(k.defaults,k.getDefaults,k.changeDefaults,/[&<>"']/),_=/[&<>"']/g,T=/[<>"']|&(?!#?\w+;)/,S=/[<>"']|&(?!#?\w+;)/g,E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},A=function(e){retA-Fa-f]+)|(?:\w+));?/gi,C=/(^|[^:\/*[^/tion(){fu:"space",raph"===r.t.replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].align[r])?n.align[r]="right":/^ *:-+: *$/.test(n.align[r])?n.align[r]="center":/^ *:-+ *$/.test(n.align[r])?n.align[r]="left":n.align[r]=null;for(i=n.cells.length,r=0;r<i;r++)n.cells[r]=z(n.cells[r],n.header.length);return n}}},t.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},t.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var n=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],text:n}}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){for(var n,r,i,o,a,s,c,u=t[0],l=t[2],p=l.length>1,h=")"===l[l.length-1],f={type:"list",raw:u,ordered:p,start:p?+l.slice(0,-1):"",loose:!1,items:[]},d=t[0].match(this.rules.block.item),g=!1,m=d.length,y=0;y<m;y++)n=d[y],u=n,r=n.length,n=n.replace(/^ *([*+-]|\d+[.)]) ?/,""),~n.indexOf("\n ")&&(r-=n.length,n=this.options.pedantic?n.replace(/^ {1,4}/gm,""):n.replace(new RegExp("^ {1,"+r+"}","gm"),"")),y!==m-1&&(i=this.rulese=!0),s=/^\[[ xX]\] /.test(n),c=void 0,s&&(c=" "!==n[1],n=n.replace(/^\[[ xX]\] +/,"")),f.items.push({type:"list_item",raw:u,task:s,checked:c,loose:a,text:n});return f}},t.html=function(e){var t=n:t[2].repl[0];var r,i=r])?n.a=functionAt(0)?xec(e);if(t)return{type:"escape",raw:t[0],text:U(t[1])}},t.tag=function(e,t,n){var r=this.rules.inline.tag.exec(e);if(r)return!t&&/^<a /i.test(r[0])?t=!0:t&&/^<\/a>/i.test(r[0])&&(t=!1),!n&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?n=!0:n&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(n=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:t,inRawBlock:n,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):U(r[0]):r[0]}},t.link=function(e){var t=this.rules.inline.link.exec(e);if(t){""}else a=t[3]?t[3].slice(1,-1):"";o=o.trim().replace(/^<([\s\S]*)>$/,"$1");return m(t,{href:o?o.replace(this.rules.inline._escapes,"$1"):o,title:a?a.replace(this.rules.inline._escapes,"$1"):a},t[0])}},t.reflink=function(e,t){var n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){var r=(n[2]||n[1]).replace(/\s+/g," ");if(!(r=t[r.toLowerCase()])||!r.href){var i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return m(n,r,n[0])}},t.strong=function(e,t,n){void 0===n&&(n="");var r=this.rules.inline.strong.start.exec(e);if(r&&(!r[1]||r[1]&&(""===n||this.rules.inline.punctuation.exec(n)))){t=t.slice(-1*e.length);var i="**"===r[0]?this.rules.inline.strong.endAst:this.rules.inline.strong.endUnd;i.lastIndex=0;for(var o;null!=(r=i.exec(t));)if(o=this.rules.inline.strong.middle.exec(t.slice(0,r.index+3)))return{type:"strong",raw:e.slice(0,o[0].length),text:e.sliine.e;)if(olength),tex),{typ?t(n[1]):n[1]),i="mailto:"+r):(r=U(n[1]),i=r),{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}},t.url=function(e,t){var n;if(n=this.rules.inline.url.exec(e)){var r,i;if("@"===n[2])r=U(this.options.mangle?t(n[0]):n[0]),i="mailto:"+r;else{var o;do{o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(o!==n[0]);r=U(n[0]),i="www."===n[1]?"http://"+r:r}return{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}},t.inlineText=function(e,t,n){var r=this.rules.inline.text.exec(e);if(r){var i;return i=t?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):U(r[0]):r[0]:U(this.options.smartypants?n(r[0]):r[0]),{type:"text",raw:r[0],text:i}}},e}(),W=B.noopTest,V=B.edit,G=B.merge,Y={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6}) +([^\n]*?)(?: +#+)? *(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:W,table:W,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/};Y._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,Y._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,Y.def=V(Y.def).replace("label",Y._label).replace("title",Y._title).getRegex(),Y.bullet=/(?:[*+-]|\d{1,9}[.)])/,Y.item=/^( *)(bull) ?[^\n]*(?:\n(?!\1bull ?)[^\n]*)*/,Y.item=V(Y.item,"gm").replace(/bull/g,Y.bullet).getRegex(),Y.list=V(Y.list).replace(/bull/g,Y.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Y.def.source+")").getRegex(),Y._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Y._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Y.html=V(Y.html,"i").replace("comment",Y._comment).replace("tag",Y._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Y.paragraph=V(Y._paragraph).replace("hr",Y.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",Y._tag).getRegex(),Y.blockquote=V(Y.blockquote).replace("paragraph",Y.paragraph).getRegex(),Y.normal=G({},Y),Y.gfm=G({},Y.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Y.gfm.nptable=V(Y.gfm.nptable).replace("hr",Y.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",Y._tag).getRegex(),Y.gfm.table=V(Y.gfm.table).replace("hr",Y.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",Y._tag).getRegex(),Y.pedantic=G({},Y.normal,{html:V("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Y._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,fences:W,paragraph:V(Y.normal._paragraph).replace("hr",Y.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Y.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Q={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:W,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",strong:{start:/^(?:(\*\*(?=[*punctuation]))|\*\*)(?![\s])|__/,middle:/^\*\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*\*$|^__(?![\s])((?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?)__$/,endAst:/[^punctuation\s]\*\*(?!\*)|[punctuation]\*\*(?!\*)(?:(?=[punctuation_\s]|$))/,endUnd:/[^\s]__(?!_)(?:(?=[punctuation*\s])|$)/},em:{start:/^(?:(\*(?=[punctuation]))|\*)(?![*\s])|_/,middle:/^\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*$|^_(?![_\s])(?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?_$/,endAst:/[^punctuation\s]\*(?!\*)|[punctuation]\*(?!\*)(?:(?=[punctuation_\s]|$))/,endUnd:/[^\s]_(?!_)(?:(?=[punctuation*\s])|$)/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:W,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\s*punctuation])/};Q._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",Q.punctuation=V(Q.punctuation).replace(/punctuation/g,Q._punctuation).getRegex(),Q._blockSkip="\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>",Q._overlapSkip="__[^_]*?__|\\*\\*\\[^\\*\\]*?\\*\\*",Q._comment=V(Y._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Q.em.start=V(Q.em.start).replace(/punctuation/g,Q._punctuation).getRegex(),Q.em.middle=V(Q.em.middle).replace(/punctuation/g,Q._punctuation).replace(/overlapSkip/g,Q._overlapSkip).getRegex(),Q.em.endAst=V(Q.em.endAst,"g").replace(/punctuation/g,Q._punctuation).getRegex(),Q.em.endUnd=V(Q.em.endUnd,"g").replace(/punctuation/g,Q._punctuation).getRegex(),Q.strong.start=V(Q.strong.start).replace(/punctuation/g,Q._punctuation).getRegex(),Q.strong.middle=V(Q.strong.middle).replace(/punctuation/g,Q._punctuation).replace(/overlapSkip/g,Q._overlapSkip).getRegex(),Q.strong.endAst=V(Q.strong.endAst,"g").replace(/punctuation/g,Q._punctuation).getRegex(),Q.strong.endUnd=V(Q.strong.endUnd,"g").replace(/punctuation/g,Q._punctuation).getRegex(),Q.blockSkip=V(Q._blockSkip,"g").getRegex(),Q.overlapSkip=V(Q._overlapSkip,"g").getRegex(),Q._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Q._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Q._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Q.autolink=V(Q.autolink).replace("scheme",Q._scheme).replace("email",Q._email).getRegex(),Q._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Q.tag=V(Q.tag).replace("comment",Q._comment).replace("attribute",Q._attribute).getRegex(),Q._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Q._href=/<(?:\\[<>]?|[^\s<>\\])*>|[^\s\x00-\x1f]*/,Q._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Q.link=V(Q.link).replace("label",Q._label).replace("href",Q._href).replace("title",Q._title).getRegex(),Q.reflink=V(Q.reflink).replace("label",Q._label).getRegex(),Q.reflinkSearch=V(Q.reflinkSearch,"g").replace("reflink",Q.reflink).replace("nolink",Q.nolink).getRegex(),Q.normal=G({},Q),Q.pedantic=G({},Q.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:V(/^!?\[(label)\]\((.*?)\)/).replace("label",Q._label).getRegex(),reflink:V(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Q._label).getRegex()}),Q.gfm=G({},Q.normal,{escape:V(Q.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:inline,X=B.repeatString,ee=function(){function e(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||$,this.optione:K.normal};this.options.pedantic?(t.block=J.pedantic,t.inline=K.pedantic):this.options.gfm&&(t.block=J.gfm,this.options.breaks?t.inline=K.breaks:t.inline=K.gfm),this.tokenizer.rules=t}e.lex=function(t,n){return new e(n).lex(t)},e.lexInline=function(t,n){return new e(n).inlineTokens(t)};var n=e.prototype;return n.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens,!0),this.inline(this.tokens),this.tokens},n.blockTokens=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=!0),e=e.replace(/^ +$/gm,"");for(var r,i,o,a;e;)if(r=this.tokenizer.space(e))e=e.substring(r.raw.length),r.type&&t.push(r);else if(r=this.tokenizer.code(e,t))e=e.substring(r.raw.length),r.type?t.push(r):(a=t[t.length-1],a.raw+="\n"+r.raw,a.text+="\n"+r.text);else if(r=this.tokenizer.fences(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.heading(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.nptable(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.hr(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.blockquote(e))e=e.substring(r.raw.length),r.tokens=this.blockTokens(r.text,[],n),t.push(r);else if(r=this.tokenizer.list(e)){for(e=e.substring(r.raw.length),o=r.items.length,i=0;i<o;i++)r.items[i].tokens=this.blockTokens(r.items[i].text,[],!1);t.push(r)}else if(r=this.tokenizer.html(e))e=e.substring(r.raw.length),t.push(r);else if(n&&(r=this.tokenizer.def(e)))e=e.substring(r.raw.length),this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});else if(r=this.tokenizer.table(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.lheading(e))e=e.substring(r.raw.length),t.push(r);else if(n&&(r=this.tokenizer.paragraph(e)))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.text(e,t))e=e.substring(r.raw.length),r.type?t.push(r):(a=t[t.length-1],a.raw+="\n"+r.raw,a.text+="\n"+r.text);else if(e){var s="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(s);break}throw new Error(s)}return t},n.inline=function(e){var t,n,r,i,o,a,s=e.length;for(t=0;t<s;t++)switch(a=e[t],a.type){case"paragraph":case"text":case"heading":a.tokens=[],this.inlineTokens(a.text,a.tokens);break;case"table":for(a.tokens={header:[],cells:[]},i=a.header.length,n=0;n<i;n++)a.tokens.header[n]=[],this.inlineTokens(a.header[n],a.tokens.header[n]);for(i=a.cells.length,n=0;n<i;n++)for(o=a.cells[n],a.tokens.cells[n]=[],r=0;r<o.length;r++)a.tokens.cells[n][r]=[],this.inlineTokens(o[r],a.tokens.cells[n][r]);break;case"blockquote":this.inline(a.tokens);break;case"list":for(i=a.items.length,n=0;n<i;n++)this.inline(a.items[n].tokens)}return e},n.inlineTokens=function(e,t,n,r,i){void 0===t&&(t=[]),void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i="");var o,a,s=e;if(this.tokens.links){var c=Object.keys(this.tokens.links);if(c.length>0)for(;null!=(a=this.tokenizer.rules.inline.reflinkSearch.exec(s));)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,a.index)+"["+X("a",a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(a=this.tokenizer.rules.inline.blockSkip.exec(s));)s=s.slice(0,a.index)+"["+X("a",a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;e;)if(o=this.tokenizer.escape(e))e=e.substring(o.raw.length),t.push(o);else if(o=this.tokenizer.tag(e,n,r))e=e.substring(o.raw.length),n=o.inLink,r=o.inRawBlock,t.push(o);else if(o=this.tokenizer.link(e))e=e.substring(o.raw.length),"link"===o.type&&(o.tokens=this.inlineTokens(o.text,[],!0,r)),t.push(o);else if(o=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(o.raw.length),"link"===o.type&&(o.tokens=this.inlineTokens(o.text,[],!0,r)),t.push(o);else if(o=this.tokenizer.strong(e,s,i))e=e.substring(o.raw.length),o.tokens=this.inlineTokens(o.text,[],n,r),t.push(o);else if(o=this.tokenizer.em(e,s,i))e=e.substring(o.raw.length),o.tokens=this.inlineTokens(o.text,[],n,r),t.push(o);else if(o=this.tokenizer.codespan(e))e=e.substring(o.raw.length),t.push(o);else if(o=this.tokenizer.br(e))e=e.substring(o.raw.length),t.push(o);else if(o=this.tokenizer.del(e))e=e.substring(o.raw.length),o.tokenpush(o);else if(o=this.tokenizer.autolink(e,b))e=e.l?"<br r='unction(e){return e.toLowerCase().trim().rephis.seen[e];do{r++,n=e+"-"+r}while(this.seen.hasOwnProperty(n},t.slug=function(e,t){void 0===t&&(t={});var n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)},e}(),se=k.defaults,ce=B.unescape,ue=function(){function e(e){this.options=e||se,this.options.renderer=this.options.renderer||new ie,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new oe,this.slugger=new ae}e.parse=function(t,n){return new e(n).parse(t)},e.parseInline=function(t,n){return new e(n).parseInline(t)};var t=e.prototype;return t.parse=function(e,t){void 0===t&&(t=!0);var n,r,i,o,a,s,c,u,l,p,h,f,d,g,m,y,v,b,w="",k=e.length;for(n=0;n<k;n++)switch(p=e[n],p.type){case"space":continue;case"hr":w+=this.renderer.hr();continue;case"heading":w+=this.renderer.heading(this.parseInline(p.tokens),p.depth,ce(this.parseInline(p.tokens,this.textRenderer)),this.slugger);continue;case"code":w+=this.renderer.code(p.text,p.lang,p.escaped);continue;case"table":for(u="",c="",o=p.header.length,r=0;r<o;r++)c+=this.renderer.tablecell(this.parseInline(p.tokens.header[r]),{header:!0,align:p.align[r]});for(u+=this.renderer.tablerow(c),l="",o=p.cells.length,r=0;r<o;r++){for(s=p.tokens.cells[r],c="",a=s.length,i=0;i<a;i++)c+=this.renderer.tablecell(this.parseInline(s[i]),{header:!1,align:p.align[i]});l+=this.renderer.tablerow(c)}w+=this.renderer.table(u,l);continue;case"blockquote":l=this.parse(p.tokens),w+=this.renderer.blockquote(l);continue;case"list":for(h=p.ordered,f=p.start,d=p.loose,o=p.items.length,l="",r=0;r<o;r++)m=p.items[r],y=m.checked,v=m.task,g="",m.task&&(b=this.renderer.checkbox(y),d?m.tokens.length>0&&"text"===m.tokens[0].type?(m.tokens[0].text=b+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=b+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:b}):g+=b),g+=this.parse(m.tokens,d),l+=this.renderer.listitem(g,v,y);w+=this.renderer.list(l,h,f);continue;case"html":w+=this.renderer.html(p.text);continue;case"paragraph":w+=this.renderer.paragraph(this.parseInline(p.tokens));continue;case"text":for(l=p.tokens?this.parseInline(p.tokens):p.text;n+1<k&&"text"===e[n+1].type;)p=e[++n],l+="\n"+(p.tokens?this.parseInline(p.tokens):p.text);w+=t?this.renderer.paragraph(l):l;continue;default:var x='Token with "'+p.type+'" type was not found.';if(this.options.silent)return void console.error(x);throw new Error(x)}return w},t.parseInline=function(e,t){t=t||this.renderer;var n,r,i="",o=e.length;for(n=0;n<o;n++)switch(r=e[n],r.type){case"escape":i+=t.text(r.text);break;case"html":i+=t.html(r.text);break;case"link":i+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break;case"image":i+=t.image(r.href,r.title,r.text);break;case"strong":i+=t.strong(this.parseInline(r.tokens,t));break;case"em":i+=t.em(this.parseIr.text);break;case"br":i+=t.br();break;case"del":i+=t.del(this.parseInline(r.tokens,t));break;case"text":i+=t.text(r.text);break;default:var a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(a);throw new Error(a)}return i},e}(),le=B.merge,pe=B.checkSanitizeDeprecation,he=B.escape,fe=k.getDefaults,de=k.changeDefaults,ge=k.defaults;return w.options=w.setOptions=function(e){return lrer)!function(t){var r=n[t];n[t]=function(){for(var i=arguments.length,o=ne[a];var s=e.renderer[t].apply(n,o);return!1===s&&(s=r.apply(n,o)),s}}(r);t.renderer=n}(),e.tokenizer&&function(){var n=w.defaults.tokenizer||new H;for(var r in e.tokenizer)!function(t){var r=n[t];n[t]=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var s=e.tokenizer[t].apply(n,o);return!1===s&&(s=r.apply(n,o)),s}}(r);t.tokenizer=n}(),e.walkTokens){var n=w.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens(t),n&&n(t)}}w.setOptions(t)},w.walkTokens=function(e,t){for(var n,r=i(e);!(n=r()).done;){var o=n.value;switch(t(o),o.type){case"table":for(var a,s=i(o.tokens.header);!(a=s()).done;){var c=a.value;w.walkTokens(c,t)}for(var u,l=i(o.tokens.cells);!(u=l()).done;)for(var p,h=u.value,f=i(h);!(p=f()).done;){var d=p.value;w.walkTokens(d,t)}break;case"list":w.walkTokens(o.items,t);break;default:o.tokens&&w.walkTokens(o.tokens,t)}}},w.parseInline=function(e,t){if(void 0===e||null===e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toStringthunction(e){for(var t=this.tryEquest-URL");var n="response"in o?o.response:o.responseText;e(new y(n,t))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials&&(o.withCredentials=!0),"responseType"in o&&v.blob&&(o.responseType="blob"),i.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)}).call(t,n(11))},function(e,t,n){"use strict";var r,i=n(2),o=n.n(i),ae){return e})}},{key:"setInput",value:function(e){u.a.trigger(c.a.setInputValue,function(){return e})}},{key:"eraseInput",value:function(){u.a.trigger(c.a.eraseInputValue,function(){return""})}},{key:"blurInput",value:function(){u.a.trigger(c.a.blurInput,function(){})}}]),e}())||r;t.a=p},function(e,t,n){"use strict";t.a={submit:"inputfield_action_submit",setInputValue:"inputfield_action_set_input_value",eraseInputValue:"inputfield_action_erase_input_value"}},function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(1),c=n.n(s),u=n(9),l=n(484),p={phone:/(?:0\d-\d{4}-\d{4})|(?:0\d{3}-\d{2}-\d{4})|(?:\(0\d\)\d{4}-\d{4})|(?:\(0\d{3}\)\d{2}-\d{4})|(?:(070|080|090)-\d{4}-\d{4})|(?:050-\d{4}-\d{4})|(?:0120-\d{3}-\d{3})|(?:\d{10}|\d{11})/g,email:/[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*/g,myNumber:/\d{12}/g,drivingLicence:/\d{12}/g,passport:/[a-zA-Z]{2}\d{7}/g,residentCode:/\d{11}/},h=Array(10).join("•"),f=new(function(){function e(){i()(this,e),c.a.observable(this),this._inputValue="",this._maskingMethods=[],this.on(l.a.submit,this._submit.bind(this)),this.on(l.a.setInputValue,this._setValue.bind(this)),this.on(l.a.eraseInputValue,this._eraseInputValue.bind(this))}return a()(e,[{key:"inputValue",get:function(){return this._inputValue}}]),a()(e,[{key:"setMaskingMethod",value:function(e){this._maskingMethods="all"===e?Object.keys(p):e}},{key:"_submit",value:function(e){this._inputValue=e(this._inputValue),u.a.trigger("InputField",this.ActionTypes.submit)}},{key:"_setValue",value:function(e){this._inputValue=e(this._inputValue),this._inputValue=this._maskingMethods.reduce(function(e,t){var n=p[t];return n?e.replace(n,h):(console.error("Invalid masking method ".concat(t)),e)},this._inputValue),u.a.trigger("InputField",this.ActionTypes.setInputValue)}},{key:"_eraseInputValue",value:function(e){this._inputValue=e(this._inputValue),u.a.trigger("InputField",this.ActionTypes.eraseInputValue)}}]),e}());f.ActionTypes={submit:"inputfield_store_submit",setInputValue:"inputfield_store_set_input_value",eraseInputValue:"inputfield_store_erase_input_value"},u.a.addStore("InputField",f),t.a=f},,,function(e,t,n){n(1).tag2("yield","","balloon { display: none; position: relative; cursor: pointer; } balloon.show { display: flex; display: -webkit-flex; display: -ms-flexbox; } balloon .balloon-body { display: flex; align-items: center; height: auto; min-height: 40px; width: 40px; background-color: white; top: 0px; border-radius: 3px; line-height: 25px; opacity: 0; box-shadow: 0 0 3px rgba(0, 0, 0, 0.4); transition: width cubic-bezier(0, 0, 0, 1.3) 300ms, opacity ease 300ms; color: #6F6F6F; z-index: 1; padding-left: 10px; font-size: 13px; white-space: nowrap; display: -webkit-flex; display: -ms-flexbox; -webkit-align-items: center; -ms-flex-align: center; } balloon .balloon-body.expand span { width: calc(100% - 10px); overflow: hidden; text-overflow: ellipsis; white-space: pre; } balloon .balloon-body.expand { width: 210px; opacity: 1; } balloon .balloon-body.typing span { position: relative; top: 0px; width: 6px; height: 6px; background-color: #6F6F6F; border-radius: 50%; margin-right: 10px; } balloon .balloon-body.typing { width: 60px; height: 20px; opacity: 1; justify-content: center; } balloon .balloon-body.typing span:nth-child(1) { -webkit-animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 0ms; animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 0ms; } balloon .balloon-body.typing span:nth-child(2) { -webkit-animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 200ms; animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 200ms; } balloon .balloon-body.typing span:nth-child(3) { -webkit-animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 400ms; animation: dot-anim 1s infinite cubic-bezier(0.26, 1.67, 0.1, 1.55) normal 400ms; } balloon .balloon-opening { position: absolute; width: 15px; height: 15px; top: 50%; margin-top: -7px; right: -7px; opacity: 0; background-color: white; transition: opacity 300ms ease; transform: rotate(45deg); -webkit-transform: rotate(45deg); -ms-transform: rotate(45deg); } balloon .balloon-opening.before { z-index: 0; z-index: -1\\9; box-shadow: 0 0 3px rgba(0, 0, 0, 0.4); } balloon .balloon-opening.after { z-index: 2; } .balloon-opening.expand, .balloon-opening.typing { opacity: 1; }",'to="balloonStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","",'minimizeButton::before { z-index: 1; content: ""; display: block; width: 15px; height: 15px; background-repeat: no-repeat; background-size: 50%; background-position: center; background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAAABlBMVEVHcExvb2/jyQPtAAAAAXRSTlMAQObYZgAAAEFJREFUGNO9kTkSACAIA7P//7SdKATsTAU73EiNAAdInMDcFGV+ON7sEreLa0+hwc1WhmoK7kqbQb7dYXjD44uhBa/qALF7CsT4AAAAAElFTkSuQmCC"); border-radius: 50%; background-color: rgba(230, 230, 230, 0.8); opacity: 0; animation: minimize-button-show 200ms ease-in 300ms; animation-fill-mode: forwards; } minimizeButton { z-index: 20; cursor: pointer; position: absolute; top: 0px; right: 0px; display: inline-block; } _::-webkit-full-page-media, _:future, :root minimizeButton { -webkit-animation: none; animation: none; opacity: 1; } @-webkit-keyframes minimize-button-show { 0% { opacity: 0; } 100% { opacity: 1; } } @keyframes minimize-button-show { 0% { opacity: 0; } 100% { opacity: 1; } }','to="minimizeButtonStyle"',function(e){})},,function(e,t,n){n(1).tag2("yield","",'talks { height: calc(100% - 100px)\\9; } inputFieldDefault { display: block; height: 45px; margin-bottom: 10px; flex-shrink: 0; } inputFieldDefault:before { content: \'\'; height: 10px; margin-top: -8px; position: relative; width: 100%; display: block; background: linear-gradient(rgba(255, 255, 255, 0.0) 0%, #FFFFFF 50%); } .input-wrapper { display: -ms-flexbox; display: -webkit-flex; display: flex; margin: 2px; -webkit-align-items: center; -ms-flex-align: center; align-items: center; height: calc(100% - 10px); width: 100%; background-color: #FFFFFF; transition: all 0.2s cubic-bezier(0, 0, 0, 1); position: relative; } .input-wrapper textarea { border: 0; display: block; width: 100%; width: 75%\\9; height: 100%; margin: 8px; padding: 8px; border-radius: 4px; resize: none; overflow: auto; -webkit-appearance: none; box-shadow: 0 0 2px rgba(0, 0, 0, 0.35); background-color: white; font-size: 14px; font-family: "Helvetica Neue",Helvetica,"ヒラギノ角ゴ Pro W3","Hiragino Kaku Gothic Pro","メイリオ",Meiryo,"Meiryo UI","ＭＳ Ｐゴシック","MS PGothic",sans-serif; -webkit-user-select: text !important; user-select: text !important; } .input-wrapper textarea:focus { outline: none; } .input-wrapper textarea:disabled { opacity: 1!important; } .input-wrapper textarea::placeholder { white-space: nowrap !important; } .send-button { width: 20%; height: 100%; margin-right: 8px; flex-shrink: 0; transition: background 0.3s ease-out; } .fade-out { backface-visibility: hidden !important; transform-style: preserve-3d !important; animation: 0.2s fade-common-fade-out ease alternate !important; } @keyframes fade-common-fade-out { 0% { opacity: 1; } 100% { opacity: 0; } }','to="inputFieldDefaultStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","miniFloat.visible { display: block; width: 100%; height: 100%; } miniFloat #float { display: none; width: 100%; height: 100%; background-color: #0099FF; border-radius: 4px 4px 0px 0px; padding: 4px 0px; background-position: center 5px; background-size: 45%; background-repeat: no-repeat; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAAqCAYAAADrhujJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAolJREFUeNrkWu1xgzAMBa4DsEE9AhuETNB0AzJB6QSlE6SdwGxAMgFskHQCsgHZwJXvROrzERI7/spVdzrCjxg/S5aeZEfRP5XYxCCMsRQeOWgGugBN8fecHFEPoD/8GcfxIfgVA7AEtATdM3MygFLQVYiAC9CW2ZcetEJv8gp4hZNxLYOXBUCXbpl/GZxtAbTywMIS6mIvhyr7e10/vgQaHjTwxMJT3xJS4Ennz8mUez8A6Ah5gvY8EzmQPQjoUXgMKnX++CS9fyDrClFO6N6yLAB8rerysWTtPiCgHegOqWxnenDR4m8BgOXc/Ru01g1aOhbn1iYe3fgdwNYTwXYsfp4vFD4nLHL4onUwxlE1b3sjJHJORuJENckTp9Ub3LpXQeeeQBcTpKk3vKgkNOCFw3qgCgV4KXw7c1QPNOKWEoMbc5WmIAAtR9DwaB1yh/O3E4n7upC10K5qHBMm7tkbGfjOwYe3QropPaVP3i4jrpnbeszVfF97pMf12eJoiS8HNHQkJT5rglwuSz+RAdmhiX9unkV+hSTSxDj9e0UaaFO8V4DJhFUOY+S10M5KRZcPCjiC3/K2jgXL50IV5lO2ycx+7BC8yfz+Iux1n1bf3eqilcHeeCpQVS8dWtX9SbDaMVYwGFxQlYXPdAMUwXr3nsIiE8ajwYOeakXjxHuNSRBhnNLBAWRmI00RRQ9o5aMg3PM2anJ7B45Y6xo5+MPeQGPArW9rP90BulCwMlEYN8WxqcLlA4p1gF25MSW1piaDizEXDFsXoK8dIVtb/SuXFCqboMuZ49vC1e2FmWsppekPpVLgGfDdGdiZrCJfRKJG5oTRdo9ASyt50dwijEGxCXWe3uRXgAEA5SdRBeQjcaIAAAAASUVORK5CYII=); opacity: 0; cursor: pointer; -webkit-animation: float-show 100ms ease-out 25ms; animation: float-show 100ms ease-out 25ms; -webkit-animation-fill-mode: forwards; -moz-animation-fill-mode: forwards; -o-animation-fill-mode: forwards; animation-fill-mode: forwards; } miniFloat #float.visible { display: block } @-webkit-keyframes float-show { 0% { opacity: 0; } 100% { opacity: 1; } } @keyframes float-show { 0% { opacity: 0; } 100% { opacity: 1; } }",'to="miniFloatStyle"',function(e){})},function(e,t,n){n(1).tag2("yield","","unreadBadge { z-index: 10; background-color: #fc433c; padding: 2px 6px; color: white; font-weight: bold; border-radius: 12px; animation: unread-badge-show 200ms cubic-bezier(0, 0, 0, 2); -webkit-animation: unread-badge-show 200ms cubic-bezier(0, 0, 0, 2); } @keyframes unread-badge-show { from { transform: scale(0.7); } to { transform: scale(1.0); } } @-webkit-keyframes unread-badge-show { from { transform: scale(0.7); } to { transform: scale(1.0); } }",'to="unreadBadgeStyle"',function(e){})},function(e,t,n){"use strict";var r=n(488),i=(n.n(r),n(10));n(1).tag2("balloon",'<yield from="balloonStyle"></yield> <div class="balloon-opening before {this.openClass}"></div> <div class="balloon-body {this.openClass}"> <span show="{this.openClass == \'typing\'}"ping\'}"></span> <span show="{this.openClass == \'typing\'}"></span> <span hide="{this.openClass == \'typing\'}">{this.getBaloonText()}</span> </div> <div class="balloon-opening after {this.openClass}"></div>',"","",function(e){this.openClass="",this.expand=function(){var t=this;this.root.className="show",setTimeout(function(){t.openClass="typing",t.update(),"iOS"===i.a.device&&8===parseInt(i.a.version,10)&&e.iframeadjust&&e.iframeadjust(),setTimeout(function(){t.openClass="expand",t.update()},2e3)},10)}.bind(this),this.getBaloonText=function(){return window.parent.aiMessenger.b.balloon.text}.bind(this),this.clear=function(){this.root.className="",this.openClass="",this.update()}.bind(this)})},function(e,t,n){"use strict";var r=n(489);n.n(r),n(10);n(1).tag2("minimizebutton",'<yield from="minimizeButtonStyle"></yield>',"","",function(e){})},,function(e,t,n){"use strict";n(498);n(1).tag2("inputfield","<inputfielddefault each=\"{this.inputFieldTag === 'inputFieldDefault'? [true]: []}\"></inputfielddefault>","","",function(e){this.inputFieldTag=Customize.input.component})},function(e,t,n){"use strict";var r=n(17),i=n.n(r),o=n(16),a=n.n(o),s=n(9),c=n(485),u=n(501),l=n(41),p=n(10),h=n(26),f=(n(69),n(76)),d=(n(410),n(411),n(32)),g=n(28),m=n(491);n.n(m);n(1).tag2("inputfielddefault",'<yield from="inputFieldDefaultStyle"></yield> <div class="input-wrapper"> <uploadimagebuttonimg class="pc-view {this.inputValue ? \'\' : \'disabled\'}" onfileselected="{handleFileSelected}" each="{showUploadImageButton.get()}"></uploadimagebuttonimg> <textarea id="input-textarea" placeholder="{this.placeholderMessage}" wrap="hard" maxlength="1000" oninput="{this.onInput}" riot-style="{imageUplodable? \'margin-left: 40px\': \'margin-left: 10px\'}" onfocus="{this.onFocus}" onblur="{this.onBlur}"></textarea> <div class="send-button" class="button {this.sendReady ? \'sendReady\' : \'\'}" onclick="{send}" ontouchstart="{send}"> <sendbuttonimg loading="{this.fetchLoading}" class="pc-view {this.inputValue ? \'\' : \'disabled\'}"></sendbuttonimg> </div> </div>',"","",function(e){var t=this;this.mixin("messages");var n=new u.a,r=new h.a,o=l.a.instance;this.disabled=!1,this.placeholderMessage="メッセージを入力".concat("PC"===p.a.device?"（Shift + Enterで送信）":""),this.imageUplodable=!!Customize.chat.imageUplodable,this.showUploadImageButton=new f.a(this.imageUplodable),this.interval=0,this.inputValue="",this.typingStarted=!1,this.focused=!1,this.timeout=0,c.a.setMaskingMet"Talks",d.a.ActionTypes.update,function(){Customize.cssageImageUplodable?(t.imageUplodable=!0,t.showUploadImageButton.set(!0)):Customize.chat.imageUplodable||(t.imageUplodable=!1,t.showUploadImageButton.set(!1)),t.update())}),s.a.on("InputField",c.a.ActionTypes.submit,function(){c.a.inputValue&&(r.pushSentMessage(c.a.inputValue),t.postMessages(c.a.inputValue),n.eraseInput())}),s.a.on("Inpun(){t.inputValue=c.a.inputValue}),s.a.on("InputField",c.a.ActionTypes.eraseInputValue,function(){t.inputValue=c.a.inputValue,t.eraseInput()}),this.on("mount",function(){var e=this;this["input-textarea"].addEventListener("keydown",function(t){if(t.which||t.keyCode,(t.ctrlKey||t.shiftKey)&&e.inputValue&&(e.sendReady=!0,e.update(),13==t.keyCode))return r.pushShiftedEnterKeyTriggeredFromInputField(),t.preventDefault(),e.send(),!1}),this["input-textarea"].addEventListener("keyup",function(e){this.sendReady=!1,this.update()}.bind(this))}),this.onInput=function(e){var t=e.target.value.trim().replace(/^[　]+|[　]+$/g,"");n.setInput(t),this.inputValue=t,"liveAgent"===Customize.input.typing||d.a.isAssignedToBot||(o.sendCustomerTyping({text:t,on:!0}),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(a()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.sendCustomerTyping({text:t,on:!1});case 2:case"end":return e.stop()}},e,this)iveAgent"===Customizeurn;this.typingStarted=!0,function t(){e.interval=setTimeout(a()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.focused&&!d.a.isAssignedToBot){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,o.sendTyping(e.inputValue);case 4:t();case 5:case"end":return n.stop()}},n,this)})),200)}()}}.bind(this),this.onBlur=function(){this.focused=!1,this.typingStarted=!1,clearTimeout(this.interval)}.bind(this),this.send=function(e){return r.pushSendButtonTriggered(),n.submit(),!1}.bind(this),this.eraseInput=function(){this.inputValue="",this["input-textarea"].value=""}.bind(this),this.setDisable=function(e){this.disabled=!0,this["input-textarea"].setAttribute("disabled",""),this.defaultStyle={};for(varthis.defaultStyle[t]=this.root.style[t],this.root.style[t]=e[t])}.bind(this),this.setEnable=function(){this.disabled=!1,this["input-textarea"].removeAttribute("disabled");for(var e in this.defaultStyle)this.defaultStyle.hasOwnProperty(e)&&(this.root.style[e]=this.defaultStyle[e])}.bind(this),this.hasCustomerCreated=function(){return void 0!==g.a.get().customer.id}.bind(this),this.isConversationOpen=function(){return void 0!==g.a.get().customer.conversationId}.bind(this),this.handleFileSelected=function(e){this.postFile(e)}.bind(this)})},function(e,t,n){"use strict";var r=n(492),i=(n.n(r),n(495),n(10)),o=n(133);n(1).tag2("minifloat",'<yield from="miniFloatStyle"></yield> <minimizebutton id="minimizeButton" onclick="{minimize}"></minimizebutton> <div id="float" onclick="{open}"></div>',"","",function(e){var t=this;this.chatframeStyle={},this.on("mount",function(){o.a.get().minimize?t.minimize(null,{animate:!1}):(t.minimizeButton.style.display="none",t.minimizeButton.style.offsetLeft,setTimeout(function(){t.minimizeButton.style.display="",t.minimizeButton.style.offsetLeft},100))}),this.minimize=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{animate:!0},r=n.animate,a=this.opts.chatframe;this.chatframeStyle.transform=a.style.transform,this.chatframeStyle.height=a.style.height,this.chatframeStyle.width=a.style.width,this.chatframeStyle.transition=a.style.transition,this.chatframeStyle.borderRadius=a.style.borderRadius,this.chatframeStyle.left=a.style.left,this.chatframeStyle.right=a.style.right,this.chatframeStyle.bottom=a.style.bottom,document.body.style.marginTop="0px",this.minimizeButton.style.display="none",a.style.bottom="5px",a.style.left?a.style.left="5px":a.style.right="5px";var s=parseInt(a.style.height),c=2.5*s;r&&(a.style.transition=form ".concat(c,"ms cubic-bezier(0, 0, 0, 1)")),a.style.transform="translate3d(0px, ".concat(s+20,"px, 0px)"),setTimeout(function(){t.parent.clearBalloon",t.float.className="visibl"left-bottom"===Customize.cheight="25px",a.style.borderRadius="0px","iOS"===i.a.device&&8===parseInt(i.a.version,10)?(a.style.width="0px",setTimeout(function(){a.style.width="50px"},10)):a.style.width="50px",o.a.set("minimize",!0)},r?c:0)}.bind(this),this.hide=function(){this.minimizeButton.style.display="none"}.bind(this),this.open=function(){this.initState(),this.parent.open()}.bind(this),this.openParent=function(){this.initState(),this.minimizeButton.style.display="none"}.bind(this),this.closeParent=function(){this.minimizeButton.style.display=""}.bind(this),this.initState=function(){this.root.className="",this.float.className="",this.parent["chat-floating"].style.display="";var e=this.opts.chatframe;void 0!==this.chatframeStyle.transform&&(e.style.transform=this.chatframeStyle.transform),void 0!==this.chatframeStyle.height&&(e.style.height=this.chatframeStyle.height),void 0!==this.chatframeStyle.width&&(e.style.width=this.chatframeStyle.width),void 0!==this.chatframeStyle.transition&&(e.style.transition=this.chatframeStyle.transition),void 0!==this.chatframeStyle.borderRadius&&(e.style.borderRadius=this.chatframeStyle.borderRadius),void 0!==this.chatframeStyle.left&&(e.style.left=this.chatframe(e.style.right=this.chatframeStyle.right),void 0!==this.chatframeStyle.bottom&&(e.style.bottom=this.chatframeStyle.bottom),o.a.set("minimize",!1)}.bind(this)})},function(e,t,n){"use strict";var r=n(9),i=n(493),o=(n.n(i),n(10));n(1).tag2("unreadbadge",'<yield from="unreadBadgeStyle"></yield> <span>{this.unreadMessagesCount}</span>',"",'hide="{!this.unreadMessagesCount || this.unreadMessagesCount <= 0}"',function(e){var t=this;r.a.on("Env",o.a.ActionTypes.setUnreadMessagesCount,function(e){t.unreadMessagesCount=e,t.update()})})},function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=(n(9),n(484)),c=n(485),u=function(){function e(){i()(this,e)}return a()(e,[{key:"submit",value:function(){c.a.trigger(s.a.submit,function(e){return e})}},{key:"setInput",value:function(e){c.a.trigger(s.a.setInputValue,function(){return e})}},{key:"eraseInput",value:function(){c.a.trigger(s.a.eraseInputValue,function(){return""})}}]),e}();t.a=u},function(e,t,n){"use strict";var r=n(79),i=n.n(r),o=n(1),a=n.n(o),s=n(483),c=new s.a,u=i()({},parent.document.body.style),l={checkOpenNewWindow:function(e,t,n){return!e&&t?(l._openNewWindow(t),!1):("no"!==n&&l.toggleParentPageScrollable(!0),!0)},toggleParentPageScrollable:function(e){var t=parent.document.body;e?(t.style.width="100%",t.style.height="100%",t.style.overflow="hidden",t.style.position="fixed"):(c.blurInput(),window.document.body.blur(),t.style.width=u.width||"",t.style.height=u.height||"",t.style.overflow=u.overflow||"",t.style.position=u.position||"")},_openNewWindow:function(e){try{window.open(e).location.href=e}catch(t){rg4js("onAfterSend",function(t){window.parent.location.href=e}),rg4js("send",{error:new Error("openNewWindow Error")})}}};a.a.mixin("chatOpen",l)},function(e,t,n){"use strict";var r=n(1),i=n.n(r),o=n(33),a=n(133),s={talksAction:o.a.instance,setWidgetStatusOpen:function(e){a.a.set("open",e),e?this.talksAction.readAllMessages():this.talksAction.coune,t,arpetnctiar r in this._entries)if(this._entries.hasOwnProperty(r)){n=this._entrivar e=[];return this.forEach(function(t,n){e.push([n,t])}),n(e)},t&&(o[Symbol.iterator]=o.entries),o.toString=function(){var e=[];return this.forEach(function(t,n){e.push(r(n)+"="+r(t))}),e.join("&")},e.URLSearchParams=i}();var o=e.URLSearchParams.prototype;"function"!=typeof o.sort&&(o.sort=function(){var e=this,t=[];this.forEach(function(n,r){t.push([r,n]),e._entries||e.delete(r)}),t.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}),e._entries&&(e._entries={});for(var n=0;n<t.length;e:!1,writable:!1,value:function(e){if(this._entries)this._entries={};else{var t=[];this.forEach(function(e,n){t.push(n)});for(var n=0;n<t.length;n++)this.delete(t[n])}e=e.replace(/^\?/,"");for(var r,o=e.split("&"),n=0;n<o.length;n++)r=o[n].split("="),this.append(i(r[0]),r.length>1?i(r[1]):"")}})}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this),function(e){if(function(){try{var t=new e.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(e){return!1}}()||function(){var t=e.URL,n=function(t,n){"string"!=typeof t&&(t=String(t)),n&&"string"!=typeof n&&(n=String(n));var r,i=document;if(n&&(void 0===e.location||n!==e.location.href)){n=n.toLowerCase(),i=document.implementation.createHTMLDocument(""),r=i.createElement("base") new Error("URL unable to set base "+n+" due to "+e)}}var o=i.createElement("a");o.href=t,r&&(i.body.appendChild(o),o.href=o.href);var a=i.createElement("input");if(a.type="url",a;Object.definePrope t=s[e];s[e]=function(){t.apply(s,arguments),c&&(u=!1,l.search=s.toString(),u=!0)}}),Object.defineProperty(this,"searchParams",{value:s,enumerable:!0});var p=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!ng(this.search),c=!0))}})},r=n.prototype,i=function(e){Object.defineProperty(this._anchorElement[e]=t},enuctio,{get:function(){return thirElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathnam:80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=thishorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:func,enumerable:!0},username:{get:function(){return""},set:function(e){},enumerable:!0}}),n.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)},n.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)},e.URL=n}(),void 0!==e.location&&!("origin"in e.location)){var t=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:t,enumerable:!0})}catch(n){setInterval(function(){e.location.origin=t()},100)}}}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this)}).call(t,n(34))},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(204),i=(n.n(r),n(482)),o=(n.n(i),n(11)),a=n.n(o),s=n(1),c=n.n(s),u=(n(59),n(517),n(28)),l=n(430),p=n(429),h=n(446),f=n(26);a.a.polyfill();var d=f.a.instance;window.parent.resetWidget=h.a;var g=(window.parent.aimWidgetEnv,window.parent.swallow_widget_initial_configs),m=new l.a(window.Customize),y=new p.a(m);y.setIframeStyle(),y.emitCSS(window.document),firebase.initializeApp(m.firebaseConfig);var v=u.a.get();d.setup(v,g.tenantId),window.parent.aiMessenger.runAsyncFunctions("beforeMount",window.parent.aiMessenger).then(function(){c.a.mount("chat");try{window.parent.aiMessenger.runFunctions("load")}catch(e){d.sendError(e)}})},,,,,function(e,t,n){"use strict";var r=n(9),i=n(95),o=n(33),a=n(93),s=n(41),c=n(10),u=n(94),l=n(32),p=n(26),h=n(76),f=n(505),d=(n(494),n(499),n(403),n(414),n(497),n(380));n.n(d),n(500),n(503),n(502),n(413);n(1).tag2("chat",'<yield from="chatStyle"></yield> <minifloat chatframe="{this.chatFrame}"></minifloat> <balloon onclick="{open}"></balloon> <div id="chat-floating" onclick="{open}"> <unreadbadge></unreadbadge> </div> <div id="chat" class="display-none hiding"> <header close="{close}" onbeforerefresh="{beforeRefresh}" onafterrefresh="{afterRefresh}" showrefreshbutton="{this.showRefreshButton}"></header> <error-field></error-field> <talks riot-style="{this.talksStyle}" show-date-on-bottom="{true}"></talks> <div riot-style="background-color:{Customize.talks[\'background-color\']};" each="{explicitShowInput? explicitShowInput.get(): [true]}"> <inputfield each="{showInput.or(explicitShowInput)}w}" loading="{this.chatLoading}" message="{this.wallMessage}"></information-wall> </div>',"","",function(e){var t=this;this.mixin("unreadControll","chatOpen"),this.showInput=new h.a(!0),this.explicitShowInput=null,this.talksStyle=Customize.header.hideTitle?"margin-top: -40px;":"",this.showRefreshButton=l.a.isAssignedToBot,this.prevShowInputState=!1;var d=new a.a,g=new s.a,m=new o.a,y=new p.a,v=window.parent.swallow_widget_initial_configs;window.updateCustomerState=function(){return g.updateCustomerState.apply(g,arguments)},d.setEnv({tenantId:e.tenantid,staticEndpoint:e.scriptendpoint,apiEndpoint:e.apiendpoint,messageEndpoint:e.messageendpoint,device:e.device,envPrefix:e.envprefix,inputComponent:this.tags.inputfield,mobile:e.mobile,additional:n.i(i.a)(parent.aiMessenger.additional),liveAgentEndpoint:e.liveagentendpoint}),r.a.on("Env",c.a.ActionTypes.iframeAdjust,function(){t.parentDocument=window.parent.document,t.chatFrame=t.parentDocument.querySelector("iframe#swallow-widget-frame"),t.chatBody=document.querySelector("body"),t.chatFrame.style.height="".concat(Customize.chat.height+40+20,"px"),t.chatFrame.style.width="".concat(Customize.chat.width+20,"px")}),r.a.on("Env",c.a.ActionTypes.setChatLoading,function(){t.wallShow=c.a.chatLoading,t.chatLoading=c.a.chatLoading,t.update()}),r.a.on("Env",c.a.ActionTypes.setWallMessage,function(){t.wallShow=!!c.a.wallMessage,t.wallMessage=c.a.wallMessage,t.update()}),r.a.on("QuickReplies",u.a.ActionTypes.show,function(){Customize.input.autoHide&&!l.a.isOperatorConnected&&(t.showInput.set(!1),t.update())}),r.a.on("Talks",l.a.ActionTypes.notifyAssigneeChanged,function(e){l.a.isAssignedToBot?l.a.isAssignedToBot&&!t.showRefreshButton&&(t.showRefreshButton=!0,t.update()):(t.showRefreshButton=!1,t.update()),Customize.input.autoHide&&(l.a.isAssignedToBot||t.showInput.valueOf()||t.showInput.set(!0),t.update())}),r.a.on("Talks",l.a.ActionTypes.update,function(){Customize.input.autoHide&&l.a.isAssignedToBot?l.a.isLastMessageFromCustomer||l.a.isLastMessageTyping||l.a.isLastMessageYConnect||l.a.isLastMessageMarkdownEnabled?t.showInput.set(!1):t.showInput.set(!0):t.showInput.set(!l.a.isLastMessageYConnect&&!l.a.isLastMessageMarkdownEnabled&&!l.a.isLastMessageCarousel),t.update()}),r.a.on("Talks",l.a.ActionTypes.toggleInput,function(e){if(!e)return t.explicitShowInput=null,void t.update();var n="show"===e;t.explicitShowInput?t.explicitShowInput.set(n):t.explicitShowInput=new h.a(n),t.update()}),d.iframeAdjust(),this.on("mount",function(){var t=this;y.pushWidgetMount!1),window.widget_open=this.open,window.widget_close=this.close,window.parent.aiMessenger.ready=!0,this.chatFrame&&(this.chatFrame.style.zIndex=2147483647,"visible"===v.visibility&&this.iframeVisibility(!0),Customize.balloon.enable&&this.openBalloon(2e3)),window.parent.aiMessenger.runFunctions("mount",{env:e.envprefix,did:c.a.did,aim:window.parent.aiMessenger}),g.initCustomerStateOnMount(),parent.aiMessenger.alwaysStartFromInitialMessage&&g.resetFrame(!1),n.i(f.a)()===f.a.type.OPEN&&setTimeout(function(){return t.open({})},100)}),this.open=function(t){var n=this;if(y.pushWidgetOpened(),this.setWidgetStatusOpen(!0),this.checkOpenNewWindow(v.fullScreen,v.newWindowUrl,e.mobile)){this.iframeVisibility(!0),this.tags.minifloat.openParent(),this.clearBalloon(),this.tabletInputCatch();try{window.parent.aiMessenger.runFunctions("open")}catch(e){y.sendError(e)}var r=function(){try{window.parent.aiMessenger.runFunctions("startConversation",parent.aiMessenger)}catch(e){y.sendError(e)}};g.startConversation().then(r,r),this["chat-floating"].className="hide",this.chat.classList.remove("display-none"),document.body.style.marginTop="0px";var i=!0;t&&!1===t.animation&&(i=!1,this.chat.style.transition="none",this.tags.talks.talks.style.transition="none"),setTimeoutin="0px",n.chat.classList.remove("hiding"),n.chatFrame&&(n.chatFrame.style.width="420px",n.chatFrame.style.height="620px",m.moveDown()),setTimeout(function(){n.chatFrame&&(n.chatFrame.style.boxShadow="rgba(0, 0, 0, 0.5) 0px 0px 2px",n.tags.minifloat.hide())},i?200:0)},i?100:0)}}.bind(this),this.beforeRefresh=function(e){this.prevShowInputState=this.showInput.get(),this.showInput.set(!1),this.update()}.bind(this),this.afterRefresh=function(e){var t=this;setTimeout(function(){t.showInput.set(t.prevShowInputState),t.update()},400)}.bind(this),this.close=function(e){var t=this;y.pushWidgetClosed(),this.setWidgetStatusOpen(!1);var n=this["chat-floating"];this.tabletInputRelease(),"hidden"===v.visibility&&this.iframeVisibility(!1),this.chat.classList.add("hiding"),this.chatFrame&&(this.chatFrame.style.boxShadow=""),setTimeout(function(){t.root.className="",t.chatFrame&&(t.chatFrame.style.height="".concat(Customize.chat.height+40+20,"px"),t.chatFrame.style.width="".concat(Customize.chat.width+20,"px")),t.tags.minifloat.closeParent(),t.chatBody.style.margin="",t.chat.classList.add("display-none"),n.className="",n.style.opacity="1"},100)}.bind(this),this.openBalloon=function(e){var t=this;this.openTimerId=setTimeout(function(){var e=window.Customize.balloon.scale||1;t.chatFrame.style.width="".concat(parseInt(t.chatFrame.style.width)+260*e,"px"),t.tags.balloon.expand()},e)}.bind(this),this.clearBalloon=function(){clearTimeout(this.openTimerId),this.tags.balloon.clear()}.bind(this),this.tabletInputCatch=function(){"iOS"===c.a.device&&(this.openedTop=this.parentDocument.body.scrollTop,this.documentElementOverflow=this.parentDocument.documentElement.style.overflow,this.documentElementHeight=this.parentDocument.documentElement.style.height,this.parentBodyPosition=this.parentDocument.body.style.position,this.bodyOverflow=this.parentDocument.body.style.overflow,this.bodyHeight=this.parentDocument.body.style.height,this.bodyPosition=this.chatFrame.style.position,this.parentDocument.body.scrollTop=0,this.parentDocument.documentElement.style.overflow="hidden",this.parentDocument.documentElement.style.height="100%",this.parentDocument.body.style.position="relative",this.parentDocument.body.style.overflow="hidden",this.parentDocument.body.style.height="100%",this.chatFrame.style.position="absolute")}.bind(this),this.tabletInputRelease=function(){"iOS"===c.a.device&&(this.parehis.documentElementOverflow,this.parentDocument.documentElement.style.height=this.documentElementHeight,this.parentDocument.body.style.position=this.parentBodyPosition,this.parentDocument.body.style.overflow=this.bodyOverflow,this.parentDocument.body.style.height=this.bodyHeight,this.chatFrame.style.position=tnt.body.scrollTop=this.openedTop)}.bind(this),this.openNewWindow=function(e){try{window.open(e).location.href=e}catch(t){rg4js("onAfterSend",function(t){window.parent.location.href=e}),rg4js("send",{error:new Error("openNewWindow Error")})}}.bind(this),this.iframeVisibility=function(e){e?"iOS"===c.a.device?this.chatFrame.style.display="":this.chatFrame.style.visibility="visible":"iOS"===c.a.device?this.chatFrame.style.display="none":this.chatFrame.style.visibility="hidden"}.bind(this)})},,,function(e,t,n){e.exports=n(512)}]);