/*! For license information please see core-ads.js.LICENSE.txt */
(()=>{var e={6015:()=>{!function(){"use strict";var e={log:"log",debug:"debug",info:"info",warn:"warn",error:"error"},t=r=console;.debug=r.debug.bind(r),t.log=r.log.bind(r),t.info=r.info.bind(r),t.warn=r.warn.bind(r),t.error=r.error.bind(r);var o,i=a=!1;b=1024*y,w=/[^\u0000-\u007F]/;nction O(e,t){return _(m(),"setTimeout")(u(e),t)}function x(e){_(m(),"clearTimeout")(e)}ction k(){}220*y,M="$",N=3;unction B(e,t,r,n,o){var i=e);if(!i||"object"!=typeof i)return function(e){return"bigint"==typeof e?"[BigInt] ".concat(e.toString()):"function"==typeof e?"[Function] ".concat(e.name||"unknown"):"symbol"==typeof e?"[Symbol] ".concat(e.description||e.toString()):e}(i);var a=i);if("[Object]"!==a&&"[Array]"!==a&&"[Error]"!==a)return a;var s=e;if(o.has(s))return"[Reference seen at ".concat(o.get(s),"]");var c=void 0!==r?"".concat(t,".").concat(r):t,u=Array.isArray(i)?[]:{};return o.set(s,c),n.push({source:i,target:u,path:c}),u}unction F(e,r){void 0===r&&(r=S);var n,o={},i=!1,a=j((,200).throttled,s={getBytesCount:function(){return n},get:function(){return o},add:remove:function(e){delete o[e],a(o)},set:getContext:function(){return I(o)},setContext:setContextProperty:removeContextProperty:clearContext:;return s}var z,V,G=),H=1e3,$=60*H,J=60*$;}));var re=new Set;se=); de,fe=4*J,pe=15*$; me="_dd_s",ye=/^([a-z]+)=([a-z0-9-]+)$/,be="&";nction _e(e){return(t=e,Object.keys(t).map(()).map(().join(be);var t}ar xe="_dd",Pe="_dd_r",Ae="_dd_l",je="rum",ke="logs";function Ce(e){var r=e);return r)?{type:"Cookie",cookieOptions:r}:void 0}r De="_dd_test_"; Me,Ne=10,qe=100,Be=[];ar Fe=r Ge=H;unction $e(e){return function(e,t){var r=);if(r)try{return void 0!==t?new r(e,t):new r(e)}catch(r){throw new Error("Failed to construct URL: ".concat(String(r)," ").concat(T({url:e,base:t})))}if(void 0===t&&!/:/.test(e))throw new Error("Invalid URL: '".concat(e,"'"));var n=document,o=n.createElement("a");if(void 0!==t){var i=(n=document.implementation.createHTMLDocument("")).createElement("base");i.href=t,n.head.appendChild(i),n.body.appendChild(o)}return o.href=e,o}(e,window.location)).href}var Je,We=URL,Ke="datadoghq.com",Qe="ap1.datadoghq.com",Xe={logs:"logs",rum:"rum",sessionReplay:"session-replay"},Ye={logs:"logs",rum:"rum",sessionReplay:"replay"};ar et=200,tt=/[^a-z0-9_:./-]/;unction nt(e){var r,o,i;if(e&&e.clientToken){var a=null!==(r=e.sessionSampleRate)&&void 0!==r?r:e.sampleRate;if(void 0===a||ie(a))if(void 0===e.telemetrySampleRate||ie(e.telemetrySampleRate)){if(void 0===e.telemetryConfigurationSampleRate||ie(e.telemetryConfigurationSampleRate))return Array.isArray(e.enableExperimentalFeatures)&&e.enableExperimentalFeatures.filter(().forEach((function(e){re.add(e)})),g({beforeSend:e.beforeSend&&n(e.beforeSend,"beforeSend threw an error:"),sessionStoreStrategyType:He(e),sessionSampleRate:null!=a?a:100,telemetrySampleRate:null!==(o=e.telemetrySampleRate)&&void 0!==o?o:20,telemetryConfigurationSampleRate:null!==(i=e.telemetryConfigurationSampleRate)&&void 0!==i?i:5,service:e.service,silentMultipleInit:!!e.silentMultipleInit,batchBytesLimit:16*y,eventRateLimiterThreshold:3e3,maxTelemetryEventsPerPage:15,flushTimeout:30*H,batchMessagesLimit:50,messageBytesLimit:256*y},e));t.error("Telemetry Configuration Sample Rate should be a number between 0 and 100")}else t.error("Telemetry Sample Rate should be a number between 0 and 100");else t.error("Session Sample Rate should be a number between 0 and 100")}else t.error("Client Token is not configured, we will not send any data.")}var ot="?";ar at="((?:file|https?|blob|chrome-extension|native|eval|webpack|snippet|<anonymous>|\\w+\\.|\\/).*?)",st="(?::(\\d+))",ct=new RegExp("^\\s*at (.*?) ?\\(".concat(at).concat(st,"?").concat(st,"?\\)?\\s*$"),"i"),ut=new RegExp("\\((\\S*)".concat(st).concat(st,"\\)")),lt=new RegExp("^\\s*at ?".concat(at).concat(st,"?").concat(st,"??\\s*$"),"i"),dt=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,ft=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,pt=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;ar vt="No stack, consider using an instance of Error";={intervention:"intervention",deprecation:"deprecation",cspViolation:"csp_violation"};function Ot(e,t){var r=[];f(t,_t.cspViolation)&&r.push(function(e){var t=new se((function(){return wt(0,document,"securitypolicyviolation",().stop}));return t}());var n=t.filter(();return n.length&&r.push(n)),ce.apply(void 0,r)}r At={AGENT:"agent",CONSOLE:"console",CUSTOM:"custom",LOGGER:"logger",NETWORK:"network",SOURCE:"source",REPORT:"report"},jt={debug:"debug",error:"error",info:"info",warn:"warn"},kt="http",Ct=Object.keys(jt),Et=function(){eturn e.prototype.log=function(e,t,r,n){var o;if(void 0===r&&(r=jt.info),r===jt.error&&(o={origin:At.LOGGER}),null!=n){var i=gt({stackTrace:n instanceof Error?it(n):void 0,originalError:n,nonErrorPrefix:"Provided",source:At.LOGGER,handling:"handled",startClocks:X()});o={origin:At.LOGGER,stack:i.stack,kind:i.type,message:i.message}}var a=q(t),s=o?D({error:o},a):a;this.handleLogStrategy({message:q(e),context:s,status:r},this)},e.prototype.debug=function(e,t,r){this.log(e,t,jt.debug,r)},e.prototype.info=function(e,t,r){this.log(e,t,jt.info,r)},e.prototype.warn=function(e,t,r){this.log(e,t,jt.warn,r)},e.prototype.error=e.prototype.setContext=function(e){this.contextManager.set(e)},e.prototype.getContext=e.prototype.addContext=e.prototype.removeContext=e.prototype.setHandler=function(e){this.handlerType=e},e.prototype.getHandler=function(){return this.handlerType},e.prototype.setLevel=function(e){this.level=e},e.prototype.getLevel=function(){return this.level},[c],e.prototype,"log",null),e}();ar Dt,Tt={log:"log",configuration:"configuration"},Rt=["https://www.datadoghq-browser-agent.com","https://www.datad0g-browser-agent.com","https://d3uc069fcn7uxw.cloudfront.net","https://d20xtzwzcl0ceb.cloudfront.net","http://localhost","<anonymous>"],Lt=["ddog-gov.com"],Mt={maxEventsPerPage:0,sentEventCount:0,telemetryEnabled:!1,telemetryConfigurationEnabled:!1};function Nt(e,t){var r,n=new se;return Mt.telemetryEnabled=!f(Lt,t.site)&&oe(t.telemetrySampleRate),Mt.telemetryConfigurationEnabled=Mt.telemetryEnabled&&oe(t.telemetryConfigurationSampleRate),Dt=o=Bt,g(Mt,{maxEventsPerPage:t.maxTelemetryEventsPerPage,sentEventCount:0}),{setContextProvider:observable:n,enabled:Mt.telemetryEnabled}}zt={HIDDEN:"visibility_hidden",UNLOADING:"before_unload",PAGEHIDE:"page_hide",FROZEN:"page_frozen"},Vt="datadog-synthetics-result-id",Gt="datadog-synthetics-injects-rum";r Jt=);ar Kt=3*b,Qt=$,Xt=H;nction er(e,t,r,n){var o=n.onSuccess,i=n.onFailure;t.bandwidthMonitor.add(e),r(e,(function(r){t.bandwidthMonitor.remove(e),r)?(t.transportStatus=t.bandwidthMonitor.ongoingRequestCount>0?1:2,e.retry={count:e.retry?e.retry.count+1:1,lastFailureStatus:r.status},i()):(t.transportStatus=0,o())}))}r nr=!1;function or(e,t,r,n){var o=new XMLHttpRequest;o.open("POST",t,!0),wt(0,o,"loadend",(,{once:!0}),o.send(r)}function ir(e,t,r,n,o,i){var a,s=c(e,t);function c(e,t){return new Jt(function(e,t,r,n){var o={transportStatus:0,currentBackoffTime:Xt,bandwidthMonitor:{ongoingRequestCount:0,ongoingByteCount:0,canHandle:add:remove:,queuedPayloads:rr(),queueFullReported:!1},i=function(e,n){return function(e,t,r,n,o){var i=n.data,a=n.bytesCount,s=n.flushReason,c=n.retry;if()&&a<r){var l=t.build("fetch",s,c);fetch(l,{method:"POST",body:i,keepalive:!0,mode:"cors"}).then(u((),u((function(){or(0,t.build("xhr",s,c),i,o)})))}else{or(0,t.build("xhr",s,c),i,o)}}(0,t,r,e,n)};return{send:sendOnExit:function(n){!function(e,t,r,n){var o=n.data,i=n.bytesCount,a=n.flushReason;if(navigator.sendBeacon&&i<r)try{var s=t.build("beacon",a);if(navigator.sendBeacon(s,o))return}catch(e){!e)}or(0,t.build("xhr",a),o)}(e,t,r,n)}}}(e,t,e.batchBytesLimit,r),function(e){var t=e.messagesLimit,r=e.bytesLimit,n=e.durationLimit,o=e.pageExitObservable,i=e.sessionExpireObservable,a=new se;o.subscribe((),i.subscribe(();var s,c=0,u=0;turn{flushObservable:a,get messagesCount(){return u},notifyBeforeAddMessage:notifyAfterAddMessage:notifyAfterRemoveMessage:}({messagesLimit:e.batchMessagesLimit,bytesLimit:e.batchBytesLimit,durationLimit:e.flushTimeout,pageExitObservable:n,sessionExpireObservable:o}),e.messageBytesLimit)}return i&&(a=c(e,i)),{add:}var ar,sr=1/0,cr=$,ur=function(){eturn e.prototype.add=e.prototype.find=e.prototype.closeActive=e.prototype.findAll=function(e,t){void 0===e&&(e=sr),void 0===t&&(t=0);var r=e,t);return this.entries.filter(().map((function(e){return e.value}))},e.prototype.reset=function(){this.entries=[]},e.prototype.stop=e.prototype.clearOldValues=e}(),lr=$,dr=fe,fr=[];function pr(e){var t=function(e,t,r){var n=function(e,t,r){var n=new se,o=new se,i="Cookie"===e.type?function(e){var t,r={persistSession:(t=e,,retrieveSession:Ee,clearSession:Ie(e)};return r),r}(e.cookieOptions):{persistSession:Te,retrieveSession:Re,clearSession:Le},a=i.clearSession,s=i.retrieveSession,c=P((,Ge),u=);urn{expandOrRenewSession:j((function(){var e;Ue({process:after:,i)}),Ge).throttled,expandSession:getSession:function(){return u},renewObservable:n,expireObservable:o,expire:stop:function(){A(c)}}}(e.sessionStoreStrategyType,t,r);fr.push((function(){return n.stop()}));var o,i=new ur(dr);eturn fr.push((function(){return i.stop()})),n.renewObservable.subscribe((),n.expireObservable.subscribe((),n.expandOrRenewSession(),i.add(a(),[0,Y()][0]),o=St(0,window,["click","touchstart","keydown","scroll"],(function(){return n.expandOrRenewSession()}),{capture:!0,passive:!0}).stop,fr.push(o),function(e,t){var r=n=wt(0,document,"visibilitychange",r).stop;fr.push(n);var o=P(r,lr);fr.push(()}(0,(function(){return n.expandSession()})),{findActiveSession:function(e){return i.find(e)},renewObservable:n.renewObservable,expireObservable:n.expireObservable,expire:n.expire}}(e,"logs",();return{findTrackedSession:expireObservable:t.expireObservable}}ar vr=((ar={})[jt.debug]=0,ar[jt.info]=1,ar[jt.warn]=2,ar[jt.error]=3,ar);ar mr=!1;function yr(e){var t,r=window;if(Ht()){var n=o(r.DD_RUM_SYNTHETICS);return n||mr||(mr=!0,qt("Logs sent before RUM is injected by the synthetics worker",{testId:(t=window._DATADOG_SYNTHETICS_PUBLIC_ID||ve("datadog-synthetics-public-id"),"string"==typeof t?t:void 0),resultId:$t()})),n}return o(r.DD_RUM);var br,wr={};function Sr(t){var n=t.map((function(t){return wr[t]||(wr[t]=function(t){var n=new se((function(){var o=r[t];return r[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o.apply(console,r);var a=function(){var e,t=new Error;if(!t.stack)try{throw t}catch(e){}return l((),e}();l((function(){n.notify(function(t,r,n){var o,i,a=t.map(().join(" ");if(r===e.error){var s=t,(function(e){return e instanceof Error}));o=s?yt(it(s)):void 0,i=mt(s),a="console error: ".concat(a)}return{api:r,message:a,stack:o,handlingStack:n,fingerprint:i}}(r,t,a))}))},));return n}(t)),wr[t]}));return ce.apply(void 0,n)}var _r,Or,xr=((br={})[e.log]=jt.info,br[e.debug]=jt.debug,br[e.info]=jt.info,br[e.warn]=jt.warn,br[e.error]=jt.error,br),Pr=((_r={})[_t.cspViolation]=jt.error,_r[_t.intervention]=jt.error,_r[_t.deprecation]=jt.warn,_r);r kr,Cr=new WeakMap;nction Dr(e,t){var r=this,n=Cr.get(this);if(n){var o=n;o.state="start",o.startTime=Q(),o.startClocks=X(),o.isAborted=!1,o.xhr=this;var i=!1,a=jr(this,"onreadystatechange",{before:).stop,s=c=wt(0,this,"loadend",s).stop;t.notify(o)}}ction Mr(e,t){if(!e.forwardErrorsToLogs)return{stop:k};var r=Er(e).subscribe((function(e){"complete"===e.state&&o("xhr",e)})),n=).subscribe(();function o(r,n){.isIntakeUrl(n.url)||!n)&&!Wt(n.status)||("xhr"in n?n.xhr,e,o):n.response?n.response,e,o):n.error&&n.error,e,o))}return{stop:}r Br=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?([\s\S]*)$/;var Ur,Fr,zr,Vr=),Gr=function(r){var n,o,i=!1,a=F("global context"),c=F("user"),l={},d=function(){},p=new G,v=m=function(){},y=new Et((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return v.apply(void 0,e)}));eturn n={logger:y,init:u((function(r){var n;if(m=ee()&&(r=r)),r)){var o=r);o&&(n=function(r,n,o,i){var a=new Vr;a.subscribe(1,();var s=c=function(e){var t=new se((function(){var e=ne(V.PAGEHIDE),r=St(0,window,["visibilitychange","freeze","pagehide"],(,{capture:!0}).stop,n=k;return e||(n=wt(0,window,"beforeunload",().stop),function(){r(),n()}}));return t}(),u=!n.sessionStoreStrategyType||ee()||Ht()?n):pr(n),l=n,s,c,u.expireObservable);l.setContextProvider((),Mr(n,a),function(e,t){if(!e.forwardErrorsToLogs)return{stop:k};var r,n=new se,o=(r=n,function(e){var t=e).stop,r=e).stop;return{stop:}(()).stop,i=n.subscribe(()}(n,a),function(t,r){Sr(t.forwardConsoleLogs).subscribe(()}(n,a),function(e,t){Ot(0,e.forwardReports).subscribe(()}(n,a);var d,f=function(e){return{handleLog:function(r,n,o,i){var a=r.context;gr(r.status,"console",n)&&t(r.status,r.message,D(n.getContext(),a)),e.notify(0,{rawLogsEvent:{date:i||K(),message:r.message,status:r.status,origin:At.LOGGER},messageContext:a,savedCommonContext:o,logger:n})}}}(a).handleLog;return function(e,t,r,n,o,i){var a=Ct.concat(["custom"]),s={};a.forEach((function(e){var r,n,o,a,c;s[e]=(r=e,n=t.eventRateLimiterThreshold,o=i,a=0,c=!1,{isLimitReached:)})),r.subscribe(0,(function(i){var a,c,u,l=i.rawLogsEvent,d=i.messageContext,f=void 0===d?void 0:d,p=i.savedCommonContext,h=void 0===p?void 0:p,v=i.logger,g=void 0===v?o:v,m=l.date-Y(),y=e.findTrackedSession(m);if(y){var b=h||n(),w=D({service:t.service,session_id:y.id,usr:ae(b.user)?void 0:b.user,view:b.view},b.context,yr(m),l,g.getContext(),f);!gr(l.status,kt,g)||!1===(null===(a=t.beforeSend)||void 0===a?void 0:a.call(t,w))||(null===(c=w.error)||void 0===c?void 0:c.origin)!==At.AGENT&&(null!==(u=s[w.status])&&void 0!==u?u:s.custom).isLimitReached()||r.notify(1,w)}}))}(u,n,a,o,i,s),ee()?a):n,a,s,c,u.expireObservable),function(e){var t=e);return g({forward_errors_to_logs:e.forwardErrorsToLogs,forward_console_logs:e.forwardConsoleLogs,forward_reports:e.forwardReports},t)}(r)),{handleLog:f,getInternalContext:(d=u,{get:).get}}(r,o,b,y),v=n.handleLog,d=n.getInternalContext,p.drain(),i=!0)}})),getLoggerGlobalContext:u(a.get),getGlobalContext:u(a.getContext),setLoggerGlobalContext:u(a.set),setGlobalContext:u(a.setContext),addLoggerGlobalContext:u(a.add),setGlobalContextProperty:u(a.setContextProperty),removeLoggerGlobalContext:u(a.remove),removeGlobalContextProperty:u(a.removeContextProperty),clearGlobalContext:u(a.clearContext),createLogger:u((),getLogger:u((function(e){return l[e]})),getInitConfiguration:u((),getInternalContext:u((function(e){return d(e)})),setUser:u((),getUser:u(c.getContext),setUserProperty:u((),removeUserProperty:u(c.removeContextProperty),clearUser:u(c.clearContext)},o=g({version:"4.47.0",onReady:,n),Object.defineProperty(o,"_setDebug",{get:function(){return s},enumerable:!1}),o}();Fr=Gr,zr=(Ur=m()).DD_LOGS,Ur.DD_LOGS=Fr,zr&&zr.q&&zr.q.forEach(()}()},8232:()=>{window.coreAds=window.coreAds||{},window.pmsCoreAds=window.pmsCoreAds||[],window.coreAds.queue=window.coreAds.queue||[],window.coreAdsTemplate=window.coreAdsTemplate||{},window.coreAdsTemplate.queue=window.coreAdsTemplate.queue||[],window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.dataLayer=window.dataLayer||[],window.parent.DFPVars=window.DFPVars||{},window.DD_LOGS=window.DD_LOGS||{},window.pmspbjs=window.pmspbjs||{},window.pmspbjs.que=window.pmspbjs.que||[]},4963:7722:6793:3328:7007:9315:50:2736:6886:1488:2032:9824:5795:5645:2811:741:1355:7057:2457:4430:5541:2985:4253:8082:3218:3531:18:3816:9181:7728:639:1734:266:9797:6555:4302:5286:5364:8851:9988:2923:7462:5436:2803:4461:4728:2503:9275:5588:8693:9327:616:4548:468:189:7184:4682:1131:7643:681:4408:7234:7787:1165:7195:7375:2974:2943:9335:3825:,8364,7717,4496,2337,1467,2110,875,508,1689,3953,1616,6074,8787,6314,9002,8837:(e,t,r)=>{"use strict";var n=r(2985),o=r(50)(2);n(n.P+n.F*!r(7717)([].filter,!0),"Array",{filter:function(e){return o(this,e,arguments[1])}})},6997,9371,110,75,6253,8269,9357,6142,1876,8184,5767,2773,3276,8351,1181,4020n e}(exporexporexpor);r++rts=nreturn r}},7345:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>ne=>{e(t()>{throw e})))))},5860:(e,t,r)=>{"use strict";const n=r(8939),o=r(8147),i),a=()=>{},s=new o.TimeoutError;t.Z=class extends n{constructor(e){var t,r,n,o;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=a,this._resolveIdle=a,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:i.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(o=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==o?o:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAcurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=a,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=a,this.emit("idle"))}_onResId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=senterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._procther(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((r,n)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const i=void 0===this._timeout&&void 0===t.timeout?e():o.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&n(s)}));r(await i)}catch(e){n(e)}this._next()}),t),this._tryToStartAnother(),this.emitd(e,ausueueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._r>{t(),e()}}))}get size(){return this._e).length}get pending(){return this._pendingCount}get isPaused(){return thisimeout=e}}},7489:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let n=0,o=e.length;for(;o>0;){const i=o/2|0;let a=n+i;r(e[a],t)<=0?(n=++a,o-=i+1):o=i}return n}},6506:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7489);t.def_queue=[]}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const o=n.default(thise.priority));this._queue.splice(o,0d 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((ue.lengexports=s},8147:(e,t,r)=>{"use strict";constutError"}}const i=(e,t,r)=>new Promise(((i,a)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void i(e);const s=sel(),a(n)}),t);n(e.imeout(s)}))}));e.exports=i,e.exports.default=i,e.exports.TimeoutErrk(e,lengase()e.expe.exp= r")(i.e,{a:et:tn wind.calalue:!0})};var n={};(()=>{"ud 0)}))}}r.r(n),r.d(n,{addDisplaySlot:()=>Xo,addDisplaySlots:()=>Yo,getBrandConfig:()=>fi,getPageInfos:()=>ui,getPageTargeting:()=>li,getSlots:()=>di,getVideoAdParams:()=>ri,getVideoSlotParameters:()=>si,main:()=>Ko,onDemand:()=>Zo,onInit:()=>ei,queue:()=>pi,refreshAdUnit:()=>ti,refreshDisplaySlot:()=>ii,refreshDisplaySlots:()=>ai,reset:()=>ci,setRefreshTimer:()=>oi,validatyer:()=>ni});var o=r(4687),i=r.n(o);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(6142),r(110),r(6253),r(5767),r(6997),r(1181),r(9357),r(2773),r(187Refused=r}consentCollection(){this._waitForTCFAPtConsent()})}_collectConsent(){window.__tcfapi("addEventListener",2,((e,t)=>{var r;t&&"cmpuishown"!==e.eventStatus&&(null!==(r=e.purpose)&&void 0!==r&&r.consents[1]?this.onConsentReceived(e):this.onConsentRefused())}))}_waitForTCFAPI(e){var t=e.onReady;if(window.__tcfapi)return t();var r=new MutationObserver(((e,r)hrow i}}}}(e);try{for(o.s();!(n=o.n()).done;){var i,s=n.value;if("__tcfapiLocator"===(null==s||null===(i=s.addedNodes[0])||void 0===i?void 0:i.name))return r.disconnect(),t()}}catch(e){o.e(e)}finally{o.f()}}));return r.observe(document.body,{childList:!0}),r}}var c=r(7563),u={trace:10,debug:20,info:30,warn:40,error:50,fata)+"'"}function g(e){if("string"!=typeof e){for(var t=new Array(arguments.length),r=0;r<arguments.length;r++)t[r]=v(arguments[r]);return t.join(" ")}for(var n=1,o=arguments,i=o.length,a=String(e).replace(/return e}})),s=o[n];n<i;s=o[++n])a+=null===s||"object"!=typeof s?" "+s:" "+v(s);return a}Object.keys(u).forEach((function(e){l[u[e]]=e})r(e+"\n")}var b=tion e(){}return e.protoog(e.obj)},e}(),w=function(){function e(t,r,n){var o,i,a,s,c=this;if(!(this instanceof e))return new e(t,r);if(void 0!==r&&(o=t,t=r,!(o instanceof e)))throw new TypeError("invalid Logger creation: do not pass a second arg");if(!t)throw new TypeError("options (object) is required");if(o){if(t.name)throw new TypeError("invalid options.name: child cannot set logger name")}else if(!t.name)throw new TypeError("options.name (string) is required");if(t.stream&&t.streams)throw new TypeError('cannot mix "streams" and "stream" options');if(t.streams&&!Array.isArray(t.streams))throw new TypeError("invalid options.streams: must be an array");if(t.serializers&&("object"!=typeof t.serializers||Array.isArray(t.serializers)))throw new TypeError("invalid options.serializers: must be an object");if(o&&n){this._level=o._level,this.streams=o.streams,this.serializers=o.serializers,this.src=o.src,i=this.fields={};var u=Object.keys(o.fields);for(s=0;s<u.length;s++)i[a=u[s]]=o.fields[a];var l=Object.keys(t);for(s=0;s<l.length;s++)i[a=l[s]]=t[a]}else{if(o){for(this._level=o._level,this.streams=[],s=0;s<o.streams.length;s++){var d=h(o.streams[s]);this.streams.push(d)}this.serializers=h(o.serializers),this.src=o.src,this.fields=h(o.fields),t.level&&this.level(t.level)}else this._level=Number.POSITIVE_INFINITY,this.streams=[],this.serializers=null,this.src=!1,this.fields={};t.stream?this.addStream({type:"stream",stream:t.stream,level:t.level}):t.streams?t.stream,t.level)})):o&&t.level?this.level(t.level):o||this.addStream({type:"raw",stream:new b,level:t.level}),t.serializers&&this.addSerializers(t.serializers),t.src&&(this.src=!0),delete(i=h(t)).stream,delete i.level,delete i.streams,delete i.serializers,delete i.src,this.serializers&&this._applySerializers(i),Object.keys(is[e]=i[e]}))}}var t=e.prototype;return tawStreams},t.addSs[r]=n}),e||{},t._level=t},t.levels=function(e,t){if(void 0===e)return this.stn e.level}));var r;if("number"==typeof e){if(void 0===(r=this.streams[e]))throw new Error("invalid stream index: "+e)}else{for(var n=this.streams.length,o=0;o<n;o++){var i=this.streams[o];if(i.name===e){r=i;break}}if(!r)throw new Error(g('no stream with name "%s"',e))}if(void 0===t)return r.level;var a=d(t);r.level=a,a<this._level&&(this._level=a)},t._applyS)',n)}}))},t._emit=function(e,t){var r,n;if(void 0===this.haveNonRawStreams)for(this.haveNonRawStreams=!1,r=0;r<this.streams.length;r++)if(!this.streams[r].raw){this.haveNonRawStreams=!0;break}if(t||this.haveNonRawStreams)try{n=JSON.stringify(e,function(){var eh(r),r):r}}())+"\n"}catch(t){var o=t.stack.split(/\n/g,2).join("\n");y('bunyan: ERROR: Exception in `JSON.stringify(rec)`. You can install the "safe-json-stringify" module to have Bunyan fallback to safer stringification. n("\n"+t)}(g("%s\n%s",e,t.stack)),o),n=g("(Exception in JSON.stringify(rec): %j. See stderr for details.)\n",t.message)}if(t)return n;var i=e.level;for(r=0;r<this.streams.length;r++){var a=this.streams[r];a.level<=i&&a.stream.write(e)}return n},e}();function S(e){return function(){var t=this,r=null,n=arguments,o=null;if(0===arguments.length)return this._level<=e;this._level>e||(o=function(o){var i;o[0]instanceof Error?(r={err:t.serializers&&t.serializers.err?t.serializers.err(o[0]):O.err(o[0])},i={err:!0},n=1===o.length?[r.err.message]:Array.prototype.slice.call(o,1)):"object"!=typeof o[0]&&null!==o[0]||Array.isArray(o[0])?(r=null,n=Array.prototype.slice.call(o)):(r=o[0],n=1===o.length&&r.err&&r.err instanceof Error?[r.err.message]:Array.prototype.slice.call(o,1));var a=h(t.fields);a.level=e;var s=r?h(r):null;if(s&&(t.serializers&&t._applySerializers(s,i),Object.keys(sa[e]=s[e]}))),a.levelName=l[e],a.msg=n.length?g.apply(t,n):"",a.time||(a.time=new Date),t.src&&!a.src)try{throw new Error("call-stack-error")}catch(e){var c=e.stack?function(e,t){var r=e.split("\n");r[0]&&r[0].indexOf("call-stack-error")>=0&&r.shift();var n=r[2],o=null;if(n){var i=/^\s*(at|.*@)\s*(.+)?$/.exec(n);o=Array.isArray(i)&&i[2]?i[2]:n}return o}(e.stack):"";c||m.src||y("Unable to determine src line info","src"),a.src=c||""}return a.v=1,a}(n),this.}return t}w.prototype.trace=S(10),w.prototype.debug=S(20),w.prototype.info=S(30),w.prototype.warn=S(40),w.prototype.error=S(50),w.prototype.fatal=S(60);signal}:e}},x={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},P={};Object.keys(xP[x[e]]=e}));var A,j,k,C={levels:{trace:"color: DeepPink",debug:"color: GoldenRod",info:"color: DarkTurquoise",warn:"color: Purple",error:"color: Crimson",fatal:"color: Black"},def:"color: DimGray",msg:"color: SteelBlue",src:"color: DimGray; font-style: italic; font-size: 0.9em",name:"color: white; font-weight: 600; background-color: purple; border-radius: 2px; border: 1px solid purple;",time:"background-color: white;"};const E=(j=c.parse(null===(A=window)||void 0===A||null===(A=A.location)||void 0===A?void 0:A.search),k=[],(location.hostname.includes("pmd-advertising.localhost")||"true"===j.debugads)&&k.push({level:"trace",stream:new class{constructor(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).css,t=void 0===e?C:e;this.css=t}write(e){var t,r,n=e.childName?e.name+"/"+e.childName:e.name,o=this.css.def,i=this.css.msg,a=this.css.src,s=this.css.time;r=n.includes("Datadog")?"color: white; font-weight: 600; background-color: #F19953; border-radius: 2px; border: 2px solid #F19953;":this.css.name;var c=P[e.level],u=c.toUpperCase(),l=console.log;switch(e.level){case 10:t=this.css.levels.trace;break;case 20:t=this.css.levels.debug;break;case 30:default:t=this.css.levels.info;break;case 40:t=this.css.levels.warn;break;case 50:t=this.css.levels.error;break;case 60:t=this.css.levels.fatal,c="error"}var d=e.time.getMilliseconds(),f=(new Date).toLocaleTimeString()+":0"+d,p=[];p.push("%c%s%c [%s] %c%s%c: %s: %c%s ".concat(e.src?"%c%s":""),r,e.name.toUpperCase(),s,f,t,u,o,n,i,e.msg),e.src&&(p.push(a),p.push(e.src)),e.obj&&p.push(e.obj),l.apply(console,p),e.err&&e.err.stack&&l.call(console,"%c%s,",t,e.err.stack)}}}),function(){return p(w,[].slice.call(arguments))}({name:"Core-Ads",streams:k,seriale[t]=r,e}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Object.prototype.toString,Array.prototype.slice,r(8837),r(8351);var L=function(){var e=t(i().mark((function e(t){var r,n,o,a,s,c,u,l=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:1e4,n=l.length>2&&void 0!==l[2]?l[2]:{},o=new AbortController,a=s>o.abort()),r),e.next=6,fetch(t,R(R({},n),{},{signal:o.signal}));case 6:if(s=e.sent,clearTimeout(a),c=s.status,!(s.ok&&c>=200&&c<=400)){e.next=11;break}return e.abrupt("return",s.json());case 11:throw(u=new Error(s.statusText)).response=s,u;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=(e,t)=>t.reduce(((t,r,n,o)=>n%e?t:[...t,o.slice(n,n+e)]),[]),N=()=>(new Date).toLocaleString("fr-FR",{hour:"numeric",hour12:!1,timeZone:"Europe/Paris"}).split(" ")[0],q=function(e){var t,r=(t=e.urlHash)&&new URLSearchParams(t.slice(1)).get("nlsha")||"";if(""!==r)return r;var n=localStorage.getItem("userHashedEmail");return null!==n?n:""},B=(r(8184),r(9371),function(){var e=t(i().mark((function e(t){var r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.length>1&&void 0!==n[1]?n[1]:50;case 1:if(t()){e.next=6;break}return e.next=4,nemeout(e,r)));case 4:e.next=1;break;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());class U{static exists(e){return U.repository.readAll(pn).some((t=>t.type.toLowerCase()===e.toLowerCase()))}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[rt}function X(e){return Pe&&e instry",new class{read(e){var t=e.name;return this.readAllowerCase()))||null}readAll(){var e=an.getPageInfos().device;return pn.slots.filter((t=>"Pave-Haut2-Desktop"!==t.type&&"Pave-Haut"!==t.type||"desktop"===e&&"Pave-Haut2-Desktop"===t.type||"Pave-Haut"===t.type&&!0!==t.notPlayer||"mobile"===e&&"Pave-Haut"===t.type&&!0===t.notPlayer?t:void 0))}}),r(3276);var _e,Oe,xe="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Pe="undefined"!=typeof Map,Ae="undefined"!=typeof Set,je="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,ke=xe?Symbol.for("immer-nothing"):((_e={})["immer-nothing"]=!0,_e),Ce=xe?Symbol.for("immer-draftable"):"__$immer_draftable",Ee=xe?Symbol.for("immer-state"):"__$immer_state",Ie=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),De="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropembols(e))}:Object.getOwnPropertyNames,Te=Object.getOwnPropertyDee,r)})),t},Re=h,n,t in Z(eeys(t]=!0),!0},delee.o[t],!0},getOwnPropertye:r[t]}:n},defineProperty:function(){V(11)},getPpeOf(e.t)},setPn(){V(12)}},Mguments)}})),Me.delet,void t,r,e[0,t)}))},e}(),qe=new Ne,Be=qe.produce;qe.produceWithPatches.bind(qe),qe.setAutoFreeze.bind(qe),qe.setUseProxies.bind(qe),qe.applyPatches.bind(qe),qe.createDraft.bind(qe),qe.finishDraft.bind(qe);const Ue=Be;var Fe="NOT=0}}),h}}var He=Ge(Ve);function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})errors. "}var Ke="function"==typeof Symbol&&Symbol.observable||"@@obsejoin(".")},Xe={INIT:"@@redux/INIT"+Qe(),REPLACE:"@@redux/REPLACE"+Qe(),PROBE_UNKNI(o)}}}}var rt=tt();rt.withExtraArgument=tt;const nt=rt;varpe,n;return e},st=Object.defineProperty,ct=Object.defineProperties,ut=Object.getOwnPropertyDescriptors,lt=Object.getOwnPropertySymbols,dt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnu}):;re(e,):e],t))}},mt="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSIONf(e)>-1}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var St=function(e){function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=e.apply(this,r)||this;return Object.setPrototypeOf(o,t.prototype),o}return it(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,at([void 0],e[0].concat(this)))):new(t.bind.apply(t,at([void 0],e.concat(this))))},t}is))))}ate()}}}function At(e){return function(t,r){function ntype"in e}(t=e)&&"string"==typeof t.type&&Object.keys(t).every(wt);vt):e(r,t)};return G(t)?(o(t),ti);return t},Tt=["name","message","stack","code"],Rt=function(e,t){this.payload=e,this.is.e.payload}!function(){function e(e,t,r){var n=bt(e+"/filled"})}})),o=bt(e+"nding"})}})),i=bt(e+"/.name)})}})),a="undefined"!=typeof AbortController?Abortion(){},e}();return Object.assign((function(e){return function(s,c,u){var l,d=(null==r?void 0:r.idGenerator)?r.idGenerator(e):Dtf.abovar a,h,v}();return Object.assign(h,{abort:p,requestId:d,ar.then(Nt)}})}}),{pending:o,rejected:i,fulfilled:n,typePrefix:e})}e.withTypes=function(){return e}}(),Object.assign;var qt="listenerMiddleware";bt(qt+"/add"),bt(qt+"/removeAll"),bt(qt+"/remove"),"function"==typeof queueMicrotask&&queueMicrotask.bind("undefined"!=typeof window?window:void 0!==r.g?r.g:globalThis);"undefined"!=typeof window&&window.requestAnimationFrame&&window.requestAnimationFrame,turn!1}var o,ile),r(e):n(e)}},Re[o="ES5"]||(Re[o]=i)}();var Bt=["Postitiel_V2","Postitiel","Pave-Bas2","Pave-Bas","Banniere-Basse","Pave-Haut2-Desktop","Pave-Haut2","Out-Of-Banner","Pave-Haut","Banniere-Haute"],Ut=It({sortComparer:(e,t)=>{var r=Bt.indexOf(e.name),n=Bt.indexOf(t.name);return r<n?1:r>n?-1:0}}),Ft=Pt({name:"slots",initialState:Ut.getInitialState(),reducers:{addSlot:Ut.addOne,updateSlot:Ut.updateOne,removeSlot:Ut.removeOne}});const zt={selectors:Ut.getSelectors((e=>e.slots)),actions:Ft.actions,reducer:Ft.reducer};var Vt=It(),Gt=Pt({name:"pageInfos",initialState:Vt.getInitialState(),reducers:{addPageInfo:Vt.addOne,updatePageInfo:Vt.updateOne,removePageInfo:Vt.removeOne}});const Ht={selectors:Vt.getSelectors((e=>e.pageInfos)),actions:Gt.actions,reducer:Gt.reducer};var $t=It(),Jt=Pt({name:"state",initialState:$t.getInitialState(),reducers:{addState:$t.addOne,updateState:$t.updateOne,removeState:$t.removeOne}});const Wt={selectors:$t.getSelectors((e=>e.state)),actions:Jt.actions,reducer:Jt.reducer};var Kt=zt.actions,Qt=Kt.addSlot,Xt=Kt.updateSlot,Yt=Kt.removeSlot,Zt=zt.selectors,er=Ht.actions,tr=er.addPageInfo,rr=er.updatePageInfo,nr=er.removePageInfo,or=Ht.selectors,ir=Wt.actions,ar=ir.addState,sr=ir.updateState,cr=ir.removeState,ur=Wt.selectors;const lr=function(e){var t,r=function(e){return function(e){void 0===e&&(e={});var t=e.thunk,r=void 0===t||t,n=(e.immutableCheck,e.serializableCheck,e.actionCreatorCheck,new St);return r&&(function(e){return"boolean"==typeof e}(r)?n.push(nt):n.push(nt.withExtraArgument(r.extraArgument))),n}(e)},n=e||{},o=n.reducer,i=void 0===o?void 0:o,a=n.middleware,s=void 0===a?r():a,c=n.devTools,u=void 0===c||c,l=n.preloadedState,d=void 0===l?void 0:l,f=n.enhancers,p=void 0===f?void 0:f;if("function"==typeof i)t=i;else{if(!yt(i))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineRegth)?o:e}}(i)}var h=s;"function"==typeof h&&(h=h(r));var v=et.apply(void 0,h),g=Ze;u&&(g=mt(ht({trace:!1},"object"==typeof u&&u)));var m=new _t(v),y=m;return Array.isArray(p)?y=at([v],p):"function"==typeof p&&(y=p(m)),Ye(t,d,g.apply(void 0,y))}({reducer:{slots:zt.reducer,pageInfos:Ht.reducer,state:Wt.reducer}});class dr{constructor(e){this.store=lr,this.crud=e,this.create=this.create.bind(this)}create(e){return e.id=e.id||Dt(),this.store.dispatch(this.crud.crs.create)}read(e){if(e!==Object(e))return null;var t=z(Object.entries(e)[0],2),r=t[0],n=t[1];return this.readAll().find((e=>tState())}update(e,t){if(this.readAll().map((e=>e.id)).includes(e))return this.store.dispatch(this.crud.update({id:e,changes:t}));throw new Error("UNKOWNelete(e))}deleteAll(){this.readAll(te(e.id))}))}}class fr{static build(e){return{env:e.env,device:e.device,trigram:e.trigram,appName:e.appName,brandName:e.brandName,networkId:e.networkId,url:e.url,prismaUrl:e.prismaUrl,domain:e.domain,domainName:e.domainName,subDomain:e.subDomain,query:e.query,hash:e.hash,referrer:e.referrer,pageType:e.pageType,pageCategory:e.pageCategory,pageSubCategory:e.pageSubCategory,pageName:e.pageName,keywords:e.keywords,pageHitId:e.pageHitId,displayAdUnitPath:e.displayAdUnitPath,videoAdUnitPath:e.videoAdUnitPath,hasVideos:e.hasVideos,contentObjectId:e.contentObjectId,nonStickyLineItems:e.nonStickyLineItems,abvariant:e.abvariant,gs_cat:e.gs_cat,pm_contextual:e.pm_contextual,mics_segments:e.mics_segments}}}D(fr,"repository",new class extends dr{constructor(){super({readAll:or.selectAll,create:tr,update:rr,delete:nr})}read(){return this.readAll()[0]}});class pr extends dr{constructor(){super({readAll:Zt.selectAll,create:Qt,update:Xt,delete:Yt})}create(e){return this.read({elementId:e.elementId})?null:super.create(e)}readAll(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=super.readAll();return null===e?t:t.filter((t=>t.format===e))}}function hr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class gr{constructor(){return gr.advis||(gr.advis=this),this.logger=E.child({childName:"Advis"}),gr.advis}init(){var e=this;return t(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.fetchJsonFile();case 3:r=t.sent,e.mapAdvisDataWithSlots(r),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),new Error("Cannot fetch the advis file",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}mapAdvisDataWithSlots(e){var t=an.getPageInfos().device;if(!t||!e)return null;var r=e[t.charAt(0).toUpperCase()+t.slice(1)];if(!r)return null;this.datas=r.map((e=>vr(vr({adUnitPath:"/".concat(e.adUnitPath)},e.video_completion?{video_completion:e.video_completion}:{}),{},{visibility:vr(vr(vr(vr(vr(vr(vr(vr({},e.attentive_seconds?{attentive_seconds:e.attentive_seconds}:{}),e.visibility?{pmvisibilite:e.visibility}:{}),e.viewed?{viewed:e.viewed}:{}),e.viewed_1s?{viewed_1s:e.viewed_1s}:{}),e.viewed_2s?{viewed_2s:e.viewed_2s}:{}),e.viewed_3s?{viewed_3s:e.viewed_3s}:{}),e.viewed_time?{viewed_time:e.viewed_time}:{}),e.viewed_time_bucket?{viewed_time_bucket:e.viewed_time_bucket}:{})},e.greenbidsPackage?{greenbidsPackage:e.greenbidsPackage}:{})))}fetchJsonFile(){return t(i().mark((function e(){var t,r,n,o,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=an.getPageInfos(),r=t.env,n=t.displayAdUnitPath,o="production"===r?"https://tra.scds.pmdstatic.net/advis":"https://rec2-tra.scds.pmdstatic.net/advis",a=n.split("/").filter(Boolean),s="".concat(o,"/").concat(a[0].split(",")[0],"/").concat(a[1],"/").concat(a[2],"/").concat(a[3].toLowerCase(),".json").toLowerCase(),e.prev=4,e.next=7,L(s);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),new Error("Could not fetch visibility file for slots");case 13:case"end":return e.stop()}}),e,null,[[4,10]])})))()}}const mr=new gr;function yr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function br(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yr(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class wr{static build(e){var t;return{format:"display",name:e.name,elementId:e.elementId,devices:(null===(t=e.DOMData.device)||void 0===t?void 0:t.split(","))||[],DOMData:e.DOMData,isRefreshable:e.isRefreshable||!pn.dontRefreshSlot.includes(e.name),refreshId:void 0,isViewable:!1,timeout:pn.refreshTimer,status:e.status||"empty",renderCount:e.renderCount||0}}static buildFromDOMSlot(e){var t=e.getAttribute("data-ads-core").replace(/\s/g,""),r=JSON.parse(t);return wr.build({name:r.type,elementId:e.id,DOMData:r})}static areAllRendered(){return wr.repository.readAll("display").every((e=>"rendered"===e.status))}static getConfigdfp(e){var t,r,n,o=U.repository.read(e),i=fr.repository.readAll();if(!o||!i)return null;var a,s=i[0].displayAdUnitPath,c="".concat(s,"/").concat(e.name).toLowerCase(),u=null==mr||null===(t=mr.datas)||void 0===t?void 0:t.find((e=>e.adUnitPath===c)),l=[];return null!==(r=o.dfp)&&void 0!==r&&r.sizes?l=null===(a=o.dfp)||void 0===a?void 0:a.sizes:null!==(n=o.prebid)&&void 0!==n&&null!==(n=n.mediaTypes)&&void 0!==n&&null!==(n=n.banner)&&void 0!==n&&n.sizes&&(l=o.prebid.mediaTypes.banner.sizes),{type:e.name,code:e.elementId,index:e.index,advis:(null==u?void 0:u.visibility)||void 0,greenbidsPackage:(null==u?void 0:u.greenbidsPackage)||void :e.google}static getConfigAmazon(e){var t=U.repository.read(e),r=fr.repository.readAll();if(!t||!t.amazon||0===r.length)return null;var n=wr.getConfigdfp(e);return br(br({},t.amazon),{},{slotID:n.code,slotName:"".concat(r[0].displayAdUnitPath,"/").concat(e.name)})}}function Sr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Sr(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}D(wr,"repository",new pr);class Or{static build(e){var t;return{format:"video",name:"Player-".concat(e.DOMData.playerPosition),elementId:e.elementId,videoId:e.DOMData.playerVideoId,devices:(null===(t=e.DOMData.device)||void 0===t?void 0:t.split(","))||[],DOMData:e.DOMData,status:e.status||"empty",renderCount:e.renderCount||0,reboundCount:e.reboundCount||0}}static buildFromDOMSlot(e){var t=e.getAttribute("data-ads-core").replace(/\s/g,""),r=JSON.parse(t);return Or.build({elementId:e.id,DOMData:r})}static areAllRendered(){return Or.repository.readAll("video").every((e=>"rendered"===e.status))}static getConfigdfp(e){var t,r=fr.repository.readAll(),n=U.repository.read(e);if(!n||0===r.length)return null;var o=r[0].videoAdUnitPath,i="".concat(o,"-").concat(e.DOMData.playerPosition).toLowerCase(),a=null==mr||null===(t=mr.datas)||void 0===t?void 0:t.find((e=>e.adUnitPath===i));return{type:e.name,code:n.code,index:e.index,slottag:i,sizes:n.prebid.mediaTypes.video.playerSize,advis:(null==a?void 0:a.visibility)||void 0,greenbidsPackage:(null==a?void 0:a.greenbidsPackage)||void 0,pmcompletion:(null==a?void 0:a.video_completion)||void 0,player:{playerAccount:e.DOMData.playerAccount,playerVideoId:e.DOMData.playerVideoId,playerPartner:e.DOMData.playerPartner,playerPosition:e.DOMData.playerPosition,playerAutoPlay:void 0===e.DOMData.isAutoPlay||e.DOMData.isAutoPlay}}}static getConfigAmazon(e){var t=U.repository.read(e),r=fr.repository.readAll();if(!t||!t.amazon||0===r.length)return null;var n=Or.getConfigdfp(e);return _r(_r({},t.amazon),{},{slotID:n.code,slotName:"".concat(r[0].videoAdUnitPath,"/").concat(e.name)})}}D(Or,"repository",new pr);class xr{static build(e){var t;return{format:"display",name:"audio-".concat(e.elementId),elementId:e.elementId,devices:(null===(t=e.DOMData.device)||void 0===t?void 0:t.split(","))||[],DOMData:e.DOMData,status:e.status||"empty",renderCount:e.renderCount||0}}static buildFromDOMSlot(e){var t=e.getAttribute("data-ads-core").replace(/\s/g,""),r=JSON.parse(t);return xr.build({elementId:e.id,DOMData:r})}static areAllRendered(){return xr.repository.readAll("audio").every((e=>"rendered"===e.status))}}function Pr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pr(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}D(xr,"repository",new pr);class jr{static build(e){return"display"===e.format?wr.build(e):"video"===e.format?Or.build(e):"audio"===e.format?xr.build(e):null}static buildDisplaySlotFromDOMSlot(e){return wr.buildFromDOMSlot(e)}static buildVideoSlotFromDOMSlot(e){return Or.buildFromOMSlot(e)}static exists(e){return!!jr.repository.read({elementId:e.elementId})}statics(e.name)}static isAllowedOnDevice(e,t){var r;return null===(r=e.devices)||void 0===r||!r.length||e.devices.includes(t)}static registerRender(e){return jr.repository.update(e.id,{status:"rendered",renderCount:e.renderCount+1})}static areAllRendered(e){return"display"===e?wr.areAllRendered():"video"===e?Or.areAllRendered():"audio"===e?xr.areAllRendered():jr.repository.readAll().every((e=>"rendered"===e.status))}static getConfigdfp(e){return"display"===e.format?wr.getConfigdfp(e):"video"===e.format?Or.getConfigdfp(e):null}static getCle():null}static getCn(e):null}static getConfigPrebid(e){var t=fr.repository.readAll(),r=U.repository.read(e);if(r&&r.prebid&&0!==r.prebid.bids.length&&0!==t.length){var n,o,i=t[0],a=i.keywords,s=i.displayAdUnitPath,c=i.videoAdUnitPath,u=Ar(Ar({},r.prebid),{},{code:e.elementId||r.type,type:r.type,pubstack:r.pubstack}),l=mr.datas;if(void 0!==l){var d=(o="video"===e.format?"".concat(c,"-").concat(e.DOMData.playerPosition):"".concat(s,"/").concat(e.name)).toLowerCase();n=l.find((e=>e.adUnitPath===d))}return u.bids.forEach((t=>{if(["anPrisma","anGravity"].includes(t.bidder))t.params.keywords=a;else if(["nexx360"].includes(t.bidder)){var r,i,s,c={ext:{data:Ar(Ar({},void 0!==n&&(null===(r=n)||void 0===r?void 0:r.visibility)),{},{greenbidsPackage:void 0!==n&&(null===(i=n)||void 0===i?void 0:i.greenbidsPackage),position:e.slotPosition,formatPosition:e.formatPosition,prismarefresh:e.renderCount,adunitDFP:o,pmcompletion:void 0!==n&&(null===(s=n)||void 0===s?void 0:s.video_completion)})}};u.ortb2Imp=c}})),u.pubstack&&("video"===e.format?u.pubstack.adUnitPath="".concat(c,"-").concat(e.DOMData.playerPosition):u.pubstack.adUnitPath="".concat(s,"/").concat(e.name)),u}}static formatPosition(){var e,t,r,n=jr.repository.readAll("display"),o=(e=[...n],t="name",r={},new Set([...e].map((e=>e[t]))[t]===n))})),r);Object.keys(o).map((e=>{o[e].forEach(((t,r)=>{jr.repository.update(t.id,{formatPosition:"".concat(e,"_").concat(r+1)})}))}))}}D(jr,"repository",new prenerated}}}D(kr,"repository",new class extends dr{constructor(){super({readAll:ur.selectAll,create:ar,update:sr,ddAll()[0]}});var Cr=r(4974),Er=r.n(Cr);class Ir{constructor(){D(this,"currentDevice",""),this.desktop="(min-width: 1000px)",this.tablet="(min-width: 768px) and (max-width: 999px)",this.mobile="(min-width: 0px) and (max-width: 767px)",this.currentDevice="",this.setDesktop=this.setDesktop.bind(this),this.setTablet=this.setTablet.bind(this),this.setMobile=this.setMobile.bind(this)}init(){return Er().register(this.desktop,this.setDesktop).register(this.tablet,this.setTablet).register(this.mobile,this.setMobile),this.currentDevice}setDesktop(){this.currentDevice="desktop"}setTablet(){this.currentDevic="mobile"}}function Dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class Rr{static build(e){var t=e.networkId,r=e.brandName,n=e.pageType,o=e.pageCategory,i=e.pageSubCategory,a=Rr._formatPageInfos({pageType:n,pageCategory:o,pageSubCategory:i});return{display:"/".concat(t,"/").concat(r,"/").concat(a.pageCategory,"/").concat(a.pageType),video:"/".concat(t,"/").concat(r,"/").concat(a.pageCategory,"/").concat(a.pageType,"/Player-Video"),pageType:a.pageType,pageCategory:a.pageCategory,pageSubCategory:a.pageSubCategory}}static _formatPageInfos(e){var t=e.pageType,r={pageType:t,pageCategory:e.pageCategory,pageSubCategory:e.pageSubCategory},n=e=>{var t,n,o,i=Tr(Tr({},r),e);return i.pageType=null!==(t=i.pageType)&&void 0!==t&&t.length?i.pageType:"Autres",i.pageCategory=null!==(n=i.pageCategory)&&void 0!==n&&n.length?i.pageCategory:"Autres",i.pageSubCategory=null!==(o=i.pageSubCategory)&&void 0!==o&&o.length?"".concat(i.pageSubCategory):"",i};switch(null==t?void 0:t.toLowerCase()){case"website":return n({pageCategory:"_Homepage",pageSubCategory:"",pageType:"HP"});case"websitediapo":return n({pageCategory:"diaporamas-hp",pageSubCategory:"",pageType:"Liste"});case"collectionpage":return n({pageType:"liste"});case"person":return n({pageType:"fiche-bio"});case"webpage":return n({pageType:"Autres"});case"newsarticle":return n({pageType:"Article"});case"movie":return n({pageType:"fiche-cinema"});case"tac-newsarticle":return n({pageType:"tac-Article"});case"tvseries":case"tvepisode":return n({pageType:"fiche-programme"});case"videogallery":case"videoobject":case"videoobjectvch":return n({pageType:"Video"});case"imagegallerydiapo":return n({pageType:"Diaporamas"});case"videogalleryvch":case"event":return n({pageType:"Liste"});case"recipe":return n({pageType:"Fiche-Recette"});default:return n({})}}}consreadyState,Nr=new Promise((e=>{Mr()?e():document.addEventListener("DOMConte(()=>{e()}),{capture:!0,once:!0,passive:!0})})),qr=Nr;Object.defineProperty(Nr,"hasLot:()=>Mr()}),r(6015);class Br{constructor(){return this.adsCoreLogger=E.child({childName:"Datadog"}),Br.exists||(Br.exists=this),this.configuration={clientToken:"pubcfb9e2f49f1e0332a12956acd5ed4d3a",site:"datadoghq.eu",forwardErrorsToLogs:!1,env:"production",service:"core-ads",sessionSampleRate:100},Br.exists}init(){var e,t=pn.plugins;null!=t&&null!==(e=t.monitoring)&&void 0!==e&&e.activate&&(this.configuration.sessionSampleRate=t.monitoring.sampling,window.DD_LOGS.init(this.configuration))}sendLog(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=pn.plugins;if(null!=i&&null!==(r=i.monitoring)&&void 0!==r&&r.activate){var a="coreads_"+e;(null===(n=i.monitoring)||void 0===n||null===(n=n.logLevel)||void 0===n?void 0:n.toLowerCase())===t&&(window.DD_LOGS.logger.log(a,o,t),this.adsCoreLogger[t](a,o))}}}const Ur=new Br;var Fr=function(){var e=t(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qr;case 2:if(t=an.getPageInfos(),r=E.child({childName:"Targeting"}),t&&window.googletag){e.next=7;break}return Ur.sendLog("targeting_error_stopped","error","Failed to execute page targeting"),e.abrupt("return",r.error("Failed to execute page targeting"));case 7:n=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e.split(".[t]?e[t]:r),t)},googletag.cmd.push((()=>{var e=googletag.pubads(),o={t:N(),env:n("env"),urlprisma:n("prismaUrl"),adunitpath:n("displayAdUnitPath"),currentdevice:n("device"),keywords:n("keywords"),referrer:n("referrer"),pageType:n("pageType"),pageCategory:n("pageCategory"),pageSubCategory:n("pageSubCategory"),hasVideo:t.hasVideos?"true":"false",pageHitID:n("pageHitId"),testdfp:n("query.testdfp"),utm_campaign:n("query.utm_campaign"),utm_medium:n("query.utm_medium"),utm_source:n("query.utm_source"),mics_segments:n("mics_segments"),abvariant:n("query.abvariant")||n("abvariant")};for(var i in r.info({obj:o},"starting page targeting :"),o){var a=o[i];null!==a&&e.setTargeting(i,a)}r.info("page targeting done.")}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();const zr=Fr;var Vr=function(e,t){if($r(e[0])){for(var r=e[0].split("."),n=r.pop(),o=e.slice(1),i=t,a=0;a<r.length;a++){if(void 0===i[r[a]])return;i=i[r[a]]}try{i[n].apply(i,o)}catchh-1]]=t,r},Hr=function(e){return"array"=="===Kr(e)},Jr=function e(t,r){for(var n in t)if(Qr(t,n)){var o=t[n];Hr(o)?(Hr(r[n])||(r[n]=[]),e(o,r[n])):Xr(o)?(Xr(r[n])||(r[n]={}),e(o,r[n])):r[n]=o}},Wr=/\[object (Boolean|Number|String|Function|Array|Date|Reg:"oect(e),t)},Xr=function(e){if(!e||"object"!==Kr(e)||e.nodeType||e===e.window)return!1;try{if(e.constructor&&!Qr(e,"constructor")&&!Qr(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var t;for(t in e);return void 0===t||Qr(e,t)},Yr=function(e,t,r){var n;this.dataLayer_=e,this.listener_=t||function(){},this.executingListener_=!1,this.model_={},this.unprocessed_=[],this.abstractModelInterface_=(nn.mo n.get(e)}}),this.processStates_(e,!r);var o=e.push,i=this;e.push=function(){var t=[].slice.call(arguments,0),r=o.apply(e,t);return i.processStates_(t),r}};Yr.prototype.get=function(e){for(var t=this.model_,r=e.split("."),n=0;n<r.length;n++){if(void 0===t[r[n]])return;t=t[r[n]]}return t},Yr.prototyayer_[0])},Yr.prototype.processStates_=function(e,t){for(this.unprocessed_.push.apply(this.unprocessed_,e);!1===this.executingListener_&&this.unprocessed_.length>0;){var r=this.unprocessed_.shift();if(Hr(r))Vr(r,this.model_);else if("function"==typeof r)try{r.call(this.abstractModelInterface_)}catch(e){}else{if(!Xr(r))continue;for(var n in r)Jr(Gr(n,r[n]),this.model_)}t||(this.executingListener_=!0,this.listener_(this.model_,r),this.executingListener_=!1)}};const Zr=Yr;function en(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function tn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?en(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):en(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function rn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return nn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var on=new class{constructor(){this.logger=E.child({childName:"PageInfosController"}),this.namespace="pageInfos-controller",this.defaultEnv="production",tdefaultEnv,this.routes=null}init(e){var r=this;return t(i().mark((function n(){var o,a,s;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.appName,a=e.getEnv,s=e.routes,r.getEnv=a,r.routes=s,r.appName=o,n.next=6,r.createPageInfos();case 6:new Zr(window.dataLayer,function(){var e=t(i().mark((function e(t,n){var o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.logger.info({obj:n},"datalayer update"),o=["hasVideos","keywords","pageHitID","pageType","pageCategory","pageSubCategory","abvariant"].map((e=>e.toLowerCase())),!Object.keywerCase())))){e.next=6;break}return e.next=6,r.refreshPageInfos();case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());case 7:case"end":return n.stop()}}),n)})))()}getPageInfos(){return fr.repository.read()}createPageInfos(){var e=this;return t(i().mark((function t(){var r,n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.buildPageInfos();case 2:return r=t.sent,n=fr.repository.create(r),e.logger.info({obj:n},"storing new pageInfos : ".concat(n.id)),fr.repository.readAll().map((e=>e.id=>e!==n.id)).forEach((t=>{e.logger.info("deleting old pageInfos: ".concat(t)),fr.repository.delete(t)})),t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})))()}refreshPageInfos(){var e=this;return t(i().mark((function t(){var r,n,o,a,s,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.logger.info("Refreshing pageInfos..."),r=e.getPageInfos(),n=r.id,o=r.networkId,a=r.appName,s=r.brandName,n){t.next=4;break}return t.abrupt("return",null);case 4:return t.next=6,e.createPageInfos();case 6:return c=t.sent,fr.repository.update(c.id,{networkId:o,appName:a,brandName:s}),o&&e.setAdUnitInfos(),t.next=11,zr();case 11:case"end":return t.stop()}}),t)})))()}buildPageInfos(){var e=this;return t(i().mark((function t(){var r,n,o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._readBrowser();case 2:return r=t.sent,n=e._readDataLayer(window.dataLayer),o=e.getEnv({subDomain:r.subDomain,host:r.host,pathname:r.pathname,defineCurrentEnvironment:e.defaultEnv}),(a={env:e._formatEnv(n.env||o),device:r.device,appName:e.appName,brandName:null,networkId:null,url:r.url,prismaUrl:n.path||n.url||r.pathname,domainName:n.domainName||r.domainName,domain:n.domain||r.domain,subDomain:n.subDomain||r.subDomain,query:r.query,hash:r.hash,referrer:r.referrer,pageType:n.pageType,pageCategory:n.pageCategory,pageSubCategory:n.pageSubCategory,pageName:n.pageName,keywords:n.keywords,pageHitId:n.pageHitId,displayAdUnitPath:null,videoAdUnitPath:null,hasVideos:n.hasVideos,contentObjectId:n.contentObjectId,nonStickyLineItems:n.nonStickyLineItems,abvariant:n.abvariant,gs_cat:null,pm_contextual:null,mics_segments:e._getMicsSegments()}).trigram=(n.trigram||e._getBrandTrigram(a)).toLowerCase(),t.abrupt("return",fr.build(a));case 8:case"end":return t.stop()}}),t)})))()}setBrandInfos(e){var t=e.brandName,r=e.networkId,n=this.getPageInfos().id;fr.repository.update(n,{brandName:t,networkId:r}),this.logger.info({obj:{brandName:t,networkId:r}},"updating with: ")}setAdUnitInfos(){var e=this.getPageInfos(),t=e.id,r=e.pageType,n=e.pageCategory,o=e.pageSubCategory,i=e.brandName,a=e.networkId,s=Lr.build({networkId:a,pageType:r,pageCategory:n,pageSubCategory:o,brandName:i});fr.repository.update(t,{pageType:s.pageType,pageCategory:s.pageCategory,pageSubCategory:s.pageSubCategory,displayAdUnitPath:s.display,videoAdUnitPath:s.video}),this.logger.info({obj:{pageType:s.pageType,pageCategory:s.pageCategory,pageSubCategory:s.pageSubCategory,displayAdUnitPath:s.display,videoAdUnitPath:s.video}},"updating with: ")}setGrapeShotInfos(e){var t=this.getPageInfos();fr.repository.update(t.id,{gs_cat:e}),this.logger.info({obj:{gs_cat:e}},"updating with: ")}setContextualDatas(e){var t=this.getPageInfos();fr.repository.update(t.id,{pm_contextual:e}),this.logger.info({obj:{pm_contextual:e}},"updating with: ")}_readBrowser(){return t(i().mark((function e(){var t,r,n,o,a,s,u,l,d,f,p,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location.host.split("."),r=new Ir,e.next=4,r.init();case 4:n=e.sent,o=location.hash.substring(1).split("&"),a={},s=rn(o);try{for(s.s();!(u=s.n()).done;)l=u.value,d=l.split("="),f=z(d,2),p=f[0],h=f[1],a[p]=h}catch(e){s.e(e)}finally{s.f()}return e.abrupt("return",{host:t,pathname:window.location.pathname,url:window.location.href,domainName:t[t.length-2],domain:"".concat(t[t.length-2],".").concat(t[t.length-1]),subDomain:"www"===t[0]?"":t[0],device:n,referrer:document.referrer.split("/")[2],query:c.parse(window.location.search),hash:a});case 10:case"end":return e.stop()}}),e)})))()}_getMicsSegments(){var e=localStorage.getItem("mics_segments");return e&&(e=JSON.parse(e)).segments&&0!==e.segments.length?e.segments.map((e=>e.name)):null}_checkDataLayerValues(e,t,r,n,o){return"object"!=typeof e||Array.isArray(e)||null===e||Object.keys(e).forEach((o=>{void 0!==t[o]&&this._checkDataLayerValues(e[o],t[o],r,o,n)})),void 0!==n&&void 0!==t&&"object"!=typeof e&&(null==e?void 0:e.constructor)!==t&&r.push("".concat(n.toUpperCase()," must be of type ").concat(t.name," in ").concat(o,", received as ").concat(null==e?void 0:e.constructor.name,".")),t===String&&""===e&&r.push("".concat(n.toUpperCase()," value is not correct, it must not be empty or none.")),"env"===n&&(["development","production","staging"].includes(e)||r.push("".concat(n.toUpperCase()," value is not correct, it must be production, staging or development."))),Array.isArray(e)&&"keywords"===n&&(e.every((e=>e.constructor===String))||r.push("".concat(n.toUpperCase()," must be an Array of String in PAGE object"))),r}_checkDataLayerKeys(e,t,r,n){var o=["pageHitID","isPrisma","contentObjectId","subDomain","keywords","title","author","abvariant"],i=Object.keys(t),a=Object.keys(e);return i.forEach((i=>{var((e=>e===i)),c=o.includes(i);if(!s||null!==e[i]&&void 0!==e[i])if(s||c)"object"!=typeof e[i]||Array.isArray(e[i])||null===e[i]||null===e[i]||this._checkDataLayerKeys(e[i],t[i],r,i);else{var u="".concat(i.toUpperCase()," key is missing");"object"==typeof t[i]&&void 0===n&&(u="".concat(i.toUpperCase()," primary key is missing")),void 0!==n&&(u+=" in ".concat(n)),r.push(u)}else r.push("".concat(i.toUpperCase()," cannot be null"))})),r}validateDataLayer(e){var t={env:String,pageHitID:String,brand:{name:String,abbr:String,domain:String,subDomain:String,isPrisma:Boolean},page:{path:String,contentObjectId:String,pageType:String,pageCategory:String,title:String,author:String,keywords:Array}},r="https://tra.scds.pmdstatic.net/advertising-core/4/docs/#/users/integration/guide?id=datalayer";if(void 0===e.advertisement)return this.logger.error("DataLayer Advertisement object is missing"),this.logger.error("DataLayer Documentation : ".concat(r)),!1;var n=[];this._checkDataLayerKeys(e.advertisement,t,n),this._checkDataLayerValues(e.advertisement,t,n);var o=Boolean(n.length>0);return o?(this.logger.warn("DataLayer Advertisement object is malformed or incomplete!"),this.logger.warn("DataLayer Documentation : ".concat(r)),n.forEach((e=>this.logger.warn("DataLayer validation error :  ".concat(e,"."))))):this.logger.info("DataLayer is compliant!"),!o}_readDataLayer(e){var tn({},e),t)),{});this.validateDataLayer(t);var r=function(e){var r,n,o,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(null===(r=t.advertisement)||void 0===r?void 0:r[e])||(null===(n=t.advertisement)||void 0===n||null===(n=n.page)||void 0===n?void 0:n[e])||(null===(o=t.advertisement)||void 0===o||null===(o=o.brand)||void 0===o?void 0:o[e])||(null===(i=t.page)||void 0===i?void 0:i[e])||t[e]||a},n=r("domain"),o=null;null!=n&&n.includes(".")&&(o=n.split(".")[0]);var i,a=r("hasVideos",!1);return"boolean"!=typeof a&&(console.warn("[CORE-ADS] : Please use boolean and place hasVideos in dataLayer.advertisement"),a=!!r("hasVideos",!1),"none"===r("hasVideos")&&(a=!1)),{env:r("env",!1)||r("env",this.defaultEnv)||r("environnement",this.defaultEnv),url:r("url")||r("urlprisma"),path:r("path"),domain:n,domainName:o||n,subDomain:r("subDomain"),trigram:r("abbr"),pageType:r("pageType"),pageCategory:r("pageCategory"),pageSubCategory:r("pageSubCategory"),pageName:r("pageName"),keywords:(i=r("keywords",[]),("string"==typeof i?i.split(",/]/gi,"_")))),pageHitId:r("pageHitID"),abvariant:r("abvariant"),hasVideos:a,contentObjectId:r("contentObjectId"),nonStickyLineItems:r("nonStickyLineItems",[])}}_formatEnv(e){var t={production:["production","prod"],recette:["recette","preprod","staging","dev","development","staging"]};return"test"===e?"test":t.production.includes(e)?"production":t.recette.includes(e)?"recette":this.defaultEnv}_getBrandTrigram(e){e.query;var t=e.subDomain,r=e.domainName;if(!this.routes)return null;for(var n=0,o=Object.keys(this.routes);n<o.length;n++){var i,a=o[n],s=this.routes[a],c=Object.keys(s.subDomain);if(null!==(i=s.domain)&&void 0!==i&&i.includes(r)&&c){var u,l=rn(c);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(s.subDomain[d].includes(t))return d}}catch(e){l.e(e)}finally{l.f()}return a}}return null}};const an=on;class sn{constructor(e){var t=e.src,r=e.global,n=e.location,o=void 0===n?"head":n;this.src=t,this.location=o,this.global=r,this.isLoaded=!1,this.logger=E.child({childName:"ScriptLoader"}),this.namespace="script-loader"}loadScript(){return new Promise(((e,t)=>{window[this.global]&&e(window[this.global]);var r=document.createElement("script");if(r.type="text/javascript",r.defer=!0,r.src=this.src,"body"===this.location)document.body.appendChild(r);else{var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(r,n)}r.addEventListener("load",(()=>{if(!window[this.global])return this.isLoaded=!0,window[this.global]=this.isLoaded,this.logger.info("".concat(this.global," script is loaded correctly.")),Ur.sendLog("".concat(this.namespace,"_script_loaded"),"info",{src:this.src}),e(r)})),r.addEventListener("error",(()=>(this.logger.warn("".concat(this.global," Initialisation Script failed")),Ur.sendLog("".concat(this.namespace,"_script_failed"),"error",{src:this.src}),t(new Error("".concat(this.src," failed to load."))))))}))}load(){var e=this;return new Promise(function(){var r=t(i().mark((function t(r,n){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isLoaded&&!window[e.global]){t.next=2;break}return t.abrupt("return",r(window[e.global]));case 2:return t.prev=2,t.next=5,e.loadScript();case 5:return t.abrupt("return",r(window[e.global]));case 8:t.prev=8,t.t0=t.catch(2),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e,t){return r.apply(this,arguments)}}())}}class cn{constructor(){this.childLogger=E.child({childName:"Templates"}),this.init()}init(){var e=an.getPageInfos(),t=e.env,r=e.query,n=void 0!==r.coreads_template?r.coreads_template:"2",o="recette"===t?"recette-":"",i="true"===new URLSearchParams(window.location.search).get("withenvlocal")?"http://advertising-templates.localhost:8080/main.js":"https://".concat(o,"tra.scds.pmdstatic.net/advertising-templates/").concat(n,"/main.js"),a=new sn({src:i,global:"templatesScript",location:"body"});try{a.load()}catch(e){this.childLogger.error("Could not load CoreAdsTemplate into the page")}}enableInImage(){window.coreAdsTemplate.qInImage()}))}enableFooter(e){window.coreAdsTemplate.qar.instance}}var un=new class{constructor(){this.defaultSelectors={display:"ads-core-placer",video:"ads-core-player",audio:"ads-core-audio"},this.addVideoSlotsFromNode=this.addVideoSlotsFromNode.bind(this),this.childLogger=E.child({childName:"SlotsController"})}createInitialSlots(){var e=this._buildSlotsFromDOM().filter((e=>jr.isInConfigion=t+1,e)))owerCase()));t&&this.callTemplateFooter(t.elementId),this.childLogger.info({obj:{slots:e}},"Initial slots found : "),jr.repository.createMany(e),jr.formatdate(e,t)}destroyAllSlots(){return jr.repository.deleteAll()}addVideoSlotsFromNode(e){if(!e.getAttribute("data-ads-core"))return null;var t=an.getPageInfos().device,r=jr.buildVideoSlotFromDOMSlot(e);return jr.exists(r)?jr.repository.read({elementId:r.elementId}):jr.isAllowedOnDevice(r,t)?jr.repository.create(r):null}addVideoSlotsFromNodes(e){return e.map(this.addVideoSlotsFromNode).filter((e=>e))}addDisplaySlotsFromNode(e){var t=an.getPageInfos().device,r=jr.buildDisplaySlotFromDOMSlot(e);return jr.exists(r)?null:jr.isAllowedOnDevice(r,t)?jr.repository.create(r):null}addDisplaySlotsFromNodes(e){var t=this.getSlots("display").length,r=e.map(this.addDisplaySlotsFromNode.bind(thislter((e=>e));return jr.formatPosition(),r.forEach((e=>{t++,this.updateSlot(e.id,{slotPosition:t})})),r.map((e=>jr.repository.read({elementId:e.elementId})))}registerDisplayRender(e){var t=jr.repository.read({elementId:e});return t?jr.registerRender(t):null}registerVideoRender(e){var t=jr.repository.read({videoId:e});return t?jr.registerRender(t):null}getElementsFromSlots(e){reteleshable))}getRefreshCount(e){var t=jr.repository.read({elementId:e});return t&&t.renderCount>0?t.renderCounadAll(e)}getPostitiel(){return this.getSlots("displMData.type))}mapSlotsWithDOMSlots(e,t){var r=[];return e.forEach((e=>{var n=t.find((t=>t.elementId===e));void 0!==n&&jr.repository.read({elementId:n.elementId})&&r.push(n)})),r}incrementRebound(e){var t=jr.repository.read({elementId:e});jr.repository.update(t.id,{reboundCount:t.reboundCount+1})}callTemplateFooter(e){return t(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:cn.getInstance().enableFooter(e);case 2:case"end":return t.stop()}}),t)})))()}_buildSlotsFromDOM(){var e=[...document.getElementsByClassName(this.defaultSelectors.display)],t=[...document.getElementsByClassName(this.defaultSelectors.video)],r=[...document.getElementsByClassName(this.defaultSelectors.audio)],n=an.getPageInfos().device;return[...e.map(jr.buildDisplaySlotFromDOMSloevice(e,n))),...t.map(jr.buildVideoSlotFromDOMSlot).filter((e=>{var t;return"leader"===(null===(t=e.DOMData)||void 0===t||null===(t=t.playerPosition)||void 0===t?void 0:t.toLowerCase())})),...r.map(jr.buildAudioSlotFromDOMSlot)]}getPrebidAdUnits(e){if(0!==e.length)return e.map((e=>jr.getConfigPrebid(e))).filter((e=>null!=e))}getGfigdfp(e)}getAmazonAdUnits(e){if(0!==e.length)retgAmazon(e)e=>null!=e))}};const ln=un,dn=new class{constructor(){this.logger=E.child({childName:"PageInfosController"}),this.namespace="pageInfos-controller"}init(){return kr.repository.create(kr.build({firstDisplaySasRequested:!1,videoAdsParametersGenerated:!1}))}update(e){var t=kr.repository.read().id;return kr.repository.ury.read()}};class fn{constructor(){return fn.brandConfiguration||(fn.brandConfiguration=this),this.logger=E.child({childName:"BrandConfiguration"}),this.isReady=!1,fn.brandConfiguration}init(){var e=this;return t(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.fetchJSONConfiguration();case 3:r=t.sent,t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),new Error("Cannot fetch the configuration file",t.t0);case 9:e.mapConfig(r),e.isReady=!0,e.logger.info({obj:e},"Brand Configuration fetched: ");case 12:case"end":return t.stop()}}),t,null,[[0,6]])})))()}mapConfig(e){var t=an.getPageInfos().device;this.domain={name:e.domain_name,abbr:e.domain_abbr,consent:e.domain_consent},this.minDisplaySasRenderedBeforePlayerSetup=e.minDisplaySasRenderedBeforePlayerSetup,this.delayBeforePlayerAdsSetupInMs=e.delayBeforePlayerAdsSetupInMs,this.networkId=e.network_id,this.plugins=e.plugins,this.partners=e.partners,this.timeout=e.timeout,this.refreshTimer=e.refreshTimer,this.dontRefreshSlot=e.dontrefreshslot,this.bidCpmAdjustment=e.bidCpmAdjustment,this.ampScripts=e.ampScripts,this.slots=e[t].emplacements,this.refreshStarted=!1,this.parallaxStarted=!1,this.secondaryBidders=e.secondaryBidders,this.delayed_loading=e.delayed_loading}fetchJSONConfiguration(){return t(i().mark((function e(){var t,r,n,o,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=an.getPageInfos(),r=t.trigram,n=t.query,o=t.env,a="production"===o?"https://coreads.pmdstatic.net":"https://rec-coreads.pmdstatic.net",s=void 0!==(null==n?void 0:n.coreadsVersion)?"-".concat(n.coreadsVersion):"",c="".concat(r).concat(s,".json"),e.prev=4,e.next=7,L("".concat(a,"/").concat(c));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),new Error("Cannot fetch the configuration file for the current brand");case 13:case"end":return e.stop()}}),e,null,[[4,10]])})))()}}const pn=new fn;var hn=null;class vn{constructor(){if(this.childLogger=E.child({childName:"Event"}),this.prefix="core-ads",hn)return hn;hn=this}n||new vn}dispatch(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r="".concat(this.prefix,":").concat(e),n=new CustomEvent(r,{bubbles:!0,detail:t});return this.childLogger.info({obj:t},"".concat(r," triggered")),document.dispatchEvent(n)}}const gn=Object.freeze(new vn);class mn{static isPremiumUser(e){var t="www"!==e?"".concat(e,"-"):"",r=mn._getCookieByName("activeSmokeTest"),n=mn._getCookieByName("".concat(t,"pmc-premium")),o=mn._getCookieByName("".concat(t,"sourcepoint-paid-worflow"));return!!(r&&"1"!==r||n&&Number(n)||o&&Number(o))}static getFirstID(){var e=mn._getCookieByName("firstid")||mn._getCookieByName("firstId");return"NO_TRACKING"===e?null:e}stae(e):null}static sendDeprecationLabelFromAPI(){"cookieDeprecationLabel"in navigator&&navigator.cookieDeprecationLabel.getValue().then((e=>{e&&(E.info("Navigator in ChromeThirdParty with label:",e),Ur.sendLog("CookieParser_info_sended","info",{chromeThirdParty:e}),googletagdParty",e))))}))}}D(mn,"_getCookieByName",(e=>{var t=("; "+document.cookie).split("; "+e+"=");return 2===t.length?t.pop().split(";").shift():null}));const yn=mn;r(75);var bn=[],wn=function(){for(var e,t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];if(void 0===n[1]||"navigationStart"===n[1]||0!==window.performance.getEntriesByName(n[1],"mark").length){E.info("Performance measure triggered on ".concat(n[0]));var i=null===(e=window)||void 0===e||null===(e=e.performance)||void 0===e?void 0:e.measure(...n),a=i.name,s=i.duration;null===(t=window)||void 0===t||null===(t=t.DD_RUM)||void 0===t||t.onReady((function(){var e;null===(e=window)||void 0===e||null===(e=e.DD_RUM)||void 0===e||e.addTiming(a,s)}))}},Sn=function(e){var t=e.split("_");if(t.includes("slotRenderStart")){var r,n,o=t[2];if(bn.includes(o))E.info("Performance mark triggered on coreAds_refresh_slotRenderStart_".concat(o)),null===(r=window)||void 0===r||null===(r=r.performance)||void 0===r||r.mark("coreAds_refresh_slotRenderStart_".concat(o)),null===(n=window)||void 0===n||null===(n=n.DD_RUM)||void 0===n||n.addTiming("coreAds_refresh_slotRenderStart_".concat(o));else if(void 0===bn[o]){var i,a;bn.push(o),E.info("Performance mark triggered on ".concat(e)),null===(i=window)||void 0===i||null===(i=i.performance)||void 0===i||i.mark(e),null===(a=window)||void 0===a||null===(a=a.DD_RUM)||void 0===a||a.addTiming(e)}}else{var s,c;E.info("Performance mark triggered on ".concat(e)),null===(s=window)||void 0===s||null===(s=s.performance)||void 0===s||s.mark(e),null===(c=window)||void 0===c||null===(c=c.DD_RUM)||void 0===c||c.onReady((function(){var t;null===(t=window)||void 0===t||null===(t=t.DD_RUM)||void 0===t||t.addTiming(e)}))}},_n=function(e){var t;E.info("Performance clearMarks triggered on ".concat(e)),null===(t=window)||void 0===t||null===(t=t.performance)||void 0===t||t.clearMarks(e)},On="refresh",xn=(e,t,r)=>(e.forEach((e=>{var t=ln.getRefreshCount(e.elementId),n=googletag.pubads().getSlots().find((t=>t.getSlotElementId()===e.elementId));void 0!==n&&(n.setTargeting("prismarefresh",t),void 0!==r&&"object"==typeof r&&Object.keys(rng(e,r[e])))),E.info("Start refresh on slot:",e.elementId),Ur.sendLog("".concat(On,"_method_called"),"info",{slot:e.elementId})})),t(e,!0)),Pn=(e,t)=>{var r=setTimeout((()=>{var n,o,i,a,s,c=(n=document.getElementById(e.elementId),o=n=>{if(null!=n&&n.isIntersecting)return clearTimeout(r),null==c||c.disconnect(),xn([e],t)},a=(i={root:null,rootMargin:"0px",threshold:.8}).rootMargin,(s=new IntersectionObserver((e=>{var t=z(e,1)[0];o(t)}),{rootMargin:a,root:i.root,threshold:i.threshold})).observe(n),s)}),e.timeout!==pn.refreshTimer?e.timeout:pn.refreshTimer);ln.updateSlot(e.id,{refreshId:r})};const An=e=>{googletag.cmd.push((()=>{googletag.pubads().addEventListener("slotOnload",(e=>{return t=e.slot,r=an.getPageInfos().query,n=ln.getSlot(t.getSlotElementId()),o=pn.dontRefreshSlot,i=(()=>{var e=void 0!==window.advertisingConfig?window.advertisingConfig:[],t=pn.dontRefreshSlot;return 0!==(null==t?void 0:t.length)&&0!==(null==e?void 0:e.length)&&t.forEach((t=>{var r=e.find((e=>e.type===t));r&&0!==r.length&&(r.timeout=0)})),e})(),void(n&&n.isRefreshable&&!o.includes(n.name)&&(0!==i.length?i.forEach((e=>{n.elementId!==e.id&&n.name!==e.type||ln.updateSlot(n.id,{timeout:e.timeout})})):null!=r&&r.coreads_refreshtimer?ln.updateSlot(n.id,{timeout:r.coreads_refreshtimer}):void 0!==n.timeout&&n.timeout!==pn.refreshTimer?ln.updateSlot(n.id,{timeout:n.timeout}):ln.updateSlot(n.id,{timeout:pn.refreshTimer})));var t,r,n,o,i})),googletag.pubads().addEventListener("impressionViewable",(t=>((e,t)=>{var r=e.slot,n=ln.getSlot(r.getSlotElementId());if(n.isRefreshable)return 0!==n.timeout?(E.info("Slot ".concat(n.elementId," Viewable")),Ur.sendLog("".concat(On,"_method_slot-viewable_called"),"info",{slot:n.elementId}),void 0!==n.refreshId&&(clearTimeout(n.refreshId),ln.updateSlot(n.id,{refreshId:void 0})),Pn(n,t)):void 0})(t,e)))}))};var jn=["Pave-Haut","Pave-Haut2","Postitiel_V2"];function kn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Cn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}class En{constructor(e){var t=e.slots,r=e.partners,n=void 0===r?[]:r,o=e.optionalTargeting;this.slots=t,this.logger=E.child({childName:"PartnersDisplayManager"}),this.namespace="display-manager",this.optionalTargeting=o,googletag.cmd.push((()=>{googletag.enableServices()})),this.sendAdUnitsToBidManager=this.sendAdUnitsToBidManager.bind(this),this.partnersAdUnitsConftsConfig())),this.partners=n,this.counter=1,this.firstSasHasBeenLogged=!1,this.setupRefresh(),this.setupParallax()}requestAds(e){var r=this;return t(i().mark((function t(){var n,o,a,s,c,u,l,d,f,p,h,v;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.adUnitsRangeFilter,o=void 0===n?[0,1/0]:n,a=e.slots,s=void 0===a?void 0:a,c=e.init,u=void 0!==c&&c,l=z(o,2),d=l[0],f=l[1],(p=void 0!==s?s:ln.getSlots("display"))&&0!==p.length){t.next=5;break}return t.abrupt("return");case 5:return p=p.slice(d,f),r.logger.info({obj:{range:"[".concat([d,f],"]"),slotsToRequest:p}},"PartnersDisplayManager request: "),Ur.sendLog("".concat(r.namespace,"_display_requests_started"),"info",{slotsToRequest:p}),h=an.getPageInfos(),v=h.query,t.next=11,En.defineAdUnitsSlot({slots:p,queries:v,optionalTargeting:r.optionalTargeting});case 11:return t.next=13,r.sendAdUnitsToBidManager(p,!1,u);case 13:case"end":return t.stop()}}),t)})))()}bidManager(e){var t=e.partnersAdUnitsFetchDisplay,r=void 0===t?[]:t,n=e.slots,o=void 0===n?[]:n,i=(e.index,e.isRefreshed),a=[],s=an.getPageInfos().displayAdUnitPath;this.logger.info({obj:{slots:o}},"".concat(this.counter," - DFP Request Timeout Start")),Ur.sendLog("".concat(this.namespace,"_dfp_requests_started"),"info",{slots:o}),r.length>0&&r.forEach((e=>{a.push(e.fetchDisplay({adUnits:o,counter:this.counter,isRefreshed:i}))})),i||Sn("coreAds_sas".concat(this.counter,"_bidsRequestTimeout_Start"));var c=((e,t)=>{var r=new Promise(((t,r)=>{var n=setTimeout((()=>{clearTimeout(n),r(new Error("Timed out in ".concat(e," ms")))}),e)}));return Promise.race([t,r])})(pn.timeout.dfpRequest,Promise.all(a)),u=En.filterAdUnits(o).map((e=>{var t=window.googletag.pubads().getSlots();if("Postitiel_V2"===e.name){var r="".concat(s,"/").concat(e.name);retuPath()===r))}retu.elementId))}));return c.then((()=>{this.logger.info({obj:{defineSlot:u}},"".concat(this.counter," - Display Bids Requests Before Timeout End")),Ur.sendLog("".concat(this.namespace,"_display_bids_requests_started"),"info",{slots:o}),i||(wn("coreAds_sas".concat(this.counter,"_bidsRequestTimeout_success"),"coreAds_sas".concat(this.counter,"_bidsRequestTimeout_Start")),wn("coreAds_sas".concat(this.counter,"_bidsRequestTimeout_End"),"coreAds_sas".concat(this.counter,"_bidsRequestTimeout_Start")),this.counter++),En.sendAdServerRequestPromise(u,this.logger,o)})).catch((e=>{this.logger.warn({obj:e},"".concat(this.counter," - Display Bids Requests After Timeout End")),Ur.sendLog("".concat(this.namespace,"_warn_skipped"),"warn",{error:e}),i||(wn("coreAds_sas".concat(this.counter,"_bidsRequestTimeout_Error"),"coreAds_sas".concat(this.counter,"_bidsRequestTimeout_Start")),wn("coreAds_sas".concat(this.counter,"_bidsRequestTimeout_End"),"coreAds_sas".concat(this.counter,"_bidsRequestTimeout_Start"))),En.sendAdServerRequestPromise(u,this.logger,o)}))}sendAdUnitsToBidManager(e){var r=arguments,n=this;return t(i().mark((function o(){var a,s,c,u,l,d,f,p,h,v,g,m,y;return i().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:a=r.length>1&&void 0!==r[1]&&r[1],s=r.length>2&&void 0!==r[2]&&r[2],c=an.getPageInfos(),u=c.hasVideos,l=M(3,e),d=function(){var e=t(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((e=>{var t=setInterval((()=>{!0===dn.getState().videoAdsParametersGenerated&&(clearTimeout(r),e())}),100),r=sal(t),e()}),1e4)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=kn(l.entries()),o.prev=6,f.s();case 8:if((p=f.n()).done){o.next=23;break}return h=z(p.value,2),v=h[0],g=h[1],m=n.partnersAdUnitsConfigs.map((e=>({fetchDisplay:e.fetchDisplay}))),o.next=13,n.bidManager({partnersAdUnitsFetchDisplay:m,slots:g,index:v+1,isRefreshed:a});case 13:if(0!==v||!0!==s){o.next=18;break}if(dn.update({firstDisplaySasRequested:!0}),null===(y=pn.delayed_loading)||void 0===y||!y.enable){o.next=18;break}return o.next=18,neing.delay)));case 18:if(0!==v||!0!==s||void 0===u||!1===u){o.next=21;break}return o.next=21,d();case 21:o.next=8;break;case 23:o.next=28;break;case 25:o.prev=25,o.t0=o.catch(6),f.e(o.t0);case 28:return o.prev=28,f.f(),o.finish(28);case 31:case"end":return o.stop()}}),o,null,[[6,25,28,31]])})))()}setupRefresh(){var e=an.getPageInfos().query;(null!=e&&e.norefresh||0===(null==e?void 0:e.coreads_refreshtimer))&&(pn.refreshTimer=0),0===pn.refreshTimer||pn.refreshStarted||(An(this.sendAdUnitsToBidManager),pn.refreshStarted=!0)}setupParallax(){var e,t,r=an.getPageInfos(),n=r.device,o=r.query,i=null==o?void 0:o.abvariant;"mobile"!==n||!0!==pn.plugins.parallax||pn.parallaxStarted||"rrgeo_v2.1"===i||(e={}.hasDisabledParallaxes,t=void 0!==e&&e,googletag.cmd.push((()=>{googletag.pubads().addEventListener("slotRenderEnded",(e=>{if(!e.slot.getSlotElementId().includes("Postitiel")){var r,n=document.getElementById(e.slot.getSlotElementId());if(null!==e.size&&e.size[1]>=400){E.info({eventSize:e.size,slotId:e.slot.getSlotElementId()});var o=document.getElementById(n.children[0].id),i=(r=n.children[0].id.split("/"))[r.length-1].split("_")[0];!1!==t&&-1!==jn.indexOf(i)||(n.style="width:".concat(e.size[0],"px;height:310px;position:relative;overflow:hidden;margin: 0 auto;box-sizing: content-box;z-index:0;"),o.style="clip:rect(0px, auto, 310px, 0px);position:absolute;height:310px;width:100%",o.children[0].style="position:fixed;top: 9vh;transform: translate(-50%);left:50%;")}else""!==n.style&&(n.style="")}}))})),pn.parallaxStarted=!0)}static defineAdUnitsSlot(e){var t=e.slots,r=e.queries;return e.optionalTargeting,Promise.all(t.map((e=>new Promise((t=>{googletag.cmd.push((()=>{var n=((e,t)=>{var r,n=an.getPageInfos().displayAdUnitPath,o="".concat(n,"/").concat(e.name);if("Postitiel_V2"===e.name)r=googletag.defineOutOfPageSlot(o,googletag.enums.OutOfPageFormat.INTERSTITIAL).addService(googletag.pubads());else if(/(Out-Of-Banner|Postitiel|Out-Of-Banner2|Encart1|Encart2)/.test(e.name))r=googletag.defineOutOfPageSlot(o,e.elementId).addService(googletag.pubads());else{var i=ln.getGoogleAdunit(e);if(null===i)return console.warn({obj:e},"Slot is already defined"),null;var a=googletag.pubads().getSlolementId()));void 0===a&&(r=googletag.defineSlot(o,i.sizes,e.elementId).addService(googletag.pubads()))}r&&((e,t,r)=>{var n,o,i=an.getPageInfos(),a=i.contentObjectId,s=i.query,c=i.displayAdUnitPath,u="".concat(c,"/").concat(t.name),l=ln.getGoogleAdunit(t),d=l.advis,f=l.greenbidsPackage;if(e.setTargeting("position",t.name),e.setTargeting("slotCode",t.elementId),e.setTargeting("slotPosition",t.slotPosition),e.setTargeting("formatPosition",t.formatPosition),e.setTargeting("adunitDFP",u),e.setTargeting("ad_h",(new Date).getUTCHours()),e.setTargeting("prismarefresh","false"),a&&e.setTargeting("contentObjectID",a),r&&e.updateTargetingFromMap(r),d&&Object.keys(dg(t,d[t])})),f&&e.setTargeting("greenbidsPackage",f),s){var p=(n=s,o=[],["utm_source","utm_campaign","utm_medium"].forEach((e=>{n[e]&&o.push({key:e,value:n[e]})})),o);p.length>0&&y,t.value)))}})(r,e,t)})(e,r);t(n)}))})))))}static filterAdUnits(e){var t=["Banniere-Haute","Postitiel","Postitiel_V2"],r={};ret,index:t.type?1:-1)).forEach(((e,n,o)=>{0!==n&&e.type===o[n-1].type&&-1!==t.indexOf(e.type)&&(r[e.index]=!0)})),t)=>!r[t]))}static sendAdServerRequestPromise(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};googletag.cmd.push((()=>(t.info({obj:e},"Ads Request Send to server for slots :"),this.firstSasHasBeenLogged||(Ur.sendLog("".concat(this.namespace,"_display_requests_sas1_started"),"info",{slots:r.map((e=>e.name))}),Sn("coreAds_sas1_adRequestToServer"),this.firstSasHasBeenLogged=!0),gn.dispatch("display:request",{sllementId})))}),googletag.pubads().refresh(e))))}static filterPrebidAdunits(e){return e.configprebid[0].bids&&e.configprebid[0].bids.length>0}}function In(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Dn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?In(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):In(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class Tn{constructor(e){var t=e.videoSlot,r=e.reboundCount,n=e.partners;this.videoSlot=t,this.reboundCount=r,this.player={},this.logger=E.child({childName:"VideoManager"}),this.namespace="video-manager",this.partnersConfig=this.mapPartnersConfig(n),this.generateVastUrl=this.generateVastUrl.bind(this)}mapPartnersConfig(e){return Object.keunc:e[t]})))}sendPartnersRequests(e){var r=this;return t(i().mark((function t(){var n,o,a,s,c,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.videoSlot.DOMData,o=n.playerProvider,a=n.playerPosition,s={type:"Player-".concat(a),elementId:r.videoSlot.id},void 0!==r.reboundCount&&(s.reboundCount=r.reboundCount),(c=r.partnersConfig.map((t=>(0,t.func)({playerType:o||"Dailymotion",adUnit:r.videoSlot,reboundCount:r.reboundCount,custParams:e,vastUrl:void 0})))).length){t.next=6;break}return t.abrupt("return",e);case 6:return gn.dispatch("video:request:start",s),t.next=9,Promise.all(c);case 9:return u=t.sent,gn.dispatch("video:request:end",s),t.abrupt("return",u.filter((e=>void 0!==e)));case 12:case"end":return t.stop()}}),t)})))()}generateVastUrl(){var e=this;return t(i().mark((function t(){var r,n,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.logger.info({obj:e.videoSlot},"Initiating video ad requests: "),Ur.sendLog("".concat(e.namespace,"_video_requests_started"),"info",{obj:e.videoSlot}),t.next=4,e.generateCustParams();case 4:if(r=t.sent){t.next=9;break}return e.logger.error("Custom params failed: error in mapping"),Ur.sendLog("".concat(e.namespace,"_error_stopped"),"error","Custom params failed: error in mapping"),t.abrupt("return",null);case 9:if(void 0!==e.reboundCount&&0!==e.reboundCount||(Sn("coreAds_setPlayerAds"),Ur.sendLog("".concat(e.namespace,"_video_requests_1_started"),"info",{custParams:r})),n=Object.kenent(r[e]))).join("%26"),e.partnersConfig.length){t.next=13;break}return t.abrupt("return",n);case 13:return t.next=15,e.sendPartnersRequests(r);case 15:if(e.partnersResponses=t.sent,e.partnersResponses.length){t.next=18;break}return t.abrupt("return",n);case 18:return o=e.customizeVastUrl(n),e.partnersResponses.forEach((e=>{o+=null==e?void 0:e.queries})),t.abrupt("return",o);case 21:case"end":return t.stop()}}),t)})))()}customizeVastUrl(e){var t,r=this.videoSlot.DOMData.playerProvider,n=this.partnersResponses. 0:e.name)));if(-1!==n){if(t=this.partnersResponses[n].videoUrl,this.partnersResponses.splice(n,1),"dailymotion"===r.toLowerCase()){var o=t.split("&");t=o[8].split("=")[1]}return t}if(!t&&"dailymotion"===r.toLowerCase())return e}getVideoInfo(e){var t=ln.getGoogleAdunit(this.videoSlot),r=t.advis,n=t.greenbidsPackage,o=t.pmcompletion,i=ln.getPrebidAdUnits([this.videoSlot]),a=this.videoSlot.DOMData,s=a.playerVideoId,c=a.playerId,u=a.isClickToAutoplay,l=a.playerPosition,d="leader"===l.toLowerCase(),f=d&&!u,p=f;return e.position="Player-Video-".concat(l),e.vid_id=s,e.dm_player_id=c,e.vpmute=p?"1":"0",e.vpa=f?"auto":"click",u&&d&&(e.isclicktoplay="true"),n&&(e.greenbidsPackage=n),o&&(e.pmcompletion=o),r&&(e=Dn(Dn({},e),r)),i.length>0&&(e.plcmt=i[0].mediaTypes.video.plcmt),e}setReboundCount(e){var r=this;return t(i().mark((function t(){var n,o,a,s,c,u,l,d,f,p,h,v;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=r.videoSlot.DOMData.playerVideoId,void 0!==(null===(n=r.player)||void 0===n?void 0:n.player)||void 0===window.dailymotion){t.next=6;break}return c=document.getElementById(r.videoSlot.elementId),t.next=5,window.dailymotion.getPlayer(c.firstChild.id);case 5:r.player.player=t.sent;case 6:if(null===(o=r.player)||void 0===o||!o.player){t.next=16;break}return t.next=9,null===(u=r.player)||void 0===u||null===(u=u.player)||void 0===u?void 0:u.getState();case 9:l=t.sent,d=l.playerNextVideo,f=l.playerIsMuted,p=null!==d?d:s,h=f,e.dm_player_id=p,e.vpmute=h?"1":"0";case 16:(v=(null===(a=r.player)||void 0===a?void 0:a.reboundCount)||r.reboundCount)>0&&(e.rebond=v);case 18:case"end":return t.stop()}}),t)})))()}getPageInfo(e){var t,r,n,o,i=an.getPageInfos();e.env=i.env,e.pageCategory=i.pageCategory,e.pageSubCategory=i.pageSubCategory,e.pageType=i.pageType,e.currentDevice=null===(t=i.device)||void 0===t?void 0:t.replace(/\t/g,""),i.pageHitId&&(e.pageHitID=i.pageHitId),i.abvariant&&(e.abvariant=i.abvariant),["testdfp","utm_medium","utm_campaign","utm_source","abvariant"].forEach((t=>{t in i.query&&(e[t]=i.query[t])}));for(var a=Dn(Dn({keywords:null===(r=i.keywords)||void 0===r?void 0:r.join()},i.gs_cat?{gs_cat:null===(n=i.gs_cat)||void 0===n?void 0:n.join()}:{}),i.pm_contextual?{pm_contextual:null===(o=i.pm_contextual)||void 0===o?void 0:o.join()}:{}),s=0,c=Object.entries(a);s<c.length;s++){var u=z(c[s],2),l=u[0],d=u[1];l&&(e[l]=encodeURI(d))}return e}generateCustParams(){var e=this;return t(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.videoSlot){t.next=2;break}return t.abrupt("return",void 0);case 2:if(r={t:N(),urlprisma:window.location.pathname,ppid:yn.getFirstID()},r=e.getPageInfo(r)||r,r=e.getVideoInfo(r)||r,void 0===e.reboundCount||0===e.reboundCount){t.next=10;break}return t.next=8,e.setReboundCount(r);case 8:t.next=11;break;case 10:0===e.reboundCount&&(r.rebond=e.reboundCount);case 11:return e.logger.info({obj:r},"Generated cust params : "),t.abrupt("return",r);case 13:case"end":return t.stop()}}),t)})))()}}function Rn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ln(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class Mn{constructor(e){var t=e.selector;this._selector=t instanceof HTMLCollection?t[0]:t,this._childLogger=E.child({childName:"Player Podcast"})}createPlayerPodcast(){var e=this;return t(i().mark((function t(){var r,n,o,a,s,c,u,l,d,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e._selector,n=JSON.parse(r.dataset.adsCore),o=n.playerStart,a=n.audioFeed,s=n.playerPlaylist,c=n.isSticky,a){t.next=4;break}throw new Error("[Player Podcast] Missing required audioFeed parameters");case 4:return u=an.getPageInfos(),l=u.pageHitId,window.player=Ln(Ln(Ln({hitId:l,container:"#".concat(r.id),feed:a},o&&{start:o}),void 0!==s&&{playlist:s}),void 0!==c&&{isStickyAllowed:!!c}),d=e._getPlayerScriptUrls(),e._childLogger.info({obj:d},"Audio player script urls"),f=new sn({src:d.js,global:"playerPodcast"}),t.prev=9,t.next=12,f.load();case 12:e._addCssLinkTag(),t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(9),new Error("[Player Podcast] Error while importing the player podcast scripts");case 18:case"end":return t.stop()}}),t,null,[[9,15]])})))()}_addCssLinkTag(){var e=document.getElementsByTagName("head")[0],t=this._getPlayerScriptUrls();if(e){var r=document.createElement("link");r.href=t.css,r.type="text/css",r.rel="stylesheet",e.append(r)}}_getPlayerScriptUrls(){var e=an.getPageInfos(),t=e.query,r={js:"https://tra.scds.pmdstatic.net/player-audio/1/lib/build/main.js",css:"https://tra.scds.pmdstatic.net/player-audio/1/lib/build/main.css"};if("production"!==e.env){var n=t["scds[assetVersion][player-audio]"]||1;r.js="https://rec2-tra.scds.pmdstatic.net/player-audio/".concat(n,"/lib/build/main.js"),r.css="https://rec2-tra.scds.pmdstatic.net/player-audio/".concat(n,"/lib/build/main.css")}return r}}function Nn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class Bn{constructor(e){var t=e.DisplayManager,r=e.partners,n=e.options,o=void 0===n?{}:n,i=e.selectors,a=void 0===i?{}:i,s=a.displaySelector,c=a.audioSelector;this.displaySelector=s||document.getElementsByClassName("ads-core-placer"),this.audioSelector=c||document.getElementsByClassName("ads-core-audio"),this.DisplayManager=t||En,this.partners=r,this.options=o,this.logger=E.child({childName:"InitManager"}),this.namespace="init-manager",this.isInit=!1,this.isPremiumUser=!1,this.renderSlot=this.renderSlot.bind(this)}init(){var e=this;return t(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isInit){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,mr.init();case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(2),e.logger.error("Advis info not fetched"),Ur.sendLog("".concat(e.namespace,"_script_failed"),"error","advis not fetched");case 11:e.enableInImage(),e.isInit=!0;case 13:case"end":return t.stop()}}),t,null,[[2,7]])})))()}setupAds(){var e=this;return t(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isInit){t.next=2;break}throw new Error(Bn.__INIT_ERROR__);case 2:if(r=ln.getSlots("display"),Ur.sendLog("".concat(e.namespace,"_method_init_ads_called"),"info",{displaySlots:r}),e.numberBaseAds=null==r?void 0:r.length,0===(null==r?void 0:r.length)){t.next=8;break}return t.next=8,e.setupDisplayAds();case 8:if(0===e.audioSelector.length){t.next=11;break}return t.next=11,e.setupAudioAds();case 11:case"end":return t.stop()}}),t)})))()}setupDisplayAds(e,r){var n=this;return t(i().mark((function t(){var o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.isInit){t.next=2;break}throw new Error(Bn.__INIT_ERROR__);case 2:if(e||null!==(o=n.displaySelector)&&void 0!==o&&o.length){t.next=4;break}return t.abrupt("return",null);case 4:if(n.DisplayManager){t.next=6;break}return t.abrupt("return",null);case 6:if(!n.isPremiumUser){t.next=8;break}return t.abrupt("return",null);case 8:return t.next=10,n._createDisplayManager(e,r);case 10:return n.displayAdManager=t.sent,googletag.cmd.push((()=>{googletag.pubads().addEventListener("slotRenderEnded",n.renderSlot)})),t.next=14,n.displayAdManager.requestAds({slots:e,init:!0});case 14:case"end":return t.stop()}}),t)})))()}getVideoSlotParameters(e){var r=this;return t(i().mark((function n(){var o,a,s,c,u,l,d,f,p,h,v;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.htmlPlacer,a=e.reboundCount,r.isInit){n.next=3;break}throw new Error(Bn.__INIT_ERROR__);case 3:if(s=function(){var e=t(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((e=>{setInterval((()=>{!0===dn.getState().firstDisplaySasRequested&&e(!0)}),100)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),!(ln.getSlots("display").length>1)){n.next=11;break}return n.next=8,s();case 8:if(n.sent){n.next=11;break}return n.abrupt("return");case 11:return c=an.getPageInfos(),u=c.videoAdUnitPath,l=ln.addVideoSlotsFromNode(o),d=JSON.parse(o.dataset.adsCore),n.next=16,r._createVideoManager({videoSlot:l,reboundCount:a});case 16:return f=n.sent,n.next=19,f.generateVastUrl();case 19:return p=n.sent,h=yn.getFirstID(),p&&(v=p),v=v+"/"+encodeURIComponent("".concat(u,"-").concat(d.playerPosition)),h&&(v=v+"/"+encodeURIComponent(h)),r.logger.info({obj:{adParams:v}},"Returned Ad Video parameters :"),Ur.sendLog("".concat(r.namespace,"_video_succeeded"),"info",{adParams:v}),dn.update({videoAdsParametersGenerated:!0}),n.abrupt("return",v);case 28:case"end":return n.stop()}}),n)})))()}setupAudioAds(){var e=this;return t(i().mark((function t(){var r,n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isInit){t.next=2;break}throw new Error(Bn.__INIT_ERROR__);case 2:if(null!==(r=e.audioSelector)&&void 0!==r&&r.length){t.next=4;break}return t.abrupt("return",null);case 4:return t.prev=4,n=new Mn({selector:e.audioSelector}),t.next=8,n.createPlayerPodcast();case 8:t.next=14;break;case 10:t.prev=10,t.t0=t.catch(4),e.logger.error({obj:t.t0},"setupAudioAds failed"),Ur.sendLog("".concat(e.namespace,"_audio_player_creation_failed"),"error",{obj:t.t0});case 14:case"end":return t.stop()}}),t,null,[[4,10]])})))()}renderSlot(e){var r=this;return t(i().mark((function t(){var n,o,a,s,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.slot){t.next=3;break}return t.abrupt("return");case 3:(o=n.getSlotElementId()).includes("Postitiel_V2")&&(a=ln.getPostitiel(),o=a.elementId),ln.registerDisplayRender(o),s=ln.getSlot(o),r.logger.info({obj:s},"slot rendered : "),Ur.sendLog("".concat(r.namespace,"_display_slot_rendered"),"info",{updatedSlot:s}),c=s.renderCount>1?"display:refresh:render":"display:render",gn.dispatch(c,{type:s.name,refreshTimeout:s.timeout,elementId:s.elementId,renderCount:s.renderCount});case 11:case"end":return t.stop()}}),t)})))()}_createVideoManager(e){var r=this;return t(i().mark((function t(){var n,o,a,s,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.videoSlot,s=e.reboundCount,c=qn(qn({},void 0!==(null===(n=r.partners)||void 0===n?void 0:n.amazon)&&{amazon:r.partners.amazon.fetchVideo}),void 0!==(null===(o=r.partners)||void 0===o?void 0:o.prebid)&&{prebid:r.partners.prebid.requestVideoBids}),t.abrupt("return",new Tn({videoSlot:a,reboundCount:s,partners:c}));case 3:case"end":return t.stop()}}),t)})))()}_createDisplayManager(e,r){var n=this;return t(i().mark((function t(){var o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=void 0!==e?e:ln.getSlots("display"),a=["amazon","prebid"].map((e=>{if(void 0!==n.partners[e])return n.partners[e]})).filter((e=>void 0!==e)),t.abrupt("return",new n.DisplayManager({slots:o,optionalTargeting:r,partners:a}));case 3:case"end":return t.stop()}}),t)})))()}enableInImage(){var e,t,r=!1;if(null!==(e=pn.plugins)&&void 0!==e&&e.inImage.enable)r=!0;else if(void 0!==(null===(t=pn.plugins)||void 0===t||null===(t=t.inImage)||void 0===t?void 0:t.query)){var n,o=null===(n=pn.plugins)||void 0===n||null===(n=n.inImage)||void 0===n?void 0:n.query,i=an.getPageInfos().query;o.length>0&&Object.keys(i).forEach((e=>{var t=o.some((t=>i[e]===t[e]));t&&(r=!0)}))}r&&cn.getInstance().enableInImage()}}D(Bn,"__INIT_ERROR__","InitManager is not initialized, please call await initManager.init()");const Un=Bn,Fn=function e(t){if(null==t||"object"!=typeof t)return t;var r=new t.constructor;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=e(t[n]));return r};var zn=(e,==typeof e;if(r(e)&&r(t))return Object.keys(ti):e[n]=i})),e};function Vn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Hn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hn(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Jn=null;class Wn{constructor(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).resetSingleton;if(void 0!==e&&e&&(Jn=null),Jn)return Jn;this.childLogger=E.child({childName:"PrebidPartner"}),this.namespace="prebid",window.pmspbjs?this._prebidjs=window.pmspbjs:(E.error("Predib is not available"),Ur.sendLog("".concat(this.namespace,"_error_stopped"),"error","Prebid is not available")),this.fetchDisplay=this.fetchDisplay.bind(this),this.requestVideoBids=this.requestVideoBids.bind(this),Jn=this}init(e){var t,r,n,o,i,a,s,c=e.bidderTimeout,u=e.headerBiddingConsent,l=e.consentTimeout,d=e.urlHash,f=e.schain,p=e.initializationConfigOverride,h=void 0===p?{}:p,v=e.analyticsConfig,g=void 0===v?[]:v,m=q({urlHash:d}),y=(s=m)?btoa("1=".concat(s)):"",b=an.getPageInfos(),w=b.domain,S=b.hash,_=yn.getFirstID(),O=null==pn||null===(t=pn.partners)||void 0===t||null===(t=t.prebid)||void 0===t||null===(t=t.config)||void 0===t?void 0:t.instreamTracking,x=null==pn||null===(r=pn.partners)||void 0===r||null===(r=r.prebid)||void 0===r||null===(r=r.config)||void 0===r?void 0:r.userSync,P=null==pn||null===(n=pn.partners)||void 0===n||null===(n=n.prebid)||void 0===n||null===(n=n.config)||void 0===n?void 0:n.outbrain,A=null==pn||null===(o=pn.partners)||void 0===o||null===(o=o.prebid)||void 0===o||null===(o=o.config)||void 0===o?void 0:o.ozone,j=null==pn||null===(i=pn.partners)||void 0===i||null===(i=i.prebid)||void 0===i||null===(i=i.config)||void 0===i?void 0:i.targetingControls,k=yn.getEUID(),C=localStorage.getItem("userInformationShared");C=null===C||"true"===C;var E=null==x?void 0:x.userIds.find((e=>"publinkId"===e.name));E&&(E.params.e=m);var I=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.outbrain,n=t.ozone,o=t.targetingControls,i=t.userSync,a=t.base64Mail,s=t.sha256Mail,c=t.bidderTimeout,u=t.consentTimeout,l=t.headerBiddingConsent,d=t.domain,f=t.firstId,p=t.schain,h=t.secondaryBidders,v=t.realTimeData,g=t.persoAd,m=t.personalInformationShared,y=t.instreamTracking,b=t.euid;return Object.assign({},function(e){var t=e.outbrain,r=e.ozone,n=e.targetingControls,o=e.userSync,i=e.bidderTimeout,a=void 0===i?0:i,s=e.base64Mail,c=void 0===s?"":s,u=e.sha256Mail,l=e.domain,d=void 0===l?"":l,f=e.firstId,p=e.schain,h=e.secondaryBidders,v=void 0===h?[]:h,g=e.realTimeData,m=e.persoAd,y=e.personalInformationShared,b=void 0===y||y,w=e.instreamTracking,S=function(e){var t=e.userSync,r=e.base64Mail,n=e.sha256Mail,o=e.domain,i=e.firstId,a=e.personalInformationShared,s=e.euid,c={auctionDelay:50,aliasSyncEnabled:!0,userIds:[{name:"id5Id",params:{partner:964,pd:void 0===r?"":r,abTesting:{enabled:!0,controlGroupPct:.15}},storage:{type:"html5",name:"id5id",expires:7,refreshInSeconds:28800}},{name:"identityLink",params:{pid:"98"},storage:{type:"cookie",name:"idl_env",expires:7}},{name:"pubProvidedId",bidders:["criteo","nexx360","anPrisma","ix","smartadserver"],params:{eids:[...n&&"disabled"!==e.persoAd&&(void 0===a||a)?[{source:void 0===o?"":o,uids:[{id:n,atype:3,ext:{stype:"other"}},{id:n,atype:3,ext:{stype:"hemsha256"}}]}]:[],...i?[{source:"first-id.fr",uids:[...i?[{id:i,atype:1,ext:{stype:"ppuid",persistence:"http"}}]:[]]}]:[]]}},{name:"zeotapIdPlus"},{name:"sharedId",storage:{type:"cookie",name:"_sharedID",expires:365}},...s?[{name:"euid",params:{euidToken:s}}]:[]],filterSettings:{all:{bidders:"*",filter:"include"}}};return void 0===t?c:zn(c,t)}({userSync:o,base64Mail:c,sha256Mail:u,domain:d,firstId:f,persoAd:m,personalInformationShared:b,euid:e.euid}),_=function(e){var t,r,n={name:"SirdataRTDModule",waitForIt:!0,params:{partnerId:27882,key:24,setGptKeyValues:!0,contextualMinRelevancyScore:60,bidders:[{bidder:"proxistore"},{bidder:"smartadserver"},{bidder:"ix",sizeLimit:1200},{bidder:"rubicon"}]}};return void 0!==e?null===(r=t=e)||void 0===r||r.dataProviders.push(n):t={auctionDelay:1e3,dataProviders:[n]},t}(g);return Gn(Gn({},void 0!==w&&{instreamTracking:w}),{},{auctionOptions:{secondaryBidders:v},bidderTimeout:a,userSync:S,outbrain:t,ozone:r,targetingControls:n,schain:p,realTimeData:_})}({outbrain:r,ozone:n,targetingControls:o,userSync:i,bidderTimeout:c,base64Mail:a,sha256Mail:s,domain:d,firstId:f,schain:p,secondaryBidders:h,realTimeData:v,persoAd:g,personalInformationShared:m,instreamTracking:y,euid:b}),l&&{consentManagement:{consentTimeout:void 0===(e={consentTimeout:u}.consentTimeout)?0:e,cmpApi:"iab",defaultGdprScope:!0}})}({outbrain:P,ozone:A,targetingControls:j,userSync:x,base64Mail:y,sha256Mail:m,bidderTimeout:c,consentTimeout:l,headerBiddingConsent:u,domain:w,firstId:_,schain:f,secondaryBidders:pn.secondaryBidders,realTimeData:null===(a=pn.partners)||void 0===a||null===(a=a.prebid)||void 0===a?void 0:a.realTimeData,persoAd:S["perso-ad"],personalInformationShared:C,instreamTracking:O,euid:k}),D=$n($n({},I),Fn(h));this._prebidjs.que.push((()=>{this._prebidjs.setConfig(D),g.length>0&&this._prebidjs.enableAnalytics(g)}))}initBidders(e){var t=e.bidAdjustments,r=e.prebidjsConfigOverride,n=void 0===r?{}:r,o=e.bidderConfigOverride,i=void 0===o?{}:o,a=$n($n({},{enableSendAllBids:!0,useBidCache:!0,bidCacheFilt.mediaType,priceGranularity:{buckets:[{max:1,increment:.01},{max:3,increment:.02},{max:20,increment:.1},{max:100,increment:1}]},currency:{adServerCurrency:"USD",granularityMultiplier:1,conversionRateFile:"https://cdn.jsdelivr.net/gh/prebid/currency-file@1/latest.json"}}),Fn(n)),s=$n($n({},{bidders:["adot"],config:{adot:{publisherId:"PRISMA"}}}),Fn(i)),c=this.bidAdjusmentGettersByBidder(t);c.standard=c.standard||{},c.standard.storageAllowed=!0,this._prebidjs.que.push((()=>{this._prebidjs.setConfig(a),this.setBidderAlias(),this._prebidjs.bidderSettings=c,this._prebidjs.setBidderConfig(s)}))}setBidderAlias(){var e,t=null===(e=pn.partners)||void 0===e||null===(e=e.prebid)||void 0===e?void 0:e.aliasBidder;void 0!==t&&asedName)}))}fetchDisplay(e){var t=e.adUnits,r=e.counter,n=e.isRefreshed,o=an.getPageInfos().keywords,i=this.addAdUnitsToAuction(t,o,n);if(0!==i.length){var a=i.map((e=>e.code));return new Promise((e=>{this._prebidjs.que.push((()=>{n||Sn("coreAds_sas".concat(r,"_prebidBidRequest")),this.childLogger.info("Prebid Display Request Start"),Ur.sendLog("".concat(this.namespace,"_display_requests_started"),"info",{slots:t}),this._prebidjs.bidderSettings.nexx360={adserverTargeting:[{key:"nexx36andSource}}]},this._prebidjs.requestBids({adUnitCodes:a,labels:["ros"],bidsBackHandler:t=>{0===Object.keys(t).length?(this.childLogger.warn("No Bids Returned from Prebid display"),Ur.sendLog("".concat(this.namespace,"_warn_skipped"),"warn","No Bids Returned from Prebid display")):(this.childLogger.info({obj:t},"Prebid Display Bids Responses"),Ur.sendLog("".concat(this.namespace,"_display_bids_requests_started"),"info",{bids:t}),googletagTAsync(a)}))),this.childLogger.info("Prebid Display Request End"),e("headerbidding")}})}))}))}}getInfo(){var e=an.getPageInfos(),t={urlprisma:e.prismaUrl,adunitpath:e.displayAdUnitPath,pageType:e.pageType};this.sendInfoForPartner(t)}sendInfoForPartner(e){this._prebidjs.que.push((()=>{this._prebidjs.setBidderConfig({bidders:["nexx360"],config:{ortb2:{site:{ext:{data:e}}}}},!0)}))}requestVideoBids(e){var t=e.playerType,r=e.adUnit,n=e.custParams,o=an.getPageInfos(),i=o.keywords,a=o.videoAdUnitPath,s=o.pageType,c="dailymotion"===t.toLowerCase(),u=void 0!==n.rebond&&n.rebond>0,l=this.addAdUnitsToAuction([r],i,u);if(0!==l.length)return new Promise((e=>{this._prebidjs.que.push((()=>{r.reboundCount<1?Sn("coreAds_prebidVideoBidRequest"):Sn("coreAds_rebond".concat(r.reboundCount,"_prebidVideoBidRequest")),this.childLogger.info("Prebid Video Request Start"),Ur.sendLog("".concat(this.namespace,"_video_requests_started"),"info",{adUnit:r}),(c||void 0===n.rebond)&&this._prebidjs.setConfig({cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"}}),this._prebidjs.requestBids({adUnitCodes:[r.elementId],labels:[s],bidsBackHandler:t=>{0===Object.keys(t).length?(this.childLogger.warn("No Bids Returned from Prebid video"),Ur.sendLog("".concat(this.namespace,"_warn_skipped"),"warn","No Bids Returned from Prebid video")):(this.childLogger.info({obj:t},"Prebid Video Bids Responses"),Ur.sendLog("".concat(this.namespace,"_video_bids_requests_started"),"info",{bids:t}));var r=this._getDailymotionAdVideoUrl(l[0],a,n);this.childLogger.info("Prebid Video Request End"),e({name:"prebid",videoUrl:r})}})}))}))}_getDailymotionAdVideoUrl(e,t,r){return this._prebidjs.adServers.dfp.buildVideoUrl({adUnit:e,params:{iu:t,cust_params:r,output:"vast"}})}addAdUnitsToAuction(e,t,r){var n=ln.getPrebidAdUnits(e);return n&&0!==n.length?(this.childLogger.info({obj:n},"Prebid Adunits builded "),n.length>0&&!r&&this._prebidjs.que.push((()=>{this._prebidjs.addAdUnits(n),this.childLogger.info({obj:n},"Prebid Adunits added to auction ")})),n):[]}partnersAdUnitsConfig(){return{fetchDisplay:this.fetchDisplay}}bidAdjusmentGettersByBidder(e){return e?e.reduce(((e,t)=>{var r,n=(r=t.val,{bidCpment:e=>e*r});return e[t.bid]=n,e[t.bid].adserverTargeting=[{key:"hb_prio",val:function(e){var t,r=!1,n=null==pn||null===(t=pn.plugins)||void 0===t?void 0:t.prioHb;return"amazon"!==e.bidderCode&&n.enable&&n.seuil_prio_hb&&e.cpm>=n.seuil_prio_hb&&(r=e.cpm>=n.seuil_prio_hb),r}}],e})):{}.pubstack}init(){if(null!==this.configuration&&(window.Pubstack=window.Pubstack||this.initPubstack(window,"Pubstack",this.configuration),new sn({src:"https://boot.pbstck.com/v1/tag/".concat(this.configuration),global:"InitPubStack"}).load(),"cac"!==an.getPageInfos().trigram)){var e=new Wn;e._prebidjs.que.push((()=>{["auctionInit","auctionEnd","bidTimeout","bidRequested","bidResponse","bidWon","noBid"].forEach((function(t){e._prebidjs.bid",t,e)}))}))}))}}initPubstack(e,t,r){var n=e.pbstck=e.pbstck||{};n.sdk=n.sdk||{};var o=n.sdk[r]=n.sdk[r]||{};return o.g=t,o.q=o.q||[],e[t]={cmd:function(){var e=arguments;o.q.push(["cmd",e]),(o.p||[]"cmd",e])}))}},e[t]}}function Qn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class Yn{constructor(e){var t=e.pubId,r=e.headerBiddingFetch,n=e.consent,o=e.urlHash,i=e.hasSchain,a=void 0!==i&&i;this.childLogger=E.child({childName:"AmazonPartner"}),this.namespace="amazon",this.pubId=t,this.headerBiddingFetch=r,this.consent=n,this.hasSchain=a,this.urlHash=o,this.init=this.init.bind(this),this.loadPartner=this.loadPartner.bind(this),this.fetchDisplay=this.fetchDisplay.bind(this),this.fetchVideo=this.fetchVideo.bind(this),this.schainConfig=this.schainConfig.bind(this),this.tokenConfig=this.tokenConfig.bind(this),this.generateToken=this.generateToken.bind(thish([e,t])}init(){var e=this;return t(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.apstag){t.next=2;break}return t.abrupt("return");case 2:window.apstag={init:function(){Yn.q("i",arguments)},fetchBids:function(){Yn.q("f",arguments)},setDisplayBids:function(){},tar{return[]},dpa:function(){Yn.q("di",arguments)},rpa:function(){Yn.q("ri",argumrguments)},_Q:[]},r=Xn({pubID:e.pubId,adServer:"googletag",bidTimeout:e.headerBiddingFetch,videoAdServer:"DFP",deals:!0,gdpr:{cmpTimeout:e.consent}},e.hasSchain?{schain:e.schainConfig()}:{}),apstag.init(r);case 5:case"end":return t.stop()}}),t)})))()}loadPartner(){this.init(),new sn({src:"https://c.amazon-adsystem.com/aax2/apstag.js",global:"Amazon"}).load()}fetchVideo(e){var r=this;return t(i().mark((function t(){var n,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.adUnit,void 0!==(o=ln.getAmazonAdUnits([n]))&&0!==o.length){t.next=4;break}return t.abrupt("return");case 4:return t.abrupt("return",new Promise((e=>{r.childLogger.info({obj:o},"Amazon Video Request Start :"),Ur.sendLog("".concat(r.namespace,"_video_requests_started"),"info",{slots:o}),n.reboundCount<1?Sn("coreAds_amazonVideoBidRequest"):Sn("coreAds_rebond".concat(n.reboundCount,"_amazonVideoBidRequest")),apstag.fetchBids({slots:[{slotID:"videoSlot",mediaType:"video"}]},(t=>{r.childLogger.info({obj:t,group:"HBVideo"},"Amazon Video Bid Response :"),Ur.sendLog("".concat(r.namespace,"_video_bids_requests_started"),"info",{bids:t});var n="";void 0!==t&&t.length>=1&.mediaType)).forEach((e=>{n+=e.helpers.encodedQsParams()})),r.childLogger.info({obj:n},"Amazon Video Request End :"),e({name:"amazon",queries:n})}))})));case 5:case"end":return t.stop()}}),t)})))()}fetchDisplay(e){var t=e.adUnits,r=e.counter,n=e.isRefreshed,o=ln.getAmazonAdUnits(t);if(void 0!==o&&0!==o.length)return new Promise(((e,i)=>{if(n||Sn("coreAds_sas".concat(r,"_amazonBidRequest")),this.childLogger.info({obj:o},"Amazon Display Request Start :"),Ur.sendLog("".concat(this.namespace,"_display_requests_started"),"info",{slots:o}),!t||0===t.length)return e("no Amazon adunits");apstag.fetchBids({slots:o},(t=>{0===t.length?(this.childLogger.warn({obj:{group:"onDemand"}},"No Bids Returned from Amazon display"),Ur.sendLog("".concat(this.namespace,"_warn_skipped"),"warn","No Bids Returned from Amazon display")):(this.childLogger.info({obj:t},"Amazon Display Bids Responses"),Ur.sendLog("".concat(this.namespace,"_dislay_bids_requests_started"),"info",{slots:o}),googletaglayBids()}))),e("hDisplay}}schainConfig(){return{complete:1,ver:"1.0",nodes:[{asi:"https://ams.amazon.com/webpublisher/sellers_info",sid:"3279",hp:1}]}}tokenConfig(e){return{hashedRecords:[{type:"email",record:e}]}}generateToken(){var e=this.urlHash,t=q({urlHash:e});if(t)return this.childLogger.info({obj:this.tokenConfig(t)},"Amazon Publisher Audience with object"),apstag.rpa(this.tokenConfig(t))}}var Zn=function(){var e=t(i().mark((function e(){var t,r,n,o,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="gs_channels=",r=window.location.href,n="".concat("https://prismamedia.gscontxt.net/multizone/channels.cgi?url=").concat(r),e.prev=3,e.next=6,fetch(n);case 6:return o=e.sent,e.next=9,o.text();case 9:return a=e.sent,s=a.slice(t.length,a.length-1).replace(/;/,"").replace(/'/g,'"'),e.abrupt("return",JSON.parse(s));case 14:e.prev=14,e.t0=e.catch(3),E.warn("Cannot fetch grapeshot :",e.t0),Ur.sendLog("grapeshot_warn_skipped","warn","Cannot fetch grapeshot");case 18:case"end":return e.stop()}}),e,null,[[3,14]])}rguments)}}(),eo="https://key-value.prismamedia.com/nevrguments)}function ro(){return(ro=t(i().mark((function e(t){var r,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return r=t.substring(8),e.prev=3,n="".concat(eo).concat(r,".json"),e.next=7,L(n,1e3);case 7:return o=e.sent,E.info("Contextual data fetched : ",o),e.abrupt("return",o.id_seg);case 12:return e.prev=12,e.t0=e.catch(3),Ur.sendLog("pm-contextual_script_failed","error","pm-contexutal not fetched"),e.abrupt("return",E.warn("Cannot fetch pm_contextual file :",e.t0));case 16:case"end":return e.stop()}}),e,null,[[3,12]])})))).apply(this,arguments)}r(8232prepare()}prepare(){for(var e={},t=0,r=Object.getOwnPropertyNames(window).sort();t<r.length;t++)!function(t){"function"==typeof windrguments)}:Object.defineProperty(e,t,{get:function(){return window[t]===window?e:windr){e[t]=r}})}(r[t]);return e}}function oo(e){return function(){var r=t(i().mark((function t(r){var n,o,a,s,c,u,l=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:{},console.warn("[CORE-ADS] : onDemand is deprecated. Please use our new methods addDisplaySlot or addDisplaySlots."),console.warn("[CORE-ADS] : La documentation est disponible ici : https://tra.scds.pmdstatic.net/advertising-core/4/docs/#/publicMethods/publicMethods"),E.info("onDemand Start for slot(s) inside #".concat(r)),o=document.getElementById(r)){t.next=8;break}return E.error("onDemand Failed : Cannot find a container with the id : ".concat(r)),t.abrupt("return",null);case 8:if(0!==(a=Array.from(o.querySelectorAll(":scope .ads-core-placer"))).length){t.next=12;break}return E.error("onDemand Failed : Cannot retrieve the core-ads-placer div inside ".concat(r)),t.abrupt("return",null);case 12:if(0!==(s=ln.addDisplaySlotsFromNodes(a)).length){t.next=16;break}return E.warn("onDemand Skipped: no slots found available to initalize"),t.abrupt("return",null);case 16:return t.prev=16,c=e(),u=c.initManager,t.next=20,u.setupDisplayAds(s,n);case 20:E.info("onDemand successed: slots initialized"),t.next=27;break;case 23:throw t.prev=23,t.t0=t.catch(16),E.error({obj:t.t0},"onDemand stopped with error : "),t.t0;case 27:case"end":return t.stop()}}),t,null,[[16,23]])})));return function(e){return r.apply(this,arguments)}}()}var io="stopped with an error.",ao=E.child({childName:"[API] addDisplaySlot"}),so="API_addDisplaySlot";function co(e){return function(){var r=t(i().mark((function t(r){var n,o,a,s,c,u,l,d,f,p,h=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=h.length>1&&void 0!==h[1]?h[1]:{},r){t.next=6;break}return o={success:!1,errorMessage:"[addDisplaySlot] : Missing mandatory elementId parameter."},Ur.sendLog("".concat(so,"_error_stopped"),"error",{error:o}),ao.error({obj:o},io),t.abrupt("return",o);case 6:if(ao.info("called on id ".concat(r)),Ur.sendLog("".concat(so,"_method_called"),"info",{elementId:r}),a=document.getElementById(r)){t.next=14;break}return s={success:!1,errorMessage:"[addDisplaySlot] : Cannot find element with the id : ".concat(r,".")},Ur.sendLog("".concat(so,"_error_stopped"),"error",{error:s}),ao.error({obj:s},io),t.abrupt("return",s);case 14:if(c=e(),u=c.initManager,l=ln.addDisplaySlotsFromNode(a)){t.next=21;break}return d={success:!1,errorMessage:"[addDisplaySlot] : No Slots found to initialize."},ao.warn({obj:d},"skipped"),Ur.sendLog("".concat(so,"_error_stopped"),"error",{error:d}),t.abrupt("return",d);case 21:return t.prev=21,t.next=24,u.setupDisplayAds([l],n);case 24:return f={success:!0,successMessage:"[addDisplaySlot] : Has successfully completed its execution.",data:{slotCreated:r}},ao.info({obj:f},"has successfully completed its execution."),Ur.sendLog("".concat(so,"_method_succeeded"),"info",{success:f}),t.abrupt("return",f);case 30:return t.prev=30,t.t0=t.catch(21),p={success:!1,errorMessage:t.t0},ao.error({obj:p},io),Ur.sendLog("".concat(so,"_error_stopped"),"error",{errorMessage:p}),t.abrupt("return",p);case 36:case"end":return t.stop()}}),t,null,[[21,30]])})));return function(e){return r.apply(this,arguments)}}()}var uo="API_addDisplaySlots",lo=E.child({childName:"[API] addDisplaySlots"}),fo="stopped with an error :";function po(e){return function(){var r=t(i().mark((function t(r){var n,o,a,s,c,u,l,d,f,p,h=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=h.length>1&&void 0!==h[1]?h[1]:{},lo.info("called on ".concat(r)),Ur.sendLog("".concat(uo,"_method_called"),"info",{elementIds:r}),Array.isArray(r)&&0!==r.length){t.next=8;break}return o={success:!1,errorMessage:"[addDisplaySlots] : First parameter should be an array of element ids"},lo.error({obj:o},fo),Ur.sendLog("".concat(uo,"_error_stopped"),"error",{error:o}),t.abrupt("return",o);case 8:if(0!==(a=r.map((e=>document.getElementById(e)||(lo.warn('cannot find id "'.concat(e,'" in the page')),void Ur.sendLog("".concat(uo,"_warn_skipped"),"warn",{elementId:e}))void 0!==e))).length){t.next=14;break}return s={success:!1,errorMessage:"[addDisplaySlots] : No Slots found to initialize in page."},lo.error({obj:s},fo),Ur.sendLog("".concat(uo,"_error_stopped"),"error",{error:s}),t.abrupt("return",s);case 14:if(c=e(),u=c.initManager,0!==(l=ln.addDisplaySlotsFromNodes(a)).length){t.next=21;break}return d={success:!1,errorMessage:"[addDisplaySlots] : No Slots found to initialize."},lo.warn({obj:d},"skipped"),Ur.sendLog("".concat(uo,"_warn_skipped"),"warn",{error:d}),t.abrupt("return",d);case 21:return t.prev=21,t.next=24,u.setupDisplayAds(l,n);case 24:return f={success:!0,successMessage:"[addDisplaySlots] : Has successfully completed its execution.",data:{slotCreated:l.map((e=>e.elementId))}},lo.info({obj:f},"has successfully completed its execution."),Ur.sendLog("".concat(uo,"_method_succeeded"),"info",{success:f}),t.abrupt("return",f);case 30:return t.prev=30,t.t0=t.catch(21),p={success:!1,errorMessage:t.t0},lo.error({obj:p},fo),Ur.sendLog("".concat(uo,"_error_stopped"),"error",{errorMessage:p}),t.abrupt("return",p);case 36:case"end":return t.stop()}}),t,null,[[21,30]])})));return function(e){return r.apply(this,arguments)}}()}function ho(e){var r=E.child({childName:"API onInit"});return()=>new Promise((n=>{googletag.cmd.push(t(i().mark((function t(){var o,a,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e(),console.warn("[CORE-ADS] : onInit is deprecated. Please use our new method reset."),console.warn("[CORE-ADS] : La documentation est disponible ici : https://tra.scds.pmdstatic.net/advertising-core/4/docs/#/publicMethods/publicMethods"),r.info("removing existing slots"),googletag.destroySlots(),null===(o=pmspbjs)||void 0===o||null===(a=o.removeAdUnit)||void 0===a||a.call(o),ln.destroyAllSlots(),_n(),t.next=10,an.refreshPageInfos();case 10:return t.next=12,zr();case 12:return r.info("creating new slots"),ln.createInitialSlots(),s.initManager.displaySelector=document.getElementsByClassName("ads-core-placer"),t.prev=15,t.next=18,s.initManager.init();case 18:return t.next=20,s.initManager.setupDisplayAds();case 20:r.info("finish refreshing slots"),n(),t.next=28;break;case 24:throw t.prev=24,t.t0=t.catch(15),r.error({obj:t.t0},"stopped with error : "),t.t0;case 28:case"end":return t.stop()}}),t,null,[[15,24]])}))))}))}function vo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function go(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vo(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function mo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mo(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bo(e){var r=E.child({childName:"API getVideoAdParams"}),n="API_getVideoAdParams";return function(){var o=t(i().mark((function t(o){var a,s,c,u,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=o.htmlPlacerId,s=o.reboundCount,console.warn("[CORE-ADS] : getVideoAdParams is deprecated. Please use our new method getVideoSlotParameters."),console.warn("[CORE-ADS] : La documentation est disponible ici : https://tra.scds.pmdstatic.net/advertising-core/4/docs/#/publicMethods/publicMethods"),r.info("generating ad params for player : ".concat(a)),Ur.sendLog("".concat(n,"_method_called"),"info",{htmlPlacerId:a}),c=document.getElementById(a)){t.next=10;break}return r.error("stopped : Cannot find a div with the id : ".concat(a)),Ur.sendLog("".concat(n,"_error_stopped"),"error",{htmlPlacerId:a}),t.abrupt("return",null);case 10:return c.classList.add("ads-core-video"),u=e(),(l=u.initManager).options=yo(yo({},l.options),{},{videoAdsAllowed:void 0!==window.videoAdsAllowed&&window.videoAdsAllowed}),t.prev=13,t.next=16,l.init();case 16:return t.next=18,l.getVideoSlotParameters({htmlPlacer:c,reboundCount:s});case 18:return t.abrupt("return",t.sent);case 21:return t.prev=21,t.t0=t.catch(13),r.error({obj:t.t0},"stopped with error : "),Ur.sendLog("".concat(n,"_error_stopped"),"error",{error:t.t0}),t.abrupt("return",null);case 26:case"end":return t.stop()}}),t,null,[[13,21]])})));return function(e){return o.apply(this,arguments)}}()}var wo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],r=ln.getSlots("displayefreshable));return 0===e.length?r:(e.forEach((e=>{varmentId===e));void 0!==.elementId))&&t.push(n)})),t)};const So=e=>function(){var r=t(i().mark((function t(r,n){var o,a,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.warn("[CORE-ADS] : refreshAdunit is deprecated. Please use our new methods refreshDisplaySlot or refreshDisplaySlots instead."),console.warn("[CORE-ADS] : La documentation est disponible ici : https://tra.scds.pmdstatic.net/advertising-core/4/docs/#/publicMethods/publicMethods"),o=e(),a=o.initManager,void 0===r||Array.isArray(r)||(r=[r]),(s=wo(r)).length>0&&xn(s,a.displayAdManager.sendAdUnitsToBidManager,n);case 6:case"end":return t.stop()}}),t)})));return function(e,t){return r.apply(this,arguments)}}();var _o=E.child({childName:"[API] refreshDisplaySlot"});function Oo(e){return function(){var r=t(i().mark((function t(r,n){var o,a,s,c,u,l,d,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e(),s=a.initManager,u=ln.getSlots("display"),l=ln.getRefreshableSlots(u)){t.next=7;break}return d={success:!1,errorMessage:"[refreshDisplaySlot] : stopped with an error."},_o.error({error:d},"stopped with error"),t.abrupt("return",d);case 7:return r?(_o.info("start refresh for ".concat(r,".")),r=[r],c=ln.mapSlotsWithDOMSlots(r,l)):(_o.info("start refresh for the page."),c=l),0!==(null===(o=c)||void 0===o?void 0:o.length)&&xn(c,s.displayAdManager.sendAdUnitsToBidManager,n),f={success:!0,successMessage:"[refreshDisplaySlot] : has successfully completed its execution."},_o.info({obj:f}," has successfully completed its execution."),t.abrupt("return",f);case 12:case"end":return t.stop()}}),t)})));return function(e,t){return r.apply(this,arguments)}}()}var xo=E.child({childName:"[API] refreshDisplaySlots"});function Po(e){return function(){var r=t(i().mark((function t(r,n){var o,a,s,c,u,l,d,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e(),s=a.initManager,u=ln.getSlots("display"),l=ln.getRefreshableSlots(u)){t.next=7;break}return d={success:!1,errorMessage:"[refreshDisplaySlots] : stopped with an error."},xo.error({error:d},"stopped with error"),t.abrupt("return",d);case 7:return r?(xo.info("start refresh for ".concat(r)),c=ln.mapSlotsWithDOMSlots(r,l)):(xo.info("start refresh for the page"),c=l),0!==(null===(o=c)||void 0===o?void 0:o.length)&&xn(c,s.displayAdManager.sendAdUnitsToBidManager,n),f={success:!0,successMessage:"[refreshDisplaySlots] : has successfully completed its execution."},xo.info({obj:f}," has successfully completed its execution."),t.abrupt("return",f);case 12:case"end":return t.stop()}}),t)}rguments)}}()}var Ao="[setRefreshTimer] stopped :",jo=E.child({childName:"[API] setRefreshTimer"});function ko(e){return(t,r)=>{if(!t||!r){var n={success:!1,errorMessage:"".concat(Ao," cannot find the div ID: ").concat(t," or timeout: ").concat(r,", information is missing.")};return jo.error({obj:n},Ao),n}var o=ln.getSlot(t);if(!o){var i={success:!1,errorMessage:"".concat(Ao," the slot with the ").concat(t," doesn't exist on the page")};return jo.error({obj:i},Ao),i}ln.updateSlot(o.id,{timeout:r});var a=ln.getSlot(t),s=e().initManager;Pn(a,s.displayAdManager.sendAdUnitsToBidManager);var c={success:!0,successMessage:"[setRefreshTimer] executed : Refresh for the slot ".concat(t," has been set from ").concat(o.timeout," at ").concat(a.timeout)};return jo.info({obj:c}," has successfully completed its execution."),c}}var Co=E.child({childName:"[API] reset"});function Eo(e){return t(i().mark((function r(){var n,o,a,s;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e(),o=n.initManager,Co.info("removing existing slots"),googletag.cmd.push(t(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:googletag.destroySlots(),null===(t=pmspbjs)||void 0===t||null===(r=t.removeAdUnit)||void 0===r||r.call(t),ln.destroyAllSlots(),_n();case 4:case"end":return e.stop()}}),e)})))),r.next=5,an.refreshPageInfos();case 5:return r.next=7,zr();case 7:return ln.createInitialSlots(),o.displaySelector=document.getElementsByClassName("ads-core-placer"),r.prev=9,r.next=12,o.init();case 12:return r.next=14,o.setupDisplayAds();case 14:return a={success:!0,successMessage:"[reset] : Has successfully completed its execution."},Co.info({obj:a}," has successfully completed its execution."),r.abrupt("return",a);case 19:return r.prev=19,r.t0=r.catch(9),s={success:!1,errorMessage:r.t0},Co.error({obj:r.t0},"stopped with an error : "),r.abrupt("return",s);case 24:case"end":return r.stop()}}),r,null,[[9return e}function To(e){var r=E.child({childName:"[API] getVideoSlotParameters"});return function(){var n=t(i().mark((function t(n){var o,a,s,c,u,l,d,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.htmlPlacerId,a=n.reboundCount,s=e(),c=s.initManager,r.info("generating ad params for player : ".concat(o)),u=document.getElementById(o)){t.next=7;break}return r.error('stopped : Cannot find id "'.concat(o,'" in the page')),t.abrupt("return",{success:!1,errorMessage:'[getVideoSlotParameters] : Cannot find id "'.concat(o,'" in the page')});case 7:return u.classList.add("ads-core-video"),c.options=Do(Do({},c.options),{},{videoAdsAllowed:void 0!==window.videoAdsAllowed&&window.videoAdsAllowed}),t.prev=9,t.next=12,c.init();case 12:return t.next=14,c.getVideoSlotParameters({htmlPlacer:u,reboundCount:a});case 14:return l=t.sent,d={success:!0,successMessage:"[getVideoSlotParameters] : has successfully completed its execution",data:{custParams:l}},console.info(d),t.abrupt("return",l);case 20:return t.prev=20,t.t0=t.catch(9),f={success:!1,errorMessage:t.t0},r.error({obj:t.t0},"stopped with an error : "),t.abrupt("return",f);case 25:case"end":return t.stop()}}),t,null,[[9,20]])})));return function(e){return n.apply(this,arguments)}}()}var Ro,Lo,return n}class Bo{constructor(){return Bo.queue||(Bo.queue=this),this._pQueue=new Mo.Z({concurrency:2,autoStart:!1}),this.oldQueue=[],this.externalPushHandler=this.externalPushHandler.bind(this),this.logger=E.child({childName:"Queue"}e.start()}addTask(e){var r=arguments,n=this;return t(i().mark((function t(){var o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r.length>1&&void 0!==r[1]?r[1]:1,"function"==typeof e){t.next=4;break}return n.logger.error("Not added in queue: Your task ".concat(e," is not a function.")),t.abrupt("return");case 4:return t.prev=4,t.next=7,n._pQueue.add(e,{priority:o});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(4),n.logger.error("Not added in queue: An error occurred when inserting this task ".concat(e,". The error: ").concat(t.t0,"."));case 12:case"end":return t.stop()}}),t,null,[[4,9]])})))()}addAllTasks(){var e=this;return t(i().mark((function r(){var n;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=function(){var r=t(i().mark((function t(r){var n,o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=No(r),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=13;break}if("function"==typeof(a=o.value)){t.next=8;break}return e.logger.error("Not added in queue: Your task ".concat(a," is not a function.")),t.abrupt("return");case 8:console.warn("[CORE-ADS] : pmsCoreAds is deprecated. Please use windows.coreAds.queue instead."),console.warn("[CORE-ADS] : La documentation est disponible ici : https://tra.scds.pmdstatic.net/advertising-core/4/docs/#/users/integration/guide?id=queue"),e._pQueue.add(a,1);case 11:t.next=3;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[1,15,18,21]])}rguments)}}(),r.next=3,Promise.all([n(e.oldQueue)]);case 3:case"end":return r.stop()}}),r)})))()}push(){var e=arguments,r=this;return t(i().mark((function t(){var n,o,a,s,c,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=e.length,o=new Array(n),a=0;a<n;a++)o[a]=e[a];s=0,c=o;case 2:if(!(s<c.length)){t.next=19;break}if("function"!=typeof(u=c[s])){t.next=15;break}return t.prev=5,t.next=8,r._pQueue.add(u);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5),r.logger.error("Not added in queue: An error occurred when inserting this task ".concat(u,". The error: ").concat(t.t0,"."));case 13:t.next=16;break;case 15:r.logger.error("Not added in queue: ".concat(u," is not a function."));case 16:s++,t.next=2;break;case 19:case"end":return t.stop()}}),t,null,[[5,10]])})))()}externalPushHandler(){var e=arguments,r=this;return t(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.push(...e);case 2:case"end":return t.stop()}}),t)})))()}initOldQueue(){var e=this;return t(i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(Array.isArray(window.pmsCoreAds)||(window.pmsCoreAds=[]),window.pmsCoreAds&&(e.oldQueue=window.pmsCoreAds),!(window.pmsCoreAds&&window.pmsCoreAds.length>0)){r.next=5;break}return r.next=5,e.addAllTasks();case 5:e.oldQueue.push=function(){var r=t(i().mark((function t(r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.warn("[CORE-ADS] : pmsCoreAds is deprecated. Please use windows.coreAds.queue instead."),console.warn("[CORE-ADS] : La documentation est disponible ici : https://tra.scds.pmdstatic.net/advertising-core/4/docs/#/users/integration/guide?id=queue"),t.next=4,e.addTask(r,0);case 4:case"end":return t.stop()}}),t)})));return function(e){return r.apply(this,arguments)}}();case 6:case"end":return r.stop()}}),r)})))()}}(window.coreAds||null!==(Ro=window.coreAds)&&void 0!==Ro&&Ro.queue)&&(Lo=window.coreAds.queue);var Uo=new Bo;Lo&&Uo.push.apply(Uo,Lo);const Fo=Uo;function zo(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Vo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}E.info("Core-Ads version ".concat("4.230.0"," - Build on ").concat("05/02/2024"));class Go{constructor(e){var t=e.appName;this.appName=t,this.childLogger=E.child({childName:"App"}),this.windowHelper=new no,this.scripts=[],this.partners={},this.initManager={},this.publicAPI={},this.namespace="app",this.queue=Fo,dn.init(),Sn("coreAds_initCoreAds"),wn("coreAds_measureInitCoreAdsFromLoadEnd",PerformanceTiming.loadEventEnd),wn("coreAds_measureInitCoreAdsFromNavStart","navigationStart"),this.onConsentReceived=this.onConsentReceived.bind(this),this.onConsentRefused=this.onConsentRefused.bind(this)}init(){var e=this;return t(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return new s({onConsentReceived:e.onConsentReceived,onConsentRefused:e.onConsentRefused}).consentCollection(),wn("coreAds_TCF_done","navigationStart"),t.next=5,an.init({appName:e.appName,getEnv:e.getEnvDetector(),routes:e.getRoutes()});case 5:return t.next=7,pn.init();case 7:Ur.init(),an.setBrandInfos({brandName:pn.domain.name,networkId:pn.networkId}),an.setAdUnitInfos(),ln.createInitialSlots();case 11:case"end":return t.stop()}}),t)})))()}start(){var e=this;return t(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,zr();case 2:return void 0!==e.partners.prebid&&(e.partners.prebid.initBidders({bidAdjustments:pn.bidCpmAdjustment}),e.partners.prebid.getInfo()),t.next=5,e.initManager.setupAds();case 5:case"end":return t.stop()}}),t)})))()}onConsentReceived(e){var r=this;return t(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.childLogger.info("Consent Received"),r._startSlotRenderLogging(),r.consentOptions=r.getConsentOptions(e),tpn.isReady));case 5:return r._loadScripts(),r.partners=r.getPartners(),r.initManager=r.getInitManager(),t.next=10,r.initManager.init();case 10:return t.next=12,r.queue.initOldQueue();case 12:r.getGrapeShotInfos(),"prisma"===r.appName&&r.getContextualDatas(),yn.sendDeprecationLabelFromAPI(),gn.dispatch("ready",{consentGiven:!0}),r.childLogger.info("Queue started"),r.queue.start(),r.start();case 19:case"end":return t.stop()}}),t)})))()}onConsentRefused(){this.childLogger.info("Consent Refused"),gn.dispatch("ready",{consentGiven:!1})}static generatePublicAPI(e){return{addDisplaySlot:co(e),addDisplaySlots:po(e),onDemand:oo(e),onInit:ho(e),reset:Eo(e),refreshAdUnit:So(e),refreshDisplaySlot:Oo(e),refreshDisplaySlots:Po(e),getVideoAdParams:bo(e),getVideoSlotParameters:To(e),validateDataLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=window.dataLayer;void 0!==e&&(t=e);var r=t.reduce(((e,t)=>go(go({},e),t)),{});return an.validateDataLayer(r)},setRefreshTimer:ko(e),getPageInfos:()=>an.getPageInfos(),getPageTargeting:()=>new Promise((e=>{googletag.cmd.push((()=>{var t=googletag.pubads().getTargetingKeys(),r={};t.forEach((e=>{r[e]=googletag.pubads().getTargeting(e)})),e(r)}))})"video")}),getBrandConfig:()=>pn,queue:Fo}}getRoutes(){throw new Error("not impemented")}getConsentOptions(e){var t=!!e.vendor.consents[755],r=!!e.vendor.consents[769];return t&&(window.videoAdsAllowed=!0),{videoAdsAllowed:t,estatVendor:r,consentString:eOptions})}getScripts(){var e=pn.partners;return[{global:"AdsManager",src:"https://securepubads.g.doubleclick.net/tag/js/gpt.js"},...null!=e&&e.externalScripts?null==e?void 0:e.externalSartner()}}getGrapeShotInfos(){var e=this;return t(i().mark((function t(){var r,n,o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Zn();case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=null;case 5:r=t.t0,an.setGrapeShotInfos(r),n=an.getPageInfos(),(o=n.gs_cat)&&(googletag.cmd.push((()=>googletag.pubads().setTargeting("gs_cat",o))),a={gs_cat:o.join(",")},void 0!==e.partners.prebid&&e.partners.prebid.sendInfoForPartner(a));case 9:case"end":return t.stop()}}),t)})))()}getContextualDatas(){var e=this;return t(i().mark((function t(){var r,n,o,a,s,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=an.getPageInfos(),n=r.contentObjectId){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,to(n);case 5:o=t.sent,an.setContextualDatas(o),a=an.getPageInfos(),(s=a.pm_contextual)&&(googletag.cmd.push((()=>googletag.pubads().setTargeting("pm_contextual",s))),c={pm_contextual:s},void 0!==e.partners.prebid&&e.partners.prebid.sendInfoForPartner(c));case 9:case"end":return t.stop()}}),t)})))()}getPrebidBuild(){var e=this;return t(i().mark((function t(){var r,n,o,a,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=an.getPageInfos(),n=r.trigram,o=r.query,a=void 0!==(null==o?void 0:o.coreadsVersion)?"-".concat(o.coreadsVersion):"",!(n.indexOf("tac")>-1)){t.next=8;break}return s=n.replace("-tac",""),t.next=7,e.fetchPrebidBuild(s,"topactu",a);case 7:return t.abrupt("return",t.sent);case 8:return t.next=10,e.fetchPrebidBuild(n,"site",a);case 10:case"end":return t.stop()}}),t)})))()}getPrebidPartner(){var e,t,r,n,o,i,a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=pn.timeout,u=pn.partners;if(null!=u&&null!==(e=u.prebid)&&void 0!==e&&e.consent||null!=u&&u.headerbidding){this.getPrebidBuild();var l=new Wn;return a=null==u||null===(t=u.prebid)||void 0===t?void 0:t.analytics,l.init({bidderTimeout:c.headerBiddingFetch,consentTimeout:c.consent,headerBiddingConsent:(null==u||null===(r=u.prebid)||void 0===r?void 0:r.consent)||(null==u||null===(n=u.headerbidding)||void 0===n?void 0:n.consent),schain:(null==u||null===(o=u.prebid)||void 0===o||null===(o=o.config)||void 0===o?void 0:o.schain)||(null==u||null===(i=u.headerbidding)||void 0===i||null===(i=i.config)||void 0===i?void 0:i.schain),urlHash:this.windowHelper.location.hash,initializationConfigOverride:s,analyticsConfig:a}),l}}getPubs.init(),e}getAmazonPartner(){var e=pn.timeout,t=pn.partners;if(t.amazon){var r=new Yn({pubId:t.amazon.pubID,headerBiddingFetch:e.headerBiddingFetch,consent:e.consent,urlHash:this.windowHelper.location.hash,hasSchain:!0});return r.loadPartner(),r.generateToken(),r}}getGoogleTagPartner(){var e=yn.getFirstID();window.googletag.cmd.push((()=>{window.googletag.pubads().set("document_language","fr"),window.googletag.setAdIframeTitle("Publicité"),window.googletag.pubads().disableInitialLoad(),window.googletag.pubads().collapseEmptyDivs(),null!==e&&window.googletag.pubads().setPublisherProvidedId(e),window.googletag.pubads().enableSingleRequest()}))}fetchPrebidBuild(e,r,n){return t(i().mark((function t(){var o,a,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=an.getPageInfos(),a=o.env,s=new sn({src:"".concat("production"===a?"https://coreads.pmdstatic.net":"https://rec-coreads.pmdstatic.net","/").concat(e,"-").concat(r,"-bundle").concat(n,".js"),global:"prebid",location:"body"}),t.prev=3,t.next=6,s.load();case 6:t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(3),new Error("Error during importing the Prebid library",t.t0);case 11:case"end":return t.stop()}}),t,null,[[3,8]])})))()}_loadScripts(){var e=this;return t(i().mark((function t(){var r,n,o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.getScripts(),n=zo(r),t.prev=2,n.s();case 4:if((o=n.n()).done){t.next=11;break}return"AdsManager"===(a=o.value).global&&Sn("coreAds_initAdServerScript"),t.next=9,new sn(a).load();case 9:t.next=4;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),n.e(t.t0);case 16:return t.prev=16,n.f(),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[2,13,16,19]])})))()}_startSlotRenderLogging(){window.googletag.cmd.push((()=>{window.googletag.pubads().addEventListener("slotRenderEnded",this._onSlotRenderEnded),window.googletag.pubads().addEventListener("slotOnload",this._onSlotOnLoad)}))}_onSlotRenderEnded(e){var t=e.slot.getSlotElementId(),r=ln.getSlot(t),n=t.includes("Postitiel")?t.split("/").pop():r.DOMData.type;Sn("coreAds_slotRenderStart_".concat(n.toLowerCase()))}_onSlotOnLoad(e){var t=e.slot.getSlotElementId(),r=ln.getSlot(t),n=t.includes("Postitiel")?t.split("/").pop():r.DOMData.type;wn("coreAds_slotRenderEnded_".concat(n.toLowerCase()),"coreAds_slotRenderStart_".concat(n.toLowerCase()))}}class Ho{init(){window.pmcstarter?(this._pmcstarter=window.pmcstarter,this._onPMCLoad()):Object.defineProperties(window,{_pmcstarter:{value:"string",writable:!0},pmcstarter:{configurable:!0,get:()=>this._pmcnPMCLoad()}}})}_onPMCLoad(){if("function"!=typeof this._pmcstarter)return!1;this._pmcstarter("getProfile",(e=>{var t,r;void 0!==(null==e||null===(t=e._user)||void 0===t?void 0:t.hashEmailSHA256)&&window.localStorage.setItem("userHashedEmail",null==e||null===(r=e._user)||void 0===r?void 0:r.hashEmailSHA256),void 0!==(null==e?void 0:e.personalInformationShared)&&window.localStorage.setItem("userInformationShared",null==e?void 0:e.personalInformationShared)}))}}const $o={gal:{subDomain:{"gal-tac":["actu","rec-actu"]},domain:["gala"]},tel:{subDomain:{"tel-tac":["actu","rec-actu"]},domain:["programme-tv"]},voi:{subDomain:{"voi-tac":["actu","rec-actu"]},domain:["voici","cesoir"]},fac:{subDomain:{"fac-tac":["actu","rec-actu"]},domain:["femmeactuelle"]},cac:{subDomain:{"cac-tac":["actu","rec-actu"]},domain:["cuisineactuelle"]},bea:{subDomain:{},domain:["beaute-addict"]},cap:{subDomain:{"cap-tac":["actu","rec-actu"]},domain:["capital"]},geo:{subDomain:{"geo-tac":["actu","rec-actu"]},domain:["geo"]},neon:{subDomain:{"neon-tac":["actu","rec-actu"]},domain:["neonmag"]},t2s:{subDomain:{"t2s-tac":["actu","rec-actu"]},domain:["programme"]},ctv:{subDomain:{},domain:["cesoirtv"]},facv:{subDomain:{},domain:["matvpratique"]},hbr:{subDomain:{"hbr-tac":["actu","rec-actu"]},domain:["hbrfrance"]},cam:{subDomain:{"cam-tac":["actu","rec-actu"]},domain:["caminteresse"]},uksas:{subDomain:{desas:["de","rec-de","de-photo","local-de"],uksas:["rec","rec2-photo","photo"]},domain:["seeandso"]},hbz:{subDomain:{"hbz-tac":["actu","rec-actu"]},domain:["harpersbazaar"]}};class Jo{return $o}getEnvDetector(){return e=>{var t,r=e.defineCurrentEnvironment,n=e.subDomain,o=e.host,i={defineCurrentEnvironment:r,subDomain:n};if(null!=n&&null!==(t=n.startsWith)&&void 0!==t&&t.call(n,"rec"))if(i.defineCurrentEnvironment="recette","rec2video"===n)i.subDomain="video";else if("quiz"===(null==o?void 0:o[1]))i.subDomain="quiz";else{var a=n.split("-")[0];i.subDomain=n.replace("".concat(a,"-"),"")}return i}}stsuper.start,r=this;return t(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e().call(r);case 2:(new Ho).init();case 4:case"end":return t.stop()}}),t)})))()}}var Wo=null,Ko=function(){var e=t(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Wo=new Jo({appName:"prisma"}),e.next=4,Wo.init();case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(0),!new URLSearchParams(null===(t=window.location)||void 0===t?void 0:t.search).get("debugads")){e.next=13;break}throw e.t0;case 13:E.error("CATCH-ALL: ".concat(e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();Ko();var Qo=Go.generatePublicAPI((()=>Wo)),Xo=Qo.addDisplaySlot,Yo=Qo.addDisplaySlots,Zo=Qo.onDemand,ei=Qo.onInit,ti=Qo.refreshAdUnit,ri=Qo.getVideoAdParams,ni=Qo.validateDataLayer,oi=Qo.setRefreshTimer,ii=Qo.refreshDisplaySlot,ai=Qo.refreshDisplaySlots,si=Qo.getVideoSlotParameters,ci=Qo.reset,ui=Qo.getPageInfos,li=Qo.getPageTargeting,di=Qo.getSlots,fi=Qo.getBrandConfig,pi=Qo.queue})();var o=coreAds="undefined"==typeof coreAds?{}:coreAds;for(var i in n)o[i]=n[i];n.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();