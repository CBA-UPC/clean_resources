!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="56d177e8-9d19-4a2c-b04e-5263f0a7c0a8",e._sentryDebugIdIdentifier="sentry-dbid-56d177e8-9d19-4a2c-b04e-5263f0a7c0a8")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[5783],{9629:(e,t,s)=>{s.d(t,{Z:()=>o});let o={blockEditorContainer:"oDBam",editor:"RupUR",isHTMLEditor:"lpspI",loader:"DUncU",fullWidth:"HD1ZK",trail:"oNB5R",japanese:"SZTc6",korean:"TJjf1",chinese:"VHsXy",changeEditorLoader:"hThjS"}},32252:(e,t,s)=>{s.d(t,{Z:()=>o});let o={loader:"vGeDT",toastWrapper:"IPV4Y",postContainer:"l8blt"}},92409:(e,t,s)=>{s.d(t,{Z:()=>n});var o=s(93897);function n(e){return(0,o.c)(e.ownerDocument.defaultView,"element.ownerDocument.defaultView"),e.ownerDocument.defaultView.getComputedStyle(e)}},71790:(e,t,s)=>{s.d(t,{Z:()=>n});var o=s(92409);function n(e,t,s,n){let a=n.style.zIndex,r=n.style.position,{position:i="static"}=(0,o.Z)(n);"static"===i&&(n.style.position="relative"),n.style.zIndex="10000";let l=function(e,t,s){if(e.caretRangeFromPoint)return e.caretRangeFromPoint(t,s);if(!e.caretPositionFromPoint)return null;let o=e.caretPositionFromPoint(t,s);if(!o)return null;let n=e.createRange();return n.setStart(o.offsetNode,o.offset),n.collapse(!0),n}(e,t,s);return n.style.zIndex=a,n.style.position=r,l}},59002:(e,t,s)=>{s.d(t,{Z:()=>o});function o(e){return e?.nodeName==="INPUT"}},53990:(e,t,s)=>{s.d(t,{Z:()=>o});function o(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName}},81912:(e,t,s)=>{s.d(t,{Z:()=>n});var o=s(92409);function n(e){return"rtl"===(0,o.Z)(e).direction}},13929:(e,t,s)=>{s.d(t,{Z:()=>n});var o=s(59002);function n(e){return(0,o.Z)(e)&&e.type&&!["button","checkbox","hidden","file","radio","image","range","reset","submit","number","email","time"].includes(e.type)||"TEXTAREA"===e.nodeName||"true"===e.contentEditable}},98635:(e,t,s)=>{s.d(t,{Z:()=>l});var o=s(71790),n=s(93897),a=s(53990),r=s(81912),i=s(56454);function l(e,t,s){if(!e)return;if(e.focus(),(0,a.Z)(e)){if("number"!=typeof e.selectionStart)return;t?(e.selectionStart=e.value.length,e.selectionEnd=e.value.length):(e.selectionStart=0,e.selectionEnd=0);return}if(!e.isContentEditable)return;let l=(0,i.t)(e,t,()=>(function(e,t,s){let{ownerDocument:n}=e,a=(0,r.Z)(e)?!t:t,i=e.getBoundingClientRect();void 0===s?s=t?i.right-1:i.left+1:s<=i.left?s=i.left+1:s>=i.right&&(s=i.right-1);let l=a?i.bottom-1:i.top+1;return(0,o.Z)(n,s,l,e)})(e,t,s));if(!l)return;let{ownerDocument:d}=e,{defaultView:h}=d;(0,n.c)(h,"defaultView");let c=h.getSelection();(0,n.c)(c,"selection"),c.removeAllRanges(),c.addRange(l)}},90776:(e,t,s)=>{s.d(t,{Z:()=>n});var o=s(98635);function n(e,t){return(0,o.Z)(e,t,void 0)}},56454:(e,t,s)=>{s.d(t,{t:()=>o});function o(e,t,s){let o=s();return o&&o.startContainer&&e.contains(o.startContainer)||(e.scrollIntoView(t),(o=s())&&o.startContainer&&e.contains(o.startContainer))?o:null}},40240:(e,t,s)=>{s.d(t,{T_:()=>v});var o={};s.r(o),s.d(o,{find:()=>r});var n={};function a(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0}function r(e,{sequential:t=!1}={}){return Array.from(e.querySelectorAll([t?'[tabindex]:not([tabindex^="-"])':"[tabindex]","a[href]","button:not([disabled])",'input:not([type="hidden"]):not([disabled])',"select:not([disabled])","textarea:not([disabled])",'iframe:not([tabindex^="-"])',"object","embed","area[href]","[contenteditable]:not([contenteditable=false])"].join(","))).filter(e=>{if(!a(e))return!1;let{nodeName:t}=e;return"AREA"!==t||function(e){let t=e.closest("map[name]");if(!t)return!1;let s=e.ownerDocument.querySelector('img[usemap="#'+t.name+'"]');return!!s&&a(s)}(e)})}function i(e){let t=e.getAttribute("tabindex");return null===t?0:parseInt(t,10)}function l(e){return -1!==i(e)}function d(e,t){return{element:e,index:t}}function h(e){return e.element}function c(e,t){let s=i(e.element),o=i(t.element);return s===o?e.index-t.index:s-o}function u(e){return e.filter(l).map(d).sort(c).map(h).reduce(function(){let e={};return function(t,s){let{nodeName:o,type:n,checked:a,name:r}=s;if("INPUT"!==o||"radio"!==n||!r)return t.concat(s);let i=e.hasOwnProperty(r);if(!(a||!i))return t;if(i){let s=e[r];t=t.filter(e=>e!==s)}return e[r]=s,t.concat(s)}}(),[])}function p(e){return u(r(e))}function m(e){return u(r(e.ownerDocument.body)).reverse().find(t=>e.compareDocumentPosition(t)&e.DOCUMENT_POSITION_PRECEDING)}function g(e){return u(r(e.ownerDocument.body)).find(t=>e.compareDocumentPosition(t)&e.DOCUMENT_POSITION_FOLLOWING)}s.r(n),s.d(n,{find:()=>p,findNext:()=>g,findPrevious:()=>m,isTabbableIndex:()=>l});let v={focusable:o,tabbable:n}},93897:(e,t,s)=>{s.d(t,{c:()=>o});function o(e,t){}},67615:(e,t,s)=>{s.d(t,{Z:()=>o});let o=(0,s(95004).lazy)(()=>s.e(9717).then(s.t.bind(s,94497,23)))},89272:(e,t,s)=>{s.d(t,{G9:()=>u,ZP:()=>f});var o=s(33970),n=s.n(o),a=s(40240),r=s(13929),i=s(90776),l=s(95004),d=s(5700),h=e=>e.classList.contains("block-editor-default-block-appender__content"),c=e=>e.classList.contains("block-editor-rich-text__editable"),u=e=>{var t;return(null===(t=e.current)||void 0===t?void 0:t.parentNode)instanceof Element?a.T_.tabbable.find(e.current.parentNode):[]},p=e=>u(e).filter(r.Z),m=e=>u(e).filter(h),g=e=>e.find(c),v=e=>[...e].reverse().find(c),b=e=>{var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)};let f=e=>{var t=(0,l.useState)([]),s=n()(t,2),o=s[0],a=s[1],r=(0,l.useState)([]),h=n()(r,2),c=h[0],u=h[1],f=(0,l.useRef)(),x=(0,l.useCallback)(()=>{var t=0;return new Promise(s=>{var o=()=>{f.current=window.setTimeout(()=>{t+=100;var n=0!==m(e).length,a=t>=2e3;n||a?s():o()},100)};o()})},[e]);return(0,l.useEffect)(()=>(e.current&&x().then(()=>{a(p(e)),u(m(e))}),function(){f.current&&clearTimeout(f.current)}),[e,x]),(0,l.useCallback)(function(){var e,t,s=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;if(0!==c.length||0!==o.length){if(s)switch(n){case d.hQ.Text:case d.hQ.Chat:e=v(o);break;case d.hQ.Ask:case d.hQ.Quote:e=g(o);break;case d.hQ.Photo:case d.hQ.Link:case d.hQ.Audio:case d.hQ.Video:break;default:e=c[0]}else e=null!==(t=v(o))&&void 0!==t?t:c[0];e&&(e.scrollIntoView(),b(e)&&(0,i.Z)(e,!s))}},[c,o])}},93288:(e,t,s)=>{s.d(t,{Z:()=>l});var o=s(50209),n=s.n(o),a=s(95004),r=s(25200),i=s(2629);class l extends a.Component{constructor(){super(...arguments),n()(this,"state",{error:null})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){var s,o,n=void 0;this.props.source&&(n={tags:{source:this.props.source}}),(0,r.Tb)(e,n),null===(s=(o=this.props).onError)||void 0===s||s.call(o)}render(){var e=this.state.error;return e?this.props.FallbackComponent?(0,i.jsx)(this.props.FallbackComponent,{error:e}):null:this.props.children}}},44238:(e,t,s)=>{s.d(t,{Z:()=>p});var o=s(50209),n=s.n(o),a=s(5754),r=s.n(a),i=s(95004),l=s(60612),d=s(61792),h=s(78093),c=s(2629);class u extends i.Component{constructor(){super(...arguments),n()(this,"transitionNodeRef",(0,i.createRef)()),n()(this,"prevCount",0),n()(this,"renderContentFromTransitionStatus",e=>{var t=this.props,s=t.count,o=t.showNumber,n=t.isCircle,a=t.className,i=t.style,h=this.prevCount>s&&0===s,u=[l.d0,l.cn,l.Ix].includes(e),p=h&&u?this.prevCount:s;return(0,c.jsx)("div",{ref:this.transitionNodeRef,className:r()("jpu7k",a,{D0OOd:[l.d0,l.cn].includes(e),e2EeC:n,XnKJk:!n}),style:i,role:"status",children:o&&(0,d.Z)(p,99)})})}componentDidUpdate(e){this.prevCount=(null==e?void 0:e.count)||0}render(){var e=this.props.count;return(0,c.jsx)(l.ZP,{nodeRef:this.transitionNodeRef,in:e>0,timeout:h.notificationBadgeTransitionDurationMs,children:this.renderContentFromTransitionStatus})}}n()(u,"defaultProps",{count:0,showNumber:!0});let p=u},68144:(e,t,s)=>{s.d(t,{Cq:()=>d,UX:()=>l,jV:()=>r,nT:()=>i,sn:()=>a});var o=s(36343),n=e=>(0,o.q)("caret-thin",{altIcon:"caret-thin-alt",style:{transform:`rotate(${e}deg)`,transformOrigin:"center"}}),a=(0,o.q)("caret-thin",{altIcon:"caret-thin-alt"}),r=n(270),i=n(0),l=n(90),d=n(180);[r,i,l,d].forEach(e=>e.defaultProps={size:{width:15,height:9},useAltIcon:!1})},70648:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("earth",{altIcon:"earth-alt"});o.defaultProps={size:{width:16,height:16},useAltIcon:!1};let n=o},83134:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("globe");o.defaultProps={size:{width:22,height:22}};let n=o},19299:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("lock",{altIcon:"lock-alt"});o.defaultProps={size:{width:24,height:24},useAltIcon:!1};let n=o},47090:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-all");o.defaultProps={size:{width:24,height:24}};let n=o},902:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-ask");o.defaultProps={size:{width:24,height:24}};let n=o},81022:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-audio",{altIcon:"posts-audio-alt"});o.defaultProps={size:{width:24,height:24},useAltIcon:!1};let n=o},66052:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-chat");o.defaultProps={size:{width:24,height:24}};let n=o},48430:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-link",{altIcon:"posts-link-alt"});o.defaultProps={size:{width:24,height:24},useAltIcon:!1};let n=o},53852:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-photo",{altIcon:"posts-photo-alt"});o.defaultProps={size:{width:24,height:24},useAltIcon:!1};let n=o},75815:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-quote");o.defaultProps={size:{width:24,height:24}};let n=o},60951:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-text");o.defaultProps={size:{width:24,height:24}};let n=o},40565:(e,t,s)=>{s.d(t,{Z:()=>n});var o=(0,s(36343).q)("posts-video",{altIcon:"posts-video-alt"});o.defaultProps={size:{width:24,height:24},useAltIcon:!1};let n=o},82145:(e,t,s)=>{s.d(t,{Z:()=>g});var o=s(54138),n=s.n(o),a=s(54589),r=s.n(a),i=s(36343),l=s(55015),d=s(2629),h=["isCompact","isRounded"],c=(0,i.q)("reblog"),u=(0,i.q)("reblog-compact"),p=(0,i.q)("reblog-rounded"),m=e=>{var t=e.isCompact,s=e.isRounded,o=r()(e,h);return t?(0,d.jsx)(u,n()({},o)):s?(0,d.jsx)(p,n()({},o)):(0,d.jsx)(c,n()({},o))};m.defaultProps={size:l.Z.desktop.reblogIconSize,isCompact:!1,isRounded:!1};let g=m},37560:(e,t,s)=>{s.d(t,{Z:()=>d});var o=s(50209),n=s.n(o),a=s(95004),r=s(36485),i=s(2629);class l extends a.Component{render(){var e=this.props,t=e.className,s=e.src,o=e.title,n=e.queryParams,a=e.scrolling,l=e.frameBorder,d=e.style,h=e.onLoad,c=e.placementId,u=e.allow,p=e.allowFullScreen;return(0,i.jsx)("iframe",{className:t,name:c,title:o,src:(0,r.Z)(s,n),scrolling:a,frameBorder:l,style:d,onLoad:h,allow:u,allowFullScreen:p})}}n()(l,"defaultProps",{className:"",queryParams:{},scrolling:"no",frameBorder:0});let d=l},48352:(e,t,s)=>{s.d(t,{Z:()=>v});var o=s(54138),n=s.n(o),a=s(33970),r=s.n(a),i=s(95004),l=s(78994),d=s(55673),h=s(43523),c=s(22424),u=s(12736),p=s(14544),m=s(78667);let g=e=>{var t=(0,m.bp)().logEvent,s=(0,l.TH)().pathname,o=(0,d.lr)(),a=r()(o,1)[0];(0,i.useEffect)(()=>{"embed"===a.get("source")&&t({pathname:s,eventName:h.J.EmbedPostClick,eventDetails:n()(n()({},e),{},{refUrl:a.get("refUrl"),action:a.get("action")})})},[])},v=e=>{var t=e.page,s=e.eventDetails,o=(0,c.wL)().logEvent,a=(0,l.TH)().pathname,m=(0,d.lr)(),v=r()(m,1)[0],b=(0,p.M)().name,f=(0,u.z)(),x=f.isModalShowing,C=f.isPeeprShowing,P=(0,i.useRef)(x||C),y=v.get("source"),w=()=>o({page:t,pathname:a,eventName:h.J.ScreenView,eventDetails:n()(n()({pathname:a,referrer:document.referrer,color_palette:b},y&&{source:y}),s)});return(0,i.useEffect)(()=>{w()},[a,t]),(0,i.useEffect)(()=>{!P.current||x||C||w(),P.current=x||C},[P,x,C]),g(),null}},9557:(e,t,s)=>{s.d(t,{Z:()=>h});var o=s(54138),n=s.n(o),a=s(50209),r=s.n(a),i=s(95004),l=s(53714),d=s(2629);class h extends i.Component{constructor(){super(...arguments),r()(this,"state",{isOpen:!1}),r()(this,"toggle",()=>this.setState(e=>({isOpen:!e.isOpen})))}render(){return(0,d.jsx)(l.ZP,n()(n()({isOpen:this.state.isOpen,toggle:this.toggle},this.props),{},{children:this.props.children}))}}},16565:(e,t,s)=>{s.d(t,{Um:()=>d,bo:()=>l,lC:()=>i,mY:()=>m,m_:()=>h,qU:()=>c,zA:()=>p});var o=s(44027),n=s.n(o),a=s(5700),r=s(19937),i=e=>[[0],[1],[2],[2,1],[2,2],[2,1,2],[2,2,2],[2,3,2],[3,2,3],[3,3,3],[3,2,3,2],[3,3,3,2],[3,3,3,3],[3,3,3,2,2],[3,3,3,3,2],[3,3,3,3,3],[3,3,3,3,2,2],[3,3,3,3,3,2],[3,3,3,3,3,3],[3,3,3,3,3,2,2],[3,3,3,3,3,3,2],[3,3,3,3,3,3,3],[3,3,3,3,3,3,2,2],[3,3,3,3,3,3,3,2],[3,3,3,3,3,3,3,3],[3,3,3,3,3,3,3,2,2],[3,3,3,3,3,3,3,3,2],[3,3,3,3,3,3,3,3,3],[3,3,3,3,3,3,3,3,2,2],[3,3,3,3,3,3,3,3,3,2],[3,3,3,3,3,3,3,3,3,3]][Math.min(e,30)],l=e=>e.innerBlocks.reduce((e,t)=>"tumblr/image-set-row"===t.name?e+t.innerBlocks.length:e,0),d=e=>void 0!==(null==e?void 0:e.ctaTextCode)&&(null==e?void 0:e.ctaTextCode)!=="",h=(e,t)=>{if(null==t?void 0:t.length)return!0;if(!e||!e.content||!e.content.length)return!1;var s=e.content.findIndex(e=>e.type===a.kH.Paywall);return -1===s||0!==s&&s!==e.content.length-1},c=e=>["richText","html","markdown"][e]||"richText",u=e=>{var t,s=n()(e);try{for(s.s();!(t=s.n()).done;){var o=t.value.content.find(e=>"video"===e.type&&"tumblr"===e.provider);if(o)return o}}catch(e){s.e(e)}finally{s.f()}return null},p=(e,t,s,o)=>{(0,r.J)(t,{postId:e,blogIdentifier:s.name}).fetch().then(n=>{var a=n.response;if("transcoding"!==a.posts[0].state){o();var r=u(a.posts);r&&window.dispatchEvent(new CustomEvent("transcoding",{detail:r}))}else setTimeout(()=>{p(e,t,s,o)},5e3)})},m=e=>{if("undefined"==typeof document)return"auto";var t=document.createElement("canvas").getContext("2d");if(!t)return"auto";t.font='16px "Favorit"';var s=t.measureText(e);return Math.max(s.width,Math.ceil(Math.abs(s.actualBoundingBoxLeft)+Math.abs(s.actualBoundingBoxRight)))}},48803:(e,t,s)=>{s.d(t,{R$:()=>T,ze:()=>S,Bg:()=>k,$7:()=>w,Gk:()=>j,ZP:()=>I});var o=s(5754),n=s.n(o),a=s(95004),r=s(28431),i=s(68384),l=s(47090),d=s(902),h=s(81022),c=s(66052),u=s(48430),p=s(53852),m=s(75815),g=s(60951),v=s(40565),b=s(54382),f=s(43684),x=s(78667),C=s(63583);let P={postTypeDropdown:"Ukaq9",allPosts:"snNt1",itemDivider:"fNBIy",postTypeDropdownItem:"F3bvL",containerLeft:"_47eZM",postTypeText:"FjHC8",textFilter:"K33Zl",photoFilter:"Guk6U",quoteFilter:"Qw3Wo",linkFilter:"WC9ut",chatFilter:"jYem4",audioFilter:"Y6Y3T",videoFilter:"C60xO",askFilter:"_WZQZ"};var y=s(2629),w=175,T="auto",S="70vh",k=f.I2.Bottom,j={width:14,height:14},N={ask:(0,y.jsx)(d.Z,{}),audio:(0,y.jsx)(h.Z,{}),chat:(0,y.jsx)(c.Z,{}),link:(0,y.jsx)(u.Z,{}),photo:(0,y.jsx)(p.Z,{}),quote:(0,y.jsx)(m.Z,{}),text:(0,y.jsx)(g.Z,{}),video:(0,y.jsx)(v.Z,{})};let I=function(e){var t=e.pathGenerator,s=e.isDisabled,o=e.selectType,d=e.selected,h=(0,x.bp)()._c,c=(0,a.useMemo)(()=>({text:h("Post type","Text"),photo:h("Post type","Photo"),quote:h("Post type","Quote"),link:h("Post type","Link"),chat:h("Post type","Chat"),audio:h("Post type","Audio"),video:h("Post type","Video"),ask:h("Post type","Ask")}),[h]),u=(0,a.useCallback)(()=>null==o?void 0:o(),[o]);return(0,y.jsxs)("div",{role:"listbox",className:P.postTypeDropdown,children:[(0,y.jsxs)(r.Z,{className:P.allPosts,onClick:u,label:h("All posts types","All posts"),linkTo:null==t?void 0:t(),isDisabled:s,role:"option",selected:!d,children:[(0,y.jsxs)("div",{className:P.containerLeft,children:[(0,y.jsx)(l.Z,{colors:{primary:C.colorTextPostFilter}}),(0,y.jsx)("div",{className:P.postTypeText,children:(0,y.jsx)(b.ZP,{children:"All posts"})})]}),!d&&(0,y.jsx)(i.Z,{size:j,colors:{primary:C.paletteBlue}})]}),(0,y.jsx)("hr",{className:P.itemDivider}),Object.keys(c).map(e=>(0,y.jsxs)(r.Z,{className:n()(P.postTypeDropdownItem,P[`${e}Filter`]),label:c[e],linkTo:null==t?void 0:t(e),onClick:()=>null==o?void 0:o(e),isDisabled:s,role:"option",selected:d===e,children:[(0,y.jsxs)("div",{className:P.containerLeft,children:[(0,y.jsx)("div",{className:P.typeIcon,children:N[e]}),(0,y.jsx)("div",{className:P.postTypeText,children:c[e]})]}),d===e&&(0,y.jsx)(i.Z,{size:j,colors:{primary:C.paletteBlue}})]},e))]})}},83152:(e,t,s)=>{s.d(t,{Z:()=>n});var o=s(55673);function n(e){var t=e.message,s=e.when;return(0,o.kz)({message:t,when:void 0===s||s}),null}},66589:(e,t,s)=>{s.d(t,{Z:()=>c});var o=s(54138),n=s.n(o),a=s(54589),r=s.n(a),i=s(5754),l=s.n(i),d=s(2629),h=["children","className","as"];let c=e=>{var t=e.children,s=e.className,o=e.as,a=r()(e,h);return(0,d.jsx)(void 0===o?"p":o,n()(n()({className:l()("lPY88",s)},a),{},{children:t}))}},14113:(e,t,s)=>{s.d(t,{Z:()=>g});var o=s(54138),n=s.n(o),a=s(54589),r=s.n(a),i=s(5754),l=s.n(i),d=s(98384),h=s(19299),c=s(66589);let u={dropdownWrapper:"Rb_wu",dropdown:"irkyW",iconWrapper:"y9c3c",caretIcon:"x2Gw6",lockIcon:"N9zx6",helpText:"oR8IV"};var p=s(2629),m=["className","helpText","children","disabled"];let g=e=>{var t=e.className,s=e.helpText,o=e.children,a=e.disabled,i=r()(e,m),g=(0,p.jsxs)("div",{className:l()(u.dropdownWrapper,t),children:[(0,p.jsx)("select",n()(n()({className:l()(u.dropdown,t),disabled:a},i),{},{children:o})),(0,p.jsx)("span",{className:u.iconWrapper,children:a?(0,p.jsx)(h.Z,{className:u.lockIcon}):(0,p.jsx)(d.$S,{className:u.caretIcon,useAltIcon:!0})})]});return s?(0,p.jsxs)("label",{children:[g,(0,p.jsx)(c.Z,{className:u.helpText,children:s})]}):g}},15608:(e,t,s)=>{s.d(t,{Z:()=>p});var o=s(50209),n=s.n(o),a=s(5754),r=s.n(a),i=s(95004),l=s(45051),d=s(63583);let h={toggle:"Bs6U3",small:"KDgcr",switch:"xmMz6",slider:"UZrDG",checked:"U_rPn",medium:"Ld5wO",large:"gcGa_",disabled:"RHCmM"};var c=s(2629);class u extends i.PureComponent{constructor(){super(...arguments),n()(this,"state",{checked:!!this.props.checked}),n()(this,"stopEventPropagation",e=>{e&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())}),n()(this,"toggle",e=>{this.props.controlled||this.setState(e=>({checked:!e.checked})),this.props.onChange(e)})}render(){var e=this.props.controlled?this.props.checked:this.state.checked,t=this.props,s=t.name,o=t.color,n=t.className,a=t.size,i=t.disabled,l=t.labelledBy,d=t.id,u=e?{backgroundColor:o}:void 0;return(0,c.jsx)("div",{className:r()("Bs6U3",n,h[a]),children:(0,c.jsxs)("label",{className:"xmMz6",children:[(0,c.jsx)("input",{type:"checkbox","aria-checked":e,onChange:this.toggle,onClick:this.stopEventPropagation,disabled:i,checked:e,name:s,"aria-labelledby":l,id:d,"data-testid":this.props["data-testid"]}),(0,c.jsx)("span",{style:u,className:r()("UZrDG",{RHCmM:i,U_rPn:e})})]})})}}n()(u,"defaultProps",{onChange:l.Z,checked:!1,disabled:!1,size:"medium",color:d.paletteBlue});let p=u},5553:(e,t,s)=>{s.d(t,{n:()=>n});var o=s(32415);function n(){return(0,o.Pc)(a)}function a(e){var t;return null===(t=e.user)||void 0===t?void 0:t.blogs}},35215:(e,t,s)=>{s.d(t,{Q:()=>i,R:()=>r});var o=s(33590),n=s(87693),a=s(78667);function r(e){return["blog-settings",e]}function i(e){var t=(0,a.bp)().apiFetch;return(0,o.a)({queryKey:r(e),queryFn:()=>(0,n.Z)(t,e),staleTime:6e4,enabled:!!e})}},68855:(e,t,s)=>{s.r(t),s.d(t,{default:()=>sp,getNormalizedParamsForModal:()=>su});var o=s(54138),n=s.n(o),a=s(33970),r=s.n(a),i=s(77865),l=s(95004),d=s(78994),h=s(50209),c=s.n(h),u=s(5754),p=s.n(u),m=s(44009),g=s(50213),v=s(98478),b=s(36343),f=(0,b.q)("question");f.defaultProps={size:{width:24,height:24}};var x=s(23326),C=s(26321),P=s(53714),y=s(15608),w=s(54382),T=s(25190),S=s(13883),k=s(43523),j=s(43684),N=s(85795),I=s(59215),A=s(63583),E=s.n(A);let F={wrapper:"gMPGC",prompt:"Ei3s6",button:"MAQ5g",badge:"g3KgL",enabled:"bkzF7",badgeWrapper:"Zzbsf",outerToggleButton:"k19WL",isCloseButton:"TVQUe",extraInfo:"nRlLP",isFirstUse:"IFU4M",innerToggleButton:"Am971"};var B=s(2629);class D extends l.Component{constructor(){super(...arguments),c()(this,"state",{isInfoPopoverOpen:!1,isGutenbergInfoPopoverOpen:!1,isDisablePromptOpen:!1,isEnablePromptOpen:!1,isFirstUse:!1,hasToggledBefore:!1,isGutenbergActive:!1}),c()(this,"apiHelper",(0,N.ZP)(this.props.appContext.apiFetch)),c()(this,"renderContent",e=>{var t=this.props,s=t.appContext.features,o=s.redpopDesktopEditorBeta,n=s.legacyEditorAccess,a=t.isPremiumPartner,r=this.state,i=r.hasToggledBefore,l=r.isEnablePromptOpen;return e||!(n||a)?null:o||i?this.renderBadge():(0,B.jsxs)(B.Fragment,{children:[l&&this.renderEnablePrompt(),(0,B.jsx)("div",{className:F.wrapper,children:(0,B.jsxs)("div",{className:F.prompt,children:[(0,B.jsx)("span",{children:(0,B.jsx)(w.ZP,{children:"✨ Look! A shiny new post editor ✨"})}),(0,B.jsx)(m.Z,{wrapperClassName:F.button,onClick:this.enableBeta,children:(0,B.jsx)(w.ZP,{children:"Let's go!"})})]})})]})}),c()(this,"renderBadge",()=>{var e=this.props.appContext,t=e._t,s=e.features.redpopDesktopEditorBeta,o=this.state,n=o.isInfoPopoverOpen,a=o.isDisablePromptOpen,r=o.isEnablePromptOpen;return(0,B.jsxs)("div",{className:F.wrapper,children:[r&&this.renderEnablePrompt(),a&&this.renderDisablePrompt(),(0,B.jsxs)("div",{className:F.badgeWrapper,children:[(0,B.jsx)(P.ZP,{isOpen:n,toggle:null,usePortals:!1,isChromeless:!0,position:j.I2.BottomEnd,width:212,height:"auto",skipClickToOpen:!0,noTransitions:!0,render:this.renderInfo,children:(0,B.jsx)(m.Z,{wrapperClassName:p()(F.outerToggleButton,{[F.isCloseButton]:n}),label:t("Info"),onClick:this.toggleInfoPopover,children:n?(0,B.jsx)(v.Z,{size:{width:9,height:9}}):(0,B.jsx)(f,{size:{width:18,height:18}})})}),(0,B.jsx)(C.Z,{className:p()(F.badge,{[F.enabled]:!s}),noHover:!0,children:(0,B.jsx)(w.ZP,{children:"Legacy Editor"})}),(0,B.jsx)(y.Z,{checked:!s,color:A.glassGreen,onChange:s?this.disableBeta:this.enableBeta,controlled:!0})]})]})}),c()(this,"renderInfo",()=>{var e=this.state.isFirstUse,t=this.props.appContext,s=t.features.redpopDesktopEditorBeta,o=t.wwwBaseUrl,n=`${o}/support`;return s?(0,B.jsxs)("div",{className:p()(F.extraInfo,{[F.isFirstUse]:e}),children:[(0,B.jsx)(w.ZP,{components:{supportLink:(0,B.jsx)("a",{href:n,target:"_blank"})},children:"You are currently using the Tumblr post editor. [supportLink]Let us know[/supportLink] if you find something wonky."}),e&&(0,B.jsx)(m.Z,{wrapperClassName:F.innerToggleButton,onClick:this.toggleInfoPopover,children:(0,B.jsx)(w.ZP,{children:"Got it!"})})]}):(0,B.jsx)("div",{className:F.extraInfo,children:(0,B.jsx)(w.ZP,{components:{supportLink:(0,B.jsx)("a",{href:n,target:"_blank"})},children:"Try out our shiny new post editor. [supportLink]Let us know[/supportLink] if you find something wonky."})})}),c()(this,"renderEnablePrompt",()=>{var e=this.props.appContext._t;return(0,B.jsx)(g.Z,{onGlassClick:this.hideDisablePrompt,glassIsClickable:!1,children:(0,B.jsx)(x.O,{title:e("✨ A shiny new post editor ✨"),body:e("Any unsaved changes will be lost."),buttons:[{text:e("Let's go!"),onClick:()=>this.doEnableBeta(),buttonStyle:x.X.Confirm},{text:e("No thanks"),onClick:this.hideEnablePrompt,buttonStyle:x.X.Neutral}]})})}),c()(this,"renderDisablePrompt",()=>{var e=this.props.appContext._t;return(0,B.jsx)(g.Z,{onGlassClick:this.hideDisablePrompt,glassIsClickable:!1,children:(0,B.jsx)(x.O,{title:e("Are you sure you want to turn on the legacy editor? You will lose all your progress."),buttons:[{text:e("Turn On"),onClick:this.doDisableBetaAndLog,buttonStyle:x.X.Confirm},{text:e("Nevermind"),onClick:this.hideDisablePrompt,buttonStyle:x.X.Neutral}]})})}),c()(this,"toggleInfoPopover",()=>{var e=this.props.appContext.logEvent;this.setState(t=>{var s=t.isInfoPopoverOpen;return s||e({eventName:k.J.PFBetaSwitchHelp}),{isInfoPopoverOpen:!s,isFirstUse:!1}})}),c()(this,"hideDisablePrompt",()=>{(0,this.props.appContext.logEvent)({eventName:k.J.PFBetaSwitchOFFDismiss}),this.setState({isDisablePromptOpen:!1,isInfoPopoverOpen:!1})}),c()(this,"hideEnablePrompt",()=>{(0,this.props.appContext.logEvent)({eventName:k.J.PFBetaSwitchONDismiss}),this.setState({isEnablePromptOpen:!1})}),c()(this,"disableBeta",()=>{var e=this.props,t=e.postFormContext,s=t.canPost,o=t.saving;if((0,e.appContext.logEvent)({eventName:k.J.PFBetaSwitchOFF}),s&&!o){this.setState({isDisablePromptOpen:!0});return}this.doDisableBeta()}),c()(this,"enableBeta",()=>{(0,this.props.appContext.logEvent)({eventName:k.J.PFBetaSwitchON}),this.setState({isEnablePromptOpen:!0})}),c()(this,"doEnableBeta",()=>{var e=this.props.appContext,t=e.toggleEditorBeta,s=e.setCookie,o=e.logEvent,n=this.state.hasToggledBefore;return this.apiHelper.enableDesktopEditor().fetch().then(()=>{t(),o({eventName:k.J.PFBetaSwitchONConfirm}),n||s(S.zC.EDITOR_BETA_TOGGLED,S.Ox)})}),c()(this,"doDisableBetaAndLog",()=>((0,this.props.appContext.logEvent)({eventName:k.J.PFBetaSwitchOFFConfirm}),this.doDisableBeta())),c()(this,"doDisableBeta",()=>{var e=this.props.appContext.toggleEditorBeta;return this.apiHelper.disableDesktopEditor().fetch().then(()=>{e()})})}componentDidMount(){var e=this.props.appContext,t=e.getCookie,s=e.setCookie,o=e.features,n=o.redpopDesktopEditorBeta,a=o.legacyEditorAccess,r=t(S.zC.EDITOR_BETA_TOGGLED)===S.Ox,i=!!a&&t(S.zC.EDITOR_GUTENBERG_TOGGLED)!==S.R0;r&&this.setState({hasToggledBefore:!0}),n&&(this.setState({isFirstUse:!r,isInfoPopoverOpen:!r,isGutenbergInfoPopoverOpen:!1,hasToggledBefore:!0,isGutenbergActive:i}),r||s(S.zC.EDITOR_BETA_TOGGLED,S.Ox))}render(){return(0,B.jsx)(T.ZP,{children:e=>{var t=e.isMobile;return this.renderContent(t)}})}}let R=(0,I.X9)(D,{appContext:!0,postFormContext:!0});var Z=s(6135),O=s(17276),L=s.n(O),U=s(93804),M=s(12968),_=s(90127),$=s(34438),z=s(55673),H=s(78667),V=e=>{var t=e.blog,s=e.isNew,o=e.postId,n=e.postStatus,a=e.communityId,r=(0,H.bp)().logEvent,i=(0,T.v$)().isMobile,d=(0,M.F)().data;return(0,l.useEffect)(()=>{r({eventName:k.J.AfterPostBannerView,eventDetails:{isNewPost:s,isMobile:i,postStatus:n}})},[i,s,r,n]),(0,B.jsxs)(z.rU,{to:"scheduled"===n||"queue"===n?(0,_.Kt)({blogName:t.name}):a?(0,U.j0)({communityId:a}):(0,$.SS)({peeprBlogname:t.name,peeprPostId:o}),style:{textDecoration:"none"},children:[(()=>{var e=t.name,o=(0,B.jsx)("b",{});if("queue"===n)return(0,B.jsx)(w.ZP,{comment:"A message to tell the user their post has been succesfully queued",params:{blogName:e},components:{bold:o},children:"Queued to [bold][blogName][/bold]"});if("scheduled"===n)return(0,B.jsx)(w.ZP,{comment:"A message to tell the user their post has been succesfully scheduled",params:{blogName:e},components:{bold:o},children:"Scheduled to [bold][blogName][/bold]"});if("now"===n&&!s){if(a){var r=null==d?void 0:d.find(e=>e.name===a);if(r)return(0,B.jsx)(w.ZP,{comment:"A message to tell the user their post has been succesfully reblogged to a community",params:{communityName:r.title},components:{bold:o},children:"Reblogged to [bold][communityName][/bold]"})}return(0,B.jsx)(w.ZP,{comment:"A message to tell the user their post has been succesfully reblogged",params:{blogName:e},components:{bold:o},children:"Reblogged to [bold][blogName][/bold]"})}if(a&&s){var i=null==d?void 0:d.find(e=>e.name===a);if(i)return(0,B.jsx)(w.ZP,{comment:"A message to tell the user their post has been succesfully been posted to a community",params:{communityName:i.title},components:{bold:o},children:"Posted to  [bold][communityName][/bold]!"})}return(0,B.jsx)(w.ZP,{comment:"A message to tell the user their post has been succesfully posted",params:{blogName:e},components:{bold:o},children:"Posted to [bold][blogName][/bold]"})})()," →"]})},q=s(45222),W=s(16565),J=s(94133),G=s(24085),Q=s(5700),X=s(65551),Y=s(83932),K=s(89272),ee=s(9629),et=(0,l.lazy)(()=>Promise.all([s.e(5391),s.e(8399),s.e(9308),s.e(937),s.e(1304),s.e(812),s.e(3475),s.e(7286),s.e(319),s.e(3813)]).then(s.bind(s,97552))),es=()=>(0,B.jsx)("div",{className:ee.Z.blockEditorContainer,children:(0,B.jsx)("div",{className:ee.Z.loader,children:(0,B.jsx)(Z.Z,{color:A.paletteGray65})})}),eo=(0,l.forwardRef)((e,t)=>{var s,o=(0,X.m)(),a=o.postType,i=o.editablePost,d=o.isReblog,h=o.setEditorMode,c=(0,Y.rV)(),u=c.settings,m=c.isFetching,g=(0,l.useState)(!1),v=r()(g,2),b=v[0],f=v[1],x=(0,l.useRef)(null),C=(0,K.ZP)(x),P=!(null!=i&&null!==(s=i.content)&&void 0!==s&&s.length)&&!d;return(0,l.useEffect)(()=>{C(P,a)},[C,P,a]),(0,l.useEffect)(()=>{!m&&Number.isInteger(null==u?void 0:u.defaultPostFormat)&&(a===Q.hQ.Text&&(null==u?void 0:u.defaultPostFormat)!==0&&h((0,W.qU)(null==u?void 0:u.defaultPostFormat)),f(!0))},[m,a,h,null==u?void 0:u.defaultPostFormat]),(0,B.jsx)(J.Z,{fallback:(0,B.jsx)(es,{}),children:(0,B.jsx)("div",{className:p()(ee.Z.blockEditorContainer,{[ee.Z.japanese]:(null==u?void 0:u.language)===G.lI.Japanese,[ee.Z.korean]:(null==u?void 0:u.language)===G.lI.Korean,[ee.Z.chinese]:(null==u?void 0:u.language)===G.lI.ChineseSimplified||(null==u?void 0:u.language)===G.lI.ChineseTraditionalHongKong||(null==u?void 0:u.language)===G.lI.ChineseTraditionalTaiwan}),ref:x,children:b?(0,B.jsx)(et,n()(n()({},e),{},{forwardRef:t})):(0,B.jsx)(es,{})})})});eo.displayName="BlockEditor";var en=s(9156),ea=s(45051);let er={datetimePicker:"hp4db",input:"XkwKr",invalidAlert:"lXAhs"};class ei extends l.Component{constructor(){super(...arguments),c()(this,"memoGetDateStrFromDate",(0,en.Z)(this.getDateStrFromDate,{maxSize:50})),c()(this,"memoGet24HrTimeFromDate",(0,en.Z)(this.get24HrTimeFromDate,{maxSize:50})),c()(this,"state",{date:this.memoGetDateStrFromDate(this.props.initialDatetime),time:this.memoGet24HrTimeFromDate(this.props.initialDatetime),isInvalid:!1}),c()(this,"onDateChange",e=>{var t=e.currentTarget.value;return!!t&&this.setState({date:t},this.updateDatetime)}),c()(this,"onTimeChange",e=>{var t,s,o=e.currentTarget.value,n=!o;this.setState({isInvalid:n,time:o},this.updateDatetime),this.props.postFormContext.reportState(n?"busy":"ready"),n&&(null===(t=(s=this.props).onInvalid)||void 0===t||t.call(s))}),c()(this,"updateDatetime",()=>{var e,t=this.state,s=t.date,o=t.time,n=this.props.onChange;if(s&&o){var a=new Date(`${s}T${o}`);this.isDateValid(a)&&(e=a)}n(e)})}render(){var e=this.props,t=e.minDate,s=e.maxDate,o=this.props.appContext._c,n=this.state,a=n.date,r=n.time,i=this.memoGetDateStrFromDate(t),l=this.memoGetDateStrFromDate(s);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("div",{className:er.datetimePicker,children:[(0,B.jsx)("input",{"aria-label":o("Label for date picker","Date"),type:"date",min:i||void 0,max:l||void 0,onChange:this.onDateChange,value:a,className:er.input}),(0,B.jsx)("input",{"aria-label":o("Label for time picker","Time"),type:"time",onChange:this.onTimeChange,value:r,className:er.input,required:!0})]}),this.state.isInvalid&&(0,B.jsx)("div",{className:er.invalidAlert,children:(0,B.jsx)(w.ZP,{comment:"Error message for when the user enters an invalid time",children:"Please fill in a complete date and time"})})]})}getDateStrFromDate(e){if(!e)return"";var t=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),o=String(e.getFullYear()).padStart(4,"0");return`${o}-${t}-${s}`}get24HrTimeFromDate(e){if(!e)return"";var t=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0");return`${t}:${s}`}isDateValid(e){return!isNaN(e.getTime())}}c()(ei,"defaultProps",{onChange:ea.Z});var el=(0,I.X9)(ei,{appContext:!0,postFormContext:!0});class ed extends l.Component{render(){return(0,B.jsx)(el,n()({},this.props))}}c()(ed,"defaultProps",ei.defaultProps);var eh=s(93288),ec=s(93853),eu=s(48341),ep=s(29860),em=s(98384),eg=s(68384),ev=s(48803),eb=s(43452),ef=s(39277);let ex={postButtonPopoverWrapper:"sGolJ",postButtonList:"zFzSu",item:"yPzUb",itemOption:"MXQob",itemTitle:"NUymP",datetimePicker:"WCRxC",titleButton:"VxmZd",caretIcon:"qtKRw",postButtonWrapperNew:"xved4",caretButtonPopoverWrapper:"THaZ_",isDisabled:"LfOBx",checkmark:"rB3Ye"};class eC extends l.Component{constructor(){super(...arguments),c()(this,"state",{isPostOptOpenPopover:!1,isDatePickerVisible:this.props.formPostStatus===eb.$t.Scheduled}),c()(this,"initialPostStatus",this.props.formPostStatus),c()(this,"postNowLabel",(()=>{var e=this.props,t=e.formPostStatus,s=e.appContext._t,o=e.location.pathname;return s((0,_.LX)(o)?"Reblog":(0,_.hT)(o)&&t===eb.$t.Published?"Save":"Post now")})()),c()(this,"textMenuOptions",{[eb.$t.Now]:this.postNowLabel,[eb.$t.Published]:this.postNowLabel,[eb.$t.Queue]:this.props.appContext._t("Add to queue"),[eb.$t.Draft]:this.props.appContext._t("Save as draft"),[eb.$t.Private]:this.props.isAnswer?this.props.appContext._t("Answer privately"):this.props.appContext._t("Post privately"),[eb.$t.Scheduled]:this.props.appContext._t("Schedule")}),c()(this,"onClickButton",()=>this.props.onClickPostButton(this.props.formPostStatus)),c()(this,"togglePostOptionsOpen",()=>{this.props.avoidClosePostOpt||this.setState(e=>{var t=this.props.appContext.logEvent;return e.isPostOptOpenPopover||t({eventName:k.J.PFPostOptionOpen}),{isPostOptOpenPopover:!e.isPostOptOpenPopover}})}),c()(this,"renderCaret",()=>(0,B.jsx)(m.Z,{label:this.props.appContext._t("Open post state options"),className:ex.caretIcon,onClick:this.togglePostOptionsOpen,children:(0,B.jsx)(em.$S,{size:{width:11,height:11},useAltIcon:!0})})),c()(this,"renderPostOptions",()=>(0,B.jsx)("div",{className:ex.postButtonPopoverWrapper,children:(0,B.jsx)("ul",{className:ex.postButtonList,children:this.getMenuOptions().map(this.renderMenuOption)})})),c()(this,"renderMenuOption",e=>{var t=this.textMenuOptions[e],s=this.state.isDatePickerVisible,o=this.props.formPostStatus;return(0,B.jsxs)("li",{className:ex.item,role:"button",onClick:()=>this.onClickItem(e),children:[(0,B.jsxs)("div",{className:ex.itemOption,children:[(0,B.jsx)("div",{className:ex.checkmark,children:t===this.textMenuOptions[o]&&(0,B.jsx)(eg.Z,{size:ev.Gk,colors:{primary:E().paletteBlack}})}),(0,B.jsx)("span",{className:ex.itemTitle,children:t})]}),e===eb.$t.Scheduled&&s&&(0,B.jsx)("div",{className:ex.datetimePicker,children:this.props.onRenderDatePicker()})]},t)}),c()(this,"getMenuOptions",()=>{var e=this.props,t=e.isAnonymousAnswer,s=e.postFormContext.isMembersOnly;if([eb.$t.Published,eb.$t.Private].includes(this.initialPostStatus))return t||s?[eb.$t.Published]:[eb.$t.Published,eb.$t.Private];var o=[eb.$t.Published,eb.$t.Queue,eb.$t.Draft,eb.$t.Private,eb.$t.Scheduled];return(t||s)&&o.splice(o.indexOf(eb.$t.Private),1),o}),c()(this,"logPostStatusSelected",e=>{(0,this.props.appContext.logEvent)({eventName:{[eb.$t.Draft]:k.J.PFOptionsDraft,[eb.$t.Scheduled]:k.J.PFOptionsSchedule,[eb.$t.Private]:k.J.PFOptionsPrivate,[eb.$t.Queue]:k.J.PFOptionsQueue,[eb.$t.Published]:k.J.PFOptionsNow}[e]})}),c()(this,"onClickItem",e=>{this.props.onUpdatePostStatus(e),this.logPostStatusSelected(e),e===eb.$t.Scheduled?this.setState({isDatePickerVisible:!0}):(this.setState({isDatePickerVisible:!1}),this.togglePostOptionsOpen())})}render(){var e=this.props,t=e.formPostStatus,s=e.hideExtraOptions,o=e.buttonText,n=void 0===o?this.textMenuOptions[t]:o,a=this.state.isPostOptOpenPopover;return(0,B.jsxs)("div",{className:p()(ex.postButtonWrapperNew,{[ex.isDisabled]:this.props.disabled}),children:[(0,B.jsx)(m.Z,{disabled:this.props.disabled,wrapperClassName:ex.titleButton,onClick:this.onClickButton,children:n}),!s&&(0,B.jsx)(P.ZP,{isOpen:a,toggle:this.togglePostOptionsOpen,usePortals:!1,position:j.I2.Bottom,width:170,height:"auto",skipClickToOpen:!0,positionBasedOffsetModifiers:{[j.I2.Bottom]:{top:0,left:-60},[j.I2.Top]:{top:0,left:-60}},component:this.renderPostOptions(),targetWrapperClassName:ex.caretButtonPopoverWrapper,useFlex:!0,children:this.renderCaret()})]})}}let eP=(0,ef.Z)((0,I.X9)(eC,{appContext:!0,postFormContext:!0}));var ey=s(18599);let ew=e=>{var t=e.blog,s=e.blog.name,o=e.onCancel,a=e.onSwitchConfirm,r=(0,H.bp)(),i=r._t,d=r.getBrowserInfo,h=(0,l.useCallback)(()=>{a(t)},[t,a]),c={title:i("Switch blogs?"),body:(0,B.jsx)(w.ZP,{comment:"message detailing what will happen if the user switches blogs.",params:{blogName:s},components:{bold:(0,B.jsx)("b",{})},children:"[bold][blogName][/bold] does not have memberships enabled. Your post will be reverted back to public."}),className:p()("FpHvn",{dcMZs:(0,ey.EK)(d()),dCVVj:(0,ey._V)(d())}),buttonContainerClassname:"NeDTc",buttons:[{text:i("Cancel"),buttonStyle:x.X.Neutral,onClick:o},{text:i("Switch"),buttonStyle:x.X.Confirm,onClick:h}]};return(0,B.jsx)(g.Z,{isAboveOverlays:!0,centerContent:!0,onGlassClick:o,glassIsClickable:!0,children:(0,B.jsx)(x.O,n()({},c))})};var eT=s(83152),eS=s(49457);let ek=s.p+"src/assets/images/tour-guide/reblog-discovered-602331b4.svg";var ej=s(82145),eN=s(43906),eI=s(48352);let eA={container:"rGuEh",heading:"HfBSP",description:"pXvGc",button:"iDvug",headerImage:"dS2Oh"},eE=()=>{var e=(0,H.bp)().logEvent,t=(0,eN.g)(),s=t.rebloggingDiscovered,o=(0,t.shouldShowRebloggingDiscovered)(),n=()=>{s(),e({eventName:k.J.CTAClick,page:"TourGuideRebloggingDiscoveredView"})};return o?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(eI.Z,{page:"TourGuideRebloggingDiscoveredView"}),(0,B.jsx)(g.Z,{onGlassClick:s,glassIsClickable:!0,isAboveOverlays:!0,children:(0,B.jsx)(T.ZP,{children:e=>{var t=e.isMobile;return(0,B.jsxs)("div",{className:eA.container,children:[t&&(0,B.jsx)("img",{src:ek,className:eA.headerImage,alt:""}),(0,B.jsx)("h1",{className:eA.heading,children:(0,B.jsx)(w.ZP,{comment:"Tour guide, reblog discovered heading",components:{span:(0,B.jsx)("span",{})},children:"You discovered [span]reblogging[/span] \uD83D\uDE2F"})}),(0,B.jsx)("p",{className:eA.description,children:(0,B.jsx)(w.ZP,{comment:"Tour guide, reblog discovered text",components:{reblogIcon:(0,B.jsx)(ej.Z,{})},children:"Fancy a post? Tap or long-press on [reblogIcon][/reblogIcon] to make it appear on your blog. Add commentary, gifs, music, pictures, and more if you want, too ✏️✨"})}),(0,B.jsx)("button",{type:"button",onClick:n,className:eA.button,children:(0,B.jsx)(w.ZP,{comment:"Tour guide reblog discovered CTA",children:"Got it"})})]})}})})]}):null};var eF=s(65148),eB=s(93799),eD=s(1308),eR=s(68280),eZ=new Map,eO=s(399),eL=s(44561),eU=s(95867),eM=s(44663),e_=s(43747),e$=s(86033),ez=s(91949),eH=s(8737),eV=s(68782),eq=s(96467),eW=s.n(eq),eJ=s(21283),eG=s(46819),eQ=s(19299),eX=s(18488);let eY={lockIcon:"GXMvC",checkIcon:"zKe6J",menuToggleButton:"p55MQ",caret:"ngJkJ",menu:"FHPHy",menuHeader:"YD1sq",menuHeading:"QoqgE",helpLink:"Cn7qX",menuList:"WDrqA",menuItem:"QDAno",menuItemContents:"uMq0g",isDisabled:"_218E3",menuItemEveryone:"avbU8",menuItemIconWrapper:"gSgV3",menuCategoriesList:"II5tk",toggle:"b6iEO"},eK=function(e){var t,s=e.isActive,o=e.isLocked,n=e.isMenuOpen,a=e.numberOfSelectedCategories,r=e.onClick,i=e.disabled,l=(0,H.bp)()._c;return t=s?a?(0,B.jsxs)(w.M2,{comment:"Label on Community Labels dropdown button in post form, when at least one category (drug use, sexual themes, violence) is selected. The number indicates how many of those categories are selected.",number:a,children:[(0,B.jsx)(w.CJ,{children:"Mature + [number] more"}),(0,B.jsx)(w.CN,{children:"Mature + [number] more"})]}):(0,ez.id)("general",l).label:(0,B.jsx)(w.ZP,{comment:"Default value in Community Labels dropdown in post form",children:"For Everyone"}),(0,B.jsxs)(eX.Z,{wrapperClassName:eY.menuToggleButton,onClick:r,theme:"border",isRounded:!0,"aria-haspopup":"listbox","aria-expanded":n,disabled:i,label:"",children:[o&&(0,B.jsx)(eQ.Z,{className:eY.lockIcon}),t,o&&(0,B.jsx)("span",{className:"screenReaderOnly",children:(0,B.jsx)(w.ZP,{comment:"Label for lock icon on the post form Community Labels button",children:"(Community labels are locked on this post.)"})}),(0,B.jsx)(em.$S,{className:eY.caret,useAltIcon:!0})]})};function e0(){return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(eQ.Z,{className:eY.lockIcon}),(0,B.jsx)("span",{className:"screenReaderOnly",children:(0,B.jsx)(w.ZP,{comment:"Label for lock icon in post form Community Labels dropdown",children:"This option is selected. It is locked and cannot be deselected."})})]})}function e1(e){var t=e.label,s=e.isSelected,o=e.isLocked,n=e.onClick;return(0,B.jsxs)("button",{className:p()(eY.menuItemContents,eY.menuItemEveryone),onClick:n,role:"option","aria-selected":s,disabled:o,children:[(0,B.jsx)("span",{className:eY.menuItemIconWrapper,children:s&&!o&&(0,B.jsx)(eg.Z,{className:eY.checkIcon})}),(0,B.jsx)("span",{className:eY.menuItemLabel,children:t})]})}function e3(e){var t=e.label,s=e.isSelected,o=e.isLocked,n=e.onClick;return(0,B.jsxs)("button",{className:p()(eY.menuItemContents),onClick:n,role:"option","aria-selected":s,disabled:o,children:[(0,B.jsx)("span",{className:eY.menuItemIconWrapper,children:o?(0,B.jsx)(e0,{}):s?(0,B.jsx)(eg.Z,{className:eY.checkIcon}):null}),(0,B.jsx)("span",{className:eY.menuItemLabel,children:t})]})}function e2(e){var t=e.id,s=e.label,o=e.isSelected,n=e.isLocked,a=e.onClick,r=`menu-${t}-label`;return(0,B.jsxs)("label",{id:r,className:p()(eY.menuItemContents,{[eY.isDisabled]:n}),children:[(0,B.jsx)(y.Z,{className:eY.toggle,size:"small",checked:o,disabled:n,labelledBy:r,onChange:a,controlled:!0}),(0,B.jsx)("span",{className:eY.menuItemLabel,children:s})]})}function e5(e){var t,s=e.onChange,o=e.initial,a=e.disabled,i=(0,H.bp)()._c,d=(0,l.useState)(null!==(t=null==o?void 0:o.active)&&void 0!==t&&t),h=r()(d,2),c=h[0],u=h[1],m=(0,l.useState)(n()({drugUse:!1,violence:!1,sexualThemes:!1},null==o?void 0:o.categories)),g=r()(m,2),v=g[0],b=g[1],f=(0,l.useState)(!1),x=r()(f,2),C=x[0],y=x[1];(0,l.useEffect)(()=>{var e;u(null!==(e=null==o?void 0:o.active)&&void 0!==e&&e)},[null==o?void 0:o.active]),(0,l.useEffect)(()=>{b(n()(n()({},v),null==o?void 0:o.categories))},[null==o?void 0:o.categories]);var T=()=>y(!C),S=(0,l.useCallback)((e,t)=>()=>{var n={active:c,categories:v,reporter:(null==o?void 0:o.reporter)||"author"};if("general"===e){if("locked"===c)return;n.active="boolean"==typeof t?t:!c,!1===n.active&&(n.categories={drugUse:!1,violence:!1,sexualThemes:!1})}else{var a,r=null!==(a=n.categories[e])&&void 0!==a&&a;if("locked"===r)return;n.categories[e]=!r,(0,ez.Xg)(n.categories)&&(n.active=c||!0)}u(n.active),b(n.categories),s(n)},[o,v,c,s,null==o?void 0:o.active]),k=Object.entries(v),j=k.reduce((e,t)=>{var s=r()(t,2),o=(s[0],s[1]);return(0,ez.CS)(o)?e+1:e},0);return(0,B.jsx)(P.ZP,{height:"auto",width:250,isOpen:C,render:()=>(0,B.jsxs)("div",{className:eY.menu,role:"listbox",id:"community-labels-dropdown-menu",children:[(0,B.jsxs)("div",{className:eY.menuHeader,children:[(0,B.jsx)("label",{className:eY.menuHeading,htmlFor:"community-labels-dropdown-menu",children:(0,B.jsx)(w.ZP,{comment:"Title of post form Community Labels dropdown",children:"Community labels"})}),(0,B.jsx)("a",{href:eG.OR,target:"_blank",className:eY.helpLink,children:(0,B.jsx)(w.ZP,{comment:"Help link in post form Community Labels dropdown",children:"Help"})})]}),(0,B.jsxs)("ul",{className:eY.menuList,children:[(0,B.jsx)("li",{className:eY.menuItem,children:(0,B.jsx)(e1,{label:(0,B.jsx)(w.ZP,{comment:"Default value in post form Community Labels dropdown (no restrictions selected)",children:"For Everyone"}),isSelected:!1===c,isLocked:"locked"===c,onClick:S("general",!1)})}),(0,B.jsxs)("li",{className:eY.menuItem,children:[(0,B.jsx)(e3,{label:(0,ez.id)("general",i).label,isSelected:!1!==c,isLocked:"locked"===c,onClick:S("general",!0)}),(0,B.jsx)("ul",{className:p()(eY.menuList,eY.menuCategoriesList),children:k.map(e=>{var t=r()(e,2),s=t[0],o=t[1];return(0,B.jsx)("li",{className:eY.menuItem,children:(0,B.jsx)(e2,{id:s,label:(0,ez.id)(s,i).label,isSelected:(0,ez.CS)(o),isLocked:"locked"===o,onClick:S(s)})},s)})})]})]})]}),toggle:T,children:(0,B.jsx)(eK,{isMenuOpen:C,isActive:(0,ez.CS)(c),isLocked:"locked"===c,disabled:a,numberOfSelectedCategories:j,onClick:T})})}function e4(){return(0,B.jsx)("div",{className:"Cg39T",children:(0,B.jsx)(Z.Z,{centerOrientation:"horizontalAndVertical",color:E().paletteGray65})})}var e9=s(20069),e6=s(83134),e8=(0,b.q)("person-lock");e8.defaultProps={size:{width:24,height:24}};var e7=s(16558),te=s(9557);class tt extends l.Component{constructor(){super(...arguments),c()(this,"state",{selectedValue:"",isOpen:!1}),c()(this,"toggle",()=>this.setState(e=>({isOpen:!e.isOpen}))),c()(this,"toggleClose",()=>this.setState(()=>({isOpen:!1}))),c()(this,"renderMenu",()=>{var e=this.props,t=e.options,s=e.onClick,o=this.state.selectedValue,n=t.find(e=>e.value===o);return(0,B.jsx)("ul",{className:"X_YtI",children:t.map(e=>{var t=e.label,o=e.labelLong,a=e.value,r=e.icon;return(0,B.jsxs)("li",{role:"option","aria-selected":(null==n?void 0:n.value)===a,className:"OIL2C",onClick:()=>{this.setState(()=>({selectedValue:a})),s(a),this.toggleClose()},onKeyDown:()=>{this.setState(()=>({selectedValue:a})),s(a),this.toggleClose()},children:[r,(0,B.jsx)("div",{className:"ox5cL",children:o||t}),(null==n?void 0:n.value)===a&&(0,B.jsx)(eg.Z,{size:{width:10.8,height:8.09}})]},a)})})})}componentDidMount(){this.setState(()=>({selectedValue:this.props.initialValue}))}render(){var e=this.props,t=e.options,s=e.popoverProps,o=this.state,a=o.selectedValue,r=o.isOpen,i=t.find(e=>e.value===a);return(0,B.jsx)(P.ZP,n()(n()({height:"auto",width:250,targetStyles:{width:"100%"},position:j.I2.Bottom},s),{},{isOpen:r,popoverWrapperClassName:"jjHk8",render:this.renderMenu,toggle:this.toggle,children:(0,B.jsx)("button",{className:"sECH1",children:(0,B.jsxs)("div",{className:"LAF8V",children:[null==i?void 0:i.label,(0,B.jsx)(em.$S,{size:{width:11,height:11}})]})})}))}}var ts=s(14113),to=s(70505);let tn={buttonCog:"KSOyK",popoverContainer:"jRJAM",cogMobile:"urS4J",cogPopoverContainer:"qAw8X",labelContainer:"j_hg4",inputField:"fh0lY",valid:"iUWSl",error:"LnHCi",baseline:"UyWMO",labelItem:"NdpnG",row:"plse8",indented:"GziRJ",labelExplanation:"UrUlO",labelHeader:"LkNk1",toggleDescription:"RZleP",rightContainer:"KtqI4",ctaTextCode:"DiIxz",toggle:"HtFHk",dropdownContainer:"Svov1",popoverWrapper:"cMCtD",editorModeSelect:"SP12H"};class ta extends l.Component{constructor(){super(...arguments),c()(this,"state",{previousCtaTextCode:0}),c()(this,"renderCtaFields",()=>{var e=this.props,t=e.appContext,s=t._t,o=t.features.tspUiUpdate,n=e.postFormContext.editablePost,a=null==n?void 0:n.adsParams,r=(0,W.Um)(a);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("Call to Action")}),(0,B.jsxs)("div",{className:tn.rightContainer,children:[(0,B.jsx)(y.Z,{size:"small",checked:r,onChange:this.onToggleCtaChange,controlled:!0}),(0,B.jsx)("span",{className:tn.toggleDescription,children:s("Display a CTA")})]})]}),r&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("label",{className:p()(tn.labelContainer,tn.indented),children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("CTA Text")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("select",{id:"ctaText",className:tn.ctaTextCode,onChange:this.onCtaTextCodeChange,value:null==a?void 0:a.ctaTextCode,children:this.getCtaTextOptions()})})]}),o&&(0,B.jsxs)("label",{className:p()(tn.labelContainer,tn.indented),children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("CTA Button Color")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("input",{className:tn.inputField,onChange:this.onCtaButtonColorChange,type:"text",placeholder:s("Hex Value (#FFFFFF)"),value:(null==a?void 0:a.buttonBackgroundColor)||""})})]})]}),(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("CTA URLs")}),(0,B.jsxs)("div",{className:tn.rightContainer,children:[(0,B.jsx)(y.Z,{size:"small",checked:r,controlled:!0,disabled:!0}),(0,B.jsx)("span",{className:tn.toggleDescription,children:s("Set a redirect for clicks")})]})]}),r&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("label",{className:p()(tn.labelContainer,tn.indented),children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("Primary URL")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("input",{className:tn.inputField,onChange:this.onRedirectUrlPrimaryChange,type:"url",placeholder:"https://...",value:(null==a?void 0:a.redirectUrlPrimary)||""})})]}),(0,B.jsxs)("label",{className:p()(tn.labelContainer,tn.indented),children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("iOS URL")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("input",{className:tn.inputField,onChange:this.onRedirectUrlIosChange,type:"url",placeholder:"https://...",value:(null==a?void 0:a.redirectUrlIos)||""})})]}),(0,B.jsxs)("label",{className:p()(tn.labelContainer,tn.indented),children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("Android URL")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("input",{className:tn.inputField,onChange:this.onRedirectUrlAndroidChange,type:"url",placeholder:"https://...",value:(null==a?void 0:a.redirectUrlAndroid)||""})})]}),o&&(0,B.jsxs)("label",{className:p()(tn.labelContainer,tn.indented),children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("Display URL")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("input",{className:tn.inputField,onChange:this.onDisplayUrlChange,type:"url",placeholder:s("Shortened URL"),value:(null==a?void 0:a.displayUrl)||""})})]})]})]})}),c()(this,"renderBloglessAdvertiserFields",()=>{var e=this.props,t=e.appContext._t,s=e.postFormContext.editablePost,o=(null==s?void 0:s.adsParams)||{},n=o.bloglessIsLikeable,a=o.bloglessIsRebloggable;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsx)("span",{className:tn.labelItem,children:t("Allow likes")}),(0,B.jsxs)("div",{className:tn.rightContainer,children:[(0,B.jsx)(y.Z,{className:tn.bloglessIsLikeable,size:"small",checked:void 0===n||n,onChange:this.onToggleBloglessIsLikeable,controlled:!0}),(0,B.jsx)("span",{className:tn.toggleDescription,children:t("Allow likes")})]})]}),(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsx)("span",{className:tn.labelItem,children:t("Allow reblogs")}),(0,B.jsxs)("div",{className:tn.rightContainer,children:[(0,B.jsx)(y.Z,{size:"small",className:tn.bloglessIsRebloggable,checked:void 0===a||a,onChange:this.onToggleBloglessIsRebloggable,controlled:!0}),(0,B.jsx)("span",{className:tn.toggleDescription,children:t("Allow reblogs")})]})]}),(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsx)("span",{className:tn.labelItem,children:t("Brand avatar URL")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("input",{className:tn.inputField,onChange:this.onBrandAvatarUrlChange,type:"url",placeholder:t("URL for avatar"),value:(null==o?void 0:o.brandAvatarUrl)||""})})]})]})}),c()(this,"getCtaTextOptions",()=>{var e=this.props,t=e.appContext,s=t._c,o=t.features.tspUiUpdate,n=e.postFormContext.editablePost,a=null==n?void 0:n.adsParams;return[{value:0,label:s("CTA label on ad","Learn more"),enabled:!0},{value:1,label:s("CTA label on ad","Contact us"),enabled:!0},{value:2,label:s("CTA label on ad","Shop now"),enabled:!0},{value:3,label:s("CTA label on ad","Sign up"),enabled:!0},{value:4,label:s("CTA label on ad","Watch more"),enabled:!0},{value:5,label:s("CTA label on ad","Subscribe"),enabled:!0},{value:6,label:s("CTA label on ad","Book now"),enabled:!0},{value:7,label:s("CTA label on ad","Apply now"),enabled:!0},{value:8,label:s("CTA label on ad","Get quote"),enabled:!0},{value:9,label:s("CTA label on ad","Donate now"),enabled:!0},{value:10,label:s("CTA label on ad","Click to Begin"),enabled:!0},{value:11,label:s("CTA label on ad","Download"),enabled:!1},{value:12,label:s("CTA label on ad","Install"),enabled:!1},{value:13,label:s("CTA label on ad","Play now"),enabled:!1},{value:14,label:s("CTA label on ad","Play game"),enabled:!1},{value:15,label:s("CTA label on ad","Watch now"),enabled:!0},{value:16,label:s("CTA label on ad","Get showtimes"),enabled:!1},{value:17,label:s("CTA label on ad","Get offer"),enabled:!1},{value:18,label:s("CTA label on ad","See menu"),enabled:!1},{value:19,label:s("CTA label on ad","Listen now"),enabled:!0},{value:20,label:s("CTA label on ad","Open link"),enabled:!1},{value:21,label:s("CTA label on ad","Order now"),enabled:!1},{value:22,label:s("CTA label on ad","Get access"),enabled:!1},{value:23,label:s("CTA label on ad","Get tickets"),enabled:!0},{value:25,label:s("CTA label on ad","Download now"),enabled:!0},{value:26,label:s("CTA label on ad","Install now"),enabled:!0},{value:27,label:s("CTA label on ad","See more"),enabled:!0},{value:28,label:s("CTA label on ad","Watch the Promo"),enabled:!0},{value:29,label:s("CTA label on ad","Follow the Blog"),enabled:!0}].map(e=>{var t=e.value,s=e.label,n=e.enabled;return o||n?(0,B.jsx)("option",{value:t,"aria-selected":(null==a?void 0:a.ctaTextCode)===t,children:s},t):null})}),c()(this,"onAdsParamsChange",e=>{var t=this.props.postFormContext,s=t.updateEditablePost,o=t.editablePost,a=null==o?void 0:o.adsParams;s(n()(n()({},o),{},{adsParams:n()(n()({},a),e)}))}),c()(this,"onToggleCtaChange",()=>{var e=this.props.postFormContext.editablePost,t=null==e?void 0:e.adsParams;if((0,W.Um)(t)){this.setState({previousCtaTextCode:Number(null==t?void 0:t.ctaTextCode)},()=>this.onAdsParamsChange({ctaTextCode:"",tspSkipLightbox:!1}));return}this.onAdsParamsChange({ctaTextCode:this.state.previousCtaTextCode,tspSkipLightbox:!0})}),c()(this,"onBrandAvatarUrlChange",e=>this.onAdsParamsChange({brandAvatarUrl:e.currentTarget.value})),c()(this,"onCtaTextCodeChange",e=>this.onAdsParamsChange({ctaTextCode:e.currentTarget.value})),c()(this,"onCtaButtonColorChange",e=>{var t=e.currentTarget.value.trim();this.onAdsParamsChange(n()({buttonBackgroundColor:t,buttonBorderColor:t},to.N5.test(t)&&{buttonTextColor:(0,to.YK)(t)}))}),c()(this,"onDisplayUrlChange",e=>this.onAdsParamsChange({displayUrl:e.currentTarget.value.trim()})),c()(this,"onRedirectUrlPrimaryChange",e=>this.onAdsParamsChange({redirectUrlPrimary:e.currentTarget.value.trim()})),c()(this,"onRedirectUrlIosChange",e=>this.onAdsParamsChange({redirectUrlIos:e.currentTarget.value.trim()})),c()(this,"onRedirectUrlAndroidChange",e=>this.onAdsParamsChange({redirectUrlAndroid:e.currentTarget.value.trim()})),c()(this,"onToggleBloglessIsLikeable",()=>{var e=this.props.postFormContext.editablePost,t=((null==e?void 0:e.adsParams)||{}).bloglessIsLikeable;this.onAdsParamsChange({bloglessIsLikeable:!(void 0===t||t)})}),c()(this,"onToggleBloglessIsRebloggable",()=>{var e=this.props.postFormContext.editablePost,t=((null==e?void 0:e.adsParams)||{}).bloglessIsRebloggable;this.onAdsParamsChange({bloglessIsRebloggable:!(void 0===t||t)})})}render(){var e=this.props,t=e.appContext._t,s=e.postFormContext,o=s.selectedBlog,n=s.isReblog;return(null!=o&&o.isPremiumPartner||null!=o&&o.isBloglessAdvertiser)&&!n?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("label",{className:tn.labelContainer,children:(0,B.jsx)("span",{className:tn.labelHeader,children:t("Advertiser Controls")})}),this.renderCtaFields(),(null==o?void 0:o.isBloglessAdvertiser)&&this.renderBloglessAdvertiserFields()]}):null}}let tr=(0,I.X9)(ta,{appContext:!0,postFormContext:!0});var ti=s(35215);let tl=()=>{var e=(0,H.bp)(),t=e._c,s=e._t,o=e.logEvent,a=e.features.dsaArticle26MarkPostAsCommercial,i=(0,X.m)(),d=i.editorMode,h=i.setEditorMode,c=i.updateEditablePost,u=i.editablePost,v=i.formPostStatus,b=i.isReblog,f=i.isAsk,x=i.selectedBlog,C=(0,ti.Q)((null==x?void 0:x.name)||"").data,P=(0,l.useState)(!1),S=r()(P,2),N=S[0],I=S[1],A=()=>I(e=>!e),F=()=>(0,B.jsx)(m.Z,{wrapperClassName:tn.buttonCog,label:s("Settings"),onClick:A,children:(0,B.jsx)(e7.Z,{useAltIcon:!0,size:{width:20,height:20},colors:{primary:E().paletteGray65}})}),D=()=>(null==u?void 0:u.canBeTipped)!==null&&(null==u?void 0:u.canBeTipped)!==void 0?null==u?void 0:u.canBeTipped:(null==x?void 0:x.tippingPostsDefault)!==null&&(null==x?void 0:x.tippingPostsDefault)!==void 0?null==x?void 0:x.tippingPostsDefault:void 0,R=e=>{var o=null==u?void 0:u.sourceUrlRaw,n=null==u?void 0:u.slug,r=Q(),i=D();return(0,B.jsx)("div",{className:p()({[tn.popoverContainer]:e,[tn.cogMobile]:e}),children:(0,B.jsxs)("div",{className:tn.cogPopoverContainer,children:[(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("Custom URL")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("input",{className:tn.inputField,name:"custom URL","aria-label":s("Custom URL"),onChange:_,placeholder:"/post/123/",value:n})})]}),!b&&(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("Content source")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)("input",{className:p()(tn.inputField,{[tn.valid]:r,[tn.error]:!!o&&!r}),onChange:M,name:"content-source-field","aria-label":s("Content source"),type:"url",placeholder:"https://...",value:o})})]}),Y()&&(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsx)("span",{className:tn.labelItem,id:"allowTippingToggle",children:s("Allow tipping")}),(0,B.jsx)("div",{className:tn.rightContainer,children:(0,B.jsx)(y.Z,{className:tn.toggle,size:"small",checked:i,onChange:J,controlled:!1,labelledBy:"allowTippingToggle"})})]}),(0,B.jsxs)("label",{className:tn.labelContainer,children:[(0,B.jsxs)("span",{className:tn.labelItem,children:[(0,B.jsx)("span",{className:tn.labelItem,children:s("Post date")}),(0,B.jsx)("br",{}),(0,B.jsx)("span",{className:tn.labelExplanation,children:s("Set date of publishing to a time in the past.")})]}),(0,B.jsx)("div",{className:tn.rightContainer,children:U()})]}),!b&&(0,B.jsxs)("label",{htmlFor:"privacyControlsDropdown",className:tn.labelContainer,children:[(0,B.jsxs)("span",{className:tn.labelItem,children:[(0,B.jsx)("div",{className:tn.row,children:(0,B.jsx)("span",{className:tn.labelItem,children:s("Who can reblog?")})}),(0,B.jsx)("span",{className:tn.labelExplanation,children:s("Choose who can reblog this post. Anyone mentioned can always reblog.")})]}),(0,B.jsx)("div",{className:tn.dropdownContainer,children:O()})]}),(null==C?void 0:C.interactabilityBlaze)!==void 0&&!b&&(0,B.jsxs)("label",{htmlFor:"blazableByOthersControlsDropdown",className:tn.labelContainer,children:[(0,B.jsxs)("span",{className:tn.labelItem,children:[(0,B.jsx)("div",{className:tn.row,children:(0,B.jsx)("label",{className:tn.labelItem,htmlFor:"blazable-by-others",children:t("Post level toggle to Allow Blaze by others","Who can Blaze?")})}),(0,B.jsx)("span",{className:tn.labelExplanation,children:t("Description for the Allow Blaze by others Post level toggle","Decide if this post can be sponsored by others. You’ll be able to stop it any time.")})]}),(0,B.jsx)("div",{className:tn.dropdownContainer,children:L()})]}),(0,B.jsxs)("label",{className:p()(tn.labelContainer,tn.baseline),htmlFor:"editorModeSetting",children:[(0,B.jsxs)("div",{className:tn.labelItem,children:[(0,B.jsx)("div",{className:tn.row,children:s("Text Editor")}),(0,B.jsx)("div",{className:tn.row,children:(0,B.jsx)("span",{className:tn.labelExplanation,children:t("Disclaimer on post form settings.",'Switching to the HTML editor may break some post formatting, including the "Read more" link.')})})]}),(0,B.jsx)("div",{className:tn.dropdownContainer,children:Z()})]}),a&&(0,B.jsxs)("label",{className:tn.labelContainer,htmlFor:"editorModeSetting",children:[(0,B.jsx)("div",{className:tn.labelItem,children:(0,B.jsx)("div",{className:tn.row,children:(0,B.jsx)("span",{className:tn.labelItem,children:t("Label on post header indicating that this post has commercial content.","Contains commercial content")})})}),(0,B.jsx)("div",{className:tn.dropdownContainer,children:(0,B.jsx)(y.Z,{onChange:q,checked:null==u?void 0:u.isCommercial})})]}),(0,B.jsx)(tr,{})]})})},Z=()=>(0,B.jsxs)(ts.Z,{id:"editorModeSetting",className:tn.editorModeSelect,onChange:W,defaultValue:d||"richText",children:[(0,B.jsx)("option",{value:"richText",children:s("Rich text")}),(0,B.jsx)("option",{value:"html",children:s("HTML")}),(0,B.jsx)("option",{value:"markdown",children:s("Markdown")})]}),O=()=>{var e=(null==u?void 0:u.interactabilityReblog)||"everyone",t=[{label:(0,B.jsx)(w.ZP,{children:"Anyone"}),labelLong:(0,B.jsx)(w.ZP,{children:"Anyone (on Tumblr)"}),value:"everyone",icon:(0,B.jsx)(e6.Z,{})},{label:(0,B.jsx)(w.ZP,{comment:"One of the reblog options for a post, no one can reblog this post",children:"No one"}),value:"noone",icon:(0,B.jsx)(e8,{})}];return(null==u?void 0:u.interactabilityReblog)==="those_i_follow"&&G({interactabilityReblog:"everyone"}),(0,B.jsx)(tt,{onClick:z,options:t,initialValue:e})},L=()=>{var e=(null==u?void 0:u.interactabilityBlaze)||(null==C?void 0:C.interactabilityBlaze)||"everyone",t=[{label:(0,B.jsx)(w.ZP,{children:"Anyone"}),labelLong:(0,B.jsx)(w.ZP,{children:"Anyone (on Tumblr)"}),value:"everyone",icon:(0,B.jsx)(e6.Z,{})},{label:(0,B.jsx)(w.ZP,{comment:"One of the Blaze by others options for a post, just me can Blaze this post",children:"Just me"}),value:"noone",icon:(0,B.jsx)(e8,{})}];return(0,B.jsx)(tt,{onClick:V,options:t,initialValue:e})},U=()=>{var e;return e=null!=u&&u.timestamp?1e3*u.timestamp:Date.now(),(0,B.jsx)(ed,{initialDatetime:new Date(e),maxDate:new Date(Date.now()),onChange:$})},M=e=>G({sourceUrlRaw:e.currentTarget.value,sourceUrl:e.currentTarget.value}),_=e=>G({slug:e.currentTarget.value}),$=e=>e&&G({date:e.toISOString(),timestamp:e.getTime()/1e3}),z=e=>G({interactabilityReblog:e}),V=e=>G({interactabilityBlaze:e}),q=e=>{G({isCommercial:e.target.checked})},W=e=>{o({eventName:k.J.EditorModeChange,eventDetails:{mode:e.target.value}}),h(e.target.value)},J=e=>(o({eventName:k.J.TipPostToggle,eventDetails:{enabled:e.currentTarget.checked}}),G({canBeTipped:e.currentTarget.checked})),G=e=>c(n()(n()({},u),e)),Q=()=>(0,e_.Z)(null==u?void 0:u.sourceUrlRaw),Y=()=>!!(null!=x&&x.isTippingOn)&&(null==x||!x.isPrivateChannel)&&"private"!==v&&!b&&!f;return(0,B.jsx)(T.ZP,{children:e=>{var t=e.isMobile;return t?(0,B.jsxs)(B.Fragment,{children:[F(),N&&(0,B.jsx)(g.Z,{onGlassClick:A,children:R(t)})]}):(0,B.jsx)("div",{className:tn.popoverContainer,children:(0,B.jsx)(te.Z,{usePortals:!0,width:"auto",height:"auto",maxHeight:"60vh",position:j.I2.BottomEnd,component:R(),popoverWrapperClassName:tn.popoverWrapper,children:F()})})}})};var td=s(68144),th=s(70648),tc=(0,b.q)("memberships-creator-snowman");tc.defaultProps={size:{width:20,height:20}};var tu=s(52153);let tp={selectorWrapper:"DEMhG",buttonText:"nEri3",popoverWrapper:"JqjhZ",selectorContent:"cqMTu",contentRowWrapper:"ahRz7",contentTitle:"E6wiR",contentRow:"KMfGO",dropdownEarthIcon:"BW8fX",dropdownMemberIcon:"_Vn_r",dropdownIconBackground:"NnzIP",dropdownEarthBackground:"VTRwc",dropdownMemberBackground:"oO9Xr",nonIconContent:"YHjrJ",dropdownText:"vYbL6"},tm=()=>{var e=(0,X.m)(),t=e.isMembersOnly,s=e.setIsMembersOnly,o=e.setFormPostStatus,n=e.formPostStatus,a=(0,l.useState)(!1),i=r()(a,2),d=i[0],h=i[1],c=(0,H.bp)(),u=c._t,g=c._c,v=c.logEvent,b=(0,l.useCallback)(()=>h(e=>!e),[]),f=(0,l.useCallback)(()=>{h(!1),s(!0),n===eb.$t.Private&&o(eb.$t.Published),v({eventName:k.J.PostpSetVisibility,eventDetails:{visibility:tu.pW.Supporters}})},[n]),x=(0,l.useCallback)(()=>{h(!1),s(!1),v({eventName:k.J.PostpSetVisibility,eventDetails:{visibility:tu.pW.Anyone}})},[]),C=g("Public, as in this post is viewable by anyone and not just viewable by the subscribers of this blog","Public"),y=g("As in this post should be is tagged 'for supporters only'","Supporters only"),T=(0,l.useMemo)(()=>(0,B.jsxs)("div",{className:tp.selectorContent,children:[(0,B.jsx)("div",{className:tp.contentTitle,children:(0,B.jsx)(w.ZP,{comment:"The title of a menu that lets the user select the viewing permissions of their post",children:"Who can see your post?"})}),(0,B.jsxs)(m.Z,{wrapperClassName:tp.contentRowWrapper,className:tp.contentRow,label:C,onClick:x,children:[(0,B.jsxs)("div",{className:tp.dropdownEarthIcon,children:[(0,B.jsx)("div",{className:p()(tp.dropdownIconBackground,tp.dropdownEarthBackground)}),(0,B.jsx)(th.Z,{})]}),(0,B.jsxs)("div",{className:tp.nonIconContent,children:[(0,B.jsxs)("div",{className:tp.dropdownText,children:[(0,B.jsx)("span",{children:C}),(0,B.jsx)("span",{children:(0,B.jsx)(w.ZP,{children:"Anyone on or off Tumblr."})})]}),!t&&(0,B.jsx)(eg.Z,{colors:{primary:E().paletteAccent},size:{width:16,height:16}})]})]}),(0,B.jsxs)(m.Z,{wrapperClassName:tp.contentRowWrapper,className:tp.contentRow,label:y,onClick:f,children:[(0,B.jsxs)("div",{className:tp.dropdownMemberIcon,children:[(0,B.jsx)("div",{className:p()(tp.dropdownIconBackground,tp.dropdownMemberBackground)}),(0,B.jsx)(tc,{})]}),(0,B.jsxs)("div",{className:tp.nonIconContent,children:[(0,B.jsxs)("div",{className:tp.dropdownText,children:[(0,B.jsx)("span",{children:y}),(0,B.jsx)("span",{children:(0,B.jsx)(w.ZP,{children:"Your Post+ subscribers."})})]}),t&&(0,B.jsx)(eg.Z,{colors:{primary:E().paletteAccent},size:{width:16,height:16}})]})]})]}),[t,n]);return(0,B.jsx)(P.ZP,{isOpen:d,toggle:b,component:T,width:312,height:"auto",popoverWrapperClassName:tp.popoverWrapper,targetStyles:{flex:0},position:"bottom-end",usePortals:!0,children:(0,B.jsx)(m.Z,{className:tp.selectorWrapper,label:u("Open the post membership settings"),children:t?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(tc,{}),(0,B.jsx)("span",{className:tp.buttonText,children:(0,B.jsx)(w.ZP,{comment:"As in this post should be is tagged 'for supporters only'",children:"Supporters"})}),(0,B.jsx)(td.nT,{useAltIcon:!0})]}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(th.Z,{useAltIcon:!0}),(0,B.jsx)("span",{className:tp.buttonText,children:C}),(0,B.jsx)(td.nT,{useAltIcon:!0})]})})})},tg={menuContainer:"kCzoF",menuInnerContainer:"oehtt",blogSelectorContainer:"APZ53",cogContainer:"iszjU",blogAttribution:"mxuVb",reblogAttribution:"XHk2S",mobileCloseBar:"gmJmv",mobileCloseButton:"CwjfM"},tv=e=>{var t=e.blogs,s=e.hideMemberships,o=e.hideBlogName,n=e.reblogFromName,a=e.disableSelection,r=void 0!==a&&a,i=e.isAnswer,l=e.onClickClose,d=e.communityId,h=e.showCommunitiesEditor,c=e.onCommunityChange,u=(0,T.v$)(),p=u.isMobile,g=u.isSmartphone,b=(0,H.bp)(),f=b._t,x=b.features,C=(0,X.m)(),P=C.selectedBlog,y=C.updateSelectedBlog,w=C.editablePost;return(0,B.jsxs)("div",{className:tg.menuContainer,children:[g&&(0,B.jsx)("div",{className:tg.mobileCloseBar,children:(0,B.jsx)(m.Z,{label:f("Close"),wrapperClassName:tg.mobileCloseButton,onClick:()=>l(),children:(0,B.jsx)(v.Z,{size:{width:14,height:14}})})}),(0,B.jsxs)("div",{className:tg.menuInnerContainer,children:[!!P&&(0,B.jsxs)("div",{className:tg.blogAttribution,children:[(0,B.jsx)("div",{className:tg.blogSelectorContainer,children:r?(0,B.jsx)("div",{className:tg.selectedBlogName,children:void 0!==o&&o?f("Anonymous"):P.name}):(0,B.jsx)(e9.ZP,{selectedBlog:P,blogs:t,onClickSelectedBlog:y,displayAvatar:p,avatarDimension:eW().postFormBlogSelectorHeight,align:"left",textColor:E().paletteBlack,showCommunitiesEditor:h,communityId:d,onCommunityChange:c,postAuthor:null==w?void 0:w.postAuthor})}),n&&(0,B.jsxs)("div",{className:tg.reblogAttribution,children:[(0,B.jsx)(ej.Z,{isCompact:!0}),(0,B.jsx)("div",{className:tg.rebloggedFromName,children:n})]})]}),!r&&!(void 0!==s&&s)&&x.paywallCreation&&!(void 0!==i&&i)&&!n&&!p&&(null==P?void 0:P.isPaywallOn)&&(0,B.jsx)(tm,{}),(0,B.jsx)("div",{className:tg.cogContainer,children:(0,B.jsx)(tl,{})})]})]})};var tb=s(60085),tf=s(44655),tx=s(30232),tC=s(67615),tP=s(38740);let ty={tagContainer:"sHSSD",tagButton:"akmAa",tag:"aLlJL",editableTag:"unn5w",removeTagButton:"nsLCV"},tw=e=>{var t=e.tag,s=e.selected,o=e.className,n=e.index,a=e.isDragging,r=e.removeTagByIndex,i=e.onFocus,l=e.onChange,d=e.onChangeError,h=e.tagRef,c=(0,H.bp)()._t;return t?(0,B.jsx)("span",{className:p()(ty.tagContainer,o,{[ty.isDragging]:a,[ty.selected]:s}),children:(0,B.jsx)("span",{role:"button",tabIndex:-1,className:ty.tagButton,children:(0,B.jsxs)("span",{className:ty.tag,children:[(0,B.jsx)("span",{className:ty.editableTag,contentEditable:!0,onClick:e=>{e.stopPropagation()},onKeyDown:e=>{var t=e.currentTarget.innerText;if(e.key===ec.SV.Enter){e.preventDefault(),l(n,t);return}var s=ec.SV.Left,o=ec.SV.Right,a=ec.SV.Tab,r=ec.SV.Backspace,i=ec.SV.Delete;t.length>=tI&&![s,o,a,r,i].includes(e.key)&&(e.preventDefault(),d())},onBlur:e=>{l(n,e.currentTarget.innerText)},role:"textbox",suppressContentEditableWarning:!0,ref:h,tabIndex:0,children:t}),(0,B.jsx)(m.Z,{label:c("Remove tag"),wrapperClassName:ty.removeTagButton,onClick:e=>r(n,e),onFocus:()=>i(n),children:(0,B.jsx)(v.Z,{size:{height:10,width:10},colors:{primary:E().paletteBlack}})})]})})}):null},tT={beingDragged:"yCyjX",dragClone:"hx2Dc"};class tS extends l.Component{constructor(){super(...arguments),c()(this,"state",{selectedTagIndex:null,activeDrag:!1}),c()(this,"tagRefs",[]),c()(this,"unselectAnyTags",()=>this.updateSelectedTagIndex(null)),c()(this,"selectLastTag",()=>this.props.tags.length&&this.focusTagByIndex(this.props.tags.length-1)),c()(this,"onDragStart",()=>{this.setState({activeDrag:!0})}),c()(this,"onDragEnd",e=>{this.setState({activeDrag:!1}),this.props.onDragEnd(e)}),c()(this,"focusLeft",()=>{var e=this.props.onUnfocusLastTag,t=this.state.selectedTagIndex;this.hasSelectedTag()&&0!==t?this.focusTagByIndex(t-1):(this.unselectAnyTags(),e())}),c()(this,"focusRight",()=>{var e=this.props,t=e.tags,s=e.onUnfocusLastTag,o=this.state.selectedTagIndex;o===t.length-1?(this.unselectAnyTags(),s()):this.hasSelectedTag()&&this.focusTagByIndex(o+1)}),c()(this,"focusTagByIndex",e=>{null===e?this.unselectAnyTags():this.placeCaretAtEndOfTheTag(e)}),c()(this,"placeCaretAtEndOfTheTag",e=>{var t=window.getSelection(),s=document.createRange();null==t||t.removeAllRanges(),s.selectNodeContents(this.tagRefs[e]),s.collapse(!1),null==t||t.addRange(s),this.updateSelectedTagIndex(e),this.tagRefs[e].focus()}),c()(this,"updateSelectedTagIndex",e=>{this.props.onFocus(e),this.setState({selectedTagIndex:e})}),c()(this,"hasSelectedTag",()=>null!==this.state.selectedTagIndex)}render(){var e=this.props,t=e.tags,s=e.removeTagByIndex,o=e.onChange,n=e.onChangeError;return(0,B.jsxs)(J.Z,{fallback:null,children:[(0,B.jsx)(tP.e.Consumer,{children:e=>{var t=e.hotkeyWrapper;return t&&(0,B.jsx)(t,{shouldRenderHotkeyComponent:this.hasSelectedTag(),shouldDisableParentControlOfHotkeys:!0,shouldDisableEnterAsSubmit:!0,children:(0,B.jsx)(ec.ZP,{disableAllButMyHotkeys:!0,hotkey:[{key:ec.SV.Left,command:this.focusLeft,allowInputs:!0},{key:ec.SV.Right,command:this.focusRight,allowInputs:!0}]})})}}),(0,B.jsx)(tC.Z,{id:"selected-tags",options:{animation:150,onEnd:this.onDragEnd,onStart:this.onDragStart,delayOnTouchOnly:!0,delay:150,ghostClass:tT.beingDragged,chosenClass:tT.chosen,dragClass:tT.dragClone,direction:"horizontal",swapThreshold:.75,dragoverBubble:!0,removeCloneOnHide:!1},onChange:ea.Z,children:t.map((e,t)=>(0,B.jsx)(tw,{tag:e,index:t,isDragging:this.state.activeDrag,tagRef:e=>this.tagRefs[t]=e,removeTagByIndex:s,onFocus:this.updateSelectedTagIndex,onChange:o,onChangeError:n},e))})]})}}let tk={tagSuggestionWrapper:"aIJXD",selected:"fLsNs",tagSuggestion:"TBq8Z",searchedTextInSuggestion:"l2NHX"};var tj=e=>{var t=e.suggestion,s=e.isSelected,o=e.isFocused,n=e.onSelection,a=e.searchText,r=(0,l.useCallback)(()=>n(t),[n,t]),i=(0,l.createRef)();(0,l.useEffect)(()=>{if(o){var e;null==i||null===(e=i.current)||void 0===e||e.focus()}});var d=[t],h=t.toLowerCase().indexOf(a.toLowerCase()),c=h+a.length;if(-1!==h){var u=t.substring(0,h),g=t.substring(h,c),v=t.substring(c);d=[u,(0,B.jsx)("span",{className:tk.searchedTextInSuggestion,children:g},"textMatch"),v]}return(0,B.jsx)(m.Z,{forwardedRef:i,label:t,wrapperClassName:p()(tk.tagSuggestionWrapper,{[tk.selected]:s}),className:tk.tagSuggestion,onClick:r,children:d},t)},tN={[j.I2.Bottom]:{top:40}},tI=140;class tA extends l.Component{constructor(){var e;super(...arguments),e=this,c()(this,"state",{inputValue:"",editorInputFocused:!1,isShowingSuggestions:!1,listTags:[],blogTags:[],selectedTagIndex:null}),c()(this,"tagSuggestionsFetch",null),c()(this,"initialTagsFetch",null),c()(this,"tagsEditorRef",(0,l.createRef)()),c()(this,"editorInputRef",(0,l.createRef)()),c()(this,"autocompleteSuggestionsRef",(0,l.createRef)()),c()(this,"selectedTagsRef",(0,l.createRef)()),c()(this,"tagLengthError",(0,eJ.Z)(()=>{var e=this.props;(0,e.toastContext.toggleToast)((0,e.appContext._t)("Ooops! Tags can only be 140 characters or less!"))},5e3,{trailing:!1})),c()(this,"hotkey",[{key:ec.SV.Tab,command:()=>{var e,t;null!==(e=this.autocompleteSuggestionsRef.current)&&void 0!==e&&e.shouldRenderHotkeyComponent()&&(null===(t=this.autocompleteSuggestionsRef.current)||void 0===t||t.unfocusAndClose())},allowInputs:!0,triggersDefault:!0},{key:ec.SV.Tab,modifiers:{[ec.TE.Shift]:!0},command:()=>{var e,t;null!==(e=this.autocompleteSuggestionsRef.current)&&void 0!==e&&e.shouldRenderHotkeyComponent()&&(null===(t=this.autocompleteSuggestionsRef.current)||void 0===t||t.unfocusAndClose())},allowInputs:!0,triggersDefault:!0}]),c()(this,"addTagFromInputOrParam",function(t){var s,o=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=t||(null===(s=e.autocompleteSuggestionsRef.current)||void 0===s?void 0:s.getSoftSelectedSuggestion())||e.state.inputValue;return e.addTags((0,tx.B)(n)).then(()=>o?e.focusEditorInput():Promise.resolve())}),c()(this,"getChipWidth",()=>{var e=this.props.tags,t=this.state,s=t.inputValue,o=t.editorInputFocused,n=t.isShowingSuggestions,a=t.selectedTagIndex,r=o||n||!!s.length,i=!o&&null===a&&!e.length&&!s.length;if(!r&&!this.shouldUseBasicPlaceholder()&&e.length>1)return"36px";var l=r?(0,W.mY)(s):(0,W.mY)(this.getPlaceholderText(i,e.length));return"auto"===l?l:`${l+32+1}px`}),c()(this,"getPlaceholderText",(e,t)=>{var s=this.props.appContext._c;return this.shouldUseBasicPlaceholder()?s("Placeholder text for user to add tags","#add tags"):e?s("Prompt user to insert the first tag","#add tags to help people find your post"):1===t?s("Prompt user to insert second tag","#add another tag"):s("Prompt user to insert more tags","+")}),c()(this,"shouldUseBasicPlaceholder",()=>{var e=this.props,t=e.appContext.labsSettings,s=e.postFormContext.isReblog,o=t.communities;return s||o}),c()(this,"handleOutsideFocusEvent",e=>{if(this.tagsEditorRef.current&&!this.tagsEditorRef.current.contains(e.target)){var t;null===(t=this.selectedTagsRef.current)||void 0===t||t.unselectAnyTags(),this.setState({isShowingSuggestions:!1})}}),c()(this,"onEditorInputChange",e=>{var t=e.currentTarget.value,s=(0,tx.B)(t);this.setState({isShowingSuggestions:!!t}),(0,tx.K)(t)?this.addTags(s):s.find(e=>e.length>tI)?this.tagLengthError():this.setState({inputValue:t},this.getTags)}),c()(this,"onEditorInputBlur",()=>this.setState({editorInputFocused:!1})),c()(this,"onEditorInputFocus",()=>{var e;this.setState({editorInputFocused:!0,isShowingSuggestions:!0}),null===(e=this.selectedTagsRef.current)||void 0===e||e.unselectAnyTags()}),c()(this,"focusEditorInput",()=>{var e;null===(e=this.editorInputRef.current)||void 0===e||e.focus(),this.getTags()}),c()(this,"changeSelectedTags",(e,t)=>{var s=this.props,o=s.tags,n=s.onChange,a=(0,tx.B)(t);n([...o.slice(0,e),...a,...o.slice(e+1,o.length)])}),c()(this,"addTags",function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=e.state.inputValue,n=e.props,a=n.tags,r=n.onChange,i=n.appContext.logEvent,l=[...new Set([...a,...t])];return r(l),new Promise(t=>{l.slice(a.length).map((e,t)=>{i({eventName:k.J.PFTagAdd,eventDetails:{tag:e,tag_count:a.length+1+t}})}),o!==s?e.setState({inputValue:s},t):t()})}),c()(this,"handleKeyDown",e=>{var t,s,o,n,a,r,i=this.props,l=i.tags,d=i.postFormContext,h=d.postIt,c=d.hotkeyModifier;if(!e.nativeEvent.isComposing){if(e.key===ec.SV.Escape&&null!==(t=this.autocompleteSuggestionsRef.current)&&void 0!==t&&t.shouldRenderHotkeyComponent()){e.nativeEvent.preventDefault(),e.nativeEvent.stopImmediatePropagation(),this.setState({isShowingSuggestions:!1});return}if(e.key===ec.SV.Down&&!(null!==(s=this.autocompleteSuggestionsRef.current)&&void 0!==s&&s.shouldRenderHotkeyComponent())){e.nativeEvent.preventDefault(),e.nativeEvent.stopImmediatePropagation(),this.setState({isShowingSuggestions:!0});return}if(e.key===ec.SV.Enter&&!(null!==(o=this.autocompleteSuggestionsRef.current)&&void 0!==o&&o.shouldRenderHotkeyComponent())){if(e[c]){h();return}this.addTagFromInputOrParam(null);return}if(e.key===ec.SV.Tab&&!(null!==(n=this.autocompleteSuggestionsRef.current)&&void 0!==n&&n.shouldRenderHotkeyComponent())&&""!==this.state.inputValue){e.nativeEvent.preventDefault(),this.addTagFromInputOrParam(null);return}if(this.inputSelectionAtStart())switch(e.key){case ec.SV.Backspace:l.length&&(e.preventDefault(),null===(r=this.selectedTagsRef.current)||void 0===r||r.selectLastTag());break;case ec.SV.Left:e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),null===(a=this.selectedTagsRef.current)||void 0===a||a.selectLastTag()}}}),c()(this,"reorderTags",e=>{var t,s=this.props,o=s.tags,n=s.onChange,a=e.oldIndex,r=e.newIndex,i=[...o],l=i.splice(a,1);i.splice(r,0,l[0]),n(i),null===(t=this.selectedTagsRef.current)||void 0===t||t.unselectAnyTags(),this.focusEditorInput()}),c()(this,"removeTagByIndex",(e,t)=>{null==t||t.stopPropagation();var s,o=this.props,n=o.tags,a=o.onChange,r=o.appContext.logEvent,i=[...n];i.splice(e,1),a(i),null===(s=this.selectedTagsRef.current)||void 0===s||s.unselectAnyTags(),this.focusEditorInput(),r({eventName:k.J.PFTagRemove,eventDetails:{tag:n[e],tag_count:i.length}})}),c()(this,"inputSelectionAtStart",()=>{var e;return this.state.editorInputFocused&&(null===(e=this.editorInputRef.current)||void 0===e?void 0:e.selectionEnd)===0}),c()(this,"getSearchTextFromSuggestion",e=>e),c()(this,"renderSuggestion",e=>(0,B.jsx)(tj,n()({},e))),c()(this,"getInitialTags",()=>{var e,t,s;return null===(e=this.initialTagsFetch)||void 0===e||e.cancel(),null!==(t=this.props.postFormContext)&&void 0!==t&&null!==(t=t.selectedBlog)&&void 0!==t&&t.name&&(this.initialTagsFetch=(0,e$.Z)((0,N.ZP)(this.props.appContext.apiFetch).getBlogTags(null===(s=this.props.postFormContext)||void 0===s||null===(s=s.selectedBlog)||void 0===s?void 0:s.name).fetch())),this.initialTagsFetch}),c()(this,"getTags",()=>{var e,t,s,o;return null===(e=this.tagSuggestionsFetch)||void 0===e||e.cancel(),""!==this.state.inputValue?(this.tagSuggestionsFetch=(0,e$.Z)((0,tf.op)(this.props.appContext.apiFetch,this.state.inputValue,{blog:null===(s=this.props.postFormContext)||void 0===s||null===(s=s.selectedBlog)||void 0===s?void 0:s.url,limit:5}).fetch()),this.tagSuggestionsFetch.then(e=>{var t=e.response;t&&this.setState({blogTags:[...t.blogTags.map(e=>e.tag)],listTags:[...t.typeahead.map(e=>e.tag),...t.similar.map(e=>e.tag)]})})):null!==(t=this.props.initialSuggestedTags)&&void 0!==t&&t.length?this.setState({blogTags:[...this.props.initialSuggestedTags]}):null===(o=this.getInitialTags())||void 0===o||o.then(e=>{var t=e.response;t&&this.setState({blogTags:[...t.tags]})}),this.tagSuggestionsFetch||this.initialTagsFetch}),c()(this,"onTagFocus",e=>this.setState({selectedTagIndex:e}))}componentDidMount(){var e;return window.addEventListener("focusin",this.handleOutsideFocusEvent),null!==(e=this.props.postFormContext)&&void 0!==e&&null!==(e=e.selectedBlog)&&void 0!==e&&e.name?this.getTags():Promise.resolve()}componentWillUnmount(){window.removeEventListener("focusin",this.handleOutsideFocusEvent)}componentDidUpdate(e){var t,s;return(null===(t=e.postFormContext)||void 0===t||null===(t=t.selectedBlog)||void 0===t?void 0:t.name)!==(null===(s=this.props.postFormContext)||void 0===s||null===(s=s.selectedBlog)||void 0===s?void 0:s.name)?this.getTags():Promise.resolve()}render(){var e=this.props,t=e.tags,s=e.appContext._c,o=t.map(e=>e.toLowerCase()),n=e=>!o.includes(e.toLowerCase()),a=this.state,r=a.inputValue,i=a.editorInputFocused,l=a.listTags,d=a.blogTags,h=a.isShowingSuggestions,c=a.selectedTagIndex,u=i||h||r.length,m=!i&&!h&&null===c,g=m&&t.length>1&&!u&&!this.shouldUseBasicPlaceholder(),v=m&&!t.length&&!r.length,b=this.getPlaceholderText(v,t.length);return(0,B.jsxs)("div",{ref:this.tagsEditorRef,className:"s7YOu",children:[(0,B.jsx)(tS,{ref:this.selectedTagsRef,tags:t,removeTagByIndex:this.removeTagByIndex,onUnfocusLastTag:this.focusEditorInput,onDragEnd:this.reorderTags,onChange:this.changeSelectedTags,onChangeError:this.tagLengthError,onFocus:this.onTagFocus}),(0,B.jsxs)("span",{className:p()({fdQ5Z:m||u,RD9M8:u,GkIaO:g}),style:{width:this.getChipWidth()},children:[(0,B.jsx)(tb.Z,{ref:this.autocompleteSuggestionsRef,isShowing:this.state.isShowingSuggestions,searchText:r,getSearchTextFromSuggestion:this.getSearchTextFromSuggestion,suggestions:null==d?void 0:d.filter(n).filter(e=>e.toLowerCase().includes(r.toLowerCase())),popularSuggestions:l.filter(n),popularHeader:(0,B.jsx)("div",{className:"uN8qr",children:s("popular tags","popular")}),renderSuggestion:this.renderSuggestion,onSelection:this.addTagFromInputOrParam,onClose:()=>this.setState({isShowingSuggestions:!1}),onUnfocus:this.focusEditorInput,popoverMaxHeight:200,popoverWidth:170,positionBasedOffsetModifiers:tN,noSoftSelectionOnNewSuggestions:!0,allowNullSelection:!0,toggle:()=>{this.state.editorInputFocused||this.setState({isShowingSuggestions:!this.state.isShowingSuggestions})},hotkey:this.hotkey}),(0,B.jsx)("span",{className:"aqWWB","data-value":r,children:(0,B.jsx)("textarea",{ref:this.editorInputRef,"aria-label":s("Input to add tags to the post","Tags editor"),rows:1,className:p()("mbROR",{zqrdz:!!t.length,Z0_uD:g}),placeholder:m?b:"",value:r,onChange:this.onEditorInputChange,onFocus:this.onEditorInputFocus,onBlur:this.onEditorInputBlur,onKeyDown:this.handleKeyDown})})]})]})}}let tE=(0,I.CN)(tA,{appContext:!0,postFormContext:!0,toastContext:!0});var tF=s(42946),tB=s(49116);let tD={container:"dzJuF",wrappingContainer:"xXvvU",desktopCloseButtonNewStyle:"Zemfu",avatar:"rN5a6",sticky:"tuCmQ",innerContainer:"RuIGO",contentArea:"Y21sU",form:"Ynr_C",tags:"WSosN",anonToggle:"YLNkn",isDisabled:"Y3LwG",postActionsContainer:"Q1jRN",postFormButton:"VKVjJ",postActions:"RScAl",mobile:"d9e1J",videoProcessingToast:"z2MkE"};var tR="lastSeenNoTagPromptTsKey";class tZ extends l.Component{constructor(){var e,t,s,o,a,r;super(...arguments),r=this,c()(this,"state",((e,t,s)=>{var o=this.props,n=o.editablePost,a=o.trail,r=!!(null!=a&&a.length),i=(0,_.hT)(this.props.location.pathname);return{editablePost:n,tags:(null==n?void 0:n.tags)||[],communityId:null!==(e=null==n||null===(t=n.community)||void 0===t?void 0:t.name)&&void 0!==e?e:this.props.communityId,saving:!1,canPost:(0,W.m_)(n,a),formPostStatus:this.getInitialPostStatus(n),showFullTrail:!0,isPostOptOpenPopover:!1,isMembersOnly:!!(null!=n&&null!==(s=n.content)&&void 0!==s&&s.some(e=>e.type===Q.kH.Paywall)),blogs:n?[n.blog]:[],selectedBlog:null==n?void 0:n.blog,containerOffset:{top:0,left:0,width:0},communityLabels:(0,ez.nT)(null==n?void 0:n.communityLabels,!i),editorMode:"richText",snackbars:[],isEmptyReblog:r&&!(0,W.m_)(n,[]),isUnderAge:!1,isTranscoding:!!n&&n.state===Q.hA.Transcoding,waitingForTranscodingToSave:!1,isDirty:!1,isDateTimeInvalid:!1,isPremiumPartner:!1,showNoTagPrompt:!1}})()),c()(this,"autoSaveDelayInSeconds",this.props.autoSaveDelayInSeconds||60),c()(this,"isAnswer",!!(null!==(e=this.props.editablePost)&&void 0!==e&&e.askingName)&&(null===(t=this.props.editablePost)||void 0===t?void 0:t.state)==="submission"),c()(this,"isAnonymousAnswer",this.isAnswer&&!(null!==(s=this.props.editablePost)&&void 0!==s&&s.askingUrl)),c()(this,"isAsk",this.props.postType===Q.hQ.Ask&&!!this.props.otherBlogName),c()(this,"isPrefilledPost",null===(o=this.props.editablePost)||void 0===o?void 0:o.isPrefilledPost),c()(this,"disableBlogSelection",null===(a=this.props.editablePost)||void 0===a?void 0:a.disableBlogSelection),c()(this,"blockEditorRef",(0,l.createRef)()),c()(this,"contentContainerRef",(0,l.createRef)()),c()(this,"tagsEditorRef",(0,l.createRef)()),c()(this,"apiHelper",(0,N.ZP)(this.props.appContext.apiFetch)),c()(this,"confirmAbandonUnsavedMessage",this.props.appContext._c("Message shown to users warning them that they are about to navigate away from a post or blog collection with unsaved changes","If you leave before saving, your changes will be lost. Are you sure you want to navigate away?")),c()(this,"onFormCrash",()=>{var e=this.props,t=e.closeForm,s=e.appContext._c,o=e.toastContext.toggleToast;null==t||t(),o((0,eV.U)((0,eO.X)(s)),"error")}),c()(this,"removeSnackbar",()=>{this.setState(e=>({snackbars:[...e.snackbars].slice(0,-1)}))}),c()(this,"showSnackbar",(e,t,s)=>{var o=(0,eS.m)(e,t,s);this.setState(e=>({snackbars:[...e.snackbars,o]}))}),c()(this,"updateContainerOffset",()=>{this.setState({containerOffset:this.getContainerOffset()})}),c()(this,"renderAnonSwitchPrompt",()=>{var e=this.props.appContext._t;return this.state.showAnonPrompt&&(0,B.jsx)(g.Z,{onGlassClick:this.rejectAnonSwitchPrompt,glassIsClickable:!1,children:(0,B.jsx)(x.O,{title:e("Anonymous Asks only supports text (including text styles and formatting). Media and links will be removed."),buttons:[{text:e("Cancel"),onClick:this.rejectAnonSwitchPrompt,buttonStyle:x.X.Neutral},{text:e("Confirm"),onClick:this.acceptAnonSwitchPrompt,buttonStyle:x.X.Confirm}]})})}),c()(this,"renderNoTagPrompt",()=>{var e=this.props.appContext._c;return this.state.showNoTagPrompt&&(0,B.jsx)(g.Z,{onGlassClick:this.rejectAnonSwitchPrompt,glassIsClickable:!1,children:(0,B.jsx)(x.O,{title:e("Prompt to reminds user the post does not have any tag yet","Post without tags?"),body:e("Prompt text to reminds user adding tags can improve the discoverability of the post","Adding tags to your posts helps people find them"),buttons:[{text:e("Action button to publish a post, should be verb here","Post"),onClick:this.hideNoTagPromptToPost,buttonStyle:x.X.Neutral},{text:e("Close the prompt and get back to editor to add some tags","Add tags"),onClick:this.hideNoTagPromptToAddTags,buttonStyle:x.X.Confirm}]})})}),c()(this,"hideNoTagPromptToPost",()=>{this.setState({showNoTagPrompt:!1},this.postIt)}),c()(this,"hideNoTagPromptToAddTags",()=>{var e;this.setState({showNoTagPrompt:!1},null===(e=this.tagsEditorRef.current)||void 0===e?void 0:e.focusEditorInput)}),c()(this,"toggleAnonymity",()=>{if(this.state.isAnonymousAsk)return this.setState({isAnonymousAsk:!1});this.setState({showAnonPrompt:!0})}),c()(this,"acceptAnonSwitchPrompt",()=>{this.setState({isAnonymousAsk:!0,showAnonPrompt:!1},this.triggerEditorRefresh)}),c()(this,"triggerEditorRefresh",()=>{window.dispatchEvent(new Event("editorrefresh"))}),c()(this,"rejectAnonSwitchPrompt",()=>{this.setState({showAnonPrompt:!1})}),c()(this,"updatePostStatus",e=>this.setState({formPostStatus:e})),c()(this,"isReblog",()=>!!this.props.trail&&this.props.trail.length>0),c()(this,"getReblogFromName",()=>{var e=this.state.editablePost,t=this.props.trail;if(null!=e&&e.rebloggedFromName)return null==e?void 0:e.rebloggedFromName;if(this.isReblog()){var s=t[t.length-1];return(0,Q.eb)(s)?s.blog.name:s.brokenBlog.name}}),c()(this,"canNotReblog",e=>{var t=this.state.selectedBlog,s=this.getMentionFromReblog();return"noone"===e.interactabilityReblog&&!s.includes((null==t?void 0:t.name)||this.getReblogFromName()||"")}),c()(this,"getMentionFromReblog",()=>{var e=[],t=this.props.trail,s=t[t.length-1];if(!(0,Q.eb)(s))return e;var o=[];return s.content.forEach(e=>{e.formatting&&(o=[...o,...e.formatting])}),0===o.length||o.forEach(t=>{(0,Q.A7)(t)&&t.blog&&e.push(t.blog.name)}),e}),c()(this,"getContainerOffset",()=>{var e,t,s,o,n=(null===(e=this.contentContainerRef.current)||void 0===e?void 0:e.getBoundingClientRect().top)||0;return{top:((null===(t=this.contentContainerRef.current)||void 0===t?void 0:t.scrollTop)||0)-n,left:(null===(s=this.contentContainerRef.current)||void 0===s?void 0:s.getBoundingClientRect().left)||0,width:(null===(o=this.contentContainerRef.current)||void 0===o?void 0:o.getBoundingClientRect().width)||0}}),c()(this,"renderClosePrompt",()=>{var e=this.props.appContext._t,t=this.state,s=t.showClosePrompt,o=t.editablePost,n=e(null!=o&&o.id?"Discard changes?":"Discard this post?");return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(eT.Z,{message:this.confirmAbandonUnsavedMessage,when:this.canPostIt()&&!s}),s&&(0,B.jsx)(g.Z,{onGlassClick:this.hideCloseFormPrompt,glassIsClickable:!1,children:(0,B.jsx)(x.O,{className:"discardDialog",title:n,buttons:[{text:e("Cancel"),onClick:this.hideCloseFormPrompt,buttonStyle:x.X.Neutral},{text:e("Discard"),onClick:this.discardChanges,buttonStyle:x.X.Confirm}]})})]})}),c()(this,"changeEditorState",e=>("ready"!==e||this.autoSaveLoopId||(this.autoSaveLoopId=setTimeout(this.autoSaveTick,1e3*this.autoSaveDelayInSeconds)),"ready"!==e||this.state.canPost)?"busy"===e&&this.state.canPost?(this.resetCommunityLabels(),this.setState({canPost:!1})):void 0:this.setState({canPost:!0})),c()(this,"canPostIt",()=>{var e=this.state,t=e.canPost,s=e.saving;return t&&!s}),c()(this,"renderPostButton",()=>{var e=this.state,t=e.formPostStatus,s=e.isDateTimeInvalid,o=e.waitingForTranscodingToSave,a=!this.canPostIt()||o;return(0,B.jsx)("div",{className:tD.postFormButton,children:(0,B.jsx)(eP,n()(n()(n()({formPostStatus:t,disabled:a,onClickPostButton:this.updatePostAction,onUpdatePostStatus:this.updatePostStatus,onRenderDatePicker:this.renderDatePicker,isAnswer:this.isAnswer,isAnonymousAnswer:this.isAnonymousAnswer,hideExtraOptions:this.isAsk||!!this.props.communityId||!!this.state.communityId},this.isAsk&&{buttonText:this.props.appContext._t("Ask")}),o&&{buttonText:this.props.appContext._t("Processing your video")}),{},{avoidClosePostOpt:t===eb.$t.Scheduled&&s&&!this.state.publishOnValue}))})}),c()(this,"renderCommunityLabelsDropdown",()=>(0,B.jsx)(e5,{initial:this.state.communityLabels,onChange:this.onCommunityLabelEditorChange,disabled:this.state.isEmptyReblog})),c()(this,"renderCloseButton",()=>{var e=this.props.appContext._t("Close");return(0,B.jsx)(m.Z,{label:e,wrapperClassName:tD.desktopCloseButtonNewStyle,onClick:this.closeForm,children:e})}),c()(this,"updatePostAction",function(e){var t,s,o,a,i,l,d,h,c,u,p,m,g,v,b,f,x,C;return L()().async(function(P){for(;;)switch(P.prev=P.next){case 0:if(s=(t=r.props).appContext.logEvent,o=t.location,i=(a=r.state).selectedBlog,l=a.editablePost,d=r.isReblog(),h=r.getPostData(),d&&(p=(u=(0,eH.Tf)(h.parentPostId,h.placementId)).placementId,m=u.tabId,s({eventName:k.J.Reblog,eventDetails:{trackable_type:"Post",post_id:h.parentPostId,earned_id:h.earnedId,serve_id:h.serveId,has_tip:h.shouldShowTip,is_commercial:!!h.isCommercial||void 0,communityId:r.state.communityId||void 0,placement_id:p,tab:m},pathname:null===(c=o.state)||void 0===c?void 0:c.previousPathname})),!((null!=i&&i.isPremiumPartner||null!=i&&i.isBloglessAdvertiser)&&!d)){P.next=17;break}if(v=null!=(g=null==l?void 0:l.adsParams)&&g.redirectUrlPrimary?(0,eM.Z)(null==g?void 0:g.redirectUrlPrimary):void 0,b=null!=g&&g.redirectUrlIos?(0,eM.Z)(null==g?void 0:g.redirectUrlIos):void 0,f=null!=g&&g.redirectUrlAndroid?(0,eM.Z)(null==g?void 0:g.redirectUrlAndroid):void 0,x=null==g?void 0:g.displayUrl,!(v&&!x)){P.next=16;break}return P.next=14,L()().awrap(function(e){var t,s,o;return L()().async(function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",null);case 2:if(!(void 0!==(t=eZ.get(e)))){n.next=5;break}return n.abrupt("return",t);case 5:return n.prev=5,n.next=8,L()().awrap(fetch(`/svc/pop/format-domain?domain=${encodeURIComponent(e)}`));case 8:if(200!==(s=n.sent).status){n.next=15;break}return n.next=12,L()().awrap(s.text());case 12:n.t0=n.sent,n.next=16;break;case 15:n.t0=null;case 16:return o=n.t0,eZ.set(e,o),n.abrupt("return",o);case 21:return n.prev=21,n.t1=n.catch(5),"production"===eR.Z.Development&&console.error("Error getting domain name",n.t1),n.abrupt("return",null);case 25:case"end":return n.stop()}},null,null,[[5,21]],Promise)}(v.hostname));case 14:C=P.sent,x=`${v.protocol}//${C}`;case 16:r.updateEditablePost(n()(n()({},l),{},{adsParams:n()(n()({},g),{},{redirectUrlPrimary:null==v?void 0:v.toString(),redirectUrlIos:null==b?void 0:b.toString(),redirectUrlAndroid:null==f?void 0:f.toString(),displayUrl:x})}));case 17:P.t0=e,P.next=P.t0===eb.$t.Now?20:P.t0===eb.$t.Published?20:P.t0===eb.$t.Queue?21:P.t0===eb.$t.Draft?22:P.t0===eb.$t.Private?23:P.t0===eb.$t.Scheduled?24:25;break;case 20:return P.abrupt("return",r.onNowClick());case 21:return P.abrupt("return",r.onQueueClick());case 22:return P.abrupt("return",r.onDraftClick());case 23:return P.abrupt("return",r.onPrivatePostChange());case 24:return P.abrupt("return",r.onPublishScheduledPost());case 25:case"end":return P.stop()}},null,null,null,Promise)}),c()(this,"handleBeforeUnload",e=>this.state.canPost&&!this.state.saving?(e.returnValue=this.confirmAbandonUnsavedMessage,this.confirmAbandonUnsavedMessage):null),c()(this,"renderDatePicker",()=>{var e,t=this.state,s=t.editablePost,o=t.publishOnValue;return e=o?Date.parse(o):null!=s&&s.scheduledPublishTime?1e3*s.scheduledPublishTime:Date.now(),(0,B.jsx)(ed,{onChange:this.onChangePublishOnValue,initialDatetime:new Date(e),minDate:new Date,onInvalid:this.onDateTimePickerInvalid})}),c()(this,"onDateTimePickerInvalid",()=>this.setState({isDateTimeInvalid:!0})),c()(this,"onBlogSwitchConfirm",e=>{this.setState({switchConfirmationRequestingBlog:void 0,selectedBlog:e}),this.setIsMembersOnly(!1)}),c()(this,"onBlogSwitchCancel",()=>{this.setState({switchConfirmationRequestingBlog:void 0})}),c()(this,"noticeUpdateCommunityLabels",(0,eJ.Z)(()=>{var e=this.props;(0,e.toastContext.toggleToast)((0,e.appContext._t)("We have updated your community labels based on your tags"),"success")},5e3)),c()(this,"updateCommunityLabels",e=>{var t=this.state.communityLabels,s=t.categories,o=["nsfw","mature"],a=["drug use"],r=["violence"],i=["sexual themes"],l=!1;if(e.some(e=>o.includes(e))){var d=n()(n()({},t),{categories:n()({},t.categories)});t.active||(d.active=!0,l=!0),e.some(e=>a.includes(e))&&!s.drugUse&&(d.categories.drugUse=!0,l=!0),e.some(e=>r.includes(e))&&!s.violence&&(d.categories.violence=!0,l=!0),e.some(e=>i.includes(e))&&!s.sexualThemes&&(d.categories.sexualThemes=!0,l=!0),l&&(this.setState({communityLabels:d}),this.noticeUpdateCommunityLabels())}}),c()(this,"onTagsEditorChange",e=>{this.updateCommunityLabels(e),this.setState({tags:e})}),c()(this,"onCommunityEditorChange",e=>{this.setState(t=>{var s=t.formPostStatus;return{communityId:e,formPostStatus:e?eb.$t.Now:s}}),this.props.appContext.logEvent({eventName:k.J.PFCommunitySelect,eventDetails:{communityId:e}})}),c()(this,"onCommunityLabelEditorChange",e=>{this.setState({communityLabels:e})}),c()(this,"updateSelectedBlog",e=>{var t=this.state,s=t.isMembersOnly,o=t.communityId;!e.primary&&o&&this.setState({communityId:void 0}),s&&!e.isPaywallOn?this.setState({switchConfirmationRequestingBlog:e}):(this.setState({selectedBlog:e}),this.cleanAutoSavedDraft()),this.props.appContext.logEvent({eventName:k.J.PFBlogSelect})}),c()(this,"setFormPostStatus",e=>{this.setState({formPostStatus:e})}),c()(this,"onNowClick",()=>new Promise(e=>this.setState({formPostStatus:eb.$t.Now},()=>{this.postIt().then(e)}))),c()(this,"onDraftClick",()=>new Promise(e=>this.setState({formPostStatus:eb.$t.Draft},()=>{this.postIt().then(e)}))),c()(this,"onQueueClick",()=>new Promise(e=>this.setState({formPostStatus:eb.$t.Queue},()=>this.postIt().then(e)))),c()(this,"onPrivatePostChange",()=>new Promise(e=>this.setState({formPostStatus:eb.$t.Private},()=>{this.postIt().then(e)}))),c()(this,"onPublishScheduledPost",()=>new Promise(e=>this.setState({formPostStatus:eb.$t.Scheduled},()=>{this.postIt().then(e)}))),c()(this,"onChangePublishOnValue",e=>this.setState({publishOnValue:null==e?void 0:e.toISOString()})),c()(this,"onShowFullTrailToggle",()=>this.setState(e=>({showFullTrail:!e.showFullTrail}))),c()(this,"resetCommunityLabels",()=>{var e,t=(0,ez.nT)(null===(e=this.props.editablePost)||void 0===e?void 0:e.communityLabels,!(0,_.hT)(this.props.location.pathname));t.categories=eG.CH.reduce((e,s)=>n()(n()({},e),{},{[s]:"locked"===t.categories[s]&&t.categories[s]}),{}),t.active="locked"===t.active&&"locked",this.setState({communityLabels:t})}),c()(this,"reblogHasNewContent",e=>{var t=!e;this.setState({isEmptyReblog:t}),t&&this.resetCommunityLabels()}),c()(this,"getHotkeyModifier",()=>{var e=this.props.appContext.getBrowserInfo;return(0,ey.HP)(e())?ec.TE.Meta:ec.TE.Ctrl}),c()(this,"autoSaveTick",()=>{var e=this.state,t=e.editablePost,s=e.isTranscoding,o=e.waitingForTranscodingToSave;t&&t.state&&t.state!=Q.hA.Draft||this.isAsk||(this.autoSaveLoopId=setTimeout(this.autoSaveTick,1e3*this.autoSaveDelayInSeconds),!this.canPostIt()||s||o||this.autoSaveDraft())}),c()(this,"getPostData",()=>{var e,t,s,o,a,r,i=this.state,l=i.editablePost,d=i.tags,h=this.props.trail,c=null===(e=this.blockEditorRef.current)||void 0===e?void 0:e.getContent(),u=null!==(t=null==c?void 0:c.content)&&void 0!==t?t:[],p=u.findIndex(Q.KM);p>-1&&u.splice(p,1);var m=null!==(s=null!==(o=null==c?void 0:c.layout)&&void 0!==o?o:null==l||null===(a=l.layout)||void 0===a?void 0:a.filter(Q.af))&&void 0!==s?s:[],g=n()(n()({content:u,tags:d},m.length&&{layout:m}),{},{hideTrail:!this.state.showFullTrail,id:null==l?void 0:l.id,sourceUrl:null==l?void 0:l.sourceUrlRaw,slug:null==l?void 0:l.slug,date:null==l?void 0:l.date,placementId:null==l?void 0:l.placementId,earnedId:null==l?void 0:l.earnedId,canBeTipped:null!==(r=null==l?void 0:l.canBeTipped)&&void 0!==r?r:null,interactabilityReblog:null==l?void 0:l.interactabilityReblog,interactabilityBlaze:null==l?void 0:l.interactabilityBlaze,isCommercial:null==l?void 0:l.isCommercial}),v=null!=h&&h.length?h[h.length-1]:void 0;return!g.reblogKey&&(0,Q.eb)(v)&&v.post.reblogKey&&(g.reblogKey=v.post.reblogKey,g.parentTumblelogUuid=v.blog.uuid,g.parentPostId=v.post.id,g.interactabilityReblog=v.post.interactabilityReblog),g}),c()(this,"autoSaveDraft",()=>{var e=this.state,t=e.selectedBlog,s=e.isAnonymousAsk,o=e.communityLabels,n=this.props,a=n.otherBlogName,r=n.appContext.logEvent,i=null==t?void 0:t.uuid;if(i){var l=this.getPostData();if(this.canNotReblog(l))return;var d=(0,eH.Tf)(l.parentPostId,l.placementId),h=d.placementId,c=d.isLongPost;!l.id&&this.autoSavePostId&&(l.id=this.autoSavePostId),l.state=Q.hA.Draft,this.postRequest=(0,e$.Z)(this.apiHelper.postAPost({logEvent:r,otherBlogName:a,selectedBlog:t,selectedBlogName:i,isAsk:this.isAsk,isAnonymousAsk:!!s,placementId:h,isLongPost:c,communityLabels:o,post:l}).fetch()),this.postRequest.then(this.handleAutoSaveSuccess,this.handleAutoSaveFailure)}}),c()(this,"handleAutoSaveFailure",e=>{this.handleSaveFailure(e,!0)}),c()(this,"finishTranscoding",()=>{var e=this.props,t=e.toastContext,s=t.toggleToast,o=t.clearToastById,n=e.appContext._c;this.setState({isTranscoding:!1}),this.state.waitingForTranscodingToSave&&(o("video-processing-banner"),s(n("A post has been processed sucessfully and now we proceed to save it","Your post is ready, let's go!"),"success"),this.postIt())}),c()(this,"handleAutoSaveSuccess",e=>{var t=this.props,s=t.toastContext.toggleToast,o=t.appContext._t,n=this.props.appContext.apiFetchWithSchema,a=this.state,r=a.editablePost,i=a.selectedBlog;return(null==r?void 0:r.id)!==e.response.id&&(this.autoSavePostId=e.response.id),"transcoding"===e.response.state&&(this.setState({isTranscoding:!0}),i&&(0,W.zA)(e.response.id,n,i,this.finishTranscoding)),s(o("Draft saved!"),"success")}),c()(this,"hasFinishedTranscodingAndNeedsToBeSavedNow",()=>{var e=this.state,t=e.isTranscoding;return e.waitingForTranscodingToSave&&!t}),c()(this,"postIt",function(){var e,t,s,o,n,a,i,l,d,h,c,u,p,m,g,v,b,f,x,C,P,y,w,T,S,j,N,I,A,E,F,D,R,Z;return L()().async(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,L()().awrap(r.prePostIt());case 2:if(s=(t=r.state).editablePost,o=t.selectedBlog,n=t.publishOnValue,a=t.formPostStatus,i=t.tags,l=t.communityId,d=t.isAnonymousAsk,h=t.communityLabels,c=t.isTranscoding,p=(u=r.props).otherBlogName,g=(m=u.appContext).logEvent,v=m._c,b=m._t,f=u.toastContext.toggleToast,x=u.location,!(!i.length&&!r.isReblog()&&!r.isAsk&&![eb.$t.Draft,eb.$t.Private].includes(a))){O.next=13;break}C=tB.E.getItem(tR),P=Date.now(),y=!1;try{y=!C||P-JSON.parse(C)>=1e3*tF.y.Week}catch(e){w=`[postForm]: ${e.message} - lastSeenNoTagPromptTsKey ${C}`,window.dispatchEvent(new ErrorEvent("error",{error:e,message:w})),"production"===eR.Z.Development&&console.error(w)}if(!y){O.next=13;break}return r.setState({showNoTagPrompt:!0}),tB.E.setItem(tR,JSON.stringify(P)),O.abrupt("return",Promise.resolve());case 13:if(!(!r.canPostIt()&&!r.hasFinishedTranscodingAndNeedsToBeSavedNow())){O.next=15;break}return O.abrupt("return",Promise.resolve());case 15:if(!c){O.next=19;break}return r.setState({saving:!0,waitingForTranscodingToSave:!0}),f((0,B.jsx)("div",{className:tD.videoProcessingToast,children:v("A toast message telling the user the post will take a while to save because it still needs to proccess the videos in the psot","We are still processing your video, it will take a moment to save your post")}),"banner","video-processing-banner"),O.abrupt("return",Promise.resolve());case 19:if(T=r.getPostData(),!(r.isReblog()&&r.canNotReblog(T))){O.next=23;break}return f(v("A toast error message shown to users when the post cannot be reblogged that restricted via reblog controls of the original post","Sorry, this post cannot be reblogged due to the original post's reblog controls"),"error"),O.abrupt("return",Promise.resolve());case 23:if(S=(0,eH.Tf)(T.parentPostId,T.placementId).tabId,j="now",!r.isAsk){O.next=30;break}T.state=Q.hA.Ask,j="ask",O.next=47;break;case 30:O.t0=a,O.next=O.t0===eb.$t.Queue?33:O.t0===eb.$t.Draft?36:O.t0===eb.$t.Private?39:O.t0===eb.$t.Scheduled?43:47;break;case 33:return T.state=Q.hA.Queue,j="queue",O.abrupt("break",47);case 36:return T.state=Q.hA.Draft,j="draft",O.abrupt("break",47);case 39:return r.isAnswer?T.isPrivate=!0:T.state=Q.hA.Private,j="private",g({eventName:k.J.PFOptionsPrivate}),O.abrupt("break",47);case 43:return g({eventName:k.J.PFOptionsSchedule}),j="scheduled",n?(T.publishOn=n,T.state=Q.hA.Queue,j="queue"):null!=s&&s.scheduledPublishTime&&(T.publishOn=new Date(1e3*s.scheduledPublishTime).toISOString(),T.state=Q.hA.Queue,j="queue"),O.abrupt("break",47);case 47:O.t1=r.getPostFormStateForLogging(),O.next="reblog"===O.t1?50:"edit"===O.t1?52:"ask"===O.t1?54:57;break;case 50:return g({eventName:k.J.PFReblogAttempt,eventDetails:{publishing_options:j,tag_count:i.length,tab:S,is_commercial:!!T.isCommercial||void 0,communityId:l}}),O.abrupt("break",58);case 52:return g({eventName:k.J.PFEditAttempt,eventDetails:{publishing_options:j,tag_count:i.length}}),O.abrupt("break",58);case 54:return g({eventName:k.J.PFAsk}),null!==(e=x.search)&&void 0!==e&&e.includes("context=cta")&&g({eventName:k.J.AskCTA}),O.abrupt("break",58);case 57:g({eventName:k.J.PFPostAttempt,eventDetails:{publishing_options:j,tag_count:i.length,is_commercial:!!T.isCommercial||void 0,communityId:l}});case 58:if(l&&null!=o&&o.primary&&(T.communityId=l),!(null!=o&&o.isPremiumPartner||null!=o&&o.isBloglessAdvertiser)||(N=null==s?void 0:s.adsParams,T.adsParams=N,I=(0,W.Um)(N),!(null!=o&&o.isPremiumPartner&&I))){O.next=70;break}if(null!==(A=T.adsParams)&&void 0!==A&&A.redirectUrlPrimary){O.next=67;break}return f(b("A primary URL must be set when displaying a call to action."),"error"),O.abrupt("return",Promise.resolve());case 67:if((0,e_.Z)(T.adsParams.redirectUrlPrimary)){O.next=70;break}return f(b("The primary URL for a CTA must be a valid URL."),"error"),O.abrupt("return",Promise.resolve());case 70:if(!(E=null==o?void 0:o.uuid)){O.next=76;break}return r.setState({saving:!0}),R=(D=(0,eH.Tf)(T.parentPostId,T.placementId)).placementId,Z=D.isLongPost,r.postRequest=(0,e$.Z)(r.apiHelper.postAPost({logEvent:g,otherBlogName:p,selectedBlog:o,selectedBlogName:E,isAsk:r.isAsk,isAnonymousAsk:!!d,placementId:R,isLongPost:Z,communityLabels:h,tabId:S,post:T,pathname:null===(F=x.state)||void 0===F?void 0:F.previousPathname}).fetch()),O.abrupt("return",r.postRequest.then(r.handleSaveSuccess,r.handleSaveFailure));case 76:return O.abrupt("return",Promise.resolve());case 77:case"end":return O.stop()}},null,null,null,Promise)}),c()(this,"handleSaveSuccess",e=>{var t,s=this.props,o=s.toastContext.toggleToast,n=s.appContext,a=n._t,r=n.features.redpopDesktopVerticalNav,i=s.location.pathname,l=s.handleSaveSuccess,d=this.props.modalRouteContext.pathname,h=(0,_.hT)(i),c=(0,_.HU)(d),u=this.state,p=u.formPostStatus,m=u.selectedBlog;if(this.autoSavePostId&&this.cleanAutoSavedDraft(),this.isAsk)return setTimeout(function(){l({postStatus:p,response:e})},1e3),o(a("Your question has been received!"));if(m&&(0,eU.n5)(m),null!=e&&null!==(t=e.response)&&void 0!==t&&t.id&&m){var g=this.getPostFormStateForLogging(),v=e.response.id;h&&!c||"ask"===g||"answer"===g||p===eb.$t.Draft||o((0,B.jsx)(V,{blog:m,postId:v,postStatus:p,isNew:"new"===g||h&&c,communityId:this.state.communityId}),r?"success":"banner",r?void 0:"after-post-actions")}return l({postStatus:p,response:e})}),c()(this,"cleanAutoSavedDraft",()=>{var e=this.props.appContext.apiFetch,t=this.state.selectedBlog;if(t&&this.autoSavePostId){var s=t.uuid;e(`/v2/blog/${s}/post/delete`,{method:"POST",body:{id:this.autoSavePostId}}),delete this.autoSavePostId}}),c()(this,"showSaveError",e=>{var t=this.props.toastContext.toggleToast;this.setState({saving:!1}),t(e,"error")}),c()(this,"handleSaveFailure",function(e){var t,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=r.props,n=o.appContext,a=n._t,i=n.logEvent,l=o.location.pathname,d=r.state.editablePost,h=(0,_.hT)(l),c=(0,_.LX)(l),u=[eF.Z.Unauthorized,eF.Z.NotFound,eF.Z.PayloadTooLarge,eF.Z.ServiceUnavailable,eF.Z.InternalServerError],p=null==e||null===(t=e.detailedErrors)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.code,m=navigator.onLine,g={code:(null==e?void 0:e.status)||null,sub_code:p||null,placement_id:null==d?void 0:d.placementId,reason:m?eb.iK.ApiError:eb.iK.NetworkError};if(i(c?{eventDetails:g,eventName:k.J.ReblogFailed}:h?{eventDetails:g,eventName:k.J.EditFailed}:{eventDetails:g,eventName:k.J.PostFailed}),!m){r.showSaveError(a("You’ve gone off the ’net. Please reconnect and try again."));return}if(e&&u.includes(e.status)){s?r.showSaveError(a("There was an error autosaving your post.")):r.showSaveError(a("We’re sorry. There was an error processing your post."));return}if((null==e?void 0:e.status)===eF.Z.BadGateway){s?r.showSaveError(a("Autosave draft failed.")):r.showSaveError(a("Posting failed. Please try again."));return}if((null==e?void 0:e.status)===eF.Z.BadRequest){if(p===eB.Z.PostInvalidBodyParam||p===eB.Z.RequestInvalidParam){s?r.showSaveError(a("Autosave draft failed. There may be some issues with your post.")):r.showSaveError(a("Posting failed. Please check your post and try again."));return}if(p===eB.Z.PostInvalidNpfAnswer){r.showSaveError(a("Something went wrong with your answer. Please check and try again."));return}if(p===eB.Z.PostUnknownUploadErrorNonVideo||p===eB.Z.PostUnknownUploadErrorVideo){s?r.showSaveError(a("Autosave failed because there are issues with your post content uploads.")):r.showSaveError(a("Posting failed. Please try again."));return}if(p===eB.Z.PostBadMediaFormat){s?r.showSaveError(a("Autosave failed because we don't support this media format yet.")):r.showSaveError(a("Sorry, we don't support this media format yet."));return}if(p===eB.Z.PostSourceURLInvalid){s?r.showSaveError(a("Autosave failed because the post content source URL is invalid.")):r.showSaveError(a("Posting failed because the post content source URL is invalid."));return}s?r.showSaveError(a("We’re sorry. There was an error autosaving your post.")):r.showSaveError(a("We’re sorry. There was an error processing your post."));return}if((null==e?void 0:e.status)===eF.Z.Forbidden){if(p===eB.Z.PostUserUploadLimitReached||p===eB.Z.PostVideoLimitReached){r.showSaveError(a("You've exceeded your daily post or media limit. Please try again tomorrow."));return}if(p===eB.Z.PostVideoProcessing){s||r.showSaveError(a("One of your previous videos is still processing. Please wait until it completes before uploading another video."));return}if(p===eB.Z.PostQueueLimitReached){r.showSaveError(a("You've reached the maximum amount of posts that you can have in your queue."));return}if(p===eB.Z.PostDailyPostLimitHit){r.showSaveError(a("You've exceeded your daily post limit. Please try again tomorrow."));return}if(p===eB.Z.PostIsIgnited){r.showSaveError(a("A post in a Blaze campaign cannot be edited."));return}r.showSaveError(a("We’re sorry. There was an error processing your post."));return}r.showSaveError(a("We’re sorry. There was an error processing your post. Please try again."))}),c()(this,"prePostIt",()=>{var e,t;return null!==(e=null===(t=this.tagsEditorRef.current)||void 0===t?void 0:t.addTagFromInputOrParam(null,!1))&&void 0!==e?e:Promise.resolve()}),c()(this,"setIsDirty",e=>{this.setState({isDirty:e})}),c()(this,"setIsMembersOnly",e=>{this.state.isMembersOnly!==e&&this.setState({isMembersOnly:e})}),c()(this,"setEditorMode",e=>this.setState({editorMode:e})),c()(this,"updateEditablePost",e=>this.setState({editablePost:e})),c()(this,"discardChanges",()=>{var e=this.props,t=e.appContext.logEvent,s=e.closeForm;this.cleanAutoSavedDraft(),t({eventName:k.J.PFDismiss,eventDetails:{state:this.getPostFormStateForLogging()}}),null==s||s()}),c()(this,"closeForm",()=>{var e=this.props,t=e.appContext.logEvent,s=e.closeForm;if(this.canPostIt()){this.setState({showClosePrompt:!0});return}t({eventName:k.J.PFDismiss,eventDetails:{state:this.getPostFormStateForLogging()}}),null==s||s()}),c()(this,"hideCloseFormPrompt",()=>this.setState({showClosePrompt:!1})),c()(this,"getPostFormStateForLogging",()=>{var e=this.props.location.pathname,t=(0,_.hT)(e),s=(0,_.LX)(e),o=(0,_.Lv)(e);return this.isAsk?"ask":o?"new":s?"reblog":t?this.isAnswer?"answer":"edit":"new"})}componentDidMount(){var e=this.props.appContext,t=e.getUserInfo,s=e.logEvent,o=this.props.toastContext.clearToastById,n=this.props,a=n.blogName,r=n.location.pathname,i=this.state.selectedBlog,l=this.getPostData(),d=(0,eH.Tf)(l.parentPostId,l.placementId).tabId;return(o("after-post-actions"),s({eventName:k.J.PFOpenCanvas,eventDetails:{state:this.getPostFormStateForLogging(),tab:d}}),window.addEventListener("beforeunload",this.handleBeforeUnload),window.addEventListener("editorrefresh",this.updateContainerOffset),this.isAsk&&this.props.otherBlogName&&this.apiHelper.getBlogInfo(this.props.otherBlogName,(0,eD.n9)(["askAnon","asksAllowMedia"])).fetch().then(e=>{var t=e.response.blog,s=t.askAnon,o=t.asksAllowMedia;return this.setState({allowsAnonAsk:s,asksAllowMedia:o})}),!i||this.isAsk)?(this.userFetch=(0,e$.Z)(t()),this.userFetch.then(e=>{var t,s,o=(null==e?void 0:e.blogs)||[];this.isAsk||((0,_.Lv)(r)&&a?t=o.find(e=>e.name===a):s=(0,eU.jx)(o));var n=this.isAsk?(0,eL.Z)(o):t||s||(0,eL.Z)(o);if(n&&l.id&&l.state===Q.hA.Transcoding){var i=this.props.appContext.apiFetchWithSchema;(0,W.zA)(l.id,i,n,this.finishTranscoding)}this.setState({blogs:o,selectedBlog:n,containerOffset:this.getContainerOffset(),isUnderAge:(null==e?void 0:e.age)&&(null==e?void 0:e.age)<18,isPremiumPartner:null==o?void 0:o.some(e=>e.isPremiumPartner||e.isBloglessAdvertiser)})})):Promise.resolve()}componentWillUnmount(){var e,t,s=this.props.toastContext.clearToastById;this.autoSaveLoopId&&clearTimeout(this.autoSaveLoopId),s("video-processing-banner"),null===(e=this.userFetch)||void 0===e||e.cancel(),null===(t=this.postRequest)||void 0===t||t.cancel(),window.removeEventListener("beforeunload",this.handleBeforeUnload),window.removeEventListener("editorrefresh",this.updateContainerOffset)}shouldShowCommunities(){var e,t=this.state,s=t.editablePost,o=t.selectedBlog,n=this.props,a=n.location.pathname;if(!n.appContext.labsSettings.communities)return!1;var r=(0,_.hT)(a),i=(0,_.LX)(a),l=!r&&(null==o?void 0:o.primary),d=r&&(null==o?void 0:o.name)===(null==s||null===(e=s.community)||void 0===e?void 0:e.mentionTag),h=i&&(null==o?void 0:o.primary);return l||d||h}render(){var e,t=this.state,s=t.editablePost,o=t.showFullTrail,n=t.tags,a=t.selectedBlog,r=t.blogs,i=t.switchConfirmationRequestingBlog,l=t.isAnonymousAsk,d=t.asksAllowMedia,h=t.isPremiumPartner,c=t.communityId,u=this.props,m=u.trail,g=u.showBetaEditorToggle,v=u.postType,b=u.location.pathname,f=(0,_.hT)(b),x=this.shouldShowCommunities(),C=f&&null!=s&&s.community?s.postAuthorAvatar:null==a?void 0:a.avatar,P=f&&null!=s&&s.community?s.postAuthor:null==a?void 0:a.name,y=f&&null!=s&&s.community?null===(e=s.authorBlog)||void 0===e?void 0:e.url:null==a?void 0:a.url;return(0,B.jsx)(eh.Z,{source:"post-form",onError:this.onFormCrash,children:(0,B.jsx)(T.ZP,{children:e=>{var t=e.isMobile,u=e.isSmartphone;return(0,B.jsxs)(X.c.Provider,{value:{editablePost:s,selectedBlog:a,formPostStatus:this.state.formPostStatus,isReblog:this.isReblog(),isMembersOnly:this.state.isMembersOnly,isAsk:this.isAsk,isAnonymousAsk:!!l,asksAllowMedia:null==d||d,otherBlogName:this.props.otherBlogName,canPost:this.state.canPost,saving:this.state.saving,hotkeyModifier:this.getHotkeyModifier(),postIt:this.postIt,closeForm:this.closeForm,updateEditablePost:this.updateEditablePost,updateSelectedBlog:this.updateSelectedBlog,setFormPostStatus:this.setFormPostStatus,setIsMembersOnly:this.setIsMembersOnly,postType:v||void 0,setEditorMode:this.setEditorMode,editorMode:this.state.editorMode,reportState:this.changeEditorState,showSnackbar:this.showSnackbar,isDirty:this.state.isDirty,setIsDirty:this.setIsDirty},children:[g&&(0,B.jsx)(R,{isPremiumPartner:h||(null==a?void 0:a.isPremiumPartner)}),(0,B.jsx)(eS.Z,{snackbars:this.state.snackbars,removeSnackbar:this.removeSnackbar,containerRef:this.contentContainerRef.current}),t&&(0,B.jsx)(ep.Z,{viewport:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}),this.renderClosePrompt(),this.renderAnonSwitchPrompt(),this.renderNoTagPrompt(),this.isReblog()&&(0,B.jsx)(eE,{}),(0,B.jsx)(ec.ZP,{hotkey:[{key:ec.SV.Enter,command:this.postIt,modifiers:{[ec.TE.Meta]:!0},allowInputs:!0}]}),(0,B.jsx)(eu.Z,{shouldRenderHotkeyBlocker:!0,children:(0,B.jsx)("div",{className:p()(tD.container,{[tD.mobile]:t}),children:(0,B.jsxs)("div",{className:tD.wrappingContainer,children:[!t&&!!a&&(0,B.jsx)("div",{className:tD.avatar,children:(0,B.jsx)(q.Z,{wrapperClassName:tD.sticky,dimension:eW().desktopPostAvatarSize,imageResponse:C,name:P,url:y,isAnonymous:l})}),(0,B.jsxs)("div",{ref:this.contentContainerRef,className:tD.innerContainer,children:[(0,B.jsx)(tv,{blogs:r,hideMemberships:this.isAsk,showCommunitiesEditor:x,communityId:c,onCommunityChange:this.onCommunityEditorChange,hideBlogName:l,onRenderPostButton:this.renderPostButton,onClickClose:this.closeForm,reblogFromName:this.getReblogFromName(),disableSelection:(!!this.isAsk||!!this.isPrefilledPost)&&!1!==this.disableBlogSelection,isAnswer:this.isAnswer}),(0,B.jsxs)("div",{className:tD.contentArea,children:[(0,B.jsxs)("div",{className:tD.form,children:[(0,B.jsx)(Y.mu,{children:(0,B.jsx)(eo,{ref:this.blockEditorRef,reportState:this.changeEditorState,trail:m,showFullTrail:o,onShowFullTrailToggle:this.onShowFullTrailToggle,reblogHasNewContent:this.reblogHasNewContent})}),this.isAsk?this.renderAnonSelector():(0,B.jsx)("div",{className:tD.tags,children:(0,B.jsx)(tE,{ref:this.tagsEditorRef,tags:n,initialSuggestedTags:this.props.reblogTags,onChange:this.onTagsEditorChange})}),(0,B.jsxs)("div",{className:tD.postActionsContainer,children:[!u&&this.renderCloseButton(),(0,B.jsxs)("div",{className:tD.postActions,children:[v!==Q.hQ.Ask&&!this.state.isUnderAge&&this.renderCommunityLabelsDropdown(),this.renderPostButton()]})]})]}),i&&(0,B.jsx)(ew,{blog:i,onSwitchConfirm:this.onBlogSwitchConfirm,onCancel:this.onBlogSwitchCancel})]}),this.state.saving&&(0,B.jsx)(e4,{})]})]})})})]})}})})}renderAnonSelector(){var e=this.state,t=e.allowsAnonAsk,s=e.isAnonymousAsk;return(0,B.jsxs)("div",{className:p()(tD.anonToggle,{[tD.isDisabled]:!t}),children:[(0,B.jsx)(w.ZP,{children:"Ask anonymously"}),(0,B.jsx)(y.Z,{disabled:!t,checked:s,onChange:this.toggleAnonymity,controlled:!0})]})}getInitialPostStatus(e){var t=this.props,s=t.modalRouteContext.pathname,o=t.location;switch(null==e?void 0:e.state){case Q.hA.Private:return eb.$t.Private;case Q.hA.Queued:return Q.SH.Scheduled===(null==e?void 0:e.queuedState)?eb.$t.Scheduled:eb.$t.Queue;case Q.hA.Draft:return eb.$t.Draft;case Q.hA.Published:return eb.$t.Published;default:if((0,_.HU)(s))return eb.$t.Draft;if((0,_.c_)(s)||(0,_.fJ)(o.pathname))return eb.$t.Queue;return eb.$t.Now}}}var tO=(0,I.X9)(tZ,{appContext:!0,modalRouteContext:!0,paletteContext:!0,toastContext:!0,postFormContext:!0});let tL=(0,ef.Z)(tO);var tU=s(60612),tM=s(81022),t_=s(66052),t$=s(48430),tz=s(53852),tH=s(75815),tV=s(60951),tq=s(40565),tW=s(83875);let tJ={container:"HT4SV",item:"_qG9c",bubble:"lWf47",wobbleAndZoom:"BdLvX",bubbleLabel:"GnnHP",bubbleLink:"k3o2W",text:"eK_JR",isEntering:"U7hiM",hasEntered:"gjWXz",isExiting:"VAHl8",hasExited:"L3ZRH",photo:"pY71l",quote:"DYzEb",link:"QjnKR",chat:"EhfZD",audio:"_NmmT",video:"tSI2z"};var tG={[tU.d0]:"U7hiM",[tU.cn]:"gjWXz",[tU.Ix]:"VAHl8",[tU.Wj]:"L3ZRH"};class tQ extends l.Component{constructor(){super(...arguments),c()(this,"bubblesRef",(0,l.createRef)()),c()(this,"state",{isOpen:!0}),c()(this,"postTypesInfo",(()=>{var e=this.props.appContext._t;return{[Q.hQ.Text]:{label:e("Text"),icon:tV.Z},[Q.hQ.Photo]:{label:e("Photo"),icon:tz.Z},[Q.hQ.Quote]:{label:e("Quote"),icon:tH.Z},[Q.hQ.Link]:{label:e("Link"),icon:t$.Z},[Q.hQ.Chat]:{label:e("Chat"),icon:t_.Z},[Q.hQ.Audio]:{label:e("Audio"),icon:tM.Z},[Q.hQ.Video]:{label:e("Video"),icon:tq.Z}}})()),c()(this,"renderBubbles",e=>(0,B.jsx)("div",{className:"HT4SV",ref:this.bubblesRef,children:Q.Uj.map(t=>(0,B.jsx)("div",{className:"_qG9c",children:this.renderBubble(t,e)},`bubble-${t}`))})),c()(this,"renderBubble",(e,t)=>{var s=this.props.location.search,o=this.postTypesInfo[e],n=o.label,a=o.icon,r=p()("lWf47",tJ[e],tG[t]),i=p()("GnnHP",tG[t]);return(0,B.jsx)("div",{children:(0,B.jsxs)(z.rU,{replace:!0,to:`${(0,_.TL)({postType:e})}${s}`,onClick:this.generateClickHandlerForPostType(e),className:"k3o2W",children:[(0,B.jsx)("div",{className:r,children:(0,B.jsx)(a,{colors:{primary:E().paletteNavy},size:{height:35,width:40}})}),(0,B.jsx)("div",{className:i,children:n})]})})}),c()(this,"generateClickHandlerForPostType",e=>()=>this.props.appContext.logEvent({eventName:(0,tW.Y)(e),page:"floating"})),c()(this,"animateClose",()=>this.setState({isOpen:!1})),c()(this,"onExitBubbles",()=>this.props.closeForm())}render(){var e=this.props.exitAnimationDuration,t=this.state.isOpen;return(0,B.jsx)(g.Z,{onGlassClick:this.animateClose,glassIsClickable:!0,children:(0,B.jsx)(tU.ZP,{in:t,appear:!0,nodeRef:this.bubblesRef,timeout:{enter:0,exit:e},onExited:this.onExitBubbles,children:this.renderBubbles})})}}c()(tQ,"defaultProps",{exitAnimationDuration:480});let tX=(0,ef.Z)((0,H.HJ)(tQ));var tY=s(37560),tK=s(60042);let t0={iframe:"vP3g8",hidden:"skh2_"};class t1 extends l.Component{constructor(){var e;super(...arguments),e=this,c()(this,"state",{isLoading:!0,isIframeVisible:!1,dialog:null}),c()(this,"close",function(){var t,s,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===(t=(s=e.props).onClose)||void 0===t?void 0:t.call(s,{isModalSuccess:o,legacyPostFormState:n})}),c()(this,"onMessageInitializing",()=>{this.stopErrorTimer(),this.setState({isIframeVisible:!0})}),c()(this,"onMessageOpened",()=>this.setState({isLoading:!1})),c()(this,"onMessageClosed",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.didSave,o=t.newState;return e.close(void 0!==s&&s,void 0===o?null:o)}),c()(this,"startErrorTimer",()=>{this.errorTimer=setTimeout(this.showErrorMessage,1e4)}),c()(this,"stopErrorTimer",()=>clearTimeout(this.errorTimer)),c()(this,"showErrorMessage",()=>{var e=this.props.path,t=this.props.appContext,s=t.logEvent,o=t._t;s({eventName:k.J.PostFormsIframeError,eventDetails:{path:e}}),this.setState({isLoading:!1,dialog:{body:o("Hmm. This doesn’t seem to be working. Please try again?"),title:o("Error loading forms"),buttonLabel:o("OK")}})})}componentDidMount(){this.startErrorTimer(),this.handlerToUnlisten=tK.ag.listen("tumblr-redpop",{"postForms:initializing":this.onMessageInitializing,"postForms:opened":this.onMessageOpened,"postForms:closed":this.onMessageClosed}).handler}componentWillUnmount(){tK.ag.unlisten(this.handlerToUnlisten)}render(){var e=this.props.appContext,t=e._t,s=e.wwwBaseUrl,o=this.props,n=o.path,a=o.placementId,r=this.state,i=r.isLoading,l=r.isIframeVisible,d=r.dialog,h=`${s}/neue_web/iframe${n}`;return(0,B.jsxs)(B.Fragment,{children:[i&&(0,B.jsx)(Z.Z,{centerOrientation:"horizontalAndVertical"}),d?this.renderDialog(d):(0,B.jsx)(tY.Z,{className:p()(t0.iframe,{[t0.hidden]:!l}),title:t("Post forms"),src:h,placementId:a})]})}renderDialog(e){var t=e.title,s=e.body,o={text:e.buttonLabel,onClick:()=>this.close(),buttonStyle:x.X.Confirm};return(0,B.jsx)(x.O,{body:s,title:t,buttons:[o]})}}let t3=(0,H.HJ)(t1),t2=function(e){var t=e.onClose,s=e.postId;return(0,B.jsx)(t3,{onClose:t,path:`/edit/${s}`})};var t5=s(51826),t4={[t5.C.New]:"new",[t5.C.Draft]:"drafts/new",[t5.C.Queue]:"queue/new"};let t9=function(e){var t=e.postType,s=e.onClose,o=e.blogName,n=e.saveButtonState,a=void 0===n?t5.C.New:n,r=e.queryParams,i=t4[a];if(!i)throw Error(`There is no URL configured for save button state ${a}`);var l=o?(0,_.vw)({blogName:o}):"",d=`${l}/${i}/${t}`;if(r){var h=new URLSearchParams;["caption","src","tags"].forEach(e=>{var t=r[e];t&&h.set(e,t)}),h.sort(),d+=`?${h.toString()}`}return(0,B.jsx)(t3,{onClose:s,path:d})},t6=e=>{var t=e.onClose,s=e.postId,o=e.reblogKey,n=e.placementId;return(0,B.jsx)(t3,{onClose:t,path:`/reblog/${s}/${o}`,placementId:n})};var t8=function(e){return e.New="new",e.Edit="edit",e.Reblog="reblog",e}({});let t7=e=>{var t=e.mode,s=e.onClose,o=e.postId,n=e.reblogKey,a=e.placementId,r=e.blogName,i=e.postType,l=e.saveButtonState,d=e.queryParams;switch(t){case t8.New:return(0,B.jsx)(t9,{postType:i,saveButtonState:l,blogName:r,onClose:s,queryParams:d});case t8.Reblog:return(0,B.jsx)(t6,{postId:o,reblogKey:n,onClose:s,placementId:a});case t8.Edit:return(0,B.jsx)(t2,{postId:o,onClose:s});default:return null}};var se=s(32415);function st(e){var t;if(null!==(t=e.user)&&void 0!==t&&t.blogs.length)return e.user.blogs.some(e=>e.isPremiumPartner||e.isBloglessAdvertiser)}var ss=s(58388),so=s(74529),sn=s(6259),sa=s(49776),sr=s(73315),si=s(26963),sl=s(59379),sd=s(82560),sh=s(47026),sc=s(32252),su=e=>{var t,s=e.location,o=e.params,n=o.blogName,a=o.postId,r=o.postType,i=o.otherBlogName,l=(0,si.b)(null==s?void 0:s.search),d=l[eb.xq.PostSaveButtonState],h=l[eb.xq.BlogName],c=null==r?void 0:r.toLowerCase(),u=(0,Q.Py)(c)?c:null;return{blogName:null!==(t=null!=n?n:h)&&void 0!==t?t:"",postId:null!=a?a:"",saveButtonState:null!=d?d:t5.C.New,postType:u,otherBlogName:u===Q.hQ.Ask?null==i?void 0:i.toLowerCase():void 0}};let sp=()=>{var e=(0,H.bp)(),t=e.apiFetch,s=e.apiFetchWithSchema,o=e.features,a=e.getBootstrap,h=(0,i.NL)(),c=(0,se.Pc)(st).data,u=(0,T.v$)(),p=u.device,m=u.isMobile,v=(0,sn._)(),b=v.onClose,f=v.pathname,x=v.peeprLocation,C=(0,sa.z)().refreshCounts,P=(0,l.useState)(a(sh.Rn)),y=r()(P,2),w=y[0],S=y[1],k=(0,l.useRef)(),j=w.editablePost,N=w.trail,I=w.reblogTags,A=w.hasFetchedPostData,E=w.initialDeviceType,F=(0,d.TH)(),D=F.pathname,O=F.search,L=F.key,U=(0,d.s0)(),M=(0,d.UO)(),$=F.state,z=(0,_.hT)(D),V=(0,_.XB)(f),q=(0,_.Lv)(D),W=(0,_.LX)(D),J=(0,l.useState)(),G=r()(J,2),X=G[0],Y=G[1];(0,l.useEffect)(()=>{var e;return S(e=>n()(n()({},e),{},{initialDeviceType:p})),A||(e=(0,e$.Z)((0,sh.rJ)(s,{path:D,params:M},(0,si.b)(O)))).then(e=>{S(t=>n()(n()({},t),e))}),function(){var t;null===(t=e)||void 0===t||t.cancel(),void 0!==k.current&&(null==b||b(n()(n()({},k.current),{},{isReblog:W,isQueuePost:(0,_.fJ)(D),isEdit:z,isNewPost:q,isAsk:er})))}},[]),(0,l.useEffect)(()=>{q&&M.postType&&!(0,Q.XY)(M.postType)&&U((0,_.TL)({}),{replace:!0})},[q,M.postType]),(0,l.useEffect)(()=>{null!=$&&$.newPost&&!j&&S(e=>n()(n()({},e),{},{editablePost:$.newPost}))},[null==$?void 0:$.newPost,j]),(0,l.useEffect)(()=>{W&&null!=$&&$.newPost&&Y($.newPost)},[$,W]);var K=()=>{var e=window.history.length>1,t="default"!==L||W;e&&t?U(-1):U(x?x.pathname:_.o_.dashboard,{replace:!0})},ee=su({location:F,params:M}),et=ee.blogName,es=ee.postId,eo=ee.postType,en=ee.saveButtonState,ea=ee.otherBlogName,er=eo===Q.hQ.Ask,ei=(N||[]).some(e=>(0,Q.eb)(e)&&e.post.isPaywalled),el=(N||[]).some(e=>e.content.some(e=>e.type===Q.kH.Poll)),ed=(0,si.b)(O),eh=(0,sh.EE)(h);if(q&&!eo)return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(eI.Z,{page:sh.HJ.analyticsPageName}),m||o.redpopInstantCreate?(0,B.jsx)(d.Fg,{to:(0,_.TL)({postType:Q.hQ.Text},{tags:ed.tags}),replace:!0}):(0,B.jsx)(tX,{closeForm:K})]});if(!A)return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(eI.Z,{page:sh.HJ.analyticsPageName}),(0,B.jsx)("div",{className:sc.Z.loader,children:(0,B.jsx)(Z.Z,{centerOrientation:"horizontal"})})]});var ec=!E||E===ss.Yi.Desktop,eu=(0,sd.fE)({isMobile:!1,editablePost:j,features:o,postType:eo,isReblog:W,isReblogWithPaywall:ei,isInbox:V,isAsk:er,isPrefilledPost:!!(null!=$&&$.newPost),isReblogWithPoll:el,isPremiumPartner:c});return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(eI.Z,{page:sh.HJ.analyticsPageName}),(0,B.jsx)(g.Z,{onGlassClick:K,children:ec&&eu?(0,B.jsxs)(B.Fragment,{children:[null!=j&&j.shouldOpenInLegacy?null:(0,B.jsx)(R,{isPremiumPartner:c}),(0,B.jsx)(t7,{onClose:e=>{C(),k.current=e,K()},mode:q?t8.New:z?t8.Edit:t8.Reblog,blogName:et,postType:eo,saveButtonState:en,reblogKey:M.reblogKey,placementId:null==j?void 0:j.placementId,postId:es,queryParams:eo===Q.hQ.Photo?ed:null})]}):(0,B.jsx)("div",{className:sc.Z.postContainer,children:(0,B.jsx)(tL,{closeForm:()=>{k.current={},K()},postType:eo,handleSaveSuccess:e=>{if(C(),k.current=n()({isModalSuccess:!0},e),(null==$?void 0:$.newTab)&&window.open((0,sr.Z)($.newTab)),null!=$&&$.giftAsk){var s=$.giftAsk,o=s.askTumblelog,a=s.redirectUrl,r=s.uuid;(0,so.wC)(t,o,r).then(()=>{U(a,{replace:!0})})}K()},editablePost:n()(n()(n()({},j),eh&&{content:eh}),X),trail:N||[],reblogTags:I,blogName:et,communityId:M.communityId,otherBlogName:ea,showBetaEditorToggle:ec&&!(0,sl.h)({editablePost:j,isAsk:er&&!!ea,isInbox:V,isReblogWithPaywall:ei,isPrefilledPost:null==j?void 0:j.isPrefilledPost,isReblogWithPoll:el})})})})]})}},17447:(e,t,s)=>{s.d(t,{RT:()=>i,Rn:()=>a});var o=s(54589),n=s.n(o),a="Settings",r={accountActivityEmails:!0,asksSubmissionsHeaderBadges:!0,autoTruncatingPosts:!1,viewWithBlogTheme:!0,colorizedTags:!0,conversationalNotifications:!0,dashboardBestStuffFirst:!0,dashboardFollowedTagsPosts:!0,snoozeTmgLive:!0,dashboardInYourOrbit:!0,dashboardBasedOnYourLikes:!0,defaultPostFormat:0,email:"test@example.com",endlessScrolling:!0,filteredContent:[],filteredTags:[],improvedSearch:!0,language:"en_US",messagingSounds:!0,onlineStatusIndicator:!0,ccpaOptedOut:!1,permitMarketingEmails:!0,tfaAuthenticatorEnabled:!1,tfaSmsEnabled:!1,tfaSmsPhoneNo:"",timestamps:!1,hideSensitiveContent:!0,communityLabelVisibilitySetting:"warn",communityLabelCategories:{drugUse:"warn",violence:"warn",sexualThemes:"warn"},labsEnabled:!0,labsExperiments:[],connectedApps:{},disableAdminOnlyFeatures:!1,disableAdminTagButtons:!1,adminEnableDevboxRedpop:!1,tumblrPremium:!1,showAdsAnyway:!1,showBlazeAds:!1};r.email,r.tfaSmsEnabled,r.tfaSmsPhoneNo,r.tfaAuthenticatorEnabled,r.connectedApps;var i=n()(r,["email","tfaSmsEnabled","tfaSmsPhoneNo","tfaAuthenticatorEnabled","connectedApps"])},87693:(e,t,s)=>{s.d(t,{Z:()=>a});var o=s(17276),n=s.n(o);function a(e,t){var s;return n()().async(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n()().awrap(e(`/v2/blog/${t}/settings`));case 2:return s=o.sent.response,o.abrupt("return",s);case 5:case"end":return o.stop()}},null,null,null,Promise)}},44655:(e,t,s)=>{s.d(t,{Re:()=>d,Rk:()=>p,_A:()=>h,o:()=>c,on:()=>l,op:()=>u});var o=s(54138),n=s.n(o),a=s(5700),r=s(1308),i=s(60023);function l(e,t,s){return new i.x(e,`/v2/search/${encodeURIComponent(t)}`,{method:"GET",queryParams:n()(n()({},(0,r.n9)(["avatar","name","url","blogViewUrl","title","followed","theme"])),s)})}function d(e,t,s){return new i.x(e,`/v2/typeahead/${encodeURIComponent(t)}`,{method:"GET",queryParams:n()(n()({},(0,r.n9)(["avatar","name","url","blogViewUrl","title","followed","theme"])),s)})}function h(e,t){return new i.x(e,`/v2/search/${encodeURIComponent(t)}/tags/typeahead`,{method:"GET",queryParams:{limit:"20",include_query:!0}})}function c(e,t){var s=t.searchKeyword,o=t.timelineType,l=t.postType,d=t.requestMode,h=t.skipComponent,c=t.limit,u=t.days,p=t.reblogInfo,m=t.cursor,g=t.querySource,v=t.postRole;return new i.x(e,"/v2/timeline/search",{queryParams:n()({limit:void 0===c?void 0:c,days:void 0===u?void 0:u,cursor:void 0===m?void 0:m,query:s,mode:d,timeline_type:o,skip_component:void 0===h?void 0:h,reblog_info:void 0===p||p,post_type_filter:(0,a.Je)(l),query_source:void 0===g?void 0:g,post_role:void 0===v?void 0:v},(0,r.xr)(["followed","shareFollowing","shareLikes","ask","theme"]))})}function u(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new i.x(e,`/v2/search/${encodeURIComponent(t)}/tags/all`,{queryParams:s})}function p(e,t){return new i.x(e,"/v2/audio",{queryParams:{query:t}})}},74529:(e,t,s)=>{s.d(t,{GP:()=>u,XB:()=>i,Zs:()=>d,_Z:()=>l,n5:()=>h,wC:()=>p,wr:()=>c});var o=s(54138),n=s.n(o),a=s(1308),r=s(60023),i=()=>(0,a.n9)(["ask","avatar","name","shouldShowGift","shouldShowTumblrmartGift","title"]);function l(e,t,s){return new r.x(e,`/v2/search/${encodeURIComponent(t)}`,{method:"GET",queryParams:n()(n()({},i()),{},{tumblrmart_product:s})})}function d(e,t,s){return e("/v2/tumblrmart/checkout",{method:"GET",queryParams:n()({host:t},s)})}function h(e,t,s){return e("/v2/tumblrmart/checkout/self",{method:"GET",queryParams:n()({host:t},s)})}function c(e,t,s,o){return e(`/v2/${t}/payment-method`,{method:"GET",queryParams:{host:s,path:o}})}function u(e,t,s){return new r.x(e,"/v2/tumblrmart/orders/purchased",{method:"GET",queryParams:n()(n()({},t&&{limit:t}),s&&{before_creation_timestamp:s})})}function p(e,t,s){return e("/v2/tumblrmart/gifts/reshare",{method:"POST",body:{recipient_uuid:t,order_uuid:s}})}},83932:(e,t,s)=>{s.d(t,{Am:()=>b,mu:()=>f,rV:()=>x});var o=s(54138),n=s.n(o),a=s(17276),r=s.n(a),i=s(33970),l=s.n(i),d=s(95004),h=s(17447),c=s(85795),u=s(24078),p=s(58546),m=s(78667),g=s(2629),v=(0,d.createContext)(void 0);function b(e,t,s){var o=(0,c.ZP)(e.apiFetch).getUserSettings().fetch();return t?Promise.all([o,t(e,s)]).then(e=>{var t=l()(e,2);return{settings:t[0].response,extraData:t[1]}}):o.then(e=>({settings:e.response}))}function f(e){var t=e.children,s=e.additionalDataFetcher,o=(0,m.bp)(),a=o.getBootstrap,i=o.apiFetch,f=o.apiFetchWithSchema,x=o.features,C=(0,d.useState)(!1),P=l()(C,2),y=P[0],w=P[1],T=(0,d.useState)(!1),S=l()(T,2),k=S[0],j=S[1],N=(0,d.useState)(null==a?void 0:a(h.Rn)),I=l()(N,2),A=I[0],E=I[1];(0,d.useEffect)(()=>{r()().async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object.keys(A).length>0)){e.next=2;break}return e.abrupt("return");case 2:return j(!0),e.t0=E,e.next=6,r()().awrap(b({apiFetch:i,apiFetchWithSchema:f},s,x));case 6:e.t1=e.sent,(0,e.t0)(e.t1),j(!1);case 9:case"end":return e.stop()}},null,null,null,Promise)},[]);var F=(e,t,s)=>{var o=A.extraData,a=A.settings,r=Object.keys(h.RT);E({settings:n()(n()({},a),e),extraData:o});var l=(0,u.c)(e,(e,t)=>r.includes(e));(0,p.Q)(l)||(0,c.ZP)(i).updateUserSettings(l).fetch().then(()=>{t&&(w(!0),window.location.reload()),null==s||s()})},B=(e,t,s,o)=>{var a=A.extraData,r=A.settings;E({extraData:n()(n()({},a),e),settings:r}),(0,p.Q)(e)||null==t||t.fetch().then(()=>{s&&window.location.reload(),null==o||o()})},D={settings:A.settings,extraData:A.extraData,isFetching:k,isForceReloading:y,merge:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2?arguments[2]:void 0;return F(e,t,s)},mergeExtraData:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;return B(e,t,s,o)},set:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;return F({[e]:t},s,o)},setExtraData:function(e,t,s){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;return B({[e]:t},s,o,n)},toggle:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2?arguments[2]:void 0;return()=>F({[e]:!A.settings[e]},t,s)},select:function(e){var t=e.target,s=t.id,o=t.value,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;return F({[s]:o},n,a)},refetch:()=>{r()().async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=E,e.next=3,r()().awrap(b({apiFetch:i,apiFetchWithSchema:f},s,x));case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}},null,null,null,Promise)}};return(0,g.jsx)(v.Provider,{value:D,children:t})}function x(){var e=(0,d.useContext)(v);if(void 0===e)throw Error("useSettings must be used within a SettingsProvider");return e}},399:(e,t,s)=>{s.d(t,{$G:()=>d,F5:()=>n,MM:()=>a,Pk:()=>o,Qe:()=>h,X:()=>p,ed:()=>u,gz:()=>m,iI:()=>c,m1:()=>l,qg:()=>r});var o=e=>[e("Something went screwy."),e("Something's busted."),e("Something got snagged."),e("Something's acting up."),e("Something sucks!"),e("Internet is being dumb."),e("Computer weirdness."),e("The server is being foolish."),e("Something fizzled."),e("The internet evaporated."),e("The internet is being wiggly."),e("Something went splat."),e("Server turned to dust."),e("Something's wonky."),e("Something's not happening."),e("Something's not working."),e("Something got messed up."),e("Unknown, totally annoying error."),e("A nameless error mysteriously occurred."),e("Our computer is a loser."),e("Something pooped out."),e("Something fell into a volcano."),e("Something is all gummed up."),e("Something melted.")],n=e=>[e("The message displayed when there are no results.","Nothing turned up. Bummer."),e("The message displayed when there are no results.","Looked around but didn’t see anything about that."),e("The message displayed when there are no results.","Sadly, nothing."),e("The message displayed when there are no results.","Tragically, nothing."),e("The message displayed when there are no results.","Welcome to the void. There is nothing here."),e("The message displayed when there are no results.","We found nothing. Here it isn’t."),e("The message displayed when there are no results.","Couldn’t find that. Please, don’t be upset. Please."),e("The message displayed when there are no results. A joke like the end of a written letter.","Sincerely, we found nothing."),e("The message displayed when there are no results.","Nothing to see here."),e("The message displayed when there are no results.","This? Here? Yeah, nothing."),e("The message displayed when there are no results.","If you were looking for nothing, congrats, you found it."),e("The message displayed when there are no results.","Remember: The internet is a series of tubes. Empty, empty tubes.")],a=e=>[e("Meditate for a while on this empty Tumblr."),e("This Tumblr is cool, but empty."),e("This minimalist Tumblr has no posts."),e("Posts? Nah."),e("This Tumblr is content-free.")],r=(e,t,s)=>[e("This post isn't here anymore, but the Tumblr still is."),t("Error message for missing post. Placeholder is a blog name.","This post is gone, gone, gone. But there's more, more, more, on %1$s's Tumblr.",[s]),t("Error message for missing post. Placeholder is a blog name.","Ghost post! Spooky. See what else is haunting %1$s's Tumblr.",[s]),e("You're too late. This post is no more."),e("This post has ceased to exist."),e("This post went to heaven.")],i=e=>[e("The message displayed when there are no search results.","Maybe you spelled it wrong?"),e("The message displayed when there are no search results.","Your search returned nothing, nothing, nothing."),e("The message displayed when there are no search results.","Maybe try a similar search but use different words? Dunno."),e("The message displayed when there are no search results.","Aw, we don’t have anything about that. Sorry."),e("The message displayed when there are no search results.","That search was weird and we didn’t really “get” it."),e("The message displayed when there are no search results.","That search was amazing, but the world just isn’t ready for it.")],l=e=>[...n(e),...i(e)],d=(e,t)=>[e("Error message for empty search text. Placeholder is the search text.","No posts for %1$s",[t]),e("Error message for empty search text. Placeholder is the search text.","This Tumblr is cool, but empty for %1$s",[t]),e("Error message for empty search text. Placeholder is the search text.","This Tumblr is content-free for %1$s",[t])],h=e=>[e("No search result found for message recipients","That isn't anyone."),e("No search result found for message recipients","Uh, who?"),e("No search result found for message recipients","Huh what?"),e("No search result found for message recipients","Never heard of 'em."),e("No search result found for message recipients","???"),e("No search result found for message recipients","Eh?"),e("No search result found for message recipients","Whaaa?")],c=e=>{var t=[e("Error message when a user tries to tip themself","Really...?"),e("Error message when a user tries to tip themself","Cheatin' uh?"),e("Error message when a user tries to tip themself","It looks like you're trying to launder money, not that i know what that means!"),e("Error message when a user tries to tip themself","You deserve great things. But not like this."),e("Error message when a user tries to tip themself","Mission impossible"),e("Error message when a user tries to tip themself","That would be counter productive."),e("Error message when a user tries to tip themself","nope.gif")];return t[Math.floor(Math.random()*t.length)]},u=e=>{var t=[e("[TumblrMart] Text describing what one thinks about when they remember crabs","a salty summer breeze"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","drawn butter and a squirt of lemon juice"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","the turning of the tides"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","eurphoric sunsets on the beach"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","the sound of tiny waves splashing on the sand"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","the many waves that flow through clouds and sunken caves"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","the color of the sky")];return t[Math.floor(Math.random()*t.length)]},p=e=>[e("Post form crash","A wild tumbeast ate your post! Sorry about that - we'll try to rein this one in!"),e("Post form crash","Your post was too out of this world and crashed the editor!"),e("Post form crash","Our editor is not cool enough (yet) to handle your post!")],m=e=>{var t=[e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","the burdens of a life well lived"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","the rich smell of leather"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","arriving at a destination on the back of my best friend"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","strong galloping sounds"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","kisses from a big, wet mouth"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","secret confessions that are only uttered at death's door"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","an autumn walk through a cemetery")];return t[Math.floor(Math.random()*t.length)]}},95867:(e,t,s)=>{s.d(t,{ZP:()=>u,jx:()=>h,n5:()=>c});var o=s(33970),n=s.n(o),a=s(95004),r=s(5553),i=s(44561),l=s(49116),d="lastSelectedBlog",h=e=>{var t;try{t=JSON.parse(l.E.getItem(d)||"null")}catch(e){}return null==e?void 0:e.find(e=>{var s;return e.uuid===(null===(s=t)||void 0===s?void 0:s.uuid)})},c=e=>{l.E.setItem(d,JSON.stringify(e))};let u=()=>{var e=(0,a.useState)(),t=n()(e,2),s=t[0],o=t[1],l=(0,r.n)().data;return(0,a.useEffect)(()=>{var e=h(l||[]),t=(0,i.Z)(l||[]);o(e||t)},[l]),{selectedBlog:s,onChangeSelectedBlog:e=>{o(e),c(e)}}}},44663:(e,t,s)=>{s.d(t,{Z:()=>n});var o=s(71650);let n=e=>new URL(e.startsWith("mailto:")?e:(0,o.J)(e)&&!e.startsWith("mailto:")?`mailto:${e}`:/:\/\//.test(e)?e:`https://${e}`)},71650:(e,t,s)=>{s.d(t,{J:()=>o});var o=e=>/\S+@\S+\.\S+/i.test(e)},68859:(e,t,s)=>{s.d(t,{Z:()=>o});let o=e=>{if(!e)return!1;try{t=new URL(e)}catch(e){return!1}var t,s=t.hostname;return"safe.txmblr.com"===s||/(?:^tumblr|\.tumblr)\.(?:com|net)$/.test(s)}},43747:(e,t,s)=>{s.d(t,{Z:()=>o});function o(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return!1;var s="%[0-9a-fA-F]{2}",o=`([a-zA-Z0-9$\\-_.+!*"(),;:&=]|${s})+@`,n="(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])",a=`(${n}(\\.${n}){3})`,r="a-zA-Z0-9\\-\\_\\~",i="\\u00C0-\\u9FFF",l=`([${r}${i}]+\\.)+([a-zA-Z]{2,})`,d=`(${a}|localhost|${l})(:[0-9]+)?`,h=`${r}${i}.:\\[\\]@!$&'()*+,;=`,c=`([${h}]|${s})*`,u=`${c}(\\/${c})*`,p=`\\?([${h}/?]|${s})*`,m=`\\#([${h}/?]|${s})*`;return!0===RegExp(`^${t?"(http|https):\\/\\/":"((http|https):\\/\\/)?"}(${o})?${d}(\\/?(${u})?(${p})?(${m})?)?$`).test(e)}},60042:(e,t,s)=>{s.d(t,{Ev:()=>r,ag:()=>i,bG:()=>l,oL:()=>a});var o=s(94576),n=s(68859);function a(e,t){var s,a=o=>{var a=function(e){var t,s=e.origin,o=e.source,a=e.data;if(!(a&&s&&o)||!(0,n.Z)(s))return null;try{t=JSON.parse(a)}catch(e){return null}if(!t.method)return null;var r=t.method.match(/^([^:]+):(.+)$/);if(!r)return null;var i=r[1],l=r[2],d=t.args[0];return{origin:s,namespace:i,name:l,source:o,cid:t.cid,data:d}}(o);if(a&&a.namespace===e){if("_syn"===a.name){s={namespace:e,source:a.source,origin:a.origin},function(e,t,s,o){var n=JSON.stringify({method:`${s}:_method_callback_responder`,args:[o]});e.postMessage(n,t)}(a.source,a.origin,e,{response:"ack",cid_response:a.cid});return}t[a.name]&&t[a.name](a.data)}};return(0,o.Rr)("message",a),{handler:a,getChannelInfo:()=>s}}function r(e){(0,o.oQ)("message",e)}var i={listen:a,unlisten:r};function l(e,t,s){var o=e.source,n=e.target,a=e.namespace,r=JSON.stringify({method:`${a}:${t}`,args:[s]});o.postMessage(r,n)}},83875:(e,t,s)=>{s.d(t,{Y:()=>a});var o=s(43523),n=s(5700),a=e=>{switch(e){case n.hQ.Text:return o.J.PFComposePostText;case n.hQ.Audio:return o.J.PFComposePostAudio;case n.hQ.Photo:return o.J.PFComposePostPhoto;case n.hQ.Quote:return o.J.PFComposePostQuote;case n.hQ.Link:return o.J.PFComposePostLink;case n.hQ.Chat:return o.J.PFComposePostChat;case n.hQ.Video:return o.J.PFComposePostVideo}}},59379:(e,t,s)=>{s.d(t,{h:()=>n});var o=s(22979),n=e=>{var t=e.editablePost,s=e.isReblog,n=e.isReblogWithPaywall,a=e.isInbox,r=e.isAsk,i=e.isPrefilledPost,l=e.isReblogWithPoll;return!!(null!=t&&t.isBlocksPostFormat||s&&t&&(0,o.WN)(t))||!!l||!!n||!!r||null!=t&&!!t.isAdFreeGiftAsk||null!=t&&!!t.isTumblrmartGiftAsk||!!a&&!(null!=t&&t.isSubmission)||!!i}},8737:(e,t,s)=>{s.d(t,{Ly:()=>i,Tf:()=>a,r9:()=>r});var o=s(49116),n="reblogPostData",a=(e,t)=>{try{var s=o.E.getItem(n);if(s){var a=JSON.parse(s),r=a.postId,l=a.placementId,d=a.isLongPost,h=a.tabId;if(e!==r)return i(),{placementId:t};return{placementId:l,isLongPost:d,tabId:h}}return{placementId:t}}catch(e){return{placementId:t}}},r=(e,t,s,a)=>{try{o.E.setItem(n,JSON.stringify({postId:e,placementId:t,isLongPost:s,tabId:a}))}catch(e){}},i=()=>{try{o.E.removeItem(n)}catch(e){}}},82560:(e,t,s)=>{s.d(t,{fE:()=>n});var o=s(59379),n=e=>{var t=e.isMobile,s=e.features,n=s.redpopDesktopEditorBeta,a=s.legacyEditorAccess,r=e.editablePost,i=e.isReblog,l=e.isReblogWithPaywall,d=e.isInbox,h=e.isAsk,c=e.isPrefilledPost,u=e.isReblogWithPoll,p=e.isPremiumPartner;return!(0,o.h)({editablePost:r,isReblog:i,isReblogWithPaywall:l,isAsk:h,isInbox:d,isPrefilledPost:c,isReblogWithPoll:u})&&(null!=r&&!!r.shouldOpenInLegacy||!t&&!!(a||p)&&!n)}}}]);