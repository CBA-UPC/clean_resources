;
(self.AMP=self.AMP||[]).push({m:0,v:"2401191523000",n:"amp-image-lightbox",ev:"0.1",l:!0,f:function(t,i){!function(){l=v=Array.isArray;r p=Object.prototype;.hasOwnProperty,p.toString;var g,y=),w={LINEAR:EASE:function(t){return y.solveYValueFromXValue(t,0,0,.25,.1,.25,1,1,1)},EASE_IN:function(t){return y.solveYValueFromXValue(t,0,0,.42,0,1,1,1,1)},EASE_OUT:function(t){return y.solveYValueFromXValue(t,0,0,0,0,.58,1,1,1)},EASE_IN_OUT:,M={"linear":w.LINEAR,"ease":w.EASE,"ease-in":w.EASE_IN,"ease-out":w.EASE_OUT,"ease-in-out":w.EASE_IN_OUT};nction A(t,i,n,s,h,r,e,u,o,a,f){return t}}function z(t){return k(Number(t.left),Number(t.top),Number(t.width),Number(t.hei(u)}}var Y,X=/(\S+)(?:\s+(?:(-?\d+(?:\.\d+)?)([a-zA-Z]*)))?\s*(?:,|$)},t}();function R(t,i){return D(t.width!=i.width,"Duplicate width: %s",t.width),t.width-i.)}var L=["Webkit","webkit","Moz","moz","ms","O"n])}function $(t){return"".concat(t,")}function H(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return function(n,s){return tn,s)})).filter(d).joi*n}}function q(t,i){return function(n){return F(t(n),null==i?void 0:i,n)}function Q(t,i,n,s){return A(i<=n),K(t,i-si*i)}ve},t}();self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var nt=self.__AM lt,vt=function(t){return ft(t,"timer"nc")},dt="Animation",pt=function())},t}}}n lt}function wt(t){return!!(t.complete||"complete"==t.readySName}(t)&&t.readyState>0||t.document&&"complete"==t.document.readyState)}v0},t})},t}(),Et="__AMP_Gesturent=)},t}{},t}(),St=function(){},jt=.02,kt=Math.round(-16.67/Math.log(1-h)}function It(t,i,n,s,h,r,e){return new Yt(t,i,n,s,h,r,e).start()}var Yt=function(){function t(t,i,n,s,h,r,e){this.Hs=e||mt(self),this.ja=t,this.At=r,this.LM=i,this.UM=n,this.XY=s,this.ZY=h,this.BM=0,this.FM=0;var u=new l;this.La=u.promise,this.Jt=u.resolve,this.Ha=u.reject,this.JY=!1}var i=t.prototype;return i.start=function(){return this.JY=!0,Math.abs(this.XY)<=jt&&Math.abs(this.ZY)<=jt?(this.QY(),this.DZ(!0)):this.YZ(),this},i(!1)},is.La},i.thenAi,i)},i.YZ=function(){this.BM=this.XY,this.FM=this.ZY;var t=this.ZZ.bind(this),i=this.DZ.bind(this,!0);return this.Hs.runAnimMutateSeries(this.ja,t,5e3).then(i,i)},i.ZZ=function(t,i){if(!this.JY)return!1;if(this.LM+=i*this.BM,this.UM+=i*this.FM,!this.QY())return!1;var n=Math.exp(-t/kt);return this.BM=this.XY*n,this.FM=this.ZY*n,Math.abs(this.BM)>jt||Math.abs(this.FM)>jt},i.DZ=function(t){this.JY&&(this.JY=!1,this.QY(),t?this.Jt():this.Ha())}.UM)},t}(),Xt=function(t){s(n,t);var i=u(n);function n(t){var n;return(n=i.call(this,"tap",t)).CM=0,n.DM=0,n.LM=0,n.UM=0,n.h=null,n}var h=n.prototype;return h.onTouchStart=function(t){var i=t.touches;return this.h=t.target,!(!i||1!=i.length||(this.CM=i[0].clientX,this.DM=i[0].clientY,0))},h.onTouchMove=function(t){var i=t.changedTouches||t.touches;if(i&&1==i.length){this.LM=i[0].clientX,this.UM=i[0].clientY;var n=Math.abs(this.LM-this.CM)>=8,s=Math.abs(this.UM-this.DM)>=8;if(n||s)return!1}return!0},h.onTouy(0)},h.acceptStart=function(){this.signalEmit({clientX:this.LM,clientY:this.UM,target:this.h},null),this.signalEnd()},n}(Ot),Nt=function(t){s(n,t);var i=u(n);function n(t){var n;return(n=i.call(this,"doubletap",t)).CM=0,n.DM=0,n.LM=0,n.UM=0,n.$Z=0,n.VZ=null,n}var h=n.prototype;return h.onTouchStart=function(t){if(this.$Z>1)return!1;var i=t.touches;return!(!i||1!=i.length||(this.CM=i[0].clientX,this.DM=i[0].clientY,this.LM=i[0].clientX,this.UM=i[0].clientY,0))},h.onTouchMove=function(t){var i=t.touches;if(i&&1==i.length){this.LM=i[0].clientX,this.UM=i[0].clientY;var n=Math.abs(this.LM-this.CM)>=8,s=Math.abs(this.UM-this.DM)>=8;return!n&&!s||(this.acceptCancel(),!1)}return!1},h.onTouchEnd=function(t){this.$Z++,this.$Z<2?this.signalPending(200):(this.VZ=t,this.signalReady(0))},h.acceptStart=function(){this.$Z=0,this.signalEmit({clientX:this.LM,clientY:this.UM},this.VZ),this.signalEnd()},h.acceptC$Z=0},n}(O)},n}(Ot)),Ct=function(t){s(n,t);var i=u(n);function n(t){var n;return(n=i.call(this,"tapzoom",t)).vM=!1,n.CM=0,n.DM=0,n.LM=0,n.UM=0,n.$Z=0,n.HM=0,n.YM=0,n.VM=0,n.GM=0,n.BM=0,n.FM=0,n}var h=n.prototype;return h.onTouchStart=function(t){if(this.vM)return!1;var i=t.touches;return!(!i||1!=i.length||(this.CM=i[0].clientX,this.DM=i[0].clientY,0))},h.onTouchMove=function(t){var i=t.touches;if(i&&1==i.length){if(this.LM=i[0].clientX,this.UM=i[0].clientY,this.vM)this.WM(!1,!1,t);else{var n=Math.abs(this.LM-this.CM)>=8,s=Math.abs(this.UM-this.DM)>=8;if(n||s){if(0==this.$Z)return this.acceptCancel(),!1;this.signalReady(0)}}return!0}return!1},h.onTouchEnd=function(t){this.vM?this.XM(t):(this.$Z++,1!=this.$Z?this.acceptCancel():this.signalPending(400))},h.acceptStart=function(){this.$Z=0,this.vM=!0,this.WM(!0,!1,null)},h.acceptCM=!1},h.WM=function(t,i,n){this.VM=Date.now(),t?this.BM=this.FM=0:this.VM-this.GM>2&&(this.BM=zt(this.LM-this.HM,this.VM-this.GM,this.BM),this.FM=zt(this.UM-this.YM,this.VM-this.GM,this.FM)),this.HM=this.LM,this.YM=this.UM,this.GM=this.VM,this.signalEmit({first:t,last:i,centerClientX:this.CM,centerClientY:this.DM,deltaX:this.LM-this.CM,deltaY:this.UM-this.DM,velocityX:this.BM,velocityY:this.FM},n)}d())},n}(Ot),Tt=new Set(["amp-img","amp-anim","img"]),Ut=["aria-label","aria-describedby","aria-labelledby"],_t=b(.4,0,.2,1),Lt=b(.4,0,.2,1),Pt=b(.4,0,.2,1.4),Zt=function(){function t(t,i,n){this.v1=t,this.win=i,this.di=n,this.Ae=t.element.ownerDocument.createElement("div"),this.Ae.classList.add("i-amphtml-image-lightbox-viewer"),this.l$=t.element.ownerDocument.createElement("img"),this.l$.classList.add("i-amphtml-image-lightbox-viewer-image"),this.Ae.appendChild(this.l$),this.d$=null,this.m$=0,this.p$=0,this.m1=k(0,0,0,0),this.b$=k(0,0,0,0),this.g$=1,this.E$=1,this.S$=1,this.A$=1,this.D$=2,this.CM=0,this.DM=0,this.O$=0,this.j$=0,this.k$=0,this.I$=0,this.P$=0,this.X$=0,this.Y$=null,this.GX()}var i=t.prototype;return i.getElement=function(){return this.Ae},i.getImage=function(){return this.l$},i.getViewerBox=function(){return this.m1},i.getImas.b$},i.getImageBoxWithOffset=function(){return 0==this.O$&&0==this.j$?this.b$:(t=this.b$,i=this.O$,n=this.j$,0==i&&0==n||0==t.width&&0==t.height?t:k(t.left+i,t.top+n,t.width,t.height));var t,i,n},i.reset=function(){var t=this;this.l$.setAttribute("src",""),Ut.fore(i)})),this.l$.removeAttribute("aria-describedby"),this.d$=null,this.b$=k(0,0,0,0),this.m$=0,this.p$=0,this.S$=1,this.g$=1,this.E$=1,this.D$=2,this.CM=0,this.DM=0,this.O$=0,this.j$=0,this.k$=0,this.I$=0,this.P$=0,this.X$=0,this.Y$&&this.Y$.halt(),this.Y$=null},i.C$=function(t,i){i?(this.m$=i.naturalWidth||t.offsetWidth,this.p$=i.naturalHeight||t.offsetHeight):(this.m$=t.offsetWidth,this.p$=t.offsetHeight)},i.init=function(t,i){var n=this;this.C$(t,i),this.d$=function(t){var i=t.getAttribute("srcset");if(i)rN(n)}(i);var n=t.getAttribute("src");return D(n,'Either non-empty "srcset" or "src" attribute must be specified: %s',t),new N([{url:n,width:void 0,dpr:1}])}(t),"img"===t.tagName.toLowerCase()?I(Ut,t,this.l$):t.getImpl()..l$)})),i&&wt(i)&&i.src&&this.l$.setAttribute("src",i.src)},i.measure=function(){this.m1=z(this.Ae.getBoundingClientRect());var t=this.m$/this.p$,i=Math.min(this.m1.width/t,this.m1.height),n=Math.min(this.m1.height*t,this.m1.width);Math.abs(n-this.m$)<=16&&Math.abs(i-this.p$)<=16&&(n=this.m$,i=this.p$),this.b$=k(Math.round((this.m1.width-n)/2),Math.round((this.m1.height-i)/2),Math.round(n),Math.round(i)),Z(this.l$,{top:$(this.b$.top),left:$(this.b$.left),width:$(this.b$.width),height:$(this.b$.height)});var s=this.m1.width/this.m1.height,h=Math.max(s/t,t/s);return this.D$=Math.max(2,h),this.E$=this.g$=1,this.CM=this.O$=0,this.DM=this.j$=0,this.T$(this.g$),this._$(),this.mk()},i.mk=function(){var t=this;if(!this.d$)return c();this.S$=Math.max(this.S$,this.g$);var i=this.b$.width*this.S$,n=this.d$.select(i,it.getDevicePixelRatio());return n==this.l$.getAttribute("src")?c():vt(this.win).promise(1).then((function(){return t.l$.setAttribute("src",n),t.di(t.l$)}))},i.GX=function(){var t=this,i=Dt.get(this.l$);i.onGesture(Xt,(function(){t.v1.toggleViewMode()})),i.onGesture(Rt,(function(i){t.B$(i.data.deltaX,i.data.deltaY,!1),i.data.last&&t.V$(i.data.velocityX,i.data.velocityY)})),i.onPointerlt()})),i.onGesture(Nt,(function(i){var n;n=1==t.g$?t.D$:t.A$;var s=t.m1.width/2-i.data.clientX,h=t.m1.height/2-i.data.clientY;t.U$(n,s,h,!0).0,0)}))})),i.onGesture(Ct,(function(i){t.d1(i.data.centerClientX,i.data.centerClientY,i.data.deltaX,i.data.deltaY),i.data.last&&t.G$(i.data.centerClientX,i.data.centerClientY,i.data.deltaX,i.data.deltaY,i.data.velocityY,i.data.velocityY)}))},i.H$=function(t,i){return Q(t,this.A$,this.D$,i?.25:0)},i.J$=function(t,i){return Q(t,this.k$,this.P$,i&&this.g$>1?.25*this.m1.width:0)},i.K$=function(t,i){return Q(t,this.I$,this.X$,i?.25*this.m1.height:0)},i.T$=function(t){var i=0,n=0,s=this.m1.height-this.b$.height*t;s>=0?n=i=0:i=-(n=s/2);var h=0,r=0,e=this.m1.width-this.b$.width*t;e>=0?r=h=0:h=-(r=e/2),this.k$=r,this.I$=n,this.P$=h,this.X$=i},i._$=function(){Z(this.l$,{transform:F(this.O$,this.j$)+" "+G(this.g$)}),1!=this.g$&&this.v1.toggleViewMode(!0)},i.B$=function(t,i,n){var s=this.J$(this.CM+t,!0),h=this.K$(this.DM+i,!0);this.Q$(this.g$,s,h,n)},i.V$=function(t,i){var n=this,s=this.j$-this.DM;1==this.g$&&Math.abs(s)>10?this.v1.close():(this.Y$=It(this.l$,this.O$,this.j$,t,i,(function(t,i){var s=n.J$(t,!0),h=n.K$(i,!0);return!(Math.abs(s-n.O$)<1&&Math.abs(h-n.j$)<1||(n.Q$(n.g$,s,h,!1),0))})),this.Y$.thenAlMJ()})))},i.d1=function(t,i,n,s){var h=tt(n,s),r=Math.abs(s)>Math.abs(n)?Math.sign(s):Math.sign(-n);if(0!=r){var e=this.E$*(1+r*h/100),u=this.m1.width/2-t,o=this.m1.height/2-i;n=Math.min(u,u*(h/100)),s=Math.min(o,o*(h/100)),this.U$(e,n,s,!1)}},i.U$=function(t,i,n,s){var h=this.H$(t,!0);if(h!=this.g$){this.T$(h);var r=this.J$(this.CM+i*h,!1),e=this.K$(this.DM+n*h,!1);return this.Q$(h,r,e,s)}},i.G$=function(t,i,n,s,h,r){var e,u=this;e=0==h&&0==r?c():It(this.l$,n,s,h,r,(function(n,s){return u.d1(t,i,n,s),!0})).thenAlways();var o=this.g$>this.E$;return e.MJ()})).mk()}))},i.Q$=function(t,i,n,s){var h,r,e,u=this,o=t-this.g$,a=(h=this.O$,r=this.j$,tt(i-h,n-r)),f=0;if(s&&(f=Math.min(250,Math.max(250*a*.01,250*Math.abs(o)))),f>16&&s){var l=W(this.g$,t),v=W(this.O$,i),m=W(this.j$,n);e=bt.animate(this.l$,(function(t){u.g$=l(t),u.O$=v(t),u.j$=m(t),u._$()}),f,Pt).thenAlways((function(){u.g$=t,u.O$=i,u.j$=n,u._$()}))}else this.g$=t,this.O$=i,this.j$=n,this._$(),e=s?c():void 0;return e},i.MJ=function(){var t=this,i=this.H$(this.g$,!1);i!=this.g$&&this.T$(i);var n=this.J$(this.O$/this.g$*i,!1),s=this.K$(this.j$/this.g$*i,!1);return this.Q$(i,n,s,!0).t.j$}))},t}(),$t=function(t){s(h,t);var n=u(h);function h(t){var s;return(s=n.call(this,t)).DX=-1,s.vQ=!1,s.b1=!1,s.g1=null,s.N$=null,s.w1=null,s.Ib=null,s.M1=null,s.E1=null,s.aQ=s.fQ.bind(i(s)),s.registerDefaultAcX(t)}),"open"),s}var r=h.prototype;return r.buildCallback=function(){var t,i,n;(t=this.element,i="action",ct(n=at(ot(t)),i)?ft(n,i):null).addToAllowlist("AMP-IMAGE-LIGHTBOX","open",["email"])},r.A1=function(){var t=this;if(!this.Ib){this.Ib=this.element.ownerDocument.createElement("div"),this.Ib.classList.add("i-amphtml-image-lightbox-container"),this.element.appendChild(this.Ib),this.M1=new Zt(this,this.win,this.loadPromise.bind(this)),this.Ib.appendChild(this.M1.getElement()),this.E1=this.element.ownerDocument.createElement("div"),this.E1.setAttribute("id",this.element.getAttribute("id")+"-caption"),this.E1.classList.add("amp-image-lightbox-caption"),this.E1.classList.add("i-amphtml-image-lightbox-caption"),this.Ib.appendChild(this.E1);var i=this.element.ownerDocument.createElement("button"),n=this.element.getAttribute("data-close-button-aria-label")||"Close the lightbox";i.textContent=n,i.classList.add("i-amphtml-screen-reader"),i.tabIndex=-1,i.addEventListener("clse()})),this.element.appendChild(i);var s=Dt.get(this.element);this.element.addEventListener("click",(function(i){t.b1||t.M1.getImage().contains(i.target)||t.close()})),s.onGesturse()})),s.onGesturn(){}))}},r.FX=function(t){var i,n,s=this;if(!this.vQ){this.A1();var h=t.caller,r=h.tagName.toLowerCase();i=h&&Tt.has(r),"Unsupported element: %s",n=h.tagName,(nt.user||(nt.user=ht()),void nt.user.win?nt.userForEmbed||(nt.userForEmbed=ht()):nt.user).assert(i,"Unsupported element: %s",n,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined),this.vQ=!0,this.Zn(),this.We(h),this.win.document.documentElement.addEventListener("keydown",this.aQ),this.getViewport().enterLightboxMode(),this.Jx(),this.w1=this.getViewport().onChanged((function(){var t;s.vQ&&((t=s.win,ut(t,"platform")).getIosVersionString().startsWith("10.3")?vt(s.win).dre()}),500):s.M1.measure())})),this.QX().push(this.close.bind(this)).DX=t}))}}e())},r.close=function(){this.vQ&&(this.vQ=!1,this.b1=!1,this.Dx(),this.w1&&(this.w1(),this.w1=null),this.getViewport().leaveLightboxMode(),-1!=this.DX&&this.QX().pop(this.DX),this.win.document.documentElement.removeEventListener("keydown",this.aQ),thit){}}(this.g1))},r.toggleViewMode=function(t){void 0!==t?this.Ib.classList.toggle("i-amphtml-image-lightbox-view-mode",t):this.Ib.classList.toggle("i-amphtml-image-lightbox-view-mode")},r.We=function(t){var i;this.g1=t,this.N$=(i=t,j("ll:n}(i,"> ".concat("img"))),this.M1.init(this.g1,this.N$);var n,s=null,h=("figure",(n=t).closest?n.closest("fignul}(t)})));if(r(i)}(h,"figcaption")),!s){var r=t.getAttribute("aria-describedby");s=this.element.ownerDocument.getElementById(rd(n)}(s,this.E1),this.M1.getImage().setAttribute("aria-describedby",this.E1.getAttribute("id"))),this.E1.classList.toggle("i-amphtml-empty",!s)},r.Zn=function(){this.M1.reild)}(this.E1),this.g1=null,this.N$=null,this.toggleViewMode(!1)},r.Jx=function(){var t,i,n=this;this.b1=!0,t=this.element,void 0===(i=!0)&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden",""),Z(this.element,{opacity:0}),this.M1.measure();var s=new bt(this.element);s.add(0,V(this.element,{opacity:W(0,1)}),.6,_t);var h=null;if(this.N$&&wt(this.N$)&&this.N$.src){(h=this.element.ownerDocument.createElement("div")).classList.add("i-amphtml-image-lightbox-trans"),this.getAmpDoc().getBody().appendChild(h);var r=z(this.N$.getBoundingClientRect()),e=this.M1.getImageBox(),u=this.N$.cloneNode(!0);u.className="",Z(u,{position:"absolute",top:$(r.top),left:$(r.left),width:$(r.width),height:$(r.height),transformOrigin:"top left",willChange:"transform"}),h.appendChild(u),this.N$.classList.add("i-amphtml-ghost");var o=e.left-r.left,a=e.top-r.top,f=0!=r.width?e.width/r.width:1,c=K(Math.abs(a)/250*.8,.2,.8);s.add(0,V(u,{transform:H([q(W(0,o),W(0,a)),J(W(1,f))])}),c,_t),Z(this.Ib,{opacity:0}),s.add(.8,V(this.Ib,{opacity:W(0,1)}),.1,_t),s.add(.9,V(h,{opacity:W(1,.01)}),.1,Lt)}return s.start(500).thenAlways((function(){n.b1=!1,Z(n.element,{opacity:""}),Z(n.Ib,{opacity:""}),h&&n.getAmpDoc().getBody().removeChild(h)}))},r.Dx=function(){var t=this,i=this.M1.getImage(),n=this.M1.getImageBoxWithOffset(),s=new bt(this.element),h=500;s.add(0,V(this.element,{opacity:W(1,0)}),.9,Lt);var r=null;if(wt(i)&&i.src&&this.N$){(r=this.element.ownerDocument.createElement("div")).classList.add("i-amphtml-image-lightbox-trans"),this.getAmpDoc().getBody().appendChild(r);var e=z(this.N$.getBoundingClientRect()),u=i.cloneNode(!0);Z(u,{position:"absolute",top:$(n.top),left:$(n.left),width:$(n.width),height:$(n.height),transform:"",transformOrigin:"top left",willChange:"transform"}),r.appendChild(u),s.add(0,V(this.Ib,{opacity:W(1,0)}),.1,Lt);var o=e.left-n.left,a=e.top-n.top,f=0!=n.width?e.width/n.width:1,c=V(u,{transform:H([q(W(0,o),W(0,a)),J(W(1,f))])}),l=K(Math.abs(a)/250*.8,.2,.8);s.add(Math.min(.8-l,.2),(function(i,n){c(i),n&&t.N$.classList.remove("i-amphtml-ghost")}),l,Lt),s.add(.8,V(r,{opacity:W(1,.01)}),.2,Lt),h=K(Math.abs(a)/250*h,300,h)}return s.start(h).thenAlways((function(){t.N$&&t.N$.classList.remove("i-amphtml-ghost"),t.collapse(),Z(t.element,{opacity:""}),Z(t.Ib,{opacity:""}),r&&t.getAmpDoc().getBody().removeChild(r),t.Zn()}))},r.QX=function(){rry")}(this.getAmpDoc())},h}(t.BaseElement);t.registerElement("amp-image-lightbox",$t,"amp-image-lightbox{position:fixed!important;top:0!important;left:0!important;bottom:0!important;right:0!important;margin:0!important;padding:0!important;overflow:hidden!important;transform:translateZ(0)!important;-ms-touch-action:none!important;touch-action:none!important;z-index:1000;background:rgba(0,0,0,0.95);color:#f2f2f2}.i-amphtml-image-lightbox-container{position:absolute;z-index:0;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-lightbox-trans{pointer-events:none!important;position:fixed;z-index:1001;top:0;left:0;bottom:0;right:0}.i-amphtml-image-lightbox-caption{position:absolute!important;z-index:2;bottom:0!important;left:0!important;right:0!important}.i-amphtml-image-lightbox-caption.i-amphtml-empty,.i-amphtml-image-lightbox-view-mode .i-amphtml-image-lightbox-caption{visibility:hidden}.amp-image-lightbox-caption{background:rgba(0,0,0,0.5);max-height:25%;padding:8px}.i-amphtml-image-lightbox-viewer{position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-lightbox-viewer-image{position:absolute;z-index:1;display:block;transform-origin:50% 50%}\n/*# sourceURL=/extensions/amp-image-lightbox/0.1/amp-image-lightbox.css*/")}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-image-lightbox-0.1.js.map