(self.webpackChunk=self.webpackChunk||[]).push([[603],{99475:function(e,t,i){i.r(t),i(66403),i(48868),i(92274),i(63045),i(81874),i(54861);var a=i(72957),n=new a.c1("interface.AppCenterInterface"),o=$.createClass((0,a.$N)("interface.AppCenterInterface"));$.AppCenterInterface=o,$.Object.extend(o,{entry:function(e){var t="t2";(0,a.$S)("isVip")&&(t="recommend_app");var n=$.Array.findObject($G.get("multiTabConf"),"tabid",t)||{},o={};e&&e.showinfo&&(o.showinfo=e.showinfo),e&&e.name&&(n.name=e.name),Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:n.name,title:n.text,fullScreen:n.fullScreen,group:n.group,param:o})})))},entryAndShowApp:gotoApp:function(e){var t=this;if($.Object.isObject(e)){var n=e,o=n.key,r=n.title,s=n.url;r&&s?Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink(n)}))):c(o)}else c(e);function c(e){var i=$.AppManager.getApp(e),n=i&&i.display;(0,a.$S)("isVip")&&(n=!$.Object.isEmpty(i)),n?$.AppManager.startApp(e):t.entryAndShowApp(e)}},gotoCorpApp:function(e){var t=e.url||e.id,a={};if(e.newWindow){var n=$.Uri.getUrl(t);n&&window.open(n)}else Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(i){var n=i.default,o={key:t,title:e.name,fullScreen:!0,param:a};e.isBeta&&(o.isBeta=!0),n.goOutlink(o)})))},gotoYiqipin:function(e,t){var i=this;i.gotoApp({key:i.appIdForYiqipin(),title:n.t("ä¸€èµ·æ‹¼"),url:t&&t.indexOf("https://")>-1?t:"https://pin.mail.163.com?utm_source=webmail&utm_medium="+e,fullScreen:!0,appId:i.appIdForYiqipin()})},appIdForYiqipin:function(){var e=window.location.host;return e.indexOf("o.mail")>-1||e.indexOf("d.mail")>-1?62001:152e3}}),t.default=o},24659:function(e,t,i){i(48868),i(92274),i(63045),i(81874),i(54861),i(55737);var a=i(72957),n=i(39579),o=new a.c1("interface.AppInterface"),r=$.createClass((0,a.$N)("interface.AppInterface"));$.AppInterface=r,$.Object.extend(r,{meitu:{compose:function(e){Promise.resolve().then(i.bind(i,54107)).then($.Function.bind((function(t){t.default.entry(e)})))}},cloudmusic:{setMusicBox:function(e){r._setBox(e,"ifrmMusic")},goMusicBox:function(e){var t=e&&e.url||"https://music.163.com/musicbox?ref=mail#https://"+(0,a.$S)("host")+"/proxy.htm",n="music_outlink";Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:n,title:o.t("ç½‘æ˜“äº‘éŸ³ä¹"),url:t,fullScreen:!0,group:n,removeSameModule:!0})}))),$.Log.cache({topNav_musicPlugin_click:1})}},vipMsgCenter:{setBox:function(e){r._setBox(e,"ifrmVipMsgCenter")},gotoPage:function(e){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(t){t.default.goOutlink({key:e,title:o.t("æ¶ˆæ¯ä¸­å¿ƒ"),fullScreen:!0,group:"vipMsgCenter"})}))),$.Log.cache({topNav_vipMsgCenter_click:e})}},mailmaster:{setBox:function(e){r._setBox(e,"ifrmMailMaster")},bodyClick:function(e){var t=this,i=(e=e||{}).call;$.fly(document).listen("click",(function(){i&&i(),t.changeIframeIndex(!0,!0)})),$.Listener.fire("plugin:mailmaster_photouploader_loaded")},setWrapperStyle:function(e){var t=(e=e||{}).images,i=$("#dvIfrmMailMasterWrapper");t&&t.length>0?(delete e.images,window.gAppInterface_MailMaster_ImageIndex=0,window.gAppInterface_MailMaster_ImageIntervel&&window.clearInterval(window.gAppInterface_MailMaster_ImageIntervel),1===t.length?i.css({background:t[window.gAppInterface_MailMaster_ImageIndex]}):window.gAppInterface_MailMaster_ImageIntervel=window.setInterval((function(){window.gAppInterface_MailMaster_ImageIndex++,window.gAppInterface_MailMaster_ImageIndex===t.length&&(window.gAppInterface_MailMaster_ImageIndex=0),i.css({background:t[window.gAppInterface_MailMaster_ImageIndex]})}),400)):window.gAppInterface_MailMaster_ImageIntervel&&window.clearInterval(window.gAppInterface_MailMaster_ImageIntervel),e.cursor||(e.cursor="pointer"),e.zIndex&&e.zIndex>0?(this.changeIframeIndex(!0),delete e.zIndex):this.changeIframeIndex(!1),i.css(e)},changeIframeIndex:function(e,t){var i="cachedvIfrmMailMasterWrapper",n=(0,a.$S)(i);if(!n){if(!(n=$("#dvIfrmMailMasterWrapper")))return;(0,a.$S)(i,n.findParent("li"))}if(e){if(!(0,a.$S)("ifrmMailMasterTop")&&!t){var o=$("#ifrmMailMaster");o&&o.css({top:"-15px"}),(0,a.$S)("ifrmMailMasterTop",!0)}n.addClass("hj1")}else n.removeClasreviewImages(e.images)},frameClick:function(e){(0,a.$S)("accountMenu")&&(0,a.$S)("accountMenu").hide(),$.Menu&&$.Menu.hideAllMenu(),this.changeIframeIndex(!1),$.Log.cache({topNav_mailmaster_photoloader_click:!0})}},bridge:{wmsvr:function(e){var t=new(0,n.Z),i=(e=e||{}).call,a=e.wmsvrData;i&&a&&(a.call=function(e){i(e)},a.error=function(){},t.wmsvr(a))}},_previewImages:function(e){var t=this,i=window.Preview;0!==(e=e||[]).length&&(i?i.init({mustArr:!1,data:e}):$.Ajax.request({requestType:$.Ajax.SCRIPT,url:"https://mimg.127.net/xm/all2/preview/preview-1.6.min.js",call:function(){void 0!==window.Preview&&t._previewImages(e)}}))},_setBox:function(e,t){var i=(e.height||20)+"px",a=(e.width||20)+"px",n=$("#"+t),o={height:i,width:a};if(e.left&&$.Object.isNumber(parseInt(e.left,10))){var r=e.left+"px";o.left=r}$.Browser.chrome()&&"$.AppInterface.cloudmusic.setMusicBox"===e.xcall&&(o.width=Math.max(parseInt(e.width),392)+"px"),n.css(o)}})},52337:function(e,t,i){var a=i(72957),n=i(99626),o=new a.c1("module.address.AddressListener"),r=$.createClass((0,a.$N)("module.address.AddressListener"));function s(){var e=this.module;try{e.refresh()}catch(e){a.$D.log(o.t("é€šè®¯å½•ç›‘å¬é”™è¯¯"))}}$.Object.inherit(r,n.Z,{_listeners:{"addr:dataInit":{handler:s},"addr:dataReset":{handler:s}}}),t.Z=r},69844:function(e,t,i){i(66403),i(803),i(99139),i(92274),i(75654),i(37092),i(79150),i(42295),i(52963),i(15761),i(20869),i(63518),i(26340),i(34994);var a=i(27018),n=i(64560),o=i(77454),r=i(52337),s=i(72957),c=i(28978),l=i(66488),d=new s.c1("module.address.AddressModule"),u=$.Object,m=$.Email,p=$.Log,f=$.EMAIL_ADDRESS,h=$.EMAIL_ID,g=$.createClass((0,s.$N)("module.address.AddressModule"));u.mix(g,c.Z,{Listener:r.Z,View:o.Z},{initialize:function(e){e=this,u.extend(e,{status:{},element:{},component:{}}),g.superClass.initialize.call(e,e)},getData:function(e){e&&e()},init:function(){var e=this;e.element,e.set({element:"list",value:$("#"+e.createId("list"))}),e.set({element:"search",value:$("#"+e.createId("search"))}),e.render("list"),e.set({status:"show",value:"list"})},cfresh:function(){this.render("list")},set:function(e){var t=this,i=e.value;"string"==typeof e.status?t.status[e.status]=i:"string"==typeof e.element?t.element[e.element]=i:"string"==typeof e.component&&(t.component[e.component]=i)},get:function(e){var t=this;return"string"==typeof e.status?t.status[e.status]:"string"==typeof e.element?t.element[e.element]:"string"==typeof e.component?t.component[e.component]:void 0},render:function(e){var t=this,i={group:[]};if("list"==e){var o=[],r={type:"spec",item:o},s=t.adCompose();s.length&&o.push.apply(o,s),o.push({type:"me",name:d.t("ç»™è‡ªå·±å†™ä¸€å°ä¿¡"),email:new m(n.default.getAccount().address,d.t("æˆ‘"))}),i.group.push(r)}var c=a.default.data.extDataMap.groupArray||[],l=[];try{l=c[0].CONTACTS}catch(e){}var u={type:"all",name:l.length?d.t("æ‰€æœ‰"):d.t("æ‰€æœ‰è”ç³»äºº"),nameTitle:d.t("æ‰€æœ‰è”ç³»äºº"),sumTitle:d.t("æ·»åŠ æ‰€æœ‰è”ç³»äºº"),item:[]},p={};$.Array.each(l,(function(e,i){var a=t.filterItem(i);a&&(u.item.push(a),p[a.id]=u.item.length-1)})),u.item.length>500&&(u.fold=!0),$.Array.each(c,(function(e,a){if(0===e)return $.CONTINUE;var n=t.filterGroup(a,p,u.item);n&&(n.fold=!0,n.sumTitle=d.t("æ·»åŠ è¯¥ç»„è”ç³»äºº"),i.group.push(n))})),i.group[i.group.length-1].hasLine=!0,i.group.push(u);var f=t.get({element:"list"});f.empty(),f.append(t.renderTree(i).dom),t.renderMark(p,u.item),a.default.getRecentContact({call:$.Function.bind(t.renderCommon,t)})},adCompose:function(){var e=[];try{e=window.fAdAddressModuleLink()}catch(e){}return $.Array.each(e,(function(e,t){t.border=!0,t.type||(t.type="other")})),e},fillGroup:function(e){var t=tf(i.addClass("nui-tree"),"spec"==e.type)$.Array.each(e.item,(function(e,a){i.append(t.renderItem(a).dom)})),e.element.append(i.dom);else{for(var n=e.item.length,o=[],r=0;r<n;r++){var s="";if((w=e.item[r]).email){s=w.email.defaultName;var c="";w.type&&"vip"==w.type&&(c='<b class="nui-ico nui-ico-user nui-ico-user-vip"></b>');var u='<li data-id="'+r+'"><a href="javascript:void(0)" class="pW0">'+c+$.String.encodeHTML(s);w.yellowPage&&(u+='<b companyId="'+w.yellowPage+'" class="nui-ico nui-ico-yellowpage"></b>'),u+="</a></li>",o.push(u)}else if(w.emails)for(var f=0;f<w.emails.length;f++){c="";var h=w.emails[f];s=new m(h,w.name).defaultName,h&&m.checkVip(h)&&(c='<b class="nui-ico nui-ico-user nui-ico-user-vip"></b>'),u='<li data-id="'+r+'" data-sub="'+f+'"><a href="javascript:void(0)" class="pW0">'+c+$.String.encodeHTML(s),w.yellowPage&&(u+='<b companyId="'+w.yellowPage+'" class="nui-ico nui-ico-yellowpage"></b>'),u+="</a></li>",o.push(u)}}if(i.dom.innerHTML=o.join(""),i.listen("click",(function(i){var a=C(i);if(void 0!==a)if(a.companyId){var n="http://114.163.com/company/"+a.companyId;window.open(n),p.cache({cl_yellowpage:"1"},$.EMPTYFUNC)}else{var o=a.index,r=e.item[o];if(void 0!==a.sub){var s=r.emails[a.sub],c={email:new m(s,r.name)};t.addItem(c)}else t.addItem(r);p.cache({cl_item:"1"},$.EMPTYFUNC)}})),"common"!=e.type)try{i.listen("contextmenu",(function(i){var n=C(i);if(void 0!==n&&n.index>=0){var o,r=n.index,s=e.item[r];void 0!==n.sub&&(o=s.emails[n.sub]);var c={groups:[{items:[{text:d.t("ç¼–è¾‘"),click:function(){a.default.contactDialog({type:"modify",addr:{id:s.id,email:o},callback:function(){t.refresh()}})}},{text:d.t("åˆ é™¤"),click:function(){o?a.default.deleteContactAttr({id:s.id,type:"email",value:o,call:function(){t.refresh()}}):a.default.deleteContact({contacts:[s.id],call:function(){t.refresh()}})}}]}],width:"120px"};l.Z.show(c)}}))}catch(e){}e.element.append(i.dom);var g=i.dom.getElementsByTagName("LI"),v=g.length;for(r=0;r<v;r++){var b=g[r],y=b.getAttribute("data-id"),x=b.getAttribute("data-sub"),k="";try{if(null!==y){var S=parseInt(y,10),w=e.item[S];if(null!==x){var T=parseInt(x,10);k=w.emails[T]}else k=w.email.address}}catch(e){}b.title=k}}e.element.set("fill",!0)}function C(e){var t=$.Event.getTarget(e);if("B"==t.tagName.toUpperCase()){var i=t.getAttribute("companyId");if(null!==i)return{companyId:i};t=t.parentNode.parentNode}if("A"==t.tagName.toUpperCase()&&(t=t.parentNode),"LI"==t.tagName.toUpperCase()){var a=t.getAttribute("data-id"),n=t.getAttribute("data-sub");if(null!==a){var o={index:parseInt(a,10)};if(null!==n){var r=parseInt(n,10);o.sub=r}return o}}}},filterGroup:function(e,t,i){var a=this,n=null;if(e.N){var o=e.CONTACTS;if(o.length){var r=[];$.Array.each(o,(function(e,n){var o=a.filterItem(n,t,i);o&&r.push(o)})),r.length&&(n={id:e.id,name:e.N,item:r})}}return n},filterItem:function(e,t,i){var n=null;if(t)n=i[t[e[h]]];else{var o=null,r=e[h];if(r){var s=a.default.data.extDataMap.contactLite[r];if(s&&s.email&&s.email.length){var c=s.email;n={id:e[h],yellowPage:s.yellowPage},1==c.length?(n.email=new m(c[0],s.name),o=c[0]):c.length>1&&(n.emails=c,n.name=s.name)}}else o=e[f],n={email:new m(o)};o&&n&&m.checkVip(o)&&(n.type="vip")}return n},renderTree:function(e){var t=this,i=$.Element.create("DIV");return e.group&&$.Array.each(e.group,(function(e,a){if(i.append(t.renderGroup(a).dom),a.hasLine){var n=$.Element.create("DIV");n.setClass("nui-split nui-split-dotted"),i.append(n.dom)}})),i},renderGroup:function(e){var t=this,i=e.element=$.Element.create("DIV");if(i.addClass("nui-tree-item"),"spec"==e.type)i.addClass("nui-tree-item-spec");else{var a=$.Element.create("SPAN");if(a.addClass("nui-tree-item-label"),e.name){i.set("foldText",d.t("æŠ˜å ")),i.set("unfoldText",d.t("å±•å¼€"));var n=$.Element.create("A");n.addClass("g-contacts-groups-name"),n.attr({href:"javascript:void(0)"});var o=$.Element.create("SPAN");o.addClass("nui-tree-item-symbol"),a.listen("click",(function(){var a=!i.get("fold"),o=i.get(a?"unfoldText":"foldText");a?i.setClass("nui-tree-item nui-tree-item-isFold"):(!0!==i.get("fill")&&t.fillGroup(e),i.setClass("nui-tree-item nui-tree-item-isUnfold")),n.attr({title:o}),i.set("fold",a)})),a.append(o.dom),new $.Icon({type:"rArr",title:d.t("å±•å¼€"),extcls:"nui-tree-item-symbol-fold",renderTo:o.dom}),new $.Icon({type:"dArr",title:d.t("æŠ˜å "),extcls:"nui-tree-item-symbol-unfold",renderTo:o.dom});var r=e.name.substr(0,7);r!=e.name&&(r+=".."),r=$.String.encodeHTML(r),r+="("+e.item.length+")";var s=$.Element.create("span");s.attr({title:e.nameTitle||e.name}),s.setClass("nui-tree-item-text"),s.html(r),a.append(s.dom)}if(e.item){var c=null,l="nui-tree-item-label-hover";a.listen("mouseover",(function(){a.addClass(l),c?c.show():((c=$.Element.i-txt-link"),c.attr({href:"javascript:void(n("click",(function(i){t.addGroup(e),$.Event.stop(i)})),a.append(c.dom))})),a.listen("mouseout",(function(){a.removeClass(l),c&&c.hide()}))}i.append(a.dom)}return e.fold?(i.addClass("nui-tree-item-isFold"),i.set("fold",!0)):("spec"!=e.type&&i.addClass("nui-tree-item-isUnfold"),i.set("fold",!1),t.fillGroup(e)),i},renderItem:function(e){var t=this,i=$.Element.create("LI");i.addClass("nui-tree-item nui-tree-item-noChild");var a=$.Element.create("A");if(a.addClass("pW0"),a.attr({href:"javascript:void(0)"}),e.click?a.listen("click",e.click):a.listen("click",(function(){t.addItem(e),"me"==e.type&&p.cache({cl_me:"1"},$.EMPTYFUNC)})),e.type){var n=$.Element.create("SPAN");n.addClass("nui-tree-item-icon");var o=$.Element.create("B");switch(o.addClass("nui-ico"),e.type){case"other":o.addClass("nui-ico-user nui-ico-user-other");break;case"me":o.addClass("nui-ico-user nui-ico-user-me");break;default:o.setClass(e.type)}n.append(o.dom),a.append(n.dom)}var r="",s="";return e.email&&(r=e.email.defaultName,s=e.email.toString()),e.name&&(r=e.name),r&&(s||(s=r),a.append(document.createTextNode(r))),e.title&&(s=e.title),s&&a.attr({title:s}),i.append(a.dom),i},renderMark:function(e,t){var i=this,n=a.default.getMarkData(!0),o=[];n&&n.contact&&n.contact.length&&$.Array.each(n.contact,(function(e,t){"group"!=t.ctype&&(t[h]=t.cid,o.push(t))}));var r={N:d.t("æ˜Ÿæ ‡è”ç³»äºº"),CONTACTS:o},s=i.filterGroup(r,e,t);if(s){s.fold=!0,s.type="mark",s.sumTitle=d.t("æ·»åŠ è¯¥ç»„è”ç³»äºº");var c=i.get({element:"list"});$(c.dom.firstChild.firstChild).after(i.renderGroup(s).dom)}},renderCommon:function(e){var t=this;if(!t.get({status:"commonLoad"})&&e&&e.length){var i={N:d.t("å¸¸ç”¨è”ç³»äºº"),CONTACTS:e},a=t.filterGroup(i);if(a){a.fold=!0,a.type="common",a.sumTitle=d.t("æ·»åŠ è¯¥ç»„è”ç³»äºº");var n=t.get({element:"list"});$(n.dom.firstChild.firstChild).after(t.renderGroup(a).dom),t.set({status:"commonLoad",value:!0})}}},renderResult:function(e){var t,i=this,a=$.Element.create("DIV");e.item&&e.item.length?((t=$.Element.create("DIV")).addClass("nui-assistBlock nui-block mp0"),t.html(d.t("æœç´¢åˆ°")+"<strong>"+e.item.length+"</strong>"+d.t("ä¸ªè”ç³»äºº")+'&nbsp;[<a href="javascript:void(0)" class="nui-txt-link">'+d.t("å…¨éƒ¨æ·»åŠ ")+"</a>]"),$.Event.live({context:t,selector:"A",event:"click",handler:function(){i.addGroup(e)}}),a.append(t.dom),$.Array.each(e.item,(function(e,t){var n=$.Element.create("A");n.addClass("kY0"),n.attr({href:"javascript:void(0)",title:t.email.toString()}),i.live(n,"click",(function(e){i.addItem(t)}));var o=$.Element.create("STRONG"),r=t.name||t.email.name;t.yellowPage&&(r+='<b companyId="'+t.yellowPage+'" class="nui-ico nui-ico-yellowpage"></b>'),o.html(r),t.yellowPage&&$(o.dom.lastChild).listen("click",(function(e){var t=$.Event.getTarget(e).getAttribute("companyId");null!==t&&(window.open("http://114.163.com/company/"+t),p.cache({cl_yellowpage:"1"},$.EMPTYFUNC),$.Event.stop(e))}));var s=$.Element.create("P");s.html(t.address||t.email.address),n.append(o.dom),n.append(s.dom),a.append(n.nui-assistBlock nui-block mp0"),t.html(d.t("æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„è”ç³»äºº")+' [<a href="javascript:void(0)" class="back txt-link">'+d.t("è¿”å›")+"</a>]"),t.find("A").listen("click",(function(e){i.searchCancel(),$.Event.cancel(e)})),a.append(t.dom));return a},addGroup:function(e){var t=[];$.Array.each(e.item,(function(e,i){if(i.emails)for(var a=i.emails,n=0;n<a.length;n++){var o=a[n],r=new m(o,i.name);t.push(r)}else t.push(i.email)})),this.addItem({email:t}),p.cache({cl_group:"1"},$.EMPTYFUNC)},addItem:function(e){var t=$.Context.module.form;t.addContact(e.email),t.focus()},addFast:function(){var e=this;a.default.contactDialog({type:"add",callback:function(){e.refresh()}})},searchMatch:function(){var e=this,t=e.get({component:"searchInput"});27==$.Event.getEvent().keyCode&&t.setValue("");var i=$.String.trim(t.getValue());if(i){var a=t.find("icon")[0];a.update({type:"close",title:d.t("å–æ¶ˆ")}),a.getDom().setAttribute("aria-label",d.t("å–æ¶ˆ")),e.resultMatch({key:i})}else e.searchCancel();p.cache({cl_search:"1"},$.EMPTYFUNC)},searchCancel:function(){var e=this;if("search"==e.get({status:"show"})){var t=e.get({component:"searchInput"}),i=t.find("icon")[0];i.update({type:"search",title:d.t("ç«‹å³æŸ¥æ‰¾")}),i.getDom().setAttribute("aria-label",d.t("ç«‹å³æŸ¥æ‰¾")),$.String.trim(t.getValue())&&(t.setValue(""),t.showPlaceholder()),e.resultCancel()}},resultMatch:function(e){e=e||{};var t,i=this,a=i.match(e);t=a.length?i.renderResult({item:a}):i.renderResult({item:null});var n=i.get({element:"search"}),o=i.get({element:"list"});n.empty(),n.append(t.dom),"search"!=i.get({status:"show"})&&(o.hide(),n.show(),i.set({status:"show",value:"search"}))},resultCancel:function(){var e=this;if("search"==e.get({status:"show"})){var t=e.get({element:"search"}),i=e.get({element:"list"});t.hide(),t.empty(),i.show(),e.set({status:"show",value:"list"})}},match:function(e){var t=(e=e||{}).key||"",i=[],n=new RegExp("("+t+")","i"),o='<b class="nui-txt-mark">$1</b>';return $.Object.each(a.default.data.extDataMap.contactLite,(function(e,t){var a,r,s=!1,c=t.name,l=t.email,d=l.length,u=$.String.encodeHTML(c);if(n.test(c)?(r=u.replace(n,o),s=!0):r=u,s){for(var p=0;p<d;p++){var f={id:t[h],yellowPage:t.yellowPage,name:r};a=l[p],n.test(l[p])&&(f.address=a.replace(n,o));var g=new m(a,c);f.email=g,i.push(f)}return $.CONTINUE}for(p=0;p<d;p++)a=l[p],n.test(a)&&(g=new m(a,c),f={id:t[h],yellowPage:t.yellowPage,name:r,email:g,address:a.replace(n,o)},i.push(f),s=!0);if(s)return $.CONTINUE})),i},switchSide:function(e){var t=this;if(e!=t.get({status:"currentTab"})){t.set({status:"currentTab",value:e});var i=t.get({element:"address"}),a=t.get({element:"corp"}),n=t.get({element:"personal"}),o=t.get({component:"searchInput"}),r=t.get({component:"searchLink"});"corp"==e?(a.show(),n.hide(),i.setClass("tL0 uu1"),o.hide(),r.hide()):"personal"==e&&(a.hide(),n.show(),i.setClass("tL0 oT1"),o.show(),r.show())}},resize:function(){},todo:function(){}})},77454:function(e,t,i){var a=i(72957),n=i(32073),o=new a.c1("module.address.AddressView"),r=$.Object,s=$.createClass((0,a.$N)("module.address.AddressView"));r.mix(s,n.Z,{},{initialize:function(e){},getHtml:function(){var e,t=this,i=t.module;return e=t.getHeader()+t.getPersonal(),'<div id="'+i.createId("address")+'"  class="tL0">'+e+"</div>"},getHeader:function(){var e=this.module,t="";try{var i=new $.Input({placeholder:o.t("æŸ¥æ‰¾è”ç³»äºº"),iconBtn:"search",iconbtnclick:function(){e.searchCancel()},listeners:{keyup:{handler:function(){e.searchMatch()}}}}),n=new $.Link({title:o.t("å¿«é€Ÿæ·»åŠ è”ç³»äºº"),text:'<b class="nui-ico nui-ico-add2"></b>',cls:"qP0",click:function(){e.addFast(),$.Log.cache({cl_add:"1"},$.EMPTYFUNC)}});e.set({component:"searchInput",value:i}),e.set({component:"searchLink",value:n}),t=i.html()+n.html()}catch(e){a.$D.info("Compose Address Create Error"+e)}return'<header class="frame-main-cont-head">'+t+"</header>"},getCorp:function(){var e=this.module,t=$.Uri.getUrl("compose_corp_address");return'<div id="'+e.createId("corp")+'" class="frame-main-cont-body" style="overflow:hidden"><iframe id="'+e.createId("corpIframe")+'" style="width:100%;height:100%" src="'+t+'" frameborder="0" allowTransparency="true"></iframe></div>'},getPersonal:function(){var e=this.module;return'<div id="'+e.createId("personal")+'" class="frame-main-cont-body nui-scroll" ><section class="tC0"><div id="'+e.createId("search")+'" class="pX0"></div><div id="'+e.createId("list")+'"class="nui-simpleTree nui-tree rs0"></div></section></div>'}unction(e,t,i){var a=i(72957),n=$.createClass((0,a.$N)("module.compose.Compose")),o=tor","event","form","info","view","sign","stationery","at","success","mailtrace","mailprotection"];$.Array.each(o,(function(e,t){n.prototype[t]=null})),$.Object.extend(n.prototype,{param:null,class:null,module:null,names:o,initialize:function(e){this.module=e,this.class=e.class},init:function(){var e=this,t=e.module;$.Array.each(e.names,(function(i,n){try{e[n]=t[n]}catch(e){a.$D.log({error:e})}}))},clear:function(){var e=this;$.Object.each(e,(function(t,i){i&&(e[t]=null),delete e[t]}))}}),t.Z=n},26494:function(e,t,i){i.r(t),i(49750),i(13484),i(19975),i(92274),i(65132),i(48868),i(81874),i(54861);var a=i(14396),n=i(10487),o=i(72957);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var s=$.Object,c=$.createClass((0,o.$N)("module.compose.ComposeAction")),l={send:function(e){var t=this.module,i=t.base,a=(i=t.base,{url:e.url,func:"mbox:compose",log:s.extend({l:"compose"},e.log),body:e.body,error:e.error,call:e.callback});i.composeTimeAdd(),$.Log.cache({ComposeSend:$.Object.extend(e.log,i.getComposeLogInfo())}),$.Log.duration("performance_ir_compose","start"),this.wmsvr(a)},smartSend:function(e){var t=this.module,i=t.base,a=t.data,n=t.mailprotection,o=t.mailtrace,r=a.get({status:"sendTraceInfo"});try{i.fireCompose("compose:beforeSend",e.body)}catch(e){}if(e&&e.body&&e.body.action&&("deliver"===e.body.action||"verify"===e.body.action)){var s=r&&o.isGroupTrace(r.receiverList),c=!!$.Ext.mailProtection&&n.isEnabled();if(s||c){e.url=o.getWmsvrUrl();var l=e.error;e.error=function(e){return $.Log.cache({compose_smartsend_error:e}),l.apply(this,arguments)}}}this.send(e)},uploadPrepare:function(e){var t={func:"upload:prepare",log:s.extend({l:"compose"},e.log),body:e.body,error:e.error,call:e.callback};this.wmsvr(t)},getNotaryBalance:function(e){try{var t=$.Uri.getUrl("notary_info");$.Ajax.jsonp(t,(function(t){e&&e(t)}),"callback")}catch(e){o.$D.log(e)}},getMessageData:function(e){var t={func:"upload:prepare",log:s.extend({l:"compose"},e.log),body:e.body,error:e.error,call:e.callback};this.wmsvr(t)},sendByformData:function(e,t,i){var a=new XMLHttpRequest,n=location.protocol+"//"+$G.environment.host+"/"+$G.config.appName+"/s?sid="+$G.user.sid;"undefined"!=typeof FormData&&e&&(a.open("post",n+"&func=mbox:composeF&action=deliver"),a.addn(e){var a=e.currentTarget,n={code:a.responseXML.children[0].children[0].innerHTML};200===a.status&&("S_OK"===n.code?t&&t(e):i&&i("api-error",n.code,e))})),a.addEventListener("error",(function(e){i&&i("network-error",e)})),a.addEventListener("abort",(function(e){i&&i("abort",e)})),a.send(e))},getId:function(e){var t={func:"mbox:compose",body:{},call:e.callback};this.wmsvr(t)},getInfo:function(e){var t={func:"mbox:getComposeInfo",body:{id:this.info.get({cid:!0})},call:e.callback};this.wmsvr(t)},cancelId:function(e){var t={func:"mbox:cancelComposes",body:{ids:[this.info.get({cid:!0})]},call:e.callback};e.deleteDraft&&(t.body.deleteDraft=!0),this.wmsvr(t)},restoreDraft:function(e){var t={func:"mbox:restoreDraft",body:e.body,call:e.callback};this.wmsvr(t)},replyMessage:function(e){var t={func:"mbox:replyMessage",log:s.extend({l:"read"},e.log),body:e.body,error:e.error,call:e.callback};this.wmsvr(t)},forwardMessages:function(e){var t={func:"mbox:forwardMessages",log:s.extend({l:"read"},e.log),body:e.body,error:e.error,call:e.callback};this.wmsvr(t)},editMessage:function(e){var t={func:"mbox:editMessage",body:e.body,call:e.callback};this.wmsvr(t)},saveSent:function(e){var t={func:"mbox:saveSent",body:{id:e.mid},ignoreError:!0,call:e.callback};this.wmsvr(t)},saveSentAndDel:function(e){var t={func:"global:sequential",body:{items:[{func:"mbox:saveSent",var:{id:e.saveMid}},{func:"mbox:deleteMessages",var:{id:e.delMid}}]},ignoreError:!0,call:e.callback};this.wmsvr(t)},syncAttach:function(e){var t={func:"mbox:compose",body:{id:this.info.get({cid:!0}),action:"continue",returnInfo:!0,attrs:{attachments:e.attachments}},call:e.callback};this.wmsvr(t)},deleteAttach:function(e){var t,i=e.sid;if(i){t="object"==r(i)&&i.length?i:[i];var a=[];$.Array.each(t,(function(e,t){a.push({id:t,deleted:!0})}));var n={func:"mbox:compose",body:{id:this.info.get({cid:!0}),action:"continue",attrs:{attachments:a}},call:e.callback,ignoreError:!0};this.wmsvr(n)}},save2YNote:function(e){var t=this,i={func:"ntes:mbox:ynote",body:{action:"saveEmail",mid:e.mid},call:e.callback,error:e.error,ignoreError:!0};t.data.get({status:"showEncrypt"})&&(i.body.password=t.encrypt.get()),t.wmsvr(i)},cancelDeliver:function(e){var t={func:"mbox:cancelDeliver",body:{tinfo:e.tinfo},call:e.callback,error:e.error};this.wmsvr(t)},getTasks:function(e){var t={func:"upload:getTasks",body:{composeId:e.cid},call:e.callback,error:e.error};this.wmsvr(t)},contactCorrect:function(e){var t="//"+(0,o.$S)("host")+"/rcmd/rcmd?format=json&uid="+(0,o.$S)("uid")+"&sid="+(0,o.$S)("sid")+"&product=webmail&cmd=wrongContact",i={var:JSON.stringify(e.var)};$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,url:t,rnd:!1,body:i,call:e.callback})},getSubject:function(e){var t={func:"ntes:mbox:getSubject",body:{url:e.url},call:e.callback,error:e.error};this.wmsvr(t)}};s.mix(c,a.Z,null,{}),s.extend(c.prototype,n.Z.prototype),s.extend(c.prototype,l),t.default=c},95949:function(e,t,i){i(66403),i(92274),i(63045),i(48868),i(81874),i(54861),i(36809),i(65785),i(31209),i(52863),i(72216),i(68248),i(62785),i(73810),i(90786),i(49827),i(73731),i(22897),i(90791),i(54384),i(14076),i(39319),i(22729),i(19185),i(41712),i(98038),i(48801),i(54568),i(1809),i(84122),i(63573),i(11746),i(50828),i(49178),i(24202),i(4014),i(96752),i(55737);var a=i(10487),n=i(62193),o=i(72957),r=new o.c1("module.compose.ComposeAssist"),s=$.Object,c=$.Browser,l=$.Uri,d={initialize:function(e){s.extend(this,{assist:{request:null,capture:null},status:{captureDialog:!1,captureIndex:0,dragSupport:"",dragTarget:"",dragEffect:""}}),u.superClass.initialize.call(this,e)},init:function(){u.superClass.init.call(this)},clear:function(){var e=this;e.assist.request=null,e.assist.capture=null,u.superClass.clear.call(e)},get:function(e){return"string"==typeof e.status?this.status[e.status]:"string"==typeof e.assist?this.assist[e.assist]:void 0},set:function(e){var t=e.value;"string"==typeof e.status?this.status[e.status]=t:"string"==typeof e.assist&&(this.assist[e.assist]=t)},create:function(e,t){if(!u.has()&&!t)return null;if(!u.hasNewVersion()&&!t)return null;switch(e){case"request":e="beta.httprequest";break;case"capture":e="ntes.screencapture";break;case"blob":e="beta.blobbuilder";break;case"desktop":e="beta.desktop";break;case"digest":e="ntes.blobdigest"}return u.createFactory(e)||null},setup:function(e){var t=this,i=t.base,a=r.t("å®‰è£…"),n=r.t("å®‰ è£…");if("upload"==e&&(a=r.t("å‡çº§"),n=r.t("å‡ çº§")),u.support()){var s="2G";(0,o.$S)("cloud")&&(s=$.Number.convert((0,o.$S)("cloud").capacity));var l="<div>"+a+r.t("åæ‚¨å¯ä»¥ï¼š")+"<ol><li>"+r.t("1. å‘é€")+s+r.t("è¶…å¤§é™„ä»¶")+"</li><li>"+r.t("2. æˆªå±åŠŸèƒ½")+"</li><li>"+r.t("3. ç›´æ¥æ‹–æ›³æ–‡ä»¶åˆ°å†™ä¿¡çª—å£æˆä¸ºé™„ä»¶")+"</li><li>"+r.t("4. å¤åˆ¶ç²˜è´´æ–‡ä»¶æˆä¸ºé™„ä»¶")+"</li><li>"+r.t("5. åœ¨é‚®ä»¶æ­£æ–‡ä¸­æ’å…¥æœ¬åœ°å›¾ç‰‡")+"</li></ol>"+r.t("â˜… å®‰è£…è¿‡ç¨‹å¯èƒ½ä¼šç¦»å¼€æœ¬é¡µé¢ï¼Œå½“å‰å¦‚æœ‰ä¿¡ä»¶å†…å®¹å°†è¢«ä¿å­˜åˆ°è‰ç¨¿ç®±")+"</div>",d=null;d=$.Msgbox.show({type:"confirm",title:r.t("ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œéœ€è¦å…ˆ")+a+r.t("ç½‘æ˜“é‚®ç®±æ’ä»¶"),content:l,okText:n,ok:function(){if(i.empty())t.install(d);else{var e=c.getVersion()||[0,0];c.chrome()&&e[0]>=21?t.install(d,i):i.send({action:"force",call:function(){t.install(d)}})}return!0}})}else{var m=c.getInfo();l="","windows"==m.os?l="<b>"+r.t("å½“å‰æµè§ˆå™¨ä¸æ”¯æŒå®‰è£…æœ¬åŠŸèƒ½æ’ä»¶ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æµè§ˆå™¨")+"</b><br />1. Internet Explorer<br />"+r.t("2. IEå†…æ ¸æ¨¡å¼æµè§ˆå™¨ï¼Œå¦‚360æµè§ˆå™¨ï¼Œä¸–ç•Œä¹‹çª—ç­‰")+"<br />"+r.t("3. ç«ç‹æµè§ˆå™¨(Mozilla Firefox)")+"<br />"+r.t("4. è°·æ­Œæµè§ˆå™¨(Google Chrome)")+"<p>"+r.t("â˜…ä¸Šè¿°æµè§ˆå™¨æ’ä»¶ç›®å‰åªé™äºWindowsæ“ä½œç³»ç»Ÿæ”¯æŒ")+"</p>":"macintosh"==m.os&&(l="<b>"+r.t("å½“å‰æµè§ˆå™¨ä¸æ”¯æŒå®‰è£…æœ¬åŠŸèƒ½æ’ä»¶ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æµè§ˆå™¨")+"</b><br />1. Safari<br />"+r.t("2. ç«ç‹æµè§ˆå™¨(Mozilla Firefox)")+"<br />"+r.t("3. è°·æ­Œæµè§ˆå™¨(Google Chrome)")),$.Msgbox.show({title:r.t("é‚®ç®±æ’ä»¶æç¤º"),content:l})}},install:function(e,t){u.install({close:function(){e.close()}},t)},destroy:function(){this.captureDestroy()},requestGet:function(){var e=this,t=e.get({assist:"request"});return t&&void 0===t.send&&e.set({assist:"request",value:t=null}),t||(t=e.create("request")),t?(e.set({assist:"request",value:t}),t):null},captureGet:function(){var e=this,t=e.get({assist:"capture"});return t&&void 0===t.captureScreen&&e.set({assist:"capture",value:t=null}),t||(t=e.create("capture")),t?(e.set({assist:"capture",value:t}),t):null},captureStart:function(){var e=this;if(c.chrome())e.nativeCapture((function(t){var i=[],a=e.get({status:"captureIndex"})+1;e.set({status:"captureIndex",value:a});var n=r.t("æˆªå›¾")+a+".png";t.name=n,t.inlined=!0,i.push(t),e.native.nativeSelect(i,void 0,"AssistCaptureStart")}));else{var t=e.captureGet();t&&(e.get({status:"captureDialog"})?t.focusCaptureDialog():(e.set(atus:"captureDialog",value:!1}),e.captureResult(t)}))))}},captureResult:function(e){e&&1==e.count&&this.captureUpload(e.files[0])},captureUpload:function(e){var t=this,i=t.get({status:"captureIndex"})+1;t.set({status:"captureIndex",value:i});var a=r.t("æˆªå›¾")+i+".png";e.name=a,e.inlined=!0,t.attach.pluginSelect([e])},captureDestroy:function(){var e=this,t=e.get({assist:"capture"});if(t){if(e.get({status:"captureDialog"})){try{t.closeCaptureDialog()}catch(e){}e.set({status:"captureDialog",value:!1})}e.set({assist:"capture",value:t=null})}},clipInit:function(){var e=this;if(u.has()){window.composeClip||$(window.document).listen("keydown",(function(){window.composeClip&&window.composeClip.apply(null,arguments)})),window.composeClip=function(e){var t=$.Context.module;"compose.ComposeModule"==t.mtype&&t.assist.clipKey(e,"globe")};var t=$(e.editor.getWindow()),i=$(t.dom.document),a=$(i.dom.body),n=i;i.listen("keydown",(function(t){e.clipKey(t,"editor")})),c.ie()&&(n=a,i.listen("contextmenu",$.Function.bind(e.clipMenu,e))),n.listen("paste",$.Function.bind(e.clipImage,e))}else{var o=c.getVersion()||[0,0];(c.firefox()||c.chrome()||c.ie()&&o[0]>=11)&&(t=$(e.editor.getWindow()),(i=$(t.dom.document)).listen("paste",(function(t){e.nativeClipImage(t,"editor")})))}},clipMenu:function(e){if(c.ie()){var t=this.create("desktop");if(t)try{t.highLightPasteMenu(e)}catch(e){}}},clipKey:function(e,t){(e.ctrlKey||e.metaKey)&&86==e.keyCode&&this.clipPaste(e,t)},clipPaste:function(e,t){var i=this,a=i.create("desktop",!0);if(a){var n=null;try{n=a.getClipboardData(e)}catch(e){}if(n&&n.count>=1){var o=s.toArray(n.files);i.base.addTimer("clippaste",(function(){i.attach.pluginSelect(o)}),200),$.Event.stop(e)}else"editor"==t&&i.clipImage(e)}},clipImage:function(e){var t=this,i=t.create("desktop",!0);if(i){var a=null,n=null;try{a=i.getClipboardDataType()}catch(e){}if(a){if(a.files)return;if(a.html)return;if(a.text){if(!a.bitmap||!c.firefox())return;var o="";try{o=i.getClipboardText("text")}catch(e){}if(o)return t.editor.insert({text:o}),void $.Event.stop(e)}a.bitmap}try{n=i.getClipboardImage(e)}catch(e){}if(n&&1==n.count){var r=n.files[0];t.base.addTimer("clipimage",(function(){t.captureUpload(r)}),200),$.Event.stop(e)}}},nativeClipImage:function(e,t){var a=this,n=this;Promise.resolve().then(i.bind(i,80449)).then($.Function.bind((function(t){var i=t.default,o=e.clipboardData;if(a.logPastTypeByClipEvent(e),o&&o.items&&1==o.items.length){var s=[];if("file"==(m=o.items[0]).kind&&-1!=m.type.indexOf("image")){(c.firefox()||n.isBrowserPasteImageAsBase64())&&e.preventDefault();var l=n.get({status:"captureIndex"})+1;n.set({status:"captureIndex",value:l});var d=r.t("æˆªå›¾")+l+".png",u=m.getAsFile();u.name=d,u.inlined=!0,s.push(u)}n.native.nativeSelect(s,void 0,"AssistNativeClipImage1")}else if(window.clipboardData){var m;if(o=window.clipboardData,a.logPastTypeByIEClipData(o),s=[],o.files.length>0&&(m=o.files[0])&&m.type&&-1!=m.type.indexOf("image")){e.preventDefault();var p=m.size-1,f=new FileReader;f.onloadend=function(e){if(e.target.readyState==FileReader.DONE){var t=[e.target.result],a=n.get({status:"captureIndex"})+1;n.set({status:"captureIndex",value:a});var o=r.t("æˆªå›¾")+a+".png",c=new Blob(t,{type:"image/png"});c.name=o,c.inlined=!0,s.push(c);var l=n.module,d=new i(l);d.init(),n.native=d,n.native.nativeSelect(s,void 0,"AssistNativeClipImage2")}};var h=m.slice(0,p+1);f.readAsArrayBuffer(h)}}})))},nativeCapture:function(e){var t=this;function i(){$.Msgbox.show({type:"confirm",title:r.t("æˆªå›¾æ’ä»¶æç¤º"),content:r.t("è¿›å…¥Chromeåº”ç”¨å•†åº—å®‰è£…æˆªå›¾æ’ä»¶,å®‰è£…æˆåŠŸåå¯ä½¿ç”¨æˆªå›¾åŠŸèƒ½ï¼"),okText:r.t("ç«‹å³å®‰è£…"),ok:function(){window.gChromeExtensionMailCaptureCheck=!0,window.open($.Uri.getUrl("compose_attach_chrome_capture",!0))}})}window.gChromeExtensionMailCaptureInstall||window.gChromeExtensionMailCaptureCheck?chrome.runtime.sendMessage("jmhbgmmcnagjjihogbfmghlfegaidcfj",{action:"capture",openUrl:"http://1.163.com"},(function(a){if(a){var n=a.dataUrl;if(n){var o=t.dataUrlToBlob(n);e(o)}}else window.gChromeExtensionMailCaptureCheck&&(window.gChromeExtensionMailCaptureCheck=!1,i())})):i()},dataUrlToBlob:function(esplit(":")[1].split(";")[0],new ArrayBuffer(t.length)),a=new Uint8Array(i),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);return new Blob([i])},dragInit:function(){Promise.resolve().then(i.bind(i,80449)).then($.Function.bind((function(e){var t=e.default,i=this,a=(i.base,i.data),n=i.editor,o="",r=Number($.Browser.ie());if(c.firefox()||c.chrome()||r>=10?"undefined"!=typeof FileReader&&(o="native"):c.safari()&&"undefined"!=typeof FileList&&(o="native"),o||u.has()&&(o="plugin"),o){if(i.native=i.attach,"native"==o&&u.has()){var s=new t(i.module);s.init(),i.native=s}if(i.set({status:"dragSupportar l=$(window);c.ie()&&(l=$(l.dom.document.body)).listen("dragenter",(function(e){$.Event.stop(e)})),l.listen("dragover",(function(){window.composeDrag.apply(null,arguments)})),window.composeDrag=function(e){var t=$.Context.module;"compose.ComposeModule"==t.mtype&&t.assist.dragOver(e,"globe")}}if(c.ie())$(n.getWindow().document.body).listen("dragover",(function(e){i.dragOver(e,"editor")}));else{var d=$(n.getWindow());d&&d.listen("dragover",(function(e){i.dragOver(e,"editor")})),c.firefox()&&d&&d.listen("drop",(function(e){i.dragDrop(e,"editor")}),!0),d&&d.listen("drop",(function(e){i.dragDrop(e,"editor")}))}var m=a.get({moduleId:"attachDrag"}),p=a.get({moduleId:"attachDragClose"});m.listen("dragover",(function(e){i.dragOver(e,"area")})),m.listen("drop",(function(e){i.dragDrop(e,"area")})),m.listen("click",(function(e){$.Event.stop(e)})),p.listen("click",(function(e){i.event.setDragArea({hide:!0,force:!0})}))}}),this))},dragHas:function(e){var t=this.get({status:"dragSupport"}),i=!1;if("native"==t){var a=e.dataTransfer;a.files&&a.files.length?i=!0:a.types&&$.Array.each(s.toArray(a.types),(function(e,t){return"text/html"==t?$.BREAK:"Files"==t?(i=!0,$.BREAK):void 0}))}else if("plugin"==t){var n=this.create("desktop");if(n)try{n.getDragData(e,"application/x-gears-files").count>0&&(i=!0)}catch(e){-2146827287==e.number&&(i=!0)}}return i},dragCheck:function(e,t){var i=this,a=i.get({status:"dragSupport"});if(i.dragHas(e)){var n=!1;if("editor"==t){var o=0;if("native"==a){var r=e.dataTransfer;"number"==typeof r.mozItemCount?o=r.mozItemCount:r.files&&(o=r.files.length>0?r.files.length:1)}else if("plugin"==a){var s=i.create("desktop"),c=null;try{c=s.getDragData(e,"application/x-gears-files")}catch(e){}c&&1==c.count&&0===String(c.mimeTypes).toLowerCase().indexOf("image/")&&(o=1)}1==o&&(n=!0)}"area"==t&&(n=!0),"globe"!=t&&"editor"!=t||i.event.setDragArea({show:!0}),i.set({status:"dragEffect",value:n?"copy":"none"})}},dragOver:function(e,t){var i=this;i.get({status:"dragTarget"})!=t&&(i.set({status:"dragTarget",value:t}),i.dragCheck(e,t));var a=i.get({status:"dragEffect"});if(a){var n=e.dataTransfer;c.ie()?n.dropEffect="copy":(n.effectAllowed=a,n.dropEffect=a),i.base.addTimer("dragstop",(function(){i.set({status:"dragTarget",value:""}),i.set({status:"dragEffect",value:""}),i.event.setDragArea({hide:!0})}),200),$.Event.stop(e)}else i.base.addTimer("dragstop",(function(){i.set({status:"dragTarget",value:""})}),200)},dragDrop:function(e,t){var i=this;if(i.get({status:"dragEffect"})){i.event.setDragArea({hide:!0,force:!0}),$.Event.stop(e);var a=i.get({status:"dragSupport"}),n=null,o=null;if("native"==a)n=e.dataTransfer.files;else if("plugin"==a){var r=i.create("desktop");if(r)try{n=(o=r.getDragData(e,"application/x-gears-files")).files}catch(e){}}if(n&&n.length>=1&&(n=s.toArray(n),"area"==t&&("native"==a?i.native.nativeSelect(n,void 0,"AssistDragDrop_area"):"plugin"==a&&i.attach.pluginSelect(n)),"editor"==t)){if(1!=n.length)return;var c=n[0],l="";if("native"==a?l=c.type:"plugin"==a&&(l=o.mimeTypes),l&&(l=String(l).toLowerCase()),0===l.indexOf("image/"))c.inlined=!0,"native"==a?i.native.nativeSelect([c],void 0,"AssistDragDrop_editor"):"plugin"==a&&i.attach.pluginSelect([c]);else if("text/html"==l||"text/plain"==l){var d="";if(c.getAsBinary&&c.getAsText){var u=c.size||c.fileSize||0;if(!(u>0&&u<=102400))return;var m="",p=c.getAsBinary().substr(0,3);p==String.fromCharCode(239,187,191)||p.substr(0,2)==String.fromCharCode(255,254)||p.substr(0,2)==String.fromCharCode(254,255)||(m="GBK"),d=c.getAsText(m)}d&&("text/html"==l?i.editor.set({html:d}):i.editor.set({text:d}))}}}},logPastTypeByClipEvent:function(e){var t=e.clipboardData;if(t&&t.items&&t.items.length){for(var i=[],a=0;a<t.items.length;a++){var n=t.items[a];if("string"===n.kind)i.push({kind:n.kind,type:n.type});else{var o=n.getAsFile();o&&i.push({kind:n.kind,type:o.name.split(".")[1]||"",size:o.size})}}$.Log.cache({compose_paste:{contenttype:i,contentLength:i.length}})}},logPastTypeByIEClipData:function(e){if(e&&e.files&&e.files.length){for(var t=[],i=0;i<e.files.length;i++){var a=e.files[i];t.push({kind:a.kind,type:a.name.split(".")[1]||"",size:a.size})}$.Log.cache({compose_paste:{contenttype:t,contentLength:t.length}})}},isBrowserPasteImageAsBase64:function(){return c.chrome()&&$.Browser.getVersion()[0]>=83}},u=$.createClass((0,o.$N)("module.compose.ComposeAssist"));s.inherit(u,a.Z),s.extend(u.prototype,d),s.extend(u,{factory:null,updater:null,initFactory:function(){var e=null,t=null;if("undefined"!=typeof MailAssistFactory)e=new MailAssistFactory;else try{t=(e=new ActiveXObject("MailAssist.Factory")).create("ntes.updateservice")}catch(t){void 0!==navigator.mimeTypes&&navigator.mimeTypes["application/x-mailassist"]&&((e=document.createElement("object")).style.position="absolute",e.width=0,e.height=0,e.type="application/x-mailassist",document.body.appendChild(e),e&&void 0===e.create&&(e=null))}e?(u.factory=e,u.updater=t||!1):u.factory=!1},createFactory:function(e){if(u.has())try{return u.factory.create(e)}catch(e){}return null},has:function(){if(null===u.factory&&u.initFactory(),u.factory){if(void 0!==u.factory.create)return!0;u.factory=null}return!1},hasNewVersion:function(){if(u.has()){var e=u.getVersion();if(2==e[0]&&e[1]>=1||e[0]>=3)return!0}return!1},getVersion:function(){var e=null;if(u.has()){var t=u.factory.version;t&&(e=t.split("."))}return e},startUpdate:function(e){if(u.has()&&u.updater)try{return u.updater.StartUpdate(e),!0}catch(e){}return!1},support:function(){var e=!1,t=c.getInfo();return"windows"==t.os&&(c.ie()||c.firefox())?(e=!0,t.shell&&"360"!=t.shell&&"theworld"!=t.shell&&"sogou"!=t.shell||(e=!0)):"macintosh"==t.os&&(c.safari()||c.firefox())&&(e=!0),e},install:function(e,t){e=e||{};var i=c.getInfo();"windows"==i.os?u.installWindows(e,t):"macintosh"==i.os&&u.installMac(e,t)},installWindows:function(e,t){var i=c.getInfo(),a=e.close||$.EMPTYFUNC();if(c.ie())n.Z.redirect(l.getUrl("compose_attach_setup"));else if(c.firefox())try{var s="compose_attach_plugin";if((c.getVersion()||[0,0])[0]>=5&&(s="compose_attach_firefox"),"undefined"!=typeof InstallTrigger)InstallTrigger.install({NetEaseMailPlugin:l.getUrl(s,!0)});else{a();var d=$.Msgbox.show({title:r.t("é‚®ç®±æ’ä»¶æç¤º"),content:r.t("è¯·æŒ‰ç…§æµ…è®¸â€å®‰è£…æ’ä»¶ã€‚")+"<br><br>"+r.t("å®‰è£…æˆåŠŸåé€‰æ‹©ç«‹å³é‡å¯æµè§ˆå™¨å³å¯ä½¿ç”¨è¯¥åŠŸèƒ½ï¼"),ok:function(){u.install({close:function(){d.close()}})}});$("#ifrDownUrl")||((m=$.Element")).attr({id:"ifrDownUrl"}),m.css({display:"none"}),document.body.appendChild(m.dom)),$("ifrDownUrl").attr({src:l.getUrl(s,!0)})}}catch(e){}else if(c.chrome()){var m;if(a(),(c.getVersion()||[0,0])[0]>=21&&!i.__shell)if("163.com"==(0,o.$S)("domain"))try{var p=l.getUrl("compose_attach_chrome21",!0),f=document.createElement("LINK");f.rel="chrome-webstore-item",f.href=p,document.getElementsByTagName("HEAD")[0].appendChild(f),chrome.webstore.install(p,(function(){window.setTimeout(h,1e3)}),(function(){g(t)}))}catch(e){g(t)}else g(t);else $.Msgbox.show({title:r.t("é‚®ç®±æ’ä»¶æç¤º"),content:r.t("è¯·æŒ‰ç…§æµè§ˆå™¨åº•éƒ¨ä¸‹è½½æ æç¤ºï¼ŒæŒ‰â€œç»§ç»­â€å®‰è£…æ’ä»¶ã€‚")+"<br><br>"+r.t("å®‰è£…æˆåŠŸåå¯é©¬ä¸Šä½¿ç”¨æ–°åŠŸèƒ½ï¼"),ok:function(){window.setTimeout(h,1e3)}}),$("#ifrDownUrl")||((m=$.Element.create("IFRAME")).attr({id:"ifrDownUrl"}),m.css({display:"none"}),document.body.appendChild(m.dom)),$("#ifrDownUrl").attr({src:l.getUrl("compose_attach_chrome",!0)})}function h(){}function g(e){function t(){n.Z.redirect(l.getUrl("compose_attach_chrome21_setup"))}e?e.send({action:"force",call:function(){t())(),c.safari()||c.chrome()){var i=l.getUrl("compose_attach_mac_plugin");window.open(i)}else if(c.firefox())try{i=l.getUrl("compose_attach_mac_firefox"),window.open(i);var a=$.Msgbox.show({title:r.t("é‚®ç®±æ’ä»¶æç¤º"),content:r.t("è¯·æŒ‰ç…§æµè§ˆå™¨é¡¶éƒ¨å®‰è£…æ æç¤ºï¼ŒæŒ‰â€œå…è®¸â€å®‰è£…æ’ä»¶ã€‚")+"<br><br>"+r.t("å®‰è£…æˆåŠŸåé€‰æ‹©ç«‹å³é‡å¯æµè§ˆå™¨å³å¯ä½¿ç”¨è¯¥åŠŸèƒ½ï¼"),ok:ion(){a.close()}})}});if(!$("#ifrDownUrl")){var n=$.Element.create("IFRAME");n.attr({id:"ifrDownUrl"}),n.css({display:"none"}),document.body.appendChild(n.dom)}$("#ifrDownUrl").attr({src:i})}catch(e){}}}),t.Z=u},93942:function(e,t,i){i(803),i(42295),i(52963),i(92274),i(75654),i(66403),i(79150),i(26340),i(68233);var a=i(10487),n=i(83957),o=i(72957),r=$.Object,s=($.Function,$.Ud,$.Uri),c=($.Ext,$.String),l=$.createClass((0,o.$N)("module.compose.ComposeAt"));r.inherit(l,a.Z),r.extend(l.prototype,{initialize:function(e){r.extend(this,{atData:{},menuShow:!1}),l.superClass.initialize.call(this,e)},init:function(){l.superClass.init.call(this),this.initComplete()},load:function(){},addEmail:function(e){var t=this.atData,i=e.split(",");$.Array.each(i,(function(e,i){t[i]=!0}))},getEmail:function(){if($.Ext.composeAt){var e=this.atData,t=this.editor.editorCmpt,i=[];if(!$.Object.isEmpty(e)){var a=t.doc.getElementsByTagName("SPAN");$.Array.each(a,(function(t,a){var n=a.getAttribute("ntes_mm_email");n&&!0===e[n]&&i.push(n)}))}return i.join(",")}},removeEmail:function(e){this.atData[e]=null},addItem:function(e){var t=this,i=t.editor,a=t.form,n=i.editorCmpt;t.addEmail(e.address),n.insertAtNode(e),a.addContact([e],"to")},initComplete:function(){try{var e=(0,o.$L)("support.AddressSupport",this),t=(0,o.$I)("util.AutoComplete")}catch(e){return e}var i=this;try{if(!e.dataInited)return;if(this.autoCompltedInited)return;this.autoCompltedInited=!0;for(var a=e.data.extDataMap.groupArray||[],r=[],l=0,d=a.length;l<d;l++){var u=a[l];if(u.N&&u.CONTACTS&&u.CONTACTS.length){var m=r.length;u.index=m,r[m]=u}}}catch(e){}i.autoComplete=new t({product:"editorat",fill:function(e){var t=s.getEmails(e,"Email");t.match.length>0&&$.Array.each(t.match,(function(e,t){i.addItem(t)}))},match:function(e,t){if(e.length>0&&(e=e.substr(1)),""===e)return t.toString();try{var i=t.name,a=t.email,n=i.toLowerCase(),o=a.toLowerCase()}catch(e){return}var r=a;if(i&&(r='"'+i+'"<'+a+">"),""===(e=c.trim(e).toLowerCase()))return r;if(1==e.length){if(0===o.indexOf(e)||0===n.indexOf(e)||t.fpy&&0===t.fpy.indexOf(e))return r}else if(o.indexOf(e)>-1||n.indexOf(e)>-1||t.py&&t.py.indexOf(e)>-1||t.fpy&&t.fpy.indexOf(e)>-1)return r},groupData:r,groupFill:function(e){var t=r[e].CONTACTS,a=n.Z.getEmails(t);$.Array.each(a,(function(e,t){i.addItem(t)}))},groupMatch:function(e,t){(e=c.trim(e).toLowerCase()).length>0&&(e=e.substr(1));var i=t.N.toLowerCase();return""===e?null:i.indexOf(e)>-1||void 0}})},fireKeyup:function(e,t){var i,a,n=this,o=n.data,r=n.form;if(e&&e.wholeText?(i=e.parentNode,a=e.wholeText):"SPAN"==e.tagName&&"@"==e.getAttribute("ntes_mm_email")&&(i=e,a="@"),a&&a.length>=2&&/\s/.test(a[1]))n.autoComplete&&n.autoComplete._remove();else if(a&&0===a.indexOf("@")){var s=$(i),c=s.offset(),l=c[1]+s.dom.offsetHeight+0,d=c[0]+s.dom.offsetWidth+0,u=$(r.editor.editorCmpt.iframe).offset(),m=r.editor.editorCmpt.body.scrollTop||0;if(d+=u[0],l+=u[1]-m,"@"==a){var p=[],f=[];o.get({status:"useSeparate"})?f[0]="separate":f=["to","cc","bcc"],$.Array.each(f,(function(e,t){var i=r.getContact("suc",t);p=p.concat(i)})),n.autoComplete.data=p}else n.autoComplete.data=null;n.autoComplete.pos=[d,l],n.autoComplete.outerKey=a,n.autoComplete.createMenu()}else{var h=n.autoComplete.div,g=n.autoComplete.table;h&&g&&n.autoComplete._remove()}},fireKeydown:function(e,t){var i,a=this;if(e&&e.wholeText?(e.parentNode,i=e.wholeText):"SPAN"==e.tagName&&"@"==e.getAttribute("ntes_mm_email")&&(i="@"),i&&0===i.indexOf("@")){var n=a.autoComplete.div,o=a.autoComplete.table;if(n&&o){a.autoComplete.operate(t);var r=t.keyCode||t.which;13!=r&&38!=r&&40!=r||($.Event.cancel(t),$.Event.stop(t))}}}}),t.Z=l},99277:function(e,t,i){i(49750),i(87553),i(40524),i(48868),i(31209),i(92274),i(52863),i(72216),i(68248),i(62785),i(73810),i(90786),i(49827),i(73731),i(22897),i(90791),i(54384),i(14076),i(39319),i(22729),i(19185),i(41712),i(98038),i(48801),i(54568),i(1809),i(84122),i(63573),i(11746),i(50828),i(49178),i(24202),i(4014),i(55737),i(73039),i(81874),i(54861),i(45263),i(33382),i(63045),i(68233),i(66403),i(67285),i(803),i(37092),i(80153),i(42295),i(34994),i(15761),i(20869),i(63518),i(75654),i(36809),i(66251),i(79150),i(13484),i(19975),i(65132);var a=i(10487),n=i(5165),o=i(64560),r=(i(42366),i(81229));function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}var c=new $I18N("module.compose.ComposeAttach"),l=$.Object,d=($.Browser,$.Ext),u=$.EXTLIMIT,m=$.Log,p=$.S_OK,f=$.Ud,h=$.Uri,g=$.createClass($N("module.compose.ComposeAttach"));l.inherit(g,a.Z),l.extend(g.prototype,a.Z.prototype);var v={file:{cid:"",sid:"",fid:"",eid:"",icon:"",cloud:!1,context:!1,type:"",mime:"",url:"",download:"",link:null,size:0,path:"",md5:"",modtime:null,useSplit:!1,skipSplit:!1,offset:0,lastOffset:0,length:0,fileExist:0,pathExist:!1,name:"",nameExist:!1,percent:-1,bytesHashed:-1,bytesLoaded:-1,retry:0,ext:"",extLimit:!1,state:"",err:"",errCode:"",errReason:"",blob:null,digest:null,speed:null,inlined:!1,mixed:!1,media:!1,lock:!1,ret:null,options:null,delete:null,ui:null},errDescription:{duplicated:c.t("æœ‰ç›¸åŒæ–‡ä»¶æ­£åœ¨ä¸Šä¼ ï¼Œè¯·åˆ é™¤åé‡è¯•"),extension:c.t("æ–‡ä»¶ç±»å‹å—é™"),empty:c.t("æ–‡ä»¶å†…å®¹ä¸ºç©º"),limit:c.t("æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶"),quota:c.t("æ–‡ä»¶å¤§å°è¶…è¿‡æ€»é™åˆ¶"),limitBig:c.t("æ–‡ä»¶å¤§å°è¶…è¿‡è¶…å¤§é™„ä»¶å•ä¸ªæ–‡ä»¶é™åˆ¶"),quotaBig:c.t("æ–‡ä»¶å¤§å°è¶…è¿‡è¶…å¤§é™„ä»¶æ€»é™åˆ¶"),errorBig:c.t("è¶…å¤§é™„ä»¶æœåŠ¡å¼‚å¸¸"),retryErrorBig:c.t("é™„ä»¶ä¸Šä¼ å‡ºé”™"),2038:c.t("æ–‡ä»¶I/Oé”™è¯¯")},filter:[{description:c.t("æ‰€æœ‰æ–‡ä»¶ (*.*)"),extension:"*.*",default:!0},{description:c.t("å›¾ç‰‡æ–‡ä»¶ (*.jpg;*.gif;*.png;*.bmp)"),extension:"*.jpg;*.gif;*.png;*.bmp"},{description:c.t("æ–‡æ¡£æ–‡ä»¶ (*.pdf;*.doc;*.xls;*.txt)"),extension:"*.pdf;*.doc;*.xls;*.txt"},{description:c.t("ç½‘é¡µæ–‡ä»¶ (*.mht;*.htm;*.html)"),extension:"*.mht;*.htm;*.html"}],filterImage:[{description:c.t("å›¾ç‰‡æ–‡ä»¶ (*.jpg;*.gif;*.png;*.bmp)"),extension:"*.jpg;*.gif;*.png;*.bmp",default:!0}],sliceLength:$S("isVip")||$S("is126")?1048576:196608,defaultSliceSize:$S("isVip")||$S("is126")?1048576:196608,sliceTime:12e4,symbol:)+String.fromCharCode(92),appInstall:!1,MAX_WORKER_NUM:1,UPLOAD_RETRY_MAX:3,mailmasterDownloadLink:"http://u.163.com/RcUwvU56g?spm="+encodeURIComponent("pos.free_webmail_9c89159b6fde1dc2.composePage.0.0.bigattachMasterDownLoad"),mailmasterDownloadBtnShowUrl:"https://count.mail.163.com/beacon/webmail.gif?type=webmail_compose_mmd&cmd="+encodeURIComponent(JSON.stringify({spm:"pos.free_webmail_9c89159b6fde1dc2.composePage.0.0.bigattachMasterDownLoad"})),upxmailConfig:{normal:null,fs:null,local:{normal:{163:["upx.mail.163.com"],126:["upx.mail.126.com"],yeah:["upx-hz.mail.yeah.net"],vip:["upx-hz.vip.163.com"],"126vip":["upx-hz.vip.126.com"],188:["upx-hz.vip.188.com"]},fs:{163:["upx.mail.163.com"],126:["upx.mail.126.com"],yeah:["upx.mail.yeah.net"],vip:["upx.vip.163.com"],"126vip":["upx.vip.126.com"],188:["upx.vip.188.com"]}}},getSize:function(e,t){e=e||0,"number"==typeof t?t<0&&(t=0):t=2;var i,a=Math.pow(10,t),n=[],o=0,r=0;return 0===e||(e<1024?(r=1,o=e):e<Math.pow(1024,2)?(r=2,o=Math.round(e/1024*a)/a):e<Math.pow(1024,3)?(r=3,o=Math.round(e/Math.pow(1024,2)*a)/a):(r=4,o=Math.round(e/Math.pow(1024,3)*a)/a)),n.push(String(o)),-1==n[0].indexOf(".")?t&&(n.push("."),$.Array.each(new Array(t),(function(){n.push("0")}))):((i=t-(n=n[0].split("."))[1].length)>0&&$.Array.each(new Array(i),(function(){n[1]+="0"})),n=[n.join(".")]),n.push(["","B","K","M","G","T"][r]),n.join("")},getRemain:function(e){var t="";if(-1==e)t="??:??:??";else if(e>86400)t="23:59:59";else{var i=new Array(3);i[2]=e%60,e-=i[2],e/=60,i[1]=e%60,e-=i[1],e/=60,i[0]=e,$.Array.each(i,(function(e,i){i<10&&(t+="0"),t+=i,e<2&&(t+=":")}))}return t}},b={isWasmSupport:!1,isRustMd5Loaded:!1,rustMd5InitialState:null,rustMd5InitialPromise:null,rustMd5InitialPromiseTimeout:3e3,rustMd5Instance:null,initialize:function(e){g.superClass.initialize.call(this,e)},clear:function(){g.superClass.clear.call(this)},init:function(){var e=this,t=e.module.base;e.hashworkerCallbackList={},e.hashworkerCallbackUUID=1,e.idleWorkerPool=[],e.workerRunningCounter=[],e.prototypeSet("isWasmSupport",e.checkWasmSupport()),this.uploadHostList=[],e.uploadHostInit(),e.fileUploadFinished$=t.Observable.fromJs6Event("compose:fileUploadFinished"),g.superClass.init.call(smSupport})},destStop&&e.p(t,i){"function"==typeof i.delete&&i.delete(),i.cloud&&"upload"==i.state&&i.ret&&i.ret.oid&&$.Ajax.jsonp(e.getUploadProxy({type:"script",file:i,cancel:!0}),(function(){}))}))},initProcess:function(e){var t=this,i=t.data,a=t.module.base;if($E("support.CloudSupport",(function(e){e.init(!0,(function(){a.onContentLoaded((function(){t.fileGet({type:"link"}).length&&(t.cloudTrigger(!0),t.prompt({cloud:!0}))}))}))})),"super"==i.get({status:"uploadMode"})&&t.rustMd5Preload(),"plugin"!=e){var n=t.sourceGet("element");n.browser.listen("mouseover",(function(){n.link.addClass("nui-txt-link-hover")})),n.browser.listen("mouseout",(function(){n.link.removeClass("nui-txt-link-hover")}))}},initElement:function(){var e=this.data,t=this.sourceGet("element");t.link=e.get({moduleId:"attachAdd"}),t.browser=e.get({moduleId:"attachBrowser"}),t.operate=e.get({moduleId:"attachOperate"}),t.area=e.get({moduleId:"attachArea"}),t.content=e.get({moduleId:"attachContent"}),t.progress=e.get({moduleId:"attachProgress"}),t.linkCloud=e.get({moduleId:"attachAddCloud"}),t.browserCloud=e.get({moduleId:"attachBrowserCloud"});var i=e.get({moduleId:"attachDashi"});i&&i.listen("click",(function(){m.cache({cl_dashi:1},$.EMPTYFUNC)}))},prototypeSet:function(e,t){g.prototype[e]=t},sourceGet:function(e){return this.module.data.attachments[e]},layout:function(){var e=this,t=e.sourceGet("element"),i=e.sourceGet("layout"),a=t.operate,n=t.content,o=a.dom.clientWidth-10;if(!i.baseWidth||i.baseWidth!=o){i.baseWidth=o;var r=o+12,s=o+i.spaceWidth;n.css({width:r+"px"});var c=i.attachWidth+i.spaceWidth,l=Math.floor(s/c)||1,d=s%c,u=Math.floor(d/l),m=i.attachWidth+u;i.blockWidth=m;var p=e.fileGet();$.Array.each(p,(function(e,t){t.ui.container.css({width:m+"px"})}))}},filterCheck:function(e){var t=this,a=(t.module,t.data),n=e.files,o=e.submit,r=e.cancel,s=1024*$S("attachSize")*1024;$S("isVip")&&(s=52428800);var l=t.fileSize(),d=t.fileSize({context:!0}),u=0,p=s-l,h=0,g=0,v=0,b=0,y=!0,x=!0,k=!1,S=!1;if($S("cloud")&&t.getUploadHost()&&(h=$S("cloud").fileSizeLimit,g=$S("cloud").capacity,v=g-$S("cloud").spaceUsed,$S("cloud").duration),$.Array.each(n,(function(e,a){if(t.isDuplicatedInOtherCompose(a)&&(a.err="duplicated"),a.err||(a.extLimit?a.err="extension":0===a.size?a.err="empty":h>0&&a.size>h?a.err="limitBig":v>0&&a.size+b>v?a.err="quotaBig":t.cloudTrigger()||(a.size>p?t.cloudStatus()?a.err="limit":a.err="retryErrorBig":a.size+b>p&&(a.err="quota"))),a.err&&("limit"==a.err||"quota"==a.err||"retryErrorBig"===a.err))if(t.cloudStatus())a.err="",k=!0;else{try{var n=$S("cloud")?"1":"0",o=t.getUploadHost()?"1":"0";m.cache({ComposeAttachCloudStatusError:"CLOUD_STATUS="+n+"|HOST_STATUS="+o+"|HOST="+t.getUploadHost()})}catch(e){}Promise.resolve().then(i.bind(i,9002)).then($.Function.bind((function(e){var t=e.default;m.cache({CloudSupportInitRetry:1}),t.init()})))}a.err?y=!1:(x=!1,b+=a.size,a.inlined&&(u+=a.size))})),d+u>s)$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_PictureUploadLimitPaste",header:c.t("é™„ä»¶ä¸Šä¼ æç¤º"),icon:"err",title:c.t("æ·»åŠ çš„å›¾ç‰‡æ€»å¤§å°ä¸èƒ½è¶…è¿‡")+$.Number.convert(s)});else{if(k)return t.cloudTrigger(!0),t.movePrepare(b),t.cloudAutoTips(),t.filterCheck(e),void t.prompt({cloud:!0});if(t.cloudTrigger())t.prompt({cloud:!0}),t.cloudAutoTips();else if($S("isCorp"));else{var w=b+l-d-u;if(t.cloudStatus()&&w>20971520){var T=f.get({field:"ntes_compose",flag:"upload_mode"}),C=(parseInt(T,10),!1);if("0"==T){t.base;var _=t.form,I=[],A=[];if(a.get({status:"useSeparate"})?A[0]="separate":A=["to","cc","bcc"],$.Array.each(A,(function(e,t){var i=_.getContact("suc",t);I=I.concat(i)})),0===I.length)C=!0;else{var M=["qq.com","vip.qq.com","163.com","126.com","yeah.net","vip.163.com","vip.126.com","188.com","vip.188.com"];$.Array.each(I,(function(e,t){var i=t.domain.toLowerCase();if(!$.Array.has(M,i))return C=!0,$.BREAK}))}}else"1"==T&&(C=!0);C&&(t.cloudTrigger(!0),t.movePrepare(b),t.filterCheck(e),t.prompt({cloud:!0}),S=!0)}}S||(y?o({ignore:null,select:n}):x?(t.filterFail(n),r()):t.filterSelect(n,o,r,b,p))}},isDuplicatedInOtherCompose:function(e){var t=this.module.name,i=!1,a=$.JS.modules["compose.ComposeModule"];return $.Object.each(a,(function(a,n){if(n.name!==t){var o=n.attach.fileGet();o&&o.length&&$.Array.each(o,(function(t,a){if(o=a,(n=e).blob&&o.blob&&n.blob.name===o.blob.name&&n.blob.lastModified===o.blob.lastModified&&n.blob.size===o.blob.size)return i=!0,$.BREAK;var n,o}))}})),i},filterFail:function(e){var t=this,i=t.module,a=(i.view,i.data),n=i.base,o=(c.t("æ‚¨é€‰æ‹©çš„æ–‡ä»¶ä¸èƒ½ä¸Šä¼ ï¼ŒåŸå› å¦‚ä¸‹ï¼š"),""),r='<p style="font-weight: 500;font-size: 14px;line-height: 22px;color: #333333;">'+c.t("é™„ä»¶ä¸Šä¼ å¤±è´¥")+'</p><p style="height: 4px"></p>',s="",l="",d="",u="",m="",p=!1,f=$.Array.findObject(e,"err","limitBig");f?t.filterFailMsgboxShow(f.err,f.size):($.Array.each(e,(function(e,i){var r=i.name;$.String.len(r)>22&&(r=$.StringDescription[f])if(f=g.errDescription[f],"quotaBig"==i.err&&(u="Compose_Premium_Popup_LargeAttachmentLimitTotal"),"retryErrorBig"===i.err)u="Compose_Guide_Popup_CloudSvrAllFail",s='<p>å»ºè®®æ‚¨æ›´æ¢æµè§ˆå™¨æˆ–åˆ·æ–°é‡è¯•ã€‚å¦‚é‡å›°éš¾<a href="//help.mail.163.com/newfeedback.do?m=add">è¯·åé¦ˆ</a></p>';else if(a&&a.get({status:"vipMember"})){if("quotaBig"===i.err){var h=t.getAssistantHtml("Compose_StorageSpaceLimit_Assistant_click"),v=t.getStorageDetailHtml();s='<p style="padding-top:8px;">'+c.t("æ‚¨å¯å‰å¾€")+v+"ï¼Œ"+c.t("è‹¥ä»æœ‰ç–‘é—®ï¼Œå¯å’¨è¯¢ä¼šå‘˜ä¸“å±")+h+"</p>"}}else if(n.isNonPayingUser()){var b="";"quotaBig"===i.err&&(b=c.t("ç«‹å³å¼€é€šé‚®ç®±ä¼šå‘˜ï¼Œçªç ´é™„ä»¶ä¸Šä¼ é™åˆ¶ï¼Œæ›´äº«è¶…å¤§é‚®ç®±å®¹é‡ç©ºé—´>>"),l="ThestoragespaceTextLink",d="ThestoragespaceButton",m="mailCapacity",u="Compose_Premium_Popup_LargeAttachmentLimitTotal",p=!0,s='<p style="height:8px">&nbsp;</p>'+new $.Link({text:'<span style="font-size: 12px;line-height: 18px;color: #003399;">'+b+"</span>",click:function(){$E("product.Privileges",(function(e){$.Msgbox.msgbox.close(),setTimeout((function(){e.showDialog(m,"",l)}),100)}))}}).html())}o+='<p><span title="'+i.name+'">'+r+'</span><span class="nui-txt-impt">('+f+")</span></p>"})),p?$.Msgbox.show({statsKey:u,statsValue:{plusMember:a.get({status:"vipMember"}),iutmSource:d},width:"500px",icon:"err",content:r+o+s,cancelText:c.t("å–æ¶ˆ"),okText:c.t("å¼€é€šé‚®ç®±ä¼šå‘˜"),ok:function(){$E("product.Privileges",(function(e){$.Msgbox.msgbox.close(),setTimeout((function(){e.showDialog(m,"",d)}),100)}))}}):$.Msgbox.show({statsKey:u,statsValue:{plusMember:a.get({status:"vipMember"})},width:"500px",icon:"err",content:r+o+s}))},filterSelect:function(e,t,a,n,o){var r=this,s=(r.data,r.base),l=[],d=[],u=!1;r.cloudStatus()&&(o=$S("cloud").capacity-$S("cloud").spaceUsed),e=e.sort((function(e,t){return t.size-e.size})),$.Array.each(e,(function(e,t){var i=t.name;if($.String.len(i)>28&&(i=$.String.left(i,24)),"limit"!=t.err&&"quota"!=t.err&&"limitBig"!=t.err&&"quotaBig"!=t.err||(u=!0,"quota"!=t.err&&"quotaBig"!=t.err||(t.err="",n+=t.size)),t.err){var a=t.err;g.errDescription[a]&&(a=g.errDescription[a]),d[d.length]='<tr class="nui-table-row nui-table-row-disabled"><td class="nui-table-cell nui-table-cell-forChk nui-table-cell-isFirst"><label class="nui-chk"><input disabled="disabled" class="nui-chk-symbol" type="checkbox"/></label></td><td class="nui-table-cell P0"><b class="nui-ico nui-ico-att"></b></td><td class="nui-table-cell t0"><span title="'+t.name+'">'+i+'</span><span class="nui-txt-impt" title="'+a+'">('+a+')</span></td><td class="nui-table-cell I0">'+$.Number.convert(t.size)+"</td></tr>"}else l[l.length]='<tr class="nui-table-row nui-table-row-selected"><td class="nui-table-cell nui-table-cell-forChk nui-table-cell-isFirst"><label class="nui-chk"><input value="'+e+'" checked="checked" class="nui-chk-symbol" type="checkbox"/></label></td><td class="nui-table-cell P0"><b class="nui-ico nui-ico-att"></</td><td class="nui-table-cell t0"><span title="'+t.name+'">'+t.name+'</span></td><td class="nui-table-cell I0">'+$.Number.convert(t.size)+"</td></tr>"})),c.t("æ‚¨é€‰æ‹©çš„éƒ¨åˆ†é™„ä»¶ç”±äºä»¥ä¸‹åŸå› ï¼Œä¸èƒ½ä¸Šä¼ "),u&&(c.t("æœ¬æ¬¡é€‰æ‹©çš„é™„ä»¶å¤§å°ä¸èƒ½è¶…è¿‡"),$.Number.convert(o));var m='<div class="nui-simpleTable nui-table bc0"><table><thead class="nui-table-head"><tr class="nui-table-row"><th class="nui-table-cell nui-table-cell-forChk nui-table-cell-isFirst"><label class="nui-chk"><input id="objMsgSelectAll" class="nui-chk-symbol" type="checkbox"/></label></th><th class="nui-table-cell s0">'+c.t("æ–‡ä»¶å")+'</th><th class="nui-table-cell C0">'+c.t("å¤§å°")+ss="bm0" style="overflow-y:scroll"><div class="nui-simpleTable nui-table bn0"><table id="tabMsgSelectList"><tbody class="nui-table-body">'+d.join("")+l.join("")+'</tbody></table></div></div><div id="divMsgSelectTips" class="nui-normalTips nui-tips be0"></div>',p=function(){var e,t=$("#divMsgSelectTips");t.removeClass("g-tips-popup-err"),t.removeClass("g-tips-popup-succ"),n>o?(e='<b class="nui-ico nui-ico-err"></b>'+c.t("å·²é€‰æ‹©äº†")+$.Number.convert(n)+c.t("ï¼Œè¶…å‡º")+$.Number.convert(n-o),t.addClass("g-tips-popup-err")):(e='<b class="nui-ico nui-ico-suc"></b>'+c.t("å·²é€‰æ‹©äº†")+$.Number.convert(n)+c.t("ï¼Œå¯ä»¥ä¸Šä¼ "),t.addClass("g-tips-popup-succ")),d.length&&(e+='<span class="txt-tips">'+c.t("(æœ‰")+"<strong>"+d.length+"</strong>"+c.t("ä¸ªä¸èƒ½é€‰æ‹©)")+"</span>"),t.html(e)},f="";if(s.isNonPayingUser()){f=new $.Link({text:c.t("ç«‹å³å¼€é€šé‚®ç®±ä¼šå‘˜ï¼Œçªç ´é™„ä»¶ä¸Šä¼ é™åˆ¶>>"),click:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){var t=e.default;$.Msgbox.msgbox.close(),setTimeout((function(){t.showDialog("cloudFileDownSpeed","","Largeattachments5"),$.Log.cache({ComposeAttachFilterTipsClick:1})}),100)})))}}).html();var h=$.Msgbox.show({statsKey:"Compose_Premium_Popup_LargeAttachmentLimitTotal",type:"confirm",header:c.t("é™„ä»¶ä¸Šä¼ æç¤º"),content:m,contentType:"wide",ok:function(){var i=[],a=[];$.Array.each(e,(function(e,t){t.err?i.push(t):a.push(t)})),t({ignore:i,select:a})},footer:f,cancel:a,close:a})}else h=$.Msgbox.show({statsKey:"Compose_Premium_Popup_LargeAttachmentLimitTotal",type:"confirm",header:c.t("é™„ä»¶ä¸Šä¼ æç¤º"),content:m,contentType:"wide",ok:function(){var i=[],a=[];$.Array.each(e,(function(e,t){t.err?i.push(t):a.push(t)abled(!0);var v=[],b=$("#objMsgSelectAll");b.listen("click",(function(){var e=b.dom.checked;$.Array.each(v,(function(t,i){i.dom.checked!=e&&i.dom.click()}))})),$("#tabMsgSelectList").find("tr").each((function(t,i){var a=(i=$(i)).find("input");a.dom.disabled||(v.push(a),a.listen("click",(function(){var t=parseInt(a.dom.value,10),r=e[t];a.dom.checked?(r.err="",n+=r.size,i.addClass("nui-table-row-selected")):(r.err="cancel",n-=r.size,i.removeClass("nui-table-row-selected")),p(),h.buttons.ok.setDisabled(n>o)})),i.listen("mouseover",(function(){-1==i.dom.className.indexOf("nui-table-row-selected")&&i.addClass("nui-table-row-hover")})),i.listen("mouseout",(function(){i.removeClass("nui-table-row-hover")})),i.listen("click",(function(e){var t=$.Event.getTarget(e);t&&"string"==typeof t.type&&"checkbox"==t.type.toLowerCase()||a.dom.click()})))}))},filterFailMsgboxShow:function(e,t){var i=this.module,a=i.view,n=i.data,o="",r="ç«‹å³å‡çº§",s=function(){},l=(t=t/1024/1024/1024,$.Number.convert($S("cloud").fileSizeLimit)),d=n.get({status:"vipMember"}),u=null;$E("product.Privileges",(function(e){u=e}));var m={};"limitBig"===e&&(d?t>3&&t<=6?(m={isMember:!0,limit:"3G"},o=c.t("å½“å‰è¶…å¤§é™„ä»¶å¤§å°è¶…è¿‡é™åˆ¶")+"("+l+")ï¼Œæ‚¨å¯ä»¥å‡çº§ä¼šå‘˜æå‡å•ä¸ªé™„ä»¶ä¸Šä¼ ä¸Šé™ï¼ŒåŒæ—¶è·å¾—å®¹é‡çLargeattachmentsButton")}):t>6&&t<=10?(m={isMember:!0,limit:"6G"},o=c.t("å½“å‰è¶…å¤§é™„ä»¶å¤§å°è¶…è¿‡é™åˆ¶ (6G)ï¼Œæ‚¨å¯ä»¥å‡çº§ä¼šå‘˜å°†å•ä¸ªé™„ä»¶ä¸Šä¼ ä¸Šé™æå‡è‡³10Gï¼ŒåŒæ—¶è·å¾—å®¹é‡ç­‰æƒç›Šå‡çº§ã€‚"),s=function(){u.upgrade({utm_source:"web_upgrade_filelimit"})}):t>=10&&(m={isMember:!0,limit:"10G"},r="æˆ‘çŸ¥é“äº†",o=c.t("å½“å‰è¶…å¤§é™„ä»¶å¤§å°è¶…è¿‡é™åˆ¶ (10G)ï¼Œè¯·æ‚¨è°ƒæ•´é™„ä»¶å¤§å°é‡æ–°ä¸Šä¼ ã€‚")):(m={isMember:!1,limit:l},o=c.t("å½“å‰è¶…å¤§é™„ä»¶å¤§å°è¶…è¿‡é™åˆ¶")+"("+l+")ï¼Œæ‚¨å¯ä»¥å‡çº§ä¼šå‘˜æå‡å•ä¸ªé™„ä»¶ä¸Šä¼ ä¸Šé™ï¼ŒåŒæ—¶è·å¾—å®¹é‡ç­‰æƒç›Šå‡çº§ã€‚",s=function(){u.showDialog("cloudFileSizeLimit","","LargeattachmentsButton")}),o&&a.popupCreator({pauseTime:99999999,icon:"warnCircle",scene:"compose_attach_error",title:"è¶…å¤§é™„ä»¶ä¸Šä¼ å¤±è´¥",content:o,key:"compose_attach_limitBig",logParam:m,okText:r,close:function(){},ok:s}))},prompt:function(e){var t=this;(t.data,t.module).mailtrace,t.promptTips(e)},promptTips:function(e){var t=this,i=t.data,a=t.module,n=a.mailtrace,o=t.sourceGet("element"),r=t.sourceGet("tips"),s=$S("cloud"),d="",u=n.attachIsEnable();if(e.capacity&&s){var m=s.spaceUsed,p=s.capacity;if((0===p?0:Math.floor(m/p*100))>=90){if(!r.capacity){var f=$.Element.create("DIV");f.html('<div class="nui-tips nui-normalTips nui-normalTips-err">'+c.t("è¶…å¤§é™„ä»¶å®¹é‡å·²æ»¡ï¼Œè¯·å…ˆ ")+'<a href="javascript:void(0)">'+c.t("æ¸…ç†è¶…å¤§é™„ä»¶")+"</a>"+c.t(" å†ç»§ç»­ä¸Šä¼ æ–‡ä»¶ã€‚")+"</div>"),r.capacity=f,o.content.after(f.dom),f.find("A").listen("click",(function(){t.cloudManage()}))}r.capacity.show(),h()}else r.capacity&&r.capacity.hide()}if(e.cloud)return h(),void function(){var t=$S("cloud").duration;d=e.text||c.t("ä¸ºé¿å…é™„ä»¶è¿‡å¤§å¯¼è‡´é‚®ä»¶å‘é€å¤±è´¥ï¼Œé™„ä»¶å°†ä½œä¸ºè¶…å¤§é™„ä»¶ä¸Šä¼ ï¼Œ")+"<span class='nui-txt-impt'>"+t+c.t("å¤©")+"</span>"+c.t("å†…æœ‰æ•ˆï¼Œè‹¥è¢«åˆ é™¤æˆ–è¿‡æœŸï¼Œæ”¶ä»¶äººå°†æ— æ³•ä¸‹è½½ã€‚");var a=$.Element.create("DIV");a.setClass("M0"),a.html(d),o.content.after(a.dom),r.cloud=a,i.get({status:"vipMember"})||$S("isVip")?new $.Link({text:c.t("ä¿®æ”¹è®¾ç½®"),cnterface"],(function(e){e.entry({module:"BaseSetModule",inction(){$E("product.Privileges",(function(e){e.showDialog("plus","","filebox_annex1"),$.Log.cache({ComposeCloudfileTipsClick:1})}))}}),$.Log.cache({ComposeCloudfileTipsShow:1})),new $.Link({cls:"nui-ico nui-ico-x",renderTo:a,click:function(){r.cloud.remove()}}),o.area.show()}();if(!t.cloudTrigger()&&e.trace&&u)return h(),void function(){var e=a.mailtrace,t=$.Element.create("DIV");t.setClass("M0"),t.html(e.attachTipsCreate()),o.content.after(t.dom),r.trace=t,$.Component.setEvents()}();function h(){r.cloud&&(r.cloud.remove(),r.cloud=null),r.trace&&(r.trace.remove(),r.trace=null)}e.remove&&(e.keys?$.Array.each(e.keys,(function(e,t){r[t]&&(r[t].remove(),r[t]=null)})):l.each(r,(function(e,t){t&&(t.remove(),r[e]=null)})))},checkWasmSupport:function(){try{if("object"===s(window.WebAssembly)&&"function"==typeof window.WebAssembly.instantiate){var e=new window.WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof window.WebAssembly.Module)return new window.WebAssembly.Instance(e)instanceof window.WebAssembly.Instance}}catch(e){}return!1},rustMd5PreInit:function(){var e=this;try{var t=(new Date).getTime();$.Log.cache({compose_rust_md5_init_start:1}),e.prototypeSet("rustMd5InitialPromise",window.rust_md5.createMD5()),e.prototypeSet("rustMd5InitialState","pending"),e.rustMd5InitialPromise.then((function(iustMd5Initiald5Instance",i),$.Log.cache({compose_rust_md5_init_success:{time:(new Date).getTime()-t}})})).cSet("rustMd5InitialState","error"),$.Log.cache({compose_rust_md5_init_?i:i&&i.message,time:(new Date).getTime()-t}})}))}catch(i){e.prototypeSet("rustMd5InitialState","error"),$.Log.cache({compose_rust_md5_init_error:{error:"string"==typeof i?i:i&&i.message,time:(new Date).getTime()-t}})}},rustMd5Preload:function(){var e=this;e.isWasmSupport&&!e.isRustMd5Loaded&&($.Support.loadScript($.Uri.getUrl("compose_attach_rustmd5lib",!0),(function(){e.prototypeSet("isRustMd5Loaded",!0),e.rustMd5PreInit()})),window.requestIdleCallback=window.requestIdleCallback||function(e){return setTimeout((function(){var t=Date.now();e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)},window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)},void 0===window.globalThis&&(window.globalThis=window))},workerLoadUrl:function(e){var t='importScripts( "${ '+e+' }" );';return window.URL.createObjectURL(new window.Blob([t],{type:"text/javascript"}))},workerCreate:function(){var e=this;switch(e.rustMd5InitialState){case"success":return window.Promise.resolve(e.rustMd5Instance);case"pending":return new window.Promise((function(t,i){e.rustMd5InitialPromise.then((function(e){t(e)})),setTimeout((function(){i("timeout")}),e.rustMd5InitialPromiseTimeout)}));case"error":return window.Promise.reject("error")}},workerGet:function(){var e=this;if(e.workerRunningCounter<g.MAX_WORKER_NUM){var t=e.idleWorkerPool.length?e.idleWorkerPool.pop():e.workerCreate();return e.workerRunningCounter++,t._id||(t._id=e.workerRunningCounter),t}return null},workerRelease:function(e){var t=this;t.idleWorkerPool.indexOf(e)<0&&(t.idleWorkerPool.push(e),t.workerRunningCounter--)},workerSend:function(e,t,i,a){var n=this,o=n.hashworkerCallbackUUID;n.hashworkerCallbackUUID++;var r="attach_hash_worker"+o,s={uuid:r},c=t.type+"_success",l=t.type+"_fail";e.postMessage($.Object.extend(s,t)),n.hashworkerCallbackList[r]=function(e){e.type===c?i&&i(e):e.type===l&&a&&a()}},hashCreate:function(e){return new window.Promise((function(e,t){e()}))},hashReset:function(e){return this.hashCreate(e)},hashUpdate:function(e,t){return new window.Promise((function(i,a){window.requestIdleCallback((function(a){e.update(t),i()}),{timeout:100})}))},hashDigest:function(e){return new window.Promise((function(t,i){t(e.finalize())}))},set:function(e){var t=(e=e||{}).value;"string"==typeof e.status?this.sourceGet("status")[e.status]=t:"string"==typeof e.element&&(this.sourceGet("element")[e.element]=t)},setState:function(e,t,i){var a=this;if(e.state=t,e.ui){var n=!1,o=!1,r=!1,s="",l=null,d=$.Number.convert(e.size)+" ";if(e.cloud)switch(e.state){case"select":s=c.t("å¾…æ‰«æï¼Œè¯·ç¨å€™...");break;case"hash":s=-1==e.percent?c.t("æ‰«æä¸­ï¼Œè¯·ç¨å€™..."):c.t("æ‰«æä¸­ï¼Œå·²å®Œæˆ")+e.percent+"%";break;case"hashover":s=c.t("æ‰«æå®Œæ¯•ï¼Œå¼€å§‹ä¸Šä¼ ");break;case"wait":s=""===e.fid?c.t("å¾…ä¸Šä¼ ï¼Œè¯·ç¨å€™..."):c.t("å¾…ç»­ä¼ ï¼Œè¯·ç¨å€™...");break;case"upload":if(-1==e.bytesLoaded)s=""===e.fid?c.t("æ­£åœ¨ä¸Šä¼ ..."):c.t("æ­£åœ¨ç»­ä¼ ..."),a.cloudRename(e);else{t="percent";var u=e.speed;l={uploaded:g.getSize(e.bytesLoaded,2),speed:g.getSize(u.second,2)+"/S",remain:g.getRemain(u.remain)}}break;case"pause":break;case"error":n=!0,s=i||e.err;break;case"success":n=!0,o=!0,r=!0,a.cloudRename(e),s=d+c.t("ä¸Šä¼ å®Œæˆ");break;case"link":s=1===e.fileExist?d+'<span class="nui-txt-suc">'+c.t("ç»­ä¼ å®Œæˆ")+"</span>":d+'<span class="nui-txt-suc">'+c.t("ä¸Šä¼ å®Œæˆ")+"</span>",a.setPreview(e);break;default:return}else switch(t){case"link":s=d+c.t("ä¸Šä¼ å®Œæˆ"),a.setPreview(e);break;case"error":n=!0,s=i||e.err;break;case"success":n=!0,o=!0,s=d+'<span class="nui-txt-suc">'+c.t("ä¸Šä¼ å®Œæˆ")+"</span>",a.setPreview(e);break;case"select":case"wait":s=c.t("å¾…ä¸Šä¼ ï¼Œè¯·ç¨å€™..."),"form"==e.type&&(s=c.t("æ‚¨é€‰æ‹©çš„é™„ä»¶å°†åœ¨ç‚¹å‡»å‘é€åè¿›è¡Œä¸Šä¼ "));break;case"upload":-1==e.bytesLoaded?s=c.t("æ­£åœ¨ä¸Šä¼ ..."):(t="percent",u=e.speed,l={uploaded:g.getSize(e.bytesLoaded,2),speed:g.getSize(u.second,2)+"/S",remain:g.getRemain(u.remain)});break;case"hash":s=e.percent&&-1==e.percent?c.t("æ‰«æä¸­ï¼Œè¯·ç¨å€™..."):c.t("æ‰«æä¸­ï¼Œå·²å®Œæˆ")+e.percent+"%";break;case"fast":s=c.t("å¿«é€Ÿä¸Šä¼ ä¸­...");break;default:return}a.setInfo(e,t,s,l),"error"==t&&a.setTotalProgress(),o&&"function"==typeof e.delete&&e.delete(),n&&a.fileAutoUpload(),r&&a.cloudConvert(e)}},setInfo:function(e,t,i,a){t=t||"text";var n=e.ui;if(n){var o=n.info,r=n.tips,s=e.ui.container,l="q0";if("percent"==t){var d=e.percent?e.percent+"%":"",u=d,m="";if(a&&a.remain){u+=c.t(",å‰©ä½™æ—¶é—´:")+a.remain;var p=$.Number.convert(e.size);m=$.String.escapeHTML(e.name)+c.t(", æ–‡ä»¶å¤§å°:")+p+c.t(", å·²ä¸Šä¼ ")+a.uploaded+c.t(", ä¸Šä¼ é€Ÿåº¦:")+a.speed}var f='<div class="nui-progress"><span class="nui-progress-bar"><span class="nui-progress-bar-inner" style="width:'+d+';"></span></span><span class="nui-progress-text">'+u+"</span></div>";d&&o.html(f),m&&r.html(m)}else"error"==t?(s.addClass(l),i&&o.html(i),a&&a.text?r.html(a.text):(r.html(""),r.hide())):"resum"==t?s.removeClass(l):(i&&o.html(i),"success"==t&&(r.html(""),r.hide()))}},setStart:function(e){0===e.offset&&this.setProgress(e,0)},setFinish:function(e){var t=!1;(0===e.length||e.offset+e.length==e.size)&&(t=!0),t&&(this.setLock(e,!0),this.setProgress(e,99))},setLock:function(e,t){var i=this;if(e)if("boolean"==typeof e.lock)e.lock=t;else{var a=e;$.Array.each(i.fileGet(a),(function(e,a){i.setLock(a,t)}))}},setBytes:function(e,t,i){var a,n=e.size,o=t;0===e.length?i>n&&(a=Math.floor(t/i*100),o=Math.floor(n*(a/100))):o+=e.offset,e.bytesLoaded=o,(a=Math.floor(o/n*100))>98&&(a=98),this.setProgress(e,a)},setHash:function(e,t,i){var a=this;if(e.bytesHashed=t,i)"-1"!=i&&(e.md5=i.toLowerCase()),e.percent=-1,a.setState(e,"wait"),a.fileAutoUpload();else{var n=Math.floor(t/e.size*100);if(e.percent==n)return;e.percent=n,a.setState(e,"hash")}},setSpeed:function(e){var t=(new Date).valueOf(),i=e.speed;if(i){var  n=e.bytesLoaded;if(n>0){var o=Math.round((n-i.bytes)/(a/1e3));o>0&&(i.bytes=n,i.second=o,i.remain=parseInt((e.size-n)/o,10)+1)}}}else i=e.speed={bytes:0,second:0,remain:-1};i.time=t},setProgress:function(e,t){var i=this;if(e.percent==t){var a=e.speed;if(!a)return;if((new Date).valueOf()-a.time<=1e3)return}else e.percent=t;switch(i.setSpeed(e),t){case 0:default:i.setState(e,"upload");break;case 100:i.setState(e,():i.setTotalProgress()},setTotalProgress:function(){var e=this,t=e.sourceGet("element").progress,i=e.fileProgress(),a=i.percent,n=i.bytesLoaded,o=i.bytesTotal;if(e.get({status:"totalBytes"})==o&&e.get({status:"totalPercent"})==a);else{if(a){var r="("+a+c.t("%,å·²ä¸Šä¼ ")+$.Number.convert(n)+c.t(",æ€»æ–‡ä»¶å¤§å°")+$.Number.convert(o)+")";t.show(),t.html(r)}else t.hide();e.set({status:"totalBytes",value:o}),e.set({status:"totalPercent",value:a})}},get:function(e){var t=this;return"string"==typeof(e=e||{}).status?t.sourceGet("status")[e.status]:"string"==typeof e.element?t.sourceGet("element")[e.element]:e.count?t.fileCount():e.file?t.fileGet(e.file):void 0},getCheck:function(e){var t=this,i=!1;return t.getUploadHost()&&(e.inlined||(e.cloud?(e.md5?t.setInfo(e,"",c.t("æ­£åœ¨å°è¯•é€Ÿä¼ ï¼Œè¯·ç¨å€™...")):t.setInfo(e,"",c.t("æ­£åœ¨æ£€æŸ¥å®¹é‡ï¼Œè¯·ç¨å€™...")),i=!0):e.md5?(t.setState(e,"fast"),i=!0):e.sid&&(i=!0))),i&&(t.setLock(e,!0),t.setState(e,"upload")),i},getUploadHost:function(){if(this.module.data.get({status:"useWmsvr"}))return"";var e=this.uploadHostList;return e&&e.length?e[0]:""},initUploadRetryMax:function(){g.UPLOAD_RETRY_MAX=this.uploadHostList?this.uploadHostList.length:3},getUploadUrl:function(e){var t=e.type,i=h.getUrl("compose_upload_url",!0);return(i+="&composeId="+this.info.get({cid:!0}))+"&type="+t},getUploadProxy:function(e){var t=this,i=e.type,a=e.file,n="get";e.options&&(n=e.options);var o={},r=t.getUploadHost();e.move&&(r=g.upxmailConfig.normal[0]),""===r&&(r=$S("orgHost"));try{if("native"===e.type){var s=!!e.file&&e.file.cloud;r.indexOf("hz.mail")>=0&&s&&$.Log.cache({compose_attach_proxy_missmatch:{fileCloud:s,host:r,hostList:$.Array.map(g.upxmailConfig.fs,(function(e,t){return t.split(".")[0]}))}})}}catch(e){}var c="https://"+r;if(c+="/upxmail/upload",c+="?sid="+$S("sid"),c+="&uid="+$S("orgUid"),c+="&cid="+t.info.get({cid:!0}),c+="&host="+$S("orgHost"),c+="&ver=js6",c+="&agent="+i,a)if(a.cloud?o.type=1:o.type=0,o.name=a.name,o.size=a.size,a.path&&(o.path=a.path),a.md5&&(o.md5=a.md5),a.modtime&&(o.modtime=a.modtime),a.ret&&l.each(a.ret,(function(e,t){o[e]=t})),e.check)if(a.cloud){c+="&chk=true";var d=t.moveSize();d>0&&(o.xsize=d)}else c+="&qry=true";else e.cancel?c+="&cal=true":(a.offset&&(o.offset=a.offset),a.length&&(o.length=a.length),a.inlined);else e.move&&(c+="&mov=true"),e.aid&&(o.aid=e.aid.join("|")),"number"==typeof e.size&&(o.size=e.size);switch(l.each(o,(function(e,t){"string"!=typeof t&&(o[e]=String(t).valueOf())})),n){case"body":var u="",m=[];l.each(o,(function(e,t){m.push(e+"="+encodeURIComponent(t))})),m.length&&(u=m.join("&")),a.options=u;break;case"form":a.options=o;break;case"header":var p={};l.each(o,(function(e,t){p["Mail-Upload-"+e]=encodeURIComponent(t)})),a.options=p;break;default:l.each(o,(function(e,t){c+=["&",e,"=",encodeURIt="+(new Date).valueOf()),a&&(a.options=null)}return c},getPreview:function(){var e=[];return $.Array.each(this.fileGet({inlined:!1}),(function(t,i){if("success"==i.state||"link"==i.state){var a={name:i.name,icon:i.icon};e.push(a)}})),e},getTraceFileList:function(){var e=this.fileGet({cloud:!0});return $.Array.map(e,(function(e,t){var i=t.link.url;return{fileId:$.Support.parseQuery(i).file,fileName:t.name}}))},fileCreate:function(e){var t={},i=(e=e||{}).type,a=e.path,o=e.name,s=e.mime,c=e.size,d=e.sid,m=e.eid;if(l.extend(t,g.file),i&&(t.type=i),a?(t.path=a,o||(o=a.replace(new RegExp(".*"+g.symbol),"")),this.fileGet({path:a}).length>=1&&(t.pathExist=!0)):o&&(o=o.replace(new RegExp(".*"+g.symbol),"")),o){t.name=o,t.icon=n.Z.getSubtype({type:"file32",name:o});var p=o.split(".");if(p.length>1){var f=p.pop();f&&(f=f.toLowerCase(),t.ext=f,-1!=u.indexOf("."+f+".")&&(t.extLimit=!0))}}s&&(t.mime=s),"number"==typeof c&&(t.size=c,"storage"==i&&(t.bytesLoaded=c)),d&&(t.sid=d),m&&(t.eid=m),e.cloud&&(t.cloud=e.cloud);try{var h=(new Date).getTime();t.__uuid__=r.()+t.name+t.size.toString())}catch(e){}return t},fileCount:function(e){return e?this.fileGet(e).length:l.count(this.sourceGet("files"))},fileGet:function(e){e=e||{};var t=[],i=this.sourceGet("files");return l.each(i,(function(i,a){var n=!0;l.each(e,(function(e,t){a[e]!=t&&(n=!1)})),n&&t.push(a)})),t},fileAdd:function(e){var t=this,i=t.get({status:"fileIndex"}),a=t.sourceGet("files");e.cid="order_"+i++,t.set({status:"fileIndex",value:i}),a[e.cid]=e},fileDelete:function(e,t){var i="";return"string"==typeof e?i=e:"object"==s(e)&&(i=e.cid),t=this.sourceGet("files"),!(!i||!t[i]||(delete t[i],0))},fileHas:function(e){var t=!1;return this.fileCount(e)>0&&(t=!0),t},fileSize:function(e){var t=0,i=this.fileGet(e);return $.Array.each(i,(function(e,i){i.size>0&&(t+=i.size)})),t},fileAutoUpload:function(e){var t=this,i=t.base,a=null,n=!0;e||0===(a=t.fileGet({state:"upload"})).length&&0===(a=t.fileGet({state:"wait"})).length&&i.runSequence("attachMove"),0===(a=t.fileGet({type:"plugin",state:"upload"},e)).length?(a=t.fileGet({type:"plugin",state:"wait"},e)).length&&(t.pluginCheck(a[0]),n=!1):n=!1,0===(a=t.fileGet({type:"native",state:"upload"},e)).length?(a=t.fileGet({type:"native",state:"wait"},e)).length&&(t.nativeCheck(a[0]),n=!1):n=!1,t.fileAutoHash(e)&&(n=!1);var o=!n;return o||n&&i&&i.runSequence("uploadResult",0),o},fileAutoHash:function(e){var t=this,i=null,a=!1;if((i=t.fileGet({type:"native",state:"select"},e)).length){var n=function(e,i,a){t.fileLog&&t.fileLog(e,i,a)};i.sort((function(e,t){return e.size-t.size}));var o=i.pop(),r=(new Date).getTime();n("compose_attach_autohash_prepare",o,{}),t.workerCreate().then((function(e){t.fileHash(e,o),n("compose_attach_autohash_preparesuccess",o,{time:(new Date).getTime()-r})})).catch((function(e){t.setState(o,"wait"),t.fileAutoUpload(),n("compose_attach_autohash_preparefail",o,{time:(new Date).getTime()-r,error:e})})),a=!0}return a},fileHash:function(e,t){var i=this,a=2097152,n=new FileReader,o=t.blob;function r(r){return function(){return t.worker?(s=o.slice(a*r,Math.min(a*(r+1),o.size)),new window.Promise((function(t,a){n.onload=function(a){var n=new Uint8Array(a.target.result);i.hashUpdate(e,n).then((function(){t()}))},n.readAsArrayBuffer(s)}))).then((function(){return i.setHash(t,Math.min(a*(r+1),o.size)),window.Promise.resolve()})):window.Promise.reject("stop");var s}}$.Log.cache({composeattach_filehash_begin:1}),i.hashCreate(e).then((function(){var n=Math.floor(o.size/a);t.worker=e;for(var s=window.Promise.resolve(),c=Date.now(),l=0;l<=n;l++)s=s.then(r(l));s.then((function(){return i.hashDigest(e)})).then((function(e){var a=Date.now(),n=t.size/1024/1024/((a-c)/1e3);t.hashSpeed=Math.floor(100*n)/100,i.setHash(t,t.size,e),$.Log.cache({composeattach_filehash_finish:{hashSpeed:t.hashSpeed,hashValue:e}})})).catch((function(e){$.Log.cache({composeattach_filehash_catach:{reason:e}})}))}))},fileProgress:function(e){var t=0,i=0,a=0;return e=e||(d.newAttach?{inlined:!1}:null),$.Array.each(this.fileGet(e),(function(e,t){i+=t.size,"error"==t.state||-1!=t.bytesLoaded&&(-1==t.percent?a+=t.bytesLoaded:a+=Math.floor(t.size*(t.percent/100)))})),0===i?a=0:t=Math.round(a/i*100),{percent:t,bytesLoaded:a,bytesTotal:i}},complete:function(e,t){var i,a=this;a.module,a.info,a.setLock(e,!1);try{i=$.Support.parseJSONLikeStr(t)}catch(e){try{i=JSON.parse(t)}catch(n){i={code:"JS_EVAL"},$.Log.cache({compose_attcah_nativejsonerror:{responsestring:t,upxmailhost:a.getUploadHost(),error:e&&e.message}})}}var n={code:i.code};if(i.code==p){if("number"==typeof i.type){if(e.length){if(e.offset+=e.length,e.offset!=e.size)return e.ret=i.ret||e.ret,0===i.type&&e.ret&&e.ret.aid&&(e.sid=e.ret.aid),n.continue=!0,i.ext.block&&(g.sliceLength=i.ext.block),n;e.length=0}var o=i.var;switch(i.type){case 0:e.sid=o.attachmentId;break;case 1:e.fid=o.fid,o.dupname&&(e.nameExist=!0,e.name=o.fileName),e.link=o}}else e.sid=i.attachId;g.sliceLength=g.defaultSliceSize,a.setBytes(e,e.size,e.size),a.setProgress(e,100),e.inlined?a.inlineInsert(e):!e.cloud&&$.Array.has(["31","32","33"],e.icon)&&$.Array.has(["31","32","33"],e.icon)&&a.setInsert(e),e.retry=0,$.Listener.fire("compose:fileUploadFinished")}else{var r=i.overflowReason||"";a.error(e,i.code,r)&&(n.retry=!0)}return n},fileIsUpload:function(){return this.fileHas({state:"upload"})||this.fileHas({state:"hash"})},fileIsPost:function(){var e=!1;return this.fileGet({type:"form",state:"wait"}).length>=1&&(e=!0),e},fileIsError:function(){return d.newAttach?this.fileHas({state:"error",inlined:!1}):this.fileHas({state:"error"})},add:function(e){var t=this,i=t.data,a=t.sourceGet("status");a.layoutInit||(t.layout(),a.layoutInit=!0);var n=t.sourceGet("layout");if(t.cloudTrigger()){switch(e.type){case"plugin":case"native":e.context||e.inlined?e.context=!0:e.cloud=!0}t.prompt({capacity:!0})}var r,s,l,u,p,f,h=t.base,g=e.name;if((r=$.Element.create("DIV")).setClass("G0"),e.mixed||e.inlined&&d.newAttach&&r.css({display:"none"}),n.blockWidth){var v=n.blockWidth+"px";r.css({width:v})}new $.Icon({renderTo:r,type:"file32",subtype:e.icon}),(s=$.Element.create("DIV")).setClass("o0"),s.html($.String.escapeHTML(g)),e.path?s.attr({title:e.path}):s.attr({title:g}),(l=$.Element.create("DIV")).setClass("j0"),(p=$.Element.create("DIV")).setClass("m0"),e.action={delete:null,resume:null},f=$.Element.create("A"),e.action||(e.action={}),e.action.delete=function(i){t.remove(e),t.netCheckClear(),e.action&&(e.action.delete=null),i&&$.Event.cancel(i),m.cache({compose_attach_delete:{state:e.state,fileCloud:e.cloud,size:e.size,ext:e.ext,fuuid:e.__uuid__}})},f.attr({href:"javascript:void(0)"}),f.addClass("nui-txt-link"),f.html(c.t("åˆ é™¤")),f.listen("click",e.action.delete),p.append(f.dom),e.download&&function(){s.css({width:"170px"});var t=$.Element.create("SPAN");t.html("|"),p.append(t.dom);var i=$.Element.create("A");i.attr({target:"_blank",href:e.download}),i.addClass("nui-txt-link"),i.html(c.t("ä¸‹è½½")),$.Browser.chrome()&&e.mime&&i.listen("dragstart",(function(t){var i=[e.mime,g,e.download].join(":");try{t.dataTransfer.setData("DownloadURL",i)}catch(e){}})),p.append(i.dom)}(),(u=$.Element.create("DIV")).setClass("n0"),u.css({display:"none"}),r.append(s.dom),r.append(p.dom),r.append(l.dom),r.append(u.dom),e.ui={container:r,name:s,info:l,tips:u,ctrl:p},"form"==e.type?t.setState(e,"wait"):"storage"==e.type?(t.setState(e,"success"),e.cloud||e.url||!$.Array.has(["31","32","33"],e.icon)||$.Array.has(["31","32","33"],e.icon)&&t.setInsert(e)):"link"==e.type?t.setState(e,"link"):t.isRustMd5Loaded&&$.Ext.fileHashUplaod&&e.cloud?t.setState(e,"select"):t.setState(e,"wait"),i.get({status:"confirmSubject"})&&""===h.form.getSubject()&&(!e.url||g!=c.t("åç‰‡.vcf")&&g!=c.t("ä¿¡çº¸.jpg"))&&(function(){var t;if(e.media)t=o.default.getName()+c.t("å½•åˆ¶çš„éŸ³è§†é¢‘é‚®ä»¶");else{var i=g.split(".");i.length>1&&i.pop(),t=i.join(".")}h.form.setSubject(t)}(),i.set({status:"confirmSubject",value:!1})),t.fileAdd(e),t.setAuto({type:"add",element:r}),t.setTips(e)},resum:function(e){var t,i=this,a=i.sourceGet("layout").blockWidth;if(d.newAttach&&e.inlined)i.inlinedError(e);else{var n=e.ui,o=n.name,r=n.ctrl;if(e.ui.resum||e.ui.unlockOverflowLimit)return;o.css({width:$G.environment.isCh?"170px":a-200+"px"}),this.isOverflow(e)&&$.Ext.privilegeOverflow?i.showOverflowDialog():(t=i.getResumLink(e),r.append(t.dom),e.ui.resum=t)}},remove:function(e,t){var i=this,a=arguments;if(!e.lock)if(e.sid)i.action.deleteAttach({sid:e.sid,callback:function(t){if(t.code==p)i.inlineRemove(e),e.sid="",i.remove.apply(i,a);else try{$.Log.cache({compose_attach_delete_fail:{sid:e.sid,code:t.code,uploadType:e.type,ext:e.ext,name:e.name,size:e.size}})}catch(e){}}});else{if("function"==typeof e.delete&&e.delete(),e.cid&&i.fileDelete(e),e.ui){var n=e.ui.container;e.ui=null,i.setAuto({type:"remove",element:n})}if(e.cloud&&"upload"==e.state&&(e.ret&&e.ret.oid&&$.Ajax.jsonp(i.getUploadProxy({type:"script",file:e,cancel:!0}),(function(){})),e.ret&&e.ret.fid&&($.Ajax.jsonp(h.getUrl("compose_batch_delete_url")+"&op=batchDelete&fileIds="+e.ret.fid,(function(){var t=$S("cloud"),i=t.spaceUsed;i-e.size>=0&&(t.spaceUsed=i-e.size,$S("cloud",t))})),$.Log.cache({compose_batch_delete:{from:"fComposeAttachRemove",fileIds:e.ret.fid}}))),e.worker){var o=e.worker;e.worker=null,i.workerRelease(o)}i.cancelAutoSend(c.t("æ‚¨å·²åˆ é™¤ä¸Šä¼ çš„é™„ä»¶ï¼Œè‡ªåŠ¨å‘é€å–æ¶ˆ")),i.fileAutoUpload(),"function"==typeof t&&t()}},setAuto:function(e){var t=this,i=t.sourceGet("element"),a=e.type,n=e.element,o=t.fileCount();if("add"==a?i.content.append(n.dom):"remove"==a&&n.remove(),o>0)i.area.show();else{i.area.hide(),t.prompt({remove:!0,keys:[]});try{var r=t.sourceGet("tips");r.plugin&&(r.plugin.remove(),r.plugin=null)}catch(e){}}"add"!=a&&"remove"!=a||t.setTotalProgress()},setInsert:function(e){var t=this,i=e.ui,a=i.ctrl,n=$.Element.create("A");n.attr({href:"javascript:void(0)"}),n.addClass("nui-txt-link"),n.html(c.t("æ’å…¥æ­£æ–‡")),n.listen("click",(function(i){var a=t.fileSize({context:!0}),n=1024*$S("attachSize")*1024;a+e.size>n?$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_PictureUploadLimitAttachment",title:c.t("é™„ä»¶ä¸Šä¼ æç¤º"),icon:"err",content:c.t("æ·»åŠ çš„å›¾ç‰‡æ€»å¤§å°ä¸èƒ½è¶…è¿‡")+$.Number.convert(n)}):(d.newAttach?e.mixed=!0:e.inlined=!0,e.context=!0,t.inlineInsert(e),$.Event.cancel(i))})),a.prepend(n.dom),i.name.css({width:"148px"})},setPreview:function(e,t){},setTips:function(e){var t=e.ui,i=t.container,a=!1,n=$.Browser.getVersion()||[0,0];$.Browser.ie()&&6==n[0]&&(a=!0),i.listen("mouseover",(function(){t.tips.html()&&(t.tips.show(),a&&i.css({zIndex:"100"}))})),i.listen("mouseout",(function(){t.tips.hide(),a&&i.css({zIndex:"1"})}))},setPDFConvertTips:function(e){var t=this.view,i=e.size/1024/1024;"pdf"!==e.ext||i>20||t.PDFConvertTips(e)},getResumLink:function(e,t){var i=this,a=$.Element.create("A");return e.action||(e.action={}),e.action.resume=function(n){i.setInfo(e,"resum"),t&&t.remove(),a.remove(),e.ui.resum=null,e.retry=0,e.action&&(e.action.resume=null),i.setState(e,"wait"),i.fileAutoUpload(),n&&$.Event.cancel(n)},a.attr({href:"javascript:void(0)"}),a.addClass("nui-txt-link"),a.html(c.t("ç»­ä¼ ")),a.listen("click",e.action.resume),a},getUnlockOverflowLimitLink:function(e){var t=this,i=$.Element.create("A");return i.attr({href:"javascript:void(0)"}),i.addClass("nui-txt-link"),i.html(c.t("è§£é™¤é™åˆ¶")),i.listen("click",(function(i){t.showOverflowDialog((function(){e&&e()})),$.Event.cancel(i)})),i},inlineInsert:function(e){if(e.inlined||e.mixed){var t=h.getUrl("compose_get_data",!0);t+="&composeId="+this.info.get({cid:!0}),t+="&attachId="+e.sid,t+="&rnd="+Math.random(),this.editor.insert({image:t})}},inlineRemove:function(e){if(e.inlined||e.context){var t=new RegExp("&sid="+$S("sid")+"&composeId="+this.info.get({cid:!0})+"&attachId="+e.sid,"i");this.editor.remove({tag:"img",reg:t}),e.inlined=e.context=!1}},inlineGet:function(){var e=[],t=this.fileGet({type:"storage",inlined:!0});return $.Array.each(t,(function(t,i){i.sid&&e.push({id:i.sid,inlined:!1})})),e},inlineSync:function(){var e=[],t=this.fileGet({inlined:!0});return $.Array.each(t,(function(t,i){i.sid&&e.push({id:i.sid,inlined:!0})})),t=this.fileGet({mixed:!0}),$.Array.each(t,(function(t,i){i.sid&&e.push({id:i.sid,mixed:!0})})),e},inlinedProgress:function(){var e=this,t=e.base,i=e.fileProgress({inlined:!0}),a=i.percent,n=(i.bytesLoaded,i.bytesTotal,""),o=e.fileCount({inlined:!0}),r=e.fileCount({inlined:!0,state:"success"}),s=e.get({status:"inlinedExist"}),l=o-s,d=r-s;a&&(100==a?(t.tips(n),e.set({status:"inlinedExist",value:r})):(n=c.t("å›¾ç‰‡ä¸Šä¼ ä¸­")+(d+"/")+l+"..."+a+"%",$.Tips.moduleTips?$.Tips.moduleTips.setText(n):t.tips(n,"Compose_NoGuide_Tips_PictureUploading")))},inlinedError:function(e){var t=this;(t.data,t.base).tips("");var i=t.sourceGet("tips"),a=i.inlined;a?a.show():((a=$.Element.create("DIV")).setClass("M0 nui-tipsLayer nui-tipsLayer-arrDown nui-layer nui-layer-arrDown"),t.sourceGet("element").area.after(a.dom),i.inlined=a,a.html('<b class="nui-layer-arr" style="left:268px;"></b><div class="nui-layer-normal"><ul></ul></div>'));var n,o,r,s=a.dom.getElementsByTagName("UL")[0],l=e.name;n=$.Element.create("LI"),(o=$.Element.create("SPAN")).html($.String.escapeHTML(l)+'&nbsp;<span class="nui-txt-err">'+c.t("ä¸Šä¼ å¤±è´¥")+"</span>&nbsp;&nbsp;"),n.append(o.dom),r=$.Element.create("A"),e.action||(e.action={}),e.action.resume=function(i){t.setInfo(e,"resum"),e.retry=0,e.action&&(e.action.resume=null),t.setState(e,"wait"),t.fileAutoUpload(),n.remove(),0===t.fileCount({inlined:!0,state:"error"})&&a.hide(),i&&$.Event.cancel(i)},r.attr({href:"javascript:void(0)"}),r.addClass("nui-txt-link"),r.html(c.t("ç»­ä¼ ")),r.listen("click",e.action.resume),n.append(r.dom),function(){var i=$.Element.create("A");i.attr({href:"javascript:void(0)"}),i.addClass("nui-txt-link"),i.html(c.t("åˆ é™¤")),i.listen("click",(function(i){t.remove(e),t.netCheckClear(),n.remove(),0===a.dom.getElementsByTagName("LI").length&&a.hide(),$.Event.cancel(i)})),n.append(i.dom)}(),s.appendChild(n.dom),e.ui2={container:n,name:o}},storageAdd:function(e,t){var i=this,a=(i.base,i.data).get({status:"fromEntry"});if(l.isArray(e)){var n="";if(t){if("compose"==a)return void i.action.syncAttach({attachments:e,callback:function(e){e.code==p&&$.Array.each(e.var.attachments,(function(e,t){i.storageAdd(t)}))}});"draft"==a&&(n=h.getUrl("compose_get_data",!0)+"&mode=download&composeId="+i.info.get({cid:!0}))}$.Array.each(e,(function(e,t){n&&(t.download=n+"&attachId="+t.id),i.storageAdd(t)}))}else if(!e.deleted){var o=e.type,r=e.name||e.fileName;e.displayName&&(r=e.displayName);var s=e.contentType;if(!r&&s)switch(s.toLowerCase()){case"message/disposition-notification":r=c.t("å·²è¯»å›æ‰§");break;case"message/delivery-status":r=c.t("ä¿¡æ¯ç¢ç‰‡");break;case"message/rfc822":r=c.t("é‚®ä»¶æ­£æ–‡.txt");break;default:r="No name";var d=s.split("/");d[1]&&("gif"==(s=d[1].toLowerCase())||"png"==s?r+="."+s:"jpg"!=s&&"jpeg"!=s||(r+=".jpg"))}var u=e.id||e.attachmentId,m=i.fileCreate({type:"storage",name:r,mime:s,size:e.size,sid:u});"url"==o&&(m.url=e.name),e._mid&&(m.mid=e._mid),e.inlined&&(m.inlined=!0,m.context=!0),e.mixed&&(m.mixed=!0,m.context=!0),e.media&&(m.media=e.media,m.context=!0),e.download&&(m.download=e.download),i.add(m),i.setPreview(m,{nosave:!0})}},validLocal:function(){var e=this.fileGet({state:"error"}),t="",i=this.data;$.Array.each(e,(function(e,i){t+=c.t("è¯·ç»§ç»­ä¸Šä¼ æˆ–åˆ é™¤è¯¥é™„ä»¶ï¼š")+'<span style="color:#F04b4b">'+i.name+"</span><br/>"}));var a=c.t("é™„ä»¶ä¸Šä¼ æœªå®Œæˆ");$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentUploadError",title:a,icon:"alert",content:t,cancelText:c.t("åˆ é™¤"),cancel:function(){i.get({status:"network"})&&$.Array.each(e,(function(e,t){t.action&&t.action.delete?t.action.delete():$.Log.cache({b_compose_attach_deleteaction_empty:1})}))},okText:c.t("ç»§ç»­ä¸Šä¼ "),ok:function(){i.get({status:"network"})&&$.Array.each(e,(function(e,t){t.action&&t.action.resume?t.action.resume():$.Log.cache({b_compose_attach_resumeaction_empty:1})}))}})},validServer:function(e){var t=this,i=t.info.get({cid:!0});t.action.syncAttach({cid:i,callback:function(i){var a=t.fileGet({state:"success",cloud:!1}),n=i.var.attachments,o=[];$.Array.each(n,(function(e,t){var i=!1;$.Array.each(a,(function(e,a){if(t.id==a.sid)return i=!0,$.BREAK})),i||o.push(t.id)})),o.length>0?t.action.deleteAttach({sid:o,callback:function(e){e.code==p&&t.base.send({action:"deliver"})}}):t.base.send({action:e})}})},check:function(e,t){var i,a=this;a.setLock(e,!1);try{i=$.Support.parseJSONLikeStr(t)}catch(e){try{i=JSON.parse(t)}catch(n){i={code:"JS_EVAL"},$.Log.cache({compose_attcah_nativejsonerror:{responsestring:t,upxmailhost:a.getUploadHost(),error:e&&e.message}})}}if(!e.cid)return!1;var n=i.type,o=i.ext;if(o&&("number"==typeof o.spaceused&&($S("cloud").spaceUsed=o.spaceused),"number"==typeof o.capacity&&($S("cloud").capacity=o.capacity),"number"==typeof o.sizelimit&if(1==n){if($S("cloud").spaceUsed+=e.size,e.ret=i.ret||null,r){if(r.exist){e.fileExist=2,a.complete(e,t);try{a.fileLog("composeattach_flashupload",e)}catch(e){}return!1}if(r.existlen){e.fileExist=1,e.fid=r.fid,r.dupname&&(e.nameExist=!0,e.name=r.filename),e.offset=r.existlen,$S("cloud").spaceUsed-=e.size;try{a.fileLog("composeattach_continueupload",e)}catch(e){}}}}else if(0===n&&r)if(r.actualSize){if(r.actualSize==r.size)return a.complete(e,t),!1;e.offset=r.actualSize}else e.sid=r.attachmentId;return!0}return"UX_FILE_NOT_FOUND"==i.code||(a.error(e,i.code,"","check")?a.nativeCheck(e):a.resum(e),!1)},error:function(e,t,i,a){var n=this;"TIMEOUT"==t&&n.fileBreak(e);var o=c.t("æœªçŸ¥é”™è¯¯"),r=c.t("ï¼Œè¯·é‡è¯•"),s=!1;switch(t){case"JS_EVAL":o=c.t("æœåŠ¡å™¨è¿”å›æ ¼å¼é”™è¯¯")+r;break;case"JS_PLUGIN":o=c.t("æ’ä»¶ç‰ˆæœ¬è¿‡ä½ï¼Œè¯·ä½¿ç”¨æ ‡å‡†æ·»åŠ é™„ä»¶æ–¹å¼é€‰æ‹©å¤§æ–‡ä»¶");break;case"NS_402":case"UP_NOT_LOGIN":case"FA_INVALID_SESSION":o=c.t("ç™»å½•è¶…æ—¶ï¼Œè¯·é‡æ–°ç™»å½•é‚®ç®±");break;case"NS_415":o=c.t("è¶…å¤§é™„ä»¶æœåŠ¡å™¨å› ç½‘ç»œé—®é¢˜å·²æš‚åœä¸Šä¼ ï¼Œè¯·æ‰‹åŠ¨é‡è¯•");break;case"NS_514":o=c.t("ç³»ç»Ÿä¸æ”¯æŒå¤šæ¬¡åŒæ—¶é‡å¤ä¸Šä¼ åŒä¸€ä¸ªæ–‡ä»¶");break;case"NS_515":case"FA_OVERFLOW":case"MD_OVERFLOW":case"FA_UPLOAD_SIZE_EXCEEDED":"pref_smtp_max_send_mail_size"==i?o=c.t("é™„ä»¶å¤§å°è¶…è¿‡é™åˆ¶"):"pref_flow_limit"==i?(o=c.t("é™„ä»¶æµé‡è¶…è¿‡é™åˆ¶"),$.Log.cache({Compose_NoGuide_Text_AttachmentUploadFlow:1})):o=c.t("é™„ä»¶å¤§å°æˆ–æµé‡è¶…è¿‡é™åˆ¶"),e&&e.cloud&&(o=c.t("è¶…è¿‡è¶…å¤§é™„ä»¶ç©ºé—´ä¸Šé™ï¼Œè¯·æ‚¨å…ˆåˆ é™¤å·²ä¸Šä¼ æ–‡ä»¶"));break;caset("æ­¤æ–‡ä»¶å­˜åœ¨ä¸è‰¯ä¿¡æ¯ï¼Œç¦æ­¢ä¸Šä¼ ");break;case"FA_SECURITY":o=c.t("æµè§ˆå™¨ä¿¡æ¯ä¸¢å¤±ï¼Œè¯·é‡æ–°ç™»å½•é‚®ç®±");break;case"WX_DATA_ERROR":o=c.t("æµè§ˆå™¨é”™è¯¯":case"AS_HTTP":o=0===i?c.t("æœåŠ¡å™¨è¿æ¥é”™è¯¯"):c.t("æœåŠ¡å™¨")+i+c.t("é”™è¯¯"),o+=r;break;case"AS_ERROR":if(-1!=i.indexOf("Error #"))try{o="2038"==(i=(i=i.split("#")[1]).split(":")[0])?c.t("æ–‡ä»¶å¯èƒ½è¢«å…¶ä»–ç¨‹åºå ç”¨"):"2049"==i?c.t("æœåŠ¡å™¨å“åº”é”™è¯¯"):"2032"==i?c.t("ç½‘ç»œé”™è¯¯"):c.t("é”™è¯¯ç ")+i,o+=r}catch(e){}break;case"TIMEOUT":o=c.t("ä¸Šä¼ è¶…æ—¶")+r,n.prompt({speed:!0});break;default:o=c.t("ä¸Šä¼ å¤±è´¥ï¼Œé”™è¯¯ç ")+t+r}$.Array.has(["JS_HTTP","AS_HTTP","AS_ERROR","WX_DATA_ERROR","UX_UNKNOWN","TIMEOUT","JS_EVAL","NS_415","MD_RESUME"],t)&&(e?(e.err=o,e.errCode=t,e.errReason=i,n.setLock(e,!1),e.retry<g.UPLOAD_RETRY_MAX?(s=!0,e.retry++):e.retry===g.UPLOAD_RETRY_MAX?n.fileSize()<20971520&&(n.data.set({status:"useWmsvr",value:!0}),s=!0,e.retry++):s=!0):$.Msgbox.show({icon:"err",title:o})),!s&&n.setState(e,"error",o);try{var l=encodeURIComponent(e.name),d={code:t,reason:i,upxmailUrl:e.upxmailUrl,type:a,size:e.size,retry:e.retry,agent:e.type,name:l,fuuid:e.__uuid__};m.cache({compose_attach_error:d})}catch(e){}return s||n.cancelAutoSend(c.t("é™„ä»¶ä¸Šä¼ å¤±è´¥ï¼Œå·²ä¸ºä½ å–æ¶ˆäº†è‡ªåŠ¨å‘é€")),s},showOverflowDialog:function(e){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(t){t.default.showUploadOverflowDialog((function(){e&&e()}))})))},isOverflow:function(e){var t=e.errCode,i=e.errReason;return("FA_OVERFLOW"===t||"FA_UPLOAD_SIZE_EXCEEDED"===t)&&"pref_flow_limit"===i},netCheckSet:function(e){var t=this,i=t.base,a=g.sliceTime;i.addTimer("netCheck",(function(){t.netCheckFire(e)}),a)},netCheckFire:function(e){var t=this;if("upload"==e.state&&e.useSplit){if(0===e.offset||e.offset==e.lastOffset)return e.cloud||t.set({status:"validServer",value:!0}),void(t.error(e,"TIMEOUT")?t.fileRetry(e,{code:"TIMEOUT"}):t.resum(e));e.lastOffset=e.offset,t.netCheckSet(e)}},netCheckClear:function(){this.base.clearTimer("netCheck")},cancelAutoSend:function(e){var t=this.base,i=this.data;i.sequence.uploadResult&&(delete i.sequence.uploadResult,e?(t.tips(e),window.setTimeout((function(){t.tips("")}),5e3)):t.tips(""))},moveGet:function(){var e=[],t=this.fileGet({state:"success",inlined:!1,media:!1,url:""});return $.Array.each(t,(function(t,i){i.sid&&e.push(i)})),e},movePrepare:function(e){var t=this;t.base.setSequence("attachMove",(function(){var i=t.moveGet();i.length&&t.moveCloud(i,e)}))},moveCloud:function(e,t);$.Array.each(e,(function(e,t){o.push(t.sid),r+=t.size})),$.Ajax.jsonp(i.getUploadProxy({type:"script",move:!0,aid:o,size:t}),(function(e){a.tips(""),n.set({status:"uploadParam",value:null}),i.moveComplete(e)})),n.set({status:"uploadParam",value:{action:"move",size:t,xsize:r}}),a.tips(c.t("æ­£åœ¨ç§»åŠ¨é™„ä»¶..."))},moveComplete:function(e){if(e.code==p)(i=e.move)&&i.length&&this.moveReplace(i);else{var t="";t="FA_OVERFLOW"===e.code?c.t("è¶…å¤§é™„ä»¶å®¹é‡è¶…è¿‡")+$.Number.convert($S("cloud").capacity)+c.t("çš„é™åˆ¶ï¼"):c.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œé”™è¯¯ç ")+e.code,$.Msgbox.show({icon:"err",title:t});var i,a="";if((i=e.move)&&i.length)try{a=$.Array.map(i,(function(e,t){r("|")}catch(e){}try{$.Log.cache({compose_attach_movefail:{code:e.code,fileInfos:a}})}catch(e){}}},moveReplace:function(e){var t=this,i=t.module.base,a=[];$.Array.each(e,(function(e,t){a.push(t.attachmentId)})),t.action.deleteAttach({sid:a,callback:function(a){a.code==p&&($.Array.each(e,(function(e,i){var a=t.fileGet({sid:i.attachmentId})[0];a&&(a.sid="",t.cloudConvert(a,i))})),i.runSequence("attachMoveComplete"))}})},moveSize:function(){this.base;var==t.action&&t.xsize>0&&(e=t.xsize),e},cloudTrigger:function(e){var t=this;if(1===arguments.length&&"boolean"==typeof e&&$S("cloud")&&(t.set({status:"cloudTrigger",value:e}),t.uploadHostSmartSelect(),!1===e)){var i=t.sourceGet("tips");i.cloud&&i.cloud.remove()}return!!t.cloudStatus()&&t.get({status:"cloudTrigger"})},cloudStatus:function(){var e=g.upxmailConfig.fs;return!!($S("cloud")&&e&&e.length)},cloudRename:function(e){var t=e.ui;e.nameExist&&t&&(t.name.html($.String.escapeHTML(e.name)),t.tips.html(c.t("ä½ å·²ä¸Šä¼ è¿‡åŒåæ–‡ä»¶ï¼Œæœ¬æ–‡ä»¶å·²è‡ªåŠ¨æ”¹åä»¥é¿å…è¦†ç›–æ—§æ–‡ä»¶")))},cloudManage:function(){Promise.resolve().then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry("bj_center")})))},cloudConvert:function(e,t){var i=this;if(l.isArray(e))$.Array.each(e,(function(e,t){i.cloudConvert(t)}));else{"object"!=s(e.link)||t||(t=e.link);var a={type:"bigattach",url:$S("cloud").displayUrl+t.url,name:t.fileName,id:t.id,size:t.existlen,time:t.expireTime};t.preview&&(a.preview=$S("cloud").previewUrl+t.url),e.type="link";var n="";a.id&&-1!=a.id&&(n=[a.type,a.id].join(":")),e.eid=n,e.url=a.url,e.link=a,a.size&&(e.size=e.bytesLoaded=a.size),i.setState(e,"link")}},cloudAutoTips:function(){var e=this,t=e.module,i=(e.base,e.data);if("0"==f.get({field:"ntes_letter",flag:"autoSendTips"})){var a=i.get({component:"toolbar"}).find("button")[0];if(a){var n=i.get({component:"autoSendTips"});n?n.show():((n=new $.Layer({icon:{type:"info",size:"m"},width:"230px",items:[{html:"<span>"+c.t("é™„ä»¶æ­£åœ¨ä¸Šä¼ ï¼Œç‚¹å‡»å‘é€æŒ‰é’®ï¼Œå³å¯åœ¨")+"<br/>"+c.t("ä¸Šä¼ å®Œæˆåè‡ªåŠ¨å‘é€ã€‚ ")+"</span>"},{xtype:"link",text:c.t("ä¸å†æç¤º"),cls:"nui-txt-link",click:function(){f.set({field:"ntes_letter",flag:"autoSendTips",value:"1"}),this.ownerCt.destroy()}}],params:"hasArr arrUp hasClose",doNotHide:!0,renderTo:t.container})).pointTo(a.getEl(),$.fly(t.container)),i.set({component:"autoSendTips",value:n}))}}},cloudIsProxyAllFail:function(){},cloudHostSwitch:function(){$S("product")},uploadHostSmartSelect:function(){var e=this.cloudTrigger(),t=g.upxmailConfig,i=e?t.fs:t.normal;try{$.Log.cache({uploadHostSmartSelect:{cloud:e,hostList:$.Array.map(i,(function(e,t){return t.split(".")[0]}))}})}catch(e){console.log("uploadHostSmartSelect")}this.uploadHostList=i.slice()},uploadHostInit:function(){var e=this,t=$S("product"),i=g.upxmailConfig.local.normal[t],a=g.upxmailConfig.local.fs[t];g.upxmailConfig.normal=i,g.upxmailConfig.fs=a,e.uploadHostSmartSelect(),e.uploadHostFetch((function(t){if(t&&t&&200===t.code){var n=t.result&&t.result.list;if(n&&n.length){var o=[],r=[];$.Array.each(n,(function(e,t){"fs"===t.type?r=t.nodes:"normal"===t.type&&(o=t.nodes)})),o&&o.length&&(g.upxmailConfig.normal=e.uploadHostMerge(o,i)),r&&r.length&&(g.upxmailConfig.fs=e.uploadHostMerge(r,a)),e.uploadHostSmartSelect()}}}))},uploadHostMerge:function(e,t){var i=[];return $.Array.each(t,(function(t,a){$.Array.has(e,a)||i.push(a)})),[].concat(e).concat(i)},uploadHostFetch:function(e){var t=$.Uri.getUrl("compose_attach_upxlocate",!0);$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:"get",url:$.String.uriAddParam(t,"product=webmail&uid="+encodeURIComponent($S("uid"))),call:function(t){if(t.responseText){var i=null;try{i=JSON.parse(t.responseText)}catch(e){$.Log.cache({d_api_json_error:t.responseText})}e(i)}}})},uploadHostShuffle:function(e){return e&&e.length,e},uploadHostSkip:function(){var e=this.uploadHostList;e&&e.length&&e.shift()},msg:function(e){var t={module:this.module,attach:this,type:e};Promise.resolve().then(i.bind(i,52877)).then($.Function.bind((function(i){(new(0,i.default)).entry(t),m.cache({cl_attachmsg:""+e},$.EMPTYFUNC)})))},dropboxMsg:function(){var e={module:this.module,attach:this};Promise.resolve().then(i.bind(i,20422)).then($.Function.bind((function(t){(new(0,t.default)).entry(e),m.cache({cl_attachmsg:""+sType},$.EMPTYFUNC)}))),(new DropboxAttach).entry(e)},bigMsg:function(){},netfolderAdd:function(e){var t=this;if(e&&e.length){var i=[];$.Array.each(e,(function(e,a){var n=a.name;n=n.split("&")[0];var o=t.fileGet({type:"storage",size:a.size});$.Array.each(o,(function(e,t){if(t.url&&0===t.url.indexOf(n))return a=null,$.BREAK})),a&&i.push(a)})),i.length&&t.action.syncAttach({attachments:i,callback:function(e){if(e.code==p){var a=[],n=e.var.attachments;$.Array.each(n,(function(e,t){$.Array.each(i,(function(e,i){t.name==i.name&&a.push(t)}))})),t.storageAdd(a)}}})}},internalAdd:function(e){var t=this;e&&e.length&&t.action.syncAttach({attachments:e,callback:function(i){if(i.code==p){var a=[],n=i.var.attachments;$.Array.each(e,(function(e,t){$.Array.each(n,(function(e,i){if("internal"==i.type&&!i.deleted&&i.name==t.name){var n=i._mid,o=t._mid;-1!=n.indexOf(":")&&(n=n.split(":")[1]),-1!=o.indexOf(":")&&(o=o.split(":")[1]);var r=Math.abs(i.size-t.size);if(n==o&&r<100)return a.push(i),$.BREAK}}))})),t.storageAdd(a)}}})},ynoteAdd:function(e){if(e&&e.length){var t=[];$.Array.each(e,(function(e,i){i.code==p&&t.push(i.var)})),this.storageAdd(t)}},avMailAdd:function(e){var t=this,i=t.editor;$.Array.each(e,(function(e,a){t.storageAdd(a);var n=a.fileName,o=a.attachmentId,r=a.mediaType,s=a.totalTime,l="";"video"==r?(m.cache({cl_video:1},$.EMPTYFUNC),l='<div><img data-media="'+o+'" border="0" src="https://mimg.127.net/p/js5/lib/img/ico_video.gif" style="vertical-align: middle;"/><player id="cmd:voice" param="'+n+'" media="video"></player><span style="padding : 3px 5px">'+s+'</span><span style="line-height: 1.7; color: rgb(128, 128, 128);">'+c.t("(å¦‚æœæ‚¨çœ‹ä¸åˆ°è§†é¢‘ï¼Œè¯·ä¸‹è½½é™„ä»¶)")+"</span></div>"):"audio"==r&&(m.cache({cl_audio:1},$.EMPTYFUNC),l='<div><img data-media="'+o+'"  border="0" src="https://mimg.127.net/p/js5/lib/img/ico_audio.gif" style="vertical-align: middle;"/><player id="cmd:voice" param="'+n+'" media="audio"></player><span style="padding : 3px 5px">'+s+'</span><span style="line-height: 1.7; color: rgb(128, 128, 128);">'+c.t("(å¦‚æœæ‚¨çœ‹ä¸åˆ°éŸ³é¢‘ï¼Œè¯·ä¸‹è½½é™„ä»¶)")+"</span></div>"),l&&(l="<div>"+c.t("è¿™ä¸ªæ˜¯æˆ‘åˆšæ‰å½•åˆ¶çš„å“‡ï¼Œä½ çœ‹çœ‹å‘€ï½ï½")+"</div>"+l+"<br/><div>&nbsp;&nbsp;</div>",i.insert({html:l}))}))},netfolderStructure:function(e){var t={type:"netfolder",id:-1};return t._mid=e.mid,t.name=e.name,t.contentType=e.type,"string"==typeof e.size&&(e.size=parseInt(e.size,10)),t.size=e.size,t},netfolderCallBack:function(e){var t=this,i=t.base;if(e&&e.length){var a=[];$.Array.each(e,(function(e,i){i&&i.checked&&0===t.fileGet({type:"storage",mid:i.mid}).length&&a.push(t.netfolderStructure(i))})),a.length&&t.action.syncAttach({attachments:a,callback:function(e){if(e.code==p){var i=[],n=e.var.attachments;$.Array.each(n,(function(e,t){$.Array.each(a,(function(e,a){t._mid==a._mid&&i.push(t)}))})),t.storageAdd(i)}}})}i.setPage("compose")},linkAdd:function(e){var t=this;if(l.isArray(e))$.Array.each(l.toArray(e),(function(e,i){t.linkAdd(i)}));else{var i="";if(e.id&&-1!=e.id){if(i=[e.type,e.id].join(":"),t.fileGet({type:"link",eid:i}).length)return}else if(t.fileGet({type:"link",url:e.url}).length)return;var a=t.fileCreate({type:"link",name:e.name,eid:i,cloud:e.cloud});a.url=e.url,a.link=e,e.size&&(a.size=a.bytesLoaded=e.size),t.add(a)}},linkParse:function(){var e=this,t=e.data.get({status:"fromEntry"}),i=!1,a=!1;if("draft"==t||"timeset"==t)i=!0;else if("compose"==t)return;for(var n,o=[];n=e.editor.get({id:"divEditorAttachLink"});){var r=n.dom;i&&(i=!1,$.Array.each(l.toArray(r.childNodes),(function(e,t){try{var i=t.innerHTML,n=JSON.parse(i);"bigattach"==n.type&&(a=!0),n.cloud=!0,o.push(n)}catch(e){}}))),n.remove()}a&&e.cloudTrigger(!0),e.linkAdd(o)},linkHtml:function(e){var t=this,i="",a=t.fileGet({type:"link"});if(a.length){var n=e.action,o=e.subject;o=encodeURIComponent(o);var r=!0;"deliver"!=n&&"schedule"!=n||(r=!1);var s=[],d={};$.Array.each(a,(function(e,i){var a=i.link;if(r)s[s.length]="<xmp>"+JSON.stringify(a)+"</xmp>";else{var n=i.url,l=i.name,u=a.type,m=d[,"&#39;")).replace(/\"/g,"&#34;"),m||(m=d[u]=[]);var p="",f=t.linkIcon(i);if("bigattach"==u){var h=a.preview||"";console.log(i);var g=new Date(a.time),v=$.Date.format(g,c.t("yyyyå¹´Mæœˆdæ—¥ H:mm"));n=$.String.uriAddParam(n,"title="+o),h&&(h=$.String.uriAddParam(h,"title="+o)),p='<div style="clear:both;height:36px;padding:6px 4px"><div style="float:left;width:36px"><a href="'+n+'"><img border="0"<div style="padding:0px;font-size:12px;line-height:14px"><a href="'+n+'" download="'+n+'" preview="'+h+'" fileid="'+a.id+'" filename="'+l+'" filesize="'+a.size+'" expiretime="'+a.time+'" target="_blank" style="color:#000;text-decoration:none">'+l+'</a><span style="color:#bbb"> ('+$.Number.convert(a.size)+", "+v+c.t(" åˆ°æœŸ)")+'</span></div><div style="padding:4px 0px;font-size:12px;line-height:14px">'+(h?'<a href="'+h+'">'+c.t("åœ¨çº¿é¢„è§ˆ")+"</a> | ":"")+'<a href="'+n+'">'+c.t("ä¸‹è½½")+"</a></div></div></div>"}else"netfolder"==u?p='<div style="clear:both;height:36px;padding:6px 4px"><div style="float:left;width:36px"><a href="'+n+'"><img border="0" src="'+f+'" /></a></div><div><div style="padding:0px;font-size:12px;line-height:14px"><a href="'+n+'" download="'+n+'" fileid="'+a.id+'" filename="'+l+'" filesize="'+a.size+'" target="_blank" style="color:#000;text-decoration:none">'+l+'</a><span style="color:#bbb"> ('+$.Number.convert(a.size)+')</span></div><div style="padding:4px 0px;font-size:12px;line-height:14px"><a href="'+n+'">'+c.t("ä¸‹è½½")+"</a></div></div></div>":"dropbox"==u&&(p='<div stylex"><div style="float:left;width:36px"><a href="'+n+'"><img border="0" src="'+f+'" /></a></div><div><div style="padding:0px;font-size:12px;line-height:14px"><a href="'+n+'" download="'+n+'" fileid="'+a._mid+'" filename="'+l+'" filesize="'+a.size+'" target="_blank" style="color:#000;text-decoration:none">'+l+'</a><span style="color:#bbb"> ('+$.Number.convert(a.size)+')</span></div><div style="padding:4px 0px;font-size:12px;line-height:14px"><a href="'+n+'">'+c.t("ä¸‹è½½")+"</a></div></div></div>");m.push(p)}})),r?i='<div id="divEditorAttachLink" style="display:none">'+s.join("")+"</div>":l.each(d,(function(e,t){var a,n;"netfolder"==e?(a="divNeteaseNetfolder",n=c.t("æ–‡ä»¶")):"bigattach"==e?(a="divNeteaseBigAttach",n=c.t("è¶…å¤§é™„ä»¶")):"dropbox"==e&&(a="divNeteaseDropbox",n=c.t("Dropboxæ–‡ä»¶")),i+='<div id="'+a+'" style="clear:both;margin-top:10px;margin-bottom:15px;background:#DEE8F2;padding:4px;font-family:verdana,Arial,Helvetica,sans-serif"><div style="font-size:14px;padding:4px 8px 8px 8px;line-height:16px"><b>'+c.t("ä»ç½‘æ˜“")+$S("product")+c.t("é‚®ç®±å‘æ¥çš„")+n+"</b>"+($.Ext.composeDownalodLink?'<span style="width:6px;display:inline-block;"><img style="width:1px;height:1px" src="'+g.mailmasterDownloadBtnShowUrl+'" ></span><a class="bigattach-mailmaster-download" style="background-color:#3370FF;font-size: 12px;padding:5px 8px;border-radius: 4px;color:#fff;text-decoration: none;display:inline-block;line-height: 12px;" href="'+g.mailmasterDownloadLink+'">æ¨èå®¢æˆ·ç«¯æé€Ÿä¸‹è½½</a>':"")+'</div><div style="background:#fff;padding:4px">'+t.join("")+"</div></div>"}))}return i},linkIcon:function(e){var t=[h.getUrl("compose_attach_icon",!0),"1",".gif"],i=e.ext;return i&&n.Z.icoFileIndex[i]&&(t[1]=n.Z.icoFileIndex[i]),t.join("")},linkAllRenew:function(e,t){var i=this.module,a=i.editor,n=i.data,o={},r=this.fileGet({type:"link"});$.Array.each(r,(function(e,t){o[t.url]={href:t.url,fileName:t.name}}));var s=$.Object.extend({},o),c=$.Object.keys(s);if(0!==c.length){var l={};$.Array.each(c,(function(e,t){l[t]=""})),$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:{traceKey:e,linkUrls:c},rnd:!0,url:$.Uri.getUrl("mailTrackingLinkRenew",!1),head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var i=JSON.parse(e.responseText);200===i.code&&($.Array.each(i.data.list,(function(e,t){l[t.originUrl]=t.newUrl,s[t.originUrl]&&(s[t.originUrl].href=t.newUrl)})),$.Array.each(r,(function(e,t){t.url=l[t.url]})),a.updateCloudLinks(l),n.set({status:"renewedCloudLinks",value:s}),t&&t())}catch(e){}}})}else t()},stationeryHas:function(){var e=!1;return this.fileGet({type:"storage",name:c.t("ä¿¡çº¸.jpg")}).length>=1&&(e=!0),e},stationeryGet:function(){var e=null,t=this.get({status:"stationeryUrl"});return t&&(e=this.fileGet({type:"storage",url:t})[0]),e},stationeryClear:function(e){var t=this,i=t.stationeryGet();i&&t.remove(i,(function(){t.set({status:"stationeryUrl",value:""}),e&&e()}))},stationerySync:function(e,t){var i=this;if(i.stationeryGet())i.stationeryClear((function(){i.stationerySync(e,t)}));else{var a=i.stationeryStruct(e);i.set({status:"stationeryUrl",value:a.name}),i.action.syncAttach({attachments:[a],callback:function(e){if(e.code==p){var n=[];if($.Array.each(e.var.attachments,(function(e,t){t.name==a.name&&(t.deleted||n.push(t))})),n.length>=1){var o=n.pop();return o.inlined="true",i.storageAdd(o),t(o.name)}}return t(null)}})}},stationeryStruct:function(e){var t={id:-1,type:"url",mode:"copy"};return t.name=e.imageUrl,t.displayName=c.t("ä¿¡çº¸.jpg"),t.contentType=e.contentType,t.size=e.size,t},photoOpen:function(){this.base.setPage("photo")},photoCallBack:function(e){this.base.setPage("compose");var t=this.editor;if($.String.trim(e)){var i=e.split(";"),a="";$.Array.each(i,(function(e,t){var i=t.split("+");a+='<a href="'+i[1]+'" target="_blank"><img border="0" src="'+i[0]+'"></a><br>'})),t.insert({html:a})}},photoGetUrl:function(){var e=this,t=h.getUrl("compose_photo",!0),i=h.getUrl("compose_attach",!0),a=e.base.getCallName((function(){e.photoCallBack.apply(e,arguments)}),!0);return t+"&backurl="+encodeURIComponent(i+="&call=window.parent."+a)},cardHas:function(){var e=!1;return this.fileGet({type:"storage",name:c.t("åç‰‡.vcf")}).length>=1&&(e=!0),e},cardGet:function(){var e=null,t=this.get({status:"cardUrl"});return t&&(e=this.fileGet({type:"storage",url:t})[0]),e},cardSync:function(e){var t=this,i=t.cardGet();if(i)t.remove(i,(function(){t.set({status:"cardUrl",value:""}),t.cardSync(e)}));else{var a=t.cardStructure(e);t.set({status:"cardUrl",value:a.name}),t.action.syncAttach({attachments:[a],callback:function(e){if(e.code==p){var i=[];$.Array.each(e.var.attachments,(function(e,t){t.name==a.name&&(t.deleted||i.push(t))})),i.length>=1&&t.storageAdd(i.pop())}}})}},cardStructure:function(e){var t={id:-1,type:"url",mode:"copy"};return t.name=e.ecardVCFUrl,t.displayName=c.t("åç‰‡.vcf"),t.contentType="text/x-vCard",t.size={var t=this;switch(e.action){case"downloaded":t.mobileShowDownload();break;case"loggedin":t.mobileShowUpload();break;case"upload":4==e.status&&t.mobileClose:function(e){this.info.get({tid:!0})&&this.mobileCancel()},mobileInit:function(e){this.mobileUrl=e?"http://config.mail.163.com:8080":h.getUrl("compose_attach_mobile",!0),this.mobileCheckInst()},mobileCheckInst:function(){var e=this;if(g.appInstall)e.mobileShowUpload();else{var t={url:"/msgdispatcher/prestage/web/checkinst.do",callback:function(t){200==t.code&&("on"==t.data.inst?(e.mobileShowUpload(),g.appInstall=!0):"off"==t.data.inst&&e.mobileShowORCode())}};e.mobileRequest(t)}},mobileCheckStatus:function(){var e=this,t={url:"/msgdispatcher/prestage/web/checkstatus.do",callback:function(t){if(200==t.code){var i=t.data.status;"-1"==i||"0"==i||"1"==i||"2"==i&&e.mobileShowUpload()}}};e.mobileRequest(t)},mobileShowORCode:function(){var e=this,t=e.module,i=e.mobileUrl+"/msgdispatcher/prestage/web/getqrcode.do",a=$.String.uriAddParam(i,"sid="+$S("sid"))+"&uid="+$S("orgUid"),n=$.SenderList.getMobile();n&&(a+="&alias="+n.address),a+="&uidinuse="+$S("uid"),a+="&host="+$S("host"),a+="&cid="+e.info.get({cid:!0});var o=h.getUrl("compose_attach_mobile_mailmaster",!0),r=h.getUrl("compose_attach_mobile_help1",!0),s='<div id="'+t.createId("dvAttachMobile")+'" class="APP-editor-insertPic-mobile"><div style="text-align:center;width:100%;height:auto;padding-bottom:10px"><img src="'+a+'"/></div><div class="APP-editor-insertPic-mobile-intro">'+c.t("ä»æ‰‹æœºä¸Šä¼ å›¾ç‰‡ï¼Œæ­¤åŠŸèƒ½éœ€è¦å…ˆå®‰è£…å¹¶ç™»å½•ç½‘æ˜“é‚®ç®·å…ˆæ‰«æäºŒç»´ç ä¸‹è½½å®‰è£…ã€‚")+'</div><div class="APP-editor-insertPic-mobile-link"><a href="'+o+'" target="_blank" class="nui-txt-link">'+c.t("æˆ–è€…æ‰‹åŠ¨ä¸‹è½½é‚®ç®±å¤§å¸ˆ ")+'</a> &nbsp;<a href="'+r+'" target="_blank" class="nui-txt-link">'+c.t("å¸®åŠ©")+"</a></div></div>";$.Msgbox.show({header:c.t("ä»æ‰‹æœºä¸Šä¼ å›¾ç‰‡"),content:s,extcls:"APP-editor-insertPic",contentType:"normal",noFooter:!0,autoFocus:!1,close:function(){e.mobileCheckStatus()}})},mobileShowDownload:function(){this.module;var e=this.data,t=h.getUrl("compose_attach_mobile_mailmaster",!0),i='<div style="text-align:center;width:100%;height:auto;padding-bottom:10px"><img src="https://mimg.127.net/xm/webmail/img/ecode_done.jpg"/></div><div class="APP-editor-insertPic-mobile-intro">'+c.t("æ‰«ææˆåŠŸï¼å»ºè®®æ‚¨é©¬ä¸Šä¸‹è½½é‚®ç®±å¤§å¸ˆå¹¶ç™»å½•ï¼Œ")+"<br/>"+c.t("æ‰“å¼€æ‰‹æœºä¸­æ¥æ”¶åˆ°çš„æ¶ˆæ¯æé†’ï¼Œé€‰æ‹©è¦ä¸Šä¼ çš„å›¾ç‰‡ã€‚")+'</div><div class="APP-editor-insertPic-mobile-link"><a href="'+t+'" target="_blank" class="nui-txt-link">'+c.t("æˆ–è€…æ‰‹åŠ¨ä¸‹è½½é‚®ç®±å¤§å¸ˆ")+"</a></div>";e.get({moduleId:"dvAttachMobile"}).h=h.getUrl("compose_attach_mobile_help2",!0),a='<div id="'+t.createId("dvAttachMobile")+'" class="APP-editor-insertPic-mobile"><div style="text-align:center;width:100%;height:auto;padding-bottom:40px;padding-top:20px;"><img src="//mimg.127.net/xm/webmail/img/img-upload-minifed.png"/></div><div style="color:#81858a;">'+c.t("ç‚¹å‡»é‚®ç®±å¤§å¸ˆAppæ¨é€çš„æ‰‹æœºæ¶ˆæ¯é€šçŸ¥")+" >>  "+c.t("é€‰æ‹©å›¾ç‰‡ä¸Šä¼ ")+" >>  "+c.t("ä¸Šä¼ æˆåŠŸ")+'<br/></div><div class="nui-fClear" style="color:#81858a;padding:20px 0 20px 6px; text-align:left;"><div style="float:left;"><p>æ²¡æœ‰æ”¶åˆ°æ‰‹æœºæ¶ˆæ¯é€šçŸ¥ï¼Ÿ</p><p>æ­¥éª¤1ï¼šæ‰‹åŠ¨æ‰“å¼€Appï¼Œç„¶å<a id="'+t.createId("mobileRetry")+'" href="javascript:void(0)" class="nui-txt-link">'+c.t("ç‚¹æ­¤é‡è¯•")+'</a></p><p>æ­¥éª¤2ï¼šç¡®è®¤Appä¸ç½‘é¡µç™»å½•äº†ç›¸åŒçš„é‚®ç®±è´¦å·</p></div><div style="float:right"><img style="height:60px;width:60px;" src="//mimg.127.net/xm/webmail/img/yxds-qrcode-minifed.png"></div></div><div style="text-align:center"><a href="'+i+'" class="nui-txt-link" tav></div>",n=null;function o(){n=setTimeout((function(){e.mobileUpdateAttachInfo(),o()}),1e4)}$.Msgbox.show({width:"450px",header:c.t("ä»æ‰‹æœºä¸Šä¼ å›¾ç‰‡"),content:a,extcls:"APP-editor-insertPic",contentType:"normal",noFooter:!0,autoFocus:!1,close:function(){return window.clearTimeout(n),e.mobileClose(this)},listeners:{afterRender:function(){e.mobileStart(),$("#"+t.createId("mobileRetry")).listen("click",(function(){e.mobileStart()})),o()}}})},mobileStart:function(){var e=this,t={func:"start",url:"/msgdispatcher/upload/web/startupload.do",param:{remainspace:1024*$S("attachSize")*1024-e.fileSize()},callback:function(t){200==t.code&&e.info.set({tid:t.data.taskid})}};e.mobileRequest(t)},mobileUpload:function(e){this.module;var t=this.data,i=(e.uploadedaid,e.nextupaid),a=e.overallmap;if(-1!=i){var o=a[i];if(o){var r=$.String.escapeHTML(o.name),s=n.Z.g,l='<div class="APP-editor-insertPic-mobile-fileIco">'+new $.Icon({type:"file75",subtype:s}).html()+'</div><div class="APP-editor-insertPic-mobile-fileName">'+r+'</div><div class="APP-editor-insertPic-mobile-loading"></div><div class="APP-editor-insertPic-mobile-intro">'+c.t("æ­£åœ¨ä»æ‰‹æœºä¸Šä¼ å›¾ç‰‡ä¸­ï¼Œè¯·ç¨å€™")+"</div>";t.get({moduleId:"dvAttachMobile"}).html(l)}}},mobileCancel:function(){var e=this;if(e.info.get({tid:!0})){var t={func:"cancel",url:"/msgdispatcher/upload/web/cancel.do",param:{taskid:e.info.get({tid:!0})},callback:function(t){200==t.code&&(t.data,e.mobileUpdateAttachInfo(),e.info.set({tid:""}))}};e.mobileRequest(t),e.set({status:"validServer",value:!0})}},mobileFinish:function(e){var t=this,i=t.action,a=e.uploaded;e.remain,e.failed,i.getInfo({callback:function(e){var i=[],n=e.var.attachments;$.Array.each(n,(function(e,t){$.Array.each(a,(function(e,a){t.id!==a&&i.push(t)}))})),t.storageAdd(i),t.info.set({tid:""}),$.Msgbox.msgbox.close()}})},mobileRequest:function(e){var t=this.mobileUrl+e.url,i=$.String.uriAddParam(t,"sid="+$S("sid"))+"&uid="+$S("orgUid"),a=$.SenderList.getMobile();a&&(i+="&alias="+a.address),i+="&uidinuse="+$S("uid"),i+="&host="+$S("host"),i+="&cid="+this.info.get({cid:!0}),e.param&&l.each(e.param,(function(e,t){var a="&"+[e,t].join("=");i+=a})),$.Ajax.jsonp(i,e.callback)},mobileUpdateAttachInfo:function(){var e=this;e.action.getInfo({callback:function(t){var i=[],a=t.var.attachments;$.Array.each(a,(ftorageAdd(i)}})},getStorageDetailHtml:function(){return $.Link.html({text:c.t("æŸ¥çœ‹å­˜å‚¨ç©ºé—´"),cls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"capacityPage"})}))),$.Log.cache({Compose_LargeAttachmentLimit_StorageDetail_click:1}),$.Msgbox.msgbox&&$.Msgbox.msgbox.close()}})},getAssistantHtml:function(e){return $.Ajax.request({requestType:$.Ajax.SCRIPT,url:"https://qiyukf.com/script/53e2302d70bda67dow.ysf.config($.Support.getQiyukfConfig())}}),$.Link.html({text:c.t("åœ¨çº¿ç®¡å®¶"),cls:"nui-txt-link",click:function(){window.ysf&&window.ysf.open({templateId:6615243});var t={};t[e]=1,$.Log.cache(t)}})},traceCheck:function(){var e=this,t=e.module.mailtrace;t.onReady((function(){t.attachIsEnable()&&e.fileGet().length&&e.prompt({trace:!0})}))}};l.extend(g,v),l.extend(g.prototype,b),t.Z=g},39003:function(e,t,i){i(92274),i(75654),i(48868),i(63045),i(81874),i(54861),i(55737),i(87553),i(68233),i(42295),i(34994),i(803),i(66403),i(26340),i(13484),i(19975),i(80153),i(32021),i(79150),i(15761),i(20869),i(63518),i(52963),i(49750),i(66251),i(37092),i(37885),i(36809),i(65132);var a=i(10487),n=i(17690),o=i(27018),r=i(4982),s=i(5165),c=i(64560),l=i(34691),d=i(62193),u=i(81229),m=i(72957),p=i(26406),f=i(89308);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}var g=new m.c1("module.compose.ComposeBase");function v(e){this._publisher=e,this._subscriber={}}v.of=function(){vaurn $.Array.each(e,(function(e,i){t.next(i)})),t.complete(),{unsubscribe:function(){}}}))},v.fromJs6Event=function(e){return new v((function(t){var i=function(){t.next.apply(t,arguments)};return $.Listener.listen(e,i),{unsubscribe:function(){$.Listener.unlisten(e,i)}}}))},v.prototype.subscribe=function(e){var t={id:"rxjs_ob_"+(new Date).getTime().toString(),next:function(e){console.log(e)},error:function(e){console.log(e)},complete:function(){console.log("complete")}};"function"==typeof e?t.next=e:e&&(t.next=e.next||t.next,t.error=e.error||t.error,t.complete=e.complete||t.complete);var i=this._publisher(t);this._subscriber[t.id]=i;var a=this,n=i.unsubscribe;return i.unsubscribe=function(){n(),a._subscriber[t.id]=null},i},v.prototype.unsubscribeAll=function(){$.Object.each(this._subscriber,(function(e,t){t.unsubscribe()})),this._subscriber={}};var b=$.Object,y=$.Email,x=$.Ext,k=$.Log,S=$.S_OK,w=$.Ud,T=$.Uri;function C(){return{traceMailEnable$:v.fromJs6Event("compose:mailTraceToggle"),traceAttEnable$:v.fromJs6Event("compose:attachTraceToggle"),mailprotectChange$:null,onSubjectChange$:null,onComposeSendCheck$:null,beforeComposeSend$:null,afterComposeSendSuccess$:null}}var _=$.createClass($N("module.compose.ComposeBase")),I={Observable:v,observable$:C(),_onComposeReady:[],_onSubjectChange:[],_onComposeGuideRndCheck:[],_beforeComposeSend:[],_afterComposeSendSuccess:[],_onFileUpload:[],_onFileUploadSuccess:[],extensionInfo:{mailprotection:{name:"æœºå¯†æ¨¡å¼"},encrypt:{name:"é‚®ä»¶åŠ å¯†"},notary:{name:"å…¬æ­£é‚®"},receipt:{name:"å·²è¯»å›æ‰§"},schedule:{name:"å®šæ—¶å‘ä¿¡"},mailtrace:{name:"æœºå¯†æ¨¡å¼"}},extensioinConflict:{mailprotection:["encrypt","notary","schedule","receipt"]},initialize:function(e){_.superClass.initialize.call(this,e)},init:function(){this._events={},this._firedEvents={},this.composeTime=0,this.composeTimeStart(),_.superClass.init.call(this)},start:function(){var e=this,t=e.editor;e.element(),e.defined(),e.initUd(),t.create(),e.initObservable(),e.initSubscribeAndHandler(),e.initLifecycle(),e.module.scroll("main"),e.addTimer("delay",(function(){e.startDelay()}))},startDelay:function(){var e=this,t=(e.module,e.data),i=e.attach,a=e.editor;if(!0===t.geProcess(),e.focus(),e.autoSave(),e.addTimer("assistDelay",(function(){e.assist.dragInit(),e.assist.clipInit()}),300),t.set({status:"s.listenAuthInvalid(),e.marketingInit(),e.subjectKeywt.get({status:"fromEntry"})&&e.addTimer("atD})}),200),$.Ud.getProxy({field:["exten.mktToolSendNickname"],call:function(e){e["exten.mktToolSendNickname"]&&$(".iC2.nui-txt-link").css({display:"block"})}})},layoutAdjust:function(e){var t=this,i=t.module,a=t.data;if(e.timer)t.addTimer("layout",(function(){e.timer=!1,t.layoutAdjust(e)}),10);else{var n=a.layout;if(n&&n.baseHeight){var o=i.getModuleClass();o!=n.containerCls&&($(i.container).replaceClass(n.containerCls,o),n.containerCls=o);var r=!1;((0,m.$S)("clientHeight")!=n.baseHeight||e.force)&&(i.layoutInit(),r=!0),r&&t.editor.setSize({height:n.editorHeight+"px"}),e.attach&&t.attach.layout()}}},defined:function(){var e=this,t=e.module,i=e.data,a=e.event,n=e.form;"0"==w.get({fContacts"})&&($.SM.go({module:"address.AddressModule",noDragbar:!0,cacheModule:!0,cacheDom:!0,reset:!1,parent:t}),i.set({status:"showSide",value:!0})),"1"==w.get({field:"ntes_compose",flag:"separate_default"})&&"compose"==i.get({status:"fromEntry"})&&a.setSeparate({show:!0});var o=(0,m.$S)("attrs").user.ntes_htmlbar;"number"==typeof o&&2==o&&i.set({status:"showHtmlbar",value:!1}),"3"!=w.get({field:"ntes_compose",flag:"upload_mode"})&&i.set({status:"uploadMode",value:"super"}),"1"==w.get({field:"ntes_option",flag:"requirereceipt"})&&n.setCheckbox("receipt",!0)},element:function(){var e=this,t=e.module,i=e.data,a=e.form;$.Array.each(["to","subject","main","succ","toolbar","ext","notary","encrypt","schedule"],(function(e,t){i.set({moduleId:t,value:t})})),$.Array.each(["to","subject"],(function(e,t){a.addHoverEvent(t)})),t.attach.initElement()},initUd:function(){var e=this.data;$.Ud.getProxy({field:["product.vipMember","webmail.js.usedCloudFile","webmail.js.firstCloudFileSend","product.cafeteria.userGroup_collab_promotion_task","product.cafeteria.userGroup_collab_promotion_write"],call:function(t){var i=t["product.vipMember"],a=t["webmail.js.usedCloudFile"],n=t["webmail.js.firstCloudFileSend"],o=t["product.cafeteria.userGroup_collab_promotion_task"],r=t["product.cafeteria.userGroup_collab_promotion_write"];e.set({status:"usedCloudFile",value:a}),e.set({status:"firstCloudFileSend",value:n}),e.set({status:"vipMember",value:i}),e.set({status:"teamGreyUser",value:o||r}),$.Listener.fire("compose:vipMemberInited")}})},initObservable:function(){var e=this;e.observable$=C(),e.observable$.mailprotectChange$=e.fromComposeEventChange("compose:mailprotectChange"),e.observable$.onComposeSendCheck$=e.fromComposeEvent("compose:onSendCheck"),e.observable$.beforeComposeSend$=e.fromComposeEvent("compose:beforeSend"),e.observable$.afterComposeSendSuccess$=e.fromComposeEvent("compose:afterSendSuccess"),e.observable$.onSubjectChange$=e.fromComposeEvent("compose:subjectChange")},initLifecycle:function(){var e=this,t=e.module,i=e.data,a=e.names;function n(e,t){$.Array.each(e,(function(e,i){i(t)}))}function o(e,t){var i=0;!function a(n){if(!1!==n){var o=e[i];o&&(i++,o(t,a))}}(!0)}e._onComposeReady=[],e._onComposeGuideReady=[],e._onComposeSendCheck=[],e._beforeComposeSend=[],e._beforeComposeSend=[],e._onSubjectChange=[],$.Array.each(a,(function(i,a){var n=t[a];n&&n.onComposeReady&&e._onComposeReady.push(n.onComposeReady.bind(n)),n&&n.onComposeGuideReady&&e._onComposeGuideReady.push(n.onComposeGuideReady.bind(n)),n&&n.onComposeSendCheck&&e._onComposeSendCheck.push(n.onComposeSendCheck.bind(n)),n&&n.beforeComposeSend&&e._beforeComposeSend.push(n.beforeComposeSend.bind(n)),n&&n.afterComposeSendSuccess&&e._afterComposeSendSuccess.push(n.afterComposeSendSuccess.bind(n)),n&&n.onSubjectChange&&e._onSubjectChange.push(n.onSubjectChange.bind(n))}));var r=i.get({status:"fromEntry"});"compose"==r||""===r?(n(e._onComposeReady),o(e._onComposeGuideReady)):e.onContentLoaded((function(){n(e._onComposeReady),o(e._onComposeGuideReady)})),e.observable$.onComposeSendCheck$.subscribe((function(t){o(e._onComposeSendCheck,t)})),e.observable$.beforeComposeSend$.subscribe((function(t){n(e._beforeComposeSend,t)})),e.observable$.afterComposeSendSuccess$.subscribe((function(t){n(e._afterComposeSendSuccess)})),e.observable$.onSubjectChange$.subscribe((function(t){o(e._onSubjectChange,t.value)}))},initSubscribeAndHandler:function(){var e=this,t=e.module,i=t.attach,a=t.mailtrace,n=t.event;e.observable$.traceMailEnable$.subscribe((function(e){a.attachIsEnableInView()&&$.Listener.fire("compose:attachTraceToggle",e)})),e.observable$.traceAttEnable$.subscribe((function(e){if(e)i.traceCheck();else{i.prompt({remove:!0});var t=i.fileGet({type:"link"});t&&t.length&&i.prompt({cloud:!0})}})),e.observable$.mailprotectChange$.subscribe((function(i){var a=t.mailprotection;i.value?(n.extShow(),e.handleExtensionConflict("mailprotection",(function(){}),(function(){a.disable()}))):e.resetExtensionConflict("mailprotection")}))},releaseSubscriber:function(){$.Object.each(this.observable$,(function(e,t){t&&t.unsubscribeAll()}))},fillContent:function(e,t){var a=this,n=a.module,o=a.attach,r=a.data,s=a.editor,c=a.form,l=a.event,d=a.info,u=(e=e||d.get({obj:!0})).account;u&&c.setSender(u);var m=!1;"reply"==(b=r.get({status:"fromEntry"}))&&(m="2"==w.get({field:"ntes_option",flag:"sendershow"}));var p=e.to;p&&c.setContact(p,"to",m);var f=e.cc;f&&(c.setContact(f,"cc",m),f.length&&l.setCc({show:!0,separate:!0}));var h=e.bcc;h&&(c.setContact(h,"bcc",m),h.length&&l.setBcc({show:!0,separate:!0})),e.showOneRcpt&&l.setSeparate({show:!0});var g=e.subject;"string"==typeof g&&c.setSubject(g),1==e.priority&&c.setCheckbox("priority",!0),e.requestReadReceipt&&c.setCheckbox("receipt",!0);var v=e.scheduleDate;if(v&&(c.setCheckbox("schedule",!0),Promise.resolve().then(i.bind(i,16579)).then($.Function.bind((function(e){var t=new(0,e.default)(n);t.init(),n.schedule=t,setTimeout((function(){n.schedule.setWithTimeZoneFixed(v)}))})))),!t){var b,y=e.content||"",x="html";if("boolean"==typeof e.isHtml&&!e.isHtml)x="text","edit"!=(b=r.get({status:"fromEntry"}))&&"draft"!=b&&"timeset"!=b||c.setCheckbox("text",!0);s.setOriginal(y,x);var k=e.attachments;k&&(o.storageAdd(k,!0),o.traceCheck());var S=e.link;S?o.linkAdd(S):o.linkParse(),"number"==typeof e.card&&a.sign.fillData({card:e.card}),a.changeSync(),setTimeout((function(){a.trigger("ComposeContentLoaded")}),0)}},send:function(e){var t=this,i=t.module,a=t.attach,n=t.data,r=t.info,s=i.action,c=(t.form,t.mailtrace),l=t.mailprotection;if(n.get({status:"showScheduleInvitation"}),t.sendCheck(e)&&"success"!=n.get({status:"curPage"})){if(n.get({component:"autoSendTips"}))try{n.get({component:"autoSendTips"}).hide()}catch(e){}if(n.get({component:"attachLayer"}))try{n.get({component:"attachLayer"}).hide()}catch(e){}var d={},u={action:e.action},f=r.get({cid:!0});if(f&&(d.id=f),"verify"==e.action)d.verifyCode=e.code;else{var h=d.attrs=t.sendBuild(e);t.info.set({obj:h}),t.info.set({con:[].concat(h.to,h.cc,h.bcc)})}"deliver"==e.action||"schedule"==e.action||"verify"==e.action?d.returnInfo=!1:d.returnInfo=!0;var v=e.action;if("auto"==e.action||"force"==e.action?v="save":"verify"==e.action&&(v="deliver",n.get({status:"showSchedule"})&&(e.action=v="schedule")),d.action=v,t.attach.fileHas({type:"link"})&&(d.flagLinkAttached=!0),"deliver"==e.action&&0===(0,m.$S)("attrs").user.save_sent){var y=a.fileGet({context:!0});y&&y.length||(d.saveTextThreshold=n.saveTextThreshold)}if("deliver"==e.action&&1==(0,m.$S)("attrs").user.aftersend_saveaddr)try{$.Array.each(t.info.get({con:!0}),(function(e,t){var i=t.replace(/^.*<|>$/g,"").toLowerCase();if(!o.default.data.extDataMap.email[i])return d.autosaveRcptsMode="add",$.BREAK}))}catch(e){}if("schedule"==e.action&&"0"==w.get({field:"ntes_option",flag:"schedule_notify"})&&(d.notifyEML=!0),"deliver"==e.action&&n.get({status:"showEncrypt"})&&(d.encryptPassword=i.encrypt.get(),i.encrypt.get({save:!0})&&(d.savePassword=!0,d.attrs.saveSentCopy=!0,delete d.saveTextThreshold)),x.ynote&&t.form.getCheckbox("ynote")&&(n.set({status:"save2YNote",value:!0}),d.attrs.saveSentCopy=!0,delete d.saveTextThreshold,k.cache({cl_ynote:"1"},$.EMPTYFUNC)),x.notary&&n.get({status:"showNotary"})&&(0===i.notary.userpro&&(d.attrs.saveSentCopy=!0),i.notary.status.useSign&&(d.attrs.content+=i.notary.getSign())),"deliver"==e.action&&"1"==w.get({field:"ntes_compose",flag:"undo_send"})&&(d.delayTime=n.delayTime),"deliver"==e.action||"schedule"==e.action){b.extend(u,t.log),n.get({status:"useSign"})&&(u.sign="1"),n.get({status:"showEncrypt"})&&(u.encrypt="1");var S=n.get({status:"fromEntry"});"compose"!=S&&(u.from=S),"shortcut"==e.source&&(u.cl_st=1)}var T,C=[];if(h||(h=t.sendBuild()),T=h.to.concat(h.cc,h.bcc),$.Array.each(T,(function(e,t){C.push($.Uri.getAddress(t))})),e.recList=C,(c.mailIsEnabled()||l.isEnabled())&&h&&("deliver"===e.action||"verify"===e.action)){var _=n.get({status:"sendTraceInfo"});return e.mailTrace=_||t.genTraceInfo(),"deliver"===e.action&&(h.ctrls||(h.ctrls={}),h.ctrls.traceKey=e.mailTrace.hash,e.mailTrace&&e.mailTrace.tracedAttInfo&&e.mailTrace.tracedAttInfo.length&&(h.ctrls.traceAttCnt=e.mailTrace.tracedAttInfo.length),e.mailTrace&&e.mailTrace.htmlSnippet&&(d.attrs.content=[d.attrs.content,e.mailTrace.htmlSnippet].join(""),"saveTextThreshold"in d&&delete d.saveTextThreshold)),void I()}I()}function I(){if(e.body=d,n.set({status:"sendParam",value:e}),n.get({status:"showScheduleInvitation"})&&"save"!==e.action&&"auto"!==e.action&&"force"!==e.action){var i=t.form.getScheduleInvitationData();try{var a=i.bccs;i.bccs=null;var o=p.default.genIcs(i);if(!o)return t.tips("ç”Ÿæˆæ—¥ç¨‹é‚€è¯·å¤±è´¥"),void t.sendReset();t.setSequence("uploadResult",(function(){var e=t.event,n=$.Object.extend(i,o);i.bccs=a,e.toggleScheduleInvitation(!0),t.sendICSLetter(d,u,n,0)})),t.assist.native.nativeSelect([o.blob],void 0,"BaseSend_ICS")}catch(e){m.$D.log(e)}}else s.smartSend({body:d,log:u,callback:$.Function.bind(t.sendSuccess,t),error:$.Function.bind(t.sendError,t)});var r="";switch(e.action){case"deliver":r=g.t("æ­£åœ¨å‘é€é‚®ä»¶...");break;case"schedule":r=g.t("æ­£åœ¨ä¿å­˜å®šæ—¶å‘ä¿¡...");break;case"save":r=g.t("æ­£åœ¨ä¿å­˜é‚®ä»¶...");break;case"auto":case"force":r=g.t("æ­£åœ¨è‡ªåŠ¨ä¿å­˜è‰ç¨¿...");break;case"verify":r=g.t("æ­£åœ¨è¿›è¡ŒéªŒè¯ç æ ¸å¯¹å¹¶å‘é€é‚®ä»¶...")}r&&t.tips(r)}},sendICSLetter:function(e,t,a,n){var o=this,r=o.module.action;n=n||0,o.action.uploadPrepare({body:{composeId:e.id,attachmentId:0,size:a.blob.size,fileName:a.blob.name,contentType:'text/calendar; charset="utf-8"; method=REQUEST'},error:function(){n<=2?o.sendICSLetter(e,t,a,n+1):(o.tips("æ—¥ç¨‹é‚€è¯·åˆ›å»ºå¤±è´¥"),o.sendReset())},callback:function(n){o.action.getInfo({callback:function(n){var s=n.var.attachments;$.Object.each(s,(function(e,t){/\.ics$/.test(t.name)&&(t.mixed=!0,t.inlined=!0,t.description="")})),e.attrs.attachments=s,r.smartSend({body:e,log:t,callback:function(e){!function(e){$.Ext.ics2schedule&&Promise.resolve().then(i.bind(i,26406)).then($.Function.bind((function(e){var t=e.default,i=$.Object.extend({uid:a.uid,sequence:a.sequence},a);t.addIcs(i,(function(e){e&&200!==e.code&&o.tips("æ—¥ç¨‹ç®¡ç†åŒæ­¥å¤±è´¥")}))}))),o.sendSuccess(e)}(e)},error:$.Function.bind(o.sendError,o)})}})}})},sendReset:function(){var e=this.data;this.tips(""),e.set({status:"sendParam",value:null})},sendCheck:function(e){var t=this,i=t.module,a=t.data,n=t.editor,o=t.form,r=t.attach,s=(t.event,t.mailtrace),l=t.mailprotection,d=e.action;if("verify"==d)returnauto"==d&&""===n.getFinal())return!1;var u="save"===d||"auto"===d||"force"===d,p=a.get({status:"showScheduleInvitation"});if(u&&p){var f=$.LocalStorage.get("not_remind_not_save_schedule_invitation",!0),h=a.get({status:"iKnowScheduleInvitationNotSave"});if(!f&&!h)return $.Msgbox.show({statsKey:"Compose_NoGuide_Popup_ScheduleSaveError",title:g.t("å­˜è‰ç¨¿åï¼Œæ—¥ç¨‹ä¿¡æ¯æš‚ä¸æ”¯æŒä¿å­˜åˆ°è‰ç¨¿ç®±ã€‚"),buttons:[{text:g.t("å…³é—­å¹¶ä¸‹æ¬¡ä¸å†æç¤º"),subclass:"mainBtn",click:function(){$.LocalStorage.set("not_remind_not_save_schedule_invitation",1,{expires:999},!0),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),t.send({action:"save"}),$.Log.cache({Compose_NoGuide_Popup_ScheduleSaveError_Cancel:1})}},{text:g.t("æˆ‘çŸ¥é“äº†"),click:function(){$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),a.set({status:"iKnowScheduleInvitationNotSave",value:!0}),t.send({action:"s!1}if("auto"!=d&&"force"!=d&&!t.checkRepeatSend())return!1;if("force"!=d){var v=a.get({status:"fromEntry"});if(("edit"==v||"draft"==v||"timeset"==v||"reply"==v||"forward"==v)&&""===t.info.get({cid:!0}))return"auto"==d||$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_MailLoading",title:g.t("é‚®ä»¶åŠ è½½ä¸­"),icon:"alert",content:g.t("è¯·ç¨åå†è¿›è¡Œä¿å­˜è‰ç¨¿ã€å‘é€é‚®ä»¶ç­‰æ“ä½œã€‚"),okText:g.t("æˆ‘çŸ¥é“äº†"),cancelText:g.t("å–æ¶ˆ")}),!1}if(("deliver"==d||"save"==d)&&a.get({status:"showSchedule"})){if(!t.module.schedule.verify())return!1;d=e.action="schedule"}if("deliver"==d||"schedule"==d){if(!t.checkSenderName(e))return!1;if(!t.checkRev(e))return!1;if(!t.checkSubject(e))return!1;if(!t.checkScheduleInvitation())return!1;if(a.get({status:"showEncrypt"})&&!i.encrypt.verify())return!1;if(!t.checkAttachText(e))return!1;if(o.getCheckbox("chargesms"))try{var b=(i=t.module).smsNotify.checkData();if(!b)return!1;a.set({status:"chargeSmsData",value:b})}catch(e){m.$D.debug("chargesms Error"+e)}}if("deliver"==d||"schedule"==d){var y=a.get({status:"usedCloudFile"}),x=r.fileGet({type:"link"}),k=a.sequence.attachMove;if(!y&&(x&&x.length||k)&&!s.mailIsEnabled())return $.Msgbox.show({statsKey:"Compose_Popup_FirstUseCloudFileRemaind",statsValue:e,title:g.t("é‚®ä»¶ä¸­åŒ…å«â€œè¶…å¤§é™„ä»¶â€ï¼Œå­˜åœ¨æœ‰æ•ˆæœŸé™åˆ¶ï¼Œè¯·æé†’æ”¶ä»¶äººåŠæ—¶ä¸‹è½½ã€‚"),content:g.t("æ³¨æ„ï¼šè‹¥æ–‡ä»¶è¿‡æœŸæˆ–è¢«åˆ é™¤ï¼Œæ”¶ä»¶äººå°†æ— æ³•ä¸‹è½½ï¼Œéœ€è¦é‡æ–°å‘é€ã€‚")+"<br/>"+$.Checkbox.html({id:"cloudFileRemindCheckbox",text:g.t("ä¸å†æç¤º")}),buttons:[{text:g.t("æˆ‘çŸ¥é“äº†"),subclass:"mainBtn",click:function(){$.Log.cache({Compose_Popup_FirstUseCloudFileRemaind_OK:1}),(0,m.$C)("cloudFileRemindCheckbox").getChecked()&&($.Ud.setProxy({field:"webmail.js.usedCloudFile",value:1}),$.Log.cache({webmail_js_usedCloudFile_set:1})),a.set({status:"usedCloudFile",value:!0}),t.send(e),$.Msgbox.msgbox&&$.Msgbox.msgbox.close()}},{text:g.t("äº†è§£æ›´å¤š"),click:function(){window.open("https://help.mail.163.com/faqDetail.do?code=d7a5dc8471cd0c0e8b4b8f4f8e49998b374173cfe9171305fa1ce630d7f67ac23d1e5b8b0de9b802","_blank"),$.Log.cache({Compose_Popup_FirstUseCloudFileRemaind_More:1})}}]}),!1}if("deliver"==d||"schedule"==d||"verify"==d||"save"==d){if(r.fileIsPost())return t.setSequence("postResult",(function(){t.send(e)})),r.postUpload(),!1;if(r.fileIsUpload()){if(t.setSequence("uploadResult",(function(){t.send(e)})),"save"==d)t.tips(g.t("æ­£åœ¨ä¸Šä¼ é™„ä»¶ï¼Œä¸Šä¼ å®Œæˆåå°†è‡ªåŠ¨ä¿å­˜åˆ°è‰ç¨¿ç®±"));else{var S={items:[{html:"<span>"+g.t("æ­£åœ¨ä¸Šä¼ é™„ä»¶ï¼Œä¸Šä¼ å®Œæˆåå°†è‡ªåŠ¨å‘é€ ")+"</span>"},{xtype:"link",bracket:!0,text:g.t("å–æ¶ˆè‡ªåŠ¨å‘é€"),click:function(){delete a.sequence.uploadResult,this.destroy(),t.tips()}}]};t.tips(S)}return!1}if(r.fileIsError())return r.validLocal(),t.tips(""),!1;if(r.get({status:"validServer"}))return r.set({status:"validServer",value:!1}),r.validServer(d),!1}var w=a.get({status:"showNotary"}),T=a.get({status:"showEncrypt"}),C=o.getAllRecvNum();if("deliver"==d&&C>=2){if(s.mailIsEnabled()&&w&&s.featureCheck("groupSend"))return s.showGroupSendConfigWithNotary((function(){t.send(e)})),!1;if(s.mailIsEnabled()&&T&&s.featureCheck_,I,A,M=(_=o.getSender().address,I=c.default.getUid(),A=c.default.getMobile(),_==I.address||null!==A&&_==A.address);if(!M&&s.featureCheck("groupSend")&&s.mailIsEnabled()&&o.getAllRecvNum()>=2&&"deliver"===d)return s.showGroupSendConfigWithSender((function(){t.send(e)})),!1;var L=r.fileGet({type:"storage"}),E=a.get({status:"confirmStoargeFileNoTrace"});if($.Array.remove(L,(function(e){return!e.url})),L.length&&!E&&"deliver"===d&&s.attachIsEnable())return s.remindStorageFileNotrace((function(){a.set({status:"confirmStoargeFileNoTrace",value:!0}),t.send(e)})),!1;if("deliver"===d&&l.isEnabled()&&!l.hasEncryptId())return M?p?(l.showConfigWithSchedule((function(){t.send(e)})),!1):(l.createEncryptConfig({to:o.getContact("build","to"),subject:o.getSubject(),ext:{showOwnerRcpt:!!a.get({status:"useSeparate"}),linkedAttach:r.fileGet({type:"link"}).length>0}},(function(){t.genTraceInfo({encrypt_id:l.getEncryptId()}),t.send(e)}),(function(i){i&&315===i.code?l.showExpireRemindDialog((function(){t.send(e)})):l.showUnknownCreateFailDialog()})),!1):(l.showConfigWithSender((function(){t.send(e)})),!1);var D=r.moveGet();if("deliver"===d&&s.attachIsEnable()&&D.length&&!r.fileIsPost())return $.Log.cache({compose_trace_moveattach:1}),t.setSequence("attachMoveComplete",(function(){$.Log.cache({compose_trace_moveattach_success:1}),t.send(e)})),r.movePrepare(0),t.runSequence("attachMove"),!1;var R=a.get({status:"cloudLinksUpdated"});if("deliver"===d&&!R&&s.attachIsEnable()&&!r.fileIsPost()){var P=a.get({status:"sendTraceInfo"})||t.genTraceInfo();return $.Log.cache({compose_trace_renewattach:1}),r.linkAllRenew(P.hash,(function(){a.set({status:"cloudLinksUpdated",value:!0});var i=a.get({status:"renewedCloudLinks"}),n=$.Object.values(i);P.tracedAttInfo=$.Array.map(n,(function(e,t){return{fileId:$.Support.parseQuery(t.href).file,fileName:t.fileName}})),$.Log.cache({compose_trace_renewattach_success:1}),t.send(e)})),!1}return!0},sendBuild:function(e){e=e||{};var t=this,i=t.module,a=t.data,n=t.form,o=t.editor,r=t.attach,s=t.at,c=i.mailtrace,l={},u=n.getSender();l.account=u.toString(),u.smtp&&(l.accountSettings={smtpHost:"@",popWebId:u.popId}),a.get({status:"useSeparate"})?(l.showOneRcpt=!0,l.to=n.getContact("build","separate"),l.cc=l.bcc=[]):(l.showOneRcpt=!1,l.to=n.getContact("build","to"),l.cc=n.getContact("build","cc"),l.bcc=n.getContact("build","bcc"));var p=n.getSubject();if(""===$.String.trim(p)&&"auto"==e.action){var f=d.Z.getTime(0),h=(0,m.$S)("isCH")?"yyyyå¹´Mæœˆdæ—¥ H:mm:ss":"dd/MM/yyyy H:mm:ss";p=$.Date.format(f,g.t(h))+" "+g.t("è‡ªåŠ¨ä¿å­˜è‰ç¨¿")}l.subject=p;var v=o.getFinal();if(n.getCheckbox("text"))l.isHtml=!1;else if(l.isHtml=.Browser.getVersion()||[0,0];$.Browser.ie()&&b[0]<=8&&(v=o.getFinal(!0)),v=v.replace(new RegExp('id="*(spnEditorSign|divEditorGraphSign)"*',"ig"),"")}var y=r.linkHtml({action:e.action,subject:p});y&&(l.isHtml||(l.isHtml=!0,v=o.getFinal("html")),v+=y),l.content=v,l.priority=n.ache({cl_priority:"1"},$.EMPTYFUNC),l.requestReadReceipt=n.getCheckbox("receipt"),1==l.requestReadReceipt&&k.cache({cl_receipt:"1"},$.EMPTYFUNC),l.saveSentCopy=!!(c&&c.mailIsEnabled&&c.mailIsEnabled())||(0,m.$S)("attrs").user.save_sent<2,"schedule"==e.action&&(l.scheduleDate=t.module.schedule.getWithTimeZoneFixed());var S=r.inlineSync();S&&S.length&&(l.attachments=S);var T="GBK";if("1"==w.get({field:"ntes_option",flag:"mailencode"})&&(T="UTF-8"),l.charset=T,"deliver"==e.action||"save"==e.action||"schedule"==e.action){if(x.composeAt){var C=s.getEmail();l.ctrls=C?{at:C}:null}a.get({status:"vipMember"})&&x.plusBrand&&(l.ctrls||(l.ctrls={}),l.ctrls.plus=t.generatePlusFlag())}return"deliver"==e.action&&c.maill.ctrls.mailTracking=1),l},sendSuccess:function(e){var t=this,i=t.data,a=t.i,r=n.attach;t.tips("");var s=i.get({status:"sendParam"}),c={value:"save"==s.action,action:s.action};try{c.success=!0;var u="schedule"===s.action?e.scheduledSent:e.savedSent;if(c.tid=u?u.msid+":"+u.mid:e.sentTInfo,t.form,c.from=$.Uri.getEmails(s.body.attrs.account).match[0].address,c.to=$.Array.map(s.body.attrs.to,(function(e,t){return $.Uri.getEmails(t).match[0].address})),c.cc=$.Array.map(s.body.attrs.cc,(function(e,t){return $.Uri.getEmails(t).match[0].address})),c.bcc=$.Array.map(s.body.attrs.bcc,(function(e,t){return $.Uri.getEmails(t).match[0].address})),c.encrypt=!!s.body.encryptPassword,c.subject=s.body.attrs.subject,c.fileList=$.Array.map(r.fileGet(),(function(e,t){return{name:t.name,size:t.size,type:t.type,id:t.fid,inlined:t.inlined}})),"deliver"===s.action){o=n.mailtrace;var m=n.mailprotection;o=n.mailtrace,c.mailtrace=o.mailIsEnabction=m.isEnabled()}}catch(e){}if(k.cache({ComposeSendSuccess:c}),$.Log.duration("performance_ir_compose","end"),"save"==s.action||"auto"==s.action||"force"==s.action||"continue"==s.action){if(a.set({obj:e.var}),e.draftId&&(a.set({did:e.draftId}),$.JS.displayModule===n&&$.JS.displayModule.name===n.name)){var p={type:"draft",cid:e.draftId};location.replace("#module=compose.ComposeModule|"+encodeURIComponent(JSON.stringify(p)))}"save"!=s.action&&"force"!=s.action||i.set({status:"existActiveDraft",value:!0}),t.changeSync();var f=d.Z.getTime(0);"auto"!=s.action&&"save"!=s.action||($.Tips.show({succ:!0,expire:0,text:g.t("é‚®ä»¶å·²äº")+$.Date.format(f,"H:mm")+g.t("æˆåŠŸä¿å­˜åˆ°è‰ç¨¿ç®±")}),t.trans({action:"check"})),"function"==typeof s.call&&t.addTimer("force",(function(){s.call()}))}else{t.clearTimer();var h=a.get({cid:!0});a.set({cid:""}),"verify"==s.action&&(s.action="deliver"),t.success.render(e,h),t.updateFirstCloudFileSend(),o.reset(),o.sendSuccess(s)}t.userDataRemove();try{var v=[2];"deliver"==s.action&&v.push(3),$.Listener.fire("compose:send",v),l.default.request(["Folder"])}catch(e){}i.set({status:"sendParam",value:null})},sendError:function(e){var t=this,i=t.data,a=t.info,o=t.attach,r=e.code,s=e.var;t.tips(""),k.cache({ComposeSendError:{success:!1}});var c=i.get({status:"sendParam"});if(i.set({status:"sendParam",value:null}),"auto"==c.action)return"FA_ID_NOT_FOUND"===r&&i.set({status:"autoSave",value:!1}),!0;r==S&&("string"==typeof s?a.set({cid:s}):"object"==h(e.var)&&a.set({obj:s}));var l=n.default.error(e,c.action);if(t.isMailCapacityOverflow(l,e.code,e.overflowReason))return i.get({status:"vipMember"})||(0,m.$S)("isVip")?(l=g.t("é‚®ç®±å®¹é‡å·²æ»¡ï¼Œé‚®ä»¶æ— æ³•ä¿å­˜ä¸ºè‰ç¨¿ï¼Œè¯·å°½å¿«æ¸…ç†é‚®ç®±ã€‚"),t.showMailCapacityOverflowDialog(l,c.action),!0):(t.showMailCapacityOverflowDialog(l,c.action),!0);if(t.isMailSendQuotaOverflow(l,e.code,e.mtaCode))return(0,m.$S)("isVip")?(t.showMailSendQuotaOverflowDialog(),!0):(t.showFreeMailSendQuotaOverflowDialog(),!0);if(l){if("FA_MTA_RCPT_ERROR"==l){var d,u=[];if(function(){var t,i=e.errorRcpts,a="",n=[];for(a in i)if("string"==typeof a&&-1!=a.indexOf("@")){if(i[a])switch(i[a]){case"MTA5104":t=g.t("è´¦å·è¢«åœç”¨");break;case"MTA5107":t=g.t("è´¦å·ä¸å­˜åœ¨");break;case"MTA5101":t=g.t("ç”±äºç®¡ç†å‘˜é™åˆ¶ï¼Œæ‚¨æ²¡æœ‰æƒé™å‘é€é‚®ä»¶ç»™ä¼ä¸šå¤–çš„é‚®ä»¶åœ°å€");break;default:t=g.t("è´¦å·è¢«ç¦æ­¢")}else t=g.t("ç³»ç»Ÿä¸å…è®¸");t='<label title="'+t+'">'+a+"</label>",n.push(t),u.push(a)}d=n.join("<br>")}(),d){var p=g.t("ä»¥ä¸‹é‚®ç®±åœ°å€æ— æ•ˆï¼Œå°†æ— æ³•æˆåŠŸæ”¶åˆ°é‚®ä»¶");$.Msgbox.show({statsKey:"Compose_Guide_Popup_AddressInvalid",title:p,content:d+"",okText:g.t("å‘é€é‚®ä»¶ï¼Œå¿½ç•¥æ— æ•ˆåœ°å€"),cancelText:g.t("è¿”å›ç¼–è¾‘"),ok:function(){t.sendFixMta(u,!0)},cancel:function(){t.sendFixMta(u)}})}else $.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AddressError",title:g.t("å¯¹ä¸èµ·ï¼Œå­˜åœ¨éƒ¨åˆ†æ”¶ä»¶äººæ— æ³•æ”¶åˆ°ä¿¡ä»¶ï¼")});return!0}return l}switch(r){case"FA_INVALID_VERIFY_CODE":case"FA_NEED_VERIFY_CODE":var f=r.split("_")[1].toLowerCase();n.default.verify(f,(function(e){t.send({action:"verify",code:e})}));break;case"FA_ATTACH_NOT_COMPLETED":case"FA_ATTACH_CRC_FAILED":var v=e.badAttachment;if(v){var b=v.name||"";b=$.String.encodeHTML(b);var y=g.t("é™„ä»¶")+b+g.t("ä¸Šä¼ ä¸å®Œæ•´ï¼Œéƒ¨åˆ†æ–‡ä»¶ä¸¢å¤±ï¼Œæ˜¯å¦åˆ é™¤ï¼Ÿ");$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentNotCompleted",type:"confirm",header:g.t("é™„ä»¶æ ¡éªŒå‡ºé”™"),title:y,ok:function(){t.action.deleteAttach({sid:v.id,callback:function(e){e.code==S||$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_DeleteError",title:g.t("åˆ é™¤å¤±è´¥ï¼Œè¯·ä¿å­˜è‰ç¨¿åé‡æ–°æ‰“å¼€ã€‚")})}})}})}break;default:var x=o.fileGet({state:"success"});return"FA_ID_NOT_FOUND"===r&&i.set({status:"autoSave",value:!1}),x&&x.length||a.set({cid:""}),!1}return!0},sendFixMta:function(e,t){var i=this.form;t?($.Array.each(["to","cc","bcc","separate"],(function(t,a){i.removeContact(e,a)})),this.send({action:"deliver"})):$.Array.each(["to","cc","bcc","separate"],(function(t,a){i.modifyContact(e,a,!1)}))},updateFirstCloudFileSend:function(){var e=this.module,t=e.data,i=e.attach,a=t.get({status:"firstCloudFileSend"}),n=i.fileGet({type:"link"});!a&&n&&n.length&&$.Ud.setProxy({field:"webmail.js.firstCloudFileSend",value:1})},isMailCapacityOverflow:function(e,t,i){return e&&"FA_OVERFLOW"===t&&"pref_quota"===i},isMailSendQuotaOverflow:function(e,t,i){return e&&"FA_MTA_REJECTED"===t&&(5530===i||5520===i)},showMailCapacityOverflowDialog:function(e,t){var a=this.data.get({status:"vipMember"})||(0,m.$S)("isVip"),n={save:"mailbox_capacity2",deliver:"mailbox_capacity1"},o=e;a?$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_StoregeFull",title:o,cancelText:g.t("å– æ¶ˆ")}):$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_StoregeFull",title:o,okText:g.t("å¼€é€šé‚®ç®±ä¼šå‘˜"),cancelText:g.t("å– æ¶ˆ"),ok:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showDialog("plus","",n[t])})))}}),$.Log.cache({ComposeCapacityOverflowOnSave:1})},showMailSendQuotaOverflowDialog:function(){this.data;var e=!1,t=$G.user.cosid;(0,m.$S)("isvip")?e=$.Array.has(["6","213","7","252"],t):(0,m.$S)("is126vip")?e=$.Array.has(["25","104","27","121"],t):(0,m.$S)("is188")&&(e=$.Array.has(["34","251","210","310"],t)),e?$.Msgbox.show({statsKey:"Compose¤±è´¥"),content:g.t("æ‚¨ä»Šå¤©çš„å‘ä¿¡æ•°é‡å·²è¶…è¿‡é™åˆ¶ï¼Œè¯·")+'<span style="color:#a38152;">'+g.t("å‡çº§VIPå¥—é¤")+"</span>"+g.t("ä»¥æå‡å°æ•°ä¸Šé™æˆ–æ˜å¤©å†è¯•ã€‚")+"<br/><br/>"+g.t("æç¤ºï¼šç¾¤å‘æ—¶æ¯ä½æ”¶ä»¶äººéƒ½å°†æ¶ˆè€—æ‚¨çš„å‘ä¿¡æ¬¡æ•°"),ok:function(){var e=window.location.protocol+"//reg.vip.163.com/changeMailType.m?itemsStr=5&from=compose_send_quota_full";(0,m.$E)("interface.OutlinkInterface",(function(t){t.goOutlink({url:e,title:"é‚®ç®±å‡çº§",group:"",lockid:void 0,fullScreen:!0})}))},okText:g.t("ç«‹å³å‡çº§"),cancelText:g.t("æˆ‘çŸ¥é“äº†")}):$.Msgbox.show({statsKey:"Compose_Guide_Popup_SendQuotaFull",title:g.t("å‘ä¿¡å¤±è´¥"),content:g.t("æ‚¨ä»Šå¤©çš„å‘ä¿¡æ•°é‡å·²è¶…è¿‡é™åˆ¶ï¼Œè¯·æ˜å¤©å†è¯•ã€‚")+"<br/><br/>"+g.t("æç¤ºï¼šç¾¤å‘æ—¶æ¯ä½æ”¶ä»¶äººéƒ½å°†æ¶ˆè€—æ‚¨çš„å‘ä¿¡æ¬¡æ•°"),buttons:[{subclass:"mainBtn",text:g.t("æˆ‘çŸ¥ébox.close(),$.Log.cache({Compose_Guide_Popup_SendQuotaFull_OK:1})}}]}),erflow:1})},showFreeMailSendQuotaOverflowDialog:function(){var e=this;e.data,$.Ud.get,"product.plus.member"],call:function(t){var i=t["product.vipMember"],a=t["product.plus.member"];if(!1===i||a<5){var n=g.t("æ‚¨ä»Šå¤©çš„å‘ä¿¡æ•°é‡å·²è¶…è¿‡é™åˆ¶ï¼Œè¯·")+'<span style=å‘˜"):g.t("è´­ä¹°é‚®ç®±ä¼šå‘˜"))+"</span>"+g.t("ä»¥æå‡å°æ•°ä¸Šé™æˆ–æ˜å¤©å†è¯•ã€‚")+"<br/><br/>"+g.t("æç¤ºï¼šç¾¤å‘æ—¶æ¯ä½æ”¶ä»¶äººéƒ½å°†æ¶ˆè€—æ‚¨çš„å‘ä¿¡æ¬¡æ•°"),o=i?g.t("ç«‹å³å‡çº§"):g.t("æå‡ä¸Šé™");$.Msgbox.show({statsKey:"Compose_Guide_Popup_SendQuotaFull_Upgrade",statsValue:{isMember:i,memberType:a},title:g.t("å‘ä¿¡å¤±è´¥"),content:n,ok:function(){e.send({action:"save"}),(0,m.$E)("product.Privileges",(function(e){i?e.upgrade({utm_source:"web_delivery_limit_upgrade"}):e.showProduct("","web_delivery_limit")}))},okText:o,cancelText:g.t("æˆ‘çŸ¥é“äº†")})}else $.Msgbox.show({statsKey:"Compose_Guide_Popup_SendQuotaFull",statsValue:{isMember:i,memberType:a},title:g.t("å‘ä¿¡å¤±è´¥"),content:g.t("æ‚¨ä»Šå¤©çš„å‘ä¿¡æ•°é‡å·²è¶…è¿‡é™åˆ¶ï¼Œè¯·æ˜å¤©å†è¯•ã€‚")+"<br/><br/>"+g.t("æç¤ºï¼šç¾¤å‘æ—¶æ¯ä½æ”¶ä»¶äººéƒ½å°†æ¶ˆè€—æ‚¨çš„å‘ä¿¡æ¬¡æ•°"),buttons:[{subclass:"mainBtn",text:g.t("æˆ‘çŸ¥é“äº†"),click:function(){$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),$.Log.cache({Compose_Guide_Popup_SendQuotaFull_OK:1})}}]});var r={ComposeQuotaOverflow:{isMember:i,memberType:a}};$.Log.cache(r)}})},generatePlusFlag:function(){var e=$G.user.uid.split("@"),t=e[0],i=e[1],a=(new Date).getTime().toString(),n=t+a+i;return a+"_"+u.default.encode(n)},checkRepeatSend:function(){var e=this.data,t=(this.form,e.get({status:"sendCheckCount"}));if(t>=0){var i=e.get({status:"sendParam"}),a=e.get({status:"uploadParam"});if(i||a){if(i)if("save"==i.action||"auto"==i.action)$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_MailSaving",title:g.t("æ‚¨çš„ä¿¡ä»¶æ­£åœ¨ä¿å­˜ä¸­ï¼Œè¯·ç¨å€™ï¼")});else{var n=$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_MailSending",title:g.t("æ‚¨çš„ä¿¡ä»¶æ­£åœ¨å‘é€ä¸­ï¼Œè¯·ç¨å€™ï¼")});e.set({component:"sendMsgBox",value:n})}else"form"==a.action?$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentUploading",title:g.t("æ‚¨çš„é™„ä»¶æ­£åœ¨ä¸Šä¼ ä¸­ï¼Œè¯·ç¨å€™ï¼")}):"move"==a.action&&$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentMoving",title:g.t("æ‚¨çš„é™„ä»¶æ­£åœ¨ç§»åŠ¨ä¸­ï¼Œè¯·ç¨å€™ï¼")});return++t>=2&&(t=-1),e.set({status:"sendCheckCount",value:t}),!1}}return e.set({status:"sendCheckCount",value:0}),!0},checkSenderName:function(e){var t=this,i=t.form;if("0"==w.get({field:"ntes_compose",flag:"senderName"})){var a=i.getSender(),n=a.address.split("@");if((0,m.$S)("domain")==n[1]&&a.name==n[0]){if(y.checkMobile(a.name))return r("mobile");if(""===(0,m.$S)("attrs").user.true_name){var o=(0,m.$S)("attrs").user.displaysender;if(0===o)return r("account");if(1==o&&""===(0,m.$S)("attrs").user.nick_name)return r("account")}}}return!0;function r(i){w.set({field:"ntes_compose",flag:"senderName",value:"1"});var n=g.t("ç”¨æˆ·å");"mobile"==i&&(n=g.t("æ‰‹æœºå·"));var o=g.t("æ”¶ä»¶äººåªèƒ½çœ‹åˆ°æ‚¨çš„")+n+g.t("ï¼Œå¯èƒ½æ²¡æ³•çŸ¥é“æ˜¯æ‚¨çš„é‚®ä»¶ã€‚")+"<br />"+g.t("ä¸ºæ–¹ä¾¿å¯¹æ–¹ç¡®è®¤ï¼Œè¯·å¡«å†™æ‚¨çš„å§“åï¼š");return $.Msgbox.show({statsKey:"Compose_NoGuide_Popup_NameNotSet",type:"prompt",title:g.t("æ‚¨è¿˜æ²¡è®¾ç½®å§“åï¼"),content:o,okText:g.t("ä¿å­˜å¹¶å‘é€"),inputWidth:"300px",ok:function(i){var n=$.String.trim(i);if(!n)return g.t("å§“åä¸èƒ½ä¸ºç©º");$.Tips.show({statsKey:"Compose_NoGuide_Tips_SenderSetSuccess",succ:!0,text:g.t("å‘ä»¶äººå§“åè®¾ç½®æˆåŠŸ")}),t.form.setSender(new y(a.address,n)),t.addTimer("sendCheck",(function(){t.send(e)}),10),w.set({field:"true_name",value:n}),$.Listener.fire("options:personalModify",[{field:"true_name",value:n}])}}),!1}},checkRev:function(e){var t=this,a=t.data,n=t.form,o=0;if(a.get({status:"useSeparate"})){ife if(!(d("to")&&d("cc")&&d("bcc")))return!1;if(0===o)return t.tips({text:g.t("è¯·å¡«å†™æ”¶ä»¶äººåœ°å€åå†å‘é€"),expires:6e3}),n.focus(),!1;var s,c,l=(0,m.$S)("attrs").cos.pref_smtp_max_num_rcpts||0;return!(o>l)||(c=g.t("æ‚¨é€‰æ‹©çš„å‘ä»¶äººæ€»æ•°ä¸º")+o+g.t("äººï¼Œè¶…è¿‡")+l+g.t("äººçš„é™åˆ¶ï¼"),(0,m.$S)("isFree")?a.get({status:"vipMember"})?(c+='<br><a href="'+T.getUrl("compose_update_vip",!0)+'" target="_blank">'+g.t("å•æ¬¡ç¾¤å‘400å°(VIPç‰¹æƒ)ï¼Œç«‹å³å‡çº§>")+"></a>",$.Msgbox.show({statsKey:"Compose_Premium_Popup_RecipientsLimit",statsValue:o,title:c,ok:function(){n.focus()}})):(c+="<br>"+g.t("ç«‹å³å¼€é€šä¼šå‘˜ï¼Œå¯äº«å•æ¬¡ç¾¤å‘200å°ç‰¹æƒ"),$.Msgbox.show({statsKey:"Compose_Premium_Popup_RecipientsLimit",statsValue:o,title:c,okText:g.t("å¼€é€šé‚®ç®±ä¼šå‘˜"),cancelText:g.t("å– æ¶ˆ"),ok:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showDialog("plus","","sender")}))),$.Log.cache({ComposeBaseRecvOverLimitClick:o})}})):(5==l?(s={"vip.163.com":"http://reg.vip.163.com/pay.m?b10ele1","vip.126.com":"http://reg.vip.126.com/pay.m?b66ele1","188.com":"http://pay.mail.188.com/html/pay/list.jsp?b11ele1"},c=g.t("é‚®ç®±å°šæœªå¼€é€šï¼Œå‘é€äººæ•°ä¸å¯è¶…è¿‡5äººï¼")+"<br>"+g.t("å¼€é€šVIPé‚®ç®±ï¼Œæœ€é«˜å¯ç¾¤å‘400äººï¼")+'<a href="'+s[(0,m.$S)("domain")]+'" target="_blank">'+g.t("é©¬ä¸Šå¼€é€š")+"&gt;&gt;</a>"):100==l&&(s={"vip.163.com":"b10dye5","vip.126.com":"b66dye5","188.com":"b11dye5"},c+="<br>"+$.Link.html({text:g.t("å‡çº§400å°å•æ¬¡ç¾¤å‘"),click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({url:T.getUrl("option_viptype",!0)+"?"+s[(0,m.$S)("domain")],key:"option_viptype"})}))),$.Msgbox.msgbox.close()}})),$.Msgbox.show({title:c,ok:function(){n.focus()}})),$.Component.setEvents(),$.Log.cache({ComposeBaseRecvOverLimit:o}),!1);function d(i){var s,c=function(){$.Msgbox.msgbox&&$.Msgbox.m(function(){t.send(e)}),10)},d=function(){c(),n.focus(i)},u=n.getContact("object",i);if(u.fail&&u.fail.length)return s="",$.Array.each(u.fail,(function(e,t){s+=t.address+"\n"})),s=(s=$.String.encodeHTML(s)).replace(/\n/g,"<br>"),$.Msgbox.show({statsKey:"Compose_Guide_Popup_AddressInvalid",title:g.t("ä»¥ä¸¶åˆ°é‚®ä»¶"),content:s,okText:g.t("å‘é€é‚®ä»¶ï¼Œå¿½ç•¥æ— æ•ˆåœ°å€"),ok:function(){n.removeContact(u.fail,i),l()},cancelText:g.t("è¿”å›ç¼–è¾‘"),cancel:d}),!1;var m=[];if($.Array.each(u.suc,(function(e,t){r.default.isRefuse(t)&&(a.blackList[t.address.toLowerCase()]||m.push(t))})),m.length){s=g.t("ä»¥ä¸‹åœ°å€å·²ç»åœ¨æ‚¨çš„é»‘åå•ä¸­ï¼Œæ‚¨å°†æ— æ³•æ”¶åˆ°ä»–ä»¬çš„å›ä¿¡ï¼Œæ˜¯å¦ä¸ç»™ä»–ä»¬å‘ä¿¡ï¼Ÿ")+"<br/>",s='<strong class="nui-txt-impt">';for(var p=0;p<m.length;p++)s+=$.String.encodeHTML(m[p].toString())+"<br/>";return s+="</strong>",$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_Bla•ä¸­ï¼Œå°†æ— æ³•æ”¶åˆ°å›ä¿¡"),content:s,buttons:[{xtype:"button",text:g.t("å‘ä¿¡ï¼ˆä½†ä¸ç»™ä»–ä»¬ï¼‰"),type:"impt",click:function(){n.removeContact(m,i),l(),$.Log.cache({Compose_NoGuide_Popup_BlackList_SendExclude:1})}},{xtype:"button",text:g.t("ç»§ç»­ç»™ä»–ä»¬å†™ä¿¡"),click:function(){$.Array.each(m,(function(e,t){a.blackList[t.address.toLowerCase()]=!0})),l(),$.Log.cache({Compose_NoGuide_Popup_BlackList_Send:1})}},{xtype:"button",text:g.t("è¿”å›ç¼–è¾‘"),click:function(){d(),$.Log.cache({Compose_NoGuide_Popup_BlackList_Cancel:1})}}]}),!1}return o+=u.suc.length,!0}},checkSubject:function(e){var t=this,i=t.form;return""!==$.String.trim(i.getSubject())||("shortcut"==e.source?window.setTimeout(a,300):a(),!1);function a(){$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_ NoTitle",type:"confirm",title:g.t("ç¡®å®šçœŸçš„ä¸éœ€è¦å†™ä¸»é¢˜å—ï¼Ÿ"),ok:function(){i.setSubject(g.t("æ¥è‡ª")+(c.default.getName()||(0,m.$S)("orgUid"))+g.t("çš„é‚®ä»¶")),t.addTimer("sendCheck",(function(){t.send(e)}),10)},cancel:function(){t.addTimer("sendCheck",(function(){i.focus("subject")}),10)}})}},checkScheduleInvitation:function(){var e=this,t=e.data,i=e.form;if(!t.get({status:"showScheduleInvitation"}))return!0;var a=i.getScheduleInvitationAddr(),n=i.getScheduleInvitationStartTime(),o=i.getScheduleInvitationEndTime();if(!(a&&a.length>140))return!(o<n)||(e.tips({text:g.t("æ—¥ç¨‹é‚€è¯·ç»“æŸæ—¶é—´å¿…é¡»å¤§äºå¼€å§‹æ—¶é—´"),expires:6e3}),i.focus("scheduleInvitationEndDay"),!1);i.focus("scheduleInvitationAddr")},checkAttachText:function(e){var t=this,i=t.data,a=t.attach;if(i.get({status:"confirmAttach"})){i.set({status:"confirmAttach",value:!1});var n=a.get({count:!0});if(a.cardGet()&&n--,a.stationeryGet()&&n--,0===n&&-1!=t.editor.get({html2text:!0}).indexOf(g.t("é™„ä»¶")))return $.Msgbox.show({statsKey:"Compose_NoGuide_Popup_NoAttachment",type:"confirm",title:g.t("é‚®ä»¶ä¸­æ˜¾ç¤ºæ‚¨å¯èƒ½å¸Œæœ›å‘é€é™„ä»¶ï¼Œä½†å®é™…æ²¡æœ‰ä»»ä½•é™„ä»¶ï¼Œæ‚¨ç¡®è®¤ç»§ç»­å‘é€å—ï¼Ÿ"),okText:g.t("ç»§ç»­å‘é€"),cancelText:g.t("è¿” å›"),ok:function(){t.addTimer("sendCheck",(function(){t.send(e)}),10)}}),!1}return!0},changeCheck:function(){var e=this,t=e.attach,i=e.data.change,a=!1;if(i.composeInfo){var n=t.get({count:!0});if(t.cardGet()&&n--,t.stationeryGet()&&n--,n!=i.attachCount&&(a=!0),!a){var o=e.sendBuild();b.isEqual(o,i.composeInfo)||(a=!0)}}return a},changeSync:function(){var e=this,t=e.data,i=e.attach,a=t.change;a.composeInfo=e.sendBuild();var n=i.get({count:!0});i.cardGet()&&n--,i.stationeryGet()&&n--,a.attachCount=n},focus:function(){var e=this,t=e.data,i=e.form,a=e.editor,n="to";t.get({status:"useSeparate"})&&(n="separate");var o=t.get({status:"fromEntry"});i.getContact("empty",n)&&"reply"!=o?i.focus(n):($.String.trim(i.getSubject())?a.focus(!1):i.focus("subject"),i.removeFocusCls("to"))},empty:function(){var e=this,t=e.data,i=e.editor,a=e.form,n=e.attach,o=!0;return"success"==t.get({status:"curPage"})||("compose"==t.get({status:"fromEntry"})&&a.getContact("empty","to")&&a.getContact("empty","cc")&&a.getContact("empty","bcc")&&a.getContact("empty","separate")?""!==$.String.trim(a.getSubject())||n.get({count:!0})>0?o=!1:i.get({empty:!0})&&t.get({status:"empty"})||(o=!1):o=!1),o},addTimer:function(e,t,i){i=i||0;var a=this.data;if(a){var n=a.timer;this.clearTimer(e),n[e]=window.setTimeout((function(){delete n[e],t()}),i)}},clearTimer:function(e){var t=this,i=t.data.timer;i&&(e?"number"==typeof i[e]&&(window.clearTimeout(i[e]),delete i[e]):b.each(i,(function(e){t.clearTimer(e)})))},autoSave:function(){var e=this,t=e.data,i=e.attach;e.addTimer("save",(function(){t.get({status:"autoSave"})&&("compose"==t.get({status:"curPage"})&&(t.get({status:"sendParam"})||t.get({status:"uploadParam"})||i.fileIsUpload()||!e.changeCheck()||(2==t.get({status:"autoSaveTime"})&&t.set({status:"autoSaveTime",value:5}),e.send({action:"auto"}))),e.autoSave())}),6e4*t.get({status:"autoSaveTime"}))},autoKeep:function(){var e=this;e.addTimer("keep",(function(){e.info.get({cid:!0})&&e.action.getInfo({callback:function(){}}),e.autoKeep()}),15e5)},getAction:function(){var e=this.data,t="",i=e.get({status:"sendParam"}),a=e.get({status:"uploadParam"});return i?t=i.action:a&&(t=a.action),t},listenAuthInvalid:function(){},handleAuthInvaDataSave()},userDataSave:function(){var e=this,t=e.form;if(e.changeCheck()){var i=(0,m.$S)("uid").replace("@","."),a={to:t.getContact("build","to"),subject:t.getSubject(),content:e.editor.get()};$.Storage.set(i,JSON.stringify(a)),window.composeResume=!1}},userDataRemove:function(){var e=(0,m.$S)("uid").replace("@",".");try{$.Storage.remove(e)}catch(e){}},userDataResume:function(){var e=this;if("compose"==e.data.get({status:"fromEntry"})&&!window.composeResume){window.composeResume=!0;var t=(0,m.$S)("uid").replace("@","."),i="";try{i=$.Storage.get(t)}catch(e){}if(i){e.userDataRemove();var a=null;try{a=JSON.parse(i)}catch(e){}a&&e.fillContent(a)}}},connectBreak:function(){var e=this;e.data.set({status:"network",value:!1}),e.empty()||$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_NetworkDisconnected",icon:"alert",type:"confirm",title:g.t("ç½‘ç»œè¿æ¥å·²æ–­å¼€"),content:g.t("è¯·æ‚¨æ£€æŸ¥ç½‘ç»œè®¾ç½®ã€‚å·²ç¼–è¾‘å†…å®¹è‡ªåŠ¨ä¸ºæ‚¨ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨ï¼Œä¸‹æ¬¡ç™»å½•æ—¶è¿›å…¥å†™ä¿¡é¡µé¢å°†è‡ªåŠ¨æ¢å¤ã€‚"),cancelText:g.t("å–æ¶ˆ"),okText:g.t(e,e)})},connectResume:function(){this.data.set({status:"network",value:!0})},sessionBreak:function(){var e=this;e.empty()||$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_LoginInvalid",type:"confirm",title:g.t("ç™»å½•çŠ¶æ€å·²å¤±æ•ˆï¼Œæ˜¯å¦å°†ä¿¡ä»¶å†…å®¹ä¿å­˜åˆ°æœ¬åœ°ç”µè„‘ï¼Ÿ")+"<br>"+g.t("ï¼ˆæç¤ºï¼šç™»å½•é‚®ç®±åï¼Œå†™ä¿¡æ—¶å†…å®¹å°†è‡ªåŠ¨æ¢å¤ï¼‰"),ok:function(){e.userDataSave(),e.data.set({status:"confirmExit",value:!1}),$.Support.relogin()}})},setSequence:function(e,t){this.data.sequence[e]=t},runSequence:function(e,t){var i=this,a=i.data,n=a.sequence[e];return"function"==typeof n&&("number"==typeof t?(i.addTimer("sequence"+e,(function(){i.runSequence(e)}),t),!0):(delete a.sequence[e],n(),!0))},getCallName:function(e,t){var i="ComposeCall"+this.module.createId("c");"object"!=h(window[i])&&(window[i]={});var a="f"+d.Z.getTime(0).valueOf();return void 0!==window[i][a]&&(a+="x"),window[i][a]=function(){if(t&&delete window[i][a],e)return e.apply(null,arguments)},i+"."+a},removeCallName:function(){var e="ComposeCall"+this.module.createId("c");"object"==h(window[e])&&b.each(window[e],(function(t){window[function(e){var t,i=this,a=i.module,n=i.data,o=n.get({element:"main"}),r=n.get({element:"succ"}),s={},c=n.get({element:"toolbar"});if(n.get({status:"curPage"})!=e){if("compose"==e)s.hide(),s.find("iframe").attr({src:"about:blank"}),o.show(),c.show();else if("success"==e){r.show(),o.hide(),c.hide();var l=a._child;l&&$(l.container).hide()}else"photo"==e&&((t=s.find("form")).empty(),s.setStyle({height:o.dom.offsetHeight+"px"}),s.show(),t.attr({action:i.attach.photoGetUrl()}),t.dom.submit(),o.hide(),c.hide());n.set({status:"curPage",value:e})}},setOption:function(e,t){if(e){e.module="compose",e.noFire=!0,r.default.setAttr(e),"boolean"!=typeof t&&(t=!1),this.fireOption([e],!t);var i=e.flag?e.flag:e.field,a=e.value,n={};n[i]=a,k.cache(n,$.EMPTYFUNC)}},fireOption:function(e,t){var a=this,n=a.data,o=a.event,r=a.form,l="",d="";if($.Array.each(e,(function(e,u){var p="",f=u.flag?u.flag:u.field,h=u.value;switch(f){case"ntes_htmlbar":var v=2!=h;a.editor.setHtmlbar({show:v,hide:!v});break;case"compose_nav":o.switchNav(h);break;case"compose_showContacts":var b="1"!=h;o.switchSide({show:b});break;case"remindShow":x.contactCorrect="0"==h;break;case"requirereceipt":var y="1"==h;r.setCheckbox("receipt",y);break;case"true_name":case"nick_name":case"displaysender":var k=n.get({component:"sender"}),S={type:"sender",tabindex:"2",raiaLabel:g.t("å‘ä»¶äººåœ°å€ï¼Œç‚¹å‡»å¯ä»¥è®¾ç½®å‘ä»¶äºº")},w=[];try{var T=c.default.getList(),C=c.default.getDefault();$.Array.each(T,(function(e,t){var i=$.String.encodeHTML(t.toString()),a=s.Z.getSubtype({type:"folder",domain:t.domain});"dft"==a&&(a="other"),w.push({text:i,icon:{type:"folder",subtype:a},click:function(){k.setValue(t)}})})),S.email=C;var _={xtype:"menu",groups:[{items:w},{items:[{text:g.t("è®¾ç½®é»˜è®¤å‘ä»¶äººä¸æ˜µç§°"),click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.deCenterModule",exit:!1,inputName:"SectionSenderManage"})})))}}]}]info("compose senderlist update error"+e)}break;case"flashupload":case"replySign":case"forwardSign":case"signPosition":case"upload_mode":p=g.t("è®¾ç½®æˆåŠŸï¼Œä¸‹æ¬¡è¿›å…¥å†™ä¿¡ç”Ÿæ•ˆ"),l="Compose_NoGuide_Tips_SetSuccess",d=f,n.set({status:"empty",value:!1});break;case"signUpdate":case"cache":n.set({status:"empty",value:!1})}t&&p&&$.Tips.show({statsKey:l,statsValue:d,text:p})})),!t)try{var u=n.get({component:"toolbar"}),p=a.view.getOption();u.find("button")[5].menu.update(p)}catch(e){m.$D.info("compose from toolbar find menu error"+e)}},preview:function(){var e=this,t=T.getUrl("compose_preview"),i=e.getCallName((function(){var t=e.data,i=e.form,a={};a.sender=i.getSender(),t.get({status:"useSeparate"})?a.separate=i.getContact("suc","separate"):(a.to=i.getContact("suc","to"),a.cc=i.getContact("suc","cc"),a.bcc=i.getContact("suc","bcc"));var n=i.getSubject();return n=n?$.String.escapeHTML(n):g.t("(æ— ä¸»é¢˜)"),a.subject=n,a.editor=e.editor.getPreview(),a.attach=e.attach.getPreview(),a}));t+="&call=window.opener."+i;var a=document.createElement("FORM");a.action=t,a.method="POST",a.target="_blank",a.rel="opener"t",n.value=e.editor.getFinal(),a.appendChild(n),document.body.appendChild(a),a.submit()},tips:function(e,t){try{var i;if("string"==typeof e)e?$.Tips.module({statsKey:t||"",text:e},i):$.Tips.module();else if(void 0===e)$.Tips.module(e,i);else{var a=e;a.statsKey=t,$.Tips.module(a,i)}}catch(e){m.$D.debug("$.Tips.module Error"+e)}},trans:function(e){if(x.human_trans){var t=this,i=t.module,ar,o=t.info,r=i.createId("ext"),s=e.action;if("goHuman"!=s){if("0"===w.get({field:"huodong_option",flag:"humanTrans"})&&!a.get({status:"humanTransTips"}))switch(s){case"check":var c=n.get({html2text:!0});c.length>20&&(c=c.substr(0,300),null===(c=$.String.trim(c)).match(/[^\x00-\x80]/g)&&t.trans({action:"dict"}));break;case"dict":a.set({status:"humanTransTcls:"wn1",subclass:"assistBlock",params:"hasClose",items:[{html:"<span><span class='nui-block-icon'><b class='nui-ico nui-ico-transl+g.t("æ‚¨æ­£åœ¨è¿›è¡Œè‹±æ–‡ç¼–è¾‘ï¼Œå¦‚æœ‰éœ€è¦å¯ä½¿ç”¨ ")+"</span></span>"},{xtype:"link",text:g.t("æŸ¥è¯å…¸"),click:function(){(0,m.$E)("product.Translate",(function(e){e.change()})),k.cache({cl_trans:"2"},$.EMPTYFUNC)}},{html:"<span>"+g.t(" åŠŸèƒ½ ")+"</span>"},{xtype:"link",text:g.t("ä¸å†æé†’"),click:function(){w.set({field:"huodong_option",flag:"humanTrans",value:"1"}),this.ownerCt.destroy()}}]};new $.Block(l),k.cache({cl_transshow:"2"},$.EMPTYFUNC);break;case"replyTrans":a.get({moduleId:"ext"}),l={renderTo:r,renderBy:"before",extcls:"wn1",subclass:"assistBlock",params:"hasClose",items:[{html:"<span><span class='nui-block-icon'><b class='nui-ico nui-ico-translate'></b></span><span style='padding-left:20px;'>"+g.t("è¯•è¯•ç”¨ä¸­æ–‡å†™é‚®ä»¶ï¼Œ")+"</span></span>"},{xtype:"link",text:g.t("ç½‘æ˜“ä({action:"auto",call:function(){t.trans({action:"goHuman",vendor:"reply"})}}),k.cache({cl_trans:"3"},$.EMPTYFUNC)}},{html:"<span>"+g.t("å¸®æ‚¨å®Œæˆç¿»è¯‘ã€‚ ")+"</span>"},{xtype:"link",text:g.t("ä¸å†æé†’"),click:function(){w.set({field:"huodong_option",flag:"humanTrans",value:"1"}),this.ownerCt.destroy()}}]},new $.Block(l),k.cache({cl_transshow:"3"},$.EMPTYFUNC)}}else{var d=(o=t.info).get({did:!0})||o.get({mid:!0});(0,m.$E)("product.Translate",(function(t){t.goHuman({mid:d,vendor:e.vendor})}))}}},checkNotary:function(){var e=this,t=e.module.editor;x.notary&&f.default.getNotaryInfo((function(i){(i.isPrivilege||i.singleBalance>=1)&&i.isAutoArchive?e.initNotary(i):t.notaryCheck(i.singleBalance)}),(function(){}))},initNotary:function(e){var t=this.module,i=(t.data,t.editor),a=(t.event,e.isPrivilege&&e.isAutoArchive);t.notary||this.createNotary(e),a?i.hideNotaryBtn():i.showNotaryBtn()}r t=this.module,a=t.data,n=(t.editor,t.event);Promise.resolve().then(i.bind(i,19916)).then($.Function.bind((function(e){var i=new(0,e.default)(t);i.init(),t.notary=i;var o=t.notary.toggle({click:!0});o&&n.extActive();var r=a.get({component:"notary"});r&&r.setChecked(o,!0)})))},getMailTraceSnippet:function(e,t,i,a){var n=[e,t,i,a.toString()].join(","),o=$.D5")).encode(n);return{html:'<img style="width:1px;height:1px" src="https://count.mail.163.com/beacon/webmail.gif?type=webmail_mailtrace&guid='+o+'" >',hash:o}},genTraceInfo:function(e){var t,i=this,a=i.module,n=a.data,o=(a.attach,a.mailtrace,i.sendBuild()),r=[];o||(o=i.sendBuild()),t=o.to.concat(o.cc,o.bcc),$.Array.each(t,(function(e,t){r.push($.Uri.getAte).getTime(),c=i.getMailTraceSnippet(o.account,o.to,o.subject,s),l=(o.to.concat(o.cc,o.bcc),{from:o.account,to:o.to,subject:o.subject,timeStamp:s,hash:c.hash,htmlSnippet:c.html,receiverList:r,spMode:t.length>=2,tracedAttInfo:[]});return e&&e.encrypt_id&&(l.encrypt_id=e.encrypt_id),n.set({status:"sendTraceInfo",value:l}),l},clearTraceInfo:function(){var e=this.module.data;e.set({status:"sendTraceInfo",value:null}),e.set({status:"cloudLinksUpdated",value:!1})},getComposeLogInfo:function(){var e=this,t={},i=e.module,a=i.attach,n=i.data.get({status:"sendParam"}),o=a.fileGet(),r=0,s=0;$.Array.each(o,(function(e,t){t.cloud?r++:s++}));try{t.cloudFileCount=r,t.normalFileCount=s,t.fileCount=o.length,t.bigattachMasterDownLoad=r>0&&$.Ext.composeDownalodLink,$.Object.extend(t,e.getRecInfo()),n&&n.body&&n.body.attrs&&(t.saveSentCopy=n.body.attrs.saveSentCopy),t.isMbr=$.Ud.udProxy["product.vipMember"],t.composeTime=e.composeTime}catch(e){console.log(e)}return t},getRecInfo:function(){var e={},t=this.module.data.get({status:"sendParam"});return t.recList&&(e.totalRecvCount=t.recList.length,e.ntesCount=0,e.ntesGroupCount=0,e.notNtesCount=0,e.mapCount={},$.Array.each(t.recList,(function(t,i){if($.Email.checkFree(i)||$.Email.checkVip(i))e.ntesCount++;else{e.notNtesCount++;var a=i.split("@")[1];a&&(e.mapCount[a]||(e.mapCount[a]=0),e.mapCount[a]++)}}))),e},destroy:function(){var e=this,t=e.data,i=e.event;if(e.info.get({cid:!0})){var a=!1;t.get({status:"confirmDeleteDraft"})||!t.get({status:"existActiveDraft"})&&e.info.get({did:!0})&&(a=!0),e.action.cancelId({deleteDraft:a,callback:null}),e.info.set({cid:""})}e.clearTimer(),e.attach.destroy(),e.assist.destroy(),t.set({status:"curPage",value:"destroy"}),e.tips(""),$.Tips.show({hidden:!0}),e.removeCallName(),e.releaseSubscriber(),i.toggleScheduleInvitation(!0);var n=e.module;$.Array.each(n.names,(function(e,t){n[t].clear()})),$.Array.each(["param","class","module","names","stationery"],(function(e,t){n[t]=null,delete n[t]}))},marketingInit:function(){var e=this.module;function t(t,i,a){if(t&&t.config&&t.config.content){if(u=i,p=(0,m.$S)("uid")+"compose_mkttips_"+u,$.LocalStorage.get(p))return;var n=t.config.content,o=t.strategyId,r=t.config.renderTo||"."+i,s=t.config.cssText||"position:absolute;top:-12px;right:-12px;height:16px;line-height:16px;font-size:12px;;color:#fff;padding:0 4px",c=document.createElement("div"),l=e.find(r);c.style.cssText=s,c.innerText=n,c.classList.add("mkt_strategyid_"+o);var d=$(l);d.append(c),d.listen("click",(function e(){c.style.display="none";var r=t.showLimit.gapDays;!function(e,t){var i=(0,m.$S)("uid")+"compose_mkttips_"+e;$.LocalStorage.set(i,1,{expires:t})}(i,r),d.unlisten("click",e),$.Log.cache({compose_mkt_tips_click:{strategyId:o,content:n,type:a}})})),setTimeout((function(){$.Log.cache({compose_mkt_tips:{strategyId:o,content:n,type:a}})}),1e3)}var u,p}$.Support.getMarketingPositionData({key:"mailTrackConfig",callback:function(e){t(e,"mkt_mailtrace_setting_tips","mailTrackConfig")}}),$.Support.getMarketingPositionData({key:"mailSafeConfig",callback:function(e){t(e,"mkt_mailprotection_setting_tips","mailSafeConfig")}})},subjectKeywordMarketingInit:function(){var e=this.module.data;function t(t){try{var i=JSON.parse(t.responseText||t.response);e.set({subjectMktKeywordConfig:i})}catch(e){}}var i=$.Uri.getUrl("compose_subject_keyword",!0);try{$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:i,call:function(e){t(e)}})}catch(e){try{var a=new XDomainRequest;a.open("GET",i),a.onload=function(){t(a)},a.send()}catch(e){}}},eventFire:function(e){var t=this._events[e];if(t){t=t.slice(0);for(var i=[].slice.call(arguments,1),a=0,n=t.length;a<n;a++)t[a].apply(this,i)}},eventListen:function(e,t){return this._events[e]||(this._events[e]=[]),this._events[e].push(t),function(){for(var i=this._events[e],a=i.length-1;a>-1;a--)i[a]!=t&&t||i.splice(a,1)}},trigger:function(e){this.eveontentLoaded:function(e){this._firedEvents.ComposeContentLoaded?e():this.eventListen("ComposeContentLoaded",e)},composeTimeStart:function(){this.preStayTime=(new Date).getTime()},composeTimeAdd:function(){var e=(new Date).getTime();this.composeTime+=e-this.preStayTime,this.preStayTime=e},isNonPayingUser:function(){return!this.data.get({status:"vipMemberction(e,t){var i=this.module.name;$.Listener.fire(e,{moduleName:i,value:t})},fromComposeEvent:function(e){var t=this.module.name;return new v((function(i){var a=function(){arguments[0].moduleName==t&&i.next.apply(i,arguments)};return $.Listener.listen(e,a),{unsubscribe:function(){$.Listener.unlisten(e,a)}}}))},fromComposeE((function(i){var a=function e(){if(arguments[0].moduleName==t){var a=arguments[0].value;$.Object.isEqual(e.value,a)||(e.value=$.Object.clone(a),i.next.apply(i,arguments))}};return $.Listener.listen(e,a),{unsubscribe:function(){$.Listener.unlisten(e,a)}}}))},getExtensionConflictInfo:function(e){var t=this,i=t.extensioinConflict[e];if(i&&i.length){var a=t.module,n=a.data,o=a.getEl("main"),r=t.extensionInfo,s=r[e].name,c=$.Array.map(i,(function(e,t){var i=r[t].name;return{key:t,name:i,text:g.t("{source}ä¸{target}åŠŸèƒ½æ— æ³•åŒæ—¶ä½¿ç”¨ã€‚").replace("{source}",g.t(s)).replace("{target}",g.t(i)),composeKlass:a[t]||null,cmp:n.get({component:t})}})),l=[];return $.Array.each(c,(function(e,t){var i,a=t.cmp&&t.cmp.getChecked(),o="show"+((i=t.key).charAt(0).toUpperCase()+i.slice(1)),r=n.get({status:o});(a||r)&&l.push(t)})),{mainEl:o,sourceExtensonId:e,sourceName:s,conflictInfoList:c,enabledConflictInfoList:l}}},handleExtensionConflict:function(e,t,i){var a=this.getExtensionConflictInfo(e);if(a){var n=a.enabledConflictInfoList,o=a.sourceName,r=a.conflictInfoList,s=a.mainEl;if(n.length)var c=$.Array.map(n,(function(e,t){return t.name})).join("ï¼Œ"),l=$.Array.map(n,(function(e,t){return t.key})),d=c+(n.length>=2?"ç­‰":""),u=o+"åŠŸèƒ½ä¸"+d+"åŠŸèƒ½æ— æ³•åŒæ—¶ä½¿ç”¨ã€‚ä¸ºä¸å½±å“æ‚¨çš„é‚®ä»¶å‘é€ï¼Œå»ºè®®æ‚¨æœ¬æ¬¡å‘ä¿¡å…³é—­"+d+"åŠŸèƒ½ã€‚",m=$.Msgbox.show({statsKey:"Compose_Guide_Popup_"+e+"_Conflict",statsValue:{reason:l},title:'<p style="color:#394051;">'+o+g.t("æç¤º")+"</p>",content:'<p style="color:#585E6D;" >'+u+"<p/>",buttons:[{text:g.t("ç¡®è®¤å…³é—­"),subclass:"mainBtn",click:function(){p(),m.hide(),t&&t()}}],close:function(){i&&i()}});else p()}function p(){$.Array.each(r,(function(e,t){t.cmp&&(t.cmp.getEl().listen("mouseenter",(function(){var e;(e=t.text,new $.Layer({extcls:"Sky-gCmp-main-mailprotection-popup",items:[{html:g.t(e)}],renderTo:s.dom,params:"hasArr arrDown",onRender:function(){$.Component.setEvents()},listeners:[{name:"destroy",handler:function(){}},{name:"hide",handler:function(){this.destroy()}}]})).pointTo(this,$.fly(s.dom))})),t.cmp.getEl().listen("mouseleave",(function(){$.Layer.hideAllLayer()})),t.cmp.setChecked(!1,!0),t.cmp.setDisabled(!0)),t.composeKlass&&t.composeKlass.toggle({close:!0})}))}},resetExtensionConflict:function(e){var t=this.module,i=(t.data,t.getEl("main"),this.getExtensionConflictInfo(e));if(i){var a=i.conflictInfoList;$.Array.each(a,(function(e,t){t.cmp&&(t.cmp.getEl().unlisten("mouseenter"),t.cmp.getEl().unlisten("mouseleave"),t.cmp.setDisabled(!1)),t.composeKlass&&t.composeKlass.statusRestore&&t.composeKlass.statusRestore()}))}}};b.inherit(_,a.Z),b.extend(_.prototype,I),t.Z=ass($N("module.compose.ComposeData")),r={initialize:function(e){n.extend(this,{index:0,delayTime:33,saveTextThreshold:1048576,timer:{},sequence:{},change:{},layout:{},element:{},component:{},letterpaper:{},log:{},blackList:{},network:!0,status:{fromEntry:"",entryExtends:{},curPage:"compose",inputChoose:"to",sendParam:null,defaultContent:"",uploadParam:null,uploadMode:null,flashReady:!1,moduleOut:!1,empty:!0,fullScreen:!1,paramBody:null,autoSave:!0,autoSaveTime:2,existActiveDraft:!1,sendCheckCount:0,initTimer:!1,initSign:!1,initAddress:!1,initStationery:!1,chargeSmsData:null,useSms:null,useSign:null,useSeparate:null,showTo:!0,showCc:!1,showBcc:!1,showScheduleInvitation:!1,iKnowScheduleInvitationNotSave:!1,showSide:!1,showSchedule:!1,showEncrypt:!1,save2YNote:!1,showHtmlbar:!0,showPlaceholder:!1,confirmDeleteDraft:!0,confirmAttach:!0,confirmSubject:!0,confirmStoargeFileNoTrace:!1,confirmExit:!0,saveContact:!0,usedCloudFile:!1,cloudLinksUpdated:!1,firstCloudFileSend:!1,sendTraceInfo:null,renewedCloudLinks:null,useWmsvr:!1,humanTransTips:!1},subjectMktKeywordConfig:{},attachments:{files:{},element:{link:null,browseContainer:null,input:null,formContainer:null,formIframe:null,flash:null,flashContainer:null,nativeRequest:null,area:null,info:null,content:null,ulContainer:null,progress:null},tips:{},layout:{attachWidth:285,spaceWidth:8},status:{notaryBalance:void 0,validServer:!1,layoutInit:!1,confirmSize:!1,cloudTrigger:!1,flashTimer:!1,cardUrl:"",totalPercent:-1,totalBytes:-1,flashIndex:0,fileIndex:1,inputIndex:1,inlinedExist:0,vipMember:!1,remindShowId:0,showContactsId:0}}}),o.superClass.initialize.call(this,e)},init:function(){o.superClass.init.call(this)},set:function(e){var t=this,i=t.module,a=e.value;if("string"!=typeof e.status)if("string"!=typeof e.element)if("string"!=typeof e.component)if("string"!=typeof e.moduleId)e.hasOwnProperty("subjectMktKeywordConfig")&&(t.subjectMktKeywordConfig=e.subjectMktKeywordConfig);else{var n=$("#"+i.createId(a));t.element[e.moduleId]=n}else t.component[e.component]=a;else t.element[e.element]=a;else t.status[e.status]=a},get:function(e){var t=this,i=t.module;return"string"==typeof e.status?t.status[e.status]:"string"==typeof e.element?t.element[e.element]:"string"==typeof e.component?t.component[e.component]:"string"==typeof e.moduleId?$("#"+i.createId(e.moduleId)):"subjectMktKeywordConfig"===e?t.subjectMktKeywordConfig:void 0}};n.inherit(o,a.Z),n.extend(o.prototype,r),t.Z=o},60504:function(e,t,i){i(55737),i(803),i(42295),i(34994),i(15761),i(20869),i(63518),i(75654),i(26340),i(79150),i(36809),i(15296),i(92274),i(67285),i(52963),i(66403),i(37092),i(63045),i(48868),i(81874),i(54861);var a=i(10487),n=i(95949),o=i(87253),r=i(72957),s=i(89308),c=new r.c1("module.compose.ComposeEditor"),l=$.Object,d=($.Function,$.Browser),u=$.Ext,m=$.Log,p=$.Ud,f=$.createClass((0,r.$N)("module.compose.ComposeEditor")),h={initialize:function(e){l.extend(this,{component:{sign:null,portrait:null,stationery:null},mode:null,editorCmpt:null}),f.superClass.initialize.call(this,e)},init:function(){this.element,f.superClass.init.call(this)},clear:function(){f.superClass.clear.call(this.component),f.superClass.clear.call(this)},create:function(){var e=this,t=e.base;try{e.render()}catch(i){t.addTimer("editor",(function(){try{e.render()}catch(e){}}),100)}},render:function(){var e=this,t=(e.module,e.data),i=(t.layout.editorHeight,o.Z.mode.BASIC);1==p.get({field:"ntes_letter",flag:"editorToolbar"})&&(i=o.Z.mode.B;var a=t.get({component:"editor"});e.editorCmpt=a,a.composeEditor=e,e.custom(),e.bindEvent(),e.hideNotaryBtn(),a.listen("selectionChanged",(function(){e.setPlaceholder({show:!1})})),"0"==p.get({field:"ntes_compose",flag:"editor_notary_tips"})&&(1==p.get({field:"ntes_letter",flag:"editorToolbar"})||2==p.get({field:"ntes_htmlbar"})||setTimeout((function(){e.showLayer()}),1e3))},custom:function(){var e=this,t=e.editorCmpt;t.rendered?setTimeout((function(){e.initNewTips()}),200):t.listen("afterRender",(function(){setTimeout((function(){e.initNewTips()}),200)})),f.initPlugin||(f.initPlugin=!0,$.Array.each(["Capture","Image","Portrait","Microphone","Sign","Stationery","Basic","Translate","Notary","Full","FullScrd=e["btn"+a]})),t.plugin.Capture.selected=e.btnCapture,t.plugin.Image.selected=e.btnImage,t.plugin.Portrait.selected=e.btnPortrait,t.plugin.Microphone.selected=e.btnMicrophone,t.plugin.Sign.selected=e.btnS.Full.selected=e.btnMode)},bindEvent:function(){var e=this,t=e.module,i=e.event,a=e.form,n=e.editorCmpt;if(n.listen("iframeClick",$.Function.bind(i.hideFloat,i)),n.listen("iframeKeydown",$.Function.bind(e.keyPress,e)),n.listen("modeChanged",$.Function.bind(e.modeChange,e)),$.Ext.activityChristmas){n.listen("iframeKeyup",(function(){var i=e.get({html2text:1});$.Support.showChristmasRain(i,t._expando)}));var o=a.data.get({component:"subject"});o.listen("keyup",(function(e){var i=o.getValue();$.Support.showChristmasRain(i,t._expando)}))}e.bindPasteEvent()},bindPasteEvent:function(){var e=this,t=$(e.getWindow()),i=$(t.dom.document),a=$(i.dom.body);($.Browser.ie()?a:i).listen("paste",$.Function.bind(e.pasteAction,e))},getPasteConvertType:function(e){return e.indexOf('xmlns:x="urn:schemas-microsoft-com:office:excel"')>-1?"excel":e.indexOf('xmlns:w="urn:schword":e.indexOf("ksdocclipboard=")>-1?e.indexOf("WPS Spreadsheets 6.0 Format")>-1?"wpscloud-excel":"wpscloud-word":e.indexOf('<table id="zongheng-ccp-host"')>=0?"dingding-excel":e.indexOf("data-clipboard-cangjie=")>=0?"dingding-word":e.indexOf('data-lark-record-format="docx/record"')>=0?"feishu-word":e.indexOf("<byte-sheet-html-origin")>=0?"feishu-excel":e.indexOf("data-byte-bitable=")>=0?"feishu-duowei-table":e.indexOf('data-html-origin="lx-sheets"')>=0?"lingxi-excel":e.indexOf("yne-bulb-block=")>=0?"lingxi-word":0===e.indexOf("<html>")?"web":"text"},convertsteConvertType(e);$.Log.cache({compose_editor_paste:{from:i}});var a="";switch(i){case"excel":a=t.convertExcel(e);break;case"web":a=t.convertHtml(e);break;default:a=e}return a},convertExcel:function(e){var t=this,i="<div>"+("function"==typeof window.DOMParser){var a=(new DOMParser).parseFromString("<html><head></head><body>"+i+"</body></html>","text/html").body.children[0],n=Element.prototype.getElementsByTagName.apply(a,["STYLE"]);n=[].slice.call(n,0);var o=window.Object.getOwnPropertyDescriptor(HTMLStyleElement.prototype,"sheet").get.apply(n[0]).cssRules;(o=Array.prototype.filter.call(o,(function(e){return e instanceof CSSStyleRule||e.type==CSSRule.STYLE_RULE}))).sort((function(e,i){return e=t.handleSelector(e.selectorText),i=t.handleSelector(i.selectorText),t.compareSelector(e,i)}));for(var r,s=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,null,!1),c=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;r=s.nextNode();){for(var l=r.style.cssText,u=0;u<o.length;u++)c.apply(r,[o[u].selectorText])&&r.style&&(r.style.cssText+=o[u].cssTextssText+=l}var m=a.innerHTML.split("<table");return"<table"+m[1].slice(0,m[1].indexOf("</table>"))+"</table>"+"<div><br /></div>"}},convertHtml:function(e){var t=document.createElement("div"),i=e.replace(/\s*(<html>|<\/html>|<body>|<\/body>)\s*/g,"");t.innerHTML=i.replace(/<!--[\w\s]*-->/g,"");for(var a=t.querySelectorAll("*"),n=0;n<a.length;n++){var o=a[n],r=o.style.position;r&&"fixed"===r.toLowerCase()&&o.parentNode.removeChild(o)}var s=t.innerHTML;return t.innerHTML="",s},set:function(e){var t=this.editorCmpt;return this.setPlaceholder({show:!1}),"string"==typeof e.html?t.setContent(e.html,t.editMode||o.Z.mode.BASIC):"string"==typeof e.text?t.setContent(e.text,t.editMode||o.Z.mode.TEXT):t.setContent(e)},setMode:function(e){this.editorCmpt.changeMode(e)},setSize:function(e){this.editorCmpt.setSize(e)},setOriginal:function(e,t){var i=this,a=i.data,n=a.get({status:"fromEntry"}),o=a.get({status:"paramBody"});if(-1!=e.indexOf(c.t("é™„ä»¶"))&&a.set({status:"confirmAttach",value:!1}),"text"==t&&("edit"==n||"draft"==n||"timeset"==n||(t="html",e=["<pre>","<br>",e=$.String.encodeHTML(e),"</pre>"].join(""))),"html"==t&&(e=e.replace(/<img style="width:\s?1px;\s?height:\s?1px"\s?src="https:\/\/count\.mail\.163\.com\/beacon\/webmail\.gif\?type=webm=n||"forward"==n)){e=e.replace(new RegExp('id="*(spnEditorSign|divEditorGraphSign|divNeteaseMailCard)"*',"ig"),"");var s="0";try{s=p.get({field:"ntes_option",flag:"signPosition"})}catch(e){}if("0"==s){var l=o.defaultContent||"";l+=i.getBreakLine(5),l+='<div id="spnEditorSign" style="position:relative;zoom:1"></div>',(0,r.$S)("isFree")?l+='<div id="divNeteaseMailCard"></div>':(0,r.$S)("isVip")&&(l+='<div id="divEditorGraphSign"></div>'),e=(l+=i.getBreakLine(1))+e}else{var u=o.defaultContent||"";e=(u+=i.getBreakLine(5))+e}}if("html"==t){if(e)switch(i.set({html:e}),d.getInfo().os){case"ipad":case"ipod":case"iphone":case"android":i.switchText({text:!0,force:!0})}}else i.set({text:e});i.sign.load(),i.checkTips()},setHtmlbar:function(e){e=e||{};var t=this,i=(t.base,t.data),a=i.get({status:"showHtmlbar"});if(e.show==a)return!1;var n=t.editorCmpt;if(n.editMode==o.Z.mode.TEXT);else if(a)t.mode=n.editMode,t.setMode(o.Z.mode.HIDE);else{var r=t.mode||o.Z.mode.BASIC;t.setMode(r)}return i.set({status:"showHtmlbar",valulder:function(e){if($.Ext.composeAt){e=e||{};var t=this,i=(t.base,t.module,t.data),a=t.editorCmpt,n=i.get({status:"showPlaceholder"});if(e.show==n)return!1;var o=e.text||c.t("å°è¯•ä¸‹å†™ä¿¡è¾“å…¥@ï¼Œ@è”ç³»äººåç³»ç»Ÿè‡ªåŠ¨æŠŠæ­¤äººåŠ åˆ°æ”¶ä»¶äºº"),r=i.get({mocomponent:"editorPlaceholder"});return s||(function(e,t,i){try{var a=0,n=0,o=t.dom||t,r=o;i=i&&i.dom||i||$.Component.getScrollParent(r)||document.body;do{a+=o.offsetTop||0,n+=o.offsetLeft||0,o=o.offsetParent}while(o&&o!==i&&o!==i.offsetParent);e.dom.style.left=n+10+"px",e.dom.style.top=a+10+"px"}catch(e){}}((s=new $.Component({html:'<div class="iy1">'+o+"</div>",renderTo:r,listeners:{click:{handler:function(){t.focus(),t.setPlaceholder({show:!1})}}}})).getEl(),t.editorCmpt.iframe,$.fly(r)),i.set({component:"editorPlaceholder",value:s})),a&&a.getContent("basic","text").replace(/\n/g,"")?(i.set({status:"showPlaceholder",value:!1}),s.hide(),!0):(e.show?s.show():s.hide(),i.set({status:"showPlaceholder",value:e.show}),!0)}},get:function(e){e=e||{};var t=this,i=t.data,a=t.editorCmpt;if(e.empty){var n=i.get({status:"defaultContent"});return t.isEmpty(n)}return"string"==typeof e.id?a.getIframeEl("#"+e.id):"string"==typeof e.tag?a.getIframeEl(e.tag):e.html?a.getContent(o.Z.mode.BASIC,"html"):e.html2text?a.getContent(o.Z.mode.BASIC,"text"):e.text?a.getContent(o.Z.mode.TEXT,"text"):a.getContent()},getMode:function(){return this.editorCmpt.editMode},getPreview:function(){return this.editorCmpt.getPreviewContent()},getFinal:function(e){var t=this.editorCmpt,i=t.editMode,a=i==o.Z.mode.TEXT?"text":"html",n="";try{return n=t.getFinalContent(i,a),e&&(n=t.filterDisplayNone(n)),n}catch(e){return""}},getWindow:function(){return this.editorCmpt.win},getBreakLine:function(e){return this.editorCmpt.getBreakLine(e)},getCloudLinks:function(){var e=this.editorCmpt.doc.body.querySelectorAll("#divNeteaseBigAttach"),t={};return $.Array.each(e,(function(e,i){var a=i.querySelectorAll("a");$.Array.each(a,(function(e,i){if(!i.classList.contains("bigattach-mailmaster-download")){var a=i.getAttribute(.href]&&i.href&&a&&(t[i.href]={href:i.href,fileName:a})}}))})),t},updateCloudLinks:function(e){for(var t=this.editorCmpt.doc.body.querySelectorAll("#divNeteaseBigAttach"),i=0;i<t.length;i++)for(var a=t[i].querySelectorAll("a"),n=0;n<a.length;n++){var o=a[n],r=e[o.href];r&&(o.href=r)}},isEmpty:function(e){var t=this.editorCmpt,i=t.getContent();return!/img/i.test(i)&&(i==e||!(i=$.String.trim(t.getContent(t.editMode,"text"))))},isTextMode:function(){return this.getMode()===this.editorCmpt.MODE.TEXT},remove:function(e){this.editorCmpt,this.editorCmpt.del(e)},focus:function(e){this.editorCmpt.focus(e)},insert:function(e){var t=this,i=t.editorCmpt;e.html&&(i.insertHtml(e.html),t.setPlaceholder({show:!1})),e.image&&(i.insertImage(e.image),t.setPlaceholder({show:!1}))},switchText:function(e){e=e||{};var t=this,i=t.editorCmpt,a=t.data.get({status:"showHtmlbar"}),n=e.text;if(n==("text"==i.editMode))return!1;if(n)e.force?(a&&(t.mode=i.editMode),t.setMode(o.Z.mode.TEXT),t.form.setCheckbox("text",!0,!0)):t.get({empty:!0})?t.switchText({text:!0,force:!0}):$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_Text",type:"confirm",title:c.t("å°†æ­¤é‚®ä»¶è½¬æ¢ä¸ºçº¯æ–‡æœ¬å°†ä¼šé—å¤±æŸäº›æ ¼å¼ï¼Œæ‚¨ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ"),ok:function(){t.switchText({text:!0,force:!0})}});else{var r=a?t.mode:o.Z.mode.HIDE;t.setMode(r),t.form.setCheckbox("text",!1,!0)}},keyPress:function(e){var t=this,i=t.base;u.shortcut&&(e.ctrlKey||e.metaKey)&&83==e.keyCode&&(i.getAction()||(d.chrome()?i.addTimer("save",(function(){try{i.send({action:"save"})}catch(e){}}),500):i.send({action:"save"}))),27==e.keyCode&&setTimeout((function(){t.data.get({moduleId:"editor"}).dom.nextSiblilder({show:!1})},modeChange:function(e){var t=this,i=t.module,a=i.data,n=i.base;a.get({status:"fullScrren"}),t.editorCmpt,t.setPlaceholder({show:!1}),n.checkNotary()},portraitAdd:function(e){var t=this,i=t.editorCmpt,a=t.component;0===e.indexOf("//")&&(e="https:"+e);var n=e.split("/"),o=n.pop();n.pop();var r=n.pop();a.portrait.hide(),"E-Meow"===r?i.exec("insertImage",{src:e,style:{width:"40px",height:"40px"}}):i.insertPortrait(e),t.setPlaceholder({show:!1}),$.Log.cache({editor_portrait_click:{name:r,fullName:o}})},oSelectorWeights:g,compareSelector:function(e,t,i){i=i||this.compareLength;for(var a=Math.min(e.length,t.length),n=0;n<a;n++){var o=i(e[n],t[n]);if(0!==o)return o}return this.compareLength(e.length,t.length)},compareLength:function(e,t){return e>t?1:e<t?-1:0},handleSelectorTwo:function(e,t,i,a){return e.replace(i,(function(e){return t[a]+=1,new Array(e.length+1).join(" ")}))},handleSelector:function(e){var t=this;try{var i=t.oSelectorWeights.hasOwnProperty(e)?t.oSelectorWeights[e]:null;if(i)return i;var a=[0,0,0,0],n=e;return e=(e=e.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(new RegExp("{[^]*","gm"),""),e=t.handleSelectorTwo(e,a,/(\[[^\]]+\])/g,2),e=t.handleSelectorTwo(e,a,/(#[^\#\s\+>~\.\[:]+)/g,1),e=t.handleSelectorTwo(e,a,/(\.[^\s\+>~\.\[:]+)/g,2),e=t.handleSelectorTwo(e,a,/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,3),e=t.handleSelectorTwo(e,a,/(:[\w-]+\([^\)]*\))/gi,2),e=(e=(e=t.handleSelectorTwo(e,a,/(:[^\s\+>~\.\[:]+)/g,2)).replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),t.handleSelectorTwo(e,a,/([^\s\+>~\.\[:]+)/g,3),i=a,t.oSelectorWeights[n]=i,t.oSelectorWeights[n]}catch(e){return[0,0,0,0]}},pasteAction:function(e){var t=this,i=t.form,a=t.data;t.editorCmpt.fire("beforePaste"),"macintosh"==d.getInfo().os&&d.safari()&&t.compatibleSafariPasteImg();var n=e.clipboardData||window.clipboardData,o="";if(!d.isIE()&&(o=n.getData("text/html"))){var r=t.convertPasteContent(o);if(r!==o){e.preventDefault();try{t.editorCmpt.cmd.insertHtml(r)}catch(e){}}}if(setTimeout((function(){t.editorCmpt.fire("afterPaste",o),t.afterPaste(o)}),0),a.get({status:"confirmSubject"})&&""===i.getSubject()){var s=t.get({html2text:!0});setTimeout((function(){var e=t.get({html2text:!0}),i=s.length,a=e.length;if(!(i>3e3||a>3e3)){for(var n=0;n<i&&n<a&&s.charAt(i-n-1)==e.charAt(a-n-1);n++);var o=i-n,r=a-n;for(n=0;n<i&&n<a&&s.charAt(n)==e.charAt(n);n++);n<o&&(o=n);var c=(o==r?e:e.substring(o,r)).replace(/[\r\n]/gi,"");0===c.indexOf("http://")&&t.getSubject(c)}}),15)}},compatibleSafariPasteImg:function(){var e=this;setTimeout((function(){fororCmpt.doc.getElementsByTagName("IMG"),i=0;i<t.length;i++){var a=t[i];0!==a.src.indexOf("webkit-fake-url")&&0!==a.src.indexOf("blob")||(a.url=a.src,a.src="https://mimg.127.net/xm/webmail/img/local.png",a.unselectable="on",a.style.cursor="pointer",$(a).listen("click",(function(){var e=$.Uri.getUrl("compose_attach_fakeurl",!0)+"&url="+encodeURIComponent(a.url);window.open(e)})))}}),15)},getSubject:functiona;t.base,t.action.getSubject({url:e,callback:$.Function.bind(t.fillSubject,t),error:function(){return!0}}),i.set({status:"confirmSubject",value:!1})},fillSubject:function(e){var t=this.form;""===t.getSubject()&&e.code==$.S_OK&&t.setSubject(e.var.title)},checkTips:function(){if(u.editor_tips&&!f.loadTips){var e=this,t=$.Uri.getUrl("letterpaper_tips");$.Ajax.jsonp(t,(function(t){e.showTips(t)}),"jsonp")}},showTips:function(e){if(200==e.code&&(f.loadTips=!0,e.visible)){var t=this,i=t.module,a=t.stationery,n=t.data,o=(t.component,t.editorCmpt),r=o.editDv.dom,s=e.letter,l=s.name,d=s.iconUrl,u=$(o.toolbarDv.find(".APP-editor-commond-stationery").dom).offset().x-97-t.getPadding()+"px",p='<b class="nui-layer-arr"></b><div class="jn1">'+c.t("æ–°ä¿¡çº¸")+'</div><div id="'+i.createId("stationeryTips")+'" class="jo1"><a class="hr1" href="#"><img class="ih1" src="'+d+'" alt="'+l+'"></a></div><div class="jr1">'+l+"</div>",h=new $.Layer({renderTo:r,extcls:"mJ1",left:u,});m.cache({sh_stationery_tips:s.id},$.EMPTYFUNC),n.get({moduleId:"stationeryTips"}).listen("click",(function(e){a.select({item:s}),h.hide(),m.cache({cl_stationery_tips:s.id},$.EMPTYFUNC),m.cache({cl_stationery_paper:s.id},$.EMPTYFUNC)})),window.setTimeout((function(){h.hide()}),15e3)}},showLayer:function(){var e=this,t=(e.module,e.stationery,e.component,e.editorCmpt);t.rendered||t.listen("afterRender",(function(){e.showLayer()}))},notaryCheck:function(e){var t=this,i=t.module,a=i.action,n=i.data;if(n.get({component:"editor"}),u.notary){var o=e,s=n.get({status:"notaryBalance"});-1===o&&void 0===s?a.getNotaryBalance((function(e){e&&200===e.code?(e.single_num>0&&t.showNotaryBtn(),n.set({status:"notaryBalance",value:e.single_num})):r.$D.log(e)})):(t.showNotaryBtn(),n.set({status:"notaryBalance",value:o}))}},hideNotaryBtn:function(){var e=this.module.data,t=e.get({component:"editor"}),i=e.get({compon.APP-editor-commond-notary");n&&n.hide(),i&&i.hide()},showNotaryBtn:function(){var e=this.module.data,t=e.get({component:"editor"}),i=e.get({component:"notary"}),a=t.getEl(),n=$(a).find(".APP-editor-commond-notary");n&&n.show(),i&&i.show()},checkAt:function(e,t){},getPadding:function(){(0,r.$S)("clientWidth")||(0,r.$S)("clientWidth",document.documentElement.clientWidth);var e=0,t=(0,r.$S)("clientWidth");return t<=1680||(e=t<=1920?52:t<=2560?104:156),e},btnCapture:function(e,t,i){var a=this.composeEditor;"3"!=p.get({field:"ntes_compose",flag:"upload_mode"})?a.assist.captureStart():$.Msgbox.show({title:c.t("æ™®é€šé™„ä»¶ä¸Šä¼ æ¨¡å¼ä¸æ”¯æŒæˆªå›¾ï¼Œè¯·åˆ‡æ¢åˆ°é«˜çº§ä¸Šä¼ æ¨¡å¼")}),m.cache({cl_capture:"1"},$.EMPTYFUNC)},btnImage:function(){var e=this.composeEditor,t='<div class="nui-normalTabs nui-tabs"><div id="dvMsgBoxTab1" class="nui-tabs-item nui-tabs-item-selected">'+c.t("æˆ‘çš„ç”µè„‘")+'</div><div id="dvMsgBoxTab2" class="nui-tabs-item nui-tabs-item-hover">'+c.t("ç½‘å€URL")+'</div></div><ul class="APP-editor-insertPic-panel"><li id="liMsgBoxPanel1" class="APP-editor-insertPic-panel-item"><div class="APP-editor-insertPic-remark">'+c.t("ç‚¹å‡»â€œæµè§ˆâ€ï¼Œåœ¨æ‚¨ç”µè„‘ä¸­é€‰æ‹©è¦ä¸Šä¼ çš„å›¾ç‰‡ï¼Œæ¯å¼ å›¾ç‰‡ä¸Šä¼ å®Œæ¯•åå°†ä¼šè‡ªåŠ¨æ·»åŠ åˆ°æ­£æ–‡ä¸­")+'</div></li><li id="liMsgBoxPanel2" class="APP-editor-insertPic-panel-item" style="display:none"></li></ul>',i=null;i=$.Msgbox.show({header:c.t("æ·»åŠ å›¾ç‰‡"),content:t,extcls:"APP-editor-insertPic",contentType:"normal",autoFocus:!1,listeners:{afterRender:function(){new $.Button({renderTo:$("#liMsgBoxPanel1").dom.firstChild,text:c.t("æµè§ˆ"),subclass:"mainBtn",click:function(){if("3"!=p.get({field:"ntes_compose",flag:"upload_mode"})){if(n.Z.has());else if(e.attach.nativeClick){var t=e.attach,a=$("#inputFileImage");a||((a=$.Element.create("input")).css({visibility:"hidden"}),a.attr({id:"inputFileImage",type:"file",size:"1",multiple:!0,accept:"image/*"}),document.body.appendChild(a.dom)),a.one("change",(function(){var e=a.dom.files;if(e.length){e=$.Object.toArray(e),$.Array.each(e,(function(e,t){t.inlined=!0})),t.nativeSelect(e,void 0,"EditorBtnImage");try{a.dom.value=""}catch(e){}}})),a.dom.click()}else $.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentUploadMode",title:c.t("é™„ä»¶ä¸Šä¼ æ¨¡å¼å·²è¢«ä¿®æ”¹ï¼Œä½¿ç”¨æ–°æ¨¡å¼ä¸Šä¼ å›¾ç‰‡ï¼Œéœ€è¦é‡æ–°è¿›å…¥å†™ä¿¡ç”Ÿæ•ˆ")});i.close()}else $.Msgbox.show({statsKey:"Compose_Guide_Popup_AdvancedUploadMode",title:c.t("æ™®é€šé™„ä»¶ä¸Šä¼ æ¨¡å¼ä¸æ”¯æŒæœ¬åœ°å›¾ç‰‡ä¸Šä¼ ï¼Œè¯·åˆ‡æ¢åˆ°é«˜çº§ä¸Šä¼ æ¨¡å¼")})}}),new $.Button({renderTo:$("#liMsgBoxPanel1").dom.firstChild,text:c.t("å–æ¶ˆ"),click:function(){i.close()}}),new $.Component({html:"<span></span>",renderTo:"liMsgBoxPanel2",items:[{xtype:"input"},{xtype:"button",text:c.t("æ·»åŠ "),subclass:"mainBtn",click:function(){var t=this.ownerCt.find("input")[0],a=t.getValue();a&&"http://"!=a?(e.insert({image:a}),i.close()):t.showTips(c.t("è¯·è¾“å…¥åˆæ³•çš„åœ°å€"),"err")}},{xtype:"button",text:c.t("å–æ¶ˆ"),click:function(){i.close()}},{html:'<p class="APP-editor-insertPic-remark">'+c.t("è¯·åœ¨è¾“å…¥æ¡†é‡Œé¢å¡«ä¸Šè¦æ·»åŠ å›¾ç‰‡çš„URL")+"</p>"}]}),this.buttons.ok.hide()}}});var a=$("#dvMsgBoxTab1","#dvMsgBoxTab2"),o=$("#liMsgBoxPanel1","#liMsgBoxPanel2");a.listen("click",(function(e){var t=0,i=1;"dvMsgBoxTab2"==$.Event.getTarget(e).id&&(t=1,i=0),-1==a.doms[t].className.indexOf("nui-tabs-item-selected")&&($(a.doms[i]).setClass("nui-tabs-item nui-tabs-item-hover"),$(o.doms[i]).hide(),$(a.doms[t]).setClass("nui-tabs-item nui-tabs-item-selected"),$(o.doms[t]).show())})),m.cache({cl_image:"1"},$.EMPTYFUNC)},btnMicrophone:function(e,t,i){var a=this.composeEditor;if($.Browser.getVersion(),o=window.SpeechRecognition||window.webkitSpeechRecognition){var n='<div class="APP-editor-speech"><div class="nui-multiLineIpt nui-ipt"><textarea id="textAreaComposeVoice" class="nui-ipt-input"></textarea></div><div class="APP-editor-speech-tips nui-txt-tips nui-txt-s12"><span class="APP-editor-speech-tipsLeft">'+c.t("è¯·ç‚¹å‡»å›¾æ ‡")+'</span><button id="voiceButton" style="display:inline-block;padding:0;overflow:hidden;border:none;outline:none;" class="APP-editor-speech-iptOuter"><img alt="Start" id="start_img" src="https://mimg.127.net/p/js6/lib/img/mic/mic.gif" style="width: 100%;height: 100%;"></button><span class="APP-editor-speech-tipsRight">'+c.t("å¼€å§‹è¯­éŸ³è¾“å…¥")+"</span></div></div>";$.Msgbox.show({type:"confirm",contentType:"wide",header:c.t("è¯­éŸ³è¾“å…¥"),content:n,ok:function(){var e=$("#textAreaComposeVoice").dom.value;a.insert({html:e})}});var o,r=new(o=o||webkitSpeechRecognition);r.lang="zh-CN",r.interimResults=!1,r.maxAlternatives=1,r.onresult=function(e){var t=e.results[0][0].transcript;$("#textAreaComposeVoice").dom.value+=t},r.onstart=function(){$("#voiceButton").find("img").dom.src="https://mimg.127.net/p/js6/lib/img/mic/mic-animate.gif"},r.onspeechstart=function(){},r.onspeechend=function(){$("#voiceButton").find("img").dom.src="https://mimg.127.net/p/js6/lib/img/mic/mic.gif",r.stop()},r.onerror=function(e){var t="";switch(e.error){case"not-allowed":t=c.t("æ‰“å¼€è¯­éŸ³è¾“å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ˜¯å¦æœ‰è¾“å…¥è®¾å¤‡ï¼Œä»¥åŠéº¦å…‹é£æƒé™");break;case"network":t=c.t("è¯­éŸ³è¾“å…¥ç¿»è¯‘å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ");break;default:t=c.t("æœªçŸ¥é”™è¯¯")+"ï¼š"+e.error}$.Msgbox.show({title:'<p style="margin-top:-10px;">'+t+"</p>"})},$("#voiceButton").listen("click",(function(){r.start()}))}else{var s=c.t("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¾“å…¥åŠŸèƒ½ï¼Œå»ºè®®æ‚¨é€‰æ‹©")+"<br/>"+c.t("Google Chromeæµè§ˆå™¨è¿›è¡Œä½“éªŒï¼Œ");$.Browser.chrome()&&(s=c.t("æ‚¨çš„Chromeæµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½ï¼Œå»ºè®®æ‚¨å‡çº§åˆ°æ–°ç‰ˆæœ¬è¿›è¡Œä½“éªŒï¼Œ")),n=s+'<a href="http://codown.youdao.com/163chrome/b/output/ChromeSetup/ChromeSetup.exe" target="_blank">'+c.t("ç«‹å³ä¸‹è½½")+"</a>ã€‚<br/>"+c.t("ç‚¹å‡»æ­¤å¤„")+'<a href="http://chrome.163.com" target="_blank">'+c.t("äº†è§£è¯¦æƒ…")+"</a>ã€‚",$.Msgbox.show({title:n})}},btnMode:v,btnFull:v,btnBasic:v,btnPortrait:function(e,t,i){var a=this,n=a.composeEditor,o=(n.module,n.component),s=a.editDv.dom,c=t.offset().x-109-n.getPadding()+"px";$(document).width()<=1510&&(c=$(document).width()-600-200-n.getPadding()+"px");try{$.LocalStorage.set("composeeditor-portrait-newtips-clicked-"+(0,r.$S)("uid"),!0);var l=a.getDom();if(!l)return;var d=l.querySelector(".APP-editor-commond-portrait"),u=d.querySelector(".APP-editor-commond-portrait-newtips");d.querySelector(".APP-editor-btn-rc").removeChild(u)}catch(e){}if(o[i])o[i].showing||($.Browser.isIE()?setTimeout((function(){o[i].show({left:c})}),100):o[i].show({left:c}));else{var m=n.base.getCallName($.Function.bind(n.portraitAdd,n)),p=$.Uri.getUrl("compose_portrait_v2")+"&call=window.parent."+m,f={renderTo:s,width:"476px",height:"280px",left:c,top:"42px",extcls:"APP-editor-menuNoBorder-insertFace",groups:[{style:"right:0px",content:'<iframe class="APP-editor-menu-iframe" style="width:476px;height:280px;" allowtransparency="allowtransparency" src="'+p+'" frameborder="0" scrolling="no"></iframe>'}]};$.Browser.isIE()?setTimeout((function(){o[i]=t.dom[i]=new $.Menu(f)}),100):o[i]=t.dom[i]=new $.Menu(f)}},btnSign:function(e,t,a){var n=this,o=n.composeEditor,s=o.sign,l=o.component,d=n.editDv.dom,p=(n.plugin[a],[]),f={};if(l[a]&&l[a].showing)l[a]=null;else{var h=t.offset(),g={renderTo:d,left:h.x-47-o.getPadding()+"px",top:(h.x<500?"55":"33")+"px",groups:[f]};s.each({text:!0,call:function(e,t){t&&p.push({text:$.String.escapeHTML(t.name),click:function(){s.select({text:!0,id:t.id})}})}});var v=s.get({linkedin:!0});u.linkedin&&v&&v.length&&p.push({text:c.t("linkedInç­¾å"),click:function(){m.cache({cl_sign_linkedin:"1"},$.EMPTYFUNC),s.select({linkedin:!0,id:1})||$.Msgbox.show({statsKey:"Compose_Guide_Popup_LinkedinSignature",type:"confirm",title:c.t("ä½ è¿˜æœªè®¾ç½®linkedInç­¾åï¼Œæ˜¯å¦ç«‹å³è®¾ç½®ï¼Ÿ"),ok:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){var t=e.default;m.cache({cl_sign_set:"1"},$.EMPTYFUNC),t.entry({module:"SignModule",exit:!1})})))}})}}),(0,r.$S)("isVip")&&!$G.environment.isCh||p.push({text:c.t("ä¸ªæ€§ç­¾å"),click:function(){m.cache({cl_sign_custom:"1"},$.EMPTYFUNC),s.showCustom()}}),p.length&&p.push({type:"split"}),p.push({text:c.t("è®¾ç½®ç­¾å"),click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){var t=e.default;m.cache({cl_sign_set:"1"},$.EMPTYFUNC),t.entry({module:"SignModule",exit:!1})})))}}),f.items=p,$.Browser.isIE()?setTimeout((function(){l[a]=new $.Menu(g)}),100):l[a]=new $.Menu(g)}},btnFullScreen:function(e,t,i){var a=this,n=a.composeEditor.module,o=n.data,r=n.base,s=o.get({moduleId:"header"}),l=$(n.container),d=o.get({status:"showSide"}),u=o.get({status:"fullScrren"});o.set({status:"fullScrren",value:!u});var m=o.get({component:"toolbar"}).getEl().find(".nui-toolbar-ext").hide();u?(s.removeClass("nA2"),l.removeClass("frame-main-noTop"),d&&$.Frame.setViewType("l-r",n),r.layoutAdjust({force:!0,timer:!0}),t.html('<b class="ico ico-editor ico-editor-toFullScr"></b>'),t.setClass("APP-editor-commond-btn APP-editor-switchFullScreen-toFull"),m.show()):(s.addClass("nA2"),l.addClass("frame-main-noTop"),d&&$.Frame.setViewType("normal"),r.layoutAdjust({force:!0,timer:!0}),t.html('<b class="ico ico-editor ico-editor-toMiniScr" title="'+c.t("å–æ¶ˆå…¨å±")+'"></b>'),t.setClass("APP-editor-commond-btn APP-editor-switchFullScreen-toMini"),m.hide()),a.plugin.More.resize.call(a)},btnStationery:function(e,t,i){var a=this.composeEditor,n=a.module,o=a.component;if(o[i])o[i].show();else{var r=this.editDv.dom,s=t.offset().x-89-a.getPadding()+"px",c='<b class="nui-layer-arr"n.createId("paperBtn")+'" class="hf0"></div><div class="cM0"><ul id="'+n.createId("paperList")+'" class="fB0"></ul></div><div id="'+n.createId("paperPage")+'" class="he0"></div></div>';o[i]=new $.Layer({renderTo:r,extcls:"kv0",left:s,top:"33px",hasClose:!0,content:c}),a.stationery.load()}},btnTranslate:function(e,t,i){m.cache({cl_trans:"1"},$.EMPTYFUNC);var a=this.composeEditor.base;a.send({action:"auto",call:function(){a.trans({action:"goHuman",vendor:"write"})}})},btnNotary:function(){m.cache({cl_notary_editor:"1"},$.EMPTYFUNC);var e=this.composeEditor,t=e.module,i=e.event,a=e.data,n=a.get({element:"ext"});if("none"===n.dom.style.display){var o="editorToolbar";s.default.getNotaryInfo((function(e){if(e.isPrivilege||e.singleBalance>=1)s.default.setNotaryBox(o,(function(){(!0!==a.get({status:"initExt"})||"none"==a.get({element:"ext"}).dom.style.display)&&i.extActive(),setTimeout((function(){var e=a.get({component:"notary"});!0!==e.getChecked()&&t.notary.toggle({click:!0})&&e.setChecked(!0,!0)}),500)}),(function(e){}));else{var n=function(){};(0,r.$S)("isVip")?s.default.setNotaryBox(o,n):s.default.showConfirmModal(o,n)}}),(function(){}))}else{n.toggle();var c=a.get({component:"notary"});!0===c.getChecked()&&(t.notary.toggle({click:!0}),c.setChecked(!1,!0))}},afterPaste:function(e){var t=this.editorCmpt;if((0,t.plugin.AutoLink.do)(t),console.log("dooooooo link~!!!!!"),e){var i=document.createElement("div");i.innerHTML=e;for(var a=i.querySelectorAll("img"),n=0;n<a.length;n++)a[n].src.indexOf("file://")<0||$.Tips.module({statsKey:"Compose_NoGuide_Tips_PictureUploadFail",text:c.t("æ‚¨ç²˜è´´çš„æ–‡æœ¬é‡Œå­˜åœ¨æœ¬åœ°å›¾ç‰‡ï¼Œæµè§ˆå™¨ä¸æ”¯æŒè§£æï¼Œè¯·å•ç‹¬ç²˜è´´å›¾ç‰‡"),expires:3e3})}},initNewTips:function(){if(!$.LocalStorage.get("composeeditor-portrait-newtips-clicked-"+(0,r.$S)("uid"),!0)){var e=this.editorCmpt.getDom();if(e){var t=e.querySelector(".APP-editor-tbar-basic"),i=e.querySelector(".APP-editor-commond-portrait");if(t&&i){var a,n,o,s,c,l=document.createElement("div"),d=(a=l,c="",{display:function(e){c!==e&&(c=e,a.style.display=c)},left:function(e){n!==e&&(n=e,a.style.left=n)},right:function(e){o!==e&&(o=e,a.style.right=o)},top:function(e){s!==e&&(s=e,a.style.top=s)}});l.className="APP-editor-commond-portrait-newtips",l.style.position="absolute",l.style.width="8px",l.style.height="8px",l.style.backgroundColor="#DB3434",l.style.borderRadius="4px",d.right("-3px"),d.top("-2px"),i.querySelector(".APP-editor-btn-rc").appendChild(l),i.style.position="relative",$.Log.cache({editor_portrait_tips_show:1})}}}}};l.inherit(f,a.Z),l.extend(f.prototype,h);var g={};function v(e,t,i){var a="basic"==i?"0":"1";p.set({field:"ntes_letter",flag:"editorToolbar",value:a}),this.changeMode(i)}t.Z=f},63480:function(e,t,i){i.r(t),i(15761),i(20869),i(42295),i(63518),i(75654),i(26340);var a=i(10487),n=i(72957),o=new n.c1("module.compose.ComposeEncrypt"),r=$.createClass((0,n.$N)("module.compose.ComposeEncrypt")),s=$.Object;s.inherit(r,a.Z),s.extend(r.prototype,{initialize:function(e){s.extend(this,{component:{encrypt:null,save:null,pass:null},element:{area:null}}),r.superClass.initialize.call(this,e)},init:function(){r.superClass.init.call(this),this.render()},clear:function(){r.superClass.clear.call(this.element),r.superClass.clear.call(this)},render:function(){var e=this,t=e.module,i=e.data,a=e.component,n=e.element;n.area=i.get({element:"encrypt"});var r=new $.Checkbox({text:o.t("åœ¨å·²å‘é€é‚®ä»¶ä¸­ä¿å­˜å¯†ç ")}),s=new $.Input({extcls:"nui-smallIpt",maxLength:6}),c=new $.Link({cls:"nui-block-close nui-close",icon:"close",click:function(){i.get({component:"encrypt"}).setChecked(!1)}}).html()+"<strong>"+o.t("é‚®ä»¶åŠ å¯†")+"</strong>"+o.t(" æ”¶ä¿¡äººéœ€è¦å¯†ç æ‰èƒ½æŸ¥çœ‹é‚®ä»¶")+'<div class="cq0"><label class="bg0">'+o.t("è®¾ç½®æŸ¥çœ‹å¯†ç ï¼š")+"</label>"+s.html()+'<span class="nnbsp;(è¯·è¾“å…¥6ä½æ•°å­—ã€å­—æ¯ï¼ŒåŒºåˆ†å¤§å°å†™)")+'</span><p class="co0">'+r.html()+'</p></div><a id="'+t.createId("encryptFocus")+'" href="javascript:void(0)" hidefocus="hidefocus" style="text-decoration:none;display:none">ã€€</a>';n.area.html(c),n.focus=i.get({moduleId:"encryptFocus"}),a.encrypt=i.get({component:"encrypt"}),a.save=r,a.pass=s,$.Component.setEvents()},get:function(e){e=e||{};var t=this.component;return e.save?t.save.getChecked():t.pass.getValue()},verify:function(){var e=this,t=!0,i=e.get();return i&&6==i.length?new RegExp("[_\\W]").test(i)&&(t=!1):t=!1,t||(new $.Msgbox({statsKey:"Compose_NoGuide_Popup_PasswordInvalid",content:o.t("å¯†ç å¿…é¡»æ˜¯å…­ä½çš„å­—æ¯ã€æ•°å­—ç»„æˆï¼Œå­—æ¯åŒºåˆ†å¤§å°å†™ã€‚"),ok:function(){e.focus({select:!0})}}),t)},focus:function(e){e=e||{};var t=this.component;try{t.pass.focus()}catch(e){}if(e.select)try{t.pass.select()}catch(e){}},toggle:function(e){e=e||{};var t=this.data,i=this.element,a=t.get({status:"showEncrypt"});if(e.open&&a)return!1;if(e.close&&!a)return!1;if(a)i.area.hide();else{if(t.get({status:"showSchedule"}))return new $.Msgbox({statsKey:"Compose_NoGuide_Popup_EncryptAndTiming",title:o.t('æŠ±æ­‰ï¼Œ"é‚®ä»¶åŠ å¯†"åŠŸèƒ½æ— æ³•ä¸"å®šæ—¶å‘ä¿¡"åŒæ—¶ä½¿ç”¨ã€‚')}),!1;i.area.show(),i.focus.show();try{i.focus.dom.focus(),i.focus.dom.blur()}catch(e){}i.focus.hide()}return t.set({status:"showEncrypt",value:!a}),!0}}),t.default=r},21913:function(e,t,i){i(37092),i(92274),i(48868),i(63045),i(81874),i(54861),i(55737),i(32021);var a=i(10487),n=i(15372),o=i(83957),r=i(89308),s=i(72957),c=new s.c1("module.compose.ComposeEvent"),l=$.Object,d=($.Tab,$.Log),u=$.Ext,m=($.Ud,$.Uri),p=$.createClass((0,s.$N)("module.compose.ComposeEvent")),f={initialize:function(e){p.superClass.initialize.call(this,e)},init:function(){p.superClass.init.call(this)},fireBar:function(e){e=e||{};var t=this.base,i=e.func,a=this.data,o={value:"bottom"==e.pos?"2":"1"};try{o.fromEntry=a.status.fromEntry}catch(e){}switch(i){case"deliver":d.cache({cl_send:o},$.EMPTYFUNC),t.clearTraceInfo(),t.send({action:"deliver"});break;case"save":d.cache({cl_save:o},$.EMPTYFUNC),t.send({action:"save"});break;case"preview":d.cache({cl_preview:o},$.EMPTYFUNC),t.preview();break;case"cancel":d.cache({cl_cancel:o},$.EMPTYFUNC),$.MultiTab.remove($.Context.module);break;case"dict":d.cache({cl_dict:o},$.EMPTYFUNC),Translate.change();break;case"card":n.Z.startApp({name:"cards_read",appId:4,text:c.t("é‚®ç®±è´ºå¡"),url:m.getUrl("cards_read")});break;case"postcard":n.Z.startApp({name:"read_postcard",appId:3,text:c.t("æ˜ä¿¡ç‰‡"),url:m.getUrl("read_postcard")})}},setTo:function(e){e=e||{};var t=this,i=(t.base,t.form,t.data),a=i.get({status:"showTo"}),n=i.get({element:"to"}),o=e.toggle;if(e.show){if(a)return;o=!0}if(e.hide){if(!a)return;o=!0}o&&(a?n.hide():n.show(),i.set({status:"showTo",value:!a}))},setCc:function(e){e=e||{};var t=this,i=(t.base,t.form),a=t.data,n=a.get({status:"showCc"}),o=t.getLink("cc"),r=a.get({element:"cc"});r||(r=t.createRev("cc"));var s=e.toggle;if(e.show){if(n)return;s=!0}if(e.hide){if(!n)return;s=!0}if(s){if(n){if(e.separate);else if(!i.getContact("empty","cc"))return void new $.Msgbox({statsKey:"Compose_NoGuide_Popup_DeleteCopy",type:"confirm",title:c.t("è¦åˆ é™¤å·²ç»å­˜åœ¨çš„æ‰€æœ‰æŠ„é€åœ°å€å—ï¼Ÿ"),ok:function(){i.setContact(null,"cc"),t.setCc({hide:!0})}});o.setText(c.t("æŠ„é€")),r.hide(),e.separate||"cc"==a.get({status:"inputChoose"})&&i.focus("to")}else o.setText(c.t("åˆ é™¤æŠ„é€")),r.show(),e.separate||i.focus("cc");a.set({status:"showCc",value:!n})}},setBcc:function(e){e=e||{};var t=this,i=(t.base,t.form),a=t.data,n=a.get({status:"showBcc"}),o=t.getLink("bcc"),r=a.get({element:"bcc"});r||(r=t.createRev("bcc"));var s=e.toggle;if(e.show){if(n)return;s=!0}if(e.hide){if(!n)return;s=!0}if(s){if(n){if(e.separate);else if(!i.getContact("empty","bcc"))return void new $.Msgbox({statsKey:"Compose_NoGuide_Popup_DeleteBlindSend",type:"confirm",title:c.t("è¦€åœ°å€å—ï¼Ÿ"),ok:function(){i.setContact(null,"bcc"),t.setBcc({hide:!0})}});o.setText(c.t("å¯†é€")),r.hide(),e.separate||"bcc"==a.get({status:"inputChoose"})&&i.focus("to")}else o.setText(c.t("åˆ é™¤å¯†é€")),r.show(),e.separate||i.focus("bcc");a.set({status:"showBcc",value:!n})}},setSeparate:function(e){e=e||{};var t=this,i=(t.base,t.form),a=t.data,n=a.get({status:"useSeparate"}),o=t.getLink("all"),r=o[0],s=o[1],l=o[2],d=a.get({element:"separate"});d||(d=t.createRev("separate"));var u=e.toggle;if(e.show){if(n)return;u=!0}if(e.hide){if(!n)return;u=!0}if(u){if(n){r.show(),s.show(),l.setText(c.t("ç¾¤å‘å•æ˜¾")),d.hide();var m=i.getContact("suc","separate"),p=m.length,f={};$.Array.each(m,(function(e,t){f[t.address.toLowerCase()]=1}));var h=function(e){var t=[];p&&$.Array.each(i.getContact("suc",e),(function(e,i){var a=i.address.toLowerCase();f[a]&&(f[a]++,t.push(i))})),t.length?i.setContact(t,e):i.setContact(null,e)};if(n.showTo&&(h("to"),t.setTo({show:!0,separate:!0})),n.showCc&&(h("cc"),t.setCc({show:!0,separate:!0})),n.showBcc&&(h("bcc"),t.setBcc({show:!0,separate:!0})),p){var g=[];$.Array.each(m,(function(e,t){f[t.address.toLowerCase()]>1||g.push(t)})),i.addContact(g,"to")}i.setContact(null,"separate"),i.focus(n.inputChoose),n=null}else(n={}).inputChoose=a.get({status:"inputChoose"}),r.hide(),s.hide(),l.setText(c.t("å–æ¶ˆç¾¤å‘å•æ˜¾")),d.show(),a.get({status:"showTo"})&&(i.addContact(i.getContact("suc","to"),"separate"),t.setTo({hide:!0,separate:!0}),n.showTo=!0),a.get({status:"showCc"})&&(i.addContact(i.getContact("suc","cc"),"separate"),t.setCc({hide:!0,separate:!0}),n.showCc=!0),a.get({status:"showBcc"})&&(i.addContact(i.getContact("suc","bcc"),"separate"),t.setBcc({hide:!0,separate:!0}),n.showBcc=!0),i.focus("separate");a.set({status:"useSeparate",value:n})}},createRev:function(e){var t=this,i=t.module,a=t.form,n=t.data,r=t.view,s=i.mailtrace,m="",p={xtype:"emailcontainer",key:e,containerfocus:function(){a.choose(e),a.addFocusCls(e)},containerblur:function(){a.removeFocusCls(e),$.Ext.contactCorrect&&a.remindValid(e)},containerupdate:function(){a.getAllRecvNum()>=21&&r.showMaketToolTips()},containeradditem:function(e){s.markContactGuideSceneTrigger(e)},domain:"163.com"};u.contactCorrect&&(p.itemwarnremove=function(t){a.remindRemove(e,t)});var f=c.t("åœ°å€è¾“å…¥æ¡†ï¼Œè¯·è¾“å…¥é‚®ä»¶åœ°å€ï¼Œå¤šäººæ—¶åœ°å€è¯·ä»¥åˆ†å·éš”å¼€"),h={cc:{tabIndex:1,title:c.t("åŒæ—¶å°†è¿™å°é‚®ä»¶å‘ç»™å…¶ä»–è”ç³»äºº"),inputLable:c.t("æŠ„é€")+f},bcc:{tabIndex:1,title:c.t("è¯¥åœ°å€å¯¹äºå…¶ä»–æ”¶ä»¶äººæ˜¯ä¸å¯è§çš„"),inputLable:c.t("å¯†é€")+f},separate:{tabIndex:1,tips:{text:c.t("ç¾¤å‘çš„é‚®ä»¶ï¼Œé‡‡ç”¨ä¸€å¯¹ä¸€å•ç‹¬å‘é€ï¼Œæ¯ä¸ªæ”¶ä»¶äººåªçœ‹åˆ°è‡ªå·±çš„åœ°å€")},title:c.t("ä¼šå¯¹å¤šä¸ªäººä¸€å¯¹ä¸€çš„å‘é€ï¼Œ æ¯ä¸ªäººå°†å•ç‹¬æ”¶åˆ°å‘ç»™ä»–/å¥¹çš„é‚®ä»¶"),inputLable:c.t("ç¾¤å‘å•æ˜¾")+f}};l.extend(p,h[e]);var g={cc:c.t("æŠ„é€äºº"),bcc:c.t("å¯†é€äºº"),separate:c.t("ç¾¤å‘å•æ˜¾")}[e],v={text:g,cls:"nui-txt-link",title:c.t("ç‚¹å‡»æ·»åŠ ")+g,click:function(){d.cache({cl_rev:e},$.EMPTYFUNC),a.showContact(e)}},b=g;try{b=new $.Link(v).html();var y=new o.Z(p);m=y.html(),n.set({component:e,value:y})}catch(e){}var x=$.Element.create("DIV");x.setClass("kZ0 jL0"+e),"separate"!=e||$G.environment.isCh||(x.dom.style.paddingLeft="100px");var k=n.get({element:"to"});"bcc"==e?(n.get({element:"cc"})||k).after(x.dom):k.after(x.dom);var S='<label class="fn0">'+(b+="separate"==e?'<span style="margin-left:-4px">ï¼š</span>':"ï¼š")+'</label><div class="dG0"><div class="bz0">'+m+'</div></div><div class="gH1"></div>';return x.html(S),$.Component.setEvents(),n.set({element:e,value:x}),a.addHoverEvent(e),x},toggleScheduleInvitation:function(e){var t=this,i=t.view,a=t.data,n=t.module,o=!a.get({status:"showScheduleInvitation"}),r=t.getLink("all")[3],s=o?c.t("åˆ é™¤æ—¥ç¨‹é‚€è¯·"):c.t("æ—¥ç¨‹é‚€è¯·"),l=n.container,d=$(l).find(".ia0");if(o){if(e)return;var u=a.get({component:"schedule"}),m=i.createScheduleInvitation();d.before(m),u&&u.setDisabled(),r.setText(s),a.set({status:"showScheduleInvitation",value:o}),$.Component.setEvents(),p(),$.Log.cache({ComposeICSShow:1})}else e?f():new $.Msgbox({statsKey:"Compose_NoGuide_Popup_DeleteSchedule",type:"confirm",title:c.t("æ˜¯å¦åˆ é™¤æ­¤æ—¥ç¨‹é‚€è¯·ï¼Ÿ"),ok:function(){f(),p()}});function p(){var e=a.get({component:"attachLayer",value:e});e&&"none"!==e.getEl().dom.style.display&&e.pointTo($("#"+n.createId("attachAdd")),$.fly(n.container))}function f(){var e=a.get({component:"schedule"});e&&e.setDisabled(!1),d.pre().remove(),r.setText(s),a.set({status:"showScheduleInvitation",value:o}),$.Log.cache({ComposeIonent:"toolbar4];case"all":return[t[3],t[4],t[5],t[6]]}},isExtActive:function(){var e=this.module.data,t=e.get({element:"ext"});return!0===e.get({status:"initExt"})&&"none"!=t.dom.style.display},extShow:function(){var e=this;e.module.data,e.isExtActive()||e.extActive()},extActive:function(){var e=this,t=e.module,i=t.base,a=t.data;t.editor,!0!==a.get({status:"initExt"})&&(e.extCreate(),a.set({status:"initExt",value:!0}));var n=a.get({element:"ext"}),o=a.get({component:"extLink"});if("none"==n.dom.style.display){d.cache({cl_more_s:"1"},$.EMPTYFUNC),o.setText(c.t("éšè—é€‰é¡¹ ")+'<b class="nui-ico">k</b>');try{var r=a.layout;e.editor.setSize({height:r.editorHeight-34+"px"})}catch(e){}}else d.cache({cl_more_h:"2"},$.EMPTYFUNC),o.setText(c.t("æ›´å¤šé€‰é¡¹ ")+'<b class="nui-ico">j</b>');n.toggle(),i.checkNotary(),i.layoutAdjust({timer:!0,force:!0})},extCreatele,a=(t.base,e.data),n=e.editor,o=t.mailtrace,l=a.get({element:"ext"}),p=new $.Checkbox({text:c.t("ç´§æ€¥"),title:c.t("è®¾ç½®é‚®ä»¶æŠ•é€’ä¼˜å…ˆçº§")});a.set({component:"priority",value:p});var f=new $.Checkbox({text:c.t("å·²è¯»å›æ‰§"),title:c.t("å¯ç”¨å›æ‰§åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥äº†è§£æ”¶ä»¶äººæ˜¯å¦é˜…è¯»äº†æ‚¨å‘é€çš„é‚®ä»¶")});a.set({component:"receipt",value:f});var h="";if(u.notary){var g=!1;if(r.default.getNotaryInfo((function(e){g=e.isAutoArchive}),(function(){})),!g){var v=new $.Checkbox({text:c.t("å…¬æ­£é‚®"),checkedchange:function(e){var a=this,n=a.getChecked(),o=!n,c="composeExt";Promise.resolve().then(i.bind(i,19916)).then($.Function.bind((function(e){var i=e.default;if(!t.notary){var l=new i(t);l.init(),t.notary=l}n?(a.setChecked(o,!0),r.default.getNotaryInfo((function(e){if(e.isPrivilege||e.singleBalance>=1)r.default.setNotaryBox(c,(function(){t.notary.toggle({click:!0})?a.setChecked(n,!0):a.setChecked(!1,!0)}),(function(e){}));else{var i=function(){};(0,s.$S)("isVip")?r.default.setNotaryBox(c,i):r.default.showConfirmModal(c,i)}}),(function(){}))):t.notary.toggle({click:!0})}))),d.cache({cl_notary:{isMember:$.Ud.udProxy["product.vipMember"]}},$.EMPTYFUNC)}});a.set({component:"notary",value:v}),h=v.html()}}var b=new $.Checkbox({text:c.t("çº¯æ–‡æœ¬"),title:c.t("æŠŠé‚®ä»¶å†…å®¹åˆ‡æ¢æˆçº¯æ–‡æœ¬ï¼Œå®ƒå°†æ— æ³•æ’å…¥è¡¨æƒ…ï¼Œå›¾ç‰‡ä»¥åŠå°†ä¸¢å¤±æ­£æ–‡é¢œè‰²ç­‰"),checkedchange:function(){var e=this.getChecked(),t=this;o.mailIsEnabled()&&e?$.Msgbox.show({statsKey:"Compose_Guide_Popup_ExtTextOpenConflict",title:'<p style="color:#394051;">'+c.t("é‚®ä»¶è®¾ç½®æé†’")+"</p>",content:'<p style="color:#585E6D;" >'+c.t("æ‚¨å·²å¼€é€šé‚®ä»¶è¿½è¸ªï¼Œè½¬åŒ–ä¸ºçº¯æ–‡æœ¬æ ¼å¼æ— æ³•è·å–è¯¥é‚®ä»¶çš„å·²è¯»çŠ¶æ€ï¼Œå°†è‡ªåŠ¨å…³é—­é‚®ä»¶å·²è¯»è¿½è¸ªåŠŸèƒ½ï¼Œæ‚¨ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ")+"<p/>",okText:c.t("ç¡®å®š"),cancelText:c.t("å–æ¶ˆ"),ok:function(){t.setChecked(!1,!0),n.switchText({text:e,click:!0}),o.localDisable()},cancel:function(){t.setChecked(!1,!0),$.Msgbox.msgbox.close()},close:function(){t.setChecked(!1,!0)}}):(this.setChecked(!1,!0),n.switchText({text:e,click:!0})),d.cache({cl_text:"1"},$.EMPTYFUNC)}});a.set({component:"text",value:b});var y=new $.Checkbox({text:c.t("å®šæ—¶å‘é€"),checkedchange:function(e){var a=this;new Promise((function(e,a){t.encrypt?e(t.schedule):Promise.resolve().then(i.bind(i,16579)).then($.Function.bind((function(i){var a=new(0,i.default)(t);a.init(),t.schedule=a,e(x)})))})).then((function(i){if(o.mailIsEnabled()&&e)$.Msgbox.show({statsKey:"Compose_Guide_Popup_ExtTextOpenConflict",title:'<p style="color:#394051;">'+c.t("é‚®ä»¶è®¾ç½®æé†’")+"</p>",content:'<p style="color:#585E6D;" >'+c.t("æ‚¨å·²å¼€é€šé‚®ä»¶è¿½è¸ªï¼Œè®¾ç½®å®šæ—¶å‘é€åæ— æ³•è·å–è¯¥é‚®ä»¶çš„å·²è¯»çŠ¶æ€ï¼Œå°†è‡ªåŠ¨å…³é—­é‚®ä»¶å·²è¯»è¿½è¸ªåŠŸèƒ½ï¼Œæ‚¨ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ")+"<p/>",okText:c.t("ç¡®å®š"),cancelText:c.t("å–æ¶ˆ"),ok:function(){t.schedule.toggle({click:!0})||a.setChecked(!1,!0),o.localDisable()},cancel:function(){a.setChecked(!1,!0),$.Msgbox.msgbox.close()},close:function(){a.setChecked(!1,!0)}});else{var n=t.schedule.toggle({click:!0});n||a.setChecked(!1,!0),$.Listener.fire("compose:optionChange",{option:"schedule",value:n})}})),d.cache({cl_schedule:"1"},$.EMPTYFUNC)}});a.set({component:"schedule",value:y});var x=new $.Checkbox({text:c.t("é‚®ä»¶åŠ å¯†"),checkedchange:function(e){var a=this;new Promise((function(e,a){t.encrypt?e(t.encrypt):Promise.resolve().then(i.bind(i,63480)).then($.Function.bind((function(i){var a=new(0,i.default)(t);a.init(),t.encrypt=a,e(a)})))})).then((function(e){e.toggle({click:!0})||a.setChecked(!1,!0)})),d.cache({cl_encrypt:"1"},$.EMPTYFUNC)}});a.set({component:"encrypt",value:x});var k="";if(u.ynote&&!$.Support.isTeamMailFromSwitch()){var S=new $.Checkbox({text:c.t("ä¿å­˜åˆ°æœ‰é“äº‘ç¬”è®°")});a.set({component:"ynote",value:S}),k=S.html();var w=m.getUrl("ynote",!0);k+=new $.Link({cls:"nui-fIBlock",icon:"help",link:w,title:c.t("ä»€ä¹ˆæ˜¯æœ‰é“äº‘ç¬”è®°?"),attrs:"style = 'margin:8px 0 0 -8px;'",target:"_blank"}).html()}var T=(a=t.data).get({status:"showScheduleInvitation"}),C=p.html()+f.html()+h+b.html()+y.html()+x.html()+""+k;l.dom.firstChild.innerHTML=C,$.Component.setEvents(),T&&setTimeout((function(){y.setDisabled()}),50)},switchNotary:function(){var e=this.module;if(!e.notary){var t=new ComposeNhis.setChecked(!1,!0),d},switchNav:function(e){var t=this,i=(t.module,t.base);return"1"==e?$.Frame.fullScreen():$.Frame.fullScreen("hfull"),i.addTimer("layout",(function(){t.attach.layout()}),300),!0},switchSide:function(e){e=e||{};var t=this,i=t.module,a=t.base,n=t.data,o=n.get({status:"showSide"}),r=i._child;rhow(r):$.SM.go({module:"address.AddressModule",noDragbar:!0,reset:!1,parent:i}),$.Frame.setViewType("l-r",i)),n.set({status:"showSide",value:!o}),a.addTimer("layout",(function(){t.attach.layout()}),300),!0)},hideFloat:function(e,t){var i=this.editor;$.Menu.hideAllMenu(),i.setPlaceholder({show:!1}),i.at.autoComplete&&i.at.autoComplete._remove()},setDragArea:function(e){var t=this,i=t.base,a=t.data,n=a.get({moduleId:"attachDrag"}),o=a.get({moduleId:"attachDragClose"}),r="none"!=n.dom.style.display;if(e.toggle)r?t.setDragArea({hide:!0,force:!0}):t.setDragArea({show:!0,close:!0});else{if(e.show)return r||(e.close?(n.set("dragType","close"),o.show()):(n.set("dragType","auto"),o.hide()),t.setDragArea({auto:!0}),n.show()),void($.Browser.ie()&&e.close);if(e.hide){var s=!1;return r&&("close"==n.get("dragType")?e.force&&(s=!0):s=!0),s&&i.addTimer("dragarea",(function(){n.hide()}),$.Browser.ie()?0:500),void $.Browser.ie()}if(e.auto){var c="282px";n.css({height:c,lineHeight:c})}else;}}};l.inherit(p,a.Z),l.extend(p.prototype,f),t.Z=p},66544:function(e,t,i){i(66403),i(42295),i(52963),i(34994),i(92274),i(75654),i(48868),i(63045),i(81874),i(54861),i(66251),i(96752),i(80153);var a=i(10487),n=i(64560),o=i(27018),r=i(72957),s=new r.c1("module.compose.ComposeForm"),c=$.Object,l=$.Ext,d=$.Email,u=$.Uri,m=$.createClass((0,r.$N)("module.compose.ComposeForm")),p={initialize:function(e){c.extend(this,{element:{priority:null,receipt:null,text:null,sms:null},fixData:{},fixElement:{}}),m.superClass.initialize.call(this,e)},init:function(){m.superClass.init.call(this)},setSender:function(e){var t,i,a,o=this.data.get({component:"sender"});if("string"==typeof e&&(e=u.matchEmail(e)),e){t=e.address,i=e.name;var r=n.default.getList();$.Array.each(r,(function(e,i){if(i.address==t)return a=i,$.BREAK})),a&&(i&&(a.name=i),o.setValue(a))}},getSender:function(){return this.data.get({component:"sender"}).getValue()},addContact:function(e,t){c.isArray(e)&&0===e.length||this.getContainer(t,!0).addItem(e)},setContact:function(e,t,i){var a=this.getContainer(t,!0);if(e)if(i){var n=[];try{for(var s=0,c=e.length;s<c;s+=1){var l,m=u.getEmails(e[s],null,!0).match;m.length>0&&(l=m[0],n.push(l))}}catch(e){r.$D.log("ComposeForm.setContactï¼šè”ç³»äººè§£æé”™è¯¯ã€‚")}var p,f=[],h=o.default.mappingEmails(n,i).data;for(s=0,c=h.length;s<c;s+=1)p=h[s],f.push(new d(p.address,p.name));a.setItem(f)}else a.setItem(e);else a.clearItem()},getContact:function(e,t){var i,a=this.getContainer(t);if(a){if("build"==e){var n=a.get("suc");return $.Array.each(n,(function(e,t){if(t.name&&-1!=t.name.indexOf('"'))if(-1!=t.name.indexOf('\\"')){var i=t.name.replace(/\\"/g,"Â§");i=i.replace(/"/g,""),t.name=i.replace(/Â§/g,'\\"')}else t.name=t.name.replace(/"/g,"");n[e]=t.toString()})),n}return a.get(e)}switch(e){case"object":i={suc:[],fail:[]};break;case"array":case"suc":case"build":case"fail":i=[];break;case"empty":i=!0;break;case"dom":i=null}return i},removeContact:function(e,t){var i=this.getContainer(t);i&&i.delItem(e)},modifyContact:function(e,t,i){var a=this.getContainer(t);a&&a.setItemValid(e,i)},showContact:function(e){var t=this;t.choose(e);var a={to:s.t("æ”¶ä»¶äºº"),cc:s.t("æŠ„é€äºº"),bcc:s.t("å¯†é€äºº"),separate:s.t("ç¾¤å‘å•æ˜¾")}[e];Promise.resolve().then(i.bind(i,67495)).then($.Function.bind((function(i){var n=i.default,r=t.getContact("suc",e);n.show({exist:r,title:a,data:o.default.data,callback:function(i){var a=[];$.Array.each(i,(function(e,t){a.push(t)})),t.setContact(a,e),t.focus(e)},cancel:function(){t.focus(e)}})})))},getContainer:function(e,t){var i=this.data,a=this.event;return e||(e=i.get({status:"inputChoose"})),!i.get({component:e})&&t&&a.createRev(e),i.get({component:e})},remindValid:function(e){var t=this,i=t.data;if(l.contactCorrect&&(e||(e=i.get({status:"inputChoose"})),t.getContact("build",e),i.change.composeInfo)){for(var a=i.get({component:e}).get("array"),n=[],o=0;o<a.length;o++)n.push(a[o].address);var r={var:{input:n},cal.contactCorrect(r)}},remindShow:function(e,t){var i=this,a=i.base,n=i.data,o=(i.module,t.responseText),r=JSON.parse(o);if(r&&200==r.code){var d=r.data,u=d.wrongbob,m=d.wrou)&&c.isEmpty(m))return;i.fixElement[e]||(i.fixElement[e]={},i.fixElement[e].child={});var p=i.fixElement[e];c.eac(e,t){if(i.fixData[e])return $.CONTINUE;var a=e.split("@")[0]+"@"+t;i.fixData[e]={domain:t,address:a,type:1}}));var f=p.component,h=n.get(ent.create("DIV")).setClass("bK0"),h.getEl().after(f.dom),p.component=f);var g=$.Element.create("P");g.html(s.t("æˆ‘ä»¬å‘ç°æ‚¨è¾“å…¥çš„åœ°å€å¯èƒ½æœ‰è¯¯ï¼Œè¯·é€‰æ‹©ä¿®æ”¹ï¼š")),f.append(g.dom),c.each(i.fixData,(function(t,a){var n=a.type,o=a.address,r=h.findItem(t);if(!r)return $.CONTINUE;r.setWarn(n);var s=$.Element.create("P"),c=$.Element.create("SPAN");c.html(t+" â†’");var l=$.Element.create("A");l.attr({href:"javascript:void(0)"}),l.setClass("nui-txt-link");var d=0===n?o:a.domain;l.html(d),l.listen("click",(function(a){r.fixWarn({address:o}),i.remindRemove(e,t),$.Event.cancel(a)})),s.append(c.dom),s.append(l.dom),f.append(s.dom);var u=t.toLowerCase();p.child[u]=s})),new $.Link({text:s.t("å…³é—­è¯¥æé†’åŠŸèƒ½"),cls:"nui-txt-link",renderTo:f,click:function(){f.empty(),f.hide(),a.setOption({field:"ntes_letter",flag:"remindShow",value:"1"},!0),l.contactCore);if(!i)return $.CONTINUE;i.fixWarn({address:i.address})}));var e=n.get({status:"remindShowId"});e&&$.Component._items[e].setChecked(!1,!0)}})}},remindRemove:function(e,t){var i=this.fixElement[e];t=t.toLowerCase(),i.child[t].remove(),delete i.child[t],c.isEmpty(i.child)&&(i.component.empty(),i.component.hide())},setSubject:function(e){var t=this.data.get({component:"subject"});try{t.fireRender(),t.setValue(e)}catch(e){}this.module.setText(e)},getSubject:function(){return this.data.get({component:"subject"}).getValue()},getScheduleInvitationAddr:function(){return this.data.get({component:"scheduleInvitationAddr"}).getValue()},getScheduleInvitationRemind:function(){return this.data.get({component:"scheduleInvitationRemind"}).getValue()},getScheduleInvitationStartTime:function(){var e=this.data.get({component:"scheduleInvitationStartDay"}),t=this.data.get({component:"scheduleInvitationStartTime"}),i=e.getValue().split(" ")[0],a=new Date(i);return a.setHours(0),a.getTime()+t.getValue()},getScheduleInvitationEndTime:function(){var e=this.data.get({component:"scheduleInvitationEndDay"}),t=this.data.get({component:"scheduleInvitationEndTime"}),i=e.getValue().split(" ")[0],a=new Date(i);return a.setHours(0),a.getTime()+t.getValue()},getScheduleInvitationData:function(){var e=this,t=e.getContact("build","to"),i=e.getContact("build","cc"),a=e.getContact("build","bcc"),n=e.getSubject(),o={},r=e.getScheduleInvitationAddr(),s=e.data.get({component:"isScheduleInvitationTimeAll"}).getChecked(),c=s?1:0,l=e.getScheduleInvitationStartTime(),d=e.getScheduleInvitationEndTime(),u=new Date(l),m=.setHours(0,0,0,0));var p=($.Ext.ics2schedule?e.getScheduleInvitationRber(p[1]),h=Number(p[0]),g=[{action:"EMAIL",interval:f,unit:h}],v=x(t),b=x(i),y=x(a);return o.tos=v,b&&b.length&&(o.ccs=b),y&&y.length&&(o.bccs=y),o.oIcs={summary:n,start:u.getTime(),end:m.getTime()},o.oIcs.allday=c,r&&(o.oIcs.location=r),0!==h&&(o.oIcs.valarmList=g),o;function x(e){return $.Array.map(e||[],(function(e,t){var i=new $.Uri(t);return($.String.encodeHTML(i.name)||i.address)+":"+i.address}))}},getScheduleInvitationStartDate:function(){var e=this.data.get({component:"scheduleInvitationStartDay"}).getValue().split(" ")[0];retutionEndDay"}).getValue().split(" ")[0];return new Date(e)},getCheckbox:function(e){var t=this.data,i=t.get({component:e});return i?i.getChecked():t.get({status:e})},setCheckbox:function(e,t,i){var a=this.data;a.snent:e})),n.setChecked(t,i),$.Listener.fire("compose:optionChange",{option:e,value:t})},addHoverEvent:function(e){var t=this.data,i=" iT1",a=t.get({element:e});a.listen("mouseover",(function(){var e=$(this);e.hasClass("iU2")||e.addClass(i)})),a.listen("mouseout",(function(){$(this).removeClass(i)}))},addFocusCls:function(e){this.data.get({element:e}).addClass("iU2")},removeFocusCls:function(e){this.data.get({element:e}).removeClass("iU2")},focus:function(e){var t=this.data;e?"subject"==e||this.choose(e):e=t.get({status:"inputChoose"});var i=t.get({component:e});i&&i.focus()},choose:function(e){this.data.set({status:"inputChoose",value:e})},blur:function(e){e||(e=this.data.get({status:"inputChoose"})),this.data.get({component:e}).blur()},getAllRecvNum:function(){var e=this.module,t=(e.base,e.data),i=e.form,a=0;if(t.get({status:"useSeparate"})){var n=i.getContact("build","separate");a+=n?n.length:0}else{var o=i.getContact("build","to"),r=i.getContact("build","cc"),s=i.getContact("build","bcc");a+=o?o.length:0,a+=r?r.length:0,a+=s?s.length:0}return a}};c.inherit(m,a.Z),c.extend(m.prototype,p),t.Z=m},67417:function(e,t,i){i(803),i(13484),i(19975),i(92274),i(65132),i(48868),i(81874),i(54861);var a=i(10487),n=i(62193),o=i(72957);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var s=$.Object,c=$.createClass((0,o.$N)("module.compose.ComposeInfo")),l={initialize:function(e){s.extend(this,{cid:"",did:"",mid:"",tid:"",ids:null,obj:{},con:[]}),c.superClass.initialize.call(this,e)},init:function(){c.superClass.init.call(this)},set:function(e){var t=this;"object"==r((e=e||{}).obj)&&(t.obj=e.obj,e.obj.id&&(e.cid=e.obj.id)),"string"==typeof e.cid&&(t.cid=e.cid),"string"==typeof e.did&&(t.did=e.did),"string"==typeof e.mid&&(t.mid=e.mid),"string"==typeof e.tid&&(t.tid=e.tid),"object"==r(e.ids)&&(t.ids=e.ids),"object"==r(e.con)&&(t.con=e.con)},get:function(e){var t=this;return(e=e||{}).cid?t.cid:e.did?t.did:e.mid?t.mid:e.tid?t.tid:e.ids?t.ids:e.obj?t.obj:e.con?t.con:void 0},getClientId:function(){var e;try{e=n.Z.getTime(0)}catch(t){e=new Date}return["c",e.valueOf()].join(":")}};s.inherit(c,a.Z),s.extend(c.prototype,l),t.Z=c},35575:function(e,t,i){i(32021);var a=i(72957),n=new a.c1("module.compose.ComposeListener"),o=(0,a.$I)("module.BaseListener"),r=$.createClass((0,a.$N)("module.compose.ComposeListener"));function s(){if($.Ext.composeAt){var e=this.module;try{e.at.initComplete()}catch(e){a.$D.log(n.t("é€šè®¯å½•ç›‘å¬é”™è¯¯"))}}}function c(e){var t=this.module.base;try{t.fireOption(e)}catch(e){a.$D.log(n.t("å†™ä¿¡é€‰é¡¹ç›‘å¬é”™è¯¯"))}}$.Object.andler:c},"options:personalModify":{handler:c},"options:signModify":{handler:function(e){var t=this.module,i=t.data,a=t.sign;try{i.set({status:"initSign",value:!1}),a.load()}catch(e){}}},"compose:imageUpload":{handler:function(e){var t=this.module,i=t.info,a=t.attach;if(e&&e.body){var n=e.body,o=n.action;("loggedin"==o||"downloaded"==o||"upload"==o&&n.cid==i.get({cid:!0}))&&a.mobileMsg(n)}}},"addr:dataInit":{handler:s},"addr:dataReset":{handler:s}}}),t.Z=r},76610:function(e,t,i){i(5196),i(37092),i(92274),i(15761),i(20869),i(42295),i(63518),i(75654),i(803),i(79150),i(55737),i(80153),i(34994),i(87553),i(26340);var a=i(10487),n=i(72957),o=i(35537),r=i(62385),s=new n.c1("module.compose.ComposeMailProtection"),c=$.createClass($N("module.compose.ComposeMailProtection")),l=$.Object,d=864e5,u=7*d,m=[{text:"1å¤©åè¿‡æœŸ",value:d},{text:"7å¤©ååˆ°æœŸ",value:u},{text:"30å¤©ååˆ°æœŸ",value:2592e6},{text:"3ä¸ªæœˆååˆ°æœŸ",value:7776e6},{text:"1å¹´ååˆ°æœŸ",value:31536e6}],p=[{text:"1æ¬¡",value:1},{text:"3æ¬¡",value:3},{text:"10æ¬¡",value:10},{text:"æ— é™åˆ¶",value:-1}];function f(){this.errorText="",this.encryptId="",this.enabled=!1,this.authType=2,this.password="",this.expiresAt=u,this.watermark=!1,this.readLimit=3,this._onchange=[]}function h(e){this.button=e,this.buttonIcon=e.getEl().find(".Sky-gCmp-main-footer-mailprotection-icon")}function g(e){this.useUid=e.useUid,this.key=this.useUid?e.key+$S("uid"):e.key,this.duration=e.duration}f.prototype.setEncryptId=function(e){this.encryptId=e},f.prototype.getEncryptId=function(){return this.encryptId},f.prototype.enable=function(){this.set("enabled",!0)},f.prototype.disable=function(){this.set("enabled",!1)},f.prototype.toJSON=function(){return{enabled:this.enabled,authType:this.authType,password:this.password,expiresAt:this.expiresAt,watermark:this.watermark,readLimit:this.readLimit,lock:!1}},f.prototype.set=function(e,t){this[e]=t,this.fireChange(e,t)},f.prototype.onChange=function(e){this._onchange.push(e)},f.prototype.clear=function(){this._onchange=[]},f.prototype.fireChange=function(e,t){$.Array.each(this._onchange,(function(i,a){a(e,t)}))},h.prototype.enable=function(){this.buttonIcon.removeClass("disabled").addClass("enabled")},h.prototype.disable=function(){this.buttonIcon.removeClass("enabled").addClass("disabled")},g.prototype.set=function(e){$.LocalStorage.set(this.key,e||"1",{path:"/",domain:$S("fullDomain"),expires:this.duration})},g.prototype.get=function(){return $.LocalStorage.get(this.key)};var v={onComposeGuideReady:function(e,t){var i=this;i.shouldShowNewbeeDialog()?$.Support.getMarketingPositionData({key:"mailSafePopupConfig",callback:function(e){if(e&&e.config&&e.config.enable)return i.showNewBeePopup(),i.newbeeDialogFlag.set(),void(t&&t(!1));t&&t(!0)}}):t&&t(!0)},onComposeSendCheck:function(e,t){},subjectKeywordsRegex:new RegExp("("+["æŠ¥åè¡¨","å·¥ä½œæ€»ç»“","ç»Ÿè®¡è¡¨","é€šçŸ¥","ä¿¡æ¯æ”¶é›†","ä¸“é¢˜","åˆåŒ","åå•","æŠ¥å‘Š","æ¸…å•"].join("|")+")","i"),onSubjectChange:function(e,t){var i=this,a=i.module.data.get("subjectMktKeywordConfig")||{},n=[];a&&a.protection&&(n=a.protection),i.subjectKeywordsRegexOverrided||(i.subjectKeywordsRegexOverrided=!0,n&&n.length&&(i.subjectKeywordsRegex=new RegExp("("+n.join("|")+")","i")));var o=i.subjectKeywordsRegex.exec($.String.trim(e)),r=i.shouldShowNewbeeDialog();if(o&&r)return $.Log.cache({compose_protection_keyword_match:o[0]}),void setTimeout((function(){i.newbeeDialogFlag.set(),i.showNewBeePopup()}));t()},beforeComposeSend:function(e){var t=e.value;this.settings.enabled&&"deliver"===e.value.action&&(t.attrs.ctrls=t.attrs.ctrls||{},t.attrs.ctrls.encrypt=this.settings.encryptId,t.attrs.saveSentCopy=!0,t.hasOwnPropertyw g({key:"Compose_Guide_Popup_MailProtectionNewBee",useUid:!0,duration:99999}),settingsDialog:null,submittedSettings:null,protectionInfo:null,settings:null,link:null,init:function(){c.superClass.init.call(this)},initialize:function(e){var t=this;c.superClass.initialize.call(t,e),$.Object.extend(t,{settings:new f}),$.Object.extend(t,{submittedSettings:this.settings.toJSON()}),this.settings.onChange((function(e,i){t.handerSettingsChange(e,i)})),this.initInfo(),this.getExpireConfig()},handerSettingsChange:function(e,t){var i=this;"enabled"===e&&(t?i.showSettingBody():i.hideSettingsBody(),))},bDialog&&t.settingsDialog.close(),i.send({action:"save"}),r.default.showMailProtectionBuy(e)},renderSwitch:function(e){return new $.Checkbox({subclass:"switch",checked:e.checked,extcls:"Sky-gCmp-main-mailprotection-switch",checkedchange:function(t){e.checkedchange&&e.checkedchange(t)}}).html()},renderAuthTypeRadioGroup:function(e){var t=[{name:"protectedMethod",text:"é‚®ä»¶éªŒè¯ç ",value:2,checked:2===e.value,checkedchange:function(t){e.checkedchange&&e.checkedchange(t)}},{name:"protectedMethod",text:"å¯†ç ",value:1,checked:1===e.value,checkedchange:function(t){e.checkedchange&&e.checkedchange(t)}}],i=$.Array.map(t,(function(e,t){return new $.Radio(t)}));return $.Radio.group(i),'<div class="nui-chkGroup">'+$.Array.map(i,(function(e,t){return t.html()})).join("")+"</div>"},renderGutter:function(e){return'<div class="Sky-gCmp-main-mailprotection-gutter" style="width:'+e+'px"></div>'},renderSplitor:function(){return'<div class="Sky-gCmp-main-mailprotection-splitor"></div>'},renderStrong:function(e){return'<span style="font-weight:600">'+e+"</span>"},renderDivider:function(e){return'<div class="Sky-gCmp-main-mailprotection-divider" style="height:'+e+'px"></div>'},renderBuyLink:function(){var e=this;return $.Link.html({extcls:"Sky-gCmp-main-mailprotection-buy-link",text:s.t("ç«‹å³ç»­è´¹"),click:function(){e.buy("Web_Mailprotection_renew"),$.Log.cache({mailprotect_compose_settings_buy_click:1})}})},renderIcon:function(){return'<span class="Sky-gCmp-main-mailprotection-dialog-icon"></span>'},renderTitle:function(e){return'<div class="Sky-gCmp-main-mailprotection-dialog-title">'+e+"</div>"},renderSubTitle:function(e){return'<div class="Sky-gCmp-main-mailprotection-dialog-subtitle">'+e+"</div>"},renderTisLayer:function(e){var t=e.dialogEl,i=e.tips,a=e.width,n=e.arrow,o=e.fixX,r=e.arrLeft;return new $.Layer({extcls:"Sky-gCmp-main-mailprotection-popup",width:a||"300",items:[{html:s.t(i)}],fixX:o,arrLeft:r,renderTo:t,params:n||"hasArr",onRender:function(){$.Component.setEvents()},listeners:[{name:"destroy",handler:function(){}},{name:"hide",handler:function(){this.destroy()}}]})},renderFAQIcon:function(e){var t=e.tips,i=e.width,a=e.arrow,n=e.fixX||0,o=e.arrLeft||0,r=this,s=new $.Component({html:'<span id="{domId}" class="Sky-gCmp-main-mailprotection-dialog-faq-icon"></span>',listeners:{mouseover:{handler:function(e){var s=r.settingsDialog.getDom();r.renderTisLayer({dialogEl:s,tips:t,width:i,arrow:a,fixX:n,arrLeft:o}).pointTo(this,$.fly(s))}},mouseout:{handler:function(){$.Layer.hideAllLayer()}}}});return s.html().replace("{domId}",s.domId)},renderItem:function(e,t,i,a){return['<div class="Sky-gCmp-main-mailprotection-dialog-item">','<div class="Sky-gCmp-main-mailprotection-dialog-item-title">'+e+"</div>",this.renderDivider(4),'<div class="Sky-gCmp-main-mailprotection-dialog-item-subtitle">'+t+"</div>",'<div class="Sky-gCmp-main-mailprotection-dialog-item-extra">'+i+"</div>",a,"</div>"].join("")},renderBasenabled,checkedchange:function(t){e.kchange(t)}}),n=this.protectionInfo?this.protectionInfo.copywriting:"";return this.renderItem("å¼€å¯æœºå¯†æ¨¡å¼",n+t+i,a)},renderHeader:function(){var e="<div class='Sky-gCmp-main-mailprotection-dialog-header-faq'>"+this.renderDivider(4)+"<div class='Sky-gCmp-main-mailprotection-dialog-header-faq-title'>"+this.renderStrong("æœºå¯†æ¨¡å¼åŠŸèƒ½")+"</div><div class='Sky-gCmp-main-mailprotection-dialog-header-faq-content'>æœºå¯†æ¨¡å¼æ¨¡å¼ä¸ºæ‚¨æä¾›"+this.renderStrong("é‚®ä»¶åŠ å¯†ã€é˜…è¯»æƒé™æ§åˆ¶ã€é‚®ä»¶æ°´å°")+"ç­‰åŠŸèƒ½ï¼Œä»¥å…¨é¢ä¿æŠ¤æ‚¨çš„é‚®ä»¶å®‰å…¨ã€‚<br/> å¼€å¯åæ‚¨å‘å‡ºçš„é‚®ä»¶å°†ä¸ä¼šç›´æ¥æ˜¾ç¤ºé‚®ä»¶å†…å®¹ï¼Œéœ€åœ¨é“¾æ¥å†…éªŒè¯èº«ä»½åæ‰å¯è¿›è¡ŒæŸ¥çœ‹ã€‚ å¦å¤–ï¼Œå—ä¿æŠ¤çš„é‚®ä»¶å°†ç¦æ­¢æ”¶ä»¶äººè½¬å‘ã€å¤åˆ¶ã€å¯¼å‡ºã€‚</div></div>",t=this.renderFAQIcon({tips:e,width:"268px",arrow:"arrUp",arrLeft:"10¨¡å¼åŠŸèƒ½"+i+t),this.renderDivider(4),this.renderSubTitle("æä¾›é‚®ä»¶åŠ å¯†ã€é˜…è¯»æƒé™æ§åˆ¶ã€é‚®ä»¶æ°´å°ç­‰åŠŸèƒ½ä¿æŠ¤é‚®ä»¶å®‰å…¨ã€‚"),"</div>"].join("")},renderDividerLine:function(){return'<div class=reOptions:funfunction(t,i){return $.Object.extend(i,{checked:e.value===i.value})})),selectedchange:function(t){e.selectedchange&&e.selectedchange(t)}}).html()},renderReadLimitOptions:function(e){return new $.Select({selectedIndex:3,options:$.Array.map(p,(function(t,i){return $.Object.extend(i,{checked:e.value===i.value})})),selectedchange:function(t){e.selectedchange&&e.selectedchange(t)}}).html()},renderPasswordInput:function(e){var t=this;return new $.Input({extcls:"Sky-gCmp-main-mailprotection-password-input",maxLength:6,value:e.value,placeholder:s.t("ä»…æ”¯æŒæ•°å­—ã€å­—æ¯"),subclass:"smallIpt",blur:function(){e.blur&&e.blur(this.getValue())},listeners:{input:{handler:function(){t.settings.errorText&&e.blur&&e.blur(this.querySelector("input").value)}}}}).html()},renderAuthTypeSetting:function(e){var t=this,i=this.renderAuthTypeRadioGroup({value:e.authType,checkedchange:function(e){e!==t.settings.authType&&t.settings.set("errorText",""),t.settings.set("authType",e),$.Log.cache({mailprotect_compose_settings_authType_click:{value:e}})}}),a=this.renderPasswordInput({value:e.password,blur:function(e){t.setPassword(e)}}),n=this.renderDivider(8),o=this.renderGutter(8),r=new $.Component({html:'<span id="{domId}" class="Sky-gCmp-main-mailprotection-password-copy-icon"></span>',listeners:{click:{handler:function(){if(t.settingsDialog&&t.validate()){var e=t.settingsDialog.getEl().find(".Sky-gCmp-main-mailprotection-password-input input").dom;if(e&&e.value.length)try{t.copy(s.t("æˆ‘é€šè¿‡æœºå¯†æ¨¡å¼æ¨¡å¼ç»™æ‚¨å‘é€äº†ä¸€å°åŠ å¯†é‚®ä»¶ï¼Œæ‚¨å¯é€šè¿‡ä»¥ä¸‹å¯†ç éªŒè¯æŸ¥çœ‹ï¼Œå¯†ç ï¼š")+e.value),$.Tips.show({extcls:"Sky-gCmp-main-mailprotection-copy-succ-tips",succ:!0,text:"å¯†ç å·²å¤åˆ¶åˆ°ç²˜è´´æ¿"})}catch(e){}}}}}}),c=r.html().replace("{domId}",r.do-gCmp-main-mailprotection-password-error" style="display:none"></div>',onInit:function(){var e=this;t.settings.onChange((function(t,i){if("errorText"===t){var a='<div id="{domId}" class="Sky-gCmp-main-mailprotection-password-error">'+(i||"")+"</div>";e.update({html:a}),i?e.show():e.hide()}}))}}),d=l.html().replace("{domId}",l.domId),u=2===e.authType?"display:none":"display:block",m=new $.Component({html:'<div id="{domId}" class="Sky-gCmp-main-mailprotection-password-inputwrapper" style="'+u+'"><span class="Sky-gCmp-main-mailprotection-password-label">è¯·è¾“å…¥6ä½å¯†ç </span> '+a+c+d+"</div>",onInit:function(){var e=this;t.settings.onChange((function(t,i){if("authType"===t){var a=1===i,n=e.getEl();n&&n.dom&&(n.dom.style.display=a?"block":"none")}}))}}),p=m.html().replace("{domId}",m.domId);return this.renderItem("é‚®ä»¶åŠ å¯†æ–¹å¼"+o+this.renderFAQIcon({tips:"<div>é‚®ä»¶éªŒè¯ç ï¼šæ”¶ä»¶äººæ‰“å¼€é‚®ä»¶æ—¶ï¼Œå°†ä¼šå‘é€éªŒè¯ç è‡³å¯¹æ–¹æ”¶ä»¶ç®±ã€‚ <br/>"+s.t("å¯†ç ï¼šéœ€å•ç‹¬å°†å¯†ç å‘ŠçŸ¥æ”¶ä»¶äººã€‚")+"</div>",width:"240px",arrow:"arrDown"}),"å—ä¿æŠ¤é‚®ä»¶éœ€è§£é”åæ‰èƒ½æŸ¥çœ‹",i,n+p)},renderFormatDateStr:function(e,t){var i=$.Misc.getTime().getTime();return $.Date.format(new Date(i+(e||this.submittedSettings.expiresAt)),t||"yyyyå¹´MMæœˆddæ—¥HHç‚¹")},renderExpiresDate:function(){var e=this,t=this.renderFormatDateStr(e.settings.expiresAt),i=new $.Component({html:'<span id="{domId}">'+t+"</sparFormatDateStr(e.settings.expiresAt);t.update({html:"<span>"+n+"</span>"})}}))}});return i.html().replace("{domId}",i.domId)},renderExpireSettings:function(e){var t=this;return this.renderItem("é‚®ä»¶æŸ¥çœ‹æœ‰æ•ˆæœŸ",this.renderExpiresDate()+"åï¼Œæ”¶ä»¶äººå°†æ— æ³•æŸ¥çœ‹",this.renderExpireOptions({value:e.value,selectedchange:function(e){t.settings.set("expiresAt",e),$.Log.cache({mailprotect_compose_settings_expire_click:{value:e}})}}))},renderReadLimitSettings:function(e){var t=this;return this.renderItem("é˜…è¯»æ¬¡æ•°é™åˆ¶","è¶…è¿‡é˜…è¯»æ¬¡æ•°åï¼Œè¯»ä¿¡é“¾æ¥è‡ªåŠ¨å¤±æ•ˆ",this.renderReadLimitOptions({value:e.value,selectedchange:function(e){t.settings.set("readLimit",e),$.Log.cache({mailprotect_compose_settings_readlimit_click:{value:e}})}}))},renderWatermarkSettings:function(e){var t=this;return this.renderItem("é˜…è¯»é‚®ä»¶æ°´å°","æ”¶ä»¶äººé˜…è¯»æœ¬é‚®ä»¶æ—¶ä¼šæ˜¾ç¤ºæ”¶ä»¶äººåœ°å€ç›¸å…³æ°´å°",this.renderSwitch({checked:e.value,checkedchange:function(e){t.settings.set("watermark",e),$.Log.cache({mailprotect_compose_settings_watermark_click:{value:e}})}}))},updateLinkButtonUI:function(){this.settings.enabled?this.link.enable():this.link.disable()},hideSettingsBody:function(){this.settingsDialog&&this.settingsDialog.getEl().find(".Sky-gCmp-main-mailproton(){this.settingsDialog&&this.settingsDialog.getEl().find(".Sky-gCmp-main-mailprotection-settings-body").show()},validate:function(){return 1!==this.settings.authType||(this.setPassword(this.settings.password),!this.settings.errorText)},setPassword:function(e){var t=this;/^[0-9a-zA-Z]{6}$/.test(e)?t.settings.set("errorText",""):t.settings.set("errorText",e?"è¯·è¾“å…¥æ­£ç¡®çš„å¯†ç ":"è¯·è¾“å…¥å¯†ç "),t.settings.set("password",e)},shouldShowNewbeeDialog:function(){return!this.newbeeDialogFlag.get()},copy:function(e){$.Misc.Clipboard.getInstance().copy(e)},initInfo:function(e){var t=this;o.Z.getInfo((function(i){t.protectionInfo=i,e&&e()}))},getExpireConfig:function(){var e=this;o.Z.getExpireConfig((function(t){t&&(e.settings.set("expiresAt",t),e.submittedSettings.expiresAt=t)}))},updateExpireConfig:function(e){o.Z.updateExpireConfig(e)},experience:function(e,t){var i=this;o.Z.experience((function(t){i.protectionInfo=t,i.initInfo((function(){e&&e()}))}),(function(e){t&&t(e)}))},createEncryptConfig:function(e,t,i){var a=this,n=$.Object.extend({uid:$S("uid"),to:e.to,subject:e.subject,ext:e.ext},this.submittedSettings);o.Z.createEncryptConfig(n,(function(e){a.settings.setEncryptId(e.encryptId),a.submittedSettings.encryptId=e.encryptId,t&&t()}),(function(e){i&&i(e)}))},updateEncryptConfig:function(e,t,i){var a=$.Object.extend({tid:e.tid,mid:e.mid},this.submittedSettings);o.Z.updateEncryptConfig(a,(function(){t&&t()}),i)},showNewbeeDialog:function(){var e=this;o.Z.newbeeGuide({statsKey:"Compose_Guide_Popup_MailProtectionNewBee",ok:function(){e.experience((function(){e.protectionInfo.opened&&(e.settings.enable(),e.submittedSettings.enabled=!0,e.showSettingsDialog())}))},cancel:function(){}})},showNewBeePopup:function(){var e=this,t=e.module,i=t.data,a=t.getEl("main"),n=i.get({component:"mailProtectionLink"}),o=t.find(".Sky-gCmp-main-footer-mailprotection-text");if(o){var r='<div><div style="width:256px;height:200px;border:1px solid #E3E5EC;border-radius:4px;box-sizing:border-box;overflow:hidden;"><img style="width:254px;" src="https://mail-activity.nos-jd.163yun.com/5b14acd56e2e98f17d819a02226eb672.gif"/></div><div style="color:#21293A;font-size: 14px; line-height: 20px;font-weight: bold;margin-bottom: 8px;margin-top:12px">'+s.t("æœºå¯†é‚®ä»¶ï¼š")+'</div><div style="color:#394051;font-size: 12px; line-height: 20px;margin-bottom: 16px;">'+s.t("å…¨æ–°å‡çº§æœºå¯†é‚®ä»¶åŠŸèƒ½ï¼Œè®©æ”¶ä»¶äººåœ¨åŠ å¯†ç¯å¢ƒä¸­è¿›è¡Œé‚®ä»¶é˜…è¯»ã€‚åœ¨æ­¤åŸºç¡€ä¸Šæä¾›é˜…åå³ç„šã€ç¦æ­¢è½¬å‘ã€é‚®ä»¶æ°´å°ç­‰èƒ½åŠ›ï¼Œè®©æ•æ„Ÿé‚®ä»¶å†…å®¹ä¸å†è½»æ˜“æ³„éœ²ã€‚")+"</div><div>",c=$.Misc.debounce((function(){var i=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok">'+s.t("ç«‹å³ä½“éªŒ")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){d.destroy(),$.Log.cache({Compose_Guide_Popup_MailProtectionNewBee_OK:1}),e.experience((function(){e.protectionInfo.opened&&(e.settings.enable(),e.submittedSettings.enabled=!0,e.showSettingsDialog())}),(function(t){319===t&&(e.isAvailable()?e.showSettingsDialog():e.buy("Web_Mailprotection_experience"))}))}}]}),o=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-cancel">'+s.t("æš‚ä¸ä½“éªŒ")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){d.destroy(),$.Log.cache({Compose_Guide_Popup_MailProtectionNewBee_NoNeed:1})}}]}),l=t.getDom("main"),d=new $.Layer({extcls:"Sky-gCmp-mailtrace-guide-popup Sky-gCmp-mailtrace-intro-guide-popup",fixY:-10,items:[{html:r},{html:'<div style="text-align:right;">'+o+i+"</div>"},{html:$.Browser.isIE()?"":'<span class="Sky-gCmp-mailtrace-intro-popup-angle"></span>'}],params:"hasArr arrDown",renderTo:l,onRender:function(){$.Log.cache({Compose_Guide_Popup_MailProtectionNewBee_show:1}),$.Component.setEvents()},listeners:[{name:"destroy",handler:function(){d=null}},{name:"hide",handler:function(){setTimeout((function(){d.destroy()}),0)}}]});d.pointTo(n.getEl(),$.fly(l)),$.Event.unlisten(a,"scroll",c)}),150),l=a.dom.scrollHeight!==a.dom.clientHeight,d=a.dom.scrollTop+a.dom.clientHeight<a.dom.scrollHeight;l&&d?(o.dom.scrollIntoView({behavior:"smooth",block:"start"}),$.Event.listen(a,"scroll",c)):c()}},showExpireRemindDialog:function(e){var t=this,i=null,a=new $.Link({text:"ç«‹å³ç»­è´¹",click:function(){t.buy("Web_Mailprotection_expire_renew"),$.Log.cache({mailprotect_compose_expire_buy_click:1}),i&&i.hide()}});$.Msgbox.show({statsKey:"Compose_Guide_Dialog_Protection_Expire",title:"æœºå¯†æ¨¡å¼æç¤º",content:"æœºå¯†æ¨¡å¼åŠŸèƒ½å·²åˆ°æœŸï¼Œå½“å‰é‚®ä»¶ä¸æ”¯æŒå®‰å…¨å‘é€ã€‚ï¼ˆ"+a.html()+"ï¼‰",onRender:function(){i=this,$.Component.setEvents()},buttons:[{text:"ç»§ç»­å‘é€",subclass:"mainBtn",click:function(){i&&i.hide(),t.disable(),e&&e()}}]})},showUnknownCreateFailDialog:function(){$.Msgbox.show({statsKey:"Compose_Guide_Dialog_Protection_CreateFail",title:"æœºå¯†æ¨¡å¼æç¤º",content:"æœªçŸ¥åŸå› ï¼Œæœºå¯†æ¨¡å¼å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚æˆ–è€…å…³é—­æœºå¯†æ¨¡å¼åŠŸèƒ½åå‘é€ã€‚"})},linkButton:function(e){$.Object.extend(this,{link:new h(e)})},isExperienced:function(){return this.protectionInfo&&this.protectionInfo.opened},isEnabled:function(){return this.submittedSettings.enabled},isAvailable:function(){return this.protectionInfo&&this.protectionInfo.available},hasEncryptId:function(){return!!this.submittedSettings.encryptId},getEncryptId:function(){return this.submittedSettings.encryptId},uiDisable:function(){var e=this.module.getEl("above-base-ext");e.html(""),e.hide(),this.link.disable()},uiEnable:function(){var e=this,t=e.module.getEl("above-base-ext");t.html(e.renderExtBlock()),t.show(),e.link.enable()},settingsCommit:function(e){var t=this;$.Object.extend(t,{submittedSettings:e}),t.updateExpireConfig(t.submittedSettings.expiresAt)},enable:function(){this.submittedSettings.enabled=!0,this.settings.enable(),this.uiEnable()},disable:function(){var e=this,t=e.module.base;this.submittedSettings.enabled=!1,this.settings.disable(),e.uiDisable(),t.fireCompose("compose:mailprotectChange",e.settings.enabled)},showConfigWithSender:function(e){var t=this;t.module.data,$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailProtection_SenderConflict",statsValue:{reason:"ComposeSender"},title:'<p style="color:#394051;">'+s.t("æœºå¯†æ¨¡å¼æç¤º")+"</p>",content:'<p style="color:#585E6D;" >'+s.t("å¼€å¯ä»£å‘å°†æ— æ³•æ”¯æŒæœºå¯†æ¨¡å¼ã€‚ä¸ºä¸å½±å“æ‚¨çš„é‚®ä»¶å‘é€ï¼Œå»ºè®®æ‚¨æœ¬æ¬¡å‘ä¿¡å…³é—­æœºå¯†æ¨¡å¼åŠŸèƒ½ã€‚")+"<p/>",buttons:[{text:s.t("ç¡®è®¤å…³é—­"),subclass:"mainBtn",click:function(){$.Log.cache({Compose_Guide_Popup_MailProtection_SenderConflict_ok_click:1}),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),t.disable(),e&&e()}}]})},showConfigWithSchedule:function(e){var t=this;t.module.data,$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailProtection_ScheduleConflict",statsValue:{reason:"ComposeSchedule"},title:'<p style="color:#394051;">'+s.t("æœºå¯†æ¨¡å¼æç¤º")+"</p>",content:'<p style="color:#585E6D;" >'+s.t("ä½¿ç”¨æ—¥ç”¨é‚€è¯·å°†æ— æ³•æ”¯æŒæœºå¯†æ¨¡å¼ã€‚ä¸ºä¸å½±å“æ‚¨çš„é‚®ä…³é—­æœºå¯†æ¨¡å¼åŠŸèƒ½ã€‚")+"<p/>",buttons:[{text:s.t("å…³é—­æœºå¯†æ¨¡å¼"),subclass:"mainBtn",click:function(){$.Log.cache({Compose_Guide_Popup_MailProtection_ScheduleConflict_ok_click:1}),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),t.disable(),e&&e()}}]})},showNPSIfNeed:function(){this.protectionInfo.used||this.showNPSPopup()},showNPSPopup:function(){$.Popup.show({title:s.t("æ‚¨çš„å£°éŸ³ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å˜å¾—æ›´å¥½ï¼"),content:s.t("æ–°åŠŸèƒ½è°ƒç ”-æœºå¯†æ¨¡å¼æ¨¡å¼"),okText:s.t("ç«‹å³å‚åŠ "),pauseTime:15e3,onRender:function(){$.Log.cache({mailprotect_compose_nps_show:1})},ok:function(){$.Log.cache({mailprotect_compose_nps_click:1}),window.open("https://xbsy.dingwei.netease.com/survey/gu1f75/paper","_blank")},close:function(){$.Log.cache({mailprotect_compose_nps_close:1})}})},renderExtBlock:function(){var e=this,t='<div class="Sky-gCmp-main-footer-mailprotection-extblock-title">'+s.t("å·²å¼€å¯æœºå¯†æ¨¡å¼")+"</div>",i='k-subtitle">'+s.t("ä¸ºäº†ä¿éšœæ‚¨çš„é‚®ä»¶å®‰å…¨ï¼Œæœ¬é‚®ä»¶å‘å‡ºåå°†ä¸ä¼šç›´æ¥æ˜¾ç¤ºé‚®ä»¶å†…å®¹ï¼Œéœ€è¦è§£å¯†åæŸ¥çœ‹ã€‚")+"</div>",a='<div class="Sky-gCmp-main-footer-mailprotection-extblock-expiresdate">'+s.t("æœ‰æ•ˆæœŸè‡³ï¼š")+s.t(this.renderFormatDateStr(this.submittedSettings.expiresAt,"yyyyå¹´MMæœˆddæ—¥ HH:mm"))+"</div>",n=this.renderGutter(16),o=this.renderGutter(4);return["<div class='Sky-gCmp-main-footer-mailprotection-extblock'>",'<span class="Sky-gCmp-main-footer-mailprotection-extblock-icon"></span>',"<div class='Sky-gCmp-main-footer-mailprotection-extblock-content'>",t,this.renderDivider(4),i,"</div>","<div class='Sky-gCmp-main-footer-mailprotection-extblock-topright'>",a,n,this.renderSplitor(),n,$.Link.html({extcls:"Sky-gCmp-main-footer-mailprotection-extblock-changesetting-link",text:'<span class="Sky-gCmp-main-footer-mailprotection-extblock-changesetting-icon"></span>'+o+s.t("ä¿®æ”¹è®¾ç½®"),click:function(){e.showSettingsDialog(),$.Log.cache({mailprotect_compose_extblock_changeSetting_click:1})},onRender:function(){$.Log.cache({mailprotect_compose_extblock_changeSetting_show:1})}}),"</div>"].join("")},showSettingsDialog:function(){var e=this,t=e.module,i=t.base,a=t.data.get({component:"mailProtectionLink"});a&&e.linkButton(a);var n=this.renderDivider(16),o=this.renderDividerLine(),r=this.renderHeader(),c=this.renderBaseInfo({statusText:"æ­£å¸¸",enabled:this.isEnabled()&&this.isAvailable(),checkchange:function(t){e.isAvailable()?t?e.settings.enable():e.settings.disable():e.buy("Web_Mailprotection_enable"),$.Log.cache({mailprotect_compose_settingS_enableswitch_click:t})}}),l=this.renderAuthTypeSetting({authType:this.submittedSettings.authType,password:this.submittedSettings.password}),d=this.renderExpireSettings({value:this.submittedSettings.expiresAt}),u=this.renderReadLimitSettings({value:this.submittedSettings.readLimit}),m=this.renderWatermarkSettings({value:this.submittedSettings.watermark}),p=this.submittedSettings.enabled?"block":"none";$.Msgbox.show({statsKey:"Compose_Guide_Dialog_ProtectionSettings",extcls:"Sky-gCmp-main-mailprentType:"custom",noHeader:!0,onRender:function(){e.settingsDialog=this,$.Component.setEvents(),e.settings.onChange((function(t,i){e.handerSettingsChange(t,i)}))},listeners:[{name:"destroy",handler:function(){e.settingsDialog=null,e.settings.clear()}}],content:[r,c,'<div class="Sky-gCmp-main-mailprotection-settings-body" style="display:'+p+'">',n,o,n,l,n,d,n,u,n,m,"</div>"].join(""),buttons:[{text:s.t("ç¡®å®š"),subclass:"mainBtn",click:function(){e.validate()&&(e.submittedSettings=e.settings.toJSON(),e.submittedSettings.enabled?(e.uiEnable(),e.updateExpireConfig(e.submittedSettings.expiresAt)):e.uiDisable(),i.fireCompose("compose:mailprotectChange",e.settings.enabled),e.settingsDialog&&e.settingsDialog.close(),$.Log.cache({mailprotect_compose_settings_confirm_click:1}))}},{text:s.t("å–æ¶ˆ"),click:function(){e.settingsDialog&&e.settingsDialog.close(),$.Log.cache({mailprotect_compose_settings_cancel_click:1})}}]})},tryEnable:function(e){var t=this;e&&t.linkButton(e),t.isExperienced()?t.showSettingsDialog(e):t.showNewbeeDialog()}};l.inherit(c,a.Z),l.extend(c.prototype,v),t.Z=c},65247:function(e,t,i){var a=i(10487),n=(i(72957),$.Object),o=(new $I18N("module.compose.ComposeMailProtectionVip"),$.createClass($N("module.compose.ComposeMailProtectionVip")));n.inh){},disable:function(){},isEnabled:function(){return!1},hasEncryptId:function(){return!1},tryEnable:function(){}}),t.Z=o},15050:function(e,t,i){i(15761),i(20869),i(42295),i(63518),i(75654),i(803),i(55737),i(79150),i(66251),i(49750),i(37092),i(92274),i(34994),i(80153);var a,n,o=i(10487),r=i(72957),s=i(96540),c=i(62385),l=i(27018),d=new r.c1("module.compose.ComposeMailTrace"),u=$.Object,m=$.createClass($N("module.compose.ComposeMailTrace")),p={mailTraceEnable:!1,attTraceEnable:!1,mailTraceRemindOpt:{read:["",""],unread:["",""]},attTraceRemindOpt:{read:["",""],unread:["",""]}},f={onComposeGuideReady:function(e,t){var i=this;i.onReady((function(){i.initConfigGetSet(),i.tipsRender(),i.mailIsEnabled()&&i.iconHighlightToggle({enabled:!0}),setTimeout((function(){var e=i.expireTipsShow(),a=i.guidePopupShowAfterEntry();t&&t(!(a||e))}),1e3),i.listenerComposeOptionChange()}))},subjectKeywordsRegexOverrided:!1,subjectKeywordsRegex:new RegExp("("+["æŠ•ç¨¿","contribution","è‡ªè","application","ç”³è¯·","apply","ç®€å†","job","é¢è¯•","é€šçŸ¥","notification","é‡è¦ï¼ˆå›å¤é‚®ä»¶ï¼‰","re:","ç´§æ€¥","urgent","ç ”ç©¶ç”Ÿ","å…¥å­¦","å½•å–","ç¡•å£«","å¯¼å¸ˆ","ç§‘ç›®","æŠ¥å","æŠ¥è€ƒ","å­¦å†","ä¸“ä¸šè¯¾","è€ƒç ”è¾…å¯¼","è€ƒç ”å’¨è¯¢","å­¦ç”Ÿ","åº”è˜","ææ–™","è°ƒå‰‚","å¤§å­¦","è€å¸ˆ","å’¨è¯¢","ä¸“ç¡•","å®ä¹ ç”Ÿ","ç®€å†","åšå£«","å²—ä½","offer","è–ªèµ„","æµæ°´","æ ¡æ‹›","ç¤¾æ‹›","Postgraduate student","Enrollment","Admission","Master's degree","Supervisor","Subject","Reminder","Registration","Application","Academic qualificate entrance exam coaching","Postgraduate entrance exam consultation","Student","Jorsity","Teacher","Consultation","Professional master","Intern","Resume","Doctorate","Internship","Position","Offer","Salary","Payroll","Campus Recruitment","Social Recruitment"].join("|")+")","i"),sceneTriggerConfig:{closeDays:30},text:{monthlyExpireTips:d.t("é‚®ä»¶è¿½è¸ªåŠŸèƒ½å·²åˆ°æœŸï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹ã€‚"),balanceExpireTips:d.t("é‚®ä»¶è¿½è¸ªåŠŸèƒ½å¯ç”¨å°æ•°ä¸è¶³ï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹ã€‚"),statusSubTitleRaw:d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»"),statusSubTitleAvailable:d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»"),statusSube:d.t("å·²åˆ°æœŸï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹"),statusSubTitleBalanceExpire:d.t("å¯ç”¨å°æ•°ä¸è¶³ï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹"),statusSubTitleTrialExpire:d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»")},tmpConfig:void 0,tmpSettings:void 0,wmsvrList:[],onSubjectChange:function(e,t){var i=this,a=i.module.data.get("subjectMktKeywordConfig")||{},n=[];a&&a.trace&&(n=a.trace),i.subjectKeywordsRegexOverrided||(i.subjectKgex=new RegExp("("+n.join("|")+")","i")));var o=i.subjectKeywordsRegex.exec($.String.trim(e));o?($.Log.cache({compose_mailtrace_keyword_match:o[0]}),i.smallGuideTipsShow("subjectKeywords",(function(){t()}))):t()},initialize:function(e){m.superClass.initialize.call(this,e)},init:function(){var e=this;$.Ext.mailTracking&&(e.ready={loaded:!1,callbackList:[]},e.uiState={setttingsShow:!1,expireTips:null,setttingsShowLayer:null,smailGuideTips:null,introPopupShow:!1},e.tmpConfig=void 0,e.isPlusMember=!1,m.superClass.init.call(e),e.initInfo(),e.subscribeFileUploaded(),e.subscribeSettingsUpdate())},run:function(){var e=lbackList,(function(e,t){try{t()}catch(e){}})),e.ready.callbackList=[])},onReady:function(e){this.ready.callbackList.push(e),this.run()},listenerComposeOptionChange:function(){var e=this;e.onComposeOptionChangeCallback=function(t){var i=e.module.data;if("text"===t.option||"schedule"===t.option){var a=i.get({component:"text"}),n=i.get({component:"schedule"}),o=a.getChecked(),r=n.getChecked();o||r?e.tipsHide():e.tipsShow()}},$.Listener.listen("compose:optionChange",e.onComposeOptionChangeCallback)},onComposeOptionChangeCallback:function(e){},reset:function(){var e=this;e.ready.loaded=!1,e.ready.callbackList=[],e.uiState.setttingsShow=!1,e.uiState.setttingsShowLayer=null,e.tmpConfig=void 0},destroy:function(){var e=this;$.Listener.unlisten("compose:optionChange",e.onComposeOptionChangeCallback),e.unSubscribeSettingsChange&&e.unSubscribeSettingsChange(),e.unsubscribeFileUploadFinished$&&e.unsubscribeFileUploadFinished$.unsubscribe()},initInfo:function(){var e=this;$.Ud.getProxy({force:!0,field:["product.plus.mailTrackingStatus","webmail.js.mailTrackingConfig","webmail.js.mailTrackingExpireTipsShow"],call:function(t){var i=t["product.plus.mailTrackingStatus"],o=t["webmail.js.mailTrackingConfig"],r=t["webmail.js.mailTrackingExpireTipsShow"],c=e.tryParseUdProxyString(o);c&&(n=c,e.tmpConfig=e.tryParseUdProxyString(o),n.expireTipsShow=r);var l=e.tryParseUdProxyString(i);l&&(2!==(a=l).type&&3!==a.type||e.statusBalanceSync(),e.statusIsAvailable())?s.default.getSettings((function(t){e.initSettings(t),e.ready.loaded=!0,e.run(),e.showTipsOrNot()})):(e.ready.loaded=!0,e.run(),e.showTipsOrNot())}}),$.Ud.getProxy({field:["product.vipMember"],call:function(t){e.isPlusMember=t["product.vipMember"]}})},initSettings:function(e){p=this.resolveSettings(e),this.tmpSettings=$.Object.clone(p)},initKeywords:function(){function e(e){try{var t=JSON.parse(e.responseText||e.response);m.prototype.subjectKeywordsRegex=new RegExp("("+t.words.join("|")+")","i")}catch(e){}}var t=$.Uri.getUrl("compose_trace_keyword",!0);try{$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:t,call:function(t){e(t)}})}catch(a){try{var i=new XDomainRequest;i.open("GET",t),i.onload=function(){e(i)},i.send()}catch(e){}}},resolveSettings:function(e){function t(e){var t=["",""],i=$.Array.has(e,"webPush");t[0]=i?"webPush":"";var a=$.Array.has(e,"mail");return t[1]=a?"mail":"",t}return e.mailTraceRemindOpt.read=t(e.mailTraceRemindOpt.read),e.mailTraceRemindOpt.unread=t(e.mailTraceRemindOpt.unread),e.attTraceRemindOpt.read=t(e.attTraceRemindOpt.read),e.attTraceRemindOpt.unread=t(e.attTraceRemindOpt.unread),e},subscribeFileUploaded:function(){var e=this,t=e.module.attach;e.unsubscribeFileUploadFinished$.subscribe((function(){e.attachUploadSceneTrigger()}))},subscribeSettingsUpdate:function(){var e=this;e.unSubscribeSettingsChange=s.default.subscribeSettingsChange((function(t){p=t,e.tmpSetConfigGetSet:functionh:e.settingsGetSetCreator("mailTraceEnable"),attachTraceSwitch:e.settingsGetSetCreator("attTraceEnable"),mailTraceReadNoticeByMail:e.settingsGetSetCreator("mailTraceRemindOpt.read[1]"),mailTraceReadNoticeByDialog:e.settingsGetSetCreator("mailTraceRemindOpt.read[0]"),mailTraceUnReadNoticeByMail:e.settingsGetSetCreator("mailTraceRemindOpt.unread[1]"),mailTraceUnReadNoticeByDialog:e.settingsGetSetCreator("mailTraceRemindOpt.unread[0]"),attachTraceReadNoticeByMail:e.settingsGetSetCreator("attTraceRemindOpt.read[1]"),attachTraceReadNoticeByDialog:e.settingsGetSetCreator("attTraceRemindOpt.read[0]"),attachTraceUnReadNoticeByMail:e.settingsGetSetCreator("attTraceRemindOpt.unread[1]"),attachTraceUnReadNoticeByDialog:e.settingsGetSetCreator("attTraceRemindOpt.unread[0]")}},showTipsOrNot:function(){var e=this;e.module.base.onContentLoaded((function(){e.onReady((function(){var t=e.tipsCanShow();e.trailTipsToggle(t)}))}))},fetchStatus:function(){$.Ud.getProxy({force:!0,field:["product.plus.mailTrackingStatus"],call:function(e){var t=e["product.plus.mailTrackingStatus"];try{$.Object.extend(a,JSON.parse(t))}catch(e){$.Log.cache({compose_ud_error:{type:"parse",response:t}})}}})},configUpdate:function(e,t,i){var a=this,o={};$.Object.defaults(o,n),$.Object.defaults(o,e),o=$.Object.pick(o,["enable","remindAtFirstTime","remindAfter72hours","composeTrialTipCloseTime","mboxTrialTipCloseTime","pushTipCloseTime","mboxNpsClose","mboxRenewTipCloseTime","globalTriggerPopupShowTime","usedGroup","hasEnabledAttachTrace"]);var r=JSON.stringify(o);i&&a.configLoadingShow(i),$.Ud.setProxy({field:"webmail.js.mailTrackingConfig",value:r,call:function(e){n=o,a.tmpConfig=$.Object.clone(o),i&&a.configLoadingHide(i),t&&t()}})},fetchConfig:function(){var e="webmail.js.mailTrackingConfig";$.Ud.udProxy[e]=void 0,$.Ud.getProxy({force:!0,field:[e],call:function(e){var t=e["webmail.js.mailTrackingConfig"];try{$.Object.extend(n,JSON.parse(t))}catch(e){$.Log.cache({compose_ud_error:{type:"parse",response:t}})}}})},tryParseUdProxyString:function(e){try{return JSON.parse(e)}catch(t){$.Log.cache({compose_ud_error:{type:"parse",response:e}})}return null},statusGetRaw:function(){return a},statusGetPackageInfo:function(){switch(a.type){case 0:switch(a.typeBefore){case 1:return d.t("æœ‰æ•ˆæœŸè‡³ï¼š")+$.Date.format(new Date(a.expireTime),"yyyy-MM-dd");case 2:return d.t("å‰©ä½™å°æ•°ï¼š")+0+d.t("å°");default:return""}case 1:return d.t("æœ‰æ•ˆæœŸè‡³ï¼š")+$.Date.format(new Date(a.expireTime),"yyyy-MM-dd");case 2:case 3:return d.t("å‰©ä½™å°æ•°ï¼š")+a.remainCount+d.t("å°");default:return""}},statusGetSubTitle:function(){var e=this,t=e.statusGetRaw();return 0!==t.type||t.typeBefore?t.type>0?d.t(e.text.statusSubTitleAvailable)||d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»"):1===t.typeBefore?d.t(e.text.statusSubTitleMonthlyExpire)||d.t("å·²åˆ°æœŸï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹"):2===t.typeBefore?d.t(e.text.statusSubTitleBalanceExpire)||d.t("å¯ç”¨å°æ•°ä¸è¶³ï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹"):3===t.typeBefore?d.t(e.text.statusSubTitleTrialExpire)||d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»"):void 0:d.t(e.text.statusSubTitleRaw)||d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»")},statusIsAvailable:function(){return a?a.type:0},statusIsExpire:function(){return a&&0===a.type&&a.typeBefore>0},statusCanTrial:function(){return a&&0===a.type&&!1===a.beenTrialed&&!a.typeBefore},statusBalanceSync:function(){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:{},rnd:!0,url:$.Uri.getUrl("mailTrackingStatus",!0),head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var t=JSON.parse(e.responseText),i=t.result||{};a.remainCount=i.remainCnt||0,t.code}catch(e){}}})},mailDisable:function(e,t){var i=this;i.mailSettingDisable((function(){i.iconHighlightToggle({enabled:!1}),e&&e(),$.Listener.fire("compose:mailTraceToggle",!1)}),t)},mailEnable:function(e,t){var i=this;i.mailSettingEnable((function(){i.iconHighlightToggle({enabled:!0}),e&&e(),$.Listener.fire("compose:mailTraceToggle",!0)}),t)},localDisable:function(){var e=this;e.tmpSettings&&(e.tmpSettings&&(e.tmpSettings.mailTraceEnable=!1),e.iconHighlightToggle({enabled:!1}),$.Listener.fire("compose:mailTraceToggle",!1))},localEnable:function(){var e=this;e.tmpSettings&&(e.tmpSettings&&(e.tmpSettings.mailTraceEnable=!0),e.iconHighlightToggle({enabled:!0}),$.Listener.fire("compose:mailTraceToggle",!0))},enableAndShowGuide:function(){var e=this;s.default.getSettings((function(t){e.initSettings(t),e.mailEnable((function(){e.fetchStatus(),e.trailTipsToggle(!1)})),e.guidePopupShow()}))},attachEnable:function(e,t){var i=this;i.hasEnabledAttachTrace()||i.configUpdate({hasEnabledAttachTrace:!0}),i.settingsUpdate({attTraceEnable:!0},(function(){e&&e(),$.Listener.fire("compose:attachTraceToggle",!0)}),t)},attachDisable:function(e,t){this.settingsUpdate({attTraceEnable:!1},(function(){e&&e(),$.Listener.fire("compose:attachTraceToggle",!1)}),t)},attachIsEnable:function(){var e=this.settingsGet();return this.mailIsEnabled()&&e.attTraceEnable},attachIsEnableInView:function(){return this.settingsGet().attTraceEnable},mailSettingEnable:function(e,t){this.settingsUpdate({mailTraceEnable:!0},e,t)},mailSettingDisable:function(e,t){this.settingsUpdate({mailTraceEnable:!1},e,t)},mailIsEnabled:function(){var e=this.settingsGet();return!!((a||{type:0}).type>0&&e)&&e.mailTraceEnable},configEnableRemindAtFirstTime:function(e,t){this.configUpdate({remindAtFirstTime:!0},e,t)},configDisableRemindAtFirstTime:function(e,t){this.configUpdate({remindAtFirstTime:!1},e,t)},configEnableRemindAfter72hours:function(e,t){this.configUpdate({remindAfter72hours:!0},e,t)},configDisableRemindAfter72hours:function(e,t){this.configUpdate({remindAfter72hours:!1},e,t)},configCloseTips:function(){this.configUpdate({composeTrialTipCloseTime:$.Misc.getTime().getTime()})},configExpireTipsShow:function(){$.Ud.setProxy({field:"webmail.js.mailTrackingExpireTipsShow",value:!1,call:function(e){n.expireTipsShow=!1}})},configExpireTipsRest:function(){$.Ud.setProxy({field:"webmail.js.mailTrackingExpireTipsShow",value:!0,call:function(e){n.expireTipsShow=!0}})},configLoadingShow:function(e){e.getEl().addClass("loading")},configLoadingHide:function(e){e.getEl().removeClass("loading")},configIntroPopupShow:function(e){var t=this,i=t.configGet(),a=$.Object.pick(i,["enable","remindAtFirstTime","remindAfter72hours","composeTrialTipCloseTime","mboxTrialTipCloseTime","pushTipCloseTime","mboxNpsClose","mboxRenewTipCloseTime","composeIntroPopupShow"]);a.composeIntroPopupShow=!0;var n=JSON.stringify(a);$.Ud.setProxy({field:"webmail.js.mailTrackingConfig",value:n,call:function(e){t.fetchConfig()}})},configGlobalGuideShow:function(){this.configUpdate({globalTriggerPopupShowTime:$.Misc.getTime().getTime()})},configGetRaw:function(){return n},configSetRaw:function(e){n=e},configGet:function(){if(n){var e=$.Object.clone(n);return $.Object.extend(e,this.tmpConfig||{}),e}},configIsRemindAtFirstTime:function(){return this.configGet().remindAtFirstTime},configIsRemindAfter72hours:h,configIsAttachTrace:h,configCanGlobalGuideShow:function(){return $.Misc.getTime().getTime()-(n.globalTriggerPopupShowTime||0)>=6048e5},isUsedGroup:function(){return this.configGet().usedGroup},hasEnabledAttachTrace:function(){return this.configGet().hasEnabledAttachTrace},mailCanEnable:function(){var e=this.isConflictWithOtherOptions();return{result:!e.result,reason:e.reason}},cmpGetAttachTraceSwitch:function(e){var t=this;return new $.Checkbox({subclass:"switch",checked:e,extcls:"Sky-gCmp-main-mailtrace-settings-switch",checkedchange:function(e){var i=this;i.setChecked(!e,!0),e?t.attachEnable((function(){i.setChecked(e,!0)}),i):t.attachDisable((function(){i.setChecked(e,!0)}),i),t.log("compose_attachtrace_settings_switch_click",{targetValue:e})}})},cmpGetMoreSettingsLink:function(e){var t=this;return new $.Link({cls:"Sky-gCmp-main-mailtrace-settings-link",text:d.t("å»è®¾ç½®"),click:function(){t.moreSettingsDialogShow(),e&&e()}})},cmpGetCheckbox:function(e,t,i){return $.Checkbox.html({disabled:void 0!==i&&!i,checked:e.get(),extcls:"Sky-gCmp-main-mailtrace-settings-checkbox",checkedchange:function(i){var a=i?t[0]:t[1];e.set(a)}})},settingsGet:function(){if(p){var e=$.Object.clone(p);return $.Object.extend(e,this.tmpSettings||{}),e}},settingsGetSetCreator:function(e,t){var i=this;return{get:function(){var t=i.settingsGet();if(t)return new Function("settings","return settings."+e)(t)},set:function(t){var a=$.Object.clone(i.tmpSettings),n=$.Object.clone(a);new Function("settings","settings."+e+"="+JSON.stringify(t))(n),i.localSettingsUpdate(n)}}},settingsUpdate:function(e,t,i){var a=this,n={};$.Object.defaults(n,p),$.Object.defaults(n,e),i&&a.configLoadingShow(i),s.default.syncSettings(n,(function(e){p=e,a.tmpSettings=$.Object.clone(e),i&&a.configLoadingHide(i),t&&t()}))},moreSettingsDialogShow:function(){var e=this,t=e.settingsActions,i=e.mailIsEnabled(),a=e.attachIsEnable(),n=[[d.t("å¯¹æ–¹é¦–æ¬¡æ‰“å¼€æ—¶æé†’æˆ‘"),e.cmpGetCheckbox(t.mailTraceReadNoticeByDialog,["webPush",""],i),e.cmpGetCheckbox(t.mailTraceReadNoticeByMail,["mail",""],i)],[d.t("å¯¹æ–¹72å°æ—¶å†…æœªæ‰“å¼€æé†’æˆ‘"),e.cmpGetCheckbox(t.mailTraceUnReadNoticeByDialog,["webPush",""],i),e.cmpGetCheckbox(t.mailTraceUnReadNoticeByMail,["mail",""],i)]],o=[[d.t("å¯¹æ–¹é¦–æ¬¡ä¸‹è½½é™„ä»¶æ—¶æé†’æˆ‘"),e.cmpGetCheckbox(t.attachTraceReadNoticeByDialog,["webPush",""],a),e.cmpGetCheckbox(t.attachTraceReadNoticeByMail,["mail",""],a)],[d.t("å¯¹æ–¹72å°æ—¶å†…æœªä¸‹è½½æé†’æˆ‘"),e.cmpGetCheckbox(t.attachTraceUnReadNoticeByDialog,["webPush",""],a),e.cmpGetCheckbox(t.attachTraceUnReadNoticeByMail,["mail",""],a)]],r="Sky-gCmp-main-mailtrace-settings-",s=[{text:d.t("é‚®ä»¶è¿½è¸ªæé†’"),cls:r+"name"},{text:d.t("å¼¹çª—é€šçŸ¥"),cls:r+"check"},{text:d.t("é‚®ä»¶é€šçŸ¥"),cls:r+"check"}],c=[{text:d.t("é™„ä»¶è¿½è¸ªæé†’"),cls:r+"name"},{text:d.t(""),cls:r+"check"},{text:d.t(""),cls:r+"check"}];function l(e,t){return $.Table.html({headCells:e,bodyCells:$.Array.map(t,(function(e,t){return[{text:t[0],cls:r+"name"},{text:t[1],cls:r+"check"},{text:t[2],cls:r+"check"}]}))})}var u=l(s,n),m=l(c,o),p='<div class="Sky-gCmp-main-mailtrace-settings-msgbox-title">'+d.t("æé†’æ–¹å¼")+"</div>";$.Msgbox.show({statsKey:"Compose_Guide_Dialog_TraceSettings",extcls:"Sky-gCmp-main-mailtrace-settings-msgbox",contentType:"custom",noHeader:!0,content:[p,'<div class="Sky-gCmp-main-mailtrace-settings-msgbox-body">',u,'<div style="height:20px"></div>',m,'<div style="height:20px"></div>',"</div>"].join(""),ok:function(){e.localSettingsSync(),console.log("ok!!!")},cancel:function(){console.log("cancel")}})},localSettingsUpdate:function(e){var t={},i=$.Object.clone(p);$.Object.defaults(t,i),$.Object.defaults(t,e),this.tmpSettings=t},localSettingsSync:function(e){function t(e){$.Array.remove(e,(function(e){return!e}),!0)}var i=$.Object.clone(this.tmpSettings);t(i.attTraceRemindOpt.read),t(i.attTraceRemindOpt.unread),t(i.mailTraceRemindOpt.read),t(i.mailTraceRemindOpt.unread),console.log(i),s.default.syncSettings(i,(function(){p=i}))},localSettingsDrop:function(){this.tmpSettings=$.Object.clone(p)},renderSettingsRight:function(e){return'<div class="Sky-gCmp-main-mailtrace-settings-item-right">'+e+"</div>"},tipsRender:function(){var e=this.module.getDom("mkttips"),t=this.tipsGet();e&&(e.innerHTML=t,$.Component.setEvents())},tipsGet:function(){var e=this;switch(e.tipsGetType()){case-2:return e.trailTipsCreate();case-1:return e.openTipsCreate();default:return""}},tipsGetType:function(){return!1!==a.beenTrialed||0!==a.type||a.typeBefore?!a.beenTrialed||0!==a.type||a.typeBefore&&3!==a.typeBefore?a.type:-1:-2},tipsCanShow:function(){var e=$.Misc.getTime().getTime()-(n.composeTrialTipCloseTime||0)>=6048e5;return!this.isConflictWithOtherOptions().result&&e},tipsHide:function(){var e=this.module.getDom("mkttips");e&&e.firstElementChild&&(e.firstElementChild.style.display="none")},tipsShow:function(){var e=this.module.getDom("mkttips");e&&(0===!e.childNodes?this.tipsRender():e.firstElementChild&&(e.firstElementChild.style.display="inline-block"))},trailTipsCreate:function(){var e=this,t=(e.module,$.Link.html({text:d.t("ç«‹å³ä½“éªŒ"),extcls:"Sky-gCmp-mailtrace-link",click:function(){e.log("compose_mailtrace_trialtips_click"),e.trialNow()},onRender:function(){e.log("compose_mailtrace_trialtips_show")}})),i=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-close"></span>',listeners:[{name:"click",type:"dom",handler:function(){e.trailTipsClose()}}]});return['<div class="Sky-gCmp-mailtrace-trail-tips Sky-gCmp-mailtrace-tips">','<span class="Sky-gCmp-mailtrace-icon"></span>','<span class="Sky-gCmp-mailtrace-tipstxt">'+d.t("æ–°åŠŸèƒ½ä½“éªŒï¼šéšæ—¶æŸ¥çœ‹é‚®ä»¶çŠ¶æ€ï¼Œç¡®è®¤å¯¹æ–¹æ˜¯å¦å·²é˜…è¯»")+"</span>",t,i,"</div>"].join("")},trailTipsToggle:function(e){var t=this.module.find(".Sky-gCmp-mailtrace-trail-tips");t&&(e?t.css({display:"inline-block"}):t.hide())},trailTipsClose:function(){var e=this,t=e.module;e.configCloseTips();var i=t.find(".Sky-gCmp-mailtrace-trail-tips");i&&(i.hide(),e.log("compose_mailtrace_trialtips_close_click"))},openTipsCreate:function(){var e=this,t=(e.module,!1);try{var i=$.Misc.getTime();i>=16822656e5&&i<=16835616e5&&(t=!0)}catch(e){}var a=$.Link.html({text:d.t(t?"å¼€å¯æé†’":"ç«‹å³å¼€é€š"),extcls:"Sky-gCmp-mailtrace-link",click:function(){e.buy("mailtrack_delivery_tips_enable"),e.log("compose_mailtrace_opentips_click")},onRender:function(){e.log("compose_mailtrace_opentips_show")}}),n=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-close"></span>',listeners:[{name:"click",type:"dom",handler:function(){e.trailTipsClose(),e.log("compose_mailtrace_opentips_close_click")}}]});return['<div class="Sky-gCmp-mailtrace-trail-tips Sky-gCmp-mailtrace-trail-tips">','<span class="Sky-gCmp-mailtrace-icon"></span>','<span class="Sky-gCmp-mailtrace-tipstxt">'+d.t(t?"ã€é‚®ä»¶è¿½è¸ªã€‘å‘å‡ºé‡è¦é‚®ä»¶ï¼Œå¯¹æ–¹æ˜¯å¦æŸ¥çœ‹ï¼Ÿ":"æ–°åŠŸèƒ½ï¼šéšæ—¶æŸ¥çœ‹é‚®ä»¶çŠ¶æ€ï¼Œç¡®è®¤å‘å‡ºé‚®ä»¶æ˜¯å¦è¢«å¯¹æ–¹é˜…è¯»")+"</span>",a,n,"<div>"].join("")},expireTipsShow:function(){var e,t,i=(t=(e=this).module).data.get({component:"mailTraceLink"}),o=!1;if(n.expireTipsShow&&(t=(e=this).module).find(".Sky-gCmp-main-footer-mailtrace-text")){var r=1===a.typeBefore?e.text.monthlyExpireTips:e.text.balanceExpireTips,s=1===a.typeBefore?"compose_mailtrace_monthly_expire_show":"compose_mailtrace_single_expire_show",c=1===a.typeBefore?"compose_mailtrace_monthly_expire_ok_click":"compose_mailtrace_single_expire_ok_click",l=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok">'+d.t("ç¡®å®š")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){m.destroy(),m=null,e.log(c),e.buy(c)}}]}),u=t.getDom("main"),m=new $.Layer({extcls:"Sky-gCmp-mailtrace-guide-popup Sky-gCmp-mailtrace-expire-guide-popup",items:[{html:d.t(r)},{html:l}],params:"hasArr arrDown",renderTo:u,onRender:function(){e.log(s),e.configExpireTipsShow(),e.uiState.expireTips=this,$.Component.setEvents()},listeners:[{name:"destroy",handler:function(){e.uiState.expireTips=null}},{name:"hide",handler:function(){setTimeout((function(){m.destroy(),m=null}),0)}}]});m.pointTo(i.getEl(),$.fly(u)),o=!0}return o},attachTipsCreate:function(){var e=this,t=e.module.attach,i=d.t("ä¸ºä¿è¯è¿½è¸ªæ•ˆæœï¼Œé™„ä»¶ä½œä¸ºè¶…å¤§é™„ä»¶ä¸Šä¼ ï¼Œ${day}å†…æœ‰æ•ˆã€‚è‹¥è¢«åˆ é™¤æˆ–è¿‡æœŸï¼Œæ”¶ä»¶äººå°†æ— æ³•ä¸‹è½½ã€‚"),a=$S("cloud"),n=a?a.duration:"15";return(i=i.replace("${day}",'<span style="color: #FF0000">'+n+d.t("å¤©")+"</span>"))+$.Link.html({onRender:function(){e.log("compose_mailtrace_attach_tips_show")},text:d.t("å…³é—­é™„ä»¶è¿½è¸ª"),click:function(){e.attachDisable(),t.prompt({remove:!0}),e.log("compose_mailtrace_attach_tips_disable_click")}})},attachPostUploadTipsCreate:function(){var e=this.module,t=(e.attach,e.data);return d.t("å½“å‰ä¸Šä¼ æ¨¡å¼ï¼ˆå…¼å®¹æ¨¡å¼ï¼‰ä¸æ”¯æŒè¿›è¡Œé™„ä»¶è¿½è¸ªï¼Œå¦‚éœ€è¿›è¡Œé™„ä»¶è¿½è¸ªè¯·ä¿®æ”¹é™„ä»¶æ¨¡å¼è®¾ç½®ã€‚")+$.Link.html({text:d.t("ä¿®æ”¹è®¾ç½®"),click:function(){var e=t.get({component:"toolbar"}).find("#compose_setting_btn");e&&e.getDom().click()}})},introDialogCreator:function(e){var t=this,i=(t.module,'<div style="width:392px;height:306px;margin-top:16px;border:1px solid #E3E5EC;border-radius:4px;overflow:hidden;"><img style="width:392px;" src="'+e.img+'"/></div>'),a=[];e.cancelText&&a.push({text:d.t(e.cancelText||"æš‚ä¸ä½“éªŒ"),click:function(){t.log(e.statsKey+"_NoNeed"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),e.cancel&&e.cancel()}}),e.okText&&a.push({text:d.t(e.okText||"ç«‹å³ä½“éªŒ"),subclass:"mainBtn",click:function(){t.log(e.statsKey+"_OK"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),e.ok&&e.ok()}}),$.Msgbox.show({extcls:"Sky-gCmp-mailtrace-guide-dialog",noHeader:!0,statsKey:e.statsKey,contentType:"normal",statsValue:t.getLogParam(),title:'<div  style="color:#000000;">'+d.t(e.title)+"</div>",content:'<div class="Sky-gCmp-mailtrace-guide-dialog-content" style="color:#585E6D;" >'+d.t(e.content)+"<p/>"+i,buttons:a})},trialNow:function(){var e=this;e.module,$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceTrial",statsValue:e"æ–°åŠŸèƒ½ä½“éªŒï¼šé‚®ä»¶è¿½è¸ª")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("é‚®ä»¶å‘é€åå¯å‰å¾€â€œå·²å‘é€â€é¡µç¡®è®¤å¯¹æ–¹æ˜¯å¦å·²é˜…è¯»æ‚¨æ‰€å‘é€çš„é‚®ä»¶ï¼ˆæ”¶ä»¶äººæ— æ„ŸçŸ¥ï¼‰ã€‚å¦‚æœåŒæ—¶å¼€å¯äº†é™„ä»¶è¿½è¸ªï¼Œæ‚¨è¿˜å¯ä»¥æŸ¥çœ‹æ”¶ä»¶äººæ˜¯å¦ä¸‹è½½äº†æ‚¨çš„é™„ä»¶ã€‚")+'<p/><div style="width:345px;height:270px;margin-top:16px;border:1px solid #E3E5EC;border-radius:4px;overflow:hidden;"><img style="width:345px;" src="https://mail-activity.nos-jd.163yun.com/4ea67e5532182dfe2e51837b3d50a4c8.gif"/></div>',buttons:[{text:d.t("æš‚ä¸éœ€è¦"),click:function(){e.log("Compose_Guide_Popup_MailTraceTrial_NoNeed"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close()}},{text:d.t("ç«‹å³ä½“éªŒ"),subclass:"mainBtn",click:function(){e.log("Compose_Guide_Popup_MailTraceTrial_OK"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),e.guideEnable()}}]})},guideEnable:function(e){var t=this;s.default.trial((function(i){i&&(a.remainCount=i,t.enableAndShowGuide(),e&&e())}))},guidePopupShow:function(){var e,t,i,a=this,n=a.module,o=n.getEl("main"),r=n.find(".Sky-gCmp-main-footer-mailtrace-text");function s(e,t,i,a){var n={right:"unset",left:t.left-20+"px",top:t.top-84-6+(i||0)+"px",bottom:"unset"};a&&(n.width=a),e.el.css(n)}function c(t,i){var a=n.container.querySelectorAll(".eq2"),o=a[0],r=a[1],s=o.getBoundingClientRect(),c=r.getBoundingClientRect();e.el.css({position:"absolute",zIndex:99,width:parseInt(c.left-s.left-2)+"px",height:i.height+"px",left:Math.ceil(s.left+1)+"px",top:i.top+"px"})}var l=$.Misc.debounce((function(){var e=r.dom.getBoundingClientRect();s(i,e),c(0,e)}),500,!1);if(r){var u=$.Misc.debounce((function(){var n=r.dom.getBoundingClientRect();$.Component.html({html:'<span class="Sky-gCmp-mailtrace-trail-guide-popup-bg"></span>',renderTo:document.body,onRender:function(){e=this,c(0,n)}}),$.Component.html({html:'<span class="Sky-gCmp-mailtrace-trail-guide-popup-bg-layer"></span>',rs}});var m=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok Sky-gCmp-mailtrace-trail-guide-popup-ok">'+d.t("ç¡®å®š")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){i.close(),e.destroy(),t.destroy(),t=null,i=null,e=null}}]}),p=a.isPlusMember,f=p?d.t("å·²ä¸ºä½ å¼€å¯é‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œä¼šå‘˜ç”¨æˆ·å°Šäº«æ¯æœˆ5å°é‚®ä»¶è¿½è¸ªé¢åº¦ã€‚"):d.t("å·²ä¸ºä½ å¼€å¯é‚®ä»¶è¿½è¸ªåŠŸèƒ½ã€‚"),h=p?"Sky-gCmp-mailtrace-trail-plus-guide-popup":"",g=p?-20:0,v=p&&!$G.environment.isCh?"240px":"";i=$.Popup.show({pauseTime:15e3,extcls:"Sky-gCmp-mailtrace-guide-popup Sky-gCmp-mailtrace-trail-guide-popup "+h,content:f+'<span class="Sky-gCmp-mailtrace-guide-popup-angle"></span>'+m,listeners:[{name:"destroy",handler:function(){o.css({overflow:""}),window.removeEventListener("resize",l)}}],onRender:function(){s(this,n,g,v),o.css({overflow:"hidden"}),$.Component.setEvents(),window.addEventListener("resize",l)}}),$.Event.unlisten(o,"scroll",u)}),150,!1),m=o.dom.scrollHeight!==o.dom.clientHeight,p=o.dom.scrollTop+o.dom.clientHeight<o.dom.scrollHeight;m&&p?(r.dom.scrollIntoView({behavior:"smooth",block:"start"}),$.Event.listen(o,"scroll",u)):u()}},guidePopupShowAfterEntry:function(){var e=this;if(e.module.data.get({status:"entryExtends"}).trailMailTrace)return e.enableAndShowGuide(),!0;e.configGet();var t=e.isConflictWithOtherOptions(),i=!t||!t.result;return!(!e.statusCanTrial()||!i)&&(!!e.configCanGlobalGuideShow()&&(e.introPopupShow(),!0))},v2GroupSendIntro:function(){var e={statsKey:"Compose_Guide_Popup_MailTrace_GroupSend",title:d.t("åŠŸèƒ½å‡çº§ï¼šç¾¤å‘è¿½è¸ª"),content:d.t("é‚®ä»¶è¿½è¸ªåŠŸèƒ½å…¨æ–°å‡çº§ï¼Œå·²æ”¯æŒç¾¤å‘é‚®ä»¶è¿½è¸ªï¼Œå‘ä¿¡åå¯æŸ¥çœ‹å„æ”¶ä»¶äººçš„é‚®ä»¶é˜…è¯»çŠ¶æ€ã€‚"),img:"https://mail-activity.nos-jd.163yun.com/aa7ff697632267600d2d38ea5d340894.gif"};e.okText=d.t("æˆ‘çŸ¥é“äº†"),this.introDialogCreator(e)},v2GroupSendExpiredIntro:function(){var e=this,t={statsKey:"Compose_Guide_Popup_MailTrace_GroupSendExpired",title:d.t("åŠŸèƒ½å‡çº§ï¼šç¾¤å‘è¿½è¸ª"),content:d.t("é‚®ä»¶è¿½è¸ªåŠŸèƒ½å…¨æ–°å‡çº§ï¼Œå·²æ”¯æŒç¾¤å‘é‚®ä»¶è¿½è¸ªï¼Œå‘ä¿¡åå¯æŸ¥çœ‹å„æ”¶ä»¶äººçš„é‚®ä»¶é˜…è¯»çŠ¶æ€ã€‚"),img:"https://mail-activity.nos-jd.163yun.com/aa7ff697632267600d2d38ea5d340894.gif"};t.cancelText=d.t("æˆ‘çŸ¥é“äº†"),t.okText=d.t("ç«‹å³å¼€é€š"),t.ok=function(){e.buy("mailtrack_popup_gourpmail")},e.introDalogCreator({statsKey:"Compose_Guide_Popup_MailTrace_AttachTrace",img:"https://mail-activity.nos-jd.163yun.com/f5bb623c7a11b4f563545889e5344e1f.gif",title:"åŠŸèƒ½å‡çº§ï¼šé™„ä»¶è¿½è¸ª",content:"é‚®ä»¶è¿½è¸ªå…¨æ–°å‡çº§â€œé™„ä»¶è¿½è¸ªâ€åŠŸèƒ½ï¼Œå¼€å¯åé™¤è¿½è¸ªé‚®ä»¶é˜…è¯»çŠ¶æ€å¤–ï¼Œæ‚¨è¿˜å¯ä»¥æŸ¥çœ‹æ”¶ä»¶äººæ˜¯å¦ä¸‹è½½äº†æ‚¨çš„é™„ä»¶ï¼ˆç¾¤å‘å¯æŸ¥çœ‹å„æ”¶ä»¶äººä¸‹è½½æƒ…å†µï¼‰ã€‚",okText:"ç«‹å³å¼€å¯",cancelText:"æˆ‘çŸ¥é“äº†",ok:function(){e.log("Compose_Guide_Popup_MailTrace_AttachTrace_Enable_Click"),e.attachEnable((function(){e.attachGuidePopupShow()}))}})},attachTraceExpiredIntro:function(){var e=this;e.module,e.introDialogCreator({statsKey:"Compose_Guide_Popup_MailTrace_AttachTraceExpired",img:"https://mail-activity.nos-jd.163yun.com/f5bb623c7a11b4f563545889e5344e1f.gif",title:"åŠŸèƒ½å‡çº§ï¼šé™„ä»¶è¿½è¸ª",content:"é‚®ä»¶è¿½è¸ªå…¨æ–°å‡çº§â€œé™„ä»¶è¿½è¸ªâ€åŠŸèƒ½ï¼Œå¼€å¯åé™¤è¿½è¸ªé‚®ä»¶é˜…è¯»çŠ¶æ€å¤–ï¼Œæ‚¨è¿˜å¯ä»¥æŸ¥çœ‹æ”¶ä»¶äººæ˜¯å¦ä¸‹è½½äº†æ‚¨çš„é™„ä»¶ï¼ˆç¾¤å‘å¯æŸ¥çœ‹å„æ”¶ä»¶äººä¸‹è½½æƒ…å†µï¼‰ã€‚",okText:"ç«‹å³å¼€é€š",cancelText:"æˆ‘çŸ¥é“äº†",ok:function(){e.log("Compose_Guide_Popup_MailTrace_AttachTrace_Buy_Click"),e.buy("mailtrack_popup_filetrack")}})},buy:function(e){this.module.base.send({action:"save"});var t=($S("isVip")?"vip_":"")+e;c.default.showMailTraceBuy(t,(function(){}))},attachGuidePopupShow:function(){$G.environment.isCh?this.guidePopupCreator({content:"å·²ä¸ºä½ å¼€å¯é™„ä»¶è¿½è¸ªåŠŸèƒ½ã€‚"}):this.guidePopupCreator({width:"240px",content:"å·²ä¸ºä½ å¼€å¯é™„ä»¶è¿½è¸ªåŠŸèƒ½ã€‚"})},guidePopupCreator:function(e){var t,i,a,n=this,o=n.module,r=o.getEl("main"),s=o.find(".Sky-gCmp-main-footer-mailtrace-text");function c(e,t,i,a){var n={right:"unset",left:t.left-20+"px",top:t.top-84-6+(i||0)+"px",bottom:"unset"};a&&(n.width=a),e.el.css(n)}function l(e,i){var a=o.container.querySelectorAll(".eq2"),n=a[0],r=a[1],s=n.getBoundingClientRect(),c=r.getBoundingClientRect();t.el.css({position:"absolute",zIndex:99,width:c.left-s.left-2+"px",height:i.height+"px",left:Math.ceil(s.left+1)+"px",top:i.top+"px"})}var u=$.Misc.debounce((function(){var e=s.dom.getBoundingClientRect();c(a,e),l(0,e)}),500,!1);if(s){var m=$.Misc.debounce((function(){var o=s.dom.getBoundingClientRect();$.Component.html({html:'<span class="Sky-gCmp-mailtrace-trail-guide-popup-bg"></span>',renderTo:document.body,onRender:function(){t=this,l(0,o)}}),$.Component.html({html:'<span class="Sky-gCmp-mailtrace-trail-guide-popup-bg-layer"></span>',renderTo:document.body,onRender:function(){i=this}});var p=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok Sky-gCmp-mailtrace-trail-guide-popup-ok">'+d.t("ç¡®å®š")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){a.close(),t.destroy(),i.destroy(),i=null,a=null,t=null}}]}),f=n.isPlusMember,h=d.t(e.content),g=f?"Sky-gCmp-mailtrace-trail-plus-guide-popup":"",v=f?-20:0,b=e.width;a=$.Popup.show({pauseTime:15e3,extcls:"Sky-gCmp-mailtrace-guide-popup Sky-gCmp-mailtrace-trail-guide-popup "+g,content:h+'<span class="Sky-gCmp-mailtrace-guide-popup-angle"></span>'+p,listeners:[{name:"destroy",handler:function(){r.css({overflow:""}),window.removeEventListener("resize",u)}}],onRender:function(){c(this,o,v,b),r.css({overflow:"hidden"}),$.Component.setEvents(),window.addEventListener("resize",u)}}),$.Event.unlisten(r,"scroll",m)}),150,!1),p=r.dom.scrollHeight!==r.dom.clientHeight,f=r.dom.scrollTop+r.dom.clientHeight<r.dom.scrollHeight;p&&f?(s.dom.scrollIntoView({behavior:"smooth",block:"start"}),$.Event.listen(r,"scroll",m)):m()}},introPopupShow:function(){var e,t=this,i=(e=t.module).data,a=e.getEl("main"),n=i.get({component:"mailTraceLink"}),o='<div><div style="width:256px;height:200px;border:1px solid #E3E5EC;border-radius:4px;box-sizing:border-box;overflow:hidden;"><img style="width:254px;" src="https://mail-activity.nos-jd.163yun.com/4ea67e5532182dfe2e51837b3d50a4c8.gif"/></div>'+('<div style="color:#21293A;font-size: 14px; line-height: 20px;font-weight: bold;margin-bottom: 8px;margin-top:12px">'+d.t("é‚®ä»¶è¿½è¸ªï¼š")+"</div>")+('<div style="color:#394051;font-size: 12px; line-height: 20px;margin-bottom: 16px;">'+d.t("æ”¯æŒæŸ¥çœ‹å·²è¯»çŠ¶æ€ï¼Œå¯¹æ–¹é˜…è¯»äº†é‚®ä»¶åï¼Œå¯å‰å¾€â€œå·²å‘é€â€é¡µç¡®è®¤å¯¹æ–¹æ˜¯å¦å·²çŸ¥æ‚‰ã€‚")+"</div>")+"<div>",r=(e=t.module).find(".Sky-gCmp-main-footer-mailtrace-text"),s="compose_mailtrace_intro_popup_show/"+$S("uid");if(!$.LocalStorage.get(s)&&r){var c=$.Misc.debounce((function(){var i=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok">'+d.t("ç«‹å³ä½“éªŒ")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){u.destroy(),u=null,t.log("compose_mailtrace_intro_popup_ok_click"),t.guideEnable()}}]}),r=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-cancel">'+d.t("æš‚ä¸ä½“éªŒ")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){u.destroy(),u=null,t.log("compose_mailtrace_intro_popup_cancel_click"),$.LocalStorage.set(s,1,{path:"/",expires:t.sceneTriggerConfig.closeDays})}}]}),l=e.getDom("main"),u=new $.Layer({extcls:"Sky-gCmp-mailtrace-guide-popup Sky-gCmp-mailtrace-intro-guide-popup",fixY:-10,items:[{html:o},{html:'<div style="text-align:right;">'+r+i+"</div>"},{html:$.Browser.isIE()?"":'<span class="Sky-gCmp-mailtrace-intro-popup-angle"></span>'}],params:"hasArr arrDown",renderTo:l,onRender:function(){t.log("compose_mailtracn:"destroy",handler:function(){t.uiState.introPopup=null}},{name:"hide",handler:function(){setTimeout((function(){u.destroy(),u=null}),0)}}]});u.pointTo(n.getEl(),$.fly(l)),$.Event.unlisten(a,"scroll",c)}),150),l=a.dom.scrollHeight!==a.dom.clientHeight,u=a.dom.scrollTop+a.dom.clientHeight<a.dom.scrollHeight,m=l&&u,p=e.find(".Sky-gCmp-main-footer-mailtrace-text");m?(p.dom.scrollIntoView({behavior:"smooth",block:"start"}),$.Event.listen(a,"scroll",c)):c()}},markContactGuideSceneTrigger:function(e){try{if(!$.Array.has(e,(function(e){return l.default.isMark(e.address)})))return;this.smallGuideTipsShow("markContact")}catch(e){return}},subjectKeywordsSceneTrigger:function(e){var t=this.subjectKeywordsRegex.exec($.String.trim(e));t&&($.Log.cache({compose_mailtrace_keyword_match:t[0]}),this.smallGuideTipsShow("subjectKeywords"))},groupSendSceneTrigger:function(){var e=this;e.confirmSmallGuideTipsCanShow((function(){e.isUsedGroup()||e.configGet().groupTraceGuideShow||(e.mailIsEnabled()?e.groupSendIntroPopup():e.statusIsExpire()&&e.groupSendExpiredIntroPopup())}))},attachUploadSceneTrigger:function(){var e=this;e.confirmSmallGuideTipsCanShow((function(){e.hasEnabledAttachTrace()||e.configGet().attachTraceGuideShow||(!e.mailIsEnabled()||e.attachIsEnable()?e.statusIsExpire()&&e.attachUploadExpiredIntroPopup():e.attachUploadIntroPopup())}))},attachUploadIntroPopup:function(){var e=this;function t(){e.configUpdate({attachTraceGuideShow:1})}e.popupCreator({scene:"attachUpload",title:"é™„ä»¶è¿½è¸ª",content:"å·²æ”¯æŒé™„ä»¶è¿½è¸ªï¼Œå¼€å¯ååŒ…å«é™„ä»¶çš„é‚®ä»¶æ”¯æŒæŸ¥çœ‹é™„ä»¶ä¸‹è½½çŠ¶æ€ã€‚",key:"compose_mailtrace_attachUploadsmallguide",cancelText:"äº†è§£æ›´å¤š",okText:"æˆ‘çŸ¥é“äº†",close:function(){t()},ok:function(){t()},cancel:function(){e.attachTraceIntro(),t()}})},attachUploadExpiredIntroPopup:function(){var e=this;function t(){e.configUpdate({attachTraceGuideShow:1})}e.popupCreator({scene:"attachUpload",title:"é™„ä»¶è¿½è¸ª",content:"å·²æ”¯æŒé™„ä»¶è¿½è¸ªï¼Œå¼€å¯ååŒ…å«é™„ä»¶çš„é‚®ä»¶æ”chUploadExpiredsmallguide",cancelText:"äº†è§£æ›´å¤š",okText:"æˆ‘çŸ¥é“äº†",close:function(){t()},ok:function(){t()},cancentro(),t()}})},groupSendIntroPopup:fraceGuideShow:1})}e.popupCreator({scene:"groupSend",title:"åŠŸèƒ½å‡çº§ï¼šç¾¤å‘è¿½è¸ª",content:"é‚®ä»¶è¿½è¸ªå·²æ”¯æŒç¾¤å‘é‚®ä»¶è¿½è¸ªï¼Œå‘ä¿¡åå¯æŸ¥çœ‹å„æ”¶ä»¶äººçš„é‚®ä»¶é˜…è¯»çŠ¶æ€ã€‚",key:"compose_mailtrace_groupsendsmallguide",cancelText:"äº†è§£æ›´å¤š",okText:"æˆ‘çŸ¥é“äº†",close:function(){t()},ok:function(){t()},cancel:function(){e.v2GroupSendIntro(),t()}})},groupSendExpiredIntroPopup:function(){var e=this;function t(){e.configUpdate({groupTraceGuideShow:1})}e.popupCreator({scene:"groupSend",title:"åŠŸèƒ½å‡çº§ï¼šç¾¤å‘è¿½è¸ª",content:"é‚®ä»¶è¿½è¸ªcompose_mailtrace_groupsendexpiredsmallguide",cancelText:"äº†è§£æ›´å¤š",okText:"æˆ‘çŸ¥é“äº†",close:function(){t()},ok:function(){t()},cancel:function(){e.v2GroupSendExpiredIntro(),t()}})},confirmSmallGuideTipsCanShow:function(e,t){var i=this,a=i.module.data;(t=t||{}).globalCcheck=void 0===t.globalCcheck||t.globalCcheck,setTimeout((function(){var n="success"==a.get({status:"curPage"}),o=a.get({status:"sendParam"});n||o||t&&t.globalCcheck&&!i.configCanGlobalGuideShow()||e()}),300)},smallGuideTipsShow:function(e,t){var i=this,a=i.module.data;setTimeout((function(){var n="success"==a.get({status:"curPage"}),o=a.get({status:"sendParam"});n||o||(i.configCanGlobalGuide(e):i.statusIsExpire()?i.buySmallGuideTipsShow(e):t&&t():t&&t())}),300)},trialSmallGuideTipsShow:function(e){var t=this;t.popupCreator({scene:e,key:"compose_mailtrace_trialsmallguide",okText:"ç«‹å³ä½“éªŒ",ok:function(){t.trialNow()},cancelText:d.t("äº†è§£æ›´å¤š"),cancel:function(){window.open($.Uri.getUrl("mailtrace_faq",!0),"_blank")}})},buySmallGuideTipsShow:function(e){var t=this;t.popupCreator({scene:e,key:"compose_mailtrace_buysmallguide",okText:"ç«‹å³å¼€é€š",ok:function(){t.buy("mailtrack_scenario_send")}})},popupCreator:function(e){var t=this;if(t.module.find(".Sky-gCmp-main-footer-mailtrace-text"),t.uiState.introPopupShow,!t.smailGuideTips){var i={scene:e.scene},a={show:e.key+"_show",ok:e.key+"_ok_click",close:e.key+"_close_click",more:e.key+"_more_click"},n=a.close+"/"+$S("uid");$.LocalStorage.get(n)||($.Popup.show({uniqueId:"popup_global_promote",pauseTime:15e3,title:d.t(e.title||"é‚®ä»¶è¿½è¸ª"),extcls:"Sky-gCmp-mailtrace-trigger-guide-popup",content:d.t(e.content||"ä½¿ç”¨é‚®ä»¶è¿½è¸ªï¼Œå®æ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»ã€‚"),okText:d.t(e.okText),ok:function(){t.log(a.ok,i),e.ok&&e.ok()},cancelText:d.t(e.cancelText)||d.t("äº†è§£æ›´å¤š"),cancel:e.cancel?function(){t.log(a.more),e.cancel&&e.cancel()}:null,close:function(){t.log(a.close),e.close&&e.close(),$.LocalStorage.set(n,1,{path:"/",expires:t.sceneTriggerConfig.closeDays})},onRender:function(){t.smailGuideTips=this,setTimeout((function(){$.Event.listen(document.body,"click",o)}),500)},listeners:[{name:"destroy",handler:function(){t.smailGuideTips=null,$.Event.unlisten(document.body,"click",o)}}]}),t.log(a.show,i),t.configGlobalGuideShow())}function o(e){setTimeout((function(){if(t.smailGuideTips){if($.Element.inside($.Event.getTarget(e),t.smailGuideTips.getDom()))return;t.smailGuideTips.close()}}),10)}},settingsPopupShow:function(e,t){var i=this,a=i.module;if(i.uiState.expireTips&&i.uiState.expireTips.hide(),i.uiState.introPopup&&i.uiState.introPopup.hide(),i.uiState.setttingsShow)i.uiState.setttingsShowLayer.hide();else{var n=i.statusCanTrial(),o=i.statusIsAvailable(),r=i.mailIsEnabled(),s=i.attachIsEnableInView(),c=i.statusGetPackageInfo(),l=i.statusGetSubTitle(),u=new $.Checkbox({subclass:"switch",extcls:"Sky-gCmp-main-mailtrace-settings-switch",checked:r,checkedchange:function(e){var t=this,a=i.mailCanEnable();if(a.result){if(n)return t.setChecked(!1,!0),i.trialNow(),void i.log("compose_mailtrace_settings_checkboxtrial_click");if(!o)return t.setChecked(!1,!0),i.log("compose_mailtrace_settings_checkboxbuy_click"),i.buy("mailtrack_delivery_setting_enable"),void k.hide();i.log("etValue:e}),t.setChecked(!e,!0),e?a.result&&i.mailEnable((function(){S(e),t.setChecked(e,!0)}),t):i.mailDisable((function(){S(e),t.setChecked(e,!0)}),t)}else{switch((t=this).setChecked(!1,!0),a.reason){case"ComposeEditorTextMode":$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceOpenConflict",statsValue:{reason:a.reason},title:'<p style="color:#394051;">'+d.t("åŠŸèƒ½å¼€é€šæé†’")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("æ‚¨å·²è®¾ç½®çº¯æ–‡æœ¬æ ¼å¼é‚®ä»¶ï¼Œè®¾ç½®åæ— æ³•è·å–è¯¥é‚®ä»¶çš„å·²è¯»çŠ¶æ€ã€‚å¦‚éœ€å¼€é€šé‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œè¯·å…ˆå¥é“äº†")});break;case"ComposeSchedule":$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceOpenConflict",statsValue:{reason:a.reason},title:'<p style="color:#394051;">'+d.t("åŠŸèƒ½å¼€é€šæé†’")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("æ‚¨å·²è®¾ç½®å®šæ—¶å‘é€ï¼Œè®¾ç½®åæ— æ³•è·å–è¯¥é‚®ä»¶çš„å·²è¯»çŠ¶æ€ã€‚å¦‚éœ€å¼€é€šé‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œè¯·å…ˆå–æ¶ˆå‹¾é€‰å®šæ—¶å‘é€ã€‚")+"<p/>",okText:d.t("æˆ‘çŸ¥é“äº†")})}i.log("compose_mailtrace_settings_enable_conflict",{targetValue:e,reason:a.reason})}}}),m=i.cmpGetAttachTraceSwitch(s),p=i.cmpGetMoreSettingsLink((function(){k&&k.hide(),i.log("compose_mailtrace_settings_gotoset_click")})),f="";if(c){var h=$.Link.html({extcls:"Sky-gCmp-main-mailtrace-settings-link",text:d.t("ç«‹å³ç»­è´¹"),click:function(){i.buy("mailtrack_delivery_setting_expired"),k.hide()}});f='<div class="Sky-gCmp-main-mailtrace-settings-packageinfo">'+c+i.renderSettingsRight(h)+"</div>"}var g=$.Icon.html({type:"help",click:function(){i.log("compose_mailtrace_help_click"),window.open("https://help.mail.163.com/faqDetail.do?code=d7a5dc8471cd0c0e8b4b8f4f8e49998b374173cfe9171305fa1ce630d7f67ac20df66a754cf25c46","_blank")}}),v="",b="",y="display:none;";r&&(y=""),v=['<div class="Sky-gCmp-main-mailtrace-settings-line" style="'+y+'"></div>','<div class="Sky-gCmp-main-mailtrace-settings-item Sky-gCmp-main-mailtrace-settings-ext" style="'+y+'">','<div class="Sky-gCmp-main-mailtrace-settings-title">'+d.t("é™„ä»¶è¿½è¸ª")+i.renderSettingsRight(m.html())+"</div>",'<div class="Sky-gCmp-main-mailtrace-settings-text">'+d.t("å¦‚åŒ…å«é™„ä»¶ï¼Œå¯æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦ä¸‹è½½é™„ä»¶")+"</div>","</div>"].join(""),b=['<div class="Sky-gCmp-main-mailtrace-settings-item Sky-gCmp-main-mailtrace-settings-ext" style="'+y+'">','<div class="Sky-gCmp-main-mailtrace-settings-title">'+d.t("æé†’æ–¹å¼")+i.renderSettingsRight(p.html())+"</div>",'<div class="Sky-gCmp-main-mailtrace-settings-text">'+d.t("å¯è®¾ç½®å·²è¯»ã€è¶…æ—¶æœªè¯»æ—¶çš„æé†’æ–¹å¼")+"</div>","</div>"].join("");var x=["<div>",'<div class="Sky-gCmp-main-mailtrace-settings-item">','<div class="Sky-gCmp-main-mailtrace-settings-title">'+d.t("å¼€å¯é‚®ä»¶è¿½è¸ª")+g+i.renderSettingsRight(u.html())+"</div>",'<div class="Sky-gCmp-main-mailtrace-settings-text">'+l+"</div>",f,"</div>",v,b,"</div>"].join(""),k=new $.Layer({extcls:"Sky-gCmp-main-mailtrace-settings",width:$G.environment.isCh?"248px":"348px",autoFocus:!1,items:[{html:x}],params:"arrDown",renderTo:t,onRender:function(){i.uiState.setttingsShow=!0,i.uiState.setttingsShowLayer=this,i.settingsArrowUpdate({status:"up"}),$.Component.setEvents()},listeners:[{name:"destroy",handler:function(){i.uiState.setttingsShow=!1,i.uiState.setttingsShowLayer=null}},{name:"hide",handler:function(){i.uiState.setttingsShow=!1,i.settingsArrowUpdate({status:"down"}),setTimeout((function(){k.destroy(),k=null}),0)}}]});k.pointTo(e.getEl(),t),i.log("compose_mailtrace_buttomsetttings_click")}function S(i){var n=a.find(".Sky-gCmp-main-mailtrace-settings-ext");n&&(i?n.show():n.hide(),k.pointTo(e.getEl(),$.fly(t)))}},settingsArrowUpdate:function(e){var t=this.module.data.get({component:"mailTraceLink"}).getEl();if(t)switch(e.status){case"up":t.addClass("active");break;case"down":t.removeClass("active")}},iconHighlightToggle:function(e){var t="disabled",i="enabled",a=this.module.data.get({component:"mailTraceLink"}).getEl().find(".Sky-gCmp-main-footer-mailtrace-icon");a&&(e.enabled?a.replaceClass(t,i):a.replaceClass(i,t))},isConflictWithOtherOptions:function(){var e=this.module,t=e.data.get({status:"showSchedule"}),i=e.editor.isTextMode();return{result:i||t,reason:i?"ComposeEditorTextMode":t?"ComposeSchedule":""}},showGroupSendConfigWithNotary:function(e){var t=this,i=t.module,a=i.data,n=(i.editor,i.notary),o=a.get({component:"notary"});$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceGroupSendConflict",statsValue:{reason:"ComposeNotary"},title:'<p style="color:#394051;">'+d.t("é‚®ä»¶è¿½è¸ªæé†’")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("å¼€å¯å…¬æ­£é‚®å°†æ— æ³•æ”¯æŒç¾¤å‘é‚®ä»¶è¿½è¸ªï¼Œå»ºè®®è¯¥é‚®ä»¶å…³é—­å…¬æ­£é‚®ä»¥ä¿è¯è¿½è¸ªè´¨é‡ã€‚")+"<p/>",cancelText:d.t("å–æ¶ˆè¿½è¸ª"),cancel:function(){t.mailDisable((function(){e&&e()}))},okText:$G.environment.isCh?"ç¡®å®šå…³é—­":"Disable Fair Mail",ok:function(){o?o.setChecked(!1):n.toggle({close:!0}),e&&e()}})},showGroupSendConfigWithEncrypt:function(e){var t=this,i=t.module,a=i.data,n=(i.editor,i.notary,a.get({component:"encrypt"}));$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceGroupSenè¿½è¸ªæé†’")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("å¼€å¯é‚®ä»¶åŠ å¯†å°†æ— æ³•æ”¯æŒç¾¤å‘é‚®ä»¶è¿½è¸ªï¼Œæ‚¨å¯ä»¥é€‰æ‹©å…³é—­é‚®ä»¶åŠ å¯†ä»¥ä¿è¯è¿½è¸ªè´¨é‡ã€‚")+"<pe&&e()}))},okText:$G.environment.isCh?"ç¡®å®šå…³é—­":"Disable email encryption",ok:function(){n&&n.setChecked(!1),e&&e()}})},showGroupSendConfigWithSender:function(e){var t=this;t.module.data,$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceGroupSendConflict",statsValue:{reason:"Cº")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("å¼€å¯ä»£å‘å°†æ— æ³•æ”¯æŒç¾¤å‘é‚®ä»¶è¿½è¸ªã€‚ä¸ºä¸å½±å“æ‚¨çš„é‚®ä»¶å‘é€ï¼Œå»ºè®®æ‚¨æœ¬æ¬¡å‘ä¿¡å…³é—­é‚®ä»¶è¿½è¸ªåŠŸèƒ½ã€‚")+"<p/>",buttons:[{text:d.t("ç¡®è®¤å…³é—­"),subclass:"mainBtn",click:function(){t.log("Compose_Guide_Popup_MailTraceGroupSendConflict_OK_Click"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),t.mailDisable((function(){e&&e()}))}}]})},getLogParam:function(){return{isMember:this.isPlusMember,type:a.type,beforeType:a.typeBefore}},log:function(e,t){if(e){var i={};i[e]=$.Object.extend(this.getLogParam(),t||{}),$.Log.cache(i)}},isGroupTrace:function(e){return this.mailIsEnabled()&&e.length>=2},getWmsvrUrl:function(){return location.protocol+"//"+location.host+"/mailtrace/js6/s?sid="+$G.user.sid},sendSuccess:function(e){e&&e.mailTrace&&e.mailTrace.spMode&&(this.configGet().usedGroup||this.configUpdate({usedGroup:!0}))},remindStorageFileNotrace:function(e){$.Msgbox.show({statsKey:"Compose_Guide_Popup_ExtTextOpenConflict",title:'<p style="color:#394051;">'+d.t("é™„ä»¶è¿½è¸ªæé†’")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("ç½‘ç›˜æ–‡ä»¶æš‚ä¸æ”¯æŒé™„ä»¶è¿½è¸ªï¼Œå¦‚æœéœ€è¦è¿›è¡Œè¿½è¸ªï¼Œå»ºè®®æ‚¨å°†æ–‡ä»¶ä½œä¸ºè¶…å¤§é™„ä»¶è¿›è¡Œä¸Šä¼ ã€‚")+"<p/>",okText:d.t("æˆ‘çŸ¥é“äº†"),ok:function(){e&&e()}})},featureCheck:function(e){switch(e){case"attachTrace":case"groupSend":return!0;default:return!1}}};function h(){return this.configGet().remindAfter72hours}u.inherit(m,o.Z),u.extend(m.prototype,f),t.Z=m},66076:function(e,t,i){i(15761),i(20869),i(42295),i(63518),i(75654),i(803),i(55737),i(66251),i(49750),i(37092),i(92274),i(79150);var a,n,o=i(10487),r=i(72957),s=i(96540),c=i(62385),l=i(27018),d=new r.c1("module.compose.ComposeMailTrace"),u=$.Object,m=$.createClass((0,r.$N)("module.compose.ComposeMailTraceV1")),p={subjectKeywordsRegex:new RegExp("("+["æŠ•ç¨¿","contribution","è‡ªè","application","ç”³è¯·","apply","ç®€å†","job","é¢è¯•","é€šçŸ¥","notification","é‡è¦ï¼ˆå›å¤é‚®ä»¶ï¼‰","re:","ç´§æ€¥","urgent","ç ”ç©¶ç”Ÿ","å…¥å­¦","å½•å–","ç¡•å£«","å¯¼å¸ˆ","ç§‘ç›®","æŠ¥å","æŠ¥è€ƒ","å­¦å†","ä¸“ä¸šè¯¾","è€ƒç ”è¾…å¯¼","è€ƒç ”å’¨è¯¢","å­¦ç”Ÿ","åº”è˜","ææ–™","è°ƒå‰‚","å¤§å­¦","è€å¸ˆ","å’¨è¯¢","ä¸“ç¡•","å®ä¹ ç”Ÿ","ç®€å†","åšå£«","å²—ä½","offer","è–ªèµ„","æµæ°´","æ ¡æ‹›","ç¤¾æ‹›","Postgraduate student","Enrollment","Admission","Master's degree","Supervisor","Subject","Reminder","Registration","Application","Academic qualifications","Major course","Postgraduate entrance exam coaching","Postgraduate entrance exam consultation","Student","Job application","Materials","Adjustment","University","Teacher","Consultation","Professional master","Intern","Resume","Doctorate","Internship","Position","Offer","Salary","Payroll","Campus Recruitment","Social Recruitment"].join("|")+")","i"),sceneTriggerConfig:{closeDays:30},text:{monthlyExpireTips:d.t("é‚®ä»¶è¿½è¸ªåŠŸèƒ½å·²åˆ°æœŸï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹ã€‚"),balanceExpireTips:d.t("é‚®ä»¶è¿½è¸ªåŠŸèƒ½å¯ç”¨å°æ•°ä¸è¶³ï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹ã€‚"),statusSubTitleRaw:d.t("å‘ä¿¡åå¯˜¯å¦å·²è¯»"),statusSubTitleAvailable:d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»"),statusSubTitleMonthlyExpire:d.t("å·²åˆ°æœŸï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹"),statusSubTitleBalanceExpire:d.t("å¯ç”¨å°æ•°ä¸è¶³ï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹"),statusSubTitleTrialExpire:d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»")},tmpConfig:void 0,initialize:function(e){m.superClass.initialize.call(this,e)},init:function(){var e=this;$.Ext.mailTracking&&(e.ready={loaded:!1,callbackList:[]},e.uiState={setttingsShow:!1,expireTips:null,setttingsShowLayer:null,smailGuideTips:null,introPopupShow:!1},e.tmpConfig=void 0,e.isPlusMember=!1,m.superClass.init.call(e),e.initInfo(),e.initKeywords(),e.onReady((function(){e.tipsRender(),e.configIsEnabled()&&e.iconHighlightToggle({enabled:!0}),setTimeout((function(){e.expireTipsShow(),e.guidePopupShowAfterEntry()}),1e3),e.listenerComposeOptionChange()})))},run:function(){var e=this;e.ready.loaded&&($.Array.each(e.ready.callbackList,(function(e,t){try{t()}catch(e){}})),e.ready.callbackList=[])},onReady:function(e){this.ready.callbackList.push(e),this.run()},listenerComposeOptionChange:function(){var e=this;e.onComposeOptionChangeCallback=function(t){var i=e.module.data;if("text"===t.option||"schedule"===t.option){var a=i.get({component:"text"}),n=i.get({component:"schedule"}),o=a.getChecked(),r=n.getChecked();o||r?e.tipsHide():e.tipsShow()}},$.Listener.listen("compose:optionChange",e.onComposeOptionChangeCallback)},onComposeOptionChangeCallback:function(e){},reset:function(){var e=this;e.ready.loaded=!1,e.ready.callbackList=[],e.uiState.setttingsShow=!1,e.uiState.setttingsShowLayer=null,e.tmpConfig=void 0},destroy:function(){$.Listener.unlisten("compose:optionChange",this.onComposeOptionChangeCallback)},initInfo:function(){var e=this;$.Ud.getProxy({force:!0,field:["product.plus.mailTrackingStatus","webmail.js.mailTrackingConfig","webmail.js.mailTrackingExpireTipsShow"],call:function(t){var i=t["product.plus.mailTrackingStatus"],o=t["webmail.js.mailTrackingConfig"],r=t["webmail.js.mailTrackingExpireTipsShow"];try{2!==(a=JSON.parse(i)).type&&3!==a.type||e.statusBalanceSync()}catch(e){$.Log.cache({compose_ud_error:{type:"parse",response:i}})}try{n=JSON.parse(o),e.tmpConfig=JSON.parse(o),n.expireTipsShow=r}catch(e){$.Log.cache({compose_ud_error:{type:"parse",response:o}})}e.ready.loaded=!0,e.run(),e.showTipsOrNot()}}),$.Ud.getProxy({field:["product.vipMember"],call:function(t){e.isPlusMember=t["product.vipMember"]}})},initKeywords:function(){function e(e){try{var t=JSON.parse(e.responseText||e.response);m.prototype.subjectKeywordsRegex=new RegExp("("+t.words.join("|")+")","i")}catch(e){}}var t=$.Uri.getUrl("compose_trace_keyword",!0);try{$.Ajax._xmlHttpPoll.unshift(new XMLHttpRequest),$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:t,call:function(t){e(t)}})}catch(a){try{var i=new XDomainRequest;i.open("GET",t),i.onload=function(){e(i)},i.send()}catch(e){}}},showTipsOrNot:function(){var e=this;e.module.base.onContentLoaded((function(){e.onReady((function(){var t=e.tipsCanShow();e.trailTipsToggle(t)}))}))},fetchStatus:function(){$.Ud.getProxy({force:!0,field:["product.plus.mailTrackingStatus"],call:function(e){var t=e["product.plus.mailTrackingStatus"];try{$.Object.extend(a,JSON.parse(t))}catch(e){$.Log.cache({compose_ud_error:{type:"parse",response:t}})}}})},configUpdate:function(e,t,i){var a=this,o={};$.Object.d$.Object.pick(o,["enable","remindAtFirstTime","remindAfter72hours","composeTrialTipCloseTime","mboxTrialTipCloseTime","pushTipCloseTime","mboxNpsClose","mboxRenewTipCloseTime","globalTriggerPopupShowTime"]);var r=JSON.stringify(o);i&&a.configLoadingShow(i),$.Ud.setProxy({field:"webmail.js.mailTrackingConfig",value:r,call:function(e){n=o,a.tmpConfig=$.Object.clone(o),i&&a.configLoadingHide(i),t&&t()}})},fetchConfig:function(){var e="webmail.js.mailTrackingConfig"field:[e],call:function(e){var t=e["webmail.js.mailTrackingConfig"];try{$.Object.extend(n,JSON.parse(t))}catch(e){$.Log.cache({compose_ud_error:{type:"parse",response:t}})}}})},statusGetRaw:function(){return a},statusGetPackageInfo:function(){switch(a.type){case 0:switch(a.typeBefore){case 1:return d.t("æœ‰æ•ˆæœŸè‡³ï¼š")+$.Date.format(new Date(a.expireTime),"yyyy-MM-dd");case 2:return d.t("å‰©ä½™å°æ•°ï¼š")+0+d.t("å°");default:return""}case 1:return d.t("æœ‰æ•ˆæœŸè‡³ï¼š")+$.Date.format(new Date(a.expireTime),"yyyy-MM-dd");case 2:case 3:return d.t("å‰©ä½™å°æ•°ï¼š")+a.remainCount+d.t("å°");default:return""}},statusGetSubTitle:function(){var e=this,t=e.statusGetRaw();return 0!==t.type||t.typeBefore?t.type>0?d.t(e.text.statusSubTitleAvailable)||d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»"):1===t.typeBefore?d.t(e.text.statusSubTitleMonthlyExpire)||d.t("å·²åˆ°æœŸï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹"):2===t.typeBefore?d.t(e.text.statusSubTitleBalanceExpire)||d.t("å¯ç”¨å°æ•°ä¸è¶³ï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹"):3===t.typeBefore?d.t(e.text.statusSubTitleTrialExpire)||d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»"):void 0:d.t(e.text.statusSubTitleRaw)||d.t("å‘ä¿¡åå¯éšæ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»")},statusIsAvailable:function(){return a?a.type:0},statusIsExpire:function(){return 0===a.type&&a.typeBefore>0},statusCanTrial:function(){return a&&0===a.type&&!1===a.beenTrialed&&!a.typeBefore},statusBalanceSync:function(){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:{},rnd:!0,url:$.Uri.getUrl("mailTrackingStatus",!0),head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var t=JSON.parse(e.responseText),i=t.result||{};a.remainCount=i.remainCnt||0,t.code}catch(e){}}})},disable:function(e,t){var i=this;i.configDisable((function(){i.iconHighlightToggle({enabled:!1}),e&&e()}),t)},enable:function(e,t){var i=this;i.configEnable((function(){i.iconHighlightToggle({enabled:!0}),e&&e()}),t)},localDisable:function(){var e=this;e.tmpConfig&&(e.tmpConfig&&(e.tmpConfig.enable=!1),e.iconHighlightToggle({enabled:!1}))},localEnable:function(){var e=this;e.tmpConfig&&(e.tmpConfig&&(e.tmpConfig.enable=!0),e.iconHighlightToggle({enabled:!0}))},enableAndShowGuide:function(){var e=this;e.enable((function(){e.fetchStatus(),e.trailTipsToggle(!1)})),e.guidePopupShow()},configEnable:function(e,t){this.configUpdate({enable:!0},e,t)},configDisable:function(e,t){this.configUpdate({eTime:function(e,t){this.configUpdate({remindAtFirstTime:!0},e,t)},configDisableRemindAtFirstTime:function(e,t){this.configUpdate({remindAtFirstTime:!1},e,t)},configEnableRemindAfter72hours:!0},e,t)},configDisableRemindAfter72hours:function(e,t){this.configUpdate({remindAfter72hours:!1},e,t)},configCloseTips:function(){this.configUpdate({composeTrialTipCloseTime:$.Misc.getTime().getTime()})},configExpireTipsShow:function(){$.Ud.setProxy({field:"webmail.js.mailTrackingExpireTipsShow",value:!1,call:function(e){n.expireTipsShow=!1}})},configExpireTipsRest:function(){$.Ud.setProxy({field:"webmail.js.mailTrackingExpireTipsShow",value:!0,call:function(e){n.expireTipsShow=!0}})},configLoadingShow:function(e){e.getEl().addClass("loading")},configLoadingHide:function(e){e.getEl().removeClass("loading")},configIntroPopupShow:function(e){var t=this,i=t.configGet(),a=$.Object.pick(i,["enable","remindAtFirstTime","remindAfter72hours","composeTrialTipCloseTime","mboxTrialTipCloseTime","pushTipCloseTime","mboxNpsClose","mboxRenewTipCloseTime","composeIntroPopupShow"]);a.composeIntroPopupShow=!0;var n=JSON.stringify(a);$.Ud.setProxy({field:"webmail.js.mailTrackingConfig",value:n,call:function(e){t.fetchConfig()}})},configGlobalGuideShow:function(){this.configUpdate({globalTriggerPopupShowTime:$.Misc.getTime().getTime()})},configGetRaw:function(){return n},configSetRaw:function(e){n=e},configGet:function(){if(n){var e=$.Object.clone(n);return $.Object.extend(e,this.tmpConfig||{}),e}},configIsEnabled:function(){var e=this.configGet();return!!((a||{type:0}).type>0&&e)&&e.enable},configIsRemindAtFirstTime:function(){return this.configGet().remindAtFirstTime},configIsRemindAfter72hours:function(){return this.configGet().remindAfter72hours},configCanEnable:function(){var e=this.isConflictWithOtherOptions();return{result:!e.result,reason:e.reason}},configCanGlobalGuideShow:function(){return $.Misc.getTime().getTime()-(n.globalTriggerPopupShowTime||0)>=6048e5},tipsRender:function(){var e=this.module.getDom("mkttips"),t=this.tipsGet();e&&(e.innerHTML=t,$.Component.setEvents())},tipsGet:function(){var e=this;switch(e.tipsGetType()){case-2:return e.trailTipsCreate();case-1:return e.openTipsCreate();default:return""}},tipsGetType:function(){return!1!==a.beenTrialed||0!==a.type||a.typeBefore?!a.beenTrialed||0!==a.type||a.typeBefore&&3!==a.typeBefore?a.type:-1:-2},tipsCanShow:function(){var e=$.Misc.getTime().getTime()-(n.composeTrialTipCloseTime||0)>=6048e5;return!this.isConflictWithOtherOptions().result&&e},tipsHide:function(){var e=this.module.getDom("mkttips");e&&(e.firstElementChild.style.display="none")},tipsShow:function(){var e=this.module.getDom("mkttips");e&&(0===!e.childNodes?this.tipsRender():e.firstElementChild.style.display="inline-block")},trailTipsCreate:function(){var e=this,t=(e.module,$.Link.html({text:d.t("ç«‹å³ä½“éªŒ"),extcls:"Sky-gCmp-mailtrace-link",click:function(){e.log("compose_mailtrace_trialtips_click"),e.trialNow()},onRender:function(){e.log("compose_mailtrace_trialtips_show")}})),i=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-close"></span>',listeners:[{name:"click",type:"dom",handler:function(){e.trailTipsClose()}}]});return['<div class="Sky-gCmp-mailtrace-trail-tips Sky-gCmp-mailtrace-tips">','<span class="Sky-gCmp-munction(e){var t=this.module.find(".Sky-gCmp-mailtrace-trail-tips");t&&(e?t.css({display:"inline-block"}):t.hide())},trailTipsClose:function(){var e=this,t=e.module;e.configCloseTips();var i=t.find(".Sky-gCmp-mailtrace-trail-tips");i&&(i.hide(),e.log("compose_mailtrace_trialtips_close_click"))},openTipsCreate:function(){var e=this,t=(e.module,!1);try{var i=$.Misc.getTime();i>=16822656e5&&i<=16835616e5&&(t=!0)}catch(e){}var a=$.Link.html({text:d.t(t?"å¼€å¯æé†’":"ç«‹å³å¼€é€š"),extcls:"Sky-gCmp-mailtrace-link",click:function(){e.buy("mailtrack_delivery_tips_enable"),e.log("compose_mailtrace_opentips_click")},onRender:function(){e.log("compose_mailtrace_opentips_show")}}),n=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-close"></span>',listeners:[{name:"click",type:"dom",handler:function(){e.trailTipsClose(),e.log("compose_mailtrace_opentips_close_click")}}]});return['<div class="Sky-gCmp-mailtrace-trail-tips Sky-gCmp-mailtrclass="Sky-gCmp-mailtrace-tipstxt">'+d.t(t?"ã€é‚®ä»¶è¿½è¸ªã€‘å‘å‡ºé‡è¦é‚®ä»¶ï¼Œå¯¹æ–¹æ˜¯å¦æŸ¥çœ‹ï¼Ÿ":"æ–°åï¼Œç¡®è®¤å‘å‡ºé‚®ä»¶æ˜¯å¦è¢«å¯¹æ–¹é˜…è¯»")+"</span>",a,n,"<div>"].join("")},expireTipsShow:function(){this.configGet().expireTipsShow&&this.expirePopupTipsShow()},expirePopupTipsShow:function(){var e,t=this,i=(e-mailtrace-text")){var n=1===a.typeBefore?t.text.monthlyExpireTips:t.text.balanceExpireTips,o=1===a.typeBefore?"compose_mailtrace_monthly_expire_show":"compose_mailtrace_single_expire_show",r=1===a.typeBefore?"compose_mailtrace_monthly_expire_ok_click":"compose_mailtrace_single_expire_ok_click",s=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok">'+d.t("ç¡®å®š")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){l.destroy(),l=null,t.log(r),t.buy(r)}}]}),c=e.getDom("main"),l=new $.Layer({extcls:"Sky-gCmp-mailtrace-guide-popup Sky-gCmp-mailtrace-expire-guide-popup",items:[{html:d.t(n)},{html:s}],params:"hasArr arrDown",renderTo:c,onRender:function(){t.log(o),t.configExpireTipsShow(),t.uiState.expireTips=this,$.Component.setEvents()},listeners:[{name:"destroy",handler:funchide",handler:function(){setTimeout((function(){l.destroy(),l=null}),0)}}]});l.pointTo(i.getEl(),$.fly(c))}return{oMailTrace:t,oModule:e}},trialNow:function(){var e=this;e.module,$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceTrial",statsValue:e.getLogParam(),title:'<p style="color:#000000;">'+d.t("æ–°åŠŸèƒ½ä½“éªŒï¼šé‚®ä»¶è¿½è¸ª")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("é‚®ä»¶å‘é€åæ”¯æŒæŸ¥çœ‹å·²è¯»çŠ¶æ€ï¼ˆæ”¶ä»¶äººæ— æ„ŸçŸ¥ï¼‰ ï¼Œå¯¹æ–¹é˜…è¯»äº†æ‚¨çš„é‚®ä»¶åï¼Œå¯å‰å¾€â€œå·²å‘é€â€é¡µç¡®è®¤å¯¹æ–¹æ˜¯å¦å·²çŸ¥æ‚‰æ‚¨æ‰€å‘é€çš„é‚®ä»¶ã€‚")+'<p/><div style="width:345px;height:270px;margin-top:16px;border:1px solid #E3E5EC;border-radius:4px;overflow:hidden;"><img style="width:345px;" src="https://mail-activity.nos-jd.163yun.com/4ea67e5532182dfe2e51837b3d50a4c8.gif"/></div>',buttons:[{text:d.t("æš‚ä¸éœ€è¦"),click:function(){e.log("Compose_Guide_Popup_MailTraceTrial_NoNeed"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close()}},{text:d.t("ç«‹å³ä½“éªŒ"),subclass:"mainBtn",click:function(){e.log("Compose_Guide_Popup_MailTraceTrial_OK"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),e.guideEnable()}}]})},guideEnable:function(e){var t=this;s.default.trial((function(i){i&&(a.remainCount=i,t.enableAndShowGuide(),e&&e())}))},guidePopupShow:function(){var e,t,i,a=this,n=a.module,o=n.getEl("main"),r=n.find(".Sky-gCmp-main-footer-mailtrace-text");function s(e,t,i,a){var n={right:"unset",left:t.left-20+"px",top:t.top-84-6+(i||0)+"px",bottom:"unset"};a&&(n.width=a),e.el.css(n)}function c(t,i){var a=n.container.querySelectorAll(".eq2"),o=a[0],r=a[1],s=o.getBoundingClientRect(),c=r.getBoundingClientRect();e.el.css({position:"absolute",zIndex:99,width:parseInt(c.left-s.left-2)+"px",height:i.height+"px",left:Math.ceil(s.left+1)+"px",top:i.top+"px"})}var l=$.Misc.debounce((function(){var e=r.dom.getBoundingClientRect();s(i,e),c(0,e)}),500,!1);if(r){var u=$.Misc.debounce((function(){var n=r.dom.getBoundingClientRect();$.Component.html({html:'<span class="Sky-gCmp-mailtrace-trail-guide-popup-bg"></span>',renderTo:document.body,onRender:function(){e=this,c(0,n)}}),$.Component.html({html:'<span class="Sky-gCmp-mailtrace-trail-guide-popup-bg-layer"></span>',renderTo:document.body,onRender:function(){t=this}});var m=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok Sky-gCmp-mailtrace-trail-guide-popup-ok">'+d.t("ç¡®å®š")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){i.close(),e.destroy(),t.destroy(),t=null,i=null,e=null}}]}),p=a.isPlusMember,f=p?d.t("å·²ä¸ºä½ å¼€å¯é‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œä¼šå‘˜ç”¨æˆ·å°Šäº«æ¯æœˆ5å°é‚®ä»¶è¿½è¸ªé¢åº¦ã€‚"):d.t("å·²ä¸ºä½ å¼€å¯é‚®ä»¶è¿½è¸ªåŠŸèƒ½ã€‚"),h=p?"Sky-gCmp-mailtrace-trail-plus-guide-popup":"",g=p?-20:0,v=p&&!$G.environment.isCh?"240px":"";i=$.Popup.show({pauseTime:15e3,extcls:"Sky-gCmp-mailtrace-guide-popup Sky-gCmp-mailtrace-trail-guide-popup "+h,content:f+'<span class="Sky-gCmp-mailtrace-guide-popup-angle"></span>'+m,listeners:[{name:"destroy",handler:function(){o.css({overflow:""}),window.removeEventListener("resize",l)}}],onRender:function(){s(this,n,g,v),o.css({overflow:"hidden"}),$.Component.setEvents(),window.addEventListener("resize",l)}}),$.Event.unlisten(o,"scroll",u)}),150,!1),m=o.dom.scrollHeight!==o.dom.clientHeight,p=o.dom.scrollTop+o.dom.clientHeight<o.dom.scrollHeight;m&&p?(r.dom.scrollIntoView({behavior:"smooth",block:"start"}),$.Event.listen(o,"scroll",u)):u()}},guidePopupShowAfterEntry:function(){var e=this;if(e.module.data.get({status:"entryExtends"}).trailMailTrace)e.enableAndShowGuide();else{e.configGet();var t=e.isConflictWithOtherOptions(),i=!t||!t.result;if(e.statusCanTrial()&&i){if(!e.configCanGlobalGuideShow())return;e.introPopupShow()}}},buy:function(e){this.module.base.send({action:"save"});var t=((0,r.$S)("isVip")?"vip_":"")+e;c.default.showMailTraceBuy(t,(function(){}))},introPopupShow:function(){var e,t=this,i=(e=t.module).data,a=e.getEl("main"),n=i.get({component:"mailTraceLink"}),o='<div><div style="width:256px;height:200px;border:1px solid #E3E5EC;border-radius:4px;box-sizing:border-box;overflow:hidden;"><img style="width:254px;" src="https://mail-activity.nos-jd.163yun.com/4ea67e5532182dfe2e51837b3d50a4c8.gif"/></div>'+('<div style="color:#21293A;font-size: 14px; line-height: 20px;font-weight: bold;margin-bottom: 8px;margin-top:12px">'+d.t("é‚®ä»¶è¿½è¸ªï¼š")+"</div>")+('<div style="color:#394051;font-size: 12px; line-height: 20px;margin-bottom: 16px;">'+d.t("æ”¯æŒæŸ¥çœ‹å·²è¯»çŠ¶æ€ï¼Œå¯¹æ–¹é˜…è¯»äº†é‚®ä»¶åï¼Œå¯å‰å¾€â€œå·²å‘é€â€é¡µç¡®è®¤å¯¹æ–¹æ˜¯å¦å·²çŸ¥æ‚‰ã€‚")+"</div>")+"<div>",s=(e=t.module).find(".Sky-gCmp-main-footer-mailtrace-text"),c="compose_mailtrace_intro_popup_show/"+(0,r.$S)("uid");if(!$.LocalStorage.get(c)&&s){var l=$.Misc.debounce((function(){var i=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok">'+d.t("ç«‹å³ä½“éªŒ")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){u.destroy(),u=null,t.log("compose_mailtrace_intro_popup_ok_click"),t.guideEnable()}}]}),r=$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-cancel">'+d.t("æš‚ä¸ä½“éªŒ")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){u.destroy(),u=null,t.log("compose_mailtrace_intro_popup_cancel_click"),$.LocalStorage.set(c,1,{path:"/",expires:t.sceneTriggerConfig.closeDays})}}]}),s=e.getDom("main"),u=new $.Layer({extcls:"Sky-gCmp-mailtrace-guide-popup Sky-gCmp-mailtrace-intro-guide-popup",items:[{html:o},{html:'<div style="text-align:right;">'+r+i+"</div>"},{html:$.Browser.isIE()?"":'<span class="Sky-gCmp-mailtrace-intro-popup-angle"></span>'}],fixY:-10,params:"hasArr arrDown",renderTo:s,onRender:function(){t.log("compose_mailtrace_intro_popup_show"),t.uiState.introPopup=this,t.uiState.introPopupShow=!0,$.Component.setEvents(),t.configGlobalGuideShow()},listeners:[{name:"destroy",handler:function(){t.uiState.introPopup=null}},{name:"hide",handler:function(){setTimeout((function(){u.destroy(),u=null}),0)}}]});u.pointTo(n.getEl(),$.fly(s)),$.Event.unlisten(a,"scroll",l)}),150),u=a.dom.scrollHeight!==a.dom.clientHeight,m=a.dom.scrollTop+a.dom.clientHeight<a.dom.scrollHeight,p=u&&m,f=e.find(".Skycrlock:"start"}),$.Event.listen(a,"scroll",l)):l()}},markContactGuideSceneTrigger:function(e){try{if(!$.Array.has(e,(function(e){return l.default.isMark(e.address)})))return;this.smallGuideTipsShow("markContact")}catch(e){return}},subjectKeywordsSceneTrigger:function(e){var t=this.subjectKeywordsRegex.exec($.String.trim(e));t&&($.Log.cache({compose_mailtrace_keyword_match:t[0]}),this.smallGuideTipsShow("subjectKeywords"))},smallGuideTipsShow:function(e){var t=this,i=t.module.data;setTimeout((function(){var a="success"==i.get({status:"curPage"}),n=i.get({status:"sendParam"});a||n||t.configCanGlobalGuideShow()&&(t.statusCanTrial()?t.trialSmallGuideTipsShow(e):t.statusIsExpire()&&t.buySmallGuideTipsShow(e))}),300)},trialSmallGuideTipsShow:function(e){var t=this;t.popupCreator({scene:e,key:"compose_mailtrace_trialsmallguide",okText:"ç«‹å³ä½“éªŒ",ok:function(){t.trialNow()},cancelText:d.t("äº†è§£æ›´å¤š"),cancel:function(){window.open($.Uri.getUrl("mailtrace_faq",!0),"_blank")}})},buySmallGuideTipsShow:function(e){var t=this;t.popupCreator({scene:e,key:"compose_mailtrace_buysmallguide",okText:"ç«‹å³å¼€é€š",ok:function(){t.buy("mailtrack_scenario_send")}})},popupCreator:function(e){var t=this;if(t.module.find(".Sky-gCmp-main-footer-mailtrace-text"),t.uiState.introPopupShow,!t.smailGuideTips){var i={scene:e.scene},a={show:e.key+"_show",ok:e.key+"_ok_click",close:e.key+"_close_click",more:e.key+"_more_click"},n=a.close+"/"+(0,r.$S)("uid");if(!$.LocalStorage.get(n)){$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-ok">'+d.t(e.okText)+"</span>",listeners:[{name:"click",type:"dom",handler:function(){t.log(a.ok,i),e.ok&&e.ok(),t.smailGuideTips.close()}}]}),e.cancel&&$.Component.html({html:'<span class="Sky-gCmp-mailtrace-guide-popup-cancel">'+d.t("äº†è§£æ›´å¤š")+"</span>",listeners:[{name:"click",type:"dom",handler:function(){t.log(a.more),e.cancel&&e.cancel(),window.open($.Uri.getUrl("mailtrace_faq",!0),"_blank"),t.smailGuideTips.close()}}]}),$.Component.html({html:'<span class="Sky-gCmp-mailtrace-close"></span>',listeners:[{name:"click",type:"dom",handler:function(){t.log(a.close),t.smailGuideTips.close(),$.LocalStorage.set(n,1,{path:"/",expires:t.sceneTriggerConfig.closeDays})}}]});var o=$.Popup.show({uniqueId:"popup_global_promote",pauseTime:15e3,title:d.t("é‚®ä»¶è¿½è¸ª"),extcls:"Sky-gCmp-mailtrace-trigger-guide-popup",content:d.t("ä½¿ç”¨é‚®ä»¶è¿½è¸ªï¼Œå®æ—¶æŸ¥çœ‹å¯¹æ–¹æ˜¯å¦å·²è¯»ã€‚"),okText:d.t(e.okText),ok:function(){t.log(a.ok,i),e.ok&&e.ok()},cancelText:e.cancel?d.t("äº†è§£æ›´å¤š"):"",cancel:e.cancel?function(){t.log(a.more),e.cancel&&e.cancel();var i=o.close;o.close=function(){},t.smailGuideTips=null,setTimeout((function(){o.close=i,t.smailGuideTips=o}),50)}:null,close:function(){t.log(a.close),$.LocalStorage.set(n,1,{path:"/",expires:t.sceneTriggerConfig.closeDays})},onRender:function(){t.smailGuideTips=this,setTimeout((function(){$.Event.listen(document.body,"click",s)}),500)},listeners:[{name:"destroy",handler:function(){t.smailGuideTips=null,$.Event.unlisten(document.body,"click",s)}}]});t.log(a.show,i),t.configGlobalGuideShow()}}function s(e){setTimeout((function(){if(t.smailGuideTips){if($.Element.inside($.Event.getTarget(e),t.smailGuideTips.getDom()))return;PopupShow:function(e,t){var i=this,a=i.module;if(i.uiState.expireTips&&i.uiState.expireTips.hide(),i.uiState.introPopup&&i.uiState.introPopup.hide(),i.uiState.{var n=i.statusCanTrial(),o=i.statusIsAvailable(),r=i.configIsEnabled(),s=i.configIsRemindAtFirstTime(),c=i.configIsRemindAfter72hours(),l=i.statusGetPackageInfo(),u=i.statusGetSubTitle(),m=new $.Checkbox({subclass:"switch",extcls:"Sky-gCmp-main-mailtrace-settings-switch",checked:r,checkedchange:function(e){var t=this,a=i.configCanEnable();if(a.result){if(n)return t.setChecked(!1,!0),i.trialNow(),void i.log("compose_mailtrace_settings_checkboxtrial_click");if(!o)return t.setChecked(!1,!0),i.log("compose_mailtrace_settings_checkboxbuy_click"),i.buy("mailtrack_delivery_setting_enable"),void b.hide();i.log("compose_mailtrace_settings_enable_click",{targetValue:e}),t.setChecked(!e,!0),e?a.result&&i.enable((function(){y(e),t.setChecked(e,!0)}),t):i.disable((function(){y(e),t.setChecked(e,!0)}),t)}else{switch((t=this).setChecked(!1,!0),a.reason){case"ComposeEditorTextMode":$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceOpenConflict",statsValue:{reason:a.reason},title:'<p style="color:#394051;">'+d.t("åŠŸèƒ½å¼€é€šæé†’")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("æ‚¨å·²è®¾ç½®çº¯æ–‡æœ¬æ ¼å¼é‚®ä»¶ï¼Œè®¾ç½®åæ— æ³•è·å–è¯¥é‚®ä»¶çš„å·²è¯»çŠ¶æ€ã€‚å¦‚éœ€å¼€é€šé‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œè¯·å…ˆå–æ¶ˆå‹¾é€‰çº¯æ–‡æœ¬è®¾ç½®ã€‚")+"<p/>",okText:d.t("æˆ‘çŸ¥é“äº†")});break;case"ComposeSchedule":$.Msgbox.show({statsKey:"Compose_Guide_Popup_MailTraceOpenConflict",statsValue:{reason:a.reason},title:'<p style="color:#394051;">'+d.t("åŠŸèƒ½å¼€é€šæé†’")+"</p>",content:'<p style="color:#585E6D;" >'+d.t("æ‚¨å·²è®¾ç½®å®šæ—¶å‘é€ï¼Œè®¾ç½®åæ— æ³•è·å–è¯¥é‚®ä»¶çš„å·²è¯»çŠ¶æ€ã€‚å¦‚éœ€å¼€é€šé‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œè¯·å…ˆå–æ¶ˆå‹¾é€‰å®šæ—¶å‘é€ã€‚")+"<p/>",okText:d.t("æˆ‘çŸ¥é“äº†")})}i.log("compose_mailtrace_settings_enable_conflict",{targetValue:e,reason:a.reason})}}}),p=new $.Checkbox({subclass:"switch",checked:s,extcls:"Sky-gCmp-main-mailtrace-settings-switch",checkedchange:function(e){var t=this;t.setChecked(!e,!0),i.log("compose_mailtrace_settings_remindAtfirst_click",{targetValue:e}),e?i.configEnableRemindAtFirstTime((function(){t.setChecked(e,!0)}),t):i.configDisableRemindAtFirstTime((function(){t.setChecked(e,!0)}),t)}}),f=new $.Checkbox({subclass:"switch",checked:c,extcls:"Sky-gCmp-main-mailtrace-settings-switch",checkedchange:function(e){var t=this;t.setChecked(!e,!0),i.log("compose_mailtrace_settings_remindAfter72hours_click",{targetValue:e}),e?i.configEnableRemindAfter72hours((function(){t.setChecked(e,!0)}),t):i.configDisableRemindAfter72hours((function(){t.setChecked(e,!0)}),t)}}),h="";l&&(h='<div class="Sky-gCmp-main-mailtrace-settings-packageinfo">'+l+x($.Link.html({extcls:"Sky-gCmp-main-mailtrace-settings-buylink",text:d.t("ç«‹å³ç»­è´¹"),click:function(){i),b.hide()}}))+"</ml({type:"help",click:function(){i.log("compose_mailtrace_help_click"),window.open("https://help.mail.163.com/faqDetail.do?code=d7a5dc8471cd0c0e8b4b8f4f8e49998b374173cfe9171305fa1ce630d7f67ac20df66a754cf25c46","_blank")}}),v=["<div>",'<div class="Sky-gCmp-main-mailtrace-settings-top">','<div class="Sky-gCmp-main-mailtrace-settings-title">'+d.t("å¼€å¯é‚®ä»¶è¿½è¸ª")+g+x(m.html())+"</div>",'<div class="Sky-gCmp-main-mailtrace-settings-text">'+u+"</div>",h,"</div>",'<div class="Sky-gCmp-main-mailtrace-settings-line"></div>','<div class="Sky-gCmp-main-mailtrace-settings-bottom" style='+(r?"":"display:none")+">",'<div class="Sky-gCmp-main-mailtrace-settings-title">'+d.t("å¯¹æ–¹é¦–æ¬¡æ‰“å¼€æ—¶é‚®ä»¶æé†’æˆ‘")+x(p.html())+"</div>",'<div class="Sky-gCmp-main-mailtrace-settings-title">'+d.t("å¯¹æ–¹72å°æ—¶å†…æœªæ‰“å¼€é‚®ä»¶æé†’æˆ‘")+x(f.html())+"</div>","</div>","</div>"].join(""),b=new $.Layer({extcls:"Sky-gCmp-main-mailtrace-settings",width:$G.environment.isCh?"248px":"348px",autoFocus:!1,items:[{html:v}],params:"hasArr arrDown",renderTo:t,onRender:function(){i.uiState.setttingsShow=!0,i.uiState.setttingsShowLayer=this,i.settingsArrowUpdate({status:"up"}),$.Component.setEvents()},listeners:[{name:"destroy",handler:function(){i.uiState.setttingsShow=!1,i.uiState.setttingsShowLayer=null}},{name:"hide",handler:function(){i.uiState.setttingsShow=!1,i.settingsArrowUpdate({status:"down"}),setTimeout((function(){b.destroy(),b=null}),0)}}]});b.pointTo(e.getEl(),$.fly(t)),i.log("compose_mailtrace_buttomsetttings_click")}function y(i){var n=a.find(".Sky-gCmp-main-mailtrace-settings-bottom");n&&(i?n.show():n.hide(),b.pointTo(e.getEl(),$.fly(t)))}function x(e){return'<div class="Sky-gCmp-main-mailtrace-settings-item-right">'+e+"</div>"}},settingsArrowUpdate:function(e){var t=this.module.data.get({component:"mailTraceLink"}).getEl();if(t)switch(e.status){case"up":t.addClass("active");break;case"down":t.removeClass("active")}},iconHighlightToggle:function(e){var t="disabled",i="enabled",a=this.module.data.get({component:"mailTraceLink"}).getEl().find(".Sky-gCmp-main-footer-mailtrace-icon");a&&(e.enabled?a.replaceClass(t,i):a.replaceClass(i,t))},isConflictWithOtherOptions:function(){var e=this.module,t=e.data.get({status:"showSchedule"}),i=e.editor.isTextMode();return{result:i||t,reason:i?"ComposeEditorTextMode":t?"ComposeSchedule":""}},getLogParam:function(){return{isMember:this.isPlusMember,type:a.type,beforeType:a.typeBefore}},log:function(e,t){if(e){var i={};i[e]=$.Object.extend(this.getLogParam(),t||{}),$.Log.cache(i)}},mailIsEnabled:function(){return this.configIsEnabled()},attachIsEnable:function(){return!1},attachIsEnableInView:function(){return!1},featureCheck:function(e){return!1},sendSuccess:function(){},groupSendSceneTrigger:function(){},isGroupTrace:function(e){return!1}};u.inherit(m,o.Z),u.extend(m.prototype,p),t.Z=m},17690:function(e,t,i){i.r(t),i(803),i(79150),i(15761),i(20869),i(42295),i(63518),i(75654),i(34994),i(92274),i(48868),i(63045),i(81874),i(54861);var a=i(62193),n=i(64560),o=i(72957),r=new o.c1("module.compose.ComposeManager"),s=$.Object,c=$.Ud,l=$.createClass((0,o.$N)("module.compose.ComposeManager"));s.extend(l,{entry:function(e){var t;try{t=a.Z.getTime(0)}catch(e){t=new Date}var i=["c",t.valueOf()].join(":"),n=(e=e||{}).type||"compose";if("compose"!=n){var o,r=e.param;if(r)"string"==typeof r.id&&(i=r.id),"reply"==n&&(o=r.body)&&(o.toAll&&(n+="_all"),o.withAttachments&&(n+="_ach")),"forward"==n&&(o=r.body)&&"attach"==o.mode&&(n+="_ach");else n="compose",e={}}var d=!1;if("compose"==n){var u=$.JS.modules["compose.ComposeModule"];s.each(u,(function(t,i){if(-1!=t.indexOf('"type":"compose"')&&i.empty())return $.JS.go(i),l.resetModule(i,e.param),d=!0,$.BREAK}))}if("draft"==n&&(u=$.JS.modules["compose.ComposeModule"],s.each(u,(function(e,t){var a=t.info.get({did:!0});if(a&&a==i)return $.JS.go(t),d=!0,$.BREAK}))),!d){var m={type:n,fullScreen:!0,cid:i},p="";"0"==c.get({field:"ntes_global",flag:"compose_showContacts"})&&(p="l-r");var f={module:"compose.ComposeModule",param:m,extend:e,viewType:p,hasChildMod:!0,noDragbar:!0};$.JS.go(f)}},resetModule:function(e,t){var i=e.base,a=e.data,n=e.sign;t&&t.info&&i.fillContent(t.info),a.set({status:"initSign",value:!1}),a.set({status:"useSign",value:null}),n.load(),i.autoSave()},error:function(e,t){var i="";switch(e.code){case"FA_FORBIDDEN":i=r.t("å‘ä¿¡é™„åŠ åŠŸèƒ½æƒé™ä¸è¶³ï¼");break;case"FA_OVERFLOW":if(e.overflowReason)switch(i=e.overflowReason){case"pref_smtp_max_mail_count":i=r.t("ä¿¡ä»¶å°æ•°è¶…è¿‡é™åˆ¶ï¼");break;case"pref_smtp_max_num_rcpts":i=r.t(se"pref_smtp_max_send_mail_size":i=r.t("ä¿¡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ï¼");break;case"pref_flow_limit":i=r.t("ä¿¡ä»¶æµé‡è¶…è¿‡é™åˆ¶ï¼");break;case"pref_quota":i="save"===t?r.t("é‚®ç®±å®¹é‡å·²æ»¡ï¼Œé‚®ä»¶æ— æ³•ä¿å­˜ä¸ºè‰ç¨¿ï¼Œè¯·å°½å¿«æ¸…ç†é‚®ç®±ã€‚ç«‹å³å¼€é€šé‚®ç®±ä¼šå‘˜ï¼Œå¯äº«å—è¶…å¤§å­˜å‚¨ç©ºé—´"):"deliver"===t?r.t("é‚®ç®±å®¹é‡å·²æ»¡ï¼Œé‚®ä»¶æœªèƒ½ä¿å­˜åˆ°â€œå·²å‘é€â€æ–‡ä»¶å¤¹ã€‚ç«‹å³å¼€é€šé‚®ç®±ä¼šå‘˜ï¼Œå¯äº«å—è¶…å¤§å­˜å‚¨ç©ºé—´"):r.t("å­˜è‰ç¨¿æˆ–å®šæ—¶å‘ä¿¡æ—¶é‚®ç®±å®¹é‡è¶…è¿‡é™åˆ¶ï¼Œè¯·å°½å¿«æ¸…ç†é‚®ç®±ã€‚")}else i="",i+=r.t("1ã€æ”¶ä»¶äººä¸ªæ•°è¶…è¿‡é™åˆ¶ã€€ã€€ã€€ã€€ã€€&nbsp;")+"<br>",i+=r.t("2ã€ä¿¡ä»¶å¤§å°æˆ–æµé‡è¶…è¿‡é™åˆ¶ã€€ã€€ã€€&nbsp;")+"<br>",i+=r.t("3ã€å­˜è‰ç¨¿æˆ–å®šæ—¶å‘ä¿¡å®¹é‡è¶…è¿‡é™åˆ¶&nbsp;");break;case"FA_NO_RECEIPT":i=r.t("å‘ä¿¡æ—¶ç¼ºå°‘æ”¶ä»¶äººï¼");break;case"FA_WRONG_RECEIPT":i=r.t("æ”¶ä»¶äººåœ°å€æ ¼å¼é”™è¯¯ï¼"),e.badAddress&&(i+="("+$.String.escapeHTML(e.badAddress)+")");break;case"FA_INVALID_ACCOUNT":i=r.t("å‘ä»¶äººåœ°å€æ ¼å¼é”™è¯¯ï¼"),e.badAddress&&(i+="("+$.String.escapeHTML(e.badAddress)+")");break;case"FA_INVALID_DATE":i=r.t("å®šæ—¶å‘ä¿¡è®¾ç½®æ—¶é—´é”™è¯¯ï¼");break;case"FR_INVALID_REQUEST":i=r.t("å‘ä¿¡å†…å…è®¸å‘ä¿¡ase"FA_MTA_RCPT_ERROR":i="FA_MTA_RCPT_ERROR";break;case"FA_MTA_REJECTED":if(e.mtaCode)switch(e.mtaCode){case 5510:i=r.t("IPåœ°å€å¼‚å¸¸ï¼Œè¯·æ±‚è¢«æ‹’ç»ï¼");break;case 5511:i=r.t("å¯¹ä¸èµ·ï¼Œæ‚¨çš„è´¦å·ç›®å‰è¢«ç¦æ­¢å‘ä¿¡")+r.t("ï¼Œè¯·")+'<a href="'+$.Uri.getUrl("compose_send_forbid")+"?user="+(0,o.$S)("uid")+'" target="_blank" style="color:#039 !important;" >'+r.t("ç‚¹å‡»è¿™é‡Œç”³è¯‰")+"</a>ã€‚";break;case 5520:i=r.t("å¯¹ä¸èµ·ï¼Œæ‚¨ä»Šå¤©å‘é€é‚®ä»¶æ•°é‡è¶…è¿‡é™åˆ¶ï¼Œè¯·æ˜æ—¥å†è¯•ï¼")+"<br/>"+r.t("æç¤ºï¼šç¾¤å‘æ—¶æ¯ä½æ”¶ä»¶äººéƒ½å°†æ¶ˆè€—æ‚¨çš„å‘ä¿¡æ¬¡æ•°");break;case 5521:i=r.t("çŸ­æ—¶é—´å‘ä¿¡è¿‡å¤šï¼Œè¯·ç¨åå†è¯•ï¼");break;case 5530:i=r.t("å¯¹ä¸èµ·ï¼Œæ‚¨ä»Šå¤©å‘é€å¯¹è±¡è¿‡å¤šï¼Œè¯·æ˜æ—¥å†è¯•ï¼");break;case 5531:i=r.t("çŸ­æ—¶é—´å‘é€å¯¹è±¡è¿‡å¤šï¼Œè¯·ç¨å€™å°è¯•ï¼");break;case 5522:i=r.t("æ“ä½œè¿‡äºé¢‘ç¹ï¼Œè¯·æ±‚è¢«æ‹’ç»ï¼");break;case 4512:case 5540:case 5910:i=r.t("é‚®ä»¶å«æ•æ„Ÿå†…å®¹ï¼Œè¯·æ±‚è¢«æ‹’ç»ï¼");break;case 5911:i=r.t("å¯¹ä¸èµ·ï¼Œæ‚¨åªèƒ½å‘é€é‚®ä»¶ç»™ç³»ç»Ÿç®¡ç†å‘˜ï¼");break;case 5532:i=r.t("å¯¹ä¸èµ·ï¼Œæ‚¨æœ¬æ¬¡ç¾¤å‘çš„æ”¶ä»¶äººæ•°é‡è¶…è¿‡é™åˆ¶ï¼Œè¯·å‡å°‘åé‡å‘ï¼");break;case 5550:i="5550"}i||(i=r.t("å¯¹ä¸èµ·ï¼ŒæœªçŸ¥åŸå› å¯¼è‡´æœåŠ¡å™¨æ‹’ç»å‘é€ï¼"),e.mtaCode&&(i+="("+r.t("é”™è¯¯ç ")+":"+e.mtaCode+")"))}return i},verify:function(e,t,i){var a="<p>"+{need:r.t("éå¸¸æŠ±æ­‰ï¼Œç³»ç»Ÿè®¤ä¸ºæ‚¨éœ€è¦è¾“å…¥éªŒè¯ç æ‰èƒ½ç»§ç»­å®Œæˆå‘ä¿¡ï¼Œå¦‚æœ‰ä¸ä¾¿ï¼Œæ•¬è¯·ä½“è°…ï¼"),invalid:r.t("éªŒè¯ç ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°è¾“å…¥ï¼")}[e]+'</p><img id="imgMsgBoxVerify" src="'+("s?func=user:generateVerifyCodeImage&sid="+(0,o.$S)("sid")+"&time="+(new Date).valueOf())+'" alt="'+r.t("éªŒè¯ç å›¾ç‰‡")+'" ><p><a id="aMsgB+r.t("çœ‹ä¸æ¸…æ¥šï¼Ÿæ¢ä¸€ä¸ª")+"</a></p>";$.Msgbox.show({statsKey:"Compose_Guide_Popup_Verification",type:"prompt",header:r.t("å‘ä¿¡éªŒè¯"),title:r.t("å¡«å†™éªŒè¯ç "),content:a,inputWidth:"300px",ok:function(e){var i=$.String.trim(e);if(!i)return r.t("éªŒè¯ç ä¸èƒ½ä¸ºç©º");t&&t(i)},cancel:function(){i&&i()}});var n=$("#aMsgBoxVerify"),s=$("#imgMsgBoxVerify");n.listen("click",(function(){var e=s.dom.src,t=new RegExp("&time=.*|$","i");return e=e.replace(t,"&time="+(new Date).valueOf()),s.dom.src=e,!1}))},quickBuild:function(e){var t;if("string"!=typeof(t=e.attrs?e.attrs:e.attrs={}).account)try{t.account=n.default.getDefault().toString()}catch(e){}return"boolean"!=typeof t.saveSentCopy&&(0,o.$S)("attrs").user.save_sent<2&&(t.saveSentCopy=!0),"boolean"!=typeof t.requestReadReceipt&&"1"==c.get({field:"ntes_option",flag:"requirereceipt"})&&(t.requestReadReceipt=!0),"string"!=typeof t.charset&&"1"==c.get({field:"ntes_option",flag:"mailencode"})&&(t.charset="UTF-8"),e.returnInfo=!1,e.action="deliver",0===(0,o.$S)("attrs").user.save_sent&&(e.saveTextThreshold=1048576),e},quickReply:function(e){var t=this;i.e(603).then(i.bind(i,26494)).then($.Function.bind((function(i){var a=i.default,n=e.id,o=e.body;o.id=n,e.flag="replied",a.prototype.replyMessage({body:t.quickBuild(o),log:{action:"fastreply"},error:$.Function.bind(t.quickError,t,e,t.quickReply),callback:$.Function.bind(t.quickSuccess,t,e)}),$.Tips.show(r.t("æ­£åœ¨å›å¤é‚®ä»¶..."))})))},quickForward:function(e){i.e(603).then(i.bind(i,26494)).then($.Function.bind((function(t){var i=t.default,a=this,n=e.id,o=e.body;o.ids=[n],e.flag="forwarded",i.prototype.forwardMessages({body:a.quickBuild(o),log:{action:"quickForward"},error:$.Function.bind(a.quickError,a,e,a.quickForward),callback:$.Function.bind(a.quickSuccess,a,e)}),$.Tips.show(r.t("æ­£åœ¨è½¬å‘é‚®ä»¶..."))}),this))},quickSuccess:function(e,t){e.callback&&e.callback({code:t.code})},quickError:function(e,t,i){var a=this,n=e.callback||$.EMPTYFUNC(),o=a.error(i);if(o)return n({code:"S_ERROR"}),o;switch(i.code){case"FA_INVALID_VERIFY_CODE":case"FA_NEED_VERIFY_CODE":var r=i.code.split("_")[1].toLowerCase();return a.verify(r,(function(i){e.body.verifyCode=i,t.call(a,e)}),(function(){n({code:"S_ERROR"})})),!0}return n({code:"S_ERROR"}),!1}}),t.default=l},69742:function(e,t,i){i(32021),i(92274),i(75654),i(803),i(55737),i(36809);var a=i(54107),n=i(28978),o=(i(99277),i(19024),i(80449),i(26405),i(10487)),r=i(35575),s=i(26494),c=i(95949),l=i(39003),d=i(10915),u=i(60504),m=i(21913),p=i(66544),f=i(67417),h=i(44261),g=i(68216),v=i(72051),b=i(93942),y=i(52077),x=i(15050),k=i(66076),S=i(76610),w=i(65247),T=i(64560),C=(i(63480),i(19916),i(16579),i(52877),i(20422),new $I18N("module.compose.ComposeModule")),_={};_.action=s.default,_.assist=c.Z,_.base=l.Z,_.data=d.Z,_.editor=u.Z,_.event=m.Z,_.form=p.Z,_.info=f.Z,_.view=h.Z,_.sign=g.Z,_.success=v.Z,_.at=b.Z,_.stationery=y.Z,_.mailprotection=null;var I=$.Object,A=$.Browser,M=$.Ud,L=$.Uri,E=$.createClass($N("module.compose.ComposeModule"));I.mix(E,n.Z,{interface:a.default},{}),I.extend(E.prototype,o.Z.prototype);var D={_visibilableTime:0,_isJD1111Show:!0,initialize:function(e){var t=this;t.class=E,t.module=t;var i=E.getAttachClass();_.attach=$L(i),_.mailtrace=$.Ext.mailTrackingV2?x.Z:k.Z,_.mailprotection=$.Ext.mailProtection?S.Z:w.Z,$.Array.each(t.names,(function(e,i){try{t[i]=new _[i](t)}catch(e){$D.log("compose initalize fail : "+i)}}))},init:function(){var e=this;$D.log("compose init start"),$.Array.each(e.names,(function(t,i){try{e[i].init()}catch(e){$D.log("compose init fail : "+i)}})),e.base.start(),e.initData(),$S("isVip")&&(e.vipCheck(),e.vipSmsCheck()),$D.log("compose init end"),$.Log.cache({cl_compose:1},$.EMPTYFUNC)},initData:function(){var e=this,t=e.action,i=e.base,a=e.data,n=e.info,o=e.at,r=e._var.extend||{};r.extends&&a.set({status:"entryExtends",value:r.extends});var s=a.get({status:"fromEntry"}),c=r.param||{},l="",d=null;c.id&&(l=c.id),"string"!=typeof l&&(d=l,l="");var u=r.info||{};c.info&&(u=c.info);var m=r.body||{};c.body&&(m=c.body),"reply"!=s&&"forward"!=s||(m.attrs||(m.attrs={}),m.attrs.account||(m.attrs.account=T.default.getDefault().toString()));var p={action:s};switch(a.set({status:"paramBody",value:m}),s){case"draft":n.set({did:l}),m.id=l;var f=null;c.time&&(f=new Date(c.time)),c.date&&(f=c.date),f&&a.set({status:"fromEntry",value:"timeset"}),t.restoreDraft({body:m,callback:function(e){var t=e.var;f&&(t.scheduleDate=f),n.set({obj:t}),a.set({status:"existActiveDraft",value:!0}),i.fillContent(),i.focus(),t.ctrls&&t.ctrls.at&&o.addEmail(t.ctrls.at)}});break;case"edit":n.set({mid:l}),m.id=l,t.editMessage({body:m,callback:function(e){var t=e.var;n.set({obj:t}),i.fillContent(),i.focus(),t.ctrls&&t.ctrls.at&&o.addEmail(t.ctrls.at)}});break;case"reply":n.set({mid:l}),i.fillContent(m.attrs,!0),m.id=l,m.toAll&&(p.action="replyall"),m.withAttachments&&(p.action="replyallattach",m.supportTNEF=!0),t.replyMessage({body:m,log:p,callback:function(e){n.set({obj:e.var}),i.fillContent(),i.focus(),c.lang&&"west"==c.lang&&i.trans({action:"replyTrans"})}});break;case"forward":d?n.set({ids:d}):n.set({mid:l}),i.fillContent(m.attrs,!0),d?(m.mode="attach",m.ids=d,m.attrs.isHtml=!0):(m.ids=[l],m.supportTNEF=,callback:function(e){n.set({obj:e.var}),i.fillContent(),i.focus()}});break;default:if(n.set({cid:n.getClientId()}),u=r.info||{},c.info&&(u=c.info),i.fillContent(u),u.stationeryId){var h=e.stationery;h.preLoad((function(){h.select({id:u.stationeryId})}))}}},getData:function(e){var t=this,i=t.data,a=t._var,n=t.extend=a.extend||{},o="compose";n.type&&(o=n.type),i.set({status:"fromEntry",value:o}),e()},getGroup:function(){var e=this._var.param;return e.type+e.cid},getText:function(e){var t=this;return t.fTextCall=e,t.stext||t.setText("",!0)},setText:function(e,t){var i=this,a=i.data;if(i.fTextCall){if(e);else{var n="";try{n=a.get({status:"fromEntry"})}catch(e){}switch(n){case"draft":e=C.t("è‰ç¨¿");break;case"reply":e=C.t("å›å¤");break;case"forward":e=C.t("è½¬å‘");break;default:e=C.t("å†™ä¿¡")}}if(t)return e!=C.t("å†™ä¿¡")&&(e+=C.t("åŠ è½½ä¸­")),e;i.stext=e,i.fTextCall(e)}},resets,t=e.attach,i=e.base,a=e.data,n=!1;try{t.get({cloud:!0})||"compose"==a.get({status:"curPage"})&&(n=i.empty())}catch(e){}return n},exit:function(e,t,i){var a=this,n=a.data,o=a.success;if(a.destroyFinish)return!0;var r=a.base,s=n.get({status:"showScheduleInvitation"});if(!r)return!0;if(a.empty())return r.clearTimer("keep"),r.clearTimer("save"),!0;n=a.data;var c=a.attach;if("destroy"==n.get({status:"curPage"}))return!0;if(n.get({status:"confirmExit"})){var l=function(){n.set({status:"confirmExit",value:!1}),t()},d=function(){$.Msgbox.msgbox&&$.Msgbox.msgbox.close()};if("success"!=n.get({status:"curPage"})){if(n.get({status:"uploadParam"})||c.fileIsUpload())return e?$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentUploading",type:"confirm",title:C.t("é™„ä»¶æ­£åœ¨ä¸Šä¼ ï¼Œç¡®å®šä¸­æ–­å’Œæ”¾å¼ƒå¯¹æ­¤ä¿¡ä»¶æ‰€ä½œçš„æ“ä½œ?"),ok:function(){!function(){if(n.attachments.files){var e,t=n.attachments.files,i=[],a=0;for(var o in t)t[o].cloud&&t[o].ret&&100!==t[o].percent&&(t[o].ret.fid&&i.push(t[o].ret.fid),a+=t[o].size);i.length&&(e=1===i.length?i[0]:i.join(","),$.Ajax.jsonp(L.getUrl("compose_batch_delete_url")+"&op=batchDelete&fileIds="+e,(function(){var e=$S("cl,e))})),$.Log.cache({compose_batch_delete:{from:"fComposeModuleExit",fileIds:e}}))}}(),setTimeout((function(){l()}),100)}}):d(),!1;if(r.changeCheck()||s){if(e){var u=s?"vW0":"",m=s?'<div style="color:#999;">'+C.t("æç¤ºï¼šå­˜è‰ç¨¿åï¼Œæ—¥ç¨‹ä¿¡æ¯æš‚ä¸æ”¯æŒä¿å­˜åˆ°è‰ç¨¿ç®±")+"</div>":"";$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_ComposeLeave",extcls:u,title:C.t("æ‚¨æ­£åœ¨å†™ä¿¡ä¸­ï¼Œæ˜¯å¦ç¦»å¼€å†™ä¿¡é¡µé¢ï¼Ÿ"),content:m,closeClick:function(){i&&i()},buttons:[{text:C.t("ç¦»å¼€å¹¶å­˜è‰ç¨¿"),subclass:"mainBtn",click:function(){r.send({action:"force",call:l}),d(),$.Log.cache({Compose_NoGuide_Popup_ComposeLeave_SaveDraft:1})}},{text:C.t("ç¦»å¼€ä¸å­˜è‰ç¨¿"),click:function(){n.set({status:"confirmDeleteDraft",value:!1}),l(),d(),$.Log.cache({Compose_NoGuide_Popup_ComposeLeave_NotSaveDraft:1})}},{text:C.t("å–æ¶ˆ"),click:function(){d(),i&&i(),$.Log.cache({Compose_NoGuide_Popup_ComposeLeave_Cancel:1})}}]})}else d();return!1}}}return o&&o.exit&&o.exit(),r.destroy(),$.JS.remove(a),a.destroyFinish=!0,!0},resize:function(){switch(A.getInfo().os){case"ipad":case"ipod":case"iphone":case"android":break;default:this.base.layoutAdjust({attach:!0,timer:!0})}},cache:function(){$S("isVip")&&this.vipCheck()},onBeforeDisappear:function(){this.data},switchIn:function(){this.base.composeTimeStart()},switchOut:function(){var e=this,t=e.base,i=e.data;try{i.get({status:"confirmExit"})&&(i.get({status:"sendParam"})||i.get({status:"uploadParam"})||e.attach.fileIsUpload()||!t.changeCheck()||t.send({action:"auto"}))}catch(e){}t.composeTimeAdd()},layoutInit:function(){var e=this.data,t=e.layout;$S("clientHeight")||$S("clientHeight",document.documentElement.clientHeight),t.baseHeight=$S("clientHeight"),t.baseTop=86,t.topToolbar=62,t.bottomToolbar=82,t.baseCen.baseTop=t.baseCenter=0),t.editorHeight=t.baseHeight-(t.baseTop+t.topToolbar+t.baseCenter+t.bottomToolbar)+2;var i=e.get({element:"ext"}),a=0;i&&(a=i.dom.offsetHeight||0),t.editorHeight-=a,t.editorMin=300,t.editorHeight=Math.max(t.editorHeight,t.editorMin),t.containerCls=this.getModuleClass()},getModuleClass:function(){$S("clientWidth")||$S("clientWidth",document.documentElement.clientWidth);var e="tW0",t=$S("clientWidth");return t<=1680||(e+=t<=1920?" CW0":t<=2560?" CV0":" CB0"),e},vipSmsCheck:function(){if(!E.sms_bind){E.sms_bind=-1;var e=L.getUrl("compose_vip_sms_bind2",!0);$.Ajax.jsonp(e,(function(e){e&&200==e.code&&(E.sms_bind=2)}))}},vipCheck:function(e){if(E.isValid)return!0;var t=!1,i=$S("attrs")S("is188")?$.Array.has(i,"230")&&(t=!0):$S("is126vip")&&$.Array.has(i,"101")&&(t=!0),t){var a=L.getUrl("compose_vip_valid");return $.Msgbox.show({header:C.t("å‘ä¿¡æ¿€æ´»"),contentType:"custom",noFooter:!0,content:'<iframe id="composeSucSmsIframe" src="'+a+'" style="display:block;width:100%;height:200px" scrolling="no" frameborder="0"></iframe>',close:function(){if(E.isValid)return!1;var e=$.Context.module;e&&e.mtype&&"compose.ComposeModule"==e.mtype?$.JS.back():$.JS.go({module:"welcome.WelcomeModule"})}}),!1}return!0},vipCheckSuc:function(){E.isValid=!0;var e="https://"+$S("host")+"/js6/compose/reload.jsp?sid="+$S("sid");$.Ajax.request({requestType:$.Ajax.IFRAME,rnd:!0,url:e}),$.Msgbox.msgbox&&$.Msgbox.msgbox.close()},newYearLetter:function(){this.data.set({status:"empty",value:!1}),$.getClass($N("interface.ComposeInterface")).entry({type:"compose",param:{info:{subject:C.t("ç¥æ‚¨æ–°æ˜¥å¿«ä¹ï¼"),stationeryId:196}}})}};I.extend(E.prototype,D),I.extend(E,{cls:"tW0",ariaLabel:C.t("å†™ä¿¡"),View:_.view,Listener:r.Z,getAttachClass:function(){var e=$.Browser,t="module.compose.";if("3"!=M.get({field:"ntes_compose",flag:"upload_mode"})){var i=e.getVersion()||[0,0],a=e.getInfo();if(_.assist.hasNewVersion())return t+"ComposePlugin";var n=!1;if(a.shell)i[0]>=24&&(n=!0);else if(e.chrome())i[0]>=20&&(n=!0);else if(e.firefox())i[0]>=4&&(n=!0);else if(e.opera())i[0]>=15&&(n=!0);el[0]>=6)&&(n=!0);else if(e.edge())n=!0;else if(e.ie()&&i[0]>=10)try{(new Blob).slice&&(n=!0)}catch(e){}if(n)return t+"ComposeNative"}return t+"ComposePost"}})},80449:function(e,t,i){i.r(t),i(92274),i(63045),i(66403),i(36809),i(42295),i(34994),i(15761),i(20869),i(63518),i(75654),i(803);var a=i(99277),n=i(72957),o=i(34691),r=$.createClass((0,n.$N)("module.compose.ComposeNative")),s=$.Object,c=$.Browser,l=$.S_OK;s.inherit(r,a.Z),s.extend(r.prototype,{syncInterval:3e5,initialize:function(e){r.superClass.initialize.call(this,e)},init:function(){r.superClass.init.call(this)},initProcess:function(e){e||(r.superClass.initProcess.call(this,"native"),this.initInput())},initInput:function(){var e=this,t=(c.getInfo(),e.data),i=e.sourceGet("element"),a=e.createInput();a.listen("change",(function(){var t=a.dom.files;if(t.length){t=s.toArray(t),e.nativeSelect(t,void 0,"NativeInitInput");try{a.dom.value=""}catch(e){}}})),i.browser.append(a.dom),i.browser.show(),i.input=a,t.set({status:"uploadMode",value:"native"})},createInput:function(){var e=c.getInfo(),t=(this.data,this.sourceGet("element"),$.Element.create("input"));return t.setClass("O0"),t.attr({type:"file",size:"1",multiple:!0}),"windows"==e.os&&c.safari()&&t.attr({multiple:!1}),t},nativeClick:function(){this.sourceGet("element").input.dom.click()},nativeSelect:function(e,t,i){var a=this,n=[];$.Array.each(e,(function(e,o){var r=o.name||o.fileName,s=0;"number"==typeof o.size?s=o.size:"number"==typeof o.fileSize&&(s=o.fileSize);var c=a.fileCreate({type:"native",name:r,size:s,cloud:t,from:i});if(o.lastModifiedDate)try{c.modtime=o.lastModifiedDate.valueOf()}catch(e){}c.blob=o,o.inlined&&(c.inlined=c.context=!0),n.push(c)}));try{$.Log.cache({compose_native_select:{fileCount:e.length,from:i}})}catch(e){}a.filterCheck({files:n,submit:function(e){$.Array.each(e.select,(function(e,t){t.delete=function(){a.fileRemove(t),t.delete=null},a.add(t)})),a.traceCheck(),a.fileAutoUpload()},cancel:function(){}})},nativeCheck:function(e){var t=this,i=t.attach;if(t.getCheck(e)){var a=t.nativeGet(e);if(!a)return;a.onreadystatechange=function(){4==a.readyState&&(a.onreadystatechange=null,200==a.status?t.check(e,a.responseText)&&(t.setStartTime(e),t.setStartOffset(e),t.fileUpload(e),t.netCheckSet(e),t.fileLog("compose_native_uploadstart",e)):t.error(e,"JS_HTTP",a.status,"check")?t.nativeCheck(e):t.resum(e))};var n=t.getUploadProxy({type:"native",file:e,options:"body",check:!0});e.upxmailUrl=n,a.open($.Ajax.POST,n,!0),a.withCredentials||(a.withCredentials=!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(e.options);try{t.fileLog("compose_native_uploadcheck",e)}catch(e){}}else{if(e.cloud)e.err="retryErrorBig",i.filterFail([e]);else{t.setStartTime(e),t.fileUpload(e);try{t.fileLog("compose_native_uploadfile",e)}catch(e){}}t.netCheckSet(e)}},fileUpload:function(e,t){var i=this,n=i.nativeGet(e);if(n)if(n.upload&&(n.upload.onprogress=function(t){t.lengthComputable&&i.setBytes(e,t.loaded,t.total)}),n.onerror=function(){i.needValiServerBeforeSend(e),i.log("b_compose_attach_upload_error")},n.onabort=function(){i.needValiServerBeforeSend(e),i.log("b_compose_attach_upload_abort")},n.ontimeout=function(t){i.needValiServerBeforeSend(e),i.log("b_compose_attach_upload_timeoutwitch(n.readyState){case 1:i.setStart(e);break;case 2:i.setFinish(e);break;case 4:if(n.onreadystatechange=null,n.upload&&(n.upload.onprogress=null),i.netCheckClear(),e.blob)if(200==n.status){var t=i.complete(e,n.responseText);if(t.code==l)if(t.continue)i.fileUpload(e),i.netCheckSet(e);else try{if(e.startTime){var a=(new Date).getTime()-e.startTime,o=e.size-e.startOffset;i.fileLog("compose_native_uploadsuccess",e,{uploadSpeed:Math.round(o/a*1e3)})}else i.fileLog("compose_native_uploadsuccess",e)}catch(e){}else if(t.retry){var r={code:t.code};i.fileRetry(e,r)}else i.resum(e)}else e.abort?e.abort=!1:i.error(e,"JS_HTTP",n.status,"upload")?(r={code:{code:"JS_HTTP",reason:n.status}},i.fileRetry(e,r)):i.resum(e)}},i.sessionRenew(e),i.getUploadHost()){var o=e.blob,r=!1;if((o.slice||o.mozSlice||o.webkitSlice)&&(r=!0),e.skipSplit)e.useSplit=!1,e.offset=0,e.length=0;else if(r){e.useSplit=!0,e.length=a.Z.sliceLength,e.offset+e.length>e.size&&(e.length=e.size-e.offset);var c=e.offset+e.length;o.slice?o=o.slice(e.offset,c):o.mozSlice?o=o.mozSlice(e.offset,c):o.webkitSlice&&(o=o.webkitSlice(e.offset,c))}var d=i.getUploadProxy({type:"native",file:e,options:"header"},t);e.upxmailUrl=d,n.open($.Ajax.POST,d,!0),n.withCredentials||(n.withCredentials=!0),e.options&&s.each(e.options,(function(e,t){n.setRequestHeader(e,t)})),n.setRequestHeader("Content-Type","application/octet-stream"),n.send(o)}else{if(n.open($.Ajax.POST,i.getUploadUrl({type:"native"}),!0),"undefined"!=typeof FormData)try{var u=new FormData;u.append("Filedata",e.blob,e.blob.name),n.send(u)}catch(e){}else if(e.blob.getAsBinary){var m=encodeURIComponent(e.name);m=m.replace(new RegExp("%(\\w{2})","ig"),(function(e,t){return String.fromCharCode(parseInt(t,16))}));var p="------neteasemailnativeupload"+(new Date).getTime(),f="--",h="\r\n",g=[];g.push(f,p,h),g.push('Content-Disposition: form-',h),g.push("Content-Type: application/octet-stream",h,h),g.push(e.blob.getAsBinary(),h),g.push(f,p,f,h),n.setRequestHeader("Content-Type","multipart/form-data; boundary="+p);try{var v=g.join("");n.sendAsBinary(v)}catch(e){}}$.Log.cache({compose_native_wmsvr_upload:""})}},fileRetry:function(e,t){this.nativeCheck(e,t)},fileBreak:function(e){if("success"!=e.state&&"wait"!=e.state){var t=this.get({element:"nativeRequest"});try{e.abort=!0,t.abort()}catch(e){}}},fileRemove:function(e){e.blob&&(e.blob=null),this.fileBreak(e)},fileLog:function(e,t,i){try{var a={uploadType:t.type,ext:t.ext,size:t.size,from:t.from,upxmailUrl:t.upxmailUrl,cloud:this.cloudTrigger(),fuuid:t.__uuid__,hashSpeed:t.hashSpeed,hash:t.md5};i&&$.Object.extend(a,i);var n={};n[e]=a,$.Log.cache(n)}catch(e){console.log(e)}},nativeGet:function(e){var t=this;$.Browser.firefox()&&t.set({element:"nativeRequest",value:null}),$.Browser.chrome()&&e.retry>0&&t.set({element:"nativeRequest",value:null});var i=t.get({element:"nativeRequest"});if(!i){try{i=new XMLHttpRequest}catch(e){}i&&t.set({element:"nativeRequest",value:i})}return i},setStartOffset:function(e){var t=e.offset||0;e.startOffset=t},setStartTime:function(e){e.startTime=(new Date).getTime(),e.sessionRenewTime=e.startTime},sessionRenew:function(e){var t=(new Date).getTime();t-e.sessionRenewTime>=this.syncInterval&&(e.sessionRenewTime=t,o.default.request(["Folder"]))},needValiServerBeforeSend:function(e){e.ret&&e.ret.aid||e.cloud||this.set({status:"validServer",value:!0})},log:function(e){$.Log.cache(e)}}),t.default=r},19916:function(e,t,i){i.r(t),i(37092),i(92274),i(48868),i(63045),i(81874),i(54861);var a=i(10487),n=i(72957),o=i(64560),r=i(89308),s=new n.c1("module.compose.ComposeNotary"),c=$.createClass((0,n.$N)("module.compose.ComposeNotary")),l=$.Object;l.inherit(c,a.Z),l.extend(c.prototype,{initialize:function(e){l.extend(this,{status:{initSign:null,closeSign:null,open:null},component:{signSet:null,sign:null,pass:null},element:{area:null}}),c.superClass.initialize.call(this,e)},init:function(){var e=this;c.superClass.init.call(e),r.default.getNotaryInfo((function(t){e.userpro=t.isPrivilege,e.singleBlance=t.singleBalance,e.isAutoArchive=t.isAutoArchive,e.render()}))},clear:function(){c.superClass.clear.call(this.element),c.superClass.clear.call(this)},render:function(){var e=this,t=e.module,i=e.data,a=e.component,n=e.element;n.area=i.get({element:"notary"});var o=new $.Link({cls:"nui-block-close nui-close",icon:"close",click:function(){i.get({component:"notary"}).setChecked(!1)}}),r=new $.Link({text:s.t("è®¾ç½®å…¬æ­£é‚®ç­¾å")+"&gt;&gt;",attrs:"style = 'float:right;margin-right:30px;margin-top:10px;display:none;'",click:function(){e.openGzyApp()}});a.signSet=r;var c=new $.Link({cls:"nui-fIBlock",icon:"help",link:"http://gzy.mail.163.com/?from=xiexin",title:s.t("ä»€ä¹ˆæ˜¯é‚®ä»¶å­˜è¯?"),attrs:"style = 'margin:-6px 0 0 4px;'",target:"_blank"}),l=o.html()+r.html()+'<div class="bT0"><strong>'+s.t("é‚®ä»¶å­˜è¯")+'</strong> <span class="nui-txtTips">'+s.t("è®©ç”µå­é‚®ä»¶å˜é“è¯")+c.html()+"</span></div>";if(1==e.userpro){var d=new $.Link({text:s.t("æŸ¥çœ‹å†å²å­˜è¯é‚®ä»¶"),click:function(){e.openGzyApp()}});l+='<div class="eN2">'+(e.isAutoArchive?s.t("å°Šäº«å…¬æ­£é‚®æœåŠ¡ï¼Œè¯¥å°é‚®ä»¶å°†è‡ªåŠ¨ä¿å…¨å­˜è¯ã€‚"):s.t("å°Šäº«å…¬æ­£é‚®æœåŠ¡ï¼Œå‹¾é€‰åè¯¥å°é‚®ä»¶å°†è‡ªåŠ¨ä¿å…¨å­˜è¯ã€‚"))+d.html()+"</div>"}else l+='<div class="nui-normalTable nui-table"><table><thead class="nui-table-head"><tr class="nui-table-row"><th class="nui-table-cell nui-table-cell-isFirst">'+s.t("å‘ä»¶äºº")+'</th><th class="nui-table-cell">'+s.t("ä¸»é¢˜")+'</th><th class="nui-table-cell nui-table-cell-isLast">'+s.t("çŠ¶æ€")+'</th></tr></thead><tbody class="nui-table-body"><tr class="nui-table-row"><td id="'+t.createId("notarySender")+'" class="nui-table-cell nui-table-cell-isFirst"></td><td id="'+t.createId("notarySubject")+'" class="nui-table-cell"></td><td class="nui-table-cell nui-table-cell-isLast" style="color:#FE6601">'+s.t("å¾…ä¿å…¨åˆ°å…¬æ­£é‚®ç³»ç»Ÿ")+"</td></tr></tbody></table></div>";l+='<a id="'+t.createId("notaryFocus")+'" href="javascript:void(0)" hidefocus="hidefocus" style="text-decoration:none;display:none">ã€€</a>',n.area.html(l),$.Component.setEvents(),n.focus=i.get({moduleId:"notaryFocus"}),1!=e.userpro&&(n.sender=i.get({moduleId:"notarySender"}),n.subject=i.get({moduleId:"notarySubject"}),e.updateUI(),i.get({component:"subject"}).listen("blur",(function(){e.updateUI()})))},updateUI:function(){var e=this,t=e.module,i=t.form,a=e.element;if(1!=e.userpro){var n=i.getSubject(),o=$.String.escapeHTML(n);t.attach.fileHas()&&(o+='<b class="nui-ico nui-ico-att"></b>'),a.subject.html(o);var r=i.getSender();a.sender.html(r.address)}},focus:function(e){e=e||{};var t=this.component;try{t.pass.focus()}catch(e){}if(e.select)try{t.pass.select()}catch(e){}},checkSign:function(){var e=this,t=e.status,i=e.component;if(t.initSign)e.notarySign&&e.showSign();else{t.initSign=!0;var a=$.Uri.getUrl("compose_notary_sign");$.Ajax.jsonp(a,(function(a){if(a){var n=!1;if(200==a.code){t.open=!0;var o=a.result;o&&1==o.checked&&(n=!0),i.signSet.show()}404==a.code&&(n=!0),n&&(e.notarySign=!0,e.showSign())}}))}},getSign:function(){var e=!1,t="";return r.default.getNotaryInfo((function(t){t.isPrivilege&&(e=!0)}),(function(){})),e&&((0,n.$S)("isVip")?t=s.t("ã€VIPå°Šäº«ã€‘"):$.Ud.udProxy["product.vipMember"]&&(t=s.t("ã€ä¼šå‘˜å°Šäº«ã€‘"))),'<div style="height:42px;line-height:42px;font-size:16px;text-align:center"><div style="font-size:16px;color: #21293A"> <span style="color:#CC0000;font-weight:900;">'+s.t("â˜…")+"</span>"+t+s.t("æ­¤é‚®ä»¶å·²è¢« ")+' <a href="http://gzy.mail.163.com/?from=mailread" style="text-decoration:none" target="_blank"><strong style="color:#CC0000">'+s.t("ç½‘æ˜“å…¬æ­£é‚®")+"</strong></a>"+s.t(" ä¿å…¨å­˜è¯ï¼Œå‘ä»¶äººæ‰¿è¯ºä¸æ‚¨è¯šä¿¡æ²Ÿé€šï¼")+'<span style="color:#CC0000;font-weight:900;">'+s.t("â˜…")+"</span></div></div>"},showSign:function(){var e=this,t=e.component,i=e.status;if(!i.closeSign)if(i.useSign=!0,null===t.sign){var a=e.module.createId("ext"),n=new $.Component({html:'<div class="pU1"><b class="nui-ico nui-ico-close">x</b>'+e.getSign()+"</div>",renderTo:a,renderBy:"before"});n.getEl().fion(t){i.closeSign=!0,e.hideSign()})),t.sign=n}else t.sign.show()},hideSign:function(){var e=this,t=(e.module,e.component);e.status.useSign=!1,null!==t.sign&&t.sign.hide()},checkSender:function(){var e=tent,t.getSender().address),a=o.default.getUid(),n=o.default.getMobile();return i==a.address||null!==n&&i==n.address},openGzyApp:function(){(0,n.$S)("isVip")?Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"notary",title:s.t("ç½‘æ˜“å…¬æ­£é‚®"),cross:!1,group:"notary",fullScreen:!0})}))):Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"notary_free_v2",title:s.t("ç½‘æ˜“å…¬æ­£é‚®"),cross:!1,group:"notary_free_v2",fullScreen:!0})})))},toggle:function(e){e=e||{};var t=this,i=t.data,a=(t.form,t.element),n=i.get({status:"showNotary"});if(e.open&&n)return!1;if(e.close&&!n)return!1;if(n)a.area.hide(),t.hideSign();else{if(!t.checkSender())return new $.Msgbox({title:s.t("å½“å‰å‘ä»¶äººä¸æ”¯æŒé‚®ä»¶å­˜è¯ï¼Œå¦‚éœ€å­˜è¯ï¼Œè¯·åˆ‡æ¢åˆ°ä¸»è´¦å·æˆ–å…³è”çš„æ‰‹æœºå·ç é‚®ç®±ã€‚")}),!1;t.updateUI(),a.area.show(),a.focus.show(),t.checkSign();try{a.focus.dom.focus(),a.focus.dom.blur()}catch(e){}a.focus.hide()}return i.set({status:"showNotary",value:!n}),!0},statusRestore:function(){this.isAutoArchive&&this.toggle({open:!0})}}),t.default=c},19024:function(e,t,i){i(87553),i(15296),i(92274),i(63045),i(66403),i(36809);var a=i(99277),n=i(72957),o=new n.c1("module.compose.ComposePlugin"),r=$.createClass((0,n.$N)("module.compose.ComposePlugin")),s=$.Object,c=$.S_OK;s.inherit(r,a.Z),s.extend(r.prototype,{initialize:function(e){r.superClass.initialize.call(this,e)},init:function(){r.superClass.init.call(this)},initProcess:function(){r.superClass.initProcess.call(this,"plugin"),this.initEvent()},initEvent:function(){var e=this,t=e.data;e.sourceGet("element").link.listen("click",(function(t){e.pluginBrowse({type:"file",title:o.t("é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶"),call:function(t){t.length&&e.pluginSelect(t)}}),$.Event.cancel(t)})),t.set({status:"uploadMode",value:"plugin"})},pluginBrowse:function(e){var t=this,i=t.assist.create("desktop");if(i){var n={};switch(e.single?n.singleFile=!0:n.singleFile=!1,e.title&&(n.title=e.title),e.type){case"file":n.filter2=a.Z.filter;break;case"image":n.filter2=a.Z.filterImage}i.openFiles((function(i){var a=e.call,n=s.toArray(i);"function"==typeof a&&t.base.addTimer("pluginBrowse",(function(){a(n)}),0)}),n)}},pluginSelect:function(e,t){var i=this,a=[];$.Array.each(e,(function(e,n){var o=0;try{o=n.blob.length}catch(e){}var r="";try{r=n.path}catch(e){}var s=i.fileCreate({type:"plugin",name:n.name,path:r,size:o,cloud:t});s.blob=n.blob,n.inlined&&(s.inlined=s.context=!0),a.push(s)})),i.filterCheck({files:a,submit:function(e){$.Array.each(e.select,(function(e,t){t.delete=function(){i.fileRemove(t),t.delete=null},i.add(t)})),i.fileAutoUpload()},cancel:function(){}})},pluginHash:function(e){var t=this,i=t.assist.create("digest");i&&(t.setState(e,"hash"),e.digest=i.CalculateMD5WithProgress(e.blob,(function(i){e.digest&&(e.digest=null,i=i||"-1",t.setHash(e,e.size,i))}),(function(i,a){e.digest&&t.setHash(e,i)})))},pluginCheck:function(e,t){var i=this;if(i.getCheck(e)){var a=i.assist.requestGet();if(!a)return;if(!e.path)return void i.error(e,"JS_PLUGIN");a.onreadystatechange=function(){4==a.readyState&&(a.onreadystatechange=null,200==a.status?i.check(e,a.responseText)&&(i.fileUpload(e),i.netCheckSet(e)):i.error(e,"JS_HTTP",a.status,"check")?i.pluginCheck(e,{code:"JS_HTTP",reason:a.status}):i.resum(e))};var n=i.getUploadProxy({type:"plugin",file:e,options:"body",check:!0},t);a.open($.Ajax.POST,n,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(e.options)}else i.fileUpload(e),i.netCheckSet(e)},fileUpload:function(e,t){vt();if(n)if(n.upload.onprogress=function(t){t.lengthComputable&&i.setBytes(e,t.loaded,t.total)},n.onreadystatechange=function(){switch(n.readyState){case 1:i.setStart(e);break;case 2:e.path;break;case 4:if(n.onreadystatechange=n.upload.onprogress=null,i.netCheckClear(),e.blob)if(200==n.status){var t=i.complete(e,n.responseText);t.code==c?t.continue&&(i.fileUpload(e),i.netCheckSet(e)):t.retry?i.fileRetry(e,{code:t.code}):i.resum(e)}else i.error(e,"JS_HTTP",n.status)?i.fileRetry(e,{code:"JS_HTTP",reason:n.status}):i.resum(e)}},i.getUploadHost()&&e.path){var o=e.blob;e.useSplit=!0,e.length=a.Z.sliceLength,e.offset+e.length>e.size&&(e.length=e.size-e.offset),o=o.slice(e.offset,e.length);var r=i.getUploadProxy({type:"plugin",file:e,options:"header"},t);n.open($.Ajax.POST,r,!0),e.options&&s.each(e.options,(function(e,t){n.setRequestHeader(e,t)})),n.setRequestHeader("Content-Type","application/octet-stream"),n.send(o)}else{n.open($.Ajax.POST,i.getUploadUrl({type:"plugin"}),!0);var l="------neteasemailpluginupload"+(new Date).getTime(),d="--",u="\r\n",m=[];m.push(d,l,u),m.push('Content-Disposition: form-data; name="Filedata"; filename="',e.name,'"',u),m.push("Content-Type: application/octet-stream",u,u),m.push(e.blob),m.push(u),m.push(d,l,d,u),n.setRequestHeader("Content-Type","multipart/form-data; boundary="+l),n.setRequestHeader("Cookie","Coremail="+$.Cookie.get("Coremail",!0));try{(o=i.assist.create("blob"))&&(o.append(m),n.send(o.getAsBlob()))}catch(e){}}},fileRetry:function(e,t){this.pluginCheck(e,t)},fileBreak:function(e){if("success"!=e.state&&"wait"!=e.state){var t=this.assist.requestGet();try{t.abort()}catch(e){}}},fileRemove:function(e){if(e.blob&&(e.blob=null),e.digest){try{e.digest.abort()}catch(e){}e.digest=null}this.fileBreak(e)}})},26405:function(e,t,i){i(92274),i(63045),i(36809),i(66403);var a=i(99277),n=i(72957),o=new n.c1("module.compose.ComposePost"),r=$.createClass((0,n.$N)("module.compose.ComposePost")),s=$.Object,c=$.S_OK;s.inherit(r,a.Z),s.extend(r.prototype,{initialize:function(e){r.superClass.initialize.call(this,e)},init:function(){r.superClass.init.call(this)},initProcess:function(){r.superClass.initProcess.call(this,"post"),this.initForm()},initForm:function(){var e=this,t=e.data;e.postCreate(),e.postAdd(),e.postSwitch({enable:!0}),t.set({status:"uploadMode",value:"post"}),$.Log.cache({compose_attach_postUpload_init:""})},postCreate:function(){var e=this.module,t=this.sourceGet("element"),i=e.createId("attachUpload"),a=$.Element.create("FORM");a.setClass("by0"),a.dom.method="POST",a.dom.target=i,t.operate.append(a.dom),t.formContainer=a},postSwitch);if("boolean"==typeof e.enable){var i=t.formContainer;e.enable?i.show():i.hide()}},postStop:function(){var e=this.data.get({status:"uploadParam"});if(e&&"form"==e.action)try{var t=this.module.createId("attachUpload");$.fly("#"+t).attr({src:"about:blank"})}catch(e){}},postUpload:function(){var e=this,t=e.base,i=e.data,a=e.sourceGet("element"),n=e.getUploadUrl({type:"form"}),r=t.getCallName((function(){e.postResult.apply(e,arguments)}),!0);n+="&call=window.parent."+r,a.formContainer.attr({action:n,encoding:"multipart/form-data",enctype:"multipart/form-data"}),i.set({status:"uploadParam",value:{action:"form"}}),a.formContainer.dom.submit(),t.tips(o.t("æ­£åœ¨ä¸Šä¼ é™„ä»¶...")),e.setLock({type:"form",state:"wait"},!0)},postResult:function(e){var t=this,i=t.base,a={type:"form",state:"wait"};if(t.data.set({status:"uploadParam",value:null}),tleGet(a),o=s.toArray(e.composeAttach);o=o.slice(o.length-n.length),$.Array.each(n,(function(e,i){$.Array.each(o,(function(e,t){if(t&&(t.name==i.name||t.name==i.path))return i.sid=t.id,i.size=i.bytesLoaded=t.size,o[e]=null,$.BREAK})),t.setState(i,"success")})),i.runSequence("postResult")}else t.error(null,e.code,e.overflowReason);i.tips("")},postAdd:function(){var e=this,t=e.sourceGet("element"),i=$.Element.create("input"),a=e.get({status:"inputIndex"});i.setClass("O0"),i.attr({type:"file",size:"1",name:"file"+a++}),e.set({status:"inputIndex",value:a}),i.listen("keydown",(function(e){$.Event.cancel(e)}));var n=!1,o=function(t){!0!==n&&(n=!0,e.postSelect(i)||i.remove(),e.postAdd(),$.Log.cache({compose_attach_postUpload_select:""}))};i.one("change",o),i.one("propertychange",o),t.formContainer.append(i.dom)},postSelect:function(e){var t=this,i=(t.element,e.dom.value);if(!i)return!1;var a=t.fileCreate({type:"form",path:i});return a.extLimit?($.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentUnsafe",title:o.t("æ‚¨æ‰€é€‰æ‹©çš„é™„ä»¶ï¼š")+'<span style="color:#f00">'+a.name+"</span>"+o.t(" ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè¯·å‹¿æ·»åŠ è¯¥ç±»é™„ä»¶ï¼")}),!1):a.pathExist?($.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentChosen",title:o.t("æ‚¨å·²é€‰æ‹©äº†æ­¤é™„ä»¶ï¼Œè¯·å‹¿é‡å¤æ·»åŠ ç›¸åŒé™„ä»¶ï¼")}),!1):(e.css({zIndex:-1}),a.delete=function(){e.remove(),a.delete=null},t.add(a),t.traceCheck(),!0)}})},16579:function(e,t,i){i.r(t),i(81898),i(803);var a=i(10487),n=i(62193),o=i(72957),r=new o.c1("module.compose.ComposeSchedule"),s=$.createClass((0,o.$N)("module.compose.ComposeSchedule")),c=$.Object;c.inherit(s,a.Z),c.extend(s.prototype,{initialize:function(e){c.extend(this,{component:{schedule:null},element:{area:null,year:null,month:null,day:null,hour:null,minute:null,focus:null,info:null},status:{fill:!1,date:null}}),s.superClass.initialize.call(this,e)},init:function(){s.superClass.init.call(this),this.render()},clear:function(){s.superClass.clear.call(this.element),s.superClass.clear.call(this)},render:function(){var e=this,t=e.module,i=e.data,a=e.element;a.area=i.get({element:"schedule"});var n=r.t("å‘é€æ—¶é—´ï¼š")+'<select id="'+t.createId("scheduleYear")+'"></select> '+r.t("å¹´")+' <select id="'+t.createId("scheduleMonth")+'"></select> '+r.t("æœˆ")+' <select id="'+t.createId("scheduleDay")+'"></select> '+r.t("æ—¥")+' <select id="'+t.createId("scheduleHour")+'"></select> '+r.t("æ—¶")+' <select id="'+t.createId("scheduleMinute")+'"></select> '+r.t("åˆ†")+' <p class="bB0">'+r.t("æœ¬é‚®ä»¶å°†åœ¨ ")+'<strong id="'+t.createId("scheduleInfo")+'"></strong>'+r.t(" å‘é€åˆ°å¯¹æ–¹é‚®ç®±")+'</p><a id="'+t.createId("scheduleFocus")+'" href="javascript:void(0)" hidefocus="hidefocus" style="text-decoration:none;display:none">ã€€</a>';a.area.html(n),new $.Link({cls:"nui-block-close nui-close",icon:"close",renderTo:a.area,click:function(){i.get({component:"schedule"}).setChecked(!1)}}),a.year=i.get({modduleId:"scheduleMonth"}),a.day=i.get({moduleId:"scheduleDay"}),a.hour=i.get({moduleId:"scheduleHour"}),a.minute=i.get({moduleId:"scheduleMinute"}),a.focus=i.get({moduleId:"scheduleFocus"}),a.info=i.get({moduleId:"scheduleInfo"});var o=function(t){e.setChange()};$.Array.each(["year","month","day","hour","minute"],(function(e,t){a[t].listen("change",o)}))},get:function(e){return"string"==typeof(e=e||{}).status?this.status[e.status]:this.get({status:"date"})},getWithTimeZoneFixed:function(){var e=this.get().getTime(),t=-(new Date).getTimezoneOffset();return new Date(e+60*(480-t)*1e3)},setWithTimeZoneFixed:function(e){var t=480- -(new Date).getTimezoneOffset();this.set({date:new Date(e-60*t*1e3)})},getDay:function(e){var t=0,i=(e=e||{}).year,a=e.month;if(e.date&&(i=e.date.getFullYear(),a=e.date.getMonth()+1),!i||!a)return t;if((i%4==0&&i%100!=0||i%400==0)&&2==a)t=29;else switch(a){case 1:case 3:case 5:case 7:case 8:case 10:case 12:t=31;break;case 2:t=28;break;case 4:case 6:case 9:case 11:t=30}return t},set:function(e){var t=this;(e=e||{}).date?(t.set({status:"date",value:e.date}),t.update({sync:!0})):"string"==typeof e.status?t.status[e.status]=e.value:(t.setDefault(e),t.toggle({open:!0}))},setChange:function(){var e=this,t=e.element,i=[];$.Array.each(["year","month","day","hour","minute"],(function(e,a){i.push(parseInt(t[a].dom.value,10))}));var a=e.getDay({year:i[0],month:i[1]});i[2]>a&&(i[2]=a),i[1]--;var n=new Date(i[0],i[1],i[2],i[3],i[4]);e.set({date:n})},setDefault:function(e){var t=n.Z.getTime(0);return this.fill({date:t}),e?t=e:(t.setDate(t.getDate()+1),t.setHours(0),t.setMinutes(0),t.setSeconds(0,0)),this.set({date:t}),t},verify:function(){return!(this.get()<=n.Z.getTime(0))||(new $.Msgbox({statsKey:"Compose_NoGuide_Popup_TimingSetError",content:r.t("å®šæ—¶å‘ä¿¡æ—¶é—´ä¸èƒ½æ¯”å½“å‰æ—¶é—´æ—©ï¼")}),!1)},toggle:function(e){e=e||{};var t=this,i=(t.module,t.element),a=t.data,n=a.get({status:"showSchedule"});if(e.open&&n)return!1;if(e.close&&!n)return!1;var o=a.get({component:"notary"});if(n)i.area.hide(),o&&o.setDisabled(!1);else{if(a.get({status:"useSms"}))return new $.Msgbox({statsKey:"Compose_NoGuide_Popup_TimingAndSms",title:r.t('æŠ±æ­‰ï¼Œ"å®šæ—¶å‘ä¿¡"åŠŸèƒ½æ— æ³•ä¸"çŸ­ä¿¡é€šçŸ¥"åŒæ—¶ä½¿ç”¨ã€‚')}),!1;if(a.get({status:"showEncrypt"}))return new $.Msgbox({statsKey:"Compose_NoGuide_Popup_TimingAndEncrypt",title:r.t('æŠ±æ­‰ï¼Œ"å®šæ—¶å‘ä¿¡"åŠŸèƒ½æ— æ³•ä¸"é‚®ä»¶åŠ å¯†"åŒæ—¶ä½¿ç”¨ã€‚')}),!1;t.get({status:"date"})||t.setDefault(),o&&o.setDisabled(!0),i.area.show(),i.focus.show();try{i.focus.dom.focus(),i.focus.dom.blur()}catch(e){}i.focus.hide()}return a.set({status:"showSchedule",value:!n}),!0},fill:function(e){e=e||{};var t=this;if(!t.get({status:"fill"})){for(var i=t.element,a=e.date.getFullYear(),n=a+5;a<n;a++)i.year.append(t.createOption({value:String(a)}));for(var o=1;o<=12;o++)i.month.append(t.createOption({value:String(o)}));for(var r=1;r<=31;r++)i.day.append(t.createOption({value:String(r)}));for(var s=0;s<24;s++)i.hour.append(t.createOption({value:String(s)}));for(var c=0;c<60;c++)i.minute.append(t.createOption({value:String(c)}));t.set({status:"fill",value:!0})}},update:function(e){e=e||{};var t=this,i=t.element,a=t.get({status:"date"});if(e.sync)$.Array.each(["year","month","day","hour","minute"],(function(e,n){var o,r=i[n];switch(e){case 0:o=a.getFullYear();try{var s=r.dom.options;o>parseInt(s[s.length-1].value,10)&&r.append(t.createOption({value:String(o)}))}catch(e){}break;ce();break;case 3:o=a.getHours();break;case 4:o=a.getMinutes();break;default:o=0}var c=String(o);r.dom.value!=c&&(r.dom.value=c),"month"===n&&t.update({day:!0})})),t.update({day:!0}),t.update({info:!0});else if(e.day){var o,s=i.day,c=t.getDay({date:a}),l=s.dom.options.length;if(c!=l)if(c>l)for(o=l+1;o<=c;o++)s.append(t.createOption({value:String(o)}));else for(o=l;o>c;o--)new $.Element(s.dom.options[o-1]).remove()}else if(e.info){var d="",u=a.getFullYear(),m=a.getMonth()+1,p=a.getDate(),f=a.getHours(),h=a.getMinutes(),g=n.Z.getTime(0);g.setHours(0,0,0,0);var v=g.getDay();0===v&&(v=7);var b=new Date(a.valueOf());b.setHours(0,0,0,0);var y=b.valueOf()-g.valueOf();switch(y/=86reak;case-1:d=r.t("æ˜¨å¤©");break;case 0:d=r.t("ä»Šå¤©");break;case 1:d=r.t("æ˜å¤©");break;case 2:d=r.t("åå¤©");break;default:var x=$.Date.getWeek(a);1-v<=y&&y<=7-v?d=r.t("æœ¬å‘¨")+x:7-v<y&&y<=14-v?d=r.t("ä¸‹å‘¨")+x:-7-v<y&&y<1-v?d=r.t("ä¸Šå‘¨")+x:(u!=g.getFullYear()&&(d=u+r.t("å¹´")),u==g.getFultMonth()?d+=r.t("æœ¬æœˆ"):d+=m+r.t("æœˆ"),d+=p+r.t("æ—¥å‘¨")+x)}f<6?d+=r.t("å‡Œæ™¨"):f<11||11==f&&h<30?d+=r.t("æ—©ä¸Š"):f<13||13==f&&h<30?d+=r.t("ä¸­åˆ"):f<18?d+=r.t("ä¸‹åˆ"):f<24&&(d+=r.t("æ™šä¸Š")),d+=f+" : ",h<10&&(d+="0"),d+=h,i.info.dom.innerHTML=d,$G.environment.isCh||(i.info.dom.innerHTML=[u,m,p].join("-")+" "+[f,h].join(":"))}},createOption:function(e){var t=(e=e||{}).value||"",i=e.text||t,a=document.createElement("option");return a.innerHTML=i,a.value=t,a}}),t.default=s},68216:function(e,t,i){i(81898),i(42295),i(34994),i(803),i(48868),i(92274),i(63045),i(81874),i(54861);var a=i(10487),n=i(62193),o=i(4982),r=i(72957),s=new r.c1("module.compose.ComposeSign"),c=$.Object,l=($.Function,$.Ud),d=$.Uri,u=$.Ext,m=$.createClass((0,r.$N)("module.compose.ComposeSign"));c.inherit(m,a.Z),c.extend(m.prototype,{initialize:function(e){c.extend(this,{signData:{text:null,card:null,graph:null,linkedin:null},fill:{text:-1,card:-1,graph:-1,linkedin:-1}}),m.superClass.initialize.call(this,e)},init:function(){m.superClass.init.call(this)},load:function(){var e=this,t=e.data;!0!==t.get({status:"initSign"})&&(t.set({status:"initSign",value:!0}),o.default.getSignList((function(t){var i;t&&(e.set({text:t}),e.selectDefault({text:!0})),i=e.getStationery(),(0,r.$S)("isFree")?e.getCardList((function(t){e.set({card:t}),i||e.selectDefault({card:!0})})):(0,r.$S)("isVip")&&e.getGraphList((function(t){e.set({graph:t}),i||e.selectDefault({graph:!0})})),u.linkedin&&(0,r.$E)("product.Linkedin",(function(t){t.getSign((function(t){t&&(t.id=1,e.set({linkedin:[t]}),e.selectDefault({linkedin:!0}))}))}))})))},set:function(e){var t=this.signData;e.text?t.text=e.text:e.card?t.card=e.card:e.graph?t.graph=e.graph:e.linkedin&&(t.linkedin=e.linkedin)},get:function(e){var t=this.signData;return e.text?t.text:e.card?t.card:e.graph?t.graph:e.linkedin?t.linkedin:void 0},getItem:function(e){var t=null;return e.call=function(i,a){if(e.default&&(a.isDefault||a.defaultCard)||e.index==i||e.id==a.id)return t=a,$.BREAK},this.each(e),t},getStationery:function(){var e=this;return e.base,e.data,e.form,!1},getCardList:function(e){var t=this.base,i=l.get({field:"ntes_compose",flag:"card"});if("1"==i||"2"==i){var a=t.getCallName((function(t){"success"==t.result&&e(t.msg)}),!0),n=$.String.uriAddParam(d.getUrl("compose_ecard",!0),"callback=window."+a);return $.Ajax.request({url:n,requestType:$.Ajax.SCRIPT}),!0}return!1},getGraphList:function(e){var t=this.base.getCallName((function(t){t&&t.length&&e(t)}),!0),i=$.String.uriAddParam(d.getUrl("compose_graphsign"),"func=window."+t);$.Ajax.request({url:i,charset:"gbk",requestType:$.Ajax.SCRIPT})},each:function(e){var t=this.get(e);t&&$.Array.each(t,e.call)},select:function(e){var t=this,i=t.base,a=t.data,n=t.getItem(e);if(n){var o=a.get({status:"useSign"})||{};if(e.text){o.text=n;var r=n.content;!n.isHtml&&r&&(r=$.String.escapeHTML(n.content)),t.fillText(r)}else e.card?(o.card==n||(o.card=n,t.attach.cardSync(n)),t.fillCard(n.html)):e.graph?(o.graph=n,t.fillGraph(n.str)):e.linkedin&&(o.text=n,r=n.content,t.fillText(r));return e.default&&(o.default=n,i.changeSync()),a.set({status:"useSign",value:o}),!0}return!1},selectDefault:function(e){var t=this,i=t.form,a=t.data,n=t.editor;if(!i.getCheckbox("text")){var o=a.get({status:"fromEntry"});if("compose"==o);else if("reply"==o||"forward"==o){if("reply"==o&&"1"==l.get({field:"ntes_option",flag:"replySign"}))return;if("forward"==o&&"0"==l.get({field:"ntes_option",flag:"forwardSign"}))return}else{if("timeset"!=o)return;if(t.fillHas())return;if(e.card&&t.attach.cardHas())return}if(!a.get({status:"useSign"})){var r=t.fillData(e);if(-1!=r?e.id=r:e.default=!0,t.select(e),"compose"==a.get({status:"fromEntry"})){var s=n.get();a.set({status:"defaultContent",value:s})}}}},fillHas:function(e){var t=this,i=t.editor,a=!1;if(e){var n="";if(e.text?n="spnEditorSign":e.card?n="divEditorGraphSign":e.graph&&(n="divNeteaseMailCard"),n)try{var o=i.get({id:n});o&&o.dom.innerHTML&&(a=!0)}catch(e){}}else(t.fillHas({text:!0})||t.fillHas({card:!0})||t.fillHas({graph:!0}))&&(a=!0);return a},fillData:function(e){var t=this.fill;if("boolean"==typeof e.text&&e.text)return t.text;if("number"==typeof e.text)this.fill.text=e.text;else{if("boolean"==typeof e.card&&e.card)return t.card;if("number"==typeof e.card)t.card=e.card;else{if("boolean"==typeof e.graph&&e.graph)return t.graph;if("number"==typeof e.graph)t.graph=e.graph;else{if("boolean"==typeof e.linkedin&&e.linkedin)return t.linkedin;"number"==typeof e.linkedin&&(t.linkedin=e.linkedin)}}}},fillText:function(e){var t=this.editor;if(e==$.String.stripTags(e)&&(e=(e=e.replace(/ /g,"&nbsp;")).replace(/\n/g,t.getBreakLine(1))),-1!=e.indexOf("$date$")){var i=n.Z.getTime(!0),a=$.Date.format(i,s.t("yyyyå¹´Mæœˆdæ—¥"));e=e.replace(/\$date\$/g,a)}e="<p style='margin: 0'>--</p>"+e+'<div style="clear:both"></div>';var o=t.get({html:!0});if(-1!=o.indexOf("spnEditorSign"))try{var r=t.get({id:"spnEditorSign"});r&&r.html(e)}catch(e){}else o=[o,t.getBreakLine(5),'<div id="spnEditorSign" style="position:relative;zoom:1">',e,"</div>"].join(""),t.set(o)},fillCard:function(e){var t=this.editor,i=t.get({html:!0});if(-1!=i.indexOf("divNeteaseMailCard"))try{var a=t.get({id:"divNeteaseMailCard"});a&&a.html(e)}catch(e){}else i=[i,t.getBreakLine(5),'<div id="divNeteaseMailCard">',e,"</div>"].join(""),t.set(i)},fillGraph:function(e){var t=this.editor,i=t.get({html:!0});if(-1!=i.indexOf("divEditorGraphSign"))try{var a=t.get({id:"divEditorGraphSign"});a&&a.html(e)}catch(e){}else i=[i,t.getBreakLine(5),'<div id="divEditorGraphSign">',e,"</div>"].join(""),t.set(i)},fillLetterAngle:function(e,t){var i=this.editor;if(-1!=(n=i.get({html:!0})).indexOf("dvLetterAngle"))try{var a=i.get({id:"dvLetterAngle"});a&&a.html(e)}catch(e){}else{var n=i.get({html:!0}),o='<div id="dvLetterAngle">'+e+"</div>",r='<div id="spnEditorSign" style="position:relative;zoom:1"></div>';n=(0===t?[n,i.getBreakLine(5),o,r]:[n,i.getBreakLine(5),r,o]).join(""),i.set(n)}},showCustom:function(){var e=this;Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(t){t.default.showSignList((function(t){t&&e.fillText(t)}))})))}}),t.Z=m},52077:function(e,t,i){i(81898),i(68233),i(66403),i(15761),i(20869),i(42295),i(63518),i(75654),i(26340),i(86305),i(34994),i(803),i(37092),i(92274);var a=i(10487),n=i(72957),o=new n.c1("module.compose.ComposeStationery"),r=$.Object,s=$.Uri,c=$.Log,l=$.createClass((0,n.$N)("module.compose.ComposeStationery"));r.inherit(l,a.Z),r.extend(l,{pageLimit:12,pageLimit2:4}),r.extend(l.prototype,{initialize:function(e){r.extend(this,{component:{category:null},element:{content:null,btn:null,list:null,page:null}}),l.superClass.initialize.call(this,e)},init:function(){this.element,l.superClass.init.call(this)},clear:function(){l.superClass.clear.call(this.element),l.superClass.clear.call(this)},load:function(){var e=this,t=e.data,i=t.letterpaper,a=e.element;if(e.component,!0===t.get({status:"initStationery"}))return!0;if(!i.category){var n=arguments.callee,o=s.getUrl("letterpaper_get")+"&pageSize=11";return $.Ajax.jsonp(o,(function(t){i.category=t.category,"string"!=typeof i.curId&&(i.curId=""),i.curCategory=t.curCategory,i.curPage=t.curPage,i.curData=t.letterPaper,i.nonUse=t.Size=t.pageSize,n.call(e)}),"jsonp"),!1}a.content=t.get({moduleId:"paperContent"}),a.btn=t.get({moduleId:"paperBtn"}),a.list=t.get({moduleId:"paperList"}),a.page=t.get({moduleId:"paperPage"}),e.fill(),t.set({status:"initStationery",value:!0})},preLoad:function(e){var t=this,i=t.data,a=i.letterpaper;if(t.element,t.component,!a.category){var n=s.getUrl("letterpaper_get")+"&categoryValue=&pageSize=11";return $.Ajax.jsonp(n,(function(t){a.category=t.category,"string"!=typeof a.curId&&(a.curId=""),a.curCategory=t.curCategory,a.curPage=t.curPage,a.curData=t.letterPaper,a.nonUse=t.nonUse,a.ver=t.date,a.pageSize=t.pageSize,e()}),"jsonp"),!1}i.set({status:"initStationery",value:!0})},getObj:function(){return this.data.letterpaper},getVer:function(){return this.getObj().ver||""},getNon:function(){return this.getObj().nonUse},getPageSize:function(){return this.getObj().pageSize},getCategory:function(e){if(void 0===e)return this.getObj().category;var t=null,i=this.getCategory();return i&&$.Array.each(i,(function(i,a){if(a.id==e)return t=a,$.BREAK})),t},getItem:function(e){var t=null;if("0"==e)t=this.getNon();else{var i=this.getCurList();$.Array.each(i,(function(i,a){if(a.id==e)return t=a,$.BREAK}))}return t},getContent:function(){var e=this,t=e.getCurId(),i=[],a=[e.getNon()].concat(e.getCurList());return $.Array.each(a,(function(e,a){var n={id:a.id,title:a.name||"",src:a.wmIconUrl||a.iconUrl,active:!1};"0"==a.id&&""===t&&(n.active=!0),a.id==t&&(n.active=!0),i.push(n)})),i},getCurId:function(){return this.getObj().curId||""},getCurList:function(){return this.getObj().curData},getCurCategory:function(){return this.getObj().curCategory},getCurPage:function(){return this.getObj().curPage},getCurPageCount:function(){return this.getCurCategory().pageCount},setObj:function(e){var t=this.getObj();t.curCategory=e.curCategory,t.curPage=e.curPage,t.curData=e.letterPaper},setCurId:function(e){var t=this,i=(t.element,t.data),a=t.getObj(),n=t.getVer();a.curId=e,n&&(i.log.letterId=n+"_"+e)},setCurCategory:function(e){var t=this,i=(t.data,t.getObj()),a=(t.element,t.component),n=t.getCategory(e);i.curCategory=n,a.category.setText(n.name),t.setCurPage(1),c.cache({cl_stationery_category:e},$.EMPTYFUNC)},setCurPage:function(e){var t=this,i=s.getUrl("letterpaper_get");i+="&categoryValue="+t.getCurCategory().id,i+="&nextPage="+e,i+="&pageSize="+t.getPageSize(),$.Ajax.jsonp(i,(function(e){t.setObj(e),t.render()}),"jsonp")},page:function(e){var t=this,i=e.index,a=t.getCur n=t.getCurPageCount();e.prev?(i=a-1)<1&&(i=n):(i=a+1)>n&&(i=1)}t.setCurPage(i),c.cache({cl_stationery_page:""+i},$.EMPTYFUNC)},select:function(e){var t=this,i=t.editor,a=null,o=null;e.item?(o=e.item,a=o.id):e.id&&(a=e.id,o=t.getItem(a));var r=t.getCurId();if(a==r)return!1;var s="";try{s=i.get({html:!0})}catch(e){n.$D.log("get editor error")}var c="",l=new RegExp("<STATIONERY>","i"),d="<br><br><br><br><br><br><br><br><br><br>";if(""===r&&l.test(s)&&(r="draft"),""===r||"0"==r){c=s;var u=!1;try{var m=i.get({id:"spnEditorSign"});m&&m.innerHTML&&(u=!0)}catch(e){n.$D.log("get editor sign error")}u||(c+=d)}else{var p=s.split(l);p&&p.length&&p[1]&&(c=p[1],"0"==a&&(c=c.replace(new RegExp(d,"i"),""))),"undefined"!=c&&c||(c=s)}function f(n){if(o.html){var r=o.html;n&&(r=r.replace(o.imageUrl,n));var l=r.split("<STATIONERY><STATIONERY>"),d=l[0]+"<STATIONERY>",u="<STATIONERY>"+l[1];s=[d,"<div>",c,"</div>",u].join("")}else s="<div>"+c+"</div>";i.set({html:s});var m=i.get({tag:"STATIONERY"});m?i.focus({element:m}):i.focus(),t.setCurId(a),"function"==typeof e.callback&&e.callback()}return"custom"==o.imageType?t.attach.stationerySync(o,(function(e){e&&f(e)})):(t.attach.stationeryClear(),f()),!0},fill:function(){var e=this,t=e.module,i=(e.data,t.createId("paperBtn")),a=[],n=e.getCategory();$.Array.each(n,(function(t,i){var n={text:i.name,click:function(){i.id!=e.getCurCategory().id&&e.setCurCategory(i.id)}};a.push(n)}));var r={renderTo:i,delegateTo:"self",text:o.t("å…¨éƒ¨"),subclass:"dropdownBtn",menu:{xtype:"menu",groups:[{items:a}]}};e.component.category=new $.Button(r),e.render()},render:function(){var e=this,t=e.element,i=e.getContent();t.list.empty();var a="N0";$.Array.each(i,(function(i,n){var o=$.Element.create("LI");o.addClass("dm0");var r=$.Element.create("A");r.addClass("bP0"),r.dom.title=n.title,r.dom.href="javascript:void(0)";var s=$.Element.create("IMG");s.addClass("bR0"),s.dom.src=n.src;var l=$.Element.create("SPAN");l.addClass("bA0"),r.append(s.dom),r.append(l.dom),o.append(r.dom),n.active&&o.addClass(a),r.listen("click",(function(i){e.select({id:n.id,click:!0});var o=t.list.find("."+a);o&&o.removeClass(a),$(this).addClass("N0"),c.cache({cl_stationery_paper:n.id},$.EMPTYFUNC)})),t.list.append(o.dom)})),t.page.empty();var n=e.getCurPageCount(),r=e.getCurPage();if(n>1){var s=$.Element.create("A");s.dom.href="javascript:void(0)",s.dom.innerHTML=o.t("ä¸Šé¡µ"),s.listen("click",(function(t){e.page({click:!0,prev:!0})})),t.page.append(s.dom)}for(var l=[],d=1;d<=n;d++){var u={text:d+"/"+n,value:d};d==r&&(u.checked=!0),l.push(u)}var m={options:l,subclass:"simpleSelect",delegateTo:"self",renderTo:t.page.dom,selectedchange:function(t){var i={click:!0,index:this.value};e.page(i)}};if(e.component.select=new $.Select(m),n>1){var p=$.Element.create("A");p.dom.href="javascript:void(0)",p.dom.innerHTML=o.t("ä¸‹é¡µ"),p.listen("click",(function(t){e.page({click:!0,next:!0})})),t.page.append(p.dom)}}}),t.Z=l},72051:function(e,t,i){i(55737),i(803),i(80153),i(48868),i(92274),i(63045),i(81874),i(54861),i(42295),i(34994),i(66403),i(32021),i(52963),i(49750),i(75654),i(66251);var a=i(10487),n=i(27018),o=i(54107),r=i(1124),s=i(74718),c=i(88829),l=i(15372),d=i(81229),u=i(64560),m=i(62193),p=i(42366),f=i(72957),h=new f.c1("module.compose.ComposeSuccess"),g=$.Object,v=($.Function,$.EMAIL_ID),b=$.EMAIL_PHONE,y=$.Ext,x=$.Log,k=$.S_OK,S=$.Ud,w=$.Uri,T=$.createClass((0,f.$N)("module.compose.ComposeSuccess")),C={initialize:function(e){g.extend(this,{saveContact:{}}),T.superClass.initialize.call(this,e)},init:function(){T.superClass.init.call(this)},render:function(e,t){var i=this,a=i.base,n=i.module;n.removeChildMod=!0,n._child=null,n.cacheModule=!1,n.cacheByVar=!0;try{i.fillAll(e,t)}catch(e){}if(i.sync(),$.Context.module==n&&$.Frame.setViewType("normal"),a.setPage("success"),i.showJust(),(0,f.$S)("isVip")&&i.vipSms(),y.smspack)try{i.smsCharge()}catch(e){}},sync:function(){var e=this,t=(e.base,e.data),i=t.get({component:"sendMsgBox"});if(i)try{i.close(),t.set({component:"sendMsgBox",value:null})}catch(e){}e.setMboxFlag(),$.Tips.show({hidden:!0})},fillAll:function(e,t){var i,a=this,n=a.data,o=a.module,r=o.mailprotection;if(document.body.clientWidth>1440&&n.get({moduleId:"succMain"}).addClass("lc3"),a.fillTop(e),n.get({status:"sendParam"}).mailTrace){var s=(i=e.savedSent)?i.mid:"",c=i?i.msid:"";a.fillMailTrace(e.sentTInfo,s,c)}r.isEnabled()&&(s=(i=e.savedSent)?i.mid:"",c=i?i.msid:"",a.fillMailProtection(e.sentTInfo,s,c));if(a.fillTips(e),a.fillContact(e),n.get({status:"sendParam"}),a.fillAd(),o.notary){var l=n.get({status:"showNotary"}),d=o.notary.userpro,u=o.notary.singleBlance,m=o.notary.isAutoArchive;l&&!m&&(d?a.manualNotaryUsed(o_send"})&&a.fillCancel(e),a.save2YNote(e)},fillTop:function(e){var t=this,i=t.module,a=(t.base,t.data),n=t.info,s=a.get({status:"sendParam"}),l=h.t("é‚®ä»¶å‘é€æˆåŠŸ");"schedule"==s.action&&(l=h.t("å®šæ—¶å‘ä¿¡è®¾ç½®æˆåŠŸ"));var d='\n\t\t<svg id="sucAnimIcon" class="suc-anim-icon has-anim" xmlns="http://www.w3.org/2000/svg" t\t<circle class="suc-anim-icon_stroke" cx="40" cy="40" r="21" fill="none" />\n\t\t\t<path class="suc-anim-icon_tick" fill-rule="evenodd" clip-rule="evenodd" d="M49.0411 35.9823C49.7233 35.3 49.7233 34.1939 49.0411 33.5117C48.3589 32.8294 47.2527 32.8294 46.5705 33.5117L37.4603 42.6219L32.9823 38.1439C32.3 37.4617 31.1939 37.4617 30.5117 38.1439C29.8294 38.8261 29.8294 39.9322 30.5117 40.6145L36.2119 46.3147C36.2162 46.3191 36.2205 46.3235 36.2249 46.3279C36.9072 47.0101 38.0133 47.0101 38.6955 46.3279L49.0411 35.9823Z" fill="white"/>\n\t\t</svg>\n\t';$.Browser.isIE()&&(d='<b class="nui-ico se0 nui-ico-suc-l"></b>'),setTimeout((function(){$.fly("#sucAnimIcon")&&$.fly("#sucAnimIcon").addClass("had-finish-anim").removeClass("has-anim")}),1500);var u=d+l;a.get({moduleId:"succInfo"}).html(u);var m=a.get({moduleId:"succOperate"}),p=[],f=n.get({mid:!0});if(f){var g=new $.Link({tabindex:"1",cls:"je1 nui-txt-link",text:h.t("è¿”å›è¯¥é‚®ä»¶"),click:function(){x.cache({sl_back:"1"},$.EMPTYFUNC),$.MultiTab.removeTab((function(){i.extend.history?c.default.entry(i.extend.history):c.default.entry({id:f,from:"compose"}),t.exit()}))}});p.push(g)}else g=new $.Link({tabindex:"1",cls:"je1 nui-txt-link",text:h.t("è¿”å›æ”¶ä»¶ç®±"),click:function(){x.cache({sl_inbox:"1"},$.EMPTYFUNC),$.MultiTab.removeTab((function(){r.default.entry({fid:1}),t.exit()}))}}),p.push(g);"deliver"==s.action&&n.get({obj:!0}).saveSentCopy&&(e.saveSentFailed||e.saveSentIgnored||(t.sentLink=new $.Link({tabindex:"1",cls:"je1 nui-txt-link",text:h.t("æŸ¥çœ‹å·²å‘é‚®ä»¶"),click:function(){x.cache({sl_view:"1"},$.EMPTYFUNC),$.MultiTab.removeTab((function(){a.get({status:"saveSentAndDel"})?r.default.entry({fid:3}):c.default.entry({id:e.savedSent.msid?[e.savedSent.msid,e.savedSent.mid].join(":"):e.savedSent.mid}),t.exit()}))}}),p.push(t.sentLink)));var v=new $.Link({tabinde"ç»§ç»­å†™ä¿¡"),click:function(){x.cache({sl_continue:"1"},$.EMPTYFUNC),$.MultiTab.removeTab((function(){t.exit(),o.default.compose()}))}});p.push(v);var b=p.map((function(e){return e.html()})).join('<span class="hs1">|</span>');$(m).html(b);var y="";if(a.get({status:"vipMember"})){var k=t.getRandomSpeed();y='<div style="color:#C69431;font-size:14px;text-align:center;padding-top:30px;">('+h.t("å·²ä¸ºé‚®ç®±ä¼šå‘˜åŠ é€Ÿï¼Œå‘ä¿¡ä»…ç”¨")+" "+k.time+" "+h.t("ç§’ï¼Œæ‰“è´¥")+" "+k.percent+"% "+h.t("çš„ç”¨æˆ·")+")</div>"}setTimeout((function(){$(m).append(y)}),0)},fillTips:function(e){var t=this,a=t.data,n=t.info,o=t.module.schedule,c="",l=a.get({status:"sendParam"}),d=n.get({obj:!0}),u=a.get({moduleId:"succTips"}),m=null,p=[],g=null;if("schedule"==l.action)m=[{html:"<span>"+(b=h.t("é‚®ä»¶å°†åœ¨")+$.Date.format(o.get(),h.t("yyyyå¹´Mæœˆdæ—¥ H:mm"))+h.t("å‘é€ï¼Œé‚®ä»¶å‘é€å‰ï¼Œæš‚æ—¶ä¿å­˜åœ¨"))+"</span>"},{xtype:"link",text:h.t("è‰ç¨¿ç®±"),click:function(){x.cache({sl_draft:"1"},$.EMPTYFUNC),r.default.entry({fid:2})}}];else if("deliver"==l.action){if(d.saveSentCopy){if(e.saveSentFailed);else if(e.saveSentIgnored){var v=new $.Link({text:h.t("å¼€é€šä¼šå‘˜ï¼Œäº«å—è¶…å¤§å­˜å‚¨ç©ºé—´"),cls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showDialog("plus","","mailbox_capacity1")}))),$.Log.cache({ComposeSuccessCapacity1TipsClick:1})}}),b="<span>"+h.t("å› ä¸ºé‚®ç®±å®¹é‡å·²æ»¡ï¼Œæœªèƒ½ä¿å­˜åˆ°â€œå·²å‘é€â€æ–‡ä»¶å¤¹ ")+v.html().replace("<a",'<a style="text-decoration:none;" ')+"</span>",y="<span>"+h.t("å› ä¸ºé‚®ç®±å®¹é‡å·²æ»¡ï¼Œæœªèƒ½ä¿å­˜åˆ°â€œå·²å‘é€â€æ–‡ä»¶å¤¹ ")+"</span>";if(c="Compose_Premium_Text_StorageFull",(a.get({status:"vipMember"})||(0,f.$S)("isVip"))&&(b="<span>"+h.t("å› ä¸ºé‚®ç®±å®¹é‡å·²æ»¡ï¼Œæœªèƒ½ä¿å­˜åˆ°â€œå·²å‘é€â€æ–‡ä»¶å¤¹ï¼Œè¯·åŠæ—¶æ¸…ç†é‚®ç®±")+"</span>"),(0,f.$S)("isVip")){var S=!1,w=(0,f.$S)("attrs").subcos.split(",");(0,f.$S)("isvip")?$.Array.has(w,"90")&&(S=!0):(0,f.$S)("is188")?$.Array.has(w,"35")&&(S=!0):(0,f.$S)("is126vip")&&$.Array.has(w,"29")&&(S=!0);var T={xtype:"link",text:h.t("å‡çº§å®¹é‡"),click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"option_viptype"})})))}},C={xtype:"link",text:h.t("æ¸…ç†é‚®ä»¶"),click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"optimizer_full"})})))}};m=[{html:y},{html:"<span>"upport.isTeamMailFromSwitch()||m.push(C),m.push(C)):(m.push(T),m.push({html:"<span>"+h.t(" æˆ–è€… ")+"</span>"}),$.Support.isTeamMailFromSwitch()||m.push(C))}else m=[{html:b}];$.Log.cache({ComposeCapacityOverflowOnDeliver:1})}else if(e.saveSentId&&0===(0,f.$S)("attrs").user.save_sent)if(e.savedSent){var _=$.Icon.html({type:"alert",extcls:"er3"});c="Compose_Guide_Text_AttachmentUnsaveLimit",m=[{html:b="<span>"+_+h.t("æœ¬é‚®ä»¶å¤§å°è¶…è¿‡1MBï¼Œé™„ä»¶æœªä¿å­˜åˆ°â€œå·²å‘é€â€ ")+"</span>"},{xtype:"link",cls:"jF2 nui-txt-link",text:h.t("æ›´æ”¹ä¿å­˜æ¨¡å¼"),click:function(){x.cache({b_composeSuccess_setSave_click:"1"},$.EMPTYFUNC),s.default.entry({module:"BaseSetModule",inputName:"afterSendRule"})}},{xtype:"link",cls:"iA1 nui-txt-link",text:h.t("ä¿å­˜è¯¥é‚®ä»¶"),click:function(){x.cache({sl_save:"1"},$.EMPTYFUNC);var i={saveMid:e.saveSentId,delMid:e.savedSent.msid?[e.savedSent.msid,e.savedSent.mid].join(":"):e.savedSent.mid,callback:function(e){if(e.code==k){g.hide();var n={statsKey:"Compose_NoGuide_Text_AttachmentSaveSuccess",extcls:"sZ1",subclass:"assistBlock",params:"hasClose",content:h.t("ä¿å­˜æˆåŠŸï¼åŒæ—¶å·²ä¸ºä½ è®¾ç½®å‘ä¿¡åé‚®ä»¶å…¨éƒ¨è‡ªåŠ¨ä¿å­˜ã€‚")},o=new $.Block(n);g.el.after(o.html()),t.setSaveSend(),a.set({status:"saveSentAndDel",value:!0})}else if(e.code===$.S_PARTIAL_OK&&e.var[0].code===$.S_OK&&0===e.var[1].code.indexOf("FA_HOOK_SECURITY")){var r=e.var[1].code.replace("FA_HOOK_SECURITY_","");$.Support.securityCtrl({func:"mbox:deleteMessages",level:r},(function(){t.action.saveSentAndDel(i)}))}else{var s,c="";switch(e.var[0].code){case"Fªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼"),c="Compose_NoGuide_Popup_MailUnsaveErrorTime";break;case"FA_INVALID_PARAMETER":s=h.t("æ ¼å¼é”™è¯¯ï¼Œç³»ç»Ÿæœªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼"),c="Compose_NoGuide_Popup_MailUnsaveErrorType";break;default:s=h.t("å¼‚å¸¸é”™è¯¯ï¼Œç³»ç»Ÿæœªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼"),c="Compose_NoGuide_Popup_MailUnsaveError"}$.Msgbox.show({statsKey:c,title:s})}}};t.action.saveSentAndDel(i)}}]}else m=[{html:b="<span>"+h.t("é‚®ä»¶å¤§å°è¶…è¿‡äº† ")+"<b>1MB</b>"+h.t("ï¼Œæ²¡æœ‰ä¿å­˜åˆ°â€œå·²å‘é€â€ï¼Œ")+"</span>"},{xtype:"link",text:h.t("ä¿å­˜è¯¥é‚®ä»¶"),click:function(){x.cache({sl_save:"1"},$.EMPTYFUNC),t.action.saveSent({mid:e.saveSentId,callback:function(e){if(e.code==k){var i="<span>"+h.t("ä¿å­˜æˆåŠŸï¼")+'<span class="nui-txt-tips">'+h.t("æ‚¨å¯ä»¥è®¾ç½®è‡ªåŠ¨ä¿å­˜ä»¥åæ‰€æœ‰å·²å‘é€é‚®ä»¶")+"</span> </span>",a={renderTo:u,extcls:"sZ1",subclass:"assistBlock",params:"hasClose",items:[{html:i},{xtype:"link",text:h.t("è‡ªåŠ¨ä¿å­˜"),bracket:!0,click:function(){x.cache({sl_setsave:"2"},$.EMPTYFUNC),t.setSaveSend(this)}}]};new $.Block(a)}else{var n;switch(e.code){case"FA_MAIL_NOT_FOUND":n=h.t("ç¡®è®¤è¶…æ—¶ï¼Œç³»ç»Ÿæœªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼");break;case"FA_INVALID_PARAMETER":n=h.t("æ ¼å¼é”™è¯¯ï¼Œç³»ç»Ÿæœªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼");break;default:n=h.t("å¼‚å¸¸é”™è¯¯ï¼Œç³»ç»Ÿæœªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼")}$.Msgbox.show({title:n})}}})}}]}else m=[{html:b="<span>"+h.t("é‚®ä»¶æœªä¿å­˜")+"&nbsp;</span>"},{xtype:"link",extcls:"nui-txt-link",text:h.t("è®¾ç½®è‡ªåŠ¨ä¿å­˜"),click:function(){x.cache({sl_setsave:"1"},$.EMPTYFUNC),s.default.entry({module:"BaseSetModule",inputName:"afterSendRule"})}}];if(a.get({status:"showEncrypt"})){var I=t.module.encrypt,A={html:b="<span>&nbsp;"+h.t("é‚®ä»¶å·²åŠ å¯†ï¼Œå¯†ç ä¸ºï¼š")+'<strong class="nui-txt-impt">'+$.String.escapeHTML(I.get())+"</strong></span>"};p?p.push(A):p=[A]}}var M=[];return m&&m.length&&M.push(m),p&&p.length&&M.push(p),M.length&&($.Array.each(M,(function(e,t){var i={statsKey:c,renderTo:u,extcls:"sZ1 "+(e>0?"BA0":""),subclass:"assistBlock",params:"hasClose",items:t},a=new $.Block(i);0===e&&(g=a)})),u.show()),!!M.length},fillStamp:function(e){var t=this.data,i=this.info;if("deliver"==t.get({status:"sendParam"}).action&&y.stamp){var a=t.get({moduleId:"succStamp"}),n="";$.Array.each(i.get({con:!0}),(function(e,t){var i=t.replace(/^.*<|>$/g,"").toLowerCase(),a=i.split("@")[1];if("163.com"==a||"126.com"==a)return n=i,$.BREAK}));var o=w.getUrl("compose_stamp_get");o+="&mid="+(new Date).valueOf(),n&&(o+="&to="+n);var r=i.get({obj:!0});o+="&subject="+encodeURIComponent(r.subject);var s=$.Element.create("iframe");s.setClass("qg1"),s.attr({frameBorder:0,allowTransparency:!0,tabIndex:"-1",src:o}),a.append(s.dom),a.show()}},fillContact:function(e){var t=this,i=t.data,a=t.info;if("deliver"==i.get({status:"sendParam"}).action){if(e.pabResult){try{n.default.addExtContact(e.pabResult)}catch(e){}try{$.Array.each(e.pabResult,(function(e,i){"added"==i.action&&(t.saveContact[i.item["EMAIL;PREF"].toLowerCase()]=i.item)}))}catch(e){}}var o=$.Element.create("DIV");o.setClass("fI1");var r=new $.Link({cls:"cZ1 nui-txt-link",renderTo:o,tabindex:"1",click:function(){x.cache({sl_contact:"0"},$.EMPTYFUNC),"none"==s.dom.style.display?(this.getEl().addClass("cA1"),s.show(),t.click2Hide||(t.click2Hide=I,$(document).listen("click",t.click2Hide),$(window).listen("blur",t.click2Hide))):(this.getEl().removeClass("cA1"),s.hide())}}),s=$.Element.create("DIV");s.setClass("cY1"),s.css({display:"none"});var c={},l=0,d=a.get({con:!0});$.Array.each(d,(function(e,i){if(!i)return $.CONTINUE;var a=w.matchEmail(i);if(!a)return $.CONTINUE;if(a.key=a.address.toLowerCase(),!c[a.key]){if(c[a.key]=a,a.added=t.saveContact[a.key],a.exist=n.default.data.extDataMap.email[a.key],a.id="",a.phone="",a.added){var o=a.added;a.id=o.id}else a.exist?(o=a.exist[0],a.id=o[v],a.name=n.default.getGivenName(o),a.phone=o[b]||"",a.groups=o.groups||[]):l++;a.name==a.address&&(a.name=a.name.split("@")[0]);var d=$.Element.create("DIV");d.setClass("bC1");var u=$.Element.create("SPAN");u.setClass("U1"),u.html(_(a)),d.append(u.dom),s.append(d.dom);var m=null;m=new $.Link({renderTo:d,cls:"T1 nui-txt-link",text:a.added||a.exist?h.t("ç¼–è¾‘"):h.t("æ·»åŠ "),click:function(){a.added||a.exist?(x.cache({sl_tactDialog({type:"modify",addr:{id:a.id},callback:function(e){u.html(_(e))}})):(x.cache({sl_add:"1"},$.EMPTYFUNC),n.default.contactDialog({type:"add",addr:{name:a.name,email:a.address},callback:function(e){a.id=e.id,a.added=e,u.html(_(e)),m.update({text:'<b class="nui-ico se0 px1"></b>'+h.t("ç¼–è¾‘")});var i='<b class="nui-ico se0 qm1"></b>';t.newCount--,t.newCount>0?(i+=t.newCount+h.t("ä¸ªæ”¶ä»¶äººä¸åœ¨é€šè®¯å½•ä¸­"),t.linkRev=r):i+=h.t("å·²æˆåŠŸå‘é€åˆ°æ”¶ä»¶äºº(")+t.allCount+")",r.update({text:i})}}))}}),d.listen("mouseover",(function(){d.addClass("dF1")})),d.listen("mouseout",(function(){d.removeClass("dF1")}))}}));var u='<b class="nui-ico se0 nui-icon-arr-d"></b>',m=g.count(c);l?(u+=l+h.t("ä¸ªæ”¶ä»¶äººä¸åœ¨é€šè®¯å½•ä¸­"),t.newCount=l,t.allCount=m,t.linkRev=r):u+=h.t("å·²æˆåŠŸå‘é€åˆ°æ”¶ä»¶äºº(")+m+")",r.update({text:u});var p=$.Element.create("DIV");p.setClass("br1");var y="",k="0",S="";1==(0,f.$S)("attrs").user.aftersend_saveaddr?(S=h.t("å·²è‡ªåŠ¨æ·»åŠ åˆ°é€šè®¯å½•"),y=h.t("å–æ¶ˆè‡ªåŠ¨æ·»åŠ ")):(S=h.t("å°šæœªè®¾ç½®è‡ªåŠ¨æ·»åŠ æ”¶ä»¶äººåˆ°é€šè®¯å½•"),y=h.t("è®¾ç½®è‡ªåŠ¨æ·»åŠ "),k="1"),new $.Link({id:"compose_success_saveaddr",cls:"T1 nui-txt-link",renderTo:p,text:y,click:function(){x.cache({sl_setaddress:k},$.EMPTYFUNC),t.setSaveAddress(this)}}),(0,f.$S)("isFree")&&$G.environment.isCh&&g.count(c)>=3&&new $.Link({renderTo:p,text:h.t("åŠ å…¥é‚®ä»¶åˆ—è¡¨"),cls:"T1 nui-txt-link",click:function(){x.cache({sl_list:"1"},$.EMPTYFUNC),t.setMailList(c)}});var T=$.Element.create("SPAN");T.html(S),p.append(T.dom),s.append(p.dom),o.append(s.dom);var C=i.get({moduleId:"succOperate"});C.append('<span class="hs1">|</span>'),C.append(o.dom)}function _(e){var t=e.name?'"'+e.name+'"<'+e.address+">":e.address;return $.String.escapeHTML(t)}function I(e){var t=$.Event.getTarget(e);try{$.Element.inside(t,s.dom)||$.Element.inside(t,r.getEl().dom)||(s.hide(),r.getEl().removeClass("lO1"))}catch(e){}}},fillAdTips:function(){if((0,f.$S)("isFree")&&"ud"!=(0,f.$S)("ad").userType){var e=this.data.get({moduleId:"succAd"});try{this.info.get({obj:!0}),$.Ext.secondauthPromote?Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(n){n.default.getSecondauth((function(n){if(n)a();else{var o='<i class="nui-ico nui-ico-remind"></i>'+h.t(" ä¸è¦ç­‰è´¦å·è¢«ç›—æ‰åæ‚”ï¼æ‚¨è¿˜æœªå¼€å¯ç™»å½•äºŒæ¬¡éªŒè¯ï¼Œé‚®ç®±å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œèµ¶å¿«è¡ŒåŠ¨ï¼"),r=new $.Link({text:h.t("é©¬ä¸Šå¼€å¯"),click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"MailSecurityModule",linkName:"secondauth"})}))),x.cache({sl_secondauthPromote:"1"},$.EMPTYFUNC)}}).html(),s=$.Component.html({html:'<a href="javascript:void(0);" class="nui-block-close nui-close"><b class="nui-ico nui-ico-close">x</b></a>',listeners:{click:{handler:function(){$(".xV1").hide()}}}});t='<div class="xV1 nui-textBlock nui-textBlock-err nui-block">'+s+o+r+"</div>",e.before(t),$.Component.setEvents()}}))}))):a()}catch(i){var t="";e.before(t)}}function a(){gAd.getByCallback("composeTips",{},(function(t){var i=t.composeTips||"";i='<div class="xH1 nui-closeable">'+i+"</div>",e.before(i)}))}},fillNotary:function(e){var t,i=this.data,a=e.savedSent.msid?[e.savedSent.msid,e.savedSent.mid].join(":"):e.savedSent.mid,n=i.get({moduleId:"succAd"});t='<iframe src="'+(w.getUrl("compose_notary_suc")+"&mid="+a)+'"  allowTransparency="true" frameborder="0" scrolling="no" width="1px" height="1px"></iframe>',n.after(t)},fillAd:function(){var e=this,t=e.data,i=(e.module,t.get({moduleId:"succAd"})),a="";if((0,f.$S)("isFree"))if("ud"==(0,f.$S)("ad").userType){var n=w.getUrl("compose_ud_suc",!0);try{n+="#n="+e.info.get({con:!0}).length}catch(e){}a='<iframe src="'+n+'"  allowTransparency="true" frameborder="0" scrolling="no" width="100%" height="400"></iframe>',i.setClass(""),i.html(a)}else e.renderAdOfFreeUser();else if((0,f.$S)("isVip")){n=w.getUrl("compose_vip_suc",!0);try{n+="#n="+e.info.get({con:!0}).length}catch(e){}a='<iframe src="'+n+'"  allowTransparency="true" frameborder="0" scrolling="no" width="100%" height="400"></iframe>',i.setClass(""),i.html(a)}else gAd.getByCallback("compose",{},(function(e){var t=e.compose||"";i.html(t),i.setClass("")}))},fillSendAd:function(){},fillCancel:function(e){var t=this,i=t.action,a=(t.base,t.data.get({moduleId:"succInfo"})),n=$.Element.create("SPAN");n.css({fontSize:"14px",marginLeft:"5px"}),a.append(n.dom);var r=null,s=null,c=30,l=null;function d(){var t={tinfo:e.sentTInfo,callback:u,error:m};i.cancelDeliver(t)}function u(e){window.clearInterval(l),n.hide(),$.MultiTab.removeTab((function(){var t={id:e.var.draftMid,cancel:!0};o.default.draft(t),$.Tips.show({statsKey:"Compose_NoGuide_Tips_WithdrawSuccess",text:h.t("å‘é€æ’¤é”€æˆåŠŸ")})}))}function m(){r.setText(h.t("é‡è¯•")),$.Tips.show({statsKey:"Compose_NoGuide_Tips_WithdrawFail",text:h.t("æ’¤é”€å¤±è´¥ï¼Œè¯·é‡è¯•")})}e.sentTInfo?(r=new $.Link({renderTo:n,text:h.t("å–æ¶ˆå‘é€"),cls:"iB2",click:function(){e.saveSentId&&0===(0,f.$S)("attrs").user.save_sent?i.saveSent({mid:e.saveSentId,callback:function(e){if(e.code==k)d();else{var t;switch(e.code){case"FA_MAIL_NOT_FOUND":t=h.t("ç¡®è®¤è¶…æ—¶ï¼Œç³»ç»Ÿæœªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼");break;case"FA_INVALID_PARAMETER":t=h.t("æ ¼å¼é”™è¯¯ï¼Œç³»ç»Ÿæœªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼");break;default:t=h.t("å¼‚å¸¸é”™è¯¯ï¼Œç³»ç»Ÿæœªèƒ½ä¿å­˜è¯¥é‚®ä»¶ï¼")}$.Tips.show({statsKey:"Compose_NoGuide_Tips_SendCancel",statsValue:e.code,text:t})}}}):d()}}),(s=$.Element.create("SPAN")).setClass("nui-txt-aside"),s.html("("+c+")"),n.append(s.dom),l=window.setInterval((function(){c>0?(c--,s.html("("+c+")")):(window.clearInterval(l),n.hide(),t.fillSendAd())}),1e3)):n.hide()},fillMailTrace:function(e,t,i){var a=this.module,n=this.data,o=n.get({status:"sendParam"}),s=(n.get({moduleId:"succOperate"}),n.get({moduleId:"succTips"})),c=null,l=$.Link.html({text:h.t("ç«‹å³æŸ¥çœ‹"),click:function(){r.default.entry({fid:3}),$.Log.cache({Compose_Guide_Text_MailTraceExplore_SeeNow:1}),c&&c.destroy()}}),u='<span class="Sky-gCmp-mailtrace-icon"></span>',m=$G.environment.isCh?"":"en_US";function p(){setTimeout((function(){var e=a.container.querySelector(".sZ1");s.show(),e&&(e.style.marginTop="0px")}),0)}function f(e){var t={statsKey:"ComposeSuccess_Guide_Text_MailTrace_Fail",statsValue:{hash:o.mailTrace.hash,reason:e},renderTo:s,extcls:"Sky-gCmp-mailtrace-success-tips",subclass:"assistBlock",params:"hasClose",content:u+h.t("é‚®ä»¶è¿½è¸ªï¼šç”±äºç½‘ç»œæˆ–å…¶ä»–åŸå› ï¼Œæ­¤é‚®ä»¶æ— æ³•è¿›è¡Œé‚®ä»¶è¿½è¸ªã€‚")};return p(),new $.Block(t)}if(e||i||t){var g=$.Uri.getUrl("compose_mailtrace_report",!0),v=(new Date).getTime(),b=new XMLHttpRequest,y=o.mailTrace,x=y.receiverList.join(","),k={mid:t=[i.toString(),t].join(":"),t:v,sendInfo:e||"",traceKey:y.hash,subject:y.subject,receivers:x,sign:d.default.encode([S(y.subject),S(x),S(t),e?S(e):e,y.hash,v].join("_")),showOwnerRcpt:!!n.get({status:"useSeparate"}),tracedAttInfo:y.tracedAttInfo};$.Ext.mailTrackingV2&&(k.spMode=y.spMode),y.encrypt_id&&(k.encryptId=y.encrypt_id),b.open("post",g,!0),b.setRequestHeader("Content-Type","application/json"),b.onload=function(){try{var e=JSON.parse(b.responseText);e&&200===e.code?($.Log.cache({Compose_MailTrace_ReportApi_Success:1}),t={statsKey:"ComposeSuccess_Guide_Text_MailTrace_OK",statsValue:o.mailTrace.hash,renderTo:s,extcls:"Sky-gCmp-mailtrace-success-tips "+m,subclass:"assistBlock",params:"hasClose",content:u+h.t("é‚®ä»¶è¿½è¸ªï¼šè¯¥é‚®ä»¶æ”¯æŒæŸ¥çœ‹å·²è¯»çŠ¶æ€ï¼Œå¯å‰å¾€ã€å·²å‘é€ã€‘ç¡®è®¤å¯¹æ–¹æ˜¯å¦å·²çŸ¥æ‚‰æ‚¨æ‰€å‘é€çš„é‚®ä»¶ã€‚")+l},p(),c=new $.Block(t),setTimeout((function(){$.WebSocket.init()}),1e3)):($.Log.cache({Compose_MailTrace_ReportApi_Fail:b.responseText}),c=f("apifail"))}catch(e){$.Log.cache({Compose_MailTrace_ReportApi_Fail:b.responseText}),c=f("apifail")}var t},b.onerror=function(e){$.Log.cache({Compose_MailTrace_ReportApi_Error:b.status})},b.onabort=function(e){$.Log.cache({Compose_MailTrace_ReportApi_Abort:1})},b.ontimeout=function(e){$.Log.cache({Compose_MailTrace_ReportApi_Timeou:1})},b.send(JSON.stringify(k))}else c=f("id null");function S(e){var t={"~":"%7E","/":"%2F","!":"%21","(":"%28",")":"%29","'":"%27"};return encodeURIComponent(e).replace(/[~/!()\']/g,(function(e){return t[e]}))}},fillMailProtection:function(e,t,i){var a=this.module,n=a.mailprotection,o=this.data,r=(o.get({status:"sendParam"}),o.get({moduleId:"succOperate"}),o.get({moduleId:"succTips"})),s=$G.environment.isCh?"":"en_US";function c(){setTimeout((function(){var e=a.container.querySelector(".sZ1");r.show(),e&&(e.style.marginTop="0px")}),0)}n.updateEncryptConfig({tid:e,mid:t=[i.toString(),t].join(":")},(function(){var e;e={statsKey:"ComposeSuccess_Guide_Text_MailProtection_OK",renderTo:r,extcls:"Sky-gCmp-mailprotection-success-tips "+s,subclass:"assistBlock",params:"hasClose",content:'<span class="Sky-gCmp-mailprotection-icon"></span>'+h.t("è¯¥é‚®ä»¶å·²å¼€å¯æœºå¯†æ¨¡å¼ï¼Œç”¨æˆ·éœ€è¦åœ¨åŠ å¯†ç¯å¢ƒå†…é˜…è¯»é‚®ä»¶ï¼ˆè¿‡æœŸæ—¶é—´ï¼š"+n.renderFormatDateStr()+"ï¼‰")},c(),new $.Block(e),n.showNPSIfNeed(),$.WebSocket.init()}),(function(e){!function(e){var t={};try{t={code:-1,message:""}}catch(e){}var i={statsKey:"ComposeSuccess_Guide_Text_MailProtection_Fail",statsValue:t,renderTo:r,extcls:"Sky-gCmp-mailprotection-success-tips",subclass:"assistBlock",params:"hasClose",content:h.t("æœºå¯†æ¨¡å¼ï¼šç”±äºç½‘ç»œæˆ–å…¶ä»–åŸå› ï¼Œæ­¤é‚®ä»¶æ— æ³•è¿›è¡Œæœºå¯†æ¨¡å¼")};c(),new $.Block(i)}()}))},getCloseLink:function(e){return new $.Link({cls:"nui-closeable-x",click:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showProduct("noAd","noaryUsed:function(e,t){t=t||0;var i=this,a=e.savedSent.msid?[e.savedSent.msid,e.savedSent.mid].join(":"):e.savedSent.mid,n=w.getUrl("compose_notary_single")+"&mid="+a;$.Ajax.jsonp(n,(function(a){404===a.code&&t<1&&setTimeout((function(){i.singleNotaryUsed(e,t+1)}),2e3)}))},manualNotaryUsed:function(e,t){t=t||0;var i=this,a=e.savedSent.msid?[e.savedSent.msid,e.savedSent.mid].join(":"):e.savedSent.mid,n=w.getUrl("compose_notary_manual")+"&mid="+a;$.Ajax._xmlHttpRequest({url:n,method:$.Ajax.POST,call:function(a){404===a.code&&t<1&&setTimeout((function(){i.singleNotaryUsed(e,t+1)}),2e3)}},!0)},getRandomSpeed:function(){var e=[{time:.3,percent:99.9},{time:.4,percent:99.8},{time:.5,percent:99.7},{time:.6,percent:99.5},{time:.7,percent:99.4},{time:.8,percent:99.3},{time:.9,percent:99.2}];return e[Math.floor(Math.random()*e.length)]},save2YNote:function(e){var t=this,i=t.action;if(t.base,t.data.get({status:"save2YNote"})){var a=h.t("ä¿å­˜åˆ°æœ‰é“äº‘ç¬”è®°å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨ä¿å­˜ã€‚");if(e.code==k){var n=[e.savedSent.msid,e.savedSent.mid].join(":");i.save2YNote({mid:n,callback:function(e){var t=e.code;if("S_OK"===t)$.Tips.show({statsKey:"Compose_NoGuide_Tips_YoudaoNoteSuccess",succ:!0,text:h.t("é‚®ä»¶æˆåŠŸä¿å­˜åˆ°æœ‰é“äº‘ç¬”è®°")});else if("S_PARTIAL_OK"==t){var i=e.var,n="";if(i&&i.fails&&i.fails.length)for(var o=i.fails,r=0;r<o.length;r++)n+=$.String.escapeHTML(o[r].resource)+"<br/>";$.Msgbox.show({statsKey:"Compose_NoGuide_Popup_AttachmentUnsaveType",header:h.t("é‚®ä»¶éƒ¨åˆ†ä¿å­˜æˆåŠŸï¼")+"<br/>"+h.t("ä»¥ä¸‹é™„ä»¶å› ç±»å‹å—é™ï¼Œæ— æ³•ä¿å­˜ï¼š"),title:n})}else $.Msgbox.show({statsKey:"Compose_NoGuide_Popup_YoudaoNotesUnsave",title:a})}})}else $.Msgbox.show({statsKey:"Compose_NoGuide_Popup_YoudaoNotesUnsave",title:a})}},setSaveSend:function(e){var t=h.t("é‚®ç®±å‚æ•°è®¾ç½®æˆåŠŸ");1!=S.get({field:"save_sent"})?S.set({field:"save_sent",value:1,call:function(){e&&e.setText(h.t("å–æ¶ˆè‡ªåŠ¨ä¿å­˜")),$.Tips.show({statsKey:"Compose_NoGuide_Tips_ParameterSetSuccess",statsValue:"save_sent_1",succ:!0,text:t})}}):S.set({field:"save_sent",value:2,call:function(){e&&e.setText(h.t("è‡ªåŠ¨ä¿å­˜")),$.Tips.show({statsKey:"Compose_NoGuide_Tips_ParameterSetSuccess",statsValue:"save_sent_2",succ:!0,text:t})}})},setSaveAddress:function(e){var t=e.getEl(),i=h.t("é‚®ç®±å‚æ•°è®¾ç½®æˆåŠŸ"),a=[h.t("è®¾ç½®è‡ªåŠ¨æ·»åŠ "),h.t("å–æ¶ˆè‡ªåŠ¨æ·»åŠ ")];t.html()==a[1]?S.set({field:"aftersend_saveaddr",value:0,call:function(){t.html(a[0]),$.Tips.show({statsKey:"Compose_NoGuide_Tips_ParameterSetSuccess",statsValue:"aftersend_saveaddr_0",succ:!0,text:i})}}):S.set({field:"aftersend_saveaddr",value:1,call:function(){t.html(a[1]),$.Tips.show({statsKey:"Compose_NoGuide_Tips_ParameterSetSuccess",statsValue:"aftersend_saveaddr_1",succ:!0,text:i})}})},setMailList:function(e){var t={dp:"addt",t:"m"},a=[];g.each(e,(function(e,t){a.push(t.address)})),t.members=a.join(","),Promise.resolve().then(i.bind(i,5439)).then($.Function.bind((function(e){e.default.entry({action:"mailgroups",param:t})})))},setMboxFlag:function(){var e=this.info,t=this.data.get({status:"fromEntry"}),i="";if("reply"==t)i="replied";else{if("forward"!=t)return;i="forwarded"}var a=e.get({mid:!0}),n=e.get({ids:!0});a?r.default.setReFw(a,i):n&&$.Array.each(n,(function(e,t){r.default.setReFw(t,i)}))},showJust:function(){var e=this,t=e.data,a=(e.form,e.info,t.get({moduleId:"succInfo"})),n=$.Element.create("SPAN");a.append(n.dom),p.Z.getNotaryStatus((function(e){e&&(n.css({fontSize:"14px",marginLeft:"5px"}),new $.Link({cls:"nui-txt-link",renderTo:n,text:'<b class="nui-ico nui-ico-sms nui-ico-gzy" style="margin-bottom:2px"></b>'+h.t("å…¬æ­£é‚®å°†ä¸ºæ‚¨å­˜è¯")+"</a>",click:function(e){Promise.resolve().then(i.bind(i,99475)).then($.Function.bind((function(e){e.default.gotoApp(147e3)}))),x.cache({sl_just:"1"},$.EMPTYFUNC)}}))}))},vipSms:function(){var e=this,t=e.data;if("deliver"==t.get({status:"sendParam"}).action){var i=(0,f.$I)("module.compose.ComposeModule"),a=t.get({moduleId:"succInfo"}),n=$.Element.create("SPAN");n.css({fontSize:"14px",marginLeft:"5px"}),a.append(n.dom),2==i.sms_bind?new $.Link({cls:"nui-txt-link",renderTo:n,text:'<b class="nui-ico nui-ico-sms" style="margin-top:0px;color:#555555;"></b>'+h.t("çŸ­ä¿¡é€šçŸ¥æ”¶ä»¶äºº"),click:function(t){e.smsPriority("compose_vip_sms")}}):new $.Link({cls:"nui-txt-link",renderTo:n,text:'<b class="nui-ico nui-ico-sms" style="margin-top:0px;color:#555555;"></b>'+h.t("Taè‹¥å›é‚®ä»¶ï¼ŒçŸ­ä¿¡æé†’æˆ‘"),click:function(e){l.Z.goOutLink("eaw",{param:{source:"open_eaw_write2"}})}})}},smsCharge:function(){var e=this,t=e.data;if(e.form,e.info,"deliver"==t.get({status:"sendParam"}).action){var i=t.get({moduleId:"succInfo"}),a=$.Element.create("SPAN");a.css({fontSize:"14px",marginLeft:"5px",display:"inline-block"}),i.append(a.dom),new $.Link({cls:"iB2",renderTo:a,text:'<b class="nui-ico nui-ico-sms nui-ico-sms" style="margin-right:2px;"></b>'+h.t("çŸ­ä¿¡é€šçŸ¥æ”¶ä»¶äºº"),click:function(t){e.smsPriority("compose_sms_flash")}})}},smsActive:function(e,t){var i=this,a=i.data,o=i.form,r=i.info;if($G.environment.isCh&&"deliver"==a.get({status:"sendParam"}).action){var s=r.get({obj:!0});if(1!=s.priority){var c=o.getSender().address,l=c.split("@")[1].toLowerCase();if("163.com"==l||"126.com"==l||"yeah.net"==l){var d,p=w.getUrl("compose_sms_free"),f=s.subject,g="multi",y="",x="",k=r.get({con:!0});if(1==k.length){var S=w.matchEmail(k[0]);if(S&&(g=S.address,!u.default.isSender(g))){d=S.name;var C=n.default.getAddrObj(g);C&&(y=C[v],x=C[b]||"");var _,I=u.default.getMobile(),A="",M=u.default.getName();try{_=m.Z.getTime(0)}catch(e){_=new Date}var L=_.getHours();if(I){A=I.address;var E=g.split("@"),D=(E[0],E[1].toLowerCase());if("vip.163.com"==D||"vip.126.com"==D||"188.com"==D)return;if(L<8||L>22)return}var R={tid:g,tname:d,mobile:A,tmobile:x,title:f,from:"compose",cid:y,sender:c,sender_nick:M};for(var P in R)p+="&"+P+"="+encodeURIComponent(R[P]);var F=_.valueOf()+"",j=T.encrypt(F);p+="&mid="+encodeURIComponent(F)+"&sign="+encodeURIComponent(j);var N=a.get({moduleId:"succInfo"}),U=$.Element.create("SPAN");U.css({fontSize:"14px",marginLeft:"5px"}),N.append(U.dom),new $.Link({cls:"nui-txt-link",renderTo:U,text:'<b class="nui-ico nui-ico-sms" style="margin-bottom: 5px;"></b>'+h.t("å…è´¹çŸ­ä¿¡é€šçŸ¥"),click:function(e){$.Msgbox.show({header:h.t("å…è´¹çŸ­ä¿¡é€šçŸ¥"),width:"546px",contentType:"custom",noFooter:!0,content:'<iframe id="composeSucSmsIframe" src="'+p+'" style="display:block;width:100%;height:270px" scrolling="no" frameborder="0"></iframe>'})}})}}}}}},smsPriority:function(e){var t,i=this.info,a=i.get({obj:!0}),o=u.default.getName();try{t=m.Z.getTime(0)}catch(e){t=new Date}for(var r={compose_sms_priority:{title:h.t("å…è´¹çŸ­ä¿¡é€šçŸ¥"),height:"320px"},compose_sms_flash:{title:h.t("çŸ­ä¿¡é€šçŸ¥æ”¶ä»¶äºº"),height:"320px"},compose_vip_sms:{title:h.t("çŸ­ä¿¡é€šçŸ¥æ”¶ä»¶äºº"),height:"265px",width:"528px"}},s=t.valueOf()+"",c=T.encrypt(s),l=a.subject,d=w.getUrl(e),p=r[e],f=p.title,y=i.get({con:!0}),x=y.length,k=[],S=0;S<x;S++){var C=y[S],_=null,I=w.getEmails(C,"Email");if(1==I.match.length){var A=(_=I.match[0]).address,M={tauid:A,receiver_nick:_.name},L=n.default.getAddrObj(A);L&&(M.cid=L[v],M.mobile=L[b]||"",g.isArray(M.mobile)&&(M.mobile=M.mobile[0])),k.push(M)}}$.Msgbox.show({header:f,contentType:"custom",noFooter:!0,width:p.width,content:'<iframe id="composeSucSmsIframe"  name="composeSucSmsIframe" src="about:blank" style="display:block;width:100%;height:'+p.height+'" scrolling="no" frameborder="0"></iframe>'});var E={mid:s,title:l,tid:c,sender_nick:o,muti:"true",from:"compose",tas:k};!function(){var e=document.createElement("FORM");for(var t in e.action=d,e.method="POST",e.target="composeSucSmsIframe",E){var i,a=document.createElement("INPUT");a.type="hidden",a.name=t,i="tas"==t?JSON.stringify(E[t]):E[t],a.value=i,e.appendChild(a)}document.body.appendChild(e),e.submit()}()},smsClose:function(){try{$.Msgbox.msgbox.destroy()}catch(e){}this.data.get({moduleId:"succTips"}).hide()},abtest:function(e){var t=e.percent;!t||"number"!=typeof t||t<0||t>100||(Math.abs($.Support._getHashCode((0,f.$S)("uid")))%100<e.percent?e.hit&&e.hit():e.miss&&e.miss())},isABTestTime:function(){var e=new Date("2019/05/21 00:00:00").getTime(),t=new Date("2019/06/10 00:00:00").getTime(),i=$.Misc.getTime().getTime();return i>=e&&i<=t},exit:function(){},renderAdOfFreeUser:function(){var e=this,t=e.data;e.isTeamGreyUser()?(window.gAd.position.has("composeTeamGreyUserAd")||window.gAd.addPosition({moduleName:"composeTeamGreyUserAd",mod:"common",ver:1,moduleId:905}),window.gAd.getByCallback("composeTeamGreyUserAd",{},(function(e){if(e.composeTeamGreyUserAd){var i=t.get({moduleId:"succAd"}),a='<div class="sE1">'+e.chtml(a)}}))):window.gAd.getByCallback(["compose"],{},(function(t){if(t)try{var i=e.data.get({moduleId:"succAd"}),a=t.compose||"",n=t.composeBanner||"",o=t.composeCenter||"",r=[a='<div class="sE1">'+a+"</div>",o,n].join(" tion(){var e=this.module.data,t=e.get({status:"sendParam"}),i=e.get({status:"teamGreyUser"}),a=t.body.attrs.subject,n=!!t.body.attrs.ctrls&&!!t.body.attrs.ctrls.at,o=$.Array.has(["å®¡æ‰¹","æ—¥æŠ¥","æœˆæŠ¥","å‘¨æŠ¥","ä¼šè®®é‚€è¯·","ä¼šè®®é€šçŸ¥","ä¼šè®®çºªè¦","è¯·å‡","æ”¾å‡é€šçŸ¥","ç—…å‡","äº‹å‡","å¹´ä¸­æ±‡æŠ¥","å¹´ç»ˆæ±‡æŠ¥","å¹´ä¸­æ€»ç»“","å¹´ç»ˆæ€»ç»“","å­£åº¦æ€»ç»“"],(function(e){return a.indexOf(e)>=0}));return i||n||o}};g.inherit(T,a.Z),g.extend(T.prototype,C),g.extend(T,{encrypt:function(e){for(var t="",i="",a=(e=e.substr(1)).length,n=0;n<a;n++){var o=n;1==n?o=4:4==n&&(o=1),t=(e.charCodeAt(o)<<1)+n,i+=String.fromCharCode(t)}return i}}),t.Z=T},44261:function(e,t,i){i(48868),i(92274),i(63045),i(81874),i(54861),i(803),i(55737),i(37092),i(75654),i(96752),i(66403),i(79150);var a=i(10487),n=i(64560),o=i(83957),r=i(87253),s=i(72957),c=i(89308),l=(i(35537),new s.c1("module.compose.ComposeView")),d=$.Object,u=$.Function,m=$.Browser,p=$.Ud,f=$.Ext,h=$.Log,g=$.Email,v=$.createClass($N("module.compose.ComposeView")),b={initialize:function(e){v.superClass.initialize.call(this,e)},init:function(){v.superClass.init.call(this)},getToolbar:function(){var e=this,t=e.module,a=t.event,n=t.data,o="showContact",r=l.t("æ˜¾ç¤ºé€šè®¯å½•");"1"!=p.get({field:"ntes_global",flag:"compose_showContacts"})&&(o="hideContact",r=l.t("éšè—é€šè®¯å½•"));var c={groups:[{items:[{xtype:"button",tabindex:"1",text:l.t("å‘é€"),subclass:"mainBtn",icon:{type:"sent",subtype:"white"},click:function(){a.fireBar({func:"deliver",pos:"top"})}}]},{items:[{xtype:"button",text:l.t("é¢„ è§ˆ"),hidden:"ch"!=$G.environment.lang,tabindex:"1",click:function(){a.fireBar({func:"preview"})}}]},{items:[{xtype:"button",text:l.t("å­˜è‰ç¨¿"),tabindex:"1",click:function(){a.fireBar({func:"save",pos:"top"})}}]},{items:[{xtype:"button",text:l.t("å– æ¶ˆ"),tabindex:"1",click:function(){a.fireBar({func:"cancel"})}}]},{items:[{xtype:"link",text:l.t("åˆ›å»ºæ›´ä¸“ä¸šçš„é’é¸Ÿå•†é‚®"),cls:"nui-txt-link iC2",hidden:new Date<new Date(2023,11,1),tabindex:"2",click:function(){e.__markt_tool_tips_layer__&&(e.__markt_tool_tips_layer__.destroy(),e.__markt_tool_tips_layer__=null);var t="compose_qingniao_entry_tips_showed"+(0,s.$S)("uid");$.LocalStorage.set(t,"1"),h.cache({Compose_qingniao_entry_click:1},$.EMPTYFUNC),Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.goOutlink({key:"qingniao_write_letter",title:l.t("é’é¸Ÿå•†é‚®"),fullScreen:!0,group:"team_qingniao",url:$.Uri.getUrl("qingniao_write_letter",!0)})})))}}]},{items:[{xtype:"link",text:l.t("è´ºå¡"),cls:"nui-txt-link",icon:"greetingcard",hidden:!f.compose_card,tabindex:"2",click:function(){a.fireBar({func:"card"}),h.cache({cl_card:1},$.EMPTYFUNC)}}],type:"ext"},{items:[{xtype:"link",text:l.t("æ˜ä¿¡ç‰‡"),icon:"postcard",cls:"nui-txt-link",hidden:!f.compose_card,rightBracket:"<span style='margin-left:6px;' class='nui-txt-aside'>|</span>",tabindex:"2",click:function(){a.fireBar({func:"postcard"}),h.cache({cl_postcard:1},$.EMPTYFUNC)}}],type:"ext"},{items:[{xtype:"link",text:l.t("æŠ„é€"),cls:"nui-txt-link",title:l.t("åŒæ—¶å°†è¿™å°é‚®ä»¶å‘ç»™å…¶ä»–è”ç³»äºº"),tabindex:"1",click:function(){a.setCc({toggle:!0,click:!0}),h.cache({cl_cc:1},$.EMPTYFUNC)}}],type:"ext"},{items:[{xtype:"link",text:l.t("å¯†é€"),cls:"nui-txt-link",title:l.t("åŒæ—¶å°†è¿™å°é‚®ä»¶å‘ç»™å…¶ä»–è”ç³»äººï¼Œä½†æ”¶ä»¶äººå’ŒæŠ„é€äººä¸ä¼šçœ‹åˆ°å¯†é€äºº"),tabindex:"1",click:function(){a.setBcc({toggle:!0,click:!0}),h.cache({cl_bcc:1},$.EMPTYFUNC)}}],type:"ext"},{items:[{xtype:"link",text:l.t("ç¾¤å‘å•æ˜¾šä¸ªäººä¸€å¯¹ä¸€çš„å‘é€ï¼Œ æ¯ä¸ªäººå°†å•ç‹¬æ”¶åˆ°å‘ç»™ä»–/å¥¹çš„é‚®ä»¶"),tabindex:"2",click:function(){a.setSeparate({toggle:!0,click:!0}),h.cache({cl_separate:1},$.EMPTYFUNC)}}],type:"ext"},{items:[{xtype:"link",text:l.t("æ—¥ç¨‹é‚€è¯·"),hidden:!$.Ext.ics2,cls:"nui-txt-link",title:l.t(""),tabindex:"1",clScheduleInvitation()}}],type:"ext"},{items:[{id:"compose_setting_btn",xtype:"button",icon:"setting",title:l.t("å†™ä¿¡è®¾ç½®"),tabindex:"2",subclass:"roundBtn",click:function(){this._menu_||(this._menu_=new $.Menu(e.getOption()),this._menu_.attachTo({clickFrom:this.getEl(),delegateTo:"self"}),this._menu_.fire("attachToShow"))}}],type:"ext"},{items:[{xtype:"button",icon:o,title:r,tabindex:"2",subclass:"roundBtn",click:function(){var t=p.get({field:"ntes_global",flag:"compose_showContacts"}),i="1",a=l.t("æ˜¾ç¤ºé€šè®¯å½•"),o="showContact";"1"==t&&(i="0",a=l.t("éšè—é€šè®¯å½•"),o="hideContact"),i="1"==t?"0":"1",e.base.setOption({field:"ntes_global",flag:"compose_showContacts",value:i}),this.update({icon:o,title:a});var r=n.get({status:"showContactsId"});r&&$.Component._items[r].setChecked("0"===i,!0)}}],typnew $.Toolbar(c);d=u.html(),n.set({componecreate error"+e)}return d},getOption:function(){var e,t=this.module,a=t.base,n=t.data,o=t.event,r=2!=p.get({field:"ntes_htmlbar"}),c="1"==p.get({field:"ntes_compose",flag:"compose_nav"}),d="1"!=p.get({field:"ntes_global",flag:"compose_showContacts"}),m=p.get({field:"ntes_compose",flag:"upload_mode"}),g="0"==p.get({field:"ntes_option",flag:"replySign"}),v="1"==p.get({field:"ntes_option",flag:"forwardSign"}),b="1"!=p.get({field:"ntes_option",flag:"signPosition"}),y=(p.get({field:"ntes_option",flag:"requirereceipt"}),p.get({field:"save_sent"})),x=1==p.get({field:"aftersend_saveaddr"}),k="0"==p.get({field:"ntes_letter",flag:"remindShow"}),S=t.createId("compose-settings-remindShow"),w=t.createId("compose-settings-showContacts");return n.set({status:"remindShowId",value:S}),n.set({status:"showContactsId",value:w}),e=[{text:l.t("å¦‚æœå¯¹æ–¹é‚®ç®±ä¸æ”¯æŒ20Mä»¥ä¸Šæ™®é€šé™„ä»¶ï¼Œä½¿ç”¨è¶…å¤§é™„ä»¶"),checked:"0"==m||"1"==m,click:u.bind(a.setOption,a,{field:"ntes_compose",flag:"upload_mode",value:"0"})},{text:l.t("é™„ä»¶è¶…è¿‡50Mæ‰ä½¿ç”¨è¶…å¤§é™„ä»¶"),checked:"2"==m,click:u.bind(a.setOption,a,{field:"ntes_compose",flag:"upload_mode",value:"2"})},{text:l.t("ä¸æ”¯æŒå¤šæ–‡ä»¶åŒæ—¶ä¸Šä¼ ï¼Œå…¶ä»–æ¨¡å¼å¼‚å¸¸æ—¶ä½¿ç”¨"),checked:"3"==m,click:u.bind(a.setOption,a,{field:"ntes_compose",flag:"upload_mode",value:"3"})}],{xtype:"menu",extcls:"nui-settingMenu",delegateTo:"self",reverse:!0,groups:[{items:[{text:l.t("æ­£æ–‡å·¥å…·æ "),extText:{xtype:"checkbox",subclass:"switch",text:l.t("å·²æ˜¾ç¤º"),unCheckText:l.t("å·²éšè—"),value:1,checked:r,checkedchange:function(e){var t=e?1:2;a.setOption({field:"ntes_htmlbar",value:t})}}},{text:l.t("å·¦ä¾§æ "),hidden:!0,menu:{groups:[{items:[{text:l.t("å±•å¼€"),checked:c,click:u.bind(a.setOption,a,{field:"ntes_compose",flag:"compose_nav",value:"1"})},{text:l.t("æŠ˜å  (é»˜è®¤)"),checked:!c,click:u.bind(a.setOption,a,{field:"ntes_compose",flag:"compose_nav",value:"0"})}],checkType:"radio"}]}},{text:l.t("å³ä¾§é€šè®¯å½•"),extText:{xtype:"checkbox",subclass:"switch",text:l.t("å·²æ˜¾ç¤º"),unCheckText:l.t("å·²éšè—"),value:1,checked:d,id:w,checkedchange:function(e){var t=e?"0":"1";a.setOptx",subclass:"switch",text:l.t("å·²å¼€å¯"),id:S,unCheckText:l.t("å·²å…³é—­"),checked:k,checkedchange:function(e){var t=e?"0":"1";a.setOption({field:"ntes_letter",flag:"remindShow",value:t})}}},{text:l.t("é™„ä»¶ä¸Šä¼ æ–¹å¼"),menu:{extcls:"nui-settingMenu sT1",groups:[{items:e,checkType:"radio"}]}},{text:l.t("å›å¤æ—¶æ·»åŠ ç­¾å"),extText:{xtype:"checkbox",subclass:"switch",text:l.t("å·²å¼€å¯"),unCheckText:l.t("å·²å…³é—­"),value:1,checked:g,checkedchange:function(e){var t=e?"0":"1";a.setOption({field:"ntes_option",flag:"replySign",value:t})}}},{text:l.t("è½¬å‘æ—¶æ·»åŠ ç­¾å"),extText:{xtype:"checkbox",subclass:"switch",text:l.t("å·²å¼€å¯"),unCheckText:l.t("å·²å…³é—­"),value:0,checked:v,checkedchange:function(e){var t=e?"1":"0";a.setOption({field:"ntes_option",flag:"forwardSign",value:t})}}},{text:l.t("å›å¤è½¬å‘æ—¶ç­¾åä½ç½®"),doNotHide:!0,extText:{xtype:"checkgroup",checkType:"radio",checkedchange:function(e){a.setOption({field:"ntes_option",flag:"signPosition",value:e})},items:[{value:"0",text:l.t("åŸæ–‡ä¸Šæ–¹"),checked:b,subclass:"btn"},{value:"1",text:l.t("åŸæ–‡ä¸‹æ–¹"),checked:!b,subclass:"btn"}]}},{text:l.t("é‚®ä»¶æ’¤å›"),extText:{xtype:"checkbox",subclass:"switch",text:l.t("å·²å¼€å¯"),unCheckText:l.t("å·²å…³é—­"),value:!0,checked:f.letterRecall,checkedchange:function(e){Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(t){t.default.setWithDraw(e)})))}}},{text:l.t("å‘ä¿¡åè‡ªåŠ¨ä¿å­˜é‚®ä»¶"),menu:{extcls:"nui-settingMenu",groups:[{items:[{text:l.t("ä¿å­˜å°äº1Mçš„é‚®ä»¶å’Œå¤§äº1Mé‚®ä»¶çš„æ­£æ–a.setOption,a,{field:"save_sent",value:0})},{text:l.t("å…¨éƒ¨ä¿å­˜åˆ°â€œå·²å‘é€â€æ–‡ä»¶å¤¹"),checked:1==y,click:u.bind(a.setOption,a,{field:"save_sent",value:1})},{text:l.t("ä¸ä¿å­˜"),checked:2==y,click:u.bind(a.setOption,a,{field:"save_sent",value:2})}],checkType:"radio"}]}},{text:l.t("å‘ä¿¡åè‡ªåŠ¨ä¿å­˜è”ç³»äºº"),extText:{xtype:"checkbox",subclass:"switch",text:l.t("å·²å¼€å¯"),unCheckText:l.t("å·²å…³é—­"),value:1,checked:x,checkedchange:function(e){var t=e?"1":"0";a.setOption({field:"aftersend_saveaddr",value:t})}}},{text:l.t("é»˜è®¤ä½¿ç”¨ç¾¤å‘å•æ˜¾"),hidden:(0,s.$S)("isFree"),extText:{xtype:"checkbox",subclass:"switch",text:l.t("å·²å¼€å¯"),unCheckText:l.t("å·²å…³é—­"),value:1,checked:"1"==p.get({field:"ntes_compose",flag:"separate_default"}),checkedchange:function(e){var t=e?"1":"2";p.set({field:"ntes_compose",flag:"separate_default",value:t});var i={};e?i.show=!0:i.hide=!0,o.setSeparate(i)}}},{text:l.t("å‘ä»¶äººè®¾ç½®"),click:function(){h.cache({cl_account:1},$.EMPTYFUNC),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"AccountCenterModule",exit:!1,inputName:"SectionSenderManage"})})))}},{text:l.t("ç­¾åè®¾ç½®"),click:function(){h.cache({cl_sign:1},$.EMPTYFUNC),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"SignModule",exit:!1})})))}},{text:l.t("æ›´å¤šè®¾ç½®"),gap:"before",click:function(){h.cache({cl_more:1},$.EMPTYFUNC),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"BaseSetModule",exit:!1})})))}}]}]}},getHeader:function(){var e=this;return'<header id="'+e.module.createId("header")+'" class="qa0">'+e.getRev("to")+e.getSubject()+e.getAttach()+"</header>"},getRev:function(e){var t=this,i=t.module,a=(i.base,i.form),n=$.Ud.udProxy&&$.Ud.udProxy["product.vipMember"],r=i.mailtrace,c={xtype:"emailcontainer",key:e,tabIndex:1,title:l.t("å‘ç»™å¤šäººæ—¶åœ°å€è¯·ä»¥åˆ†å·éš”å¼€"),inputLable:l.t("æ”¶ä»¶äººåœ°å€è¾“å…¥æ¡†ï¼Œè¯·è¾“å…¥é‚®ä»¶åœ°å€ï¼Œå¤šäººæ—¶åœ°å€è¯·ä»¥åˆ†å·éš”å¼€"),choose:!0,containerfocus:function(){a.choose(e),a.addFocusCls(e)},containerblur:function(){a.removeFocusCls(e),$.Ext.contactCorrect&&a.remindValid(e),a.getAllRecvNum()>=2&&r.groupSendSceneTrigger()},containerupdate:function(){a.getAllRecvNum()>=21&&t.showMaketToolTips()},containeradditem:function(e){r.markContactGuideSceneTrigger(e)}};c.tips={text:n?l.t("ä¼šå‘˜å°Šäº«ï¼Œæ”¶ä»¶äººä¸Šé™æå‡è‡³200äºº"):l.t("")},c.domain="163.com",$.Ext.contactCorrect&&(c.itemwarnremove=function(t){a.remindRemove(e,t)});var d={text:l.t("æ”¶ä»¶äºº"),cls:"nui-txt-link",title:l.t("ç‚¹å‡»æ·»åŠ æ”¶ä»¶äºº"),click:function(){h.cache({cl_rev:e},$.EMPTYFUNC),a.showContact(e)}},u=l.t("æ”¶ä»¶äºº"),m="";try{u=new $.Link(d).html();var p=new o.Z(c);m=p.html(),i.data.set({component:e,value:p})}catch(e){s.$D.info("compose email container create error"+e)}return'<div id="'+i.createId(e)+'" class="kZ0 eB0"><label class="fn0">'+u+l.t("ï¼š")+'</label><div class="dG0"><div class="bz0">'+m+'</div></div><div class="gH1"></div></div>'},getSubject:function(){var e=this.module,t=e.base,i=e.form,a=e.data,n=e.createId("subjectInput"),o={tabIndex:1,ariaLabel:l.t("é‚®ä»¶ä¸»é¢˜è¾“å…¥æ¡†ï¼Œè¯·è¾“å…¥é‚®ä»¶ä¸»é¢˜"),maxLength:"256",voiceInput:!0,inputId:n,listeners:{focus:function(){i.addFocusCls("subject")},blur:function(){e.mailtrace;var a=this.getValue();e.setText(a),i.removeFocusCls("subject"),t.fireCompose("compose:subjectChange",a)}}},r="";try{var c=new $.Input(o);r=c.html(),a.set({component:"subject",value:c})}catch(e){s.$D.info("compose subject create error"+e)}return'<div id="'+e.createId("subject")+'" class="kZ0 fu0"><label class="fn0" for="'+n+'"><span class="cr1">'+l.t("ä¸»ã€€é¢˜")+'</span>ï¼š</label><div class="dG0"><div class="bz0">'+r+'</div></div><div class="gH1"></div></div>'},getAttach:function(){var e=this;(g=e.module).attach,g.event,g.assist;var t={xtype:"link",icon:"dArr",tabindex:"-1",cls:"nui-txt-link ca0",listeners:{click:function(){if(!this.menuInit){this.menuInit=!0;var t=new $.Menu(function(e){var t=e.module,i=t.attach,a=t.event,n=t.assist,o={xtype:"menu",groups:[{items:[{text:$.Ext.netfolder_enable?l.t("ä»â€œæ–‡ä»¶ä¸­å¿ƒâ€æ·»åŠ "):l.t("ä»â€œè¶…å¤§é™„ä»¶â€æ·»åŠ "),click:function(){i.msg("file"),h.cache({cl_nfcloud:"1"},$.EMPTYFUNC)}},{text:l.t("ä»â€œå¾€æ¥é™„ä»¶â€æ·»åŠ "),click:function(){i.msg("internal"),h.cache({cl_internal:"1"},$.EMPTYFUNC)}}]}]};return f.ynote&&!$.Support.isTeamMailFromSwitch()&&o.groups[0].items.push({text:l.t("ä»â€œæœ‰é“äº‘ç¬”è®°â€æ·»åŠ "),click:function(){i.msg("ynote"),h.cache({cl_ynote:"1"},$.EMPTYFUNC)}}),(m.ie()||m.firefox()||m.chrome())&&o.groups.push({items:[{text:l.t("æ‹–æ‹½æ·»åŠ "),click:function(){n.get({status:"dragSupport"})?a.setDragArea({toggle:!0}):n.setup("new"),h.cache({cl_drag:"1"},$.EMPTYFUNC)}}]}),o}(e));t.attachTo({clickFrom:this.getEl()}),t.fire("attachToShow")}}}},a="";try{a=new $.Link(t).html()}catch(e){s.$D.info("Compose Attach Link Component Create Error"+e)}var n=g.createId("attachUpload"),o='<iframe id="'+n+'"  name="'+n+'" src="about:blank" style="display:none"></iframe>',r=p.get({field:"ntes_compose",flag:"upload_mode"}),c=e.getCloudSize(r),d=l.t("ç‚¹å‡»æ·»åŠ é™„ä»¶"),u=this.module.data,g=this.module;(0,s.$S)("cloud")&&(0,s.$S)("isFree")&&(d=l.t("ä¸€æ¬¡å¯å‘é€2000å¼ ç…§ç‰‡ï¼Œ600é¦–MP3ï¼Œä¸€éƒ¨é«˜æ¸…ç”µå½±")),$.Listener.one("compose:vipMemberInited",(function(){var t=u.get({moduleId:"attachSize"});if(!(0,s.$S)("isVip")){var a=e.getCloudSize(r);if(u&&u.get({status:"vipMember"})){var n='(<span class="dO1">'+l.t("ä¼šå‘˜å°Šäº«")+"</span>"+l.t("å•æ–‡ä»¶æœ€å¤§")+'<strong class="nui-txt-impt" id="ft2">'+a+"</strong>)";t.html(n)}else{var o=$.Link.html({text:l.t("å¯æè‡³")+'<strong class="nui-txt-impt">6G</strong>',cls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showProduct("cloudFileSizeLimit","Largeattachments3")}))),$.Log.cache({Compose_CloudAttachSizeUpgrade_Click:1})}});n="("+l.t("å•æ–‡ä»¶æœ€å¤§")+'<span id="ft2">'+a+"</span> ï¼Œ"+o+" )",t.html(n)}}}));var v="";(0,s.$S)("isFree")&&(f.mobile_upload||(v='<a id="'+g.createId("attachDashi")+'" href="https://mail.163.com/dashi/activity/gift/index.jsp?from=fj"  title="'+l.t("é‚®ç®±å¤§å¸ˆé¢†15Gè¶…å¤§é™„ä»¶")+'" class="nui-txt-link cm1" target="_blank">'+l.t("é‚®ç®±å¤§å¸ˆé¢†15Gè¶…å¤§é™„ä»¶")+"</a>"));var b=e.createOtherEntryHTML(),y="";return f.newYearCard&&(y=new $.Link({text:l.t("å‘æ˜¥èŠ‚è´ºå¡"),cls:"nui-txt-l#C00!important;"',title:l.t("å‘æ˜¥èŠ‚è´ºå¡"),click:function(){g.newYearLetter(),$.Log.cache({cl_new_year:"1"},$.EMPTYFUNC)}}).html()),'<div class="ia0"><div id="'+g.createId("attachOperate")+'" class="fv0"><a href="javascript:void(0)" id="'+g.createId("attachAdd")+'"  title="'+d+'" class="cb0 nui-txt-link"><b class="nui-ico nui-ico-cmpAttach"></b>'+l.t("æ·»åŠ é™„ä»¶")+'</a><span id="'+g.createId("attachSize")+'" class="nui-txt-tips" style="float: left;margin-top:12px;margin-right:4px;">('+l.t("å•æ–‡ä»¶æœ€å¤§")+'<strong class="nui-txt-impt" id="ft2">'+c+"</strong>)</span>"+a+v+b+y+'<div id="'+g.createId("attachProgress")+'" \tclass="cH0"></div>'+o+'<div id="'+g.createId("attachBrowser")+'" title="'+d+'"\tclass="by0 ej1" style="display:none;"></div><div id="'+g.createId("attachBrowserCloud")+'" title="'+l.t("æ·»åŠ è¶…å¤§é™„ä»¶")+'" class="by0 ci1" style="display:none;"></div><div id="'+g.createId("attachDrag")+'"  \t\tclass="R0" style="display:none;"><a id="'+g.createId("attachDragClose")+'" href="javascript:void(0)" class="nui-ico nui-ico-x" hidefocus="hidefocus"><b class="nui-ico nui-ico-close">x</b></a>'+l.t("è¯·æŠŠæ–‡ä»¶æ‹–æ”¾åˆ°è¿™ä¸ªåŒºåŸŸï¼Œå°±å¯ä½œä¸ºé™„ä»¶æ·»åŠ ã€‚")+'</div></div><div id="'+g.createId("attachArea")+'" class="bs0"><div id="'+g.createId("attachContent")+'" class="D0"></div></div></div>'},getCloudSize:function(e){var t="3G";if((0,s.$S)("cloud")){var i=(0,s.$S)("cloud").fileSizeLimit;t=$.Number.convert(i)}return"3"===e&&(t="2G"),(0,s.$S)("isVip")&&(t+='<b class="nui-ico nui-ico-tequan" style="margin-top:-2px;margin-left:2px;margin-right:2px;"></b>'),t},createOtherEntryHTML:function(){var e="compose_ppt_entry_"+(0,s.$S)("uid"),t=$.LocalStorage.get(e),a=['<span  style="position:relative;">',l.t("åŠå…¬æ¨¡ç‰ˆ"),t?"":'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAYCAMAAACCyC6UAAAAtFBMVEXMAgDMAwDRCQDMAgAAAADMAgD////icG/RGxricnHRGRj++/v77u7SIB/ODQzfY2LXOjn0ysrojIzfYF/QFRTNBAP66OjcUVDbSknaRUTPERDOCgn99vb429v21tb21NTxubnuq6vsoqLmgoLjdXTUJyb9+Pj439/10NDyvr7vsrLuqqrtp6frnZ3rm5vplZXlgYDgZWTeWlnVLy7zxMTywsLpkZHniIjkeXjhbm3YQD/WNDMFNBBzAAAABXRSTlPmphztAPMTpaIAAAEwSURBVDjLndTJcoJAGATgAe0/xEFFQGVxQ8F9N3ve/70yA6EStgP0pYua+ar6wrC2qjDUCFPUNlNbqJmWyhTUjsJYfdTEACnqaT3EES0+ZGzYnd+zuDwtj55o48vu0LP8kBngRPG9IxmyXkdFxM1/yHIcx8CYLIjodAXgr5dFdOLff6ib7OLynkHbF1Eu3Ysomm6HOYSdXLQaXXkPeOd2EWkufeRRSA9gsDRoLGqAEoTzJErRdDabWUBEIWy6D/ULPL4qRd5ol6KzaZpfADYLWGJWMMWYjFIkDvrZebhM/KOYdaPumz4sRwj0RxY55Opilka3eYAK1NH3WeRPDvGs+Z76VQgWJSjsi8g9i3U8y+SkVSIsEhTHA/BJB4i4NEcG1UtzxBqYRr97o4el0RP2A3HKJq3E5XnJAAAAAElFTkSuQmCC" style="position:absolute;top:-4px;right:-28px;width:26px;height:12px;">',"</span>"].join(""),n=new $.Link({text:a,hidden:!0,cls:"nui-txt-link cm1 App-compose-attach-ppt-entry",title:l.t("åŠå…¬æ¨¡ç‰ˆ"),onRender:function(e){var t=this;setTimeout((function(){$.Support.isTeamMailFromSwitch()||(t.show(),$(".cs0").show())}),1e3)},click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"ppt_template",fullScreen:!0,group:"ppt_template"})}))),$.LocalStorage.set(e,"1",{expires:999999,domain:(0,s.$S)("fullDomain")});var t=this.el.find("img");t&&t.remove(),$.Log.cache({Comopose_PPT_click:1})}});return['<span class="cs0" style="display:none">|</span>',$.Support.isTeamMailFromSwitch()?"":n.html()].join("")},createScheduleInvitation:function(){var e=this,t=e.event,i=[e.getScheduleInvitationTime(),$.Ext.ics2schedule?e.getScheduleInvitationRemind():"",e.getScheduleInvitationAddr()].join("");return'<div class="dc2">'+new $.Link({cls:"nui-block-close nui-close bt2",icon:"close",click:function(){t.toggleScheduleInvitation()}}).html()+i+"</div>"},getScheduleInvitationTime:function(){var e=this,t=e.module,i=e.data,a=t.createId("scheduleInvitationTime"),n=t.createId("scheduleInvitationStartDay"),o=new Date,r=o.getHours(),s=o.getMinutes(),c=r+1+s/60>=23.5,d=r+s/60>=23.5,u=null,m=60*(60*r+s)*1e3,p=m;c&&(p=0,(u=new Date).setDate(u.getDate()+1));var f=e.createDatePicker({id:"startDate",x:80,y:-130,type:"start",defaultDate:d?u:null})130,type:"end",defaultDate:c?u:null}),g=e.createTimeSelector(0,null,(function(t,i){i.setValue(e.TSToTime(t)),i.__prevValue=i.getValue(),b(g,t),e.updateEndTimeSelector()})),v=e.createTimeSelector(p,(function(e,t){if(c&&!d){var i=!1;$.Array.each(e,(function(e,t){!i&&t.value+864e5-m>=36e5&&(t.checked=!0,i=!0)}))}else e.length>=3?e[2].checked=!0:e[e.length-1].checked=!0}),(function(t,i){t>=g.getValue()?(i.setValue(e.TSToTime(t)),i.__prevValue=i.getValue(),b(v,t)):i.setValue(i._prevValue)}));function b(e,t){var i=e.rawConfig.options;if($.Array.has(i,(function(e){return e.value===t})))e.setValue(t);else{var a=e.menu?e.menu.find("menuitem"):null;$.Array.each(a,(function(e,t){t.setChecked(!1)}))}}var y=new $.Checkbox({name:"isScheduleInvitationTimeAll",value:"1",text:l.t("å…¨å¤©"),checked:!1,checkedchange:function(e){g.setDisabled(e),v.setDisabled(e)}});i.set({component:"scheduleInvitationStartDay",value:f}),i.set({component:"scheduleInvitationEndDay",value:h}),i.set({component:"scheduleInvitationStartTime",value:g}),i.set({component:"scheduleInvitationEndTime",value:v}),i.set({component:"isScheduleInvitationTimeAll",value:y});var x='<span class="cd3">'+l.t("åˆ°")+"</span>",k=[f.html(),g.html(),x,h.html(),v.html(),y.html()].join(""),S=e.getFormLabel(n,l.t("æ—¶  é—´"));return e.getFormItem(a,S,k,!1)},getScheduleInvitationRemind:function(){var e=this,t=e.module,i=e.data,a=t.createId("scheduleInvitationRemind"),n=t.createId("scheduleInvitationRemindSelect"),o={width:$G.environment.isCh?"100px":"120px",options:[{text:l.t("ä¸æé†’"),value:"0_0"},{text:l.t("æ—¥ç¨‹å¼€å§‹æ—¶"),value:"1_0"},{text:l.t("10åˆ†é’Ÿå‰"),value:"1_10",c’Ÿå‰"),value:"1_30"},{text:l.t("1å°æ—¶å‰"),value:"2_1"},{text:l.t("1å¤©å‰"),value:"3_1"},{text:l.t("1å‘¨å‰"),value:"4_1"}],selectedIndex:3,selectedchange:function(e){var t="";switch(e){case"0_0":t="ComposeICSRemindSelected_NoRemind";break;case"1_0":t="ComposeICSRemindSelected_WhileBegin";break;case"1_10":t="ComposeICSRemindSelected_Before10Min";break;case"1_30":t="ComposeICSRemindSelected_Before30Min";break;case"2_1":t="ComposeICSRemindSelected_Before1Hour";break;case"3_1":t="ComposeICSRemindSelected_Before1Day";break;case"4_1":t="ComposeICSRemindSelected_Before1Week"}var i={};i[t]=1,$.Log.cache(i)}},r="";try{var c=new $.Select(o);r=c.html(),i.set({component:"scheduleInvitationRemind",value:c})}catch(e){s.$D.info("compose scheduleInvitationRemind create error"+e)}var d=e.getFormLabel(n,l.t("æ  é†’"));return e.getFormItem(a,d,r,!1)},getScheduleInvitationAddr:function(){var e=this,t=e.module,i=e.data,a=t.createId("scheduleInvitationAddr"),n=t.createId("scheduleInvitationAddrInput"),o="",r={tabIndex:1,ariaLabel:l.t("æ·»åŠ åœ°å€"),placeholder:l.t("æ·»åŠ åœ°å€"),maxLength:"256",voiceInput:!0,inputId:n,width:"468px",listeners:{blur:function(){this.getValue().length>140&&this.showTips(l.t("å­—æ•°è¿‡å¤šï¼Œæœ€å¤šæ”¯æŒ140ä¸ªå­—"))}}};try{var c=new $.Input(r);o=c.html(),i.set({component:"scheduleInvitationAddr",value:c})}catch(e){s.$D.info("compose scheduleInvitationAddr create error"+e)}var d=e.getFormLabel(n,l.t("åœ°  ç‚¹"));return e.getFormItem(a,d,o,"bH2")},getFormLabel:function(e,t){return['<label class="fn0" for="'+e+'">','<span class="cr1">'+t+"</span>ï¼š","</label>"].join("")},getFormItem:function(e,t,i,a){return['<div id="'+e+'" class="kZ0 fu0">',t,'<div class="'+(a=a||"")+'">','<div class="bz0">',i,"</div>","</div>",'<div class="gH1"></div>',"</div>"].join("")},createDatePicker:function(e){var t=this,i=t.module,a=t.data,n=t.form,o=e.defaultDate||new Date,r=$.Date.format(o,"yyyy-MM-dd"),c=$.Date.getWeek(o,0),d=r+" "+l.t("å‘¨")+c;return new $.Input({id:i.createId("dateTimeInput_"+e.id),width:$G.environment.isCh?"110px":"140px",placeholder:"yyyy-MM-dd",value:d||"",iconBtn:"calendar",iconbtnclick:function(){var o=this;if(!o.calendar){var r={popupRenderTo:$(i.container).find(".tH0"),fixX:e.x,fixY:e.y,focus:e.date,filterFn:function(){return!0},onselect:function(i){s.$D.log("calendar select:"+i);var r=a.get({component:"scheduleInvitationStartDay"}),c=a.get({component:"scheduleInvitationEndDay"}),d=i.getTime(),u=$.Date.format(i,"yyyy-MM-dd"),m=$.Date.getWeek(i,0),p=u+" "+l.t("å‘¨")+m,f=n.getScheduleInvitationEndTime(),h=n.getScheduleInvitationStartTime(),g=new Date(f);g.setHours(0,0,0,0),f=g.getTime(),"start"===e.type&&d>=f||"end"===e.type&&d<h?(r.setValue(p),c.setValue(p)):o.setValue(p),o.focus(),t.updateEndTimeSelector()}};o.calendar=new $.Calendar(r),o.calendar.el=o.getEl()}setTimeout((function(){o.calendar.getLayer().show()}),0)},keydown:function(e){e.preventDefault()}})},createTimeSelector:function(e,t,,o=new Date,r=new Date;r.setHours(0,0,0,0);var s=o.getTime()-r.getTime();t?t(n):$.Array.each(n,(function(e,t){var i=t.value-s;i>0&&i<18e5&&(t.checked=!0)}));var c={options:n,selectedchange:function(e){i&&i(e,d)}},l=new $.Select(c),d=l.add(m());function u(){d.getEl().css({position:"absolute",top:"0px",left:"0px",bottom:"0px",border:"none",overflow:"hidden",paddingLeft:"0px",paddingRight:"0px",marginRight:"0px",backgroundColor:"#fff"});var e=a.TSToTime(l._originGetValue());d.setValue(e)}function m(){return{xtype:"input",width:"36px",click:function(e){},focus:function(){d._prevValue=d.getValue(),setTimeout((function(){d.getEl().find("input").dom.focus()}),100)},blur:function(){void 0===a.timeToTS(d.getValue())?d.setValue(d._prevValue):i(a.timeToTS(d.getValue()),d)}}}return l._input=d,d.listen("afterRender",(function(){u()})),l.listen("afterRender",(function(){l.getEl().css({position:"relative"}),l.add(d)})),l.listen("update",(function(){l.remove(d.getEl().dom.id),d=l.add(m()),l._input=d,u()})),l.listen("destroy",(function(){l._input=null})),l._originGetValue=l.getValue,l.getValue=function(){var e=l._input.getValue();return a.timeToTS(e)},l},getTimeSelectOptions:function(e){e=e||0;for(var t=[],i=0;i<24;i++){var a=i>=10?i:"0"+i,n=36e5*i,o=n+18e5;n>=e&&t.push({text:a+":00",value:n}),o>=e&&t.push({text:a+":30",value:o})}return t},updateEndTimeSelector:function(){var e=this,t=(e.module,e.data),i=e.form,a=t.get({component:"scheduleInvitationEndTime"}),n=t.get({component:"scheduleInvitationStartTime"}),o=t.get({component:"isScheduleInvitationTimeAll"}),r=i.getScheduleInvitationStartDate(),s=i.getScheduleInvitationEndDate();if(!o.getChecked()){var c=n.getValue(),l=r.getTime()===s.getTime()?c:0,d=a.getValue(),u=!1,m=e.getTimeSelectOptions(l);$.Array.each(m,(function(e,t){t.value===d&&(t.checked=!0,u=!0)})),u||(m[0].checked=!0),a.update({options:m})}},TSToTime:function(e){var t=(e/36e5).toString().split("."),i=Number(t[0]||"0"),a=e%36e5/6e4;return[$.Number.format(i,2),$.Number.format(a,2)].join(":")},timeToTS:function(e){if(e){var t=e.split(":"),i=t[0],a=t[1],n=Number(i),o=Number(a),r=0;if(i&&!isNaN(n)&&n>=0&&n<=23)return r=3600*n*1e3,a&&!isNaN(o)&&o>=0&&o<=59?r+=60*o*1e3:void 0}},getEditor:function(){var e=this.module,t=e.data;e.action,e.editor,e.layoutInit();var i=t.layout.editorHeight,a=e.createId("editor"),n=r.Z.mode.BASIC;p.get({field:"ntes_letter",flag:"editorToolbar"}),2==p.get({field:"ntes_htmlbar"})&&(n=r.Z.mode.HIDE);var o={editMode:n,width:"100%",height:i+"px"},s=!1,c={};f.human_trans||(s=!0,c.translate=1),f.notary||(s=!0,c.notary=1),s&&(o.btnNoShow=c);var l=new r.Z(o);return t.set({component:"editor",value:l}),'<section class="pY0"><div id="'+a+'" >'+l.html()+"</div></section>"},getExtend:function(){var e=this,t=e.module,i=t.createId("ext");return'<div id="'+t.createId("above-base-ext")+'" class="mT0" style="display:none"></div>'+('<div id="'+i+'" class="mT0" style="display:none"><div class="gm0"></div>'+e.getNotary()+e.getSchedule()+e.getEncrypt()+"</div>")},getNotary:function(){return'<div id="'+this.module.createId("notary")+'" class="nui-block gn0 dl0" style="display:none"></div>'},getSchedule:function(){return'<div id="'+this.module.createId("schedule")+'" class="nui-assistBlock nui-block gn0" style="display:none"></div>'},getEncrypt:function(){return'<div  id="'+this.module.createId("encrypt")+'" class="nui-assistBlock nui-block gn0" style="display:none"></div>'},getSender:function(){var e=this,t=e.module,a=t.data,o=t.event,r="";try{var u=n.default.getDefault(),m=x(),p={cls:"nui-txt-link cp0",tabindex:"2",title:l.t("å‘ä»¶äººåœ°å€ï¼Œç‚¹å‡»å¯ä»¥è®¾ç½®å‘ä»¶äºº"),text:v(u,!0),click:function(){},listeners:{afterRender:function(){var i=this;i.menu=new $.Menu(m);var a=$("#"+t.createId("main"));i.menu.attachTo({clickFrom:i.getEl(),renderTo:a}),e.senderMenu=i.menu}}},h=e._SenderLink=new $.Link(p);a.set({component:"sender",value:h}),h.value=u,h.setValue=v,h.getValue=function(){return this.value},r=h.html(),$.Listener.listen("options:nonEssentialNameModify",(function(){var e=n.default.getList();$.Array.each(e,(function(e,t){t.address==h.value.address&&h.setValue(t),b(t,!0)}))}))}catch(e){s.$D.info("compose addr component create error"+e)}return'<div class="ec0"><span class="cz0">'+l.t("å‘ä»¶äººï¼š")+"</span>"+r+"</div>";function v(e,t,i){var a=this;if(!d.isEqual(a.value,e)||i){var n="",o=e.name;if(n=(o=$.String.escapeHTML(o))?'<span class="bk0">'+$.String.encodeHTML(o)+'</span><span class="bf0">&lt;'+e.address+"&gt;</span>":'<span class="bf0">'+e.address+"</span>",n+=' <b class="nui-ico nui-ico-unfold"></b>',t)return n;a.setText(n),a.value=e}}function b(t,i){var a=x(t,i);e.senderMenu.update(a)}function y(e){var i=[];try{var r=n.default.getList(),d=e;d||(d=n.default.getDefault()),$.Array.each(r,(function(e,r){var s=$.String.encodeHTML(r.toString()),u={xtype:"menuitem",id:t.createId(r.address),text:s,click:function(){$.Log.cache({cl_switchsender:"1"},$.EMPTYFUNC);var e=a.get({status:"showNotary"}),i=t.notary,s=!1;if(c.default.getNotaryInfo((function(e){s=e.isAutoArchive})),f.notary){var d=n.default.getUid(),u=n.default.getMobile(),m=!1,p=r.address;p==d.address&&(m=!0),null!==u&&p==u.address&&(m=!0),m?(h.setValue(r),s&&i&&(i.toggle({open:!0}),o.extShow())):e?new $.Msgbox({type:"confirm",title:l.t("é‚®ä»¶å­˜è¯ä»…å¯¹é‚®ç®±ä¸»è´¦å·æˆ–å…³è”çš„æ‰‹æœºå·ç é‚®ç®±æœ‰æ•ˆï¼Œåˆ‡æ¢åˆ°å…¶ä»–å‘ä»¶äººæ— æ•ˆï¼Œæ˜¯å¦ç»§ç»­åˆ‡æ¢ï¼Ÿ"),okText:l.t("ç»§ç»­åˆ‡æ¢"),ok:function(){h.setValue(r);var e=a.get({component:"notary"});e?e.setChecked(!1):i&&(i.toggle({close:!0}),o.extActive())},cancel:function(){}}):(h.setValue(r),b(r,!0))}else h.setValue(r),b(r,!0)}};r.address==d.address&&(u.checked=!0),i.push(u)}))}catch(e){d=new $.Email((0,s.$S)("uid")),s.$D.info("compose senderlist create error"+e)}return i}function x(t,a){var o,r=y(t),s=(n.default.getList(),t);s||(s=n.default.getDefault()),o=s.name;var c,d,u,m,p=(c=s.address,d=n.default.getUid(),u=n.default.getMobile(),m=!1,c==d.address&&(m=!0),null!==u&&c==u.address&&(m=!0),m),f={xtype:"component",hidden:!p,extcls:"yI0",items:[{xtype:"label",text:l.t("å‘ä¿¡æ˜µç§°:")},{xtype:"label",text:o},{xtype:"label",text:" "},{xtype:"input",hidden:!0,width:"100px",maxLength:12,value:o,listeners:{click:{handler:function(){$.Event.cancelBubble()}}}},{xtype:"link",cls:"nui-txt-link",text:l.t("ä¿®æ”¹"),click:function(){var t=this,a=t.getRoot().find("input")[0];if(t.getText()==l.t("ä¿®æ”¹")){var n=t.getRoot().find("label")[1];a.show(),a.select(),n.hide(),t.update({text:l.t("ç¡®å®š")}),$.Event.cancelBubble()}else{var o=$.String.trim(a.getValue());o&&Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(t){t.default.setDisplayName(o,(function(){var t=new g(s.address,o);h.setValue(t,!1,!0);var i=e.senderMenu,a=i.find("menuitem"),n=y(t);$.Array.each(a,(function(e,t){$.Array.each(n,(function(e,i){if(t.id==i.id)return t.update(i),$.BREAK}))}));var r=i.find("link");if(r&&r.length>0){var c=r[0],d=i.find("input")[0];d.hide();var u=i.getRoot().find("label")[1];u.show(),u.setText(o),d.setValue(u.getText()),c.update({text:l.t("ä¿®æ”¹")})}i.rawConfig.hiddenTime=1e3,i.setHiddenOnMouseOut()}))}))),$.Event.cancelBubble()}}}]};return{xtype:"menu",hidden:a,groups:[{items:r,checkType:"radio"},{items:[f,{text:l.t("è®¾ç½®å‘ä»¶äººæ˜µç§°"),hidden:p,click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"AccountCenterModule",exit:!1,inputName:"SectionSenderManage",address:s.address})})))}}]}],listeners:{hide:function(){var e=this,t=e.find("link");if(t&&t.length>0){var i=t[0];if(i.getText()!=l.t("ä¿®æ”¹")){var a=e.find("input")[0];a.hide();var n=e.getRoot().find("label")[1];n.show(),a.setValue(n.getText()),i.update({text:l.t("ä¿®æ”¹")})}}}}}}},getFooter:function(){var e=this.module,t=e.data,i=e.event,a=e.mailprotection,n=new $.Button({xtype:"button",text:l.t("å‘é€"),subclass:"mainBtn",tabindex:"1",icon:{type:"sent",subtype:"white"},click:function(){i.fireBar({func:"deliver",pos:"bottom"})}}),o=new $.Button({xtype:"button",tabindex:"1",text:l.t("&nbsp;å– æ¶ˆ&n"cancel",pos:"bottom"})}}),r=new $.Link({text:'<span class="Sky-gCmp-main-footer-mailtrace-icon disabled"></span><div class="Sky-gCmp-main-footer-mailtrace-text">'+l.t("é‚®ä»¶è¿½è¸ª")+'</div><b class="nui-ico nui-ico-unfold"></b>',cls:"Sky-gCmp-main-footer-mailtrace mkt_mailtrace_setting_tips nui-txt-link",click:function(t){$.Event.stop(t),e.mailtrace.settingsPopupShow(r,e.getDom("main"))}}),s=new $.Link({text:'<span class="Sky-gCmp-main-footer-mailprotection-icon disabled"></span><div class="Sky-gCmp-main-footer-mailprotection-text">'+l.t("æœºå¯†æ¨¡å¼")+"</div>",cls:"Sky-gCmp-main-footer-mailprotection mkt_mailprotection_setting_tips nui-txt-link",click:function(e){$.Event.stop(e),$.Log.cache({compose_mailprotection_settings_click:1}),a.tryEnable(this)}}),c=new $.Link({text:l.t("æ›´å¤šå‘é€é€‰é¡¹ ")+'<b class="nui-ico">j</b>',cls:"nui-txt-link",click:function(){i.extActive()}});t.set({component:"extLink",value:c}),t.set({component:"mailTraceLink",value:r}),t.set({component:"mailProtectionLink",value:s});var d="";$.Ext.mailTracking&&(d=r.html()+'<span class="eq2">|</span>');var u="";return $.Ext.mailProtection&&(u=s.html()+'<span class="eq2">|</span>'),'<footer class="jp0">'+n.html()+o.html()+'<div class="iu1">'+this.getSender()+'<div class="fq0"><span class="eq2">|</span>'+d+u+c.html()+"</div></div></footer>"},getSuccess:function(){var e=this.module;return'<div id="'+e.createId("succ")+'" class="frame-main-cont-body frame-main-cont-body-noToolbar nui-scroll uY0" style="display:none;top:0px;"><section id="'+e.createId("succMain")+'" class="sQ1"><h1 id="'+e.createId("succInfo")+'" \tclass="tK1" tabindex="1" role="tooltip"></h1><div id="'+e.createId("succTips")+'"class="tZ1" style="display:none;"></div><div id="'+e.createId("succStamp")+'" style="display:none;"></div><div id="'+e.createId("succOperate")+'" class="py1" role="navigation" tabindex="1" aria-label="'+l.t("å‘é€æˆåŠŸå¿«é€Ÿå¯¼èˆª")+'"></div><div id="'+e.createId("succAd")+'"class="tA1"></div></section></div>'},getHtml:function(){var e=this,t=e.module,i=t.createId("toolbar"),a=t.createId("main"),n=t.createId("mkttips");return'<header id="'+i+'" class="frame-main-cont-head">'+e.getToolbar()+'</header><div id="'+a+'"class="frame-main-cont-body nui-scroll"><section class="tH0"><div id="'+n+'" class="IT0"></div>'+e.getHeader()+e.getEditor()+e.getExtend()+e.getFooter()+"</section></div>"+e.getSuccess()},showMaketToolTips:function(){var e=$(".iC2"),t=this,i="compose_market_tool_entry_tips_showed"+(0,s.$S)("uid");$.LocalStorage.get(i)||(t.__markt_tool_tips_layer__&&t.__markt_tool_tips_layer__,h.cache({Compose_market_tool_tips_show:1},$.EMPTYFUNC),t.__markt_tool_tips_layer__?t.__markt_tool_tips_layer__.show():t.__markt_tool_tips_layer__=new $.Layer({renderTo:e,params:"arrUp",extcls:"es1",hasClose:!0,doNotHide:!0,content:'<span style="font-size: 14px;color: #333333;">'+l.t("ç½‘æ˜“é’é¸Ÿå•†é‚®ä¸ºæ‚¨æä¾›ç®€å•é«˜æ•ˆï¼Œå…¨é“¾è·¯è·Ÿè¸ªçš„å“ç‰Œé‚®ä»¶æ¨é€æœåŠ¡ã€‚")+"</span>",listeners:{closeclick:function(){t.__markt_tool_tips_layer__.destroy(),t.__markt_tool_tips_layer__=null,$.LocalStorage.set(i,"1"),h.cache({Compose_market_tool_tips_close:1},$.EMPTYFUNC)}}}))},PDFConvertTips:function(e){var t=this,i=e.ui.container.dom;new $.Link({text:l.t("å–æ¶ˆ"),cls:"nui-txt-link",click:function(){console.log("å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦")}}),new $.Link({text:l.t("ç«‹å³æŸ¥çœ‹"),cls:"nui-txt-link",click:function(){console.log("å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦")}}),["<div>","<p>",l.t("PDF æ ¼å¼è½¬æ¢ä¸Šçº¿äº†ï¼Œç‚¹å‡»ç«‹å³ä½“éªŒã€‚"),"</p>","<div>",l.t("PDF æ ¼å¼è½¬æ¢ä¸Šçº¿äº†ï¼Œç‚¹å‡»ç«‹å³ä½“éªŒã€‚"),"</div>","</div>"].join(""),t.__pdf_convert_tips__=new $.Layer({renderTo:i,params:"arrUp",extcls:"kO1",hasClose:!0,doNotHide:!0,content:"<div><p>"+l.t("PDF æ ¼å¼è½¬æ¢ä¸Šçº¿äº†ï¼Œç‚¹å‡»ç«‹å³ä½“éªŒã€‚")+"</p><div></div></div>",listeners:{closeclick:function(){t.__pdf_convert_tips__.destroy(),t.__pdf_convert_tips__=null}}})},popupCreator:function(e){var t=this,i=(t.module,{show:e.key+"_show",ok:e.key+"_ok_click",cancel:e.key+"_cancel_click",close:e.key+"_close_click",more:e.key+"_more_Target(e),t.smailGuideTips.getDom()))return;t.smailGuideTips.close()}}),10)}$.Popup.show({pauseTime:e.pauseTime||15e3,icon:e.icon,title:l.t(e.title),extcls:"Sky-gCmp-common-view-guide-popup",content:l.t(e.content),okText:l.t(e.okText),ok:function(){e.ok&&e.ok(),n(i.ok)},cancelText:!!e.cancelText&&l.t(e.cancelText),cancel:e.cancel?function(){e.cancel&&e.cancel(),n(i.cancel)}:void 0,close:function(){e.close&&e.close(),n(i.close)},onRender:function(){t.smailGuideTips=this,setTimeout((function(){$.Event.listen(document.body,"click",o)}),500),n(i.show)},listeners:[{name:"destroy",handler:function(){t.smailGuideTips=null,$.Event.unlisten(document.body,"click",o)}}]})}};d.inherit(v,a.Z),d.extend(v.prototype,b),t.Z=v},81302:function(e,t,i){var a=i(99626),n=i(72957),o=$.Object,r=$.createClass((0,n.$N)("module.mbox.BrandListener"));function s(e){var t=this.module,i=t.view,a=e.Tag;if(a&&a.changed){var r=a.info.stats;if(r){var s=!1;o.each(r,(function(e,t){if((0,n.$I)("init.Tag").get(e,"brand"))return s=!0,$.BREAK})),s&&(t.container.innerHTML=i.getHtml(),$.Component.setEvents())}}}o.mix(r,a.Z,null,{_listeners:{"sync:request":{handler:s},"sync:cache":{handler:s}}}),t.Z=r},68634:function(e,t,i){var a=i(81302),n=i(34540),o=i(28978),r=i(72957),s=$.createClass((0,r.$N)("module.mbox.BrandModule"));$.Object.mix(s,o.Z,{View:n.Z,Listener:a.Z},{logPrefix:"brand",init:function(){var e=this.view;try{e.initQRCode()}catch(e){}},cache:function(){},reset:function(){return!0},initialize:function(){}})},34540:function(e,t,i){i(803),i(66403),i(87553),i(37092),i(92274);var a=i(32073),n=i(7.mbox.BrandView"),c=$.Event,l=$.Ajax,d=$.createClass((0,n.$N)("module.mbox.BrandView"));$.Object.mix(d,a.Z,{},{QRHerf:null,QRLayer:null,getHtml:function(){var e,t=this,i=t.module,a=o.Z.getMatch(),c=[],d=[];d[d.length]='\t\t\t\t<div class="re0 nui-scroll" style="height:98%">\t\t\t\t\t<h1 class="ly0">'+s.t("å“ç‰Œåˆ†ç±»")+'</h1>\t\t\t\t\t<div class="iY0">\t\t\t';var u=function(){for(var n,l=[],d=t.QRHerf=[],u=i.createId("ImgUl"),m=0,f=a.length;m<f;m++){var h=a[m];if(h.logo1){var g=o.Z.get(h.id,"brand",!0),v=o.Z.getInfo(g.name,"unread"),b=o.Z.getInfo(g.name),y=h.largeTwoDimenCode||"",x=h.smallTwoDimenCode||"";l[l.length]='<li class="fh0">';var k='<span class="bF0"><img src="'+h.logo1+'" alt="'+h.name+'" /></span><span class=lass="bx0 nui-txt-cLink">'+v+s.t("å°æœªè¯»")+"</span>":'<span class="bx0">'+b+s.t("å°é‚®ä»¶")+"</span>",x&&(k+='<span class="cz1"><img src="'+x+'" width="20" height="20" /></span>');var S=new $.Link({text:k,extcls:"cD0",click:function(e){return function(){p(h.statId),r.default.entry({tag:[e.name]},{type:"list",subtype:"tag"})}}(g)});l[l.length]=S.html(),l[l.length]="</li>",c.push(h.statId),e||(e=h.openUrl),y&&d.push({link:S,image:y})}}return l.length>0&&(n='<ul class="iZ0" id="'+u+'">'+l.join("")+"</ul>"),n}(),m=function(){for(var t,i=[],n=0,s=a.length;n<s;n++){var l=a[n];if(!l.logo1){var d=o.Z.get(l.id,"brand",!0),u=o.Z.getInfo(d.name,"unread");i[i.length]='<li class="hz0">',i[i.length]=new $.Link({text:l.name+(u>0?" ("+u+")":""),extcls:"dY0",click:function(e){return function(){p(l.statId),r.default.entry({tag:[e.name]},{type:"list",subtype:"tag"})}}(d)}).html(),i[i.length]="</li>",c.push(l.statId),e||(e=l.openUrl)}}return i.length>0&&(t='<ul class="nt0">'+i.join("")+"</ul>"),t}();return u&&(d[d.length]=u),u&&m&&(d[d.length]='<div class="nx0"></div>'),m&&(d[d.length]=m),d[d.length]="\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t",e&&c.length>0&&$.Thread.delay((function(){l.request({requestType:$.Ajax.IFRAME,url:e,body:{statId:c.join(),uid:(0,n.$S)("uid")}})})),t.addHeader(null,d.join(""),"frame-main-cont-body-second-brand");function p(e){$.Log.record("brandClick",e)}},initQRCode:function(){var e=this,t=e.module,i=e.QRLayer,a=t.getEl("ImgUl");a.listen("mouseover",$.Function.bind(e.showQRCode,e)),a.listen("mouseout",(function(){try{i.hide()}catch(e){}})),c.listen(a.dom.parentNode.parentNode,"scroll",(function(){try{i.hide()}catch(e){}}))},showQRCode:function(){for(var e,t=this,i=$.Event.getTarget(),a=!0,n=t.QRLayer;i&&"UL"!=i.tagName;){if("A"===i.tagName){e=i;break}i=i.parentNode}if(e)for(var o=t.QRHerf,r=0,s=o.length;r<s;r++){var c=o[r];if(e===c.link.getEl().dom){var l=c.image,d=!1;if(t.QRLayer){var u=n.getEl().find("IMG").dom;u.src!=l&&(u.src=l,d=!0)}else n=t.QRLayer=new $.Layer({text:'<img src="'+l+'" width="200" height="200"/>',params:["arrRight"],renderTo:document.body,fixY:40}),d=!0;n.show(),d&&n.pointTo(e,document.body),a=!1;break}}if(a)try{n&&n.hide()}catch(e){}},initialize:function(e){}}),t.Z=d},56301:function(e,t,i){var a=i(72957),n=new a.c1("module.mbox.Field"),o=$.Object,r=$.createClass((0,a.$N)("module.mbox.Field"));o.extend(r,{fields:{title:{key:"subj",title:n.t("ä¸»é¢˜"),value:2},sender:{key:"from,to",title:n.t("å‘ä»¶äºº+æ”¶ä»¶äºº"),value:1},sendtitle:{key:"from,subj",title:n.t("å‘ä»¶äºº+ä¸»é¢˜"),value:4},default:{key:"from,to,subj,cont,aname",title:n.t("ä¸»é¢˜+æ­£æ–‡"),value:0},all:{key:"from,to,subj,cont,aname,acont",title:n.t("ä¸»é¢˜+æ­£æ–‡+é™„ä»¶"),value:3}},dateDiff:[{name:n.t("ä¸‰å¤©å†…"),diff:3},{name:n.t("ä¸€å‘¨å†…"),diff:7},{name:n.t("ä¸€æœˆå†…"),diff:30},{name:n.t("ä¸‰æœˆå†…"),diff:90},{name:n.t("ä¸‰æœˆå‰"),diff:1e5}],_dateInited:!1,getField:function(e){void 0===e&&(e=$.Ud.get({field:"ntes_inbox",flag:"search_type"})-0);var t="",i=this.fields;return o.each(i,(function(i,a){if(e===a.value)return t=a.key,$.BREAK})),t},getFields:function(){return r.fields},getDateDiff:function(){var e=r.dateDiff;if(!r._dateInited){var t=(0,a.$I)("util.Misc").getTime(e(t,-i.diff);a.setHours(23),a.setMinutes(59),a.setSeconds(59),i.date=new Date(1e3*Math.floor(a.getTime()/1e3)+999),i.count=0})),r._dateInited=!0}return e},setDefaultFields:function(e){var t=e.module.createId("searchFiledRadio"),i=[],a=($.Ud.get({field:"ntes_inbox",flag:"search_type"}),"\t\t\t\t\t"+o(2,"title",n.t("ä¸»é¢˜"))+"\t\t\t\t\t"+o(1,"sender",n.t("å‘ä»¶äºº+æ”¶ä»¶äºº"))+"\t\t\t\t\t"+o(4,"sendtitle",n.t("å‘ä»¶äºº+ä¸»é¢˜"))+"\t\t\t\t\t"+o(0,"default",n.t("ä¸»é¢˜+æ­£æ–‡"),!0)+"\t\t\t\t\t"+o(3,"all",n.t("ä¸»é¢˜+æ­£æ–‡+é™„ä»¶"),!1)+"\t\t");function o(e,a,o,r,s){var c=e===a-0,l=(c?"<strong>"+o+"</strong>":o)+(r?'<span class="nui-txt-mark">'+n.t("(æ¨è)")+"</span>":""),d=new $.Radio({text:l,value:a,name:t,checked:c});return i.push(d),d.html()+"<br/>"}$.Msgbox.show({type:"confirm",content:a,title:n.t("è¯·é€‰æ‹©é»˜è®¤æœç´¢èŒƒå›´"),header:n.t("è®¾ç½®é»˜è®¤æœç´¢èŒƒå›´"),ok:function(){for(var t,a,n=r.getFields(),o=0,s=i.length;o<s;o++){var c=i[o];if(c.checked){t=n[a=c.value];break}}$.Ud.set({field:"ntes_inbox",flag:"search_type",value:t.value}),e.additionalSearch("scope",a)}}),$.Radio.group(i),$.Component.setEvents()}}),t.Z=r},36903:function(e,t,i){i(803),i(55737),i(8600),i(99139),i(42295),i(34994),i(52963),i(87553),i(66403),i(32021),i(79150),i(48868),i(92274),i(63045),i(81874),i(54861),i(15761),i(20869),i(63518),i(75654),i(26340),i(75093),i(13616),i(37092);var a=i(71591),n=i(67979),o=i(92066),r=i(83123),s=i(81229),c=i(72957),l=new c.c1("module.mbox.Letter"),d=$.Object,u=$.Array,m=$.String,p=$.Function,f=$.Event,h=$.Date,g=$.Browser,v=(0,c.$I)("util.Misc"),b=g.isIE(6),y=g.isIE("<9"),x=!!g.chrome(),k=$.createClass((0,c.$N)("module.mbox.Letter"));d.extend(k,{dom:null,attribute:{className:"rF0",tabIndex:0},checkboxTitle:[l.t("é€‰ä¸­æ­¤é‚®ä»¶"),l.t("å–æ¶ˆé€‰ä¸­")],sendStatus:[l.t("éƒ¨åˆ†æˆåŠŸ"),l.t("å‘é€æˆåŠŸ"),l.t("å‘é€ä¸æˆåŠŸ"),l.t("é‚®ä»¶å‘é€ä¸­")],rclStatus:[l.t("éƒ¨åˆ†æˆåŠŸ"),l.t("æ’¤å›æˆåŠŸ"),l.t("æ’¤å›ä¸æˆåŠŸ"),l.t("é‚®ä»¶æ’¤å›ä¸­")],systemUrl:"https://mimg.127.net/p/images/ibx/cx/",config:function(){if(!k.dom){var e=b?"A":"DIV",t=document.createElement(e);k.dom=t}}}),d.extend(k.prototype,{data:null,isThread:!1,isDefer:!1,id:n1,componentInited:!1,checked:!1,today:!1,expire:!1,mailTrackStats:{unread:!1,read:!1},mailTrackTooltip:null,initDom:function(e){var t=this,i=k.dom.tagName,a=d.clone(k.attribute);if(d.extend(a,t.getAttribute()),a.sign="letter",b&&(a.href="#",a.onclick="return false;"),t.id=a.id,e){var n=[],o="";for(var r in a){var s=a[r];switch(r){case"className":n.push('class="'+s+'"');break;case"tabIndex":n.push('tabindex="'+s+'"');break;case"innerHTML":o=s;break;case"title":case"aria-label":s=m.encodeHTML(s);default:n.push(r+'="'+s+'"')}}t.html=["<",i," ",n.join(" "),b?' href="javascript:void(0)"':"",">",o,"</",i,">"].join("")}else{var c=t.div=k.dom.cloneNode(!0);for(r in a)s=a[r],"aria-label"===r||"sign"===r?c.setAttribute(r,a[r]):c[r]=s}setTimeout((function(){!t.isThread&&t.updateDaTag()}),200)},getAttribute:function(){var e=this,t=e.view,a=t.config,n=t.module,d=(n.teamMemberMap,n.extend("type"),n.extend("subtype")),u="folder"===d,f={},h=e.components,g=n.param("fid"),v=e.data,b=v.fid,x=v.flags,S=v.id,w=e.nodes,T=v.threadMessageCount,C=e.isThread,_=[k.attribute.className],I="full"===d,A=void 0!==v.summary,M=I,L=A&&!M,E=A?v.summary:"",D="",R=x.deferHandle,P=e.expire,F=t.getLayout(),j=n.createId(S+(new window.Date).getTime()),N=e.getTaskInfo(v.tag||[]),U=e.getSendLogo(v),K=3===v.fid&&3!==v.rclStatus&&U&&U.ext&&(1===U.ext.status||3===U.ext.status),O=j+"Dom";if(f.id=O,f.role="link",!g){var Y=n.param("fids");1===Y.length&&(g=Y[0])}x.read||_.push("kw0"),x.top&&_.push("oh0"),R&&(_.push("oU1"),P&&_.push("gv0"));var B,H,G=w.drag=j+"DragDiv",z=w.dragitem=j+"DragB",q=w.checkbox=j+"CheckboxB",Z=w.logo=j+"LogoB",V=(w.trash=j+"TrashB",w.flag=j+"FlagB");u&&!P||(B=w.folder=j+"FolderSpan",H=w.subject=j+"SubjectSpan");var W=w.tag=j+"TagDiv",J=w.taskInfo=j+"TaskInfoDiv",X=w.daTag=j+"DaTagDiv",Q=w.task=j+"TaskDiv",ee=(w.defer=j+"DeferB",w.date=j+"DateDiv"),te=w.mid=j+"MidDiv",ie=w.end=j+"EndDiv";if(M)var ae=w.summary=j+"SummaryDiv";var ne=[];ne[ne.length]='<div class="nl0 hA0'+(!E||I?" ck0":"")+'">';var oe=[];oe[oe.length]='<div class="gB0" sign="start">',y||(oe[oe.length]=['<div class="dS0" id="',G,'"><b class="nui-ico nui-ico-drag" id="',z,'"></b></div>'].join("")),oe[oe.length]=['<label aria-checked="false" sign="checkbox" class="nui-chk cS0" title="'+l.t("é€‰ä¸­æ­¤é‚®ä»¶")+'" role="checkbox" tabIndex="0" aria-label="'+l.t("é€‰ä¸­æ­¤é‚®ä»¶")+'"><span class="nui-chk-symbol"><b class="nui-ico nui-ico-checkbox" id="',q,'"></b></span></label>'].join("");var re=e.getLogoInfo().config;re.sub?oe[oe.length]=['<b class="dT0 nui-ico nui-ico-hasSub nui-ico-',re.type,'" title="',re.title,'" tabindex="-1" aria-label="',re.title,'" sign="logo" id="',Z,'"><b class="nui-ico-sub nui-ico-sub-',re.sub,'"></b></b>'].join(""):oe[oe.length]=['<b class="dT0 nui-ico nui-ico-',re.type,'" title="',re.title,'" tabindex="-1" aria-label="',re.title,'" ',re.url?' style="background-image:url('+re.url+')"':"",' sign="logo" id="',Z,'"></b>'].join("");var se=e.getPriorityInfo();if(se&&(oe[oe.length]=['<b class="cR0 nui-ico nui-ico-mailLv nui-ico-',se[0],'" title="',se[1],'" tabindex="-1" aria-label="',se[1],'"></b>'].join("")),K)try{var ce=new $.Component({html:e.getMailTrack(v.tag)});h.mailTrack=ce,oe[oe.length]=ce.html()}catch(e){}v.ctrls&&v.ctrls.encrypt&&(oe[oe.length]=e.getMailEncryptIcon()),oe[oe.length]='<div class="dP0'+(K?" ca1":"")+'" sign="start-from">';var le=2===g||3===g?v.to:v.from;m.has(le,"@netease>")&&(le=le.replace(/@netease>/gi,"@netease.com>"));var de=$.Uri.getEmails(le,void 0,!0),ue=de.match;0===ue.length&&(de.wrong.length>0?ue.push({name:le,address:null}):ue.push({name:l.t("(æœªå¡«å†™)"),address:null}));for(var me=[],pe=[],fe=h.userlabel=[],he=0,ge=ue.length;he<ge;he++)try{var ve=ue[he],be=!1;if(v.ctrls&&v.ctrls.plus){var ye=v.ctrls.plus,xe=ve.address,ke=xe.split("@")[0],$e=xe.split("@")[1],Se=ye.split("_"),we=Se[0];Se[1]===s.default.encode(ke+we+$e)&&(be=!0)}var Te=!1,Ce="",_e=null,Ie=!1,Ae="",Me=null;v.tag&&v.tag.length&&$.Array.each(v.tag,(function(e,t){t.match(/^%ex_tc_logo_(.+)%$/)&&(v.teamInfo&&v.teamInfo.teamName&&(Ce=v.teamInfo.teamName),Te=!0,_e=v.teamInfo),t.match(/^%ex_mkt_logo_(.+)%$/)&&(v.mktInfo&&0!==v.mktInfo.status&&(Ae=v.mktInfo.ename,Ie=!0),Me=v.mktInfo)}));var Le=new $.UserLabel({email:ve,plus:be,extcls:"ci0",popupRenderTo:n.scroller,lazyListen:!0,noListen:!0,mid:S,team:Te,mkt:Ie,teamTitle:Ce,mktTitle:Ae,isThread:e.isThread});!e.isThread&&Me&&1===Me.status?Le.setExtLink($.Link.html({text:"@"+Me.ename+Me.extInfo,click:function(){$.Log.cache({mbox_userlabel_marketing_click:1}),open(Me.link,"_blank")}})):_e&&Le.setExtLink($.Link.html({text:"@"+_e.teamName+_e.extInfo,click:function(){$.Log.cache({mbox_userlabel_team_click:1}),open(_e.link,"_blank")}})),fe.push(Le),pe[pe.length]=Le.html(),me.push(Le.rawConfig.name)}catch(e){console.log(e),c.$D.info({text:l.t("æ˜¾ç¤ºå‘ä»¶äººå‡ºé”™"),error:e})}oe[oe.length]=pe.join(l.t("ï¼Œ")),oe[oe.length]="</div>";var Ee=v.label0;oe[oe.length]=['<div class="dU0" title="',Ee>0?l.t("ç‚¹å‡»å–æ¶ˆæ——å¸œ"):l.t("è®¾ä¸ºçº¢æ——"),'" style="',Ee>0&&"l-r"==F?"visibility:visible":"",'" role="button" tabindex="-1" aria-label="',Ee>0?l.t("ç‚¹å‡»å–æ¶ˆæ——å¸œ"):l.t("è®¾ä¸ºçº¢æ——"),'" sign="flag"><b class="nui-ico nui-ico-flag nui-ico-flag-',Ee,'" id="',V,'"></b></div>'].join(""),_.push("nui-txt-flag"+Ee),oe[oe.length]="</div>",ne[ne.length]=oe.join("");var De=[];if(De[De.length]=['<div class="il0" id="',te,'">'].join(""),!x.deferHandle){try{if($.Ext.memo&&v.memo){var Re=h.memo=new $.Memo({content:m.encodeHTML(v.memo),modify:p.bind(e.modifyMemo,e),extcls:"iu0",lazyListen:!0,noListen:!0});De[De.length]=Re.html()}}catch(e){c.$D.info(e)}try{if($.Ext.scheduleMbox&&(0,c.$S)("schedule")&&(0,c.$S)("schedule")[S]){var Pe=h.schedule=new $.Schedule({mid:S,extcls:"iu0",lazyListen:!0,noListen:!0});De[De.length]=Pe.html()}}catch(e){c.$D.info(e)}}var Fe=function(e){var t=n.getKeyword();if(t)try{var i=new RegExp("("+t+")","ig");e=e.replace(i,'<b class="ch0">$1</b>')}catch(e){}return e}(v.subject?function(t){if(!e.isThread)return t;try{var i,a,n,o,r={type:"Re"},s={type:"Fw"};if(i=/(re|reply|å›å¤|ç­”å¤)[:|ï¼š]/gi,a=/(fw|forward|è½¬å‘)[:|ï¼š]/gi,n=/^(re|reply|å›å¤|ç­”å¤)[:|ï¼š]/gi,o=/^(fw|forward|è½¬å‘)[:|ï¼š]/gi,r.isFirst=n.test(t),s.isFirst=o.test(t),!r.isFirst&&!s.isFirst)return t;var c=[];l(i,r),l(a,s),(r.count>1||s.count>1)&&(d(i,r),d(a,s),s.isFirst&&c.reverse(),t=c.join(":")+":"+m.trim(t).replace(/^(&nbsp;|_)+/;(a=t.match(e))&&(i.count=a.length)}function d(e,i){i.count>0&&(i.handle=!0,c[c.length]=i.type+(i.count>1?"("+i.count+")":""),t=t.replace(e,""))}}(m.encodeHTML(v.subject)):l.t("(æ— ä¸»é¢˜)"));Fe=r.Z.fix(Fe);var je=M?m.encodeHTML(m.stripTags(E)):m.stripTags(Fe);if(4===v.fid&&4!==g&&(Fe="<del>"+Fe+"</del>"),v.ctrls&&v.ctrls.at){var Ne,Ue=window.decodeURIComponent(v.ctrls.at).split(",");for(he=0;he<Ue.length&&!Ne&&Ue[he];he++)if(!(Ne=Ue[he].toLowerCase()==(0,c.$S)("uid").toLowerCase())&&v.accounts)for(var Ke=0;Ke<v.accounts.length&&!Ne&&Ue[he]&&v.accounts[Ke];Ke++)Ne=Ue[he].toLowerCase()==v.accounts[Ke].toLowerCase();Ne&&(Fe='<span class="ig1">'+l.t("@æˆ‘")+"</span>"+Fe)}Fe+='<span class="kP2" id="'+J+'">',N.id&&(Fe+=e.getMailTaskInfoHTML()),Fe=['<span class="da0"',H?' id="'+H+'"':"",">",Fe+="</span>","</span>"].join("");var Oe=!u||P?['<span class="nui-txt-tips nui-txt-s12 dL0" id="',B,'">[',o.Z.get(v.fid).name,"]</span>"].join(""):"",Ye=C&&T>1?['<span class="bL0" title="'+l.t("å…± "),T,l.t(" å°ä¼šè¯")+'">',T,"</span>"].join(""):"",Be=L?['<span class="dd0">',r.Z.fix(m.encodeHTML(E)),"</span>"].join(""):"";v.tag&&v.tag.length>0&&(D='<span id="'+X+'" class="jA1" style="display:none;"></span>'),De[De.length]=[Oe,Fe,Ye,Be,D].join(""),De[De.length]="</div>",ne[ne.length]=De.join("");var He=[];if(He[He.length]=['<div class="hV0" id="',ie,'">'].join(""),a.sizeShow){var Ge=$.Number.convert(v.size,1);He[He.length]=['<div class="es0" title="'+l.t("é‚®ä»¶å¤§å°ä¸º"),Ge,'">',Ge,"</div>"].join("")}var ze=e.getDateInfo();He[He.length]=['<div id="',ee,'" class="eO0',ze.important?" bS0":"",'" title="',ze.title,'">',ze.value,"</div>"].join("");var qe="",Ze="",Ve="";x.linkAttached||($.Ext.newAttach?x.realAttached:x.attached)?x.linkAttached?(qe="nui-ico-bigAtt",Ze=l.t("æ­¤é‚®ä»¶åŒ…å«è¶…å¤§é™„ä»¶")):(qe="nui-ico-att",Ze=l.t("æ­¤é‚®ä»¶åŒ…å«é™„ä»¶")):Ve=' style="display: none"',He[He.length]=['<div class="nui-ico ',qe,' dQ0" title="',Ze,'"',Ve,"></div>"].join(""),x.deferHandle&&v.defer&&(He[He.length]=['<b class="cC0 nui-ico nui-ico-delete fake-position"  title="'+l.t("ç‚¹å‡»åˆ é™¤é‚®ä»¶")+'"></b>','<b class="cT0 nui-ico nui-ico-todo nui-ico-todo-selected fake-position"></b>'].join("")),He[He.length]="</div>",ne[ne.length]=He.join("");try{if($.Ext.tag){var We=[],Je=(0,c.$I)("init.Tag"),Xe=v.tag,Qe="";if(Xe){var et=h.tag=[];for(he=0,ge=Xe.length;he<ge;he++)try{var tt=m.trim(Xe[he]),it=Je.get(tt);if(it){var at=new $.Tag({text:it.alias,type:it.color,attrs:"hasClose",click:function(e){return function(){Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(t){t.default.entry({tag:[e]})}),this))}}(tt),closeclick:function(e,i){return function(){t.setTag(!1,e,[i])}}(tt,e),lazyListen:!0,noListen:!0});We[We.length]=at.html(),et.push(at)}}catch(e){c.$D.info(e)}}else Qe=' style="display:none"';if(We.push('</div><div class="hq1" id="'+Q+'">'),N.id){try{var nt=new $.Component({html:e.getMailTask()});h.task=nt,We.push(nt.html())}catch(e){console.log(e)}Qe=' style="display:"'}We.unshift(['<div class="im0" ',Qe,' sign="tag" tabindex="-1"><div class="kM1" id="',W,'">'].join("")),We.push("</div></div>"),ne[ne.length]=We.join("")}}catch(e){c.$D.info(e)}if(ne[ne.length]="</div>",M){var ot=[],rt=e.getSummary(E);ot[ot.length]='<div class="nl0 fQ0">',ot[ot.length]=['<div class="il0" id="',ae,'">',rt,"</div>"].join(""),ot[ot.length]='<div class="hV0">&nbsp;</div>',ot[ot.length]="</div>",ne[ne.length]=ot.join("")}if(f.className=_.join(" "),f.innerHTML=ne.join(""),!y){var st=2===b||3===b?l.t("æ”¶ä»¶äºº"):l.t("å‘ä»¶äºº");f["aria-label"]=m.decodeHTML([je,st,l.t("ï¼š"),me.join(),l.t("æ—¶é—´ï¼š"),ze.title].join(" "))}return f},getLogoInfo:function(){var e=this,t=e.view.config,i=e.data,a=i.flags,n=i.fid,o=function(){var o=t.isTop&&a.top?["top",l.t("ç½®é¡¶")]:null;if(o)return o;var r=e.getSendLogo();if(r)return r;var s=a.system?["ntes",l.t("ç½‘æ˜“ç³»ç»Ÿé‚®ä»¶")]:null;if(i.ctrls&&i.ctrls.RulesType&&!u.has([5,7,18],i.fid)){var c=i.ctrls.RulesType.split(";")[0];c.indexOf("_")>-1?c=c.split("_")[1]:"ntessys"!==c&&(i.ctrls.RulesType=null),c&&(s="ntessys"===c?["ntes",l.t("ç½‘æ˜“è¯šä¿¡é‚®ä»¶è”ç›Ÿè®¤è¯é‚®ä»¶")]:["integrity",l.t("ç½‘æ˜mUrl+c+".gif"])}if(s)return s;var d=a.encrypted?["encrypt",l.t("åŠ å¯†é‚®ä»¶")]:null;if(d)return d;var m=a.scheduleDelivery?["regular",l.t("å®šæ—¶å‘ä¿¡")]:null;if(m)return m;var p=2===n&&a.draft?["draft",l.t("è‰ç¨¿")]:null;if(p)return p;var f=e.getReFwLogo();if(f)return f;var h=e.getSmartLogo();if(h)return h;var g=e.getReadLogo();return g?(e.isNormalLogo=!0,g):void 0}();return o.config={type:o[0],title:o[1],url:o[2],sub:o[3]},o},getSendLogo:function(){var e=this.data,t=e.flags;if(3!==e.fid||this.isThread)return null;var i,a,n,o,r,s=null;if(($.Ext.letterRecall||$.Ext.letterRecall_vip)&&e.recallable){i="recall";var c=e.rclStatus,l=k.rclStatus;c&&c>0&&(c<3?(a=l[3],n=0):3===c?(a=l[1],n=1,r="suc"):4===c?(a=l[2],n=2,r="err"):5===c&&(a=l[0],n=3,r="pause"))}if(a&&i)o="recall";else{var d=e.composeExtra,u=d&&d.showOneRcpt;i=u?"sendSeparate":"mail";var m=e.sndStatus;if("number"!=typeof m){var p=t.rcptQueued,f=t.rcptSucceed,h=t.rcptFailed;(p||f||h)&&(m=f?h?5:3:h?4:1,e.sndStatus=m)}else 3===m&&t.rcptFailed&&(m=4);if("number"==typeof m){var g=k.sendStatus;m<3?(a=g[3],r="ing",n=0):3===m?(a=g[1],r=u?"sepaSucc":"suc",n=1):4===m?(a=g[2],r="err",n=2):5===m&&(a=g[0],r="part",n=3)}o="send"}return a&&i&&((s=[i,a,null,r]).ext={status:n,type:o}),s},getReFwLogo:function(){if(this.isThread)return null;var e=this.data.flags,t=e.replied&&e.forwarded?["refw",l.t("å›å¤ä¸”è½¬å‘")]:null,i=e.replied?["re",l.t("å·²å›å¤")]:null,a=e.forwarded?["fw",l.t("å·²è½¬å‘")]:null;return t||i||a||null},getReadLogo:function(){var e=this.data.flags,t=this.isThread,i=e.popRead;return e.read?["read",l.t("å·²è¯»")]:t?["unreadThread",l.t("æœªè¯»")]:i?["unreadPop",l.t("å·²è¢«é‚®ä»¶å®¢æˆ·ç«¯ï¼Œå…¶ä»–é‚®ç®±ä»£æ”¶æˆ–æ‰‹æœºç­‰é€šè¿‡POP3åè®®æ”¶å–")]:["unread",l.t("æœªè¯»")]},getSmartLogo:function(){var e=(0,c.$I)("init.Tag"),t=this.data.tag,i=null;if(t)for(var a=0,n=t.length;a<n;a++){var o=t[a],r=e.get(o,"smart");if(r){var s=e.smarts[r.alias];i=["category-"+s.index,s.name]}}return i},getPriorityInfo:function(){var e,t,i=this.data.priority;if(i<3?(e="mailLv-1",t=l.t("ç´§æ€¥")):i>3&&(e="mailLv-3",t=l.t("ç¼“æ…¢")),e&&t)return[e,t]},getDateInfo:function(){var e,t,i=this,a=i.data,n=i.isDefer,o=i.expire,r=i.today,s=n&&a.defer?a.defer:a.sentDate;if(o)t=e=r?l.t("ä»Šæ—¥å¤„ç†"):l.t("å°šæœªå¤„ç†");else{var d=(0,c.$I)("init.Defer");t=h.format(s,l.t("yyyyå¹´Mæœˆdæ—¥ HH:mm (æ˜ŸæœŸw)"));var u=d.getDate("yesterday"),m=d.getDate("today"),p=s.getYear(),f=s.getMonth(),g=s.getDate();e=p===m.getYear()&&f===u.getMonth()&&g===u.getDate()?l.t("æ˜¨æ—¥"):p===m.getYear()?f===m.getMonth()&&g===m.getDate()?h.format(s,"HH:mm"):h.format(s,l.t("Mæœˆdæ—¥")):h.format(s,"yyyy-MM-dd"),n&&(e+=l.t("å¤„ç†"),t+=l.t("å¤„ç†"))}return{important:o&&!r,title:t,value:e}},getSummary:function(e){return e?e.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/&lt;b&gt;/gi,'<span class="nui-txt nui-txt-mark">').replace(/&lt;\/b&gt;/gi,"</span>"):""},getMailTrack:function(e){var t=this,i=t.view,a=t.mailTrackStats.read,n=t.mailTrackStats.unread,o=t.data,r="";function s(a){return{mouseover:{handler:function(n){var r=o.id;t.mailTrackTooltip||(t.mailTrackTooltip=i.mailtrack.initTooltip(a,t,n.target,e,r)),t.mailTrackTooltip.show()}},mouseout:{handler:function(){try{o.id,t.mailTrackTooltip&&(setTimeout((function(){t.mailTrackTooltip.hide()}),1e3),i.mailtrack.openNPS())}catch(e){}}}}}var c="";switch(e&&e.length&&(e.includes("%ex_trace_read%")?c="read":e.includes("%ex_trace_unread%")&&(c="unread")),c){case"read":r='<div class="Sky-gIbx-mailtrack-letter-icon">'+new $.Icon({type:"mailTracking-read",listeners:s("read")}).html()+"</div>",i&&!a&&i.module.log("mailtrack","letter_read_icon_show"),t.mailTrackStats.read=!0;break;case"unread":r='<div class="Sky-gIbx-mailtrack-letter-icon">'+new $.Icon({type:"mailTracking-unread",listeners:s("unread")}).html()+"</div>",i&&!n&&i.module.log("mailtrack","letter_unread_icon_show"),t.mailTrackStats.unread=!0;break;default:r='<div class="Sky-gIbx-mailtrack-letter-icon"></div>'}return r},getMailEncryptIcon:function(){var e=this,t=e.view;return e.data,'<div class="Sky-gIbx-encrypt-letter-icon">'+new $.Icon({type:"MailSafe",listeners:{mouseover:{handler:function(i){var a=!0;e.div&&e.div.offsetTop<30&&(a=!1),e.encryptLayer||(e.encryptLayer=new $.Layer({content:"<div>å·²å¼€å¯æœºå¯†æ¨¡å¼åŠŸèƒ½</div>",renderTo:t.module.scroller||document.body,pointTo:i.target,params:a?"arrDown":"arrUp",hidden:!0,extcls:"mk1"})),e.encryptLayer.show(),$.Log.cache({mbox_mail_encrypt_layer_show:"1"})}},mouseout:{handler:function(){var t=e.encryptLayer;t&&t.hide()}}}}).html()+"</div>"},getMailTask:function(){var e=this,t=e.view,i=e.data,a=e.getTaskInfo(i.tag||[]),n=[];if(!t.isTeamMember)return"";if(a.isOriginMail){if("done"===a.status){var o=new $.Link({text:l.t("å·²å®Œæˆ"),cls:"If0"});n.push(o.html())}}else if(a.isTaskExecutor)if("todo"===a.eStatus){var r=new $.Link({text:l.t("å®Œæˆä»»åŠ¡"),cls:"If0 Fr0",click:function(i){r.isLoading||(t.updateTaskStatus(e,"done",(function(){e.lazyInit(),r.isLoading=!0})),$.Log.cache({mbox_mail_t;n.push(r.html())}else if("done"===a.eStatus){var s=new $.Link({text:'<span class="text-task-front">'+l.t("å·²å®Œæˆ")+'</span><span class="text-task-back">'+l.t("é‡æ–°æ‰“å¼€")+"</span>",cls:"If0",click:function(){s.isLoading||(t.updateTaskStatus(e,"todo",(function(){e.lazyInit(),s.isLoading=!0})),$.Log.cache({mbox_mail_task_status_toggle:"todo"}))}});n.push(s.html())}return n.join("")},getMailTaskInfoHTML:function(){var e=this,t=e.view.module,i=e.data,a=e.getTaskInfo(i.tag||[]),n=t.teamMemberMap||{},o="";if(a.id){if(o+='<span class="eX1" title="'+l.t("è¯¥é‚®ä»¶ä¸ºä»»åŠ¡é‚®ä»¶")+'">'+l.t("ä»»åŠ¡é‚®ä»¶")+"</span>",a.executorList&&a.executorList.length){var r=[],s=!1;$.Array.each(a.executorList,(function(e,t){var i=n[t.uid]||{},o=i.name||i.email;a.tid&&a.tid===i.tid&&(s=!0),o&&r.push(o)}));var c=new $.Icon({type:"member"});o+=s?'<span class="fq1" title="'+l.t("ä»»åŠ¡è´Ÿè´£äººï¼š")+r.join("ï¼Œ")+'">'+c.html()+r.join("ï¼Œ")+"</span>":'<span class="fq1">'+c.html()+l.t("å·²ç¦»èŒ")+"</span>"}a.isOriginMail?a.isExpired&&(o+='<span class="If0 ym2">'+l.t("å·²é€¾æœŸ")+"</span>"):!a.isExpired||a.isTaskExecutor&&"done"===a.eStatus||(o+='<span class="If0 ym2">'+l.t("å·²é€¾æœŸ")+"</span>")}return o},lazyInit:function(e){var t=this;if(!t.inited){for(var i=(e=t.getDiv(e)).getElementsByTagName("*"),a=t.nodes,n=d.count(a),o=0,r=0,s=i.length;r<s;r++){var c=i[r],l=c.id;if(d.each(a,(function(e,t){if(t===l)return a[e]=c,o++,$.BREAK})),o===n)break}t.inited=!0}},initMemo:function(){var e=this,t=e.components.memo;t||(t=e.components.memo=new $.Memo({renderTo:e.nodes.mid,renderBy:"prepend",content:m.encodeHTML(e.data.memo||""),modify:p.bind(e.modifyMemo,e),extcls:"iu0"}))},mouseover:function(e){var t=this,i=t.view,a=i.module;if(a.getDom("ListDiv"),t.lazyInit(e.div),!t.componentInited){try{var o=t.nodes,r=t.components;if($(t.div).find(".fake-position")&&$(t.div).find(".fake-position").remove(),y||(r.trash=new $.Icon({renderTo:o.end,title:l.t("åˆ é™¤é‚®ä»¶"),simple:!0,type:"delete",extcls:"cC0",popupRenderTo:a.scroller,click:function(){c.$D.log("clickTrash")},lazyListen:!0,noListen:!0})).getDom().setAttribute("sign","trash"),!b){if(a.isDefer()){var s=t.data,u=n.default.expireNote(s);(r.defermanage=new $.Icon({renderTo:o.end,title:u,simple:!0,type:s.flags.deferHandle?"todo-selected":"todo",extcls:"cT0",popupRenderTo:a.scroller,click:function(){t.data.flags.deferHandle?this.menu||(this.menu=new((0,c.$I)("component.Menu"))(t.deferManage()),this.menu.attachTo({clickFrom:this.getEl(),floatTo:this.getEl(),renderTo:a.scroller}),this.menu.fire("attachToShow")):t.gotoDefer("add")},lazyListen:!0,noListen:!0})).getDom().setAttribute("sign","defermanage")}a.isTag()&&(r.tagmanage=new $.Icon({renderTo:o.end,title:l.t("é€‰æ‹©é‚®ä»¶æ ‡ç­¾"),simple:!0,subclass:"miniBtn",type:"tags",extcls:"dK0",menu:t.tagManage(),popupRenderTo:a.scroller,click:function(){this.menu||(this.menu=new((0,c.$I)("component.Menu"))(t.tagManage()),this.menu.attachTo({clickFrom:this.getEl(),floatTo:this.getEl(),renderTo:a.scroller}),this.menu.fire("attachToShow")),c.$D.log("click")},lazyListen:!0,noListen:!0})).getDom().setAttribute("sign","tagmanage")}for(var m in y||new(0,window.netease.mail.util.DragDrop)({drag:i.dragDiv,trigger:o.drag,listeners:[{name:"mousedown",handler:p.bind(i.drag,i,t,"mousedown")},{name:"start",handler:p.bind(i.drag,i,t,"start")},{name:"drag",handler:p.bind(i.drag,i,t,"drag")},{name:"end",handler:p.bind(i.drag,i,t,"end")}]}),r){var f=r[m];if(d.isArray(f))for(var h=0,g=f.length;h<g;h++)v(f[h]);else v(f)}}catch(e){c.$D.info({text:l.t("åˆå§‹åŒ–letteräº‹ä»¶å‡ºé”™"),error:e})}t.componentInited=!0}function v(e){e.setEventListeners(),e.fireRender()}},mousedown:function(e){var t=this,i=(t.view,f.getTarget(),e.sign);switch(t.data,t.lazyInit(e.div),i){case"checkbox":case"logo":case"trash":case"flag":case"tag":case"defer":case"tagmanage":case"defermanage":break;default:var a=!1,n=!1;a=a||"start-from"===i,(n=n||"start"===i)&&!a||t.gotoRead({preload:!0})}},click:function(e){var t=this,i=t.view,a=i.module,n=(f.getTarget(),e.sign),o=t.data;switch(t.lazyInit(e.div),n){case"checkbox":t.setChecked(!t.checked);break;case"logo":var r=o.flags.read;r||(a.log("letter","read"),t.setChecked(!0),i.setRead(!r,[t]));break;case"trash":a.log("letter","remove"),t.setChecked(!0),i.remove(4===o.fid,[t]);break;case"flag":a.log("letter","flag",$.Support.getStatsMailinfo({value:1},o.id)),t.setChecked(!0),i.setFlag(0===o.label0?1:0,[t]);break;case"tag":case"defer":case"tagmanage":case"defermanage":break;default:var s=!1,c=!1;s=s||"start-from"===n,(c=c||"start"===n)&&!s||t.gotoRead()}},contextmenu:function(e){var t=this,i=t.data,a=t.view,n=a.module,r=(0,c.$I)("util.Contextmenu"),s=n.param("fid"),d="archive"===n.extend("area"),m=i.fid;t.lazyInit(e.div);for(var f=a.letters,h=i.id,g=!0,v=0,b=f.length;v<b;v++){var y=f[v];if(y.checked&&y.data.id!==h){g=!1;break}}var x={groups:[]},k=x.groups,S=[];if(a.isTeamMember&&s&&[2,4,5,6,7,15].indexOf(s)<0&&(0,c.$S)("isFree")&&(S.push({text:l.t("åˆ†é…ä»»åŠ¡é‚®ä»¶"),click:C(p.bind(a.assignTasks,a))}),k.push({items:S}),S=[]),n.isDefer()&&(i.flags.deferHandle?S.push({text:l.t("å®Œæˆå¾…åŠ"),icon:"done",click:C(p.bind(a.setDefer,a,"complete"))}):S.push({text:l.t("è®¾ä¸ºå¾…åŠ"),icon:"todo",click:C(p.bind(a.setDefer,a,"add"))})),i.flags.read?S.push({text:l.t("è®¾ä¸ºæœªè¯»"),icon:"unread",click:function(){$.Log.cache({mbox_contextmenu_setunread:$.Support.getStatsMailinfo({value:1},h)}),C(p.bind(a.setRead,a,!1))()}}):S.push({text:l.t("è®¾ä¸ºå·²è¯»"),click:C(p.bind(a.setRead,a,!0))}),(s>0||g)&&o.Z.isTop(m)&&!a.folderSelected&&(d||(i.flags.top?S.push({text:l.t("å–æ¶ˆç½®é¡¶"),click:C(p.bind(a.setTop,a,!1,null,m))}):S.push({text:l.t("ç½®é¡¶é‚®ä»¶"),click:function(){$.Log.cache({mbox_contextmenu_settop:$.Support.getStatsMailinfo({value:1},h)}),C(p.bind(a.setTop,a,!0,null,m))()}}))),g&&$.Ext.memo){var w=i.memo?l.t("ä¿®æ”¹å¤‡æ³¨"):l.t("æ·»åŠ å¤‡æ³¨");S.push({text:w,click:C((function(){t.initMemo(),$.Memo.modify(t.com,S=[],u.has([4,5,7,18],rash",click:function(){$.Log.cache({mbox_contextmenu_permanentdeled(a.remove,a,!0))()}}):S.push({text:l.t("åˆ é™¤é‚®ä»¶"),icon:"trash",click:function(){$.Log.cache({mbox_contextmenu_movetodeleted:$.Support.getStatsMailinfo({value:1},h)}),C(p.bind(a.remove,a))()}}),!d&&!u.has([2,3],s)){var T=l.t("ä¸¾æŠ¥åƒåœ¾é‚®ä»¶");S.push({text:T,click:function(){$.Log.cache({mbox_contextmenu_report:$.Support.getStatsMailinfo({value:1},h)}),C(p.bind(a.setSpam,a,!0))()}})}if(u.has([5,7,18],s)){switch(s){case 5:T=l.t("è¿™ä¸æ˜¯åƒåœ¾é‚®ä»¶");break;case 7:T=l.t("è¿™ä¸æ˜¯æ¨å¹¿é‚®ä»¶");break;case 18:T=l.t("è¿™ä¸æ˜¯è®¢é˜…é‚®ä»¶")}S.push({text:T,click:C(p.bind(a.setSpam,a,!1))})}function C(e){return function(){t.checked||t.setChecked(!0),t.view.selectAll(),e()}}k.push({items:S}),r.show(x)},keypress:function(e){this.lazyInit(e.div);var t=f.get();"DIV"===t.target.tagName&&13===t.which&&this.gotoRead()},setChecked:function(e){var t=this,i=t.view,a=i.module;if(t.lazyInit(),!!t.checked!==e){t.checked=e;var n=$.fly(t.nodes.checkbox);e?n.addClass("nui-ico-checkbox-checked"):n.removeClass("nui-ico-checkbox-checked"),n.dom.parentNode.parentNode.setAttribute("aria-checked",!!e),t.setClass(),i.selectAll(!1!==e&&void 0)function(e,t){o.push(t)}));try{(0,c.$I)("util.Shift").handle(t,o,(function(){t.setClass()})),f.stop()}catch(e){}try{a._child.view.changeSelect()}catch(e){}}},setClass:function(){var e=this;e.lazyInit();var t=e.div,i=$.fly(t),a=e.nodes.checkbox;e.checked?i.addClass("ij0"):i.removeClass("ij0");var n=k.checkboxTitle;a.title=e.checked?n[1]:n[0]},setLastRead:function(e){var t=this;if(!y){t.lazyInit();var i=t.nodes,a=i.drag,n=i.dragitem,o=$(t.div),r=$(a),s=$(n),c="nui-ico-drag",d="nui-ico-drag2",u="ik0";e?(s.replaceClass(c,d),o.addClass(u),a.title=l.t("æœ€è¿‘é˜…è¯»é‚®ä»¶")):(s.replaceClass(d,c),o.removeClass(u),a.title=""),o.destroy(),r.destroy(),s.destroy()}},setReFw:function(){var e=this;if(e.lazyInit(),e.isNormalLogo){var t=e.nodes.logo,i=e.getLogoInfo();t.className="dT0 nui-ico nui-ico-"+i[0],t.title=i[1]}},setRead:function(e){var t=this;t.lazyInit();var i=t.data.flags.read;if(t.isNormalLogo||e){var a=t.nodes.logo,n=t.getLogoInfo();a.className="dT0 nui-ico nui-ico-"+n[0],a.title=n[1]}t.checked&&t.setChecked(!1);var o=$.fly(t.div);i?o.removeClass("kw0"):o.addClass("kw0")},setFlag:function(){var e=this,t=e.view;e.lazyInit();var i=e.nodes.flag,a=e.data.label0;i.className="nui-ico nui-ico-flag nui-ico-flag-"+a,i.parentNode.title=a>0?l.t("ç‚¹å‡»å–æ¶ˆæ——å¸œ"):l.t("è®¾ä¸ºçº¢æ——");var n=t.getLayout();"l-r"===n&&a>0?$(i.parentNode).css({visibility:"visible"}):"l-r"===n&&a<=0&&$(i.parentNode).css({visibility:""}),e.checked&&e.setChecked(!1);var o=e.div;o.className=o.className.replace(/nui-txt\-flag\d{1,2}/gi,"nui-txt-flag"+a)},setTag:function(){var e=this;e.lazyInit();for(var t=e.view,a=t.module,n=(0,c.$I)("init.Tag"),o=e.nodes.tag,r=e.data.tag,s=e.components,l=s.tag=[],d=[],u=0,m=r.length;u<m;u++)try{var p=r[u],h=n.get(p),g=new $.Tag({text:h.alias,type:h.color,attrs:"hasClose",click:function(e){return function(){Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(t){t.default.entry({fid:0,showTag:!0,tag:[e]})}))),f.stop()}}(p),closeclick:function(e,i){return function(){t.setTag(!1,e,[i]),f.stop()}}(p,e)});d[d.length]=g.html(),l.push(g)}catch(e){}o.innerHTML=d.join(""),o.style.display="";try{if(!b){var v=s.tagmanage;delete v.menu,v.update({click:function(){this.menu||(this.menu=new((0,c.$I)("component.Menu"))(e.tagManage()),this.menu.attachTo({clickFrom:this.getEl(),floatTo:this.getEl(),renderTo:a.scroller}),this.menu.fire("attachToShow")),c.$D.log("click")}}),v.getDom().setAttribute("sign","tagmanage")}}catch(e){}$.Component.setEvents(),e.checked&&e.setChecked(!1)},setDefer:function(){var e=this,t=e.data;e.lazyInit();var i=e.view.module,a=t.flags.deferHandle;e.nodes.defer&&e.nodes.defer.style&&(e.nodes.defer.style.display=t.defer&&a?"":"none");try{if(!b){var o=e.components.defermanage;delete o.menu,o.update({title:n.default.expireNote(t),menu:e.deferManage(),type:a?"todo-selected":"todo",click:function(){e.data.flags.deferHandle?this.menu||(this.menu=new((0,c.$I)("component.Menu"))(e.deferManage()),this.menu.attachTo({clickFrom:this.getEl(),floatTo:this.getEl(),renderTo:i.scroller}),this.menu.fire("attachToShow")):e.gotoDefer("add")}}),o.getDom().setAttribute("sign","defermanage")}}catch(e){}var r=e.getDateInfo(),s=e.nodes.date;s.title=r.title,s.innerHTML=r.value,$.fly(s)[r.important?"addClass":"removeClass"]("bS0");var l=$.fly(e.div);a?(l.addClass("oU1"),e.expire?l.addClass("gv0"):l.removeClass("gv0")):(l.removeClass("oU1"),l.removeClass("gv0"))},setMemo:function(){var e=this;e.lazyInit(),e.initMemo();var t=e.data.memo||"",i=e.components.memo;i.show(),i.updateContent(m.encodeHTML(t))},setMove:function(){var e=this,t=e.data;e.lazyInit();var i=e.nodes,a=i.folder,n=i.subject;try{a&&(a.innerHTML="["+o.Z.get(t.fid).name+"]")}catch(e){c.$D.info(rror:e})}try{var r=4===t.fid;if(r^n.getElementsByTagName("DEL").length>0){var s=t.subject;r&&(s="<del>"+s+"</del>"),n.innerHTML=s}}catch(e){c.$D.info({text:l.t("è®¾ç½®åˆ é™¤çº¿å‡ºé”™"),error:e})}},setTop:function(){var e=this,t=e.data;e.lazyInit();var i=$.fly(e.div);t.flags.top?i.addClass("oh0"):i.removeClass("oh0"),e.setRead(!0data;e.formatSummary();var i=t.summary;e.lazyInit(),e.nodes.summary.innerHTML=e.getSummary(i)},updateTrackStatus:function(){var e=this,t=e.components.mailTrack,i=e.data.tag;i&&t&&t.update({html:e.getMailTrack(i)})},updateDaTag:function(){var e=this;if(1===e.data.fid){var t=(0,c.$I)("init.Tag"),i=e.data.tag,a={ad:l.t("æ¨å¹¿"),sub:l.t("è®¢é˜…")};t.getDATagInfo({tags:i,callback:function(t){var i=e.nodes.daTag,n=a[t.group]||"";$.Object.isString(i)&&(i=$("#"+i)?$("#"+i).dom:""),i&&(!n||"ad"!==t.group&&"sub"!==t.group?i.style.display="none":(i.innerHTML=n,i.style.display=""))}})}},updateTask:function(){var e=this,t=e.nodes.task,i=e.data.tag;try{i&&t&&(t.innerHTML=e.getMailTask())}catch(e){console.log(e)}},updateTaskInfo:function(){var e=this.nodes.taskInfo;try{e&&(e.innerHTML=this.getMailTaskInfoHTML())}catch(e){console.log(e)}},deferManage:function(){var e=this,t=(e.view.module,e.data),i={};return i.data=t,i.left=38,i.top=10,i.modify=function(){e.gotoDefer("modify")},i.modifySms=function(){e.gotoDefer("modify",{smsShow:!0})},i.modifyMemo=function(){e.gotoDefer("modify",{memoShow:!0})},i.complete=function(){e.gotoDefer("complete")},i.delete=function(){e.gotoDefer("delete")},n.default.getMenu(i)},tagManage:function(){var e=this,t=e.view,i=e.data.tag||[],n={};return n.tag=i,n.callback=function(i,a){t.module.log("letter","settag"),t.setTag(!i,a,[e])},n.remove=function(){t.setTag(!1,null,[e])},a.default.getMenu(n)},gotoRead:function(e){var t=this,a=t.view,n=a.module,o=t.data;e||(e={});var r=e.hidden,s=e.preload,l=e.call,u=e.hiddenCall;if(2!==o.fid){var m=n.extend("area");if(s)t.isThread||Promise.resolve().then(i.bind(i,88829)).then($.Function.bind((function(e){e.default.preload({id:o.id,fid:o.fid,locked:!!o.flags&&o.flags.locked,area:m})})));else if(!(0,c.$I)("util.TimeFlag").handle(o.id,800)){var p=a.getLayout(n);if(Promise.resolve().then(i.bind(i,88829)).then($.Function.bind((function(e){var i=e.default,a=n.name,s=d.clone(n.param()),c=d.clone(n.extend());c.moduleName=a,i.entry({moduleName:a,moduleParam:s,moduleExtend:c,area:m,folderData:o,isThread:t.isThread,isRead:"read"===n.extend("subtype"),viewType:p,hidden:r,call:l,hiddenCall:u})}))),""!==p&&!r)try{a.markReaded()}catch(e){}}}else s||(Promise.resolve().then(i.bind(i,54107)).then($.Function.bind((function(e){e.default.draft({id:o.id,info:{subject:o.subject,priority:o.priority},folderData:o,date:o.flags.scheduleDelivery?o.sentDate:null})}))),Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.setRead({fid:n.param("fid"),isRead:!0,data:o})}))))},gotoDefer:function(e,t){var i=this,a=i.view,o=a.module,r=i.data;switch(t||(t={}),e){case"add":r.flags.deferHandle||(o.log("letter","defer","add"),a.setDefer("add",void 0,[i]));break;case"complete":o.log("letter","defer","complete"),a.setDefer("complete",void 0,[i]);break;case"modify":o.log("letter","defer","modify"),n.default.showMsgbox({type:"modify",data:{defer:r.defer,memo:r.memo,mid:r.id,memoShow:t.memoShow,smsShow:t.smsShow},callback:function(e){a.setDefer("modify",e,[i])}});break;case"delete":a.setDefer("delete",{defer:r.defer},[i])}},remove:function(e){var t=this;try{if(e){var i=t.components;for(var a in i)try{var n=i[a];if(d.isArray(n))for(var o=0,r=n.length;o<r;o++)n[o].destroy();else n.destroy();c.$D.log("remove letter components "+t.data.id)}catch(e){}try{var s=t.getDiv();s&&(f.unlistenAll(s),$.fly(s).remove()),c.$D.log("remove letter div "+t.data.id)}catch(e){}}c.$D.log("remove letter "+t.data.id)}catch(e){}t.html=null,t.div=null,t.nodes=null,t.components=null,t.data=null,t.view=null},getDiv:function(e){var t=this;return t.div||(t.div=e||document.getElementById(t.id)),t.div},format:function(){var e=this,t=e.data,i=(0,c.$I)("init.Defer"),a=e.view.module,n=a.extend("subtype"),o=t.threadMessageCount;if(e.isThread=o>1,"defer"===n||t.flags.expire){e.isDefer=!0;var r=t.defer,s=e.expire=r<i.getDate("tomorrow");e.today=s&&r>=i.getDate("today")}else e.isDefer=!1,delete e.expire,delete e.today;if(t.flags||(t.flags={}),t.tag||(t.tag=[]),e.isThread){var l=a.param("fid");if("flag"===(n=a.extend("subtype"))){var d=a.param("filter");t.label0=d.label0}l>0&&t.fid!==l&&(t.fid=l)}try{t.sentDate.getTime()<=0&&(t.sentDate=new window.Date(v.getTime(0)))}catch(e){}e.formatSummary(),x&&(t.subject=t.subject.replace(/ã€€/g," ")),t.subject=m.trim(t.subject)},formatSummary:function(){var e=this.data;e.summary=e.summary?e.summary.replace(/\n|\|/g,"").replace(/(\s|ã€€)+/g," "):void 0},getTaskInfo:function(e,t){for(var i=$G.user.uid,a=(0,c.$S)("orgUid"),n={},o=[],r={},s=!1,l="",d={id:/^%tc_task_id#([^#]+)%$/,tid:/^%tc_task_tid#([^#]+)%$/,type:/^%tc_task_m_type#([^#]+)%$/,status:/^%tc_task_status#([^#]+)%$/,executor:/^%tc_task_e_status#([^#]+)#([^#]+)%$/,creator:/^%tc_task_creator#([^#]+)%$/,creatorName:/^%tc_task_creator_name#(.+)%$/,tmUid:/^%tc_task_tm#([^#]+)%$/,mid:/^%tc_task_tm_mid#([^#]+)%$/},u=0;u<e.length;u++){var m=e[u];for(var p in d){var f=d[p].exec(m);if(f){if("executor"===p){var h=f[1],g=f[2];r[h]||(r[h]=g,o.push({uid:h,status:g})),i!==h&&a!==h||(s=!0,l=g)}else n[p]=f[1];o.length&&(n.executorList=o)}}}return s&&(n.isTaskExecutor=s,n.eStatus=l),n.isExpired="expired"===n.status,n.isCreator=n.creator===i||n.creator===a,n.isOriginMail="origin"===n.type,n},modifyMemo:function(e){this.view.setMemo(e,[this])},initialize:function(e,t){var i=this;i.data=t,i.view=e,i.nodes={},i.components={};try{i.format()}catch(e){c.$D.log({text:l.t("Letteræ ¼å¼åŒ–å¤±è´¥"),error:e})}}}),t.Z=k},49887:function(e,t,i){var a=i(88578),n=i(72957),o=$.Object,r=$.createClass((0,n.$N)("module.mbox.ListAction"));o.mix(r,a.Z,{},{getList:function(e,t,i){var a=this,n=a.module;t||(t={});var r={func:n&&n.isThread()?"mbox:listThreads":"mbox:listMessages",body:e},s=a.bindExtra(t,r);r=s.request,o.extend(r,{sync:t.sync,call:function(e){c&&(e=c(e)),i(e),$.Log.duration("performance_ir_recieve","end")},hideWait:t.hideWait});var c=s.handleExtra;a.wmsvr(r)},initialize:function(e){r.superClass.initialize.call(this,e)}}),t.Z=r},40276:function(e,t,i){var a=i(95430),n=i(72957),o=$.Object,r=$.createClass((0,n.$N)("module.mbox.ListListener"));o.mix(r,a.Z,{},{}),t.Z=r},87226:function(e,t,i){i.r(t),i(803),i(66403),i(15296),i(92274),i(67285),i(36809),i(68233),i(37885),i(66251),i(75654),i(42295),i(52963),i(8600),i(26340),i(55737);var a=i(40276),n=i(296),o=i(49887),r=i(44033),s=i(92066),c=i(20313),l=i(40823),d=i(72957),u=new d.c1("module.mbox.ListModule"),m=$.Object,p=$.Date,f=$.createClass((0,d.$N)("module.mbox.ListModule"));m.mix(f,r.default,{View:n.Z,Listener:a.Z,Action:o.Z,action:new o.Z,setTop:function(e){for(var t,i=this,a=e.isTop,n=e.data,o=e.callback,r=i.hasThreadAndSent(n),c=r[0],l=r[1],d=i.action,p=i.parseFid(n),f=p[0],h=0,g=f.length;h<g;h++){var v=f[h];if(!i.isTop(v)){t=s.Z.get(v).name+u.t(" æ–‡ä»¶å¤¹æ— æ³•è®¾ç½®ç½®é¡¶");break}}if(a)for(h=0,g=f.length;h<g;h++)t||d.getTop({fid:f[h],callback:b});function b(e){var i=$G.user.topMailCount-0,a=e.total,o=n.length+a;o>i&&(t=u.t("æ¯ä¸ªæ–‡ä»¶å¤¹æœ€å¤šå¯ä»¥è®¾ç½® ")+i+u.t(" å°ç½®é¡¶é‚®ä»¶(æ‚¨è®¾ç½®åä¸º ")+o+u.t(" å°)")+'<div style="padding-top:15px" class="txt-12 txt-info">'+u.t("æç¤ºï¼šæ‚¨å¯ä»¥å–æ¶ˆéƒ¨åˆ†å·²ç½®é¡¶é‚®ä»¶çš„ç½®é¡¶çŠ¶æ€ï¼Œå†è¿›è¡Œè®¾ç½®")+"</div>")}t?($.Msgbox.show({statsKey:"Mbox_NoGuide_Popup_FolderSetTopFail",title:t}),o&&o(!1)):(m.extend(e,{fidInfo:p,hasThread:c,hasSent:l,callback:function(e,t){o&&o(e,t)}}),d.setTop(e))},parseSentDate:function(e){var t=e.substring(0,4),i=parseInt(e.substring(4,6),10)-1,a=e.substring(6,8);return new window.Date(t,i,a)},entry:function(e,t,i){r.default.entry.call(this,e,t,i)}},{data:null,extendParam:function(e,t){var i=t.limit,a=t.index,n=t.start;m.extend(e,{limit:i,start:n>=0?n:a*i}),this.isSummary()&&(e.summaryWindowSize=i),e.skipLockedFolders=!(e.fid>0||1===e.fids.length),e.topFlag=this.isTop()?"top":void 0,e.returnTag=!!$.Ext.tag,e.returnTotal=!0},getData:function(e,t,i){var a=this,n=a._var,o=n.param,r=n.extend,c=r.limit;if(n.cacheDom=!0,t>=0||(t=r.index),!i){try{a.view.deleteInterval()}catch(e){}a.removeCache()}if(a.getCacheData(t,!0))$.Thread.run((function(){e()}),0);else{var d=a.param("fid"),u=a.extend("area"),p=a.extend("expire")&&l.Z.getInfo("expire")>0,f=$.Ext.archive&&d>0&&"archive"!==u,h=m.clone(o);if(a.extendParam(h,{index:t,limit:c}),p){var g=h.filter;g||(g=h.filter={}),g.todoList=!0}var v={hideWait:i,loadExpire:p&&!l.Z.getCache(),loadArchive:f&&!(s.Z.getArchive(d)>=0)};a.getList(h,v,(function(n){if(!i&&0===n.var.length&&t>0){var o=a.getPage()-1;r.index=o<0?0:o,a.getData(e)}else e()}))}},getText:function(){var e=this,t=e.extend("subtype"),i=e.param("fid"),a=e.param("tag"),n=e.param("filter"),o=e.extend("systemContacts"),r=e.extend("smart"),l=u.t("é‚®ä»¶åˆ—è¡¨");try{switch(t){case"task":l=u.t("ä»»åŠ¡é‚®ä»¶");break;case"flag":l=u.t("æ——å¸œé‚®ä»¶");var m=n.label0;m>=0&&(l=$.LETTERFLAG[m]+u.t("é‚®ä»¶"));break;case"tag":l=u.t("æ ‡ç­¾é‚®ä»¶"),l=r&&a.length>0?u.t("æ™ºèƒ½æ ‡ç­¾"):c.Z.getName(a[0]);break;case"defer":l=u.t("å¾…åŠé‚®ä»¶");break;case"contacts":if(o)l=u.t("è´¦å·é€šé‚®ä»¶");else{l=u.t("è”ç³»äººé‚®ä»¶");var p=n.chatWithAddress||n.fromAddress||n.toAddress,f=(0,d.$I)("init.Contacts").getContact(p);f&&(l=f.data.name+u.t("é‚®ä»¶"))}break;case"folder":l=s.Z.get(i).name;break;case"read":l=(e.extend("read")?u.t("å·²è¯»"):u.t("æœªè¯»"))+u.t("é‚®ä»¶");break;case"calendar":l=e.getCondition();break;case"emails":l=u.t("è”ç³»äººé‚®ä»¶")}}catch(e){d.$D.info({text:u.t("è·å–å¤šæ ‡ç­¾æ ‡é¢˜å‡ºé”™"),error:e})}return l},initBrand:function(){var e=this,t=e.view,i=c.Z.getMatch();i.length>0&&(i.sort((function(e,t){return e.logo1&&!t.logo1?-1:!e.logo1&&t.logo1?1:e.weight-t.weight})),$.SM.go({parent:e,module:"mbox.BrandModule",param:e.param(),viewType:"l-r",setIEViewType:!0,hideSplit:!0,sharebar:!0,reset:!1,cacheDom:!1}),$.Frame.setViewType("l-r",e)),t.showBanner(),t.constructor.addCss()},refreshBrand:function(){try{c.Z.getMatch().length>0?"address.AddressModule"!==this._child.mtype&&$.SM.refresh(this._child):$.Frame.setViewType("normal")}catch(e){}},getCacheData:function(e,t){var i,a=this,n=a.data;e||(e=a.extend("index"));var o=e<0,r=!1,s=a.getTotal();if(n.length>0)if(o)i=n.slice();else{var c=a._var.extend;e>=0||(e=c.index),i=[];for(var m=c.limit,p=e*m,f=0,h=p,g=n.length;f<m&&h<g;f++,h++){var v=n[p+f];v&&i.push(v)}r=i.length===m||f+p===s}else r=0===e&&0===s,(o||r)&&(i=[]);if(o||r){if(!t&&a.extend("expire")&&l.Z.getInfo("expire")>0)try{var b=l.Z.getCache("var");if(b.length>0){var y=0===i.length;(i=b.concat(i)).onlyExpire=y}}catch(e){i=null,d.$D.log({text:u.t("åˆreturn i&&i.length>0?i:void 0}},cleanData:function(){this.data=[]},removeData:function(e,t){for(var i=this,a=i.data,n=i.getTotal(),o=a.length-1,r=0;o>-1&&r<e;){var s=a[o];s&&t[s.id]&&(a.splice(o,1),r++,n--),o--}i.setTotal(n)},getList:function(e,t,i){var a=this;if("emails"===a.extend("subtype"))try{var n=a.param("filter");if(!(n.chatWithAddress||n.fromAddress||n.toAddress))return void o({var:[],total:0})}catch(e){}function o(t){for(var n=e.start,o=t.var,r=t.total,s=a.data,c=(e.fid,0),l=o.length;c<l;c++)s[n+c]=o[c];a.setTotal(r),i(t),a.getAllTagInfo(o,n)}a.action.getList(e,t,o)},getMailTrackInfo:function(e){if(!e||e.length){var t=this.view,i=this.data;$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:{midList:e},rnd:!0,head:[{name:"Content-type",value:"application/json"}],url:$.Uri.getUrl("mailTrackingInfo",!0),call:function(e){try{var t=JSON.parse(e.responseText);oInfo=t.result||{},200===t.code?a(oInfo):a(null)}catch(e){a(null)}}})}function a(e){if(e&&e.length){var a={},n=0;m.each(e,(function(e,t){a[t.mid]=t.readStatus})),$.Array.each(i,(function(e,t){a[t.id]&&(t.mailTackStatus=a[t.id],n++)})),t.syncLetter("mailTrack",n,a)}}},getAllTagInfo:function(e,t){var i=this.view,a=this.data;try{for(var n=function(){o.length&&(0,d.$I)("init.Contacts").getMarketingInfo(o,(function(e){if(e){var n={},r=0;if($.Array.each(o,(function(t,i){var a=i.sender+"_"+i.tt("ï¼ˆå·²å¤±æ•ˆï¼‰")),n[i.id]=o,r++}})),i.syncLetter("mktInfo",r,n),!r)return;for(var s=t,c=a.length;s<c;s++)if(a[s]){var l=a[s];n[l.id]&&(a[s].mktInfo=n[l.id])}}}))},o=[],r=[],s=0,c=e.length;s<c;s++){var l=e[s].tag;if(l&&l.length)for(var m=0;m<l.length;m++){var p=l[m],f=e[s].from;f=f instanceof window.Array?f[0]:f.toString();var h=p.match(/^%ex_mkt_logo_(.+)%$/);if(h&&!e[s].mktInfo&&(g=h[1])){o.push({teamId:g,sender:$.Uri.getAddress(f),id:e[s].id});break}var g,v=p.match(/^%ex_tc_logo_(.+)%$/);if(v&&!e[s].teamInfo&&(g=v[1])){r.push({teamId:g,sender:$.Uri.getAddress(f),id:e[s].id});break}}}r.length?(0,d.$I)("init.Contacts").getTeamfunction(t,i){var a=i.sender+"_"+i.teamId;if(e[a]){var n=e[a];n.extInfo="",n.teamStatus?n.senderStatus||(n.extInfo=u.t("ï¼ˆå·²ç¦»èŒï¼‰")):n.extInfo=u.t("ï¼ˆå·²å¤±æ•ˆï¼‰"),o[i.id]=n,s++}})),i.syncLetter("teamInfo",s,o),!s)return;for(var c=t,l=a.length;c<l;c++)if(a[c]){var d=a[c];o[d.id]&&(a[c].teamInfo=o[d.id])}}else n()})):n()}catch(e){console.log(e)}},getCondition:function(){var e=this,t=[],i=e.param("filter"),a=e.param("tag"),n=e.extend("subtype");if(i){if(i.label0>=0&&"flag"===n){var o=$.LETTERFLAG[i.label0];o&&t.push(o)}var r=i.flags;if(r)for(var s in r){var l=r[s];switch(s){case"priority":t.push(1===l?u.t("ç´§æ€¥"):5===l?u.t("ç¼“æ…¢"):u.t("æ™®é€š"));break;case"read":"read"===n&&t.push(l?u.t("å·²è¯»"):u.t("æœªè¯»"));break;case"attached":t.push((l?u.t("æ™®é€š"):u.t("æ— "))+u.t("é™„ä»¶"));break;case"linkAttached":t.push(l?u.t("è¶…å¤§é™„ä»¶"):"");break;case"replied":t.push((l?u.t("å·²"):u.t("æœª"))+u.t("å›å¤"));break;case"forwarded":t.push((l?u.t("å·²"):u.t("æœª"))+u.t("è½¬å‘"))}}var m=i.chatWithAddress,h=i.fromAddress,g=i.toAddress,v=i.chatWithAddress||i.fromAddress||i.toAddress;if(v){var b=(0,d.$I)("init.Contacts").getContact(v),y=$.String.encodeHTML(b?b.data.name:v);m?t.push(u.t("ä¸â€œ")+y+u.t("â€çš„å¾€æ¥")):h?t.push(u.t}if(i.sentDate){var x,k=i.sentDate.split(":"),S=k[0],w=k[1],T=f.parseSentDate(S),C=f.parseSentDate(w);x=T-C==0?p.format(T,u.t("yyyyå¹´Mæœˆdæ—¥")):p.format(T,u.t("yyyyå¹´Mæœˆdæ—¥"))+"-"+p.format(C,u.t("yyyyå¹´Mæœˆdæ—¥")),t.push(x)}i.defer&&t.push(u.t("å¾…åŠ"))}else if(a){for(var _=[],I=0,A=a.length;I<A;I++){var M,L=a[I];M=/^%ex_trace/.test(L)?c.Z.getSmart(L):c.Z.getName(L),_.push(M)}t.push(_.join())}return t.join()},initialize:function(e){var t=this;f.superClass.initialize.call(t,e),t.cleanData(),setTimeout($.Function.bind(t.setAd,t),1e3)},setAd:function(){var e=this.view,t="3"!==$.Ud.get({field:"ntes_inbox",flag:"layout"});this.isFooter()&&t&&window.gAd.getByCallback("inboxBottom",{onClose:function(){$.Listener.fire("letter:closead","mboxFooterAd")}},$.Function.bind((function(e){var t=this.module,i=e?e.inboxBottom:"",a=[];a[a.length]=i,t.getDom("FooterDiv")&&(t.getDom("FooterDiv").innerHTML=a.join(""),t.getEl("FooterDiv").show())}),e))}}),t.default=f},296:function(e,t,i){i(803),i(37092),i(92274),i(13484),i(19975),i(66403),i(55737),i(42295),i(48868),i(63045),i(81874),i(54861);var a=i(49134),n=i(72957),o=i(20313),r=new n.c1("module.mbox.ListView"),s=$.Object,c=$.createClass((0,n.$N)("module.mbox.ListView"));s.mix(c,a.Z,{},{getBanner:function(){var e=this.module,t="";return e.extend("brand")&&(t='<div class="'+(18===e.extend("fid")?"sk0":"qJ0")+' nui-closeable" id="'+e.createId("BannerDiv")+'" style="displshowBanner:function(e){var t=this,i=t.module;if(i.extend("brand")){var a=i.getDom("BannerDiv");if(18!==i.param("fid")||i.isNone()){if(i.param("tag")&&i.param("tag").param("tag")[0],s=o.Z.getBrand(r);s&&s.logo2&&s.description&&(a.innerHTML='\t\t\t\t\t\t<div class="kb0">\t\t\t\t\t\t\t<div class="gO0"><img src="'+s.logo2+'" alt="'+s.name+'" /></div>\t\t\t\t\t\t\t<h1 class="fk0">'+s.name+'</h1>\t\t\t\t\t\t\t<h1 class="fX0">'+s.description+"</h1>\t\t\t\t\t\t</div>\t\t\t\t\t\t",a.style.display="")}}else{for(var c=(0,n.$S)("brandAd"),l=(0,n.$I)("util.Misc").getTime(0).getTime(),d=[],u=0,m=c.length;u<m;u++){var p=c[u];if(p){if(p.startTime&&p.startTime>l)continue;if(p.endTime&&p.endTime<=l)continue;if(!p.img||!p.pdlink)continue;d.push(p)}}if(i.extend("ad",d),d.length>0){var f=i.createId("adDiv"),h=i.createId("adLink"),g=i.createId("adSelectDiv"),v=i.createId("adImg"),b=[];for(b[b.length]='\t\t\t\t\t<div class="pm0" id="'+f+'">\t\t\t\t\t\t<a class="iQ0" id="'+h+'" target="_blank">\t\t\t\t\t\t\t<img class="fJ0" id="'+v+'" />\t\t\t\t\t\t</a>\t\t\t\t\t</div>\t\t\t\t\t',b[b.length]='<div class="oF0" id="'+g+'">',u=0,m=d.length;u<m;u++)b[b.length]='<a class="hO0"></a>';b[b.length]="</div>",a.innerHTML=b.join("");var y=$("#"+h);y.listen("mouseover",(function(){i.extend("adMouseover",!0)})),y.listen("mouseout",(function(){i.extend("adMouseover",void 0)}));var x=$("#"+g).find("A").doms;for(u=0,m=x.length;u<m;u++){var k=function(e){return function(){t.toggleBanner(e,!0)}}(u);$.Event.listen(x[u],"click",k)}i.extend("adIndex",-1),t.toggleBanner(0),a.style.display=""}else{var S=(0,n.$S)("ad");if((S.show||"ud"!==S.userType)&&!(0,n.$S)("mboxBannerAd"))try{gAd.getByCallback("brand",{onClose:function(){$(a).hide(),(0,n.$S)("mboxBannerAd",!0)}},(function(e){var t=e?e.brand:"";t&&(a.innerHTML=t,a.style.display="")}))}catch(e){}}}}},toggleBanner:function(e,t){var i=this,a=i.module,n=a.extend("ad"),o=a.extend("adIndex")||0,r=i.timeout,s=!!a.extend("adMouseover");try{clearTimeout(r)}catch(e){}if(s&&!t)i.timeout=setTimeout((function(){i.toggleBanner(e)}),2500);else if(e!==o){e%=n.length;for(var c=$("#"+a.createId("adSelectDiv")).find("A").doms,l=0,d=c.length;l<d;l++){var u=$(c[l]);l!==e?u.removeClass("ek0"):u.addClass("ek0")}var m=n[e],p=$("#"+a.createId("adDiv")).dom,f=$("#"+a.createId("adLink")).dom,h=$("#"+a.createId("adImg")).dom;p.style.backgroundColor="#"+(m.color?m.color:"E0ECF4"),h.src=m.img;var g=m.pdlink;f.href=g;var v=null;$.String.has(g,"http")||(v=function(){try{$.Eval.exec(g)}catch(e){}return!1}),f.onclick=function(){var e=!0;return v&&(e=v()),e},a.extend("adIndex",e),i.timeout=setTimeout((function(){i.toggleBanner(e+1)}),5e3)}},getSmarts:function(){var e=this.module,t=e.extend("smart"),a=e.param("tag"),s="";if(!e.isNone()&&t){var c=$.getClass((0,n.$N)("component.Tab")),l=($.getClass((0,n.$N)("component.TabItem")),o.Z.smart),d=[],u={render:function(){this.activeStyle()}};for(var m in d.push({text:'<div class="ui0">'+r.t("æ‰€æœ‰åˆ†ç±»")+'</div><span class="pz2 nui-txt-cLink">â—</span>',nonClose:!0,extcls:"nui-txt-cLink",listeners:a.length>1?u:null,noDelayClick:!0,click:function(){return Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.smarts()}))),!0}}),l){var p=l[m].alias,f=o.Z.smarts[p];d.push({text:'<div class="ui0 kA1"><b class="nui-ico nui-ico-category-'+f.index+'"></b>'+f.name+'</div><span class="pz2 nui-txt-cLink">â—</span>',nonClose:!0,extcls:"nui-txt-cLink",listeners:1===a.length&&a[0]===m?u:null,noDelayClick:!0,click:function(e){return function(){return Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(t){t.default.smarts(e)}))),!0}}(p)})}s=new c({type:"",extcls:"AH1",hasClose:!1,items:d}).html()}return s},getFooter:function(e){var t,i=this.module,a=[];return i.isFooter()&&(t=i.createId("FooterDiv"),a.unshift('<div class="xd0 nui-closeable" id="'+t+'" style="display:none;">'),a.push("</div>")),a.join("")},toggleFooter:function(){var e=this.module,t=e.extend("index");try{if(e.isFooter()){var i=e.getEl("FooterDiv");0===t?i.html()&&i.show():i.hide()}}catch(e){}},initialize:function(e){c.superClass.initialize.call(this,e)}}),t.Z=c},19619:function(e,t,i){i(66251),i(42295),i(15296),i(92274);var a=i(72957),n=i(1124),o=new a.c1("module.mbox.Mailtrack"),r=$.Object,s=$.createClass((0,a.$N)("module.mbox.MailTask"));r.extend(s.prototype,{view:null,ready:!1,components:null,regexMap:{id:/^%tc_task_id#([^#]+)%$/,type:/^%tc_task_m_type#([^#]+)%$/,status:/^%tc_task_status#([^#]+)%$/,executor:/^%tc_task_e_status#([^#]+)#([^#]+)%$/,creator:/^%tc_task_creator#([^#]+)%$/,creatorName:/^%tc_task_creator_name#(.+)%$/,tmUid:/^%tc_task_tm#([^#]+)%$/,mid:/^%tc_task_tm_mid#([^#]+)%$/},statusOptions:[{text:o.„ç†"),value:"todo"},{text:o.t("æˆ‘å‘èµ·çš„"),value:"create"},{text:o.t("æˆ‘å·²å®Œæˆ"),value:"done"}],cStatusOptions:[{text:o.t("å…¨éƒ¨ç±»å‹"),value:""},{text:value:"done"},{text:o.t("å·²é€¾æœŸ"),value:"expired"}],initStatusInfo:function(){var e=this;(0,a.$S)("isFree")&&$.Ud.getProxy({field:["product.collaboration.memberType","product.collaboration.role","product.collaboration.expireTime","product.collaboration.isTeamMail"],call:function(t){var i=$.Misc.getTime().getTime(),a=t["product.collaboration.isTeamMail"],n=1===t["product.collaboration.role"],o=t["product.collaboration.expireTime"],r=t["product.collaboration.memberType"],s=i>o,c=!s&&r>0||1===a;e.TaskInfo={isTeamCorp:c,isTeamCorpAdmin:n,isExpired:s},e.ready=!0,e.updateFilter()}})},getTeamMemberList:function(e){$.Ud.getProxy({fien.expireTime","product.collaboration.memberType"],call:function(t){var i=t["product.collaboration.isTeamMail"],a=$.Ud.udProxy["product.collaboration.expireTime"];i||a?$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,body:{},rnd:!0,url:$.Uri.getUrl("mailTeamMembers",!0)+"?includeAll=true",head:[{name:"Content-type",value:"application/json"}],call:function(t){try{var i=JSON.parse(t.responseText);oInfo=i.result||{},200===i.code?e&&e(oInfo):e&&e([])}catch(t){e&&e([])}}}):e&&e([])}})},getFilterHTML:function(){var e=this,t=e.view.module.param("tag")||[],i=e.regexMap,a=e.TaskInfo,n=(e.memberList,"");try{if(a.isTeamCorpAdmin){var r="",s=o.t("å…¨éƒ¨ç±»å‹");$.Array.each(t,(function(e,t){var a=i.status.exec(t||"");a&&(r=a[1])})),$.Array.each(e.cStatusOptions,(function(e,t){t.value===r&&(s=t.text)}));var c=[];$.Array.each(e.cStatusOptions,(function(t,i){c.push({text:i.text,click:function(){e.updateStatus(i.value)},checked:r===i.value})})),n+=$.Button.html({text:s,subclass:"dropdownBtn",extcls:"pa1",menu:{groups:[{checkType:"radio",items:c}]}})}else c=[],$.Array.each(e.statusOptions,(function(t,i){c.push({text:i.text,click:function(){e.updateMineStatus(i.value)},checked:!0})})),n+=$.Button.html({text:o.t("å…¨éƒ¨ç±»å‹"),subclass:"dropdownBtn",extcls:"pa1",menu:{groups:[{checkType:"radio",items:c}]}})}catch(e){console.log(e)}return n&&(n='<div class="yn1">'+n+"</div>"),{html:n}},getFilterConfig:function(){try{var e=this,t=e.view.module.extend("subtype"),i=null;if("task"===t){if(!e.ready)return{html:""};var a=e.getFilterHTML();a&&a.html&&(i={html:a.html})}return i}catch(e){return null}},updateStatus:function(e){var t=this.view.module,i=t.param(),o=(this.regexMap,i.tag,[]);switch(e){case"todo":o.push("%tc_task_status#todo%");break;case"done":o.push("%tc_task_status#done%");break;case"expired":o.push("%tc_task_status#expired%");break;default:o.push("%tc_task_m_type#origin%"),o.push("%tc_task_m_type#task%")}t.filterTaskStatus=e;var r=(0,a.$I)("init.Folder").getFids();n.default.entry({fids:r,order:"date",desc:!0,tag:o},{type:"list",subtype:"task"})},updateMineStatus:function(e){var t=this.view.module,i=(t.param(),(0,a.$S)("orgUid")),o=[];switch(e){case"todo":o.push("%tc_task_e_status#"+i+"#todo%");break;case"done":o.push("%tc_task_e_status#"+i+"#done%");break;case"create":o.push("%tc_task_creator#%"+i);break;default:o.push("%tc_task_m_type#origin%"),o.push("%tc_task_m_type#task%")}t.filterTaskStatus=e;var r=(0,a.$I)("init.Folder").getFids();n.default.entry({fids:r,order:"date",desc:!0,tag:o},{type:"list",subtype:"task"})},getFilter:function(){var e=this,t=(e.view.module,e.getFilterConfig());return(e.filter=new $.Component(t)).html()},updateFilter:function(){var e=this,t=e.view.module,i=e.filter;if(i){var a=e.getFilterConfig();!t.isNone()&&a?(i.update(a),i.show()):i.hide()}},destroy:function(){try{this.filter.destroy(),this.filter=null}catch(e){}},initialize:function(e,t){var i=this;i.view=e,e.module,i.components={},i.filter||(i.filter=new $.Component({html:""})),t&&i.initStatusInfo()}}),t.Z=s},12879:function(e,t,i){i(66251),i(803),i(48868),i(92274),i(63045),i(81874),i(54861),i(42295),i(34994),i(49750);var a=i(72957),n=i(96540),o=new a.c1("module.mbox.Mailtrack"),r=$.Object,s=$.createClass((0,a.$N)("module.mbox.Mailtrack"));r.extend(s.prototype,{view:null,tip:null,ready:!1,hasShowNPS:!1,statusInfo:{},trackInfo:{},currentTipType:null,initStatusInfo:function(){var e=this;e.hideTip(),$.Ud.getProxy({force:!0,field:["product.plus.mailTrackingStatus","webmail.js.mailTrackingConfig"],call:function(t){var i=t["product.plus.mailTrackingStatus"],a=t["webmail.js.mailTrackingConfig"];try{oStatus=JSON.parse(i),e.statusInfo=oStatus}catch(e){$.Log.cache({mbox_ud_error:{type:"parse",response:i}})}try{oConfig=JSON.parse(a),e.trackInfo=oConfig}catch(e){$.Log.cache({mbox_ud_error:{type:"parse",response:i}})}e.ready=!0,e.updateTip()}})},getTipConfig:function(){try{var e=this,t=e.view,i=t.module,a=null,n=3===i.param("fid"),o=1===i.param("fid");if(!$.Ext.mailTracking)return a;if(!o&&!n||!t.letters||!t.letters.length)return a;if(n||o){if(!e.ready)return{html:""};var r=e.getTipHTML();r&&r.html&&r.type&&(a={tipType:r.type,html:r.html})}return a}catch(e){return $.Log.cache({mbox_getTipConfig_error:{type:"error",response:e}}),null}},getTooltipConfig:function(e,t,i,a,n){try{var r=this,s=r.view.module.createId(n+(new window.Date).getTime())+"tooltip",c=!0;t.div&&t.div.offsetTop<30&&(c=!1);var l="<span>"+("read"===e?o.t("å½“å‰é‚®ä»¶å·²è¢«é˜…è¯»"):o.t("é‚®ä»¶æš‚æœªè¢«é˜…è¯»ï¼Œè¯·è€å¿ƒç­‰å¾…"))+"</span>";return($.Array.has(a,"%ex_trace_sp%")||$.Array.has(a,"%ex_trace_att%"))&&(l='<div id="'+s+'"><div>'+o.t("åŠ è½½ä¸­")+' <b class="nui-ico nui-ico-loading"></b><div>',r.setGroupTooltip(s,n,t,i)),{content:l,renderTo:r.view.module.scroller||document.body,pointTo:i,hidden:!0,params:c?"arrDown":"arrUp",extcls:"jB1"}}catch(e){return $.Log.cache({mbox_getTooltipConfig_error:{type:"error",response:e}}),null}},createTrialTip:function(){var e=this,t=e.view.module,i=$.Link.html({text:o.t("ç«‹å³ä½“éªŒ"),extcls:"Sky-gIbx-mailtrack-link",click:function(){e.openTrialModal(),t.log({action:"click",item:"mailtrack_not_beenTrialed_tip"})}});return['<span class="Sky-gIbx-mailtrack-tipstxt" style="margin-right: 8px;">'+o.t("æ–°åŠŸèƒ½ä½“éªŒï¼šéšæ—¶æŸ¥çœ‹é‚®ä»¶çŠ¶æ€ï¼Œç¡®è®¤å‘å‡ºé‚®ä»¶æ˜¯å¦è¢«å¯¹æ–¹é˜…è¯»")+"</span>",i].join("")},createImTrialTip:function(){var e=this.view.module,t=$.Link.html({text:o.t("ç«‹å³ä½“éªŒ"),extcls:"Sky-gIbx-mailtrack-link",click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"trackSetting",group:"track-setting",fullScreen:!0,title:o.t("é‚®ä»¶è¿½è¸ªè®¾ç½®"),param:{apply_type:"important_mail"}})}))),e.log({action:"click",item:"mailImTrack_not_beenImTrialed_tip"})}});return['<span class="Sky-gIbx-mailtrack-tipstxt" style="margin-right: 8px;">'+o.t("æ–°åŠŸèƒ½ä½“éªŒï¼šé‚®ä»¶å¢å¼ºé€šçŸ¥ï¼Œè®©ä½ ä¸å†é”™è¿‡é‡è¦é‚®ä»¶")+"</span>",t].join("")},createPayTip:function(e){var t=this,i=t.view.module,a=!1,n=e?"æ–°åŠŸèƒ½ï¼šé‚®ä»¶å¢å¼ºé€šçŸ¥ï¼Œè®©ä½ ä¸å†é”™è¿‡é‡è¦é‚®ä»¶":"æ–°åŠŸèƒ½ï¼šéšæ—¶æŸ¥çœ‹é‚®ä»¶çŠ¶æ€ï¼Œç¡®è®¤å¯¹æ–¹æ˜¯å¦å·²é˜…è¯»";try{var r=$.Misc.getTime();r>=16822656e5&&r<=16835616e5&&(a=!0)}catch(e){}var s=$.Link.html({text:o.t(a?"å¼€å¯æé†’":"ç«‹å³å¼€é€š"),extcls:"Sky-gIbx-mailtrack-link",click:function(){t.openPayModal(e?"mailtrack_inbox_enable":"mailtrack_sent_enable"),i.log({action:"click",item:e?"mailtrack_has_beenImTrialed_tip":"mailtrack_has_beenTrialed_tip"})}});return['<span class="Sky-gIbx-mailtrack-tipstxt" style="margin-right: 8px;">'+o.t(a?"ã€é‚®ä»¶è¿½è¸ªã€‘å‘å‡ºé‡è¦é‚®ä»¶ï¼Œå¯¹æ–¹æ˜¯å¦æŸ¥çœ‹ï¼Ÿ":n)+"</span>",s].join("")},createPaySetTip:function(){if(!this.statusInfo.expireTime)return"";var e=$.Date.format(new window.Date(this.statusInfo.expireTime),"yyyy-MM-dd");return['<span class="Sky-gIbx-mailtrack-tipstxt">'+o.t("å·²å¼€å¯é‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œæœ‰æ•ˆæœŸè‡³")+e+"</span>"].join("")},createPaySingleTip:function(e){return['<span class="Sky-gIbx-mailtrack-tipstxt">'+o.t(e?"å·²å¼€å¯é‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œé‡è¦é‚®ä»¶éšæ—¶é€šçŸ¥":"å·²å¼€å¯é‚®ä»¶è¿½è¸ªåŠŸèƒ½ï¼Œéšæ—¶æŸ¥çœ‹é‚®ä»¶çŠ¶æ€")+"</span>"].join("")},createTimelimitTip:function(e){var t=this,i=t.view.module,a=!1;try{var n=$.Misc.getTime();n>=1682){}var r=$.Link.html({text:o.t("ç«‹å³ç»­è´¹"),extcls:"Sky-gIbx-mailtrack-link",click:function(){t.openPayModal(e?"mailtrack_inbox_expired":"mailtrack_sent_expired"),i.log({action:"click",item:"mailtrack_pay_timelimit_tip"})}});return['<span class="Sky-gIbx-mailtrack-tipstxt" style="margin-right: 8px;">'+o.t(a?"é‚®ä»¶è¿½è¸ªå·²åˆ°æœŸï¼Œç°åœ¨è´­ä¹°äº«é™æ—¶ä¼˜æƒ ï¼":"é‚®ä»¶è¿½è¸ªåŠŸèƒ½å·²åˆ°æœŸï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·ç»­è´¹")+"</span>",r].join("")},openNPS:function(){this.hasShowNPS||($.Support.showNpsPopup(),this.hasShowNPS=!0)},openTrialModal:function(){var e=this.view.module;$.Msgbox.show({statsKey:"Mbox_Guide_Popup_MailTrack",title:'<p style="color:#000000;">'+o.t("æ–°åŠŸèƒ½ï¼šé‚®ä»¶è¿½è¸ª")+"</p>",content:'<p style="color:#585E6D;" >'+o.t("é‚®ä»¶å‘é€åæ”¯æŒæŸ¥çœ‹å·²è¯»çŠ¶æ€ï¼ˆæ”¶ä»¶äººæ— æ„ŸçŸ¥ï¼‰ ï¼Œå¯¹æ–¹é˜…è¯»äº†æ‚¨çš„é‚®ä»¶åï¼Œå¯å‰å¾€â€œå·²å‘é€â€é¡µç¡®è®¤å¯¹æ–¹æ˜¯å¦å·²çŸ¥æ‚‰æ‚¨æ‰€å‘é€çš„é‚®ä»¶ã€‚")+'<p/><div style="width:345px;height:270px;margin-top:16px;border:1px solid #E3E5EC;border-radius:4px;overflow:hidden;"><img style="width:345px;" src="https://mail-activity.nos-jd.163yun.com/4ea67e5532182dfe2e51837b3d50a4c8.gif"/></div>',buttons:[{text:o.t("æš‚ä¸éœ€è¦"),click:function(){$.Log.cache({Mbox_Guide_Popup_MailTraceTrial_NoNeed:"1"}),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),e.log({action:"click",item:"mailtrack_trialed_modal_cancel"})}},{text:o.t("ç«‹å³ä½“éªŒ"),subclass:"mainBtn",click:function(){$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),n.default.trial((function(t){t&&(Promise.resolve().then(i.bind(i,54107)).then($.Function.bind((function(e){e.default.entry({extends:{trailMailTrace:!0}})}))),e.log({action:"click",item:"mailtrack_trialed_modal_ok"}))}))}}]})},openPayModal:function(e){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(t){t.default.showMailTraceBuy(e)})))},get===t.param("fid"),n=1===t.param("fid"),o=e.statusInfo;function r(e,t){var i=t&&(t.showClose||!1),a=new $.Icon({type:"mailTracking-close",extcls:"Sky-gIbx-mailtrack-close",click:t.closeCallback}),n=new $.Icon({type:"mailTracking-label",extcls:"Sky-gIbx-mailtrack-icon"});return['<div class="'+["Sky-gIbx-mailtrack-trail-tips","Sky-gIbx-mailtrack-tips"].join(" ")+'">',n.html(),'<div class="Sky-gIbx-mailtrack-content">',e,"</div>",i?a.html():"","</div>"].join("")}if(i){if(1===o.type)return(0,a.$S)("mbox_mailtrack_tip_paySet_close")||!e.trackInfo.enable?null:{type:"pay_set_tip",html:r(e.createPaySetTip(),{showClose:!0,closeCallback:function(){(0,a.$S)("mbox_mailtrack_tip_paySet_close",!0),e.hideTip()}})};if(2===o.type||3===o.type)return(0,a.$S)("mbox_mailtrack_tip_paySingle_close")||!e.trackInfo.enable?null:{type:"pay_signle_tip",html:r(e.createPaySingleTip(),{showClose:!0,closeCallback:function(){(0,a.$S)("mbox_mailtrack_tip_paySingle_close",!0),e.hideTip()}})};if(0===o.type)return 1===o.typeBefore||2===o.typeBefore?e.isShowTip("mboxRenewTipCloseTime")?{type:"pay_timelimit_tip",html:r(e.createTimelimitTip(),{showClose:!0,closeCallback:function(){e.closeTip("mboxRenewTipCloseTime"),e.hideTip()}})}:null:e.isShowTip("mboxTrialTipCloseTime")?o.beenTrialed?{type:"has_beenTrialed_tip",html:r(e.createPayTip(),{showClose:!0,closeCallback:function(){e.closeTip("mboxTrialTipCloseTime")}})}:{type:"not_beenTrialed_tip",html:r(e.createTrialTip(),{showClose:!0,closeCallback:function(){e.closeTip("mboxTrialTipCloseTime")}})}:null}else if(n){if(1===o.type)return(0,a.$S)("mbox_mailtrack_inboxTip_paySet_close")||!e.trackInfo.enable?null:{type:"pay_set_tip",html:r(e.createPaySetTip(),{showClose:!0,closeCallback:function(){(0,a.$S)("mbox_mailtrack_inboxTip_paySet_close",!0),e.hideTip()}})};if(2===o.type||3===o.type)return(0,a.$S)("mbox_mailtrack_inboxTip_paySingle_close")||!e.trackInfo.enable?null:{type:"pay_signle_tip",html:r(e.createPaySingleTip(n),{showClose:!0,closeCallback:function(){(0,a.$S)("mbox_mailtrack_inboxTip_paySingle_close",!0),e.hideTip()}})};if(0===o.type)return 1===o.typeBefore||2===o.typeBefore?e.isShowTip("mboxRenewTipCloseTime")?{type:"pay_timelimit_tip",html:r(e.createTimelimitTip(n),{showClose:!0,closeCallback:function(){e.closeTip("mboxRenewTipCloseTime"),e.hideTip()}})}:null:e.isShowTip("mboxTrialTipCloseTime")?o.imTrialed?{type:"has_imTrialed_tip",html:r(e.createPayTip(n),{showClose:!0,closeCallback:function(){e.closeTip("mboxTrialTipCloseTime")}})}:{type:"not_imTrialed_tip",html:r(e.createImTrialTip(),{showClose:!0,closeCallback:function(){e.closeTip("mboxTrialTipCloseTime")}})}:null}return""},isShowTip:function(e){var t=this.trackInfo;return!!this.ready&&$.Misc.getTime().getTime()-(t[e]||0)>=6048e5},closeTip:function(e){var t=this,i={};i[e]=$.Misc.getTime().getTime(),t.configUpdate(i,(function(){t.hideTip()}))},configUpdate:function(e,t){var i=this,a="webmail.js.mailTrackingConfig";$.Ud.getProxy({field:[a],call:function(n){var o=n[a];try{var r=JSON.parse(o),s={};$.Object.defaults(s,r),$.Object.defaults(s,e);var c=JSON.stringify(s);$.Ud.setProxy({field:a,value:c,call:function(e){i.trackInfo=s,t&&t()}})}catch(e){}}})},setGroupTooltip:function(e,t,i,a){n.default.getTraceInfoBrief({mid:t},(function(r){!function(r){var s="",c=r.readCnt||0,l=r.unReadCnt||0,d=r.attInfo,u=c+l===1,m=c>0;if(s+=u?'<div><span class="nui-ico nui-ico-mail-n"></span><span class="kN2">'+o.t("é‚®ä»¶ï¼š")+(m?o.t("æ”¶ä»¶äººå·²è¯»"):o.t("æ”¶ä»¶äººæœªè¯»"))+"</span></div>":'<div><span class="nui-ico nui-ico-mail-n"></span><span class="kN2">'+o.t("é‚®ä»¶ï¼š")+(m?0===l?o.t("å…¨éƒ¨æ”¶ä»¶äººå·²è¯»"):o.t("å·²è¯»${n}äººï¼Œæœªè¯»${m}äºº").replace("${n}",c).replace("${m}",l):o.t("æš‚æ— æ”¶ä»¶äººé˜…è¯»"))+"</span></div>",d&&d.length){var p=0,f=!1,h=!0;$.Array.each(d,(function(e,t){"downloaded"!==t.downloadStatus&&"all_downloaded"!==t.downloadStatus||p++})),0===p?h=!1:p===d.length&&(f=!0),s+='<div><span class="nui-ico nui-ico-att-n"></span><span class="kN2">'+o.t("é™„ä»¶ï¼š")+(h?f?o.t("å…¨éƒ¨é™„ä»¶å·²ä¸‹è½½"):o.t("éƒ¨åˆ†é™„ä»¶ä¸‹è½½"):o.t("æš‚ægin-top: 4px;">'+$.Link.html({text:o.t("æŸ¥çœ‹è¯¦æƒ…"),cls:"nui-txt-link",click:function(){n.default.showTraceInfo({hl:$G.environment.hl,mid:t,onContactItemClick:function(){}}),oModule.log({action:"click",item:"mailtrack_tooltip_view_detail"})}})+"</div>");var g=document.getElementById(e);g&&(g.innerHTML=s,i.mailTrackTooltip&&i.mailTrackTooltip.pointTo(a))}(r)}))},getTip:function(){var e=this,t=e.view.module,i=e.getTipConfig(),a=e.tip=new $.Component(i);try{i.tipType&&t.log("mailtrack",i.tipType)}catch(e){}return a.html()},hideTip:function(){var e=this.tip;e&&(this.currentTipType=null,e.hide())},updateTip:function(){var e=this,t=enfig();if(!t.isNone()&&a){try{a&&a.tipType===e.currentTipType||t.log("mailtrack",a.tipType)}catch(e){}e.currentTipType=a.tipType,i.update(a),i.show()}else i.hide()}},destoryTip:function(){try{this.tip.destroy(),this.tip=null}catch(e){}},initTooltip:function(e,t,i,a,n){try{var o=this.getTooltipConfig(e,t,i,a,n);return o?new $.Layer(o):null}catch(e){return null}},initialize:function(e,t){var i=this;i.view=e,t&&(i.initStatusInfo(),$.Listener.one("mailTracking:trialEnabled",(function(){i.ready&&(i.statusInfo.beenTrialed=!0,i.updateTip())})))}}),t.Z=s},36467:function(e,t,i){i(44033),i(87226),i(97687),i(68634),i(63574)},88578:function(e,t,i){i(15296),i(92274),i(8600),i(66403),i(66251),i(55737),i(803),i(48868),i(63045),i(81874),i(54861),i(42295),i(26340),i(79150),i(17503),i(49750);var a=i(14396),n=i(72957),o=i(92066),r=i(40823),s=i(20313),c=$.Object,l=$.Array,d=$.Listener,u=$.createClass((0,n.$N)("module.mbox.MboxAction"));c.mix(u,a.Z,{funcs:{"mbox:updateMessageInfos":["ntes:mbox:updateThreadInfos","ntes:mbox:updateFolderMessageInfos"],"mbox:updateMessageTags":["ntes:mbox:updateThreadTags","ntes:mbox:updateFolderMessageTags"],"mbox:deleteMessages":[null,"mbox:emptyFolder",function(e,t){e.body={id:t,permanently:!0}}]}},{setFunc:function(e,t,i,a){var n,o=u.funcs[e.func];if(t&&(n=o[0])&&(e.func=n,e.thread=!0,e.sent=i),a>0){n=o[1],e.func=n;var r=e.body;r.fid=a,delete r.ids,o[2]&&o[2](e,a)}},setArea:function(e,t){"archive"===t&&(e.body.mboxa="2")},getIds:function(e){for(var t=[],i={},a=0,n=e.length;a<n;a++){var o=e[a],r=o.id||o;r&&(t.push(r),i[r]=!0)}return[t,i]},getList:function(e,t,i){},bindExtra:function(e,t){var i={},a=[],n=[];if(e.loadExpire){var s=r.Z.loadCache(!0);a.push(sadArchive){var c=o.Z.loadArchive();a.push(c),n.push((function(e){o.Z.initArchive(e)}))}return a.length>0?(a.unshift(t),l.each(a,(function(e,t){t.var=t.body,delete t.body})),i.request={func:"global:sequential",body:{items:a}},i.handleExtra=function(e){for(var t=e.var,i=(e=t.shift(),0),a=n.length;i<a;i++)n[i](t.shift());return e}):i.request=t,i},getLetterInfo:function(e){var t,i,a,n=e.isThread,o=e.id,r=e.callback,s=$.Ext.tag,c=!1;essageInfos"summary&&$.Ud.get({field:"ntes_option",flag:"summary"})-0==1&&(a=1),t="mbox:getMessageInfos",i={ids:(c=$.Object.isArray(o))?o:[o],"summaryWindowSize ":a,returnTag:s});var l={func:t,body:i,call:function(e){var t=e.var;r(n?t:t.length>0?c?t:t[0]:null)}};e.error&&(l.error=e.error),this.wmsvr(l)},getThreadInfo:function(e){for(var t=e.ids,i={func:"global:sequential",body:{iteme.callback(t)}},a=i.body.items,n=0,o=t.length;n<o;n++)a.push({func:"mbox:getThreadMessageInfos",var:{id:t[n]}});this.wmsvr(i)},getThreadIds:function(e){this.getThreadInfo({ids:e.ids,callback:function(t){for(var i=(0,n.$I)("core.DataAction").S_OK,a=t.var,o=[],r=0,s=a.length;r<s;r++){var c=a[r];if(c.code===i)for(var l=c.var,d=0,u=l.length;d<u;d++)o.push(l[d].id)}e.callback(o)}})},getTop:function(e){var t=e.fid;t||(t=this.module.param("fid")),this.getList({fid:t,filter:{flags:{top:!0}},returnTotal:!0,limit:0},{sync:!0},(function(t){e.callback(t)}))},getSummary:function(e){var t=e.ids,i=e.pattern,a=e.callback,n={func:"mbox:getMessageSummaryInfos",body:{ids:t,pattern:i},call:function(e){a(e.var)},error:function(e){return!0}};this.wmsvr(n)},getFolderStats:function(e){var t=e.ids,i=e.filter,a=e.callback,n={func:"mbox:getFolderStats",body:{ids:t,filter:i},call:function(e){a(e.var)},error:function(){a({})}};this.wmsvr(n)},setRead:function(e){var t=this,i=e.allFid,a=e.area,n=e.isRead,o=e.data,r=!!e.voidRequest,s=e.callback,c=e.hasThread,l=e.hasSent,u={flags:{read:n}},m=t.getIds(o),p=t.getRollbackData(null,o,"read");if(r)h();else{var f={func:"mbox:updateMessageInfos",body:{ids:m[0],attrs:u},call:h};t.setFunc(f,c,void 0,i),t.setArea(f,a),t.wmsvr(f)}function h(e){var r;d.fire("letter:update",{list:m[1],action:"read",value:n,data:o,hasThread:c,hasSent:l,allFid:i,area:a}),e&&$.Ext.rollback&&!i&&(e.uk||p)&&(r=funrea:a})}),s(e,r)}},setFlag:function(e){var t=this,i=e.allFid,a=e.area,n=e.flag,o=e.data,r=e.hasThread,s=e.hasSent,c=e.callback,l={label0:n};1!==n&&(l.flags={flagged:!1});var u=t.getIds(o),m=t.getRollbackData(null,o,"flag"),p={func:"mbox:updateMessageInfos",body:{ids:u[0],attrs:l},call:function(e){var l;d.fire("letter:update",{list:u[1],action:"flag",value:n,data:o,hasThread:r,hasSent:s,allFid:i,area:a}),e&&$.Ext.rollback&&!i&&(e.uk||m)&&(l=function(i){var n=[];for(var o in m.items)n.push({ids:m.items[o],attrs:{label0:o-0}});t.rollback({uk:e.uk,data:{items:n},callback:i,area:a})}),c(e,l)}};t.setFunc(p,r,void 0,i),t.setArea(p,a),t.wmsvr(p)},setTag:function(e){var t=this,i=e.allFid,a=e.area,n=e.isAdd,o=e.tag,r=e.data,c=e.hasThread,u=e.hasSent,m=e.callback,p=t.getIds(r),f=n&&o?[o]:function(){var e=[];if(i){var t=s.Z.list();for(var a in t){var n=t[a];e.push(n.name)}}else for(var o=0,c=r.length;o<c;o++){var d=r[o].tag;if(d)for(var u=0,m=d.length;u<m;u++){var p=d[u];s.Z.get(p)&&!l.has(e,p)&&e.push(p)}}return e}(),g=t.getRollbackData(null,r,"tag"),v={func:"mbox:updateMessageTags",body:{ids:p[0],add:f,delete:h},call:function(e){var s;d.fire("letter:update",{list:p[1],action:"tag",value:o,data:r,isAdd:n,hasThread:c,hasSent:u,allFid:i,area:a}),e&&$.Ext.rollback&&!i&&(e.uk||g)&&(s=function(i){var r=[];for(var s in g.items){var c="%default%"===s?[]:s.split(","),l={ids:g.items[s]};n?l.delete=[o]:l.add=o?[o]:c,r.push(l)}t.rollback({type:"tag",uk:e.uk,data:{items:r},callback:i,area:a})}),m(e,s)}};t.setFunc(v,c,void 0,i),t.setArea(v,a),t.wmsvr(v)},setDefer:function(e){var t=this,i=e.allFid,a=e.area,n=e.type,o=!1,r=e.defer,s=e.memo,c=e.data,l=e.hasThread,u=e.hasSent,m=e.callback,p=t.getIds(c),f=t.getRollbackData(null,c,"defer"),h={};switch(n){case"add":case"modify":h.memo=s||"",h.defer=r||null,o=!!r,h.flags={deferHandle:o};break;case"complete":var g=new Date(0);h.defer=new Date(g.getTime()+6e4*g.getTimezoneOffset()),h.flags={deferHandle:o};break;case"delete":o=!0,h.memo=""}var v={func:"mbox:updateMessageInfos",body:{ids:p[0],attrs:h},call:function(e){var h;d.fire("letter:update",{list:p[1],action:"defer",value:{deferHandle:o,defer:r,memo:s},data:c,type:n,hasThread:l,hasSent:u,allFid:i,area:a}),e&&$.Ext.rollback&&(e.uk||f)&&(h=function(i){var n=[];for(var o in f.items){var r=JSON.parse(o),s=r.defer?new Date(r.defer):void 0,c=r.deferHandle,l=r.memo;n.push({ids:f.items[o],attrs:{memo:l||"",defer:c&&s?s:void 0,flags:{deferHandle:c}}})}t.rollback({uk:e.uk,data:{items:n},callback:i,area:a})}),m(e,h)}};t.setArea(v,a),t.wmsvr(v)},setMemo:function(e){var t=this,i=e.area,a=e.memo,n=e.data,o=e.hasThread,r=e.hasSent,s=e.callback,c={memo:a||""},l=t.getIds(n),u=t.getRollbackData(null,n,"memo"),m={func:"mbox:updateMessageInfos",body:{ids:l[0],attrs:c},call:function(e){var c;d.fire("letter:update",{list:l[1],action:"memo",value:a,data:n,hasThread:o,hasSent:r,area:i}),e&&$.Ext.rollback&&(e.uk||u)&&(c=function(a){var n=[];for(var o in u.items){var r=o;"undefined"===o&&(r=""),n.push({ids:u.items[o],attrs:{memo:r}})}t.rollback({uk:e.uk,data:{items:n},callback:a,area:i})}),s(e,c)}};t.setArea(m,i),t.wmsvr(m)},setTop:function(e){var t=this,i=e.fidInfo,a=e.isTop,n=e.data,o=e.hasThread,r=e.hasSent,s=e.callback,c={flags:{top:a}},l=t.getIds(n),u=t.getRollbackData(null,n,"top"),m={func:"mbox:updateMessageInfos",body:{ids:l[0],attrs:c},call:function(e){var c;d.fire("letter:update",{fid:i[1],list:l[1],action:"top",value:a,data:n,hasThread:o,hasSent:r}),e&&$.Ext.rollback&&(e.uk||u)&&(c=function(i){t.rollback({uk:e.uk,data:{ids:u.ids,attrs:{flags:{top:!a}}},callback:i})}),s(e,c)}};t.wmsvr(m)},setFilter:function(e){var t=this,i=e.ruleConditions,a=e.fids,n=e.attrs,o=e.callback;if(a&&n){var r={func:"mbox:searchMessages",body:{fids:a,ruleConditions:i},call:s};t.wmsvr(r)}else s();function s(e){var a;if(e)try{a=e.var}catch(e){}var r={func:"mbox:updateMessageInfos",body:{ids:a,attrs:a?n:void 0,rule:a&&n?void 0:i},call:function(e){d.fire("letter:setfilter"),o&&o()}};t.wmsvr(r)}},setFilterRule:function(e){var t=e.fid,i=e.email,a=e.history,n=e.callback,o={func:"ntes:mbox:addHistoryFilter",body:{fid:t,email:i,history:!!a},call:function(e){d.fire("letter:setfilterrule",a),n&&n(e)},error:function(e){if("FA_ATTR_SIZE_EXCEEDED"===e.code)return n&&n(),!0}};this.wmsvr(o)},rollback:function(e){var t=this,i=e.type,a=e.uk,n=e.data,o=e.area,r=e.callback;if(n&&(n.type=n.items?"multi":"single",o))if("single"===n.type)p(n);else for(var s=n.items,c=0,l=s.length;c<l;c++)p(s[c]);var u={func:a?"ntes:mbox:messageUndo":"tag"===i?"ntes:mbox:updateMessageTags":"ntes:mbox:updateMessageInfos",body:a?{uk:a}:n,call:m,error:function(e){if(a&&"FA_NEED_AUTH2"===e.code){for(var i=e.var,n=[],o=0,r=i.length;o<r;o++)n.push(i[o].param);var s={func:"ntes:mbox:updateMessageInfos",body:{items:n,type:"multi"},call:m};return $.AdvLock.show((funcr:rollback",{data:n}),r(e)}function p(e){"archive"===o&&(e.mboxa="2")}t.wmsvr(u)},move:function(e){var t=this,i=e.allFid,a=e.area,n=e.fidInfo,o=e.moveToId,r=e.data,s=e.hasThread,c=e.hasSent,l=e.fromThread,u=e.callback,m=t.getIds(r),p=t.getRollbackData(null,r,"move"),f={body:{ids:m[0]},call:function(e){var f;d.fire("letter:update",{fid:n[1],list:m[1],action:"move",value:o,data:r,isThread:s||c,fromThread:l,allFid:i,area:a}),e&&$.Ext.rollback&&!i&&o&&(e.uk||p)&&(f=function(i){var n=[];for(var o in p.items)n.push({ids:p.items[o],attrs:{fid:o-0}});t.rollback({uk:e.uk,data:{items:n},callback:i,area:a})}),u(e,f)}};if(o){var h=!1;if(15!==o)for(var g=0,v=r.length;g<v;g++)if(15===r[g].fid){h=!0;break}f.func="mbox:updateMessageInfos",f.body.attrs={fid:o,flags:h?{deleted:!1}:void 0}}else f.func="mbox:deleteMessages";t.setFunc(f,s,!0,i),t.setArea(f,a),t.wmsvr(f)},setSpam:function(e){var t=e.area,a=(e.data,e.isSpam),o=e.addList,r=e.deleteLetter,s=e.hasThread,c=e.hasSent,l=e.callback,u=e.ids,m=e.emails,p=e.reportType,f=e.spamType;m&&0!==m.length||(o=!1,r=!1);var h=[];try{for(var g=function(e){if(e.length>0){for(var t,i=e.split(","),a=[],n=i.length-1;n>=0;n--)o=t=$.String.trim(i[n]),(/^\S+\.\S+$/.test(o)||$.Uri.matchEmail(o))&&a.push(t);return a}var o;return[]}((0,n.$S)("attrs").user.refuselist||""),v=0;v<m.length;v++)sTmp=m[v],$.Array.has(g,sT")||h.push(sTmp)}catch(e){}var b={};h.length&&(b.refuselist=h.join(","));var y={func:"ntes:mbox:reportSpam",body:{ids:u,emails:m,reportType:p,spamType:f,mrecp:b,attrs:{deleteHistory:r,addList:o,thread:s}},call:x,error:function(e){var t=e.code;if("FA_LIST_FULL"===t||"FA_LIST_NOT_UPDATE"===t)return k(e,!0),l(S(e,!0)),!0;0===t.indexOf("FA_HOOK_SECURITY_")&&e.var.updateMessageInfos.code===$.S_OK&&x(e)}};function x(e,t){k(e),o?(d.fire("rslist:add",a?"refuse":"safe",m),Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(t){t.default.addList({name:a?"refuselist":"safelist",value:m.join(),noErr:!0,forceAdd:!0},(function(t,i){t?l(S(e)):$.Msgbox.show({title:i})}))}),this))):l(S(e))}function k(e,i){var n,o;try{n=e.var.updateMessageInfos.var.mid,o={};for(var l=0,u=n.length;l<u;l++)o[n[l]]=!0}catch(e){}d.fire("letter:setspam",a,r,s||c,!!i,o,t)}function S(e,t){var i={},a=e.var;i.lettercount=a.updateMessageInfos.var.count;try{i.historycount=a.deleteHistory.var.count}catch(e){}try{i.listcount=o?m.length:0}catch(e){}return i.listerror=!!t,i}this.setArea(y,t),this.wmsvr(y)},setAllRead:function(e){var t=this,i=e.area,a=e.body,n=(a.isThread,e.callback),o={func:"ntes:mbox:updateAllMessages",body:a,cf(d.fire("letter:allread",i),e){var o=e.var.mids;$.Ext.rollback&&({data:{ids:o,attrs:{flags:{read:!1}}},callback:e,area:i})})}n(e,a)}};t.setArea(o,i),o.body.search.mboxa=o.body.mboxa,t.wmsvr(o)},exportLr t=this,i=e.ids,a=e.isThread,o=e.callback;function r(e){var i=$.Ajax.IFRAME,a=(0,n.$S)("sid"),r={requestType:i,method:$.Ajax.POST};e.length>1?(r.url="./s?sid="+a+"&func=mbox:packMessages",r.body="mid="+e.join("&mid=")):r.url=$.Uri.getUrl("read_data",!0)+"&mode=download&mid="+e.join("")+"&l=inbox&action=export",t.request(r),o()}a?t.getThreadIds({ids:i,callback:r}):r(i)},getRollbackData:function(e,t,i){if($.Ext.rollback){if(e||(e={}),t)for(var a=0,n=t.length;a<n;a++){var o,r,s=t[a],c=s.id;switch(i){case"read":case"top":o="single";break;case"flag":r=s.label0,o="multi";break;case"memo":r=s.memo,o="multi";break;case"move":r=s.fid,o="multi";break;case"tag":r=(s.tag||[]).join()||"%default%",o="multi";break;case"defer":var l=s.defer;r=JSON.stringify({defer:l?l.getTime():l,deferHandle:!!s.flags.deferHandle,memo:s.memo||""}),o="multi"}if("single"===o)(d=e.ids)||(d=e.ids=[]),d.push(c);else{var d,u=e.items;u||(u=e.items={}),(d=u[r])||(d=u[r]=[]),d.push(c)}}return e.ids||e.items||(e=null),e}},initialize:function(e){}}),t.Z=u},95430:function(e,t,i){i(42295),i(34994),i(8600),i(48868),i(92274),i(63045),i(81874),i(54861);var a=i(99626),n=i(72957),o=(i(92066),i(60196)),r=i(40823),s=(i(20313),new n.c1("module.mbox.MboxListener")),c=$.Object,l=$.Array,d=$.createClass((0,n.$N)("module.mbox.MboxListener"));function u(e){try{for(var t=this.module.view.letters,i=0,a=t.length;i<a;i++){var n=t[i];if(n.data.id===e){n.setDefer();break}}}catch(e){}}c.mix(d,a.Z,null,{_listeners:{"sync:request":{handler:function(e,t){var i=t.listen,a=this.module,o=(a.view,a.extend("type"),a.extend("subtype")),l=a===$.Context.getModule(),d=!1;try{switch(o){case"folder":var u=a.param("fid");(S=e.Folder)&&S.info.stats&&S.info.stats[u]&&(d=!0),a.isThread()&&r.Z.showTop(u,!0)&&(k=e.Defer)&&k.info.stats&&k.info.stats.expire&&(d=!0);break;case"flag":var m=a.param("filter").label0,p=e.Flag;p&&p.info.stats&&p.info.stats[m]&&(d=!0);break;case"tag":var f=a.param("tag"),h=e.Tag;if(h&&h.info.stats)for(var g=0,v=f.length;g<v;g++)if(h.info.stats[f[g]]){d=!0;break}breaar b=a.param("filter"),y=b.chatWithAddress||b.fromAddress||b.toAddress;if((w=e.Contacts)&&w.info=x.length;g<v;g++)if(w.info.stats[x[g]]){d=!0;break}}break;case"defer":var k;(k=e.Defer)&&k.info.stats&&(d=!0);break;case"read":var S;(S=e.Folder)&&S.changed&&(d=!0);break;case"emails":var w;(w=e.Contacts)&&w.changed&&(d=!0);break;default:c.each(e,(function(e,t){if(t.changed)return d=!0,$.BREAK}))}}catch(e){n.­¥äº‹ä»¶å‡ºé”™"),error:e})}d&&(i||(l?a.replace():this.lazyReplace(a)),a.view.update())}},"letter:update":{handler:function(e){try{var t=(0,n.$L)("interface.MboxInterface",this)}catch(e){return e}var i=this,a=i.module,s=a.view,d=a.param("fid"),u=a.extend("subtype"),m=a.extend("brand"),p=e.fid,f=e.list,h=e.action,g=e.value,v=e.data,b=e.type,y=v.length,x=e.hasThread,k=e.hasSent,S=e.allFid,w=a.isThread(),T=$.Context.getModule(),C=a===T,_={},I=!1,A=!1,M=!0,L=!1,E=!1,D=!1,R=!1,P=!1,F=!1;if(S>0)I=!0;else if("top"===h&&p&&(p[d]||w)&&a.isTop())I=!0;else if("flag"===h){if("flag"===u)I=!0,A=!0;else if("normal"===u)for(var j=a.param("conditions"),N=0,U=j.length;N<U;N++)if("label0"===j[N].field){I=!0;break}}else if("read"===h){if("read"===u||"emails"===u)E=!0;else try{!1===a.param("filter").flags.read&&(E=!0)}catch(e){}R=!0}else if("tag"===h&&"tag"===u)I=!0;else if("defer"===h&&"defer"===u)I=!0,D=!0;else if("defer"!==h||"add"!==b&&"complete"!==b&&"modify"!==b||"folder"!==u)if("move"===h){if(p[d]||d===g||w)I=!0,A=!0;else if(g&&4!==g||"search"!==a.extend("type")){if(g)switch(u){case"contacts":case"flag":case"tag":var K=$G.common.unnormalids;if(!g||l.has(K,g))I=!0,A=!0;else for(N=0,U=v.length;N<U;N++)if(l.has(K,v[N].fid)){I=!0;break}break;case"defer":break;default:I=!0,A=!0}else if("defer"===u||m)I=!0,A=!0;else if("folder"===u){var O=r.Z.getDate("tomorrow");for(N=0,U=v.length;N<U;N++)try{var Y=v[N];if(Y.flags.deferHandle&&Y.defer<O){D=!0,I=!0;break}}catch(e){}}}else I=!0,A=!0;"archive"===e.area&&"archive"!==a.extend("area")&&"folder"===u&&(L=!0),R=!0}else"tracking"===h&&(F=!0);else I=!0,M=!0,D=!0,w&&(P=!0);if("mailteam"===h&&s.syncLetter(h,y,f,v),L&&a.extend("forceRequest",!0),E&&a.extend("forcePage",!0),D&&r.Z.setCache(),P&&s.tips.update(),R&&m)if(C)try{a.refreshBrand()}catch(e){}else a.extend("forceBrand",!0);if(F&&v.length){var B=a.data,H={},G=0;return c.each(v,(function(e,t){H[t.mid]=t.readStatus})),$.Array.each(B,(function(e,t){H[t.id]&&(t.mailTackStatus=H[t.id],G++)})),void s.syncLetter("mailTrack",G,H)}if(function(){try{var i=a.getCacheData(-1);if(!i)try{var n=s.letters;i=[];for(var o=0,r=n.length;o<r;o++)i.push(n[o].data)}catch(e){}if(i)for(var c=0,l=0,d=i.length,u=v.length;c<d&&l<u;c++){var m=i[c];m&&f[m.id]&&(t.syncData(e,m)&&(_[m.id]=!0),l++)}}catch(e){}}(),I&&!C)i.lazyReplace(a);else{if(M)for(N=0,U=v.length;N<U;N++)_[v[N].id]=!0;if(c.count(_)>0){if(I?a.replace(h,A,y,f,_):s.syncLetter(h,y,f,_),C&&I){var z=s.getLayout();z&&$.SM.go({parent:a,module:"mbox.PreviewModule",param:{layout:z},viewType:z,sharebar:!0,cacheDom:!1,reset:!1}"letter:closead":{handler:function(e){var t=this.module;if(t.view,"mboxAd"==e||!e){try{t.getDom("AdDiv").style.display="none"}catch(e){}(0,n.$S)("mboxAdClosed",!0),$.LocalStorage.set("mailmboxpro","1",{domain:(0,n.$S)("fullDomain"),expires:7})}if("mboxFooterAd"==e){try{t.getDom("FooterDiv").style.display="none"}catch(e){}(0,n.$S)("mboxFooterAdClosed",!0)}}},"letter:rollback":{handler:function(e){var t=this.module,i=t.view;t===$.Context.getModule()?i.refresh(t.extend("index")):this.cleanCache(t)}},"letter:setspam":{handler:function(e,t,i,a,n){var o=this.module,r=o.view;o===s.cleanCache(o)}},"letter:allread":{handler:function(e){var t=this.module,i=t.view;e===t.extend("area")&&(t===$.Context.getModule()?i.refresh(t.extend("index")):this.cleanCache(t))}},"letter:setfilter":{handler:function(){var e=this.module;this.cleanCache(e)}},"letter:setfilterrule":{handler:function(e){if(e){var t=this.module,i=t.view;t===$.Context.getModule()?i.refresh(t.extend("index")):this.cleanCache(t)}}},"letter:schedule":{handler:function(){var e=this.module;this.lazyReplace(e)}},"search:removeall":{handler:function(){var e=this.module;this.cleanCache(e)}},"compose:send":{handler:function(){var e=this.module,t=e.param("fid");2!==t&&3!==t||this.cleanCache(e)}},"folder:add":{handler:function(e){var t=this.module;t.view.toolbar.update(),"search"===t.extend("type")&&t.param("fids").push(e)}},"folder:modify":{handler:function(e){var t=this.module,i=t.param("fid");i===e&&t.view.update(),i||(t===$.Context.getModule()?t.view.goPage(t.extend("index"),!0):this.cleanCache(t))}},"folder:remove":{handler:function(e){var t=this.module,a=$.Context.getModule();e===t.param("fid")?t===a?Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.entry({fid:1})}),this)):(this.cleanCache(t,!0),$.MultiTab.remove(t)):t.view.toolbar.update()}},"folder:empty":{handler:function(e){var t=this.module,i=(t.view,$.Context.getModule()),a=t.param("fid");e!==a&&4!==e&&a||(i===t?t.replace("folder"):this.lazyReplace(t))}},"folder:keep":{handler:function(e){var t=this.modte()}},"tag:add":{handler:function(e){var t=this.module.view;t.toolbar.update(),c.each(t.letters,(function(e,t){try{t.components.tagmanage.menu.update(t.tagManage())}catch(e){}}))}},"tag:modify":{handler:function(e,t){var i=this.module,a=i.view,n=$.Context.getModule(),o=!1;if("tag"===i.extend("subtype")&&t){var r=i.param("tag");l.has(r,e)&&($.MultiTab.remove(i),$.JS.remove(i),o=!0)}n===i?o||i.replace("tag"):this.lazyReplace(i),a.toolbar.update()}},"tag:remove":{handler:function(e){var t=this.module,i=t.view,a=$.Context.getModar o=t.param("tag");l.has(o,e)&&($.MultiTab.remove(t),$.JS.remove(t),n=!0)}t===a?n||t.replace("tag"):this.lazyReplace(t),i.toolbar.update()}},"options:inboxModify":{handler:function(e){for(var t=this.module,i=t.view,a=t===$.Context.getModule(),n=t.extend("index"),o={},r=0,s=e.length;r<s;r++){var c=e[r],l=c.field,d=c.flag,u=c.value;"ntes_letter"===l?"font_size"!==d&&"line_height"!==d||(o.setClass=!0):"ntes_option"===l?"sizeshow"===d?o.forceRequest=!0:"sendershow"!==d&&"summary"!==d||(o.forceRequest=!0):"ntes_inbox"===l?"layout"===d&&(t.extend("forceRequest",!0),o.forceRequest=!0):"maxlist"===l&&(t.extend("limit",u),o.forceRequest=!0)}o.setClass&&(i.setClass(),a||i.toolbar.update()),o.forceRequest&&(a?t.view.refresh(n,!0,!1,!0):this.cleanCache(t)),$.Object.count(o)>0&&a&&i.toolbar.update()}},"options:contactModify":{handler:function(e){for(var t=this.module,i=(t.view,t.extend("index")),a=$.Context.getModule(),n=0,o=e.length;n<o;n++){var r=e[n],s=r.field,c=r.flag;r.value,"ntes_option"===s&&"sendershow"===c&&(t===a?t.view.refresh(i,!0):this.cleanCache(t))}}},"addr:dataInit":{handler:function(){var e=this.module,t=e.view,i=e.extend("index"),a=$.Context.getModule();if($.Ud.get({field:"ntes_option",flag:"sendershow"})-0==2?e===a?e.view.refresh(i):this.cleanCache(e):e.view.markContact(),"contacts"===e.extend("subtype"))try{t.title.update()}catch(e){n.$D.log({text:s.t("é€šè®¯å½•æ”¹å˜åä¿®æ”¹è”ç³»äººç»´åº¦çš„æ ‡é¢˜å‡ºé”™"),error:e})}}},"addr:dataReset":{handler:function(e){var t=this.module,i=t.view,a=t.extend("index"),o=$.Context.getModule();if($.Ud.get({field:"ntes_option",flag:"sendershow"})-0==2?t===o?t.view.refresh(a):this.cleanCache(t):t.view.markContact(),"contacts"===t.extend("subtype"))try{i.title.update()}catch(e){n.$D.log({text:s.t("é€šè®¯å½•æ”¹å˜åä¿®æ”¹è”ç³»äººç»´åº¦çš„æ ‡é¢˜å‡ºé”™"),error:e})}}},"addr:dataMark":{handler:function(e){var t=this.module;try{"emails"===t.extend("subtype")&&""===t.param("filter").chatWithAddress&&(0,n.$E)(["support.AddressSupport","interface.MboxInterface"],(function(e,t){var i=e.getMarkData();t,"read:recall":{handler:function(e){var t=this.module,i=t.view,a=$.Context.getModule();3===t.param("fid")&&(t===a?t.replace("recall"):this.lazyReplace(t),i.update())}},"read:wmsvrDelete":{handler:function(){var e=this.module,t=(e.view,$.Context.getModule());3===e.param("fid")&&(e===t?e.view.refresh(e.extend("index")):this.cleanCache(e))}},"read:mailStatusUpdate":{handler:function(e,t){var i=this.module;if(3===i.param("fid"))try{this.cleanCache(i)}catch(e){}}},"global:resize":{handler:function(){try{this.module._child.setWidth()}catch(e){}}},"schedule:insert":{handler:u},"schedule:remove":{handler:u},"ad:dataChange":{handler:function(e){try{var t=this.module.view;switch(e){case"letter":t.getAd(!0);break;case"inboxBottom":t.getFooter(!0);break;case"brand":t.showBanner(!0)}}catch(e){}}},"options:skinChange":{handler:function(){$(".Bp0 .wn2")&&$(".Bp0 .wn2").css({backgroundColor:"#"+((0,n.$S)("skin").color||"6A8DE5")})}},"tips:update":{handler:function(){try{this.module.view.tips.view.update()}catch(e){return e}}},"popup:update":{handler:function(){try{this.module.view.showPopup()}catch(e){return e}}}},cleanCache:function(e,t){e.isRendered&&e.cleanCache(t)},lazyReplace:function(e){e.isRendered&&e.lazyReplace()}}),t.Z=d},44033:function(e,t,i){i.r(t),i(48868),i(92274),i(63045),i(81874),i(54861),i(42295),i(52963),i(68233),i(86305),i(803),i(79150),i(34994),i(37092),i(66251),i(49750),i(8600);var a=i(1124),n=i(95430),o=i(49134),r=i(88578),s=i(4982),c=i(28978),l=i(92066),d=i(60196),u=i(40823),m=i(20313),p=i(72957),f=new p.c1("module.mbox.MboxModule"),h=$.Object,g=($.Number,$.Browser.isIE("<9")),v=$.createClass((0,p.$N)("module.mbox.MboxModule"));function b(e){var t=this,i=t instanceof v;try{!e&&i&&(e=t.param("fid"))}catch(e){}return l.Z.isTop(e)&&(!i||"archive"!==t.extend("area")&&"date"===t.param("order")&&!0===t.param("desc"))}h.mix(v,c.Z,{interface:a.default,View:o.Z,Listener:n.Z,Action:r.Z,cls:"tX0",ariaLabel:f.t("æ”¶ä»¶ç®±"),action:new r.Z,parseFid:function(e){for(var t=[],i={},a=0,n=e.length;a<n;a++){var o=e[a].fid;i[o]||(t.push(o),i[o]=!0)}return[t,i]},isTop:b,setRead:function(e){var t=e.callback,i=this.hasThreadAndSent(e.data),a=i[0],n=i[1],o=this.action;h.extend(e,{hasThread:a,hasSent:n,callback:function(e,i){t&&t(e,i)}}),o.setRead(e)},setFlag:function(e){var t=e.single,i=e.callback,a=this.hasThreadAndSent(e.data),n=!t&&a[0],o=!t&&a[1];h.extend(e,{hasThread:n,hasSent:o,callback:function(e,t){i&&i(e,t)}}),delete e.single,this.action.setFlag(e)},setTag:function(e){var t=e.callback,i=this.hasThreadAndSent(e.data),a=i[0],n=i[1],o=this.action;h.extend(e,{hasThread:a,hasSent:n,callback:function(e,i){t&&t(e,i)}}),o.setTag(e)},setDefer:function(e){var t=e.callback,a=e.data,n=this.hasThreadAndSent(a),o=n[0],r=n[1],s=this.action;h.extend(e,{hasThread:o,hasSent:r,callback:function(n,o){if(1===a.length){var r=a[0],s=e.smsDate;s&&Promise.resolve().then(i.bind(i,26406)).then($.Function.bind((function(e){e.default.insert(r.subject,r.id,s)}),this))}t&&t(n,o)}}),s.setDefer(e)},setMemo:function(e){var t=e.callbend(e,{hasThread:a,hasSent:n,callback:function(e,i){t&&t(e,i)}}),this.action.setMemo(e)},setFilter:function(e){var t=e.ruleConditions,i=e.fids,a=e.attrs,n=e.callback;this.action.setFilter({ruleConditions:t,fids:i,attrs:a,callback:function(e){n&&n(e)}})},rollback:function(e){var t=e.rollback,i=e.callback;t((function(e){i&&i(e)}))},switchIn:function(){this.view.getAd()},move:function(e){var t=this,a=e.moveToId,n=e.data,o=e.callback,r=t.action,s=t.parseFid(n),c=t.hasThreadAndSent(n),l=c[0],d=c[1];if(h.extend(e,{fidInfo:s,hasThread:l,hasSent:d,callback:function(e,t){o&&o(e,t);for(var i=0,r=n.length;i<r;i++){var s=n[i],c=$.Uri.getEmails(s.from);$.Log.cache({mbox_move_mail:{value:a,mid:s.id,from:c.match[0].address}})}}}),a>0)b();else{var u=function(){2===g&&m()},m=function(){var e,t="",a=(0,p.$S)("isFree"),n=(0,p.$S)("isVip"),o=v.member&&v.member["product.vipMember"],r=2===v.recoveryStatus,s=1===v.recoveryStatus,c=function(t){return new $.Link({text:t,click:function(){(0,p.$E)("interface.OutlinkInter|s||t===f.t("äº†è§£è¯¦æƒ…>>>")?e.goOutlink({fullScreen:!0,key:"recovery",title:f.t("è¯¯åˆ æ¢å¤")}):Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showDialog("deleteRecovery","","mbox_recovery_dialog")})))})),e.close()}})},l=c(r?f.t("è¯¯åˆ æ¢å¤"):f.t("ç«‹å³å¼€é€š>>>")),d="";o&&r&&(d="member_did_valid",t=f.t("å°Šæ•¬çš„é‚®ç®±ä¼šå‘˜ï¼Œ")+f.t("æ‚¨å·²å¼€é€šè¯¯åˆ æ¢å¤åŠŸèƒ½ï¼Œ10å¤©å†…å¯åœ¨ ")+l.html()+f.t(" ä¸­æ‰¾å›å·²åˆ é™¤é‚®ä»¶")),o&&!r&&(d="member_not_valid",t=f.t("å°Šæ•¬çš„é‚®ç®±ä¼šå‘˜ï¼Œ")+f.t("æ‚¨äº«æœ‰è¯¯åˆ æ¢å¤æƒç›Šï¼ˆæœªå¼€é€šï¼‰ï¼Œå¼€é€šåå¯åœ¨10å¤©å†…æ‰¾å›å·²åˆ é™¤é‚®ä»¶")+"<br /><br />"+l.html()),n&&r&&(d="vip_did_valid",t=f.t("å°Šæ•¬çš„VIPé‚®ç®±ç”¨æˆ·ï¼Œ")+f.t("æ‚¨å·²å¼€é€šè¯¯åˆ æ¢å¤åŠŸèƒ½ï¼Œ10å¤©å†…å¯åœ¨ ")+l.html()+f.t(" ä¸­æ‰¾å›å·²åˆ é™¤é‚®ä»¶")),n&&!r&&(d="vip_not_valid",t=f.t("å°Šæ•¬çš„VIPé‚®ç®±ç”¨æˆ·ï¼Œ")+f.t("æ‚¨äº«æœ‰è¯¯åˆ æ¢å¤æƒç›Šï¼ˆæœªå¼€é€šï¼‰ï¼Œ10å¤©å†…å¯åœ¨ è¯¯åˆ æ¢å¤ ä¸­æ‰¾å›å·²åˆ é™¤é‚®ä»¶ã€‚")+"<br /><br />"+l.html()),a&&!o&&(s?(d="pay_not_valid",t=f.t("æ‚¨äº«æœ‰è¯¯åˆ æ¢å¤æƒç›Šï¼ˆæœªå¼€é€šï¼‰ï¼Œ10å¤©å†…å¯åœ¨ è¯¯åˆ æ¢å¤ ä¸­æ‰¾å›å·²åˆ é™¤é‚®ä»¶ã€‚")+"<br /><br />"+c(f.t("ç«‹å³å¼€é€š>>>")).html()):r?(d="pay_did_valid",t=f.t("æ‚¨å·²å¼€é€šè¯¯åˆ æ¢å¤åŠŸèƒ½ï¼Œ10å¤©å†…å¯åœ¨ ")+l.html()+f.t(" ä¸­æ‰¾å›å·²åˆ é™¤é‚®ä»¶")):(d="not_valid",$.Ud.getProxy({field:["product.mail.deleterecovery.switch"],call:function(a){if(0!==a["product.mail.deleterecovery.switch"]){var n=new $.Link({text:f.t("å…³é—­ä¿ç•™åŠŸèƒ½"),click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"BaseSetModule",inputName:"Secf.t("å½»åº•åˆ é™¤åé‚®ä»¶å°†é¢å¤–ä¿ç•™10å¤©")+"("+n.html()+")"+f.t(", æ‚¨å¯ä»¥æå‰")+c(f.t("å¼€å¯è¯¯å•åˆ é™¤çš„é‚®ä»¶ã€‚")+"<br /><br />"+c(f.t("äº†è§£è¯¦æƒ…>>>")).html()}else t=f.t("å½»åº•åˆ é™¤åï¼Œé‚®ä»¶å°†æ— æ³•æ‰¾å›ã€‚æ‚¨å¯ä»¥æå‰")+c(f.t("å¼€å¯è¯¯åˆ æ¢å¤")).html()+f.t("ï¼Œæ”¯æŒæ‰¾å›10å¤©å†…å½»åº•åˆ é™¤çš„é‚®ä»¶ã€‚")+"<br /><br />"+c(f.t("äº†è§£è¯¦æƒ…>>>")).html()}}))),e=$.Msgbox.show({type:"confirm",content:t,title:f.t("ç¡®å®šå½»åº•åˆ é™¤é‚®ä»¶å—ï¼Ÿ"),ok:function(){var e={};e["delete_confirm_msgbox_confirm_click_"+d]=1,$.Log.cache(e),b()}}),$.Component.setEvents();var u={};u["delete_confirm_msgbox_show_"+d]=1,$.Log.cache(u)},g=0,v={member:null,recoveryStatus:null};$.Ud.getProxy({field:["product.vipMember"],call:function(e){v.member=e,g++,u()}}),i.e(603).then(i.bind(i,94253)).then($.Function.bind((function(e){e.default.validStatus((function(e){v.recoveryStatus=e,g++,u()}))})))}function b(){r.move(e)}},setSpam:function(e){var t=$.SenderList,a=e.area,n=e.isSpam,o=e.data,r=[],c=e.callback,l=this.action,d=this.hasThreadAndSent(o),u=d[0],m=d[1],p=$.Context.getModule();if(n)Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(e){var t=e.default;t.getSafeList({call:function(e){var i,a,n,o=y();if(o.length&&e){for(var r=e.split(/,\s*/),s=[],c=0;c<o.length;c++){var l=o[c];$.Array.has(r,l)&&s.push(l)}s.length?(a="safelist",n=(i=s).join(","),$.Msgbox.show({statsKey:"report_remove_safelist",type:"confirm",icon:"ask-l",header:f.t("ä¸¾æŠ¥æç¤º"),title:f.t("å‘ä»¶äººï¼ˆ")+i.join(", ")+f.t("ï¼‰å·²å­˜åœ¨äºæ‚¨çš„ç™½åå•ï¼Œä¸¾æŠ¥å‰æ˜¯å¦éœ€è¦å°†å…¶ç§»å‡ºç™½åå•ï¼Ÿ"),okText:f.t("ç§»å‡º"),ok:function(){t.removeList({name:a,value:n,noErr:!0},(function(e,t){var i={};e?($.Tips.show({succ:!0,text:f.t("ç§»å‡ºæˆåŠŸ")}),i["report_remove_"+a+"_success_show"]=1):($.Tips.show({succ:!0,text:f.t("ç§»å‡ºå¤±è´¥")}),i["report_remove_"+a+"_fail_show"]=1),b(),$.Log.cache(i)}))},cancelText:f.t("ç›´æ¥ä¸¾æŠ¥"),cancel:function(){$.Log.cache({report_remove_direct_click:1}),b()}})):b()}else b()}})})));else{var g=e.fid||p.fid;$.Array.has([5,7,18],g)?Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(t){t.default.isHitFilter((function(t){if(!t.disabled){for(var i=!1,a=0;a<t.actions.length;a++){var n=t.actions[a];if("move"===n.type&&n.target===g){i=!0;break}}if(i){for(a=0;a<o.length;a++){for(var r=o[a],s=[],c=!1,l=0;l<t.condictions.length;l++){var d=t.condictions[l];switch(0==l&&(c=d.flagOperatorOr),d.field){case"from":for(var u=!1,m=e.readData?e.readData.from.concat(e.readData.headers.Sender||[]):r.from.split(/,\s*/),p=0;p<m.length;p++){var f=m[p];if($.Uri.getAddress(f).indexOf(d.operand)>-1){u=!0;break}}u="contains"===d.operator?u:!u,s.push(u?1:0);break;case"recipients":for(u=!1,m=e.readData?e.readData.to:r.to.split(/,\s*/),p=0;p<m.length;p++)if(f=m[p],$.Uri.getAddress(f).indexOf(d.operand)>-1){u=!0;break}u="contains"===d.operator?u:!u,s.push(u?1:0);break;case"subject":u=r.subject.indexOf(d.operand)>-1,u="contains"===d.operator?u:!u,s.push(u?1:0)}}if(c?$.Array.has(s,1):!$.Array.has(s,0))return!0}return!1}}}),(function(e){e?$.Msgbox.show({statsKey:"report_ishit_mailFilter",type:"confirm",header:f.t("æç¤º"),title:f.t("è¯¥é‚®ä»¶å¯èƒ½å› ä¸ºæ‚¨çš„æ¥ä¿¡åˆ†ç±»è§„åˆ™è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¦‚è¯¥è§„åˆ™å·²ä¸éœ€è¦ï¼Œè¯·å‰å¾€ä¿®æ”¹"),okText:f.t("å‰å¾€ä¿®æ”¹"),ok:function(){$.Log.cache({report_ishit_mailFilter_modify_click:1}),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"MailFilterModule"})})))},cancelText:f.t("æš‚ä¸ä¿®æ”¹"),cancel:function(){$.Log.cache({report_ishit_mailFilter_notModify_click:1}),v()}}):v()}))}))):v()}function v(){var e=new $.Checkbox({text:f.t("æŠŠå‘ä»¶äººåŠ å…¥ç™½åå•")});$.Msgbox.show({type:"confirm",content:e.html(),title:f.t("æ‰€é€‰é‚®ä»¶å°†è¢«ç§»åŠ¨åˆ°æ”¶ä»¶ç®±"),ok:function(){try{for(var t=0,i=o.length;t<i;t++){var a=o[t],n="string"==typeof a.from?decodeURIComponent(a.from):a.from,s=$.Uri.getEmails(n);s.match&&s.match.length&&p.log("spam","normal",{value:1,mid:a.id,from:s.match[0].address})}var c=y();x(e.checked,!1,r,c)}catch(e){console.warn(e)}}}),$.Component.setEvents()}function b(){for(var e=[{text:f.t("ä»¿å†’é‚®ä»¶ï¼ˆä»¿å†’å„ç±»é€šçŸ¥ï¼‰"),value:"3",checkedchange:S},{text:f.t("è‰²æƒ…é‚®ä»¶"),value:"4",checkedchange:S},{text:f.t("é’“é±¼é‚®ä»¶ï¼ˆè¯±å¯¼éª—å–ä¿¡æ¯ï¼‰"),value:"5",checkedchange:S},{text:f.t("è¿æ³•é‚®ä»¶"),value:"6",checkedchange:S},{text:f.t("ä»£å¼€å‘ç¥¨"),value:"7",checkedchange:S},{text:f.t("å¹¿å‘Šæ¨å¹¿"),value:"8",checkedchange:S},{text:f.t("å…¶ä»–é‚®ä»¶"),value:"9",checkedchange:S}],t=[],a=[],n=0;n<e.length;n++){var c=new $.Radio(e[n]);a.push(c),n%2==0&&t.push("<tr>"),t.push("<td>"),t.push(c.html()),t.push("</td>"),n%2==1&&t.push("</tr>")}e.length%2==1&&t.push("</tr>"),$.Radio.group(a);var l,d=new $.Checkbox({extcls:"nui-item",text:f.t("å°†å‘ä»¶äººåŠ å…¥é»‘åå•ï¼ˆæ‹’æ”¶è¯¥å‘ä»¶äººçš„é‚®ä»¶ï¼‰"),checkedchange:b}),u=new $.Checkbox({extcls:"nui-item",text:f.t("å°†å‘ä»¶äººçš„å†å²æ¥ä¿¡ç§»åˆ°åƒåœ¾é‚®ä»¶"),checkedchange:b}),m="<strong>"+f.t("æ‚¨ä¸¾æŠ¥çš„é‚®ä»¶ç±»å‹ä¸ºï¼š")+"</strong>",g='<div class="xf1"><div class="kZ1"><table>'+t.join("")+"</table></div>"+d.html()+"<br/>"+u.html()+'<span class="nui-txt-impt">'+f.t("(è°¨æ…)")+"</span></label></div>",v=s.default.isLowAntiSpamLevel();function b(){var e=f.t("ç¡® å®š");(d.checked||u.checked)&&(e=f.t("ä¸‹ä¸€æ­¥")),l.buttons.ok.setText(e)}function k(){try{p.log("spam","close")}catch(e){}}function S(){l.buttons.ok.setDisabled(!1)}function w(){var e,t=d.checked,i=u.checked,n=a[0].ownerGroup.value,s=y();if(n){try{for(var c=0,l=o.length;c<l;c++){var m=o[c],g=$.Uri.getEmails(m.from);p.log("spam","type",$.Support.getStatsMailinfo({value:n,mid:m.id,from:g.match[0].address},m.id))}t&&p.log("spam","add"),i&&p.log("spam","delete")}catch(e){}if(t||i)if(s.length>0){var v=[],b=[];for(c=0,l=s.length;c<l;c++)try{var k=new $.Uri(s[c]),S=k.getNameWithoutPrefix(),w=k.address;w&&b.push({value:w,text:'<strong class="nui-txt-normal">'+S+'</strong><em class="nui-txt-tips">&lt;'+w+"&gt;</em>",title:w,checked:!0})}catch(e){}e=new $.CheckGroup({type:"vertical",items:b,checkType:"checkbox"});var T=[];t&&(T[T.length]='<p class="nui-item"><strong class="nui-txt-impt">'+f.t("ç¡®å®šè¦æŠŠä¸‹åˆ—é€‰ä¸­çš„å‘ä»¶äººåŠ å…¥é»‘åå•ï¼Ÿ")+"</strong></p>"),i&&(T[T.length]='<p class="nui-item"><strong class="nui-txt-impt">'+f.t("ç¡®å®šè¦åˆ é™¤è¯¥å‘ä»¶äººçš„å†å²æ¥ä¿¡ï¼ˆè°¨æ…ï¼‰ï¼Ÿ")+"</strong></p>"),v[v.length]='<div class="nui-scroll qn0" style="height:180px;">'+e.html()+"</div>",t&&(v[v.length]='<div style="margin-top: 10px;">'+f.t("åŠ å…¥é»‘åå•åï¼Œæ‚¨å°†ä¸å†æ”¶åˆ°æ¥è‡ªè¿™äº›å‘ä»¶äººçš„é‚®ä»¶ï¼Œå…¶å‘é€çš„æ‰€æœ‰é‚®ä»¶å°†å…¨éƒ¨ç§»åŠ¨åˆ°åƒåœ¾ç®±ã€‚")+"</div>"),$.Msgbox.show({statsKey:"refuselist_popup",type:"confirm",header:f.t("ç¦æ­¢å‘ä»¶äºº"),content:v.join(""),title:T.join(""),ok:C}),$.Component.setEvents()}else C();else C()}function C(){var a,o=y();if($.Log.cache({reportList$Type:o.join("|")+"$"+n}),e){a=[];var s=e.getValue();h.each(s,(function(e,t){a.push(t)}))}x(t,i,r,a,n)}}$.Ud.getProxy({field:["product.mail.antiSpamLevelOrSmartSort"],call:function(e){e&&1==e["product.mail.antiSpamLevelOrSmartSort"]&&v&&(g+='<br/><br/><span class="nui-txt-impt">'+f.t("å°æç¤ºï¼šååƒåœ¾çº§åˆ«è®¾ç½®è¿‡ä½æˆ–å…³é—­äº†æ™ºèƒ½åˆ†ç±»ï¼Œå»ºè®®é‡æ–°")+"</span> "+new $.Link({text:f.t("è®¾ç½®"),click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"AntiSpamModule"})}))),l.close()}}).html()),l=$.Msgbox.show({statsKey:"report_popup",type:"confirm",header:f.t("ä¸¾æŠ¥é‚®ä»¶"),content:g,title:m,ok:w,cancel:k,close:k}),$.Component.setEvents(),l.buttons.ok.setDisabled(!0)}})}function y(){for(var e=[],i={},a=0,n=o.length;a<n;a++){var s=o[a];$.Array.has(r,s.id)||r.push(s.id);for(var c=s.from.split(","),l=!1,d=0,u=c.length;d<u;d++){var m=$.String.trim($.Uri.getAddress($.String.trim(c[d]).replace("+",""))).toLowerCase();i[m]||t.isSender(m)||(i[m]=!0,""!==m?e.push(m):l=!0)}try{if(l){var p=$.String.trim($.Uri.getAddress($.String.trim(s.from).replace("+",""))).toLowerCase();e.push(p)}}catch(e){console.warn(e)}}return e}function x(e,t,i,r,s){l.setSpam({area:a,reportType:n?"spam":"notspam",spamType:s,isSpam:n,addList:e,deleteLetter:t,data:o,ids:i,emails:r,hasThread:u,hasSent:m,callback:k})}function k(e){c&&c(e)}},setAllRead:function(e){var t=this.action,i=e.callback;e.callback=function(e,t){i&&i(e,t)},t.setAllRead(e)},exportLetter:function(e){var t=this.action,i=e.ids,a=e.isThread,n=e.callback;t.exportLetter({ids:i,isThread:a,callback:function(e){n&&n()}})},forwardLetter:function(e){var t=this.action,a=e.ids,n=e.isThread,o=e.callback;function r(e){Promise.resolve().then(i.bind(i,54107)).then($.Function.bind((function(t){t.default.forward({id:e}),o&&o()})))}n?t.getThreadIds({ids:a,callback:r}):r(a)},hasThreadAndSent:function(e){var t=!1,i=!1;if(d.Z.check())for(var a=0,n=e.length;a<n;a++){var o=e[a];if(3===o.fid&&(i=!0),o.threadMessageCount>1&&(t=!0),t&&i)break}return[t,i]},getLayout:function(e,t){var i,a=$.Ud.get({field:"ntes_inbox",flag:"layout"})-0;switch((g||e&&e.extend&&"full"===e.extend("viewLayout")||t&&t.extend&&"full"===t.extend.viewLayout)&&(a=0),a){case 3:i="l-r";break;case 2:i="t-b";break;default:i=""}return i},keydown:function(){try{var e=$.Event.get(),t=$.Context.getModule();"mbox"==t.logPrefix&&(38===e.which?t.onFocus(-1):40===e.which&&t.onFocus(1))}catch(e){}},entry:function(e,t,i){var a,n;if(t.moduleName&&(a=$.JS.find(t.moduleName),delete t.moduleName),a){var o=a._var;o.call=i,o.cacheDom=!0,n=a}else{var r="mbox."+("search"===t.type?"SearchModule":"ListModule"),s=!1,c=!1;if(a=$.JS.get(r,e)){if(a._cacheCleaned)c=!0;else{var l=t.index;a.extend("index")===l?s=!0:a.setVar("extend","index",l)}2===a.param("fid")&&(c=!0,s=!1),(t.forceRequest||a.extend("forceRequest")||a.extend("forceReplace")||a.extend("forcePage"))&&(c=!0,s=!1,delete t.forceRequest,a.setVar("extend","forceRequest"),a.setVar("extend","forceReplace"),a.setVar("extend","forcePage")),a.view.completed||(s=!1);try{a._child.view.changeSelect()}catch(e){}a===$.Context.getModule()&&(a.scrollTop=0),c&&a.cleanData(),h.extend(a.extend(),t)}n={module:r,param:e,extend:t,call:i,cacheDom:s,reset:!1,exit:!1};var d=this.getLayout(a,n);n.hasChildMod=!0,n.sharebar=!0,n.viewType=d;try{(t=n.extend).brand&&(d?t.brand=!1:n.fixViewType="brand")}catch(e){}}a&&(a._viewType=d),"folder"===t.subtype&&$.Log.cache({mbox_folder_enter:e.fid});try{a&&a.view&&3===e.fid&&"list"===t.type&&a.view.mailtrack.initStatusInfo()}catch(e){console.log(e)}$.JS.go(n)}},{logPrefix:"mbox",total:-1,scrollTop:0,keyword:void 0,getData:function(e,t,i){},init:function(){var e=this,t=e.view,a=e.getDom("ScrollDiv");delete e.scrollTop,e.scroll(void 0,(function(){e.scrollTop=a.scrollTop})),t.createInterval(),t.listen(),function(){try{var a=t.getLayout();a?e.extend("saveLayout")?e.extend("saveLayout",void 0):$.SM.go({parent:e,module:"mbox.PreviewModule",param:{layout:a},viewType:a,sharebar:!0,cacheDom:!1,reset:!1}):e.extend("brand")&&Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.brandLoad()})))}catch(e){p.$D.info(e)}}(),(0,p.$S)("isFree")&&function(){if(4===e.param("fid")){var t=$G.user.uid,a=1,n="deleteFolder_enterCountInfo/"+t,o="deleteFolder_recovery_popup_ignore/"+t;if("1"===$.LocalStorage.get(o))return!1;i.e(603).then(i.bind(i,94253)).then($.Function.bind((function(e){e.default.validStatus((function(e){var e().getTime(),s=r;if(t||o)return!1;var c=JSON.parse($.LocalStorage.get(n)||"{}");c.count&&(r-c.startTime<=36e5?(a=c.count+1,s=c.startTime):(a=1,s=r)),$.LocalStorage.set(n,JSON.stringify({count:a,startTime:s})),a>1&&($.LocalStorage.set(n,JSON.stringify({count:0,startTime:s})),Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(e){e.default.showMboxRecoveryPopup("mbox")}),this)))}))})))}}(),$.Thread.delay((function(){try{if(e.param("fid")>0){var i=u.Z.get("expire").stats.messageCount;i>0&&t.showDefer(i)}}catch(e){p.$D.info(e)}})),$.Thread.delay($.Function.bind((function(){var t,i=$.Misc.getTime(),a=e.panbox",flag:"layout"})-0,o=0===n||1==n;1==a&&i&&i<=new window.Date(2018,10,14)&&i>=new window.Date(2018,10,9)&&!$("showCloseyxMboxAd")&&o&&!$("#yanxuanMboxAd")&&(t=i<=new window.Date(2018,10,11)&&i>=new window.Date(2018,10,9)?'<div id="yanxuanMboxAd" style="position: absolute;right: 84px;bottom: 238px;z-index: 99;"><a href="http://u.163.com/webmailsjx1"  target="_blank"><img src="https://onegoods.nosdn.127.net/resupload/2018/11/8/61d78dc94a0ed6d7546306666b8204d5.gif"></a><a onclick="$(\'#yanxuanMboxAd\').remove();$(\'showCloseyxMboxAd\',true);" href="javascript:void(0)" class="nui-closeable-x" style="display:block;top:0;right:0;" hidefocus="hidefocus"></a></div>':'<div id="yanxuanMboxAd" style="position: absolute;right: 84px;bottom: 238px;z-index: 99;"><a href="http://u.163.com/webmailsjx2"  target="_blank"><img src="https://onegoods.nosdn.127.net/resupload/2018/11/8/7275f7ad4d6eec4b65342402eb375f74.eyxMboxAd\',trutop:0;right:0;" hidefocus="hidefocus"></a></div>',$(e.container).append(t))}),this))},exit:function(e,t,i){var a=this.view;if("beforeunload"!==i)try{a.)}catch(e){}return!0},getText:function(){},getGroup:function(){var e=this.param("filter"),t="";return e&&e.sentDate&&(t="date"),this.mtype+t},switchIn:function(){var e=this,t=e.view;try{e.container&&t.getAd(!0),e._child.switchIn()}catch(e){}p.$D.log("switchIn")},switchOut:function(){try{this._child.switchOut()}catch(e){}},cache:function(){var e=this,t=e.view,i=e.getStats(),a=e.getTotal();if(!t.completed||e.extend("forceRequest")||!e.extend("forcePage")&&i>-1&&i!==a)t.refresh(e.extend("index"));else{if(e.extend("forceReplace"))e.extend("forceReplace",void 0),e.replace();else{t.markReaded(),t.markReFw();var n=e.scrollTop;if(void 0!==n){n||(n=0);var o=e.getDom("ScrollDiv");0!==n&&(o.scrollTop=n),delete e.scrollTop}e.extend("brand")&&e._child&&$.Frame.setViewType("l-r",e)}if(e.extend("forceBrand")){e.extend("forceBrand",void 0);try{e.refreshBrand()}catch(e){}}}try{e.onFocus()}catch(e){}},clean:function(){this.view.dragDiv=null,this.removeCache()},onFocus:function(e){try{var t=$.Context.getModule(),i=t.view.letters,a=t.diff||0;if(e&&(a+=e),a<0&&(a=0),a>i.length-1&&(a=i.length-1),t.diff=a,i.length>0)try{i[a].getDiv().focus()}catch(e){console.log(e)}}catch(e){}},replace:function(e,t,i,a,n){var o=this,r=o.view,s=o.extend("index");o.extend("limit"),t&&i>0&&h.count(a)===i?o.removeData(i,a):o.cleanData(),o.getData((function(){var c=o.getCacheData(s);if(!c||c.onlyExpire){var l=s-1;l>=0||"archive"===o.extend("area")?r.goPage(l):r.refresh()}else r.replaceLetter(e,t,i,a,n)}),s,!0)},lazyLoad:function(){var e=this,t=e.view,i=e===$.Context.getModule();if(p.$D.log("mbox lazy load start"),i){var a=e.extend("index");if(e.autoGetData(a-1),e.autoGetData(a+1),0===a){for(var n=t.letters,o=[],r=0,s=n.length;r<s;r++){var c=n[r],l=c.data;2===l.fid||l.flags.top||c.isThread||l.flags.read||o.push(c)}!function e(a,n){$.Thread.delay((function(){!function(a,n){if(n>=0?n++:n=0,n<2&&n<a.length&&i){var o=a[n];try{for(var r=!1,s=0;s<t.letters.length;s++)if(t.letters[s].id===o.id){r=!0;break}r&&o.gotoRead({preload:!0,hiddenCall:function(){e(a,n)}})}catch(e){}}}(a,n)}))}(o.concat([]))}}},autoGetData:function(e,t){var i=this,a=i.extend("type");!(e>i.getPage()-1)&&e>=0&&"search"!==a&&(i.getCacheData(e,!0)||i.getData((function(){t&&t()}),e,!0))},getCacheData:function(e){},cleanCache:function(e){var t=this;if(e)t.removeCache(),$.JS.cleanCache(t);else{t.extend("forceRequest",!0);try{t.view.completed=!1}catch(e){}}},cleanData:function(){},lazyReplace:function(){this.extend("forceReplace",!0)},removeCache:function(){var e=this.view;try{var t=e.letters;t.length>0&&($.Array.each(t,(function(e,t){$.Thread.delay((function(){try{t.remove()}catch(e){}}))})),p.$D.log("remove letters cache done")),e.letters=[],e.ids={},delete e.allSelected,delete e.folderSelected}catch(e){}},removeData:function(e,t){},getTotal:function(){var e=this.total;try{-1===e&&(e=this.getStats())}catch(e){p.$D.log({text:f.t("ä¿®æ­£åˆ—è¡¨æ€»æ•°å‡ºé”™"),error:e})}return e>=0||(e=0),e},setTotal:function(e){e>=0||(e=0);var t=this.getStats();t>-1&&t!==e&&$.Thread.delay((function(){(0,p.$I)("init.Sync").request()}),0),this.total=e},getStats:function(){var e=this,t=-1;try{var i=e.param("fid");if(!(e.isDefer()&&i>0&&u.Z.showTop(i)&&u.Z.getInfo("expire")>0)){var a,n=e.extend("subtype"),o="";if("read"===n){var r=e.param("filter");!r.flags.read&&(a=1===e.param("fids").length?"folder":e.param("tag")?"tag":r.chatWithAddress?"contacts":"read",o="unread")}else a=n;switch(a){case"folder":i=e.param("fid")||e.param("fids")[0],t=l.Z.getInfo(i,o);break;case"tag":var s=e.param("tag");t=m.Z.getInfo(s[0],o);break;case"defer":t=u.Z.getInfo("total",o);break;case"contacts":var c=e.param("filter").chatWithAddress;t=(0,p.$I)("init.Contacts").getInfo(c,o);break;case"reach(e){}return t},getPage:function(){var e=this.getTotal(),t=this.extend("limit");return Math.ceil(e/t)},getCount:function(e){var t,i=this;switch(i.extend("subtype")){case"folder":var a=i.param("fid");t=l.Z.getInfo(a,e);break;case"tag":var n=i.param("tag");t=0;for(var o=0,r=n.length;o<r;o++)t+=m.Z.getInfo(n[o],e);break;case"normal":case"full":"unread"!==e&&(t=i.getTotal());break;case"flag":t=(0,p.$I)("init.Flag").getInfo(1,e)}return t},getCondition:function(){return""},getKeyword:function(){var e=this,t=e.keyword;if("string"!=typeof t){t="";var i=e.param("pattern");if(i)t=i;else{var a=e.param("conditions");try{h.isArray(a)||(a=[a]);for(var n=0,o=a.length;n<o;n++){var r=a[n];if("subject"===r.field){t=r.operand;break}}}catch(e){}}e.keyword=t}return t},gettion(e,t){try{return t?this._var[e][t]:this._var[e]}catch(e){}},setVar:function(e,t,i){try{this._var[e][t]=i}catch(e){}},param:function(e,t){var i=this,a="param",n=arguments.length;return 0===n?i.getVar(a):1===n?i.getVar(a,e):void(2===n&&i.setVar(a,e,t))},extend:function(e,t){var i=this,a="extend",n=arguments.length;return 0===n?i.getVar(a):1===n?i.getVar(a,e):void(2===n&&i.setVar(a,e,t))},isThread:function(e){var t=this,i=!1;switch(t.param("fid"),t.extend("subtype")){case"folder":case"flag":case"tag":case"read":i=d.Z.check(t.param("fid"),e)&&"archive"!==t.extend("area")}return i},isTop:b,isFlag:function(){return"archive"!==this.extend("area")},isTag:function(){var e=this.extend("area");return $.Ext.tag&&"archive"!==e},isDefer:function(){var e=this.extend("area");return $.Ext.defer&&"archive"!==e},isArchive:function(){var e=$.Ext.archive;if(e)switch(this.extend("subtype")){case"flag":case"tag":break;case"folder":.getArchive(t)&&(e=!1);break;default:e=!1}return e},isNone:function(){var e=this,t=e.param("fid"),i=e.isDefer()&&t>0&&u.Z.showTop(t)&&u.Z.getInfo("expire")>0,a=e.getPage();return!i&&0===a},isAd:function(){var e=this.extend("type"),t=this.extend("brand"),i="standard"===$G.mailPattern.currentPattern,a=(0,p.$S)("ad");return(0,p.$S)("isFree")&&i&&"1"!=$.LocalStorage.get("mailmboxpro")&&!(0,p.$S)("mboxAdClosed")&&"list"===e&&!t&&!(!a.show&&"ud"===a.userType)&&!this.isNone()},isFooter:function(){return!1},isSelectFolder:function(){var e=this,t=e.extend("subtype"),i=e.param("fid"),a=u.Z.getInfo("expire");return $.Ext.selectFolder&&"folder"===t&&i>1&&0===a&&e.getPage()>1&&!e.isThread()},isSummary:function(){var e="full"===this.extend("subtype");r1&&(e=!0),e},initialize:function(e){try{v.listened||($.fly(document).listen("keydown",$.Function.bind(v.keydown,v)),v.listened=!0)}catch(e){}}}),t.default=v},49134:function(e,t,i){i(48868),i(92274),i(63045),i(81874),i(54861),i(803),i(55737),i(8600),i(87553),i(66403),i(68233),i(15296),i(37885),i(42295),i(52963),i(66251),i(49750);var a=i(1124),n=i(42732),o=i(50348),r=i(42237),s=i(3505),c=i(2185),l=i(98710),d=i(36903),u=i(12879),m=i(19619),p=i(72957),f=i(32073),h=i(92066),g=i(40823),v=new p.c1("module.mbox.MboxView"),b=$.Object,y=$.Function,x=$.Event,k=$.Array,S=($.Date,$.Browser.isIE("<9")),w=$.createClass((0,p.$N)("module.mbox.MboxView"));b.mix(w,f.Z,{addedCss:!1,fontSize:["","","nui-txt-s16","nui-txt-s12"],lineHeight:["","tE0","pI0","","tw0"],addCss:function(){var e=$G.environment,t=[];t.push(e.cacheRootPath),t.push("css"),t.push("gibx_custom.css"),w.addedCss||(i.e(393).then(i.bind(i,70393)),w.addedCss=!0)},noticed:!1},{config:null,pager:null,none:null,archiveTips:null,inserted:0,inserting:!1,completed:!1,interval:null,threads:[],insertLimit:S?20:100,succExpires:15e3,letters:null,ids:null,dragDiv:null,readedMid:null,allSelected:!1,folderSelected:!1,isTeamMember:!1,getHtml:function(){var e=this,t=e.module,i=e.setClass("Html"),a=[];return e.completed=!1,a[a.length]='<div id="'+t.createId("HtmlDiv")+'" class="'+i+'">',a.push(e.getControl()),a.push('<div class="Dg0">'),a.push(e.getAd()),a.push(e.getBanner()),a.push(e.getTips()),a.push(e.getMailTrackTip()),a.push(e.getTitle()),a.push(e.getSmarts()),a.push(e.getList()),a.push(e.getPager()),a.push(e.getNone()),a.push(e.getFooter()),a.push("</div>"),a[a.length]="</div>",e.addHeader(e.getToolbar(),a.join(""),"frame-main-cont-body-first")},getAd:function(e){var t=this.module,i=t.isAd(),a=[];if(i&&window.gAd&&window.gAd.getLetter)try{var n,o="3"===$.Ud.get({field:"ntes_inbox",flag:"layout"})?"letterSmall":"letter",r=window.gAd.getLetter(o,{onClose:function(){$.Listener.fire("letter:closead","mboxAd")}});if(e){var s=t.getDom("AdDiv");a.push(r),s.innerHTML=a.join("")}else n=t.createId("AdDiv"),a.push(r),function(e){a.unshift('<div class="tN0 nui-closeable" id="'+e+'"'+(t.isNone()?' style="display:none"':"")+">"),a.push("</div>")}(n)}catch(e){p.$D.log(e)}return a.join("")},getBanner:function(){return""},getTips:function(){return this.tips.get()},getTitle:function(){return this.title.get()},getControl:function(){return""},getSmarts:function(){return""},getList:function(){var e=this,t=e.module,i=t.extend("area"),a=t.extend("index"),n=t.getPage(),o=e.setClass("List"),r=[];if(r[r.length]=['<div id="',t.createId("ListDiv"),'" class="',o,'"></div>'].join(""),t.isArchive()&&"normal"===i){var s={},c=new $.Link({text:v.t("æŸ¥çœ‹æ›´æ—©çš„é‚®ä»¶"),click:function(){e.goPage(n)}});s.content=c.html(),s.subclass="tipsBlock",s.hidden=!(a===n-1||0===n);var l=new $.Block(s);r[r.length]=l.html(),e.archiveTips=l}return r.join("")},getPager:function(){return this.pager.get()},getNone:function(){return this.urn""},getToolbar:function(){return this.toolbar.get()},getMailTrackTip:function(){return this.mailtrack.getTip()},getMailTaskFilter:function(){return this.mailTask.getFilter()},deleteInterval:function(){var e=this;try{e.inserted=0,e.inserting=!1,clearTimeout(e.interval)}catch(e){}},createInterval:function(){var e=this,t=e.module,i=!S||t.extend("limit")<=e.insertLimit;e.deleteInterval(),e.initThreads(),t.removeCache(),e.period.reset(),e.insertLetter(i),e.mailtrack.updateTip()},initThreads:function(){var e=this.threads;for(e||(e=this.threads=[]);e.length>0;)$.Thread.clear(e.pop())},pushThread:function(e){this.threads.push(e)},insertLetter:function(e,t,i){var a,n=this,o=n.module;if(n.period,!n.inserting){n.inserting=!0;try{i||(i=o.getCacheData());var r=o.extend("limit"),s=n.insertLimit,c=n.inserted,l=n.letters,u=n.ids,m=!(c>0),f=o.getDom("ListDiv"),h=document.createDocumentFragment(),v=[],b=0;o.extend("expire")&&(b+=g.Z.getInfo("expire"));var y=r+b;if(i&&c<i.length&&c<y){m||(s*=2);for(var x=0,k=i.length,w=e?y:s;c<k&&x<w;c++,x++)try{var T=i[c],C=new d.Z(n,T);if(C.initDom(e),!t)var _=n.period.get(T,e);e?(v.push(_.html||""),v.push(C.html)):(_.div&&h.appendChild(_.div),h.appendChild(C.getDiv())),l.push(C),u[C.id]=C}catch(e){p.$D.info({text:"insert one letter error",error:e})}n.inserted=c,e?(a=v.join(""),f&&(f.innerHTML=v.join(""))):f&&(m&&(f.innerHTML=""),f.appendChild(h)),c<k?I():A()}else A()}catch(e){n.deleteInterval(),n.initThreads(),o.extend("retry")||($.Thread.run((function(){n.refresh(o.extend("index"),!0,!0)}),0),o.extend("retry",!0)),p.$D.info({text:"insert letter error",error:e})}return n.inserting=!1,a}function I(){n.interval=setTimeout((function(){n.insertLetter(e,t,i)}),0)}function A(){n.inserting=!1,n.completed=!0,n.deleteInterval(),n.pager.show(),n.pushThread($.Thread.run((function(){o.getSummary(),n.period.count()}),0)),n.pushThread($.Thread.run((function(){n.markReaded(),n.markReFw(),n.markContact(),n.pushThread($.Thread.run((function(){if(o.lazyLoad(),!S){var e,t="mboxDragDiv",i=$.fly("#"+t);i?e=i.dom:((e=document.createElement("DIV")).id=t,e.style.display="none",e.className="nui-layer tD0 sc0",document.body.appendChild(e)),n.dragDiv=e}var a=n.letters;if(a.length>0)try{a[0].getDiv().focus()}catch(e){console.log(e)}}))),$.Component.setEvents(10)}),0))}I()},replaceLetter:function(e,t,i,a,n){var o=this,r=o.module,s=r.extend("index"),c=r.getCacheData(s)||[],l=o.letters,u={},m={};if(t&&i>0&&b.count(a)===i)for(var f=0,h=l.length;f<h;f++)a[C=(y=l[f]).data.id]?m[C]=y:u[C]=y;else{var g={};for(f=0,h=c.length;f<h;f++)g[(T=c[f]).id]=T;for(f=0,h=l.length;f<h;f++){var y=l[f];g[C=(T=l[f].data).id]?u[C]=y:m[C]=y}}b.each(m,(function(e,t){try{t.remove(!0)}catch(e){}})),o.period.reset();var x,k=[],S={},w=r.getEl("ListDiv");for(f=0,h=c.length;f<h;f++){var T,C=(T=c[f]).id,_=o.period.get(T);_.div&&M(_.div);var I=!!(y=u[C]);I?L(y,T,e):(y=new d.Z(o,T)).initDom();var A=y.getDiv();M(A,I&&t),k.push(y),S[A.id]=y}function M(e,t){t||(x?x.after(e):w.prepend(e)),x=$(e)}function L(e,t,i){var a=e.data;if(e.data=t,e.format(),!n||n[t.id])switch(i){case"read":case"recall":e.setRead();break;case"flag":e.setFlag();break;case"tag":e.setTag();break;case"defer":case"memo":e.setDefer(),e.setMemo();break;case"move":case"folder":e.setMove();break;case"top":e.setTop();break;case"mailteam":e.updateTask(),e.updateTaskInfo();break;default:var o;if(!i){o=[];var r=a.flags||{},s=t.flags||{};!r.read!=!s.read&&o.push("Read"),a.label0!==t.label0&&o.push("Flag"),a.fid!==t.fid&&,a.defer===t.defer&&!r.deferHandle==!t.deferHandle||o.push("Defer"),a.memo!==t.memo&&o.push("Memo"),!r.top!=!s.top&&o.push("Top")}if(o.length>0)for(var c=0,l=o.length;c<l;c++)try{e["set"+o[c]]()}catch(e){}else p.$D.log(v.t("æœ‰åŒæ­¥æ•°æ®å¯èƒ½æ²¡æœ‰è¦†ç›–åˆ°,sAction:")+i)}}o.letters=k,o.ids=S,o.pushThread($.Thread.run((function(){r.getSummary(),o.period.count(),o.markContact(),o.update(),o.selectAll(!1)}),0))},syncLetter:function(e,t,i,a){try{a||(a={})}catch(e){return e}var n=this;n.module;try{for(var o=n.letters,r=0,s=0,c=o.length;r<c&&s<t;r++){var l=o[r],d=l.data.id;(i[d]||a[d])&&(u(l,i[d]||a[d]),s++)}}catch(e){}function u(t,i){switch(e){case"read":t.setRead();break;case"flag":t.setFlag();break;case"tag":t.setTag();break;case"defer":case"memo":t.setDefer(),t.setMemo();break;case"move":t.setMove();break;case"top":t.setTop();break;case"mailTrack":t.updateTrackStatus();break;case"teamInfo":t.components&&t.components.userlabel&&t.components.userlabel.length&&(t.components.userlabel[0].update({teamTitle:i.teamName}),t.components.userlabel[0].setExtLink($.Link.html({text:"@"+i.teamName+i.extInfo,click:function(){$.Log.cache({mbox_userlabel_team_click:1}),open(i.link,"_blank")}})));break;case"mktInfo":t.components&&t.components.userlabel&&t.components.userlabel.length&&(0===i.status?t.components.userlabel[0].update({mkt:!1}):(t.components.userlabel[0].update({mktTitle:i.ename,mkt:!0}),t.components.userlabel[0].setExtLink($.Link.html({text:"@"+i.ename+i.extInfo,click:function(){$.Log.cache({mbox_userlabel_marketing_click:1}),open(i.link,"_blank")}}))));break;case"mailteam":t.data.tag=a[0].tag||[],t.updateTask(),t.updateTaskInfo()}}n.update()},setClass:function(e){var t,i=this.module,a=i.extend("subtype"),n="full"===a,o="defer"===a,r=i.extend("brand"),s=$.Ud.get({field:"ntes_option",flag:"summary"||"Html"===e){t=["tc0"],n&&($.Ud.get({field:"ntes_global",flag:"secondSearch"})-0==1?t.push("zj1"):t.push("Ay0"));var d=$.Ud.get({field:"ntes_letter",flag:"font_size"})-0;t.push(w.fontSize[d]),0!==d&&1!==d&&(c=!0);var u=$.Ud.get({field:"ntes_letter",flag:"line_height"})-0;"l-r"===l&&(u=1),0!==u&&3!==u&&(c=!0);var m=$.Ud.get({field:"ntes_option",flag:"sizeshow"})-0;(this.config.sizeShow=!(S||(0,p.$S)("isFree")&&1!==m))&&(t.push("ts1"),c=!0),w.lineHeight[u],t.push(w.lineHeight[u])}if(!e||"List"===e){var f=["tv0"];n&&(f.push("nF0"),c=!0),"l-r"===l&&(f.push("oo1"),c=!0),o&&(f.push("sv1"),c=!0),r&&(c=!0)}if(i.isDefer()&&g.Z.getInfo("total")>0&&(c=!0),c&&w.addCss(),e){if("Html"===e)return t.join(" ");if("List"===e)return f.join(" ")}else{var h=i.getEl("HtmlDiv"),v=i.getEl("ListDiv");h.setClass(t.join(" ")),v.setClass(f.join(" ")),h.destroy(),v.destroy()}},getLayout:function(){var e=this.module;return e.constructor.getLayout(e)},drag:function(e,t){p.$D.log(t);var i=this,a=(i.module,$(document.body)),n=i.dragDiv,o=$.Event.get();switch(t){case"mousedown":e.setChecked(!0);var r=i.getSelected().length,s=v.t("ç§»åŠ¨")+'<span class="qI0">'+r+"</span>"+v.t("å°é‚®ä»¶");n.innerHTML=s,n.style.left=o.clientX+2+"px",n.style.top=o.clientY+2+"px";break;case"start":n.style.display="";break;case"drag":var c,l=$.Event.getTarget(),d=$.fly(l).figetModule()||{}).fid?(p.$D.log("true"),i.dragToFid=c,a.removeClass("sc0"),a.addClass("rA0")):(p.$D.log("false"),i.dragToFid=null,a.addClass("sc0"),a.removeClass("rA0")),p.$D.log(c);break;case"end":a.removeClass("sc0"),a.removeClass("rA0"),n.style.display="none";var u=i.dragToFid;u>0&&(i.move(u),delete i.dragToFid)}a.destroy()},listen:function(){var e=this,t=e.module,i=$.fly(t.getDom("ListDiv"));i.listen("mouseover",y.bind(e.mouseover,e)),i.listen("mousedown",y.bind(e.mousedown,e)),i.listen("click",y.bind(e.click,e));var a=null;i.listen("touchstart",(function(){a=+new window.Date})),i.listen("touchend",(function(){+new window.Date-a>75||y.bind(e.click,e)()})),i.listen("keypress",y.bind(e.keypress,e)),i.listen("contextmenu",y.bind(e.contextmenu,e))},getTargetInfo:function(){for(var e=this.module,t=x.getTarget(),i=e.getDom("ListDiv"),a={};t&&t!==i;){var n=t.getAttribute("sign");if(n){if("letter"===n){a.div=t;break}a.sign||(a.sign=n,a.target=t)}t=t.parentNode}return a.div||(a=null),a},mouseover:function(){try{var e=this.getTargetInfo();if(e){var t=e.div,i=this.ids[t.id];i&&i.mouseover(e)}}catch(e){p.$D.log(e)}},mousedown:function(){if(1===$.Event.get().which)try{var e=this.getTargetInfo();if(e){var t=e.div;this.ids[t.id].mousedown(e)}}catch(e){p.$D.log(e)}},click:function(){try{var e=this.getTargetInfo();if(e){var t=e.div;this.ids[t.id].click(e)}}catch(e){p.$D.log(e)}},keypress:function(){try{var e=this.getTargetInfo();if(e){var t=e.div;this.ids[t.id].keypress(e)}}catch(e){p.$D.log(e)}},contextmenu:function(){try{var e=this.getTargetInfo();if(e){var t=e.div;this.ids[t.id].contextmenu(e)}}catch(e){p.$D.log(e)}},select:function(e){for(var t=this,i=t.module,a=t.letters,n=0,o=0,r=a.length;o<r;o++){var s=a[o],c=s.data.flags,l=!!s.checked,d=!0;switch(e){case"all"k;case"unread":!c.read===l&&(d=!1);break;case"read":!!c.read===l&&(d=!1);break;case"expire":!!s.expire===l&&(d=!1)}d&&s.setChecked(!s.checked),s.checked&&n++}t.selectAll(n>0&&n===a.length);try{i._child.view.changeSelect()}catch(e){}},selectAll:function(e){var t=this,i=t.toolbar;if(void 0===e){e=!0;for(var a=t.letters,n=0,o=a.length;n<o;n++)if(!a[n].checked){e=!1;break}}t.allSelected^e&&(i.selectAll(e),t.allSelected=e,t.folderSelected=!1,t.selectFolder())},selectFolder:function(){var e=this;e.module.isSelectFolder()&&(e.tips.update(),e.toolbar.update())},setFolderSelect:function(e){var t=this;t.folderSelected=!!e,e?t.selectFolder():t.select("none")},goPage:function(e,t,i){var n,o,r,s,c=this,l=c.module,d=l.extend("area");$.Ext.archive&&(n="normal"===d,o="archive"===d);var u=l.getPage();if(e>=u&&(n?r=!0:e=u-1),e>=0||(o?s=!0:e=0),r||s){var m=b.clone(l.param()),p=b.clone(l.extend());if(r)m.mboxa="2",p.index=0;else{delete m.mboxa,e=0;try{var f=$.JS.get("mbox.ListModule",m);if(f)(e=f.getPage()-1)<0&&(e=0);else{var g=h.Z.getInfo(l.param("fid")),v=l.extend("limit");e=Math.floor(g/v)}}catch(e){}p.index=e}delete p.area,c.initThreads(),a.default.entry(m,p)}else t||l.extend("forcePage")||l._cacheCleaned?(c.deleteInterval(),m=b.clone(l.param()),(p=b.clone(l.extend())).index=e,p.saveLayout=!i,c.initThreads(),a.default.entry(m,p)):e!==l.extend("ction(){c.createInterval(),$.Thread.run((function(){c.toolbar.update(),c.pager.update(),c.tips.update(),c.toggleFooter();var t=c.archiveTips;t&&t.getEl()[e===u-1?"show":"hide"]()}),0)}),e),$.Thread.run((function(){l.getDom("ScrollDiv").scrollTop=ar o=this,r=o.module,s=(0,p.$I)("init.Sync"),c=b.clone(r.param()),l=b.clone(r.extend());l.forceRequest=!0,l.retry=i,l.saveLayout=!n;var d=r.getPage();e>=d&&(e=d-1),e>0||(e=0),l.index=e,o.deleteInterval(),o.initThreads(),t?a.default.entry(c,l):($.Listener.one("sync:request",(function(){try{g.Z.setCache()}catch(e){}a.default.entry(c,l)})),s.request(void 0,{listen:!0})),setTimeout($.Function.bind(o.module.setAd,o.module),1e3)},setRead:function(e,t,a){var n=this,o=n.module,r=n.allSelected&&n.folderSelected,s=o.param("fid");if(t=n.getSelected(t,(function(t){return t.data.flags.read^e})),!r&&!n.checkLetters(t,a))return!1;var c=n.getSelectedData(t);function l(t,i){if(!a){var o="";i&&(o="&nbsp;"+new $.Link({text:v.t("æ’¤é”€"),bracket:!0,click:function(){n.rollback(i)}}).html()),$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®é‚®ä»¶ä¸º")+(e?v.t("å·²è¯»"):v.t("æœªè¯»"))+o,expires:o?n.succExpires:void 0})}}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(t){t.default.setRead({allFid:r?s:void 0,area:o.extend("area"),isRead:e,data:c,callback:l})})))},setFlag:function(e,t){var a=this,n=a.module,o=n.param("fid"),r=a.allSelected&&a.folderSelected;if(t=a.getSelected(t,(function(t){return t.data.label0!==e})),!r&&!a.checkLetters(t))return!1;var s=a.getSelectedData(t);function c(t,i){var n="";i&&(n="&nbsp;"+new $.Link({text:v.t("æ’¤é”€"),bracket:!0,click:function(){a.rollback(i)}}).html()),$.Tips.show({succ:!0,text:v.t("æˆåŠŸ")+(e>0?v.t("è®¾ç½®"):v.t("å–æ¶ˆ"))+v.t("é‚®ä»¶æ——å¸œ")+n,expires:n?a.succExpires:void 0})}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(t){t.default.setFlag({allFid:r?o:void 0,area:n.extend("area"),flag:e,data:s,callback:c})})))},setTag:function(e,t,a){var n=this,o=n.module,r=o.param("fid"),s=n.allSelected&&n.folderSelected;if(a=n.getSelected(a,(function(i){var a=i.data.tag;return e?!(a&&k.has(a,t)):!t||t&&k.has(a,t)})),!s&&!n.checkLetters(a))return!1;var c=n.getSelectedData(a);function l(i,a){var o="";a&&(o="&nbsp;"+new $.Link({text:v.t("æ’¤é”€"),bracket:!0,click:function(){n.rollback(a)}}).html()),$.Tips.show({succ:!0,text:v.t("æˆåŠŸ")+(e?v.t("è®¾ç½®"):v.t("å–æ¶ˆ")+(t?"":v.t("æ‰€æœ‰")))+v.t("é‚®ä»¶æ ‡ç­¾")+o,expires:o?n.succExpires:void 0})}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(i){i.default.setTag({allFid:s?r:void 0,area:o.extend("area"),isAdd:e,tag:t,data:c,callback:l})})))},setDefer:function(e,t,a){var n=this,o=n.module,r=o.param("fid"),s=n.allSelected&&n.folderSelected,c=!t;c&&(t={});var l=t.defer,d=t.memo,u=t.smsDate;if(a=n.getSelected(a,(function(t){var i=!1,a=t.data;switch(e){case"add":case"modify":i=!0;break;case"complete":i=a.defer&&a.flags.deferHandle;break;case"delete":i=!!a.memo}return i})),!n.checkLetters(a))return!1;if("add"===e&&c)return a&&1===a.length&&(t.mid=a[0].data.id),void Promise.resolve().then(i.bind(i,67979)).then($.Function.bind((function(i){i.default.showMsgbox({type:e,data:t,callback:function(t){n.setDefer(e,t,a)}})})));if(!s&&!n.checkLetters(a))return!1;var m=n.getSelectedData(a);function p(t,i){var a,o="";switch(i&&(o="&nbsp;"+new $.Link({text:v.t("æ’¤é”€"),bracket:!0,click:function(){n.rollback(i)}}).html()),e){case"add":case"modify":a=v.t("æˆåŠŸè®¾ç½®é‚®ä»¶å¾…åŠ");break;case"complete":a=v.t("æˆåŠŸå®Œæˆé‚®ä»¶å¾…åŠ");break;case"delete":a=v.t("æˆåŠŸåˆ é™¤é‚®ä»¶å¤‡æ³¨")}$.Tips.show({succ:!0,Expires:void 0})}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(t){t.default.setDefer({allFid:s?r:void 0,area:o.extend("area"),type:e,defer:l,memo:d,smsDate:u,data:m,callback:p})})))},setMemo:function(e,t){var a=this;if(t=a.getSelected(t,(function(t){return t.data.memo!==e})),!a.checkLetters(t,!0))return!1;var n=a.getSelectedData(t);function o(t,i){var n="";i&&(n="&nbsp;"+new $.Link({text:v.t("æ’¤é”€"),bracket:!0,click:function(){a.rollback(i)}}).html()),$.Tips.show({succ:!0,text:v.t("æˆåŠŸ")+(e?v.t("è®¾ç½®"):v.t("å–æ¶ˆ"))+v.t("é‚®ä»¶å¤‡æ³¨")+n,expires:n?a.succExpires:void 0})}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(t){t.default.setMemo({area:a.module.extend("area"),memo:e,data:n,callback:o})})))},setTop:function(e,t,a){var n=this,o=n.module;if(a||(a=o.param("fid")),t=n.getSelected(t,(function(t){return!!t.data.flags.top!==e})),!n.checkLetters(t))return!1;var r=n.getSelectedData(t);function s(t,i){var a="";i&&(a="&nbsp;"+new $.Link({text:v.t("æ’¤é”€"),bracket:!0,click:function(){n.rollback(i)}}).html()),t&&$.Tips.show({succ:!0,text:v.t("æˆåŠŸ")+(e?v.t("è®¾ç½®"):v.t("å–æ¶ˆ"))+v.t("é‚®ä»¶ç½®é¡¶")+a,expires:a?n.succExpires:void 0})}i.e(603).then(i.bind(i,87226)).then($.Function.bind((function(t){t.default.setTop({fid:a,isTop:e,data:r,callback:s})})))},setSummary:function(){for(var e=this.letters,t=0,i=e.length;t<i;t++)e[t].setSummary()},rollback:function(e){function t(e){$.Tips.show({succ:!0,text:v.t("æˆåŠŸå–æ¶ˆæ“ä½œ")})}this.module,Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(i){i.default.rollback({rollback:e,callback:t})})))},move:function(e,t){var n=this,o=n.module,r=o.param("fid"),s=n.allSelected&&n.folderSelected;if(t=n.getSelected(t,(function(t){return t.data.fid!==e||r>0&&r!==e})),!s&&!n.checkLetters(t))return!1;var c=n.getSelectedData(t);function l(t,s){if(e){var l="";s&&(l="&nbsp;"+new $.Link({text:v.t("æ’¤é”€"),bracket:!0,click:function(){n.rollback(s)}}).html());var d=new $.Link({text:h.Z.get(e).name,click:y.bind(a.default.entry,a.default,{fid:e},{type:"list",subtype:"folder"})});$.Tips.show({succ:!0,text:v.t("æˆåŠŸç§»åŠ¨é‚®ä»¶åˆ° ")+d.html()+l,expires:l?n.succExpires:void 0}),$.Component.setEvents()}else{var u="";$.Ext.recovery&&(u="&nbsp;"+new $.Link({text:v.t("æ¢å¤è¯¯åˆ é‚®ä»¶"),bracket:!0,click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"recovery",title:v.t("è¯¯åˆ æ¢å¤")})})))}}).html()),$.Tips.show({succ:!0,text:v.t("æˆåŠŸåˆ é™¤é‚®ä»¶")+u}),$.Component.setEvents()}1===r&&e>20&&function(){if(!(c.length<2)){for(var t,a=0,n=c.length;a<n;a++){if(c[a].threadMessageCount>1)return;var r=$.Uri.getAddress(c[a].from).toLowerCase();if(t){if(t!==r)return}else t=r}t&&Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(i){i.default.checkFilterLimit((function(i){if(!i){var a=v.t("å¯¹æ¥è‡ª ")+t+v.t(" çš„é‚®ä»¶æ‰§è¡Œä»¥ä¸‹è§„åˆ™ï¼š"),n=new $.Checkbox({text:v.t("ä»¥åè‡ªåŠ¨ç§»åŠ¨åˆ°&nbsp;")+"<strong>"+h.Z.get(e).name+"</strong>"+v.t("&nbsp;æ–‡ä»¶å¤¹"),checkedchange:function(){this.checked||r.setChecked(!1,!0)}}),r=new $.Checkbox({text:v.t("å¯¹å·²æ”¶åˆ°é‚®ä»¶æ‰§è¡Œç›¸åŒæ“ä½œ"),checkedchange:function(){this.checked&&n.setChecked(!0,!0)}}),s=n.html()+"<br/>"+r.html();$.Msgbox.show({type:"confirm",header:v.t("æ–°å»ºæ¥ä¿¡åˆ†ç±»è§„åˆ™"),content:s,title:a,ok:function(){n.checked&&o.action.setFilterRule({fid:e,email:t,history:r.checked,callback:c})}}),$.Component.setEvents()}function c(e){e?$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®æ¥ä¿¡åˆ†ç±»")}):$.Msgbox.show({statsKey:"Mbox_Guide_Popup_SetMailClassifyFail",content:v.t("æ— æ³•æ·»åŠ æ¥ä¿¡åˆ†ç±»ï¼Œè¯·å…ˆæ¸…ç†å·²å­˜åœ¨æ¥ä¿¡åˆ†ç±»è§„åˆ™ã€‚"),title:v.t("è®¾ç½®æ¥ä¿¡åˆ†ç±»å¤±è´¥")})}}))})))}}()}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(t){t.default.mi=e?null:4;this.move(i,t)},setSpam:function(e,t){var a=this,n=a.module;if(t=a.getSelected(tr=a.getSelectedData(t);function s(t){var a=[];if(a[a.length]=v.t("æˆåŠŸ")+(e?v.t("ä¸¾æŠ¥"):v.t("ä¿¡ä»»"))+v.t("é‚®ä»¶"),t.historycount&&(a[a.length]=v.t("åˆ é™¤å†å²æ¥ä¿¡")+t.historycount+v.t("å°")),t.listcount){var n=new $.Link({text:"ã€"+v.t("æŸ¥çœ‹è¯¦æƒ…")+"ã€‘",attrs:'style="text-decoration:none"',click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"AntiSpamModule"})})))}}).html();a[a.length]=v.t("å°†")+t.listcount+v.t("ä¸ªå‘ä»¶äººåŠ å…¥")+(e?v.t("é»‘åå•"):v.t("ç™½åå•"))+n;var o={};o["tip_"+(e?"refuselist":"safelist")+"All_success_show"]=1,$.Log.cache(o)}else t.listerror&&(a[a.length]=v.t("å‘ä»¶äººæ²¡æœ‰åŠ å…¥")+(e?v.t("é»‘åå•"):v.t("ç™½åå•"))+v.t("ï¼Œè¯·è¿›å…¥è®¾ç½®æ¸…ç†åå•"));$.Tips.show({succ:!0,text:a.join("ï¼Œ")})}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(t){t.default.setSpam({area:n.extend("area"),fid:o,data:r,isSpam:e,callback:s})})))},setAllRead:function(){var e=this,t=e.ne(t.param());(l=a.fids)&&(a.fids=l.concat("search"===t.extend("type")?[4]:$G.common.unnormalids));var n=a.filter;n||(n=a.filter={});var o=n.flags;o||(o=n.flags={}),o.read=!1;var r={flags:{read:!0}},s=(0,p.$S)("advLock");if(!s.disabled&&!s.authenticated2&&(s.pop||s.folders)){var c0;else for(var l,d=0,u=0,m=(l=a.fids||h.Z.getFids()).length;u<m;u++){var f=l[u];if(s[f]&&(d+=h.Z.getInfo(f,"unread"))>0){c=!1;break}}a.skipLockedFolders=c}function g(t,i){var a="";i&&(a="&nbsp;tion(){e.rollback(i)}}).html()),$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®å…¨éƒ¨å·²è¯»")+a,expires:a?e.succExpires:void 0})}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(e){e.default.setAllRead({area:t.extend("area"),body:{search:a,action:r,isThread:t.isThread()},callback:g})})))},exportLetter:function(e){var t=this,a=t.module;if(e=t.getSelected(e),!t.checkLetters(e))return!1;var n=t.getSelectedData(e,!0);function o(){k.e,a=(t.isThread(),e.getSelected());if(!e.checkLetters(a))return!1;var n=e.getSelectedData(a,!0);function o(){k.each(a,(function(e,t){t.setChecked(!1)}))}Promise.resolve().then(i.bind(i,44033)).then($.Function.bind((function(e){e.default.forwardLetter({ids:n,isThread:t.isThread(),ceaded:funastRead");if(i&&i!==t){for(var a,n,o=e.letters,r=0,s=o.length;r<s;r++){var c=o[r];if(c.data.id===i&&(c.setLastRead(!0),a=!0),c.data.id===t&&(c.setLastRead(!1),n=!0),a&&n)break}e.readedMid=i}}catch(e){p.$D.log(e)}},markReFw:function(){try{var e=(0,p.$S)("refw"),t=this.letters;if(e)for(var i in e)for(var a=e[i],n=0,o=t.length;n<o;n++){var r=t[n],s=r.data;if(s.id===i){var c=sgs=c={}),c.replied||(c.replied=a.replied),c.forwarded||(c.forwarded=a.forwarded),r.setReFw(),delete e[i];break}}}catch(e){p.$D.log(e)}},markContact:function(){for(var e=this.letters,t=[],a=0,n=e.length;a<n;a++)try{t=t.concat(e[a].coromise.resolve().then(i.bind(i,27018)).then($.Function.bind((function(e){e.default.mark(t)})))},toggleFooter:function(){},getSelected:function(e,t){if(!e){e=[];for(var i=this.letters,a=0,n=i.length;a<n;a++){var o=i[a];o.checked&&e.push(o)}}return 0===e.length?e.empty=!0:(t&&this.filterSelected(e,t),0===e.length&&(e.void=!0)),e},filterSelected:function(e,t){for(var i=e.length-1;i>-1;i--){var a=e[i];t(a)||(a.setChecked(!1),e.splice(i,1))}},checkLetters:function(e,t){var i="",a="";€‰ä¸­ä»»ä½•é‚®ä»¶ï¼Œè¯·é‡æ–°é€‰æ‹©"),a="Mbox_NoGuide_Tips_NoMailChosen"),e.void&&(i=v.t("é€‰æ‹©çš„é‚®ä»¶å·²æ˜¯éœ€è¦è®¾ç½®çš„çŠ¶æ€ï¼Œæ— éœ€å†è®¾ç½®"),a="Mbox_NoGuide_Tips_SetDone"),!i||(t||$.Tips.show({statsKey:a,text:i}),this.selectAll(!1),!1)},getSelectedData:function(e,t){for(var i=[],a=0,n=e.length;a<n;a++){var o=e[a],r=o.data;i.push(t?r.id:r),o.setChecked(!1)}return i},getSelectedId:function(e){for(var t=[],i=0,a=e.length;i<a;i++)t.push(e[i].id);return t},assignTasks:function(e){var t=this,i=[],n=[],o=[];if(e)o=[e];else try{var r=t.getSelected();if(!t.checkLetters(r))return!1;o=t.getSelectedData(r)}catch(e){console.log(e)}$.Array.each(o,(function(e,t){for(var a={mid:t.id,mailSubject:t.subject||""},o="",r=t.tag||[],s=0;s<r.length;s++){var c=r[s].match(/^%tc_task_id#(.+)%$/);if(c){o=c[1];break}}a.currentTaskId=o||"",a.currentTags=r,n.push(t.id),i.push(a)})),window.mailTeam.assignTasks.show({onOk:function(){},onCancel:function(){},onError:function(e){$.Tips.show({err:!0,text:(e||{}).msg||v.t("æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åå†è¯•")})},onSuccess:function(e){$.Tips.show({succ:!0,text:v.t("åˆ†é…ä»»åŠ¡é‚®ä»¶æˆåŠŸ")}),a.default.getLetterData({mid:n,refresh:!0,callback:function(e){if(e){var t={};$.Object.isArray(e)||(e=[e]),$.Array.each(e,(function(e,i){i.mid=i.id,t[i.id]=!0})),$.Listener.fire("letter:update",{list:t,action:"mailteam",data:e,allFid:!0,area:"normal"})}}})},hl:$G.environment.isCh?"zh_CN":"en_US",list:i})},updateTaskStatus:function(e,t,i){try{for(var n=e.data,o=n.tag||[],r=n.id,s="",c=0;c<o.length;c++){var l=o[c].match(/^%tc_task_id#(.+)%$/);if(l){s=l[1];break}}mailTeam.updateTaskStatus({onSuccess:function(){a.default.getLetterData({mid:r,refresh:!0,callback:function(e){if(e){var t={};t[r]=!0,e.mid=e.id,$.Listener.fire("letter:update",{list:t,action:"mailteam",data:[e],allFid:!0,area:"normal"}),i&&i()}}})},onError:function(e){},mailInfo:{mid:r,status:t,currentTaskId:s||"",currentTags:o}})}catch(e){console.log(e)}},setLayout:function(e){function t(){$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®åˆ—è¡¨åˆ†æ å¸ƒå±€")})}0===e&&(e=1),Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(i){i.default.setAttr({field:"ntes_inbox",flag:"layout",value:e,relModule:["inbox","read"],callback:t})})))},setSpace:function(e){var t=0,a=0;function n(){$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®åˆ—è¡¨æ˜¾ç¤º")})}1===e?(t=2,a=2):2===e?(t=3,a=1):3===e&&(t=4,a=3),Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(e){var i=e.default;i.setAttr({field:"ntes_letter",flag:"font_size",value:a,module:"inbox",noFire:!0,callback:function(){i.setAttr({field:"ntes_letter",flag:"line_height",value:t,module:"inbox",callback:n})}})})))},setSenderShow:function(e){function t(){$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®å‘ä»¶äººæ˜¾ç¤º")})}Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(i){i.default.setAttr({field:"ntes_option",flag:"sendershow",value:e,module:"contact",callback:t})})))},setSize:function(e){function t(){$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®é‚®ä»¶æ˜¾ç¤º")})}Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(i){i.default.setAttr({field:"ntes_option",flag:"sizeshow",value:e,module:"inbox",callback:t})})))},setMaxList:function(e){function t(){$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®æ¯é¡µæ˜¾ç¤ºé‚®ä»¶æ•°")})}Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(i){i.default.setAttr({field:"maxlist",value:e,module:"inbox",callback:t})})))},setThread:function(e){function t(){$.Msgbox.show({title:v.t("ä¼šè¯è®¾ç½®æˆåŠŸï¼Œç‚¹å‡»ç¡®å®šåˆ·æ–°é‚®ç®±"),ok:a,close:a})}function a(){top.location.reload()}Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(i){i.default.setAttr({field:"ntes_option",flag:"thread",value:e,module:"inbox",callback:t})})))},setSummaryShow:function(e){function t(){$.Tips.show({succ:!0,text:v.t("æˆåŠŸè®¾ç½®é‚®ä»¶æ‘˜è¦")})}Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(i){i.default.setAttr({field:"ntes_option",flag:"summary",value:e,module:"inbox",callback:t})})))},setAdvLock:function(){var e,t,i=this.module,a=i.param("fid"),n=i.getFolder(),o=(0,p.$S)("advLock");n.pop?(e="pop",t=o.pop):(e="folder",t=o[a]),(0,p.$I)("init.AdvLock").setProduct({product:e,fid:a,cancel:t})},update:function(){var e=this;e.title.update(),e.toolbar.update(),e.pager.update(),e.none.update(),e.tips.update(),e.mailtrack.updateTip()},showDefer:function(e){w.noticed||($.Msgbox.show({type:"confirm",header:v.t("åˆ°æœŸå¾…åŠé‚®ä»¶æé†’"),content:v.t("æ‚¨æœ‰ ")+e+v.t(" å°åˆ°æœŸå¾…åŠé‚®ä»¶éœ€è¦å¤„ç†"),title:v.t("æ‚¨æœ‰åˆ°æœŸå¾…åŠé‚®ä»¶"),okText:v.t("çnction(){a.default.defer()}}),w.noticed=!0)},showPopup:function(){var e=this;if(1===e.module.param("fid")){var t=$G.user.uid,a=1,n="receivingFolder_enterCountInfo/"+t,o="receivingFolder_mailTrack_popup_ignore/"+t,r=$.Misc.getTime().getTime(),s=r,c=JSON.parse($.LocalStorage.get(n)||"{}"),l="mbox.trackNotify.latestTime";if(r-+($.LocalStorage.get("mbox_tip_"+l)||0)<1e3)return!1;if($.LocalStorage.set("mbox_tip_"+l,r,{path:"/",expires:1},!0),c.count){var d=$.Date.format($.Misc.getTime(),"yyyy-MM-dd")===$.Date.format(new window.Date(c.startTime),"yyyy-MM-dd");r-c.startTime<=864e5&&d?(a=c.count+1,s=c.startTime):(a=1,s=r)}$.LocalStorage.set(n,JSON.stringify({count:a,startTime:s})),a>=5&&$.Ud.getProxy({force:!0,field:["product.plus.mailTrackingStatus","webmail.js.mailTrackingConfig"],call:function(t){var a,n=t["product.plus.mailTrackingStatus"],r=t["webmail.js.mailTrackingConfig"],s=$.Misc.getTime().getTime(),c=0,l=!1,d={};try{d=JSON.parse(n),c=JSON.parse(r).globalTriggerPopupShowTime||0,l=!!d.imTrialed}catch(e){}if(a=0===d.type&&0===d.typeBefore,d.type>0||s-c<=6048e5)return!1;if("1"===$.LocalStorage.get(o))return!1;if(!l||!d.type&&d.typeBefore>=0)return Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(e){var t=e.default;try{t.showImTrialPopup({from:"receivingFolder",threshold:1})}catch(e){console.log(e)}}))),!1;try{a?$.Log.cache({Mbox_Popup_MailTraceTrial_Show:"1"}):$.Log.cache({Mbox_Popup_MailTraceOpen_Show:"1"}),e.mailtrack.configUpdate({globalTriggerPopupShowTime:s}),$.Popup.show({uniqueId:"mbox_mail_track_popup",title:v.t("æ–°åŠŸèƒ½ï¼šé‚®ä»¶è¿½è¸ª"),content:v.t("éšæ—¶æŸ¥çœ‹é‡è¦é‚®ä»¶é˜…è¯»çŠ¶æ€ï¼ŒçŸ¥æ‚‰å¯¹æ–¹æ˜¯å¦å·²è¯»ï¼"),ok:function(t){a?($.Log.cache({Mbox_Popup_MailTraceTrial_Ok_Click:"1"}),e.mailtrack.openTrialModal()):($.Log.cache({Mbox_Popup_MailTraceOpen_Ok_Click:"1"}),e.mailtrack.openPayModal("mailtrack_scenario_send_inbox")),$.LocalStorage.set(o,1,{expires:30})},close:function(){},cancel:function(){$.LocalStorage.set(o,1,{expires:30}),$.Log.cache({Mbox_Popup_MailTrace_Ignore_Click:"1"})},okText:a?v.t("ç«‹å³ä½“éªŒ"):v.t("ç«‹å³å¼€é€š"),cancelText:v.t("æš‚ä¸éœ€è¦"),pauseTime:15e3})}catch(e){console.log(e)}}})}},initialize:function(e){var t=this;t.module=e,t.letters=[],t.ids={};var i=e.param("fid"),a=e.extend("subtype");(t.config={}).isTop=e.isTop(),t.tips=new n.Z(t),t.title=new o.Z(t),t.pager=new r.Z(t),t.none=new s.Z(t),t.toolbar=new c.Z(t),t.period=new l.Z(t),t.mailtrack=new u.Z(t,3===i||1===i),t.mailTask=new m.Z(t,"task"===a),d.Z.config(),e.teamMemberMap||(e.teamMemberMap={},t.mailTask.getTeamMemberList((function(i){$.Array.each(i||[],(function(t,i){e.teamMemberMap[i.email]||(e.teamMemberMap[i.email]=i)})),i.length&&(e.teamMemberList=i,t.refresh())}))),$.Ud.getProxy({field:["product.collaboration.expireTime","product.collaboration.isTeamMail","product.collaboration.memberType"],call:function(e){var i=$.Misc.getTime().getTime(),a=e["product.collaboration.expireTime"],n=e["product.collaboration.isTeamMail"],o=e["product.collaboration.memberType"],r=i>a;t.isTeamMember=!r&&o>0||1===n}})}}),t.Z=w},3505:function(e,t,i){i(55737),i(803),i(8600),i(48868),i(92274),i(63045),i(81874),i(54861),i(37092),i(66403),i(42295),i(26340),i(68233);var a=i(72957),n=new a.c1("module.mbox.None"),o=$.Object,r=$.Date,s=$.createClass((0,a.$N)("module.mbox.None")),c=["nomail_star","nomail_todo","nomail_flag","nomail_new","nomail_unread","nomail_type"];o.extend(s.prototype,{view:null,page:0,type:null,subtype:null,get:function(){var e=this,t=e.view.module;e.init();var i=e.getContent(),a=t.isNone();return a&&($.fly(t.container).addClass("vH0"),setTimeout((function(){e.noneEvent()}),200)),['<div id="',t.createId("NoneDiv"),'"',a?"":' style="display:none;"',">",i,"</div>"].join("")},update:function(){var e=this,t=e.view.module;e.init();var i=t.isNone(),a=t.getEl("NoneDiv"),n=$.fly(t.container),o="vH0";i?(a.html(e.getContent()),a.show(),n.addClass(o)):(a.hide(),n.removeClass(o))},getContent:function(){try{var e=this.view,t=e.module,s=t.extend("type"),c=t.extend("subtype"),l=t.extend("systemContacts"),d="search"===s,u="flag"===c,m="tag"===c,p="defer"===c,f="folder"===c,h="calendar"===c,g="emails"===c,v="read"===c,b="contacts"===c,y="task"===c,x=!1,k=t.getCondition(),S=(0,a.$S)("advLock"),w=!S.disabled&&!S.authenticated2&&(S.pop||S.folders);try{x=!1===t.param("filter").flags.read}catch(e){}var T,C,_,I,A=["wn2"],M=[];w&&function(t){var i=new $.Link({title:n.t("è¾“å…¥å®‰å…¨é”å¯†ç æŸ¥çœ‹æ‰€æœ‰é‚®ä»¶"),text:n.t("è¾“å…¥å®‰å…¨é”å¯†ç æŸ¥çœ‹æ‰€æœ‰é‚®ä»¶"),cls:"nui-txt-link mh1",click:function(){$.AdvLock.show((function(){e.refresh()}))}});t.push(i.html())}(M);var L,E=new $.Link({title:n.t("åˆ·æ–°è¯•è¯•çœ‹"),text:n.t("åˆ·æ–°è¯•è¯•çœ‹"),cls:"nui-txt-link mh1",click:function(){t.log("none","refresh"),t.container.style.display="none",e.refresh()}}),D=n.t("å»ºè®®æ‚¨ï¼š")+E.html();if(v||x){var R=t.param("filter");if(R&&""===R.chatWithAddress){_=n.t("æ‚¨è¿˜æ²¡æœ‰è®¾ç½®æ˜Ÿæ ‡è”ç³»äºº");var P=new $.Link({title:n.t("è®¾ç½®â€œæ˜Ÿæ ‡è”ç³»äººâ€"),text:n.t("è®¾ç½®â€œæ˜Ÿæ ‡è”ç³»äººâ€"),cls:"nui-txt-link mh1",click:function(){t.log("none","setcontact"),Promise.resolve().then(i.bind(i,5439)).then($.Function.bind((function(e){e.default.entry({action:"marked"})})))}});M.push(D),M.push(P.html()+n.t("ï¼Œæ–¹ä¾¿åœ¨â€œæ˜Ÿæ ‡è”ç³»äººé‚®ä»¶â€ä¸­æŸ¥çœ‹å’Œä»–ä»¬çš„é‚®ä»¶å¾€æ¥")),A.push("nP1"),C="nomail_star"}else{_=n.t("æ²¡æœ‰æœªè¯»é‚®ä»¶"),M.push(n.t("æ‰€æœ‰é‚®ä»¶éƒ½æ˜¯â€œå·²è¯»â€çŠ¶æ€ï¼Œä¼‘æ¯ä¸€ä¸‹å§ï¼Œ"));var F=new $.Link({title:n.t("å·²åˆ é™¤"),text:n.t("å·²åˆ é™¤"),cls:"nui-txt-link mh1",click:function(){t.log("none","viewdeleted"),Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.entry({fid:4})})))}});D+="ï¼Œ"+n.t("æˆ–å»â€œ")+F.html()+n.t("â€é‡Œæ‰¾æ‰¾çœ‹"),M.push(D),A.push("lk1"),C="nomail_unread"}}else if(d){_=n.t("æŠ±æ­‰ï¼Œæ²¡æœ‰æœç´¢åˆ°å…³é”®å­—ä¸ºâ€œ"),k&&(_+='<span class="nui-txt nui-txt-mark">'+k+"</span>"),_+=n.t("â€çš„é‚®ä»¶");try{M.push(n.t("å»ºè®®æ‚¨æ£€æŸ¥æœç´¢æ¡ä»¶ï¼šå…³é”®å­—æ˜¯å¦æœ‰é”™è¯¯ï¼Œæˆ–è€…æ›´æ¢å…³é”®å­—æœç´¢ï¼›å»æ‰ç‰¹æ®Šç¬¦å·é‡æ–°æœç´¢"));var j=(0,a.$I)("module.mbox.Field");if(t.param("pattern")&&t.param("fts.fields")!==j.getField(3)){var N=new $.Link({title:n.t("é«˜çº§æœç´¢"),text:n.t("é«˜çº§æœç´¢"),cls:"nui-txt-link mh1",click:function(){t.log("none","research"),e.additionalSearch("scope","all")}});M.push(n.t("ä½¿ç”¨")+N.html()+n.t("è¯•è¯•ï¼Œæˆ–")+E.html())}}catch(e){a.$D.log(e)}if("full"!==c&&"true"===$G.user.searchid){var U=new $.Link({title:n.t("ä½¿ç”¨å…¨æ–‡æœç´¢"),text:n.t("å…¨æ–‡æœç´¢"),extcls:"nui-txt-link",click:function(){var e=o.clone(t.param()),a=e.conditions[0].operand||e.conditions[0].conditions[0].operand;Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.find({keyword:a,isFullSearch:!0,isForceFullSearch:!0})})))}});M.push(n.t("ä½¿ç”¨")+U.html()+n.t("è¯•è¯•ï¼Œæˆ–")+E.html())}A.push("pq1"),C="nomail_new"}else if(y)_=n.t("æŠ±æ­‰ï¼Œæ²¡æœ‰æ‰¾åˆ°")+n.t("ä»»åŠ¡é‚®ä»¶")+n.t("å“¦"),M.push(D);else if(u){_=n.t("æ‚¨è¿˜æ²¡æœ‰è®¾ç½® ")+(k||n.t("æ——å¸œ"))+n.t("é‚®ä»¶"),M.push(n.t("å°†é‡è¦é‚®ä»¶æ ‡è®°ä¸ºâ€œ")+(k||n.t("æ——å¸œ"))+"â€"+n.t("ï¼Œå°±èƒ½åœ¨â€œ"+(k||n.t("æ——å¸œ"))+"é‚®ä»¶â€ä¸­å¿«é€Ÿæ‰¾åˆ°è¿™äº›é‚®ä»¶"));for(var K=$.LETTERFLAG,O=[],Y=1,B=K.length;Y<B;Y++)K[Y]&&(O[O.length]={text:K[Y],icon:"flag-"+Y,extcls:"nui-txt-flag"+Y,click:function(e){return function(){Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(t){t.default.entry({filter:{label0:e}},{type:"list",subtype:"flag"})})))}}(Y)});var H=new $.Link({extcls:"nui-txt-link",text:'<b class="nui-ico nui-ico-flag nui-ico-flag-0"></b>'+n.t("å…¶ä»–æ——å¸œ&nbsp;")+'<b class="nui-ico nui-ico-dArr">d</b>',listeners:{render:function(){new $.Menu({groups:[{items:O}]}).attachTo({clickFrom:this.getEl()})}}});M.push(D+n.t("ï¼Œæˆ–è€…ç‚¹å‡»æŸ¥çœ‹")+H.html()),A.push("nN1"),C="nomail_flag"}else if(m){_=n.t("è¯¥æ ‡ç­¾ä¸‹æ²¡æœ‰é‚®ä»¶"),M.push(D),F=new $.Link({title:n.t("å·²åˆ é™¤"),text:n.t("å·²åˆ é™¤"),cls:"nui-txt-link mh1",click:function(){t.log("none","viewdeleted"),Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.entry({fid:4})})))}});var G=new $.Link({title:n.t("æ·»åŠ æ ‡ç­¾"),text:n.t("æ·»åŠ æ ‡ç­¾"),cls:"nui-txt-link mh1",click:function(){t.log("none","addTag"),Promise.resolve().then(i.bind(i,71591)).then($.Function.bind((function(e){e.default.add({from:"none"})})))}});M.push(n.t("å»â€œ")+F.html()+n.t("â€é‡Œæ‰¾æ‰¾çœ‹ï¼Œæˆ–")+G.html()+n.t("æ›´å¥½åœ°ç®¡ç†é‚®ä»¶")),A.push("nM1"),C="nomail_type"}else if(p)_=n.t("æ‚¨ç›®å‰æ²¡æœ‰å¾…åŠé‚®ä»¶"),M.push(n.t("å°†é‚®ä»¶æ ‡è®°ä¸ºâ€œå¾…åŠâ€å¹¶è®¾ç½®å¤„ç†æ—¶é—´ï¼Œåˆ°æœŸæ—¶é‚®ç®±ä¼šæé†’æ‚¨å¤„ç†è¯¥å°é‚®ä»¶")),M.push(D),A.push("nL2"),C="nomail_todo";else if(g)_=n.t("æ²¡æœ‰æœªè¯»ç z=t.param("fid"),q=t.param("tag"),Z=(0,a.$I)("=z||7==z||18==z)_=n.t("æ²¡æœ‰")+Z.name;else{var V=!1;if(q&&q.length)for(Y=0;Y<q.length;Y++)if(/^%ex_trace_(.+)%$/.test(q[Y])){V=!0;break}_=V?n.t("æš‚æ— ç›¸å…³é‚®ä»¶"=t.extend("area"),J=n.t("æŸ¥çœ‹")+("archive"===W?n.t("æœ€è¿‘"):n.t("æ›´æ—©"))+n.t("çš„é‚®ä»¶"),X=new $.Link({title:J,text:J,cls:"nui-txt-link mh1",click:function(){t.log("none","viewarea"),e.goPage("archive"===W?-1:t.getPage())}});M.push(X.html())}if((4===z||15===z)&&$.Ext.recovery&&!(0,a.$S)("isVip")){var Q=new $.Link({title:n.t("é€šè¿‡è¯¯åˆ æ¢å¤æ‰¾å›é‚®ä»¶"),text:n.t("æ¢å¤è¯¯åˆ çš„é‚®ä»¶"),cls:"nui-txt-link mh1",click:function(){t.log("none","recovery"),Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"recovery",title:n.t("è¯¯åˆ æ¢å¤"),fullScreen:!0})})))}});M.push(Q.html())}var ee=Z.flags;if(!ee.system)if(ee.custom){var te=new $.Link({title:n.t("è®¾ç½®æ¥ä¿¡åˆ†ç±»"),text:n.t("è®¾ç½®æ¥ä¿¡åˆ†ç±»"),cls:"nui-txt-link mh1",click:function(){t.log("none","setfilter"),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.goFilter({folder:z})})))}});M.push(te.html()+n.t("ï¼Œå°†æŒ‡å®šçš„é‚®ä»¶åˆ†ç±»åˆ°æ­¤æ–‡ä»¶å¤¹"))}else if(ee.pop){var ie=new $.Link({title:n.t("ç«‹å³æ”¶å–é‚®ä»¶"),text:n.t("ç«‹å³æ”¶å–é‚®ä»¶"),cls:"nui-txt-link mh1",click:function(){t.log("none","receive"),Promise.resolve().then(i.bind(i,26715)).then($.Function.bind((function(e){e.default.receive({type:"fid",value:z})})))}});M.push(ie.html())}A.push("pq1"),C="nomail_new"}else if(h){if(_=k+n.t(" æ²¡æœ‰æ”¶åˆ°é‚®ä»¶"),"date"===t.extend("calendar"))try{var ae=t.param("filter").sentDate,ne=t.constructor,oe=ae.split(":")[0],re=ne.parseSentDate(oe),se=new $.Link({title:n.t("æŸ¥çœ‹ ")+k+n.t(" é™„è¿‘ä¸ƒå¤©é‚®ä»¶"),text:n.t("æŸ¥çœ‹é™„è¿‘ä¸ƒå¤©é‚®ä»¶"),cls:"nui-txt-link mh1",click:function(){t.log("none","calendar"),e.toolbar.toolbar.find("calendar")[0].fire("select",r.addDate(re,-3),r.addDate(re,3))}});M.push(n.t("å»ºè®®æ‚¨ï¼š")+se.html()),M.push(E.html())}catch(e){}A.push("pq1"),C="nomail_new"}else b&&l?(_=n.t("ç³»ç»Ÿæ²¡æ‰¾åˆ°ç›¸å…³é‚®ä»¶ï¼ŒåŸå› å¯èƒ½æ˜¯:"),M.push(n.t("1.æ‚¨æ›¾ç»æ¸…ç†è¿‡ç›¸å…³çš„é‚®ä»¶")),M.push(n.t("2.è¯¥ç½‘ç«™çš„ç¡®æ²¡ç»™æ‚¨å‘è¿‡é‚®ä»¶"))):(_=n.t("æŠ±æ­‰ï¼Œæ²¡æœ‰æ‰¾åˆ°")+k+n.t("ç›¸å…³é‚®ä»¶å“¦"),M.push(D));if(""!==e.getLayout()?L="uZ1":(1===A.length&&(A.push("pq1"),C="nomail_new"),T=A.join(" ")),(0,a.$S)("isVip")){var ce=new $.Link({text:n.t("æ–‡ä»¶æ¢å¤"),cls:"nui-txager").goOutLink("recovery",n.t("æ–‡ä»¶æ¢å¤"))}}),le=new $.Icon({extcls:"nui-ico-tequan"});M.push(n.t("è¯•è¯•")+ce.html()+le.html())}return I=M.join("<br />"),['<div class="Bp0 ',L,'" id="',t.createId("none_div"),'" infoKey="',C,'">','<div class="',T,'" style="background-color: #',(0,a.$S)("skin").color||"6A8DE5",';"></div>','<div class="pl1">','<div class="sB1">',_,"</div>",'<div class="uU0">',$G.environment.isCh?I:"","</div>","</div>"].concat(["</div>"]).join("")}catch(e){console.log(e)}},init:function(){var e=this,t=e.view.module;e.page=t.getPage(),e.type=t.extend("type"),e.subtype=t.extend("subtype")},initialize:function(e){this.view=e},noneEvent:function(){var e=this.view.module,t=e.getEl("none_like");t&&t.click((function(i){var a,n=e.getEl("none_div")e.get("none_like")||0,r=$.Array.indexOf(c,n);t.hasClass("mx3")?(o=$.Number.setBit(o,r,0),t.removeClass("mx3"),(a={})["un_"+n]=1,$.Log.cache(a)):(o=$.Number.setBit(o,r,1),(a={})["un_"+n]=1,$.Log.cache(a),t.addClass("mx3")),$.Storage.set("none_like",o)}))}}),t.Z=s},42237:function(e,t,i){i(803);var a=i(72957),n=new a.c1("module.mbox.Pager"),o=$.Object,r=$.createClass((0,a.$N)("module.mbox.Pager"));o.extend(r.prototype,{view:null,hidden:!1,page:0,get:function(){var e=this,t=e.view.module;e.init();var i=e.getContent();return['<div class="te0 nui-btnGroup" id="',t.createId("PagerDiv"),'" style="display:none;">',i,"</div>"].join("")},update:function(){var e=this,t=e.view.module;e.init();var i=t.getEl("PagerDiv");e.hidden?i.hide():(i.html(e.getContent()),i.show())},getContent:function(){var e,t,i=this,a=i.view,o=a.module,r=i.page,s=o.extend("index"),c=o.extend("area");o.isArchive()&&(e="normal"===c,t="archive"===c);var l=[];if(!i.hidden){var d=s>0||t?function(){o.log("pager","previous"),a.goPage(s-1),o._child&&o._child.view.changeSelect()}:void 0,u=!d,m=s<r-1||e?function(){o.log("pager","next"),a.goPage(s+1),o._child&&o._child.view.changeSelect()}:void 0,p=!m;l[l.length]=new $.Button({xtype:"button",icon:"prev",subclass:"roundBtn",params:"hasText",disabled:u,click:d,text:n.t("ä¸Šä¸€é¡µ"),title:n.t("ä¸Šä¸€é¡µ")}).html(),l[l.length]=new $.Button({xtype:"button",icon:"next",subclass:"roundBtn",params:"hasText hasLeftText",disabled:p,click:m,text:n.t("ä¸‹ä¸€é¡µ"),title:n.t("ä¸‹ä¸€é¡µ")}).html()}return l.join("")},show:function(){var e=this.view.module;try{this.hidden||e.getEl("PagerDiv").show()}catch(e){}},init:function(){var e=this,t=e.view.module;e.page=t.getPage(),e.hidden=e.page<(t.isArchive()?1:2)},initialize:function(e){this.view=e}}),t.Z=r},98710:function(e,t,i){i(8600),i(92274),i(75654),i(66403),i(803),i(42295),i(52963);var a=i(72957),n=new a.c1("module.mbox.Period"),o=$.Object,r=$.Date,s=$.createClass((0,a.$N)("module.mbox.Period"));o.extend(s.prototype,{infos:!1,view:null,once:!1,inited:!1,reinit:!1,get:function(e,t){var i=this,n=i.view,o=n.module,r=o.extend("subtype"),s={};if(i.inited||i.initialize(n),!1!==i.infos){for(var c,l=o.param("order"),d=e.flags.expire,u=e.flags.top,m="defer"===r?e.defer:e.sentDate,p="from"===l?$.Uri.getAddress(e.from.toLowerCase()):void 0,f=o.isTop(),h=i.infos,g=0,v=h.length;g<v;g++)if(c=h[g],"from"===l){if(c.email===p)break}else{if(d&&c.expire)break;if(u&&f&&c.top)break;if(m>=c.start&&m<c.end)break}if(c.div||c.id)c.count?c.count++:c.count=1;else{c.count=1;var b={},y="nn0";if(!i.once){var x=(0,a.$S)("isFree"),k=o.param("fid");x&&2!==k&&c.date&&(y="nn0 gU0",o.extend("smart")&&(b.style="display:none;")),i.once=!0}if(b.id=o.createId((c.start?c.start.getTime().toString():"top")+(new window.Date).getTime().toString()),b.className="tb0 "+y,b.innerHTML='<span class="jM0">'+c.name+'</span><span class="nui-title-tips nui-txt-tips"></span>',b["aria-label"]=c.name+(c.email?"&lt;"+c.email+"&gt;":""),b.tabIndex=0,t){var S=[],w="";for(var T in b){var C=b[T];switch(T){case"className":S.push('class="'+C+'"');break;case"tabIndex":S.push('tabindex="'+C+'"');break;case"innerHTML":w=C;break;default:S.push(T+'="'+C+'"')}}var _=[d=b.id,s.html=_}else{var I=c.div=document.createElement("DIV");for(T in b)C=b[T],"aria-label"===T?I.setAttribute(T,C):I[T]=C;s.div=I}}}return s},count:function(){for(var e=this.infos,t=0,i=e.length;t<i;t++){var a=e[t],n=a.div;if(n||(n=a.div=document.getElementById(a.id),a.id=null),n)try{var o=n.getElementsByTagName("SPAN");o[o.length-1].innerHTML="("+a.count+")"}catch(e){}}},reset:function(){var e=this,t=e.infos;if(!1!==t)for(var i=0,a=t.length;i<a;i++){var n=t[i],o=n.div?n.div:n.id?document.getElementById(n.id):null;try{o&&o.parentNode.removeChild(o)}catch(e){}delete n.div,delete n.id,delete n.count}e.reinit&&(e.inited=!1),e.once=!1},initialize:function(e){var t=this;t.view=e;var i=e.module,o=i.param("order"),s=!0;if("date"===o||"deferredDate"===o){var c,l,d=t.infos=[],u=$.Misc.getTime(0),m=new window.Date(-1e4,0,1),p=new window.Date(1e4,0,1),f=new window.Date(u.getFullYear(),u.getMonth(),u.getDate()+1),h=f;if("date"===o){i.extend("expire")&&(d[d.length]={name:n.t("ä»Šæ—¥éœ€è¦å¤„ç†çš„å¾…åŠé‚®ä»¶"),expire:!0}),i.isTop()&&(d[d.length]={name:n.t("ç½®é¡¶"),top:!0});for(var g=0,v=u.getDay();g<=v&&!(g>1);g++)0===g?(T=n.t("ä»Šæ—¥"),c=d.length):T=1===g?n.t("æ˜¨æ—¥"):n.t("å‘¨")+r.getWeek(u,-g),l=new window.Date(r.addDate(h,-1)),d[d.length]={name:T,start:l,end:h,date:!0},h=l;d[d.length]={name:n.t("æ›´æ—©"),start:m,end:h,date:!0},d[c].end=p}else"deferredDate"===o&&(d[d.length]={name:n.t("éœ€è¦å¤„ç†çš„å¾…åŠé‚®ä»¶"),start:m,end:f},d[d.length]={name:n.t("å°šæœªåˆ°æœatch(e){}t.reinit=!0;var y=i.getCacheData(),x={};if(y&&y.length>0)for(d=t.infos=[],g=0,v=y.length;g<v;g++){var k=y[g],S=$.Uri.getAddress(k.from.toLowerCase());if(!x[S]){var w=$.Uri.getEmails(S,void 0,!0).match,T=S;try{if(1===w.length){var C=w[0];C.force=!0,T=b.getName(C)}}catch(e){}d[d.length]={name:$.String.encodeHTML(T),email:S},x[S]=!0}}else s=!1}t.inited=s}}),t.Z=s},63574:function(e,t,i){var a=i(20224),n=i(28978),o=i(72957),r=$.createClass((0,o.$N)("module.mbox.PreviewModule"));$.Object.mix(r,n.Z,{View:a.Z},{init:function(){},initialize:function(e){}})},20224:function(e,t,i){i(37092),i(92274),i(803);var a=i(32073),n=i(72957),o=new n.c1("module.mbox.PreviewView"),r=$.createClass((0,n.$N)("module.mbox.PreviewView"));$.Object.mix(r,a.Z,{},{getHtml:function(){return this.addHeader(null,this.getNone(),"frame-main-cont-body-second frame-main-cont-body-noToolbar")},getNone:function(){return'<div class="nui-infoBlock nui-block si0"><div class="nui-block-title">'+o.t("æœªé€‰ä¸­é‚®ä»¶")+"</div></div>"},getSelected:function(e){var t=this,i=t.module._parent,a=new $.Link({text:o.t("å–æ¶ˆé€‰æ‹©"),click:function(){i.view.select("none"),t.changeSelect()}}),n=[];n[n.length]='<div class="rm0">'+o.t("å·²é€‰æ‹© ")+"<strong>"+e.length+"</strong>"+o.t(" å°é‚®ä»¶")+'<span class="op0">'+a.html()+"</span></div>",n[n.length]='<div class="po0">';for(var r=0,s=e.length;r<s;r++){var c=e[r].getDiv(),l="",d="",u="";try{l=$.fly(c).find(".dP0").dom.innerHTML}catch(e){}try{d=$.fly(c).find(".eO0").dom.innerHTML}catch(e){}try{u=$.fly(c).find(".dd0").dom.innerHTML}catch(e){}n[n.length]='<div class="nui-infoBlock nui-block pn0"><div class="nui-block-text">',n[n.length]='<div class="ji0">'+l+"</div>",n[n.length]='<div class="jg0"><span class="nui-txt-tips">'+d+"</span></div>",u&&(n[n.length]='<div class="jf0">'+u+"</div>"),n[n.length]="</div></div>"}return n[n.length]="</div>",n.join("")},changeSelect:function(){for(var e=this,t=e.module,i=t._parent,a=i.view.letters,n=(i.extend("index"),i.extend("limit"),[]),o=0,r=a.length;o<r;o++){var s=a[o];s.checked&&n.push(s)}var c=0===n.length?e.getNone():e.getSelected(n);t.getDom("ScrollDiv").innerHTML=c,$.Component.setEvents()},initialize:function(e){}}),t.Z=r},62948:function(e,t,i){var a=i(88578),n=i(72957),o=$.Object,r=$.createClass((0,n.$N)("module.mbox.SearchAction"));o.mix(r,a.Z,{},{getList:function(e,t,i){var a;this.module,t||(t={}),a=e.ids?{func:"mbox:getMessageInfos"}:{func:"mbox:searchMessages"},o.extend(a,{body:e,call:function(e){i(e)},hideWait:t.hideWait,sync:t.sync}),this.wmsvr(a)},moveAll:function(e){var t=e.data,i=e.moveToId,a=e.callback,n={func:"mbox:updateMessageInfos",body:{ids:this.getIds(t,!0)[0],attrs:{fid:i}},call:function(e){$.Listener.fire("search:removeall"),a(e)}};this.wmsvr(n)},initialize:function(e){r.superClass.initialize.call(this,e)}}),t.Z=r},58369:function(e,t,i){var a=i(95430),n=i(72957),o=$.Object,r=$.createClass((0,n.$N)("module.mbox.SearchListener"));o.mix(r,a.Z,{},{}),t.Z=r},97687:function(e,t,i){i.r(t),i(36809),i(37885),i(92274),i(75654),i(42295),i(52963),i(66403),i(803),i(13484),i(19975),i(65132),i(48868),i(81874),i(54861);var a=i(56301),n=i(58369),o=i(55117),r=i(62948),s=i(44033),c=i(72957);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var d=new c.c1("module.mbox.SearchModule"),u=$.Object,m=$.String,p=$.createClass((0,c.$N)("module.mbox.SearchModule"));u.mix(p,s.default,{View:o.Z,Listener:n.Z,Action:r.Z,action:new r.Z,removeAll:function(e){var t=e.data,i=e.callback;this.action.moveAll({data:t,moveToId:4,callback:function(e){i&&i(!0)}})},entry:function(e,t,i){s.default.entry.call(this,e,t,i)}},{result:null,extendParam:function(e,t){var i=t.limit;u.extend(e,{windowSize:i,returnTag:!!$.Ext.tag})},getData:function(e,t,i){var a=this,n=a.param(),o=a.extend(),r=o.limit,s=!1;t>=0||(t=o.index);var c=r*t;if(!i){try{a.view.deleteInterval()}catch(e){}a.removeCache()}var l=u.clone(o);if(l.hideWait=!!i,l.start=c,a.result){var d=a.checkCacheData(t);if(d.cached)$.Thread.run((function(){e()}),0);else{var m=d.ids;p({mboxa:n.mboxa,ids:m})}}else s=!0,p(u.clone(n));function p(e){a.extendParam(e,{limit:r}),a.getList(e,l,f)}function f(){var n=!1;if(s&&t>0){var o=a.getPage();t>=o&&(t=o-1),n=!0}n?a.getData(e,t,i):e()}},getText:function(){return d.t("æœç´¢é‚®ä»¶")},getCacheData:function(e){var t,i=this.extend();e||(e=i.index);var a=e<0;try{var n=this.result.var;if(n)if(a)t=n.slice();else{t=[];for(var o=i.limit,r=e*o,s=0,c=n.length;s+r<c&&s<o;s++)t.push(n[s+r])}}catch(e){}return t&&t.length>0?t:void 0},checkCacheData:function(e){var t=this.extend();e||(e=t.index);var i=this.getCacheData(e),a=[],n=!0;if(i)for(var o=0,r=i.length;o<r;o++){var s=i[o];"string"==typeof s?(n=!1,a.push(s)):a.push(s.id)}return{cached:n,ids:a,cacheData:i}},cleanData:function(){delete this.result},removeData:function(e,t){for(var i=this,a=i.result.var,n=i.getTotal(),o=a.length-1,r=0;o>-1&&r<e;){var s=a[o];s&&t[s.id]&&(a.splice(o,1),r++,n--),o--}i.setTotal(n)},getList:function(e,t,i){var a=this;a.action.getList(e,t,(function(n){var o=n.var;if(e.ids)for(var r=a.result.var,s=t.start,c=0,l=o.length;c<l;c++){var d=s+c,u=r[d],m=o[c];"string"==typeof u&&m.id===u&&(r[d]=m)}else a.result=n,a.setTotal(o?o.length:0);try{var p=n.keywords;e:for(c=0;c<p.length;c++)for(var f=p[c],h=0;h<o.length;h++)if((m=o[h]).from.indexOf(f)>-1){$.Log.cache({mbox_search_hit_from:1});break e}}catch(e){}i(n),a.getAllTagInfo(o,t.start)}))},getAllTagInfo:function(e,t){var i=this.view,a=this.result;try{for(var n=[],o=[],r=0,s=e.length;r<s;r++){var l=e[r].tag;if(l&&l.length)for(var u=0;u<l.length;u++){var m=l[u],p=e[r].from;p=p instanceof window.Array?p[0]:p.toString();var f=m.match(/^%ex_mkt_logo_(.+)%$/);if(f&&!e[r].mktInfo&&(h=f[1])){n.push({teamId:h,sender:$.Uri.getAddress(p),id:e[r].id});break}var h,g=m.match(/^%ex_tc_logo_(.+)%$/);if(g&&!e[r].teamInfo&&(h=g[1])){o.push({teamId:h,sender:$.Uri.getAddress(p),id:e[r].id});break}}}n.length&&(0,c.$I)("init.Contacts").getMarketingInfo(n,(function(e){if(e){var n={},r=0;if($.Array.each(o,(function(t,i){var a=i.sender+"_"+i.teamId;if(e[a]){var o=e[a];o.extInfo="",2===o.status&&(o.extInfo=d.t("ï¼ˆå·²å¤±æ•ˆï¼‰")),n[i.id]=o,r++}})),i.syncLetter("mktInfo",r,n),!r)return;if(a&&a.var&&a.var.length){a=a.var;for(var s=t,c=a.length;s<c;s++)if(a[s]){var l=a[s];n[l.id]&&(a[s].mktInfo=n[l.id])}}}})),o.length&&(0,c.$I)("init.Contacts").getTeamCorpInfo(o,(function(e){if(e){var n={},r=0;if($.Array.each(o,(function(t,i){var a=i.sender+"_"+i.teamId;if(e[a]){var o=e[a];o.extInfo="",o.teamStatus?o.senderStatus||(o.extInfo=d.t("ï¼ˆå·²ç¦»èŒï¼‰")):o.extInfo=d.t("ï¼ˆå·²å¤±æ•ˆï¼‰"),n[i.id]=o,r++}})),i.syncLetter("teamInfo",r,n),!r)return;if(a&&a.var&&a.var.length){a=a.var,console.log(a,t,n);for(var s=t,c=a.length;s<c;s++)if(a[s]){var l=a[s];n[l.id]&&(a[s].teamInfo=n[l.id])}}console.log(a)}}))}catch(e){console.log(e)}},getCondition:function(){var e=this.param();return"full"===this.extend().subtype?function(){var t=e.pattern,i=[],n=e.fids;if(n&&1===n.length){var o=(0,c.$I)("init.Folder");i.push(o.get(n[0]).name)}var r=e.conditions;if(r)for(var s=0,l=r.length;s<l;s++){var u=r[s];switch(u.field){case"from":i.push(u.operand);break;case"sentDate":for(var p=a.Z.getDateDiff(),f=0,h=p.length;f<h;f++){var g=p[f];if(g.date===u.operand){"<="===u.operator&&(g=p[f+=1]),i.push(g.name);break}}break;case"flags":var v=u.operand.attached;"boolean"==typeof v&&i.push(v?d.t("æœ‰é™„ä»¶"):d.t("æ— é™„ä»¶"));var b=u.operand.read;"boolean"==typeof b&&i.push(b?d.t("å·²è¯»"):d.t("æœªè¯»"))}}return'<strong class="Dh0">'+m.encodeHTML(t)+"</strong>"+(i.length>0?d.t("ï¼Œé™„åŠ æ¡ä»¶ä¸ºâ€œ")+'<strong class="txt-keyword">'+i.join("</strong>"+d.t("ï¼Œ")+'<strong class="txt-keyword">')+"</strong>"+d.t("â€"):"")}():function(){var t=[];try{var i=e.conditions;if(u.isArray(i)&&(i=i[0]),i){var a=i.field,n=i.operand,o=i.operator;switch(a){case"flags":var r;n.replied&&t.push(d.t("å·²å›å¤")),n.forwarded&&t.push(d.t("å·²è½¬å‘")),(r=$.Ext.newAttach?n.realAttached:n.attached)?t.push(d.t("æœ‰é™„ä»¶")):!1===r&&t.push(d.t("æ— é™„ä»¶")),n.linkAttached?t.push(d.t("æœ‰è¶…å¤§é™„ä»¶")):!1===n.d?t.push(d.t("å·²è¯»")):0===t.length&&t.push(d.t("æœªè¯»"));break;case"label0":t.push(0===n?d.t("æ‰€æœ‰æ——å¸œ"):$.LETTERFLAG[n]);break;case"priority":switch(o){case">":t.push(d.t("ç¼“æ…¢"));break;case"<":t.push(d.t("ç´§æ€¥"));break;default:t.push(d.t("æ™®é€š"))}break;case"subject":t.push('<strong class="Dh0">'+m.encodeHTML(n)+"</strong>");break;case"from":case"to":t.push(d.t("ä¸ ")+m.encodeHTML(n)+d.t(" å¾€æ¥"))}a||(n=e.conditions[0].conditions[0].operand)&&("string"==typeof n&&($.Uri.matchEmail(n)?t.push(d.t("ä¸ ")+m.encodeHTML(n)+d.t(" å¾€æ¥")):t.push('<strong class="Dh0">'+m.encodeHTML(n)+"</strong>")),"object"===l(n)&&((r=$.Ext.newAttach?n.realAttached:n.attached)&&t.push(d.t("æœ‰é™„ä»¶")),!1===r&&t.push(d.t("æ— é™„ä»¶")),n.linkAttached&&t.push(d.t("æœ‰è¶…å¤§é™„ä»¶")),!0===n.linkAttached&&t.push(d.t("æ— è¶…å¤§é™„ä»¶"))))}}catch(e){c.$D.log(d.t("è·å–æœç´¢æ¡ä»¶å‡ºé”™"))}return 0===t.length?"":t.join()}()},getSummary:function(){var e,t,i=this,a=i.extend();if("full"===a.subtype){var n=[],o={};e=i.getCacheData(),t=a.index;for(var r=0,s=e.length;r<s;r++){var c=e[r],l=c.id;n.push(l);var d=l;try{d=/(\d+\:)?([^:_]+)/.exec(d)[2]}catch(e){}o[d]=c}i.action.getSummary({ids:n,pattern:i.param("pattern"),callback:function(e){if(t===i.extend("index")){for(var a=0,n=e.length;a<n;a++)try{var r=e[a];o[r.mid].summary=r.summary}catch(e){}i.view.setSummary()}}})}},hasAdditional:function(){var e=this.param(),t=e.fids,i=e.conditions;return t&&1===t.length||i&&i.length>0},initialize:function(e){p.superClass.initialize.call(this,e)}}),t.default=p},55117:function(e,t,i){i(66403),i(37092),i(92274),i(68233),i(79150),i(803),i(48868),i(63045),i(81874),i(54861),i(37885);var a=i(56301),n=i(49134),o=i(72957),r=new o.c1("module.mbox.SearchView"),s=$.Object,c=$.String,l=$.Function,d=$.createClass((0,o.$N)("module.mbox.SearchView"));s.mix(d,n.Z,{},{getControl:function(){try{var e=(0,o.$L)("support.AddressSupport",this)}catch(e){return e}var t=this,i=t.module,n=i.param(),d=i.extend(),u=i.result,m=(0,o.$I)("init.Folder");if("full"!==d.subtype||0===i.getTotal())return"";n.pattern;var p,f=n.fids,h=n.conditions,g=n["fts.fields"],v=u.groupings,b=$.Ud.get({field:"ntes_global",flag:"secondSearch"})-0==1;$.Ud.get({field:"ntes_inbox",flag:"search_type"}),p=b?"pJ0":"",i.hasAdditional();var y=[];y[y.length]=new $.Link({text:'<b class="oJ1"></b>',title:b?r.t("å±•å¼€æœç´¢æ¡ä»¶"):r.t("éšè—æœç´¢æ¡ä»¶"),extcls:"vs1",click:l.bind(t.toggleControl,t)}).html(),y[y.length]='<div class="DG0 '+p+'" id="'+i.createId("ControlDiv")+'">';var x=new $.Link({title:r.t("è®¾ç½®é»˜è®¤æœç´¢èŒƒå›´"),bracket:!0,text:r.t("è®¾ç½®é»˜è®¤"),attrs:'style="font-color:#0f6099;"',cls:"nui-txt-cLink",click:l.bind(a.Z.setDefaultFields,a.Z,t)});y[y.length]='<dl class="wW0" ><dt class="wU0" tabindex="0" aria-label="'+r.t("é»˜è®¤æœç´¢èŒƒå›´")+'">'+r.t("æœç´¢èŒƒå›´")+x.html()+"</dt>";var k=[],S=a.Z.getFields();s.each(S,(function(e,i){var a=g===i.key?" lZ1":"",n=new $.Link({text:i.title,value:e,click:l.bind(t.additionalSearch,t,"scope",e)});y[y.length]='<dd class="yc0'+a+'">'+n.html()+"</dd>",k.push(n)})),$.Radio.group(k),y[y.length]='</dl><dl class="wW0" ><dt class="wU0" tabindex="0" aria-label="'+r.t("æ–‡ä»¶å¤¹")+'">'+r.t("æ–‡ä»¶å¤¹")+"</dt>";var w=[];v&&(w=v.fid);var T=(0,o.$S)("_preSearchAllCount");if(!T){T=0;for(var C=0,_=w.length;C<_;C++)T+=w[C].cnt;(0,o.$S)("_preSearchAllCount",T)}var I=new $.Link({title:r.t("å…¨éƒ¨"),text:r.t("å…¨éƒ¨")+" "+new $.Label({text:"("+T+")",type:"tips"}).html(),click:l.bind(t.additionalSearch,t,"fid",void 0)});for(y[y.length]='<dd class="yc0 '+(f&&1===f.length?"":"lZ1")+'">'+I.html()+"</dd>",C=0,_=w.length;C<_;C++){var A=w[C],M=A.val,L=A.cnt,E=m.get(M).name;I=new $.Link({title:r.t("åœ¨æœç´¢ç»“æœä¸­ç²¾ç¡®æ–‡ä»¶å¤¹ä¸º")+E,text:E+" "+new $.Label({text:"("+L+")",type:"tips"}).html(),click:l.bind(t.additionalSearch,t,"fid",M)}),y[y.length]='<dd class="yc0 '+(f&&1===f.length&&f[0]==M?"lZ1":"")+'" folderItemExpendFive="'+(C>5?"true":"")+'" style="'+(C>5?"display:none;":"")+'">'+I.html()+"</dd>"}if(w.length>5){var D=new $.Link({title:r.t("å±•å¼€æ‰€æœ‰æ–‡ä»¶å¤¹"),text:r.t("å±•å¼€å…¨éƒ¨")+'<b class="nui-ico nui-ico-dArr"></b>',extcls:"nui-txt-link",click:function(){var e=i.getEl("ControlDiv");this.getText().indexOf(r.t("å±•å¼€"))>-1?($(e).find("[folderItemExpendFive='true']").show(),this.update({text:r.t("æ”¶èµ·")+' <b class="nui-ico nui-ico-uArr"></b>',title:r.t("æ”¶èµ·æ–‡ä»¶å¤¹")})):($(e).find("[folderItemExpendFive='true']").hide(),this.update({text:r.t("å±•å¼€å…¨éƒ¨")+' <b class="nui-ico nui-ico-dArr"></b>',title:r.t("å±•å¼€æ‰€æœ‰æ–‡ä»¶å¤¹")}))}});y[y.length]='<dd class="yc0">'+D.html()+"</dd>"}y[y.length]='<dt class="wU0" tabindex="0" aria-label="'+r.t("å‘ä»¶äºº+æ”¶ä»¶äºº")+'">'+r.t("å‘ä»¶äºº+æ”¶ä»¶äºº")+"</dt>";var R=ye("from"),P="";if(R){var F=R.operand,j=e.getName($.Uri.matchEmail(F));P=c.encodeHTML(j||F)}var N=[];v&&(N=v.fromAddress);var U,K=[],O=[];for(C=0,_=N.length;C<_;C++){var Y=N[C];F=Y.val.toLowerCase(),e.getAddrObj(F)||F===(0,o.$S)("uid")?K.push(Y):O.push(Y)}U=K.concat(O);var B=new $.Link({title:r.t("å…¨éƒ¨"),text:r.t("å…¨éƒ¨")+" "+new $.Label({text:"("+T+")",type:"tips"}).html(),click:l.bind(t.additionalSearch,t,"from",void 0)});for(y[y.length]='<dd class="yc0 '+(R?"":"lZ1")+'">'+B.html()+"</dd>",C=0,_=U.length;C<_;C++){var H=U[C],G=c.trim(H.val);if(G){try{var z=e.getName($.Uri.matchEmail(G))}catch(e){o.$D.log("group name parse error")}L=H.cnt;var q=c.encodeHTML(z||G);B=new $.Link({title:r.t("åœ¨æœç´¢ç»“æœä¸­ç²¾ç¡®å‘ä»¶äººä¸º")+G,text:q+new $.Label({text:" ("+L+")",type:"tips"}).html(),click:l.bind(t.additionalSearch,t,"from",G)}),y[y.length]='<dd class="yc0 '+(R&&P==q?"lZ1":"")+'" mailItemExpendFive="'+(C>5?"true":"")+'" style="'+(C>5?"display:none;":"")+'">'+B.html()+"</dd>"}}U.length>5&&(D=new $.Link({title:r.t("å±•å¼€æ‰€æœ‰å‘ä»¶äºº"),text:r.t("å±•å¼€å…¨éƒ¨")+'<b class="nui-ico nui-ico-dArr"></b>',extcls:"nui-txt-link",click:function(){var e=i.getEl("ControlDiv");this.getText().indexOf(r.t("å±•å¼€"))>-1?($(e).find("[mailItemExpendFive='true']").show(),this.update({text:r.t("æ”¶èµ·")+' <b class="nui-ico nui-ico-uArr"></b>',title:r.t("æ”¶èµ·å‘ä»¶äºº")})):($(e).find("[mailItemExpendFive='true']").hide(),this.update({text:r.t("å±•å¼€å…¨éƒ¨")+' <b class="nui-ico nui-ico-dArr"></b>',title:r.t("å±•å¼€æ‰€æœ‰å‘ä»¶äºº")}))}}),y[y.length]='<dd class="yc0">'+D.html()+"</dd>"),y[y.length]='<dt class="wU0" tabindex="0" aria-label="'+r.t("æ—¶é—´èŒƒå›´")+'">'+r.t("æ—¶é—´èŒƒå›´")+"</dt>";var Z=ye("sentDate"),V=a.Z.getDateDiff(),W="";if(Z){var J=Z.operand;for(W=V[4].name,C=0,_=V.length;C<_;C++)if((ae=V[C]).date<=J){"<="===Z.operator&&(ae=V[++C]),W=ae.name;break}}var X=[];for(v&&(X=v.sentDate),C=0,_=X.length;C<_;C++)for(var Q=0,ee=V.length;Q<ee;Q++){var te=X[C];if((ae=V[Q]).date<=te.val&&(ae.count+=te.cnt,Q===ee-2))break}var ie=new $.Link({title:r.t("å…¨éƒ¨"),text:r.t("å…¨éƒ¨")+" "+new $.Label({text:"("+T+")",type:"tips"}).html(),click:l.bind(t.additionalSearch,t,"sentDate",void 0)});for(y[y.length]='<dd class="yc0  '+(Z?"":"lZ1")+'">'+ie.html()+"</dd>",C=0,_=V.length;C<_;C++){var ae;if((ae=V[C]).count>0){var ne=ae.name,oe=ae.count;ie=new $.Link({title:r.t("åœ¨æœç´¢ç»“æœä¸­ç²¾ç¡®æ—¶é—´èŒƒå›´ä¸º")+ne,text:ne+new $.Label({text:" ("+oe+")",type:"tips"}).html(),click:l.bind(t.additionalSearch,t,"sentDate",C)}),y[y.length]='<dd class="yc0 '+(Z&&ne==W?"lZ1":"")+'">'+ie.html()+"</dd>"}ae.count=0}y[y.length]='<dt class="wU0">'+r.t("é‚®ä»¶çŠ¶æ€")+"</dt>";var re,se,ce=ye("flags");ce&&(re=ce.operand.attached,se=ce.operand.read);var le=[];v&&(le=v["flags.attached"]);var de=new $.Link({title:r.t("å…¨éƒ¨"),text:r.t("å…¨éƒ¨")+" "+new $.Label({text:" ("+T+")",type:"tips"}).html(),click:l.bind((function(){this.additionalSearch("attached",void 0),this.additionalSearch("read",void 0)}),t)});for(y[y.length]='<dd class="yc0 '+(void 0===re&&void 0===se?"lZ1":"")+'">'+de.html()+"</dd>",C=0,_=le.length;C<_;C++){var ue=le[C],me=ue.val?r.t("æœ‰é™„ä»¶"):r.t("æ— é™„ä»¶"),pe=ue.cnt;de=new $.Link({title:r.t("åœ¨æœç´¢ç»“æœä¸­ç²¾ç¡®é‚®ä»¶çŠ¶æ€ä¸º")+me,text:me+new $.Label({text:" ("+pe+")",type:"tips"}).html(),click:l.bind(t.additionalSearch,t,"attached",ue.val)}),y[y.length]='<dd class="yc0 '+("boolean"==typeof re&&re===ue.val?"lZ1":"")+'">'+de.html()+"</dd>"}var fe=[];for(v&&(fe=v["flags.read"]),C=0,_=fe.length;C<_;C++){var he=fe[C],ge=he.val?r.t("å·²è¯»"):r.t("æœªè¯»"),ve=he.cnt,be=new $.Link({title:r.t("åœ¨æœç´¢ç»“æœä¸­ç²¾ç¡®é‚®ä»¶çŠ¶æ€ä¸º")+ge,text:ge+new $.Label({text:" ("+ve+")",type:"tips"}).html(),click:l.bind(t.additionalSearch,t,"read",he.val)});y[y.length]='<dd class="yc0 '+("boolean"==typeof se&&se===he.val?"lZ1":"")+'">'+be.html()+"</dd>"}return y[y.length]="</dl></div>",y.join("");function ye(e){var t=null;if(h)for(var i=0,a=h.length;i<a;i++){var n=h[i];n.field===e&&(t=n)}return t}},toggleControl:function(){var e,t,i,a=this.module,n=$.Ud.get({field:"ntes_global",flag:"secondSearch"})-0==1,o=a.getEl("ControlDiv");n?(e="pJ0",t="",i=0,a.getEl("HtmlDiv").addClass("Ay0"),a.getEl("HtmlDiv").removeClass("zj1")):(e="",t="pJ0",i=1,a.getEl("HtmlDiv").removeClass("Ay0"),a.getEl("HtmlDiv").addClass("zj1")),o.removeClass(e),o.addClass(t),$.Ud.set({field:"ntes_global",flag:"secondSearch",value:i}),this.title.update(),o.destroy()},additionalSearch:function(e,t){var n=this,o=n.module,r=s.clone(o.param()),c=s.clone(o.extend());if(c.index=0,void 0===t)switch(e){case"from":case"sentDate":u(e);break;case"attached":case"read":u("flags");break;case"fid":r.fids=n.fidbak,delete n.fidbak;break;default:!r.fids&&n.fidbak?r.fids=n.fidbak:delete r.fids,delete n.fidbak,r.conditions&&delete r.conditions}else{var l=a.Z.getFields(),d=a.Z.getDateDiff();switch(e){case"scope":if(r["fts.fields"]===l[t].key)return;r["fts.fields"]=l[t].key;break;case"from":m(e,{field:e,operator:"contains",ignoreCase:!0,operand:t});break;case"fid":n.fidbak=r.fids,r.fids=[t];break;case"sentDate":t===d.length-1?m(e,{field:e,operator:"<=",operand:d[t-1].date}):m(e,{field:e,operator:">",operand:d[t].date});break;case"attached":m("flags",{field:"flags",operator:"=",operand:{attached:t}});break;case"read":m("flags",{field:"flags",operator:"=",operand:{read:t}})}}function u(e){var t=r.conditions;if(t)for(var i=0,a=t.length;i<a;i++)if(t[i].field===e){t.splice(i,1);break}}function m(e,t){var i=r.conditions;i||(i=r.conditions=[]),function(e){var t=!1,i=r.conditions;if(i)for(var a=0,n=i.length;a<n;a++)if(i[a].field===e){t=!0;break}return t}(e)?function(e,t){var i=r.conditions;if(i)for(var a=0,n=i.length;a<n;a++)if(i[a].field===e){$.Object.isEqual(i[a].operand,t.operand)||(i[a].operand instanceof window.Date?i[a].operand=t.operand:$.Object.extend(i[a].operand,t.operand));break}}(e,t):i[i.length]=t}Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.entry(r,c)})))},removeAll:function(){var e=this,t=e.module;function a(){e.refresh()}$.Msgbox.show({type:"confirm",content:r.t("ç¡®å®šå°†æ‰€æœ‰æœç´¢å‡ºæ¥çš„é‚®ä»¶éƒ½ç§»åŠ¨åˆ° å·²åˆ é™¤ æ–‡ä»¶å¤¹å—ï¼Ÿ"),title:r.t("åˆ é™¤ç¡®è®¤"),ok:function(){Promise.resolve().then(i.bind(i,97687)).then($.Function.bind((function(e){e.default.removeAll({data:t.result.var,callback:a})})))}})},initialize:function(e){d.superClass.initialize.call(this,e)}}),t.Z=d},42732:function(e,t,i){i(48868),i(92274),i(63045),i(81874),i(54861),i(66403),i(66251),i(68233),i(67285),i(96752),i(49750),i(8600),i(803),i(75654),i(55737),i(42295),i(34994);var a=i(4982),n=(i(62385),i(20313)),o=i(92066),r=i(40823),s=i(60196),c=i(42366),l=i(72957),d=i(1124),u=new l.c1("module.mbox.Tips"),m=$.Object,p=($.Function,$.Array),f=$.String,h=$.Date,g=s.Z,v=$.createClass((0,l.$N)("module.mbox.Tips"));m.extend(v.prototype,{view:null,block:null,getConfig:functioule.extend("brand")||(t=e.selectFolder(t),t=e.defer(t),t=e.popDeleteInfo(t),t=e.antiSpamNotification(t),t=e.receiveReject(t),t=e.popDeleteFolder(t),t=e.advLock(t),t=e.secondAuth(t),t=e.spamFolder(t),t=e.deleteFolder(t),t=e.systemDelete(t),t=e.forward(t),t=e.antiSpam(t),t=e.popInfo(t),t=e.recovery(t),t=e.mailCapacityStorage(t),t=e.mailCapacity(t)),(t=e.hide(t)).subclass="tipsBlock",t.closeclick||(t.closeclick=null),t},selectFolder:function(e){if(e)return e;try{var t=this.view,a=t.module;if(a.isSelectFolder()&&t.allSelected){var n,r,s=!!t.folderSelected,c=a.param("fid"),l=o.Z.get(c),d=o.Z.getInfo(c),m={name:l.name,id:l.id};if(s){n=new $.Link({text:u.t("æ¸…é™¤é€‰ä¸­"),cls:"nui-txt-link",click:function(){$.Thread.run((function(){t.setFolderSelect(!1)}),0),$.Log.cache({b_mboxview_tips_clear_allselect_click:m})}});var p=new $.Link({title:u.t("é‚®ä»¶æ¸…ç†åŠ©æ‰‹"),text:u.t("é‚®ä»¶æ¸…ç†åŠ©æ‰‹"),extcls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"LinkModule",link:"optimizer_clean",exit:!0})}))),$.Log.cache({b_mboxview_tips_cleanup_click:m})}});r=u.t("å·²é€‰ä¸­ ")+l.name+" "+d+u.t(" å°é‚®ä»¶ ")+n.html()+u.t("ï¼Œ")+u.t("æ‚¨ä¹Ÿå¯ä»¥å‰å¾€ ")+p.html()+u.t(" å¯¹å·²åˆ é™¤çš„é‚®ä»¶è¿›è¡Œæ‰¹é‡æ¸…ç†")}else n=new $.Link({text:u.t("é€‰æ‹©æ‰€æœ‰"),cls:"nui-txt-link",click:function(){$.Thread.run((function(){t.setFolderSelect(!0)}),0),$.Log.cache({b_mboxview_tips_selectall_click:m})}}),r=u.t("å·²é€‰ä¸­å½“å‰é¡µæ‰€æœ‰é‚®ä»¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥ ")+n.html()+" "+l.name+" "+d+u.t(" å°é‚®ä»¶");e={content:r}}}catch(e){}return e},defer:function(e){if(e)return e;try{var t=this.view.module,i=t.param("fid"),a=r.Z.getInfo("expire");if(g.check()&&r.Z.showTop(i,!0)&&a>0){var n=new $.Link({text:u.t("ç«‹å³æŸ¥çœ‹å¹¶å¤„ç†"),cls:"nui-txt-link",click:function(){t.log("tips","defer"),d.default.defer()}});e={content:'<span class="nui-txt-alert uT0"><b class="nui-ico nui-ico-todo nui-ico-todo-selected"></b>'+u.t(" æ‚¨æœ‰ ")+"<strong>"+a+"</strong>"+u.t(" å°å¾…åŠé‚®ä»¶å°šæœªå¤„ç†ï¼Œ")+"</span>"+n.html()}}}catch(e){console.warn(e)}return e},popDeleteInfo:function(e){var t=this,i=t.view.module.param("fid");if(e||1!==i)return e;try{var a=o.Z.get(15);if(!a)return e;var n="popDeleteInfo";if((0,l.$S)(n))try{var r=(0,l.$S)(n).data,s=r.lastDelTime;if(s>r.lastCloseTipsTime){var c,m=new window.Date(s);c=new $.Link({text:a.name,cls:"nui-txt-link",click:function(){d.default.entry({fid:15},{type:"list",subtype:"folder"})}}),e={content:u.t("éƒ¨åˆ†é‚®ä»¶åœ¨ ")+$.Date.format(m,"yyyy-MM-dd HH:mm")+u.t(" è¢«å®¢æˆ·ç«¯æ”¶å–å¹¶åˆ é™¤ï¼Œè¢«åˆ é‚®ä»¶å·²å¤‡ä»½åˆ° ")+c.html()+u.t(" æ–‡ä»¶å¤¹"),closeclick:function(){$.Ajax.jsonp($.Uri.getUrl("popDelSet"),(function(e){(0,l.$S)(n,e)})),r.lastCloseTipsTime=(new window.Date).getTime(),t.update()}}}}catch(e){}else(0,l.$S)(n,!0),$.Ajax.jsonp($.Uri.getUrl("popDelQuery"),(function(e){(0,l.$S)(n,e),t.update()}))}catch(e){}return e},antiSpamNotification:function(e){var t=this,a=t.view.module,n=a.param("fid");if(e||1!==n||(0,l.$S)("closeAntiSpamNotification")||"en"===$G.environment.lang)return e;try{var o=function(e,t){return e+(t?g:v)>=b},r="product.mail.antiSpam.notify.switch",s="antiSpam.notify",c="product.vipMember",d="antiSpam_user_login_info",m="antiSpam_user_tip_open",p=(0,l.$S)("mbox_tip_"+r),f=(0,l.$S)("mbox_tip_"+s),h=JSON.parse(window.localStorage.getItem(d)||"{}")||{sid:"",timestamp:0,noticeTimeStamp:0},g=2592e6,v=6048e5,b=window.Date.now(),y=(0,l.$S)("mbox_tip_"+m);if(!p||p<0){if(void 0===p){var x="webmail.receiveNotify.refuse",k=["webmail.receiveNotify.trash","webmail.receiveNotify.ad","webmail.receiveNotify.subscribe",x],S={"webmail.receiveNotify.trash":5,"webmail.receiveNotify.ad":7,"webmail.receiveNotify.subscribe":18};$.Ud.getProxy({field:[c,r].concat(k),call:function(e){for(var i=e[r],n=[],d=e[c],u=(0,l.$S)("isVip")||d,m=0,p=k.length;m<p;m++){var f=k[m];e[f]&&o(e[f],u)&&(n.push({key:f,folderId:S[f],timeStamp:e[f]}),n.sort((function(e,t){return t.timeStamp-e.timeStamp})))}if(i>0&&n.length)if(n[0].key===x)(0,l.$S)("mbox_tip_"+s,n[0].timeStamp),(0,l.$S)("mbox_tip_"+r,i),(0,l.$S)("mbox_tip_"+c,d),t.update();else{for(var h=[],y=$.Folder.system||[],w={},T=0,C=y.length;T<C;T++){var _=y[T];_.stats&&_.stats.unreadMessageCount&&(w[_.id]=!0)}for(var I=0,A=n.length;I<A;I++){var M=n[I];w[M.folderId]&&h.push(M.folderId)}if(h.length){var L=$.Date,E=L.format(new window.Date(b-(u?g:v)),"yyyyMMdd")+":"+L.format(new window.Date(b),"yyyyMMdd");a.action.getFolderStats({ids:h,filter:{defer:E},callback:function(a){var n=0;for(var o in a)if(a[o].unreadMessageCount>0){for(var u in S)S[u]===Number(o)&&(n=e[u]);break}(0,l.$S)("mbox_tip_"+s,n||0),(0,l.$S)("mbox_tip_"+r,i),(0,l.$S)("mbox_tip_"+c,d),n&&t.update()}})}else(0,l.$S)("mbox_tip_"+s,0),(0,l.$S)("mbox_tip_"+r,i),(0,l.$S)("mbox_tip_"+c,d)}}})}return e}if(f&&!y){var w=(0,l.$S)("sid"),T=h.sid===w,C=h.timestamp||0,_=h.noticeTimeStamp||0,I=(0,l.$S)("isVip")||(0,l.$S)("mbox_tip_"+c),A=I?C-g:C-v,M=(I?b-g:b-v)<f;if(window.localStorage.setItem(d,JSON.stringify({sid:w,timestamp:b,noticeTimeStamp:f})),!M)return e;h.sid?T?A>=_&&f>C&&(y=!0,(0,l.$S)("mbox_tip_"+m,!0),a.log("tips","anti_spam_notication_show")):f>C&&(y=!0,(0,l.$S)("mbox_tip_"+m,!0),a.log("tips","anti_spam_notication_show")):(y=!0,(0,l.$S)("mbox_tip_"+m,!0),a.log("tips","anti_spam_notication_show"))}if(y){var L,E,D=function(){$.Thread.delay((function(){t.update()}),10),(0,l.$S)("closeAntiSpamNotification",!0),(0,l.$S)("mbox_tip_"+m,!1),a.log("tips","anti_spam_notication_close")};L=new $.Link({text:u.t("ç«‹å³æŸ¥è¯¢"),cls:"nui-txt-link mj2",click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"selfQueryReceive",group:"self-query",title:u.t("è‡ªåŠ©æŸ¥è¯¢")}),a.log("tips","anti_spam_notication_selfquery_click"),D()})))}}),E=new $.Link({text:u.t("ä¸æƒ³çœ‹åˆ°æ­¤æé†’ï¼Ÿ"),cls:"nui-txt-tips",click:function(){(0,l.$E)("interface.OptionInterface",(function(e){e.entry({module:"AntiSpamModule"})})),a.log("tips","anti_spam_notication_ignore_click"),D()}}),e={content:u.t("è¿‘æœŸæ‚¨æœ‰é‚®ä»¶æœªèƒ½è¿›å…¥æ”¶ä»¶ç®±ï¼Œä¸ºé¿å…æ‚¨é”™è¿‡é‡è¦é‚®ä»¶ï¼Œå¯è¿›å…¥è‡ªåŠ©æŸ¥è¯¢æŸ¥çœ‹æœ€è¿‘æ”¶ä¿¡è®°å½•ã€‚")+L.html()+E.html(),closeclick:D}}}catch(e){}return e},receiveReject:function(e){var t=this,a=t.view.module,n=a.param("fid");if(e||1!==n||(0,l.$S)("closeReceiveReject")||"en"===$G.environment.lang)return e;try{if((0,l.$S)("receiveRejectTrigger")){var o,r=function(){(0,l.$S)("closeReceiveReject",!0),a.log("tips","receive_reject_close"),$.Thread.delay((function(){t.update()}),10)};(0,l.$S)("receiveRejectTrigger",!1),o=new $.Link({text:u.t("ç«‹å³æŸ¥è¯¢"),cls:"nui-txt-link mj2",click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"selfQueryReceive",group:"self-query",title:u.t("è‡ªåŠ©æŸ¥è¯¢")}),a.log("tips","receive_reject_click"),r()})))}}),e={content:u.t("æ”¶ä¸åˆ°é‚®ä»¶ï¼Ÿè¯•è¯•æŸ¥è¯¢ä½ çš„æ”¶ä¿¡è®°å½•ã€‚")+o.html(),closeclick:r},a.log("tips","receive_reject_show")}}catch(e){}return e},popDeleteFolder:function(e){var t=this;if(e)return e;try{var a=t.view.module,n=a.param("fid");if(15===n){var r,s,c,l=o.Z.get(n),d={cls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"options.AntiSpamModule",inputName:"keepPeriod4"})}))),a.cleanCache()}},m=l.keepPeriod;m>0?(d.text=u.t("ä¿®æ”¹"),s=new $.Link(d),c=u.t("è‡ªåŠ¨åˆ é™¤")+m+u.t("å¤©")+"("+s.html()+")"+u.t("ä»¥ä¸Šé‚®ä»¶")):(d.text=u.t("ç‚¹å‡»è®¾ç½®è‡ªåŠ¨æ¸…ç†"),c=(s=new $.Link(d)).html()),r=new $.Link({text:u.t("ç¦æ­¢å®¢æˆ·ç«¯æ”¶ä¿¡"),cls:"nui-txt-link",click:function(){$.Nav.entry("OptionInterface",{module:"options.OptionOutLinkModule",linkName:"smtp"})}}),t.updateRecovery({key:"mboxPopDeleteRecoverShow"}),e={content:'<span class="nD1">'+u.t("è¢«å®¢æˆ·ç«¯æ”¶å–å¹¶åˆ é™¤çš„é‚®ä»¶å¤‡ä»½åœ¨æ­¤ï¼Œ")+c+u.t("ï¼Œ")+r.html()+"</span>"+(t.recoveryTips||"")}}}catch(e){}return e},advLock:function(e){if(e)return e;try{var t=this.view,i=t.module,a=i.param("fid"),s=i.param("fids"),c=(0,l.$S)("advLock"),d=!c.disabled&&!c.authenticated2&&(c.pop||c.folders),m=!1;if(!a&&s&&1===s.length&&(a=s[0]),a>0)m=c[a];else try{var p;try{p=!1===i.param("filter").flags.read}catch(e){}var f=p?"unread":"",h=i.getTotal(),g=i.extenelse if("tag"===g){var v=i.param("tag");m=n.Z.getInfo(v[0],f)>h}else if("contacts"===g){var b=i.param("filter").chatWithAddress;m=(0,l.$I)("init.Contacts").getInfo(b,f)>h}else for(var y=0,x=(h=0,0),k=s.length;x<k;x++){var S=s[x];if(c[S])if(p){if((y+=o.Z.getInfo(S,"unread"))>0){m=!0;break}}else if((h+=o.Z.getInfo(S))>0){m=!0;break}}}catch(e){l.$D.lé”å¯†ç "),cls:"nui-txt-link",click:function(){$.AdvLock.show((function(){t.refresh()}))}}).html()+u.t(" æŸ¥çœ‹å…¨éƒ¨é‚®ä»¶")})}catch(e){}return e},spamFolder:function(e){if(e)return e;try{var t=this.view.module,i=(t.param("fid"),t.extend("type"),t.extend("subtype")),a=t.extend("read"),n=t.param("fids");if("read"===i&&!1===a&&n.length>1){for(var r=$G.common.nolistids,s=!1,c=r.length-1;c>-1;c--)if(p.has(n,r[c])){s=!0;break}var l=0,f=[];for(c=r.length-1;c>-1;c--){var h=r[c],g=o.Z.getInfo(h,"unread");l+=g,g>0&&f.push(o.Z.get(h).name)}var v,b=f.join(u.t("ï¼Œ"));s?e={content:(v=new $.Link({text:u.t("ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹"),cls:"nui-txt-link",click:function(){var e={exceptFids:$G.common.unnormalids.concat(1),filter:{flags:{read:!1}}},i=m.clone(t.getVar("extend"));i.index=0,d.default.entry(e,i)}})).html()+u.t("æ™®é€šæ–‡ä»¶å¤¹æœªè¯»é‚®ä»¶")}:l>0&&(v=new $.Link({text:u.t("ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹"),cls:"nui-txt-link",click:function(){var e={fids:r,filter:{flags:{read:!1}}},i=m.clone(t.getVar("extend"));i.index=0,d.default.entry(e,i)}}),e={content:u.t("ä¸åŒ…å« ")+b+u.t(" çš„æœªè¯»é‚®ä»¶ï¼Œ")+v.html()})}}catch(e){}return e},deleteFolder:function(e){if(e)return e;try{var t,i,a=t!p.has(n,4)?o.Z.getInfo(4)>0&&(t=new $.Link({text:u.t("ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹"),cls:"nui-txt-link",click:function(){var e=m.clone(a.getVar("param"));e.fids=[4];var t=m.clone(a.getVar("exentry(e,t)}}),i=u.t("ä¸åŒ…å« å·²åˆ é™¤ æ–‡ä»¶å¤¹çš„é‚®ä»¶ï¼Œ ")+t.html()):1===n.length&&4===n[0]&&(i=(t=new $.Link({text:u.t("ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹"),cls:"nui-txt-link",click:function(){var e=m));delete e.fids,delete t.index,d.default.entry(e,t)}})).html()+u.t(" æ™®é€šæ–‡ä»¶å¤¹é‚®ä»¶")),i&&(e={content:i})}catch(e){}return e},systemDelete:function(e){var t=this;if(e)return e;try{var a=t.view.module,n=a.param("fid"),r=o.Z.get(n);if(r.keepPeriod){var s="";4!==n&&(s="("+new $.Link({text:u.t("ä¿®æ”¹"),cls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"options.AntiSpamModule",inputName:"keepPeriod2"})}))),a.cleanCache()}}).html()+")"),t.updateRecovery({key:"mboxSystemDeleteRecoverShow",value:n}),e={content:'<span class="nD1">'+u.t("â€œ")+r.name+u.t("â€ è‡ªåŠ¨åˆ é™¤ ")+r.keepPeriod+u.t(" å¤©")+s+u.t("ä»¥ä¸Šçš„é‚®ä»¶ (")+u.t("ç½‘æ˜“")+u.t("ååƒåœ¾ç³»ç»Ÿå·²å¸®æ‚¨æ‹¦æˆª99.8%çš„åƒåœ¾é‚®ä»¶)")+"</span>"+(t.recoveryTips||"")}}}catch(e){}return e},forward:function(e){var t=this;if(e)return e;try{if("folder"===t.view.module.extend("subtype")&&!(0,l.$S)("closeForwardTips")){t.view.module;var n=a.default.getForwardAddr();if(n){var o=new $.Link({text:u.t("è‡ªåŠ¨è½¬å‘è®¾ç½®"),cls:"nui-txt-link",click:function(){r(),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"BaseSetModule",inputName:"autoForward"})})))}});e={content:u.t("ç›®å‰æ‚¨çš„é‚®ä»¶å·²è®¾ç½®è‡ªåŠ¨è½¬åclick:r}}}}catch(e){}return e;function r(){(0,l.$S)("closeForwardTips",!0),$.Thread.delay((function(){t.update()}),10)}},antiSpam:function(e){var t=this;if(e)return e;try{if("folder"===t.view.module.extend("subtype")&&!(0,l.$S)("closeAntiSpamTips")){var n=t.view.module.param("fid"),r=o.Z.getInfo(n,"unread"),s=a.default.isLowAntiSpamLevel();if(t.showAntiSpamTips||t.updateAntiSpam(),n<20&&r>0&&s&&t.showAntiSpamTips){var c=new $.Link({text:u.t("é‡æ–°è®¾ç½®"),cls:"nui-txt-link",click:function(){d(),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"AntiSpamModule"})})))}});e={content:u.t("åƒåœ¾é‚®ä»¶è¿‡å¤šï¼Ÿå¯èƒ½æ˜¯ç”±äºååƒåœ¾çº§åˆ«è®¾ç½®è¿‡ä½æˆ–å…³é—­äº†é‚®ä»¶æ™ºèƒ½åˆ†ç±»ï¼Œå»ºè®®æ‚¨ æ£€æŸ¥ æˆ– ")+c.html(),closeclick:d}}}}catch(e){}return e;function d(){(0,l.$S)("closeAntiSpamTips",!0),$.Thread.delay((function(){t.update()}),10)}},popInfo:function(e){var t=this;if(e)return e;try{if("folder"===t.view.module.extend("subtype")&&!(0,l.$S)("closePopInfoTips")){var i=t.view.module.param("fid"),a=o.Z.getPopInfo(i);if(a.isPop&&a.stats){f.encodeHTML(new $.Email(a.username,a.name).toString());var n=a.stats.endTime||(0,l.$I)("util.Misc").getTime(0),r=h.format(n,"yyyy-M-d HH:mm"),s=a.stats,c=new $.Link({link:"pop3_skip_info",text:u.t("æŸ¥çœ‹è¯¦æƒ…"),cls:"nui-txt-link",target:"_blank"});e={content:[a.username,"&nbsp;"+u.t("äº")+"&nbsp;",r,"&nbsreceivedMessageCount:0,"</strong>"+u.t(" å°æ–°é‚®ä»¶"),s.skippedMessageCount?u.t("ï¼Œè·³è¿‡äº† ")+"<strong>"+s.skippedMessageCount+"</strong>"+u.t(" å°é‚®ä»¶")+"("+c.html()+")":"",s.spamMessageCount?u.t("ï¼Œå…¶ä¸­  ")+"<strong>"+s.spamMessageCount+"</strong>"+u.t(" å°è¢«ç§»åˆ°åƒåœ¾é‚®ä»¶ç®±"):"",s.errorMessageCount?u.t("ï¼Œæ”¶å–  ")+"<strong>"+s.errorMessageCount+"</strong>"+u.t(" å°å‡ºé”™"):"",s.rejectedMessageCount?u.t("ï¼Œ  ")+"<strong>"+s.rejectedMessageCount+"</strong>"+u.t(" å°è¢«æ‹’æ”¶"):"",s.excessMessageCount?u.t("ï¼Œ  ")+"<strong>"+s.excessMessageCount+"</strong>"+u.t(" å°è¶…è¿‡å•å°é‚®ä»¶å®¹é‡"):""].join(""),closeclick:function(){(0,l.$S)("closePopInfoTips",!0),$.Thread.delay((function(){t.update()}),10)}}}}}catch(e){}return e},recovery:function(e){var t=this;if(e)return e;try{var i=t.view.module.extend("subtype");if((0,l.$S)("isVip")&&"folder"===i&&!(0,l.$S)("closeRecoveryTips")&&!((0,l.$S)("cos").pref_mail_preserving_days>0)){var a=new $.Link({text:u.t("ç«‹å³å¼€å¯")+"&gt;&gt;",cls:"nui-txt-link",click:function(){o(),(0,l.$E)("interface.OutlinkInterface",(function(e){e.goOutlink({fullScreen:!0,key:"recovery",title:u.t("è¯¯åˆ æ¢å¤")})}))}}),n=new $.Icon({extcls:"nui-ico-tequan"});e={content:u.t("å¼€å¯è¯¯åˆ æ¢å¤ï¼Œé˜²æ­¢é‚®ä»¶ä¸¢å¤±ï¼")+n.html()+" "+a.html(),closeclick:o}}}catch(e){}return e;function o(){(0,l.$S)("closeRecoveryTips",!0),$.Thread.delay((function(){t.update()}),10)}},secondAuth:function(e){if(e)return e;try{var t=this.view.module,a=$.Misc.getTime();if(1==t.param("fid")&&a<=new window.Date(2018,11,6)&&null!==(0,l.$S)("sslSecondauth")&&!1===(0,l.$S)("sslSecondauth")){var n=new $.Link({text:u.t("é©¬ä¸Šå¼€å¯"),click:function(){t.log("mboxSecondAuth",1),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"MailSecurityModule",linkName:"secondauth"})})))}});e={content:'<i class="nui-ico nui-ico-remind"></i>'+u.t(" é‚®ä»¶éšç§æ³„éœ²åæ‚”è«åŠï¼Ÿæ‚¨è¿˜æœªå¼€å¯ç™»å½•äºŒæ¬¡éªŒè¯ï¼Œé‚®ç®±å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œèµ¶å¿«è¡ŒåŠ¨ï¼")+n.html(),extcls:"nui-textBlock nui-textBlock-err",hasClose:!0}}}catch(e){}return e},hide:function(e){var t=this.view.module;return!e||t.isNone()?e={hidden:!0}:e.hidden=!1,e.params||(e.params=[]),e},recoveryTips:null,buyRecovery:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showDialog("deleteRecovery","","mbox_recovery_tips")})))},updateRecovery:function(e){var t=this,a=t.view.module,n=$.Function.bind(t.update,t);i.e(603).then(i.bind(i,94253)).then($.Function.bind((function(i){var o=i.default;t.recoveryTips||o.validStatus((function(i){!function(e){function i(){(0,l.$E)("interface.OutlinkInterface",(function(e){e.goOutlink({fullScreen:!0,key:"recovery",title:u.t("è¯¯åˆ æ¢å¤")})}))}var n=(0,l.$S)("isFree"),o=0===e;if(2===e){var r=new $.Link({text:u.t("é‚®ä»¶è¯¯åˆ ä¿éšœä¸­"),cls:"nui-txt-link si2",click:function(){a.log("tips","recovery_did_valid"),i()}});t.recoveryTips=r.html()}else if(n&&o){var s=new $.Link({text:u.t("å¼€é€šé‚®ç®±ä¼šå‘˜ï¼Œäº«è¯¯åˆ æ¢å¤æœåŠ¡â€”â€”å¯æ¢å¤10å¤©å†…å½»åº•åˆ é™¤çš„é‚®ä»¶"),cls:"nui-txt-link si2",click:function(){a.log("tips","open_recovery_tips"),t.buyRecovery()}}),c=new $.Button({text:u.t("ç«‹å³å¼€é€š"),extcls:"tX2",click:function(){a.log("tips","open_recovery"),t.buyRecovery()}});t.recoveryTips=s.html()+c.html()}else{var d=new $.Link({text:u.t("è¯¯åˆ æ¢å¤æœªå¼€å¯"),cls:"nui-txt-link si2",click:function(){a.log("tips","not_open_recovery"),i()}});t.recoveryTips=d.html()}}(i),setTimeout((function(){if(n(),t.recoveryTips=null,a.data&&a.data.length){var i={};i[e.key]=e.value||"",$.Log.cache(i)}}),0)}))})))},showAntiSpamTips:!1,updateAntiSpam:function(){var e=this,t=$.Function.bind(e.update,e);$.Ud.getProxy({field:["product.mail.antiSpamLevelOrSmartSort"],call:function(i){i&&1==i["product.mail.antiSpamLevelOrSmartSort"]&&(e.showAntiSpamTips=!0,setTimeout((function(){t()}),0))}})},mailCapacity:function(e){var t,a=$G.user.uid,n=this,o=n.view.module.param("fid"),r={mailFull:{showKey:"mbox_capacity_free_mail_exceeds_shownbox_mailreturn_mails",upgradeKey:"web_inbox_mailreturn_upgrade"},storageFull:{showKey:"mbox_capacity_free_storage_exceeds_show",okKey:"mbox_capacity_free_storage_exceeds_ok_click",utmSource:"web_inbox_mailreturn_storage"}};if(e||1!==o)return e;var s="mboxCapacityTips";if(($.LocalStorage.get(s)||"")===a)return e;var d="capacity.notify",m="capacity.notify.latestTime",p=(0,l.$S)("mbox_tip_"+d);if(!p)return c.Z.getMailCapacityStatus((function(e){(0,l.$S)("mbox_tip_"+d,e),setTimeout((function(){n.update()}),10)}),!0),e;if(!p.isFull)return e;t=p.letterFull?"mailFull":"storageFull";var f,h,g,v=u.t("ç«‹å³å–å›"),b=r[t].utmSource;p.isMember&&(v=u.t("å‡çº§ä¼šå‘˜"),b="web_inbox_mailreturn_upgrade"),f=new $.Link({text:v,cls:"nui-txt-link tY1",click:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){var t=e.default,i=b;if(p.isMember&&p.canUpgrade)t.upgrade({utm_source:b,onSuccess:function(){window.sessionStorage.setItem("watch_fetch_excessMail","1")}});else{var a={success:function(){window.sessionStorage.setItem("watch_fetch_excessMail","1")}};[5,6].indexOf(p.userType)>=0&&!p.letterFull&&(a.beSource="mp_overage",i+="_mp_overage"),t.showDialog("excessmail","",i,a)}})));var e=r[t].okKey;p.isMember&&(e=e.replace("free","member"),e=p.is50G?e.replace("capacity_","capacity_50_"):e.replace("capacity_","capacity_200_"),p.letterFull&&(e=e.replace(/_\d+/,"")));var a={};a[e]=1,$.Log.cache(a)}}),h=new $.Link({text:u.t("æ¸…ç†é‚®ç®±"),cls:"yl1",click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"LinkModule",link:"optimizer_clean",exit:!0})})));var e="mobx_tips_capacity_50_clear_click",t={};p.is50G||(e),t[e]=1,$.Log.cache(t)}});var y="",x=u.t("é‚®ç®±å®¹é‡å·²æ»¡å¯¼è‡´æ— æ³•è¿›ä¿¡");if(p.letterFull&&(x=u.t("é‚®ä»¶å°æ•°å·²æ»¡å¯¼è‡´æ— æ³•è¿›ä¿¡")),p.exceedTotal&&(y=u.t("ï¼ˆå…±è®¡${n}å°ï¼Œ${m}MBï¼‰").replace("${n}",p.exceedTotal).replace("${m}",p.exceedSize||0)),p.isMember){var k=u.t("ï¼Œå»ºè®®æ‚¨å‡çº§ä¼šå‘˜æˆ–");p.canUpgrade?(p.letterFull&&(k=u.t("ï¼Œå»ºè®®æ‚¨")),g='<i class="gWel-warning-error-ico"></i>'+x+u.t("ï¼Œå·²ä¸ºæ‚¨é¢å¤–æš‚å­˜è¿‘${n}å¤©çš„é‚®ä»¶").replace("${n}",30)+y+k+h.html()+u.t("åç«‹å³å–å›é‚®ä»¶ã€‚")+(p.letterFull?"":f.html())):(k=u.t("ï¼Œå»ºè®®æ‚¨"),g='<i class="gWel-warning-error-ico"></i>'+x+u.t("ï¼Œå·²ä¸ºæ‚¨é¢å¤–æš‚å­˜è¿‘${n}å¤©çš„é‚®ä»¶").replace("${n}",30)+y+k+h.html()+u.t("åç«‹å³å–å›é‚®ä»¶ã€‚"))}else g='<i class="gWel-warning-error-ico"></i>'+x+u.t("ï¼Œå·²ä¸ºæ‚¨é¢å¤–æš‚å­˜è¿‘${n}å¤©çš„é‚®ä»¶").replace("${n}",7)+y+u.t("ï¼Œå¼€é€šä¼šå‘˜åå¯ç«‹å³å–å›ã€‚")+f.html();e={params:["capacity"],content:g,closeclick:function(){$.Thread.delay((function(){n.update()}),10),$.LocalStorage.set(s,a,{expires:7})}};var S=r[t].showKey;p.isMember&&(S=S.replace("free","member"),p.letterFull||(S=p.is50G?S.replace("capacity_","capacity_50_"):S.replace("capacity_","capacity_200_")),p.letterFull&&(S=S.replace(/_\d+/,"")));var w=(0,l.$S)("mbox_tip_"+m)||0;if($.Misc.getTime().getTime()-w>2e3){var T={};T[S]=1,$.Log.cache(T),(0,l.$S)("mbox_tip_"+m,$.Misc.getTime().getTime())}return e},mailCapacityStorage:function(e){var t,i=$G.user.uid,a=this,n=!1===a.view.module.extend("read"),o="product.vipMember",r="mbox_tip_mailStorage_"+o,s=(0,l.$S)(r),c="mboxCapacityStorageTips";if(t=$.LocalStorage.get(c)||"",e||t===i||!n)return e;if(s||$.Ud.getProxy({field:[o],call:function(e){var t=e[o];(0,l.$S)(r,t),setTimeout((function(){a.update()}),10)}}),s){var d=function(){$.LocalStorage.set(c,i,{expires:7}),$.Thread.delay((function(){a.update()}),10)},m=new $.Link({text:u.t("æˆ‘çŸ¥é“äº†"),cls:"zJ0",click:function(){d()}});e={params:["capacityStorage"],content:new $.Icon({extcls:"nui-ico-suc-xs"}).html()+u.t("ä¼šå‘˜å°Šäº«é‚®ä»¶æš‚å­˜åŠŸèƒ½ï¼Œæ”¯æŒå–å›é‚®ç®±å·²æ»¡å30å¤©å†…æ”¶åˆ°çš„é‚®ä»¶ã€‚")+m.html(),closeclick:d},$.Log.cache({mbox_unread_capacity_tips:1})}return e},get:function(){var e=this.getConfig();return(this.block=new $.Block(e)).html()},update:function(){var e=this.block,t=this.getConfig();e&&e.update(t),$.Component.setEvents()},destroy:function(){try{this.block.destroy(),this.block=null}catch(e){}},initialize:function(e){var t=this;t.view=e,$.Listener.listen("options:antiSpamReminderModify",(function(e){(0,l.$S)("mbox_tip_antiSpam_user_tip_open")!==e&&((0,l.$S)("mbox_tip_antiSpam_user_tip_open",""),t.update())})),$.Listener.one("mbox:removeAntiSpamTip",(function(){$.Ud.setProxy({field:["webmail.receiveNotify.trash"],value:0}),$.Ud.setProxy({field:["webmail.receiveNotify.ad"],value:0}),$.Ud.setProxy({field:["webmail.receiveNotify.subscribe"],value:0}),$.Ud.setProxy({field:["webmail.receiveNotify.refuse"],value:0}),(0,l.$S)("mbox_tip_antiSpam_user_tip_open",""),t.update()}))}}),t.Z=v},50348:function(e,t,i){i(8600),i(15296),i(92274),i(66403),i(803),i(68233),i(48868),i(63045),i(81874),i(54861),i(42295),i(34994),i(37092);var a=i(1124),n=i(72957),o=i(20313),r=i(92066),s=i(36829),c=new n.c1("module.mbox.Title"),l=$.Object,d=$.Function,u=$.Array,m=$.String,p=$.createClass((0,n.$N)("module.mbox.Title"));l.extend(p.prototype,{view:null,title:null,getConfig:function(){var e=this,t=e.view.module,i={},a=t.extend("type"),n=t.extend("subtype");return"list"===a?"tag"===n?e.getTag(i):"defer"===n?e.getDefer(i):"flag"===n?e.getFlag(i):"read"===n?e.getRead(i):"calendar"===n?e.getCalendar(i):"folder"===n?e.getFolder(i):"contacts"===n?(e.getContacts(i),t.log("title","contacts_mail","show")):"emails"===n?e.getEmails(i):e.getFilter(i):("normal"===n?e.getNormal(i):e.getFull(i),t.log("title","search_mail","show")),i},getTag:function(e){var t=this,i=t.view.module,n=i.param("tag"),s=o.Z.getName(n[0]),u=i.getTotal(),m=i.param("filter"),p=(m&&m.flags,!1===i.extend("read")),f=i.extend("brand"),h=l.clone(i.param()),g=l.clone(i.extend());if(p){delete h.filter.flags.read;var v=d.bind(a.default.entry,a.default,h,g);e.path={items:[{xtype:"link",text:s,extcls:"nui-txt-link",click:v}]},e.text=c.t("æœªè¯»"),e.tips=t.getAllRead(!0)}else{var b=i.getCount("unread"),y=i.extend("limit");if(b>0&&u>y){var x=new $.Link({title:c.t("ç‚¹å‡»æŸ¥çœ‹æœªè¯»é‚®ä»¶"),text:c.t("æœ‰")+" <strong>"+b+"</strong>"+c.t(" å°æœªè¯»"),extcls:"nui-txt-link",click:function(){var e;i.log("title","unread");try{e=h.filter.flags}catch(e){}e||(h.filter||(h.filter={}),e=h.filter.flags={}),e.read=!1,a.default.entry(h,g)}}).html();e.tips=" "+x+t.getAllRead()}}if(f){var k=r.Z.get(18);e.path={items:[{xtype:"link",extcls:"nui-txt-link",text:k.name,click:d.bind(a.default.entry,a.default,{fid:k.id},{type:"list",subtype:"folder"})}]},e.text=s}},getDefer:function(e){},getFlag:function(e){var t=this.view.module,i=t.getCondition();e.text=i;var n=d.bind(a.default.entry,a.default,{exceptFids:$G.common.unnormalids,conditions:[{field:"label0",operator:">",operand:0}]},{type:"search",subtype:"normal"});e.path={items:[{xtype:"link",text:c.t("æ——å¸œé‚®ä»¶"),extcls:"nui-txt-link",click:n}]};for(var o=e.extItems=[],r=$.LETTERFLAG,s=[],l=1,u=r.length;l<u;l++)r[l]&&(s[s.length]={text:r[l],icon:"flag-"+l,extcls:"nui-txt-flag"+l,click:function(e){return function(){t.log("title","otherflag"),a.default.entry({filter:{label0:e}},{type:"list",subtype:"flag"})}}(l)});o[o.length]={xtype:"link",extcls:"nui-txt-link",text:'<b class="nui-ico nui-ico-flag nui-ico-flag-0"></b>'+c.t("å…¶ä»–æ——å¸œ&nbsp;")+'<b class="nui-ico nui-ico-dArr">d</b>',listeners:{render:function(){new $.Menu({groups:[{items:s}],reverse:!0}).attachTo({clickFrom:this.getEl()})}}}},getRead:function(e){var t=this,i=t.view.module,n=!1===i.extend("read"),o=i.param("fids"),s=o.length,l=i.getTotal(),m=n?c.t("æœªè¯»"):c.t("å·²è¯»"),p=[];if(s>0)if(1===s){var f,h=o[0],g=(b=r.Z.get(h)).name;"unread"===i.param("from")?(f=c.t("æœªè¯»é‚®ä»¶"),S=function(){a.default.entry({filter:{flags:{read:!1}}})},m=g+"&nbsp;"+m):(f=g,S=d.bind(a.default.entry,a.default,{fid:h},{type:"list",subtype:"folder"})),e.path={items:[{xtype:"link",text:f,extcls:"nui-txt-link",click:S}]}}else if(u.has(o,1)){T=$G.common.nolistids.concat([2]);var v=r.Z.list();for(_=0,I=v.length;_<I;_++){var b,y=(b=v[_]).id;if(!u.has(T,y)){var x=r.Z.getInfo(y,"unread");if(x>0){var k=new $.Link({text:x+c.t("å°"),extcls:"nui-turn function(){a.default.entry({fids:[e],filter:{flags:{read:!1}},from:"unread"},{type:"list",subtype:"read"})}}(y)});p.push(b.name+"&nbsp;"+k.html())}}}}else{var S=d.bind(a.default.entry,a.default,{filter:{flags:{read:!1}}},{type:"list",subtype:"read"});e.path={items:[{xtype:"link",texids,C=!0,_=0,I=o.length;_<I;_++)if(!u.has(T,o[_])){C=!1;break}if(C){var A=[];for(_=0,I=T.length;_<I;_++){var M=r.Z.get(T[_]);M&&A.push(M.name)}w=A.join("ï¼Œ")}else w=c.t("å…¶ä»–");m=w+m}e.text=m;var L="";n&&l>0&&(L=t.getAllRead()),e.tips=L+(p.length>0?"("+p.join("ï¼Œ")+")":""),t.getContactRead(e)},getCalendar:function(e){var t=this.view.module,i=t.param("fids"),n=i.length,o=(t.getTotal(),t.getCondition());if(n>0&&1===n){var s=i[0],c=r.Z.get(s).name,l=d.bind(a.default.entry,a.default,{fid:s},{type:"list",subtype:"folder"});e.path={items:[{xtype:"link",text:c,extcls:"nui-txt-link",click:l}]}}e.text=o},getFolder:function(e){var t=this.view.module,n=t.param("fid"),o=t.extend("area"),s=(r.Z.get(n),r.Z.getPopInfo(n),t.getCount("unread"));if("archive"!==o&&s>0&&2!==n){var l=[],d=new $.Link({title:c.t("ç‚¹å‡»æŸ¥çœ‹æœªè¯»é‚®ä»¶"),text:c.t("æœ‰")+" <strong>"+s+"</strong>"+c.t(" å°æœªè¯»"),extcls:"nui-txt-link",click:function(){t.log("title","unread","folder"),a.default.entry({fids:[n],filter:{flags:{read:!1}}})}});l.push(d.html()),l.push(this.getAllRead(!0));var u=new $.Link({title:c.t("é‚®ç®±æ¸…ç†åŠ©æ‰‹"),text:c.t("é‚®ç®±æ¸…ç†åŠ©æ‰‹"),extcls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"LinkModule",link:"optimizer_clean",exit:!0})}))),$.Log.cache({b_mboxview_title_cleanup_click:1})}});try{var m=r.Z.getTotal()}catch(e){}m>=2e3&&!$.Support.isTeamMailFromSwitch()&&l.push(u.html()),e.tips=" "+l.join(" ")}},getContacts:function(e){var t,i,o,r,l,d,u=this,p=u.view.module,f=p.param("filter"),h=f.flags&&!1===f.flags.read;f&&(t=f.chatWithAddress,i=f.fromAddress,o=f.toAddress),d=!!o,l=!!i&&!d;var g,v,b=(r=!!t)?t:d?o:i,y=b.split(","),x=s.Z.getContact(b),k=x?x.data.name:void 0;if(!k)try{var S=(0,n.$I)("support.AddressSupport");try{var w=p.param("cid");if(w){var T=S.data.extDataMap.contact[w];k=S.getGivenName(T)}}catch(e){n.$D.log({text:c.t("é€šè¿‡cidåˆ†æè”ç³»äººå‡ºé”™"),error:e})}if(!k)if(1===y.length)try{k=S.getAddrObj(b,!0).FN}catch(e){k=$.Uri.getName(b)||b}else k=c.t("è”ç³»äºº")}catch(e){k=c.t("è”ç³»äºº")}var C=!1;try{C=0===(v=y[0]).indexOf("*@")}catch(e){}var _=x&&"group"===x.ctype;g=C?v.replace(/\*@/,""):new $.UserLabel({name:k,address:_?void 0:v,group:_?x:void 0,popupRenderTo:p.scroller}).html(),h||(g='<b class="nui-txt-mark">'+g+"</b>"),r?g=c.t("ä¸ ")+g+c.t(" çš„é‚®ä»¶å¾€æ¥"):d?g=c.t("å‘ç»™ ")+g+c.t(" çš„é‚®ä»¶"):l&&(g+=c.t(" å‘æ¥çš„é‚®ä»¶")),$G.environment.isCh||(g=g.replace("æˆ‘","Me "));var I=p.param("from");if(h){var A,M;"emails"===I?(M=c.t("è”ç³»äººé‚®ä»¶"),A=function(){a.default.emails()}):(M=g,g=c.t("æœªè¯»é‚®ä»¶"),A=function(){a.default.contacts(x?x.data:b)}),e.path={items:[{xtype:"link",text:M,extcls:"nui-txt-link",click:A}]},e.text=g,e.tips=u.getAllRead()}else{if(I&&"emails"!==I)try{var L=s.Z.getGroup(I);L&&(e.path={items:[{xtype:"link",text:m.encodeHTML(L.data.name),extcls:"nui-txt-link",click:function(){a.default.contacts(L.data)}}]})}catch(e){n.$D.log({text:c.t("è§£æåˆ†ç»„æ¥æºå‡ºé”™"),error:e})}e.extcls="qf1",e.text=g;var E=[],D=p.getTotal(),R=s.Z.getInfo(b,"unread");if(r&&R>0){var P=new $.Link({text:R+c.t(" å°æœªè¯»"),extcls:"nui-txt-link",click:function(){p.log("title","unread","contact"),a.default.contacts(x?x.data:b,{read:!1})}});E.push(P.html()),E.push(u.getAllRead(!0))}else E.push(c.t("å…± ")+D+c.t(" å°"));if(!p.extend("systemContacts")){if(!r){var F=new $.Link({text:c.t("æŸ¥çœ‹é‚®ä»¶å¾€æ¥"),extcls:"nui-txt-link",click:function(){p.log("title","contact","from"),a.default.contacts(x?x.data:b,{from:p.param("from")})}});E.push(F.html())}if(!d){var j=new $.Link({text:c.t("æŸ¥çœ‹æˆ‘å‘é€çš„"),extcls:"nui-txt-link",click:function(){p.log("title","contact","to"),a.default.contacts(x?x.data:b,{type:"to",from:p.param("from")})}});E.push(j.html())}if(!l){var N=new $.Link({text:c.t("æŸ¥çœ‹å‘ç»™æˆ‘çš„"),extcls:"nui-txt-link",click:function(){a.default.contacts(x?x.data:b,{type:"from",from:p.param("from")})}});E.push(N.html())}}E.length>0&&(e.tips=" ( "+E.join(" ")+" )")}x&&"group"===x.ctype&&u.getGroupContact(e,x)},getEmails:function(e){var t=this,i=t.view.module.param("filter"),a=i&&i.flags&&!1===i.flags.read;e.text=c.t("è”ç³»äºº")+(a?c.t("æœªè¯»),t.getContactRead(e)},getFilter:function(e){var t=this.view.module,i=t.param("fids");if(i&&1===i.length){var n=i[0],o=r.Z.get(n),s=d.bind(a.default.entry,a.default,{fid:n},{type:"list",subtype:"folder"});e.path={items:[{xtype:"link",text:o.name,extcls:"nui-txt-link",click:s}]}}var c=t.getCondition();c&&(e.text=c)},getNormal:function(e){var t=this.view,n=t.module,o=n.extend(),s=n.param(),l=n.getTotal(),u=n.getCondition();u&&(u=c.t("å·²æœç´¢åˆ° ")+l+c.t(" å°")+u+c.t("çš„é‚®ä»¶"));var m="",p="";if("full"!==o.subtype&&"true"===$G.user.searchid){var f=new $.Link({title:c.t("ä½¿ç”¨å…¨æ–‡æœç´¢"),text:c.t("å…¨æ–‡æœç´¢"),extcls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(e){e.default.find({keyword:s.conditions[0].operand,isFullSearch:!0,isForceFullSearch:!0})})))}});p=c.t("ï¼Œæœç´¢æ›´å¤šé‚®ä»¶ä½¿ç”¨")+f.html()+c.t("è¯•è¯•")}l>0&&(m="&nbsp;"+new $.Link({title:c.t("åˆ é™¤æ‰€æœ‰é‚®ä»¶"),text:c.t("åˆ é™¤æ‰€æœ‰é‚®ä»¶"),extcls:"nui-txt-link",click:d.bind(t.removeAll,t)}).html()),e.text=c.t("æœç´¢ç»“æœ"),e.tips=" "+u+p+m;var h=n.param("fids");if(h&&1===h.length){var g=r.Z.get(h[0]),v=d.bind(a.default.entry,a.default,{fid:h[0]},{type:"list",subtype:"folder"});e.path={items:[{xtype:"link",text:g.name,click:v}]}}},getFull:function(e){var t=this.view,i=t.module,a=i.getTotal(),n=i.getCondition();n&&(n=c.t("å·²æœç´¢åˆ° ")+a+c.t(" å°")+n+c.t("çš„é‚®ä»¶"));var o="";i.hasAdditional()&&(o="&nbsp;"+new $.Link({title:c.t("å–æ¶ˆæ‰€æœ‰é™„åŠ æ¡ä»¶"),text:c.t("å–æ¶ˆæ‰€æœ‰é™„åŠ æ¡ä»¶"),bracket:!0,extcls:"nui-txt-cLink",click:d.bind(t.additionalSearch,t)}).html());var r="";a>0&&(r="&nbsp;"+new $.Link({title:c.t("åˆ é™¤æ‰€æœ‰é‚®ä»¶"),text:c.t("åˆ é™¤æ‰€æœ‰é‚®ä»¶"),extcls:"nui-txt-cLink",click:d.bind(t.removeAll,t)}).html()),e.text=c.t("æœç´¢ç»“æœ"),e.tips=" "+n+o+r},getAllRead:function(e){var t=this.view,i=new $.Link({title:c.t("å…¨éƒ¨è®¾ç½®ä¸ºå·²è¯»é‚®ä»¶"),text:c.t("å…¨éƒ¨è®¾ä¸ºå·²è¯»"),extcls:"nui-txt-link",click:function(){t.module.log("title","setallread"),t.setAllRead()}}).html();return e||(i="&nbsp;"+i+"&nbsp;"),i},getContactRead:function(e){if(this.view.module,"l-r"!==this.view.getLayout()&&e){var t=0,i=s.Z.contacts;if(i){var n=[];n[n.length]={text:c.t("å…¨éƒ¨è”ç³»äºº"),click:d.bind(a.default.emails,a.default)};for(var o=0,r=i.length;o<r;o++){var l=i[o],u=s.Z.getInfo(l.data,"unread");t+=u,u>0&&(n[n.length]={text:m.encodeHTML(l.data.name),click:d.bind(a.default.entry,a.default,{filter:{chatWithAddress:l.str,flags:{read:!1}},from:"emails"},{type:"list",subtype:"contacts"})})}if(t>0){var p=e.extItems=[];p[p.length]={xtype:"link",extcls:"nui-txt-link",text:c.t("æŒ‰æ˜Ÿæ ‡è”ç³»äººç­›é€‰&nbsp;")+'<b class="nui-ico nui-ico-dArr">d</b>',listeners:{render:function(){new $.Menu({groups:[{items:n}],reverse:!0}).attachTo({clickFrom:this.getEl()})}}}}}}},getGroupContact:function(e,t){if(this.view.module,"l-r"!==this.view.getLayout()&&e){for(var i=t.data.contacts,n=[],o=t.data.cid,r=0,s=i.length;r<s;r++){var l=i[r];n[n.length]={text:m.encodeHTML(l.name),click:d.bind(a.default.entry,a.default,{filter:{chatWithAddress:l.emails.join().toLowerCase()},from:o,cid:l.cid},{type:"list",subtype:"contacts"})}}var u=e.extItems=[];u[u.length]={xtype:"link",extcls:"nui-txt-link",text:c.t("å…¨éƒ¨æˆå‘˜çš„é‚®ä»¶&nbsp;")+'<b class="nui-ico nui-ico-dArr">d</b>',listeners:{render:function(){new $.Menu({groups:[{items:n}],reverse:!0}).attachTo({clickFrom:this.getEl()})}}}}},get:function(){var e=this,t=e.view.module,i=e.getConfig(),a=e.title=new $.Title(i);return'<div class=i)>0?"":"display:none;")+'">'+a.html()+"</div>"},update:function(){var e=this,t=e.view.module,i=e.title,a=e.getConfig(),n=$(i.getEl().dom.parentNode);!t.isNone()&&l.count(a)>0?(i.update(a),n.show()):n.hide()},destory:function(){try{this.title.destroy(),this.title=null}catch(e){}},initialize:function(e){this.view=e}}),t.Z=p},2185:function(e,t,i){i(42295),i(26340),i(55737),i(66403),i(48868),i(92274),i(63045),i(81874),i(54861),i(8600),i(75654),i(66251),i(37885),i(15296),i(37092);var a=i(1124),n=i(74718),o=i(72957),r=i(20313),s=i(92066),c=new o.c1("module.mbox.Toolbar"),l=$.Object,d=($.Function,$.Array),u=$.Date,m=$.Browser.isIE("<9"),p=$.createClass((0,o.$N)("module.mbox.Toolbar"));l.extend(p.prototype,{view:null,toolbar:null,getConfig:function(e){var t=this,i={groups:[]},a=t.view,n=t.view.module,o=n.param("fid");t.select(i),t.complete(i),t.remove(i),"archive"!==n.extend("area")&&"defer"!==n.extend("subtype")&&t.report(i),t.control(i),t.recovery(i),t.refresh(i),t.readingStatus(i),t.assignTasks(i),$G.environment.isCh&&t.promotionTask(i),t.calendar(i),t.extend(i,e);var r=t.readingStatusInfo;return 3===o&&r&&r.beenTrialed?i.hidden=!1:i.hidden=""===a.getLayout()&&n.isNone(),i},select:function(e){var t=this.view,i=t.module,a=e.groups,n=[{xtype:"button",subclass:"dropdownBtn",checkbox:{checkedchange:function(e){i.log("toolbar","allornone"),t.select(e?"all":"none")},checked:t.allSelected},menu:{groups:[{items:[{text:c.t("å…¨é€‰"),click:function(){i.log("toolbar","all"),t.select("all")}},{text:c.t("ä¸é€‰"),click:function(){i.log("toolbar","none"),t.select("none")}},{text:c.t("æœªè¯»"),click:function(){i.log("toolbar","unread"),t.select("unread")}},{text:c.t("å·²è¯»"),click:function(){i.log("toolbar","read"),t.select("read")}}]}]}}];"defer"===i.extend("subtype")&&n[0].menu.groups[0].items.push({text:c.t("åˆ°æœŸ"),click:function(){t.select("expire")}}),a[a.length]={items:n}},complete:function(e){var t=this.view,i=t.module;if("defer"===i.extend("subtype")){var a=e.groups,n=[];n.push({xtype:"button",subclass:"mainBtn",text:c.t("è®¾ä¸ºå®Œæˆ"),icon:{type:"done",subtype:"white"},click:function(){i.log("toolbar","defercomplete"),t.setDefer("complete")}}),a[a.length]={items:n}}},remove:function(e){var t=this.view,i=t.module,a=e.groups,n=i.param("fid"),o=i.param("fids"),r=i.param("tag"),s=i.extend("smart"),l=c.t("åˆ  é™¤"),u=!1,m=!1;n>0?m=d.has([4,5,7,15,18],n):o&&(m=d.has(o,4)&&1===o.length),m||!r||s||(m=0===r[0].indexOf("%")&&!/^%ex_trace_(.+)%$/.test(r[0])),m?(l=c.t("å½»åº•åˆ é™¤"),u=!0):2===n&&(l=c.t("åˆ é™¤è‰ç¨¿")),a[a.length]={items:[{xtype:"button",text:l,click:function(){i.log("toolbar",u?"permanentdeleted":"movetodeleted",$.Support.getStatsMailinfo({value:1})),t.remove(u)},disabled:!!m&&t.folderSelected}]}},report:function(e){var t=this.view,i=t.module,a=e.groups,n=i.param("fid"),o=t.folderSelected;if(!n||!d.has([2,3],n)){var r=[];if(d.has([5,7,18],n)){var s=c.t("è¿™ä¸æ˜¯åƒåœ¾é‚®ä»¶");7===n&&(s=c.t("è¿™ä¸æ˜¯æ¨å¹¿é‚®ä»¶")),18===n&&(s=c.t("è¿™ä¸æ˜¯è®¢é˜…é‚®ä»¶")),r.push({xtype:"button",text:s,click:function(){i.log("toolbar","trust_click",$.Support.getStatsMailinfo({pos:"folder_"+n})),i.log("toolbar","report","normal"),t.setSpam(!1)},disabled:o})}r.push({xtype:"button",text:c.t("ä¸¾ æŠ¥"),click:function(){i.log("toolbar","report",$.Support.getStatsMailinfo({value:"spam"})),t.setSpam(!0)},disabled:o}),a[a.length]={items:r}}},control:function(e){var t=this,i=e.groups,a=(i[i.length]={items:[]}).items;t.mark(a),t.move(a),t.more(a)},mark:function(e){var t=this.view,a=t.module,n=(a.extend("type"),a.extend("subtype")),o=t.folderSelected,s={xtype:"button",subclass:"dropdownBtn",text:c.t("æ ‡è®°ä¸º"),menu:{groups:[]}};e.push(s);var l=s.menu.groups;if("defer"===n){var u=[{text:c.t("å®Œæˆ"),click:function(){t.setDefer("complete")},icon:"todo"}];l[l.length]={items:u}}var m,p="read"===n,f=a.extend("read"),h=[{text:c.t("å·²è¯»"),click:function(){a.log("toolbar","setread"),t.setRead(!0)},disabled:p&&f},{text:c.t("æœªè¯»"),icon:"unread",click:function(){a.log("toolbar","setunread",$.Support.getStatsMailinfo({value:1})),t.setRead(!1)},disabled:p&&!f}];if("folder"===n&&h.push({text:c.t("å…¨éƒ¨è®¾ä¸ºå·²è¯»"),click:function(){a.log("toolbar","setallread"),t.setAllRead()}}),l[l.length]={items:h},a.isDefer()&&"defer"!==n){var g=[{text:c.t("å¾…åŠé‚®ä»¶"),click:function(){a.log("toolbar","setdefer"),t.setDefer("add")},disabled:o,icon:"todo"}];l[l.length]={items:g}}if(a.isFlag()){for(var v=$.LETTERFLAG,b=[],y="flag"===n,x=a.extend("flag"),k=2,S=v.length;k<S;k++)v[k]&&(b[b.length]={text:v[k],icon:"flag-"+k,extcls:"txt-flag"+k,click:function(e){return function(){a.log("toolbar","setflag",$.Support.getStatsMailinfo({value:e})),t.setFlag(e)}}(k),disabled:y&&x===k});l[l.ltxt-flag1",click:function(){a.log("toolbar","setflag",$.Support.getStatsMailinfo({value:1})),t.setFlag(1)},disabled:y&&1===x},{text:c.t("å…¶ä»–æ——å¸œ"),icon:"flag-0",menu:{groups:[{items:b}]}},{text:c.t("å–æ¶ˆæ——å¸œ"),click:function(){a.log("toolbar","setflag",$.Support.getStatsMailinfo({value:0})),t.setFlag(0)}}]}}if(a.isTag()){var w=r.Z.list(),T=[],C="tag"===n,_=a.param("Tag");for(var I in w){var A=w[I];T[T.length]={text:r.Z.getName(A),icon:{type:"tag",subtype:A.color,xtype:"icon"},click:function(e){return function(){a.log("toolbar","settag",1),t.setTag(!0,e)}}(A.name),dieabled:(m=A.name,C&&_&&d.has(_,m))}}var M=l[l.length]={items:[{text:c.t("æ ‡ç­¾"),menu:{groups:[]}}]},L=M.items[0].menu.groups;T.length>0&&(L.push({items:T,type:"scroll"}),M.items.push({text:c.t("å–æ¶ˆæ‰€æœ‰æ ‡ç­¾"),click:function(){a.log("toolbar","settag",0),t.setTag()}})),L.push({items:[{text:c.t("æ–°å»ºæ ‡ç­¾å¹¶æ ‡è®°"),click:function(){a.log("toolbar","settag",2),Promise.resolve().then(i.bind(i,71591)).then($.Function.bind((function(e){e.default.add({callback:function(e){t.setTag(!0,e)}})})))}}]})}a.isTop()&&(l[l.length]={items:[{text:c.t("ç½®é¡¶é‚®ä»¶"),click:function(){a.log("toolbar","settop",$.Support.getStatsMailinfo({value:1})),t.setTop(!0)},disabled:o},{text:c.t("å–æ¶ˆç½®é¡¶"),click:function(){a.log("toolbar","settop",0),t.setTop(!1)},disabled:o}]})},move:function(e){var t=this.view,a=t.module,n=a.param("fid"),o={xtype:"button",subclass:"dropdownBtn",text:c.t("ç§»åŠ¨åˆ°"),menu:{groups:[]}};e.push(o);var r=o.menu.groups,u=s.Z.list(),m={custom:[],pop:[],system:[]};d.each(u,(function(e,i){if(n!==i.id){var o,r=i.flags;o=r.custom?"custom":r.pop?"pop":"system";var s=m[o];s[s.length]={text:i.name,click:function(){a.log("toolbar","move",$.Support.getStatsMailinfo({value:1,target_folder:i.id.toString()})),t.move(i.id)},icon:r.pop?{type:"folder",subtype:i.flags.iconSubtype,xtype:"icon"}:void 0}}}));var p=[],f=!1;l.each(m,(function(e,t){var i=t.length>0;f&&i&&p.push({type:"split"}),f=f||i;for(var a=0,n=t.length;a<n;a++)p.push(t[a])})),r[r.length]={items:p,type:"scroll"},r[r.length]={items:[{text:c.t("æ–°å»ºæ–‡ä»¶å¤¹å¹¶ç§»åŠ¨"),click:function(){Promise.resolve().then(i.bind(i,92862)).then($.Function.bind((function(e){e.default.add({callback:function(e){a.log("toolbar","move",$.Support.getStatsMailinfo({value:2,target_folder:e.toString()})),t.move(e)}})})))}}]}},more:function(e){var t=this.view,i=t.module,n=t.folderSelected,r={xtype:"button",subclass:"dropdownBtn",text:c.t("æ›´å¤š"),menu:{groups:[]},disabled:n};e.push(r);var s=r.menu.groups,d=[{text:c.t("å¯¼å‡ºé€‰ä¸­é‚®ä»¶"),click:function(){i.log("toolbar","export"),t.exportLetter()},disabled:n},{text:c.t("è½¬å‘é€‰ä¸­é‚®ä»¶"),click:function(){i.log("toolbar","forward"),t.forwardLetter()},disabled:n}],u=i.param("fid");if(u>0){var p=$.Ud.get({field:"ntes_option",flag:"sizeshow"})-0,f=!(m||(0,o.$S)("isFree")&&1!==p),h=c.t("å‘ä»¶äºº"),g="from";2!==u&&3!==u||(h=c.t("æ”¶ä»¶äºº"),g="to");var v=[];v=[[c.t("æŒ‰æ—¶é—´ä»æ–°åˆ°æ—§"),"date",!0],[c.t("æŒ‰æ—¶é—´ä»æ—§åˆ°æ–°"),"date",!1],[c.t("æŒ‰"+h+"é™åº"),g,!0],[c.t("æŒ‰"+h+"å‡åº"),g,!1],[c.t("æŒ‰ä¸»é¢˜é™åº"),"subject",!0],[c.t("æŒ‰ä¸»é¢˜å‡åº"),"subject",!1]],f&&(v.push([c.t("æŒ‰é‚®ä»¶ä»å¤§åˆ°å°"),"size",!0]),v.push([c.t("æŒ‰é‚®ä»¶ä»å°åˆ°å¤§"),"size",!1]));var b=0,y=i.param("order"),x=i.param("desc");switch(y){case"date":b=x?0:1;break;case"to":case"from":b=x?2:3;break;case"subject":b=x?4:5;break;case"size":b=x?6:7}for(var k=[],S=0,w=v.length;S<w;S++){var T=l.clone(i.param()),C=l.clone(i.extend()),_=v[S];T.order=_[1],T.desc=_[2],k[k.length]={text:_[0],click:function(e,t){return function(){i.log("toolbar","sort",e.order+"_"+e.desc),a.default.entry(e,t)}}(T,C),checked:S===b}}d.push({text:c.t("æ’åº"),menu:{groups:[{items:k,checkType:"radio"}]}})}s[s.length]={items:d}},recovery:function(e){var t=this.view.module,a=e.groups,n=t.param("fid");4!==n&&15!==n||!$.Ext.recovery||(a[a.length]={items:[{xtype:"button",text:c.t("è¯¯åˆ æ¢å¤"),click:function(){t.log("toolbar","recovery"),Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"recovery",title:c.t("è¯¯åˆ æ¢å¤"),fullScreen:!0})})))}}]})},refresh:function(e){var t=this.view,i=e.groups;i[i.length]={items:[{xtype:"button",text:c.t("åˆ· æ–°"),click:function(){t.module.log("toolbar","refresh"),t.refresh()}}]}},calendar:function(e){var t=this.view.module,i=e.groups,n=t.extend("subtype");if("folder"===n||"calendar"===n){var o;try{var r=t.param("filter");if(r&&r.sentDate){var s=r.sentDate,c=t.constructor,d=s.split(":"),m=d[0],p=d[1],f=c.parseSentDate(m),h=c.parseSentDate(p);o=f-h==0?f:[f,h]}}catch(e){}i[i.length]={items:[{xtype:"calendar",onselect:function(e,i){t.log("toolbar","calendar"),i||(i=new window.Date(e));var n=u.format(e,"yyyyMMdd"),o=u.format(i,"yyyyMMdd"),r=l.clone(t.param()),s=l.clone(t.extend());r.fid&&(r.fids=[r.fid],delete r.fid);var c=(i.getTime()-e.getTime())/1e3/60/60/24;s.calendar=0===c?"date":6===c?"week":"month",s.subtype="calendar",r.filter={sentDate:n+":"+o},a.default.entry(r,s)},focus:o}],type:"ext"}}},extend:function(e,t){var i=e.groups;this.page(i,t),this.option(i)},page:function(e,t){var i,a,n=this,o=n.view,r=o.module,s=r.getPage(),l=r.extend("index"),d=r.extend("area");if(r.isArchive()&&(i="normal"===d,a="archive"===d),s>0||i||a){var u=l>0||a?function(){r.log("toolbar","previous"),o.goPage(l-1),l--,r._child.view.changeSelect()}:void 0,p=!u,f=l<s-1||i?function(){r.log("toolbar","next"),o.goPage(l+1),l++,r._child.view.changeSelect()}:void 0,h=!f,g=[];if(a&&g.push({text:c.t("æœ€è¿‘çš„é‚®ä»¶"),value:-1,checked:!1}),0===s&&(s=1),!m||t)for(var v=0;v<s;v++)g.push({text:v+1+"/"+s,value:v,checked:v===l});else g.push({text:l+1+"/"+s,value:l,checked:!0});i&&g.push({text:c.t("æ›´æ—©çš„é‚®ä»¶"),value:s,checked:!1}),(e[e.length]={items:[],type:"ext"}).items.push({xtype:"select",system:m,subclass:"simpleSelect",options:g,title:c.t("å½“å‰ç¬¬")+(l+1)+c.t("é¡µ"),selectedchange:function(){var e=this,t=e.value-0;t!==l&&(r.log("toolbar","gopage"),o.goPage(t),r._child.view.changeSelect(),-1!==t&&t!==s||(-1===t?e.setValue(l):e.setSelected(l),e.fire("selectedchange")))},listeners:m&&!t?{mouseover:{handler:function(){n.update(!0)}}}:void 0}),(e[e.length]={items:[],type:"ext"}).items.push({xtype:"button",icon:"prev",subclass:"roundBtn",disabled:p,click:u,title:c.t("ä¸Šä¸€é¡µ"),lazyListen:!1},{xtype:"button",icon:"next",subclass:"roundBtn",disabled:h,click:f,title:c.t("ä¸‹ä¸€é¡µ"),lazyListen:!1})}},option:function(e){var t=this,a=t.view,r=a.module,s=r.extend("type"),l=r.extend("subtype"),u=r.param("fid"),p={groups:[],extcls:"nui-settingMenu",delegateTo:"self",reverse:!0};(e[e.length]={items:[],type:"ext"}).items.push({xtype:"button",icon:"setting",subclass:"roundBtn",menu:p,title:c.t("è®¾ç½®")});var f,h=p.groups;f=[];var g=$.Ud;if(!m&&"search"!==s){var v=g.get({field:"ntes_inbox",flag:"layout"})-0;0===v&&(v=1);for(var b=[[c.t("å…³é—­"),1],[c.t("åº•éƒ¨"),2],[c.t("å³ä¾§"),3]],y=[],x=0,k=b.length;x<k;x++){var S=b[x],w=S[1]bclass:"btn"}}f.push({doNotHide:!0,text:c.t("è¯»ä¿¡çª—å£"),extText:{xtype:"checkgroup",checkType:"radio",checkedchange:function(e){r.log("toolbar","setlayout",e),a.setLayout(e)},items:y}})}var T=g.get({field:"ntes_letter",flag:"line_height"})-0;0===T&&(T=3);var C=g.get({field:"ntes_letter",flag:"font_size"})-0;0===C&&(C=1);var _=-1;1!==T&&2!==T||2!==C?3!==T&&0!==T||1!==C&&0!==C?4===T&&3===C&&(_=3):_=2:_=1;var I=[[c.t("å®½æ¾"),1],[c.t("é€‚ä¸­"),2],[c.t("ç´§å‡‘"),3]],A=[];for(x=0,k=I.length;x<k;x++){var M=I[x],L=M[1];A[A.length]={text:M[0],value:L,checked:_===L,subclass:"btn"}}if(f.push({text:c.t("åˆ—è¡¨é—´è·"),extText:{xtype:"checkgroup",checkType:"radio",checkedchange:function(e){r.log("toolbar","setspace",e),a.setSpace(e)},items:A}}),!$.Ext.limit_max){var E=[],D=[["10",10],["15",15],["20",20],["30",30],["50",50],["100",100]],R=r.extend("limit");for(x=0,k=D.length;x<k;x++){var P=D[x],F=P[1];E[E.length]={text:P[0],value:F,checked:R===F,subclass:"btn"}}f.push({text:c.t("æ¯é¡µæ˜¾ç¤ºé‚®ä»¶æ•°é‡"),extText:{xtype:"checkgroup",checkType:"radio",checkedchange:function(e){r.log("toolbar","setmaxlist",e),a.setMaxList(e)},items:E}})}var j=g.get({field:"ntes_option",flag:"sendershow"})-0,N=[[c.t("å‘ä»¶äººå§“å"),1],[c.t("é€šè®¯å½•æ˜µç§°"),2]],U=[];for(x=0,k=N.length;x<k;x++){var K=N[x],O=K[1];U[U.length]={text:K[0],value:O,checked:2===j^2!==O,subclass:"btn"}}if(f.push({gap:"before",text:c.t("å‘/æ”¶ä»¶äººå§“åæ˜¾ç¤º"),extText:{xtype:"checkgroup",checkType:"radio",checkedchange:function(e){r.log("toolbar","setsendershow",e),a.setSenderShow(e)},items:U}}),!m&&(0,o.$S)("isFree")&&"l-r"!==a.getLayout()){var Y=g.get({field:"ntes_option",flag:"sizeshow"})-0;f.push({text:c.t("é‚®ä»¶å¤§å°"),extText:{xtype:"checkbox",subclass:"switch",checked:1===Y,text:c.t("æ˜¾ç¤º"),unCheckText:c.t("éšè—"),checkedchange:function(e){r.log("toolbar","setsize",e?1:0),a.setSize(e?1:0)}}})}if(r.isThread(!0)){var B=(0,o.$S)("isFree"),H=B?0:1,G=B?1:0,z=g.get({field:"ntes_option",flag:"thread"})-0;f.push({text:c.t("é‚®ä»¶ä¼šè¯"),extText:{xtype:"checkbox",subclass:"switch",checked:z===H,text:c.t("å¼€å¯"),unCheckText:c.t("å…³é—­"),checkedchange:function(e){r.log("toolbar","setthread",e?1:0),a.setThread(e?H:G)}}})}if($.Ext.summary&&"full"!==l){var q=g.get({field:"ntes_option",flag:"summary"})-0;f.push({text:c.t("é‚®ä»¶æ‘˜è¦"),extText:{xtype:"checkbox",subclass:"switch",checked:1===q,text:c.t("å¼€å¯"),unCheckText:c.t("å…³é—­"),checkedchange:function(e){r.log("toolbar","setsummaryshow",e?1:0),a.setSummaryShow(e?1:0)}}})}var Z=!1;3===u&&$.Ext.letterRecall&&(f.push({gap:"before",text:c.t("é‚®ä»¶æ’¤å›"),click:function(){r.log("toolbar","gomailback"),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"BaseSetModule",inputName:"SectionMailRecall"})})))}}),Z=!0),f.push({gap:Z?void 0:"before",text:c.t("é‚®ç®±ä¸­å¿ƒ"),click:function(){r.log("toolbar","gomailcenter"),n.default.entry({module:"AccountCenterModule"})}}),f.push({text:c.t("æ¥ä¿¡åˆ†ç±»"),click:function(){r.log("toolbar","gofilter"),n.default.entry({module:"MailFilterModule"})}}),f.push({text:c.t("æ–‡ä»¶å¤¹ç®¡ç†"),click:function(){r.log("toolbar","gofoldermanager"),n.default.entry({module:"FolderTagModule"})}}),d.has([5,7,18],u)&&(null===t.showAntiSpam&&t.updateAntiSpamShow(),t.showAntiSpam&&f.push({text:c.t("æ™ºèƒ½åˆ†ç±»è®¾ç½®"),click:function(){r.log("toolbar","goantispam"),n.default.entry("AntiSpamModule")}})),f.push({text:c.t("æ›´å¤šè®¾ç½®"),click:function(){r.log("toolbar","moresetting"),n.default.entry({module:"BaseSetModule"})}}),h.push({items:f})},showAssignTasks:null,assignTasks:function(e){var t=this,i=t.view,a=i.module,n=e.groups,r=a.param("fid");r&&[2,4,5th]={items:[{xtype:"button",text:c.t("åˆ†é…ä»»åŠ¡"),click:function(){window.mailTeam&&(i.assignTasks(),$.Log.cache({mbox_toolbar_assignTask_click:1}))}}]})},updateAssignTasksShow:function(){var e=this,t=$.Function.bind(e.update,e);$.Ud.getProxy({field:["product.collaboration.expireTime","product.collaboration.isTeamMail","product.collaboration.memberType"],call:function(i){var a=$.Misc.getTime().getTime(),n=i["product.collaboration.expireTime"],o=i["product.collaboration.isTeamMail"],r=i["product.collaboration.memberType"];(!(a>n)&&r>0||1===o)&&(e.showAssignTasks=!0,setTimeout((function(){t()}),0))}})},promotionTask:function(e){var t=this.view.module,i=e.groups,a=t.param("fid");a&&[2,4,5,6,7,15].indexOf(a)<0&&(0,o.$S)("isFree")&&$.Ud.udProxy["product.cafeteria.userGroup_collab_promotion_task"]&&(i[i.length]={items:[{xtype:"button",text:c.t("åˆ›å»ºå›¢é˜Ÿï¼Œåˆ†é…ä»»åŠ¡é‚®ä»¶"),click:function(){$.Support.teamMailPromotion(),$.Log.cache({mbox_toolbar_assign_taskPromotion:1})}}]})},showAntiSpam:null,updateAntiSpamShow:function(){var e=this,t=$.Function.bind(e.update,e);$.Ud.getProxy({field:["product.mail.antiSpamLevelOrSmartSort"],call:function(i){i&&1==i["product.mail.antiSpamLevelOrSmartSort"]&&(e.showAntiSpam=!0,setTimeout((function(){t()}),0))}})},readingStatusInfo:null,updateReadingStatus:function(){var e=this,t=$.Function.bind(e.update,e);$.Ud.getProxy({field:["product.plus.mailTrackingStatus"],call:function(i){var a=i["product.plus.mailTrackingStatus"],n={};try{n=JSON.parse(a)}catch(e){console.log(e)}e.readingStatusInfo=n,setTimeout((function(){t()}),0)}})},readingStatus:function(e){var t,i,n,o,r=this,s=r.view.module,l=e.groups,d=s.param("fid"),u=s.param().tag||[];if(null===r.readingStatusInfo)return r.updateReadingStatus(),!1;var m=r.readingStatusInfo;if(3!re>0))return!1;function p(e){var t=s.param("tag")||[],i={fid:3},n=t.indexOf("%ex_trace_read%"),o=t.indexOf("%ex_trace_unread%"),c=t.indexOf("%ex_trace_all_read%"),l=n>=0&&o>=0;switch(c>=0&&t.splice(c,1),e){case"all":t=l?[]:["%ex_trace_read%","%ex_trace_all_read%","%ex_trace_unread%"],$.Log.cache({mbox_toolbar_mailTrack_allCheck_click:!l});break;case"read":n>=0?t.splice(n,1):(t.push("%ex_trace_read%"),t.push("%ex_trace_all_read%")),$.Log.cache({mbox_toolbar_mailTrack_checkRead_click:!(n>=0)});break;case"unread":o>=0?t.splice(o,1):t.push("%ex_trace_unread%"),$.Log.cache({mbox_toolbar_mailTrack_checkUnread_click:!(o>=0)})}t.length&&(i.tag=t,t.indexOf("%ex_trace_all_read%")>-1?t.indexOf("%ex_trace_read%")<0&&t.splice(t.indexOf("%ex_trace_all_read%"),1):t.indexOf("%ex_trace_read%")>-1&&t.push("%ex_trace_all_read%")),a.default.entry(i),setTimeout((function(){r.update()}),0)}t=u.indexOf("%ex_trace_read%")>=0,i=u.indexOf("%ex_trace_unread%")>=0,n=t||i,o=t&&i,l[l.length]={items:[{xtype:"button",subclass:"dropdownBtn",text:n?c.t("å·²ç­›é€‰"):c.t("ç­›é€‰"),click:function(){$.Log.cache({mbox_toolbar_mailTrack_filterBtn_click:1})},menu:{groups:[{items:[{text:c.t("å…¨éƒ¨é€‰æ‹©"),checked:o,checkType:"checkbox",click:function(){p("all")}},{text:c.t("å±•ç¤ºå¯¹æ–¹å·²è¯»"),checked:t,checkType:"checkbox",click:function(){p("read")}},{text:c.t("å±•ç¤ºå¯¹æ–¹æœªè¯»"),checked:i,checkType:"checkbox",click:function(){p("unread")}}]}]}}]}},get:function(){var e=this,t=e.getConfig(),i=e.toolbar=new $.Toolbar(t);returne){var t=this.toolbar,i=this.getConfig(e);t.update(i)},destory:function(){try{this.toolbar.destroy(),this.toolbar=null}catch(e){}},selectAll:function(e){try{this.toolbar.find("checkbox")[0].setChecked(e,!0)}catch(e){}},initialize:function(e){this.view=e}}),t.Z=p},55989:function(e,t,i){i.r(t),i(37092),i(92274),i(55737),i(42295),i(26340),i(15761),i(20869),i(63518),i(75654),i(66403);var a,n,o,r,s=i(72957),c=i(28978),l=i(30443),d=i(10970),u=i(15372),m=new s.c1("module.outlink.OutlinkModul=parseInt($.Browser.ie(),10)||7===parseInt($.Browser.ie(),10),f=$.createClass((0,s.$N)("module.outlink.OutlinkModule"));$.Object.inherit(f,a),$.Object.extend(f,{View:o,modules:{},hostListen:{},height:700,noRecreateByHistory:!0,interface:n}),$.Object.extend(f.prototype,{init:function(){var e=this,t=this.find("IFRAME").dom;this.frame=t,t&&""!==this.url&&"about:blank"!=this.url&&(t.src=this.url),t&&p&&(t.style.height=document.documentElement.clientHeight-$.fly("#dvContainer").offset()[1]+"px"),$.Event.listen(this.frame,"focus",(function(){$.Event.fire(document,"click"),$.Event.fire(document.body,"click")})),this.setTimer();var i=this.key;if(this.cross)try{window.netease.mail.api&&window.netease.mail.api.Cross?r():$.Ajax.request({requestType:$.Ajax.SCRIPT,url:$G.environment.mimgUrl+"mailapi/src/2.0/cross_js5.js",call:function(){r()}})}catch(e){}if(e.hideDock&&$.Dock.hiddenDock(),e.isBeta){var a=e._tab;a&&!a.getEl().find(".nui-ico-beta")&&a.getEl().append('<div class="nui-tabs-item-status"><b class="nui-ico nui-ico-beta"></b></div>')}var n=$G.get("multiTabConf"),o=$.Array.findObject(n,"group",i);function r(){var t=window.netease.mail.api.Cross;/(url=)?https?:\/\/(.+?)\//.test(decodeURIComponent(e.url))&&(t.registXMessage("http://"+RegExp.$2+"/proxy.htm"),"optimizer_folder"==e.key?t.addMsgListener((e.frame||{}).id):t.addMsgListener("frm"+e.name))}o&&o.onRender&&$.Function.bind(o.onRender,e._tab)(),e.forceRemoveDom=!0,window.setTimeout((function(){e.showAddAppTips()}),1e3)},cache:function(e){this.key,e.fromTabClick||(this.container.innerHTML=this.container.innerHTML,this.frame=this.find("IFRAME").dom)},reset:function(e){return e.fromTabClick||(this.container.innerHTML=this.container.innerHTML,this.frame=this.find("IFRAME").dom),!0},exit:function(e){var t=this;t.key;try{$.JS.remove(t),t.hasRemove=!0}catch(e){s.$D.log(e)}return this.switchOut(!0),this.clearTimer(),arguments[2]&&"beforeunload"!==arguments[2]&&t.hideDock&&$.Dock.unHiddenDock(),t.removeAddAppTips(),!0},resize:function(){var e=this.find("IFRAME").dom;e&&p&&(e.style.height=document.documentElement.clientHeight-$.fly("#dvContainer").offset()[1]+"px",e.style.width=document.documentElement.clientWidth-$.fly("#dvContainer").offset()[0]+"px")},getText:function(){return this.title},getGroup:function(){return this.group||this.name},switchOut:function(e){var t=this;this.key,t.noCache&&t.cleanCache(),!e&&t.hideDock&&$.Dock.unHiddenDock(),t.hideAddAppTips()},switchIn:function(){this.hideDock&&$.Dock.hiddenDock(),this.showAddAppTips()},setTimer:function(){},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},initialize:function(e){e=e||{},this.key=e.key||"",this.pureUrl=e.pureUrl,this.pureUrl&&this.key?this.url=$.Uri.getUrl(this.key,!0):(this.url=e.url||"",this.url=""===this.url?$.Uri.getUrl(this.key,this.pureUrl):this.url),this.title=e.title||"",this.group=e.group||this.key||this.url||"outlink",this.cross=e.cross,this.showDefTree=e.showDefTree,this.isAppCenter=e.isAppCenter,this.appId=e.appId,this.noCache=e.noCache,e.hideDock&&(this.hideDock=!0),e.isBeta&&(this.isBeta=!0),(0,s.$S)("isVip")&&!this.fullScreen&&(this.fullScreen=this._isVipAppPage()),f.modules[this.key]=this},getHistoryParam:function(){var e={key:this.key,title:this.title,cross:this.cross,showDefTree:this.showDefTree,group:this.group,fullScreen:this._var.param.fullScreen,isAppCenter:this.isAppCenter};return this.isAppCenter&&(e.appId=this.appId),this.noCache&&(e.noCache=!0),this.hideDock&&(e.hideDock=!0),this.pureUrl&&(e.pureUrl=!0),this.isBeta&&(e.isBeta=!0),this.key&&"undefined"!==this.key||!this.title||(e.url=this.url),e},showAddAppTips:function(){var e=this,t=e.createId("addAppTips"),i=(0,s.$C)(t);if(window.DockAnimationTimer,!e._isClosedAddAppTips&&e._needAddAppTips())if(i)i.show();else{var a='<div class="sg0">'+$.Link.html({text:m.t("æ·»åŠ åˆ°æˆ‘çš„åº”ç”¨"),cls:"nU0",click:function(){r.addUserAppToServer(e.appId,(function(){$G.get("appCenterConfig").addApp({id:e.appId,onlyShowDock:!0}),e.removeAddAppTips()}))}})+$.Link.html({text:m.t("å…³é—­æç¤º"),cls:"ma0",click:function(){e.removeAddAppTips()}})+"</div>",n=$.Component.html({id:t,html:a});$(document.body).append(n),$.Component.setEvents()}},hideAddAppTips:function(){var e=this.createId("addAppTips"),t=(0,s.$C)(e);t&&t.hide()},removeAddAppTips:function(){var e=this.createId("addAppTips"),t=(0,s.$C)(e);t&&(t.destroy(),this._isClosedAddAppTips=!0)},_needAddAppTips:function(){var e=this;if(e.appId+""=="23004"||e.title===m.t("æ–—åœ°ä¸»"))return!1;var t=!0;return(0,s.$S)("useAppCenter")&&0===r.getAppsList().length&&(t=!1),e.isAppCenter&&e.appId&&t&&!r.getApp(e.appId).id},_isVipAppPage:function(){var e,t,i=this;return!(!(0,s.$S)("isVip")||"outlink"!==i.mtype||"appModule"!==i.group&&"appMoudle"!==i.group&&"appManager"!==i.group&&"app_manager"!==i.group&&(e=r.getAppsList(),t=$.Array.findObject(e,"name",i.key),!t||"nf_center"===t.name))},useCache:!1,cacheDom:!1,key:"",url:"",title:"",appId:"",hideDock:!1,fullScreen:!1,mtype:"outlink"}),t.default=f},10970:function(e,t,i){i(66403);var a=i(72957),n=i(32073),o=6===parseInt($.Browser.ie(),10)||7===parseInt($.Browser.ie(),10),r=n.Z,s=$.createClass((0,a.$N)("module.outlink.OutlinkView"));$.Object.mix(s,r,{},{initialize:function(e){e._var.param.showDefTree&&(this.getNavConf=null)},getHtml:function(){var e=this.module.height+"px";return'<div class="frame-main-cont-body nui-scroll frame-main-cont-body-noToolbar"><div class="frame-main-cont-iframeCont"><iframe id="frm'+this.module.name+'" src=\'about:blank\' allowTransparency="true" class="frame-main-cont-iframe" name="frm'+this.module.name+'" border="0" frameborder="0" style="width:100%'+(o?";height:"+e:"")+'" ></iframe></div></div>'}}),t.Z=s},23965:function(e,t,i){i(55737),i(66403),i(48868),i(92274),i(63045),i(81874),i(54861),i(8600),i(803),i(37092),i(66251),i(49750);var a,n=i(72957),o=i(28978),r=i(1124),s=i(88829),c=i(20313),l=new n.c1("module.read.BaseReadModule");a=$.createClass((0,n.$N)("module.read.BaseReadModule")),$.Object.mix(a,o.Z,null,{initialize:function(e,t){var i,a=this;if(e&&(a.fid=e.fid,a.group=e.group,a.viewType=e.viewType,a.isThread=e.isThread,a.area=e.area),void 0!==t&&(a.folderData=i=t.folderData,a.listModule=t.listModule,a.listParam=t.listParam,a.listExtend=t.listExtend,a.listUnstable=t.listUnstable,t.hidden&&(a.isHiddenMod=!0)),void 0===i){var n=a._var;n&&(a.folderData=i=n.folderData)}void 0!==i&&(a.fid=i.fid),a.isIE678=$.Browser.isIE("<9"),a.isChrome=!!$.Browser.chrome(),a._initFrameOnloadHandler(),a.userLabels={}},init:function(){var e=this;e.part||e.fixSibling(),e.markRead(!1),window.setTimeout((function(){e.part||e.updateTag(),e.isIE678&&!e.isThread||e.scroll(null,$.Function.bind(e._scrollHandler,e))}),200),e.updateUserLabel()},getText:function(e){var t=this.folderData;return void 0!==t?t.subject||l.t("æ— ä¸»é¢˜"):(this.textCall=e,l.t("ä¿¡ä»¶åŠ è½½ä¸­"))},getGroup:function(){return this.group||this.name},getHistoryParam:function(){try{var e={},t=this._var.param;return void 0!==t&&t.hidden?($.Object.extend(e,t),delete e.hidden,delete e.moduleName,e):t}catch(e){}},switchIn:function(){var e=this,t=e.reader,i=t.body;t.notFocus=!1,e.listUnstable&&e.siblingInited&&e.fixSibling(),i.greetingCardContent&&t.assistant.bodyFilter("mail")},switchOut:function(){var e=this.reader,t=[],i=e.body;e.notFocus=!0,i.mediaContent&&t.push((function(){i.stopAllMedia()})),i.greetingCardContent&&t.push((function(){i.destroy(!0)})),t.length>0&&window.setTimeout((function(){$.Array.each(t,(function(e,t){t()}))}),200)},cache:function(){var e=this;e.viewType&&e.switchIn(),(0,n.$S)("lastRead",e.mid||e.tid),e.markRead(!1)},exit:function(){var e=this;return e.viewType&&e.switchOut(),e.reader.view.exit(),!0},back:function(e){var t=this;t.part?(history.back(),"function"==typeof e&&e()):void 0!==t.listParam?r.default.entry(t.listParam,t.listExtend,e):r.default.entry({fid:t.fid},null,e)},fixSibling:function(){var e=this;e.viewType||r.default.getPosition({moduleName:e.listModule,data:e.folderData,callback:function(t){var i,a,o=(0,n.$C)(e.createId("pre")),r=(0,n.$C)(e.createId("next"));if(!t)return o.setDisabled(),void r.setDisabled();i=t.pre,a=t.next,i?(e.preMail=i,o.getEl().dom.title=l.t("ä¸Šä¸€å°ï¼š")+$.String.escapeHTML(i.folderData.subject)):(o.setDisabled(),o.getEl().dom.title=l.t("æ— ä¸Šä¸€å°")),a?(e.nextMail=a,r.getEl().dom.title=l.t("ä¸‹ä¸€å°ï¼š")+$.String.escapeHTML(a.folderData.subject)):(r.setDisabled(),r.getEl().dom.title=l.t("æ— ä¸‹ä¸€å°")),e.siblingInited=!0}})},enterSibling:function(e){var t=this;Promise.resolve().then(i.bind(i,88829)).then($.Function.bind((function(i){var a,n=i.default,o=t[e+"Mail"];o&&(a=o.folderData,n.entry({isThread:(a.threadMessageCount||0)>1,moduleName:o.moduleName,moduleParam:o.moduleParam,moduleExtend:o.moduleExtend,folderData:a,group:t.getGroup()}))})));try{t.switchOut()}catch(e){}t.log({action:"click",item:e})},preloadSibling:function(e){var t,i;this.isThread||(t=this[e+"Mail"])&&(i=t.folderData,s.default.preload({id:i.id,fid:i.fid,locked:!!i.flags&&i.flags.locked}))},updateUserLabel:function(){},markRead:function(e){var t,i=this,a=i.folderData;i.isHiddenMod||i.part||(t=(a.lt.setRead({moduleName:i.listModule,isRead:!t,data:a,area:i.area,voidRequest:e})}),300)},moveTo:function(e){var t=this,i=e.folderData||t.folderData,a={moduleName:t.listModule,data:i,fromThread:e.threadItem};if(e.threadItem&&(t.moveLock=!0),e.del){var n=i.fid;4!==n&&15!==n&&18!==n&&(a.moveToId=4)}else a.moveToId=e.toFid;r.default.move(a)},report:function(e){r.default.setSpam({isSpam:e,data:this.folderData,readData:this.data,callback:function(){$.Tips.show({text:l.t("æˆåŠŸ")+(e?l.t("ä¸¾æŠ¥"):l.t("ä¿¡ä»»"))+l.t("é‚®ä»¶"),type:"suc"})}})},reject:function(e){var t="refuselist",a=e.from;$.Msgbox.show({statsKey:"read_toolbar_add_refuselist",type:"confirm",icon:"ask-l",header:l.t("æ‹’æ”¶ç¡®è®¤"),title:l.t("æ‹’æ”¶åå°† ")+a+l.t(" åŠ å…¥é»‘åå•ï¼Œå¹¶ä¸å†æ”¶åˆ°è¯¥åœ°å€çš„é‚®ä»¶ï¼Œç¡®å®šæ‹’æ”¶å—ï¼Ÿ"),ok:function(){Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(i){var n=i.default,o=a;e.sender&&(o+=","+e.sender),n.addList({name:t,value:o,noErr:!0},(function(e,i){var n={};e?($.Tips.show({succ:!0,text:l.t("æˆåŠŸæ‹’æ”¶ ")+a+l.t("ï¼Œå¯åœ¨é»‘åå•æŸ¥çœ‹")}),n["read_toolbar_"+t+"_success_show"]=1):($.Tips.show({err:!0,text:i||l.t("æ‹’æ”¶ ")+a+l.t("å¤±è´¥ï¼Œè¯·é‡æ–°å°è¯•æ‹’æ”¶")}),n["read_toolbar_"+t+"_fail_show"]=1),$.Log.cache(n)}))})))}})},setDefer:function(e,t){if(e)a(t);else{var i=this.folderData;(i.flags||{}).deferHandle&&i.defer?a({type:"complete",data:i}):this.showDeferPanel({type:"modify"})}function a(e){r.default.setDefer(e)}},showDeferPanel:function(e){var t=this,a=t.folderData,n=e.type;Promise.resolve().then(i.bind(i,67979)).then($.Function.bind((function(i){i.default.showMsgbox({type:n,data:{defer:a.defer,memo:a.memo,mid:t.mid,smsShow:e.smsShow,memoShow:e.memoShow},callback:function(e){t.setDefer(!0,{type:n,defer:e.defer,memo:e.memo,smsDate:e.smsDate,data:a})}})})))},setTop:function(){var e=this,t=e.folderData,i=!(t.flags||{}).top;r.default.setTop({isTop:i,moduleName:e.listModule,data:t,callback:function(t){if(t){var a=i?l.t("æˆåŠŸè®¾ç½®"):l.t("æˆåŠŸå–æ¶ˆ");$.Tips.show({text:a+l.t("é‚®ä»¶ç½®é¡¶"),type:"suc"})}else $.Tips.show({statsKey:"Read_NoGuide_Tips_StickFail",text:l.t("ç½®é¡¶è®¾ç½®å¤±è´¥"),type:"err"});r.default.entry({moduleName:e.listModule,fid:e.fid})}})},setTag:function(e){var t=this,i={moduleName:t.listModule,tag:e.value,data:t.folderData};t.isThread&&(i.single=!0),"add"===e.type&&(i.isAdd=!0),r.default.setTag(i)},updateTag:function(e){var t=this;if($.Ext.tag&&"archive"!==t.area){var i=(e||t.folderData).tag,a=[];i&&$.Array.each(i,(function(e,i){var n,o=c.Z.get(i);o&&(n=new $.Tag({text:c.Z.getName(o),type:o.color,attrs:"hasClose",click:function(){t.log({action:"click",item:"icon_tag"}),r.default.entry({fid:0,showTag:!0,tag:[o.name]})},closeclick:$.Function.bind(t.setTag,t,{type:"remove",value:o.name})}),a.push(n.html()))}));var n=$.fly(t.getDom("divTag"));n&&n.empty().html(a.join(""))}},moduleRemove:function(){var e=this;$.MultiTab.remove(e),$[e.viewType?"SM":"JS"].remove(e)},clean:function(){var e,t=this,i=$.Element,a=window.HTMLElement;try{for(var n in t)if(!((e=t[n]||n)instanceof $.Component))if(e instanceof i)e.destroy();else if(e instanceof a){if("container"===n)continue;e=t[n]=void 0}else e.module===t&&t.clean.call(e)}catch(e){}},safeBrowsing:function(e,t){var i=this;i.action&&i.action.safeBrowsing&&i.action.safeBrowsing(e,t)},_scrollHandler:function(){},_initFrameOnloadHandler:function(){void 0===(0,n.$S)("readFraLd")&&(0,n.$S)("readFraLd",(function(e,t,i){var a=$[(0,n.$S)("viewType")?"SM":"JS"].find(e);if(null!==a||null!==(a=$[(0,n.$S)("viewType")?"JS":"SM"].find(e))){if(a.mid&&($.Log.cache({read_mail_loaded:{value:1,mid:a.mid,timestamp:+new Date,size:a.folderData?a.folderData.size:0,linkattach:a.attached?1:0}}),(0,n.$S)("read_mail_init"))){var o=+new Date-(0,n.$S)("read_mail_init");(0,n.$S)("read_mail_init",0),$.Log.cache({read_mail_duration:{value:o,mid:a.mid}})}if(a.isThread){var r=a.threadItems[i].reader;r.body.onLoadHandler(t),$.Log.cache({thread_mail_loaded:{value:1,mid:r.mid,timestamp:+new Date,size:r.folderData?r.folderData.size:0,linkattach:r.attached?1:0}})}else a.reader.body.onLoadHandler(t);try{$.Element.getIframeDoc(t).addEventListener("copy",(function(){$.Log.cache({read_mail_copy:1})}))}catch(e){}t=void 0}}))},safeBrowsingKitLoading:!1,safeBrowsingKitCallbacks:[],ensureSafeBrowsingKit:function(e){var t=this;window.SafeBrowsingKit?e(window.SafeBrowsingKit):(this.safeBrowsingKitCallbacks.push(e),t.safeBrowsingKitLoading||(t.safeBrowsingKitLoading=!0,$.Support.loadScript("https://mimg.127.net/freemail/safe-browsing-kit/safe-browsing-kit-1.0.12.js",(function(){var e;if(t.safeBrowsingKitLoading=!1,window.SafeBrowsingKit)for(window.SafeBrowsingKit.changeLanguage($G.environment.isCh?"zh":"en");e=t.safeBrowsingKitCallbacks.shift();)e(window.SafeBrowsingKit)}))))},showSafeBrowsingGuideIfNeeds:function(e,t){var i=this;$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig"],call:function(a){var n={};try{n=JSON.parse(a["webmail.js.mailSecurityAccessConfig"])}catch(e){}n[e]?t():(console.log("showSafeBrowsingGuideIfNeeds",n),i.ensureSafeBrowsingKit((function(i){var a="";"attGuide"!==e&&"cloudAttGuide"!==e||(a="att"),a&&(i.showGuideModal({type:a,onOk:t}),n[e]=(new Date).getTime(),$.Ud.setProxy({field:"webmail.js.mailSecurityAccessConfig",value:JSON.stringify(n)}))})))}})}}),window.DoFSCommand=function(e){try{if("quit"===e){var t=$("div .sp0");t&&$.Array.each(t.doms,(function(e,t){(t=$(t)).empty(),$(t.dom.parentNode).removeClass("oT0"),t.remove().destroy()})),t.destroy(),$.Ext.useNewAd&&$.Ud.set({field:"ntes_letter",flag:"read_ad",value:1})}}catch(e){n.$D.log(l.t("window.DoFSCommandï¼šè¯»ä¿¡å¹¿å‘Šè®¾ç½®å¤±è´¥ã€‚"))}},t.Z=a},14354:function(e,t,i){i(37092),i(92274),i(8600),i(42295),i(86305),i(37885),i(48868),i(63045),i(81874),i(54861),i(66403),i(75654),i(52963);var a,n,o,r,s,c=i(72957),l=i(71591),d=i(4982),u=i(92066),m=i(32073),p=new c.c1("module.read.BaseReadView");o=l.default,r=d.default,s=u.Z,n=m.Z,a=$.createClass((0,c.$N)("module.read.BaseReadView")),$.Object.mix(a,n,null,{initialize:function(e){this.module=e},getHtml:function(){var e=this,t=!!e.module.viewType;return e.addHeader(t?"":e.getToolbar(),e.getContentHtml(),t?"frame-main-cont-body-noToolbar":"")+e.getOuterHtml()},getToolbar:function(){return $.Toolbar.html(this.getToolbarConf())},getToolbarConf:function(){},getContentHtml:function(){return""},getOuterHtml:function(){return""},getSiblingBtConf:function(){var e=this.module;return{items:[{xtype:"button",id:e.createId("pre"),subclass:"roundBtn",icon:"prev",listeners:{mousedown:{handler:function(){e.preloadSibling("pre")}},click:{handler:function(){e.enterSibling("pre"),e.log({action:"click",item:"toolbar_pre"})}}}},{xtype:"button",id:e.createId("next"),subclass:"roundBtn",icon:"next",listeners:{mousedown:{handler:function(){e.preloadSibling("next")}},click:{handler:function(){e.enterSibling("next"),e.log({action:"click",item:"toolbar_next"})}}}}],type:"ext"}},getTagConf:function(e){var t=this.module,i=t.folderData;return e=void 0===e?"":e+"_",$.Object.clone(o.getMenu({tag:i.tag,callback:function(i,a){i?(t.log({action:"click",item:e+"menu_tagremove"}),t.setTag({type:"remove",value:a})):(t.log({action:"click",item:e+"menu_tagadd"}),t.setTag({type:"add",value:a}))},remove:function(){t.log({action:"click",item:e+"menu_tagremoveall"}),t.setTag({type:"remove",value:null})}}))},getReplyConf:function(e){var t=this,i=t.module;return{width:$G.environment.isCh?160:320,groups:[{items:[{text:p.t("å›å¤å…¨éƒ¨"),click:function(){i.log({action:"click",item:"menu_replyall"}),(e||t.module.reader).assistant.fullReply()},extText:"Shift + A"},{text:p.t("å›å¤å…¨éƒ¨(å¸¦é™„ä»¶)"),click:function(){i.log({action:"click",item:"menu_replyall_attach"}),(e||t.module.reader).assistant.fullReply({withAttachments:!0})}},{text:p.t("å›å¤å…¨éƒ¨(æ–°é‚®ä»¶)"),click:function(){i.log({action:"click",item:"menu_replyall_new"}),(e||t.module.reader).assistant.reply({type:"new"})}}]}]}},getForwardConf:function(e){var t=this,i=t.module,a=[{text:p.t("è½¬å‘"),click:function(){i.log({action:"click",item:"menu_forward",value:$.Support.getStatsMailinfo({value:1})}),(e||t.module.reader).assistant.forward()},extText:"Shift + F"},{text:p.t("åŸä¿¡è½¬å‘..."),click:function(){i.log({action:"click",item:"menu_forwardtransmit",value:$.Support.getStatsMailinfo({value:1})}),(e||t.module.reader).assistant.originalForward()}},{text:p.t("ä½œä¸ºé™„ä»¶è½¬å‘"),click:function(){i.log({action:"click",item:"menu_forwardattach",value:$.Support.getStatsMailinfo({value:1})}),(e||t.module.reader).assistant.forward({asAttachment:!0})}}],n=$.Ud.udProxy["product.collaboration.expireTime"],o=$.Ud.udProxy["product.collaboration.memberType"],r=$.Ud.udProxy["product.collaboration.isTeamMail"],s=$.Misc.getTime().getTime()>n;return!$.Array.has([2,4,5,6,7,15],i.fid)&&i.viewType&&(!s&&o>0||1===r)&&a.push({text:p.t("åˆ†é…ä»»åŠ¡é‚®ä»¶"),click:function(){i.log({action:"click",item:"menu_assign_task"}),(e||t.module.reader).assistant.assignTask()}}),{width:$G.environment.isCh?120:240,groups:[{items:a}]}},getFlagConf:function(){for(var e,t,i=this.module,a={width:$G.environment.isCh?100:150,groups:[{items:[]},{items:[{text:p.t("å–æ¶ˆæ——å¸œ"),icon:"flag-0",click:function(){i.log({action:"click",item:"menu_flag_clear",value:$.Support.getStatsMailinfo({value:0})}),i.reader.assistant.setFlag(0)}}]}]},n=a.groups[0].items,o=1,r=$.LETTERFLAG,s=r.length;o<s;o+=1)t=o+"",(e=r[o])&&n.push({text:e,icon:"flag-"+t,extcls:"txt-flag"+t,click:$.Function.bind((function(e){i.log({action:"click",item:"menu_flag",value:$.Support.getStatsMailinfo({value:e})}),i.reader.assistant.setFlag(e)}),null,o)});return a},getMarkConf:function(){var e=this,t=e.module,i=t.folderData,a=i.flags||{},n={width:$G.environment.isCh?120:240,groups:[]},o=n.groups;if(t.isThread||o.push({items:[{text:p.t("æ——å¸œ"),menu:e.getFlagConf()}]}),"archive"!==t.area){if(!t.isThread){var r=(i.flags||{}).deferHandle&&i.defer;o.unshift({items:[{id:t.createId("toolbarSetDefer"),text:r?p.t("è®¾ä¸ºå®Œæˆ"):p.t("è®¾ç½®å¾…åŠ"),click:function(){t.log({action:"click",item:r?"menu_finish":"menu_defer"}),t.setDefer()}}]})}$.Ext.tag&&o.push({items:[{text:p.t("æ ‡ç­¾"),menu:{id:t.createId("toolBarTagMenu"),listeners:{render:function(){try{this.unlisten("render"),this.update(e.getTagConf())}catch(e){c.$D.log(p.t("getSubMenuï¼šæ›´æ–°tag menuå¤±è´¥"))}}}}}]});var s=a&&a.top;o.push({items:[{id:t.createId("toolbarSetTop"),text:s?p.t("å–æ¶ˆç½®é¡¶"):p.t("ç½®é¡¶é‚®ä»¶"),click:function(){t.log({action:"click",item:s?"menu_top_clear":"menu_top",value:$.Support.getStatsMailinfo()}),t.setTop()}}]})}return n},getCharsetConf:function(e){e=e||this.module.reader;for(var t,i={width:$G.environment.isCh?160:320,groups:[{items:[],checkType:"radio"}]},a=i.groups[0].items,n=$.READ_ENCODE,o=0,r=n.length;o<r;o+=1)t=n[o],a.push({text:t[0],checked:0===o,click:$.Function.bind((function(t){e.log({action:"click",item:"menu_charset"}),e.assistant.bodyFilter("encode",t)}),null,t[1])});return i},getFontConf:function(){for(var e,t,i,a,n=this.module,o={width:$G.environment.isCh?160:320,groups:[]},r=$.READ_FONT,s=[],c=o.groups,l=n.font||0,d=0,u=r.length;d<u;d+=1)t=(e=r[d])[0],a={text:t='<span style="font-family: '+(i=e[1]||t)+'">'+t+"</span>",checked:d===l,click:$.Function.bind((function(e){n.log({action:"click",item:"menu_font"}),n.reader.body.zoom("F",e)}),null,i)},0===d&&(a.split=!0),s.push(a);return c.push({items:s,checkType:"radio"}),o},getMoreConf:function(){var e=this,t=e.module,a={groups:[{items:[{text:p.t("æ‰“å°é‚®ä»¶"),click:function(){t.log({action:"click",item:"menu_printmail"}),t.reader.assistant.blankView(!0)}},{text:p.t("æŸ¥çœ‹ä¿¡å¤´"),click:function(){t.log({action:"click",item:"menu_viewhead"}),t.reader.assistant.bodyFilter("header")}},{text:p.t("æŸ¥çœ‹é‚®ä»¶"),click:function(){t.log({action:"click",item:"menu_viewmail"}),t.reader.assistant.bodyFilter("mail")}},{text:p.t("å¯¼å‡ºé‚®ä»¶"),click:function(){t.log({action:"click",item:"menu_download"}),t.reader.assistant.exportLetter()}},{text:p.t("é€‰æ‹©ç¼–ç "),menu:e.getCharsetConf()},{text:p.t("é€‰æ‹©å­—ä½“"),menu:e.getFontConf()}]},{items:[{text:p.t("æ–°çª—å£æ‰“å¼€"),hidden:!$G.environment.isCh,click:function(){t.log({action:"click",item:"menu_newwin"}),t.reader.assistant.blankView()}},{text:p.t("åŒä¸»é¢˜æŸ¥çœ‹"),click:function(){t.log({action:"click",item:"menu_samesubject"}),t.reader.assistant.searchSameSubject()}},{text:p.t("ä¿å­˜åˆ°æœ‰é“äº‘ç¬”è®°..."),click:function(){t.log({action:"click",item:"menu_savetonf"}),t.reader.assistant.saveToYNote()}},{text:p.t("ä¿å­˜è”ç³»äºº..."),click:function(){t.log({action:"click",item:"menu_savecontact"}),t.reader.assistant.saveContacts()}},{text:p.t("é‚®ä»¶å¤‡æ³¨"),click:function(){t.log({action:"click",item:"menu_memo"}),t.reader.assistant.editMemo()}}]},{items:[]}]},n=a.groups[1].items;$.Ext.netfolder_enable&&n.splice(2,0,{text:p.t("ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒ..."),click:function(){t.log({action:"click",item:"menu_savetonf"}),t.reader.assistant.saveToNf()}}),$.Ext.scheduleRead&&$G.environment.isCh&&n.push({text:p.t("è®¾ç½®æ—¥ç¨‹")+((0,c.$S)("isFree")?p.t("ç®¡ç†"):p.t("æé†’")),click:function(){t.log({action:"click",item:"menu_schedule"}),Promise.resolve().then(i.bind(i,26406)).then($.Function.bind((function(e){var i=e.default,a=t.mid,n=(0,c.$S)("schedule");void 0!==n&&n[a]?i.edit(a):i.add(a,t.folderData.subject)})))}}),n=a.groups[2].items,$.Ext.readTran_enable&&3!==t.fid&&$G.environment.isCh&&n.unshift({text:p.t("å…¨æ–‡ç¿»è¯‘"),click:function(){t.log({action:"click",item:"menu_trans"}),t.reader.translate({type:0})}});try{$.Array.remove(a.groups,(function(e){return!e.items||0===e.items.length}),!0)}catch(e){}return a},getFolderConf:function(){var e=this.module,t=e.fid,a={id:e.createId("folderMenu"),groups:[],type:"scroll"},n=a.groups,o=s.list(),r={custom:[],pop:[],system:[]};$.Array.each(o,(function(i,a){if(t!==a.id){var n,o=a.flags;n=o.custom?"custom":o.pop?"pop":"system";var s=r[n];s[s.length]={text:a.name,click:function(){",2,3,4,18,7,5,15,".indexOf(","+a.id+",")?e.log({action:"click",item:"menu_move",value:$.Support.getStatsMailinfo({value:a.id,target_folder:(a.id||0).toString()})}):e.log({action:"click",item:"menu_move",value:$.Support.getStatsMailinfo({target_folder:(a.id||0).toString()})}),e.moveTo({toFid:a.id})},icon:o.pop?{type:"folder",subtype:a.flags.iconSubtype,xtype:"icon"}:void 0}}}));var c=[],l=!1;return $.Object.each(r,(function(e,t){var i=t.length>0;l&&i&&c.push({type:"split"}),l=l||i;for(var a=0,n=t.length;a<n;a++)c.push(t[a])})),n[n.length]={items:c},n[n.length]={items:[{text:p.t("æ–°å»ºæ–‡ä»¶å¤¹å¹¶ç§»åŠ¨"),click:function(){e.log("toolbar","move",2),Promise.resolve().then(i.bind(i,92862)).then($.Function.bind((function(t){t.default.add({callback:function(t){e.log({action:"click",item:"menu_move_new",value:$.Support.getStatsMailinfo({target_folder:t.toString()})}),e.moveTo({toFid:t})}})})))}}]},a},getOptionConf:function(){var e=this.module,t="2"===$.Ud.get({field:"ntes_option",flag:"sendershow"}),a="1"===$.Ud.get({field:"ntes_letter",flag:"read_head"}),n=0===(0,c.$S)("attrs").user.afterdel,o="1"===$.Ud.get({field:"ntes_option",flag:"readRange"}),s=($.Ud.get({field:"ntes_read",flag:"mail_service"}),{extcls:"nui-settingMenu",delegateTo:"self",groups:[{items:[{text:p.t("å‘/æ”¶ä»¶äººæ˜¾ç¤º"),extText:{xtype:"checkgroup",checkType:"radio",name:"sendershow",checkedchange:function(t){e.log({action:"click",item:"menu_sendershow",value:t}),r.setAttr({field:"ntes_option",flag:"sendershow",value:t,module:"contact"})},items:[{id:e.createId("opt_send"),text:p.t("å‘ä»¶äººå§“å"),value:1,check:e.cretHide:!0},{text:p.t("è¿›è¡Œç§»åŠ¨æˆ–åˆ é™¤é‚®ä»¶å"),extText:{xtype:"checkgroup",checkType:"radio",name:"afterdel",checkedchange:function(t){e.log({action:"click",item:"menu_aftermove",value:t}),r.setAttr({field:"afterdel",value:t,module:"read"})},items:[{id:e.createId("opt_next"),text:p.t("è¯»ä¸‹ä¸€å°"),value:1,checked:!n,subclass:"btn"},{id:e.createId("opt_back"),text:p.t("è¿”å›åˆ—è¡¨"),value:0,checked:n,subclass:"btn"}]},doNotHide:!0}]}]});return e.isThread||s.groups[0].items.unshift({text:p.t("é»˜è®¤æ˜¾ç¤ºå®Œæ•´/ç²¾ç®€ä¿¡æ¯"),extText:{xtype:"checkgroup",checkType:"radio",name:"read_head",checkedchange:function(t){e.log({action:"click",item:"menu_headershow",value:t}),r.setAttr({field:"ntes_letter",flag:"read_head",value:t,module:"read"})},items:[{id:e.createId("opt_fullInfo"),text:p.t("å®Œæ•´ä¿¡æ¯"),value:0,checked:!a,subclass:"btn"},{id:e.createId("opt_compactInfo"),text:p.t("ç²¾ç®€ä¿¡æ¯"),value:1,checked:a,subclass:"btn"}]},doNotHide:!0}),s.groups[0].items.push({text:p.t("å¯¹é€‰ä¸­å†…å®¹è¿›è¡Œè½¬å‘æˆ–å›å¤"),extText:{xtype:"checkbox",name:"readRange",checked:o,subclass:"switch",text:p.t("å¼€å¯"),unCheckText:p.t("å…³é—­:0;e.log({action:"click",item:"menu_range",value:i}),r.setAttr({field:"ntes_option",flag:"readRange",value:i,module:"read"})}},doNotHide:!0}),s.groups[0].items.push({gap:"before",text:p.t("æ›´å¤šè®¾ç½® ")+">>",click:function(){e.log({action:"click",item:"menu_options"}),Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"options.BaseSetModule"})})))}}),{items:[{id:e.createId("optionMenu"),xtype:"button",subclass:"roundBtn",icon:"setting",title:p.t("å¿«æ·è®¾ç½®"),menu:s,click:function(){e.log({action:"click",item:"toolbar_option"})}}],type:"ext"}},getTempLinkHtml:function(e){return'<a href="" target="_blank" id="'+e.createId("aTempLink")+'" rel="noreferrer"></a>'},getContactConf:function(e){var t,i=this.module,a=$.Uri.getEmails(e,"Email",!0).match;return"-"!==(t=a.length>0?a[0]:{name:e,address:""}).name.substr(0,1)&&"+"!==t.name.substr(0,1)||(t.defaultName=t.name=t.name.substr(1)),{email:t,popupRenderTo:this.module.container,listeners:{subAction:function(e){i.log({action:"click",item:"addr_"+e})}},hideVipIcon:!0}},updateToolbar:function(e){try{var t=$.Toolbar.html(this.getToolbarConf(e));$.fly(this.module.container).find(".frame-main-cont-head").html(t)}catch(e){}},updateSubject:function(e){var t=this.module,i=t.getDom("h1Subject");if(e&&e.group)if(n=t.getDom("h1SubjectTag"))$(n).show();else{var a="ad"===e.group?p.t("æ¨å¹¿"):p.t("è®¢é˜…");$(i).after('<div id="'+t.createId("h1SubjectTag")+'" class="vG0">'+a+"</div>")}else{var n=t.getDom("h1SubjectTag");$(n).hide()}}}),t.Z=a},88645:function(e,t,i){i(8600),i(55737),i(42295),i(52963),i(92274),i(75654),i(79150),i(803),i(26340),i(36809),i(87553);var a,n=i(72957),o=i(60157),r=i(26729),s=i(26437),c=i(53357),l=i(39567),d=i(8444),u=i(1124),m=i(81229),p=i(20313),f=new n.c1("module.read.MailReader");a=$.createClass((0,n.$N)("module.read.MailReader")),$.Object.extend(a.prototype,{initialize:function(e){var t,i=this;$.Object.extend(i,e);var a=i.folderData,s=(0,n.$S)("attrs").user.junkpic||0;i.junkPic=2===s||1===s&&5===i.fid,t=i.module||i.threadItem.module,$.Ext.read_noSsidRead?i.baseUrl="read/readhtml.jsp?mid="+i.mid:i.baseUrl=$G.environment.readUrl+"&mid="+i.mid;var d=(0,n.$S)("ad").userType;"ud"!==d&&Math.random()>.5&&(d="ud"),i.baseUrl+="&userType="+d,i.view=new o.Z(i),i.body=new r.Z(i),i.assistant=new c.Z(i),i.isDecrypted=l.Z.isDecrypted(i.mid),(3===i.fid||void 0===a||(a.flags||{}).read)&&(i.receiptSended=!0),i.isThread?(i.createId=function(e){return t.createId(i.threadToken+e)},i.getDom=function(e){return t.getDom(i.threadToken+e)}):(i.createId=$.Function.bind(t.createId,t),i.getDom=$.Function.bind(t.getDom,t))},init:function(){var e=this,t=e.folderData.ctrls||{},i=e.fid;if(!e.module.resourcePreloaded){e.setAttachObj();var n=e.isThread||"1"===$.Ud.get({field:"ntes_letter",flag:"read_head"});e.showHeader(n),n&&e.showHeader(!n,n)}if(e.initMailService(),e.initBody(),e.showAttach(),p.Z.getDATagInfo({tags:e.folderData.tag||[],callback:function(t){e.showTips(),"ad"!==t.group&&"sub"!==t.group||e.module.isThread||(e.module.view.updateToolbar(t),e.module.view.updateSubject(t))}}),window.mailTeam)e.showMailTeam(),e.showMailTeamTask();else var o=0,r=setInterval((function(){o>20&&clearInterval(r),window.mailTeam&&(clearInterval(r),e.showMailTeam(),e.showMailTeamTask()),o++}),200);if(e.fillReplyInput(),e.inited=!0,e.exeInitCall(),$.Component.setEvents(50),e.mailTracking&&e.initMailTracking(),t.encrypt&&3===i&&e.initMailEncrypt(t.encrypt,e.getDom("dvReadMailEncrypt")),e.updateExtendInfo(),window.setTimeout((function(){e.assistant.sendReceipt()}),1e3),!a.downloadFramInited){var s="downloadFrame",c=$.Element.create("iframe",s).attr({name:s,frameborder:"0",src:"about:blank"}).css({display:"none"});document.body.appendChild(c.dom),a.downloadFramInited=!0,c.destroy()}},isMailServiceAvailable:function(){return"1"!==$.Ud.get({field:"ntes_read",flag:"mail_service"})},initMailService:function(){var e=this;e.isServiceMail&&e.isMailServiceAvailable()&&e.assistant.loadMailServiceContent((function(){e.mailServiceLoaded=!0}))},initMailTracking:function(e){this.view.setSubjectMailTrackingHtml()},initMailEncrypt:function(e,t){if(!window.encryptBannerLoading){var i=this;window.encryptBanner?window.encryptBanner({includeBox:t,encryptId:e,hl:$G.environment.isCh?"zh-CN":"en-US",showToast:function(e){$.Tips.show(e)},onStat:function(e,t){var i={};i[e]=t,$.Log.cache(i)}}):(window.encryptBannerLoading=!0,$.Support.loadScript("https://mimg.127.net/freemail/encrypt-banner/encrypt-banner-0.1.1.js",(function(){window.encryptBannerLoading=!1,window.encryptBanner&&i.initMailEncrypt(e,t)}),(function(){window.encryptBannerLoading=!1})))}},initBody:function(){this.body.init()},setAttachObj:function(){var e=this,t=e.data.attachments||[];if(e.commonAttached&&0===t.length?e.resetAttachFlag(!1):!e.commonAttached&&t.length>0&&$.Array.each(t,(function(t,i){if(!i.inlined)return e.attached=e.commonAttached=!0,$.BREAK})),e.attached){e.attach=new s.Z(e);try{var i=!1,a=e.folderData;if(a&&a.ctrls&&a.ctrls.plus){var n=a.ctrls.plus,o=$.Uri.getEmails(a.from,void 0,!0).match[0].address,r=o.split("@")[0],c=o.split("@")[1],l=n.split("_"),d=l[0];l[1]===m.default.encode(r+d+c)&&(i=!0)}e.isFromPlus=i}catch(e){}}},showHeader:function(e,t){var i=this,a=i.getDom("ulCompact"),n=i.getDom("ulFull"),o=i.getDom("dvSystemCert");e?(t||(n.style.display="none",a.style.display="",o.style.display="none"),i.compactHeaderInited||(a.innerHTML=i.view.getCompactHeadHtml(),i.compactHeaderInited=!0,i.module.updateUserLabel())):(t||(a.style.display="none",n.style.display="",o.style.display=""),i.fullHeaderInited||(n.innerHTML=i.view.getFullHeadHtml(),i.fullHeaderInited=!0)),setTimeout((function(){i.updateExtendInfo()}),500)},resetReceiverText:function(){var e=this.folderData;if(e.composeExtra&&e.composeExtra.showOneRcpt){var t=this.getDom("liReadOutto");null!==t&&(t.firstChild.innerHTML=f.t("ç¾¤å‘å•æ˜¾:"),$.fly(t.parentNode.parentNode).addClass("fM1"))}},resetAttachFlag:function(e){var t=this,i=this.module,a=t.folderData.flags||{};i.commonAttached=t.commonAttached=!!a.attached&&!(a.inlineAttached&&!a.realAttached)&&(void 0===e||e),i.cloudAttached=t.cloudAttached=!!a.linkAttached,i.attached=t.attached=t.commonAttached||t.cloudAttached,i.mailTracking=t.mailTracking=$.Ext.mailTracking&&3!==t.folderData.rclStatus;try{var n=u.default.getSendInfo(t.folderData);1!==n.ext.status&&3!==n.ext.status&&(i.mailTracking=t.mailTracking=!1)}catch(e){}},showAttach:function(){var e=this,t="";e.attached?(e.commonAttached&&!e.getDom("dvAttachHead")&&e.view.getAttachListHtml(!0),e.attach.init()):t="none",e.getDom("dvAttachBody").style.display=t},updateInlineAttach:function(e){var t=this;if(t.commonAttached&&!t.attach.inlineAttachFound&&!t.inlineChecked){for(var i,a=e.length,n=t.data.attachments||[],o=n.length,r={},s=0;s<o;s+=1)r[(i=n[s]).id+""]=i.filename;if(a>0){for(var c,l,d=!1,u=[],m=0;m<a;m+=1){(l=e[m]).id=l.id+"";var p=r[l.id],f=p.indexOf(".")>-1?p.split(".").pop().toLowerCase():" ";if(l.filename=p,l.inlined&&"cmecypt"!==f){var h=t.getDom(l.id+"");h&&(c=h.parentNode.parentNode,$.fly(h).remove()),d=!0}else u.push(l)}if(d)if(t.data.attachments=u,t.resetAttachFlag(u.length>0),0===u.length)if(t.cloudAttached)t.attach.updateHeaderInfo(),$.fly(t.getDom("dvAttachHead")).remove(),$.fly(c).remove();else{$.fly(t.getDom("dvAttachBody")).remove(),$.fly(t.getDom("attachInfo_full").parentNode).remove();try{$.fly(t.getDom("attachInfo_compact")).remove()}catch(e){}}else t.getDom("dvAttachHead").innerHTML=t.view.getAttachHeader(u.length),t.attach.updateHeaderInfo();t.inlineChecked=!0}}},fillReplyInput:function(){var e=(0,n.$C)(this.createId("replyInput")),t=this.view.getReplyNotice(),i=t+f.t("ï¼ˆæŒ‰Ctrl+Enteré”®å‘é€ï¼‰");e.showPlaceholder(t),e.getEl().attr({title:i,"aria-label":i})},showTips:function(){var e=this,t=e.data,i=e.folderData,a=i.flags||{},o=i.tag||[],r=e.fid,s=[],c=t.from;c=c instanceof window.Array?c[0]:c.toString();var d="";t.headers&&t.headers.From&&(d=t.headers.From);var m=$.Uri.getAddress(c),p=$.Uri.getAddress(d),h=!1,g=!1;try{for(var v=(0,n.$S)("mailRiskDataConfig"),b=$G.environment.isCh?"cn":"en",y=0;y<o.length;y++){var x=$.Array.findObject(v.mailRiskInfos,"key",o[y]);if(x&&x.riskLevel>1&&!$.Array.has(o,"%st_m_graydone%")&&(5!==r||0===o[y].indexOf("%st_"))){g=!0,$.Log.cache({read_blockinfo_fake_show:{value:e.mid,sentDate:+i.sentDate,receivedDate:+i.receivedDate,tag:o[y]}}),s.push(e.addBlockInfo("DAGray",!0,{type:2===x.riskLevel?"forbid":"alert",title:x.riskInfo.title?x.riskInfo.title[b]:"",desc:x.riskInfo.desc[b],okText:x.riskInfo.btn[0][b],cancelText:x.riskInfo.btn[1][b]}));break}}}catch(e){}if($.Array.has(o,"%st_sys_sens%"))s.push(e.addBlockInfo("SensWarn",!0)),$.Log.cache({read_blockinfo_sens_show:{value:e.mid,sentDate:+i.sentDate,receivedDate:+i.receivedDate}}),g=!0;else{if(void 0!==t.antispamInfo){var k=$.String.trim((t.antispamInfo.RulesType+"").toLowerCase());0!==k.indexOf("fake")&&0!==k.indexOf("ntesfake")||(s.push(e.addBlockInfo("systemWarn",!0)),h=!0)}5!==r||h||s.push(e.addBlockInfo("spamFolder",!0))}if(a.realAttached&&!e.part&&0===(t.attachments||[]).length&&s.push(e.addBlockInfo("attachWrong",!0)),18===r&&a.read&&s.push(e.addBlockInfo("subscribe",!0)),3===r||-1===r&&3===i.fid){var S=u.default.getSendInfo(i);S&&s.push(e.addBlockInfo("sendStatus",!0,{info:S}))}else{var w,T,C=[];a.replied&&(C.push(f.t("å›å¤")),T="re"),a.forwarded&&(C.push(f.t("è½¬å‘")),T=void 0===T?"fw":"refw"),(w=C.join(f.t("ä¸”"))).length>0&&s.push(e.addBlockInfo("mailStatus",!0,{msg:f.t("é‚®ä»¶å·²è¢«")+w+"&nbsp;&nbsp;",icon:T}))}if(e.isEncrypted&&(e.decryption=new l.Z(e),s.push(e.addBlockInfo("decryptForm",!0))),3===r&&a.encrypted&&i.encpwd&&s.push(e.addBlockInfo("decryptPwd",!0,{pwd:i.encpwd})),e.junkPicTip&&(s.push(e.addBlockInfo("junkPic",!0)),delete e.junkPicTip),5!==r)if(p&&/@.*xn--/i.exec(p))s.push(e.addBlockInfo("fromAttack",!0,{from:p}));else if(""===m||/[^a-zA-Z0-9.@_-]/.exec(m)){var _="";try{_=c.match(/<([^<]+)>/)[1]}catch(e){}s.push(e.addBlockInfo("fromAttack",!0,{from:_}))}s.length>0&&$.fly(e.getDom("dvBlockInfo")).show().html(s.join("")),e.tipsComplete=!0,(h||g)&&(e.errorMailWarn=!0)},showMailTeam:function(e){var t=this,i=(t.data,t.folderData),a=(i.flags,e||i.tag||[]);if(t.fid,window.mailTeam){for(var n="",o="",r="",s=0;s<a.length;s++){var c=a[s],l=c.match(/^%tc_task_+)%$/);d&&(o=d[1]);var u=c.match(/^%tc_task_status#(.+)%$/);u&&u[1]&&(r=u[1])}if("origin"===n){var m=t.getDom("dvReadMailTeam");m.style.display="block",mailTeam.renderTaskDetail({hl:$G.environment.hl,renderId:m.id,taskId:o,taskStatus:r,onError:function(){},onSuccess:function(){}})}}},showMailTeamTask:function(e){var t=this,i=(t.data,t.folderData),a=(i.flags,e||i.tag||[]);if(t.fid,window.mailTeam){for(var o="",r="",s="",c="",l="",d="",m=0,p=0,f="",h=0;h<a.length;h++){var g=a[h],v=g.match(/^%tc_task_id#(.+)%$/);v&&(r=v[1]);var b=g.match(/^%tc_task_m_type#(.+)%$/);b&&(o=b[1]);var y=g.match(/^%tc_task_creator#(.+)%$/);y&&(s=y[1]);var x=g.match(/^%tc_task_tm_mid#(.+)%$/);x&&(c=x[1]);var k=g.match(/^%tc_task_tm#(.+)%$/);k&&(f=k[1]);var S=g.match(/^%tc_task_e_status#(.+)#todo%$/);S&&(m++,S[1]!==(0,n.$S)("uid")&&S[1]!==(0,n.$S)("orgUid")||(d="todo"));var w=g.match(/^%tc_task_e_status#(.+)#done%$/);w&&(p++,w[1]!==(0,n.$S)("uid")&&w[1]!==(0,n.$S)("orgUid")||(d="done"));var T=g.match(/^%tc_task_status#(.+)%$/);T&&T[1]&&(l=T[1])}if("task"===o&&d){var C=t.getDom("dvReadMailTeamTask");C.style.display="block",mailTeam.renderTaskMailAction({hl:$G.environment.hl,renderId:C.id,isCreator:s===(0,n.$S)("uid")||s===(0,n.$S)("orgUid"),mid:t.mid,tmMid:c,taskStatus:l,excurtorTaskStatus:d,doneNum:p,excutorNum:m+p,currentTaskId:r,currentTags:a,onError:function(e){},onSuccess:function(e){u.default.getLetterData({moduleName:t.listModule,mid:t.mid,refersh:!0,callback:function(e){if(e){e.id=t.mid,t.module.folderData=t.folderData=e;var i={};i[t.mid]=!0,$.Listener.fire("letter:update",{list:i,action:"mailteam",data:[e]})}}})},onClick:function(e){t.log({action:"click",item:"mail_task_"+e})},onReadSourceMail:function(){t.log({action:"click",item:"mail_task_source"}),window.sessionStorage.setItem("onReadSourceMail",c),$.Support.teamMailSwitch({uid:f,type:1})}})}}},addBlockInfo:function(e,t,i){var a,o=this,r=o.view.getBlockConf(e,i);if(void 0!==r){if(t)return $.Block.html(r);if(void 0!==(0,n.$C)(o.createId(e)))return;(a=o.getDom("dvBlockInfo")).style.display="",new $.Block(r).render(a),a=void 0}},translate:function(e){var t=this;if(t.locked)0===e.type&&$.Msgbox.show({statsKey:"Read_NoGuide_Popup_TranslateFail",title:f.t("æŠ±æ­‰ï¼Œå·²åŠ é”é‚®ä»¶æš‚ä¸æ”¯æŒå…¨æ–‡ç¿»è¯‘ã€‚"),header:f.t("ç³»ç»Ÿæç¤º")});else if(void 0===t.translator&&(t.translator=new d.Z(t)),e.check){if(t.isServiceMail&&t.isMailServiceAvailable())return;var i;if(!/^[A-Za-z\s`~!@#\$%\^\-\&\*\(\)_\+<>\?:"\{\},\.\\\/;'\[\]]+$/.test(t.folderData.subject)){if((i=t.body.getB(t.body.getBodyText().slice(0,499).match(/\b[A-Za-z]+\s/gi)||[]).length<20)return}t.translator.check()}else t.translator.translate(e.type),t.log({action:"click",item:"trans_tip"})},getFrameUrl:function(){var e=this,t=e.baseUrl;return e.junkPic&&(t+="&filterImages=on"),e.isHidden&&(t+="&preventSetRead=on"),e.part&&(t+="&part="+e.part),document.body.className.indexOf("ua-noYaHei")<0&&(t+="&font=15"),void 0!==e.bodyEncoding&&(t+="&encoding="+e.bodyEncoding),t+="&color="+$G.user.color,(3===e.fid||e.part)&&(t+="&ignoreMailTracking=1"),t},addInitCall:function(e,t){var i=this,a=void 0===t?e:function(){window.setTimeout(e,t)};if(i.inited)a();else{var n=i.initCalls;void 0===n&&(i.initCalls=n=[]),n.push(a)}},exeInitCall:function(){var e=this.initCalls;if(void 0!==e){for(;e.length>0;)try{e.shift()()}catch(e){}delete this.initCalls}},focusSubject:function(){try{this.getDom("h1Subject").focus()}catch(e){}},log:function(){var e=this.module;e.log.apply(e,arguments)},destroy:function(){return!0},updateExtendInfo:function(){for(var e=this,t=e.data.from,i=e.module.fromLabel,a=e.folderData.tag||[],o="",r=!1,s=!1,c=0;c<a.length;c++){var l,d=a[c];if(l=d.match(/^%ex_tc_logo_(.+)%$/)){o=l[1],r=!0;break}if(l=d.match(/^%ex_mkt_logo_(.+)%$/)){o=l[1],s=!0;break}}if(r){t=t instanceof window.Array?t[0]:t.toString();var u=$.Uri.getAddress(t);(0,n.$I)("init.Contacts").getTeamCorpInfo([{teamId:o,sender:u}],(function(e){var t=e[[u,o].join("_")];if(t){var a="";t.teamStatus?t.senderStatus||(a=f.t("ï¼ˆå·²ç¦»èŒï¼‰")):a=f.t("ï¼ˆå·²å¤±æ•ˆï¼‰"),i.setExtLink($.Link.html({text:"@"+t.teamName+a,click:function(){$.Log.cache({userlabel_teamCorp_click:1}),opent instanceof window.Array?t[0]:t.toString(),u=$.Uri.getAddress(t),(0,n.$I)("init.Contacts").getMarketingInfo([{teamId:o,sender:u}],(function(e){var t=e[[u,o].join("_")];if(t){var a="";if(0===t.status)return;2===t.status&&(a=f.t("ï¼ˆå·²å¤±æ•ˆï¼‰")),i.setExtLink($.Link.html({text:"@"+t.ename+a,click:function(){$.Log.cache({userlabel_marketing_click:1}),open(t.link,"_blank")}}))}})))}}),t.Z=a},53357:function(e,t,i){i(68233),i(37092),i(92274),i(66403),i(79150),i(42295),i(52963),i(34994),i(75654),i(803),i(48868),i(63045),i(81874),i(54861),i(55737),i(66251),i(80153);var a,n=i(72957),o=i(64560),r=i(54107),s=i(1124),c=i(27018),l=i(88641),d=i(81229),u=i(92066),m=i(96540),p=new n.c1("module.read.MailReaderAssistant");a=$.createClass((0,n.$N)("module.read.MailReaderAssistant")),$.Object.extend(a,{replyTitleText:["Re:","Reply:",p.t("å›å¤:"),p.t("ç­”å¤:")],forwardTitleText:["Fw:","Forward:",p.t("è½¬å‘:")],replyBodyText:[[p.t("åœ¨ "),p.t(" å†™é“ï¼š"),p.t("ï¼Œ")],["At "," wrote:",", "]],forwardBodyText:[[p.t("å‘ä»¶äººï¼š"),p.t("å‘é€æ—¥æœŸï¼š"),p.t("æ”¶ä»¶äººï¼š"),p.t("æŠ„é€äººï¼š"),p.t("ä¸»é¢˜ï¼š"),"-------- è½¬å‘é‚®ä»¶ä¿¡æ¯ --------"],["From: ","Date: ","To:  ","Cc:  ","Subject: ","-------- Forwarding messages --------"]],netFolderError:{800:p.t("æ–‡ä»¶ä¸­å¿ƒå®¹é‡è¶…å‡ºé™åˆ¶"),801:p.t("æ–‡ä»¶ä¸­å¿ƒæ–‡ä»¶æ€»æ•°è¶…å‡ºé™åˆ¶"),802:p.t("æµé‡è¶…å‡ºé™åˆ¶"),803:p.t("ç™»å½•è¶…æ—¶ï¼Œé‡æ–°ç™»å½•"),500:p.t("æœªçŸ¥é”™è¯¯")}}),$.Object.extend(a.prototype,{initialize:function(e){this.reader=e},reply:function(e){var t=this,i=t.reader;if(e=e||{},!t._checkReplyTo($.Function.bind(t.reply,t,e))){var a,n={withAttachments:e.withAttachments},o="reply";switch(e.type){case"simple":n={toAll:!0,content:e.content},o="quickReply";break;case"all":n.toAll=!0;break;case"new":a={param:{info:{to:i.from.concat(i.to||[]),cc:i.cc,bcc:i.bcc}}},o="entry";break;case"fragment":n={fragment:!0,toAll:!0,content:e.content};break;default:n.content=e.content}(a=a||{id:i.mid,body:t._getReplyBody(n),callback:function(t){e.call&&e.call(t.code===$.S_OK)}}).lang=i.lang,r.default[o](a,void 0)}},fullReply:function(e){var t=this,i=t.reader;if(!t,t,e))){e=e||{};var a=!0,r=i.localSender.concat(i.localReceiver),s=(0,n.$S)("uid");3===i.fid||0===r.length?a=!1:$.Array.each(r,(function(e,t){var i=t.address;if(i===s||o.default.isSender(i)||i.indexOf("groups.163.com")>-1||i.indexOf("g.qq.com")>-1||i.indexOf("googlegroups.com")>-1)return a=!1,$.BREAK})),e.type=e.type||"all",a?$.Msgbox.show({statsKey:"Read_Guide_Popup_ReplyAll",header:p.t("æ¸©é¦¨æç¤º"),content:p.t("æ‚¨ä¸åœ¨æ­¤é‚®ä»¶çš„æ”¶ä»¶äººåå•ä¸­ï¼Œå¦‚å›å¤å…¨éƒ¨ï¼Œåˆ™å…¶ä»–æ”¶ä»¶äººä¼šçŸ¥é“æ‚¨æ”¶åˆ°äº†æ­¤é‚®ä»¶ï¼æ˜¯å¦è¦å›å¤å…¨éƒ¨æ”¶ä»¶äººï¼Ÿ"),buttons:[{xtype:"button",text:p.t("å›å¤å‘ä»¶äºº"),subclass:"mainBtn",click:function(){e.type=void 0,t.reply(e),Guide_Popup_ReplyAll_sender:1})}},{xtype:"button",text:p.t("å›å¤å…¨éƒ¨"),click:function(){t.reply(e),$.Msgbox.msgbox.close(),$.Log.cache({Read_Guide_Popup_ReplyAll_all:1})}},{xtype:"button",text:p.t("å–æ¶ˆ"),click:function(){$.Msgbox.msgbox.close(),$.Log.cache({Read_Guide_Popup_ReplyAll_cancel:1})}}]}):t.reply(e)}},forward:function(e){var t,i=this.reader;t={id:i.mid,body:this._getForwardBody(e||{}),lang:i.lang},r.default.forward(t,void 0)},originalForward:function(){var e,t=this.reader,i=$.Msgbox.show({contentType:"normal",type:"prompt",header:p.t("åŸä¿¡è½¬å‘"),inputLabel:p.t("æ”¶ä»¶äººï¼š"),inputPlaceholder:p.t("è¯·è¾“å…¥è½¬å‘åœ°å€"),footer:p.t("æç¤ºï¼šåŸä¿¡è½¬å‘é‚®ä»¶ä¸èƒ½æ’¤å›"),autoFocus:!0,okText:p.t("å‘ é€"),ok:function(e){if(0===(e=$.String.trim(e)).length)return p.t("è¯·å¡«å†™è½¬å‘åœ°å€ã€‚");var i=$.Uri.getEmails(e);if(i.wrong.length>0)return p.t("è¯·å¡«å†™æ­£ç¡®çš„è½¬å‘åœ°å€ã€‚");if(i.match.length>1)return p.t("åªèƒ½è¾“å…¥ä¸€ä¸ªè½¬å‘åœ°å€ã€‚");var n={mode:"transmit",attrs:{bcc:e}};t.part&&(n.part=window.parseInt(t.part)),r.default.quickForward({id:t.mid,body:n,callback:a})},close:function(){try{e._remove()}catch(e){}}}).find("input")[0];function a(e){e.code===$.S_OK&&$.Msgbox.show({header:p.t("åŸä¿¡è½¬å‘"),title:p.t("è½¬å‘æˆåŠŸ ")})}$.fly(i.getEl().dom.parentNode).append("<div>"+$.Label.html({type:"tips",text:p.t("(å¦‚ï¼šzhangsan@example.com)")})+"</div>"),i.unlisten("enter"),e=new l.Z({isTop:!0,input:i.getInputEl(),inputDiv:i.getEl(),match:function(e,t){var i=t.name,a=t.email;if((e=$.String.trim(e))&&(i.indexOf(e)>-1||a.indexOf(e)>-1))return i?'"'+i+'"<'+a+">":a}})},setFlag:function(e){var t=this.reader,i=t.folderData;s.default.setFlag({flag:-1===e?i.label0?0:1:e,moduleName:t.module.listModule,data:i,area:t.area})},editMemo:function(e){var t=this.reader;if(e)return $.fly(t.getDom("memo")).empty().replace(t.view.getMemoHtml()),void $.Component.setEvents();t.showHeader(),t.getDom("memoText").style.display="none",$.fly(t.getDom("memoEditor")).html(t.view.getMemoEditorHtml()).show().dom.parentNode.style.display="",$.Component.setEvents(),(0,n.$C)(t.createId("memoInput")).fire("keyup")},setMemo:function(e){var t=this.reader,i={moduleName:t.listModule,memo:e.value,data:t.folderData};s.default.setMemo(i)},sendReceipt:function(){var e=this.reader;if(!e.isHidden&&!e.receiptSended){var t=$.Ud.get({field:"op_readreceipt"}).toString(),i=e.data;void 0!==i&&i.requestReadReceipt&&("0"===t?$.Msgbox.show({type:"confirm",header:p.t("å·²è¯»å›æ‰§"),title:$.String.escapeHTML(e.localSender[0].toString())+p.t("è¦æ±‚å‘é€â€œå·²è¯»å›æ‰§â€ï¼Œæ˜¯å¦å‘é€ï¼Ÿ"),okText:p.t("å‘é€"),cancelText:p.t("ä¸å‘é€"),ok:function(){(0,n.$C)("readReceiptAways").getChecked()&&$.Ud.set({field:"op_readreceipt",value:"2"}),e.module.action.sendReceipt(e.mid)},cancel:function(){(0,n.$C)("readReceiptAways").getChecked()&&$.Ud.set({field:"op_readreceipt",value:"1"})},content:$.Checkbox.html({id:"readReceiptAways",text:p.t("ä»¥åéƒ½æŒ‰è¿™æ¬¡æ“ä½œï¼Œä¸å†æç¤º")})}):"2"===t&&e.module.action.sendReceipt(e.mid)),e.receiptSended=!0}},recall:function(e){var t,i=this,a=i.reader,o=a.data,r=a.folderData,c="jy0",l=[{text:p.t("å·²å‘é€é‚®ç®±åœ°å€")},{text:p.t("çŠ¶æ€")}],u=$G.user.allowRecallBeforeDays||15,f=$.Misc.getTime(0)-(a.folderData.sentDate||o.sentDate);function h(e){var i=e.code,o=e.var.recallresult,d=p.t("å·²æ‰§è¡Œæ’¤å›æ“ä½œï¼Œç»“æœå¦‚ä¸‹"),m=p.t("æ’¤å›å¤±è´¥"),f={0:p.t("æ’¤å›ä¸­ï¼Œè¯·ç¨åæŸ¥çœ‹è¯¦æƒ…"),1:p.t("æ’¤å›ä¸­ï¼Œè¯·ç¨åæŸ¥çœ‹è¯¦æƒ…"),2:p.t("æˆåŠŸæ’¤å›"),3:p.t("æˆåŠŸæ’¤å›"),4:m,5:m,6:m,7:m,8:m,9:m,14:m,15:m};if("FA_UNSUPPORT_RECALL"!==i)if("FA_MAIL_EXPIRED"!==i){r.recalled=!0,r.rclStatus&&(d=p.t("æ’¤å›æŸ¥è¯¢å·²ç»å®Œæˆï¼"));var h=[-1,-1,-1],g=[];$.Object.each(o,(function(e,t){1===t?(-1===h[0]&&(h[0]=1),h[0]=h[0]&&!0):2===t||3===t?(-1===h[1]&&(h[1]=1),h[1]=h[1]&&!0):(-1===h[2]&&(h[2]=1),h[2]=h[2]&&!0),g.push([{text:e},{text:'<span class="'+(1===t?"nui-txt-normal":2===t||3===t?"nui-txt-suc":"nui-txt-err")+'">'+f[t]+"</span>"}])})),h[0]&&-1!==h[0]?r.rclStatus=1:h[1]&&-1!==h[1]?h[2]&&-1!==h[2]?r.rclStatus=5:r.rclStatus=3:r.rclStatus=4,r.rclStatus&&r.rclStatus>0&&(r.rclStatus<3?p.t("é‚®ä»¶æ’¤å›ä¸­"):3===r.rclStatus?p.t("æ’¤å›æˆåŠŸ"):4===r.rclStatus?p.t("æ’¤å›ä¸æˆåŠŸ"):5===r.rclStatus&&p.t("éƒ¨åˆ†æˆåŠŸ"));var v=(0,n.$C)(a.createId("sendStatus"));v&&v.update(a.view.getBlockConf("sendStatus",{info:s.default.getSendInfo(a.folderData)})),t.update({title:d,content:$.Table.html({subclass:"simpleTable",headCells:l,bodyCells:g})}),t.buttons.cancel.hide(),t.buttons.ok.update({text:p.t("æŸ¥çœ‹è¯¦æƒ…")}),t.listen("ok",(function(){try{(0,n.$C)(a.createId("readCheckStatus")).fire("click")}catch(e){}})),$.Listener.fire("read:recall",a.mid)}else $.Msgbox.show({statsKey:"Read_NoGuide_Popup_WithdrawFailTime",header:p.t("ç³»ç»Ÿæç¤º"),title:p.t("å¾ˆæŠ±æ­‰ï¼Œè¯¥é‚®ä»¶ä¸èƒ½è¢«æ’¤å›"),content:"<p>"+p.t("æ­¤é‚®ä»¶è·å‘é€æ—¶å·²è¶…è¿‡")+u+p.t("å¤©ï¼Œæ— æ³•æ’¤å›ã€‚")+"</p>"});else $.Msgbox.show({statsKey:"Read_NoGuide_Popup_WithdrawUnsupport",cls:c,title:p.t("è¿™å°é‚®ä»¶æ— æ³•æ’¤å›ï¼")})}u&&f>24*u*3600*1e3?$.Msgbox.show({statsKey:"Read_NoGuide_Popup_WithdrawFailTime",header:p.t("ç³»ç»Ÿæç¤º"),title:p.t("å¾ˆæŠ±æ­‰ï¼Œè¯¥é‚®ä»¶ä¸èƒ½è¢«æ’¤å›"),content:"<p>"+p.t("æ­¤é‚®ä»¶è·å‘é€æ—¶å·²è¶…è¿‡")+u+p.t("å¤©ï¼Œæ— æ³•æ’¤å›ã€‚")+"</p>"}):r.recallable?r.recalled||r.rclStatus?$.Msgbox.show({statsKey:"Read_Guide_Popup_WithdrawFailDone",title:p.t("é‚®ä»¶å·²è¢«æ’¤å›"),content:"<p>"+p.t("å¦‚éœ€æŸ¥çœ‹æ’¤å›ç»“æœï¼Œè¯·ç‚¹å‡»â€œæŸ¥çœ‹æ’¤å›ç»“æœâ€ã€‚")+"<br /><br />"+$.Link.html({text:p.t("æŸ¥çœ‹æ’¤å›ç»“æœ>>>"),click:function(){try{$.Msgbox.msgbox.close(),$.Log.cache({Read_Guide_Popup_WithdrawFailDone_link:1}),(0,n.$C)(a.createId("readCheckStatus")).fire("click")}catch(e){}}})+"</p>",okText:p.t("æˆ‘çŸ¥é“äº†"),cancel:function(){}}):$.Msgbox.show({statsKey:"Read_NoGuide_Popup_WithdrawConfirm",type:"confirm",title:p.t("æ‚¨ç¡®å®šè¦æ’¤å›æ­¤é‚®ä»¶å—ï¼Ÿ"),cls:c,content:['<p class="nui-item-spc1x">'+p.t("é‚®ä»¶æ’¤å›è¯¦ç»†è¯´æ˜ï¼š")+"</p>",'<p class="nui-item-spc1x">'+p.t("1. æ’¤å›åŠŸèƒ½å¼€é€šåå‘é€çš„é‚®ä»¶æ‰æ”¯æŒæ’¤å›ï¼›")+"</p>",'<p class="nui-item-spc1x">'+p.t("2. é‚®ä»¶å‘é€æœªè¶…è¿‡")+u+p.t("å¤©ï¼Œåœ¨å¯¹æ–¹æœªè¯»(æˆ–æ˜¾ç¤ºæœªè¯»çŠ¶æ€)ï¼Œæœªè¢«å¯¹æ–¹ä»é‚®ä»¶å®¢æˆ·ç«¯(æ¯”å¦‚Outlookï¼ŒFoxmail)æ”¶å–è¿‡ï¼Œæ‰æ”¯æŒæ’¤å›ï¼›")+"</p>",'<p class="nui-item-spc1x">'+p.t("3. æ’¤å›æˆåŠŸåï¼Œå¯¹æ–¹çœ‹åˆ°çš„é‚®ä»¶å°†è¢«æ¸…é™¤ï¼Œæ’¤å›çš„ç»“æœå°†é€šè¿‡ç³»ç»Ÿé‚®ä»¶é€šçŸ¥æ‚¨ã€‚")+"</p>"].join(""),ok:function(){var e=p.t("æ­£åœ¨æ’¤å›ä¸­..."),i=r.rclStatus?p.t("æ­£åœ¨æŸ¥è¯¢æ’¤å›çŠ¶æ€..."):e,o=a.localReceiver,s=[],u={};$.Array.each(o,(function(t,i){var a=i.address;a in u||(u[a]=!0,s.push([{text:a},{text:e}]))})),t=new $.Msgbox({type:"confirm",contentType:"wide",title:'<b class="nui-ico nui-ico-loading">e</b>'+i,icon:"loading",extcls:c,content:$.Table.html({subclass:"simpleTable",headCells:l,bodyCells:s})});try{a.mailTracking&&m.default.getSettings((function(e){if(e.mailTraceEnable){var t=+new Date,i=encodeURIComponent(a.mid),n=d.default.encode(i+"_"+t);$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:{t:t,mid:i,sign:n},rnd:!0,url:$.Uri.getUrl("mailTrackingRecall",!0),head:[{name:"Content-type",value:"application/json"}],call:function(e){}})}}))}catch(e){}t.buttons.cancel.hide(),a.module.action.recallMessage({mid:a.mid,callback:h}),((0,n.$S)("isFree")||(0,n.$S)("isVip"))&&$.Ajax.jsonp($.Uri.getUrl("read_recall_notary",!0)+"&mid="+window.encodeURIComponent(a.mid),(function(){}))}}):f<3e5&&!e?s.default.getLetterData({moduleName:a.listModule,mid:a.mid,refersh:!0,callback:function(e){e&&(a.module.folderData=a.folderData=e,i.recall(!0))}}):i.whyRecallDisabled()},whyRecallDisabled:function(){var e=this.reader,t=e.data,i={},a={5:p.t("ä¿¡ä»¶å­˜åœ¨ä½†å·²ç»è¢«è¯»å–è¿‡ã€‚"),6:p.t("ä¿¡ä»¶å­˜åœ¨ä½†å·²ç»è¢«å®¢æˆ·ç«¯æ”¶å–è¿‡ã€‚"),7:p.t("ä¿¡ä»¶å­˜åœ¨ä½†å·²ç»è¢«æ¨é€å‡ºå»ã€‚")},n={type:"recall",mid:e.mid,callback:function(n,o){for(var r=o.var||[],c=$.Misc.getTime(0)-(e.folderData.sentDate||t.sentDate),l=!1,d=$.Uri.getUrl("read_recall_help",!0),u="",m=0,f=r.length;m<f;m+=1){var h,g=null;r[m].recallable?(e.module.folderData.recallable||s.default.getLetterData({moduleName:e.listModule,mid:e.mid,refersh:!0,callback:function(t){t&&(e.module.folderData=e.folderData=t)}}),h=c<18e4,!(g=a[r[m].rclResult])&&h&&(g=p.t("é‚®ä»¶æ­£åœ¨å‘é€ä¸­ï¼Œè¯·ç¨åå°è¯•æ’¤å›"),u="Read_NoGuide_Popup_WithdrawFailSending")):(h=c<6e4)?(g=p.t("ç³»ç»Ÿå¤„ç†ä¸­ï¼Œè¯·ç¨åå°è¯•æ’¤å›"),u="Read_NoGuide_Popup_WithdrawFailLoading"):(g=p.t("æ’¤å›åŠŸèƒ½å¼€é€šåå‘é€çš„é‚®ä»¶æ‰æ”¯æŒæ’¤å›ï¼Œç›®å‰ä»…å°è¯•æ’¤å›å‘å¾€ç½‘æ˜“163ã€126ã€yeah.netã€vip163ã€vip126å’Œ188çš„é‚®ä»¶ã€‚")+p.t("æ›´è¯¦ç»†çš„æ’¤å›æ¡ä»¶å¯")+" $help$",u="Read_Guide_Popup_WithdrawFailDomain"),g||(l=!0),g&&(i[g]||(i[g]=!0))}l&&(i[p.t("å…¶ä»–åŸå› é‚®ä»¶ä¸æ”¯æŒæ’¤å›ã€‚")]=!0,u="Read_NoGuide_Popup_WithdrawFailOther");var v=[];for(var b in i)v.push(b);var y='<h4 class="g-dialogBox-title">'+p.t("å¾ˆæŠ±æ­‰ï¼Œè¯¥é‚®ä»¶ä¸èƒ½è¢«æ’¤å›")+"</h4>";v.length>0&&(y+='<p class="txt-info g-dialogBox-item">'+p.t("åŸå› å¦‚ä¸‹ï¼š")+v.join("<br>").replace("$help$",$.Link.html({link:d,text:p.t("æŸ¥çœ‹å¸®åŠ©"),target:"_blank"}))+"</p>"),$.Msgbox.show({statsKey:u,title:p.t("æ’¤å›é‚®ä»¶"),content:y})}};e.module.action.listDeliveryHistory(n)},saveToNf:function(e){var t=this.reader,i=(0,n.$S)("advLock");function o(){$.Msgbox.show({contentType:"normal",title:p.t("ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒ"),content:t.view.getNfListHtml(),ok:function(){var i,o=$.fly("#ifrSaveToNf").dom.contentWindow.fid;(0,n.$S)("lastNetfolderFid",o),o&&(i=$.Uri.getUrl("savetonf_sub"),i+="&mid="+window.encodeURIComponent(t.mid)+"&dirId="+o,e&&(i+="&part="+e),$.Ajax.jsonp(i,(function(e){var t=e.code;200!==t&&t!==$.S_OK?$.Tips.show({statsKey:"Read_Guide_Tips_SkydriveLimit",text:p.t("ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒå¤±è´¥ï¼Œ")+(e.msg||a.netFolderError[t]||p.t("é”™è¯¯ç ")+t),type:"err"}):$.Tips.show({text:p.t("æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒ"),type:"suc"})})))},cancel:function(){}})}i.authenticated2||i.disabled||!i.nf?o():$.AdvLock.show((function(){o()}))},saveToYNote:function(){var e,t=this.reader,i=t.decryption;void 0===i||void 0!==(e=i.pwd)?t.module.action.saveToYNote({mid:t.mid,pwd:e,call:function(e){var t,i,a=e.code;if("S_OK"===a)$.Msgbox.html({title:p.t("é‚®ä»¶å·²æˆåŠŸä¿å­˜åˆ°æœ‰é“äº‘ç¬”è®°"),icon:"suc"});else if("S_PARTIAL_OK"===a)try{t=[],i=e.var.fails,$.Array.each(i,(function(e,i){t.push($.String.escapeHTML(i.resource))})),$.Msgbox.html({statsKey:"Read_NoGuide_Popup_AttachmentSaveFail",title:p.t("é‚®ä»¶éƒ¨åˆ†ä¿å­˜æˆåŠŸï¼ä»¥ä¸‹é™„ä»¶å› ç±»å‹å—é™ï¼Œæ— æ³•ä¿å­˜"),content:t.join("<br />")+a,icon:"err"})}catch(e){}else $.Msgbox.html({statsKey:"Read_NoGuide_Popup_AttachmentSaveError",title:p.t("ä¿å­˜å¤±è´¥ï¼Œé”™è¯¯ç ï¼š")+a,icon:"err"})}}):$.Msgbox.html({statsKey:"Read_Guide_Popup_AttachmentDecode",title:p.t("æœ¬é‚®ä»¶æ˜¯åŠ å¯†é‚®ä»¶ï¼Œè¯·è§£å¯†åé‡è¯•ã€‚"),icon:"err",ok:function(){(0,n.$C)(t.createId("decryptInput")).focus()}})},blankView:function(e){var t,i=this.reader,a=i.view.getDateStr(null,null,!0);t=$.Ext.read_noSsidRead?"read/viewmail.jsp?mid="+i.mid:$G.environment.readUrl.replace("readhtml","viewmail")+"&mid="+i.mid,i.isDecrypted&&(t+="&decryptMsg=true"),i.part&&(t+="&part="+i.part),e&&(t+="&type=1"),a&&(t+="&t="+a.getTime()),$G.environment.isCh||(t+="&hl="+$G.environment.hl),(3===i.fid||i.part)&&(t+="&ignoreMailTracking=1"),window.open(t,i.module.moduleName+(i.threadToken||""))},saveContacts:function(e){var t,i=this.reader.data;t=e?i[e]||[]:(i.from||[]).concat(i.to||[]).concat(i.cc||[]),c.default.contactListDialog({data:t,callback:function(e){e.code===$.S_OK?$.Tips.show({text:p.t("è”ç³»äººä¿å­˜æˆåŠŸ"),succ:!0}):$.Tips.show({text:p.t("è”ç³»äººä¿å­˜å¤±è´¥"),err:!0})}})},exportLetter:function(){var e=this.reader,t=$.Uri.getUrl("read_data",!0)+"&mid="+e.mid+"&mode=download&l=read&action=download_eml";e.part&&(t+="&part="+e.part),$.fly("#downloadFrame").dom.src=t},bodyFilter:function(e,t){var i,a=this.reader,n=a.body.frame;switch(e){case"header":if("header"===a.contentType)return;i=$.Uri.getUrl("read_head",!0)+"&mid="+a.mid+"&l=read&action=read_head",a.part&&(i+="&part="+a.part),a.contentType="header";break;case"mail":if("mail"===a.contentType)return;a.contentType="mail";break;case"encode":a.bodyEncoding=t}i=i||a.getFrameUrl(),a.body.destroy(!0),n.src=i,n=void 0},searchSameSubject:function(){var e=this.reader.folderData.subject.replace(/(re|reply|å›å¤|ç­”å¤|fw|forward|è½¬å‘)[:|ï¼š]/gi,"Re:"),t=e.lastIndexOf("Re:");t>-1&&(e=$.String.trim(e.substr(t+3))),Promise.resolve().then(i.bind(i,1124)).then($.Function.bind((function(t){t.default.title(e)})))},assignTask:function(){var e=this.reader,t=e.folderData;if(window.mailTeam){for(var i=t.tag||[],a="",n=0;n<i.length;n++){var o=i[n].match(/^%tc_task_id#(.+)%$/);if(o){a=o[1];break}}window.mailTeam.assignTasks.show({hl:$G.environment.hl,onOk:function(){},onCancel:function(){},onError:function(t){e.module.log({action:"show",item:"toolbar_assign_task_err"}),$.Tips.show({err:!0,text:(t||{}).msg||p.t("æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åå†è¯•")})},onSuccess:function(t){e.module.log({action:"show",item:"toolbar_assign_task_succ"}),$.Tips.show({succ:!0,text:p.t("åˆ†é…ä»»åŠ¡é‚®ä»¶æˆåŠŸ")}),s.default.getLetterData({moduleName:e.listModule,mid:e.mid,refersh:!0,callback:function(t){if(t){t.id=e.mid,e.module.folderData=e.folderData=t;var i={};i[e.mid]=!0,$.Listener.fire("letter:up"mailteam",data:[t],allFid:!0,area:"normal"})}}})},list:[{mid:e.mid,currentTaskId:a||"",currentTags:i,mailSubject:t.subject,mailContent:t.summary}]})}},l,i=t.folderData,a=window.setTimeout((function(){o(),a=void 0}),3e4);function o(){t.getDom("dvContent").style.display="",t.getDom("dvZoom").style.display=""}t.module.action.getMailServiceData({uid:(0,n.$S)("orgUid"),sender:t.localSender[0].address,time:(t.view.getDateStr(null,null,!0)||new Date).getTime(),hmid:i.hmid,call:function(r){var s;void 0!==a&&(window.clearTimeout(a),a=void 0);try{s=$.JSON.parse(r.responseText)}catch(e){return void o()}if(s.code===$.S_OK){var c=t.getDom("mailService"),l=s.var;c.firstChild.innerHTML=l.html;var d=$.fly(c.firstChild).find("a");d&&d.each((function(e,t){"1"===t.getAttribute("data-open-with-alert")&&t.protocol===location.protocol&&$.fly(t).listen("click",(function(e){var a=t.href,o=t.title,r=window.parseInt(t.getAttribute("data-width")||500),s=window.parseInt(t.getAttribute("data-height")||480);return"1"!==t.getAttribute("data-without-user-info")&&(a+=(a.indexOf("?")>-1?"&":"?")+"uid="+(0,n.$S)("orgUid")+"&hmid="+window.encodeURIComponent(i.hmid)+"&t="+(new Date).getTime().toString()+"&host="+(0,n.$S)("host")),$.Msgbox.show({header:o,content:'<iframe frameborder="0" style="width:100%;height:'+s+'px" src='+a+"></iframe>",width:r+"px",contentType:"wide",noFooter:!0}),$.Event.cancel(e),!1}));var a=t.getAttribute("data-log-url");a&&$.fly(t).listen("click",(function(){return $.Ajax.jsonp(a),!1}))})),c.style.display="",o()),e&&e()}else o()}})},querySmartMailTags:function(){var e=this.reader,t=e.folderData;if(!this.InternationalNumChecked&&"ud"!==(0,n.$S)("ad").userType&&$.Cookie.get("js_read_smart_hint")-0!=1){var i,a=e.data.headers.Sender;i=a instanceof window.Array&&a.length>0?a[0]:t.from;var o,r=t.tag;r&&r.length>0&&(o=r.join(",")),e.module.action.getSmartTag({mid:t.id,subject:t.subject,sender:i,tag:o,call:function(t){var i,a=JSON.parse(t.responseText);if(void 0===a.error){try{i=window.gAd.parseLetterFlag(a)}catch(e){return}"string"==typeof i&&i.length>0&&!e.errorMailWarn&&e.addBlockInfo("smartAd",null,{content:i})}}})}},queryMailStatus:function(e,t,i,a){var o=this,r=o.reader,s=r.folderData,l=s.tag||[],d=r.folderData.ctrls||{};if(console.log("oFolderData",s,r),i){if(!o.isLoadingMailStatus)if(o.isLoadingMailStatus=!0,$.Array.has(l,"%ex_trace_sp%")||d.encrypt){var u=[];r.to&&(u=u.concat($.Array.map(r.to,(function(e,t){return $.Uri.getEmails(t).match[0].address})))),r.cc&&(u=u.concat($.Array.map(r.cc,(function(e,t){return $.Uri.getEmails(t).match[0].address})))),r.bcc&&(u=u.concat($.Array.map(r.bcc,(function(e,t){return $.Uri.getEmails(t).match[0].address})))),m.default.getTraceSendStatusDetail({mid:r.mid,receivers:u},(function(t){var i={};if(200===t.code){i.code=$.S_OK;for(var a=[],n=0;n<t.result.length;n++){var o,r=t.result[n],s=$.Uri.getEmails(r.receiver,"Email",!0).match;o=s.length>0?s[0]:{name:r.receiver,address:""};var l=c.default.getName(o);a.push({to:r.receiver,to_name:l,result:r.deliveryStatus,rectime:new Date(r.deliveryTime)})}i.var=a}f(e,i)}))}else r.mod{type:e,mid:r.mid,callback:f})}else void 0!==a&&a();function f(e,i){o.isLoadingMailStatus=!1;var s=i.var;if(i.code===$.S_OK){new $.Table(r.view.getMailStatusConf(e,s)).render((0,n.$C)(t).getEl());var c=r.sendStatus;if(c){if(r.getDom("sendStatusText").innerHTML=c,"suc"===s[0].icon){r.getDom("sendStatusText").className="nui-txt-suc";try{r.resetAttachFlag(),r.initMailTracking()}catch(e){}}r.sendStatus=void 0}void 0!==a&&a(),$.Component.setEvents(),"send"===e&&$.Listener.fire("read:mailStatusUpdate",r.mid,s[0])}else $.Msgbox.html({header:p.t("ç³»ç»Ÿæç¤º"),content:p.t("æŠ±æ­‰ï¼Œç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™å†è¯•ã€‚")})}},_getReplyBody:function(e){var t=this,i=t.reader,o=i.data,r={id:i.mid,decryptPassword:(i.decryption||{}).pwd,attrs:{subject:(a.replyTitleText[(0,n.$S)("attrs").user.replyf]||a.replyTitleText[0])+o.subject,isHtml:!!o.html}};e.toAll&&(r.dontCcDelegatedAddress=r.toAll=!0),e.withAttachments&&(r.withAttachments=!0),i.part&&(r.part=window.parseInt(i.part));var s=$.String.escapeHTML(e.content||"").replace(/\n/g,"<br/>"),c=i.from.join(""),l=$.Date.format(i.folderData.sentDate||o.sentDate),d=a.replyBodyText[t._getLanguage()];if(o.html){var u=["<p>",d[0],l,d[2],$.String.encodeHTML(c),d[1],"</p>",'<blockquote id="isReplyContent" style="PADDING-LEFT: 1ex; MARGIN: 0px 0px 0px 0.8ex; BORDER-LEFT: #ccc 1px solid">'].join("");s&&(e.fragment?r.defaultContent=s:u=s+"<br/><br/>"+u),r.quoteHTMLStart=u,r.quoteHTMLEnd="</blockquote>"}else{var m=[d[0],l,d[2],c,d[1],"\n"].join("");s?e.fragment?(r.attrs.content=m+"\n"+s,s=""):r.quoteTextStart=s+"\n"+m:r.quoteTextStart=mtLinePrefix=">",r.defaultContent=s}var p=t._getSender();return p&&(r.attrs.account=p.toString()),r},_getForwardBody:function(e){var t,i,n,o=this,r=o.reader,s=r.data,c=e.asAttachment,l={mode:c?"attach":"quote",attrs:{subject:(a.forwardTitleText[$.Ud.get({field:"ntes_option",flag:"forward"})]||a.forwardTitleText[0])+s.subject,isHtml:!!s.html}},d=e.content;if(r.part&&(l.part=window.parseInt(r.part)),"fragment"===e.type&&(d=$.String.escapeHTML(d)),s.html?(n="quoteHTMLStart",c?l.attrs.content="":(i="<br/>",l.quoteHTMLStart='<DIV id="isForwardContent">',l.quoteHTMLEnd="</DIV>"),l.attrs.isHtml=!0):(n="quoteTextStart",c?l.attrs.content="":(i="\n",l.quoteTextStart=i,l.quoteTextEnd="")),!c){t=a.forwardBodyText[o._getLanguage()];var u=(r.from||[]).join(","),m=(r.to||[]).join(","),p=(r.cc||[]).join(","),f=s.subject;s.html&&(u=$.String.escapeHTML(u),m=$.String.escapeHTML(m),p=$.String.escapeHTML(p),f=$.String.escapeHTML(f)),l[n]+=[t[5],t[0]+u,t[1]+$.Date.format(s.sentDate||r.folderData.sentDate),t[2]+m,(r.cc?t[3]+p+i:"")+t[4]+f,d||""].join(i)}void 0!==d&&(l.attrs.content=(l.quoteHTMLStart||l.quoteTextStart)+(l.quoteHTMLEnd||l.quoteTextEnd));var h=o._getSender();return h&&(l.attrs.account=h.toString()),l},_getSender:function(){var e,t=this.reader;if(t.fid>19){var i=u.Z.getPopInfo(t.fid);i.isPop&&i.username&&(e=o.default.isSender(i.username))}return e},_getLanguage:function(){var e,t,i=this,a=i.reader,n="";if(void 0!==i.language)return i.language;if("west"===a.lang)t=1;else{try{e=i.reader.body.frame.contentWindow.document.body,n=$.String.trim((e.innerText||e.textContent||"").replace(/<[^>]+>/g,"")).substr(0,500)}catch(e){}t=0===n.length||n.match(/[^\x00-\x80]/g)?0:1}return i.language=t,t},_checkReplyTo:function(e){var t=this.reader,i=t.data,a=t.localSender[0].address||"",n=$.Uri.getAddress(a),o=i.headers["Reply-To"],r=!!o&&o.join(","),s=!1;if(r){var c=$.Uri.getEmails(r).match;c.length>0&&$.Array.each(c,(function(t,o){if(o.address!==n)return $.Msgbox.show({statsKey:"Read_NoGuide_Popup_AddressNotMatch",header:p.t("é£é™©æç¤º"),title:p.t("æ‚¨å›å¤çš„åœ°å€å’ŒåŸé‚®ä»¶å‘é€åœ°å€ä¸ä¸€è‡´ï¼Œè¯·æ³¨æ„è¯†åˆ«ã€‚"),content:p.t("å‘é€åœ°å€ï¼š")+$.String.escapeHTML(a)+"<br />"+p.t("å›å¤åœ°å€ï¼š")+$.String.escapeHTML(r),okText:p.t("ç»§ç»­å›å¤"),ok:function(){i.headers["Reply-To"]=void 0,e()},cancel:function(){}}),s=!0,$.BREAK}))}return s}}),t.Z=a},26437:function(e,t,i){i(42295),i(86305),i(803),i(71934),i(66251),i(55737),i(48868),i(92274),i(63045),i(81874),i(54861),i(68233),i(67285),i(34994),i(37092);var a,n=i(72957),o=i(5165),r=new n.c1("module.read.MailReaderAttach");a=$.createClass((0,n.$N)("module.read.MailReaderAttach")),$.Object.extend(a,{mimeMap:{pic:{31:!0,32:!0,33:!0,34:!0,36:!0,37:!0,38:!0},iconImg:{31:!0,32:!0,33:!0,34:!0},preview:{doc:!0,docx:!0,ppt:!0,pptx:!0,xls:!0,xlsx:!0,pdf:!0,zip:!0,rar:!0,htm:!0,html:!0,xml:!0,txt:!0,java:!0,jsp:!0,js:!0,c:!0,cpp:!0,py:!0,h:!0,hpp:!0,cs:!0,sh:!0,css:!0,jpg:!0,jpeg:!0,gif:!0,png:!0,bmp:!0,shtml:!0,xhtml:!0,mht:!0,asp:!0,aspx:!0,ini:!0,inf:!0,dib:!0,wpt:!0,dot:!0,dotm:!0,dotx:!0,docm:!0,pot:!0,potm:!0,potx:!0,pps:!0,ppsx:!0,pptm:!0,dpt:!0,xlsm:!0,xlt:!0,xltx:!0,xltm:!0,ett:!0,war:!0,ear:!0,"7z":!0,tar:!0,gz:!0,tgz:!0,taz:!0,cpgz:!0,z:!0,bz:!0,bz2:!0,tbz:!0,tbz2:!0,cpio:!0,ar:!0,crx:!0,sext:!0,wps:!0,rtf:!0,et:!0,dps:!0,jar:!0,flv:!0,mp3:!0,wma:!0,eml:!0,psd:!0}},thumbnailHandler:function(e,t,i){if(t)e.parentNode.innerHTML=$.Icon.html({type:"file75",subtype:o.Z.getSubtype({type:"file",name:i})});else{e.style.display="";var a,n,r=e.clientWidth,s=e.clientHeight,c=100;if(r<=c&&s<=c)return;r>s?(a=s,n="height"):(a=r,n="width"),a>c&&(e.style[n]=c+"px")}e=null}}),$.Object.extend(a.prototype,{initialize:function(e){var t=this;t.reader=e,t.baseUrl=$.Uri.getUrl("read_data",!0)+"&mid="+e.mid,t.imageItems=[],t.sortType="",void 0===(0,n.$S)("thumbnailHandler")&&(0,n.$S)("thumbnailHandler",a.thumbnailHandler);for(var i=e.data,o=i.attachments,r=$.Ext.newAttach,s=[],c=[],l=0,d=o.length;l<d;l+=1){var u=o[l],m=u.id,p=u.filename,f=p.indexOf(".")>-1?p.split(".").pop().toLowerCase():" ";if(u.filename=(p||m).split(String.fromCharCode(92)).pop(),u.mimeType=f,"cmecypt"===f)e.isEncrypted=!0,u.inlined=!1;else if(r&&u.inlined){t.inlineAttachFound=!0;continue}s.push(m),c.push(u)}t.commonId=s,i.attachments=c,0===c.length&&e.resetAttachFlag(!1)},init:function(){for(var e,t,a,n,o=this,r=o.reader,s=r.data.attachments,c=[],l={},d=0,u=s.length;d<u;d+=1)a=s[d],n=o.create(a,"common"),c.push(r.view.getAttachListItemHtml(n)),n.safeBrowsing&&(l[n.id]={fileName:n.filename,fileSize:n.filesize});u>0&&((t=r.getDom("ulCommonAttachItem")).parentNode.style.display="",t.innerHTML=c.join(""),r.getDom("dvAttachHead").innerHTML=r.view.getAttachHeader(u),(e=Object.values(l)).length>0&&r.module.ensureSafeBrowsingKit((function(t){t.checkAttList(e,(function(e){$.Listener.fire("read:safeBrowsingAttachDidCheck",{ids:Object.keys(l),results:e})}))})),o.showIcsAttach(),window.setTimeout((function(){o._setAttachEvent(),$.Ext.attach_online_modify&&i.e(603).then(i.bind(i,42724)).then($.Function.bind((function(e){e.default.loginO365()})))}),200))},create:function(e,t){var i,n=this,r=n.reader,s=a.mimeMap,c=s.pic,l=s.iconImg,d=s.preview,u=e.id,m=e.filename,p=e.mimeType,f=e.contentLength,h="base64"===e.encoding?3*f/4:f,g={id:u,mid:r.mid,filename:m,mime:e.mimeType,size:f>0?$.Number.convert(h):"",contentLength:Math.max(0,f),filesize:Math.max(0,h)};switch(t){case"common":g.isCommon=!0,r.isEncrypted||(g.saveToNfHandler=$.Function.bind(n.saveToNf,n,u));break;case"cloud":g.isCloud=i=!0,g.expireText=e.expireText;break;case"decrypt":g.isDecrypt=!0}i?(g.download=e.download+"&member="+$.Ud.udProxy["product.vipMember"],g.preview=e.preview):(g.download=n.getOptionUrl("download",e),g.preview=n.getOptionUrl("preview",e)),!$.Browser.isIE()&&h>0&&h<=209715200&&!r.isDecrypted&&(i?e.fileKey&&!e.expired&&(g.safeBrowsing={checkType:"LARGE_ATT",fileKey:e.fileKey}):g.safeBrowsing={checkType:"NORMAL_ATT",mid:r.mid,partId:e.id});var v=h<=1024*(i?1:10)*1024;$.Ext.readTran_atta&&v&&("pdf"===p||"docx"===p||"doc"===p||/.(doc|docx|pdf)$/.exec(m))&&(g.translate=i?$.Uri.getUrl("translateattach_cloud",!0)+"?"+(e.download||"").split("?")[1]:n.getOptionUrl("translate",e));var b=!i||h<=20971520;if($.Ext.pdfConver_atta&&("pdf"===p||/.(pdf)$/.exec(m))&&b){var y,x,k={cloud:i?"true":"false",filename:encodeURIComponent(m),filesize:h};i?(y=(e.download.split("?")[1]||"").split("&"),x=["file"]):(y=(g.preview.split("?")[1]||"").split("&"),x=["sid","part","uid","mid"]);for(var S=0,w=y.length;S<w;S++)for(var T=y[S].split("="),C=0,_=x.length;C<_;C++)if(x[C]===T[0]){k[x[C]]=decodeURIComponent(T[1]);break}g.conversion=$.Function.bind($.Support.pdfConversion,n,k,"read")}var I=o.Z.getSubtype({type:"file",name:m});if(I&&(g.icon=I,!i)){if(c[I]){var A=n.imageItems;g.open=n.getOptionUrl("pic",e),g.previewHandler=$.Function.bind(n.previewImages,n),l[I]&&(g.imagesrc=n.getOptionUrl("src",e)),g.imageIndex=A.length,A.push({id:u,original:n.getOptionUrl("original",e),title:m,downloadLink:g.download})}else"17"===I&&(g.open=n.getOptionUrl("open",e));$.Ext.prev&&d[p]&&(g.localPreview=!0),$.Ext.attach_online_modify&&(g.editH(t)})}return e.isMsg&&"message/rfc822"===e.contentType.toLowerCase()&&(g.eml={fid:r.fid,mid:r.mid,group:r.module.getGroup(),part:u}),g},saveToNf:function(e){var t=this,i=(0,n.$S)("advLock");function a(){var i=$.Uri.getUrl("savetonf_new"),a=(0,n.$S)("lastNfid");a&&(i+="&fid="+a);var s=['<div style="padding:10px">','<div style="zoom:1;padding:10px;height:230px;border-width:1px;border-style:solid" class="bdr-light">','<iframe id="ifrSaveToNf" src="'+i+'" height="228px" width="380px" frameborder="0"></iframe>',"</div>","</div>"].join("");$.Msgbox.show({type:"confirm",contentType:"normal",title:r.t("ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒ"),content:s,ok:function(){var i=$.fly("#ifrSaveToNf").dom.contentWindow.fid;if((0,n.$S)("lastNfid",i),i){var a=$.Uri.getUrl("savetonf_sub")+"&mid="+window.encodeURIComponent(t.reader.mid)+"&dirId="+i;e&&(a+="&part="+e),$.Ajax.jsonp(a,o)}}})}function o(e){var t=e.code;if(200===t||t===$.S_OK)$.Tips.show({text:r.t("æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒ"),type:"suc"});else{var i={800:r.t("æ–‡ä»¶ä¸­å¿ƒå®¹é‡è¶…å‡ºé™åˆ¶"),801:r.t(2:r.t("æµé‡è¶…å‡ºé™åˆ¶"),803:r.t("ç™»å½•è¶…æ—¶ï¼Œé‡æ–°ç™»å½•"),500:r.t("æœªçŸ¥é”™è¯¯")},a=e.msg||i[t]||r.t("é”™è¯¯ç ")+t;a=r.t("ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒå¤±è´¥ï¼Œ")+a,$.Tips.show({statsKey:"Read_Guide_Tips_SkydriveLimit",text:a,type:"err"})}}i.authenticated2||i.disabled||!i.nf?a():$.AdvLock.show(a)},previewImages:function(e){var t=this,a=(0,n.$S)("ImgPreviewObj");if(void 0!==a){if(t.imageItems.length>0){var o={index:e,data:t.imageItems,downloadAble:!0,composeFunc:function(e){Promise.resolve().then(i.bind(i,54107)).then($.Function.bind((function(i){i.default.entry({info:{attachments:[{type:"internal",_mid:t.reader.module.mid,_part:e}]}})})))}};a.init(o)}}else $.Ajax.request({requestType:$.Ajax.SCRIPT,url:"https://mimg.127.net/xm/all2/preview/preview-"+($G.environment.isDebug?"develop":"1.8.min")+".js",call:function(){try{void 0!==window.Preview&&((0,n.$S)("ImgPreviewObj",window.Preview),t.previewImages(e))}catch(e){}}})},showCloudAttach:function(e){for(var t,i,a,n,o=this,r=o.reader,s=[],c={},l=0,d=e.length;l<d;l+=1)a=e[l],n=o.create(a,"cloud"),s.push(r.view.getAttachListItemHtml(n)),n.safeBrowsing&&(c[n.id]={fileName:n.filename,fileSize:n.filesize});r.cloudAttachments=e,(i=r.getDom("ulCloudAttachItem")).innerHTML=s.join(""),i.parentNode.style.display="",r.getDom("dvCloudAttachHead").innerHTML=r.view.getAttachHeader(d,!0),(t=Object.values(c)).length>0&&r.module.ensureSafeBrowsingKit((function(e){e.checkAttList(t,(function(e){$.Listener.fire("read:safeBrowsin:e})}))})),o.updateHeaderInfo(),r.view.showAttachTracking(),window.setTimeout((function(){o._setAttachEvent(!0)}),200)},showIcsAttach:function(){for(var e=this.reader,t=e.data.attachments,a=[],n=0,o=t.length;n<o;n+=1){var r=t[n].mimeType||t[n].filename.split(".").pop();"string"==typeof r&&"ics"===r.toLocaleLowerCase()&&a.push(t[n])}var s=a.length,c=[];function l(){if(0===s&&0!==c.length){var t=e.getDom("dvReadAttachPreviewIcs");t.style.display="block",c.sort((function(e,t){return e.startTime-t.startTime}));for(var i=[],a=[],n=0;n<c.length;n++)$.Array.indexOf(i,c[n].uid)<0&&(i.push(c[n].uid),a.push(c[n]));t.innerHTML=e.view.getAttachPreviewIcsHtml(a)}}Promise.resolve().then(i.bind(i,26406)).then($.Function.bind((function(t){for(var i=t.default,n=0;n<s;n++)i.getIcsInfo({sMid:encodeURIComponent(e.mid),sPartid:a[n].id,pwd:(e.decryption||{}).pwd,from:e.folderData.from},(function(e){c=c.concat(e||[]),--s,l()}))})))},updateHeaderInfo:function(){var e=this.reader;e.fullHeaderInited&&(e.getDom("attachInfo_full").innerHTML=e.view.getAttachInfoHtml()),e.compactHeaderInited&&(e.getDom("attachInfo_compact").innerHTML=e.view.getAttachInfoHtml(!0))},sort:function(e,t,i){var a=this,o=a.reader,r=e+(i?"_desc":"");if(a.sortType!==r){var s,c,l=o.data.attachments;switch(e){case"size":s=function(e,t){var a=e.contentLength,n=t.contentLength,o=["base64"===e.encoding?3*a/4:a,"base64"===t.encoding?3*n/4:n];return i&&o.reverse(),o[0]-o[1]};break;case"type":s=function(e,t){var i=e.filename.replace(/(.|\n)*\./,"").toLowerCase(),a=t.filename.replace(/(.|\n)*\./,"").toLowerCase();return i>a?1:i<a?-1:0};break;case"name":s=function(e,t){var a=[e.filename.toLowerCase(),t.filename.toLowerCase()];return i&&a.reverse(),a[0]>a[1]?1:a[0]<a[1]?-1:0};break;default:s=function(e,t){return e.id-t.id}}l.sort(s),c=o.getDom("ulCommonAttachItem").childNodes,$.Array.each(l,(function(e,t){var i=t.id,a=c[e];a.id!==o.createId(i)&&a.parentNode.insertBefore(o.getDom(i),a)})),(0,n.$C)(o.createId("sortLink")).getEl().html(t+'<b class="nui-ico nui-ico-downArr">d</b>'),a.sortType=r}},getOptionUrl:function(e,t){var i,a=this,o=a.reader.mid,r=t.id;switch(e){case"original":i=a.baseUrl+"&part="+r+"&mode=inline";break;case"download":i=a.baseUrl+"&part="+r+"&mode=download&l=read&action=download_attach";break;case"open":i=a.baseUrl+"&part="+r+"&mode=inline&l=read&action=open_attach";break;case"pic":i=$.Uri.getUrl("read_pic",!0)+"&mid="+o+"&part="+r+"&mode=inline&l=read&action=open_attach";try{a.reader.isDecrypted&&(i=a.baseUrl+"&part="+r+"&mode=inline&l=read&action=open_attach")}catch(e){}break;case"rawPic":i="/js6/s?func=mbox:getMessageData&sid="+(0,n.$S)("sid")+"&mid="+o+"&part="+r;break;case"preview":i=$.Uri.getUrl("previewattach")+"&mid="+o+"&part="+r+"&keyfrom=wm"+(0,n.$S)("domain");break;case"translate":i=$.Uri.getUrl("translateattach")+"&mid="+o+"&part="+r+"&keyfrom=wm"+(0,n.$S)("domain");break;case"edit":i=$.Uri.getUrl("idp_qiye_edit")+"&mid="+o+"&part="+r+"&rnd="+(new Date).getTime();break;case"src":var s=a.baseUrl+"&mode=inline&part="+t.id;if($.Ext.readNewPic)i=[,"part="+t.id,"contenttype="+window.encodeURIComponent(t.contentType),"sWidth="+(t.width||-1),"sHeight="+(t.height||-1),"width=100&height=100"].join("&");else{var c=a._getThumbnailSize(t,200),l=c[0],d=c[1],u=t.width,m=t.height;u&&m&&(u<=l||m<=d)?i=s:void 0!==t.contentOffset&&(i=["//pic."+(0,n.$S)("fullDomain")+"/coremail/fcg/imgapp?funcid=thumbnail","sid="+(0,n.$S)("sid"),"mid="+window.encodeURIComponent(o),"off="+t.contentOffset,"len="+t.contentLength,"enc="+t.encoding,"conttype="+t.contentType,"width="+l,"height="+d,"needoriginal=1"].join("&"))}}return i},skipToList:function(){var e=this.reader,t=$(e.getDom("dvAttachBody").firstChild),i="qf0";if(e.module.getDom("ScrollDiv").scrollTop=t.offset().y-200,$.Browser.chrome()||$.Browser.safari())t.addClass("lr0"),window.setTimeout((function(){t.setClass("sa0"),t.destroy()}),1e3);else var a=0,n=window.setInterval((function(){if(a>8)return window.clearInterval(n),t.removeClass(i),void t.destroy();!1&a?t.removeClass(i):t.addClass(i),a+=1}),100)},_setAttachEvent:function(e){var t=this,i=t.reader,a=[],n=navigator.userAgent.toLocaleLowerCase().indexOf("touch")>-1&&$.Browser.ie()>9;try{a=i.getDom(e?"ulCloudAttachItem":"ulCommonAttachItem").childNodes}catch(e){}for(var o=0,r=a.length;o<r;o+=1){var s=a[o];$.Event.listen(s,"mouseenter",(function(e){t._mouseEventHandler(e,this)})),$.Event.listen(s,"mouseleave",(function(e){t._mouseEventHandler(e,this)})),$.Event.listen(s,"focus",(function(e){t._mouseEventHandler(e,this)})),n&&$.Event.listen(s,"click",(function(e){t._clickEventHandler(e,this)}))}},_mouseEventHandler:function(e,t){var i=this,a=i.reader,n="nui-bdr-item nui-bg-item fM0",o=" gh0",r=" gp0",s=$(t),c=e.type;if("mouseenter"===c||"focus"===c){var l=s.dom.parentNode.parentNode,d=s.offset().x,u=$.fly(l).offset().x,m=d+s.dom.offsetWidth,p=u+l.offsetWidth;s.hasClass("fM0")||(a.log({action:"show",item:"attachmenu"}),$.Listener.fire("read:attachMenuWillShow",t.id)),s.addClass(d-u<20?n+o:p-m<100?n+r:n);try{window.clearTimeout(s.get("menuTimer")),"focus"===c&&i.lastHover&&i.lastHover!==s.dom.id&&$.fly("#"+i.lastHover).removeClass(n+o+r)}catch(e){}i.lastHover=s.dom.id}else{s.removeClass(n+o+r);var f=s.find(".js-component-menu");void 0!==f&&s.set("menuTimer",window.setTimeout((function(){f&&$.Component.getItem(f.doms[0]).hide()}),400))}s.destroy()},_clickEventHandler:function(e,t){var i=this,a=i.activeAttach;a&&$.Event.fire(a,"mouseleave"),t!==a?($.Event.fire(t,"mouseenter"),i.activeAttach=t):i.activeAttach=void 0},_getThumbnailSize:function(e,t){var i,a=e.width,n=e.height;if("number"!=typeof a||"number"!=typeof n)i=[t,t];else if(a<=t||n<=t||a<400&&n<600||n<400&&a<600)i=[a,n];else{var o=a/n;i=a<n?[t,Math.round(t/o)]:[Math.round(t*o),t]}return i}}),t.Z=a},26729:function(e,t,i){i(55737),i(803),i(42295),i(34994),i(15761),i(20869),i(63518),i(75654),i(26340),i(52963),i(37092),i(92274),i(48868),i(63045),i(81874),i(54861),i(66251),i(79150),i(66403),i(68233),i(49750),i(13484),i(19975),i(65132);var a=i(72957),n=(i(27018),i(83123)),o=i(23408);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var s,c=new a.c1("module.read.MailReaderBody");s=$.createClass((0,a.$N)("module.read.MailReaderBody")),$.Object.extend(s,{fontSymbol:["em","%","pt","px"],fontUnit:[.1,10,2,2],fontLimit:[[.8,4.3],[80,430],[10,50],[12,60]],setFontSize:function(e,t,i,a){var n=this;if(1===e.nodeType){var o=s.getFontSize("currentStyle"in e?e.currentStyle.fontSize:window.getComputedStyle(e,null).getPropertyValue("font-size"),t);void 0!==o&&(e.style.fontSize=o),i||(e.style.lineHeight="1.66")}a&&"content"!==e.className||$.Array.each(e.childNodes,(function(e,i){n.setFontSize(i,t)})),e=void 0},getFontSize:function(e,t){var i,a,n=this,o=window.parseFloat(e);if(i=e.indexOf("px")>-1?3:e.indexOf("em")>-1?0:e.indexOf("%")>-1?1:e.indexOf("pt")>-1?2:3,a=n.fontUnit[i],t){if((o+=a)>n.fontLimit[i][1])return}else if((o-=a)<n.fontLimit[i][0])return;return o+n.fontSymbol[i]},setFontFamily:function(e,t){var i,a=this;1===e.nodeType&&(i=e.rawFontFamily,"inherit"===t?e.style.fontFamily=i||t:((i=e.style.fontFamily)&&void 0===e.rawFontFamily&&(e.rawFontFamily=i),e.style.fontFamily=t)),$.Array.each(e.childNodes,(function(e,i){a.setFontFamily(i,t)})),e=void 0}}),$.Object.extend(s.prototype,{initialize:function(e){var t=this;t.reader=e,t.modernIE=$.Browser.isIE(">8"),t.isIE=$.Browser.isIE(),t.isChrome=!!$.Browser.chrome(),t.contentType="mail"},init:function(){var e=this,t=e.reader;e.frame=t.getDom("frameBody"),e.autoHeightCount=0,{e.loadComplete||e.autoHeightCount>1?e.autoHeightTimer=e.autoHeightCount=void 0:(e.autoSize({heightOnly:!0,ignoreIE:!0}),e.autoHeightCount+=1,e.autoHeightTimer=window.setTimeout(t,2e3))}),1e3)},reload:function(e){var t=this;if(e){var i=t.reader;i.getDom("dvContent").innerHTML=i.view.getFrameHtml(e)}else{var a=t.frame;t.contentLoaded=t.loadComplete=!1,a.contentWindow.location.reload(),t.isChrome&&(a.style.height=t.normalHeight),a=voion(e){var t=this,i=t.reader,a=t.frame||i.getDom("frameBody");if(a){try{$.Event.unlistenAll(a),$.Event.unlistIframeDoc(a))}catch(e){}e||$.fly(a.parentNode).empty()}a=null,i.contentType=void 0,t.rangInited=!1,$.Browser.isIE("<9")&&setTimeout((function(){t.autoSize()}),1e3)},autoSize:function(e){var t=this,i=t.reader;if(e=e||{},!i.isHidden){var a,n,o,r,s=e.frame||t.frame||i.getDom("frameBody"),c=e.setScrollPos;s&&(c&&(a=t.reader.getDom("ScrollDiv"),n=window.parseInt(t.frame.style.height,10),o=t.reader.getDom("dvReadHeadInfo").offsetHeight+1,r=a.scrollTop-o),window.setTimeout((function(){var l,d,u,m=200,p=0,f=0,h=0;if(l=$.Element.getIframeDoc(s)){if(d=l.documentElement,t.isIE&&!t.modernIE){u=l.body||d;try{m=l.getElementById("content")?l.getElementById("content").offsetHeight:u.scrollHeight,f=u.scrollWidth}catch(e){return}p=40}else{t.modernIE&&(s.style.width=e.half?"":"100%"),u=d;try{m=l.getElementById("content")?l.getElementById("content").offsetHeight:u.scrollHeight,f=u.scrollWidth}catch(e){return}p=30}if(d.scrollWidth-d.offsetWidth>10&&(m+=20),(m=Math.max(m,200))!==window.parseInt(s.style.height,10)&&(s.style.height=m+p+"px"),t.isIE&&!t.modernIE)try{f=u.scrollWidth}catch(e){return}else try{f=u.scrollWidth,h=l.body.scrollWidth}catch(e){return}f=Math.max(f,h),!t.isIE&&t.widthSet||i.isThread||(!e.heightOnly&&f>700&&f>s.offsetWidth?s.style.width=f+30+"px":t.isIE||f!==window.parseInt(s.style.width,10)||(t.widthSet=!0)),s.style.maxWidth=e.has.style.height,10)*(r/n))+o,a=void 0),s=void 0,i.isThread&&i.module.resetOrderNum()}}),20))}},setReplyQuote:function(e,t){var i=this,n=i.reader,o=function(){try{var e="isReplyContent",i="BLOCKQUOTE",n=t.getElementById(e);if(null!==n){if(n.nodeName.toUpperCase()===i)return n;for(var o=t.getElementsByTagName(i),r=0;r<o.length;r+=1)if((n=o[r]).id===e)return n}}catch(e){a.$D.log("MailReaderBody.setReplyQuoteï¼šæ£€æŸ¥ç½‘æ˜“æ ‡è¯†å‡ºé”™")}return!1}()||function(){try{for(var e,i,n=t.getElementsByTagName("DIV"),o=0;o<n.length;o+=1)if("------------------&nbsp;åŸå§‹é‚®ä»¶&nbsp;------------------"===(e=n[o]).innerHTML&&(i=e.parentNode).parentNode===t.body.childNodes[1])return i}catch(e){a.$D.log("MailReaderBody.setReplyQuoteï¼šæ£€æŸ¥qqmailæ ‡è¯†å‡ºé”™")}return!1}()||function(){try{for(var e,i=t.getElementsByTagName("BLOCKQUOTE"),n=0;n<i.length;n+=1)if("gmail_quote"===(e=i[n]).className)return e}catch(e){a.$D.log("MailReaderBody.setReplyQuoteï¼šæ£€æŸ¥gmailæ ‡è¯†å‡ºé”™")}return!1}()||function(){try{var e=t.body.firstChild,i="font-family:timesnewroman,newyork,times,serif;font-size:12pt";return p(e)===i&&p(e.childNodes[1])===i&&p(e.childNodes[1].childNodes[1])===i&&e.childNodes[1].childNodes[1]}catch(e){a.$D.log("MailReaderBody.setReplyQuoteï¼šæ£€æŸ¥yahoo mailæ ‡è¯†å‡ºé”™")}return!1}()||function(){try{var e,i=t.getElementsByTagName("HR")[0];if(i&&"stopSpelling"===i.id)for(var n,o=t.body.childNodes,r=0,s=o.length;r<s;r+=1)(n=o[r])===i?(e=t.createElement("DIV"),i.parentNode.insertBefore(e,i),e.appendChild(n)):e&&e.appendChild(n);return e}catch(e){a.$D.log("MailReaderBody.setReplyQuoteï¼šæ£€æŸ¥livemail webmaiæ ‡è¯†å‡ºé”™")}return!1}()||function(){try{var e,i=t.body.childNodes[1];if("font:10pttahoma"===p(i)&&"background:#f5f5f5"===p(i.childNodes[1])&&4===i.childNodes[1].childNodes.length)for(var n,o=t.body.childNodes,r=0,s=o.length;r<s;r+=1)(n=o[r])===i?(e=t.createElement("DIV"),i.parentNode.insertBefore(e,i),e.appendChild(n)):e&&e.appendChild(n);return e}catch(e){a.$D.log("MailReaderBody.setReplyQuoteï¼šæ£€æŸ¥livemailå®¢æˆ·ç«¯æ ‡è¯†å‡ºé”™")}return!1}()||function(){try{var e=t.getElementsByTagName("BLOCKQUOTE")[0];if(e&&e.parentNode===t.body&&"cite"===e.type&&0===e.getAttribute("cite").indexOf("mid"))return e}catch(e){a.$D.log("MailReaderBody.setReplyQuoteï¼šæ£€æŸ¥thunderbirdæ ‡è¯†å‡ºé”™")}return!1}(),s=c.t("- æ˜¾ç¤ºå¼•ç”¨æ–‡å­— -"),l=c.t("- éšè—å¼•ç”¨æ–‡å­— -");if("object"===r(o)){var d=t.createElement("A");m(),o.parentNode.insertBefore($.fly(d).css({fontSize:"12px",display:"block",color:"#5c6efc",textDecoration:"none"}).attr({href:["javascript",":void(0);"].join(""),target:"_self"}).listen("click",(function(){return d.innerHTML===s?(d.innerHTML=l,o.style.display="",i.autoSize()):m(),d.blur(),n.log({action:"click",item:"body_quote"}),!1})).html(s).dom,o);var u=t.getElementById("blockquoteStyle");try{u.parentNode.removeChild(u)}catch(e){try{i.isIE?t.createStyleSheet().addRule("blockquote","display:inherit"):((u=t.createElement("style")).type="text/css",u.innerHTML="blockquote{display:inherit}",(t.body||t.documentElement).appendChild(u))}catch(e){}}u=void 0}try{$.fly(t.getElementById("blockquoteStyle")).remove()}catch(e){}function m(){var e=i.frame,t=n.view.mimFrameHeight,a=o.offsetHeight;d.innerHTML=s,o.style.display="none";try{e.style.height=window.Math.max(e.contentWindow.document.body.scrollHeight-a,t)+"px"}catch(e){i.autoSize()}}function p(e){try{var t=e.getAttribute("style");return(t.cssText||t).toLowerCase().replace(/[ \']/gi,"")}catch(e){a.$D.log("MailReaderBody.setReplyQuoteï¼šè·å–æ ·å¼å‡ºé”™")}return""}t=void 0},digAttach:function(e){var t=this,i=t.reader,n="divNeteaseBigAttach",o=e.getElementById(n);if(i.cloudAttached){if(t.cloudAttachInited||null===o)return null!==e.getElementById("divNeteaseDropbox")&&i.cloudAttached&&(i.cloudAttached=!1,i.addInitCall((function(){try{if($.fly(i.getDom("dvCloudAttachHead")).remove(),$.fly(i.getDom("ulCloudAttachItem").parentNode).remove(),i.commonAttached)i.attach.updateHeaderInfo();else{$.fly(i.getDom("dvAttachBody")).remove();try{$.fly(i.getDom("attachInfo_full").parentNode).remove()}catch(e){}try{$.fly(i.getDom("attachInfo_compact")).remove()}catch(e){}}}catch(e){}}))),void(e=void 0);var r,s,l,d,u,m,p,f,h,g=[],v=new RegExp("^(http:|https:)*//fs.(qiye.){0,1}163.com/[\\s\\S]*");for(rFsNewUrl=new RegExp("^(http:|https:)*//(mail.163.com|vip.163.com|mail.126.com|vip.126.com|mail.yeah.net|vip.188.com)/large-attachment-download/index.html[\\s\\S]*");o;)(r=o).id="divNeteaseBigAttach_bak",o=e.getElementById(n);r&&((o=r).id=n);for(var b=0,y=(s=o.getElementsByTagName("A")).length;b<y;b+=1)if(m=(l=s[b]).href,(d=l.getAttribute("download"))&&(v.test(d)||rFsNewUrl.test(d))){u=l.getAttribute("filename"),p=l.getAttribute("filesize")-0,h=T(window.parseInt(l.getAttribute("expiretime"))),(d=window.encodeURI(m))&&(v.test(d)||rFsNewUrl.test(d))||(d=null),h.available?(f=l.getAttribute("preview"),f=v.test(f)?window.encodeURI(f):void 0):f="";var x="";if(d&&!/^(http:|https:)*\/\/fs.qiye.163.com\//.exec(d)){var k=d.match(/file=([^&]+)/);if(k){var S=k[1];x=S,d="https://"+(0,a.$S)("fullDomain")+"/large-attachment-download/index.html?file="+S}}g.push({id:"cloudAttach_"+b,cloud:!0,filename:u,contentLength:p,download:d,preview:f&&f.replace(/^(http:)*\/\//,"https://").replace(/^https:\/\/fs.163.com/,"https://fs."+(0,a.$S)("fullDomain")),expireText:h.text,expired:!h.available,fileKey:x})}g.length>0?i.addInitCall((function(){i.attach.showCloudAttach(g)})):o.style.display="block",t.cloudAttachInited=!0,e=void 0}else if(null!==o){var w=e.getElementById("cloudAttachStyle"try{t.isIE?e.createStyleSheet().addRule("#divNeteaseBigAttach","display:block"):((w=e.createElement("style")).type="text/css",w.innerHTML="#divNeteaseBigAttach{display:block}",(e.body||e.documentElement).appendChild(w))}catch(e){}}}function T(e){var t,i={};try{if((e-=$.Misc.getTime(!1).getTime())<5e3)throw{};(t=e/864e5)>1?i.text=Math.ceil(t)+c.t("å¤©"):(t=e/36e5)>1?i.text=Math.ceil(t)+c.t("å°æ—¶"):(t=e/6e4,i.text=Math.floor(t)+c.t("åˆ†")),i.text+=c.t("ååˆ°æœŸ"),i.available=!0}catch(e){i={available:!1,text:c.t("å·²è¿‡æœŸ")}}return i}},resetInlineAttach:function(e){var t=this;t.reader.addInitCall((function(){try{"function"==typeof e.contentWindow.r_a_h&&t.reader.updateInlineAttach(e.contentWindow.r_a_h())}catch(e){}e=void 0}))},fixLargeImage:function(e){var t,i,n,o,r,s,c,l,d=this,u=d.reader,m=e.getElementsByTagName("IMG"),p=m.length,f=(0,a.$S)("sid");if(0===p)return!1;d.imgEventInited||(d.frame.contentWindow.NTES_Events={saveToNF:function(e){u.log({action:"click",item:"content_nf"}),u.assistant.saveToNf(e+"")}},d.imgEventInited=!0),u.junkPic&&(u.tipsComplete?u.addBlockInfo("junkPic"):u.junkPicTip=!0),t=u.isThread?d.isIE?62:52:0;for(var h=0;h<p;h+=1){r=(i=m[h]).width,s=i.height,o=i.src;var g=!1;d._getUrlParam(o,"sid")===f&&s&&s>50&&(r&&r>760&&(r>(c=(window.innerWidth||document.body.clientWidth)-201-34-t)&&(c=Math.max(760,c),i.style.width=c+"px",i.style.height=Math.floor(c/r*s)+"px"),l=g=!0),(n=$(i)).listen("mouseover",$.Function.bind(v,n,{resized:g,part:d._getUrlParam(o,"part"),index:h,width:r,height:s})).listen("mouseout",$.Function.bind(b,n)))}return l;function v(t){var i=this,n=t.index,o="ntes_read_img_menu_"+n,r=t.resized,s=i.get("timer"),c=e.getElementById(o);if(void 0!==s&&(window.clearTimeout(s),i.set("timer",void 0)),null!==c)c.style.display="";else{var l,d,m=i.dom.src,p=m.replace(/.+part=/,"");if(!(l=7===m.indexOf((0,a.$S)("host"))&&p.length>0)&&!r)return;d=i.offset(),(c=$.Element.create("DIV",o,e).html(u.view.getImageOptHtml({nfMenu:l,maxMenu:r,width:t.width,height:t.height,part:t.part,src:m,index:n}))).dom.style.cssText="position:absolute;left:"+d.x+"px;top:"+((d.y>29?d.y:30)-30)+"px",$(e.body).append(c.dom).destroy(),$(e.body.lastChild).listen("mouseover",(function(){var e=i.get("timer");void 0!==e&&(window.clearTimeout(e),i.set("timer",void 0))})).listen("mouseout",(function(){b.apply(i)})).destroy(),i.set("menuId",o),$.Component.setEvents()}i.set("menuActive",!0)}function b(){var t=this;t.get("menuActive")&&t.set("timer",window.setTimeout((function(){var i=e.getElementById(t.get("menuId"));i.style.display="none",t.set("menuActive",!1),t.set("timer",void 0);try{$.fly(i).find("#"+u.createId("NTES_YX_menu")).hide().css({visibility:"hidden"})}catch(e){}}),300))}},setRangEvent:function(e){var t=this;function i(i){var n;try{n=t.frame.contentWindow.event||i}catch(e){n=i}n=$.Event.get(n),(0,a.$S)("fGetActiveReaderBody",(function(){return t}));try{$.fly("#dvRangOptions").hide()}catch(e){}void 0!==t.rangTimer?(window.clearTimeout(t.rangTimer),t.rangTimer=void 0):t.rangTimer=window.setTimeout((function(){t.showRangeOpt(e,n),t.rangTimer=void 0}),500),$.Event.fire(document,"mouseup")}e=e||$.Element.getIframeDoc(t.frame),$.Event.listen(e,"mouseup",i),$.Event.listen(e,"dblclick",i)},removeRangEvent:function(){var e=$.Element.getIframeDoc(this.frame);$.Event.unlisten(e,"mouseup"),$.Event.unlisten(e,"dblclick")},showRangeOpt:function(e,t){var a,n,o=this,r=o.reader,s=o.rangText=o.getRangText(e),c="0"===$.Ud.get({field:"ntes_option",flag:"readRange"});if((!c||"mouseup"!==t.type)&&s){if(void 0===(a=$("#dvRangOptions"))&&(n=c?r.view.getTranlateTipHtml(!0):r.view.getRangeOptHtml(),a=$($.fly(document.body).append(n).dom.lastChild),$.Component.setEvents()),c){if(!/^[a-z]*$/.test(s))return;i.e(603).then(i.bind(i,59340)).then($.Function.bind((function(e){e.default.request(s,(function(e,t){0!==(t=JSON.parse(t)).customTranslation.content.length&&($.fly("#dvRangOptions").show().dom.firstChild.firstChild.firstChild.innerHTML=r.view.getTranlateTipHtml(!1,t),r.log({action:"show",item:"body_trans"}))}))})))}var l,d,u=t.pageX,m=t.pageY,p=$.fly(o.frame).offset();m-=r.module.getDom("ScrollDiv").scrollTop,d=o.isIE&&e.body?e.body.offsetWidth:e.documentElement.offsetWidth,l=u+p[0]+40,u+280>d&&!r.translating?a.css({left:"auto",right:"0px"}):a.css({left:l+"px",right:"auto"}),o.isIE&&(m-=document.documentElement.scrollTop),a.css({top:m+p[1]+20+"px"}),c||a.show(),a.destroy(),$.fly(document.body).one("mouseup",(function(){try{$.fly("#dvRangOptions").hide()}catch(e){}}))}},getRangText:function(e){var t="";return"getSelection"in window?t=this.frame.contentWindow.getSelection():"selection"in e&&(t=e.selection.createRange().text),$.String.trim(t.toString())},detectVCard:function(e){var t=this.reader,i=e.getElementById("divNeteaseMailCard"),a={};if(null!==i&&0!==i.childNodes.length){for(var n,o,r,s,l,d,u,m,p,f,h=i.getElementsByTagName("STRONG"),g=0,v=h.length;g<v;g+=1)"name"===(m=(u=h[g]).getAttribute("func"))?a.name=$.String.trim(u.innerHTML):"key2"===m&&(n=(d=u.getElementsByTagName("A")).length>0?$.String.trim(d[0].innerHTML):$.String.trim(u.innerHTML),(s=$.Uri.matchEmail(n))?a.email=s.address:/^(1[3|5|8])\d{9}$/.test(n)&&(o=n));if(!a.email||!$.SenderList.isSender(a.email)){for(g=0,v=(p=i.getElementsByTagName("SPAN")).length;g<v;g+=1)(f=p[g]).getAttribute("func")&&((l=$.String.trim(f.innerHTML)).indexOf(c.t("æ‰‹æœº"))>-1?(d=l.replace("ï¼š",":").split(":"),o=$.String.trim(d[d.length-1])):l.indexOf(c.t("ç”µè¯"))>-1?(d=l.replace("ï¼š",":").split(":"),r=$.String.trim(d[d.length-1])):/^(1[3|5|8])\d{9}$/.test(l)?o=l:/^\d{3,4}-\d{7,8}(-\d{3,4})?$/.test(l)&&(r=l));if(a.phone=o||r,(0!==h.length||0!==p.length)&&(a.email||a.name||a.phone)){var b=i.getElementsByTagName("A")||[];for(g=0;g<b.length;g++)b[g].innerText===c.t("ä½¿ç”¨å¸®åŠ©")&&$.fly(b[g]).remove();$.fly(i).before($.Element.create("DIV",void 0,e).html(t.view.getVCardTipsHtml(a)).dom)}}}},detectMediaPlayer:function(e){var t=this,a=t.reader,n=a.notFocus;if(!n){var o=e.getElementsByTagName("player"),r=o.length;if(r>0){var s={},c=a.data.attachments;if(void 0===c||0===c.length)return;$.Array.each(c,(function(e,t){s[t.filename]=t}));var l=t.mediaPlayers=[],d=r-1;o=$.Object.toArray(o),$.Array.each(o,(function(e,n){var r=n.getAttribute("param"),c=n.getAttribute("media"),u=s[r];u&&(t.mediaContent=!0,i.e(603).then(i.bind(i,15609)).then($.Function.bind((function(i){var r=i.default,s="NTES_MAIL_READ_FlashPlayer"+u.id;n.parentNode.innerHTML=(new r).getPlayHtml(a.attach.getOptionUrl("download",u),c,s),l.push(s),o[e]=n=void 0,e===d&&window.setTimeout((function(){t.autoSize({heightOnly:!0})}),200)}))))}))}}null!==e.getElementById("cards_read")&&(t.greetingCardContent=!0,n&&t.destroy(!0))},setAtHeightlight:function(e,t){var i=this.reader.folderData;if(i){var n=[];try{n=[].concat(i.accounts?i.accounts:(0,a.$S)("orgUid"),i.to.split(","),i.from.split(","))}catch(e){}for(var o=0;o<n.length;o++)n[o]=$.Uri.getAddress($.String.trim(n[o])),n[o]=(n[o]||"").toLowerCase();var r=t.getElementsByTagName("span");for(o=0;o<r.length;o++){var s=r[o].getAttribute("ntes_mm_email");if(s){var c=n.indexOf(s.toLowerCase());if(0===c&&(r[o].style.backgroundColor="#fff777"rRadius="2px",r[o].style.color="#333333";var l=r[o].getElementsByTagName("a");l&&l.length&&(l[0].style.color="#333333",l[0].style.textDecoration="none")}}}}},fixEmoji:function(e,t){this.reader;try{var i=t.body,a=i.innerHTML;i.innerHTML=n.Z.fix(a)}catch(e){}},fixStyle:function(e){try{var t=e.body,i=e.body.querySelectorAll('[mdtype="list"]');if(i)for(var a=0;a<i.length;a++)i[a].style.listStylePosition="outside";var n=t.innerHTML;n=n.replace(/(margin-left|text-indent)\s*:\s*(-\d+)/g,(function(e,t){return t+":0"})),t.innerHTML=n}catch(e){}},fixSafeLink:function(e){var t=this;try{var i=e.body,n=e.body.querySelectorAll('[mdtype="list"]');if(n)for(var o=0;o<n.length;o++)n[o].style.listStylePosition="outside";var r=i.innerHTML;r=r.replace(/__(href)/gi,"$1"),i.innerHTML=r;var s=e.body.querySelectorAll("a");for(o=0;o<s.length;o++){var c=s[o],l=c.href;l=(l=l.replace(/https?:\/\/fs\.163\.com\/fs\/preview\//gi,"https://fs."+(0,a.$S)("fullDomain")+"/fs/preview")).replace(/https?:\/\/fs\.163\.com\/fs\/display\/.*file=([^&]+)/gi,"https://"+(0,a.$S)("fullDomain")+"/large-attachment-download/index.html?file=$1"),c.href=l}s.length>0&&(t.isIE||$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig","product.plus.mailSecurityAccessStatus"],call:function(e){var i={},a={};try{i=JSON.parse(e["webmail.js.mailSecurityAccessConfig"]),a=JSON.parse(e["product.plus.mailSecurityAccessStatus"])}catch(e){}i.noTry>0&&(new Date).getTime()<i.noTry||a.canTry&&t.showSbStarterModal()}}))}catch(e){}},showSbStarterModal:function(){var e=this.reader;e.module.ensureSafeBrowsingKit((function(t){var i=e.getDom("dvReadHeadInfo");e.log({action:"show",item:"sb_starter"}),t.showStarterModal({targetElem:e.getDom("safeBrowsingHook"),wrapper:i,onCancel:function(n){if("trialSuccess"===n)return e.log({action:"click",item:"sb_starter_try"}),void $.Ud.getProxy({force:!0,field:["webmail.js.mailSecurityAccessConfig"],call:function(n){var o=(0,a.$C)(e.createId("safeBrowsing")).getEl(),r={};try{r=JSON.parse(n["webmail.js.mailSecurityAccessConfig"])}catch(e){}r.enable?(o.addClass("nui-hl"),t.showTipModal({targetElem:e.getDom("safeBrowsingHook"),wrapper:i,message:"act"})):o.removeClass("nui-hl")}});e.log({action:"click",item:"sb_starter_cancel"});var o=0;"button"===n?o=2592e6:"outside"===n&&(o=6048e5),$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig"],call:function(e){var t={};try{t=JSON.parse(e["webmail.js.mailSecurityAccessConfig"])}catch(e){}t.noTry=(new Date).getTime()+o,$.Ud.setProxy({field:"webmail.js.mailSecurityAccessConfig",value:JSON.stringify(t)})}})}})}))},stopAllMedia:function(){var e=$.Element.getIframeDoc(this.frame);$.Array.each(this.mediaPlayers,(function(t,i){try{e.getElementById(i).stop()}catch(e){}}))},zoom:function(e,t){var i=this,a=$.Element.getIframeDoc(i.frame),n=!0,o=i.isChrome;o&&void 0===i.normalHeight&&(i.normalHeight=i.frame.offsetHeight+"px");try{switch(e){case"I":s.setFontSize(a.body,!0);break;case"O":s.setFontSize(a.body,!1);break;case"R":n=!1,i.reload();break;case"F":s.setFontFamily(a.body,t)}}catch(e){}n&&i.autoSize({chromeResize:o,setScrollPos:!0}),a=void 0},onLoadHandler:function(e){var t,i,n=this,o=n.reader;if(n.contentLoaded=!0,e=e||n.frame,n.frame=e,t=$.Element.getIframeDoc(e),void 0!==n.autoHeightTimer&&(window.clearTimeout(n.autoHeightTimer),n.autoHeightTimer=n.autoHeightCount=void 0,0===n.autoHeightCount&&n.autoHeightCount({heightOnly:!0,ignoreIE:!0})),"mail"===n.contentType){if(n.fixSafeLink(t),n.fixStyle(t),n.fixEmoji(e,t),n.setReplyQuote(e,t),n.digAttach(t),n.resetInlineAttach(e),n.detectVCard(t),i=n.fixLargeImage(t),n.detectMediaPlayer(t),n.autoSize({chromeResize:i}),n.setRangEvent(t),(0,a.$S)("isFree")&&n.setAtHeightlight(e,t),$.Event.listen(t,"click",$.Function.bind(n.onClickHandler,n)),n.loadComplete=!0,o.view.getYAD(),n.showRightBottomAd(),$.Component.setEvents(50),t=void 0,n.optimizationChecked||o.isThread||(window.setTimeout((function(){n.checkContentOptimizable()}),1500),n.optimizationChecked=!0),$.Ext.pdfConver_atta&&(0,a.$S)("id_attr_frist_pdf")&&!$.LocalStorage.get("pdf_conversion_read_"+(0,a.$S)("uid")))try{var r=new $.Layer({width:"192px",content:"<p>"+c.t("PDF æ ¼å¼è½¬æ¢ä¸Šçº¿äº†ï¼Œç«‹å³ä½“éªŒã€‚")+"</p>",params:"hasArr arrDown",left:"38px",top:$G.environment.isCh?"-27px":"-46px",zIndex:"2",doNotHide:!0,renderTo:$.fly("#"+(0,a.$S)("id_attr_frist_pdf")).dom});r.render(),$.fly("#"+(0,a.$S)("id_attr_frist_pdf")).mouseover((function(){$.LocalStorage.set("pdf_conversion_read_"+(0,a.$S)("uid"),!0),r.destroy()}))}catch(e){}}else n.autoSize()},onClickHandler:function(e){var t=this,n=t.reader;$.Event.fire(document,"click");var r=$.fly($.Event.getTarget(e)).findParent("a[href], area[href], input[formaction], button[formaction]",!0,!0);if(r){var s=(r=r.dom).getAttribute("href");if(""!==$.String.trim(s)){var l=r.id,d=(r.href||r.formAction||r.getAttribute("formAction")||"").toLowerCase(),u=r.href||r.formAction||r.getAttribute("formAction")||"";if("2"===r.getAttribute("sys")){var m,p=r.getAttribute("sys-payload");try{if((m=JSON.parse(decodeURIComponent(p))).d.p&&m.d.p._sys)switch(m.d.p._sys.id){case"mail_trace_buy":Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showMailTraceBuy(m.d.p._sys["utm-source"]||"")})));break;case"mail_team_buy":Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showTeamPlusBuy(m.d.p._sys["utm-source"]||"","mp_team")})));break;case"mail_member":var f=m.d.p._sys["goods-type"]||"plus",h=m.d.p._sys["file-ids"],g=(d=m.d.p._sys.url,$.Support.parseQuery(d).utm_source),v=m.d.p._sys["utm-source"]||g,b=$.Support.parseQuery(d).beSource,y=m.d.p._sys["be-source"]||b;$.Event.stop(e),"cloudfile"===f.toLowerCase()&&((0,a.$S)("isVip")||$.Ud.udProxy["product.vipMember"])?h?i.e(603).then(i.bind(i,9002)).then($.Function.bind((function(e){e.default.batchRenew(h),$.Log.cache({MailReaderBodyMemberMailClick:{accountType:(0,a.$S)("isVip")?"vip":"plus",action:"attach-renew",goodsType:f,utmSource:v}})}))):(i.e(603).then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry("bj_center")}))),$.Log.cache({MailReaderBodyMemberMailClick:{accountType:(0,a.$S)("isVip")?"vip":"plus",action:"filecenter-attach-renew",goodsType:f,utmSource:v}})):Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showDialog(f,"",v,{beSource:y}),$.Log.cache({MailReaderBodyMemberMailClick:{action:"buy",accountType:"free",goodsType:f,utmSource:v}})})))}else $.Support.sysLinkOpen({version:2,payload:m,href:u,target:"_blank"})}catch(e){}return j(),void $.Event.cancel(e)}if("1"==.getAttribute("logkey");k&&n.log({action:"click",item:"direct_mail_"+$.String.escapeHTML(k)});var S=r.getAttribute("param"),w={};try{w=JSON.parse(S.replace(/'/g,'"'))}catch(e){w=S}$.Nav.entry":Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showMailTraceBuy(r.getAttribute("utm-source")||"")})));break;case"mail_team_buy":Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showTeamPlusBuy(r.getAttribute("utm-source")||"","mp_team")})));break;case"dock_start":o.default.showDock();break;case"mobile_reply":if((0,a.$S)("isFree")){var C=r.getAttribute("tauid_sig"),_=r.getAttribute("key");T=$.Uri.getUrl(l),C&&(T+="&tauid_sig="+C),_&&(T+="&key="+_),$.Ajax.jsonp(T,(function(e){e&&"200"===e.res?$.Msgbox.show({type:e.type,header:e.title,content:e.memo,okText:e.okText,ok:function(){switch(e.action){case"newwin":window.open(e.url);break;case"link":Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(t){t.default.goOutlink({key:e.key,param:e.param})})));break;case"interface":$.Nav.entry(e.interface,e.param,e.method)}}}):e&&e.memo&&$.Msgbox.show({content:e.memo})}))}break;case"courseassist":case"cards_read":case"ntes_cloudmusic":break;case"noschedule":$.Ud.set({field:"ntes_option",flag:"schedule_notify",value:1}),$.Tips.show({type:"suc",text:c.t("æ‚¨å‘é€çš„å®šæ—¶é‚®ä»¶åˆ°è¾¾æ—¶å°†ä¸å†ç”¨é‚®ä»¶æ–¹å¼é€šçŸ¥ï¼Œæ‚¨å¯ä»¥è¿›å…¥æ“ä½œä¹ æƒ¯è®¾ç½®å†æ¬¡è®¾å®šå‘é€é€šçŸ¥é‚®ä»¶")});break;case"mail_member":f=r.getAttribute("goods-type")||"plus",h=r.getAttribute("file-ids"),d=r.href,g=$.Support.parseQuery(d).utm_source,v=r.getAttribute("utm-source")||g,b=$.Support.parseQuery(d).beSource,y=r.getAttribute("be-source")||b;var I=(r.getAttribute("param")||"").split("="),A=I.length>1?I[1]:"";$.Event.stop(e),"cloudfile"===f.toLowerCase()&&((0,a.$S)("isVip")||$.Ud.udProxy["product.vipMember"])?h?i.e(603).then(i.bind(i,9002)).then($.Function.bind((function(e){e.default.batchRenew(h),$.Log.cache({MailReaderBodyMemberMailClick:{accountType:(0,a.$S)("isVip")?"vip":"plus",action:"attach-renew",goodsType:f,utmSource:v}})}))):(i.e(603).then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry("bj_center")}))),$.Log.cache({MailReaderBodyMemberMailClick:{accountType:(0,a.$S)("isVip")?"vip":"plus",action:"filecenter-attach-renew",goodsType:f,utmSource:v}})):Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showDialog(f,"",v,{beSource:y,unpaidOrderId:A}),$.Log.cache({MailReaderBodyMemberMailClick:{action:"buy",accountType:"free",goodsType:f,utmSource:v}})})));break;default:var M={};if((T=$.Uri.getUrl(l))&&T.indexOf("http")>-1){var L=d.split("?");if(2===L.length){var E=L[1];if(E.length>0)for(var D=0,R=(L=E.split("&")).length;D<R;D+=1){var P=L[D].split("=");P[1]&&(M[P[0]]=P[1])}}}if("_blank"===r.getAttribute("sys_target"))window.open(T);else switch(l){case"file_center":case"nf_center":case"fj_center":case"bj_center":case"photo_center":i.e(603).then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry(l)})));break;case"cards_read":case"read_postcard":Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:l,param:{to:n.from[0]}})})));break;default:Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:l,param:M})})))}}}return j(),void $.Event.cancel(e)}if(0===d.indexOf("mailto:")){var F=$.Uri.getEmails($.String.trim(window.decodeURI(d.replace(/^mailto:|\?.*$/gi,"")))).match;return F.length>0&&($.Array.each(F,(function(e,t){F[e]=t.name?t.name+"<"+t.address+">":t.address})),Promise.resolve().then(i.bind(i,54107)).then($.Function.bind((function(e){e.default.entry({info:{to:F}})})))),void $.Event.cancel(e)}0===d.indexOf("#")||"#"===r.getAttribute("href")||0===d.indexOf(["java","script:"].join(""))||8==$.Browser.ie()&&0===d.indexOf(t.frame.ie8_src)?r.target="_self":(r.target="_blank",/^(ht|f)tp(s?)/i.exec(u)&&!/^https?:\/\/[^/]+\.(163\.com|126\.com|yeah\.net|188\.com|netease\.com)\//i.exec(u)&&($.Event.cancel(e),n.module.safeBrowsing(u,(function(e){var i={};try{if(200!==(i=$.JSON.parse(""===e.responseText?"{}":e.responseText)).code)throw new Error("fail")}catch(e){n.log({action:"click",item:"safe_browsing_fail"})}switch(i.message?i.message.toLowerCase():""){case"normal":default:t.openUrl(u);break;case"suspect":t.showSuspectDialog(u);break;case"danger":$.Msgbox.show({statsKey:"Read_NoGuide_Popup_UnsafeLinks",icon:"forbid",title:c.t("å‡å†’ä¼ªé€ é“¾æ¥è­¦å‘Š"),content:c.t("æ‚¨æ‰€ç‚¹å‡»çš„é“¾æ¥å·²è¢«è¯†åˆ«å‡ºæ˜¯å‡å†’ä¼ªé€ çš„ä¸å®‰å…¨ç½‘ç«™ï¼Œå®ƒå¯èƒ½ä¼šç›—å–æ‚¨çš„ä¸ªäººè´¦å·ï¼Œéšç§ä¿¡æ¯ï¼Œæˆ‘ä»¬å·²ç¦æ­¢äº†è¯¥ç½‘ç«™çš„è·³è½¬å¹¶å»ºè®®æ‚¨ä¸è¦å‰å¾€ã€‚")})}}))))}else $.Event.cancel(e)}function j(){if(d&&0===d.indexOf("https://count.mail.163.com/")){var e=d.indexOf("?")>-1?"&":"?";(d+=e+"frmjs=true").indexOf("uid=")<0&&(d+="&uid="+(0,a.$S)("uid")),d.indexOf("domain=")<0&&(d+="&domain="+(0,a.$S)("domain")),$.Ajax.request({requestType:$.Ajax.IFRAME,rnd:!0,url:d})}else{var t=r.getAttribute("log"),i=r.getAttribute("logid");"1"===t&&i&&$.Ajax.request({requestType:$.Ajax.IFRAME,rnd:!0,url:"http://jslog.mail.126.com/count/c.htm?product=mailclick&uid="+(0,a.$S)("uid")+"&domain="+(0,a.$S)("domain")+"&logid="+i})}}},openUrl:function(e){var t=this.reader;if($.Support._ieVersion<9)window.open(e);else{var i=t.module.getDom("aTempLink");i.href=e;var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0),i.dispatchEvent(a)}},showSuspectDialog:function(e,t,i){var n,o=this,r=o.reader;if(o.isIE)return n=e.substring(0,200)+(e.length>200?"...":""),void $.Msgbox.show({statsKey:"Read_NoGuide_Popup_ThirdPartyLinks",icon:"alert",title:c.t("ç¬¬ä¸‰æ–¹ç½‘ç«™è·³è½¬æé†’"),content:c.t("æ‚¨å³å°†ç¦»å¼€ç½‘æ˜“é‚®ç®±ï¼Œå‰å¾€ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼ˆ")+'<span style="word-break: break-all;">'+$.String.escapeHTML(n)+"</span>"+c.t("ï¼‰ï¼Œè¯·æ‚¨è°¨æ…ç”„åˆ«ã€‚å»ºè®®æ‚¨ä¸è¦éšæ„æ³„æ¼è´¦å·å¯†ç ç­‰å®‰å…¨ä¿¡æ¯ã€‚"),ok:function(){o.openUrl(e)},cancel:function(){},okText:c.t("ç»§ç»­å‰å¾€")});void 0!==t?r.module.safeBrowsingKitLoading||r.module.ensureSafeBrowsingKit((function(n){r.log({action:"show",item:"sb_warning"}),n.showWarningModal({mid:r.mid,url:e,enabled:t,protocolHidden:i,onOpen:function(t){t.stat&&r.log({action:"click",item:t.stat}),o.openUrl(e)},onSbOpen:function(t){r.log({action:"click",item:"sb_warning_sbopen",value:{accessFree:t.accessFree}});var i="https://"+(0,a.$S)("fullDomain")+"/projects/safe-browsing/?utm_source=web&targetUrl="+encodeURIComponent(e)+"&uid="+encodeURIComponent(t.uid);$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig"],call:function(e){var t={};try{t=JSON.parse(e["webmail.js.mailSecurityAccessConfig"])}catch(e){}t.protocolHidden?o.openUrl(i):(t.protocolHidden=!0,$.Ud.setProxy({field:"webmail.js.mailSecurityAccessConfig",value:JSON.stringify(t),call:function(){o.openUrl(i)}}))}})},onClose:function(e){"buttonCancel"===e?r.log({action:"click",item:"sb_warning_cancel"}):r.log({action:"click",item:"sb_warning_close"})},onSbShow:function(e){r.log({action:"show",item:"sb_warning_sbopen",value:e})},onSb2Show:function(e){r.log({action:"show",item:e||"sb_warning_open2"})},onSbChange:function(e){r.log({action:"click",item:"sb_warning_switch",value:{enable:e}});var t=(0,a.$C)(r.createId("safeBrowsing")).getEl();e?t.addClass("nui-hl"):t.removeClass("nui-hl"),$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig"],call:function(t){var i={};try{i=JSON.parse(t["webmail.js.mailSecurityAccessConfig"])}catch(e){}i.enable=e,$.Ud.setProxy({field:"webmail.js.mailSecurityAccessConfig",value:JSON.stringify(i)})}})},onSbBuy:function(e){e.stat&&r.log({action:"click",item:e.stat}),$.getClass((0,a.$N)("product.Privileges")).showSafeBrowsingBuy({utmSource:e.utmSource,customUserInfo:{hasAgreement:!1,agreementCancelAble:!1,info:e.msg||""}})},onTrialSuccess:function(){$.Ud.getProxy({force:!0,field:["webmail.js.mailSecurityAccessConfig"],call:function(e){var t=(0,a.$C)(r.createId("safeBrowsing")).getEl(),i={};try{i=JSON.parse(e["webmail.js.mailSecurityAccessConfig"])}catch(e){}i.enable?t.addClass("nui-hl"):t.removeClass("nui-hl")}})}})})):$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig","product.plus.mailSecurityAccessStatus"],call:function(a){var n={};try{n=JSON.parse(a["webmail.js.mailSecurityAccessConfig"]),JSON.parse(a["product.plus.mailSecurityAccessStatus"])}catch(e){}t=Boolean(n.enable),i=Boolean(n.protocolHidden),o.showSuspectDialog(e,t,i)}})},getBodySize:function(){var e=this.reader.data,t=(e.html||e.text||{}).contentLength;if(!(void 0===t||t>51200))return void 0===t?0:tIframeDoc(i))&&e.body?(t=e.body,(a=this._getInnerTEXT(t)).replace(/([\n\r]\s*) {3,}/g,"\n")):a},checkContentOptimizable:function(){var e,t=this,i=t.reader;if(t.frame){try{e=$.Element.getIframeDoc(t.frame)}catch(e){return}if(!(t.getBodySize()<1536)){for(var a,n=!0,o=["table","map","thead","tbody","tfoot","th","tr","td","select","input","button","form","area","caption ","canvas","frame","frameset","iframe","audio","video","embed","object","dialog","summary","applet"],r=0,s=o.length;r<s;r+=1)if(a=o[r],e.getElementsByTagName(a).length>0){n=!1;break}var c=e.getElementsByTagName("a");if((s=c.length)>0)for(var l=0;l<s;l+=1)if(c[l].getAttribute("sys")){n=!1;break}if(n){var d=i.view.getHeaderLinkHtml(!0);$.fly(i.getDom("dvHeaderLinks")).prepend(d)}}}},showOptimizedContent:function(){var e=this,t=e.reader;i.e(37).then(i.bind(i,30037));var a=t.view.getOptimizedContentHtml();$.fly(document.body).append(a);var n=$("#ifrmOptimizedContent");n.listen("load",(function(){var t=$.Element.getIframeDoc(n.dom),i=t.getElementsByTagName("style");$.Array.each(i,(function(e,t){if(e>1)try{t.parentNode.removeChild(t)}catch(e){}})),r(t.body.firstChild),t.body.firstChild.className="content",$.Array.each(t.getElementsByTagName("br"),(function(e,t){if(e>0)for(var i=t.previousSibling;i;){if(i&&3===i.nodeType){if($.String.trim(i.nodeValue).length>0)return}else if(1===i.nodeType){var a=i.nodeName.toLowerCase();return void("br"!==a&&"div"!==a&&"p"!==a||(t.style.display="none"))}i=i.previousSibling}}));var a=n.dom.parentNode.offsetWidth-80;$.Array.each(t.getElementsByTagName("img"),(function(e,t){t.width>a&&(t.style.width=a+"px")})),s(t.getElementsByTagName("div")),s(t.getElementsByTagName("p")),n.show(),e.autoSize({frame:n.dom,heightOnly:!0})})),n.dom.src=t.getFrameUrl().replace("/readhtml","/readhtml_optimized");var o=$("#dvOptimizedContent");function r(e){if(1===e.nodeType){var t=e.id;if("divNeteaseBigAttach"!==t&&"divNeteaseMailCard"!==t){e.removeAttribute("class"),e.removeAttribute("style"),e.removeAttribute("alink"),e.removeAttribute("link"),e.removeAttribute("text"),e.removeAttribute("vlink"),e.removeAttribute("face"),e.removeAttribute("size"),e.removeAttribute("align"),e.removeAttribute("border"),e.removeAttribute("height"),e.removeAttribute("width"),e.removeAttribute("hspace"),e.removeAttribute("vspace"),e.removeAttribute("background"),e.removeAttribute("color"),e.removeAttribute("bgcolor");for(var i=e.childNodes,a=0,n=i.length;a<n;a+=1)r(i[a]);e=void 0}}}function s(t){$.Array.each(t,(function(t,i){try{0===i.getElementsByTagName("img").length&&0===$.String.trim(e._getInnerTEXT(i)).length&&(i.style.display="none")}catch(e){}}))}o.listen("click",(function(){$.Event.getTarget()===o.dom&&(n.remove().destroy(),o.empty().remove().destroy(),$("#read_mask").empty().remove().destroy())}))},showRightBottomAd:function(){var e=this.reader,t=e.folderData||{},n=e.data||{},o=t.subject||"",r=n.attachments||[],s=e.cloudAttachments||[];function l(e){e.sysLink?$.Support.sysLinkOpen(e.sysLink):e.utmSource&&Promise.resolve().then(i.bind(i,623{t.showDialog("plus","",e.utmSource)})))}function d(e,t){try{var i=JSON.parse(e.responseText||e.response);(0,a.$S)("read_safebrowsing_config",i),t&&t(i)}catch(e){}}!function(e){if((0,a.$S)("read_safebrowsing_config"))e&&e((0,a.$S)("read_safebrowsing_config"));else{var t="//mimg.127.net/cross/static/webmail-js6/read_safebrowsing_config.json";try{$.Ajax._xmlHttpPoll.unshift(new XMLHttpRequest),$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:t,call:function(t){d(t,e)}})}catch(a){console.log("read_safebrowsing_config",a);try{var i=new XDomainRequest;i.open("GET",t),i.onload=function(){d(i,e)},i.send()}catch(e){console.log("read_safebrowsing_config ie",e)}}}}((function(t){for(var i=(t=t||{}).title_keywords||[],a=t.attachment_type||[],n=!1,d=0;d<i.length;d++){var u=i[d];if(u&&o.indexOf(u)>-1){n=!0;break}}for(var m=!1,p=[].concat(r,s),f=[],h=0;h<p.length;h++){var g=p[h].filename.split(".").pop();$.Array.has(f,g)||f.push(g),$.Array.has(a,g)&&(m=!0)}var v,b;(n||m)&&(v={sceneId:54,fact:{subject:o,attachmentType:f.join(","),hl:$G.environment.hl}},b=function(t){var i=t.material,a=t.rule||{},n=i.buttonInfo.mainButton,o={ruleId:a.id,source:t.source};$.Popup.show({uniqueId:"popup_global_promote",title:i.title,content:'<div style="width: 300px;">'+i.content+"</div>",ok:function(){if(e.log({action:"click",item:"rb_popup_ok",value:o}),n.actionData)return t={hl:$G.environment.hl,actionType:n.actionType,actionData:n.actionData},i=function(){n.msgbox?$.Msgbox.show({header:n.msgbox.header,title:n.msgbox.title,ok:function(){e.log({action:"click",item:"rb_popup_msgbox_ok",value:o})},okText:n.msgbox.okText}):($.Tips.show({succ:!0,text:c.t("é¢†å–æˆåŠŸ")}),l(n))},void $.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,rnd:!0,head:[{name:"Content-type",value:"application/json"}],body:t,url:"/fgw/mpsrv-mkt/fapi/external/material/action",call:function(e){try{200===JSON.parse(e.responseText).code&&i&&i()}catch(e){}}});var t,i;l(n)},close:function(){e.log({action:"click",item:"rb_popup_close",value:o})},okText:n.text,pauseTime:15e3}),e.log({action:"show",item:"rb_popup",value:o})},$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,rnd:!0,head:[{name:"Content-type",value:"application/json"}],body:v,url:"/fgw/mpsrv-mkt/fapi/external/material/info",call:function(e){!function(e,t){try{var i=JSON.parse(e.responseText);if(200!==i.code||!i.result)return;var a=i.result;t&&t(aefox())try{t=function e(t){var i,a,n,o="",r=0,s=t.nodeType;if(s){if(a=t.nodeName||"",n=/(STYLE)|(SCRIPT)/.test(a),1===s&&!n||9===s||11===s){if("BR"===a)return" ";if(t.childNodes.length>0)for(t=t.firstChild;t;t=t.nextSibling)o+=e(t);else if("string"==typeof t.textContent)return t.textContent}else if(3===s||4===s)return t.nodeValue}else for(;i=t[r];r++)o+=e(i);return o}(e.childNodes)}catch(e){}else t=e.innerText||e.textContent||t;return t},_getUrlParam:function(e,t){var i=e.match(new RegExp("(^|&)"+t+"=([^&]*)(&|$)"));return null===i?null:window.decodeURIComponent(i[2])}}),t.Z=s},39567:function(e,t,i){i(55737),i(42295),i(34994);var a,n=i(72957),o=new n.c1("module.read.MailReaderDecryption");a=$.createClass((0,n.$N)("module.read.MailReaderDecryption")),$.Object.extend(a,{ERROR_INFO:{FA_MAIL_NOT_FOUND:o.t("ä¿¡ä»¶ä¸å­˜åœ¨"),FA_PART_NOT_FOUND:o.t("é™„ä»¶ä¸å­˜åœ¨"),FA_INVALID_PART:o.t("ä¿¡ä»¶Partä¸æ˜¯åµŒå¥—ä¿¡"),FA_EMPTY_PASSWORD:o.t("æ²¡æœ‰ä¼ é€’å¯†ç å‚æ•°"),FA_INVALID_PASSWORD:o.t("å¯†ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥"),FA_INVALID_ENCRYPTED_DATA:o.t("æ•°æ®é”™è¯¯")},isDecrypted:function(e){var t=(0,n.$S)("decryptedMid");return t?e in t:((0,n.$S)("decryptedMid",{}),!1)}}),$.Object.extend(a.prototype,{initialize:function(e){this.reader=e},decrypt:function(e){var t=this,i=t.reader,a=e.pwd;0!==a.length?i.module.action.decrypt({param:{mid:i.mid,pwd:a},call:$.Function.bind(t.showDecryptResult,t,e)}):e.call({error:o.t("è¯·è¾“å…¥å¯†ç ")})},showDecryptResult:function(e,t){var i=this,o=i.reader,r=t.code,s=t.var;if(r===$.S_OK){i.pwd=e.pwd,o.isDecrypted=(0,n.$S)("decryptedMid")[o.mid]=!0;var c=s.attachments||[];return o.data.attachments=c,o.commonAttached=c.length>0,o.attached=o.commonAttached||o.cloudAttached,i.updateContent(s),void(document.cookie=o.mid+"=l({error:a.ERROR_INFO[r]})},updateContent:function(e){var t=this.reader,i=t.body.frame,a=(0,n.$C)(t.createId("decryptForm"));1===a.getEl().dom.parentNode.childNodes.length&&(a.getEl().dom.parentNode.style.display="none"),a.destroy(),t.addBlockInfo("decryptSuc");try{t.body.destroy(!0),i.contentWindow.document.body.innerHTML=(e.html||e.text||{content:"<div>"+o.t("é‚®ä»¶æ­£æ–‡ä¸å­˜åœ¨")+"</div>"}).content,window.setTimeout((function(){t.body.onLoadHandler(i)}),$.Browser.isIE()?2e3:1e3)}catch(e){}i=void 0,t.attach.baseUrl=$.Uri.getUrl("read_decrypt_data",!0)+"&mid="+t.mid;var r=t.getDom("dvAttachBody");$.fly(r).empty().replace(t.view.getAttachListHtml()),t.showAttach();var s=t.getDom("attachInfo_compact"),c=t.getDom("attachInfo_full");t.attached?(null!==s&&$.fly(s).empty().replace(t.view.getAttachHtml(!0)),null!==c&&$.fly(c.parentNode).empty().replace(t.view.getAttachHtml())):(null!==s&&$.fly(s).empty().remove(),null!==c&&$.fly(c.parentNode).empty().remove())}}),t.Z=a},8444:function(e,t,i){i(55737),i(42295),i(34994);var a,n=i(72957),o=new n.c1("module.read.MailReaderTranslator");a=$.createClass((0,n.$N)("module.read.MailReaderTranslator")),$.Object.extend(a.prototype,{initialize:function(e){this.reader=e},ch({requestType:$.Ajax.SCRIPT,url:$.Uri.getUrl("read_trans",!0)+"&a=get&mid="+e.mid,rnd:!0,paddingFunc:function(t){var i;try{i=t.result.fanyi}catch(e){return}i&&"west"===i.lang&&(e.lang=i.lang,e.addBlockInfo("transCheck"),e.log({action:"show",item:"trans_tip"}))}})},translate:function(e){var t=this,i=t.reader;if(!t.requested){var a,r=i.decryption,s=void 0!==r,c="";if(s&&void 0===r.pwd)$.Msgbox.html({statsKey:"Read_Guide_Popup_Decode",header:o.t("ç³»ç»Ÿæç¤º"),content:o.t("æŠ±æ­‰ï¼Œæœ¬é‚®ä»¶æ˜¯åŠ å¯†é‚®ä»¶ï¼Œè¯·å…ˆè¿›è¡Œè§£å¯†ã€‚"),ok:function(){(0,n.$C)(i.createId("decryptInput")).focus()}});else{try{(0,n.$C)(i.createId("transCheck")).destroy()}catch(e){}switch(i.addBlockInfo("transLoading"),e){case 0:c="_btn";break;case 1:c="_tip";break;case 2:c="_rty"}a=$.Uri.getUrl("read_trans",!0)+"&a=fanyi&mid="+i.mid+"&keyform=wm"+(0,n.$S)("domain")+c,"hz"===$G.environment.svr&&(a+="&svr=hz"),s&&(a+="&decryptMsg=1"),$.Ajax.request({requestType:$.Ajax.SCRIPT,url:a,rnd:!0,paddingFunc:function(e){t.response(e)}}),t.requested=!0}}},response:function(e){var t=this,i=t.reader,a=(e||{}).result,o=(0,n.$C)(i.createId("transLoading"));if(void 0!==o&&o.destroy(),void 0!==a&&a.error)return i.addBlockInfo("transRetry"),void(t.requested=!1);t.translation=a.fanyi||a,i.addBlockInfo("transMenu"),t.switchContent(2)},switchContent:function(e){var t=this,i=t.reader;if(t.showType!==e){t.showType=e;var a=t.translation,r=$.String.escapeHTML(a.title||o.t("æ— ä¸»é¢˜")),s=$(i.module.getDom("h1Subject")),c=$(i.getDom("dvContent")),l=(0,n.$C)(i.createId("tansOriginalLink")),d=(0,n.$C)(i.createId("tansTranslationLink")),u=(0,n.$C)(i.createId("tansComparisonLink")),m=$(i.body.frame),p=$(i.getDom("translationFrame"));switch(e){case 2:if(void 0===p){(p=$.Element.create("IFRAME",i.createId("translationFrame"))).setClass("oD0 eP0"),p.css({height:i.view.mimFrameHeight+"px"}),p.attr({frameBorder:"0",src:"/"+$G.common.appName+"/read/readblank.jsp"}),c.append(p.dom),p.listen("load",(function(e){window.setTimeout((function(){t.autoSize()}),1e3);for(var i=$.Element.getIframeDoc($.Event.getTarget(e)),a=i.getElementsByTagName("A"),n=0,o=a.length;n<o;n+=1)a[n].target="_blank";$.Event.listen(i,"click",(function(){$.Event.fire(document,"click")})),i=void 0}));var f=p.dom.contentWindow;p.destroy(),window.setTimeout((function(){var e=a.content;e=(e=e.replace(/<(head|title|link|meta|script|textarea|input|button|select|option|iframe)[^>]*>(?:\s|.)*?<\/\1>/gi,"")).replace(/<(head|title|link|meta|script|textarea|input|button|select|option|iframe)(?:\s|.)*?\/?>/gi,""),f.document.body.innerHTML=e}),500)}c.setClass("nui-fClear sR0 kV0"),s.html(r),m.show(),p.show(),l.setDisabled(!1),d.setDisabled(!1),u.setDisabled(),i.body.autoSize({half:!0});break;case 1:c.setClass("nui-fClear sR0 eX0"),s.html(r),m.hide(),p.show(),l.setDisabled(!1),d.setDisabled(),u.setDisabled(!1);break;case 0:c.setClass("nui-fClear sR0"),s.html($.String.escapeHTML(i.folderData.subject||o.t("æ— ä¸»é¢˜"))),m.show(),p.hide(),l.setDisabled(),d.setDisabled(!1),u.setDisabled(!1),i.body.autoSize()}s.destroy(),c.destroy(),m.destroy(),p.destroy()}},autoSize:function(){var e=this.reader.getDom("translationFrame"),t=$.Element.getIframeDoc(e),i=this.reader.view.mimFrameHeight,a=$.Browser.isIE()?t.body.scrollHeight+150:t.documentElement.scrollHeight+30;e.style.height=(a<i?i:a)+"px",t=null}}),t600),i(803),i(68233),i(92274),i(75654),i(37092),i(55737),i(80153),i(67285),i(79150),i(48868),i(63045),i(81874),i(54861),i(42295),i(34994),i(52963),i(86305),i(66251),i(49750),i(37885);var a,n,o,r,s,c=i(72957),l=i(39579),d=i(1124),u=i(27018),m=i(64560),p=i(5165),f=i(83123),h=i(26729),g=i(96540),v=new c.c1("module.read.MailReaderView");n=d.default,o=u.default,r=m.default,s=p.Z,a=$.createClass((0,c.$N)("module.read.MailReaderView")),$.Object.extend(a.prototype,{initialize:function(e){this.reader=e},exit:function(){var e;for(console.log("exit");e=this._aListening.shift();)$.Listener.unlisten(e.name,e.fn)},_aListening:[],getHtml:function(){var e,t=this,i=t.reader,a=i.folderData,n="1"===$.Ud.get({field:"ntes_letter",flag:"read_head"}),o="",r=!!a.flags.system,s="",c=[' style="display:none"',""];i.module.resourcePreloaded?(s=t.getFullHeadHtml(),i.fullHeaderInited=!0,n&&(o=t.getCompactHeadHtml(),i.compactHeaderInited=!0,c.reverse())):n?(o=t.getTempCompactHeadHtml(),c.reverse()):s=t.getTempFullHeadHtml();var l="";a.composeExtra&&a.composeExtra.showOneRcpt&&(l=" fM1");var d=i.isServiceMail&&i.isMailServiceAvailable()?' style="display:none;"':"";return e=['<div id="'+i.createId("dvReadHeadInfo")+'" class="sI0 nui-bg-light'+(i.viewType?" jO0":"")+(r?" uL0":"")+'">',i.isThread?"":t.getSubjectHtml(),'<div class="ow0'+l+'">','<ul id="'+i.createId("ulCompact")+'"'+c[0]+' role="listitem" tabindex="0">',o,"</ul>",'<ul id="'+i.createId("ulFull")+'"'+c[1]+' role="listitem" tabindex="0">',s,"</ul>","</div>",'<div id="'+i.createId("dvHeaderLinks")+'" class="oe0">',t.getHeaderLinkHtml(),i.isThread||i.viewType?$.Toolbar.html(t.getSimpleToolbarConf()):"","</div>",'<div class="yz1" id="'+i.createId("dvSystemCert")+'" style="'+(n?"display:none;":"")+'">',r?'<img class="tX1" src="https://mimg.127.net/p/js4/lib/img/integrity/cert_ntes.png" alt="'+v.t("ç½‘æ˜“å®˜æ–¹é‚®ä»¶")+'">':"","</div>","</div>",'<div class="nui-split nui-split-cDark sK0 lB0"></div>','<div id="'+i.createId("dvBlockInfo")+'" style="display:none" title="'+v.t("æç¤ºåŒº")+'" aria-label="'+v.t("æç¤ºåŒº")+'" role="listitem" tabindex="0"></div>','<div id="'+i.createId("dvReadYad")+'" class="tI0 txt-info" style="margin: -1px 0 0 0px; padding: 0; min-height: 34px;"></div>','<div class="CG0" id="'+i.createId("dvReadAttachPreviewIcs")+'">',"</div>",'<div class="Fw0" id="'+i.createId("dvReadMailTeam")+'">',"</div>",'<div class="nu0">',t.getMailServiceHtml(),'<div id="'+i.createId("dvContent")+'" class="nui-fClear sR0"'+d+">",'<div id="'+i.createId("dvReadMailEncrypt")+'"></div>'+t.getFrameHtml(),"</div>","</div>",'<div class="Fw0" style="padding-top: 0;" id="'+i.createId("dvReadMailTeamTask")+'">',"</div>",'<div id="'+i.createId("dvReadAd")+'" class="tI0 txt-info"></div>','<div class="lY0">','<div id="'+i.createId("dvAttach_reply")+'" class="sz0 nui-bg-light nui-bdr-light">','<a name="'+i.createId("aAttachTag")+'"></a>',t.getAttachListHtml(),'<div class="sw0" id="'+i.createId("dvReply")+'" tabindex="0" title="'+v.t("å¿«æ·å›å¤åŒº")+'" aria-label="'+v.t("å¿«æ·å›å¤åŒº")+'" role="listitem">',t.getReplyHtml(),"</div>","</div>","</div>",t.getBottomAD(),t.getTempLinkHtml(i)],i.isThread||i.module.isIE678||e.push('<div id="'+i.createId("dvZoom")+'" class="sF0"'+d+">",t.getZoomHtml(),"</div>"),e.join("")},getCompactHeadHtml:function(e){var t,i,a,n,o,r=this,s=r.reader,c=s.data,l=c.from,d=c.to||[],u=c.cc||[],m=[],p=e?" ":"&nbsp;",f=s.module.userLabels;for(u="string"==typeof u?[u]:u,i=0,a=(o=(d="string"==typeof d?[d]:d).concat(u)).length;i<a;i+=1){var h=s.module.view.getContactConf(o[i].toString());h.extcls="nui-txt-cLink",h.id="compactLabel"+i,m.push(e?h.email.name||h.email.address:$.UserLabel.html(h)),f[h.id]=h.id}l=l instanceof window.Array?l[0]:l.toString();var g=p+v.t("äº")+p+r.getCompactDateStr()+p+v.t("å‘ç»™")+p+m.join(v.t("ã€"));if(e)return l+g;s.isThread&&(g="<p><span>"+g+"</span></p>"),(n=s.module.view.getContactConf(l)).id="compactLabelFrom";var b=new $.UserLabel(n);return t=['<li class="ig0 dM0">','<div class="hX0">','<div class="cc1">','<strong class="nui-txt-suc">'+b.html()+"</strong>",g,"</div>",r.getAttachHtml(!0),"</div>","</li>"].join(""),f[n.id]=n.id,s.module.fromLabel=b,t},getFullHeadHtml:function(){var e=this;return[e.getMemoHtml(),e.getSenderHtml(),e.getReceiverHtml(),e.getDateHtml(),e.getAttachHtml()].join("")},getTempCompactHeadHtml:function(){var e=this.reader,t=e.folderData,i=t.from||"";return i=(i instanceof window.Array?i[0]:i).toString(),['<li class="ig0 dM0">','<div class="hX0">','<div class="cc1">','<strong class="nui-txt-suc">'+$.String.escapeHTML(o.getName(e.module.view.getContactConf(i).email))+"</strong>",v.t("&nbsp;äº&nbsp;")+this.getCompactDateStr()+v.t("&nbsp;å‘ç»™&nbsp;")+$.String.escapeHTML(t.to||""),"</div>","</div>","</li>"].join("")},getTempFullHeadHtml:function(){var e=this.reader,t=e.folderData,i=t.from||"";return i=(i instanceof window.Array?i[0]:i).toString(),['<li class="ig0 ew0">','<div class="iI0">'+v.t("å‘ä»¶äººï¼š")+"</div>",'<div class="hX0">',$.String.escapeHTML(e.module.view.getContactConf(i).email.toString()),"</div>","</li>",'<li class="ig0 fD0">','<div class="iI0">'+v.t("æ”¶ä»¶äººï¼š")+"</div>",'<div class="hX0">',$.String.escapeHTML(t.to||""),"</div>","</li>",this.getDateHtml()].join("")},getMailServiceHtml:function(){var e=this.reader,t=e.module,i="";if(e.isServiceMail&&e.isMailServiceAvailable()){var a=e.folderData,n=(a.flags||{}).deferHandle&&a.defer;i=['<link href="https://mimg.127.net/xm/webmail/app-service/'+window.$G.environment.mailServiceVer+'/css/app_service.css" rel="stylesheet" type="text/css">','<div id="'+e.createId("mailService")+'" class="APP-service" style="display:none;">',"<div></div>",'<div class="APP-service-hr" style="display:none;">','<span class="desc" style="display:'+(n?"none":"")+'">','<a target="_blank" href="https://help.mail.163.com/feedback.do?m=add&categoryName=webmail%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%8C%96">'+v.t("æ„è§åé¦ˆ")+"</a>",'<span class="split">|</span>','<span class="alert"><i class="ico-clock"></i>',$.Link.html({text:v.t("ä¸ºæ­¤é‚®ä»¶è®¾ç½®å¾…åŠæé†’"),cls:"nui-txt-link",click:function(){t.setDefer(),t.log({action:"click",item:"service_defer"})}}),"</span>",'<span class="split">|</span>','<span class="content">'+v.t("ä»¥ä¸‹ä¸ºåŸé‚®ä»¶")+"</span>","</span>",'<span class="desc" style="display:'+(n?"":"none")+'">'+v.t("ä»¥ä¸‹ä¸ºåŸé‚®ä»¶")+"</span>","</div>","<i.speed&&!n)t.mimFrameHeight=400;else if(n&&!e)a='<div style="height:400px;"></div>';else{var o,r=i.createId("frameBody"),s=i.getFrameUrl(),c=" onload=\"$S('readFraLd')('"+i.module.name+"', this"+(i.isThread?", '"+i.threadToken+"'":"")+');"';try{o=(document.documentElement.clientHeight||document.body.clientHeight)-414,o=window.Math.max(o,400)}catch(e){o=400}t.mimFrameHeight=o,a='<iframe id="'+r+'" name="'+r+'" class="oD0"  frameborder="0" src="'+s+'" style="height:'+o+'px"'+c+"></iframe>"}return a},getAttachListHtml:function(e){var t,i=this.reader,a="",n="";if(i.commonAttached&&(a=['<div id="'+i.createId("dvAttachHead")+'"  class="sa0"></div>','<div class="rY0" style="display:none;margin-bottom:15px">','<ul id="'+i.createId("ulCommonAttachItem")+'" class="qs0 nui-fClear"></ul>',"</div>"].join("")),i.cloudAttached&&(n=['<div id="'+i.createId("dvCloudAttachHead")+'" class="sa0"></div>','<div class="rY0" style="display:none;">','<ul class="qs0 nui-fClear" id="'+i.createId("ulCloudAttachItem")+'"></ul>',"</div>"].join("")),t=[a,n,'<div class="nui-split nui-split-cDark"></div>'].join(""),!e)return['<div id="'+i.createId("dvAttachBody")+'" class="tn0" style="display:none;" tabindex="0">',t,"</div>"].join("");i.getDom("dvAttachBody").innerHTML=t},getAttachHeader:function(e,t){var i,a,n,o=this.reader,r="",s=t?o.getDom("ulCloudAttachItem"):o.getDom("ulCommonAttachItem"),l=s&&1===e?$(s).find(".df1"):null;if(l&&(o.log({action:"show",item:"sb_attach_promot"}),r=$.Link.html({text:v.t("å®‰å…¨æµè§ˆ"),cls:"nui-txt-link jL2",listeners:{mouseover:{handler:function(){var e=l.findParent(".lh0");console.log(e);var t=new MouseEvent("mouseenter",{view:window,bubbles:!0,cancelable:!0}),i=new MouseEvent("mouseleave",{view:window,bubbles:!0,cancelable:!0});e.dom.dispatchEventach_promot"}),setTimeout((function(){(0,c.$S)("sandbox_attachment_utm","sandbox_outside_attachment"),l.findParent("a").dom.click()}),120)}}}})),t)i="nui-ico-bigAtt",a=v.t("è¶…å¤§é™„ä»¶"),n=[r,'<div class="nui-split sK0"></div>'].join("");else{var d;try{var u=o.folderData.tag;$.Array.has(u,"%st_sys_fake%")&&(d='<span class="oG1">'+v.t("æ‚¨çš„é™„ä»¶å†…å®¹å¯èƒ½å«æœ‰è¯ˆéª—ä¿¡æ¯æˆ–é’“é±¼é“¾æ¥ï¼Œè¯·è°¨æ…æ‰“å¼€ï¼")+"</span>")}catch(e){}var m=$.Array.map(o.data.attachments||[],(function(e,t){return t.id}));i="nui-ico-att",a=v.t("é™„ä»¶"),n=[e>1?"&nbsp;"+$.Link.html({id:o.createId("downloadAllLink"),text:v.t("æ‰“åŒ…ä¸‹è½½"),title:v.t("ä¸‹è½½å…¨éƒ¨")+e+v.t("ä¸ªé™„ä»¶"),link:$.Uri.getUrl("read_pack",!0)+"&mid="+o.mid+"&part="+m.join("&part="),target:"downloadFrame",cls:"nui-txt-link jh0",listeners:{click:{handler:function(){o.log({action:"click",item:"attach_downloadall",value:{fileCount:e}})}}}}):"",d||"",r,"</div>",'<div class="nui-split sK0"></div>',e>5?['<div class="rf0">','<div id="_mail_toolbar_1_300" class="js-component-toolbar nui-toolbar ">','<div class="nui-toolbar-item">',$.Link.html({id:o.createId("sortLink"),text:v.t("é™„ä»¶æ’åº(é»˜è®¤)")+'<b class="nui-ico nui-ico-downArr">d</b>',cls:"nui-txt-link",click:function(){o.log({action:"click",item:"attach_sort"})},listeners:{render:function(){new $.Menu({groups:[{checkType:"radio",items:[{text:v.t("æŒ‰ä¸Šä¼ é¡ºåºæ’åº(é»˜è®¤)"),checked:!0,click:function(){o.log({action:"click",item:"attach_sort"}),o.attach.sort("",this.rawConfig.text)}},{text:v.t("æŒ‰é™„ä»¶ç±»å‹æ’åº"),click:function(){o.log({}),o.attach.sort("type",this.rawConfig.text)}},{text:v.t("æŒ‰é™„ä»¶ä»å°åˆ°å¤§"),click:function(){o.log({action:"click",item:"attach_sort"}),o.attach.sort("size",this.rawConfig.text)}},{text:v.t("æŒ‰é™„ä»¶ä»å¤§åˆ°å°"),click:function(){o.log({action:"click",item:"attach_sort"}),o.attach.sort("size",this.rawConfig.text,!0)}},{text:v.t("æŒ‰é™„ä»¶åå‡åº"),click:function(){o.log({action:"click",item:"attach_sort"}),o.attach.sort("name",this.rawConfig.text)}},{text:v.t("æŒ‰é™„ä»¶åé™åº"),click:function(){o.log({action:"click",item:"attach_sort"}),o.attach.sort("name",this.rawConfig.text,!0)}}]}],width:155}).attachTo({clickFrom:this.getEl(),renderTo:o.getDom("ScrollDiv"),reverse:!0})}}}),"</div>","</div>","</div>"].join(""):""].join("")}return['<div class="ox0">','<b class="nui-ico '+i+'"></b>','<strong class="jU0">'+a+'<span class="nui-txt-s12 nui-txt-tips" style="font-weight:normal">&nbsp;('+e+")</span></strong>",n].join("")},getAttachListItemHtml:function(e){var t,a=this,n=a.reader,o=e.id,r=n.createId(e.id),s=$.String.escapeHTML(e.filename),l=e.imagesrc,d=e.icon,u="string"==typeof l,m="",p="",f="cK0",h=f+" bJ0",g='<span class="cb1 cF2">'+v.t("ä¸‹è½½")+"</span>",b='<span class="cb1 dc3">'+v.t("æ‰“å¼€")+"</span>",y='<span class="cb1 cc2">'+v.t("é¢„è§ˆ")+"</span>",x='<span class="cb1 dd1">'+v.t("ç¼–è¾‘")+"</span>",k='<span class="cb1 de2">'+v.t("ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒ")+"</span>",S='<span class="cb1 cG1">'+v.t("ç¿»è¯‘")+"</span>",w='<span class="cb1 dN2">'+v.t("PDFè½¬æ¢")+"</span>",T='<span class="cb1 df1"><span class="v1"></span>'+v.t("å®‰å…¨æµè§ˆ")+'<span class="V1"></span>';return sDownload="",sPreview="",sOpen="",sEdit="",sSave="",sTranslate="",sConversion="",sSafeBrowsing="",t=u?'<img src="'+l+'" style="display:none" onload="$S(\'thumbnailHandler\')(this);" onerror="$S(\'thumbnailHandler\')(this, true, \''+$.String.escapeHTML(e.mime)+"');\" ></img>":$.Icon.html({type:"file75",subtype:d}),e.isCommon?(sDownload=$.Link.html({text:g,link:e.download,cls:f,target:"downloadFrame",listeners:{click:{handler:function(){var t="";try{t=n.module.listExtend.subtype}catch(e){}n.log({action:"click",item:"attach_download",value:{value:1,subtype:t,ext:$.String.trim(e.mime),size:e.contentLength}})}}}}),"9"===d&&e.eml?sOpen=$.Link.html({text:b,cls:f,click:function(){n.log({action:"click",item:"attach_open"}),$.fly(n.getDom(e.id)).removeClass("nui-bdr-item nui-bg-item fM0"),Promise.resolve().then(i.bind(i,88829)).then($.Function.bind((function(t){var i=t.default;n.module._frameCtrlNoDelete=!0,i.entry(e.eml)})))}}):e.open&&(sOpen=$.Link.html({text:b,cls:f,link:e.open,target:"_blank",listeners:{click:{handler:function(){n.log({action:"click",item:"attach_open"})}}}}),(e.mime&&"pdf"===e.mime||e.filename&&/\.pdf$/.exec(e.filename))&&(sOpen=$.Link.html({text:b,cls:u?$.Linclick",item:"attach_preview",value:e.mime}),e.previewHandler(e.imageIndex)}}):$.Link.k:{handler:function(){n.log({action:"click",item:"attach_preview",value:e.mime})}}}})),e.editHandler&&(sEdit=$.Link.html({text:x,cls:f,click:function(){n.log({action:"click",item:"attach_Edit"}),e.editHandler()}})),e.saveToNfHandler&&(sSave=$.Link.html({text:k,cls:f,click:function(){n.log({action:"click",item:"attach_saveNF"}),e.saveToNfHandler()}}))):e.isCloud?(e.download&&(sDownload=$.Link.html({text:g,link:e.download,cls:f,target:"_blank"})),e.preview&&(sPreview=$.Link.html({text:y,cls:f,link:e.preview,target:"_blank"})),m=['<div class="el0">','<span class="nui-txt-tips cy0">('+e.expireText+")</span>",'<div class="nui-txt-tips gh1" data-download="'+e.download+'"></div>',"</div>"].join(""),n.isFromPlus&&(p='<div class="cE1">'+v.t("å½“å‰é™„ä»¶ä¸ºé‚®ç®±ä¼šå‘˜è¶…å¤§é™„ä»¶ï¼Œæœ€é«˜50å¤©å†…æœ‰æ•ˆ")+"</div>"),sOpen=sEdit=sSave=""):e.isDecrypt&&(sDownload=$.Link.html({text:g,cls:f,link:e.download,target:"ifrDownUrl"})),e.translate&&(sTranslate=$.Link.html({text:S,cls:f,listeners:{click:{handler:function(){var t="read_atta_translate";if($.LocalStorage.get(t,!0))window.open(e.translate,"_});else{var i=$.Button.html({delegateTo:"self",text:v.t("ç¡®å®š"),subclass:"mainBtn",click:function(){window.open(e.translate,"_blank"),(0,c.$C)("isReadAttrTranslateNoRemind").getChecked()&&$.LocalStorage.set(t,"1",{path:"/",expires:3650,domain:(0,c.$S)("fullDomain")},!0),$.Msgbox.msgbox.hide(),$.Log.cache({read_atta_translate_noremind:(0,c.$C)("isReadAttrTranslateNoRemind").getChecked()?"1":"0",read_atta_translate_sure:"1",read_atta_translate_outlink:"1"})}}),a=$.Checkbox.html({text:$.Label.html({text:v.t("ä¸å†æé†’")},!0),checked:!0,id:"isReadAttrTranslateNoRemind"},!0);$.Msgbox.show({statsKey:"Read_Guide_Popup_YoudaoTranslate",extcls:"gRead-attr-translate-msgbox",noHeader:!0,noFooter:!0,content:'<div class="gRead-attr-translate"><dl><dt>'+v.t("æé†’")+"</dt><dd>"+v.t("æ‚¨å³å°†è¿›å…¥æœ‰é“æ–‡æ¡£ç¿»è¯‘ï¼š")+"https://pdf.youdao.com<br>"+v.t("æ–‡æ¡£ä¸€é”®ç¿»è¯‘ï¼Œä¿ç•™åŸæ–‡æ’ç‰ˆã€‚")+'</dd></dl><div class="gRead-attr-translate-btn">'+i+'</div><div class="gRead-attr-translate-check">'+a+"</div></div>",width:$G.environment.isCh?"360px":"450px",height:"186px",contentType:"custom",close:function(){$.Msgbox.msgbox.hide(),$.Log.cache({read_atta_translate_close:"1"})}})}}}}})),e.conversion&&!$.Support.isTeamMailFromSwitch()&&(sConversion=$.Link.html({text:w,cls:f,click:function(){e.conversion()}}),(0,c.$S)("id_attr_frist_pdf")||(0,c.$S)("id_attr_frist_pdf",r)),e.safeBrowsing&&(sSafeBrowsing=$.Link.html({text:T,cls:f,onRender:function(){var t=this.el.dom;function i(i){i===r&&(n.log({action:"show",item:"sb_attachmenu"}),n.module.ensureSafeBrowsingKit((function(i){i.getAttInfo(e.safeBrowsing,(function(e){if(e.buyMsg&&t.setAttribute("data-buy",e.buyMsg),void 0!==e.subtitle){var i=t.querySelector(".v1");i&&(i.textContent=e.subtitle)}}))})))}function s(e){var i,a=e.ids,n=e.results,r=a.indexOf(o);if(-1!==r&&void 0!==(i=n[r].desc)){var s=t.querySelector(".V1");s&&(s.textContent=i)}}$.Listener.listen("read:attachMenuWillShow",i),a._aListening.push({name:"read:attachMenuWillShow",fn:i}),$.Listener.listen("read:safeBrowsingAttachDidCheck",s),a._aListening.push({name:"read:safeBrowsingAttachDidCheck",fn:s})},click:function(){var t=this.el.dom;n.log({action:"click",item:"sb_attachmenu"}),n.module.showSafeBrowsingGuideIfNeeds("attGuide",(function(){var i=t.getAttribute("data-buy");if(i)return $.getClass((0,c.$N)("product.Privileges")).showSafeBrowsingBuy({utmSource:(0,c.$S)("sandbox_attachment_utm")||"sandbox_attachment",customUserInfo:{hasAgreement:!1,agreementCancelAble:!1,info:i}}),void(0,c.$S)("sandbox_attachment_utm","");var a="";"NORMAL_ATT"===e.safeBrowsing.checkType?a="https://"+(0,c.$S)("fullDomain")+"/projects/safe-browsing/attachment.html?attachType=attachment&uid="+encodeURIComponent((0,c.$S)("orgUid"))+"&mid="+encodeURIComponent(e.safeBrowsing.mid)+"&partId="+encodeURIComponent(e.safeBrowsing.partId)+"&fileUrl="+encodeURIComponent(e.download):"LARGE_ATT"===e.safeBrowsing.checkType&&(a="https://"+(0,c.$S)("fullDomain")+"/projects/safe-browsing/attachment.html?attachType=mdriver&uid="+encodeURIComponent((0,c.$S)("orgUid"))+"&fileKey="+encodeURIComponent(e.safeBrowsing.fileKey)+"&fileUrl="+encodeURIComponent(e.download)),a&&window.open(a)}))}})),sDownload=sDownload||$.Link.html({text:g,cls:h}),sPreview=sPreview||$.Link.html({text:y,cls:h}),e.isCloud||(sOpen=sOpen||$.Link.html({text:b,cls:h}),sSave=sSave||$.Link.html({text:k,cls:h}),sEdit=sEdit||$.Link.html({text:x,cls:h})),['<li id="'+r+'" class="lh0" tabindex="0">','<div class="dM1">','<div class="ey0">','<div class="dn0">','<div class="cg0">'+s+"</div>",p,"</div>",'<div class="gi2"></div>',sDownload,sOpen,sPreview,$.Ext.attach_online_modify?sEdit:"",$.Ext.netfolder_enable?sSave:"",sTranslate,sConversion,sSafeBrowsing?'<div class="gi2"></div>':"",sSafeBrowsing,"</div>","</div>","<table><tbody><tr>",'<td class="eG0">','<div class="cf0">'+t+"</div>","</td>","</tr><tr>",'<td class="gx0">','<strong class="dh0">'+s+"</strong>",'<span class="nui-txt-tips di0">'+e.size+"</span>",m||"","</td></tr></tbody></table>","</li>"].join("")},getAttachPreviewIcsHtml:function(e){for(var t=this.reader,a=[],n=0;n<e.length;n++){var o,r,s=e[n],c=new Date(s.startTime),l=new Date(s.endTime),d=new Date,u=+s.allday,m=$.Date.format(c,"yyMd")===$.Date.format(l,"yyMd"),p=s.startTime===s.endTime;u?(o=new Date(d.getFullYear(),d.getMonth(),d.getDate()).getTime()>s.endTime,r=$.Date.format(c,v.t("yyyy-MM-dd å‘¨w"))+(p?"":"ï½"+$.Date.format(l,m?"":v.t("yyyy-MM-dd å‘¨w")))):(o=+d>s.endTime,r=$.Date.format(c,v.t("yyyy-MM-dd å‘¨w HH:mm"))+(p?"":"ï½"+$.Date.format(l,m?"HH:mm":v.t("yyyy-MM-dd å‘¨w HH:mm"))));var f="",h="",g="",b="",y=s.extended||{};switch($.Ext.ics2schedule||(y={}),y.type){case"organizer":f='<div class="kZ2">'+(x=y.data).acceptNum+v.t("äººæ¥å—")+"&nbsp;&nbsp;"+x.refuseNum+v.t("äººè°¢ç»")+"&nbsp;&nbsp;"+x.pendingNum+v.t("äººæš‚å®š")+"&nbsp;&nbsp;"+x.noResponseNum+v.t("äººæœªæ“ä½œ")+'&nbsp;&nbsp;<div class="mK1"><b class="js-component-icon nui-ico nui-ico-help"></b><div class="js-component-layer nui-layer nui-layer-hasArr"><b class="nui-layer-arr"></b><div class="nui-layer-normal">'+v.t("è‹¥æ”¶ä»¶äººåŒ…å«é‚®ä»¶åˆ—è¡¨ï¼Œç”±äºæ— æ³•è¯†åˆ«é‚®ä»¶åˆ—è¡¨æ˜¯å¦æ“ä½œï¼Œåˆ™é‚®ä»¶åˆ—è¡¨ä¼šè¢«å½“åš1ä¸ªæœªæ“ä½œ.length&&(h+='<dl class="mj1 mh2 fW3"><dt>'+v.t("æ¥å—è€…:")+"</dt><dd>"+C(x.acceptList)+"</dd></dl>"),x.refuseList&&x.refuseList.length&&(h+='<dl class="mj1 mh2 hH3"><dt>'+v.t("è°¢ç»è€…:")+"</dt><dd>"+C(x.refuseList)+"</dd></dl>"),x.pendingList&&x.pendingList.length&&(h+='<dl class="mj1 mh2 hI1"><dt>'+v.t("æš‚å®šè€…:")+"</dt><dd>"+C(x.pendingList)+"</dd></dl>");break;case"attendee":var x;switch((x=y.data).status){case 0:var k="icsOperate_"+ +new Date;b='<div class="sk2" id="'+k+'">'+$.Button.html({text:v.t("æ¥å—"),subclass:"mainBtn",click:function(){Promise.resolve().then(i.bind(i,26406)).then($.Function.bind((function(e){e.default.replyAttendee({sReply:"accept",oIcs:s},(function(e){"reload"!==e?$("#"+k).replace(_(1)):t.attach.showIcsAttach()}))})))}})+$.Button.html({text:v.t("æ‹’ç»"),click:function(){Promise.resolve().then(i.bind(i,26406)).then($.Function.bind((function(e){e.default.replyAttendee({sReply:"reject",oIcs:s},(function(e){"reload"!==e?$("#"+k).replace(_(2)):t.attach.showIcsAttach()}))})))}})+"</div>";break;case 1:case 2:g=_(x.status)}break;default:"PUBLISH"mh2 hI1"><dt>'+v.t("æš‚å®šè€…:")+"</dt><dd>"+C(s.attendList)+"</dd></dl>")}var S="";o&&(S='<div class="qK1">'+v.t("æ—¥ç¨‹å·²è¿‡æœŸ")+"</div>",b=""),"CANCEL"===s.method&&(S='<div class="qK1">'+v.t("æ—¥ç¨‹å·²å–æ¶ˆ")+"</div>",b="");var w=[];S&&w.push("mn1"),(g||b)&&w.push("qI1");var T=['<div class="wI0 '+w.join(" ")+'"'+(y.type?' data-ics="'+y.type+'"':"")+">",'<div class="wJ2">','<div class="wK2"><b>'+$.Date.format(c,v.t("Mæœˆ"))+"</b><strong>"+$.Date.format(c,"d")+"</strong><span>"+$.Date.format(c,v.t("å‘¨w"))+"</span></div>","</div>",'<div class="vj1">',"<h4>"+$.String.escapeHTML(s.summary)+"</h4>",'<div class="ua1">','<div class="mo1 mh2 hK1">'+r+"</div>",s.location?'<div class="mo1 mh2 gX1">'+$.String.escapeHTML(s.location)+"</div>":"",f,h,"</div>",S,g,b,"</div>","</div>"];a.push(T.join(""))}function C(e){for(var t=[],i=0;i<e.length;i++){var a,n=e[i].split(":"),o=n[n.length>1?1:0],r=$.Uri.getEmails(o,"Email",!0).match;r&&r.length>0?((a=r[0]).force=!0,a.name=$.AddressSupport.getName(a)):a={name:o.split("@")[0],address:o},t.push(a)}var s=100;for(i=0;i<t.length;i++){var c=t[i];s-=c.name.length,t[i]='<span class="'+(s<0?"_ics_item_trigger":"")+'">'+(i?v.t("ã€"):"")+$.String.escapeHTML(c.name)+"<i>"+$.String.escapeHTML(c.address)+"</i></span>"}return s<0&&t.push($.Link.html({text:"â†‘ "+v.t("æ”¶èµ·"),extcls:"_ics_item_trigger_up",click:function(e){$(e.target).findParent("dd").removeClass("_ics_item_trigger_show")}})+$.Link.html({text:"â†“ "+v.t("å±•å¼€"),extcls:"_ics_item_trigger_down",click:function(e){$(e.target).findParent("dd").addClass("_ics_item_trigger_show")}})),t.join("")}function _(e){return'<div class="sq1 mh2 '+(1===e?"fW3":"hH3")+'">'+v.t("æ‚¨å·²")+(1===e?v.t("æ¥å—"):v.t("æ‹’ç»"))+v.t("æœ¬æ¬¡ä¼šè®®é‚€è¯·")+"</div>"}return a.join("")},getReplyHtml:function(){var e=this,t=e.reader,i=v.t("å¿«æ·å›å¤"),a=i+v.t("ï¼ˆæŒ‰Ctrl+Enteré”®å‘é€ï¼‰"),n={renderTo:t.createId("dvReplyBts"),id:t.createId("sendBt"),text:v.t("&nbsp;&nbsp;å‘&nbsp;é€&nbsp;&nbsp;"),subclass:"mainBtn",click:function e(){t.log({action:"send",item:"body_reply"});var i=(0,c.$C)(t.createId("replyInput")),a=(0,c.$C)(t.createId("replyTip")),n=(0,c.$C)(t.createId("replyRetryLink")),o=(0,c.$C)(t.createId("sendBt")),r=(0,c.$C)(t.createId("cancelBt")),s=$.String.trim(i.getValue());0!==s.length?((0,c.$C)(t.createId("sendBt")).update({text:v.t("å‘é€ä¸­"),icon:"loading",click:function(){}}),r.setDisabled(),t.assistant.reply({type:"simple",content:s,call:function(i){var s,l=t.getDom("dvReplyBts"),d=t.getDom("spanReplyNbsp"),u={renderTo:l,text:v.t("å†å›ä¸€å°é‚®ä»¶"),cls:"lc0 nui-txt-link",click:function(){this.hide(),a.hide(),o.update({text:v.t("&nbsp;&nbsp;å‘&nbsp;é€&nbsp;&nbsp;"),icon:null,click:e}),o.show(),r.setDisabled(!1),r.show(),d.style.display="",(0,c.$C)(t.createId("replyInput")).setValue(""),t.getDom("dvReplyInputs").style.display="",t.getDom("fullReplyLink").style.display=""}};d.style.display="none",i?(s={text:v.t("é‚®ä»¶å‘é€æˆåŠŸï¼"),type:"suc",tabindex:"0",hidefocus:"hidefocus"},t.getDom("dvReplyInputs").style.display="none"):(s={text:v.t("æŠ±æ­‰ï¼Œé‚®ä»¶å‘é€å¤±è´¥"),type:"err",tabindex:"0",hidefocus:"hidefocus"},u.text=v.t("ç«‹å³é‡è¯•"),u.click=function(){(0,c.$C)(t.createId("sendBt")).fire("click")}),o.hide(),r.hide(),t.getDom("fullReplyLink").style.display="none",a?(a.update(s),a.show(),a.getEl().dom.focus()):(s.renderTo=l,s.id=t.createId("replyTip"),s.subclass="normalTips",(a=new $.Label(s)).getEl().dom.focus()),n?(n.unlistenAll(),n.update(u),n.listen("click",u.click),n.show()):(u.id=t.createId("replyRetryLink"),n=new $.Link(u))}})):$.Msgbox.show({header:v.t("ç³»ç»Ÿæç¤º"),content:v.t("å›å¤å†…å®¹ä¸ºç©ºï¼Œè¯·é‡æ–°è¾“å…¥åé‡è¯•ã€‚"),ok:function(){i.focus()}})}},o={renderTo:t.createId("dvReplyBts"),id:t.createId("cancelBt"),text:v.t("&nbsp;&nbsp;å–&nbsp;æ¶ˆ&nbsp;&nbsp;"),click:function(){t.log({action:"cancel",item:"body_reply"});var i=(0,c.$C)(t.createId("replyInput"));i.setValue(""),i.getInputEl().attr("style",""),i.getEl().removeClass("fK0"),t.getDom("dvReplyBts").style.display="none",t.getDom("dvAttach_reply").parentNode.style.height="auto",i.showPlaceholder(),e.replyUnfold=!1,i=void 0}},r={text:v.t("å®Œæ•´æ¨¡å¼å›å¤"),cls:"nui-txt-link",click:function(){t.log({action:"click",item:"body_fullreply"}),t.assistant.fullReply({type:"fragment",content:$.String.trim((0,c.$C)(t.createId("replyInput")).getValue())})}},s={id:t.crecls:"nf0",placeholder:i,ariaLabel:a,title:a,focus:function(){if(!e.replyUnfold){var i=this;t.getDom("dvReplyBts").style.display="";try{t.getDom("fullReplyLink").style.display=""}catch(e){}if(!t.isThread){var a=t.getDom("dvAttach_reply").parentNode;a.style.height=a.offsetHeight+116+"px",t.getDom("ScrollDiv").scrollTop+=161,a=void 0}window.setTimeout((function(){i.getEl().addClass("fK0")}),150);var s=(0,c.$C)(t.createId("sendBt")),l=(0,c.$C)(t.createId("cancelBt"));s?(s.show(),l.show()):(new $.n id="'+t.createId("spanReplyNbsp")+'">&nbsp;&nbsp;<span>'),new $.Button(o),$.fly(t.getDom("dvReplyBts")).append(['<div id="'+t.createId("fullReplyLink")+'" class="le0">','<div class="hl0">',$.Link.html(r),"</div>","</div>"].join(""))),i.hidePlaceholder(),e.replyUnfold=!0,t.log({action:"active",item:"body_reply"})}},enter:function(){var e,i=$.Event.getEvent();i&&i.ctrlKey&&(e=(0,c.$C)(t.createId("sendBt")))&&e.fire("click")},keyup:function(){var e=this.getInputEl().dom,i=e.scrollHeight;i>e.offsetHeight&&(i<=400?(e.style.overflow="hidden",e.style.height=i+"px",t.getDom("ScrollDiv").scrollTop+=i):e.style.overflow="auto")}};return['<div id="'+t.createId("dvReplyInputs")+'" class="qB0">',$.Input.html(s),"</div>",'<div id="'+t.createId("dvReplyBts")+'" class="qG0" style="display:none"></div>'].join("")},getZoomHtml:function(){var e=this.reader,t="roundBtn",i="-1",a=$.Button;return['<div id="'+e.createId("v id="'+e.createId("backToTop")+'" class="qc0 qM0" style="display:none;">',a.html({subclass:t,icon:{type:"backToTop"},extcls:"oI0",title:v.t("è¿”å›é¡¶éƒ¨"),tabindex:i,click:function(){e.log({action:"click",item:"backtotop"}),e.getDom("ScrollDiv").scrollTop=0,this.getEl().dom.parentNode.style.display="none",e.log({action:"click",item:"body_top"})}}),"</div>",'<div id="'+e.createId("showZoomBt")+'" class="qc0 me0">',a.html({subclass:t,icon:{type:"zoomIn"},extcls:"nw0",title:v.t("å±•å¼€ç¼©æ”¾å·¥å…·"),tabindex:i,click:function(){e.getDom("showZoomBt").style.display="none",e.getDom("zoomBts").st"body_zoom",value:0})}}),"</div>",'<div id="'+e.createId("zoomBts")+'" class="qc0 nv0" style="display:none;">',a.html({subclass:t,icon:{type:"bigPlus"},extcls:"ke0",title:v.t("æ”¾å¤§æ˜¾ç¤ºæ­£æ–‡æ({action:"click",item:"body_zoom"})}}),a.html({subclass:t,icon:{type:"original"},extcls:"mM0",title:v.t("è¿˜åŸæ˜¾ç¤ºæ­£æ–‡æ–‡å­—"),tabindex:i,click:function(){e.body.zoom("R"),e.log({action:"click",item:"body_zoom"})}}),a.html({subclass:t,icon:{type:"bigMinus"},extcls:"jA0",title:v.t("ç¼©å°æ˜¾ç¤ºæ­£æ–‡æ–‡å­—"),tabindex:i,click:function(){e.body.zoom("O"),e.log({action:"click",item:"body_zoom"})}}),a.html({subclass:t,icon:{type:"bigClose"},extcls:"mN0",title:v.t("éšè—ç¼©æ”¾å·¥å…·"),tabindex:i,click:function(){e.getDom("showZoomBt").style.display="",e.getDom("zoomBts").style.display="none"}}),"</div>","</div>"].join("")},getSubjectHtml:function(){var e=f.Z,t=this,i=t.reader,a=i.folderData,n=a.subject||v.t("æ— ä¸»é¢˜"),o=i.createId("h1Subject"),r=a.label0?" nui-txt-flag"+a.label0:"",s="archive"!==i.area;n=$.String.escapeHTML(n);try{n=e.fix(n)}catch(e){}var c,l='<h1 id="'+o+'" class="nui-fIBlock py0'+r+'" role="listitem" tabindex="0" title="'+v.t("é‚®ä»¶æ ‡é¢˜")+'" aria-level="1">'+n+"</h1>",d="";return i.pard&&s&&(l+='<div id="'+i.createId("divTag")+'" class="nui-fIBlock lF0"></div>',d=t.getSubjectHrefHtml("tag")),c=[t.getSubjectHrefHtml("flag"),s?t.getSubjectHrefHtml("defer"):"",t.getSubjectHrefHtml("print"),t.getSafeBrowsingEntryHtml(),'<div id="'+i.createId("divMailTracking")+'" class="gi1"></div>'].join("")),['<div class="rB0">',l,'<div class="nui-fIBlock oB0" role="toolbar">',d,c,"</div>","</div>"].join("")},getSubjectMailTrackingHtml:function(e){var t=this.reader,i=t.folderData;if(!i)return"";for(var a,n,o,r,s=i.tag||[],c=0;c<s.length;c++){if("%ex_trace_read%"===s[c]){a=!0;break}if("%ex_trace_unread%"===s[c]){a=!1;break}}if("read"===e&&(a=!0),"boolean"!=typeof a)return"";var l=[].concat(t.to||[],t.cc||[],t.bcc||[]),d=v.t("é‚®ä»¶æš‚æœªè¢«é˜…è¯»ï¼Œè¯·è€å¿ƒç­‰å¾…");a&&(d=l.length>1?v.t("å½“å‰é‚®ä»¶å·²è¢«é˜…è¯»ï¼ˆå¯èƒ½è¢«éƒ¨åˆ†æ”¶ä»¶äººå·²è¯»ï¼‰"):v.t("å½“å‰é‚®ä»¶å·²è¢«é˜…è¯»"));var u=new $.Icon({type:a?"mailTracking-read":"mailTracking-unread_light"}),m=new $.Component({html:'<span class="jC1">'+(a?v.t("æ”¶ä»¶äººå·²è¯»"):v.t("æ”¶ä»¶äººæœªè¯»"))+"</span>"});return $.Component.html({html:'<div class="qz2 '+(a?"jE1":"ht1")+'"></div>',items:[u,m],onRender:function(){r=t.getDom("ScrollDiv"),o=this.getDom()},listeners:{mouseenter:{handler:function(){n?n.show():n=new $.Layer({content:'<p class="iz1">'+d+"</p>",params:"hasArr arrUp",top:"32px",renderTo:r,pointTo:o})}},mouseleave:{handler:function(){n&&n.hide()}}}})},getSubjectMailTrackingHtml2:function(e){var t=this.reader,i=e.readCnt||0,a=e.unReadCnt||0,n=i>0,o=new $.Icon({type:n?"mailTracking-read":"mailTracking-unread_light"}),r=new $.Component({html:'<span class="jC1">'+(n?0===a?1===i?v.t("æ”¶ä»¶äººå·²è¯»"):v.t("å…¨éƒ¨æ”¶ä»¶äººå·²è¯»"):v.t("å·²è¯»")+i+v.t("äººï¼Œæœªè¯»")+a+v.t("äºº"):1===a?v.t("æ”¶ä»¶äººæœªè¯»"):v.t("æš‚æ— æ”¶ä»¶äººé˜…è¯»"))+"</span>"}),s=new $.Link({text:v.t("è¯¦æƒ…"),cls:"jD2"+(n?" fr1":""),click:function(){t.log({action:"click",item:"mailTracking_detail"}),g.default.showTraceInfo({hl:$G.environment.hl,mid:t.mid})}});return $.Component.html({html:'<div class="qz2 '+(n?"jE1":"ht1")+'"></div>',items:i+a>1?[o,r,s]:[o,r]})},setSubjectMailTrackingHtml:function(e){var t=this,i=t.reader,a=i.folderData.tag||[];function n(t,a){t&&(t='<span class="Fs0"></span>'+t),i.getDom("divMailTracking").innerHTML=t,$.Component.setEvents();var n="read"===e?"mailTracking_read":"mailTracking_unread";i.log({action:"show",item:n})}$.Array.has(a,"%ex_trace_sp%")||$.Array.has(a,"%ex_trace_att%")?g.default.getTraceInfoBrief({mid:i.mid},(function(e){var i=t.getSubjectMailTrackingHtml2(e);$.Array.has(a,"%ex_trace_sp%")||(i=t.getSubjectMailTrackingHtml(e.readCnt>0?"read":"")),n(i,e.readCnt),t.attInfo=e.attInfo,t.showAttachTracking()}),(function(){n(t.getSubjectMailTrackingHtml(e))})):n(t.getSubjectMailTrackingHtml(e))},showAttachTracking:function(e){var t=this,i=t.reader,a=i.folderData.tag||[],n=i.getDom("ulCloudAttachItem");if(t.attInfo&&n){var o=$.fly(n).find(".gh1");if(o&&0!==o.length){var r=$.Array.has(a,"%ex_trace_sp%");o.each((function(e,i){for(var a=i.getAttribute("data-download"),n=0;n<t.attInfo.length;n++){var o=t.attInfo[n],s=o.fileKey,c=o.downloadStatus;if(a.indexOf(s)>-1){var l="not_downloaded"!==c,d=new $.Icon({type:l?"mailTracking-read":"mailTracking-unread_light"}),u=new $.Component({html:'<span class="jC1">'+(l?r?"all_downloaded"===c?v.t("å…¨éƒ¨ä¸‹è½½"):v.t("éƒ¨åˆ†ä¸‹è½½"):v.t("å·²ä¸‹è½½"):v.t("æœªä¸‹è½½"))+"</span>"});i.innerHTML=$.Component.html({html:'<div class="qz2 '+(l?"jE1":"ht1")+'"></div>',items:[d,u]}),$.Component.setEvents()}}}))}}},getDateHtml:function(){return['<li class="ig0 eu0">','<div class="iI0">'+v.t("æ—¶&nbsp;&nbsp;&nbsp;é—´ï¼š")+"</div>",'<div class="hX0">'+this.getDateStr()+"</div>","</li>"].join("")},getSenderHtml:function(){var e,t,i=this.reader,a=i.folderData,n=a.from,o=i.data.headers,r=o["Resent-From"],s=o.Sender,c="";if(!n)return i.from=[v.t("å‘ä»¶äºº")],i.localSender=[],['<li class="ig0 ew0">','<div class="iI0">'+v.t("å‘ä»¶äººï¼š")+"</div>",'<div class="hX0">'+v.t("ï¼ˆæ— ï¼‰")+"</div>","</li>"].join("");if(n=(n instanceof window.Array?n[0]:n).toString().replace(/^"[+|-]/,'"'),i.from=[n],t=(e=i.module.view.getContactConf(n)).email,i.localSender=[t],r instanceof window.Array&&r.length>0)c=v.t("ç”± ")+$.String.escapeHTML(r.join(","))+v.t(" è½¬å‘");else if(!(a.ctrls&&"ntessale"===a.ctrls.RulesType||i.data.antispamInfo&&"ntessale"===i.data.antispamInfo.RulesType)&&s instanceof window.Array&&s.length>0&&n.length>0){var l=s[0];t.address!==$.Uri.getAddress(l)&&(c=v.t("ç”± ")+$.String.encodeHTML(l)+v.t(" ä»£å‘&nbsp;,&nbsp;")+$.Link.html({link:"sender_help",text:v.t("å¸®åŠ©"),target:"_blank",cls:"txt-info"}))}c.length>0&&(c='<span class="cP0">('+c+")</span>");var d=new $.Addr(e);return i.module.fromLabel=d,['<li class="ig0 ew0">','<div class="iI0">'+v.t("å‘ä»¶äººï¼š")+"</div>",'<div class="hX0">',d.html(),c,"</div>","</li>"].join("")},getReceiverHtml:function(){var e=this.reader,t=e.data,i=e.folderData,a=e.fid,n=[],o={to:v.t("æ”¶ä»¶äºº"),cc:v.t("æŠ„é€äºº")};3===a&&(o.bcc=v.t( r=e.localReceiver=[];return $.Object.each(o,(function(i,a){var o=[],s="",l=t[i]||[];if(0!==l.length||"to"===i){var d=(l="string"==typeof l?[l]:l).length;d>0&&(e[i]=l);for(var u=0;u<d;u+=1){var m=e.module.view.getContactConf(l[u]);u>4&&(m.hidden=!0),o.push($.Addr.html(m)),r.push(m.email)}if(u>0&&"bcc"===i&&o.push('<span id="_mail_label_0_439" class="js-component-label nui-txt nui-txt-i€‚)")+"</span>"),u>5){var p="nui-txt-link",f="dt0";s=[$.Link.html({id:e.createId("addrMoreLink"+i),text:v.t("&darr;è¿˜æœ‰")+(d-5)+v.t("ä¸ªè”ç³»äºº"),cls:p,spancls:f,click:function(){var t=$.fly(e.getDom("dvRead"+i)).find(".nui-addr").doms;this.hide(),(0,c.$C)(e.createId("addrLessLink"+i)).show();for(var a=5;a<d;a+=1)t[a].style.display=""}}),$.Link.html({id:e.createId("addrLessLink"+i),text:v.t("&uarr;éšè—ä¿¡æ¯"),cls:p,spancls:f,hidden:!0,click:function(){var t=$.fly(e.getDom("dvRead"+i)).find(".nui-addr").doms;this.hide(),(0,c.$C)(e.createId("addrMoreLink"+i)).show();for(var a=5;a<d;a+=1)t[a].style.display="none"}}),$.Link.html({text:v.t("ä¿å­˜æ‰€æœ‰")+a,cls:p,spancls:f,click:function(){e.assistant.saveContacts(i)}})].join("")}n.push(['<li id="'+e.createId("liReadOut"+i)+'" class="ig0 fD0">','<div class="iI0">',a,v.t("ï¼š")+"</div>",'<div id="'+e.createId("dvRead"+i)+'" class="hX0">',o.join("")||v.t("ï¼ˆæ— ï¼‰"),s,"</div>","</li>"].join(""))}})),n.join("")},getAttachHtml:function(e){var t=this,i=t.reader;return i.attached||"fullSaveId"in i.folderData?(e?['<div id="'+i.createId("attachInfo_compact")+'" class="cF1">','<b class="nui-ico nui-ico-att"></b>&nbsp;',t.getAttachInfoHtml(e),"</div>"]:['<li class="ig0 fw0">','<div class="iI0">'+v.t("é™„&nbsp;&nbsp;&nbsp;ä»¶ï¼š")+"</div>",'<div id="'+i.createId("attachInfo_full")+'" class="hX0">',t.getAttachInfoHtml(e),"</div>","</li>"]).join(""):""},getAttachInfoHtml:function(e){var t=this.reader,i=t.cloudAttachments;if(t.cloudAttached&&!i&&!t.commonAttached&&!t.isDecrypted)return"";var a,n=t.folderData,o=(t.data.attachments||[]).concat(i||[]),r=o.length,c="";if((a=r)>0){if(e)c=$.Link.html({text:(a?a+v.t("ä¸ª"):"")+v.t("é™„ä»¶"),title:v.t("ç‚¹å‡»æŸ¥çœ‹é™„ä»¶"),cls:"nui-txt-link",click:function(){t.log({action:"click",item:"head_attach"}),t.attach.skipToList()}});else{var l,d="",u=v.t("æœªå‘½åé™„ä»¶"),m=0;for((r>1||t.commonAttached&&t.cloudAttached)&&(d=v.t("ç­‰"));m<r;){if((u=$.String.trim(o[m].filename||"")).length>0){u=u.split(String.fromCharCode(92)).pop();break}m+=1}var p=$.String.left($.String.escapeHTML(u),50);l=v.t("å…±æœ‰")+p+d+a+v.t("ä¸ªé™„ä»¶ï¼Œç‚¹å‡»æŸ¥çœ‹"),c=['<span class="nui-txt-normal">'+a+v.t("ä¸ª ")+(n.fullSaveId?v.t("è¶…å¤§é™„ä»¶"):"")+"</span>",'<span class="txt-info">',"(<span>",$.Icon.html({type:"file",subtype:s.getSubtype({type:"file",name:u})}),p,"</span> ",d,")</span>","<span> ",$.Link.html({text:v.t("æŸ¥çœ‹é™„ä»¶"),title:l,cls:"nui-txt-link",click:function(){t.log({action:"click",item:"head_attach"}),t.attach.skipToList()}}),"</span>"].join("")}c=["<span >","</span>"].join(c)}return 3===n.fid&&"fullSaveId"in n&&(c+=this.getUnSavedInfo(e)),c},getMemoHtml:function(){var e=this,t=e.reader,i=e.getBacklogHtml(),a=e.getMemoTextHtml(),n=i.length&&a.length?'<div class="dr0"></div>':"";return['<li id="'+t.createId("memo")+'" class="gS0 nui-assistBlock"'+(i.length||a.length?"":' style="display:none"')+">",'<div id="'+t.createId("backlog")+'"'+(i.length?"":' style="display:none"')+">",i,"</div>",n,'<div id="'+t.createId("memoText")+'" class="dJ0"'+(a.length?"":' style="display:none"')+">",a,"</div>",'0" style="display:none"></div>',"</li>"].join("")},getBacklogHtml:function(){var e,t=this.reader,i=t.mid,a=t.folderData,n=a.flags||{},o=a.defer;return n.deferHandle&&void 0!==o?(e=(0,c.$S)("schedule"),$.Ext.scheduleMbox&&void 0!==e&&e[i],['<div id="'+t.createId("backlog_defer")+'" class="dJ0">','<div class="cm0"><b class="nui-ico nui-ico-todo nui-ico-todo-selected" title="'+v.t("å¾…åŠé‚®ä»¶")+'"></b></div>','<div class="bZ0">','<div class="er1">'+v.t("å·²è®¾ä¸ºå¾…åŠé‚®ä»¶ï¼Œ")+$.Date.format(o,v.t("yyyyå¹´MMæœˆddæ—¥"))+v.t("å¤„ç†&nbsp;"),$.Link.html({text:v.t("ä¿®æ”¹"),cls:"nui-txt-link",click:function(){t.module.showDeferPanel({type:"modify"})}}),"</div>",'<div class="ce0">',$.Button.html({text:v.t("è®¾ä¸ºå®Œæˆ"),subclass:"smallMainBtn",icon:{type:"done",subtype:"white"},subType:"white",click:function(){t.module.setDefer()}}),"</div>","</div>","</div>"].join("")+[].join("")):""},getMemoTextHtml:function(e){var t=this.reader;return(e=$.String.trim(e||t.folderData.memo||"")).length>0?['<div class="cm0"><b class="nui-ico nui-ico-remark-xs" title="'+v.t("é‚®ä»¶å¤‡æ³¨")+'"></b></div>','<div class="bZ0">','<div class="er1">',$.String.escapeHTML(e),"</div>",'<div class="dI0">',$.Link.html({text:v.t("ç¼–è¾‘"),cls:"nui-txt-link",click:function(){t.assistant.editMemo()}}),"&nbsp;&nbsp;",$.Link.html({text:v.t("åˆ é™¤"),cls:"nui-txt-link",click:function(){$.Msgbox.show({type:"confirm",title:v.t("åˆ é™¤ç¡®è®¤"),content:v.t("æ‚¨ç¡®å®šè¦åˆ é™¤è¯¥é‚®ä»¶çš„å¤‡æ³¨å—ï¼Ÿ"),ok:function(){t.assistant.setMemo({del:!0,value:""}),t.getDom("memo").style.display="none"}})}}),"</div>","</div>"].join(""):e},getMemoEditorHtml:function(){var e=this.reader;return[$.Input.html({id:e.createId("memoInput"),subclass:"multiLineIpt",extcls:"bV0",inputClass:"K0",value:$.String.trim(e.folderData.memo||""),listeners:{keyup:function(){var t=$.String.trim(this.getValue()).length;e.getDom("memoInfo").innerHTML=t>100?v.t("æ‚¨å·²è¾“å…¥ ")+"<strong>"+t+"</strong>"+v.t(" å­—ï¼Œ")+'<span class="nui-txt-err">'+v.t("è¯·åˆ é™¤ ")+"<strong>"+(t-100)+"</strong>"+v.t(" å­—")+"</span>":v.t("æ‚¨å·²è¾“å…¥ ")+"<strong>"+t+"</strong>"+v.t(" å­—ï¼Œè¿˜èƒ½è¾“å…¥ ")+"<strong>"+(100-t)+"</strong>"+v.t(" å­—")}}}),'<div class="cd1">',$.Button.html({text:v.t("ç¡®å®š"),subclass:"mainBtn",extcls:"bt0",click:function(){var t=$.String.trim((0,c.$C)(e.createId("memoInput")).getValue()),i=t.length;0===i||i>100?$.Msgbox.show({statsKey:"Read_NoGuide_Popup_CommentLimit",header:v.t("ç³»ç»Ÿæç¤º"),content:0===i?v.t("è¯·è¾“å…¥å¤‡æ³¨å†…å®¹åé‡è¯•ã€‚"):v.t("æ‚¨è¾“å…¥çš„æ–‡å­—å¤šäº")+"<strong>100</strong>"+v.t("ä¸ªå­—ç¬¦ï¼Œè¯·åˆ é™¤")+"<strong>"+(i-100)+"</strong>"+v.t("ä¸ªå­—ç¬¦åé‡è¯•ã€‚"),ok:function(){(0,c.$C)(e.createId("memoInput")).focus()}}):t!==e.folderData.memo?(e.assistant.setMemo({type:"edit",value:t}),e.folderData.memo=t,e.assistant.editMemo(!0)):e.assistant.editMemo(!0)}}),"&nbsp;&nbsp;",$.Button.html({text:v.t("å–æ¶ˆ"),extcls:"bt0",click:function(){e.assistant.editMemo(!0)}}),'<span id="'+e.createId("memoInfo")+'" class="bv0"></span>',"</div>"].join("")},getHeaderLinkHtml:function(e){var t=this.reader;if(e)return[$.Icon.html({type:"glasses"}),$.Link.html({cls:"nui-txt-link",text:v.t("ä¼˜åŒ–é˜…è¯»"),click:function(){try{$.fly("#dvOptimizedContent").remove(),$.fly("#read_mask").remove()}catch(e){}t.body.showOptimizedContent()}}),'&nbsp;<span style="color:#E5E5E5">|<span>&nbsp;'].join("");var a=$.Ud.get({field:"ntes_letter",flag:"read_head"}),n=t.isThread||"1"===a;return[$.Link.html({id:t.createId("compactLink"),cls:"nui-txt-link",title:v.t("ç‚¹å‡»ä½¿ç”¨ç²¾ç®€æ˜¾ç¤ºæ¨¡å¼"),text:v.t("ç²¾ç®€ä¿¡æ¯")+'<b class="nui-ico jS0">k</b>',hidden:n,click:function(){t.log({action:"click",item:"head_compact"}),t.showHeader(!0),this.hide(),(0,c.$C)(t.createId("fullLink")).show(),t.isThread||Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(e){e.default.setAttr({field:"ntes_letter",flag:"read_head",value:1,module:"read"})}))),$.Component.setEvents(50)}}),$.Link.html({id:t.createId("fullLink"),cls:"nui-txt-link",title:v.t("ç‚¹å‡»ä½¿ç”¨å®Œæ•´æ˜¾ç¤ºæ¨¡å¼"),text:v.t("å®Œæ•´ä¿¡æ¯")+'<b class="nui-ico jS0">j</b>',hidden:!n,click:function(){t.log({action:"click",item:"head_compelete"}),t.showHeader(!1),this.hide(),(0,c.$C)(t.createId("compactLink")).show(),t.isThread||Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(e){e.default.setAttr({field:"ntes_letter",flag:"read_head",value:0,module:"read"})}))),$.Component.setEvents(50)}})].join("")},getSafeBrowsingEntryHtml:function(){var e=this,t=e.reader;return $.Component.html({html:'<span class="ua2" style="display: none"><span class="Fs0"></span>'+$.Link.html({id:t.createId("safeBrowsing"),cls:"GX0",text:'<b class="nui-ico nui-ico-sb"></b><span class="zK0">'+v.t("å®‰å…¨æµè§ˆæ¨¡å¼")+'</span><b class="nui-ico nui-ico-unfold"></b><span id="'+t.createId("safeBrowsingHook")+'" class="zL0"></span>',click:function(i){var a=this.getEl();a.hasClass("vH2")||(t.log({action:"click",item:"head_sb"}),e.showSbSettingsPanel(a),(0,c.$S)("mailSecurityAccessConfig_content_cb")&&(0,c.$S)("mailSecurityAccessConfig_content_cb")())}})+"</span>",onRender:function(){if(!$.Browser.isIE()){var e=this.getDom();$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig","product.plus.mailSecurityAccessStatus"],call:function(i){var a={};try{a=JSON.parse(i["webmail.js.mailSecurityAccessConfig"]),JSON.parse(i["product.plus.mailSecurityAccessStatus"])}catch(e){}e.style.display="";var n=(0,c.$C)(t.createId("safeBrowsing")).getEl();if(a.enable?n.addClass("nui-hl"):n.removeClass("nui-hl"),a.protocolHidden){var o=a.noSurvey||0,r=!0,s=(new Date).getTime();-1===o&&(r=!1),o>0&&s<o&&(r=!1),r&&(t.log({action:"show",item:"sb_survey"}),a.noSurvey=s+6048e5,$.Ud.setProxy({field:"webmail.js.mailSecurityAccessConfig",value:JSON.stringify(a)}),$.Popup.show({title:v.t("æ‚¨çš„å£°éŸ³ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å˜å¾—æ›´å¥½ï¼"),content:v.t("æ–°åŠŸèƒ½è°ƒç ”-å®‰å…¨æµè§ˆæ¨¡å¼"),okText:v.t("ç«‹å³å‚åŠ "),pauseTime:15e3,ok:function(){$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig"],call:function(e){var i={};try{i=JSON.parse(e["webmail.js.mailSecurityAccessConfig"])}catch(e){}i.noSurvey=-1,t.log({action:"click",item:"sb_survey_ok"}),$.Ud.setProxy({field:"webmail.js.mailSecurityAccessConfig",value:JSON.stringify(i),call:function(){window.open("https://xbsy.dingwei.netease.com/survey/wzpw9p/paper","_blank")}})}})},close:function(){$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig"],call:function(e){var t={};try{t=JSON.parse(e["webmail.js.mailSecurityAccessConfig"])}catch(e){}t.noSurvey=-1,$.Ud.setProxy({field:"webmail.js.mailSecurityAccessConfig",value:JSON.stringify(t)})}})}}))}}}),$.Support.getMarketingPositionData({key:"mailSecurityAccessConfig",callback:function(i){if(i){var a=i.config||{},n=a.content||"",o=a.subContent||"",r=(i.showLimit||{}).gapDays||0,s=$.LocalStorage.get("mailSecurityAccessConfig_content_"+(0,c.$S)("uid"));n&&!s&&($(e).find(".zK0").append("<i>"+n+"</i>"),t.log({action:"show",item:"sb_settings_promot"}),(0,c.$S)("mailSecurityAccessConfig_content_cb",(function(){$.LocalStorage.set("mailSecurityAccessConfig_content_"+(0,c.$S)("uid"),1,{expires:r}),$(e).find(".zK0 i").remove(),(0,c.$S)("mailSecurityAccessConfig_content_cb",null),t.log({action:"click",item:"sb_settings_promot"})})));var l=$.LocalStorage.get("mailSecurityAccessConfig_subContent_"+(0,c.$S)("uid"));o&&!l&&(0,c.$S)("mailSecurityAccessConfig_subContent_cb",(function(){$.LocalStorage.set("mailSecurityAccessConfig_subContent_"+(0,c.$S)("uid"),1,{expires:r}),(0,c.$S)("mailSecurityAccessConfig_subContent_cb",null),t.log({action:"click",item:"sb_upload_promot"})}))}}})}}})},showSbSettingsPanel:function(e){var t=this.reader;t.module.safeBrowsingKitLoading||(t.module.ensureSafeBrowsingKit((function(i){i.showSettingsModal({triggerElem:t.getDom("safeBrowsingHook"),wrapper:t.getDom("dvReadHeadInfo"),enabled:e.hasClass("nui-hl"),onMount:function(){e.addClass("vH2")},onUnmount:function(){e.removeClass("vH2")},onSbChange:function(i){t.log({action:"click",item:"sb_settings_switch",value:{enable:i}}),i?e.addClass("nui-hl"):e.removeClass("nui-hl"),$.Ud.getProxy({field:["webmail.js.mailSecurityAccessConfig"],call:function(e){var t={};try{t=JSON.parse(e["webmail.js.mailSecurityAccessConfig"])}catch(e){}t.enable=i,$.Ud.setProxy({field:"webmail.js.mailSecurityAccessConfig",value:JSON.stringify(t)})}})},onSbBuy:function(e){e.stat&&t.log({action:"click",item:e.stat}),$.getClass((0,c.$N)("product.Privileges")).showSafeBrowsingBuy({utmSource:e.utmSource,customUserInfo:{hasAgreement:!1,agreementCancelAble:!1,info:e.msg||""}})},onUploadOpen:function(){t.log({action:"click",item:"sb_upload_open"}),window.SafeBrowsingKit.showUploadModal({onLog:function(e){t.log(e)},onClose:function(e){"buttonCancel"===e?t.log({action:"click",item:"sb_upload_cancel"}):t.log({action:"click",item:"sb_upload_close"})},onUploadLinkOpen:function(e){var i;if(e.stat&&t.log({action:"click",item:e.stat}),0===e.type)i="https://"+(0,c.$S)("fullDomain")+"/projects/safe-browsing/?utm_source=web&targetUrl="+encodeURIComponent(e.url)+"&uid="+encodeURIComponent(e.uid);else{if(1!==e.type)return;i="https://"+(0,c.$S)("fullDomain")+"/projects/safe-browsing/attachment.html?attachType=nos&uid="+encodeURIComponent(e.uid)+"&md5="+encodeURIComponent(e.md5)+"&fileKey="+encodeURIComponent(e.fileKey)+"&fileName="+encodeURIComponent(e.fileName)}t.body.openUrl(i)},onSbBuy:function(e){e.stat&&t.log({action:"click",item:e.stat}),$.getClass((0,c.$N)("product.Privileges")).showSafeBrowsingBuy({utmSource:e.utmSource,customUserInfo:{hasAgreement:!1,agreementCancelAble:!1,info:e.msg||""}})}}),(0,c.$S)("mailSecurityAccessConfig_subContent_cb")&&(0,c.$S)("mailSecurityAccessClSecurityAccessConfig_subContent_cb")})})),(0,c.$S)("mailSecurityAccessConfig_subContent_cb")&&t.log({action:"show",item:"sb_upload_promot"}))},getSubjectHrefHtml:function(e,t){var a,n=this.reader,o=n.folderData,r=n.createId(e+"HeadBt"),s="noBg",c="miniBtn",l="",d={mouseover:{handler:function(){$.fly(this).find("b").removeClass(l)}},mouseout:{handler:function(){$.fly(this).find("b").addClass(l)}}};switch(e){case"flag":var u,m=o.label0;u=m?{type:"flag",subtype:m+""}:{type:"flagNone",subtype:"transparent"},a={title:v.t("è®¾ä¸ºçº¢æ——"),subclass:c,type:s,icon:u},d.click=function(){n.log({action:"click",item:"icon_flag",value:$.Support.getStatsMailinfo({value:1})}),n.assistant.setFlag(-1)};break;case"defer":var p;(o.flags||{}).deferHandle&&o.defer?(p="todo-selected",l="nui-ico-todo-selected-transparent",d.render=function(){var e=this.getEl(),t=38,a=e.offset().x-201;a<382-t-20&&(t=0),Promise.resolve().then(i.bind(i,67979)).then($.Function.bind((function(i){var r,s=i.default.getMenu({data:o,left:t,top:10,complete:function(){n.module.setDefer()},modify:function(){n.module.showDeferPanel({type:"modify"})},modifySms:function(){n.module.showDeferPanel({type:"modify",smsShow:!0})},modifyMemo:function(){n.module.showDeferPanel({type:"modify",memoShow:!0})},delete:function(){n.assistant.setMemo({del:!0,value:""})}});0===t&&(s.listeners={render:function(){$.fly(r.getEl().find(".nui-layer-arr").doms[0]).css({left:a+"px",right:"auto"})}}),(r=new $.Menu(s)).attachTo({clickFrom:e}),e=void 0})))},d.click=function(){n.log({action:"click",item:"icon_defer"})}):(p="todo",l="nui-ico-todo-transparent",d.click=function(){n.log({action:"click",item:"icon_defer"}),Promise.resolve().then(i.bind(i,67979)).then($.Function.bind((function(e){e.default.showMsgbox({type:"modify",data:{defer:o.defer,memo:o.memo,mid:n.mid},callback:function(e){n.module.setDefer(!0,{type:"modify",defer:e.defer,memo:e.memo,smsDate:e.smsDate,data:o})}})})))}),a={title:v.t("å¾…åŠé‚®ä»¶"),subclass:c,type:s,icon:{type:p,subtype:"transparent"}};break;case"print":a={title:v.t("æ‰“å°"),subclass:c,type:s,icon:{type:"print",subtype:"transparent"}},l="nui-ico-print-transparent",d.click=function(){n.log({action:"click",item:"icon_print"}),n.assistant.blankView(!0)};break;case"tag":a={title:v.t("é‚®ä»¶æ ‡:"tags",subtype:"transparent"}},l="nui-ico-tags-transparent",d.click=function(){n.log({action:"click",item:"icon_tag"})},d.render=function(){var e=n.module.view.getTagConf("icon");e.id=n.createId("subjectTagMenu"),e.reverse=!1,new $.Menu(e).attachTo({clickFrom:this.getEl()})}}return a.id=r,a.listeners=d,t?a:$.Button.html(a)},getBlockConf:function(e,t){var a,n=this,o=n.reader,r=o.createId(e),s="sV0",d="assistBlock",u="nui-txt-link";switch(e){case"mailStatus":a={icon:t.icon,content:['<div class="qu0">','<p  class="nui-txt-normal">',t.msg,$.Link.html({id:o.createId("readCheckStatus"),text:v.t("æŸ¥çœ‹è¯¦æƒ…"),cls:u,click:function(){var e=this,t=(0,c.$C)(o.createId("mailTable")),i=void 0===t;o.assistant.queryMailStatus("mail",r,i,(function(){i||t.show(),e.hide(),(0,c.$C)(o.createId("readHideStatus")).show(),(0,c.$C)(o.createId("readRefreshStatus")).show()}))}}),$.Link.html({id:o.createId("readHideStatus"),text:v.t("éšè—è¯¦æƒ…"),cls:u,hidden:!0,click:function(){(0,c.$C)(o.createId("mailTable")).hide(),this.hide(),(0,c.$C)(o.createId("readRefreshStatus")).hide(),(0,c.$C)(o.createId("readCheckStatus")).show()}}),$.Link.html({id:o.createId("readRefreshStatus"),text:v.t("åˆ·æ–°"),cls:u,hidden:!0,click:function(){(0,c.$C)(o.createId("mailTable")).destroy(),o.assistant.queryMailStatus("mail",r,!0)}}),"</p>","</div>"].join("")};break;case"sendStatus":var m;if(t.info.ext&&(m=t.info.ext.type),void 0===m)return m;a={extcls:s+" qh0",icon:m+"State",content:['<div class="qu0">',"<p>",("recall"===m?v.t("æ’¤å›çŠ¶æ€"):v.t("å‘é€çŠ¶æ€"))+v.t("ï¼š")+'<strong id="'+o.createId("sendStatusText")+'" class="'+["","nui-txt-suc","nui-txt-err","nui-txt-impt"][t.info.ext.status]+'">'+t.info[1]+"</strong>",$.Link.html({id:o.createId("readCheckStatus"),text:v.t("æŸ¥çœ‹è¯¦æƒ…"),cls:u,click:function(){var e=this,t=(0,c.$C)(o.createId(m+"Table")),i=void 0===t;o.assistant.queryMailStatus(m,r,i,(function(){i||t.show(),e.hide(),(0,c.$C)(o.createId("readHideStatus")).show(),(0,c.$C)(o.createId("readRefreshStatus")).show()}))}}),$.Link.html({id:o.createId("r,hidden:!0,click:function(){(0,c.$C)(o.createId(m+"Table")).hide(),this.hide(),(0,c.$C)(o.createId("readRefreshStatus")).hide(),(0,c.$C)(o.createId("readCheckStatus")).show()}}),$.Link.html({id:o.createId("readRefreshStatus"),text:v.t("åˆ·æ–°"),cls:u,hidden:!0,click:function(){(0,c.$C)(o.createId(m+"Table")).destroy(),o.assistant.queryMailStatus(m,r,!0)}}),"</p>","</div>"].join("")};break;case"subscribe":a={content:['<div class="qu0">','<p id="'+o.createId(e)+'" class="nui-txt-normal">',v.t("å¦‚æœè¿™å°é‚®ä»¶ä¸æ˜¯æ‚¨è®¢é˜…çš„ï¼Œè¯· "),$.Link.html({text:v.t("ä¸¾æŠ¥"),cls:u,click:function(){o.module.report(!0)}}),v.t("ï¼›å¦‚æœæ˜¯åˆ†ç±»é”™è¯¯çš„é‚®ä»¶ï¼Œå¯ä»¥ "),$.Link.html({text:v.t("æ·»åŠ åˆ°ç™½åå•"),cls:u,click:function(){var t=o.localSender[0];void 0!==t?Promise.resolve().then(i.bind(i,4982)).then($.Function.bind((function(i){i.default.addList({name:"safelist",value:t.address},(function(t){t&&(o.getDom(e).innerHTML='<span class="nui-txt-suc">'+v.t("å‘ä»¶äººå·²è¢«åŠ å…¥ç™½åå•ï¼Œè¯¥å‘ä»¶äººä»Šåå‘é€çš„é‚®ä»¶å°†ä¼šè¿›å…¥æ”¶ä»¶ç®±")+"</span>")}))}))):$.Tips.show({type:"err",text:v.t("å‘ä»¶äººåœ°å€é”™è¯¯")})}}),"</p>","</div>"].join("")};break;case"spamFolder":a={icon:"alert",params:"hasClose",content:['<div class="qu0">','<p class="nui-txt-normal">','<span class="nui-txt-impt">'+v.t("è¯·ç•™æ„ï¼šæ­¤é‚®ä»¶åœ¨åƒåœ¾¿¡æ¯ã€ä¸­å¥–éœ€æ±‡æ¬¾è½¬è´¦ç­‰ä¿¡æ¯ï¼Œè¯·è°¨é˜²ç½‘ç»œæ¬ºè¯ˆï¼")+"</span>",$.Link.html({text:v.t("æŸ¥çœ‹è¯¦æƒ…"),target:"_blank",noParam:!0,link:"read_yjzp"}),"</p>","</div>"].join("")};break;case"junkPic":a={params:"hasClose",icon:"alert",content:['<div class="qu0">','<p class="nui-txt-impt">',v.t("è¯¥é‚®ä»¶ä¸­åŒ…å«äº†å›¾ç‰‡ï¼Œ"),$.Link.html({text:v.t("ç‚¹å‡»è¿™é‡Œæ˜¾ç¤ºå›¾ç‰‡"),cls:u,click:function(){o.junkPic=!1,o.assistant.bodyFilter("mail"),(0,c.$C)(r).destroy()}}),"</p>","</div>"].join("")};break;case"EAI":a={params:"hasClose",icon:"alert",content:['<div class="qu0">','<p class="nui-txt-normal">',v.t("æç¤ºå†…å®¹ï¼šå‘ä»¶äººæ˜¯ä¸€ä¸ªå›½é™…åŒ–ç”µå­é‚®ä»¶åœ°å€ï¼ˆEAIï¼‰ï¼Œè§£ç å‰ä¸º "),t.EAI,v.t("ï¼Œè¯·è°¨æ…è¾¨åˆ«"),"</p>","</div>"].join("")};break;case"UTF":a={params:"hasClose",icon:"alert",content:['<div class="qu0">','<p class="nui-txt-normal">',v.t("å‘ä»¶äººåŒ…å«ç‰¹æ®ŠUTFå­—ç¬¦ï¼Œè¯·è°¨æ…è¾¨åˆ«"),"</p>","</div>"].join("")};break;case"fromAttack":a={params:"hasClose",icon:"alert",content:['<div class="qu0">','<p class="nui-txt-normal">',v.t("å‘ä»¶äººåŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆåŸå§‹åœ°å€ä¸º"),'<span style="color: #DB3434;">'+t.from+"</span>",v.t("ï¼‰ï¼Œå­˜åœ¨è¯ˆéª—é£é™©ï¼Œè¯·è°¨æ…è¾¨åˆ«ï¼"),"</p>","</div>"].join("")};break;case"decryptForm":var p=$.Email.checkFree(o.localSender[0].address)||$.Email.checkVip(o.localSender[0].address);a={icon:"encrypt32",extcls:s+" no0",content:['<div class="qu0">','<p class="nui-txt-normal">'+v.t("è¿™æ˜¯ä¸€å°ç”± ")+'<strong class="nui-txt-suc">'+$.String.escapeHTML(o.localSender[0].defaultName)+"</strong>"+(p?v.t(" ä»ç½‘æ˜“é‚®ç®±å‘å‡ºçš„åŠ å¯†é‚®ä»¶ã€‚"):v.t(" å‘å‡ºçš„åŠ å¯†é‚®ä»¶ã€‚")),p?$.Link.html({link:"read_decrypt_help",title:v.t("æŸ¥çœ‹ä½¿ç”¨è¯´æ˜"),text:v.t("æŸ¥çœ‹ç½‘æ˜“é‚®ç®±åŠ å¯†é‚®ä»¶çš„ä½¿ç”¨è¯´æ˜"),target:"_blank"}):"","</p>",'<p class="nui-txt-normal">'+v.t("è¾“å…¥å‘ä»¶äººæä¾›ç»™æ‚¨çš„å¯†ç ï¼Œå³å¯æŸ¥é˜…å®Œæ•´é‚®ä»¶")+'<span class="nui-txt-tips">'+v.t("(æ‚¨å¯ä»¥é€šè¿‡ç”µè¯ã€çŸ­ä¿¡æˆ–å…¶ä»–æ–¹å¼å‘å‘ä»¶äººç´¢å–å¯†ç )")+"</span></p>",'<div class="iG0 nui-txt-normal">'+v.t("è¾“å…¥å¯†ç ï¼š"),$.Input.html({id:o.createId("decryptInput"),inputType:"password",placeholder:v.t("åœ¨æ­¤è¾“å…¥å¯†ç "),maxLength:6,listeners:{enter:function(){var e=this;e.fire("keydown"),o.decryption.decrypt({pwd:this.getValue(),call:function(t){void 0===t.error?((0,c.$C)(o.createId("decryptForm")).destroy(),o.addBlockInfo("decryptResult")):e.errorTips=new $.Tips({text:t.error,subclass:"normalTips",type:"err",renderTo:e.getEl().dom.parentNode})}})},keydown:function(){void 0!==this.errorTips&&this.errorTips.destroy()}}}),$.Button.html({text:v.t("ç¡®å®š"),title:v.t("æäº¤å¯†ç è¿›è¡Œè§£å¯†"),subclass:"inputBtn",click:function(){(0,c.$C)(o.createId("decryptInput")).fire("enter")}}),"&nbsp;","</div>","</div>"].join("")};break;case"decryptSuc":a={params:"hasClose",icon:"decrypt32",content:['<div class="qu0">','<p class="nui-txt-suc">'+v.t("é‚®ä»¶å·²è§£å¯†ï¼Œä»¥ä¸‹æ˜¯è§£å¯†åçš„é‚®ä»¶å†…å®¹ï¼š")+"</p>","</div>"].join("")};break;case"decryptPwd":a={params:"hasClose",extcls:s+" no0 nr0",icon:"encrypt",content:'<div class="qu0"><span class="nui-txt-normal">'+v.t("åŠ å¯†é‚®ä»¶çš„å¯†ç ä¸ºï¼š")+$.String.escapeHTML(t.pwd)+"</span></div>"};break;case"systemWarn":a={params:"hasClose",icon:"alert",content:['<div class="qu0">','<p class="nui-txt-impt">',v.t("è¯·æ³¨æ„ï¼šæ­¤é‚®ä»¶æœ‰å¯èƒ½å­˜åœ¨ä»¿å†’ï¼Œè¯·ä¸è¦è½»æ˜“é€éœ²ä¸ªäººé‡è¦ä¿¡æ¯ï¼Œæé«˜è­¦æƒ•ï¼Œè°¨é˜²ç½‘ç»œè¯ˆéª—ï¼"),$.Link.html({text:v.t("æŸ¥çœ‹è¯¦æƒ…"),link:"read_yjzp",target:"_blank"}),"</p>","</div>"].join("")};break;case"DAWarn":a={params:"hasClose",icon:"alert",content:['<div class="qu0">','<p class="nui-txt-impt">',v.t("æç¤ºï¼šè¯¥é‚®ä»¶å¯èƒ½æ˜¯è¯ˆéª—é‚®ä»¶æˆ–é’“é±¼é‚®ä»¶ï¼è¯·ä»”ç»†æ£€æŸ¥å‘ä»¶äººå’Œé‚®ä»¶å†…å®¹ï¼Œä¸è¦è½»æ˜“æ³„éœ²è´¦å·å¯†ç ç­‰å®‰å…¨ä¿¡æ¯ï¼Œè¯·è°¨æ…è¯†åˆ«ï¼Œä¸‡å‹¿è½»ä¿¡ã€‚"),$.Link.html({text:v.t("ç«‹å³ä¸¾æŠ¥"),cls:"nui-txt-link nui-txt-link-impt",attrs:'style="color:#fff!important;"',click:function(){o.module.report(!0)}}),"</p>","</div>"].join("")};break;case"DAGray":var f="forbid"===t.type,h="";t.tips&&!f&&(h='<span class="Fu0">'+$.Icon.html({type:"help"})+'<div class="nui-layer nui-layer-hasArr nui-layer-ar; right: -36px; top: 24px; display: none;"><b class="nui-layer-arr" style="right: 32px;left: auto;"></b><div class="nui-layer-normal">'+t.tips+"</div></div></span>",setTimeout((function(){var e=$(".Fu0");e&&e.mouseenter((function(){b("read_blockinfo_mailtag_tip_show")}))})asClose",icon:f?"forbid":"alert",extcls:f?"sV0 Fv0":"sV0",content:['<div class="qu0 nui-txt-normal" style="margin-left: 20px;">',t.title?"<b>"+t.title+"</b><br>":"","<span>"+(t.desc||"")+"</span>",h,"&nbsp;&nbsp;&nbsp;&nbsp;",$.Link.html({text:t.okText,cls:"nui-txt-link GW0",click:function(){b("read_blockinfo_mailtag_spam_click"),(0,c.$C)(r).destroy(),(new l.Z).wmsvr({func:"mbox:updateMessageTags",body:{ids:o.mid,add:["%st_m_graydone%"]}});var e=new $.Link({text:v.t("ã€å‚ä¸ä¸ªæ€§åŒ–ååƒåœ¾è®¡åˆ’ã€‘"),click:function(){b("read_blockinfo_mailtag_feedbackLink");for(var e=[{text:v.t("è®¢é˜…"),value:"13",checkedchange:s},{text:v.t("å¹¿å‘Š"),value:"14",checkedchange:s},{text:v.t("å¾ç¨¿/åŸ¹è®­/ä¼šè®®"),value:"7",checkedchange:s},{text:v.t("ä»£å¼€å‘ç¥¨"),value:"5",checkedchange:s},{text:v.t("é’“é±¼/ç—…æ¯’"),value:"6",checkedchange:s},{text:v.t("è‰²æƒ…"),value:"12",checkedchange:s},{text:v.t("è¿æ³•"),value:"10",checkedchange:s},{text:v.t("åƒåœ¾"),value:"11",checkedchange:s}],t=[],i=[],a=0;a<e.length;a++){var n=new $.Radio(e[a]);i.push(n),a%2==0&&t.push("<tr>"),t.push('<td style="padding-right: 10px;">'),t.push(n.html()),t.push("</td>"),a%2==1&&t.push("</tr>")}e.length%2==1&&t.push("</tr>"),$.Radio.group(i);var o='<div class="xf1">'+v.t("ä¸ºæå‡ååƒåœ¾ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«å‡†ç¡®æ€§ï¼Œéœ€è¦è·å–æ›´å¤šé‚®ä»¶ä¿¡æ¯ï¼Œæ‚¨è®¤ä¸ºè¯¥å°é‚®ä»¶å±äºä»€ä¹ˆç±»å‹ï¼š")+'<div class="kZ1" style="border: 0; margin: 20px 0 0;"><table style="width: 100%; table-layout: fixed;">'+t.join("")+"</table></div></div>",r=$.Msgbox.show({statsKey:"read_blockinfo_mailtag_feedback",title:v.t("æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼"),content:o,width:"560px",ok:function(){var e=i[0].ownerGroup.value;$.Tips.show({succ:!0,text:v.t("åé¦ˆæˆåŠŸï¼")}),b("read_blockinfo_mailtag_feedback_click",{typeId:e})},cancel:function(){}});function s(){b("read_blockinfo_mailtag_feedback_select",{typeId:i[0].owne(!0)}}).html();f?(o.module.moveTo({toFid:5===o.fid?4:5}),$.Tips.show({succ:!0,text:v.t("åé¦ˆæˆåŠŸï¼")})):(o.module.moveTo({toFid:5}),$.Tips.show({succ:!0,text:v.t("åé¦ˆæˆåŠŸï¼")+e}))}}),"&nbsp;&nbsp;",$.Link.html({text:t.cancelText,cls:"nui-txt-link",click:function(){b("read_blockinfo_mailtag_notspam_click"),(0,c.$C)(r).destroy(),(new l.Z).wmsvr({func:"mbox:updateMessageTags",body:{ids:o.mid,add:["%st_m_graydone%"]}})}}),"</div>"].join(""),closeclick:function(){(0,c.$C)(r).destroy(),(new l.Z).wmsvr({func:"mbox:updateMessageTags",body:{ids:o.mid,add:["%st_m_graydone%"]}}),b("read_blockinfo_mailtag_close_click")}};break;case"SensWarn":a={params:"hasClose",icon:"alert",content:['<div class="qu0">',v.t("è‹¥æ¶‰åŠèµ„é‡‘å¾€æ¥ï¼Œä¿¡æ¯å¡«å†™ï¼Œè¯·æ ¸å®å¯¹æ–¹èº«ä»½ï¼Œä»¥é˜²å—éª—ã€‚"),'<span style="display: none;" class="dvReadBlockinfoSensButs1">',$.Link.html({text:v.t("ä¸¾æŠ¥"),cls:"nui-txt-link",click:function(){o.module.report(!0),b("read_blockinfo_sens_report_click")}}),"&nbsp;",$.Link.html({text:v.t("å¿½ç•¥"),cls:"nui-txt-link Bz0",click:function(){var e=this;(new l.Z).wmsvr({func:"mbox:updateMessageTags",body:{ids:o.mid,delete:["%st_sys_sens%"]},call:function(t){e.el.findParentFly(".sV0").hide(),b("read_blockinfo_sens_ignore_click")}})}}),"&nbsp;","&nbsp;",$.Link.html({text:$.Icon.html({type:"help"}),attrs:'style="position: relative; top: -1px;"',click:function(){window.open($.Uri.getUrl("read_yjzp",!0),"_blank"),b("read_blockinfo_sens_more_click")}}),"</span>",'<span style="display: none;" class="dvReadBlockinfoSensButs2">','<span style="color: #979797;">'+v.t("è¯¥æç¤ºå¯¹æ‚¨æ˜¯å¦æœ‰ç”¨ï¼Ÿ")+"</span>","&nbsp;",$.Link.html({text:v.t("æ˜¯"),cls:"nui-txt-link nui$.Ud.setProxyBit({field:"webmail.js.helptips",flag:"read_blockinfo_sens_tips",value:"1"}),$.Msgbox.show({title:v.t("æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼"),content:v.t("ä¸ºäº†æ‚¨çš„é‚®ä»¶å®‰å…¨ï¼Œå¸Œæœ›æ‚¨è¿›ä¸€æ­¥ç¡®è®¤è¿™å°é‚®ä»¶æ˜¯å¦æ˜¯åƒåœ¾é‚®ä»¶ï¼Œæ‚¨çš„æ„è§å°†å¸®åŠ©æˆ‘ä»¬æå‡åƒåœ¾é‚®ä»¶æ‹¦æˆªæ•ˆæœï¼Œæ„Ÿè°¢æ”¯æŒã€‚"),okText:v.t("æ˜¯ï¼Œæˆ‘è¦ä¸¾æŠ¥"),ok:function(){b("read_blockinfo_sens_yes_report_click"),o.module.report(!0)},cancelText:v.t("è¿™ä¸æ˜¯åƒåœ¾é‚®ä»¶"),cancel:function(){b("read_blockinfo_sens_yes_ignore_click"),(new l.Z).wmsvr({func:"mbox:updateMessageTags",body:{ids:o.mid,delete:["%st_sys_sens%"]},call:function(t){e.el.findParentFly(".sV0").hide()}})},close:function(){b("read_blockinfo_sens_yes_close_click")}}),b("read_blockinfo_sens_yes_click"),b("read_blockinfo_sens_yes_show")}}),"&nbsp;",$.Link.html({text:v.t("å¦"),cls:"nui-txt-link nui-addr Ft0",click:function(){g(),$.Ud.setProxyBit({field:"webmail.js.helptips",flag:"read_blockinfo_sens_tips",value:"1"}),$.Msgbox.show({title:v.t("æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼"),content:v.t("ä¸ºäº†æ‚¨çš„é‚®ä»¶å®‰å…¨ï¼Œå¦‚æœé‡åˆ°åƒåœ¾é‚®ä»¶ï¼Œè¯·å‘æˆ‘ä»¬åé¦ˆï¼Œæ‚¨çš„æ„è§å°†å¸®åŠ©æˆ‘ä»¬æå‡åƒåœ¾é‚®ä»¶æ‹¦æˆªæ•ˆæœï¼Œæ„Ÿè°¢æ”¯æŒã€‚"),okText:v.t("æˆ‘çŸ¥é“äº†"),ok:function(){b("read_blockinfo_sens_no_iknow_click")},close:function(){b("read_blockinfo_sens_no_close_click")}}),b("read_blockinfo_sens_no_click"),b("read_blockinfo_sens_no_show")}}),"</span>","</div>"].join(""),closeclick:function(){this.el.hide(),b("read_blockinfo_sens_close_click")},onRender:function(){$.Ud.getProxyBit({field:"webmail.js.helptips",flag:"read_blockinfo_sens_tips",call:function(e){"1"===e?($(".dvReadBlockinfoSensButs1").show(),b("read_blockinfo_sens_btn_show")):($(".dvReadBlockinfoSensButs2").show(),b("read_blockinfo_sens_ask_show"))}})}};var g=function(){$(".dvReadBlockinfoSensButs1").show(),$(".dvReadBlockinfoSensButs2").hide(),b("read_blockinfo_sens_btn_show")};break;case"attachWrong":a={params:"hasClose",icon:"alert",content:['<div class="qu0">','<p class="nui-txt-impt">'+v.t("è¯¥é‚®ä»¶çš„é™„ä»¶æ ¼å¼ä¸æ­£ç¡®")+"</p>","</div>"].join("")};break;case"transCheck":a={icon:"translate",params:"hasClose",content:['<div class="qu0">','<p class="nui-txt-impt">',$.Link.html({text:v.t("ç¿»è¯‘æˆä¸­æ–‡"),cls:"nui-txt-link",click:function(){o.translate({type:1})}}),"</p>","</div>"].join("")};break;case"transLoading":a={icon:"loading",content:v.t("æ­£åœ¨ç¿»è¯‘ï¼Œè¯·ç¨å€™...")};break;case"transMenu":a={icon:"translate",content:['<div class="qu0">',"<p>",$.Link.html({id:o.createId("tansOriginalLink"),cls:u,text:v.t("åªæ˜¾ç¤ºåŸæ–‡"),click:function(){o.translator.switchContent(0)}}),'<span class="oH0 nui-txt-aside">|</span>',$.Link.html({id:o.createId("tansTranslationLink"),cls:u,text:v.t("åªæ˜¾ç¤ºè¯‘æ–‡"),click:function(){o.translator.switchContent(1)}}),'<span class="oH0 nui-txt-aside">|</span>',$.Link.html({id:o.createId("tansComparisonLink"),cls:u,text:v.t("å¯¹ç…§æ˜¾ç¤º"),disabled:!0,click:function(){o.translator.switchContent(2)}}),$.Ext.human_trans?['<span class="oH0 nui-txt-aside">|</span>',"<span>"+v.t("æ‚¨è¿˜å¯ä»¥é€‰æ‹©")+$.Link.html({text:v.t("ç½‘æ˜“ä¸“ä¸šç¿»è¯‘"),cls:u,click:function(){i.e(603).then(i.bind(i,59340)).then($.Function.bind((function(e){e.default.goHuman({mid:o.mid,vendor:"read"})}))),o.log({action:"click",item:"trans_pro",value:"3"})}})+v.t("ï¼ŒæŸ¥çœ‹æ›´ç²¾å‡†çš„è¯‘æ–‡")+"</span>"].join(""):"","</p>","</div>"].join(""),ext:(0,c.$S)("isFree")?$.Link.html({text:v.t("æœ€å¿«çš„äººå·¥ç¿»è¯‘ï¼Œæœ‰é“ä¸“ä¸šç¿»è¯‘"),target:"_blank",noParam:!0,link:"trans_ad2"}):$.Link.html({text:v.t("æœ‰é“ç¿»è¯‘"),target:"_blank",noParam:!0,link:"read_trans_provide","left-bracket":v.t("æœ¬æœåŠ¡ç”±  "),"right-bracket":v.t(" æä¾›")})};break;case"transRetry":a={icon:"translate",content:['<div class="qu0">',"<p>",v.t("åœ¨çº¿ç¿»è¯‘æœåŠ¡å¼‚å¸¸ï¼Œè¯·ç¨å€™&nbsp;"),$.Link.html({text:v.t("é‡è¯•"),click:function(){o.translate({type:2}),(0,c.$C)(r).destroy()}}),"</p>","</div>"].join("")};break;case"smartAd":a={extcls:s+" Ab0",subclass:d,content:t.content,closeclick:function(){this.destroy(),n._bAdPrivileges&&Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showProduct("noAd","noAd_dxyht")})))}};break;case"yAd":a={extcls:s+" Ab0",subclass:d,content:t.content,closeclick:function(){this.destroy(),n._bAdPrivileges&&Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showProduct("noAd","noAd_dxyht")})))}}}return a.extcls=a.extcls||s,a.subclass=d,a.id=r,a;function b(e,i){var a={};a[e]={value:o.mid,sentDate:+o.folderData.sentDate,receivedDate:+o.folderData.receivedDate},t&&t.tag&&(a[e].tag=t.tag),t&&t.id&&(a[e].id=t.id),t&&t.typeId&&(a[e].typeId=t.typeId),i&&i.typeId&&(a[e].typeId=i.typeId),a[e]=$.Support.getStatsMailinfo(a[e]),$.Log.cache(a)}},getMailStatusConf:function(e,t){var i,a,n,r,s=this.reader,c=s.folderData,l="",d=v.t("æ’¤å›æˆåŠŸ");switch(e){case"mail":var u={};for(var m in i=[],$.Array.each(t,(function(e,t){u[t.msgid]?u[t.msgid].push(t):u[t.msgid]=[t]})),u){var p=u[m],f=[];$.Array.each(p,(function(e,t){f.push(new $.Email(t.to,t.to_name))})),i.push({msgType:p[0].msgType,rectime:p[0].rectime||p[0].modtime,email:f})}t=i,a=[{text:v.t("å¤„ç†æ–¹å¼")},{text:v.t("æ—¶é—´")},{text:v.t("è”ç³»äºº")}],r=v.t("æ²¡æœ‰æŸ¥åˆ°è¯¦æƒ…ï¼Œç³»ç»Ÿä»…ä¿ç•™7å¤©å†…çš„å›å¤ã€è½¬å‘ä¿¡æ¯ã€‚");break;case"send":a=[{text:v.t("æ”¶ä»¶äºº")},{text:v.t("å‘é€çŠ¶æ€")},{text:v.t("æ—¶é—´")}],r=$.Misc.getTime(0)-s.data.sentDate>6048e5?v.t("é‚®ä»¶å‘é€å·²ç»è¶…è¿‡7å¤©ï¼ŒæŸ¥è¯¢ä¸åˆ°è¯¦æƒ…"):v.t("æ²¡æœ‰æŸ¥åˆ°è¯¦æƒ…ï¼Œè¯·ç¨åå†è¯•");break;case"recall":a=[{text:v.t("æ”¶ä»¶äºº")},{text:v.t("æ’¤å›çŠ¶æ€")},{text:v.t("æ—¶é—´")}],r=v.t("æ²¡æœ‰æŸ¥åˆ°è¯¦æƒ…ï¼Œè¯·ç¨åå†è¯•")}$.Array.each(t,(function(t,i){var a="",n="",o=0;if("mail"===e)switch(i.msgType){case 0:a=v.t("æœªçŸ¥");break;case 1:a=v.t("æ–°é‚®ä»¶");break;case 2:case 3:case 4:a=v.t("å·²å›å¤"),n="re";break;case 5:a=v.t("å·²è‡ªåŠ¨å›å¤"),n="re";break;case 6:case 7:case 8:a=v.t("å·²è½¬å‘"),n="fw";break;case 9:a=v.t("å·²è‡ªåŠ¨è½¬å‘"),n="fw"}else{var r=i.result,s=Math.round(r/100),u=r%100;if(1===s)switch(u){case 0:case 6:case 7:case 8:case 10:a=v.t("æˆåŠŸåˆ°è¾¾å¯¹æ–¹é‚®ç=v.t("æ­£åœ¨æŠ•é€’ä¸­"),o=0;break;case 2:case 5:a=v.t("æœªåˆ°è¾¾å¯¹æ–¹é‚®ç®±"),o=2,k(l);break;case 3:case 4:a=v.t("è¢«å¯¹æ–¹é€€å›"),o=2,k(l);break;case 15:a=v.t("è¢«ç³»ç»Ÿæ‹¦æˆª"),o=3,k(l);break;default:a=v.t("æœªçŸ¥æ“ä½œ"),o=3,k(l)}else if(2===s)switch(u){case 0:case 6:case 7:case 8:a=v.t("æˆåŠŸåˆ°è¾¾å¯¹æ–¹æœåŠ¡å™¨"),o=1,k(v.t("å‘é€æˆåŠŸ"));break;case 1:a=v.t("å¯¹æ–¹æœåŠ¡å™¨æœªå“åº”,é‡æ–°æŠ•é€’ä¸­");for(var m=["@163.com","@126.com","@188.com","@vip.188.com","@yeah.net","@vip.163.com","@vip.126.com"],p=0,f=m.length;p<f;p+=1)if(-1!==i.to.indexOf(m[p])){a=v.t("æ­£åœ¨æŠ•é€’ä¸­");break}o=0,k(l);break;case 2:case 5:a=v.t("æœªåˆ°è¾¾å¯¹æ–¹æœåŠ¡å™¨"),o=2,k(l);break;case 3:a=v.t("è¢«å¯¹æ–¹æœåŠ¡å™¨é€€å›"),o=2,k(l);break;case 4:a=v.t("å‘é€å¤±è´¥ï¼Œå·²é€€ä¿¡"),o=2,k(l);break;default:a=v.t("æœªçŸ¥æ“ä½œ"),o=3,k(l)}else if(3===s||4===s){switch(u){case 0:case 1:case 6:case 7:case 8:a=v.t("æ­£åœ¨å¤„ç†ä¸­"),o=0;break;case 2:case 5:case 3:case 4:a=v.t("å‘é€ä¸æˆåŠŸï¼Œè¯¦ç»†åŸå› è¯·æŸ¥çœ‹é€€ä¿¡"),o=2;break;default:a=v.t("æœªçŸ¥æ“ä½œ"),o=3}k(l)}else if(5===s||7===s)switch(u){case 0:a=v.t("æ’¤å›æˆåŠŸ"),o=5,k(d);break;case 9:ä½œ"),o=3,k(l)}else if(6===s)switch(u){case 0:a=v.t("å®¡æ ¸é€šè¿‡"),o=1;break;case 1:a=v.t("å¾…å®¡æ ¸"),o=0;break;case 2:a=v.t("æœªé€šè¿‡å®¡æ ¸"),o=2,k(l);break;case 3:a=v.t("è¶…è¿‡å®¡æ ¸æ—¶é—´ï¼Œå®¡æ ¸è‡ªåŠ¨é€šè¿‡"),o=1;break;default:a=v.t("æœªçŸ¥æ“ä½œ"),o=3,k(l)}else if(8===s)switch(u){case 0:a=v.t("æ’¤å›æˆåŠŸ"),o=5,k(d);break;case 9:a=v.t("æˆåŠŸåˆ°è¾¾å¯¹æ–¹æœåŠ¡å™¨"),o=1;break;default:a=v.t("æœªçŸ¥æ“ä½œ"),o=3,k(l)}else a=v.t("æœªçŸ¥æ“ä½œ"),o=3,k(l);if("recall"===e&&c.rclStatus&&1===o){var h=i.rclResult;0===h?(a=v.t("æ­£åœ¨æ’¤å›é‚®ä»¶ï¼Œè¯·ç¨å€™ã€‚"),o=h):(a=v.t("æ’¤å›å¤±è´¥ï¼ŒåŸå› ï¼š")+({4:v.t("ä¿¡ä»¶ä¸å­˜åœ¨ï¼Œå¯èƒ½å·²ç»è¢«ç”¨æˆ·åˆ é™¤"),5:v.t("ä¿¡ä»¶å­˜åœ¨ä½†å·²ç»è¢«è¯»å–è¿‡"),6:v.t("ä¿¡ä»¶å­˜åœ¨ä½†å·²ç»è¢«å®¢æˆ·ç«¯æ”¶å–"),7:v.t("ä¿¡ä»¶å­˜åœ¨ä½†å·²ç»è¢«æ¨é€å‡ºå»"),8:v.t("ä¿¡ä»¶å·²è¿‡æœŸ"),9:v.t("ä¸æ”¯æŒæ’¤å›å‘å¾€å¤–åŸŸè´¦å·çš„é‚®ä»¶")}[i.rclResult]||v.t("å…¶ä»–åŸå› ")),o=6,k(""))}n=["doing","suc","err","other","doing","suc","err"][o],i.email=new $.Email(i.to,i.to_name)}i.icon=n,i.msg=a,i.span:3,text:r}]],k(l);else{n=[];for(var g,b,y,x=0;x<h;x+=1)g=t[x],b=$.Date.format(g.rectime||g.modtime,v.t("yyyyå¹´Mæœˆdæ—¥   HH:mm(æ˜ŸæœŸw)")),"mail"===e?(y=[{text:'<span class="nui-txt-normal">'+g.msg+"</span>"},{text:'<span class="nui-txt-normal">'+b+"</span>"},{text:""}],$.Array.each(g.email,(function(e,t){var i=t.name;i||(i=o.getName(t)),y[2].text+=(i?'<span title="'+t.address+'" class="nui-txt-normal">'+i+"</span>":'<span class="nui-txt-normal">'+t.address)+(e<g.email.length-1?v.t("ã€"):"")+"</span>"}))):y=[{text:'<span class="nui-txt-normal">'+$.String.encodeHTML(g.email.toString())+"</span>"},{text:'<span class="nui-txt-'+g.icon+'">'+g.msg+"</span>"},{text:'<span class="nui-txt-normal">'+b+"</span>"}],n.push(y)}return{id:s.createId(e+"Table"),subclass:"simpleTable",headCells:a,bodyCells:n};function k(e){void 0===e||0===e.length?s.sendStatus=e:s.sendStatus||(s.sendStatus=e)}},getSimpleToolbarConf:function(){var e=this.reader;oFolderData=e.folderData||{};var t=oFolderData.tag||[],a=oFolderData.ctrls||{},n={groups:[{items:[{xtype:"button",text:v.t("å›å¤å…¨éƒ¨"),click:function(){e.log({action:"click",item:"letter_toolbar_replyAll"}),e.assistant.fullReply()}},{xtype:"button",subclass:"dropdownBtn",text:v.t("æ›´å¤š"),menu:{reverse:!0,groups:[{items:[{text:v.t("åˆ é™¤"),click:function(){e.log({action:"click",item:"letter_menu_del"}),e.module.moveTo({del:!0,threadItem:!0,folderData:e.folderData})}},{text:v.t("å›å¤"),click:function(){e.log({action:"click",item:"letter_menu_reply"}),e.assistant.reply()}}].concat(e.module.view.getReplyConf(e).groups.pop().items,e.module.view.getForwardConf(e).groups.pop().items)},{items:[{text:v.t("æŸ¥çœ‹ä¿¡å¤´"),click:function(){e.log({action:"click",item:"menu_viewhead"}),e.assistant.bodyFilter("header")}},{text:v.t("æŸ¥çœ‹é‚®ä»¶"),click:function(){e.log({action:"click",item:"menu_viewmail"}),e.assistant.bodyFilter("mail")}},{text:v.t("åŒä¸»é¢˜æŸ¥çœ‹"),click:function(){e.log({action:"click",item:"menu_samesubject"}),e.assistant.searchSameSubject()}},{text:v.t("å¯¼å‡ºé‚®ä»¶"),click:function(){e.log({action:"click",item:"menu_download"}),e.assistant.exportLetter()}},{text:v.t("é€‰æ‹©ç¼–ç "),menu:e.module.view.getCharsetConf(e)},{text:v.t("é€‰æ‹©å­—ä½“"),menu:e.module.view.getFontConf()},{text:v.t("ç¿»è¯‘é‚®ä»¶"),hidden:!$G.environment.isCh,click:function(){e.log({action:"click",item:"menu_trans"}),e.translate({type:0})}}]},{items:[{text:v.t("æ–°çª—å£æ‰“å¼€"),hidden:!$G.environment.isCh,click:function(){e.log({action:"click",item:"menu_newwin"}),e.assistant.blankView()}},{text:v.t("ä¿å­˜è”ç³»äºº..."),click:function(){e.log({action:"click",item:"menu_savecontact"}),e.assistant.saveContacts()}},{text:v.t("é‚®ä»¶å¤‡æ³¨"),click:function(){e.log({action:"click",item:"menu_memo"}),e.assistant.editMemo()}}]}]},click:function(){e.log({action:"click",item:"letter_menu_more"})}}]}]};return 3===e.fid&&n.groups[0].items[1].menu.groups[0].items.unshift({text:v.t("å†æ¬¡ç¼–è¾‘å‘é€"),click:function(){e.log({action:"click",item:"toolbar_sendagagin"}),Promise.resolve().then(i.bind(i,54107)).then($.Function.bind((function(t){t.default.edit({id:e.mid,body:{decryptPassword:"decryption"in e?e.decryption.pwd:void 0}})})))}}),$.Ext.scheduleRead&&$G.environment.isCh&&n.groups[0].items[1].menu.groups[1].items.splice(4,0,{text:v.t("è®¾ç½®æ—¥ç¨‹")+((0,c.$S)("isFree")?v.t("ç®¡ç†"):v.t("æé†’")),click:function(){e.log({action:"click",item:"menu_schedule"}),Promise.resolve().then(i.bind(i,26406)).then($.Function.bind((function(t){var i=t.default,a=e.mid,n=(0,c.$S)("schedule");void 0!==n&&n[a]?i.edit(a):i.add(a,e.folderData.subject)})))}}),$.Ext.netfolder_enable&&n.groups[0].items[1].menu.groups[1].items.splice(3,0,{text:v.t("ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒ..."),click:function(){e.log({action:"click",item:"menu_savetonf"}),e.assistant.saveToNf()}}),!$.Ext.letterRecall&&!$.Ext.letterRecall_vip||3!==e.fid||e.isThread||$.Array.has(t,"%ex_trace_sp%")||a.encrypt||n.groups[0].items[1].menu.groups.splice(1,0,{items:[{text:v.t("æ’¤å›é‚®ä»¶"),click:function(){e.log({action:"click",item:"menu_recall"}),e.assistant.recall()}}]}),n},getDateStr:function(e,t,i){var a=this.reader;return e=e||a.folderData.sentDate||a.data.sentDate,i?e:void 0===e?v.t("(æœªçŸ¥æ—¶é—´)"):$.Date.format(e,t||v.t("yyyyå¹´MMæœˆddæ—¥ HH:mm (æ˜ŸæœŸw)"))},getCompactDateStr:function(){var e,t=this.reader,i=t.folderData.sentDate||t.data.sentDate,a=$.Misc.getTime();if(i.getFullYear()===a.getFullYear()){var n=i.getMonth()===a.getMonth(),o=i.getDate(),r=a.getDate();e=n&&o===r?$.Date.format(i,"HH:mm"):n&&o===r-1?v.t("æ˜¨å¤©")+$.Date.format(i," HH:mm"):$.Date.format(i,v.t("MMæœˆddæ—¥ HH:mm"))}else e=$.Date.format(i,"yyyy-MM-dd HH:mm");return e},getUnSavedInfo:function(e){var t,a=this.reader,o="",r=a.folderData,s=e?"compact":"full";return o=$.Icon.html({type:"alert"})+$.Label.html({text:v.t("é‚®ä»¶å¤§å°è¶…è¿‡1Mï¼Œæ™®é€šé™„ä»¶æœªè¢«ä¿å­˜ï¼Œå·²æˆåŠŸå‘å‡ºçš„é‚®ä»¶ä¸å—å½±å“"),type:"info"})+"&nbsp;",(t=l())&&(o+="("+$.Link.html({id:a.createId("attachSaveLink"+s),text:v.t("é©¬ä¸Šä¿å­˜"),cls:"nui-txt-link",click:function(){if(l()){var e={fullSaveId:r.fullSaveId,mid:r.id,call:function(t){if(t.code!==$.S_PARTIAL_OK||t.var[0].code!==$.S_OK||0!==t.var[1].code.indexOf("FA_HOOK_SECURITY"))switch(t.code){case"S_OK":var i=function(){$.Listener.fire("read:wmsvrDelete",r),n.entry({fid:r.fid}),a.module.moduleRemove()};$.Msgbox.show({header:v.t("ç³»ç»Ÿæç¤º"),title:v.t("é™„ä»¶ä¿å­˜æˆåŠŸ"),icon:"suc",ok:i,close:i});break;case"FA_MAIL_NOT_FOUND":case"FS_MS0259":d();break;default:$.Msgbox.html({content:v.t("é™„ä»¶ä¿å­˜å¤±è´¥ï¼Œé”™è¯¯ç ï¼š")+t.code,icon:"err"})}else{var o=t.var[1].code.replace("FA_HOOK_SECURITY_","");$.Support.securityCtrl({func:"mbox:deleteMessages",level:o},(function(){a.module.action.saveAttachMissed(e)}))}}};a.module.action.saveAttachMissed(e)}else d()}}),o+='<span id="'+a.createId("attachSaveLinkSplit"+s)+'">&nbsp;|&nbsp;</span>'),o+(t?"":"(")+$.Link.html({text:v.t("è®¾ç½®è‡ªåŠ¨ä¿å­˜"),cls:"nui-txt-link",click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"BaseSetModule",inputName:"afterSendRule"})})))}})+")";function l(){return $.Misc.getTime().getTime()-r.sentDate.getTime()<18e5}function d(){$.Msgbox.html({statsKey:"Read_Guide_Popup_MailSaveFail",content:v.t("æŠ±æ­‰ï¼Œè·é‚®ä»¶å‘å‡ºæ—¶é—´å¤§äº30åˆ†é’Ÿï¼Œé™„ä»¶æ— æ³•ä¿å­˜ã€‚"),icon:"err"});try{(0,c.$C)(a.createId("attachSaveLinkfull")).destroy(),$.fly(a.getDom("attachSaveLinkSplitfull")).remove()}catch(e){}try{(0,c.$C)(a.createId("attachSaveLinkcompact")).destroy(),$.fly(a.getDom("attachSaveLinkSplitcompact")).remove()}catch(e){}}},getReplyNotice:function(){for(var e=thisme(s))}return t.push(o.getName(a)),t.reverse(),v.t("å¿«æ·å›å¤ç»™ï¼š")+$.String.escapeHTML($.String.trim(t.join(v.t("ã€"))))},getRangeOptHtml:function(){var e="#dvRangOptions";return['<div id="dvRangOptions" class="nui-msgbox pa0" style="display:none;">','<div class="nui-msgbox-bd">','<div class="nui-msgbox-wide">','<ul class="jw0">','<li class="ju0">',$.Link.html({text:v.t("å›å¤é€‰ä¸­"),cls:"jv0",click:function(){var t,i,a=(0,c.$S)("fGetActiveReaderBody");void 0!==a&&(i=(t=a()).rangText,t.reader.assistant.reply({type:"fragment",content:i}),$.fly(e).hide())}}),"</li>",'<li class="gi0">|</li>','<li class="ju0">',$.Link.html({text:v.t("è½¬å‘é€‰ä¸­"),cls:"jv0",click:function(){var t,i,a=(0,c.$S)("fGetActiveReaderBody");void 0!==a&&(i=(t=a()).rangText,t.reader.assistant.forward({type:"fragment",content:i}),$.fly(e).hide())}}),"</li>",'<li class="gi0">|</li>','<li class="ju0">',$.Link.html({text:v.t("è®¾ç½®"),cls:"jv0",click:function(){Promise.resolve().then(i.bind(i,74718)).then($.Function.bind((function(e){e.default.entry({module:"BaseSetModule",inputName:"selectedcontent"})}))),$.fly(e).hide()}}),"</li>",'<li class="gi0">|</li>','<li class="ju0">',$.Link.html({text:v.t("å…³é—­"),cls:"jv0",click:function(){var t=(0,c.$S)("fGetActiveReaderBody");void 0!==t&&(t().reader.body.removeRangEvent(),$.fly(e).hide())}}),"</li>","</ul>","</div>","</div>","</div>"].join("")},getTranlateTipHtml:function(e,t){return e?['<div id="dvRangOptions" class="nui-msgbox tM0 qF0" style="display:none;z-index:999" onclick="$.Event.,"</div>"].join(""):['<div class="hk0">','<strong class="jK1">'+t.returnPhrase+"</strong>",'<span class="iE1">',t.phoneticSymbol?"["+t.phoneticSymbol+"]":"","</span>","</div>",'<div class="hO1n.content.join('</li><li class="lq0">'),"</li>",'<li class="lq0"></li>',"</ul>","</div>"].join("")},getVCardTipsHtml:function(e){var t=this.reader,i=$.Element.getIframeDoc(t.body.frame),a=e.name||"",n=e.email||"",r=(0,c.$S)("isFree"),s=t.createId("mailCardAddLink");return r?($.Ud.get({field:"ntes_compose",flag:"card"}),v.t("åˆ›å»ºæˆ‘çš„ç”µå­åç‰‡")):v.t("åˆ›å»ºæˆ‘çš„ä¸ªæ€§åç‰‡"),['<div style="font-size:12px;margin-bottom:10px;background-color: #FFFFE1;border-top:1px solid #C5D2DA;padding:3px 5px">',v.t("ç”µå­åç‰‡-æ­¤é‚®ä»¶åŒ…å«")+a+v.t("çš„ç”µå­åç‰‡ã€‚&nbsp;"),$.Link.html({id:s,doc:i,text:v.t("ä¿å­˜åç‰‡åˆ°é€šè®¯å½•"),listeners:{click:og({addr:{name:a,email:n,phone:e.phone},callback:function(){$.Tips.show({type:"suc",text:v.t("åç‰‡ä¿å­˜æˆåŠŸ")}),(0,c.$C)(s).destroy()}})}}}}),"</div>"].join("")},getImageOptHtml:functi.push('<a href="jitle="'+v.t("å°†å›¾ç‰‡ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¿ƒ")+'" onclick="NTES_Events.saveToNF(\''+e.part+'\');return false;" style="vertical-align:bottom;display:inline-block;+display:inline;+zoom:1;position:relative;+zoom:1;background-image:url(https://mimg.127.net/ggimg/all/img18/140308_nui_btn.png);background-position:0 ; ;border:1px solid #999;border-top-left-radius:3px;border-bottom-lefts:3px;border-bottom-right-radius:3px;")+'text-decoration:none;color:#555;height:26px;width:38px;line-height:0;font-size:0;"><img src="https://mimg.127.net/ggimg/all/img18/140312_wp_2x.png" style="position:absolute;left:10p,a&&(i.push('<a href="javascript:void(0)" hidefocus="hidefocus" title="'+v.t("1æ¯”1æŸ¥çœ‹åŸå›¾")+'" onclick="window.open(\''+e.src+"', 'pic_preview_"+e.index+'\');return false;" style="vertical-align:bottom;display:inline-block;+display:inline;+zoom:1;position:relative;+zoom:1;background-image:url(https://mimg.127.net/ggimg/all/img18/140308_nui_btn.png);background-position:0 ; ;border:1px solid #999;border-left:none;border-top-right-radius:3px;border-bottom-right-radius:3px;text-decoration:none;color:#555;height:26px;width:38px;line-height:0;font-size:0;"><img src="https://mimg.127.net/ggimg/all/img18/140312_origin.png" style="position:absolute;left:12px;top:8px;border:0;" width="13" height="10" /></a>'),t='<div style="display:inline-block;+display:inline;+zoom:1;font-size: 12px; font-weight: normal; border: 1px solid #ddd; background-color: #F4F4F4; line-height: 14px; padding: 5px;color:#999">'+v.t("(&nbsp;åŸå°ºå¯¸ä¸º")+e.width+"Ã—"+e.height+"&nbsp;)</div>"),['<div style="display:inline-block;+display:inline;+zoom:1;font-size: 12px; font-weight: normal;line-height: normal;margin-right:6px;">',i.join(""),"</div>",t].join("")},getImageShareMenu:function(e){var t=this.reader;return void 0===e?['<a href="javascript:void(0);" style="font-size:12px;display:block;height:25px;line-height:25px;padding-left:31px;position:relative;+zoom;1;color:#666;text-decoration:none" onmousemove="this.style.backgroundColor=\'#ececec\';" onmouseout="this.style.backgroundColor=\'\';" onclick="NTES_Events.shareToYXFriend();this.parentNode.style.display=\'none\';return false;"><img src="https://mimg.127.net/ggimg/all/img18/140312_friend_2x.png" style="position:absolute;left:9px;top:5px;border:0;" width="14" height="14" />'+v.t("åˆ†äº«ç»™æ˜“ä¿¡å¥½å‹")+"</a>",'<a href="javascript:void(0);" style="font-size:12px;display:block;height:25px;line-height:25px;padding-left:31px;position:relative;+zoom;1;color:#666;text-decoration:none;" onmousemove="this.style.backgroundColor=\'#ececec\';" onmouseout="this.style.backgroundColor=\'\';" onclick="NTES_Events.shareToYXGroups();this.parentNode.style.display=\'none\';return false;"><img src="https://mimg.127.net/ggimg/all/img18/140312_quan_2x.png" style="position:absolute;left:9px;top:5px;border:0;" width="14" height="14" />'+v.t("åˆ†äº«åˆ°æ˜“ä¿¡æœ‹å‹åœˆ")+"</a>"].join(""):{groups:[{items:[{text:v.t("åˆ†äº«ç»™æ˜“ä¿¡å¥½å‹"),click:function(){t.log({action:"click",item:"attach_share_group"}),t.assistant.imageShareToYiXin(e+"",void 0,!0)}},{text:v.t("åˆ†äº«åˆ°æ˜“ä¿¡æœ‹å‹åœˆ"),click:function(){t.log({action:"click",item:"attach_share_friend"}),t.assistant.imageShareToYiXin(e+"")}}]}],width:155}},getNfListHtml:function(){var e=$.Uri.getUrl("savetonf_new");return(0,c.$S)("lastNetfolderFid")&&(e+="&fid="+(0,c.$S)("lastNetfolderFid")),['<div style="padding:10px">','<div style="zoom:1;padding:10px;height:230px;border-width:1px;border-style:solid" class="bdr-light">','<iframe id="ifrSaveToNf" src="'+e+'" height="228px" width="380px" frameborder="0"></iframe>',"</div>","</div>"].join("")},getTranslationHtml:function(e){return["<html>","<head>",'<base target="_blank" />','<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"<title>"+v.t("ç½‘æ˜“é‚®ç®±")+"</title>",'<style type="text/css">',"html{word-wrap:break-word;}","body{font-size:14px;font-family:arial,verdana,sans-serif;line-height:1.666;padding:10px 8px;margin:0;overflow:auto}","pre {white-space: pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space: -o-pre-wrap;word-wrap: break-word;}","</style>","</head>","<body>","<div>",e||"","</div>","</body>","</html>"].join("")},getOptimizedContentHtml:function(){var e=this.reader;return['<div id="read_mask" class="nui-mask"></div>','<div id="dvOptimizedContent" class="mz1 nui-scroll">','<div class="xV0">','<div class="jh1">',$.Link.html({text:v.t("å¢å¤§"),cls:"dV1",click:function(){var t=$.fly("#ifrmOptimizedContent").dom;h.Z.setFontSize($.Element.getIframeDoc(t).body,!0,!0,!0),e.body.autoSize({frame:t,heightOnly:!0}),t=void 0}}),'<b class="ek2"></b>',$.Link.html({text:v.t("ç¼©å°"),cls:"dy1",click:function(){var t=$.fly("#ifrmOptimizedContent").dom;h.Z.setFontSize($.Element.getIframeDoc(t).body,!1,!0,!0),e.body.autoSize({frame:t,heightOnly:!0}),t=void 0}}),"</div>",'<div class="nT1">','<h1 class="hk2">',$.String.escapeHTML(e.data.subject),"</h1>",'<p class="fH1">',"<span>"+v.t("å‘ä»¶äººï¼š"),$.String.escapeHTML(o.getName(e.module.view.getContactConf(e.from[0]).email)),"</span>","&nbsp;&nbsp;&nbsp;&nbsp;","<span>"+v.t("æ—¶é—´ï¼š"),this.getDateStr(),"</span>","</p>","</div>",'<div class="mE1">','<iframe id="ifrmOptimizedContent" src="about:_blank" class="fI3" frameborder="0" style="height:auto;display:none;"></iframe>',"</div>","</div>","</div>"].join("")},getAD:function(e){var t=this.reader;if("ud"!==(0,c.$S)("ad").userType&&e)try{window.gAd.getByCallback("read",{onClose:function(){t.getDom("dvReadAd").style.display="none"}},(function(e){var i=e.read;i&&i.length>0&&(t.getDom("dvReadAd").innerHTML=['<div class="rd0"  tabindex="0" title="'+v.t("å¹¿å‘ŠåŒº")+'" aria-label="'+v.t("å¹¿å‘ŠåŒº")+'" role="listitem">',i,"</div>"].join(""))}))}catch(e){c.$D.log(v.t("å¹¿å‘Šå‡ºé”™ï¼"))}},getYAD:function(){var e=this.reader;if((!1!==(0,c.$S)("ad").show||"ud"!==(0,c.$S)("ad").userType)&&(0,c.$S)("isFree")&&!e.errorMailWarn)try{return void window.gAd.getByCallback("readTop",{onClose:function(){e.getDom("dvReadYad").style.display="none"}},(function(t){var i=t.readTop;i&&i.length>0&&(e.getDom("dvReadYad").innerHTML=['<div class="rd0" style="box-sizing:border-box;border-top:1px solid #E0E0E0;border-bottom:1px solid #E0E0E0;line-height: 32px;" tabindex="0" title="'+v.t("å¹¿å‘ŠåŒº")+'" aria-label="'+v.t("å¹¿å‘ŠåŒº")+'" role="listitem">',i,"</div>"].join(""))}))}catch(e){c.$D.log(v.t("å¹¿å‘Šå‡ºé”™ï¼"))}e.getDom("dvReadYad").style.display="none"},getBottomAD:function(){var e,t=(0,c.$S)("ad"),a=(0,c.$S)("isFree")&&!(0,c.$S)("closeAd")&&!(!t.show&&"ud"===t.userType);try{e=window.gAd.getReadBanner()}catch(e){}return a&&e?['<div style="margin:0 10px 60px 10px;position:relative;+zoom:1">',e,$.Link.html({text:v.t("å…³é—­"),cls:"rt2",click:function(){Promise.resolve().then(i.bind(i,62385)).then($.Function.bind((function(e){e.default.showProduct("noAd","noAd_dxyht")})))}}),"</div>"].join(""):""},getTempLinkHtml:function(e){return'<a href="" target="_blank" id="'+e.createId("aTempLink")+'" rel="noreferrer"></a>'},_bAdPrivileges:!0}),t.Z=a},84077:function(e,t,i){var a,n=i(72957),o=i(14396),r=i(62193),s=new n.c1("module.read.ReadAction");a=$.createClass((0,n.$N)("module.read.ReadAction")),$.Object.mix(a,o.Z,null,{initialize:function(e){this.module=e},readMessage:function(e){var t=e.param,i={id:t.mid,header:!0,returnImageInfo:!0,returnAntispamInfo:!0,autoName:!0,returnHeaders:{"Resent-From":"A",Sender:"A","List-Unsubscribe":"A","Reply-To":"A"},supportTNEF:!0};i.returnHeaders.From="",t.part&&(i.part=t.part),t.markRead&&(i.markRead=!0),"archive"===t.area&&(i.mboxa="2"),this.wmsvr({func:"mbox:readMessage",body:i,call:function(t){e.call(t)},log:{l:"read",action:"read"},cacheFlag:e.cacheFlag,hideWait:e.isHidden})},decrypt:function(e){var t=e.param;this.wmsvr({func:"mbox:decryptMessage",body:{id:t.mid,password:t.pwd,mode:"both",filterImages:!1,wmsvrlog:{action:"decryptMessage"}},ignoreError:!0,call:e.call,log:{l:"read",action:"decrypt"}})},sendReceipt:function(e){this.wmsvr({func:"mbox:sendMDN",body:{id:e,dispositionInfo:{mode:"manual",type:"displayed"}},call:function(e){if(e.code!==$.S_OK)return!0;$.Tips.show({text:s.t("å›æ‰§å‘é€æˆåŠŸ"),type:"suc"})}})},listDeliveryHistory:function(e){var t;switch(e.type){case"send":case"recall":t={mid:e.mid};break;case"mail":t={pid:e.mid}}this.wmsvr({func:"user:listDeliveryHistory",body:t,call:function(t){e.callback(e.type,t)}})},recallMessage:function(e){this.wmsvr({func:"mbox:recallMessage",body:{mid:e.mid},call:e.callback,log:{l:"read",action:"recallMessage"},ignoreError:!0})},saveToYNote:function(e){this.wmsvr({func:"ntes:mbox:ynote",body:{action:"saveEmail",mid:e.mid,password:e.pwd},call:e.call,error:e.error,ignoreError:!0})},saveAttachMissed:function(e){this.wmsvr({func:"global:sequential",body:{items:[{func:"mbox:saveSent",var:{id:e.fullSaveId}},{func:"mbox:deleteMessages",var:{id:e.mid}}]},ignoreError:!0,call:e.call})},getSmartTag:function(e){var t=r.Z.getMailSess(),i=$.Cookie.get("Coremail",!0),a={mail_id:e.mid,option:e.option||"all",NTES_SESS:t,Coremail:i,sender:e.sender,subject:e.subject,mobile:null===$.SenderList.getMobile()?0:1};e.tag&&(a.tag=e.tag),$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,rnd:!0,url:$.Uri.getUrl("smart_mailtag2",!0),body:a,call:e.call})},safeBrowsing:function(e,t){var i=$.Uri.getUrl("safeBrowsing");i+="&url="+e,$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,sync:!0,rnd:!0,url:i,call:t})},getMailServiceData:function(e){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:$.Uri.getUrl("read_mail_service",!0)+"?uid="+e.uid+"&sender="+e.sender+"&hmid="+window.encodeURIComponent(e.hmid||"")+"&time="+e.time+"&appid=js6",call:e.call})}}),t.Z=a},8585:function(e,t,i){i(37885),i(8600),i(37092),i(92274),i(75654),i(66403);var a,n=i(72957),o=i(1124),r=new n.c1("module.read.ReadHandler");function s(e){var t=this.reader,i=e.action;if(t.assistant.editMemo(!0),"defer"===i&&((0,n.$C)(t.createId("deferHeadBt")).update(t.view.getSubjectHrefHtml("defer",!0)),!t.isThread)){var a=t.folderData,o=(a.flags||{}).deferHandle&&a.defer,s=(0,n.$C)(t.createId("toolbarSetDefer"));s&&s.update({text:o?r.t("è®¾ä¸ºå®Œæˆ"):r.t("è®¾ç½®å¾…åŠ")});var c=t.getDom("mailService");if(c){var l=$.fly(c).find(".APP-service-hr .desc");l&&(l.doms[0].style.display=o?"none":"",l.doms[1].style.display=o?"":"none")}}}a=$.createClass((0,n.$N)("module.read.ReadHandler")),$.Object.extend(a,{getHandler:function(e){var t=this;return function(){t[e].apply(this.module,arguments)}},resize:function(){},network:function(e){var t=this.reader.body.frame;e&&!t.contentWindow.document&&(t.src=t.src)},folder:function(){var e=this;if(!e.part)try{var t=e.view.getFolderConf();t.hidden=!0,(0,n.$C)(e.createId("folderMenu")).update(t)}catch(e){n.$D.log(r.t("è¯»ä¿¡æ–‡ä»¶å¤¹äº‹ä»¶ç›‘å¬å¥æŸ„å‡ºé”™ã€‚"))}},tagModify:function(){var e=this;e.part||"archive"===e.area||a.updateTagMenu.apply(e)},tagRemove:function(e){var t=this;if(!t.part&&"archive"!==t.area){var i=t.folderData.tag||[];if(e)for(var n=0,o=i.length;n<o;n+=1)if(i[n]===e){i.splice(n,1);break}a.updateTagMenu.apply(t)}},letterUpdate:function(e){var t,i=this;if(!i.part){if(e.list[i.tid||i.mid])o.default.syncData(e,i.folderData);else if("move"!==e.action)return;switch(e.action){case"flag":t=a.getHandler("setFlag");break;case"tag":"archive"!==i.area&&(t=a.getHandler("setTag"));break;case"top":t=a.getHandler("setTop");break;case"memo":case"defer":t=a.getHandler("setMemo");break;case"move":t=a.getHandler("folderMove");break;case"tracking":t=a.getHandler("setMailTracking");break;case"mailteam":t=a.getHandler("setMailTeam")}void 0!==t&&t.apply({module:i},arguments)}},setFlag:function(){var e=this.reader,t=(e.folderData.label0||"")+"";e.isThread||(e.getDom("h1Subject").className="nui-fIBlock py0 nui-txt-flag"+t,(0,n.$C)(e.createId("flagHeadBt")).update(e.view.getSubjectHrefHtml("flag",!0)))},setTag:function(){a.updateTagMenu.apply(this)},setTop:function(){var e=(0,n.$C)(this.createId("toolbarSetTop"));void 0!==e&&e.update({text:this.folderData.flags.top?r.t("å–æ¶ˆç½®é¡¶"):r.t("ç½®é¡¶é‚®ä»¶")})},setMemo:s,folderMove:function(e){var t=this,i=e.list,n=t.previousMail,o=t.nextMail;n&&i[n.folderData.id]||o&&i[o.folderData.id]?t.fixSibling():i[t.tid||t.mid]&&a.exitModule.apply(t)},setMailTracking:function(e){this.reader.view.setSubjectMailTrackingHtml(e.data[0].readStatus)},setMailTeam:function(e){for(var t,i=this.reader,a=0;a<e.data.length;a++){var n=e.data[a];if((n.mid||n.id)===i.mid){t=n.tag,i.showMailTeam(t),i.showMailTeamTask(t);break}}},setSpam:function(e,t,i,n,o){var r=this;!r.part&&o[r.tid||r.mid]&&a.exitModule.apply(r)},setAllRead:function(e){var t=this;t.isHiddenMod&&t.fid===e&&o.default.syncData({action:"read",value:1},t.folderData)},options:function(e){var t=this,i=t.reader,a=t.isThread;!e instanceof window.Array&&(e=[e]);for(var o,r,s,c=0,l=e.length;c<l;c+=1)if(r=(o=e[c]).flag||o.field,s=o.value,"read_head"!==r||a)iftions").empty().remove()}catch(e){}else if("recall"!==r||a){if("mail_service"===r&&!a){var d=i.getDom("mailService");d&&i.mailServiceLoaded&&$.fly(d)["1"===s.toString()?"hide":"show"]()}}else 3===i.fid&&(0,n.$C)(i.createId("recallBt"))[s?"show":"hide"]();else{if(i.isThread)return;i.showHeader("1"===s.toString())}try{$.JS.displayModule===t||a||(0,n.$C)(t.createId("optionMenu")).update(t.view.getOptionConf().items[0])}catch(e){}},rollback:function(e){for(var t=this.module,i=t.tid||t.mid,a=e.data.items,n=0,o=a.length;n<o;n+=1){var r=a[n].ids;if($.Array.has(r,i)){t.moduleRemove();break}}},skin:function(){var e=this.reader;try{var t=e.body.frame.contentDocument.getElementById("ntes_link_color");null!==t&&(t.innerText=t.innerHTML="a: {color:#"+$G.user.color+"}")}catch(e){}},schedule:s,updateTagMenu:function(){var e=this,t=e.view.getTagConf(),i=(0,n.$C)(e.createId("toolBarTagMenu")),a=(0,n.$C)(e.createId("subjectTagMenu"));t.hidden=!0,i&&i.update(t),a&&a.update(t),e.updateTag(),$.Component.setEvents()},exitModule:function(){var e=this,t=e.nextMail,i=$.JS.reqModule===e.name;0!==(0,n.$S)("attrs").user.afterdel&&t&&i?e.enterSibling("next"):i&&e.back((function(){e.remove()}))}}),t.Z=a},907:function(e,t,i){var a,n=i(72957),o=i(99626),r=i(8585);a=$.createClass((0,n.$N)("module.read.ReadListener")),$.Object.inherit(a,o.Z,{_listeners:{"global:resize":{handler:r.Z.getHandler("resize")},"global:network":{handler:r.Z.getHandler("netWork")},"folder:add":{handler:r.Z.getHandler("folder")},"folder:modify":{handler:r.Z.getHandler("folder")},"folder:remove":{handler:r.Z.getHandler("folder")},"tag:add":{handler:r.Z.getHandler("tagModify")},"tag:modify":{handler:r.Z.getHandler("tagModify")},"tag:remove":{handler:r.Z.getHandler("tagRemove")},"letter:update":{handler:r.Z.getHandler("letterUpdate")},"letter:setspam":{handler:r.Z.getHandler("setSpam")},"letter:allread":{handler:r.Z.getHandler("setAllRead")},"letter:rollback":{handler:r.Z.getHandler("rollback")},"options:readModify":{handler:r.Z.getHandler("options")},"options:skinChange":{handler:r.Z.getHandler("skin")},"schedule:insert":{handler:r.Z.getHandler("schedule")}}}),t.Z=a},68981:function(e,t,i){i(92274),i(75654),i(42295),i(52963),i(48868),i(63045),i(81874),i(54861),i(8600),i(55737),i(79150);var a,n=i(72957),o=i(23965),r=i(84077),s=i(907),c=i(88645),l=i(19247),d=i(84291),u=i(88829),m=i(1124),p=new n.c1("module.read.ReadModule");a=$.createClass((0,n.$N)("module.read.ReadModule")),$.Object.mix(a,o.Z,{interface:u.default,Action:r.Z,View:d.Z,Listener:s.Z,cls:"tR0",ariaLabel:p.t("è¯»ä¿¡")},{css:"",logPrefix:"read",initialize:function(e,t){var i,a=this;a.constructor.superClass.initialize.apply(a,arguments),e&&(a.mid=e.id||e.mid,a.part=e.part,a.speed=t.speed,a.locked=e.locked,i=e.action),a.reader=new c.Z({module:a,mid:a.mid,fid:a.fid,folderData:a.folderData,isThread:a.isThread,isHidden:a.isHiddenMod,viewType:a.viewType,part:a.part,area:a.area,speed:a.speed,locked:a.locked}),a.checkServiceMail(),void 0!==i&&a.reader.addInitCall((function(){switch(i){case"reply":a.reader.assistant.reply();break;case"replyAll":a.reader.assistant.reply({type:"all"});break;case"forward":a.reader.assistant.forward()}})),a.reader.addInitCall((function(){a.reader.view.getAD(!0)}))},getData:function(e){var t=this,a=t.reader,o=t.folderData;try{$.Log.cache({read_mail_init:{success:!0,mid:a.mid,mails:[{folder_id:a.fid.toString(),mail_id:a.mid,from:$.Uri.getEmails(o.from).match[0].address}],account:(0,n.$S)("orgUid")}})}catch(e){}function r(s){var c,d=function(){s||e()};try{var u=o.tag||[],m=(0,n.$S)("attrs").user.junkpic;$.Array.has(u,"%st_sys_fake%")&&0!==m&&(a.junkPic=!0)}catch(e){}if(t.locked&&!s)return Promise.resolve().then(i.bind(i,61785)).then($.Function.bind((function(e){e.default.unlockMail((function(){a.body.reload(!0),r(!0)}),(function(){t.remove()}))}))),void d();if(a.resetReceiverText(),a.resetAttachFlag(),!t.part&&!a.isDecrypted){if("complete"===(c=l.default.getMailData({mid:t.mid,call:function(e){void 0!==e&&(t.data=a.data=e.var),a.setAttachObj(),void 0===t.resourcePreloaded&&(t.resourcePreloaded=!0,d()),t._subInit()}})))return;if("loading"===c)return t.resourcePreloaded=!1,void d()}t.part||d();var p={param:{area:t.area,mid:t.mid,part:t.part,markRead:!(t.folderData.flags||{}).read&&!t.isHiddenMod,password:t.token},call:function(e){void 0!==e&&(t.data=a.data=e.var),t.part&&(t.folderData=t.reader.folderData={subject:t.data.subject,flags:{},from:t.data.from},"textCall"in t&&(t.textCall(t.getText()),delete t.textCall),d()),t._subInit()},cacheFlag:a.isDecrypted?0:3,isHidden:t.isHiddenMod};t.action.readMessage(p)}(0,n.$S)("read_mail_init",+new Date),void 0===o?m.default.getLetterData({moduleName:t.listModule,mid:t.mid,callback:function(e,i){e&&(t.folderData=a.folderData=o=e,t.fid=a.fid=e.fid,t.checkServiceMail(),"textCall"in t&&!t.part&&(t.textCall(t.getText()),delete t.textCall),r()),i&&i.code===$.S_PARTIAL_OK&&$.Msgbox.show({header:p.t("è¯»ä¿¡å¼‚å¸¸"),statsKey:"Read_NoGuide_Popup_MailNotFound",content:p.t("æŠ±æ­‰ï¼Œè¯¥å°ä¿¡ä»¶ä¸å­˜åœ¨ã€‚"),ok:function(){t.remove()}})}}):r()},init:function(){var e=this;e.constructor.superClass.init.apply(e),e.isHiddenMod||window.setTimeout((function(){try{e.getDom("h1Subject").focus()}catch(e){}}),500),e.log({action:"init",item:"mod",value:{mid:e.mid,timestamp:+new Date,thread:0}})},cache:function(){var e=this,t=e.reader;e.isHiddenMod&&(e.isHiddenMod=t.isHidden=!1,t.body.autoSize(),window.setTimeout((function(){e.getDom("h1Subject").focus(),t.assistant.sendReceipt()}),0)),e.constructor.superClass.cache.apply(e,arguments)},onAfterRender:function(){var e=this;e.speed&&!e.reader.locked&&l.default.getFrame(e)},onFocus:function(){this.reader.focusSubject()},checkServiceMail:function(){var e=this,t=e.folderData;if(void 0!==t){var i=t.tag;e.isServiceMail=e.reader.isServiceMail=$.Ext.read_mailService&&!e.isThread&&i instanceof Array&&$.Array.has(i,"%st_p_extr%")}},_subInit:function(){var e=this,t="";try{t=$.Uri.getEmails(e.folderData.from).match[0].address}catch(e){}var i="";try{i=e.listExtend.subtype}catch(e){}$.Log.cache({read_mail_success:$.Support.getStatsMailinfo({value:1,mid:e.reader.mid,attached:e.reader.attached?1:0,from:t,subtype:i})}),e.reader.init();var a,n=(e.data.antispamInfo||{}).RulesType,o=e.fid;if(n&&"ntessale"!==n&&5!==o&&7!==o)if((n=$.String.trim(n.toLowerCase()))&&0!==n.indexOf("fake")&&0!==n.indexOf("ntesfake")&&"ntessys"!==n)(a=e.getDom("h1Subject")).innerHTML='<img src="https://mimg.127.net/p/js4/lib/img/integrity/cx_0.gif" class="kF0" alt="'+p.t("ç½‘æ˜“è¯šä¿¡é‚®ä»¶è”ç›Ÿè®¤è¯é‚®ä»¶")+'" title="'+p.t("ç½‘æ˜“è¯šä¿¡é‚®ä»¶è”ç›Ÿè®¤è¯é‚®ä»¶")+'"/>'+a.innerHTML,e.getEl("dvReadHeadInfo").addClass("uL0"),(r=e.getDom("dvSystemCert"))&&(r.innerHTML='<img class="tX1" src="https://mimg.127.net/p/js4/lib/img/integrity/cert_cx.png" alt="'+p.t("ç½‘æ˜“é‚®ä»¶è®¤è¯ å‘ˆç°è”ç›Ÿ")+'">');else if("ntessys"===n){var r;(a=e.getDom("h1Subject")).innerHTML='<img src="https://mimg.127.net/p/js4/lib/img/integrity/cx_e.gif" class="kF0" alt="'+p.t("ç½‘æ˜“å®˜æ–¹é‚®ä»¶")+'" title="'+p.t("ç½‘æ˜“å®˜æ–¹é‚®ä»¶")+'"/>'+a.innerHTML,e.getEl("dvReadHeadInfo").addClass("uL0"),(r=e.getDom("dvSystemCert"))&&(r.innerHTML='<img class="tX1" src="https://mimg.127.net/p/js4/lib/img/integrity/cert_ntes.png" alt="'+p.t("ç½‘æ˜“å®˜æ–¹é‚®ä»¶")+'">')}window.setTimeout((function(){e.reader.translate({check:!0})}),500)},_scrollHandler:function(){var e=this,t=$.Event.getTarget(),i=e.scrollTimer;void 0!==i&&(window.clearTimeout(i),e.scrollTimer=void 0),e.scrollTimer=window.setTimeout((function(){e.getDom("backToTop").style.display=t.scrollTop>0?"":"none",e.scrollTimer=void 0,t=void 0}),500)},remove:function(){var e=this;e.reader.destroy(),e.constructor.superClass.moduleRemove.call(e)}})},84291:function(e,t,i){i(48868),i(92274),i(63045),i(81874),i(54861),i(37885),i(803);var a,n,o=i(72957),r=i(14354),s=i(39579),c=new o.c1("module.read.ReadView");n=r.Z,a=$.createClass((0,o.$N)("module.read.ReadView")),$.Object.mix(a,n,null,{getToolbarConf:function(e){var t=this,a=t.module;e=e||{};var n,o=a.folderData,r=o.fid,l=o.tag||[],d={groups:[]},u=d.groups,m="button";if(u.push({items:[{xtype:m,text:'<span style="font-family:simsun"><< </span>'+c.t("è¿”å›"),click:function(){a.log({action:"click",item:"toolbar_back"}),a.back(),$.Menu.hideAllMenu()}}]}),n=[{xtype:m,subclass:"splitBtn",extcls:"nui-imptBtn",text:c.t("å›å¤å…¨éƒ¨"),menu:t.getReplyConf(),click:function(){a.log({action:"click",item:"toolbar_replyall",value:$.Support.getStatsMailinfo({value:1})}),a.reader.assistant.fullReply()},arrclick:function(){a.log({action:"click",item:"toolbar_reply_arr"})}},{xtype:m,subclass:"splitBtn",text:c.t("è½¬ å‘"),menu:t.getForwardConf(),click:function(){a.log({action:"click",item:"toolbar_forward",value:$.Support.getStatsMailinfo({value:1})}),a.reader.assistant.forward()},arrclick:function(){a.log({action:"click",item:"toolbar_forward_arr"})}}],3===r?n.unshift({xtype:m,text:c.t("å†æ¬¡ç¼–è¾‘å‘é€"),click:function(){a.log({action:"click",item:"toolbar_sendagagin"}),Promise.resolve().then(i.bind(i,54107)).then($.Function.bind((function(e){e.default.edit({id:a.mid,body:{decryptPassword:"decryption"in a.reader?a.reader.decryption.pwd:void 0}})})))}}):n.unshift({xtype:m,extcls:"nui-imptBtn",text:c.t("å› å¤"),click:function(){a.log({action:"click",item:"toolbar_reply",value:$.Support.getStatsMailinfo({value:1})}),a.reader.assistant.reply()}}),u.push({items:n}),a.part)return d;if(n=[{xtype:m,text:4===r||15===r||18===r?c.t("å½»åº•åˆ é™¤"):c.t("åˆ  é™¤"),click:function(){a.log({action:"click",item:"toolbar_del",value:$.Support.getStatsMailinfo({value:1,pos:4===r||15===r||18===r?"permanent":"normal"})}),a.moveTo({del:!0})}},{xtype:m,subclass:"dropdownBtn",text:c.t("ç§»åŠ¨åˆ°"),menu:t.getFolderConf(),click:function(){a.log({action:"click",item:"toolbar_move_arr"})}},{xtype:m,subclass:"dropdownBtn",text:c.t("æ›´ å¤š"),menu:t.getMoreConf(),click:function(){a.log({action:"click",item:"toolbar_more_arr"})}}],"archive"!==a.area){if(3===r){var p=o.ctrls||{};$.Array.has(l,"%ex_trace_sp%")||p.encrypt||n.splice(3,0,{xtype:m,id:a.createId("recallBt"),text:c.t("æ’¤å›é‚®ä»¶"),hidden:!($.Ext.letterRecall||$.Ext.letterRecall_vip),click:function(){a.log({action:"click",item:"toolbar_recall"}),a.reader.assistant.recall()}})}else n.splice(1,0,{xtype:m,text:c.t("ä¸¾ æŠ¥"),click:function(){a.log({action:"click",item:"toolbar_report",value:$.Support.getStatsMailinfo({value:1})}),a.report(!0)}},{xtype:m,text:c.t("æ‹’ æ”¶"),click:function(){a.log({action:"click",item:"toolbar_add_refuselist"}),a.reject({from:a.reader.localSender[0].address,sender:a.reader.data.headers&&a.reader.data.headers.Sender&&a.reader.data.headers.Sender[0]||""})}},{xtype:m,subclass:"dropdownBtn",text:c.t("æ ‡è®°ä¸º"),menu:t.getMarkConf(),click:function(){a.log({action:"click",item:"toolbar_mark"})}});if(",5,6,7,18,".indexOf(","+o.fid+",")>-1||e.group){var f=c.t("è¿™ä¸æ˜¯åƒåœ¾é‚®ä»¶");7!==o.fid&&"ad"!==e.group||(f=c.t("è¿™ä¸æ˜¯æ¨å¹¿é‚®ä»¶")),18!==o.fid&&"sub"!==e.group||(f=c.t("è¿™ä¸æ˜¯è®¢é˜…é‚®ä»¶")),e.group&&$.Log.cache({read_blockinfo_fake_show:{value:a.mid,sentDate:+o.sentDate,receivedDate:+o.receivedDate,tag:e.key}}),n.splice(1,0,{xtype:m,text:f,click:function(){if(e.group){a.view.updateToolbar(),a.view.updateSubject(),$.Tips.show({succ:!0,text:c.t("æˆåŠŸä¿¡ä»»é‚®ä»¶")}),(new s.Z).wmsvr({func:"mbox:updateMessageTags",body:{ids:a.mid,add:["%st_m_graydone%"]}});var t={read_blockinfo_mailtag_notspam_click:{value:a.mid,sentDate:+o.sentDate,receivedDate:+o.receivedDate,tag:e.key}};return t.read_blockinfo_mailtag_notspam_click=$.Support.getStatsMailinfo(t.read_blockinfo_mailtag_notspam_click),void $.Log.cache(t)}a.log({action:"click",item:"toolbar_trust",value:$.Support.getStatsMailinfo({pos:"folder_"+o.fid})}),a.report(!1)}})}}u.push({items:n});var h=$.Ud.udProxy["product.collaboration.expireTime"],g=$.Ud.udProxy["product.collaboration.memberType"],v=$.Ud.udProxy["product.cafeteria.userGroup_collab_promotion_task"],b=$.Ud.udProxy["product.collaboration.isTeamMail"],y=$.Misc.getTime().getTime()>h;return $b?(a.log({action:"show",item:"toolbar_assign_task"}),u.push({items:[{xtype:m,text:c.t("åˆ†é…ä»»åŠ¡"),click:function(){a.log({action:"click",item:"toolbar_assign_task"}),a.reader.assistant.assignTask()}}]})):v&&(a.log({action:"show",item:"toolbar_assign_taskPromotion"}),u.push({items:[{xtype:m,text:c.t("åˆ›å»ºå›¢é˜Ÿï¼Œåˆ†é…ä»»åŠ¡é‚®ä»¶"),click:function(){a.log({action:"click",item:"toolbar_assign_taskPromotion"}),$.Support.teamMailPromotion()}}]}))),u.push(t.getSiblingBtConf()),u.push(t.getOptionConf()),d},getContentHtml:function(){return['<div class="tR0" role="list">',this.module.reader.view.getHtml(),"</div>",'<div class="frame-main-cont-body-mask"></div>'].join("")}}),t.Z=a},19=i(14396);a=$.createClass((0,n.$N)("module.read.Turbo"));var r=(0,n.$S)("attrs").user.junkpic||0,s=$.Ext.read_noSsidRead?"read/readhtml.jsp?preventSetRead=true":$G.environment.readUrl+"&preventSetRead=true";$.Object.extend(a,{frameCache:{},dataCache:{},start:function(e){var t=this,i=e.level,a=e.param;void 0===t.action&&(t.action=new o.Z),i>0&&t.loadMailData(a),i>1&&t.loadFrame(a)},getMailData:function(e){var t=e.mid,i=e.call,a=this.dataCache[t];return void 0===a?a:a.loading?(a.call=i,"loading"):(i(a.data),"complete")},getFrame:function(e){var t,i,a=this,n=e.mid,o=a.frameCache[n],r=o.frame;void 0!==o&&(t=e.createId("frameBody"),i=e.reader.body,r.attr({id:t,name:t}),void 0!==a.frameHandler&&window.clearTimeout(a.frameHandler),e.getDom("dvContent").appendChild(r.dom),r.show(),o.loaded&&(i.frame=r.dom,i.onLoadHandler(),r.destroy()),r.listen("load",(function(){i.onLoadHandler(this),r.destroy()})),a.frameCache[n]=void 0)},loadMailData:function(e){var t,i=e.id,a=this.dataCache;void 0===a[i]&&((t={id:i,header:!0,returnImageInfo:!0,returnAntispamInfo:!0,autoName:!0,returnHeaders:{"Resent-From":"A",Sender:"A","List-Unsubscribe":"A","Reply-To":"A"},supportTNEF:!0}).returnHeaders.From="",e.part&&(t.part=e.part),e.markRead&&(t.markRead=!0),"archive"===e.area&&(t.mboxa="2"),a[i]={loading:!0},this.action.wmsvr({func:"mbox:readMessage",body:t,call:function(e){!function(e){if(e.code===$.S_OK){var t=a[i];t.loading=!1,t.data=e,void 0!==t.call&&(t.call(e),t.call=void 0)}else a[i]=void 0}(e)},log:{l:"read",action:"read"},cacheFlag:3,hideWait:!0}))},loadFrame:function(e){var t,i,a=this,n=e.id,o=a.frameCache;void 0===o[n]&&(t=$.Element.create("IFRAME"),i=s+"&mid="+n+"&color="+$G.user.color,(2===r||1===r&&5===e.fid)cument.body.className.indexOf("ua-noYaHei")<0&&(i+="&font=15"),t.attr({frameBorder:"0",scrolling:"no",src:i}),t.setClass("oD0"),t.css({height:"400px",display:"none"}),o[n]={frame:t,loaded:!1},$.Event.one(t.dom,"load",(function(){void 0!==o[n]&&(o[n].loaded=!0)})),a.frameHandler=window.setTimeout((function(){a.frameHandler=void 0,document.body.appendChild(t.dom)}),0))}}),t.default=a},15832:function(e,t,i){i.r(t),i(48868),i(92274),i(63045),i(81874),i(54861),i(42295),i(34994),i(66403),i(26340),i(79150);var a=i(72957),n=i(92066),o=new a.c1("product.AccountRelate"),r=$.Object,s=$.createClass((0,a.$N)("product.AccountRelate"));r.extend(s,{isMailMasterLogined:!1,hasRelateAccount:void 0,init:function(e,t){var i=this;(0,a.$S)("isMailMasterLogined")||(i.emRelateAccounts={},i.relateAccount=[],t&&t(),$.Listener.listen("accountRelate:getCount",(function(e,t){if(e&&(i.relateAccountCount[e]=t,t.newCount>0)){var a=document.getElementById("_account_"+e);a&&$(a).html("<strong>("+t.newCount+")</strong>")}var r=0;for(var s in i.relateAccountCount)r+=i.relateAccountCount[s].newCount;r+=n.Z.getTotal("unread");try{r>0?$(document.getElementById("_account_"+$G.user.uid)).html("<strong>("+r+")</strong>"):$(document.getElementById("_account_"+$G.user.uid)).html("")}catch(e){}var c=$.fly("#spnUid");c&&(c.dom.title=o.t("å…±æœ‰")+r+o.t("å°æœªè¯»é‚®ä»¶"))})),i.getAllAccountCount(),$.Listener.listen("accountRelate:unRelate",(function(e){delete i.relateAccountCount[e]})))},beforeSwitch:function(e){s.switchUid=e,s.switchAccount((0,a.$S)("orgUid"))},switchAccount:function(e,t){var n=this;Promis)).then($.Function.bind((function(i){var r=i.default;if(t)s.beforeSwitch(t);else{(new $.DataAction).wmsvr({func:"user:getAttrs"});var c=s.relateAccount,l=e;if(l===(0,a.$S)("orgUid")||$.Array.has(c,l)){var d,u=(t=s.switchUid).split("@")[1],m=($.Uri.getUrl("errorpage",!0),this.product[u]),p=(d=d||{"163.com":"https://mail.163.com/entry/coremail/fcg/ntesdoor2?lightweight%3D1%26verifycookie%3D1%26language%3D-1%26style%3D7%26df%3Dwm_switch","126.com":"https://mail.126.com/entry/cgi/ntesdoor?hid%3D10010102%26lightweight%3D1%26verifycookie%3D1%26language%3D0%26style%3D7%26df%3Dwm_switch","yeah.net":"https://mail.yeah.net/entry/cgi/ntesdoor?lightweight%3D1%26verifycookie%3D1%26style%3D7%26df%3Dwm_switch","vip.163.com":"https://reg.vip.163.com/enterMail.m?style%3D7%26language%3D0%26enterVip%3Dtrue%26verifycookie%3D1%26username%3D"+t,"188.com":"https://reg.mail.188.com/servlet/enter?verifycookie=1&enterWebmail=1&language=0&style=7&username="+t,"vip.126.com":"https://reg.vip.126.com/enterMail.m?style%3D7%26language%3D0%26enterVip%3Dtrue%26verifycookie%3D1%26username%3D"+t}[u])+encodeURIComponent("&related=true&MAIL_MISC="+$.Cookie.get("MAIL_MISC").replace(/\'/g,"").replace(/#/g,"%23"));"https:"==$G.environment.protocol&&(p+=encodeURIComponent("&allssl=true"));var f=$.Uri.getUrl("accountRelate",!0)+"?chgUsername={0}&url={1}&url1={2}&url2={3}&url3={4}&product={5}&remind=1&noRedirect=1",h=encodeURIComponent($.Uri.getUrl("backurl",!0)+"parent.$.Ajax.paddingAccountSwitch&contact=location.search");f=$.Support.format(f,t,h+encodeURIComponent("&result=success"),h+encodeURIComponent("&result=failed"),h,h,m),$.Ajax.paddingAccountSwitch=function(e){for(var i,s,c,l,d,h=e.substr(1).split("&"),v=0,b=h.length;v<b;v++){var y=h[v].split("=");"errorType"===y[0]&&(i=y[1]-0),"result"===y[0]&&(c=decodeURIComponent(y[1])),"url"===y[0]&&(l=decodeURIComponent(y[1])),"errorUsername"===y[0]&&(d=decodeURIComponent(y[1]))}if(c&&"success"===c||"failed"===c){window.gAd.getBiz=null;var x=!1,k=$.Browser.getVersion()||[0,0];if($.Browser.chrome()&&k[0]>=80&&(x=!0),!x||(0,a.$S)("is163")||p.indexOf((0,a.$S)("fullDomain"))>-1)top.location.href=decodeURIComponent(p);else{var S;S=(0,a.$S)("isVip")?(0,a.$S)("host").replace(/vip.163.com|vip.126.com|vip.188.com/,"mail.163.com"):(0,a.$S)("host").replace(/126.com|yeah.net/,"163.com");var w=encodeURIComponent("https://"+S+"/js6/switch_account.jsp?nextHost=mail."+u+"&goUrl="+p);w=$.Support.format($.Uri.getUrl("accountRelate",!0)+"?chgUsername={0}&url={1}&url1={2}&url2={3}&url3={4}&product={5}&remind=1&noRedirect=1",t,w,w,w,w,m);var T={loginCookie:$.Misc.getMailSess()};(0,a.$S)("sSwitchAccountPwd")&&(T.password=(0,a.$S)("sSwitchAccountPwd"));var C=document.createElement("form");for(var _ in C.action=w,C.method="post",T)if(T.hasOwnProperty(_)){var I=T[_],A=document.createElement("input");A.type="hidden",A.name=_,A.value=I,C.appendChild(A)}document.body.appendChild(C),C.submit()}(0,a.$S)("sSwitchAccountPwd","")}else if(402!==i){if(461===i)return $.Msgbox.show({header:o.t("å¯†ç éªŒè¯"),title:o.t("æ‚¨å·²è®¾ç½®&nbsp;")+$.Support.trimAccount(t)+o.t("&nbsp;ä¸ºæ‰€æœ‰å…³è”é‚®ç®±ä¸­çš„é‡è¦é‚®ç®±ï¼Œéœ€è¦è¾“å…¥è¯¥é‚®ç®±å¯†ç æ‰èƒ½è¿›è¡Œåˆ‡æ¢ï¼š"),type:"prompt",inputLabel:o.t("é‚®ç®±å¯†ç ï¼š"),inputType:"password",ok:function(e){return""===$.String.trim(e)?o.t("è¯·è¾“å…¥å¯†ç ï¼"):(g(f,r.encode(e)),!0)}}),void $.Event.fire(document.body,"click");if(428===i)return window.gAd.getBiz=null,void(top.location.href=l+"&url="+p);if(425!==i){s=n.errorCode[i];try{$.Msgbox.msgbox&&$.Msgbox.msgbox.input?$.Msgbox.msgbox.input.showTips(s):$.Msgbox.show({title:s})}catch(e){return e}}else{var M,L=/\@/.test(d)?d:d+"@163.com";M=L===(0,a.$S)("uid")?o.t("æ‚¨çš„å½“å‰è´¦å·å­˜åœ¨å®‰å…¨é£é™©ï¼Œæš‚æ—¶æ— æ³•åˆ‡æ¢ï¼Œå»ºè®®æ‚¨é©¬ä¸Šä¿®æ”¹å¯†ç ã€‚"):o.t("æ‚¨çš„ ")+L+o.t(" è´¦å·å­˜åœ¨å®‰å…¨é£é™©ï¼Œæš‚æ—¶æ— æ³•åˆ‡æ¢è´¦å·ï¼Œå»ºè®®æ‚¨é©¬ä¸Šä¿®æ”¹å¯†ç æˆ–è€…è§£é™¤è´¦å·å…³è”ã€‚");try{$.Msgbox.msgbox&&$.Msgbox.msgbox.input?$.Msgbox.msgbox.input.showTips(M):$.Msgbox.show({title:M})}catch(e){return e}}}else $.Support.relogin()},g(f)}else $.Support.relogin(o.t("æ‚¨å·²ç™»å½•ç½‘æ˜“å…¶ä»–è´¦å·ï¼Œè¯·é‡æ–°ç™»å½•ã€‚"))}function g(e,t){var i={loginCookie:$.Misc.getMailSess()};t&&(i.password=t,(0,a.$S)("sSwitchAccountPwd",t)),$.Ajax.request({method:"post",requestType:$.Ajax.IFRAME,url:e,body:i})}}),this))},getCount:function(){for(var e={"163.com":"mail.163.com","126.com":"mail.126.com","yeah.net":"mail.yeah.net","vip.163.com":"vip.163.com","vip.126.com":"vip.126.com","188.com":"vip.188.com"},t=s.relateAccount,i=(n.Z.getTotal("unread"),0);i<t.length;i++){var a=t[i];$.Ajax.jsonp("//msg."+e[a.split("@")[1]]+"/cgi/mc?funcid=getusrnewmsgcnt&fid=0&addSubFdrs=1&language=0&style=0&template=newmsgres_setcookie.htm&cuslog=true&username="+a,(function(e,t,i){e-=0,e=Math.max(e,0);var a={total:t=Math.max(t,0),newCount:e};$.Listener.fire("accountRelate:getCount",i,a)}))}},getAllAccountCount:function(){$.Listener.fire("accountRelate:getCount")},relateAccountCount:{},relateAccount:[],product:{"126.com":"mail126","163.com":"mail163","yeah.net":"mailyeah","188.com":"mail188","vip.163.com":"mailvip","vip.126.com":"mailvip"},switchUid:null,errorCode:{401:o.t("URLè¯­æ³•é”™è¯¯æˆ–å‚æ•°å€¼éæ³•"),402:o.t("è¶…æ—¶äº†ï¼Œè¯·æ‚¨é‡æ–°ç™»å½•ï¼"),412:o.t("æ‚¨å°è¯•çš„æ¬¡æ•°å·²ç»å¤ªå¤š,è¯·è¿‡ä¸€æ®µæ—¶é—´å†è¯•"),414:o.t("æ‚¨çš„IPç™»å½•å¤±è´¥æ¬¡æ•°è¿‡å¤š,è¯·ç¨åå†è¯•"),415:o.t("æ‚¨ä»Šå¤©ç™»å½•é”™è¯¯æ¬¡æ•°å·²ç»å¤ªå¤š,è¯·æ˜å¤©å†è¯•"),416:o.t("æ‚¨çš„IPä»Šå¤©ç™»å½•è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•"),417:o.t("æ‚¨çš„IPä»Šå¤©ç™»å½•æ¬¡æ•°è¿‡å¤šï¼Œè¯·æ˜å¤©å†è¯•"),418:o.t("æ‚¨ä»Šå¤©ç™»å½•æ¬¡æ•°è¿‡å¤š,è¯·æ˜å¤©å†è¯•"),419:o.t("æ‚¨çš„ç™»å½•æ“ä½œè¿‡äºé¢‘ç¹ï¼Œè¯·ç¨å€™å†è¯•"),420:o.t("ç”¨æˆ·åä¸å­˜åœ¨"),422:o.t("è´¦å·é”å®šæˆ–é“å·æœåŠ¡å·²åˆ°æœŸ"),423:o.t("VIPæˆ–188è´¦å·å·²åˆ°æœŸï¼Œè¯·ç»­è´¹ï¼"),460:o.t("å¯†ç é”™è¯¯"),461:o.t("é‡è¦è´¦å·ï¼Œéœ€è¦éªŒè¯å¯†ç "),464:o.t("è´¦å·æ— å…³è”å…³ç³»"),500:o.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·æ‚¨ç¨åå†è¯•ï¼"),503:o.t("ç³»ç»Ÿç»´æŠ¤ï¼Œè¯·æ‚¨ç¨åå†è¯•ï¼")},emRelateAccounts:{},_getLoginUrl:function(e){var t="",i=e.split("@")[1],a=!1;if("163.com"!==i&&"126.com"!==i&&"yeah.net"!==i||(a=!0),a){var n="df=webmail&from=web&funcid=loginone&passtype=1&style=5&product=mail"+i.split(".")[0]+"&uid="+e;"hw"===$.Cookie.get("mail_dist")&&(n+="&mail_dist=hw"),t={"126.com":"https://mail.126.com/entry/cgi/ntesdoor?","163.com":"https://mail.163.com/entry/coremail/fcg/ntesdoor2?","yeah.net":"https://mail.yeah.net/entry/cgi/ntesdoor?"}[i]+n}else t={"vip.163.com":"https://reg.163.com/logins.jsp?product=mailvip&type=1&url={0}&url2={1}","1Webmail=1&language=0&style=1%26df%3Dwebmail_relogin","vip.126.com":"https://reg.163.com/logins.jsp?product=mailvip&type=1&url=https://reg.vip.126.com/enterMail.m?style%3D9%26language%3D0%26enterVip%3Dtrue%26verifycookie%3D1%26username%3D"+e+"&url2=https://reg.vip.126.com/logon.m?style%3D9%26language%3D0%26enterVip%3Dtrue%26verifycookie%3D1%26df%3Dwebmail_relogin%26username%3D"+e}[i];return t}}),t.default=s},52877:function(e,t,i){i.r(t),i(11602),i(37092),i(92274),i(55737),i(63045),i(48868),i(81874),i(54861),i(5165);var a=i(72957);function n(e,t,i,a,n,o,r){try{var s=e[o](r),c=s.value}catch(e){return void i(e)}s.done?t(c):Promise.resolve(c).then(a,n)}var o=new a.c1("product.attach.BaseAttach"),r=$.Object,s=$.createClass((0,a.$N)("product.attach.BaseAttach"));function c(){var e;return e=regeneratorRuntime.mark((function e(){var t,a,n,o,r,s,c,l,d,u,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){try{var e=$.getClass("product.attach."+n);return e?Promise.resolve(e):o(n)}catch(e){return o(n)}},o=function(e){switch(e){case"NetfolderAttach":return i.e(603).then(i.bind(i,8957));case"FileAttach":return i.e(603).then(i.bind(i,52461));case"InternalAttach":return i.e(603).then(i.bind(i,14024));case"CloudAttach":return i.e(603).then(i.bind(i,40328));case"YNoteAttach":return i.e(603).then(i.bind(i,83855));case"OneDriverAttach":return i.e(603).then(i.bind(i,31945));default:return Promise.reject(new Error("not found entity"))}},a=(t=this).type,n={netfolder:"NetfolderAttach",file:"FileAttach",internal:"InternalAttach",cloud:"CloudAttach",ynote:"YNoteAttach",onedriver:"OneDriverAttach"}[a],e.next=8,r();case 8:if(s=e.sent,c=s.default,l=$("#divAttachManageBody"),!t.entity[a]){e.next=15;break}t.entity[a].renderUpdate({capacity:!0,footer:!0,select:!0,button:!0}),e.next=26;break;case 15:if(!t.checkAdvlock()){e.next=17;break}return e.abrupt("return");case 17:d=new c,(u=$.Element.create("DIV")).attr({type:a}),u.dom.id=a,l.append(u.dom),m={parent:t,attach:t.attach,body:u};try{d.init(m)}catch(e){}t.entity[a]=d,d.setFooter();case 26:t.switchDiv(a),t.setTabSelect(a),t.setHeader(a);case 29:case"end":return e.stop()}}),e,this)})),c=function(){var t=this,i=arguments;return new Promise((function(a,o){var r=e.apply(t,i);function s(e){n(r,a,o,s,c,"next",e)}function c(e){n(r,a,o,s,c,"throw",e)}s(void 0)}))},c.apply(this,arguments)}r.extend(s.prototype,{type:null,entity:{},entry:function(e){var t=this;t.module=e.module,t.attach=e.attach,t.type=e.type,t.checkAdvlock()||(t.entity={},t.init())},init:function(){this.initMsgbox(),this.initEntity()},initMsgbox:function(){var e=this,t='<div id="divAttachManageTab" class="nui-tabs cw0">'+($.Ext.netfolder_enable?'<div class="nui-tabs-item" type="file">'+$.NF_NAME+"</div>":'<div class="nui-tabs-item" type="file">'+o.t("è¶…å¤§é™„ä»¶")+"</div>")+'<div class="nui-tabs-item" type="internal">'+o.t("å¾€æ¥é™„ä»¶")+'</div><div class="nui-tabs-item" type="ynote">'+o.t("æœ‰é“äº‘ç¬”è®°")+"</div>"+($.Ext.attach_online_modify?'<div class="nui-tabs-item" type="onedriver">'+o.t("ç½‘æ˜“æ–‡æ¡£")+"</div>":"")+'</div><div id="divAttachManageBody" style="height:230px;"></div>';this.msg=$.Msgbox.show({type:"confirm",contentType:"wide",modeless:!0,content:t,ok:function(){return e.submit(),!0},cancel:function(){return e.cancel(),!0},close:function(){e.destroy()}}),this.initTab(),e.msg.buttons.ok.setDisabled(!0)},initTab:function(){var e=this;$("#divAttachManageTab").find("DIV").each((function(t,i){$(i).listen("click",(function(){e.switchTo(this.getAttribute("type"))}))}))},initEntity:function(){return c.apply(this,arguments)},checkAdvlock:function(){var e=this,t=e.type;if("netfolder"==t||"file"==t){var i=(0,a.$S)("advLock");if(i&&!i.authenticated2&&!i.disabled&&i.nf)return $.AdvLock.show((functihDiv:function(e){for(var t=$("#divAttachManageBody").dom.childNodes,i=0;i<t.length;i++){var a=t[i],n=$(a).attr("type");a.style.display=n!=e?"none":"block"}},switchTo:function(e){this{var e=t),e.close()},cancel:function(){this.close()},close:function(e){var t=this;setTimeout((function(){t.msg.close(),"function"==typeof e&&e()}),25),t.destroy()},destroy:function(){"close"!=this.mode&&(this.mode="close")},setTabSelect:function(e){e=e||this.type,$("#divAttachManageTab").find("DIV").each((function(t,i){var a=$(i);a.attr("type")==e?a.addClass("nui-tabs-item-selected"):a.removeClass("nui-tabs-item-selected")}))},setHeader:function(e){var t={internal:o.t("æœ€è¿‘50ä¸ªå¾€æ¥é™„ä»¶åˆ—è¡¨"),cloud:o.t("æ·»åŠ è¶…å¤§é™„ä»¶"),netfolder:o.t("æ·»åŠ æ–‡ä»¶ä¸­å¿ƒæ–‡ä»¶"),file:$.Ext.netfolder_enable?o.t("æ·»åŠ æ–‡ä»¶ä¸­å¿ƒ"):o.t("æ·»åŠ è¶…å¤§é™„ä»¶"),ynote:o.t("æ·»åŠ äº‘ç¬”è®°é™„ä»¶"),onedriver:o.t("ç½‘æ˜“æ–‡æ¡£é™„ä»¶")}[e=e||this.type];this.msg.getEl(nction(e){e=e||"",this.msg.footer.html(e)},setButton:function(e,t){var i=this.msg.buttons.ok;"string"==typeof e&&i.setText(e),"boolean"==typeof t&&i.setDisabled(t)},todo:function(){}}),t.default=s},40328:function(e,t,i){i.r(t),i(803),i(37092),i(92274),i(87553),i(55737),i(48868),i(63045),i(81874),i(54861);var a=i(5165),n=i(62193),o=i(9002),r=i(72957),s=new r.c1("product.attach.CloudAttach"),c=$.Object,l=$.Ud,d=$.createClass((0,r.$N)("product.attach.CloudAttach"));c.extend(d.prototype,{timer:null,user:null,init:function(e){var t=this;c.extend(t,{parent:e.parent,attach:e.attach,body:e.body,mode:"none",status:"load",cross:{id:1},user:null,list:{init:!1,checkAll:null,checkList:null,files:{}},check:{all:null,list:[]}});var i=t.list;i.add=$.Function.bind(d.fileAdd,i),i.get=$.Function.bind(d.fileGet,i),t.checkUser()},checkUser:function(e){var t=this;if((0,r.$S)("isFree")){var i=l.get({field:"ntes_contact",flag:"hasBigAttach"});if("1"!=i)return"2"==i?void d.request({url:"http://e.mail."+(0,r.$S)("domain")+"/mobilemail/fsActive.jsp",callback:function(i){var a=i.code;1==a?(l.set({field:"ntes_contact",flag:"hasBigAttach",value:"1"}),t.checkUser(e)):-2==a?$.Msgbox.show({title:s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·é‡æ–°ç™»å½•å†è¯•ï¼")}):$.Msgbox.show({title:s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼")})}}):void d.request({op:"fs_s_g_a",callback:function(i,a){if(200==i)a&&a.account&&(l.set({field:"ntes_contact",flag:"hasBigAttach",value:"1"}),t.setUser(a),t.checkUser(e));else{var n="";402==i?(l.set({field:"ntes_contact",flag:"hasBigAttach",value:"2"}),t.checkUser(e)):n=401==i?s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·é‡æ–°ç™»å½•å†è¯•ï¼"):s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼"),n&&$.Msgbox.show({title:n})}}})}t.user?t.renderMain():t.loadData()},loadData:function(){var e=this;d.request({op:"fs_s_g_a",callback:function(t,i){if(200==t){if(!i||!i.account)return;e.setUser(i),e.renderMain()}else{var a="";if(401==t)a=s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·é‡æ–°ç™»å½•å†è¯•ï¼");else{if(402==t)return;a=501==t?i&&i.info?i.info:s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç»´æŠ¤ï¼Œè¯·ç¨åå†è¯•ï¼"):s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼")}e.body.html(a)}}})},renderMain:function(){var e=this,t=e.body;t.empty();var i=new $.Checkbox({title:s.t("å…¨é€‰"),checkedchange:function(t){e.selectAll(this.getChecked())}});e.check.all=i;var a='<div class="nui-simpleTable nui-table bc0"><table><thead class="nui-table-head"><tr class="nui-table-row"><th class="nui-table-cell nui-table-cell-forChk nui-table-cell-isFirst">'+i.html()+'</th><th class="nui-table-cell s0">'+s.t("æ–‡ä»¶å")+'</th><th class="nui-table-cell C0">'+s.t("å¤§å°")+'</th><th class="nui-table-cell nui-table-cell-isLast B0">'+s.t("å‰©ä½™æ—¶é—´")+'</th></tr></thead></table></div><div class="bm0" style="overflow-y:scroll"><div id="divCloudAttachManageList" class="nui-simpleTable nui-table bn0"></div></div>';t.html(a),e.initList(),e.status="list",new $.Button({text:s.t("æ·»åŠ æ–°æ–‡ä»¶"),renderTo:e.parent.msg.footer.dom,click:function(){e.addFile()}})},initList:function(){var e=this,t={d:"0",g:"1",cl_cloud:"1"};e.user.updateTime>0&&(t.t=e.user.updateTime),e.list.init||(t.r="1",d.request({op:"fs_afs_g_a",param:t,callback:function(t,i){if(200==t&&i.returnList){i.userState&&i.userState.updateTime&&(e.user.updateTime=i.userState.updateTime),e.list.init=!0,e.list.files={};var a=i.fileInfos.length,n=0,o=0;$.Array.each(i.fileInfos,(function(t,i){i.completed||o++,n+=i.size,e.list.add(String(i.id),i)})),e.user.spaceUsed=n,e.user.unexpiredCompleteCount=a-o,e.user.unexpiredIncompleteCount=o,e.renderList()}}}))},renderList:function(){var e,t=this,i=n.Z.getTime(0).valueOf(),o=[];s.t("ç»­ä¼ "),$.Array.each(t.list.get({completed:!0}),(function(e,n){var r="",c=n.id,l=d.getExpire(n.expiredTime,i),u=n.fileName,m=[$.String.encodeHTML(u),$.String.encodeHTML(u)],p=a.Z.getSubtype({type:"file",name:u}),f=new $.Icon({type:"file",subtype:p});if(n.completed){var h=new $.Checkbox({checkedchange:function(e){va"),a=i.dom.getAttribute("fid"),n=t.list.get({key:a}),o=this.getChecked();o?i.addClass("nui-table-row-selected"):i.removeClass("nui-table-row-selected"),t.selectItem(n,o)}});t.check.list.push(h),r='<tr fid="'+c+'" class="nui-table-row"><td class="nui-table-cell nui-table-cell-forChk nui-table-cell-isFirst">'+h.html()+'</td><td class="nui-table-cell P0">'+f.html()+'</td><td class="nui-table-cell t0" title="'+m[0]+'"> <nobr>'+m[1]+'</nobr></td><td class="nui-table-cell J0"></td><td class="nui-table-cell I0" title="'+s.t("å·²ä¸‹è½½ï¼š")+n.downloadCount+s.t("æ¬¡")+'">'+$.Number.convert(n.size)+'</td><td class="nui-table-cell nui-table-cell-isLast H0">'+l+"</td></tr>"}o.push(r)})),e=o.length?'<table><tbody class="nui-table-body">'+o.join("")+"<tbody></table>":'<div class="E0">'+s.t("æ‚¨è¿˜æ²¡æœ‰ä¸Šä¼ ä»»ä½•æ–‡ä»¶")+"</div>";var r=$("#divCloudAttachManageList");r.html(e),o.length&&r.find("TR").each((function(e,i){var a=(i=$(i)).dom.getAttribute("fid"),n=t.list.get({key:a});if(n.completed)i.listen("mouseover",(function(){-1==i.dom.className.indexOf("nui-table-row-selected")&&i.addClass("nui-table-row-hover")})),i.listen("mouseout",(function(){i.removeClass("nui-table-row-hover")})),i.listen("click",(function(e){var t=$.Component.getItem(i.find("SPAN").dom),a=t.getChecked();t.setChecked(!a),$.Event.cancelBubble(e)}));else{var o=i.find("A");o&&o.each((function(e,i){"resume"===(i=$(i)).dom.getAttribute("func")&&i.listen("click",$.Function.bind(t.manage,t,n))}))}})),$.Component.setEvents(),t.renderUpdate({capacity:!0,footer:!0,select:!0,button:!0})},renderUpdate:function(e){var t=this,i=t.list.get({state:"select"}).length;if(e.footer){var a="";i>0&&(a=s.t("å·²é€‰æ‹©")+i+s.t("ä¸ªæ–‡ä»¶")),t.setFooter(a)}if(e.select){var n=t.check.all;if(t.user.unexpiredCompleteCount){var o=i==t.user.unexpiredCompleteCount;n.setChecked(o,!0),n.setDisabled(!1)}else n.setChecked(!1,!0),n.setDisabled(!0)}if(e.button){var r=s.t("ç¡® å®š"),c=!1;t.list.get({state:"select"}).length||(c=!0),t.setButton(r,c)}},setUser:function(e){e.displayUrl="http://"+e.displayUrl,e.previewUrl="http://"+e.previewUrl,e.uploadLimit=3,this.user=e},setFooter:function(e){},setButton:function(e,t){this.parent.setButton(e,t)},submit:function(e){var t=this;if(e=e||{},"load"==t.status);else{var i=t.list,a=t.attach,n=[];$.Array.each(i.get({state:"select"}),(function(e,i){var a={type:"bigattach",mid:"cloud",url:t.user.displayUrl+i.url,name:i.fileName,id:i.id,size:i.size,cloud:!0,time:i.expiredTime};i.preview&&(a.preview=t.user.previewUrl+i.url),n.push(a)})),a.linkAdd(n)}},addFile:function(){var e=this.parent,t=this.attach;switch(t.data.get({status:"uploadMode"})){case"plugin":t.cloudTrigger(!0),t.sourceGet("element").link.dom.click();break;case"native":t.cloudTrigger(!0),t.nativeClick();break;case"flash":case"post":d.manage()}e.close()},selectAll:function(e){$.Array.each(this.check.list,(function(t,i){i.getChecked()!=e&&i.setChecked(e)}))},selectItem:function(e,t){var i=this;e.state=t?"select":"",i.timer&&clearTimeout(i.timer),i.timer=setTimeout((function(){i.timer=null,i.renderUpdate({select:!0,footer:!0,button:!0})}),1)}}),c.extend(d,{cross:{id:1},manage:function(){Promise.resolve().then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry("bj_center")})))},getExpire:function(e,t){var i="";if((t=e-(t=t||n.Z.getTime(0).valueOf()))>=0){t=Math.floor(t/36e5);var a=Math.floor(t/24),o=t%24;a&&(i+=a+s.t("å¤©")),i+=o+s.t("å°æ—¶")}return i},request:function(e){var t=d.cross,i=(0,r.$N)("product.attach.CloudAttach")+".response",a=e.url||o.default.getUrl();if(a=$.String.uriAddParam(a,"sid="+(0,r.$S)("sid"))+"&uid="+(0,r.$S)("orgUid"),e.url)t[0]=e.callback,a=a+"&callback="+i;else{a+="&op="+e.op,a+="&p="+o.default.getProduct(),e.param&&c.each(e.param,(function(e,t){var i="&"+[e,t].join("=");a+=i}));var n=t.id++;t[n]=e.callback,a+="&ex="+n,a+="&ev="+i}a+="&ts="+(new Date).valueOf(),$.Ajax.request({url:a,requestType:$.Ajax.SCRIPT})},response:function(e,t,i){var a=this.cross,n=a[i=i||0];n&&(1!=i&&delete a[i],"function"==typeof n&&n.apply(this,arguments))},fileGet:function(e){e=e||{};var t=this.files;if(e.key)return t[e.key];var i=[];return c.each(t,(function(t,a){var n=!0;c.each(e,(function(e,t){a[e]!=t&&(n=!1)})),n&&i.push(a)})),i},fileAdd:function(e,t){this.files[e]=t}}),t.default=d},20422:function(e,t,i){i.r(t),i(66403),i(68233),i(87553);var a=i(5165),n=i(39579),o=i(72957),r=new o.c1("product.attach.DropboxAttach"),s=$.Object,c=$.S_OK,l=$.createClass((0,o.$N)("product.attach.DropboxAttach"));s.extend(l.prototype,{entry:function(e){var t=this;s.extend(t,{module:e.module,attach:e.attach,root:null,tree:{},file:{}}),(0,o.$S)("dropboxToken")?t.check():t.getToken()},getToken:function(){var e=this,t=document.createElement("IFRAME");t.src=l.crossHtmlSrc,t.style.position="absolute",t.style.left="1px",t.style.top="-400px",t.height="1",t.width="1",$(t).listen("load",(function(){var t="http://"+(0,o.$S)("host")+"/jy4-app/xhr/utoken/gen.do?sid="+(0,o.$S)("sid");e.request({url:t,call:function(t){t.code==c?((0,o.$S)("dropboxToken",t.data),e.check()):this.error()}})})),document.body.appendChild(t),(0,o.$S)("dropboxIframe",t)},renderMsg:function(){var e=this,t='<div id="divAttachManageBody" class="bm0" style="overflow-y:scroll;height:260px;"><div id="divAttachManageList">'+r.t("æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...")+"</div></div>";e.msg=$.Msgbox.show({type:"confirm",contentType:"wide",header:r.t("ä»â€œDropboxâ€æ·»åŠ "),modeless:!0,content:t,ok:function(){e.submit()},cancel:function(){}}),e.msg.buttons.ction(){var e=this,t={url:l.getRequestUrl("check"),call:function(t){e.checkCall(t)crossRequest(t)},checkCall:function(e){var t=this,i=e.code,a=e.data,n=!1;i==c?a.linked?(t.renderMsg(),t.initList()):n=!0:"FAIL"==i&&"INVALID_BIND"==e.errorCode&&a.bindUrl?n=!0:t.error(),n&&$.Msgbox.show({type:"confirm",title:r.t("è¿˜æœªç»‘å³ç»‘å®š"),ok:function(){var e=t.attach.base.getCallName($.Function.bind(t.check,t)),i="http://"+(0,o.$S)("host")+"/js6/compose/dropbox.jsp?call="+e,n=a.bindUrl,r="&utoken="+encodeURIComponent((0,o.$S)("dropboxToken"))+"&url="+i;n+=encodeURIComponent(r),window.open(n)}})},initList:function(e){var t=this,i=l.getRequestUrl("list");e=e||"/";var a={url:i+="&path="+encodeURIComponent(e),call:function(e){if(e.code==c){var i=e.data;t.renderList(i)}},error:function(){t.error(arguments)}};t.crossRequest(a)},renderList:function(e){var t=this,i=e.subFiles,n=e.path,o=e.parentPath,s=[],c=[];$.Array.each(i,(function(e,i){var n=i.name,o=i.path;if(i.dir)s.push({xtype:"tree",extcls:"nui-normalTree",text:n,items:[],isFold:!0,hasChild:!0,icons:[{xtype:"icon",type:"file",subtype:"dir"}],listeners:{unfold:function(){t.getTree(o)||(t.setTree(o,i,this),t.initList(o))}}});else{var r=a.Z.getSubtype({type:"file",name:n});c.push({xtype:"tree",extcls:"nui-normalTree",text:n,isFold:!0,icons:[{xtype:"icon",type:"file",subtype:r}],checkValue:o,listeners:{click:function(){var e=this.rawConfig.checkValue;t.getLink(e),t.renderUpdate({footer:!0,button:!0})}}}),t.file[o]=i}}));var l=s.concat(c);if(0===l.length&&l.push({xtype:"tree",extcls:"nui-normalTree",text:r.t("æ— æ–‡ä»¶")}),o)t.getTree(n).ui.update({createChild:!0,items:l});else{var d=$("#divAttachManageList");d.empty();var u={isRoot:!0,createChild:!0,renderTo:d.dom,items:l,onDestroy:function(){}};t.root=new $.Tree(u)}},setLink:function(e,t){this.file[e].link=t},getLink:function(e){var t=this;if(t.file[e].link);else{var i=l.getRequestUrl("link"),a={url:i+="&path="+encodeURIComponent(e),call:function(i){if(i.code==c){var a=i.data;t.setLink(e,a)}},error:function(){t.error(arguments)}};t.crossRequest(a)}},submit:function(){var e=this,t=e.root.getCheckedValue(),i=[];$.Array.each(t,(function(t,a){var n=e.file[a];i.push(n)}));var a=e.attach,n=[];$.Array.each(i,(function(e,t){var i={type:"dropbox",mid:"cloud",url:t.link,name:t.name,id:t.path,size:t.size,cloud:!0};n.push(i)})),a.linkAdd(n)},renderUpdate:function(e){var t=this,i=t.root.getCheckedValue().length;if(e.footer){var a="";i>0&&(a=r.t("å·²é€‰æ‹©")+i+r.t("ä¸ªæ–‡ä»¶")),t.setFooter(a)}if(e.button){var n,o=r.t("ç¡® å®š");n=!(i>0),t.setButton(o,n)}},setFooter:function(e){this.msg.footer.html(e)},setButton:function(e,t){var i=this.msg.buttons.ok;"string"==typeof e&&i.setText(e),"boolean"==typeof t&&i.setDisabled(t)},setTree:function(e,t,i){this.tree[e]={data:t,ui:i}},getTree:function(e){return this.tree[e]},error:function(e){$.Msgbox.show({header:r.t("ä»â€œDropboxâ€æ·»åŠ "),title:r.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼")})},crossRequest:function(e){(0,o.$S)("dropboxIframe").contentWindow.fRequest(e)},request:function(e){var t=new n.Z,i={url:e.url,body:e.body,head:[],error:e.error,call:e.call};t.wmsvr(i)},TODO:function(){}}),s.extend(l,{crossHtmlSrc:"http://"+(0,o.$S)("host")+"/app/h/cross.html",getRequestUrl:function(e){var t,i=encodeURIComponent((0,o.$S)("dropboxToken"));switch(e){case"check":t="http://jy4-app.mail.163.com/jy4-app/xhr/dropbox/account/check.do";break;case"list":t="http://jy4-app.mail.163.com/jy4-app/xhr/dropbox/file/list.do";break;case"link":t="http://dropbox/file/getLink.do"}return t+"?utoken="+i+"&sid="+(0,o.$S)("sid")},error:{S_OK:r.t("æˆåŠŸ"),NOT_LOGIN:r.t("ç”¨æˆ·æœªç™»å½•"),INVALID_BIND:r.t("Dropboxè´¦å·ç»‘å®šæ— æ•ˆ"),UNIDENTIFIED_USER:r.t("ç”¨æˆ·èº«ä»½ä¸æ˜"),FILE_NOT_FOUND:r.t("æ–‡ä»¶æ‰¾ä¸åˆ°"),FAIL:r.t("å…¶å®ƒå‡ºé”™")}}),t.default=l},52461:function(e,t,i){i.r(t),i(68233),i(803),i(37092),i(92274),i(87553),i(48868),i(63045),i(81874),i(54861);var a=i(5165),n=i(9002),o=i(62193),r=i(72957),s=new r.c1("product.attach.FileAttach"),c=$.Object,l=$.Ud,d=$.Uri,u=$.createClass((0,r.$N)("product.attach.FileAttach"));c.extend(u.prototype,{init:function(e){var t=this;c.extend(t,{parent:e.parent,attach:e.attach,body:e.body,status:"load",root:null,tree:{},file:{}}),t.body.setClass("bm0"),t.body.css({paddingTop:"10px"}),t.body.html(s.t("æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...")),t.checkUser()},checkUser:function(){this.initList()},initList:function(e){var t=this,i=(e=e||{}).id||"-1";t.request({op:"getDirFiles",param:{recursive:0,orderBy:6,desc:1,dirId:i,cl_nf:1},callback:function(e){var i=(e=e||{}).code,a=e.result;if(200==i)t.renderList(a);else{var n=u.error[i]||s.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");t.body.html(n)}}})},renderList:function(e){var t=this,i=e.dir,n=i.id,o=i.parentId,r=i.files,c=i.subdirs,l=[];-1==o&&l.push({xtype:"tree",extcls:"nui-normalTree",text:s.t("è¶…å¤§é™„ä»¶"),items:[],isFold:!0,hasChild:!0,icons:[{xtype:"icon",type:"file",subtype:"yundir"}],listeners:{unfold:function(){t.getTree("-2")||(t.setTree("-2",i,this),t.cloudrenderMain())}}}),c&&$.Ext.netfolder_enable&&$.Array.each(c,(function(e,i){l.push({xtype:"tree",extcls:"nui-normalTree",text:i.dirName,items:[],isFold:!0,hasChild:!0,icons:[{xtype:"icon",type:"file",subtype:"dir"}],listeners:{unfold:function(){var e=i.id;t.getTree(e)||(t.setTree(e,i,this),t.initList(i))}}})}));var d=[];r&&$.Ext.netfolder_enable&&$.Array.each(r,(function(e,i){var n=i.fileName,o=a.Z.getSubtype({type:"file",name:n}),r=$.String.encodeHTML(n);d.push({xtype:"tree",extcls:"nui-normalTree",text:r,isFold:!0,icons:[{xtype:"icon",type:"file",subtype:o}],checkValue:i.id,listeners:{click:function(){t.renderUpdate({footer:!0,button:!0})}}}),t.file[i.id]=i}));var u=l.concat(d);if(0===u.length&&u.push({xtype:"tree",extcls:"nui-normalTree",text:s.t("æ— æ–‡ä»¶")}),-1==o){var m=t.body;m.empty();var p={isRoot:!0,createChild:!0,renderTo:m.dom,items:u,onDestroy:function(){}};t.root=new $.Tree(p),t.cloudinit()}else t.getTree(n).ui.update({createChild:!0,items:u})},renderUpdate:function(e){var t=this,i=t.root.getCheckedValue(),a=i.length,n=!1;if(e.footer){var o="";if(a>0){o=s.t("å·²é€‰");var c=0,l=0,d=0;$.Array.each(i,(function(e,i){var a=t.file[i];a.expiredTime?c++:(l++,d+=a.doc.size)})),c&&(o+=c+s.t("ä¸ªè¶…å¤§é™„ä»¶")),l&&(c&&(o+=","),o+=l+s.t("ä¸ªæ–‡ä»¶ä¸­å¿ƒæ–‡ä»¶"));var u=s.t("å…±")+$.Number.convert(d),m=t.attach,p=1024*(0,r.$S)("attachSize")*1024,f=m.fileSize({state:"success"});d>p-f&&(n=!0,u=s.t("æ–‡ä»¶ä¸­å¿ƒæ–‡ä»¶æ€»å¤§å°ä¸èƒ½è¶…")+$.Number.convert(p)),n&&(o+=u=',<strong class="nui-txt-impt">'+u+"</strong>")}t.setFooter(o)}if(e.button){var h=s.t("ç¡® å®š"),g=!1;g=!(a>0),n&&(g=!0),t.setButton(h,g)}},check:function(){var e=this,t=e.root.getCheckedValue();if(t&&t.length>0){var i=e.attach,a=0;$.Array.each(t,(function(t,i){var n=e.file[i];a+=n.doc.size}));var n=!1,o="",c=1024*(0,r.$S)("attachSize")*1024,l=c-i.fileSize({state:"success"});if(a>l&&(n=!0,o=s.t("æœ¬æ¬¡é€‰æ‹©çš„é™„ä»¶å¤§å°ä¸èƒ½è¶…è¿‡")+$.Number.convert(l),c==l&&(o=s.t("æ‚¨é€‰æ‹©çš„é™„ä»¶æ€»é¢ä¸èƒ½è¶…è¿‡")+$.Number.convert(c))),n)return o='<strong class="nui-txt-impt">'+o+"</strong>",void e.setFooter(o);e.getToken(t)}e.msg.close()},submit:function(){for(var e=this,t=e.root.getCheckedValue(),i=[],a=[],n=t.length,o=0;o<n;o++){var r=t[o],s=e.file[r];s.expiredTime?a.push(s):i.push(r)}a.length&&e.cloudsubmit(a),i.length&&e.getToken(i)},getToken:function(e){var t=this,i=e.join("&id=");t.request({op:"getDownloadCertSet",param:{id:i},callback:function(e){var i=(e=e||{}).code,a=e.result;if(200==i){var n=a.cert;t.submitCompose(n)}else{var o=s.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");o=u.error[i]||o,$.Msgbox.show({content:o})}}})},submitCompose:function(e){var t=this,i=t.attach,a=[];$.Array.each(e,(function(e,i){var n=t.file[i.id],o=n.fileName,s={type:"url",mode:"copy_opt",name:u.downloadUrl+encodeURIComponent(o)+"?op=downloadFile&nf_fileId="+n.id+"&uid="+(0,r.$S)("orgUid")+"&file="+i.token.docURL,displayName:o,size:n.doc.size};a.push(s)})),i.netfolderAdd(a)},setFooter:function(e){this.parent.setFooter(e)},setButton:function(e,t){this.parent.setButton(e,t)},setTree:function(e,t,i){this.tree[e]={data:t,ui:i}},getTree:function(e){return this.tree[e]},request:function(e){var t=$.String.uriAddParam(u.requestUrl,"sid="+(0,r.$S)("sid"))+"&uid="+(0,r.$S)("orgUid");t+="&op="+e.op,e.param&&c.each(e.param,(function(e,i){var a="&"+[e,i].join("=");t+=a})),$.Ajax.jsonp(t,e.callback)}}),c.extend(u,{requestUrl:d.getUrl("compose_netfolder",!0),downloadUrl:d.getUrl("compose_netfolder_download",!0),error:{400:s.t("å‚æ•°é”™è¯¯"),403:s.t("éªŒè¯å¤±è´¥"),500:s.t("æœåŠ¡å™¨é”™è¯¯"),553:s.t("ç”¨æˆ·ä¸å­˜åœ¨")}}),c.extend(u.prototype,{timer:null,user:null,cloudinit:function(e){var t=this;t.cloud={mode:"none",status:"load",cross:{id:1},user:null,list:{init:!1,checkAll:null,checkList:null,files:{}},check:{all:null,list:[]}};var i=t.cloud.list;i.add=$.Function.bind(u.cloudfileAdd,i),i.get=$.Function.bind(u.cloudfileGet,i),t.cloudcheckUser()},cloudcheckUser:function(e){var t=this;if((0,r.$S)("isFree")){var i=l.get({field:"ntes_contact",flag:"hasBigAttach"});if("1"!=i)return"2"==i?void u.cloudrequest({url:"http://e.mail."+(0,r.$S)("domain")+"/mobilemail/fsActive.jsp",callback:function(i){var a=i.code;1==a?(l.set({field:"ntes_contact",flag:"hasBigAttach",value:"1"}),t.cloudcheckUser(e)):-2==a?t.cloudsetInfo(s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·é‡æ–°ç™»å½•å†è¯•ï¼")):t.cloudsetInfo(s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼"))}}):void u.cloudrequest({op:"fs_s_g_a",callback:function(i,a){if(200==i)a&&a.account&&(l.set({field:"ntes_contact",flag:"hasBigAttach",value:"1"}),t.cloudsetUser(a),t.cloudcheckUser(e));else{var n="";402==i?(l.set({field:"ntes_contact",flag:"hasBigAttach",value:"2"}),t.cloudcheckUser(e)):n=401==i?s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·é‡æ–°ç™»å½•å†è¯•ï¼"):s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼"),n&&t.cloudsetInfo(n)}}})}t.cloud.user||t.cloudloadData()},cloudloadData:function(){var e=this;u.cloudrequest({op:"fs_s_g_a",callback:function(t,i){if(200==t){if(!i||!i.account)return;e.cloudsetUser(i)}else{var a="";if(401==t)a=s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·é‡æ–°ç™»å½•å†è¯•ï¼");else{if(402==t)return;a=501==t?i&&i.info?i.info:s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç»´æŠ¤ï¼Œè¯·ç¨åå†è¯•ï¼"):s.t("è¶…å¤§é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼")}e.cloudsetInfo(a)}}})},cloudsetUser:function(e){var t=this;-1===e.displayUrl.indexOf("http")&&-1===e.displayUrl.indexOf("//")&&(e.displayUrl="http://"+e.displayUrl),-1===e.previewUrl.indexOf("http")&&-1===e.previewUrl.inLimit=3,t.cloud.user=e;var i=e.unexpiredCompleteCount,a=e.duration,n=s.t("è¶…å¤§é™„ä»¶ ")+'<span class="nui-txt-tips">('+i+s.t("ä¸ªæ–‡ä»¶ï¼Œä¿å­˜æœŸé™ä¸º")+a+s.t("å¤.find("tree")[0].update({noEncode:!0,text:n}),(0,r.$S)("isCorp")||new $.Link({text:s.t("æ·»åŠ æ–°æ–‡ä»¶"),cls:"nui-txt-link",renderTo:t.root.find("tree")[0].el.find(".nui-txt-tips").dom,click:function(){t.cloudaddFile()}})}catch(e){}},cloudrenderMain:function(){var e=this;e.cloud.user?(e.cloudinitList(),e.cloud.status="list"):e.cloudloadData()},cloudinitList:function(){var e=this,t={d:"0",g:"1",cl_cloud:"1"};e.cloud.user.updateTime>0&&(t.t=e.cloud.user.updateTime),e.cloud.list.init||(t.r="1",u.cloudrequest({op:"fs_afs_g_a",param:t,callback:function(t,i){if(200==t&&i.returnList){i.userState&&i.userState.updateTime&&(e.cloud.user.updateTime=i.userState.updateTime),e.cloud.list.init=!0,e.cloud.list.files={};var a=i.fileInfos.length,n=0,o=0;$.Array.each(i.fileInfos,(function(t,i){i.completed||o++,n+=i.size,e.cloud.list.add(String(i.id),i)})),e.cloud.user.spaceUsed=n,e.cloud.user.unexpiredCompleteCount=a-o,e.cloud.user.unexpiredIncompleteCount=o,e.cloudrenderList()}}}))},cloudrenderList:0).valueOf(),i=e.cloud.list.get({completed:!0}),n=[];i&&$.Array.each(i,(function(i,o){o.id;var r=u.cloudgetExpire(o.expiredTime,t),c=o.fileName,l=$.String.encodeHTML(c)+" <span class='nui-txt-tips'>"+s.t("(è¿‡æœŸæ—¶é—´")+r+")</span>";if(o.completed){var d=a.Z.getSubtype({type:"file",name:c});n.push({xtype:"tree",extcls:"nui-normalTree",noEncode:!0,text:l,isFold:!0,icons:[{xtype:"icon",type:"f.id,listeners:{click:function(){e.renderUpdate({footer:!0,button:!0})}}}),e.file[o.id]=o}})),0===n.length&&n.push({xtype:"tree",extcls:"nui-normalTree",text:s.t("æ— æ–‡ä»¶")}),e.getTree("-2").ui.update({createChild:!0,items:t:s.t("æ·»åŠ æ–°æ–‡ä»¶"),cls:"nui-txt-link",renderTo:e.root.find("tree")[0].el.find(".nui-txt-tips").dom,click:function(){e.cloudaddFile()}})},cloudsubmit:function(e){var t=this;if("load"==t.cloud.status);else{t.list;var i=t.attach,a=[];$.Array.each(e,(function(e,i){var n={type:"bigattach",mid:"cloud",url:t.cloud.user.displayUrl+i.url,name:i.fileName,id:i.id,size:i.size,cloud:!0,time:i.expiredTime};i.preview&&(n.preview=t.cloud.user.previewUrl+i.url),a.push(n)})),i.linkAdd(a)}},cloudsetInfo:function(e){var t='<span class="nui-txt-impt">'+e+"</span>";try{this.root.find("tree")[0].update({noEncode:!0,text:t})}catch(e){}},cloudaddFilswitch(t.data.get({status:"uploadMode"})){case"plugin":t.cloudTrigger(!0),t.sourceGet("element").link.dom.click();break;case"native":t.cloudTrigger(!0),t.nativeClick();break;case"flash":case"post":u.cloudmanage()}e.close()}}),c.extend(u,{cross:{id:1},cloudmanage:function(){Promise.resolve().then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry("bj_center")})))},cloudgetExpire:function(e,t){var i="";if((t=e-(t=t||o.Z.getTime(0).valueOf()))>=0){t=Math.floor(t/36e5);var a=Math.floor(t/24),("å°æ—¶")}return i},cloudrequest:function(e){var t=u.cross,i=(0,r.$N)("product.attach.FileAttach")+".cloudresponse",a=e.url||n.default.getUrl();if(a=$.String.uriAddParam(a,"sid="+(0,r.$S)("sid"))+"&uid="+(0,r.$S)("orgUid"),e.url)t[0]=e.callback,a=a+"&callback="+i;else{a+="&op="+e.op,a+="&p="+n.default.getProduct(),e.param&&c.each(e.param,(function(e,t){var i="&"+[e,t].join("=");a+=i}));var o=t.id++;t[o]=e.callback,a+="&ex="+o,a+="&ev="+i}a+="&ts="+(new Date).valueOf(),$.Ajax.request({url:a,requestType:$.Ajax.SCRIPT})},cloudresponse:function(e,t,i){var a=this.cross,n=a[i=i||0];n&&(1!=i&&delete a[i],"function"==typeof n&&n.apply(this,arguments))},cloudfileGet:function(e){e=e||{};var t=this.files;if(e.key)return t[e.key];var i=[];return c.each(t,(function(t,a){var n=!0;c.each(e,(function(e,t){a[e]!=t&&(n=!1)})),n&&i.push(a)})),i},cloudfileAdd:function(e,t){this.files[e]=t}}),t.default=u},14024:function(e,t,i){i.r(t),i(803),i(37092),i(92274),i(55737),i(48868),i(63045),i(81874),i(54861);var a=i(5165),n=i(39579),o=i(72957),r=new o.c1("product.attach.InternalAttach"),s=$.Object,c=$.createClass((0,o.$N)("product.attach.InternalAttach"));s.extend(c.prototype,{init:function(e){var t=this;s.extend(t,{parent:e.parent,attach:e.attach,body:e.body,list:{init:!1,checkAll:null,checkList:null,files:{},count:0},check:{all:null,list:[]}});var i=t.list;i.add=$.Function.bind(c.fileAdd,i),i.get=$.Function.bind(c.fileGet,i),t.renderMain()},renderMain:function(){var e=this,t=e.body,i=new $.Checkbox({title:r.t("å…¨é€‰"),checkedchange:function(t){e.selectAll(this.getChecked())}});e.check.all=i;var a='<div class="nui-simpleTable nui-table bc0"><table><thead class="nui-table-head"><tr class="nui-table-row"><th class="nui-table-cell nui-table-cell-forChk nui-table-cell-isFirst">'+i.html()+'</th><th class="nui-table-cell s0">'+r.t("æ–‡ä»¶å")+'</th><th class="nui-table-cell C0">'+r.t("å¤§å°")+'</th></tr></thead></table></div><div class="bm0" style="overflow-y:scroll"><div id="divInernalAttachManageList" class="nui-simpleTable nui-table bn0"></div></div>';t.html(a),e.initList()},initList:function(){var e=this;e.request({call:function(t){e.list.init=!0;var i=t.var;e.list.files={},$.Array.each(i,(function(t,i){var a=i.id+i.partId;e.list.add(a,i)})),e.renderList()},error:function(){var t=r.t("é™„ä»¶ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");e.body.html(t)}})},renderList:function(){var e,t=this,i=[];$.Array.each(t.list.get(),(function(e,n){var o,r=n.id+n.partId,s=n.attn;if(s){var c=[$.String.encodeHTML(s),$.String.encodeHTML(s)],l=a.Z.getSubtype({type:"file",name:s}),d=new $.Icon({type:"file",subtype:l}),u=new $.Checkbox({checkedchange:function(e){var i=this.getEl().findParent("TR"),a=i.dom.getAttribute("fid"),n=t.list.get({key:a}),o=this.getChecked();o?i.addClass("nui-table-row-selected"):i.removeClass("nui-table-row-selected"),t.selectItem(n,o)}});t.check.list.push(u),o='<tr fid="'+r+'" class="nui-table-row"><td class="nui-table-cell nui-table-cell-forChk nui-table-cell-isFirst">'+u.html()+'</td><td class="nui-table-cell P0">'+d.html()+'</td><td class="nui-table-cell t0" title="'+c[0]+'"> <nobr>'+c[1]+'</nobr></td><td class="nui-table-cell J0"></td><td class="nui-table-cell I0">'+$.Number.convert(n.attsize)+"</td></tr>",i.push(o)}})),i.length?(e='<table><tbody class="nui-table-body">'+i.join("")+"<tbody></table>",t.list.count=i.length):e='<div class="E0">'+r.t("æ‚¨è¿˜æ²¡æœ‰ä¸Šä¼ ä»»ä½•æ–‡ä»¶")+"</div>";var n=$("#divInernalAttachManageList");n.html(e),i.length&&n.find("TR").each((function(e,t){(t=$(t)).listen("mouseover",(function(){-1==t.dom.className.indexOf("nui-table-row-selected")&&t.addClass("nui-table-row-hover")})),t.listen("mouseout",(function(){t.removeClass("nui-table-row-hover")})),t.listen("click",(function(e){var i=$.Component.getItem(t.find("SPAN").dom),a=i.getChecked();i.setChecked(!a),$.Event.ents(),t.renderUpdate({footer:!0,select:!0,button:!0})},renderUpdate:function(e){var t=this,i=t.list.get({state:"select"}),a=i.length,n=!1;if(e.footer){var s="";if(a>0){s=r.t("å·²é€‰æ‹©")+a+r.t("ä¸ªæ–‡ä»¶ï¼Œ");var c=0;$.Array.each(i,(function(e,t){c+=t.attsize}));var l=r.t("å…±")+$.Number.convert(c),d=t.attach,u=1024*(0,o.$S)("attachSize")*1024,m=u-d.fileSize({state:"success"});c>m&&(n=!0,l=r.t("æœ¬æ¬¡é€‰æ‹©çš„é™„ä»¶å¤§å°ä¸èƒ½è¶…è¿‡")+$.Number.convert(m),u==m&&(l=r.t("æ‚¨é€‰æ‹©çš„é™„ä»¶æ€»é¢ä¸èƒ½è¶…è¿‡")+$.Number.convert(u))),n&&(l='<strong class="nui-txt-impt">'+l+"</strong>"),s+=l}t.setFooter(s)}if(e.select){var p=a==t.list.count,f=t.check.all;f.setChecked(p,!0),f.setDisabled(!1)}if(e.button){var h=r.t("ç¡® å®š"),g=!1;t.list.get({state:"select"}).length||(g=!0),n&&(g=!0),t.setButton(h,g)}},setFooter:function(e){this.parent.setFooter(e)},setButton:function(e,t){this.parent.setButton(e,t)},request:function(e){var t={func:"mbox:listAttachments",body:{order:"date",limit:50,desc:!0,skipLockedFolders:!0},call:e.call,error:e.error};(new n.Z).wmsvr(t)},submit:function(){var e=this.list,t=this.attach,i=[];$.Array.each(e.get({state:"select"}),(function(e,t){var a={type:"internal",_mid:t.id,_part:t.partId,name:t.attn,size:t.attsize};i.push(a)})),t.internalAdd(i)},selectAll:function(e){$.Array.each(this.check.list,(function(t,i){i.getChecked()!=e&&i.setChecked(e)}))},selectItem:function(e,t){var i=this;e.state=t?"select":"",i.timer&&clearTimeout(i.timer),i.timer=setTimeout((function(){i.timer=null,i.renderUpdate({select:!0,footer:!0,button:!0})}),1)}}),s.extend(c,{manage:function(){Promise.resolve().then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry("fj_center")})))},fileGet:function(e){e=e||{};var t=this.files;if(e.key)return t[e.key];var i=[];return s.each(t,(function(t,a){var n=!0;s.each(e,(function(e,t){a[e],a[e]!=t&&(n=!1)})),n&&i.push(a)})),i},fileAdd:function(e,t){this.files[e]=t}}),t.default=c},8957:function(e,t,i){i.r(t),i(68233),i(803),i(48868),i(92274),i(63045),i(81874),i(54861);var a=i(5165),n=i(72957),o=new n.c1("product.attach.NetfolderAttach"),r=$.Object,s=($.Ud,$.Uri),c=$.createClass((0,n.$N)("product.attach.NetfolderAttach"));r.extend(c.prototype,{init:function(e){var t=this;r.extend(t,{parent:e.parent,attach:e.attach,body:e.body,status:"load",root:null,tree:{},file:{}}),t.body.setClass("bm0"),t.body.css({paddingTop:"10px"}),t.body.html(o.t("æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...")),t.checkUser()},checkUser:function(){this.initList()},initList:function(e){var t=this,i=(e=e||{}).id||"-1";t.request({op:"getDirFiles",param:{recursive:0,orderBy:6,desc:1,dirId:i,cl_nf:1},callback:function(e){var i=(e=e||{}).code,a=e.result;if(200==i)t.renderList(a);else{var n=c.error[i]||o.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");t.body.html(n)}}})},renderList:function(e){var t=this,i=e.dir,n=i.id,r=i.parentId,s=i.files,c=i.subdirs,l=[];c&&$.Array.each(c,(function(e,i){l.push({xtype:"tree",extcls:"nui-normalTree",text:i.dirName,items:[],isFold:!0,hasChild:!0,icons:[{xtype:"icon",type:"file",subtype:"dir"}],listeners:{unfold:function(){var e=i.id;t.getTree(e)||(t.setTree(e,i,this),t.initList(i))}}})}));var d=[];s&&$.Array.each(s,(function(e,i){var n=a.Z.getSubtypee",extcls:"nui-normalTree",text:i.fileName,isFold:!0,icons:[{xtype:"icon",type:"file",subtype:n}],checkValue:i.id,listeners:{click:function(){t.renderUpdate({footer:!0,button:!0})}}}),t.file[i.id]=i}));var u=l.concat(d);if(0===u.length&&u.push({xtype:"tree",extcls:"nui-normalTree",text:o.t("æ— æ–‡ä»¶")}),-1==r){var m=t.body;m.empty();var p={isRoot:!0,createChild:!0,renderTo:m.dom,items:u,onDestroy:function(){}};t.root=new $.Tree(p)}else t.getTree(n).ui.update({createChild:!(e){var t=this,i=t.root.getCheckedValue(),a=i.length,r=!1;if(e.footer){var s="";if(a>0){s=o.t("å·²é€‰æ‹©")+a+o.t("ä¸ªæ–‡ä»¶ï¼Œ");var c=0;$.Array.each(i,(function(e,i){var a=t.file[i];c+=a.doc.size}));var l=o.t("å…±")+$.Number.convert(c),d=t.attach,u=1024*(0,n.$S)("attachSize")*1024,m=u-d.fileSize({state:"success"});c>m&&(r=!0,l=o.t("æœ¬æ¬¡é€‰æ‹©çš„é™„ä»¶å¤§å°ä¸èƒ½è¶…è¿‡")+$.Number.convert(m),u==m&&(l=o.t("æ‚¨é€‰æ‹©çš„é™„ä»¶æ€»é¢ä¸èƒ½è¶…è¿‡")+$.Number.convert(u))),r&&(l='<strong class="nui-txt-impt">'+l+"</strong>"),s+=l}t.setFooter(s)}if(e.button){var p=o.t("ç¡® å®š"),f=!1;f=!(a>0),r&&(f=!0),t.setButton(p,f)}},check:function(){var e=this,t=e.root.getCheckedValue();if(t&&t.length>0){var i=e.attach,a=0;$.Array.each(t,(function(t,i){var n=e.file[i];a+=n.doc.size}));var r=!1,s="",c=1024*(0,n.$S)("attachSize")*1024,l=c-i.fileSize({state:"success"});if(a>l&&(r=!0,s=o.t("æœ¬æ¬¡é€‰æ‹©çš„é™„ä»¶å¤§å°ä¸èƒ½è¶…è¿‡")+$.Number.convert(l),c==l&&(s=o.t("æ‚¨é€‰æ‹©çš„é™„ä»¶æ€»é¢ä¸èƒ½è¶…è¿‡")+$.Number.convert(c))),r)return s='<strong class="nui-txt-impt">'+s+"</strong>",void e.setFooter(s);e.getToken(t)}e.msg.close()},submit:function(){var e=this.root.getCheckedValue();this.getToken(e)},getToken:function(e){var t=this,i=e.join("&id=");t.request({op:"getDownloadCertSet",param:{id:i},callback:function(e){var i=(e=e||{}).code,a=e.result;if(200==i){var n=a.cert;t.submitCompose(n)}else{var r=o.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");r=c.error[i]||r,$.Msgbox.show({content:r})}}})},submitCompose:function(e){var t=this,i=t.attach,a=[];$.Array.each(e,(function(e,i){var o=t.fiRIComponent(r)+"?op=downloadFile&nf_fileId="+o.id+"&uid="+(0,n.$S)("orgUid")+"&file="+i.token.docURL,displayName:r,size:o.doc.size};a.push(s)})),i.netfolderAdd(a)},setFooter:function(e){this.parent.setFooter(e)},setButton:function(e,t){this.parent.setButton(e,t)},setTree:function(e,t,i){this.tree[e]={data:t,ui:i}},getTree:function(e){return this.tree[e]},request:function(e){var t=$.String.uriAddParam(c.requestUrl,"sid="+(0,n.$S)("sid"))+"&uid="+(0,n.$S)("orgUid");t+="&op="+e.op,e.param&&r.each(e.param,(function(e,i){var a="&"+[e,i].join("=");t+=a})),$.Ajax.jsonp(t,e.callback)}}),r.extend(c,{requestUrl:s.getUrl("compose_netfolder",!0),downloadUrl:s.getUrl("compose_netfolder_download",!0),error:{400:o.t("å‚æ•°é”™è¯¯"),403:o.t("éªŒè¯å¤±è´¥"),500:o.t("æœåŠ¡å™¨é”™è¯¯"),553:o.t("ç”¨æˆ·ä¸å­˜åœ¨")},manage:function(){Promise.resolve().then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry("nf_center")})))}}),t.default=c},31945:function(e,t,i){i.r(t),i(66403),i(68233),i(803),i(48868),i(92274),i(63045),i(81874),i(54861);var a=i(5165),n=i(72957),o=new n.c1("product.attach.OneDriverAttach"),r=$.Object,s=($.Ud,$.Uri,$.createClass((0,n.$N)("product.attach.OneDriverAttach")));r.extend(s.prototype,{init:function(e){var t=this;r.extend(t,{parent:e.parent,attach:e.attach,body:e.body,status:"load",root:null,tree:{},file:{}}),t.body.setClass("bm0"),t.body.css({paddingTop:"10px"}),t.body.html(o.t("æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...")),t.checkUser()},checkUser:function(){this.initList()},initList:function(e){var t=this,i=(e=e||{}).id||"root";t.request({op:"list",param:{folderId:i,cl_nf:1},callback:function(e){var a=(e=e||{}).code,n=e.data;if(200==a)t.renderList(n,i);else{var r=OneDirverAttach.error[a]||o.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");t.body.html(r)}}})},renderList:function(e,t){var i=this,n=[],r=[];$.Array.each(e,(function(e,t){"folder"==t.type?n.push(t):"file"==t.type&&r.push(t)}));var s=[];n&&$.Array.each(n,(function(e,t){s.push({xtype:"tree",extcls:"nui-normalTree",text:t.name,items:[],isFold:!0,hasChild:!0,icons:[{xtype:"icon",type:"file",subtype:"dir"}],listeners:{unfold:function(){var e=t.id;i.getTree(e)||(i.setTree(e,t,this),i.initList(t))}}})}));var c=[];r&&$.Array.each(r,(function(e,t){var n=a.Z.getSubtype({type:"file",name:t.name});c.push({xtype:"tree",extcls:"nui-normalTree",text:t.name,isFold:!0,icons:[{xtype:"icon",type:"file",subtype:n}],checkValue:t.id,listeners:{click:function(){i.renderUpdate({footer:!0,button:!0})}}}),i.file[t.id]=t}));var l=s.concat(c);if(0===l.length&&l.push({xtype:"tree",extcls:"nui-normalTree",text:o.t("æ— æ–‡ä»¶")}),"root"==t){var d=i.body;d.empty();var u={isRoot:!0,createChild:!0,renderTo:d.dom,items:l,onDestroy:function(){}};i.root=new $.Tree(u)}else i.getTree(t).ui.update({createChild:!0,items:l})},renderUpdate:function(e){var t=this,i=t.root.getCheckedValue(),a=i.length,r=!1;if(e.footer){var s="";if(a>0){s=o.t("å·²é€‰æ‹©")+a+o.t("ä¸ªæ–‡ä»¶ï¼Œ");var c=0;$.Array.each(i,(function(e,i){var a=t.file[i];c+=a.size}));var l=o.t("å…±")+$.Number.convert(c),d=t.attach,u=1024*(0,n.$S)("attachSize")*1024,m=u-d.fileSize({state:"success"});c>m&&(r=!0,l=o.t("æœ¬æ¬¡é€‰æ‹©çš„é™„ä»¶å¤§å°ä¸èƒ½è¶…è¿‡")+$.Number.convert(m),u==m&&(l=o.t("æ‚¨é€‰æ‹©çš„é™„ä»¶æ€»é¢ä¸èƒ½è¶…è¿‡")+$.Number.convert(u))),r&&(l='<strong class="nui-txt-impt">'+l+"</strong>"),s+=l}t.setFooter(s)}if(e.button){var p=o.t("ç¡® å®š"),f=!1;f=!(a>0),r&&(etCheckedValue();this.submitCompose(e)},submitCompose:function(e){var t=this,i=t.attach,a=[];$.Array.each(e,(function(e,i){var o=t.file[i],r=o.name,c={type:"url",mode:"copy_opt",name:s.downloadUrl+"?op=download&uid="+(0,n.$S)("orgUid")+"&fileId="+o.id,displayName:r,size:o.size};a.push(c)})),i.netfolderAdd(a)},setFooter:function(e){this.parent.setFooter(e)},setButton:function(e,t){this.parent.setButton(e,t)},setTree:function(e,t,i){this.tree[e]={data:t,ui:i}},getTree:function(e){return this.tree[e]},request:function(e){var t=$.String.uriAddParam(s.requestUrl,"sid="+(0,n.$S)("sid"))+"&uid="+(0,n.$S)("orgUid");t+="&op="+e.op,e.param&&r.each(e.param,(function(e,i){var a="&"+[e,i].join("=");t+=a})),$.Ajax.jsonp(t,e.callback)}}),r.extend(s,{requestUrl:"http://idp.qiye.163.com/qiye-onedrive/file",downloadUrl:"http://idp.hzqiye.internal/qiye-onedrive/internal",error:{400:o.t("å‚æ•°é”™è¯¯"),403:o.t("éªŒè¯å¤±è´¥"),500:o.t("æœåŠ¡å™¨é”™è¯¯"),553:o.t("ç”¨æˆ·ä¸å­˜åœ¨")},manage:function(){Promise.resolve().then(i.bind(i,64185)).then($.Function.bind((function(e){e.default.entry("nf_center")})))}}),t.default=s},83855:function(e,t,i){i.r(t),i(66403);var a=i(5165),n=i(39579),o=i(72957),r=new o.c1("product.attach.YNoteAttach"),s=$.Object,c=$.S_OK,l=$.Uri,d=$.createClass((0,o.$N)("product.attach.YNoteAttach"));s.extend(d.prototype,{init:function(e){var t=this;s.extend(t,{parent:e.parent,attach:e.attach,body:e.body,status:"load",root:null,tree:{},file:{}}),t.body.setClass("bm0"),t.body.css({paddingTop:"10px"}),t.body.html(r.t("æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...")),t.initNoteBooks()},initNoteBooks:function(){var e=this;e.request({body:{action:"listNoteBooks"},call:function(t){var i=t.code;if(i==c)e.renderNoteBooks(t.var);else{var a=d.error[i]||r.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");e.body.html(a)}}})},renderNoteBooks:function(e){var t=this,i=[];e&&$.Array.each(e,(function(e,a){i.push({xtype:"tree",extcls:"nui-normalTree",text:a.name,items:[],isFold:!0,hasChild:!0,icons:[{xtype:"icon",type:"file",subtype:"dir"}],listeners:{unfold:function(){var e=a.path;t.getTree(e)||(t.setTree(e,a,this),t.initResources(a))}}})}));var a=t.body;a.empty();var n={isRoot:!0,createChild:!0,renderTo:a.dom,items:i,onDestroy:function(){}};t.root=new $.Tree(n)},initResources:function(e){var t=this;e=e||{},t.request({body:{action:"listResources",path:e.path},call:function(e){var i=e.code;if(i==c)t.renderResources(e.var);else{var a=d.error[i]||r.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");t.body.html(a)}}})},renderResources:function(e){var t=this,i=[],n=e.notebook,o=e.resources;o&&$.Array.each(o,(function(e,n){var o=n.name;if(o){var r=n.url,s=a.Z.getSubtype({type:"file",name:o});i.push({xtype:"tree",extcls:"nui-normalTree",text:o,icons:[{xtype:"icon",type:"file",subtype:s}],checkValue:r,listeners:{click:function(){t.renderUpdate({footer:!0,button:!0})}}}),t.file[r]=n}})),0===i.length&&i.push({xtype:"tree",extcls:"nui-normalTree",text:r.t("æ— æ–‡ä»¶")}),t.getTree(n).ui.update({createChild:!0,items:i})},renderUpdate:function(e){var t=this,i=t.root.getCheckedValue(),a=i.length,n=!1;if(e.footer){var s="";if(a>0){s=r.t("å·²é€‰æ‹©")+a+r.t("ä¸ªæ–‡ä»¶ï¼Œ");var c=0;$.Array.each(i,(function(e,i){var a=t.file[i];c+=a.size}));var l=r.t("å…±")+$.Number.convert(c),d=t.attach,u=1024*(0,o.$S)("attachSize")*1024,m=u-d.fileSize({state:"success"});c>m&&(n=!0,l=r.t("æœ¬æ¬¡é€‰æ‹©çš„é™„ä»¶å¤§å°ä¸èƒ½è¶…è¿‡")+$.Numbeer.convert(u))),n&&(l='<strong class="nui-txt-impt">'+l+"</strong>"),s+=l}t.setFooter(s)}if(e.button){var p=r.t("ç¡® å®š"),f=!1;f=!(a>0),n&&(f=!0),t.setButton(p,f)}},submit:function(){var e=this,t=e.root.getCheckedValue(),i=[];$.Array.each(t,(function(t,a){var n=e.file[a];n.size,i.push(n)}));var a=e.attach,n=a.info.get({cid:!0});e.request({body:{action:"uploadAttach",composeId:n,items:i},call:function(t){var i=t.code;if(i==c||"S_PARTIAL_OK"==i)a.ynoteAdd(t.var);else{var n=d.error[i]||r.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼");e.body.html(n)}}})},setButton:function(e,t){this.parent.setButton(e,t)},setFooter:function(e){var t=this.parent;e||(e='<a href="'+l.getUrl("ynote",!0)+'" class="nui-txt-link nui-tˆæ˜¯æœ‰é“äº‘ç¬”è®°ï¼Ÿ")+"</a>"),t.setFooter(e)},setTree:function(e,t,i){this.tree[e]={data:t,ui:i}},getTree:function(e){return this.tree[e]},request:function(e){var t=new n.Z,i={func:"ntes:mbox:ynote",body:e.body,error:e.error,call:e.call};t.wmsvr(i)}}),s.extend(d,{error:{},manage:function(){window.open("http://note.youdao.com/")}}),t.default=d},15609:function(e,t,i){i.r(t),i(13484),i(19975),i(92274),i(65132),i(48868),i(81874),i(54861);var a=i(72957),n=i(62193),o=i(39579);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var s=new a.c1("product.AvMail"),c=$.createClass((0,a.$N)("product.AvMail")),l=$.Object,d=$.Uri,u=$.S_OK;l.extend(c.prototype,{init:function(e){var t=this;t.module=e;var i,n=t.getCallName((function(){return t.dispatch.apply(t,arguments)})),o="medialetter."+(0,a.$S)("fullDomain");(0,a.$S)("isCorp")&&(o="media"+$G.environment.uriFix+".qiye.163.com");var r="remote="+o+"&sid="+(0,a.$S)("sid")+"&uid="+(0,a.$S)("uid")+"&apiListener=window."+n;$G.isDebug&&(r="apiDebug=true&"+r);var c="composeAvMailSwf",l=d.getUrl("compose_avmail_swf",!0),u=$.Browser.getVersion()||[0,0];i=$.Browser.ie()&&u[0]<11?'<object id="'+c+'" style="display:block;" width="400" height="383" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"><param name="movie" value="'+l+'" /><param name="flashVars" value="'+r+'" /><param name="quality" value="high" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /></object>':'<embed id="'+c+'" style="display:block;" src="'+l+'" flashvars="'+r+'" quality="high" wmode="transparent" allowscriptaccess="always" width="400" height="383" type="application/x-shockwave-flash" />',t.msgbox=$.Msgbox.show({header:s.t("å½•åˆ¶éŸ³è§†é¢‘"),contentType:"custom",width:"400px",content:i,noFooter:!0})},submit:function(e){var t=this.module,i={url:e.fileUrl+"?sid="+(0,a.$S)("sid")+"&uid="+(0,a.$S)("uid")+"&time="+e.totalTime,name:e.fileName,mime_type:"video/x-flv"},n=t.info.get({cid:!0});this.request({body:{action:"getMedia",composeId:n,item:i},call:function(i){if(i.code==u){var a=i.var;if(a&&a.length){var n=[];$.Array.each(a,(function(e,t){t.code==u&&n.push(t.var)})),n&&n.length&&(n[0].totalTime=e.totalTime,n[0].mediaType=e.mediaType,n[0].media=!0,t.attach.avMailAdd(n))}}else alert(s.t("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼"))}}),this.msgbox.close()},dispatch:function(e){var t=this;switch(e.type){case"onReady":default:break;case"onStart":t.status=1;break;case"onComplete":t.status=2,t.submit(e);break;case"onError":t.status=3;break;case"onClose":t.status=4}},getCallName:function(e,t){var i="AvMailCall";"object"!=r(window[i])&&(window[i]={});var a="f"+n.Z.getTime(0).valueOf();return void 0!==window[i][a]&&(a+="x"),window[i][a]=function(){if(t&&delete window[i][a],e)return e.apply(null,arguments)},i+"."+a},request:function(e){var t=new(0,o.Z),i={func:"ntes:mbox:avmail",body:e.body,error:e.error,call:e.call};t.wmsvr(i)},preview:function(e,t){var i=$.Context.module.info.get({cid:!0}),n="https://"+(0,a.$S)("host")+"/js6/s?func=mbox:getComposeData&sid="+(0,a.$S)("sid")+"&mode=inline&composeId="+i+"&attachId="+e,o=this.getPlayHtml(n,t);$.Msgbox.show({header:s.t("é¢„è§ˆéŸ³è§†é¢‘"),contentType:"custom",width:"400px",content:o,noFooter:!0})},getPlayHtml:function(e,t,i){e=encodeURIComponent(e);var a=i||"composeSwfPreview";t=t||"video";var n=d.getUrl(t+"_swf",!0),o="fileUrl="+e,r={video:[400,383],audio:[77,28]}[t];return $.Browser.ie()?'<object id="'+a+'" style="display:block;" width="'+r[0]+'" height="'+r[1]+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"><param name="movie" value="'+n+'" /><param name="flashVars" value="'+o+'" /><param name="quality" value="high" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /></object>':'<embed id="'+a+'" style="display:block;" src="'+n+'" flashvars="'+o+'" quality="high" wmode="transparent" allowscriptaccess="always" width="'+r[0]+'" height="'+r[1]+'" type="application/x-shockwave-flash" />'},status:0}),t.default=c},64185:function(e,t,i){i.r(t),i(42295),i(17503),i(66403),i(37092),i(92274),i(79150);var a=new $I18N("product.FileCenter"),n=$.Object,o=$.AdvLock,r=$.Uri,s=$.createClass($N("product.FileCenter"));n.extend(s,{entry:function(e,t){try{var i=$L("interface.OutlinkInterface")}catch(e){return e}e=e||"file_center";var n=null,c=null,l=null,d=null,u=null,m="";t&&(n=t.search,c=t.contact,l=t.param,d=t.action,u=t.hash,m=t.hashPath);var p=$S("advLock"),f=!1,h=r.getUrl("file_center"),g=!1;switch(e){case"fj_center":case"qiye_fj":if(p&&!p.authenticated2&&!p.disabled&&p.folders){if(g=!0,d&&d.lock)return void o.show((function(){s.entry(e,n,c,l,d)}));if(n){if(-2==n.fid)s.fjCache=n,f=!0;else if(p[n.fid])return void o.show((function(){s.entry(e,n,c)}))}else h+="&skipLockedFolders=true"}d&&d.useCahce&&s.fjCache&&(n=s.fjCache),n||c||(h+="#list/attach");break;case"file_center":case"nf_center":case"qiye_grwp":if(p&&!p.authenticated2&&!p.disabled&&p.nf)return void o.show((function(){s.entry(e,t)}));break;case"bj_center":h+="#list/bg";break;case"go_hash_path":h+="#"+m}if(l)for(var v in l)h+="&"+v+"="+l[v];if(u&&(h+="#"+u),n)"nf_center"==e?n.key&&(n.keyword=n.key):"fj_center"==e&&(f&&(h+="&skipLockedFolders=true"),n.key&&(n.attn=n.key)),$S("isCorp")?"fj_center"==e?(h=r.getUrl("qiye_fj"),g&&(h+="&skipLockedFolders=true"),s.post(h,n,"qiye_fj",a.t("é™„ä»¶ç®¡ç†"))):s.post(r.getUrl("qiye_grwp_ss"),n,"qiye_grwp",a.t("ä¸ªäººæ–‡ä»¶ä¸­å¿ƒ")):(h+=u="nf_center"==e?"#search/nf":"#search/attach",s.post(h,n,"file_center",$.NF_NAME));else if(c){var b;!p||p.authenticated2||p.disabled||(h+="&skipLockedFolders=true"),c.fromEmail?(h+="&fromAddress="+(b=c.fromEmail).address,b.name&&(h+="&from="+encodeURIComponent(b.name))):c.toEmail&&(h+="&toAddress="+(b=c.toEmail).address,b.name&&(h+="&to="+encodeURIComponent(b.name))),h+="#search/related",i.goOutlink({key:"file_center",url:h,title:$.NF_NAME,group:"file_center",showDefTree:!0,fullScreen:!0})}else{var y=!0,x="file_center",k="file_center",S="";switch(e){case"mail_attach":k=x=e,y=!0,h+="#list/attach",$.Log.cache({cl_attach:"1"},$.EMPTYFUNC),S=a.t("é‚®ç®±é™„ä»¶");break;case"image_attach":k=x=e,y=!1,h+="#list/waterfall",$.Log.cache({cl_waterfall:"1"},$.EMPTYFUNC);break;case"qiye_qywp":h=r.getUrl(e,!0),k=x=e,y=!1,S="3"===$G.user.domainType?a.t("æ ¡å›­æ–‡ä»¶ä¸­å¿ƒ"):a.t("ä¼ä¸šæ–‡ä»¶ä¸­å¿ƒ");break;case"qiye_grwp":case"qiye_yfj":case"qiye_fj":case"qiye_office":h=r.getUrl(e),k=x=e,y=!1,g&&(h+="&skipLockedFolders=true")}i.goOutlink({key:x,url:h,group:k,showDefTree:!0,fullScreen:y,title:S})}},post:function(e,t,i,a){try{var n=$L("interface.OutlinkInterface")}catch(e){return e}n.goOutlink({key:i,url:"about:blank",title:a,group:i,call:function(i){var a=document.createElement("FORM");for(var n in a.action=e,a.method="POST",a.target=i.find("IFRAME").dom.id,t){var o=document.createElement("INPUT");o.type="hidden",o.name=n,o.value=$.String.trim(""+t[n]),a.appendChild(o)}document.body.appendChild(a),a.submit()},showDefTree:!0,fullScreen:!$S("isCorp")})}}),t.default=s},42724:function(e,t,i){i.r(t);var a=i(72957),n=$.Object,o=($.AdvLock,$.Uri,$.createClass((0,a.$N)("product.FileEdit")));n.extend(o,{isLoginO365:!1,loginO365:function(){this.isLoginO365||($.fly("#downloadFrame").dom.src="https://idp.qiye.163.com/fediz-idp/federation",this.isLoginO365=!0)}}),t.default=o},11198:function(e,t,i){i.r(t),i(42295),i(34994);var a=i(72957),n=new a.c1("product.Linkedin"),o=$.Object,r=$.Ajax,s=$.createClass((0,a.$N)("product.Linkedin"));o.extend(s,{getSign:function(e,t){var i=this;r.request({requestType:r.SCRIPT,rnd:!0,url:i._getActionUrl("get"),paddingParam:"callback",paddingFunc:function(a){200===a.code?e&&e(""===a.data?null:{name:n.t("LinkedIn ç­¾å"),isDefault:i.isSignDefault(),content:i._parseSignHTML(a.data)}):t(a.code)}})},bindAccount:function(e,t){r.request({requestType:r.SCRIPT,rnd:!0,url:this._getActionUrl("auth"),paddingParam:"callback",paddingFunc:function(i){var a=i.data.url;if(200===i.code&&a){var o=n.t("ç»‘å®šLinkedInç­¾å");$.Msgbox.show({header:o,title:n.t("æ­¤é‚®ç®±æ²¡æœ‰å…³è”LinkedIn"),content:n.t("åªæœ‰å…³è”äº†LinkedInçš„ç½‘æ˜“é‚®ç®±è´¦å·æ‰èƒ½ç»‘å®šLinkedInç­¾åã€‚"),okText:n.t("é©¬ä¸Šç»‘å®š"),cancelText:n.t("å–æ¶ˆ"),ok:function(){window.open(a,"linkedinAuth"),$.Msgbox.show({header:o,title:n.t("è¯·åœ¨æ–°çª—å£ä¸­å®ŒæˆLinkedInæˆæƒ"),content:n.t("æ–°å¼€çª—å£å®Œæˆæˆæƒåï¼Œç‚¹å‡»æ–¹æŒ‰é’®å³å¯ç»‘å®šLinkedInç­¾å"),okText:n.t("æˆ‘å·²å®Œæˆæˆæƒ"),cancelText:n.t("å–æ¶ˆ"),ok:e})}})}else t&&t(n.t("è·å–æˆæƒURLå¤±è´¥"))}})},unbindAccount:function(e,t){r.request({requestType:r.SCRIPT,rnd:!0,url:this._getActionUrl("unbind"),paddingParam:"callback",paddingFunc:function(i){200===i.code?e&&e():t&&t(n.t("æŠ±æ­‰ï¼Œè§£ç»‘å¤±è´¥"))}})},isSignDefault:function(){return"1"===$.Ud.get({field:"ntes_compose",flag:"linkedin"})},setSignDefault:function(e,t,i){$.Ud.set({field:"ntes_compose",flag:"linkedin",value:e?"1":"0",call:function(){t&&t()}})},_getActionUrl:function(e){return $.Uri.getUrl("linkedin",!0).replace("{action}",e)},_parseSignHTML:function(e){return e?'<div style="display:-moz-box; display:-webkit-box; display:-o-box; display:box; display: -ms-flexbox;-moz-box-orient:horizontal; -webkit-box-orient:horizontal; -o-box-orient:horizontal; box-orient:horizontal;">'+(e.pictureUrl?'<div style="width:59px;height:59px"><a href="'+window.encodeURI(e.publicProfileUrl)+'" target="NtesLinkedinWindow" style="display:block;height:59px"><img src="'+window.encodeURI(e.pictureUrl)+'" style="width:59px !important;height:59px !important;border:#cccccc solid 1px;"></a></div>':"")+'<div style="width:12px"></div><div style="-moz-box-flex:1;-webkit-box-flex: 1; -ms-flex: 1; box-flex: 1;"><div style="font-size:14px;margin-top: -3;">'+$.String.escapeHTML(e.formattedName)+'</div><div style="font-size:11px; color:#b0b0b0;">'+$.String.escapeHTML(e.headline||e.position&&e.position.companyName||"")+'</div><div style="font-size:11px; color:#b0b0b0;">'+$.String.escapeHTML(e.emailAddress)+'</div><div style="font-size:11px; color:#b0b0b0;">'+$.String.escapeHTML((t="",e.phoneNumbers&&$.Array.each(e.phoneNumbers,(function(e,i){return t=i.phoneNumber,$.BREAK})),t))+'</div><div style="font-size:11px; color:#b0b0b0;"><a href="'+window.encodeURI(e.publicProfileUrl)+'" target="NtesLinkedinWindow">'+n.t("æˆ‘çš„LinkedIn")+"</a></div></div></div>":"";var t}}),t.default=s},35537:function(e,t,i){i(66251);var a=i(72957);function n(e){this.result=e}i(39579),n.prototype={isSuccess:function(){return 200===this.result.code},isExpire:function(){return 315===this.result.code}};var o=new a.c1("product.MailProtection"),r=$.createClass($N("product.MailProtection")),s={expireTimeConfig:0,availableChange$:new $.Misc.Subject,infoChange$:new $.Misc.Subject,initialize:function(){var e=this;e.availableChange$.subscribe((function(t){e.getInfo((function(t){e.infoChange$.next(t)}))}))},log:function(e,t){if(e){var i={};i[e]=t||1,$.Log.cache(i)}},getExpireConfig:function(e){var t=this;$.Ud.getProxy({field:["webmail.js.mailProtectionExpireConfig"],call:function(i){var a=i["webmail.js.mailProtectionExpireConfig"];a&&(t.expireTimeConfig=a,e&&e(a))}})},updateExpireConfig:function(e){e&&this.expireTimeConfig!==e&&$.Ud.setProxy({field:"webmail.js.mailProtectionExpireConfig",value:e,call:function(e){}})},getInfo:function(e){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,body:{},rnd:!0,url:"/fgw/secmail/encrypt/user_quota?uid="+$S("uid")+"&copywriting=2",head:[{name:"Content-type",value:"application/json"}],call:function(t){try{var i=JSON.parse(t.responseText);new n(i).isSuccess()&&e&&e(i.result)}catch(e){}}})},experience:function(e,t){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:{},rnd:!0,url:"/fgw/secmail/encrypt/experience?uid="+$S("uid"),head:[{name:"Content-type",value:"application/json"}],call:function(i){try{var a=JSON.parse(i.responseText);200===a.code?e&&e(a.result):t&&t(a&&a.code?a.code:-1)}catch(e){}}})},createEncryptConfig:function(e,t,i){var a=this;e.expiresAt=$.Misc.getTime().getTime()+e.expiresAt,$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:e,rnd:!0,url:"/fgw/secmail/encrypt/create_encrypt?uid="+$S("uid"),head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var o=JSON.parse(e.responseText),r=new n(o);r.isSuccess()?t&&t(o.result):r.isExpire()?(a.availableChange$.next(!1),i&&i(o)):i&&i(o)}catch(e){i&&i(o)}}})},updateEncryptConfig:function(e,t,i){var a=this,o={encryptId:e.encryptId,tid:e.tid,mid:e.mid};$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:o,rnd:!0,url:"/fgw/secmail/encrypt/settings?uid="+$S("uid"),head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var o=JSON.parse(e.responseText),r=new n(o);r.isSuccess()?t&&t():r.isExpire()?(a.availableChange$.next(!1),i&&i({code:o?o.code:-1})):i&&i({code:o?o.code:-1})}catch(e){i&&i(e)}}})},guideDialogCreator:function(e){var t=this,i=(t.module,'<div style="width:392px;height:306px;margin-top:16px;border:1px solid #E3E5EC;border-radius:4px;overflow:hidden;"><img style="width:392px;" src="'+e.img+'"/></div>'),a=[];e.cancelText&&a.push({text:o.t(e.cancelText||"æš‚ä¸ä½“éªŒ"),click:function(){t.log(e.statsKey+"_NoNeed"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),e.cancel&&e.cancel()}}),e.okText&&a.push({text:o.t(e.okText||"ç«‹å³ä½“éªŒ"),subclass:"mainBtn",click:function(){t.log(e.statsKey+"_OK"),$.Msgbox.msgbox&&$.Msgbox.msgbox.close(),e.ok&&e.ok()}}),$.Msgbox.show({extcls:"Sky-gCmp-mailtrace-guide-dialog",noHeader:!0,statsKey:e.statsKey,contentType:"normal",statsValue:{},title:'<div  style="color:#000000;">'+o.t(e.title)+"</div>",content:'<div class="Sky-gCmp-mailtrace-guide-dialog-content" style="color:#585E6D;" >'+o.t(e.content)+"<p/>"+i,buttons:a})},newbeeGuide:function(e){var t={statsKey:e.statsKey,title:o.t("æ–°åŠŸèƒ½ä½“éªŒï¼šæœºå¯†æ¨¡å¼"),content:o.t("å…¨æ–°å‡çº§æœºå¯†é‚®ä»¶åŠŸèƒ½ï¼Œè®©æ”¶ä»¶äººåœ¨åŠ å¯†ç¯å¢ƒä¸­è¿›è¡Œé‚®ä»¶é˜…è¯»ã€‚åœ¨æ­¤åŸºç¡€ä¸Šæä¾›é˜…åå³ç„šã€ç¦æ­¢è½¬å‘ã€é‚®ä»¶æ°´å°ç­‰èƒ½åŠ›ï¼Œè®©æ•æ„Ÿé‚®ä»¶å†…å®¹ä¸å†è½»æ˜“æ³„éœ²ã€‚"),img:"https://mail-activity.nos-jd.163yun.com/5b14acd56e2e98f17d819a02226eb672.gif",okText:o.t("ç«‹å³ä½“éªŒ"),cancelText:o.t("æš‚ä¸ä½“éªŒ"),ok:function(){e.ok&&e.ok()},cancel:function(){e.cancel&&e.cancel()}};this.guideDialogCreator($.Object.extend(t,e))}};$.Object.extend(r,s),t.Z=r},96540:function(e,t,i){i.r(t),i(48868),i(92274),i(63045),i(81874),i(54861),i(42295),i(52963),i(66403),i(34994),i(68233),i(66251),i(803),i(98457),i(15296);var a=i(72957),n=i(39579),o=new a.c1("product.MailTracking"),r=$.createClass((0,a.$N)("product.MailTracking")),s={popup:null,subscribeQueue:[],readRemind:function(e){var t=this,a=e.mid,r=e.readStatus,s=e.dlStatus,c=e.type,l={type:c||"read",readStatus:r||"",dlStatus:s||""},d=function(){Promise.resolve().then(i.bind(i,88829)).then($.Function.bind((function(e){e.default.entry({mid:a})}))),$.Log.cache({push_mailTracking_mail_click:l})},u=function(){t.postTrackSettingWebpush({enable:!1,type:"attach"===c?"attach":"mail",moment:"unread"===r||"not_downloadeded"===s?"unread":"read"},(function(){$.Listener.fire("mailTracking:settingSync"),$.Tips.show({succ:!0,text:o.t("å…³é—­æˆåŠŸ")})})),$.Log.cache({push_mailTracking_mail_cancel:l})},m={};if(m[a]=!0,$.Listener.fire("letter:update",{list:m,action:"tracking",data:[{mid:a,readStatus:r}]}),c){var p=e.subject,f=e.readStatus,h=e.reader,g=e.fileName,v=e.downloader,b=e.dlStatus,y="read"===c,x=y?o.t("é‚®ä»¶å·²è¯»æé†’"):o.t("é™„ä»¶ä¸‹è½½æé†’"),k="";if("important_mail"===c)return void t.imRemind(e);if(y){if("unread"===f&&(k=o.t("ä½ å‘é€çš„é‚®ä»¶ ")+"[<b>"+p+"</b>]"+o.t(" å·²è¶…è¿‡ 72 å°æ—¶æœªè¢«é˜…è¯»ã€‚")),"read"===f){var S=h;try{var w=$.Uri.getEmails(h),T=w.match[0].address;S=w.match[0].name||T}catch(e){}k=o.t("ä½ å‘é€çš„é‚®ä»¶ ")+"<b>["+p+"]</b>"+o.t(" å·²è¢« {name} é˜…è¯»ã€‚").replace("{name}","<b>"+S+"</b>")}"all_read"===f&&(k=o.t("ä½ å‘é€çš„é‚®ä»¶ ")+"<b>["+p+"]</b>"+o.t(" å·²è¢«æ‰€æœ‰æ”¶ä»¶äººé˜…è¯»ã€‚"))}else{if("not_downloaded"===b&&(k=o.t("ä½ å‘é€çš„é™„ä»¶ ")+"<b>"+g+"</b>"+o.t(" å·²è¶…è¿‡ 72 å°æ—¶æœªè¢«ä¸‹è½½ã€‚")),"downloaded"===b){S=v;try{var C=$.Uri.getEmails(v),_=C.match[0].address;S=C.match[0].name||_}catch(e){}k=o.t("ä½ å‘é€çš„é™„ä»¶ ")+"<b>"+g+"</b>"+o.t(" å·²è¢« {name} ä¸‹è½½ã€‚").replace("{name}","<b>"+S+"</b>")}"all_downloaded"===b&&(k=o.t("ä½ å‘é€çš„é™„ä»¶ ")+"<b>"+g+"</b>"+o.t(" å·²è¢«æ‰€æœ‰äººä¸‹è½½ã€‚"))}t.showReadRemind({title:x,content:k,callback:d,cancel:u,logData:l})}else(new(0,n.Z)).wmsvr({func:"mbox:readMessage",body:{id:a},call:function(e){if(e.code===$.S_OK){var i=e.var,a=[].concat(i.to||[],i.cc||[],i.bcc||[]);if(1===a.length){var n=$.Uri.getEmails(a[0]);if(!n||!n.match||!n.match[0])return;var r=n.match[0].address,s=n.match[0].name;if(r===$S("uid")||r===$S("orgUid"))return;l.readStatus="all_read",t.showReadRemind({content:o.t("æ‚¨çš„é‚®ä»¶è¢« ")+(s||r)+o.t(" é˜…è¯»ã€‚"),callback:d,cancel:u,logData:l})}else t.showReadRemind({content:o.t("æ‚¨çš„é‚®ä»¶è¢«éƒ¨åˆ†æ”¶ä»¶äººé˜…è¯»ã€‚"),callback:d,cancel:u,logData:l})}},hideWait:!0})},showReadRemind:function(e){var t=e.title,i=e.content,a=e.callback,n=e.cancel,r=e.logData;this.popup=$.Popup.show({title:t||o.t("é‚®ä»¶å·²è¯»æé†’"),content:'<div style="max-width: 300px;">'+(i||"")+"</div>",ok:function(){a&&a()},okText:o.t("æŸ¥çœ‹è¯¦æƒ…"),pauseTime:1e4,cancel:function(){n&&n()},cancelText:o.t("ä¸å†æé†’")}),$.Log.cache({push_mailTracking_msg_show:r})},imRemind:function(e){var t=e.mid,a=e.inner_type,n=e.subject,r=e.sender,s=e.scene,c=e.delay,l="ä¸»é¢˜ï¼š"+(n.length>30?n.substr(0,30)+"...":n),d="",u={remindType:a+"_"+s};if("send"===a)switch(s){case"failed":d='æ‚¨æœ‰ä¸€å°é‡è¦é‚®ä»¶å‡ºç°å‘ä¿¡å¼‚å¸¸<span style="color:#FC1E1E;">ï¼ˆå‘ä¿¡å¤±è´¥ï¼‰</span>';break;case"read":d="æ‚¨æœ‰ä¸€å°é‡è¦é‚®ä»¶è¢«éƒ¨åˆ†æ”¶ä»¶äººé˜…è¯»ã€‚";break;case"all_read":d="æ‚¨æœ‰ä¸€å°é‡è¦é‚®ä»¶è¢«å…¨éƒ¨æ”¶ä»¶äººé˜…è¯»ã€‚";break;case"unread":d="æ‚¨æœ‰ä¸€å°é‡è¦é‚®ä»¶è¶…è¿‡"+c+"å°æ—¶æœªé˜…è¯»ã€‚"}else switch(s){case"failed":d="æ‚¨æœ‰ä¸€å°æ¥è‡ª"+r+'çš„é‡è¦é‚®ä»¶å‡ºç°æ”¶ä¿¡å¼‚å¸¸<span style="color:#FC1E1E;">ï¼ˆæ”¶ä¿¡å¤±è´¥ï¼‰</span>';break;case"receive":d="æ‚¨æ”¶åˆ°äº†ä¸€å°æ¥è‡ª"+r+"çš„é‡è¦é‚®ä»¶ã€‚";break;case"unread":d="æ‚¨æœ‰ä¸€å°æ¥è‡ª"+r+"çš„é‡è¦é‚®ä»¶è¶…è¿‡"+c+"å°æ—¶æœªè¯»ã€‚"}$.Popup.show({title:o.t("é‡è¦é‚®ä»¶æé†’"),content:'<div style="max-width: 300px;"><div style="color:#666;">'+l+'</div><div style="color:#21293A;">'+d+"</div></div>",ok:function(){t?Promise.resolve().then(i.bind(i,88829)).then($.Function.bind((function(e){e.default.entry({mid:t})}))):Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"trackSetting",group:"track-setting",fullScreen:!0,title:o.t("é‚®ä»¶è¿½è¸ªè®¾ç½®")})}))),$.Log.cache({push_imMailTracking_mail_click:u})},okText:o.t("æŸ¥çœ‹è¯¦æƒ…"),pauseTime:1e8,cancel:function(){$.Log.cache({push_imMailTracking_mail_cancel:u})},cancelText:o.t("æˆ‘çŸ¥é“äº†")}),$.Log.cache({push_imMailTracking_msg_show:u})},trial:function(e){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:{},rnd:!0,url:$.Uri.getUrl("mailTrackingTrial",!0),head:[{name:"Content-type",value:"application/json"}],call:function(t){try{var i=JSON.parse(t.responseText);oInfo=i.result||{},200===i.code?($.Listener.fire("mailTracking:trialEnabled"),e&&e(oInfo.balance)):e&&e(0)}catch(t){e&&e(0)}}})},getSettings:function(e){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,body:{},rnd:!0,url:$.Uri.getUrl("mailTrackingSettings",!0),head:[{name:"Content-type",value:"application/json"}],call:function(t){try{var i=JSON.parse(t.responseText);oInfo=i.result||{},200===i.code&&e&&e(i.result)}catch(e){}}})},syncSettings:function(e,t){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,body:e,rnd:!0,url:$.Uri.getUrl("mailTrackingSettings",!0),head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var i=JSON.parse(e.responseText);oInfo=i.result||{},200===i.code&&t&&t(i.result)}catch(e){}}})},getWmsvrList:function(e){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,body:{},rnd:!0,url:$.Uri.getUrl("mailTrackingWmsvr",!0),head:[{name:"Content-type",value:"application/json"}],call:function(t){try{var i=JSON.parse(t.responseText);oInfo=i.result||{},200===i.code&&e&&e(i.result)}catch(e){}}})},getTraceInfoBrief:function(e,t,i){try{$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:$.Uri.getUrl("mailTrackingInfoBrief",!0)+"?mid="+encodeURIComponent(e.mid),head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var a=JSON.parse(e.responseText);oInfo=a.result||{},200===a.code&&t&&t(a.result)}catch(e){i&&i()}}})}catch(e){i&&i()}},postTrackSettingWebpush:function(e,t){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,rnd:!0,url:$.Uri.getUrl("mailTrackingSettingWebpush",!0),body:e,head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var i=JSON.parse(e.responseText);oInfo=i.result||{},200===i.code&&t&&t(i.result)}catch(e){}}})},getTraceSendStatusDetail:function(e,t){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:$.Uri.getUrl("mailTrackingSendStatusDetail",!0)+"?mid="+encodeURIComponent(e.mid)+"&receivers="+encodeURIComponent(e.receivers.join(",")),head:[{name:"Content-type",value:"application/json"}],call:function(e){try{var i=JSON.parse(e.responseText);t&&t(i)}catch(e){}}})},showTraceInfo:function(e){e.onLog=function(e,t){var i={};"string"==typeof e&&(i[e]=t||1,$.Log.cache(i))},window.MailTrackDetail?window.MailTrackDetail.show(e):($.Support.loadStyleSheet("https://mimg.127.net/freemail/mail-track/mail-track-detail-0.1.0.css"),$.Support.loadScript("//mimg.127.net/freemail/mail-track/mail-track-detail-0.1.0.js",(function(){window.MailTrackDetail.show(e)})))},subscribeSettingsChange:function(e){function t(){r.getSettings((function(e){r.subscribeQueue.forEach((function(t){t(e)}))}))}return 0===r.subscribeQueue.length&&$.Listener.listen("mailTracking:settingsChange",t),r.subscribeQueue.push(e),function(){r.subscribeQueue=r.subscribeQueue.filter((function(t){return t!==e})),0===r.subscribeQueue.length&&$.Listener.unlisten("mailTracking:settingsChange",t)}}};$.Object.extend(r,s),t.default=r},61785:function(e,t,i){i.r(t),i(803),i(79150),i(66251),i(55737);var a=i(72957),n=new a.c1("product.MailUnlock"),o=$.Object,r=$.Ajax,s=$.createClass((0,a.$N)("product.MailUnlock"));o.extend(s,{_dispatch:function(e,t,i,a,o){var r=this;1===i||2===i?e():100===i?r.showUnlockView(e,t,a,o):101===i||-2===i?t(n.t("æŠ±æ­‰ï¼ŒéªŒè¯ç é”™è¯¯ã€‚")):102===i?t(n.t("æŠ±æ­‰ï¼ŒéªŒè¯ç æ— æ•ˆï¼Œè¯·é‡æ–°è·å–ã€‚")):103===i?e():200===i?r.bindMob(e,t,void 0,o):201===i?t(n.t("æŠ±æ­‰ï¼Œæ‰‹æœºå·ç æ— æ•ˆï¼Œè¯·æ›´æ¢ã€‚")):202===i?t(n.t("æŠ±æ­‰ï¼ŒéªŒè¯ç ä¸‹å‘æ¬¡æ•°è¿‡å¤šã€‚")):203===i?t(n.t("æŠ±æ­‰ï¼Œæ“ä½œè¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•ã€‚")):-1===i?($.Support.relogin(),t()):(t(),r.showRequestError())},verifyLockAction:function(e,t){$.Support.securityCtrl({bBusinessCall:!0,actionId:"d972cc1233e44784be"},e,t)},unlockMail:function(e,t){var i=this;i.requestUnlockInfo((function(a,o){i._dispatch(e,t,a,o,{title:n.t("è¿™æ˜¯ä¸€å°è¢«åŠ é”çš„é‡è¦é‚®ä»¶ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œéœ€è¿›è¡Œæ‰‹æœºéªŒè¯æ‰èƒ½æŸ¥çœ‹ï¼š")})}))},showUnlockView:function(e,t,i,a){var o=this,r=(a||{}).title,s="";function c(){o.clearTimer(),t&&t()}a&&a.cusProduct&&(s+="&cusProduct="+a.cusProduct),$.Msgbox.show({extcls:"ot1",header:n.t("æ‰‹æœºéªŒè¯"),title:"<strong>"+(r||"")+"</strong>",content:['<div class="nui-simpleForm nui-form">',"<table>","<tbody>","<tr>",'<th class="nui-form-title">'+n.t("æ‰‹æœºå·ï¼š")+"</th>",'<td class="nui-form-cont"><strong>'+$.String.encodeHTML(i||"")+"</strong>&nbsp;&nbsp;",$.Link.html({text:n.t("æ›´æ¢æ‰‹æœºå·"),bracket:!0,click:function(){o.changeMob(e,t)}}),"</td>","</tr>","<tr>",'<th class="nui-form-title">'+n.t("éªŒè¯ç ï¼š")+"</th>",'<td class="nui-form-cont">',$.Input.html({id:"mailUnlockVCode",width:$G.environment.isCh?"50px":"35px"}),$.Button.html({text:n.t("å…è´¹è·å–çŸ­ä¿¡éªŒè¯ç "),click:function(){o.getVCodeBtnClick(this,s)}}),"</td>","</tr>","<tr>",'<th class="nui-form-title"></th>','<td class="nui-form-cont"><strong></strong></td>',"</tr>","</tbody>","</table>","</div>"].join(""),okText:n.t("æäº¤éªŒè¯"),ok:function(){var t=this,i=window.$C("mailUnlockVCode"),a=$.String.trim(i.getValue());return 0===a.length?(i.showTips(n.t("è¯·å…ˆè¾“å…¥éªŒè¯ç ã€‚")),!0):(o.checkUnlockResult(a,(function(a){o._dispatch((function(){o.clearTimer(),t.hide();try{e()}catch(e){}}),(function(e){i.showTips(e)}),a)}),s),!0)},cancel:c,close:c}),$.Component.setEvents()},bindMob:function(e,t,i,a){var o,r,s,c=this;void 0===i?(o=a?a.title:n.t("è¿™æ˜¯ä¸€å°è¢«åŠ é”çš„é‡è¦é‚®ä»¶ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œéœ€ç»‘å®šæ‰‹æœºè·å–éªŒè¯ç åæ‰èƒ½æŸ¥çœ‹ã€‚"),r=n.t("é©¬ä¸Šç»‘å®šæ‰‹æœº"),s=function(){c.openUrsPage(),c.bindMob(e,t,1)}):(r=n.t("æˆ‘å·²ç»å®Œæˆç»‘å®š"),o=n.t("åœ¨æ–°å¼€é¡µé¢å®Œæˆç»‘å®šæ‰‹æœºæ“ä½œï¼ŒæˆåŠŸåæŒ‰ä¸‹æ–¹â€œæˆ‘å·²å®Œæˆç»‘å®šâ€è¿›è¡Œç¡®è®¤ã€‚"),s=function(){c.requestUnlockInfo((function(i,a){200===i?c.bindMob(e,t,2):c._dispatch(e,t,i,a)}))},2===i&&(o='<span class="nui-txt-err">'+n.t("è¿˜æ²¡ç»‘å®šæ‰‹æœºæˆ–ç»‘å®šå¤±è´¥ï¼Œè¯·é‡æ–°æ“ä½œã€‚")+o+"</span>")),$.Msgbox.show({header:n.t("æ‰‹æœºéªŒè¯"),content:o,okText:r,ok:s,cancel:t,close:t})},changeMob:function(e,t){var i=this;i.openUrsPage(),$.Msgbox.show({header:n.t("æ‰‹æœºéªŒè¯"),content:n.t("åœ¨æ–°å¼€é¡µé¢å®Œæˆæ›´æ”¹ç»‘å®šæ‰‹æœºæ“ä½œï¼ŒæˆåŠŸåæŒ‰ä¸‹æ–¹â€œæˆ‘å·²å®Œæˆæ›´æ”¹â€è¿›è¡Œç¡®è®¤ã€‚"),okText:n.t("æˆ‘å·²å®Œæˆæ›´æ”¹"),ok:function(){i.requestUnlockInfo((function(a,n){i._dispatch(e,t,a,n)}))},cancel:t,close:t})},showRequestError:function(e){$.Msgbox.show({header:n.t("ç³»ç»Ÿæç¤º"),content:n.t("æŠ±æ­‰ï¼Œé‚®ä»¶è¯»å–å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚"),ok:e,cancel:e,close:e})},requestUnlockInfo:function(e,t){r.request({method:r.GET,url:"/mobileserv/aplInfo2.do?sid="+(0,a.$S)("sid"),call:function(t){try{var i=JSON.parse(t.responseText),a=i.code||-1,n=i.mob;e(a,n)}catch(t){e(0)}}})},requestVCode:function(e,t){r.request({method:r.GET,url:"/mobileserv/aplCodeSend.do?sid="+(0,a.$S)("sid")+t,call:function(t){try{var i=JSON.parse(t.responseText).code;e(i)}catch(t){e(-2)}}})},checkUnlockResult:function(e,t,i){r.request({method:r.GET,url:"/mobileserv/aplConfirmCode2.do?sid="+(0,a.$S)("sid")+"&code="+window.encodeURIComponent(e)+i,call:function(e){try{var i=JSON.parse(e.responseText).code;t(i)}catch(e){t(0)}}})},openUrsPage:function(){window.open("https://reg.163.com/mibao/controller/mob/index.jsp","ursMobWin")},getVCodeBtnClick:function(e,t){var i=this;e.setDisabled(),i.requestVCode((function(t){i._dispatch((function(){var t=60;window.$C("mailUnlockVCode").hideTips(),i.countdownHandler=window.setInterval((function(){t>0?e.setText(n.t("å†æ¬¡å‘é€ (")+t--+n.t("ç§’)")):(i.clearTimer(),e.setText(n.t("å…è´¹è·å–çŸ­ä¿¡éªŒè¯ç ")),e.setDisabled(!1))}),1e3)}),(function(t){t&&window.$C("mailUnlockVCode").showTips(t),e.setDisabled(!1)}),t)}),t)},clearTimer:function(){var e=this;e.countdownHandler&&(window.clearInterval(e.countdownHandler),e.countdownHandler=void 0)}}),t.default=s},89308:function(e,t,i){i.r(t),i(66251),i(48868),i(92274),i(63045),i(81874),i(54861);var a=i(72957),n=i(62385),o=new a.c1("product.Notary"),r=$.Object,s=$.Ext,c={showArchiveModal:function(e,t,i){try{var a=this._getUrlLink("notary_site");$.Msgbox.show({statsKey:"Auto_Archive_Modal",statsValue:e,type:"confirm",title:o.t("ç½‘æ˜“å…¬æ­£é‚®"),content:o.t("æ˜¯å¦å°†è¯¥é‚®ä»¶å½’æ¡£ä¿å­˜è‡³å…¬æ­£é‚®ï¼Ÿ")+'<br/><a class="txt-12 txt-info" href="'+a+'" target="blank">'+o.t("äº†è§£è¯¦æƒ…>>>")+"</a>",okText:o.t("ç¡®å®š"),cancelText:o.t("å–æ¶ˆ"),ok:function(){t&&t()}})}catch(e){i(e)}},showConfirmModal:function(e,t){try{var i=this._getUrlLink("notary_site");$.Msgbox.show({statsKey:"Join_Notary_Member_Modal",statsValue:e,type:"confirm",title:o.t("ç½‘æ˜“å…¬æ­£é‚®"),content:o.t("é‚®ç®±ä¼šå‘˜å°Šäº«ç½‘æ˜“å…¬æ­£é‚®æœåŠ¡ï¼Œé‚®ä»¶æ”¯æŒåœ¨çº¿å‡ºè¯ã€‚")+'<br/><a class="txt-12 txt-info" href="'+i+'" target="blank">'+o.t("äº†è§£è¯¦æƒ…>>>")+"</a>",okText:o.t("å¼€é€šä¼šå‘˜"),cancelText:o.t("å–æ¶ˆ"),ok:function(){n.default.showProduct("gzy","utm_source")}})}catch(e){t(e)}},showVipRenewalModal:function(e){try{window.vipPayPlugin&&e.data&&window.vipPayPlugin(e.data)}catch(t){e.callback&&e.callback(t)}},showMemRenewalModal:function(e){try{e&&e.data&&n.default.showProduct(e.data.product,e.data.utmSource)}catch(t){e.callback&&e.callback(t)}},showRedirectModal:function(){try{var e=this,t=this._getUrlLink("notary_site"),i=(0,a.$S)("isVip")?o.t("VIP å°Šäº«æƒç›Šï¼ŒåŒæ„åè®®å¹¶å¼€é€šå³å¯äº«å—å…¬æ­£é‚®ç‰¹æƒã€‚"):o.t("é‚®ç®±ä¼šå‘˜å°Šäº«æƒç›Šï¼ŒåŒæ„åè®®å¹¶å¼€é€šå³å¯äº«å—å…¬æ­£é‚®ç‰¹æƒã€‚");$.Msgbox.show({type:"confirm",title:o.t("ç½‘æ˜“å…¬æ­£é‚®"),content:i+'<br/><a class="txt-12 txt-info" href="'+t+'" target="blank">'+o.t("äº†è§£è¯¦æƒ…>>>")+"</a>",okText:o.t("ç«‹å³å¼€é€š"),cancelText:o.t("å–æ¶ˆ"),ok:function(){e._OpenGZYApp()}})}catch(e){console.log(e)}},getNotaryInfo:function(e,t){s.notary&&$.Ud.getProxy({field:["product.notary.userpro","product.notary.autoArchive","product.notary.single.balance"],call:function(t){if(t.hasOwnProperty("product.notary.userpro")){var i=t["product.notary.userpro"],n=t["product.notary.autoArchive"],o=t["product.notary.single.balance"];e({isPrivilege:1===i||(0,a.$S)("isVip"),isAutoArchive:1===n,singleBalance:o})}},error:function(e){t(e)}})},setNotaryBox:function(e,t,i){try{var a=this._getUrlLink("notaryUserInfo"),n=this;$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:a,call:function(a){try{var o=JSON.parse(a.response||a.responseText);"404"!=o.code&&"402"!=o.code&&(o.access_flag?n.showArchiveModal(e,t,i):n.showRedirectModal())}catch(e){console.log(e)}}})}catch(e){console.log(e)}},_getUrlLink:function(e){return $.Uri.getUrl(e,!0)},_OpenGZYApp:function(){(0,a.$S)("isVip")?Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"notary",title:o.t("ç½‘æ˜“å…¬æ­£é‚®"),cross:!1,group:"notary",fullScreen:!0})}))):Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(e){e.default.goOutlink({key:"notary_free_v2",title:o.t("ç½‘æ˜“å…¬æ­£é‚®"),cross:!1,group:"notary_free_v2",fullScreen:!0})})))}},l=r.extend($.createClass((0,a.$N)("product.Notary")),c);t.default=l},94253:function(e,t,i){i.r(t),i(66251);var a=i(72957),n=(new a.c1("product.Recovery"),$.createClass((0,a.$N)("product.Recovery")));$.Object.extend(n,{validStatus:function(e){void 0===$S("mbox_recovery_status")?$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.GET,rnd:!0,url:$.Uri.getUrl("recoveryStatuc_check"),call:function(t){if(t.responseText)try{!function(e,t){if(200===e.code){if(e.result&&e.result.remainTime>0){var i=e.result.status?2:1;return $S("mbox_recovery_status",i),void(t&&t(e.result.status?2:1))}$S("mbox_recovery_status",0)}t&&t(0)}(JSON.parse(t.responseText),e)}catch(t){console.warn(t),e&&e(0)}else e&&e(0)}}):e&&e($S("mbox_recovery_status"))}}),t.default=n},59340:function(e,t,i){i.r(t),i(48868),i(92274),i(63045),i(81874),i(54861),i(37092),i(79150),i(66251),i(803),i(75654),i(66403),i(55737);var a=i(72957),n=(i(30443),new a.c1("product.Translate")),o=$.Object,r=$.Log,s=$.Uri,c=$.Ext,l=$.createClass((0,a.$N)("product.Translate"));o.extend(l,{info:n.t("è¯·è¾“å…¥è¦æŸ¥è¯¢çš„å•è¯"),isInit:!1,isPick:!1,inputFlag:!1,init:function(){var e=this,t=e.input=new $.Input({}),a=e.button=new $.Button({text:n.t("è‹±æ±‰äº’è¯‘"),click:$.Function.bind(e.submit,e)}),o=e.checkbox=new $.Checkbox({text:n.t("å³åˆ’å³è¯‘"),checked:!0,checkedchange:$.Function.bind(e.pickClick,e)}),l='<form name="tranFrom" onsubmit="$I(\'product.Translate\').submit();return false;" class="nui-toolbar"><div class="nui-toolbar-item">'+t.html()+'</div><div class="nui-toolbar-item">'+a.html()+'</div><div class="nui-toolbar-item"><div class="nui-toolbar-item-text">'+o.html()+'</div></div></form><div class="qz0 nui-txt-normal nui-scroll nui-scroll-hasShadow"><p class="kI0" id="TranslateLoadingDiv" style="display:none">'+n.t("æ­£åœ¨æŸ¥è¯¢â€¦â€¦")+'</p><div id="TranslateNoneDiv" id="TranslateContentDiv" style="display:none;"></div><div id="TranslateContentDiv"></div><div class="lY1" id="TranslateNoneDiv" style="display:none"></div></div>',d="";c.human_trans&&(d=$.Link.html({text:n.t("ç½‘æ˜“ä¸“ä¸šç¿»è¯‘"),click:function(){Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(t){var i=t.default;s.getUrl("humanTrans"),i.goOutlink({key:"humanTrans",showDefTree:!1,fullScreen:!0}),e.msgbox.hide(),e.term(),$.Log.cache({cl_trans:"3"},$.EMPTYFUNC)})))}}),d=n.t("è¯•è¯•ç”¨ä¸­æ–‡å†™é‚®ä»¶ï¼Œ")+d+n.t("å¸®æ‚¨ç¿»è¯‘æˆè‹±æ–‡"),$G.environment.isCh||(d="")),e.msgbox=$.Msgbox.show({extcls:"tM0",contentType:"wide",content:l,header:n.t("æœ‰é“æµ·é‡è¯å…¸"),footer:d,ok:$.Function.bind(e.term,e,!1),close:$.Function.bind(e.term,e,!1),enter:$.Function.bind(e.submit,e),mask:!1,okText:n.t("å…³é—­")}),$.Component.setEvents(),e.isInit=!0,e.windows=[],e.pickClick();try{r.record("tran")}catch(e){}},term:function(e){var t=this;try{t.isInit&&(t.isPick&&t.disablePick(),t.isInit=!1,t.windows=null,t.lastQuery=null,e&&t.msgbox.close())}catch(e){}},change:function(){this.isInit?this.term(!0):this.init()},submit:function(){var e=this,t=e.input.getEl().find("INPUT").dom,i=$.String.trim(t.value);if(t.value=i,0!==i.length&&i!==t.defaultValue){try{t.focus(),t.select()}catch(e){}if(i!=e.lastQuery){e.lastQuery=i;try{e.msgbox.getEl().find("#TranslateLoadingDiv").show()}catch(e){}e.request(i,$.Function.bind(e.show,e))}}else e.disableInput()},request:function(e,t){var i=s.getUrl("tran_search_new",!0),a="?q="+encodeURIComponent(e)+"&rnd="+(new Date).getTime();$.Ajax.jsonp(i+a,t)},get:function(e){return JSON.parse(e)},show:function(e){var t=this.msgbox;t.getEl().find("#TranslateLoadingDiv").hide();var i=t.getEl().find("#TranslateContentDiv"),o=t.getEl().find("#TranslateNoneDiv"),r=$.String.encodeHTML(e.query),c="";if(e.basic){var l=[];if(e.basic){var d=e.basic,u="";d.phonetic&&(u="["+d.phonetic+"]");var m="";d.explains&&(m=d.explains.join("|"));var p="";l[l.length]='\t\t\t\t\t<h4 class="g-dialogBox-dict-content-title">&middot; '+n.t("åŸºæœ¬é‡Šä¹‰")+"</h4>\t\t\t\t\t<p>\t\t\t\t",l[l.length]='<strong class="g-dialogBox-dict-keyword">'+e.translation+"</strong> <span>"+u+"</span>",l[l.length]="",l[l.length]="\t\t\t\t\t</p>\t\t\t\t\t<p><strong>"+m+"</strong></p>\t\t\t\t\t"+p+"\t\t\t\t"}if(e.web.length>0){p="",l[l.length]='<h4 class="g-dialogBox-dict-content-title">&middot; '+n.t("ç½‘ç»œé‡Šä¹‰")+"</h4>",l[l.length]=p;for(var f=0,h=e.web.length;f<h&&f<5;f++){for(var g=e.web[f].key+"ï¼š",v=[],b=0,y=e.web[f].value.length;b<y;b++)v.push(e.web[f].value[b]);l[l.length]="<p><em>"+g+"</em><span>"+v.join(" | ")+"</span></p>"}l[l.length]='<p><a href="https://dict.youdao.com/search?q='+r+"&keyfrom=163mail&keyfrom="+(0,a.$S)("product")+'mail" target="_blank">'+n.t("å®Œæ•´æœç´¢ç»“æœ")+"&gt;&gt;</a></p>"}i.dom.innerHTML=l.join(""),i.dom.scrollTop=0,o.hide(),i.show()}else{var x=s.getUrl("tran_noresult",!0)+r,k=new $.Link({link:x,target:"_blank",text:r});c+="\t\t\t\t<p>"+n.t("æŠ±æ­‰ï¼Œæ²¡æœ‰æ‰¾åˆ°ä¸æ‚¨æŸ¥è¯¢çš„â€œ")+"<em>"+r+'</em>â€ç›¸ç¬¦çš„å­—è¯ã€‚</p>\t\t\t\t<ul class="nui-txt-tips">\t\t\t\t\t<li>&middot; è¯·æŸ¥çœ‹è¾“å…¥çš„å­—è¯æ˜¯å¦æœ‰é”™è¯¯</li>\t\t\t\t\t<li>'+n.t("&middot; è¯·åœ¨æœ‰é“ç½‘é¡µæœç´¢ä¸­æœç´¢â€œ")+k.html()+"â€</li>\t\t\t\t</ul>\t\t\t",o.dom.innerHTML=c,o.show(),i.hide()}},pickClick:function(){var e=this;e.checkbox.getChecked()?e.enablePick():e.disablePick()},enablePick:function(){var e=this;$.Event.listen(document,"mouseup",e.mouseup);var t=e.windows;t[t.length]=window,function i(a,n){try{for(var o=a.getElementsByTagName("IFRAME"),r=0;r<o.length;r++)try{var s=o[r].contentWindow;$.Event.listen(s.document,"mouseup",e.mouseup),t[t.length]=s,n&&i(s.document)}catch(e){}}catch(e){}}(document,!0),e.isPick=!0},disablePick:function(){var e=this;try{for(var t=e.windows,i=0;i<t.length;i++){var a=t[i];try{$.Event.unlisten(a.document,"mouseup",e.mouseup)}catch(e){}}}catch(e){}e.isPick=!1,e.windows=[]},mouseup:function(){var e=l;if(e.isPick){var t=e.getQueryWord();!t||t.length>60||e.enableInput(t)}},getQueryWord:function(){var e;if(!e)try{for(var t=this.windows,i=0;i<t.length;i++){var a=t[i];if((e=n(a,a.document))&&e.length>0)break}return e}catch(e){return null}return e;function n(e,t){try{if(e.getSelection)return e.getSelection().toString();if(t.getSelection)return t.getSelection().toString();if(t.selection)return t.selection.createRange().text}catch(e){}return null}},enableInput:function(e){var t=this.input.getEl().find("INPUT").dom;t.focus(),e&&(t.value=e,this.submit())},disableInput:function(){this.input.getEl().find("INPUT").dom.blur()},goHuman:function(e){function t(t){var i=document.createElement("FORM"),a=s.getUrl("humanTrans",!0);for(var n in e.vendor&&(a+="?vendor="+e.vendor,delete e.vendor),i.action=a,i.method="POST",i.target=t.find("IFRAME").dom.id,e){var o=$.String.trim(""+e[n]);if(o){var r=document.createElement("INPUT");r.type="hidden",r.name=n,r.value=o,i.appendChild(r)}}document.body.appendChild(i),setTimeout((function(){i.submit()}),100)}e&&Promise.resolve().then(i.bind(i,30443)).then($.Function.bind((function(i){var o=i.default;e.uid=(0,a.$S)("uid"),e.sid=(0,a.$S)("sid"),e.NTES_SESS=$.Misc.getMailSess(),o.goOutlink({key:"trans",url:"about:blank",title:n.t("ç½‘æ˜“ä¸“ä¸šç¿»è¯‘"),call:t,showDefTree:!1,fullScreen:!0})})))}}),t.default=l},9002:function(e,t,i){i.r(t),i(66251);var a=new $I18N("support.CloudSupport"),n=$.Object,o=$.createClass($N("support.CloudSupport"));n.extend(o,{init:function(e,t){if(!$S("cloud")||e){var i=o.getUrl();i+="?sid="+$S("sid"),i+="&uid="+$S("orgUid"),i+="&op=fs_b_g_a",i+="&p="+o.getProduct(),$.Ajax.request({url:i,paddingParam:"ev",paddingFunc:function(){o.response.apply(o,arguments),t&&t()},requestType:$.Ajax.SCRIPT})}},response:function(e,t){200==e?t&&t.account&&o.setUser(t):402==e&&o.active(),$.Log.cache({CloudSupportInitCodeStatus:e})},active:function(){if(!$S("cloudActive")){$S("cloudActive",!0);var e="//"+location.host+"/filehub/fh/user?uid="+$S("orgUid")+"&sid="+$S("sid")+"&op=get&bg_act=false&_="+(new Date).getTime();$.Ajax.request({url:e,requestType:$.Ajax.XMLHTTP,call:function(e){200==JSON.parse(e.responseText).code&&o.init()}})}},setUser:function(e){$S("cloud",e);try{var t=$.Context.module;if(t.mtype&&"compose.ComposeModule"==t.mtype){var i=$.Number.convert($S("cloud").fileSizeLimit);if($S("isVip")&&(i+='<b class="nui-ico nui-ico-tequan" style="margin-top:-2px;margin-left:2px;margin-right:2px;"></b>'),$("#ft2").html(i),$S("isFree")){var n=a.t("ä¸€æ¬¡å¯å‘é€2000å¼ ç…§ç‰‡ï¼Œ600é¦–MP3ï¼Œä¸€éƒ¨é«˜æ¸…ç”µå½±");$("#"+t.createId("attachAdd")).attr({title:n}),$("#"+t.createId("attachBrowser")).attr({title:n});var o=$S("cloud").capacity;if(o&&o<16106127360){var r=new $.Link({text:"<span class='nui-txt-impt'>"+a.t("å‡è‡³15G")+"</span>",cls:"nui-txt-link cm1",title:a.t("å‡è‡³15G"),click:function(){$E("product.FileCenter",(function(e){e.entry("file_center",{hash:"#user/bgupload"})}))}});$("#"+t.createId("cloudTips")).html(r.html()),$.Component.setEvents()}}}}catch(e){}},getUrl:function(){var e=$S("domain"),t="fs.163.com";return"163.com"==e?t="fs.mail.163.com":"126.com"==e?t="fs.mail.126.com":"yeah.net"==e?t="fs.mail.yeah.net":"vip.163.com"==e?t="fs.vip.163.com":"vip.126.com"==e?t="fs.vip.126.com":"188.com"==e?t="fs.vip.188.com":$S("isCorp")&&(t="fs.qiye.163.com"),"//"+t+"/fs/service/"},getProduct:function(){var e=$S("domain"),t="";return"163.com"==e?t="163mail":"126.com"==e?t="126mail":"yeah.net"==e?t="yeahmail":"vip.163.com"==e?t="163vipmail":"vip.126.com"==e?t="126vipmail":"188.com"==e?t="188vipmail":$S("isCorp")&&(t="corpmail"),t},batchRenew:function(e){$.Ajax.request({requestType:$.Ajax.XMLHTTP,method:$.Ajax.POST,url:$.Uri.getUrl("cloudfile_batchrenew"),body:{fileIds:e},call:function(e){try{var t=JSON.parse(e.responseText);if(200!==t.code)return void $.Tips.show(a.t("æ–‡ä»¶ç»­æœŸå¤±è´¥ï¼Œè¯·ç¨åå†è¯•"));if(!t.data||!t.data.length)return void $.Tips.show(a.t("æ–‡ä»¶ç»­æœŸå¤±è´¥ï¼Œè¯·ç¨åå†è¯•"));var i=!0;if($.Array.each(t.data,(function(e,t){t&&t.time<0&&(i=!1)})),!i)return void $.Tips.show(a.t("æ–‡ä»¶ç»­æœŸå¤±è´¥ï¼Œè¯·ç¨åå†è¯•"));$.Tips.module({type:"suc",text:a.t("æ–‡ä»¶ç»­æœŸæˆåŠŸ"),expires:5e3})}catch(e){$.Tips.show(a.t("æ–‡ä»¶ç»­æœŸå¤±è´¥ï¼Œè¯·ç¨åå†è¯•"))}}})}}),t.default=o},11409:function(e,t,i){i.r(t),i(66403),i(68233),i(42295),i(34994),i(15761),i(20869),i(63518),i(75654);var a=i(72957),n=new a.c1("support.Theme"),o=$.Object,r=$.Array,s=$.Function,c=($.String,$.Ud),l=$.createClass((0,a.$N)("support.Theme"));o.extend(l,{init:function(){6!=$.Browser.ie()&&"standard"==$G.mailPattern.currentPattern&&l.getSkinConf((function(){var e=l.getCurrentSkin(),t=l.isUseHoliday();e.apply&&(t?e.apply.use({isHoliday:!0}):e.apply.use(e))}))},getSkinConf:function(e){if(window.oSkinConf||$G.environment.skinConf)e(window.oSkinConf||$G.environment.skinConf);else{var t=$G.environment,i=t.cacheThemePath+"/"+t.themeJsFile;$.Ajax.request({url:i,requestType:$.Ajax.SCRIPT,call:function(){var t=window.oSkinConf||$G.environment.skinConf;t&&(l._orgiSkin=l._formatSkinData(t),e(t))}})}},_formatSkinData:function(e){var t=[],i={},n=(0,a.$S)("domain");for(var o in e){var r=e[o];if("otherSkin"==o){t=[];for(var s=0;s<r.length;s++){var c=r[s];c.domain.indexOf(n)>=0&&(t.push(c),i[c.value]=c)}}else if(r instanceof window.Array)t=t.concat(r),$.Array.each(t,(function(e,t){i[t.value]=t}));else if(r instanceof window.Object)for(var s in r)t.push(r[s]),i[r[s].value]=r[s]}return{skin_data:t,skin_index:i}},changeSkin:function(e,t){6==$.Browser.ie()?l.noSupportTheme():l.getSkinConf(s.bind((function(e,t){var i=l.getSkin(e);if(i){var o=l.getCurrentSkin(),r=(e=i.value,i.name),s=i.color,d=(e+"").split("");!t&&o&&o.value===e||(o.apply&&o.apply.unuse(i),$G.user.color=s,$G.user.css=r,$G.user.skin=e,d.length<2&&d.unshift(0),"1"===$.Ud.get({field:"huodong_option",flag:"hd_womens"})&&89===o.value&&$.Log.cache({Theme38skinCancel:1}),$.Log.cache({skinChange:{value:e,from:o.value}}),t?u({code:"S_OK"}):(c.set({field:"ntes_skin",flag:"jsSkin_units",value:d[1],notPost:!0}),c.set({field:"ntes_skin",flag:"jsSkin_tens",value:d[0],call:u,forcePost:!0}),$.Ud.set({field:"huodong_option",flag:"hd_womens",value:"0"})))}function u(e){e&&(e.code==$.S_OK?((0,a.$S)("skin",{name:r,color:s}),$.Tips.show({succ:!0,text:n.t("é‚®ç®±çš®è‚¤è®¾ç½®æˆåŠŸ")}),$.Listener.fire("options:skinChange"),l.updateIframeSkin(),i.apply&&i.apply.use(i)):$.Tips.show({text:n.t("è®¾ç½®å¤±è´¥ï¼Œè¯·ç¨å€™å†è¯•")}))}}),this,e,t))},getSkin:function(e){try{return l._orgiSkin.skin_index[e]}catch(e){return null}},getCurrentSkin:function(){l._orgiSkin.skin_data;var e,t,i="0",n=(0,a.$S)("attrs").user,o=window.oSkinConf||$G.environment.skinConf,r=(0,a.$S)("domain");return"string"==typeof n.ntes_skin?i=$G.user.skin-0||parseInt(n.ntes_skin.substr(4,2),10)||"":(0,a.$S)("isyeah")&&!n.ntes_skin&&$G.user.skin?i=$G.user.skin-0:n.ntes_skin="0000000000000000",r.indexOf("188")>=0&&(r="188.com"),(e=o.defaultSkin[r]||o.defaultSkin["163.com"])||(t=l.getSkin(e.value)),i-0==0&&(i=e.value),(t=l.getSkin(i))||(t=l.getSkin(e.value)),t},getTopConf:function(e){l.getSkinConf((function(t){var i=[];for(var a in t){var n=t[a];n instanceof window.Array?r.each(n,(function(e,t){t.topshow&&i.push(t)})):n instanceof window.Object&&o.each(n,(function(e,t){t.topshow&&i.push(t)}))}e(i)}))},updateIframeSkin:function(){for(var e,t,i=[{domain:["vip.163.com","188.com"],id:"ifrmvipmsg",operator:"<",type:1},{domain:["vip.163.com"],id:"welcomeIfr",operator:"<"}],n=(0,a.$S)("domain"),o=!0,r=0,s=i.length;r<s;r+=1){if(e=i[r],!(t=$(e.id)))return;t=t.dom;var c=0;for(s=e.domain.length;c<s;c+=1){if(e.domain[c]==n&&">"===e.operator){o=!1;break}c==s&&e.domain[c]!=n&&"<"===e.operator&&(o=!1)}o&&(1===e.type?t.src=l(l(t.src,"skin",$G.user.css),"color",$G.user.color):t.src=t.src)}function l(e,t,i){return e.replace(new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),"")+"&"+t+"="+i}},noSupportTheme:function(){var e="https://count.mail.163.com/statistics/5xS5rC.do?&product=js6&domain="+(0,a.$S)("domain")+"&uid="+(0,a.$S)("uid")+"&area=welcome"+$.Browser.ie();$.Msgbox.show({icon:"alert",title:n.t("æ‚¨çš„æµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½ï¼Œæ— æ³•æ”¯æŒé‚®ç®±æ¢è‚¤ç‰¹æ€§ã€‚"),content:n.t("å¦‚éœ€ä½¿ç”¨é‚®ç®±æ¢è‚¤åŠŸèƒ½ï¼Œ")+'<a target="_blank" href="'+e+'" >'+n.t("è¯·å‡çº§æµè§ˆå™¨")+"</a>",okText:n.t("æˆ‘çŸ¥é“äº†")})},isUseHoliday:function(){return!!$G.environment.isHolidayTheme&&""===$.Cookie.get("forceHideHoliday")},notUseHoliday:function(){$G.environment.holidayDays&&$.Cookie.set("forceHideHoliday","sjb",{expires:$G.environment.holidayDays-0})}}),t.default=l}}]);