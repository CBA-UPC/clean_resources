"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60753],{47208:8144:function(e,t,n){n.d(t,{A:function(){return eK},C:function(){return eG},D:function(){return I},E:function(){return B},F:function(){return m},G:function(){return j},H:function(){return K},I:function(){return Q},J:function(){return e2},K:function(){return to},N:function(){return E},P:function(){return ta},U:function(){return R},a:function(){return w},b:function(){return T},c:function(){return S},d:function(){return A},e:function(){return N},f:function(){return tu},g:function(){return H},j:function(){return C},k:function(){return x},l:function(){return k},m:function(){return P},n:function(){return M},o:function(){return b},p:function(){return eS},q:function(){return ep},r:function(){return ex},s:function(){return O},t:function(){return eM},u:function(){return eU},v:function(){return D},w:function(){return ek},x:function(){return eR},y:function(){return eW},z:function(){return eB}});var r,i,s,a,o,u,c,l,h,d,f,p,_,m,g=n(35660),v=n(78424),y=n(18920),b=100,E="GroupChannel",w="url",I=100,T="Message",S="messageId",A="Poll",N="pollId",C={data:null,customType:null,mentionType:g.$.USERS,mentionedUserIds:null,mentionedUsers:null,mentionedMessageTemplate:null,metaArrays:null,parentMessageId:null,isReplyToChannel:!1,pushNotificationDeliveryOption:null,appleCriticalAlertOptions:null,isPinnedMessage:!1},k=function(e){return(0,g.a)("string",e.data,!0)&&(0,g.a)("string",e.customType,!0)&&(0,g.H)(g.$,e.mentionType)&&(0,g.l)("string",e.mentionedUserIds,!0)&&(0,g.l)(g.U,e.mentionedUsers,!0)&&(0,g.a)("string",e.mentionedMessageTemplate,!0)&&(0,g.l)(v.c,e.metaArrays,!0)&&(0,g.a)("number",e.parentMessageId,!0)&&(0,g.a)("boolean",e.isReplyToChannel)&&(0,g.H)(g.a4,e.pushNotificationDeliveryOption,!0)&&(0,g.a)(v.A,e.appleCriticalAlertOptions,!0)&&(0,g.a)("boolean",e.isPinnedMessage,!0)},O=R=(0,g.g)((0,g.g)({},C),{message:null,translationTargetLanguages:null,pollId:null}),D=function(e){return k(e)&&(0,g.a)("string",e.message)&&(0,g.l)("string",e.translationTargetLanguages,!0)&&(0,g.a)("number",e.pollId,!0)};(U=m||(m={})).FILE="file",U.BLOB="blob",U.BLOB_LIKE_OBJECT="blobLikeObject",U.URL="url";var U,L,M=function(e){return"undefined"!=typeof window&&"Blob"in window&&"undefined"!=typeof Blob&&e instanceof Blob},P=x=function(e){return e?{file:e.file,fileKey:e.fileKey,fileType:e.fileType,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption}:null},q=(0,g.g)((0,g.g)({},C),{file:null,fileKey:null,fileUrl:null,fileName:null,fileType:null,fileSize:null,mimeType:null,thumbnailSizes:null,requireAuth:!1}),F=function(e){return k(e)&&((0,g.i)(e.file)||(0,g.a)("string",e.fileUrl))&&(0,g.a)("string",e.fileName,!0)&&(0,g.a)("string",e.mimeType,!0)&&(0,g.a)("number",e.fileSize,!0)&&(null===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every(function(e){return(0,g.a)("object",e)&&e.maxWidth>0&&e.maxHeight>0}))};(V=L||(L={})).MUTED="muted",V.BANNED="banned";var V,z,G=function(){function e(e){var t,n,r;this.restrictionType=null,this.description=null,this.endAt=-1,(0,g.H)(L,e.restriction_type)&&(this.restrictionType=e.restriction_type),this.description=null!==(t=e.description)&&void 0!==t?t:null,this.endAt=null!==(r=null!==(n=e.end_at)&&void 0!==n?n:e.muted_end_at)&&void 0!==r?r:-1}return e.payloadify=function(e){return e?(0,g.e)({restriction_type:e.restrictionType,description:e.description,end_at:e.endAt}):null},e}(),H=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.restrictionInfo=null,r.restrictionInfo=new G(n),r}return(0,g._)(t,e),t.payloadify=function(t){return t?(0,g.e)((0,g.g)((0,g.g)({},e.payloadify.call(this,t)),G.payloadify(t.restrictionInfo))):null},t}(g.U),B={data:null,customType:null,mentionType:g.$.USERS,mentionedUserIds:null,mentionedUsers:null,mentionedMessageTemplate:null,metaArrays:null,pushNotificationDeliveryOption:null,appleCriticalAlertOptions:null},j=function(e){return(0,g.a)("string",e.data,!0)&&(0,g.a)("string",e.customType,!0)&&(0,g.H)(g.$,e.mentionType)&&(0,g.l)("string",e.mentionedUserIds,!0)&&(0,g.l)(g.U,e.mentionedUsers,!0)&&(0,g.a)("string",e.mentionedMessageTemplate,!0)&&(0,g.l)(v.c,e.metaArrays,!0)&&(0,g.H)(g.a4,e.pushNotificationDeliveryOption,!0)&&(0,g.a)(v.A,e.appleCriticalAlertOptions,!0)},K=(0,g.g)((0,g.g)({},B),{message:null,translationTargetLanguages:null,pollId:null}),Q=function(e){return j(e)&&(0,g.a)("string",e.message,!0)&&(0,g.l)("string",e.translationTargetLanguages,!0)&&(0,g.a)("number",e.pollId,!0)},W=(0,g.g)({},B),Y=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,s=t.limit,a=e.call(this)||this;return a.method=g.A.GET,a.path="".concat((0,g.a6)(r),"/").concat(encodeURIComponent(n),"/operators"),a.params={token:i,limit:s},a}return(0,g._)(t,e),t}(g.f),Z=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.operators=n.operators.map(function(e){return new g.U(t,e)}),r.token=n.next,r}return(0,g._)(t,e),t}(g.h),X=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return(0,g._)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t,n,r,i,s;return(0,g.c)(this,function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=g.V.of(this._iid).requestQueue,n=new Y((0,g.g)((0,g.g)({},this),{channelUrl:this.channelUrl,token:this._token})),[4,t.send(n)]):[3,2]):[3,5];case 1:return i=(r=a.sent().as(Z)).operators,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,e];case 3:throw g.S.queryInProgress;case 4:return[3,6];case 5:throw g.S.invalidParameters;case 6:return[2]}})})},t}(g.ah),J=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.limit,a=t.token;return(n=e.call(this)||this).method=g.A.GET,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={limit:s,token:a},n}return(0,g._)(t,e),t}(g.f),$=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.token=null,r.mutedUsers=[];var i=n.next,s=n.muted_list;return r.token=i,s&&s.length>0&&(r.mutedUsers=s.map(),r}return(0,g._)(t,e),t}(g.h),ee=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return(0,g._)(t,e),t.prototype.next=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t,n,r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=g.V.of(this._iid).requestQueue,t=new J((0,g.g)((0,g.g)({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return r=(n=s.sent().as($)).mutedUsers,i=n.token,this._token=i,this._hasNext=!!i,this._isLoading=!1,[2,r];case 2:return[2,[]];case 3:throw g.S.queryInProgress;case 4:return[3,6];case 5:throw g.S.invalidParameters;case 6:return[2]}})})},t}(g.ah),et=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.limit,a=t.token;return(n=e.call(this)||this).method=g.A.GET,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=(0,g.e)({limit:s,token:a}),n}return(0,g._)(t,e),t}(g.f),en=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.token=null,r.bannedUsers=[];var i=n.next,s=n.banned_list;return r.token=i,s&&s.length>0&&(r.bannedUsers=s.map(),r}return(0,g._)(t,e),t}(g.h),er=function(e){eturn(0,g._)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t,n,r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=g.V.of(this._iid).requestQueue,t=new et((0,g.g)((0,g.g)({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return r=(n=s.sent().as(en)).bannedUsers,i=n.token,this._token=i,this._hasNext=!!i,this._isLoading=!1,[2,r];case 2:return[2,[]];case 3:throw g.S.queryInProgress;case 4:return[3,6];case 5:throw g.S.invalidParameters;case 6:return[2]}})})},t}(g.ah);(r=z||(z={})).SPAM="spam",r.HARASSING="harassing",r.SUSPICIOUS="suspicious",r.INAPPROPRIATE="inappropriate";var ei=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.operatorUserIds;return(n=e.call(this)||this).method=g.A.POST,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:s},n}return(0,g._)(t,e),t}(g.f);i=g.h,(0,g._)(function(){return null!==i&&i.apply(this,arguments)||this},i);var es=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.operatorUserIds;return(n=e.call(this)||this).method=g.A.DELETE,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:s},n}return(0,g._)(t,e),t}(g.f);s=g.h,(0,g._)(function(e,t){return s.call(this,e,t)||this},s);var ea=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return(n=e.call(this)||this).method=g.A.GET,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/mute/").concat(s),n}return(0,g._)(t,e),t}(g.f),eo=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.isMuted=!1,r.startAt=null,r.endAt=null,r.remainingDuration=null,r.description=null;var i=n.is_muted,s=n.start_at,a=n.end_at,o=n.remaining_duration,u=n.description;return r.isMuted=i,r.startAt=s,r.endAt=a,r.remainingDuration=o,r.description=u,r}return(0,g._)(t,e),t}(g.h),eu=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.keys;return(n=e.call(this)||this).method=g.A.GET,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={keys:s,include_ts:!0},n}return(0,g._)(t,e),t}(g.f),ec=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.ts=null;var i=n.metadata,s=n.ts;return r.metadata=i,r.ts=null!=s?s:null,r}return(0,g._)(t,e),t}(g.h),el=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metadata;return(n=e.call(this)||this).method=g.A.POST,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:s,include_ts:!0},n}return(0,g._)(t,e),t}(g.f),eh=function(e){function t(t,n){var r,i,s=this;return(s=e.call(this,t,n)||this).metaData=null!==(r=n.metadata)&&void 0!==r?r:{},s.ts=null!==(i=n.ts)&&void 0!==i?i:null,s}return(0,g._)(t,e),t}(g.h),ed=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metadata,a=t.upsert;return(n=e.call(this)||this).method=g.A.PUT,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:s,include_ts:!0,upsert:null!=a&&a},n}return(0,g._)(t,e),t}(g.f),ef=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.ts=null;var i=n.metadata,s=n.ts;return r.metadata=i,r.ts=null!=s?s:null,r}return(0,g._)(t,e),t}(g.h),ep=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.created=null,i.updated=null,i.deleted=null,r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i}return(0,g._)(t,e),t}(g.W),e_=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.key;return(n=e.call(this)||this).method=g.A.DELETE,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metadata/").concat(s),n.params={include_ts:!0},n}return(0,g._)(t,e),t}(g.f),em=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.ts=null;var i=n.ts;return r.ts=null!=i?i:null,r}return(0,g._)(t,e),t}(g.h),eg=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=g.A.DELETE,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={include_ts:!0},n}return(0,g._)(t,e),t}(g.f),ev=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.ts=null;var i=n.ts;return r.ts=null!=i?i:null,r}return(0,g._)(t,e),t}(g.h),ey=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.keys;return(n=e.call(this)||this).method=g.A.GET,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={keys:s},n}return(0,g._)(t,e),t}(g.f),eb=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return(0,g._)(t,e),t}(g.h),eE=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metaCounter;return(n=e.call(this)||this).method=g.A.POST,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:s},n}return(0,g._)(t,e),t}(g.f),ew=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return(0,g._)(t,e),t}(g.h),eI=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metaCounter,a=t.upsert,o=t.mode;return(n=e.call(this)||this).method=g.A.PUT,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:s,upsert:void 0!==a&&a,mode:void 0===o?"set":o},n}return(0,g._)(t,e),t}(g.f),eT=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return(0,g._)(t,e),t}(g.h),eS=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.created=null,i.updated=null,i.deleted=null,r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i}return(0,g._)(t,e),t}(g.W),eA=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.key;return(n=e.call(this)||this).method=g.A.DELETE,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metacounter/").concat(s),n.params=null,n}return(0,g._)(t,e),t}(g.f);a=g.h,(0,g._)(function(e,t){return a.call(this,e,t)||this},a);var eN=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=g.A.DELETE,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params=null,n}return(0,g._)(t,e),t}(g.f);o=g.h,(0,g._)(function(){return null!==o&&o.apply(this,arguments)||this},o);var eC=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId,a=t.seconds,o=t.description;return(n=e.call(this)||this).method=g.A.POST,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={user_id:s,seconds:a,description:o},n}return(0,g._)(t,e),t}(g.f);u=g.h,(0,g._)(function(e,t){return u.call(this,e,t)||this},u);var ek=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new H(t,r.data),i}return(0,g._)(t,e),t}(g.W),eO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return(n=e.call(this)||this).method=g.A.DELETE,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/mute/").concat(encodeURIComponent(s)),n}return(0,g._)(t,e),t}(g.f);c=g.h,(0,g._)(function(){return null!==c&&c.apply(this,arguments)||this},c);var eR=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new H(t,r.data),i}return(0,g._)(t,e),t}(g.W),eD=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId,a=t.seconds,o=t.description;return(n=e.call(this)||this).method=g.A.POST,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=(0,g.e)({user_id:s,seconds:a,description:o}),n}return(0,g._)(t,e),t}(g.f);l=g.h,(0,g._)(function(){return null!==l&&l.apply(this,arguments)||this},l);var eU=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.memberCount=null,i.joinedMemberCount=null,i.user=new H(t,r.data),r.data.member_count&&(i.memberCount=r.data.member_count),r.data.joined_member_count&&(i.joinedMemberCount=r.data.joined_member_count),i}return(0,g._)(t,e),t}(g.W),eL=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return(n=e.call(this)||this).method=g.A.DELETE,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/ban/").concat(encodeURIComponent(s)),n}return(0,g._)(t,e),t}(g.f);h=g.h,(0,g._)(function(){return null!==h&&h.apply(this,arguments)||this},h);var eM=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new H(t,r.data),i}return(0,g._)(t,e),t}(g.W),eP=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.freezing;return(n=e.call(this)||this).method=g.A.PUT,n.path="".concat((0,g.a6)(i),"/").concat(encodeURIComponent(r),"/freeze"),n.params={freeze:s},n}return(0,g._)(t,e),t}(g.f);d=g.h,(0,g._)(function(){return null!==d&&d.apply(this,arguments)||this},d);var ex=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.freeze=r.data.freeze,i}return(0,g._)(t,e),t}(g.W),eq=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,a=t.userId,o=t.description;return(n=e.call(this)||this).method=g.A.POST,n.path="".concat((0,g.at)(i),"/").concat(encodeURIComponent(r)),n.params={report_category:s,reporting_user_id:a,report_description:o},n}return(0,g._)(t,e),t}(g.f),eF=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,a=t.userId,o=t.offendingUserId,u=t.description;return(n=e.call(this)||this).method=g.A.POST,n.path="".concat(g.au,"/users/").concat(o),n.params={channel_url:r,channel_type:i===g.K.OPEN?"open_channels":"group_channels",report_category:s,reporting_user_id:a,report_description:u},n}return(0,g._)(t,e),t}(g.f),eV=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,a=t.userId,o=t.offendingUserId,u=t.messageId,c=t.description;return(n=e.call(this)||this).method=g.A.POST,n.path="".concat((0,g.at)(i),"/").concat(encodeURIComponent(r),"/messages/").concat(u),n.params={report_category:s,reporting_user_id:a,report_description:c,offending_user_id:o},n}return(0,g._)(t,e),t}(g.f),ez=function(e){function t(t){var n=[];return t.mentionType===g.$.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map(function(e){return e.userId}))),e.call(this,{code:"MESG",ackRequired:!0,payload:(0,g.e)({channel_url:t.channelUrl,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==g.a4.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId>0?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage})})||this}return(0,g._)(t,e),t}(g.a5),eG=function(e){function t(t,n,r){var i,s,a,o=this;(o=e.call(this,t,"MESG",r)||this).message=new v.U(t,r);var u=g.V.of(t).sdkState;return o.isMentioned=(0,g.a7)(o.message.mentionType,null!==(i=o.message.mentionedUserIds)&&void 0!==i?i:null===(s=o.message.mentionedUsers)||void 0===s?void 0:s.map(function(e){return e.userId}),u.userId),o.forceUpdateLastMessage=null!==(a=r.force_update_last_message)&&void 0!==a&&a,o}return(0,g._)(t,e),t}(g.W),eH=function(e){function t(t){var n,r=null;return t.mentionType===g.$.USERS&&(t.mentionedUserIds?r=t.mentionedUserIds:t.mentionedUsers&&(r=t.mentionedUsers.map(function(e){return e.userId}))),e.call(this,{code:"MEDI",ackRequired:!0,payload:(0,g.e)({channel_url:t.channelUrl,msg_id:t.messageId,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:r,mentioned_message_template:t.mentionedMessageTemplate,apple_critical_alert_options:null===(n=t.appleCriticalAlertOptions)||void 0===n?void 0:n.serialize(),poll_id:t.pollId})})||this}return(0,g._)(t,e),t}(g.a5),eB=function(e){function t(t,n,r){var i,s,a,o,u,c,l=this;(l=e.call(this,t,"MEDI",r)||this).message=new v.U(t,r);var h=g.V.of(t).sdkState;return l.mentionCountChange=(0,g.av)({mentionType:null!==(s=null===(i=r.old_values)||void 0===i?void 0:i.mention_type)&&void 0!==s?s:null,mentionedUserIds:null!==(o=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==o?o:[]},{mentionType:l.message.mentionType,mentionedUserIds:null!==(u=l.message.mentionedUserIds)&&void 0!==u?u:null===(c=l.message.mentionedUsers)||void 0===c?void 0:c.map(function(e){return e.userId})},h.userId),l}return(0,g._)(t,e),t}(g.W),ej=function(e){function t(t){var n=null;return t.mentionType===g.$.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map(function(e){return e.userId}))),e.call(this,{code:"FEDI",ackRequired:!0,payload:(0,g.e)({channel_url:t.channelUrl,msg_id:t.messageId,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,apple_critical_alert_options:t.appleCriticalAlertOptions})})||this}return(0,g._)(t,e),t}(g.a5),eK=function(e){function t(t,n,r){var i,s,a,o,u,c,l=this;(l=e.call(this,t,"FEDI",r)||this).message=new v.F(t,r);var h=g.V.of(t).sdkState;return l.mentionCountChange=(0,g.av)({mentionType:null!==(s=null===(i=r.old_values)||void 0===i?void 0:i.mention_type)&&void 0!==s?s:null,mentionedUserIds:null!==(o=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==o?o:[]},{mentionType:l.message.mentionType,mentionedUserIds:null!==(u=l.message.mentionedUserIds)&&void 0!==u?u:null===(c=l.message.mentionedUsers)||void 0===c?void 0:c.map(function(e){return e.userId})},h.userId),l}return(0,g._)(t,e),t}(g.W),eQ=function(e){function t(t){var n=e.call(this)||this;return n.method=g.A.DELETE,n.path="".concat((0,g.a6)(t.channelType),"/").concat(t.channelUrl,"/messages/").concat(t.messageId),n}return(0,g._)(t,e),t}(g.f);f=g.h,(0,g._)(function(){return null!==f&&f.apply(this,arguments)||this},f);var eW=function(e){function t(t,n,r){var i=e.call(this,t,"DELM",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.messageId=Number(r.msg_id),i}return(0,g._)(t,e),t}(g.W),eY=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.reactionKey,a=e.call(this)||this;return a.method=g.A.POST,a.path="".concat((0,g.a6)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),a.params={reaction:s},a}return(0,g._)(t,e),t}(g.f),eZ=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new v.R(n),r}return(0,g._)(t,e),t}(g.h),eX=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.reactionKey,a=e.call(this)||this;return a.method=g.A.DELETE,a.path="".concat((0,g.a6)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),a.params={reaction:s},a}return(0,g._)(t,e),t}(g.f),eJ=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new v.R((0,g.g)({},n)),r}return(0,g._)(t,e),t}(g.h),e$=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.translationTargetLanguages,a=e.call(this)||this;return a.method=g.A.POST,a.path="".concat((0,g.a6)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i),"/translation"),a.params={target_langs:s},a}return(0,g._)(t,e),t}(g.f),e0=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new v.U(t,n),r}return(0,g._)(t,e),t}(g.h),e1=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===g.$.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map(function(e){return e.userId})));var s=t.channelType,a=t.channelUrl;return r.method=g.A.POST,r.path="".concat((0,g.a6)(s),"/").concat(encodeURIComponent(a),"/scheduled_messages"),r.params={req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:g.aw.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map(function(e){return v.c.payloadify(e)}),apple_critical_alert_options:v.A.payloadify(t.appleCriticalAlertOptions),target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption},r}return(0,g._)(t,e),t}(g.f),e2=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new v.U(t,n),r}return(0,g._)(t,e),t}(g.h),e3=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===g.$.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map(function(e){return e.userId})));var s=t.channelType,a=t.channelUrl;return r.method=g.A.POST,r.path="".concat((0,g.a6)(s),"/").concat(encodeURIComponent(a),"/scheduled_messages"),r.params={req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:g.aw.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:t.thumbnailSizes?t.thumbnailSizes.map(function(e){return v.T.payloadify(e)}):[],custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map(function(e){return v.c.payloadify(e)}),apple_critical_alert_options:v.A.payloadify(t.appleCriticalAlertOptions),push_option:t.pushNotificationDeliveryOption},r}return(0,g._)(t,e),t}(g.f),e4=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new v.F(t,n),r}return(0,g._)(t,e),t}(g.h),e6=function(e){function t(t){var n=t.pollId,r=t.title,i=t.data,s=t.allowUserSuggestion,a=t.allowMultipleVotes,o=t.closeAt,u=e.call(this)||this;return u.method=g.A.PUT,u.path="".concat(g.ap,"/").concat(encodeURIComponent(n)),u.params={title:r,data:i,allow_user_suggestion:s,allow_multiple_votes:a,close_at:o},u}return(0,g._)(t,e),t}(g.f),e5=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new g.a3(t,n),r}return(0,g._)(t,e),t}(g.h),e8=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=g.A.DELETE,r.path="".concat(g.ap,"/").concat(encodeURIComponent(n)),r}return(0,g._)(t,e),t}(g.f);p=g.h,(0,g._)(function(){return null!==p&&p.apply(this,arguments)||this},p);var e7=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=g.A.PUT,r.path="".concat(g.ap,"/").concat(encodeURIComponent(n),"/close"),r}return(0,g._)(t,e),t}(g.f),e9=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new g.a3(t,n),r}return(0,g._)(t,e),t}(g.h),te=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,s=t.optionText,a=e.call(this)||this;return a.method=g.A.POST,a.path="".concat(g.ap,"/").concat(encodeURIComponent(i),"/options"),a.params={channel_url:n,channel_type:r,text:s},a}return(0,g._)(t,e),t}(g.f),tt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new g.a3(t,n),r}return(0,g._)(t,e),t}(g.h),tn=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=t.optionText,s=e.call(this)||this;return s.method=g.A.PUT,s.path="".concat(g.ap,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),s.params={text:i},s}return(0,g._)(t,e),t}(g.f),tr=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new g.a3(t,n),r}return(0,g._)(t,e),t}(g.h),ti=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=e.call(this)||this;return i.method=g.A.DELETE,i.path="".concat(g.ap,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),i}return(0,g._)(t,e),t}(g.f);_=g.h,(0,g._)(function(){return null!==_&&_.apply(this,arguments)||this},_);var ts=function(e){function t(t){var n=t.reqId,r=t.channelType,i=t.channelUrl,s=t.pollId,a=t.pollOptionIds;return e.call(this,{code:"VOTE",ackRequired:!0,payload:(0,g.e)({req_id:n,channel_type:r===g.K.OPEN?"open_channels":"group_channels",channel_url:i,poll_id:s,option_ids:a})})||this}return(0,g._)(t,e),t}(g.a5),ta=function(e){function t(t,n,r){var i=e.call(this,t,"VOTE",r)||this;return i.event=null,i.channelUrl=null,i.channelType=null,i.event=new y.i(r),i.channelUrl=r.channel_url,i.channelType=r.channel_type,i}return(0,g._)(t,e),t}(g.W),to=2,tu=function(e){function t(t,n){var r,i,s,a,o=this;return(o=e.call(this,t)||this).url="",o.channelType=g.K.BASE,o.name="",o.coverUrl="",o.customType="",o.data="",o.isFrozen=!1,o.isEphemeral=!1,o.creator=null,o.createdAt=0,o._messageCollectionLastAccessedAt=0,o.url=n.channel_url,o.name=null!==(r=n.name)&&void 0!==r?r:"",o.coverUrl=null!==(i=n.cover_url)&&void 0!==i?i:"",o.customType=null!==(s=n.custom_type)&&void 0!==s?s:"",o.data=null!==(a=n.data)&&void 0!==a?a:"",o.isFrozen=!!(0,g.a)("boolean",n.freeze)&&n.freeze,o.isEphemeral=!!(0,g.a)("boolean",n.is_ephemeral)&&n.is_ephemeral,o.creator=n.created_by?new g.U(o._iid,n.created_by):null,o.createdAt=1e3*n.created_at,o._cachedMetaData=new Map,n.metadata&&n.ts&&Object.keys(n.metadata).forEach(function(e){o._cachedMetaData.set(e,{value:n.metadata[e],isRemoved:!1,updatedAt:n.ts})}),o}return(0,g._)(t,e),t.payloadify=function(t){return(0,g.e)((0,g.g)((0,g.g)({},e.payloadify.call(this,t)),{channel_url:t.url,name:t.name,cover_url:t.coverUrl,custom_type:t.customType,data:t.data,freeze:t.isFrozen,is_ephemeral:t.isEphemeral,created_by:g.U.payloadify(t.creator),created_at:t.createdAt/1e3}))},t.prototype.isGroupChannel=function(){return this.channelType===g.K.GROUP},t.prototype.isOpenChannel=function(){return this.channelType===g.K.OPEN},Object.defineProperty(t.prototype,"cachedMetaData",{get:function(){var e={};return this._cachedMetaData.forEach(,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messageCollectionLastAccessedAt",{get:function(){return this._messageCollectionLastAccessedAt},enumerable:!1,configurable:!0}),t.prototype._updateMessageCollectionLastAccessedAt=t.prototype._upsertCachedMetaData=function(e,t){var n=this;Object.keys(e).forEach(function(r){var i=n._cachedMetaData.get(r);(!i||i.updatedAt<=t)&&n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t})})},t.prototype._removeFromCachedMetaData=function(e,t){var n=this;e.forEach(function(e){var r=n._cachedMetaData.get(e);r&&r.updatedAt<t&&(r.isRemoved=!1,r.updatedAt=t)})},t.prototype._generateRequestId=t.prototype.isIdentical=t.prototype.isEqual=function(e){return(0,g.X)(this,e)},t.prototype.createOperatorListQuery=function(e){return void 0===e&&(e={}),new X(this._iid,this.url,this.channelType,e)},t.prototype.createMutedUserListQuery=function(e){return void 0===e&&(e={}),new ee(this._iid,this.url,this.channelType,e)},t.prototype.createBannedUserListQuery=function(e){return void 0===e&&(e={}),new er(this._iid,this.url,this.channelType,e)},t.prototype.createPreviousMessageListQuery=function(e){return void 0===e&&(e={}),new v.d(this._iid,this.url,this.channelType,e)},t.prototype.addOperators=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return(0,g.q)((0,g.l)("string",e)).throw(g.S.invalidParameters),t=g.V.of(this._iid).requestQueue,n=new ei({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2]}})})},t.prototype.removeOperators=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return(0,g.q)((0,g.l)("string",e)).throw(g.S.invalidParameters),t=g.V.of(this._iid).requestQueue,n=new es({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2]}})})},t.prototype.getMyMutedInfo=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t,n,r,i,s,a;return(0,g.c)(this,function(o){switch(o.label){case 0:return t=(e=g.V.of(this._iid)).sdkState,n=e.requestQueue,r=new ea({channelUrl:this.url,channelType:this.channelType,userId:t.userId}),[4,n.send(r)];case 1:return s=(i=o.sent().as(eo)).isMuted,a=i.startAt,[2,{isMuted:s,startAt:a,endAt:i.endAt,remainingDuration:i.remainingDuration,description:i.description}]}})})},t.prototype.getMetaData=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n,r,i,s;return(0,g.c)(this,function(a){switch(a.label){case 0:return(0,g.q)((0,g.l)("string",e)).throw(g.S.invalidParameters),t=g.V.of(this._iid).requestQueue,n=new eu({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return i=(r=a.sent().as(ec)).metadata,s=r.ts,this._upsertCachedMetaData(i,s),[2,i]}})})},t.prototype.getAllMetaData=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t,n,r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return e=g.V.of(this._iid).requestQueue,t=new eu({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return r=(n=s.sent().as(ec)).metadata,i=n.ts,this._upsertCachedMetaData(r,i),[2,r]}})})},t.prototype.createMetaData=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return t=g.V.of(this._iid).requestQueue,n=new el({channelUrl:this.url,channelType:this.channelType,metadata:e}),[4,t.send(n)];case 1:return r=i.sent().as(eh).metaData,this._upsertCachedMetaData(r,0),[2,r]}})})},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),(0,g.b)(this,void 0,void 0,function(){var n,r,i,s,a;return(0,g.c)(this,function(o){switch(o.label){case 0:return n=g.V.of(this._iid).requestQueue,r=new ed({channelUrl:this.url,channelType:this.channelType,metadata:e,upsert:t}),[4,n.send(r)];case 1:return s=(i=o.sent().as(ef)).metadata,a=i.ts,this._upsertCachedMetaData(s,a),[2,s]}})})},t.prototype.deleteMetaData=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return(0,g.q)((0,g.a)("string",e)).throw(g.S.invalidParameters),t=g.V.of(this._iid).requestQueue,n=new e_({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r=i.sent().as(em).ts,this._removeFromCachedMetaData([e],r),[2]}})})},t.prototype.deleteAllMetaData=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return e=g.V.of(this._iid).requestQueue,t=new eg({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n=r.sent().as(ev).ts,this._removeFromCachedMetaData((0,g.o)([],(0,g.p)(this._cachedMetaData.keys()),!1),n),[2]}})})},t.prototype.getMetaCounters=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return(0,g.q)((0,g.l)("string",e)).throw(g.S.invalidParameters),t=g.V.of(this._iid).requestQueue,n=new ey({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return[2,r.sent().as(eb).metaCounter]}})})},t.prototype.getAllMetaCounters=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t;return(0,g.c)(this,function(n){switch(n.label){case 0:return e=g.V.of(this._iid).requestQueue,t=new ey({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return[2,n.sent().as(eb).metaCounter]}})})},t.prototype.createMetaCounters=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return t=g.V.of(this._iid).requestQueue,n=new eE({channelUrl:this.url,channelType:this.channelType,metaCounter:e}),[4,t.send(n)];case 1:return[2,r.sent().as(ew).metaCounter]}})})},t.prototype.updateMetaCounters=function(e,t){return void 0===t&&(t=!1),(0,g.b)(this,void 0,void 0,function(){var n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return n=g.V.of(this._iid).requestQueue,r=new eI({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:t}),[4,n.send(r)];case 1:return[2,i.sent().as(eT).metaCounter]}})})},t.prototype.increaseMetaCounters=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return t=g.V.of(this._iid).requestQueue,n=new eI({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"increase"}),[4,t.send(n)];case 1:return[2,r.sent().as(eT).metaCounter]}})})},t.prototype.decreaseMetaCounters=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return t=g.V.of(this._iid).requestQueue,n=new eI({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"decrease"}),[4,t.send(n)];case 1:return[2,r.sent().as(eT).metaCounter]}})})},t.prototype.deleteMetaCounter=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return(0,g.q)((0,g.a)("string",e)).throw(g.S.invalidParameters),t=g.V.of(this._iid).requestQueue,n=new eA({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r.sent(),[2]}})})},t.prototype.deleteAllMetaCounters=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t;return(0,g.c)(this,function(n){switch(n.label){case 0:return e=g.V.of(this._iid).requestQueue,t=new eN({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n.sent(),[2]}})})},t.prototype.muteUser=function(e,t,n){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(r){return[2,this.muteUserWithUserId(e.userId,t,n)]})})},t.prototype.muteUserWithUserId=function(e,t,n){return(0,g.b)(this,void 0,void 0,function(){var r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return(0,g.q)((0,g.a)("string",e)&&(0,g.a)("number",t,!0)&&(0,g.a)("string",n,!0)).throw(g.S.invalidParameters),r=g.V.of(this._iid).requestQueue,i=new eC({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return s.sent(),[2]}})})},t.prototype.unmuteUser=function(e){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(t){return[2,this.unmuteUserWithUserId(e.userId)]})})},t.prototype.unmuteUserWithUserId=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return(0,g.q)((0,g.a)("string",e)).throw(g.S.invalidParameters),t=g.V.of(this._iid).requestQueue,n=new eO({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}})})},t.prototype.banUser=function(e,t,n){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(r){return[2,this.banUserWithUserId(e.userId,t,n)]})})},t.prototype.banUserWithUserId=function(e,t,n){return(0,g.b)(this,void 0,void 0,function(){var r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return(0,g.q)((0,g.a)("string",e)&&(0,g.a)("number",t,!0)&&(0,g.a)("string",n,!0)).throw(g.S.invalidParameters),r=g.V.of(this._iid).requestQueue,i=new eD({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return s.sent(),[2]}})})},t.prototype.unbanUser=function(e){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(t){return[2,this.unbanUserWithUserId(e.userId)]})})},t.prototype.unbanUserWithUserId=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return(0,g.q)((0,g.a)("string",e)).throw(g.S.invalidParameters),t=g.V.of(this._iid).requestQueue,n=new eL({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}})})},t.prototype.freeze=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t;return(0,g.c)(this,function(n){switch(n.label){case 0:return e=g.V.of(this._iid).requestQueue,t=new eP({channelUrl:this.url,channelType:this.channelType,freezing:!0}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!0,[2]}})})},t.prototype.unfreeze=function(){return(0,g.b)(this,void 0,void 0,function(){var e,t;return(0,g.c)(this,function(n){switch(n.label){case 0:return e=g.V.of(this._iid).requestQueue,t=new eP({channelUrl:this.url,channelType:this.channelType,freezing:!1}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!1,[2]}})})},t.prototype.getMessagesByMessageId=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n;return(0,g.c)(this,function(r){switch(r.label){case 0:return n=(0,g.g)((0,g.g)({},v.g),t),(0,g.q)((0,g.a)("number",e)&&(0,v.v)(n)).throw(g.S.invalidParameters),[4,v.b.of(this._iid).getMessagesByMessageId(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}})})},t.prototype.getMessagesByTimestamp=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n;return(0,g.c)(this,function(r){switch(r.label){case 0:return n=(0,g.g)((0,g.g)({},v.g),t),(0,g.q)((0,g.a)("number",e)&&(0,v.v)(n)).throw(g.S.invalidParameters),[4,v.b.of(this._iid).getMessagesByTimestamp(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}})})},t.prototype.getMessageChangeLogsSinceTimestamp=function(e,t){return void 0===t&&(t={}),(0,g.b)(this,void 0,void 0,function(){var n;return(0,g.c)(this,function(r){switch(r.label){case 0:return n=(0,g.g)((0,g.g)({},v.h),t),(0,g.q)((0,g.a)("number",e)&&(0,v.i)(n)).throw(g.S.invalidParameters),[4,v.b.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}})})},t.prototype.getMessageChangeLogsSinceToken=function(e,t){return void 0===t&&(t={}),(0,g.b)(this,void 0,void 0,function(){var n;return(0,g.c)(this,function(r){switch(r.label){case 0:return n=(0,g.g)((0,g.g)({},v.h),t),(0,g.q)((0,g.a)("string",e)&&(0,v.i)(n)).throw(g.S.invalidParameters),[4,v.b.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}})})},t.prototype._createPendingSendableMessagePayload=function(e,t,n){var r=g.V.of(this._iid).sessionManager;return(0,g.e)({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:e.parentMessageId,data:e.data,custom_type:e.customType,mention_type:e.mentionType,sorted_metaarray:e.metaArrays?e.metaArrays.map(function(e){return v.c.payloadify(e)}):null,apple_critical_alert_options:e.appleCriticalAlertOptions?v.A.payloadify(e.appleCriticalAlertOptions):null,created_at:n,user:v.e.payloadify(r.currentUser),req_id:t,request_state:g.a0.PENDING,mentioned_user_ids:e.mentionedUserIds,mentioned_users:e.mentionedUsers})},t.prototype._createPendingUserMessage=function(e,t,n){var r,i,s={};if(e.translationTargetLanguages)try{for(var a=(0,g.G)(e.translationTargetLanguages),o=a.next();!o.done;o=a.next())s[o.value]=""}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}var u=(0,g.e)((0,g.g)((0,g.g)({},this._createPendingSendableMessagePayload(e,t,n)),{type:g.Y.USER,message:e.message,translations:s})),c=new v.U(this._iid,u);return c.messageParams=e,c},t.prototype._createPendingScheduledUserMessage=function(e,t,n){var r=this._createPendingUserMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r},t.prototype._createPendingFileMessage=function(e,t,n){var r=(0,g.e)((0,g.g)((0,g.g)({},this._createPendingSendableMessagePayload(e,t,n)),{type:g.Y.FILE,url:e.fileUrl,file:{name:e.fileName,size:e.fileSize,type:e.mimeType,data:e.data},thumbnails:e.thumbnailSizes?e.thumbnailSizes.map(:[]})),i=new v.F(this._iid,r);return i.messageParams=e,i},t.prototype._createPendingScheduledFileMessage=function(e,t,n){var r=this._createPendingFileMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r},t.prototype._markMessageAsFailed=function(e,t,n){void 0===n&&(n=!1),e.errorCode=t.code,t.code===g.a8.REQUEST_CANCELED?e.sendingStatus=g.a0.CANCELED:n||(e.sendingStatus=g.a0.FAILED)},t.prototype.sendUserMessage=function(e){var t=(0,g.g)((0,g.g)({},R),e);return(0,g.q)(D(t)).throw(g.S.invalidParameters),this._sendUserMessage(t)},t.prototype._sendUserMessage=function(e,t){var n=this;void 0===t&&(t=null);var r=g.V.of(this._iid),i=r.dispatcher,s=r.requestQueue,a=t,o=Date.now(),u=new v.f;a||(a=this._generateRequestId(),(0,g.a9)(2).then(function(){var t=n._createPendingUserMessage(e,a,o);i.dispatch(new g.ae({messages:[t],source:g.ad.EVENT_MESSAGE_SENT_PENDING})),(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,u._trigger(null,t)]})})})}));var c=new ez((0,g.g)((0,g.g)({},e),{channelUrl:this.url,channelType:this.channelType,reqId:a}));return s.send(c).then(function(e){var t=e.as(eG).message;i.dispatch(new g.ae({messages:[t],source:g.ad.EVENT_MESSAGE_SENT_SUCCESS})),(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,u._trigger(null,t)]})})})}).catch(function(t){if((0,g.ax)(t))throw t;(0,g.a9)(2).then(function(){var r=n._createPendingUserMessage(e,a,o),s=g.V.of(n._iid).cacheContext.localCacheEnabled&&(0,g.am)(t.code);n._markMessageAsFailed(r,t,s),i.dispatch(new g.ae({messages:[r],source:r.sendingStatus===g.a0.PENDING?g.ad.REQUEST_RESEND_MESSAGE:g.ad.EVENT_MESSAGE_SENT_FAILED})),(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,u._trigger(t,r)]})})})})}),u},t.prototype._autoResendUserMessage=function(e){return(0,g.q)(e instanceof v.U).throw(g.S.invalidParameters),this._sendUserMessage(e.messageParams,e.reqId)},t.prototype.resendUserMessage=function(e){var t;return(0,g.b)(this,void 0,void 0,function(){var n,r;return(0,g.c)(this,function(i){var s;return(0,g.q)(e instanceof v.U&&!e.scheduledInfo).throw(g.S.invalidParameters),n=new g.aa,r=null!==(t=e.messageParams)&&void 0!==t?t:(0,g.e)({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,mentionedMessageTemplate:e.mentionedMessageTemplate,metaArrays:e.metaArrays,pollId:null===(s=e.poll)||void 0===s?void 0:s.id,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,message:e.message,translationTargetLanguages:Object.keys(e.translations)}),this._sendUserMessage(r,e.reqId).onFailed(function(e){return n.reject(e)}).onSucceeded(function(e){return n.resolve(e)}),[2,n.promise]})})},t.prototype.updateUserMessage=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return n=(0,g.g)((0,g.g)({},K),t),(0,g.q)((0,g.a)("number",e)&&Q(n)).throw(g.S.invalidParameters),r=g.V.of(this._iid).requestQueue,i=new eH((0,g.g)({channelType:this.channelType,channelUrl:this.url,messageId:e},n)),[4,r.send(i)];case 1:return[2,s.sent().as(eB).message]}})})},t.prototype.copyUserMessage=function(e,n){var r,i,s;return(0,g.b)(this,void 0,void 0,function(){var a,o;return(0,g.c)(this,function(u){return(0,g.q)(e instanceof t&&n instanceof v.U&&n.sendingStatus===g.a0.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(g.S.invalidParameters),(0,g.q)(!n.poll).throw(g.S.notSupportedError),a=new g.aa,o=null!==(r=n.messageParams)&&void 0!==r?r:(0,g.g)((0,g.g)({},n),{mentionType:n.mentionType,mentionedUserIds:null!==(i=n.mentionedUserIds)&&void 0!==i?i:null===(s=n.mentionedUsers)||void 0===s?void 0:s.map(function(e){return e.userId}),translationTargetLanguages:Object.keys(n.translations),pushNotificationDeliveryOption:g.a4.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1}),e._sendUserMessage(o).onSucceeded(function(e){a.resolve(e)}).onFailed(function(e){return a.reject(e)}),[2,a.promise]})})},t.prototype.translateUserMessage=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return(0,g.q)(e instanceof v.U&&e.messageId>0&&(0,g.l)("string",t)).throw(g.S.invalidParameters),n=g.V.of(this._iid).requestQueue,r=new e$({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,translationTargetLanguages:t}),[4,n.send(r)];case 1:return[2,i.sent().as(e0).message]}})})},t.prototype._createScheduledUserMessage=function(e,t){var n=this,r=g.V.of(this._iid).requestQueue,i=Date.now(),s=this._generateRequestId();(0,g.a9)(2).then(function(){var r=n._createPendingScheduledUserMessage(e,s,i);(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,t._trigger(null,r)]})})})});var a=new e1((0,g.g)({reqId:s,channelType:this.channelType,channelUrl:this.url},e));r.send(a).then(function(e){var r=e.as(e2).message;(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,t._trigger(null,r)]})})})}).catch(function(r){if((0,g.ax)(r))throw r;(0,g.a9)(2).then(function(){var a=n._createPendingScheduledUserMessage(e,s,i);n._markMessageAsFailed(a,r),(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,t._trigger(r,a)]})})})})})},t.prototype.sendFileMessage=function(e){var t=(0,g.g)((0,g.g)({},q),e);return(0,g.q)(F(t)).throw(g.S.invalidParameters),this._sendFileMessage(t)},t.prototype._sendFileMessage=function(e,t){var n=this;void 0===t&&(t=null);var r=g.V.of(this._iid).dispatcher,i=v.b.of(this._iid).fileMessageQueue,s=t,a=Date.now(),o=new v.f;return s||(s=this._generateRequestId(),(0,g.a9)(2).then(function(){var t=n._createPendingFileMessage(e,s,a);r.dispatch(new g.ae({messages:[t],source:g.ad.EVENT_MESSAGE_SENT_PENDING})),(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,o._trigger(null,t)]})})})})),i.request(this,s,e).then(function(e){r.dispatch(new g.ae({messages:[e],source:g.ad.EVENT_MESSAGE_SENT_SUCCESS})),(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(t){return[2,o._trigger(null,e)]})})})}).catch(function(t){if((0,g.ax)(t))throw t;(0,g.a9)(2).then(function(){var i=n._createPendingFileMessage(e,s,a),u=g.V.of(n._iid).cacheContext.localCacheEnabled&&(0,g.am)(t.code);n._markMessageAsFailed(i,t,u),r.dispatch(new g.ae({messages:[i],source:i.sendingStatus===g.a0.PENDING?g.ad.REQUEST_RESEND_MESSAGE:g.ad.EVENT_MESSAGE_SENT_FAILED})),(0,g.w)(function(){return(0,g.b)(n,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,o._trigger(t,i)]})})})})}),o},t.prototype._autoResendFileMessage=function(e){(0,g.q)(e instanceof v.F).throw(g.S.invalidParameters);var t=g.V.of(this._iid).logger;return t.debug("autoResendFileMessage pending",e),this._sendFileMessage(e.messageParams,e.reqId).onFailed(function(e){t.debug("autoResendFileMessage failed",e)}).onSucceeded(},t.prototype._createScheduledFileMessage=function(e,t,n,r){var i=this,s=g.V.of(this._iid).requestQueue,a=new e3((0,g.g)((0,g.g)({reqId:n,channelType:this.channelType,channelUrl:this.url},e),{fileUrl:e.fileUrl,requireAuth:e.requireAuth}));s.send(a).then(function(e){var n=e.as(e4).message;(0,g.w)(function(){return(0,g.b)(i,void 0,void 0,function(){return(0,g.c)(this,function(e){return[2,t._trigger(null,n)]})})})}).catch(function(s){if((0,g.ax)(s))throw s;(0,g.a9)(2).then(function(){var a=i._createPendingScheduledFileMessage(e,n,r);i._markMessageAsFailed(a,s),(0,g.w)(function(){return(0,g.b)(i,void 0,void 0,function(){return(0,g.c)(this,})})})})},t.prototype.sendFileMessages=function(e){(0,g.q)(e.every(function(e){return F((0,g.g)((0,g.g)({},q),e))})).throw(g.S.invalidParameters);var t,n,r=new v.f;try{for(var i=(0,g.G)(e),s=i.next();!s.done;s=i.next()){var a=s.value;this.sendFileMessage(a).onPending(function(e){return r._trigger(null,e)}).onFailed(.onSucceeded(}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},t.prototype.resendFileMessage=function(e,t){var n;return(0,g.b)(this,void 0,void 0,function(){var r,i,s;return(0,g.c)(this,function(a){var o,u,c;return r=Boolean(e.url)||(0,g.i)(t)||(0,g.i)(null===(n=e.messageParams)||void 0===n?void 0:n.file),(0,g.q)(e instanceof v.F&&r&&!e.scheduledInfo).throw(g.S.invalidParameters),i=new g.aa,o=e,void 0===(u=t)&&(u=null),s=o.messageParams?(!o.url&&(0,g.i)(u)&&(o.messageParams.file=u),o.messageParams):(0,g.e)({data:o.data,customType:o.customType,mentionType:o.mentionType,mentionedUsers:o.mentionedUsers,mentionedUserIds:o.mentionedUserIds,metaArrays:o.metaArrays,parentMessageId:o.parentMessageId,appleCriticalAlertOptions:o.appleCriticalAlertOptions,file:null!=u?u:null===(c=o.messageParams)||void 0===c?void 0:c.file,fileUrl:o.url,fileName:o.name,fileSize:o.size,mimeType:o.type,thumbnailSizes:o.thumbnails.map(function(e){return{maxWidth:e.width,maxHeight:e.height}})}),this._sendFileMessage(s,e.reqId).onFailed(function(e){return i.reject(e)}).onSucceeded(function(e){return i.resolve(e)}),[2,i.promise]})})},t.prototype.updateFileMessage=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return n=(0,g.g)((0,g.g)({},W),t),(0,g.q)((0,g.a)("number",e)&&j(n)).throw(g.S.invalidParameters),r=g.V.of(this._iid).requestQueue,i=new ej((0,g.g)({channelType:this.channelType,channelUrl:this.url,messageId:e},n)),[4,r.send(i)];case 1:return[2,s.sent().as(eK).message]}})})},t.prototype.cancelUploadingFileMessage=function(e){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(t){return(0,g.q)((0,g.a)("string",e)).throw(g.S.invalidParameters),v.b.of(this._iid).fileMessageQueue.cancel(this,e),[2,!0]})})},t.prototype.copyFileMessage=function(e,n){var r,i;return(0,g.b)(this,void 0,void 0,function(){var s,a;return(0,g.c)(this,function(o){return(0,g.q)(e instanceof t&&n instanceof v.F&&n.sendingStatus===g.a0.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(g.S.invalidParameters),s=new g.aa,a=(0,g.g)((0,g.g)({},n),{fileUrl:n.url,fileName:n.name,fileSize:n.size,mimeType:n.type,mentionType:n.mentionType,mentionedUserIds:null!==(r=n.mentionedUserIds)&&void 0!==r?r:null===(i=n.mentionedUsers)||void 0===i?void 0:i.map(function(e){return e.userId}),pushNotificationDeliveryOption:g.a4.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:n.thumbnails.map(function(e){return{maxWidth:e.width,maxHeight:e.height}}),requireAuth:n.requireAuth,isPinnedMessage:!1}),e._sendFileMessage(a).onSucceeded(function(e){return s.resolve(e)}).onFailed(function(e){return s.reject(e)}),[2,s.promise]})})},t.prototype.deleteMessage=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n;return(0,g.c)(this,function(r){switch(r.label){case 0:return(0,g.q)(e instanceof v.B).throw(g.S.invalidParameters),e.messageId>0?(t=g.V.of(this._iid).requestQueue,n=new eQ({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId}),[4,t.send(n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.addReaction=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return(0,g.q)(e instanceof v.B&&e.messageId>0&&(0,g.a)("string",t)).throw(g.S.invalidParameters),n=g.V.of(this._iid).requestQueue,r=new eY({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return[2,i.sent().as(eZ).reactionEvent]}})})},t.prototype.deleteReaction=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return(0,g.q)(e instanceof v.B&&e.messageId>0&&(0,g.a)("string",t)).throw(g.S.invalidParameters),n=g.V.of(this._iid).requestQueue,r=new eX({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return[2,i.sent().as(eJ).reactionEvent]}})})},t.prototype._updateUserMessageMetaArray=function(e,t,n,r){return(0,g.b)(this,void 0,void 0,function(){var i,s,a,o,u;return(0,g.c)(this,function(c){switch(c.label){case 0:return s=(i=g.V.of(this._iid)).dispatcher,a=i.requestQueue,o=new eH({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,a.send(o)];case 1:return u=c.sent().as(eB).message,s.dispatch(new g.ae({messages:[u],source:g.ad.EVENT_MESSAGE_UPDATED})),[2,u]}})})},t.prototype._updateFileMessageMetaArray=function(e,t,n,r){return(0,g.b)(this,void 0,void 0,function(){var i,s,a,o,u;return(0,g.c)(this,function(c){switch(c.label){case 0:return s=(i=g.V.of(this._iid)).dispatcher,a=i.requestQueue,o=new ej({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,a.send(o)];case 1:return u=c.sent().as(eK).message,s.dispatch(new g.ae({messages:[u],source:g.ad.EVENT_MESSAGE_UPDATED})),[2,u]}})})},t.prototype.createMessageMetaArrayKeys=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n;return(0,g.c)(this,function(r){return(0,g.q)(e instanceof v.B&&e.messageId>0&&(0,g.l)("string",t)).throw(g.S.invalidParameters),n=t.map(function(e){return new v.c({key:e})}),e instanceof v.F?[2,this._updateFileMessageMetaArray(e.messageId,n,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"add",!0)]})})},t.prototype.deleteMessageMetaArrayKeys=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n;return(0,g.c)(this,function(r){return(0,g.q)(e instanceof v.B&&e.messageId>0&&(0,g.l)("string",t)).throw(g.S.invalidParameters),n=t.map(,e instanceof v.F?[2,this._updateFileMessageMetaArray(e.messageId,n,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"remove",!0)]})})},t.prototype.addMessageMetaArrayValues=function(e,t){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(n){return(0,g.q)(e instanceof v.B&&e.messageId>0&&t.every(function(e){return e instanceof v.c})).throw(g.S.invalidParameters),e instanceof v.F?[2,this._updateFileMessageMetaArray(e.messageId,t,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"add",!0)]})})},t.prototype.removeMessageMetaArrayValues=function(e,t){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(n){return(0,g.q)(e instanceof v.B&&e.messageId>0&&t.every().throw(g.S.invalidParameters),e instanceof v.F?[2,this._updateFileMessageMetaArray(e.messageId,t,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"remove",!0)]})})},t.prototype.report=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r,i,s;return(0,g.c)(this,function(a){switch(a.label){case 0:return(0,g.q)((0,g.H)(z,e)&&(0,g.a)("string",t)).throw(g.S.invalidParameters),r=(n=g.V.of(this._iid)).sdkState,i=n.requestQueue,s=new eq({channelUrl:this.url,channelType:this.channelType,userId:r.userId,category:e,description:t}),[4,i.send(s)];case 1:return a.sent(),[2]}})})},t.prototype.reportUser=function(e,t,n){return(0,g.b)(this,void 0,void 0,function(){var r,i,s,a;return(0,g.c)(this,function(o){switch(o.label){case 0:return(0,g.q)(e instanceof g.U&&(0,g.H)(z,t)&&(0,g.a)("string",n)).throw(g.S.invalidParameters),i=(r=g.V.of(this._iid)).sdkState,s=r.requestQueue,a=new eF({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.userId,category:t,description:n}),[4,s.send(a)];case 1:return o.sent(),[2]}})})},t.prototype.reportMessage=function(e,t,n){return(0,g.b)(this,void 0,void 0,function(){var r,i,s,a;return(0,g.c)(this,function(o){switch(o.label){case 0:return(0,g.q)(e instanceof v.S&&(0,g.H)(z,t)&&(0,g.a)("string",n)).throw(g.S.invalidParameters),i=(r=g.V.of(this._iid)).sdkState,s=r.requestQueue,a=new eV({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.sender.userId,messageId:e.messageId,category:t,description:n}),[4,s.send(a)];case 1:return o.sent(),[2]}})})},t.prototype.updatePoll=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return(0,g.q)((0,g.a)("number",e)&&(0,g.a)("string",t.title,!0)&&(0,g.ar)(t.data)&&(0,g.a)("boolean",t.allowUserSuggestion,!0)&&(0,g.a)("boolean",t.allowMultipleVotes,!0)&&(0,g.a)("number",t.closeAt,!0)).throw(g.S.invalidParameters),n=g.V.of(this._iid).requestQueue,r=new e6((0,g.g)({pollId:e},t)),[4,n.send(r)];case 1:return[2,i.sent().as(e5).poll]}})})},t.prototype.deletePoll=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return t=(0,g.a)("number",e),(0,g.q)(t).throw(g.S.invalidParameters),n=g.V.of(this._iid).requestQueue,r=new e8({pollId:e}),[4,n.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.closePoll=function(e){return(0,g.b)(this,void 0,void 0,function(){var t,n,r;return(0,g.c)(this,function(i){switch(i.label){case 0:return t=(0,g.a)("number",e),(0,g.q)(t).throw(g.S.invalidParameters),n=g.V.of(this._iid).requestQueue,r=new e7({pollId:e}),[4,n.send(r)];case 1:return[2,i.sent().as(e9).poll]}})})},t.prototype.addPollOption=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return n=(0,g.a)("number",e)&&(0,g.a)("string",t)&&""!==t.trim(),(0,g.q)(n).throw(g.S.invalidParameters),r=g.V.of(this._iid).requestQueue,i=new te({channelUrl:this.url,channelType:this.channelType,pollId:e,optionText:t}),[4,r.send(i)];case 1:return[2,s.sent().as(tt).poll]}})})},t.prototype.updatePollOption=function(e,t,n){return(0,g.b)(this,void 0,void 0,function(){var r,i,s;return(0,g.c)(this,function(a){switch(a.label){case 0:return r=(0,g.a)("number",e)&&(0,g.a)("number",t)&&(0,g.a)("string",n)&&""!==n.trim(),(0,g.q)(r).throw(g.S.invalidParameters),i=g.V.of(this._iid).requestQueue,s=new tn({pollId:e,pollOptionId:t,optionText:n}),[4,i.send(s)];case 1:return[2,a.sent().as(tr).poll]}})})},t.prototype.deletePollOption=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r,i;return(0,g.c)(this,function(s){switch(s.label){case 0:return n=(0,g.a)("number",e)&&(0,g.a)("number",t),(0,g.q)(n).throw(g.S.invalidParameters),r=g.V.of(this._iid).requestQueue,i=new ti({pollId:e,pollOptionId:t}),[4,r.send(i)];case 1:return s.sent(),[2]}})})},t.prototype.votePoll=function(e,t){return(0,g.b)(this,void 0,void 0,function(){var n,r,i,s,a,o;return(0,g.c)(this,function(u){switch(u.label){case 0:return n=(0,g.a)("number",e)&&(0,g.l)("number",t),(0,g.q)(n).throw(g.S.invalidParameters),i=(r=g.V.of(this._iid)).requestQueue,s=r.dispatcher,a=new ts({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionIds:t}),[4,i.send(a)];case 1:return o=u.sent().as(ta).event,s.dispatch(new g.ay({event:o,source:g.ad.EVENT_POLL_VOTED})),[2,o]}})})},t.prototype.getPollChangeLogsSinceTimestamp=function(e){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(t){switch(t.label){case 0:return(0,g.q)((0,g.a)("number",e)).throw(g.S.invalidParameters),[4,y.b.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,t.sent()]}})})},t.prototype.getPollChangeLogsSinceToken=function(e){return(0,g.b)(this,void 0,void 0,function(){return(0,g.c)(this,function(t){switch(t.label){case 0:return(0,g.q)((0,g.a)("string",e,!0)),[4,y.b.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,t.sent()]}})})},t.prototype.createPollListQuery=function(e){return void 0===e&&(e=10),new y.P(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:e})},t.prototype.createPollVoterListQuery=function(e,t,n){return void 0===n&&(n=20),new y.a(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionId:t,limit:n})},t}(g.T)},78424:function(e,t,n){n.d(t,{A:function(){return g},B:function(){return w},F:function(){return U},I:function(){return h},M:function(){return ec},R:function(){return d},S:function(){return T},T:function(){return S},U:function(){return O},a:function(){return ea},b:function(){return ee},c:function(){return p},d:function(){return eo},e:function(){return I},f:function(){return et},g:function(){return z},h:function(){return H},i:function(){return B},j:function(){return l},k:function(){return P},l:function(){return R},m:function(){return o},n:function(){return a},o:function(){return C},p:function(){return D},q:function(){return en},v:function(){return G}});var r,i,s=n(35660),a=function(e){function t(t){var n=e.call(this)||this;if(n.method=s.A.POST,n.path="".concat(s.Q),n.params=(0,s.e)({file:t.file,channel_url:t.channelUrl}),t.thumbnailSizes)for(var r=0;r<t.thumbnailSizes.length;r++){var i=t.thumbnailSizes[r],a=i.maxWidth,o=i.maxHeight;n.params["thumbnail".concat(r+1)]="".concat(a,",").concat(o)}return n.requestId=t.requestId,n}return(0,s._)(t,e),t}(s.f),o=function(e){function t(t,n){var r,i,s,a=this;return(a=e.call(this,t,n)||this).url=n.url,a.fileSize=null!==(r=n.file_size)&&void 0!==r?r:0,a.thumbnailSizes=null!==(i=n.thumbnails)&&void 0!==i?i:[],a.requireAuth=null!==(s=n.require_auth)&&void 0!==s&&s,a}return(0,s._)(t,e),t}(s.h),u=function(e){function t(t,n){var r,i,a,o=this;return(o=e.call(this,t)||this).replyCount=0,o.mostRepliedUsers=null,o.lastRepliedAt=0,o.updatedAt=0,o.replyCount=null!==(r=n.reply_count)&&void 0!==r?r:0,o.mostRepliedUsers=n.hasOwnProperty("most_replies")&&(0,s.l)("object",n.most_replies)?n.most_replies.map(function(e){return new s.U(o._iid,e)}):[],o.lastRepliedAt=null!==(i=n.last_replied_at)&&void 0!==i?i:0,o.updatedAt=null!==(a=n.updated_at)&&void 0!==a?a:0,o}return(0,s._)(t,e),t.payloadify=function(t){return t?(0,s.e)((0,s.g)((0,s.g)({},e.payloadify.call(this,t)),{reply_count:t.replyCount,most_replies:Array.isArray(t.mostRepliedUsers)?t.mostRepliedUsers.map(function(e){return s.U.payloadify(e)}):[],last_replied_at:t.lastRepliedAt,updated_at:t.updatedAt})):null},t}(s.T);(c=i||(i={})).ADD="add",c.DELETE="delete";var c,l,h,d=function(e){this.messageId=0,this.userId=null,this.key=null,this.operation=null,this.updatedAt=0;var t=(0,s.a)("string",e.msg_id)?parseInt(e.msg_id):e.msg_id,n=e.user_id,r=e.operation?e.operation.toLowerCase():null,a=e.reaction,o=e.updated_at;t&&(0,s.a)("string",n)&&(0,s.a)("string",r)&&(0,s.H)(i,r)&&(0,s.a)("string",a)&&a&&(0,s.a)("number",o)&&(this.messageId=t,this.userId=n,this.key=a,this.operation=r,this.updatedAt=o)},f=function(){function e(e){var t,n,r,i=e.key,a=null!==(r=(0,s.o)([],(0,s.p)(e.user_ids),!1))&&void 0!==r?r:[],o=e.updated_at;(0,s.a)("string",i)&&i&&(0,s.l)("string",a)&&a.length>0&&(0,s.a)("number",o)&&(this.key=i,this.userIds=a,this.updatedAt=o);var u={};try{for(var c=(0,s.G)(this.userIds),l=c.next();!l.done;l=c.next())u[l.value]=this.updatedAt}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}this._version=u}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.userIds.length},enumerable:!1,configurable:!0}),e.payloadify=function(e){return e?(0,s.e)({key:e.key,user_ids:e.userIds,updated_at:e.updatedAt}):null},e.prototype.applyEvent=function(e){if(e.key===this.key&&this.updatedAt<=e.updatedAt){if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var t=this.userIds.indexOf(e.userId);switch(e.operation){case i.ADD:t<0&&this.userIds.push(e.userId);break;case i.DELETE:t>=0&&this.userIds.splice(t,1)}this._version[e.userId]=e.updatedAt}this.updatedAt=Math.max(this.updatedAt,e.updatedAt)}},e}(),p=function(){function e(e){this.key=e.key,this.value=(0,s.l)("string",e.value)?(0,s.o)([],(0,s.p)(e.value),!1):[]}return e.payloadify=function(e){var t;return e?(0,s.e)({key:e.key,value:null!==(t=e.value)&&void 0!==t?t:[]}):null},e}(),_=function(){function e(e){this.url=null,this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=e.url,e.hasOwnProperty("secure_url")&&(this.secureUrl=e.secure_url),e.hasOwnProperty("type")&&(this.type=e.type),e.hasOwnProperty("width")&&(this.width=e.width),e.hasOwnProperty("height")&&(this.height=e.height),e.hasOwnProperty("alt")&&(this.alt=e.alt)}return e.payloadify=function(e){var t,n;return e?(0,s.e)({url:e.url,secure_url:e.secureUrl,type:e.type,width:null!==(t=e.width)&&void 0!==t?t:0,height:null!==(n=e.height)&&void 0!==n?n:0,alt:e.alt}):null},e}(),m=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e.hasOwnProperty("og:title")&&(this.title=e["og:title"]),e.hasOwnProperty("og:url")&&(this.url=e["og:url"]),e.hasOwnProperty("og:description")&&(this.description=e["og:description"]),e.hasOwnProperty("og:image")&&(this.defaultImage=new _(e["og:image"]))}return e.payloadify=function(e){return e?(0,s.e)({"og:title":e.title,"og:url":e.url,"og:description":e.description,"og:image":e.defaultImage?_.payloadify(e.defaultImage):null}):null},e}(),g=function(){function e(e){var t,n;this.name=null,this.volume=0,this.name=null!==(t=e.name)&&void 0!==t?t:"default",this.volume=null!==(n=e.volume)&&void 0!==n?n:1}return e.prototype.serialize=e.payloadify=function(e){return e?(0,s.e)({name:e.name,volume:e.volume}):null},e}();(v=l||(l={})).PENDING="pending",v.SENT="sent",v.FAILED="failed",v.CANCELED="canceled",(y=h||(h={})).PENDING="pending",y.IN_QUEUE="in_queue",y.SENT="sent",y.FAILED="failed",y.CANCELED="canceled",y.REMOVED="removed";var v,y,b,E=w=function(e){function t(t,n){var r,i,a,o,c,l,h,d,_,v,y,b,E,w,I,T=this;(T=e.call(this,t)||this).channelUrl=null,T.channelType=s.K.BASE,T.messageId=0,T.parentMessageId=null,T.parentMessage=null,T.silent=!1,T.isOperatorMessage=!1,T.messageType=s.Y.BASE,T.data=null,T.customType=null,T.mentionType=null,T.mentionedUsers=[],T.mentionedUserIds=[],T.mentionedMessageTemplate=null,T.threadInfo=null,T.reactions=[],T.metaArrays=[],T.ogMetaData=null,T.appleCriticalAlertOptions=null,T.createdAt=0,T.updatedAt=0,T.scheduledInfo=null,T.extendedMessage={},T._isContinuousMessages=!1,T._scheduledStatus=null,T.messageId=null!==(i=null!==(r=n.msg_id)&&void 0!==r?r:n.message_id)&&void 0!==i?i:0,T.channelUrl=n.channel_url,T.channelType=(0,s.H)(s.K,n.channel_type)?n.channel_type:s.K.GROUP,n.channel&&(n.channel.channel_url&&(T.channelUrl=n.channel.channel_url),n.channel.channel_type&&(T.channelType=n.channel.channel_type)),T.parentMessageId=null!==(a="string"==typeof n.parent_message_id?parseInt(n.parent_message_id):n.parent_message_id)&&void 0!==a?a:0,T.data=null!==(o=n.data)&&void 0!==o?o:"",T.customType=null!==(c=n.custom_type)&&void 0!==c?c:"",T.mentionType=(0,s.H)(s.$,n.mention_type)?n.mention_type:null;var S=n.mentioned_users;T.mentionedUsers=S?S.map(function(e){return new s.U(T._iid,e)}):null;var A=n.mentioned_user_ids;T.mentionedUserIds=null!=A?A:null,T.mentionedUsers&&!T.mentionedUserIds&&(T.mentionedUserIds=T.mentionedUsers.map(function(e){return e.userId})),T.mentionedMessageTemplate=null!==(l=n.mentioned_message_template)&&void 0!==l?l:"",T.threadInfo=n.thread_info?new u(T._iid,n.thread_info):null,T.reactions=n.reactions?n.reactions.map(function(e){return new f(e)}):[];for(var N=null!==(h=n.metaarray)&&void 0!==h?h:{},C=null!==(d=n.metaarray_key_order)&&void 0!==d?d:Object.keys(N).sort(,k=0;k<C.length;k++){var O=C[k];T.metaArrays.push(new p({key:O,value:N[O]||[]}))}return n.sorted_metaarray&&(T.metaArrays=n.sorted_metaarray.map(function(e){return new p(e)})),T.ogMetaData=n.og_tag?new m(n.og_tag):null,T.silent=null!==(_=n.silent)&&void 0!==_&&_,T.isOperatorMessage=null!==(v=n.is_op_msg)&&void 0!==v&&v,T.appleCriticalAlertOptions=n.apple_critical_alert_options?new g(n.apple_critical_alert_options):null,T.createdAt=null!==(b=null!==(y=n.created_at)&&void 0!==y?y:n.ts)&&void 0!==b?b:0,T.updatedAt=null!==(E=n.updated_at)&&void 0!==E?E:0,"number"==typeof n.scheduled_message_id&&"number"==typeof n.scheduled_at&&n.scheduled_status&&(T.scheduledInfo={scheduledMessageId:n.scheduled_message_id,scheduledAt:n.scheduled_at},T._scheduledStatus=n.scheduled_status),T.extendedMessage=null!==(w=n.extended_message)&&void 0!==w?w:{},T._isContinuousMessages=null!==(I=n.is_continuous_messages)&&void 0!==I&&I,T}return(0,s._)(t,e),t.payloadify=function(t){var n,r,i,a;return t?(0,s.e)((0,s.g)((0,s.g)({},e.payloadify.call(this,t)),{channel_url:t.channelUrl,channel_type:t.channelType,message_id:t.messageId,type:E(t.messageType),parent_message_id:t.parentMessageId,data:t.data,custom_type:t.customType,mention_type:t.mentionType,mentioned_user_ids:t.mentionedUserIds,mentioned_users:null===(n=t.mentionedUsers)||void 0===n?void 0:n.map(function(e){return s.U.payloadify(e)}),mentioned_message_template:t.mentionedMessageTemplate,thread_info:t.threadInfo?u.payloadify(t.threadInfo):null,reactions:t.reactions.map(function(e){return f.payloadify(e)}),sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map(function(e){return p.payloadify(e)}),og_tag:m.payloadify(t.ogMetaData),silent:t.silent,is_op_msg:t.isOperatorMessage,apple_critical_alert_options:g.payloadify(t.appleCriticalAlertOptions),created_at:t.createdAt,updated_at:t.updatedAt,scheduled_message_id:null===(i=t.scheduledInfo)||void 0===i?void 0:i.scheduledMessageId,scheduled_at:null===(a=t.scheduledInfo)||void 0===a?void 0:a.scheduledAt,scheduled_status:t._scheduledStatus,extended_message:t.extendedMessage})):null},t.prototype.isIdentical=t.prototype.isEqual=t.prototype.isUserMessage=function(){return this.messageType===s.Y.USER},t.prototype.isFileMessage=function(){return this.messageType===s.Y.FILE},t.prototype.isAdminMessage=function(){return this.messageType===s.Y.ADMIN},t.prototype.serialize=t.prototype.getMetaArraysByKeys=t.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(this.threadInfo=e.threadInfo),!1},t.prototype.applyReactionEvent=function(e){if(this.messageId===e.messageId){for(var t=!1,n=0;n<this.reactions.length;n++)if(this.reactions[n].key===e.key){this.reactions[n].applyEvent(e),this.reactions[n].isEmpty&&this.reactions.splice(n,1),t=!0;break}t||"add"!==e.operation||this.reactions.push(new f(f.payloadify({key:e.key,userIds:[e.userId],updatedAt:e.updatedAt})))}},t.prototype.applyParentMessage=function(e){if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0}return!1},t}(s.T),I=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.role=null,r.isBlockedByMe=!1,r.role=(0,s.H)(s.R,n.role)?n.role:s.R.NONE,n.hasOwnProperty("is_blocked_by_me")&&(r.isBlockedByMe=n.is_blocked_by_me),r}return(0,s._)(t,e),t.payloadify=function(t){return t?(0,s.e)((0,s.g)((0,s.g)({},e.payloadify.call(this,t)),{role:t.role,is_blocked_by_me:t.isBlockedByMe})):null},t}(s.U),T=function(e){function t(t,n){var r,i,a,o,u=this;if((u=e.call(this,t,n)||this).sender=null,u.reqId="",u.replyToChannel=!1,u.sendingStatus=null,u.errorCode=0,u.sender=n.user?new I(u._iid,n.user):n.sender_id,u.reqId=null!==(i=null!==(r=n.req_id)&&void 0!==r?r:n.request_id)&&void 0!==i?i:"",u.replyToChannel=null!==(a=n.is_reply_to_channel)&&void 0!==a&&a,n.request_state&&(0,s.H)(s.a0,n.request_state)&&(u.sendingStatus=n.request_state),!u.sendingStatus){if(u.messageId>0)u.sendingStatus=s.a0.SUCCEEDED;else if(u.scheduledInfo)switch(u._scheduledStatus=n.scheduled_status,n.scheduled_status){case h.SENT:case h.IN_QUEUE:u.sendingStatus=s.a0.SUCCEEDED;break;case h.PENDING:u.sendingStatus=s.a0.SCHEDULED;break;case h.FAILED:case h.REMOVED:u.sendingStatus=s.a0.FAILED;break;case h.CANCELED:u.sendingStatus=s.a0.CANCELED}else u.sendingStatus=s.a0.PENDING}return u.errorCode=null!==(o=n.error_code)&&void 0!==o?o:0,u}return(0,s._)(t,e),t.payloadify=function(t){return t?(0,s.e)((0,s.g)((0,s.g)({},e.payloadify.call(this,t)),{user:I.payloadify(t.sender),req_id:t.reqId,is_reply_to_channel:t.replyToChannel,request_state:t.sendingStatus,error_code:t.errorCode})):null},Object.defineProperty(t.prototype,"isResendable",{get:function(){return this.sendingStatus===s.a0.FAILED&&(0,s.a1)(this.errorCode)},enumerable:!1,configurable:!0}),t.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId},t}(w),S=function(){function e(e){var t,n;this.url=null,this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this.url=e.url,this.width=e.width,this.height=e.height,this.realWidth=null!==(t=e.real_width)&&void 0!==t?t:e.width,this.realHeight=null!==(n=e.real_height)&&void 0!==n?n:e.height}return e.payloadify=function(e){return e?(0,s.e)({url:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}):null},Object.defineProperty(e.prototype,"plainUrl",{get:enumerable:!1,configurable:!0}),e}(),A={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:s.a2.ALL,customTypesFilter:null,senderUserIdsFilter:null,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},N=function(e){return(0,s.a)("number",e.prevResultSize)&&(0,s.a)("number",e.nextResultSize)&&(0,s.a)("boolean",e.isInclusive)&&(0,s.a)("boolean",e.reverse)&&(0,s.a)("string",e.messageTypeFilter)&&(0,s.H)(s.a2,e.messageTypeFilter)&&(0,s.l)("string",e.customTypesFilter,!0)&&(0,s.l)("string",e.senderUserIdsFilter,!0)&&(0,s.a)("boolean",e.includeMetaArray)&&(0,s.a)("boolean",e.includeReactions)&&(0,s.a)("boolean",e.includeParentMessageInfo)},C=function(e){function t(t,n){var r,i,a,o,u=this;if((u=e.call(this,t,n)||this).message=null,u.translations={},u.message=null!==(r=n.message)&&void 0!==r?r:"",u.messageType=s.Y.ADMIN,u.translations=null!==(i=n.translations)&&void 0!==i?i:{},n.parent_message_info){var c=n.parent_message_info,l=(0,s.g)((0,s.g)({},c),{message_id:u.parentMessageId,channel_url:u.channelUrl,channel_type:u.channelType,file:c.file,url:null===(a=c.file)||void 0===a?void 0:a.url,require_auth:null===(o=c.file)||void 0===o?void 0:o.require_auth});u.parentMessage=D(t,l)}return u}return(0,s._)(t,e),t.payloadify=function(t){return t?(0,s.e)((0,s.g)((0,s.g)({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,parent_message_info:R(t.parentMessage)})):null},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return(0,s.b)(this,void 0,void 0,function(){var n;return(0,s.c)(this,function(r){switch(r.label){case 0:return n=(0,s.g)((0,s.g)({},A),t),(0,s.q)(this.messageId>0&&(0,s.a)("number",e)&&N(n)).throw(s.S.invalidParameters),[4,ee.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}})})},t}(w),k=function(){function e(e){var t,n;this.type=null,this.vendor=null,this.detail={},this.type=null!==(t=e.type)&&void 0!==t?t:"",this.vendor=null!==(n=e.vendor)&&void 0!==n?n:"",e.hasOwnProperty("detail")&&(0,s.a)("object",e.detail)&&!Array.isArray(e.detail)&&(this.detail=e.detail)}return e.payloadify=function(e){return e?(0,s.e)({type:e.type,vendor:e.vendor,detail:e.detail}):null},e}(),O=function(e){function t(t,n){var r,i,a,o,u,c,l,h=this;if((h=e.call(this,t,n)||this).message="",h.messageParams=null,h.translations={},h.translationTargetLanguages=[],h.messageSurvivalSeconds=-1,h.plugins=[],h._poll=null,h.message=n.message,h.messageType=s.Y.USER,h.translations=null!==(a=n.translations)&&void 0!==a?a:{},h.translationTargetLanguages=null!==(o=n.target_langs)&&void 0!==o?o:[],0===Object.keys(h.translations).length&&h.translationTargetLanguages.length>0)try{for(var d=(0,s.G)(h.translationTargetLanguages),f=d.next();!f.done;f=d.next()){var p=f.value;h.translations[p]=""}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}if(h.messageSurvivalSeconds=null!==(u=n.message_survival_seconds)&&void 0!==u?u:-1,h.plugins=n.plugins?n.plugins.map(function(e){return new k(e)}):[],h._poll=n.poll?new s.a3(h._iid,n.poll):null,n.parent_message_info){var _=n.parent_message_info,m=(0,s.g)((0,s.g)({},_),{created_at:_.ts,message_id:h.parentMessageId,channel_url:h.channelUrl,channel_type:h.channelType,file:_.file,url:null===(c=_.file)||void 0===c?void 0:c.url,require_auth:null===(l=_.file)||void 0===l?void 0:l.require_auth});h.parentMessage=D(t,(0,s.e)(m))}return h}return(0,s._)(t,e),t.payloadify=function(t){return t?(0,s.e)((0,s.g)((0,s.g)({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,message_survival_seconds:t.messageSurvivalSeconds,plugins:t.plugins.map(function(e){return k.payloadify(e)}),poll:s.a3.payloadify(t._poll),parent_message_info:R(t.parentMessage)})):null},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return(0,s.b)(this,void 0,void 0,function(){var n;return(0,s.c)(this,function(r){switch(r.label){case 0:return n=(0,s.g)((0,s.g)({},A),t),(0,s.q)(this.messageId>0&&(0,s.a)("number",e)&&N(n)).throw(s.S.invalidParameters),[4,ee.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}})})},t.prototype.applyPoll=function(e){return!(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt)&&(this._poll=e,!0)},Object.defineProperty(t.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),t}(T),R=function(e){if(e)switch(e.messageType){case s.Y.USER:return O.payloadify(e);case s.Y.FILE:return U.payloadify(e);case s.Y.ADMIN:return C.payloadify(e)}return null},D=function(e,t){switch(t.type){case"MESG":return new O(e,t);case"FILE":return new U(e,t);case"ADMM":case"BRDM":return new C(e,t)}return null},U=function(e){function t(t,n){var r,i,a,o,u,c,l,h,d,f,p,_,m,g,v,y=this;(y=e.call(this,t,n)||this).messageParams=null,y.plainUrl="",y.requireAuth=!1,y.name=null,y.size=0,y.type=null,y.thumbnails=[],y.messageSurvivalSeconds=-1,y.messageType=s.Y.FILE;var b=null!==(r=n.file)&&void 0!==r?r:null;y.plainUrl=(null!==(a=null!==(i=null==b?void 0:b.url)&&void 0!==i?i:n.url)&&void 0!==a?a:"").split("?auth=")[0],y.name=null!==(u=null!==(o=null==b?void 0:b.name)&&void 0!==o?o:n.name)&&void 0!==u?u:"File",y.size=null!==(l=null!==(c=null==b?void 0:b.size)&&void 0!==c?c:n.size)&&void 0!==l?l:0,y.data=null!==(d=null!==(h=null==b?void 0:b.data)&&void 0!==h?h:n.custom)&&void 0!==d?d:"",y.type=b?null!==(f=b.type)&&void 0!==f?f:"":null!==(p=n.type)&&void 0!==p?p:"";var E=s.V.of(y._iid).sessionManager;if(y.requireAuth=null!==(_=n.require_auth)&&void 0!==_&&_,y.thumbnails=n.thumbnails?n.thumbnails.map(function(e){return new S((0,s.g)((0,s.g)({},e),{url:"".concat(e.url.split("?auth=")[0]).concat(y.requireAuth?"?auth=".concat(E.ekey):"")}))}):[],y.messageSurvivalSeconds=null!==(m=n.message_survival_seconds)&&void 0!==m?m:-1,n.parent_message_info){var w=n.parent_message_info,I=(0,s.g)((0,s.g)({},w),{message_id:y.parentMessageId,channel_url:y.channelUrl,channel_type:y.channelType,file:w.file,url:null===(g=w.file)||void 0===g?void 0:g.url,require_auth:null===(v=w.file)||void 0===v?void 0:v.require_auth});y.parentMessage=D(t,I)}return y}return(0,s._)(t,e),t.payloadify=function(t){return t?(0,s.e)((0,s.g)((0,s.g)({},e.payloadify.call(this,t)),{url:t.plainUrl,require_auth:t.requireAuth,file:{name:t.name,size:t.size,type:t.type,data:t.data},thumbnails:t.thumbnails.map(,message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:R(t.parentMessage)})):null},Object.defineProperty(t.prototype,"url",{get:function(){var e=s.V.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return(0,s.b)(this,void 0,void 0,function(){var n;return(0,s.c)(this,function(r){switch(r.label){case 0:return n=(0,s.g)((0,s.g)({},A),t),(0,s.q)(this.messageId>0&&(0,s.a)("number",e)&&N(n)).throw(s.S.invalidParameters),[4,ee.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}})})},t}(T),L=function(e){function t(t){var n,r,i,a=[];return t.mentionType===s.$.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map(function(e){return e.userId}))),e.call(this,{code:"FILE",ackRequired:!0,payload:(0,s.e)({channel_url:t.channelUrl,url:t.url,name:null!==(n=t.fileName)&&void 0!==n?n:"",type:null!==(r=t.mimeType)&&void 0!==r?r:"",size:null!==(i=t.fileSize)&&void 0!==i?i:0,custom:t.data,custom_type:t.customType,thumbnails:t.thumbnailSizes,require_auth:t.requireAuth,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:a,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==s.a4.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId>0?t.parentMessageId:null,req_id:t.reqId,pin_message:t.isPinnedMessage})})||this}return(0,s._)(t,e),t}(s.a5),M=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];return t.mentionType===s.$.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map(function(e){return e.userId}))),r.method=s.A.POST,r.path="".concat((0,s.a6)(t.channelType),"/").concat(encodeURIComponent(t.channelUrl),"/messages"),r.params=(0,s.e)({message_type:s.Y.FILE,user_id:t.userId,url:t.fileUrl,mention_type:t.mentionType,mentioned_user_ids:i,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,data:t.data,custom_type:t.customType,thumbnails:t.thumbnailSizes.map(function(e){return S.payloadify(e)}),require_auth:t.requireAuth,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map(function(e){return p.payloadify(e)}),push_option:t.pushNotificationDeliveryOption,parent_message_id:t.parentMessageId>0?t.parentMessageId:null,apple_critical_alert_options:g.payloadify(t.appleCriticalAlertOptions),reply_to_channel:t.isReplyToChannel,req_id:t.reqId,pin_message:t.isPinnedMessage}),r}return(0,s._)(t,e),t}(s.f),P=function(e){function t(t,n,r){var i,a,o,u=this;(u=e.call(this,t,"FILE",r)||this).message=new U(t,r);var c=s.V.of(t).sdkState;return u.isMentioned=(0,s.a7)(u.message.mentionType,null!==(i=u.message.mentionedUserIds)&&void 0!==i?i:null===(a=u.message.mentionedUsers)||void 0===a?void 0:a.map(function(e){return e.userId}),c.userId),u.forceUpdateLastMessage=null!==(o=r.force_update_last_message)&&void 0!==o&&o,u}return(0,s._)(t,e),t}(s.W),x=function(e){function t(t,n){var r,i,a=this;(a=e.call(this,t,n)||this).message=new U(t,n);var o=s.V.of(t).sdkState;return a.isMentioned=(0,s.a7)(a.message.mentionType,null!==(r=a.message.mentionedUserIds)&&void 0!==r?r:a.message.mentionedUsers.map(function(e){return e.userId}),o.userId),a.forceUpdateLastMessage=null!==(i=n.force_update_last_message)&&void 0!==i&&i,a}return(0,s._)(t,e),t}(s.h);(q=b||(b={}))[q.PENDING=0]="PENDING",q[q.UPLOADING=1]="UPLOADING",q[q.UPLOADED=2]="UPLOADED",q[q.SENDING=3]="SENDING",q[q.FAILED=4]="FAILED";var q,F,V=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,a=t.onlineDetector,o=t.cacheContext,u=this;this._queueMap=new Map,this._connectionState=null,this._onlineDetector=null,this._iid=e,this._sdkState=n,this._requestQueue=i,this._cacheContext=o,this._dispatcher=r,this._dispatcher.on(function(e){e instanceof s.s&&(u._connectionState=e.stateType)}),this._onlineDetector=a}return Object.defineProperty(e.prototype,"_shouldSendThroughWebSocket",{get:enumerable:!1,configurable:!0}),e.prototype._sendFileMessage=function(e,t){return(0,s.b)(this,void 0,void 0,function(){var n;return(0,s.c)(this,function(r){switch(r.label){case 0:return this._shouldSendThroughWebSocket?(n=new L((0,s.g)((0,s.g)({},t.params),{channelUrl:e.url,channelType:e.channelType,url:t.params.fileUrl,requireAuth:t.requireAuth,reqId:t.requestId})),[4,this._requestQueue.send(n)]):[3,2];case 1:return[2,r.sent().as(P).message];case 2:return n=new M((0,s.g)((0,s.g)({},t.params),{channelUrl:e.url,channelType:e.channelType,url:t.params.fileUrl,userId:this._sdkState.userId,requireAuth:t.requireAuth,reqId:t.requestId})),[4,this._requestQueue.send(n)];case 3:return[2,r.sent().as(x).message]}})})},e.prototype._resolveMessageQueue=function(e){return(0,s.b)(this,void 0,void 0,function(){var t,n,r,i,a,o,u,c,l,h,d;return(0,s.c)(this,function(f){switch(f.label){case 0:if(!(t=this._queueMap.get(e.url)))return[3,21];if(t.isResolving)return[3,20];t.isResolving=!0,n=[],r=!0,f.label=1;case 1:f.trys.push([1,15,16,17]),a=(i=(0,s.G)(t.messageQueue)).next(),f.label=2;case 2:if(a.done)return[3,14];switch((o=a.value).state){case b.PENDING:case b.UPLOADING:return[3,3];case b.UPLOADED:return[3,4];case b.FAILED:return[3,12]}return[3,13];case 3:return r=!1,n.push(o),[3,13];case 4:if(!r)return[3,10];f.label=5;case 5:return f.trys.push([5,8,,9]),o.state=b.SENDING,[4,this._sendFileMessage(e,o)];case 6:return u=f.sent(),o.deferred.resolve(u),[4,(0,s.a9)(100)];case 7:return f.sent(),[3,9];case 8:return c=f.sent(),o.deferred.reject(c),[3,9];case 9:return[3,11];case 10:n.push(o),f.label=11;case 11:return[3,13];case 12:return o.deferred.reject(o.error.code===s.a8.REQUEST_CANCELED?s.S.fileUploadCanceled:o.error),[3,13];case 13:return a=i.next(),[3,2];case 14:return[3,17];case 15:return h={error:f.sent()},[3,17];case 16:try{a&&!a.done&&(d=i.return)&&d.call(i)}finally{if(h)throw h.error}return[7];case 17:return l=t.isResolveRequestPending,t.messageQueue=n,t.isResolving=!1,t.isResolveRequestPending=!1,l?[4,this._resolveMessageQueue(e)]:[3,19];case 18:f.sent(),f.label=19;case 19:return[3,21];case 20:t.isResolveRequestPending=!0,f.label=21;case 21:return[2]}})})},e.prototype._uploadNextPendingItem=function(e){return(0,s.b)(this,void 0,void 0,function(){var t,n,r,i,u,c,l,h,d,f,p,_,m;return(0,s.c)(this,function(g){switch(g.label){case 0:return(n=(t=this._queueMap.get(e.url)).messageQueue.find(function(e){return e.state===b.PENDING}))?(0,s.i)(n.params.file)?t.uploadQueue.length<6?(n.state=b.UPLOADING,t.uploadQueue.push(n),[4,this._onlineDetector.isOnline()]):[3,10]:[3,11]:[3,13];case 1:if(!g.sent())return[3,8];g.label=2;case 2:return g.trys.push([2,4,5,7]),r=new a({file:n.params.file,channelUrl:e.url,thumbnailSizes:n.params.thumbnailSizes,requestId:n.requestId}),[4,this._requestQueue.send(r)];case 3:return u=(i=g.sent().as(o)).url,l=void 0===(c=i.fileSize)?n.params.fileSize:c,d=void 0===(h=i.thumbnailSizes)?n.params.thumbnailSizes:h,p=void 0!==(f=i.requireAuth)&&f,n.params.fileUrl=u,n.params.fileSize=l,n.params.thumbnailSizes=d,n.params.requireAuth=p,n.requireAuth=p,n.state=b.UPLOADED,[3,7];case 4:return(_=g.sent()).code===s.a8.REQUEST_FAILED?n.error=new s.S({code:s.a8.NETWORK_ERROR,message:"Failed to upload a file."}):n.error=_,n.state=b.FAILED,[3,7];case 5:return(m=t.uploadQueue.findIndex(function(e){return e.requestId===n.requestId}))>=0&&(t.uploadQueue.splice(m,1),this._uploadNextPendingItem(e)),[4,this._resolveMessageQueue(e)];case 6:return g.sent(),[7];case 7:return[3,10];case 8:return n.state=b.FAILED,n.error=s.S.connectionRequired,(m=t.uploadQueue.findIndex(function(e){return e.requestId===n.requestId}))>=0&&(t.uploadQueue.splice(m,1),this._uploadNextPendingItem(e)),[4,this._resolveMessageQueue(e)];case 9:g.sent(),g.label=10;case 10:return[3,13];case 11:return n.params.thumbnailSizes=[],n.state=b.UPLOADED,[4,this._resolveMessageQueue(e)];case 12:g.sent(),g.label=13;case 13:return[2]}})})},e.prototype.request=function(e,t,n){var r,i,a;return(0,s.b)(this,void 0,void 0,function(){var o;return(0,s.c)(this,function(u){return o=new s.aa,(0,s.i)(n.file)&&(n.fileName=null!==(r=n.fileName)&&void 0!==r?r:n.file.name,n.mimeType=null!==(i=n.mimeType)&&void 0!==i?i:n.file.type,n.fileSize=null!==(a=n.fileSize)&&void 0!==a?a:n.file.size),this._queueMap.has(e.url)||this._queueMap.set(e.url,{messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1}),this._queueMap.get(e.url).messageQueue.push({requestId:t,params:n,state:b.PENDING,deferred:o,requireAuth:n.requireAuth}),this._uploadNextPendingItem(e),[2,o.promise]})})},e.prototype.cancel=function(e,t){void 0===t&&(t=null);var n,r,i=this._queueMap.get(e.url);if(i){var a=t?[i.messageQueue.find(]:(0,s.o)([],(0,s.p)(i.messageQueue),!1);try{for(var o=(0,s.G)(a),u=o.next();!u.done;u=o.next()){var c=u.value;if(c)switch(c.state){case b.PENDING:c.state=b.FAILED,c.error=s.S.requestCanceled,this._resolveMessageQueue(e);break;case b.UPLOADING:this._requestQueue.cancel(c.requestId)}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}},e}(),z={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:s.a2.ALL,customTypesFilter:null,senderUserIdsFilter:null,replyType:s.ab.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},G=function(e){return(0,s.a)("number",e.prevResultSize)&&(0,s.a)("number",e.nextResultSize)&&(0,s.a)("boolean",e.isInclusive)&&(0,s.a)("boolean",e.reverse)&&(0,s.a)("string",e.messageTypeFilter)&&(0,s.H)(s.a2,e.messageTypeFilter)&&(0,s.l)("string",e.customTypesFilter,!0)&&(0,s.l)("string",e.senderUserIdsFilter,!0)&&(0,s.H)(s.ab,e.replyType)&&(0,s.a)("boolean",e.includeMetaArray)&&(0,s.a)("boolean",e.includeReactions)&&(0,s.a)("boolean",e.includeParentMessageInfo)&&(0,s.a)("boolean",e.includeThreadInfo)&&(0,s.a)("boolean",e.showSubchannelMessagesOnly)},H={replyType:s.ab.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},B=function(e){return(0,s.H)(s.ab,e.replyType)&&(0,s.a)("boolean",e.includeReactions)&&(0,s.a)("boolean",e.includeMetaArray)&&(0,s.a)("boolean",e.includeParentMessageInfo)&&(0,s.a)("boolean",e.includeThreadInfo)},j=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.includeMetaArray,o=t.includeReactions,u=t.includeThreadInfo,c=t.includeParentMessageInfo,l=e.call(this)||this;return l.method=s.A.GET,l.path="".concat((0,s.a6)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i)),l.params={is_sdk:!0,with_sorted_meta_array:a,include_reactions:o,include_thread_info:u,include_parent_message_info:c,include_poll_details:!0},l}return(0,s._)(t,e),t}(s.f),K=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?D(t,(0,s.g)({},n)):null,r}return(0,s._)(t,e),t}(s.h),Q=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,a=t.token,o=t.prevResultSize,u=t.nextResultSize,c=t.isInclusive,l=t.reverse,h=t.messageTypeFilter,d=t.customTypesFilter,f=t.senderUserIdsFilter,p=t.replyType,_=t.includeMetaArray,m=t.includeReactions,g=t.parentMessageId,v=t.includeThreadInfo,y=t.includeParentMessageInfo,b=t.showSubchannelMessagesOnly,E=t.checkingContinuousMessages,w=e.call(this)||this;return w.method=s.A.GET,w.path="".concat((0,s.a6)(n),"/").concat(encodeURIComponent(r),"/messages"),w.params=(0,s.e)({is_sdk:!0,prev_limit:o,next_limit:u,include:c,reverse:l,message_ts:void 0===i?null:i,message_id:void 0===a?null:a,message_type:null!=h?h:null,custom_types:d,sender_ids:f,include_reply_type:p,with_sorted_meta_array:_,include_reactions:m,parent_message_id:g,include_thread_info:v,include_parent_message_info:y,show_subchannel_message_only:b,include_poll_details:!0,checking_continuous_messages:E}),w}return(0,s._)(t,e),t}(s.f),W=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.messages=n.messages.map(function(e){return D(t,e)}),r}return(0,s._)(t,e),t}(s.h),Y=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,a=t.token,o=t.replyType,u=t.includeMetaArray,c=t.includeReactions,l=t.includeThreadInfo,h=t.includeParentMessageInfo,d=e.call(this)||this;return d.method=s.A.GET,d.path="".concat((0,s.a6)(n),"/").concat(encodeURIComponent(r),"/messages/changelogs"),d.params={change_ts:i,token:a,with_sorted_meta_array:u,include_reactions:c,include_thread_info:l,include_reply_type:o,include_parent_message_info:h,include_poll_details:!0},d}return(0,s._)(t,e),t}(s.f),Z=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedMessages=n.updated.map(function(e){return D(t,e)}),r.deletedMessagesInfo=n.deleted.map(function(e){return{messageId:e.message_id,deletedAt:e.deleted_at}}),r.hasMore=n.has_more,r.nextToken=n.next,r}return(0,s._)(t,e),t}(s.h),X=function(e){function t(t){var n=t.channelUrl,r=t.scheduledMessageId,i=e.call(this)||this;return i.method=s.A.GET,i.path="".concat(s.ac,"/").concat(encodeURIComponent(n),"/scheduled_messages/").concat(encodeURIComponent(r)),i.params={},i}return(0,s._)(t,e),t}(s.f),J=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?D(t,(0,s.g)({},n)):null,r}return(0,s._)(t,e),t}(s.h),$={},ee=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,s=t.onlineDetector,a=t.cacheContext;this._iid=e,this._sdkState=n,this._requestQueue=i,this._dispatcher=r,this._cacheContext=a,this.fileMessageQueue=new V(e,{sdkState:n,dispatcher:r,requestQueue:i,onlineDetector:s,cacheContext:a}),$[e]=this}return e.of=function(e){return $[e]},e.prototype.buildMessageFromSerializedData=function(e){var t=(0,s.r)(e);switch(t.messageType){case s.Y.USER:return new O(this._iid,O.payloadify(t));case s.Y.FILE:return new U(this._iid,U.payloadify(t));case s.Y.ADMIN:return new C(this._iid,C.payloadify(t))}return null},e.prototype.buildUserMessageCreateParamsFromSerializedData=function(e,t){return(0,s.e)({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,message:t.message,translationTargetLanguages:Object.keys(t.translations),pollId:e.pollId})},e.prototype.buildFileMessageCreateParamsFromSerializedData=function(e,t){return(0,s.e)({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,file:e.file,fileKey:e.fileKey,fileUrl:t.plainUrl,fileName:t.name,fileSize:t.size,mimeType:t.type,thumbnailSizes:t.thumbnails.map(function(e){return{maxWidth:e.width,maxHeight:e.height}}),fileType:e.fileType,requireAuth:t.requireAuth})},e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(e,t){return(0,s.g)((0,s.g)({},this.buildUserMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(e,t){return(0,s.g)((0,s.g)({},this.buildFileMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildSenderFromSerializedData=function(e){var t=(0,s.r)(e);return new I(this._iid,I.payloadify(t))},e.prototype.getMessage=function(e){return(0,s.b)(this,void 0,void 0,function(){var t;return(0,s.c)(this,function(n){switch(n.label){case 0:return t=new j(e),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(K).message]}})})},e.prototype.getScheduledMessage=function(e){return(0,s.b)(this,void 0,void 0,function(){var t;return(0,s.c)(this,function(n){switch(n.label){case 0:return t=new X(e),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(J).message]}})})},e.prototype.getMessagesByMessageId=function(e,t,n,r,i){return void 0===i&&(i=s.ad.REQUEST_MESSAGE),(0,s.b)(this,void 0,void 0,function(){var a,o;return(0,s.c)(this,function(u){switch(u.label){case 0:return a=new Q((0,s.g)((0,s.g)({channelType:t,channelUrl:e,token:String(n)},z),r)),[4,this._requestQueue.send(a)];case 1:return o=u.sent().as(W).messages,this._dispatcher.dispatch(new s.ae({messages:o,source:i})),[2,o]}})})},e.prototype.getMessagesByTimestamp=function(e,t,n,r,i){return void 0===i&&(i=s.ad.REQUEST_MESSAGE),(0,s.b)(this,void 0,void 0,function(){var a,o;return(0,s.c)(this,function(u){switch(u.label){case 0:return a=new Q((0,s.g)((0,s.g)({channelType:t,channelUrl:e,timestamp:n},z),r)),[4,this._requestQueue.send(a)];case 1:return o=u.sent().as(W).messages,this._dispatcher.dispatch(new s.ae({messages:o,source:i})),[2,o]}})})},e.prototype._getMessagesByTimestampForCollection=function(e,t,n,r,i,a){return void 0===i&&(i=s.ad.REQUEST_MESSAGE),(0,s.b)(this,void 0,void 0,function(){var o,u,c,l;return(0,s.c)(this,function(h){switch(h.label){case 0:return o=new Q((0,s.g)((0,s.g)((0,s.g)({channelType:t,channelUrl:e,timestamp:n},z),r),{checkingContinuousMessages:a})),[4,this._requestQueue.send(o)];case 1:return c=(u=h.sent()).payload,l=u.as(W).messages,this._dispatcher.dispatch(new s.ae({messages:l,source:i})),[2,{messages:l,isContinuousMessages:c}]}})})},e.prototype.getThreadedMessagesByTimestamp=function(e,t,n,r){return void 0===r&&(r=s.ad.REQUEST_THREADED_MESSAGE),(0,s.b)(this,void 0,void 0,function(){var i,a,o;return(0,s.c)(this,function(u){switch(u.label){case 0:return i=new Q((0,s.g)((0,s.g)((0,s.g)({channelUrl:e.channelUrl,channelType:e.channelType,timestamp:t},A),n),{replyType:s.ab.ALL,parentMessageId:e.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(i)];case 1:return(o=(a=u.sent().as(W).messages).slice(1)).forEach(,this._dispatcher.dispatch(new s.ae({messages:o,source:r})),[2,{parentMessage:a[0],threadedMessages:o}]}})})},e.prototype.getMessageChangelogs=function(e,t,n,r,i){return void 0===i&&(i=s.ad.REQUEST_MESSAGE_CHANGELOGS),(0,s.b)(this,void 0,void 0,function(){var a,o,u,c,l,h,d;return(0,s.c)(this,function(f){switch(f.label){case 0:return a=new Y((0,s.e)((0,s.g)((0,s.g)({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null},H),r))),[4,this._requestQueue.send(a)];case 1:return u=(o=f.sent().as(Z)).updatedMessages,c=o.deletedMessagesInfo,l=o.hasMore,h=o.nextToken,d=c.map(function(e){return e.messageId}),u.length>0&&this._dispatcher.dispatch(new s.ae({messages:u,source:i})),d.length>0&&this._dispatcher.dispatch(new s.af({messageIds:d,source:i})),[2,{updatedMessages:u,deletedMessageIds:d,hasMore:l,token:h}]}})})},e}(),et=function(){function e(){this._onPending=s.n,this._onFailed=s.n,this._onSucceeded=s.n}return e.prototype._trigger=function(e,t){switch(t.sendingStatus){case s.a0.PENDING:0===t.errorCode&&this._onPending(t);break;case s.a0.FAILED:case s.a0.CANCELED:this._onFailed(e,t.scheduledInfo?null:t);break;case s.a0.SCHEDULED:case s.a0.SUCCEEDED:this._onSucceeded(t)}},e.prototype.onPending=function(e){return this._onPending=e,this},e.prototype.onFailed=function(e){return this._onFailed=e,this},e.prototype.onSucceeded=e}(),en=function(e){function t(t,n){var r=e.call(this,t)||this;r.threadInfo=null,r.targetMessageId=0,r.channelUrl=null,r.channelType=null;var i=n.thread_info,a=n.parent_message_id,o=n.channel_url,c=n.channel_type;return i&&(0,s.a)("object",i)&&(0,s.a)("number",a)&&(0,s.a)("string",o)&&(0,s.a)("string",c)&&(r.threadInfo=new u(t,i),r.targetMessageId=a,r.channelUrl=o,r.channelType=c),r}return(0,s._)(t,e),t}(s.T),er={channelUrl:null,channelType:null,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},ei=function(e){function t(t){var n=t.channelCustomType,r=t.keyword,i=t.limit,a=t.reverse,o=t.exactMatch,u=t.channelUrl,c=t.order,l=t.messageTimestampFrom,h=t.messageTimestampTo,d=t.advancedQuery,f=t.targetFields,p=t.nextToken,_=e.call(this)||this;return _.method=s.A.GET,_.path="".concat(s.ag,"/messages"),_.params={custom_type:n,query:r,limit:i,reverse:a,exact_match:o,channel_url:u,message_ts_from:l,message_ts_to:h,sort_field:c,advanced_query:d,target_fields:f,after:p},_}return(0,s._)(t,e),t}(s.f),es=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.messages=n.results.map(function(e){return D(t,e)}),r.hasNext=n.has_next,r.nextToken=n.end_cursor,r.totalCount=n.total_count,r}return(0,s._)(t,e),t}(s.h);(r=F||(F={})).SCORE="score",r.TIMESTAMP="ts";var ea=function(e){function t(t,n){var r,i,s,a,o,u,c,l,h,d=this;return(d=e.call(this,t,n)||this).keyword="",d.reverse=!1,d.exactMatch=!1,d.channelUrl="",d.channelCustomType="",d.messageTimestampFrom=null,d.messageTimestampTo=null,d.order=F.SCORE,d.advancedQuery=!1,d.targetFields=null,d._nextToken="",d.totalCount=-1,d.keyword=n.keyword,d.reverse=null!==(r=n.reverse)&&void 0!==r&&r,d.exactMatch=null!==(i=n.exactMatch)&&void 0!==i&&i,d.channelUrl=null!==(s=n.channelUrl)&&void 0!==s?s:"",d.channelCustomType=null!==(a=n.channelCustomType)&&void 0!==a?a:"",d.messageTimestampFrom=null!==(o=n.messageTimestampFrom)&&void 0!==o?o:null,d.messageTimestampTo=null!==(u=n.messageTimestampTo)&&void 0!==u?u:null,d.order=null!==(c=n.order)&&void 0!==c?c:F.SCORE,d.advancedQuery=null!==(l=n.advancedQuery)&&void 0!==l&&l,d.targetFields=null!==(h=n.targetFields)&&void 0!==h?h:null,d}return(0,s._)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,s.a)("string",this.keyword)&&this.keyword.length>0&&(0,s.a)("boolean",this.reverse)&&(0,s.a)("boolean",this.exactMatch)&&(0,s.a)("string",this.channelUrl)&&(0,s.a)("string",this.channelCustomType)&&((0,s.a)("number",this.messageTimestampFrom)||null===this.messageTimestampFrom)&&((0,s.a)("number",this.messageTimestampTo)||null===this.messageTimestampTo)&&(0,s.H)(F,this.order)&&(0,s.a)("boolean",this.advancedQuery)&&(0,s.l)("string",this.targetFields,!0)},t.prototype.next=function(){return(0,s.b)(this,void 0,void 0,function(){var e,t,n,r,i,a,o;return(0,s.c)(this,function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=s.V.of(this._iid).requestQueue,t=new ei((0,s.g)((0,s.g)({},this),{nextToken:this._nextToken?this._nextToken:null})),[4,e.send(t)]):[3,2]:[3,5];case 1:return r=(n=u.sent().as(es)).messages,i=n.hasNext,a=n.nextToken,o=n.totalCount,this._nextToken=a,this._hasNext=i,this._isLoading=!1,this.totalCount=o,[2,r];case 2:return[2,[]];case 3:throw s.S.queryInProgress;case 4:return[3,6];case 5:throw s.S.invalidParameters;case 6:return[2]}})})},t}(s.B),eo=function(e){function t(t,n,r,i){var a,o,u,c,l,h,d,f,p,_,m=this;return(m=e.call(this,t,n,r,i)||this).reverse=!1,m.messageTypeFilter=s.a2.ALL,m.customTypesFilter=null,m.senderUserIdsFilter=null,m.replyType=s.ab.NONE,m.includeMetaArray=!1,m.includeReactions=!1,m.includeParentMessageInfo=!1,m.includeThreadInfo=!1,m.showSubchannelMessagesOnly=!1,m._edge=Number.MAX_SAFE_INTEGER,m.reverse=null!==(a=i.reverse)&&void 0!==a&&a,m.messageTypeFilter=null!==(o=i.messageTypeFilter)&&void 0!==o?o:s.a2.ALL,m.customTypesFilter=null!==(u=i.customTypesFilter)&&void 0!==u?u:null,m.senderUserIdsFilter=null!==(c=i.senderUserIdsFilter)&&void 0!==c?c:null,m.replyType=null!==(l=i.replyType)&&void 0!==l?l:s.ab.NONE,m.includeMetaArray=null!==(h=i.includeMetaArray)&&void 0!==h&&h,m.includeReactions=null!==(d=i.includeReactions)&&void 0!==d&&d,m.includeParentMessageInfo=null!==(f=i.includeParentMessageInfo)&&void 0!==f&&f,m.includeThreadInfo=null!==(p=i.includeThreadInfo)&&void 0!==p&&p,m.showSubchannelMessagesOnly=null!==(_=i.showSubchannelMessagesOnly)&&void 0!==_&&_,m}return(0,s._)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,s.a)("boolean",this.reverse)&&(0,s.H)(s.a2,this.messageTypeFilter)&&(0,s.H)(s.ab,this.replyType)&&(0,s.l)("string",this.customTypesFilter,!0)&&(0,s.l)("string",this.senderUserIdsFilter,!0)&&(0,s.a)("boolean",this.includeMetaArray)&&(0,s.a)("boolean",this.includeReactions)&&(0,s.a)("boolean",this.includeParentMessageInfo)&&(0,s.a)("boolean",this.includeThreadInfo)&&(0,s.a)("boolean",this.showSubchannelMessagesOnly)},t.prototype.load=function(){return(0,s.b)(this,void 0,void 0,function(){var e;return(0,s.c)(this,function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,ee.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,{prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly})]):[3,2]:[3,5];case 1:return e=t.sent(),this._edge=Math.min.apply(Math,(0,s.o)([Number.MAX_SAFE_INTEGER],(0,s.p)(e.map(function(e){return e.createdAt})),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return[2,[]];case 3:throw s.S.queryInProgress;case 4:return[3,6];case 5:throw s.S.invalidParameters;case 6:return[2]}})})},t}(s.ah),eu={channelUrl:null,scheduledMessageId:0},ec=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="message",t}return(0,s._)(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,s=n.sessionManager,a=n.requestQueue,o=n.logger,u=n.onlineDetector,c=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:s,requestQueue:a,logger:o,onlineDetector:u,cacheContext:c}),this._manager=new ee(t,{sdkState:r,dispatcher:i,requestQueue:a,onlineDetector:u,cacheContext:c})},t.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e)},t.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e)},t.prototype.getMessage=function(e){return(0,s.b)(this,void 0,void 0,function(){var t;return(0,s.c)(this,function(n){return t=(0,s.g)((0,s.g)({},er),e),(0,s.q)((0,s.a)("string",t.channelUrl)&&(0,s.a)("string",t.channelType)&&(0,s.H)(s.K,t.channelType)&&(0,s.a)("number",t.messageId)&&(0,s.a)("boolean",t.includeMetaArray)&&(0,s.a)("boolean",t.includeParentMessageInfo)&&(0,s.a)("boolean",t.includeThreadInfo)).throw(s.S.invalidParameters),[2,this._manager.getMessage(t)]})})},t.prototype.getScheduledMessage=function(e){return(0,s.b)(this,void 0,void 0,function(){var t;return(0,s.c)(this,function(n){return t=(0,s.g)((0,s.g)({},eu),e),(0,s.q)((0,s.a)("string",t.channelUrl)&&(0,s.a)("number",t.scheduledMessageId)).throw(s.S.invalidParameters),[2,this._manager.getScheduledMessage(t)]})})},t}(s.ai)},35660:function(e,t,n){let r,i,s;n.d(t,{$:function(){return r$},A:function(){return Q},B:function(){return iO},C:function(){return nx},D:function(){return b},E:function(){return $},F:function(){return ru},G:function(){return f},H:function(){return R},I:function(){return E},J:function(){return I},K:function(){return r3},L:function(){return Y},M:function(){return W},P:function(){return w},Q:function(){return nX},R:function(){return r4},S:function(){return A},T:function(){return rw},U:function(){return rq},V:function(){return r7},W:function(){return ed},X:function(){return k},Y:function(){return rZ},Z:function(){return rU},_:function(){return u},a:function(){return O},a0:function(){return r2},a1:function(){return L},a2:function(){return rX},a3:function(){return iv},a4:function(){return r1},a5:function(){return nG},a6:function(){return iy},a7:function(){return iE},a8:function(){return m},a9:function(){return ri},aA:function(){return iC},aB:function(){return iA},aC:function(){return n$},aD:function(){return n8},aE:function(){return id},aF:function(){return iI},aG:function(){return ra},aH:function(){return ip},aI:function(){return n1},aJ:function(){return n0},aa:function(){return nB},ab:function(){return r0},ac:function(){return nJ},ad:function(){return ih},ae:function(){return iT},af:function(){return iS},ag:function(){return n2},ah:function(){return iR},ai:function(){return r9},aj:function(){return ig},al:function(){return et},am:function(){return M},an:function(){return F},ao:function(){return l},ap:function(){return n5},aq:function(){return im},ar:function(){return i_},as:function(){return iN},at:function(){return ib},au:function(){return n3},av:function(){return iw},aw:function(){return rJ},ax:function(){return S},ay:function(){return ik},az:function(){return x},b:function(){return h},c:function(){return d},d:function(){return nZ},e:function(){return en},f:function(){return es},g:function(){return c},h:function(){return ea},i:function(){return P},j:function(){return n6},k:function(){return n4},l:function(){return U},m:function(){return q},n:function(){return ef},o:function(){return _},p:function(){return p},q:function(){return rM},r:function(){return rL},s:function(){return nK},t:function(){return nV},u:function(){return X},v:function(){return g},w:function(){return ro},x:function(){return nH},y:function(){return rF},z:function(){return rV}});var a,o=ar c=g="4.6.0",v=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return g},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:enumerable:!1,configurable:!0}),e}();(y=m||(m={}))[y.NON_AUTHORIZED=400108]="NON_AUTHORIZED",y[y.INVALID_TOKEN=400111]="INVALID_TOKEN",y[y.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",y[y.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",y[y.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",y[y.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",y[y.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",y[y.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",y[y.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",y[y.LOST_INSTANCE=700100]="LOST_INSTANCE",y[y.CONNECTION_RENEW=700102]="CONNECTION_RENEW",y[y.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",y[y.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",y[y.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",y[y.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",y[y.INVALID_PARAMETER=800110]="INVALID_PARAMETER",y[y.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",y[y.NETWORK_ERROR=800120]="NETWORK_ERROR",y[y.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",y[y.MALFORMED_DATA=800130]="MALFORMED_DATA",y[y.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",y[y.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",y[y.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",y[y.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",y[y.ACK_TIMEOUT=800180]="ACK_TIMEOUT",y[y.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",y[y.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",y[y.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",y[y.REQUEST_FAILED=800220]="REQUEST_FAILED",y[y.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",y[y.REQUEST_CANCELED=800240]="REQUEST_CANCELED",y[y.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",y[y.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",y[y.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",y[y.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",y[y.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",y[y.DATABASE_ERROR=800700]="DATABASE_ERROR";var y,b,E,w,I,T,S=function(e){return!(e instanceof A&&!e.shouldThrowOutside)},A=function(e){function t(n){var r=n.code,i=n.message,s=e.call(this,i)||this;return s.shouldThrowOutside=!1,s.name="SendbirdError",s.code=void 0===r?0:r,Object.setPrototypeOf(s,t.prototype),s}return u(t,e),Object.defineProperty(t.prototype,"isInvalidTokenError",{get:function(){return this.code===m.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===m.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:enumerable:!1,configurable:!0}),Object.defineProperty(t,"debugModeRequired",{get:function(){return new t({code:m.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lostInstance",{get:function(){return new t({code:m.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRenew",{get:function(){return new t({code:m.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidConnectionStateTransition",{get:function(){return new t({code:m.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRequired",{get:function(){return new t({code:m.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionCanceled",{get:function(){return new t({code:m.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidParameters",{get:function(){return new t({code:m.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"notSupportedError",{get:function(){return new t({code:m.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"networkError",{get:function(){return new t({code:m.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"markAsReadAllRateLimitExceeded",{get:function(){return new t({code:m.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"queryInProgress",{get:function(){return new t({code:m.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"noAckTimeout",{get:function(){return new t({code:m.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loginTimeout",{get:function(){return new t({code:m.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionClosed",{get:function(){return new t({code:m.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestFailed",{get:function(){return new t({code:m.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileUploadCanceled",{get:function(){return new t({code:m.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestCanceled",{get:function(){return new t({code:m.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRefreshFailed",{get:function(){return new t({code:m.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRequestFailed",{get:function(){return new t({code:m.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseError",{get:function(){return new t({code:m.DATABASE_ERROR,message:"Database error."})},enumerable:!1,configurable:!0}),t.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},t}(Error),N=[m.CONNECTION_REQUIRED,m.NETWORK_ERROR,m.ACK_TIMEOUT,m.WEBSOCKET_CONNECTION_CLOSED,m.WEBSOCKET_CONNECTION_FAILED,m.FILE_UPLOAD_CANCEL_FAILED,m.REQUEST_CANCELED,m.INTERNAL_SERVER_ERROR,m.RATE_LIMIT_EXCEEDED,m.UNKNOWN_SERVER_ERROR],C=[m.WEBSOCKET_CONNECTION_CLOSED,m.WEBSOCKET_CONNECTION_FAILED,m.CONNECTION_REQUIRED],k=function(e,t){if(e!==t){var n=c({},e),r=c({},t);return(!n.hasOwnProperty("messageId")||!r.hasOwnProperty("messageId")||n.messageId===r.messageId)&&(!n.hasOwnProperty("reqId")||!r.hasOwnProperty("reqId")||n.reqId===r.reqId)&&(n.hasOwnProperty("messageId")&&delete n.messageId,n.hasOwnProperty("reqId")&&delete n.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(n)===JSON.stringify(r))}return!0},O=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||("string"!=typeof e?"object"==typeof e?R(e,t):D(e,t):typeof t===e)},R=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Object.values(e).includes(t)},D=U=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Array.isArray(t)&&t.every(},L=function(e){return e>0&&N.indexOf(e)>=0},M=function(e){return e>0&&C.indexOf(e)>=0},P=function(e,t){if(void 0===t&&(t=!1),t&&null===e)return!0;var n=O("object",e)&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type;if(!n){if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return n},x=function(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(var n=_([],p(e),!1).sort(),r=_([],p(t),!1).sort(),i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0},q=function(){function e(e){var t=void 0===e?{}:e,n=t.useMemberInfoInMessage,r=t.typingIndicatorInvalidateTime,i=t.typingIndicatorThrottle,s=t.websocketResponseTimeout,a=t.websocketPayloadDecompression,o=t.sessionTokenRefreshTimeout;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=void 0===n||n,this._typingIndicatorInvalidateTime=void 0===r?1e4:r,this._typingIndicatorThrottle=void 0===i?1e3:i,this._websocketResponseTimeout=void 0===s?1e4:s,this._sessionTokenRefreshTimeout=void 0===o?60:o,this.websocketPayloadDecompression=void 0===a||a}return Object.defineProperty(e.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(e){O("boolean",e)&&(this._useMemberInfoInMessage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(e){O("number",e)&&(this._typingIndicatorInvalidateTime=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(e){O("number",e)&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(e){O("number",e)&&e>=5e3&&e<=3e4&&(this._websocketResponseTimeout=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(e){O("number",e)&&(e<60?e=60:e>1800&&(e=1800),this._sessionTokenRefreshTimeout=e)},enumerable:!1,configurable:!0}),e}(),F={encrypt:function(e){return e},decrypt:function(e){return e}},V=function(){function e(e){var t=e.store;this._preference=new Map,this._store=t}return e.prototype._savePreferenceKeys=function(){return h(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,this._store.set({key:this._keysAddress,value:_([],p(this._preference.keys()),!1),generation:1})];case 1:return e.sent(),[2]}})})},e.prototype.init=function(e){var t;return h(this,void 0,void 0,function(){var n,r,i,s,a,o,u;return d(this,function(c){switch(c.label){case 0:return this._keysAddress=e,[4,this._store.get(e)];case 1:n=null!==(t=c.sent())&&void 0!==t?t:[],c.label=2;case 2:c.trys.push([2,7,8,9]),i=(r=f(n)).next(),c.label=3;case 3:return i.done?[3,6]:(s=i.value,[4,this._store.get(s)]);case 4:(a=c.sent())&&this._preference.set(s,a),c.label=5;case 5:return i=r.next(),[3,3];case 6:return[3,9];case 7:return o={error:c.sent()},[3,9];case 8:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(o)throw o.error}return[7];case 9:return[2]}})})},e.prototype.get=function(e){var t;return h(this,void 0,void 0,function(){return d(this,function(n){return[2,null!==(t=this._preference.get(e))&&void 0!==t?t:null]})})},e.prototype.set=function(e,t){return h(this,void 0,void 0,function(){var n;return d(this,function(r){switch(r.label){case 0:return n=!this._preference.has(e),[4,this._store.set({key:e,value:t,generation:1})];case 1:return r.sent(),this._preference.set(e,t),n?[4,this._savePreferenceKeys()]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.remove=function(e){return h(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,this._store.remove(e)];case 1:return t.sent(),this._preference.delete(e),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}})})},e.prototype.clear=function(){return h(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,this._store.removeMany(_([],p(this._preference.keys()),!1))];case 1:return e.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2]}})})},e}(),z=function(e){var t=e.encryption,n=void 0===t?null:t,r=e.store,i=void 0===r?null:r,s=e.localCacheEnabled,a=e.localCacheConfig;this.nestdb=null,this.store=i,this.preference=new V({store:i}),this.encryption=null!=n?n:F,this.localCacheEnabled=void 0===s||s,this.localCacheConfig=void 0===a?null:a};(G=b||(b={})).SUCCESS="success",G.PENDING="pending",G.ERROR="error",(H=E||(E={})).DEFAULT="default",H.ALL="all",H.MENTION_ONLY="mention_only",H.OFF="off",(B=w||(w={})).FCM="gcm",B.APNS="apns",B.UNKNOWN="unknown",(j=I||(I={})).ALTERNATIVE="alternative",j.DEFAULT="default",(K=T||(T={})).CUSTOM="custom",K.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at";var G,H,B,j,K,Q,W=function(){function e(e){var t=e.channel,n=e.cachedMessageCount;this._channel=null,this._cachedMessageCount=0,this._channel=t,this._cachedMessageCount=n}return Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedMessageCount",{get:function(){return this._cachedMessageCount},enumerable:!1,configurable:!0}),e}(),Y=function(){function e(e){var t=void 0===e?{}:e,n=t.maxSize,r=t.clearOrder,i=void 0===r?T.MESSAGE_COLLECTION_ACCESSED_AT:r,s=t.customClearOrderComparator,a=void 0===s?null:s;this._customClearOrderComparator=null,this._clearOrderComparatorUseMessageCollectionAccessedAt=function(e,t){return e.channel.messageCollectionLastAccessedAt===t.channel.messageCollectionLastAccessedAt?e.channel.lastMessage&&!t.channel.lastMessage?1:!e.channel.lastMessage&&t.channel.lastMessage?-1:e.channel.lastMessage.createdAt-t.channel.lastMessage.createdAt:e.channel.messageCollectionLastAccessedAt>t.channel.messageCollectionLastAccessedAt?1:-1},this._maxSize=Math.max(void 0===n?256:n,64),a?(this._clearOrder=i,this._customClearOrderComparator=a):this._clearOrder=T.MESSAGE_COLLECTION_ACCESSED_AT}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrder",{get:function(){return this._clearOrder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrderComparator",{get:function(){var e;return this._clearOrder===T.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:null!==(e=this._customClearOrderComparator)&&void 0!==e?e:this._clearOrderComparatorUseMessageCollectionAccessedAt},enumerable:!1,configurable:!0}),e}(),Z=function(){eturn Object.defineProperty(e.prototype,"hasSession",{get:enumerable:!1,configurable:!0}),e.prototype.clear=e}(),X=J=function(){function e(e){var t=e.container;this._container={},this._container=t,this.key=X()}return e.prototype._register=function(e,t,n){return e in this._container||(this._container[e]=new Map),this._container[e].set(this.key,{occurence:t,handler:n}),this},e.prototype.on=e.prototype.once=e.prototype.close=function(){for(var e in this._container)this._container[e].delete(this.key)},e}(),$=function(){eturn e.prototype.on=function(e,t){return new J({container:this._container}).on(e,t)},e.prototype.once=function(e,t){return new J({container:this._container}).once(e,t)},e.prototype.dispatch=function(e,t){var n,r,i=this._container[e];if(i){var s=[];try{for(var a=f(i.keys()),o=a.next();!o.done;o=a.next()){var u=o.value,c=i.get(u);c.handler(t),c.occurence>0&&(c.occurence--,0===c.occurence&&s.push(u))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}s.forEach(function(e){return i.delete(e)})}},e}(),ee=function(){eturn e.prototype.on=function(e){return this._dispatcher.on("event",e)},e.prototype.once=e.prototype.dispatch=e}(),et=function(){},en=function(e){var t={};return e&&Object.keys(e).forEach(function(n){void 0===e[n]||(e[n],0)||null===e[n]||(t[n]=e[n])}),t};(er=Q||(Q={})).GET="GET",er.POST="POST",er.PUT="PUT",er.DELETE="DELETE";var er,ei,es=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.params={},t.requireAuth=!0,t.headers={},t.requestId=X(),t}return u(t,e),t.prototype.stringifyParams=function(e){return"object"!=typeof e||Array.isArray(e)?String(e):e?JSON.stringify(e):""},t.prototype.encodeParams=function(e){var t=this;return null==e||""===e?encodeURIComponent(""):Array.isArray(e)?e.map(function(e){return t.encodeParams(e)}).join(","):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(String(e))},Object.defineProperty(t.prototype,"query",{get:function(){var e=this,t=en(this.params);return"?".concat(Object.keys(t).map(function(n){return"".concat(encodeURIComponent(n),"=").concat(e.encodeParams(t[n]))}).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){var e=this,t=en(this.params);if(Object.keys(t).some(){var n=new FormData;return Object.keys(t).forEach(function(r){var i,s=t[r];P(s)?n.append(r,s,null!==(i=s.name)&&void 0!==i?i:"filename"):n.append(r,e.stringifyParams(s))}),n}return JSON.stringify(t)},enumerable:!1,configurable:!0}),t}(et),ea=function(e){eturn u(t,e),Object.defineProperty(t.prototype,"payload",{get:enumerable:!1,configurable:!0}),t.prototype.as=t}(et),eo=function(e){function t(t){var n=e.call(this)||this;return n.requestId=t,n}return u(t,e),t}(et),eu=et),ec=et);(nP=ei||(ei={})).WEBSOCKET_CONNECT="ws:connect",nP.API_RESULT="api:result";var el=function(){function e(e){var t=e.type,n=e.data,r=e.ts,i=void 0===r?Date.now():r;this.type=t,this.createdAt=i,this.data=n}return e.payloadify=function(e){return en({stat_type:e.type,ts:e.createdAt,data:en(e.data)})},e}(),eh=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,s=t.logger,a=this;this._abortControl=new Map,this._iid=e,this._auth=n,this._sdkState=r,this._dispatcher=i,this._dispatcher.on(,this._logger=s}return Object.defineProperty(e.prototype,"_userAgentWithExtension",{get:function(){var e=this._sdkState.extensions,t="undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product?"reactnative":"JS",n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",r=e.sb_uikit?"u".concat(e.sb_uikit):"",i=e["device-os-platform"]?"o".concat(e["device-os-platform"]):"";return"".concat(t,"/c").concat(v.SDK_VERSION,"/").concat(n,"/").concat(r,"/").concat(i)},enumerable:!1,configurable:!0}),e.prototype._createHeader=function(e,t){void 0===t&&(t=null);var n=this._sdkState,r=n.appId,i=n.appVersion,s=c(c({},e.headers),{SendBird:"JS,".concat(v.OS_VERSION,",").concat(v.SDK_VERSION,",").concat(r).concat(i?",".concat(i):""),"SB-User-Agent":encodeURIComponent(this._userAgentWithExtension),"Request-Sent-Timestamp":Date.now().toString()});return t||(s["Content-Type"]="application/json; charset=utf-8"),e.requireAuth&&this._auth.hasSession&&(s["Session-Key"]=this._auth.sessionKey),this._auth&&this._auth.authToken&&(s["App-Id"]=r,s["Access-Token"]=this._auth.authToken),s},e.prototype._statLogApiResult=function(e,t,n){this._dispatcher.dispatch(new ec(new el({type:ei.API_RESULT,data:{endpoint:e.path,method:e.method,success:!n,latency:Date.now()-t,error_code:null==n?void 0:n.code,error_description:null==n?void 0:n.message}})))},e.prototype.send=function(e){return h(this,void 0,void 0,function(){var t,n,r,i,s,a,o,u,c,l,h,f,p,_,m;return d(this,function(d){switch(d.label){case 0:t=e.path,r=![Q.GET,Q.DELETE].includes(n=e.method),i=this._sdkState.api,s="".concat(i.host).concat(t).concat(r?"":e.query),a=r?e.payload:null,o=this._createHeader(e,a instanceof FormData?a:null),c=(u=new AbortController).signal,this._abortControl.set(e.requestId,u),l=Date.now(),d.label=1;case 1:return d.trys.push([1,4,,5]),[4,fetch(s,{method:n,body:a,headers:o,signal:c})];case 2:return[4,(h=d.sent()).json()];case 3:if(f=d.sent(),h.ok||h.redirected)return this._logger.debug("receive api response",e.requestId),this._statLogApiResult(e,l,null),[2,new ea(this._iid,f)];throw f?(p=new A(f),!e.requireAuth&&p.isSessionKeyExpiredError&&this._dispatcher.dispatch(new eu),this._statLogApiResult(e,l,p),p):(p=A.requestFailed,this._statLogApiResult(e,l,p),p);case 4:throw _=d.sent(),this._statLogApiResult(e,l,_),_ instanceof A?(this._logger.debug("fail api request",_),_):"AbortError"===_.name?A.requestCanceled:(m=A.networkError,this._logger.debug("fail api request",m),m);case 5:return[2]}})})},e.prototype.cancel=function(e){this._abortControl.has(e)&&(this._abortControl.get(e).abort(),this._abortControl.delete(e))},e.prototype.cancelAll=function(){var e,t;try{for(var n=f(this._abortControl.values()),r=n.next();!r.done;r=n.next())r.value.abort()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._abortControl.clear()},e}(),ed=function(e){function t(t,n,r,i){void 0===i&&(i="");var s=e.call(this)||this;return s._iid=t,s.code=n,s.payload=r,s.requestId=r?r.req_id:i,s}return u(t,e),t.createFromRawMessage=function(e,n){var r=n.substring(0,4),i=null;try{i=JSON.parse(n.substring(4))}catch(e){r="NOOP"}finally{return new t(e,r,i)}},t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},t.prototype.as=t}(et),ef=function(){};et e_=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),em=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),eg=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ev=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ey=Array(576);ep(ey);let eb=Array(60);ep(eb);let eE=Array(512);ep(eE);let ew=Array(256);ep(ew);let eI=Array(29);ep(eI);let eT=Array(30);(eT);let eN=eC=ek=eO=eR=eD=(e,t,n)=>{let r=Array(16),i,s,a=0;for(i=1;i<=15;i++)a=a+n[i-1]<<1,r[i]=a;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=eR(r[t]++,t))}},eU=eL=eM=eP=ex=(e,t,n)=>{let r,i,s,a,o=0;if(0!==e.sym_next)do r=(255&e.pending_buf[e.sym_buf+o++])+((255&e.pending_buf[e.sym_buf+o++])<<8),i=e.pending_buf[e.sym_buf+o++],0===r?eO(e,i,t):(eO(e,(s=ew[i])+256+1,t),0!==(a=e_[s])&&ek(e,i-=eI[s],a),eO(e,s=eN(--r),n),0!==(a=em[s])&&ek(e,r-=eT[s],a));while(o<e.sym_next);eO(e,256,t)},eq=(e,t)=>{let n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems,a,o,u,c=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<s;a++)0!==n[2*a]?(e.heap[++e.heap_len]=c=a,e.depth[a]=0):n[2*a+1]=0;for(;e.heap_len<2;)n[2*(u=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[2*u+1]);for(t.max_code=c,a=e.heap_len>>1;a>=1;a--)eP(e,n,a);u=s;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],eP(e,n,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,n[2*u]=n[2*a]+n[2*o],e.depth[u]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,n[2*a+1]=n[2*o+1]=u,e.heap[1]=u++,eP(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{let n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,u=t.stat_desc.max_length,c,l,h,d,f,p,_=0;for(d=0;d<=15;d++)e.bl_count[d]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)(d=n[2*n[2*(l=e.heap[c])+1]+1]+1)>u&&(d=u,_++),n[2*l+1]=d,l>r||(e.bl_count[d]++,f=0,l>=o&&(f=a[l-o]),p=n[2*l],e.opt_len+=p*(d+f),s&&(e.static_len+=p*(i[2*l+1]+f)));if(0!==_){do{for(d=u-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[u]--,_-=2}while(_>0);for(d=u;0!==d;d--)for(l=e.bl_count[d];0!==l;)(h=e.heap[--c])>r||(n[2*h+1]!==d&&(e.opt_len+=(d-n[2*h+1])*n[2*h],n[2*h+1]=d),l--)}})(e,t),eD(n,c,e.bl_count)},eF=eV=(e,t,n)=>{let r,i,s=-1,a=t[1],o=0,u=7,c=4;for(0===a&&(u=138,c=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++o<u&&i===a)){if(o<c)do eO(e,i,e.bl_tree);while(0!=--o);else 0!==i?(i!==s&&(eO(e,i,e.bl_tree),o--),eO(e,16,e.bl_tree),ek(e,o-3,2)):o<=10?(eO(e,17,e.bl_tree),ek(e,o-3,3)):(eO(e,18,e.bl_tree),ek(e,o-11,7));o=0,s=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4)}},ez=!1,eG=var eH=(e,t,n,r)=>{let i,s,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=((e)),eq(e,e.l_desc),eq(e,e.d_desc),a=((e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=n+5,n+4<=i&&-1!==t?eG(e,t,n,r):4===e.strategy||s===i?(ek(e,2+(r?1:0),3),ex(e,ey,eb)):(ek(e,4+(r?1:0),3),((e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),ex(e,e.dyn_ltree,e.dyn_dtree)),eU(e),r&&eL(e)},eB={_tr_init:e=>{ez||((()=>{let e,t,n,a,o;let u=Array(16);for(n=0,a=0;a<28;a++)for(eI[a]=n,e=0;e<1<<e_[a];e++)ew[n++]=a;for(ew[n-1]=a,o=0,a=0;a<16;a++)for(eT[a]=o,e=0;e<1<<em[a];e++)eE[o++]=a;for(o>>=7;a<30;a++)for(eT[a]=o<<7,e=0;e<1<<em[a]-7;e++)eE[256+o++]=a;for(t=0;t<=15;t++)u[t]=0;for(e=0;e<=143;)ey[2*e+1]=8,e++,u[8]++;for(;e<=255;)ey[2*e+1]=9,e++,u[9]++;for(;e<=279;)ey[2*e+1]=7,e++,u[7]++;for(;e<=287;)ey[2*e+1]=8,e++,u[8]++;for(eD(ey,287,u),e=0;e<30;e++)eb[2*e+1]=5,eb[2*e]=eR(e,5);r=new eS(ey,e_,257,286,15),i=new eS(eb,em,0,30,15),s=new eS([],eg,0,19,7)})(),ez=!0),e.l_desc=new eA(e.dyn_ltree,r),e.d_desc=new eA(e.dyn_dtree,i),e.bl_desc=new eA(e.bl_tree,s),e.bi_buf=0,e.bi_valid=0,eU(e)},_tr_stored_block:eG,_tr_flush_block:eH,_tr_tally:_tr_align:e=>{var t;ek(e,2,3),eO(e,256,ey),16===(t=e).bi_valid?(eC(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},ej=let eK=new Uint32Array((());var eQ=(e,t,n,r)=>{let i=r+n;e^=-1;for(let n=r;n<i;n++)e=e>>>8^eK[255&(e^t[n])];return -1^e},eW={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},eY={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};let{_tr_init:eZ,_tr_stored_block:eX,_tr_flush_block:eJ,_tr_tally:e$,_tr_align:e0}=eB,{Z_NO_FLUSH:e1,Z_PARTIAL_FLUSH:e2,Z_FULL_FLUSH:e3,Z_FINISH:e4,Z_BLOCK:e6,Z_OK:e5,Z_STREAM_END:e8,Z_STREAM_ERROR:e7,Z_DATA_ERROR:e9,Z_BUF_ERROR:te,Z_DEFAULT_COMPRESSION:tt,Z_FILTERED:tn,Z_HUFFMAN_ONLY:tr,Z_RLE:ti,Z_FIXED:ts,Z_DEFAULT_STRATEGY:ta,Z_UNKNOWN:to,Z_DEFLATED:tu}=eY,tc=tl=th=td=e=>{let t,n,r,i=e.w_size;r=t=e.hash_size;do n=e.head[--r],e.head[r]=n>=i?n-i:0;while(--t);r=t=i;do n=e.prev[--r],e.prev[r]=n>=i?n-i:0;while(--t)},tf=tp=t_=tm=tg=tv=ty=(e,t)=>{let n,r,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,u=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,l=e.w_mask,h=e.prev,d=e.strstart+258,f=c[s+a-1],p=c[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do if(c[(n=t)+a]===p&&c[n+a-1]===f&&c[n]===c[s]&&c[++n]===c[s+1]){s+=2,n++;do;while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<d);if(r=258-(d-s),s=d-258,r>a){if(e.match_start=t,a=r,r>=o)break;f=c[s+a-1],p=c[s+a]}}while((t=h[t&l])>u&&0!=--i);return a<=e.lookahead?a:e.lookahead},tb=tE=(e,t)=>{let n,r,i,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,o=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<s&&(0===n&&t!==e4||t===e1||n!==r+e.strm.avail_in)))break;a=t===e4&&n===r+e.strm.avail_in?1:0,eX(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,tp(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(tv(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return(o-=e.strm.avail_in)&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==e1&&t!==e4&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(tv(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,s=(i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i)>e.w_size?e.w_size:i,((r=e.strstart-e.block_start)>=s||(r||t===e4)&&t!==e1&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,a=t===e4&&0===e.strm.avail_in&&n===r?1:0,eX(e,e.block_start,n,a),e.block_start+=n,tp(e.strm)),a?3:1)},tw=(e,t)=>{let n,r;for(;;){if(e.lookahead<262){if(tb(e),e.lookahead<262&&t===e1)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=tf(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=ty(e,n)),e.match_length>=3){if(r=e$(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=tf(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=tf(e,e.ins_h,e.window[e.strstart+1])}else r=e$(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(t_(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===e4?(t_(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(t_(e,!1),0===e.strm.avail_out)?1:2},tI=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<262){if(tb(e),e.lookahead<262&&t===e1)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=tf(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=ty(e,n),e.match_length<=5&&(e.strategy===tn||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=e$(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=tf(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(t_(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=e$(e,0,e.window[e.strstart-1]))&&t_(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=e$(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===e4?(t_(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(t_(e,!1),0===e.strm.avail_out)?1:2};et tS=[new tT(0,0,0,0,tE),new tT(4,4,8,4,tw),new tT(4,5,16,8,tw),new tT(4,6,32,32,tw),new tT(4,4,16,16,tI),new tT(8,16,32,32,tI),new tT(8,16,128,128,tI),new tT(8,32,128,256,tI),new tT(32,128,258,1024,tI),new tT(32,258,258,4096,tI)];et tN=tC=tk=e=>{var t;let n=tC(e);return n===e5&&((t=e.state).window_size=2*t.w_size,th(t.head),t.max_lazy_match=tS[t.level].max_lazy,t.good_match=tS[t.level].good_length,t.nice_match=tS[t.level].nice_length,t.max_chain_length=tS[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n},tO=(e,t,n,r,i,s)=>{if(!e)return e7;let a=1;if(t===tt&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>9||n!==tu||r<8||r>15||t<0||t>9||s<0||s>ts||8===r&&1!==a)return tc(e,e7);8===r&&(r=9);let o=new tA;return e.state=o,o.strm=e,o.status=42,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=s,o.method=n,tk(e)};var tR={deflateInit:deflateInit2:tO,deflateReset:tk,deflateResetKeep:tC,deflateSetHeader:deflate:(e,t)=>{if(tN(e)||t>e6||t<0)return e?tc(e,e7):e7;let n=e.state;if(!e.output||0!==e.avail_in&&!e.input||666===n.status&&t!==e4)return tc(e,0===e.avail_out?te:e7);let r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(tp(e),0===e.avail_out)return n.last_flush=-1,e5}else if(0===e.avail_in&&tl(t)<=tl(r)&&t!==e4)return tc(e,te);if(666===n.status&&0!==e.avail_in)return tc(e,te);if(42===n.status&&0===n.wrap&&(n.status=113),42===n.status){let t=tu+(n.w_bits-8<<4)<<8;if(t|=(n.strategy>=tr||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(t|=32),tg(n,t+=31-t%31),0!==n.strstart&&(tg(n,e.adler>>>16),tg(n,65535&e.adler)),e.adler=1,n.status=113,tp(e),0!==n.pending)return n.last_flush=-1,e5}if(57===n.status){if(e.adler=0,tm(n,31),tm(n,139),tm(n,8),n.gzhead)tm(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),tm(n,255&n.gzhead.time),tm(n,n.gzhead.time>>8&255),tm(n,n.gzhead.time>>16&255),tm(n,n.gzhead.time>>24&255),tm(n,9===n.level?2:n.strategy>=tr||n.level<2?4:0),tm(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(tm(n,255&n.gzhead.extra.length),tm(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=eQ(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(tm(n,0),tm(n,0),tm(n,0),tm(n,0),tm(n,0),tm(n,9===n.level?2:n.strategy>=tr||n.level<2?4:0),tm(n,3),n.status=113,tp(e),0!==n.pending)return n.last_flush=-1,e5}if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=eQ(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,tp(e),0!==n.pending)return n.last_flush=-1,e5;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=eQ(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=eQ(e.adler,n.pending_buf,n.pending-r,r)),tp(e),0!==n.pending)return n.last_flush=-1,e5;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,tm(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=eQ(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=eQ(e.adler,n.pending_buf,n.pending-r,r)),tp(e),0!==n.pending)return n.last_flush=-1,e5;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,tm(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=eQ(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(tp(e),0!==n.pending))return n.last_flush=-1,e5;tm(n,255&e.adler),tm(n,e.adler>>8&255),e.adler=0}if(n.status=113,tp(e),0!==n.pending)return n.last_flush=-1,e5}if(0!==e.avail_in||0!==n.lookahead||t!==e1&&666!==n.status){let r=0===n.level?tE(n,t):n.strategy===tr?((n,t):n.strategy===ti?((e,t)=>{let n,r,i,s;let a=e.window;for(;;){if(e.lookahead<=258){if(tb(e),e.lookahead<=258&&t===e1)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=a[i=e.strstart-1])===a[++i]&&r===a[++i]&&r===a[++i]){s=e.strstart+258;do;while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);e.match_length=258-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=e$(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=e$(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(t_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===e4?(t_(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(t_(e,!1),0===e.strm.avail_out)?1:2})(n,t):tS[n.level].func(n,t);if(3!==r&&4!==r||(n.status=666),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),e5;if(2===r&&(t===e2?e0(n):t!==e6&&(eX(n,0,0,!1),t===e3&&(th(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),tp(e),0===e.avail_out))return n.last_flush=-1,e5}return t!==e4?e5:n.wrap<=0?e8:(2===n.wrap?(tm(n,255&e.adler),tm(n,e.adler>>8&255),tm(n,e.adler>>16&255),tm(n,e.adler>>24&255),tm(n,255&e.total_in),tm(n,e.total_in>>8&255),tm(n,e.total_in>>16&255),tm(n,e.total_in>>24&255)):(tg(n,e.adler>>>16),tg(n,65535&e.adler)),tp(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?e5:e8)},deflateEnd:deflateSetDictionary:deflateInfo:"pako deflate (from Nodeca project)"};let tD=var tU={assign:flattenChunks:;let tL=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){tL=!1}let tM=new Uint8Array(256);for(let e=0;e<256;e++)tM[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;tM[254]=tM[254]=1;var tP={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,s,a=e.length,o=0;for(i=0;i<a;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},buf2string:(e,t)=>{let n,r;let i=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let s=Array(2*i);for(r=0,n=0;n<i;){let t=e[n++];if(t<128){s[r++]=t;continue}let a=tM[t];if(a>4)s[r++]=65533,n+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&n<i;)t=t<<6|63&e[n++],a--;a>1?s[r++]=65533:t<65536?s[r++]=t:(t-=65536,s[r++]=55296|t>>10&1023,s[r++]=56320|1023&t)}}return((s,r)},utf8border:,tx=let tq=Object.prototype.toString,{Z_NO_FLUSH:tF,Z_SYNC_FLUSH:tV,Z_FULL_FLUSH:tz,Z_FINISH:tG,Z_OK:tH,Z_STREAM_END:tB,Z_DEFAULT_COMPRESSION:tj,Z_DEFAULT_STRATEGY:tK,Z_DEFLATED:tQ}=eY;.prototype.push=function(e,t){let n,r;let i=this.strm,s=this.options.chunkSize;if(this.ended)return!1;for(r=t===~~t?t:!0===t?tG:tF,"string"==typeof e?i.input=tP.string2buf(e):"[object ArrayBuffer]"===tq.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(s),i.next_out=0,i.avail_out=s),(r===tV||r===tz)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if((n=tR.deflate(i,r))===tB)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),n=tR.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===tH;if(0!==i.avail_out){if(r>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},tW.prototype.onData=function(e){this.chunks.push(e)},tW.prototype.onEnd=var tZ=function(e,t){let n,r,i,s,a,o,u,c,l,h,d,f,p,_,m,g,v,y,b,E,w,I,T,S;let A=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,S=e.output,s=i-(t-e.avail_out),a=i+(e.avail_out-257),o=A.dmax,u=A.wsize,c=A.whave,l=A.wnext,h=A.window,d=A.hold,f=A.bits,p=A.lencode,_=A.distcode,m=(1<<A.lenbits)-1,g=(1<<A.distbits)-1;e:do{f<15&&(d+=T[n++]<<f,f+=8,d+=T[n++]<<f,f+=8),v=p[d&m];t:for(;;){if(d>>>=y=v>>>24,f-=y,0==(y=v>>>16&255))S[i++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=p[(65535&v)+(d&(1<<y)-1)];continue t}if(32&y){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=16209;break e}b=65535&v,(y&=15)&&(f<y&&(d+=T[n++]<<f,f+=8),b+=d&(1<<y)-1,d>>>=y,f-=y),f<15&&(d+=T[n++]<<f,f+=8,d+=T[n++]<<f,f+=8),v=_[d&g];n:for(;;){if(d>>>=y=v>>>24,f-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=_[(65535&v)+(d&(1<<y)-1)];continue n}e.msg="invalid distance code",A.mode=16209;break e}if(E=65535&v,f<(y&=15)&&(d+=T[n++]<<f,(f+=8)<y&&(d+=T[n++]<<f,f+=8)),(E+=d&(1<<y)-1)>o){e.msg="invalid distance too far back",A.mode=16209;break e}if(d>>>=y,f-=y,E>(y=i-s)){if((y=E-y)>c&&A.sane){e.msg="invalid distance too far back",A.mode=16209;break e}if(w=0,I=h,0===l){if(w+=u-y,y<b){b-=y;do S[i++]=h[w++];while(--y);w=i-E,I=S}}else if(l<y){if(w+=u+l-y,(y-=l)<b){b-=y;do S[i++]=h[w++];while(--y);if(w=0,l<b){b-=y=l;do S[i++]=h[w++];while(--y);w=i-E,I=S}}}else if(w+=l-y,y<b){b-=y;do S[i++]=h[w++];while(--y);w=i-E,I=S}for(;b>2;)S[i++]=I[w++],S[i++]=I[w++],S[i++]=I[w++],b-=3;b&&(S[i++]=I[w++],b>1&&(S[i++]=I[w++]))}else{w=i-E;do S[i++]=S[w++],S[i++]=S[w++],S[i++]=S[w++],b-=3;while(b>2);b&&(S[i++]=S[w++],b>1&&(S[i++]=S[w++]))}break}}break}}while(n<r&&i<a);n-=b=f>>3,f-=b<<3,d&=(1<<f)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<a?a-i+257:257-(i-a),A.hold=d,A.bits=f};let tX=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),tJ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),t$=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),t0=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var t1=(e,t,n,r,i,s,a,o)=>{let u=o.bits,c,l,h,d,f,p,_=0,m=0,g=0,v=0,y=0,b=0,E=0,w=0,I=0,T=0,S=null,A=new Uint16Array(16),N=new Uint16Array(16),C,k,O,R=null;for(_=0;_<=15;_++)A[_]=0;for(m=0;m<r;m++)A[t[n+m]]++;for(y=u,v=15;v>=1&&0===A[v];v--);if(y>v&&(y=v),0===v)return i[s++]=20971520,i[s++]=20971520,o.bits=1,0;for(g=1;g<v&&0===A[g];g++);for(y<g&&(y=g),w=1,_=1;_<=15;_++)if(w<<=1,(w-=A[_])<0)return -1;if(w>0&&(0===e||1!==v))return -1;for(N[1]=0,_=1;_<15;_++)N[_+1]=N[_]+A[_];for(m=0;m<r;m++)0!==t[n+m]&&(a[N[t[n+m]]++]=m);if(0===e?(S=R=a,p=20):1===e?(S=tX,R=tJ,p=257):(S=t$,R=t0,p=0),T=0,m=0,_=g,f=s,b=y,E=0,h=-1,d=(I=1<<y)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){C=_-E,a[m]+1<p?(k=0,O=a[m]):a[m]>=p?(k=R[a[m]-p],O=S[a[m]-p]):(k=96,O=0),c=1<<_-E,g=l=1<<b;do i[f+(T>>E)+(l-=c)]=C<<24|k<<16|O|0;while(0!==l);for(c=1<<_-1;T&c;)c>>=1;if(0!==c?(T&=c-1,T+=c):T=0,m++,0==--A[_]){if(_===v)break;_=t[n+a[m]]}if(_>y&&(T&d)!==h){for(0===E&&(E=y),f+=g,w=1<<(b=_-E);b+E<v&&!((w-=A[b+E])<=0);)b++,w<<=1;if(I+=1<<b,1===e&&I>852||2===e&&I>592)return 1;i[h=T&d]=y<<24|b<<16|f-s|0}}return 0!==T&&(i[f+T]=_-E<<24|4194304),o.bits=y,0};let{Z_FINISH:t2,Z_BLOCK:t3,Z_TREES:t4,Z_OK:t6,Z_STREAM_END:t5,Z_NEED_DICT:t8,Z_STREAM_ERROR:t7,Z_DATA_ERROR:t9,Z_MEM_ERROR:ne,Z_BUF_ERROR:nt,Z_DEFLATED:nn}=eY,nr=et ns=na=no=nu=nc=nl,nh,nd=!0,nf=np=var n_={inflateReset:no,inflateReset2:nu,inflateResetKeep:na,inflateInit:inflateInit2:nc,inflate:(e,t)=>{let n,r,i,s,a,o,u,c,l,h,d,f,p,_,m,g,v,y,b,E,w,I,T,S,A=0,N=new Uint8Array(4),C=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ns(e)||!e.output||!e.input&&0!==e.avail_in)return t7;16191===(i=e.state).mode&&(i.mode=16192),u=e.next_out,a=e.output,l=e.avail_out,o=e.next_in,s=e.input,c=e.avail_in,h=i.hold,d=i.bits,f=c,p=l,S=t6;e:for(;;)switch(i.mode){case 16180:if(0===i.wrap){i.mode=16192;break}for(;d<16;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(2&i.wrap&&35615===h){0===i.wbits&&(i.wbits=15),i.check=0,N[0]=255&h,N[1]=h>>>8&255,i.check=eQ(i.check,N,2,0),h=0,d=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&h)<<8)+(h>>8))%31){e.msg="incorrect header check",i.mode=16209;break}if((15&h)!==nn){e.msg="unknown compression method",i.mode=16209;break}if(h>>>=4,d-=4,T=8+(15&h),0===i.wbits&&(i.wbits=T),T>15||T>i.wbits){e.msg="invalid window size",i.mode=16209;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&h?16189:16191,h=0,d=0;break;case 16181:for(;d<16;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(i.flags=h,(255&i.flags)!==nn){e.msg="unknown compression method",i.mode=16209;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=16209;break}i.head&&(i.head.text=h>>8&1),512&i.flags&&4&i.wrap&&(N[0]=255&h,N[1]=h>>>8&255,i.check=eQ(i.check,N,2,0)),h=0,d=0,i.mode=16182;case 16182:for(;d<32;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}i.head&&(i.head.time=h),512&i.flags&&4&i.wrap&&(N[0]=255&h,N[1]=h>>>8&255,N[2]=h>>>16&255,N[3]=h>>>24&255,i.check=eQ(i.check,N,4,0)),h=0,d=0,i.mode=16183;case 16183:for(;d<16;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}i.head&&(i.head.xflags=255&h,i.head.os=h>>8),512&i.flags&&4&i.wrap&&(N[0]=255&h,N[1]=h>>>8&255,i.check=eQ(i.check,N,2,0)),h=0,d=0,i.mode=16184;case 16184:if(1024&i.flags){for(;d<16;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}i.length=h,i.head&&(i.head.extra_len=h),512&i.flags&&4&i.wrap&&(N[0]=255&h,N[1]=h>>>8&255,i.check=eQ(i.check,N,2,0)),h=0,d=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&((_=i.length)>c&&(_=c),_&&(i.head&&(T=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(s.subarray(o,o+_),T)),512&i.flags&&4&i.wrap&&(i.check=eQ(i.check,s,_,o)),c-=_,o+=_,i.length-=_),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===c)break e;_=0;do T=s[o+_++],i.head&&T&&i.length<65536&&(i.head.name+=String.fromCharCode(T));while(T&&_<c);if(512&i.flags&&4&i.wrap&&(i.check=eQ(i.check,s,_,o)),c-=_,o+=_,T)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===c)break e;_=0;do T=s[o+_++],i.head&&T&&i.length<65536&&(i.head.comment+=String.fromCharCode(T));while(T&&_<c);if(512&i.flags&&4&i.wrap&&(i.check=eQ(i.check,s,_,o)),c-=_,o+=_,T)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;d<16;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(4&i.wrap&&h!==(65535&i.check)){e.msg="header crc mismatch",i.mode=16209;break}h=0,d=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=16191;break;case 16189:for(;d<32;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}e.adler=i.check=nr(h),h=0,d=0,i.mode=16190;case 16190:if(0===i.havedict)return e.next_out=u,e.avail_out=l,e.next_in=o,e.avail_in=c,i.hold=h,i.bits=d,t8;e.adler=i.check=1,i.mode=16191;case 16191:if(t===t3||t===t4)break e;case 16192:if(i.last){h>>>=7&d,d-=7&d,i.mode=16206;break}for(;d<3;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}switch(i.last=1&h,d-=1,3&(h>>>=1)){case 0:i.mode=16193;break;case 1:if(nf(i),i.mode=16199,t===t4){h>>>=2,d-=2;break e}break;case 2:i.mode=16196;break;case 3:e.msg="invalid block type",i.mode=16209}h>>>=2,d-=2;break;case 16193:for(h>>>=7&d,d-=7&d;d<32;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if((65535&h)!=(h>>>16^65535)){e.msg="invalid stored block lengths",i.mode=16209;break}if(i.length=65535&h,h=0,d=0,i.mode=16194,t===t4)break e;case 16194:i.mode=16195;case 16195:if(_=i.length){if(_>c&&(_=c),_>l&&(_=l),0===_)break e;a.set(s.subarray(o,o+_),u),c-=_,o+=_,l-=_,u+=_,i.length-=_;break}i.mode=16191;break;case 16196:for(;d<14;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(i.nlen=257+(31&h),h>>>=5,d-=5,i.ndist=1+(31&h),h>>>=5,d-=5,i.ncode=4+(15&h),h>>>=4,d-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=16209;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;d<3;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}i.lens[C[i.have++]]=7&h,h>>>=3,d-=3}for(;i.have<19;)i.lens[C[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,n={bits:i.lenbits},S=t1(0,i.lens,0,19,i.lencode,0,i.work,n),i.lenbits=n.bits,S){e.msg="invalid code lengths set",i.mode=16209;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;v=(A=i.lencode[h&(1<<i.lenbits)-1])>>>24,y=A>>>16&255,b=65535&A,!(v<=d);){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(b<16)h>>>=v,d-=v,i.lens[i.have++]=b;else{if(16===b){for(r=v+2;d<r;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(h>>>=v,d-=v,0===i.have){e.msg="invalid bit length repeat",i.mode=16209;break}T=i.lens[i.have-1],_=3+(3&h),h>>>=2,d-=2}else if(17===b){for(r=v+3;d<r;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}h>>>=v,d-=v,T=0,_=3+(7&h),h>>>=3,d-=3}else{for(r=v+7;d<r;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}h>>>=v,d-=v,T=0,_=11+(127&h),h>>>=7,d-=7}if(i.have+_>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=16209;break}for(;_--;)i.lens[i.have++]=T}}if(16209===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=16209;break}if(i.lenbits=9,n={bits:i.lenbits},S=t1(1,i.lens,0,i.nlen,i.lencode,0,i.work,n),i.lenbits=n.bits,S){e.msg="invalid literal/lengths set",i.mode=16209;break}if(i.distbits=6,i.distcode=i.distdyn,n={bits:i.distbits},S=t1(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,n),i.distbits=n.bits,S){e.msg="invalid distances set",i.mode=16209;break}if(i.mode=16199,t===t4)break e;case 16199:i.mode=16200;case 16200:if(c>=6&&l>=258){e.next_out=u,e.avail_out=l,e.next_in=o,e.avail_in=c,i.hold=h,i.bits=d,tZ(e,p),u=e.next_out,a=e.output,l=e.avail_out,o=e.next_in,s=e.input,c=e.avail_in,h=i.hold,d=i.bits,16191===i.mode&&(i.back=-1);break}for(i.back=0;v=(A=i.lencode[h&(1<<i.lenbits)-1])>>>24,y=A>>>16&255,b=65535&A,!(v<=d);){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(y&&0==(240&y)){for(E=v,w=y,I=b;v=(A=i.lencode[I+((h&(1<<E+w)-1)>>E)])>>>24,y=A>>>16&255,b=65535&A,!(E+v<=d);){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}h>>>=E,d-=E,i.back+=E}if(h>>>=v,d-=v,i.back+=v,i.length=b,0===y){i.mode=16205;break}if(32&y){i.back=-1,i.mode=16191;break}if(64&y){e.msg="invalid literal/length code",i.mode=16209;break}i.extra=15&y,i.mode=16201;case 16201:if(i.extra){for(r=i.extra;d<r;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}i.length+=h&(1<<i.extra)-1,h>>>=i.extra,d-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;v=(A=i.distcode[h&(1<<i.distbits)-1])>>>24,y=A>>>16&255,b=65535&A,!(v<=d);){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(0==(240&y)){for(E=v,w=y,I=b;v=(A=i.distcode[I+((h&(1<<E+w)-1)>>E)])>>>24,y=A>>>16&255,b=65535&A,!(E+v<=d);){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}h>>>=E,d-=E,i.back+=E}if(h>>>=v,d-=v,i.back+=v,64&y){e.msg="invalid distance code",i.mode=16209;break}i.offset=b,i.extra=15&y,i.mode=16203;case 16203:if(i.extra){for(r=i.extra;d<r;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}i.offset+=h&(1<<i.extra)-1,h>>>=i.extra,d-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=16209;break}i.mode=16204;case 16204:if(0===l)break e;if(_=p-l,i.offset>_){if((_=i.offset-_)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=16209;break}_>i.wnext?(_-=i.wnext,m=i.wsize-_):m=i.wnext-_,_>i.length&&(_=i.length),g=i.window}else g=a,m=u-i.offset,_=i.length;_>l&&(_=l),l-=_,i.length-=_;do a[u++]=g[m++];while(--_);0===i.length&&(i.mode=16200);break;case 16205:if(0===l)break e;a[u++]=i.length,l--,i.mode=16200;break;case 16206:if(i.wrap){for(;d<32;){if(0===c)break e;c--,h|=s[o++]<<d,d+=8}if(p-=l,e.total_out+=p,i.total+=p,4&i.wrap&&p&&(e.adler=i.check=i.flags?eQ(i.check,a,p,u-p):ej(i.check,a,p,u-p)),p=l,4&i.wrap&&(i.flags?h:nr(h))!==i.check){e.msg="incorrect data check",i.mode=16209;break}h=0,d=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;d<32;){if(0===c)break e;c--,h+=s[o++]<<d,d+=8}if(4&i.wrap&&h!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=16209;break}h=0,d=0}i.mode=16208;case 16208:S=t5;break e;case 16209:S=t9;break e;case 16210:return ne;default:return t7}return e.next_out=u,e.avail_out=l,e.next_in=o,e.avail_in=c,i.hold=h,i.bits=d,(i.wsize||p!==e.avail_out&&i.mode<16209&&(i.mode<16206||t!==t2))&&np(e,e.output,e.next_out,p-e.avail_out),f-=e.avail_in,p-=e.avail_out,e.total_in+=f,e.total_out+=p,i.total+=p,4&i.wrap&&p&&(e.adler=i.check=i.flags?eQ(i.check,a,p,e.next_out-p):ej(i.check,a,p,e.next_out-p)),e.data_type=i.bits+(i.last?64:0)+(16191===i.mode?128:0)+(16199===i.mode||16194===i.mode?256:0),(0===f&&0===p||t===t2)&&S===t6&&(S=nt),S},inflateEnd:inflateGetHeader:inflateSetDictionary:(e,t)=>{let n;let r=t.length;return ns(e)?t7:0!==(n=e.state).wrap&&16190!==n.mode?t7:16190===n.mode&&ej(1,t,r,0)!==n.check?t9:np(e,t,r,r)?(n.mode=16210,ne):(n.havedict=1,t6)},inflateInfo:"pako inflate (from Nodeca project)"},nm=let ng=Object.prototype.toString,{Z_NO_FLUSH:nv,Z_FINISH:ny,Z_OK:nb,Z_STREAM_END:nE,Z_NEED_DICT:nw,Z_STREAM_ERROR:nI,Z_DATA_ERROR:nT,Z_MEM_ERROR:nS}=eY;function nA(e){this.options=tU.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tx,this.strm.avail_out=0;let n=n_.inflateInit2(this.strm,t.windowBits);if(n!==nb||(this.header=new nm,n_.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=tP.string2buf(t.dictionary):"[object ArrayBuffer]"===ng.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=n_.inflateSetDictionary(this.strm,t.dictionary))!==nb)))throw Error(eW[n])}A.prototype.push=nA.prototype.onData=function(e){this.chunks.push(e)},nA.prototype.onEnd=let{Deflate:nC,deflate:nk,deflateRaw:nO,gzip:nR}={Deflate:tW,deflate:tY,deflateRaw:function(e,t){return(t=t||{}).raw=!0,tY(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,tY(e,t)},constants:eY},{Inflate:nD,inflate:nU,inflateRaw:nL,ungzip:nM}={Inflate:nA,inflate:nN,inflateRaw:ungzip:nN,constants:eY};var nP,nx,nq={Deflate:nC,deflate:nk,deflateRaw:nO,gzip:nR,Inflate:nD,inflate:nU,inflateRaw:nL,ungzip:nM,constants:eY};(nF=nx||(nx={})).CONNECTING="CONNECTING",nF.OPEN="OPEN",nF.CLOSED="CLOSED";var nF,nV,nz=function(e){function t(t,n){var r=n.sdkState,i=n.dispatcher,s=n.logger,a=e.call(this)||this;return a.lastActive=0,a._iid=t,a._sdkState=r,a._dispatcher=i,a._logger=s,a}return u(t,e),Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.connectionState===nx.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return nx.CONNECTING;case 1:return nx.OPEN}return nx.CLOSED},enumerable:!1,configurable:!0}),t.prototype._handleMessage=function(e){var t=this;e.split("\n").forEach(function(e){if(e){var n=ed.createFromRawMessage(t._iid,e);t._logger.debug("receive websocket event",n),"LOGI"===n.code?t.dispatch("message",n):"PONG"===n.code?t.dispatch("pong"):"EXPR"===n.code?n.payload&&n.payload.expires_in>=0&&t._dispatcher.dispatch(new eu):"NOOP"===n.code||t.dispatch("message",n)}})},t.prototype.connect=function(e){var t=this;this._ws=new WebSocket(e),this._ws.onopen=function(){t._logger.debug("websocket open"),t.dispatch("open")},this._ws.onmessage=function(e){return h(t,void 0,void 0,function(){var t,n,r=this;return d(this,function(i){return(null===(n=this._sdkState.websocket)||void 0===n?void 0:n.compression)?e.data instanceof Blob?((t=new FileReader).readAsArrayBuffer(e.data),t.onloadend=function(){return h(r,void 0,void 0,function(){var e;return d(this,function(n){var r;switch(n.label){case 0:return[4,(r=t.result,h(void 0,void 0,void 0,function(){var e;return d(this,function(t){return e=nq.ungzip(r),[2,String.fromCharCode.apply(null,e)]})}))];case 1:return e=n.sent(),this._handleMessage(e),[2]}})})}):"string"==typeof e.data&&this._handleMessage(e.data):this._handleMessage(e.data),[2]})})},this._ws.onerror=function(){t._logger.debug("websocket error"),t.dispatch("error",A.networkError)},this._ws.onclose=this.lastActive=Date.now()},t.prototype.disconnect=function(){var e=this;return new Promise(function(t){e._logger.debug("websocket disconnect"),e._ws&&e.connectionState!==nx.CLOSED?(e._ws.onopen=ef,e._ws.onmessage=ef,e._ws.onerror=ef,e._ws.onclose=e._ws.close(),e._ws=null):t()})},t.prototype.send=function(e){if(!this._ws)throw A.connectionClosed;"PING"!==e.code?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage())},t.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e)},t}($),nG=function(e){function t(t){var n,r=t.code,i=t.ackRequired,s=t.payload,a=this;return(a=e.call(this)||this).code=r,a.payload=void 0===s?null:s,a.requestId=null!==(n=a.payload.req_id)&&void 0!==n?n:X(),a.ackRequired=i,a.payload.req_id=a.requestId,a}return u(t,e),t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},t}(et),nH=function(e){eturn u(t,e),t}(et),nB=nj=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,s=t.logger,a=this;this._ackStateMap=new Map,this._sdkState=r,this._dispatcher=i,this._logger=s,this.apiClient=new eh(e,{auth:n,sdkState:r,dispatcher:i,logger:s}),this.websocketClient=new nz(e,{sdkState:r,dispatcher:i,logger:s}),this.websocketClient.on("message",function(e){if(e.payload.unread_cnt&&a._dispatcher.dispatch(new nH(e.payload.unread_cnt)),e.requestId){if(a._ackStateMap.has(e.requestId)){var t=a._ackStateMap.get(e.requestId);"EROR"!==e.code?t.resolve(e):t.reject(new A({code:e.payload.code,message:e.payload.message}))}}else a._dispatcher.dispatch(e)}).on("close",function(){a._ackStateMap.forEach(,a._ackStateMap.clear()})}return e.prototype._sendApiRequest=e.prototype._sendWebsocketRequest=function(e){return h(this,void 0,void 0,function(){var t,n,r,i=this;return d(this,function(s){if(t=new nB,e.ackRequired){n=null,r=function(r,s){void 0===r&&(r=null),void 0===s&&(s=null),i._ackStateMap.has(e.requestId)&&(i._ackStateMap.delete(e.requestId),n&&(clearTimeout(n),n=null),r?(i._logger.debug("fail websocket request",r),t.reject(r)):(i._logger.debug("receive websocket ack",e.requestId),t.resolve(s)))};try{n=setTimeout(function(){return r(A.noAckTimeout)},this._sdkState.websocket.responseTimeout),this._ackStateMap.set(e.requestId,{resolve:function(e){return r(null,e)},reject:function(e){return r(e)}}),this.websocketClient.send(e)}catch(e){r(e)}}else try{this.websocketClient.send(e),t.resolve(null)}catch(e){t.reject(e)}return[2,t.promise]})})},e.prototype.send=function(e){return h(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return e instanceof es?[4,this._sendApiRequest(e)]:[3,2];case 1:case 3:return[2,t.sent()];case 2:return e instanceof nG?[4,this._sendWebsocketRequest(e)]:[3,4];case 4:throw A.invalidParameters}})})},e.prototype.cancel=function(e){this.apiClient.cancel(e)},e.prototype.cancelAll=e}();(rk=nV||(nV={}))[rk.NONE=0]="NONE",rk[rk.INITIALIZED=1]="INITIALIZED",rk[rk.CONNECTING=2]="CONNECTING",rk[rk.CONNECTED=3]="CONNECTED",rk[rk.RECONNECTING=4]="RECONNECTING",rk[rk.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",rk[rk.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",rk[rk.LOGOUT=7]="LOGOUT";var nK=function(e){function t(t){var n=t.stateType,r=e.call(this)||this;return r.stateType=n,r}return u(t,e),t}(et),nQ=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,s=t.logger,a=this;this._currentConnectionStateType=nV.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new nj(e,{auth:n,sdkState:r,dispatcher:i,logger:s}),this._auth=n,this._logger=s,this._dispatcher=i,this._dispatcher.on(function(e){if(e instanceof nK){var t=e.stateType;switch(a._currentConnectionStateType=t,t){case nV.CONNECTED:var n=a._lazyCallQueue;a._lazyCallQueue=[],n.forEach(function(e){return h(a,void 0,void 0,function(){var t,n,r,i;return d(this,function(s){switch(s.label){case 0:t=e.command,n=e.deferred,clearTimeout(e.timeout),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.send(t)];case 2:return r=s.sent(),n.resolve(r),[3,4];case 3:return i=s.sent(),n.reject(i),[3,4];case 4:return[2]}})})});break;case nV.INITIALIZED:case nV.INTERNAL_DISCONNECTED:case nV.EXTERNAL_DISCONNECTED:case nV.LOGOUT:n=a._lazyCallQueue,a._lazyCallQueue=[],n.forEach(function(e){return h(a,void 0,void 0,function(){var t;return d(this,function(n){return t=e.deferred,clearTimeout(e.timeout),this._auth&&this._auth.hasSession?t.reject(A.connectionClosed):t.reject(A.connectionRequired),[2]})})})}}})}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this._currentConnectionStateType===nV.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLazyCallActivated",{get:enumerable:!1,configurable:!0}),e.prototype.send=function(e){return h(this,void 0,void 0,function(){var t,n,r=this;return d(this,function(i){switch(i.label){case 0:return e instanceof nG?this.isReady?(this._logger.debug("send websocket request",e),[4,this.commandRouter.send(e)]):[3,2]:[3,4];case 1:case 5:return[2,i.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",e),t=new nB,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout(function(){return r.timeout(e.requestId)},1e4)}),[2,t.promise];throw this._logger.debug("fail websocket request"),A.connectionRequired;case 3:return[3,7];case 4:return e instanceof es?this._auth.hasSession?(this._logger.debug("send api request",e),[4,this.commandRouter.send(e)]):[3,6]:[3,7];case 6:if(this.isLazyCallActivated)return this._logger.debug("wait api request",e),t=new nB,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout(function(){return r.timeout(e.requestId)},1e4)}),[2,t.promise];throw n=A.connectionRequired,this._logger.debug("fail api request",n),n;case 7:return[2]}})})},e.prototype.forceSend=function(e){return h(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this._logger.debug("send forced request",e),[4,this.commandRouter.send(e)];case 1:return[2,t.sent()]}})})},e.prototype.timeout=function(e){this._logger.debug("timeout request",e);var t=this._lazyCallQueue.findIndex(;t>-1&&(this._lazyCallQueue[t].deferred.reject(A.connectionRequired),this._lazyCallQueue.splice(t,1))},e.prototype.cancel=e.prototype.cancelAll=e}(),nW="sendbird@devicetokens",nY=function(){eturn e.payloadify=function(e){return{type:e.type,token:e.token}},e}(),nZ="/".concat("v3","/users"),nX="/".concat("v3","/storage/file"),nJ="/".concat("v3","/group_channels"),n$="/".concat("v3","/sdk/group_channels"),n0="/".concat("v3","/open_channels"),n1="/".concat("v3","/sdk/open_channels"),n2="/".concat("v3","/search"),n3="/".concat("v3","/report"),n4="/".concat("v3","/emojis"),n6="/".concat("v3","/emoji_categories"),n5="/".concat("v3","/polls"),n8="/".concat("v3","/scheduled_messages"),n7="/".concat("v3","/sdk/statistics"),n9=function(e){function t(t){var n=t.userId,r=t.authToken,i=t.expiringSession,s=e.call(this)||this;return s.path="".concat(nZ,"/").concat(n,"/session_key"),s.method=Q.POST,s.params={token:r,expiring_session:!!(void 0===i||i)},s.requireAuth=!1,s}return u(t,e),t}(es),re=function(e){function t(t){var n=t.authToken,r=t.expiringSession,i=t.requestId;return e.call(this,{code:"LOGI",payload:{token:n,expiring_session:void 0===r||r?1:0,req_id:void 0===i?null:i},ackRequired:!0})||this}return u(t,e),t}(nG),rt=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.key;return r.key=i,r}return u(t,e),t}(ea),rn=function(e){function t(t,n,r){var i=e.call(this,t,"LOGI",r)||this;return i.error=null,i.newKey=r.new_key,i.error=r.error?new A(r.error):null,i}return u(t,e),t}(ed),rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t}(et),ri=rs=),ra=function(e,t,n){return void 0===n&&(n=new rs),h(void 0,void 0,void 0,function(){var r,i,s,a,o,u;return d(this,function(c){switch(c.label){case 0:r=0,i=null,s=function(e){return void 0===e&&(e=null),i=null!=e?e:Error("Halted")},a=c.label=1;case 1:if(!(-1===t||r<t))return[3,9];c.label=2;case 2:return c.trys.push([2,4,,8]),[4,e(s,a)];case 3:if(o=c.sent(),i)throw i;return[2,o];case 4:if(u=c.sent(),i)return[3,6];if(++r===t)throw u;return[4,ri(n.calcTimeout(r))];case 5:return c.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:return[2]}})})},ro=function(e){return h(void 0,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:if(!((t=n.sent())instanceof A))throw t;return t.throwOutside(),[3,3];case 3:return[2]}})})},ru=function(e){return h(void 0,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})})},rc=new WeakMap,rl=function(e){function t(t){var n=t.auth,r=t.cacheContext,i=t.sdkState,s=t.dispatcher,a=t.requestQueue,o=t.logger,u=e.call(this)||this;return u._currentConnectionStateType=nV.INITIALIZED,u._deviceTokenCacheEnabled=!1,u._isRefreshingAuthToken=!1,u._isRefreshingSessionKey=!1,u.auth=n,u._cacheContext=r,u._sdkState=i,u._dispatcher=s,u._requestQueue=a,u._logger=o,u._deviceTokens=[],u._dispatcher.on(function(e){if(e instanceof nK){var t=e.stateType;u._currentConnectionStateType=t}else e instanceof eu&&u.handler&&(u._logger.debug("session expired"),u.handler.onSessionExpired(),u.refresh())}),u}return u(t,e),Object.defineProperty(t.prototype,"ekey",{get:enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),t.prototype.indexOfDeviceToken=t.prototype.hasDeviceToken=t.prototype.createRefreshWebsocketCommand=function(e,t){return void 0===t&&(t=null),new re({authToken:e,expiringSession:!0,requestId:t})},t.prototype._refreshSessionKeyByWebSocket=function(e){return h(this,void 0,void 0,function(){var t,n,r,i;return d(this,function(s){switch(s.label){case 0:return t=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(t)];case 1:if(r=(n=s.sent().as(rn)).newKey,i=n.error)throw i;return this.auth.sessionKey=null!=r?r:this.auth.sessionKey,[2]}})})},t.prototype._refreshSessionKeyByApi=function(e){return h(this,void 0,void 0,function(){var t,n=this;return d(this,function(r){switch(r.label){case 0:return t=new n9({userId:this._sdkState.userId,authToken:e,expiringSession:!0}),[4,ra(function(e){return h(n,void 0,void 0,function(){var n,r;return d(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(t)];case 1:return n=i.sent().as(rt).key,this.auth.sessionKey=n,[3,3];case 2:if(r=i.sent(),!this._isSessionRelatedError(r))throw r;return e(r),[3,3];case 3:return[2]}})})},3)];case 1:return r.sent(),[2]}})})},t.prototype._refreshSessionKey=function(e,t){return void 0===t&&(t=!0),h(this,void 0,void 0,function(){var n,r,i,s;return d(this,function(a){switch(a.label){case 0:if(this._currentConnectionStateType!==nV.CONNECTED)return[3,10];a.label=1;case 1:return a.trys.push([1,3,,10]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return a.sent(),this.complete(),[2];case 3:return n=a.sent(),this._isSessionRelatedError(n)&&t?(r=this.auth,[4,this._receiveNewAuthToken()]):[3,9];case 4:return r.authToken=a.sent(),this.auth.authToken?[4,this._refreshSessionKey(this.auth.authToken,!1)]:[3,6];case 5:return a.sent(),this.complete(),[3,8];case 6:return[4,this.clear()];case 7:a.sent(),this.close(),a.label=8;case 8:return[2];case 9:return[3,10];case 10:return a.trys.push([10,12,,22]),[4,this._refreshSessionKeyByApi(e)];case 11:return a.sent(),this.complete(),[3,22];case 12:return i=a.sent(),this._isSessionRelatedError(i)?t?(s=this.auth,[4,this._receiveNewAuthToken()]):[3,18]:[3,20];case 13:return s.authToken=a.sent(),this.auth.authToken?[4,this._refreshSessionKeyByApi(this.auth.authToken)]:[3,15];case 14:return a.sent(),this.complete(),[3,17];case 15:return[4,this.clear()];case 16:a.sent(),this.close(),a.label=17;case 17:return[3,19];case 18:case 20:throw i;case 19:return[3,21];case 21:return[3,22];case 22:return[2]}})})},t.prototype._receiveNewAuthToken=function(){var e=this,t=new nB;return ro(function(){return h(e,void 0,void 0,function(){var e,n,r=this;return d(this,function(i){return this._isRefreshingAuthToken=!0,this.auth.clear(),e=null,n=e=setTimeout(1e3*this._sdkState.sessionTokenRefreshTimeout),this.handler.onSessionTokenRequired(function(e){n(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,r.dispatch("refresh-authtoken"),t.resolve(e))},function(e){n(),r._isRefreshingAuthToken=!1,t.reject(e)}),[2]})})}),t.promise},t.prototype._isSessionRelatedError=function(e){return e instanceof A&&(e.isSessionKeyExpiredError||e.isSessionTokenExpiredError)},Object.defineProperty(t.prototype,"isSessionKeyRefreshing",{get:function(){return this._isRefreshingSessionKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),t.prototype.login=function(e){return h(this,void 0,void 0,function(){var t,n;return d(this,function(r){switch(r.label){case 0:return this.auth.sessionKey=e.key,rc.set(this,e.ekey),t=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,t.get(nW)]:[3,4];case 1:return(n=r.sent())&&!(n.lastDeletedAt<e.deviceTokenLastDeletedAt)?[3,3]:(this._deviceTokens=[],this._deviceTokenLastDeletedAt=e.deviceTokenLastDeletedAt,[4,this.saveDeviceToken()]);case 2:return r.sent(),[3,4];case 3:this._deviceTokens=n.tokens.map(,this._deviceTokenLastDeletedAt=n.lastDeletedAt,r.label=4;case 4:return[2]}})})},t.prototype.complete=function(){var e=this;this.dispatch("refresh"),ro(function(){return h(e,void 0,void 0,function(){return d(this,function(e){return this._logger.debug("session refreshed"),this.handler.onSessionRefreshed(),[2]})})})},t.prototype.error=function(e){var t=this;ro(function(){return h(t,void 0,void 0,})},t.prototype.close=function(){var e=this;this.dispatch("close"),ro(function(){return h(e,void 0,void 0,function(){return d(this,function(e){return this._logger.debug("session closed"),this.handler.onSessionClosed(),[2]})})})},t.prototype.refresh=function(){return h(this,void 0,void 0,function(){var e,t;return d(this,function(n){switch(n.label){case 0:if(!this.handler||this._isRefreshingSessionKey)return[3,10];if(this._isRefreshingSessionKey=!0,this.auth.authToken)return[3,7];n.label=1;case 1:return n.trys.push([1,6,,7]),[4,this._receiveNewAuthToken()];case 2:return(e=n.sent())?(this._logger.debug("session refreshing.."),this.auth.authToken=e,[3,5]):[3,3];case 3:return[4,this.clear()];case 4:return n.sent(),this.close(),this._isRefreshingSessionKey=!1,[2];case 5:return[3,7];case 6:throw n.sent(),t=A.sessionTokenRequestFailed,this._dispatcher.dispatch(new rr),this.error(t),this._isRefreshingSessionKey=!1,t;case 7:return n.trys.push([7,9,,10]),[4,this._refreshSessionKey(this.auth.authToken)];case 8:return n.sent(),this._isRefreshingSessionKey=!1,[3,10];case 9:throw n.sent(),t=A.sessionTokenRefreshFailed,this._dispatcher.dispatch(new rr),this.error(t),this._isRefreshingSessionKey=!1,t;case 10:return[2]}})})},t.prototype.setDeviceToken=function(e,t){return 0>this.indexOfDeviceToken(e,t)&&(this._deviceTokens.push(new nY({type:e,token:t})),!0)},t.prototype.unsetDeviceToken=function(e,t){var n=this.indexOfDeviceToken(e,t);n>=0&&this._deviceTokens.splice(n,1)},t.prototype.unsetDeviceTokens=t.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e)},t.prototype.saveDeviceToken=function(){return h(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(nW,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return h(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return this.currentUser=null,this.auth.clear(),rc.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),[2]}})})},t}($),rh=function(){function e(){this.type=nV.NONE,this.name="none"}return e.prototype.run=function(e){return h(this,void 0,void 0,function(){return d(this,function(e){return[2]})})},e.prototype.onConnect=function(e,t){return h(this,void 0,void 0,function(){return d(this,function(e){return[2]})})},e.prototype.onReconnect=function(e,t){return t.resetReconnectCount,h(this,void 0,void 0,function(){return d(this,function(e){return[2]})})},e.prototype.onDisconnect=function(e,t){return t.error,t.autoReconnect,h(this,void 0,void 0,function(){return d(this,function(e){return[2]})})},e.prototype.onDisconnectWebSocket=function(e){return h(this,void 0,void 0,function(){return d(this,function(e){return[2]})})},e.prototype.onLogout=e}(),rd=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=nV.LOGOUT,t.name="logout",t}return u(t,e),t.prototype.run=function(e){return h(this,void 0,void 0,function(){var t,n,r=this;return d(this,function(i){switch(i.label){case 0:return t=Date.now(),n=e.sdkState.userId,[4,e.logout()];case 1:return i.sent(),[4,e.changeState(new rv,t)];case 2:return i.sent(),ro(function(){return h(r,void 0,void 0,function(){return d(this,function(t){return e.connectionHandlers.forEach(function(e){e.onDisconnected(n)}),[2]})})}),[2]}})})},t}(rh),rf=function(e){eturn u(t,e),t.prototype.run=function(e){return h(this,void 0,void 0,},t.prototype.onConnect=function(e,t){return h(this,void 0,void 0,function(){var n;return d(this,function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new rg({authToken:t}),n)];case 2:return r.sent(),[2]}})})},t.prototype.onReconnect=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new r_,t)];case 1:return n.sent(),[2]}})})},t.prototype.onLogout=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new rd,t)];case 1:return n.sent(),[2]}})})},t}(rh),rp=function(e){function t(t){var n=t.autoReconnect,r=e.call(this)||this;return r.type=nV.INTERNAL_DISCONNECTED,r.name="internaldisconnected",r._autoReconnect=!1,r._autoReconnect=n,r}return u(t,e),t.prototype.run=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),this._autoReconnect?[4,e.changeState(new r_,t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.onConnect=function(e,t){return h(this,void 0,void 0,function(){var n;return d(this,function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new rg({authToken:t}),n)];case 2:return r.sent(),[2]}})})},t.prototype.onReconnect=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new r_,t)];case 1:return n.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new rf,t)];case 1:return n.sent(),[2]}})})},t.prototype.onLogout=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new rd,t)];case 1:return n.sent(),[2]}})})},t}(rh),r_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=nV.RECONNECTING,t.name="reconnecting",t._haltConnect=null,t._resetConnect=null,t._callbacks=[],t}return u(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=null)},t.prototype._flushCallbacks=function(e){void 0===e&&(e=null),this._haltConnect=null,this._resetConnect=null,this._callbacks.forEach(function(t){return t(e)})},t.prototype.run=function(e){return h(this,void 0,void 0,function(){var t,n,r,i,s=this;return d(this,function(a){switch(a.label){case 0:t=Date.now(),n=new nB,this._callbacks.push(function(e){return e?n.reject(e):n.resolve()}),ro(function(){return h(s,void 0,void 0,function(){return d(this,function(t){return e.connectionHandlers.forEach(function(e){e.onReconnectStarted()}),[2]})})}),a.label=1;case 1:return a.trys.push([1,4,,9]),[4,ra(function(t,n){return h(s,void 0,void 0,function(){var r;return d(this,function(i){switch(i.label){case 0:this._haltConnect=t,this._resetConnect=n,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.connect()];case 2:return i.sent(),[3,4];case 3:if(r=i.sent(),e.clearLoginTimer(),r instanceof A&&r.code===m.CONNECTION_CANCELED)return t(r),[2];throw r;case 4:return[2]}})})},(r=e.sdkState.websocket).reconnectMaxRetry,r.reconnectRetryStrategy)];case 2:return a.sent(),[4,e.changeState(new rm,t)];case 3:return a.sent(),ro(function(){return h(s,void 0,void 0,function(){return d(this,function(t){return this._flushCallbacks(null),e.connectionHandlers.forEach(function(e){e.onReconnectSucceeded()}),[2]})})}),[3,9];case 4:return S(i=a.sent())?[3,7]:i instanceof A?i.code===m.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new rp({autoReconnect:!1}),t)]:[3,6];case 5:a.sent(),a.label=6;case 6:return ro(function(){return h(s,void 0,void 0,function(){return d(this,function(t){return this._flushCallbacks(i),e.connectionHandlers.forEach(,[2]})})}),[3,8];case 7:throw i;case 8:return[3,9];case 9:return[2,n.promise]}})})},t.prototype.onConnect=function(e,t){return h(this,void 0,void 0,function(){var n;return d(this,function(r){return n=new nB,this._halt(A.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push(function(){var r=Date.now();e.changeState(new rg({authToken:t}),r).then(function(){n.resolve()}).catch(function(e){n.reject(e)})}),[2,n.promise]})})},t.prototype.onReconnect=function(e,t){var n=t.resetReconnectCount,r=void 0!==n&&n;return h(this,void 0,void 0,function(){var e;return d(this,function(t){return e=new nB,this._resetConnect&&r&&this._resetConnect(),this._callbacks.push(function(t){return t?e.reject(t):e.resolve()}),[2,e.promise]})})},t.prototype.onDisconnect=function(e,t){t.error;var n=t.autoReconnect,r=void 0===n||n;return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(A.connectionCanceled),[4,e.changeState(new rp({autoReconnect:r}),t)];case 1:return n.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(A.connectionCanceled),[4,e.changeState(new rf,t)];case 1:return n.sent(),[2]}})})},t.prototype.onLogout=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(A.connectionCanceled),[4,e.changeState(new rd,t)];case 1:return n.sent(),[2]}})})},t}(rh),rm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=nV.CONNECTED,t.name="connected",t}return u(t,e),t.prototype.onReconnect=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),[4,e.changeState(new r_,t)];case 2:return n.sent(),[2]}})})},t.prototype.onDisconnect=function(e,t){var n=t.autoReconnect;return h(this,void 0,void 0,function(){var t;return d(this,function(r){switch(r.label){case 0:return t=Date.now(),[4,e.changeState(new rp({autoReconnect:n}),t)];case 1:return r.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new rf,t)];case 1:return n.sent(),[2]}})})},t.prototype.onLogout=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new rd,t)];case 1:return n.sent(),[2]}})})},t}(rh),rg=function(e){function t(t){var n=t.authToken,r=e.call(this)||this;return r.type=nV.CONNECTING,r.name="connecting",r._authToken="",r._haltConnect=null,r._callbacks=[],r._authToken=n,r}return u(t,e),t.prototype._halt=t.prototype._flushCallbacks=function(e){void 0===e&&(e=null),this._haltConnect=null,this._callbacks.forEach(function(t){return t(e)})},t.prototype.run=function(e){return h(this,void 0,void 0,function(){var t,n,r,i=this;return d(this,function(s){switch(s.label){case 0:t=Date.now(),n=new nB,this._callbacks.push(function(e){return e?n.reject(e):n.resolve()}),s.label=1;case 1:return s.trys.push([1,4,,10]),[4,ra(function(t){return h(i,void 0,void 0,function(){var n;return d(this,function(r){switch(r.label){case 0:this._haltConnect=t,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return r.sent(),[3,4];case 3:if(n=r.sent(),e.clearLoginTimer(),n instanceof A&&n.code===m.CONNECTION_CANCELED)return t(n),[2];throw n;case 4:return[2]}})})},e.sdkState.websocket.connectMaxRetry)];case 2:return s.sent(),[4,e.changeState(new rm,t)];case 3:return s.sent(),ro(function(){return h(i,void 0,void 0,function(){return d(this,function(t){return this._flushCallbacks(null),e.connectionHandlers.forEach(,[2]})})}),[3,10];case 4:return S(r=s.sent())?[3,8]:[4,e.disconnect()];case 5:return s.sent(),r instanceof A?r.code===m.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new rv,t)]:[3,7];case 6:s.sent(),s.label=7;case 7:return ro(function(){return h(i,void 0,void 0,}),[3,9];case 8:throw r;case 9:return[3,10];case 10:return[2,n.promise]}})})},t.prototype.onConnect=function(e){return h(this,void 0,void 0,function(){var e;return d(this,function(t){return e=new nB,this._callbacks.push(,[2,e.promise]})})},t.prototype.onDisconnect=function(e,t){var n=t.error,r=void 0===n?null:n,i=t.autoReconnect;return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(null!=r?r:A.connectionCanceled),e.hasSession?[4,e.changeState(new rp({autoReconnect:i}),t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new rd,t)];case 3:n.sent(),n.label=4;case 4:return[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(A.connectionCanceled),e.hasSession?[4,e.changeState(new rf,t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new rd,t)];case 3:n.sent(),n.label=4;case 4:return[2]}})})},t.prototype.onLogout=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(A.connectionCanceled),[4,e.changeState(new rd,t)];case 1:return n.sent(),[2]}})})},t}(rh),rv=function(e){eturn u(t,e),t.prototype.onConnect=function(e,t){return h(this,void 0,void 0,function(){var n;return d(this,function(r){switch(r.label){case 0:return n=Date.now(),[4,e.changeState(new rg({authToken:t}),n)];case 1:return r.sent(),[2]}})})},t}(rh),ry=function(e){function t(){return e.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return u(t,e),t}(nG),rb=function(){function e(e){var t=e.pingDelegate,n=e.sdkState,r=e.logger;this._pingTimer=null,this._pingTimeoutTimer=null,this.pingDelegate=t,this.sdkState=n,this._logger=r}return Object.defineProperty(e.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),e.prototype.ping=function(){var e,t=this,n=new ry;try{var r=null!==(e=this.sdkState.websocket.pongTimeout)&&void 0!==e?e:5e3;this._pingTimeoutTimer=setTimeout(r),this.pingDelegate.send(n),this._logger.debug("pinger.ping()")}catch(e){this._logger.debug("pinger.ping() error",e),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=null),this.pingDelegate.error(null)}return n},e.prototype.pong=e.prototype.refreshTimer=function(){var e,t=this;this._logger.debug("pinger.refreshTimer()");var n=null!==(e=this.sdkState.websocket.pingInterval)&&void 0!==e?e:15e3;this.stop(),this._pingTimer=setInterval(function(){t.ping()},n)},e.prototype.start=e.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=null),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=null)},e}(),rE=function(){function e(e){void 0===e&&(e={}),this.emojiHash=e.emoji_hash||"",this.uploadSizeLimit=e.file_upload_size_limit?1048576*e.file_upload_size_limit:Number.MAX_SAFE_INTEGER,this.useReaction=!!e.use_reaction,this.applicationAttributes=e.application_attributes||[],this.premiumFeatureList=e.premium_feature_list||[],this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history")}return e.payloadify=function(e){return{emoji_hash:e.emojiHash,file_upload_size_limit:e.uploadSizeLimit/1048576,application_attributes:e.applicationAttributes,premium_feature_list:e.premiumFeatureList,use_reaction:e.useReaction}},e}(),rw=function(){eturn e.payloadify=function(e){return e?{}:null},e}(),rI=function(e){function t(t){var n=t.userId,r=t.metadata,i=e.call(this)||this;return i.method=Q.POST,i.path="".concat(nZ,"/").concat(n,"/metadata"),i.params={metadata:r},i}return u(t,e),t}(es),rT=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaData=n,r}return u(t,e),t}(ea),rS=function(e){function t(t){var n=t.userId,r=t.metadata,i=t.upsert,s=e.call(this)||this;return s.method=Q.PUT,s.path="".concat(nZ,"/").concat(n,"/metadata"),s.params={metadata:r,upsert:i},s}return u(t,e),t}(es),rA=function(e){eturn u(t,e),t}(ea),rN=function(e){function t(t){var n=t.userId,r=t.metadataKey,i=e.call(this)||this;return i.method=Q.DELETE,i.path="".concat(nZ,"/").concat(n,"/metadata/").concat(r),i}return u(t,e),t}(es);u(function(){return null!==rO&&rO.apply(this,arguments)||this},rO=ea);var rC=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Q.DELETE,r.path="".concat(nZ,"/").concat(n,"/metadata"),r}return u(t,e),t}(es);u(function(){return null!==rR&&rR.apply(this,arguments)||this},rR=ea);var rk,rO,rR,rD,rU=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return n._iid&&delete n._iid,t&&t(n),n},rL=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},rM=function(e){return{do:throw:};(rP=rD||(rD={})).ONLINE="online",rP.OFFLINE="offline",rP.NON_AVAILABLE="nonavailable";var rP,rx,rq=function(e){function t(t,n){var r,i,s,a,o,u,c,l,h,d,f,m,g=this;return(g=e.call(this,t)||this).userId=null!==(i=null!==(r=n.guest_id)&&void 0!==r?r:n.user_id)&&void 0!==i?i:"",g.nickname=null!==(a=null!==(s=n.nickname)&&void 0!==s?s:n.name)&&void 0!==a?a:"",g.plainProfileUrl=null!==(u=null!==(o=n.profile_url)&&void 0!==o?o:n.image)&&void 0!==u?u:"",g.requireAuth=null!==(c=n.require_auth_for_profile_image)&&void 0!==c&&c,g.metaData=null!==(l=n.metadata)&&void 0!==l?l:{},g.connectionStatus=rD.NON_AVAILABLE,R(rD,n.is_online)?g.connectionStatus=n.is_online:O("boolean",n.is_online)&&(g.connectionStatus=n.is_online?rD.ONLINE:rD.OFFLINE),g.isActive=null===(h=n.is_active)||void 0===h||h,g.lastSeenAt=null!==(d=n.last_seen_at)&&void 0!==d?d:null,g.preferredLanguages=n.preferred_languages?_([],p(n.preferred_languages),!1):null,g.friendDiscoveryKey=null!==(f=n.friend_discovery_key)&&void 0!==f?f:null,g.friendName=null!==(m=n.friend_name)&&void 0!==m?m:null,g}return u(t,e),t.payloadify=function(t){return t?en(c(c({},e.payloadify.call(this,t)),{user_id:t.userId,nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth,metadata:t.metaData,is_online:t.connectionStatus,is_active:t.isActive,last_seen_at:t.lastSeenAt,preferred_languages:t.preferredLanguages,friend_discovery_key:t.friendDiscoveryKey,friend_name:t.friendName})):null},Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=r7.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return rU(this)},t.prototype._isValidMetaData=function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map(function(t){return e[t]}).every(},t.prototype._applyMetaData=function(e,t){var n=this;void 0===t&&(t=!1),Object.keys(e).forEach(function(r){t?delete n.metaData[r]:n.metaData[r]=e[r]})},t.prototype.createMetaData=function(e){return h(this,void 0,void 0,function(){var t,n,r,i,s;return d(this,function(a){switch(a.label){case 0:return rM(this._isValidMetaData(e)).throw(A.invalidParameters),n=(t=r7.of(this._iid)).sdkState,r=t.requestQueue,i=new rI({userId:n.userId,metadata:e}),[4,r.send(i)];case 1:return s=a.sent().as(rT).metaData,this._applyMetaData(s),[2,this.metaData]}})})},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),h(this,void 0,void 0,function(){var n,r,i,s,a;return d(this,function(o){switch(o.label){case 0:return rM(this._isValidMetaData(e)).throw(A.invalidParameters),r=(n=r7.of(this._iid)).sdkState,i=n.requestQueue,s=new rS({userId:r.userId,metadata:e,upsert:t}),[4,i.send(s)];case 1:return a=o.sent().as(rA).metadata,this._applyMetaData(a),[2,this.metaData]}})})},t.prototype.deleteMetaData=function(e){return h(this,void 0,void 0,function(){var t,n,r,i,s;return d(this,function(a){switch(a.label){case 0:return rM(O("string",e)).throw(A.invalidParameters),n=(t=r7.of(this._iid)).sdkState,r=t.requestQueue,i=new rN({userId:n.userId,metadataKey:e}),[4,r.send(i)];case 1:return a.sent(),this._applyMetaData(((s={})[e]=!0,s),!0),[2,this.metaData]}})})},t.prototype.deleteAllMetaData=function(){return h(this,void 0,void 0,function(){var e,t,n,r;return d(this,function(i){switch(i.label){case 0:return t=(e=r7.of(this._iid)).sdkState,n=e.requestQueue,r=new rC({userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.metaData={},[2]}})})},t}(rw),rF=function(e){function t(t){var n=t.userProfile,r=e.call(this)||this;return r.userProfile=n,r}return u(t,e),t}(et),rV=function(){function e(e,t){var n,r,i,s,a,o,u,c,l,h,d,f,p,_;this._iid=e,this.appInfo=new rE(t),this.user=new rq(e,t),this.connectedAt=null!==(n=t.login_ts)&&void 0!==n?n:0,this.firstConnectedAt=0,this.pingInterval=null!==(r=t.ping_interval)&&void 0!==r?r:15e3,this.pongTimeout=null!==(i=t.pong_timeout)&&void 0!==i?i:5e3,this.reconnectInterval=null!==(a=null===(s=t.reconnect)||void 0===s?void 0:s.interval)&&void 0!==a?a:3e3,this.reconnectMaxInterval=null!==(u=null===(o=t.reconnect)||void 0===o?void 0:o.max_interval)&&void 0!==u?u:6e4,this.reconnectRetryCount=null!==(l=null===(c=t.reconnect)||void 0===c?void 0:c.retry_cnt)&&void 0!==l?l:5,this.reconnectIntervalMultiple=null!==(d=null===(h=t.reconnect)||void 0===h?void 0:h.mul)&&void 0!==d?d:2,this.maxUnreadCountOnSuperGroup=null!==(f=t.max_unread_cnt_on_super_group)&&void 0!==f?f:100,this.profileImageEncryption=!!t.profile_image_encryption,this.concurrentCallLimit=null!==(p=t.concurrent_call_limit)&&void 0!==p?p:5,this.backOffDelay=null!==(_=t.back_off_delay)&&void 0!==_?_:100}return e.payloadify=function(e){return c(c(c({},rq.payloadify(e.user)),rE.payloadify(e.appInfo)),{login_ts:e.connectedAt,ping_interval:e.pingInterval,pong_timeout:e.pongTimeout,reconnect:{interval:e.reconnectInterval,max_interval:e.reconnectMaxInterval,retry_cnt:e.reconnectRetryCount,mul:e.reconnectIntervalMultiple},max_unread_cnt_on_super_group:e.maxUnreadCountOnSuperGroup,profile_image_encryption:e.profileImageEncryption,concurrent_call_limit:e.concurrentCallLimit,back_off_delay:e.backOffDelay})},e.prototype.apply=function(){var e=this.reconnectInterval,t=this.reconnectMaxInterval,n=this.reconnectIntervalMultiple,r=r7.of(this._iid);r.sdkState.websocket.pingInterval=1e3*this.pingInterval,r.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,r.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,r.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(r){return r>0?1e3*Math.min(e*Math.pow(n,r-1),t):10}},r.appInfo=this.appInfo,r.sessionManager.currentUser=this.user,r.connectedAt=this.connectedAt,this.firstConnectedAt||(r.firstConnectedAt=this.connectedAt),r.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,r.concurrentCallLimit=this.concurrentCallLimit,r.backOffDelay=this.backOffDelay,r.dispatcher.dispatch(new rF({userProfile:this}))},e}(),rz=function(e){function t(t,n,r){var i,s=this;return(s=e.call(this,t,n,r)||this).error=null,s.userProfile=new rV(t,r),s.deviceTokenLastDeletedAt=r.device_token_last_deleted_at,s.key=r.key,s.ekey=null!==(i=r.ekey)&&void 0!==i?i:"",s.error=r.error?new A(r):null,s}return u(t,e),t.asError=function(e){return new t(null,"LOGI",c({user_id:null,error:!0},e))},t.prototype.applyTo=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return this.error?[3,4]:(t=r7.of(e))?[4,t.sessionManager.login(this)]:[3,2];case 1:return n.sent(),this.userProfile.apply(),[3,3];case 2:throw A.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}})})},t}(ed),rG=function(e){function t(t){var n=e.call(this)||this;return n.enabled=t,n}return u(t,e),t}(et),rH=function(e){function t(t,n){var r=n.sdkState,i=n.cacheContext,s=n.connectionHandlers,a=n.sessionManager,o=n.websocketClient,u=n.dispatcher,c=n.logger,l=n.entryState,h=void 0===l?new rv:l,d=e.call(this)||this;return d._currentState=null,d._loginTimer=null,d._unresolvedLogi=null,d._stateUpdatedAt=0,d._connectingAt=0,d._connectionRequestQueue=[],d._iid=t,d.sdkState=r,d.cacheContext=i,d.connectionHandlers=s,d._sessionManager=a,d._websocketClient=o,d._dispatcher=u,d._logger=c,d._currentState=h,d.sdkState.websocket.pingerDisabled||(d._pinger=new rb({pingDelegate:{send:function(e){return d._websocketClient.send(e)},error:function(e){return d._websocketClient.error(e)}},sdkState:d.sdkState,logger:c})),d._websocketClient.on("open",.on("message",function(e){"LOGI"===e.code&&(d.clearLoginTimer(),d._dispatcher.dispatch(e.as(rz)))}).on("ping-refresh",function(){var e;return null===(e=d._pinger)||void 0===e?void 0:e.refreshTimer()}).on("pong",function(){var e;return null===(e=d._pinger)||void 0===e?void 0:e.pong()}).on("error",function(){var e;return null===(e=d._pinger)||void 0===e?void 0:e.stop()}).on("close",,d._dispatcher.on(,d}return u(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSession",{get:enumerable:!1,configurable:!0}),t.prototype.changeState=function(e,t){return h(this,void 0,void 0,function(){return d(this,function(n){switch(n.label){case 0:return t>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=t,this._dispatcher.dispatch(new nK({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}})})},t.prototype._tryResolveConnectionRequest=function(){var e;return h(this,void 0,void 0,function(){var t,n;return d(this,function(r){switch(r.label){case 0:return t=this._unresolvedLogi,this._websocketClient.isOpen&&t?(this._unresolvedLogi=null,t.error?[3,2]:[4,t.applyTo(this._iid)]):[3,3];case 1:return r.sent(),n=t.userProfile,this._enableStatLog(n.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish")),this._statLogConnection(null),null===(e=this._pinger)||void 0===e||e.start(),this._connectionRequestQueue.forEach(function(e){return e.resolve()}),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.auth.authToken=null,(t.error.isSessionKeyExpiredError||t.error.isSessionTokenExpiredError)&&this._dispatcher.dispatch(new eu),this._rejectConnectionRequest(t.error),r.label=3;case 3:return[2]}})})},t.prototype._rejectConnectionRequest=function(e){var t;null===(t=this._pinger)||void 0===t||t.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0&&(this._connectionRequestQueue.forEach(function(t){return t.reject(e)}),this._connectionRequestQueue=[],this._statLogConnection(e))},t.prototype._url=function(e){void 0===e&&(e="");var t,n=this.sdkState,r=n.appId,i=n.appVersion,s=n.userId,a=n.extensions,o=this.cacheContext.localCacheEnabled,u=this._sessionManager.auth,c=null===(t=this.sdkState.websocket)||void 0===t?void 0:t.compression,l=a.sb_syncmanager?"s".concat(a.sb_syncmanager):"",h=a.sb_uikit?"u".concat(a.sb_uikit):"",d="JS/c".concat(v.SDK_VERSION,"/").concat(l,"/").concat(h);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(v.OS_VERSION),"&sv=").concat(encodeURIComponent(v.SDK_VERSION),"&ai=").concat(r).concat(i?"&av=".concat(i):"").concat(u.hasSession?"&key=".concat(encodeURIComponent(u.sessionKey)):"&user_id=".concat(encodeURIComponent(s),"&access_token=").concat(encodeURIComponent(e)),"&pmce=").concat(c?1:0,"&active=1&device_token_types=").concat(encodeURIComponent("gcm,huawei,apns"),"&SB-User-Agent=").concat(d,"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash"]))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(o?1:0,"&include_poll_details=1")},t.prototype._enableStatLog=t.prototype._statLogConnection=function(e){this._dispatcher.dispatch(new ec(new el({type:ei.WEBSOCKET_CONNECT,data:{host_url:this.sdkState.websocket.host,success:!e,latency:Date.now()-this._connectingAt,error_code:null==e?void 0:e.code,error_description:null==e?void 0:e.message}})))},t.prototype.connect=function(e){return void 0===e&&(e=""),h(this,void 0,void 0,function(){var t,n,r=this;return d(this,function(i){return t=this._url(e),n=new nB,this._connectionRequestQueue.push(n),1===this._connectionRequestQueue.length&&(this._connectingAt=Date.now(),this._loginTimer=setTimeout(function(){r._loginTimer=null,r._dispatcher.dispatch(rz.asError(A.loginTimeout))},this.sdkState.websocket.responseTimeout),this._sessionManager.auth.authToken=e,this._websocketClient.connect(t)),[2,n.promise]})})},t.prototype.cancelConnectForRetry=t.prototype.disconnect=t.prototype.logout=function(){return h(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return this.sdkState.userId=null,this._unresolvedLogi=null,[4,this._sessionManager.clear()];case 1:return e.sent(),[4,this.disconnect()];case 2:return e.sent(),[2]}})})},t.prototype.clearLoginTimer=t}($),rB=function(){function e(e,t){var n=t.sdkState,r=t.cacheContext,i=t.connectionHandlers,s=t.sessionManager,a=t.websocketClient,o=t.dispatcher,u=t.logger,c=t.disableWebSocketCloseEventHandling;this._context=null,this._disableWebSocketCloseEventHandling=!1,this._externalCalledWebSocketClose=!1,this._logger=u,this._disableWebSocketCloseEventHandling=void 0!==c&&c,this._context=new rH(e,{sdkState:n,cacheContext:r,connectionHandlers:i,sessionManager:s,websocketClient:a,dispatcher:o,logger:u}),this._sdkState=n,this._sessionManager=s,this._websocketClient=a}return e.prototype._registerEventDispatcher=function(){var e=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh-authtoken",function(){e.isConnected||(e._logger.debug("try reconnect by session token refresh"),e.reconnect())}).on("refresh",function(){e.isConnecting||e.isConnected||(e._logger.debug("try reconnect by session key refresh"),e.reconnect())}),this._websocketEventDispatcherContext=this._websocketClient.on("close",function(){"foreground"!==e._sdkState.appState||e._externalCalledWebSocketClose||e._sessionManager.isRefreshingAuthToken||(e._logger.debug("try reconnect by websocket connection closed"),e.reconnect())}))},e.prototype._clearEventDispatcher=Object.defineProperty(e.prototype,"isConnected",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnecting",{get:function(){var e=this._context.currentState;return e.type===nV.CONNECTING||e.type===nV.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){return h(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return t=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,t.onConnect(this._context,e)];case 1:return n.sent(),this._registerEventDispatcher(),[2]}})})},e.prototype.reconnect=function(){return h(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,e.onReconnect(this._context,{})];case 1:return t.sent(),[2]}})})},e.prototype.resetAndReconnect=function(){return h(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,e.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return t.sent(),[2]}})})},e.prototype.background=function(){return h(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!0,[4,e.onDisconnect(this._context,{autoReconnect:!1})];case 1:return t.sent(),[2]}})})},e.prototype.disconnect=function(e){return void 0===e&&(e=null),h(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:e,autoReconnect:!0})];case 1:return t.sent(),[2]}})})},e.prototype.disconnectWebSocket=function(){return h(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!0,[4,e.onDisconnectWebSocket(this._context)];case 1:return t.sent(),[2]}})})},e.prototype.logout=function(){return h(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._clearEventDispatcher(),[4,e.onLogout(this._context)];case 1:return t.sent(),[2]}})})},e}(),rj=function(e){function t(t){var n=t.deviceId,r=t.statLogs,i=e.call(this)||this;return i.method=Q.POST,i.path="".concat(n7),i.params={device_id:n,log_entries:r.map(function(e){return el.payloadify(e)})},i}return u(t,e),t}(es);(rK=rx||(rx={}))[rK.PENDING=0]="PENDING",rK[rK.ENABLED=1]="ENABLED",rK[rK.DISABLED=2]="DISABLED";var rK,rQ,rW=function(){function e(e){var t=e.cacheContext,n=e.requestQueue,r=e.dispatcher,i=e.baseLimit,s=void 0===i?100:i,a=e.maxLimit,o=e.minLimit;this.queue=[],this.enabledstate=rx.PENDING,this.isFlushing=!1,this.generation=1,this.lastFlushedAt=0,this.deviceId=X(),this.cacheContext=t,this.requestQueue=n,this.dispatcher=r,this.baseLimit=s,this.limit=s,this.maxLimit=void 0===a?1e3:a,this.minLimit=void 0===o?10:o}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this.enabledstate===rx.ENABLED},enumerable:!1,configurable:!0}),e.prototype._save=function(){return h(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return this.cacheContext.localCacheEnabled?[4,this.cacheContext.preference.set(this.key,{deviceId:this.deviceId,statLogs:this.queue.map(function(e){return el.payloadify(e)}),generation:this.generation++,lastFlushedAt:this.lastFlushedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype._flush=function(){return h(this,void 0,void 0,function(){var e,t;return d(this,function(n){switch(n.label){case 0:if(!this.isEnabled||this.isFlushing)return[3,7];this.isFlushing=!0,n.label=1;case 1:return n.trys.push([1,5,6,7]),(e=this.queue.slice(0,Math.min(this.limit,this.maxLimit))).length>0?(t=new rj({deviceId:this.deviceId,statLogs:e}),[4,this.requestQueue.send(t)]):[3,4];case 2:return n.sent(),this.queue=this.queue.slice(e.length),[4,this._save()];case 3:n.sent(),n.label=4;case 4:return this.limit=this.baseLimit,this.lastFlushedAt=Date.now(),[3,7];case 5:return n.sent(),this.limit=this.limit+20,[3,7];case 6:return this.isFlushing=!1,[7];case 7:return[2]}})})},e.prototype.init=function(e){return h(this,void 0,void 0,function(){var t,n=this;return d(this,function(r){switch(r.label){case 0:return this.key=e,this.cacheContext.localCacheEnabled?[4,this.cacheContext.preference.get(this.key)]:[3,4];case 1:return(t=r.sent())?(this.deviceId=t.deviceId,this.queue=t.statLogs.map(,this.generation=t.generation,this.lastFlushedAt=t.lastFlushedAt,Date.now()-this.lastFlushedAt>=108e5&&this.queue.length>=this.minLimit?[4,ri(Math.min(Math.floor(18e4*Math.random()),100))]:[3,4]):[3,4];case 2:return r.sent(),[4,this._flush()];case 3:r.sent(),r.label=4;case 4:return this.dispatcher.on(function(e){if(e instanceof ec){var t=e.statLog;n.put(t)}else e instanceof rG&&(n.enabledstate=e.enabled?rx.ENABLED:rx.DISABLED,n.isEnabled?n.queue.length>=n.limit&&n._flush():n.clear())}),[2]}})})},e.prototype.put=function(e){return h(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.enabledstate===rx.DISABLED?[3,3]:(this.queue.push(e),[4,this._save()]);case 1:return t.sent(),this.queue.length>=this.limit?[4,this._flush()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},e.prototype.clear=function(){return h(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return this.queue=[],this.generation=1,[4,this._save()];case 1:return e.sent(),[2]}})})},e}();(rY=rQ||(rQ={}))[rY.NONE=0]="NONE",rY[rY.VERBOSE=1]="VERBOSE",rY[rY.DEBUG=2]="DEBUG",rY[rY.INFO=3]="INFO",rY[rY.WARN=4]="WARN",rY[rY.ERROR=5]="ERROR";var rY,rZ,rX,rJ,r$,r0,r1,r2,r3,r4,r6,r5=function(){eturn e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=rQ.VERBOSE&&console.log.apply(console,_(["[verbose]"],p(e),!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=rQ.DEBUG&&console.log.apply(console,_(["[debug]"],p(e),!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=rQ.INFO&&console.log.apply(console,_(["[info]"],p(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=rQ.WARN&&console.warn.apply(console,_(["[warn]"],p(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=rQ.ERROR&&console.error.apply(console,_(["[error]"],p(e),!1))},e}(),r8={},r7=function(){function e(e,t){var n,r,i,s,a,o,u,c,l,h;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!r8[e]){r8[e]=this;var d=null!==(n=t.options)&&void 0!==n?n:new q,f=this.sdkState={appId:t.appId,appVersion:null!==(r=t.appVersion)&&void 0!==r?r:"",appState:"foreground",userId:null,extensions:{},api:{host:null!==(i=t.apiHost)&&void 0!==i?i:"https://api-".concat(t.appId,".sendbird.com")},websocket:{host:null!==(s=t.websocketHost)&&void 0!==s?s:"wss://ws-".concat(t.appId,".sendbird.com"),pingerDisabled:!!t.noPingpong,pingInterval:null,pongTimeout:null,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new rs,responseTimeout:d.websocketResponseTimeout},sessionTokenRefreshTimeout:d.sessionTokenRefreshTimeout};this.appInfo=null,this.subscribedUnreadMessageCount={all:0,customTypes:{},ts:0};var p=this.logger=new r5;this.logger.level=null!==(a=t.logLevel)&&void 0!==a?a:rQ.WARN,this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var _=this.cacheContext=new z({encryption:t.encryption,store:t.store,localCacheEnabled:null!==(o=t.localCacheEnabled)&&void 0!==o&&o,localCacheConfig:null!==(u=t.localCacheConfig)&&void 0!==u?u:new Y});this.debugMode=null!==(c=t.debugMode)&&void 0!==c&&c,this.maxSuperGroupChannelUnreadCount=v.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=d.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=d.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=d.typingIndicatorThrottle,this.concurrentCallLimit=null,this.backOffDelay=null;var m=this.dispatcher=new ee,g=new Z;this.requestQueue=new nQ(e,{auth:g,sdkState:f,dispatcher:m,logger:p}),this.sessionManager=new rl({auth:g,cacheContext:_,sdkState:f,dispatcher:m,requestQueue:this.requestQueue,logger:p}),this.connectionManager=new rB(e,{sdkState:f,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:m,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:null!==(l=t.disableWebSocketCloseEventHandling)&&void 0!==l&&l,logger:p}),this.statLogCollector=new rW({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:m}),this.appStateToggleEnabled=null===(h=t.appStateToggleEnabled)||void 0===h||h}return r8[e]}return e.of=e.clear=e}(),r9=function(){function e(){}return e.prototype.init=function(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,s=t.requestQueue,a=t.logger;t.onlineDetector;var o=t.cacheContext;this._iid=e,this._cacheContext=void 0===o?null:o,this._sdkState=n,this._dispatcher=r,this._sessionManager=i,this._requestQueue=s,this._logger=a},e}();(ie=rZ||(rZ={})).BASE="base",ie.USER="user",ie.FILE="file",ie.ADMIN="admin",(it=rX||(rX={})).ALL="",it.USER="MESG",it.FILE="FILE",it.ADMIN="ADMM",(ir=rJ||(rJ={})).USER="MESG",ir.FILE="FILE",ir.ADMIN="ADMM",(ii=r$||(r$={})).USERS="users",ii.CHANNEL="channel",(is=r0||(r0={})).ALL="all",is.NONE="none",is.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel",(ia=r1||(r1={})).DEFAULT="default",ia.SUPPRESS="suppress",(io=r2||(r2={})).PENDING="pending",io.SCHEDULED="scheduled",io.SUCCEEDED="succeeded",io.FAILED="failed",io.CANCELED="canceled",(iu=r3||(r3={})).BASE="base",iu.GROUP="group",iu.OPEN="open",(ic=r4||(r4={})).OPERATOR="operator",ic.NONE="none",(il=r6||(r6={})).OPEN="open",il.CLOSED="closed";var ie,it,ir,ii,is,ia,io,iu,ic,il,ih,id="removed",ip=function(e){switch(e){case r6.OPEN:return r6.OPEN;case r6.CLOSED:return r6.CLOSED}},i_=function(e){return!e||e.text&&O("string",e.text)},im=function(e){return U("string",e)&&e.every(},ig=function(e){function t(t,n){var r,i,s,a,o,u,c,l=this;return(l=e.call(this,t)||this).pollId=0,l.id=0,l.text=null,l.voteCount=0,l.createdBy=null,l.createdAt=0,l.updatedAt=0,l._lastVotedAt=0,l.pollId=null!==(r=n.poll_id)&&void 0!==r?r:0,l.id=null!==(i=n.id)&&void 0!==i?i:0,l.text=null!==(s=n.text)&&void 0!==s?s:null,l.voteCount=null!==(a=n.vote_count)&&void 0!==a?a:0,l.createdBy=null!==(o=n.created_by)&&void 0!==o?o:null,l.createdAt=null!==(u=n.created_at)&&void 0!==u?u:0,l.updatedAt=null!==(c=n.updated_at)&&void 0!==c?c:0,l}return u(t,e),t.payloadify=function(t){return t?en(c(c({},e.payloadify.call(this,t)),{vote_count:t.voteCount,poll_id:t.pollId,text:t.text,created_at:t.createdAt,id:t.id,created_by:t.createdBy,updated_at:t.updatedAt})):null},t}(rw),iv=function(e){function t(t,n){var r,i,s,a,o,u,c,l,h,d,f,p,_,m=this;return(m=e.call(this,t)||this).id=0,m.title=null,m.createdAt=0,m.updatedAt=0,m.closeAt=-1,m.status=r6.CLOSED,m.messageId=0,m.data=null,m.voterCount=-1,m.options=[],m.createdBy=null,m.allowUserSuggestion=!1,m.allowMultipleVotes=!1,m.votedPollOptionIds=[],m.id=null!==(r=n.id)&&void 0!==r?r:0,m.title=null!==(i=n.title)&&void 0!==i?i:null,m.createdAt=null!==(s=n.created_at)&&void 0!==s?s:0,m.updatedAt=null!==(a=n.updated_at)&&void 0!==a?a:0,m.closeAt=null!==(o=n.close_at)&&void 0!==o?o:-1,m.status=null!==(u=ip(n.status))&&void 0!==u?u:r6.CLOSED,m.messageId=null!==(c=n.message_id)&&void 0!==c?c:0,m.data=null!==(l=n.data)&&void 0!==l?l:null,m.voterCount=null!==(h=n.voter_count)&&void 0!==h?h:-1,m.options=n.options?n.options.map(function(e){return new ig(m._iid,e)}):[],m.createdBy=null!==(d=n.created_by)&&void 0!==d?d:null,m.allowUserSuggestion=null!==(f=n.allow_user_suggestion)&&void 0!==f&&f,m.allowMultipleVotes=null!==(p=n.allow_multiple_votes)&&void 0!==p&&p,m.votedPollOptionIds=null!==(_=n.voted_option_ids)&&void 0!==_?_:[],m}return u(t,e),t.prototype._applyPollUpdatePayload=function(e){var t,n,r,i,s,a,o,u,c=this;this.title=null!==(t=e.title)&&void 0!==t?t:this.title,this.updatedAt=null!==(n=e.updated_at)&&void 0!==n?n:this.updatedAt,this.closeAt=null!==(r=e.close_at)&&void 0!==r?r:this.closeAt,this.status=null!==(i=ip(e.status))&&void 0!==i?i:this.status,this.data=null!==(s=e.data)&&void 0!==s?s:this.data,this.voterCount=null!==(a=e.voter_count)&&void 0!==a?a:this.voterCount,e.options&&(this.options=e.options.map(,this.votedPollOptionIds=e.options.filter(.map(function(e){return e.id})),this.allowUserSuggestion=null!==(o=e.allow_user_suggestion)&&void 0!==o?o:this.allowUserSuggestion,this.allowMultipleVotes=null!==(u=e.allow_multiple_votes)&&void 0!==u?u:this.allowMultipleVotes},t.payloadify=function(t){return t?en(c(c({},e.payloadify.call(this,t)),{id:t.id,title:t.title,created_at:t.createdAt,updated_at:t.updatedAt,close_at:t.closeAt,status:t.status,message_id:t.messageId,data:t.data,voter_count:t.voterCount,options:t.options.map(function(e){return ig.payloadify(e)}),created_by:t.createdBy,allow_user_suggestion:t.allowUserSuggestion,allow_multiple_votes:t.allowMultipleVotes,voted_option_ids:t.votedPollOptionIds})):null},t.prototype.applyPollUpdateEvent=function(e){var t=e._payload.poll;return!(!t||this.id!==t.id||t.updated_at<this.updatedAt)&&(this._applyPollUpdatePayload(t),!0)},t.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return!1;var t=this.options,n=t.map(function(e){return e.id}),r=e._payload,i=Math.floor(r.ts/1e3);return r.updated_vote_counts.forEach(function(e){var r=n.indexOf(e.option_id);if(r>-1){var s=t[r];i>=s._lastVotedAt&&(s.voteCount=e.vote_count,s._lastVotedAt=i)}}),r.req_id&&r.voted_option_ids&&(this.votedPollOptionIds=r.voted_option_ids),!0},t.prototype.serialize=t}(rw),iy=ib=function(e){switch(e){case r3.GROUP:return"".concat(n3,"/group_channels");case r3.OPEN:return"".concat(n3,"/open_channels");default:return null}},iE=function(e,t,n){var r,i;switch(e){case r$.CHANNEL:return!0;case r$.USERS:if(t)try{for(var s=f(t),a=s.next();!a.done;a=s.next())if(a.value===n)return!0}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}return!1},iw=function(e,t,n){var r=iE(e.mentionType,e.mentionedUserIds,n),i=iE(t.mentionType,t.mentionedUserIds,n);return!r&&i?1:r&&!i?-1:0};(a=ih||(ih={})).UNKNOWN="UNKNOWN",a.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",a.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",a.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",a.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",a.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",a.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",a.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",a.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",a.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",a.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",a.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",a.REQUEST_MESSAGE="REQUEST_MESSAGE",a.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",a.EVENT_POLL_VOTED="EVENT_POLL_VOTED",a.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",a.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",a.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",a.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",a.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",a.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",a.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",a.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",a.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",a.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",a.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED";var iI=function(e){return e.startsWith("EVENT_")||e===ih.SYNC_MESSAGE_FILL||e===ih.SYNC_MESSAGE_CHANGELOGS||e===ih.SYNC_POLL_CHANGELOGS},iT=function(e){function t(t){var n=t.messages,r=t.source,i=e.call(this)||this;return i.messages=n,i.source=r,i}return u(t,e),t}(et),iS=function(e){function t(t){var n=t.messageIds,r=t.source,i=e.call(this)||this;return i.messageIds=n,i.source=r,i}return u(t,e),t}(et),iA=function(e){function t(t){var n=t.reqId,r=t.source,i=e.call(this)||this;return i.reqId=n,i.source=r,i}return u(t,e),t}(et),iN=function(e){function t(t){var n=t.polls,r=t.source,i=e.call(this)||this;return i.polls=n,i.source=r,i}return u(t,e),t}(et),iC=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return u(t,e),t}(et),ik=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=null,i.source=null,i.event=n,i.source=r,i}return u(t,e),t}(et),iO=function(){function e(e,t){var n;this._iid=null,this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=e,this.limit=null!==(n=t.limit)&&void 0!==n?n:20}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),e.prototype._validate=function(){return O("number",this.limit)&&this.limit>0},e}(),iR=function(e){eturn u(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&O("string",this.channelUrl)&&R(r3,this.channelType)},t}(iO)},18920:function(e,t,n){n.d(t,{P:function(){return T},a:function(){return N},b:function(){return y},c:function(){return d},d:function(){return m},e:function(){return g},f:function(){return p},g:function(){return _},h:function(){return b},i:function(){return E},v:function(){return f}});var r=n(35660),i=function(e){function t(t){var n=t.title,i=t.optionTexts,s=t.data,a=t.allowUserSuggestion,o=t.allowMultipleVotes,u=t.closeAt,c=e.call(this)||this;return c.method=r.A.POST,c.path=r.ap,c.params={title:n,options:i,data:s,allow_user_suggestion:a,allow_multiple_votes:o,close_at:u},c}return(0,r._)(t,e),t}(r.f),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.poll=new r.a3(t,n),i}return(0,r._)(t,e),t}(r.h),a=function(e){function t(t){var n=t.channelUrl,i=t.channelType,s=t.pollId,a=e.call(this)||this;return a.method=r.A.GET,a.path="".concat(r.ap,"/").concat(encodeURIComponent(s)),a.params={channel_url:n,channel_type:i},a}return(0,r._)(t,e),t}(r.f),o=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.poll=new r.a3(t,n),i}return(0,r._)(t,e),t}(r.h),u=function(e){function t(t){var n=t.channelUrl,i=t.channelType,s=t.pollId,a=t.pollOptionId,o=e.call(this)||this;return o.method=r.A.GET,o.path="".concat(r.ap,"/").concat(encodeURIComponent(s),"/options/").concat(encodeURIComponent(a)),o.params={channel_url:n,channel_type:i},o}return(0,r._)(t,e),t}(r.f),c=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.pollOption=new r.aj(t,n),i}return(0,r._)(t,e),t}(r.h),l=function(e){function t(t){var n=t.channelType,i=t.channelUrl,s=t.timestamp,a=t.token,o=e.call(this)||this;return o.method=r.A.GET,o.path="".concat((0,r.a6)(n),"/").concat(encodeURIComponent(i),"/polls/changelogs"),o.params=(0,r.e)({change_ts:s,token:a}),o}return(0,r._)(t,e),t}(r.f),h=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.updatedPolls=n.updated.map(function(e){return e?new r.a3(t,e):null}),i.deletedPollIds=n.deleted.map(function(e){return e}),i.hasMore=n.has_more,i.nextToken=n.next,i}return(0,r._)(t,e),t}(r.h),d={title:null,optionTexts:null,data:null,allowUserSuggestion:null,allowMultipleVotes:null,closeAt:-1},f=function(e){return(0,r.a)("string",e.title)&&(0,r.aq)(e.optionTexts)&&(0,r.ar)(e.data)&&(0,r.a)("boolean",e.allowUserSuggestion,!0)&&(0,r.a)("boolean",e.allowMultipleVotes,!0)&&(0,r.a)("number",e.closeAt,!0)},p={channelUrl:null,channelType:null,pollId:null,pollOptionId:null},_=function(e){return(0,r.a)("string",e.channelUrl)&&(0,r.H)(r.K,e.channelType)&&(0,r.a)("number",e.pollId)&&(0,r.a)("number",e.pollOptionId)},m={channelUrl:null,channelType:null,pollId:null},g=function(e){return(0,r.a)("string",e.channelUrl)&&""!==e.channelUrl&&(0,r.H)(r.K,e.channelType)&&(0,r.a)("number",e.pollId)},v={},y=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,s=t.requestQueue,a=t.logger;this._iid=e,this._sdkState=n,this._sessionManager=i,this._requestQueue=s,this._dispatcher=r,this._logger=a,v[e]=this}return e.of=function(e){return v[e]},e.prototype.buildPollFromSerializedData=function(e){var t=(0,r.r)(e);return new r.a3(this._iid,r.a3.payloadify(t))},e.prototype.get=function(e){return(0,r.b)(this,void 0,void 0,function(){var t;return(0,r.c)(this,function(n){switch(n.label){case 0:return(0,r.q)(g(e)).throw(r.S.invalidParameters),t=new a((0,r.g)({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(o).poll]}})})},e.prototype.create=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n;return(0,r.c)(this,function(a){switch(a.label){case 0:return(0,r.q)(f(e)).throw(r.S.invalidParameters),t=e.data,n=new i((0,r.g)((0,r.g)({},e),{data:t})),[4,this._requestQueue.send(n)];case 1:return[2,a.sent().as(s).poll]}})})},e.prototype.getOption=function(e){return(0,r.b)(this,void 0,void 0,function(){var t;return(0,r.c)(this,function(n){switch(n.label){case 0:return(0,r.q)(_(e)).throw(r.S.invalidParameters),t=new u((0,r.g)({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(c).pollOption]}})})},e.prototype.getPollChangeLogs=function(e,t,n,i){return void 0===i&&(i=r.ad.SYNC_POLL_CHANGELOGS),(0,r.b)(this,void 0,void 0,function(){var s,a,o,u,c,d;return(0,r.c)(this,function(f){switch(f.label){case 0:return s=new l((0,r.e)({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null})),[4,this._requestQueue.send(s)];case 1:return o=(a=f.sent().as(h)).updatedPolls,u=a.deletedPollIds,c=a.hasMore,d=a.nextToken,o.length>0&&this._dispatcher.dispatch(new r.as({polls:o,source:i})),[2,{updatedPolls:o,deletedPollIds:u,hasMore:c,token:d}]}})})},e}(),b=function(e,t){this.pollId=0,this.messageId=0,this.pollId=t.poll.id,this.messageId=t.poll.message_id,this._iid=e,this._payload=t},E=function(e){this.pollId=0,this.messageId=0,this.pollId=e.poll_id,this.messageId=e.message_id,this._payload=e},w=function(e){function t(t){var n=t.channelUrl,i=t.channelType,s=t.token,a=t.limit,o=e.call(this)||this;return o.method=r.A.GET,o.path=r.ap,o.params={channel_url:n,channel_type:i,token:s,limit:a},o}return(0,r._)(t,e),t}(r.f),I=function(e){function t(t,n){var i,s=this;return(s=e.call(this,t,n)||this).polls=(null!==(i=n.polls)&&void 0!==i?i:[]).map(function(e){return new r.a3(t,e)}),s.token=n.next,s}return(0,r._)(t,e),t}(r.h),T=function(e){function t(t,n){return e.call(this,t,n.channelUrl,n.channelType,n)||this}return(0,r._)(t,e),t.prototype.next=function(){return(0,r.b)(this,void 0,void 0,function(){var e,t,n,i,s;return(0,r.c)(this,function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=r.V.of(this._iid).requestQueue,t=new w((0,r.g)((0,r.g)({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return i=(n=a.sent().as(I)).polls,s=n.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw r.S.queryInProgress;case 4:return[3,6];case 5:throw r.S.invalidParameters;case 6:return[2]}})})},t}(r.ah),S=function(e){function t(t){var n=t.channelUrl,i=t.channelType,s=t.pollId,a=t.pollOptionId,o=t.token,u=t.limit,c=e.call(this)||this;return c.method=r.A.GET,c.path="".concat(r.ap,"/").concat(encodeURIComponent(s),"/options/").concat(encodeURIComponent(a),"/voters"),c.params={channel_url:n,channel_type:i,token:o,limit:u},c}return(0,r._)(t,e),t}(r.f),A=function(e){function t(t,n){var i,s=this;return(s=e.call(this,t,n)||this).voters=(null!==(i=n.voters)&&void 0!==i?i:[]).map(function(e){return new r.U(t,e)}),s.token=n.next,s}return(0,r._)(t,e),t}(r.h),N=function(e){function t(t,n){var r=e.call(this,t,n.channelUrl,n.channelType,n)||this;return r.pollId=n.pollId,r.pollOptionId=n.pollOptionId,r}return(0,r._)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,r.a)("number",this.pollId)&&(0,r.a)("number",this.pollOptionId)},t.prototype.next=function(){return(0,r.b)(this,void 0,void 0,function(){var e,t,n,i,s;return(0,r.c)(this,function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=r.V.of(this._iid).requestQueue,t=new S((0,r.g)((0,r.g)({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return i=(n=a.sent().as(A)).voters,s=n.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw r.S.queryInProgress;case 4:return[3,6];case 5:throw r.S.invalidParameters;case 6:return[2]}})})},t}(r.ah)},71673:function(e,t,n){n.d(t,{P:function(){return i}});var r=n(35660),i=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).isMuted=!1,i.isMuted=null!==(r=n.is_muted)&&void 0!==r&&r,i}return(0,r._)(t,e),t}(r.U)},35354:function(e,t,n){n.d(t,{A:function(){return d},B:function(){return g},C:function(){return c},M:function(){return h},O:function(){return l},P:function(){return m},R:function(){return p},T:function(){return _},U:function(){return f},a:function(){return i}});var r,i,s=n(35660),a=n(78424),o=n(18920);(r=i||(i={}))[r.NONE=0]="NONE",r[r.CHANNEL_ENTER=10102]="CHANNEL_ENTER",r[r.CHANNEL_EXIT=10103]="CHANNEL_EXIT",r[r.USER_CHANNEL_MUTE=10201]="USER_CHANNEL_MUTE",r[r.USER_CHANNEL_UNMUTE=10200]="USER_CHANNEL_UNMUTE",r[r.USER_CHANNEL_BAN=10601]="USER_CHANNEL_BAN",r[r.USER_CHANNEL_UNBAN=10600]="USER_CHANNEL_UNBAN",r[r.CHANNEL_FREEZE=10701]="CHANNEL_FREEZE",r[r.CHANNEL_UNFREEZE=10700]="CHANNEL_UNFREEZE",r[r.TYPING_START=10900]="TYPING_START",r[r.TYPING_END=10901]="TYPING_END",r[r.CHANNEL_JOIN=1e4]="CHANNEL_JOIN",r[r.CHANNEL_LEAVE=10001]="CHANNEL_LEAVE",r[r.CHANNEL_OPERATOR_UPDATE=10002]="CHANNEL_OPERATOR_UPDATE",r[r.CHANNEL_INVITE=10020]="CHANNEL_INVITE",r[r.CHANNEL_ACCEPT_INVITE=10021]="CHANNEL_ACCEPT_INVITE",r[r.CHANNEL_DECLINE_INVITE=10022]="CHANNEL_DECLINE_INVITE",r[r.CHANNEL_PROP_CHANGED=11e3]="CHANNEL_PROP_CHANGED",r[r.CHANNEL_DELETED=12e3]="CHANNEL_DELETED",r[r.CHANNEL_META_DATA_CHANGED=11100]="CHANNEL_META_DATA_CHANGED",r[r.CHANNEL_META_COUNTERS_CHANGED=11200]="CHANNEL_META_COUNTERS_CHANGED",r[r.CHANNEL_HIDE=13e3]="CHANNEL_HIDE",r[r.CHANNEL_UNHIDE=13001]="CHANNEL_UNHIDE",r[r.PINNED_MESSAGE_CHANGED=11300]="PINNED_MESSAGE_CHANGED";var u=function(){eturn Object.defineProperty(e.prototype,"isGroupChannelEvent",{get:function(){return this.channelType===s.K.GROUP},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpenChannelEvent",{get:enumerable:!1,configurable:!0}),e}(),c=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.event=new u(r),i}return(0,s._)(t,e),t}(s.W),l=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data.operators;return i.operators=(void 0===a?[]:a).map(,i}return(0,s._)(t,e),t}(c),h=function(e){function t(t,n,r){var i=e.call(this,t,"MCNT",r)||this;return i.groupChannelMemberCounts=r.group_channels.map(,i.openChannelMemberCounts=r.open_channels.map(,i}return(0,s._)(t,e),t}(s.W),d=function(e){function t(t,n,r){var i,o,u,c=this;(c=e.call(this,t,"ADMM",r)||this).message=new a.o(t,r);var l=s.V.of(t).sdkState;return c.isMentioned=(0,s.a7)(c.message.mentionType,null!==(i=c.message.mentionedUserIds)&&void 0!==i?i:null===(o=c.message.mentionedUsers)||void 0===o?void 0:o.map(function(e){return e.userId}),l.userId),c.forceUpdateLastMessage=null!==(u=r.force_update_last_message)&&void 0!==u&&u,c}return(0,s._)(t,e),t}(s.W),f=function(e){function t(t,n,r){var i,o,u,c,l,h,d=this;(d=e.call(this,t,"AEDI",r)||this).message=new a.o(t,r);var f=s.V.of(t).sdkState;return d.mentionCountChange=(0,s.av)({mentionType:null!==(o=null===(i=r.old_values)||void 0===i?void 0:i.mention_type)&&void 0!==o?o:null,mentionedUserIds:null!==(c=null===(u=r.old_values)||void 0===u?void 0:u.mentioned_user_ids)&&void 0!==c?c:[]},{mentionType:d.message.mentionType,mentionedUserIds:null!==(l=d.message.mentionedUserIds)&&void 0!==l?l:null===(h=d.message.mentionedUsers)||void 0===h?void 0:h.map(function(e){return e.userId})},f.userId),d}return(0,s._)(t,e),t}(s.W),p=function(e){function t(t,n,r){var i=e.call(this,t,"MRCT",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.event=new a.R(r),i}return(0,s._)(t,e),t}(s.W),_=function(e){function t(t,n,r){var i=e.call(this,t,"MTHD",r)||this;return i.event=new a.q(t,r),i}return(0,s._)(t,e),t}(s.W),m=function(e){function t(t,n,r){var i=e.call(this,t,"PEDI",r)||this;return i.event=null,i.status=null,i.channelUrl=null,i.channelType=null,i.event=new o.h(t,r),i.status=(0,s.aH)(r.poll.status)||r.poll.status,i.channelUrl=r.channel_url,i.channelType=r.channel_type,i}return(0,s._)(t,e),t}(s.W),g=function(){this.onUserMuted=s.n,this.onUserUnmuted=s.n,this.onUserBanned=s.n,this.onUserUnbanned=s.n,this.onChannelChanged=s.n,this.onChannelDeleted=s.n,this.onChannelFrozen=s.n,this.onChannelUnfrozen=s.n,this.onOperatorUpdated=s.n,this.onChannelMemberCountChanged=s.n,this.onMetaDataCreated=s.n,this.onMetaDataUpdated=s.n,this.onMetaDataDeleted=s.n,this.onMetaCounterCreated=s.n,this.onMetaCounterUpdated=s.n,this.onMetaCounterDeleted=s.n,this.onMessageReceived=s.n,this.onMessageUpdated=s.n,this.onMessageDeleted=s.n,this.onMentionReceived=s.n,this.onReactionUpdated=s.n,this.onThreadInfoUpdated=s.n}},44996:function(e,t,n){n.d(t,{A:function(){return eG},D:function(){return j},G:function(){return l},I:function(){return ez},M:function(){return f},N:function(){return U},P:function(){return h},R:function(){return X},S:function(){return k},U:function(){return J},a:function(){return m},b:function(){return L},c:function(){return eF},d:function(){return z},e:function(){return A},f:function(){return B},g:function(){return p},h:function(){return eZ},i:function(){return q},j:function(){return P},k:function(){return eK},l:function(){return Z},m:function(){return Y},n:function(){return H},o:function(){return F},p:function(){return _},q:function(){return R},r:function(){return D},s:function(){return W},t:function(){return d},v:function(){return O}});var r,i=n(35660),s=n(8144),a=n(78424);(o=l||(l={})).LATEST_LAST_MESSAGE="latest_last_message",o.CHRONOLOGICAL="chronological",o.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",o.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical",(u=h||(h={})).CHRONOLOGICAL="chronological",u.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",u.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical",(c=d||(d={})).CREATED_AT="created_at",c.SCHEDULED_AT="scheduled_at";var o,u,c,l,h,d,f,p=function(e){switch(e){case l.LATEST_LAST_MESSAGE:return["-lastMessageUpdatedAt","-createdAt","syncIndex"];case l.CHRONOLOGICAL:return["-createdAt","syncIndex"];case l.CHANNEL_NAME_ALPHABETICAL:return["name"]}},_=function(){function e(){this.messageTypeFilter=i.a2.ALL,this.customTypesFilter=null,this.senderUserIdsFilter=null,this.replyType=i.ab.NONE}return e.prototype.clone=function(){var t=new e,n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach(,t},e.prototype.match=function(e){switch(this.messageTypeFilter){case i.a2.USER:if(e.messageType!==i.Y.USER)return!1;break;case i.a2.FILE:if(e.messageType!==i.Y.FILE)return!1;break;case i.a2.ADMIN:if(e.messageType!==i.Y.ADMIN)return!1}if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes(e.customType)||this.senderUserIdsFilter&&this.senderUserIdsFilter.length>0&&(!(e instanceof a.S)||!this.senderUserIdsFilter.includes(e.sender.userId)))return!1;switch(this.replyType){case i.ab.NONE:if(e.parentMessageId>0)return!1;break;case i.ab.ONLY_REPLY_TO_CHANNEL:if(e instanceof a.S&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!0},e}();(y=f||(f={})).CHANNEL_LATEST="channel_latest",y.NEWEST_CHILD_MESSAGE="newest_child_message";var m=function(e){switch(e){case f.CHANNEL_LATEST:return["channelUrl","-createdAt","-messageId"];case f.NEWEST_CHILD_MESSAGE:return["channelUrl","-parentMessageId","-createdAt","-messageId"]}},g="undefined"!=typeof document&&"undefined"!=typeof navigator;g&&navigator.userAgent&&navigator.userAgent.includes("Chrome/")&&navigator.userAgent.includes("Chromium/");var v=g&&navigator.userAgent&&navigator.userAgent.includes("Firefox/")&&!navigator.userAgent.includes("Seamonkey/");g&&navigator.userAgent&&navigator.userAgent.includes("Safari/")&&!navigator.userAgent.includes("Chrome/")&&navigator.userAgent.includes("Chromium/"),g&&navigator.userAgent&&(navigator.userAgent.includes("OPR/")||navigator.userAgent.includes("Opera/")),g&&navigator.userAgent&&navigator.userAgent.includes("Trident/7.0");var y,b,E,w=g&&navigator.userAgent&&navigator.userAgent.includes("Edge/"),I=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})};(T=b||(b={}))[T.PROCESSING=0]="PROCESSING",T[T.DONE=1]="DONE",(S=E||(E={})).NEWNODE="newnode",S.REMOVENODE="removenode",S.CLAIM_HOST="claimhost",S.SYNC_HOST="synchost",S.REQUEST_LOCK="requestlock",S.ACQUIRE_LOCK="acquirelock",S.RELEASE_LOCK="releaselock";var T,S,A,N={},C=function(){function e(e,t){void 0===t&&(t={});var n=this;return this._state=b.PROCESSING,this._hostId=null,this._queue=[],this._currentItem=null,this._activationTimeout=null,this._activationQueue=[],N[e]&&!t.forceCreate||(this.nodeId=I(),this.key=e,g&&(t.startAsInvisible?this.registerNode():"visible"===document.visibilityState?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",,window.addEventListener("message",function(e){var t,r,s=e.data,a=s.nodeId,o=s.requestId,u=s.key,c=s.op,l=s.data;if(a!==n.nodeId&&u===n.key)switch(c){case E.NEWNODE:n._sendSync();break;case E.CLAIM_HOST:n._sendSync(),n._hostId=a;break;case E.SYNC_HOST:if(!n.isInSync){n._activationTimeout&&clearTimeout(n._activationTimeout);var h=l.currentItemRequestId,d=l.queue,f=function(e){0>n._queue.findIndex(function(t){return t.requestId===e.requestId})&&n._requestLock({nodeId:e.nodeId,requestId:e.requestId,key:n.key,op:E.REQUEST_LOCK,ts:e.ts})};try{for(var p=(0,i.G)(d),_=p.next();!_.done;_=p.next())f(_.value)}catch(e){t={error:e}}finally{try{_&&!_.done&&(r=p.return)&&r.call(p)}finally{if(t)throw t.error}}n._currentItem=n._queue.find(function(e){return e.requestId===h}),n._completeSync()}break;case E.REMOVENODE:n._queue=n._queue.filter(function(e){return e.nodeId!==s.nodeId}),n._currentItem&&n._currentItem.nodeId===s.nodeId&&(n._currentItem=null,n._acquire(n._queue[0]));break;case E.REQUEST_LOCK:n._requestLock(s);break;case E.ACQUIRE_LOCK:var m=n._queue.find(function(e){return e.requestId===o});n._acquire(m);break;case E.RELEASE_LOCK:n._release(o)}}),window.addEventListener("beforeunload",),N[e]=this),N[e]}return Object.defineProperty(e.prototype,"locked",{get:function(){return!!this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHost",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInSync",{get:enumerable:!1,configurable:!0}),e.prototype._send=function(e,t){void 0===t&&(t={});var n,r,i={nodeId:this.nodeId,requestId:null!==(n=null==t?void 0:t.requestId)&&void 0!==n?n:I(),key:this.key,op:e,data:null!==(r=t.data)&&void 0!==r?r:null,ts:Date.now()};return g&&window.postMessage(i,"*"),i},e.prototype._acquire=function(e){void 0===e&&(e=null),e?(this._currentItem=e,this._currentItem.onAcquired(e.requestId)):this._currentItem=null},e.prototype._release=function(e){if(this._currentItem&&this._currentItem.requestId===e){var t=this._currentItem;this._currentItem=null,t.nodeId===this.nodeId&&this._send(E.RELEASE_LOCK,{requestId:t.requestId});var n=this._queue.findIndex(function(t){return t.requestId===e});n>-1&&this._queue.splice(n,1),t.onReleased(e)}},e.prototype._requestLock=function(e){var t=this;return new Promise(function(n){var r={nodeId:e.nodeId,requestId:e.requestId,ts:e.ts,onAcquired:function(e){t.isHost&&t._send(E.ACQUIRE_LOCK,{requestId:e}),n()},onReleased:,i=!1;for(var s in t._queue)if(t._queue[s].ts>r.ts){t._queue.splice(parseInt(s),0,r),i=!0;break}i||t._queue.push(r),t._currentItem||t._acquire(t._queue[0])})},e.prototype._sendSync=function(){var e;this.isHost&&this._send(E.SYNC_HOST,{data:{currentItemRequestId:null===(e=this._currentItem)||void 0===e?void 0:e.requestId,queue:this._queue.map(function(e){return{nodeId:e.nodeId,requestId:e.requestId,ts:e.ts}})}})},e.prototype._waitUntilSyncCompleted=function(){return(0,i.b)(this,void 0,void 0,function(){var e=this;return(0,i.c)(this,function(t){return this.isHost&&!this.isInSync?[2,new Promise(]:[2]})})},e.prototype._waitSync=e.prototype._completeSync=function(){this.isInSync||(this._state=b.DONE,this._activationQueue.forEach(,this._activationQueue=[])},e.prototype.registerNode=e.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(E.CLAIM_HOST),this._waitSync()},e.prototype.lock=function(){return(0,i.b)(this,void 0,void 0,function(){var e;return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,this._waitUntilSyncCompleted()];case 1:return t.sent(),e=this._send(E.REQUEST_LOCK),[4,this._requestLock(e)];case 2:return t.sent(),[2]}})})},e.prototype.unlock=function(){var e;this._release(null===(e=this._currentItem)||void 0===e?void 0:e.requestId)},e}(),k=(0,i.g)((0,i.g)({},s.U),{scheduledAt:null}),O=function(e){return(0,s.v)(e)&&(0,i.a)("number",e.scheduledAt,!0)},R=(0,i.g)((0,i.g)({},s.j),{scheduledAt:null,file:null,fileUrl:null,fileName:null,mimeType:null,fileSize:null,thumbnailSizes:null,requireAuth:!1}),D=function(e){return(0,s.l)(e)&&(0,i.a)("number",e.scheduledAt)&&((0,i.i)(e.file)||(0,i.a)("string",e.fileUrl))&&(0,i.a)("string",e.fileName,!0)&&(0,i.a)("string",e.mimeType,!0)&&(0,i.a)("number",e.fileSize,!0)&&(null===e.thumbnailSizes||e.thumbnailSizes.every(function(e){return(0,i.a)("object",e)&&e.maxWidth>0&&e.maxHeight>0}))},U="UnsentMessage",L="reqId",M={},P=function(e){function t(t,n){var r=n.sdkState,i=n.cacheContext,s=e.call(this,t)||this;return s._sdkState=r,s._cacheContext=i,M[t]=s,s._mutex=new C("unsendmessagecache.lock"),s}return(0,i._)(t,e),t.of=function(e){return M[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return e&&e.collection(U)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){if(e.messageId>0)throw i.S.invalidParameters;var t,n,r=(0,i.g)({},e.serialize());return e instanceof a.U?(e.messageParams&&(r.messageParams=(0,s.s)(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(r.scheduledInfo.scheduledMessageParams=(n=e.scheduledInfo.scheduledMessageParams,(0,i.g)((0,i.g)({},(0,s.s)(n)),{scheduledAt:n.scheduledAt})))):e instanceof a.F&&(e.messageParams&&(r.messageParams=(0,s.k)(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(r.scheduledInfo.scheduledMessageParams=(t=e.scheduledInfo.scheduledMessageParams,(0,i.g)((0,i.g)({},(0,s.k)(t)),{scheduledAt:t.scheduledAt})))),r},t.prototype._deserialize=function(e){return e?(e=(0,i.g)((0,i.g)({},e),{messageId:parseInt(e.messageId)}),a.b.of(this._iid).buildMessageFromSerializedData(e)):null},t.prototype._deserializeWithMessageCreateParams=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,o,u,c;return(0,i.c)(this,function(i){switch(i.label){case 0:return t=a.b.of(this._iid),n=this._deserialize(e),e.messageParams?n instanceof a.U?(r=e.messageParams,n.messageParams=t.buildUserMessageCreateParamsFromSerializedData(r,n),[3,4]):[3,1]:[3,4];case 1:return n instanceof a.F?(r=e.messageParams).fileKey&&"string"==typeof r.fileKey&&(0,s.m)(r.fileType)?(o=r,[4,this.collection.getBlob(r.fileKey)]):[3,3]:[3,4];case 2:o.file=i.sent(),i.label=3;case 3:n.messageParams=t.buildFileMessageCreateParamsFromSerializedData(r,n),i.label=4;case 4:return n.scheduledInfo&&e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams?n instanceof a.U?(u=e.scheduledInfo.scheduledMessageParams,n.scheduledInfo.scheduledMessageParams=t.buildScheduledUserMessageCreateParamsFromSerializedData(u,n),[3,8]):[3,5]:[3,8];case 5:return n instanceof a.F?(u=e.scheduledInfo.scheduledMessageParams).fileKey&&"string"==typeof u.fileKey&&(0,s.m)(u.fileType)?(c=u,[4,this.collection.getBlob(u.fileKey)]):[3,7]:[3,8];case 6:c.file=i.sent(),i.label=7;case 7:n.scheduledInfo.scheduledMessageParams=t.buildScheduledFileMessageCreateParamsFromSerializedData(u,n),i.label=8;case 8:return[2,n]}})})},t.prototype.get=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return[2,this._deserializeWithMessageCreateParams(t)];n.label=2;case 2:return[2,null]}})})},t.prototype.fetch=function(e){var t=e.channelUrl,n=void 0===t?null:t,r=e.filter,s=void 0===r?new _:r,a=e.order,o=void 0===a?f.CHANNEL_LATEST:a,u=e.sendingStatus,c=void 0===u?null:u,l=e.backward,h=void 0!==l&&l,d=e.parentMessageId,p=void 0===d?null:d;return(0,i.b)(this,void 0,void 0,function(){var e,t,r,a=this;return(0,i.c)(this,function(u){switch(u.label){case 0:return this.localCacheEnabled?(e=m(o),t={"/where":function(e){return!!(o!==f.NEWEST_CHILD_MESSAGE||p&&0!==e.parentMessageId&&e.parentMessageId===p)&&s.match(a._deserialize(e))}},n&&(t.channelUrl=n),c&&(t.sendingStatus=c),r={where:t,index:e,backward:h},[4,this.collection.query(r)]):[3,3];case 1:return[4,u.sent().fetch({})];case 2:return[2,Promise.all(u.sent().map()];case 3:return[2,[]]}})})},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new _),(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this.fetch({filter:t,order:f.NEWEST_CHILD_MESSAGE,channelUrl:e.channelUrl,backward:!1,parentMessageId:e.messageId})];case 1:return[2,n.sent()]}})})},t.prototype.upsert=function(e){return(0,i.b)(this,void 0,void 0,function(){var t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(e){return(0,i.b)(t,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return e instanceof a.F?[4,this._mutex.lock()]:[3,4];case 1:return n.sent(),[4,this.saveBlob(e)];case 2:return n.sent(),[4,this._mutex.unlock()];case 3:n.sent(),n.label=4;case 4:return t=this._serialize(e),[4,this.collection.upsertOne(t)];case 5:return n.sent(),[2]}})})}))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.upsertChildMessages=function(e){return(0,i.b)(this,void 0,void 0,function(){var t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(e){return(0,i.b)(t,void 0,void 0,function(){var t,n;return(0,i.c)(this,function(r){switch(r.label){case 0:return t=[],(null===(n=e.threadInfo)||void 0===n?void 0:n.replyCount)>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return t.length>0?(t.forEach(function(t){return t.applyParentMessage(e)}),[4,this.upsert(t)]):[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}})})}))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.remove=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a;return(0,i.c)(this,function(o){switch(o.label){case 0:if(!this.localCacheEnabled)return[3,8];o.label=1;case 1:o.trys.push([1,6,7,8]),n=(t=(0,i.G)(e)).next(),o.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove(r)]);case 3:o.sent(),o.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return s={error:o.sent()},[3,8];case 7:try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}return[7];case 8:return[2]}})})},t.prototype.removeMessagesOfChannel=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(t){switch(t.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e}})]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.saveBlob=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r;return(0,i.c)(this,function(i){switch(i.label){case 0:return e instanceof a.F?e.messageParams&&(t=e.messageParams).file&&(0,s.n)(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,2]:[3,4];case 1:r=i.sent(),t.fileKey=r,t.fileType=s.F.BLOB,i.label=2;case 2:return e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(n=e.scheduledInfo.scheduledMessageParams).file&&(0,s.n)(n.file)?[4,this.collection.saveBlob(n.file,e.reqId)]:[3,4];case 3:r=i.sent(),n.fileKey=r,n.fileType=s.F.BLOB,i.label=4;case 4:return[2]}})})},t}(i.T),x={},q=function(e){function t(t,n){var r=n.sdkState,i=n.cacheContext,s=n.unsentMessageCache,a=e.call(this,t)||this;return a._sdkState=r,a._cacheContext=i,a._unsentMessageCache=s,x[t]=a,a}return(0,i._)(t,e),t.of=function(e){return x[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return e?e.collection(s.b):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return(0,i.g)((0,i.g)({},e.serialize()),{messageId:"".concat(e.messageId)})},t.prototype._deserialize=function(e){return e=(0,i.g)((0,i.g)({},e),{messageId:parseInt(e.messageId)}),a.b.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return[2,this._deserialize(t)];n.label=2;case 2:return[2,null]}})})},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.token,r=e.limit,a=void 0===r?s.D:r,o=e.filter,u=void 0===o?new _:o,c=e.order,l=void 0===c?f.CHANNEL_LATEST:c,h=e.backward,d=void 0!==h&&h,p=e.parentMessageId,g=void 0===p?null:p,v=e.isPollOnly,y=void 0!==v&&v;return(0,i.b)(this,void 0,void 0,function(){var e,r=this;return(0,i.c)(this,function(s){switch(s.label){case 0:return this.localCacheEnabled?(e={where:{channelUrl:t,"/where":function(e){if(n)switch(l){case f.CHANNEL_LATEST:if(!d&&e.createdAt>n||d&&e.createdAt<n)return!1;break;case f.NEWEST_CHILD_MESSAGE:if(!g||0===e.parentMessageId||e.parentMessageId!==g)return!1}return!(y&&!e._poll)&&u.match(r._deserialize(e))}},index:m(l),backward:d},[4,this.collection.query(e)]):[3,3];case 1:return[4,s.sent().fetch({limit:a})];case 2:return[2,Promise.all(s.sent().map(function(e){return(0,i.b)(r,void 0,void 0,function(){return(0,i.c)(this,function(t){return[2,this._deserialize(e)]})})}))];case 3:return[2,[]]}})})},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new _),(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this.fetch({channelUrl:e.channelUrl,token:Date.now(),limit:null,backward:!1,filter:t,order:f.NEWEST_CHILD_MESSAGE,parentMessageId:e.messageId})];case 1:return[2,n.sent()]}})})},t.prototype.upsert=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n=this;return(0,i.c)(this,function(r){switch(r.label){case 0:return this.localCacheEnabled?[4,this.saveBlobs(e)]:[3,5];case 1:return r.sent(),t=e.map(function(e){return n._serialize(e)}),[4,this.collection.upsertMany(t)];case 2:return r.sent(),[4,this.upsertChildMessages(e)];case 3:return r.sent(),[4,this._unsentMessageCache.upsertChildMessages(e)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},t.prototype.upsertChildMessages=function(e){return(0,i.b)(this,void 0,void 0,function(){var t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(e){return(0,i.b)(t,void 0,void 0,function(){var t,n;return(0,i.c)(this,function(r){switch(r.label){case 0:return t=[],(null===(n=e.threadInfo)||void 0===n?void 0:n.replyCount)>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return t.length>0?(t.forEach(function(t){return t.applyParentMessage(e)}),[4,this.upsert(t)]):[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}})})}))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.remove=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a;return(0,i.c)(this,function(o){switch(o.label){case 0:if(!this.localCacheEnabled)return[3,8];o.label=1;case 1:o.trys.push([1,6,7,8]),n=(t=(0,i.G)(e)).next(),o.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove("".concat(r))]);case 3:o.sent(),o.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return s={error:o.sent()},[3,8];case 7:try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}return[7];case 8:return[2]}})})},t.prototype.removeMessagesOfChannel=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:m(f.CHANNEL_LATEST)})]:[3,6];case 1:return n.sent(),[4,(t=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:n.sent(),n.label=6;case 6:return[2]}})})},t.prototype.removeUnderOffset=function(e,t){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":t}},index:m(f.CHANNEL_LATEST)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,})},t.prototype.countBetween=function(e,t,n){return(0,i.b)(this,void 0,void 0,function(){var r,s=this;return(0,i.c)(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?(r=m(f.CHANNEL_LATEST),[4,this.collection.query({where:{channelUrl:e,"/where":function(e){var r=s._deserialize(e);return n.includes(r.createdAt)&&t.match(r)}},index:r}).count()]):[3,2];case 1:return[2,i.sent()];case 2:return[2,0]}})})},t.prototype.saveBlobs=function(e){return(0,i.b)(this,void 0,void 0,function(){var t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(e){return(0,i.b)(t,void 0,void 0,function(){var t,n;return(0,i.c)(this,function(r){switch(r.label){case 0:return e instanceof a.F&&e.messageParams&&(t=e.messageParams).file&&(0,s.n)(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,2];case 1:n=r.sent(),t.fileKey=n,r.label=2;case 2:return[2]}})})}))];case 1:return n.sent(),[2]}})})},t.prototype._getGroupChannelPreferenceSize=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o;return(0,i.c)(this,function(i){switch(i.label){case 0:return t=0,[4,(n=this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 1:return r=i.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 2:return s=i.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 3:return a=i.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 4:return o=i.sent(),r&&(t+=JSON.stringify(r).length),s&&(t+=JSON.stringify(s).length),a&&(t+=JSON.stringify(a).length),o&&(t+=JSON.stringify(o).length),[2,t]}})})},t}(i.T),F=function(e){function t(t){var n=t.message,r=e.call(this)||this;return r.message=n,r}return(0,i._)(t,e),t}(i.al),V={},z=function(){function e(e,t){var n=t.localCacheEnabled,r=t.dispatcher,s=t.sdkState,a=t.logger,o=this;V[e]=this,this._iid=e,V[e]=this,this._localCacheEnabled=n,this._isProcessingAutoResend=!1,this._autoResendQueue=[],this._dispatcher=r,this._logger=a,this._sdkState=s,this._localCacheEnabled&&r.on(function(e){if(e instanceof i.s)switch(e.stateType){case i.t.CONNECTED:o._isProcessingAutoResend||o.processAutoResendRegisteredPendingMessages().then(function(){return o._processNextAutoResend()});break;case i.t.INTERNAL_DISCONNECTED:case i.t.EXTERNAL_DISCONNECTED:o._isProcessingAutoResend=!1}})}return e.of=function(e){return V[e]},e.prototype.processNonAutoResendRegisteredPendingMessages=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n,r,s,a;return(0,i.c)(this,function(o){switch(o.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:e=o.sent();try{for(n=(t=(0,i.G)(e)).next();!n.done;n=t.next())0===(r=n.value).errorCode&&(this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ",r.reqId),r.sendingStatus=i.a0.FAILED,r.errorCode=i.a8.ACK_TIMEOUT,this._dispatcher.dispatch(new i.ae({messages:[r],source:i.ad.LOCAL_MESSAGE_FAILED})))}catch(e){s={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}}return[2]}})})},e.prototype.processAutoResendRegisteredPendingMessages=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n,r,s,a,o,u;return(0,i.c)(this,function(c){switch(c.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:e=c.sent();try{for(n=(t=(0,i.G)(e)).next();!n.done;n=t.next())(r=n.value).errorCode&&(0,i.am)(r.errorCode)&&(s=(new Date).getTime(),a=r.createdAt+2592e5,s<=a?0>this._autoResendQueue.map(function(e){return e.reqId}).indexOf(r.reqId)&&this._autoResendQueue.push(r):(this._logger.debug("auto-resend registered pending messaged expired. expiration date: ",new Date(a).toLocaleString()),r.sendingStatus=i.a0.FAILED,this._dispatcher.dispatch(new i.ae({messages:[r],source:i.ad.LOCAL_MESSAGE_FAILED}))))}catch(e){o={error:e}}finally{try{n&&!n.done&&(u=t.return)&&u.call(t)}finally{if(o)throw o.error}}return[2]}})})},e.prototype.completeCurrentAndProcessNextAutoResend=function(e){if(this._localCacheEnabled&&(e.sendingStatus===i.a0.SUCCEEDED||e.sendingStatus===i.a0.FAILED&&!(0,i.am)(e.errorCode))){var t=this.indexOf(e);t>=0&&this._autoResendQueue.splice(t,1),0===t&&this._processNextAutoResend()}},e.prototype._fetchAllCachedPendingMessages=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t;return(0,i.c)(this,function(n){switch(n.label){case 0:return(e=P.of(this._iid))?[4,e.fetch({sendingStatus:i.a0.PENDING,backward:!0})]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=[],n.label=3;case 3:return[2,t]}})})},e.prototype.indexOf=function(e){return this._autoResendQueue.length>0?this._autoResendQueue.map(function(e){return e.reqId}).indexOf(e.reqId):-1},e.prototype._isNotInQueue=function(e){return -1===this._autoResendQueue.map(function(e){return e.reqId}).indexOf(e.reqId)},e.prototype._processNextAutoResend=function(){return(0,i.b)(this,void 0,void 0,function(){var e;return(0,i.c)(this,function(t){if(this._localCacheEnabled&&"foreground"===this._sdkState.appState)try{this._autoResendQueue.length>0?(this._isProcessingAutoResend||(this._logger.debug("auto-resend queue started."),this._isProcessingAutoResend=!0),e=this._autoResendQueue[0],this._dispatcher.dispatch(new F({message:e})),this._logger.debug("processing auto-resend for message request id: ",e.reqId)):(this._logger.debug("auto-resend queue finished."),this._isProcessingAutoResend=!1)}catch(e){this._logger.warn("process auto-resend error: ",e),this._isProcessingAutoResend=!1}return[2]})})},e}();(G=A||(A={}))[G.USER_BLOCK=20001]="USER_BLOCK",G[G.USER_UNBLOCK=2e4]="USER_UNBLOCK",G[G.FRIEND_DISCOVERED=20900]="FRIEND_DISCOVERED";var G,H,B=function(){eturn e.getDataAsUserBlockEvent=function(e,t){var n=t.data,r=n.blocker,s=n.blockee;return{blocker:new i.U(e,r),blockee:new i.U(e,s)}},e.getDataAsFriendDiscoveredEvent=function(e,t){var n=t.data.friend_discoveries;return{friendDiscoveries:Array.isArray(n)?n.map(function(t){return new i.U(e,t)}):[]}},e}(),j=function(e){function t(t,n){var r=n.userId,i=e.call(this)||this;return i._iid=t,i.userId=r,i}return(0,i._)(t,e),t}(i.al);(K=H||(H={})).UNKNOWN="UNKNOWN",K.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",K.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",K.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",K.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",K.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",K.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",K.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",K.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",K.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",K.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",K.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",K.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",K.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",K.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",K.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",K.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",K.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",K.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",K.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",K.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",K.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",K.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",K.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",K.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",K.REQUEST_CHANNEL="REQUEST_CHANNEL",K.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",K.REFRESH_CHANNEL="REFRESH_CHANNEL",K.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",K.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",K.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS";var K,Q,W=function(e){return e.startsWith("EVENT_")||e===H.SYNC_CHANNEL_BACKGROUND||e===H.SYNC_CHANNEL_CHANGELOGS||e===H.REFRESH_CHANNEL},Y=function(e){function t(t){var n=t.channels,r=t.source,i=e.call(this)||this;return i.channels=n,i.source=r,i}return(0,i._)(t,e),t}(i.al),Z=function(e){function t(t){var n=t.channelUrls,r=t.source,i=e.call(this)||this;return i.channelUrls=n,i.source=r,i}return(0,i._)(t,e),t}(i.al),X=i.al),J=function(e){function t(t,n,r){var i=e.call(this,t,"USEV",r)||this;return i.event=new B(r),i}return(0,i._)(t,e),t}(i.W),$={},ee=function(){function e(e){var t=e.dbname,n=e.itemSizeLimit,r=e.cacheLimit,i=e.blockHashBase,s=e.blockHashMultiplier,a=e.blockHashConstant,o=e.transactionApplyDelay,u=e.disableLogger;return $[t]||(this.itemSizeLimit=void 0===n?1048576:n,this.cacheLimit=void 0===r?256:r,this.blockHashBase=void 0===i?2:i,this.blockHashMultiplier=void 0===s?10:s,this.blockHashConstant=void 0===a?11:a,this.transactionApplyDelay=void 0===o?200:o,this.disableLogger=void 0!==u&&u,$[t]=this),$[t]}return e.get=function(e){return $[e]},e}();(et=Q||(Q={}))[et.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",et[et.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",et[et.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",et[et.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",et[et.STORE_IS_FULL=61001003]="STORE_IS_FULL",et[et.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",et[et.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",et[et.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",et[et.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",et[et.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",et[et.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",et[et.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",et[et.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",et[et.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",et[et.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",et[et.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",et[et.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",et[et.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",et[et.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",et[et.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",et[et.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",et[et.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",et[et.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",et[et.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",et[et.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND";var et,en,er=function(e){function t(n){var r=n.code,i=void 0===r?Q.UNKNOWN_ERROR:r,s=n.message,a=e.call(this,void 0===s?"Unknown error occurred.":s)||this;return a.code=i,Object.setPrototypeOf(a,t.prototype),a}return(0,i._)(t,e),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:Q.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:Q.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:Q.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:Q.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:Q.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:Q.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:Q.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeEncryptionInvalid",{get:function(){return new t({code:Q.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:Q.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:Q.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:Q.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:Q.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:Q.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:Q.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:Q.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:Q.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:Q.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:Q.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:Q.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:Q.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:Q.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:Q.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:Q.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:Q.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),t}(Error);(ei=en||(en={})).INIT="init",ei.READY="ready",ei.CLOSED="closed";var ei,es,ea=function(e,t){if(void 0===t&&(t=new WeakMap),"object"==typeof e&&null!==e){if(t.has(e))throw er.circularReferenceFound;t.set(e,!0);var n=null;if(Array.isArray(e))n=e.map(function(e){return ea(e,t)});else if(e instanceof RegExp)n=e;else if(e instanceof Date)n=e;else for(var r in n={},e)n[r]=ea(e[r],t);return t.delete(e),n}return e},eo=function(e,t){if(null==t)return 1;if(null==e)return -1;if(typeof e!=typeof t)throw er.compareTypesNotMatch;var n=0;switch(typeof e){case"boolean":case"number":n=e-t;break;case"string":n=e.localeCompare(t)}return n},eu=function(e,t){for(var n=0,r=0;r<e.length;r++)n=e.charCodeAt(r)+(n<<6)+(n<<16)-n;return(n>>>0)%t},ec=el=function(e,t){if(!t)return!1;if("function"!=typeof e){for(var n in e)if(["/and","&&"].includes(n)){if(e[n].some(function(e){return!el(e,t)}))return!1}else if(["/or","||"].includes(n)){if(e[n].every()return!1}else if("/where"===n){if(!(0,e[n])(t))return!1}else{var r=n;if("object"==typeof e[r]){var i=e[r];for(var s in i)switch(s){case"/eq":case"=":if((a=t[r])!==(o=i[s]))return!1;break;case"/neq":case"!=":if((a=t[r])===(o=i[s]))return!1;break;case"/gt":case">":var a=t[r],o=i[s];if(!(eo(a,o)>0))return!1;break;case"/gte":case">=":if(!(eo(a=t[r],o=i[s])>=0))return!1;break;case"/lt":case"<":if(!(0>eo(a=t[r],o=i[s])))return!1;break;case"/lte":case"<=":if(!(0>=eo(a=t[r],o=i[s])))return!1;break;case"/in":if(a=t[r],!(o=i[s]).includes(a))return!1;break;case"/nin":if(a=t[r],(o=i[s]).includes(a))return!1;break;case"/contain":if(a=t[r],o=i[s],!a.includes(o))return!1;break;case"/regex":if(a=t[r],!(o=i[s]).test(a))return!1;break;case"/where":if(a=t[r],!(0,i[s])(a))return!1}}else if("function"==typeof e[r]){if(!e[r](t[r]))return!1}else if(e[r]!==t[r])return!1}return!0}return e(t)},eh=function(){},ed=function(){return Promise.resolve()},ef=function(e){return e},ep=(e_=es||(es={}))[e_.FORWARD=0]="FORWARD",e_[e_.BACKWARD=1]="BACKWARD";var e_,em,eg,ev,ey=function(){function e(e){var t=e.initialPrevValue,n=e.initialNextValue,r=e.iterator,i=e.map,s=e.backward,a=e.forward,o=e.complete;this._prevValue=void 0===t?null:t,this._nextValue=void 0===n?null:n,this._error=null,this._map=void 0===i?ef:i,this._backward=void 0===s?ed:s,this._forward=void 0===a?ed:a,this._iterator=r,this._complete=void 0===o?eh:o}return Object.defineProperty(e.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextValue",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n;return(0,i.c)(this,function(r){switch(r.label){case 0:if(!this.hasPrevious)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._prevValue,t=this,[4,this._backward()];case 2:return t._prevValue=r.sent()||null,this._nextValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}})})},e.prototype.next=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n;return(0,i.c)(this,function(r){switch(r.label){case 0:if(!this.hasNext)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._nextValue,t=this,[4,this._forward()];case 2:return t._nextValue=r.sent()||null,this._prevValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}})})},e.prototype.stop=e}(),eb=function(){function e(e){var t=e.condition,n=e.backward,r=e.blockManager,i=e.indexer;this.condition=void 0===t?{}:t,this.backward=void 0!==n&&n,this._blockManager=r,this._indexer=i}return e.prototype.findOptimizedStartPosition=function(){var e=this,t=["=","/eq",">",">=","/gt","/gte"],n=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var r=this._indexer.origin.length-1;if("function"!=typeof this.condition)for(var i in this._indexer.fields){var s=this._indexer.fields[i],a=1;if("-"===s[0]&&(s=s.slice(1),a=-1),this.condition[s]){if("object"==typeof this.condition[s]){var o=a>0?n:t;for(var u in this.condition[s])if(o.includes(u)){for(var c=r;c>=0;c--)if(a*eo(this._indexer.origin[c].columnValues[i],this.condition[s][u])<=0){r=c;break}}}else for(c=r;c>=0;c--)if(a*eo(this._indexer.origin[c].columnValues[i],this.condition[s])<=0){r=c;break}}}return Math.min(r+1,this._indexer.origin.length-1)}var l=0;if("function"!=typeof this.condition)for(var h=function(r){var i=d._indexer.fields[r],s=1;if("-"===i[0]&&(i=i.slice(1),s=-1),d.condition[i]){if("object"==typeof d.condition[i])Object.keys(d.condition[i]).forEach(function(a){if((s>0?t:n).includes(a)){for(var o=l;o<e._indexer.origin.length;o++)if(s*eo(e._indexer.origin[o].columnValues[r],e.condition[i][a])>=0){l=o;break}}});else for(var a=l;a<d._indexer.origin.length;a++)if(s*eo(d._indexer.origin[a].columnValues[r],d.condition[i])>=0){l=a;break}}},d=this,i=0;i<this._indexer.fields.length;i++)h(i);return Math.max(l-1,0)},e.prototype.each=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u,c=this;return(0,i.c)(this,function(l){switch(l.label){case 0:if(t=this.findOptimizedStartPosition(),n=0,this.backward&&this._indexer.origin[t]&&(n=this._indexer.origin[t].keys.length-1),r=function(){if(c._indexer.origin[t]){if(!c._indexer.origin[t].keys[++n]){if(!c._indexer.origin[++t])return!1;n=0}return!0}return!1},s=function(){if(c._indexer.origin[t]){if(!c._indexer.origin[t].keys[--n]){if(!c._indexer.origin[--t])return!1;n=c._indexer.origin[t].keys.length-1}return!0}return!1},a=null,!this._indexer.origin[t])return[3,4];o=this.backward?s:r,l.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])];case 2:if(u=l.sent(),el(this.condition,u))return a=u,[3,4];l.label=3;case 3:if(o())return[3,1];l.label=4;case 4:return[4,new Promise(function(o){var u=new ey({initialNextValue:ea(a),iterator:e,forward:function(){return(0,i.b)(c,void 0,void 0,function(){var e,a;return(0,i.c)(this,function(i){switch(i.label){case 0:e=this.backward?s:r,i.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return a=i.sent(),el(this.condition,a)?[2,ea(a)]:[3,1];case 3:return[2,null]}})})},backward:function(){return(0,i.b)(c,void 0,void 0,function(){var e,a;return(0,i.c)(this,function(i){switch(i.label){case 0:e=this.backward?r:s,i.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return a=i.sent(),el(this.condition,a)?[2,ea(a)]:[3,1];case 3:return[2,null]}})})},complete:o});e(u)})];case 5:return[2,l.sent()]}})})},e}(),eE=function(){function e(e){var t=e.condition,n=e.backward,r=e.mutex,i=e.blockManager,s=e.indexer;this._mutex=r,this._iterator=new eb({condition:void 0===t?{}:t,backward:void 0!==n&&n,blockManager:i,indexer:s})}return e.prototype.fetch=function(e){return void 0===e&&(e={}),(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a=this;return(0,i.c)(this,function(o){switch(o.label){case 0:if(t=Math.max(e.offset||0,0),0===(n="number"==typeof e.limit?e.limit:Number.MAX_SAFE_INTEGER))return[2,[]];if(n<0)throw er.collectionQueryNotValid;o.label=1;case 1:return o.trys.push([1,4,,5]),r=[],[4,this._mutex.lock()];case 2:return o.sent(),[4,this._iterator.each(function(e){return(0,i.b)(a,void 0,void 0,function(){return(0,i.c)(this,function(i){return e.error?e.stop():e.hasNext?0===t?(r.push(e.nextValue),0<n&&n<=r.length?e.stop():e.next()):(t--,e.next()):e.stop(),[2]})})})];case 3:return o.sent(),this._mutex.unlock(),[2,r];case 4:throw s=o.sent(),this._mutex.unlock(),s;case 5:return[2]}})})},e.prototype.count=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n=this;return(0,i.c)(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=0,[4,this._mutex.lock()];case 1:return r.sent(),[4,this._iterator.each(function(t){return(0,i.b)(n,void 0,void 0,function(){return(0,i.c)(this,function(n){return t.error?t.stop():t.hasNext?(e++,t.next()):t.stop(),[2]})})})];case 2:return r.sent(),this._mutex.unlock(),[2,e];case 3:throw t=r.sent(),this._mutex.unlock(),t;case 4:return[2]}})})},e}(),ew=eI=eT=function(e,t){return"".concat(eI(e,t),".metadata")},eS=function(e,t){return"".concat(eI(e,t),"/block.")},eA=eN=function(){eturn e.prototype.get=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u,c,l;return(0,i.c)(this,function(i){switch(i.label){case 0:return[4,this.store.get(e)];case 1:return(t=i.sent())?(n=t.data,r=t.type,"undefined"==typeof fetch?[3,4]:[4,fetch(n)]):[3,5];case 2:return[4,i.sent().blob()];case 3:return[2,i.sent()];case 4:for(s=[],a=atob(n.split(",")[1]),o=0;o<a.length;o+=512){for(c=Array((u=a.slice(o,o+512)).length),l=0;l<u.length;l++)c[l]=u.charCodeAt(l);s.push(new Uint8Array(c))}return[2,new Blob(s,{type:r})];case 5:return[2,null]}})})},e.prototype.save=function(e,t){return void 0===t&&(t="".concat(Date.now())),(0,i.b)(this,void 0,void 0,function(){var n,r,s,a,o=this;return(0,i.c)(this,function(i){switch(i.label){case 0:return[4,new Promise(function(n){var r,i,s,a,u=(r=o.dbname,i=o.collectionName,s=t,void 0===a&&(a=0),"".concat(eA(r,i)).concat(s,".").concat(a)),c=new FileReader;c.onload=c.readAsDataURL(e)})];case 1:return r=(n=i.sent()).blobId,s=n.data,a=n.type,[4,this.store.set({key:r,value:{data:s,type:a},generation:1})];case 2:return i.sent(),[2,r]}})})},e.prototype.remove=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,this.store.remove(e)];case 1:return t.sent(),[2]}})})},e.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return e=eA(this.dbname,this.collectionName),[4,this.store.getAllKeys()];case 1:return[4,Promise.all(n.sent().filter(function(t){return t.startsWith(e)}).map(function(e){return(0,i.b)(t,void 0,void 0,function(){return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,this.store.remove(e)];case 1:return[2,t.sent()]}})})}))];case 2:return n.sent(),[2]}})})},e}();(eH=em||(em={}))[eH.COMMIT=0]="COMMIT",eH[eH.WRITE=1]="WRITE",eH[eH.ERROR=2]="ERROR",(eB=eg||(eg={})).PENDING="pending",eB.PERSISTENT="persistent",eB.VOLATILE="volatile",(ej=ev||(ev={}))[ej.NO_CACHE=0]="NO_CACHE",ej[ej.DEFAULT=1]="DEFAULT",ej[ej.PERSISTENT=2]="PERSISTENT";var eC=[eg.PENDING,eg.VOLATILE],ek={},eO=function(){function e(e){var t=e.dbname,n=e.limit;return ek[t]||(this.dbname=t,this._items=[],this._limit=void 0===n?256:n,ek[t]=this),ek[t]}return e.get=function(e){return ek[e]},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.find=function(e,t,n){return void 0===n&&(n=ev.DEFAULT),(0,i.b)(this,void 0,void 0,function(){var r,s;return(0,i.c)(this,function(i){switch(i.label){case 0:return(r=this.get(t))?[3,2]:[4,e.get(t)];case 1:return(s=i.sent())&&(r={key:t,value:s,generation:1,state:n===ev.PERSISTENT?eg.PERSISTENT:eg.VOLATILE},this.put(r)),[3,3];case 2:n===ev.PERSISTENT&&(r.state=eg.PERSISTENT),i.label=3;case 3:return[2,r]}})})},e.prototype.get=function(e,t){void 0===t&&(t=ev.DEFAULT);var n=this._items.map(function(e){return e.key}).indexOf(e);if(n>-1){var r=this._items[n];return t===ev.PERSISTENT&&(r.state=eg.PERSISTENT),t!==ev.NO_CACHE&&this.put(r),r}return null},e.prototype.put=function(e){var t,n;if(this._limit>0){var r=this._items.map(function(e){return e.key}).indexOf(e.key);if(r>-1)eC.includes(this._items[r].state)&&eC.includes(e.state)?(this._items.splice(r,1),this._items.push(e)):(this._items[r].state=e.state,this._items[r].generation=e.generation,this._items[r].value=e.value);else{this._items.push(e);var s=this._items.filter(function(e){return e.state===eg.VOLATILE}).length-this._limit;if(s>0){var a=[];try{for(var o=(0,i.G)(this._items),u=o.next();!u.done;u=o.next()){var c=u.value;c.state===eg.VOLATILE&&s>0?s--:a.push(c)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}this._items=a}}}},e.prototype.remove=function(e){var t=this._items.map(function(e){return e.key}).indexOf(e);t>-1&&this._items.splice(t,1)},e.prototype.clearByCondition=function(e){this._items=this._items.filter(},e.prototype.clear=function(e){void 0===e&&(e=!1),this._items=e?[]:this._items.filter(},e}(),eR=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this._metadata=null,this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=t,this.collectionName=n,this.metadataKey="".concat(eI(t,n),"/trans.metadata"),this.recordsetKey="".concat(eI(t,n),"/trans.recordset"),this._store=r}return Object.defineProperty(e.prototype,"generation",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestCount",{get:enumerable:!1,configurable:!0}),e.prototype._getReducedRecordset=function(e){return void 0===e&&(e=[]),(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(t=n.sent()||[]).push.apply(t,(0,i.o)([],(0,i.p)(e),!1)),[2,this._reduceRecordSet(t)]}})})},e.prototype._reduceRecordSet=function(e){for(var t=[],n={},r=e.length-1;r>=0;r--){for(var i=e[r],s=[],a=i.requests.length-1;a>=0;a--){var o=i.requests[a],u=o.data;n[u.key]||(s.unshift(o),n[u.key]=!0)}s.length>0&&(i.requests=s,t.unshift(i))}return t},e.prototype._applyRecord=function(e,t){return(0,i.b)(this,void 0,void 0,function(){var n,r,s,a,o,u,c,l;return(0,i.c)(this,function(h){switch(h.label){case 0:n=eO.get(this.dbname),r=t.generation,s=t.requests,a=null,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this._store.setMany(s.map(function(e){return(0,i.g)((0,i.g)({},e.data),{generation:r})}))];case 2:for(o=h.sent(),u=0;u<s.length;u++)o[u]instanceof Error&&(a||(a=o[u]),c=s[u].data,n.put((0,i.g)((0,i.g)({},c),{generation:r,state:eg.PERSISTENT})));return[3,4];case 3:return a=h.sent(),[3,4];case 4:return a?[3,6]:(l=e.filter(,[4,this._store.set({key:this.recordsetKey,value:l,generation:r})]);case 5:return h.sent(),this._onWrite.forEach(function(e){e(s.map(function(e){return e.data}))}),[3,7];case 6:this._onError.forEach(function(e){return e(a)}),h.label=7;case 7:return[2]}})})},e.prototype.init=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n,r,s,a,o;return(0,i.c)(this,function(u){switch(u.label){case 0:return e=this,[4,this._store.get(this.metadataKey)];case 1:return e._metadata=u.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:t=u.sent(),u.label=3;case 3:u.trys.push([3,8,9,10]),r=(n=(0,i.G)(t)).next(),u.label=4;case 4:return r.done?[3,7]:(s=r.value,[4,this._applyRecord(t,s)]);case 5:u.sent(),u.label=6;case 6:return r=n.next(),[3,4];case 7:return[3,10];case 8:return a={error:u.sent()},[3,10];case 9:try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}return[7];case 10:return[2]}})})},e.prototype.on=function(e,t,n){switch(e){case em.COMMIT:this._onCommit.set(t,n);break;case em.WRITE:this._onWrite.set(t,n);break;case em.ERROR:this._onError.set(t,n)}},e.prototype.requestWrite=function(e,t){void 0===t&&(t=null),this._requests.push({data:e,options:t}),eO.get(this.dbname).put((0,i.g)({state:eg.PENDING,generation:this.generation},e))},e.prototype.requestMultipleWrite=function(e,t){void 0===t&&(t=null);var n,r,s=eO.get(this.dbname);try{for(var a=(0,i.G)(e),o=a.next();!o.done;o=a.next()){var u=o.value;this._requests.push({data:u,options:t}),s.put((0,i.g)({state:eg.PENDING,generation:this.generation},u))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},e.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){return eO.get(this.dbname).clearByCondition(,this._requests=[],[2]})})},e.prototype.commit=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n,r,s,a,o,u,c,l,h,d=this;return(0,i.c)(this,function(f){switch(f.label){case 0:if(!((e=this._requests).length>0))return[3,4];for(t=[],n={},u=e.length-1;u>=0;u--)n[(l=(r=e[u]).data).key]||(n[l.key]=!0,t.unshift(r));return s={generation:this.generation,requests:t},[4,this._getReducedRecordset([s])];case 1:return a=f.sent(),[4,this._store.set({key:this.recordsetKey,value:a,generation:this.generation})];case 2:return f.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata,generation:1})];case 3:for(f.sent(),o=eO.get(this.dbname),u=0;u<t.length;u++)l=(c=t[u]).data,h=c.options,o.put((0,i.g)((0,i.g)({},l),{generation:s.generation,state:h&&h.persistent?eg.PERSISTENT:eg.VOLATILE}));this._requests=[],this._onCommit.forEach(,setTimeout(function(){try{d._applyRecord(a,s)}catch(e){d._onError.forEach(function(t){return t(e)})}},ee.get(this.dbname).transactionApplyDelay),f.label=4;case 4:return[2]}})})},e}(),eD=function(){function e(e){var t=e.blockId,n=e.keyName,r=e.items,s=e.limit;this.blockId=t,this.keyName=n,this.limit=s,this._items=(0,i.o)([],(0,i.p)(void 0===r?[]:r),!1)}return e.createFromCacheItem=Object.defineProperty(e.prototype,"isEmpty",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.serialize=e.prototype.getItemByKey=function(e){var t=this;return this._items.find(},e.prototype.has=function(e){var t=this;return this._items.map(function(e){return e[t.keyName]}).includes(e)},e.prototype.add=function(e){var t=this,n=this._items.map(.indexOf(e[this.keyName]);return n<0?this._items.length<this.limit&&(this._items.push(e),!0):(this._items[n]=e,!0)},e.prototype.remove=function(e){for(var t in this._items)if(this._items[t][this.keyName]===e)return this._items.splice(parseInt(t),1),!0;return!1},e.prototype.clear=e}(),eU=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.metadata,i=e.hashFunction,s=e.transaction,a=e.store;this.dbname=t,this.collectionName=n,this.hashFunction=void 0===i?eu:i,this.metadata=r,this._transaction=s,this._store=a}return Object.defineProperty(e.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),e.prototype.createBlockId=function(e,t){var n,r,i,s,a,o,u;return void 0===t&&(t=this.metadata.blockLevel),n=this.dbname,r=this.collectionName,i=t,s="".concat((a=t,u=(o={hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant}).base*Math.pow(o.multiplier,a)+o.constant,(o.hashFunction||eu)(e,u))),"".concat(eS(n,r)).concat(i,".").concat(s)},e.prototype._findBlock=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a;return(0,i.c)(this,function(i){switch(i.label){case 0:t=eO.get(this.dbname),n=this.metadata.blockLevel,i.label=1;case 1:return n>0?(r=this.createBlockId(e,n),[4,t.find(this._store,r)]):[3,4];case 2:if((s=i.sent())&&(a=eD.createFromCacheItem(s)).getItemByKey(e))return[2,a];i.label=3;case 3:return n--,[3,1];case 4:return[2,null]}})})},e.prototype.getFromBlock=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return[2,(t=n.sent())?t.getItemByKey(e):null]}})})},e.prototype.putToBlock=function(e,t){return(0,i.b)(this,void 0,void 0,function(){var n,r,s,a,o;return(0,i.c)(this,function(i){switch(i.label){case 0:return n=ee.get(this.dbname),r=this.createBlockId(e),s=Math.floor(this._store.itemSizeLimit/n.itemSizeLimit),[4,eO.get(this.dbname).find(this._store,r)];case 1:return(o=(a=i.sent())?eD.createFromCacheItem(a):new eD({blockId:r,keyName:this.keyName,items:[],limit:s})).add(t)?(this._transaction.requestWrite({key:o.blockId,value:o.serialize()}),[2,!0]):[2,!1]}})})},e.prototype.removeFromBlock=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return(t=n.sent())&&t.remove(e)?(this._transaction.requestWrite({key:t.blockId,value:t.serialize()}),[2,!0]):[2,!1]}})})},e.prototype.clearAllBlocks=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t;return(0,i.c)(this,function(n){switch(n.label){case 0:return e=eS(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return t=n.sent().filter(function(t){return t.startsWith(e)}),[4,this._store.removeMany(t)];case 2:return n.sent(),[4,this._transaction.clear()];case 3:return n.sent(),eO.get(this.dbname).clearByCondition(,[2]}})})},e}(),eL={},eM=function(){function e(e){var t,n=e.dbname,r=e.collectionName,i=e.keyName,s=e.fields,a=e.transaction,o=e.store,u=this;this._origin=[],this._table=[];var c=(t=s.join(">"),"".concat(eI(n,r),"/index.").concat(t));return eL[c]||(this.dbname=n,this.collectionName=r,this.keyName=i,this.fields=s,this.indexerKey=c,this._transaction=a,this._store=o,this._transaction.on(em.COMMIT,this.indexerKey,function(){return u.commit()}),this._transaction.on(em.ERROR,this.indexerKey,),eL[c]}return e.createKey=function(e){return e.join(">")},e.parseKey=function(e){return e.split(">")},e.clearIndexerMap=e.prototype._addItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=(0,i.p)(this.indexOf(n),2),s=r[0];return r[1]?!this._table[s].keys.includes(t)&&(this._table[s].keys.push(t),!0):(this._table.splice(s,0,{columnValues:n,keys:[t]}),!0)},e.prototype._removeItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=(0,i.p)(this.indexOf(n),2),s=r[0];if(r[1]){var a=this._table[s].keys.indexOf(t);if(a>-1)return this._table[s].keys.splice(a,1),0===this._table[s].keys.length&&this._table.splice(s,1),!0}return!1},Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),e.prototype.getColumnValues=function(e){var t,n,r,s,a=[];try{for(var o=(0,i.G)(this.fields),u=o.next();!u.done;u=o.next()){var c=u.value;if("-"===c[0]&&(c=c.slice(1)),r=e[c],s=void 0,s=typeof r,null!==r&&"undefined"!==s&&"boolean"!==s&&"number"!==s&&"string"!==s)throw er.indexTypesNotMatch;a.push(e[c])}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a},e.prototype.diff=function(e,t){for(var n in this.fields){var r="-"===this.fields[n][0]?-1:1,i=eo(e[n],t[n]);if(0!==i)return r*i}return 0},e.prototype.indexOf=function(e){if(this._table.length>0){for(var t=0,n=this._table.length-1;t<=n;){var r=Math.floor((t+n)/2),i=this.diff(e,this._table[r].columnValues);if(i>0)t=r+1;else{if(!(i<0))return[r,!0];n=r-1}}return[t,!1]}return[0,!1]},e.prototype.ensure=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n,r,s,a,o,u,c,l,h,d,f,p,_,m;return(0,i.c)(this,function(g){switch(g.label){case 0:return[4,(e=eO.get(this.dbname)).find(this._store,this.indexerKey,ev.PERSISTENT)];case 1:return(t=g.sent())?[3,11]:(n=eS(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:r=g.sent(),g.label=3;case 3:g.trys.push([3,8,9,10]),a=(s=(0,i.G)(r)).next(),g.label=4;case 4:return a.done?[3,7]:(o=a.value).startsWith(n)?[4,e.find(this._store,o,ev.NO_CACHE)]:[3,6];case 5:u=g.sent(),c=eD.createFromCacheItem(u);try{for(_=void 0,h=(l=(0,i.G)(c.items)).next();!h.done;h=l.next())d=h.value,this._addItem(d)}catch(e){_={error:e}}finally{try{h&&!h.done&&(m=l.return)&&m.call(l)}finally{if(_)throw _.error}}g.label=6;case 6:return a=s.next(),[3,4];case 7:return[3,10];case 8:return f={error:g.sent()},[3,10];case 9:try{a&&!a.done&&(p=s.return)&&p.call(s)}finally{if(f)throw f.error}return[7];case 10:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,12];case 11:this._origin=t.value,this._table=ea(this._origin),g.label=12;case 12:return eL[this.indexerKey]=this,[2]}})})},e.prototype.drop=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){switch(e.label){case 0:return eO.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return e.sent(),delete eL[this.indexerKey],[2]}})})},e.prototype.addItem=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(t){return this._addItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},e.prototype.removeItem=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(t){return this._removeItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},e.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},e.prototype.commit=function(){this._origin=this._table,this._table=ea(this._origin)},e.prototype.abort=e}(),eP=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,s=e.keyHash,a=e.indexes,o=e.store,u=this;this._state=en.INIT,this._metadata=null,this._indexers=[],this.dbname=t,this.name=n,this.keyName=r,this.indexes=(0,i.o)([[r]],(0,i.p)(a.filter(),!1),this._keyHash=s,this._store=o,this._mutex=new C("".concat(eI(t,n),".lock")),this._blobContainer=new eN({dbname:t,collectionName:n,store:o}),this._transaction=new eR({dbname:t,collectionName:n,store:o})}return e.metadataOf=function(e,t,n){return(0,i.b)(this,void 0,void 0,function(){var r;return(0,i.c)(this,function(i){switch(i.label){case 0:return r=eT(e,t),[4,n.get(r)];case 1:return[2,i.sent()]}})})},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return this._state===en.READY},enumerable:!1,configurable:!0}),e.prototype.init=function(){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u,c,l,h,d,f,p,_,m=this;return(0,i.c)(this,function(g){switch(g.label){case 0:return[4,this._mutex.lock()];case 1:g.sent(),g.label=2;case 2:return g.trys.push([2,9,,10]),t=ee.get(this.dbname),[4,e.metadataOf(this.dbname,this.name,this._store)];case 3:return n=g.sent(),this._metadata=n||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:g.sent(),this._blockManager=new eU({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=(0,i.o)([],(0,i.p)(this.indexes),!1),s=[],a=r.map(function(e){return eM.createKey(e)}),o=n?n.indexes.map(function(e){return eM.createKey(e)}):[];try{for(c=(u=(0,i.G)(o)).next();!c.done;c=u.next())l=c.value,a.includes(l)||s.push(eM.parseKey(l))}catch(e){p={error:e}}finally{try{c&&!c.done&&(_=u.return)&&_.call(u)}finally{if(p)throw p.error}}return(h=[]).push.apply(h,(0,i.o)([],(0,i.p)(r.map(function(e){var t=new eM({dbname:m.dbname,collectionName:m.name,keyName:m.keyName,fields:e,transaction:m._transaction,store:m._store});return m._indexers.push(t),t.ensure()})),!1)),h.push.apply(h,(0,i.o)([],(0,i.p)(s.map(function(e){return new eM({dbname:m.dbname,collectionName:m.name,keyName:m.keyName,fields:e,transaction:m._transaction,store:m._store}).drop()})),!1)),[4,Promise.all(h)];case 5:return g.sent(),[4,this._transaction.commit()];case 6:return g.sent(),a.sort().join(",")===o.sort().join(",")?[3,8]:(d=eT(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:d,value:this._metadata,generation:1})]);case 7:g.sent(),g.label=8;case 8:return this._state=en.READY,this._mutex.unlock(),[3,10];case 9:throw f=g.sent(),this._mutex.unlock(),f;case 10:return[2]}})})},e.prototype.close=e.prototype._hasPropertyOfKeyName=function(e){var t=e[this.keyName];return"string"==typeof t&&!!t},e.prototype._getIndexerBy=function(e){void 0===e&&(e=null),e||(e=[this.keyName]);var t,n,r=eM.createKey(e);try{for(var s=(0,i.G)(this._indexers),a=s.next();!a.done;a=s.next()){var o=a.value;if(r===eM.createKey(o.fields))return o}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return null},e.prototype._upgradeBlockLevel=function(){return(0,i.b)(this,void 0,void 0,function(){var e;return(0,i.c)(this,function(t){switch(t.label){case 0:return e=eT(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:e,value:this._metadata,generation:1})];case 1:return t.sent(),[2]}})})},e.prototype._requestInsert=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a;return(0,i.c)(this,function(o){switch(o.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return o.sent()?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return o.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return o.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:o.sent(),o.label=5;case 5:o.trys.push([5,10,11,12]),r=(n=(0,i.G)(this._indexers)).next(),o.label=6;case 6:return r.done?[3,9]:[4,r.value.addItem(e)];case 7:o.sent(),o.label=8;case 8:return r=n.next(),[3,6];case 9:return[3,12];case 10:return s={error:o.sent()},[3,12];case 11:try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}return[7];case 12:return[3,14];case 13:throw er.collectionInsertDuplicate;case 14:return[2]}})})},e.prototype._requestUpsert=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u,c,l,h,d;return(0,i.c)(this,function(f){switch(f.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=f.sent())?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return f.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return f.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:f.sent(),f.label=5;case 5:f.trys.push([5,10,11,12]),s=(r=(0,i.G)(this._indexers)).next(),f.label=6;case 6:return s.done?[3,9]:[4,(u=s.value).addItem(e)];case 7:f.sent(),f.label=8;case 8:return s=r.next(),[3,6];case 9:return[3,12];case 10:return c={error:f.sent()},[3,12];case 11:try{s&&!s.done&&(l=r.return)&&l.call(r)}finally{if(c)throw c.error}return[7];case 12:return[3,23];case 13:return[4,this._blockManager.putToBlock(t,e)];case 14:f.sent(),f.label=15;case 15:f.trys.push([15,21,22,23]),o=(a=(0,i.G)(this._indexers)).next(),f.label=16;case 16:return o.done?[3,20]:0===(u=o.value).diff(u.getColumnValues(n),u.getColumnValues(e))?[3,19]:[4,u.removeItem(n)];case 17:return f.sent(),[4,u.addItem(e)];case 18:f.sent(),f.label=19;case 19:return o=a.next(),[3,16];case 20:return[3,23];case 21:return h={error:f.sent()},[3,23];case 22:try{o&&!o.done&&(d=a.return)&&d.call(a)}finally{if(h)throw h.error}return[7];case 23:return[2]}})})},e.prototype._requestUpdate=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u;return(0,i.c)(this,function(c){switch(c.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=c.sent())?[4,this._blockManager.putToBlock(t,e)]:[3,11];case 2:c.sent(),c.label=3;case 3:c.trys.push([3,9,10,11]),s=(r=(0,i.G)(this._indexers)).next(),c.label=4;case 4:return s.done?[3,8]:0===(a=s.value).diff(a.getColumnValues(n),a.getColumnValues(e))?[3,7]:[4,a.removeItem(n)];case 5:return c.sent(),[4,a.addItem(e)];case 6:c.sent(),c.label=7;case 7:return s=r.next(),[3,4];case 8:return[3,11];case 9:return o={error:c.sent()},[3,11];case 10:try{s&&!s.done&&(u=r.return)&&u.call(r)}finally{if(o)throw o.error}return[7];case 11:return[2]}})})},e.prototype._requestRemove=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a;return(0,i.c)(this,function(o){switch(o.label){case 0:return[4,this._blockManager.getFromBlock(e)];case 1:return(t=o.sent())?[4,this._blockManager.removeFromBlock(e)]:[3,10];case 2:o.sent(),o.label=3;case 3:o.trys.push([3,8,9,10]),r=(n=(0,i.G)(this._indexers)).next(),o.label=4;case 4:return r.done?[3,7]:[4,r.value.removeItem(t)];case 5:o.sent(),o.label=6;case 6:return r=n.next(),[3,4];case 7:return[3,10];case 8:return s={error:o.sent()},[3,10];case 9:try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}return[7];case 10:return[2]}})})},e.prototype._requestClear=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n,r;return(0,i.c)(this,function(s){switch(s.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:s.sent(),s.label=2;case 2:s.trys.push([2,7,8,9]),t=(e=(0,i.G)(this._indexers)).next(),s.label=3;case 3:return t.done?[3,6]:[4,t.value.clear()];case 4:s.sent(),s.label=5;case 5:return t=e.next(),[3,3];case 6:return[3,9];case 7:return n={error:s.sent()},[3,9];case 8:try{t&&!t.done&&(r=e.return)&&r.call(e)}finally{if(n)throw n.error}return[7];case 9:return[2]}})})},e.prototype.getByKey=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n;return(0,i.c)(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,6];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(e)];case 3:return t=r.sent(),this._mutex.unlock(),[2,ea(t)];case 4:throw n=r.sent(),this._mutex.unlock(),n;case 5:return[3,7];case 6:throw er.collectionNotReady;case 7:return[2]}})})},e.prototype.query=function(e){return void 0===e&&(e={}),this.isReady?new eE({condition:e.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(e.index),backward:!!e.backward}):null},e.prototype.insertOne=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw er.collectionKeyNotGiven;return[4,this._requestInsert(ea(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw er.collectionNotReady;case 9:return[2]}})})},e.prototype.insertMany=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u=this;return(0,i.c)(this,function(c){switch(c.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:c.sent(),c.label=2;case 2:if(c.trys.push([2,12,,14]),e.some(function(e){return!u._hasPropertyOfKeyName(e)}))throw er.collectionKeyNotGiven;c.label=3;case 3:c.trys.push([3,8,9,10]),n=(t=(0,i.G)(e)).next(),c.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestInsert(ea(r))]);case 5:c.sent(),c.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return a={error:c.sent()},[3,10];case 9:try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(a)throw a.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return c.sent(),this._mutex.unlock(),[2,e];case 12:return s=c.sent(),[4,this._transaction.clear()];case 13:throw c.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw er.collectionNotReady;case 16:return[2]}})})},e.prototype.upsertOne=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw er.collectionKeyNotGiven;return[4,this._requestUpsert(ea(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw er.collectionNotReady;case 9:return[2]}})})},e.prototype.upsertMany=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u=this;return(0,i.c)(this,function(c){switch(c.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:c.sent(),c.label=2;case 2:if(c.trys.push([2,12,,14]),e.some()throw er.collectionKeyNotGiven;c.label=3;case 3:c.trys.push([3,8,9,10]),n=(t=(0,i.G)(e)).next(),c.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestUpsert(ea(r))]);case 5:c.sent(),c.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return a={error:c.sent()},[3,10];case 9:try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(a)throw a.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return c.sent(),this._mutex.unlock(),[2,e];case 12:return s=c.sent(),[4,this._transaction.clear()];case 13:throw c.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw er.collectionNotReady;case 16:return[2]}})})},e.prototype.update=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw er.collectionKeyNotGiven;return[4,this._requestUpdate(ea(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw er.collectionNotReady;case 9:return[2]}})})},e.prototype.updateIf=function(e,t){return(0,i.b)(this,void 0,void 0,function(){var n,r,s,a,o,u,c,l,h,d,f,p,_,m=this;return(0,i.c)(this,function(g){switch(g.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,16];case 1:g.sent(),g.label=2;case 2:return g.trys.push([2,13,,15]),r=void 0===(n=e.where)?{}:n,a=void 0===(s=e.index)?null:s,u=void 0!==(o=e.backward)&&o,c=[],[4,new eb({condition:r,blockManager:this._blockManager,backward:u,indexer:this._getIndexerBy(a)}).each(function(e){return(0,i.b)(m,void 0,void 0,function(){var n,s;return(0,i.c)(this,function(i){if(e.error)throw e.stop(),e.error;if(e.hasNext){if(el(r,n=e.nextValue)&&t.set){if("function"!=typeof t.set)for(s in t.set)n[s]=t.set[s];else t.set(n);c.push(n)}e.next()}else e.stop();return[2]})})})];case 3:g.sent(),g.label=4;case 4:g.trys.push([4,9,10,11]),h=(l=(0,i.G)(c)).next(),g.label=5;case 5:return h.done?[3,8]:(d=h.value,[4,this._requestUpdate(ea(d))]);case 6:g.sent(),g.label=7;case 7:return h=l.next(),[3,5];case 8:return[3,11];case 9:return p={error:g.sent()},[3,11];case 10:try{h&&!h.done&&(_=l.return)&&_.call(l)}finally{if(p)throw p.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return g.sent(),this._mutex.unlock(),[2,c];case 13:return f=g.sent(),[4,this._transaction.clear()];case 14:throw g.sent(),this._mutex.unlock(),f;case 15:return[3,17];case 16:throw this._transaction.clear(),er.collectionNotReady;case 17:return[2]}})})},e.prototype.remove=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,this._requestRemove(e)];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[3,7];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw er.collectionNotReady;case 9:return[2]}})})},e.prototype.removeIf=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u,c,l,h,d,f,p,_=this;return(0,i.c)(this,function(m){switch(m.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:m.sent(),m.label=2;case 2:return m.trys.push([2,13,,14]),n=void 0===(t=e.where)?{}:t,s=void 0===(r=e.index)?null:r,o=void 0!==(a=e.backward)&&a,u=[],[4,new eb({condition:n,blockManager:this._blockManager,backward:o,indexer:this._getIndexerBy(s)}).each(function(e){return(0,i.b)(_,void 0,void 0,function(){var t,r;return(0,i.c)(this,function(i){if(e.error)throw e.stop(),e.error;return e.hasNext?(el(n,t=e.nextValue)&&(r=t[this.keyName],u.push(r)),e.next()):e.stop(),[2]})})})];case 3:m.sent(),m.label=4;case 4:m.trys.push([4,9,10,11]),l=(c=(0,i.G)(u)).next(),m.label=5;case 5:return l.done?[3,8]:(h=l.value,[4,this._requestRemove(h)]);case 6:m.sent(),m.label=7;case 7:return l=c.next(),[3,5];case 8:return[3,11];case 9:return f={error:m.sent()},[3,11];case 10:try{l&&!l.done&&(p=c.return)&&p.call(c)}finally{if(f)throw f.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return m.sent(),this._mutex.unlock(),[2,u];case 13:throw d=m.sent(),this._mutex.unlock(),d;case 14:return[3,16];case 15:throw this._transaction.clear(),er.collectionNotReady;case 16:return[2]}})})},e.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){var e;return(0,i.c)(this,function(t){switch(t.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return t.sent(),[4,this._transaction.commit()];case 4:return t.sent(),this._mutex.unlock(),[3,7];case 5:return e=t.sent(),[4,this._transaction.clear()];case 6:throw t.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw er.collectionNotReady;case 9:return[2]}})})},e.prototype.getBlob=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,})},e.prototype.saveBlob=function(e,t){return void 0===t&&(t=null),(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,})},e.prototype.removeBlob=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,})},e.prototype.removeAllBlobs=e}(),ex=function(){function e(e){var t,n,r;this.encryption=null!==(t=e.encryption)&&void 0!==t?t:i.an,this.itemSizeLimit=null!==(n=e.itemSizeLimit)&&void 0!==n?n:4194304,this.metadataBuffer=null!==(r=e.metadataBuffer)&&void 0!==r?r:256}return e.prototype._getRawKey=function(e,t){return void 0===t&&(t=""),"".concat(e).concat(t)},e.prototype._generateShardPostfixArray=function(e){return void 0===e&&(e=1),(0,i.o)([],(0,i.p)(Array(e).keys()),!1)},e.prototype._shardify=function(e){var t=this,n=e.key,r=e.value,i=JSON.stringify(this.encryption.encrypt(r)),s=Math.ceil(i.length/this.adjustedItemSizeLimit);return this._generateShardPostfixArray(s).map(function(e){var r={key:t._getRawKey(n,".".concat(e)),data:i.substring(e*t.adjustedItemSizeLimit,(e+1)*t.adjustedItemSizeLimit)};return 0===e&&(r.metadata={shards:s}),r})},Object.defineProperty(e.prototype,"adjustedItemSizeLimit",{get:enumerable:!1,configurable:!0}),e.prototype.usage=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n,r,s,a,o,u;return(0,i.c)(this,function(c){switch(c.label){case 0:return e=0,[4,this._getAllRawKeys()];case 1:t=c.sent(),c.label=2;case 2:c.trys.push([2,7,8,9]),r=(n=(0,i.G)(t)).next(),c.label=3;case 3:return r.done?[3,6]:(s=r.value,[4,this._getRaw(s)]);case 4:(a=c.sent())&&(e+=JSON.stringify(a).length),c.label=5;case 5:return r=n.next(),[3,3];case 6:return[3,9];case 7:return o={error:c.sent()},[3,9];case 8:try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(o)throw o.error}return[7];case 9:return[2,e]}})})},e.prototype.getAllKeys=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){switch(e.label){case 0:return[4,this._getAllRawKeys()];case 1:return[2,e.sent().filter(.map(]}})})},e.prototype.get=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u=this;return(0,i.c)(this,function(c){switch(c.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:if(!(n=c.sent()))return[3,7];c.label=2;case 2:return c.trys.push([2,6,,7]),r=n.data,(null==(s=n.metadata)?void 0:s.shards)>1?[4,Promise.all(this._generateShardPostfixArray(null==s?void 0:s.shards).map(function(t){return(0,i.b)(u,void 0,void 0,function(){var n,s;return(0,i.c)(this,function(i){switch(i.label){case 0:return t>0?(n=this._getRawKey(e,".".concat(t)),[4,this._getRaw(n)]):[3,2];case 1:if(!(s=i.sent()))throw er.storeBrokenIntegrity;return[2,s.data];case 2:return[2,r]}})})}))]:[3,4];case 3:return o=c.sent(),[3,5];case 4:o=[r],c.label=5;case 5:return a=o,[2,this.encryption.decrypt(JSON.parse(a.join("")))];case 6:return c.sent(),[2,null];case 7:return[2,null]}})})},e.prototype.set=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return t=this._shardify(e),[4,this._setRaw(t)];case 1:return n.sent(),[2,(0,i.g)({},e.value)]}})})},e.prototype.setMany=function(e){return(0,i.b)(this,void 0,void 0,function(){var t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this._setRaw([].concat.apply([],(0,i.o)([],(0,i.p)(e.map(),!1)))];case 1:return n.sent(),[2,e.map(]}})})},e.prototype.remove=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s=this;return(0,i.c)(this,function(i){switch(i.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:return(n=i.sent())?(r=n.metadata,[4,this._removeRaw(this._generateShardPostfixArray(null==r?void 0:r.shards).map(function(t){return s._getRawKey(e,".".concat(t))}))]):[3,3];case 2:return i.sent(),[2,!0];case 3:return[2,!1]}})})},e.prototype.removeMany=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u,c=this;return(0,i.c)(this,function(l){switch(l.label){case 0:t=[],n=function(e){var n,s,a;return(0,i.c)(this,function(o){switch(o.label){case 0:return n=r._getRawKey(e,".0"),[4,r._getRaw(n)];case 1:return(s=o.sent())&&(a=s.metadata,t.push.apply(t,(0,i.o)([],(0,i.p)(r._generateShardPostfixArray(null==a?void 0:a.shards).map(function(t){return c._getRawKey(e,".".concat(t))})),!1))),[2]}})},r=this,l.label=1;case 1:l.trys.push([1,6,7,8]),a=(s=(0,i.G)(e)).next(),l.label=2;case 2:return a.done?[3,5]:[5,n(a.value)];case 3:l.sent(),l.label=4;case 4:return a=s.next(),[3,2];case 5:return[3,8];case 6:return o={error:l.sent()},[3,8];case 7:try{a&&!a.done&&(u=s.return)&&u.call(s)}finally{if(o)throw o.error}return[7];case 8:return t.length>0?[4,this._removeRaw(t)]:[3,10];case 9:l.sent(),l.label=10;case 10:return[2,e]}})})},e}(),eq={},eF=function(e){function t(t){void 0===t&&(t={});var n,r=this;r=e.call(this,(0,i.g)((0,i.g)({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:4194304}))||this;var s=t.delay;return r.delay=void 0===s?1:s,r.observer={},r}return(0,i._)(t,e),Object.defineProperty(t.prototype,"rawData",{get:set:enumerable:!1,configurable:!0}),t.prototype._getAllRawKeys=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){if(eq[this.dbname])return[2,Object.keys(eq[this.dbname])];throw er.storeNotAvailable})})},t.prototype._getRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(t){switch(t.label){case 0:return eq[this.dbname]?[4,ec(this.delay)]:[3,2];case 1:return t.sent(),[2,eq[this.dbname][e]?(0,i.g)({key:e},eq[this.dbname][e]):null];case 2:throw er.storeNotAvailable}})})},t.prototype._setRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u,c;return(0,i.c)(this,function(l){switch(l.label){case 0:return eq[this.dbname]?[4,ec(this.delay)]:[3,2];case 1:l.sent();try{for(n=(t=(0,i.G)(e)).next();!n.done;n=t.next())s=(r=n.value).key,a=r.data,o=r.metadata,eq[this.dbname][s]=Object.freeze({data:a,metadata:o})}catch(e){u={error:e}}finally{try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(u)throw u.error}}return[3,3];case 2:throw er.storeNotAvailable;case 3:return[2]}})})},t.prototype._removeRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a;return(0,i.c)(this,function(o){switch(o.label){case 0:return eq[this.dbname]?[4,ec(this.delay)]:[3,2];case 1:o.sent();try{for(n=(t=(0,i.G)(e)).next();!n.done;n=t.next())r=n.value,eq[this.dbname][r]&&delete eq[this.dbname][r]}catch(e){s={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}}return[3,3];case 2:throw er.storeNotAvailable;case 3:return[2]}})})},t.prototype.observe=function(e,t,n){var r=this;this.observer[e]||(this.observer[e]={}),t.forEach(},t.prototype.isAvailable=t.prototype.init=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(t){return this.dbname=e,eq[this.dbname]={},[2]})})},t.prototype.set=function(t){return(0,i.b)(this,void 0,void 0,function(){var n;return(0,i.c)(this,function(r){if(this.observer[t.key]&&"function"==typeof this.observer[t.key].set&&(n=this.observer[t.key].set()))throw n;return[2,e.prototype.set.call(this,t)]})})},t.prototype.setMany=function(t){return(0,i.b)(this,void 0,void 0,function(){var n,r,s,a,o,u;return(0,i.c)(this,function(c){try{for(r=(n=(0,i.G)(t)).next();!r.done;r=n.next())if(s=r.value,this.observer[s.key]&&"function"==typeof this.observer[s.key].set&&(a=this.observer[s.key].set()))throw a}catch(e){o={error:e}}finally{try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(o)throw o.error}}return[2,e.prototype.setMany.call(this,t)]})})},t.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){switch(e.label){case 0:return[4,ec(this.delay)];case 1:return e.sent(),eq[this.dbname]={},[2]}})})},t}(ex),eV="NestDBStore",ez=function(e){function t(t){void 0===t&&(t={});var n,r=this;return(r=e.call(this,(0,i.g)((0,i.g)({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:104857600}))||this)._storeName=eV,r._window="undefined"!=typeof window?window:null,r._indexedDb=r._window?r._window.indexedDB||r._window.mozIndexedDB||r._window.webkitIndexedDB||r._window.msIndexedDB:null,r}return(0,i._)(t,e),t.prototype._getObjectStore=function(e){return this._database.transaction(this._storeName,e).objectStore(this._storeName)},t.prototype._getAllRawKeys=function(){return(0,i.b)(this,void 0,void 0,function(){var e=this;return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){var r=e._getObjectStore("readonly").getAllKeys();r.addEventListener("success",,r.addEventListener("error",function(e){return n(e.target.error)})})];case 1:return[2,t.sent()]}})})},t.prototype._getRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n,r){var i=t._getObjectStore("readonly").get(e);i.addEventListener("success",,i.addEventListener("error",})];case 1:return[2,n.sent()]}})})},t.prototype._setRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return t=this._getObjectStore("readwrite"),[4,Promise.all(e.map(function(e){return new Promise(function(n,r){var i=t.put(e);i.addEventListener("success",function(e){n(e.target.result)}),i.addEventListener("error",})}))];case 1:return n.sent(),[2]}})})},t.prototype._removeRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return t=this._getObjectStore("readwrite"),[4,Promise.all(e.map(function(e){return new Promise(function(n,r){var i=t.delete(e);i.addEventListener("success",function(){return n(e)}),i.addEventListener("error",function(e){return r(e.target.error)})})}))];case 1:return n.sent(),[2]}})})},t.prototype.isAvailable=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t,n,r,s=this;return(0,i.c)(this,function(i){switch(i.label){case 0:if(!((null==(e="undefined"!=typeof window?window:null)?void 0:e.indexedDB)||(null==e?void 0:e.mozIndexedDB)||(null==e?void 0:e.webkitIndexedDB)||(null==e?void 0:e.msIndexedDB)))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this._indexedDb=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,t="undefined"!=typeof document&&"undefined"!=typeof navigator,n=navigator.userAgent&&navigator.userAgent.includes("Firefox/")&&!navigator.userAgent.includes("Seamonkey/"),r=navigator.userAgent&&navigator.userAgent.includes("Edge/"),[4,new Promise(function(i,a){if(t){if(n){var o=s._indexedDb.open("_testMozilla");o.onerror=o.onsuccess=function(){return i()}}else r?(e.PointerEvent||e.MSPointerEvent)&&a("Private browsing mode."):i()}})];case 2:return i.sent(),[2,!0];case 3:return i.sent(),[2,!1];case 4:return[2,!1]}})})},t.prototype.init=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n=this;return(0,i.c)(this,function(r){switch(r.label){case 0:return this.dbname=e,[4,new Promise(function(e,t){if(n._window&&g){if(v){var r=n._indexedDb.open("_testMozilla");r.onerror=r.onsuccess=function(){return e()}}else w?!n._window.indexedDB&&(n._window.PointerEvent||n._window.MSPointerEvent)&&t(er.storeNotAvailableInPrivateBrowsing):e()}else t(er.storeNotAvailable)})];case 1:return r.sent(),t=this,[4,new Promise(function(t,r){var i=n._indexedDb.open(e);i.addEventListener("upgradeneeded",,i.addEventListener("success",function(e){return t(e.target.result)}),i.addEventListener("error",function(e){return r(e.target.error)})})];case 2:return t._database=r.sent(),[2]}})})},t.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){var e=this;return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){var r=e._getObjectStore("readwrite").clear();r.addEventListener("success",function(){return t()}),r.addEventListener("error",function(e){return n(e.target.error)})})];case 1:return[2,t.sent()]}})})},t}(ex),eG=function(e){function t(t){var n=this,r=t.AsyncStorage,s=t.itemSizeLimit,a=(0,i.ao)(t,["AsyncStorage","itemSizeLimit"]);return(n=e.call(this,(0,i.g)((0,i.g)({},a),{itemSizeLimit:void 0===s?6291456:s}))||this)._asyncStorage=r,n}return(0,i._)(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return(0,i.b)(this,void 0,void 0,function(){var e=this;return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,this._asyncStorage.getAllKeys()];case 1:return[2,t.sent().filter(function(t){return e._isBelonging(t)}).map(function(t){return t.substring("".concat(e.dbname,"/").length)})]}})})},t.prototype._getRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return[2,(t=n.sent())?JSON.parse(t):null]}})})},t.prototype._setRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o,u;return(0,i.c)(this,function(c){switch(c.label){case 0:t=[];try{for(r=(n=(0,i.G)(e)).next();!r.done;r=n.next())a=(s=r.value).key,s.data.length<=this.adjustedItemSizeLimit&&t.push([this._getActualKey(a),JSON.stringify(s)])}catch(e){o={error:e}}finally{try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(o)throw o.error}}return[4,this._asyncStorage.multiSet(t)];case 1:return c.sent(),[2]}})})},t.prototype._removeRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this._asyncStorage.multiRemove(e.map(function(e){return t._getActualKey(e)}))];case 1:return n.sent(),[2]}})})},t.prototype.isAvailable=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){return[2,!!this._asyncStorage]})})},t.prototype.init=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(t){return this.dbname=e,[2]})})},t.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){var e;return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2]}})})},t}(ex);!function(e){function t(t){var n,r=this;return(r=e.call(this,(0,i.g)((0,i.g)({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:6291456}))||this)._mmkv=t.MMKV,r}(0,i._)(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=t.prototype._getAllRawKeys=function(){return(0,i.b)(this,void 0,void 0,function(){var e=this;return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,this._mmkv.getAllKeys()];case 1:return[2,t.sent().filter(function(t){return e._isBelonging(t)}).map(function(t){return t.substring("".concat(e.dbname,"/").length)})]}})})},t.prototype._getRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t;return(0,i.c)(this,function(n){switch(n.label){case 0:return[4,this._mmkv.getString(this._getActualKey(e))];case 1:return[2,(t=n.sent())?JSON.parse(t):null]}})})},t.prototype._setRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a,o;return(0,i.c)(this,function(u){try{for(n=(t=(0,i.G)(e)).next();!n.done;n=t.next())s=(r=n.value).key,r.data.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(s),JSON.stringify(r))}catch(e){a={error:e}}finally{try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(a)throw a.error}}return[2]})})},t.prototype._removeRaw=function(e){return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a;return(0,i.c)(this,function(o){try{for(n=(t=(0,i.G)(e)).next();!n.done;n=t.next())r=n.value,this._mmkv.delete(this._getActualKey(r))}catch(e){s={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}}return[2]})})},t.prototype.isAvailable=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){return[2,!!this._mmkv]})})},t.prototype.init=function(e){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,})},t.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){var e;return(0,i.c)(this,function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2]}})})}}(ex);var eH,eB,ej,eK,eQ="[NESTDB]",eW=!0,eY=function(){eturn e.off=e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];eW&&console.log.apply(console,(0,i.o)(["".concat(eQ,"[LOG]")],(0,i.p)(e),!1))},e.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];eW&&console.warn.apply(console,(0,i.o)(["".concat(eQ,"[WARNING]")],(0,i.p)(e),!1))},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];eW&&console.error.apply(console,(0,i.o)(["".concat(eQ,"[ERROR]")],(0,i.p)(e),!1))},e}();(r=eK||(eK={})).INIT="INIT",r.OPENING="OPENING",r.OPENED="OPENED",r.CLOSED="CLOSED";var eZ=function(){function e(e){var t=e.name,n=e.version,r=e.store,i=e.config;this.name=t,this._version=n,this._state=eK.INIT,this._config=i||new ee({dbname:t}),this._store=r,this._event={success:eh,error:eh,upgrade:ep},this._collections=new Map,this._globalMutex=new C("".concat(this.name,".lock")),this._config.disableLogger&&eY.off(),new eO({dbname:t,limit:this._config.cacheLimit})}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.estimateUsage=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){var t;switch(e.label){case 0:return[4,(t=this._store,(0,i.b)(void 0,void 0,void 0,function(){return(0,i.c)(this,}))];case 1:return[2,e.sent()]}})})},e.prototype.commitSchema=function(e){return(0,i.b)(this,void 0,void 0,function(){var t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return this._state!==eK.OPENING?[3,2]:[4,Promise.all(e.map(function(e){return(0,i.b)(t,void 0,void 0,function(){var t,n,r,s;return(0,i.c)(this,function(i){switch(i.label){case 0:return t=e.collectionName,n=e.keyName,s=void 0===(r=e.index)?[]:r,this._collections.has(t)||this._collections.set(t,new eP({dbname:this.name,collectionName:t,keyName:n,indexes:s,store:this._store})),[4,this._collections.get(t).init()];case 1:return i.sent(),[2]}})})}))];case 1:return n.sent(),[3,3];case 2:throw er.databaseSchemaNotOnUpgrade;case 3:return[2]}})})},e.prototype.open=function(){var e;return(0,i.b)(this,void 0,void 0,function(){var t,n,r,s,a=this;return(0,i.c)(this,function(o){var u;switch(o.label){case 0:return[4,this._globalMutex.lock()];case 1:if(o.sent(),this._state===eK.OPENED)return[3,15];this._state=eK.OPENING,o.label=2;case 2:return o.trys.push([2,5,,15]),[4,this._store.init(this.name)];case 3:return o.sent(),u=this.name,t="".concat(ew(u),".metadata"),n={version:0,collectionNames:[]},[4,this._store.get(t)];case 4:return r=null!==(e=o.sent())&&void 0!==e?e:n,[2,new Promise(function(e,n){var s=function(e){r.version<a._version?a._event.upgrade(r.version,function(n){return(0,i.b)(a,void 0,void 0,function(){return(0,i.c)(this,function(i){switch(i.label){case 0:if(n)return[3,5];r.version++,r.collectionNames=Array.from(this._collections.keys()),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._store.set({key:t,value:r,generation:this._version})];case 2:return i.sent(),e({continued:!0}),[3,4];case 3:return e({continued:!1,err:i.sent()}),[3,4];case 4:return[3,6];case 5:e({continued:!1,err:n}),i.label=6;case 6:return[2]}})})}):e({continued:!1})},o=function(t){var u=t.continued,c=t.err,l=void 0===c?null:c;if(void 0!==u&&u)setTimeout(10);else if(l)eY.error(l.message),a._globalMutex.unlock(),a._event.error(l),n(l);else{var h=[];r.collectionNames.forEach(function(e){a._collections.has(e)||h.push((0,i.b)(a,void 0,void 0,function(){var t,n;return(0,i.c)(this,function(r){switch(r.label){case 0:return[4,eP.metadataOf(this.name,e,this._store)];case 1:return(t=r.sent())?(n=new eP({dbname:this.name,collectionName:e,keyName:t.keyName,indexes:t.indexes,store:this._store}),this._collections.set(e,n),[4,n.init()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})}))}),Promise.all(h).then(function(){a._state=eK.OPENED,a._globalMutex.unlock(),a._event.success(),e()}).catch(function(e){eY.error(e.message),a._globalMutex.unlock(),a._event.error(e),n(e)})}};s(o)})];case 5:switch((s=o.sent()).code){case Q.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,6];case Q.STORE_NOT_AVAILABLE:return[3,8];case Q.STORE_ENCRYPTION_INVALID:return[3,10]}return[3,13];case 6:return eY.warning("Access to the local storage is not allowed in private browsing. Switched to MemoryStore automatically."),this._store=new eF({}),this._globalMutex.unlock(),this._event.error(s),[4,this.open()];case 7:case 9:case 12:return o.sent(),[3,14];case 8:return eY.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new eF({}),this._globalMutex.unlock(),this._event.error(s),[4,this.open()];case 10:return eY.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this._store.clear()];case 11:return o.sent(),this._globalMutex.unlock(),this._event.error(s),[4,this.open()];case 13:throw eY.error(s.message),this._globalMutex.unlock(),this._event.error(s),s;case 14:return[3,15];case 15:return[2]}})})},e.prototype.close=function(){this._collections.forEach(function(e){return e.close()}),this._state=eK.CLOSED},e.prototype.clear=function(){return(0,i.b)(this,void 0,void 0,function(){return(0,i.c)(this,function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._collections.values()).map()];case 1:return e.sent(),[2]}})})},e.prototype.reset=function(){return(0,i.b)(this,void 0,void 0,function(){var e,t=this;return(0,i.c)(this,function(n){switch(n.label){case 0:return this.close(),(e=eO.get(this.name))&&e.clearByCondition(,[4,this._store.clear()];case 1:return n.sent(),[2]}})})},e.prototype.on=e.prototype.off=function(e){"function"==typeof this._event[e]&&("upgrade"===e?this._event[e]=ep:this._event[e]=eh)},e.prototype.collection=e}()},60336:function(e,t,n){n.d(t,{xu:function(){return p.K},qB:function(){return w},lv:function(){return p.I},ZP:function(){return eM}});var r,i,s,a,o,u,c,l,h,d,f,p=n(35660),_=n(78424),m=n(18920),g=function(e){eturn(0,p._)(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,s=n.sessionManager,a=n.requestQueue,o=n.logger,u=n.onlineDetector,c=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:s,requestQueue:a,logger:o,onlineDetector:u,cacheContext:c}),this._manager=new m.b(t,{sdkState:r,dispatcher:i,sessionManager:s,requestQueue:a,logger:o,onlineDetector:u,cacheContext:c})},t.prototype.create=function(e){return(0,p.b)(this,void 0,void 0,function(){var t;return(0,p.c)(this,function(n){return t=(0,p.g)((0,p.g)({},m.c),e),(0,p.q)((0,m.v)(t)).throw(p.S.invalidParameters),[2,this._manager.create(t)]})})},t.prototype.get=function(e){return(0,p.b)(this,void 0,void 0,function(){var t;return(0,p.c)(this,function(n){return t=(0,p.g)((0,p.g)({},m.d),e),(0,p.q)((0,m.e)(t)).throw(p.S.invalidParameters),[2,this._manager.get(t)]})})},t.prototype.getOption=function(e){return(0,p.b)(this,void 0,void 0,function(){var t;return(0,p.c)(this,function(n){return t=(0,p.g)((0,p.g)({},m.f),e),(0,p.q)((0,m.g)(t)).throw(p.S.invalidParameters),[2,this._manager.getOption(t)]})})},t.prototype.buildPollFromSerializedData=t}(p.ai),v=n(8144),y=n(44996);n(71673);var b={profileImage:null,profileUrl:null,nickname:null},E=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e])}),n}return(0,p._)(t,e),t}(function(){this.onSessionExpired=p.n,this.onSessionTokenRequired=this.onSessionError=p.n,this.onSessionRefreshed=p.n,this.onSessionClosed=p.n}),w=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e])}),n}return(0,p._)(t,e),t}(,I=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach(,n}return(0,p._)(t,e),t}(,T=S=function(e){function t(t){var n=t.getVisibilityState,r=t.initialState,i=t.isEnabled,s=t.pauseCheckDelay,a=e.call(this)||this;return a._pauseCheckDelay=3e4,a._pauseDelayTimer=null,a._currentState="visible",a._getVisibilityState=void 0===n?T:n,a._pauseCheckDelay=void 0===s?3e4:s,a._currentState=void 0===r?"visible":r,a._isEnabled=void 0===i||i,a._boundToggleState=a._toggleState.bind(a),a}return(0,p._)(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAvailable",{get:enumerable:!1,configurable:!0}),t.prototype._toggleState=function(){var e=this,t=this._getVisibilityState();"hidden"!==t?"hidden"===this._currentState&&(this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=null),this.dispatch("resume")):"hidden"!==this._currentState&&(this._pauseDelayTimer=setTimeout(this._pauseCheckDelay)),this._currentState=t},t.prototype.start=function(){this._isEnabled&&this.isAvailable&&(this._boundToggleState=this._toggleState.bind(this),window.addEventListener("visibilitychange",this._boundToggleState,{capture:!0}))},t.prototype.stop=function(){this._isEnabled&&this.isAvailable&&this._boundToggleState&&window.removeEventListener("visibilitychange",this._boundToggleState,{capture:!0})},t}(p.E),A=function(){function e(e){var t=e.logger,n=e.connectionDelegate,r=void 0===n?null:n,i=this;this._onlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.reconnect()},this._offlineWorker=this.unsubscribes=[],this._onlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("online",e),function(){return window.removeEventListener("online",e,!1)}},this._offlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("offline",e),,this.logger=t,r&&(this.connectionDelegate=r)}return Object.defineProperty(e.prototype,"isAvailableOnWeb",{get:function(){return"undefined"!=typeof window&&window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&void 0!==navigator.onLine},enumerable:!1,configurable:!0}),e.prototype.setOnlineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._onlineListener=e)},e.prototype.setOfflineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._offlineListener=e)},e.prototype.start=function(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)]},e.prototype.stop=function(){var e=this;this.unsubscribes.forEach(function(t){try{null==t||t()}catch(t){e.logger.warn(t.message)}}),this.unsubscribes=[]},e.prototype.isOnline=function(){return(0,p.b)(this,void 0,void 0,function(){return(0,p.c)(this,function(e){return this.isAvailableOnWeb?[2,navigator.onLine]:[2,new Promise(function(e){fetch("https://www.google.com",{method:p.A.GET,mode:"no-cors"}).then(function(){return e(!0)}).catch(})]})})},e}(),N=function(e){function t(t){var n=t.userId,r=t.nickname,i=t.profileUrl,s=t.profileImage,a=t.preferredLanguages,o=e.call(this)||this;return o.method=p.A.PUT,o.path="".concat(p.d,"/").concat(encodeURIComponent(n)),o.params=(0,p.e)({nickname:void 0===r?null:r,profile_url:void 0===i?null:i,profile_file:void 0===s?null:s,preferred_languages:void 0===a?null:a}),o}return(0,p._)(t,e),t}(p.f),C=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.user=null,r.user=new p.U(t,(0,p.g)({},n)),r}return(0,p._)(t,e),t}(p.h),k=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=p.A.POST,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/apns"),i.params={apns_device_token:r,always_push:!0},i}return(0,p._)(t,e),t}(p.f);r=p.h,(0,p._)(function(e,t){var n=r.call(this,e,t)||this;return n.token=t.token,n.type=t.type?p.P[t.type.toLowerCase()]:p.P.UNKNOWN,n.user=new p.U(e,t.user),n},r);var O=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=p.A.POST,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/gcm"),i.params={gcm_reg_token:r,always_push:!0},i}return(0,p._)(t,e),t}(p.f);i=p.h,(0,p._)(function(e,t){var n=i.call(this,e,t)||this;return n.token=t.token,n.type=t.type?p.P[t.type.toLowerCase()]:p.P.UNKNOWN,n.user=new p.U(e,t.user),n},i);var R=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=p.A.DELETE,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/apns/").concat(encodeURIComponent(r)),i}return(0,p._)(t,e),t}(p.f);s=p.h,(0,p._)(function(e,t){var n=s.call(this,e,t)||this;return n.token=t.token,n.user=new p.U(e,t.user),n.lastDeletedAt=t.device_token_last_deleted_at,n},s);var D=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=p.A.DELETE,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/gcm/").concat(encodeURIComponent(r)),i}return(0,p._)(t,e),t}(p.f);a=p.h,(0,p._)(function(e,t){var n=a.call(this,e,t)||this;return n.token=t.token,n.user=new p.U(e,t.user),n.lastDeletedAt=t.device_token_last_deleted_at,n},a);var U=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=p.A.DELETE,r.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/apns"),r}return(0,p._)(t,e),t}(p.f);o=p.h,(0,p._)(function(e,t){var n=o.call(this,e,t)||this;return n.type=t.type?p.P[t.type.toLowerCase()]:p.P.UNKNOWN,n.user=new p.U(e,t.user),n.lastDeletedAt=t.device_token_last_deleted_at,n},o);var L=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=p.A.DELETE,r.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/gcm"),r}return(0,p._)(t,e),t}(p.f);u=p.h,(0,p._)(function(e,t){var n=u.call(this,e,t)||this;return n.type=t.type?p.P[t.type.toLowerCase()]:p.P.UNKNOWN,n.user=new p.U(e,t.user),n.lastDeletedAt=t.device_token_last_deleted_at,n},u);var M=function(e){function t(t){var n=t.userId,r=t.type,i=t.token,s=t.ts,a=e.call(this)||this;return a.method=p.A.GET,a.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/").concat(encodeURIComponent(r),"/device_tokens"),a.params={created_ts:s,token:i},a}return(0,p._)(t,e),t}(p.f),P=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTokens={type:n.type?p.P[n.type.toLowerCase()]:p.P.UNKNOWN,deviceTokens:n.device_tokens,hasMore:n.has_more,token:n.token},r}return(0,p._)(t,e),t}(p.h),x=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=p.A.GET,r.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),r}return(0,p._)(t,e),t}(p.f),q=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r}return(0,p._)(t,e),t}(p.h),F=function(e){function t(t){var n=t.userId,r=t.willAutoAccept,i=e.call(this)||this;return i.method=p.A.PUT,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),i.params={auto_accept:r},i}return(0,p._)(t,e),t}(p.f),V=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r}return(0,p._)(t,e),t}(p.h),z=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=p.A.GET,r.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push_preference"),r}return(0,p._)(t,e),t}(p.f),G=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r}return(0,p._)(t,e),t}(p.h),H=function(e){function t(t){var n=t.userId,r=t.doNotDisturbOn,i=t.startHour,s=t.startMin,a=t.endHour,o=t.endMin,u=t.timezone,c=e.call(this)||this;return c.method=p.A.PUT,c.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push_preference"),c.params={do_not_disturb:r,start_hour:i,start_min:s,end_hour:a,end_min:o,timezone:u},c}return(0,p._)(t,e),t}(p.f),B=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r}return(0,p._)(t,e),t}(p.h),j=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=p.A.GET,r.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push_preference"),r}return(0,p._)(t,e),t}(p.f),K=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r}return(0,p._)(t,e),t}(p.h),Q=function(e){function t(t){var n=t.userId,r=t.snoozeOn,i=t.startTs,s=t.endTs,a=e.call(this)||this;return a.method=p.A.PUT,a.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push_preference"),a.params={snooze_enabled:r,snooze_start_ts:i,snooze_end_ts:s},a}return(0,p._)(t,e),t}(p.f),W=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r}return(0,p._)(t,e),t}(p.h),Y=function(e){function t(t){var n=t.userId,r=t.blockedUserId,i=e.call(this)||this;return i.method=p.A.POST,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/block"),i.params={target_id:r},i}return(0,p._)(t,e),t}(p.f);c=p.h,(0,p._)(function(e,t){var n=c.call(this,e,t)||this;return n.user=new p.U(e,t),n},c);var Z=function(e){function t(t){var n=t.userId,r=t.unblockedUserId,i=e.call(this)||this;return i.method=p.A.DELETE,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/block/").concat(encodeURIComponent(r)),i}return(0,p._)(t,e),t}(p.f);l=p.h,(0,p._)(function(){return null!==l&&l.apply(this,arguments)||this},l);var X=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=p.A.GET,r.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push_preference"),r}return(0,p._)(t,e),t}(p.f),J=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r}return(0,p._)(t,e),t}(p.h),$=function(e){function t(t){var n=t.userId,r=t.pushTriggerOption,i=e.call(this)||this;return i.method=p.A.PUT,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push_preference"),i.params={push_trigger_option:r},i}return(0,p._)(t,e),t}(p.f),ee=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r}return(0,p._)(t,e),t}(p.h),et=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=p.A.GET,r.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/template"),r}return(0,p._)(t,e),t}(p.f),en=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r}return(0,p._)(t,e),t}(p.h),er=function(e){function t(t){var n=t.userId,r=t.templateName,i=e.call(this)||this;return i.method=p.A.PUT,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/push/template"),i.params={name:r},i}return(0,p._)(t,e),t}(p.f),ei=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r}return(0,p._)(t,e),t}(p.h),es=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=p.A.GET,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/friends/changelogs"),i.params={token:r},i}return(0,p._)(t,e),t}(p.f),ea=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.changelogs={addedUsers:n.added.map(function(e){return new p.U(t,e)}),updatedUsers:n.updated.map(function(e){return new p.U(t,e)}),deletedUserIds:n.deleted,hasMore:n.has_more,token:n.next},r}return(0,p._)(t,e),t}(p.h),eo=function(e){function t(t){var n=t.userId,r=t.discoveries,i=e.call(this)||this;return i.method=p.A.PUT,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/friend_discoveries"),i.params={friend_discoveries:r.map(},i}return(0,p._)(t,e),t}(p.f),eu=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.friendDiscoveryRequestId=n.friend_discovery_request_id,r}return(0,p._)(t,e),t}(p.h),ec=function(e){function t(t){var n=t.userId,r=t.discoveryKeys,i=e.call(this)||this;return i.method=p.A.DELETE,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/friend_discoveries"),i.params={friend_discovery_keys:r},i}return(0,p._)(t,e),t}(p.f);h=p.h,(0,p._)(function(){return null!==h&&h.apply(this,arguments)||this},h);var el=function(e){function t(t){var n=t.userId,r=t.userIds,i=e.call(this)||this;return i.method=p.A.POST,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/friends"),i.params={user_ids:r},i}return(0,p._)(t,e),t}(p.f),eh=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map(function(e){return new p.U(t,e)}),r}return(0,p._)(t,e),t}(p.h),ed=function(e){function t(t){var n=t.userId,r=t.userIds,i=e.call(this)||this;return i.method=p.A.DELETE,i.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/friends"),i.params={user_ids:r},i}return(0,p._)(t,e),t}(p.f);d=p.h,(0,p._)(function(){return null!==d&&d.apply(this,arguments)||this},d);var ef=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=p.A.GET,r.path="".concat(p.d,"/").concat(n,"/allow_friend_discovery"),r.params={},r}return(0,p._)(t,e),t}(p.f),ep=function(e){eturn(0,p._)(t,e),t}(p.h),e_=function(e){function t(t){var n=t.userId,r=t.allowFriendDiscovery,i=e.call(this)||this;return i.method=p.A.PUT,i.path="".concat(p.d,"/").concat(n,"/allow_friend_discovery"),i.params={allow_friend_discovery:r},i}return(0,p._)(t,e),t}(p.f);f=p.h,(0,p._)(f);var em=function(e){this.key=null,this.url=null,this.key=e.key,this.url=e.url},eg=function(e){var t,n,r;this.id=0,this.name=null,this.url=null,this.emojis=[],this.id=null!==(t=e.id)&&void 0!==t?t:0,this.name=null!==(n=e.name)&&void 0!==n?n:"",this.url=null!==(r=e.url)&&void 0!==r?r:"",this.emojis=e.emojis?e.emojis.map(function(e){return new em(e)}):[]},ev=function(e){this.emojiHash=null,this.emojiCategories=[],this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map(:[]},ey=function(e){function t(){var t=e.call(this)||this;return t.method=p.A.GET,t.path=p.j,t}return(0,p._)(t,e),t}(p.f),eb=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiContainer=new ev(n),r}return(0,p._)(t,e),t}(p.h),eE=function(e){function t(t){var n=t.categoryId,r=e.call(this)||this;return r.method=p.A.GET,r.path="".concat(p.j,"/").concat(n),r}return(0,p._)(t,e),t}(p.f),ew=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiCategory=new eg(n),r}return(0,p._)(t,e),t}(p.h),eI=function(e){function t(t){var n=t.key,r=e.call(this)||this;return r.method=p.A.GET,r.path="".concat(p.k,"/").concat(n),r}return(0,p._)(t,e),t}(p.f),eT=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emoji=new em(n),r}return(0,p._)(t,e),t}(p.h),eS=function(e){function t(t){var n=t.limit,r=t.token,i=t.userIdsFilter,s=t.metaDataKeyFilter,a=t.metaDataValuesFilter,o=t.nicknameStartsWithFilter,u=e.call(this)||this;return u.method=p.A.GET,u.path=p.d,u.params=(0,p.e)({limit:n,token:r,user_ids:i,metadatakey:s,metadatavalues_in:a,nickname_startswith:o}),u}return(0,p._)(t,e),t}(p.f),eA=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map(function(e){return new p.U(t,e)}),r.next=n.next,r}return(0,p._)(t,e),t}(p.h),eN=function(e){function t(t,n){var r,i,s,a=this;return(a=e.call(this,t,n)||this).userIdsFilter=null,a.metaDataKeyFilter=null,a.metaDataValuesFilter=null,a.nicknameStartsWithFilter=null,a.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,a.metaDataKeyFilter=null!==(i=n.metaDataKeyFilter)&&void 0!==i?i:null,a.metaDataValuesFilter=null!==(s=n.metaDataValuesFilter)&&void 0!==s?s:null,a.nicknameStartsWithFilter=n.nicknameStartsWithFilter||null,a}return(0,p._)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,p.l)("string",this.userIdsFilter,!0)&&(0,p.a)("string",this.metaDataKeyFilter,!0)&&(0,p.l)("string",this.metaDataValuesFilter,!0)&&(0,p.a)("string",this.metaDataKeyFilter,!0)},t.prototype.next=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=p.V.of(this._iid).requestQueue,t=new eS((0,p.g)((0,p.g)({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return r=(n=s.sent().as(eA)).users,i=n.next,this._token=i,this._hasNext=!!i,this._isLoading=!1,[2,r];case 2:return[2,[]];case 3:throw p.S.queryInProgress;case 4:return[3,6];case 5:throw p.S.invalidParameters;case 6:return[2]}})})},t}(p.B),eC=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,s=t.userIdsFilter,a=e.call(this)||this;return a.method=p.A.GET,a.path="".concat(p.d,"/").concat(n,"/block"),a.params=(0,p.e)({limit:r,token:i,user_ids:s}),a}return(0,p._)(t,e),t}(p.f),ek=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map(function(e){return new p.U(t,e)}),r.next=n.next,r}return(0,p._)(t,e),t}(p.h),eO=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).userIdsFilter=null,i.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,i}return(0,p._)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,p.l)("string",this.userIdsFilter,!0)},t.prototype.next=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r,i,s,a;return(0,p.c)(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=(e=p.V.of(this._iid)).sdkState,n=e.requestQueue,r=new eC((0,p.g)((0,p.g)({},this),{userId:t.userId,token:this._token})),[4,n.send(r)]):[3,2]:[3,5];case 1:return s=(i=o.sent().as(ek)).users,a=i.next,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw p.S.queryInProgress;case 4:return[3,6];case 5:throw p.S.invalidParameters;case 6:return[2]}})})},t}(p.B),eR=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,s=e.call(this)||this;return s.method=p.A.GET,s.path="".concat(p.d,"/").concat(encodeURIComponent(n),"/friends"),s.params={limit:r,token:i},s}return(0,p._)(t,e),t}(p.f),eD=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.hasMore=n.has_more,r.users=n.users.map(,r.next=n.next,r}return(0,p._)(t,e),t}(p.h),eU=function(e){eturn(0,p._)(t,e),t.prototype._validate=t.prototype.next=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r,i,s,a,o;return(0,p.c)(this,function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=(e=p.V.of(this._iid)).sdkState,n=e.requestQueue,r=new eR((0,p.g)((0,p.g)({},this),{userId:t.userId,token:this._token})),[4,n.send(r)]):[3,2]:[3,5];case 1:return s=(i=u.sent().as(eD)).users,a=i.hasMore,o=i.next,this._token=o,this._hasNext=a,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw p.S.queryInProgress;case 4:return[3,6];case 5:throw p.S.invalidParameters;case 6:return[2]}})})},t}(p.B),eL=null,eM=function(){function e(e,t,n){var r=this;this._fcmPushToken=null,this._apnsPushToken=null,this._iid=e,this.options=t;var i=p.V.of(e),s=i.sdkState,a=i.cacheContext,o=i.dispatcher,u=i.sessionManager,c=i.requestQueue,l=i.logger,h=i.userEventHandlers,d=i.appStateToggleEnabled;this._onlineDetector=new A({logger:l,connectionDelegate:{reconnect:function(){var t=p.V.of(e),n=t.sdkState,r=t.connectionManager,i=t.sessionManager;i.auth.hasSession?"foreground"===n.appState&&r.resetAndReconnect():r.connect(i.auth.authToken)},disconnect:function(){p.V.of(e).connectionManager.disconnect()}}});var f=new y.d(e,{localCacheEnabled:a.localCacheEnabled,dispatcher:o,sdkState:s,logger:l});n.forEach(function(t){t.init(e,{sdkState:s,cacheContext:a,dispatcher:o,sessionManager:u,requestQueue:c,logger:l,onlineDetector:r._onlineDetector}),r[t.name]=t}),this._appStateChangeDetector=new S({isEnabled:d}),this._appStateChangeDetector.on("resume",function(){l.debug("the page resumes from freeze"),r.setForegroundState()}).on("pause",,o.on(function(t){if(t instanceof p.s)t.stateType===p.t.CONNECTED&&f.processNonAutoResendRegisteredPendingMessages();else if(t instanceof p.W){if("USEV"===t.code){var n=t.as(y.U).event;if(n.category===y.e.FRIEND_DISCOVERED){var i=y.f.getDataAsFriendDiscoveredEvent(e,n).friendDiscoveries;(0,p.w)(function(){return(0,p.b)(r,void 0,void 0,function(){return(0,p.c)(this,function(e){return[2,h.forEach(]})})})}}}else if(t instanceof p.x){var o=p.V.of(r._iid).subscribedUnreadMessageCount,u=!1,c=t.ts;if("number"==typeof c&&c>o.ts){if(o.all!==t.all&&(u=!0),o.all=t.all>=0?t.all:0,t.customTypes)for(var l in t.customTypes)o.customTypes[l]!==t.customTypes[l]&&(u=!0),o.customTypes[l]=t.customTypes[l];u=u&&o.ts>0,o.ts=c}u&&(0,p.w)(function(){return(0,p.b)(r,void 0,void 0,function(){return(0,p.c)(this,function(e){return[2,h.forEach(]})})})}else t instanceof p.y&&a.localCacheEnabled&&a.preference.set(r._getUserProfileCacheKey(s.userId),p.z.payloadify(t.userProfile))})}return e.init=function(t){var n=t.appId,r=t.appVersion,i=t.modules,s=t.options,a=void 0===s?new p.m:s,o=t.debugMode,u=void 0!==o&&o,c=t.customApiHost,l=t.customWebSocketHost,h=t.newInstance,d=t.logLevel,f=t.localCacheEnabled,m=t.localCacheConfig,v=void 0===m?new p.L:m,b=t.localCacheEncryption,E=t.useAsyncStorageStore,w=void 0===E?null:E,I=t.appStateToggleEnabled;if(!eL||void 0!==h&&h){var T="su-".concat((0,p.u)()),S=null!=b?b:{encrypt:function(e){return e},decrypt:,A=new y.c({encryption:S});u||(A=w?new y.A({AsyncStorage:w,encryption:S}):new y.I({encryption:S})),new p.V(T,{appId:n,appVersion:void 0===r?null:r,options:a,apiHost:null!=c?c:"https://api-".concat(n,".sendbird.com"),websocketHost:null!=l?l:"wss://ws-".concat(n,".sendbird.com"),store:A,encryption:S,logLevel:d,localCacheEnabled:void 0!==f&&f,localCacheConfig:v,debugMode:u,appStateToggleEnabled:void 0===I||I});var N=[new _.M,new g],C=new e(T,a,(0,p.o)((0,p.o)([],(0,p.p)(void 0===i?[]:i),!1),(0,p.p)(N),!1));return eL||(eL=C),C}return eL},Object.defineProperty(e,"instance",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e,"version",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appId",{get:function(){return p.V.of(this._iid).sdkState.appId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfo",{get:function(){return p.V.of(this._iid).appInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appVersion",{get:function(){var e;return null!==(e=p.V.of(this._iid).sdkState.appVersion)&&void 0!==e?e:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugMode",{get:enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logLevel",{get:function(){return p.V.of(this._iid).logger.level},set:function(e){p.V.of(this._iid).logger.level=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCacheEnabled",{get:function(){return p.V.of(this._iid).cacheContext.localCacheEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCacheConfig",{get:function(){var e=p.V.of(this._iid).cacheContext;return e.localCacheEnabled?e.localCacheConfig:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ekey",{get:function(){return p.V.of(this._iid).sessionManager.ekey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentUser",{get:function(){var e;return null!==(e=p.V.of(this._iid).sessionManager.currentUser)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionState",{get:function(){var e=p.V.of(this._iid).connectionManager;return e.isConnected?p.C.OPEN:e.isConnecting?p.C.CONNECTING:p.C.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastConnectedAt",{get:function(){var e=p.V.of(this._iid),t=e.connectedAt;return e.connectionManager.isConnected?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fcmPushToken",{get:function(){return this._fcmPushToken},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apnsPushToken",{get:enumerable:!1,configurable:!0}),e.prototype._getPreferenceCacheKey=function(e){return"sendbird@".concat(this.appId,"/").concat(e,".pref")},e.prototype._getUserProfileCacheKey=e.prototype.getMemoryStoreForDebugging=function(){var e=p.V.of(this._iid),t=e.debugMode,n=e.cacheContext;if(t)return n.store instanceof y.c?n.store:null;throw p.S.debugModeRequired},e.prototype.addExtension=function(e,t){var n=p.V.of(this._iid).sdkState;["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(e)>-1&&(n.extensions[e]=t)},e.prototype.setOnlineListener=function(e){this._onlineDetector.setOnlineListener(e)},e.prototype.setOfflineListener=e.prototype.initializeCache=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i,s,a,o,u,c;return(0,p.c)(this,function(l){switch(l.label){case 0:return n=(t=p.V.of(this._iid)).sdkState,r=t.cacheContext,i=t.connectionManager,s=t.dispatcher,a=t.logger,n.userId&&n.userId===e?[3,12]:[4,i.logout()];case 1:if(l.sent(),n.userId=e,o="sendbird@".concat(n.appId,"/").concat(e,".db"),!r.localCacheEnabled)return[3,8];l.label=2;case 2:var h;return l.trys.push([2,5,,7]),r.nestdb&&r.nestdb.state!==y.k.CLOSED&&r.nestdb.name===o?[3,4]:((u=r.nestdb=new y.h({name:"sendbird@".concat(n.appId,"/").concat(e,".db"),version:2,store:r.store})).on("upgrade",(h=r.store,function(e,t){1===e?u.clear().then(function(){h.clear().then(function(){(0,p.b)(void 0,void 0,void 0,function(){return(0,p.c)(this,function(e){return[2,u.commitSchema([{collectionName:v.N,keyName:v.a,index:[(0,y.g)(y.G.LATEST_LAST_MESSAGE),(0,y.g)(y.G.CHRONOLOGICAL),(0,y.g)(y.G.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:v.b,keyName:v.c,index:[(0,y.a)(y.M.CHANNEL_LATEST),(0,y.a)(y.M.NEWEST_CHILD_MESSAGE)]},{collectionName:y.N,keyName:y.b,index:[(0,y.a)(y.M.CHANNEL_LATEST),(0,y.a)(y.M.NEWEST_CHILD_MESSAGE)]},{collectionName:v.d,keyName:v.e}])]})}).then(.catch(function(e){return t(e)})}).catch(function(e){return t(e)})}).catch(:t()})),[4,u.open()]);case 3:l.sent(),s.dispatch(new y.D(this._iid,{userId:e})),l.label=4;case 4:return[3,7];case 5:return c=l.sent(),[4,r.store.init(o)];case 6:throw l.sent(),a.warn("Nest DB Open Failed. ",c),p.S.databaseError;case 7:return[3,12];case 8:return l.trys.push([8,10,,12]),[4,r.store.init(o)];case 9:case 11:return l.sent(),[3,12];case 10:return l.sent(),r.store=new y.c,[4,this.initializeCache(e)];case 12:return[2]}})})},e.prototype.getCacheDataSize=function(){return(0,p.b)(this,void 0,void 0,function(){var e;return(0,p.c)(this,function(t){switch(t.label){case 0:return(e=p.V.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.estimateUsage()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,0]}})})},e.prototype.clearCachedData=function(){return(0,p.b)(this,void 0,void 0,function(){var e;return(0,p.c)(this,function(t){switch(t.label){case 0:return(e=p.V.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,e.preference.clear()];case 3:return t.sent(),[2]}})})},e.prototype.clearCachedMessages=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r=this;return(0,p.c)(this,function(i){switch(i.label){case 0:return(0,p.q)((0,p.l)("string",e)).throw(p.S.invalidParameters),t=y.i.of(this._iid),n=y.j.of(this._iid),t&&n?[4,Promise.all(e.map(function(e){return(0,p.b)(r,void 0,void 0,function(){return(0,p.c)(this,function(r){switch(r.label){case 0:return[4,t.removeMessagesOfChannel(e)];case 1:return r.sent(),[4,n.removeMessagesOfChannel(e)];case 2:return r.sent(),[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},e.prototype.connect=function(e,t){return void 0===t&&(t=null),(0,p.b)(this,void 0,void 0,function(){var n,r,i,s,a,o,u;return(0,p.c)(this,function(c){switch(c.label){case 0:(0,p.q)((0,p.a)("string",e)&&(0,p.a)("string",t,!0)).throw(p.S.invalidParameters),r=(n=p.V.of(this._iid)).sdkState,i=n.cacheContext,s=n.connectionManager,a=n.statLogCollector,this._onlineDetector.start(),this._appStateChangeDetector.start(),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.initializeCache(e)];case 2:return c.sent(),p.V.of(this._iid).dispatcher.dispatch(new y.R),[3,4];case 3:return c.sent(),o=p.V.of(this._iid).logger,i.localCacheEnabled=!1,o.warn("Cache initialization failed - cache is not available."),[3,4];case 4:return[4,i.preference.init(this._getPreferenceCacheKey(e))];case 5:return c.sent(),[4,i.preference.get(this._getUserProfileCacheKey(e))];case 6:return(u=c.sent())&&new p.z(this._iid,u).apply(),[4,a.init("sendbird@".concat(r.appId,"/").concat(e,".statlog"))];case 7:return c.sent(),[4,s.connect(t)];case 8:return c.sent(),[2,this.currentUser]}})})},e.prototype.reconnect=function(){var e=p.V.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.sessionManager.auth.hasSession;return r&&(this._appStateChangeDetector.start(),this._onlineDetector.start(),t.resetAndReconnect().then(.catch(),r},e.prototype.disconnect=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n;return(0,p.c)(this,function(r){switch(r.label){case 0:return t=(e=p.V.of(this._iid)).connectionManager,n=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),[4,t.logout()];case 1:return r.sent(),[4,this.clearCachedData()];case 2:return r.sent(),[2]}})})},e.prototype.disconnectWebSocket=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n;return(0,p.c)(this,function(r){switch(r.label){case 0:return t=(e=p.V.of(this._iid)).connectionManager,n=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),[4,t.disconnectWebSocket()];case 1:return r.sent(),[2]}})})},e.prototype.setBackgroundState=function(){var e=p.V.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.logger;"foreground"===n.appState&&(n.appState="background",r.debug("going background state"),t.background())},e.prototype.setForegroundState=function(){var e=p.V.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.logger;"background"===n.appState&&(n.appState="foreground",r.debug("going foreground state"),t.resetAndReconnect())},e.prototype.setSessionHandler=function(e){(0,p.q)(e instanceof E).throw(p.S.invalidParameters),p.V.of(this._iid).sessionManager.handler=e},e.prototype.addUserEventHandler=function(e,t){(0,p.q)((0,p.a)("string",e)&&t instanceof I).throw(p.S.invalidParameters),p.V.of(this._iid).userEventHandlers.set(e,t)},e.prototype.removeUserEventHandler=function(e){p.V.of(this._iid).userEventHandlers.delete(e)},e.prototype.removeAllUserEventHandler=function(){p.V.of(this._iid).userEventHandlers.clear()},e.prototype.addConnectionHandler=function(e,t){(0,p.q)((0,p.a)("string",e)&&t instanceof w).throw(p.S.invalidParameters),p.V.of(this._iid).connectionHandlers.set(e,t)},e.prototype.removeConnectionHandler=function(e){p.V.of(this._iid).connectionHandlers.delete(e)},e.prototype.removeAllConnectionHandler=function(){p.V.of(this._iid).connectionHandlers.clear()},e.prototype.createApplicationUserListQuery=function(e){return void 0===e&&(e={}),new eN(this._iid,e)},e.prototype.createBlockedUserListQuery=function(e){return void 0===e&&(e={}),new eO(this._iid,e)},e.prototype.createFriendListQuery=function(e){return void 0===e&&(e={}),new eU(this._iid,e)},e.prototype.createMessageSearchQuery=e.prototype.createPollListQuery=function(e){return new m.P(this._iid,(0,p.g)({},e))},e.prototype.createPollVoterListQuery=function(e){return new m.a(this._iid,(0,p.g)({},e))},e.prototype.buildUserFromSerializedData=function(e){var t=(0,p.r)(e);return new p.U(this._iid,p.U.payloadify(t))},e.prototype.updateCurrentUserInfo=function(e){return void 0===e&&(e={}),(0,p.b)(this,void 0,void 0,function(){var t,n,r,i,s,a;return(0,p.c)(this,function(o){switch(o.label){case 0:var u;return t=(0,p.g)((0,p.g)({},b),e),(0,p.q)((u=t,(0,p.i)(u.profileImage,!0)&&(0,p.a)("string",u.profileUrl,!0)&&(0,p.a)("string",u.nickname,!0))).throw(p.S.invalidParameters),this.currentUser?(r=(n=p.V.of(this._iid)).sdkState,i=n.requestQueue,s=new N((0,p.g)({userId:r.userId},t)),[4,i.send(s)]):[3,2];case 1:return a=o.sent().as(C).user,this.currentUser&&(t.nickname&&(this.currentUser.nickname=a.nickname),(t.profileUrl||t.profileImage)&&(this.currentUser.plainProfileUrl=a.profileUrl)),[2,a];case 2:throw p.S.connectionRequired}})})},e.prototype.updateCurrentUserInfoWithPreferredLanguages=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i,s;return(0,p.c)(this,function(a){switch(a.label){case 0:return(0,p.q)((0,p.l)("string",e)).throw(p.S.invalidParameters),this.currentUser?(n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new N({userId:n.userId,preferredLanguages:e}),[4,r.send(i)]):[3,2];case 1:return s=a.sent().as(C).user,this.currentUser&&(this.currentUser.preferredLanguages=s.preferredLanguages),[2,s];case 2:throw p.S.connectionRequired}})})},e.prototype.registerFCMPushTokenForCurrentUser=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i,s,a=this;return(0,p.c)(this,function(o){switch(o.label){case 0:if((0,p.q)((0,p.a)("string",e)).throw(p.S.invalidParameters),!this.currentUser)return[3,6];o.label=1;case 1:return o.trys.push([1,4,,5]),n=(t=p.V.of(this._iid)).sessionManager,r=t.sdkState,i=t.requestQueue,n.hasDeviceToken(p.P.FCM,e)?[2,p.D.SUCCESS]:(s=new O({userId:r.userId,token:e}),[4,i.send(s)]);case 2:return o.sent(),[4,(0,p.F)(function(){return(0,p.b)(a,void 0,void 0,function(){return(0,p.c)(this,function(t){switch(t.label){case 0:return n.setDeviceToken(p.P.FCM,e),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}})})})];case 3:return o.sent(),this._fcmPushToken="",[2,p.D.SUCCESS];case 4:return o.sent(),[2,p.D.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=e,[2,p.D.PENDING];case 7:return[2]}})})},e.prototype.unregisterFCMPushTokenForCurrentUser=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i,s,a,o=this;return(0,p.c)(this,function(u){switch(u.label){case 0:if((0,p.q)((0,p.a)("string",e)).throw(p.S.invalidParameters),!this.currentUser)return[3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),n=(t=p.V.of(this._iid)).sessionManager,r=t.sdkState,i=t.requestQueue,s=new D({userId:r.userId,token:e}),[4,i.send(s)];case 2:return a=u.sent().lastDeletedAt,[4,(0,p.F)(function(){return(0,p.b)(o,void 0,void 0,function(){return(0,p.c)(this,function(t){switch(t.label){case 0:return n.unsetDeviceToken(p.P.FCM,e),n.setDeviceTokenDeletedAt(a),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}})})})];case 3:return u.sent(),this._fcmPushToken="",[2,p.D.SUCCESS];case 4:return u.sent(),[2,p.D.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=e,[2,p.D.PENDING];case 7:return[2]}})})},e.prototype.unregisterFCMPushTokenAllForCurrentUser=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r,i,s,a=this;return(0,p.c)(this,function(o){switch(o.label){case 0:return this.currentUser?(t=(e=p.V.of(this._iid)).sessionManager,n=e.sdkState,r=e.requestQueue,i=new L({userId:n.userId}),[4,r.send(i)]):[3,3];case 1:return s=o.sent().lastDeletedAt,[4,(0,p.F)(function(){return(0,p.b)(a,void 0,void 0,function(){return(0,p.c)(this,function(e){switch(e.label){case 0:return t.unsetDeviceTokens(p.P.FCM),t.setDeviceTokenDeletedAt(s),[4,t.saveDeviceToken()];case 1:return e.sent(),[2]}})})})];case 2:o.sent(),o.label=3;case 3:return[2]}})})},e.prototype.registerAPNSPushTokenForCurrentUser=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i,s,a=this;return(0,p.c)(this,function(o){switch(o.label){case 0:if((0,p.q)((0,p.a)("string",e)).throw(p.S.invalidParameters),!this.currentUser)return[3,6];o.label=1;case 1:return o.trys.push([1,4,,5]),n=(t=p.V.of(this._iid)).sessionManager,r=t.sdkState,i=t.requestQueue,n.hasDeviceToken(p.P.APNS,e)?[2,p.D.SUCCESS]:(s=new k({userId:r.userId,token:e}),[4,i.send(s)]);case 2:return o.sent(),[4,(0,p.F)(function(){return(0,p.b)(a,void 0,void 0,function(){return(0,p.c)(this,function(t){switch(t.label){case 0:return n.setDeviceToken(p.P.APNS,e),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}})})})];case 3:return o.sent(),this._apnsPushToken="",[2,p.D.SUCCESS];case 4:return o.sent(),[2,p.D.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=e,[2,p.D.PENDING];case 7:return[2]}})})},e.prototype.unregisterAPNSPushTokenForCurrentUser=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i,s,a,o=this;return(0,p.c)(this,function(u){switch(u.label){case 0:if((0,p.q)((0,p.a)("string",e)).throw(p.S.invalidParameters),!this.currentUser)return[3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),n=(t=p.V.of(this._iid)).sessionManager,r=t.sdkState,i=t.requestQueue,s=new R({userId:r.userId,token:e}),[4,i.send(s)];case 2:return a=u.sent().lastDeletedAt,[4,(0,p.F)(function(){return(0,p.b)(o,void 0,void 0,function(){return(0,p.c)(this,function(t){switch(t.label){case 0:return n.unsetDeviceToken(p.P.APNS,e),n.setDeviceTokenDeletedAt(a),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}})})})];case 3:return u.sent(),this._apnsPushToken="",[2,p.D.SUCCESS];case 4:return u.sent(),[2,p.D.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=e,[2,p.D.PENDING];case 7:return[2]}})})},e.prototype.unregisterAPNSPushTokenAllForCurrentUser=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r,i,s,a=this;return(0,p.c)(this,function(o){switch(o.label){case 0:return this.currentUser?(t=(e=p.V.of(this._iid)).sessionManager,n=e.sdkState,r=e.requestQueue,i=new U({userId:n.userId}),[4,r.send(i)]):[3,3];case 1:return s=o.sent().lastDeletedAt,[4,(0,p.F)(function(){return(0,p.b)(a,void 0,void 0,function(){return(0,p.c)(this,function(e){switch(e.label){case 0:return t.unsetDeviceTokens(p.P.APNS),t.setDeviceTokenDeletedAt(s),[4,t.saveDeviceToken()];case 1:return e.sent(),[2]}})})})];case 2:o.sent(),o.label=3;case 3:return[2]}})})},e.prototype.getChannelInvitationPreference=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r;return(0,p.c)(this,function(i){switch(i.label){case 0:return t=(e=p.V.of(this._iid)).sdkState,n=e.requestQueue,r=new x({userId:t.userId}),[4,n.send(r)];case 1:return[2,{autoAccept:i.sent().as(q).autoAccept}]}})})},e.prototype.setChannelInvitationPreference=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)((0,p.a)("boolean",e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new F({userId:n.userId,willAutoAccept:e}),[4,r.send(i)];case 1:return[2,{autoAccept:s.sent().as(V).autoAccept}]}})})},e.prototype.getDoNotDisturb=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r;return(0,p.c)(this,function(i){switch(i.label){case 0:return t=(e=p.V.of(this._iid)).sdkState,n=e.requestQueue,r=new z({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(G).preference]}})})},e.prototype.setDoNotDisturb=function(e,t,n,r,i,s){return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===s&&(s=""),(0,p.b)(this,void 0,void 0,function(){var a,o,u,c;return(0,p.c)(this,function(l){switch(l.label){case 0:return(0,p.q)((0,p.a)("boolean",e)&&(0,p.a)("number",t)&&(0,p.a)("number",n)&&(0,p.a)("number",r)&&(0,p.a)("number",i)&&(0,p.a)("string",s)).throw(p.S.invalidParameters),o=(a=p.V.of(this._iid)).sdkState,u=a.requestQueue,c=new H({userId:o.userId,doNotDisturbOn:e,startHour:t,startMin:n,endHour:r,endMin:i,timezone:s}),[4,u.send(c)];case 1:return[2,l.sent().as(B).preference]}})})},e.prototype.getSnoozePeriod=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r;return(0,p.c)(this,function(i){switch(i.label){case 0:return t=(e=p.V.of(this._iid)).sdkState,n=e.requestQueue,r=new j({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(K).snoozePeriod]}})})},e.prototype.setSnoozePeriod=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),(0,p.b)(this,void 0,void 0,function(){var r,i,s,a;return(0,p.c)(this,function(o){switch(o.label){case 0:return(0,p.q)((0,p.a)("boolean",e)&&(0,p.a)("number",t)&&(0,p.a)("number",n)).throw(p.S.invalidParameters),i=(r=p.V.of(this._iid)).sdkState,s=r.requestQueue,a=new Q({userId:i.userId,snoozeOn:e,startTs:t,endTs:n}),[4,s.send(a)];case 1:return[2,o.sent().as(W).snoozePeriod]}})})},e.prototype.getMyPushTokensByToken=function(e,t){return(0,p.b)(this,void 0,void 0,function(){var n,r,i,s,a,o,u,c,l,h,d;return(0,p.c)(this,function(f){switch(f.label){case 0:return(0,p.q)((0,p.a)("string",e)&&(0,p.H)(p.P,t)).throw(p.S.invalidParameters),r=(n=p.V.of(this._iid)).sdkState,i=n.requestQueue,s=n.sessionManager,a=new M({userId:r.userId,type:t,token:e}),[4,i.send(a)];case 1:o=f.sent().as(P).pushTokens;try{for(c=(u=(0,p.G)(o.deviceTokens)).next();!c.done;c=u.next())l=c.value,s.setDeviceToken(o.type,l)}catch(e){h={error:e}}finally{try{c&&!c.done&&(d=u.return)&&d.call(u)}finally{if(h)throw h.error}}return[4,s.saveDeviceToken()];case 2:return f.sent(),[2,o]}})})},e.prototype.getPushTriggerOption=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r;return(0,p.c)(this,function(i){switch(i.label){case 0:return t=(e=p.V.of(this._iid)).sdkState,n=e.requestQueue,r=new X({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(J).pushTriggerOption]}})})},e.prototype.setPushTriggerOption=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)((0,p.H)(p.I,e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new $({userId:n.userId,pushTriggerOption:e}),[4,r.send(i)];case 1:return[2,s.sent().as(ee).pushTriggerOption]}})})},e.prototype.getPushTemplate=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r;return(0,p.c)(this,function(i){switch(i.label){case 0:return t=(e=p.V.of(this._iid)).sdkState,n=e.requestQueue,r=new et({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(en).name]}})})},e.prototype.setPushTemplate=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)((0,p.H)(p.J,e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new er({userId:n.userId,templateName:e}),[4,r.send(i)];case 1:return[2,s.sent().as(ei).name]}})})},e.prototype.blockUser=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)(e instanceof p.U||(0,p.a)("string",e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new Y({userId:n.userId,blockedUserId:e instanceof p.U?e.userId:e}),[4,r.send(i)];case 1:return s.sent(),[2]}})})},e.prototype.blockUserWithUserId=function(e){return(0,p.b)(this,void 0,void 0,function(){return(0,p.c)(this,function(t){return[2,this.blockUser(e)]})})},e.prototype.unblockUser=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)(e instanceof p.U||(0,p.a)("string",e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new Z({userId:n.userId,unblockedUserId:e instanceof p.U?e.userId:e}),[4,r.send(i)];case 1:return s.sent(),[2]}})})},e.prototype.unblockUserWithUserId=function(e){return(0,p.b)(this,void 0,void 0,},e.prototype.getFriendChangeLogsByToken=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)((0,p.a)("string",e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new es({userId:n.userId,token:e}),[4,r.send(i)];case 1:return[2,s.sent().as(ea).changelogs]}})})},e.prototype.getAllowFriendDiscovery=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t,n,r;return(0,p.c)(this,function(i){switch(i.label){case 0:return t=(e=p.V.of(this._iid)).sdkState,n=e.requestQueue,r=new ef({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(ep).allowFriendDiscovery]}})})},e.prototype.setAllowFriendDiscovery=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)((0,p.a)("boolean",e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new e_({userId:n.userId,allowFriendDiscovery:e}),[4,r.send(i)];case 1:return s.sent(),[2,e]}})})},e.prototype.uploadFriendDiscoveries=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new eo({userId:n.userId,discoveries:e}),[4,r.send(i)];case 1:return[2,s.sent().as(eu).friendDiscoveryRequestId]}})})},e.prototype.deleteFriendDiscovery=function(e){return(0,p.b)(this,void 0,void 0,function(){return(0,p.c)(this,function(t){return[2,this.deleteFriendDiscoveries([e])]})})},e.prototype.deleteFriendDiscoveries=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)((0,p.l)("string",e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new ec({userId:n.userId,discoveryKeys:e}),[4,r.send(i)];case 1:return s.sent(),[2]}})})},e.prototype.addFriends=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)((0,p.l)("string",e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new el({userId:n.userId,userIds:e}),[4,r.send(i)];case 1:return[2,s.sent().as(eh).users]}})})},e.prototype.deleteFriend=function(e){return(0,p.b)(this,void 0,void 0,function(){return(0,p.c)(this,function(t){return[2,this.deleteFriends([e])]})})},e.prototype.deleteFriends=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n,r,i;return(0,p.c)(this,function(s){switch(s.label){case 0:return(0,p.q)((0,p.l)("string",e)).throw(p.S.invalidParameters),n=(t=p.V.of(this._iid)).sdkState,r=t.requestQueue,i=new ed({userId:n.userId,userIds:e}),[4,r.send(i)];case 1:return s.sent(),[2]}})})},e.prototype.getAllEmoji=function(){return(0,p.b)(this,void 0,void 0,function(){var e,t;return(0,p.c)(this,function(n){switch(n.label){case 0:return e=p.V.of(this._iid).requestQueue,t=new ey,[4,e.send(t)];case 1:return[2,n.sent().as(eb).emojiContainer]}})})},e.prototype.getEmojiCategory=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n;return(0,p.c)(this,function(r){switch(r.label){case 0:return t=p.V.of(this._iid).requestQueue,n=new eE({categoryId:e}),[4,t.send(n)];case 1:return[2,r.sent().as(ew).emojiCategory]}})})},e.prototype.getEmoji=function(e){return(0,p.b)(this,void 0,void 0,function(){var t,n;return(0,p.c)(this,function(r){switch(r.label){case 0:return t=p.V.of(this._iid).requestQueue,n=new eI({key:e}),[4,t.send(n)];case 1:return[2,r.sent().as(eT).emoji]}})})},e}()}}]);