"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9080],{6720:function(t,e){e.Z={Shift4:"shift4",Verotel:"verotel"}},6066:function(t,e,s){var a=s(5121),i=s(4487),r=s(6720);e.Z={data(){return{subscription:null,packages:[],providers:{},attemptId:null,selectedMethodId:null,paymentMethodsVisible:!1,loading:!1,paying:!1,data:null,invoker:null}},computed:{isVerotelActive(){return this.selectedMethod?.provider===r.Z.Verotel},availablePaymentOptions(){return this.paymentOptions.filter((t=>t.available))},paymentOptions(){return[{id:"shift4-cc",name:this.__("payments.card"),icons:["visa-color","mastercard-color","maestro-color","american-express-color"],available:!0,disabled:this.providers.shift4?.limit,provider:r.Z.Shift4,parameters:{}},{id:"verotel-cc",name:this.__("payments.card"),icons:["visa-color","mastercard-color"],provider:r.Z.Verotel,available:this.providers.shift4?.limit,disabled:!1,parameters:{paymentMethod:"CC"}},{id:"verotel-dd",name:this.__("payments.direct"),icons:["maestro-color","sofort"],provider:r.Z.Verotel,available:this.directDebitAvailable,disabled:!1,parameters:{paymentMethod:"DDEU"}}]},selectedMethod(){return this.paymentOptions.filter((t=>t.id===this.selectedMethodId))[0]},morePaymentOptionsAvailable(){return this.availablePaymentOptions.length>1},directDebitAvailable(){return["DE","AT","CH","BE","IT","NL","ES","FR"].includes(this.$shared.user.country)},size(){return this.paying?"small":this.paymentMethodsVisible?"medium":"xlarge"}},created(){this.selectedMethodId=this.availablePaymentOptions[0].id},methods:{async initialize(t){let{modal:e,invoker:s,creatorId:i=null,parentId:r=null}=t;this.data=null,this.paying=!1;const o=await a.Z.get(route("payments.data",{creator:i,modal:e,invoker:s,parent_id:r}));this.invoker=s,this.packages=o.data.packages,this.entranceFee=o.data.entranceFee,this.subscription=o.data.subscription,this.providers=o.data.providers,this.attemptId=o.data.attemptId,this.providers.shift4.limit&&(this.selectedMethodId="verotel-cc")},checkout(){this.isVerotelActive?this.close():this.paying=!0},switchToVerotel(){this.paying=!1,this.paymentMethodsVisible=!0,this.providers.shift4.limit=!0,this.selectedMethodId="verotel-cc"},shift4DailyLimitReached(){window.$toast.add({title:this.__("payments.declines_limit_reached"),message:this.__("payments.try_different_provider"),type:"warning"}),this.switchToVerotel()},shift4NotAvailable(){this.unknownError("Shift4 not available"),this.switchToVerotel()},unknownError(t){window.$toast.add({title:this.__("payments.script_error"),message:this.__("payments.please_try_again"),type:"error"}),t&&i.Tb(t)}}}},157:function(t,e,s){s.d(e,{Z:function(){return r}});var a=s(6720),i={name:"SelectPaymentMethod",props:{availablePaymentOptions:{type:Array,required:!0},selectedMethodId:{type:String,required:!0},loading:{type:Boolean,default:!1},vatAmount:{type:String,default:null},url:{type:String,default:null}},methods:{isVerotel(t){return t.provider===a.Z.Verotel},selectPaymentMethod(t){this.$emit("select-payment-method",t)},pay(){this.$emit("pay")},close(){this.$emit("close")},back(){this.$emit("back")}}},r=(0,s(1900).Z)(i,(function(){var t=this,e=t._self._c;return e("v-card",{staticClass:"px-6 py-4 md:!pb-10",attrs:{modal:""},scopedSlots:t._u([{key:"header",fn:function(){return[e("v-text",{staticClass:"mb-5 w-full",attrs:{tag:"h2"}},[t._v("\n      "+t._s(t.__("layout.select_payment_method"))+"\n    ")])]},proxy:!0},{key:"footer",fn:function(){return[e("div",{staticClass:"mt-4 w-full"},[e("v-separator",{staticClass:"!mb-4 md:hidden"}),t._v(" "),e("div",{staticClass:"center mb-2 gap-3 font-semibold"},[e("div",{staticClass:"rounded-full bg-gray-light-tertiary p-2 dark:bg-gray-tertiary"},[e("v-icon",{staticClass:"h-4 w-4 text-gray-light-caption dark:text-gray-caption",attrs:{name:"lock"}})],1),t._v(" "),e("v-text",{staticClass:"capitalize"},[t._v(t._s(t.__("layout.discreet_secure")))])],1),t._v(" "),e("v-text",{staticClass:"text-center text-xs font-semibold md:text-sm",attrs:{color:"caption",tag:"p"}},[t._v("\n        "+t._s(t.__("layout.credit_card_disclaimer"))+"\n      ")]),t._v(" "),e("div",{staticClass:"my-4 flex w-full flex-row justify-center gap-3 md:gap-5"},[e("v-icon",{attrs:{name:"maestro-color"}}),t._v(" "),e("v-icon",{attrs:{name:"mastercard-color"}}),t._v(" "),e("v-icon",{attrs:{name:"visa-color"}}),t._v(" "),e("v-icon",{attrs:{name:"sofort"}}),t._v(" "),e("v-icon",{attrs:{name:"americanexpress-color"}})],1),t._v(" "),e("v-text",{staticClass:"text-center text-xs font-semibold md:text-sm",attrs:{color:"caption",tag:"p"}},[t._v("\n        "+t._s(t.__("terms.short_location"))+"\n      ")])],1)]},proxy:!0}])},[e("button",{staticClass:"absolute right-2 top-2 z-100 p-3 md:right-5 md:top-5",attrs:{"aria-label":"Close",type:"button"},on:{click:t.close}},[e("v-icon",{staticClass:"h-5 w-5 cursor-pointer text-gray-light-icons transition-transform duration-300 ease-in-out hover:-rotate-45 dark:text-white",attrs:{name:"x"}})],1),t._v(" "),t._v(" "),e("div",{staticClass:"w-full md:my-5"},[e("div",{staticClass:"flex w-full flex-col"},[e("ul",{staticClass:"w-full"},t._l(t.availablePaymentOptions,(function(s){return e("v-radio-card",{key:s.id,staticClass:"flex-wrap",attrs:{selected:t.selectedMethodId===s.id,disabled:s.disabled},nativeOn:{click:function(e){s.disabled||t.selectPaymentMethod(s)}}},[e("div",{staticClass:"w-full"},[e("div",{staticClass:"flex w-full flex-row flex-wrap items-center gap-x-4 gap-y-2 xl:flex-nowrap"},[e("span",{staticClass:"w-fit whitespace-nowrap text-lg font-semibold"},[t._v(t._s(s.name))]),t._v(" "),t.isVerotel(s)?e("v-text",{staticClass:"ml-auto w-24 text-right text-xs lg:ml-0 lg:text-left",attrs:{color:"caption"}},[t._v("\n                "+t._s(t.__("payments.by_verotel"))+"\n              ")]):e("v-text",{staticClass:"ml-auto w-24 text-right text-xs font-semibold lg:ml-0 lg:text-left",attrs:{color:"caption"}},[t._v("\n                "+t._s(t.__("payments.by_shift4"))+"\n              ")]),t._v(" "),e("div",{staticClass:"inline-flex gap-3 lg:ml-auto"},t._l(s.icons,(function(t){return e("v-icon",{key:t,staticClass:"h-4",attrs:{name:t}})})),1)],1)])])})),1),t._v(" "),e("div",{staticClass:"mt-4 flex gap-4"},[e("v-button",{staticClass:"w-full",attrs:{id:"payment-method-back-btn",size:"large",variant:"secondary"},on:{click:t.back}},[e("v-text",[t._v(t._s(t.__("layout.payment_method_back")))])],1),t._v(" "),t.url?e("v-button",{staticClass:"w-full",attrs:{id:"checkout",type:"button",variant:"success",size:"large",target:"_blank",href:t.url},on:{click:t.pay}},[e("v-text",[t._v(t._s(t.__("layout.continue")))])],1):e("v-button",{staticClass:"w-full",attrs:{id:"checkout",type:"button",variant:"success",size:"large","is-loading":t.loading,disabled:t.loading},on:{click:t.pay}},[e("v-text",[t._v(t._s(t.__("layout.continue")))])],1)],1),t._v(" "),e("p",{staticClass:"mt-2 text-center"},[e("v-text",{staticClass:"text-sm lg:text-base",attrs:{tag:"span"}},[t._v(t._s(t.__("layout.i_agree_with_checkout")))]),t._v(" "),e("a",{staticClass:"inline-block text-sm lg:text-base",attrs:{href:t.route("terms"),target:"_blank"}},[t._v("\n          "+t._s(t.__("layout.terms_conditions"))+"\n        ")])],1),t._v(" "),t.vatAmount?e("v-text",{staticClass:"mt-2 text-center text-xs",attrs:{color:"caption",tag:"p"},domProps:{innerHTML:t._s(t.__("modal.add_tokens.vat_amount",{amount:t.vatAmount}))}}):t._e()],1)])])}),[],!1,null,null,null).exports},6390:function(t,e,s){s.d(e,{Z:function(){return l}});var a=s(5121),i=s(958),r=s(6720),o={name:"Shift4PaymentForm",components:{TransitionExpand:i.$N},props:{providers:{type:Object,required:!0},title:{type:String,required:!0},package:{type:Number,default:null},packageBonus:{type:Number,default:null},amount:{type:Number,required:!0},currency:{type:String,required:!0},cost:{type:String,required:!0},creator:{type:Object,default:null},topCreators:{type:Array,default:()=>[]},parentId:{type:Number,default:null},invoker:{type:String,default:null}},data(){return{loading:!1,cooldown:!1,cardTimeout:null,errorTimeout:null,cooldownTimeout:null,cards:null,selectedCardId:null,error:null,shift4:null,email:null,form:{number:null,expiration:null,cvc:null}}},computed:{buysTokens(){return null!==this.package}},watch:{error(){clearTimeout(this.cooldownTimeout),clearTimeout(this.errorTimeout),this.error&&(this.errorTimeout=setTimeout((()=>{this.error=null}),1e4),this.cooldown=!0,this.cooldownTimeout=setTimeout((()=>{this.cooldown=!1}),3e3))}},created(){a.Z.get(route("shift4.cards",{parent_id:this.parentId,invoker:this.invoker||"unknown",model_id:this.creator?.id})).then((t=>{let{data:e}=t;this.cards=e.cards,this.cards.length&&(this.selectedCardId=this.cards[0].id),this.$nextTick((()=>{this.shift4=window.Shift4(this.providers.shift4.key),this.form=this.shift4.createComponentGroup().automount(this.$refs.shift4Form),this.selectedCardId||(this.cardTimeout=setTimeout((()=>{this.selectedCardId="new"}),500))}))}))},mounted(){"Shift4"in window?posthog.capture("shift4_payment_form.open"):this.$emit("not-available")},beforeDestroy(){clearTimeout(this.cardTimeout),clearTimeout(this.cooldownTimeout),clearTimeout(this.errorTimeout)},methods:{submit(){return this.error=null,this.loading=!0,posthog.capture("shift4_payment_form.pay"),this.$shared.user.hasEmail||this.email?this.selectedCardId&&"new"!==this.selectedCardId?(posthog.capture("shift4_payment_form.using-existing-card"),void this.verifyThreeDSecure(this.selectedCardId)):void this.shift4.createToken(this.form).then((t=>{const e=this.cards.find((e=>e.fingerprint===t.fingerprint));if(e)return posthog.capture("shift4_payment_form.using-existing-card"),void this.chargeCard(e.id);posthog.capture("shift4_payment_form.using-new-card"),this.verifyThreeDSecure(t.id)})).catch((t=>{this.error=t.message,this.loading=!1,posthog.capture("shift4_payment_form.form-error",{error:t.message})})):(this.error=this.__("auth.email_required"),this.loading=!1,void posthog.capture("shift4_payment_form.email-required"))},verifyThreeDSecure(t){posthog.capture("shift4_payment_form.verify-3ds"),this.shift4.verifyThreeDSecure({amount:this.amount,currency:this.currency,card:t}).then((t=>{t.threeDSecureInfo.enrolled&&"failed"===t.threeDSecureInfo.liabilityShift&&posthog.capture("shift4_payment_form.3ds-not-verified"),this.chargeCard(t.id)})).catch((t=>{this.error=t.message,this.loading=!1,posthog.capture("shift4_payment_form.3d-secure-error",{error:t.message})}))},chargeCard(t){let e=null;const s={card_id:t,provider:r.Z.Shift4,payment_attempt_id:this.parentId};this.email&&(s.email=this.email),this.package?(s.package=this.package,this.packageBonus&&(s.bonus_package_id=this.packageBonus),this.creator&&(s.converted_model_id=this.creator.id),e=this.route("orders.create",s)):(s.model=this.creator.id,e=this.route("subscriptions.create",s)),a.Z.get(e).then((()=>{const t={amount:this.amount,currency:this.currency,cost:this.cost,creator_id:this.creator?.id,creator_nickname:this.creator?.nickname};this.$emit("paid",t),posthog.capture("shift4_payment_form.paid",t)})).catch((e=>403===e.response.status?(this.$emit("daily-limit-reached"),void posthog.capture("shift4_payment_form.daily-limit-reached")):401===e.response.status?(this.verifyThreeDSecure(t),void posthog.capture("shift4_payment_form.requires-3ds")):(this.loading=!1,this.error=e.response.data.message,void posthog.capture("shift4_payment_form.payment-error",{error:e.response.data.message}))))},selectCard(t){this.selectedCardId=t.id,"new"!==t.id?posthog.capture("shift4_payment_form.select-card"):posthog.capture("shift4_payment_form.add-new-card")},icon(t){const e=t.brand.toLowerCase().replace(" ","-");return["visa","mastercard","maestro","american-express","discover","diners-club","jcb"].includes(e)?`${e}-color`:"credit-card"},back(){this.$emit("back")},avatar(t){return this.processImage({url:t})}}},n=(0,s(1900).Z)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"h-full bg-gray-light-primary shadow dark:bg-gray-primary sm:h-auto sm:rounded-lg"},[e("div",{staticClass:"relative flex h-[calc(100*var(--vh,1%))] flex-col justify-between sm:h-full"},[e("div",{staticClass:"absolute left-0 top-0 z-10 flex h-20 w-full flex-col gap-2 bg-gray-light-primary px-4 dark:bg-gray-primary sm:px-6"},[e("div",{staticClass:"flex w-full flex-1 items-center gap-3 pt-2"},[e("button",{attrs:{title:t.__("dashboard.back")},on:{click:t.back}},[e("v-icon",{staticClass:"h-8 w-8 text-gray-light-icons hover:text-black dark:hover:text-white",attrs:{name:"arrow-back"}})],1),t._v(" "),e("v-text",{attrs:{tag:"h2",styling:"h4"}},[t._v(t._s(t.title))]),t._v(" "),e("button",{staticClass:"ml-auto",attrs:{"aria-label":"Close",title:"Close",type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("v-icon",{staticClass:"h-5 w-5 text-gray-light-icons hover:text-black dark:hover:text-white",attrs:{name:"x"}})],1)],1),t._v(" "),e("v-separator")],1),t._v(" "),e("div",{staticClass:"relative my-20 flex max-h-[calc(100*var(--vh,1%)-10rem)] w-full flex-col gap-6 overflow-y-auto px-4 pb-4 pt-6 sm:max-h-[calc(85vh-10rem)] sm:px-6"},[t.buysTokens?[e("ul",{staticClass:"grid grid-cols-2 gap-2.5 text-sm sm:text-base"},t._l(4,(function(s){return e("li",{key:s,staticClass:"flex items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-success-500"},[e("v-icon",{staticClass:"h-3 w-3",attrs:{name:"check"}})],1),t._v(" "),e("v-text",{staticClass:"whitespace-nowrap"},[t._v("\n              "+t._s(t.__(`payments.buy_tokens_list.feature_${s}`))+"\n            ")])],1)})),0),t._v(" "),e("div",{staticClass:"relative flex items-center justify-center"},t._l(t.topCreators,(function(s){return e("img",{key:s.id,staticClass:"-mr-2 h-16 w-16 shrink-0 overflow-hidden rounded-full object-cover ring-1 ring-white/30",attrs:{src:t.avatar(s.avatar_circle),alt:s.nickname,draggable:"false"}})})),0)]:e("div",{staticClass:"flex items-center gap-5"},[e("img",{staticClass:"h-36 w-36 shrink-0 overflow-hidden rounded-full object-cover ring-1 ring-white/30",attrs:{src:t.avatar(t.creator.avatar_circle),alt:t.creator.nickname,draggable:"false"}}),t._v(" "),e("ul",{staticClass:"flex flex-col gap-2.5 text-sm sm:text-base"},t._l(4,(function(s){return e("li",{key:s,staticClass:"flex items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-success-500"},[e("v-icon",{staticClass:"h-3 w-3",attrs:{name:"check"}})],1),t._v(" "),e("v-text",{staticClass:"whitespace-nowrap"},[t._v("\n              "+t._s(t.__(`payments.buy_subscription_list.feature_${s}`))+"\n            ")])],1)})),0)]),t._v(" "),t.$shared.user.hasEmail?t._e():e("div",{staticClass:"relative"},[e("label",{staticClass:"absolute left-4 top-1 text-sm font-medium tracking-wider text-stone-600",attrs:{for:"email"}},[t._v("\n          "+t._s(t.__("auth.email"))+"\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"h-16 w-full rounded-lg border border-stone-300 bg-white px-4 pb-1 pt-7 placeholder:text-stone-500",attrs:{name:"email",type:"email",placeholder:t.__("auth.email"),required:""},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),t._v(" "),t.cards?.length?e("ul",{staticClass:"flex w-full flex-col gap-4"},[t._l(t.cards,(function(s){return e("li",{key:s.id,staticClass:"flex w-full cursor-pointer flex-nowrap items-center gap-4 rounded-lg border border-stone-300 bg-white p-4 ring-primary-400/70 hover:ring",class:[s.id===t.selectedCardId?"ring":""],on:{click:function(e){return t.selectCard(s)}}},[e("v-icon",{staticClass:"h-6",attrs:{name:t.icon(s)}}),t._v(" "),e("span",[t._v("\n            "+t._s(s.number)+"\n          ")]),t._v(" "),e("span",{staticClass:"ml-auto whitespace-nowrap text-stone-400"},[t._v(" ("+t._s(s.expiration)+") ")])],1)})),t._v(" "),e("li",{staticClass:"flex w-full cursor-pointer flex-nowrap items-center gap-4 rounded-lg border border-stone-300 bg-white p-4 ring-primary-400/70 hover:ring",class:["new"===t.selectedCardId?"ring":""],on:{click:function(e){return t.selectCard({id:"new"})}}},[e("v-icon",{staticClass:"h-6 text-stone-400",attrs:{name:"credit-card"}}),t._v(" "),e("span",[t._v("\n            "+t._s(t.__("layout.add_new_card"))+"\n          ")])],1)],2):null===t.cards||null===t.selectedCardId?e("div",{staticClass:"flex h-[126px] w-full items-center justify-center"},[e("v-loading-dots")],1):t._e(),t._v(" "),e("form",{directives:[{name:"show",rawName:"v-show",value:null!==t.cards&&null!==t.selectedCardId&&(!t.cards.length||"new"===t.selectedCardId),expression:"cards !== null && selectedCardId !== null && (!cards.length || selectedCardId === 'new')"}],ref:"shift4Form",staticClass:"flex w-full flex-col gap-4",on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"relative h-16 w-full rounded-lg border border-stone-300 bg-white px-4 pb-1 pt-7"},[e("label",{staticClass:"absolute left-4 top-1 text-sm font-medium tracking-wider text-stone-600"},[t._v("\n            "+t._s(t.__("layout.card_number"))+"\n          ")]),t._v(" "),e("div",{attrs:{"data-shift4":"number"}})]),t._v(" "),e("div",{staticClass:"flex w-full gap-4"},[e("div",{staticClass:"relative h-16 w-2/3 rounded-lg border border-stone-300 bg-white px-4 pb-1 pt-7"},[e("label",{staticClass:"absolute left-4 top-1 text-sm font-medium tracking-wider text-stone-600"},[t._v("\n              "+t._s(t.__("layout.expiration"))+"\n            ")]),t._v(" "),e("div",{attrs:{"data-shift4":"expiry"}})]),t._v(" "),e("div",{staticClass:"relative h-16 w-1/3 rounded-lg border border-stone-300 bg-white px-4 pb-1 pt-7"},[e("label",{staticClass:"absolute left-4 top-1 text-sm font-medium tracking-wider text-stone-600"},[t._v("\n              "+t._s(t.__("layout.cvc"))+"\n            ")]),t._v(" "),e("div",{attrs:{"data-shift4":"cvc"}})])])]),t._v(" "),e("transition-expand",{attrs:{axis:"y"}},[t.error?e("div",{staticClass:"rounded-lg bg-red-100 p-4 text-red-500"},[t._v("\n          "+t._s(t.error)+"\n        ")]):t._e()]),t._v(" "),e("v-separator"),t._v(" "),e("div",{staticClass:"-my-2 flex w-full flex-col"},[e("v-text",{staticClass:"mb-2 text-center text-sm",attrs:{color:"caption"}},[e("span",[t._v(t._s(t.__("layout.i_agree_with_checkout")))]),t._v(" "),e("a",{staticClass:"inline-block",attrs:{href:t.route("terms"),target:"_blank"}},[t._v("\n            "+t._s(t.__("layout.terms_conditions"))+"\n          ")])])],1),t._v(" "),e("v-text",{staticClass:"-mb-4 text-center text-sm uppercase tracking-wider",domProps:{innerHTML:t._s(t.__("payments.statement"))}}),t._v(" "),t._m(0)],2),t._v(" "),e("div",{staticClass:"absolute bottom-0 left-0 z-10 flex h-20 w-full items-center bg-gray-light-secondary px-4 dark:bg-gray-secondary sm:px-6"},[e("v-button",{staticClass:"w-full",attrs:{size:"large",disabled:t.loading||t.cooldown||null===t.cards},on:{click:t.submit}},[t.loading?e("v-icon",{attrs:{loading:"",name:"spinner"}}):t._e(),t._v(" "),e("span",[t._v(t._s(t.__("layout.pay",{amount:t.cost})))])],1)],1)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"flex w-full shrink-0 items-center justify-center gap-8 py-5"},[t("img",{staticClass:"h-10 dark:brightness-200",attrs:{draggable:"false",src:"/img/payment/privacy-in-bank-statement.png",alt:"Privacy in bank statement"}}),this._v(" "),t("img",{staticClass:"h-10 dark:brightness-200",attrs:{draggable:"false",src:"/img/payment/256bit-encryption.png",alt:"256bit encryption"}})])}],!1,null,null,null),l=n.exports},9080:function(t,e,s){s.r(e),s.d(e,{default:function(){return b}});var a=s(5121),i=s(4487),r=s(629),o=s(958),n=s(157),l=s(6390),c=s(6785),d=s(6066),p=s(7347),u=s(6720);function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function _(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){m(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function m(t,e,s){var a;return(e="symbol"==typeof(a=function(t,e){if("object"!=typeof t||!t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var a=s.call(t,e||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?a:String(a))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var v={name:"BuySubscriptionOrTopUpModal",components:{Shift4PaymentForm:l.Z,SelectPaymentMethod:n.Z,TransitionSlide:o.n8},mixins:[d.Z,c.Z],data(){return{creator:null,invoker:null,showTopUp:!1,showSubscription:!0,avatars:[]}},computed:_(_({},(0,r.Se)("modal",["activeModal","modalOptions"])),{},{visible(){return this.activeModal===p.Z.BUY_SUBSCRIPTION_OR_TOP_UP},subscriptionPrice(){return this.subscription?.price},vatAmount(){return this.paymentMethodsVisible?this.subscription.vat:null},url(){return this.isVerotelActive?this.showTopUp?null:this.route("subscriptions.create",_({provider:this.selectedMethod.provider,model:this.creator.id},this.selectedMethod.parameters)):null},size(){return this.paying?"small":this.paymentMethodsVisible?"medium":"xlarge"},gridAvatars(){return this.creator?[{id:this.creator.id,avatar_thumbnail_url:this.creator.avatar_thumbnail,avatar_blur_hash:this.creator.avatar_blur_hash},...this.avatars.filter((t=>t.id!==this.creator.id))]:[]},topCreators(){return this.avatars.slice(0,6)}}),watch:{visible:{immediate:!0,handler(t){t&&this.open(this.modalOptions)}}},methods:_(_(_({},(0,r.nv)("tokens",["refreshTokenBalance"])),(0,r.nv)("modal",["openModal","closeModal"])),{},{async open(t){await this.initialize({creatorId:t.creator?.id,invoker:t.invoker||"unknown",modal:"buy-subscription-or-top-up"}),this.paying=!1,this.showTopUp=!1,this.paymentMethodsVisible=!1,this.creator=t.creator,this.invoker=t?.invoker,a.Z.get(this.route("payments.avatars")).then((t=>{this.avatars=t.data.avatars})),posthog.capture("buy-subscription-or-top-up-modal.open",{invoker:t?.invoker})},pay(){const{creator:t}=this;posthog.capture("buy-subscription-or-top-up-modal.pay",{creator_id:t?.id,creator_nickname:t?.nickname}),this.checkout()},subscribe(){if(posthog.capture("buy-subscription-or-top-up-modal.subscribe"),this.showTopUp=!1,this.morePaymentOptionsAvailable)return posthog.capture("buy-subscription-or-top-up-modal.show-payment-methods"),void(this.paymentMethodsVisible=!0);this.pay()},async topup(){posthog.capture("buy-subscription-or-top-up-modal.topup");const{creator:t}=this;await this.close(),await this.openModal({name:p.Z.ADD_TOKENS,options:{invoker:"buy-subscription-or-top-up-modal",creator:t,attemptId:this.attemptId}})},selectPaymentMethod(t){this.selectedMethodId=t.id,posthog.capture("buy-subscription-or-top-up-modal.select-payment-method",{method:this.selectedMethodId})},async paid(t){this.showTopUp?await this.paidForTokens(t):await this.paidForSubscription(t)},async paidForSubscription(t){window.gtag("event","subscription_purchase",_({provider:u.Z.Shift4},t));const{creator:e}=this;this.close(),this.$inertia.reload({preserveScroll:!0,preserveState:!1,onSuccess:()=>{this.openModal({name:p.Z.SUBSCRIPTION_BOUGHT,options:{invoker:"subscription-payment-modal",creator:e}})},onError:t=>{i.Tb(t),window.location.reload()}})},async paidForTokens(t){const{creator:e,invoker:s}=this;if(this.close(),await this.refreshTokenBalance(),window.gtag("event","tokens_purchase",_({provider:u.Z.Shift},t)),"video-call"===s)return window.$toast.clear(),window.$toast.add({title:this.__("layout.congratulations"),message:this.__("layout.tokens_purchased"),type:"success"}),void this.openModal({name:p.Z.FLIRT_TIME,options:{participant:e}});this.$inertia.reload({preserveScroll:!0,preserveState:!1,onSuccess:()=>{window.$toast.clear(),window.$toast.add({title:this.__("layout.congratulations"),message:this.__("layout.tokens_purchased"),type:"success"})},onError:t=>{i.Tb(t),window.location.reload()}})},switchModal(){this.showSubscription=!this.showSubscription},close(){this.closeModal({name:p.Z.BUY_SUBSCRIPTION_OR_TOP_UP}),this.loading=!1,this.showTopUp=!1,this.showSubscription=!0,this.creator=null,this.invoker=null},back(){this.paying=!1,this.selectedPackageId=null,this.paymentMethodsVisible=!1}})},b=(0,s(1900).Z)(v,(function(){var t=this,e=t._self._c;return!t.visible||!t.creator||t.paying||t.paymentMethodsVisible||t.isDesktop?t.visible&&t.creator?e("v-modal",{attrs:{id:"buy-subscription-or-top-up-modal",value:!0,size:t.size},on:{close:t.close}},[t.paying&&!t.showTopUp?e("Shift4PaymentForm",{key:"pay",attrs:{providers:t.providers,title:t.__("payments.purchase_subscription",{nickname:t.creator.nickname}),amount:t.subscription.amount,currency:t.subscription.currency,cost:t.subscription.cost,creator:t.creator,"parent-id":t.attemptId,invoker:"buy-subscription-or-top-up"},on:{paid:t.paid,close:t.close,back:t.back,"not-available":t.shift4NotAvailable,"daily-limit-reached":t.shift4DailyLimitReached}}):t.paymentMethodsVisible?e("SelectPaymentMethod",{key:"method",attrs:{"selected-method-id":t.selectedMethodId,"available-payment-options":t.availablePaymentOptions,loading:t.loading,"vat-amount":t.vatAmount,url:t.url},on:{pay:t.pay,close:t.close,"select-payment-method":t.selectPaymentMethod}}):e("div",{staticClass:"relative flex min-h-full w-full flex-col items-center bg-white dark:bg-gray-primary lg:flex-row lg:items-stretch lg:justify-center"},[e("button",{staticClass:"absolute right-2 top-2 z-1000 p-3 lg:right-5 lg:top-5",attrs:{"aria-label":"Close",type:"button"},on:{click:t.close}},[e("v-icon",{staticClass:"h-5 w-5 cursor-pointer text-gray-light-icons transition-transform duration-300 ease-in-out hover:-rotate-45 dark:text-white",attrs:{name:"x"}})],1),t._v(" "),e("div",{staticClass:"w-full px-2 py-4 lg:px-12 lg:py-8"},[e("v-text",{staticClass:"w-full pb-6 capitalize lg:!text-3xl",attrs:{tag:"h2",styling:"h4"}},[t._v("\n        "+t._s(t.__("modal.buy_subscription_or_top_up.title"))+"\n      ")]),t._v(" "),e("div",{staticClass:"flex w-full flex-col items-stretch justify-center gap-5 md:flex-row lg:gap-10"},[e("div",{staticClass:"w-full rounded-lg border-2 border-gray-light-icons p-4 dark:border-gray-icons lg:p-6"},[e("div",{staticClass:"mb-4 flex items-center gap-4"},[e("v-avatar",{staticClass:"mx-auto h-16 w-16 shrink-0 grow-0 rounded-full",attrs:{url:t.creator.avatar_circle,gender:t.creator.gender,nickname:t.creator.nickname,country:t.creator.country,"full-rounded":""}}),t._v(" "),e("v-text",{staticClass:"w-full text-center md:text-left",attrs:{tag:"h4"}},[t._v("\n              "+t._s(t.__("modal.buy_subscription_or_top_up.option_1.title",{nickname:t.creator.nickname}))+"\n            ")])],1),t._v(" "),e("ul",{staticClass:"mb-4 mt-2"},t._l(3,(function(s){return e("li",{key:s,staticClass:"flex items-center"},[e("v-text",{staticClass:"mb-2 flex items-center gap-3 font-semibold"},[e("v-icon",{staticClass:"h-5 w-5 text-info-400",attrs:{name:"checkbox-alt"}}),t._v("\n                "+t._s(t.__(`modal.buy_subscription_or_top_up.option_1.feature_${s}`,{nickname:t.creator.nickname}))+"\n              ")],1)],1)})),0),t._v(" "),e("v-button",{staticClass:"w-full whitespace-nowrap",attrs:{variant:"info",size:"large"},on:{click:t.subscribe}},[e("v-icon",{staticClass:"h-5 w-5 shrink-0 md:h-6 md:w-6",attrs:{name:"star-alt"}}),t._v(" "),e("span",{staticClass:"ml-2",domProps:{innerHTML:t._s(t.__("modal.buy_subscription_or_top_up.option_1.cta",{price:t.subscriptionPrice}))}})],1)],1),t._v(" "),e("v-text",{staticClass:"w-full text-center text-xl font-bold md:hidden"},[t._v("\n          "+t._s(t.__("modal.buy_subscription_or_top_up.or"))+"\n        ")]),t._v(" "),e("div",{staticClass:"flex w-full flex-col rounded-lg border-2 border-gray-light-icons p-4 dark:border-gray-icons lg:p-6"},[e("v-text",{staticClass:"mb-4 w-full text-left",attrs:{tag:"h4"}},[t._v("\n            "+t._s(t.__("modal.buy_subscription_or_top_up.option_2.title"))+"\n          ")]),t._v(" "),e("v-text",{staticClass:"mb-6 w-full text-sm font-medium md:my-6 md:text-base"},[t._v("\n            "+t._s(t.__("modal.buy_subscription_or_top_up.option_2.subtitle"))+"\n          ")]),t._v(" "),e("v-button",{staticClass:"mt-auto w-full whitespace-nowrap",attrs:{variant:"primary",size:"large"},on:{click:t.topup}},[e("v-icon",{staticClass:"h-5 w-5 shrink-0 md:h-6 md:w-6",attrs:{name:"tokens"}}),t._v(" "),e("span",{staticClass:"ml-2",domProps:{innerHTML:t._s(t.__("modal.buy_subscription_or_top_up.option_2.cta"))}})],1)],1)],1)],1)])],1):t._e():e("transition-slide",{attrs:{duration:500,offset:[0,"100%"]}},[t.showSubscription?e("div",{staticClass:"fixed bottom-0 left-0 z-5000 flex w-full overflow-hidden rounded-t-2xl bg-white dark:bg-black"},[e("button",{staticClass:"absolute right-0 top-0 z-1000 p-3",attrs:{"aria-label":"Close",type:"button"},on:{click:t.switchModal}},[e("v-icon",{staticClass:"h-3 w-3 cursor-pointer text-gray-light-icons dark:text-white",attrs:{name:"x"}})],1),t._v(" "),e("v-avatar",{staticClass:"!absolute bottom-0 left-0 z-0 h-[300px] w-[200px]",attrs:{url:t.creator.avatar_thumbnail}}),t._v(" "),e("div",{staticClass:"relative z-1 ml-[120px] flex h-[300px] w-full flex-col items-center gap-5 bg-gradient-to-r from-transparent via-gray-icons via-[50px] to-gray-icons pl-6 pr-2 pt-5"},[e("p",{staticClass:"text-center font-semibold uppercase text-success-500"},[t._v("\n        "+t._s(t.__("modal.buy_subscription_or_top_up.continue_by_supporting.title"))+"\n      ")]),t._v(" "),e("ul",{staticClass:"flex flex-col gap-2.5"},[e("li",{staticClass:"flex items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md bg-success-500"},[e("v-icon",{staticClass:"h-4 w-4",attrs:{name:"check"}})],1),t._v(" "),e("span",[t._v(t._s(t.__("modal.buy_subscription_or_top_up.continue_by_supporting.feature_1")))])]),t._v(" "),e("li",{staticClass:"flex items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md bg-success-500"},[e("v-icon",{staticClass:"h-4 w-4",attrs:{name:"check"}})],1),t._v(" "),e("span",[t._v(t._s(t.__("modal.buy_subscription_or_top_up.continue_by_supporting.feature_2")))])]),t._v(" "),e("li",{staticClass:"flex items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md bg-success-500"},[e("v-icon",{staticClass:"h-4 w-4",attrs:{name:"check"}})],1),t._v(" "),e("span",[t._v(t._s(t.__("modal.buy_subscription_or_top_up.continue_by_supporting.feature_3")))])]),t._v(" "),e("li",{staticClass:"flex w-fit items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md bg-success-500"},[e("v-icon",{staticClass:"h-4 w-4",attrs:{name:"check"}})],1),t._v(" "),e("span",{staticClass:"inline-block max-w-[calc(100vw-190px)] truncate"},[t._v("\n            "+t._s(t.__("modal.buy_subscription_or_top_up.continue_by_supporting.feature_4",{nickname:t.creator.nickname}))+"\n          ")])])]),t._v(" "),e("div",{staticClass:"flex flex-col gap-2"},[e("v-button",{staticClass:"!w-fit whitespace-nowrap !px-3",attrs:{variant:"success"},on:{click:t.subscribe}},[e("span",{staticClass:"uppercase"},[t._v("\n            "+t._s(t.__("modal.buy_subscription_or_top_up.continue_by_supporting.cta",{subscriptionPrice:t.subscriptionPrice}))+"\n          ")]),t._v(" "),e("v-icon",{staticClass:"h-5 w-5 shrink-0",attrs:{name:"arrow-right-circle"}})],1),t._v(" "),e("p",{staticClass:"text-center text-xxs text-white"},[t._v("\n          "+t._s(t.__("modal.buy_subscription.renews_monthly"))+"\n          "),e("a",{staticClass:"!text-white",attrs:{href:t.route("settings.subscriptions.index"),target:"_blank"}},[t._v("\n            "+t._s(t.__("modal.buy_subscription.cancel_anytime"))+"\n          ")])])],1),t._v(" "),e("button",{staticClass:"text-sm font-semibold uppercase text-white underline",on:{click:t.switchModal}},[t._v("\n        "+t._s(t.__("modal.buy_subscription_or_top_up.continue_by_supporting.switch"))+"\n      ")])])],1):e("div",{staticClass:"fixed bottom-0 left-0 z-5000 flex w-full overflow-hidden rounded-t-2xl bg-white dark:bg-black"},[e("button",{staticClass:"absolute right-0 top-0 z-1000 p-3",attrs:{"aria-label":"Close",type:"button"},on:{click:t.close}},[e("v-icon",{staticClass:"h-3 w-3 cursor-pointer text-gray-light-icons dark:text-white",attrs:{name:"x"}})],1),t._v(" "),e("div",{staticClass:"!absolute bottom-0 left-0 z-0 grid h-[300px] w-[165px] grid-cols-3 grid-rows-4"},t._l(t.gridAvatars,(function(t){return e("v-avatar",{key:t.id,staticClass:"h-[75px] w-[55px]",attrs:{url:t.avatar_thumbnail,"blur-hash":t.avatar_blur_hash}})})),1),t._v(" "),e("div",{staticClass:"relative z-1 ml-[120px] flex h-[300px] w-full flex-col items-center gap-5 bg-gradient-to-r from-transparent via-gray-icons via-[50px] to-gray-icons pl-6 pr-2 pt-5"},[e("p",{staticClass:"text-center text-xl font-semibold uppercase text-primary-400"},[t._v("\n        "+t._s(t.__("modal.buy_subscription_or_top_up.pay_as_you_go.title"))+"\n      ")]),t._v(" "),e("ul",{staticClass:"flex flex-col gap-3"},[e("li",{staticClass:"flex items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md bg-primary-400"},[e("v-icon",{staticClass:"h-4 w-4",attrs:{name:"check"}})],1),t._v(" "),e("span",[t._v(t._s(t.__("modal.buy_subscription_or_top_up.pay_as_you_go.feature_1")))])]),t._v(" "),e("li",{staticClass:"flex items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md bg-primary-400"},[e("v-icon",{staticClass:"h-4 w-4",attrs:{name:"check"}})],1),t._v(" "),e("span",[t._v(t._s(t.__("modal.buy_subscription_or_top_up.pay_as_you_go.feature_2")))])]),t._v(" "),e("li",{staticClass:"flex items-center gap-2 font-semibold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md bg-primary-400"},[e("v-icon",{staticClass:"h-4 w-4",attrs:{name:"check"}})],1),t._v(" "),e("span",[t._v(t._s(t.__("modal.buy_subscription_or_top_up.pay_as_you_go.feature_3")))])]),t._v(" "),e("li",{staticClass:"flex items-center gap-2 text-lg font-bold text-white"},[e("span",{staticClass:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md bg-primary-400"},[e("v-icon",{staticClass:"h-4 w-4",attrs:{name:"check"}})],1),t._v(" "),e("span",[t._v(t._s(t.__("modal.buy_subscription_or_top_up.pay_as_you_go.feature_4")))])])]),t._v(" "),e("v-button",{staticClass:"whitespace-nowrap !px-16",attrs:{variant:"primary"},on:{click:t.topup}},[e("span",{staticClass:"uppercase"},[t._v(t._s(t.__("modal.buy_subscription_or_top_up.pay_as_you_go.cta")))]),t._v(" "),e("v-icon",{staticClass:"h-5 w-5 shrink-0",attrs:{name:"arrow-right-circle"}})],1),t._v(" "),e("button",{staticClass:"text-sm font-semibold uppercase text-white underline",on:{click:t.switchModal}},[t._v("\n        "+t._s(t.__("modal.buy_subscription_or_top_up.pay_as_you_go.switch"))+"\n      ")])],1)])])}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=9080.js.map?id=8102150b264efdb5