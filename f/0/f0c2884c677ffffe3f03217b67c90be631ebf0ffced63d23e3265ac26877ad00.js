(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[135],{"6nNX":function(n,l,e){"use strict";e.r(l),e.d(l,"AppGalleryModuleNgFactory",(function(){return sl}));var t=e("keVe"),i=e("4/We"),a=e("+ucO"),r=function(){eturn n.prototype.ngOnInit=function(){this.allAppsHeaderText=this.appGalleryConfigService.config.resources.allApps,this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh},n.prototype.trackByCategoryId=function(n,l){return l.Id},n.prototype.trackByWorkloadId=function(n,l){return l.Id},n.prototype.onTabClicked=n}(),o=r,s=function(){return function(){}}(),u=e("fYis"),c=e("g/dT"),p=e("W3Zz"),d=e("hhzZ"),f=e("TOqr"),h=e("7IJ8"),m=e("QhWD"),g=e("cgnd"),b=e("casz"),v=e("RsrG"),k=e("6Po3"),y=e("WLAd"),w=e("pzhl"),C=e("PkQn"),I=e("R0N1"),_=e("/I02"),S=e("QjXU"),x=e("BJFG"),W=e("uzn7"),A=e("w1PR"),G=e("TIi1"),T=e("hoyd"),L=e("PBJH"),P=e("HQCr"),H=e("lUkk"),N=e("Dn7E"),F=function(){eturn n.prototype.instrumentAppListClick=function(n,l,e,t){n.IsThirdParty&&this.workloadsService.updateUsedThirdPartyApps(n),this.instrumentAppClick(n,l,e,d.b.AppList,null,n.Referral,t)},n.prototype.instrumentAppListLearnMoreClick=function(n,l,e){this.instrumentLearnMoreClick(n,l,e,d.b.AppList,null,n.Referral)},n.prototype.instrumentAppClick=function(n,l,e,t,i,a,r){var o={};n&&(o.State=e?"displayed":"folded",o.ReferralType=this.workloadsService.getReferralType(n).toString()),i&&i.length&&(o.ItemCategory=i),r||(a="");var s=this.convertGuidToBucketName(a,n);this.instrumentationService.logClickEvent("AppGallery_Click",l,t,s,"Native"===r?"Native":"Web",o,void 0,void 0,n.InAppNav),Object(P.a)(l,"AppList",n.Referral)},n.prototype.convertGuidToBucketName=function(n,l){return l.IsThirdParty?"Dynamics"===l.CollectorId?-1!==n.indexOf("/Microsoft.PowerApps/apps/")?"PowerAppsApp":"DynamicsApp":"Graph"===l.CollectorId?"ThirdPartyApp":n:n},n.prototype.instrumentLearnMoreClick=function(n,l,e,t,i,a){var r={};n&&(r.State=e?"displayed":"folded"),i&&i.length&&(r.ItemCategory=i),a&&a.length&&(r.LearnMoreTarget=a),this.instrumentationService.logClickEvent("AppGallery_LearnMoreClick",l,t,null,null,r),Object(H.a)({eventName:"AppGallery_LearnMoreClick",id:l,area:"AppList",result:"Navigate",target:"LearnMoreButton"}),a&&a.length&&Object(N.a)({featureName:"AppGallery",eventName:"LearnMoreLinkClick",params:{ElementId:l,LearnMoreTarget:a},area:"AppList"})},n.Éµprov=t.kc({factory,token:n,providedIn:"root"}),n}(),O="office-365-apps",M="more-microsoft-365-apps",E="business-apps",j="customer-workspace",R="allapps",B=function(){function n(n,l,e,t,i,a,r,o,s,u,c){this.appGalleryConfigService=n,this.appGalleryInstrumentationService=l,this.appLauncherService=e,this.capabilitiesService=t,this.contextService=i,this.deviceDetector=a,this.localStorageService=r,this.locService=o,this.themingService=s,this.urlLauncherService=u,this.workloadsService=c,this.fluentBackground="transparent",this.description=""}return n.prototype.ngOnInit=function(){var n=this,l=this.appGalleryConfigService.config.resources,e=this.appGalleryConfigService.config.learnMoreLinks;this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((function(l){n.appColor=l&&n.app.ChangeColorInDarkMode?"Dynamics"===n.app.CollectorId?"transparent":"white":""})));var t=this.app.Id[0].toLowerCase()+this.app.Id.slice(1);switch(this.workspaceId===E?this.description=this.app.SubText:l[t+"Description"]?this.description=l[t+"Description"]:this.app.Title&&(this.description=this.app.Title),this.learnMore=this.locService.LearnMore,this.learnMoreLink=e["LearnMoreLink"+this.app.Id.slice("Shell".length)],this.id=this.createId(this.app.AppId,this.workspaceId),this.learnMoreLinkId="app-gallery-"+this.app.Id+"-learnmorelink",this.learnMoreLinkAriaLabel=this.locService.format(this.locService.LearnMoreAboutApp,this.app.Text),this.thirdPartyIconAriaLabel=this.locService.format(this.locService.ThirdPartyIconAriaLabel,this.app.Text),this.isMobile=this.deviceDetector.isMobileDevice(),this.view){case"List":this.isListView=!0;break;case"TileWithDescription":this.isTileWithDescriptionView=!0;break;default:this.isTileView=!0}},n.prototype.ngOnChanges=function(n){if(n.hasOwnProperty("view"))switch(this.isListView=!1,this.isTileView=!1,this.isTileWithDescriptionView=!1,this.view){case"List":this.isListView=!0;break;case"TileWithDescription":this.isTileWithDescriptionView=!0;break;default:this.isTileView=!0}},n.prototype.ngOnDestroy,n.prototype.onAppItemClick=function(n){var l=this;n.preventDefault(),this.app.IsNativeClientOnlyApp&&this.localStorageService.set("AppClicked_"+this.app.Id,!0);var t="_blank"===this.contextService.sharedContext.defaultLinkTarget,i=this.convertToSafeElementId(this.id,this.app);t||(this.workloadsService.pinWorkload(this.app),this.appGalleryInstrumentationService.instrumentAppListClick(this.app,i,this.displayedOnHomePage,"Web")),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([e.e(0),e.e(1),e.e(2),e.e(3),e.e(4),e.e(5)]).then(e.bind(null,"DZQ9")).then((function(e){e.launchApp({action:"OpenGalleryItem",event:n,appName:l.app.Text,url:l.app.Url}).then((function(n){t&&(l.workloadsService.pinWorkload(l.app),l.appGalleryInstrumentationService.instrumentAppListClick(l.app,i,l.displayedOnHomePage,n.result))}))})):this.appLauncherService.launchApp(this.app,n,"OpenGalleryItem").then((function(n){t&&(l.workloadsService.pinWorkload(l.app),l.appGalleryInstrumentationService.instrumentAppListClick(l.app,i,l.displayedOnHomePage,n))}))},n.prototype.onLearnMoreLinkClick=function(n){var l=this;n.preventDefault(),n.stopPropagation(),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([e.e(0),e.e(1),e.e(2),e.e(3),e.e(4),e.e(5)]).then(e.bind(null,"DZQ9")).then()):this.urlLauncherService.openUrl(this.learnMoreLink,"OpenLearnMoreLink"),this.appGalleryInstrumentationService.instrumentAppListLearnMoreClick(this.app,this.learnMoreLinkId,this.displayedOnHomePage)},n.prototype.onFocus=function(){this.itemFocused=!0},n.prototype.onBlur,n.prototype.onIconLoad=function(){var n=this;setTimeout((function(){n.iconLoaded=!0}))},n.prototype.onIconError,n.prototype.ariaLabel,n.prototype.createId=function(n,l){if(!n)return null;var e="app-gallery-"+n;return l&&(e+="-"+this.getWorkspaceId(l)),e},n.prototype.getWorkspaceId=function(n){return n!==O&&n!==M&&n!==E&&n!==R?j:n},n.prototype.convertToSafeElementId=function(n,l){var e,t;if(!l.IsThirdParty)return n;var i=[O,M,E,R,j],a=-1;try{for(var r=Object(S.__values)(i),o=r.next();!o.done;o=r.next()){var s=n.indexOf("-"+o.value);if(-1!==s){a=s;break}}}catch(n){e={error:n}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}if(-1===a)return"";var u=n.substring("app-gallery-".length,a);return n.replace(u,this.appGalleryInstrumentationService.convertGuidToBucketName(u,l))},n}(),D=t.Fb({encapsulation:2,styles:[],data:{}});function U(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","app-gallery__icon__fix"],["size","40"]],null,null,null,w.b,w.a)),t.Gb(1,638976,null,0,C.a,[i.a],{cssClass:[0,"cssClass"],iconFontCssClass:[1,"iconFontCssClass"],iconFontName:[2,"iconFontName"],size:[3,"size"]},null)],(function(n,l){var e=l.component;n(l,1,0,"app-gallery__icon__fix",e.app.IconUnicodeCodepointCssClass,e.app.IconFont,"40")}),null)}function q(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,0,"img",[["aria-hidden","true"],["class","app-gallery-item__workspace-item__image"]],[[8,"hidden",0],[8,"src",4]],[[null,"load"],[null,"error"]],(function(n,l,e){var t=!0,i=n.component;return"load"===l&&(t=!1!==i.onIconLoad()&&t),"error"===l&&(t=!1!==i.onIconError()&&t),t}),null,null))],null,(function(n,l){var e=l.component;n(l,0,0,!e.iconLoaded,e.app.ThirdPartyIcon)}))}function z(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"div",[["class","app-gallery-item__workspace-item__description--flag"]],null,null,null,null,null)),(n()(),t.gc(1,null,[""," "]))],null,(function(n,l){n(l,1,0,l.component.description)}))}function $(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,2,"span",[["class","app-gallery-item__workspace-item__learn-more-link--flag ms-bgc-g40-h ms-bgc-g40-f ms-fcl-tp"],["data-clicklog","custom"],["role","link"],["tabindex","0"]],[[8,"id",0],[1,"data-href",0],[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"]],),null,null)),(n()(),t.Hb(1,0,null,null,1,"ohp-icon-font",[["iconFontName","CircleInfo"],["size","16"]],null,null,null,w.b,w.a)),t.Gb(2,638976,null,0,C.a,[i.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],),))}function V(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,16,"div",[["class","app-gallery-item__workspace-item-holder app-gallery-item__workspace-item-holder--flag"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,15,"a",[["class","app-gallery-item__workspace-item list-item--shadowed ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f app-gallery-item__workspace-item--flag"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"click"]],(function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.onAppItemClick(e)&&t),t}),null,null)),t.Gb(2,81920,null,0,I.a,[_.a],null,null),(n()(),t.Hb(3,0,null,null,6,"div",[["class","app-gallery-item__workspace-item__icon-holder app-gallery-item__workspace-item__icon-holder--flag"]],null,null,null,null,null)),t.Gb(4,278528,null,0,f.n,[t.o,t.y,t.K],{ngStyle:[0,"ngStyle"]},null),t.Zb(5,{color:0}),(n()(),t.qb(16777216,null,null,1,null,U)),t.Gb(7,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(16777216,null,null,1,null,q)),t.Gb(9,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.Hb(10,0,null,null,4,"div",[["class","app-gallery-item__workspace-item__text ms-fcl-nd app-gallery-item__workspace-item__text--flag"]],null,null,null,null,null)),(n()(),t.Hb(11,0,null,null,1,"div",[["class","app-gallery-item__workspace-item__title--flag"]],[[8,"title",0]],null,null,null,null)),(n()(),t.gc(12,null,["",""])),(n()(),t.qb(16777216,null,null,1,null,z)),t.Gb(14,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(16777216,null,null,1,null,$)),t.Gb(16,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(n,l){var e=l.component;n(l,2,0);var t=n(l,5,0,e.appColor||e.app.Color);n(l,4,0,t),n(l,7,0,!e.app.ThirdPartyIcon||!e.iconLoaded),n(l,9,0,e.app.ThirdPartyIcon),n(l,14,0,e.description),n(l,16,0,e.learnMoreLink)}),(function(n,l){var e=l.component;n(l,1,0,e.id,e.app.Url,e.ariaLabel(),t.Wb(l,2).target),n(l,11,0,e.app.Text),n(l,12,0,e.app.Text)}))}function Z(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,3,"ohp-icon-font",[["cssClass","app-gallery__icon__fix"],["size","40"]],null,null,null,w.b,w.a)),t.Gb(1,278528,null,0,f.n,[t.o,t.y,t.K],{ngStyle:[0,"ngStyle"]},null),t.Zb(2,{color:0}),t.Gb(3,638976,null,0,C.a,[i.a],{cssClass:[0,"cssClass"],iconFontCssClass:[1,"iconFontCssClass"],iconFontName:[2,"iconFontName"],size:[3,"size"]},null)],(function(n,l){var e=l.component,t=n(l,2,0,e.appColor||e.app.Color);n(l,1,0,t),n(l,3,0,"app-gallery__icon__fix",e.app.IconUnicodeCodepointCssClass,e.app.IconFont,"40")}),null)}function K(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,2,"img",[["aria-hidden","true"],["class","app-gallery-item__workspace-item__image"]],[[8,"hidden",0],[8,"src",4]],[[null,"load"],[null,"error"]],),null,null)),t.Gb(1,278528,null,0,f.n,[t.o,t.y,t.K],{ngStyle:[0,"ngStyle"]},null),t.Zb(2,{"background-color":0})],(function(n,l){var e=l.component,t=n(l,2,0,"Dynamics"===e.app.CollectorId?e.appColor||e.app.Color:"");n(l,1,0,t)}),(function(n,l){var e=l.component;n(l,0,0,!e.iconLoaded,e.app.ThirdPartyIcon)}))function Q(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,14,"div",[["class","app-gallery-item__workspace-item-holder app-gallery-item__workspace-item-holder--tile"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,13,"a",[["class","app-gallery-item__workspace-item list-item--shadowed ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f app-gallery-item__workspace-item--tile"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"click"]],),null,null)),t.Gb(2,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Zb(3,{"app-gallery-item__workspace-item--tile-expand":0}),t.Gb(4,81920,null,0,I.a,[_.a],null,null),(n()(),t.Hb(5,0,null,null,4,"div",[["class","app-gallery-item__workspace-item__icon-holder app-gallery-item__workspace-item__icon-holder--tile"]],null,null,null,null,null)),(n()(),t.qb(16777216,null,null,1,null,Z)),t.Gb(7,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(16777216,null,null,1,null,K)),t.Gb(9,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.Hb(10,0,null,null,4,"div",[["class","app-gallery-item__workspace-item__text ms-fcl-nd app-gallery-item__workspace-item__text--tile"]],null,null,null,null,null)),(n()(),t.Hb(11,0,null,null,1,"div",[["class","app-gallery-item__workspace-item__title--tile"]],[[8,"title",0]],null,null,null,null)),(n()(),t.gc(12,null,["",""])),(n()(),t.qb(16777216,null,null,1,null,J)),t.Gb(14,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(n,l){var e=l.component,t=n(l,3,0,e.description);n(l,2,0,"app-gallery-item__workspace-item list-item--shadowed ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f app-gallery-item__workspace-item--tile",t),n(l,4,0),n(l,7,0,!e.app.ThirdPartyIcon||!e.iconLoaded),n(l,9,0,e.app.ThirdPartyIcon),n(l,14,0,e.isTileWithDescriptionView)}),(function(n,l){var e=l.component;n(l,1,0,e.id,e.app.Url,e.ariaLabel(),t.Wb(l,4).target),n(l,11,0,e.app.Text),n(l,12,0,e.app.Text)}))}function Y(n){return t.jc(0,[(n()(),t.qb(16777216,null,null,1,null,V)),t.Gb(1,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(16777216,null,null,1,null,Q)),t.Gb(3,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],),null)}t.Db("ohp-app-gallery-item",B,(function(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"ohp-app-gallery-item",[],null,null,null,Y,D)),t.Gb(1,770048,null,0,B,[a.a,F,x.a,i.a,_.a,p.c,W.a,L.a,A.b,G.a,T.a],null,null)],(function(n,l){n(l,1,0)}),null)}),{app:"app",displayedOnHomePage:"displayedOnHomePage",view:"view",workspaceId:"workspaceId"},{},[]);var X=e("AlWG"),nn=function(){function n(){this.behaviorSubject=new X.a([]),this.batchSize=1,this.index=0,this.itemsToBatchRender=[],this.renderedItems=[]}return n.prototype.transform=function(n,l){return void 0===l&&(l=1),this.itemsToBatchRender===n&&this.batchSize===l||this.resetPipe(n,l),this.behaviorSubject.asObservable()},n.prototype.addItems=function(){var n=this;if(!this.itemsToBatchRender[this.index])return this.itemsToBatchRender.length<this.renderedItems.length&&this.renderedItems.splice(this.index,this.renderedItems.length),void this.behaviorSubject.next(this.renderedItems);var l=this.itemsToBatchRender.slice(this.index,this.index+this.batchSize);l.forEach()),this.index+=l.length,this.behaviorSubject.next(this.renderedItems),this.timeout=setTimeout((function(){return n.addItems()}),0)},n.prototype.resetPipe=function(n,l){var e=this;this.timeout&&clearTimeout(this.timeout),this.itemsToBatchRender!==n&&(this.itemsToBatchRender=n,this.renderedItems=this.itemsToBatchRender.slice(0,this.index)),this.batchSize!==l&&(this.batchSize=l),this.timeout=setTimeout(),0)},n}(),ln=e("CudY"),en=e("7Gwk"),tn=e("BaAg"),an=e("7wk3"),rn=e("Uqr9"),on=e("lrJm"),sn=e("R7NL"),un=e("oAX+"),cn=e("kpuN"),pn=e("wwmn"),dn=function(n){function l(l,e,t,i,a,r,o,s,u,c){var p=n.call(this,l,a,i,"MyApps",t,r,o,c)||this;return p.globalErrorHandler=s,p.startupConfigService=u,p.getExpandedWorkspacesUrl=(p.inMockMode?p.contextService.sharedContext.officeHomeApiRoot:e.config.myApplicationsUrl)+"/api/me/getExpandedAssignedWorkspaces",p.startupConfig=p.startupConfigService.config,p}return Object(S.__extends)(l,n),l.prototype.getWorkspaces=function(){var n=this;return this.workspacesDataStream||(this.workspacesDataStream=un.a.createResultsWithCacheObservable(this.fetchExpandedAssignedWorkspaces("cache-only"),this.fetchExpandedAssignedWorkspaces("network-first"),null,))),this.workspacesDataStream},l.prototype.createRequestConfig=function(){var n=new Map([["x-ms-tenant-id",this.startupConfig.tenantId],["x-ms-user-id",this.startupConfig.objectId],["x-ms-tenant-region",this.startupConfig.tenantRegionScope||""],["accept-language",this.contextService.sharedContext.officeMarket.toLowerCase()]]);return this.startupConfig.dataBoundary&&n.set("x-ms-tdbr",this.startupConfig.dataBoundary),{headers:n}},l.prototype.fetchExpandedAssignedWorkspaces=function(n){var l=this;return new Promise((function(e,t){var i=l.createRequestConfig();l.get("Expanded_Workspaces_Request","Expanded_Workspaces",l.getExpandedWorkspacesUrl.toString(),(function(i){i.then((function(l){var i=l.data;i?e({workspaces:i,fromCache:"cache-only"===n}):t()})).catch())}),(function(n){return t("Failed to get Expanded Workspaces. Status Code: "+(n&&n.httpResponse?n.httpResponse.status:""))}),i,n)}))},l.Éµprov=t.kc({factory:function(){return new l(t.lc(cn.b),t.lc(a.a),t.lc(_.a),t.lc(sn.a),t.lc(d.a),t.lc(pn.a),t.lc(f.q),t.lc(on.b),t.lc(g.b),t.lc(b.a))},token:l,providedIn:"root"}),l}(e("pOWU").a),fn=e("UVAO"),hn=function(){function n(n,l,e,t,i,a,r,o,s){this.appGalleryConfigService=n,this.browserPaintMeasurementService=l,this.capabilitiesService=e,this.contextService=t,this.performanceService=i,this.startupConfigService=a,this.workloadsService=r,this.workspaceNavService=o,this.workspacesService=s,this.animationEndEvent="appGalleryListReady",this.componentArea=d.b.AppCategory,this.flagView="List",this.tileView="Tile",this.firstPaintRecorded=!1,this.firstDataReadyRecorded=!1,this.moreMicrosoftApps=["Bing","MSN","Privacy","Rewards"]}return n.prototype.ngOnInit=function(){this.bottomTrayEnabled=this.capabilitiesService.capabilities.bottomTrayEnabled,this.displayedApps="",this.workspaces=[],this.workspaceNavItems=[],this.isConsumer=this.startupConfigService.config.authType===g.a.MSA,this.altaBrandingChangesEnabled=this.capabilitiesService.capabilities.altaBrandingChangesEnabled,this.workspaceBatches=this.appGalleryConfigService.config.workspaceBatches,this.createFirstPartyWorkspace(),this.isConsumer&&this.createMoreFromMicrosoftWorkspace(),this.createCustomerWorkspaces(),this.capabilitiesService.capabilities.showBusinessApps&&this.createDynamicsWorkspace()},n.prototype.ngOnDestro},n.prototype.getBatchSiz},n.prototype.trackByWorkspaceId=function(n,l){return l.id},n.prototype.trackByWorkloadI},n.prototype.getWorkloads=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var n,l=this;return Object(S.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.workloadsService.getProvisionedWorkloads(),this.workloadsService.getAdditionalWorkloads()])];case 1:return[2,(n=e.sent())[0].concat(n[1]).filter((function(n){return!n.IsThirdParty})).sort((function(n,e){return l.compareWorkloadText(n.Text,e.Text)}))]}}))}))},n.prototype.createMoreFromMicrosoftWorkspace=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var n,l=this;return Object(S.__generator)(this,(function(e){return n=this.appGalleryConfigService.config.resources,this.getWorkloads().then((function(e){if((e=e.filter}))).length){var t={id:M,name:n.moreFromMicrosoftText,description:n.moreFromMicrosoftText,apps:e,isFirstPartyWorkspace:!0,viewType:"List",showHeader:!0};l.addWorkspace(t,{id:t.id,name:t.name}),l.workspaceNavService.updateWorkspaceNavItems(l.workspaceNavItems)}})),[2]}))}))},n.prototype.createDynamicsWorkspace=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var n=this;return Object(S.__generator)(this,(function(l){return this.thirdPartyWorkloadsSubscription=this.workloadsService.getThirdPartyWorkloads().subscribe((function(l){if(l.length>0){var e=l.filter((function(n){return"Dynamics"===n.CollectorId})).slice(0,n.appGalleryConfigService.config.numberOfBusinessApps?n.appGalleryConfigService.config.numberOfBusinessApps-1:0);if(e.length){var t=n.workspaces.find((function(n){return n.id===E}));t?t.apps=e:(n.addWorkspace(t={id:E,name:n.appGalleryConfigService.config.resources.businessAppsTabTitle,description:n.appGalleryConfigService.config.resources.businessAppsTabTitle,apps:e,isFirstPartyWorkspace:!1,viewType:"TileWithDescription",isBusinessAppsWorkspace:!0,showHeader:!0},{id:t.id,name:t.name},R),n.workspaceNavService.updateWorkspaceNavItems(n.workspaceNavItems))}}})),[2]}))}))},n.prototype.createFirstPartyWorkspace=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var n,l=this;return Object(S.__generator)(this,(function(e){return n=this.appGalleryConfigService.config.resources,this.getWorkloads().then((function(e){if(l.isConsumer&&(e=e.filter}))),e.length){l.displayedApps=l.workloadsService.getDisplayedApps(e),l.storeWorkload=e.find})),l.firstPartyWorkspaceName=l.altaBrandingChangesEnabled?n.microsoft365Text:n.office365Text;var t={id:O,name:l.firstPartyWorkspaceName,description:l.firstPartyWorkspaceName,apps:e.filter((function(n){return"ShellOfficeStore"!==n.Id})),isFirstPartyWorkspace:!0,viewType:"List",showHeader:!1};l.workspaces.unshift(t),l.workspaceNavItems.unshift({id:t.id,name:t.name}),l.workspaceNavService.updateWorkspaceNavItems(l.workspaceNavItems)}l.firstDataReadyRecorded||(l.performanceService.mark("AppGallery_FirstData_Ready"),l.firstDataReadyRecorded=!0),l.firstPaintRecorded||(l.browserPaintMeasurementService.recordWhenPainted("AppGallery"),l.firstPaintRecorded=!0)})),[2]}))}))},n.prototype.createCustomerWorkspaces=function(){var n=this;if(this.isConsumer)return null;var l=this.workspacesService.getWorkspaces();this.workspacesSubscription=l.results.subscribe((function(l){var e=l.workspaces,t=e.findIndex((function(n){return n.id===R}));if(t>-1){var i=e.splice(t,1)[0];e.push(i)}e&&e.length?e.forEach((function(l){var e=n.workspaces.find((function(n){return n.id===l.id})),t=l.id===R&&n.appGalleryConfigService.config.filterAllAppsFirstPartyEnabled?l.apps.filter})):l.apps;if(t.sort})),t.length){var i=t.filter})).map((function(l){var e,t=l.isMicrosoftFirstParty?"Shell"+l.id.split("|")[1]:l.appId;return{Color:l.fontColor,Id:t,AppId:null!==(e=l.servicePrincipalId)&&void 0!==e?e:t,CollectorId:l.isMicrosoftFirstParty?"FirstParty":"Graph",Title:l.description,Text:l.displayName,Url:l.redirectUrl?l.redirectUrl.trim():"",IconUnicodeCodepointCssClass:"ms-fcl-tp ms-Icon ms-Icon--OfficeAddinsLogo",ThirdPartyIcon:l.logoUrl?l.logoUrl:null,Referral:t,IsThirdParty:!l.isMicrosoftFirstParty,InAppNav:!!l.isMicrosoftFirstParty&&n.workloadsService.getInAppNav(t),FileType:l.isMicrosoftFirstParty?n.workloadsService.getFileType(t):tn.b.Unknown,getId:function(){return t}}}));if(e)e.apps=i;else{var a={id:(e={id:l.id,name:l.id!==R?l.name:n.appGalleryConfigService.config.resources.allApps,description:l.description,apps:i,isFirstPartyWorkspace:!1,viewType:"Tile",showHeader:!0}).id,name:e.name};a.id!==R?n.addWorkspace(e,a,E):n.appGalleryConfigService.config.ecsAppGalleryUpdatesEnabled||n.addWorkspace(e,a)}}else if(e){var r=n.workspaces.findIndex}));n.workspaces.splice(r,1),n.workspaceNavItems=n.workspaceNavItems.filter}))}})):n.workspaces&&(n.workspaces=n.workspaces.filter((function(n){return n.id===O})),n.workspaceNavItems=n.workspaceNavItems.filter((function(n){return n.id===O}))),n.workspaceNavService.updateWorkspaceNavItems(n.workspaceNavItems)}))},n.prototype.compareWorkloadText=function(n,l){return n&&l?n.localeCompare(l,["en-us",this.contextService.sharedContext.officeMarket]):n&&!l?-1:!n&&l?1:0},n.prototype.addWorkspace=function(n,l,e){var t=e?this.workspaceNavItems.findIndex})):-1;t>=0?(this.workspaces.splice(t,0,n),this.workspaceNavItems.splice(t,0,l)):(this.workspaces.push(n),this.workspaceNavItems.push(l))},n}(),mn=t.Fb({encapsulation:2,styles:[],data:{}});function gn(n){return t.jc(0,[(n()(),t.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),t.Gb(1,475136,null,0,h.a,[m.a,t.W,d.a,g.b,b.a,v.a,k.a,t.F,y.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),t.Zb(2,{componentArea:0,appFilter:1}),(n()(),t.qb(0,null,null,0))],(function(n,l){var e=n(l,2,0,l.component.componentArea,"Office");n(l,1,0,"install#InstallModule",e)}),null)}function bn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,4,"div",[["class","list-header app-gallery__workspaces-header"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,1,"h2",[["class","list-header__title ms-fcl-nd"]],null,null,null,null,null)),(n()(),t.gc(2,null,["",""])),(n()(),t.qb(16777216,null,null,1,null,gn)),t.Gb(4,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(n,l){n(l,4,0,l.parent.context.$implicit.isFirstPartyWorkspace&&!l.component.isConsumer)})}))}function vn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,4,"div",[["role","listitem"]],null,null,null,null,null)),t.Gb(1,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(2,{"app-gallery__workspace-tile--flag":0,tiles__container:1}),(n()(),t.Hb(3,0,null,null,1,"ohp-app-gallery-item",[],null,null,null,Y,D)),t.Gb(4,770048,null,0,B,[a.a,F,x.a,i.a,_.a,p.c,W.a,L.a,A.b,G.a,T.a],{app:[0,"app"],displayedOnHomePage:[1,"displayedOnHomePage"],view:[2,"view"],workspaceId:[3,"workspaceId"]},null)],(function(n,l){var e=l.component,t=n(l,2,0,l.parent.parent.context.$implicit.isFirstPartyWorkspace,!l.parent.parent.context.$implicit.isFirstPartyWorkspace);n(l,1,0,t),n(l,4,0,l.context.$implicit,(null==e.displayedApps?null:e.displayedApps.indexOf(l.context.$implicit.Id))>-1,l.parent.parent.context.$implicit.viewType,l.parent.parent.context.$implicit.id)}),null)}function kn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,8,"div",[["role","navigation"],["tabindex","-1"]],[[8,"id",0],[1,"aria-label",0]],null,null,null,null)),(n()(),t.Hb(1,0,null,null,7,"div",[],null,null,null,null,null)),t.Gb(2,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(3,{"tiles-section__container":0}),(n()(),t.Hb(4,0,null,null,4,"div",[["role","list"]],null,null,null,null,null)),t.Gb(5,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(6,{"generic-tile-container app-gallery__workspace-tile-container--flag":0,"fluent-tiles":1}),(n()(),t.qb(16777216,null,null,1,null,vn)),t.Gb(8,278528,null,0,f.j,[t.W,t.S,t.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(n,l){var e=l.component,t=n(l,3,0,!l.parent.context.$implicit.isFirstPartyWorkspace);n(l,2,0,t);var i=n(l,6,0,l.parent.context.$implicit.isFirstPartyWorkspace,!l.parent.context.$implicit.isFirstPartyWorkspace);n(l,5,0,i),n(l,8,0,l.parent.context.$implicit.apps,e.trackByWorkloadId)}),(function(n,l){n(l,0,0,l.parent.context.$implicit.id,l.parent.context.$implicit.description)}))}function yn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),t.Gb(1,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(2,{"app-gallery__workspace-tile--flag":0,tiles__container:1}),(n()(),t.Hb(3,0,null,null,1,"ohp-app-gallery-item",[],null,null,null,Y,D)),t.Gb(4,770048,null,0,B,[a.a,F,x.a,i.a,_.a,p.c,W.a,L.a,A.b,G.a,T.a],{app:[0,"app"],displayedOnHomePage:[1,"displayedOnHomePage"],view:[2,"view"],workspaceId:[3,"workspaceId"]},null)],(function(n,l){var e=l.component,t=n(l,2,0,l.parent.parent.context.$implicit.isFirstPartyWorkspace,!l.parent.parent.context.$implicit.isFirstPartyWorkspace);n(l,1,0,t),n(l,4,0,l.context.$implicit,(null==e.displayedApps?null:e.displayedApps.indexOf(l.context.$implicit.Id))>-1,l.parent.parent.context.$implicit.viewType,l.parent.parent.context.$implicit.id)}),null)}function wn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,10,"div",[["role","navigation"],["tabindex","-1"]],[[8,"id",0],[1,"aria-label",0]],null,null,null,null)),(n()(),t.Hb(1,0,null,null,9,"div",[],null,null,null,null,null)),t.Gb(2,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(3,{"tiles-section__container":0}),(n()(),t.Hb(4,0,null,null,6,"div",[],null,null,null,null,null)),t.Gb(5,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(6,{"generic-tile-container app-gallery__workspace-tile-container--flag":0,"fluent-tiles":1}),(n()(),t.qb(16777216,null,null,3,null,yn)),t.Gb(8,278528,null,0,f.j,[t.W,t.S,t.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),t.Yb(0,nn,[]),t.Yb(131072,f.b,[t.h])],(function(n,l){var e=l.component,i=n(l,3,0,!l.parent.context.$implicit.isFirstPartyWorkspace);n(l,2,0,i);var a=n(l,6,0,l.parent.context.$implicit.isFirstPartyWorkspace,!l.parent.context.$implicit.isFirstPartyWorkspace);n(l,5,0,a),n(l,8,0,t.hc(l,8,0,t.Wb(l,10).transform(t.hc(l,8,0,t.Wb(l,9).transform(l.parent.context.$implicit.apps,e.getBatchSize(l.parent.context.$implicit.isFirstPartyWorkspace))))),e.trackByWorkloadId)})}))}function Cn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,7,"div",[["class","section section--fluent"]],[[1,"aria-label",0],[2,"section--expanding",null]],[[null,"animationend"],[null,"webkitAnimationEnd"],[null,"oanimationend"]],(function(n,l,e){var i=!0;return"animationend"===l&&(i=!1!==t.Wb(n,1).onAnimationEnd(e)&&i),"webkitAnimationEnd"===l&&(i=!1!==t.Wb(n,1).onWebkitAnimationEnd(e)&&i),"oanimationend"===l&&(i=!1!==t.Wb(n,1).onOAnimationEnd(e)&&i),i}),null,null)),t.Gb(1,81920,null,0,ln.a,[en.a],{endEvent:[0,"endEvent"],initiallyExpanding:[1,"initiallyExpanding"]},null),(n()(),t.qb(16777216,null,null,1,null,bn)),t.Gb(3,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(16777216,null,null,1,null,kn)),t.Gb(5,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(16777216,null,null,1,null,wn)),t.Gb(7,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(n,l){var e=l.component;n(l,1,0,e.animationEndEvent,!e.bottomTrayEnabled),n(l,3,0,l.context.$implicit.showHeader),n(l,5,0,!e.workspaceBatches),n(l,7,0,e.workspaceBatches)}),(function(n,l){n(l,0,0,l.context.$implicit.description,t.Wb(l,1).expanding)}))}function In(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,2,"div",[["id","app-gallery-workspaces"],["role","region"]],null,null,null,null,null)),(n()(),t.qb(16777216,null,null,1,null,Cn)),t.Gb(2,278528,null,0,f.j,[t.W,t.S,t.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(n,l){var e=l.component;n(l,2,0,e.workspaces,e.trackByWorkspaceId)}),null)}t.Db("ohp-app-gallery-workspaces",hn,(function(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"ohp-app-gallery-workspaces",[],null,null,null,In,mn)),t.Gb(1,245760,null,0,hn,[a.a,an.a,i.a,_.a,rn.b,g.b,T.a,fn.a,dn],null,null)],(function(n,l){n(l,1,0)}),null)}),{},{},[]);var _n=function(}return n.prototype.ngOnIni},n.prototype.onCardClick=function(){event.defaultPrevented||"function"==typeof this.card.logClick&&this.card.logClick(this.card.id)},n}(),Sn=t.Fb({encapsulation:2,styles:[],data:{}});function xn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,2,"div",[["class","list-item__text--large list-item__title ms-fcl-nd"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,1,"span",[],[[8,"id",0],[8,"title",0]],null,null,null,null)),(n()(),t.gc(2,null,["",""]))],null,(function(n,l){var e=l.component;n(l,1,0,t.Ob(1,"",e.card.id,"-item-title"),e.card.title),n(l,2,0,e.card.title)}))}function Wn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,16,"div",[["class","list-item__body"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,15,"a",[["class","carousel-card__link"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[8,"target",0]],[[null,"click"]],(function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.onCardClick()&&t),t}),null,null)),t.Gb(2,81920,null,0,I.a,[_.a],null,null),(n()(),t.Hb(3,0,null,null,13,"div",[["class","document-card carousel-card carousel-card__top-spacer"]],null,null,null,null,null)),t.Gb(4,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Zb(5,{"list-item--shadowed ms-bgc-w ms-bgc-w-h":0,"document-card--fluent":1}),(n()(),t.Hb(6,0,null,null,3,"div",[["aria-hidden","true"],["class","document-card__thumbnail-container"]],null,null,null,null,null)),(n()(),t.Hb(7,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null)),(n()(),t.Hb(8,0,null,null,1,"div",[["class","document-card__thumbnail-wrapper"]],null,null,null,null,null)),(n()(),t.Hb(9,0,null,null,0,"img",[["aria-hidden","true"],["class","document-card__thumbnail"],["data-clicklog","custom"]],[[8,"src",4],[8,"alt",0]],null,null,null,null)),(n()(),t.Hb(10,0,null,null,6,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),(n()(),t.Hb(11,0,null,null,5,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),(n()(),t.qb(16777216,null,null,1,null,xn)),t.Gb(13,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.Hb(14,0,null,null,2,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(n()(),t.Hb(15,0,null,null,1,"span",[],[[8,"id",0]],null,null,null,null)),(n()(),t.gc(16,null,["",""]))],(function(n,l){var e=l.component;n(l,2,0);var t=n(l,5,0,!e.fluentRefresh,e.fluentRefresh);n(l,4,0,"document-card carousel-card carousel-card__top-spacer",t),n(l,13,0,e.card.title)}),(function(n,l){var e=l.component;n(l,1,0,t.Ob(1,"",e.card.id,"-link"),e.card.url,t.Wb(l,2).target),n(l,9,0,e.card.image,e.card.imageAltText),n(l,15,0,t.Ob(1,"",e.card.id,"-item-description")),n(l,16,0,e.card.subtitle)}))}t.Db("ohp-carousel-card",_n,(function(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"ohp-carousel-card",[],null,null,null,Wn,Sn)),t.Gb(1,114688,null,0,_n,[i.a],null,null)],(function(n,l){n(l,1,0)}),null)}),{card:"card"},{},[]);var An=e("KoFE"),Gn=e("9c4X"),Tn=e("WJRI"),Ln=e("kVgv"),Pn=e("DCBR"),Hn=e("hZW2"),Nn=t.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:":enter",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:"{{ opacity }}"},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"150ms",opacity:.5}}},options:{params:{fadeInDuration:"500ms",opacity:1}}},options:null}],options:{}}]}});function Fn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,10,"div",[["class","carousel-nav"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,4,"button",[["class","icon-button first-arrow"],["data-clicklog","custom"]],[[8,"title",0],[1,"aria-label",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"click"]]}),null,null)),t.Gb(2,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Zb(3,{"icon-button--disabled":0}),(n()(),t.Hb(4,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronLeft"],["size","16"]],null,null,null,w.b,w.a)),t.Gb(5,638976,null,0,C.a,[i.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(n()(),t.Hb(6,0,null,null,4,"button",[["class","icon-button"],["data-clicklog","custom"]],[[8,"title",0],[1,"aria-label",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"click"]]}),null,null)),t.Gb(7,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Zb(8,{"icon-button--disabled":0}),(n()(),t.Hb(9,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronRight"],["size","16"]],null,null,null,w.b,w.a)),t.Gb(10,638976,null,0,C.a,[i.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(n,l){var e=l.component,t=n(l,3,0,0===e.currentCarouselPage);n(l,2,0,"icon-button first-arrow",t),n(l,5,0,"carousel-nav__arrow","ChevronLeft","16",!0);var i=n(l,8,0,e.currentCarouselPage+e.cardIncrement>=e.cards.length);n(l,7,0,"icon-button",i),n(l,10,0,"carousel-nav__arrow","ChevronRight","16",!0)}),(function(n,l){var e=l.component;n(l,1,0,e.previousPage,e.previousPage,0===e.currentCarouselPage,0===e.currentCarouselPage?-1:0),n(l,6,0,e.nextPage,e.nextPage,e.currentCarouselPage+e.cardIncrement>=e.cards.length,e.currentCarouselPage+e.cardIncrement>=e.cards.length?-1:0)}))}function On(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,2,"div",[["class","carousel-card-container carousel-card--touch"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,1,"ohp-carousel-card",[],null,null,null,Wn,Sn)),t.Gb(2,114688,null,0,_n,[i.a],{card:[0,"card"]},null)],(function(n,l){n(l,2,0,l.context.$implicit)}),null}function En(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,2,"div",[["class","carousel-card-container carousel-card--desktop"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,1,"ohp-carousel-card",[],null,null,null,Wn,Sn)),t.Gb(2,114688,null,0,_n,[i.a],{card:[0,"card"]},null)],(function(n,l){n(l,2,0,l.context.$implicit)}),null)}function jn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,3,null,null,null,null,null,null,null)),(n()(),t.qb(16777216,null,null,2,null,En)),t.Gb(2,278528,null,0,f.j,[t.W,t.S,t.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),t.Yb(0,f.r,[]),(n()(),t.qb(0,null,null,0))],(function(n,l){var e=l.component;n(l,2,0,t.hc(l,2,0,t.Wb(l,3).transform(e.cards,e.currentCarouselPage,e.currentCarouselPage+e.cardIncrement)),e.trackByIndex)}),null)}function Rn(n){return t.jc(0,[(n()(),t.Hb(0,0,[[2,0],["carouselContainer",1]],null,16,"div",[["class","carousel"]],[[8,"id",0],[24,"@fadeIn",0],[24,"@.disabled",0],[1,"aria-label",0]],null,null,null,null)),(n()(),t.Hb(1,0,null,null,4,"div",[["class","list-header list-header--carousel"]],null,null,null,null,null)),(n()(),t.Hb(2,0,null,null,1,"h3",[["class","list-header__title list-header__title--carousel ms-fcl-nd"]],null,null,null,null,null)),(n()(),t.gc(3,null,["",""])),(n()(),t.qb(16777216,null,null,1,null,Fn)),t.Gb(5,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.Hb(6,0,null,null,10,"div",[["role","navigation"],["tabindex","-1"]],[[8,"id",0],[1,"aria-label",0]],null,null,null,null)),t.Gb(7,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(8,{"carousel--outer":0}),(n()(),t.Hb(9,0,[[1,0],["carouselElement",1]],null,7,"div",[],null,[[null,"ohpResize"]]}),null,null)),t.Gb(10,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(11,{"carousel--inner":0,"generic-tile-container generic-tile-container--card carousel-card__content":1,"carousel-card__content--four-cards-max":2}),t.Gb(12,4407296,null,0,An.a,[Gn.a,t.o,k.a],null,{resize:"ohpResize"}),(n()(),t.qb(16777216,null,null,1,null,Mn)),t.Gb(14,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(16777216,null,null,1,null,jn)),t.Gb(16,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(n,l){var e=l.component;n(l,5,0,!(e.canSwipe||0===e.currentCarouselPage&&e.currentCarouselPage+e.cardIncrement>=e.cards.length));var t=n(l,8,0,e.canSwipe);n(l,7,0,t);var i=n(l,11,0,e.canSwipe,!e.canSwipe,!e.canSwipe&&e.fourCardsMax);n(l,10,0,i),n(l,12,0),n(l,14,0,e.canSwipe),n(l,16,0,!e.canSwipe)}),(function(n,l){var e=l.component;n(l,0,0,e.carousel.id,void 0,e.disableAnimation,e.carousel.title),n(l,3,0,e.carousel.title),n(l,6,0,e.carousel.id+"-carousel",e.carousel.title)}))}function Bn(n){return t.jc(0,[t.cc(671088640,1,{carouselElement:0}),t.cc(671088640,2,{carouselContainer:0}),(n()(),t.Hb(2,0,null,null,1,"ohp-title-announcer",[],null,null,null,Tn.b,Tn.a)),t.Gb(3,49152,null,0,Ln.a,[],{announcement:[0,"announcement"]},null),(n()(),t.qb(16777216,null,null,1,null,Rn)),t.Gb(5,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)]}),null)}t.Db("ohp-carousel",Pn.a,(function(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"ohp-carousel",[],null,null,null,Bn,Nn)),t.Gb(1,114688,null,0,Pn.a,[i.a,t.h,p.c,Hn.a,d.a,L.a],null,null)],(function(n,l){n(l,1,0)}),null)}),{carousel:"carousel",navClickLogging:"navClickLogging",fourCardsMax:"fourCardsMax",isSuggestedActions:"isSuggestedActions",componentArea:"componentArea"},{},[]);var Dn=function(}return n.prototype.ngOnInit=function(){var n=this;this.componentArea=d.b.AppCategory,this.appGalleryConfigService.getCategory().then((function(l){if(l&&l.Apps){var e=l.Apps.map((function(l){return{id:l.Id,title:l.Title,subtitle:l.AppName,url:l.URL,image:l.NarrowImage,imageAltText:"",logClic}}}));n.carousel={id:"app-gallery-"+l.Id+"-category",title:l.Name,cards:e},n.logCardImpressions(),n.workspaceNavService.addRecommendedCategoryNavItem(n.carousel.title,n.carousel.id+"-carousel")}}))},n.prototype.logCarouselNavClick=function(n,l){this.instrumentationService.logClickEvent("AppGallery_Nav_Click",l,d.b.AppCategory,null,null,n)},n.prototype.logCardClick=function(n){this.instrumentationService.logClickEvent("AppGallery_Click","app-gallery-"+this.appGalleryConfigService.config.categoryId+"-"+n+"-link",d.b.AppCategory)},n.prototype.logCardImpressions=function(){var n=this;this.carousel.cards.forEach((function(l,e){var t={};t.ElementId=l.id,t.Index=e.toString(),t.Area=n.componentArea,n.instrumentationService.logImpressionEvent("AppGallery_Card_Impression",t)}))},n}(),Un=t.Fb({encapsulation:2,styles:[],data:{}});function qn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,3,"div",[],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,2,"div",[["class","section section--fluent"]],null,null,null,null,null)),(n()(),t.Hb(2,0,null,null,1,"ohp-carousel",[],null,null,null,Bn,Nn)),t.Gb(3,114688,null,0,Pn.a,[i.a,t.h,p.c,Hn.a,d.a,L.a],{carousel:[0,"carousel"],navClickLogging:[1,"navClickLogging"],fourCardsMax:[2,"fourCardsMax"],componentArea:[3,"componentArea"]},null)],(function(n,l){var e=l.component;n(l,3,0,e.carousel,e.logCarouselNavClick,!0,e.componentArea)}),null)}function zn(n){return t.jc(0,[(n()(),t.qb(16777216,null,null,1,null,qn)),t.Gb(1,16384,null,0,f.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(n,l){var e=l.component;n(l,1,0,null==e.carousel||null==e.carousel.cards?null:e.carousel.cards.length)}),null)}t.Db("ohp-app-gallery-carousel",Dn,(function(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"ohp-app-gallery-carousel",[],null,null,null,zn,Un)),t.Gb(1,114688,null,0,Dn,[a.a,d.a,fn.a],null,null)],(function(n,l){n(l,1,0)}),null)}),{},{},[]);var $n=t.Fb({encapsulation:2,styles:[],data:{}});function Vn(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,11,"div",[["ohpInstrumentPageView","AppGallery_PageView"],["role","main"]],null,null,null,null,null)),t.Gb(1,81920,null,0,c.a,[p.c,d.a],{pageName:[0,"pageName"]},null),(n()(),t.Hb(2,0,null,null,1,"h1",[["class","visually-hidden"]],null,null,null,null,null)),(n()(),t.gc(3,null,["",""])),(n()(),t.Hb(4,0,null,null,7,"div",[],null,null,null,null,null)),t.Gb(5,278528,null,0,f.i,[t.x,t.y,t.o,t.K],{ngClass:[0,"ngClass"]},null),t.Zb(6,{"width-restrictor width-restrictor--responsive width-restrictor--workspaces":0,"width-restrictor--no-gutter":1}),(n()(),t.Hb(7,0,null,null,1,"ohp-app-gallery-workspaces",[],null,null,null,In,mn)),t.Gb(8,245760,null,0,hn,[a.a,an.a,i.a,_.a,rn.b,g.b,T.a,fn.a,dn],null,null),(n()(),t.Hb(9,0,null,null,2,"div",[["class","app-gallery__workspaces__padding"]],null,null,null,null,null)),(n()(),t.Hb(10,0,null,null,1,"ohp-app-gallery-carousel",[],null,null,null,zn,Un)),t.Gb(11,114688,null,0,Dn,[a.a,d.a,fn.a],null,null)],(function(n,l){var e=l.component;n(l,1,0,"AppGallery_PageView");var t=n(l,6,0,!e.fluentRefresh,e.fluentRefresh);n(l,5,0,t),n(l,8,0),n(l,11,0)})}))}var Zn=t.Db("ohp-app-gallery",r,(function(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"ohp-app-gallery",[],null,null,null,Vn,$n)),t.Gb(1,114688,null,0,r,[a.a,i.a],null,null)]}),null)}),{},{},[]),Kn=e("xIlw"),Jn=e("+a0u"),Qn=e("lQwO"),Yn=e("ej7j"),Xn=e("+P5Z"),nl=e("L9A/"),ll=e("CfLe"),el=e("X+PR"),tl=e("VY7U"),il=e("T6pR"),a}(),rl=e("izKO"),ol=e("CCRL"),sl=t.Eb(s,[],(function(n){return t.Tb([t.Ub(512,t.k,t.hb,[[8,[u.a,Zn]],[3,t.k],t.D]),t.Ub(4608,f.m,f.l,[t.z]),t.Ub(1073742336,f.c,f.c,[]),t.Ub(1073742336,Kn.a,Kn.a,[]),t.Ub(1073742336,Jn.a,Jn.a,[]),t.Ub(1073742336,Qn.a,Qn.a,[]),t.Ub(1073742336,Yn.a,Yn.a,[]),t.Ub(1073742336,Xn.a,Xn.a,[]),t.Ub(1073742336,nl.a,nl.a,[]),t.Ub(1073742336,ll.a,ll.a,[]),t.Ub(1073742336,el.o,el.o,[[2,el.u],[2,el.n]]),t.Ub(1073742336,tl.a,tl.a,[]),t.Ub(1073742336,il.a,il.a,[]),t.Ub(1073742336,al,al,[]),t.Ub(1073742336,rl.a,rl.a,[]),t.Ub(1073742336,s,s,[]),t.Ub(256,ol.a,o,[])])}))},CudY:function(n,l,e){"use strict";e.d(l,"a",(function(){return t})),e("7Gwk");var t=function(}return n.prototype.onAnimationEnd=function(n){this.handleEvent(n)},n.prototype.onWebkitAnimationEnd=function(n){this.handleEvent(n)},n.prototype.onOAnimationEn},n.prototype.ngOnIni},n.prototype.handleEven},n.prototype.finishLoading=function(){this.expanding=!1,this.endEvent&&this.eventService.broadcastEvent({name:this.endEvent,args:[]})},n}()},UVAO:function(n,l,e){"use strict";e.d(l,"a"}));var t=e("AlWG"),i=e("keVe"),a=function(){function n(){this.workspaceNavItems=[],this.workspaceNavItemsSubject=new t.a([])}return n.prototype.addRecommendedCategoryNavItem=function(n,l){this.recommendedCategoryNavItem||(this.recommendedCategoryNavItem={id:l,name:n},this.updateWorkspaceNavItems(this.workspaceNavItems))},n.prototype.getWorkspaceNavItem},n.prototype.updateWorkspaceNavItems=function(n){this.workspaceNavItems=this.recommendedCategoryNavItem?n.concat(this.recommendedCategoryNavItem):n,this.workspaceNavItemsSubject.next(this.workspaceNavItems)},n.Éµprov=i.kc({facton},token:n,providedIn:"root"}),n}()}}]);
//# sourceMappingURL=app-gallery-ag.4bd06da26f9c7936a551.chunk.v7.js.map