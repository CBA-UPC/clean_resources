(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[52],{"5Q+n":function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i=r("lUkk"),n=r("Dn7E"),a=r("rTyw"),s=r("hhzZ"),o=r("p6Zr"),c=r("uUrA"),u=r("unjt"),l=r("keVe"),h=function(){function e(e,t){this.instrumentationService=e,this.searchInstrumentedXhrService=t,this.officeInsightsServiceEndpoint="https://uci.officeapps.live.com/OfficeInsights/Telemetry/V1",this.renderedSearchResults=new Map,this.updateSearchSessionId(),this.contextToEventMapper={"AllSearchPanel.AppSearchResult.onClick":function(){return[{itemCategory:"Result",knownArea:s.b.SearchResults,searchProviderType:"All",searchResultType:"App",event:"Search_Click",elementId:"MSA_Serp_App",pageNav:!0}]},"AllSearchPanel.TriageFileSearchResult.onClick":function(){return[{itemCategory:"Result",knownArea:s.b.SearchResults,searchProviderType:"All",searchResultType:"File",event:"Search_Click",elementId:"MSA_Serp_File",pageNav:!0}]},"AllSearchPanel.TemplateSearchResult.onClick":function(){return[{itemCategory:"Result",knownArea:s.b.SearchResults,searchProviderType:"All",searchResultType:"Template",event:"Search_Click",elementId:"MSA_Serp_Template",pageNav:!0}]},"FilesSearchPanel.TriageFileSearchResult.onClick":function(){return[{itemCategory:"Result",knownArea:s.b.SearchResults,searchProviderType:"File",searchResultType:"File",event:"Search_Click",elementId:"MSA_Serp_File",pageNav:!0}]},"TemplatesSearchPanel.TemplateSearchResult.onClick":function(){return[{itemCategory:"Result",knownArea:s.b.SearchResults,searchProviderType:"Template",searchResultType:"Template",event:"Search_Click",elementId:"MSA_Serp_Template",pageNav:!0}]},"CustomRefinersContainer.onRefinerClick":function(e){var t,r;switch(e.filterId){case"all_FileType":t="All",r="all_FileType";break;case"docs_FileType":t="File",r="docs_FileType";break;case"templates_TemplateType":t="Template",r="templates_TemplateType";break;default:t=null,r=null}return[{itemCategory:"Filter_Open",knownArea:s.b.SearchResults,searchProviderType:t,searchResultType:r,event:"Search_Capability",elementId:null,pageNav:!1}]},"CustomRefinersContainer.applyRefiner":function(e){var t;switch(e.filterId){case"all_FileType":t="All";break;case"docs_FileType":t="File";break;case"templates_TemplateType":t="Template";break;default:t=null}return[{itemCategory:"Filter_Submit",knownArea:s.b.SearchResults,searchProviderType:t,searchResultType:null,event:"Search_Capability",elementId:null,pageNav:!1}]},"VerticalFiltersRoot.VerticalFilters.changeAndLog":function(e){var t;switch(e.verticalId){case"main":t="All";break;case"docs":t="File";break;case"templates":t="Template";break;default:t=null}return[{itemCategory:"Vertical_Change",knownArea:s.b.SearchResults,searchProviderType:t,searchResultType:null,event:"Search_Capability",elementId:null,pageNav:!1}]},ResultsRendered:function(e){var t;switch(e.verticalId){case"main":t="All";break;case"docs":t="File";break;case"templates":t="Template";break;default:t=null}return[{itemCategory:"Data_Fetch_Latency",knownArea:s.b.SearchResults,searchProviderType:t,searchResultType:null,event:"Search_Performance",elementId:null,pageNav:null},{itemCategory:"E2E_Latency",knownArea:s.b.SearchResults,searchProviderType:t,searchResultType:null,event:"Search_Performance",elementId:null,pageNav:null}]}}}return e.prototype.logSearchClickEvent=function(e,t,r,o,c,u,l,h,p){var d={Action:"Click"};d.SearchProviderType=e,d.SearchResultType=o||e,d.SearchTargetId=c,d.SearchSessionId=this.searchSessionId,d.Index=h,this.instrumentationService.logClickEvent("Search_Click",t,s.b.SearchSuggestions,u,p||this.referralPlatform,d,void 0,l,r),Object(i.a)({eventName:"Search_Click",id:t,area:s.b.SearchSuggestions,result:u?"Refer":"Navigate",target:u?Object(a.a)(u):s.b.SearchSuggestions}),d.Area=s.b.SearchSuggestions,d.ElementId=t,d.Referral=u,d.ReferralPlatform=p||this.referralPlatform,Object(n.a)({featureName:"Search",eventName:"Search_Click",params:d})},e.prototype.logSearchTextInfo=function(e){var t={};t.SearchCharacterCount=this.searchText.length,t.SearchSessionId=this.searchSessionId,t.SearchQueryId=++this.searchQueryId,this.instrumentationService.logGenericEvent("Search_Query",t,void 0,e),Object(n.a)({featureName:"Search",eventName:"Search_Query",params:t},e)},e.prototype.logSearchTextId=function(e){var t=this;this.getSearchTextIdPromise().then(().catch((function(){t.sentSearchTextLog(!1,void 0,e)}))},e.prototype.logRenderedSearchResults=function(){var e=this;this.renderedSearchResults.forEach((function(t,r){if(t.length>0){var i={};i.SearchSessionId=e.searchSessionId,i.SearchProviderType=r,i.SearchResultType=JSON.stringify(t),i.Area=s.b.SearchResults,e.instrumentationService.logGenericEvent("Search_Rendered_Results",i),Object(n.a)({featureName:"Search",eventName:"Search_Rendered_Results",params:i})}})),this.renderedSearchResults.clear()},e.prototype.logSerpEvent=function(e,t,r){var s,o,c=this;void 0===t&&(t="");var u=e.properties||{},l=this.contextToEventMapper[e.nameDetail||e.name];if(void 0!==l){var h=l({filterId:null===(s=null==u?void 0:u.options)||void 0===s?void 0:s.RefinerId,verticalId:(null==u?void 0:u.VerticalId)||(null===(o=null==u?void 0:u.options)||void 0===o?void 0:o.itemKey)}),p={};h.forEach((function(e){switch(p.SearchProviderType=e.searchProviderType,p.ItemCategory=e.itemCategory,p.SearchResultType=e.searchResultType,p.SearchSessionId=c.searchSessionId,e.itemCategory){case"Data_Fetch_Latency":p.Latency=null==u?void 0:u.DataFetchLatency;break;case"E2E_Latency":p.Latency=null==u?void 0:u.E2ELatency}"Result"===e.itemCategory?(c.instrumentationService.logClickEvent(e.event,e.elementId,e.knownArea.toString(),t||c.getReferralFromEventData(u.eventData),r,p,void 0,void 0,e.pageNav),Object(i.a)({id:e.elementId,area:e.knownArea.toString(),result:t?"Refer":"Navigate",target:t?Object(a.a)(t):"Other"}),p.Area=e.knownArea.toString(),p.ElementId=e.elementId,p.Referral=t||c.getReferralFromEventData(u.eventData),p.ReferralPlatform=r,Object(n.a)({featureName:"Search",eventName:e.event,params:p})):(p.Area=e.knownArea.toString(),c.instrumentationService.logGenericEvent(e.event,p),Object(n.a)({featureName:"Search",eventName:e.event,params:p}))}))}},e.prototype.sentSearchTextLog=function(e,t,r){var i={};i.SearchCharacterCount=this.searchText.length,i.SearchSessionId=this.searchSessionId,i.SearchQueryId=this.searchQueryId,i.Action=this.searchSubmitted?"Submit":null,e?void 0!==t&&void 0!==t.Index?i.SearchTargetId=t.Index:(i.Error="Returned data is undefined",i.SearchTargetId=-2):(i.Error="Failed to get query index",i.SearchTargetId=-2),this.instrumentationService.logGenericEvent("Search_Query",i,void 0,r),Object(n.a)({featureName:"Search",eventName:"Search_Query",params:i},r)},e.prototype.getSearchSessionId=e.prototype.updateSearchSessionId=function(){this.searchSessionId=c.a.createGuid(),this.searchQueryId=0,this.searchSubmitted=!1},e.prototype.updateSearchText=e.prototype.setSearchReferralPlatform=e.prototype.setSearchSubmittedAction=e.prototype.getSearchTextIdPromise=function(){var e=new Map;e.set("Content-Type","application/json"),e.set("Accept","application/json"),e.set("x-clientuseragent","OfficeHomeMSA"),e.set("x-correlationid",this.searchSessionId);var t={url:this.officeInsightsServiceEndpoint,headers:e};return this.searchInstrumentedXhrService.sendIntrumentedPostRequest("OfficeInsights_Search_Telemetry_Request","OfficeInsights_Search_Telemetry",this.officeInsightsServiceEndpoint,JSON.stringify({Text:this.searchText,IsFileHash:!1}),t)},e.prototype.setRenderedProviderResults=e.prototype.getReferralFromEventData=function(e){return e?-1!==(e=e.toLocaleLowerCase()).indexOf("excel")?o.a.Excel:-1!==e.indexOf("powerpoint")?o.a.PowerPoint:-1!==e.indexOf("word")?o.a.Word:-1!==e.indexOf("onenote")?o.a.OneNote:-1!==e.indexOf("pdf")?"PDF".toString():"":""},e.ɵprov=l.kc({factory,token:e,providedIn:"root"}),e}()},"83kx":function(e,t,r){"use strict";r.d(t,"a",)),r.d(t,"b",(function(){return p}));var i=r("QjXU"),n=r("keVe"),a=r("3g20"),s=r("4/We"),o=r("cgnd"),c=r("JH4S"),u="1.20240119.11.0";function l(e){var t=JSON.parse(e);return t&&t.length>0?t.indexOf("a83ccf3d-4820-4a69-9283-6f793e44d6c1")>=0?"1.20240109.3.0":t.indexOf("6ded6549-58b7-4559-9e47-9ef5b6fd20de")>=0?"1.20240115.4.0":t.indexOf("1041f01d-eb3e-4308-a1f3-bd5a1ef6c13e")>=0?"1.20240119.11.1":t.indexOf("15e6fc28-5073-4537-ad2d-d43874ed2b18")>=0?"1.20240119.11.2":t.indexOf("0ebe9573-985c-43e3-accd-de821cdda6e3")>=0?"1.20240119.11.3":u:u}var h=r("N5xN"),p=function(){function e(e,t,r,i){var n=this;this.searchConfigService=e,this.capabilitiesService=t,this.clientStartupConfigService=r,this.userContextService=i,this.searchPageModule=new Promise((function(e){return n.resolveSearchPageModule=e})),this.microsoftSearchBootstrapperUrlOverridesEnabled=this.searchConfigService.config.microsoftSearchBootstrapperUrlOverridesEnabled,this.microsoftSearchBootstrapperKillSwitchesActive=this.searchConfigService.config.microsoftSearchBootstrapperKillSwitchesActive,this.hostAppId=this.getHostAppId(),this.cdnOptions=this.getCdnOptions(),this.loadModules()}return e.prototype.getLokiEnvironment=function(){return Object(n.eb)()?"Df":this.resolveLokiEnvironment()},e.prototype.resolveLokiEnvironment=function(){switch(this.getSearchEnvironment()){case"test":return"Df";case"prodbubble":return"Msit";case"gcc":return"GccModerate";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gallatin":return"Gallatin";case"prod":default:return"Prod"}},e.prototype.getSearchEnvironment=function(){var e=this.searchConfigService.config.complianceEnvironment;return this.userContextService.user.isGcc&&"prod"===e?"gcc":e},e.prototype.getHostAppId=function(){return this.clientStartupConfigService.config.authType===o.a.MSA?e.consumerClientId:this.capabilitiesService.capabilities.isPwaInUwp&&this.capabilitiesService.capabilities.nativeSearchInHeaderEnabled?e.uwpClientId:e.clientId},e.prototype.getCdnOptions,e.prototype.loadModules=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getBootstrappedSearchModules()];case 1:return e=t.sent(),this.preloadBootstrapperModules(e),this.resolveSearchPageModule(e),[2]}}))}))},e.prototype.preloadBootstrapperModules,e.prototype.getBootstrappedSearchModules=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([r.e(96),r.e(662)]).then(r.bind(null,"Q8nR"))];case 1:return[4,t.sent().loadSearchPage({loadingPattern:"deepLink",cdnOptions:this.cdnOptions,hostAppId:this.hostAppId,preferredVersion:l(this.microsoftSearchBootstrapperKillSwitchesActive),isUrlOverridingEnabled:this.microsoftSearchBootstrapperUrlOverridesEnabled})];case 2:return e=t.sent(),[2,Promise.resolve(e)]}}))}))},e.clientId="officehome",e.uwpClientId="officehomeuwp",e.consumerClientId="officehomemsa",e.ɵprov=n.kc({factor},token:e,providedIn:"root"}),e}()},BMc1:function(e,t,r){"use strict";r.d(t,"a",(function(){return Q}));var i=r("QjXU"),n=r("8ZJz"),a=r("/4mZ"),s=r("If7d"),o=r("mXGw"),c=r("ICP0"),u=r("dpyN"),l=r("lrJm"),h=r("3g20"),p=r("vXf5"),d=r("Vwd8"),S=r("BaAg"),g=r("H90i"),f=r("7Rc8"),v=r("W3Zz"),m=r("7Gwk"),b=r("Z0U4"),C=r("n826"),y=r("casz"),P=r("w1PR"),k=r("hoyd"),x=r("4/We"),T=r("cgnd"),R=r("/I02"),_=r("JH4S"),w=r("REHs"),I=r("IYwM"),A=r("6nG3"),O=r("LQqy"),E=r("keVe"),U=function(}return e.prototype.createSettings=function(){var e=this.searchConfigService.config;return{"searchux.clientSideRelevance":e.clientSideRelevanceEnabled,"searchux.isCrossGeoEnabled":!0,"searchux.isResourceLoggingEnabled":!0,"searchux.useSearchApp":!1,"searchux.useSearchBoxInTheSuiteNav":e.searchInHeaderEnabled}},e.ɵprov=E.kc({facto)},token:e,providedIn:"root"}),e}(),M=r("ZRHl"),L=r("hGaZ"),F=functiona}return e.prototype.createSettings=function(e,t,r){var n=["OfficeComPeople"];return this.searchConfigService.config.serpSpellCheckEnabled&&n.push("SPOBingSpeller"),Object(i.__assign)(Object(i.__assign)({},this.loggerSettingsService.createSettings()),{"searchux.answerBlock":this.searchConfigService.config.fastBingAnswerResultsEnabled,"searchux.answerBlockExperiment":this.searchConfigService.config.fastBingAnswerResultsEnabled,"searchux.api.sharePoint.url":this.contextService.sharedContext.sharePointResourceId,"searchux.clientId":e,"searchux.clientVersion":"officehomeweb","searchux.component.TriageNewsSearchResult.previewEnabled":!1,"searchux.currentLanguage":this.contextService.sharedContext.officeMarketLcid,"searchux.debug":this.clientStartupConfigService.config.angularDebugInfoEnabled,"searchux.enabled":!0,"searchux.environment":t,"searchux.isTokenBasedFileThumbnailsEnabled":!0,"searchux.isTokenBasedProfileImagesEnabled":!0,"searchux.locale":this.contextService.sharedContext.officeMarket,"searchux.substrateSearchClientFlights":n.join(","),"searchux.substrateSuggestionsScenario":"officehome","searchux.use3SEcho":!1,"searchux.use3SFileSuggestions":!0,"searchux.use3SPeopleSuggestions":!0,"searchux.use3SSiteSuggestions":!0,"searchux.useSearchBoxInTheSuiteNavExperiment":this.searchConfigService.config.searchInHeaderEnabled,"searchux.useSubstrateSearch":this.searchConfigService.config.fastUseSubstrateEnabled,"searchux.userPrincipalName":this.clientStartupConfigService.config.userPrincipalName,"searchux.userEmail":this.clientStartupConfigService.config.userPrincipalName,"searchux.userRing":"Local","searchux.enableQueryRules":this.searchConfigService.config.fastEnableQueryRules,"searchux.noSourceIdForFiles":!0,"searchux.enableStartQuery":!1,"searchux.isVideoVerticalEnabled":!1,"searchux.instrumenter":r,"searchux.excludeBestBets":!1,"searchux.showDYM":this.searchConfigService.config.serpSpellCheckEnabled,"searchux.isOfficePwaInUwp":this.capabilitesService.capabilities.isPwaInUwp,"searchux.isKillSwitchActivated":function(e){return"db164519-2dc9-4095-8727-98f1914f6572"===e}})},e.prototype.createSettingsForConsumerSERP=function(e,t,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n={"searchux.clientId":e,"searchux.clientSideRelevance":!1,"searchux.clientVersion":"officehomeweb","searchux.currentLanguage":this.contextService.sharedContext.officeMarketLcid,"searchux.enableConfiguredOOBRefiners":!0,"searchux.enabled":!0,"searchux.environment":t,"searchux.isConsumerAllVerticalEnabled":!0,"searchux.isConsumerFileVerticalEnabled":!0,"searchux.isConsumerTemplateVerticalEnabled":!0,"searchux.instrumenter":r,"searchux.isCrossGeoEnabled":!1,"searchux.locale":this.contextService.sharedContext.officeMarket,"searchux.use3SFileSuggestions":!1,"searchux.use3SPeopleSuggestions":!1,"searchux.use3SSiteSuggestions":!1,"searchux.userPrincipalName":this.clientStartupConfigService.config.userPrincipalName,"searchux.userEmail":this.clientStartupConfigService.config.userPrincipalName,"searchux.userRing":"Local","searchux.useSearchApp":!1,"searchux.isContextualRailEnabled":!0,"searchux.shouldTemplateVerticalShowPremiumTemplates":this.searchConfigService.config.premiumTemplatesForSearchEnabled},a="searchux.isSubscribedUser",[4,this.isPaidConsumer()];case 1:return[2,(n[a]=i.sent(),n["searchux.isKillSwitchActivatede},n["searchux.officeApps"]=this.getApps,n["searchux.isConsumerAppResultEnabled"]=this.searchConfigService.config.appResultsInConsumerSerpEnabled,n)]}}))}))},e.prototype.isPaidConsumer=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.clientStartupConfigService.config.authType!==T.a.MSA?[3,2]:[4,this.consumerInstallConfigService.getCurrentSku()];case 1:return[2,null!==(e=t.sent())&&!(e===A.b.NonActive||e===A.b.NotSubscribed||e===A.b.NotDetected||e===A.b.Perpetual||e===A.b.Perpetual2019)];case 2:return[2,!1]}}))}))},e.prototype.getApps=function(e){var t=new M.a,r=new L.a,i=[];return t.addAppResults(e,i),r.addGoToResults(e,i),i},e.ɵprov=E.kc({factory:function(){return new e(E.lc(x.a),E.lc(O.a),E.lc(R.a),E.lc(h.a),E.lc(T.b),E.lc(U))},token:e,providedIn:"root"}),e}(),D=r("eda8"),j=r("gdDe"),N=r("3Vsh"),B=function(){function e(){}return e.prototype.createStream=function(t){return j.Observable.fromPromise(e.sharepointSitesService.getSharePointSites().results.pipe(Object(N.a)(1)).toPromise().then((function(e){return e?Object(i.__spread)(e.FrequentSites,e.FollowingSites).map((function(e){return{id:e.Url,url:e.Url,title:e.Title,icon:e.BannerImageUrl,type:"site",secondaryDisplayText:e.Url}})):[]}))).select((function(e){return e.filter((function(e){return!t||e.title&&-1!==e.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase().trim())}))})).selectMany((function(e){return j.Observable.fromArray(e)}))},e.prototype.getId=function(){return"SitesFastSuggestionProvider"},e}(),X=functio){}return e.prototype.createStream=function(t){return j.Observable.fromPromise(e.workloadsService.getThirdPartyWorkloads().pipe(Object(N.a)(1)).toPromise().then((function(e){return e?e.map((function(e){return{id:e.Id,url:e.Url,title:e.Text,iconClass:e.ThirdPartyIcon?"":e.IconUnicodeCodepointCssClass,iconUrl:e.ThirdPartyIcon,type:"app"}})):[]}))).select((function(e){return e.filter((function(e){return!t||e.title&&-1!==e.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase().trim())}))})).selectMany((function(e){return j.Observable.fromArray(e)}))},e.prototype.getId=function(){return"ThirdPartyAppsFastSuggestionProvider"},e}(),W=r("5Q+n"),G=r("83kx"),H=r("uh00"),z=r("sKtG"),Q=function(){function e(e,t,r,i,a,s,o,c,u,l,h,p,d,S,g,f,v,m,b,C,y,P){var k=this;this.capabilitesService=e,this.clientStartupConfigService=t,this.contextService=r,this.deviceDetector=i,this.eventService=a,this.fastSearchUXInstrumentationService=s,this.mruDataService=o,this.searchConfigService=c,this.searchInstrumentationService=u,this.sharePointSitesService=l,this.themingService=h,this.workloadsService=p,this.globalErrorHandler=d,this.userProfileService=S,this.oneDriveGraphService=g,this.mainSettingsService=f,this.scheduler=v,this.userContextService=m,this.sharedSearchService=b,this.routeService=C,this.searchPageInstrumentationService=y,this.searchPageBootstrapperService=P,this.fastSearchBoxConfigurationName="officehome",this.bingAnswersTokenProvider=this.sharedSearchService.createTokenProvider("BingAnswers"),this.graphTokenProvider=this.sharedSearchService.createTokenProvider("Graph"),this.lokiTokenProvider=this.sharedSearchService.createTokenProvider("Loki"),this.thorTokenProvider=this.sharedSearchService.createTokenProvider("Thor"),this.odsTokenProvider=this.sharedSearchService.createTokenProvider("Ods"),this.tenantFeedbackTokenProvider=this.sharedSearchService.createTokenProvider("TenantFeedback"),this.substrateTokenProvider=this.sharedSearchService.createTokenProvider("QueryFormulation"),this.fastLogEventBuffer=[],this.loadMainModuleInitiated=!1,this.searchUXInitModule=n,this.searchUXMainModule=new Promise((function(e){return k.resolveSearchUXMainModule=e})),this.searchUXDispatcherModule=new Promi=e})),this.pendingBufferRetrievals=1,this.initialize()}return e.prototype.loadMainModule=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,r,n,a,s=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.loadMainModuleInitiated?[2]:(this.loadMainModuleInitiated=!0,[4,this.searchPageInstrumentationService.searchUXInstrumenter]);case 1:return i.sent().mark("SerpConfigStart"),(e=this.getSearchConfigPromise()).then((function(){s.searchPageInstrumentationService.searchUXInstrumenter.then((function(e){e.mark("SerpConfigDone")}))})),e.then((function(e){var t=null==e?void 0:e.ecsSettings;(null==t?void 0:t["searchux.generalFeedback"])&&s.eventService.broadcastEvent({name:"searchUXGeneralFeedbackEnabled",args:[]}),s.eventService.broadcastEvent({name:"isContextualRailEnabled",args:[null==t?void 0:t["searchux.isContextualRailEnabled"]]})})),this.clientStartupConfigService.config.authType!==T.a.MSA&&this.runPrefetchCalls(),[4,this.sharedSearchService.searchUXPrefetchModule];case 2:return[4,(0,i.sent().withBasicMonitor)({monitorName:"main_module_load",monitorType:"generic_qos"},(function(){return s.loadMain().th,e}))}))()];case 3:return t=i.sent(),this.isTestEnv()?[3,6]:(n=(r=t).loadStrings,[4,this.stringMapLoaderPromise]);case 4:return[4,n.apply(r,[i.sent(),this.contextService.sharedContext.officeMarket])];case 5:i.sent(),i.label=6;case 6:return this.capabilitesService.capabilities.nativeSearchInHeaderEnabled?[3,8]:[4,this.initializeSearchBox(t)];case 7:i.sent(),i.label=8;case 8:return[4,e];case 9:return a=i.sent(),this.initializeLoggingModule(t,a),this.initializeMainModule(t,a),[4,this.setSharePointSearchCenterUrl(t)];case 10:return i.sent(),this.eventService.broadcastEvent({name:"searchUXMainModuleLoaded",args:[]}),this.resolveSearchUXMainModule(t),this.eventService.broadcastEvent({name:"exitSearchInSearchBox",args:[t.isExitSearchInSearchBoxEnabled()]}),[2]}}))}))},e.prototype.prepareSearch=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.searchUXMainModule];case 1:return e.sent().prepareSearch("all"),[2]}}))}))},e.prototype.warmut)},e.prototype.getStartQuery=function(e){var t="searchux.enableStartQuery";return e.conf.isRegistered(t)&&e.conf.gets(t)?e.startQuery:void 0},e.prototype.checkDarkModeAndRefreshTheme=function(e){var t=this;this.getSearchConfigPromise().then((function(r){var i,n,a=null==r?void 0:r.ecsSettings,s=(null==a?void 0:a["searchux.isDarkModeAvailable"])||!1;t.eventService.broadcastEvent({name:"darkModeAvailable",args:[s]}),t.searchPageInstrumentationService.searchUXInstrumenter.th})})),!s&&(null===(n=null===(i=e.theme)||void 0===i?void 0:i.reactShellTheme)||void 0===n?void 0:n.IsDarkMode)||t.refreshTheme(e.theme)}))},e.prototype.refreshTheme=function(e){var t,r=e.shades.reduce((function(e,t,r){return e["theme"+p.c[r]]=""+t,e}),{}),n=null===(t=e.grayscaleThemeShades)||void 0===t?void 0:t.reduce((function(e,t,r){return e[(""+p.a[r]).charAt(0).toLowerCase()+(""+p.a[r]).slice(1)]=""+t,e}),{}),a=Object(i.__assign)(Object(i.__assign)({},r),n);Object(s.B)({palette:a,fonts:{medium:{fontFamily:"'SegoeUI', Helvetica, Arial, sans-serif"}}})},e.prototype.isTestEnv=function(){return!!(this.contextService.sharedContext.inMockMode||this.clientStartupConfigService.config.sharedClientStartupContext&&this.clientStartupConfigService.config.sharedClientStartupContext.deploymentEnvironment&&this.clientStartupConfigService.config.sharedClientStartupContext.deploymentEnvironment.indexOf("Ppe")>-1)},e.prototype.runPrefetchCalls=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.searchPageInstrumentationService.searchUXInstrumenter];case 1:return t.sent().mark("SerpPrefetchStart"),this.warmupPersonalData(),this.searchConfigService.config.fastBingAnswerResultsEnabled&&this.sharedSearchService.searchUXPrefetchModule.then((function(t){return t.warmupMsb({token:void 0,clientType:"OfficeSharePoint",msbUrl:t.resolveBingUrl(e.searchPageBootstrapperService.getSearchEnvironment()),tokenProvider:e.bingAnswersTokenProvider})})),this.sharedSearchService.getSearchCenterUrl(this.contextService.sharedContext.graphApiRoot).then((function(t){e.warmup3S(),e.searchConfigService.config.fastUseSubstrateEnabled||e.warmupPersonalRankingContext(t),e.searchPageInstrumentationService.searchUXInstrumenter.th")}))})),[2]}}))}))},e.prototype.warmupPersonalRankingContext=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.fastSearchUXInstrumentationService.setSearchCenterUrlReferral(S.a.referralFromFileLocation(e)),[4,this.sharedSearchService.searchUXPrefetchModule];case 1:return t.sent().fetchPersonalRankingContext({clientId:G.b.clientId,tokenProvider:this.sharedSearchService.sharePointTokenProvider,endpoint:(e||this.contextService.sharedContext.sharePointResourceId)+"/_api/search/query"}),[2]}}))}))},e.prototype.initialize=function(){this.capabilitesService.capabilities.showSearch&&o&&(this.stringMapLoaderPromise=this.getStringMapLoader(this.contextService.sharedContext.officeMarket),this.initializeDispatcher(),this.initializeInitModule(),this.preloadSearchIfEligible())},e.prototype.initializeDispatcher=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=new a.Dispatcher,[4,this.loadSearchDispatcher()];case 1:return t=i.sent(),this.resolveSearchUXDispatcherModule(t),t.setDispatcher(e),e.register((function(e){"USAGE"===e.eventType&&(r.clientStartupConfigService.config.authType===T.a.MSA?r.searchInstrumentationService.logSerpEvent(e):r.fastSearchUXInstrumentationService.searchLogger(e))})),this.fastLogEventBufferUnregisterToken=e.registe)})),[2]}}))}))},e.prototype.initializeInitModule=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.searchPageInstrumentationService.searchUXInstrumenter];case 1:return e=r.sent(),Object(c.a)(this.themingService.themeShades,this.routeService.getRouteChangeEndObservable().pipe(Object(u.a)())).subscribe((function(r){r.theme?t.checkDarkModeAndRefreshTheme(r):e&&e.props.darkModeAvailable&&t.refreshTheme(t.themingService.userTheme)})),this.sharedSearchService.initializePrefetchLibrary(),[2]}}))}))},e.prototype.initializeLoggingModule=function(e,t){var r;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,a,s,o,c,u,l,h,p,d,S,g,f=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return a=(n=this.clientStartupConfigService.config).puid,s=n.tenantId,[4,this.searchPageInstrumentationService.searchUXInstrumenter];case 1:return o=i.sent(),c=[],u={environment:void 0,id:void 0,version:void 0,userRing:this.searchPageInstrumentationService.getRing()},[4,this.searchUXDispatcherModule];case 2:return l=i.sent().getDispatcher(),this.contextService.sharedContext.inMockMode||(h=null==t?void 0:t.ecsSettings["searchux.test1dsLogger"],p=null==t?void 0:t.ecsSettings["searchux.compare1dsLogger"],this.pendingBufferRetrievals+=(d=null==t?void 0:t.ecsSettings["searchux.enable3SEventsLogging"])?1:0,this.pendingBufferRetrievals+=p&&!h?1:0,S=function(){var e=f.fastLogEventBuffer.slice(0);return 1===f.pendingBufferRetrievals&&(f.fastLogEventBuffer.length=0,l.unregister(f.fastLogEventBufferUnregisterToken)),f.pendingBufferRetrievals-=1,e},g={dispatcher:l,instrumenter:o,getBufferedLogEvents:S,logCtx:{appInfo:{id:"@1js/search-page",component:"serp"},userInfo:{id:a,flights:c},hostAppInfo:{id:G.b.clientId,version:"",userRing:this.searchPageInstrumentationService.getRing()},hostComponentInfo:u,tenantInfo:{omsId:s},spInfo:{siteSubscriptionId:""}},disableCookies:!0},h?e.enable1dsLogger(g):(p&&e.enable1dsLogger(g),e.enableAriaLogger(g)),d&&(null===(r=e.enable3SEventsLogger)||void 0===r||r.call(e,{dispatcher:l,instrumenter:o,getBufferedLogEvents:S,logCtx:{userInfo:{id:a},hostAppInfo:{id:G.b.clientId,version:"",userRing:this.searchPageInstrumentationService.getRing()},tenantInfo:{omsId:s}},tokenProvider:this.substrateTokenProvider}))),[2]}}))}))},e.prototype.warmupPersonalData=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return(e=this.contextService.sharedContext.sharePointResourceId)?[3,1]:[2];case 1:return-1===e.indexOf("office.com")?[3,3]:[4,this.searchUXDispatcherModule];case 2:(t=r.sent().getDispatcher())&&t.dispatch({name:"generic_error",nameDetail:"InvalidSharePointResourceId",eventType:"USAGE",properties:{}}),r.label=3;case 3:return this.searchConfigService.config.fetchPersonalData?[4,this.sharedSearchService.searchUXPrefetchModule]:[3,5];case 4:r.sent().fetchPersonalData({tokenProvider:this.sharedSearchService.sharePointTokenProvider,url:e+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties?$select=AccountName,PersonalUrl,UserUrl"}),r.label=5;case 5:return[2]}}))}))},e.prototype.getSearchConfigPromise=function(){return this.isTestEnv()||this.clientStartupConfigService.config.authType===T.a.MSA||!this.searchConfigService.config.fastUseEcsSettingsOverride?Promise.resolve(void 0):this.fetchLokiSearchConfiguration()},e.prototype.fetchLokiSearchConfiguration=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.sharedSearchService.searchUXPrefetchModule];case 1:return e=i.sent(),[4,this.sharedSearchService.getSearchCenterUrl(this.contextService.sharedContext.graphApiRoot)];case 2:return t=i.sent(),r="/search"===t?this.contextService.sharedContext.sharePointResourceId+"/search":t,[2,e.fetchAndParseSearchConfiguration({clientType:g.a,environment:this.searchPageBootstrapperService.getLokiEnvironment(),tokenProvider:this.lokiTokenProvider,thorTokenProvider:this.thorTokenProvider,useThor:this.searchConfigService.config.useThorEnabled,useSimpleRequest:this.searchConfigService.config.useSimpleRequest,additionalHeaders:{"X-MSSearchComponent":"SERP"},warmupCallOptions:{userContextUrl:r,scenario:"officehome"}})]}}))}))},e.prototype.initializeMainModule=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,n,a,s,o,c,u,l;return Object(i.__generator)(this,(function(h){switch(h.label){case 0:return[4,this.searchPageInstrumentationService.searchUXInstrumenter];case 1:return r=h.sent(),this.clientStartupConfigService.config.authType!==T.a.MSA?[3,3]:(n=[{}],[4,this.mainSettingsService.createSettingsForConsumerSERP(G.b.consumerClientId,this.getEnvironment(),r)]);case 2:return a=i.__assign.apply(void 0,n.concat([h.sent()])),e.conf.setsFromObject(a),e.exposeDebugInterface("mssearchux.officeHomeMSA",{version:e.version,conf:e.conf,ecsConfig:t}),[3,6];case 3:return a=Object(i.__assign)(Object(i.__assign)({},this.mainSettingsService.createSettings(G.b.clientId,this.getEnvironment(),r)),{"searchux.api.bingForBusiness.tokenProvider":this.bingAnswersTokenProvider,"searchux.api.sharePoint.tokenProvider":this.sharedSearchService.sharePointTokenProvider,"searchux.api.shareDialog.tokenProvider":this.sharedSearchService.sharePointTokenProvider,"searchux.api.graphMicrosoft.tokenProvider":this.graphTokenProvider,"searchux.api.autoSuggest.tokenProvider":this.sharedSearchService.substrateSearchServiceTokenProvider,"searchux.api.delegateAutoSuggest.tokenProvider":this.sharedSearchService.substrateSearchServiceTokenProvider,"searchux.api.loki.tokenProvider":this.lokiTokenProvider,"searchux.api.thor.tokenProvider":this.thorTokenProvider,"searchux.api.ods.tokenProvider":!this.userContextService.user.isGcc&&this.odsTokenProvider,"searchux.api.tenantFeedback.tokenProvider":this.tenantFeedbackTokenProvider,"searchux.xAnchorMailbox":this.sharedSearchService.getXAnchorMailbox()}),t&&t.ecsSettings&&t.ecsSettings.useEcsSettings?(s=Object(i.__assign)({},t.ecsSettings),[4,this.sharedSearchService.searchUXPrefetchModule]):[3,5];case 4:o=h.sent(),c=o.getEcsIds(t.ecsConfigIds),u=a["searchux.substrateSearchClientFlights"],l=[s["searchux.isRelatedPeopleEnabled"]&&s["searchux.relatedPeopleClientFlight"]].filter(Boolean),a=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},a),{"searchux.api.loki.url":t.lokiUrl,"searchux.userAadObjectId":t.userAadObjectId,"searchux.tenantAadObjectId":t.tenantAadObjectId}),c&&{"searchux.ecsConfigIds":c}),s),{"searchux.substrateSearchClientFlights":u?u.split(",").concat(l).join(","):l.join(","),"searchux.useThor":this.searchConfigService.config.useThorEnabled}),h.label=5;case 5:e.conf.setsFromObject(a),this.setOneDriveUrl(e),e.exposeDebugInterface("mssearchux.officeHome",{version:e.version,conf:e.conf,ecsConfig:t}),h.label=6;case 6:return[2]}}))}))},e.prototype.initializeSearchBox=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.registerSiteSuggestionProvider(e),this.registerFileSuggestionProvider(e),this.registerThirdPartyAppsSuggestionProvider(e),this.workloadsService.getProvisionedWorkloads().then((function(t){var r=t.filtty})).map((function(e){var t=Object(i.__assign)({},e);return t.IconUnicodeCodepointCssClass&&(t.IconUnicodeCodepointCssClass=t.IconUnicodeCodepointCssClass+" ms-ohp-Icon--fast-autosuggest-app"),t}));e.conf.sets("searchux.appWorkloads",r)})),this.setAppsAutosuggestClick(e),this.setFilesAutosuggestClick(e),[4,e.registerSuggestionProviderConfigurationAsync(this.fastSearchBoxConfigurationName,this.getSuggestionProviderConfiguration())];case 1:return t.sent(),this.setPersonAutosuggestClick(e),[2]}}))}))},e.prototype.getEnvironment=function(){return this.searchPageBootstrapperService.getSearchEnvironment()||this.searchConfigService.config.fastSearchUXEnvironment||null},e.prototype.setSharePointSearchCenterUrl=function(e){var t=e.conf;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.sharedSearchService.getSearchCenterUrl(this.contextService.sharedContext.graphApiRoot)];case 1:return e=i.sent(),t.sets("searchux.api.sharePointSearchCenter.url",e),[3,3];case 2:return r=i.sent(),[2,this.globalErrorHandler.handleError(r,"p4CC4")];case 3:return[2]}}))}))},e.prototype.setOneDriveUrl=function(e){var t=e.conf;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,r,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.oneDriveGraphService.getMyDriveRootUrl()];case 1:return e=i.sent(),(r=e&&e.userRoot)&&t.sets("searchux.personalUrl",r),[3,3];case 2:return n=i.sent(),[2,this.globalErrorHandler.handleError(n,"sCtl9")];case 3:return[2]}}))}))},e.prototype.preloadSearchIfEligible=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,r,n,a,s,o=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.clientStartupConfigService.config.authType===T.a.MSA&&this.searchConfigService.config.disableSearchEnterPressedAction?[2]:[4,this.userProfileService.get()];case 1:for(r in e=i.sent(),t=e.metrics)if(-1!==r.toLowerCase().indexOf("search")&&(n=t[r],a=(new Date).getFullYear(),s=new Date(n.lastOccurrence).getFullYear(),a-s<=1))return"idle-callback"===this.clientStartupConfigService.config.chunkLoadStrategy?this.scheduler.scheduleWo()}),4):this.loadMainModule(),[2];return[2]}}))}))},e.prototype.registerSiteSuggestionProvider=function(e){var t=e.conf;B.sharepointSitesService=this.sharePointSitesService,t.regs("searchux.suggestionProvider.provider.officeComSitesSuggestionProvider",B)},e.prototype.registerFileSuggestionProvider=function(e){var t=e.conf;D.a.capabilitiesService=this.capabilitesService,D.a.contextService=this.contextService,D.a.deviceDetector=this.deviceDetector,D.a.mruDataService=this.mruDataService,D.a.sharedSearchService=this.sharedSearchService,D.a.secondaryDisplayTextEnabled=this.searchConfigService.config.fastAutoSuggestionFileSecondaryTextEnabled,t.regs("searchux.suggestionProvider.provider.officeComFilesSuggestionProvider",D.a)},e.prototype.registerThirdPartyAppsSuggestionProvider=function(e){var t=e.conf;X.workloadsService=this.workloadsService,t.regs("searchux.suggestionProvider.provider.officeComThirdPartyAppsSuggestionProvider",X)},e.prototype.setPersonAutosuggestClick=function(e){var t=e.conf,r="searchux.suggestionComponent.person.default",i=t.gets(r),n=document.createElement("div");document.body.appendChild(n);var a=this;t.sets(r,(function(e){return o.createElement(i,Object.assign({},e,{onCln)}}))}))},e.prototype.setFilesAutosuggestClick=function(e){var t=e.conf,r="searchux.suggestionComponent.file.default",i=t.gets(r),n=this;t.sets(r,(function(e){return o.createElement(i,Object.assign({},e,{onCle)}}))}))},e.prototype.setAppsAutosuggestClick=function(e){var t=e.conf,r=new Array;this.workloadsService.getThirdPartyWorkloads().subscri=e}));var n="searchux.suggestionComponent.app.default",a=t.gets(n),s=this;t.sets(n,(function(e){return o.createElement(a,Object.assign({},e,{onClick:function(t){t.preventDefault(),s.sharedSearchService.setAppsAutosuggestClick(e,Object(i.__assign)({},t),r)}}))}))},e.prototype.getSuggestionProviderConfiguration=function(){return{streamPolicy:"searchux.suggestionProvider.streamPolicy.ordered",groups:[{id:"app",optimalCount:1,providers:["searchux.suggestionProvider.provider.o365Apps","searchux.suggestionProvider.provider.officeComThirdPartyAppsSuggestionProvider"],component:"searchux.suggestionComponent.app.default",heading:"searchux.strings.suggestionGroup.app.heading",ariaLabel:"searchux.strings.suggestionGroup.app.ariaLabel"},{id:"file",optimalCount:3,providers:this.capabilitesService.capabilities.isPwaInUwp?["searchux.suggestionProvider.provider.autosuggestfile","searchux.suggestionProvider.provider.officeComFilesSuggestionProvider"]:["searchux.suggestionProvider.provider.autosuggestfile"],component:"searchux.suggestionComponent.file.default",heading:"searchux.strings.suggestionGroup.file.heading",ariaLabel:"searchux.strings.suggestionGroup.file.ariaLabel"},{id:"person",optimalCount:2,providers:["searchux.suggestionProvider.provider.autosuggestpeople"],component:"searchux.suggestionComponent.person.default",heading:"searchux.strings.suggestionGroup.person.heading",ariaLabel:"searchux.strings.suggestionGroup.person.ariaLabel"},{id:"site",optimalCount:2,providers:["searchux.suggestionProvider.provider.autosuggestsite"],component:"searchux.suggestionComponent.site.default",heading:"searchux.strings.suggestionGroup.site.heading",ariaLabel:"searchux.strings.suggestionGroup.site.ariaLabel"}]}},e.prototype.loadMain=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.searchPageBootstrapperService.searchPageModule];case 1:return[4,e.sent().loadMain()];case 2:return[2,e.sent()]}}))}))},e.prototype.loadSearchDispatcher=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.searchPageBootstrapperService.searchPageModule];case 1:return[4,e.sent().loadSearchDispatcher()];case 2:return[2,e.sent()]}}))}))},e.prototype.getStringMapLoader=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.searchPageBootstrapperService.searchPageModule];case 1:return[4,t.sent().loadStrings()];case 2:return[2,t.sent().getStringMapLoader(e,this.searchPageBootstrapperService.cdnOptions)]}}))}))},e.ɵprov=E.kc({factory:function(){return new e(E.lc(x.a),E.lc(T.b),E.lc(R.a),E.lc(v.c),E.lc(m.a),E.lc(I.a),E.lc(f.a),E.lc(h.a),E.lc(W.a),E.lc(w.a),E.lc(P.b),E.lc(k.a),E.lc(l.b),E.lc(d.b),E.lc(C.a),E.lc(F),E.lc(y.a),E.lc(_.a),E.lc(z.a),E.lc(b.a),E.lc(H.a),E.lc(G.b))},token:e,providedIn:"root"}),e}()},IYwM:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r("lUkk"),n=r("rTyw"),a=r("lrJm"),s=r("hhzZ"),o=r("p6Zr"),c=r("/I02"),u=r("keVe"),l=function(){function e(e,t,r){this.contextService=e,this.globalErrorHandler=t,this.instrumentationService=r,this.sessionExpirationTimeInMilliseconds=6e4,this.usingSharePointResourceId=!this.contextService.sharedContext.usingOneDriveResourceAsSharePointResource,this.sessionStarted=!1,this.contextToEventMapper={"ConfigurationDrivenSearchBox.BasicSearchBoxLogger.onActivated":{itemCategory:"Auto_Suggest",knownArea:s.b.SearchSuggestions,searchResultType:null,event:"Search_Click"},"ConfigurationDrivenSearchBox.SuggestionProviderHost.onSuggestionsFetched":{itemCategory:"Auto_Suggest",knownArea:s.b.SearchSuggestions,searchResultType:null,event:"Search_Auto_Suggestion_Results_Fetched"},"ConfigurationDrivenSearchBox.ProvisionedAppSuggestion.onClick":{itemCategory:"Auto_Suggest",knownArea:s.b.SearchSuggestions,searchResultType:"App",event:"Search_Click"},"ConfigurationDrivenSearchBox.ThirdPartyAppSuggestion.onClick":{itemCategory:"Auto_Suggest",knownArea:s.b.SearchSuggestions,searchResultType:"App",event:"Search_Click"},"ConfigurationDrivenSearchBox.FileSuggestion.onClick":{itemCategory:"Auto_Suggest",knownArea:s.b.SearchSuggestions,searchResultType:"File",event:"Search_Click"},FileClickedWithExtensionCustom:{itemCategory:"File_Type",knownArea:s.b.SearchResults,searchResultType:"File",event:"Search_Click"},FileClickedWithExtension:{itemCategory:"File_Type",knownArea:s.b.SearchResults,searchResultType:"File",event:"Search_Click"},"ConfigurationDrivenSearchBox.SearchBoxClearButton.onClick":{itemCategory:"Clear",knownArea:s.b.SearchSuggestions,searchResultType:null,event:"Search_Click"},"ConfigurationDrivenSearchBox.SearchBoxSubmitButton.onClick":{itemCategory:"Submit",knownArea:s.b.SearchSuggestions,searchResultType:null,event:"Search_Click"},"ConfigurationDrivenSearchBox.SiteSuggestion.onClick":{itemCategory:"Auto_Suggest",knownArea:s.b.SearchSuggestions,searchResultType:"Site",event:"Search_Click"},"ConfigurationDrivenSearchBox.PersonSuggestion.onClick":{itemCategory:"Auto_Suggest",knownArea:s.b.SearchSuggestions,searchResultType:"Person",event:"Search_Click"},"ConfigurationDrivenSearchBox.SubmitSearchSuggestion.onClick":{itemCategory:"Show_More_Results",knownArea:s.b.SearchSuggestions,searchResultType:null,event:"Search_Click"},"ConfigurationDrivenSearchBox.SuggestionProviderHost.onSuggestionHeadingClick":{itemCategory:"Auto_Suggest_Header",knownArea:s.b.SearchSuggestions,searchResultType:null,event:"Search_Click"},"ConfigurationDrivenSearchBox.SuggestionProviderHost.suggest":{itemCategory:"Auto_Suggest_Loaded",knownArea:s.b.SearchSuggestions,searchResultType:null,event:"Search_Auto_Suggestion_Results_Fetched"},"vNextSearchPage.TriageFileSearchResult.onClickTargetOpen":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"File",event:"Search_Click"},"vNextSearchPage.TriageFileSearchResult.onClick":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"File",event:"Search_Click"},"vNextSearchPage.TriageSiteSearchResult.onClick":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"Site",event:"Search_Click"},"vNextSearchPage.TriageNewsSearchResult.onClick":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"News",event:"Search_Click"},"vNextSearchPage.FlashinPeopleCard.onPersonClickTargetWrapperTrigger":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"Person",event:"Search_Click"},"FilesSearchPanel.TriageFileSearchResult.onPersonClickTargetWrapperTrigger":{itemCategory:"Result_Click_Sub_Link",knownArea:s.b.SearchResults,searchResultType:"Person",event:"Search_Click"},"FilesSearchPanel.TriageFileSearchResult.onClick":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"File",event:"Search_Click"},"PeopleSearchPanel.ProfileSearchResult.onPersonClickTargetWrapperTrigger":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"Person",event:"Search_Click"},"NewsSearchPanel.TriageNewsSearchResult.onClick":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"News",event:"Search_Click"},"vNextSearchPage.FlashinPeopleCard.onClick":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"Person",event:"Search_Click"},"NewsSearchPanel.TriageNewsSearchResult.onPersonClickTargetWrapperTrigger":{itemCategory:"Result_Click_Sub_Link",knownArea:s.b.SearchResults,searchResultType:"Person",event:"Search_Click"},"PeopleSearchPanel.ProfileSearchResult.onClick":{itemCategory:"Person_Profile",knownArea:s.b.SearchResults,searchResultType:"Person",event:"Search_Click"},"SitesSearchPanel.TriageSiteSearchResult.onClick":{itemCategory:"Result",knownArea:s.b.SearchResults,searchResultType:"Site",event:"Search_Click"},"vNextSearchPage.TriageFileSearchResult.onExpand":{itemCategory:"Result_Expansion",knownArea:s.b.SearchResults,searchResultType:"File",event:"Search_Click"},"SitesSearchPanel.TriageSiteSearchResult.onExpand":{itemCategory:"Result_Expansion",knownArea:s.b.SearchResults,searchResultType:"Site",event:"Search_Click"},"NewsSearchPanel.TriageNewsSearchResult.onExpand":{itemCategory:"Result_Expansion",knownArea:s.b.SearchResults,searchResultType:"Person",event:"Search_Click"},"SitesSearchPanel.t.onDeepLinkClick":{itemCategory:"Result_Click_Sub_Link",knownArea:s.b.SearchResults,searchResultType:"Site",event:"Search_Click"},"SitesSearchPanel.t.onActivityClick":{itemCategory:"Result_Click_Sub_Link",knownArea:s.b.SearchResults,searchResultType:"Site",event:"Search_Click"},"SitesSearchPanel.TriageSiteSearchResult.onClickSitesSearchPanel.TriageSiteSearchResultHeroModuleSearchSiteLink.onSubmitSearch":{itemCategory:"This_Site",knownArea:s.b.SearchResults,searchResultType:"Site",event:"Search_Click"},"VerticalFiltersRoot.VerticalFilters.changeAndLog":{itemCategory:"Vertical_Filter",knownArea:s.b.SearchResults,searchResultType:null,event:"Search_Click"},"vNextSearchPage.Pagination.onClick":{itemCategory:"Pagination",knownArea:s.b.SearchResults,searchResultType:null,event:"Search_Click"},"RefinerButton.onClick":{itemCategory:"Filter",knownArea:s.b.SearchResults,searchResultType:null,event:"Search_Click"},"VnextSearchPage.Impression":{itemCategory:"SERP",knownArea:s.b.SearchResults,searchResultType:null,event:"Search_Results_Fetched"},"Searchbox.Impression":{itemCategory:"Auto_Suggest_Impression",knownArea:s.b.SearchSuggestions,searchResultType:null,event:"Search_Results_Fetched"},serp_impression:{itemCategory:"SERP_Impression",knownArea:s.b.SearchResults,searchResultType:null,event:"Search_Results_Fetched"}}}return e.prototype.searchLogger=function(e,t,r,a){void 0===t&&(t=""),void 0===a&&(a=!1);var s=e.properties||{},o=this.contextToEventMapper[e.nameDetail||e.name];if(void 0!==o){this.checkForSessionTimeout();var c={};if(c.ItemCategory=o.itemCategory,c.SearchResultType=o.searchResultType,c.UsingSharePointResourceId=this.usingSharePointResourceId.toString(),"Search_Results_Fetched"===o.event)try{c.SearchItemCount=s.items?JSON.parse(s.items).length:null}catch(e){this.globalErrorHandler.handleError(e,"cYDfB")}if("Search_Click"===o.event){this.instrumentationService.logClickEvent(o.event,o.itemCategory+"_"+o.searchResultType,o.knownArea.toString(),t||this.getReferralFromEventData(s.eventData,o),r,c,void 0,void 0,a);var u=t||this.getReferralFromEventData(s.eventData,o);Object(i.a)({eventName:o.event,id:o.itemCategory+"_"+o.searchResultType,area:o.knownArea.toString(),result:u?"Refer":"Navigate",target:u?Object(n.a)(u):"Other"})}else this.instrumentationService.logGenericEvent(o.event,c)}},e.prototype.setSearchCenterUrlRefel=e},e.prototype.checkForSessionTimeout=function(){var e=this;if(!this.sessionStarted){this.sessionStarted=!0;var t={};t.ReferralType=this.searchCenterUrlReferral,this.instrumentationService.logGenericEvent("Search_Session_Started",t)}clearTimeout(this.sessionTimeout),this.sessionTimeout=setTime=!1}),this.sessionExpirationTimeInMilliseconds)},e.prototype.getReferralFromEventData=function(e,t){return"Person"===t.searchResultType?"People".toString():"Site"===t.searchResultType||"News"===t.searchResultType?o.a.SharePoint:e?-1!==(e=e.toLocaleLowerCase()).indexOf("excel")?o.a.Excel:-1!==e.indexOf("powerpoint")?o.a.PowerPoint:-1!==e.indexOf("word")?o.a.Word:-1!==e.indexOf("onenote")?o.a.OneNote:-1!==e.indexOf("pdf")?"PDF".toString():"":""},e.ɵprov=u.kc({fa.a))},token:e,providedIn:"root"}),e}()},REHs:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var i=r("QjXU"),n=r("NLr0"),a=r("lrJm"),s=r("3GGT"),o=r("hhzZ"),c=r("R7NL"),u=r("kpuN"),l=r("Z0U4"),h=r("wwmn"),p=r("casz"),d=r("ZtId"),S=r("BMb5"),g=r("pOWU"),f=r("4/We"),v=r("cgnd"),m=r("/I02"),b=r("uUrA"),C=r("oAX+"),y=r("eJwh"),P=r("/6za"),k=r("keVe"),x=r("TOqr"),T=function(e){function t(r,i,n,a,s,o,c,u,l,h,p,d,S,g){var f=e.call(this,r,a,s,"MruPlusPlus",n,o,u,d)||this;f.clientStartupConfigService=i,f.globalErrorHandler=l,f.updateContentService=p,f.windowService=S,f.capabilitiesService=g,f.requestIndex=0;var v=h.config;if(!(f.inMockMode||v&&v.sharePointServiceRoot)||!f.capabilitiesService.capabilities.sharePointEnabled)return f;var m=n.sharedContext,b=m.officeMarketLcid.toString();return f.sitesUrl=f.inMockMode?m.officeHomeApiRoot+"/"+t.sharepointPath:v.sharePointServiceRoot+"/"+t.sharepointPath+"?lcid="+b+"&uilcid="+b+"&syslcid="+b+"&lists=frequent,followed&items="+v.maxTotalSharePointSites,!f.inMockMode&&v.forceSharePointRefresh&&(f.sitesUrl+=t.forceRefreshParam),f.capabilitiesService.capabilities.edgeworthEnabled||c.subscribeToRouteChangeSes()})),f}return Object(i.__extends)(t,e),t.prototype.getSharePointSites=function(){var e=this;if(this.sharepointDataStream)return this.sharepointDataStream;if(this.sitesUrl){var t=this.sitesFetch("cache-only"),r=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchSitesData():this.sitesFetch("network-first"),i=this.updateContentService.getOrAddUpdateStream("sharepointsist")}));this.sharepointDataStream=C.a.createResultsWithCacheObservable(tnull}))}else this.sharepointDataStream={results:Object(n.a)(null),initialCompletion:Promise.resolve(null)};return this.sharepointDataStream},t.prototype.isRetriabletled},t.prototype.handleQueryParam=function(e,t,r){"mocksharepoint"===e&&this.mockRequestHeader&&r.headers.set(this.mockRequestHeader,t)},t.prototype.sitesFetch=function(e){var t=this;return new Promise((function(r,i){t.get("SharePoint_Sites_Request","SharePoint_Sites",t.sitesUrl,(function(e){e.instrument((function(e,r){if(r.RequestId=e.headers&&e.headers.get("X-CorrelationId"),r.PartnerGeo=e.headers&&e.headers.get("X-OfficeCluster"),r.Index=(t.requestIndex++).toString(),r.SharePointSiteLists=e.ok&&e.data?e.data.Sites&&e.data.Sites.length?e.data.Sites.map((function(e){return e?(e.Title||"NULLTITLE")+":"+(e.Sites?"SOME":"NULLSITES"):"NULLLIST"})).join(","):"NONE":"ERROR",e.ok&&e.data&&e.data.Sites&&2===e.data.Sites.length&&e.data.Sites[0]&&e.data.Sites[1]){var i=e.data.Sites[0].Sites,n=e.data.Sites[1].Sites;if(i&&n){var a=(i?i.length:0)+(n?n.length:0),s=i.filter((function(e){return n.fiteId})).length>0})),o=e.data.Sitese}))})).ret(t)}),[]);r.ActualSize=a.toString(),r.SharePointFrequentSitesCount=i.length.toString(),r.SharePointFollowingSitesCount=n.length.toString(),r.SharePointFollowingAndFrequentCount=s.length.toString(),r.Distribution=y.a.distributionFromSiteTypes(o)}}else e.data&&e.data.Error&&(r.Error=JSON.stringify(e.data.Error))})).then((function(e){e.data?r(t.convertRawData(e.data,e.fromCache)):i(new g.b(e,"No data returned"))})).cNn")}))}),i,t.getNewRequestConfig(),e)}))},t.prototype.prefetchSitesData=function(){var e=this;return this.windowService.nativeWindow.prefetchSharepointSitesDataPromise?new Promise((function(t,r){e.windowService.nativeWindow.prefetchSharepointSitesDataPromise.then((function(i){i?t(e.convertRawData(i,!1)):r(new g.b(i,"No data returned"))})).catch((function(t){e.globalErrorHandler.handleError(t,"MThMj"),r(t)}))})):this.sitesFetch("network-first")},t.prototype.convertRawData=function(e,t){void 0===t&&(t=!1);var r=[],i=[];return e&&e.Sites&&e.Sites[0]&&e.Sites[1]&&(r=e.Sites[0].Sites,i=e.Sites[1].Sites),{Title:e.Title,User:e.User,TenantThumbnails:e.TenantThumbnails,DefaultSitesThumbnails:e.DefaultSitesThumbnails,SitesThumbnailBackgroundColor:e.SitesThumbnailBackgroundColor,ExpiresInMinutes:e.ExpiresInMinutes,FrequentSites:r,FollowingSites:i,Analytics:e.Analytics,fromCache:t}},t.prototype.getNewRequestConfig=function(){return{headers:this.requestHeaders(b.a.createGuid())}},t.prototype.requestHeaders=function(e){return new Map([["Accept","application/json"],["X-CorrelationId",e],["X-Office-Platform","Web"],["X-Office-Application",this.contextService.sharedContext.iceApplicationId.toString()],["X-Office-Version",this.clientStartupConfigService.config.sharedClientStartupContext.buildId]])},t.forceRefreshParam="&forcerefresh=1",t.sharepointPath="sites",t.ɵprov=k.kc({factory:function(){return new t(k.lc(u.b),k.lc(v.b),k.lc(m.a),k.lc(o.a),k.lc(c.a),k.lc(h.a),k.lc(l.a),k.lc(x.q),k.lc(a.b),k.lc(P.a),k.lc(d.a),k.lc(p.a),k.lc(S.b),k.lc(f.a))},token:t,providedIn:"root"}),t}(g.a)},ZRHl:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r("QjXU"),n=r("gdDe"),a=r("BaAg"),s=funct|this}return Object(i.__extends)(t,e),t.prototype.createStream=function(e){var r=[],i=[],s=[];if(""===(null==e?void 0:e.trim())){if(void 0===this.currentRoute||this.currentRoute!==t.currentRoute.route){var o=this.getAppList(t.currentRoute.route,t.currentRoute.app);t.allApps.forEach((function(e){o.includes(e.Id)&&(t.zeroTermAppResults[o.indexOf(e.Id)]=e)})),this.currentRoute=t.currentRoute.route}s=t.zeroTermAppResults}else{var c=e.toLowerCase();t.allApps.forEach((function(e){var r=e.Title.toLowerCase();if("Start"!==t.currentRoute.route||a.a.fileTypeNameFromType(t.currentRoute.app).toLowerCase()!==r)return(0!==c.indexOf(r)&&0!==r.indexOf(c)||(s.push(e),3!==s.length))&&void 0}))}return s.forEach((function(e){r.push({id:e.Id,isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,title:e.Title,iconClass:e.IconUnicodeCodepointCssClass,url:e.Url,referral:e.Referral,searchInstrumentationService:t.searchInstrumentationService,sharedSearchService:t.sharedSearchService}),i.push(e.Title)})),t.searchInstrumentationService.setRenderedProviderResults("App",i),n.Observable.fromArray(r)},t.prototype.addAppResults=function(e,t){this.createStream(e).subscribe((function(e){t.push({appName:e.title,iconClass:e.iconClass+" serp-app-icon",id:e.id,isDarkMode:e.isDarkMode,title:e.title,url:e.url,onClick:function(t){return e.sharedSearchService.setAppsAutosuggestClick(Object(i.__assign)(Object(i.__assign)({},e),{onClick:function(){return null},id:e.id,customLoggingFu null}}),t,void 0)}})}))},t.prototypeapps"},t.prototype.getAppList=function(e,r){if("Start"===e)switch(r){case a.b.Word:return t.zeroTermWordAppList;case a.b.Excel:return t.zeroTermExcelAppList;case a.b.PowerPoint:return t.zeroTermPPTAppList}return t.zeroTermDefaultAppList},t.zeroTermDefaultAppList=["ShellWordOnline","ShellPowerPointOnline","ShellExcelOnline","ShellMail"],t.zeroTermWordAppList=["ShellPowerPointOnline","ShellExcelOnline","ShellMail","ShellCalendar"],t.zeroTermPPTAppList=["ShellWordOnline","ShellExcelOnline","ShellMail","ShellCalendar"],t.zeroTermExcelAppList=["ShellWordOnline","ShellPowerPointOnline","ShellMail","ShellOfficeForms"],t.zeroTermAppResults=new Array(t.zeroTermDefaultAppList.length),t}(r("uTi/").a)},eJwh:function(e,t,r){"use strict";r.d(urn a}));var i=r("hhzZ"),n=r("p6Zr"),a=function(){function e(t,r,i,n,a,s,o,c){this.id=t,this.type=r,this.acronym=i,this.bannerImageUrl=n,this.bannerColor=a,this.time=s,this.url=o,this.title=c,this.isGroup=e.groupReference===this.type}return e.distributionFromSiteTypes=function(e){return e?e.reduce((function(e,t,r){return e+(0===r?"":";")+t}),""):""},e.distributionFromSiteItems=function(t){return t?e.distributionFromSiteTypes(t.map((function(e){return e.type}))):""},e.prototype.getId=function(){return this.id},e.prototype.getClickData=function(e,t){var r={};return r.ElementId=t+"_"+e,r.ItemId=this.id,r.Index=e.toString(),r.ItemCategory=this.type,r.Referral=n.a.SharePoint,r.Area=i.b.Sites,r.ListId=t,{eventName:"SharePoint_Site_Click",params:r,metrics:[]}},e.groupReference="GroupReference",e}()},eda8:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i=r("gdDe"),n=r("3Vsh"),a=r("BaAg"),s=r("cgnd"),o=r("WFKr"),c=r("ZBli"),u=function(){function e(){}return e.prototype.createStream=function(t){var r=e.mruDataService.getMruDocuments();return i.Observable.fromPromise(r.results.pipe(Object(n.a)(1)).toPromise().then((function(t){var r,i;if(t){var n=t.items||[];return e.clientStartupConfigService.config.authType!==s.a.MSA&&(null===(r=e.capabilitiesService)||void 0===r?void 0:r.capabilities.isPwaInUwp)&&(null===(i=e.capabilitiesService)||void 0===i?void 0:i.capabilities.nativeSearchInHeaderEnabled)&&(n=n.fLocal}))),n.map((function(t){var r=a.a.fileTypeNameToFileType(t.FileType);return{id:decodeURI(t.Url),isLocal:t.IsLocal,url:t.IsLocal?t.Url:c.a.appendQuery(t.Url,"web=1"),webUrl:t.WebUrl,title:t.Title,iconUrl:t.Url,type:"file",fileType:t.FileType,iconClass:a.a.documentIconFromType(r,"32x32")+" file-suggestion-icon-fix",fileExtension:r===a.b.OneNote?"one":a.a.getFileExtensionFromUrl(t.Url),secondaryDisplayText:e.secondaryDisplayTextEnabled?o.a.Format(t.PathArray,e.contextService.isRtl,e.pathCharacterLimit)[0]:"",searchInstrumentationService:e.searchInstrumentationService,sharedSearchService:e.sharedSearchService,consumerSearchWdQueryParamsEnabled:e.consumerSearchWdQueryParamsEnabled}}))}return[]}))).select((function(e){return e.filter((function(e){return!t||e.title&&-1!==e.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase().trim())}))})).selectMany((function(t){return e.searchInstrumentationService.setRenderedProviderResults("File",t.length>0?[""]:[]),i.Observable.fromArray(t)}))},e.prototype.getId=function(){return"FilesFastSuggestionProvider"},e.pathCharacterLimit=60,e}()},hGaZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r("QjXU"),n=r("gdDe"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.createStream=function(e){var r=[],i=[];if(""!==(null==e?void 0:e.trim())){var a=[],s=e.replace(/\s/g,"").toLowerCase();s.startsWith("ms")?s=s.split("ms")[1]:s.startsWith("microsoft")&&(s=s.split("microsoft")[1]),s.length>=t.MIN_NUM_OF_CHARS&&t.commercialApps.getCommercialAppList().forEach((function(e){var r=e.AppName.replace(/\s/g,"").toLowerCase();if((0===s.indexOf(r)||0===r.indexOf(s))&&(a.push(e),a.length===t.MAXCOUNT))return!1})),a.forEach((function(e){i.push({appName:e.AppName,contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,id:decodeURI(e.Url),isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,title:e.Title,iconClass:e.IconUnicodeCodepointCssClass,url:e.Url,referral:e.Referral,searchInstrumentationService:t.searchInstrumentationService,urlLauncherService:t.urlLauncherService}),r.push(e.Title)}))}return t.searchInstrumentationService.setRenderedProviderResults("Go_To",r),n.Observable.fromArray(i)},t.prototype.addGoToResults=function(e,i){this.createStream(e).subscribe((function(e){i.push({appName:e.appName,description:t.searchConfigService.config.resources.SearchSuggestionGoToLabelInSerp,iconClass:e.iconClass+" serp-app-icon",id:e.id,isDarkMode:e.isDarkMode,title:e.title,url:e.url,onClick:function(t){e.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9"))To"})})):e.urlLauncherService.openUrl(e.url,"OpenAutosuggestGoTo")}})}))},t.prototype.getId=function(){return"goTo"},t.MIN_NUM_OF_CHARS=1,t.MAXCOUNT=3,t}(r("uTi/").a)},sKtG:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var i=r("QjXU"),n=r("am3b"),a=r("lrJm"),s=r("3g20"),o=r("cZRF"),c=r("COYM"),u=r("BaAg"),l=r("kpuN"),h=r("BJFG"),p=r("Bc8L"),d=r("uzn7"),S=r("Z0U4"),g=r("AY/E"),f=r("casz"),v=r("TIi1"),m=r("EUVs"),b=r("BMb5"),C=r("hoyd"),y=r("4/We"),P=r("cgnd"),k=r("/I02"),x=r("uUrA"),T=r("kvyl"),R=r("ZBli"),_=r("6u39"),w=r("IYwM"),I=r("83kx"),A=r("uh00"),O=r("keVe"),E=function(){function e(e,t,r,i,n,a,s,o,c,u,l,h,p,d,S,g,f,v,m,b,C,y){var k=this;this.accessTokenService=e,this.appLauncherService=t,this.capabilitiesService=r,this.clientStartupConfigService=i,this.contextService=n,this.encryptionService=a,this.fastSearchUXInstrumentationService=s,this.globalErrorHandler=o,this.localAppLauncherService=c,this.localStorageService=u,this.ngZone=l,this.officeRouteService=h,this.peopleCardService=p,this.schedulerService=d,this.searchConfigService=S,this.uploadLocalFileService=g,this.windowService=f,this.workloadsService=v,this.wacContentService=m,this.urlLauncherService=b,this.searchPageInstrumentationService=C,this.searchPageBootstrapperService=y,this.sharePointTokenProvider=this.createTokenProvider("SharePoint"),this.substrateSearchServiceTokenProvider=this.createTokenProvider("QueryFormulation"),this.graphTokenProvider=this.createTokenProvider("Graph"),this.searchCenterUrlKey="-searchcenterurl",this.bingSuggestionsAppID="D41D8CD98F00B204E9800998ECF8427E0C818072",this.bingSuggestionsUrl="https://www.bing.com/as/init?pt=onedrive&clientid=",this.searchUXPrefetchModule=new Promise((function(e){return k.resolveSearchUXPrefetchModule=e})),this.capabilitiesService.capabilities.showSearch&&(this.clientStartupConfigService.config.authType!==P.a.MSA&&this.initializePrefetchLibrary(),this.setup())}return e.plainTextTitle=function(e){var t=e.displayText||e.title;return t?t.replace("<mark>","").replace("</mark>",""):""},e.prototype.warmup3S=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.getSearchCenterUrl(e)];case 1:return t=i.sent(),[4,this.searchUXPrefetchModule];case 2:return[2,(r=i.sent()).warmupSubstrateSearch({tokenProvider:this.substrateSearchServiceTokenProvider,headers:{"x-client-language":this.contextService.sharedContext.officeMarket,"x-anchormailbox":this.getXAnchorMailbox()},postAction:this.searchConfigService.config.fastUseSubstrateEnabled?"initv2":"init",substrateUrl:r.resolveSubstrateUrl(this.searchPageBootstrapperService.resolveLokiEnvironment()),queryStringParameters:{scenario:"officehome",userContextUrl:"/search"===t?this.contextService.sharedContext.sharePointResourceId+"/search":t}})]}}))}))},e.prototype.getSearchCenterUrl=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=!1,this.searchCenterUrl?[3,2]:[4,this.getSearchCenterUrlFromCache()];case 1:i.sent(),t=!0,i.label=2;case 2:return this.searchCenterUrl?[3,4]:[4,this.fetchSearchCenterUrlFromBackend(e)];case 3:i.sent(),t=!1,i.label=4;case 4:return t&&this.schedulerService.schedulnd(e)}),3),[2,this.searchCenterUrl]}}))}))},e.prototype.getXAnchorMailbox=function(){var e=this.clientStartupConfigService.config;return e.puid&&e.tenantId?"PUID:"+e.puid+"@"+e.tenantId:e.userPrincipalName},e.prototype.createTokenProvider=function(e){var t=this;return function(r){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=r.url,[4,this.accessTokenService.getAccessToken(e,1===r.attempt,"SharePoint"===e?null!=t?t:this.contextService.sharedContext.sharePointResourceId:t)];case 1:return[2,(n=i.sent()).success?Promise.resolve(n.token):Promise.reject(n.error)]}}))}))}},e.prototype.initializePrefetchLibrary=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.prefetchLibraryInitialized?[2]:[4,this.loadPrefetch()];case 1:return e=t.sent(),this.prefetchLibraryInitialized=!0,e.init({puid:this.clientStartupConfigService.config.puid,cache:{createdBy:"OfficeHome",createdAt:0,participants:[],caches:{}}}),this.resolveSearchUXPrefetchModule(e),[2]}}))}))},e.prototype.setAppsAutosuggestClick=function(e,t,a){var s=this;this.ngZone.run((function(){var o;e.onClick(),a&&a.length>0&&(o=aase()})))&&s.workloadsService.updateUsedThirdPartyApps(o);var c=o?"ConfigurationDrivenSearchBox.ThirdPartyAppSuggestion.onClick":"ConfigurationDrivenSearchBox.ProvisionedAppSuggestion.onClick",l=e.referral||e.id;l&&l.toLocaleLowerCase().startsWith("shell")&&(l=l.replace(/shell/i,""));var h,p=!1;if(h=e.customLoggingFunction?e.customLoggingFunction:function(e,t,r){p||(p=!0,s.workloadsService.pinWorkload(o),s.fastSearchUXInstrumentationService.searchLogger({eventType:"USAGE",name:"engagement",nameDetail:c,properties:{eventData:""}},e?l:"",t,r))},o)return h(!0,"Web"),void(s.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchApp({action:"OpenAutosuggestApp",event:t,appName:o.Text,url:o.Url,useUrl:!0})})):s.appLauncherService.launchApp(o,Object(i.__assign)({},t),"OpenAutosuggestApp"));"_blank"!==s.contextService.sharedContext.defaultLinkTarget&&h(!0,"Web");var d=function(){!e.providerId||"MetaOsAppSuggestionProvider"!==e.providerId&&"CopilotAppSuggestionProvider"!==e.providerId||!e.id?s.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(t){t.launchUrl(e.url,{action:"OpenAutosuggestApp"}).then((function(){h(!0,"Web")}),(function(){h(!1)}))})):s.urlLauncherService.openUrl(e.url,"OpenAutosuggestApp").then((function(){h(!0,"Web")}),(function(){h(!1)})):Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(t){t.launchUrl({route:"M365Apps",appId:e.id,type:n.a.Mos},{action:"OpenAutosuggestApp"}).then((function(){h(!0,"Web")}),(function(){h(!1)}))}))};Promise.all([s.workloadsService.getWorkloads(),s.workloadsService.getAdditionalWorkloads()]).then((function(a){var c=a[0].concat(a[1]),l=e.id.startsWith("Shell")?e.id:"Shell"+e.id;(o=case()})))?s.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){(o.InAppNav&&o.FileType?e.launchUrl({route:"Start",type:n.a.Base,app:u.b[o.FileType]},{action:"OpenAutosuggestApp"}):e.launchApp({action:"OpenAutosuggestApp",event:t,appName:o.Text,url:o.Url})).then((function(e){h(!!e,"Native"===e.result?"Native":"Web","StartPage"===e.result)}))})):s.appLauncherService.launchApp(o,Object(i.__assign)({},t),"OpenAutosuggestApp",!0).then((function(e){h(!!e,"Native"===e?"Native":"Web","StartPage"===e)})):d()}),(function(){d()}))}))},e.prototype.setFilesAutosuggestClick=function(t){var i=this;this.ngZone.run((function(){t.onClick();var n,a=t.url,s=u.a.fileTypeFromExtension(t.fileExtension),o=!e.webRegex.test(a),c=u.a.referralFromFileType(s),l=i.contextService.getWdOrigin("SEARCH"),h=!1;if(n=t.customLoggingFunction?t.customLoggingFunction:function(e,t){h||(h=!0,i.fastSearchUXInstrumentationService.searchLogger({eventType:"USAGE",name:"engagement",nameDetail:"FileClickedWithExtensionCustom",properties:{eventData:""}},e?c:"",t))},s!==u.b.Unknown&&s!==u.b.None&&!o&&!t.shortUrl){var p=Date.now();if(i.searchConfigService.config.consumerSearchWdQueryParamsEnabled)a=R.a.appendQuery(a,"ct="+p+"&wdOrigin="+l+"&wdPreviousSession="+i.clientStartupConfigService.config.sharedClientStartupContext.sessionId+"&wdPreviousSessionSrc="+i.getHarmonySessionSource());else{var d=x.a.createGuid();a=a+"&ct="+p+"&wdOrigin="+l+"&cid="+d}}var S=i.capabilitiesService.wacHostEnabledForFileType(s),g=function(){if(S){var e={docUrl:a,fileName:t.displayTextRaw,fileType:s,wdOrigin:l};n(!0,"Web"),i.wacContentService.bootstrapAndRoute(e)}else"_blank"!==i.contextService.sharedContext.defaultLinkTarget&&n(!0,"Web"),i.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchUrl(a,{action:"OpenAutosuggestFile"}).then((function(){n(!0,"Web")}),(function(){n(!1)}))})):i.urlLauncherService.openUrl(a,"OpenAutosuggestFile")Wen(!1)}))};i.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(r){r.launchApp({action:"OpenDocument",appName:u.b[s],url:t.canonicalUrl||a,useUrl:!0}).then((function(r){if(r&&r.success)n(!0,"Native");else if(o){var s=e.plainTextTitle(t);i.uploadLocalFileService.showModal(a,s,1),n(!1)}else g()})).catch((function(){g()}))})):i.localAppLauncherService.launchOfficeApp(u.b[s],t.canonicalUrl||a).then((function(r){if(r)n(!0,"Native");else if(o){var s=e.plainTextTitle(t);i.uploadLocalFileService.showModal(a,s,1),n(!1)}else g()})).){g()}))}))},e.prototype.setPersonAutosuggestClick=function(t,r){var i=this;this.ngZone.run((function(){t.onClick();var n=e.plainTextTitle(t),a=t.id.includes("@"),s=n&&n.indexOf("@")>0;if(i.peopleCardService&&(s||a)){var o=t.id.split("@")[0];i.peopleCardService.addPersonaCardElement(r,o,s?n:"",i.windowService.innerWidth>900).then((function(){var e=document.getElementById("personCardClickElement");setTimeout((function(){e.click()}),500)}))}else n&&i.officeRouteService.navigateTo({route:"Search"},!1,{q:n})}))},e.prototype.setup=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.searchPageInstrumentationService.searchUXInstrumenter];case 1:return e=i.sent(),this.clientStartupConfigService.config.authType===P.a.MSA&&this.searchConfigService.config.fastODCFileProviderEnabled&&(t=this.clientStartupConfigService.config,(r=document.createElement("script")).src=this.bingSuggestionsUrl+t.puid.toString(),document.head.appendChild(r),e.setProps({bingConsumerApiContext:{appId:this.bingSuggestionsAppID,viewerId:t.puid,fromPhotos:!1}})),e.markAppBoot(),[2]}}))}))},e.prototype.handleError=function(e,t){e&&e.message!==c.a&&("Could not complete the operation due to error 80700011."===e.message||e.message.indexOf("80700011")>=0||this.globalErrorHandler.handleError(e,t))},e.prototype.getSearchCenterUrlFromCache=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e=this.localStorageService.get(this.searchCenterUrlKey)))return[3,6];if(!this.encryptionService)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),t=this,[4,this.encryptionService.decryptData(Object(T.b)(e))];case 2:return t.searchCenterUrl=i.sent(),[3,4];case 3:return r=i.sent(),this.handleError(r,"EaiTE"),[3,4];case 4:return[3,6];case 5:this.searchCenterUrl=e,i.label=6;case 6:return[2]}}))}))},e.prototype.fetchSearchCenterUrlFromBackend=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,r,n,a,s,o=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.searchUXPrefetchModule];case 1:return e=i.sent(),t=this,[4,(0,e.fetchSearchCenterUrl)({siteRoot:this.contextService.sharedContext.sharePointResourceId,tokenProvider:this.sharePointTokenProvider,environment:this.searchPageBootstrapperService.resolveLokiEnvironment(),graphTokenProvider:this.graphTokenProvider,graphRoot:void 0}).rceId}))];case 2:if(t.searchCenterUrl=i.seey,e)},!this.encryptionService)return[3,7];i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this.encryptionService.encryptData(this.searchCenterUrl)];case 4:return n=i.sent(),a=Object(T.a)(new Uint8Array(n)),r(a),[3,6];case 5:return s=i.sent(),this.handleError(s,"SmMcK"),[3,6];case 6:return[3,8];case 7:r(this.searchCenterUrl),i.label=8;case 8:return[2]}}))}))},e.prototype.loadPrefetch=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.searchPageBootstrapperService.searchPageModule];case 1:return[4,e.sent().loadPrefetch()urn e}))];case 2:return[2,e.sent()]}}))}))},e.prototype.getHarmonySessionSource=function(){switch(this.capabilitiesService.getWorkload()){case"pwa":return"HarmonyDesktop";case"officehome":case"officehomereact":return"HarmonyWeb";case"embed":return"HarmonyEmbed";default:return"unknown"}},e.webRegex=RegExp("^https?://","i"),e.ɵprov=O.kc({factory:function(){return new e(O.lc(l.b),O.lc(h.a),O.lc(y.a),O.lc(P.b),O.lc(k.a),O.lc(o.a,8),O.lc(w.a),O.lc(a.b),O.lc(p.a),O.lc(d.a),O.lc(O.F),O.lc(S.a),O.lc(g.a),O.lc(f.a),O.lc(s.a),O.lc(_.a),O.lc(b.b),O.lc(C.a),O.lc(m.a),O.lc(v.a),O.lc(A.a),O.lc(I.b))},token:e,providedIn:"root"}),e}()}){}}()},uh00:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r("QjXU"),n=r("3g20"),a=r("cgnd"),s=r("83kx"),o=r("keVe"),c=function(){function e(e,t,r){var i=this;this.clientStartupConfigService=e,this.searchConfigService=t,this.searchPageBootstrapperService=r,this.searchUXInstrumenter=new Promise((function(e){return i.resolveSearchUXInstrumenter=e})),this.searchUXInstrumentationModule=new Promise((function(e){return i.resolveSearchUXInstrumentationModule=e})),this.initializeInstrumenter()}return e.prototype.initializeInstrumentationLibrary=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator),[2]}}))}))},e.prototype.initializeInstrumenter=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.initializeInstrumentationLibrary()];case 1:return t.sent(),e=this.resolveSearchUXInstrumenter,[4,this.searchUXInstrumentationModule];case 2:return e.apply(this,[t.sent().createInstrumenter({perf:window.performance,scenario:"",hostAppInfo:{id:this.searchPageBootstrapperService.hostAppId,version:this.clientStartupConfigService.config.sharedClientStartupContext.buildId,userRing:this.getRing()},serviceEnvInfo:{environment:this.searchPageBootstrapperService.getSearchEnvironment(),urls:this.getSearchCloudUrls()}})]),[2]}}))}))},e.prototype.getRing=function(){return"prod"===this.searchConfigService.config.fastSearchUXEnvironment?s.a.generalAudience:s.a.outer},e.prototype.i9"===e},e.prototype.getSearchCloudUrls=function(){if(this.isAirGap()&&this.searchConfigService.config.searchEnvironmentUrls)return JSON.parse(this.searchConfigService.config.searchEnvironmentUrls)},e.prototype.loadInstrumentation=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.searchPageBootstrapperService.searchPageModule];case 1:return[4,e.sent().loadSearchInstrumentation()];case 2:return[2,e.sent()]}}))}))},e.ɵprov=o.kc({factory:function(){return new e(o.lc(a.b),o.lc(n.a),o.lc(s.b))},token:e,providedIn:"root"}),e}()},unjt:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var i=r("QjXU"),n=r("lrJm"),a=r("hhzZ"),s=r("R7NL"),o=r("kpuN"),c=r("wwmn"),u=r("casz"),l=r("pOWU"),h=r("/I02"),p=r("keVe"),d=r("TOqr"),S=function(e){function t(t,r,i,n,a,s,o,c){var u=e.call(this,t,n,i,"None",r,a,s,c)||this;return u.globalErrorHandler=o,u}return Object(i.__extends)(t,e),t.prototype.sendIntrumentedGetRequest=function(e,t,r,i){var n=this;return new Promise((function(a,s){n.get(e,t,r,(function(e){e.then((function(e){e?a(e.data):s()})).catch((function(e){return n.globalErrorHandler.handleError(e)}))}),(function(e){return s("Failed to get search suggestions. Status Code: "+(e&&e.httpResponse?e.httpResponse.status:""))}),i,"network-first")}))},t.prototype.sendIntrumentedPostRequest=function(e,t,r,i,n){var a=this;return new Promise((function(s,o){a.post(e,t,r,i,(function(e)ta):o()})).catch((function(e){return a.globalErrorHandler.handleError(e)}))}),(function(e){return o("Failed to get search suggestions. Status Code: "+(e&&e.httpResponse?e.httpResponse.status:""))}),n)}))},t.ɵprov=p.kc({factory:function(){return new t(p.lc(o.b),p.lc(h.a),p.lc(s.a),p.lc(a.a),p.lc(c.a),p.lc(d.q),p.lc(n.b),p.lc(u.a))},token:t,providedIn:"root"}),t}(l.a)}}]);
//# sourceMappingURL=auto-suggest~bc~search-preload~search-results.432927204bef29377142.chunk.v7.js.map