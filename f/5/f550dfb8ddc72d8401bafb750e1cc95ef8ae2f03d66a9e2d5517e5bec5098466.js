(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[301],{"5FTO":function(l,n,t){},ALB0:"oA+b":function(l,n,t){"use strict";t.r(n),t.d(n,"FormsGroupModuleNgFactory",();var e=t("keVe"),o=t("laSs"),i=t("rmEM"),u=t("CC5A"),r=t("hhzZ"),s=t("zwsB"),c=t("TDzr"),a=t("4/We"),m=t("PBJH"),p=),f=function(){function l(l,n,t,e,o){this.formsService=n,this.instrumentationService=t,this.formsConfigService=e,this.locService=o,this.ITEM_VIEW="ListCol",this.capabilities=null,this.capabilities=l.capabilities}return l.prototype.ngOnInit=function(){var l=this;this.fluentRefresh=this.capabilities.fluentRefresh,this.sectionTitle=this.locService.MyGroupsSectionTitle,this.tabListModel=new u.b({id:"formsGroups",area:r.b.FormsGroups,tabs:[],logImpression:),this.initializeFormsGroups()},l.prototype.initializeFormsGroups=function(){var l=this,n=this.formsService.getFormsGroups();this.getFormsGroupsSubscription=n.results.subscribe((),n.initialCompletion.then(()},l.prototype.ngOnDestroy=function(){this.getFormsGroupsSubscription&&this.getFormsGroupsSubscription.unsubscribe()},l.prototype.processFormsGroups=function(l,n){var t=this;this.groupItems=this.formsGroupsToFormsGroupItems(l);var e=new i.a(this.groupItems,this.locService.ShowMoreGroupsLabel,this.locService.ShowLessGroupsLabel,null,null,6,this.groupItems.length,(,this.capabilities.disableAnimation?"None":"Slide");this.tabListModel.updateOrAddTab({id:"groups",title:null,ariaLabel:null,listModel:e,zeroExperienceTitle:this.locService.NoRecentGroupsTitle,zeroExperienceSubtitle:this.locService.NoRecentGroupsTitle,zeroExperienceImage:"emptystate-icons-sprite emptystate-discover",showZeroExperience:!0,errorTitle:null,attribution:null,loaded:!0,fromCache:n})},l.prototype.formsGroupsToFormsGroupItems=function(l){var n=this,t=l.map(();return this.formsConfigService.config.groupPhotoRequestInBatch?t.map(().reduce((function(l,t){return l.then((function(){return t&&Promise.all(t.map((function(l){return n.formsService.getFormGroupThumbnailUrl(l.id).then((function(n){l.thumbnailUrl=n}))}))).then(()}))}),Promise.resolve()):t.forEach((function(l){n.formsService.getFormGroupThumbnailUrl(l.id).then(()})),t},l.prototype.logImpression=function(l,n){var t={};t.RenderSize=l.toString(),t.FromServiceWorkerCache=(!!n).toString(),this.instrumentationService.logImpressionEvent("Groups_Impression",t),Object(o.a)({eventName:"Groups",area:"FormsGroups",renderSize:l,fromCache:n})},l}(),b=f,h=),d=t("fYis"),g=t("pzhl"),v=t("PkQn"),G=t("TOqr"),I=t("lUkk"),S=t("AlWG"),F=t("BaAg"),y=t("Z0U4"),_=function(){function l(l,n,t,e){this.instrumentationService=l,this.locService=n,this.officeRouteService=t,this.formsService=e,this.Success=1,this.Failed=2,this.thumbnailImgOnloadStatus=0,this.numOfFormsLabel=new S.a("")}return l.prototype.ngOnChanges=function(){this.formsGroupItemId!==this.formsGroupItem.id&&(this.getFormsInGroupSubscription&&this.getFormsInGroupSubscription.unsubscribe(),this.getNumberOfFormsLabel(),this.formsGroupItemId=this.formsGroupItem.id)},l.prototype.ngOnDestroy=l.prototype.ngOnInit=function(){this.formsGroupItemId=this.formsGroupItem.id,this.descriptiveAriaLabel=this.locService.format(this.locService.GroupOpenArialLabel,this.formsGroupItem.groupName),this.getNumberOfFormsLabel()},l.prototype.onClickLogTelemetry=function(){var l={};l.Index=this.index.toString(),this.instrumentationService.logClickEvent("Group_Item_Click","group-item",r.b.FormsGroups,null,null,l),Object(I.a)({eventName:"Group_Item_Click",id:"group-item",result:"Navigate",target:"GroupItem",area:"FormsGroups"})},l.prototype.onloadThumbnail=l.prototype.onClick=function(){this.onClickLogTelemetry(),this.officeRouteService.navigateTo({app:F.b.Forms,route:"GroupForms"},!1,{groupId:this.formsGroupItem.getId()})},l.prototype.getNumberOfFormsLabel=function(){var l=this;this.getFormsInGroupSubscription=this.formsService.getFormsInGroup(this.formsGroupItem.id,!1).results.subscribe((function(n){if(n&&n.value){var t=l.locService.format(l.locService.TotalFormsLabel,n.value.length.toString());l.numOfFormsLabel.next(t),l.descriptiveAriaLabel=l.locService.format(l.locService.GroupOpenArialLabel,l.formsGroupItem.groupName)+" "+t}}))},l}(),k=e.Fb({encapsulation:2,styles:[],data:{}});function L(l){return e.jc(0,[(l()(),e.Hb(0,0,null,null,2,"div",[["class","list-item--forms-group__group-icon ms-bgc-tp"]],null,null,null,null,null)),(l()(),e.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","ms-ohp-svg-Icon ms-ohp-Icon--group group-item--icon"],["size","20"]],null,null,null,g.b,g.a)),e.Gb(2,638976,null,0,v.a,[a.a],{cssClass:[0,"cssClass"],size:[1,"size"]},null)],(,null)}function C(l){return e.jc(0,[(l()(),e.Hb(0,0,null,null,0,"img",[["aria-hidden","true"],["class","list-item--forms-group__img ms-bgc-tp"]],[[8,"title",0],[8,"hidden",0],[8,"src",4]],[[null,"error"],[null,"load"]],(function(l,n,t){var e=!0,o=l.component;return"error"===n&&(e=!1!==o.onloadThumbnail(o.Failed)&&e),"load"===n&&(e=!1!==o.onloadThumbnail(o.Success)&&e),e}),null,null))],null,(function(l,n){var t=n.component;l(n,0,0,t.formsGroupItem.groupName,t.thumbnailImgOnloadStatus!==t.Success,t.formsGroupItem.thumbnailUrl)}))}function T(l){return e.jc(0,[(l()(),e.Hb(0,0,null,null,14,"div",[["class","list-item__body list-item__body--padded cursor--pointer"],["ohpDefaultLinkTarget",""],["rel","noopener"],["role","link"],["tabindex","0"]],[[1,"aria-label",0]],[[null,"click"],[null,"keyup.enter"],[null,"keyup.space"]],(,null,null)),(l()(),e.Hb(1,0,null,null,13,"div",[["aria-hidden","true"],["class","list-item__height-restrictor centered-flex-container"]],null,null,null,null,null)),(l()(),e.Hb(2,0,null,null,8,"div",[["class","centered-flex-container list-item-column places-column--name"]],null,null,null,null,null)),(l()(),e.Hb(3,0,null,null,4,"div",[["class","list-item__icon list-item--forms-group__icon-container"]],null,null,null,null,null)),(l()(),e.qb(16777216,null,null,1,null,L)),e.Gb(5,16384,null,0,G.k,[e.W,e.S],{ngIf:[0,"ngIf"]},null),(l()(),e.qb(16777216,null,null,1,null,C)),e.Gb(7,16384,null,0,G.k,[e.W,e.S],{ngIf:[0,"ngIf"]},null),(l()(),e.Hb(8,0,null,null,2,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),(l()(),e.Hb(9,0,null,null,1,"div",[["class","list-item__text--large list-item__title list-item__text--limited-width ms-fcl-nd"]],[[8,"title",0]],null,null,null,null)),(l()(),e.gc(10,null,["",""])),(l()(),e.Hb(11,0,null,null,3,"div",[["class","list-item-column"]],null,null,null,null,null)),(l()(),e.Hb(12,0,null,null,2,"div",[["class","list-item__text--small ms-fcl-np"]],null,null,null,null,null)),(l()(),e.gc(13,null,["",""])),e.Yb(131072,G.b,[e.h])],(function(l,n){var t=n.component;l(n,5,0,t.thumbnailImgOnloadStatus!==t.Success),l(n,7,0,t.formsGroupItem&&t.formsGroupItem.thumbnailUrl)}),(function(l,n){var t=n.component;l(n,0,0,t.descriptiveAriaLabel),l(n,9,0,t.formsGroupItem.groupName),l(n,10,0,t.formsGroupItem.groupName),l(n,13,0,e.hc(n,13,0,e.Wb(n,14).transform(t.numOfFormsLabel)))}))}e.Db("ohp-forms-group-item-component",_,(function(l){return e.jc(0,[(l()(),e.Hb(0,0,null,null,1,"ohp-forms-group-item-component",[],null,null,null,T,k)),e.Gb(1,770048,null,0,_,[r.a,m.a,y.a,c.a],null,null)],(function(l,n){l(n,1,0)}),null)}),{formsGroupItem:"formsGroupItem",index:"index"},{},[]);var w=t("hjJp"),x=t("345u"),H=t("W3Zz"),O=t("xoWf"),U=t("cgnd"),N=t("lrJm"),z=e.Fb({encapsulation:2,styles:[],data:{}});function j(l){return e.jc(0,[(l()(),e.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),e.Hb(1,0,null,null,1,"ohp-forms-group-item-component",[],null,null,null,T,k)),e.Gb(2,770048,null,0,_,[r.a,m.a,y.a,c.a],{formsGroupItem:[0,"formsGroupItem"],index:[1,"index"]},null)],(,null)}function E(l){return e.jc(0,[(l()(),e.Hb(0,0,null,null,11,"div",[["class","section--fluent"],["role","region"]],[[1,"aria-label",0]],null,null,null,null)),e.Gb(1,278528,null,0,G.i,[e.x,e.y,e.o,e.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Zb(2,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1}),(l()(),e.Hb(3,0,null,null,8,"div",[["id","groups-content"]],null,null,null,null,null)),(l()(),e.Hb(4,0,null,null,2,"div",[["class","section-header section-title--small"]],null,null,null,null,null)),(l()(),e.Hb(5,0,null,null,1,"h2",[["class","ms-fcl-nd heading2"],["id","section-header-title"],["style","display: inline-block;"]],null,null,null,null,null)),(l()(),e.gc(6,null,["",""])),(l()(),e.Hb(7,0,null,null,4,"ohp-tab-list",[],null,null,null,w.b,w.a)),e.Gb(8,4308992,null,1,x.b,[a.a,H.c,r.a,m.a,O.a,e.h,U.b,N.b],{model:[0,"model"],hideHeader:[1,"hideHeader"],defaultView:[2,"defaultView"]},null),e.cc(603979776,1,{tabListItems:1}),(l()(),e.qb(0,null,null,1,null,j)),e.Gb(11,16384,[[1,4]],0,x.c,[e.S],null,null)],(function(l,n){var t=n.component,e=l(n,2,0,!t.fluentRefresh,t.fluentRefresh);l(n,1,0,"section--fluent",e),l(n,8,0,t.tabListModel,!0,t.ITEM_VIEW)}),()}function M(l){return e.jc(0,[(l()(),e.qb(16777216,null,null,1,null,E)),e.Gb(1,16384,null,0,G.k,[e.W,e.S],{ngIf:[0,"ngIf"]},null)],(function(l,n){var t=n.component;l(n,1,0,null==t.tabListModel||null==t.tabListModel.tabs?null:t.tabListModel.tabs.length)}),null)}var A=e.Db("ohp-forms-groups-component",f,(function(l){return e.jc(0,[(l()(),e.Hb(0,0,null,null,1,"ohp-forms-groups-component",[],null,null,null,M,z)),e.Gb(1,245760,null,0,f,[a.a,c.a,r.a,s.a,m.a],null,null)],(,null)}),{},{},[]),R=t("xIlw"),W=t("+P5Z"),P=t("+a0u"),D=t("lQwO"),q=t("CfLe"),V=t("ej7j"),Z=t("X+PR"),B=t("VY7U"),J=t("CCRL"),Y=e.Eb(h,[],(function(l){return e.Tb([e.Ub(512,e.k,e.hb,[[8,[d.a,A]],[3,e.k],e.D]),e.Ub(4608,G.m,G.l,[e.z]),e.Ub(1073742336,G.c,G.c,[]),e.Ub(1073742336,R.a,R.a,[]),e.Ub(1073742336,W.a,W.a,[]),e.Ub(1073742336,P.a,P.a,[]),e.Ub(1073742336,D.a,D.a,[]),e.Ub(1073742336,q.a,q.a,[]),e.Ub(1073742336,V.a,V.a,[]),e.Ub(1073742336,Z.o,Z.o,[[2,Z.u],[2,Z.n]]),e.Ub(1073742336,B.a,B.a,[]),e.Ub(1073742336,h,h,[]),e.Ub(256,J.a,b,[])])}))}}]);
//# sourceMappingURL=forms-group.c761b40ef3a0c92c0b0d.chunk.v7.js.map