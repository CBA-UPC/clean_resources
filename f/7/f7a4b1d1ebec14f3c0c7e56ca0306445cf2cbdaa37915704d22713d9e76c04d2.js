"use strict";var TIMEOUT=150,BASE_NEEDLE_ANGLE=22.5,START_NEEDLE_MOVE_ANGLE=21,END_NEEDLE_MOVE_ANGLE=29,NEEDLE_ANGLE_INCREMENT=4.5,DECIMAL_MULTIPLIER=1e3,CLOSE_WIDGET_LINK="--close-widget--",PUSH_PERMISSION_LINK="--push-permission--",AP3_WIDGETS_PREFIX="ap_widgets_",HIDDEN_FIELDS_REGEX=/INPUT.hidden\/(.*?) /gm,HIDDEN_FIELDS_SUBSTITUTION="",cookies={SHOWN:"ap3shown",SHOWN_IN_CURRENT_SESSION:"ap3sess",PAGES_VISITED_IN_SESSION:"ap3pages",DISMISSED:"ap3dm",CONVERTED:"ap3converted",CUSTOM_CONSENT_TO_TRACK:"ap3cct"},frequencies={ALWAYS:"always",UNTIL_DIMISSED_OR_CONVERTED:"until dismissed",ONCE_PER_SESSION_OR_UNTIL_CONVERTED:"once per session",ONCE_PER_SESSION:"once per session",ONLY_ONCE:"only once",UNTIL_KNOWN:"until they are known"},preFillOptionIds={DONT_PRE_FILL:"dont_pre_fill",VIA_URL:"via_url"},visibilityOptionIds={HIDE_ON_PRE_FILL:"hide_on_pre_fill"},isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isIOSWebView=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),isAndroidWebView=function(){var ua=window.navigator.userAgent,isAndroid=/Android/.test(ua),isWebView=/wv/.test(ua)||/Version\/[\d.]+/.test(ua);return isAndroid&&isWebView},validShopifyCartAddPaths={"/cart/add.js":!0,"/cart/add":!0},validShopifyCartAddStatuses={200:!0,302:!0},urlParamKeys={AP_WIDGET:"ap_widget"},platforms={IOS:"ios",ANDROID:"android"},getUrlParams=function(search){var params={};return search&&search.slice(search.indexOf("?")+1).split("&").map(,params},getFieldType=function(el){if(-1!==el.className.indexOf("ap3w-input-areacode"))return"area-code";if(-1!==el.parentElement.className.indexOf("ap3w-input-select-option")||-1!==el.parentElement.className.indexOf("ap3w-form-input-select-option"))return"multi-select";var inputTypeAttr=el.parentElement.dataset&&el.parentElement.dataset.inputType;return inputTypeAttr||("number"===el.name||"date"===el.name||"datetime-local"===el.name?el.name:el.getAttribute("type"))},getDefaultValue=function(preFillOption,fieldId,el){if(!preFillOption||preFillOption===preFillOptionIds.DONT_PRE_FILL)return null;var queryParams=getUrlParams(window.location.search),fieldType=getFieldType(el),defaultValueFromParams=queryParams[fieldId],defaultValue=!defaultValueFromParams&&"areacode"===fieldType&&ap3c.country_code?ap3c.country_code:defaultValueFromParams;if(!defaultValue)return null;var inputTypeAttr=el.parentElement.dataset&&el.parentElement.dataset.inputType;switch("date"!==fieldType&&"datetime-local"!==fieldType||(el.type=inputTypeAttr||el.name,fieldType=el.type),fieldType){case"date":if(ap3c.date_format&&"dmy"===ap3c.date_format.substring(0,3))return defaultValue.split("-").reverse().join("-");if(ap3c.date_format&&"mdy"===ap3c.date_format.substring(0,3)){var month=(dateParts=defaultValue.split("-"))[0],day=dateParts[1];return dateParts[2]+"-"+month+"-"+day}return defaultValue;case"datetime-local":var dateTimeParts=defaultValue.split("T"),date=dateTimeParts[0],time=dateTimeParts[1];if(ap3c.date_format&&"dmy"===ap3c.date_format.substring(0,3))return date.split("-").reverse().join("-")+"T"+time;if(ap3c.date_format&&"mdy"===ap3c.date_format.substring(0,3)){var dateParts;month=(dateParts=date.split("-"))[0],day=dateParts[1];return dateParts[2]+"-"+month+"-"+day+"T"+time}return defaultValue;case"tel":return defaultValue.split("-")[1];case"area-code":return defaultValue.split("-")[0].replace("+","");case"checkbox":return"true"===defaultValue;case"multi-select":return-1!==defaultValue.split(",").indexOf(el.parentElement.dataset.value);default:return defaultValue}},populateSelectOptions=function(selectList,selectFieldEl,selectedOptions,isEmbeddableForm){var selectListTrigger=selectList.previousElementSibling,fieldDataAttributes=isEmbeddableForm?selectList.closest(".ap3w-form-input").dataset:selectList.closest(".ap3w-input").dataset,isMultiSelect="multi_select"===selectList.dataset.selectType,selectListId=isEmbeddableForm?selectList.dataset.newListId:selectList.dataset.listId;isMultiSelect&&selectFieldEl.firstElementChild.checked&&(selectedOptions[selectListId]||(selectedOptions[selectListId]=[]),selectedOptions[selectListId].push(selectFieldEl.dataset.value),selectFieldEl.classList.add("ap3w-form-input-select-option-selected"),selectListTrigger.innerText=selectedOptions[selectListId].join(", "),selectListTrigger.value=selectedOptions[selectListId]);var defaultValue=getDefaultValue(fieldDataAttributes.preFillOption,fieldDataAttributes.fieldId,selectFieldEl);isMultiSelect||defaultValue!==selectFieldEl.dataset.value||(selectedOptions[selectListId]=defaultValue,selectListTrigger.innerText=selectedOptions[selectListId],selectListTrigger.value=selectedOptions[selectListId]),fieldDataAttributes.hideIfValueExists&&fieldDataAttributes.fieldId in ap3c.field_values&&(selectListTrigger.parentNode.style.display="none"),fieldDataAttributes.visibility===visibilityOptionIds.HIDE_ON_PRE_FILL&&defaultValue&&(selectListTrigger.parentNode.style.display="none")},replacePlatformLinks=function(widgetContainerEl,platform){for(var selector=platform===platforms.ANDROID?"[data-android-url], [data-button-submit-android-url]":"[data-ios-url], [data-button-submit-ios-url]",anchorElements=widgetContainerEl.querySelectorAll(selector),i=0;i<anchorElements.length;i++){var anchorElement=anchorElements[i],url=anchorElement.dataset[platform===platforms.ANDROID?"androidUrl":"iosUrl"],formButtonSubmitUrl=anchorElement.dataset[platform===platforms.ANDROID?"buttonSubmitAndroidUrl":"buttonSubmitIosUrl"];formButtonSubmitUrl?anchorElement.dataset.buttonSubmitUrl=formButtonSubmitUrl:anchorElement.href=url}},isInViewport=function(element){var rect=element.getBoundingClientRect(),html=document.documentElement;return 0<=rect.top&&0<=rect.left&&rect.bottom<=(window.innerHeight||html.clientHeight)&&rect.right<=(window.innerWidth||html.clientWidth)},getTimeFromSeconds=function(seconds,display){return seconds<=0?{days:0,hours:0,minutes:0,seconds:0}:-1!==display.indexOf("DD")?{days:Math.floor(seconds/86400),hours:Math.floor(seconds%86400/3600),minutes:Math.floor(seconds%3600/60),seconds:Math.floor(seconds%60)}:-1!==display.indexOf("HH")?{days:0,hours:Math.floor(seconds/3600),minutes:Math.floor(seconds%3600/60),seconds:Math.floor(seconds%60)}:-1!==display.indexOf("MM")?{days:0,hours:0,minutes:Math.floor(seconds/60),seconds:Math.floor(seconds%60)}:{days:0,hours:0,minutes:0,seconds:seconds}},uA=navigator.userAgent,vendor=navigator.vendor;if(!("SubmitEvent"in self&&"submitter"in SubmitEvent.prototype)){var submitter=Symbol.for("submitter");Event[submitter]=null;var submitterSelector="input[type=submit], input[type=image], input[type=button], button";Object.defineProperty(Event.prototype,"submitter",{get:function(){if("submit"===this.type){var node=Event[submitter],form=this.target;return node&&form.contains(node)||(node=form.querySelector(submitterSelector)),node||form}},set:),self.addEventListener("click",function(event){var _node$closest,_node$closest2,node=event.composedPath()[0],closest=null!==(_node$closest=null===(_node$closest2=node.closest)||void 0===_node$closest2?void 0:_node$closest2.call(node,submitterSelector))&&void 0!==_node$closest?_node$closest:null;Event[submitter]=closest},!0)}String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(search,rawPos){var pos=0<rawPos?0|rawPos:0;return this.substring(pos,pos+search.length)===search}}),String.prototype.endsWith||(String.prototype.endsWith=,Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),String.prototype.trimStart||(String.prototype.trimStart=function(){return this.replace(/^\s+/,"")}),String.prototype.trimEnd||(String.prototype.trimEnd=,Element.prototype.closest||(Element.prototype.closest=,"remove"in Element.prototype||(Element.prototype.remove=;var jsonFromXhr=function(url,method,requestPayload,onFetched){if("ZB5Vs9u5KFKmMvhVY3ViYnliZWRz"!==ap3c.uniqueID&&"YBoahW3g05-xsBX1c3RnYWN0aXZpdGllcw"!==ap3c.uniqueID||!window.fetch){var req=new XMLHttpRequest;req.open(method,url),req.onload=function(){if(200<=req.status&&req.status<300){var jsonResponse=JSON.parse(req.responseText);onFetched(jsonResponse)}else console.error("XMLHttpRequest error:",req.statusText)},req.onerror=req.send(JSON.stringify(requestPayload))}else fetch(url,{method:method,body:JSON.stringify(requestPayload)}).then(function(response){return response.json()}).then(.catch(function(error){console.error("Fetch error:",error)})};history.pushState=function(f){return function(){var ret=f.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),ret}}(history.pushState),history.replaceState=history.replaceState),window.addEventListener("popstate",;var sortObjectAndToString=function(obj){var keys=Object.keys(obj),len=keys.length;keys.sort();for(var result="",i=0;i<len;i++){result+=keys[i]+"|"+JSON.stringify(obj[keys[i]])}return result},calcTrackKey=function(options){return sortObjectAndToString(options||{})+"|"+window.location.href};function readCookie(key){for(var parts=document.cookie.split(";"),i=0;i<parts.length;i++){var cookie=parts[i];if(cookie&&(cookie=cookie.trimStart()).startsWith(key+"="))return cookie.split("=")[1]}return""}unction convertLegacyCookies(widget){var legacy=readCookie(widget.id);if(legacy)return"shown"!==legacy?ap3c.setFrequencyCookie(cookies.SHOWN_IN_CURRENT_SESSION,widget.id,!0):ap3c.setFrequencyCookie(cookies.SHOWN,widget.id),removeCookie(widget.id),!0}function convertLegacyPageFilter(filter){if(0===Object.keys(filter||{}).length)return filter;var operator=filter.$and?"$and":"$or",conditions=filter[operator];if("$and"===Object.keys(conditions[0]||{})[0]||"$or"===Object.keys(conditions[0]||{})[0])return filter;var newFilter={};newFilter[operator]=[];var newConditionGroup={};return newConditionGroup[operator]=conditions,newFilter[operator].push(newConditionGroup),newFilter}function isPageFilterValid(filter){var currentUrl=window.location.href,groupResult=!1,conditionResult=!1,pageFilter=convertLegacyPageFilter(filter);if(pageFilter){var orConditionGroup=pageFilter.$or,andConditionGroup=pageFilter.$and,pageConditionGroup=orConditionGroup||andConditionGroup;if(pageConditionGroup)for(var groupIndex=0;groupIndex<pageConditionGroup.length;groupIndex++){var conditions=pageConditionGroup[groupIndex],andConditions=pageConditionGroup[groupIndex].$and,orConditions=pageConditionGroup[groupIndex].$or;conditions=andConditions||orConditions;conditionResult=!andConditionGroup&&groupResult;for(var conditionIndex=0;conditionIndex<conditions.length;conditionIndex++){var condition=conditions[conditionIndex],type=Object.keys(condition)[0],v=condition[type];switch(type){case"$str::is":var isMatch=v.value.toLowerCase()===currentUrl.toLowerCase();conditionResult=andConditions?isMatch:conditionResult||isMatch;break;case"$str::is_not":var isNotMatch=v.value.toLowerCase()!==currentUrl.toLowerCase();conditionResult=andConditions?isNotMatch:conditionResult||isNotMatch;break;case"$str::starts":var isStartMatch=currentUrl.toLowerCase().startsWith(v.value.toLowerCase());conditionResult=andConditions?isStartMatch:conditionResult||isStartMatch;break;case"$str::ends":var isEndMatch=currentUrl.toLowerCase().endsWith(v.value.toLowerCase());conditionResult=andConditions?isEndMatch:conditionResult||isEndMatch;break;case"$str::contains":var isContainsMatch=-1!==currentUrl.toLowerCase().indexOf(v.value.toLowerCase());conditionResult=andConditions?isContainsMatch:conditionResult||isContainsMatch;break;case"$str::does_not_contain":var isDoesNotContainMatch=-1===currentUrl.toLowerCase().indexOf(v.value.toLowerCase());conditionResult=andConditions?isDoesNotContainMatch:conditionResult||isDoesNotContainMatch}if(groupResult=conditionResult,andConditions&&!conditionResult)break}if(andConditionGroup&&!groupResult)break}}return groupResult}function isKnownSession(){var sessionID=ap3c.getCookie();if(!sessionID)return!1;for(var b64Encoded="",i=0;i<sessionID.length;i++){var ch=sessionID[i];switch(ch){case"_":b64Encoded+="/";break;case"-":b64Encoded+="+";break;default:b64Encoded+=ch}}var mod=b64Encoded.length%4;2<=mod&&mod<=3&&(b64Encoded+="=".repeat(4-mod));try{var decoded=atob(b64Encoded);if(decoded&&0<decoded.length)return 0==decoded.charCodeAt(0)}catch(err){return console.error(err),!0}return!1}ap3c.trackedFormWidgets={},ap3c.__jq=window.jQuery,ap3c.setConsentToTrack=ap3c.nonce="",ap3c.init=function(uniqueID,apiHost,options){if(!uniqueID)throw new Error("Ortto tracking code init failed with invalid uniqueID");if(!apiHost)throw new Error("Ortto tracking code init failed with invalid API host");if(ap3c.uniqueID&&ap3c.apiHost)console.log("Ortto tracking code already initted");else{"https://capture-api.autopilotapp.com/"===apiHost&&(apiHost="https://capture-api.ap3prod.com/"),void 0!==options&&options&&""!==options.nonce&&(ap3c.nonce=options.nonce),ap3c.payloadEnrichers=[],ap3c.staticActions=["shopify_subscribe","shopify_product_viewed","shopify_product_added_to_cart"],ap3c.staticActionsFuncs={shopify_subscribe:ap3c._shopifySubscribeAction,shopify_product_viewed:ap3c._shopifyProductViewedAction,shopify_product_added_to_cart:ap3c._shopifyProductAddedToCartAction},ap3c.activity=ap3c.widgetsFuncs={popup:ap3c._generalWidget,bar:ap3c._generalWidget,notification:ap3c._generalWidget,takeover:ap3c._generalWidget,form:ap3c._generalWidget,"spin-the-wheel":ap3c._generalWidget,"tracked-form":ap3c._trackedForm,prompt:ap3c._generalWidget,banner:ap3c._generalWidget,shopify_waiting_on_stock:ap3c._shopifyWaitingOnStockWidget,talk:ap3c._talkWidget},ap3c.processStaticActions=function(){if(ap3c.staticActions)for(var i=0;i<ap3c.staticActions.length;i++)ap3c.staticActionsFuncs[ap3c.staticActions[i]].canExecute&&ap3c.staticActionsFuncs[ap3c.staticActions[i]].canExecute()&&ap3c.staticActionsFuncs[ap3c.staticActions[i]].execute()};try{ap3c.uniqueID=uniqueID,ap3c.apiHost=apiHost;var qsTalkToken=getUrlParams(window.location.search).tt;if(options){options.cookieDomains&&(ap3c.cookieDomains=options.cookieDomains,"h"===options.link&&ap3c.hLinks(),"g"===options.link&&ap3c.gLinks()),ap3c.customecommerce=options.customecommerce||{},ap3c.magento=options.magento||{},ap3c.woocommerce=options.woocommerce||{},ap3c.disableWidgets=options.disableWidgets,ap3c.customConsentToTrack=options.customConsentToTrack||!1;var apTalkOption=options.talk;apTalkOption?(apTalkOption.disableCookie||(apTalkOption.token?(ap3c.talk.token=apTalkOption.token,ap3c.talk.setToken(apTalkOption.token)):qsTalkToken&&(ap3c.talk.token=qsTalkToken,ap3c.talk.setToken(ap3c.talk.token))),apTalkOption.cookiePath&&(ap3c.talk.cookiePath=apTalkOption.cookiePath)):qsTalkToken&&(ap3c.talk.token=qsTalkToken,ap3c.talk.setToken(ap3c.talk.token))}else qsTalkToken&&(ap3c.talk.token=qsTalkToken,ap3c.talk.setToken(ap3c.talk.token));ap3c.enableTalk=!(options&&options.disableTalk),ap3c.processStaticActions(),ap3c.setVisitedPagesCookie(),ap3c.callAfterInit=function(){ap3c._processWidgets(void 0,{callbacks:{onDone:function(){ap3c.enableTalk&&(options&&options.captureDomain&&(ap3c.talk.captureDomain=options.captureDomain),!(!apTalkOption||!apTalkOption.hiddenOnLoad)||ap3c.talk.init())}}})},window.addEventListener("locationchange",function(){setTimeout(2e3),ap3c.track(ap3c.lastVars||{})}),window.addEventListener("load",function(){var bodyList=document.querySelector("body"),found=!1;new MutationObserver(function(mutations){mutations.forEach(function(mutation){if(!found)return"childList"===mutation.type&&mutation.target&&mutation.target.querySelector("form")?(ap3c._processWidgets(!0),void(found=!0)):void 0})}).observe(bodyList,{childList:!0,subtree:!0})})}catch(e){console.error("Error initializing Ortto tracking code",e)}}},ap3c.talk={localStorageKey:"ap_talk",localStorageContactKey:"ap_talk_contact",tokenCookieName:"ap3c_talk",token:null,cookiePath:void 0,captureDomain:null,hasInitRequested:!1,hasScriptInjected:!1,baseAssetPath:null,isModernBrowser:!1,commands:[],__eventListeners:{},addEventListener:removeEventListener:function(eventName,handler){var eventHandlers=this.__eventListeners[eventName];eventHandlers&&(this.__eventListeners[eventName]=eventHandlers.filter()},notifyEvent:function(eventName){var eventHandlers=this.__eventListeners[eventName];if(eventHandlers){var args=Array.prototype.slice.call(arguments,1);eventHandlers.forEach(}},execute:function(cmd,args){this.commands.push({cmd:cmd,args:args}),"show"!==cmd||this.hasInitRequested||this.init()},_checkModuleSupport:function(){return"supports"in HTMLScriptElement?HTMLScriptElement.supports("module"):"noModule"in document.createElement("script")},injectModernBrowserDetector:function(callback){if(!1===this._checkModuleSupport())return callback();var script=document.createElement("script"),blob=new Blob(['try{import.meta.url;import("_").catch(()=>1);async function* g(){};if(location.protocol!="file:"){window.ap3c.talk.isModernBrowser=true}}catch(e){};'],{type:"text/javascript"});cript.src=URL.createObjectURL(blob),script.async=!0,script.type="module",script.onload=handleCallback,""!==ap3c.nonce&&(script.nonce=ap3c.nonce),script.onerror=handleCallback,document.head.appendChild(script)},init:function(){this.hasInitRequested=!0;var config=this.getConfig();config&&config.settings.enabled&&(this.hasScriptInjected||(this.baseAssetPath=(this.captureDomain||config.capture_domain||"https://cdn2l.ink/").replace(/(\/)*$/,"/"),"https://static.ap3stg.com/capture/master/"===this.baseAssetPath&&(this.baseAssetPath="https://static.ap3stg.com/"),this.injectModernBrowserDetector(function(){var script=document.createElement("script"),baseAssetPath=ap3c.talk.baseAssetPath;script.async=!0,ap3c.talk.isModernBrowser?(script.type="module",script.src=baseAssetPath+"talk-widget.js"):(script.type="text/javascript",script.src=baseAssetPath+"polyfills-legacy.js",script.onload=,document.head.appendChild(script)}),this.hasScriptInjected=!0,void 0!==config.font_urls&&config.font_urls.length&&ap3c.injectCustomFonts(config.font_urls)))},saveConfig:getConfig:function(){try{return JSON.parse(localStorage.getItem(this.localStorageKey))||null}catch(e){return null}},removeConfig:function(){localStorage.removeItem(this.localStorageKey)},removeTalkContact:setToken:function(token){ap3c.setCookie(token,this.tokenCookieName,this.cookiePath)},getToken:removeToken:invalidate:,ap3c.addStaticAction=function(key,action){ap3c.staticActions=ap3c.staticActions||[],ap3c.staticActions.push(key),ap3c.staticActionsFuncs=ap3c.staticActionsFuncs||{},ap3c.staticActionsFuncs[key]=action},ap3c.addStaticActionAndProcess=function(key,action){ap3c.addStaticAction(key,action),action.canExecute&&action.canExecute()&&action.execute()},ap3c.checkCookieDomainMatch=function(domain){if(!ap3c.cookieDomains||!domain)return null;for(var i=0;i<ap3c.cookieDomains.length;i++)if(domain.match(ap3c.cookieDomains[i]))return ap3c.cookieDomains[i];return!1},ap3c.checkCurrentDomainMatch=function(cookieDomain){return cookieDomain?!!window.location.href.match(cookieDomain):null},ap3c.hLinks=function(){var c=ap3c.getCookie();if(c)for(var anchors=document.getElementsByTagName("a"),i=0;i<anchors.length;i++){var cookieDomain=ap3c.checkCookieDomainMatch(anchors[i].href);cookieDomain&&!ap3c.checkCurrentDomainMatch(cookieDomain)&&(4<anchors[i].href.indexOf("#")||(anchors[i].href=anchors[i].href+"#ap3c"+c))}},ap3c.gLinks=function(){var c=ap3c.getCookie();if(c)for(var anchors=document.getElementsByTagName("a"),i=0;i<anchors.length;i++){var cookieDomain=ap3c.checkCookieDomainMatch(anchors[i].href);if(cookieDomain&&!ap3c.checkCurrentDomainMatch(cookieDomain))if(4<anchors[i].href.indexOf("?"))anchors[i].href=anchors[i].href+"&ap3c="+c;else{var parts=anchors[i].href.split("#");1<parts.length?anchors[i].href=parts[0]+"?ap3c="+c+"#"+parts[1]:anchors[i].href=anchors[i].href+"?ap3c="+c}}},ap3c.getCookie=function(){var c=document.cookie.match(new RegExp("(^| )ap3c=([^;]+)")),cookie=c&&c[2]||"";return"undefined"===cookie?null:cookie},ap3c.setCookie=function(value,key,path){var _path=path||"/",domain="",expires=new Date;if(expires.setFullYear(expires.getFullYear()+1),ap3c.cookieDomains)for(var i=0;i<ap3c.cookieDomains.length;i++){var d=ap3c.cookieDomains[i];d.startsWith(".")&&(d=d.substr(1)),-1!=window.location.host.indexOf(d)&&(domain=ap3c.cookieDomains[i])}var cookie=(key||"ap3c").trim()+"="+value+";path="+_path+";expires="+expires.toUTCString();domain&&(cookie+=";domain="+domain),cookie+=";Secure",document.cookie=cookie},ap3c.setKnownSession=function(sessionId){if(ap3c.known_session=sessionId,ap3c.activity=ap3c._activity,ap3c.act){for(var actIdx=0;actIdx<ap3c.act.length;actIdx++)ap3c._activity(ap3c.act[actIdx]);ap3c.act=[]}},ap3c.substituteElem=function(el,replacement){var c,childNodes=[];if(el.childNodes)for(;c=el.childNodes[0];)el.removeChild(c),childNodes.push(c);null==replacement?(replacement=el.cloneNode(!1)).dataset.ap3cReplacement=!0:delete replacement.dataset.ap3cReplacement;for(var i=0;i<childNodes.length;i++)replacement.appendChild(childNodes[i]);return el.parentNode.replaceChild(replacement,el),replacement},"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(serviceWorkerRegistration){serviceWorkerRegistration.pushManager.getSubscription&&serviceWorkerRegistration.pushManager.getSubscription().then(.catch(function(err){console.log(err)})}).catch(,ap3c.setVisitedPagesCookie=function(){for(var parts=document.cookie.split(";"),currentValue=1,i=0;i<parts.length;i++){var cookie=parts[i].trim();if(cookie.startsWith(cookies.PAGES_VISITED_IN_SESSION))currentValue=+cookie.split("=")[1]+1}document.cookie=cookies.PAGES_VISITED_IN_SESSION+"="+currentValue+";path=/"},ap3c.readCurrentState=function(widgets){if(widgets){for(var i=0;i<widgets.length;i++)convertLegacyCookies(widgets[i]);removeCookie("ap3known");var parts=document.cookie.split(";"),ap3Cookies={};for(i=0;i<parts.length;i++){if((cookie=parts[i].trim()).startsWith("ap3")){var keyValue=cookie.split("=");2==keyValue.length&&(ap3Cookies[keyValue[0].trimEnd()]=keyValue[1].trimStart())}}var state={IS_KNOWN_SESSION:isKnownSession()};for(var key in cookies){var cookie;if(cookie=ap3Cookies[cookies[key]]){var widgetIDs=cookie.split(","),parsed={};for(i=0;i<widgetIDs.length;i++)parsed[widgetIDs[i]]=!0;state[key]=parsed}else state[key]={}}return state}},ap3c.setFrequencyCookie=function(key,widgetID,isSessionCookie){var cookie=readCookie(key);if(cookie?cookie.includes(widgetID)||(cookie+=","+widgetID):cookie=widgetID,isSessionCookie)document.cookie=key+"="+cookie+";path=/";else{var expires=new Date;expires.setFullYear(expires.getFullYear()+1),document.cookie=key+"="+cookie+";expires="+expires.toUTCString()+";path=/"}},ap3c.detectTouch=function(){var prefixes=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||["(",prefixes.join("touch-enabled),("),"heartz",")"].join(""))},ap3c.injectCustomFonts=function(fontUrls){fontUrls.forEach(function(font){if(font&&!document.getElementById(font)){var link=document.createElement("link");link.id=font,link.rel="stylesheet",link.type="text/css",link.href=font,link.media="all",document.head.appendChild(link)}})},ap3c.logError=function(payload,callback){try{var url=ap3c.apiHost+"-/error";jsonFromXhr(url,"POST",payload,function(res){callback&&callback(res)})}catch(err){options&&options.log&&console.error("Error logging an error",err)}},ap3c._activity=function(act,options,callback){if(ap3c.known_session)try{var payload={s:ap3c.known_session,h:ap3c.uniqueID,activity:{activity_id:act.activity_id,attributes:act.attributes}},url=ap3c.apiHost+"-/events/activity";jsonFromXhr(url,"POST",payload,function(res){callback&&callback(res)})}catch(err){options&&options.log&&console.error("Error track activity",err)}};var widgetsAccepted=[];function getShopifyProductCurrentVariantId(){var variantIdFromUrl=getUrlParams(window.location.search).variant,variantIdFromShopify=window.ShopifyAnalytics.meta.selectedVariantId,variantIdByDefault=ap3c.shopifyProductDefaultVariantId;return variantIdFromUrl||variantIdFromShopify||variantIdByDefault}ap3c.track=function(options,callback){var currentTrackKey;if((!ap3c.customConsentToTrack||"true"===readCookie(cookies.CUSTOM_CONSENT_TO_TRACK))&&(options&&options.cw||(currentTrackKey=calcTrackKey(options),ap3c.trackKey!==currentTrackKey))){var now=new Date;try{var loc=window.location.href,qs=loc.split("?"),params={};if(1<qs.length){var qsp=qs[1].split("&");for(var i in qsp)if("string"==typeof qsp[i]){var kv=qsp[i].split("=");params[kv[0]]=decodeURIComponent(kv[1])}}var hp=loc.split("#ap3c"),ap3ch=1<hp.length?hp[1]:null,payload={s:ap3c.getCookie()||params.ap3c||ap3ch||null,c:options.contactId||params.apcid||null,ac:options.ac||null,fs:options.fs,ei:options.ei||null,cw:options.cw,sh:options.sh,wc:options.wc,ps:options.ps,bc:options.bc,sw:options.sw,ce:options.ce,mg:options.mg,sq:options.sq,e:options.email||params.email||null,p:options.phone||params.phone||null,first:options.first||params.first||null,last:options.last||params.last||null,h:ap3c.uniqueID,u:loc,t:document.title,r:document.referrer,us:params.utm_source,um:params.utm_medium,un:params.utm_campaign,ut:params.utm_term,uc:params.utm_content,l:navigator.language,sx:window.screen.width,sy:window.screen.height,sr:window.devicePixelRatio,pm:options.pm,pl:options.pl||params.pl||null,sub:options.sub||params.sub,pwse:options.pwse||params.pwse||ap3c.existingPushSubscriptionEndpoint,wpbk:options.wpbk||params.wpbk,v:options&&options.v||0,ts:!!ap3c.detectTouch(),id:options.widget_id,ag:!!ap3c.getCookie()||options.accepted,sne:options.skipNonExisting,discount_id:options.discount_id,tk:!!ap3c.enableTalk,rc:options.rc,ottlk:readCookie("ottlk"),ft:options.forTalk,cc:options.cc};if(ap3c.payloadEnrichers)for(i=0;i<ap3c.payloadEnrichers.length;i++)payload=ap3c.payloadEnrichers[i](payload,options);var apiPath=options.apiPath||"-/events/page-event",url=ap3c.apiHost+apiPath;jsonFromXhr(url,"POST",payload,function(res){(callback&&callback(res),res.session_id)&&(res.known&&ap3c.setKnownSession(res.session_id),ap3c.setCookie(res.session_id),payload.s!==res.session_id&&ap3c.talk.invalidate(),res.gdpr_widget_id&&(document.cookie=res.gdpr_widget_id+"="+res.session_id+";path=/"));if(res.widgets){var data={},localWidgetsData=ap3c.getWidgetsData();try{data=JSON.parse(localWidgetsData)}catch(error){console.log("invalid local widgets data",localWidgetsData)}var expiry=data&&data.expiry||now.getTime()+3e5;ap3c.setLocalStorage(JSON.stringify({expiry:expiry,widgets:res.widgets,enabled_gdpr:res.enabled_gdpr,recaptcha_site_key:res.recaptcha_site_key||ap3c.recaptcha_site_key,service_worker_url:res.service_worker_url||ap3c.service_worker_url,country_code:res.country_code||ap3c.country_code,date_format:res.date_format||ap3c.date_format,field_values:res.field_values||ap3c.field_values,cdn_url:res.cdn_url||ap3c.cdn_url})),ap3c.country_code=res.country_code||ap3c.country_code,ap3c.date_format=res.date_format||ap3c.date_format,ap3c.field_values=res.field_values||ap3c.field_values,ap3c.cdn_url=res.cdn_url||ap3c.cdn_url}res.talk&&ap3c.talk.saveConfig(res.talk),options&&options.cw&&"widget_shown"!==options.cw.type&&options.cw.widget_id&&-1===widgetsAccepted.indexOf(options.cw.widget_id)&&widgetsAccepted.push(options.cw.widget_id),options&&options.sh&&options.sh.widget_id&&-1===widgetsAccepted.indexOf(options.sh.widget_id)&&widgetsAccepted.push(options.sh.widget_id),options&&options.sw&&options.sw.widget_id&&-1===widgetsAccepted.indexOf(options.sw.widget_id)&&widgetsAccepted.push(options.sw.widget_id),ap3c.callAfterInit&&(ap3c.callAfterInit.call(),ap3c.callAfterInit=void 0)}),currentTrackKey&&(ap3c.trackKey=currentTrackKey,ap3c.lastVar=options)}catch(e){console.error("Error running Ortto track page",e)}}},ap3c.kbArticleActivity=function(options,callback){if(options.type){"feedback"===options.type&&options.feedback&&!options.feedback_category&&(options.feedback_category="Bug");try{var loc=window.location.href,qs=loc.split("?"),params={};if(1<qs.length){var qsp=qs[1].split("&");for(var i in qsp)if("string"==typeof qsp[i]){var kv=qsp[i].split("=");params[kv[0]]=decodeURIComponent(kv[1])}}var hp=loc.split("#ap3c"),ap3ch=1<hp.length?hp[1]:null,payload={s:ap3c.getCookie()||params.ap3c||ap3ch||null,h:ap3c.uniqueID,a:window.kbArticleID,type:options.type,solved:options.solved,feedback_category:options.feedback_category,feedback:options.feedback},apiPath=options.apiPath||"-/events/kb-activity",url=ap3c.apiHost+apiPath;jsonFromXhr(url,"POST",payload,function(res){callback&&callback(res)})}catch(e){console.error("Error running kb article activity",e)}}},ap3c.submitTrackForm=function(options,callback){ap3c.track({apiPath:"-/events/cw-event",email:options.email,phone:options.phone,first:options.firstName,last:options.lastName,cw:{widget_id:options.widgetId,type:"track_form",shown_on_url:window.location.href,attributes:options.attributes,rc:ap3c.recaptcha}},callback)},ap3c.trackPageVisit=function(options,callback){try{var loc=options.url||window.location.href,qs=loc.split("?"),params={};if(1<qs.length){var qsp=qs[1].split("&");for(var i in qsp)if("string"==typeof qsp[i]){var kv=qsp[i].split("=");params[decodeURIComponent(kv[0])]=decodeURIComponent(kv[1])}}var hp=loc.split("#ap3c"),ap3ch=1<hp.length?hp[1]:null,payload={s:ap3c.getCookie()||params.ap3c||ap3ch||null,c:options.contactId||params.apcid||null,ac:options.ac||null,fs:options.fs,ei:options.ei||null,e:options.email||params.email||null,p:options.phone||params.phone||null,first:options.first||params.first||null,last:options.last||params.last||null,h:ap3c.uniqueID,u:loc,t:document.title,r:document.referrer,us:params.utm_source,um:params.utm_medium,un:params.utm_campaign,ut:params.utm_term,uc:params.utm_content,l:navigator.language,sx:window.screen.width,sy:window.screen.height,sr:window.devicePixelRatio,sub:options.sub||params.sub,v:options&&options.v||0,ts:!!ap3c.detectTouch(),id:options.widget_id,ag:!!ap3c.getCookie()||options.accepted,sne:options.skipNonExisting},url=ap3c.apiHost+"-/events/page-event";jsonFromXhr(url,"POST",payload,}catch(e){console.error("Error running Ortto track page",e)}},ap3c.localStorageKey="ap_capture_widgets",ap3c.getWidgetsData=ap3c.removeWidgetsData=ap3c.setLocalStorage=ap3c.clearSession=function(){var domain="";if(ap3c.cookieDomains)for(var i=0;i<ap3c.cookieDomains.length;i++){var d=ap3c.cookieDomains[i];d.startsWith(".")&&(d=d.substr(1)),-1!=window.location.host.indexOf(d)&&(domain=ap3c.cookieDomains[i])}var cookie="ap3c=;expires=Thu, 01 Jan 1970 00:00:00 GMT";domain&&(cookie+=";domain="+domain),document.cookie=cookie,ap3c.removeWidgetsData(),ap3c.talk.removeConfig(),ap3c.talk.removeTalkContact()},ap3c.addWigetAndProcess=function(key,widgetFunc,reprocessEmbeddedForm){ap3c.widgetsFuncs[key]=widgetFunc;try{var data=ap3c.getWidgetsData();if(data){var items=JSON.parse(data),widgets=items.widgets,hasLogo=items.hasLogo,widget=widgets.find(;if(widget){if(-1!==window.location.href.indexOf(widget.id))return;var state=ap3c.readCurrentState(widgets);if(!widgetFunc.canExecute(widget,state))return;if("form"===key)return void widgetFunc.injectEmbeddableForm(widget,reprocessEmbeddedForm);try{widgetFunc.execute(widget,hasLogo)}catch(err){console.error(err)}if(widget.has_recaptcha&&!document.getElementById("ap3w-recaptcha-"+ap3c.uniqueID)){var onloadCallbackFuncBody="if (document.getElementById('ap3w-recaptcha-v2-"+widget.id+"')){ grecaptcha.render('ap3w-recaptcha-v2-"+widget.id+"', { 'sitekey': '"+ap3c.recaptcha_site_key+"', 'callback': verifyCallback, }); } ";ap3c.injectRecaptcha(onloadCallbackFuncBody)}}}}catch(e){console.error(e)}},ap3c._processWidgets=function(reprocessEmbeddedForm,options){var now=new Date,_options=options||{callbacks:{}};try{var data=ap3c.getWidgetsData();if(data){var item=JSON.parse(data);if(now.getTime()<item.expiry){if(_widgets=item.widgets,ap3c.recaptcha_site_key=item.recaptcha_site_key,ap3c.service_worker_url=item.service_worker_url,ap3c.country_code=item.country_code,ap3c.date_format=item.date_format,ap3c.field_values=item.field_values,ap3c.cdn_url=item.cdn_url,reprocessEmbeddedForm)var _widgets=item.widgets.filter(function(w){return"form"===w.type||"tracked-form"===w.type});return ap3c._runWidgets(_widgets,item.hasLogo,reprocessEmbeddedForm),void("function"==typeof _options.callbacks.onDone&&_options.callbacks.onDone())}ap3c.removeWidgetsData(),ap3c.talk.removeConfig()}var url=ap3c.apiHost+"-/widgets/get",loc=window.location.href,qs=loc.split("?"),params={};if(1<qs.length){var qsp=qs[1].split("&");for(var i in qsp)if("string"==typeof qsp[i]){var kv=qsp[i].split("=");params[kv[0]]=decodeURIComponent(kv[1])}}var hp=loc.split("#ap3c"),ap3ch=1<hp.length?hp[1]:null,payload={s:ap3c.getCookie()||params.ap3c||ap3ch||null,c:params.apcid||null,e:params.email||null,p:params.phone||null,h:ap3c.uniqueID,pwse:ap3c.existingPushSubscriptionEndpoint,tk:!!ap3c.enableTalk,tt:ap3c.talk.getToken()||null,u:loc,ottlk:readCookie("ottlk")};jsonFromXhr(url,"POST",payload,function(resp){var widgets=resp.widgets||[],hasLogo=resp.has_logo;resp.session_id&&(resp.known&&ap3c.setKnownSession(resp.session_id),ap3c.setCookie(resp.session_id),payload.s!==resp.session_id&&ap3c.talk.invalidate());if(console.log("set widgets local storage",widgets),ap3c.setLocalStorage(JSON.stringify({expiry:now.getTime()+3e5,widgets:widgets,hasLogo:hasLogo,enabled_gdpr:resp.enabled_gdpr,recaptcha_site_key:resp.recaptcha_site_key,service_worker_url:resp.service_worker_url,country_code:resp.country_code,date_format:resp.date_format,field_values:resp.field_values||{},cdn_url:resp.cdn_url})),resp.talk&&ap3c.talk.saveConfig(resp.talk),_widgets=widgets,reprocessEmbeddedForm)var _widgets=widgets.filter(;ap3c.recaptcha_site_key=resp.recaptcha_site_key,ap3c.service_worker_url=resp.service_worker_url,ap3c.country_code=resp.country_code,ap3c.date_format=resp.date_format,ap3c.field_values=resp.field_values||{},ap3c.cdn_url=resp.cdn_url,console.log("run widgets now"),ap3c._runWidgets(_widgets,hasLogo,reprocessEmbeddedForm),"function"==typeof _options.callbacks.onDone&&_options.callbacks.onDone()})}catch(e){console.error(e)}},ap3c._runWidgets=function(widgets,hasLogo,reprocessEmbeddedForm){if(widgets&&0!==widgets.length){widgets.sort(;var state=ap3c.readCurrentState(widgets),hasRecaptcha=!1,needLoadJQuery=!1,onloadCallbackFuncBody="";widgets.forEach(function(widget){if(-1===window.location.pathname.indexOf(widget.id))if(ap3c.widgetsFuncs[widget.type]){if(ap3c.widgetsFuncs[widget.type].canExecute(widget,state)){if("tracked-form"===widget.type)return ap3c.__jq?(console.log("jQuery already loaded"),void(ap3c.widgetsFuncs["tracked-form"].canExecute(widget)&&ap3c.widgetsFuncs["tracked-form"].execute(widget,!1))):(needLoadJQuery=!0,void(ap3c.trackedFormWidgets[widget.id]||(ap3c.trackedFormWidgets[widget.id]=widget)));if("form"===widget.type){var resp=ap3c.widgetsFuncs[widget.type].injectEmbeddableForm(widget,reprocessEmbeddedForm);return resp=resp||{},hasRecaptcha=hasRecaptcha||resp._hasRecaptcha,void(-1===onloadCallbackFuncBody.indexOf(widget.id)&&(onloadCallbackFuncBody+=resp._onloadCallbackFuncBody||""))}if(widget&&widget.has_recaptcha){var isShowOnClick=widget.trigger&&"click"===widget.trigger.selection||widget.when&&"click"===widget.when.selection,hasTrigger=!1;isShowOnClick&&(widget.trigger&&"click"===widget.trigger.selection?document.querySelector(widget.trigger.value)&&(hasTrigger=!0):widget.when&&"click"===widget.when.selection&&document.querySelector(widget.when.value)&&(hasTrigger=!0)),(!isShowOnClick||isShowOnClick&&hasTrigger)&&(hasRecaptcha=!0,-1===onloadCallbackFuncBody.indexOf(widget.id)&&(onloadCallbackFuncBody+="if (document.getElementById('ap3w-recaptcha-required-"+widget.id+"')) {var allForms = document.querySelectorAll('#ap3w-recaptcha-required-"+widget.id+"');\n for (var i=0; i < allForms.length; i++) {allForms[i].style.display='none';}}\n if (document.getElementById('ap3w-recaptcha-v2-"+widget.id+"')){ var allForms = document.querySelectorAll('#ap3w-recaptcha-v2-"+widget.id+"');\n for (var i=0; i < allForms.length; i++) { grecaptcha.render(allForms[i], { 'sitekey': '"+ap3c.recaptcha_site_key+"', 'callback': verifyCallback})}\n} "))}if(!widget.push_permissions||!ap3c.existingPushSubscriptionEndpoint)try{ap3c.widgetsFuncs[widget.type].execute(widget,hasLogo)}catch(err){console.error(err)}}}else console.warn("Missing widget:",widget.type)}),needLoadJQuery&&ap3c.injectjQuery(),hasRecaptcha&&!document.getElementById("ap3w-recaptcha-"+ap3c.uniqueID)&&(console.log("tring to injectRecaptcha"),ap3c.injectRecaptcha(onloadCallbackFuncBody))}},ap3c.injectRecaptcha=function(onloadCallbackFuncBody){var callbackScript=document.createElement("script");callbackScript.innerHTML=' var verifyCallback = function(response) { ap3c.recaptcha = response; var requiredText=document.getElementsByClassName("ap3w-recaptcha-required")&&document.getElementsByClassName("ap3w-recaptcha-required")[0]; if(requiredText){requiredText.style.display="none";} }; var recaptchaOnloadCallback = function () { '+onloadCallbackFuncBody+" }; ",document.head.appendChild(callbackScript);var script=document.createElement("script");script.id="ap3w-recaptcha-"+ap3c.uniqueID,script.src="https://www.google.com/recaptcha/api.js?onload=recaptchaOnloadCallback&render=explicit",script.async=!0,script.defer=!0,document.head.appendChild(script)},ap3c.injectjQuery=function(){if(0<Object.keys(ap3c.trackedFormWidgets).length&&!ap3c.__jq){var script=document.createElement("script");script.src="https://code.jquery.com/jquery-1.12.4.min.js",script.addEventListener("load",function(){for(var id in ap3c.__jq=window.jQuery.noConflict(!0),ap3c.trackedFormWidgets){ap3c.widgetsFuncs["tracked-form"].canExecute(ap3c.trackedFormWidgets[id])&&ap3c.widgetsFuncs["tracked-form"].execute(ap3c.trackedFormWidgets[id],!1)}}),document.head.appendChild(script)}},ap3c.getFormFieldsData=function(widget,inputClassName,selectedOptions,container){var isEmbeddableForm="ap3w-form-input"===inputClassName,formFields=container.getElementsByClassName(inputClassName),fields=[];selectedOptions=selectedOptions||[];for(var index=0;index<formFields.length;index++){var formSelectionRequired,value=0<formFields[index].getElementsByTagName("input").length&&formFields[index].getElementsByTagName("input")[0].value;if(0<formFields[index].getElementsByTagName("input").length){if("number"===getFieldType(formFields[index].getElementsByTagName("input")[0])&&(value="any"===formFields[index].getElementsByTagName("input")[0].step?parseInt(+formFields[index].getElementsByTagName("input")[0].value*DECIMAL_MULTIPLIER):+formFields[index].getElementsByTagName("input")[0].value),"checkbox"===formFields[index].getElementsByTagName("input")[0].type&&(value=formFields[index].getElementsByTagName("input")[0].checked),"tel"===formFields[index].getElementsByTagName("input")[formFields[index].getElementsByTagName("input").length-1].type||formFields[index].getElementsByTagName("input")[0].lastElementChild&&"tel"===formFields[index].getElementsByTagName("input")[0].lastElementChild.type){var areaCodeInput=document.getElementById("ap3w-input-areacode-"+widget.id),phoneNumberInput=document.getElementById("ap3w-input-phone-"+widget.id);value=areaCodeInput&&""!==areaCodeInput.value?0===areaCodeInput.value.indexOf("+")?{c:areaCodeInput.value,n:phoneNumberInput.value}:{c:"+"+areaCodeInput.value,n:phoneNumberInput.value}:{n:phoneNumberInput.value}}var field=formFields[index].getElementsByTagName("input")[0];if("date"===getFieldType(field)){var dateString=formFields[index].getElementsByTagName("input")[0].value;if(dateString)value={year:+dateString.substr(0,4),month:+dateString.substr(5,2),day:+dateString.substr(8,2)};else value=null}if("datetime-local"===formFields[index].getElementsByTagName("input")[0].type){var inputDate=formFields[index].getElementsByTagName("input")[0].value;if(inputDate)value=new Date(inputDate).toISOString();else value=null}}if(-1!==formFields[index].lastElementChild.className.indexOf("ap3w-input-select-list")||-1!==formFields[index].lastElementChild.className.indexOf("ap3w-form-input-select-list")){if(isEmbeddableForm)var listId=formFields[index].lastElementChild.dataset.newListId;else listId=formFields[index].lastElementChild.dataset.listId;value=selectedOptions&&selectedOptions[listId]&&selectedOptions[listId].length?selectedOptions[listId]:-1!==formFields[index].lastElementChild.dataset.selectType.indexOf("multi_select")?[]:null}if(formFields[index].getElementsByClassName("ap3w-form-input-select-unstyled")&&0<formFields[index].getElementsByClassName("ap3w-form-input-select-unstyled").length){var selectNode=formFields[index].getElementsByClassName("ap3w-form-input-select-unstyled")[0],_selectedOpts=[];if((selectedOptions=selectNode.selectedOptions)&&selectedOptions.length)for(var i=0;i<selectedOptions.length;i++)_selectedOpts.push(selectedOptions[i].value);value=_selectedOpts,selectNode.multiple||(value=_selectedOpts[0])}0<formFields[index].getElementsByTagName("textarea").length&&(value=formFields[index].getElementsByTagName("textarea")[0].value),formSelectionRequired=isEmbeddableForm?formFields[index].lastElementChild.dataset.required:formFields[index].lastElementChild.dataset.fieldRequired,fields.push({field_id:formFields[index].dataset.fieldId,value:value,merge_strategy:formFields[index].dataset.mergeStrategy,required:formSelectionRequired})}return fields},ap3c._trackedForm={localStorageKey:AP3_WIDGETS_PREFIX,canExecute:function(widget,state){return function(widget,state){if(widget.page.selection&&"any"===widget.page.selection)return!0;var _isPageFilterValid=isPageFilterValid(widget.page.filter);return"exclude"===widget.page.selection?!_isPageFilterValid:_isPageFilterValid}(widget)},replayEvent:function(event,type,originalElem){if("submit"===type){var submitButton=originalElem.querySelector('input[type="submit"],button[type="submit"]');if(submitButton&&submitButton.click&&"function"==typeof submitButton.click)return void submitButton.click();if(originalElem&&originalElem.submit&&"function"==typeof originalElem.submit)return void originalElem.submit()}else if("click"===type&&originalElem&&originalElem.click&&"function"==typeof originalElem.click)return void originalElem.click();if("submit"===type&&!originalElem.onsubmit&&!originalElem.submit&&originalElem.action){var serialized=ap3c.__jq(originalElem).serialize();window.location.replace(originalElem.action+"?"+serialized)}var newEvent,excludedEvents={cancelBubble:!0,composed:!0,currentTarget:!0,deepPath:!0,defaultPrevented:!0,eventPhase:!0,explicitOriginalTarget:!0,originalTarget:!0,returnValue:!0,srcElement:!0,scoped:!0,target:!0,type:!0,timeStamp:!0,isTrusted:!0},EventClass=event.constructor||Event;EventClass===Object&&(EventClass=Event);var opts={view:event.view||window,bubbles:event.bubbles||!0,cancelable:event.cancelable||!0};for(var k in event){var v=event[k];excludedEvents[k]||(opts[k]=v)}try{newEvent=new EventClass(event.type,opts)}catch(err){(newEvent=document.createEvent("Event")).initEvent(type,!0,!1)}return originalElem.dispatchEvent(newEvent)},execute:function(widget,hasLogo){var isWebflow=!!window.Webflow,isUnbounce=!!window.ub,isThematic="https://getthematic.com"===window.location.origin,compatibleMode=isWebflow||isUnbounce||isThematic||widget.compatible,replay=this.replayEvent.bind(this),injectFormSubmissionInterception=function(forms,widget){var f=void 0;for(var hash in forms){var currentForm=forms[hash];hash!==widget.tracked_form.hash&&ap3c.Sha256.hash(currentForm.fingerprint.replace(HIDDEN_FIELDS_REGEX,HIDDEN_FIELDS_SUBSTITUTION))!==ap3c.Sha256.hash(widget.tracked_form.fingerprint.replace(HIDDEN_FIELDS_REGEX,HIDDEN_FIELDS_SUBSTITUTION))||(f=forms[hash])}if(f)for(var hasSubmitted=!1,i=0;i<f.elements.length;i++){var _f=ap3c.__jq(f.elements[i]),fClassName=_f.attr("class")||"",fId=_f.attr("id")||"",useSimpleListener=compatibleMode||-1!==fClassName.indexOf("wpcf7")||-1!==fId.indexOf("gform_");_f.find("input[id]:not([name])").each(function(){var field=ap3c.__jq(this);return field.attr("name",field.attr("id"))});for(var buttons=_f.find("input[type=button], button, #mktFrmSubmit").filter("[type!=reset]").filter("[type!=submit]").toArray()||[],oldForm=f.elements[i],dateFieldsName={},emailFieldName=void 0,emailVal=void 0,j=0;j<f.fields.length;j++)"date"===f.fields[j].type||"date"===f.fields[j].name||"datetime-local"===f.fields[j].type?f.fields[j].name&&(dateFieldsName[f.fields[j].name]=!0):"email"!==f.fields[j].type&&"email"!==f.fields[j].name&&"regular_Email"!==f.fields[j].guess||(emailFieldName=f.fields[j].name);if(useSimpleListener)console.log("use simple listener but not intercept"),oldForm.addEventListener("submit",function(e){console.log("submit on form",oldForm,e);for(var apPayload=ap3c.__jq(e.target).serializeArray(),k=0;k<apPayload.length;k++)if(dateFieldsName[apPayload[k].name]&&apPayload[k].value)try{apPayload[k].value=new Date(apPayload[k].value).toISOString()}catch(e){}else emailFieldName&&apPayload[k].name===emailFieldName&&(emailVal=apPayload[k].value);return ap3c.track({apiPath:"-/events/cw-event",email:emailVal,cw:{widget_id:widget.id,type:"track_form",shown_on_url:window.location.href,attributes:apPayload}}),!1});else{if(oldForm.dataset&&oldForm.dataset.ap3cReplacement)continue;var newForm=ap3c.substituteElem(f.elements[i]);newForm.removeAttribute("onsubmit"),newForm.onsubmit=function(event){if(!hasSubmitted){hasSubmitted=!0,event.preventDefault(),event.stopPropagation();var apPayload=ap3c.__jq(event.target).serializeArray();console.log("event",event,"tracked payload",apPayload);for(var k=0;k<apPayload.length;k++)if(dateFieldsName[apPayload[k].name]&&apPayload[k].value)try{apPayload[k].value=new Date(apPayload[k].value).toISOString()}catch(e){}else emailFieldName&&apPayload[k].name===emailFieldName&&(emailVal=apPayload[k].value);return ap3c.track({apiPath:"-/events/cw-event",email:emailVal,cw:{widget_id:widget.id,type:"track_form",shown_on_url:window.location.href,attributes:apPayload}},function(){hasSubmitted=!1,"redirect-workflow"===widget.workflow&&widget.redirect_url?widget.redirect_url.startsWith("http")?window.location.replace(widget.redirect_url):window.location.replace("https://"+widget.redirect_url):(oldForm=ap3c.substituteElem(newForm,oldForm),replay(event,"submit",oldForm))}),!1}};for(j=0;j<buttons.length;j++){var oldButton=buttons[j],newButton=ap3c.substituteElem(buttons[j]);newButton.removeAttribute("onclick"),newButton.onclick=function(event){if(!hasSubmitted){hasSubmitted=!0,event.preventDefault(),event.stopPropagation();var apPayload=ap3c.__jq(newForm).serializeArray();return ap3c.track({apiPath:"-/events/cw-event",email:emailVal,cw:{widget_id:widget.id,type:"track_form",shown_on_url:window.location.href,attributes:apPayload}},function(){hasSubmitted=!1,"redirect-workflow"===widget.workflow&&widget.redirect_url?window.location.replace(widget.redirect_url):(ap3c.substituteElem(newButton,oldButton),replay(event,"click",oldButton))}),!1}}}}}else console.log("no form found")};if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",function(){var forms=ap3c.scanForm(window);injectFormSubmissionInterception(forms,widget)});else{var forms=ap3c.scanForm(window);injectFormSubmissionInterception(forms,widget)}}},ap3c._generalWidget={countdownInterval:void 0,ttl:36e5,localStorageKey:AP3_WIDGETS_PREFIX,canExecute:function(widget,state){if(!ap3c.disableWidgets&&"form"===widget.type)return!0;if(getUrlParams(window.location.search)[urlParamKeys.AP_WIDGET]===widget.id)return!0;return function(widget,state){if(ap3c.disableWidgets||!widget.page)return!1;if(widget.trigger&&widget.trigger.selection){var triggerShowOnClick=widget.trigger&&"click"===widget.trigger.selection,showBasedOnFrequency=!0,showBasedOnStop=!0;if(widget.is_gdpr)showBasedOnFrequency=!state.CONVERTED[widget.id]&&!state.DISMISSED[widget.id];else{switch(widget.frequency){case frequencies.ALWAYS:break;case frequencies.ONLY_ONCE:showBasedOnFrequency=!state.SHOWN_IN_CURRENT_SESSION[widget.id]&&!state.SHOWN[widget.id]&&!state.DISMISSED[widget.id];break;case frequencies.ONCE_PER_SESSION:showBasedOnFrequency=!state.SHOWN_IN_CURRENT_SESSION[widget.id]}if(widget.trigger.stop&&widget.trigger.stop.length){var stopOnConversion=-1!==widget.trigger.stop.indexOf("convert"),stopOnDismiss=-1!==widget.trigger.stop.indexOf("dismiss");(stopOnConversion&&state.CONVERTED[widget.id]||-1!==stopOnDismiss&&state.DISMISSED[widget.id])&&(showBasedOnStop=!1)}}if(!(triggerShowOnClick||showBasedOnFrequency&&showBasedOnStop))return!1}else{var showOnClick=widget.when&&"click"===widget.when.selection;if(showBasedOnFrequency=!0,widget.is_gdpr)showBasedOnFrequency=!state.CONVERTED[widget.id]&&!state.DISMISSED[widget.id];else switch(widget.frequency){case frequencies.ALWAYS:break;case frequencies.UNTIL_KNOWN:showBasedOnFrequency=!state.IS_KNOWN_SESSION;break;case frequencies.UNTIL_DIMISSED_OR_CONVERTED:showBasedOnFrequency=!state.CONVERTED[widget.id]&&!state.DISMISSED[widget.id];break;case frequencies.ONLY_ONCE:showBasedOnFrequency=!state.SHOWN_IN_CURRENT_SESSION[widget.id]&&!state.SHOWN[widget.id]&&!state.DISMISSED[widget.id];break;case frequencies.ONCE_PER_SESSION_OR_UNTIL_CONVERTED:showBasedOnFrequency=!state.CONVERTED[widget.id]&&!state.SHOWN_IN_CURRENT_SESSION[widget.id]}if(!showOnClick&&!showBasedOnFrequency)return!1}if(widget.page.selection&&"any"===widget.page.selection)return!0;var _isPageFilterValid=isPageFilterValid(widget.page.filter);return"exclude"===widget.page.selection?!_isPageFilterValid:_isPageFilterValid}(widget,state)&&function(widget){return!!widget.page&&(widget.page.platforms?-1!==widget.page.platforms.indexOf("web_desktop")&&!isMobile||-1!==widget.page.platforms.indexOf("web_mobile")&&isMobile:!!(!widget.page.device||"all"===widget.page.device||"mobile"===widget.page.device&&isMobile||"desktop"===widget.page.device&&!isMobile))}(widget)},execute:function(widget,hasLogo){var inject=this.inject.bind(this);"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){inject(widget,hasLogo)}):inject(widget,hasLogo)},requestPushPermission:function(widget){function subscribeFunction(_publicKey,widget){navigator.serviceWorker.ready.then(function(registration){return registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:_publicKey)})}).then(function(_subscription){_subscription?ap3c.existingPushSubscriptionEndpoint=_subscription.endpoint:(ap3c.logError({url:window.location.href,message:"Push subscription is not defined",log_level:"debug",details:{error:"Push subscription is not defined",error_data:JSON.stringify({subscription:_subscription,widget:widget,publicKey:_publicKey})}}),console.error("Push subscription is not defined",_subscription)),ap3c.track({apiPath:"-/events/push-subscription",sub:_subscription,wpbk:_publicKey,cw:{widget_id:widget.id}})}).catch(function(err){ap3c.logError({url:window.location.href,message:"Push subscription error",log_level:"debug",details:{error:JSON.stringify(err),error_data:JSON.stringify({widget:widget,publicKey:_publicKey})}}),console.error("Push subscription failed",err)})}Notification.requestPermission(function(_permission){"granted"!==_permission&&"denied"!==_permission||ap3c.track({apiPath:"-/events/push-permission",pm:"granted"===_permission,pl:"web",cw:{widget_id:widget.id}},function(res){!function(response,widget){if(response&&response.registration){var publicKey=response.registration.public_key;"serviceWorker"in navigator&&navigator.serviceWorker.register(ap3c.service_worker_url||"/service-worker.js",{scope:"/"}).then(.then(function(_subscription){_subscription?_subscription.unsubscribe().then(.catch(:subscribeFunction(publicKey,widget)}).catch(function(err){ap3c.logError({url:window.location.href,message:"Push service-worker registration error",log_level:"error",details:{error:JSON.stringify(err),error_data:JSON.stringify({widget:widget,publicKey:_publicKey,serviceWorkerUrl:ap3c.service_worker_url})}}),console.error(err)})}}(res,widget)})}),ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),ap3c._generalWidget.hide(widget,"do-not-fire-dismiss")},copyToClipboard:function(value){var tempInput=document.createElement("input");tempInput.value=value,tempInput.style.opacity=0,document.body.appendChild(tempInput),tempInput.select(),document.execCommand("copy"),document.body.removeChild(tempInput)},hide:function(widget,templateName){var shownOnClick=widget.trigger&&"click"===widget.trigger.selection||(!widget.trigger||!widget.trigger.selection)&&widget.when&&"click"===widget.when.selection,widgetContainer=document.getElementById(widget.id);if(templateName)var widgetTemplate=document.getElementById(widget.id+"-"+templateName);else widgetTemplate=widgetContainer&&widgetContainer.children&&widgetContainer.children[0];var videoIframes=document.getElementsByClassName("ap3w-youtube-video");if(videoIframes)for(var i=0;i<videoIframes.length;i++)videoIframes[i].contentWindow.postMessage('{"event":"command","func":"stopVideo","args":""}',"*");if(widgetTemplate&&widgetTemplate.children&&-1!==widgetTemplate.children[0].className.indexOf("ap3w-wrapper"))for(var wrapperChildren=widgetTemplate.children[0].children,index=0;index<wrapperChildren.length;index++)wrapperChildren[index].classList.length&&wrapperChildren[index].classList.remove("ap3w-show");else if(widgetTemplate&&widgetTemplate.children)for(index=0;index<widgetTemplate.children.length;index++)widgetTemplate.children[index].classList.length&&widgetTemplate.children[index].classList.remove("ap3w-show");setTimeout(function(){widgetTemplate&&(widgetTemplate.style.display="none"),widgetContainer&&(templateName||(widgetContainer.style.display="none"),shownOnClick||widgetContainer.remove())},TIMEOUT),-1===widgetsAccepted.indexOf(widget.id)&&(ap3c.setFrequencyCookie(cookies.DISMISSED,widget.id),templateName||ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_dismissed",shown_on_url:window.location.href}}))},injectTexts:function(widget){for(var widgetTexts=document.getElementsByClassName("ap3w-text-"+widget.id),textIdx=0;textIdx<widgetTexts.length;textIdx++)for(var aTags=widgetTexts[textIdx].getElementsByTagName("a"),aIdx=0;aIdx<aTags.length;aIdx++)aTags[aIdx].onclick=function(e){e.preventDefault();var href=e.target.href,target=e.target.target;href||(href=e.target.parentElement.href),href&&-1===href.indexOf(CLOSE_WIDGET_LINK)&&-1===href.indexOf(PUSH_PERMISSION_LINK)?(ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_url_clicked",shown_on_url:window.location.href,attributes:{clicked:href}}},function(){"_blank"===target?window.open(href,"_blank","noopener, noreferrer"):window.location.assign(href)})):href&&-1!==href.indexOf(CLOSE_WIDGET_LINK)?ap3c._generalWidget.hide(widget):href&&-1!==href.indexOf(PUSH_PERMISSION_LINK)?ap3c._generalWidget.requestPushPermission(widget):console.log("unknown event",e)}},hideFloatingButton:function(widget){for(var widgetTemplate=document.getElementById(widget.id+"-button"),widgetTemplateWrapper=widgetTemplate.children[0],index=0;index<widgetTemplateWrapper.children.length;index++)widgetTemplateWrapper.children[index].classList.length&&widgetTemplateWrapper.children[index].classList.remove("ap3w-show");setTimeout(TIMEOUT)},handleCountDown:function(countdown){var timer=countdown.dataset.timer,type=countdown.dataset.type,display=countdown.dataset.display,daysElement=document.querySelector(".ap3w-countdown__time-value-days"),hoursElement=document.querySelector(".ap3w-countdown__time-value-hours"),minsElement=document.querySelector(".ap3w-countdown__time-value-minutes"),secsElement=document.querySelector(".ap3w-countdown__time-value-seconds"),secondsLeft=timer;if("date"===type){var now=new Date,timerDate=new Date(timer);secondsLeft=(timerDate.getTime()-now.getTime())/1e3}this.countdownInterval=setInterval(function(){if((secondsLeft-=1)<1)secsElement&&(secsElement.innerText=0,secsElement.nextElementSibling.innerText="Secs"),clearInterval(this.countdownInterval);else{var timeleftObject=getTimeFromSeconds(secondsLeft,display);if(!secsElement)return void clearInterval(this.countdownInterval);secsElement.innerText=timeleftObject.seconds,1===timeleftObject.seconds?secsElement.nextElementSibling.innerText="Sec":secsElement.nextElementSibling.innerText="Secs",minsElement&&(minsElement.innerText=timeleftObject.minutes,1===timeleftObject.minutes?minsElement.nextElementSibling.innerText="Min":minsElement.nextElementSibling.innerText="Mins"),hoursElement&&(hoursElement.innerText=timeleftObject.hours,1===timeleftObject.hours?hoursElement.nextElementSibling.innerText="Hr":hoursElement.nextElementSibling.innerText="Hrs"),daysElement&&(daysElement.innerText=timeleftObject.days,1===timeleftObject.days?daysElement.nextElementSibling.innerText="Day":daysElement.nextElementSibling.innerText="Days")}},1e3)},injectVideo:function(widget,videoThumb,videoIframe){videoThumb.addEventListener("click",function(event){event.preventDefault(),videoThumb.style.display="none",videoIframe.src=videoThumb.dataset.videosrc,videoIframe.style.display="block",ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_video_watched",shown_on_url:window.location.href,attributes:{watched:videoThumb.dataset.videosrc}}})})},show:function(widget,templateName,delay){delay=void 0!==delay?delay:10;var hide=this.hide.bind(this),hideFloatingButton=this.hideFloatingButton.bind(this),injectTexts=this.injectTexts.bind(this),show=this.show.bind(this),shouldntFadeIn="bar"===widget.type&&(widget.trigger&&"load"===widget.trigger.selection||!widget.trigger&&widget.when&&"0"===widget.when.value),isSpinToWin="spin-to-win"===templateName;ap3c.injectCustomFonts(widget.font_urls);var widgetContainer=document.getElementById(widget.id);if(templateName)var widgetTemplate=document.getElementById(widget.id+"-"+templateName);else widgetTemplate=widgetContainer.children[0];var thankYouTemplate=document.getElementById(widget.id+"-thank-you"),outcomeTemplate=document.getElementById(widget.id+"-outcome"),overlays=document.querySelectorAll(".ap3w-overlay");setTimeout(function(){var state=ap3c.readCurrentState([widget]);if(ap3c._generalWidget.canExecute(widget,state)){setTimeout(function(){for(var i=0;i<overlays.length;i++)overlays[i].classList.add("ap3w-show");if(thankYouTemplate)if(-1!==thankYouTemplate.children[0].className.indexOf("ap3w-wrapper"))for(i=0;i<thankYouTemplate.children[0].children.length;i++)thankYouTemplate.children[0].children[i].classList.add("ap3w-show");else for(i=0;i<thankYouTemplate.children.length;i++)thankYouTemplate.children[i].classList.add("ap3w-show");if(outcomeTemplate)for(i=0;i<outcomeTemplate.children.length;i++)outcomeTemplate.children[i].classList.add("ap3w-show")}),widgetContainer.style.display="block",widgetTemplate&&(widgetTemplate.style.display="flex",setTimeout(function(){for(var i=0;i<widgetTemplate.children.length;i++){if(widgetTemplate.children[i].classList.length&&(shouldntFadeIn?(widgetTemplate.children[widgetTemplate.children.length-1].classList.add("ap3w-dont-fade-in"),setTimeout(function(){widgetTemplate.children[widgetTemplate.children.length-1].classList.add("ap3w-show"),setTimeout(function(){widgetTemplate.children[widgetTemplate.children.length-1].classList.remove("ap3w-dont-fade-in")},50)})):widgetTemplate.children[i].classList.add("ap3w-show")),-1!==widgetTemplate.children[i].className.indexOf("ap3w-wrapper"))for(var wrapperChildren=widgetTemplate.children[0].children,j=0;j<wrapperChildren.length;j++)wrapperChildren[j].classList.length&&wrapperChildren[j].classList.add("ap3w-show");if(-1!==widgetTemplate.id.indexOf(widget.id+"-spin-to-win")){var spinTheWheelContentDivs=widgetTemplate.getElementsByClassName("ap3w-spin-the-wheel-content");spinTheWheelContentDivs&&spinTheWheelContentDivs.length&&spinTheWheelContentDivs[0].classList.add("ap3w-show")}}}));var floatingButtonTemplate=document.getElementById("ap3w-floating-button-"+widget.id);if(floatingButtonTemplate){floatingButtonTemplate.onmouseover=function(){hideFloatingButton(widget),setTimeout(function(){show(widget,"spin-to-win"),widgetContainer.style.pointerEvents="all";var spinTheWheelContentDivs=widgetContainer.getElementsByClassName("ap3w-spin-the-wheel-content");spinTheWheelContentDivs&&spinTheWheelContentDivs.length&&spinTheWheelContentDivs[0].classList.add("ap3w-show")},2*TIMEOUT)}}var acceptGDPRButton=document.getElementById("ap3w-gdpr-accept-"+widget.id)||widgetContainer.querySelector("#ap3w-gdpr-accept")||document.getElementById("ap3w-button-accept-cookies-"+widget.id);acceptGDPRButton&&(acceptGDPRButton.onclick=function(){ap3c.track({accepted:!0,cw:{widget_id:widget.id,type:"widget_shown",shown_on_url:window.location.href}}),ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),hide(widget,templateName)}),injectTexts(widget);for(var widgetButtons=document.getElementsByClassName("ap3w-button-"+widget.id),buttonIdx=0;buttonIdx<widgetButtons.length;buttonIdx++)for(var aTags=widgetButtons[buttonIdx].getElementsByTagName("a"),aIdx=0;aIdx<aTags.length;aIdx++)aTags[aIdx].onclick=function(e){""!==e.href&&(ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_url_clicked",shown_on_url:window.location.href,attributes:{clicked:e.target.href}}}))};ap3c.setFrequencyCookie(cookies.SHOWN_IN_CURRENT_SESSION,widget.id,!0),ap3c.setFrequencyCookie(cookies.SHOWN,widget.id),isSpinToWin||ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_shown",shown_on_url:window.location.href}})}},[delay])},showAfterSubmit:function(widget,originalTemplate,targetTemplate,embeddedContainer){var hide=this.hide.bind(this),injectVideo=this.injectVideo.bind(this),handleCountDown=this.handleCountDown.bind(this),requestPushPermission=this.requestPushPermission.bind(this),injectTexts=this.injectTexts.bind(this),setHeight=function(element,height){"form"!==widget.type&&(element.style.maxHeight=height+"px",element.style.height=height+"px")};if(embeddedContainer)originalTemplate=embeddedContainer.parentElement,targetTemplate=embeddedContainer.parentElement.nextElementSibling;else originalTemplate=document.getElementById(widget.id+"-"+originalTemplate),targetTemplate=document.getElementById(widget.id+"-"+targetTemplate);if(-1!==originalTemplate.children[0].className.indexOf("ap3w-wrapper")){var wrapperChildren=originalTemplate.children[0].children,originalHeight=wrapperChildren[wrapperChildren.length-1].offsetHeight;originalTemplate.innerHTML=targetTemplate.innerHTML;var newHeight=originalTemplate.children[0].children[originalTemplate.children[0].children.length-1].offsetHeight;setHeight(originalTemplate.children[0].children[originalTemplate.children[0].children.length-1],originalHeight),setTimeout(function(){setHeight(originalTemplate.children[0].children[originalTemplate.children[0].children.length-1],newHeight)})}else{originalHeight=originalTemplate.children[originalTemplate.children.length-1].offsetHeight;originalTemplate.innerHTML=targetTemplate.innerHTML;newHeight=originalTemplate.children[originalTemplate.children.length-1].offsetHeight;setHeight(originalTemplate.children[originalTemplate.children.length-1],originalHeight),setTimeout(function(){setHeight(originalTemplate.children[originalTemplate.children.length-1],newHeight)})}document.documentElement.scrollIntoView&&"form"===widget.type&&!isInViewport(originalTemplate)&&originalTemplate.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});var surveyFeedbackForm=document.getElementById("ap3w-survey-feedback-form-"+widget.id);surveyFeedbackForm&&surveyFeedbackForm.addEventListener("submit",function(event){event.preventDefault();var formSubmitButton=document.getElementById("ap3w-input-submit-"+widget.id),formTextArea=document.getElementById("ap3w-input-textarea-"+widget.id),buttonOnClick=formSubmitButton.dataset.buttonOnClick,buttonSubmitUrl=formSubmitButton.dataset.buttonSubmitUrl;formTextArea.value&&ap3c.track({apiPath:"-/events/survey-feedback",cw:{widget_id:widget.id,type:"widget_survey_feedback",shown_on_url:window.location.href,attributes:{feedback:formTextArea.value}}},function(){"go-to-url"===buttonOnClick?window.location.assign(buttonSubmitUrl):hide(widget,"")})});var videoThumb=document.querySelector("#ap3w-video-thumbnail--inner-"+widget.id),videoIframe=document.querySelector("#ap3w-youtube-video-"+widget.id);videoThumb&&videoIframe&&injectVideo(widget,videoThumb,videoIframe);var pushPermissionButtons=document.querySelectorAll("#ap3w-button-push-permission-"+widget.id);if(pushPermissionButtons)for(var i=0;i<pushPermissionButtons.length;i++){pushPermissionButtons[i].addEventListener("click",function(event){event.preventDefault(),requestPushPermission(widget)})}injectTexts(widget);var countdown=document.querySelector("#ap3w-countdown-"+widget.id);countdown&&handleCountDown(countdown)},spinTheWheel:function(widget,response,widgetContainer){var showAfterSubmit=this.showAfterSubmit.bind(this),needleContainerDiv=document.getElementById("needle-container-"+widget.id),descriptionTextDiv=widgetContainer.querySelector("#selected-ap3w-spin-the-wheel-description-text"),copyCodeButtonDiv=widgetContainer.querySelector("#selected-ap3w-spin-the-wheel-copy-button"),couponDiv=document.getElementById("ap3w-wheel-coupon-"+widget.id),couponCodeText=document.getElementById("ap3w-coupon-code-text-"+widget.id),couponCodeActionDiv=document.getElementById("ap3w-coupon-code-copy-"+widget.id),spinTheWheelContentDivs=widgetContainer.getElementsByClassName("ap3w-spin-the-wheel-content"),rotatingContentDivs=widgetContainer.getElementsByClassName("ap3w-wheel--rotating-content");if(!response||response.error)var description="<h2>Theres been an error. Please try again soon.</h2>";else var code=response.code,discount=response.discount,title=(description=discount&&discount.description,discount&&discount.title),buttonText=discount&&discount.primaryButtonValue,buttonUrl=discount&&discount.primaryButtonUrl,couponActionButtonText=discount&&discount.couponActionButtonText;discount&&code?couponCodeText?couponCodeText.innerText=code:couponDiv.innerText=code:(couponDiv.parentNode.remove(),copyCodeButtonDiv.remove()),copyCodeButtonDiv&&buttonText&&(copyCodeButtonDiv.firstChild.innerText=buttonText),copyCodeButtonDiv&&buttonUrl&&copyCodeButtonDiv.firstChild.setAttribute("href",buttonUrl),couponCodeActionDiv&&couponActionButtonText&&(couponCodeActionDiv.innerText=couponActionButtonText),description?descriptionTextDiv.firstChild.innerHTML=description:descriptionTextDiv.remove();for(var spinLabels=Array.prototype.slice.call(widgetContainer.getElementsByClassName("ap3w-wheel--coupon-label")),selectedDiscountIndex=0,i=0;i<8;i++)if(spinLabels[i].innerHTML===title){selectedDiscountIndex=i;break}var targetSpin=0-(1800+[0,45,90,135,180,225,270,315][selectedDiscountIndex]),spinDegrees=targetSpin,currentSpin=0;rotatingContentDivs[0].classList.add("ap3w-spinning");var interval=setInterval(function(){if(spinDegrees<0){-.5<spinDegrees?spinDegrees=0:currentSpin=targetSpin-(spinDegrees/=1.005),rotatingContentDivs[0].style.transform="rotate("+currentSpin+"deg)";var fixed45Spin=Math.abs(currentSpin%45);if(START_NEEDLE_MOVE_ANGLE<fixed45Spin&&fixed45Spin<END_NEEDLE_MOVE_ANGLE){var degrees=BASE_NEEDLE_ANGLE+(fixed45Spin-START_NEEDLE_MOVE_ANGLE)*NEEDLE_ANGLE_INCREMENT;needleContainerDiv.style.transform="rotate("+degrees+"deg)"}else needleContainerDiv.style.transform="rotate("+BASE_NEEDLE_ANGLE+"deg)"}else clearInterval(interval),spinTheWheelContentDivs[0].classList.remove("ap3w-show"),setTimeout(function(){rotatingContentDivs[0].classList.remove("ap3w-spinning"),rotatingContentDivs[1].style.transform=rotatingContentDivs[0].style.transform,showAfterSubmit(widget,"spin-to-win","outcome"),spinTheWheelContentDivs[0].classList.add("ap3w-show")},TIMEOUT)},5)},injectEmbeddableForm:function(widget,reprocessEmbeddedForm){var ttl=this.ttl,selectedOptions={},showAfterSubmit=this.showAfterSubmit.bind(this),getFormFieldsData=ap3c.getFormFieldsData.bind(this),hasRecaptcha=!1,onloadCallbackFuncBody="";ap3c.injectCustomFonts(widget.font_urls);var embeddableForms=document.querySelectorAll("#ap3w-embeddable-form-"+widget.id);if(embeddableForms&&embeddableForms.length){widget&&widget.has_recaptcha&&(hasRecaptcha=!0,onloadCallbackFuncBody+="if (document.getElementById('ap3w-recaptcha-required-"+widget.id+"')) {var allForms = document.querySelectorAll('#ap3w-recaptcha-required-"+widget.id+"');\n for (var i=0; i < allForms.length; i++) {allForms[i].style.display='none';}}\n if (document.getElementById('ap3w-recaptcha-v2-"+widget.id+"')){ var allForms = document.querySelectorAll('#ap3w-recaptcha-v2-"+widget.id+"');\n for (var i=0; i < allForms.length; i++) { grecaptcha.render(allForms[i], { 'sitekey': '"+ap3c.recaptcha_site_key+"', 'callback': verifyCallback})}\n} ");for(var formIndex=0;formIndex<embeddableForms.length;formIndex++){for(var embeddableForm=embeddableForms[formIndex],isUnstyled="style"!==embeddableForm.firstElementChild.nodeName.toLowerCase(),inputs=embeddableForm.querySelectorAll("input,textarea,select"),i=0;i<inputs.length;i++){var parentEl=inputs[i].closest(".ap3w-form-input")||{},fieldDataAttributes=parentEl.dataset||{},defaultValue=getDefaultValue(fieldDataAttributes.preFillOption,fieldDataAttributes.fieldId,inputs[i]);if(fieldDataAttributes.hideIfValueExists&&fieldDataAttributes.fieldId in ap3c.field_values&&(parentEl.style.display="none",inputs[i].required&&(inputs[i].required=!1)),fieldDataAttributes.visibility===visibilityOptionIds.HIDE_ON_PRE_FILL&&defaultValue&&(parentEl.style.display="none"),"checkbox"===inputs[i].type&&defaultValue)inputs[i].checked=defaultValue;else if("select-multiple"===inputs[i].type&&defaultValue)for(var j=0;j<inputs[i].children.length;j++)-1!==defaultValue.split(",").indexOf(inputs[i].children[j].value)&&(inputs[i].children[j].selected=!0);else defaultValue&&(inputs[i].value=defaultValue);"tel"===inputs[i].type&&inputs[i].addEventListener("input",function(){this.value=this.value.replace(/[^0-9+]/g,"")})}var allDescendants=embeddableForm.getElementsByTagName("*");if(!isUnstyled&&allDescendants&&allDescendants.length)for(j=0;j<allDescendants.length;j++){var descendant=allDescendants[j];if(descendant.classList&&descendant.classList.length)for(var k=0;k<descendant.classList.length;k++)-1===descendant.classList[k].indexOf("ap3w")&&descendant.classList.remove(descendant.classList[k])}var inputSelectLists=embeddableForm.querySelectorAll("#ap3w-input-select-list-"+widget.id);if(inputSelectLists&&inputSelectLists.length)for(j=0;j<inputSelectLists.length;j++){var selectList=inputSelectLists[j],randomId=Math.random().toString(36).slice(-10),selectListId=selectList.dataset.listId+randomId;selectList.dataset.newListId=selectListId;var selectFields=selectList.children,selectListContainer=selectList.parentNode;if(!isUnstyled&&3!==selectListContainer.children.length)for(k=0;k<selectListContainer.children.length;k++)selectListContainer.children[k].className&&-1!==selectListContainer.children[k].className.indexOf("ap3w")||selectListContainer.children[k].remove();if(selectFields&&selectFields.length)for(var selectFieldIndex=0;selectFieldIndex<selectFields.length;selectFieldIndex++)populateSelectOptions(selectList,selectFields[selectFieldIndex],selectedOptions,!0),selectFields[selectFieldIndex].addEventListener("click",function(event){var clickedOption=event.target.closest(".ap3w-form-input-select-option"),clickedValue=clickedOption.dataset.value,selectList=clickedOption.parentElement,selectListTrigger=selectList.previousElementSibling,triggerPlaceholderText=selectListTrigger.dataset.placeholder,selectListId=selectList.dataset.newListId;"multi_select"===selectList.dataset.selectType?(selectedOptions[selectListId]?-1===selectedOptions[selectListId].indexOf(clickedValue)?(selectedOptions[selectListId].push(clickedValue),clickedOption.firstElementChild.checked=!0,clickedOption.classList.add("ap3w-form-input-select-option-selected")):(selectedOptions[selectListId].splice(selectedOptions[selectListId].indexOf(clickedValue),1),clickedOption.firstElementChild.checked=!1,clickedOption.classList.remove("ap3w-form-input-select-option-selected")):(selectedOptions[selectListId]=[clickedValue],clickedOption.firstElementChild.checked=!0,clickedOption.classList.add("ap3w-form-input-select-option-selected")),selectedOptions[selectListId].length?(selectListTrigger.innerText=selectedOptions[selectListId].join(", "),selectListTrigger.value=selectedOptions[selectListId]):(selectListTrigger.innerText=triggerPlaceholderText,selectListTrigger.value=triggerPlaceholderText)):(selectedOptions[selectListId]=clickedValue,selectList.classList.add("ap3w-form-input-select-list-hide"),selectListTrigger.innerText=selectedOptions[selectListId],selectListTrigger.value=selectedOptions[selectListId])})}var selectButtons=embeddableForm.getElementsByClassName("ap3w-form-input-select-button");if(selectButtons)for(i=0;i<selectButtons.length;i++){selectButtons[i].onclick=function(event){var selectLists=embeddableForm.getElementsByClassName("ap3w-form-input-select-list");if(-1!==event.target.className.indexOf("ap3w-form-input-select-button"))event.target.nextElementSibling&&event.target.nextElementSibling.classList.toggle("ap3w-form-input-select-list-hide");else if(!event.target.closest(".ap3w-form-input-select-option")&&selectLists&&selectLists.length)for(var i=0;i<selectLists.length;i++)selectLists[i].classList.add("ap3w-form-input-select-list-hide")}}embeddableForm.onsubmit=function(event){if(event.preventDefault(),widget.has_recaptcha&&!ap3c.recaptcha&&document.getElementById("ap3w-recaptcha-required-"+widget.id))document.getElementById("ap3w-recaptcha-required-"+widget.id).style.display="block";else{var embeddableForm=event.target,embeddedContainer=embeddableForm.parentElement,emailInput=embeddableForm.querySelector("#ap3w-form-input-email-"+widget.id),phoneInput=embeddableForm.querySelector("#ap3w-input-phone-"+widget.id),areaCodeInput=embeddableForm.querySelector("#ap3w-input-areacode-"+widget.id),firstNameInput=embeddableForm.querySelector('[data-field-id="str::first"] #ap3w-form-input-text-'+widget.id),firstNameValue=void 0;firstNameInput&&firstNameInput.value&&"protect"!==firstNameInput.parentElement.dataset.mergeStrategy&&(firstNameValue=firstNameInput.value).trim&&(firstNameValue=firstNameValue.trim());var lastNameInput=embeddableForm.querySelector('[data-field-id="str::last"] #ap3w-form-input-text-'+widget.id),lastNameValue=void 0;if(lastNameInput&&lastNameInput.value&&"protect"!==lastNameInput.parentElement.dataset.mergeStrategy&&(lastNameValue=lastNameInput.value).trim&&(lastNameValue=lastNameValue.trim()),emailInput||phoneInput){var email=emailInput&&emailInput.value,phone=(areaCodeInput&&areaCodeInput.value||"")+(phoneInput&&phoneInput.value||""),bypassEmail=emailInput&&!1===emailInput.required,bypassPhone=phoneInput&&!1===phoneInput.required;if(email||bypassEmail||phone||bypassPhone){for(var fields=getFormFieldsData(widget,"ap3w-form-input",selectedOptions,embeddableForm),hasEmail=!1,hasPhone=!1,i=0;i<fields.length;i++){if("true"===fields[i].required&&(void 0===fields[i].value||null===fields[i].value||0===fields[i].value.length))return;"str::email"===fields[i].field_id&&(hasEmail=!0),"phn::phone"===fields[i].field_id&&(hasPhone=!0)}if(!hasEmail&&!hasPhone)return;embeddableForm[widget.id]||(ap3c.track({apiPath:"-/events/cw-event",email:email,phone:phone,first:firstNameValue,last:lastNameValue,cw:{widget_id:widget.id,type:"widget_form_submitted",shown_on_url:window.location.href,attributes:fields,rc:ap3c.recaptcha}},function(){ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id);var embedFormButton=embeddableForm.querySelector("#ap3w-form-button-"+widget.id),buttonSubmitUrl=embedFormButton.dataset.buttonSubmitUrl;"go-to-url"===embedFormButton.dataset.buttonOnClick?window.location.assign(buttonSubmitUrl):showAfterSubmit(widget,"form","thank-you",embeddedContainer)}),embeddableForm[widget.id]=!0,localStorage.setItem(this.localStorageKey+widget.id,JSON.stringify({expiry:(new Date).getTime()+ttl})))}}}}}if(reprocessEmbeddedForm||ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_shown",shown_on_url:window.location.href}}),widget.has_recaptcha&&window.grecaptcha){var recaptchaRequiredElemIdSelector="#ap3w-recaptcha-required-"+widget.id,recaptchaRequiredElems=document.querySelectorAll(recaptchaRequiredElemIdSelector);if(recaptchaRequiredElems&&recaptchaRequiredElems.length)for(i=0;i<recaptchaRequiredElems.length;i++)recaptchaRequiredElems[i].style.display="none";var recaptchaElemIdSelector="#ap3w-recaptcha-v2-"+widget.id,recaptchaElements=document.querySelectorAll(recaptchaElemIdSelector);if(recaptchaElements&&recaptchaElements.length)for(i=0;i<recaptchaElements.length;i++){var recaptchaElement=recaptchaElements[i];if(recaptchaElement&&0===recaptchaElement.childElementCount)try{window.grecaptcha.render(recaptchaElement,{sitekey:ap3c.recaptcha_site_key,callback:window.verifyCallback})}catch(e){console.log("recaptch render error:",e)}}}}return{_hasRecaptcha:hasRecaptcha,_onloadCallbackFuncBody:onloadCallbackFuncBody}},showWidgetFunction:function(widget){var show=this.show.bind(this),shownWidget=!1;function shouldShowWidget(_widget,_shownWidget,_conditionsMet){if(_shownWidget)return!1;var _rulesObject=_widget.trigger.rules,_conditionsArray=_rulesObject.conditions,_showWhenAllRule="all"===_rulesObject.when&&1<_conditionsArray.length;return!_showWhenAllRule||_showWhenAllRule&&_conditionsMet===_conditionsArray.length}if(widget.trigger&&widget.trigger.selection)if("load"===widget.trigger.selection)show(widget,"",10);else if("click"===widget.trigger.selection)document.addEventListener("click",function(e){e.target.closest(widget.trigger.value)&&show(widget,"",10)});else if("rules"===widget.trigger.selection&&widget.trigger.rules&&widget.trigger.rules.conditions&&widget.trigger.rules.conditions.length)for(var conditionsArray=widget.trigger.rules.conditions,index=0;index<conditionsArray.length;index++){var conditionsMet=0,condition=conditionsArray[index];if("exit"===condition.id){var exitIntentCallback=function(e){conditionsMet++,document.removeEventListener("mouseleave",exitIntentCallback),shouldShowWidget(widget,shownWidget,conditionsMet)&&(show(widget,"",10),shownWidget=!0)};document.addEventListener("mouseleave",exitIntentCallback)}if("on"===condition.id&&setTimeout(function(){shouldShowWidget(widget,shownWidget,++conditionsMet)&&(show(widget,"",10),shownWidget=!0)},1e3*condition.value),"scroll"===condition.id&&(window.onscroll=function(){window&&document.body&&(100*((window.innerHeight+window.scrollY)/document.body.scrollHeight)>condition.value&&shouldShowWidget(widget,shownWidget,++conditionsMet)&&(show(widget,"",10),shownWidget=!0))}),"pages"===condition.id)readCookie(cookies.PAGES_VISITED_IN_SESSION)>=+condition.value&&shouldShowWidget(widget,shownWidget,++conditionsMet)&&(show(widget,"",10),shownWidget=!0)}else show(widget,"",2e3);else if(widget.when)if("load"===widget.when.selection)show(widget,"",10);else if("on"===widget.when.selection)show(widget,"",1e3*widget.when.value);else if("click"===widget.when.selection)document.addEventListener("click",function(e){e.target.closest(widget.when.value)&&show(widget,"",10)});else if("scroll"===widget.when.selection)window.onscroll=function(){!shownWidget&&window&&document.body&&(100*((window.innerHeight+window.scrollY)/document.body.scrollHeight)>widget.when.value&&(show(widget,"",10),shownWidget=!0))};else if("exit"===widget.when.selection){exitIntentCallback=function(e){document.removeEventListener("mouseleave",exitIntentCallback),e.preventDefault(),show(widget,"",10)};document.addEventListener("mouseleave",exitIntentCallback)}else show(widget,"",2e3)},inject:function(widget,hasLogo){var showWidgetFunction=this.showWidgetFunction.bind(this),getFormFieldsData=ap3c.getFormFieldsData.bind(this),showAfterSubmit=this.showAfterSubmit.bind(this),spinTheWheel=this.spinTheWheel.bind(this),handleCountDown=this.handleCountDown.bind(this),injectVideo=this.injectVideo.bind(this),ttl=this.ttl,selectedOptions={},hide=this.hide.bind(this),requestPushPermission=this.requestPushPermission.bind(this),copyToClipboard=this.copyToClipboard.bind(this),existingWidgetContainer=document.getElementById(widget.id);if(!existingWidgetContainer){var container=document.getElementsByTagName(widget.use_slot)[0],widgetContainer=document.createElement("div");widgetContainer.innerHTML=widget.html,widgetContainer.firstChild&&(widgetContainer.firstChild.style.bottom=0,widgetContainer.firstChild.style.top=0,widgetContainer.firstChild.style.right=0,widgetContainer.firstChild.style.left=0,widget.is_gdpr&&(widgetContainer.firstChild.style.zIndex=99999)),widget.style&&"top"===widget.style.position?(widgetContainer.style.position="relative",widget.style.sticky&&(widgetContainer.style.position="sticky",widgetContainer.style.top=0),widgetContainer.style.zIndex=99999):widget.style&&widget.style.sticky&&"bottom"===widget.style.position&&(widgetContainer.style.position="sticky",widgetContainer.style.bottom=0,widgetContainer.style.zIndex=99999),existingWidgetContainer||container.insertAdjacentElement("afterbegin",widgetContainer),showWidgetFunction(widget);var couponButton=document.getElementById("ap3w-coupon-button-"+widget.id),couponCode=document.getElementById("ap3w-coupon-code-"+widget.id),couponCodeText=document.getElementById("ap3w-coupon-code-text-"+widget.id);couponButton&&couponCode&&couponButton.addEventListener("click",function(event){event.preventDefault();var discountId=event.target.dataset.discountId;discountId&&ap3c.track({apiPath:"-/events/generate-simple-coupon",cw:{widget_id:widget.id,type:"widget_coupon_generated",shown_on_url:window.location.href},discount_id:discountId},function(response){couponCodeText?couponCodeText.innerText=response.code:couponCode.innerText=response.code,localStorage.setItem(ap3c.localStorageKey+widget.id,JSON.stringify({expiry:(new Date).getTime()+ttl})),showAfterSubmit(widget,"greeting","thank-you")})});var submitFormCallback=function(response){response.code&&(couponCodeText?couponCodeText.innerText=response.code:couponCode.innerText=response.code),showAfterSubmit(widget,"greeting","thank-you")};if(couponCode)var discountId=couponCode.dataset.discountId;var form=document.getElementById("ap3w-form-"+widget.id);if(form){for(var inputs=form.querySelectorAll("input,textarea"),i=0;i<inputs.length;i++){var parentEl=inputs[i].closest(".ap3w-input")?inputs[i].closest(".ap3w-input"):{},fieldDataAttributes=parentEl.dataset||{},defaultValue=getDefaultValue(fieldDataAttributes.preFillOption,fieldDataAttributes.fieldId,inputs[i]);fieldDataAttributes.hideIfValueExists&&fieldDataAttributes.fieldId in ap3c.field_values&&(parentEl.style.display="none",inputs[i].required&&(inputs[i].required=!1)),fieldDataAttributes.visibility===visibilityOptionIds.HIDE_ON_PRE_FILL&&defaultValue&&(parentEl.style.display="none"),"checkbox"===inputs[i].type&&defaultValue?inputs[i].checked=defaultValue:defaultValue&&(inputs[i].value=defaultValue),"tel"===inputs[i].type&&inputs[i].addEventListener("input}),"date"!==getFieldType(inputs[i])&&"datetime-local"!==getFieldType(inputs[i])||(inputs[i].addEventListener("focus",function(){var fieldTypeAttr=this.parentElement.dataset&&this.parentElement.dataset.inputType;this.type=fieldTypeAttr||this.name}),inputs[i].addEventListener("blur}))}form.onsubmit=function(event){if(event.preventDefault(),widget.has_recaptcha&&!ap3c.recaptcha&&document.getElementById("ap3w-recaptcha-required-"+widget.id))document.getElementById("ap3w-recaptcha-required-"+widget.id).style.display="block";else{var emailInput=document.getElementById("ap3w-input-email-"+widget.id),phoneInput=document.getElementById("ap3w-input-phone-"+widget.id),areaCodeInput=document.getElementById("ap3w-input-areacode-"+widget.id),firstNameInput=form.querySelector('[data-field-id="str::first"] #ap3w-input-text-'+widget.id),firstNameValue=void 0;firstNameInput&&firstNameInput.value&&"protect"!==firstNameInput.parentElement.dataset.mergeStrategy&&(firstNameValue=firstNameInput.value).trim&&(firstNameValue=firstNameValue.trim());var lastNameInput=form.querySelector('[data-field-id="str::last"] #ap3w-input-text-'+widget.id),lastNameValue=void 0;lastNameInput&&lastNameInput.value&&"protect"!==lastNameInput.parentElement.dataset.mergeStrategy&&(lastNameValue=lastNameInput.value).trim&&(lastNameValue=lastNameValue.trim());var email=emailInput&&emailInput.value,phone=(areaCodeInput&&areaCodeInput.value||"")+(phoneInput&&phoneInput.value||""),bypassEmail=emailInput&&!1===emailInput.required,bypassPhone=phoneInput&&!1===phoneInput.required;if(email||bypassEmail||phone||bypassPhone){for(var fields=getFormFieldsData(widget,"ap3w-input",selectedOptions,form),hasEmail=!1,hasPhone=!1,i=0;i<fields.length;i++){if("true"===fields[i].required&&(void 0===fields[i].value||0===fields[i].value.length))return;"str::email"===fields[i].field_id&&(hasEmail=!0),"phn::phone"===fields[i].field_id&&(hasPhone=!0)}if(!hasEmail&&!hasPhone)return;var isSpinTheWheel=document.getElementById(widget.id+"-spin-to-win"),formSubmitButton=document.getElementById("ap3w-input-submit-"+widget.id);if(isSpinTheWheel){var baseSpin=0,rotatingContentDivs=widgetContainer.getElementsByClassName("ap3w-wheel--rotating-content"),needleContainerDiv=document.getElementById("needle-container-"+widget.id);emailInput&&(emailInput.disabled=!0),phoneInput&&(phoneInput.disabled=!0),formSubmitButton.value="Spinning...",formSubmitButton.disabled=!0,rotatingContentDivs[0].classList.add("ap3w-spinning");var apiAwaitInterval=setInterval(function(){baseSpin-=11,rotatingContentDivs[0].style.transform="rotate("+baseSpin+"deg)";var fixed45Spin=Math.abs(baseSpin%45);if(START_NEEDLE_MOVE_ANGLE<fixed45Spin&&fixed45Spin<END_NEEDLE_MOVE_ANGLE){var degrees=BASE_NEEDLE_ANGLE+(fixed45Spin-START_NEEDLE_MOVE_ANGLE)*NEEDLE_ANGLE_INCREMENT;needleContainerDiv.style.transform="rotate("+degrees+"deg)"}else needleContainerDiv.style.transform="rotate("+BASE_NEEDLE_ANGLE+"deg)"},5);ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),ap3c.track({apiPath:"-/events/spin-the-wheel",email:email,phone:phone,first:firstNameValue,last:lastNameValue,widget_id:widget.id,cw:{widget_id:widget.id,type:"widget_spin_submitted",shown_on_url:window.location.href,attributes:fields}}),ap3c.track({apiPath:"-/events/cw-event",email:email,first:firstNameValue,last:lastNameValue,cw:{widget_id:widget.id,type:"widget_form_submitted",shown_on_url:window.location.href,attributes:fields,rc:ap3c.recaptcha}})}else if(discountId)ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),ap3c.track({apiPath:"-/events/cw-event",email:email,phone:phone,first:firstNameValue,last:lastNameValue,cw:{widget_id:widget.id,type:"widget_form_submitted",shown_on_url:window.location.href,attributes:fields,rc:ap3c.recaptcha},discount_id:discountId},submitFormCallback);else{ap3c.track({apiPath:"-/events/cw-event",email:email,phone:phone,first:firstNameValue,last:lastNameValue,cw:{widget_id:widget.id,type:"widget_form_submitted",shown_on_url:window.location.href,attributes:fields,rc:ap3c.recaptcha}},function(){var buttonOnClick=formSubmitButton.dataset.buttonOnClick,buttonSubmitUrl=formSubmitButton.dataset.buttonSubmitUrl;ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),"go-to-url"===buttonOnClick?window.location.assign(buttonSubmitUrl):showAfterSubmit(widget,"greeting","thank-you")})}localStorage.setItem(this.localStorageKey+widget.id,JSON.stringify({expiry:(new Date).getTime()+ttl}))}}}}var sayThankYouButton=document.getElementById("ap3w-button-thank-you-"+widget.id);sayThankYouButton&&sayThankYouButton.addEventListener("click",function(event){event.preventDefault(),-1===widgetsAccepted.indexOf(widget.id)&&widgetsAccepted.push(widget.id),showAfterSubmit(widget,"greeting","thank-you")});var pushPermissionButtons=document.querySelectorAll("#ap3w-button-push-permission-"+widget.id);if(pushPermissionButtons)for(i=0;i<pushPermissionButtons.length;i++){pushPermissionButtons[i].addEventListener("click})}var survey=document.getElementById("ap3w-survey-"+widget.id);if(survey){var lastBtn=null;/Safari/i.test(uA)&&/Apple Computer/.test(vendor)&&(!/Mobi|Android/i.test(uA)||/iPhone OS 15/i.test(uA))&&document.addEventListener("click",function(e){e.target.closest&&(lastBtn=e.target.closest("button, input[type=submit]"))},!0),survey.onsubmit=function(event){if(event.preventDefault(),(null===event.submitter||void 0!==event.submitter)&&/Safari/i.test(uA)&&/Apple Computer/.test(vendor)&&(!/Mobi|Android/i.test(uA)||/iPhone OS 15/i.test(uA))){event=Object.assign({},event,{submitter:event.target.querySelector("button, input[type=button], input[type=image]")});for(var canditates=[document.activeElement,lastBtn],i=0;i<canditates.length;i++){var candidate=canditates[i];candidate&&(candidate.form&&candidate.matches("button, input[type=button], input[type=image]")&&(event=Object.assign({},event,{submitter:candidate})))}}var surveyResponse=event.submitter.dataset.surveyValue||event.submitter.innerText;discountId?ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_survey_responded",shown_on_url:window.location.href,attributes:{response:surveyResponse}},discount_id:discountId},submitFormCallback):(ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_survey_responded",shown_on_url:window.location.href,attributes:{response:surveyResponse}}}),showAfterSubmit(widget,"greeting","thank-you")),ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),localStorage.setItem(this.localStorageKey+widget.id,JSON.stringify({expiry:(new Date).getTime()+ttl}))}}var videoThumb=container.querySelector("#ap3w-video-thumbnail--inner-"+widget.id),videoIframe=container.querySelector("#ap3w-youtube-video-"+widget.id);videoThumb&&videoIframe&&injectVideo(widget,videoThumb,videoIframe);var inputSelectOptions=document.getElementsByClassName("ap3w-input-select-option-"+widget.id);if(inputSelectOptions&&inputSelectOptions.length)for(var j=0;j<inputSelectOptions.length;j++){var selectList=inputSelectOptions[j].parentElement;populateSelectOptions(selectList,inputSelectOptions[j],selectedOptions,!1),inputSelectOptions[j].addEventListener("click",function(event){var clickedOption=event.target.closest(".ap3w-input-select-option"),clickedValue=clickedOption.dataset.value,selectList=clickedOption.parentElement,selectListTrigger=selectList.previousElementSibling,triggerPlaceholderText=selectListTrigger.dataset.placeholder,selectListId=selectList.dataset.listId;"multi_select"===selectList.dataset.selectType?(selectedOptions[selectListId]?-1===selectedOptions[selectListId].indexOf(clickedValue)?(selectedOptions[selectListId].push(clickedValue),clickedOption.firstElementChild.checked=!0,clickedOption.classList.add("ap3w-input-select-option-selected")):(selectedOptions[selectListId].splice(selectedOptions[selectListId].indexOf(clickedValue),1),clickedOption.firstElementChild.checked=!1,clickedOption.classList.remove("ap3w-input-select-option-selected")):(selectedOptions[selectListId]=[clickedValue],clickedOption.firstElementChild.checked=!0,clickedOption.classList.add("ap3w-input-select-option-selected")),selectedOptions[selectListId].length?(selectListTrigger.innerText=selectedOptions[selectListId].join(", "),selectListTrigger.value=selectedOptions[selectListId]):(selectListTrigger.innerText=triggerPlaceholderText,selectListTrigger.value=triggerPlaceholderText)):(selectedOptions[selectListId]=clickedValue,selectList.classList.add("ap3w-input-select-list-hide"),selectListTrigger.innerText=selectedOptions[selectListId],selectListTrigger.value=selectedOptions[selectListId])})}var reaction=document.getElementById("ap3w-reaction-"+widget.id);reaction&&reaction.addEventListener("submit",function(event){event.preventDefault();var submittedReaction=event.submitter.dataset.reaction;discountId?ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_reacted",shown_on_url:window.location.href,attributes:{reaction:submittedReaction,reaction_reason:""}},discount_id:discountId},submitFormCallback):(ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_reacted",shown_on_url:window.location.href,attributes:{reaction:submittedReaction,reaction_reason:""}}}),showAfterSubmit(widget,"greeting","thank-you")),ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),localStorage.setItem(this.localStorageKey+widget.id,JSON.stringify({expiry:(new Date).getTime()+ttl}))});var poweredByAutopilotLogos=document.getElementsByClassName("ap3w-powered-by-autopilot");if(!hasLogo&&poweredByAutopilotLogos&&0<poweredByAutopilotLogos.length)for(i=0;i<poweredByAutopilotLogos.length;i++)poweredByAutopilotLogos[i].remove();var countdown=container.querySelector("#ap3w-countdown-"+widget.id);countdown&&handleCountDown(countdown),document.getElementById(widget.id).addEventListener("click",function(event){var selectLists=document.getElementsByClassName("ap3w-input-select-list");if(event.target.closest("#ap3w-input-select-button-"+widget.id))for(var listId=event.target.closest("#ap3w-input-select-button-"+widget.id).nextElementSibling.dataset.listId,i=0;i<selectLists.length;i++)selectLists[i].dataset.listId!==listId?selectLists[i].classList.add("ap3w-input-select-list-hide"):selectLists[i].classList.toggle("ap3w-input-select-list-hide");else if(!event.target.closest(".ap3w-input-select-option")&&selectLists&&selectLists.length)for(i=0;i<selectLists.length;i++)selectLists[i].classList.add("ap3w-input-select-list-hide");if(event.target.id==="ap3w-coupon-code-copy-"+widget.id){clearInterval(this.countdownInterval);var couponCode=event.target.previousElementSibling&&event.target.previousElementSibling.innerText;couponCode&&copyToClipboard(couponCode)}if(event.target.closest("#ap3w-close-"+widget.id)||event.target.closest("#ap3w-button-close-"+widget.id)||event.target.closest("#ap3w-close-"+widget.id+"--circle")||event.target.closest("#ap3w-close--circle-"+widget.id)||event.target.closest(".ap3w-link-close")||event.target.href&&-1!==event.target.href.indexOf(CLOSE_WIDGET_LINK)&&-1!==event.target.href.indexOf(PUSH_PERMISSION_LINK)){if(event.preventDefault(),document.querySelector(".ap3w-spinning")||(clearInterval(this.countdownInterval),hide(widget,"")),"selected-ap3w-spin-the-wheel-copy-button"===event.target.parentElement.id){clearInterval(this.countdownInterval);var couponDiv=document.getElementById("ap3w-wheel-coupon-"+widget.id),couponCodeText=document.getElementById("ap3w-coupon-code-text-"+widget.id);if(couponCodeText)var spinTheWheelCouponCode=couponCodeText.innerText;else if(couponDiv)spinTheWheelCouponCode=couponDiv.innerText;spinTheWheelCouponCode&&copyToClipboard(spinTheWheelCouponCode);var redirectUrl=event.target.getAttribute("href");redirectUrl&&window.location.assign(redirectUrl)}}else event.target.closest(".ap3w-close-gdpr")&&widget.is_gdpr&&(clearInterval(this.countdownInterval),ap3c.setFrequencyCookie(cookies.CONVERTED,widget.id),hide(widget,""))}),isIOSWebView&&replacePlatformLinks(widgetContainer,platforms.IOS),isAndroidWebView()&&replacePlatformLinks(widgetContainer,platforms.ANDROID)}}},ap3c._talkWidget=Object.assign(Object.create(ap3c._generalWidget)),ap3c._talkWidget.execute=function(widget){var showWidgetFunction=this.showWidgetFunction.bind(this);this.show.bind(this);showWidgetFunction(widget)},ap3c._talkWidget.show=function(widget,templateName,delay){ap3c.track({apiPath:"-/events/cw-event",cw:{widget_id:widget.id,type:"widget_shown",shown_on_url:window.location.href}}),setTimeout(function(){var state=ap3c.readCurrentState([widget]);ap3c.talk.execute("notify",{widgetId:widget.id,agent:widget.talk_message_agent,body:widget.talk_message_body,files:widget.talk_message_files,hasShown:!!state.SHOWN[widget.id],hasDismissed:!!state.DISMISSED[widget.id],isLargePreview:!!widget.large_preview}),ap3c.setFrequencyCookie(cookies.SHOWN_IN_CURRENT_SESSION,widget.id,!0),ap3c.setFrequencyCookie(cookies.SHOWN,widget.id)},delay)},ap3c._injectWaitingOnStockWidget=function(widget,localStorageKey,ttl,shouldShow,buildPayload){if("function"!=typeof buildPayload)throw new Error("Invalid buildPayload type");var container=document.getElementsByTagName(widget.use_slot)[0],widgetContainer=document.createElement("div");widgetContainer.innerHTML=widget.html,widgetContainer.firstChild&&widgetContainer.firstChild.style&&(widgetContainer.firstChild.style.bottom=0,widgetContainer.firstChild.style.top=0,widgetContainer.firstChild.style.right=0,widgetContainer.firstChild.style.left=0),container.appendChild(widgetContainer);var data=localStorage.getItem(localStorageKey);data&&(new Date).getTime()<JSON.parse(data).expiry?(console.log("waiting on stock widget hidden because of expiry."),ap3c._generalWidget.hide(widget,"waiting_on_stock")):!0===shouldShow?ap3c._generalWidget.show(widget):(console.log("waiting on stock widget hidden because of not meeting show condition."),ap3c._generalWidget.hide(widget,"waiting_on_stock"));var form=document.getElementById("ap3w-form-"+widget.id);form&&(form.onsubmit=function(event){event.preventDefault();var emailInput=document.getElementById("ap3w-input-email-"+widget.id),phoneInput=document.getElementById("ap3w-input-phone-"+widget.id),email=emailInput&&emailInput.value,phone=phoneInput&&phoneInput.value;if(email){var fields=[{field_id:"str::email",value:email,merge_strategy:"override"}];ap3c.track({apiPath:"-/events/cw-event",email:email,phone:phone,cw:{widget_id:widget.id,type:"widget_form_submitted",shown_on_url:window.location.href,attributes:fields}})}(email||phone)&&(ap3c.track(buildPayload(email,phone)),localStorage.setItem(localStorageKey,JSON.stringify({expiry:(new Date).getTime()+ttl}))),ap3c._generalWidget.showAfterSubmit(widget,"greeting","thank-you"),emailInput&&(emailInput.value=""),phoneInput&&(phoneInput.value="")},document.getElementById(widget.id).addEventListener("click",function(event){(event.target.closest("#ap3w-close-"+widget.id)||event.target.closest("#ap3w-button-close-"+widget.id)||event.target.closest("#ap3w-close-"+widget.id+"--circle")||event.target.closest("#ap3w-close--circle-"+widget.id)||event.target.closest(".ap3w-link-close")||event.target.href&&-1!==event.target.href.indexOf(CLOSE_WIDGET_LINK)||event.target.href&&-1!==event.target.href.indexOf(PUSH_PERMISSION_LINK))&&(event.preventDefault(),ap3c._generalWidget.hide(widget))}))},ap3c._shopifySubscribeAction={canExecut},execute:function(){var handleSubscribe=function(){var emailInputs=document.getElementsByName("contact[email]");if(emailInputs&&0<emailInputs.length)for(var i=0;i<emailInputs.length;i++)!function(emailInput){emailInput.form&&emailInput.form.addEventListener("submit",function(e){var email=new FormData(emailInput.form).get("contact[email]");email&&ap3c.track({v:0,email:email})})}(emailInputs[i])};"loading"===document.readyState?document.addEventListener("DOMContentLoaded}):handleSubscribe()}},ap3c._shopifyProductViewedAction={canExecute:function(){return!!(window.Shopify&&window.ShopifyAnalytics&&window.ShopifyAnalytics.meta&&window.ShopifyAnalytics.meta.product)},execute:function(){ap3c.payloadEnrichers.push(function(payload,options){return payload.sh=options&&options.sh||{event_type:"product_viewed",shop:window.Shopify.shop,currency:window.ShopifyAnalytics.currency,product_id:window.ShopifyAnalytics.meta.product.id,selected_variant_id:getShopifyProductCurrentVariantId()},payload})}},ap3c._shopifyProductAddedToCartAction={canExecute:function(){return!!(window.Shopify&&window.ShopifyAnalytics&&window.ShopifyAnalytics.meta&&window.ShopifyAnalytics.meta.product)},execute:function(){var trackAddToCart=function(){ap3c.track({apiPath:"-/events/sh-event",v:0,email:ap3c.shopifyLiquidEmail,phone:ap3c.shopifyLiquidPhone,sh:{event_type:"product_added_to_cart",shop:window.Shopify.shop,currency:window.ShopifyAnalytics.currency,product_id:window.ShopifyAnalytics.meta.product.id,selected_variant_id:getShopifyProductCurrentVariantId()}})};if(window.fetch){var fetch=window.fetch;window.fetch=function(resource,options){return options&&"POST"===options.method&&!0===validShopifyCartAddPaths[resource]?Promise.resolve(fetch.apply(window,arguments).then(function(response){return!0===validShopifyCartAddStatuses[response.status]&&trackAddToCart(),response})):Promise.resolve(fetch.apply(window,arguments))}}var open=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(method,url){return"POST"===method&&!0===validShopifyCartAddPaths[url]&&this.addEventListener("readystatechange",function(){4===this.readyState&&!0===validShopifyCartAddStatuses[this.status]&&trackAddToCart()}),open.apply(this,arguments)}}},ap3c._shopifyWaitingOnStockWidget={ttl:2592e6,localStorageKey:"ap_waiting_on_stock",canExecute:function(widget){return!!(window.Shopify&&window.ShopifyAnalytics&&window.ShopifyAnalytics.meta&&window.ShopifyAnalytics.meta.product)&&("false"===ap3c.shopifyIsProductAvailable||!(!ap3c.shopifyIsProductVariantAvailableMap||!1!==ap3c.shopifyIsProductVariantAvailableMap[getShopifyProductCurrentVariantId()]))},execute:function(widget){var inject=this.inject.bind(this);if(window.fetch){var fetch=window.fetch;window.fetch=function(resource,options){return options&&"POST"===options.method&&!0===validShopifyCartAddPaths[resource]?Promise.resolve(fetch.apply(window,arguments).then(function(response){return 422===response.status?ap3c._generalWidget.show(widget):ap3c._generalWidget.hide(widget),response})):Promise.resolve(fetch.apply(window,arguments))}}var open=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(method,url){return"POST"===method&&!0===validShopifyCartAddPaths[url]&&this.addEventListener("readystatechange",function(){4===this.readyState&&422===this.status?ap3c._generalWidget.show(widget):ap3c._generalWidget.hide(widget)}),open.apply(this,arguments)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded}):inject(widget)},inject:function(widget){var ttl=this.ttl,localStorageKey=this.localStorageKey+window.ShopifyAnalytics.meta.product.id+getShopifyProductCurrentVariantId();ap3c._injectWaitingOnStockWidget(widget,localStorageKey,ttl,!0,function(email,phone){return{v:0,apiPath:"-/events/sh-event",email:email,phone:phone,sh:{widget_id:widget.id,event_type:"product_waiting_on_stock",shop:window.Shopify.shop,currency:window.ShopifyAnalytics.currency,product_id:window.ShopifyAnalytics.meta.product.id,selected_variant_id:getShopifyProductCurrentVariantId()}}})}},(ap3c.cmd||[]).forEach(function(cmd,i){try{cmd()}catch(error){console.log(error)}}),(ap3c.kb||[]).forEach(function(cmd,i){try{cmd()}catch(error){console.log(error)}});var polyfillDateInput=function(){var featureDetectEl=document.createElement("input");try{featureDetectEl.type="date"}finally{if("date"!==featureDetectEl.type){var script=document.createElement("script");script.src="https://cdn.jsdelivr.net/npm/configurable-date-input-polyfill@2.8.2/configurable-date-input-polyfill.dist.min.js",document.body.appendChild(script);var styleSheet=document.createElement("style");styleSheet.type="text/css",styleSheet.innerText="date-input-polyfill[data-open=true] { z-index: 9999999; }",document.head.appendChild(styleSheet)}}};polyfillDateInput(),ap3c.Sha256={},ap3c.Sha256.hash=function(msg){for(var K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],H=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],l=(msg+=String.fromCharCode(128)).length/4+2,N=Math.ceil(l/16),M=new Array(N),i=0;i<N;){M[i]=new Array(16);for(var j=0;j<16;)M[i][j]=msg.charCodeAt(64*i+4*j)<<24|msg.charCodeAt(64*i+4*j+1)<<16|msg.charCodeAt(64*i+4*j+2)<<8|msg.charCodeAt(64*i+4*j+3),j++;i++}M[N-1][14]=8*(msg.length-1)/Math.pow(2,32),M[N-1][14]=Math.floor(M[N-1][14]),M[N-1][15]=8*(msg.length-1)&4294967295;var W=new Array(64),a=void 0,b=void 0,c=void 0,d=void 0,e=void 0,f=void 0,g=void 0,h=void 0;for(i=0;i<N;){for(var t=0;t<16;)W[t]=M[i][t],t++;for(t=16;t<64;)W[t]=ap3c.Sha256.a1(W[t-2])+W[t-7]+ap3c.Sha256.a0(W[t-15])+W[t-16]&4294967295,t++;for(a=H[0],b=H[1],c=H[2],d=H[3],e=H[4],f=H[5],g=H[6],h=H[7],t=0;t<64;){var T1=h+ap3c.Sha256.b1(e)+ap3c.Sha256.Ch(e,f,g)+K[t]+W[t],T2=ap3c.Sha256.b0(a)+ap3c.Sha256.Maj(a,b,c);h=g,g=f,f=e,e=d+T1&4294967295,d=c,c=b,b=a,a=T1+T2&4294967295,t++}H[0]=H[0]+a&4294967295,H[1]=H[1]+b&4294967295,H[2]=H[2]+c&4294967295,H[3]=H[3]+d&4294967295,H[4]=H[4]+e&4294967295,H[5]=H[5]+f&4294967295,H[6]=H[6]+g&4294967295,H[7]=H[7]+h&4294967295,i++}return ap3c.Sha256.toHexStr(H[0])+ap3c.Sha256.toHexStr(H[1])+ap3c.Sha256.toHexStr(H[2])+ap3c.Sha256.toHexStr(H[3])+ap3c.Sha256.toHexStr(H[4])+ap3c.Sha256.toHexStr(H[5])+ap3c.Sha256.toHexStr(H[6])+ap3c.Sha256.toHexStr(H[7])},ap3c.Sha256.ROT},ap3c.Sha256.b0=function(x){return ap3c.Sha256.ROTR(2,x)^ap3c.Sha256.ROTR(13,x)^ap3c.Sha256.ROTR(22,x)},ap3c.Sha256.b1=function(x){return ap3c.Sha256.ROTR(6,x)^ap3c.Sha256.ROTR(11,x)^ap3c.Sha256.ROTR(25,x)},ap3c.Sha256.a0=function(x){return ap3c.Sha256.ROTR(7,x)^ap3c.Sha256.ROTR(18,x)^x>>>3},ap3c.Sha256.a1=function(x){return ap3c.Sha256.ROTR(17,x)^ap3c.Sha256.ROTR(19,x)^x>>>10},ap3c.Sha256.C},ap3c.Sha256.Ma},ap3c.Sha256.toHexStr=function(n){for(var s="",i=7;0<=i;)s+=(n>>>4*i&15).toString(16),i--;return s},ap3c.scanForm=function(window,options}null==options&&(options={});options.findAllVersions&&(options.hashVersion}(1,1,!0)),options.hashVersions||(options.hashVersions=[1]);var DOMWalk={_getAttributeWhitelist:{autocomplete:!0},descend:function(from,selector){return null==selector?window.document.querySelectorAll(from):from.querySelectorAll(selector)},nameOrI},hasClass:function(element,className){var re=new RegExp("\\b"+className+"\\b");return(null!=element?element.className:void 0)&&re.test(element.className)},attr:function(element,attrName){return DOMWalk._getAttributeWhitelist[attrName]?"function"==typeof element.getAttribute?element.getAttribute(attrName):void 0:element[attrName]},hasAncestorOfType:function(element,nodeName){for(;;){if(element.nodeName===nodeName)return!0;if(!(element=element.parentNode))return!1}}},jQueryWalk={};if(jQueryWalk.$=__guard__(null!=window?window.AutopilotAnywhere:void 0,function(x){return x.jQuery})||(null!=window?window.jQuery:void 0)||ap3c.__jq,!jQueryWalk.$)throw Error("jQuery unavailable");jQueryWalk.descend=function(from,selector){return selector?jQueryWalk.$(from).find(selector).toArray():(obj=jQueryWalk.$(from),methodName="toArray",transfor},null!=obj&&"function"==typeof obj[methodName]?transform(obj,methodName):void 0);var obj,methodName,transform},jQueryWalk.nameOrId=function(element){var el=jQueryWalk.$(element);return el.attr("name")||el.attr("id")},jQueryWalk.hasClass=function(element,className){return jQueryWalk.$(element).hasClass(className)},jQueryWalk.att},jQueryWalk.hasAncestorOfType=function(element,nodeName){return 0<jQueryWalk.$(element).parents(nodeName).length};var walk=options.useDOM&&DOMWalk||jQueryWalk,unbouncePage=__guard__(walk.descend("#ubpoverlay-overlay"),function(x1){return x1.length}),squareSpacePage=__guard__(walk.descend(".sqs-layout"}),forms={},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=Array.from(walk.descend("FORM"))[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var ninjaSpamField,ninjaTrapFieldName,formElement=_step.value;if(!walk.hasAncestorOfType(formElement,"NOSCRIPT")){ninjaTrapFieldName=(ninjaSpamField=__guard__(walk.descend(formElement,"INPUT[type=hidden][name=_hp_name]"}))?walk.attr(ninjaSpamField,"value"):null;var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=Array.from(options.hashVersions)[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var field,name,optionValues,latestHash,latestIsADuplicate,hashVersion=_step2.value,form={fields:[],radioFields:{},fingerprint:"",duplicate:!1,ignoredNamesOrIds:{},alreadyUsedGuesses:{},hashVersion:hashVersion},_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0,allFields=walk.descend(formElement,"INPUT").concat(walk.descend(formElement,"SELECT")).concat(walk.descend(formElement,"TEXTAREA")).concat(walk.descend(formElement,"FIELDSET")).concat(walk.descend(formElement,"DIV[id]")).concat(walk.descend(formElement,"BUTTON"));try{for(var _step3,_iterator3=Array.from(allFields)[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var nameOrId,divInput,individualField,individualNameOrId;if(_step3.value){if(field=_step3.value,!squareSpacePage||"INPUT"!==field.nodeName&&"BUTTON"!==field.nodeName||"submit"!==(walk.attr(field,"type")||"").toLowerCase()||("INPUT"===field.nodeName?form.fingerprint+="SQUARESPACEINPUTSUBMIT/"+(walk.attr(field,"value")||"")+" ":form.fingerprint+="SQUARESPACEBUTTONSUBMIT/"+(walk.attr(field,"value")||"")+" "),(nameOrId=walk.nameOrId(field))&&!(form.ignoredNamesOrIds[nameOrId]||nameOrId.match(/^captcha$/i)||walk.hasClass(field,"screenReader")||/^_mc4wp_h_/.test(nameOrId)&&"off"===walk.attr(field,"autocomplete")&&"text"===walk.attr(field,"type")||ninjaTrapFieldName&&"text"===walk.attr(field,"type")&&walk.attr(field,"name")===ninjaTrapFieldName))switch(field.nodeName){case"DIV":var divId=(walk.attr(field,"id")||"").toLowerCase();divId.match(/^currency-yui/)?1!==(null!=(divInput=walk.descend(field,"INPUT"))?divInput.length:void 0)||walk.nameOrId(divInput[0])||(form.fields.push({type:"currency",name:divId,guess:null,probablySearch:!1,subfield:divInput[0]}),form.fingerprint+="INPUT.text/"+divId+" "):divId.match(/^number-yui/)&&(1!==(null!=(divInput=walk.descend(field,"INPUT"))?divInput.length:void 0)||walk.nameOrId(divInput[0])||(form.fields.push({type:"number",name:divId,guess:null,probablySearch:!1,subfield:divInput[0]}),form.fingerprint+="INPUT.text/"+divId+" "));break;case"INPUT":var fieldType=(walk.attr(field,"type")||"text").toLowerCase();if(["email","text","search","tel","url"].includes(fieldType)){if(unbouncePage&&nameOrId.match(/^ubafs-/))continue;var emailGuess="email"!==fieldType&&!nameOrId.match(/email/i)||form.alreadyUsedGuesses.regular_Email?null:"regular_Email";form.fields.push({type:"text",name:nameOrId,guess:emailGuess,probablySearch:"search"===fieldType||["search","query","q","s","qu"].includes(nameOrId)}),"hidden"!==fieldType&&(form.fingerprint+="INPUT."+fieldType+"/"+nameOrId+" ",emailGuess&&(form.alreadyUsedGuesses[emailGuess]=!0))}else if("checkbox"===fieldType)form.fields.push({type:"checkbox",name:nameOrId,guess:null,probablySearch:!1}),form.fingerprint+="INPUT.checkbox/"+nameOrId+" ";else if("radio"===fieldType)null==form.radioFields[nameOrId]&&(form.radioFields[nameOrId]=[]),form.radioFields[nameOrId].push(walk.attr(field,"value"));else if(["submit","password","reset","file","image"].includes(fieldType));else if(1===hashVersion){form.fields.push({type:fieldType,name:nameOrId,guess:null,probablySearch:!1});var _type=fieldType;"date"!==_type&&"datetime-local"!==_type||(_type="text"),"hidden"!==_type&&(form.fingerprint+="INPUT."+_type+"/"+nameOrId+" ")}break;case"SELECT":var _iteratorNormalCompletion4=!0,_didIteratorError4=!(optionValues=[]),_iteratorError4=void 0;try{for(var _step4,_iterator4=Array.from(walk.descend(field,"OPTION")||[])[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var textContent,option=_step4.value;(textContent=walk.attr(option,"textContent"))&&optionValues.push(textContent)}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}form.fields.push({type:"select",name:nameOrId,guess:null,probablySearch:!1,optionValues:optionValues}),form.fingerprint+="SELECT/"+nameOrId+" ";break;case"TEXTAREA":form.fields.push({type:"text",name:nameOrId,guess:null,textArea:!0}),form.fingerprint+="TEXTAREA/"+nameOrId+" ";break;case"FIELDSET":if(nameOrId.match(/^date-yui/)){var allIndividualFields=walk.descend(field,"INPUT");if(3===allIndividualFields.length){var dayField=walk.descend(field,".day INPUT"),monthField=walk.descend(field,".month INPUT"),yearField=walk.descend(field,".year INPUT");if(dayField.length===monthField.length&&monthField.length===yearField.length&&1===yearField.length){var _iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _step5,_iterator5=Array.from(allIndividualFields)[Symbol.iterator]();!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0)individualField=_step5.value,(individualNameOrId=walk.nameOrId(individualField))&&(form.ignoredNamesOrIds[individualNameOrId]=!0)}catch(err){_didIteratorError5=!0,_iteratorError5=err}finally{try{!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}form.fields.push({type:"date",name:nameOrId,guess:null,probablySearch:!1,subfields:[yearField[0],monthField[0],dayField[0]]}),form.fingerprint+="FIELDSET/"+nameOrId+" "}}}else if(nameOrId.match(/^phone-yui/)){var countryCodeField=walk.descend(field,'INPUT[x-autocompletetype="phone-country-code"]'),areaCodeField=walk.descend(field,'INPUT[x-autocompletetype="phone-area-code"]'),phonePrefixField=walk.descend(field,'INPUT[x-autocompletetype="phone-local-prefix"]'),phoneSuffixField=walk.descend(field,'INPUT[x-autocompletetype="phone-local-suffix"]');if((null!=countryCodeField?countryCodeField.length:void 0)<=1&&(null!=areaCodeField?areaCodeField.length:void 0)===(null!=phonePrefixField?phonePrefixField.length:void 0)&&(null!=phonePrefixField?phonePrefixField.length:void 0)===(null!=phoneSuffixField?phoneSuffixField.length:void 0)&&1===(null!=phoneSuffixField?phoneSuffixField.length:void 0)){for(var _arr=[countryCodeField,areaCodeField,phonePrefixField,phoneSuffixField],_i=0;_i<_arr.length;_i++)individualField=_arr[_i],(individualNameOrId=walk.nameOrId(individualField))&&(form.ignoredNamesOrIds[individualNameOrId]=!0);form.fields.push({type:"phone",name:nameOrId,guess:null,probablySearch:!1,subfields:{countryCode:1===(null!=countryCodeField?countryCodeField.length:void 0)?countryCodeField[0]:null,areaCode:null!=areaCodeField?areaCodeField[0]:void 0,phonePrefix:null!=phonePrefixField?phonePrefixField[0]:void 0,phoneSuffix:null!=phoneSuffixField?phoneSuffixField[0]:void 0}}),form.fingerprint+="FIELDSET/"+nameOrId+" "}}else if(nameOrId.match(/^time-yui/)){var allTimingFields=walk.descend(field,"INPUT");if(3===allTimingFields.length){var hoursField=walk.descend(field,".hour INPUT"),minutesField=walk.descend(field,".minute INPUT"),secondsField=walk.descend(field,".second INPUT"),ampmField=walk.descend(field,".ampm SELECT");if(hoursField.length===minutesField.length&&minutesField.length===secondsField.length&&secondsField.length===ampmField.length&&1===ampmField.length){var ampmNameOrId,_iteratorNormalCompletion6=!0,_didIteratorError6=!1,_iteratorError6=void 0;try{for(var _step6,_iterator6=Array.from(allTimingFields)[Symbol.iterator]();!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=!0){var timingField=_step6.value;(individualNameOrId=walk.nameOrId(timingField))&&(form.ignoredNamesOrIds[individualNameOrId]=!0)}}catch(err){_didIteratorError6=!0,_iteratorError6=err}finally{try{!_iteratorNormalCompletion6&&_iterator6.return&&_iterator6.return()}finally{if(_didIteratorError6)throw _iteratorError6}}(ampmNameOrId=walk.nameOrId(ampmField))&&(form.ignoredNamesOrIds[ampmNameOrId]=!0),form.fields.push({type:"time",name:nameOrId,guess:null,probablySearch:!1,subfields:[hoursField[0],minutesField[0],secondsField[0],ampmField[0]]}),form.fingerprint+="FIELDSET/"+nameOrId+" "}}}}}else console.warn(formElement,"has undefined field")}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}for(name in form.radioFields){var values=form.radioFields[name];form.fields.push({type:"radio",name:name,guess:null,probablySearch:!1,optionValues:values}),form.fingerprint+="INPUT.radio/"+name+" "}if(0<form.fields.length)if(1!==form.fields.length||!form.fields[0].probablySearch)if(walk.attr(formElement,"action")||1!==form.fields.length||"select"!==form.fields[0].type)if(form.hash=ap3c.Sha256.hash(form.fingerprint),1<hashVersion&&(form.hash=hashVersion+"_"+form.hash),form.hashVersion=hashVersion,form.id=walk.attr(formElement,"id"),!form.id||-1===form.id.indexOf("ap3w-"))if(form.action=walk.attr(formElement,"action"),form.elements=[formElement],options.findAllVersions)1===hashVersion?(latestHash=form.hash,form.otherHashVersions=[],forms[latestHash]?(latestIsADuplicate=!0,forms[latestHash].elements.push(formElement)):(latestIsADuplicate=!1,forms[latestHash]=form)):latestIsADuplicate||forms[latestHash].otherHashVersions.push(form.hash);else forms[form.hash]?forms[form.hash].elements.push(formElement):forms[form.hash]=form}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return forms};