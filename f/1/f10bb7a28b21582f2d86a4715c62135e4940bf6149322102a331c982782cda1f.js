var frontEndPage=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="{{url}}/js/",n(n.s=361)}([function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(4);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(49)("wks"),o=n(30),i=n(1).Symbol,a="function"==typeof i;(t.exports=function(t){return r[t]||(r[t]=a&&i[t]||(a?i:o)("Symbol."+t))}).store=r},function(t,e,n){var r=n(3),o=n(88),i=n(27),a=Object.defineProperty;e.f=n(8)?Object.defineProperty:function(t,e,n){if(r(t),e=i(e,!0),r(n),o)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){t.exports=!n(2)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){var n=t.exports={version:"2.6.4"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(25);t.exports=function(t){return Object(r(t))}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(7),o=n(29);t.exports=n(8)?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(44),o=n(25);t.exports=function(t){return r(o(t))}},function(t,e,n){"use strict";var r=n(2);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){var r=n(45),o=n(29),i=n(16),a=n(27),s=n(14),l=n(88),u=Object.getOwnPropertyDescriptor;e.f=n(8)?u:function(t,e){if(t=i(t),e=a(e,!0),l)try{return u(t,e)}catch(t){}if(s(t,e))return o(!r.f.call(t,e),t[e])}},function(t,e,n){var r=n(0),o=n(9),i=n(2);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*i(function(){n(1)}),"Object",a)}},function(t,e,n){var r=n(23);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var r=n(4);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(30)("meta"),o=n(4),i=n(14),a=n(7).f,s=0,l=Object.isExtensible||function(){return!0},u=!n(2)(function(){return l(Object.preventExtensions({}))}),c=function(t){a(t,r,{value:{i:"O"+ ++s,w:{}}})},f=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[r].i},getWeak:function(t,e){if(!i(t,r)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[r].w},onFreeze:function(t){return u&&f.NEED&&l(t)&&!i(t,r)&&c(t),t}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(90),o=n(64);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e,n){var r=n(18),o=Math.max,i=Math.min;t.exports=function(t,e){return(t=r(t))<0?o(t+e,0):i(t,e)}},function(t,e,n){var r=n(90),o=n(64).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e,n){var r=n(14),o=n(12),i=n(63)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var r=n(4);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){var r=n(7).f,o=n(14),i=n(5)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e){t.exports={}},function(t,e,n){var r=n(5)("unscopables"),o=Array.prototype;null==o[r]&&n(15)(o,r,{}),t.exports=function(t){o[r][t]=!0}},function(t,e,n){"use strict";var r=n(1),o=n(7),i=n(8),a=n(5)("species");t.exports=function(t){var e=r[t];i&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(11);t.exports=function(t,e,n){for(var o in e)r(t,o,e[o],n);return t}},function(t,e,n){var r=n(24);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(24),o=n(5)("toStringTag"),i="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:i?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var r=n(3),o=n(23),i=n(5)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[i])?e:o(n)}},function(t,e,n){var r;!"undefined"!=typeof window?window:this,function(n,o){"use strict";var i=[],a=Object.getPrototypeOf,s=i.slice,l=i.flat?u=i.push,c=i.indexOf,f={},d=f.toString,h=f.hasOwnProperty,p=h.toString,m=p.call(Object),g={},v=b=y=n.document,w={type:!0,src:!0,nonce:!0,noModule:!0};r T=.fn=T.prototype={jquery:"3.6.0",constructor:T,length:0,toArray:function(){return s.call(this)},get:pushStack:each:map:slice:first:last:even:odd:eq:end:push:u,sort:i.sort,splice:i.splice},T.extend=T.fn.extend=T.extend({expando:"jQuery"+("3.6.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:noop:function(){},isPlainObject:isEmptyObject:globalEval:each:makeArray:inArray:merge:grep:map:guid:1,support:g}),"function"==typeof Symbol&&(T.fn[Symbol.iterator]=i[Symbol.iterator]),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),;var _=}(n);T.find=_,T.expr=_.selectors,T.expr[":"]=T.expr.pseudos,T.uniqueSort=T.unique=_.uniqueSort,T.text=_.getText,T.isXMLDoc=_.isXML,T.contains=_.contains,T.escapeSelector=_.escape;var },},$=T.expr.match.needsContex}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/}T.filte},T.fn.extend({fin},filter:function(t){return this.pushStack(H(this,t||[],!1))},no},i}});var D,P=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(T.fn.ini}).prototype=T.fn,D=T(y);var j=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0}T.fn.extend({ha},closes},inde},ad},addBac}}),T.each({paren},parents:function(t){return k(t,"parentNode")},parentsUntil:function(t,e,n){return k(t,"parentNode",n)},next:function(t){return L(t,"nextSibling")},prev:function(t){return L(t,"previousSibling")},nextAll:function(t){return k(t,"nextSibling")},prevAll:function(t){return k(t,"previousSibling")},nextUntil:function(t,e,n){return k(t,"nextSibling",n)},prevUnti},sibling},childre},content}});var M=/[^\x20\t\r\n\f]+/g;function N(t){return T.Callback},T.extend({Deferre},whe}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;T.Deferred.exceptionHoo},T.readyExceptio};var z=T.Deferred(}T.fn.read},T.extend({isReady:!1,readyWait:1,read}}),T.ready.then=z.then,"complete"===y.readyState||"loading"!==y.readyState&&!y.documentElement.doScroll?n.setTimeout(T.ready):(y.addEventListener("DOMContentLoaded",U),n.addEventListener("load",U));var },Y=/^-ms-/,Q=/-([a-z])/var }G.uid=1,G.prototype={cach},se},ge},acces},remov},hasDat}};var K=new G,J=new G,Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,tt=/[A-Z]/}T.extend({hasDat},data:function(t,e,n){return J.access(t,e,n)},removeData:function(t,e){J.remove(t,e)},_dat},_removeDat}}),T.fn.extend({dat},removeData:function(t){return this.each(function(){J.remove(this,t)})}}),T.extend({queu},dequeu},_queueHook}}),T.fn.extend({queu},dequeue:function(t){return this.each(function(){T.dequeue(this,t)})},clearQueu},promis}});var nt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rt=new RegExp("^(?:([+-])=|)("+nt+")([a-z%]*)$","i"),ot=["Top","Right","Bottom","Left"],it=y.documentElement,a},st={composed:!0};it.getRootNode&&(a});var l}var ct={T.fn.extend({sho},hide:function(){return dt(this)},toggl}});var ht,pt,mt=/^(?:checkbox|radio)$/i,gt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,vt=/^$|^module$|\/(?:java|ecma)script/i;ht=y.createDocumentFragment().appendChild(y.createElement("div")),(pt=y.createElement("input")).setAttribute("type","radio"),pt.setAttribute("checked","checked"),pt.setAttribute("name","t"),ht.appendChild(pt),g.checkClone=ht.cloneNode(!0).cloneNode(!0).lastChild.checked,ht.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!ht.cloneNode(!0).lastChild.defaultValue,ht.innerHTML="<option></option>",g.option=!!ht.lastChild;var bt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]bt.tbody=bt.tfoot=bt.colgroup=bt.caption=bt.thead,bt.th=bt.td,g.option||(bt.optgroup=bt.option=[1,"<select multiple='multiple'>","</select>"]);var St=/<|&#?\w+;}var Tt=/^([^.]*)(?:\.(.+)|)/;function xt(){return!0}function _t(){return!.event={global:{},ad},remov},dispatc},handler},addPro},fi},special:{load:{noBubble:!0},click:{setu},trigge},_defaul}},beforeunload:{postDispatc}}}},T.removeEven},T.Even},T.Event.prototype={constructor:T.Event,isDefaultPrevented:_t,isPropagationStopped:_t,isImmediatePropagationStopped:_t,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=xt,t&&!this.isSimulated&&t.preventDefault()},stopPropagatio},stopImmediatePropagatio}},T.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},T.event.addProp),T.each({focus:"focusin",blur:"focusout"}),T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"}),T.fn.extend({o},on},of}});var It=/<script|<style|<link/i,At=/checked\s*(?:[^=]|=\s*.checked.)/i,Ht=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/tend({htmlPrefilter:function(t){return t},clon},cleanDat}}),T.fn.extend({detac},remove:function(t){return Mt(this,t)},tex},appen},prepen},befor},afte},empt},clon},htm},replaceWit}}),T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"});var Nt=new RegExp("^("+nt+")(?!px)[a-z%]+$","i"),R},F},Bt=new RegExp(ot.join("|"),"i"();var Wt=["Webkit","Moz","ms"],Yt=y.createElement("div").style,Qt={}var Xt=/^(none|table(?!-c[ea]).+)/,qt=/^--/,Gt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:"0",fontWeight:"400"extend({cssHooks:{opacity:{ge}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},styl},cs}}),T.each(["height","width"}),T.cssHooks.marginLeft=Ut(g.reliableMarginLef}),T.each({margin:"",padding:"",border:"Width"}),T.fn.extend({cs}}),T.Tween=ee,ee.prototype={constructor:ee,ini},cu},ru}},ee.prototype.init.prototype=ee.prototype,ee.propHooks={_default:{ge},se}}},ee.propHooks.scrollTop=ee.propHooks.scrollLeft={se}},T.easing={linea},swin},_default:"swing"},T.fx=ee.prototype.init,T.fx.step={};var ne,re,oe=/^(?:toggle|show|hide)$/,ie=/queueHooks$nimation=T.extend(ce,{tweeners:{"*"}]},tweene},prefilters}],prefilte}}),T.spee},T.fn.extend({fadeT},animat},sto},finis}}),T.each(["toggle","show","hide"}),T.each({slideDown:le("show"),slideUp:le("hide"),slideToggle:le("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}}),T.timers=[],T.fx.tic},T.fx.time},T.fx.interval=13,T.fx.star},T.fx.sto},T.fx.speeds={slow:600,fast:200,_default:400},T.fn.dela}();var fe,de=T.expr.attrHandle;T.fn.extend({attr:function(t,e){return W(this,T.attr,t,e,arguments.length>1)},removeAtt}}),T.extend({att},attrHooks:{type:{se}}},removeAtt}}),fe={se}},T.each(T.expr.match.bool.source.match(/\w+/g});var he=/^(?:input|select|textarea|button)$/i,pe=/^(?:a|area)$/.fn.extend({pro},removePro}}),T.extend({pro},propHooks:{tabIndex:{ge}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(T.propHooks.selected={ge},se}}),T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"}),T.fn.extend({addClas},removeClas},toggleClas},hasClas}});var be=/\r/g;T.fn.extend({va}}),T.extend({valHooks:{option:{ge}},select:{ge},se}}}}),T.each(["radio","checkbox"}),g.focusin="onfocusin"in n;var ye=/^(?:focusinfocus|focusoutblur)$/,w};T.extend(T.event,{trigge},simulat}}),T.fn.extend({trigge},triggerHandle}}),g.focusin||T.each({focus:"focusin",blur:"focusout"});var Se=n.location,Ce={guid:Date.now()},Te=/\?/;T.parseXM};var xe=/\[\]$/,_e=/\r?\n/g,ke=/^(?:submit|button|image|reset|file)$/i,Ee=/^(?:input|select|textarea|keygen)/}T.para},T.fn.extend({serializ},serializeArra}});var Ie=/%20/g,Ae=/#.*$/,He=/([?&])_=[^&]*/,De=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pe=/^(?:GET|HEAD)$/,je=/^\/\//,Oe={},Le={},Me="*/".concat("*"),Ne=y.createElement("a"e.href=Se.href,T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Se.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Se.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Me,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":T.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetu},ajaxPrefilter:Re(Oe),ajaxTransport:Re(Le),aja},getJSO},getScrip}}),T.each(["get","post"}),T.ajaxPrefilte}),T._evalUr},T.fn.extend({wrapAl},wrapInne},wra},unwra}}),T.expr.pseudos.hidde},T.expr.pseudos.visibl},T.ajaxSettings.xh};var ze={0:200,1223:204},Ue=T.ajaxSettings.xhr();g.cors=!!Ue&&"withCredentials"in Ue,g.ajax=Ue=!!Ue,T.ajaxTranspor}),T.ajaxPrefilte}),T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script}}}),T.ajaxPrefilter("script}),T.ajaxTransport("script});var We,Ye=[],Qe=/(=)\?(?=&|$)|\?\?/;T.ajaxSetup({jsonp:"callback",jsonpCallbac}}),T.ajaxPrefilter("json jsonp}),g.createHTMLDocument=((We=y.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===We.childNodes.length),T.parseHTM},T.fn.loa},T.expr.pseudos.animate},T.offset={setOffse}},T.fn.extend({offse},positio},offsetParen}}),T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"}),T.each(["top","left"}),T.each({Height:"height",Width:"width"}),T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"}),T.fn.extend({bin},unbin},delegat},undelegat},hove}}),T.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "});var Ve=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;T.prox},T.holdRead},T.isArray=Array.isArray,T.parseJSON=JSON.parse,T.nodeName=I,T.isFunction=v,T.isWindow=b,T.camelCase=X,T.type=C,T.now=Date.now,T.isNumeri},T.tri},void 0===(r=function(){return T}.apply(e,[]))||(t.exports=r);var Xe=n.jQuery,qe=n.$;return T.noConflic},void 0===o&&(n.jQuery=n.$=T),T})}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(0),o=n(25),i=n(2),a=n(68),s="["+a+"]",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),c=function(t,e,n){var o={},s=i(function(){return!!a[t]()||"​"!="​"[t]()}),l=o[t]=s?e(f):a[t];n&&(o[n]=l),r(r.P+r.F*s,"String",o)},f=c.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=c},function(t,e,n){var r=n(5)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i=[7],a=i[r]();a.next=function(){return{done:n=!0}},i[r]=function(){return a},t(i)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(3);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(46),o=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var i=n.call(t,e);if("object"!=typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,n){"use strict";n(107);var r=n(11),o=n(15),i=n(2),a=n(25),s=n(5),l=n(83),u=s("species"),c=!i(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var d=s(t),h=!i(function(){var e={};return e[d]=function(){return 7},7!=""[t](e)}),p=h?!i(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[u]=function(){return n}),n[d](""),!e}):void 0;if(!h||!p||"replace"===t&&!c||"split"===t&&!f){var m=/./[d],g=n(a,d,""[t],function(t,e,n,r,o){return e.exec===l?h&&!o?{done:!0,value:m.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),v=g[0],b=g[1];r(String.prototype,t,v),o(RegExp.prototype,d,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,thETURN=c},function(t,e,n){var r=n(1).navigator;t.exports=r&&r.userAgt,g),y}},function(t,e,n){for(var r,o=n(1),i=n(15),a=n(30),s=a("typed_array"),l=a("view"),u=!(!o.ArrayBuffer||!o.DataView),c=u,f=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=o[d[f++]])?(i(r.prototype,s,!0),i(r.prototype,l,!0)):c=!1;t.exports={ABV:u,CONSTR:c,TYPED:s,VIEW:l}},function(t,e,n){var r=n(4),o=n(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,e,n){e.f=n(5)},function(t,e,n){var r=n(49)("keys"),o=n(30);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(24);t.exports=Array.isArray||function(t){return"Array"heck:i}},function(t,e){t.exports="\t\n\v\f\r   ᠎       n't accept regex!");return String(o(t))}},function(t,e,n){var r=n(4),o=n(24),i=n(5)("match");t.exports=function(t){var e;return r(t)&iv"),"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(1),o=n(9),i=n(31),a=n(62),s=n(7).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.c[s]=n[l]:delete n[s],s+=f,l+=f;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r=n(83);n(0)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(t,e,n){n(8)&&"g"!=/./g.flags&&n(7).f(RegExp.protote,r)})});return o.e&&r(o.v),n.promise}})},function(t,e,n){"use strict";var r=n(23);function o(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new o(t)}},function(t,e,n){var r=n(3),o=n(4),i=n(110);t.exports=function(t,e){if(r(t),o(e)&&e.constructor===t)return e;var n=(1))},n?"entries":"values",!n,!0),f(e)}}},function(t,e,n){"use strict";var r=n(43),o=n(28).getWeak,i=n(3),a=n(4),s=n(42),l=n(57),u=n(21),c=n(14),f=n(37),d=u(5),h=u(6),p=0,m=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},v=function(t,e){return d(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=v(this,t);if(e)return e[1]},has:function(t){return!!v(this,t)},set:function(t,e){var n=v(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=h(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,i){var u=t(function(t,r){s(t,u,e,"_i"),t._t=e,t._i=p++,t._l=void 0,null!=r&&l(r,n,t[i],t)});return r(u.prototype,{delete:function(t){if(!a(t))return!1;var n=o(t);return!0===n?m(f(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=o(t);return!0===n?m(f(this,e)).has(t):n&&c(n,this._i)}}),u},def:function(t,e,n){var r=o(i(e),!0);return!0===r?m(t).set(e,n):r[t._i]=n,t},ufstore:m}},function(t,e,n){var r=n(18),o=n(6);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=o(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var r=n(35),o=n(51),i=n(3),a=n(1).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(i(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(6),o=n(70),i=n(25);t.exports=function(t,e,n,a){var s=String(i(t)),l=s.length,u=void 0===n?" ":String(n),c=r(e);if(c<=l||""==u)return s;var f=c-l,d=o.call(u,Math.ceil(f/u.length));return++])&&c.push(t?[n,a[n]]:a[n]);return c}}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o,i=void((o="object"===(void 0===t?"undefined":r(t))?t:"object"===("undefined"==typeof window?"undefined":r(window))?window:"object"===("undefined"==typeof self?"undefined":r(self))?self:void 0)&&!o._babelPolyfill?n(119):console.warn("UF: Babel polyfill detected, UF will not apply it"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(t,e,n){t.exports=n(49)("native-function-to-string",Function.toString)},function(t,e,n){var r=n(32),o=n(51),i=n(45);t.exports=function(t){var e=r(t),n=o.f;if(n)for(var a,s=n(t),l=i.f,u=0;s.length>u;)l.call(t,a=s[u++])&&e.push(a);return e}},function(t,e,n){var r=n(0);r(r.S,"Object",{create:n(34)})},function(t,e,n){var r=n(0);r(r.S+r.F*!n(8),"Object",{defineProperty:n(7).f})},function(t,e,n){var r=n(0);r(r.S+r.F*!n(8),"Object",{defineProperties:n(91)})},function(t,e,n){var r=n(16),o=n(19).f;n(20)("getOwnPropertyDescriptor",function(){return function(t,e){return o(r(t),e)}})},function(t,e,n){var r=n(12),o=n(36);n(20)("getPrototypeOf",function(){return function(t){return o(r(t))}})},function(t,e,n){var r=n(12),o=n(32);n(20)("keys",function(){return function(t){return o(r(t))}})},function(t,e,n){n(20)("getOwnPropertyNames",function(){return n(92).f})},function(t,e,n){var r=n(4),o=n(28).onFreeze;n(20)("freeze",function(t){return function(e){return t&&r(e)?t(o(e)):e}})},function(t,e,n){var r=n(4),o=n(28).onFreeze;n(20)("seal",function(t){return function(e){return t&&r(e)?t(o(e)):e}})},function(t,e,n){var r=n(4),o=n(28).onFreeze;n(20)("preventExtensions",function(t){return function(e){return t&&r(e)?t(o(e)):e}})},function(t,e,n){var r=n(4);n(20)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(4);n(20)("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(4);n(20)("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},function(t,e,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(93)})},function(t,e,n){var r=n(0);r(r.S,"Object",{is:n(94)})},function(t,e,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(67).set})},function(t,e,n){"use strict";var r=n(46),o={};o[n(5)("toStringTag")]="z",o+""!="[object z]"&&n(11)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(t,e,n){var r=n(0);r(r.P,"Function",{bind:n(95)})},function(t,e,n){var r=n(7).f,o=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in o||n(8)&&r(o,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(4),o=n(36),i=n(5)("hasInstance"),a=Function.prototype;i in a||n(7).f(a,i,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=o(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var r=n(0),o=n(97);r(r.G+r.F*(parseInt!=o),{parseInt:o})},function(t,e,n){var r=n(0),o=n(98);r:g.slice(0,s-u)+"."+g.slice(s-u)):m+g}})},function(t,e,n){"use strict";var r=n(0),o=n(2),i=n(99),a=1..toPrecision;r(r.P+r.F*(o(function(){return"1"!==a.call(1,void 0)})||!o(function(){a.call({})})),"Number",{toPrecision:function(t){var e=i(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var r=n(0),o=n(1).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&o(t)}})},function(t,e,n){var r=n(0);r(r.S,"Number",{isInteger:n(100)})},function(t,e,n){var r=n(0);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var r=n(0),o=n(100),i=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return o(t)&&i(t)<=9007199254740991}})},function(t,e,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var r=n(0),o=n(98);r(r.S+r.F*(Number.parseFloat!=o),"Number",{parseFloat:o})},function(t,e,n){var r=n(0),o=n(97);r(r.S+r.F*(Nu-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var r=n(0),o=Math.atanh;r(r.S+r.F*!(o&&1/o(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var r=n(0),o=n(71);r(r.S,"Math",{cbrt:function(t){return o(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var r=n(0),o=Math.exp;r(r.S,"Math",{cosh:function(t){return(o(t=+t)+o(-t))/2}})},function(t,e,n){var r=n(0),o=n(72);r(r.S+r.F*(o!=Math.expm1),"Math",{expm1:o})},function(t,e,n){r:n;return l===1/0?1/0:l*Math.sqrt(i)}})},function(t,e,n){var r=n(0),o=Math.imul;r(r.S+r.F*n(2)(function(){return-5!=o(4294967295,5)||2!=o.length}),"Math",{imul:function(t,e){var n=+t,r=+e,o=65535&n,i=65535&r;return 0|o*i+((65535&n>>>16)*i+o*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var r=n(0);r(r.S,"Math",{log1p:n(101)})},function(t,e,n){var r=n(0);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var r=n(0);r(r.S,"Math",{sign:n(71)})},function(t,e,n){var r=n(0),o=n(72),i=Math.exp;r(r.S+r.F*n(2)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(o(t)-o(-t))/2:(i(t-1)-i(-t-1))*(Math.E/2)}})},function(t,e,n){var r=n(0),o=n(72),i=Math.exp;r(r.S,"Math",{tanh:function(t){var e=o(t=+t),n=o(-t);return ring(arguments[s]));return a.join("")}})},function(t,e,n){"use strict";n(52)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var r=n(73)(!0);n(74)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(0),o=n(73)(!1);r(r.P,"String",{codguments.length>1?arguments[1]:void 0)}})},function(t,e,n){vcall(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(13)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(13)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(13)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(13)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(13)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(13)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(13)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(13)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(13)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(13)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(13)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(13)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(13)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var r=n(0),o=n(12),i=n(27);r(r.P+r.F*n(2)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=o(this),n=i(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var r=n(0),o=n(201);r(r.P+r.F*(Date.prototype.eturn t==t?o.call(this):"Invalid Date"})},function(t,e,n){var r=n(5)("toPrimitive"),o=Date.prototype;r in o||n(15)(o,r,n(204))},function(t,e,n){"use strict";var r=n(3),o=n(27);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return o(r(this),"number"!=t)}},function(t,e,n){vt,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var r=n(0),o=n(16),i=[].join;r(r.P+r.F*(n(44)!=Object||!n(17)(i)),"Array",{join:function(t){return i.call(o(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(0),o=n(66),i=n(24),a=n(33),s=n(6),l=[].slice;r(r.P+r.F*n(2)(function(){o&&l.call(o)}),"Array",{slice:function(t,e){var n=s(this.length),r=i(this);if(e=void 0===e?n:e,"Array"==r)return l.call(this,t,e);for(var o=a(t,n),u=a(e,n),c=s(u-o),f=new Array(c),d=0;d<c;d++)f[d]="String"==r?this.charAt(o+d):this[o+d];return f}})},function(t,e,n){"use strict";var r=n(0),o=n(23),i=n(12),a=n(2),s=[].sort,l=[1,2,3];r(r.P+r.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!n(17)(s)),"Array",{sort:function(t){return void 0===t?s.call(i(this)):s.call(i(this),o(t))}})},function(t,e,n){"use strict";var r=n(0),o=n(21)(0),i=n(17)([].forEach,!0);r(r.P+r.F*!i,"Array",{forEach:funcports=function(t,e){return new(r(t))(e)}},function(t,e,n){var r=n(4),o=n(65),i=n(5)("species");t.exports=function(t){var e;return o(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!o(e.prototype)||(e=void 0),r(e)&&null===(e=e[i])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(0),o=n(21)(1);r(r.P+r.F*!n(17)([].map,!0),"Array",{map:function(t){return o(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),o=n(21)(2);r(r.P+r.F*!n(17)([].filter,!0),"Array",{filter:function(t){return o(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),o=n(21)(3);r(r.P+r.F*!n(17)([].some,!0),"Array",{some:function(t){return o(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),o=n(21)(4);r(r.P+r.F*!n(17)([].every,!0),"Array",{every:function(t){return o(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),o=n(104);r(r.P+r.F*!n(17)([].reduce,!0),"Array",{reduce:function(t){return o(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var r=n(0),o=n(104);r(r.P+r.F*!n(17)([].reduceRight,!0),"Array",{reduceRight:function(t){return o(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var r=n(0),o=n(50)(!1),i=[].indexOf,a=!!i&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(17)(i)),"Array",{indexOf:function(t){return a?i.apply(thisr in e&&e[r]===t)return r||0;return-1}})},function(t,e,n){var r=n(0);r(r.P,"Array",{copyWithin:n(105)}),n(40)("copyWithin")},function(t,e,n){var r=n(0);rength>1?arguments[1]:void 0)}}),):n}s=i[c-1]}return void 0===s?"":s})}})},function(t,e,n){"use strict";var r=n(3),o=n(94),i=n(55);n(56)("search",1,function(t,e,n,a){return[function(n){var r=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=a(n,t,this);if(e.done)return e.value;var s=r(t),l=String(this),u=s.lastIndex;o(u,0)||(s.lastIndex=0);var c=i(s,l);return o(s.lastIndex,u)|void 0};e&&(e.next=o),t||(t=o,n()),e=o}}},function(t,e){t.exports=function(t){try{return8(r++));return i}}),n(41)("ArrayBuffer")},function(t,e,n){var r=n(0);r(r.G+r.W+r.F*!n(60).ABV,{DataView:n(86).DataView})},function(t,e,n){n(26)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(26)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(26)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},function(t,e,n){n(26)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(26)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(26)("Int32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(26)("Uint32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(26)("Float32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(26)("Float64",8,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){var r=n(0),o=n(23),i=n(3),a=(n(1).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(2)(function(){a(function(){})}),"Reflect",{apply:function(t,e,n){var r=o(t),l=i(n);return a?a(r,e,l):s.call(r,e,l)}})},function(t,e,n){var r=n(0),o=n(34),i=n(23),a=n(3),s=n(4),l=n(2),u=n(95),c=(n(1).Reflect||{}).construct,f=l(function(){function t(){}return!(c(function(){},[],t)instanceof t)}),d=!l(function(){c(function(){})});r(r.S+r.F*(f||d),"Reflect",{construct:function(t,e){i(t),a(e);var n=arguments.length<3?t:i(arguments[2]);if(d&&!f)return c(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(u.apply(t,r))}var l=n.prototype,h=o(s(l)?l:Object.prototype),p=Function.apply.call(t,h,e);return s(p)?p:h}})},function(t,e,n){var r=n(7),o=n(0),i=n(3),a=n(27);o(o.S+o.F*n(2)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){i(t),e=a(e,!0),i(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var r=n(0),o=n(19).f,i=n(3);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=o(i(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var r=n(0),o=n(3),i=function(t){this._t=o(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(102)(i,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),r(r.S,"Reflect",{enumerate:function(t){return new i(t)}})},function(t,e,n){var r=n(19),o=n(36),i=n(14),a=n(0),s=n(4),l=n(3);a(a.S,"Reflect",{get:function t(e,n){var a,u,c=arguments.length<3?e:arguments[2];return l(e)===c?e[n]:(a=r.f(e,n))?i(a,"value")?a.value:void 0!==a.get?a.get.call(c):void 0:s(u=o(e))?t(u,n,c):void 0}})},function(t,e,n){var r=n(19),o=n(0),i=n(3);o(o.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(i(t),e)}})},function(t,e,n){var r=n(0),o=n(36),i=n(3);r(r.S,"Reflect",{getPrototypeOf:function(t){return o(i(t))}})},function(t,e,n){var r=n(0);r(r.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var r=n(0),o=n(3),i=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return o(t),!i||i(t)}})},function(t,e,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(115)})},function(t,e,n){var r=n(0),o=n(3),i=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){o(t);try{return i&&i(t),!0}catch(t){return!1}}})},function(t,e,n){var r=n(7),o=n(19),i=n(36),a=n(14),s=n(0),l=n(29),u=n(3),c=n(4);s(s.S,"Reflect",{set:function t(e,n,s){var f,d,h=arguments.length<4?e:arguments[3],p=o.f(u(e),n);if(!p){if(c(d=i(e)))return t(d,n,s,h);p=l(0)}if(a(p,"value")){if(!1===p.writable||!c(h))return!1;if(f=o.f(h,n)){if(f.get||f.set||!1===f.writable)return!1;f.value=s,r.f(h,n,f)}else r.f(h,n,l(0,s));return!0}return void 0!==p.set&&(p.set.call(h,s),!0)}})},function(t,e,n){var r=n(0),o=n(67);o&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){o.check(t,e);try{return o.set(t,e),!0}catch(t){return!1}}})},function(t,erguments[1]:void 0)}}),n(40)("includes")},function(t,e,n){n(267),t.exports=n(9).String.padStart},function(t,e,n){"use strict";var r=n(0),o=n(116),i=n(58);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(i),"String",{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,(271),t.exports=n(62).f("asyncIterator")},function(t,e,n){n(89)("asyncIterator")},function(t,e,n){n(273),t.exports=n(9).Object.getOwnPropertyDescriptors},function(t,e,n){var r=n(0),o=n(115),i=n(16),a=n(19),s=n(79);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=i(t),l=a.f,u=o(r),c={},f=0;u.length>f;)void 0!==(n=l(r,e=u[f++]))&&s(c,e,n);return c}})},function(t,e,n){n(275),t.exports=n(9).Object.values},function(t,e,n){var r=n(0),o=n(117)(!1);r(r.S,"Ob,n){n(277),t.exports=n(9).Object.entries},function(t,e,n){var r=n(0),o=n(117)(!0);r(r.S,"Objelf&&self}()||Function("return this")())},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isCapturedInSiteEngager=e.getDisplayProperty=void 0;e.getDisplayProperty=function(t){return $(t).parent().hasClass("reco-panel-items")?"recommendationPanel":$(t).parents("body").hasClass("listing-page")?"stream":$(t).parents().hasClass("hub-page")?"hub":$(t).parents().hasClass("single-page")?"item-level":void 0};e.isCapturedInSiteEngager=function(t){return!!$(t).p))},r.withConverter=e,r}(funsn this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"=()||3<e.split('"').length}),"String",n)}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(65),o=n(2function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=functin't convert object to primitive value")}},function(t,e){t.exports=function(t){if(null==t)throw TypeErrxports=function(t,e){return ,r,{}),t.exports=function(t){o[r][t]=!0}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object|f&&f.sham)&&i(d,"sham",!0),a(n,c,d,t)}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),confitring(t)+" is not a function");return t}},function(t,e,n){var r=n(8).f,o=n(16),i=n(5)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototyl,"")),2&e&&(t=t.replace(u,"")),t};t.exports=c},function(t,e){t.exports={}},function(t,e,n){var r,o=n(488),i=n(206),a=n(490),s=n(491),l=n(492);"undefined"!=typeof ArrayBuffer&&(r=n(493));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),c="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),f=u||c;e.protocol=3;var d=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},h=o(d[t]=n,o(e,r)})},a=0;a<t.length;a++)i(a,t[a],o)}e.encodePacket=function(t,n,r,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof r&&(o=r,r=null);var i,a,s,u=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=type;s<i.length;s++)a[s+1]=i[s];return r(a.buffepe];var i=new m([o.buffer,t.data]);return r(i)}(t,n,o);if(u&&u.base64)return i=t,a=o,s="b"+e.packets[i.type]+i.data.data,a(s);var c=d[t.type];return void 0!==t.data&&(c+=r?l.encode(String(t.data),{strict:!1}mCharCode.apply&"blob"===n&&(i=new mn"blob"===e&&m&&},function(t,e){=i,s=""}else s+=c}return""!==a=0;a<r.length;a++)o[inull,s)}})},function(t,e){return n(new m(e))})},e.decodePayloadAsBinary=function(t,n,r){"function"==typeof n&&(r=n,n=null);for(var o=t,i=[];0<o.byteLength;){for(var s=new Uint8Array(o),l=0===s[0],u="",c=1;255!==s[c];c++){if(310<u.length)return r(p,0,1);u+=s[c]}o=a(o,2+u.length),u=parseInt(u);var f=a(o,0,u);if(l)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(t){var d=new Uint8Array(f);for(f="",c=0;c<d.length;c++)f+=String.fromCharCode(d[ch(function(t,o){r(e.decodePacket(t,n,!0),o,h)})}},function(t,e,n)nction(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ufa=void 0,n(212);var o,i=r(n(253)),a=r(n(456)),s=r(n(457)),l=r(n(473)),u=function(t,e,n,r){return i.default.then(function(){if(void 0===o)throw new Error("ufa called before ufa.load.");o.execute(t,e,n,r)})};(e.ufa=u).enqueueTrackables=a.default,u.load=function(t,e,n){var r=new l.defauldeforts=function(t){return n.caor;return void 0in r.prototype)t[e]=r.prototype[e];return t}(t)}(t.expo"$"+t]=this._callthis,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.re===e||n.fn===e){r).length;r<o;++r)n[r].=this._callbacks||{},thisrh(s(t,r++))})):a(t,!1,n.push,n),new this(n))}})}},function(t,e,n){(function(r){function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(476)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),n){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var o=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))}),t.splice(i,0,r)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]:ype,t.prototype=new n,t.prototurn!t&&void 0!==r&&"envtotype.apply.%"!==t&removeItem("debug"):eAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrtion(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF99{return"[UnexpectedJSONParseError]:able,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(2).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(4),o=n(1),i=function(t,e){if(o(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(21)(Function.call,n(18).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return i(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:i}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var r=n(4),o=n(114).set;t.exports=function(t,e,n){var i,a=e.constructor;retueError("Count can't be negative");for(;0<i;(i>>>=1)&&(e+=e))1&i&&(n+=e);return n}},,entries:I},b)for(w in y)w in k||i(k,w,y[w]);else o(o.P+o.F*(d||_),e,y);return y}},function(t,e,n){"use strict";var r=n(45),o=n(41),i=n(54),a={};n(13)(a,n(5)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:o(1,n)}),i(t,e+" Iterator")}},function(t,e,n){var r=n(82),o=n(26);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(o(t))}},function(t,e,n){var r=n(5)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var r=n(57),o=n(5)("iterator"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||i[o]===t)}},function(t,e,n){"use strict";var r=n(8),o=n(41);t.exports=function(t,e,n){e in t?r.f(t,e,o(0,n)):t[e]=n}},function(t,e,n){var r=n(55),o=n(5)("iterator"),i=n(57);t.exports=n(20).getIteratorMethod=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[void 0,n),l=2<a?arguments[2]:void 0,u=void 0===l?n:o(l,n);s<u;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=n(36),o=n(178),i=n(57),a=n(17);t.exports=n(120)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,o(1)):o(0,"keys"==e?n:"values"==e1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r}),t.exports=l},function(t,e,n){"us(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),t.exports={set:d,clear:h}},function(t,e,n){var r=n(2),o=n(132).set,i=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,l="process"==n(22)(a);t.exports=function(){var t,e,n,u=function(){var r,o;for(l&&(r=a.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(l)n=function(){a.nextTick(u)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(u)}}else n=function(){o.call(r,u)};else{var f=!0,d=document.createTextNode("");new i(u).observe(d,{characterData:!0}),n=function(){d.data=f,e){X(this,8,t,W,e,arguments[2])}});v(C,b),v(T,y),s(T[w],a.VIEW,!0),e[b]=C,e[y]=T},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModction(){function t(){}return t.prototype.set=function(t,e,n){o.default.s){return o.default){throw new Error("process.chdir  o(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}tnds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(t);if("number"===a&&!1===isNaN(t))return eh.round(t/n)+"h":6e4<=t?Math.round(t/6e4)+"m":1e3<=t?Math.round(t/1e3)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){var r=n(477)("socket.io-parser"),o=n(479),i=n(480),a=n(201),s=n(202);function l(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BIk=t,this.buffers=[]}function h(t){return{type:e.ERROR,data:"parser error: "+t}}l.prototype.encode=function(t,n){var o,a;r("encoding pacction(t){var e=i.deconstructPacket(t),n=c(e.constructor.takeBinaestroy=function(){this.reconstructPacket(this.reconPack,this.bd.prototype.finishedReconstruction=function(){this.reconPack=null,this.buf)n+=Stri);return n}(r)}e.Buffer=l,e.SlowBuffer=function(t){return+t!=t&&(t=0),l.alloc(+t)},e.INSPECT_MAX_B&"function"==typeof t.subarray&&0===t.subarrayength=a(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return u(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]=:void 0!==i?"string"==typeof a?s(r,o).fill(i,a):s(r,o).fill(i):s(r,o);var r,o,i,a},l.allocUnsafe=functinction(t){i=Math.min(n,4":case"ur('"list" argument must be an Array of Buffers');a.copy(r,oze must be a multiptiple of 32-bits");<t;e+=8)m(this,e,e+7)Error("Unknown enconew TypeError("Argum"hex",0,n).match(/.{.slice(e,n),f=0;f<s;+a?-1:a<i?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.g(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||o<n)&&(n=o),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i,a,s,l,u,c,f=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return u=e,c=n,N(L(t,this.length-u),this,u,c);case"ascii":return y(this,t,e,n);case"latin1":case"binary":return y(this,t,e,n);case"base64":return s=e,l=n,N(Mth&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,this.length-i),this,i,a);default:if(f)throw new nction(){rer("Index out of range");if(n<0)throw new RangeError("Index o,r,23,4),n+4}functype;else{var o=e-t;n=ne,this.length);for(var e,this.length);for(vareturn r},l.prototype.readtype.readUInt16LE=functiotype.readUInt16BE=functiourn e||E(t,4,this.length)urn e||E(t,4,this.lengo=1,i=0;++i<e&&(o*=256[t+--r];0<r&&(o*=256)function(t,e){return e||e){e||E(t,2,this.length)e){e||E(t,2,this.length),e){return e||E(t,4,this,e){return e||E(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||E(t,4,this.length),o.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||E(t,4,this.length),o.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(pe.readDoubleBE=function-1,0);var o=1,i=0;for(th;var o=n-1,i=1;for(thisn||$(this,t,e,1,255,0),l.T65535,0),l.TYPED_ARRAY_SUP65535,0),l.TYPED_ARRAY_SUPis[e+3]=t>>>24,this[e+2]=tis[e]=t>>>24,this[e+1]=&(a*=256);)t<0&&0===s&&&(a*=256);)t<0&&0===s&-128),l.TYPED_ARRAY_SUPPO,-32768),l.TYPED_ARRAY_SU,-32768),l.TYPED_ARRAY_SUis[e]=255&t,this[e+1]=t>>is[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):A(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return D(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return D(this,t,e,!1,n)},l.prototypthis,t,e,!0,n)},l]=this[o+n];else (new l(t,r).toString()),s=ae,n,r){for(var o=new(self[["Active"].concat("t.isReactNative,this.extraHeaders=t.extraHeaders,tError(t);return n.readyState&&""!====this.readyState){if("open"!==this.otype.onOpen=functinData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPackton(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(39);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(ion(t,e,n){var r=n(71);t.exports=r("native-function-to-string",Function.toString)},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){var r=n(61),o=n(12)("toStringTag"),i="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Obje&r(i,n)&&u.push(n);for(;e.length>l;)r(i,n=e[l++])&&(~s(u,n)||u.push(n));return u}},function(t,e,n){varfunction(){return this}),t.exports={IteratorPrototype:r,BUGGY_SAFARI_on(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r=n(30),o=n(53),i=n(12)("species");t.exports=fueout(C(t),0)}:(r=x,a.addEventListener("message",T,!1))),t.exports={set:h,clear:p}},function(t,e,n){var r=n(10).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){var r=n(30),o=n(39),i=n(63);t.exports=function(t,e){if(r(t),o(e)&&e.constructor===t)return e;var n=i.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){t.exports=!n(7)&&!n(3)(function(){return 7!=Object.defineProperty(n(109)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(5)},function(t,e,n){var r=n(16),o=n(17),i=n(78)(!1),a=n(111)("IE_PROTO");t.exports=function(t,e){var n,s=o(t),l=0,u=[];for(n in s)n!=a&ion(t,e){o(t);for(var n,a=i(e),s=a.length,l=0;l<s;)r.f(t,n=a[l++],e[n]);return t}},function(t,e,n){var r=n(17),o=n(46).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window(f(p)):o(p),g=m.length,v=0;v<g;)h=m[v++],r&&!d.call(p,h)||(n[h]=p[h]);return n}:u},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";var r=n(11),o=n(4),i=n(168),a=[].slice,s={};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),l=function(){var r=n.concat(a.call(arguments));return this instanceof l?function(t,e,n){if(!(e in s)){for(var r=[],o=0;o<e;o++)r[o]="a["+o+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)}(e,r.length,r):i(e,r,t)};return o(e.prototype)&&(l.prototype=e.prototype),l}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(2).parseInt,o=n(56).trim,i=n(115),a=/^[-+]?0[xX]/;t.exports=8!==r(i+"08")||22!==r(i+"0x16")?function(t,e){var n=o(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},function(t,e,n){var r=n(2).parseFloat,o=n(56).trim;t.exports=1/r(n(115)+"-0")!=-1/0?function(t){var e=o(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},function(t,e,n){var r=n(22);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},function(t,e,n){(t);return o<l?u*(o/l/a+1/i-1/i)*l*a:s<(n=(e=(1+a/i)*o)-(e-o))||n!=n?u*(1/0):u*n}},function(t,e,n){var r=n(1);t.exports=function(t,e,n,o){try{return 7)&&"g"!=/./g.flags&&n(8).f(RegExp.prototype,"flags",{configurable:!0,get:n(67)})},functlength||t!=t||e!=e||n!=n||r!=r||o!=o?NaN:t===1/0||t===-1/0?t:(t-e)*(o-r)/(n-e)+r}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",n t(){}return t.prototype.generate=function(){return o.default().replace(/-/g,"")},t}();e.default=i},function(t,e,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};ObjArray=void 0,e.flattenArray=function(t,e){return Array.isArray(e)?r(t,e):r(t,[e])}},function(t,e,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(e,"__esModule",{value:!0}),e.IsObscuredByOverflowParent=e.isCSSHidden=void 0,e.IsObscuredByOverflowParent=function(t,e){var n=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=function t(e){if(e.parentElement){var n=getComputedStyle(e.parentElement);return(e.parentElement.scrollHeight>e.parentElement.offsetHeight||e.parentElement.scrollWidth>e.parentElement.offsetWidth)&&"hidden"===n.overflowX&&"hidden"===n.overflowY?e.parentElement:t(e.parentElement)}return null}(e[e.length-1]);return o?t.apply(void 0,r(e,[o])):e}(t),o=function(t,e,n){void 0===n&&(n=100);var r,o,i,a,s,l,u=t.getBoundingClientRect(),c=(r=e.map(function(t){return t.getBoundingClientRect()}),{left:Math.max.apply(Math,r.map(function(t){return t.left})),top:Math.max.apply(Math,r.map(function(t){return t.top})),bottom:Math.min.apply(Math,r.map(function(t){return t.bottom})),right:Math.min.apply(Math,r.map(function(t){return t.right}))});return!(n<=100*(o=u,i=c,a=Math.max(o.left,i.left),s=Math.max(o.top,i.top),l=Math.min(o.bottom,i.bottom),(Math.min(o.right,i.right)-a)*(l(!n.length||!o)},e.isCSSHidden=function(t){return!(t.offsetWidth||t.offsetHeight)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.getWindowScrollet},this.getWindowScrollLeft=function(){return window.scrollX||window.pageXOffset},this.top=this.getWindowScrollTop(),this.left=this.getWindowScrollLeft(),this.height=ty=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(t,e){var n={}ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}}).call(this,n(140).Buffer)},function(t,e,n){var r=n(484),o=n(209),i=n(69),a=n(139),s=n(210),l=n(211),u=n(9r=new n.Decoder,this.autoConnecs),this.nsps)d.call(this.nsp{for(var t in this.nspsd(t))},h.prototype.generateId=function(tction(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},h.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},h.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backnDelayMax=t,this.bac.timeout=function(t){return argumhis.reconnecting&&this._reconnection&roy:function(){cleal(this,"onclose")))ed")))},h.prototypeping")},h.prototypepong",new Date-this.lan(t){this.decoder.ad"packet",t)},h.prots.autoConnect&&i()}fonnecting,t);~e&&thlength;r++)e.engine.write(n[r],ketBuffer.length&&!t);this.packetBuffer=[],this.encoding=!1,t(),this.backoff.resed",this.emit("close",t"),t.onreconnect())}))},ef(n)return t.indexOf(e);for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}},function(t,e,n){var r=n(139),o=n(69),i=n(499),a=n(210),s=n(211),l=n(92)("socket.io-client:socket"),u=n(93),c=n(206);t.exports=h;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,rec0,this.flags={},n&&n.query&&(this.quthis,"onopen")),a(t,"packet",s(this,"o.open(),"open"==ion(){var t=i(args.ids++),this.conneis.flags={},this},hy %s",t),this.packet),this.connected=!1,tse r.DISCONNECT:thise.push(this.ack(nts);l("sending acj",t.id,t.data),e.appl){this.connected=!0,this.0;t<this.sendBuffer.lengter disconnect (%s)",<this.subs.length;t++)this.subs[t].destroNNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},h.prsxports=s&&s.ownKeys||function(t){var e=o.f(a(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(149),o=n(103).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e,n){var r=n(75),o=n(150),i=n(226);t.exports=function(t){return function(e,n,a){var s,l=r(e),u=o(l.length),c=i(a,u);if(t&&n!=n){for(;c<u;)if((s=l[c++])!=s)ath.max,i=Math.min;t.exports=function(t,e){var n{var u=e+" Iterator";return t.prototype=o(r,{next:i(1,n)}),a(t,u,!1,!0),sion(t,e){i(t);for(var n,r=a(e),s=r.length,l=0;l<s;)o.f(t,n=r[l++],e[n]);return t}},functi"),s=Array.prototype;null==s[a]&&i(s,a,o(null)),t.exports=function(t){s[a][t]=!0}},function(t,e,n){"use strict";var r,o,i,a=n(40),s=n(73),l=n(10),u=n(107),c=n(239),f=n(106),d=n(240),h=n(39),p=n(53),m=n(241),g=n(61),v=n(76),b=n(245),y=n(156),w=n(157).set,S=n(246),C=n(159),T=n(247),x=n(63),_=n(77),k=n(158),E=n(74),$=n(151),I=n(12)("species"),A="Promise",H=E.get,D=E.set,P=E.getterFor(A),j=l[A],O=l.TypeError,L=l.document,M=l.process,N=l.fetch,R=M&&M.versions,F=R&&R.v8||"",B=x.f,z=B,U="pnally)&&t&&-1===k.indexOf("Chrome/66"))}),V=Q||!b(function(t){j.all(t).catch(func)}{pan(ealljec},e(n){etall:A,done:!1,notified:!1,parent:!.domain:void 0,n.parent=!0,n.reactions.push(r),0!={var t=new r,e=H(t);this.promise=t,this.resolve=tt(nt,t,e),this.reject=tt(et,t,e)},x.f=B=function(t){return t===j||t===i?nel:!0,enumerable:!0,forced:!0},{fetch:function(t){return C(j,N.apply(l,arguments))}})),a({global:!0,wrap:!0,forced:Q},{reject:function(t){var e=B(this);return e.reject.call(void 0,t),e.promise}}),a({target:A,stat:!0,forced:s||Q},{resolvu||(uunction(t){o.call(e,t).then(n.resolve,r)})});return o.error&&r(o.value),n.promise}})},function(t,terator");t.exports=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(30);t.exports=function(t,e,n,o){try{return ),--f||c(new(i("AggregateError"))(a,u))});return f.error&&c(f.value),n.promisee:!0,get:function(){return e[n]}})}:function(t,e,ct.defineProperty(t,"defaultr n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a,s,l=(a=window._babelPolyfill,s=!window.Promise||!Object.prototype.hasOwnProperty.call(window.Object,"assign")||!Object.prototype.hasOwnProperty.call(window.String.prototype,"startsWith"),!fill needed for UFA, adding."),Promise.resolve().then(function(){return i(n(254))})):(console.wa(n)for(var a,s=n(t),l=i.f,u=0;s.length>u;)l.call(t,a=s[u++]7)("getOwnPropertyDescriptor",function(){return function(t,e){return o(r(t),e)}})},function(t,e,n){var r=n((t))}})},function(t,e,n){n(27)("getOwnPropertyNames",function(){return n(164).f})},function(t,e,n){var r=n(4),o=n(35).onFreeze;n(27)("freeze",function(t){return function(e){return t&&r(e)?t(o(e)):e}})},function(t,e,n){var r=n(4),o=n(35)7)("preventExtensions",function(t){return function(e){return t&&r(e)?t(o(e)):e}})},function(t,e,n){vare)&&(!t||t(e))}})},function(t,e,n){var r=n(0);r(r.S+r.F,"&&n(14)(Object.prototype,"toString",function(){return"[obje)return t instanceof this;for(;t=o(t);)if(this.prototype===t)return!0;retur).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"=},function(t,e,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e},function(t,e,n){var r=n(0),o=n(119);r(r.S+r.F*(o!=Math.ee,n){var r=n(0);r(r.S,"Math",{log10:function(t){return Man(t,e,n){var r=n(0);r(r.S,"Math",{log2:function(t){retur=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";veturn!!~o(this,t,"includes").indexOf(t,1<arguments.length?arvoid 0,e.length)),r=String(t);return s?s.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(15)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(15)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(15)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(15)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(15)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(15)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(15)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use trict";n(15)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(15)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(15)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"ust&&"default"!==t)throw TypeError("Incorrect hint");return oo(e.prototype)||(e=void 0),r(e)&&null===(e=e[i])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(0),o=n(28)(1);r(r.P+r.F*!n(24)([].map,!0),"Array",{map:function(t){return o(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),o=n(28)(2);r(r.P+r.F*!n(24)([].filter,!0),"Array",{filter:function(t){return o(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),o=n(28)(3);r(r.P+F*!n(24)([].every,!0),"Array",{every:function(t){return o(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),o=n(176);r(r.P+r.F*!n(24)([].reduce,!0)arguments[1]))),r<0&&(r=n+r);0<=r;r--)if(r in e&&e[r]===t)return r||0;return-1}})},x:function(t){return o(this,t,1<},function(t,e,n){var r=n(0);r(r.G+r.W+r.F*!n(88).ABV,{DataView:n(135).DataView})},function(t,e,n){n(31)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(,n){n(31)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},function(t,e,n){n(31)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(31)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(31)("Int32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(31)("Uint32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,strict";var r=n(0),o=n(81)(!0);r(r.P,"String",{at:function(t){return o(this,t)}})},function(t,e,n){"use strict";var r=n(0),o=n(191),i=n(86),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(i);r(r.P+r.F*a,"String",{p{padEnd:function(t){return o(this,t,1<arguments.length?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict.source,~n.indexOf("g")?n:"g"+n);return (t,e,n){var r=n(0),o=n(192)(!1);r(r.S,"Object",{values:function(t){return o(t)}})},function(t,e,n){var r=n(0),o=n(192)(!0);r(r.S,"Object",{entries:function(t){return o(t)}})},function(t,e,n){"use strict";var r=n(0),o=n(9),i=n(11),a=n(8);n(7)&&r(r.P+n(89),"Object",{__defineSetter__:function(t,e){a.f(o(this),t,{set:i(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),o=n(9),i=n(25),a=n(19),s=n(18).f;n(7)&&r(r.P+n(89),"Object",{__lookupGetter__:function(t){var e,n=o(this),r=i(t,!0);do{if(e=s(n,r))return e.set}whi193)("Map")})},function(t,e,n){var r=n(0);r(r.P+r.R,"Set",{toJSON:n(193)("Set")})},function(t,e,n){n(90)("Map")},function(t,e,n){n(90)("Set")},function(t,e,n){n(90)("WeakMap")},function(t,e,n){n(90)("WeakSet")},function(t,e,n){n(91)("Map")},function(t,e,n)function(t,e,n){n(91)("WeakSet")},function(t,e,n){var r=n(n(t,e,n){var r=n(0),o=Math.PI/180;r(r.S,"Math",{radians:fr r=n(0);r(r.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:0<t}})},function(t,e,n){"use strict";var r=n(0),o=n(20),i=n(2),a=n(68),s=n(182);r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,o.Promise||i.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(functiadataKeys:function(t){return c(a(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,e,n){var r=n(32),o=n(1),i=r.get,a=r.key;r.exp({getOwnMete,n)}};o(o.G+o.B+o.F*s,{setTimeout:l(r.setTimeout),setInterval:l(r.setInterval)})},function(t,e,n){var r=n(0),o=n(132);r(r.G+r.B,{setImmediate:o.set,clearImmediate:o.clear})},function(t,e,n){for(var r=n(129),o=n(43),i=n(14),a=n(2),s=n(13),l=n(57),u=n(5),c=u("iterator"),f=u("toStringTag"),d=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=o(h),m=0;m<p.length;m++){var g,v=p[m],b=h[v],y=a[v],w=y&&y.prototypobject"==typeof window?window:"object"==typeof self?se(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){"use strict";function r(t,e){var n=e[0],r=e[1],o=r();return o?t.found[n]=o:t.retry[n]=r,t}Object.definePropert{for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push([n[r],t[n[r]]]);return e}(e).reduce(r,{found:{},retry:{}}),a=i..length&&n(a),Object.keys(s).length&&0<o&&setTimeout(function(){return t(s,n,o-1)},500)}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=l(n(458)),c=l(n(459)),f=l(n(196)),d=n(59),h=a(n(464)),p=a(n(467)),m=l(n(470)),g=l(n(472)),v=l(n(136)),b=function(){function t(t,e,n,r){void 0===n&&(n=new c.default),void 0===r&&(r=new v.default),this.idGenerator=new f.default,this.pageViewUuid=null,this.window=t,this.socketClient=e,this.identityManager=n,this.cookieManager=r}return t.getDimensionProperties=function(t){var e=t.document;return{dimensions:{device:{height:t.screen.height,width:t.screen.width},document:{height:Math.max(e.documentElement.clientHeight,e.documentElement.offsetHeight,e.documentElement.scrollHeight),width:Math.max(e.documentElement.clientWidth,e.documentElement.offsetWidth,e.documentElement.scrollWidth)},viewport:{height:e.documentElement.clientHeight,width:e.documentElement.clientWidth}}}},t.prototype.executeAll=function(t){for(var e=0,n=s(t);e<n.length;e++){var r=n[e];if(r.length<1||3<r.length)throw new Error("snippet ufa queue entry had unexpected length "+r.length+".");this.execute(r[0],r[1],r[2])}},t.prototype.execute=function(t,e,n,o){var i=this;e=u.default.normalize(e);var a,s={timestamp:Math.floor((new Date).getTime()/1e3)},l=function(){if(i.impressionTrackingRules){var t=h.getImpressedItemContracts(i.impressionTrackingRules);if(!function(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push(t[n[r]]);return e}(t).length)return;d.ufa("track_impressions",t)}},c=this.cookieManager.get("ufa_latest_recommendation_token")||null;switch(t){case"init":this.initImpressionTracking(e),this.initScrollDepthTracking(e),this.initRecommendationTracking(e);break;case"view_page":this.pageViewUuid=this.idGenerator.generate(),s.url=window.location.href,s.referrer=document.referrer;break;case"track_time_on_page":m.default(e);break;case"track_lazy_load_impressions":l();break;case"track_reco_panel_impressions":l(),i.recommendationTrackingRules&&g.default(i.recommendationTrackingRules,i.cookieManager);break;case"track_lazy_load_viewport_adjustments":!function(){if(i.scrollDepthTrackingRules){var t=p.getScrollDepthContracts(i.scrollDepthTrackingRules);d.ufa("adjust_veiwport",t)}}()}switch(t){case"init":a=this.identityManager.init(this.window,e);break;case"opt_in":a=this.identityManager.optIn();break;default:a=this.identityManager.getIdentity()}if(e=r(r(r(r({},s),a),{pageViewUuid:this.pageViewUuid,recommendationToken:c}),e),void 0===n)this.socketClient.emit(t,e);else if(void 0===o)this.socketClient.emit(t,e,function(r){return n(t,e,r)});else{var f=!1,v={error:{code:"99",message:"The server didn't respond before thmay or may not have been processed."}},b=setTimeout(function(){f||(f=!0,n(t,e,v))},o);this.socketClient.emit(t,e,function(r){f||(clearTimeout(b),n(t,e,r))})}switch(t){case"view_page":this.startImpressionTracking(),this.startScrollDepthTracking(),this.startRecommendationTracking();break;case"opt_out":this.identityManager.optOut()}},t.prototype.initImpressionTracking=function(t){t.impressionTracking&&t.impressionTracking.rules&&(this.impressionTrackingRules=t.impressionTracking.rules)},t.prototype.startImpressionTracking=function(){this.impressionTrackingRules&&h.default(this.impressionTrackingRules)},t.prototype.initScrollDepthTracking=function(t){t.scrollDepthTracking&&t.scrollDepthTracking.rules&&(this.scrollDepunction(){this.scrollDepthTrackingRulesTracking.rules&&(this.recommendationTractionTrackingRules&&g.default(this.recommendatioypeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return{};if(Array.isArray(e))return e.reduce(function(e,n){return o(e,t.normalize(n))},{});switch(r(e)){case"object":return e;case"string":case"number":case"boolean":return{val:e};case"function":return t.normalize(e())}return{}},t}();e.default=i},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(136)),a=o(n(196)),s=function(){function t(e){void 0===e&&(e=new i.default),this.idGenerator=new a.default,this.options=t.defaultOptions,this.initialized=!1,this.cookieManager=e}return t.prototype.init=function(e,n){return this.options=r(r(r({},t.defaultOptions),{cookieDomain:e.location.hostname,cookieSecure:"https:"===e.location.protocol}),n),this.initialized=!0,this.getIdentity()},t.prototype.optIn=function(){if(!this.initialized)throw new Error("init must be called before optIn.");return this.optedIn=!0,this.getIdentity()},t.prototype.optOut=function(){if(!this.initialized)throw new Error("init must be called before optOut.");var t=this.getIdentity();null!==t.visitorUuid&&null!==t.sessionUuid&&this.clearWindowUuid(t.visitorUuid,t.sessionUuid),this.clearSessionUuid(),this.clearVisitorUuid(),this.optedIn=!1},t.prototype.getIdentity=function(){if(!this.initialized)throw new Error("init must be called before getIdentity.");var t=this.options.accountId;if(void 0===t)throw new Error("init must be called with accountId.");if(!this.hasOptedIn())return{accountId:t,sessionUuid:null,visitorUuid:null,windowUuid:null};var e=this.getVisitorUuid(),n=this.getSessionUuid();return{accountId:t,sessionUuidrototype.getWindowUuidKey=function(t,e){return this.options.windowKey+"_"+t+"_"+e},t.prototype.hasOptedIn=function(){return void 0!==this.optedIn?this.optedIn:!this.options.requireOptIn||this.hasVisitorUuid()},t.prototype.clearVisitorUuid=function(){this.removeCookie(this.options.visitorCookie)},t.prototype.getVisitorUuid=function(){return this.generateCookie(this.options.visitorCookie,new Date((new Date).getuid=function(){return void 0!ototype.clearSessionUuid=function(){this.removeCookie(this.options.sessionCookie)},t.prototype.getSessionUuid=function(){return this.generateCookie(this.options.sessionCookie,new Date((new DatewUuid=function(t,e){var n=this.getWindowUuidKey(t,e);sessionStorage.removeItem(n)},t.prototype.getWindowUuid=function(t,e){var n=this.getWindowUuidKey(t,e),r=sessionStorage.getItem(n);return null===r&&(r=thcookieSecure,sameSite:this.options.cookieSameSite};this.cookieManager.remove(t,e)},t.prototype.generateCookie=function(t,e){var n=this.cookieManager.get(t);void 0===n&&(n=this.idGenerator.generate());var r={domain:this.options.cookieDomain,expires:e,secure:this.options.cookieSecure,sameSite:this.options.cookieSameSite};return this.cookieManager.set(t,n,r),n},t.defaultOptions={visitorCookie:"_ufav",visitorCookieExpiry:365,sessionCookie:"_ufas",sessionCookieExpiry:60,cookieDomain:"",cookieSecure:!1,cookieSameSite:"laxemove=function(e,n){r(e,"",t(n,{expires:-1}))},r.withConverter=e,r}(function(){})},vo[r++]],"-",o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]]].join("")}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(e,"__esModule",{value:!0}),e.getImpressedItemContracts=e.monitorCacheSize=void 0;var i=n(59),a=n(197),s=n(465),l=new Set;e.monitorCacheSize=function(t,e){return t.size>=e?new Set:t};var u=function(t){var n=t.selectors,o=t.name,i=t.transformerCallback;reteturn Array.from(document.querySelectorAll(t)).filter(function(t){return!l.has(t)}).filter(s.isVisibcheSize(l,1e3)).add(t),t}).map(i).map((n=o,function(t){return r(r({},t),{name:n})}))}).reduce(a.flattenArray,[])},c=function(t,e){return t[e.name]?t[e.name]=o(t[e.name],[e]):t[e.name]=[e],t};e.getImpressedItemContracts=function(t){return t.map(u).reduce(a.flattenArray,[]).reduce(c,{})},e.default=function(t){var n=null,r=function(){n&&clearTimeout(n),n=setTimeout(function(){var n=e.getImpressedItemContracts(t);(function(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push(t[n[r]]);return e})(n).length&&i.ufa("track_impressions",n)},1e3)};window.addEventListener("load",r),window.addEventListener("scroll",r),window.addEventListener("resize",r);for(var o=document.getElementsByClassName("uf-slider-control"),a=0;a<o.length;a++)o[a].addEventListener("click",r)}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.isCSSHidden=e.isVisible=void 0;var o=r(n(466)),i=n(198);Object.defineProperty(e,"isCSSHidden",{enumerable:!0,get:function(){return i.isCSSHidden}});var a=r(n(199));e.isVisible=function(t){if(i.isCSSHidden(t)||i.IsObscuredByOverflowParent(t,50))return!1;var e=new a.default,n=new o.default(t,e),r=n.bottom<=e.bottom&&n.top>=e.top,s=.5*n.height,l=e.bottom-s>=n.top&&n.bottom-s>e.top;return!(!r&&!l)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){this.element=t,this.top=e.top+t.getBoundingClientRect().top,this.height=t.offsetHeight,this.bottom=this.top+this.height,.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.getScrollDepthContracts=void 0;var a,s=i(n(468)),l=n(59),u=n(469),c=n(197),f=n(198),d=function(t,e){return t[e.name]?t[e.name]=o(t[e.name],[e]):t[e.name]=[e],delete e.name,delete e.selector,t},h=i(n(199)),p=function(t){var e=t.selector,n=Array.from(document.querySelectorAll(e)),o=[];return n.forEach(function(e){if(!f.isCSSHidden(e)){var n=e.getBoundingClientRect(),i={height:e.offsetHeight,left:n.left,top:n.top,width:e.offsetWidth};return o.push(r(r({},t),i))}}),o};e.getScrollDepthContracts=function(t){var e=new h.default,n=t.map(p).reduce(c.flattenArray,[]).reduce(d,{});void 0===a&&(a=u.getDocumentHeight());var o={documentHeight:u.getDocumentHeight(),documentInitialHeight:a,documentWidth:u.getDocumentWidth(),scroltion(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push(t[n[r]]);return e}(n).le.default(function(){var n=e.getScrollDepthContracts(t);l.ufa("adjust_viewport",n)},1e3,{leading:!1,trailing:!0});window.addEventListener("load",n),window.addEventListener("scroll",n),wivoid 0===l?s:C(g())},T}(t,e,{leading:o,maxWait:e,trailing:i})}}).call(this,n(37))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getDocumentWidth=e.getDocumentHeight=void 0,e.getDocumentHeight=function(){return docfunction(){return document.body.scrollWidth||document.documentElement.scrollWidth}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(471)),i=n(59);e.default=function(t){var e,n,r,a=!1,s=function(){return Date.now()},l=function(t,e){return clearTimeout(t),e.cancel(),!1},u=function(){if("visib,r);var o=function(t){if(t&&t.timerInterval)return{timerInterval:t.timerInterval}}(t);return i.ufa("adjust_pointer",o)},c=function(){e=s(),a||(a=!0,n=setInterval(u,2e3))};r=o.default(c,2e3,{leading:!1,trailing:!0}),document.addEventListener("keydown",r),document.addEventListener("click",r),window.addEventListener("mousemove",r),window.addEventListener("scroll",r),document.addEventListener("visibilitychange",r),c()}},function(t,e,n){(function(e){var n=NaN,r="[object Symbol]",o=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt,u="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,f=u||c||Function("return this")(),dace(o,""earTimeout(s),r=l=o=s=void(u=0)},C.flush=function(){return void 0===s?a:S(m())},C}}).call(this,n(37))},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",var o=r(n(136));e.getEventTargetElement=function(t){var e=t.target;return e||null},e.default=function(t,n){void 0===n&&(n=new o.default);for(var r=function(t){for(var r=0,o=t.selectors;r<o.length;r++)for(var i=o[r],a=document.querySelectorAll(i),s=0;s<a.length;s++)a[s].addEventListener("click",function(r){var o=e.getEventTargetElement(r);if(o){var i=t.transformerCallback(o);if(i){var a={domain:"",secure:"https:"===window.location.protocol,expires:new Date((new Date).getTime()+5184e6),sameSite:"Lax"};n.set("ufa_latest_recommendation_token",i,a)}}})},i=0,a=t;i<a.(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(474)),a=function(){function t(t){this.socketIoClient=i.default(t,{path:"/v1",transports:["websocket"]})}return t.prototype.emit=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(void 0===this.socketIoClient)throw new Error("emit called after close.");(e=this.socketIoClient).emit.apply(e,r(["command",t],n))},t.prototype.close=function(){if(void 0===this.socketIoClient)throw new Error("close called multiple times.");this.socketIoClient.close(),this.socketIoClient=void 0},t}();e.default=a},function(t,e,n){var r=n(475),o=n(139),i=n(203),a=n(92)("socket.io-client");t.exports=e=l;var s=e.managers={};function l(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,o=r(t),l=o.source,u=o.id,c=o.path,f=s[u]&&c in s[u].nsps;return n=e.forceNew||e["force new connection"]||!1===e.multiplex||f?(a("ignoring socket cache for %s",l),i(l,e)):(s[u]||(a("new io instance for %s",l),s[u]=i(l,e)),s[u]),o.query&&!e.query&&(e.query=o.query),n.so://"+i+":"+n.port,n.href=n.protocol+"://"+i+(e&&e.port===n.port?"":":"+n.port),n}},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,o=+new Date,i=o-(n||o);t.diff=i,t.prev=n,t.curr=o,n=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=e.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;l++;var o=e.formatters[r];if("function"==typeof o){var i=a[l];n=o.call(t,i),a.splice(l,1),l--}return n}),e.formatArgs.call(t,a),(r.log||e.log||console.log.bind(console)).apply(t,a)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=o,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function o(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var i=e.instances[n];i.enabled=e.enabled(i.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(138),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,n){(function(r){function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(478)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),n){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var o=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))}),t.splice(i,0,r)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(137))},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,o=+new Date,i=o-(n||o);t.diff=i,t.prev=n,t.curr=o,n=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=e.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;l++;var o=e.formatters[r];if("function"==typeof o){var i=a[l];n=o.call(t,i),a.splice(l,1),l--}return n}),e.formatArgs.call(t,a),(r.log||e.log||console.log.bind(console)).apply(t,a)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=o,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function o(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var i=e.instances[n];i.enabled=e.enabled(i.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,n){var r=n(201),o=n(202),i=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"==typeof File||"unde[l]=t(e[l],n);return a}return e}(n,e),i.attachments=e.length,{packet:i,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,n){if(!e)return e;if(e&&!0===e._placeholder){var o="number"==typeof e.num&&0<=e.num&&e.num<n.length;if(o)return n[e.num];throw new Error("illegal attachments")}if(r(e))for(var i=0;i<e.length;i++)e[i]=t(e[i],n);else if("object"==typeof e)for(v[d],d,l);else if("object"==typeof l&&!o(l))"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=u(t),r=n[0],a=n[1],s=new i(3*(r+(d=a))/4-d),l=0,c=0<a?r-4:r,f=0;f<c;f+=4)e=o[t.charCodeAt(f)]<<18|o[t.charCodeAt(f+1)]<<12|o[t.charCodeAt(f+2)]<<6|o[t.charCodeAt(f+3)],s[l++]=e>>16&255,s[l++]=e>>8&255,s[l++]=255&e;var d;return 2===a&&(e=o[t.charCodeAt(f)]<<2|o[t.charCodeAt(f+1)]>>4,s[l++]=255&e),1===a&&(e=o[t.charCodeAt(f)]<<10|o[t.charCodeAt==o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijkt[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>/=256,o-=8);for(a=a<<o|s,u+=o;0<u;t[n+h]=255&a,h+=p,a/=256,u-=8);t[n+h-p]|=128*m}},function(t,e){var n={}ject Array]"==n.call(t)}},function(t,e,n){t.exports=n(485),t.exports.parser=n(58)},function(t,e,n){var r=n(204),o=n(69),i=n(95)("engine.io-client:socket"),a=n(208),s=n(58),l=n(200),u=n(93);function c(t,e){if(!(this instanceof c))return new c(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=l(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=l(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&0<Object.keys(e.extraHeaders).length&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}(t.exports=c).priorWebsocketSuccess=!1,o(c.prototype),c.protocol=s.protocol,(c.Socket=s.requestTimeout,(t){return this.transport",function(t){e.onrror",s),e.once("clprobes");for(var t=0,ge",t.data)}else i('packmoveListener("heartbeat"osed"!==e.readyStateithin %sms",t.pinype.ping=function(){,(this.prevBufferL(this.writeBuffer),this.prevBufferLite=c.prototype.send=fu("packetCreate",o)ror",n),e()}functionc.priorWebsocketSucced",this.id=null,this.emit(rr called too many times");--i.count,t?(o=!0,e(n[o];if(o++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function f(t){var e,i;if(r<o)throw Error("Invalid byte index");if(o==r)return!1;if(e=255&n[o],o++,0==(128&e))return e;if(192==(224&e)){if(128<=(i=(31&e)<<6|c()))return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if(2048<=(i=(15&e)<<12|c()<<6|c()))return s(i,t)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&65536<=(i=(7&e)<<18|c()<<12|c()<<6|c())&&i<=111411 n=!1!=<(;return!1},e.humanize=n(138),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,n){(function(e){var r=n(205),o=n(94);t.exports=u;var i,a=/\n/g,s=/\\n/g;function l(){}function u(t){if(r.call(this,t),this.query=this.query||{},!i){var n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{};i=n.___eio=n.___eio||[]}this.index=i.length;var o=this;i.push(function(t){o.onData(t)}),this.querystener&&addEventListener("beforeunload",function(){o.script&&eChild(this.form),tElement("iframe");dotatechange=function(){"complete"===n.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,n(37))},function(t,e,n){(function(e){var r,o,i=n(142),a=n(58),s=n(93),l=n(94),u=n(207),c=n(95)("engine.io-client:websocket");if("undefined"!=typeof WebSocket)r=WebSocket;else if("undefined"!=typeeNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(f=o),i.call(this,t)}l(t.exports=naryType="nodebuffer"):this.ws(e){t.onData(e.datn.emit("flush"),setTin")},0))})}(t[o])},lose.call(this)}1!==this.hostname.pe.check=function(){return!(e.salueOf=mr.prototype.value=function(){return Wo(this.__wrapped__,this.__actions__)},mr.prototype.first=mr.prototype.head,Ne&&(mr.prototype[Ne]=function(){return this}),mr}();je._=Mn,(o=function(){return Mn}.call(e,n,e e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.history;if(t.hasBeenWrapped)return t;var e=funcon(){var t=n.apply(this,arguments);return $(window).trigger("history.".concat(e),arguments),t}};for(var n in t.getState=function(){return t.state},t){"function"==typeof t[n]&&(t[n]=e(n))}return t.hasBeenWrapped=!0,t};e.wrapHistory=c;var f={withCookie:function(t){t.cookie=r.default},withFitVids:function(t){t.fn.fitVids=function(){(0,o.defaucrollbar=function(t){var e=arguments;return this.each(function(n,r){r.ps?"function"==typeof r.ps[t]&&(r.ps[t](),"destroy"===t&&(r.ps=null)):r.ps=s(i.default,[r].concat(u(e)))}),this}},withAllPollyfills:function(t){this.withCookie(t),this.withFitVids(t),this.withPerfectScrollbar(t)}};e.augmentJquery=f;var d={wrapHistory:c,augmentJquery:f};e.default=d},function(t,e,n){"use strict";var r=['iframe[src*="player.vimeo.com"]','iframe[src*="youtube.com"]','iframe[src*="youtube-nocookie.com"]','iframe[){return"string"==typeof t?t.split(",").map(l).filter(s):function(t){return"[object Array]"===Object.prototype.toString.call(t)}(t)?function(t){return[].concat.apply([],t)}(t.map(a).filter(s)):t||[]}function s(t){return t.length>0}function l(t){return t.replace(/^\s+|\s+$/g,"")}t.exports=function(t,e){var n;e=e||{},n=t=t||"body","[object Object]"===Object.prototype.toString.call(n)&&(e=t,t="body"),e.ignore=e.ignore||"",e.players=e.players||"";var l=i(t);if(s(l)){var u;if(!document.getElementById("fitnt.head")[0]).appendChild(((u=document.createElement("div")).innerHTML='<p>x</p><styl("height"),10),r=isNaN(e)?t.clientWidthTop=100*o+"%",i.appendChild(t)}(t)})})}}},function(t,e,n){"use strict";function r(t){return getComputedStyle(t)}function o(t,e){for(var n in e){var r=e[n];"number"==typeof r&&(r+="px"MatchesSelector);function s(t,e){if(!a)throw new Error("No element matching method supported");return a.call(t,e)}function l(t){t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t)}function u(t,e){return Array.prototype.filte(t,e)})}var c={main:olliar n=t.element.classList,r=c.state.scrolling(e)ove(c.state.scrollin(t,e){void 0===this.hh(e),this.elemilter(function(r){return!(!e||r===e)||(n.elem){return 0===t.handlers[CustomEvent)retur"CustomEvent");retu.element===t})[0];retuent(t).bind(e,n)}is.evend");e&&(f.dispatchEvent(v("ps-scroll-"+l)),e<0?f.dispatchEvent(v("ps-scroll-"+u)):e>0&&f.dispatchEvent(v("ps-scroll-"+c)),r&&function(t,e){d(t,e),h(t,e)}(t,l));t.reach[l]&&(e||o)&&f.dispatchEvent(v("ps-"+l+"-reach-"+t.reach[l]))}(t,n,i,r,o)};function y(t){return parseInt(t,10)||0}var w={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"ind(t.ownerDocumenlbarX,"moused})},"dragif(0===o&&r>0||o>=t.contentHeight-t.containerHeight&&rfault())}})},wheel:fuw,a.overflowX,a.overflowY].join("").match(/(scroll|auto)/)){var s=i.scrollHeight-i.clientHeight;if(s>0&&!(0===i.scrollTop&&o>0||i.scrollTop===s&&o<0))return!0;var l=i.scrollWidth-i.clientWidth;if(l>0&&!(0===i.scrollLeft&&n<0||i.scrollLeft===l&&n>0))return!0}i=i.parentNode}return!1}(n.target,i,a)){var s=!1;t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(a?e.scrollTopcrollLeft+=i*t.settings.wheelSpeed),S(t),(s=s||function(n,r){var o=Math.floor(e.scrollTop),i=0===e.scrollTop,a=o+e.offsetHeight===e.scrollHeight,s=0===e.scrollLeft,l=e.scrollLeft+e.offsetWidth===e.scrollWidth;return!(Math.abs(r)>Math.abs(n)?i||a:s||l)||!t.settings.wheelPropagation}(i,a))&&!n.ctrlKey&&(n.stopPropagation(),n.preventDefault())}}void 0!==window.onwheel?t.event.bind(e,"wheel",n):void 0!==window.onmousewheel&&t.event.bind(e,"mousewheel",n)},touch:function(t){if(w.supportsTouch||w.supportsIePointer){var e=t.element,n={},o=0,i={},a=null;w.supportsTouch?(t.event.bind(e,"touchstart",f),t.event.bind(e,"touchmove",d),t.event.bin=t.pointerType&&0===t.buttons||(!t.targetTouches||1!==t.targetTouches.length)&&(!t.pointerType||"mousow,a.overflowX,a.overflowY].join("").match(/(scroll|auto)/)){var s=i.scrollHeight-i.clientHefunction(n,r){var o=Math.fi))return!0;return!0}(h,p)&&a.preventDefault()}}function h(){t.settings.swipeEasing&&(clearInterval(a),a=setInterval(function(){t.isInitialized?clearInterval(a):i.x||i.y?Math.abs(i.x)<.01&&Math.abs(i.y)<.01?clearInterval(a):(s(30*i.x,30*i.y),i.x*=.8,i.y*=.8):clearInterval(a)},10))}}},_=function(t,e){var n=this;if(void 0===e&&(e={}),"string"==typeof t&&(t=document.querySelector(t)),!t||!t.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");for(var a in this.element=t,t.classList.add(c.main),this.settings={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1},e)n.settings[a]=e[a];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var s,l,u=function(){return t.classList.add(c.state.focus)},f=function(){return t.classList.remove(c.state.focus)};this.isRtl="rtl"===r(t).direction,this.isNegativeScroll=(l=t.scrollLeft,t.scrollLeft=-1,s=t.scrollLeft<0,t.scrollLeft=l,s),this.negativeScrollAdjustment=this.isNegativeScroll?t.scrollWidth-t.clientWidth:0,this.event=new g,this.ownerDocument=t.ownerDocument||document,this.scrollbarXRail=i(c.element.rail("x")),t.appendChild(this.scrollbarXRail),this.scrollbarX=i(c.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",u),this.event.bind(this.scrollbarX,"blur",f),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var d=r(this.scrollbarXRail);this.scrollbarXBottom=parseInt(d.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=y(d.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=y(d.borderLeftWidth)+y(d.borderRightWidth),o(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=y(d.marginLeft)+y(d.marginRight),o(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=i(c.element.rail("y")),t.appendChild(this.scrollbarYRail),this.scrollbarY=i(c.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",u),this.event.bind(this.scrollbarY,"blur",f),this.scrollbarYActive=nul10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=y(h.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?function(t){var e=r(t);return y(e.width)+y(e.paddingLeft)+y(e.paddingRight)+y(e.borderLeftWidth)+y(e.borderRightWidth)}(this.scrollbarY):null,this.railBorderYWidth=y(h.borderTopWidth)+y(h.borderBottomWidth),o(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=y(h.marginTop)+y(h.marginBottom),o(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:t.scrollLeft<=0?"start":t.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:t.scrollTop<=0?"start":t.scrollTop>=this.contentHeight-thi=y(r(this.scrollbarYRplay:""}))},_.prototunction(){this.isAlive&&(thielement=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)},_.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(t){return!t.match(/^ps([-_].+|)$/)}).join(" ")},e.default=_},function(t,e,n){n(10)(n(295))},function(t,e){t.exports="(function() {\n    \"use strict\";\n\n    // Collection Types\n    Hubs.COLLECTION_TYPE_NONE     = 'none';\n    Hubs.COLLECTION_TYPE_FEATURED = 'featured';\n    Hubs.COLLECTION_TYPE_DOCS     = 'docs';\n    Hubs.COLLECTION_TYPE_VIDEOS   = 'videos';\n    Hubs.COLLECTION_TYPE_SOCIAL   = 'social';\n    Hubs.COLLECTION_TYPE_BLOGS    = 'blogs';\n\n    // Item-Collection Mapping (for determining which collection type an item belongs to)\n    Hubs.ITEM_COLLECTION_MAP  = {\n        'uberflip' : Hubs.COLLECTION_TYPE_DOCS,\n        'vimeo'    : Hubs.COLLECTION_TYPE_VIDEOS,\n        'youtube'  : Hubs.COLLECTION_TYPE_VIDEOS,\n        'wistiar'  : Hubs.COLLECTION_TYPE_VIDEOS,\n        'vidyard'  : Hubs.COLLECTION_TYPE_VIDEOS,\n        'twitter'  : Hubs.COLLECTION_TYPE_SOCIAL,\n        'instagram': Hubs.COLLECTION_TYPE_SOCIAL,\n        'blogpost' : Hubs.COLLECTION_TYPE_BLOGS,\n        'blogs'    : Hubs.COLLECTION_TYPE_BLOGS\n    };\n\n    // Page Types\n    Hubs.PAGE_TYPE_HUB        = 'hub';\n    Hubs.PAGE_TYPE_COLLECTION = 'collection';\n    Hubs.PAGE_TYPE_ITEM       = 'item';\n    Hubs.PAGE_TYPE_AUTHOR     = 'author';\n    Hubs.PAGE_TYPE_PRIVACY    = 'privacy';\n    Hubs.PAGE_TYPE_CTA        = 'cta';\n\n    // Collection Page Types\n    Hubs.COLLECTION_PAGE_TYPES = [Hubs.PAGE_TYPE_COLLECTION, Hubs.PAGE_TYPE_HUB, Hubs.PAGE_TYPE_AUTHOR];\n\n    // Type Determination Regex's\n    Hubs.REGEX_FLIPBOOK    = /uberflip|flipbook/i;\n\n    // Size of Small Screen for Small Screen Device Detection\n    Hubs.SMALL_SCREEN_HEIGHT = 500;\n\n    // Size for defining Large Content Images\n    Hubs.LARGE_IMAGE_WIDTH = 150;\n    Hubs.LARGE_IMAGE_HEIGHT = 150;\n\n    // Click/Tap Event Types\n    Hubs.CLICK_EVENT    = 'click.Hubs';\n    Hubs.TAP_EVENT      = 'click.Hubs';\n    Hubs.SWIPE_UP_EVENT = 'swipeup.Hubs swiperightup.Hubs swipeleftup.Hubs';\n    Hubs.CLICK_EVENT_CTA_SUBMIT = 'click.HubsCtaSubmit';\n    Hubs.CHANGE_EVENT_CTA_FIELD  = 'change.HubsCtaField';\n    Hubs.CLICK_EVENT_CTA_FIELD  = 'click.HubsCtaField';\n    Hubs.CLICK_EVENT_CTA_DISMISS = 'click.HubsCtaDismiss';\n    Hubs.TOUCH_START_EVENT_CTA_FIELD = 'touchstart.HubsCtaField';\n    Hubs.TOUCH_END_EVENT_CTA_FIELD = 'touchend.HubsCtaField';\n    Hubs.TOUCH_MOVE_EVENT_CTA_FIELD = 'touchmove.HubsCtaField';\n    Hubs.CLICK_EVENT_CTA_CANCEL = 'click.HubsCtaCancel';\n    Hubs.FOCUS_EVENT            = 'focus.Hubs';\n\n    // Search Constants\n    Hubs.SEARCH_MAX_RECENT        = 5;\n    Hubs.SEARCH_DISPLAY_INITIAL   = 5;\n    Hubs.SEARCH_DISPLAY_INTERVAL  = 20;\n    Hubs.SEARCH_MOBILE_BREAKPOINT = 860;\n\n    // LazyLoader Directions\n    Hubs.LAZYLOAD_VERTICAL   = 'vertical';\n    Hubs.LAZYLOAD_HORIZONTAL = 'horizontal';\n\n    // Cookie for GDPR privacy preferences\n    Hubs.PRIVACY_PREFS_COOKIE_NAME = 'uf_privacy_prefs';\n\n    // States for GDPR privacy banner\n    Hubs.SHOW_NO_BANNER = 0;\n    Hubs.SHOW_PRIMARY_BANNER = 1;\n    Hubs.SHOW_SECONDARY_BANNER = 2;\n\n    Hubs.CTA_LOCALSTORAGE_KEY =  'uf_cta_query_params';\n\n    // Debug Statements\n    Hubs.DEBUG_MSG = {\n        'app-init'                  : 'Hubs:App Initializing',\n        'app-init-end'              : 'Hubs:App Complete & Ready',\n        'app-post-init'             : 'Hubs:App Post-Initializing',\n        'app-post-init-end'         : 'Hubs:App Post-Complete & Ready',\n        'app-resize'                : 'Hubs:App Event - Resize',\n        'app-resize-end'            : 'Hubs:App Event Complete - Resize',\n        'app-reload'                : 'Hubs:App Reloading',\n        'app-reload-end'            : 'Hubs:App Reloading Complete',\n\n        'parse-collections'         : 'Hubs:App Parsing Collections into Groups',\n        'parse-collections-end'     : 'Hubs:App Parsing Collections Completed',\n\n        'events-init'               : 'Hubs:App Initializing Events',\n        'doc-events-init'           : 'Hubs:App Initializing Flipbook-Document Container Events',\n        'doc-toggle-fullscreen'     : 'Hubs:App Toggling Fullscreen Flipbook: {{fullscreen}}',\n\n        'nav-desktop-init'          : 'Hubs:App Initializing Desktop Navigation',\n        'nav-mobile-init'           : 'Hubs:App Initializing Mobile Navigation',\n\n        'links-override-init'       : 'Hubs:App Overriding Page Links',\n        'internal-link-click'       : 'Hubs:App Event - Internal Link Click',\n        'external-share-link-click' : 'Hubs:App Event - External Share-Link Click',\n        'cancel-loading'            : 'Hubs:App Cancelling Last Request',\n\n        'build-common'              : 'Hubs:App Building Common Elements',\n        'build-common-end'          : 'Hubs:App Completed Common Elements',\n        'build-page'                : 'Hubs:App Building Page Elements',\n        'build-page-end'            : 'Hubs:App Completed Page Elements',\n        'build-menu'                : 'Hubs:App Building Menu Elements',\n        'build-menu-end'            : 'Hubs:App Completed Menu Elements',\n        'build-sharing'             : 'Hubs:App Building Main Sharing Links',\n        'build-sharing-end'         : 'Hubs:App Completed Main Sharing Links',\n        'build-featured'            : 'Hubs:App Building Featured Tiles',\n        'build-featured-end'        : 'Hubs:App Completed Featured Tiles',\n        'build-collections'         : 'Hubs:App Building Collection Tiles',\n        'build-collections-end'     : 'Hubs:App Completed Collection Tiles',\n        'build-items'               : 'Hubs:App Building Items Tiles',\n        'build-items-end'           : 'Hubs:App Completed Item Tiles',\n        'build-content'             : 'Hubs:App Building Content',\n        'build-content-end'         : 'Hubs:App Completed Content',\n        'build-breadcrumbs'         : 'Hubs:App Building BreadCrumbs',\n        'build-breadcrumbs-end'     : 'Hubs:App Completed BreadCrumbs',\n        'build-related-items'       : 'Hubs:App Building Related Items',\n        'build-related-items-end'   : 'Hubs:App Completed Related Items',\n\n        'history-state-change'      : 'Hubs:App Event - History State Change',\n        'page-change'               : 'Hubs:App Changing Page Content via Ajax',\n        'page-change-by-redirect'   : 'Hubs:App Changing Page by Redirect',\n        'page-open-modal'           : 'Hubs:App Open Popup Modal with Content via Ajax',\n        'page-update-specific'      : 'Hubs:App Updating Page-Type Specific Elements',\n        'internal-page-change-request' : 'Hubs:App Request Internal Page Change',\n\n        'lazy-loader-init'          : 'Hubs:LazyLoader Initializing',\n        'lazy-loader-init-end'      : 'Hubs:LazyLoader Complete & Ready',\n        'lazy-loader-events-init'   : 'Hubs:LazyLoader Initializing Events',\n        'lazy-loader-update'        : 'Hubs:LazyLoader Updating Component',\n        'lazy-loader-resize'        : 'Hubs:LazyLoader Event - Resize',\n        'lazy-loader-scroll'        : 'Hubs:LazyLoader Event - Scroll',\n        'lazy-loader-destroy'       : 'Hubs:LazyLoader Destroying',\n\n        'responsive-resize'         : 'Hubs:Responsive Resizing Image Tiles',\n        'responsive-text'           : 'Hubs:Responsive Resizing Text',\n        'responsive-header'         : 'Hubs:Responsive Initializing Large Header',\n        'responsive-share'          : 'Hubs:Responsive Respositioning Level 3 Share Menu',\n        'responsive-small'          : 'Hubs:Responsive Initializing Small Screen Devices',\n        'responsive-right-sidebar'  : 'Hubs:Responsive Repositioning Right Sidebar',\n        'responsive-resize-header'  : 'Hubs:Responsive Resizing Header Image',\n\n        'search-init'               : 'Hubs:Search Initializing',\n        'search-events-init'        : 'Hubs:Search Initializing Events',\n        'search-init-end'           : 'Hubs:Search Complete & Ready',\n        'search-resize'             : 'Hubs:Search Event - Resize',\n        'search-scroll'             : 'Hubs:Search Event - Scroll',\n        'search-open'               : 'Hubs:Search Opening Search Input',\n        'search-close'              : 'Hubs:Search Closing Search Input/Results',\n        'search-open-dropdown'      : 'Hubs:Search Opening Drop-Down Menu',\n        'search-close-dropdown'     : 'Hubs:Search Closing Drop-Down Menu',\n        'search-hide-dropdown'      : 'Hubs:Search Hiding Drop-Down Menu',\n        'search-open-results'       : 'Hubs:Search Opening Search Results',\n        'search-close-results'      : 'Hubs:Search Closing Search Results',\n        'search-update-results'     : 'Hubs:Search Updating Search Results',\n        'search-update-recent'      : 'Hubs:Search Updating Recent Searches',\n        'search-update-recommended' : 'Hubs:Search Updating Recommended Searches',\n        'search-update-breadcrumbs' : 'Hubs:Search Updating Breadcrumbs',\n        'search-initiate'           : 'Hubs:Search Initiating Search',\n        'search-perform-search'     : 'Hubs:Search Performing Search {{ac}}',\n        'search-toggle-section'     : 'Hubs:Search Toggling Section Display',\n\n        'embedded-init'             : 'Hubs:Embedded Initializing',\n        'embedded-update-scroll-data' : 'Hubs:Embedded Updating Scroll Data',\n        'embedded-scroll'           : 'Hubs:Embedded Event - Scroll',\n        'embedded-scroll-els'       : 'Hubs:Embedded Scrolling Individual Elements',\n\n        'tracking-page'             : 'Hubs:Tracker Page Tracked: {{page}}, GA Code: {{code}}',\n        'tracking-event'            : 'Hubs:Tracker Event Tracked: {{event}}, GA Code {{code}}',\n        'tracking-post'             : 'Hubs:Tracker Post Tracking Records to Server via Ajax',\n\n        // Error Statements\n        'app-invalid-container'     : 'Hubs:App A valid container element must be supplied for Hubs:App',\n\n        'ajax-failed'               : ' \"img/startup/startup.png\";\n\n            link1 = document.createElement('link');\n            link1.setAttribute('rel', 'apple-touch-startup-image');\n            linh;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filtertion f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=function(){function t(e){var n=e.ufaUrl,r=e.accountId,o=e.hubId,i=e.pageType,a=e.streamId,s=e.itemId,l=e.authorId,u=e.pardotCookie,c=e.connectedMAPs,f=e.requireOptIn;!func new TypeError("Cannot call a class as a function")}(this,t),this.ufaUrl=n,this.accountId=r,this.hubId=o,this.pageType=i,this.hubId=o,this.streamId=a,this.itemId=s,this.authorId=l,this.pageType=i,this.isCtaEmbunction(t){return t.toUpperCase()}),this.requireOptIn=f,this.MAP_TO_COOKIE_NAME={ELOQUA:"eloquautk",HUBSPOT:"hubspotutk",MARKETO:"_mkto_trk",PARDOT:u},Object.freeze(this.MAP_TO_COOKIE_NAME)}var e,n,u;return e=t,u=[{key:"ufaRequiresOptIn",value:function(t){return t.disableUfMetrics}}],(n=[{key:"init",value:function(){return r.ufa.load(window,this.ufaUrl,[]),(0,r.ufa)("init",c({accountId:this.accountId,requireOptIn:this.requireOptIn},(0,aue:function(){return(0,r.ufa)("track_reco_panel_impressions"),this}},{key:"trackLazyLoadImpressions",value:function(){return(0,r.ufa)("track_lazy_load_impressions"),this}},{key:"trackLazyLoadScrollDepth",value:function(){return(0,r.ufa)("track_lazy_load_viewport_adjustments"),this}},{key:"trackTimeOnPage",value:function(){return(0,r.ufa)("track_time_on_page",{timerInterval:2}),this}},{key:"trackCtaFormActivation",value:function(){return(0,r.ufa)("activate_form_cta",c({},(0,i.default)(this.ctaId,this.ctaTile))),this}},{key:"trackCtaFormSubmit",value:function(){return(0,r.ufa)("submit_form_cta",c({},(0,i.default)(this.ctaId,this.ctaTile))),this}},{key:"trackCtaLinkClick",value:function(t){return(0,r.ufa)("click_link_cta",c({},(0,s.default)(this.ctaId,this.ctaTile),{ctaUrl:t})),this}},{key:"trackPageView",value:function(){var t=document.referrer;return(0,r.ufa)("view_page",c({authorId:this.authorId,hubId:this.hubId,isEmbedded:this.isCtaEmbed,itemId:this.itemId,pageType:this.pageType,streamId:this.streamId,url:window.location.href},this.isCtaEmbed?{parent:t,referrer:void 0}:{referrer:t})),this}},{key:"trackFlipbookPageView",value:function({flipbookId:t,flipbookPageId:e,pageNumber:n}),this}},{key:"trackFlipbookDook",{flipbookId:t}),this}},{key:"e=this.connectedMAPs.filter(function(e){return t.MAP_TO_COOKIE_NAME[e]}).reduce(function(e,n){return c({},e,d({},"".concat(n.toLowerCase(),"Id"),function(){return o.default.get(t.MAP_TO_COOKIE_NAME[n])}))},{efault.get("pdf_event")}},i={bomboraSegments:function(){var t=window._ml?window._ml.us:null,e=window.localStorage?localStorage.getItem("_ccmaid"):nullturn r.ufa.enqueueTrackables(c({},e,n,i),function(t){return(0,r.ufa)("add_visitor_data",t)}),this}},{key:"optIn",value:function(){return new Promise(function(t){(0,r.ufa)("opt_in",null,t)})}},{key:"optOut",value:function(){return new Promise(function(t){(0,r.ufa)("opt_out",null,t)})}}])&&f(e.prototype,n),u&&f(e,u),t}();d(h,"enqueueTrackables",r.ufa.enqueueTrackables);var p=h;e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,o=n(285),i=(r=n(48))&&r.__esModule?r:{default:r};var a=function(t,e){var n=(0,i.default)(e),r=n.parent().hasClass("block-cta");return{ctaId:t,display:(0,o.getDisplayProperty)(n),isBlocking:r,isCapturedInSiteEngager:(0,o.isCapturedInSiteEngager)(n),isEmbedded:(0,i.default)("body").hasClass("cta-embed"),isForm:n.hasClass("cta-form"),isSide:n.parents("#item-content").hasClass("with-cta")&&!r,ordinal:Array.from(n[0].parentElement.children).indexOf(n[0])}};e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,o=n(285),i=(r=n(48))&&r.__esModule?r:{default:r};var a={name:"itemTile",selectors:[".tile:not(.cta):not(#loading-notifier)"],transformerCallback:function(t){return{display:(0,o.getDisplayProperty)(t),id:t.dataset.id,isCapturedInSiteEngager:(0,o.isCapturedInSiteEngager)(t),isHighlighted:(0,i.default)(t).hasClass("highlight"),ordinal:Array.from(t.parentElement.children).indexOf(t)}}},s={name:"itemTile",selectors:[".item-next-prev a.hooked"],transformerCallback:function(t){return{display:"nextPreviousCarousel",id:t.dataset.itemId,isCapturedInSiteEngager:(0,o.isCapturedInSiteEngager)(t),isHighlighted:(0,i.default)(t).hasClass("highlight"),ordinal:Array.from(t.parentElement.children).indexOf(t)}}},l={name:"ctaTile",selectors:[".tile.cta"],transformerCallback:function(t){var e=(0,i.default)(t),n=e.parent().hasClass("block-cta");return{display:(0,o.getDisplayProperty)(t),id:t.dataset.ctaId,isBlocking:n,isCapturedInSiteEngager:(0,o.isCapturedInSiteEngager)(t),isEmbedded:(0,i.default)("body").hasClass("cta-embed"),isForm:e.hasClass("cta-form"),isHighlighted:(0,i.default)(t).hasClass("highlight"),isSide:e.parents("#item-content").hasClass("with-cta")&&!n,ordinal:Array.from(t.parentElement.children).indexOf(t)}}},u=function(){return{impressionTracking:{rules:[a,l,s]}}};e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,o=n(285),i=(r=n(48))&&r.__esModule?r:{default:r};var a=function(t,e){var n=(0,i.default)(e);return{ctaId:t,display:(0,o.getDisplayProperty)(n),isCapturedInSiteEngager:(0,o.isCapturedInSiteEngager)(n),isSide:n.parents("#item-content").hasClass("with-cta"),ordinal:Array.from(n[0].parentElement.children).indexOf(n[0])}};e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function()rguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}returonfigurable=!0,"value"in r&&(r.writable=!0),bject.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,a,s,l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"cleanId",value:function(t){return parseInt(t,10)}},{key:"areGlobalsReady",value:function(){return Boolean(Hubs&&Hubs.Config&&Hubs.Config.privacyGroups&&Hubs.appInstance)}},{key:"getAll",value:function(){return this.areGlobalsReady()?r({},Hubs.Config.privacyGroups):{}}},{key:"getById",value:function(t){var e=this.cleanId(t);return this.getAll()[e]||null}},{key:"getByFunctionalityCode",value:function(t){if(!t)return null;var e=this.getAll();for(var n in e){var r=e[n],o=r.functionalities;for(var i in o){var a=o[i];if(t.toLowerCase()===a.code.toLowerCase())return r}}return null}},{key:"isFunctionalityEnabled",value:function(t){var e=thioolean(e.isAccepted)}},{key:"acceptAll",value:function(){var t=this;Object.keys(this.getAll()).forEach(function(e){return t.u",value:function(){var t=this;Object.keys(this.getAll()).forEach(function(e){return t.updateById(e,!1)}),this.saveChanges()}},{key:"acceptById",value:function(t){this.updateById(t,!0),this.saveChanges()}},{key:"rejectById",value:function(t){this.updateById(t,!1),this.saveChanges()}},{key:"updateById",value:function(t,e){var n=this;if(this.areGlobalsReady()){var r=this.cleanId(t),o=Hubs.Config.privaconalities||[]).forEach(function(t){if(t.code===n.FUNCTIONALITY_CODE_UFA){var stance[r]()}}))}}}},{key:"saveChanges",value:function(){var t=this.getAll(),e=Object.keys(t).map(function(e){return{id:e,version:t[e].version,accepted:t[e].isAccepted}});Hubs.appInstance.savePrivacyGroupPreferences(e)}},{key:"applyChanges",value:function(){window.location.reload()}}],(n=null)&&o(e.prototype,n),i&&o(e,i),t}();s="UBERFLIP",(a="FUNCTIONALITY_CODE_UFA")in(i=l)?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s;var u=l;e.default=u},function(t,e,n){"use strict";window.Hubs.PrivacyHelpers={ufaOptIn:function(){i){var t=Hubs.appInstance.ufaCalut:function(){if(!Hubs.Config.isPreventAnalyticsCollectionEnabled){var t=Hubs.appInstance.ufaCaller; failed",t)})}},savePrivacyGroupPreferences:function(t){var e=this.formatPrivacyCookieValue(t);this.setPrivacyCookieValue(e)},formatPrivacyCookieValue:function(t,e){return["1",void 0!==e?e:this.getPrivacyBannerState(),$.map(t,function(t){return[t.id,t.version,t.accepted].join(",")}).join("|")].join("|")},getPrivacyBannerState:function(){var t=$.cookie(Hubs.PRIVACY_PREFS_COOKIE_NAME);return t?parseInt(t.split("|")[1],10):Hubs.SHOW_NO_BANNER},setPrivacyCookt,{expir{var n="Moderr){var o=[],i={_version:"3.6.0",_config:{classPss:!0,usePrefixes:!0},_q:[],on:function(t,e){var n=this;setTimoLowerCase()).split("."),o=a[r[0]];if(2==r.length&&(o=o[r[oolean||(a[r["undefined"_l={},i.on]||(this._l[t]=[]),this._l[t].push(e),a.hasOwnProperty(t)&&setTimeout(function(){a._trixes=m;var g=function(t){var n,o=O.length,i=e.CSSRule;if(void 0===i)return r;if(!t)return!1};i.atRule=g;var=v;var y=function(){var t=!("onblur"in n.documentElement);return function(e,n){var o;return!!e&&(n&&"string"!=typeof n||(n=b(n||"div")),!(o=(e="on"+e)in n)&&t&&(n.setAttribute||(n=b("div")),n.setAttribute(e,""),o="function"==typeof n[e],n[e]!==r&&(n[e]=r),n.re(){try{var t=n.createElement("a");t.innerHTML="<xyz></xyz>",r="hidden"in t,o=1==t.childNodes.length||function(){n.createElement("a");var t=n.createDocumentFragment();return void 0===t.cloneNode||void 0===t.createDocumentFragment||void 0===t.createElement}()}catch(t){r=!0,o=!0}}();var g={elements:i.elements||"abbr article aside audio bdi canvas data datalist details dialog firtsUnknownEl|(t=n),o)return t.createDocumentFragment();for(var r=(e=e||h(t)).frag.cloneNode(),i=0,a=d(),s=a.length;i<s;i++)r.createElement(a[i]);return r},addElements:function(t,e){var n=g.elements;"string"!=typeof n&&(n=n=[];r--;)e=n[r],o.test(e.nodeName)&&i.push(e.applyElement(S(e)));return i}(t),e=f(t,l)}),i.attachEventsText=t:i.appendChild(n.createTextNode(t)),c.id=u,h.fake&&(h.style.background="",h.style.overflow="hidden",l=f.style.overflow,f.stHeight)Modernizr/issues/1182 for more informatioedia)?function(t){var e=T(t);return e&&e.matn=!1;return C("@media "+t+" t.charAt(0).toUpperCase()+t.slice(1),a=(t+" "+m.join(i+" ")+i).split( e)return!1===n?t[o]:l(r=e[t[o]],"function")?D(r,n||e):r;return!1}(a=(t+" "+v.join(i+" ")+i).split(efixed=function(t,e,n){return 0===t.indt=A(t)),e?P(t,e,n):P(t,"pfx"))},O=i._config.usePrefixes?" -webkit- -moz- -o- -ms- ".spli),e.opus=t.canPlayTy.replace(/^no$/,""),e.wav=t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),e.m4a=(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(t){}return e}),a.addTest("canvas",function(){var t=b("canvas");return!(!t.getContext||!t.getContext("2d"))}),a.addTest("cssanimations",L("animationName","a",!0)),a.addTest("backgroundsize",L("backgroundSize","100%",!0)),a.addTest("borderimage",L("borderImage","url() 1",!0)),a.addTest("borderradius",L("borderRadius","0px",!0)),a.addTest("boxshadow",L("boxShadow","1px 1px",!0)),a.addTest("flexbox",L("flexBasis","1px",!0)),a.tface",!1):B('@font-face {font-family:"font";src:url("https://")}',function(t,e){var r=n.sRules&&o.cssRules[0]?o.csr=0,o=O.length-1;rght bottom,from(#9f9),to(eturn t.cssText="back.addTest("multiplebgs",function(){var t=b("a").style;return t.cssText="ba t=b("a").style;return t.cssText=O.join("opacity:.55;"),/^0.55$/.test(t.opacity)}),a.addTest("cssreflections",L("boxReflect","above",!0)),a.addTest("rgba",functundColor).indexOf("rgba")>-1}rtsCSS"in e;a.addTest("supports",z||U),a.addTest("textshadow",F("textShadow","1px 1px")),a.addTest("csstransforms",function(){re),a.addTest("csstransa.addTest("history",function(){var t=navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexdTest("localstorage",function(){var t="modernizr";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}),a.addTest("sessionstorage",function(){var t="modernizr";try{return sessionStorage.setItem(t,t),sessionStorage.removeItem(t),!0}catch(t){return!1}}),a.addTest("websqldatabase","openDatabase"in e),a.addTest("svg",unction(){return!!n.creFEColorMatrixElemer t=b("div");return"avc1.42E01E"').repn/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,""))}catch(t){}return e}),a.addTest("webgl",function(){var t=b("canvas"),n="proions.aliases.length;n++)t.push(e.options.aliases[n].toLowerCase());for(r=l(e.fn,"function")?e.fn():e.fn,i=0;i<t.length;i++)1===(u=t[i].split(".")).length?a[u[0]]=r:(!a[u[0]]||a[u[0]]instanceof Boolean||(a[u[0]]=new Boolean(a[u[0]])),a[u[0]][u[1]]=r),s.push((r?"":"no-")+u.join("-"))}}(),h(s),delete i.addTest,delete i.addAsyncTest;for(var Q=0;Q<a._q.length;Q++)a._q[Q]();e.Modernizr=a}(e,document),t.exports=e.Modernizr,n?e.Modernizr=r:delete e.Modernizr}(window)},function(t,e,n){n(10)(n(312))},function(t,e){t.exports='// vim:ts=4:sts=4:sw=4:\n/*!\n *\n * Copyright 2009-2012 Kris Kowal under the terms of the MIT\n * license found at http://github.com/kriskowal/q/raw/master/LICENSE\n *\n * With parts by Tyler Close\n * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found\n * at http://www.opensource.org/licenses/mit-license.html\n * Forked at ref_send.js version: 2009-05-11\n *\n * With parts by Mark Miller\n * Copyright (C) 2011 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n(function (definition) {\n    // Turn off strict mode for this function so we can assign to global.Q\n    /* jshint strict: false */\n\n    // This file will function properly as a <script> tag, or a module\n    // using CommonJS and NodeJS or RequireJS module formats.  In\n    // Common/Node/RequireJS, the module exports the Q API and when\n    // executed as a simple <script>, it creates a Q global instead.\n\n    // Montage Require\n    if (typeof bootstrap === "function") {\n        bootstrap("promise", definition);\n\n    // CommonJS\n    } else if (typeof exports === "object") {\n        module.exports = definition();\n\n    // RequireJS\n    } else if (typeof define === "function" && define.amd) {\n        define(definition);\n\n    // SES (Secure EcmaScript)\n    } else if (typeof ses !== "undefined") {\n        if (!ses.ok()) {\n            return;\n        } else {\n            ses.makeQ = definition;\n        }\n\n    // <script>\n    } else {\n        Q = definition();\n    }\n\n})(function () {\n"use strict";\n\nvar hasStacks = false;\ntry {\n    throw new Error();\n} catch (e) {\n    hasStacks = !!e.stack;\n}\n\n// All code after this point will be filtered from stack traces reported\n// by Q.\nvar qStartingLine = captureLine();\nvar qFileName;\n\n// shims\n\n// used for fallback in "allResolved"\nvar noop = function () {};\n\n// Use the fastest possible means to execute a task in a future turn\n// of the event loop.\nvar nextTick =(function () {\n    // linked list of tasks (single, with head node)\n    var head = {task: void 0, next: null};\n    var tail = head;\n    var flushing = false;\n    var requestTick = void 0;\n    var isNodeJS = false;\n\n    function flush() {\n        /* jshint loopfunc: true */\n\n        while (head.next) {\n            head = head.next;\n            var task = head.task;\n            head.task = void 0;\n            var domain = head.domain;\n\n            if (domain) {\n                head.domain = void 0;\n                domain.enter();\n            }\n\n            try {\n                task();\n\n            } catch (e) {\n                if (isNodeJS) {\n                    // In node, uncaught exceptions are considered fatal errors.\n                    // Re-throw them synchronously to interrupt flushing!\n\n                    // Ensure continuation if the uncaught exception is suppressed\n                    // listening "uncaughtException" events (as domains does).\n                    // Continue in next event to avoid tick recursion.\n                    if (domain) {\n                        domain.exit();\n                    }\n                    setTimeout(flush, 0);\n                    if (domain) {\n                        domain.enter();\n                    }\n\n                    throw e;\n\n                } else {\n                    // In browsers, uncaught exceptions are not fatal.\n                    // Re-throw them asynchronously to avoid slow-downs.\n                    setTimeout(function() {\n                       throw e;\n                    }, 0);\n                }\n            }\n\n            if (domain) {\n                domain.exit();\n            }\n        }\n\n        flushing = false;\n    }\n\n    nextTick = function (task) {\n        tail = tail.next = {\n            task: task,\n            domain: isNodeJS && process.domain,\n            next: null\n        };\n\n        if (!flushing) {\n            flushing = true;\n            requestTick();\n        }\n    };\n\n    if (typeof process !== "undefined" && process.nextTick) {\n        // Node.js before 0.9. Note that some fake-Node environments, like the\n        // Mocha test runner, introduce a `process` global without a `nextTick`.\n        isNodeJS = true;\n\n        requestTick = function () {\n            process.nextTick(flush);\n        };\n\n    } else if (typeof setImmediate === "function") {\n        // In IE10, Node.js 0.9+, or https://github.com/NobleJS/setImmediate\n        if (typeof window !== "undefined") {\n            requestTick = setImmediate.bind(window, flush);\n        } else {\n            requestTick = function () {\n                setImmediate(flush);\n            };\n        }\n\n    } else if (typeof MessageChannel !== "undefined") {\n        // modern browsers\n        // http://www.nonblocking.io/2011/06/windownexttick.html\n        var channel = new MessageChannel();\n        // At least Safari Version 6.0.5 (8536.30.1) intermittently cannot create\n        // working message ports the first time a page loads.\n        channel.port1.onmessage = function () {\n            requestTick = requestPortTick;\n            channel.port1.onmessage = flush;\n            flush();\n        };\n        var requestPortTick = function () {\n            // Opera requires us to provide a message payload, regardless of\n            // whether we use it.\n            channel.port2.postMessage(0);\n        };\n        requestTick = function () {\n            setTimeout(flush, 0);\n            requestPortTick();\n        };\n\n    } else {\n        // old browsers\n        requestTick = function () {\n            setTimeout(flush, 0);\n        };\n    }\n\n    return nextTick;\n})();\n\n// Attempt to make generics safe in the face of downstream\n// modifications.\n// There is no situation where this is necessary.\n// If you need a security guarantee, these primordials need to be\n// deeply frozen anyway, and if you don’t need a security guarantee,\n// this is just plain paranoid.\n// However, this **might** have the nice side-effect of reducing the size of\n// the minified code by reducing x.call() to merely x()\n// See Mark Miller’s explanation of what this does.\n// http://wiki.ecmascript.org/doku.php?id=conventions:safe_meta_programming\nvar call = Function.call;\nfunction uncurryThis(f) {\n    return function () {\n        return call.apply(f, arguments);\n    };\n}\n// This is equivalent, but slower:\n// uncurryThis = Function_bind.bind(Function_bind.call);\n// http://jsperf.com/uncurrythis\n\nvar array_slice = uncurryThis(Array.prototype.slice);\n\nvar array_reduce = uncurryThis(\n    Array.prototype.reduce || function (callback, basis) {\n        var index = 0,\n            length = this.length;\n        // concerning the initial value, if one is not provided\n        if (arguments.length === 1) {\n            // seek to the first value in the array, accounting\n            // for the possibility that is is a sparse array\n            do {\n                if (index in this) {\n                    basis = this[index++];\n                    break;\n                }\n                if (++index >= length) {\n                    throw new TypeError();\n                }\n            } while (1);\n        }\n        // reduce\n        for (; index < length; index++) {\n            // account for the possibility that the array is sparse\n            if (index in this) {\n                basis = callback(basis, this[index], index);\n            }\n        }\n        return basis;\n    }\n);\n\nvar array_indexOf = uncurryThis(\n    Array.prototype.indexOf || function (value) {\n        // not a very good shim, but good enough for our one use of it\n        for (var i = 0; i < this.length; i++) {\n            if (this[i] === value) {\n                return i;\n            }\n        }\n        return -1;\n    }\n);\n\nvar array_map = uncurryThis(\n    Array.prototype.map || function (callback, thisp) {\n        var self = this;\n        var collect = [];\n        array_reduce(self, function (undefined, value, index) {\n            collect.push(callback.call(thisp, value, index, self));\n        }, void 0);\n        return collect;\n    }\n);\n\nvar object_create = Object.create || function (prototype) {\n    function Type() { }\n    Type.prototype = prototype;\n    return new Type();\n};\n\nvar object_hasOwnProperty = uncurryThis(Object.prototype.hasOwnProperty);\n\nvar object_keys = Object.keys || function (object) {\n    var keys = [];\n    for (var key in object) {\n        if (object_hasOwnProperty(object, key)) {\n            keys.push(key);\n        }\n    }\n    return keys;\n};\n\nvar object_toString = uncurryThis(Object.prototype.toString);\n\nfunction isObject(value) {\n    return value === Object(value);\n}\n\n// generator related shims\n\n// FIXME: Remove this function once ES6 generators are in SpiderMonkey.\nfunction isStopIteration(exception) {\n    return (\n        object_toString(exception) === "[object StopIteration]" ||\n        exception instanceof QReturnValue\n    );\n}\n\n// FIXME: Remove this helper and Q.return once ES6 generators are in\n// SpiderMonkey.\nvar QReturnValue;\nif (typeof ReturnValue !== "undefined") {\n    QReturnValue = ReturnValue;\n} else {\n    QReturnValue = function (value) {\n        this.value = value;\n    };\n}\n\n// long stack traces\n\nvar STACK_JUMP_SEPARATOR = "From previous event:";\n\nfunction makeStackTraceLong(error, promise) {\n    // If possible, transform the error stack trace by removing Node and Q\n    // cruft, then concatenating with the stack trace of `promise`. See #57.\n    if (hasStacks &&\n        promise.stack &&\n        typeof error === "object" &&\n        error !== null &&\n        error.stack &&\n        error.stack.indexOf(STACK_JUMP_SEPARATOR) === -1\n    ) {\n        var stacks = [];\n        for (var p = promise; !!p; p = p.source) {\n            if (p.stack) {\n                stacks.unshift(p.stack);\n            }\n        }\n        stacks.unshift(error.stack);\n\n        var concatedStacks = stacks.join("\\n" + STACK_JUMP_SEPARATOR + "\\n");\n        error.stack = filterStackString(concatedStacks);\n    }\n}\n\nfunction filterStackString(stackString) {\n    var lines = stackString.split("\\n");\n    var desiredLines = [];\n    for (var i = 0; i < lines.length; ++i) {\n        var line = lines[i];\n\n        if (!isInternalFrame(line) && !isNodeFrame(line) && line) {\n            desiredLines.push(line);\n        }\n    }\n    return desiredLines.join("\\n");\n}\n\nfunction isNodeFrame(stackLine) {\n    return stackLine.indexOf("(module.js:") !== -1 ||\n           stackLine.indexOf("(node.js:") !== -1;\n}\n\nfunction getFileNameAndLineNumber(stackLine) {\n    // Named functions: "at functionName (filename:lineNumber:columnNumber)"\n    // In IE10 function name can have spaces ("Anonymous function") O_o\n    var attempt1 = /at .+ \\((.+):(\\d+):(?:\\d+)\\)$/.exec(stackLine);\n    if (attempt1) {\n        return [attempt1[1], Number(attempt1[2])];\n    }\n\n    // Anonymous functions: "at filename:lineNumber:columnNumber"\n    var attempt2 = /at ([^ ]+):(\\d+):(?:\\d+)$/.exec(stackLine);\n    if (attempt2) {\n        return [attempt2[1], Number(attempt2[2])];\n    }\n\n    // Firefox style: "function@filename:lineNumber or @filename:lineNumber"\n    var attempt3 = /.*@(.+):(\\d+)$/.exec(stackLine);\n    if (attempt3) {\n        return [attempt3[1], Number(attempt3[2])];\n    }\n}\n\nfunction isInternalFrame(stackLine) {\n    var fileNameAndLineNumber = getFileNameAndLineNumber(stackLine);\n\n    if (!fileNameAndLineNumber) {\n        return false;\n    }\n\n    var fileName = fileNameAndLineNumber[0];\n    var lineNumber = fileNameAndLineNumber[1];\n\n    return fileName === qFileName &&\n        lineNumber >= qStartingLine &&\n        lineNumber <= qEndingLine;\n}\n\n// discover own file name and line number range for filtering stack\n// traces\nfunction captureLine() {\n    if (!hasStacks) {\n        return;\n    }\n\n    try {\n        throw new Error();\n    } catch (e) {\n        var lines = e.stack.split("\\n");\n        var firstLine = lines[0].indexOf("@") > 0 ? lines[1] : lines[2];\n        var fileNameAndLineNumber = getFileNameAndLineNumber(firstLine);\n        if (!fileNameAndLineNumber) {\n            return;\n        }\n\n        qFileName = fileNameAndLineNumber[0];\n        return fileNameAndLineNumber[1];\n    }\n}\n\nfunction deprecate(callback, name, alternative) {\n    return function () {\n        if (typeof console !== "undefined" &&\n            typeof console.warn === "function") {\n            console.warn(name + " is deprecated, use " + alternative +\n                         " instead.", new Error("").stack);\n        }\n        return callback.apply(callback, arguments);\n    };\n}\n\n// end of shims\n// beginning of real work\n\n/**\n * Constructs a promise for an immediate reference, passes promises through, or\n * coerces promises from different systems.\n * @param value immediate reference or promise\n */\nfunction Q(value) {\n    // If the object is already a Promise, return it directly.  This enables\n    // the resolve function to both be used to created references from objects,\n    // but to tolerably coerce non-promises to promises.\n    if (isPromise(value)) {\n        return value;\n    }\n\n    // assimilate thenables\n    if (isPromiseAlike(value)) {\n        return coerce(value);\n    } else {\n        return fulfill(value);\n    }\n}\nQ.resolve = Q;\n\n/**\n * Performs a task in a future turn of the event loop.\n * @param {Function} task\n */\nQ.nextTick = nextTick;\n\n/**\n * Controls whether or not long stack traces will be on\n */\nQ.longStackSupport = false;\n\n/**\n * Constructs a {promise, resolve, reject} object.\n *\n * `resolve` is a callback to invoke with a more resolved value for the\n * promise. To fulfill the promise, invoke `resolve` with any value that is\n * not a thenable. To reject the promise, invoke `resolve` with a rejected\n * thenable, or invoke `reject` with the reason directly. To resolve the\n * promise to another thenable, thus putting it in the same state, invoke\n * `resolve` with that other thenable.\n */\nQ.defer = defer;\nfunction defer() {\n    // if "messages" is an "Array", that indicates that the promise has not yet\n    // been resolved.  If it is "undefined", it has been resolved.  Each\n    // element of the messages array is itself an array of complete arguments to\n    // forward to the resolved promise.  We coerce the resolution value to a\n    // promise using the `resolve` function because it handles both fully\n    // non-thenable values and other thenables gracefully.\n    var messages = [], progressListeners = [], resolvedPromise;\n\n    var deferred = object_create(defer.prototype);\n    var promise = object_create(Promise.prototype);\n\n    promise.promiseDispatch = function (resolve, op, operands) {\n        var args = array_slice(arguments);\n        if (messages) {\n            messages.push(args);\n            if (op === "when" && operands[1]) { // progress operand\n                progressListeners.push(operands[1]);\n            }\n        } else {\n            nextTick(function () {\n                resolvedPromise.promiseDispatch.apply(resolvedPromise, args);\n            });\n        }\n    };\n\n    // XXX deprecated\n    promise.valueOf = function () {\n        if (messages) {\n            return promise;\n        }\n        var nearerValue = nearer(resolvedPromise);\n        if (isPromise(nearerValue)) {\n            resolvedPromise = nearerValue; // shorten chain\n        }\n        return nearerValue;\n    };\n\n    promise.inspect = function () {\n        if (!resolvedPromise) {\n            return { state: "pending" };\n        }\n        return resolvedPromise.inspect();\n    };\n\n    if (Q.longStackSupport && hasStacks) {\n        try {\n            throw new Error();\n        } catch (e) {\n            // NOTE: don\'t try to use `Error.captureStackTrace` or transfer the\n            // accessor around; that causes memory leaks as per GH-111. Just\n            // reify the stack trace as a string ASAP.\n            //\n            // At the same time, cut off the first line; it\'s always just\n            // "[object Promise]\\n", as per the `toString`.\n            promise.stack = e.stack.substring(e.stack.indexOf("\\n") + 1);\n        }\n    }\n\n    // NOTE: we do the checks for `resolvedPromise` in each method, instead of\n    // consolidating them into `become`, since otherwise we\'d create new\n    // promises with the lines `become(whatever(value))`. See e.g. GH-252.\n\n    function become(newPromise) {\n        resolvedPromise = newPromise;\n        promise.source = newPromise;\n\n        array_reduce(messages, function (undefined, message) {\n            nextTick(function () {\n                newPromise.promiseDispatch.apply(newPromise, message);\n            });\n        }, void 0);\n\n        messages = void 0;\n        progressListeners = void 0;\n    }\n\n    deferred.promise = promise;\n    deferred.resolve = function (value) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(Q(value));\n    };\n\n    deferred.fulfill = function (value) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(fulfill(value));\n    };\n    deferred.reject = function (reason) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(reject(reason));\n    };\n    deferred.notify = function (progress) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        array_reduce(progressListeners, function (undefined, progressListener) {\n            nextTick(function () {\n                progressListener(progress);\n            });\n        }, void 0);\n    };\n\n    return deferred;\n}\n\n/**\n * Creates a Node-style callback that will resolve or reject the deferred\n * promise.\n * @returns a nodeback\n */\ndefer.prototype.makeNodeResolver = function () {\n    var self = this;\n    return function (error, value) {\n        if (error) {\n            self.reject(error);\n        } else if (arguments.length > 2) {\n            self.resolve(array_slice(arguments, 1));\n        } else {\n            self.resolve(value);\n        }\n    };\n};\n\n/**\n * @param resolver {Function} a function that returns nothing and accepts\n * the resolve, reject, and notify functions for a deferred.\n * @returns a promise that may be resolved with the given resolve and reject\n * functions, or rejected by a thrown exception in resolver\n */\nQ.Promise = promise; // ES6\nQ.promise = promise;\nfunction promise(resolver) {\n    if (typeof resolver !== "function") {\n        throw new TypeError("resolver must be a function.");\n    }\n    var deferred = defer();\n    try {\n        resolver(deferred.resolve, deferred.reject, deferred.notify);\n    } catch (reason) {\n        deferred.reject(reason);\n    }\n    return deferred.promise;\n}\n\npromise.race = race; // ES6\npromise.all = all; // ES6\npromise.reject = reject; // ES6\npromise.resolve = Q; // ES6\n\n// XXX experimental.  This method is a way to denote that a local value is\n// serializable and should be immediately dispatched to a remote upon request,\n// instead of passing a reference.\nQ.passByCopy = function (object) {\n    //freeze(object);\n    //passByCopies.set(object, true);\n    return object;\n};\n\nPromise.prototype.passByCopy = function () {\n    //freeze(object);\n    //passByCopies.set(object, true);\n    return this;\n};\n\n/**\n * If two promises eventually fulfill to the same value, promises that value,\n * but otherwise rejects.\n * @param x {Any*}\n * @param y {Any*}\n * @returns {Any*} a promise for x and y if they are the same, but a rejection\n * otherwise.\n *\n */\nQ.join = function (x, y) {\n    return Q(x).join(y);\n};\n\nPromise.prototype.join = function (that) {\n    return Q([this, that]).spread(function (x, y) {\n        if (x === y) {\n            // TODO: "===" should be Object.is or equiv\n            return x;\n        } else {\n            throw new Error("Can\'t join: not the same: " + x + " " + y);\n        }\n    });\n};\n\n/**\n * Returns a promise for the first of an array of promises to become fulfilled.\n * @param answers {Array[Any*]} promises to race\n * @returns {Any*} the first promise to be fulfilled\n */\nQ.race = race;\nfunction race(answerPs) {\n    return promise(function(resolve, reject) {\n        // Switch to this once we can assume at least ES5\n        // answerPs.forEach(function(answerP) {\n        //     Q(answerP).then(resolve, reject);\n        // });\n        // Use this in the meantime\n        for (var i = 0, len = answerPs.length; i < len; i++) {\n            Q(answerPs[i]).then(resolve, reject);\n        }\n    });\n}\n\nPromise.prototype.race = function () {\n    return this.then(Q.race);\n};\n\n/**\n * Constructs a Promise with a promise descriptor object and optional fallback\n * function.  The descriptor contains methods like when(rejected), get(name),\n * set(name, value), post(name, args), and delete(name), which all\n * return either a value, a promise for a value, or a rejection.  The fallback\n * accepts the operation name, a resolver, and any further arguments that would\n * have been forwarded to the appropriate method above had a method been\n * provided with the proper name.  The API makes no guarantees about the nature\n * of the returned object, apart from that it is usable whereever promises are\n * bought and sold.\n */\nQ.makePromise = Promise;\nfunction Promise(descriptor, fallback, inspect) {\n    if (fallback === void 0) {\n        fallback = function (op) {\n            return reject(new Error(\n                "Promise does not support operation: " + op\n            ));\n        };\n    }\n    if (inspect === void 0) {\n        inspect = function () {\n            return {state: "unknown"};\n        };\n    }\n\n    var promise = object_create(Promise.prototype);\n\n    promise.promiseDispatch = function (resolve, op, args) {\n        var result;\n        try {\n            if (descriptor[op]) {\n                result = descriptor[op].apply(promise, args);\n            } else {\n                result = fallback.call(promise, op, args);\n            }\n        } catch (exception) {\n            result = reject(exception);\n        }\n        if (resolve) {\n            resolve(result);\n        }\n    };\n\n    promise.inspect = inspect;\n\n    // XXX deprecated `valueOf` and `exception` support\n    if (inspect) {\n        var inspected = inspect();\n        if (inspected.state === "rejected") {\n            promise.exception = inspected.reason;\n        }\n\n        promise.valueOf = function () {\n            var inspected = inspect();\n            if (inspected.state === "pending" ||\n                inspected.state === "rejected") {\n                return promise;\n            }\n            return inspected.value;\n        };\n    }\n\n    return promise;\n}\n\nPromise.prototype.toString = function () {\n    return "[object Promise]";\n};\n\nPromise.prototype.then = function (fulfilled, rejected, progressed) {\n    var self = this;\n    var deferred = defer();\n    var done = false;   // ensure the untrusted promise makes at most a\n                        // single call to one of the callbacks\n\n    function _fulfilled(value) {\n        try {\n            return typeof fulfilled === "function" ? fulfilled(value) : value;\n        } catch (exception) {\n            return reject(exception);\n        }\n    }\n\n    function _rejected(exception) {\n        if (typeof rejected === "function") {\n            makeStackTraceLong(exception, self);\n            try {\n                return rejected(exception);\n            } catch (newException) {\n                return reject(newException);\n            }\n        }\n        return reject(exception);\n    }\n\n    function _progressed(value) {\n        return typeof progressed === "function" ? progressed(value) : value;\n    }\n\n    nextTick(function () {\n        self.promiseDispatch(function (value) {\n            if (done) {\n                return;\n            }\n            done = true;\n\n            deferred.resolve(_fulfilled(value));\n        }, "when", [function (exception) {\n            if (done) {\n                return;\n            }\n            done = true;\n\n            deferred.resolve(_rejected(exception));\n        }]);\n    });\n\n    // Progress propagator need to be attached in the current tick.\n    self.promiseDispatch(void 0, "when", [void 0, function (value) {\n        var newValue;\n        var threw = false;\n        try {\n            newValue = _progressed(value);\n        } catch (e) {\n            threw = true;\n            if (Q.onerror) {\n                Q.onerror(e);\n            } else {\n                throw e;\n            }\n        }\n\n        if (!threw) {\n            deferred.notify(newValue);\n        }\n    }]);\n\n    return deferred.promise;\n};\n\n/**\n * Registers an observer on a promise.\n *\n * Guarantees:\n *\n * 1. that fulfilled and rejected will be called only once.\n * 2. that either the fulfilled callback or the rejected callback will be\n *    called, but not both.\n * 3. that fulfilled and rejected will not be called in this turn.\n *\n * @param value      promise or immediate reference to observe\n * @param fulfilled  function to be called with the fulfilled value\n * @param rejected   function to be called with the rejection exception\n * @param progressed function to be called on any progress notifications\n * @return promise for the return value from the invoked callback\n */\nQ.when = when;\nfunction when(value, fulfilled, rejected, progressed) {\n    return Q(value).then(fulfilled, rejected, progressed);\n}\n\nPromise.prototype.thenResolve = function (value) {\n    return this.then(function () { return value; });\n};\n\nQ.thenResolve = function (promise, value) {\n    return Q(promise).thenResolve(value);\n};\n\nPromise.prototype.thenReject = function (reason) {\n    return this.then(function () { throw reason; });\n};\n\nQ.thenReject = function (promise, reason) {\n    return Q(promise).thenReject(reason);\n};\n\n/**\n * If an object is not a promise, it is as "near" as possible.\n * If a promise is rejected, it is as "near" as possible too.\n * If it’s a fulfilled promise, the fulfillment value is nearer.\n * If it’s a deferred promise and the deferred has been resolved, the\n * resolution is "nearer".\n * @param object\n * @returns most resolved (nearest) form of the object\n */\n\n// XXX should we re-do this?\nQ.nearer = nearer;\nfunction nearer(value) {\n    if (isPromise(value)) {\n        var inspected = value.inspect();\n        if (inspected.state === "fulfilled") {\n            return inspected.value;\n        }\n    }\n    return value;\n}\n\n/**\n * @returns whether the given object is a promise.\n * Otherwise it is a fulfilled value.\n */\nQ.isPromise = isPromise;\nfunction isPromise(object) {\n    return isObject(object) &&\n        typeof object.promiseDispatch === "function" &&\n        typeof object.inspect === "function";\n}\n\nQ.isPromiseAlike = isPromiseAlike;\nfunction isPromiseAlike(object) {\n    return isObject(object) && typeof object.then === "function";\n}\n\n/**\n * @returns whether the given object is a pending promise, meaning not\n * fulfilled or rejected.\n */\nQ.isPending = isPending;\nfunction isPending(object) {\n    return isPromise(object) && object.inspect().state === "pending";\n}\n\nPromise.prototype.isPending = function () {\n    return this.inspect().state === "pending";\n};\n\n/**\n * @returns whether the given object is a value or fulfilled\n * promise.\n */\nQ.isFulfilled = isFulfilled;\nfunction isFulfilled(object) {\n    return !isPromise(object) || object.inspect().state === "fulfilled";\n}\n\nPromise.prototype.isFulfilled = function () {\n    return this.inspect().state === "fulfilled";\n};\n\n/**\n * @returns whether the given object is a rejected promise.\n */\nQ.isRejected = isRejected;\nfunction isRejected(object) {\n    return isPromise(object) && object.inspect().state === "rejected";\n}\n\nPromise.prototype.isRejected = function () {\n    return this.inspect().state === "rejected";\n};\n\n//// BEGIN UNHANDLED REJECTION TRACKING\n\n// This promise library consumes exceptions thrown in handlers so they can be\n// handled by a subsequent promise.  The exceptions get added to this array when\n// they are created, and removed when they are handled.  Note that in ES6 or\n// shimmed environments, this would naturally be a `Set`.\nvar unhandledReasons = [];\nvar unhandledRejections = [];\nvar trackUnhandledRejections = true;\n\nfunction resetUnhandledRejections() {\n    unhandledReasons.length = 0;\n    unhandledRejections.length = 0;\n\n    if (!trackUnhandledRejections) {\n        trackUnhandledRejections = true;\n    }\n}\n\nfunction trackRejection(promise, reason) {\n    if (!trackUnhandledRejections) {\n        return;\n    }\n\n    unhandledRejections.push(promise);\n    if (reason && typeof reason.stack !== "undefined") {\n        unhandledReasons.push(reason.stack);\n    } else {\n        unhandledReasons.push("(no stack) " + reason);\n    }\n}\n\nfunction untrackRejection(promise) {\n    if (!trackUnhandledRejections) {\n        return;\n    }\n\n    var at = array_indexOf(unhandledRejections, promise);\n    if (at !== -1) {\n        unhandledRejections.splice(at, 1);\n        unhandledReasons.splice(at, 1);\n    }\n}\n\nQ.resetUnhandledRejections = resetUnhandledRejections;\n\nQ.getUnhandledReasons = function () {\n    // Make a copy so that consumers can\'t interfere with our internal state.\n    return unhandledReasons.slice();\n};\n\nQ.stopUnhandledRejectionTracking = function () {\n    resetUnhandledRejections();\n    trackUnhandledRejections = false;\n};\n\nresetUnhandledRejections();\n\n//// END UNHANDLED REJECTION TRACKING\n\n/**\n * Constructs a rejected promise.\n * @param reason value describing the failure\n */\nQ.reject = reject;\nfunction reject(reason) {\n    var rejection = Promise({\n        "when": function (rejected) {\n            // note that the error has been handled\n            if (rejected) {\n                untrackRejection(this);\n            }\n            return rejected ? rejected(reason) : this;\n        }\n    }, function fallback() {\n        return this;\n    }, function inspect() {\n        return { state: "rejected", reason: reason };\n    });\n\n    // Note that the reason has not been handled.\n    trackRejection(rejection, reason);\n\n    return rejection;\n}\n\n/**\n * Constructs a fulfilled promise for an immediate reference.\n * @param value immediate reference\n */\nQ.fulfill = fulfill;\nfunction fulfill(value) {\n    return Promise({\n        "when": function () {\n            return value;\n        },\n        "get": function (name) {\n            return value[name];\n        },\n        "set": function (name, rhs) {\n            value[name] = rhs;\n        },\n        "delete": function (name) {\n            delete value[name];\n        },\n        "post": function (name, args) {\n            // Mark Miller proposes that post with no name should apply a\n            // promised function.\n            if (name === null || name === void 0) {\n                return value.apply(void 0, args);\n            } else {\n                return value[name].apply(value, args);\n            }\n        },\n        "apply": function (thisp, args) {\n            return value.apply(thisp, args);\n        },\n        "keys": function () {\n            return object_keys(value);\n        }\n    }, void 0, function inspect() {\n        return { state: "fulfilled", value: value };\n    });\n}\n\n/**\n * Converts thenables to Q promises.\n * @param promise thenable promise\n * @returns a Q promise\n */\nfunction coerce(promise) {\n    var deferred = defer();\n    nextTick(function () {\n        try {\n            promise.then(deferred.resolve, deferred.reject, deferred.notify);\n        } catch (exception) {\n            deferred.reject(exception);\n        }\n    });\n    return deferred.promise;\n}\n\n/**\n * Annotates an object such that it will never be\n * transferred away from this process over any promise\n * communication channel.\n * @param object\n * @returns promise a wrapping of that object that\n * additionally responds to the "isDef" message\n * without a rejection.\n */\nQ.master = master;\nfunction master(object) {\n    return Promise({\n        "isDef": function () {}\n    }, function fallback(op, args) {\n        return dispatch(object, op, args);\n    }, function () {\n        return Q(object).inspect();\n    });\n}\n\n/**\n * Spreads the values of a promised array of arguments into the\n * fulfillment callback.\n * @param fulfilled callback that receives variadic arguments from the\n * promised array\n * @param rejected callback that receives the exception if the promise\n * is rejected.\n * @returns a promise for the return value or thrown exception of\n * either callback.\n */\nQ.spread = spread;\nfunction spread(value, fulfilled, rejected) {\n    return Q(value).spread(fulfilled, rejected);\n}\n\nPromise.prototype.spread = function (fulfilled, rejected) {\n    return this.all().then(function (array) {\n        return fulfilled.apply(void 0, array);\n    }, rejected);\n};\n\n/**\n * The async function is a decorator for generator functions, turning\n * them into asynchronous generators.  Although generators are only part\n * of the newest ECMAScript 6 drafts, this code does not cause syntax\n * errors in older engines.  This code should continue to work and will\n * in fact improve over time as the language improves.\n *\n * ES6 generators are currently part of V8 version 3.19 with the\n * --harmony-generators runtime flag enabled.  SpiderMonkey has had them\n * for longer, but under an older Python-inspired form.  This function\n * works on both kinds of generators.\n *\n * Decorates a generator function such that:\n *  - it may yield promises\n *  - execution will continue when that promise is fulfilled\n *  - the value of the yield expression will be the fulfilled value\n *  - it returns a promise for the return value (when the generator\n *    stops iterating)\n *  - the decorated function returns a promise for the return value\n *    of the generator or the first rejected promise among those\n *    yielded.\n *  - if an error is thrown in the generator, it propagates through\n *    every following yield until it is caught, or until it escapes\n *    the generator function altogether, and is translated into a\n *    rejection for the promise returned by the decorated generator.\n */\nQ.async = async;\nfunction async(makeGenerator) {\n    return function () {\n        // when verb is "send", arg is a value\n        // when verb is "throw", arg is an exception\n        function continuer(verb, arg) {\n            var result;\n\n            // Until V8 3.19 / Chromium 29 is released, SpiderMonkey is the only\n            // engine that has a deployed base of browsers that support generators.\n            // However, SM\'s generators use the Python-inspired semantics of\n            // outdated ES6 drafts.  We would like to support ES6, but we\'d also\n            // like to make it possible to use generators in deployed browsers, so\n            // we also support Python-style generators.  At some point we can remove\n            // this block.\n\n            if (typeof StopIteration === "undefined") {\n                // ES6 Generators\n                try {\n                    result = generator[verb](arg);\n                } catch (exception) {\n                    return reject(exception);\n                }\n                if (result.done) {\n                    return Q(result.value);\n                } else {\n                    return when(result.value, callback, errback);\n                }\n            } else {\n                // SpiderMonkey Generators\n                // FIXME: Remove this case when SM does ES6 generators.\n                try {\n                    result = generator[verb](arg);\n                } catch (exception) {\n                    if (isStopIteration(exception)) {\n                        return Q(exception.value);\n                    } else {\n                        return reject(exception);\n                    }\n                }\n                return when(result, callback, errback);\n            }\n        }\n        var generator = makeGenerator.apply(this, arguments);\n        var callback = continuer.bind(continuer, "next");\n        var errback = continuer.bind(continuer, "throw");\n        return callback();\n    };\n}\n\n/**\n * The spawn function is a small wrapper around async that immediately\n * calls the generator and also ends the promise chain, so that any\n * unhandled errors are thrown instead of forwarded to the error\n * handler. This is useful because it\'s extremely common to run\n * generators at the top-level to work with libraries.\n */\nQ.spawn = spawn;\nfunction spawn(makeGenerator) {\n    Q.done(Q.async(makeGenerator)());\n}\n\n// FIXME: Remove this interface once ES6 generators are in SpiderMonkey.\n/**\n * Throws a ReturnValue exception to stop an asynchronous generator.\n *\n * This interface is a stop-gap measure to support generator return\n * values in older Firefox/SpiderMonkey.  In browsers that support ES6\n * generators like Chromium 29, just use "return" in your generator\n * functions.\n *\n * @param value the return value for the surrounding generator\n * @throws ReturnValue exception with the value.\n * @example\n * // ES6 style\n * Q.async(function* () {\n *      var foo = yield getFooPromise();\n *      var bar = yield getBarPromise();\n *      return foo + bar;\n * })\n * // Older SpiderMonkey style\n * Q.async(function () {\n *      var foo = yield getFooPromise();\n *      var bar = yield getBarPromise();\n *      Q.return(foo + bar);\n * })\n */\nQ["return"] = _return;\nfunction _return(value) {\n    throw new QReturnValue(value);\n}\n\n/**\n * The promised function decorator ensures that any promise arguments\n * are settled and passed as values (`this` is also settled and passed\n * as a value).  It will also ensure that the result of a function is\n * always a promise.\n *\n * @example\n * var add = Q.promised(function (a, b) {\n *     return a + b;\n * });\n * add(Q(a), Q(B));\n *\n * @param {function} callback The function to decorate\n * @returns {function} a function that has been decorated.\n */\nQ.promised = promised;\nfunction promised(callback) {\n    return function () {\n        return spread([this, all(arguments)], function (self, args) {\n            return callback.apply(self, args);\n        });\n    };\n}\n\n/**\n * sends a message to a value in a future turn\n * @param object* the recipient\n * @param op the name of the message operation, e.g., "when",\n * @param args further arguments to be forwarded to the operation\n * @returns result {Promise} a promise for the result of the operation\n */\nQ.dispatch = dispatch;\nfunction dispatch(object, op, args) {\n    return Q(object).dispatch(op, args);\n}\n\nPromise.prototype.dispatch = function (op, args) {\n    var self = this;\n    var deferred = defer();\n    nextTick(function () {\n        self.promiseDispatch(deferred.resolve, op, args);\n    });\n    return deferred.promise;\n};\n\n/**\n * Gets the value of a property in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of property to get\n * @return promise for the property value\n */\nQ.get = function (object, key) {\n    return Q(object).dispatch("get", [key]);\n};\n\nPromise.prototype.get = function (key) {\n    return this.dispatch("get", [key]);\n};\n\n/**\n * Sets the value of a property in a future turn.\n * @param object    promise or immediate reference for object object\n * @param name      name of property to set\n * @param value     new value of property\n * @return promise for the return value\n */\nQ.set = function (object, key, value) {\n    return Q(object).dispatch("set", [key, value]);\n};\n\nPromise.prototype.set = function (key, value) {\n    return this.dispatch("set", [key, value]);\n};\n\n/**\n * Deletes a property in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of property to delete\n * @return promise for the return value\n */\nQ.del = // XXX legacy\nQ["delete"] = function (object, key) {\n    return Q(object).dispatch("delete", [key]);\n};\n\nPromise.prototype.del = // XXX legacy\nPromise.prototype["delete"] = function (key) {\n    return this.dispatch("delete", [key]);\n};\n\n/**\n * Invokes a method in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of method to invoke\n * @param value     a value to post, typically an array of\n *                  invocation arguments for promises that\n *                  are ultimately backed with `resolve` values,\n *                  as opposed to those backed with URLs\n *                  wherein the posted value can be any\n *                  JSON serializable object.\n * @return promise for the return value\n */\n// bound locally because it is used by other methods\nQ.mapply = // XXX As proposed by "Redsandro"\nQ.post = function (object, name, args) {\n    return Q(object).dispatch("post", [name, args]);\n};\n\nPromise.prototype.mapply = // XXX As proposed by "Redsandro"\nPromise.prototype.post = function (name, args) {\n    return this.dispatch("post", [name, args]);\n};\n\n/**\n * Invokes a method in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of method to invoke\n * @param ...args   array of invocation arguments\n * @return promise for the return value\n */\nQ.send = // XXX Mark Miller\'s proposed parlance\nQ.mcall = // XXX As proposed by "Redsandro"\nQ.invoke = function (object, name /*...args*/) {\n    return Q(object).dispatch("post", [name, array_slice(arguments, 2)]);\n};\n\nPromise.prototype.send = // XXX Mark Miller\'s proposed parlance\nPromise.prototype.mcall = // XXX As proposed by "Redsandro"\nPromise.prototype.invoke = function (name /*...args*/) {\n    return this.dispatch("post", [name, array_slice(arguments, 1)]);\n};\n\n/**\n * Applies the promised function in a future turn.\n * @param object    promise or immediate reference for target function\n * @param args      array of application arguments\n */\nQ.fapply = function (object, args) {\n    return Q(object).dispatch("apply", [void 0, args]);\n};\n\nPromise.prototype.fapply = function (args) {\n    return this.dispatch("apply", [void 0, args]);\n};\n\n/**\n * Calls the promised function in a future turn.\n * @param object    promise or immediate reference for target function\n * @param ...args   array of application arguments\n */\nQ["try"] =\nQ.fcall = function (object /* ...args*/) {\n    return Q(object).dispatch("apply", [void 0, array_slice(arguments, 1)]);\n};\n\nPromise.prototype.fcall = function (/*...args*/) {\n    return this.dispatch("apply", [void 0, array_slice(arguments)]);\n};\n\n/**\n * Binds the promised function, transforming return values into a fulfilled\n * promise and thrown errors into a rejected one.\n * @param object    promise or immediate reference for target function\n * @param ...args   array of application arguments\n */\nQ.fbind = function (object /*...args*/) {\n    var promise = Q(object);\n    var args = array_slice(arguments, 1);\n    return function fbound() {\n        return promise.dispatch("apply", [\n            this,\n            args.concat(array_slice(arguments))\n        ]);\n    };\n};\nPromise.prototype.fbind = function (/*...args*/) {\n    var promise = this;\n    var args = array_slice(arguments);\n    return function fbound() {\n        return promise.dispatch("apply", [\n            this,\n            args.concat(array_slice(arguments))\n        ]);\n    };\n};\n\n/**\n * Requests the names of the owned properties of a promised\n * object in a future turn.\n * @param object    promise or immediate reference for target object\n * @return promise for the keys of the eventually settled object\n */\nQ.keys = function (object) {\n    return Q(object).dispatch("keys", []);\n};\n\nPromise.prototype.keys = function () {\n    return this.dispatch("keys", []);\n};\n\n/**\n * Turns an array of promises into a promise for an array.  If any of\n * the promises gets rejected, the whole array is rejected immediately.\n * @param {Array*} an array (or promise for an array) of values (or\n * promises for values)\n * @returns a promise for an array of the corresponding values\n */\n// By Mark Miller\n// http://wiki.ecmascript.org/doku.php?id=strawman:concurrency&rev=1308776521#allfulfilled\nQ.all = all;\nfunction all(promises) {\n    return when(promises, function (promises) {\n        var countDown = 0;\n        var deferred = defer();\n        array_reduce(promises, function (undefined, promise, index) {\n            var snapshot;\n            if (\n                isPromise(promise) &&\n                (snapshot = promise.inspect()).state === "fulfilled"\n            ) {\n                promises[index] = snapshot.value;\n            } else {\n                ++countDown;\n                when(\n                    promise,\n                    function (value) {\n                        promises[index] = value;\n                        if (--countDown === 0) {\n                            deferred.resolve(promises);\n                        }\n                    },\n                    deferred.reject,\n                    function (progress) {\n                        deferred.notify({ index: index, value: progress });\n                    }\n                );\n            }\n        }, void 0);\n        if (countDown === 0) {\n            deferred.resolve(promises);\n        }\n        return deferred.promise;\n    });\n}\n\nPromise.prototype.all = function () {\n    return all(this);\n};\n\n/**\n * Waits for all promises to be settled, either fulfilled or\n * rejected.  This is distinct from `all` since that would stop\n * waiting at the first rejection.  The promise returned by\n * `allResolved` will never be rejected.\n * @param promises a promise for an array (or an array) of promises\n * (or values)\n * @return a promise for an array of promises\n */\nQ.allResolved = deprecate(allResolved, "allResolved", "allSettled");\nfunction allResolved(promises) {\n    return when(promises, function (promises) {\n        promises = array_map(promises, Q);\n        return when(all(array_map(promises, function (promise) {\n            return when(promise, noop, noop);\n        })), function () {\n            return promises;\n        });\n    });\n}\n\nPromise.prototype.allResolved = function () {\n    return allResolved(this);\n};\n\n/**\n * @see Promise#allSettled\n */\nQ.allSettled = allSettled;\nfunction allSettled(promises) {\n    return Q(promises).allSettled();\n}\n\n/**\n * Turns an array of promises into a promise for an array of their states (as\n * returned by `inspect`) when they have all settled.\n * @param {Array[Any*]} values an array (or promise for an array) of values (or\n * promises for values)\n * @returns {Array[State]} an array of states for the respective values.\n */\nPromise.prototype.allSettled = function () {\n    return this.then(function (promises) {\n        return all(array_map(promises, function (promise) {\n            promise = Q(promise);\n            function regardless() {\n                return promise.inspect();\n            }\n            return promise.then(regardless, regardless);\n        }));\n    });\n};\n\n/**\n * Captures the failure of a promise, giving an oportunity to recover\n * with a callback.  If the given promise is fulfilled, the returned\n * promise is fulfilled.\n * @param {Any*} promise for something\n * @param {Function} callback to fulfill the returned promise if the\n * given promise is rejected\n * @returns a promise for the return value of the callback\n */\nQ.fail = // XXX legacy\nQ["catch"] = function (object, rejected) {\n    return Q(object).then(void 0, rejected);\n};\n\nPromise.prototype.fail = // XXX legacy\nPromise.prototype["catch"] = function (rejected) {\n    return this.then(void 0, rejected);\n};\n\n/**\n * Attaches a listener that can respond to progress notifications from a\n * promise\'s originating deferred. This listener receives the exact arguments\n * passed to ``deferred.notify``.\n * @param {Any*} promise for something\n * @param {Function} callback to receive any progress notifications\n * @returns the given promise, unchanged\n */\nQ.progress = progress;\nfunction progress(object, progressed) {\n    return Q(object).then(void 0, void 0, progressed);\n}\n\nPromise.prototype.progress = function (progressed) {\n    return this.then(void 0, void 0, progressed);\n};\n\n/**\n * Provides an opportunity to observe the settling of a promise,\n * regardless of whether the promise is fulfilled or rejected.  Forwards\n * the resolution to the returned promise when the callback is done.\n * The callback can return a promise to defer completion.\n * @param {Any*} promise\n * @param {Function} callback to observe the resolution of the given\n * promise, takes no arguments.\n * @returns a promise for the resolution of the given promise when\n * ``fin`` is done.\n */\nQ.fin = // XXX legacy\nQ["finally"] = function (object, callback) {\n    return Q(object)["finally"](callback);\n};\n\nPromise.prototype.fin = // XXX legacy\nPromise.prototype["finally"] = function (callback) {\n    callback = Q(callback);\n    return this.then(function (value) {\n        return callback.fcall().then(function () {\n            return value;\n        });\n    }, function (reason) {\n        // TODO attempt to recycle the rejection with "this".\n        return callback.fcall().then(function () {\n            throw reason;\n        });\n    });\n};\n\n/**\n * Terminates a chain of promises, forcing rejections to be\n * thrown as exceptions.\n * @param {Any*} promise at the end of a chain of promises\n * @returns nothing\n */\nQ.done = function (object, fulfilled, rejected, progress) {\n    return Q(object).done(fulfilled, rejected, progress);\n};\n\nPromise.prototype.done = function (fulfilled, rejected, progress) {\n    var onUnhandledError = function (error) {\n        // forward to a future turn so that ``when``\n        // does not catch it and turn it into a rejection.\n        nextTick(function () {\n            makeStackTraceLong(error, promise);\n            if (Q.onerror) {\n                Q.onerror(error);\n            } else {\n                throw error;\n            }\n        });\n    };\n\n    // Avoid unnecessary `nextTick`ing via an unnecessary `when`.\n    var promise = fulfilled || rejected || progress ?\n        this.then(fulfilled, rejected, progress) :\n        this;\n\n    if (typeof process === "object" && process && process.domain) {\n        onUnhandledError = process.domain.bind(onUnhandledError);\n    }\n\n    promise.then(void 0, onUnhandledError);\n};\n\n/**\n * Causes a promise to be rejected if it does not get fulfilled before\n * some milliseconds time out.\n * @param {Any*} promise\n * @param {Number} milliseconds timeout\n * @param {Any*} custom error message or Error object (optional)\n * @returns a promise for the resolution of the given promise if it is\n * fulfilled before the timeout, otherwise rejected.\n */\nQ.timeout = function (object, ms, error) {\n    return Q(object).timeout(ms, error);\n};\n\nPromise.prototype.timeout = function (ms, error) {\n    var deferred = defer();\n    var timeoutId = setTimeout(function () {\n        if (!error || "string" === typeof error) {\n            error = new Error(error || "Timed out after " + ms + " ms");\n            error.code = "ETIMEDOUT";\n        }\n        deferred.reject(error);\n    }, ms);\n\n    this.then(function (value) {\n        clearTimeout(timeoutId);\n        deferred.resolve(value);\n    }, function (exception) {\n        clearTimeout(timeoutId);\n        deferred.reject(exception);\n    }, deferred.notify);\n\n    return deferred.promise;\n};\n\n/**\n * Returns a promise for the given value (or promised value), some\n * milliseconds after it resolved. Passes rejections immediately.\n * @param {Any*} promise\n * @param {Number} milliseconds\n * @returns a promise for the resolution of the given promise after milliseconds\n * time has elapsed since the resolution of the given promise.\n * If the given promise rejects, that is passed immediately.\n */\nQ.delay = function (object, timeout) {\n    if (timeout === void 0) {\n        timeout = object;\n        object = void 0;\n    }\n    return Q(object).delay(timeout);\n};\n\nPromise.prototype.delay = function (timeout) {\n    return this.then(function (value) {\n        var deferred = defer();\n        setTimeout(function () {\n            deferred.resolve(value);\n        }, timeout);\n        return deferred.promise;\n    });\n};\n\n/**\n * Passes a continuation to a Node function, which is called with the given\n * arguments provided as an array, and returns a promise.\n *\n *      Q.nfapply(FS.readFile, [__filename])\n *      .then(function (content) {\n *      })\n *\n */\nQ.nfapply = function (callback, args) {\n    return Q(callback).nfapply(args);\n};\n\nPromise.prototype.nfapply = function (args) {\n    var deferred = defer();\n    var nodeArgs = array_slice(args);\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.fapply(nodeArgs).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Passes a continuation to a Node function, which is called with the given\n * arguments provided individually, and returns a promise.\n * @example\n * Q.nfcall(FS.readFile, __filename)\n * .then(function (content) {\n * })\n *\n */\nQ.nfcall = function (callback /*...args*/) {\n    var args = array_slice(arguments, 1);\n    return Q(callback).nfapply(args);\n};\n\nPromise.prototype.nfcall = function (/*...args*/) {\n    var nodeArgs = array_slice(arguments);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.fapply(nodeArgs).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Wraps a NodeJS continuation passing function and returns an equivalent\n * version that returns a promise.\n * @example\n * Q.nfbind(FS.readFile, __filename)("utf-8")\n * .then(console.log)\n * .done()\n */\nQ.nfbind =\nQ.denodeify = function (callback /*...args*/) {\n    var baseArgs = array_slice(arguments, 1);\n    return function () {\n        var nodeArgs = baseArgs.concat(array_slice(arguments));\n        var deferred = defer();\n        nodeArgs.push(deferred.makeNodeResolver());\n        Q(callback).fapply(nodeArgs).fail(deferred.reject);\n        return deferred.promise;\n    };\n};\n\nPromise.prototype.nfbind =\nPromise.prototype.denodeify = function (/*...args*/) {\n    var args = array_slice(arguments);\n    args.unshift(this);\n    return Q.denodeify.apply(void 0, args);\n};\n\nQ.nbind = function (callback, thisp /*...args*/) {\n    var baseArgs = array_slice(arguments, 2);\n    return function () {\n        var nodeArgs = baseArgs.concat(array_slice(arguments));\n        var deferred = defer();\n        nodeArgs.push(deferred.makeNodeResolver());\n        function bound() {\n            return callback.apply(thisp, arguments);\n        }\n        Q(bound).fapply(nodeArgs).fail(deferred.reject);\n        return deferred.promise;\n    };\n};\n\nPromise.prototype.nbind = function (/*thisp, ...args*/) {\n    var args = array_slice(arguments, 0);\n    args.unshift(this);\n    return Q.nbind.apply(void 0, args);\n};\n\n/**\n * Calls a method of a Node-style object that accepts a Node-style\n * callback with a given array of arguments, plus a provided callback.\n * @param object an object that has the named method\n * @param {String} name name of the method of object\n * @param {Array} args arguments to pass to the method; the callback\n * will be provided by Q and appended to these arguments.\n * @returns a promise for the value or error\n */\nQ.nmapply = // XXX As proposed by "Redsandro"\nQ.npost = function (object, name, args) {\n    return Q(object).npost(name, args);\n};\n\nPromise.prototype.nmapply = // XXX As proposed by "Redsandro"\nPromise.prototype.npost = function (name, args) {\n    var nodeArgs = array_slice(args || []);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.dispatch("post", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Calls a method of a Node-style object that accepts a Node-style\n * callback, forwarding the given variadic arguments, plus a provided\n * callback argument.\n * @param object an object that has the named method\n * @param {String} name name of the method of object\n * @param ...args arguments to pass to the method; the callback will\n * be provided by Q and appended to these arguments.\n * @returns a promise for the value or error\n */\nQ.nsend = // XXX Based on Mark Miller\'s proposed "send"\nQ.nmcall = // XXX Based on "Redsandro\'s" proposal\nQ.ninvoke = function (object, name /*...args*/) {\n    var nodeArgs = array_slice(arguments, 2);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    Q(object).dispatch("post", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\nPromise.prototype.nsend = // XXX Based on Mark Miller\'s proposed "send"\nPromise.prototype.nmcall = // XXX Based on "Redsandro\'s" proposal\nPromise.prototype.ninvoke = function (name /*...args*/) {\n    var nodeArgs = array_slice(arguments, 1);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.dispatch("post", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * If a function would like to support both Node continuation-passing-style and\n * promise-returning-style, it can end its internal promise chain with\n * `nodeify(nodeback)`, forwarding the optional nodeback argument.  If the user\n * elects to use a nodeback, the result will be sent there.  If they do not\n * pass a nodeback, they will receive the result promise.\n * @param object a result (or a promise for a result)\n * @param {Function} nodeback a Node.js-style callback\n * @returns either the promise or nothing\n */\nQ.nodeify = nodeify;\nfunction nodeify(object, nodeback) {\n    return Q(object).nodeify(nodeback);\n}\n\nPromise.prototype.nodeify = function (nodeback) {\n    if (nodeback) {\n        this.then(function (value) {\n            nextTick(function () {\n                nodeback(null, value);\n            });\n        }, function (error) {\n            nextTick(function () {\n                nodeback(error);\n            });\n        });\n    } else {\n        return this;\n    }\n};\n\n// All code before this point will be filtered from stack traces.\nvar qEndingLine = captureLine();\n\nreturn Q;\n\n});'},function(t,e,n){n(10)(n(314))},function(t,e){t.exports='/**\n * Timeago is a jQuery plugin that makes it easy to support automatically\n * updating fuzzy timestamps (e.g. "4 minutes ago" or "about 1 day ago").\n *\n * @name timeago\n * @version 1.2.0\n * @requires jQuery v1.2.3+\n * @author Ryan McGeary\n * @license MIT License - http://www.opensource.org/licenses/mit-license.php\n *\n * For usage and examples, visit:\n * http://timeago.yarp.com/\n *\n * Copyright (c) 2008-2013, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)\n */\n\n(function (factory) {\n  if (typeof define === \'function\' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([\'jquery\'], factory);\n  } else {\n    // Browser globals\n    factory(jQuery);\n  }\n}(function ($) {\n  $.timeago = function(timestamp) {\n    if (timestamp instanceof Date) {\n      return inWords(timestamp);\n    } else if (typeof timestamp === "string") {\n      return inWords($.timeago.parse(timestamp));\n    } else if (typeof timestamp === "number") {\n      return inWords(new Date(timestamp));\n    } else {\n      return inWords($.timeago.datetime(timestamp));\n    }\n  };\n  var $t = $.timeago;\n\n  $.extend($.timeago, {\n    settings: {\n      refreshMillis: 60000,\n      allowFuture: false,\n      localeTitle: false,\n      cutoff: 0,\n      strings: {\n        prefixAgo: null,\n        prefixFromNow: null,\n        suffixAgo: "ago",\n        suffixFromNow: "from now",\n        seconds: "less than a minute",\n        minute: "about a minute",\n        minutes: "%d minutes",\n        hour: "about an hour",\n        hours: "about %d hours",\n        day: "a day",\n        days: "%d days",\n        month: "about a month",\n        months: "%d months",\n        year: "about a year",\n        years: "%d years",\n        wordSeparator: " ",\n        numbers: []\n      }\n    },\n    inWords: function(distanceMillis) {\n      var $l = this.settings.strings;\n      var prefix = $l.prefixAgo;\n      var suffix = $l.suffixAgo;\n      if (this.settings.allowFuture) {\n        if (distanceMillis < 0) {\n          prefix = $l.prefixFromNow;\n          suffix = $l.suffixFromNow;\n        }\n      }\n\n      var seconds = Math.abs(distanceMillis) / 1000;\n      var minutes = seconds / 60;\n      var hours = minutes / 60;\n      var days = hours / 24;\n      var years = days / 365;\n\n      function substitute(stringOrFunction, number) {\n        var string = typeof stringOrFunction === "function" ? stringOrFunction(number, distanceMillis) : stringOrFunction;\n        var value = ($l.numbers && $l.numbers[number]) || number;\n        return string.replace(/%d/i, value);\n      }\n\n      var words = seconds < 45 && substitute($l.seconds, Math.round(seconds)) ||\n        seconds < 90 && substitute($l.minute, 1) ||\n        minutes < 45 && substitute($l.minutes, Math.round(minutes)) ||\n        minutes < 90 && substitute($l.hour, 1) ||\n        hours < 24 && substitute($l.hours, Math.round(hours)) ||\n        hours < 42 && substitute($l.day, 1) ||\n        days < 30 && substitute($l.days, Math.round(days)) ||\n        days < 45 && substitute($l.month, 1) ||\n        days < 365 && substitute($l.months, Math.round(days / 30)) ||\n        years < 1.5 && substitute($l.year, 1) ||\n        substitute($l.years, Math.round(years));\n\n      var separator = $l.wordSeparator || "";\n      if ($l.wordSeparator === undefined) { separator = " "; }\n      return [prefix, words, suffix].join(separator).trim();\n    },\n    parse: function(iso8601) {\n      var s = iso8601.trim();\n      s = s.replace(/\\.\\d+/,""); // remove milliseconds\n      s = s.replace(/-/,"/").replace(/-/,"/");\n      s = s.replace(/T/," ").replace(/Z/," UTC");\n      s = s.replace(/([\\+\\-]\\d\\d)\\:?(\\d\\d)/," $1$2"); // -04:00 -> -0400\n      return new Date(s);\n    },\n    datetime: function(elem) {\n      var iso8601 = $t.isTime(elem) ? $(elem).attr("datetime") : $(elem).attr("title");\n      return $t.parse(iso8601);\n    },\n    isTime: function(elem) {\n      // jQuery\'s `is()` doesn\'t play well with HTML5 in IE\n      return $(elem).get(0).tagName.toLowerCase() === "time"; // $(elem).is("time");\n    }\n  });\n\n  // functions that can be called via $(el).timeago(\'action\')\n  // init is default when no action is given\n  // functions are called with context of a single element\n  var functions = {\n    init: function(){\n      var refresh_el = $.proxy(refresh, this);\n      refresh_el();\n      var $s = $t.settings;\n      if ($s.refreshMillis > 0) {\n        setInterval(refresh_el, $s.refreshMillis);\n      }\n    },\n    update: function(time){\n      $(this).data(\'timeago\', { datetime: $t.parse(time) });\n      refresh.apply(this);\n    }\n  };\n\n  $.fn.timeago = function(action, options) {\n    var fn = action ? functions[action] : functions.init;\n    if(!fn){\n      throw new Error("Unknown function name \'"+ action +"\' for timeago");\n    }\n    // each over objects here and call the requested function\n    this.each(function(){\n      fn.call(this, options);\n    });\n    return this;\n  };\n\n  function refresh() {\n    var data = prepareData(this);\n    var $s = $t.settings;\n\n    if (!isNaN(data.datetime)) {\n      if ( $s.cutoff == 0 || distance(data.datetime) < $s.cutoff) {\n        $(this).text(inWords(data.datetime));\n      }\n    }\n    return this;\n  }\n\n  function prepareData(element) {\n    element = $(element);\n    if (!element.data("timeago")) {\n      element.data("timeago", { datetime: $t.datetime(element) });\n      var text = element.text().trim();\n      if ($t.settings.localeTitle) {\n        element.attr("title", element.data(\'timeago\').datetime.toLocaleString());\n      } else if (text.length > 0 && !($t.isTime(element) && element.attr("title"))) {\n        element.attr("title", text);\n      }\n    }\n    return element.data("timeago");\n  }\n\n  function inWords(date) {\n    return $t.inWords(distance(date));\n  }\n\n  function distance(date) {\n    return (new Date().getTime() - date.getTime());\n  }\n\n  // fix for IE6 suckage\n  document.createElement("abbr");\n  document.createElement("time");\n}));\n'},function(t,e,n){n(10)(n(316))},function(t,e){t.exports="/*\n * File: iframeSizer.contentWindow.js\n * Desc: Include this file in any page being loaded into an iframe\n *       to force the iframe to resize to the content size.\n * Requires: iframeSizer.js on host page.\n * Author: David J. Bradshaw - dave@bradshaw.net\n * Contributor: Jure Mav - jure.mav@gmail.com\n *\n * Modified by: Rob Secord\n *  - to allow scroll communication\n */\n\n(function () {\n  'use strict';\n\n  var\n    autoResize = true,\n    base = 10,\n    bodyMargin = 0,\n    bodyMarginStr = '',\n    scrollTop = 0,\n    offsetTop = 0,\n    calculateWidth = false,\n    height = 1,\n    firstRun = true,\n    interval = 32,\n    lastTrigger = '',\n    logging = false,\n    msgID = '[iFrameSizer]',  //Must match host page msg ID\n    msgIdLen = msgID.length,\n    myID = '',\n    publicMethods = false,\n    target = window.parent,\n    triggerCancelTimer = 50,\n    ignoreNextEvent = false,\n    isFullscreen = false,\n    width = 1,\n    viewportX = 0,\n    viewportY = 0,\n    loadData = null;\n\n\n  function addEventListener(e, func) {\n    if ('addEventListener' in window) {\n      window.addEventListener(e, func, false);\n    } else if ('attachEvent' in window) { //IE\n      window.attachEvent('on' + e, func);\n    }\n  }\n\n  function formatLogMsg(msg) {\n    return msgID + '[' + myID + ']' + ' ' + msg;\n  }\n\n  function log(msg) {\n    if (logging && ('console' in window)) {\n      console.log(formatLogMsg(msg));\n    }\n  }\n\n  function warn(msg) {\n    if ('console' in window) {\n      console.warn(formatLogMsg(msg));\n    }\n  }\n\n  function receiver(event) {\n    function init() {\n\n      function readData() {\n        function strBool(str) {\n          return 'true' === str ? true : false;\n        }\n\n        var data = event.data.substr(msgIdLen).split(':');\n\n        myID = data[0];\n        bodyMargin = (undefined !== data[1]) ? parseInt(data[1], base) : 0;\n        calculateWidth = (undefined !== data[2]) ? strBool(data[2]) : false;\n        logging = (undefined !== data[3]) ? strBool(data[3]) : false;\n        interval = (undefined !== data[4]) ? parseInt(data[4], base) : 33;\n        publicMethods = (undefined !== data[5]) ? strBool(data[5]) : false;\n        autoResize = (undefined !== data[6]) ? strBool(data[6]) : true;\n        bodyMarginStr = data[7];\n        loadData = (undefined !== data[8]) ? data[8] : null;\n        scrollTop = (undefined !== data[9]) ? parseInt(data[9], base) : 0;\n        offsetTop = (undefined !== data[10]) ? parseInt(data[10], base) : 0;\n        viewportX = (undefined !== data[11]) ? parseInt(data[11], base) : 0;\n        viewportY = (undefined !== data[12]) ? parseInt(data[12], base) : 0;\n      }\n\n      function setMargin() {\n        //If called via V1 script, convert bodyMargin from int to str\n        if (undefined === bodyMarginStr) {\n          bodyMarginStr = bodyMargin + 'px';\n        }\n        if (undefined !== bodyMarginStr && '' !== bodyMarginStr && 'null' !== bodyMarginStr) {\n          document.body.style.margin = bodyMarginStr;\n          log('Body margin set to ' + bodyMarginStr);\n        }\n      }\n\n      function stopInfiniteResizingOfIFrame() {\n        document.documentElement.style.height = 'auto';\n        document.body.style.height = 'auto';\n        log('HTML & body height set to \"auto\"');\n      }\n\n      function initWindowResizeListener() {\n        addEventListener('resize', function () {\n          sendSize('resize', 'Window resized');\n        });\n      }\n\n      function startEventListeners() {\n        if (true === autoResize) {\n          initWindowResizeListener();\n          setupMutationObserver();\n        }\n        else {\n          log('Auto Resize disabled');\n        }\n      }\n\n      log('Initialising iFrame');\n\n      readData();\n      setMargin();\n      stopInfiniteResizingOfIFrame();\n      setupPublicMethods();\n      startEventListeners();\n    }\n\n    function sendSize(type, calleeMsg, customHeight, customWidth) {\n\n      // document.documentElement.offsetHeight is not reliable, so\n      // we have to jump through hoops to get the correct value.\n      function getIFrameHeight() {\n        function getComputedBodyStyle(prop) {\n          function convertUnitsToPxForIE8(value) {\n            var PIXEL = /^\\d+(px)?$/i;\n\n            if (PIXEL.test(value)) {\n              return parseInt(value, base);\n            }\n\n            var\n              style = el.style.left,\n              runtimeStyle = el.runtimeStyle.left;\n\n            el.runtimeStyle.left = el.currentStyle.left;\n            el.style.left = value || 0;\n            value = el.style.pixelLeft;\n            el.style.left = style;\n            el.runtimeStyle.left = runtimeStyle;\n\n            return value;\n          }\n\n          var\n            el = document.body,\n            retVal = 0;\n\n          if (document.defaultView && document.defaultView.getComputedStyle) {\n            retVal = document.defaultView.getComputedStyle(el, null)[prop];\n          } else {//IE8\n            retVal = convertUnitsToPxForIE8(el.currentStyle[prop]);\n          }\n\n          return parseInt(retVal, base);\n        }\n\n        return Math.max(document.documentElement.offsetHeight, document.body.offsetHeight) +\n          getComputedBodyStyle('marginTop') +\n          getComputedBodyStyle('marginBottom');\n      }\n\n      function getIFrameWidth() {\n        return document.documentElement.offsetWidth;\n      }\n\n      function cancelTrigger() {\n        log('Trigger event (' + calleeMsg + ') cancelled');\n        setTimeout(function () {\n          lastTrigger = type;\n        }, triggerCancelTimer);\n      }\n\n      function recordTrigger() {\n        log('Trigger event: ' + calleeMsg);\n        lastTrigger = type;\n      }\n\n      function sendMsg() {\n        var msg = myID + ':' + height + ':' + width + ':' + type;\n        log('Sending msg to host page (' + msg + ')');\n        target.postMessage(msgID + msg, '*');\n      }\n\n      function resizeIFrame() {\n        height = currentHeight;\n        width = currentWidth;\n\n        recordTrigger();\n        sendMsg();\n      }\n\n      if (ignoreNextEvent) {\n        return;\n      }\n\n      var\n        currentHeight = (undefined !== customHeight) ? customHeight : getIFrameHeight(),\n        currentWidth = (undefined !== customWidth) ? customWidth : getIFrameWidth();\n\n      if (lastTrigger in { size: 1, interval: 1 } && ('resize' === type)) {\n        cancelTrigger();\n      } else if ((height !== currentHeight) || (calculateWidth && width !== currentWidth)) {\n        resizeIFrame();\n      }\n    }\n\n    function sendScroll(type, calleeMsg, scrollTo) {\n      function recordTrigger() {\n        log('Trigger event: ' + calleeMsg);\n        lastTrigger = type;\n      }\n\n      function sendMsg() {\n        var msg = myID + ':' + scrollTo + ':' + type;\n        log('Sending msg to host page (' + msg + ')');\n        target.postMessage(msgID + msg, '*');\n      }\n\n      recordTrigger();\n      sendMsg();\n    }\n\n    function sendPageUrl(type, calleeMsg, fragmentIdentifier) {\n      function recordTrigger() {\n        log('Trigger event: ' + calleeMsg);\n        lastTrigger = type;\n      }\n\n      function sendMsg() {\n        var msg = myID + ':' + fragmentIdentifier + ':' + type;\n        log('Sending msg to host page (' + msg + ')');\n        target.postMessage(msgID + msg, '*');\n      }\n\n      recordTrigger();\n      sendMsg();\n    }\n\n    function sendFullscreen(type, calleeMsg, state) {\n      function recordTrigger() {\n        log('Trigger event: ' + calleeMsg);\n        lastTrigger = type;\n      }\n\n      function sendMsg() {\n        var msg = myID + ':' + state + ':' + type;\n        log('Sending msg to host page (' + msg + ')');\n        target.postMessage(msgID + msg, '*');\n      }\n\n      isFullscreen = !!state;\n      ignoreNextEvent = true;\n      window.setTimeout(function () {\n        ignoreNextEvent = false;\n      }, 2200);\n      recordTrigger();\n      sendMsg();\n    }\n\n    function setupPublicMethods() {\n      if (publicMethods) {\n        log('Enable public methods');\n\n        window.parentIFrame = window.iFrameSizer = {\n          innerHeight: function () {\n            return viewportY;\n          },\n          updateUrl: function scrollF(fragmentIdentifier) {\n            sendPageUrl('updateUrl', 'window.parentIFrame.updateUrl()', fragmentIdentifier);\n          },\n          scroll: function scrollF(scrollTo) {\n            sendScroll('scroll', 'window.parentIFrame.scroll()', scrollTo);\n          },\n          size: function sizeF(customHeight, customWidth) {\n            var valString = '' + (customHeight ? customHeight : '') + (customWidth ? ',' + customWidth : '');\n            sendSize('size', 'window.parentIFrame.size(' + valString + ')', customHeight, customWidth);\n          },\n          fullscreen: function fullscreenF(state) {\n            sendFullscreen('fullscreen', 'window.parentIFrame.fullscreen(' + state + ')', state);\n          },\n          close: function closeF() {\n            sendSize('close', 'window.parentIFrame.close()', 0, 0);\n          }\n        };\n\n        emitReadyEvent();\n      }\n    }\n\n    function emitReadyEvent() {\n      var isModernBrowser = typeof(Event) === 'function';\n      var eventName = 'parentIFrameReady';\n      var event;\n\n      if (isModernBrowser) {\n        event = new Event(eventName);\n      } else {\n        event = document.createEvent('Event');\n        event.initEvent(eventName, true, true);\n      }\n      window.dispatchEvent(event);\n    }\n\n    function initInterval() {\n      if (0 !== interval) {\n        log('setInterval: ' + interval + 'ms');\n        setInterval(function () {\n          sendSize('interval', 'setInterval: ' + interval);\n        }, Math.abs(interval));\n      }\n    }\n\n    function setupMutationObserver() {\n      function createMutationObserver() {\n        var\n          target = document.querySelector('body'),\n\n          config = {\n            attributes: true,\n            attributeOldValue: false,\n            characterData: true,\n            characterDataOldValue: false,\n            childList: true,\n            subtree: true\n          },\n\n          observer = new MutationObserver(function (mutations) {\n            mutations.forEach(function (mutation) {\n              if (isFullscreen) {\n                return;\n              }\n              sendSize('mutationObserver', 'mutationObserver: ' + mutation.target + ' ' + mutation.type);\n            });\n          });\n\n        log('Enable MutationObserver');\n        observer.observe(target, config);\n      }\n\n      var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n\n      if (MutationObserver) {\n        if (0 > interval) {\n          initInterval();\n        } else {\n          createMutationObserver();\n        }\n      }\n      else {\n        warn('MutationObserver not supported in this browser!');\n        initInterval();\n      }\n    }\n\n    function isMessageForUs() {\n      if (typeof event.data !== 'string') {\n        return false;\n      }\n      return msgID === '' + event.data.substr(0, msgIdLen);\n    }\n\n    if (isMessageForUs()) { //Check msg ID\n      if (firstRun) {\n        init();\n        sendSize('init', 'Init message from host page');\n        firstRun = false;\n      }\n\n      // Check for Scroll Data in Message\n      var data = event.data.substr(msgIdLen).split(':');\n      if (data.length > 8) {\n        // Load & Scroll Data Present\n        loadData = (undefined !== data[8]) ? data[8] : '';\n        scrollTop = (undefined !== data[9]) ? parseInt(data[9], base) : 0;\n        offsetTop = (undefined !== data[10]) ? parseInt(data[10], base) : 0;\n        viewportX = (undefined !== data[11]) ? parseInt(data[11], base) : viewportX;\n        viewportY = (undefined !== data[12]) ? parseInt(data[12], base) : viewportY;\n\n        // Call Global Callback for Load Data\n        if (g_iFrameLoadDataCallback !== undefined && loadData.length) {\n          g_iFrameLoadDataCallback.call(this, loadData);\n        }\n\n        // Call Global Callback for Scroll Event\n        if (g_iFrameScrollCallback !== undefined) {\n          g_iFrameScrollCallback.call(this, scrollTop, offsetTop, viewportX, viewportY);\n        }\n      }\n    }\n  }\n\n  addEventListener('message', receiver);\n})();\n"},,,,,,,,,function(t,e,n){n(10)(n(326))},function(t,e){t.exports='/*!\n * jQuery Migrate - v3.3.2 - 2020-11-17T23:22Z\n * Copyright OpenJS Foundation and other contributors\n */\n( function( factory ) {\n\t"use strict";\n\n\tif ( typeof define === "function" && define.amd ) {\n\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine( [ "jquery" ], function( jQuery ) {\n\t\t\treturn factory( jQuery, window );\n\t\t} );\n\t} else if ( typeof module === "object" && module.exports ) {\n\n\t\t// Node/CommonJS\n\t\t// eslint-disable-next-line no-undef\n\t\tmodule.exports = factory( require( "jquery" ), window );\n\t} else {\n\n\t\t// Browser globals\n\t\tfactory( jQuery, window );\n\t}\n} )( function( jQuery, window ) {\n"use strict";\n\njQuery.migrateVersion = "3.3.2";\n\n// Returns 0 if v1 == v2, -1 if v1 < v2, 1 if v1 > v2\nfunction compareVersions( v1, v2 ) {\n\tvar i,\n\t\trVersionParts = /^(\\d+)\\.(\\d+)\\.(\\d+)/,\n\t\tv1p = rVersionParts.exec( v1 ) || [ ],\n\t\tv2p = rVersionParts.exec( v2 ) || [ ];\n\n\tfor ( i = 1; i <= 3; i++ ) {\n\t\tif ( +v1p[ i ] > +v2p[ i ] ) {\n\t\t\treturn 1;\n\t\t}\n\t\tif ( +v1p[ i ] < +v2p[ i ] ) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\treturn 0;\n}\n\nfunction jQueryVersionSince( version ) {\n\treturn compareVersions( jQuery.fn.jquery, version ) >= 0;\n}\n\n( function() {\n\n\t// Support: IE9 only\n\t// IE9 only creates console object when dev tools are first opened\n\t// IE9 console is a host object, callable but doesn\'t have .apply()\n\tif ( !window.console || !window.console.log ) {\n\t\treturn;\n\t}\n\n\t// Need jQuery 3.0.0+ and no older Migrate loaded\n\tif ( !jQuery || !jQueryVersionSince( "3.0.0" ) ) {\n\t\twindow.console.log( "JQMIGRATE: jQuery 3.0.0+ REQUIRED" );\n\t}\n\tif ( jQuery.migrateWarnings ) {\n\t\twindow.console.log( "JQMIGRATE: Migrate plugin loaded multiple times" );\n\t}\n\n\t// Show a message on the console so devs know we\'re active\n\twindow.console.log( "JQMIGRATE: Migrate is installed" +\n\t\t( jQuery.migrateMute ? "" : " with logging active" ) +\n\t\t", version " + jQuery.migrateVersion );\n\n} )();\n\nvar warnedAbout = {};\n\n// By default each warning is only reported once.\njQuery.migrateDeduplicateWarnings = true;\n\n// List of warnings already given; public read only\njQuery.migrateWarnings = [];\n\n// Set to false to disable traces that appear with warnings\nif ( jQuery.migrateTrace === undefined ) {\n\tjQuery.migrateTrace = true;\n}\n\n// Forget any warnings we\'ve already given; public\njQuery.migrateReset = function() {\n\twarnedAbout = {};\n\tjQuery.migrateWarnings.length = 0;\n};\n\nfunction migrateWarn( msg ) {\n\tvar console = window.console;\n\tif ( !jQuery.migrateDeduplicateWarnings || !warnedAbout[ msg ] ) {\n\t\twarnedAbout[ msg ] = true;\n\t\tjQuery.migrateWarnings.push( msg );\n\t\tif ( console && console.warn && !jQuery.migrateMute ) {\n\t\t\tconsole.warn( "JQMIGRATE: " + msg );\n\t\t\tif ( jQuery.migrateTrace && console.trace ) {\n\t\t\t\tconsole.trace();\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction migrateWarnProp( obj, prop, value, msg ) {\n\tObject.defineProperty( obj, prop, {\n\t\tconfigurable: true,\n\t\tenumerable: true,\n\t\tget: function() {\n\t\t\tmigrateWarn( msg );\n\t\t\treturn value;\n\t\t},\n\t\tset: function( newValue ) {\n\t\t\tmigrateWarn( msg );\n\t\t\tvalue = newValue;\n\t\t}\n\t} );\n}\n\nfunction migrateWarnFunc( obj, prop, newFunc, msg ) {\n\tobj[ prop ] = function() {\n\t\tmigrateWarn( msg );\n\t\treturn newFunc.apply( this, arguments );\n\t};\n}\n\nif ( window.document.compatMode === "BackCompat" ) {\n\n\t// JQuery has never supported or tested Quirks Mode\n\tmigrateWarn( "jQuery is not compatible with Quirks Mode" );\n}\n\nvar findProp,\n\tclass2type = {},\n\toldInit = jQuery.fn.init,\n\toldFind = jQuery.find,\n\n\trattrHashTest = /\\[(\\s*[-\\w]+\\s*)([~|^$*]?=)\\s*([-\\w#]*?#[-\\w#]*)\\s*\\]/,\n\trattrHashGlob = /\\[(\\s*[-\\w]+\\s*)([~|^$*]?=)\\s*([-\\w#]*?#[-\\w#]*)\\s*\\]/g,\n\n\t// Support: Android <=4.0 only\n\t// Make sure we trim BOM and NBSP\n\trtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n\njQuery.fn.init = function( arg1 ) {\n\tvar args = Array.prototype.slice.call( arguments );\n\n\tif ( typeof arg1 === "string" && arg1 === "#" ) {\n\n\t\t// JQuery( "#" ) is a bogus ID selector, but it returned an empty set before jQuery 3.0\n\t\tmigrateWarn( "jQuery( \'#\' ) is not a valid selector" );\n\t\targs[ 0 ] = [];\n\t}\n\n\treturn oldInit.apply( this, args );\n};\njQuery.fn.init.prototype = jQuery.fn;\n\njQuery.find = function( selector ) {\n\tvar args = Array.prototype.slice.call( arguments );\n\n\t// Support: PhantomJS 1.x\n\t// String#match fails to match when used with a //g RegExp, only on some strings\n\tif ( typeof selector === "string" && rattrHashTest.test( selector ) ) {\n\n\t\t// The nonstandard and undocumented unquoted-hash was removed in jQuery 1.12.0\n\t\t// First see if qS thinks it\'s a valid selector, if so avoid a false positive\n\t\ttry {\n\t\t\twindow.document.querySelector( selector );\n\t\t} catch ( err1 ) {\n\n\t\t\t// Didn\'t *look* valid to qSA, warn and try quoting what we think is the value\n\t\t\tselector = selector.replace( rattrHashGlob, function( _, attr, op, value ) {\n\t\t\t\treturn "[" + attr + op + "\\"" + value + "\\"]";\n\t\t\t} );\n\n\t\t\t// If the regexp *may* have created an invalid selector, don\'t update it\n\t\t\t// Note that there may be false alarms if selector uses jQuery extensions\n\t\t\ttry {\n\t\t\t\twindow.document.querySelector( selector );\n\t\t\t\tmigrateWarn( "Attribute selector with \'#\' must be quoted: " + args[ 0 ] );\n\t\t\t\targs[ 0 ] = selector;\n\t\t\t} catch ( err2 ) {\n\t\t\t\tmigrateWarn( "Attribute selector with \'#\' was not fixed: " + args[ 0 ] );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn oldFind.apply( this, args );\n};\n\n// Copy properties attached to original jQuery.find method (e.g. .attr, .isXML)\nfor ( findProp in oldFind ) {\n\tif ( Object.prototype.hasOwnProperty.call( oldFind, findProp ) ) {\n\t\tjQuery.find[ findProp ] = oldFind[ findProp ];\n\t}\n}\n\n// The number of elements contained in the matched element set\nmigrateWarnFunc( jQuery.fn, "size", function() {\n\treturn this.length;\n},\n"jQuery.fn.size() is deprecated and removed; use the .length property" );\n\nmigrateWarnFunc( jQuery, "parseJSON", function() {\n\treturn JSON.parse.apply( null, arguments );\n},\n"jQuery.parseJSON is deprecated; use JSON.parse" );\n\nmigrateWarnFunc( jQuery, "holdReady", jQuery.holdReady,\n\t"jQuery.holdReady is deprecated" );\n\nmigrateWarnFunc( jQuery, "unique", jQuery.uniqueSort,\n\t"jQuery.unique is deprecated; use jQuery.uniqueSort" );\n\n// Now jQuery.expr.pseudos is the standard incantation\nmigrateWarnProp( jQuery.expr, "filters", jQuery.expr.pseudos,\n\t"jQuery.expr.filters is deprecated; use jQuery.expr.pseudos" );\nmigrateWarnProp( jQuery.expr, ":", jQuery.expr.pseudos,\n\t"jQuery.expr[\':\'] is deprecated; use jQuery.expr.pseudos" );\n\n// Prior to jQuery 3.1.1 there were internal refs so we don\'t warn there\nif ( jQueryVersionSince( "3.1.1" ) ) {\n\tmigrateWarnFunc( jQuery, "trim", function( text ) {\n\t\treturn text == null ?\n\t\t\t"" :\n\t\t\t( text + "" ).replace( rtrim, "" );\n\t},\n\t"jQuery.trim is deprecated; use String.prototype.trim" );\n}\n\n// Prior to jQuery 3.2 there were internal refs so we don\'t warn there\nif ( jQueryVersionSince( "3.2.0" ) ) {\n\tmigrateWarnFunc( jQuery, "nodeName", function( elem, name ) {\n\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();\n\t},\n\t"jQuery.nodeName is deprecated" );\n\n\tmigrateWarnFunc( jQuery, "isArray", Array.isArray,\n\t\t"jQuery.isArray is deprecated; use Array.isArray"\n\t);\n}\n\nif ( jQueryVersionSince( "3.3.0" ) ) {\n\n\tmigrateWarnFunc( jQuery, "isNumeric", function( obj ) {\n\n\t\t\t// As of jQuery 3.0, isNumeric is limited to\n\t\t\t// strings and numbers (primitives or objects)\n\t\t\t// that can be coerced to finite numbers (gh-2662)\n\t\t\tvar type = typeof obj;\n\t\t\treturn ( type === "number" || type === "string" ) &&\n\n\t\t\t\t// parseFloat NaNs numeric-cast false positives ("")\n\t\t\t\t// ...but misinterprets leading-number strings, e.g. hex literals ("0x...")\n\t\t\t\t// subtraction forces infinities to NaN\n\t\t\t\t!isNaN( obj - parseFloat( obj ) );\n\t\t},\n\t\t"jQuery.isNumeric() is deprecated"\n\t);\n\n\t// Populate the class2type map\n\tjQuery.each( "Boolean Number String Function Array Date RegExp Object Error Symbol".\n\t\tsplit( " " ),\n\tfunction( _, name ) {\n\t\tclass2type[ "[object " + name + "]" ] = name.toLowerCase();\n\t} );\n\n\tmigrateWarnFunc( jQuery, "type", function( obj ) {\n\t\tif ( obj == null ) {\n\t\t\treturn obj + "";\n\t\t}\n\n\t\t// Support: Android <=2.3 only (functionish RegExp)\n\t\treturn typeof obj === "object" || typeof obj === "function" ?\n\t\t\tclass2type[ Object.prototype.toString.call( obj ) ] || "object" :\n\t\t\ttypeof obj;\n\t},\n\t"jQuery.type is deprecated" );\n\n\tmigrateWarnFunc( jQuery, "isFunction",\n\t\tfunction( obj ) {\n\t\t\treturn typeof obj === "function";\n\t\t},\n\t\t"jQuery.isFunction() is deprecated" );\n\n\tmigrateWarnFunc( jQuery, "isWindow",\n\t\tfunction( obj ) {\n\t\t\treturn obj != null && obj === obj.window;\n\t\t},\n\t\t"jQuery.isWindow() is deprecated"\n\t);\n}\n\n// Support jQuery slim which excludes the ajax module\nif ( jQuery.ajax ) {\n\nvar oldAjax = jQuery.ajax,\n\trjsonp = /(=)\\?(?=&|$)|\\?\\?/;\n\njQuery.ajax = function( ) {\n\tvar jQXHR = oldAjax.apply( this, arguments );\n\n\t// Be sure we got a jQXHR (e.g., not sync)\n\tif ( jQXHR.promise ) {\n\t\tmigrateWarnFunc( jQXHR, "success", jQXHR.done,\n\t\t\t"jQXHR.success is deprecated and removed" );\n\t\tmigrateWarnFunc( jQXHR, "error", jQXHR.fail,\n\t\t\t"jQXHR.error is deprecated and removed" );\n\t\tmigrateWarnFunc( jQXHR, "complete", jQXHR.always,\n\t\t\t"jQXHR.complete is deprecated and removed" );\n\t}\n\n\treturn jQXHR;\n};\n\n// Only trigger the logic in jQuery <4 as the JSON-to-JSONP auto-promotion\n// behavior is gone in jQuery 4.0 and as it has security implications, we don\'t\n// want to restore the legacy behavior.\nif ( !jQueryVersionSince( "4.0.0" ) ) {\n\n\t// Register this prefilter before the jQuery one. Otherwise, a promoted\n\t// request is transformed into one with the script dataType and we can\'t\n\t// catch it anymore.\n\tjQuery.ajaxPrefilter( "+json", function( s ) {\n\n\t\t// Warn if JSON-to-JSONP auto-promotion happens.\n\t\tif ( s.jsonp !== false && ( rjsonp.test( s.url ) ||\n\t\t\t\ttypeof s.data === "string" &&\n\t\t\t\t( s.contentType || "" )\n\t\t\t\t\t.indexOf( "application/x-www-form-urlencoded" ) === 0 &&\n\t\t\t\trjsonp.test( s.data )\n\t\t) ) {\n\t\t\tmigrateWarn( "JSON-to-JSONP auto-promotion is deprecated" );\n\t\t}\n\t} );\n}\n\n}\n\nvar oldRemoveAttr = jQuery.fn.removeAttr,\n\toldToggleClass = jQuery.fn.toggleClass,\n\trmatchNonSpace = /\\S+/g;\n\njQuery.fn.removeAttr = function( name ) {\n\tvar self = this;\n\n\tjQuery.each( name.match( rmatchNonSpace ), function( _i, attr ) {\n\t\tif ( jQuery.expr.match.bool.test( attr ) ) {\n\t\t\tmigrateWarn( "jQuery.fn.removeAttr no longer sets boolean properties: " + attr );\n\t\t\tself.prop( attr, false );\n\t\t}\n\t} );\n\n\treturn oldRemoveAttr.apply( this, arguments );\n};\n\njQuery.fn.toggleClass = function( state ) {\n\n\t// Only deprecating no-args or single boolean arg\n\tif ( state !== undefined && typeof state !== "boolean" ) {\n\t\treturn oldToggleClass.apply( this, arguments );\n\t}\n\n\tmigrateWarn( "jQuery.fn.toggleClass( boolean ) is deprecated" );\n\n\t// Toggle entire class name of each element\n\treturn this.each( function() {\n\t\tvar className = this.getAttribute && this.getAttribute( "class" ) || "";\n\n\t\tif ( className ) {\n\t\t\tjQuery.data( this, "__className__", className );\n\t\t}\n\n\t\t// If the element has a class name or if we\'re passed `false`,\n\t\t// then remove the whole classname (if there was one, the above saved it).\n\t\t// Otherwise bring back whatever was previously saved (if anything),\n\t\t// falling back to the empty string if nothing was stored.\n\t\tif ( this.setAttribute ) {\n\t\t\tthis.setAttribute( "class",\n\t\t\t\tclassName || state === false ?\n\t\t\t\t"" :\n\t\t\t\tjQuery.data( this, "__className__" ) || ""\n\t\t\t);\n\t\t}\n\t} );\n};\n\nfunction camelCase( string ) {\n\treturn string.replace( /-([a-z])/g, function( _, letter ) {\n\t\treturn letter.toUpperCase();\n\t} );\n}\n\nvar oldFnCss,\n\tinternalSwapCall = false,\n\tralphaStart = /^[a-z]/,\n\n\t// The regex visualized:\n\t//\n\t//                         /----------\\\n\t//                        |            |    /-------\\\n\t//                        |  / Top  \\  |   |         |\n\t//         /--- Border ---+-| Right  |-+---+- Width -+---\\\n\t//        |                 | Bottom |                    |\n\t//        |                  \\ Left /                     |\n\t//        |                                               |\n\t//        |                              /----------\\     |\n\t//        |          /-------------\\    |            |    |- END\n\t//        |         |               |   |  / Top  \\  |    |\n\t//        |         |  / Margin  \\  |   | | Right  | |    |\n\t//        |---------+-|           |-+---+-| Bottom |-+----|\n\t//        |            \\ Padding /         \\ Left /       |\n\t// BEGIN -|                                               |\n\t//        |                /---------\\                    |\n\t//        |               |           |                   |\n\t//        |               |  / Min \\  |    / Width  \\     |\n\t//         \\--------------+-|       |-+---|          |---/\n\t//                           \\ Max /       \\ Height /\n\trautoPx = /^(?:Border(?:Top|Right|Bottom|Left)?(?:Width|)|(?:Margin|Padding)?(?:Top|Right|Bottom|Left)?|(?:Min|Max)?(?:Width|Height))$/;\n\n// If this version of jQuery has .swap(), don\'t false-alarm on internal uses\nif ( jQuery.swap ) {\n\tjQuery.each( [ "height", "width", "reliableMarginRight" ], function( _, name ) {\n\t\tvar oldHook = jQuery.cssHooks[ name ] && jQuery.cssHooks[ name ].get;\n\n\t\tif ( oldHook ) {\n\t\t\tjQuery.cssHooks[ name ].get = function() {\n\t\t\t\tvar ret;\n\n\t\t\t\tinternalSwapCall = true;\n\t\t\t\tret = oldHook.apply( this, arguments );\n\t\t\t\tinternalSwapCall = false;\n\t\t\t\treturn ret;\n\t\t\t};\n\t\t}\n\t} );\n}\n\njQuery.swap = function( elem, options, callback, args ) {\n\tvar ret, name,\n\t\told = {};\n\n\tif ( !internalSwapCall ) {\n\t\tmigrateWarn( "jQuery.swap() is undocumented and deprecated" );\n\t}\n\n\t// Remember the old values, and insert the new ones\n\tfor ( name in options ) {\n\t\told[ name ] = elem.style[ name ];\n\t\telem.style[ name ] = options[ name ];\n\t}\n\n\tret = callback.apply( elem, args || [] );\n\n\t// Revert the old values\n\tfor ( name in options ) {\n\t\telem.style[ name ] = old[ name ];\n\t}\n\n\treturn ret;\n};\n\nif ( jQueryVersionSince( "3.4.0" ) && typeof Proxy !== "undefined" ) {\n\n\tjQuery.cssProps = new Proxy( jQuery.cssProps || {}, {\n\t\tset: function() {\n\t\t\tmigrateWarn( "JQMIGRATE: jQuery.cssProps is deprecated" );\n\t\t\treturn Reflect.set.apply( this, arguments );\n\t\t}\n\t} );\n}\n\n// Create a dummy jQuery.cssNumber if missing. It won\'t be used by jQuery but\n// it will prevent code adding new keys to it unconditionally from crashing.\nif ( !jQuery.cssNumber ) {\n\tjQuery.cssNumber = {};\n}\n\nfunction isAutoPx( prop ) {\n\n\t// The first test is used to ensure that:\n\t// 1. The prop starts with a lowercase letter (as we uppercase it for the second regex).\n\t// 2. The prop is not empty.\n\treturn ralphaStart.test( prop ) &&\n\t\trautoPx.test( prop[ 0 ].toUpperCase() + prop.slice( 1 ) );\n}\n\noldFnCss = jQuery.fn.css;\n\njQuery.fn.css = function( name, value ) {\n\tvar camelName,\n\t\torigThis = this;\n\tif ( name && typeof name === "object" && !Array.isArray( name ) ) {\n\t\tjQuery.each( name, function( n, v ) {\n\t\t\tjQuery.fn.css.call( origThis, n, v );\n\t\t} );\n\t\treturn this;\n\t}\n\tif ( typeof value === "number" ) {\n\t\tcamelName = camelCase( name );\n\t\tif ( !isAutoPx( camelName ) && !jQuery.cssNumber[ camelName ] ) {\n\t\t\tmigrateWarn( "Number-typed values are deprecated for jQuery.fn.css( \\"" +\n\t\t\t\tname + "\\", value )" );\n\t\t}\n\t}\n\n\treturn oldFnCss.apply( this, arguments );\n};\n\nvar oldData = jQuery.data;\n\njQuery.data = function( elem, name, value ) {\n\tvar curData, sameKeys, key;\n\n\t// Name can be an object, and each entry in the object is meant to be set as data\n\tif ( name && typeof name === "object" && arguments.length === 2 ) {\n\t\tcurData = jQuery.hasData( elem ) && oldData.call( this, elem );\n\t\tsameKeys = {};\n\t\tfor ( key in name ) {\n\t\t\tif ( key !== camelCase( key ) ) {\n\t\t\t\tmigrateWarn( "jQuery.data() always sets/gets camelCased names: " + key );\n\t\t\t\tcurData[ key ] = name[ key ];\n\t\t\t} else {\n\t\t\t\tsameKeys[ key ] = name[ key ];\n\t\t\t}\n\t\t}\n\n\t\toldData.call( this, elem, sameKeys );\n\n\t\treturn name;\n\t}\n\n\t// If the name is transformed, look for the un-transformed name in the data object\n\tif ( name && typeof name === "string" && name !== camelCase( name ) ) {\n\t\tcurData = jQuery.hasData( elem ) && oldData.call( this, elem );\n\t\tif ( curData && name in curData ) {\n\t\t\tmigrateWarn( "jQuery.data() always sets/gets camelCased names: " + name );\n\t\t\tif ( arguments.length > 2 ) {\n\t\t\t\tcurData[ name ] = value;\n\t\t\t}\n\t\t\treturn curData[ name ];\n\t\t}\n\t}\n\n\treturn oldData.apply( this, arguments );\n};\n\n// Support jQuery slim which excludes the effects module\nif ( jQuery.fx ) {\n\nvar intervalValue, intervalMsg,\n\toldTweenRun = jQuery.Tween.prototype.run,\n\tlinearEasing = function( pct ) {\n\t\treturn pct;\n\t};\n\njQuery.Tween.prototype.run = function( ) {\n\tif ( jQuery.easing[ this.easing ].length > 1 ) {\n\t\tmigrateWarn(\n\t\t\t"\'jQuery.easing." + this.easing.toString() + "\' should use only one argument"\n\t\t);\n\n\t\tjQuery.easing[ this.easing ] = linearEasing;\n\t}\n\n\toldTweenRun.apply( this, arguments );\n};\n\nintervalValue = jQuery.fx.interval || 13;\nintervalMsg = "jQuery.fx.interval is deprecated";\n\n// Support: IE9, Android <=4.4\n// Avoid false positives on browsers that lack rAF\n// Don\'t warn if document is hidden, jQuery uses setTimeout (#292)\nif ( window.requestAnimationFrame ) {\n\tObject.defineProperty( jQuery.fx, "interval", {\n\t\tconfigurable: true,\n\t\tenumerable: true,\n\t\tget: function() {\n\t\t\tif ( !window.document.hidden ) {\n\t\t\t\tmigrateWarn( intervalMsg );\n\t\t\t}\n\t\t\treturn intervalValue;\n\t\t},\n\t\tset: function( newValue ) {\n\t\t\tmigrateWarn( intervalMsg );\n\t\t\tintervalValue = newValue;\n\t\t}\n\t} );\n}\n\n}\n\nvar oldLoad = jQuery.fn.load,\n\toldEventAdd = jQuery.event.add,\n\toriginalFix = jQuery.event.fix;\n\njQuery.event.props = [];\njQuery.event.fixHooks = {};\n\nmigrateWarnProp( jQuery.event.props, "concat", jQuery.event.props.concat,\n\t"jQuery.event.props.concat() is deprecated and removed" );\n\njQuery.event.fix = function( originalEvent ) {\n\tvar event,\n\t\ttype = originalEvent.type,\n\t\tfixHook = this.fixHooks[ type ],\n\t\tprops = jQuery.event.props;\n\n\tif ( props.length ) {\n\t\tmigrateWarn( "jQuery.event.props are deprecated and removed: " + props.join() );\n\t\twhile ( props.length ) {\n\t\t\tjQuery.event.addProp( props.pop() );\n\t\t}\n\t}\n\n\tif ( fixHook && !fixHook._migrated_ ) {\n\t\tfixHook._migrated_ = true;\n\t\tmigrateWarn( "jQuery.event.fixHooks are deprecated and removed: " + type );\n\t\tif ( ( props = fixHook.props ) && props.length ) {\n\t\t\twhile ( props.length ) {\n\t\t\t\tjQuery.event.addProp( props.pop() );\n\t\t\t}\n\t\t}\n\t}\n\n\tevent = originalFix.call( this, originalEvent );\n\n\treturn fixHook && fixHook.filter ? fixHook.filter( event, originalEvent ) : event;\n};\n\njQuery.event.add = function( elem, types ) {\n\n\t// This misses the multiple-types case but that seems awfully rare\n\tif ( elem === window && types === "load" && window.document.readyState === "complete" ) {\n\t\tmigrateWarn( "jQuery(window).on(\'load\'...) called after load event occurred" );\n\t}\n\treturn oldEventAdd.apply( this, arguments );\n};\n\njQuery.each( [ "load", "unload", "error" ], function( _, name ) {\n\n\tjQuery.fn[ name ] = function() {\n\t\tvar args = Array.prototype.slice.call( arguments, 0 );\n\n\t\t// If this is an ajax load() the first arg should be the string URL;\n\t\t// technically this could also be the "Anything" arg of the event .load()\n\t\t// which just goes to show why this dumb signature has been deprecated!\n\t\t// jQuery custom builds that exclude the Ajax module justifiably die here.\n\t\tif ( name === "load" && typeof args[ 0 ] === "string" ) {\n\t\t\treturn oldLoad.apply( this, args );\n\t\t}\n\n\t\tmigrateWarn( "jQuery.fn." + name + "() is deprecated" );\n\n\t\targs.splice( 0, 0, name );\n\t\tif ( arguments.length ) {\n\t\t\treturn this.on.apply( this, args );\n\t\t}\n\n\t\t// Use .triggerHandler here because:\n\t\t// - load and unload events don\'t need to bubble, only applied to window or image\n\t\t// - error event should not bubble to window, although it does pre-1.7\n\t\t// See http://bugs.jquery.com/ticket/11820\n\t\tthis.triggerHandler.apply( this, args );\n\t\treturn this;\n\t};\n\n} );\n\njQuery.each( ( "blur focus focusin focusout resize scroll click dblclick " +\n\t"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +\n\t"change select submit keydown keypress keyup contextmenu" ).split( " " ),\n\tfunction( _i, name ) {\n\n\t// Handle event binding\n\tjQuery.fn[ name ] = function( data, fn ) {\n\t\tmigrateWarn( "jQuery.fn." + name + "() event shorthand is deprecated" );\n\t\treturn arguments.length > 0 ?\n\t\t\tthis.on( name, null, data, fn ) :\n\t\t\tthis.trigger( name );\n\t};\n} );\n\n// Trigger "ready" event only once, on document ready\njQuery( function() {\n\tjQuery( window.document ).triggerHandler( "ready" );\n} );\n\njQuery.event.special.ready = {\n\tsetup: function() {\n\t\tif ( this === window.document ) {\n\t\t\tmigrateWarn( "\'ready\' event is deprecated" );\n\t\t}\n\t}\n};\n\njQuery.fn.extend( {\n\n\tbind: function( types, data, fn ) {\n\t\tmigrateWarn( "jQuery.fn.bind() is deprecated" );\n\t\treturn this.on( types, null, data, fn );\n\t},\n\tunbind: function( types, fn ) {\n\t\tmigrateWarn( "jQuery.fn.unbind() is deprecated" );\n\t\treturn this.off( types, null, fn );\n\t},\n\tdelegate: function( selector, types, data, fn ) {\n\t\tmigrateWarn( "jQuery.fn.delegate() is deprecated" );\n\t\treturn this.on( types, selector, data, fn );\n\t},\n\tundelegate: function( selector, types, fn ) {\n\t\tmigrateWarn( "jQuery.fn.undelegate() is deprecated" );\n\t\treturn arguments.length === 1 ?\n\t\t\tthis.off( selector, "**" ) :\n\t\t\tthis.off( types, selector || "**", fn );\n\t},\n\thover: function( fnOver, fnOut ) {\n\t\tmigrateWarn( "jQuery.fn.hover() is deprecated" );\n\t\treturn this.on( "mouseenter", fnOver ).on( "mouseleave", fnOut || fnOver );\n\t}\n} );\n\nvar rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\\/\\0>\\x20\\t\\r\\n\\f]*)[^>]*)\\/>/gi,\n\torigHtmlPrefilter = jQuery.htmlPrefilter,\n\tmakeMarkup = function( html ) {\n\t\tvar doc = window.document.implementation.createHTMLDocument( "" );\n\t\tdoc.body.innerHTML = html;\n\t\treturn doc.body && doc.body.innerHTML;\n\t},\n\twarnIfChanged = function( html ) {\n\t\tvar changed = html.replace( rxhtmlTag, "<$1></$2>" );\n\t\tif ( changed !== html && makeMarkup( html ) !== makeMarkup( changed ) ) {\n\t\t\tmigrateWarn( "HTML tags must be properly nested and closed: " + html );\n\t\t}\n\t};\n\njQuery.UNSAFE_restoreLegacyHtmlPrefilter = function() {\n\tjQuery.htmlPrefilter = function( html ) {\n\t\twarnIfChanged( html );\n\t\treturn html.replace( rxhtmlTag, "<$1></$2>" );\n\t};\n};\n\njQuery.htmlPrefilter = function( html ) {\n\twarnIfChanged( html );\n\treturn origHtmlPrefilter( html );\n};\n\nvar oldOffset = jQuery.fn.offset;\n\njQuery.fn.offset = function() {\n\tvar elem = this[ 0 ];\n\n\tif ( elem && ( !elem.nodeType || !elem.getBoundingClientRect ) ) {\n\t\tmigrateWarn( "jQuery.fn.offset() requires a valid DOM element" );\n\t\treturn arguments.length ? this : undefined;\n\t}\n\n\treturn oldOffset.apply( this, arguments );\n};\n\n// Support jQuery slim which excludes the ajax module\n// The jQuery.param patch is about respecting `jQuery.ajaxSettings.traditional`\n// so it doesn\'t make sense for the slim build.\nif ( jQuery.ajax ) {\n\nvar oldParam = jQuery.param;\n\njQuery.param = function( data, traditional ) {\n\tvar ajaxTraditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;\n\n\tif ( traditional === undefined && ajaxTraditional ) {\n\n\t\tmigrateWarn( "jQuery.param() no longer uses jQuery.ajaxSettings.traditional" );\n\t\ttraditional = ajaxTraditional;\n\t}\n\n\treturn oldParam.call( this, data, traditional );\n};\n\n}\n\nvar oldSelf = jQuery.fn.andSelf || jQuery.fn.addBack;\n\njQuery.fn.andSelf = function() {\n\tmigrateWarn( "jQuery.fn.andSelf() is deprecated and removed, use jQuery.fn.addBack()" );\n\treturn oldSelf.apply( this, arguments );\n};\n\n// Support jQuery slim which excludes the deferred module in jQuery 4.0+\nif ( jQuery.Deferred ) {\n\nvar oldDeferred = jQuery.Deferred,\n\ttuples = [\n\n\t\t// Action, add listener, callbacks, .then handlers, final state\n\t\t[ "resolve", "done", jQuery.Callbacks( "once memory" ),\n\t\t\tjQuery.Callbacks( "once memory" ), "resolved" ],\n\t\t[ "reject", "fail", jQuery.Callbacks( "once memory" ),\n\t\t\tjQuery.Callbacks( "once memory" ), "rejected" ],\n\t\t[ "notify", "progress", jQuery.Callbacks( "memory" ),\n\t\t\tjQuery.Callbacks( "memory" ) ]\n\t];\n\njQuery.Deferred = function( func ) {\n\tvar deferred = oldDeferred(),\n\t\tpromise = deferred.promise();\n\n\tdeferred.pipe = promise.pipe = function( /* fnDone, fnFail, fnProgress */ ) {\n\t\tvar fns = arguments;\n\n\t\tmigrateWarn( "deferred.pipe() is deprecated" );\n\n\t\treturn jQuery.Deferred( function( newDefer ) {\n\t\t\tjQuery.each( tuples, function( i, tuple ) {\n\t\t\t\tvar fn = typeof fns[ i ] === "function" && fns[ i ];\n\n\t\t\t\t// Deferred.done(function() { bind to newDefer or newDefer.resolve })\n\t\t\t\t// deferred.fail(function() { bind to newDefer or newDefer.reject })\n\t\t\t\t// deferred.progress(function() { bind to newDefer or newDefer.notify })\n\t\t\t\tdeferred[ tuple[ 1 ] ]( function() {\n\t\t\t\t\tvar returned = fn && fn.apply( this, arguments );\n\t\t\t\t\tif ( returned && typeof returned.promise === "function" ) {\n\t\t\t\t\t\treturned.promise()\n\t\t\t\t\t\t\t.done( newDefer.resolve )\n\t\t\t\t\t\t\t.fail( newDefer.reject )\n\t\t\t\t\t\t\t.progress( newDefer.notify );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewDefer[ tuple[ 0 ] + "With" ](\n\t\t\t\t\t\t\tthis === promise ? newDefer.promise() : this,\n\t\t\t\t\t\t\tfn ? [ returned ] : arguments\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\t\t\tfns = null;\n\t\t} ).promise();\n\n\t};\n\n\tif ( func ) {\n\t\tfunc.call( deferred, deferred );\n\t}\n\n\treturn deferred;\n};\n\n// Preserve handler of uncaught exceptions in promise chains\njQuery.Deferred.exceptionHook = oldDeferred.exceptionHook;\n\n}\n\nreturn jQuery;\n} );\n'},function(t,e,n){n(10)(n(328))},function(t,e){t.exports="/*!\n * jQuery Mousewheel 3.1.13\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license\n * http://jquery.org/license\n */\n\n(function (factory) {\n    if ( typeof define === 'function' && define.amd ) {\n        // AMD. Register as an anonymous module.\n        define(['jquery'], factory);\n    } else if (typeof exports === 'object') {\n        // Node/CommonJS style for Browserify\n        module.exports = factory;\n    } else {\n        // Browser globals\n        factory(jQuery);\n    }\n}(function ($) {\n\n    var toFix  = ['wheel', 'mousewheel', 'DOMMouseScroll', 'MozMousePixelScroll'],\n        toBind = ( 'onwheel' in document || document.documentMode >= 9 ) ?\n                    ['wheel'] : ['mousewheel', 'DomMouseScroll', 'MozMousePixelScroll'],\n        slice  = Array.prototype.slice,\n        nullLowestDeltaTimeout, lowestDelta;\n\n    if ( $.event.fixHooks ) {\n        for ( var i = toFix.length; i; ) {\n            $.event.fixHooks[ toFix[--i] ] = $.event.mouseHooks;\n        }\n    }\n\n    var special = $.event.special.mousewheel = {\n        version: '3.1.12',\n\n        setup: function() {\n            if ( this.addEventListener ) {\n                for ( var i = toBind.length; i; ) {\n                    this.addEventListener( toBind[--i], handler, false );\n                }\n            } else {\n                this.onmousewheel = handler;\n            }\n            // Store the line height and page height for this particular element\n            $.data(this, 'mousewheel-line-height', special.getLineHeight(this));\n            $.data(this, 'mousewheel-page-height', special.getPageHeight(this));\n        },\n\n        teardown: function() {\n            if ( this.removeEventListener ) {\n                for ( var i = toBind.length; i; ) {\n                    this.removeEventListener( toBind[--i], handler, false );\n                }\n            } else {\n                this.onmousewheel = null;\n            }\n            // Clean up the data we added to the element\n            $.removeData(this, 'mousewheel-line-height');\n            $.removeData(this, 'mousewheel-page-height');\n        },\n\n        getLineHeight: function(elem) {\n            var $elem = $(elem),\n                $parent = $elem['offsetParent' in $.fn ? 'offsetParent' : 'parent']();\n            if (!$parent.length) {\n                $parent = $('body');\n            }\n            return parseInt($parent.css('fontSize'), 10) || parseInt($elem.css('fontSize'), 10) || 16;\n        },\n\n        getPageHeight: function(elem) {\n            return $(elem).height();\n        },\n\n        settings: {\n            adjustOldDeltas: true, // see shouldAdjustOldDeltas() below\n            normalizeOffset: true  // calls getBoundingClientRect for each event\n        }\n    };\n\n    $.fn.extend({\n        mousewheel: function(fn) {\n            return fn ? this.bind('mousewheel', fn) : this.trigger('mousewheel');\n        },\n\n        unmousewheel: function(fn) {\n            return this.unbind('mousewheel', fn);\n        }\n    });\n\n\n    function handler(event) {\n        var orgEvent   = event || window.event,\n            args       = slice.call(arguments, 1),\n            delta      = 0,\n            deltaX     = 0,\n            deltaY     = 0,\n            absDelta   = 0,\n            offsetX    = 0,\n            offsetY    = 0;\n        event = $.event.fix(orgEvent);\n        event.type = 'mousewheel';\n\n        // Old school scrollwheel delta\n        if ( 'detail'      in orgEvent ) { deltaY = orgEvent.detail * -1;      }\n        if ( 'wheelDelta'  in orgEvent ) { deltaY = orgEvent.wheelDelta;       }\n        if ( 'wheelDeltaY' in orgEvent ) { deltaY = orgEvent.wheelDeltaY;      }\n        if ( 'wheelDeltaX' in orgEvent ) { deltaX = orgEvent.wheelDeltaX * -1; }\n\n        // Firefox < 17 horizontal scrolling related to DOMMouseScroll event\n        if ( 'axis' in orgEvent && orgEvent.axis === orgEvent.HORIZONTAL_AXIS ) {\n            deltaX = deltaY * -1;\n            deltaY = 0;\n        }\n\n        // Set delta to be deltaY or deltaX if deltaY is 0 for backwards compatabilitiy\n        delta = deltaY === 0 ? deltaX : deltaY;\n\n        // New school wheel delta (wheel event)\n        if ( 'deltaY' in orgEvent ) {\n            deltaY = orgEvent.deltaY * -1;\n            delta  = deltaY;\n        }\n        if ( 'deltaX' in orgEvent ) {\n            deltaX = orgEvent.deltaX;\n            if ( deltaY === 0 ) { delta  = deltaX * -1; }\n        }\n\n        // No change actually happened, no reason to go any further\n        if ( deltaY === 0 && deltaX === 0 ) { return; }\n\n        // Need to convert lines and pages to pixels if we aren't already in pixels\n        // There are three delta modes:\n        //   * deltaMode 0 is by pixels, nothing to do\n        //   * deltaMode 1 is by lines\n        //   * deltaMode 2 is by pages\n        if ( orgEvent.deltaMode === 1 ) {\n            var lineHeight = $.data(this, 'mousewheel-line-height');\n            delta  *= lineHeight;\n            deltaY *= lineHeight;\n            deltaX *= lineHeight;\n        } else if ( orgEvent.deltaMode === 2 ) {\n            var pageHeight = $.data(this, 'mousewheel-page-height');\n            delta  *= pageHeight;\n            deltaY *= pageHeight;\n            deltaX *= pageHeight;\n        }\n\n        // Store lowest absolute delta to normalize the delta values\n        absDelta = Math.max( Math.abs(deltaY), Math.abs(deltaX) );\n\n        if ( !lowestDelta || absDelta < lowestDelta ) {\n            lowestDelta = absDelta;\n\n            // Adjust older deltas if necessary\n            if ( shouldAdjustOldDeltas(orgEvent, absDelta) ) {\n                lowestDelta /= 40;\n            }\n        }\n\n        // Adjust older deltas if necessary\n        if ( shouldAdjustOldDeltas(orgEvent, absDelta) ) {\n            // Divide all the things by 40!\n            delta  /= 40;\n            deltaX /= 40;\n            deltaY /= 40;\n        }\n\n        // Get a whole, normalized value for the deltas\n        delta  = Math[ delta  >= 1 ? 'floor' : 'ceil' ](delta  / lowestDelta);\n        deltaX = Math[ deltaX >= 1 ? 'floor' : 'ceil' ](deltaX / lowestDelta);\n        deltaY = Math[ deltaY >= 1 ? 'floor' : 'ceil' ](deltaY / lowestDelta);\n\n        // Normalise offsetX and offsetY properties\n        if ( special.settings.normalizeOffset && this.getBoundingClientRect ) {\n            var boundingRect = this.getBoundingClientRect();\n            offsetX = event.clientX - boundingRect.left;\n            offsetY = event.clientY - boundingRect.top;\n        }\n\n        // Add information to the event object\n        event.deltaX = deltaX;\n        event.deltaY = deltaY;\n        event.deltaFactor = lowestDelta;\n        event.offsetX = offsetX;\n        event.offsetY = offsetY;\n        // Go ahead and set deltaMode to 0 since we converted to pixels\n        // Although this is a little odd since we overwrite the deltaX/Y\n        // properties with normalized deltas.\n        event.deltaMode = 0;\n\n        // Add event and delta to the front of the arguments\n        args.unshift(event, delta, deltaX, deltaY);\n\n        // Clearout lowestDelta after sometime to better\n        // handle multiple device types that give different\n        // a different lowestDelta\n        // Ex: trackpad = 3 and mouse wheel = 120\n        if (nullLowestDeltaTimeout) { clearTimeout(nullLowestDeltaTimeout); }\n        nullLowestDeltaTimeout = setTimeout(nullLowestDelta, 200);\n\n        return ($.event.dispatch || $.event.handle).apply(this, args);\n    }\n\n    function nullLowestDelta() {\n        lowestDelta = null;\n    }\n\n    function shouldAdjustOldDeltas(orgEvent, absDelta) {\n        // If this is an older event and the delta is divisable by 120,\n        // then we are assuming that the browser is treating this as an\n        // older mouse wheel event and that we should divide the deltas\n        // by 40 to try and get a more usable deltaFactor.\n        // Side note, this actually impacts the reported scroll distance\n        // in older browsers and can cause scrolling to be slower than native.\n        // Turn this off by setting $.event.special.mousewheel.settings.adjustOldDeltas to false.\n        return special.settings.adjustOldDeltas && orgEvent.type === 'mousewheel' && absDelta % 120 === 0;\n    }\n\n}));\n"},function(t,e,n){n(10)(n(330))},function(t,e){t.exports="/*!\n * iScroll v4.2.5 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org\n * Released under MIT license, http://cubiq.org/license\n */\n\nif (!document.querySelectorAll) {\n    function getElementsByClassName(node, classname) {\n        var a = [];\n        var re = new RegExp('(^| )'+classname+'( |$)');\n        var els = node.getElementsByTagName(\"*\");\n        for(var i=0,j=els.length; i<j; i++)\n            if(re.test(els[i].className))a.push(els[i]);\n        return a;\n    }\n}\n\n(function(window, doc){\nvar m = Math,\n\tdummyStyle = doc.createElement('div').style,\n\tvendor = (function () {\n\t\tvar vendors = 't,webkitT,MozT,msT,OT'.split(','),\n\t\t\tt,\n\t\t\ti = 0,\n\t\t\tl = vendors.length;\n\n\t\tfor ( ; i < l; i++ ) {\n\t\t\tt = vendors[i] + 'ransform';\n\t\t\tif ( t in dummyStyle ) {\n\t\t\t\treturn vendors[i].substr(0, vendors[i].length - 1);\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t})(),\n\tcssVendor = vendor ? '-' + vendor.toLowerCase() + '-' : '',\n\n\t// Style properties\n\ttransform = prefixStyle('transform'),\n\ttransitionProperty = prefixStyle('transitionProperty'),\n\ttransitionDuration = prefixStyle('transitionDuration'),\n\ttransformOrigin = prefixStyle('transformOrigin'),\n\ttransitionTimingFunction = prefixStyle('transitionTimingFunction'),\n\ttransitionDelay = prefixStyle('transitionDelay'),\n\n    // Browser capabilities\n\tisAndroid = (/android/gi).test(navigator.appVersion),\n\tisIDevice = (/iphone|ipad/gi).test(navigator.appVersion),\n\tisTouchPad = (/hp-tablet/gi).test(navigator.appVersion),\n\n    has3d = prefixStyle('perspective') in dummyStyle,\n    hasTouch = 'ontouchstart' in window && !isTouchPad,\n    hasTransform = vendor !== false,\n    hasTransitionEnd = prefixStyle('transition') in dummyStyle,\n\n\tRESIZE_EV = 'onorientationchange' in window ? 'orientationchange' : 'resize',\n\tSTART_EV = hasTouch ? 'touchstart' : 'mousedown',\n\tMOVE_EV = hasTouch ? 'touchmove' : 'mousemove',\n\tEND_EV = hasTouch ? 'touchend' : 'mouseup',\n\tCANCEL_EV = hasTouch ? 'touchcancel' : 'mouseup',\n\tTRNEND_EV = (function () {\n\t\tif ( vendor === false ) return false;\n\n\t\tvar transitionEnd = {\n\t\t\t\t''\t\t\t: 'transitionend',\n\t\t\t\t'webkit'\t: 'webkitTransitionEnd',\n\t\t\t\t'Moz'\t\t: 'transitionend',\n\t\t\t\t'O'\t\t\t: 'otransitionend',\n\t\t\t\t'ms'\t\t: 'MSTransitionEnd'\n\t\t\t};\n\n\t\treturn transitionEnd[vendor];\n\t})(),\n\n\tnextFrame = (function() {\n\t\treturn window.requestAnimationFrame ||\n\t\t\twindow.webkitRequestAnimationFrame ||\n\t\t\twindow.mozRequestAnimationFrame ||\n\t\t\twindow.oRequestAnimationFrame ||\n\t\t\twindow.msRequestAnimationFrame ||\n\t\t\tfunction(callback) { return setTimeout(callback, 1); };\n\t})(),\n\tcancelFrame = (function () {\n\t\treturn window.cancelRequestAnimationFrame ||\n\t\t\twindow.webkitCancelAnimationFrame ||\n\t\t\twindow.webkitCancelRequestAnimationFrame ||\n\t\t\twindow.mozCancelRequestAnimationFrame ||\n\t\t\twindow.oCancelRequestAnimationFrame ||\n\t\t\twindow.msCancelRequestAnimationFrame ||\n\t\t\tclearTimeout;\n\t})(),\n\n\t// Helpers\n\ttranslateZ = has3d ? ' translateZ(0)' : '',\n\n\t// Constructor\n\tiScroll = function (el, options) {\n\t\tvar that = this,\n\t\t\ti;\n\n\t\tthat.wrapper = typeof el == 'object' ? el : doc.getElementById(el);\n\t\tthat.wrapper.style.overflow = 'hidden';\n\t\tthat.scroller = that.wrapper.children[0];\n\n\t\t// Default options\n\t\tthat.options = {\n\t\t\thScroll: true,\n\t\t\tvScroll: true,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\tbounce: true,\n\t\t\tbounceLock: false,\n\t\t\tmomentum: true,\n\t\t\tlockDirection: true,\n\t\t\tuseTransform: true,\n\t\t\tuseTransition: false,\n\t\t\ttopOffset: 0,\n\t\t\tcheckDOMChanges: false,\t\t// Experimental\n\t\t\thandleClick: true,\n\n\t\t\t// Scrollbar\n\t\t\thScrollbar: true,\n\t\t\tvScrollbar: true,\n\t\t\tfixedScrollbar: isAndroid,\n\t\t\thideScrollbar: isIDevice,\n\t\t\tfadeScrollbar: isIDevice && has3d,\n\t\t\tscrollbarClass: '',\n\n\t\t\t// Zoom\n\t\t\tzoom: false,\n\t\t\tzoomMin: 1,\n\t\t\tzoomMax: 4,\n\t\t\tdoubleTapZoom: 2,\n\t\t\twheelAction: 'scroll',\n\n\t\t\t// Snap\n\t\t\tsnap: false,\n\t\t\tsnapThreshold: 1,\n\n\t\t\t// Events\n\t\t\tonRefresh: null,\n\t\t\tonBeforeScrollStart: function (e) { e.preventDefault(); },\n\t\t\tonScrollStart: null,\n\t\t\tonBeforeScrollMove: null,\n\t\t\tonScrollMove: null,\n\t\t\tonBeforeScrollEnd: null,\n\t\t\tonScrollEnd: null,\n\t\t\tonTouchEnd: null,\n\t\t\tonDestroy: null,\n\t\t\tonZoomStart: null,\n\t\t\tonZoom: null,\n\t\t\tonZoomEnd: null\n\t\t};\n\n\t\t// User defined options\n\t\tfor (i in options) that.options[i] = options[i];\n\t\t\n\t\t// Set starting position\n\t\tthat.x = that.options.x;\n\t\tthat.y = that.options.y;\n\n\t\t// Normalize options\n\t\tthat.options.useTransform = hasTransform && that.options.useTransform;\n\t\tthat.options.hScrollbar = that.options.hScroll && that.options.hScrollbar;\n\t\tthat.options.vScrollbar = that.options.vScroll && that.options.vScrollbar;\n\t\tthat.options.zoom = that.options.useTransform && that.options.zoom;\n\t\tthat.options.useTransition = hasTransitionEnd && that.options.useTransition;\n\n\t\t// Helpers FIX ANDROID BUG!\n\t\t// translate3d and scale doesn't work together!\n\t\t// Ignoring 3d ONLY WHEN YOU SET that.options.zoom\n\t\tif ( that.options.zoom && isAndroid ){\n\t\t\ttranslateZ = '';\n\t\t}\n\t\t\n\t\t// Set some default styles\n\t\tthat.scroller.style[transitionProperty] = that.options.useTransform ? cssVendor + 'transform' : 'top left';\n\t\tthat.scroller.style[transitionDuration] = '0';\n\t\tthat.scroller.style[transformOrigin] = '0 0';\n\t\tif (that.options.useTransition) that.scroller.style[transitionTimingFunction] = 'cubic-bezier(0.33,0.66,0.66,1)';\n\t\t\n\t\tif (that.options.useTransform) that.scroller.style[transform] = 'translate(' + that.x + 'px,' + that.y + 'px)' + translateZ;\n\t\telse that.scroller.style.cssText += ';position:absolute;top:' + that.y + 'px;left:' + that.x + 'px';\n\n\t\tif (that.options.useTransition) that.options.fixedScrollbar = true;\n\n\t\tthat.refresh();\n\n\t\tthat._bind(RESIZE_EV, window);\n\t\tthat._bind(START_EV);\n\t\tif (!hasTouch) {\n\t\t\tif (that.options.wheelAction != 'none') {\n\t\t\t\tthat._bind('DOMMouseScroll');\n\t\t\t\tthat._bind('mousewheel');\n\t\t\t}\n\t\t}\n\n\t\tif (that.options.checkDOMChanges) that.checkDOMTime = setInterval(function () {\n\t\t\tthat._checkDOMChanges();\n\t\t}, 500);\n\t};\n\n// Prototype\niScroll.prototype = {\n\tenabled: true,\n\tx: 0,\n\ty: 0,\n\tsteps: [],\n\tscale: 1,\n\tcurrPageX: 0, currPageY: 0,\n\tpagesX: [], pagesY: [],\n\taniTime: null,\n\twheelZoomCount: 0,\n\t\n\thandleEvent: function (e) {\n\t\tvar that = this;\n\t\tswitch(e.type) {\n\t\t\tcase START_EV:\n\t\t\t\tif (!hasTouch && e.button !== 0) return;\n\t\t\t\tthat._start(e);\n\t\t\t\tbreak;\n\t\t\tcase MOVE_EV: that._move(e); break;\n\t\t\tcase END_EV:\n\t\t\tcase CANCEL_EV: that._end(e); break;\n\t\t\tcase RESIZE_EV: that._resize(); break;\n\t\t\tcase 'DOMMouseScroll': case 'mousewheel': that._wheel(e); break;\n\t\t\tcase TRNEND_EV: that._transitionEnd(e); break;\n\t\t}\n\t},\n\t\n\t_checkDOMChanges: function () {\n\t\tif (this.moved || this.zoomed || this.animating ||\n\t\t\t(this.scrollerW == this.scroller.offsetWidth * this.scale && this.scrollerH == this.scroller.offsetHeight * this.scale)) return;\n\n\t\tthis.refresh();\n\t},\n\t\n\t_scrollbar: function (dir) {\n\t\tvar that = this,\n\t\t\tbar;\n\n\t\tif (!that[dir + 'Scrollbar']) {\n\t\t\tif (that[dir + 'ScrollbarWrapper']) {\n\t\t\t\tif (hasTransform) that[dir + 'ScrollbarIndicator'].style[transform] = '';\n\t\t\t\tthat[dir + 'ScrollbarWrapper'].parentNode.removeChild(that[dir + 'ScrollbarWrapper']);\n\t\t\t\tthat[dir + 'ScrollbarWrapper'] = null;\n\t\t\t\tthat[dir + 'ScrollbarIndicator'] = null;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!that[dir + 'ScrollbarWrapper']) {\n\t\t\t// Create the scrollbar wrapper\n\t\t\tbar = doc.createElement('div');\n\n\t\t\tif (that.options.scrollbarClass) bar.className = that.options.scrollbarClass + dir.toUpperCase();\n\t\t\telse bar.style.cssText = 'position:absolute;z-index:100;' + (dir == 'h' ? 'height:7px;bottom:1px;left:2px;right:' + (that.vScrollbar ? '7' : '2') + 'px' : 'width:7px;bottom:' + (that.hScrollbar ? '7' : '2') + 'px;top:2px;right:1px');\n\n\t\t\tbar.style.cssText += ';pointer-events:none;' + cssVendor + 'transition-property:opacity;' + cssVendor + 'transition-duration:' + (that.options.fadeScrollbar ? '350ms' : '0') + ';overflow:hidden;opacity:' + (that.options.hideScrollbar ? '0' : '1');\n\n\t\t\tthat.wrapper.appendChild(bar);\n\t\t\tthat[dir + 'ScrollbarWrapper'] = bar;\n\n\t\t\t// Create the scrollbar indicator\n\t\t\tbar = doc.createElement('div');\n\t\t\tif (!that.options.scrollbarClass) {\n\t\t\t\tbar.style.cssText = 'position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);' + cssVendor + 'background-clip:padding-box;' + cssVendor + 'box-sizing:border-box;' + (dir == 'h' ? 'height:100%' : 'width:100%') + ';' + cssVendor + 'border-radius:3px;border-radius:3px';\n\t\t\t}\n\t\t\tbar.style.cssText += ';pointer-events:none;' + cssVendor + 'transition-property:' + cssVendor + 'transform;' + cssVendor + 'transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);' + cssVendor + 'transition-duration:0;' + cssVendor + 'transform: translate(0,0)' + translateZ;\n\t\t\tif (that.options.useTransition) bar.style.cssText += ';' + cssVendor + 'transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)';\n\n\t\t\tthat[dir + 'ScrollbarWrapper'].appendChild(bar);\n\t\t\tthat[dir + 'ScrollbarIndicator'] = bar;\n\t\t}\n\n\t\tif (dir == 'h') {\n\t\t\tthat.hScrollbarSize = that.hScrollbarWrapper.clientWidth;\n\t\t\tthat.hScrollbarIndicatorSize = m.max(m.round(that.hScrollbarSize * that.hScrollbarSize / that.scrollerW), 8);\n\t\t\tthat.hScrollbarIndicator.style.width = that.hScrollbarIndicatorSize + 'px';\n\t\t\tthat.hScrollbarMaxScroll = that.hScrollbarSize - that.hScrollbarIndicatorSize;\n\t\t\tthat.hScrollbarProp = that.hScrollbarMaxScroll / that.maxScrollX;\n\t\t} else {\n\t\t\tthat.vScrollbarSize = that.vScrollbarWrapper.clientHeight;\n\t\t\tthat.vScrollbarIndicatorSize = m.max(m.round(that.vScrollbarSize * that.vScrollbarSize / that.scrollerH), 8);\n\t\t\tthat.vScrollbarIndicator.style.height = that.vScrollbarIndicatorSize + 'px';\n\t\t\tthat.vScrollbarMaxScroll = that.vScrollbarSize - that.vScrollbarIndicatorSize;\n\t\t\tthat.vScrollbarProp = that.vScrollbarMaxScroll / that.maxScrollY;\n\t\t}\n\n\t\t// Reset position\n\t\tthat._scrollbarPos(dir, true);\n\t},\n\t\n\t_resize: function () {\n\t\tvar that = this;\n\t\tsetTimeout(function () { that.refresh(); }, isAndroid ? 200 : 0);\n\t},\n\t\n\t_pos: function (x, y) {\n\t\tif (this.zoomed) return;\n\n\t\tx = this.hScroll ? x : 0;\n\t\ty = this.vScroll ? y : 0;\n\n\t\tif (this.options.useTransform) {\n\t\t\tthis.scroller.style[transform] = 'translate(' + x + 'px,' + y + 'px) scale(' + this.scale + ')' + translateZ;\n\t\t} else {\n\t\t\tx = m.round(x);\n\t\t\ty = m.round(y);\n\t\t\tthis.scroller.style.left = x + 'px';\n\t\t\tthis.scroller.style.top = y + 'px';\n\t\t}\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t\tthis._scrollbarPos('h');\n\t\tthis._scrollbarPos('v');\n\t},\n\n\t_scrollbarPos: function (dir, hidden) {\n\t\tvar that = this,\n\t\t\tpos = dir == 'h' ? that.x : that.y,\n\t\t\tsize;\n\n\t\tif (!that[dir + 'Scrollbar']) return;\n\n\t\tpos = that[dir + 'ScrollbarProp'] * pos;\n\n\t\tif (pos < 0) {\n\t\t\tif (!that.options.fixedScrollbar) {\n\t\t\t\tsize = that[dir + 'ScrollbarIndicatorSize'] + m.round(pos * 3);\n\t\t\t\tif (size < 8) size = 8;\n\t\t\t\tthat[dir + 'ScrollbarIndicator'].style[dir == 'h' ? 'width' : 'height'] = size + 'px';\n\t\t\t}\n\t\t\tpos = 0;\n\t\t} else if (pos > that[dir + 'ScrollbarMaxScroll']) {\n\t\t\tif (!that.options.fixedScrollbar) {\n\t\t\t\tsize = that[dir + 'ScrollbarIndicatorSize'] - m.round((pos - that[dir + 'ScrollbarMaxScroll']) * 3);\n\t\t\t\tif (size < 8) size = 8;\n\t\t\t\tthat[dir + 'ScrollbarIndicator'].style[dir == 'h' ? 'width' : 'height'] = size + 'px';\n\t\t\t\tpos = that[dir + 'ScrollbarMaxScroll'] + (that[dir + 'ScrollbarIndicatorSize'] - size);\n\t\t\t} else {\n\t\t\t\tpos = that[dir + 'ScrollbarMaxScroll'];\n\t\t\t}\n\t\t}\n\n\t\tthat[dir + 'ScrollbarWrapper'].style[transitionDelay] = '0';\n\t\tthat[dir + 'ScrollbarWrapper'].style.opacity = hidden && that.options.hideScrollbar ? '0' : '1';\n\t\tthat[dir + 'ScrollbarIndicator'].style[transform] = 'translate(' + (dir == 'h' ? pos + 'px,0)' : '0,' + pos + 'px)') + translateZ;\n\t},\n\t\n\t_start: function (e) {\n\t\tvar that = this,\n\t\t\tpoint = hasTouch ? e.touches[0] : e,\n\t\t\tmatrix, x, y,\n\t\t\tc1, c2;\n\n\t\tif (!that.enabled) return;\n\n\t\tif (that.options.onBeforeScrollStart) that.options.onBeforeScrollStart.call(that, e);\n\n\t\tif (that.options.useTransition || that.options.zoom) that._transitionTime(0);\n\n\t\tthat.moved = false;\n\t\tthat.animating = false;\n\t\tthat.zoomed = false;\n\t\tthat.distX = 0;\n\t\tthat.distY = 0;\n\t\tthat.absDistX = 0;\n\t\tthat.absDistY = 0;\n\t\tthat.dirX = 0;\n\t\tthat.dirY = 0;\n\n\t\t// Gesture start\n\t\tif (that.options.zoom && hasTouch && e.touches.length > 1) {\n\t\t\tc1 = m.abs(e.touches[0].pageX-e.touches[1].pageX);\n\t\t\tc2 = m.abs(e.touches[0].pageY-e.touches[1].pageY);\n\t\t\tthat.touchesDistStart = m.sqrt(c1 * c1 + c2 * c2);\n\n\t\t\tthat.originX = m.abs(e.touches[0].pageX + e.touches[1].pageX - that.wrapperOffsetLeft * 2) / 2 - that.x;\n\t\t\tthat.originY = m.abs(e.touches[0].pageY + e.touches[1].pageY - that.wrapperOffsetTop * 2) / 2 - that.y;\n\n\t\t\tif (that.options.onZoomStart) that.options.onZoomStart.call(that, e);\n\t\t}\n\n\t\tif (that.options.momentum) {\n\t\t\tif (that.options.useTransform) {\n\t\t\t\t// Very lame general purpose alternative to CSSMatrix\n\t\t\t\tmatrix = getComputedStyle(that.scroller, null)[transform].replace(/[^0-9\\-.,]/g, '').split(',');\n\t\t\t\tx = +(matrix[12] || matrix[4]);\n\t\t\t\ty = +(matrix[13] || matrix[5]);\n\t\t\t} else {\n\t\t\t\tx = +getComputedStyle(that.scroller, null).left.replace(/[^0-9-]/g, '');\n\t\t\t\ty = +getComputedStyle(that.scroller, null).top.replace(/[^0-9-]/g, '');\n\t\t\t}\n\t\t\t\n\t\t\tif (x != that.x || y != that.y) {\n\t\t\t\tif (that.options.useTransition) that._unbind(TRNEND_EV);\n\t\t\t\telse cancelFrame(that.aniTime);\n\t\t\t\tthat.steps = [];\n\t\t\t\tthat._pos(x, y);\n\t\t\t\tif (that.options.onScrollEnd) that.options.onScrollEnd.call(that);\n\t\t\t}\n\t\t}\n\n\t\tthat.absStartX = that.x;\t// Needed by snap threshold\n\t\tthat.absStartY = that.y;\n\n\t\tthat.startX = that.x;\n\t\tthat.startY = that.y;\n\t\tthat.pointX = point.pageX;\n\t\tthat.pointY = point.pageY;\n\n\t\tthat.startTime = e.timeStamp || Date.now();\n\n\t\tif (that.options.onScrollStart) that.options.onScrollStart.call(that, e);\n\n\t\tthat._bind(MOVE_EV, window);\n\t\tthat._bind(END_EV, window);\n\t\tthat._bind(CANCEL_EV, window);\n\t},\n\t\n\t_move: function (e) {\n\t\tvar that = this,\n\t\t\tpoint = hasTouch ? e.touches[0] : e,\n\t\t\tdeltaX = point.pageX - that.pointX,\n\t\t\tdeltaY = point.pageY - that.pointY,\n\t\t\tnewX = that.x + deltaX,\n\t\t\tnewY = that.y + deltaY,\n\t\t\tc1, c2, scale,\n\t\t\ttimestamp = e.timeStamp || Date.now();\n\t\t\t\n\t\tif (that.options.onBeforeScrollMove) that.options.onBeforeScrollMove.call(that, e);\n\n\t\t// Zoom\n\t\tif (that.options.zoom && hasTouch && e.touches.length > 1) {\n\t\t\tc1 = m.abs(e.touches[0].pageX - e.touches[1].pageX);\n\t\t\tc2 = m.abs(e.touches[0].pageY - e.touches[1].pageY);\n\t\t\tthat.touchesDist = m.sqrt(c1*c1+c2*c2);\n\n\t\t\tthat.zoomed = true;\n\n\t\t\tscale = 1 / that.touchesDistStart * that.touchesDist * this.scale;\n\n\t\t\tif (scale < that.options.zoomMin) scale = 0.5 * that.options.zoomMin * Math.pow(2.0, scale / that.options.zoomMin);\n\t\t\telse if (scale > that.options.zoomMax) scale = 2.0 * that.options.zoomMax * Math.pow(0.5, that.options.zoomMax / scale);\n\n\t\t\tthat.lastScale = scale / this.scale;\n\n\t\t\tnewX = this.originX - this.originX * that.lastScale + this.x,\n\t\t\tnewY = this.originY - this.originY * that.lastScale + this.y;\n\n\t\t\tthis.scroller.style[transform] = 'translate(' + newX + 'px,' + newY + 'px) scale(' + scale + ')' + translateZ;\n\n\t\t\tif (that.options.onZoom) that.options.onZoom.call(that, e);\n\t\t\treturn;\n\t\t}\n\n\t\tthat.pointX = point.pageX;\n\t\tthat.pointY = point.pageY;\n\n\t\t// Slow down if outside of the boundaries\n\t\tif (newX > 0 || newX < that.maxScrollX) {\n\t\t\tnewX = that.options.bounce ? that.x + (deltaX / 2) : newX >= 0 || that.maxScrollX >= 0 ? 0 : that.maxScrollX;\n\t\t}\n\t\tif (newY > that.minScrollY || newY < that.maxScrollY) {\n\t\t\tnewY = that.options.bounce ? that.y + (deltaY / 2) : newY >= that.minScrollY || that.maxScrollY >= 0 ? that.minScrollY : that.maxScrollY;\n\t\t}\n\n\t\tthat.distX += deltaX;\n\t\tthat.distY += deltaY;\n\t\tthat.absDistX = m.abs(that.distX);\n\t\tthat.absDistY = m.abs(that.distY);\n\n\t\tif (that.absDistX < 6 && that.absDistY < 6) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Lock direction\n\t\tif (that.options.lockDirection) {\n\t\t\tif (that.absDistX > that.absDistY + 5) {\n\t\t\t\tnewY = that.y;\n\t\t\t\tdeltaY = 0;\n\t\t\t} else if (that.absDistY > that.absDistX + 5) {\n\t\t\t\tnewX = that.x;\n\t\t\t\tdeltaX = 0;\n\t\t\t}\n\t\t}\n\n\t\tthat.moved = true;\n\t\tthat._pos(newX, newY);\n\t\tthat.dirX = deltaX > 0 ? -1 : deltaX < 0 ? 1 : 0;\n\t\tthat.dirY = deltaY > 0 ? -1 : deltaY < 0 ? 1 : 0;\n\n\t\tif (that.options.hScroll && !that.options.vScroll && that.dirX !== 0) {\n            e.preventDefault();\n\t\t}\n        if (that.options.vScroll && !that.options.hScroll && that.dirY !== 0) {\n            e.preventDefault();\n        }\n\t\t\n\t\tif (timestamp - that.startTime > 300) {\n\t\t\tthat.startTime = timestamp;\n\t\t\tthat.startX = that.x;\n\t\t\tthat.startY = that.y;\n\t\t}\n\t\t\n\t\tif (that.options.onScrollMove) that.options.onScrollMove.call(that, e);\n\t},\n\t\n\t_end: function (e) {\n\t\tif (hasTouch && e.touches.length !== 0) return;\n\n\t\tvar that = this,\n\t\t\tpoint = hasTouch ? e.changedTouches[0] : e,\n\t\t\ttarget, ev,\n\t\t\tmomentumX = { dist:0, time:0 },\n\t\t\tmomentumY = { dist:0, time:0 },\n\t\t\tduration = (e.timeStamp || Date.now()) - that.startTime,\n\t\t\tnewPosX = that.x,\n\t\t\tnewPosY = that.y,\n\t\t\tdistX, distY,\n\t\t\tnewDuration,\n\t\t\tsnap,\n\t\t\tscale;\n\n\t\tthat._unbind(MOVE_EV, window);\n\t\tthat._unbind(END_EV, window);\n\t\tthat._unbind(CANCEL_EV, window);\n\n\t\tif (that.options.onBeforeScrollEnd) that.options.onBeforeScrollEnd.call(that, e);\n\n\t\tif (that.zoomed) {\n\t\t\tscale = that.scale * that.lastScale;\n\t\t\tscale = Math.max(that.options.zoomMin, scale);\n\t\t\tscale = Math.min(that.options.zoomMax, scale);\n\t\t\tthat.lastScale = scale / that.scale;\n\t\t\tthat.scale = scale;\n\n\t\t\tthat.x = that.originX - that.originX * that.lastScale + that.x;\n\t\t\tthat.y = that.originY - that.originY * that.lastScale + that.y;\n\t\t\t\n\t\t\tthat.scroller.style[transitionDuration] = '200ms';\n\t\t\tthat.scroller.style[transform] = 'translate(' + that.x + 'px,' + that.y + 'px) scale(' + that.scale + ')' + translateZ;\n\t\t\t\n\t\t\tthat.zoomed = false;\n\t\t\tthat.refresh();\n\n\t\t\tif (that.options.onZoomEnd) that.options.onZoomEnd.call(that, e);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!that.moved) {\n\t\t\tif (hasTouch) {\n\t\t\t\tif (that.doubleTapTimer && that.options.zoom) {\n\t\t\t\t\t// Double tapped\n\t\t\t\t\tclearTimeout(that.doubleTapTimer);\n\t\t\t\t\tthat.doubleTapTimer = null;\n\t\t\t\t\tif (that.options.onZoomStart) that.options.onZoomStart.call(that, e);\n\t\t\t\t\tthat.zoom(that.pointX, that.pointY, that.scale == 1 ? that.options.doubleTapZoom : 1);\n\t\t\t\t\tif (that.options.onZoomEnd) {\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tthat.options.onZoomEnd.call(that, e);\n\t\t\t\t\t\t}, 200); // 200 is default zoom duration\n\t\t\t\t\t}\n\t\t\t\t} else if (this.options.handleClick) {\n\t\t\t\t\tthat.doubleTapTimer = setTimeout(function () {\n\t\t\t\t\t\tthat.doubleTapTimer = null;\n\n\t\t\t\t\t\t// Find the last touched element\n\t\t\t\t\t\ttarget = point.target;\n\t\t\t\t\t\twhile (target.nodeType != 1) target = target.parentNode;\n\n\t\t\t\t\t\tif (target.tagName != 'SELECT' && target.tagName != 'INPUT' && target.tagName != 'TEXTAREA') {\n\t\t\t\t\t\t\tev = doc.createEvent('MouseEvents');\n\t\t\t\t\t\t\tev.initMouseEvent('click', true, true, e.view, 1,\n\t\t\t\t\t\t\t\tpoint.screenX, point.screenY, point.clientX, point.clientY,\n\t\t\t\t\t\t\t\te.ctrlKey, e.altKey, e.shiftKey, e.metaKey,\n\t\t\t\t\t\t\t\t0, null);\n\t\t\t\t\t\t\tev._fake = true;\n\t\t\t\t\t\t\ttarget.dispatchEvent(ev);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, that.options.zoom ? 250 : 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthat._resetPos(400);\n\n\t\t\tif (that.options.onTouchEnd) that.options.onTouchEnd.call(that, e);\n\t\t\treturn;\n\t\t}\n\n\t\tif (duration < 300 && that.options.momentum) {\n\t\t\tmomentumX = newPosX ? that._momentum(newPosX - that.startX, duration, -that.x, that.scrollerW - that.wrapperW + that.x, that.options.bounce ? that.wrapperW : 0) : momentumX;\n\t\t\tmomentumY = newPosY ? that._momentum(newPosY - that.startY, duration, -that.y, (that.maxScrollY < 0 ? that.scrollerH - that.wrapperH + that.y - that.minScrollY : 0), that.options.bounce ? that.wrapperH : 0) : momentumY;\n\n\t\t\tnewPosX = that.x + momentumX.dist;\n\t\t\tnewPosY = that.y + momentumY.dist;\n\n\t\t\tif ((that.x > 0 && newPosX > 0) || (that.x < that.maxScrollX && newPosX < that.maxScrollX)) momentumX = { dist:0, time:0 };\n\t\t\tif ((that.y > that.minScrollY && newPosY > that.minScrollY) || (that.y < that.maxScrollY && newPosY < that.maxScrollY)) momentumY = { dist:0, time:0 };\n\t\t}\n\n\t\tif (momentumX.dist || momentumY.dist) {\n\t\t\tnewDuration = m.max(m.max(momentumX.time, momentumY.time), 10);\n\n\t\t\t// Do we need to snap?\n\t\t\tif (that.options.snap) {\n\t\t\t\tdistX = newPosX - that.absStartX;\n\t\t\t\tdistY = newPosY - that.absStartY;\n\t\t\t\tif (m.abs(distX) < that.options.snapThreshold && m.abs(distY) < that.options.snapThreshold) { that.scrollTo(that.absStartX, that.absStartY, 200); }\n\t\t\t\telse {\n\t\t\t\t\tsnap = that._snap(newPosX, newPosY);\n\t\t\t\t\tnewPosX = snap.x;\n\t\t\t\t\tnewPosY = snap.y;\n\t\t\t\t\tnewDuration = m.max(snap.time, newDuration);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthat.scrollTo(m.round(newPosX), m.round(newPosY), newDuration);\n\n\t\t\tif (that.options.onTouchEnd) that.options.onTouchEnd.call(that, e);\n\t\t\treturn;\n\t\t}\n\n\t\t// Do we need to snap?\n\t\tif (that.options.snap) {\n\t\t\tdistX = newPosX - that.absStartX;\n\t\t\tdistY = newPosY - that.absStartY;\n\t\t\tif (m.abs(distX) < that.options.snapThreshold && m.abs(distY) < that.options.snapThreshold) that.scrollTo(that.absStartX, that.absStartY, 200);\n\t\t\telse {\n\t\t\t\tsnap = that._snap(that.x, that.y);\n\t\t\t\tif (snap.x != that.x || snap.y != that.y) that.scrollTo(snap.x, snap.y, snap.time);\n\t\t\t}\n\n\t\t\tif (that.options.onTouchEnd) that.options.onTouchEnd.call(that, e);\n\t\t\treturn;\n\t\t}\n\n\t\tthat._resetPos(200);\n\t\tif (that.options.onTouchEnd) that.options.onTouchEnd.call(that, e);\n\t},\n\t\n\t_resetPos: function (time) {\n\t\tvar that = this,\n\t\t\tresetX = that.x >= 0 ? 0 : that.x < that.maxScrollX ? that.maxScrollX : that.x,\n\t\t\tresetY = that.y >= that.minScrollY || that.maxScrollY > 0 ? that.minScrollY : that.y < that.maxScrollY ? that.maxScrollY : that.y;\n\n\t\tif (resetX == that.x && resetY == that.y) {\n\t\t\tif (that.moved) {\n\t\t\t\tthat.moved = false;\n\t\t\t\tif (that.options.onScrollEnd) that.options.onScrollEnd.call(that);\t\t// Execute custom code on scroll end\n\t\t\t}\n\n\t\t\tif (that.hScrollbar && that.options.hideScrollbar) {\n\t\t\t\tif (vendor == 'webkit') that.hScrollbarWrapper.style[transitionDelay] = '300ms';\n\t\t\t\tthat.hScrollbarWrapper.style.opacity = '0';\n\t\t\t}\n\t\t\tif (that.vScrollbar && that.options.hideScrollbar) {\n\t\t\t\tif (vendor == 'webkit') that.vScrollbarWrapper.style[transitionDelay] = '300ms';\n\t\t\t\tthat.vScrollbarWrapper.style.opacity = '0';\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthat.scrollTo(resetX, resetY, time || 0);\n\t},\n\n\t_wheel: function (e) {\n\t\tvar that = this,\n\t\t\twheelDeltaX, wheelDeltaY,\n\t\t\tdeltaX, deltaY,\n\t\t\tdeltaScale;\n\n\t\tif ('wheelDeltaX' in e) {\n\t\t\twheelDeltaX = e.wheelDeltaX / 12;\n\t\t\twheelDeltaY = e.wheelDeltaY / 12;\n\t\t} else if('wheelDelta' in e) {\n\t\t\twheelDeltaX = wheelDeltaY = e.wheelDelta / 12;\n\t\t} else if ('detail' in e) {\n\t\t\twheelDeltaX = wheelDeltaY = -e.detail * 3;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (that.options.wheelAction == 'zoom') {\n\t\t\tdeltaScale = that.scale * Math.pow(2, 1/3 * (wheelDeltaY ? wheelDeltaY / Math.abs(wheelDeltaY) : 0));\n\t\t\tif (deltaScale < that.options.zoomMin) deltaScale = that.options.zoomMin;\n\t\t\tif (deltaScale > that.options.zoomMax) deltaScale = that.options.zoomMax;\n\t\t\t\n\t\t\tif (deltaScale != that.scale) {\n\t\t\t\tif (!that.wheelZoomCount && that.options.onZoomStart) that.options.onZoomStart.call(that, e);\n\t\t\t\tthat.wheelZoomCount++;\n\t\t\t\t\n\t\t\t\tthat.zoom(e.pageX, e.pageY, deltaScale, 400);\n\t\t\t\t\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tthat.wheelZoomCount--;\n\t\t\t\t\tif (!that.wheelZoomCount && that.options.onZoomEnd) that.options.onZoomEnd.call(that, e);\n\t\t\t\t}, 400);\n\t\t\t}\n\t\t\t\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tdeltaX = that.x + wheelDeltaX;\n\t\tdeltaY = that.y + wheelDeltaY;\n\n\t\tif (deltaX > 0) deltaX = 0;\n\t\telse if (deltaX < that.maxScrollX) deltaX = that.maxScrollX;\n\n\t\tif (deltaY > that.minScrollY) deltaY = that.minScrollY;\n\t\telse if (deltaY < that.maxScrollY) deltaY = that.maxScrollY;\n    \n\t\tif (that.maxScrollY < 0) {\n\t\t\tthat.scrollTo(deltaX, deltaY, 0);\n\t\t}\n\t},\n\t\n\t_transitionEnd: function (e) {\n\t\tvar that = this;\n\n\t\tif (e.target != that.scroller) return;\n\n\t\tthat._unbind(TRNEND_EV);\n\t\t\n\t\tthat._startAni();\n\t},\n\n\n\t/**\n\t*\n\t* Utilities\n\t*\n\t*/\n\t_startAni: function () {\n\t\tvar that = this,\n\t\t\tstartX = that.x, startY = that.y,\n\t\t\tstartTime = Date.now(),\n\t\t\tstep, easeOut,\n\t\t\tanimate;\n\n\t\tif (that.animating) return;\n\t\t\n\t\tif (!that.steps.length) {\n\t\t\tthat._resetPos(400);\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tstep = that.steps.shift();\n\t\t\n\t\tif (step.x == startX && step.y == startY) step.time = 0;\n\n\t\tthat.animating = true;\n\t\tthat.moved = true;\n\t\t\n\t\tif (that.options.useTransition) {\n\t\t\tthat._transitionTime(step.time);\n\t\t\tthat._pos(step.x, step.y);\n\t\t\tthat.animating = false;\n\t\t\tif (step.time) that._bind(TRNEND_EV);\n\t\t\telse that._resetPos(0);\n\t\t\treturn;\n\t\t}\n\n\t\tanimate = function () {\n\t\t\tvar now = Date.now(),\n\t\t\t\tnewX, newY;\n\n\t\t\tif (now >= startTime + step.time) {\n\t\t\t\tthat._pos(step.x, step.y);\n\t\t\t\tthat.animating = false;\n\t\t\t\tif (that.options.onAnimationEnd) that.options.onAnimationEnd.call(that);\t\t\t// Execute custom code on animation end\n\t\t\t\tthat._startAni();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnow = (now - startTime) / step.time - 1;\n\t\t\teaseOut = m.sqrt(1 - now * now);\n\t\t\tnewX = (step.x - startX) * easeOut + startX;\n\t\t\tnewY = (step.y - startY) * easeOut + startY;\n\t\t\tthat._pos(newX, newY);\n\t\t\tif (that.animating) that.aniTime = nextFrame(animate);\n\t\t};\n\n\t\tanimate();\n\t},\n\n\t_transitionTime: function (time) {\n\t\ttime += 'ms';\n\t\tthis.scroller.style[transitionDuration] = time;\n\t\tif (this.hScrollbar) this.hScrollbarIndicator.style[transitionDuration] = time;\n\t\tif (this.vScrollbar) this.vScrollbarIndicator.style[transitionDuration] = time;\n\t},\n\n\t_momentum: function (dist, time, maxDistUpper, maxDistLower, size) {\n\t\tvar deceleration = 0.0006,\n\t\t\tspeed = m.abs(dist) / time,\n\t\t\tnewDist = (speed * speed) / (2 * deceleration),\n\t\t\tnewTime = 0, outsideDist = 0;\n\n\t\t// Proportinally reduce speed if we are outside of the boundaries\n\t\tif (dist > 0 && newDist > maxDistUpper) {\n\t\t\toutsideDist = size / (6 / (newDist / speed * deceleration));\n\t\t\tmaxDistUpper = maxDistUpper + outsideDist;\n\t\t\tspeed = speed * maxDistUpper / newDist;\n\t\t\tnewDist = maxDistUpper;\n\t\t} else if (dist < 0 && newDist > maxDistLower) {\n\t\t\toutsideDist = size / (6 / (newDist / speed * deceleration));\n\t\t\tmaxDistLower = maxDistLower + outsideDist;\n\t\t\tspeed = speed * maxDistLower / newDist;\n\t\t\tnewDist = maxDistLower;\n\t\t}\n\n\t\tnewDist = newDist * (dist < 0 ? -1 : 1);\n\t\tnewTime = speed / deceleration;\n\n\t\treturn { dist: newDist, time: m.round(newTime) };\n\t},\n\n\t_offset: function (el) {\n\t\tvar left = -el.offsetLeft,\n\t\t\ttop = -el.offsetTop;\n\t\t\t\n\t\twhile (el = el.offsetParent) {\n\t\t\tleft -= el.offsetLeft;\n\t\t\ttop -= el.offsetTop;\n\t\t}\n\t\t\n\t\tif (el != this.wrapper) {\n\t\t\tleft *= this.scale;\n\t\t\ttop *= this.scale;\n\t\t}\n\n\t\treturn { left: left, top: top };\n\t},\n\n\t_snap: function (x, y) {\n\t\tvar that = this,\n\t\t\ti, l,\n\t\t\tpage, time,\n\t\t\tsizeX, sizeY;\n\n\t\t// Check page X\n\t\tpage = that.pagesX.length - 1;\n\t\tfor (i=0, l=that.pagesX.length; i<l; i++) {\n\t\t\tif (x >= that.pagesX[i]) {\n\t\t\t\tpage = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (page == that.currPageX && page > 0 && that.dirX < 0) page--;\n\t\tx = that.pagesX[page];\n\t\tsizeX = m.abs(x - that.pagesX[that.currPageX]);\n\t\tsizeX = sizeX ? m.abs(that.x - x) / sizeX * 500 : 0;\n\t\tthat.currPageX = page;\n\n\t\t// Check page Y\n\t\tpage = that.pagesY.length-1;\n\t\tfor (i=0; i<page; i++) {\n\t\t\tif (y >= that.pagesY[i]) {\n\t\t\t\tpage = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (page == that.currPageY && page > 0 && that.dirY < 0) page--;\n\t\ty = that.pagesY[page];\n\t\tsizeY = m.abs(y - that.pagesY[that.currPageY]);\n\t\tsizeY = sizeY ? m.abs(that.y - y) / sizeY * 500 : 0;\n\t\tthat.currPageY = page;\n\n\t\t// Snap with constant speed (proportional duration)\n\t\ttime = m.round(m.max(sizeX, sizeY)) || 200;\n\n\t\treturn { x: x, y: y, time: time };\n\t},\n\n\t_bind: function (type, el, bubble) {\n\t    if(!('addEventListener' in document)) {\n\t        (el || this.scroller).attachEvent(type, this, !!bubble);\n\t    } else {\n\t        (el || this.scroller).addEventListener(type, this, !!bubble);\n\t    }  \n\t},\n\n\t_unbind: function (type, el, bubble) {\n\t    if(!('addEventListener' in document)) {\n\t        (el || this.scroller).detachEvent(type, this, !!bubble);\n\t    } else {\n\t        (el || this.scroller).removeEventListener(type, this, !!bubble);\n\t    }\n\t},\n\n\n\t/**\n\t*\n\t* Public methods\n\t*\n\t*/\n\tdestroy: function () {\n\t\tvar that = this;\n\n\t\tthat.scroller.style[transform] = '';\n\n\t\t// Remove the scrollbars\n\t\tthat.hScrollbar = false;\n\t\tthat.vScrollbar = false;\n\t\tthat._scrollbar('h');\n\t\tthat._scrollbar('v');\n\n\t\t// Remove the event listeners\n\t\tthat._unbind(RESIZE_EV, window);\n\t\tthat._unbind(START_EV);\n\t\tthat._unbind(MOVE_EV, window);\n\t\tthat._unbind(END_EV, window);\n\t\tthat._unbind(CANCEL_EV, window);\n\t\t\n\t\tif (!that.options.hasTouch) {\n\t\t\tthat._unbind('DOMMouseScroll');\n\t\t\tthat._unbind('mousewheel');\n\t\t}\n\t\t\n\t\tif (that.options.useTransition) that._unbind(TRNEND_EV);\n\t\t\n\t\tif (that.options.checkDOMChanges) clearInterval(that.checkDOMTime);\n\t\t\n\t\tif (that.options.onDestroy) that.options.onDestroy.call(that);\n\t},\n\n\trefresh: function () {\n\t\tvar that = this,\n\t\t\toffset,\n\t\t\ti, l,\n\t\t\tels,\n\t\t\tpos = 0,\n\t\t\tpage = 0;\n\n\t\tif (that.scale < that.options.zoomMin) that.scale = that.options.zoomMin;\n\t\tthat.wrapperW = that.wrapper.clientWidth || 1;\n\t\tthat.wrapperH = that.wrapper.clientHeight || 1;\n\n\t\tthat.minScrollY = -that.options.topOffset || 0;\n\t\tthat.scrollerW = m.round(that.scroller.offsetWidth * that.scale);\n\t\tthat.scrollerH = m.round((that.scroller.offsetHeight + that.minScrollY) * that.scale);\n\t\tthat.maxScrollX = that.wrapperW - that.scrollerW;\n\t\tthat.maxScrollY = that.wrapperH - that.scrollerH + that.minScrollY;\n\t\tthat.dirX = 0;\n\t\tthat.dirY = 0;\n\n\t\tif (that.options.onRefresh) that.options.onRefresh.call(that);\n\n\t\tthat.hScroll = that.options.hScroll && that.maxScrollX < 0;\n\t\tthat.vScroll = that.options.vScroll && (!that.options.bounceLock && !that.hScroll || that.scrollerH > that.wrapperH);\n\n\t\tthat.hScrollbar = that.hScroll && that.options.hScrollbar;\n\t\tthat.vScrollbar = that.vScroll && that.options.vScrollbar && that.scrollerH > that.wrapperH;\n\n\t\toffset = that._offset(that.wrapper);\n\t\tthat.wrapperOffsetLeft = -offset.left;\n\t\tthat.wrapperOffsetTop = -offset.top;\n\n\t\t// Prepare snap\n\t\tif (typeof that.options.snap == 'string') {\n\t\t\tthat.pagesX = [];\n\t\t\tthat.pagesY = [];\n\t\t\tif (that.scroller.querySelectorAll !== undefined) {\n\t            els = that.scroller.querySelectorAll(that.options.snap);\n\t\t\t} else {\n\t            els = getElementsByClassName(that.scroller, that.options.snap.replace('div.', ''));\n\t\t\t}\n\t\t\tfor (i=0, l=els.length; i<l; i++) {\n\t\t\t\tpos = that._offset(els[i]);\n\t\t\t\tpos.left += that.wrapperOffsetLeft;\n\t\t\t\tpos.top += that.wrapperOffsetTop;\n\t\t\t\tthat.pagesX[i] = pos.left < that.maxScrollX ? that.maxScrollX : pos.left * that.scale;\n\t\t\t\tthat.pagesY[i] = pos.top < that.maxScrollY ? that.maxScrollY : pos.top * that.scale;\n\t\t\t}\n\t\t} else if (that.options.snap) {\n\t\t\tthat.pagesX = [];\n\t\t\twhile (pos >= that.maxScrollX) {\n\t\t\t\tthat.pagesX[page] = pos;\n\t\t\t\tpos = pos - that.wrapperW;\n\t\t\t\tpage++;\n\t\t\t}\n\t\t\tif (that.maxScrollX%that.wrapperW) that.pagesX[that.pagesX.length] = that.maxScrollX - that.pagesX[that.pagesX.length-1] + that.pagesX[that.pagesX.length-1];\n\n\t\t\tpos = 0;\n\t\t\tpage = 0;\n\t\t\tthat.pagesY = [];\n\t\t\twhile (pos >= that.maxScrollY) {\n\t\t\t\tthat.pagesY[page] = pos;\n\t\t\t\tpos = pos - that.wrapperH;\n\t\t\t\tpage++;\n\t\t\t}\n\t\t\tif (that.maxScrollY%that.wrapperH) that.pagesY[that.pagesY.length] = that.maxScrollY - that.pagesY[that.pagesY.length-1] + that.pagesY[that.pagesY.length-1];\n\t\t}\n\n\t\t// Prepare the scrollbars\n\t\tthat._scrollbar('h');\n\t\tthat._scrollbar('v');\n\n\t\tif (!that.zoomed) {\n\t\t\tthat.scroller.style[transitionDuration] = '0';\n\t\t\tthat._resetPos(400);\n\t\t}\n\t},\n\n\tscrollTo: function (x, y, time, relative) {\n\t\tvar that = this,\n\t\t\tstep = x,\n\t\t\ti, l;\n\n\t\tthat.stop();\n\n\t\tif (!step.length) step = [{ x: x, y: y, time: time, relative: relative }];\n\t\t\n\t\tfor (i=0, l=step.length; i<l; i++) {\n\t\t\tif (step[i].relative) { step[i].x = that.x - step[i].x; step[i].y = that.y - step[i].y; }\n\t\t\tthat.steps.push({ x: step[i].x, y: step[i].y, time: step[i].time || 0 });\n\t\t}\n\n\t\tthat._startAni();\n\t},\n\n\tscrollToElement: function (el, time) {\n\t\tvar that = this, pos;\n\t\tel = el.nodeType ? el : that.scroller.querySelector(el);\n\t\tif (!el) return;\n\n\t\tpos = that._offset(el);\n\t\tpos.left += that.wrapperOffsetLeft;\n\t\tpos.top += that.wrapperOffsetTop;\n\n\t\tpos.left = pos.left > 0 ? 0 : pos.left < that.maxScrollX ? that.maxScrollX : pos.left;\n\t\tpos.top = pos.top > that.minScrollY ? that.minScrollY : pos.top < that.maxScrollY ? that.maxScrollY : pos.top;\n\t\ttime = time === undefined ? m.max(m.abs(pos.left)*2, m.abs(pos.top)*2) : time;\n\n\t\tthat.scrollTo(pos.left, pos.top, time);\n\t},\n\n\tscrollToPage: function (pageX, pageY, time) {\n\t\tvar that = this, x, y;\n\t\t\n\t\ttime = time === undefined ? 400 : time;\n\n\t\tif (that.options.onScrollStart) that.options.onScrollStart.call(that);\n\n\t\tif (that.options.snap) {\n\t\t\tpageX = pageX == 'next' ? that.currPageX+1 : pageX == 'prev' ? that.currPageX-1 : pageX;\n\t\t\tpageY = pageY == 'next' ? that.currPageY+1 : pageY == 'prev' ? that.currPageY-1 : pageY;\n\n\t\t\tpageX = pageX < 0 ? 0 : pageX > that.pagesX.length-1 ? that.pagesX.length-1 : pageX;\n\t\t\tpageY = pageY < 0 ? 0 : pageY > that.pagesY.length-1 ? that.pagesY.length-1 : pageY;\n\n\t\t\tthat.currPageX = pageX;\n\t\t\tthat.currPageY = pageY;\n\t\t\tx = that.pagesX[pageX];\n\t\t\ty = that.pagesY[pageY];\n\t\t} else {\n\t\t\tx = -that.wrapperW * pageX;\n\t\t\ty = -that.wrapperH * pageY;\n\t\t\tif (x < that.maxScrollX) x = that.maxScrollX;\n\t\t\tif (y < that.maxScrollY) y = that.maxScrollY;\n\t\t}\n\n\t\tthat.scrollTo(x, y, time);\n\t},\n\n\tdisable: function () {\n\t\tthis.stop();\n\t\tthis._resetPos(0);\n\t\tthis.enabled = false;\n\n\t\t// If disabled after touchstart we make sure that there are no left over events\n\t\tthis._unbind(MOVE_EV, window);\n\t\tthis._unbind(END_EV, window);\n\t\tthis._unbind(CANCEL_EV, window);\n\t},\n\t\n\tenable: function () {\n\t\tthis.enabled = true;\n\t},\n\t\n\tstop: function () {\n\t\tif (this.options.useTransition) this._unbind(TRNEND_EV);\n\t\telse cancelFrame(this.aniTime);\n\t\tthis.steps = [];\n\t\tthis.moved = false;\n\t\tthis.animating = false;\n\t},\n\t\n\tzoom: function (x, y, scale, time) {\n\t\tvar that = this,\n\t\t\trelScale = scale / that.scale;\n\n\t\tif (!that.options.useTransform) return;\n\n\t\tthat.zoomed = true;\n\t\ttime = time === undefined ? 200 : time;\n\t\tx = x - that.wrapperOffsetLeft - that.x;\n\t\ty = y - that.wrapperOffsetTop - that.y;\n\t\tthat.x = x - x * relScale + that.x;\n\t\tthat.y = y - y * relScale + that.y;\n\n\t\tthat.scale = scale;\n\t\tthat.refresh();\n\n\t\tthat.x = that.x > 0 ? 0 : that.x < that.maxScrollX ? that.maxScrollX : that.x;\n\t\tthat.y = that.y > that.minScrollY ? that.minScrollY : that.y < that.maxScrollY ? that.maxScrollY : that.y;\n\n\t\tthat.scroller.style[transitionDuration] = time + 'ms';\n\t\tthat.scroller.style[transform] = 'translate(' + that.x + 'px,' + that.y + 'px) scale(' + scale + ')' + translateZ;\n\t\tthat.zoomed = false;\n\t},\n\t\n\tisReady: function () {\n\t\treturn !this.moved && !this.zoomed && !this.animating;\n\t}\n};\n\nfunction prefixStyle (style) {\n\tif ( vendor === '' ) return style;\n\n\tstyle = style.charAt(0).toUpperCase() + style.substr(1);\n\treturn vendor + style;\n}\n\ndummyStyle = null;\t// for the sake of it\n\nif (typeof exports !== 'undefined') exports.iScroll = iScroll;\nelse window.iScroll = iScroll;\n\n})(window, document);\n"},function(t,e,n){n(10)(n(332))},function(t,e){t.exports="/*jslint undef: true, browser: true, continue: true, eqeq: true, vars: true, forin: true, white: true, newcap: false, nomen: true, plusplus: true, maxerr: 50, indent: 4 */\r\n\r\n/**\r\n * jGestures: a jQuery plugin for gesture events\r\n * Copyright 2010-2011 Neue Digitale / Razorfish GmbH\r\n * Copyright 2011-2012, Razorfish GmbH\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n *\r\n * @fileOverview\r\n * Razorfish GmbH javascript library: add touch events such as 'pinch',\r\n * 'rotate', 'swipe', 'tap' and 'orientationchange' on capable user agents.\r\n * For incapable devices there's a basic event substitution: a \"tapone\" event\r\n * can be triggered by \"clicking\", a \"swipeone\" by performing a swipe-ish\r\n * gesture using the mouse (buttondown - mousemove - buttonup).\r\n *\r\n * This is still a beta version, bugfixes and improvements appreciated.\r\n *\r\n * @author martin.krause@razorfish.de\r\n * @version 0.90-shake\r\n *\r\n * @requires\r\n * jQuery JavaScript Library - http://jquery.com/\r\n *\tCopyright 2010, John Resig\r\n *\tDual licensed under the MIT or GPL Version 2 licenses.\r\n *\thttp://jquery.org/license\r\n *\r\n * @example\tjQuery('#swipe').bind('swipeone',eventHandler);\r\n *\r\n * Notification on native events:\r\n * On every native touchstart, touchend, gesturestart and gestureend-event,\r\n * jgestures triggers a corresponding custom event\r\n * ('jGestures.touchstart', 'jGestures.touchend;start', 'jGestures.touchend;processed',\r\n * 'jGestures.gesturestart', 'jGestures.gestureend;start', 'jGestures.gestureend;processed') on the event-element.\r\n * The  eventhandler's second argument represents the original touch event (yes: including all touchpoints).\r\n * Use this if you need very detailed control e.g. kinetic scrolling or implementing additional gestures.\r\n *\r\n * Every jGesture-eventhandler receives a custom object as second argument\r\n * containing the original event (originalEvent property) and processed\r\n * information (such as delta values and timesptamp).\r\n * Example:{\r\n *\t\t\t\ttype: eventtype e.g. \"swipe\",\"pinch\",\r\n *\t\t\t\toriginalEvent: {DOM-Event},\r\n *\t\t\t\t// default: just one entry on the delta-array - the first touchpoint\r\n *\t\t\t\t// the first touchpoint is the reference point for every gesture,\r\n *\t\t\t\t// because moving touchpoints in various directions would result in\r\n *\t\t\t\t// a gesture.\r\n *\t\t\t\t// delta and direction details are just provided for touch not for gesture / motion events\r\n *\t\t\t\tdelta : [\r\n *\t\t\t\t\t{\r\n *\t\t\t\t\t\tlastX:{Number} , // x-axis: relative to the last touchevent (e.g. touchmove!)\r\n *\t\t\t\t\t\tlastY:{Number}, // y-axis: relative to the last touchevent (e.g. touchmove!)\r\n *\t\t\t\t\t\tmoved: {Number},  // distance: relative to the original touchpoint\r\n *\t\t\t\t\t\tstartX: {Number} , // relative to the original touchpoint\r\n *\t\t\t\t\t\tstartY: {Number} ,// relative to the original touchpoint\r\n *\t\t\t\t\t} ],\r\n *\t\t\t\t// based on the first touchpoint\r\n *\t\t\t\tdirection : { // relative to the last touchevent (e.g. touchmove!)\r\n *\t\t\t\t\tvector: {Number}, // -1|+1, indicates the direction if necessary(pinch/rotate)\r\n *\t\t\t\t\torientation: {Number} // window.orientation: -90,0,90,180 || null (window.orienntation)\r\n *\t\t\t\t\tlastX : {Number}, // -1,0,+1 || null (orientationchange) // relative to the last touchevent (e.g. touchmove!)\r\n *\t\t\t\t\tlastY : {Number}, // -1,0,+1 || null (orientationchange)// relative to the last touchevent (e.g. touchmove!)\r\n *\t\t\t\t\tstartX: {Number} , // relative to the original touchpoint\r\n *\t\t\t\t\tstartY: {Number} ,// relative to the original touchpoint\r\n *\t\t\t\t},\r\n *\t\t\t\trotation: {Number} || null, // gestureonly: amount of rotation relative to the current position NOT the original\r\n *\t\t\t\tscale: {Number} || null, // gestureonly: amount of scaling relative to the current position NOT the original\r\n *\t\t\t\tduration: {Number}, // ms: relative to the original touchpoint\r\n *\t\t\t\tdescription : {String} // details as String: {TYPE *}:{TOUCHES 1|2|3|4}:{X-AXIS 'right'|'left'|'steady'}:{Y-AXIS 'down'|'up'|'steady'} e.g. \"swipe:1:left:steady\" relative to the last touchpoint\r\n *\t\t\t};\r\n *\r\n * Available jGesture-events can be grouped into:\r\n *\r\n *\r\n * Device events:\r\n *\tThe jGesture-Events in this group are triggered by the device.\r\n *\r\n * @event 'orientationchange'\r\n *\t\tThe device is turned clockwise or counterclockwise. This event is triggered\r\n *\t\tby the device and might use an internal gyroscope.\r\n *\tobj.description:\r\n *\t\torientationchange:landscape:clockwise:-90\r\n *\t\torientationchange:portrait:default:0\r\n *\t\torientationchange:landscape:counterclockwise|portrait:90\r\n *\t\torientationchange:portrait:upsidedown:180\r\n *\r\n *\r\n * Move events:\r\n *\tThe jGesture-Events in this group are triggered during the touch/gesture\r\n *\texecution whenever a touchpoint changes.\r\n *\tIn contrast to touchend/gestureend-events which are triggered after\r\n *\tthe touch/gesture has completed.\r\n *\r\n * @event 'pinch'\r\n *\t\tIs triggered during a pinch gesture (two fingers moving away from or\r\n *\t\ttowards each other).\r\n *\tobj.description:\r\n *\t\tpinch:-1:close\r\n *\t\tpinch:+1:open\r\n *\r\n * @event 'rotate'\r\n *\t\tIs triggered during a rotation gesture (two fingers rotating clockwise\r\n *\t\tor counterclockwise).\r\n *\tobj.description:\r\n *\t\trotate:-1:counterclockwise\r\n *\t\trotate:+1:+clockwise\r\n *\r\n * @event 'swipemove'\r\n *\t\tIs triggered during a swipe move gesture (finger(s) being moved around\r\n *\t\tthe device, e.g. dragging)\r\n *\tobj.description:\r\n *\t\tswipemove:1:left:down\r\n *\t\tswipemove:1:left:up\r\n *\t\tswipemove:1:left:steady\r\n *\t\tswipemove:1:right:down\r\n *\t\tswipemove:1:right:up\r\n *\t\tswipemove:1:right:steady\r\n *\t\tswipemove:2:left:down\r\n *\t\tswipemove:2:left:up\r\n *\t\tswipemove:2:left:steady\r\n *\t\tswipemove:2:right:down\r\n *\t\tswipemove:2:right:up\r\n *\t\tswipemove:2:right:steady\r\n *\t\tswipemove:2:left:down\r\n *\t\tswipemove:3:left:up\r\n *\t\tswipemove:3:left:steady\r\n *\t\tswipemove:3:right:down\r\n *\t\tswipemove:3:right:up\r\n *\t\tswipemove:3:right:steady\r\n *\t\tswipemove:3:left:down\r\n *\t\tswipemove:4:left:up\r\n *\t\tswipemove:4:left:steady\r\n *\t\tswipemove:4:right:down\r\n *\t\tswipemove:4:right:up\r\n *\t\tswipemove:4:right:steady\r\n *\r\n *\r\n * Toucheend events:\r\n *\tThe jGesture-Events in this group are triggered after the touch/gesture\r\n *\thas completed.\r\n *\tIn contrast to touchmove-events which are triggered during the touch/gesture\r\n *\texecution whenever a touchpoint changes.\r\n *\r\n * @event 'swipeone'\r\n *\t\tIs triggered after a swipe move gesture with one touchpoint (one finger\r\n *\t\twas moved around the device)\r\n *\tobj.description:\r\n *\t\tswipeone:1:left:down\r\n *\t\tswipeone:1:left:up\r\n *\t\tswipeone:1:left:steady\r\n *\t\tswipeone:1:right:down\r\n *\t\tswipeone:1:right:up\r\n *\t\tswipeone:1:right:steady\r\n *\r\n * @event 'swipetwo'\r\n *\t\tIs triggered after a swipe move gesture with two touchpoints (two fingers\r\n *\t\twere moved around the device)\r\n *\tobj.description:\r\n *\t\tswipetwo:2:left:down\r\n *\t\tswipetwo:2:left:up\r\n *\t\tswipetwo:2:left:steady\r\n *\t\tswipetwo:2:right:down\r\n *\t\tswipetwo:2:right:up\r\n *\t\tswipetwo:2:right:steady\r\n *\r\n * @event 'swipethree'\r\n *\t\tIs triggered after a swipe move gesture with three touchpoints (three\r\n *\t\tfingers were moved around the device)\r\n *\tobj.description:\r\n *\t\tswipethree:3:left:down\r\n *\t\tswipethree:3:left:up\r\n *\t\tswipethree:3:left:steady\r\n *\t\tswipethree:3:right:down\r\n *\t\tswipethree:3:right:up\r\n *\t\tswipethree:3:right:steady\r\n *\r\n * @event 'swipefour'\r\n *\t\tIs triggered after a swipe move gesture with four touchpoints (four\r\n *\t\tfingers were moved around the device)\r\n *\tobj.description:\r\n *\t\tswipefour:4:left:down\r\n *\t\tswipefour:4:left:up\r\n *\t\tswipefour:4:left:steady\r\n *\t\tswipefour:4:right:down\r\n *\t\tswipefour:4:right:up\r\n *\t\tswipefour:4:right:steady\r\n *\r\n *\r\n * @event 'swipeup'\r\n *\t\tIs triggered after an  strict upwards swipe move gesture\r\n *\tobj.description:\r\n *\t\tswipe:1:steady:up\r\n *\t\tswipe:2:steady:up\r\n *\t\tswipe:3:steady:up\r\n *\t\tswipe:4:steady:up\r\n *\r\n * @event 'swiperightup'\r\n *\t\tIs triggered after a rightwards and upwards swipe move gesture\r\n *\tobj.description:\r\n *\t\tswipe:1:right:up\r\n *\t\tswipe:2:right:up\r\n *\t\tswipe:3:right:up\r\n *\t\tswipe:4:right:up\r\n *\r\n * @event 'swiperight'\r\n *\t\tIs triggered after a  strict rightwards swipe move gesture\r\n *\tobj.description:\r\n *\t\tswipe:1:right:steady\r\n *\t\tswipe:2:right:steady\r\n *\t\tswipe:3:right:steady\r\n *\t\tswipe:4:right:steady\r\n *\r\n * @event 'swiperightdown'\r\n *\t\tIs triggered after a rightwards and downwards swipe move gesture\r\n *\tobj.description:\r\n *\t\tswipe:1:right:down\r\n *\t\tswipe:2:right:down\r\n *\t\tswipe:3:right:down\r\n *\t\tswipe:4:right:down\r\n *\r\n * @event 'swipedown'\r\n *\t\tIs triggered after a  strict downwards swipe move gesture\r\n *\tobj.description:\r\n *\t\tswipe:1:steady:down\r\n *\t\tswipe:2:steady:down\r\n *\t\tswipe:3:steady:down\r\n *\t\tswipe:4:steady:down\r\n *\r\n * @event 'swipeleftdown'\r\n *\t\tIs triggered after a leftwards and downwards swipe move gesture\r\n *\tobj.description:\r\n *\t\tswipe:1:left:down\r\n *\t\tswipe:2:left:down\r\n *\t\tswipe:3:left:down\r\n *\t\tswipe:4:left:down\r\n *\r\n * @event 'swipeleft'\r\n *\t\tIs triggered after a strict leftwards swipe move gesture\r\n *\tobj.description:\r\n *\t\tswipe:1:left:steady\r\n *\t\tswipe:2:left:steady\r\n *\t\tswipe:3:left:steady\r\n *\t\tswipe:4:left:steady\r\n *\r\n * @event 'swipeleftup'\r\n *\t\tIs triggered after a leftwards and upwards swipe move gesture\r\n *\tobj.description:\r\n *\t\tswipe:1:left:up\r\n *\t\tswipe:2:left:up\r\n *\t\tswipe:3:left:up\r\n *\t\tswipe:4:left:up\r\n *\r\n * @event 'tapone'\r\n *\t\tIs triggered after a single (one finger) tap gesture\r\n *\tobj.description:\r\n *\t\ttapone\r\n *\r\n * @event 'taptwo'\r\n *\t\tIs triggered after a double (two finger) tap gesture\r\n *\tobj.description:\r\n *\t\ttaptwo\r\n * *\r\n * @event 'tapthree'\r\n *\t\tIs triggered after a tripple (three finger) tap gesture\r\n *\tobj.description:\r\n *\t\ttapthree\r\n *\r\n *\r\n * Gestureend events:\r\n *\tA gesture is an interpretation of different touchpoints.\r\n *\tThe jGesture-Events in this group are triggered when a gesture has finished\r\n *\tand the touchpoints are removed from the device.\r\n *\r\n * @event 'pinchopen'\r\n *\t\tIs triggered when a pinchopen gesture (two fingers moving away from each\r\n *\t\tother) occured and the touchpoints (fingers) are removed the device.\r\n *\tobj.description:\r\n *\t\tpinch:+1:open\r\n *\r\n * @event 'pinchclose'\r\n *\t\tIs triggered when a pinchclose gesture (two fingers moving towards each\r\n *\t\tother) occured and the touchpoints (fingers) are removed the device.\r\n *\tobj.description:\r\n *\t\tpinch:-1:close\r\n *\r\n * @event 'rotatecw'\r\n *\t\tIs triggered when a clockwise rotation gesture (two fingers rotating\r\n *\t\tclockwise) occured and the touchpoints (fingers) are removed the device.\r\n *\tobj.description:\r\n *\t\trotate:+1:+clockwise\r\n *\r\n * @event 'rotateccw'\r\n *\t\tIs triggered when a counterclockwise rotation gesture (two fingers\r\n *\t\trotating counterclockwise) occured and the touchpoints (fingers) are\r\n *\t\tremoved the device.\r\n *\tobj.description:\r\n *\t\trotate:-1:+counterclockwise\r\n *\r\n *\r\n * Motion events:\r\n *  A \"motion event\" is an interpretation of changes in space, e.g. a \"shaking motion\"\r\n *  consists of a specified number of acceleration changes in a given interval.\r\n * For understanding \"directions\", place your mobile device on a table with the bottom\r\n * (home button) close to you:\r\n *  - x-axis: horizontal left / right\r\n *  - y-axis: horizontal front / back (through the home button)\r\n *  - z-axis: vertical through your device\r\n *\r\n *  Note: Devicemotion / deviceorientation don't send custom event (such as: jGestures.touchstart).\r\n *  Note: Devicemotion should be bound on the \"window-element\" - because the whole device moves\r\n *\r\n * @event 'shake'\r\n *\t\tIs triggered when a shaking motion is detected\r\n *\tobj.description:\r\n *\t\tshake:leftright:x-axisfrontback:y-axis:updown:z-axis\r\n *\r\n * @event 'shakefrontback'\r\n *\t\tIs triggered when a shaking motion is detected and the gesture can be interpreted as a mainly front-back movement.\r\n  *\tobj.description:\r\n *\t\tshakefrontback:shakefrontback:y-axis\r\n *\r\n * @event 'shakeleftright'\r\n *\t\tIs triggered when a shaking motion is detected and the gesture can be interpreted as a mainly left-right movement.\r\n *\t\tAdditional major movements are mentioned in the obj.description.\r\n *\tobj.description:\r\n *\t\tshakeleftright:leftright:x-axis\r\n *\r\n * @event 'shakeupdown'\r\n *\t\tIs triggered when a shaking motion is detected and the gesture can be interpreted as a mainly up-down movement.\r\n *\t\tAdditional major movements are mentioned in the obj.description.\r\n *\tobj.description:\r\n *\t\tshake:shakeupdown:updown:z-axis\r\n *\r\n * @example\r\n *\t\t.bind( eventType, [ eventData ], handler(eventObject) )\r\n * jQuery('body').bind('tapone',function(){alert(arguments[1].description);})\r\n *\r\n */\r\n\r\n (function($) {\r\n\r\n\t/**\r\n\t* General thresholds.\r\n\t*/\r\n\t// @TODO: move to $...defaults\r\n\t// @TODO: shake to defaults freeze etc\r\n\t// change of x deg in y ms\r\n\r\n\r\n\t$.jGestures = {};\r\n\t$.jGestures.defaults = {};\r\n\t$.jGestures.defaults.thresholdShake =  {\r\n\t\trequiredShakes : 10,\r\n\t\tfreezeShakes: 100,\r\n\t\tfrontback : {\r\n\t\t\tsensitivity: 10\r\n\t\t },\r\n\t\tleftright : {\r\n\t\t\tsensitivity: 10\r\n\t\t},\r\n\t\tupdown : {\r\n\t\t\tsensitivity: 10\r\n\t\t}\r\n\t};\r\n\r\n\t$.jGestures.defaults.thresholdPinchopen = 0.05;\r\n\t$.jGestures.defaults.thresholdPinchmove = 0.05;\r\n\t$.jGestures.defaults.thresholdPinch = 0.05;\r\n\t$.jGestures.defaults.thresholdPinchclose = 0.05;\r\n\t$.jGestures.defaults.thresholdRotatecw = 5; //deg\r\n\t$.jGestures.defaults.thresholdRotateccw = 5; // deg\r\n\t// a tap becomes a swipe if x/y values changes are above this threshold\r\n\t$.jGestures.defaults.thresholdMove = 20;\r\n\t$.jGestures.defaults.thresholdSwipe = 100;\r\n\t// get capable user agents\r\n\t$.jGestures.data = {};\r\n\t$.jGestures.data.capableDevicesInUserAgentString = ['iPad','iPhone','iPod','Mobile Safari']; // basic functionality such as swipe, pinch, rotate, tap should work on every mobile safari, e.g. GalaxyTab\r\n\t$.jGestures.data.hasGestures = (function () { var _i; for(_i = 0; _i < $.jGestures.data.capableDevicesInUserAgentString.length; _i++ ) {  if (navigator.userAgent.indexOf($.jGestures.data.capableDevicesInUserAgentString[_i]) !== -1 ) {return true;} } return false; } )();\r\n\t$.hasGestures = $.jGestures.data.hasGestures;\r\n\t$.jGestures.events = {\r\n\t\ttouchstart : 'jGestures.touchstart',\r\n\t\ttouchendStart: 'jGestures.touchend;start',\r\n\t\ttouchendProcessed: 'jGestures.touchend;processed',\r\n\t\tgesturestart: 'jGestures.gesturestart',\r\n\t\tgestureendStart: 'jGestures.gestureend;start',\r\n\t\tgestureendProcessed: 'jGestures.gestureend;processed'\r\n\t};\r\n\r\n\tjQuery\r\n\t\t.each({\r\n\t\t\t// \"first domevent necessary\"_\"touch event+counter\" : \"exposed as\"\r\n\t\t\t// event: orientationchange\r\n\t\t\torientationchange_orientationchange01: \"orientationchange\",\r\n\t\t\t// event: gestures\r\n\t\t\tgestureend_pinchopen01: \"pinchopen\",\r\n\t\t\tgestureend_pinchclose01: \"pinchclose\",\r\n\t\t\tgestureend_rotatecw01 : 'rotatecw',\r\n\t\t\tgestureend_rotateccw01 : 'rotateccw',\r\n\t\t\t// move events\r\n\t\t\tgesturechange_pinch01: 'pinch',\r\n\t\t\tgesturechange_rotate01: 'rotate',\r\n\t\t\ttouchstart_swipe13: 'swipemove',\r\n\t\t\t// event: touches\r\n\t\t\ttouchstart_swipe01: \"swipeone\",\r\n\t\t\ttouchstart_swipe02: \"swipetwo\",\r\n\t\t\ttouchstart_swipe03: \"swipethree\",\r\n\t\t\ttouchstart_swipe04: \"swipefour\",\r\n\t\t\ttouchstart_swipe05: 'swipeup',\r\n\t\t\ttouchstart_swipe06: 'swiperightup',\r\n\t\t\ttouchstart_swipe07: 'swiperight',\r\n\t\t\ttouchstart_swipe08: 'swiperightdown',\r\n\t\t\ttouchstart_swipe09: 'swipedown',\r\n\t\t\ttouchstart_swipe10: 'swipeleftdown',\r\n\t\t\ttouchstart_swipe11: 'swipeleft',\r\n\t\t\ttouchstart_swipe12: 'swipeleftup',\r\n\t\t\ttouchstart_tap01: 'tapone',\r\n\t\t\ttouchstart_tap02: 'taptwo',\r\n\t\t\ttouchstart_tap03: 'tapthree',\r\n\t\t\ttouchstart_tap04: 'tapfour',\r\n\r\n\t\t\tdevicemotion_shake01: 'shake',\r\n\t\t\tdevicemotion_shake02: 'shakefrontback',\r\n\t\t\tdevicemotion_shake03: 'shakeleftright',\r\n\t\t\tdevicemotion_shake04: 'shakeupdown'\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t* Add gesture events inside the jQuery.event.special namespace\r\n\t\t*/\r\n\t\tfunction( sInternal_, sPublicFN_ ) {\r\n\r\n\t\t\t// add as funciton to jQuery.event.special.sPublicFN_\r\n\t\t\tjQuery.event.special[ sPublicFN_ ] = {\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t* When the first event handler is bound, jQuery executes the setup function.\r\n\t\t\t\t* This plugin just uses one eventhandler per element, regardless of the number of bound events.\r\n\t\t\t\t* All Events are stored internally as properties on the dom-element using the $.data api.\r\n\t\t\t\t* The setup-function adds the eventlistener, acting as a proxy function for the internal events.\r\n\t\t\t\t* $.data.ojQueryGestures[_sDOMEvent ('tap') ] = {Boolean}\r\n\t\t\t\t* @return {Void}\r\n\t\t\t\t*/\r\n\t\t\t\tsetup: function () {\r\n\t\t\t\t\t// split the arguments to necessary controll arguements\r\n\t\t\t\t\tvar _aSplit = sInternal_.split('_');\r\n\t\t\t\t\tvar _sDOMEvent = _aSplit[0]; //\r\n\t\t\t\t\t// get the associated gesture event and strip the counter: necessary for distinguisihng similliar events such as tapone-tapfour\r\n\t\t\t\t\tvar _sGestureEvent = _aSplit[1].slice(0,_aSplit[1].length-2);\r\n\t\t\t\t\tvar _$element = jQuery(this);\r\n\t\t\t\t\tvar _oDatajQueryGestures ;\r\n\t\t\t\t\tvar oObj;\r\n\t\t\t\t\t// bind the event handler on the first $.bind() for a gestureend-event, set marker\r\n\t\t\t\t\tif (!_$element.data('ojQueryGestures') || !_$element.data('ojQueryGestures')[_sDOMEvent])  {\r\n\t\t\t\t\t\t// setup pseudo event\r\n\t\t\t\t\t\t_oDatajQueryGestures = _$element.data('ojQueryGestures') || {};\r\n\t\t\t\t\t\toObj = {};\r\n\t\t\t\t\t\t// marker for:  domEvent being set on this element\r\n\t\t\t\t\t\t// e.g.: $.data.oGestureInternals['touchstart'] = true;\r\n\t\t\t\t\t\t// since they're grouped, i'm just marking the first one being added\r\n\t\t\t\t\t\toObj[_sDOMEvent] = true;\r\n\t\t\t\t\t\t$.extend(true,_oDatajQueryGestures,oObj);\r\n\t\t\t\t\t\t_$element.data('ojQueryGestures' ,_oDatajQueryGestures);\r\n\t\t\t\t\t\t// add gesture events\r\n\t\t\t\t\t\tif($.hasGestures) {\r\n\t\t\t\t\t\t\tswitch(_sGestureEvent) {\r\n\r\n\t\t\t\t\t\t\t\t// event: orientationchange\r\n\t\t\t\t\t\t\t\tcase 'orientationchange':\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).addEventListener('orientationchange', _onOrientationchange, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// event:\r\n\t\t\t\t\t\t\t\t// - shake\r\n\t\t\t\t\t\t\t\t// - tilt\r\n\t\t\t\t\t\t\t\tcase 'shake':\r\n\t\t\t\t\t\t\t\tcase 'shakefrontback':\r\n\t\t\t\t\t\t\t\tcase 'shakeleftright':\r\n\t\t\t\t\t\t\t\tcase 'shakeupdown':\r\n\t\t\t\t\t\t\t\tcase 'tilt':\r\n\t\t\t\t\t\t\t\t\t//$.hasGyroscope = true //!window.DeviceOrientationEvent;\r\n\t\t\t\t\t\t\t\t\t//_$element.get(0).addEventListener('devicemotion', _onDevicemotion, false);\r\n\t\t\t\t\t\t\t\t\t//_$element.get(0).addEventListener('deviceorientation', _onDeviceorientation, false);\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).addEventListener('devicemotion', _onDevicemotion, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// event:\r\n\t\t\t\t\t\t\t\t// - touchstart\r\n\t\t\t\t\t\t\t\t// - touchmove\r\n\t\t\t\t\t\t\t\t// - touchend\r\n\t\t\t\t\t\t\t\tcase 'tap':\r\n\t\t\t\t\t\t\t\tcase 'swipe':\r\n\t\t\t\t\t\t\t\tcase 'swipeup':\r\n\t\t\t\t\t\t\t\tcase 'swiperightup':\r\n\t\t\t\t\t\t\t\tcase 'swiperight':\r\n\t\t\t\t\t\t\t\tcase 'swiperightdown':\r\n\t\t\t\t\t\t\t\tcase 'swipedown':\r\n\t\t\t\t\t\t\t\tcase 'swipeleftdown':\r\n\t\t\t\t\t\t\t\tcase 'swipeleft':\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).addEventListener('touchstart', _onTouchstart, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// event: gestureend\r\n\t\t\t\t\t\t\t\tcase 'pinchopen':\r\n\t\t\t\t\t\t\t\tcase 'pinchclose' :\r\n\t\t\t\t\t\t\t\tcase 'rotatecw' :\r\n\t\t\t\t\t\t\t\tcase 'rotateccw' :\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).addEventListener('gesturestart', _onGesturestart, false);\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).addEventListener('gestureend', _onGestureend, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// event: gesturechange\r\n\t\t\t\t\t\t\t\tcase 'pinch':\r\n\t\t\t\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).addEventListener('gesturestart', _onGesturestart, false);\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).addEventListener('gesturechange', _onGesturechange, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// create substitute for gesture events\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tswitch(_sGestureEvent) {\r\n\t\t\t\t\t\t\t\t// event substitutes:\r\n\t\t\t\t\t\t\t\t// - touchstart: mousedown\r\n\t\t\t\t\t\t\t\t// - touchmove: none\r\n\t\t\t\t\t\t\t\t// - touchend: mouseup\r\n\t\t\t\t\t\t\t\tcase 'tap':\r\n\t\t\t\t\t\t\t\tcase 'swipe':\r\n\t\t\t\t\t\t\t\t\t// _$element.get(0).addEventListener('mousedown', _onTouchstart, false);\r\n\t\t\t\t\t\t\t\t\t _$element.bind('mousedown', _onTouchstart);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// no substitution\r\n\t\t\t\t\t\t\t\tcase 'orientationchange':\r\n\t\t\t\t\t\t\t\tcase 'pinchopen':\r\n\t\t\t\t\t\t\t\tcase 'pinchclose' :\r\n\t\t\t\t\t\t\t\tcase 'rotatecw' :\r\n\t\t\t\t\t\t\t\tcase 'rotateccw' :\r\n\t\t\t\t\t\t\t\tcase 'pinch':\r\n\t\t\t\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\t\t\tcase 'shake':\r\n\t\t\t\t\t\t\t\tcase 'tilt':\r\n\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t* For every $.bind(GESTURE) the add-function will be called.\r\n\t\t\t\t* Instead of binding an actual eventlister, the event is stored as $.data on the element.\r\n\t\t\t\t* The handler will be triggered using $.triggerHandler(GESTURE) if the internal\r\n\t\t\t\t* eventhandler (proxy being bound on setup()) detects a GESTURE event\r\n\t\t\t\t* @param {Object} event_ jQuery-Event-Object being passed by $.bind()\r\n\t\t\t\t* @return {Void}\r\n\t\t\t\t*/\r\n\t\t\t\tadd : function(event_) {\r\n\t\t\t\t\t// add pseudo event: properties on $.data\r\n\t\t\t\t\tvar _$element = jQuery(this);\r\n\t\t\t\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n//\t\t\t\t\t_oDatajQueryGestures[event_.type] = { 'originalType' : event_.type , 'threshold' : event_.data.threshold, 'preventDefault' : event_.data.preventDefault } ;\r\n\t\t\t\t\t_oDatajQueryGestures[event_.type] = { 'originalType' : event_.type } ;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t* For every $.unbind(GESTURE) the remove-function will be called.\r\n\t\t\t\t* Instead of removing the actual eventlister, the event is removed from $.data on the element.\r\n\t\t\t\t* @param {Object} event_ jQuery-Event-Object being passed by $.bind()\r\n\t\t\t\t* @return {Void}\r\n\t\t\t\t*/\r\n\t\t\t\tremove : function(event_) {\r\n\t\t\t\t\t// remove pseudo event: properties on $.data\r\n\t\t\t\t\tvar _$element = jQuery(this);\r\n\t\t\t\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n\t\t\t\t\t_oDatajQueryGestures[event_.type] = false;\r\n\t\t\t\t\t_$element.data('ojQueryGestures' ,_oDatajQueryGestures );\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t* The last $.unbind()-call on the domElement triggers the teardown function\r\n\t\t\t\t* removing the eventlistener\r\n\t\t\t\t* @return {Void}\r\n\t\t\t\t*/\r\n\t\t\t\t// @TODO: maybe rework teardown to work with event type?!\r\n\t\t\t\tteardown : function() {\r\n\t\t\t\t\t// split the arguments to necessary controll arguements\r\n\t\t\t\t\tvar _aSplit = sInternal_.split('_');\r\n\t\t\t\t\tvar _sDOMEvent = _aSplit[0]; //\r\n\t\t\t\t\t// get the associated gesture event and strip the counter: necessary for distinguisihng similliar events such as tapone-tapfour\r\n\t\t\t\t\tvar _sGestureEvent = _aSplit[1].slice(0,_aSplit[1].length-2);\r\n\t\t\t\t\tvar _$element = jQuery(this);\r\n\t\t\t\t\tvar _oDatajQueryGestures;\r\n\t\t\t\t\tvar oObj;\r\n\t\t\t\t\t// bind the event handler on the first $.bind() for a gestureend-event, set marker\r\n\t\t\t\t\tif (!_$element.data('ojQueryGestures') || !_$element.data('ojQueryGestures')[_sDOMEvent])  {\r\n\t\t\t\t\t\t// setup pseudo event\r\n\t\t\t\t\t\t_oDatajQueryGestures = _$element.data('ojQueryGestures') || {};\r\n\t\t\t\t\t\toObj = {};\r\n\t\t\t\t\t\t// remove marker for:  domEvent being set on this element\r\n\t\t\t\t\t\toObj[_sDOMEvent] = false;\r\n\t\t\t\t\t\t$.extend(true,_oDatajQueryGestures,oObj);\r\n\t\t\t\t\t\t_$element.data('ojQueryGestures' ,_oDatajQueryGestures);\r\n\r\n\t\t\t\t\t\t// remove gesture events\r\n\t\t\t\t\t\tif($.hasGestures) {\r\n\t\t\t\t\t\t\tswitch(_sGestureEvent) {\r\n\r\n\t\t\t\t\t\t\t\t// event: orientationchange\r\n\t\t\t\t\t\t\t\tcase 'orientationchange':\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('orientationchange', _onOrientationchange, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 'shake':\r\n\t\t\t\t\t\t\t\tcase 'shakefrontback':\r\n\t\t\t\t\t\t\t\tcase 'shakeleftright':\r\n\t\t\t\t\t\t\t\tcase 'shakeupdown':\r\n\t\t\t\t\t\t\t\tcase 'tilt':\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('devicemotion', _onDevicemotion, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// event :\r\n\t\t\t\t\t\t\t\t// - touchstart\r\n\t\t\t\t\t\t\t\t// - touchmove\r\n\t\t\t\t\t\t\t\t// - touchend\r\n\t\t\t\t\t\t\t\tcase 'tap':\r\n\t\t\t\t\t\t\t\tcase 'swipe':\r\n\t\t\t\t\t\t\t\tcase 'swipeup':\r\n\t\t\t\t\t\t\t\tcase 'swiperightup':\r\n\t\t\t\t\t\t\t\tcase 'swiperight':\r\n\t\t\t\t\t\t\t\tcase 'swiperightdown':\r\n\t\t\t\t\t\t\t\tcase 'swipedown':\r\n\t\t\t\t\t\t\t\tcase 'swipeleftdown':\r\n\t\t\t\t\t\t\t\tcase 'swipeleft':\r\n\t\t\t\t\t\t\t\tcase 'swipeleftup':\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('touchstart', _onTouchstart, false);\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('touchmove', _onTouchmove, false);\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('touchend', _onTouchend, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// event: gestureend\r\n\t\t\t\t\t\t\t\tcase 'pinchopen':\r\n\t\t\t\t\t\t\t\tcase 'pinchclose' :\r\n\t\t\t\t\t\t\t\tcase 'rotatecw' :\r\n\t\t\t\t\t\t\t\tcase 'rotateccw' :\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('gesturestart', _onGesturestart, false);\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('gestureend', _onGestureend, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// event: gesturechange\r\n\t\t\t\t\t\t\t\tcase 'pinch':\r\n\t\t\t\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('gesturestart', _onGesturestart, false);\r\n\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('gesturechange', _onGesturechange, false);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// remove substitute for gesture events\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tswitch(_sGestureEvent) {\r\n\t\t\t\t\t\t\t\t// event substitutes:\r\n\t\t\t\t\t\t\t\t// - touchstart: mousedown\r\n\t\t\t\t\t\t\t\t// - touchmove: none\r\n\t\t\t\t\t\t\t\t// - touchend: mouseup\r\n\t\t\t\t\t\t\t\tcase 'tap':\r\n\t\t\t\t\t\t\t\tcase 'swipe':\r\n//\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('mousedown', _onTouchstart, false);\r\n//\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('mousemove', _onTouchmove, false);\r\n//\t\t\t\t\t\t\t\t\t_$element.get(0).removeEventListener('mouseup', _onTouchend, false);\r\n\t\t\t\t\t\t\t\t\t_$element.unbind('mousedown', _onTouchstart);\r\n\t\t\t\t\t\t\t\t\t_$element.unbind('mousemove', _onTouchmove);\r\n\t\t\t\t\t\t\t\t\t_$element.unbind('mouseup', _onTouchend);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t// no substitution\r\n\t\t\t\t\t\t\t\tcase 'orientationchange':\r\n\t\t\t\t\t\t\t\tcase 'pinchopen':\r\n\t\t\t\t\t\t\t\tcase 'pinchclose' :\r\n\t\t\t\t\t\t\t\tcase 'rotatecw' :\r\n\t\t\t\t\t\t\t\tcase 'rotateccw' :\r\n\t\t\t\t\t\t\t\tcase 'pinch':\r\n\t\t\t\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\t\t\tcase 'shake':\r\n\t\t\t\t\t\t\t\tcase 'tilt':\r\n\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t/**\r\n\t* Creates the object that ist passed as second argument to the $element.triggerHandler function.\r\n\t* This object contains detailed informations about the gesture event.\r\n\t* @param {Object} oOptions_  {type: {String}, touches: {String}, deltaY: {String},deltaX : {String}, startMove: {Object}, event:{DOM-Event}, timestamp:{String},vector: {Number}}\r\n\t* @example _createOptions (\r\n\t*\t\t\t\t{\r\n\t*\t\t\t\t\ttype: 'swipemove',\r\n\t*\t\t\t\t\ttouches: '1',\r\n\t*\t\t\t\t\tdeltaY: _iDeltaY,\r\n\t*\t\t\t\t\tdeltaX : _iDeltaX,\r\n\t*\t\t\t\t\tstartMove: _oDatajQueryGestures.oStartTouch,\r\n\t*\t\t\t\t\tevent:event_,\r\n\t*\t\t\t\t\ttimestamp:_oEventData.timestamp,\r\n\t*\t\t\t\t\tvector: -1\r\n\t*\t\t\t\t}\r\n\t*\t\t\t);\r\n\t* @returns {Object}\r\n\t*\t\t\t{\r\n\t*\t\t\t\ttype: eventtype e.g. \"swipe\",\"pinch\",\r\n\t*\t\t\t\toriginalEvent: {DOM-Event},\r\n\t*\t\t\t\t// default: just one entry on the delta-array - the first touchpoint\r\n\t*\t\t\t\t// the first touchpoint is the reference point for every gesture,\r\n\t*\t\t\t\t// because moving touchpoints in various directions would result in\r\n\t*\t\t\t\t// a gesture.\r\n\t*\t\t\t\t// delta and direction details are just provided for touch not for gesture / motion events\r\n\t*\t\t\t\tdelta : [\r\n\t*\t\t\t\t\t{\r\n\t*\t\t\t\t\t\tlastX:{Number} , // x-axis: relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\t\tlastY:{Number}, // y-axis: relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\t\tmoved: {Number},  // distance: relative to the original touchpoint\r\n\t*\t\t\t\t\t\tstartX: {Number} , // relative to the original touchpoint\r\n\t*\t\t\t\t\t\tstartY: {Number} ,// relative to the original touchpoint\r\n\t*\t\t\t\t\t} ],\r\n\t*\t\t\t\t// based on the first touchpoint\r\n\t*\t\t\t\tdirection : { // relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tvector: {Number}, // -1|+1, indicates the direction if necessary(pinch/rotate)\r\n\t*\t\t\t\t\torientation: {Number} // window.orientation: -90,0,90,180 || null (window.orienntation)\r\n\t*\t\t\t\t\tlastX : {Number}, // -1,0,+1 relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tlastY : {Number}, // -1,0,+1 relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tstartX: {Number} , //-1,0,+1 relative to the original touchpoint\r\n\t*\t\t\t\t\tstartY: {Number} ,// -1,0,+1 relative to the original touchpoint\r\n\t*\t\t\t\t},\r\n\t*\t\t\t\trotation: {Number} || null, // gestureonly: amount of rotation relative to the current position NOT the original\r\n\t*\t\t\t\tscale: {Number} || null, // gestureonly: amount of scaling relative to the current position NOT the original\r\n\t*\t\t\t\tduration: {Number}, // ms: relative to the original touchpoint\r\n\t*\t\t\t\tdescription : {String} // details as String: {TYPE *}:{TOUCHES 1|2|3|4}:{X-AXIS 'right'|'left'|'steady'}:{Y-AXIS 'down'|'up'|'steady'} e.g. \"swipe:1:left:steady\" relative to the last touchpoint\r\n\t*\t\t\t};\r\n\t*/\r\n\tfunction _createOptions(oOptions_) {\r\n\t\t// force properties\r\n\t\toOptions_.startMove = (oOptions_.startMove) ? oOptions_.startMove : {startX: null,startY:null,timestamp:null}  ;\r\n\t\tvar _iNow = new Date().getTime();\r\n\t\tvar _oDirection;\r\n\t\tvar _oDelta;\r\n\t\t// calculate touch differences\r\n\t\tif (oOptions_.touches) {\r\n\t\t\t// store delta values\r\n\t\t\t_oDelta = [\r\n\t\t\t\t{\r\n\t\t\t\t\tlastX: oOptions_.deltaX ,\r\n\t\t\t\t\tlastY: oOptions_.deltaY,\r\n\t\t\t\t\tmoved: null,\r\n\t\t\t\t\tstartX:  oOptions_.screenX - oOptions_.startMove.screenX ,\r\n\t\t\t\t\tstartY: oOptions_.screenY - oOptions_.startMove.screenY\r\n\t\t\t\t}\r\n\t\t\t];\r\n\r\n\t\t\t_oDirection =  {\r\n\t\t\t\tvector: oOptions_.vector || null,\r\n\t\t\t\torientation : window.orientation || null,\r\n\t\t\t\tlastX : ((_oDelta[0].lastX > 0) ? +1 : ( (_oDelta[0].lastX < 0) ? -1 : 0 ) ),\r\n\t\t\t\tlastY : ((_oDelta[0].lastY > 0) ? +1 : ( (_oDelta[0].lastY < 0) ? -1 : 0 ) ),\r\n\t\t\t\tstartX : ((_oDelta[0].startX > 0) ? +1 : ( (_oDelta[0].startX < 0) ? -1 : 0 ) ),\r\n\t\t\t\tstartY : ((_oDelta[0].startY > 0) ? +1 : ( (_oDelta[0].startY < 0) ? -1 : 0 ) )\r\n\t\t\t};\r\n\r\n\t\t\t// calculate distance traveled using the pythagorean theorem\r\n\t\t\t_oDelta[0].moved =  Math.sqrt(Math.pow(Math.abs(_oDelta[0].startX), 2) + Math.pow(Math.abs(_oDelta[0].startY), 2));\r\n\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttype: oOptions_.type || null,\r\n\t\t\toriginalEvent: oOptions_.event || null,\r\n\t\t\tdelta : _oDelta  || null,\r\n\t\t\tdirection : _oDirection || { orientation : window.orientation || null, vector: oOptions_.vector || null},\r\n\t\t\tduration: (oOptions_.duration) ? oOptions_.duration : ( oOptions_.startMove.timestamp ) ? _iNow - oOptions_.timestamp : null,\r\n\t\t\trotation: oOptions_.rotation || null,\r\n\t\t\tscale: oOptions_.scale || null,\r\n\t\t\tdescription : oOptions_.description || [\r\n\t\t\t\toOptions_.type,\r\n\t\t\t\t':',\r\n\t\t\t\toOptions_.touches,\r\n\t\t\t\t':',\r\n\t\t\t\t((_oDelta[0].lastX != 0) ? ((_oDelta[0].lastX > 0) ? 'right' : 'left') : 'steady'),\r\n\t\t\t\t':',\r\n\t\t\t\t((_oDelta[0].lastY != 0) ? ( (_oDelta[0].lastY > 0) ? 'down' : 'up') :'steady')\r\n\t\t\t\t].join('')\r\n\t\t};\r\n\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t* DOM-event handlers\r\n\t*/\r\n\r\n\t/**\r\n\t* Handler: orientationchange\r\n\t* Triggers the bound orientationchange handler on the window element\r\n\t* The \"orientationchange\" handler will receive an object with additional information\r\n\t* about the event.\r\n\t*  {\r\n\t*\tdirection : {\r\n\t*\t\torientation: {-90|0|90|180}\r\n\t*\t},\r\n\t*\tdescription : [\r\n\t*\t\t'orientationchange:{landscape:clockwise:|portrait:default|landscape:counterclockwise|portrait:upsidedown}:{-90|0|90|180}' // e.g. 'orientation:landscape:clockwise:-90\r\n\t*\t}\r\n\t* @param {DOM-Event} event_\r\n\t* @return {Void}\r\n\t*/\r\n\tfunction _onOrientationchange(event_) {\r\n\r\n\t\t// window.orientation: -90,0,90,180\r\n\t\tvar _aDict = ['landscape:clockwise:','portrait:default:','landscape:counterclockwise:','portrait:upsidedown:'];\r\n\r\n\t\t$(window).triggerHandler('orientationchange',\r\n\t\t\t{\r\n\t\t\t\tdirection : {orientation: window.orientation},\r\n\t\t\t\tdescription : [\r\n\t\t\t\t\t'orientationchange:',\r\n\t\t\t\t\t_aDict[( (window.orientation / 90) +1)],\r\n\t\t\t\t\twindow.orientation\r\n\t\t\t\t\t].join('')\r\n\t\t\t});\r\n\t}\r\n\r\n\r\n\t/**\r\n\t* Handler: devicemotion\r\n\t* Calculates \"motion events\" such as shake, tilt, wiggle by observing \"changes in space\"\r\n\t* For understanding \"directions\", place your mobile device on a table with the bottom\r\n\t* (home button) close to you:\r\n\t*  - x-axis: horizontal left / right\r\n\t*  - y-axis: horizontal front / back (through the home button)\r\n\t*  - z-axis: vertical through your device\r\n\t* @param {DOM-Event} event_\r\n\t* @returns {Object}\r\n\t*\t\t\t{\r\n\t*\t\t\t\ttype: eventtype e.g. \"shake\",\r\n\t*\t\t\t\toriginalEvent: {DOM-Event},\r\n\t*\t\t\t\t// delta and direction details are just provided for touch not for gesture / motion events\r\n\t*\t\t\t\tdelta : null,\r\n\t*\t\t\t\tdirection :{\r\n\t*\t\t\t\t\tvector: null,\r\n\t*\t\t\t\t\torientation: -90,0,90,180 || null (window.orienntation)\r\n\t*\t\t\t\t}\r\n\t*\t\t\t\trotation: {Number} , //  amount of rotation relative to the current position NOT the original\r\n\t*\t\t\t\tscale: {Number} , // amount of scaling relative to the current position NOT the original\r\n\t*\t\t\t\tduration: {Number}, // ms: duration of the motion\r\n\t*\t\t\t\tdescription : {String} // details as String: pinch:{'close'|'open'} e.g. \"pinch:-1:close\" ||  rotate:{'counterclockwise'|'clockwise'} e.g. \"rotate:-1:counterclockwise\"\r\n\t*\t\t\t};\r\n\t* @param {DOM-Event} event_\r\n\t* @return {Void}\r\n\t*/\r\n\tfunction _onDevicemotion(event_) {\r\n\r\n\t\tvar _sType;\r\n\t\tvar _$element = jQuery(window);\r\n\t\t//var _bHasGyroscope = $.hasGyroscope;\r\n\r\n\t\t// skip custom notification: devicemotion is triggered every 0.05s regardlesse of any gesture\r\n\r\n\t\t// get options\r\n\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n\r\n\t\tvar _oThreshold = $.jGestures.defaults.thresholdShake;\r\n\r\n\t\t// get last position or set initital values\r\n\t\tvar _oLastDevicePosition = _oDatajQueryGestures.oDeviceMotionLastDevicePosition || {\r\n\t\t\taccelerationIncludingGravity : {\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0,\r\n\t\t\t\tz: 0\r\n\t\t\t},\r\n\t\t\tshake : {\r\n\t\t\t\teventCount: 0,\r\n\t\t\t\tintervalsPassed: 0,\r\n\t\t\t\tintervalsFreeze: 0\r\n\t\t\t},\r\n\t\t\tshakeleftright : {\r\n\t\t\t\teventCount: 0,\r\n\t\t\t\tintervalsPassed: 0,\r\n\t\t\t\tintervalsFreeze: 0\r\n\t\t\t},\r\n\t\t\tshakefrontback : {\r\n\t\t\t\teventCount: 0,\r\n\t\t\t\tintervalsPassed: 0,\r\n\t\t\t\tintervalsFreeze: 0\r\n\t\t\t},\r\n\t\t\tshakeupdown : {\r\n\t\t\t\teventCount: 0,\r\n\t\t\t\tintervalsPassed: 0,\r\n\t\t\t\tintervalsFreeze: 0\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// cache current values\r\n\t\tvar _oCurrentDevicePosition = {\r\n\t\t\taccelerationIncludingGravity : {\r\n\t\t\t\tx: event_.accelerationIncludingGravity.x,\r\n\t\t\t\ty: event_.accelerationIncludingGravity.y,\r\n\t\t\t\tz: event_.accelerationIncludingGravity.z\r\n\t\t\t},\r\n\t\t\tshake: {\r\n\t\t\t\teventCount: _oLastDevicePosition.shake.eventCount,\r\n\t\t\t\tintervalsPassed: _oLastDevicePosition.shake.intervalsPassed,\r\n\t\t\t\tintervalsFreeze: _oLastDevicePosition.shake.intervalsFreeze\r\n\t\t\t },\r\n\t\t\t shakeleftright: {\r\n\t\t\t\teventCount: _oLastDevicePosition.shakeleftright.eventCount,\r\n\t\t\t\tintervalsPassed: _oLastDevicePosition.shakeleftright.intervalsPassed,\r\n\t\t\t\tintervalsFreeze: _oLastDevicePosition.shakeleftright.intervalsFreeze\r\n\t\t\t },\r\n\t\t\t shakefrontback: {\r\n\t\t\t\teventCount: _oLastDevicePosition.shakefrontback.eventCount,\r\n\t\t\t\tintervalsPassed: _oLastDevicePosition.shakefrontback.intervalsPassed,\r\n\t\t\t\tintervalsFreeze: _oLastDevicePosition.shakefrontback.intervalsFreeze\r\n\t\t\t },\r\n\t\t\t shakeupdown: {\r\n\t\t\t\teventCount: _oLastDevicePosition.shakeupdown.eventCount,\r\n\t\t\t\tintervalsPassed: _oLastDevicePosition.shakeupdown.intervalsPassed,\r\n\t\t\t\tintervalsFreeze: _oLastDevicePosition.shakeupdown.intervalsFreeze\r\n\t\t\t }\r\n\r\n\t\t};\r\n\r\n\r\n\t\t// options\r\n\t\tvar _aType;\r\n\t\tvar _aDescription;\r\n\t\tvar _oObj;\r\n\r\n\r\n\t\t// trigger events for all bound pseudo events on this element\r\n\t\tfor (_sType in _oDatajQueryGestures) {\r\n\t\t\t// get current pseudo event\r\n\r\n\r\n\t\t\t// trigger bound events on this element\r\n\t\t\tswitch(_sType) {\r\n\r\n\t\t\t\tcase 'shake':\r\n\t\t\t\tcase 'shakeleftright':\r\n\t\t\t\tcase 'shakefrontback':\r\n\t\t\t\tcase 'shakeupdown':\r\n\r\n\t\t\t\t\t// options\r\n\t\t\t\t\t_aType = [];\r\n\t\t\t\t\t_aDescription = [];\r\n\r\n\t\t\t\t\t_aType.push(_sType);\r\n\r\n\t\t\t\t\t// freeze shake - prevent multiple shake events on one  shaking motion (user won't stop shaking immediately)\r\n\t\t\t\t\tif (++_oCurrentDevicePosition[_sType].intervalsFreeze > _oThreshold.freezeShakes && _oCurrentDevicePosition[_sType].intervalsFreeze < (2*_oThreshold.freezeShakes) ) { break;\t}\r\n\r\n\t\t\t\t\t// set control values\r\n\t\t\t\t\t_oCurrentDevicePosition[_sType].intervalsFreeze  = 0;\r\n\t\t\t\t\t_oCurrentDevicePosition[_sType].intervalsPassed++;\r\n\r\n\t\t\t\t\t// check for shaking motions: massive acceleration changes in every direction\r\n\t\t\t\t\tif ( ( _sType === 'shake' ||_sType === 'shakeleftright' ) && ( _oCurrentDevicePosition.accelerationIncludingGravity.x > _oThreshold.leftright.sensitivity  || _oCurrentDevicePosition.accelerationIncludingGravity.x < (-1* _oThreshold.leftright.sensitivity) ) ) {\r\n\t\t\t\t\t\t_aType.push('leftright');\r\n\t\t\t\t\t\t_aType.push('x-axis');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( ( _sType === 'shake' ||_sType === 'shakefrontback' ) && (_oCurrentDevicePosition.accelerationIncludingGravity.y > _oThreshold.frontback.sensitivity  || _oCurrentDevicePosition.accelerationIncludingGravity.y < (-1 * _oThreshold.frontback.sensitivity) ) ) {\r\n\t\t\t\t\t\t_aType.push('frontback');\r\n\t\t\t\t\t\t_aType.push('y-axis');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( ( _sType === 'shake' ||_sType === 'shakeupdown' ) && ( _oCurrentDevicePosition.accelerationIncludingGravity.z+9.81 > _oThreshold.updown.sensitivity  || _oCurrentDevicePosition.accelerationIncludingGravity.z+9.81 < (-1 * _oThreshold.updown.sensitivity) ) ) {\r\n\t\t\t\t\t\t_aType.push('updown');\r\n\t\t\t\t\t\t_aType.push('z-axis');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// at least one successful shaking event\r\n\t\t\t\t\tif (_aType.length > 1) {\r\n\t\t\t\t\t\t// minimum number of shaking motions during  the defined \"time\" (messured by events - device event interval: 0.05s)\r\n\t\t\t\t\t\tif (++_oCurrentDevicePosition[_sType].eventCount == _oThreshold.requiredShakes && (_oCurrentDevicePosition[_sType].intervalsPassed) < _oThreshold.freezeShakes ) {\r\n\t\t\t\t\t\t\t// send event\r\n\t\t\t\t\t\t\t_$element.triggerHandler(_sType, _createOptions ({type: _sType, description: _aType.join(':'), event:event_,duration:_oCurrentDevicePosition[_sType].intervalsPassed*5 }) );\r\n\t\t\t\t\t\t\t// reset\r\n\t\t\t\t\t\t\t_oCurrentDevicePosition[_sType].eventCount = 0;\r\n\t\t\t\t\t\t\t_oCurrentDevicePosition[_sType].intervalsPassed = 0;\r\n\t\t\t\t\t\t\t// freeze shake\r\n\t\t\t\t\t\t\t_oCurrentDevicePosition[_sType].intervalsFreeze = _oThreshold.freezeShakes+1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// too slow, reset\r\n\t\t\t\t\t\telse if (_oCurrentDevicePosition[_sType].eventCount == _oThreshold.requiredShakes && (_oCurrentDevicePosition[_sType].intervalsPassed) > _oThreshold.freezeShakes ) {\r\n\t\t\t\t\t\t\t_oCurrentDevicePosition[_sType].eventCount = 0 ;\r\n\t\t\t\t\t\t\t_oCurrentDevicePosition[_sType].intervalsPassed = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// refresh pseudo events\r\n\t\t\t_oObj = {};\r\n\t\t\t_oObj.oDeviceMotionLastDevicePosition = _oCurrentDevicePosition;\r\n\t\t\t_$element.data('ojQueryGestures',$.extend(true,_oDatajQueryGestures,_oObj));\r\n\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t* Handler: touchstart or mousedown\r\n\t* Setup pseudo-event by storing initial values such as :\r\n\t*\tscreenX : {Number}\r\n\t*\tscreenY : {Number}\r\n\t*\ttimestamp: {Number}\r\n\t*  on the pseudo gesture event and\r\n\t*  sets up additional eventlisteners for handling touchmove events.\r\n\t* @param {DOM-Event} event_\r\n\t* @return {Void}\r\n\t*/\r\n\tfunction _onTouchstart(event_) {\r\n\r\n\t\t// ignore bubbled handlers\r\n\t\t// if ( event_.currentTarget !== event_.target ) { return; }\r\n\r\n\t\tvar _$element = jQuery(event_.currentTarget);\r\n\t\t// var _$element = jQuery(event_.target);\r\n\r\n\t\t// trigger custom notification\r\n\t\t_$element.triggerHandler($.jGestures.events.touchstart,event_);\r\n\r\n\r\n\t\t// set the necessary touch events\r\n\t\tif($.hasGestures) {\r\n\t\t\tevent_.currentTarget.addEventListener('touchmove', _onTouchmove, false);\r\n\t\t\tevent_.currentTarget.addEventListener('touchend', _onTouchend, false);\r\n\t\t}\r\n\t\t// event substitution\r\n\t\telse {\r\n//\t\t\tevent_.currentTarget.addEventListener('mousemove', _onTouchmove, false);\r\n//\t\t\tevent_.currentTarget.addEventListener('mouseup', _onTouchend, false);\r\n\t\t\t_$element.bind('mousemove', _onTouchmove);\r\n\t\t\t_$element.bind('mouseup', _onTouchend);\r\n\t\t}\r\n\r\n\t\t// get stored pseudo event\r\n\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n\r\n\t\t// var _oEventData = _oDatajQueryGestures[_sType];\r\n\t\tvar _eventBase = (event_.touches) ? event_.touches[0] : event_;\r\n\t\t// store current values for calculating relative values (changes between touchmoveevents)\r\n\t\tvar _oObj = {};\r\n\t\t_oObj.oLastSwipemove = { screenX : _eventBase.screenX, screenY : _eventBase.screenY, timestamp:new Date().getTime()};\r\n\t\t_oObj.oStartTouch = { screenX : _eventBase.screenX, screenY : _eventBase.screenY, timestamp:new Date().getTime()};\r\n\r\n\t\t_$element.data('ojQueryGestures',$.extend(true,_oDatajQueryGestures,_oObj));\r\n\t}\r\n\r\n\r\n\t/**\r\n\t* Handler: touchmove or mousemove\r\n\t* Calculates the x/y changes since the last event,\r\n\t* compares it to $.jGestures.defaults.thresholdMove and triggers\r\n\t* an swipemove event if the distance exceed the\r\n\t* threshold.\r\n\t* Custom-event argument object:\r\n\t* {Object}\r\n\t*\t\t\t{\r\n\t*\t\t\t\ttype: e.g. 'swipemove',\r\n\t*\t\t\t\t≈: {DOM-Event},\r\n\t*\t\t\t\t// default: just one entry on the delta-array - the first touchpoint\r\n\t*\t\t\t\t// the first touchpoint is the reference point for every gesture,\r\n\t*\t\t\t\t// because moving touchpoints in various directions would result in\r\n\t*\t\t\t\t// a gesture.\r\n\t*\t\t\t\t// delta and direction details are just provided for touch not for gesture / motion events\r\n\t*\t\t\t\tdelta : [\r\n\t*\t\t\t\t\t{\r\n\t*\t\t\t\t\t\tlastX:{Number} , // x-axis: relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\t\tlastY:{Number}, // y-axis: relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\t\tmoved: {Number},  // distance: relative to the original touchpoint\r\n\t*\t\t\t\t\t\tstartX: {Number} , // relative to the original touchpoint\r\n\t*\t\t\t\t\t\tstartY: {Number} ,// relative to the original touchpoint\r\n\t*\t\t\t\t\t} ],\r\n\t*\t\t\t\t// based on the first touchpoint\r\n\t*\t\t\t\tdirection : { // relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tvector: {Number}, // -1|+1, indicates the direction if necessary(pinch/rotate)\r\n\t*\t\t\t\t\torientation: {Number} // window.orientation: -90,0,90,180 || null (window.orienntation)\r\n\t*\t\t\t\t\tlastX : {Number}, // -1,0,+1 relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tlastY : {Number}, // -1,0,+1 relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tstartX: {Number} , //-1,0,+1 relative to the original touchpoint\r\n\t*\t\t\t\t\tstartY: {Number} ,// -1,0,+1 relative to the original touchpoint\r\n\t*\t\t\t\t},\r\n\t*\t\t\t\trotation: null, // gestureonly: amount of rotation relative to the current position NOT the original\r\n\t*\t\t\t\tscale: null, // gestureonly: amount of scaling relative to the current position NOT the original\r\n\t*\t\t\t\tduration: {Number}, // ms: relative to the original touchpoint\r\n\t*\t\t\t\tdescription : {String} // details as String: {TYPE *}:{TOUCHES 1|2|3|4}:{X-AXIS 'right'|'left'|'steady'}:{Y-AXIS 'down'|'up'|'steady'} e.g. \"swipe:1:left:steady\" relative to the last touchpoint\r\n\t*\t\t\t};\r\n\t*\r\n\t* @param {DOM-Event} event_\r\n\t* @return {Void}\r\n\t*/\r\n\tfunction _onTouchmove(event_) {\r\n\r\n\t\tvar _$element = jQuery(event_.currentTarget);\r\n\t\t// var _$element = jQuery(event_.target);\r\n\r\n\t\t// get stored pseudo event\r\n\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n\r\n\t\tvar _bHasTouches = !!event_.touches;\r\n\t\tvar _iScreenX = (_bHasTouches) ? event_.changedTouches[0].screenX : event_.screenX;\r\n\t\tvar _iScreenY = (_bHasTouches) ? event_.changedTouches[0].screenY : event_.screenY;\r\n\r\n\t\t//relative to the last event\r\n\t\tvar _oEventData = _oDatajQueryGestures.oLastSwipemove;\r\n\t\tvar _iDeltaX = _iScreenX - _oEventData.screenX   ;\r\n\t\tvar _iDeltaY = _iScreenY - _oEventData.screenY;\r\n\r\n\t\tvar _oDetails;\r\n\r\n\t\t\t// there's a swipemove set (not the first occurance), trigger event\r\n\t\tif (!!_oDatajQueryGestures.oLastSwipemove) {\r\n\t\t\t// check\r\n\t\t\t_oDetails = _createOptions({type: 'swipemove', touches: (_bHasTouches) ? event_.touches.length: '1', screenY: _iScreenY,screenX:_iScreenX ,deltaY: _iDeltaY,deltaX : _iDeltaX, startMove:_oEventData, event:event_, timestamp:_oEventData.timestamp});\r\n\t\t\t_$element.triggerHandler(_oDetails.type,_oDetails);\r\n\t\t}\r\n\t\t// store the new values\r\n\t\tvar _oObj = {};\r\n\t\tvar _eventBase = (event_.touches) ? event_.touches[0] : event_;\r\n\t\t_oObj.oLastSwipemove = { screenX : _eventBase.screenX, screenY : _eventBase.screenY, timestamp:new Date().getTime()};\r\n\t\t_$element.data('ojQueryGestures',$.extend(true,_oDatajQueryGestures,_oObj));\r\n\t}\r\n\r\n\r\n\t/**\r\n\t* Handler: touchend or mouseup\r\n\t* Removes the additional handlers (move/end)\r\n\t* Calculates the x/y changes since the touchstart event\r\n\t* not in relation to the last move event.\r\n\t* Triggers the\r\n\t*\tswipeone|swipetwo|swipethree|swipefour|\r\n\t*\tswipeup|swiperightup|swiperight|swiperightdown|swipedown|\r\n\t*\tswipeleftdown|swipeleft|swipeleftup|\r\n\t*\ttapone|taptwo|tapthree|tapfour\r\n\t* event.\r\n\t*\t\t{Object}\r\n\t*\t\t\t{\r\n\t*\t\t\t\ttype: eventtype e.g. \"swipeone\",\"swipeleftdown\",\r\n\t*\t\t\t\toriginalEvent: {DOM-Event},\r\n\t*\t\t\t\t// default: just one entry on the delta-array - the first touchpoint\r\n\t*\t\t\t\t// the first touchpoint is the reference point for every gesture,\r\n\t*\t\t\t\t// because moving touchpoints in various directions would result in\r\n\t*\t\t\t\t// a gesture.\r\n\t*\t\t\t\t// delta and direction details are just provided for touch not for gesture / motion events\r\n\t*\t\t\t\tdelta : [\r\n\t*\t\t\t\t\t{\r\n\t*\t\t\t\t\t\tlastX:{Number} , // x-axis: relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\t\tlastY:{Number}, // y-axis: relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\t\tmoved: {Number},  // distance: relative to the original touchpoint\r\n\t*\t\t\t\t\t\tstartX: {Number} , // relative to the original touchpoint\r\n\t*\t\t\t\t\t\tstartY: {Number} ,// relative to the original touchpoint\r\n\t*\t\t\t\t\t} ],\r\n\t*\t\t\t\t// based on the first touchpoint\r\n\t*\t\t\t\tdirection : { // relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tvector: {Number}, // -1|+1, indicates the direction if necessary(pinch/rotate)\r\n\t*\t\t\t\t\torientation: {Number} // window.orientation: -90,0,90,180 || null (window.orienntation)\r\n\t*\t\t\t\t\tlastX : {Number}, // -1,0,+1 relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tlastY : {Number}, // -1,0,+1 relative to the last touchevent (e.g. touchmove!)\r\n\t*\t\t\t\t\tstartX: {Number} , //-1,0,+1 relative to the original touchpoint\r\n\t*\t\t\t\t\tstartY: {Number} ,// -1,0,+1 relative to the original touchpoint\r\n\t*\t\t\t\t},\r\n\t*\t\t\t\trotation: null,\r\n\t*\t\t\t\tscale: null ,\r\n\t*\t\t\t\tduration: {Number}, // ms: relative to the original touchpoint\r\n\t*\t\t\t\tdescription : {String} // details as String: {TYPE *}:{TOUCHES 1|2|3|4}:{X-AXIS 'right'|'left'|'steady'}:{Y-AXIS 'down'|'up'|'steady'} e.g. \"swipe:1:left:steady\" relative to the last touchpoint\r\n\t*\t\t\t};\r\n\t* @param {DOM-Event} event_\r\n\t* @return {Void}\r\n\t*/\r\n\tfunction _onTouchend(event_) {\r\n\r\n\t\t// ignore bubbled handlers\r\n\t\t// if ( event_.currentTarget !== event_.target ) { return; }\r\n\r\n\t\tvar _$element = jQuery(event_.currentTarget);\r\n\t\tvar _bHasTouches = !!event_.changedTouches;\r\n\t\tvar _iTouches = (_bHasTouches) ? event_.changedTouches.length : '1';\r\n\t\tvar _iScreenX = (_bHasTouches) ? event_.changedTouches[0].screenX : event_.screenX;\r\n\t\tvar _iScreenY = (_bHasTouches) ? event_.changedTouches[0].screenY : event_.screenY;\r\n\r\n\t\t// trigger custom notification\r\n\t\t_$element.triggerHandler($.jGestures.events.touchendStart,event_);\r\n\r\n\t\t// var _$element = jQuery(event_.target);\r\n\t\t// remove events\r\n\t\tif($.hasGestures) {\r\n\t\t\tevent_.currentTarget.removeEventListener('touchmove', _onTouchmove, false);\r\n\t\t\tevent_.currentTarget.removeEventListener('touchend', _onTouchend, false);\r\n\t\t}\r\n\t\t// event substitution\r\n\t\telse {\r\n//\t\t\tevent_.currentTarget.removeEventListener('mousemove', _onTouchmove, false);\r\n//\t\t\tevent_.currentTarget.removeEventListener('mouseup', _onTouchend, false);\r\n\t\t\t_$element.unbind('mousemove', _onTouchmove);\r\n\t\t\t_$element.unbind('mouseup', _onTouchend);\r\n\t\t}\r\n\t\t// get all bound pseudo events\r\n\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n\r\n\t\t// if the current change on the x/y position is above the defined threshold for moving an element set the moved flag\r\n\t\t// to distinguish between a moving gesture and a shaking finger trying to tap\r\n\t\tvar _bHasMoved = (\r\n\t\t\tMath.abs(_oDatajQueryGestures.oStartTouch.screenX - _iScreenX) > $.jGestures.defaults.thresholdMove ||\r\n\t\t\tMath.abs(_oDatajQueryGestures.oStartTouch.screenY - _iScreenY) > $.jGestures.defaults.thresholdMove\r\n\t\t) ? true : false;\r\n\r\n\t\t// if the current change on the x/y position is above the defined threshold for swiping set the moved flag\r\n\t\t// to indicate we're dealing with a swipe gesture\r\n\t\tvar _bHasSwipeGesture = (\r\n\t\t\tMath.abs(_oDatajQueryGestures.oStartTouch.screenX - _iScreenX) > $.jGestures.defaults.thresholdSwipe ||\r\n\t\t\tMath.abs(_oDatajQueryGestures.oStartTouch.screenY - _iScreenY) > $.jGestures.defaults.thresholdSwipe\r\n\t\t) ? true : false;\r\n\r\n\r\n\t\tvar _sType;\r\n\t\tvar _oEventData ;\r\n\r\n\t\tvar _oDelta;\r\n\r\n\t\t// calculate distances in relation to the touchstart position not the last touchmove event!\r\n\t\tvar _iDeltaX;\r\n\t\tvar _iDeltaY;\r\n\t\tvar _oDetails;\r\n\r\n\t\tvar _aDict = ['zero','one','two','three','four'];\r\n\r\n\t\t// swipe marker\r\n\t\tvar _bIsSwipe;\r\n\r\n\r\n\t\t// trigger events for all bound pseudo events on this element\r\n\t\tfor (_sType in _oDatajQueryGestures) {\r\n\r\n\t\t\t// get current pseudo event\r\n\t\t\t_oEventData = _oDatajQueryGestures.oStartTouch;\r\n\r\n\t\t\t_oDelta = {};\r\n\t\t\t_iScreenX = (_bHasTouches) ? event_.changedTouches[0].screenX : event_.screenX;\r\n\t\t\t_iScreenY = (_bHasTouches) ? event_.changedTouches[0].screenY : event_.screenY;\r\n\t\t\t// calculate distances in relation to the touchstart position not the last touchmove event!\r\n\t\t\t_iDeltaX = _iScreenX - _oEventData.screenX ;\r\n\t\t\t_iDeltaY = _iScreenY - _oEventData.screenY;\r\n\t\t\t_oDetails = _createOptions({type: 'swipe', touches: _iTouches, screenY: _iScreenY,screenX:_iScreenX ,deltaY: _iDeltaY,deltaX : _iDeltaX, startMove:_oEventData, event:event_, timestamp:  _oEventData.timestamp });\r\n\r\n\r\n\t\t\t// swipe marker\r\n\t\t\t_bIsSwipe = false;\r\n\r\n\t\t\t// trigger bound events on this element\r\n\t\t\tswitch(_sType) {\r\n\t\t\t\tcase 'swipeone':\r\n\r\n\t\t\t\t\tif( _bHasTouches === false && _iTouches == 1 && _bHasMoved === false){\r\n\t\t\t\t\t\t// trigger tapone!\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_bHasTouches===false || ( _iTouches == 1  && _bHasMoved === true && _bHasSwipeGesture===true)) {\r\n\t\t\t\t\t\t_bIsSwipe = true;\r\n\r\n\t\t\t\t\t\t_oDetails.type = ['swipe',_aDict[_iTouches]].join('');\r\n\t\t\t\t\t\t_$element.triggerHandler(_oDetails.type,_oDetails);\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'swipetwo':\r\n\t\t\t\t\tif (( _bHasTouches && _iTouches== 2 && _bHasMoved === true && _bHasSwipeGesture===true)) {\r\n\t\t\t\t\t\t_bIsSwipe = true;\r\n\t\t\t\t\t\t_oDetails.type = ['swipe',_aDict[_iTouches]].join('');\r\n\t\t\t\t\t\t_$element.triggerHandler(_oDetails.type,_oDetails);\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'swipethree':\r\n\t\t\t\t\tif ( ( _bHasTouches && _iTouches == 3 && _bHasMoved === true && _bHasSwipeGesture===true)) {\r\n\t\t\t\t\t\t_bIsSwipe = true;\r\n\t\t\t\t\t\t_oDetails.type = ['swipe',_aDict[_iTouches]].join('');\r\n\t\t\t\t\t\t_$element.triggerHandler(_oDetails.type,_oDetails);\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'swipefour':\r\n\t\t\t\t\tif ( ( _bHasTouches && _iTouches == 4 && _bHasMoved === true && _bHasSwipeGesture===true)) {\r\n\t\t\t\t\t\t_bIsSwipe = true;\r\n\t\t\t\t\t\t_oDetails.type = ['swipe',_aDict[_iTouches]].join('');\r\n\t\t\t\t\t\t_$element.triggerHandler(_oDetails.type,_oDetails);\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'swipeup':\r\n\t\t\t\tcase 'swiperightup':\r\n\t\t\t\tcase 'swiperight':\r\n\t\t\t\tcase 'swiperightdown':\r\n\t\t\t\tcase 'swipedown':\r\n\t\t\t\tcase 'swipeleftdown':\r\n\t\t\t\tcase 'swipeleft':\r\n\t\t\t\tcase 'swipeleftup':\r\n\t\t\t\t\tif ( _bHasTouches && _bHasMoved === true && _bHasSwipeGesture===true) {\r\n\t\t\t\t\t\t_bIsSwipe = true;\r\n\t\t\t\t\t\t_oDetails.type = [\r\n\t\t\t\t\t\t\t\t\t'swipe',\r\n\t\t\t\t\t\t\t\t((_oDetails.delta[0].lastX != 0) ? ((_oDetails.delta[0].lastX > 0) ? 'right' : 'left') : ''),\r\n\t\t\t\t\t\t\t\t((_oDetails.delta[0].lastY != 0) ? ((_oDetails.delta[0].lastY > 0) ? 'down' : 'up') :'')\r\n\t\t\t\t\t\t\t\t\t].join('');\r\n\t\t\t\t\t\t_$element.triggerHandler(_oDetails.type, _oDetails);\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'tapone':\r\n\t\t\t\tcase 'taptwo':\r\n\t\t\t\tcase 'tapthree':\r\n\t\t\t\tcase 'tapfour':\r\n\t\t\t\t\tif (( /* _bHasTouches && */ _bHasMoved !== true && _bIsSwipe !==true) && (_aDict[_iTouches] ==_sType.slice(3)) ) {\r\n\t\t\t\t\t\t_oDetails.description = ['tap',_aDict[_iTouches]].join('');\r\n\t\t\t\t\t\t_oDetails.type = ['tap',_aDict[_iTouches]].join('');\r\n\t\t\t\t\t\t_$element.triggerHandler(_oDetails.type,_oDetails);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// refresh pseudo events\r\n\t\t\tvar _oObj = {};\r\n//\t\t\t_oObj[_sType] = false;\r\n//\t\t\t_oObj.hasTouchmoved = false;\r\n\t\t\t_$element.data('ojQueryGestures',$.extend(true,_oDatajQueryGestures,_oObj));\r\n\t\t\t_$element.data('ojQueryGestures',$.extend(true,_oDatajQueryGestures,_oObj));\r\n\r\n\t\t}\r\n\t\t_$element.triggerHandler($.jGestures.events.touchendProcessed,event_);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t* Handler: gesturestart\r\n\t* Setup pseudo-event by storing initial values such as :\r\n\t*\ttimestamp: {Number}\r\n\t*  on the pseudo gesture event\r\n\t* Since the gesture-event doesn't supply event.touches no tuchpoints will be calculated\r\n\t* @param {DOM-Event} event_\r\n\t* @return {Void}\r\n\t*/\r\n\tfunction _onGesturestart(event_) {\r\n\r\n\t\t// ignore bubbled handlers\r\n\t\t// if ( event_.currentTarget !== event_.target ) { return; }\r\n\r\n\t\tvar _$element = jQuery(event_.currentTarget);\r\n\t\t// var _$element = jQuery(event_.target);\r\n\r\n\t\t// trigger custom notification\r\n\t\t_$element.triggerHandler($.jGestures.events.gesturestart,event_);\r\n\r\n\r\n\t\t// get stored pseudo event\r\n\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n\r\n\t\t// var _oEventData = _oDatajQueryGestures[_sType];\r\n\t\t// store current values for calculating relative values (changes between touchmoveevents)\r\n\t\tvar _oObj = {};\r\n\t\t_oObj.oStartTouch = {timestamp:new Date().getTime()};\r\n\t\t_$element.data('ojQueryGestures',$.extend(true,_oDatajQueryGestures,_oObj));\r\n\t}\r\n\r\n\t/**\r\n\t* Handler: gesturechange\r\n\t* Read the event_.scale / event_.rotate values,\r\n\t* an triggers a pinch|rotate event if necessary.\r\n\t* Since the gesture-event doesn't supply event.touches no tuchpoints will be calculated\r\n\t* @returns {Object}\r\n\t*\t\t\t{\r\n\t*\t\t\t\ttype: eventtype e.g. \"pinch\",\"rotate\",\r\n\t*\t\t\t\toriginalEvent: {DOM-Event},\r\n\t*\t\t\t\t// delta and direction details are just provided for touch not for gesture / motion events\r\n\t*\t\t\t\tdelta : null,\r\n\t*\t\t\t\tdirection : {\r\n\t*\t\t\t\t\tvector: {Number}, // -1|+1, indicates the direction if necessary(pinch/rotate)\r\n\t*\t\t\t\t\t orientation: {Number} // window.orientation: -90,0,90,180 || null (window.orienntation)\r\n\t*\t\t\t\t },\r\n\t*\t\t\t\trotation: {Number} , //  amount of rotation relative to the current position NOT the original\r\n\t*\t\t\t\tscale: {Number} , // amount of scaling relative to the current position NOT the original\r\n\t*\t\t\t\tduration: {Number}, // ms: relative to the original touchpoint\r\n\t*\t\t\t\tdescription : {String} // details as String: pinch:{'close'|'open'} e.g. \"pinch:-1:close\" ||  rotate:{'counterclockwise'|'clockwise'} e.g. \"rotate:-1:counterclockwise\"\r\n\t*\t\t\t};\r\n\t* @param {DOM-Event} event_\r\n\t* @return {Void}\r\n\t*/\r\n\tfunction _onGesturechange(event_) {\r\n\r\n\t\t// ignore bubbled handlers\r\n\t\t// if ( event_.currentTarget !== event_.target ) { return; }\r\n\r\n\t\tvar _$element = jQuery(event_.currentTarget);\r\n\t\t// var _$element = jQuery(event_.target);\r\n\t\tvar _iDelta,_iDirection,_sDesc,_oDetails;\r\n\t\t// get all pseudo events\r\n\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n\r\n\t\t// trigger events for all bound pseudo events on this element\r\n\t\tvar _sType;\r\n\t\tfor (_sType in _oDatajQueryGestures) {\r\n\r\n\t\t\t// trigger a specific bound event\r\n\t\t\tswitch(_sType) {\r\n\r\n\t\t\t\tcase 'pinch':\r\n\t\t\t\t\t_iDelta = event_.scale;\r\n\t\t\t\t\tif ( ( ( _iDelta < 1 ) && (_iDelta % 1) < (1 - $.jGestures.defaults.thresholdPinchclose) ) || ( ( _iDelta > 1 ) && (_iDelta % 1) > ($.jGestures.defaults.thresholdPinchopen) ) ) {\r\n\t\t\t\t\t\t_iDirection = (_iDelta < 1 ) ? -1 : +1 ;\r\n\t\t\t\t\t\t_oDetails = _createOptions({type: 'pinch', scale: _iDelta, touches: null,startMove:_oDatajQueryGestures.oStartTouch, event:event_, timestamp: _oDatajQueryGestures.oStartTouch.timestamp, vector:_iDirection, description: ['pinch:',_iDirection,':' , ( (_iDelta < 1 ) ? 'close' : 'open' )].join('') });\r\n\t\t\t\t\t\t_$element.triggerHandler(_oDetails.type, _oDetails);\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t_iDelta = event_.rotation;\r\n\t\t\t\t\tif ( ( ( _iDelta < 1 ) &&  ( -1*(_iDelta) > $.jGestures.defaults.thresholdRotateccw ) ) || ( ( _iDelta > 1 ) && (_iDelta  > $.jGestures.defaults.thresholdRotatecw) ) ) {\r\n\t\t\t\t\t\t_iDirection = (_iDelta < 1 ) ? -1 : +1 ;\r\n\t\t\t\t\t\t_oDetails = _createOptions({type: 'rotate', rotation: _iDelta, touches: null, startMove:_oDatajQueryGestures.oStartTouch, event:event_, timestamp: _oDatajQueryGestures.oStartTouch.timestamp, vector:_iDirection, description: ['rotate:',_iDirection,':' , ( (_iDelta < 1 ) ? 'counterclockwise' : 'clockwise' )].join('') });\r\n\t\t\t\t\t\t_$element.triggerHandler(_oDetails.type, _oDetails);\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t/**\r\n\t* Handler: gestureend\r\n\t* Read the event_.scale / event_.rotate values,\r\n\t* compares it to $.jGestures.defaults.threshold* and triggers\r\n\t* a pinchclose|pinchclose|rotatecw|rotateccw event if the distance exceed the\r\n\t* Since the gesture-event doesn't supply event.touches no tuchpoints will be calculated\r\n\t* * Custom-event argument object:\r\n\t* @returns {Object}\r\n\t*\t\t\t{\r\n\t*\t\t\t\ttype: eventtype e.g. \"pinchclose\",\"pinchopen\", \"rotatecw\", \"rotateccw\",\r\n\t*\t\t\t\toriginalEvent: {DOM-Event},\r\n\t*\t\t\t\t// delta and direction details are just provided for touch not for gesture / motion events\r\n\t*\t\t\t\tdelta : null,\r\n\t*\t\t\t\t// based on the first touchpoint\r\n\t*\t\t\t\tdirection : {\r\n\t*\t\t\t\t\tvector: {Number}, // -1|+1, indicates the direction if necessary(pinch/rotate)\r\n\t*\t\t\t\t\torientation: {Number} // window.orientation: -90,0,90,180 || null (window.orienntation)\r\n\t*\t\t\t\t},\r\n\t*\t\t\t\trotation: {Number} , //  amount of rotation relative to the current position NOT the original\r\n\t*\t\t\t\tscale: {Number} , // amount of scaling relative to the current position NOT the original\r\n\t*\t\t\t\tduration: {Number}, // ms: relative to the original touchpoint\r\n\t*\t\t\t\tdescription : {String} // details as String: pinch:{'close'|'open'} e.g. \"pinch:-1:close\" ||  rotate:{'counterclockwise'|'clockwise'} e.g. \"rotate:-1:counterclockwise\"\r\n\t*\t\t\t};\r\n\t* @param {DOM-Event} event_\r\n\t* @return {Void}\r\n\t*/\r\n\tfunction _onGestureend(event_) {\r\n\t\t// ignore bubbled handlers\r\n\t\t// if ( event_.currentTarget !== event_.target ) { return; }\r\n\r\n\t\tvar _$element = jQuery(event_.currentTarget);\r\n\t\t// var _$element = jQuery(event_.target);\r\n\r\n\t\t// trigger custom notification\r\n\t\t_$element.triggerHandler($.jGestures.events.gestureendStart,event_);\r\n\r\n\t\tvar _iDelta;\r\n\t\tvar _oDatajQueryGestures = _$element.data('ojQueryGestures');\r\n\r\n\t\t// trigger handler for every bound event\r\n\t\tvar _sType;\r\n\t\tfor (_sType in _oDatajQueryGestures) {\r\n\r\n\t\t\tswitch(_sType) {\r\n\r\n\t\t\t\tcase 'pinchclose':\r\n\t\t\t\t\t_iDelta = event_.scale;\r\n\t\t\t\t\tif (( _iDelta < 1 ) && (_iDelta % 1) < (1 - $.jGestures.defaults.thresholdPinchclose)) {\r\n\t\t\t\t\t\t_$element.triggerHandler('pinchclose', _createOptions ({type: 'pinchclose', scale:_iDelta, vector: -1, touches: null, startMove: _oDatajQueryGestures.oStartTouch, event:event_, timestamp:_oDatajQueryGestures.oStartTouch.timestamp,description: 'pinch:-1:close' }) );\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'pinchopen':\r\n\t\t\t\t\t_iDelta = event_.scale;\r\n\t\t\t\t\tif ( ( _iDelta > 1 ) && (_iDelta % 1) > ($.jGestures.defaults.thresholdPinchopen) ) {\r\n\t\t\t\t\t\t_$element.triggerHandler('pinchopen', _createOptions ({type: 'pinchopen', scale:_iDelta, vector: +1, touches: null, startMove: _oDatajQueryGestures.oStartTouch, event:event_, timestamp:_oDatajQueryGestures.oStartTouch.timestamp,description: 'pinch:+1:open'}) );\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotatecw':\r\n\t\t\t\t\t_iDelta = event_.rotation;\r\n\t\t\t\t\tif ( ( _iDelta > 1 ) && (_iDelta  > $.jGestures.defaults.thresholdRotatecw) ) {\r\n\t\t\t\t\t\t_$element.triggerHandler('rotatecw', _createOptions ({type: 'rotatecw', rotation:_iDelta, vector: +1, touches: null, startMove: _oDatajQueryGestures.oStartTouch, event:event_, timestamp:_oDatajQueryGestures.oStartTouch.timestamp,description: 'rotate:+1:clockwise'}) );\r\n\t\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotateccw':\r\n\t\t\t\t\t_iDelta = event_.rotation;\r\n\t\t\t\t\tif ( ( _iDelta < 1 ) &&  ( -1*(_iDelta) > $.jGestures.defaults.thresholdRotateccw ) ) {\r\n\t\t\t\t\t\t\t_$element.triggerHandler('rotateccw', _createOptions ({type: 'rotateccw', rotation:_iDelta, vector: -1, touches: null, startMove: _oDatajQueryGestures.oStartTouch, event:event_, timestamp:_oDatajQueryGestur,i,"[\\:\\@\\/\\?=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to dar jo&o-2if(j<r&&++o>u&&g("overflow"),j==r){for(vary{!I&&P.return&&P.return()ucs2:{deco.isArr&r.index+r.length===n?r.length++:t.push({index:n,length:1})}return t},[]),y=b.sort(function(t,e){return e.length-t.length})[0],w=void 0;if(y&&y.length>1){var S=g.{if(n.host&&(e.domainHost||i&&i.domainHost))try{n.host=T.toASCII(n.host.replalength;)if(t.match(j))t=t.replace(j,"");else if(t.match(O))t=t.replace(O,"/");else if(t.match(L))t=t.replace(L,"/"),e.pop();else if("."===t||".."===t)t="";else{var n=t.match(M);if(!n)throw new Error("Unexpected dot segment condition");var r=n[0];t=t.slice(r.length),e.push(r)}return e.join("")}function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.iri?s:a,r=[],o=x[(e.scheme||t.scheme||"").toLowerCase()];if(o&&o.serialize&&o.serialize(t,e),t.host)if(n.IPV6ADDRESS.test(t.host));else if(e.domainHost||o&&o.domainHost)try{t.host=e.iri?T.toUnicode(t.host):T.toASCII(t.host.replace(n.PCT_ENCODED,k).toLowerCase())}catch(n){t.error=t.error||"Host's domain name can not be converted to "+(,n),"suffix"!==e.reference&&t.scheme&&(r.push(t.scheme),r.push(":"));var i=function(t,e){var n=!1!==e.iri?s:a,r=[];return void 0!==t.userinfo&&(r.push(t.userinfo),r.push("@")),void 0!==t.host&&r.push(A(I(String(t.host),n),n).replace(n.IPV6ADDRESS,function(t,e,n){return"["+e+(n?"%25"+n:"")+"]"})),"number"==typeof t.port&&(r.push(":"),r.push(t.port.toString(10))),r.length?r.join(""):void 0}(t,e);if(void 0!==i&&("suffix"!==e.reference&&r.push("//"),r.push="/"+e.path,o.path=N(o.path)),o.query=efo=t.useriPCT_ENCODED:a.PCT_ENCODED,k)}var z={scheme:"http",domainHost:!0,parse:function(t,e){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t},serialize:function(t,e){return t.port!==("https"!==String(t.scheme).toLowerCase()?80:443)&&""!==t.port||(t.port=void 0),t.path||(t.path="/"),t}},U={scheme:"https",domainHost:z.domainHost,parse:z.parse,serialize:z.serialize},W={},Y="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Q="[0-9A-Fa-f]",V=n(n("%[EFef][0-9A-Fa-f]%"+Q+Q+"%"+Q+Q)+"|"+n("%[89A-Fa-f][0-9A-Fa-f]%"+Q+Q)+"|"+n("%"+Q<\\>A-Z\\x5E-\\x7E]",'[\\"\\\for(var h=a]=c+"@"+f}r.path=i.join(",")}var d=t.headers}},nt=/^([o+":"+(e.nid||i),l=x[s];r.nid=i,r.nss=a,r.path=void 0,l&&(r=l.parse(r,e))}else r.error=r.eri.serializ0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,it={scheme:"urn:uuid",parse:function(t,e){var n=t;return n.uuid=n.nss,n.nss=void 0,e.tolerant||n.uuid&&n.uuid.match(ot)||(n.error=n.error||"UU=et,x[rt.schegments=return R(F(P(t,r),e),e):"object"===r(t)&&(t=P(R(t,e),e)),t},t.equal=function(t,e,n){return"string"==typeof t?t=R(P(t,n),n):"object"===r(t)&&(t=R(t,n)),"string"==typeof e?e=R(P(e,n),n):"object"===r(e)&&(e=R(e,n)),t===e},t.escapeComponent=function(t,e){return t&&t.toString().replace(e&&e.iri?s.ESCAPE:a.ESCAPE,_)},t.unescapeComponent=B,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){n(10)(n(335))},function(t,e){t.exports="(function() {\n    'use strict';\n    var $ = (typeof exports !== 'undefined') ? exports : ((typeof window.global === 'object') ? window.global : window);\n\n    // Define Shared Object\n    $.Shared           = $.Shared || {};\n    $.Shared.author    = 'Mobile Dev Team @ Flyp Technologies Inc.';\n    $.Shared.copyright = '(c) 2013 Flyp Technologies Inc., all rights reserved.';\n    $.Shared.root      = $;\n\n    // Forward Migration to new Modular Layout\n    //   Constants will be migrated into AppConst\n    //   Shared will be migrated into AppUtil & AppConst\n    //   AppShared will be migrated into AppUtil\n    $.AppConst = $.Shared;\n}());\n\n(function() {\n    \"use strict\";\n\n    // Empty Value Regex\n    Shared.EMPTY = /^\\s*$/;\n\n    // Month Names\n    Shared.MONTH_NAMES = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n\n    // Logging Level Types\n    Shared.LVL_DEBUG    = 'debug';\n    Shared.LVL_ERROR    = 'error';\n    Shared.LVL_WARNING  = 'warn';\n    Shared.LVL_INFO     = 'info';\n\n    // Key Codes\n    Shared.KB_ENTER  = 13;\n    Shared.KB_ESCAPE = 27;\n    Shared.KB_DELETE = 46;\n\n    // Browser Detection\n    Shared.MS_IE_10 = (window.navigator.msPointerEnabled !== undefined);\n    Shared.Chrome = (!!window.chrome && !window.opera);   // Chrome\n\n    Shared.AMAZON_SILK = (new RegExp('(?=.*Silk)(?=.*Mobile)', 'i').test(window.navigator.userAgent));\n    Shared.ANDROID_3 = (new RegExp('(?=.*Android 3)', 'i').test(window.navigator.userAgent));\n    Shared.ANDROID_FF = (new RegExp('(?=.*Android)(?=.*Tablet)(?=.*Firefox)', 'i').test(window.navigator.userAgent));\n    Shared.BB_PLAYBOOK = (new RegExp('(?=.*Playbook)(?=.*Webkit)', 'i').test(window.navigator.userAgent));\n    Shared.CriOS = (new RegExp('(?=.*CriOS)', 'i').test(window.navigator.userAgent));   // Chrome on iOS\n    Shared.OPERA_MINI = (Object.prototype.toString.call(window.operamini) === '[object OperaMini]');\n    Shared.NOKIA_XPRESS = (new RegExp('(Nokia311|NokiaX3)', 'i').test(window.navigator.userAgent));\n    Shared.IOS  = (new RegExp('(iPad|iPhone);.*CPU.*OS', 'i').test(window.navigator.userAgent));\n    Shared.IOS6 = (new RegExp('(iPad|iPhone);.*CPU.*OS 6_', 'i').test(window.navigator.userAgent));\n    Shared.IOS7 = (new RegExp('(iPad|iPhone);.*CPU.*OS 7_', 'i').test(window.navigator.userAgent));\n    Shared.IOS8 = (new RegExp('(iPad|iPhone);.*CPU.*OS 8_', 'i').test(window.navigator.userAgent));\n    Shared.IOS8_1 = (new RegExp('(iPad|iPhone);.*CPU.*OS 8_1', 'i').test(window.navigator.userAgent));\n    Shared.IOS9 = (new RegExp('(iPad|iPhone);.*CPU.*OS 9_', 'i').test(window.navigator.userAgent));\n\n    // Recommendation Engine types\n    Shared.RECOMMENDATION_ENGINE_TYPE_AI = 1;\n    Shared.RECOMMENDATION_ENGINE_TYPE_STREAM = 2;\n\n    // Message types for postMessage/addEventListener\n    Shared.MESSAGE_TYPES = {\n        FLIPBOOK_EVENT: 'flipbook.event',\n    };\n}());\n"},function(t,e,n){n(10)(n(337))},function(t,e){t.exports="(function() {\n    \"use strict\";\n\n    Hubs.Config = {\n        'serverTimestamp'   : 0,\n        'hubId'             : '',\n        'hubTitle'          : '',\n        'hubBaseUrl'        : '',\n        'previewOn'         : 0,\n\n        // Cookies\n        'cookies': {\n            'entry': 'ufentry'\n        },\n\n        // Server URLs for App\n        'serverUrl' : {\n            'hub'               : '',\n            'cdn'               : '',\n            'lazyLoader'        : '/hubsFront/ajax_loadAdditionalItems/',\n            'extraInfo'         : '/hubsFront/ajax_loadExtraInfo/',\n            'search'            : '/hubsFront/ajax_search/',\n            'ctaTracking'       : '/hubsFront/ajax_trackCta',\n            'ctaViewTracking'   : '/hubsFront/ajax_trackCtaView',\n            'ctaSubmit'         : '/hubsFront/ajax_submitCtaForm',\n            'ctaActivate'       : '/hubsFront/ajax_activateFormCta',\n            'pageViewTracking'  : '/hubsFront/ajax_trackPageView',\n            'socialTracking'    : '/hubsFront/ajax_trackSocial',\n            'signalMetricsTemp' : '/hubsFront/signalMetricsTemp',\n            'updateMAPUsers'    : '/hubsFront/ajax_updateMAPUsers',\n            'ping'              : '/hubsFront/ajax_ping',\n            'getFormFieldConditions' : '/hubsFront/ajax_getFormFieldConditions'\n        },\n\n        // Container Elements\n        'containers' : {\n            'app'                   : '#hubs-container',\n            'levelThree'            : '.level-three',\n            'pageWidth'             : '.page-width',\n            'topNav'                : '.top-nav',\n            'leftNav'               : ['#left-nav', '#left-nav-phone', '.left-nav'],\n            'largeHeader'           : '.large-header',\n            'mainContent'           : '.main',\n            'itemContent'           : '#item-content',\n            'loadingOverlay'        : '#loading-overlay',\n            'loadingIndicator'      : '.loading-indicator',\n            'pageIdentifier'        : '#page-type-identifier',\n            'returnToHub'           : '#returnToHub',\n            'moveToTop'             : '#moveToTop',\n            'flipbookContainer'     : '.single-uberflip',\n            'fullscreenControls'    : '.fullscreen-controls',\n            'showMoreLink'          : '.display-more',\n            'descWrapper'           : '.full-desc-container',\n            'fullDesc'              : '.full-desc',\n            'videoPlayer'           : '.single-video',\n            'shareContainer'        : '.share-container',\n            'timeAgo'               : 'abbr.timeago',\n            'nonProxiedImg'         : 'span.non-proxied-image',\n            'headerLoading'         : '#header-loading-overlay',\n            'headerMain'            : '.header-main',\n            'splashLoader'          : '#splash-loader',\n            'splashChevron'         : '#splash-chevron',\n            'footer'                : 'body > footer',\n            'mobileFlipbook'        : '.mobile-flipbook.level-two',\n            'visibleApp'            : 'header, footer, .main',\n            'date'                  : '.date'\n        },\n\n        // CTA's\n        'cta' : {\n            'elements' : {\n                'container'          : '.cta',\n                'itemCta'            : '.cta-item-container',\n                'formContainer'      : '.cta-form',\n                'sprite'             : '.cta-sprite',\n                'form'               : '.cta-form',\n                'formField'          : '.preview-form-field',\n                'hideCancel'         : '.hide-preview-cancel',\n                'formBottom'         : '.hidden-cta-fields',\n                'formTop'            : '.run-away',\n                'submitForm'         : '.cta-submit-form',\n                'activateForm'       : '.activate-button',\n                'fieldName'          : '.cta-field-name',\n                'formError'          : '.cta-form-error',\n                'formSuccess'        : '.cta-form-success',\n                'allFormContent'     : '.full-cta-form-content',\n                'submitting'         : '.submission-loader-container',\n                'startFullScreen'    : '.cta-form:not(.full-screen-cta) .preview-form-field',\n                'noThanks'           : '.no-thanks a',\n                'possibleBlock'      : '.possible-block',\n                'blockCta'           : '.block-cta',\n                'blockingCta'        : '.blocking-cta',\n                'itemBlockCta'       : '.embed-block-body',\n                'optIn'              : '.opt-in',\n                'optInRequired'      : '.opt-in-required',\n                'hiddenEmbed'        : '.hide-embed',\n                'possibleHiddenEmbed': '.possible-hidden-embed'\n            },\n            'storage'              : 'flyptech-hub-',\n            'hidePlacementNumDays' : 7\n        },\n\n        // Carousel Control\n        'carousel' : {\n            'id'            : '%name%-items-carousel',\n            'name'          : '',\n            'start'         : 1,\n            'elements' : {\n                'container' : '.carousel',\n                'item'      : '.tile',\n                'parent'    : '.%name%-container',\n                'inner'     : '.carousel-inner',\n                'nav'       : {'container': '.carousel-nav', 'prev': '#%name%NavPrev', 'next': '#%name%NavNext'},\n                'loadMore'  : '.load-more'\n            },\n            'lazyLoad' : {\n                'enabled' : false,\n                'url'     : '',\n                'limit'   : 10,\n                'page'    : 1,\n                'before'  : 20\n            },\n            'l10n' : {\n                'carousel-init'         : 'Shared:Carousel Initializing',\n                'carousel-init-end'     : 'Shared:Carousel Complete & Ready',\n                'carousel-events-init'  : 'Shared:Carousel Initializing Events',\n                'carousel-update'       : 'Shared:Carousel Updating Container',\n                'carousel-update-items' : 'Shared:Carousel Updating Items',\n                'carousel-update-nav'   : 'Shared:Carousel Updating Navigation',\n                'carousel-scroll-start' : 'Shared:Carousel Scrolling',\n                'carousel-scroll-end'   : 'Shared:Carousel Scrolling Stopped',\n                'carousel-resize'       : 'Shared:Carousel Event - Resize',\n                'carousel-destroy'      : 'Shared:Carousel Destroying'\n            },\n            'eventNamespace' : '.Hubs.Carousel',\n\n            // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n            // Customizable Routines\n            // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n            'itemsUpdated'          : function() { return false; }\n        },\n\n        // LazyLoader Control\n        'lazyloader' : {\n            'direction'         : Hubs.LAZYLOAD_VERTICAL,\n            'itemDisplayLimit'  : 20,\n            'elements' : {\n                'container'     : '#collection-items > .collection-items-container',\n                'notify'        : '#loading-notifier',\n                'section'       : '.collection-section',\n                'item'          : '.tile:not(.cta):not(#loading-notifier)',\n                'loadMore'      : '#load-more'\n            }\n        },\n\n        // Search Tool\n        'search' : {\n            'enabled'              : false,\n            'labels' : {\n                'home'             : 'Home',\n                'videos'           : 'Videos',\n                'blogs'            : 'Blogs',\n                'docs'             : 'Docs',\n                'social'           : 'Social',\n                'recent'           : 'Recent Searches',\n                'noItems'          : 'No Items Found',\n                'noItemsStream'    : 'No Items Found in this Stream',\n                'seeMore'          : 'See More',\n                'searchEntireHub'  : 'Search the rest of the Hub'\n            }\n        },\n\n        // Empty Hub State\n        'isEmptyHub'            : false,\n\n        // Mobile Devices\n        'isMobile'              : false,\n\n        // Are we in an IFrame?\n        'isIFrame'              : (Hubs.root.top.location !== Hubs.root.self.location),\n\n        // Are we in an Embedded-IFrame?\n        'isEmbedded'            : false,\n\n        // Options from Hubs Labs\n        'labOptions' : {\n            'topMenu'           : false,\n            'permHeader'        : false,\n            'noHeader'          : false,\n            'hideBanner'        : false,\n            'highlightFirst'    : false,\n            'stickyFooter'      : false,\n            'flipbookBreakOut'  : false,\n            'linkBreakOut'      : false\n        },\n\n        // Options from Embedded Hub\n        'embedOptions' : {\n            'hideHeader'        : false,\n            'hideBanner'        : false,\n            'hideFooter'        : false,\n            'hidePrimaryNav'    : false,\n            'hideSecondaryNav'  : false,\n            'linkBreakOut'      : false,\n            'revealBehaviour'   : 'fade'\n        },\n\n        // Initial Page Type Displayed\n        'pageType'              : Hubs.PAGE_TYPE_HUB,\n\n        // Tracking Delay for sending stats analytics to server in batches\n        'trackingDelay'         : 60000,\n\n        // Responsive Breakpoints\n        'breakpoints' : {\n            'mobile1'  :  480,\n            'mobile2'  :  560,\n            'tablet1'  :  720,\n            'tablet2'  :  796,\n            'tablet3'  :  980,\n            'desktop1' : 1066,\n            'desktop2' : 1336,\n            'desktop3' : 1606,\n            'desktop4' : 1876,\n            'desktop5' : 9999\n        },\n\n        // Bombora\n        'bombora'    : false,\n\n        // Google Analytics Codes for Event Tracking\n        'analyticsCodes'        : [],\n\n        // Page Tracking\n        'enablePageTracking'    : true,\n\n        // Debugging\n        'enableDebugger'        : false,\n\n        //itemPreview Button Label\n        'itemPreviewButtonLabel' : 'Continue Reading...',\n\n        // Hub-specific query strings\n        'ufQueryStrings': ['page', 'scrollTop', 'prevCol', 'prevItm', 'ts', 'recotrk', 'visual']\n    };\n\n}());\n"},function(t,e,n){n(10)(n(339))},function(t,e){t.exports="(function() {\n    'use strict';\n    var $ = (typeof exports !== 'undefined') ? exports : ((typeof window.global === 'object') ? window.global : window);\n\n    // Define Shared Object\n    $.Shared           = $.Shared || {};\n    $.Shared.author    = 'Mobile Dev Team @ Flyp Technologies Inc.';\n    $.Shared.copyright = '(c) 2013 Flyp Technologies Inc., all rights reserved.';\n    $.Shared.root      = $;\n\n    // Forward Migration to new Modular Layout\n    //   Constants will be migrated into AppConst\n    //   Shared will be migrated into AppUtil & AppConst\n    //   AppShared will be migrated into AppUtil\n    $.AppUtil = $.Shared;\n}());\n\n(function($, undefined) {\n    'use strict';\n\n    /* ******************************************************************************************** */\n    /* * Custom Exception Handling                                                                * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Shared Exception Wrapper\n     *\n     * @public\n     * @this local\n     * @param {String} msg The message of the Exception\n     * @return {Mixed} A jQuery Object containing a Handle to the DOM Elements specified by the selector\n     */\n    Shared.Exception = function(msg, args) {\n        this.name = 'Shared.Exception';\n        this.type = Shared.LVL_ERROR;\n        this.msg  = msg;\n        this.args = args;\n    };\n\n\n    /* ******************************************************************************************** */\n    /* * String/Number Related Methods                                                            * */\n    /* ******************************************************************************************** */\n\n    /**\n     * JavaScript HTML encode - for example, safe for picking up values from HTML attributes and using them to build up HTML via JS\n     *  NOT for use within tags such as script, in the context of event handlers, etc.\n     */\n    Shared.jhe = function(str) {\n        return $('<div/>').text(str).html();\n    };\n\n    /**\n     * Left Pads a String with a specified character\n     *\n     * @public\n     * @this local\n     * @param {String} str The string to pad with the specified or default character\n     * @param {Number} max The max length of the String to Pad to; if the string is greater, return the string\n     * @param {String} [padding] The character(s) to pad the string with; default padding is a single space\n     * @return {String} The padded string\n     */\n    Shared.lpad = function(str, max, padding) {\n        if (padding === undefined) {padding = ' ';}\n        return str.length < max ? Shared.lpad(padding + str, max, padding) : str;\n    };\n\n    /**\n     * Right Pads a String with a specified character\n     *\n     * @public\n     * @this local\n     * @param {String} str The string to pad with the specified or default character\n     * @param {Number} max The max length of the String to Pad to; if the string is greater, return the string\n     * @param {String} [padding] The character(s) to pad the string with; default padding is a single space\n     * @return {String} The padded string\n     */\n    Shared.rpad = function(str, max, padding) {\n        if (padding === undefined) {padding = ' ';}\n        return str.length < max ? Shared.rpad(str + padding, max, padding) : str;\n    };\n\n    /**\n     * Trims the whitespace from the ends of a String\n     *\n     * @public\n     * @this local\n     * @param {String} str The string to trim\n     * @return {String} The trimmed string\n     */\n    Shared.trim = function(str) {\n        return str.replace(/^\\s+|\\s+$/g, '');\n    };\n\n    /**\n     * Fast UUID generator, RFC4122 version 4 compliant.\n     *\n     * @public\n     * @this local\n     * @author Jeff Ward (jcward.com)\n     * @license MIT license\n     * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\n     * @return {String} The Unique ID\n     */\n    Shared.getUUID = function() {\n        var lut = [];\n        var d0 = Math.random()*0xffffffff|0;\n        var d1 = Math.random()*0xffffffff|0;\n        var d2 = Math.random()*0xffffffff|0;\n        var d3 = Math.random()*0xffffffff|0;\n        for (var i=0; i<256; i++) { lut[i] = (i<16?'0':'')+(i).toString(16); }\n        return lut[d0&0xff]+lut[d0>>8&0xff]+lut[d0>>16&0xff]+lut[d0>>24&0xff]+'-'+\n                lut[d1&0xff]+lut[d1>>8&0xff]+'-'+lut[d1>>16&0x0f|0x40]+lut[d1>>24&0xff]+'-'+\n                lut[d2&0x3f|0x80]+lut[d2>>8&0xff]+'-'+lut[d2>>16&0xff]+lut[d2>>24&0xff]+\n                lut[d3&0xff]+lut[d3>>8&0xff]+lut[d3>>16&0xff]+lut[d3>>24&0xff];\n    };\n\n    /**\n     * Parse a String for all URL QueryString Parameters\n     *\n     * @public\n     * @this local\n     * @return {Object} A JSON Object of all parts in URL Query String\n     */\n    Shared.parseQueryParams = function(url) {\n        var params = {};\n        $.each(url.substr(1).split('&'), $.proxy(function(idx, pair) {\n            if (pair === '') return;\n            var parts = pair.split('=');\n            this[parts[0]] = parts[1] && decodeURIComponent(parts[1].replace(/\\+/g, ' '));\n        }, params));\n        return params;\n    };\n\n    /**\n     * Parse a String for a URL QueryString Parameter by its Name\n     *\n     * @public\n     * @this local\n     * @return {String} The Value of the QueryString Parameter or an Empty String\n     */\n    Shared.parseQueryParamByName = function(url, name){\n        var regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)');\n        var results = regex.exec(url);\n        return results === null ? '' : decodeURIComponent(results[1].replace(/\\+/g, ' '));\n    };\n\n    /* ******************************************************************************************** */\n    /* * Object Related Methods                                                                   * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Extands an existing Class with the Methods from Another Class\n     *\n     * @public\n     * @this local\n     * @param {Class} receivingClass The Class to Augment the Methods to\n     * @param {Class} givingClasses An array of Classes to Augment the Methods from\n     * @return undefined\n     */\n    Shared.augment = function(receivingClass, givingClasses) {\n        var i, n, methodName = null;\n        for (i = 0, n = givingClasses.length; i < n; i++) {\n            for (methodName in givingClasses[i].prototype) {\n                if (givingClasses[i].prototype.hasOwnProperty(methodName)) {\n                    if (!Object.hasOwnProperty(receivingClass.prototype, methodName)) {\n                        receivingClass.prototype[methodName] = givingClasses[i].prototype[methodName];\n                    }\n                }\n            }\n        }\n    };\n\n\n    /* ******************************************************************************************** */\n    /* * Browser Related Methods (Shims)                                                          * */\n    /* ******************************************************************************************** */\n\n    Shared.setCookie = function(itemName, itemValue, options) {\n        options = options || {};\n        if ($.cookie !== undefined) {\n            $.cookie(itemName, itemValue, options);\n        }\n    };\n\n    Shared.getCookie = function(itemName) {\n        if ($.cookie !== undefined) {\n            return $.cookie(itemName);\n        }\n    };\n\n    /**\n     * Gets the Current Time as a Timestamp\n     *\n     * @public\n     * @this local\n     * @return {Number} Timestamp of Current Time\n     */\n    Shared.getTime = Date.now || function() { return new Date().getTime(); };\n\n    /**\n     * Executes a Function on the Browsers' Next Event Loop\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Shared.onNextEventLoop = function(fnHandler, context, delay) {\n        return Shared.root.setTimeout($.proxy(fnHandler, context || Shared), delay || 0);\n    };\n\n    /**\n     * Parse a URL for all QueryString Parameters\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Shared.getQueryParams = function() {\n        return Shared.parseQueryParams(location.search);\n    };\n\n    /**\n    * Returns the page queries without the provided query strings\n    *\n    * @param queryNames\n    * @returns {undefined}\n    */\n    Shared.getQueriesWithout = function(queryNames) {\n        var queries = this.getQueryParams();\n        $.each(queryNames, function (i, name) {\n            delete queries[name];\n        });\n        return queries;\n    };\n\n    /**\n     * Parse a URL for a QueryString Parameter by its Name\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Shared.getQueryParamByName = function(name) {\n        return Shared.parseQueryParamByName(location.search, name);\n    };\n\n    Shared.triggerFullscreen = function(enable, element) {\n        var $controls = $('.fullscreen-controls');\n        var $expand = $controls.find('.fullscreen-open');\n        var $unexpand = $controls.find('.fullscreen-close');\n\n        if (enable) {\n            $controls.addClass('fullscreen');\n            $expand.attr('style','display: none');\n            $unexpand.attr('style','display: inline-block');\n            if (element) {\n                $(element).addClass('uf-fullscreen-element');\n            }\n        } else {\n            $controls.removeClass('fullscreen');\n            $expand.attr('style','display: inline-block');\n            $unexpand.attr('style','display: none');\n            $('.uf-fullscreen-element').removeClass('uf-fullscreen-element')\n        }\n    };\n\n    /**\n     * Push an Element into Fullscreen Mode (Defaults to the Current Document)\n     *\n     * @public\n     * @this local\n     * @param {Object} element - (Optional) The element to push into Fullscreen Mode\n     * @return undefined\n     */\n    Shared.enterFullscreen = function(element) {\n        if (element === undefined) {\n            element = document.documentElement;\n        }\n        if (element.requestFullscreen) {\n            Shared.triggerFullscreen(true, element);\n            element.requestFullscreen();\n        } else if (element.mozRequestFullScreen) {\n            Shared.triggerFullscreen(true, element);\n            element.mozRequestFullScreen();\n        } else if (element.webkitRequestFullscreen) {\n            Shared.triggerFullscreen(true, element);\n            element.webkitRequestFullscreen();\n        } else if (element.msRequestFullscreen) {\n            Shared.triggerFullscreen(true, element);\n            element.msRequestFullscreen();\n        } else {\n            return false;\n        }\n    };\n\n    /**\n     * Exit Fullscreen Mode for Current Document and any Elements within\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Shared.exitFullscreen = function() {\n        // For the purposes of this check, we only need to be concerned with these properties.\n        // We may have a \"fake\" fullscreen element, but trying to call exitFullscreen in that case will throw an error.\n        var isFullscreen = document.fullscreenElement ||\n        document.webkitFullscreenElement ||\n        document.mozFullScreenElement ||\n        document.msFullscreenElement\n        /**\n         * Chrome & other modern browsers throw errors\n         * if you try to exit fullscreen when you are not in fullscreen mode.\n         * */\n        if (!isFullscreen) {\n          // If you use \"esc\" to exit fullscreen, we end up here (and still need to cleanup)\n          Shared.triggerFullscreen(false);\n          return;\n        }\n        if (document.exitFullscreen) {\n            Shared.triggerFullscreen(false);\n            document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n            Shared.triggerFullscreen(false);\n            document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n            Shared.triggerFullscreen(false);\n            document.webkitExitFullscreen();\n        } else if (document.msExitFullscreen) {\n            Shared.triggerFullscreen(false);\n            document.msExitFullscreen();\n        } else {\n            return false;\n        }\n    };\n\n    /**\n     * Check if the Browser is in Fullscreen Mode\n     *\n     * @public\n     * @this local\n     * @return {boolean}\n     */\n    Shared.isBrowserFullscreen = function() {\n        var fs = document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;\n        return (!!fs);\n    };\n\n    /**\n     * Check if the Browser is in Fullscreen Mode\n     *\n     * @public\n     * @this local\n     * @return {string}\n     */\n    Shared.isPseudoFullscreen = function() {\n        return Shared.$('body').hasClass('pseudo-fullscreen');\n    };\n\n    /* ******************************************************************************************** */\n    /* * Template Rendering Methods                                                               * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Inserts a JS Resource into the Page, and fires a callback once it is loaded\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Shared.insertJS = function(url, callback) {\n        var js = document.createElement('script');\n        js.id = 'injected-js-' + Shared.getTime();\n        js.async = 0; js.src = url;\n        js.onreadystatechange = js.onload = function() {\n            var state = js.readyState;\n            if (!callback.done && (!state || /loaded|complete/.test(state))) {\n                callback.done = true;\n                callback.call(null, js.id);\n            }\n        };\n        document.getElementsByTagName('head')[0].appendChild(js);\n    };\n\n    /* ******************************************************************************************** */\n    /* * DOM Element Related Methods                                                              * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Gets a Handle to a jQuery DOM Element and caches the Handle\n     *      - if the Handle exists in subsequent calls, it returns the cached Handle\n     *\n     * @public\n     * @this local\n     * @param {String} selector A string containing a valid CSS Selector used to find elements in the DOM\n     * @return {Mixed} A jQuery Object containing a Handle to the DOM Elements specified by the selector\n     */\n    Shared.$ = function(selector) {\n        var $el = null, objs = {'top': top, 'window': window, 'document': document};\n        if (typeof selector === 'string') {\n            if (Shared.ElementBank[selector] === undefined || Shared.ElementBank[selector].length < 1) {\n                if (objs[selector] !== undefined) {\n                    Shared.ElementBank[selector] = $(objs[selector]);\n                } else {\n                    Shared.ElementBank[selector] = $(selector);\n                }\n            }\n            $el = Shared.ElementBank[selector];\n        } else {\n            $el = $(selector);\n        }\n        return $el;\n    };\n\n    /**\n     * Scroll the Body Element to a Pixel-Based Coordinate\n     *  - Standarized method for Scrolling that works in all Browsers/Devices\n     *\n     * @public\n     * @this local\n     * @param {Number} top - The amount of Pixels to Scroll the Element by; If not supplied, will return the Current Value of \"scrollTop\"\n     * @param {Number} animateSpeed - The speed of the Animation to use; if not set no animation will be used\n     * @param {Object} $el - a jQuery Element Handle to the Element to be Scrolled; Defaults to \"window\"\n     * @return undefined\n     */\n    Shared.scrollTop = function(top, animateSpeed, $el) {\n        // Ensure Element was Scrolled\n        //  - Chrome on Mac has some strange scroll problem\n        var ensureScrolling = function() {\n            Shared.onNextEventLoop(function() {\n                if ($el.scrollTop() !== top && 'scroll' in window) {\n                    window.scroll(0, top);\n                }\n            });\n        };\n\n        // Get Scroll Element\n        $el = $el || Shared.$('window');\n        // Make sure that object is jquery instance\n        $el = $($el);\n\n        // Get Scroll-Top of Element\n        if (top === undefined || top === null) {\n            return $el.scrollTop();\n        }\n\n        // Perform Scrolling in next Browser Event Loop\n        Shared.onNextEventLoop(function() {\n            if (animateSpeed && animateSpeed > 0 && $el[0] !== window) {\n                $el.animate({'scrollTop': top}, animateSpeed, ensureScrolling);\n            } else {\n                $el.scrollTop(top);\n                ensureScrolling();\n            }\n        }, this, 10);\n    };\n\n    /**\n     * Animates an Element using CSS3 Transitions or Fallback to jQuery Animations if not supported\n     *\n     * @public\n     * @this local\n     * @param {Object} element A jQuery Element to Animate\n     * @param {Object} props The Properties of the Element to Animate\n     * @param {Number} [duration] The duration of the animation in Milliseconds only\n     * @param {Function} [callback] A callback function to execute once the animation has completed\n     * @return undefined\n     */\n    Shared.animate = function($element, props, duration, callback) {\n        if ($element.transition !== undefined) {\n            $element.transition(props, duration, 'in', callback);\n        } else {\n            $element.animate(props, duration, 'swing', callback);\n        }\n    };\n\n    /**\n     * Enables Hover Menus for Elements\n     *   - Menu may be nested within Hover Element, or a completely separate element\n     *\n     * @public\n     * @this local\n     * @param {Object} options\n     * @return undefined\n     */\n    Shared.enableHoverMenu = function(options) {\n        var elementHoverFunc, menuHoverFunc;\n\n        // Check for Required Hover Element\n        if (options.hover !== undefined) {\n            options.hover = $(options.hover);\n        }\n        if (!options.hover && !options.hover.length) { return; }\n\n        // Create Closed Hover Function for Hover Events\n        elementHoverFunc = function(opts) {\n            return function(e) {\n                var $menuEl, timer = 0;\n\n                // Get Menu Element\n                if (opts.menu !== undefined) {\n                    if (typeof opts.menu === 'function') {\n                        $menuEl = opts.menu(e, opts);\n                    } else {\n                        $menuEl = $(opts.menu);\n                    }\n                } else {\n                    $menuEl = $(e.currentTarget);\n                }\n\n                // Set Timer for Menu\n                timer = $menuEl.data('hoverTimer');\n\n                if (e.type === 'mouseenter') {\n                    // Handle Timer of Hover\n                    if (timer && timer > 0) {\n                        window.clearTimeout(timer);\n                        $menuEl.data('hoverTimer', 0);\n                    }\n\n                    // Call Hover-Over Callback\n                    if (typeof opts.hoverOverCallback === 'function') {\n                        opts.hoverOverCallback(e, $menuEl);\n                    }\n\n                    // Apply Hover Class to Menu Element\n                    $menuEl.addClass('hover');\n                } else {\n                    // Handle Timer of Hover\n                    timer = window.setTimeout(function() {\n                        if (!$menuEl.data('mouseover')) {\n                            $menuEl.data('hoverTimer', 0);\n\n                            // Remove Hover Class from Menu Element\n                            $menuEl.removeClass('hover');\n\n                            // Call Hover-Out Callback\n                            if (typeof opts.hoverOutCallback === 'function') {\n                                opts.hoverOutCallback(e, $menuEl);\n                            }\n                        }\n                    }, 500);\n                    $menuEl.data('hoverTimer', timer);\n                }\n            };\n        };\n\n        // Attach Hover Event for Hover Element\n        options.hover.on('mouseenter.Shared.Element mouseleave.Shared.Element', elementHoverFunc(options));\n\n        // Check for Separate Menu Selector\n        if (options.isSeparateMenu !== undefined) {\n\n            // Get Menu Selector\n            if (typeof options.isSeparateMenu !== 'string') {\n                if (options.menu !== undefined) {\n                    if (typeof options.menu === 'function') {\n                        options.isSeparateMenu = options.menu();\n                    } else {\n                        options.isSeparateMenu = options.menu;\n                    }\n                } else {\n                    return;\n                }\n            }\n\n            // Create Closed Hover Function for Menu-Hover Events\n            menuHoverFunc = function(opts) {\n                return function(e) {\n                    var $menuEl = $(e.currentTarget), timer = 0;\n\n                    if (e.type === 'mouseenter') {\n                        $menuEl.data('mouseover', true);\n                    } else {\n                        $menuEl.data('mouseover', false);\n                        timer = window.setTimeout(function() {\n                            if (!$menuEl.data('mouseover')) {\n                                $menuEl.data('hoverTimer', 0);\n\n                                // Remove Hover Class from Menu Element\n                                $menuEl.removeClass('hover');\n\n                                // Call Hover-Out Callback\n                                if (typeof opts.hoverOutCallback === 'function') {\n                                    opts.hoverOutCallback(e, $menuEl);\n                                }\n                            }\n                        }, 500);\n                        $menuEl.data('hoverTimer', timer);\n                    }\n                };\n            };\n\n            // Attach Hover Events to Separate Menu to Prevent Premature Closing of Menu\n            // - options.isSeparateMenu should be a DOM selector string if not undefined\n            $('body').on('mouseenter.Shared.Body mouseleave.Shared.Body', options.isSeparateMenu, menuHoverFunc(options));\n        }\n    };\n\n\n    /* ******************************************************************************************** */\n    /* * AJAX Related Methods                                                                     * */\n    /* ******************************************************************************************** */\n\n    /**\n     *\n     * Constructs an absolute URL to a Hub resource from a relative URL.\n     *\n     * @param relativePath\n     * @returns {string}\n     */\n    Shared.absoluteHubUrl = function(relativePath) {\n        var baseUrl = Hubs.Config.hubBaseUrl;\n\n        if (window.self.location.hostname === 'localhost'){\n            // This allows onBrand to proxy the hub for local development\n            baseUrl = window.location.protocol + '//' + window.location.hostname + (window.location.port ? (':' + window.location.port) : '');\n        }\n\n        // Remove trailing slash from base URL\n        if (baseUrl.substr(-1) === '/') {\n            baseUrl = baseUrl.substr(0, baseUrl.length - 1);\n        }\n\n        // Remove leading slash from relative path\n        if (relativePath.substr(0, 1) === '/') {\n            relativePath = relativePath.substr(1, relativePath.length - 1);\n        }\n\n        return baseUrl + '/' + relativePath;\n    }\n\n    /**\n     * Initiates an AJAX request to the server and returns parsed JSON data via a callback\n     *\n     * @public\n     * @this local\n     * @param {String} url The URL to send an ajax request to\n     * @param {Object} [data] A JSON Object of Data to send to the server\n     * @param {String} [type] The Type of Request to send ('POST' or 'GET') - defaults to 'POST'\n     * @param {Boolean} [parseJson] A flag indicating whether or not to Parse results as JSON\n     * @param {Function} [callback] A callback function to execute once the server has return a successful result. The result data is passed as a parameter to the callback function.\n     * @param {Function} [errorCallback] A callback function to execute once the server has return a failed result.  The jqXhr data is given to the function.\n     * @return undefined\n     */\n    Shared.ajaxFetch = function(url, data, type, parseJson, callback, errorCallback) {\n        if (type === undefined) { type = 'POST'; }\n        var uuid = Shared.getUUID();\n        var cache = (type !== 'POST') && !Shared.MS_IE_10;\n\n        var parsedUrl = Hubs.url.parse(url);\n        if (parsedUrl.reference !== 'absolute' && parsedUrl.reference !== 'uri') {\n            // If url is relative, prepend the Hub's base url to make it absolute.\n            url = Shared.absoluteHubUrl(url);\n        }\n\n        var ajaxOptions = {\n            'type'     : type,\n            'url'      : url,\n            'async'    : true,\n            'cache'    : cache,\n            'success'  : $.proxy(function(data) {\n                try      { if (parseJson && typeof data === 'string') { data = JSON.parse(data); } }\n                catch(e) { throw new Shared.Exception('ajax-failed-parse', {'reason': e}); }\n                finally  { if (typeof callback === 'function') { callback.call(this, data); } }\n            }, this),\n            'error' : $.proxy(function(jqXhr, textStatus, errorThrown) {\n                // Use the error callback if would be considered a non-fatal error\n                if (typeof errorCallback === 'function') {\n                    errorCallback.call(this, jqXhr);\n                } else {\n                    if (textStatus !== 'abort' ) {\n                        throw new Shared.Exception('ajax-failed-receive', {'reason': errorThrown});\n                    }\n                }\n\n            }, this)\n        };\n\n        // Send Data?\n        if (typeof data === 'object') {\n            ajaxOptions.data = data;\n        }\n\n        // Send Ajax Request\n        Shared.LastXhr[uuid] = $.ajax(ajaxOptions, this);\n        return uuid;\n    };\n\n    /**\n     * Cancels the last AJAX request to the server\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Shared.cancelAjax = function(uuid) {\n        if (uuid && Shared.LastXhr[uuid] && Shared.LastXhr[uuid].readyState !== 4) {\n            Shared.LastXhr[uuid].abort();\n            Shared.LastXhr[uuid] = null;\n            return true;\n        }\n        return false;\n    };\n\n    /* ******************************************************************************************** */\n    /* * Special Event Registration                                                               * */\n    /* *  -- debouncedresize                                                                      * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Initialize Special Global Events\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Shared.initSpecialEvents = function(threshold) {\n        var specialEvents = [\n            {'event': 'resize', 'prefix': 'debounced', 'threshold': threshold || 0}\n        ];\n        Shared.registerSpecialEvents(specialEvents);\n    };\n\n    /**\n     * Register Specialized Global Events\n     *\n     *   [\n     *      {'event': 'resize', 'prefix': 'debounced', 'threshold': 150}\n     *      {'event': 'keyup',  'prefix': 'debounced', 'threshold': 250},\n     *   ]\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Shared.registerSpecialEvents = function(eventsArray) {\n        var i, $event = $.event;\n        if (!Array.isArray(eventsArray)) { return; }\n\n        var specialSetup = function(evd) {\n            return function() {\n                var $win = $(this);\n                if (!$win.data('special-event-init-' + evd.event)) {\n                    $win.data('special-event-init-' + evd.event, true);\n                    $win.on(evd.event, evd.$special.handler);\n                }\n            };\n        };\n        var specialteardown = function(evd) {\n            return function() {\n                $(this).off(evd.event, evd.$special.handler);\n            };\n        };\n        var specialHandler = function(evd) {\n            return function(event, execAsap) {\n                // Save the context\n                var context = this,\n                    args = arguments,\n                    dispatch = function() {\n                        // set correct event type\n                        event.type = evd.prefix + evd.event;\n                        $event.dispatch.apply(context, args);\n                    };\n\n                if (evd.eventTimeout) {\n                    window.clearTimeout(evd.eventTimeout);\n                }\n\n                if (execAsap) { dispatch(); }\n                else { evd.eventTimeout = window.setTimeout(dispatch, evd.$special.threshold); }\n            };\n        };\n\n        // Loop through Events Array\n        for (i = 0; i < eventsArray.length; i++) {\n            var evd = eventsArray[i];\n            evd.$special = {};\n            evd.eventTimeout = 0;\n\n            // Ensure valid Event Data\n            if (evd.event === undefined || !evd.event.length) { continue; }\n            if (evd.prefix === undefined || !evd.prefix.length) { evd.prefix = 'debounced'; }\n            if (evd.threshold === undefined || evd.threshold < 10) { evd.threshold = 150; }\n\n            // Avoid registering events twice\n            if ($event.special[evd.prefix + evd.event]) { continue; }\n\n            // Create Special Event Handler\n            evd.$special = $event.special[evd.prefix + evd.event] = {\n                'setup'     : specialSetup(evd),\n                'teardown'  : specialteardown(evd),\n                'handler'   : specialHandler(evd),\n                'threshold' : evd.threshold\n            };\n        }\n    };\n\n    /**\n     * Returns the page queries without onBrand prefixed url params\n     *\n     * @param queryNames\n     * @returns {undefined}\n     */\n    Shared.removeCustomCodeCommands = function(queryNames) {\n        $.each(queryNames, function (key) {\n            if (/ufcc_[a-zA-Z0-9_]*/g.test(key)) {\n                delete queryNames[key];\n            }\n        });\n        return queryNames;\n    };\n\n\n    /* ******************************************************************************************** */\n    /* * Fixes for 3rd-Party Plugins                                                              * */\n    /* ******************************************************************************************** */\n\n    // Fix Bindings for Older jQuery\n    if (typeof $.on !== 'function') { $.on = $.bind; }\n\n\n    /* ******************************************************************************************** */\n    /* * Private/Static Member Vars                                                               * */\n    /* ******************************************************************************************** */\n\n    /** @member {Object} ElementBank A bank of Cached jQuery Objects with handles to DOM Elements */\n    Shared.ElementBank = {};\n\n    /** @member {Object} LastXhr A handle to the last Ajax Request made */\n    Shared.LastXhr = {};\n\n\n}(window.jQuery));\n\n"},function(t,e,n){n(10)(n(341))},function(t,e){t.exports="(function($, undefined) {\n    \"use strict\";\n\n    Hubs.lastKnownBodyScroll = false;\n\n    /**\n     * Checks if the device is considered a Mobile device\n     *\n     * @public\n     * @this local\n     * @return {Boolean} True if the device is a Mobile device\n     */\n    Hubs.isMobile = function() {\n        return Hubs.Config.isMobile;\n    };\n\n    /**\n     * Checks if the Hub is viewed within an IFrame\n     *\n     * @public\n     * @this local\n     * @return {Boolean} True if the Hub is within an IFrame\n     */\n    Hubs.isIFrame = function() {\n        return Hubs.Config.isIFrame;\n    };\n\n    /**\n     * Checks if the Hub is Embedded within an IFrame\n     *\n     * @public\n     * @this local\n     * @return {Boolean} True if the Hub is Embedded within an IFrame\n     */\n    Hubs.isEmbedded = function() {\n        return Hubs.Config.isEmbedded;\n    };\n\n    /**\n     * Ensure the eloquatk cookie is updated for the visitor and ping the server to populate the known user cache\n     *\n     * @public\n     * @this local\n     * @return {String} Eloqua tracking GUID if found, null otherwise.\n     */\n    Hubs.registerEloquaVisitor = function() {\n        var updateEloquaVisitor = function() {\n            var guid = Hubs.getEloquaVisitorGUID();\n\n            if (guid) {\n                if (Hubs.getEloquaUTKValue() !== guid) {\n                    Hubs.setEloquaUTKValue(guid);\n\n                    // Causes 'known user' cache to be updated with Eloqua user data\n                    Shared.ajaxFetch(Hubs.Config.serverUrl.ping, null, 'GET', true, null, null);\n                }\n            }\n\n            return guid;\n        };\n\n        if (updateEloquaVisitor() === null) {\n            var intervalCount = 0;\n            // 12 * 500ms = 6s max total wait time -- recommended by product team\n            var maxIntervalCount = 12;\n            var intervalTimeout = 500;\n\n            var interval = setInterval(function () {\n                intervalCount ++;\n                // sometimes the eloqua request to set the customer GUID fails (or succeeds incorrectly)\n                // here we tell the eloqua script to retry that request\n                if (typeof window._elqQ !== 'undefined') {\n                  window._elqQ.push(['elqGetCustomerGUID']);\n                }\n\n                if (updateEloquaVisitor() !== null || intervalCount === maxIntervalCount) {\n                    clearInterval(interval);\n                }\n            }, intervalTimeout);\n        }\n    };\n\n\n    /**\n     * Retrieve an Eloqua visitor tracking GUID from a first or third party cookie\n     *\n     * @public\n     * @this local\n     * @return {String} Eloqua visitor tracking GUID if found, null otherwise.\n     */\n    Hubs.getEloquaVisitorGUID = function() {\n        var guid = null;\n\n        if (Hubs.Config.eloquaFirstPartyCookies === 1) {\n            var cookieName, cookieValue, equalsSignIndex;\n            var cookies = document.cookie.split(';');\n\n            for (var i = 0; i < cookies.length; i++) {\n                equalsSignIndex = cookies[i].indexOf('=');\n\n                if (equalsSignIndex > 0 && cookies[i].length > equalsSignIndex + 1) {\n                    cookieName = cookies[i].substr(0, equalsSignIndex).trim();\n\n                    if (cookieName === 'ELOQUA') {\n                        cookieValue = cookies[i].substr(equalsSignIndex + 1);\n\n                        var subCookies = cookieValue.split(\"&\");\n\n                        for (var l = 0; l < subCookies.length; l++) {\n                            var subCookie = subCookies[l].split(\"=\");\n\n                            if (subCookie.length === 2 && subCookie[0] === 'GUID') {\n                                guid = subCookie[1];\n                            }\n                        }\n                    }\n                }\n            }\n        } else if (typeof window.GetElqCustomerGUID === 'function') {\n            guid =  window.GetElqCustomerGUID();\n        }\n\n        return guid;\n    };\n\n    /**\n     * Populate the Uberflip eloquautk cookie with an Eloqua tracking GUID\n     *\n     * @public\n     * @this local\n     * @param {String} guid - An Eloqua tracking GUID\n     * @return undefined\n     */\n    Hubs.setEloquaUTKValue = function(guid) {\n        var date = new Date();\n        date.setTime(date.getTime() + (60 * 60 * 24 * 1000 * 365));\n\n        var expiry = \"; expires=\" + date.toUTCString();\n\n        document.cookie = 'eloquautk' + '=' + guid + expiry + '; path=/';\n    };\n\n    /**\n     * Get the value of the Uberflip eloquautk cookie\n     *\n     * @public\n     * @this local\n     * @return {String} The GUID value found in eloquautk, or null if not found\n     */\n    Hubs.getEloquaUTKValue = function() {\n        var cookieName, cookieValue, equalsSignIndex;\n        var cookies = document.cookie.split(';');\n\n        for (var i = 0; i < cookies.length; i++) {\n            equalsSignIndex = cookies[i].indexOf('=');\n\n            if (equalsSignIndex > 0 && cookies[i].length > equalsSignIndex + 1) {\n                cookieName = cookies[i].substr(0, equalsSignIndex).trim();\n\n                if (cookieName === 'eloquautk') {\n                    cookieValue = cookies[i].substr(equalsSignIndex + 1);\n\n                    return cookieValue;\n                }\n            }\n        }\n\n        return null;\n    };\n\n    /**\n     * Check if a given Marketing Automation Platform is connected on this Hub\n     *\n     * @public\n     * @this local\n     * @return {Boolean} True if the map is connected\n     */\n    Hubs.mapIsConnected = function(map) {\n        var integrationCount = Hubs.Config.mapIntegrations.length;\n\n        for (var i = 0; i < integrationCount; i++) {\n            if (Hubs.Config.mapIntegrations[i].toLowerCase() === map.toLowerCase()) {\n                return true;\n            }\n        }\n\n        return false;\n    };\n\n    /**\n     * Scroll the Body Element to a Pixel-Based Coordinate\n     *  - Standarized method for Scrolling that works in all Browsers/Devices\n     *\n     * @public\n     * @this local\n     * @param {Number} top - The amount of Pixels to Scroll the Element by; If not supplied, will return the Current Value of \"scrollTop\"\n     * @param {Number} animateSpeed - The speed of the Animation to use; if not set no animation will be used\n     * @param {Object} $el - a jQuery Element Handle to the Element to be Scrolled; Defaults to \"window\"\n     * @return undefined\n     */\n    Hubs.scrollTop = function(top, animateSpeed, $el) {\n        return Shared.scrollTop(top, animateSpeed, $el);\n    };\n\n    /**\n     * Resizes any Video Controls to fit within the Space provided by its container\n     *\n     * @public\n     * @this local\n     * @param {String} Optional param for the hubs page type\n     * @return undefined\n     */\n    Hubs.updateVideoSize = function(type) {\n        // Vidyard or Vimeo page type should never try this code\n        if (type !== undefined && (type === 'vidyard' || type === 'vimeo')) {\n            return;\n        }\n\n        var $vids = $(Hubs.Config.containers.videoPlayer);\n        if ($vids.length) { $vids.fitVids(); }\n    };\n\n    /**\n     * Removes the Main Hub Sharing section if there are no Sharing Options enabled\n     *\n     * @public\n     * @this local\n     * @param {Object} hub The Hub object to get the sharing options from\n     * @return undefined\n     */\n    Hubs.toggleHubSharing = function(hub) {\n        var countClass = '';\n\n        // Get ClassName for Share Icons\n        countClass = Hubs.getShareCountClass(hub);\n\n        // If there is no sharing enabled, disable the Mobile Share Nav\n        if (countClass === 'zero') {\n            $('.share-toggle').remove();\n        }\n    };\n\n    /**\n     * Toggles the Height of an Element with an Unknown Height\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.toggleHeight = function(state, $content, defaultMaxHeight) {\n        var newHeight = 0, maxHeight = 0;\n\n        if (defaultMaxHeight === undefined) {\n            defaultMaxHeight = 0;\n        }\n\n        if (state) {\n            // Store Old Max-Height of Section Content\n            maxHeight = parseInt($content.css('max-height'), 10) || defaultMaxHeight;\n            $content.data('max-height', maxHeight);\n\n            // Calculate New Height to Expand to\n            newHeight = $content.prop('scrollHeight');\n\n            // Expand Height\n            $content.css({'max-height': newHeight});\n        } else {\n            // Restore Height\n            $content.css({'max-height': $content.data('max-height')});\n        }\n    };\n\n    /**\n     * Closes any open menus in the Desktop and Mobile Navigation Menus\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.closeOpenMenus = function() {\n        var $expandedItems = Shared.$('.mobile-nav').find('li.expanded');\n\n        // Close any open menus\n        Shared.$(Hubs.Config.containers.leftNav[2]).find('li.collapsed').removeClass('hover');\n        $expandedItems.each(function() {\n            var $el = $(this);\n            Hubs.toggleHeight(false, $el.find('.collapsable-section'));\n            $el.removeClass('expanded').addClass('collapsed');\n        });\n        Shared.$('.mobile-nav').hide();\n        $('.share-hub, .share-item').removeClass('hover');\n    };\n\n    /**\n     * Updates the Page-Width Element with appropriate classnames\n     *   - Updates the classnames of the page-width div in the top-nav to be the same as the\n     *     page-width div in the content of the page\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.updatePageWidthElement = function(pageType) {\n        var $headerContent = $('header .page-width');\n        var $bodyContent = $('#hubs-container .page-width');\n\n        if (!$headerContent.length || !$bodyContent.length) { return; }\n        $headerContent.removeClass().addClass($bodyContent.attr('class'));\n    };\n\n    /**\n     * Positions the Left Nav for Desktop and Tablet Devices\n     *     - ensures that the menu is centered vertically within the view when larger than the viewport\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.positionLeftNav = function() {\n        var $leftNav = Shared.$(Hubs.Config.containers.leftNav[2]),\n            $hoveredEl = $leftNav.find('.hover'),\n            $hoveredList, ny, ly, lh, ot,\n            vph = Shared.$('window').height();\n\n        // Fix Position\n        if ($hoveredEl.length) {\n            // Reset Position\n            $hoveredList = $hoveredEl.find('> ul');\n            $hoveredList.css({'top': 0});\n\n            ly = 0 - Shared.$('window').scrollTop();\n            lh = $hoveredList.outerHeight();\n            ot = $hoveredList.offset();\n            if (ot && ot.top !== undefined) {\n                ly += ot.top;\n            }\n\n            // Fit in Viewport\n            if (lh >= vph) {\n                lh = vph - 40;\n                $hoveredList.height(lh).css({'overflow': 'auto'});\n            }\n\n            // Position in Vertical Center of Screen\n            if (ly + lh + 10 > vph) {\n                ny = ly - ((vph - lh) / 2);\n                $hoveredList.css({'top': -ny});\n            }\n        }\n    };\n\n    /**\n     * Positions the Sharing Nav for Desktop and Tablet Devices\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.positionShareNav = function() {\n        var $shareNav = Shared.$('.share-hub'),\n            $shareBtn = Shared.$('.share-toggle');\n        if (!$shareNav.length || !$shareBtn.length) { return; }\n        if ($('.share-item').length) { $shareNav = $('.share-item'); }\n        if (!Hubs.isEmbedded()) {\n            $shareNav.css({'left': $shareBtn.offset().left + $shareBtn.outerWidth() - $shareNav.outerWidth()});\n        } else {\n            $shareNav.css({\n                'top' : $shareBtn.offset().top + $shareBtn.outerHeight() + 7,\n                'left': $shareBtn.offset().left + $shareBtn.outerWidth() - $shareNav.outerWidth()\n            });\n        }\n    };\n\n    /**\n     * Updates the Size of Images in Tiles after the Image has Loaded\n     *\n     * @public\n     * @this local\n     * @param {Object} app A reference to the Application Object\n     * @param {String} container The selector of the Container to fix images within\n     * @return undefined\n     */\n    Hubs.updateImageTiles = function(app, container) {\n        var imgLoad = imagesLoaded(container);\n\n        imgLoad.on('progress', function(instance, image) {\n            var $img = null;\n            if (!image.isLoaded) { return; }\n\n            $img = $(image.img);\n\n            // Weird stuff happens in IOS chrome where width is loaded and height isn't\n            // Attaching an onload event seems to work\n            if($img.height() <= 0 && $img.width() > 0){\n                image.img.onload = function() {\n                    app.resizeImageTile(image.img, function() {\n                        $img.parent().addClass('visible');\n                    });\n                };\n            } else {\n                app.resizeImageTile(image.img, function() {\n                    $img.parent().addClass('visible');\n                });\n            }\n        });\n\n        // Ensure All Images are Visible\n        imgLoad.on('always', $.proxy(function(instance, image){\n            $(container + ':not(.visible)').addClass('visible');\n        }, this));\n    };\n\n    /**\n     * Fixes Large Content Images by removing any specified Height/Width attributes or styles\n     *     - Checks if the image is larger than a specific size, and adds a classname to help styling\n     *\n     * @public\n     * @this local\n     * @param {String} type The Type of Page to be displayed\n     * @param {String} container The ID of the Container to fix images within\n     * @return undefined\n     */\n    Hubs.fixContentImages = function(type, container) {\n        var $container = $(container);\n        if (!$container.length) { return; }\n\n        // Fix content imags for Blogs\n        if (/blogs|blogpost/i.test(type)) {\n            $container.find('.entry img').each(function(idx, el) {\n                var $el = $(el);\n                if ($el.width() > Hubs.LARGE_IMAGE_WIDTH || $el.height() > Hubs.LARGE_IMAGE_HEIGHT) {\n                    $el.addClass('large');\n                }\n                $el.removeAttr('height').css({'height': 'auto'});\n            });\n        }\n    };\n\n    /**\n     * Loads images not hosted on our server for safety purposes\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.loadNonProxiedImages = function(){\n        $(Hubs.Config.containers.nonProxiedImg).each(function(){\n            var imageTest = $('<img>'),\n                $container = $(this);\n            imageTest.attr('src', $container.attr('data-imgurl')).load(function () {\n                $(this).addClass($container.attr('data-class'));\n                $container.parent().html(this.outerHTML).hide().fadeIn(500);\n            }).error(function () {\n                // Broken link, remove the span\n                $container.remove();\n            });\n        });\n    };\n\n    /**\n     * Styles timestamps to english\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.setFriendlyTimestamps = function(){\n        $(Hubs.Config.containers.timeAgo).timeago();\n    };\n\n    /**\n     * Fixes Content Links by adding target=\"_blank\" rel=\"noopener\" data-internal=\"false\"\n     *\n     * @public\n     * @this local\n     * @param {String} container The ID of the Container to fix images within\n     * @return undefined\n     */\n    Hubs.fixContentLinks = function(container) {\n        var $container = $(container);\n        if (!$container.length) { return; }\n\n        $container.find('a:not(.hooked)').each(function(idx, el) {\n            var $el = $(el);\n            // if target is already set, respect content's decision\n            // otherwise override to open in new window unless it's an anchor\n            if ($el.attr('target')) {\n                $el.attr('data-internal', 'false');\n            }\n            else if(Hubs.isLinkInternal($el.attr('href'))) {\n                $el.attr('data-internal', 'standard');\n            }\n            else if ($el.attr('href') && $el.attr('href').length && $el.attr('href').charAt(0) === '#') {\n                $el.attr({'target': '_self', 'data-internal': 'false'});\n            }\n            else {\n                $el.attr({'target': '_blank', 'rel': 'noopener', 'data-internal': 'false'});\n            }\n        });\n    };\n\n    Hubs.isLinkInternal = function(link) {\n        if(typeof link != 'string') {\n            return false;\n        }\n        var pattern = new RegExp(\"^\" + location.protocol + \"//\" + window.location.hostname, \"i\");\n        return link.match(pattern) !== null;\n    };\n\n    /**\n     * Fixes previous and next images for the image pages by re-aligning\n     *\n     * @public\n     * @this local\n     * @param {String} container The ID of the Container to fix images within\n     * @return undefined\n     */\n    Hubs.fixPrevNextImages = function(container) {\n        var $container = $(container),\n            imgLoad = null;\n\n        if (!$container.length) { return; }\n\n        imgLoad = imagesLoaded(container);\n        imgLoad.on('always', function(instance, image){\n            $container.find('.prev-next img').each(function(){\n                var img = $(this), w = img.width(), pw = img.parent().width();\n                if (w > pw) {\n                    img.css('left', -((w-pw)/2));\n                }\n            });\n         });\n\n     };\n\n    /**\n     * Restricts Scrolling on the Body Element (used while the Splash Screen is Displayed)\n     *  - Note: \"noscroll\" class sets Body Element Position to \"Fixed\", so we have to transfer the current value\n     *    of \"scrollTop\" to the Body CSS \"top\", and transfer back when we restore scrolling.\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.restrictBodyScroll = function(scrollTop) {\n        if (Hubs.lastKnownBodyScroll !== false) { return; }\n        Hubs.lastKnownBodyScroll = Math.max(Shared.scrollTop(), scrollTop || 0);\n        Shared.scrollTop(0);\n        Shared.$('body').css({'top': -Hubs.lastKnownBodyScroll});\n        Shared.$('body').addClass('noscroll');\n    };\n\n    /**\n     * Restores Scrolling on the Body Element\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.restoreBodyScroll = function() {\n        if (Hubs.lastKnownBodyScroll === false) { return; }\n        Shared.scrollTop(Hubs.lastKnownBodyScroll);\n        Shared.$('body').css({'top': 0});\n        Shared.$('body').removeClass('noscroll');\n        Hubs.lastKnownBodyScroll = false;\n    };\n\n    /**\n     * Sets the State of Scrolling on the Body Element\n     *\n     * @public\n     * @param {Boolean} state - True to Allow Scrolling, False to Restrict Scrolling\n     * @this local\n     * @return undefined\n     */\n    Hubs.setBodyScroll = function(state) {\n        Hubs[state ? 'restoreBodyScroll' : 'restrictBodyScroll']();\n    };\n\n    /**\n     * Stores a page view either locally or server side depending on condition\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.storePageView = function(pageType, itemId, collectionId, hiddenBlockingCta){\n        var configKnownUser = Hubs.Config.knownUser;\n\n        var knownUsers = [];\n        for (var key in configKnownUser) {\n            if (\n                configKnownUser.hasOwnProperty(key) &&\n                configKnownUser[key]\n            ) {\n                knownUsers.push(key);\n            }\n        }\n\n        var timestamp = Hubs.Config.serverTimestamp || Math.floor(Date.now()/1000);\n\n        var currentView = [itemId, collectionId, timestamp, window.location.toString()];\n\n        // Send page views\n        if (knownUsers.length) {\n            var data = {};\n            for (var j=0; j < knownUsers.length; j++) {\n                 // check storage before submit\n                 var dataStorage = localStorage.getItem(knownUsers[j]);\n                 if(dataStorage !== null && typeof dataStorage !== \"undefined\"){\n                     dataStorage = JSON.parse(dataStorage);\n                 }\n\n                 // check if we need to submit additional data\n                 if (dataStorage && _.isArray(dataStorage.items)) {\n                     dataStorage.items.push(currentView);\n                     data[knownUsers[j]] = dataStorage.items;\n                 } else {\n                     data[knownUsers[j]] = [currentView];\n                 }\n            }\n\n            Shared.ajaxFetch(Hubs.Config.serverUrl.pageViewTracking, {views: data, hiddenBlockingCta: hiddenBlockingCta}, 'POST', true, function(resp){\n                if (resp.response.ok) {\n                    // clean storage\n                    for (var j=0; j < knownUsers.length; j++) {\n                        localStorage.setItem(knownUsers[j],  JSON.stringify({items:[]}));\n                    }\n                }\n            });\n        }\n\n        // Get unsaved integrations\n        var unsavedIntegrations = _.difference(Hubs.Config.integrationsToTrackViews, knownUsers);\n\n        // Save page views\n        if (unsavedIntegrations.length) {\n            for (var i=0; i < unsavedIntegrations.length; i++) {\n                var integrationName = unsavedIntegrations[i];\n                var obj = localStorage.getItem(integrationName);\n                if (obj === null || typeof obj === \"undefined\"){\n                    // Create a new object\n                    obj = {\"items\": [currentView]};\n                } else {\n                    obj = JSON.parse(obj);\n                    if (_.isArray(obj.items)) {\n                        // If user reached the limit of 150 items, reset the item list\n                        if (obj.items.length >= 150) {\n                            obj.items = [currentView];\n                        } else {\n                            obj.items.push(currentView);\n                        }\n                    }\n                }\n                localStorage.setItem(integrationName,  JSON.stringify(obj));\n            }\n        }\n\n        // Update MAP users\n        Shared.ajaxFetch(Hubs.Config.serverUrl.updateMAPUsers, {}, 'POST', true, function(data) {\n            if (data.response.knownUser) {\n                Hubs.Config.knownUser = data.response.knownUser;\n                Object.seal(Hubs.Config.knownUser);\n            }\n        });\n    };\n\n    /**\n     * getUrlFragmentId():\n     *   Converts a non-vanity url into a fragment that is used as a hash-bookmark on the\n     *   embedded hub's parent window.\n     *\n     * @public\n     * @this local\n     * @param pageUrl = non-vanity url, e.g. https://hub.uberflip.com/h/i/12448663-example-article\n     * @returns {string} = bookmark fragment, e.g. ufh-i-12448663-example-article\n     */\n    Hubs.getUrlFragmentId = function(pageUrl) {\n        var urlFragment = pageUrl || '';\n        var index;\n\n        // Remove any Query String\n        index = urlFragment.indexOf('?');\n        if (index > -1) urlFragment = urlFragment.substr(0, index);\n\n        // Remove any Fragment Identifiers\n        index = urlFragment.indexOf('#');\n        if (index > -1) urlFragment = urlFragment.substr(0, index);\n\n        // Clean Up URL\n        urlFragment = urlFragment.substr(urlFragment.lastIndexOf('/h') + 3).replace(/([c|i|author])\\//i, '$1-');\n        if (urlFragment.length) urlFragment = 'ufh-' + urlFragment;\n\n        return urlFragment;\n    };\n\n    /**\n     * Initialize Special Global Events\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.initSpecialEvents = function() {\n        var specialEvents = [\n            {'event': 'keyup',  'prefix': 'debounced', 'threshold': 250},\n            {'event': 'resize', 'prefix': 'debounced', 'threshold': 150},\n            {'event': 'scroll', 'prefix': 'debounced', 'threshold': 150}\n        ];\n        Shared.registerSpecialEvents(specialEvents);\n    };\n\n  /**\n   * Delegate events to jquery\n   */\n  var eventNamespace = 'Hubs';\n  var $eventElement = $(window);\n  Hubs.Events = {\n    on: function(eventName, fn) {\n      $eventElement.on(eventNamespace + '.' + eventName, function(/*jqEvent*/) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        fn.apply(null, args);\n      });\n\n      // allow chaining\n      return Hubs.Events;\n    },\n    off: function(eventName) {\n      $eventElement.off(eventNamespace + '.' + eventName);\n      return Hubs.Events;\n    },\n    trigger: function(/*eventName*/) {\n      var args = Array.prototype.slice.call(arguments);\n      args[0] = eventNamespace + '.' + args[0];\n      $eventElement.trigger.apply($eventElement, args);\n    }\n  };\n\n\n}(window.jQuery));\n\n"},function(t,e,n){n(10)(n(343))},function(t,e){t.exports="(function() {\n    'use strict';\n    var $ = (typeof exports !== 'undefined') ? exports : ((typeof window.global === 'object') ? window.global : window);\n\n    // Define Shared Object\n    $.Shared           = $.Shared || {};\n    $.Shared.author    = 'Mobile Dev Team @ Flyp Technologies Inc.';\n    $.Shared.copyright = '(c) 2013 Flyp Technologies Inc., all rights reserved.';\n    $.Shared.root      = $;\n}());\n\n(function($, undefined) {\n    'use strict';\n\n    /**\n     * Shared Logger\n     *\n     * @class Logger\n     * @classdesc Logs Messages to the Console for Debugging\n     * @namespace Shared\n     * @constructor\n     */\n    Shared.Logger = Shared.Logger || function() {};\n\n\n    /* ******************************************************************************************** */\n    /* * Private Static Members                                                                   * */\n    /* ******************************************************************************************** */\n    Shared.Logger.l10n     = {};\n    Shared.Logger.enabled  = true;\n\n\n    /* ******************************************************************************************** */\n    /* * Public Static Methods                                                                    * */\n    /* ******************************************************************************************** */\n    /**\n     * Logs a Message to the Console; Type and Arguments may be specified\n     *\n     * @public\n     * @this Shared.Logger\n     * @param {Mixed} options The message to be logged.  Can be a string for direct translation, or an object with 'msg', 'type' and 'args' keys\n     * @return {Boolean} Returns False for all Error type logs; True for all others\n     */\n    Shared.Logger.log = function(options) {\n        if (!Shared.Logger.enabled) { return; }\n        \n        // Parse Options into a Readable Message\n        options = Shared.Logger.parse(options);\n        \n        // Output Message\n        Shared.Logger.output(options.msg, options.type);\n\n        // Return\n        return !/^error$/i.test(options.type);\n    };\n\n    /**\n     * Common Function for Outputting to the Logs\n     *\n     * @public\n     * @this Shared.Logger\n     * @param {String} msg The message to be logged\n     * @param {String} [type] The type of message to log ('debug', 'info', 'error', 'warning')\n     * @return undefined\n     */\n    Shared.Logger.output = function(msg, type) {\n        if (!Shared.Logger.enabled) { return; }\n        Shared.root.console.log(msg);\n    };\n\n    /**\n     * Parses a Log Object to get translations and arguments into the Message\n     *\n     * @public\n     * @this Shared.Logger\n     * @param {Mixed} options The message to be logged.  Can be a string for direct translation, or an object with 'msg', 'type' and 'args' keys\n     * @return {Object} The parsed and translated options\n     */\n    Shared.Logger.parse = function(options) {\n        var arg = null;\n\n        if (typeof options !== 'object') {\n            options = {'msg': options};\n        }\n        if (options.msg === undefined) { options.msg = ''; }\n        if (options.type === undefined) { options.type = Shared.LVL_DEBUG; }\n        if (options.args === undefined) { options.args = null; }\n\n        // Attempt to Convert Message\n        if (typeof options.msg === 'string') {\n            if (Shared.Logger.l10n[options.msg] !== undefined) {\n                options.msg = Shared.Logger.l10n[options.msg];\n            }\n        }\n\n        // If Type Exists Prepend Type\n        if (options.type && options.type.length) {\n            options.msg = '[' + options.type + '] ' + options.msg;\n        } else {\n            options.type = 'none';\n        }\n\n        // Replace Args in Message\n        if (options.args !== undefined) {\n            for (arg in options.args) {\n                if (options.args.hasOwnProperty(arg)) {\n                    options.msg = options.msg.replace('{{' + arg + '}}', options.args[arg]);\n                }\n            }\n        }\n\n        return options;\n    };\n\n    /**\n     * Sets the Localization Text for String Conversions\n     *\n     * @public\n     * @this Shared.Logger\n     * @param {Object} l10n An object containing key->value associations for text conversions\n     * @return undefined\n     */\n    Shared.Logger.setL10N = function(l10n) {\n        Shared.Logger.l10n = $.extend(true, {}, Shared.Logger.l10n, l10n);\n    };\n\n}(window.jQuery));\n"},function(t,e,n){n(10)(n(345))},function(t,e){t.exports="(function() {\n    'use strict';\n    var $ = (typeof exports !== 'undefined') ? exports : ((typeof window.global === 'object') ? window.global : window);\n\n    // Define Shared Object\n    $.Shared           = $.Shared || {};\n    $.Shared.author    = 'Mobile Dev Team @ Flyp Technologies Inc.';\n    $.Shared.copyright = '(c) 2013 Flyp Technologies Inc., all rights reserved.';\n    $.Shared.root      = $;\n}());\n\n(function($, undefined) {\n    \"use strict\";\n\n    Shared.Tracker = Shared.Tracker || function() {};\n\n    /* ******************************************************************************************** */\n    /* * Private Static Members                                                                   * */\n    /* ******************************************************************************************** */\n    Shared.Tracker.analyticsCodes = [];\n\n    /* ******************************************************************************************** */\n    /* * Public Static Methods                                                                    * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Track Page Change Events via Google Analytics\n     *\n     * @public\n     * @this Shared.Tracker\n     * @param {String} pageUrl The URL of the Page being tracked\n     * @param {Object} stateData The State of the Page being tracked\n     * @return undefined\n     */\n    Shared.Tracker.trackPage = function(pageUrl, stateData) {\n        var i, n, url = '';\n        if (window.gtag === undefined || !Shared.Tracker.analyticsCodes.length) { return; }\n\n        var blacklistedParams = Hubs.Config.ufQueryStrings;\n        var parsedUrl = Hubs.url.parse(pageUrl);\n        var path = parsedUrl.path;\n        var queries = parsedUrl.query || '';\n\n\n        var cleanedParams = queries\n                .split('&')\n                .filter(function(query){\n                    var pair = query.split('=');\n                    var key = pair[0];\n                    var isBlacklisted = blacklistedParams.includes(key);\n                    return !isBlacklisted; // only allow non-blacklisted items to pass the filter\n                })\n                .join('&');\n\n\n        pageUrl = path;\n        if (cleanedParams.length) {\n            pageUrl += '?' + cleanedParams;\n        }\n\n        // Add URL to GA Tracker\n        for (i = 0, n = Shared.Tracker.analyticsCodes.length; i < n; i++) {\n            Shared.Logger.log({'msg': 'tracking-page', 'args': {'page': pageUrl, 'code': Shared.Tracker.analyticsCodes[i]}, 'type': Shared.LVL_DEBUG});\n            gtag('event', 'page_view', { 'send_to': Shared.Tracker.analyticsCodes[i] });\n        }\n    };\n\n    /**\n     * Track Event\n     *\n     * @public\n     * @this Shared.Tracker\n     * @param {String} category\n     * @param {String} action\n     * @param {String} label\n     * @return undefined\n     */\n    Shared.Tracker.trackEvent = function(category, action, label) {\n        var i,n;\n\n        if (window.gtag === undefined || !Shared.Tracker.analyticsCodes.length || !category || !action) { return; }\n        for (i = 0, n = Shared.Tracker.analyticsCodes.length; i < n; i++) {\n\n            // Log Event Tracking for each GA code\n            Shared.Logger.log({'msg': 'tracking-event', 'args': {'event': 'Category:' + category + ' Action:' + action + ' Label:' + label, code: Shared.Tracker.analyticsCodes[i]}, 'type': Shared.LVL_DEBUG});\n\n            gtag('event', action, {event_category: category, event_label: label});\n        }\n    };\n\n    /**\n     * Adds Analytics Codes to the List for Tracking\n     *\n     * @public\n     * @this Shared.Logger\n     * @param {Object} l10n An object containing key->value associations for text conversions\n     * @return undefined\n     */\n    Shared.Tracker.addAnalyticsCodes = function(analyticsCodes) {\n        if (analyticsCodes && analyticsCodes.length) {\n          Shared.Tracker.injectGaScript(analyticsCodes);\n        }\n\n        var i = 0, n = 0;\n        for (n = analyticsCodes.length; i < n; i++) {\n            Shared.Tracker.analyticsCodes.push(analyticsCodes[i]);\n        }\n    };\n\n    /**\n     * Only inject Google Analytics script if there are GA Codes provided for this Hub.\n     */\n    Shared.Tracker.injectGaScript = function (analyticsCodes) {\n        window.dataLayer = window.dataLayer || [];\n        window.gtag = function() {\n            window.dataLayer.push(arguments);\n        };\n        gtag('js', new Date());\n        if (!Array.isArray(analyticsCodes)) {\n            analyticsCodes = [analyticsCodes];\n        }\n        var gtagScript = document.createElement('script');\n        gtagScript.setAttribute('src', 'https://www.googletagmanager.com/gtag/js?id=' + analyticsCodes[0]);\n        gtagScript.async = true;\n        document.head.appendChild(gtagScript);\n        for (var index = 0; index < analyticsCodes.length; ++index) {\n            var an         gtag('config', analyticsCode, {\n                cookie_expires: 31536unction(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};r.get||r.set?Object.defineProperty(e,n,r):e[n]=t[n]}return e.default=t,e}(n(363)),l=m(n(308)),u=m(n(290)),c=m(n(297)),f=m(n(364)),d=m(n(365)),h=n(291),p=n(289);function m(t){return t&&t.__esModule?t:{default:t}}window.ufa",function(){var t;if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)t=!0;else{var e=["@media (",i.default._prefixes.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");i.default.testStyles(e,function(e){t=9===e.offsetTop})}return t}),window.Modernizr=i.default,(0,h.wrapHistory)(window.self.history),window.$=window.jQuery=r.default,n(325),n(327),h.augmentJquery.withAllPollyfills(r.default),c.default.makeJQueryPlugin(r.default),window._=u.default,window.imagesLoaded=c.default,n(311),n(313),n(299),n(329),n(331),n(315),n(366),n(334),n(294),n(336),n(338),n(340),n(342),n(344),n(368),n(370),n(372),n(374),n(376),n(378),n(380),n(309),Hubs.SessionVariable=f.default,Hubs.CookieVariable=d.default,Hubs.url={parse:a.parse},Hubs.recoMetrics=s,Hubs.UfaCaller=o.default,Hubs.Privacy=l.default,n(382)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initialRecoMetrics=function(t){var e=$(window),n="",r={};t?(r=$("#related-items-carousel .tile"),n=$("#related-items-carousel .item-link").first()):(n=$(".reco-panel-items .item-link").first().data("recotrk"),r=$(".reco-panel-items .tile"));var o=r.toArray().map(function(t){return{item:t,item_id:t.dataset.id,collection_id:t.dataset.sourceStreamId,visual:t.getElementsByClassName("item-link")[0].dataset.visual,get isVisible(){return u(t)},impressed:!1}});s(o.filter(function(t){return t.isVisible&&!t.impressed}),n);var c={recoItems:o,recotrk:n};if(t){var f=$("#related-items-carousel"),d=document.querySelectorAll("#recommendation-button-wrapper a")[0];f.on("scroll",c,i),f.on("scroll",c,a),e.on("scroll",c,i),e.on("scroll",c,a);var h=d.dataset,p=h.sourceStreamId,m=h.itemId,g=h.visual,v=[{hub_id:Hubs.Config.hubId,collection_id:p,item_id:m,visual:g}];if(u(d))l(v,n);else{e.on("scroll",c,function t(){u(d)&&(l(v,n),e.unbind("scroll",t))})}e.on("caron("carou=$(".reco-panel");b.on("scroll",c,i),b.on("scroll",c,a),e.on("scroll",c,i),e.on("scroll",c,a)}e.on("resizze",c,a)};var r=n(290),o={},i=function(t){t.data.recoItems.filter(function(t){return t.isVisible&&!t.impressed}).forEach(function(t){return o[t.ite}},600);function s(t,e){t.length&&l(tbs.Config.externalApiUrl;$.ajax({type:"POST",url:"".concat(n,"/recommendations/").concat(e,"/impressions"),data:{data:t.map(function(t){return{hub_id:Hubs.Config.hubId,stream_id:t.collection_id,item_id:t.item_id,visual:t.visual}})}}).done(function(){return t.forEach(function(t){t.impressed=!0})})}function u(t){var e=t.getBoundingClientRect();if(0===e.height||0===e.width)return!1;var n={};n.top=e.top<0,n.left=e.left<0,n.bottom=e.bottom>(window.innerHeight||document.documentElement.clientHeight),n.right=e.right>(window.innerWidth||document.documentElement.clientWidth);var r=!(n.top||n.left||n.bottom||n.right),o=document.getElementById("related-items-carousel");if(r&&o&&$.contains(o,t)){var i=$(o).offset().left,a=i+$(o).width();if(e.l){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(ble=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sessionStorageKey=e}var e,n,r;return e=t,(n=[{key:"on",value:function(t,e){return $.fn.on.apply($(window),["state.".concat(this.sessionStorageKey,".").concat(t),e]),this}},{key:"trigger",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return $.fn.trigger.apply($(window),["state.".concat(this.sessionStorageKey,".").concat(t)].concat(n)),this}},{key:"get",value:function(t){if(t){var e=sessionStorage.getItem(this.sessionStorageKey),n=e?JSON.parse(e):{};return this.trigger("get",n[t],t),n[t]}var r=sessionStorage.getItem(this.sessionStorageKey),o=r?JSON.parse(r):{};return this.trigger("get",o,"all"),o}},{key:"set",value:function(t,e){var n=sessionStorage.getItem(this.sessionStorageKey),r=n?JSON.parse(n):{};return r[t]=e,sessionStorage.setItem(this.sessionStorageKey,JSON.stringify(r)),this.trigger("set",r,t),r}},{key:"clear",value:function(){return sessionStorage.setItem(this.sessionStorageKey,JSON.stringify({})),this.trigger("clear",this.sessionStorageKey),this}},{key:"remove",value:function(t){var e=sessionStorage.getItem(this.sessionStorageKey),n=e?JSON.parse(e):{},r=(n[t],o(n,[t].map(i)));return sessionStorage.setItem(this.sessionStorageKey,JSON.stringify(r)),this.trigger("remove",t),r}},{key:"hasContents",value:function(){var t=this.get();return Object.keys(t).length>0}}])&&a(e.prototype,n),r&&a(e,r),t}();e.default=s},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.cookieName=e,this.cookieSettings=n||{secure:!0}}var e,n,o;return e=t,(n=[{key:"on",value:function(t,e){return $.fn.on.apply($(window),["state.".concat(this.cookieName,".").concat(t),e]),this}},{key:"trigger",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return $.fn.trigger.apply($(window),["state.".concat(this.cookieName,".").concat(t)].concat(n)),this}},{key:"get",value:function(t){if(t){var e=$.cookie(this.cookieName),n=e?JSON.parse(e):{};return this.trigger("get",n[t],t),n[t]}var r=$.cookie(this.cookieName),o=r?JSON.parse(r):{};return this.trigger("get",o,"all"),o}},{key:"set",value:function(t,e){var n=$.cookie(this.cookieName),r=n?.stringify(r),this.cookieSettings),this.trigger("set",r,t),r}},{key:"clear",value:function(){return $.cookie(this.cookieName,JSON.stringify({}),this.cookieSettings),this.trigger("clear",this.cookieName),this}},{key:"hasContents",value:function(){var t=this.get();return Object.keys(t).length>0}}])&&r(e.prototype,n),o&&r(e,o),t}();e.default=o},function(t,e,n){n(10)(n(367))},function(t,e){t.exports="(function() {\n    \"use strict\";\n    var $ = (typeof exports !== 'undefined') ? exports : ((typeof window.global === 'object') ? window.global : window);\n    $.Hubs = $.Hubs || {};\n    $.Hubs.version   = '1.0.2';\n    $.Hubs.author    = 'Mobile Dev Team @ Flyp Technologies Inc.';\n    $.Hubs.copyright = '(c) 2013 Flyp Technologies Inc., all rights reserved.';\n    $.Hubs.root      = $;\n\n    \n    // Fix Date.now() for IE < 9\n    Date.now = Date.now || function() { return +new Date(); };\n}());\n\n(function($, undefined) {\n    \"use strict\";\n    \n    /**\n     * Hubs Core\n     * \n     * @class Core\n     * @classdesc Base class for Hubs.App; provides underlying functionality for the application\n     * @namespace Hubs\n     * @constructor\n     */\n    Hubs.Core = function(options) {\n\n        /* **************************************************************************************** */\n        /* * Private Methods/Members Declarations                                                 * */\n        /* **************************************************************************************** */\n        var initialize = null,\n            optimizeMobile = null,\n            browserIdentifiers = null;\n\n\n        /* **************************************************************************************** */\n        /* * Public Properties                                                                    * */\n        /* **************************************************************************************** */\n        \n\n        /* **************************************************************************************** */\n        /* * Private Methods/Members Definitions                                                  * */\n        /* **************************************************************************************** */\n        \n        /**\n         * Initialize the Core of the Application\n         * \n         * @private\n         * @this Hubs.Core\n         * @param {Object} [options] Configuration Settings for the Class\n         * @return undefined\n         * @constructs\n         */\n        initialize = function() {\n            var $body = Shared.$('body');\n            \n            // Web crawlers are findings url we don't want them to find... using partial urls and building\n            $.each(options.serverUrl, function(key, value){\n                if(key !== 'hub' && key !== 'cdn' && key !== 'ufa') {\n                    options.serverUrl[key] = options.hubBaseUrl + value;\n                }\n            });\n            \n            // Get Configuration Settings for App\n            Hubs.Config = $.extend(true, Hubs.Config, options);\n            \n            // Breakout if Mobile in an iFrame and not Embedded\n            if (window.top !== window.self) {\n                if (Hubs.isMobile() && !Hubs.isEmbedded()) {\n                    window.top.location.href = window.self.location.href;\n                } else {\n                    $body.addClass(\"iframe\");\n                }\n            }\n            \n            // Check for Admin Preview Mode\n            if (/inPreview=1/i.test(window.location.search)) {\n                $body.addClass(\"inPreview\");\n            }\n            \n            // Update Logging/Profiling State\n            Shared.Logger.enabled = Hubs.Config.enableDebugger;\n\n            // Ensure Special Events are initialized; we need the debouncedresize event\n            Hubs.initSpecialEvents();\n            \n            // Update Click Event Type\n            if (Hubs.isMobile()) { \n                Hubs.TAP_EVENT = 'tapone.Hubs';\n                Shared.$('document').on(Hubs.CLICK_EVENT, 'a', $.proxy(function(e) {\n                    if (!$(e.currentTarget).hasClass('hooked')) { return true; }\n                    e.preventDefault();\n                    e.stopPropagation();\n                    return false;\n                }, this));\n            }\n            \n            // Optimizations for Mobile Devices\n            if (Hubs.isMobile()) { optimizeMobile(); }\n            \n            // Identify Browsers to CSS\n            browserIdentifiers();\n            \n            // Prevent Errors\n            if (!Hubs.Config.enableDebugger) {\n                window.onerror = function() { return false; };\n            }\n        };\n        \n        /**\n         * Optimizations for Mobile Devices\n         *     - Should only be called by Hubs.Core.initialize\n         * \n         * @private\n         * @this Hubs.Core\n         * @return undefined\n         */\n        optimizeMobile = function() {\n            // Fix for iPhone viewport scale bug\n            MBP.scaleFix();\n            \n            // Enable CSS active pseudo styles in Mobile Safari\n            MBP.enableActive();\n        };\n        \n        /**\n         * Identify Browsers to CSS\n         *     - Adds specific Classnames to the HTML tag\n         * \n         * @private\n         * @this Hubs.Core\n         * @return undefined\n         */\n        browserIdentifiers = function() {\n            // Check for Mobile\n            if (Hubs.isMobile()) { Shared.$('html').addClass('mobile'); }\n            \n            // Check for IE10\n            if (Shared.MS_IE_10) { Shared.$('html').addClass('ie10'); }\n            \n            // Check for Android 3\n            if (Shared.ANDROID_3) { Shared.$('html').addClass('android3'); }\n            \n            // Check for Firefox in Android Tablets\n            if (Shared.ANDROID_FF) { Shared.$('html').addClass('android-ff'); }\n            \n            // Check for Amazon Kindle\n            if (Shared.AMAZON_SILK) { Shared.$('html').addClass('silk'); }\n            \n            // Check for BB Playbook 2.0\n            if (Shared.BB_PLAYBOOK) { Shared.$('html').addClass('playbook'); }\n            \n            // Check for iOS\n            if (Shared.IOS) { Shared.$('html').addClass('ios'); }\n        };\n\n\n        /* **************************************************************************************** */\n        /* * Entry Point                                                                          * */\n        /* **************************************************************************************** */\n        if (options) { initialize(); }\n    };\n    // End of Hubs.Core\n\n    /* ******************************************************************************************** */\n    /* * Public Exposed Events                                                                    * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Exposed Event: onLoad - Called when the Hub Initially Loads\n     *     - Note: Since the \"this\" variable has been bound the the Instance of the Hubs App,\n     *             all Internal Variables/Methods are available via \"this\".\n     *             For example, \"this.pageType\" will give you the Current Page Type (hub, collection or item)\n     *             \n     * @public \n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.onLoad = function() {};\n\n    /**\n     * Exposed Event: onResize - Called when the Hub is Resized or Reoriented\n     *     - Note: Since the \"this\" variable has been bound the the Instance of the Hubs App,\n     *             all Internal Variables/Methods are available via \"this\".\n     *             For example, \"this.pageType\" will give you the Current Page Type (hub, collection or item)\n     *             \n     * @public \n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.onResize = function() {};\n\n    /**\n     * Exposed Event: onScroll - Called when the Hub is Scrolled (Debounced)\n     *     - Note: Since the \"this\" variable has been bound the the Instance of the Hubs App,\n     *             all Internal Variables/Methods are available via \"this\".\n     *             For example, \"this.pageType\" will give you the Current Page Type (hub, collection or item)\n     *             \n     * @public \n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.onScroll = function() {};\n\n    /**\n     * Exposed Event: onItemsLoaded - Called when the More Items are Loaded within a Stream (Lazyloader or \"More\" button)\n     *     - Note: Since the \"this\" variable has been bound the the Instance of the Hubs App,\n     *             all Internal Variables/Methods are available via \"this\".\n     *             For example, \"this.pageType\" will give you the Current Page Type (hub, collection or item)\n     *             \n     * @public \n     * @this Hubs.App\n     * @param {Array} itemIds - An array of Integers of the Item IDs that were Loaded\n     * @param {String} itemsSelector - An Element Selector for Querying the DOM for the Loaded Tiles\n     * @return undefined\n     */\n    Hubs.onItemsLoaded = function(itemIds, itemsSelector) {};\n    \n    /**\n     * Exposed Event: onPageChange - Called when the Hub Changes Pages Internally\n     *     - Note: Since the \"this\" variable has been bound the the Instance of the Hubs App,\n     *             all Internal Variables/Methods are available via \"this\".\n     *             For example, \"this.pageType\" will give you the Current Page Type (hub, collection or item)\n     *            \n     * @public \n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.onPageChange = function() {};\n\n    /**\n     * Exposed Event: onCtaActivate - Called when the CTA is activated\n     *\n     * @public\n     * @this Hubs.App\n     * @param {int} ctaId\n     * @return undefined\n     */\n    Hubs.onCtaActivate = function(ctaId) {};\n    \n    /**\n     * Exposed Event: onCtaFormSubmitSuccess - Called when a form CTA submissions returns successful\n     *     - Note: Since the \"this\" variable has been bound the the Instance of the Hubs App,\n     *             all Internal Variables/Methods are available via \"this\".\n     *            \n     * @public \n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.onCtaFormSubmitSuccess = function(ctaId, ctaData, ctaName) {};\n    \n    /* ******************************************************************************************** */\n    /* * Public Static Methods                                                                    * */\n    /* ******************************************************************************************** */\n    \n    /** {Object} appInstance a Reference to the Instance of the Hub Application */\n    Hubs.appInstance = null;\n\n    /**\n     * Changes the Hub Page to using internal mechanisms\n     *            \n     * @public \n     * @this Hubs\n     * @return undefined\n     */\n    Hubs.changePage = function(url, type, title) {\n        if (Hubs.appInstance === null) { return; }\n        \n        // Request Internal Page Change\n        Hubs.appInstance.requestInternalPageChange(url, type, title);\n    };\n    \n\n}(window.jQuery));\n"},function(t,e,n){n(10)(n(369))},function(t,e){t.exports="(function() {\n    'use strict';\n    var $ = (typeof exports !== 'undefined') ? exports : ((typeof window.global === 'object') ? window.global : window);\n\n    // Define Shared Object\n    $.Shared           = $.Shared || {};\n    $.Shared.author    = 'Mobile Dev Team @ Flyp Technologies Inc.';\n    $.Shared.copyright = '(c) 2013 Flyp Technologies Inc., all rights reserved.';\n    $.Shared.root      = $;\n}());\n\n(function($, undefined) {\n    'use strict';\n\n    \n    \n    \n    /**\n     * Shared Carousel\n     * \n     * @class Carousel\n     * @classdesc Shared Application Carousel\n     * @namespace Shared\n     * @return {Object} The Class Instance\n     * @constructor\n     */\n    Shared.Carousel = function(config) {\n\n        /* **************************************************************************************** */\n        /* * Private Members                                                                      * */\n        /* **************************************************************************************** */\n        var initialize, initEvents, resizeEvent, scrollMove, scrollEnd;\n\n\n        /* **************************************************************************************** */\n        /* * Public Properties                                                                    * */\n        /* **************************************************************************************** */\n        /** @member {Object} config An object holding all configuration options */\n        this.config           = $.extend(true, {}, Shared.Carousel.defaultConfig, config);\n        \n        /** @member {Object} $carousel A jQuery Element Handle to the Container DIV of the Carousel  */\n        this.$carousel        = null;\n        \n        /** @member {Object} $carouselInner A jQuery Element Handle to the Inner Container DIV of the Carousel  */\n        this.$carouselInner   = null;\n        \n        /** @member {Object} $carouselItem A jQuery Element Handle to the Carousel Items */\n        this.$carouselItem    = null;\n        \n        /** @member {Object} $carouselParent A jQuery Element Handle to the Parent Container DIV of the Carousel  */\n        this.$carouselParent  = null;\n        \n        /** @member {Object} $carouselNav A jQuery Element Handle to the Controls Container DIV of the Carousel  */\n        this.$carouselNav     = null;\n        \n        /** @member {Object} $carouselNavPrev A jQuery Element Handle to the Move \"Prev\" Control DIV of the Carousel  */\n        this.$carouselNavPrev = null;\n        \n        /** @member {Object} $carouselNavNext A jQuery Element Handle to the Move \"Next\" Control DIV of the Carousel  */\n        this.$carouselNavNext = null;\n        \n        /** @member {Object} $$carouselLoadMore A jQuery Element Handle to the mobile load more button  */\n        this.$carouselLoadMore = null;\n        \n        /** @member {Object} $carouselScroll A jQuery Component for Touch-based Scrolling  */\n        this.$carouselScroll  = null;\n        \n        /** @member {Number} carouselWidth The Outer Width of the Carousel */\n        this.carouselWidth    = 0;\n        \n        /** @member {Number} itemWidth The Outer Width of each Item in the Carousel */\n        this.itemWidth        = 0;\n        \n        /** @member {Number} currentItem The Current Index of the Featured Item that is visible within the Carousel  */\n        this.currentItem      = 1;\n        \n        /** @member {Number} itemCount The number of Featured Items that are within the Carousel  */\n        this.itemCount        = 0;\n        \n        /** @member {Number} slideState The Sliding State of the Carousel  */\n        this.slideState       = 0;\n\n        /** @member {Boolean} containerFade Whether or not the container has a Fade on its edge  */\n        this.containerFade    = false;\n        \n        /** @member {Boolean} isLazyLoading Flag to whether or not a current load is in progress  */\n        this.isLazyLoading    = false;\n        \n        /** @member {Number} movePrevNextStep The Number of Items to Move the Carousel by when clicking Prev/Next buttons */\n        this.movePrevNextStep = 1;\n        \n\n        /* **************************************************************************************** */\n        /* * Private Methods                                                                      * */\n        /* **************************************************************************************** */\n        /**\n         * Initialize the Header\n         *     -\n         *\n         * @private\n         * @this Shared.Carousel\n         * @return undefined\n         * @constructs\n         */\n        initialize = $.proxy(function() {\n            // Add Localization to Logger\n            Shared.Logger.setL10N(this.config.l10n);\n            \n            // Debug Statement\n            Shared.Logger.log('carousel-init');\n            \n            // Ensure Special Events are initialized; we need the debouncedresize event\n            Shared.initSpecialEvents();\n            \n            // Get Handles to Carousel Elements\n            this.$carousel = $(this.config.elements.container);\n            if (!this.$carousel.length) { return; }\n\n            // Get Handles to Carousel Elements\n            this.$carouselInner = this.$carousel.find(this.config.elements.inner);\n            this.$carouselItem = this.$carousel.find(this.config.elements.item);\n            this.$carouselParent = $(this.config.elements.parent.replace('%name%', this.config.name));\n            this.$carouselNav = $(this.config.elements.nav.container); \n            this.$carouselNavPrev = $(this.config.elements.nav.prev.replace('%name%', this.config.name));\n            this.$carouselNavNext = $(this.config.elements.nav.next.replace('%name%', this.config.name));\n            \n            // Prevent Dragging Item Links\n            this.$carouselItem.find('a').prop('draggable', false);\n            \n            // Get Count of Items\n            this.itemCount = this.$carouselItem.length;\n            \n            // Reset Scroll State\n            this.slideState = 0;\n            \n            // Set Starting Item\n            this.currentItem = this.config.start - 1;\n            if (this.currentItem < 0 || this.currentItem >= this.itemCount) {\n                this.currentItem = 0;\n            }\n            \n            // Update Carousel (Element Sizes)\n            this.updateContainer();\n            this.updateHeight();\n            \n            // Create Scroller Control\n            this.$carouselScroll = new iScroll(this.config.id.replace('%name%', this.config.name), {\n                'hScroll'             : true, \n                'vScroll'             : false, \n                'hScrollbar'          : false, \n                'vScrollbar'          : false,\n                'handleClick'         : false,\n                'snap'                : 'div' + this.config.elements.item,\n                'onBeforeScrollStart' : function() { return false; },\n                'onScrollMove'        : scrollMove, \n                'onScrollEnd'         : scrollEnd\n            });\n            this.updateNav();\n            this.updateSteps();\n            \n            // Focus on Start Item\n            if (this.currentItem !== 0) {\n                this.$carouselScroll.scrollToPage(this.currentItem-1, 0, 0);\n            }\n            \n            // Initialize Events\n            initEvents();\n            \n            // Debug Statement\n            Shared.Logger.log('carousel-init-end');\n        }, this);\n        \n        /**\n         * Initialize Events for the Shared Carousel\n         *  \n         * @private \n         * @this Shared.Carousel\n         * @return undefined\n         */\n        initEvents = $.proxy(function() {\n            // Debug Statement\n            Shared.Logger.log('carousel-events-init');\n            \n            // Window Resize/Orientation Events\n            Shared.$('window')\n                .on('debouncedresize' + this.config.eventNamespace, resizeEvent)\n                .on('orientationchange' + this.config.eventNamespace, resizeEvent);\n            \n            // Attach Events to Carousel Controls\n            this.$carouselNavNext.on('click' + this.config.eventNamespace, $.proxy(function(e) {\n                var p = 0;\n                e.preventDefault();\n                if (!$(e.currentTarget).hasClass('disabled')) {\n                    p = this.$carouselScroll.currPageX + this.movePrevNextStep;\n                    if (p > this.$carouselScroll.pagesX.length) { p = this.$carouselScroll.pagesX.length; }\n                    this.$carouselScroll.scrollToPage(p, 0, 400);\n                }\n            }, this));\n            \n            this.$carouselNavPrev.on('click' + this.config.eventNamespace, $.proxy(function(e) {\n                var p = 0;\n                e.preventDefault();\n                if (!$(e.currentTarget).hasClass('disabled')) {\n                    p = this.$carouselScroll.currPageX - this.movePrevNextStep;\n                    if (p < 0) { p = 0; }\n                    this.$carouselScroll.scrollToPage(p, 0, 400);\n                }\n            }, this));\n            \n            // Prevent Clicking on Links in Carousel while Sliding\n            this.$carousel.on('click' + this.config.eventNamespace, 'a', $.proxy(function(e) {\n                if (this.isSliding()) {\n                    e.preventDefault();\n                    return false;\n                }\n                return true;\n            }, this));\n        }, this);\n        \n        /**\n         * Observes and Responds to the Resize Events fired on the Global Window Object\n         * \n         * @private\n         * @this Shared.Carousel\n         * @param {Object} eventData The Event Data associated with the Event \n         * @return {Boolean} The success state of the event; determines whether to allow event-bubbling\n         */\n        resizeEvent = $.proxy(function(eventData) {\n            // Debug Statement\n            Shared.Logger.log('carousel-resize');\n            \n            // Update Carousel\n            window.setTimeout($.proxy(function() {\n                this.currentItem = 0;\n                this.updateContainer();\n                this.updateHeight();\n                this.updateNav();\n                this.$carouselScroll.refresh();\n                this.updateSteps();\n                \n                // Debug Statement\n                Shared.Logger.log('carousel-resize-end');\n            }, this), 100);\n            \n            return true;\n        }, this);\n\n        \n        /**\n         * scrollMove - Observes and Responds to the Scroll-Move Event fired on the iScroll Control\n         * \n         * @private\n         * @this Shared.Carousel\n         * @return undefined\n         */\n        scrollMove = $.proxy(function(e) {\n            // Debug Statement\n            Shared.Logger.log('carousel-scroll-start');\n            $(window).trigger('carousel.sliding');\n\n            // Track Sliding State\n            this.slideState = 1; \n        }, this);\n        \n        /**\n         * scrollEnd - Observes and Responds to the Scroll-End Event fired on the iScroll Control\n         * \n         * @private\n         * @this Shared.Carousel\n         * @return undefined\n         */\n        scrollEnd = $.proxy(function() {\n            // Debug Statement\n            Shared.Logger.log('carousel-scroll-end');\n            $(window).trigger('carousel.stoppedSliding');\n            \n            // Track Sliding State\n            window.setTimeout($.proxy(function() { this.slideState = 0; }, this), 10); \n            \n            // Update Current Item\n            this.currentItem = this.$carouselScroll.currPageX;\n            if (this.currentItem < 0) { this.currentItem = 0; }\n            if (this.currentItem > (this.itemCount - this.visibleItems)) { this.currentItem = (this.itemCount - this.visibleItems); }\n            \n            // Only lazy load if turned on, last request was successful (load limit was met), and near the end\n            if(this.config.lazyLoad.enabled && !this.isLazyLoading && (this.currentItem + this.visibleItems + this.config.lazyLoad.before ) >= this.itemCount) {\n                this.isLazyLoading = true;\n                \n                // Make ajax request for more items and place them in the carousel\n                try {\n                    Shared.ajaxFetch(this.config.lazyLoad.url, {limit: this.config.lazyLoad.limit, page: this.config.lazyLoad.page}, 'GET', false,  $.proxy(function(itemData){\n                        var itemChange = 0, newCount = 0;\n                    \n                        // Append New Items to Carousel\n                        this.$carouselInner.append(itemData);\n                        \n                        // Get Count of Items\n                        this.$carouselItem = this.$carousel.find(this.config.elements.item);\n                        newCount = this.$carouselItem.length;\n                        itemChange = newCount - this.itemCount;\n                        this.itemCount = newCount;\n                        \n                        // Stop lazy loading if there aren't any more items to load\n                        if(itemChange < this.lazyLoadLimit){\n                            this.config.lazyLoad.enabled = false;\n                        }\n                        \n                        // Update New Items and Nav\n                        this.updateContainer();\n                        this.updateNav();\n                        this.$carouselScroll.refresh();\n                        this.updateSteps();\n                        \n                        // Make sure Items are not Draggable\n                        this.$carouselItem.find('a').prop('draggable', false);\n                        \n                        // Fire Event for Items-Updated\n                        this.config.itemsUpdated(this.itemCount, this.config.lazyLoad.limit, this.$carouselItem);\n                        \n                        this.config.lazyLoad.page += 1;\n                        this.isLazyLoading = false;\n                    }, this));\n                } \n                catch(e) {\n                    // Error Statement\n                    if (e instanceof Shared.Exception) {\n                        Shared.Logger.log(e);\n                    } else {\n                        Shared.Logger.log({'msg': 'ajax-failed', 'args': {'reason': e}, 'type': Shared.LVL_ERROR});\n                    }\n                }\n            } else {\n                this.updateNav();\n            }\n        }, this);\n\n\n        /* **************************************************************************************** */\n        /* * Entry Point                                                                          * */\n        /* **************************************************************************************** */\n        initialize();\n    };\n    // End of Shared.Carousel\n\n\n    /* ******************************************************************************************** */\n    /* * Public Methods                                                                           * */\n    /* ******************************************************************************************** */\n    \n    /**\n     * updateContainer - Responsively updates the size of elements based on the size of the viewport\n     * \n     * @public \n     * @this Shared.Carousel\n     * @return undefined\n     */\n    Shared.Carousel.prototype.updateContainer = function() {\n        var parentWidth, itemWidth;\n\n        // Debug Statement\n        Shared.Logger.log('carousel-update');\n        \n        // Get Full Width of Item\n        itemWidth = this.$carouselItem.outerWidth(true);\n        this.$carouselInner.width(itemWidth * this.$carouselItem.length);\n        \n        // Get Ideal Size of Container\n        parentWidth = this.$carouselParent.width();\n        \n        // Update Carousel Width\n        this.$carousel.width(parentWidth);\n        \n        // Update Position of Carousel Nav\n        this.$carouselNav.css({'left': (parentWidth - this.$carouselNav.outerWidth(true))});\n    };\n\n    /**\n     * updateNav - Responsively updates the navigation elements based on the size of the viewport\n     *     - Hides navigation if viewport fits all items\n     * \n     * @public \n     * @this Shared.Carousel\n     * @return undefined\n     */\n    Shared.Carousel.prototype.updateNav = function() {\n        var carouselWidth, innerWidth, maxWidth;\n\n        // re-get the items in case they've been switched out for Reco content\n        // TODO: only do this when it's a reco carousel\n        this.$carouselItem = this.$carousel.find(this.config.elements.item);\n        \n        // Debug Statement\n        Shared.Logger.log('carousel-update-nav');\n        \n        carouselWidth = this.$carousel.width();\n        innerWidth = this.$carouselInner.width();\n        \n        if (innerWidth <= carouselWidth) {\n            this.$carouselNav.css('display', 'none');\n        } else {\n            this.$carouselNav.css('display', '');\n            this.$carouselNav.find('a').removeClass('disabled'); \n\n            if (this.$carouselScroll.x >= -5) {\n                this.$carouselNavPrev.addClass('disabled');\n                if (this.containerFade) {\n                    $(this.config.elements.fade.left).fadeOut('fast', $.proxy(function() { $(this.config.elements.fade.left).addClass('hide'); }, this));\n                    $(this.config.elements.fade.right).removeClass('hide').fadeIn();\n                }\n            }\n                \n            if (this.$carouselScroll.x <= this.$carouselScroll.maxScrollX) {\n                this.$carouselNavNext.addClass('disabled');\n                if (this.containerFade) {\n                    $(this.config.elements.fade.right).fadeOut('fast', $.proxy(function() { $(this.config.elements.fade.right).addClass('hide'); }, this));\n                    $(this.config.elements.fade.left).removeClass('hide').fadeIn();\n                }\n            }\n        }\n    };\n    \n    /**\n     * updateHeight - Updates the Height of the Carousel based on Item Height\n     * \n     * @public\n     * @this Shared.Carousel\n     * @return undefined\n     */\n    Shared.Carousel.prototype.updateHeight = function() {\n        // Fix Height of Carousel\n        window.setTimeout($.proxy(function() {\n            var h = this.$carousel.find(this.config.elements.item).outerHeight(true);\n            if (h !== null && h > 50) {\n                this.$carousel.css({'height': h});\n            }\n        }, this), 0);\n    };\n\n    /**\n     * updateSteps - Updates the Number of Steps to move when clicking the Prev/Next buttons\n     * \n     * @public\n     * @this Shared.Carousel\n     * @return undefined\n     */\n    Shared.Carousel.prototype.updateSteps = function() {\n\n        // re-get the items in case they've been switched out for reco\n        // TODO: only do this when it's a reco carousel\n        this.$carouselItem = this.$carousel.find(this.config.elements.item);\n\n        var carouselWidth = this.$carousel.width(),\n            itemWidth = this.$carouselItem.outerWidth(true);\n        \n        // Calculate Number of Items to Move By\n        this.movePrevNextStep = Math.floor(carouselWidth / itemWidth);\n    };\n\n    \n    /**\n     * isSliding - Checks if the Carousel is currently in a State of Sliding\n     * \n     * @public\n     * @this Shared.Carousel\n     * @return {Boolean} True if the Carousel is currently sliding\n     */\n    Shared.Carousel.prototype.isSliding = function() {\n        return (this.slideState > 0);\n    };\n    \n    /**\n     * Completely destroy the iScroll and free some memory\n     * \n     * @public\n     * @this Shared.Carousel\n     * @return undefined\n     */\n    Shared.Carousel.prototype.destroy = function() {\n        // Debug Statement\n        Shared.Logger.log('carousel-destroy');\n        \n        // Remove Events that are tied to the Window Object\n        Shared.$('window')\n            .off('debouncedresize' + this.config.eventNamespace)\n            .off('orientationchange' + this.config.eventNamespace);\n        \n        // Remove previous events\n        this.$carouselNavNext.off('click' + this.config.eventNamespace);\n        this.$carouselNavPrev.off('click' + this.config.eventNamespace);\n        this.$carousel.off('click' + this.config.eventNamespace);\n        \n        // Destroy iScroll Control\n        this.$carouselScroll.destroy();\n        this.$carouselScroll = null;\n    };\n    \n    \n    /* ******************************************************************************************** */\n    /* * Default Configuration Options                                                            * */\n    /* ******************************************************************************************** */\n    Shared.Carousel.defaultConfig = {\n        'id'            : '%name%-items-carousel',\n        'name'          : '',\n        'start'         : 1,\n        'elements' : {\n            'container' : '.carousel',\n            'item'      : '.tile',\n            'parent'    : '.%name%-container',\n            'inner'     : '.carousel-inner',\n            'nav'       : {'container': '.carousel-nav', 'prev': '#%name%NavPrev', 'next': '#%name%NavNext'},\n            'loadMore'  : '.load-more',\n            'fade'      : {'right': '.featured-container-fade.fade-right', 'left': '.featured-container-fade.fade-left'}\n        },\n        'lazyLoad' : {\n            'enabled' : false,\n            'url'     : '',\n            'limit'   : 10,\n            'page'    : 1,\n            'before'  : 20\n        },\n        'l10n' : {\n            'carousel-init'         : 'Shared:Carousel Initializing',\n            'carousel-init-end'     : 'Shared:Carousel Complete & Ready',\n            'carousel-events-init'  : 'Shared:Carousel Initializing Events',\n            'carousel-update'       : 'Shared:Carousel Updating Container',\n            'carousel-update-items' : 'Shared:Carousel Updating Items',\n            'carousel-update-nav'   : 'Shared:Carousel Updating Navigation',\n            'carousel-scroll-start' : 'Shared:Carousel Scrolling',\n            'carousel-scroll-end'   : 'Shared:Carousel Scrolling Stopped',\n            'carousel-resize'       : 'Shared:Carousel Event - Resize',\n            'carousel-resize-end'   : 'Shared:Carousel Event - Resize-End',\n            'carousel-destroy'      : 'Shared:Carousel Destroying'\n        },\n        'eventNamespace' : '.Shared.Carousel',\n        \n        'itemsUpdated' : function() {\n            return false;\n        }\n    };\n\n}(window.jQuery));\n"},function(t,e,n){n(10)(n(371))},function(t,e){t.exports="(function($, undefined) {\n    'use strict';\n\n    /**\n     * Hubs CTAs\n     *\n     * @class CTAs\n     * @kind JS.Module\n     * @mixin\n     * @classdesc Provides the JS Behaviour for CTAs\n     * @namespace Hubs\n     * @constructor\n     */\n    Hubs.CTAs = function() {};\n\n    // Public Static Variable that is necessary to expose to kill setTimeout of a delayed CTA\n    Hubs.CTAs.repeatDelayCTA = null;\n    Hubs.CTAs.initialDelayCTA = null;\n\n    // Public Static Variable to keep track of whether we removed fullscreen from a flipbook in the CTA block overlay case\n    Hubs.CTAs.fullscreenedFlipbook = false;\n\n    // Container var which contains CTAs that need to have a view event tracked\n    Hubs.CTAs.ctasForViewTracking = [];\n\n    function getCtaBottom($cta) {\n        return $cta.find(Hubs.Config.cta.elements.formBottom + '[data-cta-id=\"' + $cta.attr('data-cta-id') + '\"]');\n    }\n\n    function refreshScrollbar($cta) {\n\n        var $bottom = getCtaBottom($cta);\n\n        if ($bottom.find('form').height() > $bottom.height()) {\n            $bottom.perfectScrollbar({\n                wheelSpeed: 1,\n                useKeyboard: false,\n                wheelPropagation: false,\n                maxScrollbarLength: 215\n            });\n            $bottom.perfectScrollbar('update');\n        } else {\n            $bottom.perfectScrollbar('destroy');\n        }\n    }\n\n    /**\n     * Mark a CTA for view tracking\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.markCtasForViewTracking = function($element) {\n        var $ctaContainers = $(Hubs.Config.cta.elements.container);\n        var $ctaElement;\n        var $el;\n        var ctaId;\n\n        if ($element && $element.is(':visible')) {\n            // Blocking CTAs pass in the parent element and not the actual CTA element\n            // Make sure we grab the ID from the CTA element\n            if ($element.hasClass('cta')) {\n                $ctaElement = $element;\n            } else {\n                $ctaElement = $element.find('.cta');\n            }\n\n            // No ID so we have an invalid element somehow, do nothing\n            if (!$ctaElement.length) { return; }\n\n            ctaId = $ctaElement.attr('id').split('-')[2];\n            if (parseInt(ctaId, 10) > 0 && Hubs.CTAs.ctasForViewTracking.indexOf(ctaId) < 0) {\n                Hubs.CTAs.ctasForViewTracking.push(ctaId);\n            }\n            return;\n        }\n\n        // No specific element passed in, loop through all visible CTAs\n        $.each($ctaContainers, function(index, $cta) {\n            $el = $($cta);\n            ctaId = $el.attr('id').split('-')[2];\n            if (parseInt(ctaId, 10) > 0 && $el.is(':visible') && Hubs.CTAs.ctasForViewTracking.indexOf(ctaId) < 0) {\n                Hubs.CTAs.ctasForViewTracking.push(ctaId);\n            }\n        });\n    };\n\n    Hubs.CTAs.showCta = function($element, isDelayed) {\n        $element.show();\n\n        // Mark any visible CTAs as ones that need a view tracked\n        Hubs.CTAs.markCtasForViewTracking($element);\n\n        // Delayed CTAs will not be part of the original batch of CTAs that were sent if any.\n        // Manually trigger the record function\n        if (isDelayed !== undefined && isDelayed) {\n            Hubs.App.recordCtaViews();\n        }\n    };\n\n    /* ******************************************************************************************** */\n    /* * Public Methods                                                                           * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Initializes Events for CTAs\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.initCTAs = function() {\n        var $doc = Shared.$('document');\n\n        // Activate the cta\n        $doc.on('focus', Hubs.Config.cta.elements.activateForm, $.proxy(this.activateCtaForm, this));\n\n        // Submits the cta form data to the server\n        $doc.on(Hubs.CLICK_EVENT_CTA_SUBMIT, Hubs.Config.cta.elements.submitForm, $.proxy(this.submitCtaForm, this));\n\n        // Moves the cta form back to its original display state\n        $doc.on(Hubs.CLICK_EVENT_CTA_CANCEL, Hubs.Config.cta.elements.hideCancel, $.proxy(this.moveCtaFormDown, this));\n\n        // Moves the cta form back to its original display state\n        $doc.on(Hubs.CLICK_EVENT_CTA_DISMISS, Hubs.Config.cta.elements.noThanks, $.proxy(this.dismiss, this));\n\n    };\n\n\n    /**\n     * Sets up the form cta handling\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.initializeFormCtas = function(){\n        // Add the cta transition class if not mobile\n        $.each($(Hubs.Config.cta.elements.hideCancel), function(e) {\n            var $top = $(this).parent(),\n                ctaID = $top.attr('data-cta-id'),\n                $bottom = $(Hubs.Config.cta.elements.formBottom + '[data-cta-id=\"'+ctaID+'\"]'),\n                $inputs = $bottom.find('input');\n\n            if(!Hubs.isMobile() && !$top.hasClass('cta-transition')){\n                $top.addClass('cta-transition');\n                $bottom.addClass('cta-transition');\n            }\n        });\n\n        // Need to stop propagation of keydown events for forms as perfect scrollbar adds some (space scrolls down)\n        $(Hubs.Config.cta.elements.container + ' input').on('keydown', function(e){\n            e.stopPropagation();\n        });\n\n        var eloquaConnected = Hubs.mapIsConnected('Eloqua');\n\n        if (eloquaConnected) {\n            Hubs.registerEloquaVisitor();\n        }\n    };\n\n\n    /**\n     * When a block CTA is shown on top of a fullscreen Flipbook, unexpand it and record that fact\n     *\n     * @public\n     * @static\n     * @this [self]\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.unexpandForCta = function() {\n        var $flipbook = $(Hubs.Config.containers.flipbookContainer);\n        if (!$flipbook.length) { return; } // ensure we have a flipbook container\n        if (!(Shared.isBrowserFullscreen() || Shared.isPseudoFullscreen()) && !$flipbook.hasClass('initial-expanded')) { return; }\n\n        Hubs.CTAs.fullscreenedFlipbook = true;\n        this.toggleFullscreen(false);\n\n        // Check Timer of Delayed Initial Fullscreen (from app.js)\n        if (this.initialFullscreenTimer) {\n            window.clearTimeout(this.initialFullscreenTimer);\n        }\n    };\n\n    /**\n     * When a block CTA is dismissed and the Flipbook was previously fullscreen, expand it again\n     *\n     * @public\n     * @static\n     * @this [self]\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.expandAfterCta = function() {\n        var $flipbook = $(Hubs.Config.containers.flipbookContainer);\n        if (!$flipbook.length || !Hubs.CTAs.fullscreenedFlipbook) { return; } // ensure we have a flipbook container\n\n        Hubs.CTAs.fullscreenedFlipbook = false;\n        this.toggleFullscreen(true, true);\n    };\n\n    /**\n    * Dismisses a blocking cta by hiding it\n    *\n    * @public\n    * @this Hubs.CTAs\n    * @return undefined\n    */\n    Hubs.CTAs.prototype.dismiss = function(e) {\n        var $el = $(e.currentTarget);\n        var $blockCta = $(Hubs.Config.cta.elements.blockCta);\n        var $blockingCta = $(Hubs.Config.cta.elements.blockingCta);\n        var repeatDelay = parseInt($el.attr('data-repeat-delay')) * 1000;\n        var placementID = $el.attr('data-placement-id');\n        var delayTill = new Date();\n\n        // Remove Blocking CTA\n        $blockingCta.removeClass('blocking-cta');\n        $blockCta.hide().find(Hubs.Config.cta.elements.hideCancel).click();\n\n        // If there is a hidden embed, make sure it is visible\n        $(Hubs.Config.cta.elements.hiddenEmbed).removeClass('hide-embed');\n\n        // Restore Expanded Flipbook State\n        this.expandAfterCta();\n\n        // Check for Repeat Blocking CTA\n        if (repeatDelay > 0) {\n            Hubs.CTAs.repeatDelayCTA = Hubs.root.setTimeout($.proxy(function() {\n                var $repeatBlockCta = $(Hubs.Config.cta.elements.blockCta);\n\n                if ($repeatBlockCta.length) {\n                    // Display Repeated Blocking CTA\n                    $(Hubs.Config.cta.elements.possibleBlock).addClass('blocking-cta');\n                    $(Hubs.Config.cta.elements.possibleHiddenEmbed).addClass('hide-embed');\n                    $repeatBlockCta.show();\n\n                    // Remove Expanded Flipbook State\n                    this.unexpandForCta();\n\n                    // Reposition CTA\n                    this.repositionBlockingCTA($repeatBlockCta);\n                }\n            }, this), repeatDelay);\n        }\n\n        // If repeat delay is less than 0, that means the placement is suppose to be hidden for a set time (session)\n        else if (repeatDelay < 0){\n            delayTill = delayTill.setDate(delayTill.getDate() + Hubs.Config.cta.hidePlacementNumDays);\n            this.storePlacement({placementID: placementID, hideUntil: delayTill});\n        }\n\n        this.embeddedScrollData.cta_b.f = false;\n        //this.embeddedScrollData.cta_s.f = false;\n        return false;\n    };\n\n    /**\n     * Moves the cta form down back to its original state (Requires *this to point to the cancel anchor)\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.moveCtaFormDown = function(e) {\n        var $el = $(e.currentTarget);\n        var $top = $el.parent();\n        var ctaID = $top.attr('data-cta-id');\n        var $container = $el.closest(Hubs.Config.cta.elements.container + '[data-cta-id=\"'+ctaID+'\"]');\n        var $originalContainer = $(Hubs.Config.cta.elements.container + '[data-cta-id=\"'+ctaID+'\"]');\n        var $bottom = $($container.find(Hubs.Config.cta.elements.formBottom + '[data-cta-id=\"'+ctaID+'\"]')[0]);\n        var $fields = $container.find(Hubs.Config.cta.elements.formField);\n        var $blockingCTA = $('.block-cta');\n\n        if (Hubs.isMobile()) {\n            // Remove Overlay-CTA\n            $('#mobile-cta-overlay').remove();\n            $originalContainer.show().removeClass(\"setValues\");\n\n            // link between cta container and mobile overlay (this way we know which cta belongs to the overlay)\n            $originalContainer.removeClass('active-mobile-overlay');\n\n            Shared.$('body').removeClass('noscroll');\n\n            var hiddenEmbed = ($(Hubs.Config.cta.elements.possibleHiddenEmbed).length);\n\n            if ($blockingCTA.length && hiddenEmbed === false) {\n                this.repositionBlockingCTA($blockingCTA);\n            }\n\n            // Need to un-attach the good cta submit event and re-attach the fake one until the form is in full view as per comment in initCTAs\n            Shared.$('document').off(Hubs.CLICK_EVENT_CTA_SUBMIT);\n            Shared.$('document').on(Hubs.CLICK_EVENT_CTA_SUBMIT, Hubs.Config.cta.elements.submitForm, function(){return false;});\n\n            if (Hubs.isEmbedded() && 'parentIFrame' in window) {\n                window.parentIFrame.scroll('top');\n                Shared.$('window').trigger('scroll');\n            }\n        }\n\n        $container.removeClass('setValues');\n        $bottom.removeClass('fields-revealed');\n        $bottom.find('.cta-field-section').removeClass('smaller');\n        $bottom.scrollTop(0);\n        $bottom.perfectScrollbar('destroy');\n\n        $.each($fields, function(e) {\n            $(this).removeAttr('style').removeClass('error');\n        });\n\n        // Show activation button\n        if (Hubs.isMobile()) {\n            $originalContainer.find('.cta-button-container').show();\n        } else {\n            $container.find('.cta-button-container').show();\n        }\n    };\n\n    /**\n     * Moves the cta form up to display other fields and submit (Requires *this to point to a form field)\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.moveCtaFormUp = function($el) {\n        // Current CTA Container Element\n        var id = $el.attr('data-cta-id');\n\n        // CTA Elements\n        var $container = $el.closest(Hubs.Config.cta.elements.container + '[data-cta-id=\"'+id+'\"]');\n        var $fields = null;\n        var $top = null;\n        var $cancelAnchor = null;\n        var $bottom = null;\n        var $mobileCtaOverlay = null;\n\n        // Positioning Vars\n        var topUp = 0;\n        var bottomUp = 0;\n\n        // Hide activation button\n        $el.closest('.cta-button-container').hide();\n\n        // Try and set the known values on the first form up - should only happen once\n        if (!$container.hasClass('setValues')) {\n            $fields = $container.find(Hubs.Config.cta.elements.formField);\n            $.each($fields, function(){\n                var $el = $(this);\n                var value = $el.attr('data-value');\n\n                if (value && value != 'UberflipSelect') {\n                    if ($el.attr('type') == 'checkbox') {\n                        $el.attr('checked', /true|1/i.test(value));\n                    } else {\n                        $el.val(value);\n                    }\n                }\n            });\n\n            $container.addClass('setValues');\n        }\n\n        if (!$('#mobile-cta-overlay').length) {\n            if (Hubs.isMobile()) {\n                // Remove the touch move event as no longer needed\n                $el.off(Hubs.TOUCH_MOVE_EVENT_CTA_FIELD);\n                                // Build Overlay-CTA\n                $mobileCtaOverlay = $('<div/>')\n                    .attr('id', 'mobile-cta-overlay')\n                    .addClass('cta full-screen-cta setValues')\n                    .appendTo(Shared.$('body'));\n\n                // Copy Contents from Original CTA\n                $container.children().clone().appendTo($mobileCtaOverlay);\n\n                // this is required to get the correct CTA Element because the same cta-id can appear multiple times on the page\n                // link between cta container and mobile overlay (this way we know which cta belongs to the overlay)\n                // before add the class - let's remove all classes from ctas (could be multiple of the same cta on the page)\n                // we can't remove it after cta submit due to delay in ufa collector\n                $('[data-cta-id=' + id + ']').removeClass('active-mobile-overlay');\n                $container.addClass('active-mobile-overlay');\n\n                // Clone the select values if not uberflipselect (non chosen value)\n                $container.find('select').each(function(i) {\n                    var $select = $(this);\n                    if ($select.val() != 'UberflipSelect') {\n                        $mobileCtaOverlay.find('select').eq(i).val($select.val());\n                    }\n                });\n\n                // Update Style of Overlay-CTA\n                $mobileCtaOverlay\n                    .css('background-color', $container.css('background-color'))\n                    .attr('data-cta-id', $container.attr('data-cta-id'))\n                    .attr('data-list-id', $container.attr('data-list-id'))\n                    .attr('data-integration', $container.attr('data-integration'));\n\n                // Update Header of CTA\n                $top = $mobileCtaOverlay.find(Hubs.Config.cta.elements.formTop);\n                $top.css({'background-color': $container.css('background-color'), 'height': '50px'});\n                $top.find('p').remove();\n\n                // Update Scroll Position to Center CTA on Page\n                if (Hubs.isEmbedded()) {\n                    $mobileCtaOverlay.find(Hubs.Config.cta.elements.hideCancel).css('display', 'block');\n                    if ('parentIFrame' in window) {\n                        window.parentIFrame.scroll('top');\n                    }\n                } else {\n                    $mobileCtaOverlay.find(Hubs.Config.cta.elements.hideCancel).fadeIn('fast');\n                }\n\n                // Fix Positioning for iOS Devices\n                if (Shared.IOS || Shared.IOS7 || Shared.IOS8) {\n                    Shared.scrollTop(0);\n                    Shared.$('body').addClass('noscroll');\n                }\n\n                // Focus on First Form Input\n                $bottom = $mobileCtaOverlay.find(Hubs.Config.cta.elements.formBottom);\n                Shared.onNextEventLoop(function() {\n                    $bottom.find(':not(.hide) > input').eq(0).trigger('focus');\n                }, this, 0);\n\n                // For mobile, setting a delay of 1 second before the submit form event is attached to avoid double clicking\n                // on the first field and then the submit button (this was common for ios 7 chrome)\n                Hubs.root.setTimeout($.proxy(function() {\n                    Shared.$('document').off(Hubs.CLICK_EVENT_CTA_SUBMIT, Hubs.Config.cta.elements.submitForm);\n                    Shared.$('document').on(Hubs.CLICK_EVENT_CTA_SUBMIT, Hubs.Config.cta.elements.submitForm, $.proxy(this.submitCtaForm, this));\n                }, this), 1000);\n\n            } else {\n                $bottom = getCtaBottom($container);\n                $bottom.addClass('fields-revealed');\n\n                if ($bottom.find('.cta-field-section:not(.hide)').length == 4) {\n                    $bottom.find('.cta-field-section:not(.hide)').addClass('smaller');\n                }\n\n                refreshScrollbar($container);\n\n            }\n\n            var $firstFieldContainer = $container.find('.form-fields .cta-field-section:not(.hide):first');\n            if ($firstFieldContainer.length) {\n                // move focus to the first field\n                $firstFieldContainer.find('input').trigger('focus');\n\n                // Update activation field label\n                var fieldName = $firstFieldContainer.find('.cta-field-name:not(.label-only-text)').text();\n                if (fieldName) {\n                    $container.find('.cta-activate-button-container .cta-field-name').text(Shared.jhe(fieldName));\n                }\n            }\n        }\n\n        return true; // !Hubs.isMobile();\n    };\n\n\n    function getCtasObject($el) {\n        var ctaID = $el.attr('data-cta-id');\n        var $current = $el.closest(Hubs.Config.cta.elements.container + '[data-cta-id=\"' + ctaID + '\"]');\n        var $all = $(Hubs.Config.cta.elements.container + '[data-cta-id=\"' + ctaID + '\"]');\n        var $successLink        = $all.find(Hubs.Config.cta.elements.formSuccess).find('a');\n        return {\n            ctaID: ctaID,\n            isBlocking: $(Hubs.Config.cta.elements.blockCta + ' ' + Hubs.Config.cta.elements.container).attr('data-cta-id') === ctaID,\n            hidesHiddenEmbed: $(Hubs.Config.cta.elements.hiddenEmbed).length,\n            hasMoreFields: $el.hasClass('more-fields'),\n            current: {\n                container: $current,\n                top: $current.find(Hubs.Config.cta.elements.formTop),\n                bottom: $current.find(Hubs.Config.cta.elements.formBottom),\n                error: $current.find(Hubs.Config.cta.elements.formError),\n                success: $current.find(Hubs.Config.cta.elements.formSuccess),\n                fields: $current.find(Hubs.Config.cta.elements.formField),\n                loading: $current.find(Hubs.Config.cta.elements.submitting),\n                sprites: $current.find(Hubs.Config.cta.elements.sprite),\n                eloquaGUID: $current.find('.hide.GUID input'),\n                integration: $current.attr(\"data-integration\").toLowerCase(),\n                isFullscreen: $current.hasClass('full-screen-cta'),\n                optIn: $current.find(Hubs.Config.cta.elements.optIn),\n                optInRequired: $current.find(Hubs.Config.cta.elements.optInRequired)\n            },\n            all: {\n                container: $all,\n                top: $all.find(Hubs.Config.cta.elements.formTop),\n                bottom: $all.find(Hubs.Config.cta.elements.formBottom),\n                error: $all.find(Hubs.Config.cta.elements.formError),\n                success: $all.find(Hubs.Config.cta.elements.formSuccess)\n            },\n            hasSuccessLink: $successLink.length,\n            successUrl: $successLink.length ? $successLink.attr('href') : '',\n            listID: $current.attr('data-list-id'),\n            currentPos: $current.attr('data-saved-pos')\n        };\n    }\n\n    function getCtaFieldValue($element, integration) {\n        var checked = 1;\n        var notChecked = 0;\n\n        if (integration === 'hubspot') {\n            checked = 'true';\n            notChecked = 'false';\n        }\n\n        if ($element.attr('type') === 'checkbox') {\n            return $element.is(':checked') ? checked : notChecked;\n        }\n\n        var fieldValue = $element.val();\n        if (typeof fieldValue === 'string') {\n            return fieldValue.trim();\n        }\n\n        return fieldValue;\n    }\n\n    /**\n     * Submits a cta form (Requires *this to point to the cta form submit btn)\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.submitCtaForm = function(e) {\n        var $el                 = $(e.currentTarget);\n        var ctaID               = $el.attr('data-cta-id');\n        var $all                = $(Hubs.Config.cta.elements.container + '[data-cta-id=\"'+ctaID+'\"]');\n        var ctaName             = $all.attr('data-cta-name');\n        var integrationService  = $all.attr('data-integration');\n        var queryString         = $.extend({}, this.queryString);\n        var ctas                = getCtasObject($el);\n        var $firstError         = false;\n        var valid               = true;\n        var pageViews           = {};\n        var extraParams         = [];\n        var formFieldData       = [];\n        var scrollTo            = 0;\n        var errorSpriteClass    = 'cta-sprite-small-exclaim';\n        var errorClass          = 'error';\n        var email               = false;\n        var knownUser           = false;\n        var mappedData          = {};\n\n        // Remove all the errors, then re-evaluate whether or not there is any errors\n        ctas.current.sprites.removeClass(errorSpriteClass);\n        $.each(ctas.current.fields, function(){\n            var $el                 = $(this),\n                val                 = getCtaFieldValue($el, ctas.current.integration),\n                formFieldId         = $el.attr('data-field-id'),\n                formValidation      = $el.attr('data-regex'),\n                $required           = ($el.attr('data-required') == '1'),\n                $errorSprite        = ctas.current.container.find(Hubs.Config.cta.elements.sprite + '[data-field-id=\"'+formFieldId+'\"]'),\n                fieldName           = ctas.current.container.find(Hubs.Config.cta.elements.fieldName + '[data-field-id=\"'+formFieldId+'\"]').html(),\n                re                  = new RegExp(formValidation, 'i');\n\n            var fieldValid;\n            if ($required && val === '') {\n                fieldValid = false;\n            } else {\n                fieldValid = ( (re.test(val) || val === 'UberflipFlip') && val !== 'Error with ' + fieldName ) || !$required;\n            }\n\n            // If a param in the query string is mapped to the field and the value tells us to change it, do so\n            // If the query string is empty but the value exists in local storage use that value\n            var ctaFieldUseQueryParamValues = $el.attr('data-allow-query-string');\n            if ($el.attr('type') === 'hidden' && ctaFieldUseQueryParamValues) {\n                var ctaFieldQueryParamName = $el.attr('data-query-string-param-name');\n                var currentQueryParamValue = queryString[ctaFieldQueryParamName];\n                if (currentQueryParamValue) {\n                    val = currentQueryParamValue;\n                } else {\n                    var storedCtaQueryParams = localStorage.getItem(Hubs.CTA_LOCALSTORAGE_KEY);\n                    var storedValues = storedCtaQueryParams ? JSON.parse(storedCtaQueryParams) : {};\n                    if (storedValues[ctaFieldQueryParamName]) {\n                        val = storedValues[ctaFieldQueryParamName];\n                    }\n                }\n            }\n\n            var isTypeOfHidden = $el.attr('type') === 'hidden';\n            var isVisible = $el.is(\":visible\");\n\n            var isEmptyHiddenField = isTypeOfHidden && val === '';\n            var isInvisibleInputField = !isTypeOfHidden && !isVisible;\n\n            // We should always submit the email field so that the submission data can be tied to a contact\n            var isEmail = $el.parent().hasClass('email-field');\n\n            var ignoreThisField = !isEmail && (isEmptyHiddenField || isInvisibleInputField);\n\n            if (ignoreThisField) {\n                return;\n            }\n\n            mappedData[$el.attr('data-mapping')] = val;\n\n            // If valid is currently false or tests as false, make sure stays as false\n            formFieldData.push({id: formFieldId, value: val});\n\n            if ($el.closest('.email-field').length) {\n                email = $el.val();\n            }\n\n            // If not valid, grab the first error, and set error classes\n            if(!fieldValid && $el.is(\":visible\")){\n                valid = false;\n                $firstError = !$firstError ? $el.parent() : $firstError;\n                $el.addClass(errorClass).on(Hubs.FOCUS_EVENT, function(){\n                    $errorSprite.removeClass(errorSpriteClass);\n                    $el.removeClass(errorClass).off(Hubs.CLICK_EVENT);\n                });\n                $errorSprite.addClass(errorSpriteClass);\n            }\n        });\n\n        // Opt in field has been enabled, must be checked to continue\n        if(ctas.current.optIn.length && !ctas.current.optIn.is(':checked')){\n            ctas.current.optInRequired.addClass('show-required-text');\n            ctas.current.optIn.on(Hubs.CLICK_EVENT, function(){\n                ctas.current.optInRequired.removeClass('show-required-text');\n            });\n            $firstError = !$firstError ? ctas.current.optIn.parent() : $firstError;\n            valid = false;\n        }\n\n        // If not valid, scroll to the error and exit\n        if(!valid){\n            if(ctas.current.bottom.find('form').height() > ctas.current.bottom.height()){\n                // Scroll to is relative to the container the errors are in (that container is scrollable)\n                scrollTo = $firstError.offset().top - ctas.current.bottom.offset().top + ctas.current.bottom.scrollTop();\n                ctas.current.bottom.scrollTop(scrollTo).perfectScrollbar('update');\n            } else if (ctas.current.container.hasClass('full-screen-cta')){\n                // Scroll to is page relative in this case\n                scrollTo = $firstError.offset().top;\n                Shared.scrollTop(scrollTo);\n            }\n\n            return false;\n        }\n\n        // Update page views\n        var itemViews = localStorage.getItem(integrationService);\n        if (itemViews) {\n            try {\n                itemViews = JSON.parse(itemViews);\n                if (itemViews && _.isArray(itemViews.items)) {\n                    pageViews = itemViews.items;\n                }\n            } catch (parseError) {\n                // Reset storage\n                localStorage.setItem(integrationService, JSON.stringify({'items':[]}));\n            }\n        }\n\n        var recoItemId;\n        var recoCollectionId;\n        var recotrk;\n        var recoCookie = Shared.getCookie('uf_last_reco');\n\n        if (Hubs.appInstance.pageType === Hubs.PAGE_TYPE_CTA && queryString.recotrk && queryString.itm && queryString.col) {\n            // Check if we're running the app as embedded CTA only, and if we're\n            // passing recommended recotrk/Item/Stream IDs to accredit for the CTA submission\n            recotrk = queryString.recotrk;\n            recoItemId = queryString.itm;\n            recoCollectionId = queryString.col;\n        } else if (recoCookie) {\n            // Accredit the CTA submission to the latest recommended Item\n            var recoCookieObj = JSON.parse(recoCookie);\n            recotrk = recoCookieObj.recotrk;\n            recoItemId = recoCookieObj.item_id;\n            recoCollectionId = recoCookieObj.collection_id;\n        }\n\n        var conversionItemId = Hubs.appInstance.currentItemId;\n        var conversionCollectionId = Hubs.appInstance.currentCollectionId;\n\n        if (conversionItemId) {\n            extraParams.push({\n                id: 'uf_conversion_item_id',\n                value: conversionItemId\n            });\n        }\n\n        // Send the query parameters stored from app initialization with cta\n        $.each(queryString, function(idx, val){\n            extraParams.push({id: decodeURIComponent(idx), value: decodeURIComponent(val)});\n        });\n\n        this.setSubmitSuccessState(ctas);\n\n        Shared.$('body').removeClass('noscroll');\n        $.each(Hubs.Config.knownUser, function(idx, val){\n            if (val) {\n                knownUser = true;\n            }\n        });\n\n        // Need to use standard jQuery ajax call as we're cancelling ajaxFetch call when swapping pages\n        $.ajax({\n            url: Shared.absoluteHubUrl(Hubs.Config.serverUrl.ctaSubmit),\n            type: 'POST',\n            data: {\n                'cta': ctas.ctaID,\n                'col': conversionCollectionId,\n                'itm': conversionItemId,\n                'prevCol' : Hubs.appInstance.hubState.previousState.get('collectionId'),\n                'prevItm' : Hubs.appInstance.hubState.previousState.get('itemId'),\n                'extraParams': extraParams,\n                'formData': formFieldData,\n                'pageViews': JSON.stringify(pageViews),\n                'recotrk' : recotrk,\n                'recoItemId': recoItemId,\n                'recoCollectionId': recoCollectionId,\n           },\n           success: $.proxy(function(data){\n               ctas.current.loading.addClass('hidden');\n\n               // After this we might know who the user is\n               Hubs.Config.knownUser = data.response.knownUser;\n               Object.seal(Hubs.Config.knownUser);\n\n               // Reset page views\n               localStorage.setItem(integrationService,  JSON.stringify({\"items\":[]}));\n\n               // Track event\n               if (typeof data.response.event != 'undefined') {\n                   Shared.Tracker.trackEvent(data.response.event.category, data.response.event.action, data.response.event.label);\n               }\n\n               // BrightInfo Integration tracking details\n               // Format is:\n               //  _BI.sendRegistrationDetails(url, name, firstName, lastName, email, company)\n               // Where url and email are manditory and rest are not\n               // We don't have the rest of the data all the time and can't tell what is name fields\n               // since the field names change so email + url will do\n               if (Hubs.root._BI !== undefined && email) {\n                   Hubs.root._BI.sendRegistrationDetails(location.href, null, null, null, email, knownUser);\n               }\n\n               // External Callback - Call Event Handler passing CTA ID, data, name and Selector\n               if (typeof Hubs.onCtaFormSubmitSuccess === 'function') {\n                   Hubs.onCtaFormSubmitSuccess.apply(this, [ctaID, mappedData, ctaName]);\n               }\n\n               // emit hub event\n               Hubs.Events.trigger('ctaFormSubmitSuccess', [ctaID, mappedData, ctaName, ctas.current.container]);\n\n               this.embeddedScrollData.cta_b.f = false;\n           }, this),\n           error: $.proxy(function (xhr){\n               ctas.current.loading.addClass('hidden');\n\n               // Remove user from list if there was an error\n               this.reverseStoreCta(ctas.listID);\n\n           }, this)\n        });\n\n        // Return false to not follow a link\n        return false;\n    };\n\n    function toggleFieldDisplay(self, conditions, $formFieldsWrapper, $actionField) {\n        var showField = self.verifyFieldsConditions(conditions, $formFieldsWrapper);\n        if(showField) {\n            $actionField.parent(\".cta-field-section\").removeClass(\"hide\");\n        } else {\n            $actionField.parent(\".cta-field-section\").addClass(\"hide\");\n            $actionField.val('');\n        }\n    }\n\n    Hubs.CTAs.prototype.processFormFieldConditions = function ($formFieldsWrapper, data) {\n        var self = this;\n        if ($formFieldsWrapper.find('[data-conditional=\"1\"]').length > 0) {\n\n            $formFieldsWrapper.find('[data-conditional=\"1\"]').each(function() {\n                var $actionField = $(this);\n                var actionFieldId = $actionField.data(\"field-id\");\n\n                if (data.response.fieldConditionsObj) {\n                    var fieldConditions = _.find(data.response.fieldConditionsObj, {'field_id': actionFieldId});\n\n                    var conditionLength = fieldConditions.condition_data.length;\n                    var conditions = fieldConditions.condition_data;\n\n                    for (var i = 0; i < parseInt(conditionLength); i++) {\n                        var conditionalFieldId = conditions[i].conditional_field_id;\n                        var $conditionalField = $formFieldsWrapper.find('.preview-form-field[data-field-id=\"'+conditionalFieldId+'\"]');\n\n                        toggleFieldDisplay(self, conditions, $formFieldsWrapper, $actionField);\n                        refreshScrollbar($actionField.parents('.cta'));\n                        $conditionalField.on(\"change\", function() {\n                            toggleFieldDisplay(self, conditions, $formFieldsWrapper, $actionField);\n                            refreshScrollbar($actionField.parents('.cta'));\n                        });\n                    }\n                }\n            });\n        }\n    };\n\n    Hubs.CTAs.prototype.getFormFieldConditions = function ($obj) {\n        var ctaId = $obj.data('ctaId');\n        var $formFieldsWrapper = $obj.closest('form').find('.form-fields');\n        $.ajax({\n            url: Shared.absoluteHubUrl(Hubs.Config.serverUrl.getFormFieldConditions),\n            type: 'POST',\n            data: {'cta': ctaId},\n            success: $.proxy(function(data){\n                if (Hubs.isMobile()) {\n                    $formFieldsWrapper = $('#mobile-cta-overlay .form-fields');\n                }\n                // get all conditional fields\n                this.processFormFieldConditions($formFieldsWrapper, data);\n            }, this)\n        });\n    };\n\n    /**\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.activateCtaForm = function(e) {\n        var $obj = $(e.currentTarget);\n        var ctaId = $obj.data('ctaId');\n        var itemId = Hubs.appInstance.currentItemId;\n\n        if (!ctaId) {\n            // We want to warn devs (inc onbrand) if they are accidentally triggering a cta-activate on a non cta,\n            // or if their custom code has broken regular CTA behaviour.\n            console.warn('Element ' + e.currentTarget + ' has no data-cta-id, cannot activate.', e.currentTarget);\n\n            // try to find and clean-up CTA:\n            $obj.parents('.cta.item').hide();\n            $(Hubs.Config.cta.elements.hiddenEmbed).removeClass('hide-embed');\n            $(Hubs.Config.cta.elements.blockingCta).removeClass('blocking-cta');\n            return;\n        }\n\n        Hubs.Events.trigger('ctaActivateUfaCollector', [ctaId, $obj.parents('.cta-form')]);\n\n        var $formFieldsWrapper = $obj.closest('form').find('.form-fields');\n        var isUserTrackingMaService = !$formFieldsWrapper.data('formIsActive');\n\n        /*\n         * (boolean) isUserTrackingMaService:\n         *\n         *  - for MA Services that use tracking, will make an API Request to update Form CTA\n         *    fields (so that the fields are populated with user-filled data, eg. Progressive\n         *    Profiling, known/tracked user, etc),\n         *\n         *  - Services that do not require field values to be updated: MailChimp, Custom Forms.\n         */\n        if (isUserTrackingMaService) {\n            $.ajax({\n                url: Shared.absoluteHubUrl(Hubs.Config.serverUrl.ctaActivate),\n                type: 'POST',\n                data: {\n                    'cta': ctaId,\n                    'itemId': itemId,\n                }\n            }).done($.proxy(function(data) {\n                if (data.response && data.response.data) {\n                    $formFieldsWrapper.html(data.response.data);\n                    // If no fields are showing (due to progressive profiling), show just the email\n                    if ($formFieldsWrapper.find('.cta-field-section:not(.hide):not(.opt-in-section)').length === 0){\n                        $formFieldsWrapper.find('.cta-field-section.email-field').removeClass('hide');\n                    }\n                    this.moveCtaFormUp($obj);\n\n                    if (Hubs.isMobile()) {\n                        $formFieldsWrapper = $('#mobile-cta-overlay .form-fields');\n                    }\n\n                    this.processFormFieldConditions($formFieldsWrapper, data);\n\n                    // External Callback - Call Event Handler passing CTA ID\n                    if (typeof Hubs.onCtaActivate === 'function') {\n                        Hubs.onCtaActivate.apply(this, [ctaId]);\n                    }\n\n                    // Emit ctaActivate hub event\n                    Hubs.Events.trigger('ctaActivate', [ctaId, $obj.parents('.cta-form')]);\n                }\n\n                // Update MAP users\n                if (data.response && data.response.knownUser) {\n                    Hubs.Config.knownUser = data.response.knownUser;\n                    Object.seal(Hubs.Config.knownUser);\n                }\n            }, this))\n            .fail($.proxy(function() {\n                // The request failed, but we want to remove any block CTAs, etc.\n                var ctas = getCtasObject($obj);\n\n                if (ctas.current.isFullscreen) {\n                    ctas.current.container.remove();\n                    Shared.scrollTop(ctas.currentPos);\n\n                    // Allow Scrolling on Body\n                    Hubs.restoreBodyScroll();\n                }\n\n                // If was a blocking cta, remove the blocking class and hide it\n                if (ctas.isBlocking) {\n                    $(Hubs.Config.cta.elements.blockingCta).removeClass('blocking-cta');\n                    $(Hubs.Config.cta.elements.blockCta).hide();\n\n                    // if this CTA was blocking on top of a fullscreen flipbook, restore the fullscreen status after dismissed\n                    this.expandAfterCta();\n                }\n\n                // If there is a hidden embed (IE: Flipbook), make sure it becomes visible\n                if (ctas.hidesHiddenEmbed) {\n                    $(Hubs.Config.cta.elements.hiddenEmbed).removeClass('hide-embed');\n                }\n\n                // Everything is cleaned up, get rid of the broken CTA\n                ctas.current.container.hide();\n            }, this));\n        } else {\n            this.getFormFieldConditions($obj);\n            this.moveCtaFormUp($obj);\n        }\n    };\n\n    /**\n     * Sets the success state on the client side for a successful cta submission\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.setSubmitSuccessState = function(ctas){\n        if(ctas.current.isFullscreen){\n            ctas.current.container.remove();\n            Shared.scrollTop(ctas.currentPos);\n\n            // Allow Scrolling on Body\n            Hubs.restoreBodyScroll();\n        }\n\n        // Show the success screen\n        ctas.all.container.css('background-color', ctas.all.success.css('background-color'));\n        ctas.all.top.css('display', 'none');\n        ctas.all.bottom.css('display', 'none');\n        ctas.all.success.css('display', 'block');\n\n        // If was a blocking cta, remove the blocking class and hide it\n        if(ctas.isBlocking){\n            $(Hubs.Config.cta.elements.blockingCta).removeClass('blocking-cta');\n            $(Hubs.Config.cta.elements.blockCta).hide();\n\n            // if this CTA was blocking on top of a fullscreen flipbook, restore the fullscreen status after dismissed\n            this.expandAfterCta();\n        }\n\n        // If there is a hidden embed, make sure it is visible\n        if (ctas.hidesHiddenEmbed) {\n            $(Hubs.Config.cta.elements.hiddenEmbed).removeClass('hide-embed');\n        }\n\n        // If there are not more fields, then store the cta so we won't see it again (based on listID)\n        if (!ctas.hasMoreFields) {\n            this.storeCta({listID: ctas.listID, ctaID: ctas.ctaID});\n        }\n\n        return true;\n    };\n\n    /**\n     * Adds a cta to local storage\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.storeCta = function(props) {\n        var storageString = Hubs.Config.cta.storage + Hubs.Config.hubId,\n            storageValue,\n            storeCta = {'listID': props.listID, 'ctaID': props.ctaID};\n\n        storageValue = localStorage.getItem(storageString);\n\n        // Set up the object\n        if(storageValue === null){\n            storageValue = {'cta': [], 'placement': []};\n        } else {\n            storageValue = JSON.parse(storageValue);\n        }\n\n        storageValue.cta.push(storeCta);\n        localStorage.setItem(storageString, JSON.stringify(storageValue));\n    };\n\n    /**\n     * Removes a cta from local storage\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.reverseStoreCta = function(listID) {\n        var storageString = Hubs.Config.cta.storage + Hubs.Config.hubId,\n            storageValue,\n            found = false;\n\n        storageValue = localStorage.getItem(storageString);\n\n        // Set up the object\n        if(storageValue === null){\n            return found;\n        }\n\n        storageValue = JSON.parse(storageValue);\n\n        $.each(storageValue.cta, function(idx, val){\n            if(val.listID == listID){\n                storageValue.cta.splice(idx, 1);\n                found = true;\n                return false;\n            }\n        });\n\n        localStorage.setItem(storageString, JSON.stringify(storageValue));\n\n        return found;\n    };\n\n    /**\n     * Adds a placement to local storage for hiding purposes\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n\n    Hubs.CTAs.prototype.storePlacement = function(props) {\n        var storageString = Hubs.Config.cta.storage + Hubs.Config.hubId,\n            storageValue,\n            storeCta = {'placementID': props.placementID, 'hideUntil': props.hideUntil};\n\n        storageValue = localStorage.getItem(storageString);\n\n        // Set up the object\n        if(storageValue === null){\n            storageValue = {'cta': [], 'placement': []};\n        } else {\n            storageValue = JSON.parse(storageValue);\n\n            // Placements were added after, create the object property if necessary\n            if(!storageValue.placement){\n                storageValue.placement = [];\n            }\n        }\n\n        storageValue.placement.push(storeCta);\n        localStorage.setItem(storageString, JSON.stringify(storageValue));\n    };\n\n    /**\n     * Shows non submitted form ctas\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.showFormCtas = function(lazyLoader, pageType) {\n        var self = this,\n            $container = $(Hubs.Config.cta.elements.container),\n            storageString = Hubs.Config.cta.storage + Hubs.Config.hubId,\n            storageValue = localStorage.getItem(storageString),\n            besideExists = false,\n            hideListIds = [],\n            hideCtaIds = [],\n            hidePlacementIds = [],\n            initialDelay = 0,\n            parsedValue = JSON.parse(storageValue),\n            backUpValue = {cta: [], placement: []},\n            resetValue = false,\n            hiddenBlockingCta = 0;\n\n        if (storageValue === null) {\n            // Make sure there are some fields showing\n            $.each($container, function(){\n                var $el = $(this);\n\n                if($el.parent().hasClass('block-cta')){\n                    if($(Hubs.Config.cta.elements.blockCta + ' ' + Hubs.Config.cta.elements.container).attr('data-init-delay')){\n                        initialDelay = parseInt($(Hubs.Config.cta.elements.blockCta + ' ' + Hubs.Config.cta.elements.container).attr('data-init-delay'), 10) * 1000;\n                        Hubs.CTAs.initialDelayCTA = Hubs.root.setTimeout(function(){\n                            $(Hubs.Config.cta.elements.possibleBlock).addClass('blocking-cta');\n                            $(Hubs.Config.cta.elements.possibleHiddenEmbed).addClass('hide-embed');\n\n                            self.repositionBlockingCTA($(Hubs.Config.cta.elements.blockCta));\n\n                            self.unexpandForCta();\n\n                            Hubs.CTAs.showCta($(Hubs.Config.cta.elements.blockCta), true);\n                        }, initialDelay);\n                    } else {\n                        $(Hubs.Config.cta.elements.possibleBlock).addClass('blocking-cta');\n                        $(Hubs.Config.cta.elements.possibleHiddenEmbed).addClass('hide-embed');\n\n                        Hubs.CTAs.showCta($(Hubs.Config.cta.elements.blockCta));\n\n                        self.unexpandForCta();\n                    }\n                }\n\n                // Show the CTA\n                Hubs.CTAs.showCta($el);\n            });\n\n            return hiddenBlockingCta;\n        }\n\n        // Go through the storage of ctas and hide the submitted ones\n        $.each(parsedValue.cta, function(){\n            hideListIds.push(this.listID);\n            hideCtaIds.push(this.ctaID);\n            backUpValue.cta.push(this);\n        });\n\n\n        // Placement may not exist yet as it was added later\n        if(parsedValue.placement){\n            $.each(parsedValue.placement, function(){\n                if(this.hideUntil && new Date().getTime() > this.hideUntil){\n                    resetValue = true;\n                } else {\n                    hidePlacementIds.push(this.placementID);\n                    backUpValue.placement.push(this);\n                }\n            });\n\n            // If the placement timeout is now done, reset the value to know for next time\n            if(resetValue){\n                localStorage.setItem(storageString, JSON.stringify(backUpValue));\n            }\n        }\n\n        $.each($container, function(){\n            var $el = $(this), ctaCompleted = false, initialDelay = 0;\n\n            // Custom CTAs don't have lists - for now\n            if($el.attr('data-integration') != 'form_cta_type'){\n                $.each(hideListIds, function() {\n                    if(this.toString() === $el.attr('data-list-id')){\n                        ctaCompleted = true;\n                        return false;\n                    }\n                });\n            } else {\n                $.each(hideCtaIds, function() {\n                    if(this.toString() === $el.attr('data-cta-id')){\n                        ctaCompleted = true;\n                         return false;\n                    }\n                });\n            }\n\n            $.each(hidePlacementIds, function() {\n                if(this.toString() === $el.attr('data-placement-id')){\n                    ctaCompleted = true;\n                }\n            });\n\n            if($el.attr('data-no-hide')){\n                ctaCompleted = false;\n\n                // Show a message if \"show success message\" option turned on\n                if ($el.attr('data-show-success-message') && $.inArray($el.attr('data-cta-id'), hideCtaIds) != -1) {\n                    $el.find(Hubs.Config.cta.elements.formTop).hide();\n                    $el.find(Hubs.Config.cta.elements.formSuccess).show();\n                }\n            }\n\n            // If no hidden blocking cta, the current cta is blocked, and current cta is a blocking cta: we found a hidden blocking cta\n            if(!hiddenBlockingCta && ctaCompleted && $el.parent().hasClass('block-cta')){\n                hiddenBlockingCta = 1;\n            }\n\n            // CTA HTML is always injected to the DOM; The default state is hidden. Here we unhide the cta if its not\n            // found in localStorage (ctas are stored in localStorage after all fields are completed for a user)\n            if(!ctaCompleted){\n                // If not on the list, but no fields are showing (due to progressive profiling), show just the email\n                // to allow the user to still opt in to the cta\n                if($el.find('.cta-field-section:not(.hide):not(.opt-in-section)').length === 0){\n                    $el.find('.cta-field-section.email-field').removeClass('hide');\n                }\n\n                $el.removeClass('hide');\n\n                 // If CTA has setting \"Never hide this CTA\", make sure we unexpand the Fullscreen Mode\n                 if ($el.attr('data-no-hide')) {\n                     self.unexpandForCta();\n                 }\n\n                if($el.parent().hasClass('block-cta')){\n                    if($el.attr('data-init-delay')){\n                        initialDelay = parseInt($el.attr('data-init-delay'), 10) * 1000;\n                        Hubs.CTAs.initialDelayCTA = setTimeout(function(){\n                            $(Hubs.Config.cta.elements.possibleBlock).addClass('blocking-cta');\n                            $(Hubs.Config.cta.elements.possibleHiddenEmbed).addClass('hide-embed');\n\n                            self.repositionBlockingCTA($(Hubs.Config.cta.elements.blockCta));\n\n                            self.unexpandForCta();\n\n                            Hubs.CTAs.showCta($el.parent(), true);\n                        }, initialDelay);\n                    } else {\n                        $(Hubs.Config.cta.elements.possibleBlock).addClass('blocking-cta');\n                        $(Hubs.Config.cta.elements.possibleHiddenEmbed).addClass('hide-embed');\n                        self.unexpandForCta();\n                        Hubs.CTAs.showCta($el.parent());\n                    }\n                } else if($el.parent().hasClass('cta-item-container')){\n                    besideExists = true;\n                    // Mark any visible CTAs as ones that need a view tracked\n                    Hubs.CTAs.markCtasForViewTracking();\n                } else {\n                    // Not a beside or blocking CTA, we're on level 1\n                    // Mark any visible CTAs as ones that need a view tracked\n                    Hubs.CTAs.markCtasForViewTracking();\n                }\n            }\n        });\n\n        // Only need to call the lazy loader if it's a not an item\n        if (pageType !== Hubs.PAGE_TYPE_ITEM && lazyLoader) {\n            lazyLoader.updateSizes();\n        }\n\n        if (pageType === Hubs.PAGE_TYPE_ITEM && !besideExists) {\n            $('.item-contents-with-cta').removeClass('item-contents-with-cta');\n            $('.with-cta').removeClass('with-cta');\n            $('.cta-item-container').remove();\n        }\n\n        return hiddenBlockingCta;\n    };\n\n    /**\n     * Reposition Blocking CTAs so that they are in View\n     *\n     * @public\n     * @this Hubs.CTAs\n     * @return undefined\n     */\n    Hubs.CTAs.prototype.repositionBlockingCTA = function($ctaElement) {\n        var ctaTop = 0;\n        if (!$ctaElement.length) { return; }\n\n        if ($(window).height() < Hubs.SMALL_SCREEN_HEIGHT) {\n            //if (Shared.IOS) {\n            //    ctaTop = $(Hubs.Config.containers.topNav).outerHeight(true);\n            //    $ctaElement.css({'position': 'fixed', 'top': ctaTop, 'margin-top': 0});\n            //} else {\n                ctaTop = Shared.scrollTop();\n                $ctaElement.css({'position': 'absolute', 'top': ctaTop, 'margin-top': 0});\n            //}\n        }\n    };\n\n    Hubs.CTAs.prototype.verifyFieldsConditions = function(conditions, $formFieldsWrapper) {\n        var conditionLength = conditions.length;\n\n        for (var i = 0; i < conditionLength; i++) {\n            var conditionalFieldId = conditions[i].conditional_field_id;\n            var conditionalFieldValue = conditions[i].value;\n            var conditionalOperator = conditions[i].operator;\n\n            var $conditionalField = $formFieldsWrapper.find('.preview-form-field[data-field-id=\"' + conditionalFieldId + '\"]');\n\n            // if the field type is not checkbox or select return false\n            var elementType = $conditionalField.prop('tagName');\n            if (!(elementType === 'INPUT' && $conditionalField.prop('type') === 'checkbox') && elementType !== 'SELECT') {\n                return false;\n            }\n\n            var changedVal;\n\n            if ($conditionalField.prop('type') === 'checkbox') {\n                changedVal = $conditionalField.is(':checked') ? 1 : 0;\n            } else {\n                changedVal = $conditionalField.val();\n            }\n\n            if ((changedVal == conditionalFieldValue && conditionalOperator == 'EQUAL_TO') || (changedVal != conditionalFieldValue && conditionalOperator == 'NOT_EQUAL_TO')) {\n                return true;\n            } else {\n                // check for other fields in conditional field before taking action\n                // if anyone of them is true don't hide the field\n                var conditionsLeft = conditions.filter(function(val,index){return index !== i;});\n\n                if (conditionsLeft.length > 0 && this.verifyFieldsConditions(conditionsLeft, $formFieldsWrapper)) {\n                    return true;\n                } else {\n                    return false;\n                }\n\n            }\n\n        }\n    };\n\n}(window.jQuery));\n"},function(t,e,n){n(10)(n(373))},function(t,e){t.exports="(function($, undefined) {\n    'use strict';\n\n    /**\n     * Hubs Responsive\n     * \n     * @class Responsive\n     * @kind JS.Module\n     * @mixin\n     * @classdesc Provides the Responsive JS Behaviour for the App\n     * @namespace Hubs\n     * @constructor\n     */\n    Hubs.Responsive = function() {};\n\n    /* ******************************************************************************************** */\n    /* * Public Methods                                                                           * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Resize the Main Hub Sharing Menu \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.resizeHubShare = function() {\n        var w, $icons, $shareHub = $('.share-item');\n        if (!$shareHub.length) { $shareHub = $('.share-hub'); }\n        if (!$shareHub.length) { return; }\n        \n        // Get Number of Share Icons\n        $icons = $shareHub.find('li');\n        \n        // Get Width of Icons\n        w = $icons.find('a').outerWidth();\n        \n        // Update Width of Hub Sharing Container\n        $shareHub.css({'width': (($icons.length-1) * w)});\n        \n        // Update Padding when only 2 or 3 items displayed\n        if ($icons.length === 3) { $icons.css({'padding': '0 7px'}); }\n        if ($icons.length === 2) { $icons.css({'padding': '0 42px'}); }\n    };\n    \n    /**\n     * Reposition Header elements (vertically align) \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.repositionHeader = function() {\n        //vertically center header-main based on its height and the height of large-header\n        var $largeHeader = $(Hubs.Config.containers.largeHeader);\n        if(!$largeHeader.length) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('responsive-header');\n        \n        var $wrapper = $largeHeader.find('.header-wrapper');\n        var mTop = parseInt( ($largeHeader.height() - $wrapper.height() ) / 2, 10);\n        $wrapper.css({'top': 0, 'margin-top': mTop});\n    };\n    \n    /**\n     * Resize all Image Tiles on Page \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.resizeImageTiles = function() {\n        // Debug Statement\n        Shared.Logger.log('responsive-resize');\n        \n        // Iterate through all Tiles with Images on Page\n        $('.tile .img img').each($.proxy(function(idx, imgEl) {\n            this.resizeImageTile(imgEl);\n        }, this));\n    };\n\n    /**\n     * Resize a Specific Image Tile on Page \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.resizeImageTile = function(imgEl, callback) {\n        var $el        = $(imgEl).parent(),\n            $tile      = $el.closest('.tile'),\n            tileWidth  = $el.width(),\n            tileHeight = $el.height(),\n            $tileImg   = $el.find('img'),\n            imgHeight  = $tileImg.height(),\n            imgWidth   = $tileImg.width();\n        \n        if (imgHeight <= 0 || $tileImg.hasClass('shorter') || $tileImg.hasClass('taller')) { return; }\n\n        // If the height is greater than the width, portrait style\n        if (imgHeight >= imgWidth){\n            $tile.addClass('portrait');\n            tileWidth  = $el.width();\n            tileHeight = $el.height();\n        }\n        \n        // If the Image is Taller than the Tile\n        if (imgHeight >= tileHeight) {\n            $tileImg.addClass('taller');\n\n            // Centering the image vertically in the tile, EXCEPT for docs, because we want to see the top of the doc in the tile\n            if (!$el.parent('.tile').is('.uberflip')) {\n                $tileImg.css({'margin-top' : -((imgHeight - tileHeight) / 2 )});\n            }\n        }\n        \n        // If the Image is Shorter than the Tile\n        else {\n            if (Hubs.isMobile()){\n                $tileImg.css({'height' : tileHeight, 'width' : 'auto'});\n            } else {\n                $tileImg.addClass('shorter');\n            }\n            \n            // Center the image horizontally in the tile\n            $tileImg.css({'margin-left' : -(($tileImg.width() - tileWidth) / 2 )});\n        }\n        \n        if (typeof callback === 'function') {\n            callback.call(this);\n        }\n    };\n\n    /**\n     * Updates the Position of the Sharing Menu on Level 3 to maintain alignment with content\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.repositionLevel3Sharing = function() {\n        // Hide Top-Nav Sharing Button on Twitter Item Pages\n        var $shareToggle = $('.share-toggle');\n        if ($shareToggle.length) {\n            if (this.pageType === Hubs.PAGE_TYPE_ITEM && ($('.share-twitter').length || $('.btn-facebook').length)) {\n                $shareToggle.hide();\n            } else {\n                $shareToggle.show();\n            }\n        }\n    };\n    \n    /**\n     * Keep instagram videos a perfect square\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.resizeInstagramVideo = function() {\n        // Hide Top-Nav Sharing Button on Twitter Item Pages\n        var $videoContainer = $('.level-three.instagram .entry-video');\n        if ($videoContainer.length) {\n            $videoContainer.css(\"height\", $videoContainer.width() + \"px\" );\n        }\n    };\n    \n    /**\n     * Reposition CTA depending on Screen Size\n     *       \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.repositionCta = function() { \n        var vpw, pos, $ctaContainer = $('.cta-item-container');\n        if (!$ctaContainer.length) { return; }\n        \n        // Check Size of Viewport\n        vpw = Shared.$('window').width();\n        \n        // Check Current Position of CTA\n        pos = $ctaContainer.data('position');\n        \n        if (vpw >= Hubs.Config.breakpoints.desktop2) {\n            if (pos === 'outside') { return; }\n            \n            // Update Position of CTA\n            $('.page-width.item-level .item-contents-with-cta').eq(0).after($ctaContainer);\n            \n            // Determine if CTA is small enough to have Fixed Position\n            if($('body').height() < 700) {\n                $ctaContainer.find('.cta').css('position', 'relative');\n            } else {\n                $ctaContainer.find('.cta').css('position', 'fixed');\n            }\n            \n            // Store Position of CTA\n            $ctaContainer.data('position', 'outside');\n        }\n        else {\n            if (pos === 'inside') { return; }\n            \n            // Update Position of CTA\n            $ctaContainer.find('.cta').css('position', 'relative');\n            $('.entry-wrapper').append($ctaContainer);\n            \n            // Store Position of CTA\n            $ctaContainer.data('position', 'inside');\n        }\n    };\n    \n    /**\n     * Resize all CTAs that have aspect ratio text set up\n     *       \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.responsiveCtaText = function() {\n        $.each($('.cta[data-aspect-ratio]'), function(){\n            var $el = $(this),\n                fontAspectRatio = $el.attr('data-aspect-ratio'),\n                $updateEls = $el.find('p'),\n                ctaWidth = $el.width(),\n                ctaHeight = ($el.height()>1) ? $el.outerHeight() : parseFloat($el.css('padding-bottom')),\n                fontSize =  parseFloat(fontAspectRatio) * (ctaWidth+ctaHeight);\n            \n            $updateEls.css({'font-size': fontSize + 'px', 'margin-top': fontSize + 'px', 'margin-bottom': fontSize + 'px'});\n        }); \n    };\n    \n    /**\n     * Resizes the cta forms, mainly to make sure the anchor tag is always showing.\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Responsive.prototype.resizeCtaForms = function() {\n        var $formCtas = $(Hubs.Config.cta.elements.form);\n        \n        $.each($formCtas, function(){\n           var $container = $(this),\n               $top = $container.find(Hubs.Config.cta.elements.formTop),\n               $cancelAnchor = $top.find(Hubs.Config.cta.elements.hideCancel),\n               $bottom = $container.find(Hubs.Config.cta.elements.formBottom),\n               topUp = 0,\n               bottomUp = 0;\n          \n           // Anchor tag only needs to be resized if it is showing\n           if($cancelAnchor.css('display') === 'block'){\n               // Bring up the top all the way but still show the button portion for cancel\n               topUp = -1 * ($top.height() - $cancelAnchor.outerHeight());\n               \n               // Bottom comes all the way up but below the cancel button\n               bottomUp = $top.find('.hide-preview-cancel').outerHeight();\n               \n               $top.addClass('notransition').css({'top': topUp});\n               $bottom.addClass('notransition').css({'top': bottomUp});\n               \n               // Removing transitions needs a delay otherwise the transitional class gets added back too quickly.\n               // Transition happens for the top css attribute even though the code is run synchronously \n               setTimeout(function(){\n                   $top.removeClass('notransition');\n                   $bottom.removeClass('notransition');\n               }, 500);\n              \n           }\n        });\n    };\n    \n}(window.jQuery));\n"},function(t,e,n){n(10)(n(375))},function(t,e){t.exports="(function($) {\n  'use strict';\n\n  /**\n   * Hubs Recommendations\n   *\n   * @class Recommendations\n   * @kind JS.Module\n   * @mixin\n   * @classdesc Provides the Recommendations Bombora calls and UI manipulation\n   * @namespace Hubs\n   * @constructor\n   */\n  Hubs.Recommendations = function() {};\n\n  var opts = {};\n\n  var config = {\n    animationSpeed          : 500,\n    panelWidth              : 242,\n    // the width at which the panel will fit in the left margin without adjustment.\n    contentBreakpoint       : 1402,\n    sideCtaContentBreakpoint: 1746,\n  };\n\n  var recoSelectors = {\n    recommendationContent   : '#recommendation-content-wrapper',\n    recommendationNextButton: '#recommendation-button-wrapper',\n    defaultNextButton       : '#default-next-button-wrapper',\n    carouselWrapper         : '.related-items-container'\n  };\n\n\n\n  /* ******************************************************************************************** */\n  /* * Public Methods                                                                           * */\n  /* ******************************************************************************************** */\n\n\n  /**\n   * Init Reco DOM elements\n   * @param callback: set-up for elements that appear asynchronously on the page, like carousel\n   */\n  Hubs.Recommendations.prototype.setUpRecommendations = function(callback) {\n\n    // make sure the reco options are available to us\n    opts = Hubs.recommendation;\n    if (!opts.enabled){return;}\n\n    // construct the bombora request body\n    var body = {\n      \"rule\": {\n          \"id\": opts.id,\n          \"type\": \"hub\"\n      },\n      \"type\": {\n      },\n      \"context\": {\n        \"hub_id\": parseInt(Hubs.Config.hubId, 10),\n        \"visual\": shouldOverrideCarousel() ? [{name:'carousel'},{name:'next'}] : [{name: 'panel'}],\n        \"url\": window.location.href,\n        \"visitor\":{\n          \"uberflip\": {\n          },\n          \"bombora\": {\n          }\n        }\n      },\n      \"filters\": {\n        \"count\": opts.template.max_items_to_display,\n        \"max_age_days\": opts.template.max_item_age,\n        \"hide_publish_date\": opts.template.hide_publish_date\n      }\n    };\n\n    if (typeof window.getBomboraUuid === 'function') {\n      body.context.visitor.uberflip.uuid = window.getBomboraUuid();\n    }\n\n    // get CCMAID a.k.a. \"bombora_visitor_id\"\n    if (window.localStorage && localStorage.getItem('_ccmaid')){\n      body.context.visitor.bombora.id = localStorage.getItem('_ccmaid');\n    }\n\n    if (Hubs.appInstance) {\n      body.context.item_id = Hubs.appInstance.currentItemId;\n      body.context.collection_id = Hubs.appInstance.currentCollectionId;\n    } else {\n      var $pageInfoDiv = $('#page-type-identifier');\n      body.context.item_id =   parseInt($pageInfoDiv.attr('data-item-id'),10);\n      body.context.collection_id = parseInt($pageInfoDiv.attr('data-collection-id'),10);\n    }\n\n    if (opts.isInternalRule) {\n\n      // add the type recommendation type\n      body.type.id = Shared.RECOMMENDATION_ENGINE_TYPE_STREAM;\n      body.type.source_collection_id = opts.source_collection_id;\n\n      callRecoEngine(\n        body,\n        buildRecoElements.bind(this, opts.template, opts.template.panel_delay, callback),\n        showCarouselAndNext.bind(this, false, callback)\n        );\n\n    } else if (opts.isAiRule) {\n\n      // add the type recommendation type\n      body.type.id = Shared.RECOMMENDATION_ENGINE_TYPE_AI;\n\n      // start timer for panel delay\n      var getTimeRemaining = setDelayCountdown(opts.template.panel_delay);\n\n      // don't pass stream ids if the rule is for all streams\n      if (opts.recommendationAiContent !== 'all_streams') {\n        body.filters.allowed_collection_ids = opts.recommendationAiStreams;\n      }\n\n      var sendAjax = function() {\n        callRecoEngine(\n          body,\n          buildRecoElements.bind(this, opts.template, getTimeRemaining(), callback),\n          showCarouselAndNext.bind(this, false, callback)\n        );\n      };\n\n      // if we don't have topics, wait a bit for the bombora callback to return\n      var count = 8; // number of intervals before timeout\n      (function wait(){\n        if (window._ml && window._ml.us) {\n          body.context.visitor.bombora.intent_topics = window._ml.us.tp;\n          sendAjax();\n        } else if (count <= 0){\n          sendAjax();\n        } else {\n          count -= 1;\n          setTimeout(wait, 200);\n        }\n      })();\n\n    }\n  };\n\n  Hubs.Recommendations.prototype.isRecommendationEnabled = function() {\n    return Hubs.recommendation && Hubs.recommendation.enabled;\n  };\n\n  Hubs.Recommendations.markItemToHidePublishDate = function ($element) {\n    var recommendation = Hubs.recommendation || {};\n    var recoTemplate = recommendation.template || {};\n    // if there is recommendation that is enabled & has template\n    if (recommendation && recommendation.enabled) {\n      // If there is a template set and hide publish date is enabled\n      if (recoTemplate && recoTemplate.hide_publish_date) {\n        if (recoTemplate.enable_panel && shouldShowPanel()) { // panel\n          return $element.closest('.reco-panel-items .tile').data('id');\t\n        } else if (!shouldShowPanel() && shouldOverrideCarousel()) { // next item / carousel \n          return $element.data('item-id') || $element.closest('.tile').data('id');\n        }\n      }\n    }\n\n    return false;\n  };\n\n  /* ******************************************************************************************** */\n  /* * Private functions                                                                        * */\n  /* ******************************************************************************************** */\n\n  function callRecoEngine(body, success, fallback){\n    $.ajax({\n      type:'POST',\n      url: Shared.absoluteHubUrl('/hubsFront/ajax_getRecommendations'),\n      data: JSON.stringify(body),\n      contentType: \"application/json\",\n      success: function(data) {\n        if (data.response.recommendations) {\n          var recoData = data.response.recommendations;\n\n          if (recoData.tiles) {\n            // insert data into the DOM containers\n            $(recoData.tiles.html).appendTo(recoSelectors.recommendationContent);\n            if(!Hubs.recommendation.template.hide_publish_date) {\n              $(recoSelectors.recommendationContent + ' ' + Hubs.Config.containers.timeAgo).timeago();\n            }\n          } else {\n            return fallback();\n          }\n\n          if (recoData.next) {\n            $(recoData.next.html).appendTo(recoSelectors.recommendationNextButton);\n          }\n\n          // build dom things\n          success();\n        } else {\n          // there was no content returned, so show the default carousel\n          fallback();\n        }\n      },\n      error: function(){\n        //show the default carousel\n        fallback();\n      }\n    });\n  }\n\n\n  function showCarouselAndNext(showNext, callback) {\n    var recoButton = $(recoSelectors.recommendationNextButton).find('.item-next');\n\n    // should show Reco next button or default prev/next?\n    if (showNext && recoButton.length) {\n      // show Reco next button\n      $(recoSelectors.recommendationNextButton).removeClass('hide');\n      $(recoSelectors.defaultNextButton).addClass('hide');\n    } else {\n      // show default next/prev button\n      $(recoSelectors.recommendationNextButton).addClass('hide');\n      $(recoSelectors.defaultNextButton).removeClass('hide');\n    }\n\n    // show the carousel no matter what\n    $(recoSelectors.carouselWrapper).addClass('reco-engine-show');\n\n    // The Reco stuff is all in the dom. need to hook links and setup carousel\n    if(callback) {callback();}\n\n    // emit event\n    Hubs.Events.trigger('recoItemsLoaded');\n  }\n\n\n  /**\n   * Get the bottom of the topNav from top of window.\n   * @returns int\n   */\n  function getNavBottom() {\n    // This is way better than a jQuery solution,\n    // getBoundingClientRect() returns x, y, height, bottom, etc of border-box relative to browser window.\n    var boundingBox = document.querySelector('.top-nav').getBoundingClientRect();\n\n    return boundingBox.bottom;\n  }\n\n  /**\n   * Get widths needed for calculating what to do with panel and margins.\n   */\n  function getWidths() {\n    var panelWidth = config.panelWidth;\n    var $content = $('#item-content');\n    var $article = $content.find('.item-data');\n    var windowWidth = getWindowSize().width;\n    var leftMarginWidth = $article.offset().left;\n    var hasSideCta = pageHasSideCta();\n\n    var contentWidth;\n    if (hasSideCta) {\n      var $sideCta = $content.find('.cta-item-container .cta');\n      // Measure from article left to cta right\n      contentWidth = ($sideCta.offset().left + $sideCta.width() + 10) - leftMarginWidth;\n    } else if ($content.data('defaultWidths')) {\n      // use the original width of the content (for correct resize when shrinking the screen)\n      contentWidth = $content.data('defaultWidths').content;\n    }  else {\n      contentWidth = $article.outerWidth();\n    }\n\n    var rightMarginWidth = windowWidth - (contentWidth + leftMarginWidth);\n    var adjustedRightMargin = (((windowWidth - contentWidth) - panelWidth) / 2);\n    var adjustedLeftMargin = (adjustedRightMargin + panelWidth);\n\n    // Store the original widths\n    if ( ! $content.data('defaultWidths') || ! $content.attr('data-margins-adjusted')) {\n      $content.data('defaultWidths', {\n        content: $article.outerWidth(),\n        leftMargin: $content.css('margin-left'),\n        rightMargin: $content.css('margin-right'),\n      });\n    }\n\n    return {\n      window: windowWidth,\n      content: contentWidth,\n      leftMargin: leftMarginWidth,\n      rightMargin: rightMarginWidth,\n      adjustedRight: adjustedRightMargin,\n      adjustedLeft: adjustedLeftMargin,\n    };\n  }\n\n  function adjustContentMargins(marginLeft, marginRight) {\n    var $content = $('#item-content');\n    $content.animate(\n      {\n        marginLeft : marginLeft,\n        marginRight: marginRight\n      },\n      config.animationSpeed,\n      function(){\n        $content.attr('data-margins-adjusted', true);\n      }\n    );\n  }\n\n  function removeAdjustedContentMargins() {\n    var $content = $('#item-content');\n    if( ! $content.attr('data-margins-adjusted')) return;\n    $content.animate(\n      {\n        marginLeft : $content.data('defaultWidths').leftMargin,\n        marginRight: $content.data('defaultWidths').rightMargin,\n      },\n      config.animationSpeed,\n      function() {\n        $content.removeAttr('data-margins-adjusted');\n        $content.css({marginLeft: '', marginRight: ''});\n      }\n    );\n  }\n\n  /**\n   * Has cta && is The Cta floating beside the article?\n   */\n  function pageHasSideCta() {\n    var $content = $('#item-content');\n    return $content.hasClass('with-cta') && $content.find('.entry-wrapper .cta-item-container .cta').length === 0;\n  }\n\n  /**\n   * Decide whether we should override the carousel.\n   */\n  function shouldOverrideCarousel() {\n    return opts.template.override_next && ! shouldShowPanel();\n  }\n\n  /**\n   * Should we show the panel?\n   */\n  function shouldShowPanel() {\n    var widths = getWidths();\n    return (\n      opts.template.enable_panel &&\n      config.panelWidth < (widths.leftMargin + widths.rightMargin)\n    );\n  }\n\n  /**\n   * Decide what Reco Elements to build\n   * @param template\n   * @param delay\n   * @param callback: set-up for elements that appear after page init, like carousel\n   */\n  function buildRecoElements(template, delay, callback) {\n    // this will adjust the page margins\n    var showPanel    = shouldShowPanel();\n    var overrideNext = template.override_next && !showPanel;\n    var label        = template.label_recommended;\n    var fromTop      = template.panel_top_auto ? getNavBottom() : template.panel_top_pixels;\n\n    // If there are no tiles to show, abort\n    if ( ! $(recoSelectors.recommendationContent).find('.tile').length) return;\n\n    // Decide what to show/hide/override\n    if (showPanel) {\n      createRecoPanel(label, fromTop, delay);\n    } else if (overrideNext) {\n      replaceCarouselWithReco(label);\n    } // else don't show any recos\n\n    // always show the carousel\n    showCarouselAndNext(overrideNext, callback);\n\n    if(overrideNext) {\n        Hubs.recoMetrics.initialRecoMetrics(true);\n    }\n  }\n\n  /**\n   * Swap out the default carousel for the Reco carousel\n   * @param label\n   */\n  function replaceCarouselWithReco(label) {\n    // check if we have tiles\n    var $recoTiles = $(recoSelectors.recommendationContent).find('.tile');\n    if (!$recoTiles.length) { return; }\n\n    var $header = $('#related-items-heading', recoSelectors.carouselWrapper).detach();\n    var $carousel = $('#related-items', recoSelectors.carouselWrapper).detach();\n\n    // replace tiles and header text\n    $carousel.find('.carousel-inner').html($recoTiles);\n    $header.text(label);\n\n    // insert the updated carousel and header to the DOM\n    $carousel.prependTo(recoSelectors.carouselWrapper).before($header);\n  }\n\n  /**\n   * Create the panel, insert it, and set relevant events.\n   * @param label\n   * @param fromTop\n   * @param delay\n   */\n  function createRecoPanel(label, fromTop, delay) {\n    // check if we have tiles\n    var $recoTiles = $(recoSelectors.recommendationContent).find('.tile');\n    if (!$recoTiles.length) { return; }\n\n    var $panel = $(\"<div class='reco-panel'>\" +\n                      \"<div class='reco-toggle'>\" +\n                        \"<span class='reco-show'>+</span>\" +\n                        \"<span class='reco-hide'>x</span>\" +\n                      \"</div>\" +\n                      \"<h3>\" + label + \"</h3>\" +\n                      \"<div class='reco-panel-items'></div>\" +\n                    \"</div>\");\n\n    $panel.find('.reco-panel-items').append($recoTiles);\n    $panel.css('top', fromTop);\n\n    $panel.on('transitionend', function (event) {\n      if (event.originalEvent.propertyName == 'left') {\n          Hubs.recoMetrics.initialRecoMetrics(shouldOverrideCarousel());\n          $panel.off('transitionend');\n      }\n    });\n\n    // insert panel into DOM, hidden\n    $('body').append($panel).addClass('has-reco-panel');\n\n    function slidePanelIn() {\n        $panel.addClass('open');\n        // emit event\n        Hubs.Events.trigger('recoPanelOpen');\n    }\n\n    function slidePanelOut() {\n        $panel.removeClass('open');\n    }\n\n    function initialPanelEntry() {\n      var widths = getWidths();\n      // will panel fit in left margin without adjustment?\n      if (config.panelWidth > widths.leftMargin){\n        adjustContentMargins(widths.adjustedLeft, widths.adjustedRight);\n      }\n      slidePanelIn();\n    }\n\n    // delay panel entry?\n    var entryDelay;\n    if (delay <= 0) {\n      initialPanelEntry();\n    } else {\n      entryDelay = setTimeout(\n        initialPanelEntry,\n        (delay * 1000)\n      );\n    }\n\n    // panel open/close event\n    $panel.on('click', '.reco-toggle span', function() {\n      // clear timeout if user opens panel before panel entry delay runs out\n      if (entryDelay) {\n        clearTimeout(entryDelay);\n        entryDelay = null;\n      }\n\n      var widths = getWidths();\n      // panel is greater than left margin, but lesser than both margins combined.\n      var adjustMargins = (\n        config.panelWidth > widths.leftMargin &&\n        config.panelWidth < (widths.leftMargin + widths.rightMargin)\n      );\n\n      if ($panel.hasClass('open')) {\n        // panel is closing so reset margins\n        removeAdjustedContentMargins();\n        slidePanelOut();\n      } else {\n        // panel is opening\n        if (adjustMargins){\n          adjustContentMargins(widths.adjustedLeft, widths.adjustedRight);\n        }\n        slidePanelIn();\n      }\n    });\n\n    Hubs.Events.on('resize', function() {\n      if (!$panel.hasClass('open')) return;\n\n      var widths = getWidths();\n      var $content = $('#item-content');\n\n      // we need the hardcoded config values here because\n      // once margins are adjusted panel will always fit in left margin.\n      var breakWidth = pageHasSideCta() ? config.sideCtaContentBreakpoint : config.contentBreakpoint;\n      var panelWillFitInLeftMargin = widths.window > breakWidth;\n      var panelWontFit = config.panelWidth > (widths.leftMargin + widths.rightMargin);\n\n      if (panelWillFitInLeftMargin || panelWontFit) {\n        $content.removeAttr('data-margins-adjusted');\n        $content.css({marginLeft: '', marginRight: ''});\n        if (panelWontFit) {\n          slidePanelOut();\n        }\n      } else {\n        // re-adjust the margins\n        adjustContentMargins(widths.adjustedLeft, widths.adjustedRight);\n      }\n    });\n  }\n\n  // timer that returns a getter for remaining seconds\n  function setDelayCountdown(delay) {\n    var secondsRemaining = delay;\n\n    var timerId = setInterval(function(){\n      secondsRemaining -= 1;\n      if (secondsRemaining <= 0) {\n        clearInterval(timerId);\n      }\n    }, 1000);\n\n    return function() {\n      return secondsRemaining;\n    };\n  }\n\n  // check window width\n  function getWindowSize() {\n    var w = window,\n      d = document,\n      e = d.documentElement,\n      g = d.getElementsByTagName('body')[0],\n      x = w.innerWidth  || e.clientWidth  || g.clientWidth,\n      y = w.innerHeight || e.clientHeight || g.clientHeight;\n    return {width:x, height:y};\n  }\n\n}(window.jQuery));"},function(t,e,n){n(10)(n(377))},function(t,e){t.exports="(function($, undefined) {\n    'use strict';\n\n    /**\n     * Hubs Embedded\n     * \n     * @class Embedded\n     * @kind JS.Module\n     * @mixin\n     * @classdesc Provides the Embedded JS Behaviour for the App\n     * @namespace Hubs\n     * @constructor\n     */\n    Hubs.Embedded = function() {};\n\n    /** @member {Object} embeddedScrollData The Last Positions of Moving Parts (used to keep in view when Hub is embedded) */\n    Hubs.Embedded.prototype.embeddedScrollData  = {\n         //        $e=element, h=height, o=offset, p=last position, f=found element\n        'sheader' : {'$e': null, 'h': 0, 'o': 0, 'p': 0},\n        'lheader' : {'$e': null, 'h': 0, 'o': 0, 'p': 0},\n        'nav'     : {'$e': null, 'h': 0, 'o': 0, 'p': 0},\n        'footer'  : {'$e': null, 'h': 0, 'o': 0, 'p': 0},\n        'cta_s'   : {'$e': null, 'h': 0, 'o': 0, 'p': 0, 'f': false},   // Side CTA\n        'cta_b'   : {'$e': null, 'h': 0, 'o': 0, 'p': 0, 'f': false},   // Blocking CTA\n        'share'   : {'$e': null, 'h': 0, 'o': 0, 'p': 0, 'f': false},\n        'toTop'   : {'$e': null, 'h': 0, 'o': 0, 'p': 0}\n    };\n    \n    /** @member {Number} minTopBottomGap The minimum Gap between the Header and Footer */\n    Hubs.Embedded.prototype.minTopBottomGap = 300;\n    \n    /** @member {Object} viewportData The current data associated with the Viewport */\n    Hubs.Embedded.prototype.viewportData = {'x': 0, 'y': 0, 'scrollTop': 0, 'offsetTop': 0};\n    \n    /** @member {Object} absoluteOffset */\n    Hubs.Embedded.prototype.absoluteOffset = {'top': 0, 'bottom': 0};\n\n    /** @member {Object} animDuration */\n    Hubs.Embedded.prototype.animDuration = {'slide': 750, 'fade': {'hide': 0, 'delay': 250, 'show': 200}};\n\n    /** @member {Object} currentPosition */\n    Hubs.Embedded.prototype.embeddedPosition = {'header': 0, 'footer': 0, 'nav': 0, 'cta_s': 0, 'cta_b': 0, 'share': 0, 'toTop': 0, 'diff': 0};\n    \n    /** @member {Boolean} hideBanner */\n    Hubs.Embedded.prototype.hideBanner = false;\n    \n    \n    /* ******************************************************************************************** */\n    /* * Public Methods                                                                           * */\n    /* ******************************************************************************************** */\n\n    /**\n     * initEmbedded():\n     *   Page init sequence when in hub embedded mode.\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.initEmbedded = function() {\n        if (!Hubs.isEmbedded()) { return; }\n\n        var $win = Shared.$('window');\n\n        // Debug Statement\n        Shared.Logger.log('embedded-init');\n        \n        // Always Allow Touch Events on Embedded + Mobile\n        if (Hubs.isMobile()) {\n            Hubs.restoreBodyScroll();\n        }\n        \n        // Store Data for Window Scroll Event\n        this.updateEmbeddedScrollData();\n            \n        // Watch Scroll Event\n        $win.on('debouncedscroll.Hubs.Embedded', $.proxy(this.embeddedScrollEvent, this));\n        \n        // Watch Resize Event\n        $win.on('debouncedresize.Hubs.Embedded orientationchange.Hubs.Embedded', $.proxy(this.updateEmbeddedScrollData, this));\n\n        // Update hash bookmark and scroll-to-position\n        this.setParentHashBookmark();\n        this.setParentScrollPosition(300);\n    };\n\n    /**\n     * setParentHashBookmark():\n     *   Set hash bookmark on the parent window. Requires non-vanity style url to create\n     *   hash fragment (e.g. https://hubs.uberflip.com/h/i/458905298-destination-wedding).\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.setParentHashBookmark = function() {\n        var currentUrl = $('#page-type-identifier').attr('data-non-vanity-url') || '';\n        var hashFragment = Hubs.getUrlFragmentId(currentUrl);\n        var callback = function() { window.parentIFrame.updateUrl(hashFragment); };\n        this.callIFrameResizer(callback);\n    };\n\n    /**\n     * setParentScrollPosition():\n     *   On page change, set scroll to last known position or to top. Delay (ms) if required.\n     *   Uses current page url to remember last known position.\n     *\n     * @public\n     * @this Hubs.App\n     * @param {Number} timeout = Delay in ms before executing scroll-to-top\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.setParentScrollPosition = function(timeout) {\n        var collectionState = this.getCollectionState();\n        var scrollPosition = (collectionState && collectionState.scrollTop) || 'top';\n        var callback = function() { window.parentIFrame.scroll(scrollPosition) };\n        this.callIFrameResizer(callback, timeout);\n    };\n\n    /**\n     * callIFrameResizer():\n     *   Execute a callback when iframeResizer library is bound to window and ready for use.\n     *   Used for making changes to the parent window of the embedded hub.\n     *\n     * @public\n     * @this Hubs.App\n     * @param {Function} callback = Function to call when iframeResizer is ready\n     * @param {Number} timeout = Delay in ms before running callback once iframeResizer is ready\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.callIFrameResizer = function(callback, timeout) {\n        var iframeResizerReady = 'parentIFrame' in window;\n\n        if (iframeResizerReady) {\n            timeout ? Hubs.root.setTimeout(callback, timeout) : callback();\n        } else {\n            window.addEventListener('parentIFrameReady', function () {\n                timeout ? Hubs.root.setTimeout(callback, timeout) : callback();\n            });\n        }\n    };\n\n    /**\n     * \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.repositionLoadingIndicator = function() {\n        // Reposition Loading Indicator\n        this.$loadingIndicator.css({'top': 150});\n    };\n\n    /**\n     * Called only at Init to determine size/initial position of elements\n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.updateEmbeddedScrollData = function() {\n        var $win = Shared.$('window'); \n        var $doc = Shared.$('document');\n        var $levelThree = $(Hubs.Config.containers.levelThree);\n        var queryParam = '';\n        var hiddenEmbed = $(Hubs.Config.cta.elements.hiddenEmbed).length;\n        \n        if (!Hubs.isEmbedded()) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('embedded-update-scroll-data');\n        \n        // Check for Hidden Top Banner\n        this.hideBanner = (Hubs.isIFrame() && Hubs.Config.embedOptions.hideBanner);\n        \n        // Check for Absolute Offsets\n        queryParam = Shared.getQueryParamByName('offsetTop');\n        if (queryParam.length) { this.absoluteOffset.top = parseInt(queryParam, 10); }\n        queryParam = Shared.getQueryParamByName('offsetBottom');\n        if (queryParam.length) { this.absoluteOffset.bottom = parseInt(queryParam, 10); }\n\n        // Get Bottom Coord for Level Three Block\n        this.levelThreeBottom = 0;\n        if ($levelThree.length) {\n            this.levelThreeBottom = ($levelThree.height() + $levelThree[0].offsetTop - 60);\n        }\n        \n        // Reset Handle to CTA Elements\n        this.embeddedScrollData.cta_s.f = false;\n        if (this.embeddedScrollData.cta_s.$e !== null && this.embeddedScrollData.cta_s.$e.length) {\n            this.embeddedScrollData.cta_s.$e.css({'margin-top': 0});\n            this.embeddedScrollData.cta_s.o = this.embeddedScrollData.cta_s.p = 0;\n        }\n        this.embeddedScrollData.cta_b.f = false;\n        if (this.embeddedScrollData.cta_b.$e !== null && this.embeddedScrollData.cta_b.$e.length && !hiddenEmbed) {\n            this.embeddedScrollData.cta_b.$e.css({'top': 0});\n            this.embeddedScrollData.cta_b.o = this.embeddedScrollData.cta_b.p = 0;\n        }\n        \n        // Get Handle & Height of Elements\n        if (this.embeddedScrollData.lheader.$e === null || !this.embeddedScrollData.lheader.$e.length) {\n            this.embeddedScrollData.lheader.$e = Shared.$(Hubs.Config.containers.largeHeader);\n        }\n        if (this.embeddedScrollData.lheader.$e.length) {\n            this.embeddedScrollData.lheader.h = this.embeddedScrollData.lheader.$e.outerHeight();\n        }\n        if (this.embeddedScrollData.sheader.$e === null || !this.embeddedScrollData.sheader.$e.length) {\n            this.embeddedScrollData.sheader.$e = Shared.$(Hubs.Config.containers.topNav);\n        }\n        if (this.embeddedScrollData.sheader.$e.length) {\n            this.embeddedScrollData.sheader.h = this.embeddedScrollData.sheader.$e.outerHeight();\n        }\n        if (this.embeddedScrollData.footer.$e === null || !this.embeddedScrollData.footer.$e.length) {\n            this.embeddedScrollData.footer.$e = Shared.$(Hubs.Config.containers.footer);\n        }\n        if (this.embeddedScrollData.footer.$e.length && !Hubs.Config.embedOptions.hideFooter) {\n            this.embeddedScrollData.footer.h = this.embeddedScrollData.footer.$e.outerHeight();\n            \n            // Footer dynamically positioned using \"top\" via JS, so rid the \"bottom\" rule set in CSS \n            if (Hubs.Config.labOptions.stickyFooter) {\n                this.embeddedScrollData.footer.$e.css({'top': -this.embeddedScrollData.footer.h, 'bottom': 'auto'});\n            }\n        }\n        if (this.embeddedScrollData.toTop.$e === null || !this.embeddedScrollData.toTop.$e.length) {\n            this.embeddedScrollData.toTop.$e = Shared.$(Hubs.Config.containers.moveToTop);\n        }\n        if (this.embeddedScrollData.toTop.$e.length) {\n            this.embeddedScrollData.toTop.h = this.embeddedScrollData.toTop.$e.outerHeight();\n            this.embeddedScrollData.toTop.$e.css({'bottom': 'auto'});\n        }\n        if (!Hubs.Config.labOptions.topMenu) {\n            if (this.embeddedScrollData.nav.$e === null || !this.embeddedScrollData.nav.$e.length) {\n                this.embeddedScrollData.nav.$e = Shared.$(Hubs.Config.containers.leftNav[2] + '.desktop');\n            }\n            if (this.embeddedScrollData.nav.$e.length) {\n                this.embeddedScrollData.nav.h = this.embeddedScrollData.nav.$e.outerHeight();\n            }\n        }\n        \n        // Reset Handle to \"AddThis\" Share Element\n        this.embeddedScrollData.share.f = false;\n        if (this.embeddedScrollData.share.$e !== null && this.embeddedScrollData.share.$e.length) {\n            this.embeddedScrollData.share.$e.css({'top': 160});\n            this.embeddedScrollData.share.o = this.embeddedScrollData.sheader.h + 20;\n            this.embeddedScrollData.share.p = 0;\n        }\n    };\n    \n    /**\n     * Observes and Responds to the Scroll Events fired on the Global Window Object or App Container\n     *  - Iframe Resizer also calls this on Init\n     * \n     * @public\n     * @this Hubs.App\n     * @param {Object} eventData The Event Data associated with the Event \n     * @param {Number} scrollTop \n     * @param {Number} offsetTop \n     * @param {Number} viewportX \n     * @param {Number} viewportY \n     * @return {Boolean} The success state of the event; determines whether to allow event-bubbling\n     */\n    Hubs.Embedded.prototype.embeddedScrollEvent = function(e, scrollTop, offsetTop, viewportX, viewportY) {\n        var $win = Shared.$('window');\n        var $doc = Shared.$('document');\n        \n        // Debug Statement\n        Shared.Logger.log('embedded-scroll');\n        \n        // Get Height of Document\n        this.documentHeight = $doc.height();\n        \n        // Ensure Valid Values passed in\n        if (scrollTop === undefined) { scrollTop = this.viewportData.scrollTop; }\n        if (offsetTop === undefined) { offsetTop = this.viewportData.offsetTop; }\n        if (viewportX === undefined) { viewportX = $win.width(); }\n        if (viewportY === undefined) { viewportY = $win.height(); }\n        \n        // Store Current Viewport Data\n        this.viewportData.x = viewportX;\n        this.viewportData.y = viewportY;\n        this.viewportData.scrollTop = scrollTop;\n        this.viewportData.offsetTop = offsetTop;\n        \n        // Scroll Individual Elements\n        this.scrollSmallHeader();\n        this.scrollFooter();\n        this.scrollNav();\n        this.scrollMoveToTop();\n        this.scrollCTAs();\n        this.scrollSharing();\n    };\n\n    \n    /**\n     * \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.scrollSmallHeader = function() {\n        // Keep Small Header in View\n        if (!this.hideBanner && this.embeddedScrollData.sheader.$e && this.embeddedScrollData.sheader.$e.length) {\n            // Calculate New Position of Header\n            this.embeddedPosition.header = this.viewportData.scrollTop - this.viewportData.offsetTop + this.absoluteOffset.top;\n            \n            // Ensure Menu stays within Top Bounds of Frame\n            if (this.embeddedPosition.header < 0) { this.embeddedPosition.header = 0; }\n            \n            // Ensure Menu stays within Bottom Bounds of Frame\n            if (this.embeddedPosition.header + this.embeddedScrollData.sheader.h + this.embeddedScrollData.footer.h + this.minTopBottomGap > this.documentHeight) {\n                this.embeddedPosition.diff = this.embeddedPosition.header + this.embeddedScrollData.sheader.h + this.embeddedScrollData.footer.h + this.minTopBottomGap - this.documentHeight;\n                this.embeddedPosition.header -= this.embeddedPosition.diff;\n            }\n            this.embeddedPosition.header = this.embeddedPosition.header | 0;\n\n            // Don't Animate if Menu hasn't Moved\n            if (this.embeddedPosition.header !== this.embeddedScrollData.sheader.p) {\n                this.embeddedScrollData.sheader.p = this.embeddedPosition.header;\n\n                // Slide Behavior\n                if (Hubs.Config.embedOptions.revealBehaviour === 'slide') {\n                    this.embeddedScrollData.sheader.$e.stop().animate({'top': this.embeddedPosition.sheader}, this.animDuration.slide);\n                }\n                \n                // Fade Behavior (with delayed reveal)\n                if (Hubs.Config.embedOptions.revealBehaviour === 'fade') {\n                    window.clearTimeout(this.smallHeaderTimer); \n                    this.embeddedScrollData.sheader.$e.stop().animate({'opacity': 0}, this.animDuration.fade.hide, $.proxy(function() {\n                        this.smallHeaderTimer = window.setTimeout($.proxy(function() {\n                            this.embeddedScrollData.sheader.$e.css({'top': this.embeddedPosition.header}).animate({'opacity': 1}, this.animDuration.fade.show);\n                            this.scrollStarted = false;\n                            \n                            if (Hubs.Config.search.enabled) {\n                                // Update the search positions now that the header position has been set\n                                this.search.updateDropMenuPosition();\n                                this.search.updateResultsPosition();\n                            }\n                        }, this), this.animDuration.fade.delay);\n                    }, this));\n                }\n            }\n        }\n    };\n\n    \n    /**\n     * \n     * \n     * @public\n     * @this Hubs.App \n     * @return undefined\n     */\n    Hubs.Embedded.prototype.scrollFooter = function() {\n        // Keep Footer in View\n        if (Hubs.Config.labOptions.stickyFooter && this.embeddedScrollData.footer.$e && this.embeddedScrollData.footer.$e.length) {\n            // Calculate New Position of Menu\n            this.embeddedPosition.footer = this.viewportData.scrollTop - this.viewportData.offsetTop + this.viewportData.y - this.embeddedScrollData.footer.h - this.absoluteOffset.bottom;\n\n            // Ensure Menu stays within Top Bounds of Frame\n            if (this.embeddedPosition.footer < this.embeddedPosition.header + this.embeddedScrollData.sheader.h + this.minTopBottomGap) {\n                this.embeddedPosition.footer = this.embeddedPosition.header + this.embeddedScrollData.sheader.h + this.minTopBottomGap;\n            }\n            \n            // Ensure Menu stays within Bottom Bounds of Frame\n            if (this.embeddedPosition.footer + this.embeddedScrollData.footer.h > this.documentHeight) {\n                this.embeddedPosition.diff = this.embeddedPosition.footer + this.embeddedScrollData.footer.h - this.documentHeight;\n                this.embeddedPosition.footer -= this.embeddedPosition.diff;\n            }\n            this.embeddedPosition.footer = this.embeddedPosition.footer | 0;\n            \n            // Don't Animate if Menu hasn't Moved\n            if (this.embeddedPosition.footer !== this.embeddedScrollData.footer.p) {\n                this.embeddedScrollData.footer.p = this.embeddedPosition.footer;\n                \n                // Slide Behavior\n                if (Hubs.Config.embedOptions.revealBehaviour === 'slide') {\n                    this.embeddedScrollData.footer.$e.stop().animate({'top': this.embeddedPosition.footer}, this.animDuration.slide);\n                }\n                \n                // Fade Behavior (with delayed reveal)\n                if (Hubs.Config.embedOptions.revealBehaviour === 'fade') {\n                    window.clearTimeout(this.footerPosTimer); \n                    this.embeddedScrollData.footer.$e.stop().animate({'opacity': 0}, this.animDuration.fade.hide, $.proxy(function() {\n                        this.footerPosTimer = window.setTimeout($.proxy(function() {\n                            this.embeddedScrollData.footer.$e.css({'top': this.embeddedPosition.footer}).animate({'opacity': 1}, this.animDuration.fade.show);\n                        }, this), this.animDuration.fade.delay);\n                    }, this));\n                }\n            }\n        }\n    };\n\n    \n    /**\n     * \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.scrollNav = function() {\n        \n        // Keep Left Menu in View\n        if (this.embeddedScrollData.nav.$e && this.embeddedScrollData.nav.$e.length) {\n            // Calculate New Position of Menu\n            this.embeddedScrollData.nav.$e.removeAttr('style'); // css({'top': 'inherit'});\n            this.embeddedScrollData.nav.o = this.embeddedScrollData.sheader.h + 20;\n            this.embeddedScrollData.nav.p = this.embeddedScrollData.nav.o;\n            this.embeddedPosition.nav = this.viewportData.scrollTop - this.viewportData.offsetTop + this.embeddedScrollData.nav.o + this.absoluteOffset.top;\n            \n            // Ensure Menu stays within Top Bounds of Frame\n            if (this.embeddedPosition.nav < this.embeddedScrollData.nav.o) { this.embeddedPosition.nav = this.embeddedScrollData.nav.o; }\n            \n            // Ensure Menu stays within Bottom Bounds of Frame\n            if (this.embeddedPosition.nav + this.embeddedScrollData.nav.h + this.embeddedScrollData.footer.h + 30 > this.documentHeight) {\n                this.embeddedPosition.diff = this.embeddedPosition.nav + this.embeddedScrollData.nav.h + this.embeddedScrollData.footer.h + 30 - this.documentHeight;\n                this.embeddedPosition.nav -= this.embeddedPosition.diff;\n            }\n            this.embeddedPosition.nav = this.embeddedPosition.nav | 0;\n            \n            // Don't Animate if Menu hasn't Moved\n            if (this.embeddedPosition.nav !== this.embeddedScrollData.nav.p) {\n                this.embeddedScrollData.nav.p = this.embeddedPosition.nav;\n                \n                // Slide Behavior\n                if (Hubs.Config.embedOptions.revealBehaviour === 'slide') {\n                    this.embeddedScrollData.nav.$e.stop().animate({'top': this.embeddedPosition.nav}, this.animDuration.slide);\n                }\n                \n                // Fade Behavior (with delayed reveal)\n                if (Hubs.Config.embedOptions.revealBehaviour === 'fade') {\n                    window.clearTimeout(this.menuPosTimer); \n                    this.embeddedScrollData.nav.$e.stop().animate({'opacity': 0}, this.animDuration.fade.hide, $.proxy(function() {\n                        this.menuPosTimer = window.setTimeout($.proxy(function() {\n                            this.embeddedScrollData.nav.$e.css({'top': this.embeddedPosition.nav}).animate({'opacity': 1}, this.animDuration.fade.show);\n                        }, this), this.animDuration.fade.delay);\n                    }, this));\n                }\n            }\n        }\n    };\n\n    \n    /**\n     * \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.scrollMoveToTop = function() {\n        if (!this.embeddedScrollData.toTop.$e || !this.embeddedScrollData.toTop.$e.length) { return; }\n        \n        // Calculate New Position of Link\n        this.embeddedScrollData.toTop.o = this.viewportData.y - this.embeddedScrollData.toTop.h - this.absoluteOffset.bottom - 20;\n        this.embeddedPosition.toTop = this.viewportData.scrollTop - this.viewportData.offsetTop + this.embeddedScrollData.toTop.o;\n        if (Hubs.Config.labOptions.stickyFooter && this.embeddedScrollData.footer.$e.length) {\n            this.embeddedPosition.toTop -= this.embeddedScrollData.footer.h;\n        }\n        \n        // Ensure Link stays within Top Bounds of Frame\n        if (this.embeddedPosition.toTop < this.embeddedScrollData.toTop.o) { this.embeddedPosition.toTop = this.embeddedScrollData.toTop.o; }\n        \n        // Ensure Link stays within Bottom Bounds of Frame\n        if (this.embeddedPosition.toTop + this.embeddedScrollData.toTop.h + 45 > this.documentHeight) {\n            this.embeddedPosition.diff = this.embeddedPosition.toTop + this.embeddedScrollData.toTop.h + 45 - this.documentHeight;\n            this.embeddedPosition.toTop -= this.embeddedPosition.diff;\n        }\n        this.embeddedPosition.toTop = this.embeddedPosition.toTop | 0;\n        \n        // Don't Animate if Link hasn't Moved\n        if (this.embeddedPosition.toTop !== this.embeddedScrollData.toTop.p) {\n            this.embeddedScrollData.toTop.p = this.embeddedPosition.toTop;\n            \n            // Slide Behavior\n            if (Hubs.Config.embedOptions.revealBehaviour === 'slide') {\n                this.embeddedScrollData.toTop.$e.stop().animate({'top': this.embeddedPosition.toTop}, this.animDuration.slide);\n            }\n            \n            // Fade Behavior (with delayed reveal)\n            if (Hubs.Config.embedOptions.revealBehaviour === 'fade') {\n                window.clearTimeout(this.linkPosTimer); \n                this.embeddedScrollData.toTop.$e.stop().animate({'opacity': 0}, this.animDuration.fade.hide, $.proxy(function() {\n                    this.linkPosTimer = window.setTimeout($.proxy(function() {\n                        this.embeddedScrollData.toTop.$e.css({'top': this.embeddedPosition.toTop}).animate({'opacity': 1}, this.animDuration.fade.show);\n                    }, this), this.animDuration.fade.delay);\n                }, this));\n            }\n        }\n    };\n\n    \n    /**\n     * \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.scrollCTAs = function() {\n        // Find Existing Side-CTAs\n        if (!this.embeddedScrollData.cta_s.f) {\n            this.embeddedScrollData.cta_s.$e = $(Hubs.Config.cta.elements.itemCta + ':not(.blocking-cta)');\n            if (this.embeddedScrollData.cta_s.$e.length && !this.embeddedScrollData.cta_s.$e.parents(Hubs.Config.containers.levelThree).length) {\n                this.embeddedScrollData.cta_s.f = true;\n            }\n            if (this.embeddedScrollData.cta_s.f) {\n                this.embeddedScrollData.cta_s.h = this.embeddedScrollData.cta_s.$e.outerHeight(true);\n                if (this.embeddedScrollData.cta_s.h < 50) {\n                    this.embeddedScrollData.cta_s.h = this.embeddedScrollData.cta_s.$e.find('.tile.cta').outerHeight();\n                }\n                this.embeddedScrollData.cta_s.o = this.embeddedScrollData.cta_s.p = 0;\n            }\n        }\n        \n        // Keep Side-CTA in View\n        if (this.embeddedScrollData.cta_s.f) {\n            // Calculate New Position of Side-CTA\n            this.embeddedPosition.cta_s = this.viewportData.scrollTop - this.viewportData.offsetTop + this.embeddedScrollData.cta_s.o;\n            \n            // Ensure Side-CTA stays within Bottom Bounds of Frame\n            if (this.embeddedPosition.cta_s + this.embeddedScrollData.cta_s.h > this.levelThreeBottom) {\n                this.embeddedPosition.diff = this.embeddedPosition.cta_s + this.embeddedScrollData.cta_s.h - this.levelThreeBottom;\n                this.embeddedPosition.cta_s -= this.embeddedPosition.diff;\n            }\n            \n            // Ensure Side-CTA stays within Top Bounds of Frame\n            if (this.embeddedPosition.cta_s < this.embeddedScrollData.cta_s.o) { this.embeddedPosition.cta_s = this.embeddedScrollData.cta_s.o; }\n            \n            // Round to Whole Number\n            this.embeddedPosition.cta_s = this.embeddedPosition.cta_s | 0;\n            \n            // Don't Animate if Side-CTA hasn't Moved\n            if (this.embeddedPosition.cta_s !== this.embeddedScrollData.cta_s.p) {\n                this.embeddedScrollData.cta_s.p = this.embeddedPosition.cta_s;\n                \n                // Slide Behavior Only\n                this.embeddedScrollData.cta_s.$e.stop().animate({'margin-top': this.embeddedPosition.cta_s}, this.animDuration.slide);\n            }\n        }\n        \n        // Find Existing Blocking-CTAs\n        var $documentBlockingCta = $(Hubs.Config.cta.elements.itemBlockCta);\n        if (!this.embeddedScrollData.cta_b.f && !$documentBlockingCta.length) {\n            this.embeddedScrollData.cta_b.$e = $(Hubs.Config.cta.elements.blockCta);\n            if (this.embeddedScrollData.cta_b.$e.length) {\n                this.embeddedScrollData.cta_b.f = true;\n            }\n            if (this.embeddedScrollData.cta_b.f) {\n                this.embeddedScrollData.cta_b.h = this.embeddedScrollData.cta_b.$e.outerHeight(true);\n                if (this.embeddedScrollData.cta_b.h < 50) {\n                    this.embeddedScrollData.cta_b.h = this.embeddedScrollData.cta_b.$e.find('.tile.cta').outerHeight();\n                }\n                if (this.embeddedScrollData.cta_b.o < 1) {\n                    this.embeddedScrollData.cta_b.o = this.embeddedScrollData.sheader.h + 20;\n                }\n            }\n        }\n\n        // Keep Blocking-CTA in View\n        if (this.embeddedScrollData.cta_b.f) {\n            // Calculate New Position of Blocking-CTA\n            this.embeddedPosition.cta_b = this.viewportData.scrollTop - this.viewportData.offsetTop + this.embeddedScrollData.cta_b.o + this.absoluteOffset.top;\n            \n            // Ensure Blocking-CTA stays within Bottom Bounds of Frame\n            if (this.embeddedPosition.cta_b + this.embeddedScrollData.cta_b.h + this.embeddedScrollData.footer.h + 40 > this.documentHeight) {\n                this.embeddedPosition.diff = this.embeddedPosition.cta_b + this.embeddedScrollData.cta_b.h + this.embeddedScrollData.footer.h + 40 - this.documentHeight;\n                this.embeddedPosition.cta_b -= this.embeddedPosition.diff;\n            }\n            \n            // Ensure Blocking-CTA stays within Top Bounds of Frame\n            if (this.embeddedPosition.cta_b < this.embeddedScrollData.cta_b.o) { this.embeddedPosition.cta_b = this.embeddedScrollData.cta_b.o; }\n            \n            // Round to Whole Number\n            this.embeddedPosition.cta_b = this.embeddedPosition.cta_b | 0;\n            \n            // Don't Animate if Blocking-CTA hasn't Moved\n            if (this.embeddedPosition.cta_b !== this.embeddedScrollData.cta_b.p) {\n                this.embeddedScrollData.cta_b.p = this.embeddedPosition.cta_b;\n                \n                // Wait until next event loop before triggering animation\n                Hubs.root.setTimeout($.proxy(function() {\n                    // Slide Behavior Only\n                    this.embeddedScrollData.cta_b.$e.stop().animate({'top': this.embeddedPosition.cta_b}, this.animDuration.slide);\n                }, this), 0);\n            }\n        }\n        \n    };\n\n    \n    /**\n     * \n     * \n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.Embedded.prototype.scrollSharing = function() {\n        // Find Any Existing Share Element\n        if (!this.embeddedScrollData.share.f && Hubs.Config.labOptions.topMenu) {\n            this.embeddedScrollData.share.$e = $('.addthis_toolbox');\n            if (this.embeddedScrollData.share.$e.length) {\n                this.embeddedScrollData.share.f = true;\n            }\n            if (this.embeddedScrollData.share.f) {\n                this.embeddedScrollData.share.h = this.embeddedScrollData.share.$e.outerHeight(true);\n            }\n        }\n        \n        // Keep Share Element in View\n        if (this.embeddedScrollData.share.f) {\n            // Calculate New Position of Sharing Element\n            if (this.embeddedScrollData.share.o < 1) {\n                this.embeddedScrollData.share.o = this.embeddedScrollData.sheader.h + 20;\n                this.embeddedScrollData.share.p = this.embeddedScrollData.share.o;\n            }\n            this.embeddedPosition.share = this.viewportData.scrollTop - this.viewportData.offsetTop + this.embeddedScrollData.share.o + this.absoluteOffset.top;\n            \n            // Ensure Menu stays within Bottom Bounds of Frame\n            if (this.embeddedPosition.share + this.embeddedScrollData.share.h > (this.levelThreeBottom + 160)) {\n                this.embeddedPosition.diff = this.embeddedPosition.share + this.embeddedScrollData.share.h - (this.levelThreeBottom + 160);\n                this.embeddedPosition.share -= this.embeddedPosition.diff;\n            }\n            \n            // Ensure Menu stays within Top Bounds of Frame\n            if (this.embeddedPosition.share < this.embeddedScrollData.share.o) { this.embeddedPosition.share = this.embeddedScrollData.share.o; }\n            \n            // Round to Whole Number\n            this.embeddedPosition.share = this.embeddedPosition.share | 0;\n            \n            // Don't Animate if Menu hasn't Moved\n            if (this.embeddedPosition.share !== this.embeddedScrollData.share.p) {\n                this.embeddedScrollData.share.p = this.embeddedPosition.share;\n                \n                // Slide Behavior Only\n                this.embeddedScrollData.share.$e.stop().animate({'top': this.embeddedPosition.share}, this.animDuration.slide);\n            }\n        }\n    };\n\n    /**\n     * pickEmbedOptionParams():\n     *   Pick embed options from current url's query string and return as an object.\n     *\n     * @public\n     * @this Hubs.App\n     * @return {Object} Embed option key-value pairs\n     */\n    Hubs.Embedded.prototype.pickEmbedOptionParams = function () {\n        var pickEmbedParams = ['embedded', 'offsetTop', 'offsetBottom', 'hideHeader', 'hideBanner',\n            'hideFooter', 'hidePriNav', 'hideSecNav', 'linkBreakOut', 'ignoreLockForPreview'];\n        var currentUrlQuery = this.queryString;\n        var embedParams = {};\n\n        $.each(pickEmbedParams, function (index, optionName) {\n            if (optionName in currentUrlQuery) {\n                embedParams[optionName] = parseInt(currentUrlQuery[optionName], 10);\n            }\n        });\n        return embedParams;\n    };\n    \n}(window.jQuery));\n"},function(t,e,n){n(10)(n(379))},function(t,e){t.exports="(function($, undefined) {\n    \"use strict\";\n\n    /**\n     * Hubs LazyLoader\n     *\n     * @class LazyLoader\n     * @classdesc Application LazyLoader for Infinite Scrolling on Collection Pages\n     * @namespace Hubs\n     * @constructor\n     */\n    Hubs.LazyLoader = function(app) {\n\n        /* **************************************************************************************** */\n        /* * Private Methods/Members Declarations                                                 * */\n        /* **************************************************************************************** */\n        var initialize = null,\n            revertCollectionPage = null,\n            initEvents = null;\n\n\n        /* **************************************************************************************** */\n        /* * Public Properties                                                                    * */\n        /* **************************************************************************************** */\n\n        /** @member {Object} app A reference to the Application Object */\n        this.app              = app;\n\n        /** @member {Object} $container A jQuery Element Handle to the Container DIV of the LazyLoader  */\n        this.$container       = null;\n\n        /** @member {Object} $loadingNotifier A jQuery Element Handle to the Container DIV of the Loading Notifier Box */\n        this.$loadingNotifier = null;\n\n        /** @member {Object} $scrollContainer A jQuery Element Handle to the Container DIV that Scrolls (Window or Other) */\n        this.$scrollContainer = null;\n\n        /** @member {Number} collectionId The ID of the Collection currently being viewed */\n        this.collectionId     = 0;\n\n        /** @member {Number} containerOffset The Top Offset of the Container */\n        this.containerOffset  = 0;\n\n        /** @member {Number} itemCount The Number of Items Currently Displayed */\n        this.itemCount        = 0;\n\n        /** @member {Number} itemSize The Outer Width or Height of an Item in the List */\n        this.itemSize         = 0;\n\n        /** @member {Number} featuredItemsCount The number of featured items */\n        this.featuredItemsCount    = 0;\n\n        /** @member {Number} viewportSize The Width or Height of the Viewport  */\n        this.viewportSize     = 0;\n\n        /** @member {Number} lastItemBounds The X or Y Boundary of the Last Item in the List  */\n        this.lastItemBounds   = 0;\n\n        /** @member {Number} currentPage The Current Page Displayed within the Collection */\n        this.currentPage      = 0;\n\n        /** @member {Number} scrollTop The Current Scroll Top ofthe Window or Parent Window */\n        this.scrollTop        = 0;\n\n        /** @member {Boolean} loadingItems A flag indicating whether Items are currently being loaded or not */\n        this.loadingItems     = false;\n\n        /** @member {Boolean} endOfCollection A flag indicating whether we have reached the end of the collection */\n        this.endOfCollection  = false;\n\n        /** @member {Object} $lastSection A jQuery Element Handle to the section DIV of the LazyLoader  */\n        this.$lastSection = null;\n\n\n        /* **************************************************************************************** */\n        /* * Private Methods/Members                                                              * */\n        /* **************************************************************************************** */\n\n        /**\n         * Initialize the LazyLoader\n         *\n         * @private\n         * @this Hubs.LazyLoader\n         * @return undefined\n         * @constructs\n         */\n        initialize = $.proxy(function() {\n            // Debug Statement\n            Shared.Logger.log('lazy-loader-init');\n\n            // Get Handles to Container Element\n            this.$container = $(Hubs.Config.lazyloader.elements.container);\n            this.$loadingNotifier = $(Hubs.Config.lazyloader.elements.notify);\n            if (!this.$container.length) { return; }\n\n            // Store Reference to Hubs.App\n            this.app = app;\n\n            // Initialize page number from saved collection state\n            revertCollectionPage();\n\n            // Set Default Scroll Container\n            this.$scrollContainer = Shared.$('window');\n\n            // Get Collection ID\n            this.collectionId = this.app.currentCollectionId;\n\n            // Store Top Offset of Container\n            this.containerOffset = (Hubs.Config.lazyloader.direction === Hubs.LAZYLOAD_VERTICAL) ? this.app.$appContainer[0].offsetTop : this.app.$appContainer[0].offsetLeft;\n\n            // Initialize Events\n            initEvents();\n\n            // Debug Statement\n            Shared.Logger.log('lazy-loader-init-end');\n        }, this);\n\n        /**\n         * revertCollectionPage():\n         *   Initialize page number from a previously saved collection state.\n         *\n         * @private\n         * @this Hubs.LazyLoader\n         * @return undefined\n         */\n        revertCollectionPage = $.proxy(function() {\n            var collectionState = this.app.getCollectionState();\n            if (collectionState) {\n                this.currentPage = parseInt(collectionState.page, 10);\n            }\n        }, this);\n\n        /**\n         * Initialize Events for the Hubs LazyLoader\n         *\n         * @private\n         * @this Hubs.LazyLoader\n         * @return undefined\n         */\n        initEvents = $.proxy(function() {\n            // Debug Statement\n            Shared.Logger.log('lazy-loader-events-init');\n\n            // Window Scroll Event\n            Shared.$('window')\n                .on('debouncedresize.Hubs.LazyLoader', $.proxy(this.resizeEvent, this));\n\n            // Set event by loading type\n            if (Hubs.Config.labOptions.loadByButton) {\n                Shared.$('document').on('click.Hubs.LazyLoader', Hubs.Config.lazyloader.elements.loadMore, $.proxy(this.clickEvent, this));\n            } else {\n                Shared.$('window').on('scroll.Hubs.LazyLoader', $.proxy(this.scrollEvent, this));\n            }\n\n            this.app.$appContainer.parent()\n                .on('scroll.Hubs.LazyLoader', $.proxy(this.scrollEvent, this));\n        }, this);\n\n        /* **************************************************************************************** */\n        /* * Entry Point                                                                          * */\n        /* **************************************************************************************** */\n        initialize();\n\n        return this;\n    };\n    // End of Hubs.LazyLoader\n\n\n    /* ******************************************************************************************** */\n    /* * Public Methods                                                                           * */\n    /* ******************************************************************************************** */\n\n\n    /**\n     * Observes and Responds to the Resize Events fired on the Global Window Object\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @param {Object} eventData The Event Data associated with the Event\n     * @return {Boolean} The success state of the event; determines whether to allow event-bubbling\n     */\n    Hubs.LazyLoader.prototype.resizeEvent = function(eventData) {\n        // Debug Statement\n        Shared.Logger.log('lazy-loader-resize');\n\n        // Update Sizes\n        Hubs.root.setTimeout($.proxy(this.updateSizes, this), 250); // just after app resize event\n        return true;\n    };\n\n    /**\n     * Observes and Responds to the Scroll Events fired on the Global Window Object\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @param {Object} eventData The Event Data associated with the Event\n     * @return {Boolean} The success state of the event; determines whether to allow event-bubbling\n     */\n    Hubs.LazyLoader.prototype.scrollEvent = function(eventData, scrollTop, offsetTop, viewportX, viewportY) {\n        // Check for More Pages\n        if (this.loadingItems || this.endOfCollection || Shared.$('body').hasClass('noscroll')) { return; }\n\n        // Debug Statement\n        //Shared.Logger.log('lazy-loader-scroll');\n\n        // Get Handle to Scroll Container\n        if (!Hubs.isEmbedded()) {\n            if (eventData.currentTarget === Hubs.root) {\n                this.$scrollContainer = Shared.$('window');\n            } else {\n                this.$scrollContainer = this.app.$appContainer.parent();\n            }\n        }\n\n        // Get Scroll Top of Current Window\n        this.scrollTop = this.$scrollContainer.scrollTop();\n\n        // Get Scroll Top from Parent Window (if defined)\n        if (scrollTop !== undefined) {\n            this.scrollTop = scrollTop - offsetTop;\n        }\n\n        // Get Parent Window Viewport (if defined)\n        if (viewportX !== undefined && viewportY !== undefined) {\n            this.viewportSize = (Hubs.Config.lazyloader.direction === Hubs.LAZYLOAD_VERTICAL) ? viewportY : viewportX;\n        }\n\n        // Update Sizes to get Last Item Bounds\n        this.updateSizes();\n\n        // Check Boundary to Load More Items\n        this.checkBoundary(false);\n        return true;\n    };\n\n    /**\n     * Observes and Responds to the Click Event fired when the \"load more\" button clicked\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @param {Object} eventData The Event Data associated with the Event\n     * @return undefined\n     */\n    Hubs.LazyLoader.prototype.clickEvent = function(eventData) {\n        var btn = Shared.$('document').find(Hubs.Config.lazyloader.elements.loadMore);\n        // Hide button\n        btn.hide();\n        // Load more items and show button\n        var showBtnCallback = function() {\n            if (this.app.pageType ==  Hubs.PAGE_TYPE_HUB || (this.app.collectionCount > this.app.lazyLoader.itemCount)) {\n                btn.show();\n            }\n        };\n        this.loadItems(false, showBtnCallback.bind(this));\n    };\n\n    /**\n     * Loads the next set of items via Ajax and populates the page with new items\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @return undefined\n     */\n    Hubs.LazyLoader.prototype.loadItems = function(initialLoad, callback) {\n        var data, $items, itemCount;\n        if (this.loadingItems || this.endOfCollection) { return; }\n\n        // Check if We Need to LazyLoad\n        if (!this.checkItemCount()) { return; }\n\n        // Update Loading Flag\n        this.setLoading(true);\n\n        // Change Page based on State\n        try {\n            // Data to Request Next Set of Items\n            data = {\n                'collectionId': this.collectionId,\n                'currentPage': this.currentPage + 1,\n                'limit': Hubs.Config.lazyloader.itemLoadCount,\n                'featuredItemCount': Hubs.Config.lazyloader.featuredItemCount,\n                'embedded': Hubs.isEmbedded() ? 1 : 0\n            };\n            if(this.app.pageType == Hubs.PAGE_TYPE_AUTHOR) {\n                data.authorId = this.app.currentAuthorId;\n            }\n\n            // Check if we need to delay for testing\n            if (Hubs.Config.ajaxResponseDelay !== null) {\n                data = $.extend(true, {}, data, Hubs.Config.ajaxResponseDelay);\n            }\n\n            this.$lastSection = this.$container.find(Hubs.Config.lazyloader.elements.section).last();\n            var lastSectionId = this.$lastSection.attr('id');\n\n            // Fetch Next Set of Items via Ajax\n            Shared.ajaxFetch(Hubs.Config.serverUrl.lazyLoader, data, 'GET', false, $.proxy(function(itemData) {\n                // Clean up Item Data\n                itemData = Shared.trim(itemData);\n\n                // Check if we have more items to display\n                if (!itemData.length) {\n                    // Update Loading Flag\n                    this.setLoading(false);\n                    this.endOfCollection = true;\n                    return;\n                }\n\n                var sectionIndex = $('.collection-section').length;\n                var $sections = $('<div />').append(itemData).find(Hubs.Config.lazyloader.elements.section);\n                // when beta feature is turned on, $sections length should be greater than 0; when it is off, $sections.length == 0\n                if($sections.length > 0) {\n                    $sections.each($.proxy(function(i, el) {\n                        var id = $(el).attr('id');\n                        var $sectionOnPage = $('#'+id);\n                        if (id === lastSectionId) {\n                            $sectionOnPage.find('.collection-section-items').append($(el).find('.tile'));\n                        } else {\n                            var sectionIndexString = 'section-index-' + sectionIndex;\n                            $(el).addClass(sectionIndexString);\n                            $(el).find('.section-index-link').attr('id', sectionIndexString);\n                            sectionIndex = sectionIndex + 1;\n                            if (this.$loadingNotifier.length) {\n                                this.$loadingNotifier.before(el);\n                            } else {\n                                this.$container.append(el);\n                            }\n                        }\n                    }, this))\n                } else {\n                    // Insert Items into Container\n                    if (this.$loadingNotifier.length) {\n                        this.$loadingNotifier.before(itemData);\n                    } else {\n                        this.$container.append(itemData);\n                    }\n                }\n\n                // Check Count of Items\n                this.checkItemCount();\n\n                // Resize All Image Tiles\n                Hubs.updateImageTiles(this.app, '.tile .img');\n\n\t\t\t\t// Run friendly timestamp plugin on new html\n                Hubs.setFriendlyTimestamps();\n\n                // Sets up the form cta handling\n                this.app.initializeFormCtas();\n\n                // Need to resize the CTA text for forms\n                this.app.responsiveCtaText();\n\n                // New CTAs from lazy loader need to be determined if they should be seen\n                this.app.showFormCtas(this.app.lazyLoader, this.app.pageType);\n\n                // Update Links\n                this.app.overrideLinks();\n\n                // Update Sizes and Counts after Adding Items\n                Hubs.root.setTimeout($.proxy(function() {\n                    // Update Sizes to get Last Item Bounds\n                    this.updateSizes();\n\n                    // Increment Current Page\n                    this.currentPage++;\n\n                    // Update page number for collection state\n                    var scrollTop = (this.app.getCollectionState() || {}).scrollTop;\n                    this.app.setCollectionState(this.currentPage, scrollTop);\n\n                    // Update Loading Flag\n                    this.setLoading(false);\n\n                    // Check Boundary to Load More Items\n                    if (initialLoad) {\n                        this.checkBoundary(initialLoad);\n                    }\n\n                    // Internal Callback after Load\n                    if (typeof callback === 'function') {\n                        callback();\n                    }\n\n                    // External Callback after Load\n                    if (typeof Hubs.onItemsLoaded === 'function') {\n                        Shared.onNextEventLoop($.proxy(function() {\n                            var $items = $('<ul/>').append(itemData);\n                            var itemIds = [];\n                            var selector = '', begin = '.tile[data-id=\"', end = '\"]';\n\n                            // Get all Item Ids\n                            $items.find('.tile[data-id]').each($.proxy(function(idx, el) {\n                                itemIds.push( parseInt($(el).attr('data-id') || 0, 10) );\n                            }, this));\n\n                            // Build Element Selector for Querying Elements\n                            selector = begin + itemIds.join(end + ',' + begin) + end;\n\n                            // Call Event Handler passing Item IDs and Selector\n                            Hubs.onItemsLoaded.apply(this.app, [itemIds, selector]);\n\n                            // emit itemsLoaded hub event\n                            Hubs.Events.trigger('itemsLoaded', [itemIds, selector]);\n\n                        }, this));\n                    }\n                }, this), 100);\n            }, this));\n        } catch (e) {\n            // Error Statement\n            if (e instanceof Shared.Exception) {\n                Shared.Logger.log(e);\n            } else {\n                Shared.Logger.log({'msg': 'ajax-failed', 'args': {'reason': e}, 'type': Shared.LVL_ERROR});\n            }\n        }\n    };\n\n    /**\n     * Update the Size and Boundary of the Last Item in the List\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @return undefined\n     */\n    Hubs.LazyLoader.prototype.updateSizes = function() {\n        // Get Last Item in List\n        var $allItems = this.$container.find(Hubs.Config.lazyloader.elements.item),\n            $lastItem = ($allItems.length) ? $($allItems[$allItems.length-1]) : $allItems,\n            pos = null;\n\n        if (!$lastItem.length) { return; }\n\n        // Get Number of Items\n        this.itemCount = $allItems.length;\n\n        // Get Top Offset of Container\n        this.containerOffset = (Hubs.Config.lazyloader.direction === Hubs.LAZYLOAD_VERTICAL) ? this.app.$appContainer[0].offsetTop : this.app.$appContainer[0].offsetLeft;\n\n        // Get Size of Viewport\n        if (!Hubs.isEmbedded()) {\n            this.viewportSize = (Hubs.Config.lazyloader.direction === Hubs.LAZYLOAD_VERTICAL) ? Shared.$('window').height() : Shared.$('window').width();\n        }\n\n        // Get Size of Last Item\n        this.itemSize = (Hubs.Config.lazyloader.direction === Hubs.LAZYLOAD_VERTICAL) ? $lastItem.outerHeight() : $lastItem.outerWidth();\n\n        // Get Bounds of Last Item\n        this.lastItemBounds = this.containerOffset;\n        this.lastItemBounds += (Hubs.Config.lazyloader.direction === Hubs.LAZYLOAD_VERTICAL) ? $lastItem[0].offsetTop : $lastItem[0].offsetLeft;\n        this.lastItemBounds += (this.itemSize / 2);\n    };\n\n    /**\n     * Checks the Boundary of the Last Item in the List and Loads More Items if necessary\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @return undefined\n     */\n    Hubs.LazyLoader.prototype.checkBoundary = function(initialLoad) {\n        // Get the ScrollTop for the Container\n        var scrollTop = this.scrollTop + this.viewportSize;\n\n        // Check if we need to Load More Items\n        if (scrollTop > this.lastItemBounds) {\n            this.loadItems(initialLoad);\n        }\n    };\n\n    /**\n     * Checks the Item Count and Cancels LazyLoading if not enough Items\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @return undefined\n     */\n    Hubs.LazyLoader.prototype.checkItemCount = function() {\n        var itemCount = 0,\n            $items = $(Hubs.Config.lazyloader.elements.item + ', ' + Hubs.Config.cta.elements.container);\n\n        itemCount = $items.length;\n        if (itemCount < Hubs.Config.lazyloader.itemDisplayLimit) {\n            this.endOfCollection = true;\n        }\n\n        return !this.endOfCollection;\n    };\n\n    /**\n     * Toggles the display of the Loading More Indicator\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @return undefined\n     */\n    Hubs.LazyLoader.prototype.loadingNotifier = function() {\n        // Build Loading Notifier Element\n        if (this.$loadingNotifier === null || !this.$loadingNotifier.length) {\n            this.$loadingNotifier = $(Hubs.Config.lazyloader.elements.notify);\n            if (!this.$loadingNotifier.length) { return; }\n        }\n\n        // Show/Hide Loading Notifier\n        if (this.loadingItems) {\n            this.$loadingNotifier.show();\n        } else {\n            this.$loadingNotifier.hide();\n        }\n    };\n\n    /**\n     * Set the Loading State for the Loading Notifier\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @return undefined\n     */\n    Hubs.LazyLoader.prototype.setLoading = function(loading) {\n        // Update Loading Flag\n        this.loadingItems = loading;\n\n        // Update Loading Notifier\n        this.loadingNotifier();\n    };\n\n    /**\n     * Completely destroy the iScroll and free some memory\n     *\n     * @public\n     * @this Hubs.LazyLoader\n     * @return undefined\n     */\n    Hubs.LazyLoader.prototype.destroy = function() {\n        // Debug Statement\n        Shared.Logger.log('lazy-loader-destroy');\n\n        // Remove Events that are tied to the Window Object\n        Shared.$('window').off('debouncedresize.Hubs.LazyLoader');\n\n        // Remove event by loading type\n        if (Hubs.Config.labOptions.loadByButton) {\n            Shared.$('document').off('click.Hubs.LazyLoader', Hubs.Config.lazyloader.elements.loadMore);\n        } else {\n            Shared.$('window').off('scroll.Hubs.LazyLoader');\n        }\n    };\n\n}(window.jQuery));\n"},function(t,e,n){n(10)(n(381))},function(t,e){t.exports="(function($, undefined) {\n    \"use strict\";\n    \n    /**\n     * Hubs Search\n     * \n     * @class Search\n     * @classdesc Application Search\n     * @namespace Hubs\n     * @constructor\n     */\n    Hubs.Search = function(app) {\n\n        /* **************************************************************************************** */\n        /* * Private Methods/Members Declarations                                                 * */\n        /* **************************************************************************************** */\n        var initialize    = null;\n        var buildElements = null;\n        var initEvents    = null;\n        \n        /* **************************************************************************************** */\n        /* * Public Properties                                                                    * */\n        /* **************************************************************************************** */\n\n        /** @member {Object} app A reference to the Application Object */\n        this.app = app;\n\n        /** @member {Object} $topNav A jQuery Element Handle to the Top Nav Menu  */\n        this.$topNav       = null;\n        \n        /** @member {Object} $common A Collection of jQuery Element Handles Common Search Elements */\n        this.$common = {\n            'overlay'         : null,       // {Element} The Overlay Element which holds the Search Results and Mobile Drop-Menu Data (Recent)\n            'backdrop'        : null,       // {Element} The Backdrop Element for Setting the Background/Opacity of Search\n            'toggleContainer' : null,       // {Element} The Container Element holding the Search Toggle Button within the Top Nav\n            'toggle'          : null,       // {Element} The Search Toggle Button within the Top Nav\n            'breadcrumbs'     : null,       // {Element} The Breadcrumbs Container\n            'results'         : null        // {Element} The Search Results Container\n        };\n        \n        /** @member {Object} $desktop A Collection of jQuery Element Handles Desktop-Specific Search Elements */\n        this.$desktop = {\n            'menu'      : null,             // {Element} The Drop-Down-Menu available only for Desktop (Recent)\n            'input'     : null,             // {Element} The Input Element only visible for Desktop\n            'close'     : null              // {Element} The Close Button only visible for Desktop\n        };\n        \n        /** @member {Object} $mobile A Collection of jQuery Element Handles Mobile-Specific Search Elements */\n        this.$mobile = {\n            'header'    : null,             // {Element} The Pseudo-Search-Header Element for Mobile \n                                            //    - This is to prevent having a Focusable Element [like <input>] within a Fixed-Position container as iOS goes wonky.\n                                            //      Solution is to have an Absolute-Position container above all, with a Header Section containing Focusable Elements.\n            'input'     : null,             // {Element} The Input Element only visible for Mobile (within Pseudo-Search-Header)\n            'close'     : null              // {Element} The Close Button only visible for Mobile (within Pseudo-Search-Header)\n        };\n        \n        /** @member {Object} searchState A Collection of State-Flags for keeping track of the Various States of Search */\n        this.searchState = {\n            'mobileDisplay' : false,        // {Boolean} True if the Display should be rendered for Mobile Devices\n            'searchOpen'    : false,        // {Boolean} True if the Search Input is Currently Opened\n            'resultsOpen'   : false,        // {Boolean} True if the Search Results Container is Currently Opened\n            'dropMenuOpen'  : false,        // {Boolean} True if the Search DropDown is Currently Opened\n            'hasResults'    : false,        // {Boolean} True if the Search Results Container has actual Search Results\n            'searchStream'  : false         // {Boolean} A flag for Searching within a Stream\n                                            //   - False when Searching from the Home Page of the Hub\n                                            //   - True when Searching from a Stream or Item Page of the Hub, unless the User clicks the \"Home\" link\n                                            //     within the Search Result Breadcrumbs requesting to Search the entire Hub\n        };\n        \n        /** @member {Object} searchData A Collection of Search Data related to the Current Search Action */\n        this.searchData = {\n            'query'         : '',           // {String} The Current Search Query as entered by the User\n            'ajaxUUID'      : null,         // {Number} A unique ID for the AJAX calls so that they can be cancelled\n            'dropMenuTimer' : 0,            // {Number} A timer ID for the delayed Drop Down Menu\n            'results'       : null,         // {Object} A JSON object of the Results from the Search Query\n            'recent'        : []             // {Array} A Cached List of Recent Searches as performed by the User\n                                             //   - This is held in Local Storage or Cookies and Updated after each successful Search Query\n        };\n        \n        \n        /* **************************************************************************************** */\n        /* * Private Methods/Members                                                              * */\n        /* **************************************************************************************** */\n        \n        /**\n         * Initialize the Search Tool\n         * \n         * @private \n         * @this Hubs.Search\n         * @return undefined\n         * @constructs\n         */\n        initialize = $.proxy(function() {\n            // Check if Search is Enabled\n            if (!Hubs.Config.search.enabled) { return; }\n            \n            // Debug Statement\n            Shared.Logger.log('search-init');\n            \n            // Store Reference to Hubs.App\n            this.app = app;\n            \n            // Check the Display State of the Device\n            this.updateDisplayState();\n            \n            // Build Required Elements\n            buildElements();\n            \n            // Initialize Events\n            initEvents();\n            \n            // Get Recent Searches from Storage\n            this.getRecentSearches();\n            \n            // Debug Statement\n            Shared.Logger.log('search-init-end');\n        }, this);\n        \n        \n        /**\n         * Builds and/or gets Handles to the Elements for use with Search\n         *   - Search Input, Drop-Down, Overlays, Results, Breadcrumbs \n         * \n         * @private \n         * @this Hubs.Search\n         * @return undefined\n         */\n        buildElements = $.proxy(function() {\n            var $breadcrumbsContainer = null;\n            var $resultsContainer = null;\n            \n            // Get Handle to Top Nav Element\n            this.$topNav = $(Hubs.Config.containers.topNav);\n            \n            // Get Handle to Search Toggle Container\n            this.$common.toggleContainer = $('.search-container');\n            this.$common.toggle = this.$common.toggleContainer.find('.search-toggle');\n            \n            // Build Search Backdrop\n            this.$common.backdrop = $('<div/>')\n                .addClass('search-results-backdrop')\n                .appendTo(Shared.$('body'));\n            \n            // Build Search Overlay\n            this.$common.overlay = $('<div/>')\n                .addClass('search-results-overlay')\n                .appendTo(Shared.$('body'));\n            \n            // Build Search Results Breadcrumbs\n            $breadcrumbsContainer = $('<div/>').addClass('breadcrumbs-container page-width').appendTo(this.$common.overlay);\n            this.$common.breadcrumbs = $('<div/>').addClass('breadcrumbs page-aligner').appendTo($breadcrumbsContainer);\n            \n            // Build Search Results Container\n            $resultsContainer = $('<div/>').addClass('overlay-scroller page-width').appendTo(this.$common.overlay);\n            this.$common.results = $('<div/>').addClass('results page-aligner').appendTo($resultsContainer);\n            \n            // Desktop Specific Elements\n            this.$desktop.input = this.$common.toggleContainer.find('.search-input input');\n            this.$desktop.close = this.$common.toggleContainer.find('.search-close span');\n            this.$desktop.menu = $('.search-drop-down');\n\n            // Mobile Specific Elements\n            this.$mobile.header = $('.mobile-search-header').prependTo(this.$common.overlay);\n            this.$mobile.input = this.$mobile.header.find('.search-input input');\n            this.$mobile.close = this.$mobile.header.find('.search-close span');\n        }, this);\n        \n        \n        /**\n         * Initialize Events for the Hubs Search Tools\n         *  \n         * @private \n         * @this Hubs.Search\n         * @return undefined\n         */\n        initEvents = $.proxy(function() {\n            // Click Event Handler for Search Toggle Button\n            var searchOpen = $.proxy(function(e) {\n                e.stopPropagation();\n                this.openSearch();\n                return false;\n            }, this);\n            \n            // Click Event Handler for Close Button beside Search Input\n            var searchClose = $.proxy(function(e) {\n                e.stopPropagation();\n                this.closeSearch();\n                return false;\n            }, this);\n            \n            var searchHover = $.proxy(function(e) {\n                if (e.type === 'mouseenter') {\n                    this.$common.toggle.addClass('hover');\n                } else {\n                    this.$common.toggle.removeClass('hover');\n                }\n            }, this);\n            \n            // Focus Event Handler for Search Input\n            var inputFocus = $.proxy(function(e) {\n                e.stopPropagation();\n                e.preventDefault();\n\n                // Only Open DropDown if not already Visible\n                if (!this.searchState.dropMenuOpen && (!this.searchData.query.length)) {\n                    this.openDropDown();\n                }\n            }, this);\n            \n            // KeyUp Event Handler for Search Input\n            var inputKeyup = $.proxy(function(e) {\n                var key = e.which;\n                var $inputEl = $(e.currentTarget);\n                \n                // Store Current Search Query\n                this.searchData.query = $inputEl.val().trim();\n                \n                // Toggle Display of Drop-Down Menu\n                if (!this.searchData.query.length) {\n                    this.openDropDown();\n                } else {\n                    this.closeDropDown();\n                }\n                \n                // Close Search on Escape Key\n                if (key === Shared.KB_ESCAPE) {\n                    this.closeSearch();\n                }\n                \n                // Perform Search on Enter Key\n                if (key === Shared.KB_ENTER && this.searchData.query.length) {\n                    //$inputEl[0].blur();\n                    this.openResults();\n                }\n            }, this);\n\n            // Click Event Handler for Closing Search\n            var docClick = $.proxy(function(e) {\n                // srcElement is an IE thing, will be undefined in most browsers\n                var srcEl = $(e.target || e.srcElement);\n                var classList = srcEl.attr('class');\n                if (classList === undefined) { return true; }\n\n                // For Non-Mobile Devices\n                if (!this.searchState.mobileDisplay) {\n                    // Dont Close if the Element Clicked is NOT the actual Overlay Scroller DIV\n                    if (!/page-aligner|page-width/i.test(classList)) {\n                        return true;\n                    }\n                }\n                \n                // For Mobile Devices\n                else {\n                    // Dont Close if the Element Clicked is NOT the actual Overlay Scroller DIV\n                    if (!/search-results-overlay|overlay-scroller/i.test(classList)) {\n                        return true;\n                    }\n                }\n                \n                // Close Search\n                this.closeSearch();\n            }, this);\n            \n            // Debug Statement\n            Shared.Logger.log('search-events-init');\n\n            // Hook the Click Event on the Search Toggle Button\n            this.$common.toggle.on(Hubs.CLICK_EVENT + '.Search', searchOpen);\n            this.$common.toggle.on('mouseenter.Search mouseleave.Search', searchHover);\n            \n            // Hook the Click Event on the Search Toggle Close Button\n            this.$desktop.close.on(Hubs.CLICK_EVENT + '.Search', searchClose);\n            this.$mobile.close.on(Hubs.CLICK_EVENT + '.Search', searchClose);\n            \n            // Display Drop-Down Menu on Input Focus\n            //   When Search Button is clicked, we programmatically call Focus on the input, bringing us here\n            this.$desktop.input.on('focus.Hubs.Search', inputFocus);\n            this.$mobile.input.on('focus.Hubs.Search', inputFocus);\n            \n            // Hook Key-Press Event of Search Input\n            this.$desktop.input.on('debouncedkeyup.Hubs.Search', inputKeyup);\n            this.$mobile.input.on('debouncedkeyup.Hubs.Search', inputKeyup);\n\n            this.$common.toggle.find('.search-icon').on('click', $.proxy(function(e) {\n                var $expandedContainer = $(e.target).parents('.expanded');\n                var $searchInput = $expandedContainer.find('.search-input>input');\n                var searchValue = $searchInput.val();\n\n                var isSearchExpanded = $expandedContainer.length;\n                var isSearchEmpty = searchValue ? searchValue.trim().length === 0 : true; \n\n                // prevent clicking the button from closing the search input when its open\n                // but don't prevent it from opening if its closed\n                if (isSearchExpanded) {\n                    e.stopPropagation();\n                }\n\n                // if the search input is open, and there is a search, do the search\n                if (isSearchExpanded && !isSearchEmpty) {\n                    this.openResults();\n                }\n            },this))\n            \n            // Close Search Results when Overlay Clicked and Results are Empty\n            Shared.$('document').on(Hubs.CLICK_EVENT + '.Search', docClick);\n        }, this);\n        \n\n        /* **************************************************************************************** */\n        /* * Entry Point                                                                          * */\n        /* **************************************************************************************** */\n        initialize();\n        \n        return this;\n    };\n    // End of Hubs.Search\n\n\n    /* ******************************************************************************************** */\n    /* * Public Methods                                                                           * */\n    /* ******************************************************************************************** */\n    \n        \n    /**\n     * Responds to the Resize Events fired on the App Object\n     * \n     * @public\n     * @this Hubs.Search\n     * @param {Object} eventData The Event Data associated with the Event from the App\n     * @return undefined\n     */\n    Hubs.Search.prototype.resize = function(eventData) {\n        var previousMode = this.searchState.mobileDisplay;\n        \n        // Update Elements after Resize Event\n        var updateElements = $.proxy(function() {\n            // Check the Display State of the Device\n            this.updateDisplayState();\n            \n            // Update Size of Overlay to Match Viewport\n            this.updateOverlaySize();\n            \n            // Update Position of Drop Down\n            if (this.searchState.dropMenuOpen) {\n                this.updateDropMenuPosition(10);\n            }\n            \n            // Update Position of Results for Embedded Hubs\n            Shared.onNextEventLoop(function() {\n                this.updateResultsPosition();\n                this.updateResultsSize();\n            }, this, 100);\n        }, this);\n        \n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-resize');\n        \n        // Check if Mobile Mode has Changed\n        if (this.useMobileDisplay() !== previousMode) {\n            this.closeSearch().then(updateElements);\n        } else {\n            updateElements();\n        }\n    };\n\n    /**\n     * Responds to the Scroll Events fired on the App Object\n     * \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.scroll = function(scrollTop, offsetTop, viewportX, viewportY) {\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled || this.searchState.mobileDisplay) { return; }\n        \n        // Debug Statement\n        //Shared.Logger.log('search-scroll');\n        \n        // Close DropDown when Permenent Header is Enabled\n        if (Hubs.Config.labOptions.permHeader && !Hubs.Config.labOptions.navAlwaysTop) {\n            this.closeDropDown();\n        }\n    };\n\n    /* ******************************************************************************************** */\n\n    /**\n     * Opens the Search Query Input Field when a User clicks on the Search Icon\n     * \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.openSearch = function() {\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled || this.searchState.searchOpen) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-open');\n        \n        // Track State of Search\n        this.searchState.searchOpen = true;\n\n        // For Non-Mobile Displays\n        if (!this.searchState.mobileDisplay) {\n            // Disable Top Nav (if exists)\n            this.$topNav.addClass('disabled');\n            \n            // Expand the Search Input\n            this.$common.toggle.addClass('expanded');\n            \n            // Focus on Input Element\n            this.$desktop.input[0].focus();\n        }\n        \n        // For Mobile Displays\n        else {\n            // Freeze Body Scrolling\n            Hubs.restrictBodyScroll(this.app.viewportData.scrollTop);   // Pass in Embedded scrollTop in case we are Embedded\n            \n            // If Overlay is not Visible, Display the Overlay\n            this.displayResultsContainer();\n            \n            // Focus on Input Element\n            if (!Shared.IOS) {\n                this.$mobile.input[0].focus();\n            }\n        }\n    };\n    \n    /**\n     * Closes the Search Query Input Field, as well as any Results and Drop-Downs displayed\n     * \n     * @public\n     * @this Hubs.Search\n     * @return {Object} A Promise\n     */\n    Hubs.Search.prototype.closeSearch = function() {\n        var deferred = Q.defer();\n        \n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled || !this.searchState.searchOpen) { \n            deferred.resolve('closed');\n            return deferred.promise; \n        }\n        \n        // Debug Statement\n        Shared.Logger.log('search-close');\n        \n        // Kill DropDown Display Timer\n        if (this.searchData.dropMenuTimer) {\n            Hubs.root.clearTimeout(this.searchData.dropMenuTimer);\n        }\n\n        // For Non-Mobile Displays\n        if (!this.searchState.mobileDisplay) {\n            // Restore Top Nav (if exists)\n            this.$topNav.removeClass('disabled');\n            \n            // Collapse the Search Input\n            this.$common.toggle.removeClass('expanded');\n            \n            // Clear Search Input\n            this.$desktop.input.val('');\n        }\n        \n        // For Mobile Displays\n        else {\n            // Hide the Overlay\n            this.hideResultsContainer();\n            \n            // Clear Search Input\n            this.$mobile.input.val('');\n            \n            // Restore Body Scrolling\n            Hubs.restoreBodyScroll();\n        }\n        \n        // Clear Search Query\n        this.searchData.query = '';\n        \n        // Reset Search Scope\n        this.searchState.searchStream = true; \n        \n        // Delay Closing to prevent race condition with open timer\n        Shared.onNextEventLoop(function() {\n            // Close Drop Down (if open)\n            this.closeDropDown();\n            \n            // Close Results\n            this.closeResults();\n            \n            // Track State of Search\n            this.searchState.searchOpen = false;\n            \n            // Resove Promise\n            deferred.resolve('closed');\n        }, this, 100);\n        \n        return deferred.promise;\n    };\n    \n    /**\n     * Opens the Search Drop-Down and Populates it with Recent Searches\n     * \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.openDropDown = function() {\n        var displayOpacity = 1;\n        if (!Hubs.Config.search.enabled || !this.searchState.searchOpen) { return; }\n        \n        // For Non-Mobile Displays\n        if (!this.searchState.mobileDisplay) {\n            // Empty Scroller Element\n            this.$desktop.menu.find('.overlay-scroller').empty();\n            \n            // Populate the Drop-Down Menu\n            this.populateDropDown().then($.proxy(function() {\n                // Display Drop Down if it has Content\n                if (this.$desktop.menu.find('.overlay-scroller .search-result-section').length && this.$desktop.menu.css('display') === 'none') {\n                    // Debug Statement\n                    Shared.Logger.log('search-open-dropdown');\n                      \n                    // Update Position of Drop Down\n                    //   - Note: 200ms = CSS Transition Timer\n                    this.updateDropMenuPosition(250).then($.proxy(function() {\n                        // Show Drop Down Menu\n                        this.$desktop.menu.css({'display': 'block'});\n                        Shared.animate(this.$desktop.menu.stop(), {'opacity': displayOpacity}, 200);\n                        \n                        // Track State of Search\n                        this.searchState.dropMenuOpen = true;\n                    }, this));\n                }\n            }, this));\n        }\n\n        // For Mobile Displays\n        else {\n            if (this.searchState.resultsOpen && this.searchState.hasResults) { return; }\n            \n            // Determine Display Opacity\n            displayOpacity = 0.9;\n            \n            // Empty out Results Section\n            this.$common.results.empty();\n            \n            // Hide Breadcrumbs and Mark as Search-Menu for Styling\n            this.$common.overlay.addClass('no-breadcrumbs as-search-menu');\n\n            // Populate the Drop-Down Menu\n            this.populateDropDown().then($.proxy(function() {\n                // Track State of Search\n                this.searchState.dropMenuOpen = true;\n            }, this));\n        }\n    };\n    \n    /**\n     * Closes the Search Drop-Down\n     * \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.closeDropDown = function() {\n        if (!Hubs.Config.search.enabled || !this.searchState.dropMenuOpen) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-close-dropdown');\n        \n        // For Non-Mobile Displays\n        if (!this.searchState.mobileDisplay) {\n            // Hide Drop Down\n            Shared.animate(this.$desktop.menu.stop(), {'opacity': 0}, 200, $.proxy(function() {\n                this.$desktop.menu.css({'display': 'none'}).find('.overlay-scroller').empty();\n                \n                // Track State of Search\n                this.searchState.dropMenuOpen = false;\n            }, this));\n        }\n\n        // For Mobile Displays\n        else {\n            // Remove Search Menu Marking\n            this.$common.overlay.removeClass('as-search-menu');\n            \n            // Empty out Results Section\n            this.$common.results.empty();\n            \n            // Track State of Search\n            this.searchState.dropMenuOpen = false;\n        }\n    };\n    \n    /**\n     * Temporarily Hides the Search Drop-Down\n     *   - this is only for desktop displays, not for mobile\n     * \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.hideDropDown = function() {\n        if (!Hubs.Config.search.enabled || this.searchState.mobileDisplay || this.$desktop.menu.css('display') !== 'block') { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-hide-dropdown');\n        \n        // If the Menu is Still technically open, try to Reveal it after the Share Menu closes\n        var attemptReveal = $.proxy(function() {\n            if (this.$desktop.menu.css('display') !== 'block') { return; }\n            \n            // If Search was Closed while DropDown was Hidden, Close it\n            if (!this.searchState.searchOpen) {\n                this.closeDropDown();\n            } else {\n                // If Share Menu is no longer open, reveal the DropDown Menu\n                if (!$('.share-hub, .share-item').is(':visible')) {\n                    Shared.animate(this.$desktop.menu.stop(), {'opacity': 1}, 200);\n                } else {\n                    Hubs.root.setTimeout(attemptReveal, 300);\n                }\n            }\n        }, this);\n        \n        // Hide Drop Down\n        Shared.animate(this.$desktop.menu.stop(), {'opacity': 0}, 200, $.proxy(function() {\n            Hubs.root.setTimeout(attemptReveal, 500);\n        }, this));\n    };\n    \n    /**\n     * Open the Search Result Overlays and Initiate Search\n     *   Only Called when the User presses \"Enter\" on the Search Field or Clicks a Recent Search\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.openResults = function() {\n        var resultsTop = 0;\n        \n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Track State of Search\n        this.searchState.resultsOpen = true;\n        \n        // Close Drop-Down Menu\n        this.closeDropDown();\n        \n        // Save Search Query for \"Recent Searches\"\n        this.addRecentSearch();\n        \n        // Freeze Body Scrolling\n        Hubs.restrictBodyScroll(this.app.viewportData.scrollTop);   // Pass in Embedded scrollTop in case we are Embedded\n\n        // If Overlay is not Visible, Display the Overlay\n        this.displayResultsContainer();\n        \n        // Initiate the Search and Update Elements\n        this.initiateSearch();\n        \n        // Chrome on iOS doesn't update element size/positions\n        //   causing some elements to appear as Ghosts that can't be\n        //   interacted with.  So we force a fake screen scroll to\n        //   trigger a re-calc of the layout.\n        if (Shared.CriOS) {\n            Shared.onNextEventLoop(function() {\n                Shared.scrollTop(Shared.scrollTop() + 1);\n                Shared.scrollTop(Shared.scrollTop() - 1);\n            }, this);\n        }\n    };\n    \n    /**\n     * Closes the Search Result Overlays\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.closeResults = function() {\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-close-results');\n        \n        // Hide Results Container\n        this.hideResultsContainer();\n        \n        // Empty out Results Section\n        this.$common.breadcrumbs.empty();\n        this.$common.results.empty();\n        \n        // Restore Body Scrolling\n        Hubs.restoreBodyScroll();\n        \n        // Track State of Search\n        this.searchState.resultsOpen = false;\n    };\n\n    /* ******************************************************************************************** */\n\n    /**\n     * Populates the Search Drop-Down\n     *   If the Search Query is blank, gets the Recent Searches\n     *   If the Search Query is not blank, it will fetch nothing\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return {Object} A Promise\n     */\n    Hubs.Search.prototype.populateDropDown = function() {\n        var promise = null;\n        \n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // If there has been no promise created, let's create one, so that we can maintain\n        // asynchronous code.  The callee expects a promise returned anyway, so in this\n        // scenario we create and immediately resolve a promise for the callee.\n        if (promise === null) {\n            promise = Q.Promise(function(resolve, reject, notify) {\n                resolve(true);\n            });\n        }\n        \n        // Handle the Promise locally first to finishing Populating the Drop-Down\n        promise.then($.proxy(function resolveSuccess(response) {\n            this.updateRecentSearches();\n        }, this));\n\n        // Return the Promise to the callee\n        return promise;\n    };\n    \n    /**\n     * Initiates a Search for the Search Query\n     *   Updates Breadcrumbs and Seach Results\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.initiateSearch = function() {\n        // After Search, Remove Loading State and Update Search Results\n        var afterSearch = $.proxy(function(response) {\n            // Set Loading State\n            this.setLoadingState(this.$common.backdrop, false);\n            \n            // Update Search Result Listings\n            this.updateSearchResults(response);\n        }, this);\n        \n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-initiate');\n        \n        // Empty Results Container\n        this.$common.results.empty();\n        \n        // Blur Input Element to Hide Virtual Keyboard\n        if (this.searchState.mobileDisplay) {\n            this.$mobile.input[0].blur();\n        }\n        \n        // Set Loading State\n        this.setLoadingState(this.$common.backdrop, true);\n        \n        // Update Breadcrumbs for Current Hub Section\n        this.updateBreadcrumbs();\n\n        // Perform Search\n        this.performSearch().then(\n            $.proxy(function searchSuccess(response) {\n                afterSearch(response.response.searchResults.results);\n            }, this),\n\n            $.proxy(function searchFailure(reason) {\n                reason = $.parseJSON(reason);\n                Shared.Logger.log({'msg': 'ajax-failed', 'args': {'reason': reason.meta.error.generic[0]}, 'type': Shared.LVL_ERROR});\n                afterSearch(reason);\n            }, this)\n        );\n    };\n    \n    /**\n     * Perform Search via AJAX\n     * \n     * @public\n     * @this Hubs.Search\n     * @return {Object} A Promise\n     */\n    Hubs.Search.prototype.performSearch = function() {\n        var deferred = Q.defer();\n        var searchData = null;\n        var streamId = '';\n\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log({'msg': 'search-perform-search', 'args': {}});\n        \n        // Searching from a Stream or Item Page (If allowed by Scope)\n        if (this.app.pageType !== Hubs.PAGE_TYPE_HUB && this.searchState.searchStream) {\n            streamId = this.app.currentCollectionId;\n        }\n        \n        // Get Data for Search\n        searchData = {\n            'q'   : this.searchData.query, \n            'sid' : streamId\n        };\n        \n        // Cancel any Previous AJAX Requests\n        Shared.cancelAjax(this.searchData.ajaxUUID);\n        \n        // Initiate AJAX Request for Search\n        this.searchData.ajaxUUID = Shared.ajaxFetch(Hubs.Config.serverUrl.search, searchData, 'POST', true,\n            function successCallback(response) {\n                deferred.resolve(response);\n            },\n            function errorCallback(jqXhr) {\n                deferred.reject(jqXhr.responseText);\n            }\n        );\n        \n        return deferred.promise;\n    };\n\n    /* ******************************************************************************************** */\n    \n    /**\n     * Displays the Results Overlay and Backdrop\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.displayResultsContainer = function() {\n        if (this.$common.overlay.css('display') !== 'none') { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-open-results');\n        \n        // Show Backdrop & Overlay for Search Results\n        this.$common.overlay.css({'display': 'block'});\n        this.$common.backdrop.css({'display': 'block'});\n        Shared.animate(this.$common.overlay.stop(), {'opacity': 1.0}, 150);\n        Shared.animate(this.$common.backdrop.stop(), {'opacity': 0.9}, 150);\n        \n        // Update Size of Overlay to Match Viewport\n        this.updateOverlaySize();\n        \n        // Update Position of Results for Embedded Hubs\n        this.updateResultsPosition();\n        this.updateResultsSize();\n        \n        // Mark Body as Having Search Results Open\n        Shared.$('body').addClass('search-results-opened');\n    };\n    \n    /**\n     * Hides the Results Overlay and Backdrop\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.hideResultsContainer = function() {\n        if (this.$common.overlay.css('display') === 'none') { return; }\n        \n        // Hide Backdrop & Overlay Elements\n        this.$common.backdrop.css({'display': 'none', 'opacity': 0});\n        this.$common.overlay.css({'display': 'none', 'opacity': 0});\n        \n        // Mark Body as Not Having Search Results Open\n        Shared.$('body').removeClass('search-results-opened');\n    };\n\n    /**\n     * Repositions the Desktop DropMenu to align with the Search Input\n     * \n     * @public\n     * @this Hubs.Search\n     * @param {Number} delay (Optional) A delay to wait in milliseconds before updating the Position of the DropDown Menu \n     * @return {Object} A Promise\n     */\n    Hubs.Search.prototype.updateDropMenuPosition = function(delay) {\n        var deferred = Q.defer();\n        var dropMenuTop = 0;\n        var dropMenuLeft = 0;\n        \n        // DropDown Menu is does not need Positioning in Mobile \n        if (this.searchState.mobileDisplay) {\n            deferred.resolve(true);\n            return deferred.promise;\n        }\n        \n        // Update Position of Drop Down\n        Shared.onNextEventLoop(function() {\n            // Determine Correct Left Position\n            dropMenuLeft = this.$common.toggleContainer.offset().left;\n            this.$desktop.menu.css({'left': dropMenuLeft});\n            \n            // Determine Correct Top Position for Embedded Hub\n            if (Hubs.isEmbedded() || Shared.IOS8) {\n                dropMenuTop = parseInt(this.$topNav.css('top') || 0, 10) + parseInt(this.$topNav.height() || 0, 10) + 10;\n                this.$desktop.menu.css({'top': dropMenuTop});\n            }\n            \n            // Resolve Promise\n            deferred.resolve(true);\n        }, this, delay || 0);\n        \n        return deferred.promise;\n    };\n    \n    /**\n     * Updates the Position of the Search Overlay Element\n     *   - Happens when the Overlay is Displayed or the App is resized/reoriented\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.updateOverlaySize = function() {\n        var top, height;\n        if (this.$common.overlay.css('display') === 'none') { return; }\n        \n        if (this.searchState.mobileDisplay) {\n            top = Math.max(Shared.scrollTop(), 0 - parseInt(Shared.$('body').css('top'), 10));\n            height = Shared.$('window').height();\n            this.$common.overlay.css({'position': 'absolute', 'top': top, 'height': height});\n            this.$common.backdrop.css({'position': 'absolute', 'top': top, 'height': height});\n        } else {\n            top = this.$topNav.height();\n            this.$common.overlay.css({'position': 'fixed', 'top': top});\n            this.$common.backdrop.css({'position': 'fixed', 'top': top});\n        }\n    };\n    \n    /**\n     * Embedded Only: Updates the Position of the Search Results Overlay and Backdrop when the user scrolls on an Embedded Hub\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.updateResultsPosition = function() {\n        if (!Hubs.Config.search.enabled || !Hubs.isEmbedded() || this.$common.overlay.css('display') === 'none') { return; }\n        \n        // Update Position of results\n        Shared.onNextEventLoop(function() {\n            var resultsTop = parseInt(this.$topNav.css('top') || 0, 10);\n            if (this.searchState.mobileDisplay) {\n                // Add top position of the body\n                resultsTop += Math.abs(parseInt(Shared.$('body').css('top') || 0, 10));\n            }\n            else {\n                //added topnav height to prevent covering of search bar on desktop embedded hub\n                resultsTop += this.$topNav.height();\n            }\n            this.$common.overlay.css({'top': resultsTop});\n            this.$common.backdrop.css({'top': resultsTop});\n        }, this);\n    };\n    \n    /**\n     * Embedded Only: Updates the Size of the Search Results Overlay and Backdrop when the user scrolls on an Embedded Hub\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.updateResultsSize = function() {\n        if (!Hubs.Config.search.enabled || !Hubs.isEmbedded() || this.$common.overlay.css('display') === 'none') { return; }\n        \n        // Update Position of results\n        Shared.onNextEventLoop(function() {\n            var resultsHeight = Shared.$('window').height();\n            this.$common.overlay.css({'height': resultsHeight});\n            this.$common.backdrop.css({'height': resultsHeight});\n        }, this);\n    };\n\n    /* ******************************************************************************************** */\n\n    /**\n     * Update the Breadcrumbs for the Current Search Query\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.updateBreadcrumbs = function() {\n        var $homeLink = null;\n        var $streamLink = null;\n        var streamLabel = '';\n        var isHomeActive = true;\n\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-update-breadcrumbs');\n        \n        // Empty Breadcrumbs\n        this.$common.breadcrumbs.empty();\n        \n        // No Breadcrumbs for Searches Initiated from Hub-Home\n        if (this.app.pageType === Hubs.PAGE_TYPE_HUB || this.app.collectionType === 'social' || this.app.pageType === Hubs.PAGE_TYPE_PRIVACY) {\n            this.$common.overlay.addClass('no-breadcrumbs');\n            return;\n        } else {\n            this.$common.overlay.removeClass('no-breadcrumbs');\n        }\n        \n        // Build \"Home\" Link\n        $homeLink = $('<a nohref/>').addClass('home').html(Hubs.Config.search.labels.searchAllContent);\n        \n        // Attach Click Handler\n        $homeLink.on(Hubs.CLICK_EVENT + '.Search', $.proxy(function(e) {\n            e.stopPropagation();\n            if (this.app.pageType !== Hubs.PAGE_TYPE_HUB && this.searchState.searchStream) {\n                // Search Entire Hub, not just Current Stream \n                this.toggleStreamSearch(false);\n            }\n            return false;\n        }, this));\n        \n        // Searching from a Stream or Item Page\n        if (this.app.pageType !== Hubs.PAGE_TYPE_HUB) {\n            // Get the Label for the Current Stream\n            if (this.app.pageType === Hubs.PAGE_TYPE_COLLECTION) {\n                streamLabel = $('h1.hub-heading').html();\n            }\n            if (this.app.pageType === Hubs.PAGE_TYPE_ITEM) {\n                streamLabel = $('#hubs-container .bread-crumbs a[data-page-title]').eq(1).attr('data-page-title');\n            }\n            \n            // Build \"Stream\" Link\n            $streamLink = $('<a nohref/>').addClass('stream').html(streamLabel);\n            \n            // Attach Click Handler\n            $streamLink.on(Hubs.CLICK_EVENT + '.Search', $.proxy(function(e) {\n                e.stopPropagation();\n                if (!this.searchState.searchStream) {\n                    // Search Current Stream, not Entire Hub \n                    this.toggleStreamSearch(true);\n                }\n                return false;\n            }, this));\n            \n            // Toggle Active Link\n            isHomeActive = !this.searchState.searchStream;\n        }\n        \n        // Empty Breadcrumbs and Append Home Link\n        this.$common.breadcrumbs.empty().append('<span>' + Hubs.Config.search.labels.searchPlaceholder + ':</span>').append($homeLink);\n        \n        // Append Current Stream Link\n        if (this.app.pageType !== Hubs.PAGE_TYPE_HUB) {\n            this.$common.breadcrumbs.append($streamLink);\n        }\n        \n        // Mark Active Link\n        if (isHomeActive) {\n            // Make Home Link \"Active\"\n            $homeLink.addClass('active');\n            if ($streamLink && $streamLink.length) {\n                $streamLink.removeClass('active');\n            }\n        } else {\n            // Make Stream Link \"Active\"\n            if ($streamLink && $streamLink.length) {\n                $streamLink.addClass('active');\n            }\n            $homeLink.removeClass('active');\n        }\n    };\n    \n    /**\n     * Update the Search Results List for the Current Search Query\n     *   \n     * @public\n     * @this Hubs.Search\n     * @param {Object} results The results data returned from the Search via AJAX \n     * @return undefined\n     */\n    Hubs.Search.prototype.updateSearchResults = function(results) {\n        var i, t, totalCount = 0;\n        var sectionTypes = ['blogs', 'docs', 'videos'];\n\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-update-results');\n        \n        // Invalid Results; Parse Error Message\n        if (results && results.meta && results.meta.error) {\n            // Add \"No Items\" Class\n            this.$common.results.addClass('no-items-found');\n\n            // No Items Found Message\n            $('<div/>')\n                .addClass('no-items-found')\n                .html(results.meta.error.generic[0])\n                .appendTo(this.$common.results);\n            \n            // Track State of Results\n            this.searchState.hasResults = false;\n        }\n        \n        // Valid Results\n        else {\n            if (results === undefined) { results = {}; }\n            for (i = 0; i < sectionTypes.length; i++) {\n                if (results[sectionTypes[i]] === undefined) { results[sectionTypes[i]] = {'total': 0}; }\n            }\n            \n            // Store Results\n            this.searchData.results = $.extend(true, {}, results);\n            \n            // Calculate Total Results\n            for (i = 0; i < sectionTypes.length; i++) {\n                totalCount += results[sectionTypes[i]].total;\n                \n                // We only want to display the first few results, so truncate the array items\n                //  Full Original Results stored in this.searchData.results\n                if (results[sectionTypes[i]].items !== undefined) {\n                    results[sectionTypes[i]].items.splice(Math.min(results[sectionTypes[i]].items.length, Hubs.SEARCH_DISPLAY_INITIAL), Number.MAX_VALUE);\n                }\n            }\n            \n            if (totalCount > 0) {\n                // Remove \"No Items\" Class\n                this.$common.results.removeClass('no-items-found');\n                \n                // Populate Results List\n                for (i = 0; i < sectionTypes.length; i++) {\n                    this.addResultsList(sectionTypes[i],  Hubs.Config.search.labels[sectionTypes[i]] + ' (' + results[sectionTypes[i]].total + ')',   results);\n                }\n                \n                // Track State of Results\n                this.searchState.hasResults = true;\n            } else {\n                // Add \"No Items\" Class\n                this.$common.results.addClass('no-items-found');\n                \n                // Searching from a Stream or Item Page (If allowed by Scope)\n                if (this.app.pageType !== Hubs.PAGE_TYPE_HUB && this.searchState.searchStream && this.app.collectionType !== 'social') {\n                    // No Items Found in Stream Message\n                    $('<div/>')\n                        .addClass('no-items-found')\n                        .html(Hubs.Config.search.labels.noItemsStream)\n                        .appendTo(this.$common.results);\n                    \n                    // Button: Search Entire Hub\n                    $('<a nohref/>')\n                        .addClass('search-entire-hub')\n                        .html('<span></span>' + Hubs.Config.search.labels.searchEntireHub)\n                        .appendTo(this.$common.results)\n                        .on(Hubs.CLICK_EVENT + '.Search', $.proxy(function(e) {\n                            e.stopPropagation();\n                            // Search Entire Hub, not just Current Stream \n                            this.toggleStreamSearch(false);\n                            return false;\n                        }, this));\n                } else {\n                    // No Items Found Message\n                    $('<div/>')\n                        .addClass('no-items-found')\n                        .html(Hubs.Config.search.labels.noItems)\n                        .appendTo(this.$common.results);\n                }\n                \n                // Track State of Results\n                this.searchState.hasResults = false;\n            }\n        }\n    };\n    \n    /**\n     * Fetches More Results for a Category (Blogs, Docs, Videos) when the \"See More\" button is clicked from the Search Results\n     *   \n     * @public\n     * @this Hubs.Search\n     * @param {Object} $seeMoreLink A jQuery Element Handle to the \"See More\" Link that was clicked\n     * @param {Object} $list A jQuery Element Handle to the List to populate\n     * @param {Object} $content A jQuery Element Handle to the Container of the List\n     * @param {String} containerType The type of Container (Blogs, Docs, Videos) being Updated\n     * @param {Number} nextOffset The offset of the Results to fetch\n     * @return undefined\n     */\n    Hubs.Search.prototype.seeMoreResults = function($seeMoreLink, $list, $content, containerType, nextOffset) {\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Set Loading State on Link\n        $seeMoreLink.addClass('loading');\n        \n        // Get Copy of Results from Stored Results Object\n        var listData = $.extend(true, {}, this.searchData.results);\n\n        // Display More Results\n        if (listData[containerType].items.length > nextOffset) {\n            // Copy Subset of Results\n            listData[containerType].items = listData[containerType].items.slice(nextOffset, nextOffset + Hubs.SEARCH_DISPLAY_INTERVAL);\n            listData[containerType].offset = nextOffset;\n            \n            // Append Results to List Element\n            this.appendFormattedResults($list, $content, listData, containerType);\n        } \n        \n        // No More Results to Display\n        else {\n            $seeMoreLink.remove();\n        }\n    };\n\n    /* ******************************************************************************************** */\n\n    /**\n     * Adds a Sectional List of Results to the Drop-Down Menu\n     *   \n     * @public\n     * @this Hubs.Search\n     * @param {String} containerClass The CSS Classname for the Sectional List\n     * @param {String} headerLabel The Header Label for the Sectional List\n     * @param {Array} listItems The Items to Populate the List with\n     * @return undefined \n     */\n    Hubs.Search.prototype.addDropMenuList = function(containerClass, headerLabel, listItems) {\n        var $container = null;\n        var $header = null;\n        var $content = null;\n        var $list = null;\n        var $link = null;\n        \n        var clickHandler = $.proxy(function(listItem) { \n            return $.proxy(function(e) {\n                e.stopPropagation();\n                \n                // Store Current Search Query\n                this.searchData.query = listItem;\n                \n                // Update Search Input Box\n                if (this.searchState.mobileDisplay) {\n                    this.$mobile.input.val(listItem);\n                } else {\n                    this.$desktop.input.val(listItem);\n                }\n                \n                // Open Search Results and Perform Search\n                this.openResults();\n                \n                return false;\n            }, this);\n        }, this);\n\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Create Recent Searches Section \n        // Section Container\n        $container = $('<div/>')\n            .addClass('search-result-section')\n            .addClass(containerClass);\n        \n        // Section Header\n        if (headerLabel.length) {\n            $header = $('<div/>')\n                .addClass('section-header')\n                .append('<h2>' + headerLabel + '</h2>')\n                .appendTo($container);\n        }\n        \n        // Section Content\n        $content = $('<div/>')\n            .addClass('section-content')\n            .appendTo($container);\n        \n        // List Element\n        $list = $('<ul/>')\n            .appendTo($container);\n        \n        // Build List of Recent Searches\n        for (var i = 0; i < listItems.length; i++) {\n            if (!listItems[i] || !listItems[i].length) { continue; }\n            \n            // Build Link Element\n            $link = $('<a nohref/>')\n                .append($('<span/>').addClass('search-icon'))\n                .append(Shared.jhe(listItems[i]))\n                .on(Hubs.CLICK_EVENT + '.Search', clickHandler(listItems[i]));\n            \n            // Append Link to List\n            $('<li/>').append($link).appendTo($list);\n        }\n        $content.append($list);\n        \n\n        // For Non-Mobile Displays\n        if (!this.searchState.mobileDisplay) {\n            // Append Content to Drop Down Menu\n            this.$desktop.menu.find('.overlay-scroller').append($container);\n        }\n        \n        // For mobile Displays\n        else {\n            // Append Content to Results Container\n            this.$common.results.append($container);\n        }\n        \n        return true;\n    };\n    \n    /**\n     * Adds a Sectional List of Results to the Results Overlay\n     *   \n     * @public\n     * @this Hubs.Search\n     * @param {String} containerType The CSS Classname for the Sectional List\n     * @param {String} headerLabel The Header Label for the Sectional List\n     * @param {Object} listData The Item-Data to Populate the List with\n     * @return undefined \n     */\n    Hubs.Search.prototype.addResultsList = function(containerType, headerLabel, listData) {\n        var $container = null;\n        var $header = null;\n        var $content = null;\n        var $list = null;\n        var streamData = listData[containerType];\n\n        if (!Hubs.Config.search.enabled || !streamData.items || !streamData.items.length) { return; }\n\n        // Create Recent Searches Section \n        // Section Container\n        $container = $('<div/>')\n            .addClass('search-result-section')\n            .addClass(containerType + '-items');\n        \n        // Section Header\n        $header = $('<div/>')\n            .addClass('section-header')\n            .append('<h2>' + headerLabel + '</h2>')\n            .appendTo($container);\n        \n        // Section Content\n        $content = $('<div/>')\n            .addClass('section-content')\n            .appendTo($container);\n        \n        // List Element\n        $list = $('<ul/>')\n            .appendTo($container);\n\n        // Append Results to List Element\n        this.appendFormattedResults($list, $content, listData, containerType);\n        \n        // Append Content to Results Container\n        this.$common.results.append($container);\n        return true;\n    };\n    \n    /**\n     * Appends Results to a List with Enhanced Formatting for Display\n     *   Links are Hooked with Hubs History API to enable Hubs Style Page Changes\n     *   \n     * @public\n     * @this Hubs.Search\n     * @param {Object} $list A jQuery Element Handle to the List to populate\n     * @param {Object} $content A jQuery Element Handle to the Container of the List\n     * @param {Object} listData The Item-Data to Populate the List with\n     * @param {String} containerType The type of Container (Blogs, Docs, Videos) being Updated\n     * @return undefined \n     */\n    Hubs.Search.prototype.appendFormattedResults = function($list, $content, listData, containerType) {\n        var $seeMoreLink = $list.find('.see-more');\n        var streamData = listData[containerType];\n        var iconClass = 'color-box-service-icon';\n        var i, html = '';\n\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Remove any existing \"See More\" Link (we will generate it again if needed)\n        if ($seeMoreLink.length) {\n            $seeMoreLink.remove();\n        }\n        \n        // Medium Icons for Mobile\n        if (this.searchState.mobileDisplay) {\n            iconClass += ' medium';\n        }\n        \n        // Build List of Search Results\n        for (i = 0; i < streamData.items.length; i++) {\n            if (!streamData.items[i]) { continue; }\n            \n            // Build List Item HTML\n            html  = '<a href=\"' + streamData.items[i].url + '\" data-internal=\"' + streamData.items[i].service + '\">';\n            html += '<span class=\"' + iconClass + ' service-' + streamData.items[i].service + '\">';\n            html += '<i style=\"background-image:url(' + streamData.items[i].thumbnail + ')\"></i>';\n            html += '</span>';\n            html += ' ' + streamData.items[i].label + '</a>';\n            \n            // Append List Item to List\n            $('<li/>').html(html).appendTo($list);\n        }\n        \n        // Append \"See More\" Link (if needed)\n        if (streamData.items.length + streamData.offset < streamData.total) {\n            $('<li/>')\n                .addClass('see-more')\n                .html('<a nohref>' + Hubs.Config.search.labels.seeMore + '</a>')\n                .appendTo($list)\n                .on(Hubs.CLICK_EVENT + '.Search', $.proxy(function(e) {\n                    var $seeMoreLink = $(e.currentTarget);\n                    var nextOffset = streamData.items.length + streamData.offset;\n                    e.stopPropagation();\n                    this.seeMoreResults($seeMoreLink, $list, $content, containerType, nextOffset);\n                    return false;\n                }, this));\n        }\n        \n        // Append List to Content\n        $content.append($list);\n        \n        // Hook Internal Links\n        Shared.onNextEventLoop(function() { \n            this.app.overrideLinks(); \n        }, this);\n    };\n\n    /* ******************************************************************************************** */\n\n    /**\n     * Determine if Search should render the Display for Mobile or Desktop\n     * \n     * @public\n     * @this Hubs.Search\n     * @return {Boolean} True for Mobile Display rendering\n     */\n    Hubs.Search.prototype.useMobileDisplay = function() {\n        // Are We Displaying for Mobile?\n        return (Shared.IOS || Shared.$('window').width() <= Hubs.SEARCH_MOBILE_BREAKPOINT);\n    };\n    \n    /**\n     * Sets the Current Mobile Display Mode, and Marks the App as using Mobile-Search-Mode\n     * \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.updateDisplayState = function() {\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n\n        // Are We Displaying for Mobile?\n        this.searchState.mobileDisplay = this.useMobileDisplay();\n        \n        // Add/Remove Class to Indicate Search Display State\n        Shared.$('body')[this.searchState.mobileDisplay ? 'addClass' : 'removeClass']('mobile-search');\n    };\n    \n    /**\n     * Toggles the State of the Stream-Search feature.  \n     *   If Stream Search is enabled, then the Search will only be performed within the current Stream.\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.toggleStreamSearch = function(toggleState) {\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // If state is not set, toggle\n        if (toggleState === undefined) {\n            this.searchState.searchStream = !this.searchState.searchStream;\n        } else {\n            this.searchState.searchStream = toggleState;\n        }\n\n        // Re-search\n        this.initiateSearch();\n    };\n    \n    /**\n     * Adds a Search Query to the Recent Searches Storage\n     *   If the Search Query is already in the List, move to Top of List\n     *   Max 5 Recent Searches\n     * \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.addRecentSearch = function() {\n        var position = -1;\n        if (!this.searchData.query || !this.searchData.query.length) { return; }\n        \n        // Remove Duplicate Queries from Array\n        position = $.inArray(this.searchData.query, this.searchData.recent);\n        if (position > -1) {\n            this.searchData.recent.splice(position, 1);\n        }\n        \n        // Add Most Recent Query to Top of List\n        this.searchData.recent.unshift(this.searchData.query);\n        \n        // Truncate List to Max\n        this.searchData.recent.length = Math.min(this.searchData.recent.length, Hubs.SEARCH_MAX_RECENT);\n        \n        // Store List (LocalStorage or Cookies)\n        localStorage.setItem('hubs.rsq', this.searchData.recent.join(','));\n    };\n    \n    /**\n     * Get the List of Recent Searches from Storage\n     * \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.getRecentSearches = function() {\n        var storedSearches = localStorage.getItem('hubs.rsq');\n        if (!storedSearches) { return; }\n        this.searchData.recent = storedSearches.split(',');\n    };\n    \n    /**\n     * Sets the Loading State of a Container Element\n     * \n     * @public\n     * @this Hubs.Search\n     * @param {Object} $container A jQuery Element Handle to the Container to be Updated\n     * @param {Boolean} state The State of Loading \n     * @return undefined\n     */\n    Hubs.Search.prototype.setLoadingState = function($container, state) {\n        // Check if Search is Enabled\n        if (!Hubs.Config.search.enabled) { return; }\n        \n        // Toggle Loading State\n        $container[state ? 'addClass' : 'removeClass']('loading');\n    };\n    \n    /**\n     * Updates the Drop-Down Menu with a List of Recent Searches\n     *   \n     * @public\n     * @this Hubs.Search\n     * @return undefined\n     */\n    Hubs.Search.prototype.updateRecentSearches = function() {\n        if (!Hubs.Config.search.enabled || !this.searchData.recent || !this.searchData.recent.length) { return false; }\n        \n        // Debug Statement\n        Shared.Logger.log('search-update-recent');\n        \n        // Add Recent Items to Drop Down Menu\n        return this.addDropMenuList('recent-searches', Hubs.Config.search.labels.recent, this.searchData.recent);\n    };\n    \n}(window.jQuery));\n"},function(t,e,n){n(10)(n(383))},function(t,e){t.exports="(function($, undefined) {\n    'use strict';\n\n    // Bring Shared Logger to Local Object\n    Hubs.log = Shared.Logger.log;\n\n    /**\n     * Hubs App\n     *     - This is the main Class for the Application.\n     *       All control and logic exists here.\n     *       Entry point is Hubs.App.initialize()\n     *\n     * @class App\n     * @extends Hubs.Core\n     * @classdesc Application Controller\n     * @namespace Hubs\n     * @constructor\n     */\n    Hubs.App = function(appOptions) {\n        // Call Parent Constructor\n        Hubs.Core.apply(this, [appOptions]);\n        Object.seal(Hubs.Config.knownUser);\n\n        this.ufaCaller = new Hubs.UfaCaller({\n            ufaUrl: appOptions.serverUrl.ufa,\n            accountId: appOptions.accountId,\n            hubId: appOptions.hubId,\n            pageType: appOptions.pageType,\n            pardotCookie: appOptions.pardotCookie,\n            connectedMAPs: appOptions.mapIntegrations,\n            streamId: appOptions.streamId || null,\n            itemId: appOptions.itemId || null,\n            authorId: appOptions.authorId || null,\n            requireOptIn: Hubs.UfaCaller.ufaRequiresOptIn(appOptions)\n        });\n\n        // Populates the MAP visitor cache with any known visitor data.\n        Hubs.UfaCaller.enqueueTrackables({\n            marketo: function() { return $.cookie('_mkto_trk'); },\n            eloqua: function() { return $.cookie('eloquautk'); },\n            hubspot: function() { return $.cookie('hubspotutk'); },\n            pardot: function() { return $.cookie(appOptions.pardotCookie); },\n        }, function(){\n            Shared.ajaxFetch(Hubs.Config.serverUrl.ping, null, 'GET', true, null, null);\n        }, 40); // 40 retries = 20s\n\n        /* **************************************************************************************** */\n        /* * Private Methods/Members Declarations                                                 * */\n        /* **************************************************************************************** */\n        var initialize       = null;\n\n        /* **************************************************************************************** */\n        /* * Public Properties                                                                    * */\n        /* **************************************************************************************** */\n\n        this.hubState = {\n            collections: new Hubs.SessionVariable('collections'),\n            previousState: new Hubs.SessionVariable('previousState'),\n            userInterface: new Hubs.CookieVariable('uiState') // We use a cookie here because the server needs this information too.\n        }\n\n        // For backwards compatibility with custom code, keep old ajax based state up to date with new session state.\n        // We add the hooks here, before variable initialization, because we want these hooks to catch inital values being set.\n        // Start backwards compatibility\n        this.hubState.collections.on('set', $.proxy(function (e, newState) {\n            this.collectionState = newState;\n        }, this));\n\n        this.hubState.previousState.on('set', $.proxy(function (e, newPreviousState) {\n            this.previousItemId = newPreviousState['itemId'];\n            this.previousCollectionId = newPreviousState['collectionId'];\n            this.previousCollectionType = newPreviousState['collectionType'];\n        }, this));\n        // End backwards compatibility\n\n        /** @member {Bool} firstPage Whether or not the current page is the first page */\n        this.firstPage           = true;\n\n        /** @member {String} pageType The Current Page Type being Displayed */\n        this.pageType            = Hubs.PAGE_TYPE_HUB;\n\n        /** @member {String} collectionType The Current Collection Type being Displayed (Only when PageType is a Collection) */\n        this.collectionType      = Hubs.COLLECTION_TYPE_NONE;\n\n        /** @member {String} itemType The Current Item Type being Displayed */\n        this.itemType            = null;\n\n        /** @member {Number} collectionCount The Number of Items in the Current Collection (for lazy loading more items) */\n        this.collectionCount     = 0;\n\n        /** @member {Number} currentCollectionId The ID of the Current Collection Type being Displayed */\n        this.currentCollectionId = 0;\n\n        /** @member {Object} collectionState The viewed Page number and Scroll values being Displayed  */\n        // NOTE: This exists only for backwards compatibility. This value is now stored in this.hubState.collections\n        this.collectionState     = this.getCollectionState();\n\n        /** @member {Number} currentItemId The ID of the Current Item being Displayed */\n        this.currentItemId       = 0;\n\n        /** @member {Array} currentItemTags A list of tags associated with the Current Item being displayed */\n        this.currentItemTags      = null;\n\n        /** Formerly previousItemId, The ID of the Last Item which was displayed */\n        if (!this.hubState.previousState.get('itemId')) {\n            // Only initialize this variable if it is the start of a new session\n            this.hubState.previousState.set('itemId', 0);\n        }\n\n        /** Formerly previousCollectionId, The ID of the Previous Collection Type Displayed */\n        if (!this.hubState.previousState.get('collectionId')) {\n            // Only initialize this variable if it is the start of a new session\n            this.hubState.previousState.set('collectionId', 0);\n        }\n\n        /** Formerly previousCollectionType, The Type of the Previous Collection Displayed */\n        if (!this.hubState.previousState.get('collectionType')) {\n            // Only initialize this variable if it is the start of a new session\n            this.hubState.previousState.set('collectionType', Hubs.COLLECTION_TYPE_NONE);\n        }\n\n        /** @member {Object} $appContainer A jQuery Element Handle to the Container DIV of the Application  */\n        this.$appContainer       = null;\n\n        /** @member {Object} $$loadingOverlay A jQuery Element Handle to the Loading Overlay DIV of the Application  */\n        this.$loadingOverlay     = null;\n\n        /** @member {Object} $loadingIndicator A jQuery Element Handle to the Loading Indicator DIV of the Application  */\n        this.$loadingIndicator   = null;\n\n        /** @member {Object} relatedCarousel A reference to the Carousel Object for the Content Page Related Items */\n        this.relatedCarousel     = null;\n\n        /** @member {Boolean} fullDescDisplayed The Display state of the Description for Secondary Content used for Toggling the Display */\n        this.fullDescDisplayed   = false;\n\n        /** @member {Boolean} mobileNavClicked Flag for Allowing Body Clicks to Close Side Menu */\n        this.mobileNavClicked    = false;\n\n        /** @member {Object} history A reference to the global history instance */\n        this.history             = Hubs.root.history;\n\n        /** @member {Object} lazyLoader A reference to the LazyLoader Object for Collection Pages */\n        this.lazyLoader          = null;\n\n        /** @member {Object} search A reference to the Search Object */\n        this.search              = null;\n\n        /** @member {Number} time of last request ms **/\n        this.pageTimer           = Date.now();\n\n        /** @member {number} ID of the Timer for the Delayed Initial Fullscreen Mode for Flipbooks */\n        this.initialFullscreenTimer = 0;\n\n        /** @member {Number} shared throttle for events **/\n        this.throttle            = -1;\n\n        /** @member {Object} container for url querystring parameters **/\n        this.queryString = {};\n\n        /** @member {Number} recoTracking The ID for Recommendation Tracking */\n        this.recoTracking       = null;\n\n        /** @member {String} recoVisual The placement of where the item was displayed (panel, carousel, next) */\n        this.recoVisual = null;\n\n        /** @member {Boolean} for itemPreview enabled or not **/\n        this.itemPreviewEnabled = false;\n\n        /* **************************************************************************************** */\n        /* * Private Methods/Members Definitions                                                  * */\n        /* **************************************************************************************** */\n\n        /**\n         * Initialize the Application\n         *     - Parse Collections, Determine Page Type, Build Common Elements,\n         *       Initialize Events, Initialize Required Components\n         *\n         * @private\n         * @this Hubs.App\n         * @param {Object} [options] Configuration Settings for the Class\n         * @return undefined\n         * @constructs\n         */\n        initialize = $.proxy(function() {\n            if (!Hubs.Config.isPreventAnalyticsCollectionEnabled) {\n\n                this.ufaCaller.init();\n\n                var startTracking = function(ufaCaller) {\n                    ufaCaller\n                        .trackPageView()\n                        .trackVisitorData()\n                        .trackTimeOnPage();\n                };\n\n                var isCtaPage = Hubs.Config.pageType === \"cta\";\n\n                if (isCtaPage && window.IntersectionObserver) {\n                    var body = document.querySelector('body');\n                    var observer =\n                        new IntersectionObserver(\n                            function(entries) {\n                                var isObserving = entries.some(function(entry) { return entry.isIntersecting });\n                                if (isObserving) {\n                                    observer.unobserve(body);\n                                    startTracking(Hubs.appInstance.ufaCaller);\n                                    Hubs.appInstance.ufaCaller.trackLazyLoadImpressions();\n                                }\n                            },\n                            {\n                                root: null,\n                                rootMargin: '0px',\n                                threshold: 0.5,\n                            }\n                        );\n                    observer.observe(body);\n                } else {\n                    startTracking(this.ufaCaller);\n                }\n\n                Hubs.Events.on('recoPanelOpen', function() {\n                    Hubs.appInstance.ufaCaller.trackRecoPanelImpressions();\n                });\n\n                Hubs.Events.on('itemsLoaded', function() {\n                    Hubs.appInstance.ufaCaller.trackLazyLoadImpressions();\n                    Hubs.appInstance.ufaCaller.trackLazyLoadScrollDepth();\n                });\n\n                Hubs.Events.on('ctaActivateUfaCollector', function(ctaId, ctaTile) {\n                    Hubs.appInstance.ufaCaller.ctaId = ctaId;\n                    Hubs.appInstance.ufaCaller.ctaTile = ctaTile;\n                    Hubs.appInstance.ufaCaller.trackCtaFormActivation();\n                });\n\n                Hubs.Events.on('ctaFormSubmitSuccess', function (ctaId, mappedData, ctaName, ctaTile) {\n                    if (Hubs.isMobile()) {\n                        // \"this\" picks up wrong (mobile overlay) dom element on mobile\n                        Hubs.appInstance.ufaCaller.ctaTile = $('#hub-cta-' + ctaId + '.active-mobile-overlay');\n                    } else {\n                        Hubs.appInstance.ufaCaller.ctaTile = ctaTile;\n                    }\n\n                    Hubs.appInstance.ufaCaller.ctaId = parseInt(ctaId);\n                    Hubs.appInstance.ufaCaller.trackCtaFormSubmit();\n                });\n\n                // Link CTA clicks\n                // TODO: add proper hub event for link cta click\n                $('#hubs-container').on('click', 'a.cta-button', function() {\n                    var ctaUrl = this.getAttribute('href')\n                    Hubs.appInstance.ufaCaller.ctaId = this.dataset.ctaId;\n                    Hubs.appInstance.ufaCaller.ctaTile = this;\n                    Hubs.appInstance.ufaCaller.trackCtaLinkClick(ctaUrl);\n                });\n\n            }\n\n            // Update Logging/Profiling State\n            Shared.Logger.enabled = Hubs.Config.enableDebugger;\n\n            // Get App Container Element\n            this.$appContainer = $(Hubs.Config.containers.app);\n            if (!this.$appContainer.length) {\n                return Shared.Logger.log({'msg': 'app-invalid-container', 'type': Shared.LVL_ERROR});\n            }\n\n            // When we close fullscreen mode on a flipbook, some cleanup needs to be done.\n            // If fullscreen is closed via the esc key, the cleanup wont happen.\n            // So, listen for fullscreen change and call Shared.exitFullscreen() if we just exited fullscreen.\n            $(window).on('fullscreenchange mozfullscreenchange webkitfullscreenchange MSFullscreenChange', function () {\n                // Only do this for flipbooks! This will break videos in safari.\n                if (Hubs.appInstance.itemType !== 'uberflip') {\n                    return;\n                }\n\n                var isFullScreen = document.fullscreenElement ||\n                    document.webkitFullscreenElement ||\n                    document.mozFullScreenElement ||\n                    document.msFullscreenElement\n\n                if(!isFullScreen){\n                    Shared.exitFullscreen();\n                }\n            });\n\n            // Add Localization to Logger\n            Shared.Logger.setL10N(Hubs.DEBUG_MSG);\n\n            // Debug Statement\n            Shared.Logger.log('app-init');\n\n            // Init Search Tool\n            this.search = new Hubs.Search(this);\n\n            // Store Hubs Data Locally\n            this.pageType = Hubs.Config.pageType;\n\n            // Initialize the Splash Screen\n            var hasSplashScreen = this.hubState.userInterface.get('hasHeroBanner');\n            var dismissedSplashScreen = this.hubState.userInterface.get('bannerDismissed');\n\n            if (hasSplashScreen && !dismissedSplashScreen){\n                this.initSplashScreen(this.pageType);\n            }\n\n            // Determine Type of Page to Build\n            this.determinePageType();\n\n            // Update Page-Width Element\n            Hubs.updatePageWidthElement(this.pageType);\n\n            // Update Size of Main Sharing Menu\n            this.resizeHubShare();\n\n            // Vertically align header elements\n            this.repositionHeader();\n\n            // Update Position of Sharing on Level 3 Items\n            this.repositionLevel3Sharing();\n\n            // Resize instagram video\n            this.resizeInstagramVideo();\n\n            // Reposition CTA for Item Views\n            this.repositionCta();\n\n            // Initialize Events\n            this.initEvents();\n\n            // Initialize CTAs\n            this.initCTAs();\n\n            // Desktop Navigation\n            this.desktopNav();\n\n            // Mobile Navigation\n            this.mobileNav();\n\n            // signal for our metrics to be persisted\n            this.signalMetricsTemp();\n\n            if(this.pageType === Hubs.PAGE_TYPE_ITEM) {\n                this.loadExtraInfo();\n            }\n\n            // Add Analytics Codes for Tracking\n            Shared.Tracker.addAnalyticsCodes(Hubs.Config.analyticsCodes);\n\n            // Track Hubs Open\n            Shared.Tracker.trackPage(Hubs.root.self.location.href, this.history.state);\n\n            // Store query parameters\n            this.queryString = Shared.getQueryParams();\n\n            // Continue from previously set collection page number and scrollTop\n            this.initCollectionState();\n\n            // Prettify the url\n            this.cleanUrlQueryString();\n\n            // save params that may be used for CTA hidden fields\n            this.persistQueryParamsForCtaFields();\n\n            // Debug Statement\n            Shared.Logger.log('app-init-end');\n\n            // When in iframe mode (Embedded Hubs or Preview Mode), send \"ready\" message to iframeResizer.js\n            if (Hubs.root.parent) {\n                // Emit a custom event to let parent window know app is ready.\n                Hubs.root.parent.postMessage('Hubs.Initialized', '*');\n            }\n        }, this);\n\n\n        /* **************************************************************************************** */\n        /* * Entry Point                                                                          * */\n        /* **************************************************************************************** */\n        initialize();\n    };\n    Hubs.App.prototype = new Hubs.Core();\n    Hubs.App.prototype.constructor = Hubs.App;\n    // End of Hubs.App\n\n\n    /* ******************************************************************************************** */\n    /* * Public Methods                                                                           * */\n    /* ******************************************************************************************** */\n\n    /**\n     * Post-Initialization of the Application\n     *     - Occurs after the Application has built all necessary elements,\n     *       and loaded initial resources.\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.postInit = function() {\n        // Debug Statement\n        Shared.Logger.log('app-post-init');\n\n        // Get jQuery Handle to DOM Element for Loading Indicator\n        this.$loadingOverlay = $(Hubs.Config.containers.loadingOverlay);\n        this.$loadingIndicator = $(Hubs.Config.containers.loadingIndicator);\n\n        // update page specific elements like links, carousel, ctas, etc.\n        this.updatePageSpecific();\n\n        if (this.pageType === Hubs.PAGE_TYPE_ITEM && this.isRecommendationEnabled()) {\n            // set up recommendation rule things\n            this.setUpRecommendations(this.initAsyncPageElements.bind(this));\n        } else if (this.pageType === Hubs.PAGE_TYPE_ITEM && this.itemPreviewEnabled) {\n            this.enableItemPreview();\n        }\n\n        // Update MoveToTop Link Class\n        this.updateMoveToTopClass();\n\n        // Post-Init for Embedded Hubs\n        this.initEmbedded();\n\n        // Finalize the Splash Screen behaviour for Desktop/Mobile\n        this.finalizeSplashScreen();\n\n        // Debug Statement\n        Shared.Logger.log('app-post-init-end');\n\n        // Call Hubs-Loaded Event\n        Shared.onNextEventLoop(function() {\n            if (typeof Hubs.onLoad === 'function') {\n                Shared.onNextEventLoop(Hubs.onLoad, this);\n            }\n\n            // emit load event\n            Shared.onNextEventLoop(Hubs.Events.trigger.bind(this, 'load'), this);\n        }, this);\n    };\n\n    /**\n     * Initialize Events for the Hubs Application\n     *   - Root level events set on window object\n     *   - Initializes the ImagesLoaded component and fires Post-Init\n     *     from here, when all resources are loaded.\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.initEvents = function() {\n        var $win = Shared.$('window');\n        var $body = Shared.$('body');\n        var $largeHeader = $(Hubs.Config.containers.largeHeader);\n        var $mainContent = Shared.$(Hubs.Config.containers.mainContent);\n        var $footer = Shared.$(Hubs.Config.containers.footer);\n        var $moveToTop = Shared.$(Hubs.Config.containers.moveToTop);\n        var $chevron = $(Hubs.Config.containers.splashChevron);\n        var imgLoad = null;\n\n        // Debug Statement\n        Shared.Logger.log('events-init');\n\n        // Load Images\n        if ($largeHeader.length) {\n            imgLoad = imagesLoaded($largeHeader[0]);\n            imgLoad.on('always', $.proxy(function(instance, image){\n                if (this.initialImagesLoaded) {return;}\n                this.initialImagesLoaded = true;\n\n                this.repositionHeader();\n\n                // Call Post-Init of App\n                this.postInit();\n            }, this));\n\n        } else {\n            this.postInit();\n        }\n\n        // Iframe Load Event from Embedded Hub\n        if (Hubs.isEmbedded()) {\n            Shared.$('window').on('loadData.Hubs.App', $.proxy(function () {\n                // Check if starting in expanded mode, requires time delay\n                this.initialDelayedFullscreen();\n            }, this));\n        }\n\n        // Bind to StateChange Event\n        $(Hubs.root).on(\n            'beforeunload',\n            function (event, newHistoryState, title, url) {\n                this.setPreviousStateOnExit();\n                this.setCollectionStateOnExit();\n\n                // Hide Loading Indicator\n                if (this.$loadingOverlay) this.$loadingOverlay.hide();\n            }.bind(this)\n        );\n\n        // Apply Margin to Bottom of Content to Account for Height of Sticky Footer\n        if (Hubs.Config.labOptions.stickyFooter && $footer.length && $mainContent.length) {\n            $mainContent.css({'margin-bottom': $footer.outerHeight()});\n        }\n\n        // Splash Screen Arrow\n        if ($chevron.length) {\n            $chevron.on(Hubs.CLICK_EVENT, $.proxy(function() {\n                // Hide Splash Screen and Restore Scrolling\n                this.removeHeroHeader(true);\n            }, this));\n        }\n\n        // \"Move to Top\" link events\n        if ($moveToTop.length) {\n            // Click Event for \"Move to Top\" link\n            $moveToTop.addClass('hooked').on(Hubs.TAP_EVENT, $.proxy(function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n                if (Hubs.isEmbedded() && 'parentIFrame' in window) {\n                    window.parentIFrame.scroll('top');\n                } else {\n                    Shared.scrollTop(0, 750);\n                }\n                return false;\n            }, this));\n        }\n\n        // Window Scroll Event\n        $win.on('scroll.Hubs', $.proxy(this.scrollEvent, this));\n\n        // Window Resize/Orientation Events\n        $win.on('debouncedresize.Hubs orientationchange.Hubs', $.proxy(this.resizeEvent, this));\n\n        $mainContent.on('click', '.fullscreen-controls.underneath .download-pdf', $.proxy(function() {\n            // update metrics when pdf downloaded\n            var flipbookId = $('[data-flipbookId]').attr('data-flipbookId');\n            this.pdfDownload(flipbookId);\n        }, this));\n\n        $win.on('pageshow', function () {\n            if (this.$loadingOverlay) this.$loadingOverlay.hide();\n        }.bind(this));\n    };\n\n    /**\n     * Initializes the Flipbook Overlay Control Events\n     *     - When a Flipbook is Opened (Desktop) a Button is placed\n     *       as an overlay on the Flipbook to allow the User to return to Hubs.\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.initDocEvents = function() {\n        var $container = $(Hubs.Config.containers.flipbookContainer);\n        var $controls = $(Hubs.Config.containers.fullscreenControls);\n\n        // Debug Statement\n        Shared.Logger.log('doc-events-init');\n\n        // Fullscreen Overlay Controls\n        $controls.find('.fullscreen-open, .fullscreen-close').on(Hubs.TAP_EVENT, $.proxy(function(e) {\n            e.stopPropagation();\n            this.toggleFullscreen();\n            return false;\n        }, this));\n\n        var flipbookOrigin;\n\n        try {\n            var flipbookUrl = $container.find('iframe').attr('src');\n            // prepend protocol if it has been stripped off\n            if (/^\\//.test(flipbookUrl)) {\n                flipbookUrl = window.location.protocol + flipbookUrl;\n            }\n            flipbookOrigin = new URL(flipbookUrl).origin;\n        } catch(e) {\n            Shared.Logger.log('error getting flipbook origin: ' + e.message);\n        }\n\n        window.addEventListener(\n            'message',\n            $.proxy(function (event) {\n                if (event.origin !== flipbookOrigin) return;\n\n                if (event.data.type !== Shared.MESSAGE_TYPES.FLIPBOOK_EVENT) return;\n\n                if (!Hubs.Config.isPreventAnalyticsCollectionEnabled && Hubs.appInstance.ufaCaller) {\n                    switch(event.data.eventType) {\n                        case 'view_flipbook_pages':\n                            event.data.pageIds.forEach(function(pageId, index){\n                                var pageNumber = event.data.pageNumbers[index];\n                                Hubs.appInstance.ufaCaller.trackFlipbookPageView(event.data.flipbookId, pageId, pageNumber);\n                            });\n                            break;\n                        default:\n                            break;\n                    }\n                }\n            }, this),\n            false\n        );\n\n        // Check if starting in expanded mode, requires time delay\n        if (!Hubs.isEmbedded()) {\n            this.initialDelayedFullscreen();\n        }\n    };\n\n    /**\n     * display Item Page in Preview mode\n     *\n     * @public\n     * @return undefined\n     */\n    Hubs.App.prototype.enableItemPreview = function() {\n        var $article = $('section.level-three > .entry-wrapper');\n        var $itemNextPrev = $('.item-next-prev');\n        var $comments = $('.comments-container');\n\n        var sTop = window.scrollY,\n            aTop = $article.offset().top,\n            artH = $article.innerHeight(),\n            winH = $(window).innerHeight();\n\n        if( artH - sTop + aTop  > winH ) {\n            $article.addClass('item-preview').css('max-height', sTop - aTop + winH + 100);\n            $('<div/>').attr('id', 'preview-read-more')\n                .attr('class', 'item-preview-div')\n                .html('<a href=\"javascript:void(0)\" id=\"item-preview-link\" class=\"btn btn-white item-preview-link\">'+ Hubs.Config.itemPreviewButtonLabel +'</a>')\n                .insertAfter('article');\n            $comments.hide();\n            $itemNextPrev.hide();\n\n            //clear preview on button click\n            $('#item-preview-link').on('click', function () {\n                $article.removeClass('item-preview').css('max-height','none');\n                $(this).parent().remove();\n                $comments.show();\n                $itemNextPrev.show();\n            });\n        }\n    };\n\n    /**\n     * Toggles Fullscreen Mode of a Hub\n     *\n     * @public\n     * @this Hubs.App\n     * @param {Boolean} fullscreen A flag to Toggle Fullscreen\n     * @return undefined\n     */\n    Hubs.App.prototype.toggleFullscreen = function(fullscreen, pseudo) {\n        var $container = $(Hubs.Config.containers.flipbookContainer);\n\n        // Determine which way to Toggle if not specified\n        if (fullscreen === undefined) {\n            fullscreen = !(Shared.isBrowserFullscreen() || Shared.isPseudoFullscreen());\n        }\n\n        // Check if we want to Force Pseudo-Fullscreen Mode\n        //  (Browser Fullscreen Mode must be initiated by user-gesture,\n        //   therefore to start out in Fullscreen Mode when the page is\n        //   loaded we must fake it.)\n        if (pseudo === undefined) {\n            pseudo = Shared.isPseudoFullscreen();\n        }\n\n        if (fullscreen) {\n            if (pseudo || Shared.enterFullscreen($container[0]) === false) {\n                this.togglePseudoFullscreen(fullscreen);\n            }\n        } else {\n            if (Shared.isPseudoFullscreen() || Shared.exitFullscreen() === false) {\n                this.togglePseudoFullscreen(fullscreen);\n            }\n        }\n    };\n\n    /**\n     * Toggles Fullscreen Mode Overlay Elements of a Hub\n     *\n     * @public\n     * @this Hubs.App\n     * @param {Boolean} fullscreen True to Mark Overlay Elements as Fullsceen; false to remove Marks\n     * @return undefined\n     */\n    Hubs.App.prototype.togglePseudoFullscreen = function(fullscreen) {\n        var $container = $(Hubs.Config.containers.flipbookContainer);\n        var $itemContainer = $(Hubs.Config.containers.itemContent);\n\n        // Mark Containers with Fullscreen State\n        if (fullscreen) {\n            Shared.$('body').addClass('pseudo-fullscreen');\n            $container.addClass('fullscreen');\n            $itemContainer.addClass('fullscreen-doc');\n        } else {\n            Shared.$('body').removeClass('pseudo-fullscreen');\n            $container.removeClass('fullscreen');\n            $itemContainer.removeClass('fullscreen-doc');\n        }\n\n        // Update Body Scrolling\n        Hubs.setBodyScroll(!fullscreen);\n\n        // Notify Parent Iframe of Embedded Hubs\n        if (Hubs.isEmbedded() && 'parentIFrame' in window) {\n            window.parentIFrame.fullscreen(fullscreen ? 1 : 0);\n        }\n    };\n\n    Hubs.App.prototype.initialDelayedFullscreen = function() {\n        var $container = $(Hubs.Config.containers.flipbookContainer);\n        var $blockingCta = $(Hubs.Config.cta.elements.blockCta);\n        var isBlockedByCta = $blockingCta.length && $blockingCta.is(':visible');\n        this.initialFullscreenTimer = Hubs.root.setTimeout($.proxy(function () {\n            if ($container.hasClass('initial-expanded') && !isBlockedByCta) {\n                this.toggleFullscreen(true, true);\n                $container.removeClass('initial-expanded');\n            }\n            this.initialFullscreenTimer = 0;\n        }, this), 2000);\n    };\n\n    /**\n     * Observes and Responds to the Resize Events fired on the Global Window Object or App Container\n     *     - Also fires for the OrientationChanged event, as the behaviour is essentially the same.\n     *\n     * @public\n     * @this Hubs.App\n     * @param {Object} eventData The Event Data associated with the Event\n     * @return {Boolean} The success state of the event; determines whether to allow event-bubbling\n     */\n    Hubs.App.prototype.resizeEvent = function(eventData) {\n        // Debug Statement\n        Shared.Logger.log('app-resize');\n\n        // Delay Event so that DOM Elements are updated\n        Hubs.root.setTimeout($.proxy(function() {\n            // Responsive Resize\n            this.repositionHeader();\n            this.resizeImageTiles();\n            this.repositionLevel3Sharing();\n            this.resizeInstagramVideo();\n            this.repositionCta();\n            this.resizeCtaForms();\n            this.responsiveCtaText();\n            this.resizeHubShare();\n            // Search Resize\n            this.search.resize(eventData);\n\n            // Debug Statement\n            Shared.Logger.log('app-resize-end');\n\n            // Call Hubs-Loaded Event\n            if (typeof Hubs.onResize === 'function') {\n                Shared.onNextEventLoop(Hubs.onResize, this);\n            }\n\n            // emit optimized resize event\n            Shared.onNextEventLoop(Hubs.Events.trigger.bind(this, 'resize'), this);\n\n        }, this), 125); // just after carousel resize event\n\n        return true;\n    };\n\n    /**\n     * Observes and Responds to the Scroll Events fired on the Global Window Object or App Container\n     *\n     * @public\n     * @this Hubs.App\n     * @param {Object} eventData The Event Data associated with the Event\n     * @return {Boolean} The success state of the event; determines whether to allow event-bubbling\n     */\n    Hubs.App.prototype.scrollEvent = function(e, scrollTop, offsetTop, viewportX, viewportY) {\n        var $win = Shared.$('window');\n        var $doc = Shared.$('document');\n        var $body = Shared.$('body');\n        var $moveToTop = Shared.$(Hubs.Config.containers.moveToTop);\n        var $heroHeader = $(Hubs.Config.containers.largeHeader);\n        var documentHeight = $doc.height();\n\n        if (scrollTop === undefined) { scrollTop = $win.scrollTop(); }\n        if (offsetTop === undefined) { offsetTop = 0; }\n        if (viewportX === undefined) { viewportX = $win.width(); }\n        if (viewportY === undefined) { viewportY = $win.height(); }\n\n        // By disabling pointer-events while scrolling, can achieve ~60fps during scroll.\n        // Note: this may also be a bug fix for scrolling on pages with iFrame Embeds,\n        // did not seem safe to remove it entirely\n        if (!Shared.IOS9) {\n            clearTimeout(this.scrollTimer);\n            if (!$body.hasClass('disable-hover')) {\n                $body.addClass('disable-hover');\n            }\n            this.scrollTimer = setTimeout(function () {\n                $body.removeClass('disable-hover');\n            }, 100);\n        }\n\n        // Hero Header Behaviour\n        if (!Hubs.Config.labOptions.permHeader && !Hubs.Config.labOptions.noHeader && $heroHeader.length) {\n            // Hide Large Header when Scrolled past\n            if ((scrollTop - offsetTop) >= $heroHeader.outerHeight() || (scrollTop - offsetTop) + viewportY === documentHeight) {\n                //Hubs.restoreBodyScroll();\n                this.removeHeroHeader(false);\n            }\n        }\n\n        // Update Search Class\n        this.search.scroll(scrollTop, offsetTop, viewportX, viewportY);\n\n        // Show \"Move to Top\" link after scrolling a bit\n        if (!Hubs.isEmbedded()) {\n            if ($moveToTop.length) {\n                if ((scrollTop - offsetTop) > 300) {\n                    $moveToTop.addClass('show');\n                } else {\n                    $moveToTop.removeClass('show');\n                }\n            }\n        }\n\n        // Call Hubs-Scroll Event\n        if (typeof Hubs.onScroll === 'function') {\n            Shared.onNextEventLoop(Hubs.onScroll, this);\n        }\n\n        // emit optimized scroll event\n        Shared.onNextEventLoop(Hubs.Events.trigger.bind(this, 'scroll'), this);\n    };\n\n    /**\n     * Enable Desktop Navigation\n     *   - Attaches Hover Events for the Desktop Navigation\n     *     (CSS behaviour alone is jumpy)\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.desktopNav = function() {\n        var $navItems, $shareButton, $hubSelection, $localeSelector;\n        if (Hubs.isMobile()) { return; }\n\n        // Debug Statement\n        Shared.Logger.log('nav-desktop-init');\n\n        // Desktop-nav specific - showing and hiding items on hover\n        $navItems = Shared.$(Hubs.Config.containers.leftNav[2]).find('li.collapsed');\n        if ($navItems.length) {\n            Shared.enableHoverMenu({\n                'hover' : $navItems,\n                'hoverOverCallback' : function(e, $menuEl) {\n                    $navItems.removeClass('hover');\n                    window.setTimeout(Hubs.positionLeftNav, 10);\n                }\n            });\n        }\n\n        // Desktop Share Menu\n        $shareButton = $('.share-toggle');\n        if ($shareButton.length) {\n            Shared.enableHoverMenu({\n                'hover' : $shareButton,\n                'menu' : function(e, options) {\n                    var $menuEl = $('.share-item');\n                    if ($menuEl.length) { return $menuEl; }\n                    return $('.share-hub');\n                },\n                'hoverOverCallback' : $.proxy(function(e, $menuEl) {\n                    Hubs.positionShareNav();\n                    this.search.hideDropDown();\n                }, this),\n                'isSeparateMenu' : '.share-hub, .share-item'\n            });\n        }\n\n        // Desktop language/locale selector\n        $localeSelector = $('.locale-selector');\n        if ($localeSelector.length) {\n            Shared.enableHoverMenu({\n                'hover' : $localeSelector,\n                'hoverOverCallback' : function() {\n                    $localeSelector.removeClass('hover');\n                    window.setTimeout(Hubs.positionLeftNav, 10);\n                }\n            });\n        }\n    };\n\n    /**\n     * Enable the Mobile Navigation\n     *   - Displays the Mobile Navigation and Hides the Desktop Navigation\n     *   - Attaches Events for the Mobile Navigation\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.mobileNav = function() {\n        var $mobileNav = Shared.$('.mobile-nav');\n\n        // Debug Statement\n        Shared.Logger.log('nav-mobile-init');\n\n        // Toggling the mobile navigation and sharing menus\n        $('.nav-toggle').on(Hubs.CLICK_EVENT, $.proxy(function(e) {\n            e.preventDefault();\n            var scrollTo;\n            if ($mobileNav.length) {\n                $mobileNav.fadeIn();\n                scrollTo = $mobileNav.find('.overlay-scroller');\n            }\n            Hubs.restrictBodyScroll();\n            Shared.scrollTop(0, 0, scrollTo);\n\n            if (Hubs.isEmbedded() && 'parentIFrame' in window) {\n                window.parentIFrame.scroll('top');\n            }\n        }, this));\n\n\n        if ($mobileNav.length) {\n            // Exiting the mobile navigation and sharing menus\n            $mobileNav.find('.exit').on(Hubs.CLICK_EVENT, $.proxy(function (e) {\n                $mobileNav.fadeOut(400, function () {\n                    Hubs.closeOpenMenus();\n                    Hubs.restoreBodyScroll();\n                });\n            }, this));\n\n            // Expanding and collapsing menu items with child links\n            $mobileNav.find('li.collapsed > a').on(Hubs.TAP_EVENT, function (e) {\n                e.preventDefault();\n                var $el = $(this), $parent = $el.parent('li');\n                if ($parent.hasClass('collapsed')) {\n                    Hubs.toggleHeight(true, $parent.find('.collapsable-section'));\n                    $parent.removeClass('collapsed').addClass('expanded');\n                } else if ($parent.hasClass('expanded')) {\n                    Hubs.toggleHeight(false, $parent.find('.collapsable-section'));\n                    $parent.removeClass('expanded').addClass('collapsed');\n                }\n\n                // Fix Bug in iOS8 (height of scrolling element does not update when content height changes)\n                //  - Force a repaint for this device\n                if (Hubs.isMobile() && Shared.IOS8) {\n                    Hubs.root.setTimeout(function () {\n                        $('.overlay-scroller').hide().delay(0).show(0);\n                    }, 205); // 200ms transition effect\n                }\n            });\n        }\n\n        // Show/Hide the mobile locale language selector\n        var localeToggle = $('.locale-toggle');\n        if (localeToggle.length) {\n            localeToggle.on(Hubs.TAP_EVENT, $.proxy(function(e) {\n                var $localeMenu = $('.locale-selector-mobile');\n                e.preventDefault();\n                if ($localeMenu.hasClass('active')) {\n                    $localeMenu.removeClass('active');\n                    return;\n                }\n                $localeMenu.addClass('active');\n            }, this));\n        }\n\n        // Tablet-nav specific - showing and hiding items on click\n        if (Hubs.isMobile()) {\n            $(Hubs.Config.containers.leftNav[2] + '.desktop').find('> li').on(Hubs.TAP_EVENT, \n                $.proxy(function(e) {\n                var $el = $(e.currentTarget);\n                e.preventDefault();\n                this.preventBubbling();\n                $(Hubs.Config.containers.leftNav[2] + '.desktop').find('.hover').removeClass('hover');\n                if (!$el.find('ul').is(':visible') && !$el.hasClass('hover')) {\n                    $el.addClass('hover');\n                    Hubs.positionLeftNav();\n                }\n            }, this));\n\n            // Toggling the sharing menu\n            $('.share-toggle').on(Hubs.TAP_EVENT, $.proxy(function(e) {\n                var $menuEl = null;\n                e.preventDefault();\n                this.preventBubbling();\n                $menuEl = $('.share-item');\n                if (!$menuEl.length) { $menuEl = $('.share-hub'); }\n                $menuEl.addClass('hover');\n                Hubs.positionShareNav();\n                return false;\n            }, this));\n\n            // Allow Propagation for Nested Links\n            $(Hubs.Config.containers.leftNav[2] + '.desktop').find('> li > ul > li').on(Hubs.TAP_EVENT, $.proxy(function(e) {\n                e.stopPropagation();\n                return true;\n            }, this));\n\n            // Tapping/Swiping on Document should close any open menus\n            Shared.$('body').on('swipemove.Hubs tapone.Hubs', $.proxy(function(e) {\n                if (!this.mobileNavClicked && window.navigator.msPointerEnabled === undefined) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    $('.share-hub, .share-item').removeClass('hover');\n                    Shared.$(Hubs.Config.containers.leftNav[2]).find('li.collapsed').removeClass('hover');\n                    return false;\n                }\n            }, this));\n        }\n    };\n\n    /**\n     *\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.requestInternalPageChange = function(url, type, title, seoTitle) {\n        // Ensure Valid Params\n        if (url === undefined) { return; }\n        if (type === undefined) { type = 'standard'; }\n        if (title === undefined) { title = ''; }\n        if (seoTitle === undefined) { seoTitle = ''; }\n\n        // Debug Statement\n        Shared.Logger.log('internal-page-change-request');\n\n        // Restore Scrolling on Body\n        Hubs.restoreBodyScroll();\n\n        // Kill any existing Ajax Requests\n        Shared.cancelAjax(this.historyXhr);\n\n        // Hide any Open Menus\n        Hubs.root.setTimeout(Hubs.closeOpenMenus, 300);\n\n        // Reset the container for CTAs to record a view for\n        Hubs.CTAs.ctasForViewTracking = [];\n\n        // Handle Mobile Flipbook case\n        var isMobileFlipbook = Hubs.isMobile() && $(Hubs.Config.containers.mobileFlipbook).length;\n        var flipbookBreakOutCandidate = isMobileFlipbook || Hubs.Config.labOptions.flipbookBreakOut;\n        var shouldBreakOutOfFlipbook = flipbookBreakOutCandidate && /uberflip/i.test(type);\n\n        if (shouldBreakOutOfFlipbook) {\n            // Mobile has its one off case for flipbooks, store this page view\n            // Mobile can't have blocking ctas on mobile as it opens in new page\n            Hubs.storePageView(type, this.currentItemId, this.currentCollectionId, false);\n\n            // Open Source URL in New Window\n            Hubs.root.open(url, '');\n            return;\n        }\n\n        // Break out to Top for Embedded Hubs when clicking an Item Link\n        var isEmbeddedMode = Hubs.isEmbedded();\n        var isPreviewMode = $('body').hasClass('inPreview');\n        var linkBreakOut = isEmbeddedMode ? Hubs.Config.embedOptions.linkBreakOut :\n            Hubs.Config.labOptions.linkBreakOut;\n        var shouldBreakOutOfEmbeddedHub = linkBreakOut && $('body').hasClass('iframe') && !isPreviewMode;\n\n        if (shouldBreakOutOfEmbeddedHub) {\n            var metricsParams = this.constructMetricsParams();\n            url += (url.match(/\\?/g) ? '&' : '?') + $.param(metricsParams);\n            Hubs.root.top.location.href = url;\n            return;\n        }\n\n        // Change Page in current window (no break out)\n        // Append url if required: ?embedded=1, ?inPreview=1\n        if (isEmbeddedMode) url += (url.match(/\\?/g) ? '&' : '?') + 'embedded=1';\n        if (isPreviewMode) url += (url.match(/\\?/g) ? '&' : '?') + 'inPreview=1';\n\n        // Change Page\n        this.requestChangePage({type: type, title: title}, '', url);\n\n        // Update meta title\n        $('meta[name=title]').attr('content', seoTitle || title);\n    };\n\n    /**\n     * Overrides all Links on Hubs Page\n     *     - Hooks all Links so that content can be pulled via Ajax and controlled via History Manager\n     *     - Exception; Document links on Small Screen Devices should open in a new window/tab\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.overrideLinks = function() {\n        // Debug Statement\n        Shared.Logger.log('links-override-init');\n\n        // Internal Links\n        // Find all non-hooked internal links\n        $('a[data-internal]:not([href^=mailto]):not(.hooked)').each($.proxy(function(idx, el){\n            var $anchor = $(el), attr = $anchor.attr('data-internal');\n            if (attr === undefined || attr === 'false') { return; }\n\n            // Attach click event to links and mark as \"hooked\"\n            $anchor.addClass('hooked').on(Hubs.CLICK_EVENT, $.proxy(function(e) {\n                var $tile;\n                var $el = $(e.currentTarget);\n                var type = $el.attr('data-internal');\n                var flipbookPage = Shared.getQueryParamByName('p');\n                var sourceUrl = $el.attr('data-source-url');\n                var title = '';\n                var seoTitle = '';\n                var recotrk = $el.attr('data-recotrk');\n                var visual = $el.attr('data-visual');\n    \n                // determine if item is recommended & store the id\n                if (this.pageType === Hubs.PAGE_TYPE_ITEM &&\n                    this.isRecommendationEnabled()) {\n                    var $itemId = Hubs.Recommendations.markItemToHidePublishDate($el);\n                    if ($itemId) {\n                        this.hubState.previousState.set('lastRecoItm', $itemId)\n                    }\n                }\n\n                // Debug Statement\n                Shared.Logger.log('internal-link-click');\n\n                // Ignore if Carousel is currently Sliding\n                if (this.pageType === Hubs.PAGE_TYPE_ITEM && \n                    this.relatedCarousel !== null &&\n                     this.relatedCarousel.isSliding()\n                ) {\n                    return false;\n                }\n\n                // Prevent Default Action and Event Propagation\n                this.preventBubbling();\n                e.preventDefault();\n                e.stopPropagation();\n\n                // Check for Source URL Attribute\n                if (((Hubs.isMobile() && \n                    $(Hubs.Config.containers.mobileFlipbook).length) || \n                    Hubs.Config.labOptions.flipbookBreakOut) && \n                    /uberflip/i.test(type) && sourceUrl !== undefined\n                ) {\n                    $tile = $el.closest('.tile');\n\n                    if (flipbookPage !== '') {\n                        sourceUrl += '/' + flipbookPage;\n                    }\n                    sourceUrl += '?hubItemID='+$tile.attr('data-id');\n                } else {\n                    // Get Correct Text to Display in Title Bar\n                    title = $el.attr('data-page-title');\n                    if (title === undefined || !title.length) { title = $el.text(); }\n                    // Get seo title\n                    seoTitle = $el.attr('data-seo-title');\n\n                    // Get URL of Link\n                    sourceUrl = $el.attr('href');\n                }\n                this.setRecoTrackingInformation(recotrk, visual);\n\n                // Change Page Internally\n                this.requestInternalPageChange(sourceUrl, type, title, seoTitle);\n\n                // Prevent Event Bubbling\n                return false;\n            }, this));\n        }, this));\n\n        // Find all non-hooked external sharing links\n        $('a[data-share]:not(.hooked)').each($.proxy(function(idx, el){\n            var $anchor = $(el), attr = $anchor.attr('data-share');\n            if (attr === undefined || attr === 'false') { return; }\n\n            // Attach click event to links and mark as \"hooked\"\n            $anchor.addClass('hooked').on(Hubs.TAP_EVENT, $.proxy(function(e) {\n                var popupWin, popupTarget = '', \n                    $el = $(e.currentTarget), \n                    url = $el.attr('href'), type = $el.attr('data-share');\n\n                // Debug Statement\n                Shared.Logger.log('external-share-link-click');\n\n                // Prevent Default Action\n                this.preventBubbling();\n                e.preventDefault();\n                e.stopPropagation();\n\n                // Ignore if Carousel is currently Sliding\n                if (this.pageType === Hubs.PAGE_TYPE_ITEM &&\n                     this.relatedCarousel !== null &&\n                     this.relatedCarousel.isSliding()\n                ) { \n                    return false; \n                }\n\n                if($el.attr('data-addthis-sharing') === undefined) {\n                    // Open Window for Share Service\n                    if (Hubs.isMobile() && type === 'email') { popupTarget = '_top'; }\n\n                    popupWin = Hubs.root.open(url, \n                        popupTarget, 'left=100,top=100,width=550,height=450,personalbar=0,toolbar=0,scrollbars=1,resizable=1'\n                    );\n\n                    // Force Close the Popup on Desktop\n                    if (!Hubs.isMobile() && type === 'email') {\n                        Hubs.root.setTimeout(function() {\n                            if (!popupWin.location || popupWin.location.href === 'about:blank') {\n                                popupWin.close();\n                            }\n                        }, 5000);\n                    }\n                }\n\n                // Close Open Menus\n                Hubs.closeOpenMenus();\n\n                // Tracking\n                var itmID = ($el.attr('data-item-id') !== undefined) ? $el.attr('data-item-id') : this.currentItemId;\n                $.ajax(Shared.absoluteHubUrl(Hubs.Config.serverUrl.socialTracking), {\n                    type: 'POST',\n                    data: {\n                        hub: Hubs.Config.hubId,\n                        col: this.currentCollectionId,\n                        itm: itmID,\n                        social: type\n                    }\n                });\n\n                // Prevent Event Bubbling\n                return false;\n            }, this));\n        }, this));\n\n        // Find all non-hooked CTA links and add Tracking\n        $('.cta-website a:not(.tracked), .home-web-cta a:not(.tracked)').each($.proxy(function(idx, el) {\n            var $anchor = $(el),\n                ctaId = $anchor.data('ctaId');\n\n            // Attach click event to links and mark as \"hooked\"\n            $anchor.addClass('tracked').one(Hubs.CLICK_EVENT + \".ctaTracking\", $.proxy(function(e) {\n                // Debug Statement\n                try {\n                    Shared.ajaxFetch(Hubs.Config.serverUrl.ctaTracking, {\n                        hub: Hubs.Config.hubId,\n                        cta: ctaId,\n                        col: this.currentCollectionId,\n                        itm: this.currentItemId,\n                        prevCol: this.hubState.previousState.get('collectionId'),\n                        prevItm: this.hubState.previousState.get('itemId')\n                    }, 'GET');\n                } catch (e1) {} //TODO ignore metrics failures for now\n\n                return true;\n            }, this));\n        }, this));\n    };\n\n    /**\n     * constructMetricsParams():\n     *   Returns a list of metrics that must be passed to hubs server on every page change,\n     *   appended to targetUrl as query.\n     *\n     * @private\n     * @this Hubs.App\n     * @return {Object} Metric parameters\n     */\n    Hubs.App.prototype.constructMetricsParams = function() {\n        var metricParams = {\n            prevItm: this.currentItemId,\n            prevCol: this.currentCollectionId,\n            ts: Date.now() - this.pageTimer,\n        };\n\n        var isTrackingRecommendations = this.recoTracking && this.recoVisual;\n        if (isTrackingRecommendations) {\n            metricParams.recotrk = this.recoTracking;\n            metricParams.visual = this.recoVisual;\n        }\n\n        return metricParams;\n    };\n\n    /**\n     * initCollectionState():\n     *   If current page is a Collection, load previously saved page number and scrollTop.\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.initCollectionState = function() {\n        this.clearCollectionState();\n\n        var isCollection = Hubs.COLLECTION_PAGE_TYPES.indexOf(this.pageType) !== -1;\n        var page = (this.queryString || {}).page || 0;\n        var scrollTop = (this.queryString || {}).scrollTop || 0;\n\n        if (isCollection && (page || scrollTop)) {\n            this.setCollectionState(page, scrollTop);\n        }\n    };\n\n      /**\n     * isTrackingAllowed():\n     *   Check is all privacy groups have been accpeted.\n     *   Will return false if one group has not been accpeted\n     *\n     * @private\n     * @this Hubs.App\n     * @return boolean\n     */\n    Hubs.App.prototype.isTrackingAllowed = function() {\n        var cookie = $.cookie(Hubs.PRIVACY_PREFS_COOKIE_NAME);\n        if (!cookie) return false;\n\n        var cookieArr = cookie.split('|');\n\n        // remove the cookie version value - we don't need it\n        // remove the banner status value - we don't need it\n        cookieArr.splice(0, 2);\n\n        var privacyGroupsAccepted = true;\n        var groupAcceptedStatus = 2;\n\n        $.each(cookieArr, function (i, csv) {\n            var group = csv.split(',');\n            if (parseInt(group[groupAcceptedStatus], 10) === 0) {\n                privacyGroupsAccepted = false;\n            }\n        });\n\n        return privacyGroupsAccepted;\n    };\n\n      /**\n     * removeExcludedParams():\n     *   Get the query params, and filter pararms\n     *   Return the filtered params\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.removeExcludedParams = function() {\n        var toExclude = Hubs.Config.ufQueryStrings;\n        var remainingParams = Shared.getQueriesWithout(toExclude);\n        return Shared.removeCustomCodeCommands(remainingParams);\n    }\n\n     /**\n     * persistQueryParamsForCtaFields():\n     *   When page is initialized, grab Query Params from URL that we need to track\n      *  for marketing, and save them to local storage. When Form CTA is submitted,\n      *  we will include them in the \"extraParams\" property.\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.persistQueryParamsForCtaFields = function(params) {\n        if (this.isTrackingAllowed()) {\n            var paramValues = this.removeExcludedParams();\n            var storedCtaQueryParams = localStorage.getItem(Hubs.CTA_LOCALSTORAGE_KEY);\n            var storedValues = storedCtaQueryParams ? JSON.parse(storedCtaQueryParams) : {};\n            var newValuesToStore = $.extend({}, storedValues, paramValues);\n            localStorage.setItem(Hubs.CTA_LOCALSTORAGE_KEY, JSON.stringify(newValuesToStore));\n        }\n    }\n\n\n    /**\n     * cleanUrlQueryString():\n     *   When page is initialized, clean-up the current url query to hide\n     *   parameters that don't need to persist after page change has completed.\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.cleanUrlQueryString = function() {\n        var urlParts = Hubs.root.self.location.href.split('?');\n\n        var noQueryString = urlParts.length === 1;\n        if (noQueryString) { return; }\n\n        var remainingParams = this.removeExcludedParams();\n        var queryParams = $.param(remainingParams);\n        var hash = Hubs.root.self.location.hash;\n        var url = urlParts[0] + (queryParams && '?' + queryParams) + hash;\n\n        this.history.replaceState(null, null, url);\n    };\n\n    /**\n     * Handle link click events.\n     *\n     * @public\n     * @this Hubs.App\n     * @param {Object} data = Info of new history state (type, title)\n     * @param {String} title = New page title\n     * @param {String} url = New page url\n     * @return undefined\n     */\n    Hubs.App.prototype.requestChangePage = function (data, title, url) {\n        // NOTE: Don't refactor this function signature. It needs to remain the same for backward-\n        // compatibility.\n\n        // Remove Fullscreen Mode when changing pages\n        if ($(Hubs.Config.containers.flipbookContainer).hasClass('fullscreen')) {\n            this.toggleFullscreen(false);\n        }\n\n        // Close Search Results (if open)\n        this.search.closeSearch();\n\n        // Close any open menus\n        Hubs.closeOpenMenus();\n\n        // Show Loading Overlay\n        this.$loadingOverlay.show();\n\n        // Update loading spinner position\n        if (Hubs.isEmbedded()) {\n            this.repositionLoadingIndicator();\n        }\n\n        // Redirect to url\n        Hubs.root.self.location.href = this.constructRedirectUrl(url);\n    };\n\n    /**\n     * constructRedirectUrl():\n     *   Append query parameters to targetUrl when handling page change.\n     *\n     * @private\n     * @this Hubs.App\n     * @param {String} targetUrl = New page from link click event (has trailing ?embedded=1)\n     * @return {String} Url with query string\n     */\n    Hubs.App.prototype.constructRedirectUrl = function(targetUrl) {\n        var metricsParams = this.constructMetricsParams();\n        var embedParams = Hubs.isEmbedded() ? $.param(this.pickEmbedOptionParams()) : '';\n        var baseUrl = targetUrl.split('?')[0] + '?';\n        return baseUrl + $.param(metricsParams) + (embedParams && '&' + embedParams);\n    };\n\n    /**\n     * setPreviousStateOnExit():\n     *   Used before a page change. Save current state to memory so it can be used for tracking\n     *   assist metrics on any CTAs that are submitted on the next page.\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.setPreviousStateOnExit = function () {\n        this.hubState.previousState.set('collectionId', this.currentCollectionId);\n        this.hubState.previousState.set('collectionType', this.collectionType);\n        this.hubState.previousState.set('itemId', this.currentItemId);\n    };\n\n    /**\n     * setCollectionStateOnExit():\n     *   Used before a page change. If current page is a Collection, save page number\n     *   and scrollTop to memory, so we can revert to position if user clicks Back browser\n     *   button. Also, clear existing memory because we only want this feature on Back click.\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.setCollectionStateOnExit = function() {\n        var isCollection = this.currentCollectionId !== 0;\n\n        this.clearCollectionState();\n\n        if (this.lazyLoader && isCollection && !Shared.IOS8_1) {\n            var page = this.lazyLoader.currentPage;\n            var scrollTop = 0;\n\n            if (Hubs.isEmbedded()) {\n                var hasIFrameScrollTop = this.viewportData && this.viewportData.scrollTop;\n                if (hasIFrameScrollTop) scrollTop = this.viewportData.scrollTop;\n            } else {\n                scrollTop = Shared.scrollTop();\n            }\n            this.setCollectionState(page, scrollTop);\n\n            // On page exit, update current url with page number and scrollTop\n            var collectionState = Hubs.isEmbedded() ? {page: page, scrollTop: scrollTop} : {page: page};\n            var currentUrl = Hubs.root.location.href;\n            var appendParams = (currentUrl.match(/\\?/g) ? '&' : '?') + $.param(collectionState);\n\n            // Params for page 0 don't change behaviour so don't include them for sake of cleanliness!\n            var ignoreParams = !Hubs.isEmbedded() && page === 0;\n\n            if (!ignoreParams) this.history.replaceState(null, null, currentUrl + appendParams);\n        }\n    };\n\n    /**\n     * setCollectionState():\n     *   Save current page number and scrollTop to Collection memory.\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.setCollectionState = function(page, scrollTop) {\n        var currentUrl = Hubs.root.location.href.split('?')[0];\n        var collectionState = {\n            page: parseInt(page, 10),\n            scrollTop: parseInt(scrollTop || 0, 10)\n        };\n        this.hubState.collections.set(currentUrl, collectionState);\n    };\n\n    /**\n     * getCollectionState():\n     *   If current page is a Collection, get page number and scrollTop from memory.\n     *\n     * @public\n     * @this Hubs.App\n     * @return {page, scrollTop} or undefined\n     */\n    Hubs.App.prototype.getCollectionState = function() {\n        var currentUrl = Hubs.root.location.href.split('?')[0];\n        var defaultState = {page: 0, scrollTop: 0};\n        return this.hubState.collections.get(currentUrl) || defaultState;\n    };\n\n    /**\n     * clearCollectionState():\n     *   Clear session memory for collection namespace.\n     *\n     * @public\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.clearCollectionState = function() {\n        this.hubState.collections.clear();\n    };\n\n    /**\n     * Determines the Page Type based on the Partial Data\n     *     - Accordingly sets internal flags to indicate Page Type and Collection Type\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.determinePageType = function() {\n        var $el = $(Hubs.Config.containers.pageIdentifier);\n\n        // Reset Current Collection Details\n        this.collectionType = Hubs.COLLECTION_TYPE_NONE;\n        this.currentCollectionId = 0;\n        this.currentItemId = 0;\n        this.collectionCount = 0;\n\n        // Determine Type of Page\n        if (!$el.length) {\n            this.pageType = Hubs.PAGE_TYPE_HUB;\n        } else {\n            this.pageType = Hubs[$el.attr('data-page-type')];\n            this.collectionType = $el.attr('data-collection-type');\n            this.currentItemId = parseInt($el.attr('data-item-id'), 10);\n            this.currentItemTags = $el.data('tags');\n            this.currentCollectionId = $el.attr('data-collection-id');\n            this.currentAuthorId = $el.attr('data-author-id');\n            this.itemType = $el.attr('data-item-type');\n            this.currentCollectionId = parseInt(this.currentCollectionId, 10) || this.currentCollectionId;\n            this.collectionCount = parseInt($el.attr('data-collection-count') || 0, 10);\n            this.itemPreviewEnabled = $el.attr('data-item-preview');\n        }\n    };\n\n    /**\n     * Set the recommendation tracking info. This will be used upon click to\n     * to pass these values to the next page.\n     *\n     * @param recotrk\n     * @param visual\n     * @see Hubs.App.prototype.constructMetricsParams\n     */\n    Hubs.App.prototype.setRecoTrackingInformation = function(recotrk, visual) {\n        this.recoTracking = recotrk || null;\n        this.recoVisual = visual || null;\n    };\n\n    /**\n     * Updates the Classname on the MoveToTop Element depending on the Page Type\n     *     - This is used to provide certain style overrides via CSS for certain Page Types.\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.updateMoveToTopClass = function() {\n        var $pageWidthEl = $(Hubs.Config.containers.itemContent);\n        var $moveToTopEl = Shared.$(Hubs.Config.containers.moveToTop);\n        if ($pageWidthEl.length && $moveToTopEl.length) {\n            $moveToTopEl.addClass('item-level');\n            if ($pageWidthEl.hasClass('with-cta')) {\n                $moveToTopEl.addClass('with-cta');\n            }\n        } else {\n            $moveToTopEl.removeClass('item-level with-cta');\n        }\n    };\n\n    /**\n     * Updates the Selected Collection Group in the Navigation Menu based on the Current Page Type\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.updateSelectedMenu = function() {\n        var $leftNav = Shared.$(Hubs.Config.containers.leftNav[2]),\n            $selected = null;\n\n        // Reset Selected Menu\n        $leftNav.find('li.selected').removeClass('selected');\n\n        if (this.collectionType === '') {\n            this.collectionType = null;\n        }\n\n        // Set Selected Menu\n        if (this.pageType === Hubs.PAGE_TYPE_HUB) {\n            $leftNav.find('li.home').addClass('selected');\n        } else {\n            if (this.collectionType !== null) {\n                if (Hubs.ITEM_COLLECTION_MAP[this.collectionType] === undefined) {\n                    $leftNav.find('li.' + this.collectionType).addClass('selected');\n                    $leftNav.find('li.' + this.collectionType + '-' + this.currentCollectionId).addClass('selected');\n                } else {\n                    $leftNav.find('li.' + Hubs.ITEM_COLLECTION_MAP[this.collectionType]).addClass('selected');\n                    $leftNav.find('li.' + Hubs.ITEM_COLLECTION_MAP[this.collectionType] + '-' + this.currentCollectionId).addClass('selected');\n                }\n\n                // Set the custom menu items to selected for that case (they don't use the collection types but rather collection ids)\n                $selected = $leftNav.find('li.custom-menu-item[data-collection-id=\"' + this.currentCollectionId + '\"]');\n                $selected.addClass('selected');\n                $selected.closest('li.custom-menu-item:not(.selected)').addClass('selected');\n            }\n        }\n    };\n\n    /**\n     * Update Page-Specific Elements based on Page Type\n     *     - Flipbooks open in an overlayed iframe, so the content behind must still be functional\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.updatePageSpecific = function() {\n        // Debug Statement\n        Shared.Logger.log('page-update-specific');\n\n        // Update Page-Width Element\n        Hubs.updatePageWidthElement(this.pageType);\n\n        if (!this.isRecommendationEnabled()) {\n            // Create Carousel Control for Related Items (if exists)\n            this.createCarousel('related');\n        }\n\n        // Create LazyLoader Control for Collection Items (if exists)\n        this.createLazyLoader();\n\n        // Need to make the timestamps appear friendly\n        Hubs.setFriendlyTimestamps();\n\n        // Adding form cta handling\n        this.initializeFormCtas();\n\n        if (this.pageType === Hubs.PAGE_TYPE_ITEM) {\n            // Update Size of Video Players (if exists)\n            Hubs.updateVideoSize(this.itemType);\n\n            // Toggle the Show More link for long content (if exists)\n            this.toggleShowMore();\n\n            // Fix Content Images in DOM\n            Hubs.fixContentImages(this.collectionType, Hubs.Config.containers.itemContent);\n\n            // Fix the next/previous Images in DOM\n            Hubs.fixPrevNextImages(Hubs.Config.containers.itemContent);\n\n            // Fix Content Liks in DOM\n            Hubs.fixContentLinks(Hubs.Config.containers.itemContent);\n\n            // Load non proxied images\n            Hubs.loadNonProxiedImages();\n\n            // Document Type Content (Flipbook)\n            if (Hubs.REGEX_FLIPBOOK.test(this.itemType)) {\n                this.initDocEvents();\n            }\n        }\n\n        // activate the privacy banner or hook the privacy page toggles\n        this.initPrivacyCookieManagement();\n\n        // Override behaviour of Links. Run after Hubs.fixContentLinks() cause data-internal might change\n        this.overrideLinks();\n\n        var hiddenBlockingCta = this.showFormCtas(this.lazyLoader, this.pageType);\n\n        // Store Page View if item type (needs to happen after determining if there's hidden blocking CTA)\n        if (this.pageType === Hubs.PAGE_TYPE_ITEM) {\n            Hubs.storePageView(this.itemType, this.currentItemId, this.currentCollectionId, hiddenBlockingCta);\n        }\n\n        // Images Loaded Event\n        Hubs.updateImageTiles(this, '.tile .img');\n\n        // Update Menu Selection\n        this.updateSelectedMenu();\n\n        // Update Position of Sharing on Level 3 Items\n        this.repositionLevel3Sharing();\n\n        // Resize Instagram Videos\n        this.resizeInstagramVideo();\n\n        // Resize Shaing Menu\n        this.resizeHubShare();\n\n        // Reposition CTA for Item Views\n        this.repositionCta();\n\n        //Reposition the header hero\n        this.repositionHeader();\n\n        // Resize All CTA Text\n        this.responsiveCtaText();\n\n        // Record CTA views\n        Hubs.App.recordCtaViews();\n\n        this.hidePublishDate();\n\n        // Scroll-to position on page change (only non-embedded hubs)\n        if (!Hubs.isEmbedded()) {\n            var skipScrollWhenHasHashString = Hubs.root.location.hash.length;\n            if (skipScrollWhenHasHashString) { return }\n\n            var collectionState = this.getCollectionState();\n            var revertCollectionScrollTop = collectionState && collectionState.scrollTop;\n            if (revertCollectionScrollTop) Shared.scrollTop(collectionState.scrollTop);\n        }\n    };\n\n    /**\n     * Callback for the recommendations to set up asynchronously loaded elements\n     */\n    Hubs.App.prototype.initAsyncPageElements = function() {\n\n        // Create Carousel Control for Related Items (if exists)\n        this.createCarousel('related');\n\n        // Override behaviour of Links.\n        this.overrideLinks();\n\n        // Images Loaded Event\n        Hubs.updateImageTiles(this, '.tile .img');\n\n        if (this.pageType === Hubs.PAGE_TYPE_ITEM && this.itemPreviewEnabled) {\n            this.enableItemPreview();\n        }\n    };\n\n    /**\n     * Creates the LazyLoader Control\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.createLazyLoader = function() {\n        // Check for LazyLoader Elements\n        var $container = $(Hubs.Config.lazyloader.elements.container);\n        if ($container.length) {\n            // Create LazyLoader Control\n            this.lazyLoader = new Hubs.LazyLoader(this);\n        }\n    };\n\n    /**\n     * Creates a Carousel Control for the Specified Type (Featured, Related)\n     *\n     * @private\n     * @this Hubs.App\n     * @param {String} carouselName The name of the Carousel to Create\n     * @return undefined\n     */\n    Hubs.App.prototype.createCarousel = function(carouselName) {\n        // Check for Carousel Elements\n        var config, $container = $('#' + carouselName + '-items');\n        if ($container.length) {\n            // Update Configs for Carousel\n            config = $.extend(true, {}, Hubs.Config.carousel, {'name' : carouselName, 'itemsUpdated' : this.carouselItemsUpdated()});\n\n            // Create Carousel Control\n            this[carouselName + 'Carousel'] = new Shared.Carousel(config);\n        }\n    };\n\n    /**\n     * carouselItemsUpdated - Returns a function for the Carousel with specific behavior for the Type of Carousel\n     *\n     * @private\n     * @this Hubs.App\n     * @return {Function}\n     */\n    Hubs.App.prototype.carouselItemsUpdated = function() {\n        /**\n         * [Anonymous Function] - Updates Elements after the Carousel Items have Been Updated\n         *\n         * @private\n         * @this Hubs.App\n         * @return undefined\n         */\n        return $.proxy(function(itemCount, lazyLoadLimit, $carouselItem) {\n            var i = 0, $item = null;\n            Hubs.updateImageTiles(this, '.tile .img');\n            Hubs.setFriendlyTimestamps();\n            this.overrideLinks();\n        }, this);\n    };\n\n    /**\n     * Toggles the display of the \"Show More\" link on Level 3 item pages\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.toggleShowMore = function() {\n        var $showMoreLink = $(Hubs.Config.containers.showMoreLink),\n            $descWrapper, $fullDesc, $showMoreAnchor = null,\n            showMoreText = $showMoreLink.find('a').attr('data-show-more'),\n            showLessText = $showMoreLink.find('a').attr('data-show-less'),\n            descWrapperHeight = 0;\n\n        if (!$showMoreLink.length) { return; }\n\n        $descWrapper = $(Hubs.Config.containers.descWrapper);\n        $fullDesc = $(Hubs.Config.containers.fullDesc);\n\n        // Get Default Height of Description Wrapper\n        descWrapperHeight = $descWrapper.height();\n        this.fullDescDisplayed = false;\n\n        // Check if Content Description exceeds the Wrapper Bounds\n        if ($fullDesc.height() > descWrapperHeight) {\n            $showMoreLink.find('a').addClass('hooked');\n            $showMoreLink.css({'display': 'block'}).on(Hubs.TAP_EVENT, $.proxy(function(e) {\n                if (this.fullDescDisplayed) {\n                    $descWrapper.animate({'height': '3.6em'});\n                    $showMoreLink.find('a').text(showMoreText);\n                } else {\n                    $descWrapper.animate({'height': $fullDesc.outerHeight(true)});\n                    $showMoreLink.find('a').text(showLessText);\n                }\n                this.fullDescDisplayed = !this.fullDescDisplayed;\n            }, this));\n\n            // Center the Show More link\n            if (Hubs.isMobile()) {\n                $showMoreAnchor = $showMoreLink.find('> a');\n                $showMoreAnchor.css({'margin-left': (($showMoreLink.width() - $showMoreAnchor.width()) / 2) });\n            }\n        } else {\n            $showMoreLink.css({'display': 'none'});\n        }\n    };\n\n    /**\n     * Prevents Bubbling on Clicks up to the Body Level after a Set Timeout to allow Tap Events to Close Side Menu\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.preventBubbling = function() {\n        this.mobileNavClicked = true;\n        Hubs.root.setTimeout($.proxy(function() { this.mobileNavClicked = false; }, this), 100);\n    };\n\n    /**\n     * Privacy Management\n     */\n    Hubs.App.prototype.getPrivacyBannerState = Hubs.PrivacyHelpers.getPrivacyBannerState;\n\n    Hubs.App.prototype.savePrivacyGroupPreferences = Hubs.PrivacyHelpers.savePrivacyGroupPreferences;\n\n    Hubs.App.prototype.formatPrivacyCookieValue = Hubs.PrivacyHelpers.formatPrivacyCookieValue;\n\n    Hubs.App.prototype.setPrivacyCookieValue = Hubs.PrivacyHelpers.setPrivacyCookieValue;\n\n    Hubs.App.prototype.ufaOptIn = Hubs.PrivacyHelpers.ufaOptIn;\n\n    Hubs.App.prototype.ufaOptOut = Hubs.PrivacyHelpers.ufaOptOut;\n\n    Hubs.App.prototype.initPrivacyCookieManagement = function() {\n        var $banner = $('#uf-privacy-banner');\n\n        function setPrivacyBannerHidden() {\n            var cookie = $.cookie(Hubs.PRIVACY_PREFS_COOKIE_NAME);\n            if (cookie) {\n                var cookieArr = cookie.split('|');\n                cookieArr[1] = Hubs.SHOW_NO_BANNER;\n                this.setPrivacyCookieValue(cookieArr.join('|'));\n            } else {\n                // Create new cookie where Privacy Banner is dismissed\n                Hubs.Privacy.saveChanges();\n            }\n        }\n\n        function hookPrivacyBanner() {\n            function handleExitClick() {\n                $banner.hide();\n                setPrivacyBannerHidden.call(this);\n            }\n\n            function handleAcceptClick() {\n                Hubs.Privacy.acceptAll();\n                Hubs.Privacy.applyChanges();\n                handleExitClick.call(this);\n            }\n\n            // Dismiss Banner\n            $banner.on('click', '#privacy-banner-close', handleExitClick.bind(this));\n\n            // Privacy Link Click\n            $banner.on('click', '[data-privacy-action=\"manage\"]', handleExitClick.bind(this));\n\n            // Accept button Click\n            $banner.on('click', '[data-privacy-action=\"accept\"]', handleAcceptClick.bind(this));\n        }\n\n        function updateBannerVisibilityOnPageChange() {\n            // No banner on embed tiles\n            if (Hubs.Config.isEmbeddedTile) { return; }\n\n            var bannerState = parseInt($banner.data('showBanner'), 10) || 0;\n            if (bannerState === 1 || bannerState === 2) {\n                $banner.fadeIn('fast');\n            } else {\n                $banner.hide();\n            }\n        }\n\n        /**\n         * Privacy Banner\n         */\n        function initPrivacyBanner() {\n            // No banner on embed tiles\n            if (Hubs.Config.isEmbeddedTile) { return; }\n\n            hookPrivacyBanner.call(this);\n            updateBannerVisibilityOnPageChange();\n        };\n\n        /**\n         * Privacy Policy page\n         */\n        function initPrivacyPolicyPageSettings() {\n            function handleTogglePrivacyGroup(event) {\n                var checkboxElement = $(event.currentTarget);\n                var isChecked = checkboxElement.is(':checked');\n                var privacyGroupId = checkboxElement.closest(toggleSelector).attr('data-group-id');\n                var methodName = isChecked ? 'acceptById' : 'rejectById';\n                Hubs.Privacy[methodName](privacyGroupId);\n            }\n\n            // Hook Toggle Events:\n            var toggleSelector = '.uf-privacy-group-toggle';\n            $(toggleSelector + ' input').on('change', handleTogglePrivacyGroup);\n        }\n\n        var pageType = $('#page-type-identifier').attr('data-page-type');\n        if (pageType === 'PAGE_TYPE_PRIVACY') {\n            initPrivacyPolicyPageSettings();\n        }\n\n        initPrivacyBanner.call(this);\n    };\n\n    /**\n     * Signals that the temp metrics data that we've stored server-side can be transmitted to the metrics store\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.signalMetricsTemp = function() {\n        if(Hubs.Config.isEmbeddedTile || Hubs.Config.disableUfMetrics) {\n            return;\n        }\n\n        var metricsTempId = $(Hubs.Config.containers.pageIdentifier).attr('data-metrics-temp-id');\n        if(metricsTempId === undefined || !metricsTempId.length) {\n            metricsTempId = '';\n        }\n        (new Image()).src = Shared.absoluteHubUrl(Hubs.Config.serverUrl.signalMetricsTemp) + '/' + metricsTempId + '?t=' + (new Date().getTime());\n    };\n\n    /**\n     * Loads the extra info at item level\n     *\n     * @private\n     * @this Hubs.App\n     * @return undefined\n     */\n    Hubs.App.prototype.loadExtraInfo = function() {\n        // Callbacks by service\n        var services = {\n            'twitter': function(extraInfo, $itemContainer) {\n                // Display the numbers of retweets and favourites\n                $.each(extraInfo, function (index, count) {\n                    var $info = $itemContainer.find('.info .' + index);\n                    if (count > 0) {\n                        $info.show().find('.count').text(count);\n                        if (count > 1) {\n                            $info.find('.plural').show();\n                        }\n                    }\n                });\n            },\n            'instagram': function(extraInfo, $itemContainer) {\n                // Display the likes and the comments\n                var compiled;\n                var diff;\n                var likeTemplate = '<a title=\"<%= _.escape(username) %>\" href=\"https://instagram.com/<%= _.escape(username) %>\" target=\"_blank\" rel=\"noopener\"><img alt=\"<%= _.escape(username) %>\" src=\"<%= _.escape(profile_picture) %>\" /></a>';\n                var commentTemplate = '<div class=\"comment\">' +\n                    '<div class=\"text\">' +\n                    '<a href=\"https://instagram.com/<%= _.escape(from.username) %>\" target=\"_blank\" rel=\"noopener\"><%= _.escape(from.username) %></a>' +\n                    '<span><%= _.escape(text) %></span>' +\n                    '</div>' +\n                    '</div>';\n\n                if (extraInfo.likes && extraInfo.likes.length > 0) {\n                    $itemContainer.find('.likes').show();\n                    compiled = _.template(likeTemplate);\n                    $.each(extraInfo.likes, function (index, like) {\n                        // Display 3 likes at most\n                        if (index == 3) {\n                            diff = extraInfo.likes.length - index;\n                            $itemContainer.find('.likes .more').show().find('.diff').text(diff);\n                            if (diff > 1) {\n                                $itemContainer.find('.likes .more .plural').show();\n                            }\n                            return false;\n                        }\n                        var likeHtml = compiled(like);\n                        $itemContainer.find('.likes .list').append(likeHtml);\n                    });\n                }\n\n                if (extraInfo.comments && extraInfo.comments.length > 0) {\n                    $itemContainer.find('.comments').show().find('.count').text(extraInfo.comments.length);\n                    if (extraInfo.comments.length > 1) {\n                        $itemContainer.find('.comments .plural').show();\n                    }\n                    compiled = _.template(commentTemplate);\n                    $.each(extraInfo.comments, function (index, comment) {\n                        // Display 30 comments at most\n                        if (index == 30) {\n                            diff = extraInfo.comments.length - index;\n                            $itemContainer.find('.comments .more').show().find('.diff').text(diff);\n                            return false;\n                        }\n                        var commentHtml = compiled(comment);\n                        $itemContainer.find('.comments .list').append(commentHtml);\n                    });\n                }\n            }\n        };\n\n        if(services[this.itemType] === undefined) {\n            return;\n        }\n\n        Shared.ajaxFetch(Hubs.Config.serverUrl.extraInfo + this.currentItemId, \n            {}, 'GET', true,  \n            $.proxy(function(data) {\n                if (data.response && data.response.extraInfo) {\n                    services[this.itemType].apply(this, [data.response.extraInfo, $(Hubs.Config.containers.itemContent)]);\n                }\n            }, this)\n        );\n    };\n\n    Hubs.App.recordCtaViews = function() {\n        var pageIdentifier = $(Hubs.Config.containers.pageIdentifier);\n\n        if (Hubs.CTAs.ctasForViewTracking.length) {\n            Shared.Logger.log('recording view for ctas: ' + JSON.stringify(Hubs.CTAs.ctasForViewTracking));\n            var jqxhr = $.ajax(Shared.absoluteHubUrl(Hubs.Config.serverUrl.ctaViewTracking), {\n                type: 'POST',\n                data: {\n                    hubId: Hubs.Config.hubId,\n                    ctas: Hubs.CTAs.ctasForViewTracking,\n                    metricsKey: pageIdentifier.attr('data-metrics-temp-id')\n                }\n            });\n\n            // Once we are done the request, reset the list of CTAs to track.\n            jqxhr.then(function(){\n                Hubs.CTAs.ctasForViewTracking = [];\n            });\n        }\n    };\n\n    Hubs.App.prototype.hidePublishDate = function() {\n        var pageIdentifier = $(Hubs.Config.containers.pageIdentifier);\n\n        if (pageIdentifier.data('page-type') !== 'PAGE_TYPE_ITEM') {\n            return;\n        }\n\n        var date = $(Hubs.Config.containers.date);\n        var itemId = pageIdentifier.data('item-id');\n        var itemToHide = this.hubState.previousState.get('lastRecoItm');\n\n\n        Shared.Logger.log('current reco item stored: ' + JSON.stringify(itemToHide));\n        if (itemToHide === itemId) {\n            date.hide();\n        }\n\n        this.hubState.previousState.remove('lastRecoItm');\n    };\n\n    /* if updating this function:\n     another copy of it exist under Flipbooks namespace\n     make sure to update it too\n     */\n    Hubs.App.prototype.pdfDownload = function (flipbookId) {\n        if (Hubs.appInstance.ufaCaller) {\n            var ufaCaller = Hubs.appInstance.ufaCaller;\n            ufaCaller.trackFlipbookDownload(flipbookId);\n        }\n\n        var statsUrl = Shared.absoluteHubUrl('/issues/download/issue/' + flipbookId);\n        // Debug Message\n        Shared.Logger.log('stats-page-pdf-download');\n\n        function qAjax(options) {\n            var deferred = Q.defer();\n\n            // Ensure we have a Valid URL\n            if (options === undefined || options.url === undefined || !options.url.length) {\n                deferred.reject('invalid url');\n            }\n\n            // Check for Other Options for AJAX\n            if (options.type === undefined) { options.type = 'POST'; }\n            if (options.data === undefined) { options.data = {}; }\n            if (options.async === undefined) { options.async = true; }\n            if (options.dataType === undefined) { options.dataType = 'json'; }\n\n            // Success Handler; Resolve Promise\n            options.success = function(data) {\n                deferred.resolve(data);\n            };\n\n            // Error Handler; Reject Promise\n            options.error = function(jqXhr, textStatus, errorThrown) {\n                deferred.reject([jqXhr, textStatus, errorThrown]);\n            };\n\n            // Track Last AJAX Request\n            var LastXHR = $.ajax(options);\n\n            // Return Promise\n            return deferred.promise;\n        }\n\n        qAjax({'url': statsUrl, 'data': {'v': 'm4'}, 'dataType': 'html'}).then($.proxy(function(responseData) {\n            qAjax({'url': statsUrl, 'data': {'v': 'm4', 'data[Download][session]': responseData}, 'dataType': 'html'});\n        }, this));\n\n        return this;\n    };\n\n    /**\n     * Initializes the Splash Screen per Page Type\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.App.prototype.initSplashScreen = function(pageType) {\n        if (pageType === Hubs.PAGE_TYPE_HUB) {\n            Shared.scrollTop(0);\n        } else {\n            // Hide Large Header if visible on any page other than the main page\n            this.removeHeroHeader(false);\n        }\n    };\n\n    /**\n     * Removes the Hero Header\n     *\n     * @public\n     * @this local\n     * @param {Boolean} animate Whether or not to animate the removal\n     * @return undefined\n     */\n    Hubs.App.prototype.removeHeroHeader = function(animate) {\n        if (Hubs.Config.labOptions.permHeader \n            || Hubs.Config.labOptions.noHeader) { \n                return; \n            }\n\n        var $largeHeader = $(Hubs.Config.containers.largeHeader),\n            $desktopLeftNav = $(Hubs.Config.containers.leftNav[2] + '.desktop'),\n            headerHeight = $largeHeader.height(),\n            shrinkTo = headerHeight - Shared.scrollTop(),\n            transitionDuration = '',\n            removeHeader = $.proxy(function() {\n                // Large header is no longer needed, can remove and reset the header\n                $largeHeader.remove();\n                Shared.$('header').css(\"height\", \"auto\");\n\n                // Scroll to Top of Hub\n                if (Hubs.isEmbedded() && 'parentIFrame' in window) {\n                    // Signal Scroll\n                    window.parentIFrame.scroll('top');\n                } else {\n                    // if you have a Fragment Identifier don't move to top\n                    if (!Hubs.root.location.hash.length) {\n                        Shared.scrollTop(Shared.scrollTop() - headerHeight);\n                    }\n\n                }\n\n                if (Hubs.Privacy.isFunctionalityEnabled('UBERFLIPUI')) {\n                    this.hubState.userInterface.set('bannerDismissed', 1);\n                }\n            }, this);\n\n        // Check if Large Header exists\n        if ($largeHeader.length > 0) {\n\n            // Animate hiding of large header by moving it to the top\n            if(animate) {\n\n                $largeHeader.css({'margin-top': -shrinkTo}).css(\"border-bottom\", \"0\");\n                $(Hubs.Config.containers.headerLoading).css(\"opacity\", \"0\");\n\n                // Timeout used to wait until animation of moving large header to top is done\n                window.setTimeout(removeHeader, 1000);\n            } else {\n                // Remove large header immediately and scroll to top\n                // (Just in case user somehow manages to scroll off page and remove the header while on mobile)\n                Shared.$('body').off('touchmove.Hubs.preventMove');\n                removeHeader();\n            }\n        }\n    };\n\n    /**\n     * Finalizes the Splash Screen per Page Type\n     *\n     * @public\n     * @this local\n     * @return undefined\n     */\n    Hubs.App.prototype.finalizeSplashScreen = function (){\n        var $loader = $(Hubs.Config.containers.splashLoader),\n            $chevron = $(Hubs.Config.containers.splashChevron),\n            afterFade = function() {\n                if (!Hubs.isEmbedded()) {\n                    $(Hubs.Config.containers.headerLoading).addClass(\"hide-splash-state\");\n                } else {\n                    $(Hubs.Config.containers.headerLoading).fadeOut(200);\n                }\n                $(Hubs.Config.containers.largeHeader).find('h2, div.primary-logo').css(\"opacity\", 1);\n                $(Hubs.Config.containers.app).removeClass('invisible');\n            };\n\n        if (!Hubs.isEmbedded()) {\n            // Fade out the loader, fade in the chevron, change the background color\n            $loader.fadeOut(200, function() {\n                $chevron.fadeIn(300, afterFade);\n            });\n        } else {\n            // Fade out the loader, fade in the chevron, change the background color\n            $loader.fadeOut(200, afterFade);\n        }\n    };\n\n    // Augment App to have CTA, Responsive & Embedded Methods\n    Shared.augment(Hubs.App, [Hubs.CTAs, Hubs.Responsive, Hubs.Embedded, Hubs.Recommendations]);\n\n\n}(window.jQuery));"}]);