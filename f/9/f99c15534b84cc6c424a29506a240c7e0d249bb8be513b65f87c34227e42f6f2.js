/*! For license information please see template-stage-component.37041ad134f5721ba94f.chunk.v7.js.LICENSE.txt */
(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[615,56],{"/eUD":function(e,t,a){var n=a("zu5k"),r=a("ZbAl"),o=a("N1Lx"),i=o.MUST_USE_PROPERTY,c=o.HAS_BOOLEAN_VALUE,l=o.HAS_NUMERIC_VALUE,s=o.HAS_POSITIVE_NUMERIC_VALUE,u=o.HAS_OVERLOADED_BOOLEAN_VALUE;unction m(e,t,a){var n,r,o,m=e.Properties,p=e.DOMAttributeNames;for(r in m)t[n=p[r]||(a?r:r.toLowerCase())]={attributeName:n,propertyName:r,mustUseProperty:d(o=m[r],i),hasBooleanValue:d(o,c),hasNumericValue:d(o,l),hasPositiveNumericValue:d(o,s),hasOverloadedBooleanValue:d(o,u)}}var p={};m(n,p);var f={};m(r,f,!0);var v={};m(n,v),m(r,v,!0),e.exports={html:p,svg:f,properties:v,isCustomAttribute:RegExp.prototype.test.bind(new RegExp("^(data|aria)-[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"))}},"/vfh":"1NSz":function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a("QjXU"),r=a("ovpI"),o=a("kbrL"),i=a("Sn4U"),c=a("5DIn"),l=a("AcOL"),s=a("8Jek"),u=a.n(s),d=a("mXGw"),m=a.n(d),p={button:"DropdownMenu-module__button__2dcDo","button--default":"DropdownMenu-module__button--default__1VlBB","button--small":"DropdownMenu-module__button--small__elUU4","button--hover":"DropdownMenu-module__button--hover__1soZ4","button--open":"DropdownMenu-module__button--open__2Fx_g","menu-wrapper":"DropdownMenu-module__menu-wrapper__2zWDA",menu:"DropdownMenu-module__menu__VFRSY","menu--large":"DropdownMenu-module__menu--large__3xoSs","menu--right":"DropdownMenu-module__menu--right___y-WY","menu-content":"DropdownMenu-module__menu-content___mCP2","menu-item-wrapper":"DropdownMenu-module__menu-item-wrapper__X7xKS","menu-item-wrapper--default":"DropdownMenu-module__menu-item-wrapper--default__1q5oE","menu-item-wrapper--small":"DropdownMenu-module__menu-item-wrapper--small__3GfUE","upper-divider":"DropdownMenu-module__upper-divider__1Wp9x","menu-item":"DropdownMenu-module__menu-item__ZoBwi","menu-item-text":"DropdownMenu-module__menu-item-text__1xIHA",hidden:"DropdownMenu-module__hidden__1Co_B","menu-item-icon-wrapper":"DropdownMenu-module__menu-item-icon-wrapper__swMcC",checkbox:"DropdownMenu-module__checkbox__1F-Nd DropdownMenu-module__menu-item-icon-wrapper__swMcC","checkbox--unchecked":"DropdownMenu-module__checkbox--unchecked__20jjP DropdownMenu-module__menu-item-icon-wrapper__swMcC",radio:"DropdownMenu-module__radio__3xf-n DropdownMenu-module__menu-item-icon-wrapper__swMcC","radio--unchecked":"DropdownMenu-module__radio--unchecked__3dAyK DropdownMenu-module__menu-item-icon-wrapper__swMcC","radio-circle":"DropdownMenu-module__radio-circle__2I4YB","radio-circle--active":"DropdownMenu-module__radio-circle--active__3rYQX","menu-option-background":"DropdownMenu-module__menu-option-background__3MWJ4",checkmark:"DropdownMenu-module__checkmark__1218D",icon:"DropdownMenu-module__icon__3CHS4"},f=a("Haco"),v=new Set([c.a.ArrowDown,c.a.ArrowUp,c.a.End,c.a.Enter,c.a.Escape,c.a.Home,c.a.Tab]),g=Object(d.forwardRef)((function(e,t){var a,s,g,b,h=e.buttonContent,_=e.items,T=e.dropdownMenuContent,y=e.options,C=e.menuItemType,O=e.onKeySelected,k=e.onDropdownOpened,w=e.onDropdownClosed,j=e.defaultSelected,E=e.stopButtonEventPropagation,x=e.checkedItemClassName,S=e.buttonTitle,N=e.buttonAriaLabel,A=e.disableFocus,I=e.ariaDescribedby,P=C,D=Object(n.__read)(Object(d.useState)(!1),2),M=D[0],L=D[1],R=M),F=Object(n.__read)(Object(d.useState)("string"==typeof j?[j]:j||[""]),2),B=F[0],U=F[1],W=Object(d.useRef)(null),H=Object(d.useRef)([]),z=Object(d.useRef)(null);Object(d.useEffect)((function(){var e=function(e){W.current&&e.target instanceof Node&&W.current.contains(e.target)||L(!1)};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[]),Object(d.useEffect)((function(){var e=function(e){var t;W.current&&e.target instanceof Node&&W.current.contains(e.target)&&e.key===c.a.Escape&&(L(!1),null===(t=z.current)||void 0===t||t.focus())};return document.addEventListener("keydown",e),),[]),Object(d.useEffect)((function(){var e,t;M?(k&&k(),null===(e=H.current[0])||void 0===e||e.focus()):w&&R&&(w(),null===(t=z.current)||void 0===t||t.focus())}),[k,w,M,R]),Object(d.useEffect)((function(){j&&"string"==typeof j&&U([j]),j&&"string"!=typeof j&&U(j)}),[j]);var V=Object(d.useCallback)((function(e){if(M){var t=H.current.length;H.current.some((function(a,n){var r;return!(!a||a!==document.activeElement||(null===(r=H.current[(n+e+t)%t])||void 0===r||r.focus(),0))}))}}),[M]),G=y||{},Q=null!==(b=G.menuSize)&&void 0!==b?b:f.a.Default,X=Object(d.useCallback)((function(e,t){var a=B.indexOf(e.key)>=0;if(O&&O(e.key,t,!a),!G.multiSelect)return U([e.key]),void L(!1);U(a?B.filter(():B.concat(e.key))}),[O,G.multiSelect,B]),q=Object(d.useCallback)((function(e,a){var n,r,o,i,s=Object(l.a)(e);if(v.has(s))switch(e.preventDefault(),s){case c.a.Enter:X(a,e);break;case c.a.Escape:L(!1),"function"!=typeof t&&(null===(n=null==t?void 0:t.current)||void 0===n||n.focus()),null===(r=z.current)||void 0===r||r.focus(),E&&e.stopPropagation();break;case c.a.ArrowUp:V(-1);break;case c.a.ArrowDown:V(1);break;case c.a.End:null===(o=H.current[H.current.length-1])||void 0===o||o.focus();break;case c.a.Home:null===(i=H.current[0])||void 0===i||i.focus();break;case c.a.Tab:V(e.shiftKey?-1:1)}}),[X,V,t,E]);return m.a.createElement("div",{ref:W,className:u()(p["menu-wrapper"],(a={},a[p["menu-wrapper--default"]]=Q!==f.a.Small,a))},m.a.createElement("button",{ref:null!=t?t:z,className:u()(p.button,(s={},s[p["button--default"]]=Q!==f.a.Small,s[p["button--small"]]=Q===f.a.Small,s[p["button--hover"]]=!G.disableHoverColor,s)),onClick:function(e){e.preventDefault(),E&&e.stopPropagation(),L(!M)},onKeyDown:function(e){var t=Object(l.a)(e);t!==c.a.Enter&&t!==c.a.Space&&t!==c.a.Escape||(e.preventDefault(),E&&e.stopPropagation(),L(t!==c.a.Escape&&!M))},title:S||"","aria-label":N||"","aria-expanded":M,"data-clicklog":"custom",tabIndex:A?-1:0,"aria-describedby":I},h),m.a.createElement("div",{className:u()(p.menu,(g={},g[p.hidden]=!M,g[p["menu--right"]]=!G.leftAligned,g[p["menu--large"]]=Q===f.a.Large,g))},T||m.a.createElement("ul",{className:u()(p["menu-content"]),role:P===o.a.Radio?"radiogroup":"menu"},_&&_.map((function(e,t){var a,n,c,l;return m.a.createElement("li",{onClick:onKeyDown:function(t){return q(t,e)},key:e.key,className:u()(p["menu-item-wrapper"],(a={},a[p["menu-item-wrapper--default"]]=Q!==f.a.Small,a[p["menu-item-wrapper--small"]]=Q===f.a.Small,a[p["upper-divider"]]=e.hasUpperDivider,a)),ref:tabIndex:-1,role:P===o.a.Radio?"radio":C===o.a.Checkbox?"menuitemcheckbox":"menuitem","aria-checked":P===o.a.Radio||P===o.a.Checkbox?B.indexOf(e.key)>-1&&!x:void 0,"aria-label":e.ariaLabel},m.a.createElement("div",{className:u()(p["menu-item"])},P===o.a.Radio&&m.a.createElement("span",{className:u()(p.radio,(n={},n[p["radio--unchecked"]]=B.indexOf(e.key)<=-1,n["".concat(x)]=B.indexOf(e.key)>-1&&x,n[p["menu-option-background"]]=B.indexOf(e.key)>-1&&!x,n))},m.a.createElement("span",{className:u()(p["radio-circle"],(c={},c[p["radio-circle--active"]]=B.indexOf(e.key)>-1&&!x,c))})),P===o.a.Checkbox&&m.a.createElement("span",{className:u()(p.checkbox,(l={},l[p["checkbox--unchecked"]]=B.indexOf(e.key)<=-1,l["".concat(x)]=B.indexOf(e.key)>-1&&x,l[p["menu-option-background"]]=B.indexOf(e.key)>-1,l))},m.a.createElement(r.a,{className:p.checkmark,iconName:i.a.CheckMark})),e.iconElement?m.a.createElement("div",{className:u()(p.icon)},e.iconElement):null,m.a.createElement("div",{className:u()(p["menu-item-text"])},e.content)))})))))}))},"1aUa":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=,"1w9C":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("mXGw"),r=a("QjXU"),o=function(e,t,a){var o=function(e){var t=Object(r.__read)(Object(n.useState)(null),2),a=t[0],o=t[1],i=Object(n.useCallback)(e,[]);return Object(n.useEffect)((,[i]),a}(e(t));return Object(n.useMemo)((function(){return o&&a?o.getDataManager(a):void 0}),[a,o])}},"3+RV":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a("QjXU"),r=a("NrNW"),o=a("lUkk"),i=a("5eS3"),c=a("mXGw"),l=a("XlCq"),s=a("vaZn"),u=function(){var e=Object(s.a)(),t=Object(r.a)().data,a=Object(c.useMemo)((function(){var e=l.b;return t&&(e=t.loginHint?Object(i.a)(l.b,"".concat(l.a,"=").concat(t.loginHint)):l.b),e}),[t]),u=Object(c.useCallback)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){return Object(o.a)({type:"Click",id:"StorageErrorManageStorage",area:"Other",subArea:"Other",result:"Navigate",target:"Other",eventName:"StorageError_ManageStorage"}),[2]}))}))}),[]);return Object(c.useMemo)((function(){if(e)return{link:a,caption:e.manageStorageText,description:e.manageStorageText,onClick:u}}),[u,a,e])}},"3b/l":function(e,t,a){"use strict";function n(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+t,e.getMinutes(),e.getSeconds(),e.getMilliseconds())}a.d(t,"a",(function(){return n}))},"43jW":function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return D}));var n=a("ovpI"),r=a("kbrL"),o=a("1NSz"),i=a("Sn4U"),c=a("x3xY"),l=a("GBVN"),s=a("OeRt"),u=a("mXGw"),d=a.n(u),m=a("QjXU"),p=a("p/uK"),f=a("sLnE"),v=a("DU/N"),g=Object(p.a)({pill:Object(m.__assign)(Object(m.__assign)(Object(m.__assign)({},f.a.margin("0px","5px")),f.a.border("1px","solid",v.a.colorBrandStroke2)),{color:v.a.colorNeutralForeground1,fontFamily:v.a.fontFamilyBase,fontWeight:v.a.fontWeightRegular,fontSize:v.a.fontSizeBase300,lineHeight:v.a.lineHeightBase300,":hover":{cursor:"pointer",backgroundColor:v.a.colorBrandBackground2Hover},":active":{backgroundColor:v.a.colorBrandBackground2Pressed}}),icon:{paddingRight:"4px",fontSize:"20px",paddingTop:"2px"},dropdownIcon:{paddingLeft:"4px",color:v.a.colorNeutralForeground1,fontSize:"12px"},likelihoodIconContainer:{paddingLeft:"4px",height:"16px",width:"16px"},likelihoodIcon:{color:v.a.colorNeutralForeground2},likelihoodIconSelected:{color:v.a.colorNeutralForeground2BrandPressed},pillSelected:Object(m.__assign)({color:v.a.colorNeutralForeground1,fontWeight:v.a.fontWeightSemibold,backgroundColor:v.a.colorBrandBackground2},f.a.border("1px","solid",v.a.colorBrandStroke1))}),b=Object(u.forwardRef)((function(e,t){var a=e.id,n=e.title,r=e.isActive,o=e.iconElement,i=e.iconElementRight,m=e.isDropdown,p=g(),f=Object(u.useMemo)((function(){return d.a.createElement("div",{className:p.icon},o)}),[p.icon,o]),v=Object(u.useMemo)((function(){return d.a.createElement(r?s.j:s.k,{className:p.dropdownIcon})}),[p.dropdownIcon,r]);return n?d.a.createElement(c.a,{id:a,shape:"circular",appearance:"outline",tabIndex:-1,className:r?Object(l.a)(p.pill,p.pillSelected):p.pill,ref:t},f,n,i?d.a.createElement("div",{className:r?Object(l.a)(p.likelihoodIconContainer,p.likelihoodIconSelected):Object(l.a)(p.likelihoodIconContainer,p.likelihoodIcon)},i):null,m&&v):null}));b.displayName="FluentPillControl";var h,_=a("chxZ"),T=a("5DIn"),y=a("AcOL"),C=a("MqQ1"),O=a("qyk8"),k=a("q3UB"),w=a("8Jek"),j=a.n(w),E=a("LzJX"),x="PivotsControl-module__tab-list__header__tab-icon__hrEXI",S="PivotsControl-module__tab-list__header__title__1O_Iw",N="PivotsControl-module__tab-list__header__title-text--vertical-selected__216vS",A=!h||(h={}));var I=new Set([T.a.Enter,T.a.Space,T.a.ArrowLeft,T.a.ArrowRight]),P=new Set([T.a.Enter,T.a.Space,T.a.ArrowUp,T.a.ArrowDown]),D=function(e){var t,a=e.onSelectTab,c=e.tabs,l=e.pivotsOverflow,s=e.dropdownButtonText,m=e.isVertical,p=e.showIcons,f=e.activeTabOptions,v=e.maxPivotCount,g=e.showPills,w=void 0!==g&&g,D=e.onlyDropdownShownLeftAlignContext,M=void 0!==D&&D,L=e.onAddPendingPivot,R=e.onRemovePivot,F=e.pendingCustomPivotId,B=e.addCustomPivotButtonText,U=e.removeNewCustomPivotButtonText,W=e.removeNamedCustomPivotButtonText,H=e.persistTabOrder,z=e.selectedTabInDropdownAriaLabel,V=e.isFluentPill,G=m?P:I,Q="rtl"===document.dir,X="add-pending-pivot-button",q=(void 0===l?h.None:l)===h.Dropdown&&c.length>1,Y=A(Object(_.a)(c),2),Z=Y[0],K=Y[1],J=c&&c.length?(null==f?void 0:f.id)&&!c.some((function(e){return e.id===f.id}))?f.id:c[0].id:"",$=A(Object(_.a)(J),2),ee=$[0],te=$[1],ae=A(Object(u.useState)(J),2),ne=ae[0],re=ae[1],oe=A(Object(u.useState)(J),2),ie=oe[0],ce=oe[1],le=A(Object(u.useState)(!1),2),se=le[0],ue=le[1],de=A(Object(u.useState)(0),2),me=de[0],pe=de[1],fe=A(Object(_.a)(c.length),2),ve=fe[0],ge=fe[1],be=A(Object(u.useState)(0),2),he=be[0],_e=be[1],Te=A(Object(u.useState)(!1),2),ye=Te[0],Ce=Te[1],Oe=Object(u.useRef)(null),ke=Object(u.useRef)(null),we=Object(u.useRef)(null),je=Object(u.useRef)(new Map),Ee=Object(u.useRef)([]),xe=Object(u.useRef)(null),Se=Object(k.a)().width,Ne=Object(u.useCallback)((function(e){te(e),a&&a({tabId:e}),re(e),e!==F&&ce(e)}),[a,F,ce,te]),Ae=Object(u.useMemo)((function(){return q?Z&&Z.slice(ve).map((function(e){var t=void 0,a=void 0,r=e.iconElement&&e.iconElementActive?e.iconElementActive:d.a.createElement(n.a,{iconName:i.a.CheckMark});return(H||0===ve)&&ye&&e.id===ee?(t=r,z&&(a=Object(O.a)(z,e.title))):e.iconElement&&e.iconElementActive&&(t=e.iconElement),{key:e.id,content:e.title,iconElement:t,ariaLabel:a}})):[]}),[q,ve,H,Z,ee,ye,z]),Ie=Object(u.useCallback)((function(e){R&&(Ne(ie===e.id?"all":ie),R(e))}),[R,ie,Ne]),Pe=Object(u.useCallback)((,[L,F,Ne]),De=Object(u.useCallback)((function(e){var t,a,n,r=c.findIndex((function(t){return e===t.id})),o=e===X;!o&&q&&-1===r?null===(t=we.current)||void 0===t||t.focus():o?null===(a=xe.current)||void 0===a||a.focus():r<Z.length&&(null===(n=Ee.current[r])||void 0===n||n.focus())}),[c,q,Z.length]),Me=Object(u.useCallback)((function(e,t){var a=Object(y.a)(e);if(G.has(a)){var n=q?ve:c.length,r=Z.findIndex((function(e){return t===e.id}));e.preventDefault();var o=function(){De(L&&r+1===n?X:Z[(r+1)%n].id)},i=function(){De(0===r&&L?X:t===X?q&&Ae.length&&r-1<0?"":Z[(r+n)%n].id:Z[(r-1+n)%n].id)};switch(a){case T.a.Enter:case T.a.Space:t===X?Pe():Ne(t);break;case T.a.ArrowLeft:if(Q){o();break}case T.a.ArrowUp:i();break;case T.a.ArrowRight:if(Q){i();break}case T.a.ArrowDown:o()}}}),[G,q,Q,ve,c.length,Z,L,Ae.length,Pe,Ne]),Le=Object(u.useCallback)((function(e){var t=Object(y.a)(e);if(G.has(t)){var a;e.preventDefault();var n=function(){re(a=L?X:Z[0].id),De(a)},r=function(){re(a=Z[ve-1].id),De(a)};switch(t){case T.a.ArrowLeft:Q?n():r();break;case T.a.ArrowRight:Q?r():n()}}}),[Q,L,ve,Z,G,De]),Re=Object(u.useCallback)((function(e){var t=null!=e?e:ee;te(t);for(var a=Z.findIndex((function(e){return t===e.id})),n=je.current,r=0,o=0;o<c.length;o++){var i=n.get(c[o].id);if(i&&(r+=i,(o===c.length-1?r:r+he)>me||v&&o===v))return ge(o),void Ce(a>=o)}Ce(!1),ge(Z.length)}),[me,he,Z,ee,v,ge,te,c]),Fe=Object(E.a)((function(e){if(q&&Oe.current&&je.current&&0!==je.current.size){if(H)return Re(e);var t=void 0;e&&(t=Z.findIndex((),te(Z[t].id));for(var a=t,n=je.current,r=n.get(ee)||0,o=!1,i=0;i<Z.length;i++){var c=void 0;if(Z[i].id!=ee?c=r+(n.get(Z[i].id)||0):(c=r,o=!0),r=c,(i<Z.length-1?c+he:c)>=me||v&&i===v){if(a=i-1,void 0!==t&&void 0!==a&&a!==t){var l=Z.slice();l.splice(t,1),l.splice(a,0,Z[t]),K(l),ue(!0),Fe()}else if(!o){var s=Z.findIndex((function(e){return e.id===ee})),u=Z[s];Z.splice(s,1),Z.splice(i-1,0,u)}return void ge(i)}}ge(Z.length)}}),50),Be=Object(u.useCallback)((function(e,t,n){var r;if(H)return te(e),null===(r=we.current)||void 0===r||r.focus(),a&&a({tabId:e}),void Ce(!0);n&&(te(e),re(e),a&&a({tabId:e}),Fe(e),ue(!0))}),[te,a,Fe,H]),Ue=Object(u.useMemo)((function(){return Z&&Z.length?Z.slice(0,v&&v<ve?v:ve).map((function(e){var t,a,r,o,i,l,s=e.id+"-pivot";return d.a.createElement("span",{key:e.id,className:j()((t={},t[S]=!w,t["PivotsControl-module__tab-list__header__title--vertical__2YJ-0"]=m,t["PivotsControl-module__tab-list__header__title--selected__MFdUq"]=e.id===ee&&m,t[N]=e.id===ee&&m,t["PivotsControl-module__tab-list__fluentOutline__4MYIy"]=V,t)),onClick:onKeyDown:ref:function(t){var a;null===(a=e.onPivotRefChange)||void 0===a||a.call(e,t),Ee.current[c.findIndex((function(t){return t.id===e.id}))]=t;var n=(null==t?void 0:t.offsetWidth)||0;(q&&!je.current.has(e.id)||je.current.has(e.id)&&je.current.get(e.id)!=n&&0!=n)&&(je.current.set(e.id,n),Fe()),se&&ne===e.id&&(null==t||t.focus(),ue(!1))},tabIndex:m&&e.id===Z[0].id&&""==ee||ee===e.id||ne===e.id?0:-1,"aria-labelledby":s,role:m?"menuitemradio":"tab","aria-selected":e.id===ee,"aria-checked":m&&e.id===ee},w?e.isCustomPivot&&R?d.a.createElement(C.a,{id:s,title:e.title,iconName:e.iconName,iconElement:e.iconElement,ariaLabel:null!==(r=e.ariaLabel)&&void 0!==r?r:e.title,isActive:e.id===ee,isRemovable:!0,onRemoveClick:function(){return Ie(e)},disableFocus:!0,removePillAriaLabel:e.id===F?U:Object(O.a)(null!=W?W:"",null!==(o=e.title)&&void 0!==o?o:"")}):V?d.a.createElement(b,{id:s,title:e.title,isActive:e.id===ee,iconElement:e.iconElement instanceof Promise?void 0:e.iconElement,iconElementRight:e.iconElementRight}):d.a.createElement(C.a,{id:s,title:e.title,iconName:e.iconName,ariaLabel:null!==(i=e.ariaLabel)&&void 0!==i?i:e.title,isActive:e.id===ee||"all"==(null==f?void 0:f.activeMode),isRemovable:null==f?void 0:f.allTabsRemovable,onRemoveClick:(null==f?void 0:f.allTabsRemovable)?void 0,iconElement:e.iconElement,iconElementActive:e.iconElementActive,disableFocus:!0}):d.a.createElement("div",{id:s,title:e.title,"aria-label":null!==(l=e.ariaLabel)&&void 0!==l?l:e.title,className:j()("PivotsControl-module__tab-list__header__title-text__3sGwC",(a={},a["PivotsControl-module__tab-list__header__title-text--selected__2c6us"]=e.id===ee&&!m,a["PivotsControl-module__tab-list__header__title-text--vertical__2-Nox"]=m,a["ms-fcl-nd ms-bcl-tda"]=e.id===ee&&!m,a[N]=e.id===ee&&m,a))},p&&e.icon?d.a.createElement("div",{className:x},e.icon):null,p&&e.iconName?d.a.createElement(n.a,{className:x,iconName:e.iconName}):null,p&&e.iconClassName?d.a.createElement("span",{className:e.iconClassName}):null,e.title))})):null}),[v,ve,Z,w,m,ee,V,ne,R,F,U,W,p,Ne,H,Me,c,q,se,Fe,Ie]);Object(u.useEffect)((function(){q&&Z.length===Ae.length?Ce(!0):(null==f?void 0:f.id)&&(c.some((function(e){return e.id===f.id}))?(Ae.find(()?H?Ce(!0):(ge(Z.length),Fe(f.id)):Ce(!1),re(f.id),te(f.id)):te(""))}),[f,q,Ae,Fe,H,Z.length,ge,te,Ce,c]),Object(u.useEffect)((function(){var e,t;if(q){he||_e((null===(e=ke.current)||void 0===e?void 0:e.offsetWidth)||0);var a=(null===(t=Oe.current)||void 0===t?void 0:t.offsetWidth)||0;L&&(a=a>=32?a-32:0),pe(a),Fe()}}),[q,he,Fe,L,Se]),Object(u.useEffect)((function(){if(c.length!==je.current.size){var e=je.current,t=new Set(c.map((function(e){return e.id}))),a=[],A(e.keys()),!1).find(();a&&e.delete(a),Fe()}}),[Fe,c]),Object(u.useEffect)((function(){if(Z&&c){var e=void 0;if(Z.length!==c.length)e=!0;else{var t=Z.map((function(e){return e.id})).sort(),a=c.map((function(e){return e.id})).sort();e=!t.every(()}e&&(K(c),te(c&&c.length?c[0].id:""),Fe())}}),[Fe,Z,K,te,c]);var We=Object(u.useMemo)((function(){var e,t,a=s?Object(O.a)(s,Ae.length.toString()):void 0;return q?d.a.createElement("span",{ref:ke,className:j()("PivotsControl-module__tab-list__dropdown__3SBq9",(e={},e["PivotsControl-module__tab-list__dropdown--hidden__25iy9"]=0===he,e["PivotsControl-module__tab-list__dropdown--none__OqDq0"]=0!==he&&0===Ae.length,e)),onKeyDown:Le},d.a.createElement(o.a,{buttonContent:w?V?d.a.createElement(b,{title:null!=a?a:"",isActive:H&&ye,isDropdown:!0}):d.a.createElement(C.a,{title:null!=a?a:"",isActive:H&&ye,isDropdown:!0,disableFocus:!0}):d.a.createElement("span",{className:j()(S,(t={},t["PivotsControl-module__tab-list__header__title--selected-underline__2owz9"]=H&&ye,t["ms-fcl-nd ms-bcl-tda"]=H&&ye,t))},a,d.a.createElement(n.a,{className:j()("ms-fcl-tda","PivotsControl-module__tab-list__more__icon__2LKBd"),iconName:i.a.ChevronDown})),items:Ae,options:{leftAligned:M&&0===ve},menuItemType:r.a.List,onKeySelected:Be,stopButtonEventPropagation:!0,ref:we,buttonAriaLabel:a,disableFocus:!1})):null}),[s,Ae,q,he,Le,w,H,ye,V,M,ve,Be]);return d.a.createElement("div",{ref:Oe,className:j()("PivotsControl-module__tab-list__header__tabs__1sJbM",(t={},t["PivotsControl-module__tab-list__header__tabs--vertical__Lzme0"]=m,t["PivotsControl-module__tab-list__header__pills__-cUq0 PivotsControl-module__tab-list__header__tabs__1sJbM"]=w&&!V,t["PivotsControl-module__tab-list__header__fluentpills__cKz5O"]=V,t)),role:m?"menu":"tablist"},Ue,We,!L||!B||c&&c.find((function(e){return e.id===F}))?null:d.a.createElement("span",{key:X,role:"tab",tabIndex:ne===F?0:-1,ref:xe,onClick:Pe,title:B,"aria-label":B,onKeyDown:function(e){return Me(e,X)}},d.a.createElement(n.a,{iconName:i.a.Add,className:"PivotsControl-module__tab-list__header__add-tab-button__1PSwT"})))}},"44+c":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("Ea7i"),r=a("6ib3"),o=a("Ohvh"),i=a("JSSH");function c(e){var t,a=e.template,c=e.candidate,l=e.instrumentClick,s=e.getOrUpdatePendingCreates,u=e.errorCallback,d=e.shouldShowStorageErrorDialog,m=e.showStorageErrorDialog;a&&!a.TemplateBinaryUrl&&a.Binaries&&a.Binaries.length>0&&(a.TemplateBinaryUrl=(null===(t=a.Binaries.find((function(e){var t,a;return"wac"===(null===(t=e.Platform)||void 0===t?void 0:t.toLowerCase())||"online"===(null===(a=e.Platform)||void 0===a?void 0:a.toLowerCase())})))||void 0===t?void 0:t.Url)||"");var p=Object(o.a)(a.Application)||r.a.None;return{tileConfig:Object(i.a)(a),id:a.AssetId,assetId:a.AssetId,templateType:a.IsPremium?"Premium":"Standard",app:p,handleClick:function(){d&&d(a.Application||"")?m&&m({workloadId:a.AssetId,area:"CreateOnTemplates",subArea:"Templates",isTemplate:!0}):Object(n.a)({app:p,candidate:c,getOrUpdatePendingCreates:s,template:a,instrumentClick:l,errorCallback:u})}}}},"4PWS":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n={home:"5099F2E5-AD99-4BF2-BF82-DF525FFD0BE2",create:"83D3F491-B586-4266-8738-89776471BF21",mycontent:"F57D5D29-4967-495C-A648-F7AB66BF8572",orion:"099317ab-9a66-4a75-868c-dc2263ce2eb9",intents:"2CC62124-219E-4777-9A92-00CDE9062859",feed:"261d33d6-15ba-4e1d-b298-8096960fab40",appgallery:"26706956-2AAE-4A22-8960-09B98C35B28C",outlook:"Mail",onedrive:"Documents",teams:"SkypeTeams",word:"WordOnline",excel:"ExcelOnline",powerpoint:"PowerPointOnline",onenote:"OneNoteOnline",sway:"Sway",forms:"OfficeForms",admin:"Admin",visio:"VisioOnline",stream:"MicrosoftStream",todo:"ToDo",familysafety:"FamilySafety",calendar:"Calendar",skype:"Skype",people:"People",powerautomate:"LogicFlows",clipchamp:"Clipchamp",lists:"Lists",yammer:"Yammer",powerbi:"PowerBIv2",bing:"Bing",msn:"MSN",privacy:"Privacy",rewards:"Rewards",whiteboard:"Whiteboard",defender:"Defender"}},"5HQQ":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("QjXU");function r(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([a.e(51),a.e(719)]).then(a.bind(null,"fTj/"))];case 1:return[2,t.sent().getInstalledApp(e).then(().catch(()]}}))}))}},"5ZLP":"5tWw":function(e,t,a){for(var n,r=a("5ZLP"),o=a("S9J+"),i=r.CASE_SENSITIVE_TAG_NAMES,c=o.Comment,l=o.Element,s=o.ProcessingInstruction,u=o.Text,d={},m=0,p=i.length;m<p;m++)d[(n=i[m]).toLowerCase()]=n;exports={formatAttributes:f,formatDOM:isIE:},"6fXp":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("B5kz"),r=a("5PdT"),o=a("CaQ9");function i(){var e=Object(o.a)().data,t=["EncryptionKey",null==e?void 0:e.puid];return Object(n.c)(t,(,{cacheTime:1/0,staleTime:1/0,enabled:!!e})}},"7LW7":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("QjXU"),r=a("28zg"),o=a("KQ1A");function i(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){return[2,Object(r.a)(o.a)]}))}))}},"8Jek":"8kGW":"9Yx+":"9pXf":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a("QjXU"),r=a("3b/l"),o=a("Wa5Y"),i=a("zPk6"),c=a("V1Qu"),l=new Map;function s(e,t,a,s,u,d,m,p,f,v){var g=l.get(m);if(g&&(!g.expiryTime||g.expiryTime>new Date))return g.promise;l.delete(m);var b=function(r){return function(e,t,a,r,c,l,s,u,d,m,p,f,v){return Object(n.__awaiter)(this,void 0,void 0,(function(){var g;return Object(n.__generator)(this,(function(n){return g={headers:{accept:"application/json"}},[2,Object(o.a)(d,m,e,g,t,a,r,c,s,{resourceUrl:u,mockParam:"mockvroom",populateRequestEvent:function(e,t){t.RequestId=Object(i.a)(e)||e)||""},silent:p,capDialogData:f,isRetriableError:v},l).then((function(e){return e&&e.data?e.data:Promise.reject({httpResponse:e,clientError:"Invalid response"})}))]}))}))}(t,!!e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,r,a,s,u,d,p,f,v)},h=(null==g?void 0:g.promise)||b("cache-only"),_=b("network-first"),T=Object(c.a)(h,_,!!g).catch(();return l.set(m,{promise:T,expiryTime:Object(r.a)(new Date,24)}),T}},"9rKB":function(e,t,a){var n=a("mXGw"),r=a("9vko").default,o={reactCompat:!0},i=n.version.split(".")[0]>=16;e.exports={PRESERVE_CUSTOM_ATTRIBUTES:i,invertObject:isCustomComponent:setStyleProp:},"9vko":B7gc:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a("lUkk"),r=a("mXGw"),o=a("bcUD"),i=a("u9fO"),c=a("XlCq"),l=a("lJoY"),s=a("vaZn"),u=function(e){var t=Object(s.a)(),a=function(e){var t=function(){var e=function(){var e=Object(l.a)();return"Pwa"===(null==e?void 0:e.route)?"cmm8gnwxv06":"cmmhp9cy416"}();return Object(r.useMemo)((function(){return Object(i.a)(c.b,"ocid",e)}),[e])}(),a=Object(o.a)({experiences:[e]}),n=Object(r.useCallback)((,[e,a,t]);return Object(r.useMemo)((,[n,a])}(e),u=Object(r.useCallback)((function(e){Object(n.a)({type:"Click",id:"StorageErrorUpsell",area:"Upsell",subArea:e,result:"Navigate",target:"Other",eventName:"StorageError_Upsell"}),a&&a()}),[a]);return Object(r.useMemo)((function(){if(t)return{caption:t.upsellButtonText,description:t.upsellButtonText,onClick:u,showDime:!!a}}),[t,u,a])}},BhFD:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a("B5kz"),r=a("QjXU"),o=a("a3FV"),i=a("CRHC"),c=a("m32Q"),l=a("lkvL"),s=a("CMIS"),u=a("Wa5Y"),d=a("i3m/"),m=a("V1Qu"),p="vroom-fluid-enabled-api";function f(e){return Object(n.c)(["FluidEnabled"],(function(){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,a,n,f=this;return Object(r.__generator)(this,(function(v){return e?(t="".concat(Object(m.e)(e.sharePointResourceId,e,!1,!0),"/").concat(d.b,"root/opStream/fluidEnabled"),a={headers:{accept:"application/json",Prefer:"allow-zerobyte",application:"officehome"}},n=new Promise((function(n,r){Object(u.a)(o.a.VroomGetFluidEnabled,"Vroom_Get_Fluid_Enabled",t,a,!!e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"SharePoint",{resourceUrl:e.sharePointResourceId}).then((function(e){e&&e.data?n(e.data.isFluidEnabled):r({clientError:"Invalid response returned for Vroom get Fluid enabled request"})})).catch((function(e){Object(s.a)({eventName:"Vroom_Get_Fluid_Enabled_Error",errorType:"Vroom_Get_Fluid_Enabled_Error",message:(null==e?void 0:e.message)||"",debugInfo:(null==e?void 0:e.stack)||""}),r(e)}))})),[2,Object(i.a)((function(){return n}),(function(){return Object(c.a)({userId:e.userId,collectionName:p,collectionVersion:1,key:e.userId})}),(function(t){return Object(r.__awaiter)(f,void 0,void 0,(function(){return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(l.a)({userId:e.userId,collectionName:p,collectionVersion:1,key:e.userId,data:t})];case 1:return a.sent(),[2]}}))}))}))]):[2,Promise.reject("vroomApiOptions not defined")]}))}))}(e)}),{staleTime:1/0,cacheTime:1/0,enabled:e})}},C2Jl:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("slmW");function r(e){if(e.fileType&&!e.isEmailAttachment&&e.canonicalUrl){var t=Object(n.a)(e.fileType);if(t){var a=e.canonicalUrl.lastIndexOf("?"),r=e.canonicalUrl;return a>0&&(r=e.canonicalUrl.substring(0,a)),"".concat(t).concat(r)}}}},"DM/p":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("QjXU"),r=a("MJsD"),o=a("QLkI"),i=a("W7wX");function c(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t,a;return Object(n.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(r.a)()];case 1:return e=c.sent(),[4,Promise.all([Object(o.a)(),Object(i.a)()])];case 2:return t=n.__read.apply(void 0,[c.sent(),2]),[2,{correlationId:e.correlationId,getAccessToken:e.getAccessToken,inMockMode:e.inMockMode,isConsumer:t[1].isMsa,jwtAuthEnabled:e.jwtAuthEnabled,officeHomeApiRoot:e.officeHomeApiRoot,oneDriveResourceId:null==(a=t[0])?void 0:a.oneDriveResourceId,sharePointResourceId:null==a?void 0:a.sharePointResourceId}]}}))}))}},ERcm:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("Ea7i"),r=a("6ib3"),o=a("SxNr"),i=a("JSSH");function c(e){var t,a=e.template,c=e.driveId,l=e.candidate,s=e.instrumentClick,u=e.getOrUpdatePendingCreates,d=e.errorCallback;a&&!a.TemplateBinaryUrl&&a.Binaries&&a.Binaries.length>0&&(a.TemplateBinaryUrl=(null===(t=a.Binaries.find((function(e){var t,a;return"wac"===(null===(t=e.Platform)||void 0===t?void 0:t.toLowerCase())||"online"===(null===(a=e.Platform)||void 0===a?void 0:a.toLowerCase())})))||void 0===t?void 0:t.Url)||"");var m=Object(o.a)(a)||r.a.None;return{tileConfig:Object(i.a)(a,!0),id:a.AssetId,assetId:a.AssetId,templateType:"Enterprise",app:m,handleClick:function(){Object(n.a)({app:m,candidate:l,getOrUpdatePendingCreates:u,template:a,instrumentClick:s,errorCallback:d,enterpriseDriveId:c})}}}},EXRb:function(e,t,a){"use strict";function n(e,t,a,n){if(void 0===t&&(t="officestartresources"),e&&t&&a&&n)return"https://".concat(e,"/").concat(t,"/").concat(a,".").concat(n)}a.d(t,"a",(function(){return n}))},Ea7i:function(e,t,a){"use strict";a.d(t,"a",(function(){return Be}));var n=a("QjXU"),r=a("DCX/"),o=a("MJsD"),i=a("QLkI"),c=a("6ib3"),l=a("OEfX"),s=a("B5kz"),u=a("W7wX"),d=a("P1B7"),m=a("m32Q"),p=a("lkvL"),f=a("8wW2"),v=a("a3FV"),g=a("Wa5Y"),b=a("zPk6"),h=a("fNDz"),_=/^https?:\/\/(.(?!\/))*.\//i,T="oneDriveRootUrl";function y(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t,a,r,c;return Object(n.__generator)(this,(function(l){switch(l.label){case 0:return[4,Promise.all([Object(o.a)(),Object(u.a)(),Object(i.a)()])];case 1:return e=n.__read.apply(void 0,[l.sent(),3]),t=e[0],a=e[1],[2,s.a.fetchQuery(c=["GraphMyDriveRootUrls"],(function(){return function(e,t,a,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o;return Object(n.__generator)(this,(function(n){return o={graphApiRoot:a.graphApiRoot,correlationId:e.correlationId,getAccessToken:e.getAccessToken,jwtAuthEnabled:e.jwtAuthEnabled,officeApiRoot:e.officeHomeApiRoot},[2,Object(d.a)((function(){return function(e,t,a){var n=Object(h.a)(e.graphApiRoot,"me/drive/root",!1);return a?Promise.resolve({tenantRoot:"",userRoot:""}):Object(g.a)(v.a.OneDriveGraphMyDriveRootURLRequest,"OneDrive_Graph_MyDriveRootURL",n,{method:"GET"},e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(b.a)(e)||""}}).then((function(e){var a=e.data,n=null,r=a?a.webUrl:null;if(!r)throw new Error((null==e?void 0:e.statusText)||"userOneDriveRootUrl empty");if(!t){var o=_.exec(r);o&&o.length&&(n=o[0])}return{tenantRoot:n,userRoot:r}})).catch((function(e){throw Object(f.a)().handleError(e,"m01Uz"),new Error("Failed to fetch graphDriveItem")}))}(o,t.isMsa,e.inMockMode)}),(function(){return Object(m.a)({userId:t.puid,collectionName:T,collectionVersion:1,key:T})}),(function(e){return Object(p.a)({userId:t.puid,collectionName:T,collectionVersion:1,key:T,data:e})}),r)]}))}))}(t,a,r,(function(e){return s.a.setQueryData(c,e)}))}),{staleTime:1/0,cacheTime:1/0,enabled:(r=e[2])&&r.graphApiRoot})]}}))}))}var C=a("YKlt"),O=a("Y/GB"),k=a("/Oio"),w=a("7LW7"),j=a("s1V1"),E=a("bb9Y"),x=[c.a.Excel,c.a.Visio],S=[c.a.Visio],N=a("RV7E"),A=function(e){switch(e.resultType){case"OpenNewDocFailed":Object(N.c)({category:"CreateFile",error:"OpenNewDocFailed",fileType:e.fileType,fallbackSiteUrl:e.documentWebUrl});break;case"OpenBlockedByPopupBlocker":Object(N.c)({category:"CreateFile",error:"OpenBlockedByPopupBlocker",fileType:e.fileType,fallbackSiteUrl:e.documentWebUrl});break;default:Object(N.c)({category:"CreateFile",error:"Generic",fileType:e.fileType})}},I=a("UDoG"),P=a("CMIS"),D=a("nLxx"),M=a("skfY"),L=a("z+rT");function R(e){return Object(P.a)({eventName:"Docaspx_Creation_Failure",debugInfo:e||"getDocAspxApiUrl failed"}),""}function F(e){var t=e.candidate,a=e.options,r=e.startTime,o=e.template,i=e.enterpriseDriveId;return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,c,l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(!(t&&t.docAspxId&&a.componentContext&&a.userEntitlements))throw new I.a("Invalid docaspx params","Error");if(e=Object(D.a)(a.componentContext.workload,a.componentContext.router.getCurrentRoute(),t.createDocAspxEnabled,!!o),c=function(e,t,a,n,r,o){var i,c,l,s,u,d;if(!n.myDriveRootUrls||!n.myDriveRootUrls.userRoot)return R("Failed to get doclib url. myDriveRootUrls is undefined");var m=n.myDriveRootUrls.userRoot,p=m.lastIndexOf("/Documents");if(-1===p)return R("docliburl not in expected format");var f=m.substring(0,p),v="".concat(f,"/_layouts/15/doc.aspx?action=editnew&doctype=").concat(e,"&wdOrigin=").concat(t,"&docliburl=").concat(m,"&ct=").concat(a);r&&(v+=o?"&templateDriveId=".concat(o,"&templateItemId=").concat(r):"&wdTpl=".concat(r)),(r||(null===(i=n.templatesConfig)||void 0===i?void 0:i.createLcidEnabled))&&(v+="&wdlcid=".concat(null!==(l=null===(c=n.sharedContext)||void 0===c?void 0:c.officeMarketLcid)&&void 0!==l?l:""));var g=null===(s=n.capabilities)||void 0===s?void 0:s.scenarioId;return g&&(v+="&wdscenarioid=".concat(g)),(null===(u=n.capabilities)||void 0===u?void 0:u.outgoingLoginHintEnabled)&&(null===(d=n.identity)||void 0===d?void 0:d.loginHint)&&(v+="&login_hint=".concat(encodeURIComponent(n.identity.loginHint))),n.referralParams&&(v=Object(L.a)(v,n.referralParams)),v}(t.docAspxId,e,r,a,o?o.AssetId:void 0,i),!Object(M.a)(c))throw new I.a("Invalid docaspxApiUrl","Error");return[4,a.componentContext.getAccessToken("OneDrive",!1,a.userEntitlements.OneDriveResourceId)];case 1:if(!(l=n.sent())||!l.success)throw new I.a("Invalid accessToken","Error");return[2,{apiUrl:c,accessToken:l}]}}))}))}function B(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,a,r,o,i,c,l,s,u,d,m;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:t=e.startTime,a=e.instrumentCallback,r=e.options.targetTab,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,F(e)];case 2:if(o=n.sent(),i=o.apiUrl,c=o.accessToken,l=void 0,r?(r.document.write("<!doctype html>\n<html>\n<head>\n</head>\n<body>\n</body>\n</html>\n"),l=r.document):l=document,s='<form id="create-new-doc-form" method="post" action="APIURL" style="display: none;" target="_top"><input id="create-new-doc-token" name="access_token" value="ONEDRIVETOKEN" /></form>'.replace("APIURL",i).replace("ONEDRIVETOKEN",c.token),l.body.insertAdjacentHTML("beforeend",s),u=l.getElementById("create-new-doc-form"))return d=Date.now()-t,a&&a(d),u.submit(),[2,Promise.resolve({type:"GoToBlankDoc"})];throw new I.a("Form element not found","Error");case 3:return m=n.sent(),Object(P.a)({eventName:"Docaspx_Creation_Failure",debugInfo:(null==m?void 0:m.message)||"docaspx failed"}),[2,Promise.reject({type:"Error"})];case 4:return[2]}}))}))}var U=a("frjS");function W(e,t,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,i,c,l,s,u,d;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=e.capabilities,i=e.componentContext,c=e.userEntitlements,l=e.targetTab,s=e.newDocLinkTarget,(o=e.identity)&&i&&c?((null==o?void 0:o.isOrgId)&&!a?(d=t?"&referrerScenario=".concat(t):"",u="".concat(c.OneDriveResourceId,"/_layouts/15/videoeditor.aspx?action=create&referrer=OfficeHome&cid=").concat(i.correlationId).concat(d),(null==r?void 0:r.outgoingLoginHintEnabled)&&(null==o?void 0:o.loginHint)&&(u+="&login_hint=".concat(encodeURIComponent(o.loginHint)))):a&&(null==o?void 0:o.isMsa)&&(u="https://app.clipchamp.com/login/microsoft?content=".concat(a.AssetId,"&utm_source=harmony")),u&&Object(M.a)(u)?[4,Object(U.a)(u,l,s)]:[2,{type:"Error"}]):[2,{type:"Error"}];case 1:return[2,n.sent()]}}))}))}var H=a("mgFK");function z(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)()];case 1:return e=t.sent(),[2,s.a.fetchQuery(["FormsConfig"],(function(){return function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(H.a)("formsConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}function V(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,z()];case 1:return a=n.sent(),e&&a&&t?[2,{componentContext:e,formsConfig:a,identity:t}]:[2,Promise.resolve(void 0)]}}))}))}var G=a("5ANk"),Q=a("jwpY"),X=a("j7b/"),q=a("Zmq1"),Y=a("lbnC"),Z=a("lwUs"),K=a("wYzw"),J=a("0TX8");unction ee(){return[Object(Z.a)(7*X.a)]}function te(e,t,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,i,c,l,f;return Object(n.__generator)(this,(function(b){switch(b.label){case 0:return[4,Promise.all([Object(o.a)(),Object(u.a)(),Object(w.a)()])];case 1:return r=n.__read.apply(void 0,[b.sent(),3]),c=r[1],l=r[2],[2,s.a.fetchQuery(f=["TemplateContentData",t,(i=r[0]).preferredCulture],(function(){return function(e,t,a,r,o,i,c){var l;return Object(n.__awaiter)(this,void 0,void 0,(function(){var s,u,f,b,h=this;return Object(n.__generator)(this,(function(_){switch(_.label){case 0:return[4,Object(j.a)()];case 1:return s=_.sent().result,u=Object(q.a)(),f={correlationId:o.correlationId,getAccessToken:o.getAccessToken,getIdentity:function(){return Promise.resolve(r)},inMockMode:o.inMockMode,jwtAuthEnabled:o.jwtAuthEnabled,workload:o.workload,officeHomeApiRoot:o.officeHomeApiRoot,app:e,templateId:t,templateBinaryUrl:a,templatesApiEndpoint:i.templatesApiEndpoint,officeMarket:o.preferredCulture,show:i.numTemplates-1,browserName:u.browser.browserType,flights:(null===(l=o.flights)||void 0===l?void 0:l.replace(/,\s*$/,""))||"",isPremium:!1,isIw:(null==s?void 0:s.IsIw)||!1,isAdmin:(null==s?void 0:s.IsAdmin)||!1,isSmb:(null==s?void 0:s.IsSmb)||!1,isEdu:(null==s?void 0:s.IsEdu)||!1,isEduFaculty:(null==s?void 0:s.IsEduFaculty)||!1,isEduStudent:(null==s?void 0:s.IsEduStudent)||!1,authId:r.isMsa?1:2,firstVisitAgeInWeeks:Math.floor(Object(K.a)()/7),page:"Create",deploymentEnvironment:o.deploymentEnvironment||"",osName:u.platform.platformType,osVersion:Object(Y.a)(u.platformVersion)},b="templates-content-api-rc-"+$(t,f.officeMarket),[2,Object(d.a)((function(){return function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=function(e){var t="&".concat("browserName=").concat(e.browserName,"&").concat("flights=").concat(e.flights,"&").concat("isIw=").concat(e.isIw,"&").concat("isAdmin=").concat(e.isAdmin,"&").concat("isSmb=").concat(e.isSmb,"&").concat("isEduFaculty=").concat(e.isEduFaculty,"&").concat("isEduStudent=").concat(e.isEduStudent,"&").concat("authId=").concat(e.authId,"&").concat("firstVisitAgeInWeeks=").concat(e.firstVisitAgeInWeeks,"&").concat("page=").concat(e.page,"&").concat("deploymentEnvironment=").concat(e.deploymentEnvironment,"&").concat("osName=").concat(e.osName,"&").concat("osVersion=").concat(e.osVersion);return"".concat(e.officeHomeApiRoot,"/").concat(e.templatesApiEndpoint+"/content","?").concat("app=").concat(e.app,"&").concat("culture=").concat(e.officeMarket,"&").concat("show=").concat(e.show,"&").concat("id=").concat(e.templateId,"&").concat("templateBinaryUrl=").concat(e.templateBinaryUrl,"&").concat("isEdu=").concat(e.isEdu).concat(t)}(e),[4,Object(J.a)({},e.inMockMode,e.workload,e.getIdentity)];case 1:return a=n.sent(),[2,Object(g.a)(v.a.TemplateContentRequest,"Template_Content",t,a,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome",{populateRequestEvent:function(t,a){t.ok?(a.ElementId=e.templateId,a.ItemCategory=e.app):a.HttpCode=700..toString()}}).then((function(e){if(!e||!e.data||!e.ok)throw new Error((null==e?void 0:e.statusText)||"Null response");if(!e.data.Application||!e.data.Content||!e.data.Content.Value)throw new Error("Invalid response");return{Value:e.data.Content.Value,Application:e.data.Application}})).catch((function(e){Object(P.a)({eventName:"Form_Content_Fetch_Error",message:e})}))]}}))}))}(f)}),(function(){var e=ee(),a=Object(n.__spreadArray)([],Object(n.__read)(e),!1).reverse();return Object(m.a)({userId:r.puid,collectionName:b,collectionVersion:1,key:$(t,f.officeMarket),plugins:a})}),(function(e){return Object(n.__awaiter)(h,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return a=ee(),[4,Object(p.a)({userId:r.puid,collectionName:b,collectionVersion:1,key:$(t,f.officeMarket),data:e,plugins:a})];case 1:return n.sent(),[2]}}))}))}),c)]}}))}))}(e,t,a,c,i,l,()}),{staleTime:1/0,cacheTime:1/0,enabled:i&&c&&l})]}}))}))}var ae=a("GeVZ");function ne(e,t,a,n){if(!e||!t)return e;var r={},o=Object(ae.a)(e);if(!o)return e;var i=o.protocol,c=o.hostname,l=o.path,s=o.search,u=o.hash;for(var d in"?"===s[0]&&s.substring(1).split("&").forEach((function(e){var t=e.split("=");a?r[decodeURIComponent(t[0])]=decodeURIComponent(t[1]):r[t[0]]=t[1]})),t)r[d]=t[d];return Object(L.a)(i+"//"+c+l+u,r,n)}function re(e,t,a,n){var r=e.router.getCurrentRoute();return ne(t,{route:n||(r&&r.route?r.route:void 0)},null!=a&&a)}var oe,ie=a("Rh0W"),ce=a("sLEy"),le="/Pages/MobileDesignPage.aspx",se="/Pages/DesignPage.aspx",ue=a("3vWs"),de=a("zP6S"),me=a("Ot9e"),pe=a("5eS3");function fe(e,t){var a=e.componentContext,n="prodprv"===a.deploymentEnvironment&&"scu"===a.geoName;return ne(function(e,t){var a;if(e.userPrincipalName&&e.authType){var n={};n.auth_pvr=e.authType===ue.a.OrgId?"OrgId":"WindowsLiveId",n.auth_upn=e.userPrincipalName,a=Object(de.a)(n)}if(!t||!a)return t;var r,o=Object(ae.a)(t);return o&&(r=Object(me.a)(null==o?void 0:o.search)),(null==r?void 0:r.pvrQueryName)||(null==r?void 0:r.upnQueryName)?t:Object(pe.a)(t,a)}(e.identity,e.formsConfig.formsCdnPath+(t?"/Pages/DesignPageV2.aspx":Object(ie.a)()?le:se)),{origin:n?ce.b:ce.a,lang:a.preferredCulture,sessionId:a.sessionId},!1,!0)}function ve(e,t,a,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,i,l,s,u,d,m,p;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t.TemplateBinaryUrl?(o=e.componentContext,i=e.formsConfig,l=function(e){return"00000000-0000-0000-".concat(e.slice(0,4),"-",e.slice(4))}(e.identity.puid),s=i.formsMsaTenantId,u=r||l,[4,te(c.a.Forms,t.AssetId,t.TemplateBinaryUrl)]):[2,Promise.reject("Invalid TemplateBinaryUrl")];case 1:return(d=n.sent().result)?(m=i.formsApiPath+function(e,t,a){return"".concat("/formapi/api","/").concat(e,"/").concat(t,"/").concat(a,"/light/forms")}(s,a,u),p={method:"POST",headers:{"content-type":"application/json","x-ms-form-request-source":"ms-startpage","x-usersessionid":o.sessionId,"x-correlationid":Object(G.a)(),"x-anchormailbox":"".concat(l,"@").concat(s)}},[2,Object(Q.a)(v.a.FormCreateFormFromTemplate,"Form_Create_Form_From_Template",m,d.Value,p,o.jwtAuthEnabled,o.getAccessToken,o.officeHomeApiRoot,o.correlationId,"Forms",{populateRequestEvent:).then((function(t){if((null==t?void 0:t.ok)&&(null==t?void 0:t.data))return function(e,t){var a=fe(e,!1);return a=ne(a,{Action:"CreateByTemplate",Fragment:"FormId=".concat(t)},!0),re(e.componentContext,a,!0)}(e,t.data.id);throw new Error((null==t?void 0:t.statusText)||"Form create failed")})).catch(()]):[2,void 0]}}))}))}function ge(e,t,a,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return e!==c.a.Forms&&e!==c.a.FormsQuiz?[3,6]:[4,V(a.componentContext,a.identity)];case 1:return(i=n.sent())?(l=void 0,o?[4,ve(i,o,oe.Users,void 0)]:[3,3]):[2,{type:"Error"}];case 2:return l=n.sent(),[3,4];case 3:if(!t.newDocName)return[2,{type:"Error"}];l=function(e,t,a,n,r){return function(e,t,a,n,r){var o="Create",i="CreateQuiz",l=function(e,t,a){return"Action=".concat(t,"&Title=").concat(e).concat(a?"&GroupId="+a:"")},s=fe(e,!1),u={Action:null,Fragment:null};return t===c.a.Forms?(u.Fragment=l(a,o,n),u.Action=o):(s=s.replace(le,se),u.Fragment=l(a,i,n),u.Action=i),s=ne(s,u,!0),re(e.componentContext,s,!0,r)}(e,t,a,{type:oe.Users}.identifier,r)}(i,e,t.newDocName,0,r),n.label=4;case 4:return l?[4,Object(U.a)(l,a.targetTab,a.newDocLinkTarget)]:[2,{type:"Error"}];case 5:return[2,n.sent()];case 6:return[2,{type:"Error"}]}}))}))}function be(e,t,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t.componentContext&&t.userEntitlements&&t.userEntitlements.OneDriveResourceId?(r=a?"&referrerScenario=".concat(a):"",o="".concat(t.userEntitlements.OneDriveResourceId,"/_layouts/15/stream.aspx?action=create&referrer=OfficeHome&cid=").concat(t.componentContext.correlationId).concat(r),e===c.a.ScreenRecording&&(o+="&captureMode=screenrecorder"),Object(M.a)(o)?[4,Object(U.a)(o,t.targetTab,t.newDocLinkTarget)]:[2,{type:"Error"}]):[2,{type:"Error"}];case 1:return[2,n.sent()]}}))}))}function he(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)()];case 1:return e=t.sent(),[2,s.a.fetchQuery(["SwayConfig"],(function(){return function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(H.a)("swayConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}function _e(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,he()];case 1:return a=n.sent(),e&&a&&t?[2,{apiUrl:a.apiUrl,correlationId:null==e?void 0:e.correlationId,userPrincipalName:t.userPrincipalName||"",authType:t.authType,jwtAuthEnabled:e.jwtAuthEnabled,getAccessToken:e.getAccessToken,officeHomeApiRoot:e.officeHomeApiRoot}]:[2,Promise.resolve(void 0)]}}))}))}function Te(e){var t="".concat(e.apiUrl,"/json/createStory"),a={headers:{"X-UserSessionId":e.correlationId,"X-OHP-CorrelationId":e.correlationId}};return Object(Q.a)(v.a.SwayCreateRequest,"Sway_Create",t,{},a,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"Sway").then((function(t){if(t&&t.data)return function(e,t){var a,n=t.authType,r=t.userPrincipalName;if(r&&n){var o={};o.auth_pvr=1===n?"OrgId":"WindowsLiveId",o.auth_upn=r,a=Object(de.a)(o)}if(!e||!a)return e;var i,c=Object(ae.a)(e);return c&&(i=Object(me.a)(null==c?void 0:c.search)),(null==i?void 0:i.pvrQueryName)||(null==i?void 0:i.upnQueryName)?e:Object(pe.a)(e,a)}(t.data.url,e);throw new Error((null==t?void 0:t.statusText)||"Could not parse Sway creation response")})).catch((function(e){throw Object(P.a)({eventName:"Sway_Create_Error",errorType:"Sway_Create_Error",message:e}),e}))}function ye(e,t,a){var r;return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,i,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return o="",i=!1,e.canCreateBlankDocument?[4,_e(t.componentContext,t.identity)]:[3,4];case 1:return(c=n.sent())?[4,Te(c)]:[3,3];case 2:return o=n.sent(),[3,4];case 3:i=e.canFallbackToLandingPage,n.label=4;case 4:if((null===(r=t.identity)||void 0===r?void 0:r.isMsa)||i){if(!a||!a.url)return[2,{type:"Error"}];o=Object(pe.a)(a.url,"campaign=OHPCreateNew")}return o?[2,Object(U.a)(o,t.targetTab,t.newDocLinkTarget)]:[2,{type:"Error"}]}}))}))}!oe||(oe={}));var Ce=a("i+uS"),Oe=a("fhoW"),ke=a("Tqea"),we=a("O/XG");function je(e,t,a,r,o,i){var c,l,s,u;return Object(n.__awaiter)(this,void 0,void 0,(function(){var d,m,p,f;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),t?(d=Object(ke.a)(e.fileType),m={canonicalUrl:t.canonicalUrl,webUrl:t.webUrl,app:d,attribution:t.canonicalUrl,url:t.canonicalUrl,extension:null!==(c=e.fileExtension)&&void 0!==c?c:"",title:null!==(l=t.fileName)&&void 0!==l?l:"",id:t.docId||"",fileType:e.fileType,isRedeemed:!0},[4,Object(we.a)({action:"OpenDocument",document:m,useWebUrl:!0,wdOriginType:"NEW",newContentParams:o?{templateItemId:o.AssetId,templateDriveId:i,templateBinaryUrl:o.TemplateBinaryUrl}:void 0,linkTarget:a?"_top":r,targetTab:null!=a?a:void 0})]):[3,2];case 1:if(!(p=n.sent()).result||"OpenNull"===p.result||"OpenUndefined"===p.result)throw new I.a("Open blocked by pop-up blocker for the newly created ".concat(d," file."),"OpenBlockedByPopupBlocker");if(!p.success)throw new I.a(null!==(s=p.message)&&void 0!==s?s:"Failed to launch newly created ".concat(d," file."),"OpenNewDocFailed");n.label=2;case 2:return[3,4];case 3:return f=n.sent(),[2,Promise.resolve({type:null!==(u=f.type)&&void 0!==u?u:"OpenNewDocFailed",documentWebUrl:t.webUrl,fileType:e.fileType})];case 4:return[2,Promise.resolve({type:"GoToBlankDoc"})]}}))}))}function Ee(e,t,a,r,o,i,c){return Object(n.__awaiter)(this,void 0,void 0,(function(){var l,s,u,d;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(!a.componentContext||!a.sharedContext)return[2,Promise.resolve({type:"Error"})];l="".concat(t.newDocName,".").concat(t.fileExtension),s=a.componentContext),n.label=1;case 1:return n.trys.push([1,5,,6]),[4,Object(Oe.a)(s,l,!1,e)];case 2:return!(u=n.sent())||u)?[2,{type:"Error"}]:[4,Object(Ce.b)(u,r,a.componentContext,a.sharedContext,o?o.AssetId:"",a.templatesConfig,a.capabilities,a.referralParams)];case 3:return d=n.sent(),c&&u.parentReference&&(d.docId=u.id,d.driveId=u.parentReference.driveId,d.fileName=u.name),[4,je(t,d,a.targetTab,a.newDocLinkTarget,o,i)];case 4:return[2,n.sent()];case 5:return n.sent(),[3,6];case 6:return[2,{type:"Error"}]}}))}))}var xe=a("qyk8");function Se(e,t){var a=e);return s.a.fetchQuery(a,(function(){return function(e,t){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var a,r,i,c,l,s,d;return Object(n.__generator)(this,(function(m){switch(m.label){case 0:return e&&t?[4,Promise.all([Object(o.a)(),Object(u.a)()])]:[2,Promise.resolve(void 0)];case 1:return a=n.__read.apply(void 0,[m.sent(),2]),r=a[0],i=a[1],c=Object(xe.a)("{0}/api/license/data?app={1}&scenarioId={2}",r.officeHomeApiRoot,e,t),l={method:"GET",responseType:"json",url:c},[4,Object(J.a)(l,r.inMockMode,r.workload,()];case 2:m.sent(),m.label=3;case 3:return m.trys.push([3,5,,6]),[4,Object(g.a)(v.a.OfficeLicensesFetch,"Office_Licenses_Fetch",l.url,l,r.jwtAuthEnabled,r.getAccessToken,r.officeHomeApiRoot,r.correlationId,"OfficeHome",{})];case 4:return s=m.sent(),[3,6];case 5:return m.sent(),[3,6];case 6:return s&&s.ok&&s.data?[2,s.data]:(d="Failed to get license status for app: ".concat(e,", scenarioId: ").concat(t),Object(P.a)({eventName:v.a.OfficeLicensesFetch,errorType:"Office_Licenses_Fetch_Error",message:"Failed to fetch license status",debugInfo:d}),[2,void 0])}}))}))}(e,t)}),{staleTime:1/0,cacheTime:1/0})}var Ne=function(e,t,a){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var r,o;return Object(n.__generator)(this,(function(i){switch(i.label){case 0:return S.includes(e)?t&&Object(n.__spreadArray)(Object(n.__spreadArray)([],Object(n.__read)(t.coreAndSegmentApps),!1),Object(n.__read)(t.nonCoreAndSegmentApps),!1).find(()?[2,!0]:a?[4,Se(e,a)]:[2,!1]:[2,!0];case 1:return r=i.sent(),[2,null!==(o=null==r?void 0:r.IsLicensed)&&void 0!==o&&o]}}))}))},Ae=a("ZsNf");function Ie(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(Ae.a)({action:"OpenAppTile",appName:Object(ke.a)(e),url:""})];case 1:if(!(t=a.sent()).success)throw Error(t.message);return[3,3];case 2:return a.sent(),[2,Promise.resolve({type:"OpenNewDocFailed"})];case 3:return[2,Promise.resolve({type:"GoToLanding"})]}}))}))}var Pe=a("mJu7"),De=a("gI4v"),Me=a("MgoT");function Le(){return new Promise((function(e){Object(Me.c)({onResult:function(t,a){(function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,r,o,i,l;return Object(n.__generator)(this,(function(n){return e?(a="".concat(De.b),r={displayName:t},o=e.inMockMode?e.officeHomeApiRoot:e.graphApiRoot,i=Object(h.a)(o,a,!1),l={headers:{category:"CreateFile",fileType:c.a.OneNote}},[2,Object(Q.a)(v.a.OneNoteGraphCreateNoteBookRequest,"OneNote_Graph_Create_NoteBook",i,r,l,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.officeCorrelationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(b.a)(e)||""}}).then((function(t){if(t&&t.data&&!t)){var a=t.data;if(a&&a.links&&a.links.oneNoteWebUrl&&e.loginHint)return Object(Pe.a)(a.links.oneNoteWebUrl.href,e.loginHint,e.loginHintEnabled);throw new Error(e.loginHint?"Invalid Notebook item returned":"Invalid loginHint provided in notebook creation")}throw new Error((null==t?void 0:t.statusText)||"Could not parse notebook item from Graph response")})).catch((function(e){return Object(P.a)({eventName:"OneNote_Graph_Create_NoteBook_Error",errorType:"OneNote_Notebook_Create_Error",message:e}),Promise.reject({clientError:"createNewNotebook Error: ".concat(e)})}))]):[2,Promise.reject({clientError:"Invalid createNewNotebookOptions"})]}))}))})(a,t).then((function(t){if(!t)return e({type:"Error"});Object(U.a)(t).then((function(t){return e(t)}))}))}})}))}var Re=a("rZux");function Fe(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:e&&t||Promise.resolve("Error"),n.label=1;case 1:return n.trys.push([1,3,,4]),a=Object(ke.a)(e),[4,Object(Re.a)(a,t)];case 2:if(!n.sent())throw new Error("Failed to launch newly created ".concat(a," file with template."));return[3,4];case 3:return n.sent(),[2,Promise.resolve({type:"OpenNewDocFailed"})];case 4:return[2,Promise.resolve({type:"GoToBlankDoc"})]}}))}))}function Be(e){var t,a=e.app,s=e.candidate,d=e.getOrUpdatePendingCreates,m=e.createLink,p=void 0===m?void 0:m,f=e.template,v=void 0===f?void 0:f,g=e.instrumentClick,b=void 0===g?void 0:g,h=e.errorCallback,_=void 0===h?A:h,T=e.enterpriseDriveId,S=void 0===T?void 0:T,N=e.linkTarget,I=void 0===N?void 0:N,P=e.area,D=void 0===P?void 0:P;return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,m,f,g,h,T,N,A,P,M,L,R,F,H,z,V,G,Q,X,q,Y;return Object(n.__generator)(this,(function(Z){switch(Z.label){case 0:return[4,Object(r.a)()];case 1:return e=Z.sent(),m=null,e?(f=e.wacHostEnabled&&e.wacHostApps&&e.wacHostApps.has(a)&&(!S||e.wacHostOrgTemplatesEnabled),g=function(e,t,a){return e===c.a.Fluid||e===c.a.FluidActivityBlueprint||(null!=a?a:t)?"_self":"_blank"}(a,f,I),f||e.pwaEnabled||a===c.a.OneNote||(m=window.open("",g)),[4,Promise.all([Object(o.a)(),Object(w.a)(),Object(i.a)(),Object(u.a)(),y(),Object(E.a)()]).then()]):(b&&b("Error",p,v,0),[2,"Error"]);case 2:return h=n.__read.apply(void 0,[Z.sent(),6]),T=h[0],N=h[1],A=h[2],P=h[3],M=h[4],L=h[5],[4,Object(j.a)()];case 3:return R=Z.sent().result,a&&s&&A&&T?(F={},Object(l.b)(a)&&((F={})[O.b]=Object(C.a)(T.workload),F[O.a]=T.sessionId),H={getOrUpdatePendingCreates:d,componentContext:T,capabilities:e,templatesConfig:N,sharedContext:A,identity:P,myDriveRootUrls:null==M?void 0:M.result,referralParams:F,userEntitlements:R,targetTab:m,newDocLinkTarget:g},z=s.createDocAspxEnabled&&!f&&(T.workload===k.a.OfficeHome||T.workload===k.a.OfficeHomeReact),[4,Ne(a,L,e.scenarioId)]):(b&&b("Error",p,v,0),[2,"Error"]);case 4:if(V=Z.sent(),"_self"===g&&d()>0)return[2,"CreatePending"];switch(G=Date.now(),Q=!1,X={type:"CreatePending"},d(1),a){case c.a.Excel:case c.a.Word:case c.a.PowerPoint:case c.a.Visio:return[3,5];case c.a.OneNote:return[3,17];case c.a.OneNotePage:return[3,19];case c.a.Sway:return[3,20];case c.a.Forms:case c.a.FormsQuiz:return[3,22];case c.a.Fluid:case c.a.FluidActivityBlueprint:return[3,24];case c.a.Stream:case c.a.ScreenRecording:return[3,25];case c.a.PlayLists:case c.a.PlayList:return[3,27];case c.a.Clipchamp:return[3,28];case c.a.Designer:return[3,30]}return[3,32];case 5:return V?e.pwaEnabled?v||!x.includes(a)?[3,7]:[4,Ie(a)]:[3,10]:[3,15];case 6:return X=Z.sent(),[3,9];case 7:return v?[4,Fe(a,null!==(t=null==v?void 0:v.TemplateBinaryUrl)&&void 0!==t?t:"")]:[3,9];case 8:X=Z.sent(),Z.label=9;case 9:return[3,12];case 10:return z?[4,B({candidate:s,options:H,startTime:G,template:v,instrumentCallback:function(e){b&&b("GoToBlankDocInstant",p,v,e)},enterpriseDriveId:S})]:[3,12];case 11:"Error"!==(X=Z.sent()).type&&(Q=!0),Z.label=12;case 12:return"CreatePending"!==X.type&&"OpenNewDocFailed"!==X.type&&"Error"!==X.type?[3,14]:[4,Ee(a,s,H,G,v,S,f)];case 13:X=Z.sent(),Z.label=14;case 14:return[3,16];case 15:X={type:"Error"},Z.label=16;case 16:return[3,33];case 17:return[4,Le()];case 18:return X=Z.sent(),[3,33];case 19:return[3,33];case 20:return[4,ye(s,H,p)];case 21:return X=Z.sent(),[3,33];case 22:return[4,ge(a,s,H,D,v)];case 23:return X=Z.sent(),[3,33];case 24:return[3,33];case 25:return[4,be(a,H,D)];case 26:return X=Z.sent(),[3,33];case 27:return[3,33];case 28:return[4,W(H,D,v)];case 29:return X=Z.sent(),[3,33];case 30:return v?(q="https://designer.microsoft.com/?templateId=".concat(v.AssetId,"&correlationId=").concat(T.correlationId,"&referrer=harmony&utm_source=harmony&utm_medium=").concat(T.workload,"&utm_campaign=template"),[4,Object(U.a)(q,m,g)]):[3,32];case 31:X=Z.sent(),Z.label=32;case 32:return[3,33];case 33:return d(-1),!Q&&b&&b(X.type,p,v),(Y="Error"===(X="CreatePending"!==X.type?X:{type:"Error"}).type||"OpenNewDocFailed"===X.type||"OpenBlockedByPopupBlocker"===X.type)&&function(e,t){e&&"_blank"===t&&e.close()}(m,I),_&&Y&&_({resultType:X.type,fileType:a,documentWebUrl:X.documentWebUrl}),[2,X.type]}}))}))}},"F/x0":function(e,t,a){!function(t,a){e.exports=function(){"use strict";var e=Object.hasOwnProperty,t=Object.setPrototypeOf,a=Object.isFrozen,n=Object.getPrototypeOf,r=Object.getOwnPropertyDescriptor,o=Object.freeze,i=Object.seal,c=Object.create,l="undefined"!=typeof Reflect&&Reflect,s=l.apply,u=l.construct;s||(s=,o||(o=function(e){return e}),i||(i=function(e){return e}),u||(u=;var d=y(Array.prototype.forEach),m=y(Array.prototype.pop),p=y(Array.prototype.push),f=y(String.prototype.toLowerCase),v=y(String.prototype.match),g=y(String.prototype.replace),b=y(String.prototype.indexOf),h=y(String.prototype.trim),_=y(RegExp.prototype.test),T=TypeError);w=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),j=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),E=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),x=o(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),S=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),N=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),A=o(["#text"]),I=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),P=o(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),D=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),M=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),L=i(/\{\{[\s\S]*|[\s\S]*\}\}/gm),R=i(/<%[\s\S]*|[\s\S]*%>/gm),F=i(/^data-[\-\w.\u00B7-\uFFFF]/),B=i(/^aria-[\-\w]+$/),U=i(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=i(/^(?:\w+script|data):/i),H=i(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?ar G=Q=return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G(),a=if(a.version="2.3.1",a.removed=[],!t||!t.document||9!==t.document.nodeType)return a.isSupported=!1,a;var n=t.document,r=t.document,i=t.DocumentFragment,c=t.HTMLTemplateElement,l=t.Node,s=t.Element,u=t.NodeFilter,y=t.NamedNodeMap,X=void 0===y?t.NamedNodeMap||t.MozNamedAttrMap:y,q=t.Text,Y=t.Comment,Z=t.DOMParser,K=t.trustedTypes,J=s.prototype,$=k(J,"cloneNode"),ee=k(J,"nextSibling"),te=k(J,"childNodes"),ae=k(J,"parentNode");if("function"==typeof c){var ne=r.createElement("template");ne.content&&ne.content.ownerDocument&&(r=ne.content.ownerDocument)}var re=Q(K,n),oe=re&&Le?re.createHTML(""):"",ie=r.implementation,ce=r.createNodeIterator,le=r.createDocumentFragment,se=r.getElementsByTagName,ue=n.importNode,de={};try{de=O(r).documentMode?r.documentMode:{}}catch(e){}var me={};a.isSupported="function"==typeof ae&&ie&&void 0!==ie.createHTMLDocument&&9!==de;var pe=L,fe=R,ve=F,ge=B,be=W,he=H,_e=U,Te=null,ye=C({},[].concat(V(w),V(j),V(E),V(S),V(A))),Ce=null,Oe=C({},[].concat(V(I),V(P),V(D),V(M))),ke=null,we=null,je=!0,Ee=!0,xe=!1,Se=!1,Ne=!1,Ae=!1,Ie=!1,Pe=!1,De=!1,Me=!0,Le=!1,Re=!0,Fe=!0,Be=!1,Ue={},We=null,He=C({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ze=null,Ve=C({},["audio","video","img","source","image","track"]),Ge=null,Qe=C({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Xe="http://www.w3.org/1998/Math/MathML",qe="http://www.w3.org/2000/svg",Ye="http://www.w3.org/1999/xhtml",Ze=Ye,Ke=!1,Je=null,$e=r.createElement("form"),et=function(e){Je&&Je===e||(e&&"object"===(void 0===e?"undefined":z(e))||(e={}),e=O(e),Te="ALLOWED_TAGS"in e?C({},e.ALLOWED_TAGS):ye,Ce="ALLOWED_ATTR"in e?C({},e.ALLOWED_ATTR):Oe,Ge="ADD_URI_SAFE_ATTR"in e?C(O(Qe),e.ADD_URI_SAFE_ATTR):Qe,ze="ADD_DATA_URI_TAGS"in e?C(O(Ve),e.ADD_DATA_URI_TAGS):Ve,We="FORBID_CONTENTS"in e?C({},e.FORBID_CONTENTS):He,ke="FORBID_TAGS"in e?C({},e.FORBID_TAGS):{},we="FORBID_ATTR"in e?C({},e.FORBID_ATTR):{},je=!1!==e.ALLOW_ARIA_ATTR,Ee=!1!==e.ALLOW_DATA_ATTR,xe=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ne=e.WHOLE_DOCUMENT||!1,Pe=e.RETURN_DOM||!1,Me=!1!==e.RETURN_DOM_IMPORT,Le=e.RETURN_TRUSTED_TYPE||!1,Ie=e.FORCE_BODY||!1,Re=!1!==e.SANITIZE_DOM,Fe=!1!==e.KEEP_CONTENT,Be=e.IN_PLACE||!1,_e=e.ALLOWED_URI_REGEXP||_e,Ze=e.NAMESPACE||Ye,(Se=e.SAFE_FOR_TEMPLATES||!1)&&(Ee=!1),(De=e.RETURN_DOM_FRAGMENT||!1)&&(Pe=!0),(Ue="USE_PROFILES"in e&&e.USE_PROFILES)&&(Te=C({},[].concat(V(A))),Ce=[],!0===Ue.html&&(C(Te,w),C(Ce,I)),!0===Ue.svg&&(C(Te,j),C(Ce,P),C(Ce,M)),!0===Ue.svgFilters&&(C(Te,E),C(Ce,P),C(Ce,M)),!0===Ue.mathMl&&(C(Te,S),C(Ce,D),C(Ce,M))),e.ADD_TAGS&&(Te===ye&&(Te=O(Te)),C(Te,e.ADD_TAGS)),e.ADD_ATTR&&(Ce===Oe&&(Ce=O(Ce)),C(Ce,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&C(Ge,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(We===He&&(We=O(We)),C(We,e.FORBID_CONTENTS)),Fe&&(Te["#text"]=!0),Ne&&C(Te,["html","head","body"]),Te.table&&(C(Te,["tbody"]),delete ke.tbody),o&&o(e),Je=e)},tt=C({},["mi","mo","mn","ms","mtext"]),at=C({},["foreignobject","desc","title","annotation-xml"]),nt=C({},j);C(nt,E),C(nt,x);var rt=C({},S);C(rt,N);var ot=it=ct=lt=st=ut=dt=mt=pt=function(e){var t=void 0;if(mt("beforeSanitizeElements",e,null),ut(e))return it(e),!0;if(v(e.nodeName,/[\u0080-\uFFFF]/))return it(e),!0;var n=f(e.nodeName);if(mt("uponSanitizeElement",e,{tagName:n,allowedTags:Te}),!dt(e.firstElementChild)&&(!dt(e.content)||!dt(e.content.firstElementChild))&&_(/<[/\w]/g,e.innerHTML)&&_(/<[/\w]/g,e.textContent))return it(e),!0;if("select"===n&&_(/<template/i,e.innerHTML))return it(e),!0;if(!Te[n]||ke[n]){if(Fe&&!We[n]){var r=ae(e)||e.parentNode,o=te(e)||e.childNodes;if(o&&r)for(var i=o.length-1;i>=0;--i)r.insertBefore($(o[i],!0),ee(e))}return it(e),!0}return e instanceof s&&!ot(e)?(it(e),!0):"noscript"!==n&&"noembed"!==n||!_(/<\/no(script|embed)/i,e.innerHTML)?(Se&&3===e.nodeType&&(t=g(t=e.textContent,pe," "),t=g(t,fe," "),e.textContent!==t&&(p(a.removed,{element:e.cloneNode()}),e.textContent=t)),mt("afterSanitizeElements",e,null),!1):(it(e),!0)},ft=vt=function(e){var t=void 0,n=void 0,r=void 0,o=void 0;mt("beforeSanitizeAttributes",e,null);var i=e.attributes;if(i){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ce};for(o=i.length;o--;){var l=(t=i[o]).name,s=t.namespaceURI;if(n=h(t.value),r=f(l),c.attrName=r,c.attrValue=n,c.keepAttr=!0,c.forceKeepAttr=void 0,mt("uponSanitizeAttribute",e,c),n=c.attrValue,!c.forceKeepAttr&&(ct(l,e),c.keepAttr))if(_(/\/>/i,n))ct(l,e);else{Se&&(n=g(n,pe," "),n=g(n,fe," "));var u=e.nodeName.toLowerCase();if(ft(u,r,n))try{s?e.setAttributeNS(s,l,n):e.setAttribute(l,n),m(a.removed)}catch(e){}}}mt("afterSanitizeAttributes",e,null)}},gt=return a.sanitize=a.setConfig=a.clearConfig=a.isValidAttribute=a.addHook=a.removeHook=a.removeHooks=a.removeAllHooks=a}()}()}()},Haco:I0st:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("CDuu"),r=a("gy05");function o(){return Object(n.a)(r.a)}},IQ4X:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return i}));var n="Shell",r=n.length,o=3,i=4},JSSH:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("tBub"),r=a("qecA");function o(e,t){var a,n;if(e){var r=e.find((function(e){return"MT"===e.ImageType}));return r?r.Url:void 0}if(t){var o=null===(a=t.find((function(e){return"large"===e.ImageSize.toLowerCase()})))||void 0===a?void 0:a.Url,i=null===(n=t.find(())||void 0===n?void 0:n.Url;return o||i}}function i(e){if(e){var t=e.find((function(e){return"LT"===e.ImageType})),a=e.find(();return t||a}}function c(e,t){return{title:e.Title,ariaLabel:e.Title,thumbnail:o(e.Thumbnails,e.Images),appName:Object(r.a)(e),extension:e.TemplateBinaryUrl?Object(n.a)(t?e.TemplateBinaryUrl.slice(0,e.TemplateBinaryUrl.indexOf("&",e.TemplateBinaryUrl.lastIndexOf("."))):e.TemplateBinaryUrl):"",galleryThumbnail:t?void 0:i(e.Thumbnails)}}},"Jxb/":function(e,t,a){"use strict";var n;a.d(t,"a",(function(){return n})),n||(n={}))},K7tG:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("mXGw"),r=a("T8eN"),o=a("I0st");function i(){var e=Object(o.a)().data;return Object(n.useMemo)((function(){if(e)return Object(r.a)(e)}),[e])}},KQ1A:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("QjXU"),r=a("mgFK"),o=a("aADZ"),i={key:"TemplatesConfig",isGetClientGeneratedConfigEnabled:getClientGeneratedConfig:function(e){var t,a,n,r,i,c,l,s,u,d,m,p,f,v,g,b,h,_,T,y,C,O,k,w,j=e.featureGates,E=e.featureSettings,x=e.userEntitlements;if(null===x)throw new Error("UserEntitlements is null");var S=x.isConsumerUser,N=x.IsOfficeProPlus,A=null!==(a=null===(t=j.wacStartPageGates)||void 0===t?void 0:t.wacStartPageCreateLcidEnabled)&&void 0!==a&&a,I=null!==(r=null===(n=j.templatesGates)||void 0===n?void 0:n.templatesTemplatesFormsEnabled)&&void 0!==r&&r,P=null!==(c=null===(i=j.wacStartPageGates)||void 0===i?void 0:i.wacStartPageTemplatesEnabled)&&void 0!==c&&c,D=null!==(s=null===(l=j.wacStartPageGates)||void 0===l?void 0:l.wacStartPageEnterpriseTemplatesEnabled)&&void 0!==s&&s,M=Object(o.a)(null===(u=E.wacStartPage)||void 0===u?void 0:u.numTemplates),L=Object(o.a)(null===(d=E.wacStartPage)||void 0===d?void 0:d.numVisioTemplates),R=null!==(p=null===(m=E.wacStartPage)||void 0===m?void 0:m.templatesApiEndpoint)&&void 0!==p?p:"",F=null!==(v=null===(f=E.templates)||void 0===f?void 0:f.templatesCollectionsCommercial)&&void 0!==v?v:"",B=null!==(b=null===(g=E.templates)||void 0===g?void 0:g.templatesCollectionsConsumer)&&void 0!==b?b:"",U=null!==(_=null===(h=E.templates)||void 0===h?void 0:h.templatesCollectionsEdu)&&void 0!==_?_:"",W={};return W.excel=null!==(y=null===(T=E.consumerExcelStartPageTemplateCollection)||void 0===T?void 0:T.value)&&void 0!==y?y:"",W.word=null!==(O=null===(C=E.consumerWordStartPageTemplateCollection)||void 0===C?void 0:C.value)&&void 0!==O?O:"",W.powerpoint=null!==(w=null===(k=E.consumerPowerPointStartPageTemplateCollection)||void 0===k?void 0:k.value)&&void 0!==w?w:"",{createLcidEnabled:A,enterpriseTemplatesEnabled:P&&D&&N,numTemplates:M,numVisioTemplates:L,templatesApiEndpoint:R,templatesFormsEnabled:I||S,templatesCollectionsCommercial:F.split(","),templatesCollectionsConsumer:B.split(","),templatesCollectionsEdu:U.split(","),startPagesConsumerTemplatesCollectionIds:W}},getServerGeneratedConfig:function(e){return function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(r.a)("templatesPageConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}}},Ke3b:LSXK:LzJX:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("mXGw");function r(e,t,a){var r=this,o=Object(n.useRef)(null),i=Object(n.useRef)(0),c=Object(n.useRef)(null),l=Object(n.useRef)([]),s=Object(n.useRef)(),u=Object(n.useRef)(),d=Object(n.useRef)(e),m=Object(n.useRef)(!0);d.current=e;var p=!t&&0!==t&&"undefined"!=typeof window;if("function"!=typeof e)throw new TypeError("Expected a function");t=+t||0;var f=!!(a=a||{}).leading,v=!("trailing"in a)||!!a.trailing,g="maxWait"in a,b=g?Math.max(+a.maxWait||0,t):null;return Object(n.useEffect)((,[]),Object(n.useMemo)((function(){var e=a=n=h=_=function(){var e=Date.now();if(n(e))return h(e);if(m.current){var r=t-(e-o.current),c=g?Math.min(r,b-(e-i.current)):r;a(_,c)}},T=return T.cancel=T.isPending=T.flush=T}),[f,g,t,b,v,p])}},MLvN:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n,r,o=a("gzKm"),i=a("duEa"),c=a("85o7"),l=a("jJrO"),s=a("OeRt"),u=a("XxaS"),d=a("pUzp"),m=a("XrJr"),p=a("+9uq"),f=a("U4Iz"),v=a("PmtM"),g=a("YGV3"),b=a("iTb/"),h=a("cipv"),_=a("jH7j"),T=a("mXGw"),y=a.n(T),C=a("p/uK"),O=a("DG+G"),k=Object(C.a)({filled:(n={},n["&.".concat(O.a)]={display:"inline-block"},n["&.".concat(O.b)]={display:"none"},n),regular:(r={},r["&.".concat(O.a)]={display:"none"},r["&.".concat(O.b)]={display:"inline-block"},r)}),w=function(e){var t=e.iconName,a=e.filled,n=k(),r=void 0;switch(t){case"ArrowLeftIcon":var T=Object(o.a)(i.J,i.K);r=y.a.createElement(T,{filled:!0,className:a?n.filled:n.regular});break;case"ArrowRightIcon":var C=Object(o.a)(i.R,i.S);r=y.a.createElement(C,{filled:!0,className:a?n.filled:n.regular});break;case"ArrowSortDownIcon":r=y.a.createElement(i.C,null);break;case"ArrowSortUpIcon":r=y.a.createElement(c.g,null);break;case"AttachIcon":var O=Object(o.a)(c.n,c.o);r=y.a.createElement(O,{filled:!0,className:a?n.filled:n.regular});break;case"BackToTopIcon":r=y.a.createElement(c.h,null);break;case"CalendarEmptyIcon":var w=Object(o.a)(l.c,l.d);r=y.a.createElement(w,{filled:!0,className:a?n.filled:n.regular});break;case"CalendarIcon":var j=Object(o.a)(l.g,l.h);r=y.a.createElement(j,{filled:!0,className:a?n.filled:n.regular});break;case"ChevronDownIcon":r=y.a.createElement(s.n,null);break;case"ChevronUpIcon":r=y.a.createElement(s.D,null);break;case"ClockIcon":var E=Object(o.a)(s.E,s.F);r=y.a.createElement(E,{filled:!0,className:a?n.filled:n.regular});break;case"CloudIcon":var x=Object(o.a)(s.G,s.H);r=y.a.createElement(x,{filled:!0,className:a?n.filled:n.regular});break;case"CommentIcon":var S=Object(o.a)(s.L,s.M);r=y.a.createElement(S,{filled:!0,className:a?n.filled:n.regular});break;case"CompassIcon":r=y.a.createElement(u.a,null);break;case"DesktopIcon":var N=Object(o.a)(u.o,u.p);r=y.a.createElement(N,{filled:!0,className:a?n.filled:n.regular});break;case"DismissIcon":var A=Object(o.a)(u.w,u.x);r=y.a.createElement(A,{filled:!0,className:a?n.filled:n.regular});break;case"DocumentIcon":var I=Object(o.a)(u.E,u.F);r=y.a.createElement(I,{filled:!0,className:a?n.filled:n.regular});break;case"EditIcon":var P=Object(o.a)(d.f,d.g);r=y.a.createElement(P,{filled:!0,className:a?n.filled:n.regular});break;case"EyeHideIcon":var D=Object(o.a)(d.l,d.m);r=y.a.createElement(D,{filled:!0,className:a?n.filled:n.regular});break;case"FilterIcon":var M=Object(o.a)(d.p,d.q);r=y.a.createElement(M,{filled:!0,className:a?n.filled:n.regular});break;case"FluidIcon":var L=Object(o.a)(m.a,m.b);r=y.a.createElement(L,{filled:!0,className:a?n.filled:n.regular});break;case"GlobeIcon":var R=Object(o.a)(m.o,m.p);r=y.a.createElement(R,{filled:!0,className:a?n.filled:n.regular});break;case"ImageIcon":var F=Object(o.a)(p.d,p.e);r=y.a.createElement(F,{filled:!0,className:a?n.filled:n.regular});break;case"LayerIcon":var B=Object(o.a)(p.p,p.q);r=y.a.createElement(B,{filled:!0,className:a?n.filled:n.regular});break;case"MentionIcon":var U=Object(o.a)(f.e,f.f);r=y.a.createElement(U,{filled:!0,className:a?n.filled:n.regular});break;case"NavigationIcon":var W=Object(o.a)(f.o,f.p);r=y.a.createElement(W,{filled:!0,className:a?n.filled:n.regular});break;case"NewsIcon":r=y.a.createElement(f.q,null);break;case"NotepadIcon":var H=Object(o.a)(f.r,f.s);r=y.a.createElement(H,{filled:!0,className:a?n.filled:n.regular});break;case"OpenIcon":r=y.a.createElement(f.x,null);break;case"PdfIcon":var z=Object(o.a)(d.c,d.d);r=y.a.createElement(z,{filled:!0,className:a?n.filled:n.regular});break;case"PeopleCommunityIcon":var V=Object(o.a)(v.f,v.g);r=y.a.createElement(V,{filled:!0,className:a?n.filled:n.regular});break;case"PeopleIcon":var G=Object(o.a)(v.a,v.b);r=y.a.createElement(G,{filled:!0,className:a?n.filled:n.regular});break;case"PersonIcon":var Q=Object(o.a)(v.k,v.l);r=y.a.createElement(Q,{filled:!0,className:a?n.filled:n.regular});break;case"PinIcon":r=y.a.createElement(v.u,null);break;case"PinOffIcon":r=y.a.createElement(v.w,null);break;case"ContentListIcon":var X=Object(o.a)(g.T,g.U);r=y.a.createElement(X,{filled:!0,className:a?n.filled:n.regular});break;case"SearchIcon":r=y.a.createElement(g.Z,null);break;case"SmallDismissIcon":var q=Object(o.a)(u.s,u.t);r=y.a.createElement(q,{filled:!0,className:a?n.filled:n.regular});break;case"SnoozeExpiryIcon":r=y.a.createElement(i.m,null);break;case"StarIcon":var Y=Object(o.a)(b.o,b.p);r=y.a.createElement(Y,{filled:!0,className:a?n.filled:n.regular});break;case"SyncIcon":r=y.a.createElement(c.a,null);break;case"TaskIcon":var Z=Object(o.a)(h.j,h.i);r=y.a.createElement(Z,{filled:!0,className:a?n.filled:n.regular});break;case"TrendingIcon":r=y.a.createElement(c.e,null);break;case"VideoIcon":var K=Object(o.a)(_.f,_.e);r=y.a.createElement(K,{filled:!0,className:a?n.filled:n.regular});break;case"VideoClipMultipleIcon":r=y.a.createElement(_.g,null);break;case"WindowNewIcon":r=y.a.createElement(_.m,null);break;case"WhiteboardIcon":var J=Object(o.a)(_.k,_.l);r=y.a.createElement(J,{filled:!0,className:a?n.filled:n.regular})}return r?y.a.createElement("span",null,r):null}},MgoT:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return l}));var n=a("a3FV"),r=a("lUkk"),o=new(a("AlWG").a)(null);function i(){return o.asObservable()}function c(e){o.next(e),Object(r.a)({eventName:n.a.OpenCreateNewNotebookDialog,id:"OneNoteNotebookCreateLink",area:"InputDialog",subArea:"CreateLinks",result:"Open",target:"Other"})}function l(){o.next(null)}},MqQ1:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a("QjXU"),r=a("MLvN"),o=a("wK4g"),i=a("8Jek"),c=a.n(i),l=a("mXGw"),s=a.n(l),u="PillControl-module__pill__u3Iap",d="PillControl-module__pill--active__nrKxv",m="PillControl-module__pill--dropdown__2Swcx",p="PillControl-module__pill--static__19F_f",f="PillControl-module__pill--dropdown--active__1telc",v="PillControl-module__icon__18HZK",g="PillControl-module__icon--active__1IDIf",b=Object(l.forwardRef)((function(e,t){var a,i,b,h=e.id,_=e.title,T=e.onClick,y=e.isActive,C=e.iconName,O=e.iconElement,k=e.iconElementActive,w=e.isDropdown,j=e.isRemovable,E=e.isStatic,x=e.onRemoveClick,S=e.disableFocus,N=e.style,A=e.pillTextStyle,I=e.ariaLabel,P=e.ariaDescribedbyId,D=e.removePillAriaLabel,M=e.onKeyDown,L=e.disableRemoveFocus,R=Object(l.useCallback)((function(e){null==e||e.stopPropagation(),x&&x()}),[x]),F=Object(n.__read)(Object(l.useState)(),2),B=F[0],U=F[1],W=Object(n.__read)(Object(l.useState)(),2),H=W[0],z=W[1];Object(l.useEffect)((function(){O&&Promise.resolve(O).then(U)}),[O]),Object(l.useEffect)((function(){k&&Promise.resolve(k).then(z)}),[k]);var V=w&&C,G=Object(l.useMemo)((function(){var e,t,a;return H&&y?s.a.createElement("div",{className:c()(v,(e={},e[g]=!V,e))},H):B?s.a.createElement("div",{className:c()(v,(t={},t[g]=y&&!V,t))},B):C?s.a.createElement(o.a,{className:c()(v,(a={},a[g]=y&&!V,a)),iconName:"".concat(C).concat(y?"Active":"")}):null}),[C,y,V,B,H]),Q=Object(l.useMemo)((function(){var e;return s.a.createElement("span",{className:c()("PillControl-module__pill-text__1FOSO",(e={},e["PillControl-module__pill-text--active__3IPFs"]=y&&!V,e["PillControl-module__pill-text--static__2_3G-"]=E,e))},s.a.createElement("div",{className:"PillControl-module__pill-text--fake__2kBQW",title:_,style:A},_))}),[y,V,E,A,_]),X=Object(l.useMemo)((function(){return s.a.createElement(o.a,{className:"PillControl-module__dropdown__1DQhw",iconName:y?"ChevronDownActive":"ChevronDown"})}),[y]);return T||x||M?s.a.createElement("button",{id:h,ref:t,onClick:T,onKeyDown:className:c()(u,(i={},i[d]=y,i[p]=E,i[m]=V,i[f]=V&&y,i)),tabIndex:S?-1:0,"data-clicklog":"custom",style:N,"aria-label":I,"aria-describedby":P},G,Q,w&&X,j?s.a.createElement("div",{className:c()("PillControl-module__remove__3Os5v",(b={},b["PillControl-module__remove--active__3eMa0"]=y,b["PillControl-module__remove--static__2QV10"]=E,b)),onClick:R,onKeyDown:function(e){e.stopPropagation(),"Enter"!==e.key&&"Space"!==e.key||(e.preventDefault(),R(e))},"aria-hidden":!1,"aria-label":D,role:L?"none":"button",tabIndex:L?-1:0},s.a.createElement(r.a,{iconName:"SmallDismissIcon"})):null):s.a.createElement("span",{id:h,className:c()(u,(a={},a[d]=y,a[p]=E,a[m]=V,a[f]=V&&y,a)),"data-clicklog":"custom",style:N,"aria-label":I,tabIndex:S?void 0:0,"aria-hidden":S,"aria-describedby":P},G,Q,w&&X)}));b.displayName="PillControl"},N1Lx:"Nn/S":PZ4A:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l}));var n,r,o=a("6ib3");function i(){return(n={})[o.a[o.a.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],n[o.a[o.a.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],n[o.a[o.a.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],n[o.a[o.a.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],n[o.a[o.a.Photos]]=["jpg","png","jpeg","gif","svg","bmp","tif","tiff","heic"],n[o.a[o.a.Outlook]]=["msg","eml"],n[o.a[o.a.OneNote]]=["one"],n[o.a[o.a.Pdf]]=["pdf"],n[o.a[o.a.Audio]]=["mp3","m4a","wav","wma"],n[o.a[o.a.Text]]=["txt"],n[o.a[o.a.Fluid]]=["fluid","loop"],n[o.a[o.a.Stream]]=["mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg"],n[o.a[o.a.Whiteboard]]=["whiteboard"],n[o.a[o.a.MeetingNotes]]=["note"],n[o.a[o.a.Clipchamp]]=["clipchamp"],n[o.a[o.a.Link]]=["url"],n[o.a[o.a.Draft]]=["draft"],n}function c(e){return r||(r=function(){n||(n=i()),r={};var e=function(e){if(!n.hasOwnProperty(e))return"continue";var t=n[e];if(!t)return"continue";t.forEach(()};for(var t in n)e(t);return r}()),e&&r[e.toLowerCase()]||o.a.None}function l(e){return n||(n=i()),n[e]}},PoVA:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("a3FV"),r=a("V1Qu"),o=a("9pXf");function i(e){if(!e.oneDriveResourceId)return Promise.reject("Missing oneDrive resource");var t=Object(r.e)(e.oneDriveResourceId,e,!1,!0),a="".concat(t,"/drive?select=wacBootstrapInfo");return Object(o.a)(e,a,"OneDrive",e.oneDriveResourceId,n.a.WacBootstrapInfoRequest,"Wac_Bootstrap_Info","wacBootstrapInfo",!1,{category:"TemplatesPage",fileType:"Visio"},().then((function(e){return e.wacBootstrapInfo?e.wacBootstrapInfo.wacComplianceRegion:Promise.reject({clientError:"Invalid response for wacBootStrapInfo"})}))}},QLkI:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("QjXU"),r=a("28zg"),o=a("JGoI");function i(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){return[2,Object(r.a)(o.a)]}))}))}},Qcgp:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a("NrNW"),r=a("1w9C"),o=a("6fXp"),i=a("CaQ9"),c=a("h8qh"),l=a("Ke3b"),s=a("Coo+"),u=a("mXGw");function d(e){switch(e){case"default":return function(){return a.e(167).then(a.bind(null,"vS1s"))};case"default-enterprise":return function(){return a.e(639).then(a.bind(null,"EVfI"))};case"custom":return default:return }var m=function(e,t){var a,m,p,f=Object(o.a)().data,v=Object(i.a)().data,g=Object(n.a)().data,b=null===(m=null===(a=Object(s.a)())||void 0===a?void 0:a.data)||void 0===m?void 0:m.result,h=Object(l.a)().data,_=null===(p=Object(c.a)())||void 0===p?void 0:p.data,T=Object(u.useMemo)((function(){if(f&&v&&_&&g&&b&&h&&t)return{encryptionKeyResult:f,identity:v,locStrings:_,officeComponentContext:g,providerType:t,templatesConfig:h,userEntitlements:b,app:e}}),[f,v,_,g,b,h,t,e]);return Object(r.a)(d,t,T)}},RV7E:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return i}));var n=new(a("AlWG").a)(null);S9J+":function(e,t,a){"use strict";var n=this&&this.__extends||),r=this&&this.__assign||Object.defineProperty(t,"__esModule",{value:!0}),t.cloneNode=t.hasChildren=t.isDocument=t.isDirective=t.isComment=t.isText=t.isCDATA=t.isTag=t.Element=t.Document=t.NodeWithChildren=t.ProcessingInstruction=t.Comment=t.Text=t.DataNode=t.Node=void 0;var o=a("Nn/S"),i=new Map([[o.ElementType.Tag,1],[o.ElementType.Script,1],[o.ElementType.Style,1],[o.ElementType.Directive,1],[o.ElementType.Text,3],[o.ElementType.CDATA,4],[o.ElementType.Comment,8],[o.ElementType.Root,9]]),c=);t.Node=c;var l=c);t.DataNode=l;var s=function(e){function t(t){return e.call(this,o.ElementType.Text,t)||this}return n(t,e),t}(l);t.Text=s;var u=function(e){function t(t){return e.call(this,o.ElementType.Comment,t)||this}return n(t,e),t}(l);t.Comment=u;var d=l);t.ProcessingInstruction=d;var m=c);t.NodeWithChildren=m;var p=m);t.Document=p;var f=m);unction g(e){return e.type===o.ElementType.CDATA}function b(e){return e.type===o.ElementType.Text}function h(e){return e.type===o.ElementType.Comment}function _(e){return e.type===o.ElementType.Directive}lement=f,t.isTag=v,t.isCDATA=g,t.isText=b,t.isComment=h,t.isDirective=_,t.isDocument=T,t.hasChildren=t.cloneNode=y},Sn4U:function(e,t,a){"use strict";var n;a.d(t,"a",(function(){return n})),n||(n={}))},SnJU:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a("QjXU"),r=a("6ib3"),o=a("l+H3"),i=a("K7tG"),c=a("mXGw"),l=a("Ea7i"),s=a("DCX/"),u=a("MJsD"),d=a("5eS3"),m=a("frjS"),p=a("Ohvh"),f=new Set([r.a.Clipchamp,r.a.Designer,r.a.Excel,r.a.Forms,r.a.FormsQuiz,r.a.OneNote,r.a.OneNotePage,r.a.PowerBI,r.a.PowerPoint,r.a.List,r.a.NewsArticle,r.a.SharePoint,r.a.Sway,r.a.Visio,r.a.Whiteboard,r.a.Word,r.a.Yammer,r.a.Stream,r.a.ScreenRecording]);function v(e){var t=r.a[e]+"_ButtonBackground";return f.has(e)?t:void 0}var g=a("a3FV"),b=a("lUkk"),h=a("Dn7E"),_=a("rTyw"),T=a("1aUa"),y=a("hu41"),C=a("NZpx"),O=a("NrNW"),k=a("ynVX"),w=a("CU8J"),j=a("CaQ9"),E=a("h8qh"),x=a("BhFD"),S=a("ijiB");function N(e,t,a,f){var N=Object(i.a)(),A=Object(y.a)(),I=function(){var e,t,a,n,o,i,l,s,u=Object(E.a)().data,d=Object(C.a)().data,m=Object(j.a)().data,p=Object(w.a)().data,f=Object(O.a)().data,v=Object(k.a)().data,g=null==p?void 0:p.result,b=(null===(e=null==g?void 0:g.createFluidLoopGates)||void 0===e?void 0:e.createFluidLoopEnabled)||!1,h=(null===(t=null==g?void 0:g.firstDraftGates)||void 0===t?void 0:t.firstDraftEnabled)||!1,_=(null===(a=null==g?void 0:g.listsCreateGates)||void 0===a?void 0:a.listsCreateEnabled)||!1,T=(null===(n=null==g?void 0:g.createDesignerGates)||void 0===n?void 0:n.createDesignerEnabled)||!1,y=(null===(o=null==g?void 0:g.powerBiCreateGates)||void 0===o?void 0:o.powerBiCreateEnabled)||!1,S=(null===(i=null==g?void 0:g.whiteboardCreateGates)||void 0===i?void 0:i.whiteboardCreateEnabled)||!1,N=(null===(l=null==g?void 0:g.yammerCreateGates)||void 0===l?void 0:l.yammerCreateEnabled)||!1,A=(null===(s=null==g?void 0:g.createClipchampGates)||void 0===s?void 0:s.createClipchampEnabled)&&!(null==m?void 0:m.isOrgId)||!1,I=function(e,t,a){var n=Object(c.useMemo)((function(){return e&&t&&a&&a.isOrgId?{correlationId:null==e?void 0:e.correlationId,getAccessToken:null==e?void 0:e.getAccessToken,inMockMode:null==e?void 0:e.inMockMode,jwtAuthEnabled:null==e?void 0:e.jwtAuthEnabled,officeHomeApiRoot:e.officeHomeApiRoot,sharePointResourceId:null==t?void 0:t.sharePointResourceId,userId:null==a?void 0:a.puid}:void 0}),[a,e,t]),r=Object(x.a)(n).data;return null==r?void 0:r.result}(f,v,m);return Object(c.useMemo)((function(){if(u&&d&&g){var e=new Map;return _&&e.set(r.a.List,{name:u.linkCandidateResources.listsName,creationFileType:r.a[r.a.List],fileTypeNameLocalized:u.linkCandidateResources.createFileTypeNameListsList,id:"ListsAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:u.linkCandidateResources.createMenuLinkListsTitle,contentUrl:(null==m?void 0:m.isMsa)?"openCreate=true&workload=Office&ocid=OfficeConsumerWebCreate":"openCreate=true&workload=Office&ocid=OfficeWebCreate",websiteUrl:"",scopes:[]}],version:"1.0.0."}),N&&e.set(r.a.Yammer,{name:u.linkCandidateResources.yammerName,creationFileType:r.a[r.a.Yammer],fileTypeNameLocalized:u.linkCandidateResources.createFileTypeNameYammerPost,id:"YammerAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:u.linkCandidateResources.createMenuLinkYammerPostTitle,contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0."}),y&&e.set(r.a.PowerBI,{name:u.linkCandidateResources.powerBiName,creationFileType:r.a[r.a.PowerBI],fileTypeNameLocalized:u.linkCandidateResources.createFileTypeNamePowerBiReport,id:"PowerBIAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:u.linkCandidateResources.createMenuLinkPowerBiTitle,contentUrl:"",websiteUrl:"groups/me/quickcreate",scopes:[]}],version:"1.0.0."}),S&&I&&e.set(r.a.Whiteboard,{name:u.linkCandidateResources.whiteboardName,creationFileType:r.a[r.a.Whiteboard],fileTypeNameLocalized:u.linkCandidateResources.createFileTypeNameWhiteboardWhiteboards,id:"WhiteboardAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:u.linkCandidateResources.createMenuLinkWhiteboardTitle,contentUrl:"openCreate=true",websiteUrl:"",scopes:[]}],version:"1.0.0."}),T&&(null==m?void 0:m.isMsa)&&"en-US"===(null==f?void 0:f.preferredCulture)&&e.set(r.a.Designer,{name:u.linkCandidateResources.designerName,creationFileType:r.a[r.a.Designer],fileTypeNameLocalized:u.linkCandidateResources.createFileTypeNameDesignerDesign,id:"DesignerAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:u.linkCandidateResources.createMenuLinkDesignerTitle,contentUrl:"",websiteUrl:"https://designer.microsoft.com/new?referrer=harmony",scopes:[]}],version:"1.0.0."}),h&&b&&e.set(r.a.Fluid,{name:u.linkCandidateResources.loopName,creationFileType:r.a[r.a.Fluid],fileTypeNameLocalized:u.linkCandidateResources.createFileTypeNameLoopFluid,id:"LoopAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:u.linkCandidateResources.createMenuLinkLoopFluidTitle,contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0."}),A&&e.set(r.a.Clipchamp,{name:u.linkCandidateResources.clipchampName,creationFileType:r.a[r.a.Clipchamp],fileTypeNameLocalized:u.linkCandidateResources.createFileTypeNameClipchampVideo,id:"ClipchampAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:u.linkCandidateResources.createMenuLinkClipchampTitle,contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0"}),e}}),[d,A,null==f?void 0:f.preferredCulture,T,g,h,null==m?void 0:m.isMsa,_,u,b,y,S,I,N])}(),P=function(e){return Object(c.useCallback)((function(t,a,n,o){if(a&&a.id&&a.workload&&a.workload.referral){var i=a.workload.referral;Object(b.a)({id:a.id,area:e,result:i&&Object(T.a)(t)?"Refer":"Navigate",target:i&&Object(T.a)(t)?Object(_.a)(i):"Other",eventName:g.a.CreateLinkClick})}a&&a.id&&a.creationFileType&&Object(h.a)({featureName:"Create",eventName:g.a.CreateLinkClickResult,area:e,params:{ElementId:a.id,Action:t,DocumentType:r.a[a.creationFileType].toLowerCase(),ProcessTime:o||-1}})}),[e])}(e),D=Object(n.__read)(Object(o.a)(),2),M=D[0],L=D[1],R=Object(S.a)(),F=Object(c.useCallback)((function(){if(t){var e=[];return null==t||t.forEach((function(t){var a;if(a=null==N?void 0:N.find((function(e){return e.FileType===t||t===r.a.FormsQuiz&&e.FileType===r.a.Forms||t===r.a.ScreenRecording&&e.FileType===r.a.Stream}))){var n=t===r.a.FormsQuiz?r.a.FormsQuiz:t===r.a.ScreenRecording?r.a.ScreenRecording:a.FileType,o=n&&A.get(n);if(n&&o){var i=function(e,t,a){var n=e.Id;return a===r.a.FormsQuiz&&(n=e.Id+"Quiz"),a===r.a.ScreenRecording&&(n=e.Id+"ScreenRecording"),{ariaLabel:t.title,title:t.title,fileTypeNameLocalized:t.fileTypeName,appName:t.appName,creationFileType:a,icon:(a===r.a.Clipchamp?"ms-Icon--ClipchampLogo ms-svg-Icon":void 0)||"",workload:{id:n,app:e.Text,text:e.Text,title:e.Title,url:e.Url,color:e.Color,referral:e.Referral},url:e.Url,svgButtonBackground:v(a),id:n}}(a,o,n);i&&e.push(i)}}})),e}}),[A,t,N]),B=Object(c.useCallback)((function(){if(f){var e=[];return null==f||f.forEach((function(t){var a=null==I?void 0:I.get(t);if(a){var n=null==N?void 0:N.find((function(e){var t;return(null==e?void 0:e.AppId)===a.name||(null===(t=e.AppId)||void 0===t?void 0:t.includes(a.name.replace(/\s/g,"")))})),o=function(e,t){var a=Object(p.a)(e.creationFileType);if(a){if(e.creationFileType===r.a[r.a.Designer])return function(e){var t=Object(p.a)(e.creationFileType);if(t){var a="https://designer.microsoft.com/new?referrer=harmony",n=e.name,r=e.staticTabs&&e.staticTabs[0].name||e.name;return{id:n,ariaLabel:r,title:r,fileTypeNameLocalized:e.fileTypeNameLocalized||"",creationFileType:t,appName:e.name,icon:"Designer_AppIcon",workload:{id:n,app:e.name,color:"#593EF2",text:e.name,title:r,url:a,referral:n},url:a,svgButtonBackground:v(t),createFromManifest:!0}}}(e);if(e.creationFileType===r.a[r.a.Clipchamp])return function(e){var t=Object(p.a)(e.creationFileType);if(t){var a="https://app.clipchamp.com/editor/new?context=microsoft&utm_source=m365createblank",n=e.name,r=e.staticTabs&&e.staticTabs[0].name||e.name;return{id:n,ariaLabel:r,title:r,fileTypeNameLocalized:e.fileTypeNameLocalized||"",creationFileType:t,appName:e.name,icon:"ms-Icon--ClipchampLogo ms-svg-Icon",workload:{id:n,app:e.name,color:"#0C9D8C",text:e.name,title:r,url:a,referral:n},url:a,svgButtonBackground:v(t),createFromManifest:!0}}}(e);if(t){var n=function(e,t){var a,n=null===(a=t.Url)||void 0===a?void 0:a.split("?"),r="".concat(n[0]).concat(n[0].endsWith("/")?"":"/").concat(e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].websiteUrl?e.staticTabs[0].websiteUrl:""),o="".concat(n[1]?n[1]+"&":"").concat(e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].contentUrl?e.staticTabs[0].contentUrl:"");return"".concat(r,"?").concat(o)}(e,t),o=e.name.replace(/\s/g,""),i=e.staticTabs&&e.staticTabs[0].name||e.name;return{id:o,ariaLabel:i,title:i,fileTypeNameLocalized:e.fileTypeNameLocalized||"",creationFileType:a,appName:t.Text,icon:t.FileType===r.a.List?void 0:t.IconUnicodeCodepointCssClass,workload:{id:o,app:e.name,color:t.Color,text:e.name,title:i,url:n,referral:o},url:n,svgButtonBackground:v(a),createFromManifest:!0}}}}(a,n);o&&e.push(o)}})),e}}),[I,f,N]);return Object(c.useMemo)((function(){var t=F();null==t||t.forEach((function(t){var n=A&&t&&A.get(t.creationFileType);n&&(t.onClick=function(){L&&L(null==t?void 0:t.appName)?M({workloadId:t.id,area:e,subArea:"CreateLinks"}):Object(l.a)({app:t.creationFileType,candidate:n,getOrUpdatePendingCreates:R,createLink:t,instrumentClick:P,errorCallback:a,area:e})})}));var r=B();return null==r||r.forEach((function(t){I&&t&&I.get(t.creationFileType)&&(t.onClick=function(){L&&L(null==t?void 0:t.appName)?M({workloadId:t.id,area:"CreateOnStart"===e?"Templates":"CreateGallery",subArea:"CreateLinks"}):function(e,t,a){Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,i,c,l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(s.a)()];case 1:return r=n.sent(),[4,Object(u.a)()];case 2:return o=n.sent(),i={type:"CreatePending"},r&&e&&e.workload&&e.workload.url?(c=Object(d.a)(e.workload.url,"cid=".concat(o.correlationId)),[4,Object(m.a)(c)]):[3,4];case 3:i=n.sent(),n.label=4;case 4:return t&&t(i.type,e),l="Error"===(i="CreatePending"!==i.type?i:{type:"Error"}).type||"OpenNewDocFailed"===i.type||"OpenBlockedByPopupBlocker"===i.type,a&&l&&a({resultType:i.type,fileType:e.creationFileType}),[2,i]}}))}))}(t,P,a)})})),Object(n.__spreadArray)(Object(n.__spreadArray)([],Object(n.__read)(null!=t?t:[]),!1),Object(n.__read)(null!=r?r:[]),!1)}),[F,B,A,L,M,e,R,P,a,I])}},SxNr:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("6ib3"),r=a("PZ4A"),o=a("tBub");function i(e){return e.TemplateBinaryUrl?Object(r.b)(Object(o.a)(e.TemplateBinaryUrl.slice(0,e.TemplateBinaryUrl.indexOf("&",e.TemplateBinaryUrl.lastIndexOf("."))))):n.a.None}},T8eN:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("IQ4X"),r=a("kwav"),o=function(e){var t=e.coreAndSegmentApps.concat(e.nonCoreAndSegmentApps);!function(e){null==e||e.forEach((function(e){e.id=e.Id,e.Referral=e.IsThirdParty?e.Id:function(e){return e&&e.length&&0===e.lastIndexOf(n.a,n.b)?e.substring(n.b):""}(e.Id),e.FileType=Object(r.a)(e.Id)}))}(t);var a=t.filter(();return null==a||a.forEach((function(e){e.IsThirdParty||(e.AppId=e.Id.slice(5),e.CollectorId="FirstParty")})),a}},Tqea:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("6ib3");function r(e){switch(e){case n.a.Word:return"Word";case n.a.Excel:return"Excel";case n.a.PowerPoint:return"PowerPoint";case n.a.OneNote:case n.a.OneNoteClassNoteBook:case n.a.OneNotePage:return"OneNote";case n.a.Pdf:return"PDF";case n.a.Visio:return"Visio";case n.a.Audio:return"Audio";case n.a.Video:return"Video";case n.a.Photos:return"Photos";case n.a.Outlook:return"Outlook";case n.a.Text:return"Text";case n.a.Sway:return"Sway";case n.a.Forms:case n.a.FormsQuiz:return"Forms";case n.a.Project:return"Project";case n.a.ProjectOperations:return"ProjectOperations";case n.a.Portfolio:return"Portfolio";case n.a.NewsArticle:return"NewsArticle";case n.a.Fluid:case n.a.MeetingNotes:return"Loop";case n.a.PowerBI:return"PowerBI";case n.a.StreamsVideo:return"Streams";case n.a.Stream:return"Stream";case n.a.ScreenRecording:return"ScreenRecording";case n.a.UpcomingMeeting:return"UpcomingMeeting";case n.a.Link:return"Link";case n.a.List:return"List";case n.a.PlayLists:return"PlayLists";case n.a.PlayList:return"PlayList";case n.a.MindMeister:return"MindMeister";case n.a.Monday:return"monday.com";case n.a.Trello:return"Trello";case n.a.Platform:return"Platform";case n.a.Whiteboard:return"Whiteboard";case n.a.MeetingObject:return"MeetingObject";case n.a.ThirdParty:return"Custom";case n.a.MyAnalytics:return"MyAnalytics";case n.a.Designer:return"Designer";case n.a.Clipchamp:return"Clipchamp";case n.a.Draft:return"Draft";default:return"Document"}}},UDoG:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("QjXU"),r=Error)},ULNy:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("tBub"),r=new Set(["pptx","potx","dotx","xltx"]);function o(e,t,a){var o=[];return t&&(o=t.value.filter((function(e){return r.has(Object(n.a)(e.name))||e.folder})).map((function(t){var a=[];if(t.thumbnails&&t.thumbnails.length>0){var n=t.thumbnails[0];a.push(e.largeThumbnails?{Size:"large",Height:n.large.height,Width:n.large.width,Url:n.large.url,ImageType:"MT"}:{Size:"medium",Height:n.medium.height,Width:n.medium.width,Url:n.medium.url,ImageType:"MT"})}return{Description:"",Market:"",NumberOfRatings:0,RecsMod:0,IsBlank:!1,Categories:[],Lcid:"",AssetId:t.id,Title:t.name,TemplateBinaryUrl:t.webUrl,Thumbnails:a,templateType:"Enterprise",driveId:e.driveId}}))),{Template:o,fromCache:a}}},V1Qu:function(e,t,a){"use strict";a.d(t,"l",(function(){return l})),a.d(t,"f",(function(){return m})),a.d(t,"k",(function(){return p})),a.d(t,"c",(function(){return f})),a.d(t,"g",(function(){return h})),a.d(t,"b",(function(){return _})),a.d(t,"e",(function(){return T})),a.d(t,"d",(function(){return y})),a.d(t,"h",(function(){return C})),a.d(t,"a",(function(){return O})),a.d(t,"i",(function(){return k})),a.d(t,"m",(function(){return w})),a.d(t,"j",();var n=a("QjXU"),r=a("Jxb/"),o=a("lpeV"),i=a("amPu"),c=a("i3m/"),l="https://graph.microsoft.com",s=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,u=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,d=/http[s]?:\/\/d\.docs\.live\.net/,m=p=function(e){return e&&e.length?"$select="+e.join(","):void 0},f=v=function(e){return e?"WacDataCenter=".concat(e):void 0},g=b=function(e){return e?"hid=".concat(e):void 0},h=function(e){return(null==e?void 0:e.isESSEnabled)&&(null==e?void 0:e.wacDataCenter)?[v(null==e?void 0:e.wacDataCenter),g(null==e?void 0:e.sessionId),b(null==e?void 0:e.hostCorrelationId)]:[]};function _(e){if(e&&e.length){if(e.match(u)||e.match(d))return"OneDrive";if(e.match(s))return"SharePoint";if(e.startsWith(l))return"Graph"}}function T(e,t,a,n){return void 0===a&&(a=!1),void 0===n&&(n=!1),"".concat(t.inMockMode?t.officeHomeApiRoot:e,a?"/_api":n?"/_api/v2.1":"/_api/v2.0")}function y(e,t,a){var n,i=t.isConsumer,c=t.oneDriveResourceId,l=new URL(e);if(l&&l.protocol&&l.host){var s=i?c:"".concat(l.protocol,"//").concat(l.host),u=i?m(t):T(s||"",t),d=i?"OneDrive":null!==(n=_(s||""))&&void 0!==n?n:"None";if(s&&u&&d)return{baseUrl:u,tokenType:d,resourceUrl:s,hostname:l.hostname};null==a||a.ULS.sendTraceTag(542492316,r.a.msoulscat_Wac_UnifiedUiHost,o.a.Error,"GetApiInfo failed. [InvalidResourceUrl: ".concat(!s,"][InvalidBaseUrl: ").concat(!u,"][InvalidTokenType: ").concat(!d,"]"))}else null==a||a.ULS.sendTraceTag(542492315,r.a.msoulscat_Wac_UnifiedUiHost,o.a.Error,"GetApiInfo failed. [InvalidParsedUrl: ".concat(!l,"][InvalidProtocol: ").concat(!(null==l?void 0:l.protocol),"][Invalidhost: ").concat(!(null==l?void 0:l.host),"]"))}function C(e,t,a,n){return void 0===n&&(n=!1),"".concat(a?e:l,"/").concat(n?"beta":"v1.0","/").concat(t)}function O(e,t,a){return new Promise((function(n,r){var o,i=!1,c=!1;e.then((function(e){o=e,!i&&a||(n(e),c=!0)}),(function(e){i&&(r(e),c=!0),i=!0})),t.then((function(e){n(e),c=!0}),(function(e){i?(r(e),c=!0):o&&!c&&(n(o),c=!0),i=!0}))}))}function k(e){return Object(i.a)(e,{accept:"application/json",prefer:"allow-zerobyte"})}function w(e){return!!e.match(u)||!!e.match(d)||!!e.match(s)}function j(e,t,a,r,o){void 0===r&&(r=""),void 0===o&&(o="open");var i=t?Object(n.__spreadArray)([],Object(n.__read)(new Set(e.concat(c.a))),!1):e,l=i.length?"$select=".concat(i.join(",")):"",s=r?"$filter=".concat(r):"";return[l,a?"$expand=thumbnails":"",t?"action=".concat(o):"",s].filter(Boolean).join("&")}},XNH3:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a("QjXU"),r=a("1aUa"),o=a("ijiB"),i=a("6ib3"),c=a("Ohvh"),l=a("ZcZ3"),s=a("a3FV"),u=a("l+H3"),d=a("lUkk"),m=a("Dn7E"),p=a("rTyw"),f=a("mXGw"),v=a("qecA"),g=a("44+c");function b(e,t,a){var b=Object(n.__read)(Object(u.a)(),2),h=b[0],_=b[1],T=Object(f.useCallback)((function(t,a,n){if(n&&n.AssetId){var o=Object(c.a)(n.Application)||i.a.None,u=Object(l.a)(o);Object(d.a)({id:n.AssetId,area:e,subArea:"Templates",result:u&&Object(r.a)(t)?"Refer":"Navigate",target:u&&Object(r.a)(t)?Object(p.a)(u):"Other",eventName:s.a.TemplateClick}),Object(m.a)({featureName:"Create",eventName:s.a.TemplateClickResult,area:e,params:{ElementId:n.AssetId,Action:t,DocumentType:Object(v.a)(n),TemplateType:n.IsPremium?"Premium":"Standard"}})}}),[e]),y=Object(o.a)();return Object(f.useCallback)((function(e){if(t)return Object(g.a)({template:e,candidate:t,instrumentClick:T,getOrUpdatePendingCreates:y,errorCallback:a,shouldShowStorageErrorDialog:_,showStorageErrorDialog:h})}),[t,a,y,T,_,h])}},XlCq:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var n="https://go.microsoft.com/fwlink/?linkid=2228772",r="login_hint"},ZbAl:ZcZ3:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("6ib3"),r=a("Tqea");function o(e){switch(e){case n.a.Word:return"WordOnline";case n.a.Excel:return"ExcelOnline";case n.a.PowerPoint:return"PowerPointOnline";case n.a.OneNote:return"OneNoteOnline";case n.a.Sway:return"Sway";case n.a.Visio:return"VisioOnline";case n.a.Project:case n.a.ProjectOperations:case n.a.Portfolio:return"Project";case n.a.PowerBI:return"PowerBIv2";default:return Object(r.a)(e)}}},ZrMS:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("faS/"),r=a("pKjf"),o=a("mXGw"),i=function(){var e=Object(n.a)({area:"WelcomeBadge",logFullQuota:!0});return Object(o.useMemo)((function(){var t=null==e?void 0:e.storageAlertLevel;return!!t&&(t===r.a.Over||t===r.a.Full)}),[null==e?void 0:e.storageAlertLevel])}},ZsNf:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a("QjXU"),r=a("MJsD"),o=a("V9hE"),i=a("/Oio"),c=a("CMIS"),l=a("GMuP"),s=a("Dn7E"),u=a("+k3c"),d=a("gd1C"),m=function(e,t,a){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var r;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(!t.disableDefaultLinkBehavior&&event&&!event.defaultPrevented)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),r=t.action,[4,Object(d.a)(e,{action:r},a)];case 2:return[2,n.sent()];case 3:return n.sent(),[2,{success:!1,message:"launchWebApp:launchUrlException"}];case 4:return[2,{success:!1,message:"launchWebApp:fallThrough"}]}}))}))},p=a("KSsg"),f=a("5HQQ"),v=function(e,t){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var a,v,g,b,h,_,T,y,C,O,k,w,j,E,x,S,N;return Object(n.__generator)(this,(function(A){switch(A.label){case 0:a={success:!1},v="launchApp",A.label=1;case 1:return A.trys.push([1,14,15,16]),[4,Object(r.a)()];case 2:return g=A.sent(),b=e.appName,h=e.url,(_=g.workload==i.a.Hwa&&b)?[4,Object(f.a)(b)]:[3,4];case 3:_=A.sent(),A.label=4;case 4:if(!_)return[3,11];T=e.disableDefaultLinkBehavior,C=!(y=e.event)||y.defaultPrevented||T?void 0:O=void 0,A.label=5;case 5:return A.trys.push([5,7,,8]),[4,Object(u.a)({appName:b,filePath:e.useUrl?h:"",prelaunchCallback:C})];case 6:return O=A.sent(),Object(p.a)({launchInstrumentationParams:t,success:O.success}),O.success&&(a=Object(n.__assign)(Object(n.__assign)({},O),{result:"Native"})),[3,8];case 7:return A.sent(),[3,8];case 8:return(null==O?void 0:O.success)?[3,10]:[4,m(h,e,t)];case 9:a=A.sent(),A.label=10;case 10:return[3,13];case 11:return k=e.targetTab,[4,Object(d.a)(h,{action:"OpenInApp",targetTab:k},t)];case 12:a=A.sent(),A.label=13;case 13:return[3,16];case 14:return w=A.sent(),j=void 0,E=void 0,w instanceof Error?(j=w.stack,E=w.message):"string"==typeof w?E=w:"object"==typeof w&&(E=null==w?void 0:w.toString()),Object(c.a)({debugInfo:j,errorType:"LaunchApp_Error",eventName:v,message:E}),j&&(x={DebugInfo:j,Message:null!=E?E:""},Object(l.a)({eventName:v,params:x}),Object(o.a)(v,x,[])),[3,16];case 15:return x={Success:a.success,Message:null!==(S=a.message)&&void 0!==S?S:"",AppLaunchResult:null!==(N=a.result)&&void 0!==N?N:""},Object(s.a)({eventName:v,featureName:"LauncherService",params:x}),[7];case 16:return[2,a]}}))}))}},am3b:bb9Y:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("QjXU"),r=a("28zg"),o=a("gy05");function i(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){return[2,Object(r.a)(o.a)]}))}))}},chxZ:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("QjXU"),r=a("mXGw");function o(e){var t=Object(n.__read)(Object(r.useState)(),2),a=t[0],o=t[1];return[Object(r.useMemo)((,[a,e]),o]}},elnK:function(e,t,a){"use strict";var n=a("niq1"),r=a("mXGw"),o=a("sYGy").useSyncExternalStoreWithSelector;ar c=function(e){var t="function"==typeof e?n.createStore(e):e,a=return Object.assign(a,t),a},l=function(e){return e?c(e):c};t.create=l,t.default=function(e){return l(e)},t.useStore=i,Object.keys(n).forEach((),e.exports=t&&t.default||{},Object.assign(e.exports,t)},fhoW:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a("6ib3"),r=a("muUJ"),o=a("a3FV"),i=a("Jxb/"),c=a("lpeV"),l=a("jwpY"),s=a("zPk6"),u="me/drive/";function d(e,t,a,d,m,p){var f=e.jwtAuthEnabled,v=e.getAccessToken,g=e.officeHomeApiRoot,b=e.correlationId;if(d===n.a.OneNote){var h="https://graph.microsoft.com/v1.0/".concat("me/onenote/","notebooks"),_={displayName:t},T={headers:{"Content-Type":"application/json"}};return Object(l.a)(o.a.OneDriveGraphCreateFileRequest,"OneDrive_Graph_Create_File",h,JSON.stringify(_),T,null!=f&&f,v,g,b,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(s.a)(e)||""}}).then((function(e){var t=e.data;if(t&&t.links&&t.links.oneNoteWebUrl&&t.links.oneNoteWebUrl.href)return t;throw Object(r.a)("Could not parse drive item from Graph response")}),(function(e){var t,a=((t={}).ResourceId=b,t.Error=e,t);Object(r.a)(o.a.WacDocumentVroomError,a)}))}return h=void 0,h=m&&m.length?"https://graph.microsoft.com/v1.0/".concat(u,"root/children?").concat("select="+m.join(","),",*"):"https://graph.microsoft.com/v1.0/".concat(u,"root/children?select=webDavUrl,").concat(a?"openwith,":"","*"),_={name:t,file:{},"@microsoft.graph.conflictBehavior":"rename"},T={headers:{"Content-Type":"application/json",Prefer:"allow-zerobyte"}},Object(l.a)(o.a.OneDriveGraphCreateFileRequest,"OneDrive_Graph_Create_File",h,JSON.stringify(_),T,null!=f&&f,v,g,b,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(s.a)(e)||""}}).then((function(e){null==p||p.ULS.sendTraceTag(512553950,i.a.msoulscat_Wac_UnifiedUiHost,c.a.Info,"Create new fileType: ".concat(d,", httpStatus: ").concat(e.status,", httpResponse: ").concat(e));var t=e.data;if(t&&t.id&&t.webUrl)return t;throw Object(r.a)("Could not parse drive item from Graph response")}),(function(e){var t;null==p||p.ULS.sendTraceTag(512550538,i.a.msoulscat_Wac_UnifiedUiHost,c.a.Info,"Create new fileType: ".concat(d,", error: ").concat(e));var a=((t={}).ResourceId=b,t.Error=e,t);Object(r.a)(o.a.WacDocumentVroomError,a)}))}},frjS:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("QjXU"),r=a("UDoG"),o=a("gd1C");function i(e,t,a){var i,c;return Object(n.__awaiter)(this,void 0,void 0,(function(){var l,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(o.a)(e,{action:"OpenFile",targetTab:null!=t?t:void 0,linkTarget:t?"_top":a})];case 1:if(!(l=n.sent()).result||"OpenNull"===l.result||"OpenUndefined"===l.result)throw new r.a("Open blocked by pop-up blocker for the newly created file.","OpenBlockedByPopupBlocker");if(!l.success)throw new r.a(null!==(i=l.message)&&void 0!==i?i:"Failed to launch newly created file.","OpenNewDocFailed");return[3,3];case 2:return s=n.sent(),[2,Promise.resolve({type:null!==(c=s.type)&&void 0!==c?c:"OpenNewDocFailed",documentWebUrl:e})];case 3:return[2,Promise.resolve({type:"GoToBlankDoc"})]}}))}))}},gI4v:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));var n="me/drive/",r="me/onenote/notebooks"},gy05:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("QjXU"),r=a("mgFK"),o={key:"Workloads",getServerGeneratedConfig:function(e){return function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(r.a)("workloadsData",e)];case 1:if(!(t=a.sent()))throw new Error("Cannot parse workloadsData");return[2,t]}}))}))}(e)}}},hu41:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a("NZpx"),r=a("NrNW"),o=a("6ib3"),i=a("CU8J"),c=a("CaQ9"),l=a("h8qh"),s=a("mXGw"),u=a("B5kz"),d=a("QjXU"),m=a("mgFK");function p(){var e,t,a,p,f=Object(l.a)().data,v=Object(n.a)().data,g=Object(c.a)().data,b=Object(i.a)().data,h=null==b?void 0:b.result,_=Object(r.a)().data,T=(null==g?void 0:g.isOrgId)||!1,y=(null===(e=null==h?void 0:h.createStreamDocumentGates)||void 0===e?void 0:e.createStreamDocumentEnabled)||!1,C=(null===(t=null==h?void 0:h.createScreenRecordingDocumentGates)||void 0===t?void 0:t.createScreenRecordingDocumentEnabled)||!1,O=(null===(a=null==h?void 0:h.createClipchampAadGates)||void 0===a?void 0:a.createClipchampAadEnabled)&&T||!1,k=(null===(p=null==h?void 0:h.templatesCollectionsV2Gates)||void 0===p?void 0:p.templatesCollectionsV2Enabled)&&!T,w=function(e){return function(e){return Object(u.c)(["OneNoteConfig"],(function(){return function(e){return Object(d.__awaiter)(this,void 0,void 0,(function(){return Object(d.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(m.a)("oneNoteConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}),{staleTime:1/0,cacheTime:1/0,enabled:!!e})}(e).data}(_);return Object(s.useMemo)((function(){var e=new Map;return f&&v&&(e.set(o.a.Word,{title:f.linkCandidateResources.createMenuLinkWordTitle,fileTypeName:f.linkCandidateResources.createModalLinkWordTitle,appName:f.linkCandidateResources.wordName,fileType:o.a.Word,newDocName:f.linkCandidateResources.newWordDocumentFileName,fileExtension:"docx",workloadOnlineName:f.linkCandidateResources.wordName,canCreateBlankDocument:v.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!v.startPageApps.has(o.a.Word),createDocAspxEnabled:v.createDocAspxWordEnabled,docAspxId:1}),e.set(o.a.Excel,{title:f.linkCandidateResources.createMenuLinkExcelTitle,fileTypeName:f.linkCandidateResources.createModalLinkExcelTitle,appName:f.linkCandidateResources.excelName,fileType:o.a.Excel,newDocName:f.linkCandidateResources.newExcelWorkbookFileName,fileExtension:"xlsx",workloadOnlineName:f.linkCandidateResources.excelName,canCreateBlankDocument:v.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!v.startPageApps.has(o.a.Excel),createDocAspxEnabled:v.createDocAspxExcelEnabled,docAspxId:2}),e.set(o.a.PowerPoint,{title:f.linkCandidateResources.createMenuLinkPowerPointTitle,fileTypeName:f.linkCandidateResources.createModalLinkPowerPointTitle,appName:f.linkCandidateResources.powerpointName,fileType:o.a.PowerPoint,newDocName:f.linkCandidateResources.newPowerPointPresentationFileName,fileExtension:"pptx",workloadOnlineName:f.linkCandidateResources.powerpointName,canCreateBlankDocument:v.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!v.startPageApps.has(o.a.PowerPoint),createDocAspxEnabled:v.createDocAspxPowerPointEnabled,docAspxId:3}),e.set(o.a.Sway,{title:f.linkCandidateResources.createMenuLinkSwayTitle,fileTypeName:f.linkCandidateResources.createModalLinkSwayTitle,appName:f.linkCandidateResources.swayName,fileType:o.a.Sway,workloadOnlineName:f.linkCandidateResources.microsoftSwayName,canCreateBlankDocument:v.swayCreateNewEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!v.startPageApps.has(o.a.Sway),createDocAspxEnabled:!1}),v.fluidCreateNewEnabled&&e.set(o.a.Fluid,{title:f.linkCandidateResources.createMenuLinkFluidTitle,fileTypeName:f.linkCandidateResources.createModalLinkFluidTitle,appName:f.linkCandidateResources.fluidName,fileType:o.a.Fluid,canCreateBlankDocument:v.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),v.fluidCreateAbpEnabled&&e.set(o.a.FluidActivityBlueprint,{title:f.linkCandidateResources.createMenuLinkFluidAbpTitle,fileTypeName:f.linkCandidateResources.createModalLinkFluidAbpTitle,appName:f.linkCandidateResources.fluidName,fileType:o.a.FluidActivityBlueprint,canCreateBlankDocument:v.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),v.startPageApps.has(o.a.Forms)&&(e.set(o.a.Forms,{appName:f.linkCandidateResources.formsName,title:f.linkCandidateResources.createMenuLinkFormsTitle,fileTypeName:f.linkCandidateResources.createModalLinkFormsFormTitle,workloadOnlineName:f.linkCandidateResources.formsName,fileType:o.a.Forms,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,newDocName:f.linkCandidateResources.newFormsSurveyFileName}),e.set(o.a.FormsQuiz,{appName:f.linkCandidateResources.formsName,title:f.linkCandidateResources.createMenuLinkFormsQuizTitle,fileTypeName:f.linkCandidateResources.createModalLinkFormsQuizTitle,workloadOnlineName:f.linkCandidateResources.formsName,fileType:o.a.FormsQuiz,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,newDocName:f.linkCandidateResources.newFormsQuizFileName})),v.startPageApps.has(o.a.OneNote)&&(null==w?void 0:w.enableOneNoteApis)&&e.set(o.a.OneNote,{title:f.linkCandidateResources.createMenuLinkOneNoteTitle,fileTypeName:f.linkCandidateResources.createModalLinkOneNoteTitle,appName:f.linkCandidateResources.onenoteName,fileType:o.a.OneNote,workloadOnlineName:f.linkCandidateResources.onenoteName,canCreateBlankDocument:v.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),v.startPageApps.has(o.a.Visio)?e.set(o.a.Visio,{title:f.linkCandidateResources.createMenuLinkVisioTitle,fileTypeName:f.linkCandidateResources.createModalLinkVisioTitle,appName:f.linkCandidateResources.visioName,fileType:o.a.Visio,newDocName:f.linkCandidateResources.newVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:f.linkCandidateResources.visioName,canCreateBlankDocument:v.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!1,createDocAspxEnabled:v.createDocAspxVisioEnabled,docAspxId:8}):v.createVisioEnabled&&e.set(o.a.Visio,{title:f.linkCandidateResources.createMenuLinkVisioTitle,fileTypeName:f.linkCandidateResources.createModalLinkVisioTitle,appName:f.linkCandidateResources.visioName,fileType:o.a.Visio,newDocName:f.linkCandidateResources.newVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:f.linkCandidateResources.visioName,canCreateBlankDocument:v.createOneDriveDocApiEnabled&&v.createDocAspxVisioEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:v.createDocAspxVisioEnabled,docAspxId:8}),y&&v.startPageApps.has(o.a.Stream)&&(e.set(o.a.Stream,{title:f.linkCandidateResources.createMenuLinkStreamTitle,fileTypeName:f.linkCandidateResources.createModalLinkStreamTitle,appName:f.linkCandidateResources.streamName,fileType:o.a.Stream,fileExtension:"webm",workloadOnlineName:f.linkCandidateResources.streamName,canCreateBlankDocument:v.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),C&&e.set(o.a.ScreenRecording,{title:f.linkCandidateResources.createMenuLinkScreenRecordingTitle,fileTypeName:f.linkCandidateResources.createModalLinkScreenRecordingTitle,appName:f.linkCandidateResources.streamName,fileType:o.a.ScreenRecording,fileExtension:"webm",workloadOnlineName:f.linkCandidateResources.streamName,canCreateBlankDocument:v.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1})),O&&e.set(o.a.Clipchamp,{title:f.linkCandidateResources.createMenuLinkClipchampTitle,fileTypeName:f.linkCandidateResources.createModalLinkClipchampTitle,appName:f.linkCandidateResources.clipchampName,fileType:o.a.Clipchamp,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),k&&(e.set(o.a.Designer,{title:f.linkCandidateResources.designerName,fileTypeName:f.linkCandidateResources.designerName,appName:f.linkCandidateResources.designerName,createDocAspxEnabled:!1,fileType:o.a.Designer,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0}),e.set(o.a.Clipchamp,{title:f.linkCandidateResources.clipchampName,fileTypeName:f.linkCandidateResources.clipchampName,appName:f.linkCandidateResources.clipchampName,createDocAspxEnabled:!1,fileType:o.a.Clipchamp,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0}))),e}),[f,v,null==w?void 0:w.enableOneNoteApis,y,O,k,C])}},huqQ:function(e,t,a){"use strict";e.exports=a("y8H0")},"i+uS":function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return l}));var n=a("QjXU"),r=a("nLxx"),o=a("5eS3"),i=a("z+rT");function c(e,t,a){return t&&t.loginHint&&a&&a.outgoingLoginHintEnabled&&Object(o.a)(e,"login_hint=".concat(t.loginHint)),e}function l(e,t,a,l,s,u,d,m){return Object(n.__awaiter)(this,void 0,void 0,(function(){var p,f,v,g;return Object(n.__generator)(this,(function(n){return p={},e.webDavUrl&&(p.canonicalUrl=c(e.webDavUrl,a,d)),f=c(e.webUrl,a,d),v="action=editnew",-1===(f=f.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew")).lastIndexOf(v)&&(f=Object(o.a)(f,v)),s&&(f=Object(o.a)(f,"wdTpl=".concat(s))),(s||u&&u.createLcidEnabled)&&(f=Object(o.a)(f,"wdlcid=".concat(l.officeMarketLcid))),d&&d.scenarioId&&(f=Object(o.a)(f,"wdscenarioid=".concat(d.scenarioId))),g=Object(r.a)(a.workload,a.router.getCurrentRoute(),!1,!!s),f=Object(o.a)(f,"wdNewAndOpenCt=".concat(t,"&ct=").concat(t,"&wdOrigin=").concat(g)),m&&(f=Object(i.a)(f,m)),p.webUrl=f,[2,p]}))}))}},"i3m/":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var n="drive/",r=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl"]},i7LN:function(e,t){var a=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,r=/^\s*/,o=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,i=/^:\s*/,c=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,s=/^\s+|\s+$/g,u="";.exports=function(e,t){if("string"!=typeof e)throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var s=1,m=1;rototype.content=e;var g=[]; _(),)}},ijiB:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("mXGw");function r(){var e=Object(n.useRef)(0);return Object(n.useCallback)((function(t){var a=e.current;return t&&(t>0?e.current++:e.current--),a}),[])}},jwpY:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("QjXU"),r=a("kb6k"),o=a("lAHu");function i(e,t,a,i,c,l,s,u,d,m,p,f,v){void 0===p&&(p={});var g="cache-only"===f;g&&(m="None");var b=Object(n.__assign)(Object(n.__assign)({},c),{url:a,method:"POST",body:i});return Object(r.a)((function(a){return Object(o.a)(e,t,a,u,d,f,p.populateRequestEvent,p.onUploadProgress,p.onDownloadProgress,p.cancellationToken,p.timeoutInMs)}),e,t,b,l,s,m,p.mockParam,p.resourceUrl,p.rpsHeaderPrefix,p.additionalAuthErrors,p.isRetriableError,p.updateRequestWithAuth,g,void 0,void 0,v)}},kbrL:kwav:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("6ib3"),r=new Map([["ShellWordOnline",n.a.Word],["ShellExcelOnline",n.a.Excel],["ShellPowerPointOnline",n.a.PowerPoint],["ShellOneNoteOnline",n.a.OneNote],["ShellClassNotebook",n.a.OneNoteClassNoteBook],["ShellVisioOnline",n.a.Visio],["ShellSway",n.a.Sway],["ShellOfficeForms",n.a.Forms],["ShellDocuments",n.a.OneDrive],["ShellSites",n.a.SharePoint],["ShellMicrosoftStream",n.a.Stream],["ShellLists",n.a.List],["ShellWhiteboard",n.a.Whiteboard],["ShellProject",n.a.Project],["ShellClipchamp",n.a.Clipchamp]]);function o(e){return r.get(e)}},"l+H3":function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a("faO/"),r=a("RV7E"),o=a("a3FV"),i=a("lUkk"),c=a("mXGw"),l=a("ZrMS"),s=a("CU8J"),u=a("3+RV"),d=a("B7gc"),m=function(){var e=function(){var e=Object(l.a)(),t=function(){var e=Object(s.a)().data;return Object(c.useMemo)((function(){var t,a;return(null===(a=null===(t=null==e?void 0:e.result)||void 0===t?void 0:t.storageErrorGates)||void 0===a?void 0:a.storageErrorDialogEnabled)||!1}),[e])}();return Object(c.useMemo)((,[e,t])}(),t=Object(u.a)(),a=Object(d.a)(n.a.WelcomeBadge),m=Object(c.useMemo)((,[]),p=Object(c.useMemo)((,[]),f=Object(c.useMemo)((function(){var e=Object.assign({},m);return a&&a.showDime&&a.onClick&&(e=Object.assign(e,{onActionClicked:)),t&&t.link&&(e=Object.assign(e,{fallbackSiteUrl:t.link})),e}),[m,t,a]),v=Object(c.useCallback)((function(e){var a=e.workloadId,n=e.area,c=e.subArea,l=e.isTemplate;t&&t.link&&a&&(Object(i.a)({eventName:l?o.a.TemplateClick:o.a.CreateLinkClick,id:a,area:n,subArea:c,result:"Navigate",target:"Other"}),Object(i.a)({eventName:o.a.ShowStorageErrorDialog,id:a,area:n,subArea:c,result:"Block",target:"Other"}),Object(r.c)(f))}),[f,t]),g=Object(c.useCallback)((function(t){return!!t&&e&&p.indexOf(t)>=0}),[e,p]);return Object(c.useMemo)((,[g,v])}},lbnC:function(e,t,a){"use strict";function n(e){var t=e.minor,a=e.build;return"".concat(e.major,"_").concat(t,"_").concat(a)}a.d(t,"a",(function(){return n}))},lpeV:m7fW:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("B5kz"),r=a("Qcgp");function o(e,t){var a=Object(r.a)(e,t),o=["EnterpriseTemplatesLibrariesData",e,t];return Object(n.c)(o,(function(){var e;return null===(e=null==a?void 0:a.getEnterpriseTemplateLibraries)||void 0===e?void 0:e.call(a,(function(e){return n.a.setQueryData(o,e)}))}),{staleTime:1/0,cacheTime:1/0,enabled:a&&(null==a?void 0:a.getEnterpriseTemplateLibraries)})}},"m9+Q":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return _t}));var n,r=a("QjXU"),o=a("CXgZ"),i=a("NrNW"),c=a("ynVX"),l=a("hu41"),s=a("SnJU"),u=a("6ib3"),d=a("RV7E"),m=a("Ohvh"),p=a("CaQ9");!function(e){e.categoryId="categoryId",e.driveId="driveId"}(n||(n={}));var f=a("XNH3"),v=a("1aUa"),g=a("ijiB"),b=a("ZcZ3"),h=a("a3FV"),_=a("lUkk"),T=a("Dn7E"),y=a("rTyw"),C=a("mXGw"),O=a.n(C),k=a("ERcm"),w=a("qecA"),j=a("Coo+"),E=a("DM/p"),x=function(e){e.TemplateCollections||(e.TemplateCollections={});var t=e.TemplateCollections.Enterprise;return t||(e.TemplateCollections.Enterprise=t={Id:"Enterprise",Name:"",TemplateCategories:[]}),t},S=a("rjBA"),N=a("s32E"),A=function(e){return e.id||"".concat(e.DriveId,":").concat(e.ItemId)},I=a("ULNy"),P=a("SxNr"),D=function(e,t){t&&-1===t.indexOf(e)&&t.push(e)},M=function(e,t,a,n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i,c,l,s,d;return Object(r.__generator)(this,(function(m){switch(m.label){case 0:return o={Id:A(e),Name:e.Title,SamplesAssetID:[],TemplateCategories:[]},(i=function(e,t){return"collection"===e.type&&t.TemplateCollections?t.TemplateCollections[e.id]:"category"===e.type&&t.TemplateCategories?t.TemplateCategories[e.id]:void 0}(t,a))&&D(o.Id,i.TemplateCategories),D(o.Id,x(a).TemplateCategories),void 0!==a.TemplateCategories?a.TemplateCategories[o.Id]=o:console.error("TemplateCategories is undefined"),c={vroomApiOptions:n,driveId:e.DriveId,itemId:e.ItemId,largeThumbnails:!0},[4,Object(N.a)(c.vroomApiOptions,c.driveId,c.itemId)];case 1:return l=m.sent(),s=Object(I.a)(c,l,!1),d=[],s.Template.forEach((function(t){var n=Object(P.a)(t);n===u.a.None||n===u.a.Unknown?d.push({DriveId:e.DriveId,ItemId:t.AssetId,Title:t.Title,id:t.AssetId}):(D(t.AssetId,o.SamplesAssetID),a.TemplatesData[t.AssetId]=Object(r.__assign)(Object(r.__assign)({},t),{Title:Object(S.a)(t.Title)}))})),d.length>0?[4,Promise.all(d.map((function(e){return M(e,{type:"category",id:o.Id},a,n)})))]:[3,3];case 2:m.sent(),m.label=3;case 3:return[2]}}))}))},L=a("m7fW"),R=a("B5kz"),F=a("Qcgp"),B=function(e,t,a){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(E.a)()];case 1:return n=r.sent(),(o=x(t)).Name=a,[4,Promise.all(e.map((function(e){return M(e,{type:"collection",id:"Enterprise"},t,n)})))];case 2:return r.sent(),o.TemplateCategories=o.TemplateCategories.filter((function(e){var a;return!!t.TemplateCategories&&(null===(a=t.TemplateCategories[e])||void 0===a?void 0:a.SamplesAssetID.length)>0})),[2]}}))}))},U=a("h8qh");function W(e){var t=Object(U.a)().data;return Object(C.useMemo)((function(){var a=new Map;return a.set(e,function(e,t){var a,n,r,o,i,c,l,s,u,d,m,p,f,v,g,b,h,_,T,y,C,O,k,w,j,E,x,S,N,A,I,P,D,M,L,R,F,B,U,W,z,V,G,Q,X,q,Y;if(e&&t)return{blankTemplateText:null!==(a=H("blankTemplateText",e,t))&&void 0!==a?a:"",blankTemplateAriaLabel:null!==(n=H("blankTemplateAriaLabel",e,t))&&void 0!==n?n:"",navigationSectionTitle:null!==(r=H("navigationSectionTitle",e,t))&&void 0!==r?r:"",featuredTemplatesSectionTitle:null!==(o=H("featuredTemplatesSectionTitle",e,t))&&void 0!==o?o:"",moreTemplatesLinkText:null!==(i=H("moreTemplatesLinkText",e,t))&&void 0!==i?i:"",moreTemplatesLinkAriaLabel:null!==(c=H("moreTemplatesLinkAriaLabel",e,t))&&void 0!==c?c:"",backButtonText:null!==(l=H("backButtonText",e,t))&&void 0!==l?l:"",homeButtonText:null!==(s=H("homeButtonText",e,t))&&void 0!==s?s:"",blankTemplateCardButtonText:null!==(u=H("blankTemplateCardButtonText",e,t))&&void 0!==u?u:"",templateCardButtonText:null!==(d=H("templateCardButtonText",e,t))&&void 0!==d?d:"",templateCardExploreButtonText:null!==(m=H("templateCardExploreButtonText",e,t))&&void 0!==m?m:"",templateCardPreviewButtonText:null!==(p=H("templateCardPreviewButtonText",e,t))&&void 0!==p?p:"",templateNavigationCategoryAriaLabel:null!==(f=H("templateNavigationCategoryAriaLabel",e,t))&&void 0!==f?f:"",templateNavigationSubCategoryAriaLabel:null!==(v=H("templateNavigationSubCategoryAriaLabel",e,t))&&void 0!==v?v:"",premiumTemplateCardHoverTitle:null!==(g=H("premiumTemplateCardHoverTitle",e,t))&&void 0!==g?g:"",premiumTemplateCardHoverUpgradeTitle:null!==(b=H("premiumTemplateCardHoverUpgradeTitle",e,t))&&void 0!==b?b:"",exploreButtonAriaLabel:null!==(h=H("exploreButtonAriaLabel",e,t))&&void 0!==h?h:"",previewButtonAriaLabel:null!==(_=H("previewButtonAriaLabel",e,t))&&void 0!==_?_:"",previewCardCreateButtonAriaLabel:null!==(T=H("previewCardCreateButtonAriaLabel",e,t))&&void 0!==T?T:"",previewCardNextButtonAriaLabel:null!==(y=H("previewCardNextButtonAriaLabel",e,t))&&void 0!==y?y:"",previewCardPrevButtonAriaLabel:null!==(C=H("previewCardPrevButtonAriaLabel",e,t))&&void 0!==C?C:"",previewCardCloseButtonAriaLabel:null!==(O=H("previewCardCloseButtonAriaLabel",e,t))&&void 0!==O?O:"",previewCardPrevButtonTitle:null!==(k=H("previewCardPrevButtonTitle",e,t))&&void 0!==k?k:"",previewCardCloseButtonTitle:null!==(w=H("previewCardCloseButtonTitle",e,t))&&void 0!==w?w:"",previewCardCreateButtonTitle:null!==(j=H("previewCardCreateButtonTitle",e,t))&&void 0!==j?j:"",previewCardNextButtonTitle:null!==(E=H("previewCardNextButtonTitle",e,t))&&void 0!==E?E:"",generalTemplatesCollectionTitle:null!==(x=H("generalTemplatesCollectionTitle",e,t))&&void 0!==x?x:"",orgChartTemplatesCollectionTitle:null!==(S=H("orgChartTemplatesCollectionTitle",e,t))&&void 0!==S?S:"",infographicsTemplatesCollectionTitle:null!==(N=H("infographicsTemplatesCollectionTitle",e,t))&&void 0!==N?N:"",flowchartTemplatesCollectionTitle:null!==(A=H("flowchartTemplatesCollectionTitle",e,t))&&void 0!==A?A:"",softwareAndDBTemplatesCollectionTitle:null!==(I=H("softwareAndDBTemplatesCollectionTitle",e,t))&&void 0!==I?I:"",networkTemplatesCollectionTitle:null!==(P=H("networkTemplatesCollectionTitle",e,t))&&void 0!==P?P:"",showLessButtonText:null!==(D=H("showLessButtonText",e,t))&&void 0!==D?D:"",templatesSearchResultsTitle:null!==(M=H("templatesSearchResultsTitle",e,t))&&void 0!==M?M:"",templateSearchResultsTitleAriaLabel:null!==(L=H("templateSearchResultsTitleAriaLabel",e,t))&&void 0!==L?L:"",templatesSearchTemplatesSectionTitle:null!==(R=H("templatesSearchTemplatesSectionTitle",e,t))&&void 0!==R?R:"",templatesSearchDiagramsSectionTitle:null!==(F=H("templatesSearchDiagramsSectionTitle",e,t))&&void 0!==F?F:"",templatesSearchMessageText:null!==(B=H("templatesSearchMessageText",e,t))&&void 0!==B?B:"",templatesSearchMessageHyperlinkText:null!==(U=H("templatesSearchMessageHyperlinkText",e,t))&&void 0!==U?U:"",templatesSearchBoxPlaceholderText:null!==(W=H("templatesSearchBoxPlaceholderText",e,t))&&void 0!==W?W:"",templatesSearchBoxAriaLabelText:null!==(z=H("templatesSearchBoxAriaLabelText",e,t))&&void 0!==z?z:"",templatesSearchNoResultsTitle:null!==(V=H("templatesSearchNoResultsTitle",e,t))&&void 0!==V?V:"",templatesSearchClearButtonTitle:null!==(G=H("templatesSearchClearButtonTitle",e,t))&&void 0!==G?G:"",templatesBackButtonAriaLabel:null!==(Q=H("templatesBackButtonAriaLabel",e,t))&&void 0!==Q?Q:"",pivotsControlDropdownButtonText:null!==(X=H("pivotsControlDropdownButtonText",e,t))&&void 0!==X?X:"",pivotsControlDropdownButtonTextAriaLabel:null!==(q=H("pivotsControlDropdownButtonTextAriaLabel",e,t))&&void 0!==q?q:"",templatesTagsHeading:null!==(Y=H("templatesTagsHeading",e,t))&&void 0!==Y?Y:""}}(null==t?void 0:t.templatePageResources,e)),a}),[e,null==t?void 0:t.templatePageResources]).get(e)}function H(e,t,a){if(t&&a)return t["".concat(e).concat(a)]}var z=a("AGMK"),V=a("iPRk");function G(e){var t=e.dataResult,a=e.canRender,n=e.paintMarker,r=Object(C.useRef)(!1),o=Object(C.useRef)(!1);Object(C.useEffect)((function(){!o.current&&t&&(null==t?void 0:t.result.TemplatesData)&&(Object(V.a)((null==t?void 0:t.fromPersistence)?"Cached_TemplatesPage_Ready":"TemplatesPage_Ready"),o.current=!0)}),[t]),Object(C.useEffect)((function(){a&&(r.current||(Object(z.a)()&&Object(V.a)(n),r.current=!0))}),[a,n])}var Q,X=a("DLWS"),q=a("EtQw"),Y=a("c0sU"),Z=a("4Unn"),K=a("AcOL"),J=a("5DIn"),$=a("qyk8"),ee=a("8Jek"),te=a.n(ee),ae=function(e){var t=e.accordionCategories,a=e.selectedCategoryKey,n=e.selectedSubCategoryKey,o=e.onCategoryClick,i=e.onSubCategoryClick,c=e.locStrings,l=e.accordionHeaderText,s=Object(r.__read)(Object(C.useState)(a),2),u=s[0],d=s[1],m=Object(r.__read)(Object(C.useState)(""!=a),2),p=m[0],f=m[1];return Object(C.useEffect)((function(){d(a)}),[a]),O.a.createElement("div",{className:"AccordionControl-module__accordionControl__3KRPS"},O.a.createElement("div",{className:l?"AccordionControl-module__accordionControlHeadingText__1a70t":""},l),O.a.createElement(X.a,{collapsible:!0,openItems:u},!!t.length&&t.map((function(e){var t=!!e.subCategories.length;return O.a.createElement(q.a,{key:e.key,value:e.key,className:"AccordionControl-module__accordion-category-item__1LkFF","data-iscategoryselected":e.key==u},O.a.createElement(Y.a,{expandIconPosition:"start",size:"small","aria-label":Object($.a)(c.accordionCategory,e.name),className:e.key==a?te()("AccordionControl-module__accordion-selected-category-name__WYrHP"):te()("AccordionControl-module__accordion-category-name__QrxDB"),onClick:function(){return function(e){null==o||o(e),u==e&&p?(d(""),f(!1)):(d(e),f(!0))}(e.key)}},e.name),t&&e.subCategories.map((function(e){return O.a.createElement(Z.a,{key:e.key,className:e.key==n?te()("AccordionControl-module__accordion-selected-subcategory__371AV"):te()("AccordionControl-module__accordion-subcategory__8sz6M"),tabIndex:0,"aria-selected":e.key==n,"aria-label":Object($.a)(c.accordionSubCategory,e.name),role:"option",onClick:onKeyDown:function(t){return function(e,t){switch(Object(K.a)(e)){case J.a.Enter:case J.a.Space:i(t)}}(t,e.key)}},e.name)})))}))))},ne=a("xvrq"),re=a("CO6F"),oe=a("jmya"),ie=a("WvBw"),ce=a("qA3t"),le=a("DU/N"),se=a("paN7"),ue=a("p/uK"),de=a("sLnE"),me=Object(ue.a)({templatePageSearch:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({WebkitTransition:"width 0.1s ease-in-out"},de.a.transition("width","0.1s","ease-in-out")),{MozTransition:"width 0.1s ease-in-out"}),de.a.border("1px","solid",le.a.colorNeutralStroke1Hover)),{"&:focus":Object(r.__assign)({},de.a.border("1px","solid",le.a.colorNeutralStroke1Hover))}),de.a.borderRadius("4px")),de.a.flex("none")),{order:"1",flexGrow:"0"}),searchbox:Object(r.__assign)({":after":Object(r.__assign)({},de.a.border("1px","solid",le.a.colorTransparentBackground))},de.a.padding("4px","2px","4px","9px")),iconStyles:{display:"none"},callout:{marginTop:"5px",marginLeft:"-9px",boxShadow:"none"},calloutListElementsContainer:Object(r.__assign)(Object(r.__assign)({lineHeight:"34px",fontFamily:"Segoe UI,Segoe UI Web, Segoe UI Symbol, Helvetica Neue, BBAlpha Sans, S60 Sans, Arial, sans-serif",fontSize:"16px",cursor:"pointer"},de.a.border("1px","solid",le.a.colorNeutralStroke1Hover)),{boxSizing:"border-box",backgroundColor:le.a.colorStrokeFocus1}),calloutListElements:Object(r.__assign)(Object(r.__assign)({whiteSpace:"nowrap"},de.a.overflow("hidden")),{textOverflow:"ellipsis",paddingLeft:"15px",color:le.a.colorNeutralForeground1,"&:hover":{backgroundColor:le.a.colorPaletteBlueBackground2,color:le.a.colorStrokeFocus2},"&:focus":{backgroundColor:le.a.colorPaletteBlueBackground2,color:le.a.colorStrokeFocus2}})}),pe=a("F/x0"),fe=a.n(pe),ve=a("q+lz"),ge=function(e){var t=e.onSearch,a=e.searchboxInitialWidth,n=e.searchboxExtendedWidth,o=e.handleSearchSuggestions,i=e.displaySearchIcon,c=e.suggestionsList,l=e.calloutGapSpace,s=e.templateSearchControlResources,u=e.searchQueryTerm,d=Object(ce.b)("searchboxId"),m=/(<([^>]+)>)/gi,p=Object(C.useRef)(null),f=Object(C.useRef)(null),v=Object(r.__read)(Object(C.useState)(u),2),g=v[0],b=v[1],h=g.length?n:a,_=Object(r.__read)(Object(C.useState)(Array()),2),T=_[0],y=_[1];Object(C.useEffect)((function(){var e;null===(e=p.current)||void 0===e||e.focus(),Object(re.a)()}),[]);var k=Object(r.__read)(Object(C.useState)(!1),2),w=k[0],j=k[1],E=me(),x=Object(se.a)(),S={root:{border:"1px, solid, ".concat(le.a.colorTransparentStroke),color:le.a.colorNeutralForeground2,backgroundColor:le.a.colorStrokeFocus1},iconContainer:{display:i?"block":"none"},field:{color:le.a.colorNeutralForeground1}},N={title:s.clearButtonTitle};return Object(C.useEffect)((function(){b(u)}),[u]),Object(C.useEffect)((function(){var e;o(g),y(c),j(!!((null===(e=p.current)||void 0===e?void 0:e.hasFocus())&&g.length&&c.length))}),[o,g,c]),O.a.createElement("div",{style:{width:"".concat(h)},className:E.templatePageSearch},O.a.createElement(oe.a,{id:d,className:te()(E.searchbox,x),ariaLabel:s.searchboxAriaLabel,role:"search",placeholder:s.placeholder,onChange:function(e){return function(e){e&&b(e.target.value||"")}(e)},onClear:function(){return b("")},onSearch:componentRef:p,value:g,title:s.placeholder,styles:S,onKeyDown:function(e){var t;Object(K.a)(e)==J.a.ArrowDown&&1==w&&(null===(t=f.current)||void 0===t||t.focus())},clearButtonProps:N}),w&&O.a.createElement(ie.a,{style:{width:"".concat(n)},alignTargetEdge:!0,shouldDismissOnWindowFocus:!0,className:te()(E.callout,x),gapSpace:l,target:"#".concat(d),isBeakVisible:!1,onKeyDown:function(e){var t,a,n=Object(K.a)(e);if(n==J.a.ArrowDown&&1==w){var r=null===(t=document.activeElement)||void 0===t?void 0:t.nextElementSibling;if(r){var o=document.getElementById(r.id);null==o||o.focus()}}if(n==J.a.ArrowUp&&1==w){var i=null===(a=document.activeElement)||void 0===a?void 0:a.previousElementSibling;if(i){var c=document.getElementById(i.id);null==c||c.focus()}}},onDismiss:,O.a.createElement("ul",{className:E.calloutListElementsContainer},T.length&&T.map((function(e,a){return O.a.createElement("div",{id:a.toString(),key:e,tabIndex:0,role:"button",title:e.replace(m,""),onKeyDown:function(a){return function(e,a){switch(Object(K.a)(e)){case J.a.Enter:b(a.replace(m,"")),j(!1),t(a.replace(m,""));break;case J.a.Escape:j(!1)}}(a,e)},className:E.calloutListElements,onClick:function(){return function(e){var a=e.replace(m,"");b(a),j(!1),t(a)}(e)},ref:0==a?f:void 0},function(e){return e?Object(ve.a)(fe.a.sanitize(e)):void 0}(e))})))))};!Q||(Q={}));var be=a("8wW2"),he=a("mJgL"),_e=a("5ANk"),Te=a("PoVA"),ye=a("Wa5Y"),Ce="v/searchServiceHandler.ashx";function Oe(e){if(e.app==u.a.Visio)return function(e){var t,a,n,o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,c,l,s,u,d,m,p,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(E.a)()];case 1:return i=r.sent(),[4,Object(Te.a)(i)];case 2:return c=r.sent(),l="200",[4,Object(he.a)()];case 3:return s=r.sent(),(null===(a=null===(t=null==s?void 0:s.result)||void 0===t?void 0:t.visioTemplatesConfig)||void 0===a?void 0:a.tagsTopArgValue)&&(l=null===(o=null===(n=null==s?void 0:s.result)||void 0===n?void 0:n.visioTemplatesConfig)||void 0===o?void 0:o.tagsTopArgValue),u=function(e,t,a){var n;return void 0===a&&(a=""),n=(null==e?void 0:e.searchMode)==Q.Suggestions?function(e){var t,a,n;return"suggesterName=sg-template-suggestions-index&highlightPreTag=<b>&highlightPostTag=</b>&searchFields=Suggestion_"+(null===(t=e.sharedContext)||void 0===t?void 0:t.officeMarketLcid)+"&$select=AssetIds_"+(null===(a=e.sharedContext)||void 0===a?void 0:a.officeMarketLcid)+"&search="+encodeURIComponent(e.queryTerm)+"&$top=7&lcid="+(null===(n=null==e?void 0:e.sharedContext)||void 0===n?void 0:n.officeMarketLcid)+"&cID="+e.correlationId}(e):(null==e?void 0:e.searchMode)==Q.Search?function(e){for(var t,a,n,r,o,i,c=["Title_"+(null===(t=null==e?void 0:e.sharedContext)||void 0===t?void 0:t.officeMarketLcid),"Description_"+(null===(a=null==e?void 0:e.sharedContext)||void 0===a?void 0:a.officeMarketLcid),"Keywords_"+(null===(n=null==e?void 0:e.sharedContext)||void 0===n?void 0:n.officeMarketLcid),"Categories_"+(null===(r=null==e?void 0:e.sharedContext)||void 0===r?void 0:r.officeMarketLcid),"ProviderName_"+(null===(o=null==e?void 0:e.sharedContext)||void 0===o?void 0:o.officeMarketLcid)],l="queryType=full&searchMode=all&searchFields=",s=0;s<c.length-1;s++)l+=c[s]+",";return e&&(l+=c[c.length-1]+"&$select=AssetId&search="+encodeURIComponent(e.queryTerm.trimRight())+" OR "+encodeURIComponent(e.queryTerm.trimRight())+"*&lcid="+(null===(i=null==e?void 0:e.sharedContext)||void 0===i?void 0:i.officeMarketLcid)+"&cID"+e.correlationId),l}(e):function(e,t){var a,n,r="queryType=full&searchMode=all&searchFields=Keywords_"+(null===(a=null==e?void 0:e.sharedContext)||void 0===a?void 0:a.officeMarketLcid)+"&$top="+t+"&";return e&&(r+="$select=AssetId&search="+e.queryTerm+"&lcid="+(null===(n=null==e?void 0:e.sharedContext)||void 0===n?void 0:n.officeMarketLcid)+"&cID"+e.correlationId),r}(e,t),a&&a.trim()?"".concat(Object($.a)("https://{0}-visio.officeapps.live.com",a),"/").concat(Ce,"?").concat(n):"".concat("https://visio.officeapps.live.com","/").concat(Ce,"?").concat(n)}(e,l,c),d=function(e,t){var a,n={};return t&&((a={})["client-request-id"]=e,a.RequestType=t,n=a),{headers:n}},m=null==e?void 0:e.searchMode),p=Object(_e.a)(),f=d(p,null==e?void 0:e.searchMode),[2,Object(ye.a)(h.a.VisioSearchRequest,m,u,f,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"VisioService",{cancellationToken:e.cancellationToken}).then((function(e){return e.data?Promise.resolve(e.data):Promise.reject({clientError:"Invalid response"})})).catch((function(e){return Object(be.a)().handleError(e,void 0),Promise.reject({clientError:"Invalid response"})}))]}}))}))}(e)}var ke={hoverComponent:"TemplatePageStageComponent-module__hoverComponent__1CVaz",pageScrollMaxHeight:"TemplatePageStageComponent-module__pageScrollMaxHeight__1Q9Fa",accordionScrollMaxHeight:"TemplatePageStageComponent-module__accordionScrollMaxHeight__3oExT",parentDivStyle:"TemplatePageStageComponent-module__parentDivStyle__1T0Fp",tagsListParentDiv:"TemplatePageStageComponent-module__tagsListParentDiv__3M-Ge",tagsHeaderPadding:"TemplatePageStageComponent-module__tagsHeaderPadding__bgvnk",backButtonFocus:"TemplatePageStageComponent-module__backButtonFocus__oc71C",searchMessage:"TemplatePageStageComponent-module__searchMessage__2fqG0",searchMessageImage:"TemplatePageStageComponent-module__searchMessageImage__Eu42G",searchFeedbackLink:"TemplatePageStageComponent-module__searchFeedbackLink__1Vf50",searchMessageText_Line1:"TemplatePageStageComponent-module__searchMessageText_Line1__3L18t",searchMessageText_Line2:"TemplatePageStageComponent-module__searchMessageText_Line2__1nzgN",navigationParentDiv:"TemplatePageStageComponent-module__navigationParentDiv__15Ax1",searchParentDiv:"TemplatePageStageComponent-module__searchParentDiv__2PfLg",searchTitleDiv:"TemplatePageStageComponent-module__searchTitleDiv__Log6u",searchResultText:"TemplatePageStageComponent-module__searchResultText__1hvXO",categoriesTitleDiv:"TemplatePageStageComponent-module__categoriesTitleDiv__2u0D-",diagramsTitleDiv:"TemplatePageStageComponent-module__diagramsTitleDiv__2blJi",isFlexComponent:"TemplatePageStageComponent-module__isFlexComponent__1WRXN",searchPageTextStyle:"TemplatePageStageComponent-module__searchPageTextStyle__13SeK",accordionControlHeader:"TemplatePageStageComponent-module__accordionControlHeader__1TQmd",accordionControlHeadingText:"TemplatePageStageComponent-module__accordionControlHeadingText__1a1l1",stageComponentDiv:"TemplatePageStageComponent-module__stageComponentDiv__27BLa",searchBoxStyling:"TemplatePageStageComponent-module__searchBoxStyling__1FqrI",backButtonDivStyle:"TemplatePageStageComponent-module__backButtonDivStyle__1V_NW",backButtonTitle:"TemplatePageStageComponent-module__backButtonTitle__2NC-1",backButtonArrow:"TemplatePageStageComponent-module__backButtonArrow__d7pdy",backButtonArrowCategoryPage:"TemplatePageStageComponent-module__backButtonArrowCategoryPage__1HeaU",moreTemplatesDiv:"TemplatePageStageComponent-module__moreTemplatesDiv__2Lgtf",moreTemplatesGrid:"TemplatePageStageComponent-module__moreTemplatesGrid__3Z9DD",categoryPageSectionGap:"TemplatePageStageComponent-module__categoryPageSectionGap__3Ac-x",categoryPageHeader:"TemplatePageStageComponent-module__categoryPageHeader__366oc",hoverComponentContainer:"TemplatePageStageComponent-module__hoverComponentContainer__3JhKH",cardHoverSection:"TemplatePageStageComponent-module__cardHoverSection__3JQHA",cardHoverSectionPremium:"TemplatePageStageComponent-module__cardHoverSectionPremium__LRiaH",cardHoverSectionContent:"TemplatePageStageComponent-module__cardHoverSectionContent__5ASwZ",cardHoverSectionContentPremium:"TemplatePageStageComponent-module__cardHoverSectionContentPremium__K-1EM",zIndexAttr:"TemplatePageStageComponent-module__zIndexAttr__1R1FW",templateLoadingSpinner:"TemplatePageStageComponent-module__templateLoadingSpinner__2Ao1T",searchLoadingSpinner:"TemplatePageStageComponent-module__searchLoadingSpinner__3JPD3",premiumTemplateCardHoverComponent:"TemplatePageStageComponent-module__premiumTemplateCardHoverComponent__2j9Mb",premiumTemplateCardUpgradeTitle:"TemplatePageStageComponent-module__premiumTemplateCardUpgradeTitle__1GORS"};function we(e,t,a,n,r,o,i){return{correlationId:n.correlationId,getAccessToken:n.getAccessToken,getIdentity:function(){return Promise.resolve(r)},inMockMode:n.inMockMode,jwtAuthEnabled:n.jwtAuthEnabled,workload:n.workload,officeHomeApiRoot:n.officeHomeApiRoot,officeMarket:n.preferredCulture,app:e,sharedContext:o,queryTerm:t,searchMode:a,cancellationToken:i}}var je,Ee=a("MqQ1"),xe=function(e){var t=e.tagsArray,a=e.activeTagsArray,n=e.addSelectedTagsToList,r=e.removeSelectedTagsFromList;return O.a.createElement("div",{className:ke.tagsListParentDiv},null==t?void 0:t.map((function(e,t){return O.a.createElement(Ee.a,{key:t,id:e.Id,title:e.DisplayName,isActive:a.filter((function(t){return t.Id==e.Id})).length>0,isRemovable:!0,onClick:function(){n(e)},onRemoveClick:style:{margin:"2px 5px"}})})))},Se=a("FZB6"),Ne=a("CMIS"),Ae=function(e){Object(_.a)({type:"Click",eventName:"Template_Click",id:"Preview_".concat(e),area:"TemplatesPage",result:"Open",target:"Template"})},Ie=function(e){Object(_.a)({type:"Click",eventName:"Back_Click",id:"Back_".concat(e),area:"TemplatesPage",result:"Refer",target:"Other"})},Pe=function(e){Object(_.a)({type:"Click",eventName:"More_Templates_Toggle",id:"".concat(e,"ButtonClick"),area:"TemplatesPage",result:"ShowMoreTemplates"==e?"ShowMore":"ShowLess",target:"Other"})},De=function(e){Object(_.a)({type:"Click",eventName:"Tag_Removed_Click",id:"".concat(e),area:"TemplatesPage",result:"Open",target:"Other"})},Me=function(e){Object(_.a)({type:"Click",eventName:"Navigate_To_Category_Page",id:e,area:"TemplatesPage",result:"NavigateTo",target:"TemplatesCollection"})},Le=function(e){var t,a,n,o,i=e.app,c=e.selectedCategory,l=e.selectedSubCategory,s=e.navigateToTemplateCategoryPage,u=e.templatesPageData,d=e.onSearch,m=e.context,p=e.sharedContext,f=e.identity,v=e.searchQueryTerm,g=e.templateSearchEnabled,b=e.templateTagsEnabled,h=e.templatePageCollectionToLocStringModel,T=e.addSelectedTagsToList,y=e.removeSelectedTagsFromList,k=e.activeTagsArray,w=Object(r.__read)(O.a.useState(""),2),E=w[0],x=w[1],S=Object(r.__read)(O.a.useState(Object(ne.a)()),2),N=S[0],A=S[1];Object(C.useEffect)((function(){""!=E&&function(){Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,a,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return m&&f&&p?(e=Object(ne.a)(),t=we(i,E,Q.Suggestions,m,f,p,e),N.cancel(),A(e),[4,Oe(t)]):[3,2];case 1:a=r.sent(),n=[],null==a||a.value.map((),L(n),r.label=2;case 2:return[2]}}))}))}()}),[E]),Object(C.useEffect)((function(){N.cancel()}),[v]);var I=Object(j.a)().data,P=g&&((null==m?void 0:m.inMockMode)||!(null===(t=null==I?void 0:I.result)||void 0===t?void 0:t.IsGovernment))||!1,D=Object(r.__read)(O.a.useState([]),2),M=D[0],L=D[1],R=W(i),F=Object(C.useMemo)((function(){var e=[];return u&&e.push.apply(e,Object(r.__spreadArray)([],Object(r.__read)(function(e,t){return e?(e.TemplateCollections?Object.entries(null==e?void 0:e.TemplateCollections):[]).map((function(a){var n,o=Object(r.__read)(a,2)[1];return{name:null!==(n=t[o.Id])&&void 0!==n?n:o.Name,key:o.Id,subCategories:o.TemplateCategories.map((function(t){return{name:e.TemplateCategories?e.TemplateCategories[t].Name:"",key:e.TemplateCategories?e.TemplateCategories[t].Id:""}}))}})):[]}(u,h)),!1)),e}),[u]);G({canRender:!(!u||!R),paintMarker:"Paint_TemplatesPageNavigationComponent"});try{return O.a.createElement(O.a.Fragment,null,O.a.createElement("div",{className:ke.navigationParentDiv},O.a.createElement("div",{className:ke.accordionControlHeader,role:"heading","aria-level":2},O.a.createElement("div",{className:ke.accordionControlHeadingText},null==R?void 0:R.navigationSectionTitle)),P?O.a.createElement("div",{className:ke.searchBoxMargin},O.a.createElement(ge,{onSearch:d,searchboxInitialWidth:"181px",searchboxExtendedWidth:"218px",handleSearchSuggestions:x,suggestionsList:M,displaySearchIcon:!1,templateSearchControlResources:{placeholder:null==R?void 0:R.templatesSearchBoxPlaceholderText,searchboxAriaLabel:null==R?void 0:R.templatesSearchBoxAriaLabelText,clearButtonTitle:null==R?void 0:R.templatesSearchClearButtonTitle},searchQueryTerm:v})):O.a.createElement(O.a.Fragment,null),O.a.createElement("div",{className:ke.accordionScrollMaxHeight,"data-searchenabled":P},O.a.createElement(ae,{accordionCategories:F,onCategoryClick:function(e){var t=F.filter(()[0].subCategories[0].key;!function(e){Object(_.a)({type:"Click",eventName:"Accordion_Click",id:"".concat(e),area:"TemplatesPage",result:"Open",target:"Other"})}(e),s(t)},onSubCategoryClick:selectedCategoryKey:c,selectedSubCategoryKey:l,locStrings:{accordionCategory:null!==(a=null==R?void 0:R.templateNavigationCategoryAriaLabel)&&void 0!==a?a:"",accordionSubCategory:null!==(n=null==R?void 0:R.templateNavigationSubCategoryAriaLabel)&&void 0!==n?n:""}}),b&&0!=(null===(o=null==u?void 0:u.TagList)||void 0===o?void 0:o.length)?O.a.createElement(O.a.Fragment,null,O.a.createElement("div",{className:ke.accordionControlHeader},O.a.createElement("div",{className:te()(ke.accordionControlHeadingText,ke.tagsHeaderPadding)},null==R?void 0:R.templatesTagsHeading)),O.a.createElement(xe,{tagsArray:null==u?void 0:u.TagList,addSelectedTagsToList:T,removeSelectedTagsFromList:y,activeTagsArray:k})):O.a.createElement(O.a.Fragment,null))))}catch(e){return function(e){var t;Object(Ne.a)({eventName:"Navigation_Component_Error",area:"TemplatesPage",message:"Failed to create the Navigation Component",debugInfo:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:""})}(e),O.a.createElement(O.a.Fragment,null)}},Re=a("c+Fk"),Fe=a("5Spd"),Be=a("OeRt"),Ue=Object(ue.a)({container:{display:"flex",width:"100%",paddingBottom:"10px",alignItems:"center"},focus:{":hover":{backgroundColor:le.a.colorNeutralBackground1Hover}},arrow:{color:le.a.colorNeutralForeground1},title:{marginLeft:"8px",height:"27px",fontFamily:le.a.fontFamilyBase,fontStyle:"normal",fontWeight:600,fontSize:"20px",color:le.a.colorNeutralForeground1}}),We=function(e){var t=e.area,a=e.ariaLabel,n=e.title,r=e.navigateToTemplatePage,o=e.headingRef,i=e.headingAriaLabel,c=Ue(),l=Object(C.useCallback)((function(){r&&(Ie(t),r())}),[t,r]);return O.a.createElement("div",{className:c.container},O.a.createElement(Re.a,{onClick:l,className:c.focus,"aria-label":a},O.a.createElement(Be.t,{className:c.arrow})),O.a.createElement(Fe.a,{className:c.title,role:"heading","aria-label":i,ref:o,tabIndex:-1,"aria-level":2},n||""))},He=function(){return O.a.createElement("div",{className:te()("TemplateCardControl-module__premiumIconTile__19WME")},O.a.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzM4OTRfOTU5NCIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iLTExIiB5PSIwIiB3aWR0aD0iNTkiIGhlaWdodD0iNTQiPgo8cGF0aCBkPSJNNDcuMDEwOCA1My4wNjNMNDcuMDEwOCAzLjI1QzQ3LjAxMDggMS41OTMxNCA0NS42Njc3IDAuMjUgNDQuMDEwOCAwLjI1SC0xMC41ODY5TDQ3LjAxMDggNTMuMDYzWiIgZmlsbD0iYmxhY2siLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swXzM4OTRfOTU5NCkiPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMF9kXzM4OTRfOTU5NCkiPgo8cGF0aCBkPSJNNDcuMDEwOSA0MC4yNVYzLjI1QzQ3LjAxMDkgMS41OTMxNSA0NS42Njc3IDAuMjUgNDQuMDEwOSAwLjI1SDcuMDEwODZMNDcuMDEwOSA0MC4yNVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik00Ny4wMTA5IDQwLjI1VjMuMjVDNDcuMDEwOSAxLjU5MzE1IDQ1LjY2NzcgMC4yNSA0NC4wMTA5IDAuMjVINy4wMTA4Nkw0Ny4wMTA5IDQwLjI1WiIgc3Ryb2tlPSIjRkNGQ0ZCIi8+CjwvZz4KPHBhdGggZD0iTTQzLjQxMzkgMTEuNTQxN0M0My40MTM5IDExLjY1MTUgNDMuMzc4MSAxMS43NDkzIDQzLjMwNjQgMTEuODM1M0wzNi40MzE0IDIwLjA4NTNDMzYuMzQ1NSAyMC4xOTUxIDM2LjIyODUgMjAuMjUgMzYuMDgwNSAyMC4yNUMzNS45MzI1IDIwLjI1IDM1LjgxNTYgMjAuMTk1MSAzNS43Mjk2IDIwLjA4NTNMMjguODU0NiAxMS44MzUzQzI4Ljc4MyAxMS43NDkzIDI4Ljc0NzIgMTEuNjUxNSAyOC43NDcyIDExLjU0MTdDMjguNzQ3MiAxMS40NTU3IDI4Ljc2ODcgMTEuMzc3IDI4LjgxMTYgMTEuMzA1M0wzMS41NjE2IDYuNzIyMDFDMzEuNTk5OCA2LjY1NTE2IDMxLjY1NDcgNi42MDI2NSAzMS43MjY0IDYuNTY0NDVDMzEuNzk4IDYuNTIxNDggMzEuODc0NCA2LjUgMzEuOTU1NSA2LjVINDAuMjA1NUM0MC4yODY3IDYuNSA0MC4zNjMxIDYuNTIxNDggNDAuNDM0NyA2LjU2NDQ1QzQwLjUwNjMgNi42MDI2NSA0MC41NjEyIDYuNjU1MTYgNDAuNTk5NCA2LjcyMjAxTDQzLjM0OTQgMTEuMzA1M0M0My4zOTI0IDExLjM3NyA0My40MTM5IDExLjQ1NTcgNDMuNDEzOSAxMS41NDE3Wk0zNy4xNDc2IDcuNDE2NjdIMzUuMDEzNUwzMy41NTI1IDExLjA4MzNIMzguNjA4NUwzNy4xNDc2IDcuNDE2NjdaTTMyLjIxMzMgNy40MTY2N0wzMC4wMTQ4IDExLjA4MzNIMzIuNTY0MkwzNC4wMjUyIDcuNDE2NjdIMzIuMjEzM1pNMzAuMTg2NiAxMkwzNC42MzM5IDE3LjM0MjRMMzIuNTU3MSAxMkgzMC4xODY2Wk0zNi4wODA1IDE4LjUyNDFMMzguNjIyOCAxMkgzMy41MzgyTDM2LjA4MDUgMTguNTI0MVpNMzcuNTI3MSAxNy4zNDI0TDQxLjk3NDQgMTJIMzkuNjA0TDM3LjUyNzEgMTcuMzQyNFpNMzkuNTk2OCAxMS4wODMzSDQyLjE0NjNMMzkuOTQ3NyA3LjQxNjY3SDM4LjEzNTlMMzkuNTk2OCAxMS4wODMzWiIgZmlsbD0iIzM5NTVBMyIvPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2RfMzg5NF85NTk0IiB4PSIwLjg3MjQ0NyIgeT0iLTIuMjA1MzciIHdpZHRoPSI0OS44MjE1IiBoZWlnaHQ9IjQ5LjgyMTUiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iaGFyZEFscGhhIi8+CjxmZU9mZnNldCBkeD0iLTEuMjI3NjgiIGR5PSIyLjQ1NTM3Ii8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIuNDU1MzciLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjEgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd18zODk0Xzk1OTQiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3dfMzg5NF85NTk0IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8L2RlZnM+Cjwvc3ZnPgo=",alt:""}))},ze=function(e){var t=e.cardTitle,a=e.thumbnailUrl,n=e.isBlank,r=e.isPremium,o=e.hoverActions,i=e.hoverButtonProps,c="cardFaceArea_"+t,l="cardHoverArea_"+t;return O.a.createElement("div",{className:te()("TemplateCardControl-module__cardContainer__1WCkp"),"data-isblankcard":n},function(e,t){return O.a.createElement("div",{className:te()("TemplateCardControl-module__cardContent__nu-HR")},O.a.createElement("div",{className:te()("TemplateCardControl-module__cardHeader__1miPN")},O.a.createElement("div",{id:c,className:te()("TemplateCardControl-module__cardFaceArea__3rhgK")},O.a.createElement("div",{className:te()("TemplateCardControl-module__cardImage__1HsPD")},O.a.createElement("img",{src:e,alt:""}))),O.a.createElement("div",{id:l,className:te()("TemplateCardControl-module__cardHoverArea__eYrfT")},o&&o(i||[]))),O.a.createElement("div",{className:te()("TemplateCardControl-module__cardBorderSeparator__3sbK4")}),O.a.createElement("div",{className:te()("TemplateCardControl-module__cardFooter__3iMja")},O.a.createElement("div",{title:t,className:te()("TemplateCardControl-module__cardFooterTitle__23wfs")},t)))}(a,t),r&&O.a.createElement(He,null))};function Ve(e){var t;return e.Messages?!e.Messages.find((function(e){return"WacVisioSample"===e.Key&&"true"===e.Value.toLowerCase()})):!1!==(null===(t=null==e?void 0:e.IsBlank)||void 0===t?void 0:t.valueOf())}!je||(je={}));var Ge=a("5Ta0"),Qe=a("nYVX"),Xe=a("4SUI"),qe=a("If7d"),Ye=Object(ue.a)({container:{display:"flex",flexDirection:"column",flexWrap:"nowrap",alignItems:"stretch",backgroundColor:"transparent",boxShadow:"none","@media(max-height: 770px)":{top:"8%"},"@media(min-height: 771px)":{top:"15%"}},header:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex"},de.a.flex(1,1,"auto")),{alignItems:"center",fontWeight:qe.f.semibold}),de.a.padding("13px","30px","13px","30px")),{fontSize:"20px",lineHeight:"24px",backgroundColor:le.a.colorNeutralBackground1,color:le.a.colorNeutralForeground1}),headerTitle:{paddingRight:"10px"},body:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},de.a.flex(4,4,"auto")),de.a.padding("0","24px","24px","24px")),{overflowY:"hidden"}),createButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:le.a.colorBrandForeground1},de.a.border("1px","solid",le.a.colorBrandForeground1)),{":hover, :active":Object(r.__assign)({backgroundColor:le.a.colorBrandForegroundLinkHover},de.a.border("1px","solid",le.a.colorBrandForegroundLinkHover)),height:"32px",width:"84px",minWidth:"0",fontStyle:"normal",fontWeight:"600","@media(max-height: 230px)":{fontSize:"5px"},"@media screen and (min-height: 231px) and (max-height:440px)":{fontSize:"10px"},"@media screen and (min-height: 441px) and (max-height:770px)":{fontSize:"12px"},"@media(min-height: 771px)":{fontSize:"14px"},lineHeight:"16px"}),de.a.borderRadius("3.3292px")),de.a.padding("0")),previewImage:{width:"auto",textAlign:"center","@media(max-height: 330px)":Object(r.__assign)({},de.a.padding("13px","45px","13px","45px")),"@media screen and (min-height: 331px) and (max-height:440px)":Object(r.__assign)({},de.a.padding("13px","60px","13px","60px")),"@media screen and (min-height: 441px) and (max-height:770px)":Object(r.__assign)({},de.a.padding("13px","80px","13px","80px")),"@media(min-height: 771px)":Object(r.__assign)({},de.a.padding("13px","115px","13px","115px")),backgroundColor:le.a.colorNeutralBackground4},previewCardImageOneHundred:{width:"100%",height:"auto"},previewCardImageEighty:{width:"80%",height:"auto"},footer:Object(r.__assign)(Object(r.__assign)({},de.a.padding("20px","28px","20px","28px")),{display:"flex",justifyContent:"space-between",backgroundColor:le.a.colorNeutralBackground1}),footerText:{maxWidth:"75%",paddingRight:"28px",color:le.a.colorNeutralForeground1,"@media(max-height: 330px)":{fontSize:"8px"},"@media screen and (min-height: 331px) and (max-height:440px)":{fontSize:"10px"},"@media screen and (min-height: 441px) and (max-height:770px)":{fontSize:"12px"},"@media(min-height: 771px)":{fontSize:"14px"}},modalLayout:Object(r.__assign)({display:"flex"},de.a.overflow("hidden")),modalView:Object(r.__assign)({"@media(max-height: 770px)":{width:"460px"},"@media screen and (min-height: 771px) and (max-height:1000px)":{width:"600px"},"@media(min-height: 1001px)":{width:"730px"},backgroundColor:le.a.colorNeutralBackground1,mixBlendMode:"normal"},de.a.borderRadius("3px")),carouselLeft:Object(r.__assign)({width:"50px",verticalAlign:"middle"},de.a.padding("0","10px","0","0")),carouselLeftIconStyle:{color:le.a.colorNeutralBackground1},carouselLeftIcon:{width:"39px",float:"right",":focus-visible":{outlineStyle:"solid",outlineWidth:"1px",outlineColor:le.a.colorNeutralForeground1},cursor:"pointer",display:"flex",alignItems:"center"},carouselLeftIconTop:{"@media(max-height: 330px)":{height:"150px"},"@media screen and (min-height: 331px) and (max-height:770px)":{height:"190px"},"@media screen and (min-height: 771px) and (max-height:1000px)":{height:"240px"},"@media(min-height: 1001px)":{height:"285px"}},carouselLeftIconBottom:{"@media(max-height: 330px)":{height:"calc(100% - 198px)"},"@media screen and (min-height: 331px) and (max-height:770px)":{height:"calc(100% - 238px)"},"@media screen and (min-height: 771px) and (max-height:1000px)":{height:"calc(100% - 288px)"},"@media(min-height: 1001px)":{height:"calc(100% - 333px)"}},carouselRight:Object(r.__assign)({width:"50px",verticalAlign:"middle"},de.a.padding("0","0","0","10px")),carouselRightIconStyle:{color:le.a.colorNeutralBackground1},carouselRightIcon:{width:"39px",float:"left",":focus-visible":{outlineStyle:"solid",outlineWidth:"1px",outlineColor:le.a.colorNeutralForeground1},cursor:"pointer",display:"flex",alignItems:"center"},carouselRightIconTop:{"@media(max-height: 330px)":{height:"150px"},"@media screen and (min-height: 331px) and (max-height:770px)":{height:"190px"},"@media screen and (min-height: 771px) and (max-height:1000px)":{height:"240px"},"@media(min-height: 1001px)":{height:"285px"}},carouselRightIconBottom:{"@media(max-height: 330px)":{height:"calc(100% - 198px)"},"@media screen and (min-height: 331px) and (max-height:770px)":{height:"calc(100% - 238px)"},"@media screen and (min-height: 771px) and (max-height:1000px)":{height:"calc(100% - 288px)"},"@media(min-height: 1001px)":{height:"calc(100% - 333px)"}}}),Ze=function(e){var t=e.templateAssetId,a=e.previewCardDataArray,n=e.onCreateBtnClick,o=e.btnLabel,i=e.premiumPreviewCardBtnLabel,c=e.locStrings,l=e.onPreviewCardDismiss,s=e.previewImageStyle,u=Object(r.__read)(Object(C.useState)(!0),2),d=u[0],m=u[1],p=Ye(),f=C.useRef(null),v=C.useRef(null),g=C.useRef(null),b=Object(r.__read)(Object(C.useState)((function(){for(var e=0;e<a.length;e++)if(a[e].assetId==t)return e;return 0})),2),h=b[0],_=b[1],T=Object(se.a)(),y=a.length,O=function(e){_((h+e+y)%y),m(!0)},k={root:{color:le.a.colorNeutralForeground1,marginLeft:"auto",marginTop:"4px",marginRight:"2px"},rootHovered:{color:le.a.colorNeutralForeground1Hover,backgroundColor:le.a.colorSubtleBackgroundHover},rootPressed:{color:le.a.colorNeutralForeground1Hover,backgroundColor:le.a.colorSubtleBackgroundPressed}},w={label:{color:le.a.colorNeutralForegroundOnBrand}},j=function(e,t){switch(Object(K.a)(e)){case J.a.Enter:O(t)}};return Object(C.useEffect)((,[]),C.createElement(Ge.a,{isOpen:d,focusTrapZoneProps:{disabled:!1},onDismiss:containerClassName:te()(p.container,T),topOffsetFixed:!0},C.createElement("div",{onKeyDown:function(e){return function(e){switch(Object(K.a)(e)){case J.a.ArrowLeft:O(-1),v.current&&v.current.focus();break;case J.a.ArrowRight:O(1),g.current&&g.current.focus()}}(e)},className:p.modalLayout},C.createElement("div",{className:p.carouselLeft},C.createElement("div",{className:p.carouselLeftIconTop,role:"none",onClick:function(){return m(!1)}}),C.createElement("div",{className:p.carouselLeftIcon,title:c.carouselLeftBtnTitle,onClick:ref:v,tabIndex:0,"aria-label":c.carouselLeftAriaLabel,role:"button",onKeyDown:,C.createElement(Be.v,{primaryFill:"white"})),C.createElement("div",{className:p.carouselLeftIconBottom,role:"none",onClick:function(){return m(!1)}})),C.createElement("div",{className:p.modalView,onClick:,C.createElement("div",{className:p.header},C.createElement("div",{className:p.headerTitle,title:a[h].title},a[h].title),C.createElement(Qe.a,{title:c.closeBtnTitle,styles:k,iconProps:{iconName:"Cancel"},ariaLabel:c.closeBtnAriaLabel,onClick:function(){return m(!1)}})),C.createElement("div",{className:p.previewImage},C.createElement("img",{src:a[h].thumbnailUrl,alt:"",style:s})),C.createElement("div",{className:p.footer},C.createElement("div",{className:p.footerText},a[h].description),C.createElement(Xe.a,{text:a[h].isPremium?i:o,title:c.createBtnTitle,className:p.createButton,tabIndex:0,componentRef:f,"aria-label":Object($.a)(c.createBtnAriaLabel,a[h].title),onClick:function(){a[h].isPremium?window.open("https://go.microsoft.com/fwlink/?linkid=2185446","_blank"):n(a[h].assetId)},styles:w}))),C.createElement("div",{className:p.carouselRight},C.createElement("div",{className:p.carouselRightIconTop,role:"none",onClick:function(){return m(!1)}}),C.createElement("div",{className:p.carouselRightIcon,title:c.carouselRightBtnTitle,onClick:ref:g,tabIndex:0,"aria-label":c.carouselRightAriaLabel,role:"button",onKeyDown:function(e){Object(K.a)(e)===J.a.Tab?(e.preventDefault(),window.setTimeout(e.shiftKey?function(){var e;return null===(e=f.current)||void 0===e?void 0:e.focus()}:0)):j(e,1)}},C.createElement(Be.B,{primaryFill:"white"})),C.createElement("div",{className:p.carouselRightIconBottom,role:"none",onClick:))))},Ke=a("xARA"),Je=a.n(Ke);function $e(e){return e.Images?e.Images[e.Images.length-1].Url:e.Thumbnails?e.Thumbnails[e.Thumbnails.length-1].Url:""}function et(e,t,a,n,o,i){var c,l,s=[],d=document.createElement("div");if(d.id="previewCardHost",o.TemplateCategories)try{for(var m=Object(r.__values)(a),p=m.next();!p.done;p=m.next()){var f=o.TemplatesData[p.value];s.push({title:f.Title,assetId:f.AssetId,thumbnailUrl:$e(f),description:f.Description,isPremium:f.IsPremium})}}catch(e){c={error:e}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(c)throw c.error}}var v={previewCardImageEighty:{width:"80%",height:"auto"},previewCardImageOneHundred:{width:"100%",height:"auto"}};Je.a.render(O.a.createElement(Ze,{previewCardDataArray:s,templateAssetId:t.AssetId,onCreateBtnClick:function(t){var a,r=o.TemplatesData[t];!function(e,t){Object(_.a)({type:"Click",eventName:"Preview_Click",id:"Create_".concat(e),area:"TemplatesPage",result:"Refer",target:Object(Se.a)(t)})}(t,e),null===(a=null==n?void 0:n(r))||void 0===a||a.handleClick()},btnLabel:i.templateCardButtonText,premiumPreviewCardBtnLabel:null==i?void 0:i.premiumTemplateCardHoverUpgradeTitle,locStrings:{createBtnAriaLabel:i.previewCardCreateButtonAriaLabel,carouselRightAriaLabel:i.previewCardNextButtonAriaLabel,carouselLeftAriaLabel:i.previewCardPrevButtonAriaLabel,closeBtnAriaLabel:i.previewCardCloseButtonAriaLabel,carouselLeftBtnTitle:i.previewCardPrevButtonTitle,closeBtnTitle:i.previewCardCloseButtonTitle,createBtnTitle:i.previewCardCreateButtonTitle,carouselRightBtnTitle:i.previewCardNextButtonTitle},onPreviewCardDismiss:function(){!function(e){Object(_.a)({type:"Click",eventName:"Preview_Click",id:"Close_".concat(e),area:"TemplatesPage",result:"Close",target:"Template"})}(t.AssetId),d&&(Je.a.unmountComponentAtNode(d),d=void 0)},previewImageStyle:e===u.a.Word?v.previewCardImageEighty:v.previewCardImageOneHundred}),d)}var tt=function(e,t){var a=document.getElementById("cardHoverArea_"+t);e?a&&a.classList.add(te()(ke.zIndexAttr)):a&&a.classList.remove(te()(ke.zIndexAttr))},at=function(e){return O.a.createElement("div",{className:te()(ke.hoverComponent)},O.a.createElement("div",{className:te()(ke.hoverComponentContainer)},e.map((function(e,t){return O.a.createElement("div",{className:te()(ke.cardHoverSection,e.isPremium?ke.cardHoverSectionPremium:""),tabIndex:0,"aria-label":Object($.a)(e.locString,e.cardTitle),role:"option","aria-selected":!0,onFocus:function(t){t.relatedTarget&&tt(!0,e.cardTitle)},onBlur:onKeyDown:e.isPremium?void 0:function(t){switch(Object(K.a)(t)){case J.a.Enter:e.onClick()}},onClick:e.isPremium?void 0:e.onClick,style:{height:"".concat(e.height)},key:t},O.a.createElement("div",{className:te()(ke.cardHoverSectionContent,e.isPremium?ke.cardHoverSectionContentPremium:"")},O.a.createElement("span",null,e.content)))}))))};function nt(e,t,a,n,r,o,i,c){void 0===c&&(c=je.HomePage);var l=[],s=function(){var t;tt(!1,e.Title),function(e,t,a){Object(_.a)({type:"Click",eventName:"Template_Click",id:"Create_".concat(t,"_").concat(e),area:"TemplatesPage",result:"Refer",target:Object(Se.a)(a)})}(e.AssetId,c,a),null===(t=null==o?void 0:o(e))||void 0===t||t.handleClick()};return r&&(e.IsPremium?l.push({content:ot(null==r?void 0:r.templateCardButtonText,e.IsPremium,r),height:"100%",onClick:function(){},cardTitle:e.Title,locString:r.blankTemplateAriaLabel,isPremium:e.IsPremium}):c==je.HomePage?Ve(e)?(l.push({content:ot(null==r?void 0:r.blankTemplateCardButtonText),height:"50%",onClick:s,cardTitle:e.Title,locString:r.blankTemplateAriaLabel}),l.push({content:ot(r.templateCardExploreButtonText),height:"50%",onClick:function(){var t=e.Categories[0].Id;!function(e){Object(_.a)({type:"Click",eventName:"Template_Click",id:"Explore_".concat(e),area:"TemplatesPage",result:"NavigateTo",target:"TemplatesCollection"})}(e.AssetId),i&&(Me(e.AssetId),i(t))},cardTitle:e.Title,locString:null==r?void 0:r.exploreButtonAriaLabel})):(l.push({content:ot(null==r?void 0:r.templateCardButtonText),height:"50%",onClick:s,cardTitle:e.Title,locString:r.blankTemplateAriaLabel}),l.push({content:ot(r.templateCardPreviewButtonText),height:"50%",onClick:function(){Ae(e.AssetId),et(a,e,n,o,t,r)},cardTitle:e.Title,locString:null==r?void 0:r.previewButtonAriaLabel})):Ve(e)?l.push({content:ot(r.blankTemplateCardButtonText),height:"100%",onClick:s,cardTitle:e.Title,locString:null==r?void 0:r.blankTemplateAriaLabel}):(l.push({content:ot(r.templateCardButtonText),height:"50%",onClick:s,cardTitle:e.Title,locString:null==r?void 0:r.blankTemplateAriaLabel}),l.push({content:ot(r.templateCardPreviewButtonText),height:"50%",onClick:function(){Ae(e.AssetId),et(a,e,n,o,t,r)},cardTitle:e.Title,locString:null==r?void 0:r.previewButtonAriaLabel}))),l}function rt(e,t){var a=[];return e&&a.push({content:ot(e.blankTemplateCardButtonText),height:"100%",onClick:function(){tt(!1,(null==e?void 0:e.blankTemplateText)||""),t()},cardTitle:null==e?void 0:e.blankTemplateText,locString:null==e?void 0:e.blankTemplateAriaLabel}),a}function ot(e,t,a){return void 0===t&&(t=!1),void 0===a&&(a=void 0),t?O.a.createElement("div",{className:te()(ke.premiumTemplateCardHoverComponent)},O.a.createElement("span",null,null==a?void 0:a.premiumTemplateCardHoverTitle),O.a.createElement("a",{className:te()(ke.premiumTemplateCardUpgradeTitle),href:"https://go.microsoft.com/fwlink/?linkid=2185446",target:"_blank",rel:"noreferrer"},null==a?void 0:a.premiumTemplateCardHoverUpgradeTitle)):O.a.createElement("span",null,e)}var it=function(e){return O.a.createElement("div",{className:"cardsGridContainer"},e.templateCardArray.map((function(e,t){return O.a.createElement(ze,{key:t,cardTitle:e.cardTitle,thumbnailUrl:e.thumbnailUrl,isBlank:e.isBlank,isPremium:e.isPremium,hoverActions:at,hoverButtonProps:e.hoverButtonProps})})))},ct=function(e){var t=e.backButtonOptions,a=e.subCategories,n=e.selectedCategoryTitle,r=e.selectedCollectionName,o=W(u.a.Visio),i=Object(C.useRef)(null);Object(C.useEffect)((),G({canRender:!(!a||!o),paintMarker:"Paint_TemplatesPageComponent"});try{return O.a.createElement("div",{className:ke.parentDivStyle},t.disabled?null:O.a.createElement(We,{ariaLabel:null==o?void 0:o.templatesBackButtonAriaLabel,area:je.CategoryPage,navigateToTemplatePage:t.navigateToTemplatePage,title:r}),O.a.createElement("div",{className:ke.pageScrollMaxHeight},O.a.createElement("div",{style:{paddingTop:"10px"},className:"cardsGrid--right-gutter"},a.map((function(e){return O.a.createElement("div",e.subCategoryTitle===n?{className:ke.categoryPageSectionGap,ref:i}:{className:ke.categoryPageSectionGap},O.a.createElement("div",{className:ke.categoryPageHeader,role:"heading","aria-level":3},e.subCategoryTitle),O.a.createElement(it,{templateCardArray:e.subCategoryTemplateCards.templateCardArray}))})))))}catch(e){return function(e){var t;Object(Ne.a)({eventName:"Category_Component_Error",area:"TemplatesPage",message:"Failed to create the Category Component",debugInfo:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:""})}(e),O.a.createElement(O.a.Fragment,null)}},lt=a("85o7"),st=a("duEa"),ut=Object(ue.a)({backButtonArrow:{fontSize:"20px",paddingTop:"2px",paddingLeft:"4px"},moreTemplatesTitle:{height:"21px",fontFamily:"Segoe UI",fontStyle:"normal",fontWeight:"600",fontSize:"14px",color:le.a.colorBrandForegroundLink,paddingRight:"9px"},featuredSamplesTitle:{height:"40px",fontFamily:"Segoe UI",fontStyle:"normal",fontWeight:"600",fontSize:"20px",color:le.a.colorNeutralForeground1,paddingBottom:"10px"},arrowStyle:{fontSize:"20px",paddingLeft:"4px"},moreTemplatesAlignmentsStackStyles:{paddingTop:"48px",paddingBottom:"96px"},moreTemplatesLinkElementStyle:{display:"flex",alignItems:"center"}}),dt=function(e){var t=e.templateCards,a=e.featuredCards,n=e.navigateToStartPage,o=e.moreTemplatesEnabled,i=void 0!==o&&o,c=W(e.fileType),l=ut(),s=Object(r.__read)(O.a.useState(!0),2),u=s[0],d=s[1],m=Object(C.useRef)(null);function p(){u&&d?(Pe("ShowLessTemplates"),d(!1),m.current&&m.current.scrollIntoView({behavior:"smooth"})):(Pe("ShowMoreTemplates"),d(!0))}G({canRender:!!(t&&a&&c),paintMarker:"Paint_TemplatesPageComponent"});try{return O.a.createElement("div",{className:ke.parentDivStyle},O.a.createElement("div",{className:ke.backButtonDivStyle},O.a.createElement(Re.a,{onClick:function(){n&&(Ie(je.HomePage),n())},className:ke.backButtonFocus,"aria-label":null==c?void 0:c.templatesBackButtonAriaLabel},O.a.createElement(Be.t,{className:ke.backButtonArrow})),O.a.createElement(Fe.a,{className:ke.backButtonTitle,role:"heading","aria-level":2},null==c?void 0:c.backButtonText)),O.a.createElement("div",{className:ke.pageScrollMaxHeight},O.a.createElement("div",{style:{paddingTop:"10px",paddingBottom:"64px"},ref:m,className:"cardsGrid--right-gutter"},O.a.createElement(it,!i||u?{templateCardArray:t.templateCardArray}:{templateCardArray:t.templateCardArray.slice(0,12)}),O.a.createElement("div",{className:ke.moreTemplatesGrid,"data-moretemplatesenabled":i},i?O.a.createElement("div",{className:ke.moreTemplatesDiv},O.a.createElement(Re.a,{className:l.moreTemplatesLinkElementStyle,onClick:,O.a.createElement(Fe.a,{className:l.moreTemplatesTitle},u?null==c?void 0:c.showLessButtonText:null==c?void 0:c.moreTemplatesLinkText),O.a.createElement(u?lt.i:st.U,{className:l.arrowStyle}))):O.a.createElement(O.a.Fragment,null)),O.a.createElement("div",{className:l.featuredSamplesTitle,role:"heading","aria-level":2},null==c?void 0:c.featuredTemplatesSectionTitle),O.a.createElement(it,{templateCardArray:a.templateCardArray}))))}catch(e){return function(e){var t;Object(Ne.a)({eventName:"Home_Component_Error",area:"TemplatesPage",message:"Failed to create the Home Component",debugInfo:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:""})}(e),O.a.createElement(O.a.Fragment,null)}},mt=a("EXRb"),pt=a("43jW"),ft=function(e){var t=e.area,a=e.ariaLabel,n=e.navigateToTemplatePage,r=e.activeTagsList,o=e.removeSelectedTagsFromPivotsControl,i=e.pivotsControlStrings,c=r&&r.length>0?r.map((function(e){var t;return{id:e.Id,title:null!==(t=e.DisplayName)&&void 0!==t?t:""}})):[];return O.a.createElement("div",{className:ke.backButtonDivStyle},O.a.createElement(Re.a,{onClick:className:ke.backButtonFocus,"aria-label":a},O.a.createElement(Be.t,{className:ke.backButtonArrow})),O.a.createElement(pt.a,{tabs:c,onRemovePivot:o,showPills:!0,pivotsOverflow:pt.b.Dropdown,dropdownButtonText:i.dropdownButtonText,selectedTabInDropdownAriaLabel:i.selectedTabInDropdownAriaLabel,onlyDropdownShownLeftAlignContext:!0,activeTabOptions:{activeMode:"all",allTabsRemovable:!0}}))};function vt(e,t,a,n,r,o,i,c){if(!t)return[];var l=a.value?a.value.filter((function(e){var a=t.TemplatesData[e.AssetId];return a&&!Ve(a)})).map(():[];return a.value?a.value.filter((function(e){var a=t.TemplatesData[e.AssetId];return a&&(o?Ve(a):!Ve(a))})).map((function(a){var o,s=t.TemplatesData[a.AssetId];return{cardTitle:s.Title,thumbnailUrl:$e(s),isBlank:Ve(s),isPremium:null!==(o=s.IsPremium)&&void 0!==o&&o,hoverActions:at,hoverButtonProps:nt(s,t,e,l,n,r,c,i)}})):[]}var gt=function(e){var t=e.queryTerm,a=e.context,n=e.sharedContext,c=e.identity,l=e.templatesPageData,s=e.appName,u=e.templatePageResources,d=e.createTemplateHandler,m=e.navigateTo,p=e.navigateToTemplatePage,f=e.activeTagsList,v=e.removeSelectedTagsFromPivotsControl,g=Object(r.__read)(O.a.useState({templatesArray:[],samplesArray:[],isLoading:!0}),2),b=g[0],h=g[1];Object(C.useEffect)((function(){var e;b.isLoading||null===(e=w.current)||void 0===e||e.focus()}),[b.isLoading]),Object(C.useEffect)((function(){""==t&&0==(null==f?void 0:f.length)||function(){Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,o,i,p;return Object(r.__generator)(this,(function(v){switch(v.label){case 0:return a&&c&&n?(e=f&&0!=f.length?we(s,function(e){return e.length>0?e.map(().join(" OR "):""}(f),Q.Tags,a,c,n):we(s,t,Q.Search,a,c,n),h({templatesArray:b.templatesArray,samplesArray:b.samplesArray,isLoading:!0}),[4,Oe(e)]):[3,2];case 1:o=v.sent(),i=[],p=[],l&&o&&(i.push.apply(i,Object(r.__spreadArray)([],Object(r.__read)(vt(s,l,o,u,d,!1,je.SearchPage,m)),!1)),p.push.apply(p,Object(r.__spreadArray)([],Object(r.__read)(vt(s,l,o,u,d,!0,je.SearchPage,m)),!1))),h({templatesArray:p,samplesArray:i,isLoading:!1}),e.searchMode==Q.Search&&function(e){e?Object(_.a)({type:"Click",eventName:"Search_Results_Available",id:"SearchResultsUnavailable",area:"TemplatesPage",result:"Search",target:"Other"}):Object(_.a)({type:"Click",eventName:"Search_Results_Available",id:"SearchResultsAvailable",area:"TemplatesPage",result:"Search",target:"Other"})}(0==(null==p?void 0:p.length)&&0==(null==i?void 0:i.length)),v.label=2;case 2:return[2]}}))}))}()}),[t,f]);var T=W(s),y=Object(i.a)().data,k=Object(mt.a)(null==y?void 0:y.cdnDomain,"officestartresources","visio_landing_page_search","png"),w=Object(C.useRef)(null),j="".concat(null==T?void 0:T.templatesSearchNoResultsTitle,' "').concat(t,'"'),E="".concat(null==T?void 0:T.templatesSearchResultsTitle,' "').concat(t,'"'),x=Object(C.useMemo)((,[T]);try{return O.a.createElement("div",{className:ke.parentDivStyle},O.a.createElement("div",{className:ke.searchParentDiv},0!=(null==f?void 0:f.length)?O.a.createElement(ft,{area:je.SearchPage,ariaLabel:null==T?void 0:T.templatesBackButtonAriaLabel,navigateToTemplatePage:p,activeTagsList:f,removeSelectedTagsFromPivotsControl:v,pivotsControlStrings:x}):O.a.createElement(We,{area:je.SearchPage,ariaLabel:null==T?void 0:T.templatesBackButtonAriaLabel,navigateToTemplatePage:p,title:E}),b.isLoading?O.a.createElement("div",{className:ke.searchLoadingSpinner},O.a.createElement(o.a,{size:"huge"})):O.a.createElement(O.a.Fragment,null,O.a.createElement("div",{className:ke.pageScrollMaxHeight},0==b.samplesArray.length&&0==b.templatesArray.length?O.a.createElement(Fe.a,{className:te()(ke.categoriesTitleDiv,ke.searchPageTextStyle,ke.isFlexComponent)},j):O.a.createElement(O.a.Fragment,null,0!=b.templatesArray.length?O.a.createElement(O.a.Fragment,null,O.a.createElement(Fe.a,{className:te()(ke.categoriesTitleDiv,ke.searchPageTextStyle,ke.isFlexComponent),role:"heading","aria-level":3},null==T?void 0:T.templatesSearchTemplatesSectionTitle),O.a.createElement("div",{style:{padding:"0px 0px 64px 0px"}},O.a.createElement(it,{templateCardArray:b.templatesArray}))):O.a.createElement(O.a.Fragment,null),0!=b.samplesArray.length?O.a.createElement(O.a.Fragment,null,O.a.createElement("div",{className:te()(ke.diagramsTitleDiv,ke.searchPageTextStyle,ke.isFlexComponent),role:"heading","aria-level":3},null==T?void 0:T.templatesSearchDiagramsSectionTitle),O.a.createElement("div",{style:{padding:"0px 0px 45px 0px"}},O.a.createElement(it,{templateCardArray:b.samplesArray}))):O.a.createElement(O.a.Fragment,null)),O.a.createElement("div",{className:ke.searchMessage,id:"SearchMessageSection"},O.a.createElement("img",{id:"SearchMessageImage",className:ke.searchMessageImage,src:k,alt:""}),O.a.createElement("div",{id:"SearchMessage_Line1",className:ke.searchMessageText_Line1},null==T?void 0:T.templatesSearchMessageText),O.a.createElement("div",{id:"SearchMessage_Line2",className:ke.searchMessageText_Line2},O.a.createElement("a",{id:"SearchMessage_Line2_Link",className:ke.searchFeedbackLink,target:"_blank",href:"https://go.microsoft.com/fwlink/?linkid=2202187",rel:"noreferrer"},null==T?void 0:T.templatesSearchMessageHyperlinkText)))))))}catch(e){return function(e){var t;Object(Ne.a)({eventName:"Search_Component_Error",area:"TemplatesPage",message:"Failed to create the Search Component",debugInfo:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:""})}(e),O.a.createElement(O.a.Fragment,null)}};function bt(e){var t,a=e.templateInfo,n=e.isBlank,r=e.templatePageData,o=e.appName,i=e.samplesAssetId,c=e.templatePageResources,l=e.createTemplateHandler,s=e.calledFrom,u=e.navigateTo;return{cardTitle:a.Title,thumbnailUrl:$e(a),isBlank:n,isPremium:null!==(t=a.IsPremium)&&void 0!==t&&t,hoverActions:at,hoverButtonProps:nt(a,r,o,i,c,l,u,s)}}var ht=function(e,t){if(t)for(var a=(null==t?void 0:t.TemplateCollections)?Object.entries(null==t?void 0:t.TemplateCollections):[],n=0;n<a.length;n++){var r=a[n][1];if(r.TemplateCategories.includes(e))return r.Id}return""},_t=function(e){var t,a,E,x,S=e.fileType,N=e.stageConfig,I=Object(C.useMemo)((function(){var e;return null!==(e=Object(m.a)(S))&&void 0!==e?e:u.a.None}),[S]),P=Object(C.useCallback)((function(e){switch(e.resultType){case"Error":Object(d.c)({category:"CreateFile",error:"Generic",fileType:I});break;default:return}}),[I]),D=Object(l.a)(),M=Object(C.useMemo)((function(){return D.get(I)}),[I,D]),U=Object(f.a)("CreateOnTemplates",M,P),H=function(e,t,a){var n=Object(C.useCallback)((function(t,a,n){if(n&&n.AssetId){var r=Object(m.a)(n.Application)||u.a.None,o=Object(b.a)(r);Object(_.a)({id:n.AssetId,area:e,subArea:"Templates",result:o&&Object(v.a)(t)?"Refer":"Navigate",target:o&&Object(v.a)(t)?Object(y.a)(o):"Other"}),Object(T.a)({featureName:"Create",eventName:h.a.TemplateClickResult,area:e,params:{ElementId:n.AssetId,Action:t,DocumentType:Object(w.a)(n),TemplateType:"Enterprise"}})}}),[e]),r=Object(g.a)();return Object(C.useCallback)((function(e){if(t&&e&&e.AssetId&&"Enterprise"===e.templateType)return Object(k.a)({template:e,driveId:e.driveId,candidate:t,instrumentClick:n,getOrUpdatePendingCreates:r,errorCallback:a})}),[t,r,n,a])}("CreateOnTemplates",M,P),z=Object(C.useCallback)((function(e){return function(e){return"Enterprise"==e.templateType?H(e):U(e)}(e)}),[H,U]),V=W(I),Q=Object(i.a)().data,X=Object(p.a)().data,q=Object(c.a)().data,Y=Object(C.useCallback)((function(e){var t,a;ie(e),oe(""),se([]);var r={route:"Templates",app:I};""===e?null==Q||Q.router.navigateTo(r,!1,((t={})[n.categoryId]=void 0,t)):null==Q||Q.router.navigateTo(r,!1,((a={})[n.categoryId]=e,a))}),[I,null==Q?void 0:Q.router]),Z=K=Object(C.useCallback)((,[Y]),J=null==Q?void 0:Q.router.getSearchParams(),$=null==J?void 0:J.get(n.categoryId),ee=Object(r.__read)(O.a.useState(null!==(t=null!=$?$:function(e){if("hideStage"===(null==e?void 0:e.displayOptions.type))return e.displayOptions.selectedCollectionName}(N))&&void 0!==t?t:""),2),te=ee[0],ae=ee[1],ne=Object(r.__read)(O.a.useState(""),2),re=ne[0],oe=ne[1],ie=function(e){return ae(e)},ce=Object(r.__read)(O.a.useState([]),2),le=ce[0],se=ce[1],ue=Object(C.useCallback)((function(e){oe(""),ae(""),se((function(t){return t.filter(().length>0?t:(function(e){Object(_.a)({type:"Click",eventName:"Tag_Added_Click",id:"".concat(e),area:"TemplatesPage",result:"Open",target:"Other"})}(e.Id),Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),[e],!1))}))}),[]),de=Object(C.useCallback)((function(e){De(e.Id),se((function(t){return t.filter((function(t){return t.Id!=e.Id}))}))}),[]),me=Object(C.useCallback)((function(e){De(e.id),se((function(t){return t.filter(()}))}),[]),pe=function(e,t){var a,n,o,i,c=Object(r.__read)(Object(C.useState)({LicenceInfo:"",TemplatesData:{},TemplateCategories:{},TemplateCollections:{}}),2),l=c[0],s=c[1],u=Object(L.a)(e,t),d=function(e,t){var a=Object(F.a)(e,t),n=["TemplatesPageDataFromProvider",e,t];return Object(R.c)(n,(function(){var t;return null===(t=null==a?void 0:a.getTemplatesPageData)||void 0===t?void 0:t.call(a,e,(function(e){return R.a.setQueryData(n,e)}))}),{staleTime:1/0,cacheTime:1/0,enabled:a&&(null==a?void 0:a.getTemplatesPageData)})}(e,t),m=null===(n=null===(a=Object(j.a)().data)||void 0===a?void 0:a.result)||void 0===n?void 0:n.CompanyDisplayName;return Object(C.useEffect)((function(){!function(){Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return e=(null===(t=null==d?void 0:d.data)||void 0===t?void 0:t.result)||l,(null==u?void 0:u.data)&&m?[4,B(u.data.result,e,m)]:[3,2];case 1:a.sent(),a.label=2;case 2:return s(e),[2]}}))}))}()}),[m,u,l,d]),Object(C.useMemo)((function(){var e,t,a;return{templatesPageData:{result:l,fromPersistence:null!==(a=(null===(e=u.data)||void 0===e?void 0:e.fromPersistence)&&(null===(t=null==d?void 0:d.data)||void 0===t?void 0:t.fromPersistence))&&void 0!==a&&a},isLoading:u.isLoading||(null==d?void 0:d.isLoading),isSuccess:(null==d?void 0:d.isSuccess)&&(u.isSuccess||!u.isLoading&&!u.isSuccess&&!u.isError&&"idle"===u.status)}}),[null===(o=u.data)||void 0===o?void 0:o.fromPersistence,u.isError,u.isLoading,u.isSuccess,u.status,l,null===(i=d.data)||void 0===i?void 0:i.fromPersistence,d.isLoading,d.isSuccess])}(I,null===(a=null==N?void 0:N.templatesProviderConfig)||void 0===a?void 0:a.templatesDataProvider),fe=pe.templatesPageData,ve=pe.isLoading,ge=pe.isSuccess,be=null==J?void 0:J.get(n.driveId);if(be&&"string"==typeof be&&(null===(E=null==fe?void 0:fe.result)||void 0===E?void 0:E.TemplateCollections)){var he=A({DriveId:be,ItemId:"",Title:"",id:""});(null===(x=null==fe?void 0:fe.result.TemplateCollections[he])||void 0===x?void 0:x.TemplateCategories[0])&&ae(be)}var _e=function(e){var t=W(e);return Object(C.useMemo)((function(){return{FlowchartCollection:null==t?void 0:t.flowchartTemplatesCollectionTitle,GeneralCollection:null==t?void 0:t.generalTemplatesCollectionTitle,InfographicsCollection:null==t?void 0:t.infographicsTemplatesCollectionTitle,NetworkCollection:null==t?void 0:t.networkTemplatesCollectionTitle,OrgChartCollection:null==t?void 0:t.orgChartTemplatesCollectionTitle,SoftwareCollection:null==t?void 0:t.softwareAndDBTemplatesCollectionTitle}}),[t])}(I),Te=Object(C.useMemo)((function(){var e=[];if(null==fe?void 0:fe.result){var t=function(e){var t=e.appName,a=e.templatePageData,n=e.templatePageResources,o=e.createTemplateHandler,i=e.calledFrom,c=e.navigateTo;return a?(a.TemplateCategories?Object.entries(a.TemplateCategories):[]).filter((function(e){var t=Object(r.__read)(e,2)[1],n=t.BlankTemplateAssetID?a.TemplatesData[t.BlankTemplateAssetID]:void 0;return n&&!n.IsPremium})).map((function(e){var l,s=Object(r.__read)(e,2),u=a.TemplatesData[s[1].BlankTemplateAssetID];return{cardTitle:u.Title,thumbnailUrl:$e(u),isBlank:!0,isPremium:null!==(l=u.IsPremium)&&void 0!==l&&l,hoverActions:at,hoverButtonProps:nt(u,a,t,[],n,o,c,i)}})):[]}({appName:I,templatePageData:fe.result,templatePageResources:V,createTemplateHandler:z,calledFrom:je.HomePage,navigateTo:K});t.length>0&&e.push.apply(e,Object(r.__spreadArray)([],Object(r.__read)(t),!1))}return e}),[I,z,K,V,fe]),ye=Object(C.useMemo)((function(){var e=[];return(null==fe?void 0:fe.result)&&e.push.apply(e,Object(r.__spreadArray)([],Object(r.__read)(function(e,t,a,n,r,o){if(!t)return[];var i=t.FeaturedTemplates?t.FeaturedTemplates.filter(():[];return null==i?void 0:i.map((function(c){var l,s=t.TemplatesData[c];return{cardTitle:s.Title,thumbnailUrl:$e(s),isBlank:Ve(s),isPremium:null!==(l=s.IsPremium)&&void 0!==l&&l,hoverActions:at,hoverButtonProps:nt(s,t,e,i,a,n,o,r)}}))}(I,fe.result,V,z,je.HomePage,K)),!1)),e}),[I,z,K,V,fe]),Ce=Object(s.a)("CreateOnTemplates",[I],P),Oe=Object(C.useMemo)((function(){var e,t=[];return(null==fe?void 0:fe.result)&&""!=te&&(t=function(e){var t,a,n,o,i=e.templatePageData,c=e.selectedCategoryId,l=e.appName,s=e.templatePageResources,u=e.createTemplateHandler,d=e.calledFrom,m=e.navigateTo,p=e.addCreateBlank,f=e.blankCreateLink,v="",g=[];if(i.TemplateCollections&&i.TemplateCategories){try{for(var b=Object(r.__values)(Object.keys(i.TemplateCollections)),h=b.next();!h.done;h=b.next()){var _=h.value,T=i.TemplateCollections[_];try{for(var y=(n=void 0,Object(r.__values)(T.TemplateCategories)),C=y.next();!C.done;C=y.next())if(C.value==c){v=_;break}}catch(e){n={error:e}}finally{try{C&&!C.done&&(o=y.return)&&o.call(y)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{h&&!h.done&&(a=b.return)&&a.call(b)}finally{if(t)throw t.error}}if(!v)return g;i.TemplateCollections[v].TemplateCategories.forEach((function(e){if(i.TemplateCategories){var t={subCategoryTitle:"",subCategoryTemplateCards:{templateCardArray:[]}},a=i.TemplateCategories[e].BlankTemplateAssetID,n=a?i.TemplatesData[a]:void 0,r=i.TemplateCategories[e].SamplesAssetID;n&&!n.IsPremium&&(t.subCategoryTitle=i.TemplateCategories[e].Name,t.subCategoryTemplateCards.templateCardArray.push(bt({templateInfo:n,isBlank:!0,templatePageData:i,appName:l,samplesAssetId:[],templatePageResources:s,createTemplateHandler:u,calledFrom:d,navigateTo:m}))),p&&"Default"===v&&f&&t.subCategoryTemplateCards.templateCardArray.push(function(e){var t=e.templatePageResources;return{cardTitle:t?null==t?void 0:t.blankTemplateText:"",thumbnailUrl:"",isBlank:!0,isPremium:!1,hoverActions:at,hoverButtonProps:rt(t,e.blankCreateLink)}}({templatePageResources:s,blankCreateLink:f})),n||(t.subCategoryTitle=i.TemplateCategories[e].Name),r.map((function(e){var a=i.TemplatesData[e],n=Ve(a);a.IsPremium||t.subCategoryTemplateCards.templateCardArray.push(bt({templateInfo:a,isBlank:n,templatePageData:i,appName:l,samplesAssetId:r,templatePageResources:s,createTemplateHandler:u,calledFrom:d,navigateTo:m}))})),g.push(t)}}))}return g}({templatePageData:fe.result,selectedCategoryId:te,appName:I,templatePageResources:V,createTemplateHandler:z,calledFrom:je.CategoryPage,navigateTo:K,addCreateBlank:null==N?void 0:N.addCreateBlank,blankCreateLink:null===(e=Ce[0])||void 0===e?void 0:e.onClick})),t}),[fe,te,I,V,z,K,null==N?void 0:N.addCreateBlank,Ce]),we=Object(C.useMemo)((function(){var e="";return(null==fe?void 0:fe.result)&&""!=te&&(e=null==fe?void 0:fe.result,te)),e}),[te,fe]);return G({canRender:!(!fe||!Q||!ve&&ge),dataResult:fe,paintMarker:"Paint_TemplatesPage"}),O.a.createElement("div",{className:ke.stageComponentDiv},ve||!ge?O.a.createElement("div",{className:ke.templateLoadingSpinner},O.a.createElement(o.a,{size:"huge"})):O.a.createElement(O.a.Fragment,null,(null==N?void 0:N.navigationEnabled)?O.a.createElement(Le,{app:I,selectedCategory:ht(te,null==fe?void 0:fe.result),selectedSubCategory:te,navigateToTemplateCategoryPage:K,templatesPageData:null==fe?void 0:fe.result,onSearch:function(e){oe(e),ae(""),se([])},context:Q,sharedContext:q,identity:X,searchQueryTerm:re,templateSearchEnabled:null==N?void 0:N.templatesSearchEnabled,templateTagsEnabled:null==N?void 0:N.templatesTagsEnabled,templatePageCollectionToLocStringModel:_e,addSelectedTagsToList:ue,removeSelectedTagsFromList:de,activeTagsArray:le}):null,0==le.length&&""===re?""===te?O.a.createElement(dt,{fileType:I,templateCards:{templateCardArray:Te},featuredCards:{templateCardArray:ye},navigateToStartPage:function(){null==Q||Q.router.navigateTo({route:"Start",app:I},!1)},moreTemplatesEnabled:null==N?void 0:N.moreTemplatesEnabled}):O.a.createElement(ct,{subCategories:Oe,backButtonOptions:{navigateToTemplatePage:Z,disabled:null==N?void 0:N.removeBackButton},selectedCategoryTitle:we,selectedCollectionName:_e[ht(te,null==fe?void 0:fe.result)]}):O.a.createElement(gt,{queryTerm:re,context:Q,sharedContext:q,identity:X,templatesPageData:null==fe?void 0:fe.result,appName:I,templatePageResources:V,createTemplateHandler:z,navigateTo:K,navigateToTemplatePage:Z,activeTagsList:le,removeSelectedTagsFromPivotsControl:me})))}},mJu7:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("u9fO");function r(e,t,a){return a?Object(n.a)(e,"login_hint",t):e}},mpo9:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return m}));var n,r,o,i=a("E7ar"),c=a("8wW2"),l=!1;function s(){if(!l){l=!0;var e=void 0;try{e=Object(i.a)("userStorageCache")}catch(e){Object(c.a)().handleError(e)}n=e?e.content:{},r=!!e&&e.firstUse,o=e?e.firstUseTimestamp:0}}function u(){return s(),n}function d(){return s(),r},nLxx:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("TImb");function r(e,t,a,r){var o=r?a?"TEMPLATES-INSTANT":"TEMPLATES":a?"NEW-INSTANT":"NEW";return Object(n.a)(e,t,o)}},nX9G:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a("QjXU"),r=a("MJsD"),o=a("yQST"),i=a("/Oio"),c=void 0;function l(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return c?[3,4]:[4,Object(r.a)()];case 1:return(e=t.sent()).workload===i.a.Hwa||Object(o.a)()?[4,Promise.all([a.e(51),a.e(649)]).then(a.bind(null,"N3Xl")).then((function(t){return{launchFile:t.getLaunchFileFunc(e),launchInDesktopApps:t.launchInDesktopApps,launchTemplate:t.launchTemplate,openFileInExplorer:t.openFileInExplorer}}))]:[3,3];case 2:return c=t.sent(),[3,4];case 3:c={launchFile:function(){return Promise.reject()},launchInDesktopApps:function(){return Promise.reject()},launchTemplate:function(){return Promise.reject()},openFileInExplorer:function(){return Promise.reject()}},t.label=4;case 4:return[2,c]}}))}))}},niq1:function(e,t,a){"use strict";var n=function(e){var t,a=new Set,n=r=function(){return t},o={setState:n,getState:r,subscribe:destroy:;return t=e(n,r,o),o},r=t.createStore=r,t.default=function(e){return r(e)},e.exports=t&&t.default||{},Object.assign(e.exports,t)},ovfp:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("8wW2"),r=a("Wa5Y"),o=new Map;function i(e,t,a,i,c,l,s,u,d){void 0===l&&(l="None");var m="".concat(a,"/").concat(i),p=function(e){if(o.has(e)){var t=o.get(e);if(t&&t.promise&&(!t.expiryTime||t.expiryTime>new Date))return t.promise;o.delete(e)}return null}(m);if(p)return p;var f={headers:{accept:"application/json",Prefer:"allow-zerobyte",application:"officehome"}},v=new Promise((function(o,m){u&&f.headers&&(f.headers.scenario=u),d&&f.headers&&(f.headers.scenarioType=d),Object(r.a)(e,t,a,f,c.jwtAuthEnabled||!1,c.getAccessToken,c.officeHomeApiRoot,c.correlationId,l,{resourceUrl:s},i).then((function(e){e&&e.data?o(e.data):m({clientError:"No data returned"})})).catch((function(e){Object(n.a)().handleError(e,"QYFpr")}))}));return o.set(m,{promise:v}),v}},paN7:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a("zoEv"),r=a("sOgh"),o=a("mXGw"),i=a("JSHo"),c=a("+sqR"),l=new RegExp("([^\\s]*".concat(n.a.root,"\\w+)"));function s(e){var t,a=Object(c.a)(),n=Object(o.useRef)(null);return(null===(t=Object(r.a)({theme:Object(i.a)(a,e),targetDocument:document},n).themeClassName)||void 0===t?void 0:t.split(" ").find(())||""}},"q+lz":function(e,t,a){"use strict";var n=a("wBwe");t.a=a.n(n).a},q3UB:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("mXGw"),r=a("elnK"),o=a.n(r)()((function(e){return{windowSize:{width:0,height:0},setWindowSize:})),i=function(){var e=o();return Object(n.useEffect)((function(){var t=return window.addEventListener("resize",t),t(),),[]),Object(n.useMemo)((function(){return e.windowSize}),[e.windowSize])}},qPzc:qecA:function(e,t,a){"use strict";function n(e){var t;return(null===(t=e.Application)||void 0===t?void 0:t.toLowerCase())||""}a.d(t,"a",(function(){return n}))},qyk8:function(e,t,a){"use strict";function n(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(!e)return e;for(var n=e,r=function(e){var a=new RegExp("\\{"+e+"\\}","gi");n=n.replace(a,()},o=0;o<t.length;o++)r(o);return n}a.d(t,"a",(function(){return n}))},rZux:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("QjXU"),r=a("nX9G"),o=function(e,t){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){return Object(n.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(r.a)()];case 1:return[2,(0,a.sent().launchTemplate)(e,t)]}}))}))}},rjBA:function(e,t,a){"use strict";function n(e){if(!e)return e;var t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)}a.d(t,"a",(function(){return n}))},s32E:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("a3FV"),r=a("V1Qu"),o=a("ovfp");function i(e,t,a,i,c,l){if(void 0===i&&(i="network-first"),!t||!e||!e.sharePointResourceId)return Promise.reject("No driveId or no sharePointResourceId");var s=Object(r.j)(["id","name","folder","webUrl","webDavUrl"],!1,!0),u=a?"items/".concat(encodeURIComponent(a),"/"):"root/",d=e.inMockMode&&!e.isConsumer?function(){return a?"EmptyFolder"!==a?"".concat(e.officeHomeApiRoot,"/_api/v2.0/drives/mockenterprisetemplateitem"):"":"".concat(e.officeHomeApiRoot,"/_api/v2.0/drives/enterprisetemplates")}():"".concat(Object(r.e)(e.sharePointResourceId,e),"/drives/").concat(encodeURIComponent(t),"/").concat(u,"children").concat(s?"?"+s:"");return Object(o.a)(n.a.VroomItemRequest,"Vroom_Item",d,i,e,"SharePoint",e.sharePointResourceId,c,l)}},sLEy:sYGy:skfY:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=,slmW:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("6ib3");,tBub:function(e,t,a){"use strict";function n(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)}a.d(t,"a",(function(){return n}))},ubt0:vaZn:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("h8qh"),r=function(){var e=Object(n.a)().data,t=null==e?void 0:e.storageErrorResources;if(e&&t)return t}},vrqo:wBwe:wK4g:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a("mXGw"),r=a.n(n),o=a("+9uq"),i=a("XrJr"),c=a("85o7"),l=a("duEa"),s=a("XxaS"),u=a("OeRt"),d=a("PmtM"),m=a("iTb/"),p=a("cipv"),f=function(e){var t=e.className,a=e.primaryFill,n=function(e){switch(e){case"List":return o.u;case"ListActive":return o.t;case"Grid":return i.r;case"GridActive":return i.q;case"UpArrow":return c.l;case"ArrowRight":return l.U;case"CubeShape":return s.j;case"CubeShapeActive":return s.i;case"Clock":return u.F;case"ClockActive":return u.E;case"People":return d.b;case"PeopleActive":return d.a;case"FavoriteStar":return m.p;case"FavoriteStarActive":return m.o;case"Document":return s.F;case"DocumentActive":return s.E;case"Folder":return i.e;case"FolderActive":return i.d;case"Person":return d.l;case"PersonActive":return d.k;case"ChevronDown":return u.k;case"ChevronDownActive":return u.j;case"Add":return l.c;case"AddActive":return l.b;case"Dismiss":return s.v;case"DismissActive":return s.u;case"Tag":return p.h;case"TagActive":return p.g;case"Layer":return o.q;case"LayerActive":return o.p;default:return m.p}}(e.iconName);return r.a.createElement("span",{className:t},r.a.createElement(n,{primaryFill:a}))}},wYzw:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("yEz2"),r=a("mpo9");function o(){if(Object(r.c)())return 0;var e=Object(r.a)();return void 0===e||e<0?-1:Math.floor(Object(n.a)(e))}},xvrq:function(e,t,a){"use strict";function n(){var e=t=new Promise(();return{cancel:e,onCancel:}a.d(t,"a",(function(){return n}))},y8H0:yEz2:function(e,t,a){"use strict";function n(e){return(Date.now()-e)/864e5}a.d(t,"a",(function(){return n}))},zPk6:function(e,t,a){"use strict";.d(t,"a",(function(){return n}))},zu5k:zvGb:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return c}));const n="undefined"!=typeof WeakRef;class r{eref(){var e,t,a;let n;return this._weakRef?(n=null===(e=this._weakRef)||void 0===e?void 0:e.deref(),n||delete this._weakRef):(n=this._instance,(null===(a=null===(t=n)||void 0===t?void 0:t.isDisposed)||void 0===a?void 0:a.call(t))&&delete this._instance),n}}const o="keyborg:focusin";let i=!1;et l=0;class s{Val(e){if(this._isNavigatingWithKeyboard!==e){this._isNavigatingWithKeyboard=e;for(const t of Object.keys(this.__keyborgCoreRefs)){const a=this.__keyborgCoreRefs[t].deref();a?a.update(e):this.remove(t)}}}const u=new s;class d{constructor(e,t){this._isMouseUsed=!1,this._onFocusIn=e=>{if(this._isMouseUsed)return void(this._isMouseUsed=!1);if(u.getVal())return;const t=e.details;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||u.setVal(!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||(this._isMouseUsed=!0,u.setVal(!1))},this._onKeyDown=e=>{var t;const a=u.getVal(),n=e.keyCode,r=this._triggerKeys;a||r&&!r.has(n)?a&&(null===(t=this._dismissKeys)||void 0===t?void 0:t.has(n))&&this._scheduleDismiss():u.setVal(!0)},this.id="c"+ ++l,this._win=e;const a=e.document;if(t){const e=t.triggerKeys,a=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==a?void 0:a.length)&&(this._dismissKeys=new Set(a))}a.addEventListener(o,this._onFocusIn,!0),a.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),function(e){const t=e;i||(i=function(e){const t=e.HTMLElement,a=t.prototype.focus;let n=!1;return t.prototype.focus=e.document.createElement("button").focus(),t.prototype.focus=a,n}(t));const a=t.HTMLElement.prototype.focus;if(a.__keyborgNativeFocus)return;t.HTMLElement.prototype.focus=c;const n=t.__keyborgData={focusInHandler:;.document.addEventListener("focusin",t.__keyborgData.focusInHandler,!0),c.__keyborgNativeFocus=a}(e),u.add(this)}disposess m{constructor(e,t){this._cb=[],this._id="k"+ ++l,this._win=e;const a=e.__keyborg;a?(this._core=a.core,a.refs[this._id]=this):(this._core=new d(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})} f(e){m.dispose(e)}}}]);
//# sourceMappingURL=template-stage-component.37041ad134f5721ba94f.chunk.v7.js.map