// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
(function(a,h){var p,m=function(){},f=e={}.toString,l=function(d){return"[object Function]"==e.call(d)},g=function(d){return"[object String]"==e.call(d)},c=function(d){return"[object Array]"==e.call(d)},b=q=x=y=1,t=u=r=this,n=r.document,
w=n&&n.createElement("DiV"),d=u.has=k=d.cache=h.hasCache;d.add=d.add("host-webworker","undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);d("host-webworker")&&(q(h.hasCache,{"host-browser":0,dom:0,"dojo-dom-ready-api":0,"dojo-sniff":0,"dojo-inject-api":1,"host-webworker":1,"dojo-guarantee-console":0}),h.loaderPatch={injectUrl:);for(var v in a.has)d.add(v,a.has[v],0,1);u.async=1;var A=d("csp-restrictions")?function(){}:new Function("return eval(arguments[0]);");u.eval=var z={},D=u.signal=B=u.on=C=[],F={},K=[],M={},E=u.map={},V=[],P=
{},I="",J={},Q={};v={};var S=0,ga=L=R=U=T=N=[],Z=
if(d("dojo-cdn")){var H=n.getElementsByTagName("script");p=0;for(var O,aa,ba,X;p<H.length;)if(O=H[p++],(ba=O.getAttribute("src"))&&(X=ba.match(/(((.*)\/)|^)dojo\.js(\W|$)/i))&&(aa=X[3]||"",h.baseUrl=h.baseUrl||aa,S=O),ba=O.getAttribute("data-dojo-config")||O.getAttribute("djConfig"))v=u.eval("({ "+ba+" })","data-dojo-config"),S=O}u.rawConfig={};Z(h,1);d("dojo-cdn")&&((M.dojo.location=aa)&&(aa+="/"),M.dijit.location=aa+"../dijit/",M.dojox.location=aa+"../dojox/");Z(a,1);Z(v,1);var ea=la=ta=ma=[],wa=[],na={},sa=Ea=pa=u.idle=qa=ua=va=Ca=function(d,k,n,v,c,g,e,q,a){var r,t,f,u;u=/^\./.test(d);if(/(^\/)|(\:)|(\.js$)/.test(d)||u&&!k)return va(0,d,0,d);d=ua(u?k.mid+"/../"+d:d);if(/^\./.test(d))throw x("irrationalPath",d);k&&(f=qa(k.mid,g));(f=(f=f||g.star)&&qa(d,f[1]))&&(d=f[1]+d.substring(f[3]));k=(X=d.match(/^([^\/]+)(\/(.+))?$/))?X[1]:"";(r=n[k])?d=k+"/"+
(t=X[3]||r.main):k="";var w=0;b(q,;if(w)return Ca(w,0,n,v,c,g,e,q,a);if(n=v[d])return a?va(n.pid,n.mid,n.pack,n.url):v[d];v=(f=qa(d,e))?f[1]+d.substring(f[3]):k?r.location+"/"+t:d;/(^\/)|(\:)/.test(v)||(v=c+v);return va(k,d,r,ua(v+".js"))},Fa=Aa=W=0,Ka=Ra=u.toAbsMid=Ua=u.toUrl=La={injected:2,executed:5,def:3,result:3};aa=var Sa=aa("require"),da=aa("exports"),Ja=aa("module"),za={},ja=0,Qa=xa=ra=Pa=[],ca=ya=0,G=ka=void 0===d("dojo-loader-eval-hint-url")&&d.add("dojo-loader-eval-hint-url",
1);var oa="function"==typeof a.fixupUrl?a.fixupUrl:Ba=ha=0,ia=0,Y=0,tb=function(k,b){d("config-stripStrict")&&(k=k.replace(/(["'])use strict\1/g,""));Y=1;k===ha?ha.call(null):u.eval(k,d("dojo-loader-eval-hint-url")?b.url:b.mid);Y=0},mb=function(k){var b=
k.mid,n=k.url;if(!(k.executed||k.injected||na[b]||k.url&&(k.pack&&na[k.url]===k.pack||1==na[k.url])))if(sa(k),k.plugin)Ba(k);else{var v=(ha=J[b]||J["url:"+k.url])?(u.trace("loader-inject",["cache",k.mid,n]),tb(ha,k),v()):(u.trace("loader-inject",["script",k.mid,n]),ia=k,u.injectUrl(oa(n),v,k),ia=0)}},jb=ub=Va=m,sb=m;d("dom")&&d.add("ie-event-behavior",
n.attachEvent&&"undefined"===typeof Windows&&("undefined"===typeof opera||"[object Opera]"!=opera.toString()));if(d("dom")){var ob=vb=ob(window,"load","onload",,H=n.getElementsByTagName("script");for(p=0;!S;)/^dojo/.test((O=
H[p++])&&O.type)||(S=O);u.injectUrl=u.log=m;u.trace=m;O=function(k,b,n){var v=arguments.length,c=["require",
"exports","module"],e=[0,k,b];1==v?e=[0,l(k)?c:[],k]:2==v&&g(k)?e=[k,l(b)?c:[],b]:3==v&&(e=[k,b,n]);u.trace("loader-define",e.slice(0,2));if((v=e[0]&&Ka(e[0]))&&!na[v.mid])ea(jb(v,e[1],e[2]));else if(d("ie-event-behavior")&&d("host-browser")&&!Y){v=v||ia;if(!v)for(k in na)if((c=P[k])&&c.node&&"interactive"===c.node.readyState){v=c;break}v?(ga(v),ea(jb(v,e[1],e[2]))):D("error",x("ieDefineFailed",e[0]));ka()}else wa.push(e)};O.amd={vendor:"dojotoolkit.org"};q(q(u,h.loaderPatch),a.loaderPatch);B("error",
;q(u,{uid:t,cache:J,packs:M});r.define||(r.define=O,r.require=u,b(N,function(d){Z(d)}),B=v.deps||a.deps||h.deps,a=v.callback||a.callback||h.callback,u.boot=B||a?[B||[],a]:0)})(this.dojoConfig||this.djConfig||this.require||{},{aliases:[[/^webgl-engine/,function(){return"esri/views/3d/webgl-engine"}],[/^engine/,function(){return"esri/views/3d/webgl-engine"}],[/^esri-hydra/,function(){return"esri"}]],
async:1,baseUrl:(location.protocol === 'file:' ? 'http:' : location.protocol) + '//' + "js.arcgis.com/4.3/dojo",hasCache:{"config-deferredInstrumentation":0,"config-selectorEngine":"acme","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-has-api":1,"dojo-loader":1,"dojo-undef-api":0,dom:1,"host-browser":1},packages:[{location:".",name:"dojo"},{location:"../dijit",name:"dijit"},{location:"../dojox",name:"dojox"},{location:"../dgrid",main:"OnDemandGrid",name:"dgrid"},{location:"../dstore",main:"Store",name:"dstore"},{location:"../esri",name:"esri"},{location:"../moment",
main:"moment",name:"moment"}]});
require({cache:{"dojo/domReady":function(){define(["./has"],function(a){r m=function(){return this}(),f=document,e={loaded:1,complete:1},l="string"!=typeof f.readyState,g=!!e[f.readyState],c=[],b;h.load=h._Q=c;h._onQEmpty=function(){};l&&(f.readyState="loading");if(!g){var q=[],x=y=if(!a("dom-addeventlistener")){var y=t=f.createElement("div");try{t.doScroll&&null===m.frameElement&&q.push(}catch(r){}}y(f,"DOMContentLoaded");y(m,"load");"onreadystatechange"in f?y(f,"readystatechange"):
l||q.push(;if(q.length){var u=u()}}return h})},"dojo/has":function(){define(["require","module"],function(a,h){var p=a.has||function(){};if(!p("dojo-has-api")){a="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location==location&&window.document==document;var m=function(){return this}(),f=a&&document,e=f&&f.createElement("DiV"),
l=h.config&&h.config()||{},p=p.cache=l;p.add=p.add("host-browser",a);p.add("dom",a)}p("host-browser")&&(p.add("dom-addeventlistener",!!document.addEventListener),p.add("touch","ontouchstart"in document||"onpointerdown"in document&&0<navigator.maxTouchPoints||window.navigator.msMaxTouchPoints),p.add("touch-events","ontouchstart"in document),p.add("pointer-events",
"pointerEnabled"in window.navigator?window.navigator.pointerEnabled:"PointerEvent"in window),p.add("MSPointer",window.navigator.msPointerEnabled),p.add("touch-action",p("touch")&&p("pointer-events")),p.add("device-width",screen.availWidth||innerWidth),h=document.createElement("form"),p.add("dom-attributes-explicit",0==h.attributes.length),p.add("dom-attributes-specified-flag",0<h.attributes.length&&40>h.attributes.length));p.clearElement=p.normalize=p.load=return p})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),function(a,h,p,m,f,e,l,g,c,b){h.deprecated("dojo/io/script","Use dojo/request/script.","2.0");
var q={get:function(g){var a,t=this._makeScriptDeferred(g,function(b){a&&a.cancel()}),f=t.ioArgs;e._ioAddQueryToUrl(f);e._ioNotifyStart(t);a=c.get(f.url,{timeout:g.timeout,jsonp:f.jsonp,checkString:g.checkString,ioArgs:f,frameDoc:g.frameDoc,canAttach:function(b){f.requestId=b.id;f.scriptId=b.scriptId;f.canDelete=b.canDelete;return q._canAttach(f)}},!0);b.around(a,"isValid",;a.then(function(){t.resolve(t)}).otherwise(;return t},attach:c._attach,remove:c._remove,_makeScriptDeferred:function(b,g){g=e._ioSetArgs(b,g||this._deferredCancel,this._deferredOk,this._deferredError);var a=g.ioArgs;a.id=h._scopeName+"IoScript"+(b.callbackSuffix||this._counter++);a.canDelete=!1;a.jsonp=b.callbackParamName||b.jsonp;a.jsonp&&(a.query=a.query||"",0<a.query.length&&(a.query+="\x26"),a.query+=a.jsonp+"\x3d"+(b.frameDoc?"parent.":"")+h._scopeName+".io.script.jsonp_"+a.id+"._jsonpCallback",a.frameDoc=b.frameDoc,a.canDelete=
!0,g._jsonpCallback=this._jsonpCallback,this["jsonp_"+a.id]=g);g.addBoth(function(b){a.canDelete&&(b instanceof Error?q["jsonp_"+a.id]._jsonpCallback=function(){delete q["jsonp_"+a.id];if(a.requestId)h.global[c._callbacksProperty][a.requestId]()}:q._addDeadScript(a))});return g},_deferredCancel:function(b){b.canceled=!0},_deferredOk:function(b){b=b.ioArgs;return b.json||b.scriptLoaded||b},_deferredError:_deadScripts:[],_counter:1,_addDeadScript:function(b){q._deadScripts.push({id:b.id,
frameDoc:b.frameDoc});b.frameDoc=null},_validCheck:function(b){if((b=q._deadScripts)&&0<b.length){for(var c=0;c<b.length;c++)q.remove(b[c].id,b[c].frameDoc),delete q["jsonp_"+b[c].id],b[c].frameDoc=null;q._deadScripts=[]}return!0},_ioCheck:function(b){b=b.ioArgs;return b.json||b.scriptLoaded&&!b.args.checkString?!0:(b=b.args.checkString)&&eval("typeof("+b+") !\x3d 'undefined'")},_resHandle:function(b){q._ioCheck(b)?b.callback(b):b.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},
_jsonpCallback:function(b){this.ioArgs.json=b;if(this.ioArgs.requestId)h.global[c._callbacksProperty][this.ioArgs.requestId](b)}};p.setObject("dojo.io.script",q);return q})},"dojo/_base/connect":"dojo/_base/kernel":function(){define(["../has","./config","require","module"],function(a,h,p,m){var f,e=function(){return this}(),l={},g={},c={config:h,global:e,dijit:l,dojox:g},l={dojo:["dojo",c],dijit:["dijit",l],dojox:["dojox",g]};
m=p.map&&p.map[m.id.match(/[^\/]+/)[0]];for(f in m)l[f]?l[f][0]=m[f]:l[f]=[m[f],{}];for(f in l)m=l[f],m[1]._scopeName=m[0],h.noGlobals||(e[m[0]]=m[1]);c.scopeMap=l;c.baseUrl=c.config.baseUrl=p.baseUrl;c.isAsync=p.async;c.locale=h.locale;h="$Rev: a1e2d9d $".match(/[0-9a-f]{7,}/);c.version={major:1,minor:12,patch:1,flag:"",revision:h?h[0]:NaN,toString:;a("csp-restrictions")||Function("d","d.eval \x3d function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(c);
c.exit=function(){};a("host-webworker");a.add("console-as-object",;"undefined"!=typeof console||(console={});p="assert count debug dir dirxml error group groupEnd info profile profileEnd time timeEnd trace warn log".split(" ");var b;for(h=0;b=p[h++];)console[b]?a("console-as-object")&&(console[b]=Function.prototype.bind.call(console[b],console)):);c.deprecated=c.experimental=function(){};c._hasResource={};return c})},"dojo/_base/config":function(){define(["../has","require"],function(a,h){a={};h=h.rawConfig;for(var p in h)a[p]=h[p];!a.locale&&"undefined"!=typeof navigator&&(p=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage)&&(a.locale=p.toLowerCase());return a})},"dojo/on":function(){define(["./has!dom-addeventlistener?:./aspect",
"./_base/kernel","./sniff"],function(a,h,p){p("dom")){var l=window.ScriptEngineMajorVersion;p.add("jscript",l&&l()+ScriptEngineMinorVersion()/10);p.add("event-orientationchange",p("touch")&&!p("android"));p.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);p.add("event-focusin",;p("touch")&&p.add("touch-can-modify-event-delegate",}var g=g.pausable=g.once=g.parse=var c=/^touch/;g.matches=g.selector=
var b=[].slice,q=g.emit=x=p("event-focusin")?{}:{focusin:"focus",focusout:"blur"};if(!p("event-stopimmediatepropagation"))var y=function(){this.modified=this.immediatelyStopped=!0},t=if(p("dom-addeventlistener"))g.emit=else{g._fixEvent=var u,r=function(d){this.handle=d};r.prototype.remove=var n=w=d=function(){this.cancelBubble=!0},k=g._preventDefault=if(p("touch"))var v=function(){},A=window.orientation,z=return g})},"dojo/sniff":function(){define(["./has"],function(a){if(a("host-browser")){var h=
navigator,p=h.userAgent,h=h.appVersion,m=parseFloat(h);a.add("air",0<=p.indexOf("AdobeAIR"));a.add("wp",parseFloat(p.split("Windows Phone")[1])||void 0);a.add("msapp",parseFloat(p.split("MSAppHost/")[1])||void 0);a.add("khtml",0<=h.indexOf("Konqueror")?m:void 0);a.add("edge",parseFloat(p.split("Edge/")[1])||void 0);a.add("opr",parseFloat(p.split("OPR/")[1])||void 0);a.add("webkit",!a("wp")&&!a("edge")&&parseFloat(p.split("WebKit/")[1])||void 0);a.add("chrome",!a("edge")&&!a("opr")&&parseFloat(p.split("Chrome/")[1])||
void 0);a.add("android",!a("wp")&&parseFloat(p.split("Android ")[1])||void 0);a.add("safari",!(0<=h.indexOf("Safari"))||a("wp")||a("chrome")||a("android")||a("edge")||a("opr")?void 0:parseFloat(h.split("Version/")[1]));a.add("mac",0<=h.indexOf("Macintosh"));a.add("quirks","BackCompat"==document.compatMode);if(!a("wp")&&p.match(/(iPhone|iPod|iPad)/)){var f=RegExp.$1.replace(/P/,"p"),e=p.match(/OS ([\d_]+)/)?RegExp.$1:"1",e=parseFloat(e.replace(/_/,".").replace(/_/g,""));a.add(f,e);a.add("ios",e)}a.add("bb",
(0<=p.indexOf("BlackBerry")||0<=p.indexOf("BB10"))&&parseFloat(p.split("Version/")[1])||void 0);a.add("trident",parseFloat(h.split("Trident/")[1])||void 0);a.add("svg","undefined"!==typeof SVGAngle);a("webkit")||(0<=p.indexOf("Opera")&&a.add("opera",9.8<=m?parseFloat(p.split("Version/")[1])||m:m),!(0<=p.indexOf("Gecko"))||a("wp")||a("khtml")||a("trident")||a("edge")||a.add("mozilla",m),a("mozilla")&&a.add("ff",parseFloat(p.split("Firefox/")[1]||p.split("Minefield/")[1])||void 0),document.all&&!a("opera")&&
(p=parseFloat(h.split("MSIE ")[1])||void 0,(h=document.documentMode)&&5!=h&&Math.floor(p)!=h&&(p=h),a.add("ie",p)),a.add("wii","undefined"!=typeof opera&&opera.wiiremote))}return a})},"dojo/topic":"dojo/Evented":"dojo/aspect":"dojo/_base/event":"dojo/dom-geometry":function(){define(["./sniff","./_base/window","./dom","./dom-style"],function(a,h,p,m){ g={boxModel:"content-box"};a("ie")&&(g.boxModel="BackCompat"==document.compatMode?"border-box":"content-box");g.getPadExtents=function(b,c){b=p.byId(b);var e=c||m.getComputedStyle(b),g=m.toPixelValue;c=g(b,e.paddingLeft);var q=g(b,e.paddingTop),a=g(b,e.paddingRight);b=g(b,e.paddingBottom);return{l:c,
t:q,r:a,b:b,w:c+a,h:q+b}};g.getBorderExtents=g.getPadBorderExtents=g.getMarginExtents=g.getMarginBox=g.getContentBox=function(b,c){b=p.byId(b);var e=c||m.getComputedStyle(b);c=b.clientWidth;var q,f=g.getPadExtents(b,e);q=g.getBorderExtents(b,e);var e=b.offsetLeft+f.l+q.l,u=b.offsetTop+f.t+q.t;c?q=b.clientHeight:(c=b.offsetWidth-q.w,q=b.offsetHeight-q.h);if(8==a("ie")&&!a("quirks")){var r=b.parentNode,n=m.toPixelValue;r&&(r=m.getComputedStyle(r),
e-="none"!=r.borderLeftStyle?n(b,r.borderLeftWidth):0,u-="none"!=r.borderTopStyle?n(b,r.borderTopWidth):0)}return{l:e,t:u,w:c-f.w,h:q-f.h}};g.setContentSize=var c={l:0,t:0,w:0,h:0};g.setMarginBox=g.isBodyLtr=g.docScroll=g.getIeDocumentElementOffset=
g.fixIeBiDiScrollLeft=g.position=function(b,c){b=p.byId(b);var e=h.body(b.ownerDocument),q=b.getBoundingClientRect(),q={x:q.left,y:q.top,w:q.right-q.left,h:q.bottom-q.top};9>a("ie")&&(q.x-=a("quirks")?e.clientLeft+
e.offsetLeft:0,q.y-=a("quirks")?e.clientTop+e.offsetTop:0);c&&(b=g.docScroll(b.ownerDocument),q.x+=b.x,q.y+=b.y);return q};g.getMarginSize=g.normalizeEvent=function(b){"layerX"in b||(b.layerX=b.offsetX,b.layerY=b.offsetY);if(!("pageX"in b)){var c=b.target,c=c&&c.ownerDocument||document,e=a("quirks")?c.body:c.documentElement;b.pageX=b.clientX+g.fixIeBiDiScrollLeft(e.scrollLeft||
0,c);b.pageY=b.clientY+(e.scrollTop||0)}};return g})},"dojo/_base/window":"dojo/_base/lang":function(){define(["./kernel",
"../has","../sniff"],function(a,h){h.add("bug-for-in-skips-shadowed",;var p=h("bug-for-in-skips-shadowed")?"hasOwnProperty valueOf isPrototypeOf propertyIsEnumerable toLocaleString toString constructor".split(" "):[],m=p.length,f=e=Object.prototype.toString,
l=g=/\{([^\}]+)\}/g,c={_extraNames:p,_mixin:mixin:setObject:getObject:exists:isString:isArray:Array.isArray||isFunction:isObject:isArrayLike:isAlien:extend:_hitchArgs:hitch:delegate:),_toArray:h("ie")?):l,partial:clone:trim:String.prototype.trim?function(b){return b.trim()}:function(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:;c.mixin(a,c);return c})},"dojo/dom":"dojo/dom-style":function(){define(["./sniff","./dom","./_base/window"],function(a,h,p){ar f,e={};f=a("webkit")?a("ie")&&(9>a("ie")||a("quirks"))?e.getComputedStyle=f;var l;l=a("ie")?e.toPixelValue=l;var g=c=9>a("ie")||10>a("ie")&&a("quirks")?b=9>a("ie")||10>a("ie")&&a("quirks")?q={left:!0,top:!0},x=/margin|padding|width|height|max|min|offset/,y={cssFloat:1,styleFloat:1,"float":1};
e.get=e.set=return e})},"dojo/mouse":"dojo/_base/sniff":function(){define(["./kernel","./lang","../sniff"],function(a,h,p){if(!p("host-browser"))return p;a._name="browser";h.mixin(a,{isBrowser:!0,isFF:p("ff"),isIE:p("ie"),isKhtml:p("khtml"),isWebKit:p("webkit"),isMozilla:p("mozilla"),isMoz:p("mozilla"),
isOpera:p("opera"),isSafari:p("safari"),isChrome:p("chrome"),isMac:p("mac"),isIos:p("ios"),isAndroid:p("android"),isWii:p("wii"),isQuirks:p("quirks"),isAir:p("air")});return p})},"dojo/keys":"dojo/_base/xhr":function(){define("./kernel ./sniff require ../io-query ../dom ../dom-form ./Deferred ./config ./json ./lang ./array ../on ../aspect ../request/watch ../request/xhr ../request/util".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r){a._xhrObj=u._create;var n=a.config;a.objectToQuery=m.objectToQuery;a.queryToObject=m.queryToObject;a.fieldToObject=e.fieldToObject;a.formToObject=e.toObject;a.formToQuery=e.toQuery;a.formToJson=e.toJson;a._blockAsync=!1;h.add("native-xhr2-blob",
function(){if(h("native-xhr2")){var d=new XMLHttpRequest;d.open("GET","/",!0);d.responseType="blob";var k=d.responseType;d.abort();return"blob"===k}});var w=a._contentHandlers=a.contentHandlers={text:function(d){return d.responseText},json:function(d){return c.fromJson(d.responseText||null)},"json-comment-filtered":javascript:function(d){return a.eval(d.responseText)},xml:"json-comment-optional":;h("native-xhr2")&&(w.arraybuffer=w.blob=w.document=;a._ioSetArgs=function(d,k,c,
v){var g={args:d,url:d.url},q=null;if(d.form){var q=f.byId(d.form),r=q.getAttributeNode("action");g.url=g.url||(r?r.value:a.doc?a.doc.URL:null);q=e.toObject(q)}r=[{}];q&&r.push(q);d.content&&r.push(d.content);d.preventCache&&r.push({"dojo.preventCache":(new Date).valueOf()});g.query=m.objectToQuery(b.mixin.apply(null,r));g.handleAs=d.handleAs||"text";var t=new l(;
t.addCallback(c);var u=d.load;u&&b.isFunction(u)&&t.addCallback(function(k){return u.call(d,k,g)});var x=d.error;x&&b.isFunction(x)&&t.addErrback(function(k){return x.call(d,k,g)});var w=d.handle;w&&b.isFunction(w)&&t.addBoth(function(k){return w.call(d,k,g)});t.addErrback(function(d){return v(d,t)});n.ioPublish&&a.publish&&!1!==g.args.ioPublish&&(t.addCallbacks(function(d){a.publish("/dojo/io/load",[t,d]);return d},function(d){a.publish("/dojo/io/error",[t,d]);return d}),t.addBoth();t.ioArgs=g;return t};var d=k=v=A=0;y.after(t,"_onAction",;y.after(t,"_onInFlight",v);a._ioCancelAll=t.cancelAll;a._ioNotifyStart=a._ioWatch=a._ioAddQueryToUrl=a.xhr=function(b,n,c){var v,e=a._ioSetArgs(n,function(d){v&&v.cancel()},d,k),g=e.ioArgs;"postData"in n?g.query=n.postData:"putData"in n?g.query=
n.putData:"rawBody"in n?g.query=n.rawBody:(2<arguments.length&&!c||-1==="POST|PUT".indexOf(b.toUpperCase()))&&a._ioAddQueryToUrl(g);var q;h("native-xhr2")&&(q={arraybuffer:1,blob:1,document:1});q=h("native-xhr2")&&q[n.handleAs]?n.handleAs:"text";"blob"!==q||h("native-xhr2-blob")||(q="arraybuffer");q={method:b,handleAs:q,responseType:n.responseType,timeout:n.timeout,withCredentials:n.withCredentials,ioArgs:g};"undefined"!==typeof n.headers&&(q.headers=n.headers);"undefined"!==typeof n.contentType&&
(q.headers||(q.headers={}),q.headers["Content-Type"]=n.contentType);"undefined"!==typeof g.query&&(q.data=g.query);"undefined"!==typeof n.sync&&(q.sync=n.sync);a._ioNotifyStart(e);try{v=u(g.url,q,!0)}catch(E){return e.cancel(),e}e.ioArgs.xhr=v.response.xhr;v.then(function(){e.resolve(e)}).otherwise(;return e};a.xhrGet=function(d){return a.xhr("GET",d)};a.rawXhrPost=a.xhrPost=
function(d){return a.xhr("POST",d,!0)};a.rawXhrPut=a.xhrPut=a.xhrDelete=function(d){return a.xhr("DELETE",d)};a._isDocumentOk=function(d){return r.checkStatus(d.status)};a._getText=b.mixin(a.xhr,{_xhrObj:a._xhrObj,fieldToObject:e.fieldToObject,formToObject:e.toObject,objectToQuery:m.objectToQuery,formToQuery:e.toQuery,formToJson:e.toJson,queryToObject:m.queryToObject,contentHandlers:w,
_ioSetArgs:a._ioSetArgs,_ioCancelAll:a._ioCancelAll,_ioNotifyStart:a._ioNotifyStart,_ioWatch:a._ioWatch,_ioAddQueryToUrl:a._ioAddQueryToUrl,_isDocumentOk:a._isDocumentOk,_getText:a._getText,get:a.xhrGet,post:a.xhrPost,put:a.xhrPut,del:a.xhrDelete});return a.xhr})},"dojo/io-query":"dojo/dom-form":"dojo/json":"dojo/_base/Deferred":"dojo/Deferred":function(){define(["./has","./_base/lang","./errors/CancelError","./promise/Promise",
"./has!config-deferredInstrumentation?./promise/instrumentation"],},"dojo/errors/CancelError":"dojo/errors/create":"dojo/promise/Promise":"dojo/when":"dojo/_base/json":"dojo/_base/array":"dojo/request/watch":"dojo/request/util":function(){define("exports ../errors/RequestError ../errors/CancelError ../Deferred ../io-query ../_base/array ../_base/lang ../promise/Promise".split(" "),
function(a,h,p,m,f,e,l,g){deepCopy=a.deepCreate=var q=Object.freeze||function(b){return b};a.deferred=a.addCommonMethods=a.parseArgs=function(b,c,e){var g=c.data,a=c.query;!g||e||"object"!==typeof g||g instanceof ArrayBuffer||g instanceof Blob||(c.data=f.objectToQuery(g));a?("object"===typeof a&&(a=f.objectToQuery(a)),c.preventCache&&(a+=(a?"\x26":"")+"request.preventCache\x3d"+ +new Date)):c.preventCache&&(a="request.preventCache\x3d"+ +new Date);b&&a&&(b+=(~b.indexOf("?")?
"\x26":"?")+a);return{url:b,options:c,getHeader:};a.checkStatus=)},"dojo/errors/RequestError":"dojo/errors/RequestTimeoutError":"dojo/request/xhr":function(){define(["../errors/RequestError",
"./watch","./handlers","./util","../has"],function(a,h,p,m,f){function e(b,n){var c=b.xhr;b.status=b.xhr.status;try{b.text=c.responseText}catch(k){}"xml"===b.options.handleAs&&(b.data=c.responseXML);if(!n)try{p(b)}catch(k){n=k}var d;if(n)this.reject(n);else{try{p(b)}catch(k){d=k}m.checkStatus(c.status)?d?this.reject(d):this.resolve(b):(n=d?new a("Unable to load "+b.url+" status: "+c.status+" and an error in handleAs: transformation of response",b):new a("Unable to load "+b.url+" status: "+c.status,
b),this.reject(n))}}unction g(r,n,w){var d=f("native-formdata")&&n&&n.data&&n.data instanceof FormData,k=m.parseArgs(r,m.deepCreate(u,n),d);r=k.url;n=k.options;var v,A=m.deferred(k,y,b,q,e,,z=k.xhr=g._create();if(!z)return A.cancel(new a("XHR was not created")),w?A:A.promise;k.getHeader=l;x&&(v=x(z,A,k));var p="undefined"===typeof n.data?null:n.data,B=!n.sync,C=n.method;try{z.open(C,r,B,n.user||t,n.password||t);n.withCredentials&&
(z.withCredentials=n.withCredentials);f("native-response-type")&&n.handleAs in c&&(z.responseType=c[n.handleAs]);var F=n.headers;r=d?!1:"application/x-www-form-urlencoded";if(F)for(var K in F)"content-type"===K.toLowerCase()?r=F[K]:F[K]&&z.setRequestHeader(K,F[K]);r&&!1!==r&&z.setRequestHeader("Content-Type",r);F&&"X-Requested-With"in F||z.setRequestHeader("X-Requested-With","XMLHttpRequest");m.notify&&m.notify.emit("send",k,A.promise.cancel);z.send(p)}catch(M){A.reject(M)}h(A);z=null;return w?A:
A.promise}f.add("native-xhr",function(){return"undefined"!==typeof XMLHttpRequest});f.add("dojo-force-activex-xhr",;f.add("native-xhr2",;f.add("native-formdata",;f.add("native-response-type",
;f.add("native-xhr2-blob",;var c={blob:f("native-xhr2-blob")?"blob":"arraybuffer",document:"document",arraybuffer:"arraybuffer"},b,q,x,y;f("native-xhr2")?(b=y=x=function(b,n,c){function d(d){n.handleResponse(c)}
unction v(d){d.lengthComputable?(c.loaded=d.loaded,c.total=d.total,n.progress(c)):3===c.xhr.readyState&&(c.loaded="loaded"in d?d.loaded:d.position,n.progress(c))}b.addEventListener("load",d,!1);b.addEventListener("error",k,!1);b.addEventListener("progress",v,!1);return ):
(b=function(b){return b.xhr.readyState},q=y=;var t,u={data:null,query:null,sync:!1,method:"GET"};g._create=function(){throw Error("XMLHTTP not available");};if(f("native-xhr")&&!f("dojo-force-activex-xhr"))g._create=else if(f("activex"))try{new ActiveXObject("Msxml2.XMLHTTP"),g._create=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}catch(r){try{new ActiveXObject("Microsoft.XMLHTTP"),
g._create=catch(n){}}m.addCommonMethods(g);return g})},"dojo/request/handlers":"dojo/dom-construct":"dojo/dom-attr":"dojo/dom-prop":"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){nction t(d){return!!this.scriptLoaded}nction n(b,c,
g){var a=p.parseArgs(b,p.deepCopy({},c));b=a.url;c=a.options;var f=p.deferred(a,x,y,c.jsonp?null:c.checkString?u:t,r);e.mixin(f,{id:w+d++,canDelete:!1});c.jsonp&&((new RegExp("[?\x26]"+c.jsonp+"\x3d")).test(b)||(b+=(~b.indexOf("?")?"\x26":"?")+c.jsonp+"\x3d"+(c.frameDoc?"parent.":"")+w+"_callbacks."+f.id),f.canDelete=!0,A[f.id]=function(d){a.data=d;f.handleResponse(a)});p.notify&&p.notify.emit("send",a,f.promise.cancel);if(!c.canAttach||c.canAttach(f)){var q=n._attach(f.id,b,c.frameDoc);if(!c.jsonp&&
!c.checkString)var m=l(q,k,}l.once(q,"error",function(d){f.reject(d);n._remove(f.id,c.frameDoc,!0)});h(f);return g?f:f.promise}b.add("script-readystatechange",;var w=a.id.replace(/[\/\.\-]/g,"_"),d=0,k=b("script-readystatechange")?"readystatechange":"load",v=/complete|loaded/,
A=m.global[w+"_callbacks"]={},z=[];n.get=n;n._attach=function(d,b,k){k=k||q.doc;var n=k.createElement("script");n.type="text/javascript";n.src=b;n.id=d;n.async=!0;n.charset="utf-8";return k.getElementsByTagName("head")[0].appendChild(n)};n._remove=n._callbacksProperty=w+"_callbacks";return n})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y){p.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");e=y._iframeName;e=e.substring(0,e.lastIndexOf("_"));var t=m.delegate(y,{create:get:null,post:null,send:function(b){var c,n=f._ioSetArgs(b,function(d){c&&c.cancel()},function(d){var b=null;d=d.ioArgs;try{var k=d.handleAs;"xml"===k||"html"===k?b=c.response.data:(b=c.response.text,"json"===k?b=h.fromJson(b):"javascript"===k&&(b=p.eval(b)))}catch(B){b=
B}return b},function(d,b){b.ioArgs._hasError=!0;return d}),e=n.ioArgs,d="GET",k=g.byId(b.form);b.method&&"POST"===b.method.toUpperCase()&&k&&(d="POST");b={method:d,handleAs:"json"===b.handleAs||"javascript"===b.handleAs?"text":b.handleAs,form:b.form,query:k?null:b.content,data:k?b.content:null,timeout:b.timeout,ioArgs:e};b.method&&(b.method=b.method.toUpperCase());if(a.ioPublish&&p.publish&&!1!==e.args.ioPublish)var v=x.after(y,"_notifyStart",
!0);c=y(e.url,b,!0);e._callNext=c._callNext;c.then(function(){n.resolve(n)}).otherwise(function(d){n.ioArgs.error=d;n.reject(d)});return n},_iframeOnload:l.global[e+"_onload"]});m.setObject("dojo.io.iframe",t);return t})},"dojo/query":"dojo/selector/_loader":"dojo/selector/acme":function(){define(["../dom","../sniff","../_base/array","../_base/lang","../_base/window"],function(a,h,p,m,f){var e=m.trim,l=p.forEach,g="BackCompat"==f.doc.compatMode,c=!1,b=function(){return!0},q=x=y=t=function(d){return 1==d.nodeType},u=r={"*\x3d":"^\x3d":"$\x3d":"~\x3d":"|\x3d":"\x3d":;m=f.doc.documentElement;var n=!(m.nextElementSibling||"nextElementSibling"in m),w=n?"nextSibling":"nextElementSibling",d=n?"previousSibling":"previousElementSibling",k=n?t:b,v=function(b){for(;b=b[d];)if(k(b))return!1;return!0},A=z=D=B=C={checked:disabled:enabled:"first-child":function(){return v},"last-child":function(){return A},"only-child":empty:contains:
not:"nth-child":,F=9>h("ie")||9==h("ie")&&h("quirks")?K=M=E=V=function(d,n){var c=d=d||b;return function(b,e,v){var g=0,a=[],a=c(b.children||b.childNodes);for(n&&p.forEach(a,;b=a[g++];)k(b)&&(!v||ba(b,v))&&d(b,g)&&e.push(b);return e}},P=I={},J=function(d){var k=I[d.query];if(k)return k;var n=d.infixOper,n=n?n.oper:"",c=K(d,{el:1}),e="*"==d.tag,v=f.doc.getElementsByClassName;if(n)v={el:1},e&&(v.tag=1),c=K(d,v),"+"==n?k=M(c):"~"==n?k=E(c):"\x3e"==n&&(k=V(c));else if(d.id)c=!d.loops&&e?b:K(d,{el:1,id:1}),k=else if(v&&/\{\s*\[native code\]\s*\}/.test(String(v))&&d.classes.length&&!g)var c=K(d,{el:1,classes:1,id:1}),q=d.classes.join(" "),k=else e||d.loops?(c=K(d,{el:1,tag:1,id:1}),k=:k=return I[d.query]=k},Q={},S={},ga=L=h("ie")?"commentStrip":"nozip",R=!!f.doc.querySelectorAll,U=/\\[>~+]|n\+\d|([^ \\])?([>~+])([^ =])?/g,
T=N=/([^[]*)([^\]]*])?/g,Z=H=function(d,b){d=d.replace(N,Z);if(R){var k=S[d];if(k&&!b)return k}if(k=Q[d])return k;var k=d.charAt(0),n=-1==d.indexOf(" ");0<=d.indexOf("#")&&n&&(b=!0);if(!R||b||-1!="\x3e~+".indexOf(k)||h("ie")&&-1!=d.indexOf(":")||g&&0<=d.indexOf(".")||-1!=d.indexOf(":contains")||-1!=d.indexOf(":checked")||-1!=d.indexOf("|\x3d")){var c=d.match(/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g);
return Q[d]=2>c.length?ga(d):var e=0<="\x3e~+".indexOf(d.charAt(d.length-1))?d+" *":d;return S[d]=,O=0,aa=h("ie")?ba=X=ea=ea.filter=return ea})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x){unction u(d,b){if(!b)try{var k=d.options,c=n.doc(n._frame),v=k.handleAs;if("html"!==v){if("xml"===v)if("html"===c.documentElement.tagName.toLowerCase()){g("a",c.documentElement).orphan();var a=c.documentElement.innerText||c.documentElement.textContent,a=a.replace(/>\s+</g,"\x3e\x3c");d.text=e.trim(a)}else d.data=c;else d.text=c.getElementsByTagName("textarea")[0].value;f(d)}else d.data=c}catch(F){b=F}b?this.reject(b):this._finished?this.resolve(d):this.reject(Error("Invalid dojo/request/iframe request state"))}
r w=a.id.replace(/[\/\.\-]/g,
"_"),d=w+"_onload";x.global[d]||(x.global[d]=;var k={method:"POST"};n.create=n.doc=n.setSrc=n._iframeName=w+"_IoIframe";n._notifyStart=function(){};n._dfdQueue=[];n._currentDfd=null;n._fireNextRequest=function(){var d;try{if(!n._currentDfd&&n._dfdQueue.length){do d=n._currentDfd=n._dfdQueue.shift();while(d&&(d.canceled||
d.isCanceled&&d.isCanceled())&&n._dfdQueue.length);if(!d||d.canceled||d.isCanceled&&d.isCanceled())n._currentDfd=null;else{var k=d.response,c=k.options,g=d._contentToClean=[],a=b.byId(c.form),f=m.notify,r=c.data||null,t;d._legacy||"POST"!==c.method||a?"GET"===c.method&&a&&-1<k.url.indexOf("?")&&(t=k.url.slice(k.url.indexOf("?")+1),r=e.mixin(l.queryToObject(t),r)):a=d._tmpForm=q.create("form",{name:w+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},x.body());if(a){if(!d._legacy){var u=
a;do u=u.parentNode;while(u&&u!==x.doc.documentElement);u||(a.style.position="absolute",a.style.left="-1000px",a.style.top="-1000px",x.body().appendChild(a));a.name||(a.name=w+"_form")}if(r){var u=h;for(h in r){var y=r[h];if(e.isArray(y)&&1<y.length)for(t=0;t<y.length;t++)u(h,y[t]);else a[h]?a[h].value=y:u(h,y)}}var p=a.getAttributeNode("action"),I=a.getAttributeNode("method"),J=a.getAttributeNode("target");k.url&&(d._originalAction=
p?p.value:null,p?p.value=k.url:a.setAttribute("action",k.url));d._legacy?I&&I.value||(I?I.value=c.method:a.setAttribute("method",c.method)):(d._originalMethod=I?I.value:null,I?I.value=c.method:a.setAttribute("method",c.method));d._originalTarget=J?J.value:null;J?J.value=n._iframeName:a.setAttribute("target",n._iframeName);a.target=n._iframeName;f&&f.emit("send",k,d.promise.cancel);n._notifyStart(k);a.submit()}else c="",k.options.data&&(c=k.options.data,"string"!==typeof c&&(c=l.objectToQuery(c))),
u=k.url+(-1<k.url.indexOf("?")?"\x26":"?")+c,f&&f.emit("send",k,d.promise.cancel),n._notifyStart(k),n.setSrc(n._frame,u,!0)}}}catch(Q){d.reject(Q)}};m.addCommonMethods(n,["GET","POST"]);return n})},"dojo/NodeList-dom":"dojo/dom-class":"esri/Map":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/Accessor ./core/CollectionFlattener ./core/Evented ./support/LayersMixin ./Ground ./support/basemapUtils ./support/groundUtils ./core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x){a=function(g){function a(e){e=g.call(this)||this;e.basemap=null;e.ground=new c;e._basemapCache=b.createCache();return e}p(a,g);Object.defineProperty(a.prototype,
"allLayers",{get:function(){return new e({root:this,rootCollectionNames:["basemap.baseLayers","ground.layers","layers","basemap.referenceLayers"],getChildrenFunction:function(b){return b.layers}})},enumerable:!0,configurable:!0});a.prototype.castBasemap=function(c){return b.ensureType(c,this._basemapCache)};return a}(x.declared(f,l,g));m([x.property({readOnly:!0})],a.prototype,"allLayers",null);m([x.property()],a.prototype,"basemap",void 0);m([x.cast("basemap")],a.prototype,"castBasemap",null);m([x.property(),
x.cast(q.ensureType)],a.prototype,"ground",void 0);return a=m([x.subclass("esri.Map")],a)})},"esri/core/tsSupport/declareExtendsHelper":"esri/core/tsSupport/decorateHelper":"esri/core/Accessor":function(){define("./declare ./accessorSupport/Properties ./accessorSupport/get ./accessorSupport/introspection ./accessorSupport/set ./accessorSupport/watch".split(" "),function(a,h,p,m,f,e){h=h.default;a.before(;a.after(function(e){a.hasMixin(e,l)&&(m.processClass(e),Object.defineProperties(e.prototype,
{initialized:{get:function(){return this.__accessor__&&this.__accessor__.initialized||!1}},destroyed:{get:}))});var l=a(null,{declaredClass:"esri.core.Accessor","-chains-":{initialize:"after",destroy:"before"},constructor:__accessor__:null,postscript:function(e){var c=this.__accessor__;e=c.ctorArgs||e;var b;null!=this.getDefaults&&(b=this.getDefaults(e||{}),this.set(b));c.initialize();e&&(this.set(e),c.ctorArgs=null);this.initialize()},initialize:function(){},destroy:function(){if(this.__accessor__)e.removeTarget(this),this.__accessor__.destroy();else try{throw Error("instance is already destroyed");
}catch(g){console.warn(g.stack)}},get:hasOwnProperty:keys:set:function(e,c){f.set(this,e,c);return this},watch:_clearOverride:function(e){return this.__accessor__.clearOverride(e)},_override:function(e,c){return this.__accessor__.override(e,c)},_isOverridden:function(e){return this.__accessor__.isOverridden(e)},
notifyChange:function(e){this.__accessor__.propertyInvalidated(e)},_get:function(e){return this.__accessor__.internalGet(e)},_set:function(e,c){return this.__accessor__.internalSet(e,c)}});return l})},"esri/core/declare":function(){define(["require","exports","dojo/_base/declare"],function(a,h,p){unction f(a,c){a&&!Array.isArray(a)&&"function"!==typeof a&&(c=a,a=null);"function"===
typeof a?a=[a]:a||(a=[]);c=c||{};var b,g;b=0;for(g=e.length;b<g;b++)e[b](a,c);a=p(a,c);a.createSubclass=m;b=0;for(g=l.length;b<g;b++)l[b](a);return a}var e=[],l=[];((f||(f={}));return f})},"dojo/_base/declare":"esri/core/accessorSupport/Properties":function(){define("require exports dojo/has ./Store ./PropertyOrigin ./extensions ../Logger".split(" "),function(a,h,p,m,f,e,l){l.getLogger("esri.core.Accessor");var g=0;a=function(){function c(b){this.host=b;this._origin=f.OriginId.USER;this.cursors={};this.ctorArgs=null;this.destroyed=!1;this.dirties={};this.initialized=!1;this.metadatas=this.host.constructor.__accessorMetadata__;this.overridden=null;this.store=new m.default;
Object.defineProperty(this,"uid",{value:g++})}c.prototype.initialize=function(){this.initialized=!0;e.instanceCreated(this.host,this.metadatas)};c.prototype.destroy=function(){this.destroyed=!0;for(var b=this.cursors,c=0,e=Object.getOwnPropertyNames(b);c<e.length;c++){var a=e[c],g=b[a];if(g){for(;0<g.length;)g.pop().propertyDestroyed(this,a);b[a]=null}}};c.prototype.clearOverride=c.prototype.get=function(b){var c=
this.metadatas[b];if(this.store.has(b)&&!0===!this.dirties[b])return this.store.get(b);var e=c.get;return e?(c=e.call(this.host),this.store.set(b,c,f.OriginId.COMPUTED),this.propertyCommitted(b),c):c.value};c.prototype.originOf=c.prototype.has=c.prototype.internalGet=function(b){if(this.metadatas[b]){var c=
this.store;return c.has(b)?c.get(b):this.metadatas[b].value}};c.prototype.internalSet=function(b,c){this.metadatas[b]&&(this.propertyInvalidated(b),this.initialized?this.store.set(b,c,this._origin):this.store.set(b,c,f.OriginId.DEFAULTS),this.propertyCommitted(b))};c.prototype.isOverridden=c.prototype.keys=function(){return this.store.keys()};c.prototype.override=function(b,c){this.metadatas[b]&&(this.overridden||(this.overridden=
{}),this.overridden[b]=!0,this.internalSet(b,c))};c.prototype.set=function(b,c){if(this.metadatas[b]){var e=this.metadatas[b],a=e.set;(e=e.cast)&&(c=e.call(this.host,c));a?a.call(this.host,c):this.internalSet(b,c)}};c.prototype.setDefaultOrigin=c.prototype.propertyInvalidated=function(b){var c=this.cursors[b];if(c)for(var e=0;e<c.length;e++)c[e].propertyInvalidated(this,b);this.isOverridden(b)||(this.dirties[b]=!0)};c.prototype.propertyCommitted=function(b){this.dirties[b]=
!1;var c=this.cursors[b];if(c)for(var e=0;e<c.length;e++)c[e].propertyCommitted(this,b)};c.prototype.addCursor=function(b,c){var e=this.cursors[b];e||(this.cursors[b]=e=[]);e.push(c)};c.prototype.removeCursor=return c}();Object.defineProperty(h,"__esModule",{value:!0});h.default=a})},"esri/core/accessorSupport/Store":function(){define(["require","exports","./PropertyOrigin"],function(a,
h,p){a=);Object.defineProperty(h,"__esModule",{value:!0});h.default=a})},"esri/core/accessorSupport/PropertyOrigin":function(){define(["require",
"exports"],function(a,h){r f;((f=h.OriginId||(h.OriginId={}));h.nameToId=p;h.idToName=m;h.readableNameToId=function(e){return p(e)};h.idToReadableName=function(e){return m(e)};h.writableNameToId=function(e){return p(e)};h.idToWritableName=function(e){return m(e)}})},"esri/core/accessorSupport/extensions":function(){define(["require","exports",
"./extensions/aliasedProperty","./extensions/computedProperty","./extensions/serializableProperty"],function(a,h,p,m,f){var e=[p.default,m.default,f.default];h.processPrototypeMetadatas=function(a,g){for(var c=Object.getOwnPropertyNames(a),b=0;b<e.length;b++){var f=e[b];if(f.processPrototypePropertyMetadata)for(var l=0,m=c;l<m.length;l++){var t=m[l];f.processPrototypePropertyMetadata(t,a[t],a,g)}}};h.processClassMetadatas=h.instanceCreated=)},"esri/core/accessorSupport/extensions/aliasedProperty":function(){define("require exports dojo/has ../wire ../utils ../get ../set".split(" "),function(a,h,p,m,f,e,l){.AliasedPropertyExtension={processClassPropertyMetadata:function(c,b,a,g){var f=b.aliasOf;if(f&&(c=f.split(".")[0],null!=a[c]&&!b.set&&!b.get)){var q;b.get=b.readOnly||(b.set=}},instanceCreated:;Object.defineProperty(h,"__esModule",{value:!0});h.default=h.AliasedPropertyExtension})},"esri/core/accessorSupport/wire":function(){define(["require","exports","./utils"],function(a,h,p){ar f=),e=),l=function(){.prototype.destroy=function(){for(var b;b=this.stack.pop();)b.properties.removeCursor(b.propertyName,
this);this.target=this.binding=null};b.prototype.propertyDestroyed=function(b,c){this.moveBackward(b,c)};b.prototype.propertyInvalidated=b.prototype.propertyCommitted=b.prototype.moveBackward=b.prototype.moveForward=function(){var b=this.stack,c=b[b.length-1],c=c.properties.internalGet(c.propertyName);(c=p.getProperties(c))&&b.length<this.binding.chain.length&&(b=this.binding.chain[b.length],this.stack.push({properties:c,propertyName:b}),c.addCursor(b,this),this.moveForward())};return b}(),g=),c=);h.create=h.wire=m;Object.defineProperty(h,"__esModule",{value:!0});h.default=m})},"esri/core/accessorSupport/utils":function(){define(["require","exports","../lang"],
function(a,h,p){function m(b){return b?b.__accessor__?b.__accessor__:b.propertyInvalidated?b:null:null}tProperties=m;h.isPropertyDeclared=h.merge=f;h.pathToStringOrArray=h.pathToArray=e;h.splitPath=l;h.parse=h.once=g;var c=0;h.uid=function(b){if(null==b)return c++;b=m(b);null==b.uid&&(b.uid=c++);return b.uid}})},"esri/core/lang":function(){define("dojo/_base/array dojo/_base/kernel dojo/_base/lang dojo/date dojo/number dojo/date/locale dojo/i18n!../nls/common".split(" "),
function(a,h,p,m,f,e,l){nction b(b,q,n){var r=n.match(/([^\(]+)(\([^\)]+\))?/i),d=p.trim(r[1]);n=q[b];var r=JSON.parse((r[2]?p.trim(r[2]):"{}").replace(/^\(/,"{").replace(/\)$/,"}").replace(/([{,])\s*([0-9a-zA-Z\_]+)\s*:/gi,'$1"$2":').replace(/\"\s*:\s*\'/gi,'":"').replace(/\'\s*(,|\})/gi,'"$1')),k=r.utcOffset;if(-1===a.indexOf(y,d))d=p.getObject(d),p.isFunction(d)&&(n=d(n,b,q,r));else if("number"===typeof n||"string"===typeof n&&
n&&!isNaN(Number(n)))switch(n=Number(n),d){case "NumberFormat":b=p.mixin({},r);q=parseFloat(b.places);if(isNaN(q)||0>q)b.places=Infinity;return f.format(n,b);case "DateString":n=new Date(n);if(r.local||r.systemLocale)return r.systemLocale?n.toLocaleDateString()+(r.hideTime?"":" "+n.toLocaleTimeString()):n.toDateString()+(r.hideTime?"":" "+n.toTimeString());n=n.toUTCString();r.hideTime&&(n=n.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,""));return n;case "DateFormat":return n=new Date(n),g(k)&&(n=m.add(n,
"minute",n.getTimezoneOffset()-k)),e.format(n,r)}return c(n)}unction x(b){if(!b||"object"!=typeof b||p.isFunction(b))return b;if("function"===typeof b.clone)b=b.clone();else if("function"===typeof b.map&&"function"===typeof b.forEach)b=b.map(x);else{var c={},n,e,d={};for(n in b){e=b[n];var k=!(n in d)||d[n]!==
e;if(!(n in c)||c[n]!==e&&k)c[n]=x?x(e):e}b=c}return b}var y=["NumberFormat","DateString","DateFormat"],t=/<\/?[^>]+>/g;return{equals:valueOf:stripTags:substitute:function(e,f,n){var q,d,k;g(n)&&(p.isObject(n)?(q=n.first,d=n.dateFormat,k=n.numberFormat):q=n);if(f&&"{*}"!==f)return p.replace(f,p.hitch({obj:e},function(n,e){n=e.split(":");return 1<n.length?(e=n[0],n.shift(),b(e,this.obj,n.join(":"))):d&&-1!==a.indexOf(d.properties||"",e)?b(e,this.obj,d.formatter||"DateString"):k&&-1!==a.indexOf(k.properties||
"",e)?b(e,this.obj,k.formatter||"NumberFormat"):c(this.obj[e])}));f=[];var v;f.push('\x3ctable summary\x3d"'+l.fieldsSummary+'"\x3e\x3ctbody\x3e');for(v in e)if(n=e[v],d&&-1!==a.indexOf(d.properties||"",v)?n=b(v,e,d.formatter||"DateString"):k&&-1!==a.indexOf(k.properties||"",v)&&(n=b(v,e,k.formatter||"NumberFormat")),f.push("\x3ctr\x3e\x3cth\x3e"+v+"\x3c/th\x3e\x3ctd\x3e"+c(n)+"\x3c/td\x3e\x3c/tr\x3e"),q)break;f.push("\x3c/tbody\x3e\x3c/table\x3e");return f.join("")},filter:startsWith:endsWith:isDefined:g,fixJson:q,clone:x}})},"dojo/date":"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(a,h,p,m,f){var e={};a.setObject("dojo.number",e);e.format=e._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;e._applyPattern=e.round=if(0==(.9).toFixed()){var l=e.round;e.round=e._formatAbsolute=e.regexp=
function(a){return e._parseInfo(a).regexp};e._parseInfo=e.parse=e._realNumberRegexp=e._integerRegexp=return e})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./has!host-browser?./_base/xhr ./json module".split(" "),function(a,h,p,m,f,e,l,g,c){p.add("dojo-preload-i18n-Api",1);l=
a.i18n={};var b=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,q=x={},y=t=a.getL10nName=u=r=n=p("dojo-preload-i18n-Api");var w=l.normalizeLocale=d=0,k=[],v=l._preloadLocalizations=function(b,c,g,v){||h;t();m.forEach(a.config.extraLocale,t)},A=function(){},A=l.getLocalization=return e.mixin(l,{dynamic:!0,
normalize:load:n,cache:x,getL10nName:t})})},"dojo/string":"dojo/regexp":"dojo/date/locale":
"dojo/cldr/supplemental":"esri/core/accessorSupport/get":function(){define(["require","exports","./utils"],function(a,h,p){ction l(a,c){return e(a,c,!0)}h.valueOf=e;h.get=l;h.exists=Object.defineProperty(h,"__esModule",{value:!0});h.default=l})},"esri/core/accessorSupport/set":function(){define(["require","exports","./get"],function(a,h,p){function m(a,e,l){if(a&&e)if("object"===
typeof e){l=0;for(var g=Object.getOwnPropertyNames(e);l<g.length;l++){var c=g[l];m(a,c,e[c])}}else"_"!==e[0]&&(-1!==e.indexOf(".")?(e=e.split("."),c=e.splice(e.length-1,1)[0],m(p.default(a,e),c,l)):a[e]=l)}h.set=m;Object.defineProperty(h,"__esModule",{value:!0});h.default=m})},"esri/core/accessorSupport/extensions/computedProperty":function(){define(["require","exports","dojo/has","../utils","../wire"],function(a,h,p,m,f){h.ComputedPropertyExtension={processClassPropertyMetadata:function(e,a,g,c){a.dependsOn&&
(a.wire=f.create(a.dependsOn,)},instanceCreated:;Object.defineProperty(h,"__esModule",{value:!0});h.default=h.ComputedPropertyExtension})},"esri/core/accessorSupport/extensions/serializableProperty":function(){define("require exports ./serializableProperty/shorthands ./serializableProperty/originAliases ./serializableProperty/reader ./serializableProperty/writer".split(" "),
function(a,h,p,m,f,e){.originSpecificReadPropertyDefinition=function(e,c){return l(e,"read",c)};h.originSpecificWritePropertyDefinition=h.SerializablePropertyExtension={processPrototypePropertyMetadata:function(a,c,b,q){if(p.process(c)){m.process(c);q=(b=Array.isArray(c.type))?c.type[0]:c.type;if(c.json.origins)for(var g in c.json.origins){var l=
c.json.origins[g];f.create(q,b,a,l);e.create(q,b,a,l)}f.create(q,b,a,c.json);e.create(q,b,a,c.json)}}};Object.defineProperty(h,"__esModule",{value:!0});h.default=h.SerializablePropertyExtension})},"esri/core/accessorSupport/extensions/serializableProperty/shorthands":function(){define(["require","exports"],function(a,h){function p(a){"boolean"===typeof a.read?a.read={enabled:a.read}:"function"===typeof a.read?a.read={enabled:!0,reader:a.read}:a.read&&"object"===typeof a.read&&void 0===a.read.enabled&&
(a.read.enabled=!0)}.process=)},"esri/core/accessorSupport/extensions/serializableProperty/originAliases":function(){define(["require","exports"],
function(a,h){h.process=function(a){if(a.json&&a.json.origins){var m=a.json.origins,f={portalItem:["portal-item"],webScene:["web-scene"],webMap:["web-map"],webDocument:["web-scene","web-map"],"web-document":["web-scene","web-map"]};a=for(var e in f)a(e)}}})},"esri/core/accessorSupport/extensions/serializableProperty/reader":function(){define(["require","exports","dojo/_base/lang","./type"],function(a,h,p,m){function f(b,
c,a,f){if(c)return l(b);if(g(b)){var q=l(b.prototype.itemType);return function(c,e){return(c=q(c,e))?new b(c):c}}return e(b)}nction g(b){return m.isCollection(b)&&c(b.prototype.itemType)}.create=
)},"esri/core/accessorSupport/extensions/serializableProperty/type":function(){define(["require","exports"],function(a,h){h.isCollection=)},"esri/core/accessorSupport/extensions/serializableProperty/writer":function(){define(["require","exports","dojo/_base/lang","./type"],
function(a,h,p,m){unction e(e,c){return e&&"function"===typeof e.toJSON&&!e.toJSON.isDefaultToJSON?e.toJSON():e&&"function"===typeof e.write?e.write({},c):e}.create=function(e,c,b,a){a.write&&!a.write.writer&&!1!==a.write.enabled&&(c||m.isCollection(e)?a.write.writer=l:a.write.writer=
f)}})},"esri/core/Logger":function(){define(["require","exports","dojo/has"],function(a,h,p){var m={info:0,warn:1,error:2};a=function(){.prototype.log=a.prototype.error=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];this.log.apply(this,["error"].concat(e))};a.prototype.warn=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];this.log.apply(this,["warn"].concat(e))};a.prototype.info=a.prototype.getLogger=a.getLogger=a.prototype._parentWithMember=a.prototype._inheritedWriter=a.prototype._consoleWriter=a.prototype._matchLevel=a.prototype._isEnabled=return a}();a._loggers={};a.getLogger("esri").level="warn";return a})},"esri/core/accessorSupport/introspection":function(){define("require exports dojo/_base/lang ./utils ./metadata ./ensureType ./extensions ./decorators/cast".split(" "),function(a,h,p,m,f,e,l,g){var c=Object.prototype.hasOwnProperty,b=/^_([a-zA-Z0-9]+)(Getter|Setter|Reader|Writer|Caster)$/,q={Getter:"get",Setter:"set",Reader:"json.read.reader",
Writer:"json.write.writer",Caster:"cast"},x=/^_(set|get)([a-zA-Z0-9]+)Attr$/;h.processPrototype=function(a){for(var g=a.declaredClass,u=a.properties||{},r=0,n=Object.getOwnPropertyNames(u);r<n.length;r++){var w=n[r],d=u[w],k=typeof d;null==d?f.setPropertyMetadata(a,w,{value:d}):Array.isArray(d)?f.setPropertyMetadata(a,w,{type:[d[0]],value:null}):"object"===k?m.getProperties(d)||d instanceof Date?f.setPropertyMetadata(a,w,{type:d.constructor,value:d}):f.setPropertyMetadata(a,w,d):"boolean"===k?f.setPropertyMetadata(a,
w,{type:Boolean,value:d}):"string"===k?f.setPropertyMetadata(a,w,{type:String,value:d}):"number"===k?f.setPropertyMetadata(a,w,{type:Number,value:d}):"function"===k&&f.setPropertyMetadata(a,w,{type:d,value:null})}r=0;for(n=Object.getOwnPropertyNames(a);r<n.length;r++){var k=n[r],d=a[k],v=void 0,u=w=void 0;if(v=b.exec(k))w=v[1],u=q[v[2]];else if(v=x.exec(k))w=v[2][0].toLowerCase()+v[2].substr(1),u=v[1].toLowerCase();w&&u&&(w=f.getPropertyMetadata(a,w),p.setObject(u,d,w))}r=0;for(n=Object.getOwnPropertyNames(f.getPropertiesMetadata(a));r<
n.length;r++)if(w=n[r],d=f.getPropertyMetadata(a,w),u=d.type,void 0===d.value&&c.call(a,w)&&(d.value=a[w]),!d.cast&&u)switch(u){case Number:d.cast=e.ensureNumber;break;case Boolean:d.cast=e.ensureBoolean;break;case String:d.cast=e.ensureString;break;case Date:d.cast=e.ensureDate;break;default:Array.isArray(u)?d.cast=e.ensureArray(u[0]):d.cast=e.ensureType(u)}l.processPrototypeMetadatas(f.getPropertiesMetadata(a),g);return f.getPropertiesMetadata(a)};h.processClass=function(b){for(var c=b.prototype,
a=c.declaredClass,e=b._meta.bases,n={},q=e.length-1;0<=q;q--)m.merge(n,f.getMetadata(e[q].prototype));var d=n.properties;l.processClassMetadatas(d,a);Object.defineProperty(b,"__accessorMetadata__",{value:d});for(var k={},a=function(b){var c=d[b];k[b]={enumerable:!0,configurable:!0,get:set:function(d){var k=this.__accessor__;if(!k)Object.defineProperty(this,b,{enumerable:!0,configurable:!0,writable:!0,value:d});else if(!Object.isFrozen(this)){if(k.initialized&&
c.readOnly)throw new TypeError("[accessor] cannot assign to read-only property '"+b+"' of "+this.declaredClass);k.set(b,d)}}}},e=0,q=Object.getOwnPropertyNames(d);e<q.length;e++)a(q[e]);Object.defineProperties(b.prototype,k);if(n.parameters)for(b=0,a=Object.getOwnPropertyNames(n.parameters);b<a.length;b++)e=a[b],q=Object.getOwnPropertyDescriptor(c,e)||{value:c[e]},(q=g.autocastMethod(c,e,q))&&Object.defineProperty(c,e,q);return n}})},"esri/core/accessorSupport/metadata":function(){define(["require",
"exports"],function(a,h){Metadata=p;h.hasPropertiesMetadata=
m;h.hasPropertyMetadata=h.hasParametersMetadata=h.getMetadata=f;h.getPropertiesMetadata=e;h.getPropertyMetadata=h.setPropertyMetadata=h.getParametersMetadata=l;h.getParameterMetadata=)},"esri/core/accessorSupport/ensureType":function(){define(["require",
"exports","dojo/has"],function(a,h,p){unction f(a,e){if(1===arguments.length)return f.bind(null,a);e&&a&&!m(a,e)&&(e=new a(e));return e}function e(a,g){return 1===arguments.length?e.bind(null,a):g?Array.isArray(g)?g.map(f.bind(null,a)):[f(a,g)]:g}h.isInstanceOf=m;h.ensureDate=h.ensureBoolean=function(a){return!0===a||!1===a?a:!!a};h.ensureString=
h.ensureNumber=h.ensureType=f;h.ensureArray=e;Object.defineProperty(h,"__esModule",{value:!0});h.default=f})},"esri/core/accessorSupport/decorators/cast":function(){define(["require","exports","../metadata","../ensureType"],function(a,h,p,m){c=Object.prototype.toString;h.autocastMethod=h.cast=)},"esri/core/accessorSupport/watch":function(){define("require exports ../Scheduler ../ObjectPool ../ArrayPool ../lang ./utils ./get ./wire".split(" "),
function(a,h,p,m,f,e,l,g,c){nction x(){if(k){k=null;var b=d;d=n.acquire();w.clear();for(var c=n.acquire(),a=0;a<b.length;a++){var e=b[a];q(e);e.removed&&c.push(e)}for(a=0;a<d.length;a++)e=d[a],e.removed&&(c.push(e),w.delete(e),d.splice(a,1),--a);for(a=
0;a<c.length;a++)r.pool.release(c[a]);n.release(b);n.release(c)}} r=function(){.prototype.release=return d}();r.pool=new m(r,!0);var n=new f,w=new Set,d=n.acquire(),k;h.dispatchTarget=h.removeTarget=h.dispatch=x;h.watch=u;Object.defineProperty(h,"__esModule",{value:!0});h.default=u})},"esri/core/Scheduler":function(){define(["./ArrayPool","./ObjectPool","./nextTick","./requestAnimationFrame",
"./now"],function(a,h,p,m,f){var e=["prepare","preRender","render","postRender","update"],l=new h(!0,function(b){b.isActive=!1;b.callback=null}),g=function(){},c=function(){this.item.isActive=!1;q.release(this)},b={time:0,deltaTime:0,spendInFrame:0,spendInTask:0},q=new h(!0,;h=function(){this._boundDispatch=this._dispatch.bind(this);this.willDispatch=!1;this._queue=a.acquire();
this._frameTasks=a.acquire();this._phaseTasks={};this._previousFrameTime=-1;for(var b=0;b<e.length;b++)this._phaseTasks[e[b]]=a.acquire();this._boundAnimationFrame=this._animationFrame.bind(this);this.executing=!1;this._animationFrameRequestId=null};h.prototype={schedule:function(b){var c=l.acquire();c.callback=b;this._schedule(c);b=q.acquire();b.item=c;return b},_dispatch:function(){for(var b=this._queue;b.length;){var c=b.shift();c.isActive&&(c.isActive=!1,c.callback())}this.willDispatch=!1},_schedule:function(b){this._queue.push(b);
this.willDispatch||(this.willDispatch=!0,p(this._boundDispatch))},addFrameTask:function(b){var c={phases:b,paused:!1,pausedAt:0,epoch:-1,dt:0,ticks:-1,removed:!1};this._frameTasks.push(c);for(var a=0;a<e.length;a++){var g=e[a];b[g]&&this._phaseTasks[g].push(c)}this._animationFrameRequestId||(this._previousFrameTime=-1,this._requestAnimationFrame());return{isPaused:function(){return c.paused},remove:pause:function(){c.paused=!0;c.pausedAt=f()},resume:function(){c.paused=!1;
-1!==c.epoch&&(c.epoch+=f()-c.pausedAt)}}},clearFrameTasks:_purge:function(){for(var b=0;b<this._frameTasks.length;){var c=this._frameTasks[b];b++;if(c.removed){this._frameTasks.splice(b-1,1);for(var a=0;a<e.length;a++){var g=e[a];if(c.phases[g]){var g=this._phaseTasks[g],n=g.indexOf(c);-1!==n&&g.splice(n,1)}}}}},_animationFrame:function(c){this._animationFrameRequestId=null;this.executing=!0;0<this._frameTasks.length&&
this._requestAnimationFrame();c=f();0>this._previousFrameTime&&(this._previousFrameTime=c);var a=c-this._previousFrameTime;this._previousFrameTime=c;for(var g=0;g<this._frameTasks.length;g++){var q=this._frameTasks[g];-1!==q.epoch&&(q.dt=a)}for(g=0;g<e.length;g++)for(var a=e[g],n=this._phaseTasks[a],l=0;l<n.length;l++)q=n[l],q.paused||q.removed||(0===g&&q.ticks++,-1===q.epoch&&(q.epoch=c),b.time=c,b.deltaTime=q.dt,b.spendInFrame=f()-c,b.spendInTask=c-q.epoch,q.phases[a].call(q,b));this._purge();this.executing=
!1},_requestAnimationFrame:;var x=new h;h.schedule=function(b){return x.schedule(b)};h.addFrameTask=function(b){return x.addFrameTask(b)};h.clearFrameTasks=function(){return x.clearFrameTasks()};Object.defineProperty(h,"executing",{get:function(){return x.executing}});h.instance=x;return h})},"esri/core/ArrayPool":function(){define(["require","exports","./ObjectPool"],function(a,h,p){var m=Array.prototype.splice;a=function(){function a(a,
e){void 0===a&&(a=50);void 0===e&&(e=50);this._pool=new p(Array,!1,function(c){return c.length=0},e,a)}a.prototype.acquire=function(){return this._pool.acquire()};a.prototype.copy=a.prototype.release=function(a){this._pool.release(a)};a.acquire=function(){return f.acquire()};a.copy=function(a){return f.copy(a)};a.release=function(a){return f.release(a)};return a}();var f=new a(100);return a})},"esri/core/ObjectPool":function(){define(["require",
"exports"],function(a,h){var p=function(){return function(){}}();return function(){function a(a,e,l,g,c){void 0===g&&(g=1);void 0===c&&(c=0);this.classConstructor=a;this.acquireFunctionOrWithConstructor=e;this.releaseFunction=l;this.growthSize=g;!0===e?this.acquireFunction=this._constructorAcquireFunction:"function"===typeof e&&(this.acquireFunction=e);this._pool=Array(c);this._set=new Set;for(a=0;a<c;a++)this._pool[a]=new this.classConstructor;this.growthSize=Math.max(g,1)}a.prototype.acquire=a.prototype.release=a.prototype._constructorAcquireFunction=return a}()})},"esri/core/nextTick":function(){define(["require","exports"],function(a,h){ar m=function(){return this}(),f=m.MutationObserver||m.WebKitMutationObserver;
return )})},"esri/core/requestAnimationFrame":function(){define(["dojo/_base/window","dojo/sniff","./now"],function(a,h,p){var m=a.global;a=h("ff");var f=h("ie"),e=h("webkit");h=h("opera");var l=p(),g=m.requestAnimationFrame;g||(g=m[(e&&"webkit"||a&&"moz"||h&&"o"||f&&"ms")+"RequestAnimationFrame"])||(g=;return g})},"esri/core/now":"esri/core/global":function(){define(["require","exports"],function(a,h){return"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{}})},"esri/core/CollectionFlattener":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./accessorSupport/decorators ./Collection ./HandleRegistry".split(" "),function(a,h,p,m,f,e,l){a=function(a){function c(b){b=a.call(this)||
this;b._handles=new l;b.root=null;b.refresh=b.refresh.bind(b);b.updateCollections=b.updateCollections.bind(b);return b}p(c,a);c.prototype.initialize=function(){var b=this;this._handles.add(this.rootCollectionNames.map(function(c){return b.watch("root."+c,b.updateCollections,!0)}));this.updateCollections()};c.prototype.destroy=function(){this.root=null;this.refresh();this._handles.destroy();this._handles=null};c.prototype.updateCollections=function(){var b=this;this._collections=this.rootCollectionNames.map(.filter(function(b){return null!=b});this.refresh()};c.prototype.refresh=function(){var b=this._handles;b.remove("collections");this.removeAll();for(var c=this._collections.slice(),a=0,e=this._collections;a<e.length;a++)this._processCollection(c,this,e[a]);for(a=0;a<c.length;a++)b.add(c[a].on("after-changes",this.refresh),"collections")};c.prototype._createNewInstance=function(b){return new e(b)};c.prototype._processCollection=function(b,c,a){var e=this;a&&(b.push(a),a.forEach(function(a){a&&
(c.push(a),e._processCollection(b,c,e.getChildrenFunction(a)))}))};return c}(f.declared(e));m([f.property()],a.prototype,"rootCollectionNames",void 0);m([f.property()],a.prototype,"root",void 0);m([f.property()],a.prototype,"getChildrenFunction",void 0);return a=m([f.subclass("esri.core.CollectionFlattener")],a)})},"esri/core/accessorSupport/decorators":function(){define("require exports ./decorators/aliasOf ./decorators/cast ./decorators/declared ./decorators/property ./decorators/reader ./decorators/shared ./decorators/subclass ./decorators/writer".split(" "),
function(a,h,p,m,f,e,l,g,c,b){(p);q(m);q(f);q(e);q(l);q(g);q(c);q(b)})},"esri/core/accessorSupport/decorators/aliasOf":function(){define(["require","exports","../metadata"],function(a,h,p){h.aliasOf=)},"esri/core/accessorSupport/decorators/declared":function(){define(["require","exports"],function(a,h){h.declared=)},"esri/core/accessorSupport/decorators/property":function(){define(["require","exports","../../lang","../metadata"],function(a,h,p,m){h.property=function(a){void 0===a&&(a={});return function(e,f){var g=e.constructor.prototype;(e=Object.getOwnPropertyDescriptor(e,f))&&(e.get||e.set)&&(a=p.clone(a),e.set&&(a.set=e.set),e.get&&(a.get=e.get));f=m.getPropertyMetadata(g,f);for(var c in a)g=a[c],Array.isArray(g)?f[c]=(f[c]||
[]).concat(g):f[c]=g}};h.propertyJSONMeta=)},"esri/core/accessorSupport/decorators/reader":function(){define(["require","exports","dojo/_base/lang","./property"],function(a,h,p,m){h.reader=function(a,e,l){var g,c;void 0===e||Array.isArray(e)?(c=a,l=e,g=[void 0]):(c=e,g=Array.isArray(a)?a:[a]);return })},"esri/core/accessorSupport/decorators/shared":function(){define(["require","exports"],function(a,h){h.shared=)},"esri/core/accessorSupport/decorators/subclass":function(){define(["require","exports","../../declare","../metadata"],function(a,
h,p,m){function f(b,c){b.read&&("function"===typeof b.read?c.push(b.read):"object"===typeof b.read&&b.read.reader&&c.push(b.read.reader))}nction g(b){var c={},a=["__bases__"],e=m.getPropertiesMetadata(b.prototype),g=l(b);Object.getOwnPropertyNames(b.prototype).filter(function(c){return-1!==a.indexOf(c)||e&&e.hasOwnProperty(c)||-1!==g.indexOf(b.prototype[c])?!1:!0}).forEach(;return c}function c(b){var c=Object.getOwnPropertyNames(b),a=Object.getPrototypeOf(b.prototype).constructor,e=Object.getOwnPropertyNames(Function);e.push("__bases__");var g=Object.getOwnPropertyNames(a),f={};c.filter(.forEach(function(c){f[c]=b[c]});return f}h.subclass=function(b){return function(a){var e=g(a),f=c(a);null!=b&&(e.declaredClass=b);a=p(a.__bases__,e);for(var q in f)a[q]=f[q];return a}}})},"esri/core/accessorSupport/decorators/writer":function(){define(["require","exports","dojo/_base/lang","./property"],function(a,h,p,m){h.writer=function(a,e){var f;void 0===e?(e=a,f=[void 0]):f=Array.isArray(a)?a:[a];return function(a,c,b){var g=a.constructor.prototype;
f.forEach(function(b){b=m.propertyJSONMeta(a,b,e);b.write&&"object"!==typeof b.write&&(b.write={});p.setObject("write.writer",g[c],b)})}}})},"esri/core/Collection":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper dojo/aspect ./accessorSupport/decorators ./accessorSupport/ensureType ./Accessor ./ArrayPool ./Evented ./ObjectPool ./Scheduler ./lang".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y){function t(d){return d?d.isInstanceOf&&d.isInstanceOf(B)?!0:
!1:!1}nction(){return function(){}})();a=);
var w=function(){},d=new q(a,!0,,k=new Set,v=new Set,A=new Set,z=new Map,D=0,B=C=function(b){(a,b);a.ofType=function(d){if(!d)return C;if(z.has(d))return z.get(d);var b=C.createSubclass({declaredClass:"esri.core.Collection\x3c"+d.prototype.declaredClass+
"\x3e"});Object.defineProperty(b.prototype,"itemType",{value:d});z.set(d,b);return b};a.prototype.normalizeCtorArgs=Object.defineProperty(a.prototype,"items",{get:function(){return this._items},set:enumerable:!0,configurable:!0});a.prototype.on=a.prototype.hasEventListener=a.prototype.add=a.prototype.addMany=function(d,b){void 0===b&&(b=this._items.length);if(this._emitBeforeChanges())return this;b=this.getNextIndex(b);this._splice.apply(this,[b,0].concat(u(d)));this._emitAfterChanges();return this};a.prototype.removeAll=a.prototype.clone=a.prototype.concat=a.prototype.drain=a.prototype.every=
function(d,b){return this._items.every(d,b)};a.prototype.filter=a.prototype.find=a.prototype.findIndex=a.prototype.flatten=a.prototype.forEach=a.prototype.getItemAt=function(d){return this._items[d]};a.prototype.getNextIndex=a.prototype.includes=
a.prototype.indexOf=a.prototype.join=a.prototype.lastIndexOf=a.prototype.map=a.prototype.reorder=a.prototype.pop=a.prototype.push=a.prototype.reduce=function(d,b){var k=this._items;
return 2===arguments.length?k.reduce(d,b):k.reduce(d)};a.prototype.reduceRight=a.prototype.remove=a.prototype.removeAt=a.prototype.removeMany=a.prototype.reverse=a.prototype.shift=a.prototype.slice=a.prototype.some=function(d,b){return this._items.some(d,b)};a.prototype.sort=
a.prototype.splice=a.prototype.toArray=function(){return this._items.slice()};a.prototype.toJSON=function(){return this.toArray()};a.prototype.toLocaleString=function(){return this._items.toLocaleString()};a.prototype.toString=function(){return this._items.toString()};a.prototype.unshift=a.prototype._createNewInstance=a.prototype._splice=function(b,k){for(var c=this,a=[],e=2;e<arguments.length;e++)a[e-2]=arguments[e];var n=this._items,g=this.constructor.prototype.itemType,v,f;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),
items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=x.schedule(this._boundDispatch));if(k){f=n.splice(b,k);if(this.hasEventListener("before-remove")){e=d.acquire();e.target=this;e.cancellable=!0;for(var q=0,t=f.length;q<t;q++)v=f[q],e.reset(v),this.emit("before-remove",e),e.defaultPrevented&&(f.splice(q,1),n.splice(b,0,v),b+=1,--q,--t);d.release(e)}this.length=this._items.length;if(this.hasEventListener("after-remove")){e=d.acquire();e.target=this;e.cancellable=!1;
t=f.length;for(q=0;q<t;q++)e.reset(f[q]),this.emit("after-remove",e);d.release(e)}this._notifyChangeEvent(null,f)}if(a&&a.length){g&&(a=a.map(l.ensureType.bind(null,g)));if(this.hasEventListener("before-add")){var r=d.acquire();r.target=this;r.cancellable=!0;a=a.filter(function(d){r.reset(d);c.emit("before-add",r);return!r.defaultPrevented});d.release(r)}n.splice.apply(n,[b,0].concat(a));this.length=this._items.length;if(this.hasEventListener("after-add")){e=d.acquire();e.target=this;e.cancellable=
!1;n=0;for(g=a;n<g.length;n++)v=g[n],e.reset(v),this.emit("after-add",e);d.release(e)}this._notifyChangeEvent(a,null)}return f};a.prototype._emitBeforeChanges=a.prototype._emitAfterChanges=a.prototype._notifyChangeEvent=a.prototype._dispatchColChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var d=this._notifications;this._notifications=null;for(var b=function(d){var b=d.changes;k.clear();v.clear();A.clear();for(var e=0;e<b.length;e++){var n=b[e],g=n.added,n=n.removed;if(g)if(0===A.size&&0===
v.size)for(var f=0,q=g;f<q.length;f++)g=q[f],k.add(g);else for(f=0,q=g;f<q.length;f++)g=q[f],v.has(g)?(A.add(g),v.delete(g)):A.has(g)||k.add(g);if(n)if(0===A.size&&0===k.size)for(f=0;f<n.length;f++)g=n[f],v.add(g);else for(f=0;f<n.length;f++)g=n[f],k.has(g)?k.delete(g):(A.delete(g),v.add(g))}var t=c.acquire();k.forEach(function(d){t.push(d)});var r=c.acquire();v.forEach(function(d){r.push(d)});var l=a._items,u=d.items,w=c.acquire();A.forEach(;if(d.listeners&&
(t.length||r.length||w.length))for(b={target:a,added:t,removed:r,moved:w},e=d.listeners.length,g=0;g<e;g++)n=d.listeners[g],n.removed||n.callback.call(a,b);c.release(t);c.release(r);c.release(w)},a=this,e=0;e<d.length;e++)b(d[e]);k.clear();v.clear();A.clear()}};return a}(e.declared(g,b));B.isCollection=t;m([e.property()],B.prototype,"length",void 0);m([e.property()],B.prototype,"items",null);var B=C=m([e.subclass("esri.core.Collection")],B),C;return B})},"esri/core/Evented":function(){define(["./declare",
"dojo/Evented"],function(a,h){return a(h,{declaredClass:"esri.core.Evented",hasEventListener:emit:function(a,m){if(this.hasEventListener(a))return m=m||{},m.target||(m.target=this),this.inherited(arguments,[a,m])}})})},"esri/core/HandleRegistry":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Accessor ./accessorSupport/decorators".split(" "),function(a,h,p,m,f,e){a=function(a){function e(){var c=
a.call(this)||this;c._groups=null;c._groups={};return c}p(e,a);e.prototype.destroy=Object.defineProperty(e.prototype,"size",{get:function(){var a=0,b=this._groups,e;for(e in b)a+=b[e].length;return a},enumerable:!0,configurable:!0});e.prototype.add=function(a,b){if(!this._isHandle(a)&&!Array.isArray(a))return this;b=this._getOrCreateGroup(b);if(Array.isArray(a))for(var c=0;c<a.length;c++)b.push(a[c]);else b.push(a);this.notifyChange("size");return this};
e.prototype.has=e.prototype.remove=function(a){if(Array.isArray(a))a.forEach(this.remove.bind(this));else{a=this._getGroup(a);if(!a)return this;for(var b=0;b<a.length;b++)a[b].remove();a.length=0;this.notifyChange("size")}return this};e.prototype.removeAll=function(){var a=this._groups,b;for(b in a)this.remove(b),delete a[b];return this};e.prototype._isHandle=e.prototype._getOrCreateGroup=function(a){return this._getGroup(a)||
(this._groups[this._ensureGroupName(a)]=[])};e.prototype._getGroup=e.prototype._ensureGroupName=return e}(e.declared(f));m([e.property({readOnly:!0})],a.prototype,"size",null);return a=m([e.subclass()],a)})},"esri/support/LayersMixin":function(){define(["../core/Accessor","../core/Collection","../core/Logger"],function(a,h,p){var m=function(a,f){for(var e,c=0,b=a.length;c<b;c++)if(e=a.getItemAt(c),e.id===
f||e.layers&&(e=m(e.layers,f)))return e},f=p.getLogger("esri.Map");return a.createSubclass({declaredClass:"esri.support.LayersMixin",destroy:function(){this._layersHandle.remove();this._layersHandle=null;this.layers.drain(this._lyrRemove,this)},properties:{layers:{type:h,get:function(){var a=this._get("layers");if(a)return a;a=new h;a.on("after-add",function(a){a=a.item;a.parent&&a.parent!==this&&a.parent.remove(a);a.parent=this;this.layerAdded(a);"elevation"===a.type&&f.error("Layer '"+a.title+", id:"+
a.id+"' of type '"+a.type+"' is not supported as an operational layer and will therefore be ignored.")}.bind(this));a.on("after-remove",function(a){a=a.item;a.parent=null;this.layerRemoved(a)}.bind(this));return a},set:function(a){var e=this._get("layers");e&&this.remove(e.toArray());this.addMany(a.toArray())}}},findLayerById:add:function(a,f){var e=this.layers;f=e.getNextIndex(f);a.parent===this?this.reorder(a,f):e.add(a,f)},addMany:function(a,f){var e=this.layers;
f=e.getNextIndex(f);a.slice().forEach(function(a){a.parent===this?this.reorder(a,f):(e.add(a,f),f+=1)},this)},remove:function(a){return this.layers.remove(a)},removeMany:function(a){return this.layers.removeMany(a)},removeAll:function(){return this.layers.removeAll()},reorder:function(a,f){return this.layers.reorder(a,f)},layerAdded:function(a){},layerRemoved:function(a){}})})},"esri/Ground":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators ./core/Accessor ./core/Collection ./core/collectionUtils ./core/Logger ./core/requireUtils ./layers/Layer".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q){var x=l.ofType(q),y=c.getLogger("esri.Ground");h=t=function(c){function e(b){b=c.call(this)||this;b.layers=new x;b.layers.on("after-add",function(b){b=b.item;"elevation"!==b.type&&y.error("Layer '"+b.title+", id:"+b.id+"' of type '"+b.type+"' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.")});return b}p(e,c);Object.defineProperty(e.prototype,"layers",{set:function(b){this._set("layers",g.referenceSetter(b,
this._get("layers"),x))},enumerable:!0,configurable:!0});e.prototype.queryElevation=function(c,e){var d=this;return b.when(a,"./layers/support/ElevationQuery").then(function(b){b=new b.ElevationQuery;var k=d.layers.filter(function(d){return"elevation"===d.type}).toArray();return b.queryAll(k,c,e)})};e.prototype.clone=return e}(f.declared(e));m([f.property({type:x}),f.cast(g.castForReferenceSetter)],h.prototype,"layers",null);h=t=m([f.subclass("esri.Ground")],
h);var t;return h})},"esri/core/collectionUtils":function(){define(["require","exports","./Collection"],function(a,h,p){h.referenceSetter=function(a,f,e){void 0===e&&(e=p);f||(f=new e);f.removeAll();a&&(Array.isArray(a)||a.isInstanceOf&&a.isInstanceOf(p))?f.addMany(a):f.add(a);return f};h.castForReferenceSetter=function(a){return a}})},"esri/core/requireUtils":function(){define(["require","exports","dojo/Deferred"],function(a,h,p){.when=m;h.getAbsMid=)},"esri/layers/Layer":function(){define("require dojo/Deferred ../core/Accessor ../core/Error ../core/Evented ../core/Identifiable ../core/Loadable ../core/urlUtils ../core/requireUtils ../core/promiseUtils ../core/Logger ../config ../kernel ../request ../geometry/SpatialReference ../geometry/Extent".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r){var n=0,w=q.getLogger("esri.layers.Layer");p=p.createSubclass([f,e,l],{declaredClass:"esri.layers.Layer",properties:{attributionDataUrl:null,credential:{value:null,readOnly:!0,dependsOn:["loaded","parsedUrl"],get:function(){var d=this.loaded&&this.parsedUrl&&y.id&&y.id.findCredential(this.parsedUrl.path)||null;d&&d.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));return d}},fullExtent:new r(-180,-90,180,90,u.WGS84),hasAttributionData:{readOnly:!0,dependsOn:["attributionDataUrl"],
get:,id:{get:function(){return Date.now().toString(16)+"-layer-"+n++}},legendEnabled:!0,listMode:"show",opacity:{value:1,type:Number,cast:function(d){return 0>d?0:1<d?1:d}},parsedUrl:{readOnly:!0,dependsOn:["url"],get:,popupEnabled:!0,refreshInterval:0,attributionVisible:!0,spatialReference:u.WGS84,title:null,token:{dependsOn:["credential.token"],get:function(){var d=this.get("parsedUrl.query.token"),
b=this.get("credential.token");return d||b||null},set:,type:{type:String,readOnly:!0,value:null,json:{read:!1}},url:{value:null},visible:!0},initialize:function(){this.otherwise(function(d){q.getLogger(this.declaredClass).error("#load()","Failed to load layer (title: '"+this.title+"', id: '"+this.id+"')",d)})},createLayerView:function(d){var k=this.viewModulePaths[d.type];return k?c.when(a,k).then(function(b){b.default&&(b=b.default);
return new b({layer:this,view:d})}.bind(this)):b.reject(new m("layerview:module-unavailable","No LayerView module available for layer '${layer.declaredClass}' and view type: '${view.type}'",{view:d,layer:this}))},destroyLayerView:function(d){d.destroy()},fetchAttributionData:function(){var d=this.attributionDataUrl;this.hasAttributionData&&d?d=t(d,{query:{f:"json"},responseType:"json"}).then(function(d){return d.data}):(d=new h,d.reject(new m("layer:no-attribution-data","Layer does not have attribution data")),
d=d.promise);return d},refresh:);p.fromArcGISServerUrl=function(d){"string"===typeof d&&(d={url:d});var b=c.when(a,"./support/arcgisLayers").then(function(b){return b.fromUrl(d)});b.otherwise(function(b){w.error("#fromArcGISServerUrl({ url: '"+d.url+"'})","Failed to create layer from arcgis server url",b)});return b};p.fromPortalItem=function(d){!d||d.portalItem||"object"!==typeof d||d.declaredClass&&"esri.portal.PortalItem"!==d.declaredClass||(d={portalItem:d});var b=
c.when(a,"../portal/support/portalLayers").then(function(b){return b.fromItem(d)});b.otherwise(function(b){var k=d&&d.portalItem;w.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+(k&&k.portal&&k.portal.url||x.portalUrl)+"', id: '"+(k&&k.id||"unset")+"')",b)});return b};return p})},"esri/core/Error":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(a,h,p,m,f){a=function(a){function e(g,c,b){var f=a.call(this,
g,c,b)||this;return f instanceof e?f:new e(g,c,b)}p(e,a);return e}(f);a.prototype.type="error";return a})},"esri/core/tsSupport/extendsHelper":function(){define([],function(){return )},"esri/core/Message":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","dojo/string"],function(a,h,p,m,f){return )})},"esri/core/Identifiable":function(){define(["./declare"],function(a){var h=0;return a(null,{constructor:function(){Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+h++})}})})},"esri/core/Loadable":function(){define("./Promise ./Accessor ./Error ./Warning dojo/aspect dojo/_base/lang dojo/Deferred".split(" "),
function(a,h,p,m,f,e,l){return a.createSubclass([h],{declaredClass:"esri.core.Loadable","-chains-":e.mixin(h._meta.chains,{load:"after"}),constructor:function(){this._set("loadWarnings",[]);var a=new l;this.addResolvingPromise(a.promise);f.around(this,"load",function(c){return function(){"not-loaded"===this.loadStatus&&(this.loadStatus="loading",c.apply(this),a.resolve(),a=null);return this}});this.then(function(a){this.loadStatus="loaded"}.bind(this),bind(this))},properties:{loaded:{readOnly:!0,dependsOn:["loadStatus"],get:,loadError:null,loadStatus:"not-loaded",loadWarnings:{type:[m],readOnly:!0}},load:function(){},cancelLoad:function(){if(this.isFulfilled())return this;this.loadError=new p("load:cancelled","Cancelled");this._promiseProps.cancel(this.loadError);return this}})})},"esri/core/Promise":function(){define("./declare dojo/promise/all dojo/aspect dojo/Deferred dojo/errors/create ./Scheduler".split(" "),
function(a,h,p,m,f,e){var l=function(b){if(!b.isFulfilled()){var a=b._promiseProps,c=a.resolvingPromises,g,f;a.allPromise&&a.allPromise.cancel();var q=new m;for(g=c.length-1;0<=g;g--)f=c[g],f.isCanceled&&f.isCanceled()?c.splice(g,1):f.then(null,null,a.resolver.progress);f=null;(a.allPromise=h(c.concat([q.promise]))).then(function(){a.resolver.resolve(b);b=a=q=a.allPromise=a.resolvingPromises=null},function(c){a.allPromise=null;if(!c||"cancel"!==c.dojoType){var e=Array.prototype.slice.call(arguments,
0);a.resolver.reject(e[0]);b=a=q=a.allPromise=a.resolvingPromises=null}});q&&e.schedule(}},g=f("CancelError",null,function(b){this.target=b}),c=function(b){return b||new g(this.instance)},b=function(b){this.instance=b;this.canceler=c.bind(this);this.resolver=new m;this.initialized=!1;this.resolvingPromises=[]};b.prototype={canceler:null,cancel:function(b){if(!this.resolver.isFulfilled()){this.allPromise.cancel();for(var a=this.resolvingPromises.concat(),c=a.length-1;0<=
c;c--)a[c].cancel(b);this.resolver.cancel(b)}}};return a(null,{declaredClass:"esri.core.Promise",constructor:function(){Object.defineProperty(this,"_promiseProps",{value:new b(this),enumerable:!1,configurable:!1,writable:!0});var a=p.after(this,"postscript",function(b,c){a.remove();a=null;l(this)},!0)},_promiseProps:null,always:function(b){return this.then(b,b)},then:function(b,a,c){var e=new m(this._promiseProps.canceler);b=e.then(b,a,c);this._promiseProps.resolver.then(e.resolve,e.reject,e.progress);
return b},isResolved:function(){return this._promiseProps.resolver.isResolved()},isRejected:function(){return this._promiseProps.resolver.isRejected()},isFulfilled:otherwise:function(b){return this.then(null,b)},addResolvingPromise:function(b){b&&!this.isFulfilled()&&(this._promiseProps.resolvingPromises.push(b),l(this))}})})},"dojo/promise/all":"esri/core/Warning":function(){define(["require","exports","./tsSupport/extendsHelper",
"./tsSupport/decorateHelper","./Message"],function(a,h,p,m,f){a=function(a){(e,a);return e}(f);a.prototype.type="warning";return a})},"esri/core/urlUtils":function(){define("require exports dojo/_base/window dojo/_base/lang dojo/_base/url dojo/io-query ../config ./lang ./sniff ./Logger ./Error".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){function x(d){var b={path:null,query:null},k=new f(d),a=d.indexOf("?");null===
k.query?b.path=d:(b.path=d.substring(0,a),b.query=e.queryToObject(k.query));k.fragment&&(b.hash=k.fragment,null===k.query&&(b.path=b.path.substring(0,b.path.length-(k.fragment.length+1))));return b}function y(b,k){void 0===b&&(b=!1);void 0===k&&(k=!0);var a,c=S.proxyUrl;if("string"===typeof b){if(a=b,a=/^\s*https:/i.test(a)||"https"===h.appUrl.scheme&&M(a),b=r(b))c=b.proxyUrl}else a=!!b;if(!c)throw Q.warn("esri/config: esriConfig.request.proxyUrl is not set. If making a request to a CORS-enabled\n server, please push the domain into esriConfig.request.corsEnabledServers."),
new q("urlutils:proxy-not-set","esri/config: esriConfig.request.proxyUrl is not set. If making a request to a CORS-enabled\n server, please push the domain into esriConfig.request.corsEnabledServers.");var e;a&&k&&"https"===h.appUrl.scheme&&(k=V(c),d(k)&&(c=k,e=1));c=x(c);c._xo=e;return c}function t(d){var b=d.indexOf("?");-1!==b?(U.path=d.slice(0,b),U.query=d.slice(b+1)):(U.path=d,U.query=null);return U}function u(d){d=t(d).path;d&&"/"===d[d.length-1]||(d+="/");d=P(d,!0);return d=d.toLowerCase()}
function r(d){var b=S.proxyRules;d=u(d);for(var k=0;k<b.length;k++)if(0===d.indexOf(b[k].urlPrefix))return b[k]}function n(d){d=D(d);var b=d.indexOf("/sharing");return 0<b?d.substring(0,b):d.replace(/\/+$/,"")}unction d(d){return c("esri-phonegap")?!0:c("esri-cors")?null!=k(d):!1}function k(d,b){void 0===b&&(b=!1);"string"===typeof d&&(d=F(d)?J(d):h.appUrl);
for(var k=S.corsEnabledServers||[],a=0;a<k.length;a++)for(var c=k[a],e=void 0,e="string"===typeof c?v(c):c.host?v(c.host):[],n=0;n<e.length;n++)if(w(d,e[n]))return b?a:c;return b?-1:null}function v(d){h.corsServersUrlCache[d]||(ga.test(d)||M(d)?h.corsServersUrlCache[d]=[new f(A(d))]:h.corsServersUrlCache[d]=[new f("http://"+d),new f("https://"+d)]);return h.corsServersUrlCache[d]}function A(d,b,k){void 0===b&&(b=h.appBaseUrl);if(M(d))return k&&k.preserveProtocolRelative?d:"http"===h.appUrl.scheme&&
h.appUrl.authority===C(d).slice(2)?"http:"+d:"https:"+d;if(ga.test(d))return d;k=B;if("/"===d[0]){var a=b.indexOf("//"),a=b.indexOf("/",a+2);b=-1===a?b:b.slice(0,a)}return k(b,d)}unction D(d){d=A(d);d=I(d);return d=d.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function B(){for(var d=[],b=0;b<arguments.length;b++)d[b]=arguments[b];if(d&&d.length){b=[];if(F(d[0])){var k=d[0],a=k.indexOf("//");b.push(k.slice(0,a+1));R.test(d[0])&&(b[0]+="/");d[0]=k.slice(a+
2)}else"/"===d[0][0]&&b.push("");d=d.reduce([]);for(k=0;k<d.length;k++)a=d[k],".."===a&&0<b.length?b.pop():!a||"."===a&&0!==b.length||b.push(a);return b.join("/")}}tion E(d){return L.test(d)||
"http"===h.appUrl.scheme&&M(d)}function V(d){return M(d)?"https:"+d:d.replace(L,"https:")}function P(d,b){void 0===b&&(b=!1);if(M(d))return d.slice(2);d=d.replace(ga,"");b&&1<d.length&&"/"===d[0]&&"/"===d[1]&&(d=d.slice(2));return d}function I(d){var b=l.request.httpsDomains;if(!E(d))return d;d=d.trim();var k=d.indexOf("/",7),a;a=-1===k?d:d.slice(0,k);a=a.toLowerCase().slice(7);if("http"===h.appUrl.scheme&&a===h.appUrl.authority)return d;if("https"===h.appUrl.scheme&&a===h.appUrl.authority||b&&b.some(function(d){return a===
d||g.endsWith(a,"."+d)}))d=V(d);return d}=p.global;var Q=b.getLogger("esri.core.urlUtils"),S=l.request,ga=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,L=/^\s*http:/i,R=/^\s*file:/i;h.appUrl=new f(a.location);h.corsServersUrlCache={};h.appBaseUrl=);h.urlToObject=x;h.getProxyUrl=y;h.addProxy=function(d){var b=r(d),k,a;b?(a=t(b.proxyUrl),k=a.path,a=a.query?e.queryToObject(a.query):null):S.forceProxy&&(a=y(),k=a.path,a=a.query);k&&(b=x(d),d=k+"?"+b.path,(k=e.objectToQuery(m.mixin(a||{},b.query)))&&(d=d+"?"+k));return d};var U={path:"",query:""};h.addProxyRule=function(d){d={proxyUrl:d.proxyUrl,urlPrefix:u(d.urlPrefix)};for(var b=S.proxyRules,k=d.urlPrefix,a=b.length,c=0;c<b.length;c++){var e=b[c].urlPrefix;if(0===k.indexOf(e)){if(k.length===
e.length)return-1;a=c;break}0===e.indexOf(k)&&(a=c+1)}b.splice(a,0,d);return a};h.getProxyRule=r;h.hasSamePortal=function(d,b){d=n(d);b=n(b);return P(d)===P(b)};h.hasSameOrigin=w;h.canUseXhr=d;h.getCorsConfig=k;h.makeAbsolute=A;h.makeRelative=z;h.normalize=D;h.join=B;h.getOrigin=C;h.isAbsolute=F;h.isDataProtocol=K;h.isProtocolRelative=M;h.read=function(d,b){b=b&&b.url&&b.url.path;return d&&b?A(d,b,{preserveProtocolRelative:!0}):d};h.write=function(d,b){if(!d)return d;d=A(d);(b=b&&b.url&&b.url.path)&&
(d=z(d,b,b));return d}})},"dojo/_base/url":"esri/config":function(){define(["require","exports","dojo/_base/window"],function(a,h,p){return{screenDPI:96,geometryService:null,geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",
geoRSSServiceUrl:null,kmlServiceUrl:null,portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{corsDetection:!(p.global&&p.global.cordova),corsDetectionTimeout:15,corsEnabledServers:"basemaps.arcgis.com basemapsbeta.arcgis.com basemapsbetadev.arcgis.com basemapsdev.arcgis.com dev.arcgis.com devext.arcgis.com elevation3d.arcgis.com elevation3ddev.arcgis.com js.arcgis.com jsdev.arcgis.com jsqa.arcgis.com geocode.arcgis.com geocodedev.arcgis.com geocodeqa.arcgis.com geoenrich.arcgis.com geoenrichdev.arcgis.com geoenrichqa.arcgis.com localvtiles.arcgis.com qaext.arcgis.com server.arcgisonline.com services.arcgis.com services.arcgisonline.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com services6.arcgis.com services7.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com static.arcgis.com staticdev.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com tilesdevext.arcgis.com tilesqa.arcgis.com utility.arcgisonline.com www.arcgis.com".split(" "),
corsStatus:{},forceProxy:!1,maxUrlLength:2E3,maxWorkers:5,proxyRules:[],proxyUrl:null,timeout:6E4,useCors:"with-credentials",useWorkers:"on-request",httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},useSpatialIndex:!1}})},"esri/core/sniff":function(){define(["dojo/_base/window","dojo/sniff","../kernel"],function(a,h,p){var m=h("ff"),f=h("ie"),e=void 0===
f&&7<=h("trident"),l=h("webkit"),g=h("opera"),c=h("chrome"),b=h("safari"),q=a.global;a=navigator.userAgent;var x;(x=a.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&h.add("esri-iphone",parseFloat(x[2].replace("_",".")));(x=a.match(/Android\s+(\d+\.\d+)/i))&&h.add("esri-android",parseFloat(x[1]));(x=a.match(/Fennec\/(\d+\.\d+)/i))&&h.add("esri-fennec",parseFloat(x[1]));0<=a.indexOf("BlackBerry")&&0<=a.indexOf("WebKit")&&h.add("esri-blackberry",1);h.add("esri-touch",h("esri-iphone")||h("esri-android")||
h("esri-blackberry")||6<=h("esri-fennec")||(m||l)&&document.createTouch?!0:!1);(x=a.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&h.add("esri-mobile",x);h.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled);p._getDOMAccessor=h.add("esri-phonegap",!!q.cordova);h.add("esri-cors",h("esri-phonegap")||"XMLHttpRequest"in q&&"withCredentials"in new XMLHttpRequest);
if(h("host-webworker"))return h;h.add("esri-file-upload",q.FormData&&q.FileList?!0:!1);h.add("esri-workers",q.Worker?!0:!1);h.add("esri-transforms",e||9<=f||3.5<=m||4<=c||3.1<=b||10.5<=g||3.2<=h("esri-iphone")||2.1<=h("esri-android"));h.add("esri-transitions",e||10<=f||4<=m||4<=c||3.1<=b||10.5<=g||3.2<=h("esri-iphone")||2.1<=h("esri-android"));h.add("esri-transforms3d",e||10<=m||12<=c||4<=b||3.2<=h("esri-iphone")||3<=h("esri-android"));h.add("esri-url-encodes-apostrophe",;3>h("esri-android")&&(h.add("esri-transforms",!1,!1,!0),h.add("esri-transitions",!1,!1,!0),h.add("esri-transforms3d",!1,!1,!0));p._css=function(a){var e=h("esri-transforms3d");void 0!==a&&null!==a?e=a:e&&(c||b&&!h("esri-iphone"))&&(e=!1);var q=e?"translate3d(":"translate(",r=e?c?",-1px)":",0px)":")",n=e?"scale3d(":"scale(",w=e?",1)":")",d=e?"rotate3d(0,0,1,":"rotate(",k=e?"matrix3d(":"matrix(",v=e?",0,0,":",",x=e?",0,0,0,0,1,0,":",",z=e?",0,1)":")";return{names:{transition:l&&
"-webkit-transition"||m&&"MozTransition"||g&&"OTransition"||f&&"msTransition"||"transition",transform:l&&"-webkit-transform"||m&&"MozTransform"||g&&"OTransform"||f&&"msTransform"||"transform",transformName:l&&"-webkit-transform"||m&&"-moz-transform"||g&&"-o-transform"||f&&"-ms-transform"||"transform",origin:l&&"-webkit-transform-origin"||m&&"MozTransformOrigin"||g&&"OTransformOrigin"||f&&"msTransformOrigin"||"transformOrigin",endEvent:l&&"webkitTransitionEnd"||m&&"transitionend"||g&&"oTransitionEnd"||
f&&"MSTransitionEnd"||"transitionend"},translate:scale:rotate:matrix:function(d){return d.m?(d=d.m,k+d[0].toFixed(10)+","+d[1].toFixed(10)+v+d[2].toFixed(10)+","+d[3].toFixed(10)+x+d[4].toFixed(10)+(m?"px,":",")+d[5].toFixed(10)+(m?"px":"")+z):k+d.xx.toFixed(10)+","+d.yx.toFixed(10)+v+d.xy.toFixed(10)+","+d.yy.toFixed(10)+x+d.dx.toFixed(10)+(m?"px,":",")+d.dy.toFixed(10)+(m?"px":"")+z},matrix3d:function(d){d=
d.m;return"matrix3d("+d[0].toFixed(10)+","+d[1].toFixed(10)+",0,0,"+d[2].toFixed(10)+","+d[3].toFixed(10)+",0,0,0,0,1,0,"+d[4].toFixed(10)+","+d[5].toFixed(10)+",0,1)"},getScaleFromMatrix:};h.add("esri-webgl",function(){var b;try{if(!q.WebGLRenderingContext)throw 0;b=document.createElement("canvas")}catch(n){return!1}for(var a=["webgl","experimental-webgl",
"webkit-3d","moz-webgl"],c=null,e=0;e<a.length;++e){try{c=b.getContext(a[e])}catch(n){}if(c)break}b=c;if(!b)return!1;b=b.getParameter(b.VERSION);return b?(b=b.match(/^WebGL\s+([\d.]*)/))&&.91<parseFloat(b[1]):!1});return h})},"esri/kernel":function(){define([],},"esri/core/promiseUtils":function(){define(["require","exports","dojo/Deferred","./Error"],function(a,h,p,m){.eachAlways=f;h.create=function(a){var e=new p;a(function(a){void 0===a&&(a=null);return e.resolve(a)},e.reject);return e.promise};h.reject=h.resolve=h.after=h.timeout=h.wrapCallback=)},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/Deferred dojo/_base/lang dojo/_base/url dojo/request dojo/io-query dojo/when ./kernel ./config ./core/sniff ./core/lang ./core/urlUtils ./core/deferredUtils ./core/promiseUtils dojo/has!host-browser?dojo/io/script dojo/has!host-browser?dojo/io/iframe dojo/has!host-browser?dojo/dom-construct".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d){function k(d,b){var k=g.objectToQuery(d.content);k&&(d.url+=(-1===d.url.indexOf("?")?"?":"\x26")+k);if(2E3<d.url.length)return r.reject(f.mixin(Error(),{message:"When using responseType 'image', URL length cannot exceed 2000 characters."}));var a=new Image;d.allowImageDataAccess&&(d.withCredentials?a.crossOrigin="use-credentials":b&&(a.crossOrigin="anonymous"));var c=!1,e=new m(;b=function(d){a.onload=
a.onerror=a.onabort=null;c||e.reject(d)};a.onload=a.onerror=b;a.onabort=b;a.alt="";a.src=d.url;return e.promise}unction A(a,c,e){var v=!!a.useProxy,q=a.method||"auto",r;r=a.crossOrigin;a=f.mixin({},a);a._ssl&&(a.url=a.url.replace(/^http:/i,"https:"));var u=a.content,A=a.url,z=c&&a.form;r=y.isDefined(r)?r:M.useCors;a.load=function(d){var b;d&&(d.error?(b=f.mixin(Error(),
d.error),b.log=p.isDebug):"error"===d.status&&(b=f.mixin(Error(),d),b.log=p.isDebug),b&&!y.isDefined(b.httpCode)&&(b.httpCode=b.code));return b||d};a.error=function(d,b){b&&b.xhr&&b.xhr.abort();d instanceof Error||(d=f.mixin(Error(),d));d.log=p.isDebug;return d};a._token&&(a.content=a.content||{},a.content.token=a._token);var C=0,F;A&&(F=g.objectToQuery(u),C=F.length+A.length+1,x("esri-url-encodes-apostrophe")&&(C=F.replace(/'/g,"%27").length+A.length+1));a.timeout=y.isDefined(a.timeout)?a.timeout:
M.timeout;a.handleAs=a.handleAs||"json";try{var D,B,E=r&&t.canUseXhr(a.urlObj)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(a.url),I=t.hasSameOrigin(a.urlObj,t.appUrl)||E,J="post"===q||c||C>M.maxUrlLength?!0:!1,Q=I||-1===a.handleAs.indexOf("json")||!a.callbackParamName||c?!1:!0,P=t.getProxyRule(a.url)||M.forceProxy||v||!("image"===a.handleAs&&!a.allowImageDataAccess||Q&&!J||I)?!0:!1;c&&!x("esri-file-upload")&&!P&&E&&(P=!0);if((x("host-browser")||x("host-webworker"))&&P)if(D=t.getProxyUrl(A,
r),B=D.path,D._xo&&(E=!0),!J&&B.length+1+C>M.maxUrlLength&&(J=!0),a.url=B+"?"+A,J)a.content=f.mixin(D.query||{},u);else{var ta=g.objectToQuery(f.mixin(D.query||{},u));ta&&(a.url+=(-1===A.indexOf("?")?"?":"\x26")+ta);a.content=null}if((x("host-browser")||x("host-webworker"))&&Q&&!J)return!y.isDefined(a.isAsync)&&4>x("ff")&&(a.isAsync=!0),n.get(K?K(a):a);var ma=a.headers;!x("host-browser")&&!x("host-webworker")||ma&&ma.hasOwnProperty("X-Requested-With")||(ma=a.headers=ma||{},ma["X-Requested-With"]=
null);if(x("host-browser")&&c){var wa=a.callbackParamName||"callback.html",na=a.callbackElementName||"textarea",sa,Ea,pa,qa,ua=z.elements?z.elements.length:0,va;if(u=a.content)for(sa in u)if(pa=u[sa],y.isDefined(pa)){Ea=null;for(qa=0;qa<ua;qa++)if(va=z.elements[qa],va.name===sa){Ea=va;break}Ea?Ea.value=pa:e?z.append(sa,pa):z.appendChild(d.create("input",{type:"hidden",name:sa,value:pa}))}if(x("esri-file-upload"))h.forEach(z.elements,,a.contentType=!1,a.postData=
e?z:new FormData(z),delete a.form;else{z.enctype="multipart/form-data";9>x("ie")&&(z.encoding="multipart/form-data");z.method="post";h.some(z.elements,function(d){return d.name===wa})||z.appendChild(d.create("input",{type:"hidden",name:wa,value:na}));if(-1!==A.toLowerCase().indexOf("addattachment")||-1!==A.toLowerCase().indexOf("updateattachment"))a.url=A+(-1===A.indexOf("?")?"?":"\x26")+wa+"\x3d"+na,P&&(a.url=B+"?"+a.url);delete a.content}}if(E&&!a.hasOwnProperty("withCredentials")&&"with-credentials"===
M.useCors){e=P?B:A;var Ca=t.getCorsConfig(e);if(Ca&&Ca.hasOwnProperty("withCredentials"))Ca.withCredentials&&(a.withCredentials=!0);else if(b.id){var Fa=b.id.findServerInfo(e);Fa&&Fa.webTierAuth&&(a.withCredentials=!0)}}a=K?K(a):a;if("image"===a.handleAs)return k(a,E);if(J){a.data=a.content;if(x("host-browser")&&c&&!x("esri-file-upload"))return w.send(a);!P&&x("safari")&&(a.url+=(-1===a.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+V++);return l.post(a.url,a)}a.query=a.content;return l.get(a.url,
a)}catch(Aa){return c=new m,c.reject(a.error(Aa)),c}}function z(d){var b=M.corsStatus,k=t.getCorsConfig(d,!0);-1<k&&M.corsEnabledServers.splice(k,1);b[v(d)]=1;return k}function D(d){var b=M.corsStatus;try{var k=v(d.url);if(M.corsDetection&&M.useCors&&x("esri-cors")&&d.url&&-1!==d.url.toLowerCase().indexOf("/rest/services")&&!t.hasSameOrigin(d.urlObj,t.appUrl)&&!t.canUseXhr(d.urlObj)){if(b[k])return b[k];var a=new m;b[k]=a.promise;var c=d.url.substring(0,d.url.toLowerCase().indexOf("/rest/")+6)+"info";
l.get(c,{query:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null},timeout:1E3*M.corsDetectionTimeout}).then(function(b){b?(t.canUseXhr(d.url)||M.corsEnabledServers.push(k),a.resolve()):a.reject()},function(d){a.reject()});return a.promise}}catch(L){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}}function B(d,k,c,e){function n(d){d._pendingDfd=A(c,F,m);if(d._pendingDfd){var k=!!d._pendingDfd.response;(d._pendingDfd.response||d._pendingDfd).then(function(b){var a=
k?b.data:b;b=k?b.getHeader.bind(b):P;var c=null;d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;if(a&&(a.error?(c=f.mixin(Error(),a.error),c.log=p.isDebug):"error"===a.status&&(c=f.mixin(Error(),a),c.log=p.isDebug),c&&!y.isDefined(c.httpCode)&&(c.httpCode=c.code),c))throw c;d.resolve({data:a,url:e.url,requestOptions:e.requestOptions,getHeader:b});d._pendingDfd=null}).then(null,function(k){var a,n,g;k&&(a=k.code,n=k.subcode,g=(g=k.messageCode)&&g.toUpperCase());if(k&&403==a&&(4==n||k.message&&-1<k.message.toLowerCase().indexOf("ssl")&&
-1===k.message.toLowerCase().indexOf("permission"))){if(!c._ssl){c._ssl=c._sslFromServer=!0;B(d,!0,c,e);return}}else if(k&&415==k.status){if(z(c.url),!c._err415){c._err415=1;B(d,!0,c,e);return}}else if(b.id&&-1!==h.indexOf(b.id._errorCodes,a)&&!b.id._isPublic(c.url)&&!q&&(403!=a||-1===h.indexOf(E,g)&&(!y.isDefined(n)||2==n&&c._token))){C(d,c,e,k);return}d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;d.reject(k);d._pendingDfd=null})}else{d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;var a=Error("Deferred object is missing");
a.log=p.isDebug;d.reject(a);d._pendingDfd=null}}var g=c.form,q=c.disableIdentityLookup,r=c._preLookup,u=!1;if(x("esri-workers")&&!1!==M.useWorkers)if(!0===c.useWorkers||!0===M.useWorkers)u=!0;else if(c.workerOptions){var w=c.workerOptions;if(w.callback||w.worker&&w.worker.worker instanceof Worker)u=!0}var m=g&&x("esri-file-upload")&&g instanceof FormData,F=g&&(g.elements?h.some(g.elements,function(d){return"file"===d.type}):m),D=-1!==c.url.toLowerCase().indexOf("token\x3d")||c.content&&c.content.token||
F&&h.some(g.elements,function(d){return"token"===d.name})?1:0;if(!k){d.then(function(d){if((/\/sharing\/rest\/accounts\/self/i.test(c.url)||/\/sharing\/rest\/portals\/self/i.test(c.url))&&!D&&!c._token&&d.user&&d.user.username){var k=M.corsEnabledServers,a=t.getCorsConfig(c.url,!0),e={host:v(c.url),withCredentials:!0};if(-1===a)k.push(e);else{var n=k[a];"object"===typeof n?n.withCredentials=!0:k.splice(a,1,e)}}if(k=c._credential)if(a=(a=b.id.findServerInfo(k.server))&&a.owningSystemUrl)a=a.replace(/\/?$/,
"/sharing"),(k=b.id.findCredential(a,k.userId))&&-1===b.id._getIdenticalSvcIdx(a,k)&&k.resources.splice(0,0,a);return d}).always(function(d){delete c._credential;d&&(d.ssl=!!c._ssl)});var K=c.load,I=c.error;K&&d.then(function(b){var k=d._pendingDfd,k=k&&k.ioArgs;return K.call(k&&k.args,b,k)});I&&d.then(null,}!b.id||D||c._token||b.id._isPublic(c.url)||q&&!r||!(k=b.id.findCredential(c.url))||(c._token=k.token,c._ssl=k.ssl);
u?c.workerOptions&&c.workerOptions.worker?(l=c.workerOptions.worker,n(d)):a(["./workers/RequestClient"],function(b){if(c.workerOptions){var k=c.workerOptions;l=b.getClient(k.callback,k.cbFunction)}else l=b.getClient();n(d)}):n(d);return d.promise}function C(d,k,a,c){d._pendingDfd=b.id.getCredential(k.url,{token:k._token,error:c});d._pendingDfd.then(.then(null,}function F(d,
b){"string"!==typeof d&&console.error("esri/request: the first parameter should be a url string");var k=f.mixin({},b),a={url:d,requestOptions:f.mixin({},b)};k.content=k.query;delete k.query;k.preventCache=!!k.cacheBust;delete k.cacheBust;k.handleAs=k.responseType;delete k.responseType;"array-buffer"===k.handleAs&&(k.handleAs="arraybuffer");if("image"===k.handleAs){if(x("host-webworker"))return r.reject(f.mixin(Error(),{message:"The responseType 'image' is not supported in Web Workers or Node environment."}));
k.preventCache&&(k.content=k.content||{},k.content["request.preventCache"]=Date.now());k.method="auto"}k.url=t.normalize(d);"file"!==t.appUrl.scheme&&(k.url=t.makeAbsolute(k.url));k.urlObj=new e(k.url);var n=u.makeDeferredCancellingPending();c(D(k)).always(;return n.promise}var K,M=q.request,E=["COM_0056","COM_0057"],V=0,P=function(){return null};F._makeRequest=A;F._processRequest=B;F._disableCors=z;F._detectCors=D;F.setRequestPreCallback=function(d){K=d};return F})},"dojo/request":"dojo/request/default":function(){define(["exports","require","../has"],function(a,h,p){var m=p("config-requestProvider"),f;if(p("host-browser")||p("host-webworker"))f="./xhr";m||(m=f);a.getPlatformDefaultId=function(){return f};a.load=function(a,l,g,c){h(["platform"==a?f:m],function(b){g(b)})}})},"esri/core/deferredUtils":function(){define(["dojo/Deferred"],function(a){var h={makeDeferredCancellingPending:function(){var p={},m=h._dfdCanceller.bind(null,p),m=new a(m);return p.deferred=
m},_dfdCanceller:function(a){a=a.deferred?a.deferred:a;a.canceled=!0;var m=a._pendingDfd;a.isResolved()||!m||m.isResolved()||m.cancel();a._pendingDfd=null},_fixDfd:_resDfd:;return h})},"esri/geometry/SpatialReference":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators ./support/spatialReferenceUtils".split(" "),
function(a,h,p,m,f,e,l){a=b=function(a){function e(b){b=a.call(this)||this;b.latestWkid=null;b.wkid=null;b.wkt=null;return b}p(e,a);e.prototype.normalizeCtorArgs=function(b){return b&&"object"===typeof b?b:(a={},a["string"===typeof b?"wkt":"wkid"]=b,a);var a};Object.defineProperty(e.prototype,"isWGS84",{get:function(){return 4326===this.wkid},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isWebMercator",{get:function(){return-1!==g.indexOf(this.wkid)},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"isGeographic",{get:function(){return l.isGeographic(this)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isWrappable",{get:enumerable:!0,configurable:!0});e.prototype.writeWkt=function(b,a){this.wkid||(a.wkt=b)};e.prototype.clone=function(){if(this===b.WGS84)return b.WGS84;if(this===b.WebMercator)return b.WebMercator;var a=new b;null!=this.wkid?(a.wkid=this.wkid,null!=this.latestWkid&&(a.latestWkid=
this.latestWkid),null!=this.vcsWkid&&(a.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(a.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(a.wkt=this.wkt);return a};e.prototype.equals=function(b){if(b){if(this===b)return!0;if(null!=this.wkid||null!=b.wkid)return this.wkid===b.wkid||this.isWebMercator&&b.isWebMercator||null!=b.latestWkid&&this.wkid===b.latestWkid||null!=this.latestWkid&&b.wkid===this.latestWkid;if(this.wkt&&b.wkt)return this.wkt.toUpperCase()===b.wkt.toUpperCase()}return!1};e.fromJSON=
function(a){if(!a)return null;if(a.wkid){if(102100===a.wkid)return b.WebMercator;if(4326===a.wkid)return b.WGS84}var c=new b;c.read(a);return c};return e}(e.declared(f));a.WGS84=null;a.WebMercator=null;m([e.property({dependsOn:["wkid"],readOnly:!0})],a.prototype,"isWGS84",null);m([e.property({dependsOn:["wkid"],readOnly:!0})],a.prototype,"isWebMercator",null);m([e.property({dependsOn:["wkid","wkt"],readOnly:!0})],a.prototype,"isGeographic",null);m([e.property({dependsOn:["wkid"],readOnly:!0})],a.prototype,
"isWrappable",null);m([e.property({json:{write:!0}})],a.prototype,"latestWkid",void 0);m([e.property({json:{write:!0}})],a.prototype,"wkid",void 0);m([e.property()],a.prototype,"wkt",void 0);m([e.writer("wkt")],a.prototype,"writeWkt",null);m([e.property({json:{write:!0}})],a.prototype,"vcsWkid",void 0);m([e.property({json:{write:!0}})],a.prototype,"latestVcsWkid",void 0);a=b=m([e.subclass("esri.SpatialReference")],a);a.WGS84=new a(4326);a.WebMercator=new a({wkid:102100,latestWkid:3857});Object.freeze&&
(Object.freeze(a.WGS84),Object.freeze(a.WebMercator));var g=[102113,102100,3857,3785],c=[102113,102100,3857,3785,4326],b;return a})},"esri/core/JSONSupport":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./declare ./accessorSupport/read ./accessorSupport/write ./accessorSupport/decorators".split(" "),function(a,h,p,m,f,e,l,g,c){function b(b,a){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");var c=new this;
c.read(b,a);return c}var q=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}p(a,b);a.prototype.read=function(b,a){l.default(this,b,a);return this};a.prototype.write=function(b,a){return g.default(this,b||{},a)};a.prototype.toJSON=function(b){return this.write(null,b)};return a}(c.declared(f)),q=m([c.subclass("esri.core.JSONSupport")],q);q.prototype.toJSON.isDefaultToJSON=!0;e.after(function(a){e.hasMixin(a,q)&&(a.fromJSON=b.bind(a))});return q})},"esri/core/accessorSupport/read":function(){define("require exports dojo/_base/lang ./utils ./get ./extensions/serializableProperty".split(" "),
function(a,h,p,m,f,e){function l(a,b,q){void 0===q&&(q=g);for(var c=m.getProperties(a),l=c.metadatas,t={},u=0,r=Object.getOwnPropertyNames(b);u<r.length;u++){var n=t,w=l,d=r[u],k=b,v=q,A=e.originSpecificReadPropertyDefinition(w[d],v);A&&(!A.read||!1!==A.read.enabled&&!A.read.source)&&(n[d]=!0);for(var h=0,p=Object.getOwnPropertyNames(w);h<p.length;h++){var B=p[h],A=e.originSpecificReadPropertyDefinition(w[B],v),C;a:{C=d;var F=k;if(A&&A.read&&!1!==A.read.enabled&&A.read.source)if(A=A.read.source,"string"===
typeof A){if(A===C||-1<A.indexOf(".")&&0===A.indexOf(C)&&f.exists(A,F)){C=!0;break a}}else for(var K=0;K<A.length;K++){var M=A[K];if(M===C||-1<M.indexOf(".")&&0===M.indexOf(C)&&f.exists(M,F)){C=!0;break a}}C=!1}C&&(n[B]=!0)}}c.setDefaultOrigin(q.origin);u=0;for(t=Object.getOwnPropertyNames(t);u<t.length;u++)r=t[u],w=(n=e.originSpecificReadPropertyDefinition(l[r],q).read)&&n.source,d=void 0,d=w&&"string"===typeof w?f.valueOf(b,w):b[r],n&&n.reader&&(d=n.reader.call(a,d,b,q)),void 0!==d&&c.set(r,d);
c.setDefaultOrigin("user")}var g={origin:"service"};h.read=l;h.readLoadable=function(a,b,e,f){void 0===f&&(f=g);b=p.mixin({},f,{messages:[]});e(b);b.messages.forEach(function(b){"warning"!==b.type||a.loaded?f&&f.messages.push(b):a.loadWarnings.push(b)})};Object.defineProperty(h,"__esModule",{value:!0});h.default=l})},"esri/core/accessorSupport/write":function(){define(["require","exports","./PropertyOrigin","./utils","./extensions/serializableProperty"],function(a,h,p,m,f){function e(a,c,b,e,f,l){if(!e||
!e.write)return!1;var g=a.get(b);if(void 0===g)return!1;!f&&e.write.overridePolicy&&(a=e.write.overridePolicy.call(a,g,b,l),void 0!==a&&(f=a));f||(f=e.write);return!f||!1===f.enabled||!f.allowNull&&null===g||!f.ignoreOrigin&&l&&l.origin&&c.store.originOf(b)<p.nameToId(l.origin)?!1:!0}function l(a,c,b){var g=m.getProperties(a),l=g.metadatas,h;for(h in l){var t=f.originSpecificWritePropertyDefinition(l[h],b);if(e(a,g,h,t,null,b)){var u=a.get(h),r={};t.write.writer.call(a,u,r,t.write.target||h,b);t=
r;0<Object.keys(t).length&&(c=m.merge(c,t),b&&b.writtenProperties&&b.writtenProperties.push({target:a,propName:h,oldOrigin:p.idToReadableName(g.store.originOf(h)),newOrigin:b.origin}))}}return c}h.willPropertyWrite=function(a,c,b,q){var g=m.getProperties(a),l=f.originSpecificWritePropertyDefinition(g.metadatas[c],q);return l?e(a,g,c,l,b,q):!1};h.write=l;Object.defineProperty(h,"__esModule",{value:!0});h.default=l})},"esri/geometry/support/spatialReferenceUtils":function(){define(["require","exports",
"./WKIDUnitConversion"],function(a,h,p){h.isGeographic=function(a){return a.wkid?null==p[a.wkid]:a.wkt?/^\s*GEOGCS/i.test(a.wkt):!1};h.getInfo=a=[-2.0037508342788905E7,2.0037508342788905E7];h=[-2.0037508342787E7,2.0037508342787E7];var m={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:a,origin:h,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:a,origin:h,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:a,origin:h,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:a,origin:h,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}}})},"esri/geometry/support/WKIDUnitConversion":function(){define([],function(){var a,h={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,
2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,
3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,
3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,
3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,
5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,
6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,
6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,
6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,
6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,
7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,
7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,
26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,54034:0,
65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,
103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,
103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,
103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,
103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(a=2E3;2045>=a;a++)h[a]=0;for(a=2056;2065>=a;a++)h[a]=0;for(a=2067;2135>=a;a++)h[a]=0;for(a=2137;2154>=a;a++)h[a]=0;for(a=2161;2170>=a;a++)h[a]=0;for(a=2172;2193>=a;a++)h[a]=0;for(a=2195;2198>=a;a++)h[a]=0;for(a=2200;2203>=a;a++)h[a]=0;for(a=2205;2217>=a;a++)h[a]=0;for(a=2222;2224>=a;a++)h[a]=1;for(a=2225;2250>=a;a++)h[a]=2;for(a=2251;2253>=
a;a++)h[a]=1;for(a=2257;2264>=a;a++)h[a]=2;for(a=2274;2279>=a;a++)h[a]=2;for(a=2280;2282>=a;a++)h[a]=1;for(a=2283;2289>=a;a++)h[a]=2;for(a=2290;2292>=a;a++)h[a]=0;for(a=2308;2313>=a;a++)h[a]=0;for(a=2315;2491>=a;a++)h[a]=0;for(a=2494;2866>=a;a++)h[a]=0;for(a=2867;2869>=a;a++)h[a]=1;for(a=2870;2888>=a;a++)h[a]=2;for(a=2891;2895>=a;a++)h[a]=2;for(a=2896;2898>=a;a++)h[a]=1;for(a=2902;2908>=a;a++)h[a]=2;for(a=2915;2920>=a;a++)h[a]=2;for(a=2921;2923>=a;a++)h[a]=1;for(a=2924;2930>=a;a++)h[a]=2;for(a=2931;2962>=
a;a++)h[a]=0;for(a=2964;2968>=a;a++)h[a]=2;for(a=2969;2973>=a;a++)h[a]=0;for(a=2975;2991>=a;a++)h[a]=0;for(a=2995;3051>=a;a++)h[a]=0;for(a=3054;3079>=a;a++)h[a]=0;for(a=3081;3088>=a;a++)h[a]=0;for(a=3092;3101>=a;a++)h[a]=0;for(a=3106;3138>=a;a++)h[a]=0;for(a=3146;3151>=a;a++)h[a]=0;for(a=3153;3166>=a;a++)h[a]=0;for(a=3168;3172>=a;a++)h[a]=0;for(a=3174;3203>=a;a++)h[a]=0;for(a=3294;3358>=a;a++)h[a]=0;for(a=3367;3403>=a;a++)h[a]=0;for(a=3408;3416>=a;a++)h[a]=0;for(a=3417;3438>=a;a++)h[a]=2;for(a=3441;3446>=
a;a++)h[a]=2;for(a=3447;3450>=a;a++)h[a]=0;for(a=3451;3459>=a;a++)h[a]=2;for(a=3460;3478>=a;a++)h[a]=0;for(a=3554;3559>=a;a++)h[a]=0;for(a=3560;3570>=a;a++)h[a]=2;for(a=3571;3581>=a;a++)h[a]=0;for(a=3594;3597>=a;a++)h[a]=0;for(a=3601;3604>=a;a++)h[a]=0;for(a=3637;3639>=a;a++)h[a]=0;for(a=3665;3667>=a;a++)h[a]=0;for(a=3693;3695>=a;a++)h[a]=0;for(a=3701;3727>=a;a++)h[a]=0;for(a=3728;3739>=a;a++)h[a]=2;for(a=3740;3751>=a;a++)h[a]=0;for(a=3753;3760>=a;a++)h[a]=2;for(a=3761;3773>=a;a++)h[a]=0;for(a=3775;3777>=
a;a++)h[a]=0;for(a=3779;3781>=a;a++)h[a]=0;for(a=3783;3785>=a;a++)h[a]=0;for(a=3788;3791>=a;a++)h[a]=0;for(a=3797;3802>=a;a++)h[a]=0;for(a=3814;3816>=a;a++)h[a]=0;for(a=3825;3829>=a;a++)h[a]=0;for(a=3832;3841>=a;a++)h[a]=0;for(a=3844;3852>=a;a++)h[a]=0;for(a=3873;3885>=a;a++)h[a]=0;for(a=3890;3893>=a;a++)h[a]=0;for(a=3907;3912>=a;a++)h[a]=0;for(a=3942;3950>=a;a++)h[a]=0;for(a=3968;3970>=a;a++)h[a]=0;for(a=3973;3976>=a;a++)h[a]=0;for(a=3986;3989>=a;a++)h[a]=0;for(a=3994;3997>=a;a++)h[a]=0;for(a=4048;4051>=
a;a++)h[a]=0;for(a=4056;4063>=a;a++)h[a]=0;for(a=4093;4096>=a;a++)h[a]=0;for(a=4390;4398>=a;a++)h[a]=0;for(a=4399;4413>=a;a++)h[a]=2;for(a=4418;4433>=a;a++)h[a]=2;for(a=4455;4457>=a;a++)h[a]=2;for(a=4484;4489>=a;a++)h[a]=0;for(a=4491;4554>=a;a++)h[a]=0;for(a=4568;4589>=a;a++)h[a]=0;for(a=4652;4656>=a;a++)h[a]=0;for(a=4766;4800>=a;a++)h[a]=0;for(a=5014;5016>=a;a++)h[a]=0;for(a=5069;5072>=a;a++)h[a]=0;for(a=5105;5130>=a;a++)h[a]=0;for(a=5173;5188>=a;a++)h[a]=0;for(a=5253;5259>=a;a++)h[a]=0;for(a=5269;5275>=
a;a++)h[a]=0;for(a=5292;5311>=a;a++)h[a]=0;for(a=5329;5331>=a;a++)h[a]=0;for(a=5343;5349>=a;a++)h[a]=0;for(a=5355;5357>=a;a++)h[a]=0;for(a=5387;5389>=a;a++)h[a]=0;for(a=5459;5463>=a;a++)h[a]=0;for(a=5479;5482>=a;a++)h[a]=0;for(a=5518;5520>=a;a++)h[a]=0;for(a=5530;5539>=a;a++)h[a]=0;for(a=5550;5552>=a;a++)h[a]=0;for(a=5562;5583>=a;a++)h[a]=0;for(a=5623;5625>=a;a++)h[a]=2;for(a=5631;5639>=a;a++)h[a]=0;for(a=5649;5653>=a;a++)h[a]=0;for(a=5663;5680>=a;a++)h[a]=0;for(a=5682;5685>=a;a++)h[a]=0;for(a=5875;5877>=
a;a++)h[a]=0;for(a=5921;5940>=a;a++)h[a]=0;for(a=6050;6125>=a;a++)h[a]=0;for(a=6244;6275>=a;a++)h[a]=0;for(a=6328;6348>=a;a++)h[a]=0;for(a=6350;6356>=a;a++)h[a]=0;for(a=6366;6372>=a;a++)h[a]=0;for(a=6381;6387>=a;a++)h[a]=0;for(a=6393;6404>=a;a++)h[a]=0;for(a=6480;6483>=a;a++)h[a]=0;for(a=6511;6514>=a;a++)h[a]=0;for(a=6579;6581>=a;a++)h[a]=0;for(a=6619;6624>=a;a++)h[a]=0;for(a=6625;6627>=a;a++)h[a]=2;for(a=6628;6632>=a;a++)h[a]=0;for(a=6634;6637>=a;a++)h[a]=0;for(a=6669;6692>=a;a++)h[a]=0;for(a=6707;6709>=
a;a++)h[a]=0;for(a=6720;6723>=a;a++)h[a]=0;for(a=6732;6738>=a;a++)h[a]=0;for(a=6931;6933>=a;a++)h[a]=0;for(a=6956;6959>=a;a++)h[a]=0;for(a=7005;7007>=a;a++)h[a]=0;for(a=7057;7070>=a;a++)h[a]=2;for(a=7074;7082>=a;a++)h[a]=0;for(a=7109;7118>=a;a++)h[a]=0;for(a=7119;7127>=a;a++)h[a]=1;for(a=7374;7376>=a;a++)h[a]=0;for(a=7528;7586>=a;a++)h[a]=0;for(a=7587;7645>=a;a++)h[a]=2;for(a=7845;7859>=a;a++)h[a]=0;for(a=20002;20032>=a;a++)h[a]=0;for(a=20062;20092>=a;a++)h[a]=0;for(a=20135;20138>=a;a++)h[a]=0;for(a=
20248;20258>=a;a++)h[a]=0;for(a=20348;20358>=a;a++)h[a]=0;for(a=20436;20440>=a;a++)h[a]=0;for(a=20822;20824>=a;a++)h[a]=0;for(a=20934;20936>=a;a++)h[a]=0;for(a=21035;21037>=a;a++)h[a]=0;for(a=21095;21097>=a;a++)h[a]=0;for(a=21148;21150>=a;a++)h[a]=0;for(a=21413;21423>=a;a++)h[a]=0;for(a=21473;21483>=a;a++)h[a]=0;for(a=21780;21782>=a;a++)h[a]=0;for(a=21891;21894>=a;a++)h[a]=0;for(a=21896;21899>=a;a++)h[a]=0;for(a=22171;22177>=a;a++)h[a]=0;for(a=22181;22187>=a;a++)h[a]=0;for(a=22191;22197>=a;a++)h[a]=
0;for(a=22234;22236>=a;a++)h[a]=0;for(a=22521;22525>=a;a++)h[a]=0;for(a=22991;22994>=a;a++)h[a]=0;for(a=23028;23038>=a;a++)h[a]=0;for(a=23830;23853>=a;a++)h[a]=0;for(a=23866;23872>=a;a++)h[a]=0;for(a=23877;23884>=a;a++)h[a]=0;for(a=23886;23894>=a;a++)h[a]=0;for(a=23946;23948>=a;a++)h[a]=0;for(a=24311;24313>=a;a++)h[a]=0;for(a=24342;24347>=a;a++)h[a]=0;for(a=24370;24374>=a;a++)h[a]=10;for(a=24375;24381>=a;a++)h[a]=0;for(a=24718;24721>=a;a++)h[a]=0;for(a=24817;24821>=a;a++)h[a]=0;for(a=24877;24882>=
a;a++)h[a]=0;for(a=24891;24893>=a;a++)h[a]=0;for(a=25391;25395>=a;a++)h[a]=0;for(a=25828;25838>=a;a++)h[a]=0;for(a=26191;26195>=a;a++)h[a]=0;for(a=26391;26393>=a;a++)h[a]=0;for(a=26701;26722>=a;a++)h[a]=0;for(a=26729;26799>=a;a++)h[a]=2;for(a=26801;26803>=a;a++)h[a]=2;for(a=26811;26813>=a;a++)h[a]=2;for(a=26847;26870>=a;a++)h[a]=2;for(a=26891;26899>=a;a++)h[a]=0;for(a=26901;26923>=a;a++)h[a]=0;for(a=26929;26946>=a;a++)h[a]=0;for(a=26948;26998>=a;a++)h[a]=0;for(a=27037;27040>=a;a++)h[a]=0;for(a=27205;27232>=
a;a++)h[a]=0;for(a=27258;27260>=a;a++)h[a]=0;for(a=27391;27398>=a;a++)h[a]=0;for(a=27561;27564>=a;a++)h[a]=0;for(a=27571;27574>=a;a++)h[a]=0;for(a=27581;27584>=a;a++)h[a]=0;for(a=27591;27594>=a;a++)h[a]=0;for(a=28191;28193>=a;a++)h[a]=0;for(a=28348;28358>=a;a++)h[a]=0;for(a=28402;28432>=a;a++)h[a]=0;for(a=28462;28492>=a;a++)h[a]=0;for(a=29118;29122>=a;a++)h[a]=0;for(a=29168;29172>=a;a++)h[a]=0;for(a=29177;29185>=a;a++)h[a]=0;for(a=29187;29195>=a;a++)h[a]=0;for(a=29900;29903>=a;a++)h[a]=0;for(a=30161;30179>=
a;a++)h[a]=0;for(a=30491;30494>=a;a++)h[a]=0;for(a=30729;30732>=a;a++)h[a]=0;for(a=31251;31259>=a;a++)h[a]=0;for(a=31265;31268>=a;a++)h[a]=0;for(a=31275;31279>=a;a++)h[a]=0;for(a=31281;31297>=a;a++)h[a]=0;for(a=31461;31469>=a;a++)h[a]=0;for(a=31491;31495>=a;a++)h[a]=0;for(a=31917;31922>=a;a++)h[a]=0;for(a=31965;32E3>=a;a++)h[a]=0;for(a=32001;32003>=a;a++)h[a]=2;for(a=32005;32031>=a;a++)h[a]=2;for(a=32033;32060>=a;a++)h[a]=2;for(a=32064;32067>=a;a++)h[a]=2;for(a=32074;32077>=a;a++)h[a]=2;for(a=32081;32086>=
a;a++)h[a]=0;for(a=32107;32130>=a;a++)h[a]=0;for(a=32133;32158>=a;a++)h[a]=0;for(a=32164;32167>=a;a++)h[a]=2;for(a=32180;32199>=a;a++)h[a]=0;for(a=32201;32260>=a;a++)h[a]=0;for(a=32301;32360>=a;a++)h[a]=0;for(a=32601;32662>=a;a++)h[a]=0;for(a=32664;32667>=a;a++)h[a]=2;for(a=32701;32761>=a;a++)h[a]=0;for(a=53001;53004>=a;a++)h[a]=0;for(a=53008;53019>=a;a++)h[a]=0;for(a=53021;53032>=a;a++)h[a]=0;for(a=53042;53046>=a;a++)h[a]=0;for(a=53074;53080>=a;a++)h[a]=0;for(a=54001;54004>=a;a++)h[a]=0;for(a=54008;54019>=
a;a++)h[a]=0;for(a=54021;54032>=a;a++)h[a]=0;for(a=54042;54046>=a;a++)h[a]=0;for(a=54048;54053>=a;a++)h[a]=0;for(a=54074;54080>=a;a++)h[a]=0;for(a=102001;102040>=a;a++)h[a]=0;for(a=102042;102063>=a;a++)h[a]=0;for(a=102065;102067>=a;a++)h[a]=0;for(a=102070;102117>=a;a++)h[a]=0;for(a=102122;102216>=a;a++)h[a]=0;for(a=102221;102377>=a;a++)h[a]=0;for(a=102382;102388>=a;a++)h[a]=0;for(a=102389;102398>=a;a++)h[a]=2;for(a=102399;102444>=a;a++)h[a]=0;for(a=102445;102447>=a;a++)h[a]=2;for(a=102448;102458>=
a;a++)h[a]=0;for(a=102459;102468>=a;a++)h[a]=2;for(a=102469;102496>=a;a++)h[a]=0;for(a=102500;102519>=a;a++)h[a]=1;for(a=102520;102524>=a;a++)h[a]=0;for(a=102525;102529>=a;a++)h[a]=2;for(a=102530;102561>=a;a++)h[a]=0;for(a=102570;102588>=a;a++)h[a]=0;for(a=102590;102598>=a;a++)h[a]=0;for(a=102601;102603>=a;a++)h[a]=0;for(a=102605;102628>=a;a++)h[a]=0;for(a=102629;102646>=a;a++)h[a]=2;for(a=102648;102700>=a;a++)h[a]=2;for(a=102701;102703>=a;a++)h[a]=0;for(a=102707;102730>=a;a++)h[a]=2;for(a=102733;102758>=
a;a++)h[a]=2;for(a=102767;102798>=a;a++)h[a]=0;for(a=102965;102969>=a;a++)h[a]=0;for(a=102971;102973>=a;a++)h[a]=0;for(a=102975;102989>=a;a++)h[a]=0;for(a=102990;102992>=a;a++)h[a]=1;for(a=102997;103002>=a;a++)h[a]=0;for(a=103003;103008>=a;a++)h[a]=2;for(a=103009;103011>=a;a++)h[a]=0;for(a=103012;103014>=a;a++)h[a]=2;for(a=103019;103021>=a;a++)h[a]=0;for(a=103022;103024>=a;a++)h[a]=2;for(a=103029;103031>=a;a++)h[a]=0;for(a=103032;103034>=a;a++)h[a]=2;for(a=103065;103068>=a;a++)h[a]=0;for(a=103074;103076>=
a;a++)h[a]=0;for(a=103077;103079>=a;a++)h[a]=1;for(a=103080;103082>=a;a++)h[a]=0;for(a=103083;103085>=a;a++)h[a]=2;for(a=103090;103093>=a;a++)h[a]=0;for(a=103097;103099>=a;a++)h[a]=0;for(a=103100;103102>=a;a++)h[a]=2;for(a=103107;103109>=a;a++)h[a]=0;for(a=103110;103112>=a;a++)h[a]=2;for(a=103113;103116>=a;a++)h[a]=0;for(a=103117;103120>=a;a++)h[a]=2;for(a=103153;103157>=a;a++)h[a]=0;for(a=103158;103162>=a;a++)h[a]=2;for(a=103163;103165>=a;a++)h[a]=0;for(a=103166;103168>=a;a++)h[a]=1;for(a=103169;103171>=
a;a++)h[a]=2;for(a=103186;103188>=a;a++)h[a]=0;for(a=103189;103191>=a;a++)h[a]=2;for(a=103192;103195>=a;a++)h[a]=0;for(a=103196;103199>=a;a++)h[a]=2;for(a=103200;103224>=a;a++)h[a]=0;for(a=103225;103227>=a;a++)h[a]=1;for(a=103232;103237>=a;a++)h[a]=0;for(a=103238;103243>=a;a++)h[a]=2;for(a=103244;103246>=a;a++)h[a]=0;for(a=103247;103249>=a;a++)h[a]=2;for(a=103254;103256>=a;a++)h[a]=0;for(a=103257;103259>=a;a++)h[a]=2;for(a=103264;103266>=a;a++)h[a]=0;for(a=103267;103269>=a;a++)h[a]=2;for(a=103300;103375>=
a;a++)h[a]=0;for(a=103381;103383>=a;a++)h[a]=0;for(a=103384;103386>=a;a++)h[a]=1;for(a=103387;103389>=a;a++)h[a]=0;for(a=103390;103392>=a;a++)h[a]=2;for(a=103397;103399>=a;a++)h[a]=0;for(a=103400;103471>=a;a++)h[a]=2;for(a=103476;103478>=a;a++)h[a]=0;for(a=103479;103481>=a;a++)h[a]=2;for(a=103486;103488>=a;a++)h[a]=0;for(a=103489;103491>=a;a++)h[a]=2;for(a=103492;103495>=a;a++)h[a]=0;for(a=103496;103499>=a;a++)h[a]=2;for(a=103528;103543>=a;a++)h[a]=0;for(a=103544;103548>=a;a++)h[a]=2;for(a=103549;103551>=
a;a++)h[a]=0;for(a=103552;103554>=a;a++)h[a]=1;for(a=103555;103557>=a;a++)h[a]=2;for(a=103558;103560>=a;a++)h[a]=0;for(a=103571;103573>=a;a++)h[a]=0;for(a=103574;103576>=a;a++)h[a]=2;for(a=103577;103580>=a;a++)h[a]=0;for(a=103581;103583>=a;a++)h[a]=2;for(a=103600;103694>=a;a++)h[a]=0;for(a=103700;103793>=a;a++)h[a]=2;for(a=103794;103871>=a;a++)h[a]=0;for(a=103900;103971>=a;a++)h[a]=2;return h})},"esri/geometry/Extent":function(){define("dojo/_base/lang ../core/lang ./SpatialReference ./Geometry ./Point ./support/webMercatorUtils ./support/mathUtils ./support/spatialReferenceUtils".split(" "),
function(a,h,p,m,f,e,l,g){var c=m.createSubclass({declaredClass:"esri.geometry.Extent",type:"extent",normalizeCtorArgs:function(b,c,e,g,f){return this.isSR(b)?{spatialReference:b,xmin:0,ymin:0,xmax:0,ymax:0}:a.isObject(b)?(b.spatialReference=b.spatialReference||p.WGS84,b):{xmin:b,ymin:c,xmax:e,ymax:g,spatialReference:f||p.WGS84}},properties:{cache:{dependsOn:"xmin ymin zmin mmin xmax ymax zmax mmax".split(" ")},center:{readOnly:!0,dependsOn:["cache"],get:function(b){b||(b=new f({spatialReference:this.spatialReference}));
b.x=.5*(this.xmin+this.xmax);b.y=.5*(this.ymin+this.ymax);this.hasZ&&(b.z=.5*(this.zmin+this.zmax));this.hasM&&(b.m=.5*(this.mmin+this.mmax));return b}},extent:{readOnly:!0,dependsOn:["cache"],get:function(){return this.clone()}},hasM:{readOnly:!0,dependsOn:["mmin","mmax"],get:function(){return null!=this.mmin&&null!=this.mmax}},hasZ:{readOnly:!0,dependsOn:["zmin","zmax"],get:,height:{readOnly:!0,dependsOn:["ymin","ymax"],get:function(){return Math.abs(this.ymax-
this.ymin)}},width:{readOnly:!0,dependsOn:["xmin","xmax"],get:,xmin:0,ymin:0,mmin:void 0,zmin:void 0,xmax:0,ymax:0,mmax:void 0,zmax:void 0},centerAt:function(b){var a=this.center;return null!=b.z&&this.hasZ?this.offset(b.x-a.x,b.y-a.y,b.z-a.z):this.offset(b.x-a.x,b.y-a.y)},clone:function(){var b=new c;b.xmin=this.xmin;b.ymin=this.ymin;b.xmax=this.xmax;b.ymax=this.ymax;b.spatialReference=this.spatialReference;null!=this.zmin&&(b.zmin=this.zmin,b.zmax=
this.zmax);null!=this.mmin&&(b.mmin=this.mmin,b.mmax=this.mmax);return b},contains:function(b){if(!b)return!1;var a=b.type;if("point"===a){var c=this.spatialReference,g=b.spatialReference,a=b.x,t=b.y;b=b.z;c&&g&&!c.equals(g)&&e.canProject(c,g)&&(c=c.isWebMercator?f.lngLatToXY(a,t):f.xyToLngLat(a,t,!0),a=c[0],t=c[1]);if(a>=this.xmin&&a<=this.xmax&&t>=this.ymin&&t<=this.ymax)return null!=b&&this.hasZ?b>=this.zmin&&b<=this.zmax:!0}else if("extent"===a)return this._containsExtent(b);return!1},equals:function(b){if(!b)return!1;
var a=this.spatialReference;if(!a.equals(b.spatialReference))if(e.canProject(b.spatialReference,a))b=e.project(b,a);else return!1;return this.xmin===b.xmin&&this.ymin===b.ymin&&this.zmin===b.zmin&&this.mmin===b.mmin&&this.xmax===b.xmax&&this.ymax===b.ymax&&this.zmax===b.zmax&&this.mmax===b.mmax},expand:function(b){b=.5*(1-b);var a=this.width*b,c=this.height*b;this.xmin+=a;this.ymin+=c;this.xmax-=a;this.ymax-=c;this.hasZ&&(a=(this.zmax-this.zmin)*b,this.zmin+=a,this.zmax-=a);this.hasM&&(b*=this.mmax-
this.mmin,this.mmin+=b,this.mmax-=b);return this},intersects:function(b){if(!b)return!1;var a=b.type,c=this.spatialReference,g=b.spatialReference;c&&g&&!c.equals(g)&&e.canProject(c,g)&&(b=c.isWebMercator?e.geographicToWebMercator(b):e.webMercatorToGeographic(b,!0));switch(a){case "point":return this.contains(b);case "multipoint":return this._intersectsMultipoint(b);case "extent":return this._intersectsExtent(b);case "polygon":return this._intersectsPolygon(b);case "polyline":return this._intersectsPolyline(b)}},
normalize:offset:function(b,a,c){this.xmin+=b;this.ymin+=a;this.xmax+=b;this.ymax+=a;null!=c&&(this.zmin+=c,this.zmax+=c);return this},shiftCentralMeridian:toJSON:function(){var b=this.spatialReference,b={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax,spatialReference:b&&b.toJSON()};this.hasZ&&(b.zmin=this.zmin,b.zmax=this.zmax);this.hasM&&(b.mmax=this.mmax,b.mmin=this.mmin);
return b},union:function(b){function a(b,a,c){return null==a?c:null==c?a:b(a,c)}this.xmin=Math.min(this.xmin,b.xmin);this.ymin=Math.min(this.ymin,b.ymin);this.xmax=Math.max(this.xmax,b.xmax);this.ymax=Math.max(this.ymax,b.ymax);if(this.hasZ||b.hasZ)this.zmin=a(Math.min,this.zmin,b.zmin),this.zmax=a(Math.max,this.zmax,b.zmax);if(this.hasM||b.hasM)this.mmin=a(Math.min,this.mmin,b.mmin),this.mmax=a(Math.max,this.mmax,b.mmax);return this},intersection:function(b){f(!this._intersectsExtent(b))return null;this.xmin=Math.max(this.xmin,b.xmin);this.ymin=Math.max(this.ymin,b.ymin);this.xmax=Math.min(this.xmax,b.xmax);this.ymax=Math.min(this.ymax,b.ymax);if(this.hasZ||b.hasZ)this.zmin=a(Math.max,this.zmin,b.zmin),this.zmax=a(Math.min,this.zmax,b.zmax);if(this.hasM||b.hasM)this.mmin=a(Math.max,this.mmin,b.mmin),this.mmax=a(Math.min,this.mmax,b.mmax);return this},_containsExtent:function(b){var a=b.xmin,c=b.ymin,e=b.zmin,g=b.xmax,l=b.ymax,r=b.zmax;b=b.spatialReference;
return null!=e&&this.hasZ?this.contains(new f(a,c,e,b))&&this.contains(new f(a,l,e,b))&&this.contains(new f(g,l,e,b))&&this.contains(new f(g,c,e,b))&&this.contains(new f(a,c,r,b))&&this.contains(new f(a,l,r,b))&&this.contains(new f(g,l,r,b))&&this.contains(new f(g,c,r,b)):this.contains(new f(a,c,b))&&this.contains(new f(a,l,b))&&this.contains(new f(g,l,b))&&this.contains(new f(g,c,b))},_intersectsMultipoint:_intersectsExtent:function(b){var a,c;c=this.hasZ&&b.hasZ;if(this.xmin<=b.xmin){if(a=b.xmin,this.xmax<a)return!1}else if(a=this.xmin,b.xmax<a)return!1;if(this.ymin<=b.ymin){if(a=b.ymin,this.ymax<a)return!1}else if(a=this.ymin,b.ymax<a)return!1;if(c&&b.hasZ)if(this.zmin<=b.zmin){if(c=b.zmin,this.zmax<c)return!1}else if(c=this.zmin,b.zmax<c)return!1;return!0},_intersectsPolygon:function(b){var a=[this.xmin,this.ymax],c=[this.xmax,this.ymax],e=[this.xmin,this.ymin],g=[this.xmax,this.ymin],
l=[a,c,e,g],a=[[e,a],[a,c],[c,g],[g,e]],e=b.rings,g=e.length,r,n=new f(0,0,this.spatialReference);r=l.length;for(c=0;c<r;c++)if(n.x=l[c][0],n.y=l[c][1],b.contains(n))return!0;for(var n={x:0,y:0,spatialReference:b.spatialReference,type:"point"},w,d,c=0;c<g;c++)if(l=e[c],r=l.length){w=l[0];n.x=w[0];n.y=w[1];if(this.contains(n))return!0;for(b=1;b<r;b++){d=l[b];n.x=d[0];n.y=d[1];if(this.contains(n)||this._intersectsLine([w,d],a))return!0;w=d}}return!1},_intersectsPolyline:function(b){var a=[[[this.xmin,
this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],c,e=b.paths,g=e.length,f,r,n,l,d={x:0,y:0,spatialReference:b.spatialReference,type:"point"};for(b=0;b<g;b++)if(f=e[b],r=f.length){n=f[0];d.x=n[0];d.y=n[1];if(this.contains(d))return!0;for(c=1;c<r;c++){l=f[c];d.x=l[0];d.y=l[1];if(this.contains(d)||this._intersectsLine([n,l],a))return!0;n=l}}return!1},_intersectsLine:_shiftCM:function(b){var a=this.spatialReference;if(b=b||g.getInfo(a)){var c=this._getCM(b);if(c){var f=a.isWebMercator?e.webMercatorToGeographic(c):c;this.xmin-=c.x;this.xmax-=c.x;a.isWebMercator||(f.x=this._normalizeX(f.x,b).x);this.spatialReference=new p(h.substitute({Central_Meridian:f.x},4326===a.wkid?b.altTemplate:b.wkTemplate))}}return this},_getCM:function(b){var a,c=b.valid[0];b=b.valid[1];var e=
this.xmin,g=this.xmax;e>=c&&e<=b&&g>=c&&g<=b||(a=this.center);return a},_normalize:function(b,a,c){var e=this.spatialReference;if(e&&(c=c||g.getInfo(e))){var f=this._getParts(c).map(function(b){return b.extent});if(2<f.length)return b?this._shiftCM(c):this.set({xmin:c.valid[0],xmax:c.valid[1]});if(2===f.length){if(b)return this._shiftCM(c);if(a)return f;var q=!0,r=!0;f.map(function(b){b.hasZ||(q=!1);b.hasM||(r=!1)});return{rings:f.map(function(b){var a=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],
[b.xmax,b.ymin],[b.xmin,b.ymin]];if(q)for(var d=(b.zmax-b.zmin)/2,k=0;k<a.length;k++)a[k].push(d);if(r)for(b=(b.mmax-b.mmin)/2,k=0;k<a.length;k++)a[k].push(b);return a}),hasZ:q,hasM:r,spatialReference:e}}return f[0]||this}return this},_getParts:function(b){var a=this.cache._parts;if(!a){var a=[],e=this.xmin,f=this.xmax,l=this.ymin,u=this.ymax,r=this.spatialReference,n=this.width,w=e,d=f,k=0,v=0,m,h;b=b||g.getInfo(r);m=b.valid[0];h=b.valid[1];v=this._normalizeX(e,b);e=v.x;k=v.frameId;v=this._normalizeX(f,
b);f=v.x;v=v.frameId;b=e===f&&0<n;if(n>2*h){n=new c(w<d?e:f,l,h,u,r);e=new c(m,l,w<d?f:e,u,r);h=new c(0,l,h,u,r);l=new c(m,l,0,u,r);r=[];m=[];n.contains(h)&&r.push(k);n.contains(l)&&m.push(k);e.contains(h)&&r.push(v);e.contains(l)&&m.push(v);for(u=k+1;u<v;u++)r.push(u),m.push(u);a.push({extent:n,frameIds:[k]},{extent:e,frameIds:[v]},{extent:h,frameIds:r},{extent:l,frameIds:m})}else e>f||b?a.push({extent:new c(e,l,h,u,r),frameIds:[k]},{extent:new c(m,l,f,u,r),frameIds:[v]}):a.push({extent:new c(e,
l,f,u,r),frameIds:[k]});this.cache._parts=a}v=this.hasZ;l=this.hasM;if(v||l)for(k={},v&&(k.zmin=this.zmin,k.zmax=this.zmax),l&&(k.mmin=this.mmin,k.mmax=this.mmax),v=0;v<a.length;v++)a[v].extent.set(k);return a},_normalizeX:);return c})},"esri/geometry/Geometry":function(){define(["../core/JSONSupport","./SpatialReference"],function(a,
h){return a.createSubclass({declaredClass:"esri.geometry.Geometry",type:null,properties:{cache:{value:null,readOnly:!0,dependsOn:["spatialReference"],get:,extent:{value:null,readOnly:!0,dependsOn:["spatialReference"]},hasM:!1,hasZ:!1,spatialReference:h.WGS84},isSR:function(a){return a&&("esri.SpatialReference"===a.declaredClass||null!=a.wkid)},clone:function(){console.warn(".clone() is not implemented for "+this.declaredClass);return null},toJSON:function(){console.warn(".toJSON() is not implemented for "+
this.declaredClass);return null},clearCache:function(){this.notifyChange("cache")},getCacheValue:function(a){return this.cache[a]},setCacheValue:function(a,m){this.cache[a]=m}})})},"esri/geometry/Point":function(){define(["./SpatialReference","./Geometry","./support/webMercatorUtils","./support/spatialReferenceUtils"],function(a,h,p,m){var f=[0,0],e=p.lngLatToXY,l=p.xyToLngLat,g=h.createSubclass({declaredClass:"esri.geometry.Point",normalizeCtorArgs:function(c,b,g,l,m){var q;Array.isArray(c)?(q=c,
m=b,c=q[0],b=q[1],g=q[2],l=q[3]):c&&"object"===typeof c?(q=c,c=null!=q.x?q.x:q.longitude,b=null!=q.y?q.y:q.latitude,g=null!=q.z?q.z:q.altitude,l=q.m,(m=q.spatialReference)&&"esri.SpatialReference"!==m.declaredClass&&(m=new a(m)),!q.declaredClass&&m&&m.isWebMercator&&null!=q.longitude&&null!=q.latitude&&(b=e(q.longitude,q.latitude,!1,f),c=b[0],b=b[1])):this.isSR(g)?(m=g,g=null):this.isSR(l)&&(m=l,l=null);c={x:c,y:b};null!=m&&(c.spatialReference=m);null!=g&&(c.z=g);null!=l&&(c.m=l);return c},properties:{cache:{dependsOn:["x",
"y","z","m"]},hasM:{dependsOn:["m"],get:function(){return void 0!==this.m},set:function(a){var b=this._get("hasM");a!==b&&(this._set("m",a?0:void 0),this._set("hasM",a))}},hasZ:{dependsOn:["z"],get:function(){return void 0!==this.z},set:function(a){var b=this._get("hasZ");a!==b&&(this._set("z",a?0:void 0),this._set("hasZ",a))}},latitude:{dependsOn:["y"],get:function(){var a=this._get("spatialReference");if(a){if(a.isWebMercator)return l(this.x,this.y,!1,f)[1];if(4326===a.wkid)return this._get("y")}return null},
set:function(a){var b=this._get("spatialReference");b&&(b.isWebMercator?this._set("y",e(this.x,a,!1,f)[1]):4326===b.wkid&&this._set("y",a),this._set("latitude",a))}},longitude:{dependsOn:["x"],get:function(){var a=this._get("spatialReference");if(a){if(a.isWebMercator)return l(this._get("x"),this._get("y"),!1,f)[0];if(4326===a.wkid)return this._get("x")}return null},set:function(a){var b=this._get("spatialReference");b&&(b.isWebMercator?this._set("x",e(a,this._get("y"),!1,f)[0]):4326===b.wkid&&this._set("x",
a),this._set("longitude",a))}},x:0,y:0,z:void 0,m:void 0,type:"point"},clone:copy:function(a){g.copy(a,this);return this},equals:function(a){if(!a)return!1;var b=this.x,c=this.y,g=this.z,f=this.m,t=this.spatialReference,u=a.x,r=a.y,n=a.z,w=a.m;a=a.spatialReference;if(!t.equals(a))if(t.isWebMercator&&4326===a.wkid)r=e(u,r),u=r[0],r=r[1],a=t;else if(4326===t.wkid&&a.isWebMercator)r=
l(u,r),u=r[0],r=r[1],a=t;else return!1;return b===u&&c===r&&g===n&&f===w&&t.wkid===a.wkid},offset:function(a,b,e){this.x+=a;this.y+=b;null!=e&&this.hasZ&&(this.z+=e);return this},normalize:function(){var a=this.x,b=this.spatialReference;if(b){var e=m.getInfo(b);if(e){var b=e.valid[0],g=e.valid[1],e=2*g;a>g?(b=Math.ceil(Math.abs(a-g)/e),a-=b*e):a<b&&(b=Math.ceil(Math.abs(a-b)/e),a+=b*e)}}this._set("x",a);return this},distance:function(a){return g.distance(this,a)},toArray:function(){var a=this.hasZ,
b=this.hasM;return a&&b?[this.x,this.y,this.z,this.m]:a?[this.x,this.y,this.z]:b?[this.x,this.y,this.m]:[this.x,this.y]},toJSON:function(){var a=this.spatialReference,b={x:this.x,y:this.y};this.hasZ&&(b.z=this.z);this.hasM&&(b.m=this.m);b.spatialReference=a&&a.toJSON();return b}});g.lngLatToXY=e;g.xyToLngLat=l;g.copy=function(a,b){b.x=a.x;b.y=a.y;b.z=a.z;b.m=a.m;b.spatialReference=Object.isFrozen(a.spatialReference)?a.spatialReference:a.spatialReference.clone()};g.distance=function(a,b){var c=a.x-
b.x,e=a.y-b.y;a=a.hasZ&&b.hasZ?a.z-b.z:0;return Math.sqrt(c*c+e*e+a*a)};return g})},"esri/geometry/support/webMercatorUtils":function(){define(["require","exports","../SpatialReference"],function(a,h,p){function m(a,b,e,f,l){if("point"===a.type)b=b(a.x,a.y,f,g),l.x=b[0],l.y=b[1];else if("extent"===a.type)d=b(a.xmin,a.ymin,f,g),l.xmin=d[0],l.ymin=d[1],b=b(a.xmax,a.ymax,f,g),l.xmax=b[0],l.ymax=b[1];else if("polyline"===a.type||"polygon"===a.type){var c=(d="polyline"===a.type)?a.paths:a.rings,q=[],r=
void 0;for(a=0;a<c.length;a++){var n=c[a],r=[];q.push(r);for(var w=0;w<n.length;w++)r.push(b(n[w][0],n[w][1],f)),2<n[w].length&&r[w].push(n[w][2]),3<n[w].length&&r[w].push(n[w][3])}d?l.paths=q:l.rings=q}else if("multipoint"===a.type){d=a.points;c=[];for(a=0;a<d.length;a++)c[a]=b(d[a][0],d[a][1],f),2<d[a].length&&c[a].push(d[a][2]),3<d[a].length&&c[a].push(d[a][3]);l.points=c}l.spatialReference=e;return l;var d}function f(a,b){a=a&&(null!=a.wkid?a:a.spatialReference);b=b&&(null!=b.wkid?b:b.spatialReference);
return a&&b?b.equals(a)?!0:b.isWebMercator&&4326===a.wkid||a.isWebMercator&&4326===b.wkid:!1}function e(a,b,e,g){void 0===g&&(g=[0,0]);89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);b*=.017453292519943;g[0]=111319.49079327169*a;g[1]=3189068.5*Math.log((1+Math.sin(b))/(1-Math.sin(b)));return g}function l(a,b,e,g){void 0===e&&(e=!1);void 0===g&&(g=[0,0]);a=a/6378137*57.29577951308232;g[0]=e?a:a-360*Math.floor((a+180)/360);g[1]=57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)));
return g}var g=[0,0];h.canProject=f;h.project=function(a,b){var c=a&&a.spatialReference;b=b&&(null!=b.wkid?b:b.spatialReference);return f(c,b)?c.equals(b)?a.clone():b.isWebMercator?m(a,e,p.WebMercator,!1,a.clone()):4326===b.wkid?m(a,l,p.WGS84,!1,a.clone()):null:null};h.lngLatToXY=e;h.xyToLngLat=l;h.geographicToWebMercator=function(a,b,g){void 0===b&&(b=!1);void 0===g&&(g=a.clone());return m(a,e,p.WebMercator,b,g)};h.webMercatorToGeographic=function(a,b,e){void 0===b&&(b=!1);void 0===e&&(e=a.clone());
return m(a,l,p.WGS84,b,e)}})},"esri/geometry/support/mathUtils":function(){define(["../Point"],function(a){function h(e,f){var g,c,b;e instanceof a?(g=f.x-e.x,c=f.y-e.y,b=0,null!=e.z&&null!=f.z&&(b=e.z-f.z)):(g=f[0]-e[0],c=f[1]-e[1],b=0,null!=e[2]&&null!=f[2]&&(b=e[2]-f[2]));return Math.sqrt(g*g+c*c+b*b)}function p(e,f,g){var c,b,q;if(e instanceof a)return c=e.x+g*(f.x-e.x),b=e.y+g*(f.y-e.y),null!=e.z&&null!=f.z&&(q=e.z+g*(f.z-e.z)),new a(c,b,q);c=e[0]+g*(f[0]-e[0]);b=e[1]+g*(f[1]-e[1]);return 2<
e.length&&2<f.length?[c,b,e[2]+g*(f[2]-e[2])]:[c,b]}turn{getLength:h,_getLength:function(a,f){var e=f[0]-a[0];a=f[1]-a[1];return Math.sqrt(e*e+a*a)},getPointOnLine:p,getMidpoint:function(a,f){return p(a,f,.5)},_equals:m,_getLineIntersection:f,getLineIntersection:_getLineIntersection2:function(a,f){var e=a[0],c=a[1],b=f[0],q=f[1];f=e[0];e=e[1];a=c[0];var c=c[1],l=b[0],m=b[1],b=q[0]-l,l=f-l,t=a-f,q=q[1]-m,m=e-m,u=c-e,r=q*t-b*u;if(0===r)return!1;b=(b*m-q*l)/r;l=(t*m-u*l)/r;return 0<=b&&1>=b&&0<=l&&1>=l?[f+b*(a-f),e+b*(c-e)]:!1},_pointLineDistance:function(a,f){var e=f[0],c=f[1];f=e[0];var b=e[1],e=a[0];a=a[1];var q=c[0]-f,l=c[1]-b,m=e-f,t=a-b,c=Math.sqrt,u=Math.pow,r=c(u(q,
2)+u(l,2)),m=(m*q+t*l)/(r*r),b=b+m*l;return c(u(e-(f+m*q),2)+u(a-b,2))},getPathLength:function(a){for(var e=0,g=a.length,c=0;c<g-1;++c)e+=h(a[c],a[c+1]);return e},getPointOnPath:function(a,f){if(0>=f)return a[0];for(var e=0,c=a.length,b=0;b<c-1;++b){var q=h(a[b],a[b+1]);if(f-e<q)return p(a[b],a[b+1],(f-e)/q);e+=q}return a[c-1]}}})},"esri/support/basemapUtils":function(){define("require exports ./basemapDefinitions ../core/accessorSupport/ensureType ../core/urlUtils ../core/Logger ../Basemap".split(" "),
function(a,h,p,m,f,e,l){function g(d,b){var k;if("string"===typeof d){if(!(d in p))return b=Object.keys(p).map(function(d){return'"'+d+'"'}).join(", "),w.warn("Unable to find basemap definition for: "+d+". Try one of these: "+b),null;b&&(k=b[d]);k||(k=l.fromId(d),b&&(b[d]=k))}else k=m.default(l,d);return k}function c(d,b){return d.map(function(d){return b.find(function(b){var k=x(d);b=x(b);return k.type===b.type&&k.url===b.url})||d})}function b(d){return d?!d.loaded&&d.resourceInfo?y(d.resourceInfo):
{baseLayers:q(d.baseLayers),referenceLayers:q(d.referenceLayers)}:null}function q(d){return(Array.isArray(d)?d:d.toArray()).map(x)}function x(d){return{type:d.type,url:n(d.urlTemplate||d.url||d.styleUrl)}}function y(d){return d?{baseLayers:t(d.baseMapLayers.filter(function(d){return!d.isReference})),referenceLayers:t(d.baseMapLayers.filter(function(d){return d.isReference}))}:null}function t(d){return d.map(function(d){var b;switch(d.layerType){case "VectorTileLayer":b="vector-tile";break;case "ArcGISTiledMapServiceLayer":b=
"tile";break;default:b="unknown"}return{type:b,url:n(d.templateUrl||d.urlTemplate||d.styleUrl||d.url)}})}function u(d,b,a){return null!=d!==(null!=b)?"not-equal":d?r(d.baseLayers,b.baseLayers)?r(d.referenceLayers,b.referenceLayers)?"equal":a.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function r(d,b){return d.length!==b.length?!1:!d.some(}function n(d){return d?f.normalize(d).replace(/^\s*https?:/i,
"").toLowerCase():""}var w=e.getLogger("esri.Basemap");h.createCache=function(){return{}};h.ensureType=g;h.clonePreservingTiledLayers=function(d,b){void 0===b&&(b=null);d=g(d);if(!d)return null;d=new l({id:d.id,title:d.title,baseLayers:d.baseLayers.slice(),referenceLayers:d.referenceLayers.slice()});b&&(d.baseLayers=c(d.baseLayers,b.baseLayers),d.referenceLayers=c(d.referenceLayers,b.referenceLayers));return d};h.wellKnownBasemapId=function(d){var a=null;d=b(d);for(var c in p){var e=y(p[c]),e=u(d,
e,{mustMatchReferences:!1});if("equal"===e){a=c;break}else"base-layers-equal"===e&&(a=c)}return a};h.contentEquals=function(d,a){if(d===a)return!0;d=b(d);a=b(a);return"equal"===u(d,a,{mustMatchReferences:!0})}})},"esri/support/basemapDefinitions":function(){define(["require","exports","dojo/i18n!../nls/basemaps"],function(a,h,p){return{streets:{id:"streets",title:p.streets,thumbnailUrl:a.toUrl("../images/basemap/streets.jpg"),baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",title:p.satellite,thumbnailUrl:a.toUrl("../images/basemap/satellite.jpg"),baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",title:p.hybrid,thumbnailUrl:a.toUrl("../images/basemap/hybrid.jpg"),
baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Boundaries and Places",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",
title:p.terrain,thumbnailUrl:a.toUrl("../images/basemap/terrain.jpg"),baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,
showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",title:p.topo,thumbnailUrl:a.toUrl("../images/basemap/topo.jpg"),baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",title:p.gray,thumbnailUrl:a.toUrl("../images/basemap/gray.jpg"),baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",title:p["dark-gray"],thumbnailUrl:a.toUrl("../images/basemap/dark-gray.jpg"),baseMapLayers:[{id:"dark-gray-base-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",title:p.oceans,thumbnailUrl:a.toUrl("../images/basemap/oceans.jpg"),
baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",
title:p["national-geographic"],thumbnailUrl:a.toUrl("../images/basemap/national-geographic.jpg"),baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",title:p.osm,thumbnailUrl:a.toUrl("../images/basemap/osm.jpg"),baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,
visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",title:p["dark-gray"],thumbnailUrl:a.toUrl("../images/basemap/dark-gray.jpg"),baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/850db44b9eb845d3bd42b19e8aa7a024/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Dark Gray",visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",title:p.gray,thumbnailUrl:a.toUrl("../images/basemap/gray.jpg"),baseMapLayers:[{id:"gray-base-layer",
styleUrl:"//www.arcgis.com/sharing/rest/content/items/0e02e6f86d02455091796eaae811d9b5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Light Gray",visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",title:p.streets,thumbnailUrl:a.toUrl("../images/basemap/streets.jpg"),baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/4e1133c28ac04cca97693cf336cd49ad/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",
visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",title:p.topo,thumbnailUrl:a.toUrl("../images/basemap/topo.jpg"),baseMapLayers:[{id:"topo-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/6f65bc1351b7411588a8cb43fe23dad7/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",title:p["streets-night-vector"],thumbnailUrl:a.toUrl("../images/basemap/streets-night.jpg"),baseMapLayers:[{id:"streets-night-vector-base-layer",
styleUrl:"//www.arcgis.com/sharing/rest/content/items/bf79e422e9454565ae0cbe9553cf6471/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",title:p["streets-relief-vector"],thumbnailUrl:a.toUrl("../images/basemap/streets-relief.jpg"),baseMapLayers:[{id:"streets-relief-vector-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",
title:"World Streets Relief Base",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-reference-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/2e063e709e3446459f8538ed6743f879/resources/styles/root.json",title:"World Streets Relief Reference",layerType:"VectorTileLayer",showLegend:!1,visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",title:p["streets-navigation-vector"],thumbnailUrl:a.toUrl("../images/basemap/streets-navigation.jpg"),
baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/dcbbba0edf094eaa81af19298b9c6247/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]}}})},"esri/Basemap":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators dojo/_base/lang ./support/basemapDefinitions ./core/Collection ./core/collectionUtils ./core/Evented ./core/JSONSupport ./core/Loadable ./core/promiseUtils ./core/requireUtils ./core/urlUtils ./core/Logger ./portal/Portal ./portal/PortalItem ./layers/Layer".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d){var k=0,v=g.ofType(d),A=r.getLogger("esri.Basemap");h=z=function(d){function b(b){b=d.call(this)||this;b.id=null;b.portalItem=null;b.resourceInfo=null;b.thumbnailUrl=null;b.title="Basemap";b.id=Date.now().toString(16)+"-basemap-"+k++;b.baseLayers=new g;b.referenceLayers=new g;var a=function(d){"elevation"===d.type&&A.error("Layer '"+d.title+", id:"+d.id+"' of type '"+d.type+"' is not supported as a basemap layer and will therefore be ignored.")};b.baseLayers.on("after-add",
function(d){return a(d.item)});b.referenceLayers.on("after-add",;return b}p(b,d);b.prototype.initialize=function(){var d=this;this.otherwise(function(b){A.error("#load()","Failed to load basemap (title: '"+d.title+"', id: '"+d.id+"')",b)});this.resourceInfo&&this.read(this.resourceInfo)};Object.defineProperty(b.prototype,"baseLayers",{set:function(d){this._set("baseLayers",c.referenceSetter(d,this._get("baseLayers"),v))},enumerable:!0,configurable:!0});b.prototype.writeBaseLayers=
function(d,b,a,k){var c=[];if(!d)return c;k=e.mixin({},k,{layerContainerType:"basemap"});this.baseLayers.forEach(function(d){if(d.write){var b={};d.write(b,k)&&c.push(b)}});this.referenceLayers.forEach(function(d){if(d.write){var b={isReference:!0};d.write(b,k)&&c.push(b)}});b.baseMapLayers=c};Object.defineProperty(b.prototype,"referenceLayers",{set:function(d){this._set("referenceLayers",c.referenceSetter(d,this._get("referenceLayers"),v))},enumerable:!0,configurable:!0});b.prototype.writeTitle=
function(d,b){b.title=d||"Basemap"};b.prototype.load=b.prototype.clone=function(){var d={id:this.id,title:this.title};this.resourceInfo||this.portalItem?(d.portalItem=this.portalItem,d.resourceInfo=this.resourceInfo):(d.baseLayers=this.baseLayers.slice(),d.referenceLayers=this.referenceLayers.slice());return new z(d)};b.prototype.read=function(d,b){!b||"web-scene"!==b.origin&&"web-map"!==b.origin||(this._layerOrigin=b.origin);
b&&b.portal&&(this._layerPortal=b.portal);return this.inherited(arguments)};b.prototype.write=function(d,b){d=d||{};this.inherited(arguments,[d,b]);!this.loaded&&this.resourceInfo&&this.resourceInfo.baseMapLayers&&(d.baseMapLayers=this.resourceInfo.baseMapLayers.map(function(d){d=e.clone(d);d.url&&u.isProtocolRelative(d.url)&&(d.url="https:"+d.url);d.templateUrl&&u.isProtocolRelative(d.templateUrl)&&(d.templateUrl="https:"+d.templateUrl);return d}));return d};b.prototype.toJSON=b.prototype._loadFromSource=function(){var d=this.resourceInfo,b=this.portalItem;return d?this._loadFromJSON(d):b?this._loadFromItem(b):y.resolve(null)};b.prototype._loadFromJSON=function(d,b){var k=this,c=this.portalItem&&this.portalItem.portal||this._layerPortal||null;return t.when(a,"./portal/support/layersCreator").then(function(a){var e=[];if(d.baseMapLayers&&Array.isArray(d.baseMapLayers)){var n={context:{origin:k._layerOrigin||"web-map",layerContainerType:"basemap",url:b,
portal:c},defaultLayerType:"DefaultTileLayer"},g=a.populateOperationalLayers(k.baseLayers,d.baseMapLayers.filter(function(d){return!d.isReference}),n);e.push.apply(e,g);a=a.populateOperationalLayers(k.referenceLayers,d.baseMapLayers.filter(function(d){return d.isReference}),n);e.push.apply(e,a)}return y.eachAlways(e)}).then(function(){})};b.prototype._loadFromItem=function(d){var b=this;return d.load().then(function(d){return d.fetchData()}).then(function(a){var k=u.urlToObject(d.itemUrl);b.resourceInfo=
a.baseMap;b.read(b.resourceInfo,{origin:"web-map",portal:d.portal||n.getDefault(),url:k});b.read({title:d.title,thumbnailUrl:d.thumbnailUrl},{origin:"portal-item",portal:d.portal||n.getDefault(),url:k});return b._loadFromJSON(b.resourceInfo,k)})};b.fromJSON=function(d){return d?new z({resourceInfo:d}):null};b.fromId=function(d){return(d=l[d])?z.fromJSON(d):null};return b}(f.declared(q,b,x));m([f.property({type:v,json:{write:{ignoreOrigin:!0}}}),f.cast(c.castForReferenceSetter)],h.prototype,"baseLayers",
null);m([f.writer("baseLayers")],h.prototype,"writeBaseLayers",null);m([f.property({json:{origins:{webScene:{write:!0}}}})],h.prototype,"id",void 0);m([f.property({type:w})],h.prototype,"portalItem",void 0);m([f.property({type:v}),f.cast(c.castForReferenceSetter)],h.prototype,"referenceLayers",null);m([f.property()],h.prototype,"resourceInfo",void 0);m([f.property()],h.prototype,"thumbnailUrl",void 0);m([f.property()],h.prototype,"title",void 0);m([f.writer("title")],h.prototype,"writeTitle",null);
h=z=m([f.subclass("esri.Basemap")],h);var z;return h})},"esri/portal/Portal":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/accessorSupport/decorators ../core/Error ../config ../identity/IdentityManager ../request ../geometry/Extent ../core/JSONSupport ../core/Loadable ./PortalQueryParams ./PortalQueryResult ./PortalUser ../core/promiseUtils ../core/requireUtils dojo/promise/all dojo/_base/kernel dojo/_base/lang".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v){var A;h=z=function(e){function f(d){d=e.call(this)||this;d.access=null;d.allSSL=!1;d.authMode=z.AUTH_MODE_AUTO;d.authorizedCrossOriginDomains=null;d.bingKey=null;d.canListApps=!1;d.canListData=!1;d.canListPreProvisionedItems=!1;d.canProvisionDirectPurchase=!1;d.canSearchPublic=!1;d.canShareBingPublic=!1;d.canSharePublic=!1;d.canSignInArcGIS=!1;d.canSignInIDP=!1;d.colorSetsGroupQuery=null;d.commentsEnabled=!1;d.created=null;d.culture=null;d.customBaseUrl=
null;d.defaultBasemap=null;d.defaultExtent=null;d.description=null;d.featuredGroups=null;d.featuredItemsGroupQuery=null;d.galleryTemplatesGroupQuery=null;d.livingAtlasGroupQuery=null;d.homePageFeaturedContent=null;d.homePageFeaturedContentCount=null;d.httpPort=null;d.httpsPort=null;d.id=null;d.ipCntryCode=null;d.isPortal=!1;d.layerTemplatesGroupQuery=null;d.maxTokenExpirationMinutes=null;d.modified=null;d.name=null;d.portalHostname=null;d.portalMode=null;d.portalProperties=null;d.region=null;d.rotatorPanels=
null;d.showHomePageDescription=!1;d.supportsHostedServices=!1;d.symbolSetsGroupQuery=null;d.templatesGroupQuery=null;d.units=null;d.url=g.portalUrl;d.urlKey=null;d.user=null;d.useStandardizedQuery=!1;return d}p(f,e);f.prototype.normalizeCtorArgs=f.prototype.initialize=function(){var d=this;this._esriId_credentialCreateHandle=c.on("credential-create",function(){d.loaded&&!d.credential&&d.authMode===z.AUTH_MODE_AUTO&&(d.credential=c.findCredential(d.restUrl),
d.credential&&d._fetchSelf().then(function(b){d.read(b)}))})};f.prototype.destroy=function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)};f.prototype.readDefaultBasemap=function(d){return d?(d=A.fromJSON(d),d.portalItem={portal:this},d):null};Object.defineProperty(f.prototype,"extraQuery",{get:function(){return this.id&&!this.canSearchPublic?" AND orgid:"+this.id:null},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"isOrganization",{get:function(){return!!this.access},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"restUrl",{get:function(){var d=this.url;if(d)var b=d.indexOf("/sharing"),d=0<b?d.substring(0,b):this.url.replace(/\/+$/,""),d=d+"/sharing/rest";return d},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"thumbnailUrl",{get:function(){var d=this.restUrl,b=this.thumbnail;return d&&b?this._normalizeSSL(d+"/portals/self/resources/"+b):null},enumerable:!0,configurable:!0});
f.prototype.readUser=function(d){var b=null;d&&(b=r.fromJSON(d),b.portal=this);return b};f.prototype.load=function(){var d=this,b=n.resolve().then(function(){return d.authMode===z.AUTH_MODE_IMMEDIATE?c.getCredential(d.restUrl):d.authMode===z.AUTH_MODE_AUTO?c.checkSignInStatus(d.restUrl).otherwise(function(){return null}):null}).then(function(b){d.credential=b;return w.when(a,"../Basemap")}).then(function(d){A=d}).then(function(){return d._fetchSelf()}).then(function(b){d.read(b)});this.addResolvingPromise(b);
return this};f.prototype.fetchBasemaps=function(){var d=new t;d.query=this.basemapGalleryGroupQuery;d.disableExtraQuery=!0;return this.queryGroups(d).then(function(b){d.num=100;d.query='type:"Web Map" -type:"Web Application"';return b.total?(b=b.results[0],d.sortField=b.sortField||"name",d.sortOrder=b.sortOrder||"desc",b.queryItems(d)):null}).then(function(d){return d&&d.total?d.results.filter(function(d){return"Web Map"===d.type}).map(:[]})};f.prototype.fetchFeaturedGroups=
function(){var d=this.featuredGroups,b=new t;b.num=100;b.sortField="title";if(d&&d.length){for(var a=[],k=0;k<d.length;k++){var c=d[k];a.push('(title:"'+c.title+'" AND owner:'+c.owner+")")}b.query=a.join(" OR ");return this.queryGroups(b).then(function(d){return d.results})}return n.resolve([])};f.getDefault=f.prototype.queryGroups=function(d){return this._queryPortal("/community/groups",d,"PortalGroup")};f.prototype.queryItems=f.prototype.queryUsers=function(d){d.sortField||(d.sortField="username");return this._queryPortal("/community/users",d,"PortalUser")};f.prototype.toJSON=function(){throw new l("internal:not-yet-implemented","Portal.toJSON is not yet implemented");};f.prototype._fetchSelf=function(){return this._request(this.restUrl+"/portals/self",{query:{culture:k.locale}})};f.prototype._queryPortal=function(b,k,c){var e=this,n=function(a){return e._request(e.restUrl+b,k.toRequestOptions(e)).then(function(d){var b=
k.clone();b.start=d.nextStart;return new u({nextQueryParams:b,queryParams:k,total:d.total,results:z._resultsToTypedArray(a,{portal:e},d)})}).then(function(b){return d(b.results).always(function(){return b})})};return c?w.when(a,"./"+c).then(function(d){return n(d)}):n()};f.prototype._normalizeSSL=function(d){var b=this.allSSL||window&&"https:"===window.location.protocol;if(this.isPortal){var a=z._getLocation(d);if(-1<this.portalHostname.toLowerCase().indexOf(a.hostname.toLowerCase())&&a.port&&"80"!==
a.port&&"443"!==a.port)return d=a.pathname,0!==d.indexOf("/")&&(d="/"+d),b?"https://"+a.hostname+(this.httpsPort&&443!==this.httpsPort?":"+this.httpsPort:"")+d+a.search:"http://"+a.hostname+(this.httpPort&&80!==this.httpPort?":"+this.httpPort:"")+d+a.search}return b?d.replace("http:","https:"):d};f.prototype._normalizeUrl=function(d){var b=this.credential&&this.credential.token;return this._normalizeSSL(b?d+(-1<d.indexOf("?")?"\x26":"?")+"token\x3d"+b:d)};f.prototype._requestToTypedArray=function(b,
k,c){var e=this,n=function(a){return e._request(b,k).then(function(b){var k=z._resultsToTypedArray(a,{portal:e},b);return d(k).always(function(){return k})})};return c?w.when(a,"./"+c).then(function(d){return n(d)}):n()};f.prototype._request=function(d,a){var k={f:"json"},c={disableIdentityLookup:this.authMode===z.AUTH_MODE_ANONYMOUS},e;a&&(v.mixin(k,a.query),e=a.responseType,c.method=a.method);return b(this._normalizeSSL(d),v.mixin({callbackParamName:"callback",query:k,responseType:e,timeout:0},
c)).then(function(d){return d.data})};f._getLocation=function(d){var b=document.createElement("a");b.href=d;return{protocol:b.protocol,hostname:b.hostname,port:b.port,pathname:b.pathname,search:b.search,hash:b.hash,host:b.host}};f._resultsToTypedArray=function(d,b,a){if(a){if(a=a.listings||a.notifications||a.userInvitations||a.tags||a.items||a.groups||a.comments||a.provisions||a.results||a.relatedItems||a,d||b)a=a.map(function(a){a=v.mixin(d?d.fromJSON(a):a,b);"function"===typeof a.load&&a.load();
return a})}else a=[];return a};return f}(e.declared(x,y));h.AUTH_MODE_ANONYMOUS="anonymous";h.AUTH_MODE_AUTO="auto";h.AUTH_MODE_IMMEDIATE="immediate";m([e.property()],h.prototype,"access",void 0);m([e.property()],h.prototype,"allSSL",void 0);m([e.property()],h.prototype,"authMode",void 0);m([e.property()],h.prototype,"authorizedCrossOriginDomains",void 0);m([e.property()],h.prototype,"basemapGalleryGroupQuery",void 0);m([e.property()],h.prototype,"bingKey",void 0);m([e.property()],h.prototype,"canListApps",
void 0);m([e.property()],h.prototype,"canListData",void 0);m([e.property()],h.prototype,"canListPreProvisionedItems",void 0);m([e.property()],h.prototype,"canProvisionDirectPurchase",void 0);m([e.property()],h.prototype,"canSearchPublic",void 0);m([e.property()],h.prototype,"canShareBingPublic",void 0);m([e.property()],h.prototype,"canSharePublic",void 0);m([e.property()],h.prototype,"canSignInArcGIS",void 0);m([e.property()],h.prototype,"canSignInIDP",void 0);m([e.property()],h.prototype,"colorSetsGroupQuery",
void 0);m([e.property()],h.prototype,"commentsEnabled",void 0);m([e.property({type:Date})],h.prototype,"created",void 0);m([e.property()],h.prototype,"credential",void 0);m([e.property()],h.prototype,"culture",void 0);m([e.property()],h.prototype,"customBaseUrl",void 0);m([e.property()],h.prototype,"defaultBasemap",void 0);m([e.reader("defaultBasemap")],h.prototype,"readDefaultBasemap",null);m([e.property({type:q})],h.prototype,"defaultExtent",void 0);m([e.property()],h.prototype,"description",void 0);
m([e.property({dependsOn:["id","canSearchPublic"],readOnly:!0})],h.prototype,"extraQuery",null);m([e.property()],h.prototype,"featuredGroups",void 0);m([e.property()],h.prototype,"featuredItemsGroupQuery",void 0);m([e.property()],h.prototype,"galleryTemplatesGroupQuery",void 0);m([e.property()],h.prototype,"livingAtlasGroupQuery",void 0);m([e.property()],h.prototype,"helpBase",void 0);m([e.property()],h.prototype,"helperServices",void 0);m([e.property()],h.prototype,"helpMap",void 0);m([e.property()],
h.prototype,"homePageFeaturedContent",void 0);m([e.property()],h.prototype,"homePageFeaturedContentCount",void 0);m([e.property()],h.prototype,"httpPort",void 0);m([e.property()],h.prototype,"httpsPort",void 0);m([e.property()],h.prototype,"id",void 0);m([e.property()],h.prototype,"ipCntryCode",void 0);m([e.property({dependsOn:["access"],readOnly:!0})],h.prototype,"isOrganization",null);m([e.property()],h.prototype,"isPortal",void 0);m([e.property()],h.prototype,"layerTemplatesGroupQuery",void 0);
m([e.property()],h.prototype,"maxTokenExpirationMinutes",void 0);m([e.property({type:Date})],h.prototype,"modified",void 0);m([e.property()],h.prototype,"name",void 0);m([e.property()],h.prototype,"portalHostname",void 0);m([e.property()],h.prototype,"portalMode",void 0);m([e.property()],h.prototype,"portalProperties",void 0);m([e.property()],h.prototype,"region",void 0);m([e.property({dependsOn:["url"],readOnly:!0})],h.prototype,"restUrl",null);m([e.property()],h.prototype,"rotatorPanels",void 0);
m([e.property()],h.prototype,"showHomePageDescription",void 0);m([e.property()],h.prototype,"staticImagesUrl",void 0);m([e.property()],h.prototype,"stylesGroupQuery",void 0);m([e.property()],h.prototype,"supportsHostedServices",void 0);m([e.property()],h.prototype,"symbolSetsGroupQuery",void 0);m([e.property()],h.prototype,"templatesGroupQuery",void 0);m([e.property()],h.prototype,"thumbnail",void 0);m([e.property({dependsOn:["restUrl","thumbnail"],readOnly:!0})],h.prototype,"thumbnailUrl",null);
m([e.property()],h.prototype,"units",void 0);m([e.property()],h.prototype,"url",void 0);m([e.property()],h.prototype,"urlKey",void 0);m([e.property()],h.prototype,"user",void 0);m([e.reader("user")],h.prototype,"readUser",null);m([e.property()],h.prototype,"useStandardizedQuery",void 0);m([f(1,e.cast(t))],h.prototype,"_queryPortal",null);h=z=m([e.subclass("esri.portal.Portal")],h);var z;return h})},"esri/core/tsSupport/paramHelper":function(){define([],function(){return )},"esri/identity/IdentityManager":"esri/identity/IdentityManagerDialog":function(){define("dojo/_base/kernel ../core/declare dojo/_base/config dojo/Deferred dojo/_base/lang dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ../kernel ../core/lang ../core/domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/identity dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u){return h([t],{declaredClass:"esri.identity.IdentityManager",constructor:function(b){f.mixin(this,b)},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e{info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e{invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e{lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e{lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e{lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e{lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
signIn:function(b,a,c){this._nls||(this._nls=u);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.emit("dialog-create"));var d=this._loginDialog,k=c&&c.error,n=c&&c.token,g=new m(function(){d.onCancel()});if(d.open)return b=Error("BUSY"),b.code="IdentityManager.1",b.log=p.isDebug,g.reject(b),g.promise;x.hide(d.errMsg_);k&&403==k.code&&n&&(e.set(d.errMsg_,"innerHTML",this._nls.forbidden),x.show(d.errMsg_));d.dfd_=g;d.serverInfo_=a;d.resUrl_=b;d.admin_=c&&c.isAdmin;e.set(d.resLink_,
{title:b,innerHTML:"("+(this.getResourceName(b)||this._nls.lblItem)+")"});e.set(d.serverLink_,{title:a.server,innerHTML:(-1!==a.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":a.server)+" "});d.txtPwd_.set("value","");d.show();return g.promise},_createLoginDialog:function(){var f=this._nls,n=q.substitute(f,this._dialogContent),n=q.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},
n),t=new c({title:f.title,content:n,"class":" esri-widget esriSignInDialog esriIdentityDialog",style:"width: 18em;",esriIdMgr_:this,onShow:function(){this.domNode.classList.add("esriIdentityDialog--visible")},onHide:keypressed_:execute_:function(){var d=this.txtUser_.get("value"),a=this.txtPwd_.get("value"),n=this.dfd_,g=this;if(this.form_.validate()&&d&&a){this.btnSubmit_.set("label",
f.lblSigning);var r=b.id.findCredential(g.resUrl_,d),l=r&&!r._enqueued?l():(g.btnSubmit_.set("disabled",!0),g.generateDfd_=b.id.generateToken(this.serverInfo_,{username:d,password:a},{isAdmin:this.admin_}).then(l).then(null,)}},cancel_:function(){t.generateDfd_&&t.generateDfd_.cancel();var d=t.dfd_,b=t.resUrl_,
a=t.serverInfo_;t.btnSubmit_.set("disabled",!1);t.dfd_=t.serverInfo_=t.generateDfd_=t.resUrl_=null;x.hide(t.errMsg_);c._DialogLevelManager.hide(t);t.esriIdMgr_.emit("dialog-cancel",{resourceUrl:b,serverInfo:a});b=Error("ABORTED");b.code="IdentityManager.2";b.log=p.isDebug;d.reject(b)}}),n=t.domNode;t.form_=g.byNode(a.query(".esriIdForm",n)[0]);t.txtUser_=g.byNode(a.query(".esriIdUser",n)[0]);t.txtPwd_=g.byNode(a.query(".esriIdPwd",n)[0]);t.btnSubmit_=g.byNode(a.query(".esriIdSubmit",n)[0]);t.btnCancel_=
g.byNode(a.query(".esriIdCancel",n)[0]);t.resLink_=a.query(".resLink",n)[0];t.serverLink_=a.query(".serverLink",n)[0];t.errMsg_=a.query(".esriErrorMsg",n)[0];t.connect(t.txtUser_,"onKeyPress",t.keypressed_);t.connect(t.txtPwd_,"onKeyPress",t.keypressed_);t.connect(t.btnSubmit_,"onClick",t.execute_);t.connect(t.btnCancel_,"onClick",t.onCancel);t.connect(t,"onCancel",t.cancel_);return t}})})},"dijit/registry":"dijit/main":function(){define(["dojo/_base/kernel"],function(a){return a.dijit})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v,A,z,D,B,C,F,K,M,E){function V(){}var P=new f;P.resolve(!0);v=m("dijit._DialogBase"+(r("dojo-bidi")?"_NoBidi":""),[z,B,C,D],{templateString:E,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:v.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(d){this._set("draggable",d)},maxRatio:.9,
closable:!0,_setClosableAttr:postMixInProperties:postCreate:function(){c.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);p.after(this,"onExecute",y.hitch(this,"hide"),!0);p.after(this,"onCancel",y.hitch(this,"hide"),!0);this._modalconnects=
[]},onLoad:focus:_endDrag:_setup:_size:function(){this.resize()},_position:_onKey:show:hide:resize:function(d){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!d){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),h.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],,this.domNode.style.position="absolute");var b=n.getBox(this.ownerDocument);b.w*=this.maxRatio;b.h*=this.maxRatio;var a=g.position(this.domNode);a.w>=b.w||a.h>=b.h?(d={w:Math.min(a.w,b.w),h:Math.min(a.h,b.h)},this._shrunk=!0):this._shrunk=!1}if(d){g.setMarginBox(this.domNode,
d);b=[];this.titleBar&&b.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&b.push({domNode:this.actionBarNode,region:"bottom"});a={domNode:this.containerNode,region:"center"};b.push(a);var k=M.marginBox2contentBox(this.domNode,d);M.layoutChildren(this.domNode,k,b);this._singleChild?(b=M.marginBox2contentBox(this.containerNode,a),this._singleChild.resize({w:b.w,h:b.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();r("touch")||d||this._position()}},
_layoutChildren:function(){h.forEach(this.getChildren(),function(d){d.resize&&d.resize()})},destroy:);r("dojo-bidi")&&(v=m("dijit._DialogBase",v,{_setTitleAttr:
_setTextDirAttr:));var I=m("dijit.Dialog",[K,v],{});I._DialogBase=v;var J=I._DialogLevelManager={_beginZIndex:950,show:hide:isTop:,Q=I._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];k.watch("curNode",;r("dijit-legacy-requires")&&u(0,function(){a(["dijit/TooltipDialog"])});return I})},"dojo/_base/fx":"dojo/_base/Color":function(){define(["./kernel","./lang","./array","./config"],function(a,h,p,m){var f=a.Color=function(a){a&&this.setColor(a)};f.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:m.transparentColor||
[0,0,0,0]};h.extend(f,{r:255,g:255,b:255,a:1,_set:setColor:sanitize:function(){return this},toRgb:toRgba:toHex:toCss:toString:function(){return this.toCss(!0)}});f.blendColors=a.blendColors=f.fromRgb=a.colorFromRgb=f.fromHex=a.colorFromHex=
f.fromArray=a.colorFromArray=f.fromString=a.colorFromString=return f})},"dojo/ready":"dojo/window":"dojo/dnd/Moveable":"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(a,h,p,m,f,e,l,g,c,b){ t=5>l("ios"),u=l("pointer-events")||l("MSPointer"),r=),n=l("touch-events"),w,d,k=!1,v,A,z,D,B,C,F,K;l("touch")&&(u?c(:c();h={press:q("mousedown",
"touchstart",r.down),move:q("mousemove","dojotouchmove",r.move),release:q("mouseup","dojotouchend",r.up),cancel:q(g.leave,"touchcancel",u?r.cancel:null),over:q("mouseover","dojotouchover",r.over),out:q("mouseout","dojotouchout",r.out),enter:g._eventHandler(q("mouseover","dojotouchover",r.over)),leave:g._eventHandler(q("mouseout","dojotouchout",r.out))};return a.touch=h})},"dojo/dnd/common":"dojo/dnd/Mover":"dojo/dnd/autoscroll":"dojo/dnd/TimedMoveable":"dijit/focus":"dojo/Stateful":"dijit/a11y":"dijit/_base/manager":"dijit/_Widget":"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v,A,z){.add("dijit-legacy-requires",!t.isAsync);y.add("dojo-bidi",!1);y("dijit-legacy-requires")&&n(0,;var B={};m=e("dijit._WidgetBase",[w,v],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:D("lang"),dir:"",_setDirAttr:D("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(d){this._set("ownerDocument",
d)},attributeMap:{},_blankGif:m.blankGif||a.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:postscript:function(d,b){this.create(d,b)},create:_applyAttributes:postMixInProperties:function(){},
buildRendering:postCreate:function(){},startup:destroyRecursive:destroy:destroyRendering:destroyDescendants:uninitialize:function(){return!1},_setStyleAttr:_attrToDom:function(d,b,a){a=3<=
arguments.length?a:this.attributeMap[d];h.forEach(u.isArray(a)?a:[a],function(a){var k=this[a.node||a||"domNode"];switch(a.type||"attribute"){case "attribute":u.isFunction(b)&&(b=u.hitch(this,b));a=a.attribute?a.attribute:/^on[A-Z][a-zA-Z]*$/.test(d)?d.toLowerCase():d;k.tagName?g.set(k,a,b):k.set(a,b);break;case "innerText":k.innerHTML="";k.appendChild(this.ownerDocument.createTextNode(b));break;case "innerHTML":k.innerHTML=b;break;case "class":c.replace(k,b,this[d]);break;case "toggleClass":c.toggle(k,
a.className||d,b)}},this)},get:set:_attrPairNames:{},_getAttrNames:_set:_get:function(d){return this[d]},emit:on:_onMap:toString:getChildren:getParent:
connect:disconnect:function(d){d.remove()},subscribe:unsubscribe:function(d){d.remove()},isLeftToRight:isFocusable:placeAt:defer:);y("dojo-bidi")&&m.extend(A);return m})},"dijit/Destroyable":"dijit/_OnDijitClickMixin":"dijit/a11yclick":"dijit/_FocusMixin":"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(a,h,p,m,f){var e=f.doc.documentElement;f=m("ie");var l=m("trident"),g=m("opera"),c=Math.floor,b=m("ff"),q=a.boxModel.replace(/-/,""),g={dj_quirks:m("quirks"),dj_opera:g,dj_khtml:m("khtml"),dj_webkit:m("webkit"),dj_safari:m("safari"),dj_chrome:m("chrome"),dj_edge:m("edge"),dj_gecko:m("mozilla"),dj_ios:m("ios"),dj_android:m("android")};
f&&(g.dj_ie=!0,g["dj_ie"+c(f)]=!0,g.dj_iequirks=m("quirks"));l&&(g.dj_trident=!0,g["dj_trident"+c(l)]=!0);b&&(g["dj_ff"+c(b)]=!0);g["dj_"+q]=!0;var x="",y;for(y in g)g[y]&&(x+=y+" ");e.className=h.trim(e.className+" "+x);p(;return m})},"dijit/hccss":"dojo/hccss":"dijit/_TemplatedMixin":"dojo/cache":"dojo/text":function(){define(["./_base/kernel","require","./has","./has!host-browser?./request"],function(a,h,p,m){var f;p("host-browser")?f=h.getText?f=h.getText:console.error("dojo/text plugin failed to load because loader does not support getText");
var e={},l=g={},c={};a.cache=return{dynamic:!0,normalize:load:})},"dijit/_AttachMixin":"dijit/_CssStateMixin":"dijit/form/_FormMixin":"dijit/_DialogMixin":"dijit/DialogUnderlay":"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(a,h,p,m,f,e,l,g){g.add("config-bgIframe",(g("ie")||g("trident"))&&!/IEMobile\/10\.0/.test(navigator.userAgent));var c=new h.BackgroundIframe=e.extend(h.BackgroundIframe,{resize:destroy:);return h.BackgroundIframe})},"dijit/Viewport":"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r){return c("dijit.layout.ContentPane",[p,m,f],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:a._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:create:postMixInProperties:buildRendering:startup:_startChildren:setHref:_setHrefAttr:setContent:_setContentAttr:_getContentAttr:function(){return this.containerNode.innerHTML},cancel:destroy:destroyRecursive:_onShow:refresh:_load:_onLoadHandler:_onUnloadHandler:destroyDescendants:_setContent:
preprocessContent:function(b){return b},_onError:onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":"dijit/layout/_ContentPaneResizeMixin":"dijit/layout/utils":"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),function(a,h,p,m,f,e,l){var g=0,c={_secureForInnerHtml:_emptyNode:e.empty,_setNodeContent:_ContentSetter:m("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:a._scopeName,startup:!0,constructor:set:setContent:empty:onBegin:onEnd:tearDown:onContentError:function(b){return"Error occurred setting content: "+b},onExecError:function(b){return"Error occurred executing scripts: "+b},_mixin:_parse:_onError:),set:;h.setObject("dojo.html",c);return c})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r){ Date("X");var k=0;c.after(p,"extend",!0);var v={_clearCache:_functionFromScript:instantiate:_instantiate:construct:scan:function(b,
k){ar e=[],n=[],g={},f=(k.scope||h._scopeName)+"Type",v="data-"+(k.scope||h._scopeName)+"-",r=v+"type",l=v+"textdir",v=v+"mixins",q=b.firstChild,t=k.inherited;if(!t){var u=t={dir:u(b,"dir"),lang:u(b,"lang"),textDir:u(b,l)},w;for(w in t)t[w]||delete t[w]}w={inherited:t};for(var A,z;;)if(q)if(1!=q.nodeType)q=q.nextSibling;else if(A&&"script"==q.nodeName.toLowerCase())(t=q.getAttribute("type"))&&/^dojo\/\w/i.test(t)&&A.push(q),q=q.nextSibling;else if(z)q=q.nextSibling;else if(t=q.getAttribute(r)||q.getAttribute(f),b=q.firstChild,t||b&&(3!=b.nodeType||b.nextSibling)){z=null;if(t){var p=q.getAttribute(v);A=p?[t].concat(p.split(/\s*,\s*/)):[t];try{z=d(A,k.contextRequire)}catch(U){}z||
m.forEach(A,;p=z&&!z.prototype._noScript?[]:null;w={types:A,ctor:z,parent:w,node:q,scripts:p};w.inherited=c(w);e.push(w)}else w={node:q,scripts:A,parent:w};A=p;z=q.stopParser||z&&z.prototype.stopParser&&!k.template;q=b}else q=q.nextSibling;else{if(!w||!w.node)break;q=w.node.nextSibling;z=!1;w=w.parent;A=w.scripts}var y=new x;n.length?(k.contextRequire||a)(n,:y.resolve(e);return y.promise},_require:_scanAmd:parse:;h.parser=v;f.parseOnLoad&&r(100,v,"parse");return v})},"dojo/date/stamp":"esri/core/domUtils":function(){define(["dojo/on","dojo/dom-style","dojo/has"],function(a,h,p){var m=
{show:function(a){if(a=m.getNode(a))a.style.display="block"},getNode:hide:toggle:documentBox:8>=p("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(f){if(f=this.getNode(f)){var e=0,l=0,g=0,c=0,b=0,q=0;return[a(f,"touchstart",
,a(f,"touchmove",]}}};return m})},"esri/identity/Credential":"esri/identity/IdentityManagerBase":function(){define("../core/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/Deferred dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ../kernel ../config ../core/lang ./ServerInfo ../core/urlUtils ../core/deferredUtils ../core/Accessor ../request ../core/Evented ./OAuthCredential ./OAuthInfo".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v){var A={},z=D=B;a=a(d,{declaredClass:"esri.identity.IdentityManagerBase",constructor:function(){this._portalConfig=p.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer|SceneServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(d){var b=this.serverInfos;b?(d=m.filter(d,function(d){return!this.findServerInfo(d.server)},this),this.serverInfos=b.concat(d)):
this.serverInfos=d;m.forEach(d,function(d){d.owningSystemUrl&&this._portals.push(d.owningSystemUrl);if(d.hasPortal){this._portals.push(d.server);var b=x.request.corsEnabledServers,a=this._getOrigin(d.tokenServiceUrl);u.canUseXhr(d.server)||b.push(d.server.replace(/^https?:\/\//i,""));u.canUseXhr(a)||b.push(a.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:registerToken:function(d){var b=this._sanitizeUrl(d.server),a=this.findServerInfo(b),k=!0,c;a||(a=new t,a.server=this._getServerInstanceRoot(b),a.tokenServiceUrl=this._getTokenSvcUrl(b),a.hasPortal=!0,this.registerServers([a]));(c=this.findCredential(b,d.userId))?(p.mixin(c,d),k=!1):(c=new B({userId:d.userId,server:a.server,token:d.token,expires:d.expires,ssl:d.ssl,scope:this._isServerRsrc(b)?"server":"portal"}),c.resources=[b],this.credentials.push(c));c.emitTokenChange(!1);k||
c.refreshServerTokens()},toJSON:initialize:findServerInfo:function(d){var b;d=this._sanitizeUrl(d);m.some(this.serverInfos,function(a){this._hasSameServerInstance(a.server,d)&&(b=a);return!!b},this);return b},findOAuthInfo:findCredential:function(d,b){var a,k;d=this._sanitizeUrl(d);k=this._isServerRsrc(d)?"server":"portal";b?m.some(this.credentials,this):m.some(this.credentials,this);return a},
getCredential:function(d,b){var a,k,c=!0;y.isDefined(b)&&(p.isObject(b)?(a=!!b.token,k=b.error,c=!1!==b.prompt):a=b);d=this._sanitizeUrl(d);var e=r.makeDeferredCancellingPending(),n=this._isAdminResource(d),g=a&&this._doPortalSignIn(d)?this._getEsriAuthCookie():null;a=a?this.findCredential(d):null;if(g||a)return d=Error("You are currently signed in as: '"+(g&&g.email||a&&a.userId)+"'. You do not have access to this resource: "+d),d.code="IdentityManagerBase.1",d.httpCode=k&&k.httpCode,d.messageCode=
k?k.messageCode:null,d.subcode=k?k.subcode:null,d.details=k?k.details:null,d.log=h.isDebug,e.reject(d),e.promise;if(k=this._findCredential(d,b))return e.resolve(k),e.promise;k=this.findServerInfo(d);if(k)!k.hasServer&&this._isServerRsrc(d)&&(k._restInfoDfd=this._getTokenSvcUrl(d,!0),k.hasServer=!0);else{g=this._getTokenSvcUrl(d);if(!g)return d=Error("Unknown resource - could not find token service endpoint."),d.code="IdentityManagerBase.2",d.log=h.isDebug,e.reject(d),e.promise;k=new t;k.server=this._getServerInstanceRoot(d);
p.isString(g)?(k.tokenServiceUrl=g,k.hasPortal=!0):(k._restInfoDfd=g,k.hasServer=!0);this.registerServers([k])}c&&k.hasPortal&&void 0===k._selfReq&&!this._findOAuthInfo(d)&&(k._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(k.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),d)});return this._enqueue(d,k,b,e,n)},getResourceName:generateToken:function(d,b,a){var k,c,n,g,f,v,r=this._rePortalTokenSvc.test(d.tokenServiceUrl),l=new e(window.location.href.toLowerCase()),t=this._getEsriAuthCookie(),m,x=!b;g=d.shortLivedTokenValidity;var z;b&&(z=q.id.tokenValidity||g||q.id.defaultTokenValidity,z>g&&(z=g));a&&(k=a.isAdmin,c=a.serverUrl,n=a.token,v=a.ssl,d.customParameters=a.customParameters);
k?g=d.adminTokenServiceUrl:(g=d.tokenServiceUrl,f=new e(g.toLowerCase()),t&&(m=(m=t.auth_tier)&&m.toLowerCase()),("web"===m||d.webTierAuth)&&a&&a.serverUrl&&!v&&"http"===l.scheme&&(u.hasSameOrigin(l.uri,g,!0)||"https"===f.scheme&&l.host===f.host&&"7080"===l.port&&"7443"===f.port)&&(g=g.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),x&&r&&(g=g.replace(/\/rest/i,"")));a=p.mixin({query:p.mixin({request:"getToken",username:b&&b.username,password:b&&b.password,serverUrl:c,token:n,expiration:z,
referer:k||r?window.location.host:null,client:k?"referer":null,f:"json"},d.customParameters),method:x?"auto":"post",disableIdentityLookup:!0,useProxy:this._useProxy(d,a),responseType:"json",callbackParamName:x?"callback":void 0},a&&a.ioArgs);r||(a.withCredentials=!1);return w(g,a).then(function(a){a=a.data;if(!a||!a.token)return a=Error("Unable to generate token"),a.code="IdentityManagerBase.3",a.log=h.isDebug,a;var k=d.server;A[k]||(A[k]={});b&&(A[k][b.username]=b.password);a.validity=z;return a})},
isBusy:checkSignInStatus:setRedirectionHandler:function(d){this._redirectFunc=d},setProtocolErrorHandler:function(d){this._protocolFunc=d},signIn:function(){},oAuthSignIn:function(){},destroyCredentials:function(){if(this.credentials){var d=this.credentials.slice();m.forEach(d,function(d){d.destroy()})}this.emit("credentials-destroy")},_getOAuthHash:function(){var d=window.location.hash;if(d){"#"===d.charAt(0)&&(d=
d.substring(1));var d=c.queryToObject(d),b=!1;d.access_token&&d.expires_in&&d.state&&d.hasOwnProperty("username")?(d.state=JSON.parse(d.state),this._oAuthHash=d,b=!0):d.error&&d.error_description&&(console.log("IdentityManager OAuth Error: ",d.error," - ",d.error_description),"access_denied"===d.error&&(b=!0));b&&(!l("ie")||8<l("ie"))&&(window.location.hash="")}},_findCredential:function(d,b){var a=-1,k,c,e,n=b&&b.token;b=b&&b.resource;var g=this._isServerRsrc(d)?"server":"portal",f=m.filter(this.credentials,
this);d=b||d;if(f.length)if(1===f.length)if(b=f[0],c=(k=(e=this.findServerInfo(b.server))&&e.owningSystemUrl)&&this.findCredential(k,b.userId),a=this._getIdenticalSvcIdx(d,b),n)-1!==a&&(b.resources.splice(a,1),this._removeResource(d,c));else return-1===a&&b.resources.push(d),this._addResource(d,c),b;else{var v,r;m.some(f,this);if(n)v&&(v.resources.splice(a,1),this._removeResource(d,c));else if(v)return this._addResource(d,c),v}},_findOAuthInfo:_addResource:_removeResource:_useProxy:_getOrigin:_getServerInstanceRoot:function(d){var b=d.toLowerCase(),a=b.indexOf(this._agsRest);-1===a&&this._isAdminResource(d)&&(a=b.indexOf("/admin"));-1===a&&(a=b.indexOf("/sharing"));
-1===a&&"/"===b.substr(-1)&&(a=b.length-1);return-1<a?d.substring(0,a):d},_hasSameServerInstance:function(d,b){d=d.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();d=d.substr(d.indexOf(":"));b=b.substr(b.indexOf(":"));return d===b},_sanitizeUrl:function(d){d=u.normalize(p.trim(d));var b=(x.request.proxyUrl||"").toLowerCase(),a=b?d.toLowerCase().indexOf(b+"?"):-1;-1!==a&&(d=d.substring(a+b.length+1));return u.urlToObject(d).path},_isRESTService:
_isAdminResource:_isServerRsrc:_isIdenticalService:function(d,b){var a;this._isRESTService(d)&&this._isRESTService(b)?(d=this._getSuffix(d).toLowerCase(),b=this._getSuffix(b).toLowerCase(),a=d===b,a||(a=/(.*)\/(MapServer|FeatureServer).*/ig,a=d.replace(a,"$1")===b.replace(a,"$1"))):this._isAdminResource(d)&&this._isAdminResource(b)?a=!0:this._isServerRsrc(d)||this._isServerRsrc(b)||
!this._isPortalDomain(d)||(a=!0);return a},_isPortalDomain:function(d){d=d.toLowerCase();var b=(new e(d)).authority,a=this._portalConfig,k=-1!==b.indexOf(this._agolSuffix);!k&&a&&(k=this._hasSameServerInstance(this._getServerInstanceRoot(a.restBaseUrl),d));k||(!this._arcgisUrl&&(a=p.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new e(a)).authority),this._arcgisUrl&&(k=this._arcgisUrl.toLowerCase()===b));k||(k=m.some(this._portals,
this));return k=k||this._agsPortal.test(d)},_isIdProvider:_isPublic:_getIdenticalSvcIdx:_getSuffix:_getTokenSvcUrl:function(d){var b,a;if((b=this._isRESTService(d))||this._isAdminResource(d))return a=d.toLowerCase().indexOf(b?this._agsRest:"/admin/"),b=d.substring(0,a)+"/admin/generateToken",d=
d.substring(0,a)+"/rest/info",a=w(d,{query:{f:"json"},responseType:"json",callbackParamName:"callback"}).then(function(d){return d.data}),a.adminUrl_=b,a;if(this._isPortalDomain(d)){var k="";m.some(this._gwDomains,;k||m.some(this._portals,this);k||(a=d.toLowerCase().indexOf("/sharing"),-1!==a&&(k=d.substring(0,a)+this._gwTokenUrl));k||(k=this._getOrigin(d)+
this._gwTokenUrl);k&&(b=(new e(d)).port,/^http:\/\//i.test(d)&&"7080"===b&&(k=k.replace(/:7080/i,":7443")),k=k.replace(/http:/i,"https:"));return k}if(-1!==d.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(d,b){"https:"===window.location.protocol?d=d.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(d=d.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return w(d,{query:{f:"json"},responseType:"json",
callbackParamName:"callback",crossOrigin:!1,disableIdentityLookup:!0}).then(function(d){return d.data})},_hasPortalSession:_getEsriAuthCookie:function(){var d;if(g.isSupported()){var b=this._getAllCookies("esri_auth"),a;for(a=0;a<b.length;a++){var k=JSON.parse(b[a]);if(k.portalApp){d=k;break}}}return d},_getAllCookies:function(d){var a=[],k=document.cookie.match(new RegExp("(?:^|; )"+b.escapeString(d)+"\x3d([^;]*)","g"));if(k)for(d=0;d<k.length;d++){var c=
k[d],e=c.indexOf("\x3d");-1<e&&(c=c.substring(e+1),a.push(decodeURIComponent(c)))}return a},_doPortalSignIn:function(d){if(g.isSupported()){var b=this._getEsriAuthCookie(),a=this._portalConfig,k=window.location.href,c=this.findServerInfo(d);if(this.useSignInPage&&(a||this._isPortalDomain(k)||b)&&(c?c.hasPortal||c.owningSystemUrl&&this._isPortalDomain(c.owningSystemUrl):this._isPortalDomain(d))&&(this._isIdProvider(k,d)||a&&(this._hasSameServerInstance(this._getServerInstanceRoot(a.restBaseUrl),d)||
this._isIdProvider(a.restBaseUrl,d))||u.hasSameOrigin(k,d,!0)))return!0}return!1},_checkProtocol:function(d,b,a,k){var c=!0;k=k?b.adminTokenServiceUrl:b.tokenServiceUrl;0!==p.trim(k).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||x.request.useCors&&(u.canUseXhr(k)||u.canUseXhr(u.getProxyUrl(!0).path))||(c=this._protocolFunc?!!this._protocolFunc({resourceUrl:d,serverInfo:b}):!1,c||(d=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),
d.code="IdentityManagerBase.4",d.log=h.isDebug,console.log(d.message),a(d)));return c},_enqueue:function(d,b,a,k,c,e){k||(k=r.makeDeferredCancellingPending());k.resUrl_=d;k.sinfo_=b;k.options_=a;k.admin_=c;k.refresh_=e;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(d),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(k)):this._xoReqs.push(k):this._doSignIn(k);return k.promise},_doSignIn:function(d){this._busy=d;var b=
this,a=function(a){var k=d.options_&&d.options_.resource,c=d.resUrl_,e=d.refresh_,n=!1;-1===m.indexOf(b.credentials,a)&&(e&&-1!==m.indexOf(b.credentials,e)?(e.userId=a.userId,e.token=a.token,e.expires=a.expires,e.validity=a.validity,e.ssl=a.ssl,e.creationTime=a.creationTime,n=!0,a=e):b.credentials.push(a));a.resources||(a.resources=[]);a.resources.push(k||c);a.scope=b._isServerRsrc(c)?"server":"portal";a.emitTokenChange();var k=b._soReqs,g={};b._soReqs=[];m.forEach(k,b);d.resolve(a);m.forEach(k,function(d){d.resolve(a)});b._busy=d.resUrl_=d.sinfo_=d.refresh_=null;n||b.emit("credential-create",{credential:a});b._soReqs.length&&b._doSignIn(b._soReqs.shift());b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},c=function(a){d.reject(a);b._busy=d.resUrl_=d.sinfo_=d.refresh_=null;b._soReqs.length&&b._doSignIn(b._soReqs.shift());b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},
e=function(e,n,g,f){var v=d.sinfo_,r=!d.options_||!1!==d.options_.prompt,l=v.hasPortal&&b._findOAuthInfo(d.resUrl_);b._doPortalSignIn(d.resUrl_)?(e=b._getEsriAuthCookie(),l=b._portalConfig,e?a(new B({userId:e.email,server:v.server,token:e.token,expires:null})):r?(r="",e=window.location.href,r=b.signInPage?b.signInPage:l?l.baseUrl+l.signin:b._isIdProvider(e,d.resUrl_)?b._getOrigin(e)+"/home/signin.html":v.tokenServiceUrl.replace(b._rePortalTokenSvc,"")+"/home/signin.html",r=r.replace(/http:/i,"https:"),
l&&!1===l.useSSL&&(r=r.replace(/https:/i,"http:")),0===e.toLowerCase().replace("https","http").indexOf(r.toLowerCase().replace("https","http"))?(v=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+d.resUrl_),v.code="IdentityManagerBase.5",v.log=h.isDebug,c(v)):b._redirectFunc?b._redirectFunc({signInPage:r,returnUrlParamName:"returnUrl",returnUrl:e,resourceUrl:d.resUrl_,serverInfo:v}):window.location=r+"?returnUrl\x3d"+window.escape(e)):
(v=Error("User is not signed in."),v.code="IdentityManagerBase.6",v.log=h.isDebug,c(v))):e?a(new B({userId:e,server:v.server,token:g,expires:y.isDefined(f)?Number(f):null,ssl:!!n})):l?(e=l._oAuthCred,e||(n=new k(l,window.localStorage),g=new k(l,window.sessionStorage),n.isValid()&&g.isValid()?n.expires>g.expires?(e=n,g.destroy()):(e=g,n.destroy()):e=n.isValid()?n:g,l._oAuthCred=e),e.isValid()?a(new B({userId:e.userId,server:v.server,token:e.token,expires:e.expires,ssl:e.ssl,_oAuthCred:e})):b._oAuthHash&&
b._oAuthHash.state.portalUrl===l.portalUrl?(r=b._oAuthHash,v=new B({userId:r.username,server:v.server,token:r.access_token,expires:(new Date).getTime()+1E3*Number(r.expires_in),ssl:"true"===r.ssl,oAuthState:r.state,_oAuthCred:e}),e.storage=r.persist?window.localStorage:window.sessionStorage,e.token=v.token,e.expires=v.expires,e.userId=v.userId,e.ssl=v.ssl,e.save(),b._oAuthHash=null,a(v)):r?d._pendingDfd=b.oAuthSignIn(d.resUrl_,v,l,d.options_).then(a,c):(v=Error("User is not signed in."),v.code="IdentityManagerBase.6",
v.log=h.isDebug,c(v))):r?b._checkProtocol(d.resUrl_,v,c,d.admin_)&&(r=d.options_,d.admin_&&(r=r||{},r.isAdmin=!0),d._pendingDfd=b.signIn(d.resUrl_,v,r).then(a,c)):(v=Error("User is not signed in."),v.code="IdentityManagerBase.6",v.log=h.isDebug,c(v))},n=function(){var k=d.sinfo_,e=k.owningSystemUrl,n=d.options_,g,f,v,r;n&&(g=n.token,f=n.error,v=n.prompt);r=b._findCredential(e,{token:g,resource:d.resUrl_});!r&&z(k)&&m.some(b.credentials,
b);r?(n=b.findCredential(d.resUrl_,r.userId))?a(n):D(k,b._legacyFed)?(n=r.toJSON(),n.server=k.server,n.resources=null,a(new B(n))):(d._pendingDfd=b.generateToken(b.findServerInfo(r.server),null,{serverUrl:d.resUrl_,token:r.token,ssl:r.ssl})).then(c):(b._busy=null,g&&(d.options_.token=null),(d._pendingDfd=b.getCredential(e.replace(/\/?$/,
"/sharing"),{resource:d.resUrl_,owningTenant:k.owningTenant,token:g,error:f,prompt:v})).then()},g=d.sinfo_.owningSystemUrl,f=this._isServerRsrc(d.resUrl_),v=d.sinfo_._restInfoDfd;v?v.then(function(a){var k=d.sinfo_;k.adminTokenServiceUrl=k._restInfoDfd.adminUrl_;k._restInfoDfd=null;k.tokenServiceUrl=p.getObject("authInfo.tokenServicesUrl",!1,a)||p.getObject("authInfo.tokenServiceUrl",!1,a)||p.getObject("tokenServiceUrl",
!1,a);k.shortLivedTokenValidity=p.getObject("authInfo.shortLivedTokenValidity",!1,a);k.currentVersion=a.currentVersion;k.owningTenant=a.owningTenant;(a=k.owningSystemUrl=a.owningSystemUrl)&&b._portals.push(a);f&&a?n():e()},function(){d.sinfo_._restInfoDfd=null;var b=Error("Unknown resource - could not find token service endpoint.");b.code="IdentityManagerBase.2";b.log=h.isDebug;c(b)}):f&&g?n():d.sinfo_._selfReq?d.sinfo_._selfReq.selfDfd.then(function(a){var k={},c,e,n,g;a&&(c=a.user&&a.user.username,
k.username=c,k.allSSL=a.allSSL,e=a.supportsOAuth,n=a.currentVersion,"multitenant"===a.portalMode&&(g=a.customBaseUrl));d.sinfo_.webTierAuth=!!c;return c&&b.normalizeWebTierAuth?b.generateToken(d.sinfo_,null,{ssl:k.allSSL}).always(:!c&&e&&4.4<=parseFloat(n)&&!b._doPortalSignIn(d.resUrl_)?b._generateOAuthInfo({portalUrl:d.sinfo_.server,customBaseUrl:g,owningTenant:d.sinfo_._selfReq.owningTenant}).always(function(){return k}):
k}).always(:e()},_generateOAuthInfo:function(d){var b=this,a,k=d.portalUrl,c=d.customBaseUrl,e=d.owningTenant;if(d=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){a=window.location.href;var n=a.indexOf("?");-1<n&&(a=a.slice(0,n));n=a.search(/\/(apps|home)\//);a=-1<n?a.slice(0,n):null}d&&a?(this._hasTestedIfAppIsOnPortal=!0,d=w(a+"/sharing/rest",{query:{f:"json"},
responseType:"json"}).then(function(){b.defaultOAuthInfo=new v({appId:"arcgisonline",popup:!0,popupCallbackUrl:a+"/home/oauth-callback.html"})})):(d=new f,d.resolve(),d=d.promise);return d.then(function(){if(b.defaultOAuthInfo)return k=k.replace(/^http:/i,"https:"),w(k+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:e,client_id:b.defaultOAuthInfo.appId,redirect_uri:u.makeAbsolute(b.defaultOAuthInfo.popupCallbackUrl),f:"json"},responseType:"json",callbackParamName:"callback"}).then(function(d){if(d.data.valid){var a=
b.defaultOAuthInfo.clone();a.portalUrl=d.data.urlKey&&c?"https://"+d.data.urlKey+"."+c:k;b.oAuthInfos.push(a)}})})}});B=n.createSubclass([d],{declaredClass:"esri.identity.Credential",constructor:initialize:function(){this.resources=this.resources||[];y.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,properties:{creationTime:{},expires:{},isAdmin:{},oAuthState:{},resources:{},scope:{},server:{},ssl:{},
token:{},tokenRefreshBuffer:2,userId:{},validity:{}},refreshToken:function(){var d=this,b=this.resources&&this.resources[0],a=q.id.findServerInfo(this.server),k=a&&a.owningSystemUrl,c=!!k&&"server"===this.scope,e=c&&D(a,q.id._legacyFed),n=c&&q.id.findServerInfo(k),g,f=(g=a.webTierAuth)&&q.id.normalizeWebTierAuth,v=A[this.server],v=v&&v[this.userId],r={username:this.userId,password:v},l;if(!g||f)if(c&&!n&&m.some(q.id.serverInfos,,g=n&&q.id.findCredential(n.server,
this.userId),!c||g)if(e)g.refreshToken();else{if(c)l={serverUrl:b,token:g&&g.token,ssl:g&&g.ssl};else if(f)r=null,l={ssl:this.ssl};else if(v)this.isAdmin&&(l={isAdmin:!0});else{var t;b&&(b=q.id._sanitizeUrl(b),this._enqueued=1,t=q.id._enqueue(b,a,null,null,this.isAdmin,this),t.then(.then(null,);return t}return q.id.generateToken(c?n:a,c?null:r,l).then(.then(null,function(){})}},refreshServerTokens:emitTokenChange:function(d){clearTimeout(this._refreshTimer);var b=this.server&&q.id.findServerInfo(this.server),a=(b=b&&b.owningSystemUrl)&&q.id.findServerInfo(b);!1!==d&&(!b||"portal"===this.scope||a&&a.webTierAuth&&!q.id.normalizeWebTierAuth)&&(y.isDefined(this.expires)||y.isDefined(this.validity))&&this._startRefreshTimer();this.emit("token-change")},destroy:function(){this.userId=this.server=this.token=
this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var d=m.indexOf(q.id.credentials,this);-1<d&&q.id.credentials.splice(d,1);this.emitTokenChange();this.emit("destroy")},toJSON:function(){var d=y.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(d.resources=
b);return d},_startRefreshTimer:);a.Credential=B;return a})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(a,h){a.cookie=function(a,m,f){var e=document.cookie,l;if(1==arguments.length)l=(l=e.match(new RegExp("(?:^|; )"+h.escapeString(a)+
"\x3d([^;]*)")))?decodeURIComponent(l[1]):void 0;else{f=f||{};e=f.expires;if("number"==typeof e){var g=new Date;g.setTime(g.getTime()+864E5*e);e=f.expires=g}e&&e.toUTCString&&(f.expires=e.toUTCString());m=encodeURIComponent(m);var e=a+"\x3d"+m,c;for(c in f)e+="; "+c,g=f[c],!0!==g&&(e+="\x3d"+g);document.cookie=e}return l};a.cookie.isSupported=return a.cookie})},"esri/identity/ServerInfo":function(){define(["../core/declare","dojo/_base/lang","../core/lang"],function(a,h,p){return a(null,{declaredClass:"esri.identity.ServerInfo",constructor:toJSON:)})},"esri/identity/OAuthCredential":function(){define(["../core/declare"],function(a){return a(null,{declaredClass:"esri.identity.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:isValid:save:destroy:function(){var a=this._load(),p=this.oAuthInfo;
if(p&&p.authNamespace&&p.portalUrl&&this.storage){var m=a[p.authNamespace];if(m){delete m[p.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(a))}catch(f){console.log(f)}}}p&&(this.oAuthInfo=p._oAuthCred=null)},_init:function(){var a=this._load(),p=this.oAuthInfo;p&&p.authNamespace&&p.portalUrl&&(a=a[p.authNamespace])&&(a=a[p.portalUrl])&&(this.expires=a.expires,this.ssl=a.ssl,this.token=a.token,this.userId=a.userId)},_load:)})},"esri/identity/OAuthInfo":function(){define(["../core/lang","../core/declare","dojo/_base/lang"],function(a,h,p){var m=h(null,{declaredClass:"esri.identity.OAuthInfo",constructor:function(a){p.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,showSocialLogins:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},
a)},_oAuthCred:null,toJSON:clone:function(){return new m(this.toJSON())}});return m})},"dijit/form/Button":"dijit/form/_FormWidget":"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(a,h,p,m,f,e,l,g,c,b){return h("dijit.form._FormWidgetMixin",
null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(c){this._set("disabled",c);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?p.set(this.focusNode,"disabled",c):this.focusNode.setAttribute("aria-disabled",c?"true":"false");this.valueNode&&p.set(this.valueNode,"disabled",c);c?(this._set("hovering",!1),
this._set("active",!1),c="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",a.forEach(f.isArray(c)?c:[c],this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:isFocusable:focus:
compare:onChange:function(){},_onChangeActive:!1,_handleOnChange:create:destroy:)})},"dijit/form/_ButtonMixin":"dijit/form/Form":"dijit/form/ValidationTextBox":"dijit/form/TextBox":"dijit/form/_FormValueWidget":"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(a,h,p,m,f,e){return a("dijit.form._FormValueMixin",e,{readOnly:!1,_setReadOnlyAttr:postCreate:_setValueAttr:function(a,e){this._handleOnChange(a,e)},_handleOnChange:undo:reset:)})},"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),
function(a,h,p,m,f,e,l,g){var c=h("dijit.form._TextBoxMixin"+(m("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:_setValueAttr:function(b,a,c){var e;void 0!==b&&(e=this.filter(b),"string"!=typeof c&&(c=null===e||"number"==typeof e&&isNaN(e)?"":this.filter(this.format(e,this.constraints)),0!=this.compare(e,this.filter(this.parse(c,this.constraints)))&&
(c=null)));null==c||"number"==typeof c&&isNaN(c)||this.textbox.value==c||(this.textbox.value=c,this._set("displayedValue",this.get("displayedValue")));this.inherited(arguments,[e,a])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:format:parse:function(b){return b},_refreshState:function(){},onInput:function(){},_onInput:_processInput:postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);
this.inherited(arguments);this.own(l(this.textbox,"keydown, keypress, paste, cut, compositionend",e.hitch(this,function(b){var a;if("keydown"==b.type&&229!=b.keyCode){a=b.keyCode;switch(a){case f.SHIFT:case f.ALT:case f.CTRL:case f.META:case f.CAPS_LOCK:case f.NUM_LOCK:case f.SCROLL_LOCK:return}if(!b.ctrlKey&&!b.metaKey&&!b.altKey){switch(a){case f.NUMPAD_0:case f.NUMPAD_1:case f.NUMPAD_2:case f.NUMPAD_3:case f.NUMPAD_4:case f.NUMPAD_5:case f.NUMPAD_6:case f.NUMPAD_7:case f.NUMPAD_8:case f.NUMPAD_9:case f.NUMPAD_MULTIPLY:case f.NUMPAD_PLUS:case f.NUMPAD_ENTER:case f.NUMPAD_MINUS:case f.NUMPAD_PERIOD:case f.NUMPAD_DIVIDE:return}if(65<=
a&&90>=a||48<=a&&57>=a||a==f.SPACE)return;a=!1;for(var c in f)if(f[c]===b.keyCode){a=!0;break}if(!a)return}}(a=32<=b.charCode?String.fromCharCode(b.charCode):b.charCode)||(a=65<=b.keyCode&&90>=b.keyCode||48<=b.keyCode&&57>=b.keyCode||b.keyCode==f.SPACE?String.fromCharCode(b.keyCode):b.keyCode);a||(a=229);if("keypress"==b.type){if("string"!=typeof a)return;if("a"<=a&&"z">=a||"A"<=a&&"Z">=a||"0"<=a&&"9">=a||" "===a)if(b.ctrlKey||b.metaKey||b.altKey)return}var g={faux:!0},t;for(t in b)/^(layer[XY]|returnValue|keyLocation)$/.test(t)||
(c=b[t],"function"!=typeof c&&"undefined"!=typeof c&&(g[t]=c));e.mixin(g,{charOrCode:a,_wasConsumed:!1,preventDefault:stopPropagation:function(){b.stopPropagation()}});this._lastInputProducingEvent=g;!1===this.onInput(g)&&(g.preventDefault(),g.stopPropagation());if(!g._wasConsumed&&9>=m("ie"))switch(b.keyCode){case f.TAB:case f.ESCAPE:case f.DOWN_ARROW:case f.UP_ARROW:case f.LEFT_ARROW:case f.RIGHT_ARROW:break;default:b.keyCode==f.ENTER&&"textarea"!=
this.textbox.tagName.toLowerCase()||this.defer(}})),l(this.textbox,"input",e.hitch(this,"_onInput")),l(this.domNode,"keypress",function(b){b.stopPropagation()}))},_blankValue:"",filter:_setBlurValue:_onBlur:_isTextSelected:_onFocus:reset:);m("dojo-bidi")&&(c=h("dijit.form._TextBoxMixin",c,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:_onInput:));c._setSelectionRange=g._setSelectionRange=c.selectInputText=g.selectInputText=return c})},"dijit/Tooltip":"dijit/place":
"esri/identity/OAuthSignInHandler":function(){define("./Credential ../core/domUtils ../core/lang ../core/urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/identity dojo/io-query dojo/sniff dijit/form/Button dojo/query".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e{oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e{invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e{lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e{lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(b){this._oAuthRedirectFunc=b},oAuthSignIn:function(a,c,e,n){var f=this._oAuthDfd=new g;f.resUrl_=a;f.sinfo_=c;f.oinfo_=e;var d=!n||!1!==n.oAuthPopupConfirmation;if(!e.popup||!d)return this._doOAuthSignIn(a,c,e),f.promise;this._nls||(this._nls=q);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;c=n&&n.error;n=n&&n.token;h.hide(a.errMsg_);c&&403==c.code&&n&&(b.set(a.errMsg_,"innerHTML",this._nls.forbidden),h.show(a.errMsg_));a.show();
return f.promise},setOAuthResponseHash:function(b){var c=this._oAuthDfd;this._oAuthDfd=null;if(c&&b)if(clearInterval(this._oAuthIntervalId),"#"===b.charAt(0)&&(b=b.substring(1)),b=x.queryToObject(b),b.error)b=Error("access_denied"===b.error?"ABORTED":"OAuth: "+b.error+" - "+b.error_description),b.code="IdentityManagerBase.2",b.log=l.isDebug,c.reject(b);else{var e=c.oinfo_._oAuthCred,n=new a({userId:b.username,server:c.sinfo_.server,token:b.access_token,expires:(new Date).getTime()+1E3*Number(b.expires_in),
ssl:"true"===b.ssl,_oAuthCred:e});e.storage=b.persist?window.localStorage:window.sessionStorage;e.token=n.token;e.expires=n.expires;e.userId=n.userId;e.ssl=n.ssl;e.save();c.resolve(n)}},_createOAuthDialog:function(){var b=this._nls,a=p.substitute(b,this._oAuthDialogContent),g=new f({title:b.title,content:a,"class":"esri-widget esriOAuthSignInDialog esriIdentityDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:cancel_:function(){var b=g.esriIdMgr_._oAuthDfd;g.esriIdMgr_._oAuthDfd=null;g.hide_();var a=Error("ABORTED");a.code="IdentityManager.2";a.log=l.isDebug;b.reject(a)},hide_:),b=g.domNode;g.btnSubmit_=e.byNode(c.query(".esriIdSubmit",b)[0]);g.btnCancel_=e.byNode(c.query(".esriIdCancel",b)[0]);g.errMsg_=c.query(".esriErrorMsg",b)[0];g.connect(g.btnSubmit_,"onClick",g.execute_);g.connect(g.btnCancel_,"onClick",g.onCancel);
g.connect(g,"onCancel",g.cancel_);return g},_doOAuthSignIn:function(b,a,c){var e=this,g={client_id:c.appId,response_type:"token",state:JSON.stringify({portalUrl:c.portalUrl}),expiration:c.expiration,locale:c.locale,redirect_uri:c.popup?m.makeAbsolute(c.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};c.forceLogin&&(g.force_login=!0);c.showSocialLogins&&(g.showSocialLogins=!0);var d=c.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",k=d+"?"+x.objectToQuery(g);if(c.popup){var f;
7===y("ie")?(f=window.open(c.popupCallbackUrl,"esriJSAPIOAuth",c.popupWindowFeatures),f.location=k):f=window.open(k,"esriJSAPIOAuth",c.popupWindowFeatures);f?(f.focus(),this._oAuthDfd.oAuthWin_=f,this._oAuthIntervalId=setInterval(function(){if(f.closed){clearInterval(e._oAuthIntervalId);var d=e._oAuthDfd;if(d){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=l.isDebug;d.reject(b)}}},500)):(b=Error("ABORTED"),b.code="IdentityManager.2",b.log=l.isDebug,this._oAuthDfd.reject(b))}else this._oAuthRedirectFunc?
this._oAuthRedirectFunc({authorizeParams:g,authorizeUrl:d,resourceUrl:b,serverInfo:a,oAuthInfo:c}):window.location=k}}})},"esri/portal/PortalQueryParams":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/kebabDictionary ../geometry/Extent ../geometry/support/webMercatorUtils ../geometry/SpatialReference dojo/_base/lang".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){var x=l({avgRating:"avg-rating",
numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});a=y=function(a){function e(b){b=a.call(this)||this;b.disableExtraQuery=!1;b.extent=null;b.num=10;b.query=null;b.sortField=null;b.start=1;return b}p(e,a);Object.defineProperty(e.prototype,"sortOrder",{get:function(){return this._get("sortOrder")||"asc"},set:function(b){"asc"!==b&&"desc"!==b||this._set("sortOrder",b)},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new y({disableExtraQuery:this.disableExtraQuery,
extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};e.prototype.toRequestOptions=function(a,e){var n;if(this.extent){var d=c.project(this.extent,b.WGS84);d&&(n=d.xmin+","+d.ymin+","+d.xmax+","+d.ymax)}d=this.query;!this.disableExtraQuery&&a.extraQuery&&(d="("+d+")"+a.extraQuery);a={bbox:n,q:d,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(a.sortField=x.toJSON(this.sortField),
a.sortOrder=this.sortOrder);return{query:q.mixin(e,a)}};return e}(f.declared(e));m([f.property()],a.prototype,"disableExtraQuery",void 0);m([f.property({type:g})],a.prototype,"extent",void 0);m([f.property()],a.prototype,"num",void 0);m([f.property()],a.prototype,"query",void 0);m([f.property()],a.prototype,"sortField",void 0);m([f.property()],a.prototype,"sortOrder",null);m([f.property()],a.prototype,"start",void 0);a=y=m([f.subclass("esri.portal.PortalQueryParams")],a);var y;return a})},"esri/core/kebabDictionary":function(){define(["require",
"exports"],function(a,h){return function(a){var m={},f;for(f in a)m[a[f]]=f;var e=function(a){return m.hasOwnProperty(a)?m[a]:a},l=return{toJSON:e,fromJSON:l,read:function(a){return l(a)},write:function(a,c,b){c[b]=e(a)}}}})},"esri/portal/PortalQueryResult":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor".split(" "),function(a,h,p,m,f,e){a=function(a){function e(c){c=
a.call(this)||this;c.nextQueryParams=null;c.queryParams=null;c.results=null;c.total=null;return c}p(e,a);return e}(f.declared(e));m([f.property()],a.prototype,"nextQueryParams",void 0);m([f.property()],a.prototype,"queryParams",void 0);m([f.property()],a.prototype,"results",void 0);m([f.property()],a.prototype,"total",void 0);return a=m([f.subclass("esri.portal.PortalQueryResult")],a)})},"esri/portal/PortalUser":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Error ../core/JSONSupport ./PortalFolder ./PortalGroup ../core/promiseUtils ../core/requireUtils dojo/promise/all".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x){h=function(f){function l(){var b=f.call(this)||this;b.access=null;b.created=null;b.culture=null;b.description=null;b.email=null;b.fullName=null;b.modified=null;b.orgId=null;b.portal=null;b.preferredView=null;b.privileges=null;b.region=null;b.role=null;b.roleId=null;b.units=null;b.username=null;return b}p(l,f);Object.defineProperty(l.prototype,"thumbnailUrl",{get:function(){var b=this.url,a=this.thumbnail;return b&&a?this.portal._normalizeUrl(b+"/info/"+a):null},enumerable:!0,
configurable:!0});Object.defineProperty(l.prototype,"userContentUrl",{get:function(){var b=this.get("portal.restUrl");return b?b+"/content/users/"+this.username:null},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"url",{get:function(){var b=this.get("portal.restUrl");return b?b+"/community/users/"+this.username:null},enumerable:!0,configurable:!0});l.prototype.addItem=function(b){var a=this,c=b&&b.item,e=b&&b.data;b=b&&b.folder;var d={method:"post"};c&&(d.query=c._getPostQuery(),
null!=e&&("string"===typeof e?d.query.text=e:"object"===typeof e&&(d.query.text=JSON.stringify(e))));e=this.userContentUrl;b&&(e+="/"+b.id);return this.portal._request(e+"/addItem",d).then(function(d){c.id=d.id;c.portal=a.portal;return c.loaded?c._reload():c.load()})};l.prototype.deleteItem=function(b){var a=this.userContentUrl;b.ownerFolder&&(a+="/"+b.ownerFolder);return this.portal._request(a+("/items/"+b.id+"/delete"),{method:"post"}).then(};l.prototype.fetchFolders=
function(){var b=this;return this.portal._request(this.userContentUrl,{query:{num:1}}).then(function(a){return a&&a.folders?a.folders.map(function(a){a=g.fromJSON(a);a.portal=b.portal;return a}):[]})};l.prototype.fetchGroups=function(){var b=this;return this.portal._request(this.url).then(function(a){return a&&a.groups?a.groups.map(function(a){a=c.fromJSON(a);a.portal=b.portal;return a}):[]})};l.prototype.fetchItems=function(b){var c=this;b||(b={});var e=this.userContentUrl;b.folder&&(e+="/"+b.folder.id);
var g;return q.when(a,"./PortalItem").then(function(d){g=d;return c.portal._request(e,{query:{folders:!1,num:b.num||10,start:b.start||1}})}).then(function(d){var b;return d&&d.items?(b=d.items.map(function(d){d=g.fromJSON(d);d.portal=c.portal;d.load();return d}),x(b).always():{items:[],nextStart:-1,total:0}})};l.prototype.queryFavorites=function(a){return this.favGroupId?(this._favGroup||(this._favGroup=new c({id:this.favGroupId,portal:this.portal})),
this._favGroup.queryItems(a)):b.reject(new e("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};l.prototype.toJSON=function(){throw new e("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};return l}(f.declared(l));m([f.property()],h.prototype,"access",void 0);m([f.property({type:Date})],h.prototype,"created",void 0);m([f.property()],h.prototype,"culture",void 0);m([f.property()],h.prototype,"description",void 0);m([f.property()],h.prototype,
"email",void 0);m([f.property()],h.prototype,"favGroupId",void 0);m([f.property()],h.prototype,"fullName",void 0);m([f.property({type:Date})],h.prototype,"modified",void 0);m([f.property()],h.prototype,"orgId",void 0);m([f.property()],h.prototype,"portal",void 0);m([f.property()],h.prototype,"preferredView",void 0);m([f.property()],h.prototype,"privileges",void 0);m([f.property()],h.prototype,"region",void 0);m([f.property()],h.prototype,"role",void 0);m([f.property()],h.prototype,"roleId",void 0);
m([f.property()],h.prototype,"thumbnail",void 0);m([f.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],h.prototype,"thumbnailUrl",null);m([f.property()],h.prototype,"units",void 0);m([f.property({dependsOn:["portal.restUrl"],readOnly:!0})],h.prototype,"userContentUrl",null);m([f.property({dependsOn:["portal.restUrl"],readOnly:!0})],h.prototype,"url",null);m([f.property()],h.prototype,"username",void 0);return h=m([f.subclass("esri.portal.PortalUser")],h)})},"esri/portal/PortalFolder":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Error ../core/JSONSupport".split(" "),
function(a,h,p,m,f,e,l){a=function(a){function c(b){b=a.call(this)||this;b.created=null;b.id=null;b.portal=null;b.title=null;b.username=null;return b}p(c,a);Object.defineProperty(c.prototype,"url",{get:function(){var b=this.get("portal.restUrl");return b?b+"/content/users/"+this.username+"/"+this.id:null},enumerable:!0,configurable:!0});c.prototype.toJSON=function(){throw new e("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};return c}(f.declared(l));m([f.property({type:Date})],
a.prototype,"created",void 0);m([f.property()],a.prototype,"id",void 0);m([f.property()],a.prototype,"portal",void 0);m([f.property()],a.prototype,"title",void 0);m([f.property({dependsOn:["portal.restUrl"],readOnly:!0})],a.prototype,"url",null);m([f.property()],a.prototype,"username",void 0);return a=m([f.subclass("esri.portal.PortalFolder")],a)})},"esri/portal/PortalGroup":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/accessorSupport/decorators ../core/Error ../core/JSONSupport ./PortalQueryParams".split(" "),
function(a,h,p,m,f,e,l,g,c){a=function(b){function a(a){a=b.call(this)||this;a.access=null;a.created=null;a.description=null;a.id=null;a.isInvitationOnly=!1;a.modified=null;a.owner=null;a.portal=null;a.snippet=null;a.sortField=null;a.sortOrder=null;a.tags=null;a.title=null;return a}p(a,b);Object.defineProperty(a.prototype,"url",{get:function(){var b=this.get("portal.restUrl");return b?b+"/community/groups/"+this.id:null},enumerable:!0,configurable:!0});a.prototype.fetchMembers=a.prototype.toJSON=a.prototype.queryItems=function(b){b=b?b.clone():new c;b.query="group:"+this.id+(b.query?" "+b.query:"");return this.portal.queryItems(b)};return a}(e.declared(g));m([e.property()],a.prototype,"access",void 0);m([e.property({type:Date})],a.prototype,"created",void 0);m([e.property()],a.prototype,"description",void 0);m([e.property()],a.prototype,"id",void 0);m([e.property()],
a.prototype,"isInvitationOnly",void 0);m([e.property({type:Date})],a.prototype,"modified",void 0);m([e.property()],a.prototype,"owner",void 0);m([e.property()],a.prototype,"portal",void 0);m([e.property()],a.prototype,"snippet",void 0);m([e.property()],a.prototype,"sortField",void 0);m([e.property()],a.prototype,"sortOrder",void 0);m([e.property()],a.prototype,"tags",void 0);m([e.property()],a.prototype,"title",void 0);m([e.property({dependsOn:["portal.restUrl"],readOnly:!0})],a.prototype,"url",null);
m([f(0,e.cast(c))],a.prototype,"queryItems",null);return a=m([e.subclass("esri.portal.PortalGroup")],a)})},"esri/portal/PortalItem":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Error ../core/lang ../geometry/Extent ../core/JSONSupport ../core/Loadable ./Portal ./PortalRating ../core/promiseUtils".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y){h=t=function(b){function c(a){a=b.call(this)||this;
a.access=null;a.accessInformation=null;a.avgRating=null;a.created=null;a.culture=null;a.description=null;a.extent=null;a.id=null;a.itemControl=null;a.licenseInfo=null;a.modified=null;a.name=null;a.numComments=null;a.numRatings=null;a.numViews=null;a.owner=null;a.portal=null;a.size=null;a.snippet=null;a.tags=null;a.title=null;a.type=null;a.typeKeywords=null;a.url=null;return a}p(c,b);Object.defineProperty(c.prototype,"displayName",{get:function(){var b=this.type,a=this.typeKeywords||[],d=b;"Feature Service"===
b||"Feature Collection"===b?d=-1<a.indexOf("Table")?"Table":-1<a.indexOf("Route Layer")?"Route Layer":"Feature Layer":"Image Service"===b?d=-1<a.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===b?d="Scene Layer":"Scene Package"===b?d="Scene Layer Package":"Stream Service"===b?d="Feature Layer":"Geoprocessing Service"===b&&this.portal&&this.portal.isPortal?d=-1<a.indexOf("Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===b?d="Locator":"Microsoft Powerpoint"===
b?d="Microsoft PowerPoint":"GeoJson"===b?d="GeoJSON":"Globe Service"===b?d="Globe Layer":"Vector Tile Service"===b?d="Tile Layer":"Map Service"===b?d=-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled")?"Tile Layer":"Map Image Layer":b&&-1<b.toLowerCase().indexOf("add in")?d=b.replace(/(add in)/ig,"Add-In"):"datastore catalog service"===b&&(d="Big Data File Share");return d},enumerable:!0,configurable:!0});c.prototype.readExtent=function(b){return b&&b.length?new g(b[0][0],b[0][1],b[1][0],b[1][1]):
null};Object.defineProperty(c.prototype,"iconUrl",{get:function(){var b=this.type&&this.type.toLowerCase()||"",c=this.typeKeywords||[],d=!1,k=!1,e=!1;0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b?(d=-1<c.indexOf("Hosted Service"),"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?(k=-1<c.indexOf("Table"),e=-1<c.indexOf("Route Layer"),b=k?"table":e?"routelayer":d?"featureshosted":"features"):b="map service"===b||"wms"===b||"wmts"===
b?d||-1<c.indexOf("Tiled")||"wmts"===b?"maptiles":"mapimages":"scene service"===b?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===b?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===b?"streamlayer":
"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"layers"):b="web map"===b||"cityengine web scene"===b?"maps":"web scene"===b?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===
b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===b||"layer"===b&&-1<c.indexOf("ArcGIS Pro")||"explorer map"===b&&c.indexOf("Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===b||"360 vr experience"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":
"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"vector tile package"===b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"desktop style"===b||"explorer map"===b&&-1<c.indexOf("Explorer Mapping Application")||
-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b||"raster function template"===b?"toolsgray":"layer"===b||"layer package"===b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"tile package"===b?"tilepackage":"task file"===b?"taskfile":"report template"===b?"report-template":
"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":"hub initiative"===b?"hubinitiative":"hubpage"===b?"hubpage":"hub site application"===b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"style"===b?"style":"dashboard"===b?"dashboard":"maps";return b?a.toUrl("../images/portal/"+
b+"16.png"):null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isLayer",{get:function(){return-1<"Map Service;Feature Service;Feature Collection;Scene Service;Image Service;Stream Service;Vector Tile Service".split(";").indexOf(this.type)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"itemUrl",{get:function(){var b=this.get("portal.restUrl");return b?b+"/content/items/"+this.id:null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"thumbnailUrl",
{get:function(){var b=this.itemUrl,a=this.thumbnail;return b&&a?this.portal._normalizeUrl(b+"/info/"+a):null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"userItemUrl",{get:function(){var b=this.get("portal.restUrl");if(!b)return null;var a=this.owner||this.get("portal.user.username");return a?b+"/content/users/"+(this.ownerFolder?a+"/"+this.ownerFolder:a)+"/items/"+this.id:null},enumerable:!0,configurable:!0});c.prototype.load=function(){var b=this;this.portal||(this.portal=
q.getDefault());var a=this.portal.load().then(function(){return b.resourceInfo?b.resourceInfo:b.id&&b.itemUrl?b.portal._request(b.itemUrl):{}}).then(;this.addResolvingPromise(a);return this};c.prototype.addRating=function(b){var a={method:"post",query:{}};b instanceof x&&(b=b.rating);isNaN(b)||"number"!==typeof b||(a.query.rating=b);return this.portal._request(this.itemUrl+"/addRating",a).then(function(){return new x({rating:b,created:new Date})})};c.prototype.deleteRating=
function(){return this.portal._request(this.itemUrl+"/deleteRating",{method:"post"}).then(function(){})};c.prototype.fetchData=function(b){void 0===b&&(b="json");return this.portal._request(this.itemUrl+"/data",{responseType:b})};c.prototype.fetchRating=function(){return this.portal._request(this.itemUrl+"/rating").then(function(b){return null!=b.rating?(b.created=new Date(b.created),new x(b)):null})};c.prototype.fetchRelatedItems=function(b){return this.portal._requestToTypedArray(this.itemUrl+"/relatedItems",
{query:b},"PortalItem")};c.prototype.update=function(b){var a=this;if(!this.id)return y.reject(new e("portal:item-does-not-exist","The item does not exist yet and cannot be updated"));var d=b&&b.data;b={method:"post"};b.query=this._getPostQuery();for(var k in b.query)null===b.query[k]&&(b.query[k]="");b.query.clearEmptyFields=!0;null!=d&&("string"===typeof d?b.query.text=d:"object"===typeof d&&(b.query.text=JSON.stringify(d)));return(k=this.userItemUrl)?this.portal._request(k+"/update",b).then(:y.reject(new e("portal:not-signed-in","Not signed in"))};c.prototype.toJSON=function(){var b=this.extent,b={created:this.created&&this.created.getTime(),description:this.description,extent:b&&[[b.xmin,b.ymin],[b.xmax,b.ymax]],id:this.id,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,tags:this.tags,thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:this.typeKeywords,url:this.url};
return l.fixJson(b)};c.fromJSON=function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");return new t({resourceInfo:b})};c.prototype._reload=function(){var b=this;return this.portal._request(this.itemUrl,{query:{_ts:(new Date).getTime()}}).then(function(a){b.resourceInfo=a;b.read(a);return b})};c.prototype._getPostQuery=function(){var b=this.toJSON(),a;for(a in b)"tags"===a&&null!==b[a]&&(b[a]=b[a].join(", ")),"typeKeywords"===a&&null!==b[a]&&(b[a]=b[a].join(", "));
return b};return c}(f.declared(c,b));m([f.property()],h.prototype,"access",void 0);m([f.property()],h.prototype,"accessInformation",void 0);m([f.property()],h.prototype,"avgRating",void 0);m([f.property({type:Date})],h.prototype,"created",void 0);m([f.property()],h.prototype,"culture",void 0);m([f.property()],h.prototype,"description",void 0);m([f.property({dependsOn:["type","typeKeywords"],readOnly:!0})],h.prototype,"displayName",null);m([f.property({type:g})],h.prototype,"extent",void 0);m([f.reader("extent")],
h.prototype,"readExtent",null);m([f.property({dependsOn:["type","typeKeywords"],readOnly:!0})],h.prototype,"iconUrl",null);m([f.property()],h.prototype,"id",void 0);m([f.property({dependsOn:["type"],readOnly:!0})],h.prototype,"isLayer",null);m([f.property()],h.prototype,"itemControl",void 0);m([f.property({dependsOn:["portal.restUrl","id"],readOnly:!0})],h.prototype,"itemUrl",null);m([f.property()],h.prototype,"licenseInfo",void 0);m([f.property({type:Date})],h.prototype,"modified",void 0);m([f.property()],
h.prototype,"name",void 0);m([f.property()],h.prototype,"numComments",void 0);m([f.property()],h.prototype,"numRatings",void 0);m([f.property()],h.prototype,"numViews",void 0);m([f.property()],h.prototype,"owner",void 0);m([f.property()],h.prototype,"ownerFolder",void 0);m([f.property({type:q})],h.prototype,"portal",void 0);m([f.property()],h.prototype,"resourceInfo",void 0);m([f.property()],h.prototype,"size",void 0);m([f.property()],h.prototype,"snippet",void 0);m([f.property()],h.prototype,"tags",
void 0);m([f.property()],h.prototype,"thumbnail",void 0);m([f.property({dependsOn:["itemUrl","thumbnail","portal.credential.token"],readOnly:!0})],h.prototype,"thumbnailUrl",null);m([f.property()],h.prototype,"title",void 0);m([f.property()],h.prototype,"type",void 0);m([f.property()],h.prototype,"typeKeywords",void 0);m([f.property()],h.prototype,"url",void 0);m([f.property({dependsOn:["portal.restUrl","portal.user.username","owner","ownerFolder","id"],readOnly:!0})],h.prototype,"userItemUrl",null);
h=t=m([f.subclass("esri.portal.PortalItem")],h);var t;return h})},"esri/portal/PortalRating":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor".split(" "),function(a,h,p,m,f,e){a=function(a){function e(c){c=a.call(this)||this;c.created=null;c.rating=null;return c}p(e,a);return e}(f.declared(e));m([f.property()],a.prototype,"created",void 0);m([f.property()],a.prototype,"rating",void 0);return a=
m([f.subclass("esri.portal.PortalRating")],a)})},"esri/support/groundUtils":function(){define("require exports ../core/accessorSupport/ensureType ../core/Logger ../Ground ../layers/ElevationLayer".split(" "),function(a,h,p,m,f,e){var l=m.getLogger("esri.support.groundUtils");h.groundElevationLayers={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer"}};h.ensureType=function(a){var c;"string"===typeof a?a in h.groundElevationLayers?
(a=h.groundElevationLayers[a],a=new e({id:a.id,url:a.url}),c=new f({layers:[a]})):l.warn("Unable to find ground definition for: "+a+'. Try "world-elevation"'):c=p.default(f,a);return c}})},"esri/layers/ElevationLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators dojo/_base/lang ../request ../core/Error ../core/promiseUtils ../core/requireUtils ./TiledLayer ./mixins/ArcGISMapService ./mixins/ArcGISCachedService ./mixins/OperationalLayer ./mixins/PortalLayer ./support/rasterFormats/LercCodec".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r){h=function(n){function f(d){d=n.call(this)||this;d.type="elevation";d.url=null;d.opacity=1;d.operationalLayerType="ArcGISTiledElevationServiceLayer";return d}p(f,n);f.prototype.normalizeCtorArgs=function(d,b){return"string"===typeof d?e.mixin({},{url:d},b):d};f.prototype.load=function(){var d=this;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(d){for(var b=0;b<d.typeKeywords.length;b++)if("elevation 3d layer"===
d.typeKeywords[b].toLowerCase())return!0;throw new g("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"});}}).always(function(){return d._fetchImageService()}));return this};f.prototype.fetchTile=function(d,b,a,c){var k=this;void 0===c&&(c=0);return this.load().then(.then(function(){var c=k.getTileUrl(d,b,a);return l(c,{responseType:"array-buffer",
failOk:!0})}).then(function(d){d=r.decode(d.data,{noDataValue:c,returnFileInfo:!0});return{values:d.pixelData,width:d.width,height:d.height,maxZError:d.fileInfo.maxZError,noDataValue:d.noDataValue}})};f.prototype.queryElevation=function(d,k){var c=this;return b.when(a,"./support/ElevationQuery").then(function(b){return(new b.ElevationQuery).query(c,d,k)})};f.prototype._fetchTileAvailability=function(d,b,a){return this.tilemapCache?this.tilemapCache.fetchAvailability(d,b,a):c.resolve("unknown")};f.prototype._fetchImageService=
function(){var d=this;return c.resolve().then(function(){if(d.resourceInfo)return d.resourceInfo;var b={query:e.mixin({f:"json"},d.parsedUrl.query),responseType:"json",callbackParamName:"callback"};return l(d.parsedUrl.path,b)}).then(function(b){b.ssl&&(d.url=d.url.replace(/^http:/i,"https:"));d.read(b.data,{origin:"service",url:d.parsedUrl})})};return f}(f.declared(q,x,y,t,u));m([f.shared({"3d":"../views/3d/layers/ElevationLayerView3D"})],h.prototype,"viewModulePaths",void 0);m([f.property()],h.prototype,
"resourceInfo",void 0);m([f.property()],h.prototype,"type",void 0);m([f.property()],h.prototype,"url",void 0);m([f.property({json:{read:!1,write:!1}})],h.prototype,"opacity",void 0);m([f.property()],h.prototype,"operationalLayerType",void 0);return h=m([f.subclass("esri.layers.ElevationLayer")],h)})},"esri/layers/TiledLayer":function(){define(["./Layer","./support/TileInfo"],function(a,h){return a.createSubclass({properties:{attributionDataUrl:null,tileInfo:h},viewModulePaths:{"2d":"../views/2d/layers/TiledLayerView2D",
"3d":"../views/3d/layers/TiledLayerView3D"},getTileUrl:function(a,m,f){}})})},"esri/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/_base/lang ../../core/JSONSupport ../../core/kebabDictionary ../../core/lang ../../core/accessorSupport/decorators ../../geometry/SpatialReference ../../geometry/Point ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/scaleUtils ./LOD".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u){var r=l({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc"});a=n=function(a){function d(d){d=a.call(this)||this;d.dpi=96;d.format=null;d.origin=null;d.minScale=0;d.maxScale=0;d.size=null;d.spatialReference=null;return d}p(d,a);d.create=function(d){void 0===d&&(d={size:256,spatialReference:b.WebMercator});var a=d.size||
256;d=d.spatialReference||b.WebMercator;for(var k=x.getInfo(d),k=k?new q(k.origin[0],k.origin[1],d):new q(0,0,d),c=1/(39.3700787*t.getUnitValueForSR(d)*96),e=256/a*5.91657527591555E8,g=[{level:0,scale:e,resolution:e*c}],f=1;24>f;f++)e/=2,g.push({level:f,scale:e,resolution:e*c});return new n({dpi:96,lods:g,origin:k,size:a,spatialReference:d})};Object.defineProperty(d.prototype,"lods",{set:function(d){var b=this,a=0,k=0,c=[];this._levelToLOD={};d&&(a=-Infinity,k=Infinity,d.forEach(function(d){c.push(d.scale);
a=d.scale>a?d.scale:a;k=d.scale<k?d.scale:k;b._levelToLOD[d.level]=d}));this._set("scales",c);this._set("minScale",a);this._set("maxScale",k);this._set("lods",d);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});d.prototype.zoomToScale=function(d){var b=this.scales;if(0>=d)return b[0];if(d>=b.length)return b[b.length-1];var a=Math.round(d);return b[a]+(a-d)*(b[Math.round(d-.5)]-b[a])};d.prototype.scaleToZoom=d.prototype.snapScale=function(d,b){void 0===b&&(b=.95);d=this.scaleToZoom(d);return d%Math.floor(d)>=b?this.zoomToScale(Math.ceil(d)):this.zoomToScale(Math.floor(d))};d.prototype.tileAt=function(d,b,a,c){var k=this.lodAt(d);if(!k)return null;c||(c={id:null,level:0,row:0,col:0,extent:[0,0,0,0]});var e;if("number"===typeof b)e=b,b=a;else{if(b.spatialReference.equals(this.spatialReference))e=b.x,b=b.y;else{c=y.project(b,
this.spatialReference);if(!c)return null;e=c.x;b=c.y}c=a}a=k.resolution*this.size[0];k=k.resolution*this.size[1];c.level=d;c.row=Math.floor((this.origin.y-b)/k+.001);c.col=Math.floor((e-this.origin.x)/a+.001);this.updateTileInfo(c);return c};d.prototype.updateTileInfo=function(d){var b=this.lodAt(d.level),a=b.resolution*this.size[0],b=b.resolution*this.size[1];d.id=d.level+"/"+d.row+"/"+d.col;d.extent||(d.extent=[0,0,0,0]);d.extent[0]=this.origin.x+d.col*a;d.extent[1]=this.origin.y-(d.row+1)*b;d.extent[2]=
d.extent[0]+a;d.extent[3]=d.extent[1]+b};d.prototype.upsampleTile=d.prototype.lodAt=d.prototype.clone=function(){return n.fromJSON(this.toJSON())};d.prototype.toJSON=function(){return g.fixJson({rows:this.size[0],cols:this.size[1],
dpi:this.dpi,format:r.toJSON(this.format),compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJSON(),spatialReference:this.spatialReference&&this.spatialReference.toJSON(),lods:this.lods&&this.lods.map(function(d){return d.toJSON()})})};d.prototype._initializeUpsampleLevels=return d}(c.declared(e));
m([c.property()],a.prototype,"compressionQuality",void 0);m([c.property()],a.prototype,"dpi",void 0);m([c.property({json:{read:r.fromJSON}})],a.prototype,"format",void 0);m([c.property({type:q,json:{read:function(b,d){return q.fromJSON(f.mixin({spatialReference:d.spatialReference},b))}}})],a.prototype,"origin",void 0);m([c.property({type:[u],value:null})],a.prototype,"lods",null);m([c.property({readOnly:!0})],a.prototype,"minScale",void 0);m([c.property({readOnly:!0})],a.prototype,"maxScale",void 0);
m([c.property({readOnly:!0})],a.prototype,"scales",void 0);m([c.property({cast:function(b){return Array.isArray(b)?b:"number"===typeof b?[b,b]:[256,256]},json:{read:{source:["rows","cols"],reader:}})],a.prototype,"size",void 0);m([c.property({type:b})],a.prototype,"spatialReference",void 0);a=n=m([c.subclass("esri.layers.support.TileInfo")],a);var n;return a})},"esri/geometry/support/scaleUtils":function(){define(["../../config","../../core/lang","./WKIDUnitConversion"],
function(a,h,p){var m=20015077/180,f={getUnitValueForSR:getUnitValue:getScale:function(e,l,g){var c,b,q;1<arguments.length&&h.isDefined(l)&&!l.declaredClass?(c=e,b=l,l=null,q=f.getUnitValue(g)):(c=l||e.extent,
b=e.width,q=f.getUnitValue(c&&c.spatialReference));return c&&b?c.width/b*(q||m)*39.37*a.screenDPI:0},getExtentForScale:function(e,l){var g=e.extent;e=e.width;var c=f.getUnitValue(g.get("spatialReference"));return g.clone().expand(l*e/(39.37*(c||m)*a.screenDPI)/g.get("width"))}};return f})},"esri/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport".split(" "),
function(a,h,p,m,f,e){a=l=function(a){(c,a);c.prototype.clone=function(){return new l({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};return c}(f.declared(e));m([f.property({json:{write:!0}})],a.prototype,"level",void 0);m([f.property({json:{write:!0}})],a.prototype,"levelValue",void 0);m([f.property({json:{write:!0}})],a.prototype,"resolution",void 0);m([f.property({json:{write:!0}})],
a.prototype,"scale",void 0);a=l=m([f.subclass("esri.layers.support.LOD")],a);var l;return a})},"esri/layers/mixins/ArcGISMapService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./ArcGISService ./ScaleRangeLayer ../../geometry/Extent ../../geometry/SpatialReference".split(" "),function(a,h,p,m,f,e,l,g,c){a=function(b){(a,b);a.prototype.readCapabilities=function(b,a){return b&&b.split(",").map(function(b){return b.trim()})};a.prototype.readCopyright=function(b,a){return a.copyrightText};a.prototype.readLegendEnabled=function(b,a){return a.showLegend};a.prototype.writeLegendEnabled=function(b,a){b||(a.showLegend=!1)};a.prototype.readPopupEnabled=a.prototype.readVersion=function(b,a){(b=a.currentVersion)||(b=a.hasOwnProperty("capabilities")||
a.hasOwnProperty("tables")?10:a.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3);return b};return a}(f.declared(e,l));m([f.property()],a.prototype,"capabilities",void 0);m([f.reader("service","capabilities")],a.prototype,"readCapabilities",null);m([f.property()],a.prototype,"copyright",void 0);m([f.reader("copyright",["copyrightText"])],a.prototype,"readCopyright",null);m([f.property({type:g})],a.prototype,"fullExtent",void 0);m([f.property({json:{origins:{service:{read:!1},portalItem:{read:!1}}}})],
a.prototype,"id",void 0);m([f.property()],a.prototype,"legendEnabled",void 0);m([f.reader("legendEnabled",["showLegend"])],a.prototype,"readLegendEnabled",null);m([f.writer("legendEnabled")],a.prototype,"writeLegendEnabled",null);m([f.reader("popupEnabled",["disablePopup"])],a.prototype,"readPopupEnabled",null);m([f.property({type:c})],a.prototype,"spatialReference",void 0);m([f.property()],a.prototype,"version",void 0);m([f.reader("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],
a.prototype,"readVersion",null);return a=m([f.subclass("esri.layers.mixins.ArcGISMapService")],a)})},"esri/layers/mixins/ArcGISService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/MultiOriginJSONSupport ../support/arcgisLayerUrl".split(" "),function(a,h,p,m,f,e,l){a=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}p(c,a);Object.defineProperty(c.prototype,"title",
{get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var b=l.parse(this.url);if(b&&b.title)return b.title}return this._get("title")||""},set:function(b){this._set("title",b)},enumerable:!0,configurable:!0});return c}(f.declared(e));m([f.property({dependsOn:["url"]})],a.prototype,"title",null);m([f.property()],a.prototype,"url",void 0);return a=m([f.subclass("esri.layers.mixins.ArcGISService")],a)})},"esri/core/MultiOriginJSONSupport":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./accessorSupport/decorators ./Accessor ./accessorSupport/read ./accessorSupport/write ./accessorSupport/utils ./accessorSupport/MultiOriginStore ./accessorSupport/PropertyOrigin".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q){=function(a){function e(){var e=a.call(this)||this,g=c.getProperties(e),n=g.metadatas,f=g.store,d=new b.default;g.store=d;f.keys().forEach(function(b){d.set(b,f.get(b),q.OriginId.DEFAULTS)});Object.keys(n).forEach(function(b){g.internalGet(b)&&d.set(b,g.internalGet(b),q.OriginId.DEFAULTS)});return e}p(e,a);e.prototype.clear=function(b,a){void 0===a&&(a="user");return x(this).clear(b,q.nameToId(a))};e.prototype.read=e.prototype.write=function(b,a){b=b||{};g.default(this,b,a);return b};e.prototype.getAtOrigin=function(b,a){var c=x(this),e=q.nameToId(a);if("string"===typeof b)return c.get(b,e);var d={};b.forEach(;return d};e.prototype.originOf=function(b){var a=x(this);if("string"===typeof b)return q.idToName(a.originOf(b));b.forEach(};e.prototype.revert=function(b,a){var e=x(this),g=q.nameToId(a),d=c.getProperties(this);
("string"===typeof b?"*"===b?Object.keys(e.getAll(g)):[b]:b).forEach(function(b){d.propertyInvalidated(b);e.revert(b,g);d.propertyCommitted(b)})};e.prototype.removeOrigin=function(b){var a=x(this);b=q.nameToId(b);var c=a.getAll(b),e;for(e in c)a.originOf(e)===b&&a.set(e,c[e],q.OriginId.USER)};e.prototype.updateOrigin=function(b,a){var c=x(this);a=q.nameToId(a);var e=this.get(b);c.clear(b);c.set(b,e,a)};return e}(f.declared(e));return a=m([f.subclass("esri.core.MultiOriginJSONSupport")],a)})},"esri/core/accessorSupport/MultiOriginStore":function(){define(["require",
"exports","./PropertyOrigin"],function(a,h,p){a=function(){function a(){this._propertyOriginMap={};this._originStores=Array(p.OriginId.NUM);this._values={}}a.prototype.get=function(a,e){return(e=void 0===e?this._values:this._originStores[e])?e[a]:void 0};a.prototype.keys=function(){return Object.keys(this._values)};a.prototype.set=function(a,e,l){void 0===l&&(l=p.OriginId.USER);var g=this._originStores[l];g||(g={},this._originStores[l]=g);g[a]=e;return!(a in this._values)||this._propertyOriginMap[a]<=
l?(g=this._values[a],this._values[a]=e,this._propertyOriginMap[a]=l,g!==e):!1};a.prototype.clear=function(a,e){void 0===e&&(e=p.OriginId.USER);var f=this._originStores[e];if(f){var g=f[a];delete f[a];if(a in this._values&&this._propertyOriginMap[a]===e)for(delete this._values[a],--e;0<=e;e--)if((f=this._originStores[e])&&a in f){this._values[a]=f[a];this._propertyOriginMap[a]=e;break}return g}};a.prototype.has=function(a,e){return(e=void 0===e?this._values:this._originStores[e])?a in e:!1};a.prototype.revert=
function(a,e){for(;0<e&&!this.has(a,e);)--e;var f=this._originStores[e],f=f&&f[a],g=this._values[a];this._values[a]=f;this._propertyOriginMap[a]=e;return g!==f};a.prototype.originOf=function(a,e){return this._propertyOriginMap[a]||p.OriginId.DEFAULTS};a.prototype.getAll=function(a){return this._originStores[a]};return a}();Object.defineProperty(h,"__esModule",{value:!0});h.default=a})},"esri/layers/support/arcgisLayerUrl":function(){define(["require","exports","../../core/urlUtils"],function(a,h,
p){function m(a){var e=p.urlToObject(a).path.match(h.match);if(!e)return null;a=e[1];var g=e[2],c=e[3],e=e[4],b=g.indexOf("/");return{title:f(-1!==b?g.slice(b+1):g),serverType:c,sublayer:null!=e&&""!==e?parseInt(e,10):null,url:{path:a}}}.serverTypes="MapServer ImageServer FeatureServer SceneServer StreamServer VectorTileServer".split(" ");h.match=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/("+
h.serverTypes.join("|")+"))(?:\\/(?:layers\\/)?(\\d+))?","i");h.test=h.parse=m;h.cleanTitle=f;h.titleFromUrlAndName=function(a,l){var e=[];a&&(a=m(a))&&a.title&&e.push(a.title);l&&(l=f(l),e.push(l));if(2===e.length){if(-1!==e[0].toLowerCase().indexOf(e[1].toLowerCase()))return e[0];if(-1!==e[1].toLowerCase().indexOf(e[0].toLowerCase()))return e[1]}return e.join(" - ")};h.isHostedAgolService=function(a){if(!a)return!1;a=a.toLowerCase();var e=-1!==a.indexOf(".arcgis.com/");
a=-1!==a.indexOf("//services")||-1!==a.indexOf("//tiles")||-1!==a.indexOf("//features");return e&&a};h.isHostedSecuredProxyService=function(a,f){return f&&a&&-1!==a.toLowerCase().indexOf(f.toLowerCase())}})},"esri/layers/mixins/ScaleRangeLayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/accessorSupport/write".split(" "),function(a,h,p,m,f,e,l){a=function(a){function c(){var b=
null!==a&&a.apply(this,arguments)||this;b.minScale=0;b.maxScale=0;return b}p(c,a);return c}(f.declared(e));m([f.property({json:{write:{overridePolicy:function(a,c,b){if(l.willPropertyWrite(this,"maxScale",{},b))return{ignoreOrigin:!0}}}}})],a.prototype,"minScale",void 0);m([f.property({json:{write:{overridePolicy:function(a,c,b){if(l.willPropertyWrite(this,"minScale",{},b))return{ignoreOrigin:!0}}}}})],a.prototype,"maxScale",void 0);return a=m([f.subclass("esri.layers.mixins.ScaleRangeLayer")],a)})},
"esri/layers/mixins/ArcGISCachedService":function(){define("dojo/_base/lang dojo/io-query ./ArcGISService ./ScaleRangeLayer ../support/TileInfo ../support/TilemapCache".split(" "),function(a,h,p,m,f,e){return p.createSubclass([m],{declaredClass:"esri.layers.mixins.ArcGISCachedService",properties:{minScale:{json:{origins:{service:{read:!1}}}},maxScale:{json:{origins:{service:{read:!1}}}},resampling:!0,supportsBlankTile:{value:!1,readOnly:!0,dependsOn:["version"],get:,
tileInfo:{value:null,type:f,json:{read:function(a,e){var c=e.minScale?e.minScale:Infinity,b=e.maxScale?e.maxScale:-Infinity;return a?(a.lods=a.lods.filter(,f.fromJSON(a)):null}}},tilemapCache:{value:null,json:{read:{source:["capabilities"],reader:function(a,g){return g.capabilities&&-1<g.capabilities.indexOf("Tilemap")?new e({layer:this}):null}}}},refreshTimestamp:null,version:{}},refresh:function(){this.refreshTimestamp=Date.now();this.inherited(arguments)},
getTileUrl:function(e,g,c){var b=a.mixin({},this.parsedUrl.query,{token:this.token,blankTile:!this.tilemapCache&&this.resampling&&this.supportsBlankTile?!1:null,_ts:this.refreshTimestamp});e=this.parsedUrl.path+"/tile/"+e+"/"+g+"/"+c;b=h.objectToQuery(b);return e+(b?"?"+b:"")}})})},"esri/layers/support/TilemapCache":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/_base/lang dojo/io-query ../../request ../../core/Accessor ../../core/LRUMap ../../core/promiseUtils ../../core/watchUtils ../../core/Error ../../core/HandleRegistry ../../core/Logger ../../core/accessorSupport/decorators ./Tilemap".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r){var n=t.getLogger("esri.layers.support.TilemapCache");a=function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d._handles=new y;d._pendingTilemapRequests={};d._availableLevels={};d.levels=5;d.cacheByteSize=2097152;d.request=l;return d}p(d,a);d.prototype.normalizeCtorArgs=function(d){var b=this;d=f.mixin({},d);this._constructOnly={};["cacheByteSize","layer","levels","request"].forEach(function(a){a in d&&("levels"===a&&2>=d[a]?n.error("Minimum levels for Tilemap is 3, but got ",
d[a]):b._constructOnly[a]=d[a],delete d[a])});return d};d.prototype.initialize=function(){var d=this,b;for(b in this._constructOnly)this._set(b,this._constructOnly[b]);this._constructOnly=null;this._tilemapCache=new c(this.cacheByteSize,{sizeOfFunction:function(d){return d.byteSize}});this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers"],function(){return d._initializeTilemapDefinition()}),q.init(this,"layer.tileInfo.lods",function(b){return d._initializeAvailableLevels(b)},!0)]);
this._initializeTilemapDefinition()};d.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};Object.defineProperty(d.prototype,"size",{get:enumerable:!0,configurable:!0});d.prototype.getTilemap=d.prototype.fetchTilemap=function(d,a,c,e){var k=this;if(!this._availableLevels[d])return b.reject(new x("tilemap-cache:level-unavailable","Level "+d+" is unavailable in the service"));
var n=this._tmpTilemapDefinition;if(d=this._tilemapFromCache(d,a,c,n))return b.resolve(d);var g=r.tilemapDefinitionId(n);d=this._pendingTilemapRequests[g];d||(d=r.Tilemap.fromDefinition(n,e).then(.otherwise(,this._pendingTilemapRequests[g]=d);return d};d.prototype.getAvailability=d.prototype.getAvailabilityUpsample=d.prototype.fetchAvailability=function(d,a,c,e){return this._availableLevels[d]?this.fetchTilemap(d,a,c,e).always(function(k){return k instanceof r.Tilemap?(k=k.getAvailability(a,c),"unavailable"===
k?b.reject(new x("tile-map:tile-unavailable","Tile is not available",{level:d,row:a,col:c})):k):"unknown"}):b.reject(new x("tilemap-cache:level-unavailable","Level "+d+" is unavailable in the service"))};d.prototype.fetchAvailabilityUpsample=function(d,a,c,e,n){var k=this;e.level=d;e.row=a;e.col=c;var g=this.layer.tileInfo;g.updateTileInfo(e);return this.fetchAvailability(d,a,c,n).otherwise(function(d){return g.upsampleTile(e)?k.fetchAvailabilityUpsample(e.level,e.row,e.col,e):b.reject(d)})};d.prototype._initializeTilemapDefinition=
function(){if(this.layer.parsedUrl){var d=this.layer.parsedUrl,b=d.query;b&&b.token||!this.layer.token||(b=f.mixin(b,{token:this.layer.token}));this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:d.path,query:b?e.objectToQuery(b):null,tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}};d.prototype._tilemapFromCache=
d.prototype._getTilemapDefinition=d.prototype._initializeAvailableLevels=return d}(u.declared(g));m([u.property({readOnly:!0})],a.prototype,"levels",void 0);m([u.property({readOnly:!0,dependsOn:["levels"]})],a.prototype,"size",null);m([u.property({readOnly:!0})],a.prototype,"cacheByteSize",void 0);m([u.property({readOnly:!0})],
a.prototype,"layer",void 0);m([u.property({readOnly:!0})],a.prototype,"request",void 0);return a=m([u.subclass("esri.layers.support.TilemapCache")],a)})},"esri/core/LRUMap":function(){define(["require","exports"],function(a,h){return function(){bject.defineProperty(a.prototype,"length",{get:function(){return this._cache.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._sizeOf},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"keys",{get:function(){return this._queue.slice()},enumerable:!0,configurable:!0});a.prototype.clear=a.prototype.delete=function(a){var f=this._cache.get(a);return this._cache.delete(a)?(this._sizeOf-=this.sizeOfFunction(f),this.disposeFunction&&this.disposeFunction(a,f),this._queue.splice(this._queue.indexOf(a),1),!0):!1};a.prototype.forEach=function(a,f){this._cache.forEach(a,f)};a.prototype.get=a.prototype.has=
function(a){return this._cache.has(a)};a.prototype.set=a.prototype._collect=return a}()})},
"esri/core/watchUtils":function(){define(["require","exports","dojo/Deferred","dojo/promise/Promise"],function(a,h,p,m){function f(b,a,c,e,g){g=b.watch(a,g);var d=b.get(a);e&&e(d)&&c.call(b,d,d,a,b);return g}function e(b,a,c,e,g){ar k=!1,n,l=new p(d),r=new m;r.cancel=l.cancel;r.isCanceled=l.isCanceled;r.isFulfilled=l.isFulfilled;r.isRejected=l.isRejected;r.isResolved=l.isResolved;r.then=l.then;r.remove=d;Object.freeze(r);
n=f(b,a,e,g);k&&n.remove();return r}nction c(b){return!0===b}nction x(b){return void 0===b}function y(b,a,c,e){(Array.isArray(a)?a:-1<a.indexOf(",")?a.split(","):[a]).forEach(;return b.watch(a,c,e)}h.init=y;h.watch=h.once=h.when=function(b,a,c,e){return f(b,a,c,l,e)};h.whenOnce=function(b,a,c,n){return e(b,a,c,l,n)};h.whenNot=function(b,a,c,e){return f(b,a,c,g,e)};h.whenNotOnce=function(b,a,c,n){return e(b,a,c,g,n)};h.whenTrue=function(b,a,e,n){return f(b,a,e,c,n)};h.whenTrueOnce=function(b,a,g,n){return e(b,a,g,c,n)};h.whenFalse=function(a,c,e,n){return f(a,c,e,b,n)};h.whenFalseOnce=function(a,c,g,n){return e(a,c,g,b,n)};h.whenDefined=function(b,
a,c,e){return f(b,a,c,q,e)};h.whenDefinedOnce=function(b,a,c,n){return e(b,a,c,q,n)};h.whenUndefined=function(b,a,c,e){return f(b,a,c,x,e)};h.whenUndefinedOnce=h.pausable=function(b,a,c,e){var n=!1;return{remove:b.watch(a,e).remove,pause:function(){n=!0},resume:function(){n=!1}}};h.on=function(b,a,c,e,g,d,k){function n(){l&&(d&&d(f,a,b,c),l.remove(),f=l=null)}var f=null,l=null,r=y(b,a,function(d){n();d&&d.on&&(f=d,l=d.on(c,
e),g&&g(f,a,b,c))},k);return{remove:}})},"esri/layers/support/Tilemap":function(){define("require exports dojo/_base/lang ../../request ../../core/lang ../../core/Error".split(" "),function(a,h,p,m,f,e){function l(a){var c=a.service.tileServers,c=(c&&c.length?c[a.row%c.length]:a.service.url)+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height;(a=a.service.query)&&(c=c+"?"+a);return c}a=function(){.prototype.getAvailability=a.prototype._updateFromData=a.fromDefinition=function(c,b){var g=c.service.request||m,f=c.row,h=c.col,t=c.width,u=c.height,r={failOk:!0,callbackParamName:"callback"};b=b?p.mixin(r,b):r;return g(l(c),b).then(function(b){var c=b.data;if(c.location&&(c.location.top!==f||c.location.left!==h||c.location.width!==t||c.location.height!==u))throw new e("tilemap:location-mismatch",
"Tilemap response for different location than requested",{response:c,definition:{top:f,left:h,width:t,height:u}});return a.fromJSON(b.data)})};a.fromJSON=a.validateJSON=function(a){if(!a||!a.location)throw new e("tilemap:missing-location","Location missing from tilemap response");if(!a.valid)throw new e("tilemap:invalid","Tilemap response was marked as invalid");
if(!a.data)throw new e("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(a.data))throw new e("tilemap:data-mismatch","Data must be an array of numbers");if(a.data.length!==a.location.width*a.location.height)throw new e("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");};return a}();h.Tilemap=a;h.tilemapDefinitionId=h.tilemapDefinitionUrl=l;Object.defineProperty(h,
"__esModule",{value:!0});h.default=a})},"esri/layers/mixins/OperationalLayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/MultiOriginJSONSupport ../../core/Error ../../core/urlUtils ../../core/accessorSupport/read".split(" "),function(a,h,p,m,f,e,l,g,c,b){a=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.title="Layer";return b}p(e,a);e.prototype.writeListMode=
function(b,a){b&&(a.listMode=b)};e.prototype.writeTitle=e.prototype.writeUrl=function(b,a){b&&c.isProtocolRelative(b)&&(b="https:"+b);a.url=b};e.prototype.writeOperationalLayerType=function(b,a){b&&(a.layerType=b)};e.prototype.readOpacity=function(b,a,c){if(void 0!==a.opacity&&(!c||"web-map"===c.origin||"web-scene"===c.origin))return a.opacity;if((!c||"service"===c.origin)&&a.drawingInfo&&void 0!==a.drawingInfo.transparency)return 1-a.drawingInfo.transparency/100;
if(a.layerDefinition&&a.layerDefinition.drawingInfo&&void 0!==a.layerDefinition.drawingInfo.transparency)return 1-a.layerDefinition.drawingInfo.transparency/100};e.prototype.readVisible=function(b,a){return!!a.visibility};e.prototype.read=function(a,c){var e=this,g=arguments;b.readLoadable(this,a,c);return this};e.prototype.write=function(b,a){if(a&&a.origin){var c=a.origin+"/"+(a.layerContainerType||"operational-layers"),e=x[c];if(e&&!e[this.operationalLayerType])return a.messages&&
a.messages.push(new g("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' are not supported in the context of '"+c+"'",{layer:this})),null;if(!this.url&&!q[this.operationalLayerType])return a.messages&&a.messages.push(new g("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' require a url to a service to be written to a '"+a.origin+"'",{layer:this})),null}return this.inherited(arguments,[b,a])};return e}(f.declared(e,l));
m([f.property({json:{write:{ignoreOrigin:!0}}})],a.prototype,"id",void 0);m([f.property()],a.prototype,"listMode",void 0);m([f.writer("listMode")],a.prototype,"writeListMode",null);m([f.property({json:{write:{ignoreOrigin:!0,allowNull:!0}}})],a.prototype,"title",void 0);m([f.writer("title")],a.prototype,"writeTitle",null);m([f.property({json:{write:{ignoreOrigin:!0}}})],a.prototype,"url",void 0);m([f.writer("url")],a.prototype,"writeUrl",null);m([f.property({json:{write:{target:"layerType",ignoreOrigin:!0}}})],
a.prototype,"operationalLayerType",void 0);m([f.writer("operationalLayerType")],a.prototype,"writeOperationalLayerType",null);m([f.property({json:{write:{ignoreOrigin:!0}}})],a.prototype,"opacity",void 0);m([f.reader("opacity",["opacity","layerDefinition.drawingInfo.transparency","drawingInfo.transparency"])],a.prototype,"readOpacity",null);m([f.property({json:{write:{target:"visibility",ignoreOrigin:!0}}})],a.prototype,"visible",void 0);m([f.reader("visible",["visibility"])],a.prototype,"readVisible",
null);a=m([f.subclass("esri.layers.mixins.OperationalLayer")],a);var q={GroupLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,ArcGISFeatureLayer:!0,CSV:!0,VectorTileLayer:!0},x={"web-scene/operational-layers":{ArcGISFeatureLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,VectorTileLayer:!0},"web-scene/basemap":{ArcGISTiledElevationServiceLayer:!0,
ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0},"web-map/operational-layers":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,ArcGSFeatureLayer:!0,CSV:!0,GeoRSS:!0,KML:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,
ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,bingLayer:!0}};return a})},"esri/layers/mixins/PortalLayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Error ../../core/Logger ../../core/requireUtils ../../core/promiseUtils ../../core/urlUtils ../../portal/PortalItem ../../portal/Portal".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y){var t=g.getLogger("esri.layers.Layer");h=function(e){function g(){return null!==e&&e.apply(this,arguments)||this}p(g,e);Object.defineProperty(g.prototype,"portalItem",{set:function(b){b!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",b))},enumerable:!0,configurable:!0});g.prototype.writePortalItem=function(b,a){b&&b.id&&(a.itemId=b.id)};g.prototype.loadFromPortal=function(e){var n=this;return this.portalItem&&this.portalItem.id?
c.when(a,"../../portal/support/layersLoader").then(function(d){return d.load({instance:n,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData}).otherwise(function(d){t.warn("Failed to load layer ("+n.title+", "+n.id+") portal item ("+n.portalItem.id+")\n  "+d);throw d;})}):b.resolve()};g.prototype.write=function(b,a){var d=a&&a.portal,k=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||y.getDefault());return d&&k&&!q.hasSamePortal(k.restUrl,d.restUrl)?
(a.messages&&a.messages.push(new l("layer:cross-portal","The layer '"+this.title+" ("+this.id+")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer",{layer:this})),null):this.inherited(arguments)};return g}(f.declared(e));m([f.property({type:x})],h.prototype,"portalItem",null);m([f.writer("portalItem")],h.prototype,"writePortalItem",
null);return h=m([f.subclass("esri.layers.mixins.PortalLayer")],h)})},"esri/layers/support/rasterFormats/LercCodec":function(){define([],function(){var a={defaultNoDataValue:-3.4027999387901484E38,decode:function(p,m){var f;m=m||{};var e=m.inputOffset||0,l=m.encodedMaskData||null===m.encodedMaskData,g={},c=new Uint8Array(p,e,10);g.fileIdentifierString=String.fromCharCode.apply(null,c);if("CntZImage"!=g.fileIdentifierString.trim())throw"Unexpected file identifier string: "+g.fileIdentifierString;e+=
10;c=new DataView(p,e,24);g.fileVersion=c.getInt32(0,!0);g.imageType=c.getInt32(4,!0);g.height=c.getUint32(8,!0);g.width=c.getUint32(12,!0);g.maxZError=c.getFloat64(16,!0);e+=24;if(!l)if(c=new DataView(p,e,16),g.mask={},g.mask.numBlocksY=c.getUint32(0,!0),g.mask.numBlocksX=c.getUint32(4,!0),g.mask.numBytes=c.getUint32(8,!0),g.mask.maxValue=c.getFloat32(12,!0),e+=16,0<g.mask.numBytes){var l=new Uint8Array(Math.ceil(g.width*g.height/8)),c=new DataView(p,e,g.mask.numBytes),b=c.getInt16(0,!0),q=2,x=0;
do{if(0<b)for(;b--;)l[x++]=c.getUint8(q++);else for(var y=c.getUint8(q++),b=-b;b--;)l[x++]=y;b=c.getInt16(q,!0);q+=2}while(q<g.mask.numBytes);if(-32768!==b||x<l.length)throw"Unexpected end of mask RLE encoding";g.mask.bitset=l;e+=g.mask.numBytes}else 0===(g.mask.numBytes|g.mask.numBlocksY|g.mask.maxValue)&&(l=new Uint8Array(Math.ceil(g.width*g.height/8)),g.mask.bitset=l);c=new DataView(p,e,16);g.pixels={};g.pixels.numBlocksY=c.getUint32(0,!0);g.pixels.numBlocksX=c.getUint32(4,!0);g.pixels.numBytes=
c.getUint32(8,!0);g.pixels.maxValue=c.getFloat32(12,!0);e+=16;l=g.pixels.numBlocksX;c=g.pixels.numBlocksY;l+=0<g.width%l?1:0;b=c+(0<g.height%c?1:0);g.pixels.blocks=Array(l*b);q=1E9;for(y=x=0;y<b;y++)for(var t=0;t<l;t++){var u=0,c=new DataView(p,e,Math.min(10,p.byteLength-e)),r={};g.pixels.blocks[x++]=r;var n=c.getUint8(0);u++;r.encoding=n&63;if(3<r.encoding)throw"Invalid block encoding ("+r.encoding+")";if(2===r.encoding)e++,q=Math.min(q,0);else{if(0!==n&&2!==n){n>>=6;r.offsetType=n;if(2===n)r.offset=
c.getInt8(1),u++;else if(1===n)r.offset=c.getInt16(1,!0),u+=2;else if(0===n)r.offset=c.getFloat32(1,!0),u+=4;else throw"Invalid block offset type";q=Math.min(r.offset,q);if(1===r.encoding)if(n=c.getUint8(u),u++,r.bitsPerPixel=n&63,n>>=6,r.numValidPixelsType=n,2===n)r.numValidPixels=c.getUint8(u),u++;else if(1===n)r.numValidPixels=c.getUint16(u,!0),u+=2;else if(0===n)r.numValidPixels=c.getUint32(u,!0),u+=4;else throw"Invalid valid pixel count type";}e+=u;if(3!=r.encoding)if(0===r.encoding){c=(g.pixels.numBytes-
1)/4;if(c!==Math.floor(c))throw"uncompressed block has invalid length";u=new ArrayBuffer(4*c);n=new Uint8Array(u);n.set(new Uint8Array(p,e,4*c));u=new Float32Array(u);for(n=0;n<u.length;n++)q=Math.min(q,u[n]);r.rawData=u;e+=4*c}else 1===r.encoding&&(c=Math.ceil(r.numValidPixels*r.bitsPerPixel/8),u=new ArrayBuffer(4*Math.ceil(c/4)),n=new Uint8Array(u),n.set(new Uint8Array(p,e,c)),r.stuffedData=new Uint32Array(u),e+=c)}}g.pixels.minValue=q;g.eofOffset=e;p=null!=m.noDataValue?m.noDataValue:a.defaultNoDataValue;
var l=m.encodedMaskData,r=m.returnMask,c=0,b=g.pixels.numBlocksX,q=g.pixels.numBlocksY,x=Math.floor(g.width/b),y=Math.floor(g.height/q),t=2*g.maxZError,l=l||(g.mask?g.mask.bitset:null),w,e=new (m.pixelType||Float32Array)(g.width*g.height);r&&l&&(w=new Uint8Array(g.width*g.height));for(var r=new Float32Array(x*y),d,k,u=0;u<=q;u++)if(n=u!==q?y:g.height%q,0!==n)for(var v=0;v<=b;v++){var A=v!==b?x:g.width%b;if(0!==A){var z=u*g.width*y+v*x,D=g.width-A,B=g.pixels.blocks[c],C,F;if(2>B.encoding){if(0===B.encoding)C=
B.rawData;else{C=B.stuffedData;F=B.bitsPerPixel;d=B.numValidPixels;k=B.offset;var K=t,M=r,E=g.pixels.maxValue,V=(1<<F)-1,P=0,I=void 0,J=0,Q=void 0,S=void 0,ga=Math.ceil((E-k)/K);C[C.length-1]<<=8*(4*C.length-Math.ceil(F*d/8));for(I=0;I<d;I++)0===J&&(S=C[P++],J=32),J>=F?(Q=S>>>J-F&V,J-=F):(J=F-J,Q=(S&V)<<J&V,S=C[P++],J=32-J,Q+=S>>>J),M[I]=Q<ga?k+Q*K:E;C=r}F=0}else f=2===B.encoding?0:B.offset;var L;if(l)for(k=0;k<n;k++){z&7&&(L=l[z>>3],L<<=z&7);for(d=0;d<A;d++)z&7||(L=l[z>>3]),L&128?(w&&(w[z]=1),e[z++]=
2>B.encoding?C[F++]:f):(w&&(w[z]=0),e[z++]=p),L<<=1;z+=D}else if(2>B.encoding)for(k=0;k<n;k++){for(d=0;d<A;d++)e[z++]=C[F++];z+=D}else for(k=0;k<n;k++){for(d=0;d<A;d++)e[z++]=f;z+=D}if(1===B.encoding&&F!==B.numValidPixels)throw"Block and Mask do not match";c++}}f=w;w={width:g.width,height:g.height,pixelData:e,minValue:g.pixels.minValue,maxValue:g.pixels.maxValue,noDataValue:p};f&&(w.maskData=f);m.returnEncodedMask&&g.mask&&(w.encodedMaskData=g.mask.bitset?g.mask.bitset:null);if(m.returnFileInfo&&
(w.fileInfo=h(g),m.computeUsedBitDepths)){m=w.fileInfo;f=g.pixels.numBlocksX*g.pixels.numBlocksY;L={};for(C=0;C<f;C++)F=g.pixels.blocks[C],0===F.encoding?L.float32=!0:1===F.encoding?L[F.bitsPerPixel]=!0:L[0]=!0;g=Object.keys(L);m.bitDepths=g}return w}},h=function(a){return{fileIdentifierString:a.fileIdentifierString,fileVersion:a.fileVersion,imageType:a.imageType,height:a.height,width:a.width,maxZError:a.maxZError,eofOffset:a.eofOffset,mask:a.mask?{numBlocksX:a.mask.numBlocksX,numBlocksY:a.mask.numBlocksY,
numBytes:a.mask.numBytes,maxValue:a.mask.maxValue}:null,pixels:{numBlocksX:a.pixels.numBlocksX,numBlocksY:a.pixels.numBlocksY,numBytes:a.pixels.numBytes,maxValue:a.pixels.maxValue,minValue:a.pixels.minValue,noDataValue:this.noDataValue}}};return a})},"esri/Viewpoint":function(){define(["./core/JSONSupport","./Camera","./core/lang","./geometry/support/jsonUtils"],function(a,h,p,m){var f=a.createSubclass({declaredClass:"esri.Viewpoint",properties:{rotation:{value:0,cast:function(a){a%=360;0>a&&(a+=
360);return a}},scale:0,targetGeometry:{value:null,json:{read:function(a){return m.fromJSON(a)}}},camera:{value:null,type:h}},toJSON:function(){var a={scale:this.scale,rotation:this.rotation,targetGeometry:this.targetGeometry?this.targetGeometry.toJSON():void 0,camera:this.camera?this.camera.toJSON():void 0};a.camera&&delete a.camera.fov;return p.fixJson(a)},clone:function(){return new f({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry?this.targetGeometry.clone():null,camera:this.camera?
this.camera.clone():null})}});return f})},"esri/Camera":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/JSONSupport ./core/lang ./geometry/Point ./views/3d/support/mathUtils ./core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e,l,g,c){a=b=function(a){function c(b){b=a.call(this)||this;b.position=null;b.heading=0;b.tilt=0;b.fov=55;return b}p(c,a);c.prototype.getDefaults=function(b){if(!b.position)return{position:new l([0,
0,0])}};c.prototype.normalizeCtorArgs=function(b,a,c,e){b&&"object"===typeof b&&("x"in b||Array.isArray(b))&&(b={position:b},null!=a&&(b.heading=a),null!=c&&(b.tilt=c),null!=e&&(b.fov=e));return b};c.prototype.equals=function(b){return b?this.tilt===b.tilt&&this.heading===b.heading&&this.fov===b.fov&&this.position.equals(b.position):!1};c.prototype.clone=function(){return new b({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})};c.prototype.toJSON=function(){var b=
{position:this.position.toJSON(),heading:this.heading,tilt:this.tilt};return e.fixJson(b)};return c}(c.declared(f));m([c.property({type:l})],a.prototype,"position",void 0);m([c.property(),c.cast(g.cyclicalDeg.normalize)],a.prototype,"heading",void 0);m([c.property(),c.cast(],a.prototype,"tilt",void 0);m([c.property({json:{read:!1,write:!1}})],a.prototype,"fov",void 0);a=b=m([c.subclass("esri.Camera")],a);var b;return a})},"esri/views/3d/support/mathUtils":function(){define(["../lib/glMatrix"],
function(a){function h(b){for(var a in b){var c=b[a];"function"===typeof c&&(b[a]=c.bind(b))}return b}var p=a.vec3d,m=a.mat4d,f=p.create(),e=m.create(),l=p.create(),g=p.create(),c={deg2rad:rad2deg:asin:function(b){return Math.asin(1<b?1:-1>b?-1:b)},acos:function(b){return Math.acos(1<b?1:-1>b?-1:b)},log2:Math.log2||fovx2fovy:function(b,a,c){return 2*Math.atan(c*Math.tan(.5*b)/a)},fovy2fovx:function(b,
a,c){return 2*Math.atan(a*Math.tan(.5*b)/c)},lerp:bilerp:function(b,a,c,e,g,f){b+=(a-b)*g;return b+(c+(e-c)*g-b)*f},slerp:function(b,a,c,g){g||(g=b);var l=p.length(b),q=p.length(a),r=p.dot(b,a)/l/q;.999999999999>r&&(p.cross(b,a,f),m.identity(e),m.rotate(e,c*Math.acos(r),f),m.multiplyVec3(e,b,g));p.scale(g,((1-c)*l+c*q)/l)},slerpOrLerp:function(b,a,c,g,l){var q=p.length(b),r=p.length(a);p.cross(b,a,f);p.length(f)/q/r>l?(a=Math.acos(p.dot(b,a)/q/r),m.identity(e),m.rotate(e,
c*a,f),m.multiplyVec3(e,b,g),p.scale(g,((1-c)*q+c*r)/q)):p.lerp(b,a,c,g)},angle:function(b,a,e){b=p.normalize(b,l);a=p.normalize(a,g);var m=c.acos(p.dot(b,a));return e&&(b=p.cross(b,a,f),0>p.dot(b,e))?-m:m},clamp:isFinite:Number.isFinite||isNaN:Number.isNaN||makePiecewiseLinearFunction:function(b){var a=b.length;return function(c){var e=0;if(c<=b[0][0])return b[0][1];if(c>=b[a-1][0])return b[a-
1][1];for(;c>b[e][0];)e++;var g=b[e][0];c=(g-c)/(g-b[e-1][0]);return c*b[e-1][1]+(1-c)*b[e][1]}},vectorEquals:function(b,a){if(null==b||null==a)return b!==a;if(b.length!==a.length)return!1;for(var c=0;c<b.length;c++)if(b[c]!==a[c])return!1;return!0},floatEqualRelative:function(b,a,c){void 0===c&&(c=1E-6);if(isNaN(b)||isNaN(a))return!1;if(b===a)return!0;var e=Math.abs(b-a),g=Math.abs(b),f=Math.abs(a);if(0===b||0===a||1E-12>g&&1E-12>f){if(e>.01*c)return!1}else if(e/(g+f)>c)return!1;return!0},floatEqualAbsolute:function(b,
a,c){void 0===c&&(c=1E-6);return isNaN(b)||isNaN(a)?!1:(b>a?b-a:a-b)<=c},Cyclical:function(b,a){this.min=b;this.max=a;this.range=a-b;this.ndiff=function(b,a){a=a||0;return Math.ceil((b-a)/this.range)*this.range+a};this._normalize=function(b,a,c,e){e=e||0;c-=e;c<b?c+=this.ndiff(b-c):c>a&&(c-=this.ndiff(c-a));return c+e};this.normalize=this.clamp=function(e,g){g=g||0;return c.clamp(e-g,b,a)+g};this.monotonic=function(b,a,c){return b<a?a:a+
this.ndiff(b-a,c)};this.minimalMonotonic=function(b,a,c){return this._normalize(b,b+this.range,a,c)};this.center=function(b,a,c){a=this.monotonic(b,a,c);return this.normalize((b+a)/2,c)};this.diff=function(b,a,c){return this.monotonic(b,a,c)-b};this.contains=function(b,a,c){a=this.minimalMonotonic(b,a);c=this.minimalMonotonic(b,c);return c>b&&c<a}}};c.cyclical2PI=h(new c.Cyclical(0,2*Math.PI));c.cyclicalPI=h(new c.Cyclical(-Math.PI,Math.PI));c.cyclicalDeg=h(new c.Cyclical(0,360));return c})},"esri/views/3d/lib/glMatrix":function(){define([],
function(){var a={};(function(a,p){p(a,!0);p(a,!1)})(a,function(a,p){var m={};(function(){if("undefined"!=typeof Float32Array){var d=new Float32Array(1),b=new Int32Array(d.buffer);m.invsqrt=function(a){d[0]=a;b[0]=1597463007-(b[0]>>1);var k=d[0];return k*(1.5-.5*a*k*k)}}else m.invsqrt=)();var f=Array;"undefined"!=typeof Float32Array&&(f=p?Float32Array:Array);var e={create:function(d){var b=new f(3);d?(b[0]=d[0],b[1]=d[1],b[2]=d[2]):b[0]=b[1]=b[2]=0;return b},createFrom:function(d,
b,a){var k=new f(3);k[0]=d;k[1]=b;k[2]=a;return k},set:set3:add:subtract:multiply:function(d,b,a){if(!a||d===a)return d[0]*=b[0],d[1]*=b[1],d[2]*=
b[2],d;a[0]=d[0]*b[0];a[1]=d[1]*b[1];a[2]=d[2]*b[2];return a},max:function(d,b,a){a[0]=Math.max(d[0],b[0]);a[1]=Math.max(d[1],b[1]);a[2]=Math.max(d[2],b[2]);return a},min:negate:scale:normalize:function(d,b){b||(b=d);var a=d[0],
k=d[1];d=d[2];var c=Math.sqrt(a*a+k*k+d*d);if(!c)return b[0]=0,b[1]=0,b[2]=0,b;if(1===c)return b[0]=a,b[1]=k,b[2]=d,b;c=1/c;b[0]=a*c;b[1]=k*c;b[2]=d*c;return b},cross:function(d,b,a){a||(a=d);var k=d[0],c=d[1];d=d[2];var e=b[0],n=b[1];b=b[2];a[0]=c*b-d*n;a[1]=d*e-k*b;a[2]=k*n-c*e;return a},length:length2:dot:direction:function(d,
b,a){a||(a=d);var k=d[0]-b[0],c=d[1]-b[1];d=d[2]-b[2];b=Math.sqrt(k*k+c*c+d*d);if(!b)return a[0]=0,a[1]=0,a[2]=0,a;b=1/b;a[0]=k*b;a[1]=c*b;a[2]=d*b;return a},lerp:dist:dist2:,l=null,g=new f(4);e.unproject=function(d,b,a,c,e){e||(e=d);
l||(l=u.create());var k=l;g[0]=2*(d[0]-c[0])/c[2]-1;g[1]=2*(d[1]-c[1])/c[3]-1;g[2]=2*d[2]-1;g[3]=1;u.multiply(a,b,k);if(!u.inverse(k))return null;u.multiplyVec4(k,g);if(0===g[3])return null;e[0]=g[0]/g[3];e[1]=g[1]/g[3];e[2]=g[2]/g[3];return e};var c=e.createFrom(1,0,0),b=e.createFrom(0,1,0),q=e.createFrom(0,0,1);e.rotationTo=function(d,a,g){g||(g=r.create());var k=e.dot(d,a),f=e.create();if(1<=k)r.set(n,g);else if(-.999999>k)e.cross(c,d,f),1E-6>f.length&&e.cross(b,d,f),1E-6>f.length&&e.cross(q,d,
f),e.normalize(f),r.fromAxisAngle(f,Math.PI,g);else{var k=Math.sqrt(2*(1+k)),v=1/k;e.cross(d,a,f);g[0]=f[0]*v;g[1]=f[1]*v;g[2]=f[2]*v;g[3]=.5*k;r.normalize(g)}1<g[3]?g[3]=1:-1>g[3]&&(g[3]=-1);return g};var h=e.create(),y=e.create();e.project=function(d,b,a,c){c||(c=d);e.direction(b,a,h);e.subtract(d,b,y);d=e.dot(h,y);e.scale(h,d,c);e.add(c,b,c)};e.str=var t={create:function(d){var b=new f(9);d?(b[0]=d[0],b[1]=d[1],b[2]=d[2],b[3]=d[3],b[4]=d[4],b[5]=
d[5],b[6]=d[6],b[7]=d[7],b[8]=d[8]):b[0]=b[1]=b[2]=b[3]=b[4]=b[5]=b[6]=b[7]=b[8]=0;return b},createFrom:determinant:inverse:function(d,b){var a=d[0],k=d[1],c=d[2],e=d[3],n=d[4],g=d[5],f=d[6],l=d[7];d=d[8];var r=d*n-g*l,m=-d*e+g*f,q=l*e-n*f,w=a*r+k*m+c*q;if(!w)return null;w=
1/w;b||(b=t.create());b[0]=r*w;b[1]=(-d*k+c*l)*w;b[2]=(g*k-c*n)*w;b[3]=m*w;b[4]=(d*a-c*f)*w;b[5]=(-g*a+c*e)*w;b[6]=q*w;b[7]=(-l*a+k*f)*w;b[8]=(n*a-k*e)*w;return b},multiply:function(d,b,a){a||(a=d);var k=d[0],c=d[1],e=d[2],n=d[3],g=d[4],f=d[5],v=d[6],l=d[7];d=d[8];var r=b[0],m=b[1],q=b[2],t=b[3],w=b[4],u=b[5],h=b[6],x=b[7];b=b[8];a[0]=r*k+m*n+q*v;a[1]=r*c+m*g+q*l;a[2]=r*e+m*f+q*d;a[3]=t*k+w*n+u*v;a[4]=t*c+w*g+u*l;a[5]=t*e+w*f+u*d;a[6]=h*k+x*n+b*v;a[7]=h*c+x*g+b*l;a[8]=h*e+x*f+b*d;return a},add:function(d,
b,a){a||(a=d);a[0]=d[0]+b[0];a[1]=d[1]+b[1];a[2]=d[2]+b[2];a[3]=d[3]+b[3];a[4]=d[4]+b[4];a[5]=d[5]+b[5];a[6]=d[6]+b[6];a[7]=d[7]+b[7];a[8]=d[8]+b[8];return a},subtract:function(d,b,a){a||(a=d);a[0]=d[0]-b[0];a[1]=d[1]-b[1];a[2]=d[2]-b[2];a[3]=d[3]-b[3];a[4]=d[4]-b[4];a[5]=d[5]-b[5];a[6]=d[6]-b[6];a[7]=d[7]-b[7];a[8]=d[8]-b[8];return a},multiplyVec2:function(d,b,a){a||(a=b);var k=b[0];b=b[1];a[0]=k*d[0]+b*d[3]+d[6];a[1]=k*d[1]+b*d[4]+d[7];return a},multiplyVec3:function(d,b,a){a||(a=b);var k=b[0],
c=b[1];b=b[2];a[0]=k*d[0]+c*d[3]+b*d[6];a[1]=k*d[1]+c*d[4]+b*d[7];a[2]=k*d[2]+c*d[5]+b*d[8];return a},set:identity:function(d){d||(d=t.create());d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=1;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d},transpose:function(d,b){if(!b||d===b){b=d[1];var a=d[2],k=d[5];d[1]=d[3];d[2]=d[6];d[3]=b;d[5]=d[7];d[6]=a;d[7]=k;return d}b[0]=d[0];b[1]=d[3];b[2]=d[6];b[3]=d[1];b[4]=d[4];
b[5]=d[7];b[6]=d[2];b[7]=d[5];b[8]=d[8];return b},toMat4:str:,u={create:function(d){var b=new f(16);4===arguments.length?(b[0]=arguments[0],b[1]=arguments[1],b[2]=arguments[2],b[3]=arguments[3],b[4]=arguments[4],
b[5]=arguments[5],b[6]=arguments[6],b[7]=arguments[7],b[8]=arguments[8],b[9]=arguments[9],b[10]=arguments[10],b[11]=arguments[11],b[12]=arguments[12],b[13]=arguments[13],b[14]=arguments[14],b[15]=arguments[15]):d&&(b[0]=d[0],b[1]=d[1],b[2]=d[2],b[3]=d[3],b[4]=d[4],b[5]=d[5],b[6]=d[6],b[7]=d[7],b[8]=d[8],b[9]=d[9],b[10]=d[10],b[11]=d[11],b[12]=d[12],b[13]=d[13],b[14]=d[14],b[15]=d[15]);return b},createFrom:createFromMatrixRowMajor:function(d){var b=new f(16);b[0]=d[0];b[4]=d[1];b[8]=d[2];b[12]=d[3];b[1]=d[4];b[5]=d[5];b[9]=d[6];b[13]=d[7];b[2]=d[8];b[6]=d[9];b[10]=d[10];b[14]=d[11];b[3]=d[12];b[7]=d[13];b[11]=d[14];b[15]=d[15];return b},createFromMatrix:set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},setRowMajor:identity:function(b){b||(b=u.create());b[0]=
1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},transpose:function(b,a){if(!a||b===a){a=b[1];var d=b[2],c=b[3],k=b[6],e=b[7],n=b[11];b[1]=b[4];b[2]=b[8];b[3]=b[12];b[4]=a;b[6]=b[9];b[7]=b[13];b[8]=d;b[9]=k;b[11]=b[14];b[12]=c;b[13]=e;b[14]=n;return b}a[0]=b[0];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=b[1];a[5]=b[5];a[6]=b[9];a[7]=b[13];a[8]=b[2];a[9]=b[6];a[10]=b[10];a[11]=b[14];a[12]=b[3];a[13]=b[7];a[14]=b[11];a[15]=b[15];return a},
determinant:function(b){var d=b[0],a=b[1],c=b[2],e=b[3],n=b[4],g=b[5],f=b[6],l=b[7],r=b[8],m=b[9],q=b[10],t=b[11],w=b[12],u=b[13],h=b[14];b=b[15];return w*m*f*e-r*u*f*e-w*g*q*e+n*u*q*e+r*g*h*e-n*m*h*e-w*m*c*l+r*u*c*l+w*a*q*l-d*u*q*l-r*a*h*l+d*m*h*l+w*g*c*t-n*u*c*t-w*a*f*t+d*u*f*t+n*a*h*t-d*g*h*t-r*g*c*b+n*m*c*b+r*a*f*b-d*m*f*b-n*a*q*b+d*g*q*b},inverse:function(b,a){a||(a=b);var d=b[0],c=b[1],k=b[2],e=b[3],n=b[4],g=b[5],f=b[6],l=b[7],r=b[8],m=b[9],q=b[10],t=b[11],w=b[12],u=b[13],h=b[14];b=b[15];var x=
d*g-c*n,p=d*f-k*n,y=d*l-e*n,R=c*f-k*g,U=c*l-e*g,T=k*l-e*f,N=r*u-m*w,Z=r*h-q*w,H=r*b-t*w,O=m*h-q*u,aa=m*b-t*u,ba=q*b-t*h,X=x*ba-p*aa+y*O+R*H-U*Z+T*N;if(!X)return null;X=1/X;a[0]=(g*ba-f*aa+l*O)*X;a[1]=(-c*ba+k*aa-e*O)*X;a[2]=(u*T-h*U+b*R)*X;a[3]=(-m*T+q*U-t*R)*X;a[4]=(-n*ba+f*H-l*Z)*X;a[5]=(d*ba-k*H+e*Z)*X;a[6]=(-w*T+h*y-b*p)*X;a[7]=(r*T-q*y+t*p)*X;a[8]=(n*aa-g*H+l*N)*X;a[9]=(-d*aa+c*H-e*N)*X;a[10]=(w*U-u*y+b*x)*X;a[11]=(-r*U+m*y-t*x)*X;a[12]=(-n*O+g*Z-f*N)*X;a[13]=(d*O-c*Z+k*N)*X;a[14]=(-w*R+u*p-
h*x)*X;a[15]=(r*R-m*p+q*x)*X;return a},toRotationMat:toMat3:toInverseMat3:function(b,a){var d=b[0],c=b[1],k=b[2],e=b[4],n=b[5],g=b[6],f=b[8],l=b[9];b=b[10];var r=b*n-g*l,
m=-b*e+g*f,q=l*e-n*f,w=d*r+c*m+k*q;if(!w)return null;w=1/w;a||(a=t.create());a[0]=r*w;a[1]=(-b*c+k*l)*w;a[2]=(g*c-k*n)*w;a[3]=m*w;a[4]=(b*d-k*f)*w;a[5]=(-g*d+k*e)*w;a[6]=q*w;a[7]=(-l*d+c*f)*w;a[8]=(n*d-c*e)*w;return a},multiply:function(b,a,c){c||(c=b);var d=b[0],k=b[1],e=b[2],n=b[3],g=b[4],f=b[5],v=b[6],l=b[7],r=b[8],m=b[9],q=b[10],t=b[11],w=b[12],u=b[13],h=b[14];b=b[15];var x=a[0],p=a[1],y=a[2],U=a[3],T=a[4],N=a[5],Z=a[6],H=a[7],O=a[8],aa=a[9],ba=a[10],X=a[11],ea=a[12],la=a[13],ta=a[14];a=a[15];
c[0]=x*d+p*g+y*r+U*w;c[1]=x*k+p*f+y*m+U*u;c[2]=x*e+p*v+y*q+U*h;c[3]=x*n+p*l+y*t+U*b;c[4]=T*d+N*g+Z*r+H*w;c[5]=T*k+N*f+Z*m+H*u;c[6]=T*e+N*v+Z*q+H*h;c[7]=T*n+N*l+Z*t+H*b;c[8]=O*d+aa*g+ba*r+X*w;c[9]=O*k+aa*f+ba*m+X*u;c[10]=O*e+aa*v+ba*q+X*h;c[11]=O*n+aa*l+ba*t+X*b;c[12]=ea*d+la*g+ta*r+a*w;c[13]=ea*k+la*f+ta*m+a*u;c[14]=ea*e+la*v+ta*q+a*h;c[15]=ea*n+la*l+ta*t+a*b;return c},multiplyVec3:function(b,a,c){c||(c=a);var d=a[0],k=a[1];a=a[2];c[0]=b[0]*d+b[4]*k+b[8]*a+b[12];c[1]=b[1]*d+b[5]*k+b[9]*a+b[13];c[2]=
b[2]*d+b[6]*k+b[10]*a+b[14];return c},multiplyVec4:function(b,a,c){c||(c=a);var d=a[0],k=a[1],e=a[2];a=a[3];c[0]=b[0]*d+b[4]*k+b[8]*e+b[12]*a;c[1]=b[1]*d+b[5]*k+b[9]*e+b[13]*a;c[2]=b[2]*d+b[6]*k+b[10]*e+b[14]*a;c[3]=b[3]*d+b[7]*k+b[11]*e+b[15]*a;return c},translate:function(b,a,c){var d=a[0],k=a[1];a=a[2];var e,n,g,f,v,l,r,m,q,t,w,u;if(!c||b===c)return b[12]=b[0]*d+b[4]*k+b[8]*a+b[12],b[13]=b[1]*d+b[5]*k+b[9]*a+b[13],b[14]=b[2]*d+b[6]*k+b[10]*a+b[14],b[15]=b[3]*d+b[7]*k+b[11]*a+b[15],b;e=b[0];n=b[1];
g=b[2];f=b[3];v=b[4];l=b[5];r=b[6];m=b[7];q=b[8];t=b[9];w=b[10];u=b[11];c[0]=e;c[1]=n;c[2]=g;c[3]=f;c[4]=v;c[5]=l;c[6]=r;c[7]=m;c[8]=q;c[9]=t;c[10]=w;c[11]=u;c[12]=e*d+v*k+q*a+b[12];c[13]=n*d+l*k+t*a+b[13];c[14]=g*d+r*k+w*a+b[14];c[15]=f*d+m*k+u*a+b[15];return c},scale:function(b,a,c){var d=a[0],k=a[1];a=a[2];if(!c||b===c)return b[0]*=d,b[1]*=d,b[2]*=d,b[3]*=d,b[4]*=k,b[5]*=k,b[6]*=k,b[7]*=k,b[8]*=a,b[9]*=a,b[10]*=a,b[11]*=a,b;c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[3]=b[3]*d;c[4]=b[4]*k;c[5]=b[5]*
k;c[6]=b[6]*k;c[7]=b[7]*k;c[8]=b[8]*a;c[9]=b[9]*a;c[10]=b[10]*a;c[11]=b[11]*a;c[12]=b[12];c[13]=b[13];c[14]=b[14];c[15]=b[15];return c},maxScale:function(b){return Math.max(Math.max(Math.sqrt(b[0]*b[0]+b[4]*b[4]+b[8]*b[8]),Math.sqrt(b[1]*b[1]+b[5]*b[5]+b[9]*b[9])),Math.sqrt(b[2]*b[2]+b[6]*b[6]+b[10]*b[10]))},rotate:function(b,a,c,e){var d=c[0],k=c[1];c=c[2];var n=Math.sqrt(d*d+k*k+c*c),g,f,v,l,r,m,q,t,w,u,h,A,x,p,y,T,N,Z,H,O;if(!n)return null;1!==n&&(n=1/n,d*=n,k*=n,c*=n);g=Math.sin(a);f=Math.cos(a);
v=1-f;a=b[0];n=b[1];l=b[2];r=b[3];m=b[4];q=b[5];t=b[6];w=b[7];u=b[8];h=b[9];A=b[10];x=b[11];p=d*d*v+f;y=k*d*v+c*g;T=c*d*v-k*g;N=d*k*v-c*g;Z=k*k*v+f;H=c*k*v+d*g;O=d*c*v+k*g;d=k*c*v-d*g;k=c*c*v+f;e?b!==e&&(e[12]=b[12],e[13]=b[13],e[14]=b[14],e[15]=b[15]):e=b;e[0]=a*p+m*y+u*T;e[1]=n*p+q*y+h*T;e[2]=l*p+t*y+A*T;e[3]=r*p+w*y+x*T;e[4]=a*N+m*Z+u*H;e[5]=n*N+q*Z+h*H;e[6]=l*N+t*Z+A*H;e[7]=r*N+w*Z+x*H;e[8]=a*O+m*d+u*k;e[9]=n*O+q*d+h*k;e[10]=l*O+t*d+A*k;e[11]=r*O+w*d+x*k;return e},rotateX:function(b,a,c){var d=
Math.sin(a);a=Math.cos(a);var k=b[4],e=b[5],n=b[6],g=b[7],f=b[8],v=b[9],l=b[10],r=b[11];c?b!==c&&(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]):c=b;c[4]=k*a+f*d;c[5]=e*a+v*d;c[6]=n*a+l*d;c[7]=g*a+r*d;c[8]=k*-d+f*a;c[9]=e*-d+v*a;c[10]=n*-d+l*a;c[11]=g*-d+r*a;return c},rotateY:function(b,a,c){var d=Math.sin(a);a=Math.cos(a);var k=b[0],e=b[1],n=b[2],g=b[3],f=b[8],v=b[9],l=b[10],r=b[11];c?b!==c&&(c[4]=b[4],c[5]=b[5],c[6]=b[6],c[7]=b[7],c[12]=b[12],c[13]=b[13],
c[14]=b[14],c[15]=b[15]):c=b;c[0]=k*a+f*-d;c[1]=e*a+v*-d;c[2]=n*a+l*-d;c[3]=g*a+r*-d;c[8]=k*d+f*a;c[9]=e*d+v*a;c[10]=n*d+l*a;c[11]=g*d+r*a;return c},rotateZ:function(b,a,c){var d=Math.sin(a);a=Math.cos(a);var k=b[0],e=b[1],n=b[2],g=b[3],f=b[4],v=b[5],l=b[6],r=b[7];c?b!==c&&(c[8]=b[8],c[9]=b[9],c[10]=b[10],c[11]=b[11],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]):c=b;c[0]=k*a+f*d;c[1]=e*a+v*d;c[2]=n*a+l*d;c[3]=g*a+r*d;c[4]=k*-d+f*a;c[5]=e*-d+v*a;c[6]=n*-d+l*a;c[7]=g*-d+r*a;return c},frustum:function(b,
a,c,e,n,g,f){f||(f=u.create());var d=a-b,k=e-c,v=g-n;f[0]=2*n/d;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2*n/k;f[6]=0;f[7]=0;f[8]=(a+b)/d;f[9]=(e+c)/k;f[10]=-(g+n)/v;f[11]=-1;f[12]=0;f[13]=0;f[14]=-(g*n*2)/v;f[15]=0;return f},perspective:ortho:lookAt:function(b,a,c,e){e||(e=u.create());var d,k,n,g,f,v,l,r,m=b[0],q=b[1];b=b[2];n=c[0];g=c[1];k=c[2];l=a[0];c=a[1];d=a[2];if(m===l&&q===c&&b===d)return u.identity(e);a=m-l;c=q-c;l=b-d;r=1/Math.sqrt(a*a+c*c+l*l);a*=r;c*=r;l*=r;d=g*l-k*c;k=k*a-n*l;n=n*c-g*a;(r=Math.sqrt(d*d+k*k+n*n))?(r=1/r,d*=r,k*=r,n*=r):n=k=d=0;g=c*n-l*k;f=l*d-a*n;v=a*k-c*d;(r=Math.sqrt(g*g+f*f+v*v))?(r=1/r,g*=r,f*=r,v*=r):v=f=g=0;e[0]=d;e[1]=g;e[2]=a;e[3]=0;e[4]=k;e[5]=f;e[6]=c;e[7]=
0;e[8]=n;e[9]=v;e[10]=l;e[11]=0;e[12]=-(d*m+k*q+n*b);e[13]=-(g*m+f*q+v*b);e[14]=-(a*m+c*q+l*b);e[15]=1;return e},fromRotationTranslation:function(b,a,c){c||(c=u.create());var d=b[0],k=b[1],e=b[2],n=b[3],g=d+d,f=k+k,v=e+e;b=d*g;var l=d*f,d=d*v,r=k*f,k=k*v,e=e*v,g=n*g,f=n*f,n=n*v;c[0]=1-(r+e);c[1]=l+n;c[2]=d-f;c[3]=0;c[4]=l-n;c[5]=1-(b+e);c[6]=k+g;c[7]=0;c[8]=d+f;c[9]=k-g;c[10]=1-(b+r);c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c},str:,r={create:function(b){var d=new f(4);b?(d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3]):d[0]=d[1]=d[2]=d[3]=0;return d},createFrom:function(b,a,c,e){var d=new f(4);d[0]=b;d[1]=a;d[2]=c;d[3]=e;return d},set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},identity:function(b){b||(b=r.create());b[0]=0;b[1]=0;b[2]=0;b[3]=1;return b}},n=r.identity();r.calculateW=
r.dot=function(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]*a[3]};r.inverse=function(b,a){var d=b[0],c=b[1],k=b[2],e=b[3],d=(d=d*d+c*c+k*k+e*e)?1/d:0;if(!a||b===a)return b[0]*=-d,b[1]*=-d,b[2]*=-d,b[3]*=d,b;a[0]=-b[0]*d;a[1]=-b[1]*d;a[2]=-b[2]*d;a[3]=b[3]*d;return a};r.conjugate=r.length=r.normalize=function(b,a){a||(a=b);var d=b[0],c=b[1],k=b[2];b=b[3];var e=Math.sqrt(d*d+c*c+k*k+b*b);if(0===e)return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a;e=1/e;a[0]=d*e;a[1]=c*e;a[2]=k*e;a[3]=b*e;return a};r.add=function(b,a,c){if(!c||b===c)return b[0]+=a[0],b[1]+=a[1],b[2]+=a[2],b[3]+=a[3],b;c[0]=b[0]+a[0];c[1]=b[1]+a[1];c[2]=b[2]+a[2];c[3]=b[3]+a[3];
return c};r.multiply=function(b,a,c){c||(c=b);var d=b[0],k=b[1],e=b[2];b=b[3];var n=a[0],g=a[1],f=a[2];a=a[3];c[0]=d*a+b*n+k*f-e*g;c[1]=k*a+b*g+e*n-d*f;c[2]=e*a+b*f+d*g-k*n;c[3]=b*a-d*n-k*g-e*f;return c};r.multiplyVec3=function(b,a,c){c||(c=a);var d=a[0],k=a[1],e=a[2];a=b[0];var n=b[1],g=b[2];b=b[3];var f=b*d+n*e-g*k,v=b*k+g*d-a*e,l=b*e+a*k-n*d,d=-a*d-n*k-g*e;c[0]=f*b+d*-a+v*-g-l*-n;c[1]=v*b+d*-n+l*-a-f*-g;c[2]=l*b+d*-g+f*-n-v*-a;return c};r.scale=function(b,a,c){if(!c||b===c)return b[0]*=a,b[1]*=
a,b[2]*=a,b[3]*=a,b;c[0]=b[0]*a;c[1]=b[1]*a;c[2]=b[2]*a;c[3]=b[3]*a;return c};r.toMat3=function(b,a){a||(a=t.create());var d=b[0],c=b[1],k=b[2],e=b[3],n=d+d,g=c+c,f=k+k;b=d*n;var l=d*g,d=d*f,r=c*g,c=c*f,k=k*f,n=e*n,g=e*g,e=e*f;a[0]=1-(r+k);a[1]=l+e;a[2]=d-g;a[3]=l-e;a[4]=1-(b+k);a[5]=c+n;a[6]=d+g;a[7]=c-n;a[8]=1-(b+r);return a};r.toMat4=function(b,a){a||(a=u.create());var d=b[0],c=b[1],k=b[2],e=b[3],n=d+d,g=c+c,f=k+k;b=d*n;var l=d*g,d=d*f,r=c*g,c=c*f,k=k*f,n=e*n,g=e*g,e=e*f;a[0]=1-(r+k);a[1]=l+e;
a[2]=d-g;a[3]=0;a[4]=l-e;a[5]=1-(b+k);a[6]=c+n;a[7]=0;a[8]=d+g;a[9]=c-n;a[10]=1-(b+r);a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};r.slerp=function(b,a,c,e){e||(e=b);var d=b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]*a[3],k,n;if(1<=Math.abs(d))return e!==b&&(e[0]=b[0],e[1]=b[1],e[2]=b[2],e[3]=b[3]),e;k=Math.acos(d);n=Math.sqrt(1-d*d);if(.001>Math.abs(n))return e[0]=.5*b[0]+.5*a[0],e[1]=.5*b[1]+.5*a[1],e[2]=.5*b[2]+.5*a[2],e[3]=.5*b[3]+.5*a[3],e;d=Math.sin((1-c)*k)/n;c=Math.sin(c*k)/n;e[0]=b[0]*d+a[0]*
c;e[1]=b[1]*d+a[1]*c;e[2]=b[2]*d+a[2]*c;e[3]=b[3]*d+a[3]*c;return e};r.fromRotationMatrix=function(b,a){a||(a=r.create());var d=b[0]+b[4]+b[8],c;if(0<d)c=Math.sqrt(d+1),a[3]=.5*c,c=.5/c,a[0]=(b[7]-b[5])*c,a[1]=(b[2]-b[6])*c,a[2]=(b[3]-b[1])*c;else{c=r.fromRotationMatrix.s_iNext=r.fromRotationMatrix.s_iNext||[1,2,0];d=0;b[4]>b[0]&&(d=1);b[8]>b[3*d+d]&&(d=2);var e=c[d],k=c[e];c=Math.sqrt(b[3*d+d]-b[3*e+e]-b[3*k+k]+1);a[d]=.5*c;c=.5/c;a[3]=(b[3*k+e]-b[3*e+k])*c;a[e]=(b[3*e+d]+b[3*d+e])*c;a[k]=(b[3*k+
d]+b[3*d+k])*c}return a};t.toQuat4=r.fromRotationMatrix;(function(){var b=t.create();r.fromAxes=function(a,d,c,e){b[0]=d[0];b[3]=d[1];b[6]=d[2];b[1]=c[0];b[4]=c[1];b[7]=c[2];b[2]=a[0];b[5]=a[1];b[8]=a[2];return r.fromRotationMatrix(b,e)}})();r.identity=function(b){b||(b=r.create());b[0]=0;b[1]=0;b[2]=0;b[3]=1;return b};r.fromAngleAxis=function(b,a,c){c||(c=r.create());b*=.5;var d=Math.sin(b);c[3]=Math.cos(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];return c};r.toAngleAxis=function(b,a){a||(a=b);var d=
b[0]*b[0]+b[1]*b[1]+b[2]*b[2];0<d?(a[3]=2*Math.acos(b[3]),d=m.invsqrt(d),a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d):(a[3]=0,a[0]=1,a[1]=0,a[2]=0);return a};r.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"};var w={create:function(b){var a=new f(4);b?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):a[0]=a[1]=a[2]=a[3]=0;return a},createFrom:function(b,a,c,e){var d=new f(4);d[0]=b;d[1]=a;d[2]=c;d[3]=e;return d},set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},identity:function(b){b||
(b=w.create());b[0]=1;b[1]=0;b[2]=0;b[3]=1;return b},transpose:function(b,a){if(!a||b===a)return a=b[1],b[1]=b[2],b[2]=a,b;a[0]=b[0];a[1]=b[2];a[2]=b[1];a[3]=b[3];return a},determinant:inverse:function(b,a){a||(a=b);var d=b[0],c=b[1],e=b[2];b=b[3];var k=d*b-e*c;if(!k)return null;k=1/k;a[0]=b*k;a[1]=-c*k;a[2]=-e*k;a[3]=d*k;return a},multiply:function(b,a,c){c||(c=b);var d=b[0],e=b[1],k=b[2];b=b[3];c[0]=d*a[0]+e*a[2];c[1]=d*a[1]+e*a[3];c[2]=k*a[0]+b*a[2];c[3]=
k*a[1]+b*a[3];return c},rotate:function(b,a,c){c||(c=b);var d=b[0],e=b[1],k=b[2];b=b[3];var n=Math.sin(a);a=Math.cos(a);c[0]=d*a+e*n;c[1]=d*-n+e*a;c[2]=k*a+b*n;c[3]=k*-n+b*a;return c},multiplyVec2:function(b,a,c){c||(c=a);var d=a[0];a=a[1];c[0]=d*b[0]+a*b[1];c[1]=d*b[2]+a*b[3];return c},scale:function(b,a,c){c||(c=b);var d=b[1],e=b[2],k=b[3],n=a[0];a=a[1];c[0]=b[0]*n;c[1]=d*a;c[2]=e*n;c[3]=k*a;return c},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"}};p=p?"":"d";a["glMath"+p]=m;
a["vec2"+p]={create:function(b){var a=new f(2);b?(a[0]=b[0],a[1]=b[1]):(a[0]=0,a[1]=0);return a},createFrom:add:function(b,a,c){c||(c=a);c[0]=b[0]+a[0];c[1]=b[1]+a[1];return c},subtract:function(b,a,c){c||(c=a);c[0]=b[0]-a[0];c[1]=b[1]-a[1];return c},multiply:function(b,a,c){c||(c=a);c[0]=b[0]*a[0];c[1]=b[1]*a[1];return c},divide:function(b,a,c){c||(c=a);c[0]=b[0]/a[0];c[1]=b[1]/a[1];return c},scale:function(b,a,c){c||(c=b);c[0]=b[0]*a;c[1]=b[1]*
a;return c},dist:dist2:set:set2:negate:function(b,a){a||(a=b);a[0]=-b[0];a[1]=-b[1];return a},normalize:function(b,a){a||(a=b);var d=b[0]*b[0]+b[1]*b[1];0<d?(d=Math.sqrt(d),a[0]=b[0]/d,a[1]=b[1]/d):a[0]=a[1]=0;return a},cross:function(b,a,c){b=b[0]*a[1]-b[1]*a[0];if(!c)return b;c[0]=c[1]=0;
c[2]=b;return c},length:dot:direction:function(b,a,c){c||(c=b);var d=b[0]-a[0];b=b[1]-a[1];a=d*d+b*b;if(!a)return c[0]=0,c[1]=0,c[2]=0,c;a=1/Math.sqrt(a);c[0]=d*a;c[1]=b*a;return c},lerp:function(b,a,c,e){e||(e=b);e[0]=b[0]+c*(a[0]-b[0]);e[1]=b[1]+c*(a[1]-b[1]);return e},str:;a["vec3"+p]=e;a["vec4"+p]={create:function(b){var a=new f(4);b?(a[0]=b[0],a[1]=b[1],
a[2]=b[2],a[3]=b[3]):(a[0]=0,a[1]=0,a[2]=0,a[3]=0);return a},createFrom:add:function(b,a,c){c||(c=a);c[0]=b[0]+a[0];c[1]=b[1]+a[1];c[2]=b[2]+a[2];c[3]=b[3]+a[3];return c},subtract:function(b,a,c){c||(c=a);c[0]=b[0]-a[0];c[1]=b[1]-a[1];c[2]=b[2]-a[2];c[3]=b[3]-a[3];return c},multiply:function(b,a,c){c||(c=a);c[0]=b[0]*a[0];c[1]=b[1]*a[1];c[2]=b[2]*a[2];c[3]=b[3]*a[3];return c},divide:function(b,a,c){c||(c=a);c[0]=b[0]/a[0];c[1]=
b[1]/a[1];c[2]=b[2]/a[2];c[3]=b[3]/a[3];return c},scale:function(b,a,c){c||(c=b);c[0]=b[0]*a;c[1]=b[1]*a;c[2]=b[2]*a;c[3]=b[3]*a;return c},dot:set:set4:negate:function(b,a){a||(a=b);a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a},lerp:function(b,a,c,e){e||(e=b);e[0]=b[0]+c*(a[0]-b[0]);e[1]=b[1]+c*(a[1]-b[1]);e[2]=
b[2]+c*(a[2]-b[2]);e[3]=b[3]+c*(a[3]-b[3]);return e},str:;a["mat2"+p]=w;a["mat3"+p]=t;a["mat4"+p]=u;a["quat4"+p]=r});return a})},"esri/geometry/support/jsonUtils":function(){define(["../Point","../Polyline","../Polygon","../Multipoint","../Extent"],function(a,h,p,m,f){function e(e){if(!e)return null;if(e){if(void 0!==e.x&&void 0!==e.y)return a.fromJSON(e);if(void 0!==e.paths)return h.fromJSON(e);if(void 0!==e.rings)return p.fromJSON(e);
if(void 0!==e.points)return m.fromJSON(e);if(void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax)return f.fromJSON(e)}return null}var l={esriGeometryPoint:a,esriGeometryPolyline:h,esriGeometryPolygon:p,esriGeometryEnvelope:f,esriGeometryMultipoint:m};return{fromJSON:e,fromJson:function(a){try{throw Error("fromJson is deprecated, use fromJSON instead");}catch(c){console.warn(c.stack)}return e(a)},getJsonType:getGeometryType:})},"esri/geometry/Polyline":function(){define("dojo/_base/lang ../core/lang ./SpatialReference ./Geometry ./Point ./Extent ./support/zmUtils".split(" "),function(a,h,p,m,f,e,l){var g=m.createSubclass({declaredClass:"esri.geometry.Polyline",type:"polyline",getDefaults:function(a){return{paths:[]}},normalizeCtorArgs:function(a,b){var c=
null,e,g,f=null;a&&!Array.isArray(a)?(c=a.paths?a.paths:null,b||(a.spatialReference?b=a.spatialReference:a.paths||(b=a)),e=a.hasZ,g=a.hasM):c=a;c=c||[];b=b||p.WGS84;c.length&&c[0]&&null!=c[0][0]&&"number"==typeof c[0][0]&&(c=[c]);if(f=c[0]&&c[0][0])void 0===e&&void 0===g?(e=2<f.length,g=!1):void 0===e?e=!g&&3<f.length:void 0===g&&(g=!e&&3<f.length);return{paths:c,spatialReference:b,hasZ:e,hasM:g}},_path:0,properties:{cache:{dependsOn:["hasM","hasZ","paths"]},extent:{dependsOn:["cache"],readOnly:!0,
get:function(){function a(b){return function(a,d){return void 0===a?d:void 0===d?a:b(a,d)}}var b=this.paths,g=b.length;if(!g||!b[0].length)return null;var f,l,m,u,r,n,w,d,k,v,h,p,D=n=b[0][0][0],B=w=b[0][0][1],C,F,K=a(Math.min),M=a(Math.max),E=this.spatialReference,V=[],P,I,J,Q,S,ga,L,R,U=this.hasZ,T=this.hasM,N=U?3:2;for(v=0;v<g;v++){f=b[v];P=I=f[0]&&f[0][0];J=Q=f[0]&&f[0][1];p=f.length;L=R=S=ga=void 0;for(h=0;h<p;h++)l=f[h],m=l[0],u=l[1],D=K(D,m),B=K(B,u),n=M(n,m),w=M(w,u),P=K(P,m),J=K(J,u),I=M(I,
m),Q=M(Q,u),U&&2<l.length&&(r=l[2],C=K(C,r),d=M(d,r),S=K(S,r),ga=M(ga,r)),T&&l.length>N&&(l=l[N],F=K(F,r),k=M(k,r),L=K(L,l),R=M(R,l));V.push(new e({xmin:P,ymin:J,zmin:S,mmin:L,xmax:I,ymax:Q,zmax:ga,mmax:R,spatialReference:E?E.clone():null}))}b=new e({xmin:D,ymin:B,xmax:n,ymax:w,spatialReference:E?E.toJSON():null});U&&(b.zmin=C,b.zmax=d);T&&(b.mmin=F,b.mmax=k);b.cache._partwise=1<V.length?V:null;return b}},paths:null},addPath:function(a){this.clearCache();this._path=this.paths.length;this.paths[this._path]=
[];a.forEach(this._addPoint,this);return this},clone:function(){var c=new g;c.spatialReference=this.spatialReference;c.paths=a.clone(this.paths);c.hasZ=this.hasZ;c.hasM=this.hasM;return c},getPoint:function(a,b){if(this._validateInputs(a,b)){a=this.paths[a][b];b=this.hasZ;var c=this.hasM;return b&&c?new f(a[0],a[1],a[2],a[3],this.spatialReference):b?new f(a[0],a[1],a[2],void 0,this.spatialReference):c?new f(a[0],a[1],void 0,a[2],this.spatialReference):new f(a[0],a[1],this.spatialReference)}},insertPoint:function(a,
b,e){if(this._validateInputs(a)&&h.isDefined(b)&&0<=b&&b<=this.paths[a].length)return this.clearCache(),l.updateSupportFromPoint(this,e),Array.isArray(e)||(e=e.toArray()),this.paths[a].splice(b,0,e),this},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.paths.splice(a,1)[0];var b,c=a.length,e=this.spatialReference;for(b=0;b<c;b++)a[b]=new f(a[b],e);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new f(this.paths[a].splice(b,
1)[0],this.spatialReference)},setPoint:function(a,b,e){if(this._validateInputs(a,b))return this.clearCache(),l.updateSupportFromPoint(this,e),Array.isArray(e)||(e=e.toArray()),this.paths[a][b]=e,this},toJSON:function(){var a=this.spatialReference,a={paths:this.paths,spatialReference:a&&a.toJSON()};this.hasZ&&(a.hasZ=!0);this.hasM&&(a.hasM=!0);return a},_initPathPointsToArray:function(a){for(var b=0;b<a.paths.length;b++)a.paths[b]=a.paths[b].map(function(b){l.updateSupportFromPoint(a,b,!0);Array.isArray(b)||
(a.spatialReference||(a.spatialReference=b.spatialReference),b=b.toArray());return b});return a},_addPoint:function(a){Array.isArray(a)?this.paths[this._path].push(a):this.paths[this._path].push(a.toArray());l.updateSupportFromPoint(this,a)},_insertPoints:function(a,b){this.clearCache();this._path=b;this.paths[this._path]||(this.paths[this._path]=[]);a.forEach(this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)||null!==b&&void 0!==a&&(0>b||
b>=this.paths[a].length)?!1:!0}});return g})},"esri/geometry/support/zmUtils":function(){define([],function(){return{updateSupportFromPoint:function(a,h,p){var m=a.hasZ,f=a.hasM;Array.isArray(h)?4!==h.length||f||m?3===h.length&&p&&!f?(m=!0,f=!1):3===h.length&&f&&m&&(m=f=!1):m=f=!0:(m=!(!m&&h.hasZ&&(!f||h.hasM)),f=!(!f&&h.hasM&&(!m||h.hasZ)));a.hasZ=m;a.hasM=f}}})},"esri/geometry/Polygon":function(){define("dojo/_base/lang ../core/lang ./SpatialReference ./Geometry ./Point ./Extent ./support/coordsUtils ./support/mathUtils ./support/webMercatorUtils".split(" "),
function(a,h,p,m,f,e,l,g,c){var b=function(b){return function(a,c){return null==a?c:null==c?a:b(a,c)}},q=b(Math.min),x=b(Math.max),y=m.createSubclass({declaredClass:"esri.geometry.Polygon",type:"polygon",getDefaults:function(b){return{rings:[]}},normalizeCtorArgs:function(b,a){var c=null,e,g,d=null;b&&!Array.isArray(b)?(c=b.rings?b.rings:null,a||(b.spatialReference?a=b.spatialReference:b.rings||(a=b)),e=b.hasZ,g=b.hasM):c=b;c=c||[];a=a||p.WGS84;c.length&&c[0]&&null!=c[0][0]&&"number"==typeof c[0][0]&&
(c=[c]);if(d=c[0]&&c[0][0])void 0===e&&void 0===g?(e=2<d.length,g=!1):void 0===e?e=!g&&3<d.length:void 0===g&&(g=!e&&3<d.length);return{rings:c,spatialReference:a,hasZ:e,hasM:g}},_ring:0,properties:{cache:{dependsOn:["hasM","hasZ","rings"]},centroid:{readOnly:!0,dependsOn:["cache"],get:function(b){var a=l.centroid([],this.rings,this.hasZ);if(isNaN(a[0])||isNaN(a[1])||this.hasZ&&isNaN(a[2]))return null;b=b||new f;b.x=a[0];b.y=a[1];b.spatialReference=this.spatialReference;this.hasZ&&(b.z=a[2]);return b}},
extent:{dependsOn:["cache"],readOnly:!0,get:function(){var b=this.rings,a=b.length;if(!a||!b[0].length)return null;var c,n,g,d,k,f,l,m,h,p,y,F=k=b[0][0][0],K=f=b[0][0][1],M,E,V=this.spatialReference,P=[],I,J,Q,S,ga,L,R,U,T=this.hasZ,N=this.hasM,Z=T?3:2;for(h=0;h<a;h++){c=b[h];I=J=c[0]&&c[0][0];Q=S=c[0]&&c[0][1];y=c.length;R=U=ga=L=void 0;for(p=0;p<y;p++)n=c[p],g=n[0],d=n[1],F=q(F,g),K=q(K,d),k=x(k,g),f=x(f,d),I=q(I,g),Q=q(Q,d),J=x(J,g),S=x(S,d),T&&2<n.length&&(g=n[2],M=q(M,g),l=x(l,g),ga=q(ga,g),
L=x(L,g)),N&&n.length>Z&&(n=n[Z],E=q(M,n),m=x(l,n),R=q(ga,n),U=x(L,n));P.push(new e({xmin:I,ymin:Q,zmin:ga,mmin:R,xmax:J,ymax:S,zmax:L,mmax:U,spatialReference:V}))}b=new e;b.xmin=F;b.ymin=K;b.xmax=k;b.ymax=f;b.spatialReference=V;T&&(b.zmin=M,b.zmax=l);N&&(b.mmin=E,b.mmax=m);b.cache._partwise=1<P.length?P:null;return b}},isSelfIntersecting:{dependsOn:["cache"],readOnly:!0,get:function(){var b=this.rings,a=b.length,c,e,f,d,k,l,m,q,h;for(d=0;d<a;d++){c=b[d];for(e=0;e<c.length-1;e++)for(l=[[c[e][0],c[e][1]],
[c[e+1][0],c[e+1][1]]],f=d+1;f<a;f++)for(k=0;k<b[f].length-1;k++)if(m=[[b[f][k][0],b[f][k][1]],[b[f][k+1][0],b[f][k+1][1]]],(q=g._getLineIntersection2(l,m))&&!(q[0]===l[0][0]&&q[1]===l[0][1]||q[0]===m[0][0]&&q[1]===m[0][1]||q[0]===l[1][0]&&q[1]===l[1][1]||q[0]===m[1][0]&&q[1]===m[1][1]))return!0;k=c.length;if(!(4>=k))for(e=0;e<k-3;e++)for(h=k-1,0===e&&(h=k-2),l=[[c[e][0],c[e][1]],[c[e+1][0],c[e+1][1]]],f=e+2;f<h;f++)if(m=[[c[f][0],c[f][1]],[c[f+1][0],c[f+1][1]]],(q=g._getLineIntersection2(l,m))&&
!(q[0]===l[0][0]&&q[1]===l[0][1]||q[0]===m[0][0]&&q[1]===m[0][1]||q[0]===l[1][0]&&q[1]===l[1][1]||q[0]===m[1][0]&&q[1]===m[1][1]))return!0}return!1}},rings:null},addRing:function(b){if(b){this.clearCache();var a=this.rings,c=a.length;if(Array.isArray(b[0]))a[c]=b.concat();else{var e=[];a[c]=e;a=0;for(c=b.length;a<c;a++)e[a]=b[a].toArray()}return this}},clone:function(){var b=new y;b.spatialReference=this.spatialReference;b.rings=a.clone(this.rings);b.hasZ=this.hasZ;b.hasM=this.hasM;return b},contains:function(b){if(!b)return!1;
c.canProject(b,this.spatialReference)&&(b=c.project(b,this.spatialReference));return l.contains(this.rings,l.fromGeom(b))},isClockwise:function(b){var a=0,c=0,e=0,g,d=b.length,k,f,l,m=this.hasZ,q=this.hasM;for(g=0;g<d;g++)k=b[g],f=b[(g+1)%d],Array.isArray(k)?(a+=k[0]*f[1]-f[0]*k[1],l=2,2<k.length&&2<f.length&&m&&(c+=k[0]*f[2]-f[0]*k[2],l=3),k.length>l&&f.length>l&&q&&(e+=k[0]*f[l]-f[0]*k[l])):(a+=k.x*f.y-f.x*k.y,k.hasZ&&f.hasZ&&(c+=k.x*f.z-f.x*k.z),k.hasM&&f.hasM&&(e+=k.x*f.m-f.x*k.m));return 0>=
a&&0>=c&&0>=e},getPoint:function(b,a){if(this._validateInputs(b,a)){b=this.rings[b][a];a=this.hasZ;var c=this.hasM;return a&&!c?new f(b[0],b[1],b[2],void 0,this.spatialReference):c&&a?new f(b[0],b[1],void 0,b[2],this.spatialReference):a&&c?new f(b[0],b[1],b[2],b[3],this.spatialReference):new f(b[0],b[1],this.spatialReference)}},insertPoint:function(b,a,c){if(this._validateInputs(b)&&h.isDefined(a)&&0<=a&&a<=this.rings[b].length)return this.clearCache(),this.rings[b].splice(a,0,c),this},removePoint:removeRing:setPoint:function(b,a,c){if(this._validateInputs(b,a))return this.clearCache(),Array.isArray(c)||(c=c.toArray()),this.rings[b][a]=c,this},toJSON:function(){var b=this.spatialReference,b={rings:this.rings,
spatialReference:b&&b.toJSON()};this.hasZ&&(b.hasZ=!0);this.hasM&&(b.hasM=!0);return b},_insertPoints:function(b,a){this.clearCache();this._ring=a;this.rings[this._ring]||(this.rings[this._ring]=[]);b.forEach(this._addPoint,this)},_validateInputs:);y.createEllipse=function(b){var a=b.center.x,c=b.center.y,e=b.center.z,g=b.center.m,d=b.longAxis,k=b.shortAxis,f=b.numberOfPoints;
b=b.map;var l,m,q,t=[],h=2*Math.PI/f;for(m=0;m<f;m++)l=Math.cos(m*h),q=Math.sin(m*h),l=b.toMap({x:d*l+a,y:k*q+c}),null==e||l.hasZ||(l.z=e),null==g||l.hasM||(l.m=g),t.push(l);t.push(t[0]);return new y({rings:[t],spatialReference:b.spatialReference})};y.createCircle=y.fromExtent=function(b){var a=b.clone().normalize();b=b.spatialReference;var c=!1,e=!1;a.map(function(b){b.hasZ&&
(c=!0);b.hasM&&(e=!0)});a={rings:a.map(function(b){var a=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(c&&b.hasZ)for(var k=(b.zmax-b.zmin)/2,n=0;n<a.length;n++)a[n].push(k);if(e&&b.hasM)for(b=(b.mmax-b.mmin)/2,n=0;n<a.length;n++)a[n].push(b);return a}),spatialReference:b?b.toJSON():null};c&&(a.hasZ=!0);e&&(a.hasM=!0);return new y(a)};return y})},"esri/geometry/support/coordsUtils":function(){define([],function(){var a=function(a,f,e){var l=e[0];e=e[1];for(var g=
0,c,b,m,h,p=0,t=f.length;p<t;p++)g++,g===t&&(g=0),c=f[p][0],b=f[g][0],m=f[p][1],h=f[g][1],(m<e&&h>=e||h<e&&m>=e)&&c+(e-m)/(h-m)*(b-c)<l&&(a=!a);return a},h=function(a,f,e){for(var l=0,g=0,c=0,b,m,h,p,t,u,r,n,w,d=0,k=0,v=0,A=f.length-1;v<A;v++)b=f[v],m=b[0],h=b[1],p=b[2],t=f[v+1],u=t[0],r=t[1],n=t[2],w=m*r-u*h,d+=w,l+=(m+u)*w,g+=(h+r)*w,e&&2<b.length&&2<t.length&&(w=m*n-u*p,c+=(p+n)*w,k+=w);0<d&&(d*=-1);0<k&&(k*=-1);d?(a[0]=l,a[1]=g,a[2]=.5*d,e?(a[3]=c,a[4]=.5*k):a.length=3):a.length=0;return a},p=
function(a,f){for(var e=0,l=0,g=0,c=0,b=f?[0,0,0]:[0,0],m=f?[0,0,0]:[0,0],h,p,t,u=0,r=a.length;u<r-1;u++)if(h=a[u],p=a[u+1],h&&p){b[0]=h[0];b[0]=h[1];m[0]=p[0];m[0]=p[1];f&&2<h.length&&2<p.length&&(b[2]=h[2],m[2]=p[2]);t=m[0]-b[0];var n=m[1]-b[1],w=0;1<b.length&&1<m.length&&(w=b[2]-m[2]);if(t=Math.sqrt(t*t+n*n+w*w))e+=t,n=h[0]+.5*(p[0]-h[0]),w=h[1]+.5*(p[1]-h[1]),h=2<h.length&&2<p.length?[n,w,h[2]+.5*(p[2]-h[2])]:[n,w],l+=t*h[0],g+=t*h[1],f&&2<h.length&&(c+=t*h[2])}return 0<e?f?[l/e,g/e,c/e]:[l/e,
g/e]:a.length?a[0]:null};return{fromGeom:function(a){if(!a)return null;if(Array.isArray(a))return a;var f=a.hasZ,e=a.hasM;if("point"===a.type)return e&&f?[a.x,a.y,a.z,a.m]:f?[a.x,a.y,a.z]:e?[a.x,a.y,a.m]:[a.x,a.y];if("polygon"===a.type)return a.rings.slice(0);if("polyline"===a.type)return a.path.slice(0);if("multipoint"===a.type)return a.points.slice(0);if("extent"===a.type){a=a.clone().normalize();if(!a)return null;f=e=!1;a.map(function(a){a.hasZ&&(f=!0);a.hasM&&(e=!0)});return a.map(function(a){var g=
[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(f&&a.hasZ)for(var c=.5*(a.zmax-a.zmin),b=0;b<g.length;b++)g[b].push(c);if(e&&a.hasM)for(a=.5*(a.mmax-a.mmin),b=0;b<g.length;b++)g[b].push(a);return g})}return null},contains:function(m,f){if(!m)return!1;if(!Array.isArray(m[0][0]))return a(!1,m,f);for(var e=!1,l=0,g=m.length;l<g;l++)e=a(e,m[l],f);return e},centroid:function(a,f,e){for(var l=[],g,c=0,b=f.length;c<b;c++)g=h([],f[c],e),g.length&&l.push(g);l.sort(function(b,
a){var c=b[2]-a[2];0===c&&e&&(c=b[4]-a[4]);return c});a.length=e?3:2;if(l.length)f=6*l[0][2],a[0]=l[0][0]/f,a[1]=l[0][1]/f,e&&(a[2]=l[0][3]/(6*l[0][4]));else if(l=f[0]&&f[0].length?p(f[0]):null)a[0]=l[0],a[1]=l[1],e&&2<l.length&&(a[2]=l[2]);return a},isClockwise:function(a){for(var f=0,e=0,l=e+1,g=a.length;e<g;e++,l+=1%g)f+=a[e][0]*a[l][1]-a[l][0]*a[e][1];return 0>=.5*f}}})},"esri/geometry/Multipoint":function(){define("dojo/_base/lang ./SpatialReference ./Geometry ./Point ./Extent ./support/zmUtils".split(" "),
function(a,h,p,m,f,e){var l=p.createSubclass({declaredClass:"esri.geometry.Multipoint",type:"multipoint",getDefaults:normalizeCtorArgs:function(a,c){var b=null,e,g,f=null;a&&!Array.isArray(a)?a.wkid?c=a:(b=a.points||null,c=a.spatialReference||null,e=a.hasZ,g=a.hasM):b=a;b=b||[];c=c||h.WGS84;if(f=b[0])void 0===e&&void 0===g?(e=2<f.length,g=!1):void 0===e?e=3<f.length:void 0===g&&(g=3<f.length);return{points:b,spatialReference:c,hasZ:e,hasM:g}},properties:{cache:{dependsOn:["points",
"hasZ","hasM"]},extent:{dependsOn:["cache"],get:function(a){function c(b){return function(a,d){return null==a?d:null==d?a:b(a,d)}}if(!this.points.length)return null;a=a||new f;var b=this.points,e=this.hasZ,g=this.hasM,l=b[0],m=c(Math.min),h=c(Math.max),r=k=l[0],n=v=l[1],w,d,k,v,p,z,D,B,C,F,K=e?3:2;C=0;for(F=b.length;C<F;C++)l=b[C],D=l[0],B=l[1],r=m(r,D),n=m(n,B),k=h(k,D),v=h(v,B),e&&2<l.length&&(D=l[2],w=m(w,D),p=h(p,D)),g&&l.length>K&&(l=l[K],d=m(d,l),z=h(z,l));a.xmin=r;a.ymin=n;a.xmax=k;a.ymax=
v;a.spatialReference=this.spatialReference;e?(a.zmin=w,a.zmax=p):(a.zmin=null,a.zmax=null);g?(a.mmin=d,a.mmax=z):(a.mmin=null,a.mmax=null);return a}},points:null},addPoint:function(a){this.clearCache();e.updateSupportFromPoint(this,a);Array.isArray(a)?this.points.push(a):this.points.push(a.toArray());return this},clone:function(){var e={points:a.clone(this.points),spatialReference:this.spatialReference};this.hasZ&&(e.hasZ=!0);this.hasM&&(e.hasM=!0);return new l(e)},getPoint:function(a){if(this._validateInputs(a)){a=
this.points[a];var c,b,e=2;this.hasZ&&(c=a[2],e=3);this.hasM&&(b=a[e]);return new m({x:a[0],y:a[1],z:c,m:b,spatialReference:this.spatialReference})}},removePoint:setPoint:function(a,c){if(this._validateInputs(a))return this.clearCache(),e.updateSupportFromPoint(c),this.points[a]=c.toArray(),this},toJSON:function(){var e=this.spatialReference,e={points:a.clone(this.points),spatialReference:e&&
e.toJSON()};this.hasZ&&(e.hasZ=!0);this.hasM&&(e.hasM=!0);return e},_pointsToArrays:function(a){for(var c=0;c<a.points.length;c++){var b=a.points[c];e.updateSupportFromPoint(a,b,!0);Array.isArray(b)||(a.spatialReference||(a.spatialReference=b.spatialReference),a.points[c]=b.toArray())}return a},_validateInputs:function(a){return null!=a&&0<=a&&a<this.points.length}});return l})},"esri/layers/graphics/controllers/AutoController2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/requireUtils ../../../Graphic ../../../core/Accessor ../../../core/Collection ../../../core/Promise ../../../tasks/QueryTask ../../../tasks/support/StatisticDefinition".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x){var y;((y||(y={}));h=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.controllerModulePaths=(c={},c[y.Snapshot]="./SnapshotController",c[y.OnDemand]="./OnDemandController2D",c);a.maxPointCountForAuto=4E3;a.maxRecordCountForAuto=2E3;a.maxVertexCountForAuto=25E4;return a;var c}p(c,b);c.prototype.initialize=function(){var b=this,a=this.layer.then(.then(;this.addResolvingPromise(a)};c.prototype.destroy=function(){this.activeController&&(this.activeController.destroy(),this._set("activeController",null))};Object.defineProperty(c.prototype,"countThresholdForAuto",{get:function(){var b=this.layer.geometryType,a;"polyline"===b||"polygon"===b||"multipoint"===b?a=this.maxRecordCountForAuto:"point"===b&&(a=this.maxPointCountForAuto);return a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"updating",{get:function(){return!1===this.isFulfilled()||
!0===this.get("activeController.updating")},enumerable:!0,configurable:!0});c.prototype._figureOutMode=c.prototype._isStatisticsSupported=function(){return/(https?:)?\/\/services.*\.arcgis\.com/i.test(this.layer.source.parsedUrl.path)};c.prototype._checkByStatistics=function(){var b=this,a=this.layer,c=a.source.parsedUrl.path,a=a.createQuery();a.outStatistics=[new x({statisticType:"exceedslimit",maxPointCount:this.maxPointCountForAuto,
maxRecordCount:this.maxRecordCountForAuto,maxVertexCount:this.maxVertexCountForAuto,outStatisticFieldName:"exceedslimit"})];return(new q({url:c+"/query"})).execute(a).then(function(a){a=a&&a.features&&a.features[0];if(0===(a&&a.attributes&&a.attributes.exceedslimit)){a=b.layer;var d=a.maxRecordCount;if(a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsPagination||d>=b.countThresholdForAuto)return y.Snapshot}return y.OnDemand})};c.prototype._checkByCount=function(){var b=this,a=this.layer;
return(new q({url:a.source.parsedUrl.path+"/query"})).executeForCount(a.createQuery()).then(function(c){return c<=b.countThresholdForAuto&&c<=a.maxRecordCount?y.Snapshot:y.OnDemand})};c.prototype._createController=function(b){var c=this;return e.when(a,this.controllerModulePaths[b]).then(.otherwise(function(a){throw Error("Module path not found for controller type: "+(b===y.Snapshot?"snapshot":"on demand"));})};return c}(f.declared(g,
b));m([f.property()],h.prototype,"activeController",void 0);m([f.property({dependsOn:["layer.geometryType"]})],h.prototype,"countThresholdForAuto",null);m([f.property()],h.prototype,"controllerModulePaths",void 0);m([f.property({type:c.ofType(l)})],h.prototype,"graphics",void 0);m([f.property()],h.prototype,"layer",void 0);m([f.property()],h.prototype,"layerView",void 0);m([f.property({dependsOn:["activeController.updating"]})],h.prototype,"updating",null);m([f.aliasOf("activeController.update")],
h.prototype,"update",void 0);return h=m([f.subclass("esri.layers.graphics.controllers.AutoController2D")],h)})},"esri/Graphic":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators dojo/_base/lang ./core/lang ./core/JSONSupport ./PopupTemplate ./geometry/support/jsonUtils ./symbols/support/jsonUtils".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){var x=0;a=y=function(b){function a(a,c,e,d){a=b.call(this,a,c,e,d)||this;
a.layer=null;a.popupTemplate=null;Object.defineProperty(a,"uid",{value:x++});return a}p(a,b);a.prototype.normalizeCtorArgs=function(b,a,c,d){return b&&!b.declaredClass?b:{geometry:b,symbol:a,attributes:c,popupTemplate:d}};Object.defineProperty(a.prototype,"attributes",{set:function(b){var a=this._get("attributes");a!==b&&(this._set("attributes",b),this._notifyLayer("attributes",a,b))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometry",{set:function(b){var a=this._get("geometry");
a!==b&&(this._set("geometry",b),this._notifyLayer("geometry",a,b))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"symbol",{set:function(b){var a=this._get("symbol");a!==b&&(this._set("symbol",b),this._notifyLayer("symbol",a,b))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visible",{set:function(b){var a=this._get("visible");a!==b&&(this._set("visible",b),this._notifyLayer("visible",a,b))},enumerable:!0,configurable:!0});a.prototype.getAttribute=a.prototype.setAttribute=function(b,a){if(this.attributes){var c=this.getAttribute(b);this.attributes[b]=a;this._notifyLayer("attributes",c,a,b)}else this.attributes=(c={},c[b]=a,c),this._notifyLayer("attributes",void 0,a,b)};a.prototype.getEffectivePopupTemplate=a.prototype.toJSON=function(){return{geometry:this.geometry&&this.geometry.toJSON(),symbol:this.symbol&&this.symbol.toJSON(),attributes:e.mixin({},
this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}};a.prototype.clone=function(){return new y({attributes:l.clone(this.attributes),geometry:this.geometry&&this.geometry.clone()||null,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),symbol:this.symbol&&this.symbol.clone()||null,visible:this.visible})};a.prototype._notifyLayer=function(b,a,c,d){this.layer&&(b={graphic:this,property:b,oldValue:a,newValue:c},d&&(b.attributeName=d),this.layer.graphicChanged(b))};
return a}(f.declared(g));m([f.property({value:null})],a.prototype,"attributes",null);m([f.property({value:null,json:{read:b.fromJSON}})],a.prototype,"geometry",null);m([f.property()],a.prototype,"layer",void 0);m([f.property({type:c})],a.prototype,"popupTemplate",void 0);m([f.property({value:null,json:{read:q.read}})],a.prototype,"symbol",null);m([f.property({value:!0,set:function(b){}})],a.prototype,"visible",null);a=y=m([f.subclass("esri.Graphic")],a);var y;return a})},"esri/PopupTemplate":function(){define(["./core/JSONSupport",
"./core/kebabDictionary","./core/Collection","./core/lang","./support/Action"],function(a,h,p,m,f){var e=h({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),l=h({shortDate:"short-date",shortDateLE:"short-date-le",longDate:"long-date",dayShortMonthYear:"day-short-month-year",longMonthDayYear:"long-month-day-year",shortDateLongTime:"short-date-long-time",shortDateLELongTime:"short-date-le-long-time",shortDateShortTime:"short-date-short-time",shortDateLEShortTime:"short-date-le-short-time",
shortDateShortTime24:"short-date-short-time-24",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLongTime24:"short-date-long-time-24",shortDateLELongTime24:"short-date-le-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year"}),g=h({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"}),c=a.createSubclass({properties:{actions:{type:p.ofType(f)},content:{value:null,json:{read:{source:["description","popupElements","mediaInfos",
"showAttachments"]}}},fieldInfos:{value:null},overwriteActions:{value:!1},title:{value:""},relatedRecordsInfo:{value:null}},declaredClass:"esri.PopupTemplate",actions:null,content:"",fieldInfos:null,_fieldInfosReader:function(b){return this._readFieldInfos(b)},overwriteActions:!1,title:"",relatedRecordsInfo:null,_relatedRecordsInfoReader:_dateFormatKebabDict:l,clone:function(){var b=this.actions;b&&(b=m.clone(b.toArray()));return new c({actions:b||[],content:Array.isArray(this.content)?
m.clone(this.content):this.content,fieldInfos:this.fieldInfos?m.clone(this.fieldInfos):null,overwriteActions:this.overwriteActions,relatedRecordsInfo:this.relatedRecordsInfo?m.clone(this.relatedRecordsInfo):null,title:this.title})},toJSON:function(){var b={showAttachments:!1,title:this.title};this.fieldInfos&&(b.fieldInfos=this._writeFieldInfos(m.clone(this.fieldInfos)));this.relatedRecordsInfo&&(b.relatedRecordsInfo=m.clone(this.relatedRecordsInfo));var a=this.content;"string"===typeof a?b.description=
a:Array.isArray(a)&&(b.popupElements=m.clone(a),b.popupElements.forEach(function(a){"attachments"!==a.type||b.showAttachments?"media"!==a.type||b.mediaInfos?"text"!==a.type||b.description?"fields"!==a.type||b.fieldInfos||(a.fieldInfos&&(b.fieldInfos=this._writeFieldInfos(m.clone(a.fieldInfos))),delete a.fieldInfos):(a.text&&(b.description=a.text),delete a.text):(a.mediaInfos&&(b.mediaInfos=m.clone(a.mediaInfos),b.mediaInfos.forEach(function(b){b.type=g.toJSON(b.type)})),delete a.mediaInfos):b.showAttachments=
!0;return a}.bind(this)));return b},_contentReader:function(b,a){b=a.description;var c=[],e=a.popupElements;e&&e.length?c=e.map(function(b){"text"!==b.type||b.text?"media"===b.type&&(b.mediaInfos||a.mediaInfos)&&(b.mediaInfos||(b.mediaInfos=a.mediaInfos),b.mediaInfos=this._readMediaInfos(b.mediaInfos)):b.text=a.description;return b}.bind(this)):(a.description?c.push({type:"text",text:a.description}):c.push({type:"fields"}),a.mediaInfos&&a.mediaInfos.length&&c.push({type:"media",mediaInfos:this._readMediaInfos(a.mediaInfos)}),
a.showAttachments&&c.push({type:"attachments",displayType:"list"}));c.length&&(b=c);return b},_readFieldInfos:function(b){b&&b.forEach(function(b){var a=b.format&&b.format.dateFormat,c=b.stringFieldOption;a&&(b.format.dateFormat=l.fromJSON(a));c&&(b.stringFieldOption=e.fromJSON(c))});return b},_writeFieldInfos:function(b){b.forEach(function(b){var a=b.format&&b.format.dateFormat,c=b.stringFieldOption;a&&(b.format.dateFormat=l.toJSON(a));c&&(b.stringFieldOption=e.toJSON(c));b.format||delete b.format});
return b},_readMediaInfos:function(b){b.forEach(function(b){b.type=g.fromJSON(b.type)});return b}});return c})},"esri/support/Action":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/Identifiable ../core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e,l){a=g=function(a){function b(b){b=a.call(this)||this;b.className="";b.temporary=!1;b.image="";b.id="";b.title="";b.visible=!0;return b}p(b,a);b.prototype.clone=
return b}(l.declared(f,e));m([l.property()],a.prototype,"className",void 0);m([l.property()],a.prototype,"temporary",void 0);m([l.property()],a.prototype,"image",void 0);m([l.property()],a.prototype,"id",void 0);m([l.property()],a.prototype,"title",void 0);m([l.property()],a.prototype,"visible",void 0);a=g=m([l.subclass("esri.support.Action")],a);var g;return a})},"esri/symbols/support/jsonUtils":function(){define("require exports ../../core/Error ../../core/Warning ../Symbol3D ../SimpleLineSymbol ../SimpleMarkerSymbol ../PictureMarkerSymbol ../PictureFillSymbol ../SimpleFillSymbol ../TextSymbol ../PointSymbol3D ../LineSymbol3D ../PolygonSymbol3D ../MeshSymbol3D ../LabelSymbol3D ../WebStyleSymbol ./symbolConversion".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w){var d={esriSMS:l,esriPMS:g,esriTS:q,esriSLS:e,esriSFS:b,esriPFS:c,PointSymbol3D:x,LineSymbol3D:y,PolygonSymbol3D:t,MeshSymbol3D:u,LabelSymbol3D:r,styleSymbolReference:n};h.read=function(b,a,c){if(a=b?d[b.type]||null:null)return a=new a,a.read(b,c),a;c&&c.messages&&b&&c.messages.push(new m("symbol:unsupported","Symbols of type '"+(b.type||"unknown")+"' are not supported",{definition:b,context:c}));return null};h.write=function(b,a,d){if(!b)return null;
if(!d||"web-scene"!==d.origin||b.isInstanceOf(f)||b.isInstanceOf(n))return b.write(a,d);var c=w.to3D(b);if(c.symbol)return c.symbol.write(a,d);d.messages&&d.messages.push(new p("symbol:unsupported","Symbols of type '"+b.declaredClass+"' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView",{symbol:b,context:d,error:c.error}));return null};h.fromJSON=function(b,a){var c=b?d[b.type]||null:null;return c?c.fromJSON(b,a):null}})},"esri/symbols/Symbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/Logger ../core/collectionUtils ../core/Warning ../core/urlUtils ./Symbol ./Symbol3DLayer ./IconSymbol3DLayer ./ObjectSymbol3DLayer ./LineSymbol3DLayer ./PathSymbol3DLayer ./FillSymbol3DLayer ./ExtrudeSymbol3DLayer ./TextSymbol3DLayer ./support/Thumbnail ./support/StyleOrigin ../portal/Portal ../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v,A){var z={Icon:x,Object:y,Line:t,Path:u,Fill:r,Extrude:n,Text:w},D=f.ofType(q),B=e.getLogger("esri.symbols.Symbol3D");a=function(b){function a(a){a=b.call(this)||this;a.styleOrigin=null;a.thumbnail=null;a.type=null;a._set("symbolLayers",a._createSymbolLayersCollection());return a}p(a,b);Object.defineProperty(a.prototype,"symbolLayers",{set:function(b){var a=this._get("symbolLayers");a?(a.removeAll(),a.addMany(b)):(a=this._createSymbolLayersCollection(b),
this._set("symbolLayers",a))},enumerable:!0,configurable:!0});a.prototype.readSymbolLayers=function(b,a,d){a=this._createSymbolLayersCollection();for(var c=0;c<b.length;c++){var e=b[c],k=e.type,n=z[k];n?(e=new n,e.read(b[c],d),a.add(e)):(B.warn("Unknown symbol layer type: "+k),d&&d.messages&&d.messages.push(new g("symbol-layer:unsupported","Symbol layers of type '"+(k||"unknown")+"' are not supported",{definition:e,context:d})))}return a};a.prototype.readStyleOrigin=function(b,a,d){if(b.styleUrl&&
b.name)return a=c.read(b.styleUrl,d),new k({styleUrl:a,name:b.name});if(b.styleName&&b.name)return new k({portal:d&&d.portal||v.getDefault(),styleName:b.styleName,name:b.name});d&&d.messages&&d.messages.push(new g("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:d,definition:b}))};a.prototype.writeStyleOrigin=function(b,a,d,e){b.styleUrl&&b.name?(d=c.write(b.styleUrl,e),a.styleOrigin={styleUrl:d,name:b.name}):b.styleName&&
b.name&&(b.portal&&e&&e.portal&&!c.hasSamePortal(b.portal.restUrl,e.portal.restUrl)?e&&e.messages&&e.messages.push(new g("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):a.styleOrigin={styleName:b.styleName,name:b.name})};a.prototype.normalizeCtorArgs=function(b){return b instanceof q?{symbolLayers:this._createSymbolLayersCollection([b])}:Array.isArray(b)?{symbolLayers:this._createSymbolLayersCollection(b)}:
b};a.prototype._createSymbolLayersCollection=function(b){var a=this;b=new D(b);b.on("before-add",function(b){return a._onSymbolLayersBeforeAdd(b)});return b};a.prototype._onSymbolLayersBeforeAdd=function(b){0>this._allowedLayerTypes.indexOf(b.item.type)&&(B.error("Symbol layer of type '"+b.item.type+"' is not allowed for symbol of type '"+this.type+"'"),b.preventDefault())};return a}(A.declared(b));m([A.property({json:{write:!1}})],a.prototype,"color",void 0);m([A.property({type:D,json:{write:!0}}),
A.cast(l.castForReferenceSetter)],a.prototype,"symbolLayers",null);m([A.reader("symbolLayers")],a.prototype,"readSymbolLayers",null);m([A.property({type:k})],a.prototype,"styleOrigin",void 0);m([A.reader("styleOrigin")],a.prototype,"readStyleOrigin",null);m([A.writer("styleOrigin")],a.prototype,"writeStyleOrigin",null);m([A.property({type:d.default,json:{read:!1}})],a.prototype,"thumbnail",void 0);m([A.property({type:String,readOnly:!0,json:{read:!1}})],a.prototype,"type",void 0);return a=m([A.subclass("esri.symbols.Symbol3D")],
a)})},"esri/symbols/Symbol":function(){define(["../core/lang","../core/kebabDictionary","../core/JSONSupport","../Color"],function(a,h,p,m){var f=h({esriSMS:"simple-marker-symbol",esriPMS:"picture-marker-symbol",esriSLS:"simple-line-symbol",esriSFS:"simple-fill-symbol",esriPFS:"picture-fill-symbol",esriTS:"text-symbol",esriSHD:"shield-label-symbol",PointSymbol3D:"point-symbol-3d",LineSymbol3D:"line-symbol-3d",PolygonSymbol3D:"polygon-symbol-3d",MeshSymbol3D:"mesh-symbol-3d",LabelSymbol3D:"label-symbol-3d"}),
e=0;return p.createSubclass({declaredClass:"esri.symbols.Symbol",constructor:properties:{type:{type:String,value:null,json:{read:f.fromJSON,write:{ignoreOrigin:!0,writer:function(a,e){e.type=f.toJSON(this.type)}}}},color:{type:m,value:new m([0,0,0,1]),json:{read:function(e){return e&&a.isDefined(e[0])?[e[0],e[1],e[2],e[3]/255]:e},write:!0}}}})})},"esri/Color":function(){define(["./core/declare","dojo/colors"],function(a,h){var p=a([h],{declaredClass:"esri.Color",toJSON:function(){return[this.r,
this.g,this.b,1<this.a?this.a:Math.round(255*this.a)]},clone:function(){return new p(this.toRgba())}});p.toJSON=p.fromJSON=p.toUnitRGB=p.toUnitRGBA=function(a){return[a.r/255,a.g/255,a.b/255,a.a||1]};var m="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(a=0;a<m.length;a++)p[m[a]]=h[m[a]];p.named.rebeccapurple=
[102,51,153];return p})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(a,h,p,m){var f={};h.setObject("dojo.colors",f);var e=a.colorFromRgb=p.fromRgb=function(a,c){var b=a.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(b){a=b[2].split(/\s*,\s*/);var g=a.length,b=b[1];if("rgb"==b&&3==g||"rgba"==b&&4==g)return b=a[0],"%"==b.charAt(b.length-
1)?(b=m.map(a,,4==g&&(b[3]=a[3]),p.fromArray(b,c)):p.fromArray(a,c);if("hsl"==b&&3==g||"hsla"==b&&4==g){var b=(parseFloat(a[0])%360+360)%360/360,f=parseFloat(a[1])/100,l=parseFloat(a[2])/100,f=.5>=l?l*(f+1):l+f-l*f,l=2*l-f,b=[256*e(l,f,b+1/3),256*e(l,f,b),256*e(l,f,b-1/3),1];4==g&&(b[3]=a[3]);return p.fromArray(b,c)}}return null};var l=p.prototype.sanitize=f.makeGrey=p.makeGrey=h.mixin(p.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,
80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,
206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,
240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,
0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,
232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,
250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return p})},"esri/symbols/Symbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/JSONSupport ./support/Symbol3DMaterial ../core/accessorSupport/decorators".split(" "),function(a,h,p,
m,f,e,l,g){a=function(a){function b(b){b=a.call(this)||this;b.enabled=!0;b.material=null;b.type=null;return b}p(b,a);b.prototype.writeEnabled=b.prototype.readElevationInfo=function(b){return f.clone(b)};b.prototype.writeElevationInfo=function(b,a){a.elevationInfo=f.clone(b)};return b}(g.declared(e));m([g.property()],a.prototype,"enabled",void 0);m([g.writer("enabled")],a.prototype,"writeEnabled",null);m([g.property()],a.prototype,"elevationInfo",void 0);m([g.reader("elevationInfo")],
a.prototype,"readElevationInfo",null);m([g.writer("elevationInfo")],a.prototype,"writeElevationInfo",null);m([g.property({type:l.default,json:{write:!0}})],a.prototype,"material",void 0);m([g.property({type:String,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],a.prototype,"type",void 0);return a=m([g.subclass("esri.symbols.Symbol3DLayer")],a)})},"esri/symbols/support/Symbol3DMaterial":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/JSONSupport ../../Color ./materialUtils ../../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l,g,c){=q=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}p(c,a);c.prototype.readColor=function(b,a){a=null!=a.transparency?g.transparencyToOpacity(a.transparency):1;if(b&&f.isDefined(b[0]))return[b[0],b[1],b[2],a]};c.prototype.writeColor=function(a,c){c.color=[b(a.r),b(a.g),b(a.b)];a=g.opacityToTransparency(a.a);0!==a&&(c.transparency=a)};c.prototype.clone=function(){return new q({color:this.color?
this.color.clone():null,colorMixMode:this.colorMixMode})};return c}(c.declared(e));m([c.property({type:l})],a.prototype,"color",void 0);m([c.reader("color",["color","transparency"])],a.prototype,"readColor",null);m([c.writer("color")],a.prototype,"writeColor",null);m([c.property({type:String,json:{read:!1,write:!1}})],a.prototype,"colorMixMode",void 0);a=q=m([c.subclass("esri.symbols.support.Symbol3DMaterial")],a);h.Symbol3DMaterial=a;Object.defineProperty(h,"__esModule",{value:!0});h.default=a;var q})},
"esri/symbols/support/materialUtils":function(){define(["require","exports"],function(a,h){h.opacityToTransparency=function(a){return Math.max(0,Math.min(Math.round(100*(1-a)),100))};h.transparencyToOpacity=function(a){return Math.max(0,Math.min(1-a/100,1))}})},"esri/symbols/IconSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../request ../core/kebabDictionary ../core/promiseUtils ../core/screenUtils ../core/urlUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/Symbol3DOutline ./support/Symbol3DMaterial ./support/Symbol3DResource ../views/3d/layers/graphics/Graphics3DIconSymbolLayer".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u){var r=e({topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right"});a=n=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}p(a,b);a.prototype.readHref=function(b,a,d){return b?c.read(b,d):a.dataURI};a.prototype.writeHref=function(b,a,d,e){b&&(c.isDataProtocol(b)?a.dataURI=b:a.href=c.write(b,e))};a.prototype.clone=function(){return new n({href:this.href,primitive:this.primitive})};return a}(b.declared(t.default));
m([b.property({json:{write:!0,read:{source:["href","dataURI"]}}})],a.prototype,"href",void 0);m([b.reader("href")],a.prototype,"readHref",null);m([b.writer("href")],a.prototype,"writeHref",null);a=n=m([b.subclass("esri.symbols.support.IconSymbol3DLayerResource")],a);q=w=function(b){function a(a){a=b.call(this)||this;a.material=null;a.resource=null;a.type="Icon";a.size=void 0;a.anchor=void 0;a.outline=void 0;return a}p(a,b);a.prototype.readAnchor=function(b){return r.fromJSON(b)};a.prototype.writeAnchor=
function(b,a){a.anchor=r.toJSON(b)};a.prototype.computeResourceSize=function(){if(this.resource.href)return this._fetchImage().then(;if(this.resource.primitive)return l.resolve(u.PRIMITIVE_SIZE)};a.prototype.computeSize=function(){var b=this;return this.computeResourceSize().then(function(a){if(null==b.size)return a;a=a[0]/a[1];return 1<a?[b.size,b.size/a]:[b.size*a,b.size]})};a.prototype.clone=function(){return new w({anchor:this.anchor,enabled:this.enabled,
material:this.material&&this.material.clone(),outline:this.outline&&this.outline.clone(),resource:this.resource&&this.resource.clone(),size:this.size})};a.prototype._fetchImage=function(){return f(this.resource.href,{responseType:"image"}).then(function(b){return b.data})};return a}(b.declared(q));m([b.property({type:y.default})],q.prototype,"material",void 0);m([b.property({type:a,json:{write:!0}})],q.prototype,"resource",void 0);m([b.property()],q.prototype,"type",void 0);m([b.property({json:{write:!0}}),
b.cast(g.toPt)],q.prototype,"size",void 0);m([b.property({type:String})],q.prototype,"anchor",void 0);m([b.reader("anchor")],q.prototype,"readAnchor",null);m([b.writer("anchor")],q.prototype,"writeAnchor",null);m([b.property({type:x.default,json:{write:!0}})],q.prototype,"outline",void 0);q=w=m([b.subclass("esri.symbols.IconSymbol3DLayer")],q);var n,w;return q})},"esri/core/screenUtils":function(){define(["require","exports"],function(a,h){ar m=/^(\d+(\.\d+)?)\s*((px)|(pt))?$/i;
h.DPI=96;h.pt2px=h.px2pt=p;h.toPt=function(a){if("string"===typeof a){if(m.test(a)){a=a.match(m);var e=Number(a[1]);return"px"===(a[3]&&a[3].toLowerCase())?p(e):e}console.warn("screenUtils.toPt: input not recognized!");return null}return a}})},"esri/symbols/support/Symbol3DOutline":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/JSONSupport ../../Color ../../core/screenUtils ./materialUtils ../../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l,g,c,b){a=q=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a.color=new l([0,0,0,1]);a.size=1;return a}p(a,b);a.prototype.readColor=function(b,a){a=null!=a.transparency?c.transparencyToOpacity(a.transparency):1;if(b&&f.isDefined(b[0]))return[b[0],b[1],b[2],a]};a.prototype.writeColor=function(b,a){a.color=[b.r,b.g,b.b];1!==b.a&&(a.transparency=c.opacityToTransparency(b.a))};a.prototype.clone=function(){return new q({color:f.clone(this.color),size:this.size})};
return a}(b.declared(e));m([b.property({type:l})],a.prototype,"color",void 0);m([b.reader("color",["color","transparency"])],a.prototype,"readColor",null);m([b.writer("color")],a.prototype,"writeColor",null);m([b.property({json:{write:!0}}),b.cast(g.toPt)],a.prototype,"size",void 0);a=q=m([b.subclass("esri.symbols.support.Symbol3DOutline")],a);h.Symbol3DOutline=a;Object.defineProperty(h,"__esModule",{value:!0});h.default=a;var q})},"esri/symbols/support/Symbol3DResource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/urlUtils ../../core/JSONSupport ../../core/kebabDictionary ../../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l,g){var c=l({invertedCone:"inverted-cone"});a=b=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}p(e,a);e.prototype.readHref=e.prototype.writeHref=function(b,a,c,e){b&&(a.href=f.write(b,e))};e.prototype.readPrimitive=function(b){return c.fromJSON(b)};e.prototype.writePrimitive=function(b,a){a.primitive=c.toJSON(b)};e.prototype.clone=return e}(g.declared(e));
m([g.property({json:{write:!0}})],a.prototype,"href",void 0);m([g.reader("href")],a.prototype,"readHref",null);m([g.writer("href")],a.prototype,"writeHref",null);m([g.property({json:{write:!0}})],a.prototype,"primitive",void 0);m([g.reader("primitive")],a.prototype,"readPrimitive",null);m([g.writer("primitive")],a.prototype,"writePrimitive",null);a=b=m([g.subclass("esri.symbols.support.Symbol3DResource")],a);h.Symbol3DResource=a;Object.defineProperty(h,"__esModule",{value:!0});h.default=a;var b})},
"esri/views/3d/layers/graphics/Graphics3DIconSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang dojo/when ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./SignedDistanceFunctions ./FastSymbolUpdates ../../../../core/urlUtils ../../../../core/screenUtils ../../../../config ../../../../Color ../../../../geometry/Polygon ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/Texture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v,A,z,D,B){unction F(b){var a;"primitive:"===b.substring(0,10)&&(b=b.substring(10));switch(b){case S.PRIM_CIRCLE:a=q.computeSignedDistancefieldCicle(128,64);break;case S.PRIM_SQUARE:a=q.computeSignedDistancefieldSquare(128,64,!1);break;case S.PRIM_KITE:a=q.computeSignedDistancefieldSquare(128,64,!0);break;case S.PRIM_CROSS:a=q.computeSignedDistancefieldCrossAndX(128,64,!1);break;case S.PRIM_X:a=q.computeSignedDistancefieldCrossAndX(128,
64,!0)}return new D(a,"sdf_"+b,{mipmap:!1,wrapClamp:!0,width:128,height:128,components:4})}var K=d.vec3d;a=d.vec4d;var M=d.mat4d.identity(),E=[0,0,1],V=[0,0,0,0],P=[0,0,0],I=[1,1,1],J="center bottom top left right bottom-left bottom-right top-left top-right".split(" "),Q=[.25,.25,.75,.75],S={PRIM_CIRCLE:"circle",PRIM_SQUARE:"square",PRIM_CROSS:"cross",PRIM_X:"x",PRIM_KITE:"kite"};e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}p(d,a);d.prototype._prepareResources=function(){var b=
this.symbol,a=null!=b.size?t.pt2px(b.size):16;this._size=null;this._symbolTextureRatio=1;this._primitive=null;var d=this._getStageIdHint();this._isPropertyDriven("size")&&64>a&&(a=64);var c=b.resource||{primitive:"circle",href:void 0},e={anchorPos:this._getAnchorPos(b)};if(c.href)e.color=this._getFillColor(b,null),e.outlineColor=this._getOutlineColor(b),e.outlineSize=this._getOutlineSize(b,null),e.textureIsSignedDistanceField=!1,this._prepareImageResources(c.href,a,e,d);else{var c=c.primitive||"circle",
k="primitive:"+c;this._primitive=c;e.color=this._getFillColor(b,c);e.outlineColor=this._getOutlineColor(b);e.outlineSize=this._getOutlineSize(b,c);C(c)&&0===e.outlineSize?this.reject():(this.texture=this._context.sharedResources.textures.acquire(k,F),this._textureURI=k,e.textureIsSignedDistanceField=!0,e.distanceFieldBoundingBox=Q,e.textureId=this.texture.getId(),this._size=[a,a],this._symbolTextureRatio=2,this._createMaterialsAndAddToStage(e,this._context.stage,d),this.resolve())}};d.prototype._getOutlineDefaultSize=
d.prototype._getOutlineSize=function(b,a){return b.outline?null!=b.outline.size?t.pt2px(b.outline.size):this._getOutlineDefaultSize(a):this._getOutlineDefaultSize(a)};d.prototype._getOutlineColor=function(b){var a=this._getLayerOpacity();if(b.outline&&null!=b.outline.color){var d=r.toUnitRGB(b.outline.color);return[d[0],d[1],d[2],b.outline.color.a*a]}return[0,0,0,a]};d.prototype._getFillColor=function(b,a){return C(a)?V:this._getMaterialOpacityAndColor()};d.prototype._getAnchorPos=
function(b){return-1<J.indexOf(b.anchor)?b.anchor:"center"};d.prototype._prepareImageResources=function(b,a,d,c){var e=this,k=function(b){if(!e.isRejected()){var k=b.params,n=k.width/k.height;e._size=a?1<n?[a,a/n]:[a*n,a]:[k.width,k.height];d.textureId=b.getId();e._createMaterialsAndAddToStage(d,e._context.stage,c);e.resolve()}},n="data:image/svg"===b.substring(0,14),g=".svg"===b.substring(b.length-4,b.length);if(n||g){b=y.normalize(b);var l=new Image,g=!n&&y.hasSameOrigin(b,window.location.href);
n||(g||y.canUseXhr(b)?g||(l.crossOrigin="anonymous"):u.request.proxyUrl&&(b=u.request.proxyUrl+"?"+b));l.src=b;l.onerror=function(){e.reject()};l.onload=function(){if(!e.isRejected()){var b=l.width,d=l.height,c=1;b&&d&&(c=b/d);null!=a&&(1<c?(b=a,d=Math.round(a/c)):(d=a,b=Math.round(a*c)));c=document.createElement("canvas");c.width=b;c.height=d;c.getContext("2d").drawImage(l,0,0,b,d);b=c.toDataURL();f(e._context.sharedResources.textures.acquire(b),k,function(){e.reject()});e._textureURI=b}};l.onerror=
else f(this._context.sharedResources.textures.acquire(b),k,function(){e.reject()}),this._textureURI=b};d.prototype._createMaterialsAndAddToStage=function(b,a,d){this._fastUpdates=x.initFastSymbolUpdatesState(this._context.renderer,this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());this._fastUpdates.enabled&&m.mixin(b,this._fastUpdates.materialParameters);var c=m.clone(b);c.occlusionTest=!1;c.shaderPolygonOffset=
0;this._drapedMaterial=new B(c,d+"_iconDraped");a.add(k.ModelContentType.MATERIAL,this._drapedMaterial);b.occlusionTest=!0;this._material=new B(b,d+"_icon");a.add(k.ModelContentType.MATERIAL,this._material)};d.prototype.destroy=function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(k.ModelContentType.MATERIAL,this._material.getId()),this._material=null);this._drapedMaterial&&(this._context.stage.remove(k.ModelContentType.MATERIAL,this._drapedMaterial.getId()),this._drapedMaterial=
null);this._textureURI&&(this._context.sharedResources.textures.release(this._textureURI),this._textureURI=null)};d.prototype._getGeometry=function(a){a=a.geometry;if("extent"===a.type)return b.placePointOnPolygon(n.fromExtent(a));if("polyline"===a.type)return b.placePointOnPolyline(a);if("polygon"===a.type)return b.placePointOnPolygon(a);if("point"===a.type)return a;this._logWarning("unsupported geometry type for icon symbol: "+a.type);return null};d.prototype._getScaleFactor=function(b){if(this._isPropertyDriven("size")){if(b.size){for(var a=
0;3>a;a++)b.size[a]&&"symbolValue"!==b.size[0]&&(b.size[a]=t.pt2px(b.size[a]));a=this._size[0]>this._size[1]?this._size[0]:this._size[1];if("symbolValue"===b.size[0])return 1;if(isFinite(b.size[0]))return b.size[0]/a;if(isFinite(b.size[2]))return b.size[2]/a}}else return 1};d.prototype.createGraphics3DGraphic=function(a,d){var c=this._getGeometry(a);if(null===c)return null;var e="graphic"+a.uid,k=this._getVertexOpacityAndColor(d),n=1;this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||
(n=this._getScaleFactor(d));n*=this._symbolTextureRatio;d=[this._size[0]*n,this._size[1]*n];n=this._getGraphicElevationInfo(a);return n.mode===b.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(a,c,k,d,n,e,a.uid):this._createAs3DShape(a,c,k,d,n,e,a.uid)};d.prototype.layerPropertyChanged=function(a,d,e){if("opacity"===a)return d=this._getFillColor(this.symbol,this._primitive),this._drapedMaterial.setParameterValues({color:d}),this._material.setParameterValues({color:d}),d=this._getOutlineColor(this.symbol),
this._drapedMaterial.setParameterValues({outlineColor:d}),this._material.setParameterValues({outlineColor:d}),!0;if("elevationInfo"===a){var k=this._elevationInfo.mode;this._updateElevationInfo();a=this._elevationInfo.mode;var n=b.ELEV_MODES;if(k===n.ON_THE_GROUND&&a===n.ON_THE_GROUND)return!0;if(k!==a&&(k===n.ON_THE_GROUND||a===n.ON_THE_GROUND))return!1;var k=this._context.elevationProvider,g=this._context.renderCoordsHelper,f=c.perObjectElevationAligner,v;for(v in d){var m=d[v],r=m._graphics[e];
r&&r instanceof l&&(m=this._getGraphicElevationInfo(m.graphic),r.elevationAligner=a===n.RELATIVE_TO_GROUND?f:null,r.elevationInfo.set(m),f(r,k,g))}return!0}return!1};d.prototype.applyRendererDiff=function(b,a,d,c){for(var e in b.diff)switch(e){case "visualVariables":if(x.updateFastSymbolUpdatesState(this._fastUpdates,a,this._fastVisualVariableConvertOptions()))this._material.setParameterValues(this._fastUpdates.materialParameters),this._drapedMaterial.setParameterValues(this._fastUpdates.materialParameters);
else return!1;break;default:return!1}return!0};d.prototype.setDrawOrder=function(b,a,d){this._drapedMaterial&&(this._drapedMaterial.setRenderPriority(b),d[this._drapedMaterial.getId()]=!0)};d.prototype._defaultElevationInfoNoZ=function(){return ga};d.prototype._getGraphicElevationInfo=function(d){var c=a.prototype._getGraphicElevationInfo.call(this,d);c.mode!==b.ELEV_MODES.RELATIVE_TO_GROUND||0!==c.offset||d.geometry.get("hasZ")||(c.offset=1/this._context.renderCoordsHelper.unitInMeters);return c};
d.prototype._createAs3DShape=function(a,d,e,k,n,g,f){var m=this,r=this._getFastUpdateAttrValues(a),q=r?function(b){return x.evaluateModelTransform(m._fastUpdates.materialParameters,r,b)}:null;a=A.createPointGeometry(E,null,e,k,L,null,r);a=[new v(a,g)];g=b.createStageObjectForPoint.call(this,d,a,[[this._material]],null,null,n,g,this._context.layer.id,f,!0,q);if(null===g)return null;f=null;n.mode===b.ELEV_MODES.RELATIVE_TO_GROUND?f=c.perObjectElevationAligner:n.mode===b.ELEV_MODES.ABSOLUTE_HEIGHT&&
(f=c.perObjectVerticalDistanceToGroundAligner);n=new l(this,g.object,a,null,null,f,n);n.alignedTerrainElevation=g.terrainElevation;if(this._fastUpdates.enabled){var h=k[0]/this._symbolTextureRatio,w=k[1]/this._symbolTextureRatio;n.getScreenSize=function(){var b=q(M);return[b[0]*h,b[5]*w]}}else{var t=k[0]/this._symbolTextureRatio,u=k[1]/this._symbolTextureRatio;n.getScreenSize=function(){return[t,u]}}b.extendPointGraphicElevationInfo(n,d,this._context.elevationProvider);return n};d.prototype._createAsOverlay=
function(a,d,c,e,k,n,f){var l=this;this._drapedMaterial.setRenderPriority(this._symbolLayerOrder);f=K.create();w.pointToVector(d,f,this._context.overlaySR);f[2]=this._getDrapedZ();if((d=this._context.clippingExtent)&&!b.pointInBox2D(f,d))return null;var v=this._getFastUpdateAttrValues(a),m=v?null;a=A.createPointGeometry(E,f,c,e,null,null,v);c=new z(a);c.material=this._drapedMaterial;c.center=f;c.bsRadius=0;c.transformation=
M;c.name=n;c.uniqueName=n+"#"+a.id;k=new g(this,[c],null,null,null,k);if(this._fastUpdates.enabled){var r=e[0]/this._symbolTextureRatio,q=e[1]/this._symbolTextureRatio;k.getScreenSize=function(){var b=m(M);return[b[0]*r,b[5]*q]}}else{var h=e[0]/this._symbolTextureRatio,t=e[1]/this._symbolTextureRatio;k.getScreenSize=function(){return[h,t]}}return k};d.prototype._supportsShaderVisualVariables=function(){return!0};d.prototype._fastVisualVariableConvertOptions=function(){var b=this._size[0]>this._size[1]?
this._size[0]:this._size[1],a=[b,b,b],d=t.px2pt(1),b=b*d;return{modelSize:a,symbolSize:[b,b,b],unitInMeters:d,transformation:{anchor:P,scale:I,rotation:0}}};return d}(e);e.PRIMITIVE_SIZE=[64,64];e.VALID_ANCHOR_STRINGS=J;var ga={mode:b.ELEV_MODES.RELATIVE_TO_GROUND,offset:0},L=a.createFrom(0,0,0,1);return e})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang ../../support/PromiseLightweight ../../support/mathUtils ./ElevationInfo ./graphicUtils ../../../../core/Logger ../../../../Color".split(" "),
function(a,h,p,m,f,e,l,g,c,b){function q(b,a){b=null!=b?a.attributes[b]:0;null!=b&&isFinite(b)||(b=0);return b}var x=new l,y=c.getLogger("esri.symbols.Symbol3D");a=function(a){function c(b,d,c){var e=a.call(this)||this;e.symbol=b;e._context=d;e._symbolLayerOrder=d.layerOrder;e._symbolLayerOrderDelta=d.layerOrderDelta;e._elevationInfo=new l;e._material=null;e._updateDrivenProperties(c);e._updateElevationInfo();e._prepareResources();return e}p(c,a);c.prototype._logWarning=function(b){y.warn(b)};c.prototype._prepareResources=
c.prototype._defaultElevationInfoNoZ=function(){return t};c.prototype._defaultElevationInfoZ=function(){return u};c.prototype._updateElevationInfo=function(){for(var b in this._elevationInfo)this._elevationInfo[b]=void 0;if(b=this._context.layer.elevationInfo)this._elevationInfo=m.mixin(this._elevationInfo,b);this.symbol.elevationInfo&&(this._elevationInfo=m.mixin(this._elevationInfo,this.symbol.elevationInfo))};c.prototype._getGraphicElevationInfo=
function(b){b=b.geometry.hasZ?this._defaultElevationInfoZ():this._defaultElevationInfoNoZ();x.mode=this._elevationInfo.mode||b.mode;x.offset=null!=this._elevationInfo.offset?this._elevationInfo.offset:b.offset;x.featureExpression=this._elevationInfo.featureExpression;x.offset/=this._context.renderCoordsHelper.unitInMeters;return x};c.prototype._getDrapedZ=c.prototype._updateDrivenProperties=function(b){var a={color:!1,opacity:!1,size:!1};!b&&(b=this._context.renderer)&&(a.color=
!!b.colorInfo,a.size=!!b.sizeInfo,b.visualVariables&&b.visualVariables.forEach(function(b){switch(b.type){case "color":a.color=!0;if(b.colors)for(var d=0;d<b.colors.length;d++){var c=b.colors[d];c&&(Array.isArray(c)&&3<c.length&&255!==c[3]||void 0!==c.a&&255!==c.a)&&(a.opacity=!0)}if(b.stops)for(d=0;d<b.stops.length;d++)(c=b.stops[d].color)&&(Array.isArray(c)&&3<c.length&&255!==c[3]||void 0!==c.a&&255!==c.a)&&(a.opacity=!0);break;case "opacity":a.opacity=!0;break;case "size":a.size=!0}}));this._drivenProperties=
a};c.prototype._isPropertyDriven=function(b){return this._drivenProperties[b]};c.prototype._getLayerOpacity=function(){if(this._context.layerView&&"fullOpacity"in this._context.layerView)return this._context.layerView.fullOpacity;var b=this._context.layer.opacity;return null==b?1:b};c.prototype._getMaterialOpacity=function(){var b;b=1*this._getLayerOpacity();var a=this.symbol.material;a&&!this._isPropertyDriven("opacity")&&(b*=a.color.a);return b};c.prototype._getMaterialOpacityAndColor=function(){var a=
this.symbol.material,d=this._getMaterialOpacity(),a=this._isPropertyDriven("color")||!a?null:b.toUnitRGB(a.color);return g.mixinColorAndOpacity(a,d)};c.prototype._getVertexOpacityAndColor=function(b,a,c){var d=this._isPropertyDriven("color")?b.color:null;b=this._isPropertyDriven("opacity")?b.opacity:null;d=g.mixinColorAndOpacity(d,b);c&&(d[0]*=c,d[1]*=c,d[2]*=c,d[3]*=c);return a?new a(d):d};c.prototype._getStageIdHint=c.prototype.isFastUpdatesEnabled=
function(){return this._fastUpdates&&this._fastUpdates.enabled};c.prototype.setDrawOrder=function(b,a,c){this._material&&(this._material.setRenderPriority(b),c[this._material.getId()]=!0)};c.prototype.createGraphics3DGraphic=function(b,a){for(var d=2;d<arguments.length;d++);throw Error("This is an abstract base class");};c.prototype.destroy=function(){throw Error("This is an abstract base class");};c.prototype.layerPropertyChanged=c.prototype.applyRendererDiff=c.prototype._getFastUpdateAttrValues=function(b){if(!this._fastUpdates.enabled)return null;var a=this._fastUpdates.visualVariables,c=a.size?q(a.size.field,b):0,n=a.color?q(a.color.field,b):0;a.rotation?(a=a.rotation,b=q(a.field,b),b=e.deg2rad("arithmetic"===a.rotationType?90-b:b)):b=0;return[c,n,b,0]};return c}(f.Promise);var t={mode:l.MODES.ON_THE_GROUND,offset:0},u={mode:l.MODES.ABSOLUTE_HEIGHT,offset:0};return a})},"esri/views/3d/support/PromiseLightweight":function(){(function(a){function h(a){this._callbacks=
[];this._errbacks=[];this._cancelCallback=a;this._iserr=this._isdone=this._iscancelled=!1}function p(a,e){var f=new h;0===a.length?f.done.apply(f,e):a[0].apply(null,e).then(function(){a.splice(0,1);p(a,arguments).then(});return f}h.prototype.cancel=function(a){this._callbacks=[];this._errbacks=[];this._iscancelled=!0;this._cancelCallback&&this._cancelCallback(a)};h.prototype.then=function(a,e,l){var g;if(!this._iscancelled)return this._isdone?g=a.apply(l,this.result):
this._iserr&&e?g=e.apply(l,this.result):(this._callbacks.push(function(){return a.apply(l,arguments)}),e&&this._errbacks.push(),g};h.prototype.done=function(){this.result=arguments;this._isdone=!0;for(var a=0;a<this._callbacks.length;a++)this._callbacks[a].apply(null,arguments);this._callbacks=[];this._errbacks=[]};h.prototype.resolve=h.prototype.done;h.prototype.reject=function(){if(!this._iscancelled){this.result=arguments;this._iserr=!0;for(var a=0;a<this._errbacks.length;a++)this._errbacks[a].apply(null,
arguments);this._callbacks=[];this._errbacks=[]}};h.prototype.isRejected=function(){return this._iserr};h.prototype.isFulfilled=h.prototype.isResolved=function(){return this._isdone};h.prototype.isCancelled=function(){return this._iscancelled};var m={Promise:h,join:function(a){function e(a,e){return function(){e&&(m=!0);c+=1;b[a]=Array.prototype.slice.call(arguments);c===g&&(m?f.reject():f.done(b))}}for(var f=new h,g=a.length,c=0,b=[],m=!1,p=0;p<g;p++)a[p].then(e(p,
!1),e(p,!0));0===a.length&&f.done();return f},chain:p};"function"===typeof define&&define.amd?define(function(){return m}):a.promise=m})(this)},"esri/views/3d/layers/graphics/ElevationInfo":function(){define(["require","exports","../../../../core/lang"],function(a,h,p){a=function(){function a(a){a?this.set(a):(this.mode=null,this.offset=0,this.featureExpression=null)}a.prototype.set=function(a){this.mode=a.mode;this.offset=a.offset;this.featureExpression=a.featureExpression?p.clone(a.featureExpression):
null};return a}();a.MODES={ABSOLUTE_HEIGHT:"absolute-height",RELATIVE_TO_GROUND:"relative-to-ground",ON_THE_GROUND:"on-the-ground"};return a})},"esri/views/3d/layers/graphics/graphicUtils":function(){define("require exports ../../../../geometry/SpatialReference ../../../../geometry/Point ../../../../geometry/support/webMercatorUtils ../../lib/glMatrix".split(" "),function(a,h,p,m,f,e){function l(a,b){var c=a.spatialReference;c.equals(b)||(c.isWebMercator&&b.wkid===p.WGS84.wkid?f.webMercatorToGeographic(a,
!1,a):b.isWebMercator&&c.wkid===p.WGS84.wkid&&f.geographicToWebMercator(a,!1,a))}var g=e.vec4d;h.computeCentroid=function(a,b){if("extent"===a.type)return a.center;for(var c=a["polygon"===a.type?"rings":"paths"],e=0,g=0,f=0,h=a.hasZ,r=0,n=0;n<c.length;n++){for(var w=c[n],d=0;d<w.length;d++)e+=w[d][0],g+=w[d][1],h&&(f+=w[d][2]);r+=w.length}a=new m({x:e/r,y:g/r,z:h?f/r:void 0,spatialReference:a.spatialReference});b&&l(a,b);return a};h.convertToSR=l;h.enlargeExtent=function(a,b,e){if(a){b||(b=g.create());
var c=.5*a.width*(e-1);e=.5*a.height*(e-1);a.width<1E-7*a.height?c+=e/20:a.height<1E-7*a.width&&(e+=c/20);g.set4(a.xmin-c,a.ymin-e,a.xmax+c,a.ymax+e,b);return b}return null};h.updateVertexAttributeAuxpos1w=function(a,b){for(var c=0;c<a.geometries.length;++c){var e=a.geometries[c].data.vertexAttributes.auxpos1;e&&e.data[3]!==b&&(e.data[3]=b,a.geometryVertexAttrsUpdated(c))}};h.mixinColorAndOpacity=function(a,b){var c=[1,1,1,1];null!=a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]);null!==b&&void 0!==b?c[3]=b:null!=
a&&3<a.length&&(c[3]=a[3]);return c};h.overrideColor=function(a,b,e,g,f){f=f.slice();for(var c=0;3>c;++c)a&&null!=a[c]?f[c]=a[c]:e&&null!=e[c]&&(f[c]=e[c]);null!=b?f[3]=b:null!=g&&(f[3]=g);return f}})},"esri/views/3d/layers/graphics/Graphics3DGraphicLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ./ElevationInfo ../../webgl-engine/Stage ../../lib/glMatrix ../../support/aaBoundingBox".split(" "),
function(a,h,p,m,f,e,l,g,c){a=g.vec3d;var b=g.mat4d,q=[0,0,0];g=function(){function a(b,c,e,d,k,g,f,l){this._addedToStage=!1;this.alignedTerrainElevation=0;this.graphics3DSymbolLayer=b;this.uniqueMaterials=d;this.uniqueGeometries=e;this.uniqueTextures=k;this.stageObject=c;this.elevationAligner=g;this.elevationInfo=new t(f);this.stageLayer=this.stage=null;this._shown=!1;this._visibilityFlags={};this.visibilityMode=null!=l?l:a.VisibilityModes.HIDE_FACERANGE}a.prototype.initialize=function(b,a){this.stageLayer=
b;this.stage=a;if(this.uniqueMaterials)for(b=0;b<this.uniqueMaterials.length;b++)a.add(l.ModelContentType.MATERIAL,this.uniqueMaterials[b]);if(this.uniqueGeometries)for(b=0;b<this.uniqueGeometries.length;b++)a.add(l.ModelContentType.GEOMETRY,this.uniqueGeometries[b]);if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)a.add(l.ModelContentType.TEXTURE,this.uniqueTextures[b]);a.add(l.ModelContentType.OBJECT,this.stageObject)};a.prototype.isDraped=function(){return!1};a.prototype.areVisibilityFlagsSet=
function(b,a){for(var c=!0,d=Object.keys(this._visibilityFlags),e=0;e<d.length;e++){var n=d[e];if(n!==a){if(n===b)return this._visibilityFlags[n];c=c&&this._visibilityFlags[n]}}return c};a.prototype.setVisibilityFlag=function(b,a){this._visibilityFlags[b]=a;return this._calcAndSetVisibility()};a.prototype._calcAndSetVisibility=function(){if(null!=this.stage){var b=this.areVisibilityFlagsSet();return this._shown!==b?((this._shown=b)?this._addedToStage?this.stageObject.unhideAllComponents():(this.stageLayer.addObject(this.stageObject),
this._addedToStage=!0):this.visibilityMode===a.VisibilityModes.HIDE_FACERANGE?this.stageObject.hideAllComponents():(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1),!0):!1}};a.prototype.destroy=function(){var b=this.stage;if(this.stageLayer){if(this.uniqueMaterials)for(var a=0;a<this.uniqueMaterials.length;a++)b.remove(l.ModelContentType.MATERIAL,this.uniqueMaterials[a].getId());if(this.uniqueGeometries)for(a=0;a<this.uniqueGeometries.length;a++)b.remove(l.ModelContentType.GEOMETRY,
this.uniqueGeometries[a].getId());if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)b.remove(l.ModelContentType.TEXTURE,this.uniqueTextures[a].getId())}b.remove(l.ModelContentType.OBJECT,this.stageObject.getId());this._addedToStage&&(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1);this._shown=!1;this.stage=this.stageLayer=null};a.prototype.mustAlignToTerrain=a.prototype.alignWithElevation=a.prototype.setDrawOrder=a.prototype.getBSRadius=function(){return this.stageObject.getBSRadius()};a.prototype.getCenterObjectSpace=a.prototype.getBoundingBoxObjectSpace=function(b){var a=this.stageObject;b||(b=c.create());c.setMin(b,a.getBBMin(!0));c.setMax(b,a.getBBMax(!0));return b};a.prototype.getProjectedBoundingBox=function(a,n,g){return f(this,void 0,void 0,function(){var d,k,f,l,r,h;return m(this,
function(m){switch(m.label){case 0:d=this.getBoundingBoxObjectSpace(g);k=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];for(f=0;f<k.length;f++)l=k[f],y[0]=d[l[0]],y[1]=d[l[1]],y[2]=d[l[2]],b.multiplyVec3(this.stageObject.objectTransformation,y),x[3*f+0]=y[0],x[3*f+1]=y[1],x[3*f+2]=y[2];if(!a(x,0,8))return[3,6];c.set(d,c.NEGATIVE_INFINITY);for(f=0;f<x.length;f+=3)for(r=0;3>r;r++)d[r]=Math.min(d[r],x[f+r]),d[r+3]=Math.max(d[r+3],x[f+r]);if(!n)return[3,5];c.center(d,q);if(this.elevationInfo.mode===
e.MODES.ABSOLUTE_HEIGHT)return[3,5];h=void 0;m.label=1;case 1:return m.trys.push([1,3,,4]),[4,n.queryElevation(q[0],q[1])];case 2:return h=m.sent(),[3,4];case 3:return m.sent(),h=null,[3,4];case 4:null!=h&&c.offset(d,0,0,-this.alignedTerrainElevation+h),m.label=5;case 5:return[2,d];case 6:return[2,null]}})})};a.prototype.getScreenSize=return a}();g.VisibilityModes={REMOVE_OBJECT:0,HIDE_FACERANGE:1};var x=[0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],y=a.create(),t=function(b){function a(a){a=b.call(this,a)||this;a.centerPointInElevationSR=null;return a}p(a,b);return a}(e);return g})},"esri/core/tsSupport/generatorHelper":function(){define([],function(){return function(a,h){unction m(c){if(e)throw new TypeError("Generator is already executing.");for(;f;)try{if(e=1,l&&(g=l[c[0]&2?"return":c[0]?"throw":"next"])&&!(g=g.call(l,c[1])).done)return g;if(l=0,g)c=[0,
g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return f.label++,{value:c[1],done:!1};case 5:f.label++;l=c[1];c=[0];continue;case 7:c=f.ops.pop();f.trys.pop();continue;default:if(!(g=f.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){f=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))f.label=c[1];else if(6===c[0]&&f.label<g[1])f.label=g[1],g=c;else if(g&&f.label<g[2])f.label=g[2],f.ops.push(c);else{g[2]&&f.ops.pop();f.trys.pop();continue}}c=h.call(a,f)}catch(b){c=[6,b],l=0}finally{e=
g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var f={label:0,sent:trys:[],ops:[]},e,l,g;return{next:p(0),"throw":p(1),"return":p(2)}}})},"esri/core/tsSupport/awaiterHelper":function(){define(["dojo/Deferred","dojo/when"],function(a,h){return function(p,m,f,e){function l(a){try{c(e.next(a))}catch(x){b.reject(x)}}function g(a){try{c(e["throw"](a))}catch(x){b.reject(x)}}function c(a){a.done?h(a.value).then(b.resolve,b.reject):h(a.value).then(l,
g)}var b=new a;c((e=e.apply(p,m||[])).next());return b.promise}})},"esri/views/3d/webgl-engine/Stage":function(){define("require exports ./parts/Model ./parts/View ./lib/Selector ./lib/Camera ./lib/gl-matrix ./lib/Util ./lib/ModelContentType".split(" "),function(a,h,p,m,f,e,l,g,c){a=l.vec2d;h=l.vec2;var b=l.vec3d;l=function(){function a(b,a){this._intersectTolerance=f.DEFAULT_TOLERANCE;this._viewContent=[];this._externalIntersectionHandlers=[];this.onSelectionChange=function(){};this.container=b;
this.model=new p;this.view=new m(b,this,this.model.getDirtySet(),a);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())}a.prototype.setNeedsRender=function(){this.view.setNeedsRender()};a.prototype.dispose=a.prototype.setSelectionObject=function(b,a,c){this.model.setSelection(b,c);this.view.setSelectionObject(void 0!==b?b.getId():void 0,c);if(!a)this.onSelectionChange(b,c)};a.prototype.getSelectionObject=function(){return this.model.getSelection()};
a.prototype.frame=function(a,c){void 0===c&&(c=0);var n=Math.max(1E-6,a.getBSRadius());c=Math.max(2,c+2);c*=n;var n=this.getCamera(),d=b.create(n.viewForward);b.scale(d,-(1.5*c/Math.tan(n.fov)));b.set(a.getCenter(),n.center);b.add(n.center,d,n.eye);n=new e(n.eye,n.center,n.up);this.setCamera(n)};a.prototype.beginMod=a.prototype.endMod=function(b){void 0===b&&(b=!1);a.DebugSettings.fineGrainedContentValidation&&
!b&&this.model.validateContent()};a.prototype.add=function(b,a){this.model.add(b,a);"function"===typeof a.addParentStage&&a.addParentStage(this)};a.prototype.remove=function(b,a){b=this.model.remove(b,a);"function"===typeof b.removeParentStage&&b.removeParentStage(this);return b};a.prototype.notifyDirty=a.prototype.processDirty=function(){var b=this.model.getDirtySet(),c=b.getDirtyMaterials();if(b.hasDirtyGeometryRecords()||c){a.DebugSettings.endFrameContentValidation&&
this.model.validateContent();a.DebugSettings.logDirtySet&&console.log("Dirty set: "+this.model.getDirtySet().formatDebugInfo(!1));var e=b.getAddRemoveUpdateListFilteredByLayers(this._viewContent,!0);(0<e[0].length+e[1].length+e[2].length||c)&&this.view.modify(e[0],e[1],e[2],c);a.DebugSettings.logDirtySet&&(console.log("RGs add: "+e[0].map(function(b){return b.uniqueName})),console.log("RGs remove: "+e[1].map(function(b){return b.uniqueName})));b.getAddRemoveUpdateList(!0);b.clearDirtyMaterials();
this.view.setNeedsRender()}};a.prototype.processDirtyLayer=function(b){var a=this.model.getDirtySet(),c=a.getDirtyMaterials();b=a.getAddRemoveUpdateListFilteredByLayers([b],!0);(0<b[0].length+b[1].length+b[2].length||c)&&this.view.modify(b[0],b[1],b[2],c);a.clearDirtyMaterials()};a.prototype.get=a.prototype.getAll=function(b){return this.model.getAll(b)};a.prototype.addTextureListener=function(b){this.view.addTextureListener(b)};a.prototype.removeTextureListener=
function(b){this.view.removeTextureListener(b)};a.prototype.getContainer=function(){return this.container};a.prototype.getCamera=function(){return this.view.getCamera()};a.prototype.setCamera=function(b){this.view.setCamera(b)};a.prototype.getViewParams=function(b){return this.view.getViewParams(b)};a.prototype.setViewParams=function(b){this.view.setViewParams(b)};a.prototype.getLayers=a.prototype.getAmbientLight=function(){return this.model.getAmbientLight()};
a.prototype.getDirectionalLight=function(){return this.model.getDirectionalLight()};a.prototype.setAmbientLight=function(b){this.model.setAmbientLight(b);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())};a.prototype.setDirectionalLight=function(b){this.model.setDirectionalLight(b);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())};a.prototype.getCanvas=function(){return this.view.getCanvas()};a.prototype.setRenderParams=function(b){this.view.setRenderParams(b)};
a.prototype.getRenderParams=function(){return this.view.getRenderParams()};a.prototype.has=function(b){return this.view.has(b)};a.prototype.getViewContent=a.prototype.setViewContent=function(b){var a=g.array2object(this._viewContent),c=g.array2object(b),d=g.subtractObjects(c,a),a=g.subtractObjects(a,c);this.processDirty();c=this.model.getDirtySet();d=c.getResidentRenderGeometriesFilteredByLayers(g.object2array(d));a=c.getResidentRenderGeometriesFilteredByLayers(g.object2array(a));
this.view.modify(d,a,[]);this._viewContent=b.slice(0)};a.prototype.addToViewContent=function(b){for(var a=[],c=0;c<b.length;c++)-1===this._viewContent.indexOf(b[c])&&a.push(b[c]);0<b.length&&(this.processDirty(),b=this.model.getDirtySet().getResidentRenderGeometriesFilteredByLayers(a),this.view.modify(b,[],[]),this._viewContent.push.apply(this._viewContent,a))};a.prototype.removeFromViewContent=function(b){this.processDirty();for(var a=this.model.getDirtySet(),c=this._viewContent,d=[],e=0;e<b.length;e++){var g=
c.indexOf(b[e]);-1<g&&(c[g]=c[c.length-1],c.pop(),d.push(b[e]))}b=a.getResidentRenderGeometriesFilteredByLayers(d);this.view.modify([],b,[])};a.prototype.getViewFrustumObjects=function(){return this.view.getFrustumObjects()};a.prototype.getLocalOrigin=a.prototype.getFrameTask=function(){return this.view.getFrameTask()};a.prototype.requestScreenCapture=a.prototype.getAllTexturesLoaded=function(){return this.view.getAllTexturesLoaded()};
a.prototype.getTextureLoaded=function(b){return this.view.getTextureLoaded(b)};a.prototype.addExternalRenderer=function(b,a){"function"===typeof a.intersect&&this._externalIntersectionHandlers.push(a);return this.view.addExternalRenderer(b,a)};a.prototype.removeExternalRenderer=function(b){var a=this._externalIntersectionHandlers.indexOf(b);-1<a&&this._externalIntersectionHandlers.splice(a,1);return this.view.removeExternalRenderer(b)};a.prototype.getContentDebugStrings=function(b){return this.model.formatDebugInfo(b)};
a.prototype.getRenderStats=function(){return this.view.getCombinedStats()};a.prototype.getRenderStatString=function(b){var a=this.getRenderStats(),c="";if(b){var c=c+"\x3ctable\x3e",d;for(d in a)c+="\x3ctr\x3e\x3ctd\x3e"+d+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Math.round(a[d])+"\x3c/td\x3e\x3c/tr\x3e";c+="\x3c/table\x3e"}else for(d in a)c+=d+": "+a[d]+"\n";return c};a.prototype.pick=function(a,c,e,d){var k=b.create(),n=b.create();this.view.getPickRay(a,k,n);return this.pickRay(k,n,
a,a,c,e,d)};a.prototype.pickRayWithBeginPoint=a.prototype.pickRay=function(a,c,e,d,k,g,l){d=this.view.getCamera();e||(e=q,d.projectPoint(c,e));var n;if(k){n=Array(k.length);for(var m=0;m<n.length;m++)n[m]=this.model.get(p.ContentType.LAYER,k[m])}else{n=[];k=this.getViewContent();for(var v=this.model.getAll(p.ContentType.LAYER),m=0;m<k.length;m++){var r=v[k[m]];r&&"VISIBLE"===r.getState()&&n.push(r)}}l?l.init(n,a,c,e,d,this._intersectTolerance,
g):l=new f(n,a,c,e,d,this._intersectTolerance,g);for(m=0;m<this._externalIntersectionHandlers.length;m++)this._externalIntersectionHandlers[m].intersect(l,a,c,e);if(l.getHudResults().length){m=l.getHudResults();m.sort(function(b,a){return a.dist-b.dist});c=m[m.length-1];e=x;d.projectPoint(c.center,e);e[0]=Math.round(e[0]);e[1]=Math.round(e[1]);k=y;this.view.getPickRay(e,a,k);v=b.dist(c.center,a)/b.dist(a,k)*.99;t.init(n,a,k,e,d,this._intersectTolerance,g);for(m=0;m<this._externalIntersectionHandlers.length;m++)this._externalIntersectionHandlers[m].intersect(t,
a,k,e);if(null==t.getMinResult().dist||v<=t.getMinResult().dist)l.getMinResult().set(c.target,c.name,c.dist,c.normal,c.priority),l.getMinResult().setIntersector("stage")}return l};a.prototype.getIntersectTolerance=function(){return this._intersectTolerance};a.prototype.setIntersectTolerance=a.prototype.getTextureGraphicsRenderer=function(){return this.view.getTextureGraphicsRenderer()};return a}();l.DebugSettings={fineGrainedContentValidation:!1,
endFrameContentValidation:!1,logDirtySet:!1};l.ModelContentType=c;var q=a.create(),x=h.create(),y=b.create(),t=new f;t.enableHUDSelection=!1;return l})},"esri/views/3d/webgl-engine/parts/Model":function(){define("require exports dojo/string ../lib/lights ../lib/ModelContentType ../lib/ModelDirtySet ../lib/RenderGeometry ../lib/Util ../lib/gl-matrix".split(" "),function(a,h,p,m,f,e,l,g,c){var b=g.assert,q=g.verify,x=c.vec3d,y=c.mat4d,t=g.logWithBase;a=function(){function a(){this.dirtySet=new e(this);
this.ambientLight=new m.AmbientLight([1,1,1],.3);this.directionalLight=new m.DirectionalLight([1,1,1],.7,x.normalize([1,1,1]));this._uniqueIdx=0;this._id2origin={};this.content={};for(var b in f)this.content[f[b]]={}}a.prototype.getAll=function(a){a=this.content[a];b(void 0!==a);return a};a.prototype.get=a.prototype.add=function(a,c){var e=this.content[a];b(void 0!==e);var d=c.getId();b(null==e[d],"Model/Stage already contains object to be added");e[d]=c;a===
f.LAYER&&this.notifyDirty(a,c,"layerAdded")};a.prototype.remove=function(a,c){var e=this.content[a];b(void 0!==e);var d=e[c];b(void 0!==d,"Model/Stage doesn't contain object to be removed");delete e[c];a===f.TEXTURE&&d.unload();a===f.LAYER&&this.notifyDirty(a,d,"layerRemoved");return d};a.prototype.getDirtySet=function(){return this.dirtySet};a.prototype.notifyDirty=a.prototype.getAmbientLight=function(){return this.ambientLight};a.prototype.setAmbientLight=
function(b){this.ambientLight.set(b)};a.prototype.getDirectionalLight=function(){return this.directionalLight};a.prototype.setDirectionalLight=a.prototype.getSelection=function(){return this.selection};a.prototype.setSelection=a.prototype.getSelectionFaceRange=function(){return this.selectionFaceRange};a.prototype.getOrigin=function(b,a,c){void 0===c&&(c=10);var d=0;a=a*c/1E4;1<a&&(d=Math.ceil(t(a,
2)));a=1E4*Math.pow(2,d);c=Math.round(b[0]/a);var e=Math.round(b[1]/a);b=Math.round(b[2]/a);var d=d+"_"+c+"_"+e+"_"+b,g=this._id2origin[d];null==g&&(g={vec3:x.createFrom(c*a,e*a,b*a),id:d},this._id2origin[d]=g);return g};a.prototype.getGeometryRenderGeometries=function(b,a,c){var d=b.getId(),e=a.geometry,g=e.getData(),f=!!e.singleUse,n=a.materials,m=a.instanceParameters,q=b.getCombinedStaticTransformation(a),h=y.maxScale(q),r=a.origin,e=e.getBoundingInfo(0);a=a.getId()+"#0";var t=this._uniqueIdx++;
b=new l(g,e,n[0],q,h,b.getCastShadow(),f,d,a,t);b.origin=r||this.getOrigin(b.center,b.bsRadius);b.instanceParameters=m;c.push(b)};a.prototype.updateRenderGeometryTransformation=function(b,a,c){b.getCombinedStaticTransformation(a,c.transformation);c.updateTransformation(c.transformation)};a.prototype.formatDebugInfo=function(b){var a=[];if(b){a[0]="\x3ctable\x3e";for(var c in f)b=f[c],a[0]+="\x3ctr\x3e\x3ctd\x3e"+b+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Object.keys(this.getAll(b)).length+
"\x3c/td\x3e\x3c/tr\x3e";a[0]+="\x3c/table\x3e";a[1]=this.dirtySet.formatDebugInfo(!0)}else{a[0]="";for(c in f)b=f[c],a[0]+=p.pad(String(Object.keys(this.getAll(b)).length),6," ")+" "+b+", ";a[1]=this.dirtySet.formatDebugInfo(!1)}return a};a.prototype.validateContent=function(){var b=this.getAll(f.OBJECT),a;for(a in b)this.validateObject(b[a]);var b=this.getAll(f.LAYER),c;for(c in b)this.validateLayer(b[c]);c=this.getAll(f.MATERIAL);for(var d in c)this.validateMaterial(c[d])};a.prototype.validateObject=
function(a){a=a.geometryRecords;for(var c=0;c<a.length;++c){var e=a[c];b(null!=this.get(f.GEOMETRY,e.geometry.id));var d=e.geometry.numGroups;b(d<=e.materials.length,"object materials do not match geometry groups");q(d===e.materials.length,"object materials do not match geometry groups");for(var k=0;k<d;++k)b(null!=this.get(f.MATERIAL,e.materials[k].getId()))}};a.prototype.validateLayer=function(a){a=a.getObjects();for(var c=0;c<a.length;++c){var e=this.get(f.OBJECT,a[c].getId());b(null!=e)}};a.prototype.validateMaterial=
function(a){a=a.getAllTextureIds();for(var c=0;c<a.length;++c){var e=this.get(f.TEXTURE,a[c]);b(null!=e)}};return a}();a.ContentType=f;return a})},"esri/views/3d/webgl-engine/lib/lights":function(){define(["require","exports"],function(a,h){a=function(){.prototype.set=function(a){void 0!==a.color&&(this.color=a.color);void 0!==a.intensity&&(this.intensity=a.intensity)};return a}();h.AmbientLight=a;a=function(){.prototype.set=function(a){void 0!==a.color&&(this.color=a.color);void 0!==a.intensity&&(this.intensity=a.intensity);void 0!==a.direction&&(this.direction=a.direction)};return a}();h.DirectionalLight=a})},"esri/views/3d/webgl-engine/lib/ModelContentType":function(){define(["require","exports"],function(a,h){a=);a.LAYER="layers";a.OBJECT="objects";a.GEOMETRY="geometries";a.MATERIAL="materials";a.TEXTURE="textures";return a})},"esri/views/3d/webgl-engine/lib/ModelDirtySet":function(){define(["require",
"exports","./ModelContentType","./ModelDirtyTypesTs","./Util"],function(a,h,p,m,f){var e=f.objectEmpty,l=f.assert;return function(){function a(a){this._residentGeomRecords={};this._dirtyGeomRecords={};this._dirtyMaterials={};this._model=a}Object.defineProperty(a.prototype,"residentLayerCount",{get:enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"residentObjectCount",{get:function(){var a=0,b;for(b in this._residentGeomRecords)a+=
Object.keys(this._residentGeomRecords[b]).length;return a},enumerable:!0,configurable:!0});a.prototype._getResidentGeometryRecords=function(){return this._residentGeomRecords};a.prototype._getDirtyGeometryRecords=function(){return this._dirtyGeomRecords};a.prototype.getDirtyMaterials=a.prototype.clearDirtyMaterials=function(){this._dirtyMaterials={}};a.prototype.hasDirtyGeometryRecords=function(){for(var a in this._dirtyGeomRecords)for(var b in this._dirtyGeomRecords[a]){var f=
this._dirtyGeomRecords[a][b];if(f&&!e(f))return!0}return!1};a.prototype.handleUpdate=function(a,b,e){l(this[b],"ModelDirtySet doesn't know how to process "+b);return this[b](a,e)};a.prototype.getAddRemoveUpdateList=function(a){return this.getAddRemoveUpdateListFilteredByLayers(Object.keys(this._dirtyGeomRecords),a)};a.prototype.getAddRemoveUpdateListFilteredByLayers=function(a,b){for(var c=[],f=[],g=[],m=0;m<a.length;m++){var h=a[m];if(h in this._dirtyGeomRecords){for(var r in this._dirtyGeomRecords[h]){var n=
this._dirtyGeomRecords[h][r];if(n){var w=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,h,r),d;for(d in n){var k=n[d],v=k[0],A=k[1],k=k[2],z=A&2&&k&1;if(A&4||z){var D=w[d];D?f.push.apply(f,D[1]):4===A&&l(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove");b&&D&&delete w[d]}if(A&1||z){var D=[v,[]],B=this._model.get(p.OBJECT,r);this._model.getGeometryRenderGeometries(B,v,D[1]);c.push.apply(c,D[1]);b&&(w[d]=D)}if(A&2&&!z)if(D=w[d],B=this._model.get(p.OBJECT,r),D){A=
D[1];z=A.length;if(k&16)for(D=0;D<z;D++){var C=A[D];this._model.updateRenderGeometryTransformation(B,v,C)}for(D=0;D<z;D++)C=A[D],g.push({renderGeometry:C,updateType:k})}else l(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}e(w)&&delete this._residentGeomRecords[h][r]}}e(this._residentGeomRecords[h])&&delete this._residentGeomRecords[h]}b&&delete this._dirtyGeomRecords[h]}return[c,f,g]};a.prototype.getResidentRenderGeometries=
a.prototype.getResidentRenderGeometriesFilteredByLayers=function(a){for(var b=[],c=0;c<a.length;c++){var e=a[c];if(e in this._residentGeomRecords)for(var f in this._residentGeomRecords[e]){var g=this._residentGeomRecords[e][f];if(g)for(var l in g)b.push.apply(b,g[l][1])}}return b};a.prototype.componentVisibilityChanged=function(a,b,e){if(null!=b)this._componentVisibilityChanged(a,b,e);else{b=0;for(var c=a.getGeometryRecords();b<c.length;b++)this._componentVisibilityChanged(a,c[b],e)}};a.prototype.vertexAttrsUpdated=
function(a,b,e){this._updateOrCreateDirtyRecord(a,b,e,2,0,0,2,5,4)};a.prototype.colorAttrsUpdated=function(a,b,e){this._updateOrCreateDirtyRecord(a,b,e,2,0,0,2,5,8)};a.prototype.matChanged=a.prototype.layerAdded=function(a){for(var b=a.getObjects(),c=0;c<b.length;c++)this.layObjectAdded(a,b[c])};a.prototype.layerRemoved=function(a){for(var b=a.getObjects(),c=0;c<b.length;c++)this.layObjectRemoved(a,b[c])};a.prototype.layObjectAdded=function(a,b){a=a.getId();
for(var c=b.getGeometryRecords(),e=0;e<c.length;e++)this.objGeometryAdded(b,c[e],a)};a.prototype.layObjectRemoved=function(a,b){a=a.getId();for(var c=b.getGeometryRecords(),e=0;e<c.length;e++)this.objGeometryRemoved(b,c[e],a)};a.prototype.layObjectReplaced=function(a,b){this.layObjectRemoved(a,b[0]);this.layObjectAdded(a,b[1])};a.prototype.objDirty=function(a,b){b=b||this._getParentLayerId(a);var c=a.getId(),c=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,b,c),e;for(e in c)this._updateOrCreateDirtyRecord(a,
c[e][0],b,2,0,2,0,5,1)};a.prototype.objTransformation=function(a,b){b=b||this._getParentLayerId(a);var c=a.getId(),c=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,b,c),e;for(e in c)this._updateOrCreateDirtyRecord(a,c[e][0],b,2,0,0,2,5,16)};a.prototype.objGeometryAdded=function(a,b,e){this._updateOrCreateDirtyRecord(a,b,e,1,4,0,0,0)};a.prototype.objGeometryRemoved=function(a,b,e){this._updateOrCreateDirtyRecord(a,b,e,4,1,2,0,0)};a.prototype.objGeometryReplaced=function(a,b){this.objGeometryRemoved(a,
b[0]);this.objGeometryAdded(a,b[1])};a.prototype.objGeometryTransformation=function(a,b){this.objGeometryReplaced(a,b)};a.prototype._componentVisibilityChanged=function(a,b,e){this._updateOrCreateDirtyRecord(a,b,e,2,0,0,2,5,2)};a.prototype._updateOrCreateDirtyRecord=function(a,b,e,f,g,m,h,r,n){e=e||this._getParentLayerId(a);var c=a.getId();a=b.getId();e=this._createObjectRecordObjIfNonexistent(this._dirtyGeomRecords,e,c);(c=e[a])?(b=c[1],b&g?delete e[a]:b&m?(c[1]=f,c[2]=n):b&h?c[2]|=n:b&r||l(!1,"ModelDirtySet.objGeometryAdded: inconsistent state")):
e[a]=[b,f,n]};a.prototype._createObjectRecordObjIfNonexistent=function(a,b,e){a[b]||(a[b]={});a[b][e]||(a[b][e]={});return a[b][e]};a.prototype._getParentLayerId=function(a){return a.parentLayer.id};a.prototype.formatDebugInfo=function(a){var b=["ADD","UPD",void 0,"REM"];if(a)return"";a="";for(var c in this._dirtyGeomRecords)for(var e in this._dirtyGeomRecords[c]){var f=this._dirtyGeomRecords[c][e];if(f){0<a.length&&(a+="\n");a+=c+"."+e;var g=[],l;for(l in f){var m=f[l][1];g[m]||(g[m]=[]);g[m].push(f[l][0].geometry.id)}for(f=
0;f<g.length;f++)if(g[f])for(a+=" "+b[f-1]+": ",m=0;m<g[f].length;m++)a+=g[f][m]+", "}}return a};return a}()})},"esri/views/3d/webgl-engine/lib/ModelDirtyTypesTs":function(){define(["require","exports"],function(a,h){})},"esri/views/3d/webgl-engine/lib/Util":function(){define(["./gl-matrix","../../../../core/now"],function(a,h){function p(b){this.message=b}var m=a.vec2d,f=a.vec3d,e=a.vec4d,l=a.mat4d,g=l.create(),c=[e.createFrom(-1,-1,-1,1),e.createFrom(1,-1,-1,1),e.createFrom(1,1,-1,1),e.createFrom(-1,
1,-1,1),e.createFrom(-1,-1,1,1),e.createFrom(1,-1,1,1),e.createFrom(1,1,1,1),e.createFrom(-1,1,1,1)],b=e.create(),q=Array(8);for(a=0;8>a;++a)q[a]=f.create();var x=f.create(),y=f.create(),t=f.create(),u=f.create(),r=f.create(),n=f.create(),w=f.create(),d=f.create(),k=f.create(),v=f.create(),A=f.create(),z=f.create(),D=f.create(),B=f.create();p.prototype.toString=var C={EARTH_RADIUS:6378137,METER2FEET:3.28084,ECCENTRICITY_SQUARED:.0066943799901414,
AssertException:p,VertexAttrConstants:{POSITION:"position",NORMAL:"normal",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SIZE:"size",REGION:"region"},assert:function(b,a){if(!b)throw b=Error("dummy"),b.stack&&console.log(b.stack),new p(a);},verify:function(b,a){b||(console.log("Verify failed: "+a),console.log(Error("dummy").stack))},createQuadVertexUvBuffer:function(b){b=b||Float32Array;b=new b(20);b[0]=-1;b[1]=-1;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=-1;b[7]=0;b[8]=1;b[9]=0;b[10]=-1;b[11]=
1;b[12]=0;b[13]=0;b[14]=1;b[15]=1;b[16]=1;b[17]=0;b[18]=1;b[19]=1;return b},isPowerOfTwo:function(b){return 0===(b&b-1)},lerp:function(b,a,d){return b+(a-b)*d},clamp:function(b,a,d){return b<a?a:b>d?d:b},fallbackIfUndefined:function(b,a){return void 0===b?a:b},hex2rgb:function(b){b=Math.floor(b);return[(b>>16&255)/255,(b>>8&255)/255,(b&255)/255]},rgb2hex:function(b){var a=C.clamp(Math.round(255*b[0]),0,255),d=C.clamp(Math.round(255*b[1]),0,255);b=C.clamp(Math.round(255*b[2]),0,255);return"0x"+((a<<
16)+(d<<8)+b).toString(16)},dec2hex:function(b){b=b.toString(16);return"00000000".substr(0,8-b.length)+b},deg2rad:function(b){return b/180*Math.PI},rad2deg:function(b){return 180*b/Math.PI},azimuthElevationAngle2Direction:function(b,a){b=1.5*Math.PI-b;a=.5*Math.PI-a;return[Math.cos(b)*Math.sin(a),Math.cos(a),Math.sin(b)*Math.sin(a)]},rayPlane:function(b,a,d,c){var e=f.dot(d,a);if(0===e)return!1;d=-(f.dot(d,b)+d[3])/e;f.add(b,f.scale(a,d,c),c);return!0},raySphereClosestPositive:function(b,a,d,c){var e=
f.dot(a,a),k=2*f.dot(a,b);d=f.dot(b,b)-d*d;d=k*k-4*e*d;if(0>d)return!1;var g=Math.sqrt(d);d=(-k-g)/(2*e);e=(-k+g)/(2*e);if(0>d||e<d&&0<e)d=e;return 0<d?(f.add(b,f.scale(a,d,c),c),!0):!1},rayTriangle3D:function(b,a,d,c,e,k,g,n,l){l||(l=f.create());var m=c[g]-d[k],v=c[g+1]-d[k+1],h=c[g+2]-d[k+2];c=e[n]-d[k];g=e[n+1]-d[k+1];e=e[n+2]-d[k+2];var q=a[1]*e-g*a[2],r=a[2]*c-e*a[0],t=a[0]*g-c*a[1];n=m*q+v*r+h*t;if(-1E-5<n&&1E-5>n)return!1;n=1/n;var w=b[0]-d[k],u=b[1]-d[k+1];b=b[2]-d[k+2];l[1]=n*(w*q+u*r+b*
t);if(0>l[1]||1<l[1])return!1;d=u*h-v*b;b=b*m-h*w;m=w*v-m*u;l[2]=n*(a[0]*d+a[1]*b+a[2]*m);if(0>l[2]||1<l[1]+l[2])return!1;l[0]=n*(c*d+g*b+e*m);return!0},rayBoxTest:function(b,a,d,c){var e,k=(d[0]-b[0])/a[0],f=(c[0]-b[0])/a[0];k>f&&(e=k,k=f,f=e);var g=(d[1]-b[1])/a[1],n=(c[1]-b[1])/a[1];g>n&&(e=g,g=n,n=e);if(k>n||g>f)return!1;g>k&&(k=g);n<f&&(f=n);d=(d[2]-b[2])/a[2];b=(c[2]-b[2])/a[2];d>b&&(e=d,d=b,b=e);if(k>b||d>f)return!1;b<f&&(f=b);return 0>f?!1:!0},rayRay2D:function(b,a,d,c,e,k){k||(k=m.create());
var f=(c[e]-d[e])*(a[0]-b[0])-(c[0]-d[0])*(a[e]-b[e]);if(0===f)return!1;d=((c[0]-d[0])*(b[e]-d[e])-(c[e]-d[e])*(b[0]-d[0]))/f;k[0]=b[0]+d*(a[0]-b[0]);k[1]=b[e]+d*(a[e]-b[e]);return!0},matrix2frustum:function(a,d,e){l.multiply(d,a,g);l.inverse(g);for(a=0;8>a;++a)l.multiplyVec4(g,c[a],b),f.set3(b[0]/b[3],b[1]/b[3],b[2]/b[3],e[a])},matrix2frustumPlanes:function(b,a,d,c){void 0===c&&(c=d,d=q);C.matrix2frustum(b,a,d);C.point2plane(d[4],d[0],d[3],c[0]);C.point2plane(d[1],d[5],d[6],c[1]);C.point2plane(d[4],
d[5],d[1],c[2]);C.point2plane(d[3],d[2],d[6],c[3]);C.point2plane(d[0],d[1],d[2],c[4]);C.point2plane(d[5],d[4],d[7],c[5])},point2plane:function(b,a,d,c){f.subtract(b,a,x);f.subtract(d,a,y);f.cross(y,x,c);f.normalize(c);c[3]=-f.dot(c,b)},project:function(a,d,c,e,k){k||(k=a);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=1;l.multiplyVec4(d,b);2<k.length&&(k[2]=-b[2]);l.multiplyVec4(c,b);C.assert(0!==b[3]);k[0]=b[0]/b[3];k[1]=b[1]/b[3];k[2]=b[2]/b[3];k[0]=(.5*k[0]+.5)*e[2]+e[0];k[1]=(.5*k[1]+.5)*e[3]+e[1]},geodeticToGeocentricLatidude:function(b){return Math.atan((1-
C.ECCENTRICITY_SQUARED)*Math.tan(b))},latLon2positionWGS84Ellipsoid:function(b,a,d,c){var e=6378137/Math.sqrt(1-C.ECCENTRICITY_SQUARED*Math.pow(Math.sin(b),2)),k=Math.cos(b);c[0]=(e+d)*Math.cos(a)*k;c[1]=(e*(1-C.ECCENTRICITY_SQUARED)+d)*Math.sin(b);c[2]=-(e+d)*Math.sin(a)*k},pos2latLon:function(b,a){var d=f.length(b);a[0]=Math.asin(C.clamp(b[1]/d,-1,1));a[1]=(0>b[2]?1:-1)*Math.acos(C.clamp(b[0]/(Math.cos(a[0])*d),-1,1));a[0]=C.rad2deg(a[0]);a[1]=C.rad2deg(a[1]);a[2]=d},pos2latLonWGS84Ellipsoid:function(b,
a){var d=b[0],c=-b[2],e=b[1],k=Math.sqrt(Math.pow(6378137,2)*(1-C.ECCENTRICITY_SQUARED));b=Math.sqrt(Math.pow(d,2)+Math.pow(c,2));var f=Math.atan2(6378137*e,k*b),d=Math.atan2(c,d),c=Math.atan2(e+Math.pow(Math.sqrt((Math.pow(6378137,2)-Math.pow(k,2))/Math.pow(k,2)),2)*k*Math.pow(Math.sin(f),3),b-6378137*C.ECCENTRICITY_SQUARED*Math.pow(Math.cos(f),3));b=b/Math.cos(c)-6378137/Math.sqrt(1-C.ECCENTRICITY_SQUARED*Math.pow(Math.sin(c),2))+C.EARTH_RADIUS;a[0]=c;a[1]=d;a[2]=b},computeGlobeTransformation:function(b,
a,d){var c=C.deg2rad(b[0]);b=C.deg2rad(b[1]);C.latLon2position(c,b,t,a);l.translate(d,t);l.rotateY(d,.5*Math.PI+b);l.rotateX(d,.5*Math.PI-c);return d},readUInt16:function(b,a){return b[a]+(b[a+1]<<8)},readUInt32:setIfDefined:array2object:function(b,a){var d={},c,e;if(void 0!==a)for(c=0,e=b.length;c<e;++c)d[a(b[c])]=b[c];else for(c=0,e=b.length;c<e;++c)d[b[c]]=b[c];return d},object2array:mergeObjects:function(b,a,d){void 0===d&&(d={});var c;if(d!==b)for(c in b)d[c]=b[c];if(d!==a)for(c in a)d[c]=a[c];return d},subtractObjects:function(b,a){var d={},c;for(c in b)void 0===a[c]&&(d[c]=b[c]);return d},intersectObjects:function(b,a){var d={},c;for(c in b)void 0!==a[c]&&(d[c]=b[c]);return d},getFirstObjectKey:getFirstObjectValue:objectEmpty:arraysEqual:arrayRemove:function(b,a){var d=b.indexOf(a);return-1!==d?(b[d]=b[b.length-1],b.pop(),a):null},byteBuffer2base64image:function(b,a,d,c,e){var k=4*a;C.assert(b.length===k*d,"buffer length must match image resolution");var f=document.createElement("canvas");f.width=a;f.height=d;var g=f.getContext("2d");a=g.getImageData(0,0,a,d);for(var n=a.data,l=0;l<d;++l)for(var m=l*
k,v=(d-1-l)*k,h=0;h<k;++h)n[m++]=b[v++];g.putImageData(a,0,0);return f.toDataURL(c,e)},cround:logWithBase:setMatrixTranslation:setMatrixTranslation3:function(b,a,d,c){b[12]=a;b[13]=d;b[14]=c},getMatrixTranslation:function(b,a){a=a||f.create();a[0]=b[12];a[1]=b[13];a[2]=b[14];return a},createTranslationMatrix:function(b,a){b=l.identity(b);C.setMatrixTranslation(b,
a);return b},fovx2fovy:function(b,a,d){return 2*Math.atan(d*Math.tan(.5*b)/a)},fovy2fovx:function(b,a,d){return 2*Math.atan(a*Math.tan(.5*b)/d)},fovx2fovd:function(b,a,d){return 2*Math.atan(Math.sqrt(a*a+d*d)*Math.tan(.5*b)/a)},fovy2fovd:function(b,a,d){return 2*Math.atan(Math.sqrt(a*a+d*d)*Math.tan(.5*b)/d)},fovd2fovx:function(b,a,d){return 2*Math.atan(a*Math.tan(.5*b)/Math.sqrt(a*a+d*d))},fovd2fovy:function(b,a,d){return 2*Math.atan(d*Math.tan(.5*b)/Math.sqrt(a*a+d*d))},nextHighestPowerOfTwo:linelineDistance3D:function(b,a,c,e){var k,g,l;u[0]=b[0]-c[0];u[1]=b[1]-c[1];u[2]=b[2]-c[2];r[0]=e[0]-c[0];r[1]=e[1]-c[1];r[2]=e[2]-c[2];if(1E-4>Math.abs(r.x)&&1E-4>Math.abs(r.y)&&1E-4>Math.abs(r.z))return[!1];n[0]=a[0]-b[0];n[1]=a[1]-b[1];n[2]=a[2]-b[2];if(1E-4>Math.abs(n.x)&&1E-4>Math.abs(n.y)&&1E-4>Math.abs(n.z))return[!1];a=u[0]*r[0]+u[1]*r[1]+u[2]*r[2];e=r[0]*n[0]+r[1]*n[1]+r[2]*n[2];k=u[0]*n[0]+u[1]*n[1]+u[2]*n[2];g=r[0]*r[0]+r[1]*r[1]+r[2]*r[2];l=
(n[0]*n[0]+n[1]*n[1]+n[2]*n[2])*g-e*e;if(1E-4>Math.abs(l))return[!1];k=(a*e-k*g)/l;a=(a+e*k)/g;w[0]=b[0]+k*n[0];w[1]=b[1]+k*n[1];w[2]=b[2]+k*n[2];d[0]=c[0]+a*r[0];d[1]=c[1]+a*r[1];d[2]=c[2]+a*r[2];return[!0,f.dist(w,d),w,d]},projectVectorVector2D:function(b,a,d){z[0]=a[0]-b[0];z[1]=a[1]-b[1];z[2]=0;D[0]=d[0]-b[0];D[1]=d[1]-b[1];D[2]=0;B[0]=d[0];B[1]=d[1];B[2]=0;a=f.dot(D,z);d=f.length(z);a/=d*d;A[0]=z[0]*a;A[1]=z[1]*a;k[0]=b[0]+A[0];k[1]=b[1]+A[1];f.subtract(B,k,v);b=f.length(v);a=f.length(D);d=f.length(z);
var c=f.length(A);if(c>a||c>d)b=Number.MAX_VALUE;return b}};C.performance={now:h};return C})},"esri/views/3d/webgl-engine/lib/gl-matrix":function(){define([],function(){var a={};(function(a,p){p(a,!0);p(a,!1)})(a,function(a,p){var m={};(function(){if("undefined"!=typeof Float32Array){var b=new Float32Array(1),a=new Int32Array(b.buffer);m.invsqrt=function(d){b[0]=d;a[0]=1597463007-(a[0]>>1);var c=b[0];return c*(1.5-.5*d*c*c)}}else m.invsqrt=function(b){return 1/Math.sqrt(b)}})();var f=Array;"undefined"!=
typeof Float32Array&&(f=p?Float32Array:Array);var e={create:function(b){var a=new f(3);b?(a[0]=b[0],a[1]=b[1],a[2]=b[2]):a[0]=a[1]=a[2]=0;return a},createFrom:function(b,a,c){var d=new f(3);d[0]=b;d[1]=a;d[2]=c;return d},set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set3:function(b,a,c,e){e[0]=b;e[1]=a;e[2]=c;return e},add:function(b,a,c){if(!c||b===c)return b[0]+=a[0],b[1]+=a[1],b[2]+=a[2],b;c[0]=b[0]+a[0];c[1]=b[1]+a[1];c[2]=b[2]+a[2];return c},subtract:function(b,a,c){if(!c||b===c)return b[0]-=
a[0],b[1]-=a[1],b[2]-=a[2],b;c[0]=b[0]-a[0];c[1]=b[1]-a[1];c[2]=b[2]-a[2];return c},multiply:function(b,a,c){if(!c||b===c)return b[0]*=a[0],b[1]*=a[1],b[2]*=a[2],b;c[0]=b[0]*a[0];c[1]=b[1]*a[1];c[2]=b[2]*a[2];return c},max:function(b,a,c){c[0]=Math.max(b[0],a[0]);c[1]=Math.max(b[1],a[1]);c[2]=Math.max(b[2],a[2]);return c},min:function(b,a,c){c[0]=Math.min(b[0],a[0]);c[1]=Math.min(b[1],a[1]);c[2]=Math.min(b[2],a[2]);return c},negate:function(b,a){a||(a=b);a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a},
scale:function(b,a,c){if(!c||b===c)return b[0]*=a,b[1]*=a,b[2]*=a,b;c[0]=b[0]*a;c[1]=b[1]*a;c[2]=b[2]*a;return c},normalize:function(b,a){a||(a=b);var d=b[0],c=b[1];b=b[2];var e=Math.sqrt(d*d+c*c+b*b);if(!e)return a[0]=0,a[1]=0,a[2]=0,a;if(1===e)return a[0]=d,a[1]=c,a[2]=b,a;e=1/e;a[0]=d*e;a[1]=c*e;a[2]=b*e;return a},cross:function(b,a,c){c||(c=b);var d=b[0],e=b[1];b=b[2];var k=a[0],f=a[1];a=a[2];c[0]=e*a-b*f;c[1]=b*k-d*a;c[2]=d*f-e*k;return c},length:function(b){var a=b[0],d=b[1];b=b[2];return Math.sqrt(a*
a+d*d+b*b)},length2:function(b){var a=b[0],d=b[1];b=b[2];return a*a+d*d+b*b},dot:function(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]},direction:function(b,a,c){c||(c=b);var d=b[0]-a[0],e=b[1]-a[1];b=b[2]-a[2];a=Math.sqrt(d*d+e*e+b*b);if(!a)return c[0]=0,c[1]=0,c[2]=0,c;a=1/a;c[0]=d*a;c[1]=e*a;c[2]=b*a;return c},lerp:function(b,a,c,e){e||(e=b);e[0]=b[0]+c*(a[0]-b[0]);e[1]=b[1]+c*(a[1]-b[1]);e[2]=b[2]+c*(a[2]-b[2]);return e},dist:function(b,a){var d=a[0]-b[0],c=a[1]-b[1];b=a[2]-b[2];return Math.sqrt(d*
d+c*c+b*b)},dist2:function(b,a){var d=a[0]-b[0],c=a[1]-b[1];b=a[2]-b[2];return d*d+c*c+b*b}},l=null,g=new f(4);e.unproject=function(b,a,c,e,f){f||(f=b);l||(l=u.create());var d=l;g[0]=2*(b[0]-e[0])/e[2]-1;g[1]=2*(b[1]-e[1])/e[3]-1;g[2]=2*b[2]-1;g[3]=1;u.multiply(c,a,d);if(!u.inverse(d))return null;u.multiplyVec4(d,g);if(0===g[3])return null;f[0]=g[0]/g[3];f[1]=g[1]/g[3];f[2]=g[2]/g[3];return f};var c=e.createFrom(1,0,0),b=e.createFrom(0,1,0),h=e.createFrom(0,0,1);e.rotationTo=function(a,k,f){f||(f=
r.create());var d=e.dot(a,k),g=e.create();if(1<=d)r.set(n,f);else if(-.999999>d)e.cross(c,a,g),1E-6>g.length&&e.cross(b,a,g),1E-6>g.length&&e.cross(h,a,g),e.normalize(g),r.fromAxisAngle(g,Math.PI,f);else{var d=Math.sqrt(2*(1+d)),l=1/d;e.cross(a,k,g);f[0]=g[0]*l;f[1]=g[1]*l;f[2]=g[2]*l;f[3]=.5*d;r.normalize(f)}1<f[3]?f[3]=1:-1>f[3]&&(f[3]=-1);return f};var x=e.create(),y=e.create();e.project=function(b,a,c,f){f||(f=b);e.direction(a,c,x);e.subtract(b,a,y);b=e.dot(x,y);e.scale(x,b,f);e.add(f,a,f)};e.str=
function(b){return"["+b[0]+", "+b[1]+", "+b[2]+"]"};var t={create:function(b){var a=new f(9);b?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8]):a[0]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=0;return a},createFrom:function(b,a,c,e,g,n,l,m,h){var d=new f(9);d[0]=b;d[1]=a;d[2]=c;d[3]=e;d[4]=g;d[5]=n;d[6]=l;d[7]=m;d[8]=h;return d},determinant:function(b){var a=b[3],d=b[4],c=b[5],e=b[6],f=b[7],g=b[8];return b[0]*(g*d-c*f)+b[1]*(-g*a+c*e)+b[2]*(f*a-d*e)},inverse:function(b,
a){var d=b[0],c=b[1],e=b[2],k=b[3],f=b[4],g=b[5],n=b[6],l=b[7];b=b[8];var m=b*f-g*l,h=-b*k+g*n,r=l*k-f*n,q=d*m+c*h+e*r;if(!q)return null;q=1/q;a||(a=t.create());a[0]=m*q;a[1]=(-b*c+e*l)*q;a[2]=(g*c-e*f)*q;a[3]=h*q;a[4]=(b*d-e*n)*q;a[5]=(-g*d+e*k)*q;a[6]=r*q;a[7]=(-l*d+c*n)*q;a[8]=(f*d-c*k)*q;return a},multiply:function(b,a,c){c||(c=b);var d=b[0],e=b[1],k=b[2],f=b[3],g=b[4],n=b[5],l=b[6],m=b[7];b=b[8];var v=a[0],h=a[1],q=a[2],r=a[3],t=a[4],w=a[5],u=a[6],p=a[7];a=a[8];c[0]=v*d+h*f+q*l;c[1]=v*e+h*g+
q*m;c[2]=v*k+h*n+q*b;c[3]=r*d+t*f+w*l;c[4]=r*e+t*g+w*m;c[5]=r*k+t*n+w*b;c[6]=u*d+p*f+a*l;c[7]=u*e+p*g+a*m;c[8]=u*k+p*n+a*b;return c},multiplyVec2:function(b,a,c){c||(c=a);var d=a[0];a=a[1];c[0]=d*b[0]+a*b[3]+b[6];c[1]=d*b[1]+a*b[4]+b[7];return c},multiplyVec3:function(b,a,c){c||(c=a);var d=a[0],e=a[1];a=a[2];c[0]=d*b[0]+e*b[3]+a*b[6];c[1]=d*b[1]+e*b[4]+a*b[7];c[2]=d*b[2]+e*b[5]+a*b[8];return c},set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=
b[8];return a},identity:function(b){b||(b=t.create());b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b},transpose:function(b,a){if(!a||b===a){a=b[1];var d=b[2],c=b[5];b[1]=b[3];b[2]=b[6];b[3]=a;b[5]=b[7];b[6]=d;b[7]=c;return b}a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return a},toMat4:function(b,a){a||(a=u.create());a[15]=1;a[14]=0;a[13]=0;a[12]=0;a[11]=0;a[10]=b[8];a[9]=b[7];a[8]=b[6];a[7]=0;a[6]=b[5];a[5]=b[4];a[4]=b[3];a[3]=
0;a[2]=b[2];a[1]=b[1];a[0]=b[0];return a},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+"]"}},u={create:function(b){var a=new f(16);4===arguments.length?(a[0]=arguments[0],a[1]=arguments[1],a[2]=arguments[2],a[3]=arguments[3],a[4]=arguments[4],a[5]=arguments[5],a[6]=arguments[6],a[7]=arguments[7],a[8]=arguments[8],a[9]=arguments[9],a[10]=arguments[10],a[11]=arguments[11],a[12]=arguments[12],a[13]=arguments[13],a[14]=arguments[14],a[15]=
arguments[15]):b&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a},createFrom:function(b,a,c,e,g,n,l,m,h,q,r,t,w,u,p,x){var d=new f(16);d[0]=b;d[1]=a;d[2]=c;d[3]=e;d[4]=g;d[5]=n;d[6]=l;d[7]=m;d[8]=h;d[9]=q;d[10]=r;d[11]=t;d[12]=w;d[13]=u;d[14]=p;d[15]=x;return d},createFromMatrixRowMajor:function(b){var a=new f(16);a[0]=b[0];a[4]=b[1];a[8]=b[2];a[12]=b[3];a[1]=b[4];
a[5]=b[5];a[9]=b[6];a[13]=b[7];a[2]=b[8];a[6]=b[9];a[10]=b[10];a[14]=b[11];a[3]=b[12];a[7]=b[13];a[11]=b[14];a[15]=b[15];return a},createFromMatrix:function(b){var a=new f(16);a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=
b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},setRowMajor:function(b,a){a[0]=b[0];a[4]=b[1];a[8]=b[2];a[12]=b[3];a[1]=b[4];a[5]=b[5];a[9]=b[6];a[13]=b[7];a[2]=b[8];a[6]=b[9];a[10]=b[10];a[14]=b[11];a[3]=b[12];a[7]=b[13];a[11]=b[14];a[15]=b[15];return a},identity:function(b){b||(b=u.create());b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},transpose:function(b,a){if(!a||b===a){a=b[1];var d=b[2],c=b[3],e=b[6],k=b[7],
f=b[11];b[1]=b[4];b[2]=b[8];b[3]=b[12];b[4]=a;b[6]=b[9];b[7]=b[13];b[8]=d;b[9]=e;b[11]=b[14];b[12]=c;b[13]=k;b[14]=f;return b}a[0]=b[0];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=b[1];a[5]=b[5];a[6]=b[9];a[7]=b[13];a[8]=b[2];a[9]=b[6];a[10]=b[10];a[11]=b[14];a[12]=b[3];a[13]=b[7];a[14]=b[11];a[15]=b[15];return a},determinant:function(b){var a=b[0],d=b[1],c=b[2],e=b[3],f=b[4],g=b[5],n=b[6],l=b[7],m=b[8],h=b[9],q=b[10],r=b[11],t=b[12],w=b[13],u=b[14];b=b[15];return t*h*n*e-m*w*n*e-t*g*q*e+f*w*q*e+m*g*u*e-
f*h*u*e-t*h*c*l+m*w*c*l+t*d*q*l-a*w*q*l-m*d*u*l+a*h*u*l+t*g*c*r-f*w*c*r-t*d*n*r+a*w*n*r+f*d*u*r-a*g*u*r-m*g*c*b+f*h*c*b+m*d*n*b-a*h*n*b-f*d*q*b+a*g*q*b},inverse:function(b,a){a||(a=b);var d=b[0],c=b[1],e=b[2],k=b[3],f=b[4],g=b[5],n=b[6],l=b[7],m=b[8],h=b[9],q=b[10],r=b[11],t=b[12],w=b[13],u=b[14];b=b[15];var p=d*g-c*f,x=d*n-e*f,y=d*l-k*f,R=c*n-e*g,U=c*l-k*g,T=e*l-k*n,N=m*w-h*t,Z=m*u-q*t,H=m*b-r*t,O=h*u-q*w,aa=h*b-r*w,ba=q*b-r*u,X=p*ba-x*aa+y*O+R*H-U*Z+T*N;if(!X)return null;X=1/X;a[0]=(g*ba-n*aa+l*
O)*X;a[1]=(-c*ba+e*aa-k*O)*X;a[2]=(w*T-u*U+b*R)*X;a[3]=(-h*T+q*U-r*R)*X;a[4]=(-f*ba+n*H-l*Z)*X;a[5]=(d*ba-e*H+k*Z)*X;a[6]=(-t*T+u*y-b*x)*X;a[7]=(m*T-q*y+r*x)*X;a[8]=(f*aa-g*H+l*N)*X;a[9]=(-d*aa+c*H-k*N)*X;a[10]=(t*U-w*y+b*p)*X;a[11]=(-m*U+h*y-r*p)*X;a[12]=(-f*O+g*Z-n*N)*X;a[13]=(d*O-c*Z+e*N)*X;a[14]=(-t*R+w*x-u*p)*X;a[15]=(m*R-h*x+q*p)*X;return a},toRotationMat:function(b,a){a||(a=u.create());a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=
b[10];a[11]=b[11];a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},toMat3:function(b,a){a||(a=t.create());a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},toInverseMat3:function(b,a){var d=b[0],c=b[1],e=b[2],k=b[4],f=b[5],g=b[6],n=b[8],l=b[9];b=b[10];var m=b*f-g*l,h=-b*k+g*n,q=l*k-f*n,r=d*m+c*h+e*q;if(!r)return null;r=1/r;a||(a=t.create());a[0]=m*r;a[1]=(-b*c+e*l)*r;a[2]=(g*c-e*f)*r;a[3]=h*r;a[4]=(b*d-e*n)*r;a[5]=(-g*d+e*k)*r;a[6]=q*r;a[7]=(-l*d+c*n)*r;
a[8]=(f*d-c*k)*r;return a},multiply:function(b,a,c){c||(c=b);var d=b[0],e=b[1],k=b[2],f=b[3],g=b[4],n=b[5],l=b[6],m=b[7],h=b[8],v=b[9],r=b[10],q=b[11],t=b[12],w=b[13],u=b[14];b=b[15];var p=a[0],x=a[1],y=a[2],U=a[3],T=a[4],N=a[5],Z=a[6],H=a[7],O=a[8],aa=a[9],ba=a[10],X=a[11],ea=a[12],la=a[13],ta=a[14];a=a[15];c[0]=p*d+x*g+y*h+U*t;c[1]=p*e+x*n+y*v+U*w;c[2]=p*k+x*l+y*r+U*u;c[3]=p*f+x*m+y*q+U*b;c[4]=T*d+N*g+Z*h+H*t;c[5]=T*e+N*n+Z*v+H*w;c[6]=T*k+N*l+Z*r+H*u;c[7]=T*f+N*m+Z*q+H*b;c[8]=O*d+aa*g+ba*h+X*t;
c[9]=O*e+aa*n+ba*v+X*w;c[10]=O*k+aa*l+ba*r+X*u;c[11]=O*f+aa*m+ba*q+X*b;c[12]=ea*d+la*g+ta*h+a*t;c[13]=ea*e+la*n+ta*v+a*w;c[14]=ea*k+la*l+ta*r+a*u;c[15]=ea*f+la*m+ta*q+a*b;return c},multiplyVec3:function(b,a,c){c||(c=a);var d=a[0],e=a[1];a=a[2];c[0]=b[0]*d+b[4]*e+b[8]*a+b[12];c[1]=b[1]*d+b[5]*e+b[9]*a+b[13];c[2]=b[2]*d+b[6]*e+b[10]*a+b[14];return c},multiplyVec4:function(b,a,c){c||(c=a);var d=a[0],e=a[1],k=a[2];a=a[3];c[0]=b[0]*d+b[4]*e+b[8]*k+b[12]*a;c[1]=b[1]*d+b[5]*e+b[9]*k+b[13]*a;c[2]=b[2]*d+
b[6]*e+b[10]*k+b[14]*a;c[3]=b[3]*d+b[7]*e+b[11]*k+b[15]*a;return c},translate:function(b,a,c){var d=a[0],e=a[1];a=a[2];var k,f,g,n,l,m,h,r,q,v,t,w;if(!c||b===c)return b[12]=b[0]*d+b[4]*e+b[8]*a+b[12],b[13]=b[1]*d+b[5]*e+b[9]*a+b[13],b[14]=b[2]*d+b[6]*e+b[10]*a+b[14],b[15]=b[3]*d+b[7]*e+b[11]*a+b[15],b;k=b[0];f=b[1];g=b[2];n=b[3];l=b[4];m=b[5];h=b[6];r=b[7];q=b[8];v=b[9];t=b[10];w=b[11];c[0]=k;c[1]=f;c[2]=g;c[3]=n;c[4]=l;c[5]=m;c[6]=h;c[7]=r;c[8]=q;c[9]=v;c[10]=t;c[11]=w;c[12]=k*d+l*e+q*a+b[12];c[13]=
f*d+m*e+v*a+b[13];c[14]=g*d+h*e+t*a+b[14];c[15]=n*d+r*e+w*a+b[15];return c},scale:function(b,a,c){var d=a[0],e=a[1];a=a[2];if(!c||b===c)return b[0]*=d,b[1]*=d,b[2]*=d,b[3]*=d,b[4]*=e,b[5]*=e,b[6]*=e,b[7]*=e,b[8]*=a,b[9]*=a,b[10]*=a,b[11]*=a,b;c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[3]=b[3]*d;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[7]=b[7]*e;c[8]=b[8]*a;c[9]=b[9]*a;c[10]=b[10]*a;c[11]=b[11]*a;c[12]=b[12];c[13]=b[13];c[14]=b[14];c[15]=b[15];return c},maxScale:function(b){return Math.max(Math.max(Math.sqrt(b[0]*
b[0]+b[4]*b[4]+b[8]*b[8]),Math.sqrt(b[1]*b[1]+b[5]*b[5]+b[9]*b[9])),Math.sqrt(b[2]*b[2]+b[6]*b[6]+b[10]*b[10]))},rotate:function(b,a,c,e){var d=c[0],k=c[1];c=c[2];var f=Math.sqrt(d*d+k*k+c*c),g,n,l,m,h,r,q,v,t,w,u,p,x,A,y,T,N,Z,H,O;if(!f)return null;1!==f&&(f=1/f,d*=f,k*=f,c*=f);g=Math.sin(a);n=Math.cos(a);l=1-n;a=b[0];f=b[1];m=b[2];h=b[3];r=b[4];q=b[5];v=b[6];t=b[7];w=b[8];u=b[9];p=b[10];x=b[11];A=d*d*l+n;y=k*d*l+c*g;T=c*d*l-k*g;N=d*k*l-c*g;Z=k*k*l+n;H=c*k*l+d*g;O=d*c*l+k*g;d=k*c*l-d*g;k=c*c*l+n;
e?b!==e&&(e[12]=b[12],e[13]=b[13],e[14]=b[14],e[15]=b[15]):e=b;e[0]=a*A+r*y+w*T;e[1]=f*A+q*y+u*T;e[2]=m*A+v*y+p*T;e[3]=h*A+t*y+x*T;e[4]=a*N+r*Z+w*H;e[5]=f*N+q*Z+u*H;e[6]=m*N+v*Z+p*H;e[7]=h*N+t*Z+x*H;e[8]=a*O+r*d+w*k;e[9]=f*O+q*d+u*k;e[10]=m*O+v*d+p*k;e[11]=h*O+t*d+x*k;return e},rotateX:function(b,a,c){var d=Math.sin(a);a=Math.cos(a);var e=b[4],k=b[5],f=b[6],g=b[7],n=b[8],l=b[9],m=b[10],h=b[11];c?b!==c&&(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]):c=b;c[4]=
e*a+n*d;c[5]=k*a+l*d;c[6]=f*a+m*d;c[7]=g*a+h*d;c[8]=e*-d+n*a;c[9]=k*-d+l*a;c[10]=f*-d+m*a;c[11]=g*-d+h*a;return c},rotateY:function(b,a,c){var d=Math.sin(a);a=Math.cos(a);var e=b[0],k=b[1],f=b[2],g=b[3],n=b[8],l=b[9],m=b[10],h=b[11];c?b!==c&&(c[4]=b[4],c[5]=b[5],c[6]=b[6],c[7]=b[7],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]):c=b;c[0]=e*a+n*-d;c[1]=k*a+l*-d;c[2]=f*a+m*-d;c[3]=g*a+h*-d;c[8]=e*d+n*a;c[9]=k*d+l*a;c[10]=f*d+m*a;c[11]=g*d+h*a;return c},rotateZ:function(b,a,c){var d=Math.sin(a);a=Math.cos(a);
var e=b[0],k=b[1],f=b[2],g=b[3],n=b[4],l=b[5],m=b[6],h=b[7];c?b!==c&&(c[8]=b[8],c[9]=b[9],c[10]=b[10],c[11]=b[11],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]):c=b;c[0]=e*a+n*d;c[1]=k*a+l*d;c[2]=f*a+m*d;c[3]=g*a+h*d;c[4]=e*-d+n*a;c[5]=k*-d+l*a;c[6]=f*-d+m*a;c[7]=g*-d+h*a;return c},frustum:function(b,a,c,e,f,g,n){n||(n=u.create());var d=a-b,k=e-c,l=g-f;n[0]=2*f/d;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=2*f/k;n[6]=0;n[7]=0;n[8]=(a+b)/d;n[9]=(e+c)/k;n[10]=-(g+f)/l;n[11]=-1;n[12]=0;n[13]=0;n[14]=-(g*f*2)/
l;n[15]=0;return n},perspective:function(b,a,c,e,f){b=c*Math.tan(b*Math.PI/360);a*=b;return u.frustum(-a,a,-b,b,c,e,f)},ortho:function(b,a,c,e,f,g,n){n||(n=u.create());var d=a-b,k=e-c,l=g-f;n[0]=2/d;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=2/k;n[6]=0;n[7]=0;n[8]=0;n[9]=0;n[10]=-2/l;n[11]=0;n[12]=-(b+a)/d;n[13]=-(e+c)/k;n[14]=-(g+f)/l;n[15]=1;return n},lookAt:function(b,a,c,e){e||(e=u.create());var d,k,f,g,n,l,m,h,r=b[0],q=b[1];b=b[2];f=c[0];g=c[1];k=c[2];m=a[0];c=a[1];d=a[2];if(r===m&&q===c&&b===d)return u.identity(e);
a=r-m;c=q-c;m=b-d;h=1/Math.sqrt(a*a+c*c+m*m);a*=h;c*=h;m*=h;d=g*m-k*c;k=k*a-f*m;f=f*c-g*a;(h=Math.sqrt(d*d+k*k+f*f))?(h=1/h,d*=h,k*=h,f*=h):f=k=d=0;g=c*f-m*k;n=m*d-a*f;l=a*k-c*d;(h=Math.sqrt(g*g+n*n+l*l))?(h=1/h,g*=h,n*=h,l*=h):l=n=g=0;e[0]=d;e[1]=g;e[2]=a;e[3]=0;e[4]=k;e[5]=n;e[6]=c;e[7]=0;e[8]=f;e[9]=l;e[10]=m;e[11]=0;e[12]=-(d*r+k*q+f*b);e[13]=-(g*r+n*q+l*b);e[14]=-(a*r+c*q+m*b);e[15]=1;return e},fromRotationTranslation:function(b,a,c){c||(c=u.create());var d=b[0],e=b[1],k=b[2],f=b[3],g=d+d,n=
e+e,l=k+k;b=d*g;var m=d*n,d=d*l,h=e*n,e=e*l,k=k*l,g=f*g,n=f*n,f=f*l;c[0]=1-(h+k);c[1]=m+f;c[2]=d-n;c[3]=0;c[4]=m-f;c[5]=1-(b+k);c[6]=e+g;c[7]=0;c[8]=d+n;c[9]=e-g;c[10]=1-(b+h);c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+", "+b[9]+", "+b[10]+", "+b[11]+", "+b[12]+", "+b[13]+", "+b[14]+", "+b[15]+"]"}},r={create:function(b){var a=new f(4);b?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=
b[3]):a[0]=a[1]=a[2]=a[3]=0;return a},createFrom:function(b,a,c,e){var d=new f(4);d[0]=b;d[1]=a;d[2]=c;d[3]=e;return d},set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},identity:function(b){b||(b=r.create());b[0]=0;b[1]=0;b[2]=0;b[3]=1;return b}},n=r.identity();r.calculateW=function(b,a){var d=b[0],c=b[1],e=b[2];if(!a||b===a)return b[3]=-Math.sqrt(Math.abs(1-d*d-c*c-e*e)),b;a[0]=d;a[1]=c;a[2]=e;a[3]=-Math.sqrt(Math.abs(1-d*d-c*c-e*e));return a};r.dot=function(b,a){return b[0]*a[0]+
b[1]*a[1]+b[2]*a[2]+b[3]*a[3]};r.inverse=function(b,a){var d=b[0],c=b[1],e=b[2],k=b[3],d=(d=d*d+c*c+e*e+k*k)?1/d:0;if(!a||b===a)return b[0]*=-d,b[1]*=-d,b[2]*=-d,b[3]*=d,b;a[0]=-b[0]*d;a[1]=-b[1]*d;a[2]=-b[2]*d;a[3]=b[3]*d;return a};r.conjugate=function(b,a){if(!a||b===a)return b[0]*=-1,b[1]*=-1,b[2]*=-1,b;a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};r.length=function(b){var a=b[0],d=b[1],c=b[2];b=b[3];return Math.sqrt(a*a+d*d+c*c+b*b)};r.normalize=function(b,a){a||(a=b);var d=b[0],c=b[1],
e=b[2];b=b[3];var k=Math.sqrt(d*d+c*c+e*e+b*b);if(0===k)return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a;k=1/k;a[0]=d*k;a[1]=c*k;a[2]=e*k;a[3]=b*k;return a};r.add=function(b,a,c){if(!c||b===c)return b[0]+=a[0],b[1]+=a[1],b[2]+=a[2],b[3]+=a[3],b;c[0]=b[0]+a[0];c[1]=b[1]+a[1];c[2]=b[2]+a[2];c[3]=b[3]+a[3];return c};r.multiply=function(b,a,c){c||(c=b);var d=b[0],e=b[1],k=b[2];b=b[3];var f=a[0],g=a[1],n=a[2];a=a[3];c[0]=d*a+b*f+e*n-k*g;c[1]=e*a+b*g+k*f-d*n;c[2]=k*a+b*n+d*g-e*f;c[3]=b*a-d*f-e*g-k*n;return c};r.multiplyVec3=
function(b,a,c){c||(c=a);var d=a[0],e=a[1],k=a[2];a=b[0];var f=b[1],g=b[2];b=b[3];var n=b*d+f*k-g*e,l=b*e+g*d-a*k,m=b*k+a*e-f*d,d=-a*d-f*e-g*k;c[0]=n*b+d*-a+l*-g-m*-f;c[1]=l*b+d*-f+m*-a-n*-g;c[2]=m*b+d*-g+n*-f-l*-a;return c};r.scale=function(b,a,c){if(!c||b===c)return b[0]*=a,b[1]*=a,b[2]*=a,b[3]*=a,b;c[0]=b[0]*a;c[1]=b[1]*a;c[2]=b[2]*a;c[3]=b[3]*a;return c};r.toMat3=function(b,a){a||(a=t.create());var d=b[0],c=b[1],e=b[2],k=b[3],f=d+d,g=c+c,n=e+e;b=d*f;var l=d*g,d=d*n,m=c*g,c=c*n,e=e*n,f=k*f,g=k*
g,k=k*n;a[0]=1-(m+e);a[1]=l+k;a[2]=d-g;a[3]=l-k;a[4]=1-(b+e);a[5]=c+f;a[6]=d+g;a[7]=c-f;a[8]=1-(b+m);return a};r.toMat4=function(b,a){a||(a=u.create());var d=b[0],c=b[1],e=b[2],k=b[3],f=d+d,g=c+c,n=e+e;b=d*f;var l=d*g,d=d*n,m=c*g,c=c*n,e=e*n,f=k*f,g=k*g,k=k*n;a[0]=1-(m+e);a[1]=l+k;a[2]=d-g;a[3]=0;a[4]=l-k;a[5]=1-(b+e);a[6]=c+f;a[7]=0;a[8]=d+g;a[9]=c-f;a[10]=1-(b+m);a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};r.slerp=function(b,a,c,e){e||(e=b);var d=b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]*a[3],k,
f;if(1<=Math.abs(d))return e!==b&&(e[0]=b[0],e[1]=b[1],e[2]=b[2],e[3]=b[3]),e;k=Math.acos(d);f=Math.sqrt(1-d*d);if(.001>Math.abs(f))return e[0]=.5*b[0]+.5*a[0],e[1]=.5*b[1]+.5*a[1],e[2]=.5*b[2]+.5*a[2],e[3]=.5*b[3]+.5*a[3],e;d=Math.sin((1-c)*k)/f;c=Math.sin(c*k)/f;e[0]=b[0]*d+a[0]*c;e[1]=b[1]*d+a[1]*c;e[2]=b[2]*d+a[2]*c;e[3]=b[3]*d+a[3]*c;return e};r.fromRotationMatrix=function(b,a){a||(a=r.create());var d=b[0]+b[4]+b[8],c;if(0<d)c=Math.sqrt(d+1),a[3]=.5*c,c=.5/c,a[0]=(b[7]-b[5])*c,a[1]=(b[2]-b[6])*
c,a[2]=(b[3]-b[1])*c;else{c=r.fromRotationMatrix.s_iNext=r.fromRotationMatrix.s_iNext||[1,2,0];d=0;b[4]>b[0]&&(d=1);b[8]>b[3*d+d]&&(d=2);var e=c[d],k=c[e];c=Math.sqrt(b[3*d+d]-b[3*e+e]-b[3*k+k]+1);a[d]=.5*c;c=.5/c;a[3]=(b[3*k+e]-b[3*e+k])*c;a[e]=(b[3*e+d]+b[3*d+e])*c;a[k]=(b[3*k+d]+b[3*d+k])*c}return a};t.toQuat4=r.fromRotationMatrix;(function(){var b=t.create();r.fromAxes=function(a,d,c,e){b[0]=d[0];b[3]=d[1];b[6]=d[2];b[1]=c[0];b[4]=c[1];b[7]=c[2];b[2]=a[0];b[5]=a[1];b[8]=a[2];return r.fromRotationMatrix(b,
e)}})();r.identity=function(b){b||(b=r.create());b[0]=0;b[1]=0;b[2]=0;b[3]=1;return b};r.fromAngleAxis=function(b,a,c){c||(c=r.create());b*=.5;var d=Math.sin(b);c[3]=Math.cos(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];return c};r.toAngleAxis=function(b,a){a||(a=b);var d=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];0<d?(a[3]=2*Math.acos(b[3]),d=m.invsqrt(d),a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d):(a[3]=0,a[0]=1,a[1]=0,a[2]=0);return a};r.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"};var w={create:function(b){var a=
new f(4);b?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):a[0]=a[1]=a[2]=a[3]=0;return a},createFrom:function(b,a,c,e){var d=new f(4);d[0]=b;d[1]=a;d[2]=c;d[3]=e;return d},set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},identity:function(b){b||(b=w.create());b[0]=1;b[1]=0;b[2]=0;b[3]=1;return b},transpose:function(b,a){if(!a||b===a)return a=b[1],b[1]=b[2],b[2]=a,b;a[0]=b[0];a[1]=b[2];a[2]=b[1];a[3]=b[3];return a},determinant:function(b){return b[0]*b[3]-b[2]*b[1]},inverse:function(b,
a){a||(a=b);var d=b[0],c=b[1],e=b[2];b=b[3];var k=d*b-e*c;if(!k)return null;k=1/k;a[0]=b*k;a[1]=-c*k;a[2]=-e*k;a[3]=d*k;return a},multiply:function(b,a,c){c||(c=b);var d=b[0],e=b[1],k=b[2];b=b[3];c[0]=d*a[0]+e*a[2];c[1]=d*a[1]+e*a[3];c[2]=k*a[0]+b*a[2];c[3]=k*a[1]+b*a[3];return c},rotate:function(b,a,c){c||(c=b);var d=b[0],e=b[1],k=b[2];b=b[3];var f=Math.sin(a);a=Math.cos(a);c[0]=d*a+e*f;c[1]=d*-f+e*a;c[2]=k*a+b*f;c[3]=k*-f+b*a;return c},multiplyVec2:function(b,a,c){c||(c=a);var d=a[0];a=a[1];c[0]=
d*b[0]+a*b[1];c[1]=d*b[2]+a*b[3];return c},scale:function(b,a,c){c||(c=b);var d=b[1],e=b[2],k=b[3],f=a[0];a=a[1];c[0]=b[0]*f;c[1]=d*a;c[2]=e*f;c[3]=k*a;return c},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"}};p=p?"":"d";a["glMath"+p]=m;a["vec2"+p]={create:function(b){var a=new f(2);b?(a[0]=b[0],a[1]=b[1]):(a[0]=0,a[1]=0);return a},createFrom:function(b,a){var d=new f(2);d[0]=b;d[1]=a;return d},add:function(b,a,c){c||(c=a);c[0]=b[0]+a[0];c[1]=b[1]+a[1];return c},subtract:function(b,
a,c){c||(c=a);c[0]=b[0]-a[0];c[1]=b[1]-a[1];return c},multiply:function(b,a,c){c||(c=a);c[0]=b[0]*a[0];c[1]=b[1]*a[1];return c},divide:function(b,a,c){c||(c=a);c[0]=b[0]/a[0];c[1]=b[1]/a[1];return c},scale:function(b,a,c){c||(c=b);c[0]=b[0]*a;c[1]=b[1]*a;return c},dist:function(b,a){var d=a[0]-b[0];b=a[1]-b[1];return Math.sqrt(d*d+b*b)},dist2:function(b,a){var d=a[0]-b[0];b=a[1]-b[1];return d*d+b*b},set:function(b,a){a[0]=b[0];a[1]=b[1];return a},set2:function(b,a,c){c[0]=b;c[1]=a;return c},negate:function(b,
a){a||(a=b);a[0]=-b[0];a[1]=-b[1];return a},normalize:function(b,a){a||(a=b);var d=b[0]*b[0]+b[1]*b[1];0<d?(d=Math.sqrt(d),a[0]=b[0]/d,a[1]=b[1]/d):a[0]=a[1]=0;return a},cross:function(b,a,c){b=b[0]*a[1]-b[1]*a[0];if(!c)return b;c[0]=c[1]=0;c[2]=b;return c},length:function(b){var a=b[0];b=b[1];return Math.sqrt(a*a+b*b)},dot:function(b,a){return b[0]*a[0]+b[1]*a[1]},direction:function(b,a,c){c||(c=b);var d=b[0]-a[0];b=b[1]-a[1];a=d*d+b*b;if(!a)return c[0]=0,c[1]=0,c[2]=0,c;a=1/Math.sqrt(a);c[0]=d*
a;c[1]=b*a;return c},lerp:function(b,a,c,e){e||(e=b);e[0]=b[0]+c*(a[0]-b[0]);e[1]=b[1]+c*(a[1]-b[1]);return e},str:function(b){return"["+b[0]+", "+b[1]+"]"}};a["vec3"+p]=e;a["vec4"+p]={create:function(b){var a=new f(4);b?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):(a[0]=0,a[1]=0,a[2]=0,a[3]=0);return a},createFrom:function(b,a,c,e){var d=new f(4);d[0]=b;d[1]=a;d[2]=c;d[3]=e;return d},add:function(b,a,c){c||(c=a);c[0]=b[0]+a[0];c[1]=b[1]+a[1];c[2]=b[2]+a[2];c[3]=b[3]+a[3];return c},subtract:function(b,
a,c){c||(c=a);c[0]=b[0]-a[0];c[1]=b[1]-a[1];c[2]=b[2]-a[2];c[3]=b[3]-a[3];return c},multiply:function(b,a,c){c||(c=a);c[0]=b[0]*a[0];c[1]=b[1]*a[1];c[2]=b[2]*a[2];c[3]=b[3]*a[3];return c},divide:function(b,a,c){c||(c=a);c[0]=b[0]/a[0];c[1]=b[1]/a[1];c[2]=b[2]/a[2];c[3]=b[3]/a[3];return c},scale:function(b,a,c){c||(c=b);c[0]=b[0]*a;c[1]=b[1]*a;c[2]=b[2]*a;c[3]=b[3]*a;return c},dot:function(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]*a[3]},set:function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];
return a},set4:function(b,a,c,e,f){f[0]=b;f[1]=a;f[2]=c;f[3]=e;return f},negate:function(b,a){a||(a=b);a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a},lerp:function(b,a,c,e){e||(e=b);e[0]=b[0]+c*(a[0]-b[0]);e[1]=b[1]+c*(a[1]-b[1]);e[2]=b[2]+c*(a[2]-b[2]);e[3]=b[3]+c*(a[3]-b[3]);return e},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"}};a["mat2"+p]=w;a["mat3"+p]=t;a["mat4"+p]=u;a["quat4"+p]=r});return a})},"esri/views/3d/webgl-engine/lib/RenderGeometry":function(){define(["require",
"exports","./gl-matrix"],function(a,h,p){var m=p.vec3d,f=p.mat4d;return function(){function a(a,e,c,b,f,h,p,t,u,r){this.data=a.toRenderData();this.componentOffsets=a.componentOffsets;this.boundingInfo=e;this.material=c;this.origin=null;this.center=m.create();this.bsRadius=0;this.transformation=null;b&&this.updateTransformation(b,f);this.castShadow=h;this.singleUse=p;this.name=t;this.uniqueName=u;this.idx=r;this.canBeMerged=!0;this.instanceParameters={}}a.prototype.updateTransformation=function(a,
e){e=e||f.maxScale(a);this.transformation=a;f.multiplyVec3(a,this.boundingInfo.getCenter(),this.center);this.bsRadius=this.boundingInfo.getBSRadius()*e};return a}()})},"esri/views/3d/webgl-engine/parts/View":function(){define("require exports ../../../../core/Logger ../lib/GLTextureRep ../lib/GLMaterialRep ../lib/ShaderSnippets ../lib/GLSLShaderRep ../lib/TextureRenderer ../lib/gl-matrix ../lib/webgl-utils ./Model ./Viewport ../materials/repository ../lib/SSAOHelperObscurance ../lib/HighlightHelper ../lib/OffscreenRenderingHelper ../lib/tracer ../../../webgl/RenderingContext ../lib/ProgramRepository ../../../support/screenshotUtils".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k){var v=c.vec3d,A=c.vec4d,z=p.getLogger("esri.views.3d.webgl-engine.parts.View");a=function(){function a(b,a,d,c){var e=this;this._backgroundColor=A.createFrom(1,1,1,1);this._lightDirection=v.createFrom(0,1,0);this._didRender=!1;this._idleSuspend=this._needsRender=!0;this._shouldRender=!1;this._screenCaptureQueue=[];this._container=b;this._stage=a;this._initializeContext(c);this._initializeShaders();this._textureRep=new m(a.getAll(q.ContentType.TEXTURE),
this._programRepository,this._rctx);this._materialRep=new f(this._textureRep,this._programRepository);this._viewport=new x(this._programRepository,this._materialRep,this._textureRep,this._rctx);this._initializeViewportCamera();this._textureRenderer=new g(this._rctx,this._canvas,this._programRepository,this._materialRep,this._textureRep,d);this._initializeFrameTask()}a.prototype._initializeFrameTask=function(){var b=this;this._frameTask={preRender:function(){n.begin();
b._stage.processDirty();b.needsRender()?(b._shouldRender=!0,b._viewport.getCamera().setGLViewport(b._rctx),b._rctx.setClearColor.apply(b._rctx,b._backgroundColor),b._rctx.clear(16640)):b._shouldRender=!1},render:function(){b._shouldRender&&(b._didRender=!0,b._viewport.render(b._lightDirection,null))},postRender:function(){n.end()},update:function(){b._performScreenCaptures();b.resetNeedsRender()}}};a.prototype._initializeViewportCamera=function(){var b=this._container.getBoundingClientRect(),a=this._viewport.getCamera();
a.viewport[2]=b.width;a.viewport[3]=b.height;this._viewport.setCamera(a)};a.prototype._initializeContext=function(a){this._canvas=a.canvas;this._canvas||(this._canvas=document.createElement("canvas"));this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");var d=b.setupWebGL(this._canvas,{alpha:a.alpha||!1,antialias:!1,depth:!0,stencil:null==a.stencil?!0:a.stencil});this._gl=n.instrumentContext(d[0]);this._rctx=new w(d[0],{disabledExtensions:a.deactivatedWebGLExtensions});!a.alpha&&
this._rctx.contextAttributes.alpha&&z.error("WebGL context has alpha channel even though no alpha channel was requested");this._container.appendChild(this._canvas)};a.prototype._initializeShaders=function(){this._shaderSnippets=new e;this._shaderRep=new l;this._programRepository=new d;y.initializeShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);u.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);t.loadShaders(this._shaderSnippets,
this._shaderRep,this._programRepository,this._rctx);r.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx)};a.prototype.dispose=function(){this._viewport.dispose();this._viewport=null;this._textureRenderer.dispose();this._textureRenderer=null;this._programRepository.dispose();this._programRepository=null;this._container.contains(this._canvas)&&this._container.removeChild(this._canvas);this._gl=this._canvas=this._container=null};a.prototype.getCombinedStats=function(){return this._viewport.getCombinedStats()};
a.prototype.setNeedsRender=a.prototype.resetNeedsRender=function(){this._didRender&&(this._didRender=this._needsRender=!1);this._viewport.resetNeedsRender();this._textureRep.resetNeedsRender()};a.prototype.needsRender=function(){return this._needsRender||!this._idleSuspend||this._viewport.needsRender()||this._textureRep.needsRender()};a.prototype.getFrameTask=function(){return this._frameTask};a.prototype.setLights=function(b,a){v.set(a.direction,
this._lightDirection);A.set4(b.color[0],b.color[1],b.color[2],b.intensity,D.ambient);A.set4(a.color[0],a.color[1],a.color[2],a.intensity,D.diffuse);A.set4(a.color[0],a.color[1],a.color[2],Math.min(a.intensity+b.intensity,1),D.specular);v.set(a.direction,D.direction);this._viewport.setLightingData(D);this._needsRender=!0};a.prototype.getViewParams=function(b){var a=this._viewport.getViewParams(b);if(!b||b.backgroundColor)a.backgroundColor=this._backgroundColor;return a};a.prototype.setViewParams=function(b){this._needsRender=
!0;b.backgroundColor&&(this._backgroundColor=b.backgroundColor);this._viewport.setViewParams(b)};a.prototype.setRenderParams=function(b){this._needsRender=!0;void 0!==b.idleSuspend&&(this._idleSuspend=!!b.idleSuspend);this._viewport.setRenderParams(b)};a.prototype.getRenderParams=function(){var b=this._viewport.getRenderParams();b.anisotropicFiltering=this._textureRep.getMaxAnisotropy();b.idleSuspend=this._idleSuspend;return b};Object.defineProperty(a.prototype,"renderingContext",{get:function(){return this._rctx},
enumerable:!0,configurable:!0});a.prototype.has=function(b){return"s3tc"===b?!!this._rctx.extensions.compressedTextureS3TC:"standardDerivatives"===b?!!this._rctx.extensions.standardDerivatives:"shaderTextureLOD"===b?!!this._rctx.extensions.shaderTextureLOD:"angleInstancedArrays"===b?!!this._rctx.extensions.angleInstancedArrays:!1};a.prototype.getFrustumObjects=function(){return this._viewport.getFrustumObjects()};a.prototype.modify=function(b,a,d,c){this._viewport.modify(b,a,d,c)};a.prototype.setSelectionObject=
function(b,a){this._viewport.setSelectionObject(b,a)};a.prototype.setCamera=function(b){this._viewport.setCamera(b)};a.prototype.getCamera=function(){return this._viewport.getCamera()};a.prototype.getPickRay=function(b,a,d){this._viewport.getPickRay(b,a,d)};a.prototype.pickRayWithBeginPoint=function(b,a,d,c,e){this._viewport.pickRayWithBeginPoint(b,a,d,c,e)};a.prototype.getCanvas=function(){return this._canvas};a.prototype.getTextureGraphicsRenderer=function(){return this._textureRenderer};a.prototype.requestScreenCapture=
function(b,a){this._screenCaptureQueue.push({settings:b||{},callback:a});this._needsRender=!0};a.prototype.getAllTexturesLoaded=a.prototype.getTextureLoaded=function(b){return this._textureRep.getIsLoaded(b)};a.prototype.addTextureListener=function(b){this._textureRep.addTextureListener(b)};a.prototype.removeTextureListener=function(b){this._textureRep.removeTextureListener(b)};a.prototype.addExternalRenderer=function(b,a){return this._viewport.addExternalRenderer(b,
a)?(a.initializeRenderContext({rctx:this._rctx,gl:this._rctx.gl,shaderSnippets:this._shaderSnippets,shaderRep:this._shaderRep,programRep:this._programRepository,textureRep:this._textureRep}),!0):!1};a.prototype.removeExternalRenderer=function(b){return this._viewport.removeExternalRenderer(b)?(b.uninitializeRenderContext({rctx:this._rctx,gl:this._rctx.gl}),!0):!1};a.prototype._performScreenCaptures=function(){if(0!==this._screenCaptureQueue.length){for(var b=0;b<this._screenCaptureQueue.length;b++){var a=
this._screenCaptureQueue[b],d=0,c=0,e=this._canvas.width,f=this._canvas.height,g=this._canvas.width,n=this._canvas.height;if(g=a.settings.area)d=g.x,c=g.y,e=g.width,f=g.height;void 0!==a.settings.width&&void 0!==a.settings.height?(g=a.settings.width/a.settings.height,f*g<e?(g*=f,d+=Math.floor((e-g)/2),e=Math.floor(g)):(g=e/g,c+=Math.floor((f-g)/2),f=Math.floor(g)),g=a.settings.width,n=a.settings.height):(g=e,n=f);var l=this._canvas;if(0!==d||0!==c||e!==this._canvas.width||f!==this._canvas.height||
g!==this._canvas.width||n!==this._canvas.height){this._resizeCanvas||(this._resizeCanvas=document.createElement("canvas"));this._resizeCanvas.width=g;this._resizeCanvas.height=n;var m=this._resizeCanvas.getContext("2d"),l=new Uint8Array(e*f*4);this._gl.readPixels(d,this._canvas.height-(c+f),e,f,6408,5121,l);d=m.getImageData(0,0,g,n);k.resampleHermite(l,e,f,d.data,g,n,!0);m.putImageData(d,0,0);l=this._resizeCanvas;m=null}e={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"}[a.settings.format?a.settings.format.toLowerCase():
"png"];f=1;void 0!==a.settings.quality&&(f=a.settings.quality/100);e=l.toDataURL(e,f);a.callback({dataURL:e,x:0,y:0,width:g,height:n})}this._screenCaptureQueue=[]}};return a}();var D={ambient:A.create(),diffuse:A.create(),specular:A.create(),direction:v.create()};return a})},"esri/views/3d/webgl-engine/lib/GLTextureRep":function(){define(["require","exports","./Util","../../../webgl/Texture","../../../webgl/enums"],function(a,h,p,m,f){var e=function(){function a(a){this._glTexture=null;this._refCount=
0;this._glTexture=a}a.prototype.incRefCnt=function(){++this._refCount};a.prototype.decRefCnt=function(){--this._refCount;p.assert(0<=this._refCount)};a.prototype.getRefCnt=function(){return this._refCount};a.prototype.setGLTexture=function(a){this._glTexture=a};a.prototype.getGLTexture=function(){return this._glTexture};return a}();return function(){function a(a,c,b,e){this.NUM_PARALLEL=8;this.textures=a;this._programRepository=c;this.getViewportToRestore=b;this._rctx=e;this.NUM_PARALLEL=8;this.id2textureRef=
{};this.loading={};this._queue=[];this.listeners=[];this.maxMaxAnisotropy=(this.afExt=e.extensions.textureFilterAnisotropic)?e.parameters.maxMaxAnisotropy:1;this.maxAnisotropy=Math.min(8,this.maxMaxAnisotropy);this._needsRender=!0;this._fallbackTextureData=new Uint8Array(256);this._fallbackTextureTransparentData=new Uint8Array(256);for(a=0;a<this._fallbackTextureData.length;++a)this._fallbackTextureData[a]=255,this._fallbackTextureTransparentData[a]=0!==(a+1)%4?255:0;this._fallbackTextureDesc={target:3553,
pixelFormat:6408,dataType:5121,samplingMode:9728,width:8,height:8,maxAnisotropy:8}}a.prototype.resetNeedsRender=function(){this._needsRender=!1};a.prototype.needsRender=function(){return this._needsRender};a.prototype.aquire=function(a,c,b,f){var g=this,l=this.id2textureRef[a];if(null==l){c=this.textures[a];p.assert(void 0!==c);c.setUnloadFunc(this._unload.bind(this));b=!0===b;var h=this._createGLTextureDescription(c),l=new e(b?new m(this._rctx,this._fallbackTextureDesc,this._fallbackTextureTransparentData):
new m(this._rctx,this._fallbackTextureDesc,this._fallbackTextureData));p.assert(null==this.id2textureRef[a]);this.id2textureRef[a]=l;c.initializeThroughRender?(a=c.initializeThroughRender(this._rctx,h),l.setGLTexture(a),f&&f(l)):c.deferredLoading()?this.getLoadingCount()<this.NUM_PARALLEL?this._loadImage(a,h,f):this._queue.push([a,h,f]):c.initializeThroughUpload(this._rctx,h,this._programRepository,this.getViewportToRestore(),function(b){l.setGLTexture(b);g._needsRender=!0;f&&f(l)});this._needsRender=
!0}l.incRefCnt();return l};a.prototype.release=function(a){a=this.id2textureRef[a];void 0!==a&&(a.decRefCnt(),p.assert(0<=a.getRefCnt()))};a.prototype.getLoadingCount=function(){return Object.keys(this.loading).length};a.prototype.getIsLoaded=function(a){if(null==this.id2textureRef[a]||void 0!==this.loading[a])return!1;for(var c=0;c<this._queue.length;++c)if(this._queue[c][0]===a)return!1;return!0};a.prototype.addTextureListener=function(a){p.assert(-1===this.listeners.indexOf(a));this.listeners.push(a)};
a.prototype.removeTextureListener=function(a){a=this.listeners.indexOf(a);p.assert(-1!==a);this.listeners.splice(a,1)};a.prototype.getTexture=function(a){return this.textures[a]};a.prototype.getMaxAnisotropy=function(){return this.maxAnisotropy};a.prototype._unload=function(a){var c=this.id2textureRef[a];void 0!==c&&(c.getGLTexture().dispose(),delete this.id2textureRef[a]);this.next(a)};a.prototype._createGLTextureDescription=function(a){return{target:3553,pixelFormat:6408,dataType:5121,maxAnisotropy:this.afExt&&
a.params&&a.params.mipmap&&!a.params.disableAnisotropy?this.maxAnisotropy:void 0,wrapMode:a.params&&a.params.wrapClamp?33071:void 0}};a.prototype.next=function(a){if(a in this.loading){delete this.loading[a];var c=Object.keys(this.id2textureRef),b=Object.keys(this.loading);this.listeners.forEach(;this.processQueue()}};a.prototype._loadImage=function(a,c,b){var e=this;p.assert(null==this.loading[a]);this.loading[a]=!0;var f=this.textures[a];p.assert(void 0!==f);setTimeout(function(){var g=
e.id2textureRef[a];g&&g.getRefCnt()&&f.initializeThroughUpload(e._rctx,c,e._programRepository,e.getViewportToRestore(),function(c){e.next(a);e._needsRender=!0;g&&g.getRefCnt()&&(g.setGLTexture(c),b&&b(g))})},0)};a.prototype.processQueue=function(){for(var a=[],c=0;c<this._queue.length;++c){var b=this._queue[c][0],e=this.id2textureRef[b];void 0!==e&&(0===e.getRefCnt()?(e.getGLTexture().dispose(),delete this.id2textureRef[b]):a.push(this._queue[c]))}this._queue=a;a=Math.min(this.NUM_PARALLEL-Object.keys(this.loading).length,
this._queue.length);for(c=0;c<a;++c)this._loadImage(this._queue[c][0],this._queue[c][1],this._queue[c][2]);this._queue.splice(0,a)};return a}()})},"esri/views/webgl/Texture":function(){define(["require","exports"],function(a,h){a=function(){function a(m,f,e){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._context=m;this._desc={pixelFormat:f.pixelFormat,dataType:f.dataType,target:f.target?f.target:3553,samplingMode:f.samplingMode?f.samplingMode:
9729,wrapMode:f.wrapMode?f.wrapMode:10497,maxAnisotropy:f.maxAnisotropy,flipped:void 0!==f.flipped?f.flipped:!1,hasMipmap:void 0!==f.hasMipmap?f.hasMipmap:!1,level:void 0!==f.level?f.level:0,unpackAlignment:f.unpackAlignment?f.unpackAlignment:4,width:f.width,height:f.height};this._id=++a._nextId;this.setData(e)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._context&&this._glName&&(this._context.gl.deleteTexture(this._glName),this._glName=null)};a.prototype.resize=a.prototype.setData=function(m){var f=this._context.gl;this._glName||(this._glName=f.createTexture());void 0===m&&(m=null);
null===m&&(this._desc.width=this._desc.width||4,this._desc.height=this._desc.height||4);var e=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var l=this._desc;a._validateTexture(l);f.pixelStorei(f.UNPACK_ALIGNMENT,l.unpackAlignment);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,l.flipped?1:0);m instanceof ImageData||m instanceof HTMLImageElement||m instanceof HTMLCanvasElement||m instanceof HTMLVideoElement?(l.width&&l.height&&console.assert(m.width===l.width&&m.height===l.height),f.texImage2D(f.TEXTURE_2D,
l.level,l.pixelFormat,l.pixelFormat,l.dataType,m),void 0===this._desc.width&&(this._desc.width=m.width),void 0===this._desc.height&&(this._desc.height=m.height)):(null!=l.width&&null!=l.height||console.error("Width and height must be specified!"),f.texImage2D(f.TEXTURE_2D,l.level,l.pixelFormat,l.width,l.height,0,l.pixelFormat,l.dataType,m));l.hasMipmap&&this.generateMipmap();a._applySamplingMode(f,this._desc);a._applyWrapMode(f,this._desc);a._applyAnisotropicFilteringParameters(this._context,this._desc);
this._context.bindTexture(e,0)};a.prototype.updateData=a.prototype.generateMipmap=a.prototype.setSamplingMode=function(m){m!==this._desc.samplingMode&&(this._desc.samplingMode=m,a._validateTexture(this._desc),this._samplingModeDirty=!0)};a.prototype.setWrapMode=a.prototype.applyChanges=a._isPowerOfTwo=a._validateTexture=
a._applySamplingMode=a._applyWrapMode=a._applyAnisotropicFilteringParameters=return a}();a._nextId=0;return a})},"esri/views/webgl/enums":function(){define(["require","exports"],},"esri/views/3d/webgl-engine/lib/GLMaterialRep":function(){define(["require","exports","./Util"],function(a,h,p){var m=function(){.prototype.incRefCnt=a.prototype.decRefCnt=function(){--this.refCnt;
p.assert(0<=this.refCnt)};a.prototype.getRefCnt=function(){return this.refCnt};a.prototype.getGLMaterial=function(){return this.glMaterial};return a}();return function(){.prototype.aquire=function(a){return this.aquireExt(a,"color")};a.prototype.aquireDepthShadowMap=function(a){return this.aquireExt(a,"depthShadowMap")};a.prototype.aquireDepth=function(a){return this.aquireExt(a,"depth")};a.prototype.aquireNormal=function(a){return this.aquireExt(a,
"normal")};a.prototype.aquireHighlight=a.prototype.aquireExt=function(a,f){var e;e=a.getId()+"_"+f;var c=this.id2glMaterialRef[e];null==c?(a=(c=a.getGLMaterials()[f])?new c(a,this.programRep,this.textureRep):void 0,c=new m(a),this.id2glMaterialRef[e]=c):a=c.getGLMaterial();c.incRefCnt();a&&this.increaseProgramReferences(a);return a};a.prototype.release=function(a){this.releaseExt(a,"color")};a.prototype.releaseDepth=function(a){this.releaseExt(a,"depth")};
a.prototype.releaseNormal=function(a){this.releaseExt(a,"normal")};a.prototype.releaseDepthShadowMap=function(a){this.releaseExt(a,"depthShadowMap")};a.prototype.releaseHighlight=a.prototype.releaseExt=function(a,f){a=a+"_"+f;f=this.id2glMaterialRef[a];f.decRefCnt();if(0===f.getRefCnt()){if(f=f.getGLMaterial())this.decreaseProgramReferences(f),void 0!==f.dispose&&f.dispose();delete this.id2glMaterialRef[a]}};a.prototype.updateMaterialParameters=function(a){var e=
this.id2glMaterialRef[a+"_color"];e&&e.getGLMaterial()&&this.updateParamsForMat(e.getGLMaterial());(e=this.id2glMaterialRef[a+"_depth"])&&e.getGLMaterial()&&this.updateParamsForMat(e.getGLMaterial());(e=this.id2glMaterialRef[a+"_depthShadowMap"])&&e.getGLMaterial()&&this.updateParamsForMat(e.getGLMaterial());(e=this.id2glMaterialRef[a+"_normal"])&&e.getGLMaterial()&&this.updateParamsForMat(e.getGLMaterial());(a=this.id2glMaterialRef[a+"_highlight"])&&a.getGLMaterial()&&this.updateParamsForMat(a.getGLMaterial())};
a.prototype.updateParamsForMat=function(a){a.updateParameters&&a.updateParameters()};a.prototype.increaseProgramReferences=function(a){if(a.getAllPrograms){a=a.getAllPrograms();for(var e=0;e<a.length;e++)this.programRep.increaseRefCount(a[e])}else this.programRep.increaseRefCount(a.getProgram())};a.prototype.decreaseProgramReferences=function(a){if(a.getAllPrograms){a=a.getAllPrograms();for(var e=0;e<a.length;e++)this.programRep.decreaseRefCount(a[e])}else this.programRep.decreaseRefCount(a.getProgram())};
return a}()})},"esri/views/3d/webgl-engine/lib/ShaderSnippets":function(){define(["require","exports","./Util","dojox/xml/parser"],function(a,h,p,m){return function(){function a(){var a=p.VertexAttrConstants,f;for(f in a)this[a[f]]=p.VertexAttrConstants[f]}a.prototype._parse=function(a){a=m.parse(a).getElementsByTagName("snippet");for(var e=/\$[a-zA-Z0-9]+[ \t]*/,f=/[\$\s]+/g,c=0;c<a.length;c++){var b=a[c].getAttribute("name");p.assert(null==this[b]);for(var h=a[c].textContent,x=void 0;null!==(x=
h.match(e));){var y=this[x[0].replace(f,"")];p.assert(void 0!==y);h=h.replace(x[0],y)}this[b]=h}};return a}()})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(a){a.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(h,p){var m=a.doc,f;p=p||"text/xml";if(h&&a.trim(h)&&"DOMParser"in a.global){f=(new DOMParser).parseFromString(h,p);h=f.documentElement;if("parsererror"==h.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==
h.namespaceURI){if(m=h.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0])m=m.firstChild.data;throw Error("Error parsing text "+h.firstChild.data+" \n"+m);}return f}if("ActiveXObject"in a.global){m=function(a){return"MSXML"+a+".DOMDocument"};m=["Microsoft.XMLDOM",m(6),m(4),m(3),m(2)];a.some(m,;if(h&&f&&(f.async=!1,f.loadXML(h),h=f.parseError,0!==h.errorCode))throw Error("Line: "+h.line+"\nCol: "+
h.linepos+"\nReason: "+h.reason+"\nError Code: "+h.errorCode+"\nSource: "+h.srcText);if(f)return f}else if(m.implementation&&m.implementation.createDocument){if(h&&a.trim(h)&&m.createElement){p=m.createElement("xml");p.innerHTML=h;var e=m.implementation.createDocument("foo","",null);a.forEach(p.childNodes,;return e}return m.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=dojox.xml.parser.replaceChildren=
dojox.xml.parser.removeChildren=dojox.xml.parser.innerXML=return dojox.xml.parser})},"esri/views/3d/webgl-engine/lib/GLSLShaderRep":function(){define(["require","exports","./Util"],function(a,h,p){return function(){.prototype.add=function(a,
e){p.assert(null==this.shaders[a]);this.shaders[a]=e};a.prototype.get=function(a){p.assert(void 0!==this.shaders[a]);return this.shaders[a]};return a}()})},"esri/views/3d/webgl-engine/lib/TextureRenderer":function(){define("require exports ./Renderer ./Camera ./Util ./gl-matrix ../materials/internal/TexOnlyGLMaterial ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u){var r=e.vec3d,n=e.vec4d,w=e.mat4d;a=function(){function a(b,a,d,c,e,f){this._acquiredTextures={};this._clearColor=n.createFrom(0,0,0,0);this._id2origin={};this._rctx=b;this._canvas=a;this._programRep=d;this._materialRep=c;this._textureRep=e;this._modelDirtySet=f;this._renderer=new p(d,c,e,this._rctx,!0);this._renderer.setLightingData({ambient:[1,1,1,1],diffuse:[0,0,0,0],specular:[0,0,0,0],direction:[0,-1,0]})}a.prototype.dispose=function(){for(var b in this._acquiredTextures)this._acquiredTextures[b].fbo.dispose(),
this._textureRep.release(b);this._acquiredTextures=null;this._renderer.dispose();this._renderer=null};a.prototype.addRenderGeometries=function(b){var a=this;b.forEach(function(b){null==b.origin&&(b.origin=a.getOrigin(b.center,b.bsRadius))});this._renderer.modify(b,[])};a.prototype.removeRenderGeometries=a.prototype.updateRenderGeometries=function(b,a){b=b.map(;this._renderer.modify([],[],b,{})};a.prototype.updateRenderOrder=
function(b){0<Object.keys(b).length&&this._renderer.modifyRenderOrder(b)};a.prototype.setBackgroundColor=function(b){this._clearColor=b};a.prototype.isEmpty=function(){return this._renderer.isEmpty()};a.prototype.processDirtyMaterials=function(){var b=this._modelDirtySet.getDirtyMaterials();b&&this._renderer.modify([],[],[],b);this._modelDirtySet.clearDirtyMaterials()};a.prototype.draw=function(b,a){this.processDirtyMaterials();var e=b.id.toString(),f,n=this._rctx,g=n.gl;if(this._acquiredTextures[e])f=
this._acquiredTextures[e].fbo;else{f=this._textureRep.aquire(e).getGLTexture();f=c.createWithAttachments(this._rctx,f,{colorTarget:0,depthStencilTarget:0});var l=Object.keys(this._acquiredTextures).length;this._acquiredTextures[e]={texture:b,fbo:f,idx:l}}b=a.width;l=a.height;if(f.width!==b||f.height!==l)f.resize(b,l),f.colorTexture.setSamplingMode(9729);A.near=1;A.far=1E4;n.bindFramebuffer(f);n.setDepthTestEnabled(!1);n.setBlendFunctionSeparate(770,771,1,771);n.setClearColor.apply(n,this._clearColor);
n.clear(g.COLOR_BUFFER_BIT);this._renderer.setPixelRatio(a.pixelRatio||1);for(g=0;g<a.views.length;g++)f=a.views[g],A.viewport=f.viewport,w.ortho(0,f.extent[2]-f.extent[0],0,f.extent[3]-f.extent[1],A.near,A.far,A.projectionMatrix),w.identity(A.viewMatrix),w.translate(A.viewMatrix,[-f.extent[0],-f.extent[1],0]),A.setGLViewport(this._rctx),d&&this._drawTestTexture(b,l,k[this._acquiredTextures[e].idx%k.length]),this._renderer.render(A,v);n.setDepthTestEnabled(!0);n.setBlendFunctionSeparate(770,771,1,
771);n.bindFramebuffer(null);n.setViewport(0,0,this._canvas.width,this._canvas.height)};a.prototype._drawTestTexture=function(a,d,c){var e=this._rctx,f=e.gl;if(!this._testPatternMat){for(var k=new Uint8Array(a*d*4),n=0,m=0;m<d;m++)for(var h=0;h<a;h++){var r=Math.floor(h/10),v=Math.floor(m/10);2>r||2>v||10*r>a-20||10*v>d-20?(k[n++]=255,k[n++]=255,k[n++]=255,k[n++]=255):(k[n++]=255,k[n++]=255,k[n++]=255,r&1&&v&1?k[n++]=h&1^m&1?0:255:k[n++]=r&1^v&1?0:128)}a=new g(e,{target:3553,pixelFormat:6408,dataType:5121,
samplingMode:9728,width:a,height:d},k);this._testPatternMat=new l(this._programRep,a,[1,1,1,1],!0,f.ALWAYS);this._testPatternBindParams={proj:w.identity(),view:w.identity(),nearFar:[-1,1],origin:[0,0,0]};f=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]);this._quadVAO=new b(e,u.Default3D,{geometry:t.Pos3Tex},{geometry:q.createVertex(e,35044,f)})}this._testPatternMat.setColor([c[0],c[1],c[2],1]);this._testPatternMat.bind(e,this._testPatternBindParams);this._testPatternMat.bindView(e,
this._testPatternBindParams);e.bindVAO(this._quadVAO);e.drawArrays(5,0,x.vertexCount(this._quadVAO,"geometry"));this._testPatternMat.release(e)};a.prototype.getOrigin=function(b,a){var d=0;a=10*a/1E4;1<a&&(d=Math.ceil(f.logWithBase(a,2)));a=1E4*Math.pow(2,d);var c=Math.round(b[0]/a),e=Math.round(b[1]/a);b=Math.round(b[2]/a);var d=d+"_"+c+"_"+e+"_"+b,k=this._id2origin[d];null==k&&(k={vec3:r.createFrom(c*a,e*a,b*a),id:d},this._id2origin[d]=k);return k};return a}();var d=!1,k=[[1,.5,.5],[.5,.5,1],[.5,
1,.5]],v={get:function(){return!0}},A=new m;return a})},"esri/views/3d/webgl-engine/lib/Renderer":function(){define("require exports ./IntervalUtilities ./ModelDirtyTypesTs ./Float32ArrayList ./InstanceBufferData ./Lighting ../materials/internal/SimpleGLMaterial ./LinearDepthTextureHelper ./NormalTextureHelper ./HighlightTextureHelper ./RenderPass ./RenderSlot ./RenderContext ./ExternalRendererContainer ./StencilRenderingHelper ./BitSet ./Util ./gl-matrix ./ComponentUtils ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ./FxaaRenderPass ./SmaaRenderPass ../../../webgl/enums ./DefaultVertexAttributeLocations".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v,A,z,D,B,C,F,K){var M=w.assert,E=w.array2object,V=w.objectEmpty,P=w.getFirstObjectValue,I=w.setMatrixTranslation3;a=d.vec2d;var J=d.vec4d,Q=d.mat4d,S=w.VertexAttrConstants,ga=Q.identity();w=function(){function a(a,d,e,f,k){this._lighting=new l;this._mat2dataMerged={};this._mat2dataInstanced={};this._renderOrder=[];this._externalRenderers=new u;this._renderContext=new t;this._framesRendered=0;this._isRendering=!1;this._pixelRatio=1;this._threshold=
1535;this._needsRender=!0;this._stats=new L;this.ssaoEnabled=!1;this.renderOptions={antialiasing:"smaa",earlyOcclusionPixelDraw:!1};this._programRep=a;this._materialRep=d;this._textureRep=e;this._orderedRendering=k;this._rctx=f;d=f.gl;this._fxaaPass=new B(f);this._smaaPass=new C(f);this._selectionMaterial=new g(a,J.createFrom(.1,.2,.9,.4),d.EQUAL);this._selectionMaterialLines=new g(a,J.createFrom(.1,.2,.9,.4),d.EQUAL,d.LINES);this._renderContext.lightingData=this._lighting.get();f.setDepthTestEnabled(!0);
f.setFaceCullingEnabled(!0);f.setBlendingEnabled(!1);f.setBlendFunctionSeparate(770,771,1,771);this._bindParameters={view:null,proj:null,viewInvTransp:null,nearFar:null,lightingData:null,viewport:null,framebufferTex:null,shadowMap:null,origin:null,pixelRatio:null,instanceParameters:null,depthFBO:null,normalFBO:null,extensions:{angleInstancedArrays:f.extensions.angleInstancedArrays}};this._linearDepthTextureHelper=new c(f);this._normalTextureHelper=new b(f);this._highlightTextureHelper=new q(f);this._stencilRenderingHelper=
new r(f);this._initializeFramebufferTexture()}a.prototype._initializeFramebufferTexture=function(){var b=this._rctx.gl,b=this._rctx.contextAttributes.alpha?b.RGBA:b.RGB,a=new v(this._rctx,{target:3553,pixelFormat:b,dataType:5121,samplingMode:9728,wrapMode:33071,width:4,height:4});this._framebuffer={format:b,texture:a,copied:!1}};a.prototype.dispose=function(){for(var b in this._mat2dataMerged){this._releaseMaterials(b);var a=this._mat2dataMerged[b],d;for(d in a.origin2data)a.origin2data[d].vao.dispose(!0)}this._mat2dataMerged=
null;for(b in this._mat2dataInstanced)for(d in this._releaseMaterials(b),a=this._mat2dataInstanced[b],a.origin2data)a.origin2data[d].vao.dispose(!0);this._mat2dataInstanced=null;this._framebuffer.texture.dispose();this._framebuffer.texture=null;this._linearDepthTextureHelper.getEnableState()&&this._linearDepthTextureHelper.disable();this._normalTextureHelper.getEnableState()&&this._normalTextureHelper.disable();this._highlightTextureHelper.getEnableState()&&this._highlightTextureHelper.setEnableState(!1);
this._stencilRenderingHelper.getEnableState()&&this._stencilRenderingHelper.setEnableState(!1)};a.prototype.setLightingData=a.prototype.getLightingData=function(){return this._lighting.get()};a.prototype.setPixelRatio=a.prototype.getPixelRatio=function(){return this._pixelRatio};a.prototype.addExternalRenderer=function(b,a){this._externalRenderers.addRenderer(b,a);return!0};a.prototype.removeExternalRenderer=
a.prototype.getExternalRenderers=function(){return this._externalRenderers};a.prototype.resetNeedsRender=function(){this._needsRender=!1;this._externalRenderers.resetNeedsRender()};a.prototype.needsRender=function(){return this._needsRender||this._externalRenderers.needsRender()};a.prototype.getCombinedStats=function(){this._stats.VBOallocatedSize=0;this._stats.VBOoptimalSize=0;this._stats.VBOusedSize=0;for(var b in this._mat2dataInstanced){var a=
this._mat2dataInstanced[b],d;for(d in a.origin2data){var c=a.origin2data[d];this._stats.VBOallocatedSize+=c.buffer.getArray().length;this._stats.VBOusedSize+=c.buffer.getSize();this._stats.VBOoptimalSize+=c.optimalCount}}for(b in this._mat2dataMerged)for(d in a=this._mat2dataMerged[b],a.origin2data)c=a.origin2data[d],this._stats.VBOallocatedSize+=c.buffer.getArray().length,this._stats.VBOusedSize+=c.buffer.getSize(),this._stats.VBOoptimalSize+=c.optimalCount;this._stats.VBOallocatedSize*=.00390625;
this._stats.VBOusedSize*=.00390625;this._stats.VBOoptimalSize*=.00390625;return this._stats};a.prototype.setSelectionObject=function(b,a){b?(Array.isArray(b)?this._selectionIndices=this._name2indices(E(b)):this._selectionIndices=this._name2indices(E([b])),this._selectionFaceIndexRange=void 0,null!=a&&1===a.length&&(this._selectionFaceIndexRange=[[3*a[0][0],3*a[0][1]]])):this._selectionFaceIndexRange=this._selectionIndices=void 0;this._needsRender=!0};a.prototype.renderGeometrySlots=function(b){this._externalRenderers.render(y.INTERNAL_MATERIAL,
b);this._renderInternalSlot(y.STENCIL_MATERIAL,b);this._externalRenderers.render(y.OPAQUE_TERRAIN,b);this._renderInternalSlot(y.OPAQUE_MATERIAL,b);this._externalRenderers.render(y.OPAQUE_EXTERNAL,b);b.ssaoHelper&&b.ssaoHelper.bindAll(this._programRep);this._renderInternalSlot(y.TRANSPARENT_MATERIAL,b);this.renderOptions.earlyOcclusionPixelDraw&&this._renderInternalSlot(y.OCCLUSION_PIXELS,this._renderContext);this._externalRenderers.render(y.TRANSPARENT_EXTERNAL,b);b.ssaoHelper&&b.ssaoHelper.bindAll(this._programRep);
this._externalRenderers.render(y.TRANSPARENT_TERRAIN,b)};a.prototype._renderHighlights=function(b,a,d,c){var e=!!c&&c.getEnableState()&&void 0!==this._selectionIndices;this._highlightTextureHelper.setEnableState(e);e&&(this._highlightTextureHelper.setupFBOs(b),this._highlightTextureHelper.prepareHighlightPass(),this.renderGeometryPass(x.MATERIAL_HIGHLIGHT,b,a,this._selectionIndices,this._selectionFaceIndexRange),this._rctx.clear(this._rctx.gl.DEPTH_BUFFER_BIT),this._renderInternalSlot(y.OVERLAY,this._renderContext),
this._highlightTextureHelper.finish(d),a=this._highlightTextureHelper.getHighlightFBO(),c.render(b,d,a))};a.prototype._renderUnordered=function(b,a,d,c,e,f,k){var n=this._rctx;this._isRendering=!0;this._stats.reset();this._framebuffer.copied=!1;this._updateGlobalUniforms(b.projectionMatrix);this._renderContext.pass=x.MATERIAL;this._renderContext.camera=b;this._renderContext.shadowMap=d;this._renderContext.ssaoHelper=c;this._renderContext.offscreenRenderingHelper=f;this._renderContext.stencilRenderingHelper=
this._stencilRenderingHelper;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.highlight=this._highlightTextureHelper.getHighlightFBO();this._renderContext.visibleContent=a;this._renderContext.filterContent=null;this._renderContext.filterFaceRange=null;this._renderContext.options=this.renderOptions;this._renderContext.rctx=this._rctx;f.setEnableState(!0);f.initializeFrame(b);this._externalRenderers.render(y.BACKGROUND,
this._renderContext);this.renderGeometrySlots(this._renderContext);this._externalRenderers.render(y.POSTPROCESSING_ATMOSPHERE,this._renderContext);switch(this.renderOptions.antialiasing){case "none":d=b.viewport;d=Q.ortho(d[0],d[2],d[1],d[3],-1,1);f.drawQuad(d);this._fxaaPass.disable();this._smaaPass.disable();break;case "fxaa":this._smaaPass.disable();this._fxaaPass.render({colorTexture:f.getColorTexture()},null);break;case "smaa":this._fxaaPass.disable(),this._smaaPass.render({colorTexture:f.getColorTexture()},
null)}this.renderOptions.earlyOcclusionPixelDraw||(f.bindFramebuffer(),this._renderInternalSlot(y.OCCLUSION_PIXELS,this._renderContext));n.bindFramebuffer(null);this._renderContext.framebufferTex=f.getColorTexture();this._renderInternalSlot(y.OVERLAY,this._renderContext);this._renderHighlights(b,a,e,k);this._framesRendered++;this._isRendering=!1};a.prototype._renderOrdered=function(b,a){this._isRendering=!0;this._stats.reset();this._framebuffer.copied=!1;this._updateGlobalUniforms(b.projectionMatrix);
this._bindParameters.view=b.viewMatrix;this._bindParameters.proj=b.projectionMatrix;this._bindParameters.viewInvTransp=b.viewInverseTransposeMatrix;U[0]=b.near;U[1]=b.far;this._bindParameters.nearFar=U;this._bindParameters.lightingData=this._lighting.get();this._bindParameters.viewport=b.fullViewport;this._bindParameters.framebufferTex=this._framebuffer.texture;this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();
this._bindParameters.normalFBO=this._normalTextureHelper.getNormalFBO();b=null;for(var d=0;d<this._renderOrder.length;d++){var c=this._renderOrder[d][1];if(c.instanced){var e=c.instanced,f=e[x.MATERIAL];!f||f.isVisible&&!f.isVisible()||(this._renderInternalInstanced(e,f,this._bindParameters,Infinity,a,null,null,!1),b=null)}c.merged&&(e=c.merged,!(f=e[x.MATERIAL])||f.isVisible&&!f.isVisible()||(c=f.getProgram(),c!==b&&(c.setUniformMatrix4fv("model",ga),c.hasUniform("modelNormal")&&c.setUniformMatrix4fv("modelNormal",
ga)),b=c,this._renderInternalMerged(e,f,this._bindParameters,Infinity)))}this._framesRendered++;this._isRendering=!1};a.prototype.render=function(b,a,d,c,e,f,k){this._orderedRendering?this._renderOrdered(b,a):this._renderUnordered(b,a,d,c,e,k,f)};a.prototype.renderAuxiliaryBuffers=function(b,a,d,c,e,f){f=this.ssaoEnabled;this._linearDepthTextureHelper.setEnableState(f);f&&(this._linearDepthTextureHelper.setupFBOs(b),this._linearDepthTextureHelper.prepareDepthPass(),this.renderGeometryPass(x.MATERIAL_DEPTH,
b,a,void 0,void 0,d,c),this._linearDepthTextureHelper.finish(e));this._normalTextureHelper.setEnableState(this.ssaoEnabled);this.ssaoEnabled&&(this._normalTextureHelper.setupFBOs(b),this._normalTextureHelper.prepareNormalPass(),this.renderGeometryPass(x.MATERIAL_NORMAL,b,a,void 0,void 0,d,c),this._normalTextureHelper.finish(e));this.ssaoEnabled&&c.computeSSAO(b,e,this._linearDepthTextureHelper.getDepthFBO(),this._normalTextureHelper.getNormalFBO());c.bindAll(this._programRep)};a.prototype.renderGeometryPass=
function(b,a,d,c,e,f,k){this._isRendering=!0;this._updateGlobalUniforms(a.projectionMatrix);this._renderContext.pass=b;this._renderContext.camera=a;this._renderContext.shadowMap=f;this._renderContext.ssaoHelper=k;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.visibleContent=d;this._renderContext.filterContent=c;this._renderContext.filterFaceRange=e;this._renderContext.rctx=this._rctx;this.renderGeometrySlots(this._renderContext);
this._isRendering=!1};a.prototype.renderSelection=function(b){this._isRendering=!0;for(var a=0;a<y.MAX_SLOTS;++a)this._renderInternalSlot(a,b);this._isRendering=!1};a.prototype._renderInternalSlot=function(b,a){this._bindParameters.view=a.camera.viewMatrix;this._bindParameters.proj=a.camera.projectionMatrix;this._bindParameters.viewInvTransp=a.camera.viewInverseTransposeMatrix;this._bindParameters.cameraAboveGround=a.camera.aboveGround;U[0]=a.camera.near;U[1]=a.camera.far;this._bindParameters.nearFar=
U;this._bindParameters.lightingData=this._lighting.get();this._bindParameters.viewport=a.camera.fullViewport;this._bindParameters.framebufferTex=this._renderContext.offscreenRenderingHelper?this._renderContext.offscreenRenderingHelper.getColorTexture():this._framebuffer.texture;this._bindParameters.shadowMap=a.shadowMap;this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();for(var d in this._mat2dataInstanced){var c=
this._mat2dataInstanced[d],e=c[a.pass];e&&e.beginSlot(b)&&(!e.isVisible||e.isVisible())&&this._renderInternalInstanced(c,e,this._bindParameters,b,a.visibleContent,a.filterContent,a.filterFaceRange,!1)}if(a.filterContent)for(d in this._mat2dataMerged)c=this._mat2dataMerged[d],(e=c[a.pass])&&e.beginSlot(b)&&(!e.isVisible||e.isVisible())&&this._renderInternalInstanced(c,e,this._bindParameters,b,null,a.filterContent,a.filterFaceRange,!0);else{for(var c=this._programRep.getProgramsUsingUniform("model"),
e=this._programRep.getProgramsUsingUniform("modelNormal"),f=0;f<c.length;f++){var k=c[f];k.setUniformMatrix4fv("model",ga);-1<e.indexOf(k)&&k.setUniformMatrix4fv("modelNormal",ga)}for(d in this._mat2dataMerged)c=this._mat2dataMerged[d],(e=c[a.pass])&&e.beginSlot(b)&&(!e.isVisible||e.isVisible())&&this._renderInternalMerged(c,e,this._bindParameters,b)}this._stencilRenderingHelper.getEnableState()&&b===y.STENCIL_MATERIAL&&this._stencilRenderingHelper.prepareStencilDisabledPass()};a.prototype._renderInternalInstanced=
function(b,a,d,c,e,f,k,n){var g=this._rctx,l=g.gl,m=!1,h=a.getDrawMode(g),r=this._bindParameters.extensions.angleInstancedArrays,q;for(q in b.origin2data){var t=b.origin2data[q];d.origin=t.origin;c===y.STENCIL_MATERIAL&&(this._stencilRenderingHelper.setEnableState(!0),this._stencilRenderingHelper.prepareStencilWritePass());var w=!1;if(a.instanced)for(var u in t.perGeometryDataInfo){var v=t.perGeometryDataInfo[u];m||(a.bind(g,d),m=!0);g.bindVAO(v.vao);var p=a.getProgram();D.assertCompatibleVertexAttributeLocations(v.vao,
p);w||(a.bindView(g,d),w=!0);var p=v.to-v.from,x=v.refCount;h===l.TRIANGLES&&(this._stats.trianglesRendered+=x*p/3);r.drawArraysInstancedANGLE(h,v.from,p,x);this._stats.drawCallsAngleInstanced++;this._stats.instancesDrawnAngle+=x}else{var v=t.instances,A;for(A in v){var p=v[A],x=p.idx,z=p.displayedIndexRange;k&&(z=k);z&&0===z.length||e&&!e.get(x)||f&&!f.get(x)||(m||(a.bind(g,d),m=!0),w||(g.bindVAO(t.vao),a.bindView(g,d),w=!0),n||a.bindInstance(g,p),this._stats.drawCallsInstanced++,h===l.TRIANGLES&&
(this._stats.trianglesRendered+=(p.to-p.from)/3),z?this._drawArraysFaceRange(z,p.from,h):g.drawArrays(h,p.from,p.to-p.from))}}}g.bindVAO(null);m&&a.release(g,d)};a.prototype._drawArraysFaceRange=function(b,a,d){for(var c=this._rctx,e=0;e<b.length;e++){var f=b[e];c.drawArrays(d,f[0]+a,f[1]-f[0]+1)}this._stats.drawCallsFragmented+=b.length-1};a.prototype._renderInternalMerged=function(b,a,d,c){var e=this._rctx,f=e.gl,k=!1,n;for(n in b.origin2data){var g=b.origin2data[n];d.origin=g.origin;c===y.STENCIL_MATERIAL&&
(this._stencilRenderingHelper.setEnableState(!0),this._stencilRenderingHelper.prepareStencilWritePass());if(!g.displayedIndexRange||0!==g.displayedIndexRange.length){k||(a.bind(e,d),k=!0);var l=a.getProgram();e.bindVAO(g.vao);D.assertCompatibleVertexAttributeLocations(g.vao,l);a.bindView(e,d);this._stats.drawCallsMerged++;l=a.getDrawMode(e);l===f.TRIANGLES&&(this._stats.trianglesRendered+=g.vao.vertexBuffers.geometry.size/3);g.displayedIndexRange?this._drawArraysFaceRange(g.displayedIndexRange,0,
l):e.drawArrays(l,0,D.vertexCount(g.vao,"geometry"))}}k&&a.release(e,d)};a.prototype._updateGlobalUniforms=function(b){for(var a=this._programRep.getProgramsUsingUniform("proj"),d=0;d<a.length;d++)a[d].setUniformMatrix4fv("proj",b);if(this._lighting)for(a=this._programRep.getProgramsUsingUniform("lightDirection"),d=0;d<a.length;d++)this._lighting.setUniforms(a[d])};a.prototype.print=function(){var b=Object.keys(this._mat2dataMerged).length,a=Object.keys(this._mat2dataInstanced).length;console.log("number of materials (merged/instanced): "+
b+"/"+a);var b=0,d;for(d in this._mat2dataMerged){var a=this._mat2dataMerged[d],c;for(c in a.origin2data)b+=Object.keys(a.origin2data[c].instances).length}var e=0;for(d in this._mat2dataInstanced)for(c in a=this._mat2dataInstanced[d],a.origin2data)e+=Object.keys(a.origin2data[c].instances).length;console.log("number of instances (merged/instanced): "+b+"/"+e)};a.prototype.isEmpty=function(){for(var b in this._mat2dataInstanced){var a=this._mat2dataInstanced[b],d;for(d in a.origin2data)if(!V(a.origin2data[d].instances))return!1}for(b in this._mat2dataMerged)for(d in a=
this._mat2dataMerged[b],a.origin2data)if(!V(a.origin2data[d].instances))return!1;return!0};a.prototype.modify=function(b,a,d,c){this._isRendering&&console.warn("Renderer.modify called while rendering");var e=[],f=[];this._mergedOrInstanced(b,e,f);b=[];var k=[];this._mergedOrInstanced(a,b,k);a={};d&&this._performUpdates(d,a);d=[];this._modifyMerged(e,b,d,a);this._modifyInstanced(f,k,d);this._updateMergedFaceranges(a);this._releaseMaterials(d);this._modifyMaterials(c);this._needsRender=!0};a.prototype._isInstanced=
function(b){var a=!1,d=P(b.data.faces.indices).length,a=(a=(a=a||!1===b.material.canBeMerged)||b.material.instanced)||b.material.isBackdrop;return b.singleUse?a:a=a||d>this._threshold};a.prototype._mergedOrInstanced=function(b,a,d){for(var c=0;c<b.length;++c)1>P(b[c].data.faces.indices).length||(this._isInstanced(b[c])?d.push(b[c]):a.push(b[c]))};a.prototype._performUpdates=function(b,a){for(var d=0;d<b.length;d++){var c=b[d],e=c.renderGeometry,f=this._isInstanced(e),c=c.updateType;c&2&&this._updateFaceranges(e,
f,a);c&4||!f&&c&16?this._updateVertexAttributes(e,f):f&&c&16?this._updateInstanceTransformation(e,f):c&8&&this._updateColorAttributes(e)}};a.prototype._updateFaceranges=function(b,a,d){var c=b.material.getId(),e=b.origin.id,f=(a?this._mat2dataInstanced:this._mat2dataMerged)[c].origin2data[e],n=f.instances[b.uniqueName];n&&(n.displayedIndexRange=k.generateVisibleIndexRanges(b.instanceParameters.componentVisibilities,b.componentOffsets),a||(d[this._modifiedMergedFacerangesKey(c,e)]=f))};a.prototype._updateMergedFaceranges=
function(b){for(var a in b){var d=b[a];d.displayedIndexRange=[];var c=d.instances,e=!0,f;for(f in c){var k=c[f];k.displayedIndexRange?(d.displayedIndexRange.push.apply(d.displayedIndexRange,p.offsetIntervals(k.displayedIndexRange,k.from)),e=!1):d.displayedIndexRange.push([k.from,k.to-1])}d.displayedIndexRange=e?null:p.mergeIntervals(d.displayedIndexRange)}};a.prototype._updateVertexAttributes=function(b,a){var d=b.material,c=d.getId(),c=(a?this._mat2dataInstanced:this._mat2dataMerged)[c].origin2data[b.origin.id],
e=c.instances[b.uniqueName],f,k;a||(f=b.origin.vec3,I(T,-f[0],-f[1],-f[2]),Q.multiply(T,b.transformation,N),Q.inverse(N,Z),Q.transpose(Z),f=N,k=Z);a=D.getStride(d.getVertexBufferLayout());var n=a/4;M(e.from+d.getOutputAmount(P(b.data.faces.indices).length)/n===e.to,"material VBO layout has changed");d.fillInterleaved(b.data,f,k,b.instanceParameters,c.buffer.getArray(),e.from*n);c.vao.vertexBuffers.geometry.setSubData(c.buffer.getArray(),e.from*a,e.from*a,e.to*a)};a.prototype._updateInstanceTransformation=
function(b,a){var d=b.origin.vec3,c=(a?this._mat2dataInstanced:this._mat2dataMerged)[b.material.getId()].origin2data[b.origin.id];a=c.instances[b.uniqueName];I(T,-d[0],-d[1],-d[2]);Q.multiply(T,b.transformation,a.transformation);Q.inverse(a.transformation,a.transformationNormal);Q.transpose(a.transformationNormal,a.transformationNormal);d=c.perGeometryDataInfo[b.data.id];if(c=d.instanceBufferData)b=c.getSlot(b.idx),c.fill(b,0,a.transformation),c.fill(b,16,a.transformationNormal),b=4*c.getOffset(b),
a=D.getStride(d.vao.layout.instance),d.vao.vertexBuffers.instance.setSubData(c.getArray(),b,b,b+a)};a.prototype._updateColorAttributes=function(b){var a=b.material,d=a.getId(),c=b.origin.id,d=(this._isInstanced(b)?this._mat2dataInstanced:this._mat2dataMerged)[d].origin2data[c],c=d.instances[b.uniqueName],e={};e[S.COLOR]=!0;var f=D.getStride(a.getVertexBufferLayout())/4;M(c.from+a.getOutputAmount(P(b.data.faces.indices).length)/f===c.to,"material VBO layout has changed");a.fillInterleaved(b.data,void 0,
void 0,b.instanceParameters,d.buffer.getArray(),c.from*f,e);d.vao.vertexBuffers.geometry.setSubData(d.buffer.getArray(),c.from*f*4,c.from*f*4,c.to*f*4)};a.prototype._modifyMerged=function(b,a,d,c){var e=this._rctx;b=this._compMat2delta(b,a,!1);for(var n in b){a=b[n];for(var g in a){var l=a[g],m=l.optimalCount,h=l.material,r=h.getVertexBufferLayout(),q=D.getStride(r)/4,t=this._mat2dataMerged[n];if(null==t){M(0<m);var w=h.getRenderPriority(),t={origin2data:{}};t[x.MATERIAL]=this._materialRep.aquire(h);
t[x.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(h);t[x.MATERIAL_NORMAL]=this._materialRep.aquireNormal(h);t[x.MATERIAL_DEPTH]=this._materialRep.aquireDepth(h);t[x.MATERIAL_HIGHLIGHT]=this._materialRep.aquireHighlight(h);this._mat2dataMerged[n]=t;this._orderedRendering&&this._insertIntoRenderOrder(t,w,"merged")}w=t.origin2data[g];null==w&&(M(0<m),w={instances:{},vao:new A(e,K.Default3D,{geometry:r},{geometry:z.createVertex(e,35044)}),buffer:new f(m),optimalCount:0,origin:l.origin},
t.origin2data[g]=w);if(0<m){var r=w.buffer.getSize(),u=w.buffer.getArray(),t=m<l.sparseCount/2,v=w.buffer.resize(t?m:l.sparseCount),p=l.toRemove;if(t||v){for(var r=0,y=w.buffer.getArray(),t=0;t<p.length;++t)v=w.instances[p[t].uniqueName],w.optimalCount-=(v.to-v.from)*q,delete w.instances[p[t].uniqueName];var t={},O;for(O in w.instances)v=w.instances[O],M(null==t[v.from]),t[v.from]=v;for(var B in t){var v=t[B],E=v.from*q,H=v.to*q;y.set(u.subarray(E,H),r);v.from=r/q;r+=H-E;v.to=r/q}M(r===w.optimalCount)}else for(t=
0;t<p.length;++t)v=p[t].uniqueName,M(void 0!==w.instances[v]),E=w.instances[v].from*q,H=w.instances[v].to*q,w.buffer.erase(E,H),delete w.instances[v],w.optimalCount-=H-E;I(T,-l.origin[0],-l.origin[1],-l.origin[2]);u=l.toAdd;l=!1;for(t=0;t<u.length;++t)p=u[t],E=p.data,Q.multiply(T,p.transformation,N),Q.inverse(N,Z),Q.transpose(Z),v=r,h.fillInterleaved(E,N,Z,p.instanceParameters,w.buffer.getArray(),r),E=h.getOutputAmount(P(E.faces.indices).length),y=v+E,M(null==w.instances[p.uniqueName]),H=k.generateVisibleIndexRanges(p.instanceParameters.componentVisibilities,
p.componentOffsets),v=new R(p.name,v/q,y/q,H,void 0,void 0,p.idx),H&&(l=!0),w.instances[p.uniqueName]=v,w.optimalCount+=E,r+=E;M(w.optimalCount===m);m=new Float32Array(w.buffer.getArray().buffer,0,w.buffer.getSize());w.vao.vertexBuffers.geometry.setData(m);if(l||w.displayedIndexRange)c[this._modifiedMergedFacerangesKey(n,g)]=w}else M(0===m),w.vao.dispose(!0),w.vao=null,delete t.origin2data[g],0===Object.keys(t.origin2data).length&&(d.push(n),delete this._mat2dataMerged[n],this._orderedRendering&&
this._removeFromRenderOrder(t,"merged"))}}};a.prototype._modifyInstanced=function(b,a,d){b=this._compMat2delta(b,a,!0);a=this._rctx;for(var c in b){var n=b[c],g;for(g in n){var l=n[g];if(0===l.optimalCount)l=this._mat2dataInstanced[c],l.origin2data[g].vao.dispose(!0),delete l.origin2data[g],0===Object.keys(l.origin2data).length&&(d.push(c),delete this._mat2dataInstanced[c],this._orderedRendering&&this._removeFromRenderOrder(l,"instanced"));else{var m=l.material,h=this._mat2dataInstanced[c];if(null==
h){var r=m.getRenderPriority(),h={origin2data:{}};h[x.MATERIAL]=this._materialRep.aquire(m);h[x.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(m);h[x.MATERIAL_NORMAL]=this._materialRep.aquireNormal(m);h[x.MATERIAL_DEPTH]=this._materialRep.aquireDepth(m);h[x.MATERIAL_HIGHLIGHT]=this._materialRep.aquireHighlight(m);this._mat2dataInstanced[c]=h;this._orderedRendering&&this._insertIntoRenderOrder(h,r,"instanced")}var q=m.getVertexBufferLayout(),t=h[x.MATERIAL].instanced?m.getInstanceBufferLayout():
void 0,w=t&&D.findAttribute(t,"instanceColor"),u=t&&D.findAttribute(t,"instanceFeatureAttribute"),v=D.getStride(q)/4,r=h.origin2data[g];null==r&&(r={instances:{},vao:new A(a,K.Default3D,{geometry:q},{geometry:z.createVertex(a,35044)}),buffer:new f(l.optimalCount),optimalCount:0,perGeometryDataInfo:{},origin:l.origin},h.origin2data[g]=r);var h=r.buffer.getSize(),p=r.buffer.getArray(),y=l.optimalCount<l.sparseCount/2,O=r.buffer.resize(y?l.optimalCount:l.sparseCount),B;for(B in l.perGeometryDelta){var E=
r.perGeometryDataInfo[B];if(E&&E.instanceBufferData){var H=l.perGeometryDelta[B].removeCount;0<H&&E.instanceBufferData.prepareFree(H)}}var C=l.toRemove;if(y||O){for(y=0;y<C.length;++y){O=C[y];delete r.instances[O.uniqueName];B=O.data.id;var aa=E=r.perGeometryDataInfo[B];0===--aa.refCount&&null==l.dataId2refCount[B]?(r.optimalCount-=(aa.to-aa.from)*v,delete r.perGeometryDataInfo[B]):E.instanceBufferData&&E.instanceBufferData.free(O.idx)}var h=0,y=r.buffer.getArray(),O={},J;for(J in r.perGeometryDataInfo)aa=
r.perGeometryDataInfo[J],M(null==O[aa.from]),O[aa.from]=aa;for(var F in O)aa=O[F],H=aa.from*v,E=aa.to*v,y.set(p.subarray(H,E),h),aa.from=h/v,h+=E-H,aa.to=h/v;for(var V in r.instances)H=r.instances[V],H.from=r.perGeometryDataInfo[H.dataId].from,H.to=r.perGeometryDataInfo[H.dataId].to}else for(y=0;y<C.length;++y)O=C[y],delete r.instances[O.uniqueName],B=O.data.id,E=r.perGeometryDataInfo[B],0===--E.refCount&&null==l.dataId2refCount[B]?(H=E.from*v,E=E.to*v,r.buffer.erase(H,E),r.optimalCount-=E-H,delete r.perGeometryDataInfo[B]):
E.instanceBufferData&&E.instanceBufferData.free(O.idx);I(T,-l.origin[0],-l.origin[1],-l.origin[2]);for(B in l.perGeometryDelta)(E=r.perGeometryDataInfo[B])&&E.instanceBufferData&&(y=l.perGeometryDelta[B].addCount,0<y&&E.instanceBufferData.prepareAllocate(y));p=l.toAdd;for(y=0;y<p.length;++y){O=p[y];H=O.data;B=H.id;E=r.perGeometryDataInfo[B];null==E?(m.fillInterleaved(H,void 0,void 0,void 0,r.buffer.getArray(),h),C=m.getOutputAmount(P(H.faces.indices).length),H=h/v,h+=C,E=h/v,r.optimalCount+=C,E={refCount:1,
from:H,to:E,vao:null,instanceBufferData:null},t&&(H=D.getStride(t)/4,E.vao=new A(a,K.Default3D,{geometry:q,instance:t},{geometry:r.vao.vertexBuffers.geometry,instance:z.createVertex(a,35044)}),E.instanceBufferData=new e(H,l.perGeometryDelta[B].addCount)),r.perGeometryDataInfo[B]=E):++E.refCount;M(E.from*v<=r.buffer.getSize()&&E.to*v<=r.buffer.getSize());H=Q.create();Q.multiply(T,O.transformation,H);C=k.generateVisibleIndexRanges(O.instanceParameters.componentVisibilities,O.componentOffsets);H=new R(O.name,
E.from,E.to,C,H,O.instanceParameters,O.idx,B);if(E=E.instanceBufferData)C=E.allocate(O.idx),E.fill(C,0,H.transformation),E.fill(C,16,H.transformationNormal),w&&E.fill(C,w.offset/4,O.instanceParameters.color),u&&E.fill(C,u.offset/4,O.instanceParameters.featureAttribute);r.instances[O.uniqueName]=H}M(r.optimalCount===l.optimalCount);m=new Float32Array(r.buffer.getArray().buffer,0,r.buffer.getSize());r.vao.vertexBuffers.geometry.setData(m);for(B in r.perGeometryDataInfo)if(q=r.perGeometryDataInfo[B],
q.vao&&(m=q.vao.vertexBuffers.instance))t=l.perGeometryDelta[B],0<t.addCount+t.removeCount&&(q=q.instanceBufferData.compact(),m.setData(q))}}}};a.prototype._compMat2delta=function(b,a,d){var c={};this._updateMat2delta(b,!0,d,c);this._updateMat2delta(a,!1,d,c);return c};a.prototype._updateMat2delta=function(b,a,d,c){for(var e=0;e<b.length;++e){var f=b[e],k=f.origin,n=f.material,g=n.getId(),l=d?this._mat2dataInstanced[g]:this._mat2dataMerged[g],l=l&&l.origin2data[k.id],m=c[g];null==m&&(m={},c[g]=m);
g=m[k.id];if(null==g){g={optimalCount:null==l?0:l.optimalCount,sparseCount:null==l?0:l.buffer.getSize(),material:n,toAdd:[],toRemove:[],perGeometryDelta:null,origin:k.vec3};if(d){var h={};if(void 0!==l)for(var r in l.perGeometryDataInfo)h[r]=l.perGeometryDataInfo[r].refCount;g.dataId2refCount=h;g.perGeometryDelta={}}m[k.id]=g}k=n.getOutputAmount(P(f.data.faces.indices).length);d?(n=f.data.id,l=g.perGeometryDelta[n],l||(l={addCount:0,removeCount:0},g.perGeometryDelta[n]=l),a?(l.addCount++,null==g.dataId2refCount[n]&&
(g.dataId2refCount[n]=0),1===++g.dataId2refCount[n]&&(g.optimalCount+=k,g.sparseCount+=k),g.toAdd.push(f)):(l.removeCount++,0===--g.dataId2refCount[n]&&(delete g.dataId2refCount[n],g.optimalCount-=k),g.toRemove.push(f))):a?(g.optimalCount+=k,g.sparseCount+=k,g.toAdd.push(f)):(g.optimalCount-=k,g.toRemove.push(f))}};a.prototype._modifiedMergedFacerangesKey=a.prototype._insertIntoRenderOrder=function(b,a,d){for(var c=b[x.MATERIAL].getMaterialId(),e=this._renderOrder.length,
f=0;f<e&&this._renderOrder[f][0]>=a;){var k=this._renderOrder[f][1];if(k.id===c){M(!k[d],"matData for type already exists");k[d]=b;return}f++}c={id:c,instanced:null,merged:null};c[d]=b;this._renderOrder.splice(f,0,[a,c])};a.prototype._removeFromRenderOrder=function(b,a){var d=b[x.MATERIAL].getMaterialId();for(b=0;this._renderOrder[b][1].id!==d;)b++;d=this._renderOrder[b][1];d[a]=null;d.instanced||d.merged||this._renderOrder.splice(b,1)};a.prototype._updateRenderOrder=function(b,a){for(var d=a.length,
c=0;c<d&&a[c][1].id!==b;)c++;if(c<d){b=a[c][1];b=(b.merged||b.instanced)[x.MATERIAL].getRenderPriority();var e=a[c][0];if(b!==a[c][0])for(a[c][0]=b,e=b>e?-1:1,c+=e;-1<c&&c<d&&e*a[c][0]>e*b;){var f=a[c];a[c]=a[c-e];a[c-e]=f;c+=e}}};a.prototype._modifyMaterials=function(b){for(var a in b)this._materialRep.updateMaterialParameters(a)};a.prototype.modifyRenderOrder=function(b){if(this._orderedRendering){for(var a in b)this._updateRenderOrder(a,this._renderOrder);this._needsRender=!0}};a.prototype._releaseMaterials=
function(b){if(Array.isArray(b))for(var a=0;a<b.length;a++)this._materialRep.release(b[a]),this._materialRep.releaseDepthShadowMap(b[a]),this._materialRep.releaseNormal(b[a]),this._materialRep.releaseDepth(b[a]),this._materialRep.releaseHighlight(b[a]);else this._materialRep.release(b),this._materialRep.releaseDepthShadowMap(b),this._materialRep.releaseNormal(b),this._materialRep.releaseDepth(b),this._materialRep.releaseHighlight(b)};a.prototype._name2indices=function(b){for(var a=new n,d=0;2>d;++d){var c=
0===d?this._mat2dataMerged:this._mat2dataInstanced,e;for(e in c){var f=c[e].origin2data,k;for(k in f){var g=f[k].instances,l;for(l in g){var m=g[l];void 0!==b[m.name]&&a.set(m.idx)}}}}return a};return a}();var L=function(){.prototype.reset=return b}(),R=
function(){return function(b,a,d,c,e,f,k,g){this.name=b;this.from=a;this.to=d;this.displayedIndexRange=c;this.transformation=e;this.instanceParameters=f;this.idx=k;this.dataId=g;null!=e&&(this.transformationNormal=Q.create(),Q.set(e,this.transformationNormal),Q.inverse(this.transformationNormal,this.transformationNormal),Q.transpose(this.transformationNormal,this.transformationNormal))}}(),U=a.create(),T=Q.identity(),N=Q.create(),Z=Q.create();return w})},"esri/views/3d/webgl-engine/lib/IntervalUtilities":function(){define(["require",
"exports"],function(a,h){return function(){function a(){}a.copyIntervals=function(a){for(var f=[],e=0;e<a.length;e++){var l=a[e];f.push([l[0],l[1]])}return f};a.convertFaceToIndexRange=function(a,f){for(var e=0;e<a.length;e++){var l=a[e];l[0]*=f;l[1]=l[1]*f+(f-1)}};a.sortIntervals=function(a){return a.sort(function(a,e){return a[0]===e[0]?a[1]>e[1]?1:a[1]<e[1]?-1:0:a[0]>e[0]?1:a[0]<e[0]?-1:0})};a.intersectIntervals=function(a,f){if(0>=a.length)return[];for(var e=[],l=0;l<a.length;l++){var g=a[l];
g[1]<f[0]||g[0]>f[1]||(g=[g[0],g[1]],g[0]<f[0]&&(g[0]=f[0]),g[1]>f[1]&&(g[1]=f[1]),e.push(g))}return e};a.mergeIntervals=function(a){if(0>=a.length)return[];var f=[];a=this.sortIntervals(a);f.push(a[0]);for(var e=1;e<a.length;e++){var l=f[f.length-1];l[1]+1<a[e][0]?f.push(a[e]):l[1]<a[e][1]&&(l[1]=a[e][1],f.pop(),f.push(l))}return f};a.invertIntervals=function(a,f){for(var e=[],l=0,g=0;g<a.length;g++){var c=a[g];c[0]>l&&e.push([l,c[0]-1]);l=c[1]+1}l<=f&&e.push([l,f]);return e};a.offsetIntervals=function(a,
f){for(var e=[],l=0;l<a.length;l++){var g=a[l];e.push([g[0]+f,g[1]+f])}return e};return a}()})},"esri/views/3d/webgl-engine/lib/Float32ArrayList":function(){define(["require","exports","./Util"],function(a,h,p){return function(){function a(a){null==a?a=16:65536>a&&(a=p.nextHighestPowerOfTwo(a));this.array=new Float32Array(a);this.size=0}a.prototype.resize=function(a,e){void 0===e&&(e=!1);this.size=a;var f;if(this.size>this.array.length){for(a=this.array.length||1;a<this.size;)a*=2;f=new Float32Array(a);
e&&f.set(this.array);this.array=f;return!0}if(this.size<=this.array.length/2){a=this.array.length;for(f=2*this.size;a>=f;)a=Math.floor(a/2);f=new Float32Array(a);e&&f.set(this.array.subarray(0,a));this.array=f;return!0}return!1};a.prototype.append=function(a){var e=this.size;this.resize(this.size+a.length,!0);this.array.set(a,e)};a.prototype.erase=function(a,e){for(;a<e;++a)this.array[a]=0};a.prototype.getArray=function(){return this.array};a.prototype.getSize=function(){return this.size};return a}()})},
"esri/views/3d/webgl-engine/lib/InstanceBufferData":function(){define(["require","exports","./Util"],function(a,h,p){return function(){function a(a,e){null==e&&(e=4);var f=p.nextHighestPowerOfTwo(e*a);this.array=new Float32Array(f);this.zeroItem=new Float32Array(a);this.endSlot=0;this.perInstanceDataSize=a;this.emptySlots=[];this.emptySlotsIdx=0;this.id2slot={};this.slot2id=Array(e)}a.prototype.prepareFree=a.prototype.free=function(a){a=this.id2slot[a];null!=
a&&(this.emptySlots[this.emptySlotsIdx++]=a,this.slot2id[a]=void 0)};a.prototype.prepareAllocate=function(a){a-=this.emptySlotsIdx;0<a&&this._resizeArray((this.endSlot+a)*this.perInstanceDataSize)};a.prototype.allocate=function(a){var e;e=0<this.emptySlotsIdx?this.emptySlots[--this.emptySlotsIdx]:this.endSlot++;this.id2slot[a]=e;this.slot2id[e]=a;return e};a.prototype.getSlot=function(a){return this.id2slot[a]};a.prototype.getOffset=a.prototype.getArray=
function(){return this.array};a.prototype.fill=function(a,e,l){this.array.set(l,a*this.perInstanceDataSize+e)};a.prototype.compact=function(){if(0<this.emptySlotsIdx){this.emptySlots.length=this.emptySlotsIdx;for(this.emptySlots.sort(function(a,b){return a-b});0<this.emptySlotsIdx&&this.emptySlots[this.emptySlotsIdx-1]===this.endSlot;)this.emptySlotsIdx--,this.endSlot--;for(;0<this.emptySlotsIdx;){this.emptySlotsIdx--;var a=this.endSlot-1,e=this.emptySlots[this.emptySlotsIdx],l=a*this.perInstanceDataSize,
g=e*this.perInstanceDataSize;this.array.set(this.array.subarray(l,l+this.perInstanceDataSize),g);this.array.set(this.zeroItem,l);l=this.slot2id[a];this.slot2id[a]=void 0;this.slot2id[e]=l;this.id2slot[l]=e;this.endSlot--}}this._resizeArray(this.endSlot*this.perInstanceDataSize);this.emptySlots.length=0;return this.array};a.prototype._resizeArray=function(a){var e;if(a>this.array.length){for(e=this.array.length||1;e<a;)e*=2;a=new Float32Array(e);a.set(this.array);this.array=a}else if(a<=this.array.length/
2){e=this.array.length;for(a*=2;e>=a;)e/=2;a=new Float32Array(e);a.set(this.array.subarray(0,e));this.array=a}};return a}()})},"esri/views/3d/webgl-engine/lib/Lighting":function(){define(["require","exports","./gl-matrix"],function(a,h,p){var m=p.vec3d,f=p.vec4d;return function(){function a(a,e,c,b){this.ambient=f.create(a);this.diffuse=f.create(e);this.specular=f.create(c);this.direction=m.create(b)}a.prototype.setUniforms=a.prototype.set=function(a){a.ambient&&f.set(a.ambient,this.ambient);a.diffuse&&f.set(a.diffuse,this.diffuse);a.specular&&f.set(a.specular,this.specular);a.direction&&m.set(a.direction,this.direction)};a.prototype.get=return a}()})},"esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial":function(){define("require exports dojo/text!./SimpleGLMaterial.xml ./MaterialUtil ../../lib/RenderSlot ../../../../webgl/Program ../../../../webgl/enums ../../lib/DefaultVertexAttributeLocations".split(" "),
function(a,h,p,m,f,e,l,g){return function(){function a(b,a,c,e){void 0===e&&(e=4);this.id=m.__GLMaterial_id++;this.program=b.get("simple");this.color=a;this.depthFunc=c;this.drawMode=e}a.prototype.getId=function(){return this.id};a.prototype.beginSlot=function(b){return b===f.INTERNAL_MATERIAL};a.prototype.getProgram=function(){return this.program};a.prototype.bind=function(b,a){b.bindProgram(this.program);this.program.setUniformMatrix4fv("model",m.IDENTITY);this.program.setUniformMatrix4fv("proj",
a.proj);this.program.setUniform4fv("color",this.color);b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(b.gl.SRC_ALPHA,b.gl.ONE_MINUS_SRC_ALPHA,b.gl.ONE,b.gl.ONE_MINUS_SRC_ALPHA);b.setDepthTestEnabled(!0);void 0!==this.depthFunc&&b.setDepthFunction(this.depthFunc)};a.prototype.release=function(b){void 0!==this.depthFunc&&b.setDepthFunction(513);b.setBlendingEnabled(!1)};a.prototype.bindView=function(b,a){m.bindView(a.origin,a.view,this.program)};a.prototype.bindInstance=a.prototype.getDrawMode=a.loadShaders=function(b,a,c,f){b._parse(p);b=new e(f,b.vertexShaderSimple,b.fragmentShaderSimple,g.Default3D);c.add("simple",b)};return a}()})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define("../../lib/IdGen ../../lib/gl-matrix ../../parts/Model ../../lib/ComponentUtils ../../lib/Util ../../../../webgl/Util".split(" "),function(a,h,p,m,f,e){var l=h.vec3d,g=h.mat4d,c=h.mat4,b=f.VertexAttrConstants,
q={};q.__Material_idGen=new a;q.__GLMaterial_id=0;q.IDENTITY=g.identity();q.fill=function(b,a,d,c,e,f){if(void 0===e||3!==f)for(e=0;e<f;++e)d[c+e]=b[a+e];else{var k=b[a],g=b[a+1];b=b[a+2];d[c]=e[0]*k+e[4]*g+e[8]*b+e[12];d[c+1]=e[1]*k+e[5]*g+e[9]*b+e[13];d[c+2]=e[2]*k+e[6]*g+e[10]*b+e[14]}return f};var x=function(b,a,d,c,e,f){for(var k=b.length,g=0;g<k;++g){for(var n=d*b[g],l=0;l<d;++l)c[e+l]=a[n+l];e+=f}};q.fillInterleaved=function(a,d,c,f,k,g,n,l){for(var m=e.getStride(k)/4,h=0;h<k.length;h++){var r=
k[h],q=n+r.offset/4,r=r.name;if(null==l||null!=l[r]){var t;switch(r){case "uv0":t=a.vertexAttr[r];null!=t&&x(a.faces.indices[r],t.data,t.size,g,q,m);break;case "region":t=a.vertexAttr[r];var r=a.faces.indices[r],w=t.data,u=t.size;t=g;var v=m;t=new Uint16Array(t.buffer);for(var q=2*q,v=2*v,p=r.length,y=0;y<p;++y){var A=u*r[y],z;for(z=0;z<u;++z)t[q+z]=w[A+z];q+=v}break;case "color":t=a.vertexAttr[r];if(f&&f.color)for(r=a.faces.indices[r],w=t.data,u=f.color,t=t.size,v=g,p=m,v=new Uint8Array(v.buffer),
q*=4,p*=4,y=r.length,A=0;A<y;++A){z=t*r[A];var D;for(D=0;D<t;++D)v[q+D]=w[z+D]*u[D];4>D&&(v[q+3]=255*u[3]);q+=p}else for(r=a.faces.indices[r],w=t.data,u=t.size,t=g,v=m,t=new Uint8Array(t.buffer),q*=4,v*=4,p=r.length,y=0;y<p;++y){A=u*r[y];for(z=0;z<u;++z)t[q+z]=w[A+z];4>z&&(t[q+3]=255);q+=v}break;default:if(t=a.vertexAttr[r],u=r===b.POSITION?d:r===b.NORMAL?c:void 0,void 0!==u&&3===t.size)for(r=a.faces.indices[r],w=t.data,t=g,v=m,p=r.length,y=0;y<p;++y)D=3*r[y],A=w[D],z=w[D+1],D=w[D+2],t[q]=u[0]*A+
u[4]*z+u[8]*D+u[12],t[q+1]=u[1]*A+u[5]*z+u[9]*D+u[13],t[q+2]=u[2]*A+u[6]*z+u[10]*D+u[14],q+=v;else x(a.faces.indices[r],t.data,t.size,g,q,m)}}}};q.triangleVertexArrayToWireframeLines=function(b,a,d,c){for(d=Math.floor(d/3)-1;0<=d;d--){var e=a+3*d*c,f=a+6*d*c+5*c;this.fill(b,e,b,f,null,c);f-=c;this.fill(b,e+c,b,f,null,c);f-=c;this.fill(b,e+c,b,f,null,c);f-=c;this.fill(b,e+2*c,b,f,null,c);f-=c;this.fill(b,e+2*c,b,f,null,c);f-=c;this.fill(b,e,b,f,null,c)}};var y=l.create(),t=l.create(),u=l.create(),
r=l.create(),n=function(b,a,d,c,e,f){var k=b.getCenter();l.project(k,d,c,y);var g=l.dist2(y,k),h=b.getBSRadius(),k=a.visibilities,q=a.offsets;if(g<h*h){var g=b.getPrimitiveIndices(),h=b.getIndices(),w=b.getPosition(),p=g?g.length:h.length/3;if(1E4<p&&(b=b.getChildren(),void 0!==b)){for(k=0;8>k;++k)void 0!==b[k]&&n(b[k],a,d,c,e,f);return}a=w.size;b=w.data;var w=d[0],v=d[1];d=d[2];var x=c[0]-w,A=c[1]-v;c=c[2]-d;for(var z=m.createVisibilityCache(),D=0;D<p;++D){var B=g?g[D]:D;if(m.lookupOffsetVisibility(k,
q,3*B,z)){var C=a*h[3*B],U=a*h[3*B+1],T=a*h[3*B+2],N=b[C],Z=b[C+1],C=b[C+2],H=b[U],O=b[U+1],U=b[U+2],aa=b[T],ba=b[T+1],T=b[T+2],X=H-N,ea=O-Z,la=U-C,ta=aa-N,ma=ba-Z,wa=T-C,na=A*wa-ma*c,sa=c*ta-wa*x,Ea=x*ma-ta*A,pa=X*na+ea*sa+la*Ea;if(!(pa>-e&&pa<e)){var pa=1/pa,qa=w-N,ua=v-Z,va=d-C,na=pa*(qa*na+ua*sa+va*Ea);0>na||1<na||(sa=ua*la-ea*va,la=va*X-la*qa,X=qa*ea-X*ua,ea=pa*(x*sa+A*la+c*X),0>ea||1<na+ea||(ta=pa*(ta*sa+ma*la+wa*X),0<=ta&&(ma=t,wa=u,pa=r,l.set3(N,Z,C,ma),l.set3(H,O,U,wa),l.set3(aa,ba,T,pa),
l.subtract(wa,ma,wa),l.subtract(pa,ma,pa),l.normalize(l.cross(wa,pa,ma)),f(ta,ma,B))))}}}}};q.intersectTriangleGeometry=function(b,a,d,c,e,k,g){d=b.getData();a={offsets:d.componentOffsets,visibilities:a.componentVisibilities};f.assert("triangle"===d.primitiveType);n(b.getBoundingInfo(0),a,e,k,c.tolerance,g)};q.basicMaterialConstructor=function(b,a){var d=!0,c=0,e=q.__Material_idGen.gen(a);b.getId=function(){return e};var k;b.getParentStage=function(){return k};b.addParentStage=function(b){f.assert(void 0===
k,"Material can only be added to a single Stage");k=b};b.removeParentStage=b.setVisible=function(a){d!==a&&(d=a,b.notifyDirty("matChanged"))};b.isVisible=function(){return d};b.notifyDirty=b.setRenderPriority=function(b){c=b;this.notifyDirty("matChanged")};b.getRenderPriority=function(){return c}};var w=q.aquireIfNotUndefined=function(b,a,d,c){if(void 0!==b)return d.aquire(b,a,c)},d=q.releaseIfNotUndefined=k=c.create();q.bindView=function(b,a,d){c.translate(a,b,k);d.setUniformMatrix4fv("view",k)};q.bindCamPos=function(b,a,d){d.setUniform3f("camPos",a[3]-b[0],a[7]-b[1],a[11]-b[2])};q.basicGLMaterialConstructor=function(b,a){var d=q.__GLMaterial_id++;b.getId=function(){return d};b.getMaterialId=function(){return a.getId()};b.isVisible=function(){return a.isVisible()};b.getRenderPriority=function(){return a.getRenderPriority()}};q.singleTextureGLMaterialConstructor=function(b,
a,c,e){var f=w(c.textureId,c.initTexture,a,e);b.updateTexture=function(b){c.textureId!==b&&(d(c.textureId,a),c.textureId=b,f=w(c.textureId,c.initTexture,a,e))};b.renderTexture=function(b){(b=a.getTexture(c.textureId))&&b.dirty&&b.redraw&&b.redraw()};b.bindTexture=function(b,a){void 0!==f&&(a.setUniform1i("tex",0),b.bindTexture(f.getGLTexture()))};b.bindTextureSize=function(b,a){void 0!==f&&(b=f.getGLTexture(),a.setUniform2f("texSize",b.descriptor.width,b.descriptor.height))};b.dispose=;q.multiTextureGLMaterialConstructor=function(b,a,c,e){for(var f=e.length,k=Array(f),g=0;g<f;g++)k[g]=w(c[e[g][0]],c[e[g][1]],a);b.updateTextures=function(b){for(var g=0;g<f;g++){var n=c[e[g][0]],l=b[e[g][0]];n!==l&&(d(n,a),c[e[g][0]]=l,k[g]=w(l,c[e[g][1]],a))}};b.bindTextures=function(b,a){for(var d=0;d<f;d++)void 0!==k[d]&&(a.setUniform1i(e[d][2],d),b.bindTexture(k[d].getGLTexture(),d));b.setActiveTexture(0)};b.bindOneTexture=function(b,a,d){a.setUniform1i(e[d][2],d);b.bindTexture(k[d].getGLTexture(),
d);b.setActiveTexture(0)};b.disposeTextures=function(){for(var b=0;b<f;b++)d(c[e[b][0]],a)}};q.externalColorMixModes={multiply:1,ignore:2,replace:3,tint:4};return q})},"esri/views/3d/webgl-engine/lib/IdGen":function(){define(["require","exports"],function(a,h){return function(){.prototype.gen=function(a){null==a&&(a="a");return a+"_"+this._count++};return a}()})},"esri/views/3d/webgl-engine/lib/ComponentUtils":function(){define(["require","exports","../../../../core/arrayUtils"],
function(a,h,p){function m(b){void 0===b&&(b=!0);return{isVisibleBit:!b,data:new Uint32Array(0)}}function f(b,a){return l(b,a,!0)}unction l(a,c,e){var f=!1;a=a||b;var g=a.data;c=c.length-1;var n=8*g.BYTES_PER_ELEMENT,f=g.length*n;a=e===a.isVisibleBit;if(0===g.length||0===c)f=!a;else if(f<c&&!a)f=!0;else{var l=q[n];e=q[0];for(var d=0;d<g.length-1;d++)if(f=!a&&g[d]!==l||a&&g[d]!==e)return f;f=g.length-1;c=q[(c-1)%n+1];f=!a&&(g[f]&c)!==c||a&&(g[f]&c)!==e}return f}unction c(b,a,c,e){var f=c/e|0;return 0!==(a[f]&1<<c-f*e)===b}h.updateVisibility=function(b,a,c,e){if(c<a.length-1){null==b&&(b=m());var f=b.data,g=8*f.BYTES_PER_ELEMENT,l=c/g|0,d=c-g*l;a=(a.length-1-1)/g|0;var k=f;e=e===b.isVisibleBit;c<k.length*g||!e||(c=Math.max(l+1,Math.ceil(1.5*k.length)),c=Math.min(c,a+1),f=new Uint32Array(c),f.set(k));l<f.length&&(f[l]=f[l]&~(1<<d)|(e?1:0)<<d);b.data=f}return b};h.getVisibility=function(b,a){if(null!=b){var e=b.isVisibleBit,f=b.data,g=8*f.BYTES_PER_ELEMENT;
return a<f.length*g?c(e,f,a,g):!b.isVisibleBit}return!0};h.createVisibilityCache=function(b){void 0===b&&(b=0);return{startComponentIdx:b}};h.lookupOffsetVisibility=function(b,a,e,f){if(null==b)return!0;var g=!b.isVisibleBit;if(0<a.length&&e<a[a.length-1]){var n=b.isVisibleBit;b=b.data;var l=8*b.BYTES_PER_ELEMENT,d=b.length*l,k=f?f.startComponentIdx:null;if(!(k&&a[k]<=e&&a[k+1]>e)){var m;if(m=k)m=k+1,m=a[m]<=e&&a[m+1]>e;k=m?k+1:p.binaryIndexOf(a,e,!0)}k<d&&(g=c(n,b,k,l));f&&(f.startComponentIdx=k)}return g};
h.hideAllComponents=function(b){if(null==b)b=m(!1);else{b.isVisibleBit=!0;for(var a=0;a<b.data.length;a++)b.data[a]=0}return b};h.unhideAllComponents=function(b){var a;if(null!=b)for(a=b,a.isVisibleBit=!1,b=0;b<a.data.length;b++)a.data[b]=0;return a};h.generateVisibleIndexRanges=function(b,a){var e;if(b)if(g(a))if(0===b.data.length)e=[],a=[[a[0],a[a.length-1]-1]],e=b.isVisibleBit?e:a;else{e=[];var f=b.isVisibleBit;b=b.data;for(var l=8*b.BYTES_PER_ELEMENT,n=b.length*l,m=a.length-1,d=null,k=0;k<n&&
k<m;k++){var h=c(f,b,k,l);if(h!==d){var d=a[k],q=e[e.length-1];h?e.push([d,-1]):q&&(q[1]=d-1);d=h}}(f=e[e.length-1])&&-1===f[1]&&(f[1]=a[a.length-1]-1)}else e=[],e=b.isVisibleBit?e:null;else e=null;return e};h.defaultVisibilities=m;h.isAllVisible=function(b,a){return!e(b,a)};h.isAllHidden=h.hasVisible=f;h.hasHidden=e;var b=m();h.createOffsets=function(b){return Array.isArray(b)?new Uint32Array(b):b};h.hasComponent=h.hasComponents=g;var q=
[];for(a=0;65>a;a++)q.push(Math.pow(2,a)-1)})},"esri/core/arrayUtils":function(){define([],function(){unction h(a,m,f){return!a.some(m.bind(null,f))}return{findIndex:function(a,m,f){for(var e=a.length,l,g=0;g<e;g++)if(l=a[g],m.call(f,l,g,a))return g;return-1},find:function(a,m,f){for(var e=a.length,l,g=0;g<e;g++)if(l=a[g],m.call(f,l,g,a))return l},equals:function(a,m,f){if(!a&&!m)return!0;if(!a||!m||a.length!=m.length)return!1;if(f)for(var e=0;e<a.length;e++){if(!f(a[e],
m[e]))return!1}else for(f=0;f<a.length;f++)if(a[f]!==m[f])return!1;return!0},difference:function(p,m,f){var e;f?(e=m.filter(h.bind(null,p,f)),p=p.filter(h.bind(null,m,f))):(e=m.filter(a.bind(null,p)),p=p.filter(a.bind(null,m)));return{added:e,removed:p}},range:function(a,m){null==m&&(m=a,a=0);for(var f=Array(m-a),e=a;e<m;e++)f[e-a]=e;return f},constant:function(a,m){for(var f=Array(a),e=0;e<a;e++)f[e]=m;return f},binaryIndexOf:function(a,m,f){for(var e=a.length,l=0,g=e-1;l<g;){var c=l+Math.floor((g-
l)/2);m>a[c]?l=c+1:g=c}g=a[l];return f?m>=a[e-1]?-1:g===m?l:l-1:g===m?l:-1}}})},"esri/views/webgl/Util":function(){define(["require","exports","../../core/Error"],function(a,h,p){return function(){function a(){}a.vertexCount=a.getStride=a.addDescriptor=function(a,e,l,g,c,b){var f=0;switch(g){case 5126:f=4;break;case 5124:f=4;break;case 5125:f=4;break;case 5122:f=2;break;case 5123:f=2;break;case 5120:f=
1;break;case 5121:f=1;break;default:throw Error("Unknown data type");}if(0<a.length){var m=a[0].stride,h=m+f*l;a.forEach(function(b){return b.stride=h});a.push({name:e,count:l,type:g,offset:m,stride:h,normalized:c,divisor:b})}else a.push({name:e,count:l,type:g,offset:0,stride:f*l,normalized:c,divisor:b})};a.assertCompatibleVertexAttributeLocations=a.hasAttribute=a.findAttribute=a.copyFramebufferToTexture=a.assert=
return a}()})},"esri/views/3d/webgl-engine/lib/RenderSlot":function(){define(["require","exports"],function(a,h){var p;a=p||(p={});a[a.BACKGROUND=0]="BACKGROUND";a[a.INTERNAL_MATERIAL=1]="INTERNAL_MATERIAL";a[a.STENCIL_MATERIAL=2]="STENCIL_MATERIAL";a[a.OPAQUE_TERRAIN=3]="OPAQUE_TERRAIN";a[a.OPAQUE_MATERIAL=4]="OPAQUE_MATERIAL";a[a.OPAQUE_EXTERNAL=5]="OPAQUE_EXTERNAL";a[a.TRANSPARENT_MATERIAL=6]="TRANSPARENT_MATERIAL";a[a.TRANSPARENT_EXTERNAL=7]="TRANSPARENT_EXTERNAL";a[a.TRANSPARENT_TERRAIN=8]="TRANSPARENT_TERRAIN";
a[a.OCCLUSION_PIXELS=9]="OCCLUSION_PIXELS";a[a.POSTPROCESSING_HIGHLIGHT=10]="POSTPROCESSING_HIGHLIGHT";a[a.POSTPROCESSING_ATMOSPHERE=11]="POSTPROCESSING_ATMOSPHERE";a[a.OVERLAY=12]="OVERLAY";a[a.MAX_SLOTS=13]="MAX_SLOTS";return p})},"esri/views/webgl/Program":function(){define(["require","exports","dojo/has"],function(a,h,p){a=function(){function a(f,e,l,g,c){this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines=void 0;
this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};f||console.error("RenderingContext isn't initialized!");0===e.length&&console.error("Shaders source should not be empty!");this._context=f;this._vertexShaderSource=e;this._fragmentShaderSource=l;this._defines=c;this._id=a._nextId++;this._locations=g}Object.defineProperty(a.prototype,
"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),
this._glName=null)};a.prototype.initialize=a.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};a.prototype.hasUniform=a.prototype.getAttribLocation=a.prototype.setUniform1i=function(a,e){var f=this._nameToUniform1[a];if(void 0===f||e!==f)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),e),this._nameToUniform1[a]=e};a.prototype.setUniform1f=a.prototype.setUniform1fv=function(f,e){var l=this._nameToUniform2[f];void 0!==l&&a._arraysEqual(e,l)||(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(f),e),void 0===l?this._nameToUniform2[f]=new Float32Array(e):l.set(e))};a.prototype.setUniform2f=a.prototype.setUniform2fv=function(f,e){var l=this._nameToUniform2[f];void 0!==l&&a._arraysEqual(e,l)||(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(f),e),void 0===l?this._nameToUniform2[f]=new Float32Array(e):l.set(e))};a.prototype.setUniform3f=a.prototype.setUniform3fv=function(f,e){var l=this._nameToUniform3[f];void 0!==l&&a._arraysEqual(e,l)||(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(f),e),void 0===l?this._nameToUniform3[f]=new Float32Array(e):l.set(e))};a.prototype.setUniform4f=a.prototype.setUniform4fv=a.prototype.setUniformMatrix3fv=function(f,e,l){void 0===l&&(l=!1);var g=this._nameToUniformMatrix3[f];
void 0!==g&&(9===g.length?a._matrix3Equal(g,e):a._arraysEqual(e,g))||(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(f),l,e),void 0===g?this._nameToUniformMatrix3[f]=new Float32Array(e):g.set(e))};a.prototype.setUniformMatrix4fv=function(f,e,l){void 0===l&&(l=!1);var g=this._nameToUniformMatrix4[f];void 0!==g&&(16===g.length?a._matrix4Equal(g,e):a._arraysEqual(e,g))||(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(f),
l,e),void 0===g?this._nameToUniformMatrix4[f]=new Float32Array(e):g.set(e))};a._padToThree=a.prototype._addLineNumbers=a.prototype._loadShader=function(a){var e=35633===a?this._vertexShaderSource:this._fragmentShaderSource;if(void 0!==this._defines){var f="";if(Array.isArray(this._defines))for(var g=0,c=this._defines;g<c.length;g++)var b=
c[g],f=f+("#define "+b+"\n");else for(b in this._defines)f+="#define "+b+"\n";e=f+e}f=this._context.gl;a=f.createShader(a);f.shaderSource(a,e);f.compileShader(a);f.getShaderParameter(a,f.COMPILE_STATUS)||(console.error(f.getShaderInfoLog(a)),console.error(this._addLineNumbers(e)));return a};a._matrix4Equal=a._matrix3Equal=a._arraysEqual=return a}();a._nextId=0;return a})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["require","exports"],},"esri/views/3d/webgl-engine/lib/LinearDepthTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(a,h,p,m,f){return function(){function a(a){this._rctx=a;this._depthFBO=void 0;this.height=this.width=this.viewportToRestore=null}a.prototype.setEnableState=function(a){a!==this.getEnableState()&&
(a?this.enable():this.disable())};a.prototype.getEnableState=function(){return void 0!==this._depthFBO};a.prototype.getDepthFBO=function(){return this._depthFBO};a.prototype.enable=function(){p.assert(!this.getEnableState());this._depthFBO=m.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})};a.prototype.disable=function(){p.assert(this.getEnableState());this._depthFBO.dispose();this._depthFBO=
void 0};a.prototype.setupFBOs=function(a){p.assert(this.getEnableState());this.viewportToRestore=a=a.fullViewport;this.width=a[2];this.height=a[3];this._rctx.setViewport(0,0,this.width,this.height)};a.prototype.prepareDepthPass=function(){p.assert(this.getEnableState());var a=this._rctx,e=a.gl;this._depthFBO.resize(this.width,this.height);a.bindFramebuffer(this._depthFBO);a.setClearColor(0,0,0,0);a.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)};a.prototype.finish=function(a){var e=this._rctx;e.bindFramebuffer(a);
e.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return a}()})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports","./Texture"],function(a,h,p){a=function(){function a(f,e,l,g){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=null;this._initialized=!1;this._context=f;this._desc={colorTarget:e.colorTarget,depthStencilTarget:e.depthStencilTarget,width:e.width,
height:e.height,multisampled:e.multisampled};this._id=a._nextId++;l&&(f=void 0,l instanceof p?(this._colorAttachment=l,f=l.descriptor):(f=l,this._colorAttachment=new p(this._context,f)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),a._validateTextureDimensions(f,this._desc));g&&(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),
l=void 0,g instanceof p?(this._depthStencilTexture=g,l=this._depthStencilTexture.descriptor):(l=g,this._depthStencilTexture=new p(this._context,l)),a._validateTextureDimensions(l,this._desc))}a.create=a.createWithAttachments=Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"colorTexture",{get:enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"width",{get:function(){return this._desc.width},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._context&&this._glName&&(this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),this._context.gl.deleteFramebuffer(this._glName),this._glName=null)};a.prototype.attachColorTexture=a.prototype.detachColorTexture=a.prototype.attachDepthStencilTexture=a.prototype.detachDepthStencilTexture=
a.prototype.copyToTexture=a.prototype.readPixels=a.prototype.resize=function(f,e){var l=this._desc;if(l.width!==f||l.height!==e)if(this._initialized)l.width=f,l.height=e,this._colorAttachment instanceof p?(g=this._colorAttachment,l=g.descriptor,
l.width=f,l.height=e,this._colorAttachment=new p(this._context,l),a._validateTextureDimensions(g.descriptor,this._desc)):this._colorAttachment=null,null!=this._depthStencilTexture&&(l=this._depthStencilTexture.descriptor,l.width=f,l.height=e,this._depthStencilTexture=new p(this._context,l)),this._initialized=!1;else{l.width=f;l.height=e;if(this._colorAttachment instanceof p){var g=this._colorAttachment;g.resize(f,e)}this._depthStencilTexture&&this._depthStencilTexture.resize(f,e)}};a.prototype.initialize=
function(){if(this._initialized)return!1;var a=this._context.gl,e=a.createFramebuffer(),l=this._desc;a.bindFramebuffer(a.FRAMEBUFFER,e);if(!this._colorAttachment)if(0===l.colorTarget)this._colorAttachment=new p(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:l.width,height:l.height});else{var g=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,g);a.renderbufferStorage(a.RENDERBUFFER,a.RGBA4,l.width,l.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,
a.COLOR_ATTACHMENT0,a.RENDERBUFFER,g);this._colorAttachment=g}this._colorAttachment instanceof p&&a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this._colorAttachment.glName,0);switch(l.depthStencilTarget){case 1:case 3:g=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,g);var c=1===l.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT;a.renderbufferStorage(a.RENDERBUFFER,1===l.depthStencilTarget?a.DEPTH_COMPONENT16:a.DEPTH_STENCIL,l.width,l.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,
c,a.RENDERBUFFER,g);this._depthAttachment=g;break;case 2:g=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,g);a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX8,l.width,l.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,g);this._stencilAttachment=g;break;case 4:this._depthStencilTexture||(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),
this._depthStencilTexture=new p(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:l.width,height:l.height})),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,this._depthStencilTexture.glName,0)}a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!");this._glName=e;return this._initialized=!0};a.prototype._disposeColorAttachment=a.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,null)}a.deleteRenderbuffer(this._depthAttachment);this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),e=this._context.gl,
e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,null)),a.deleteRenderbuffer(this._stencilAttachment),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),a=this._context.gl,a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};a._validateTextureDimensions=return a}();a._nextId=0;return a})},"esri/views/3d/webgl-engine/lib/NormalTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(a,h,p,m,f){return function(){function a(a){this.rctx=
a;this.normalFBO=void 0;this.height=this.width=this.viewportToRestore=null}a.prototype.setEnableState=function(a){a!==this.getEnableState()&&(a?this.enable():this.disable())};a.prototype.getEnableState=a.prototype.getNormalFBO=function(){return this.normalFBO};a.prototype.enable=function(){p.assert(!this.getEnableState());this.normalFBO=m.createWithAttachments(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,
height:0},{colorTarget:0,depthStencilTarget:1})};a.prototype.disable=function(){p.assert(this.getEnableState());this.normalFBO.dispose();this.normalFBO=void 0};a.prototype.setupFBOs=function(a){p.assert(this.getEnableState());this.viewportToRestore=a=a.viewport;this.width=a[2];this.height=a[3];this.rctx.setViewport(0,0,this.width,this.height)};a.prototype.prepareNormalPass=function(){p.assert(this.getEnableState());var a=this.rctx,e=a.gl;this.normalFBO.resize(this.width,this.height);a.bindFramebuffer(this.normalFBO);
a.setClearColor(0,0,0,0);a.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)};a.prototype.finish=function(a){var e=this.rctx;e.bindFramebuffer(a);e.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return a}()})},"esri/views/3d/webgl-engine/lib/HighlightTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(a,h,p,m,f){return function(){.prototype.setEnableState=function(a){a!==this.getEnableState()&&(a?this.enable():this.disable())};a.prototype.getEnableState=function(){return null!==this.fbo};a.prototype.getHighlightFBO=function(){return this.fbo};a.prototype.getBlurFBO=function(){return this.fbo2};a.prototype.enable=function(){p.assert(!this.getEnableState());this.fbo=m.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,
wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})};a.prototype.disable=function(){p.assert(this.getEnableState());this.fbo.dispose();this.fbo=null};a.prototype.setupFBOs=function(a){p.assert(this.getEnableState());this.viewportToRestore=a=a.fullViewport;this.width=a[2];this.height=a[3];this._rctx.setViewport(0,0,this.width,this.height)};a.prototype.prepareHighlightPass=function(){p.assert(this.getEnableState());var a=this._rctx,e=a.gl;this.fbo.resize(this.width,this.height);a.bindFramebuffer(this.fbo);
a.setClearColor(0,0,0,0);a.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)};a.prototype.finish=function(a){var e=this._rctx;e.bindFramebuffer(a);e.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return a}()})},"esri/views/3d/webgl-engine/lib/RenderPass":function(){define(["require","exports"],function(a,h){var p;a=p||(p={});a[a.MATERIAL=0]="MATERIAL";a[a.MATERIAL_DEPTH=1]="MATERIAL_DEPTH";a[a.MATERIAL_NORMAL=2]="MATERIAL_NORMAL";a[a.MATERIAL_DEPTH_SHADOWMAP=
3]="MATERIAL_DEPTH_SHADOWMAP";a[a.MATERIAL_HIGHLIGHT=4]="MATERIAL_HIGHLIGHT";a[a.MAX_PASS=5]="MAX_PASS";return p})},"esri/views/3d/webgl-engine/lib/RenderContext":function(){define(["require","exports","./RenderSlot","./RenderPass"],function(a,h,p,m){return function(){return function(){this.normals=this.lightingData=this.highlight=this.filterFaceRange=this.filterContent=this.depth=this.camera=this.options=this.rctx=null;this.pass=m.MATERIAL;this.shadowMap=null;this.slot=p.BACKGROUND;this.framebufferTex=
this.visibleContent=this.stencilRenderingHelper=this.offscreenRenderingHelper=this.ssaoHelper=null}}()})},"esri/views/3d/webgl-engine/lib/ExternalRendererContainer":function(){define(["require","exports","./RenderSlot"],function(a,h,p){return function(){function a(){this.renderersChanged=!1;this.renderers=[];this.slots=[];for(var a=0;a<p.MAX_SLOTS;++a)this.slots[a]=[]}a.prototype.addRenderer=function(a,e){this.renderers.push(e);for(var f=0;f<a.length;++f)this.slots[a[f]].push(e);this.renderersChanged=
!0};a.prototype.removeRenderer=function(a){this.renderers=this.renderers.filter(function(e){return e!==a});for(var e=0;e<this.slots.length;++e)this.slots[e]=this.slots[e].filter(function(e){return e!==a});this.renderersChanged=!0};a.prototype.render=function(a,e){e.slot=a;a=this.slots[a];for(var f=0;f<a.length;++f){var g=a[f];g.render(e)&&(g.didRender=!0)}};a.prototype.needsRender=function(){if(this.renderersChanged)return!0;for(var a=0;a<this.renderers.length;++a)if(this.renderers[a].needsRender)return!0;
return!1};a.prototype.resetNeedsRender=function(){this.renderersChanged=!1;for(var a=0;a<this.renderers.length;++a){var e=this.renderers[a];e.resetNeedsRender?e.resetNeedsRender():e.didRender&&(e.needsRender=!1,e.didRender=!1)}};return a}()})},"esri/views/3d/webgl-engine/lib/StencilRenderingHelper":function(){define(["require","exports","./Util","../../../webgl/enums"],function(a,h,p,m){return function(){.prototype.enable=function(){this._enabled=!0;this._rctx.setStencilTestEnabled(!0)};
a.prototype.disable=function(){this._enabled=!1;this._rctx.setStencilTestEnabled(!1)};a.prototype.getIsSupported=a.prototype.setEnableState=function(a){a?this.enable():this.disable()};a.prototype.getEnableState=function(){return this._enabled};a.prototype.prepareStencilWritePass=function(){p.assert(this.getEnableState());var a=this._rctx;a.setClearStencil(0);a.setStencilFunction(519,1,255);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255)};
a.prototype.prepareStencilReadPass=function(){p.assert(this.getEnableState());var a=this._rctx;a.setStencilFunction(517,1,255);a.setStencilWriteMask(0)};a.prototype.prepareStencilDisabledPass=function(){p.assert(this.getEnableState());var a=this._rctx;a.setStencilFunction(519,0,0);a.setStencilWriteMask(0)};return a}()})},"esri/views/3d/webgl-engine/lib/BitSet":function(){define(["require","exports"],function(a,h){return function(){.prototype.clone=a.prototype.wordIndex=function(a){return a>>this.addressBitsPerWord};a.prototype.set=function(a){return this._store[this.wordIndex(a-1)]|=1<<a-1};a.prototype.clear=function(a){return this._store[this.wordIndex(a-1)]&=255^1<<a-1};a.prototype.clearAll=a.prototype.get=function(a){return 0!==(this._store[this.wordIndex(a-1)]&1<<a-1)};a.prototype.length=function(){return 0===
this.wordLength()?0:this.bitsPerWord*(this.wordLength()-1)+(this._store[this.wordLength()-1].toString(2).length+1)};a.prototype.wordLength=function(){for(var a,f=this._store.length,e=a=this._store.length-1;(0>=a?0>=e:0<=e)&&0===this._store[e];0>=a?e++:e--)f--;return f};a.prototype.store=function(){return this._store};a.prototype.cardinality=function(){for(var a=0,f=this.length(),e=0;0<=f?e<=f:e>=f;0<=f?e++:e--)this.get(e)&&a++;return a};a.prototype.toString=function(){for(var a=[],f=this.length(),
e=0;0<=f?e<=f:e>=f;0<=f?e++:e--)this.get(e)&&a.push(""+e);return"{"+a.join(",")+"}"};a.prototype.toBinaryString=function(){var a=this,f=return 0<this.wordLength()?this._store.map(function(e){return f(e.toString(2),"0",a.bitsPerWord)}).join(""):f("","0",this.bitsPerWord)};a.prototype.or=function(a){if(this!==a){for(var f=Math.min(this.wordLength(),a.wordLength()),e=f-1,l=0;0<=e?l<=e:l>=e;0<=e?l++:l--)this._store[l]|=a.store[l];f<a.wordLength()&&(this._store=
this._store.concat(a._store.slice(f,a.wordLength())));return null}};a.prototype.and=function(a){if(this!==a){for(var f=this.wordLength(),e=a.wordLength(),l=f;f<=e?l<=e:l>=e;f<=e?l++:l--)this._store[l]=0;f=this.wordLength();for(l=0;0<=f?l<=f:l>=f;0<=f?l++:l--)this._store[l]&=a.store[l];return null}};a.prototype.andNot=function(a){for(var f=Math.min(this.wordLength(),a.wordLength())-1,e=0;0<=f?e<=f:e>=f;0<=f?e++:e--)this._store[e]&=~a.store[e];return null};a.prototype.xor=function(a){if(this!==a){for(var f=
this.wordLength(),e=0;0<=f?e<=f:e>=f;0<=f?e++:e--)this._store[e]^=a.store[e];return null}};return a}()})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports"],function(a,h){a=function(){function a(m,f,e,l,g){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=m;this._layout=e;this._buffers=l;this._locations=f;g&&(this._indexBuffer=g);this._id=a._nextId++}Object.defineProperty(a.prototype,"id",
{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(a){void 0===a&&(a=!0);var f=this._context.extensions.vao;f&&this._glName&&(f.deleteVertexArrayOES(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(a){for(var e in this._buffers)this._buffers[e].dispose(),delete this._buffers[e];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=
null)}};a.prototype.initialize=a.prototype.bind=a.prototype._bindLayout=function(){var a=this._buffers,f=this._context.extensions.vao,e=this._layout,
l=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var g=this._context.gl,c,b,h=0,p;for(p in a)for((c=a[p])||console.error("Vertex buffer is uninitialized!"),(b=e[p])||console.error("Vertex element descriptor is empty!"),this._context.bindBuffer(c),h=0;h<b.length;++h){c=b[h];var y=this._locations[c.name];void 0===y&&console.error("There is no location for vertex attribute '"+c.name+" defined.");if(4>=c.count){if(g.enableVertexAttribArray(y),g.vertexAttribPointer(y,c.count,
c.type,c.normalized,c.stride,c.offset),c.divisor&&0<c.divisor){var t=this._context.extensions.angleInstancedArrays;t&&t.vertexAttribDivisorANGLE(y,c.divisor)}}else if(16===c.count&&5126===c.type)for(var u=0;4>u;u++)g.enableVertexAttribArray(y+u),g.vertexAttribPointer(y+u,4,c.type,c.normalized,c.stride,c.offset+16*u),c.divisor&&0<c.divisor&&(t=this._context.extensions.angleInstancedArrays)&&t.vertexAttribDivisorANGLE(y+u,c.divisor);else console.error("Unsupported vertex attribute element count: "+
c.count)}l&&(f?g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,l.glName):this._context.bindBuffer(l))};a.prototype.unbind=a.prototype._unbindLayout=function(){var a=this._buffers,f=this._layout,e=this._locations,l=this._context;a||console.error("Vertex buffer dictionary is empty!");var g=l.gl,c,b,h,p=0,y=0,t;for(t in a){(c=a[t])||console.error("Vertex buffer is uninitialized!");b=f[t];p=0;for(y=
b.length;p<y;++p)h=b[p],g.disableVertexAttribArray(e[h.name]);l.unbindBuffer(c.bufferType)}(a=this._indexBuffer)&&l.unbindBuffer(a.bufferType)};return a}();a._nextId=0;return a})},"esri/views/webgl/BufferObject":function(){define(["require","exports"],function(a,h){a=function(){function a(m,f,e,l){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=m;this._bufferType=f;this._usage=e;this._id=a._nextId++;this._glName=this._context.gl.createBuffer();
l&&this.setData(l)}a.createIndex=function(m,f,e){return new a(m,34963,f,e)};a.createVertex=Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"usage",{get:function(){return this._usage},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"byteSize",{get:enumerable:!0,configurable:!0});a.prototype.dispose=a.prototype.setData=function(a){if(a){if("number"===typeof a)0>a&&console.error("Buffer size cannot be negative!"),this._size=a;else{var f=a.byteLength;a instanceof Uint16Array&&(f/=2,this._indexType=5123);a instanceof Uint32Array&&(f/=4,this._indexType=5125);this._size=f}f=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);this._context.bindVAO(f)}};
a.prototype.setSubData=function(a,f,e,l){void 0===f&&(f=0);void 0===e&&(e=0);if(a){(0>f||f>=this._size)&&console.error("offset is out of range!");var g=f,c=e,b=l,m=a.byteLength;a instanceof Uint16Array&&(m/=2,g*=2,c*=2,b*=2);a instanceof Uint32Array&&(m/=4,g*=4,c*=4,b*=2);void 0===l&&(l=m-1);e>=l&&console.error("end must be bigger than start!");f+e-l>this._size&&console.error("An attempt to write beyond the end of the buffer!");f=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);
this._context.gl.bufferSubData(this._bufferType,g,(a instanceof ArrayBuffer?a:a.buffer).slice(c,b));this._context.bindVAO(f)}};return a}();a._nextId=0;return a})},"esri/views/3d/webgl-engine/lib/FxaaRenderPass":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/enums".split(" "),function(a,h,p,m,f,e){return function(){function a(a){this.isEnabled=!1;this.vertexAttributeLocations={position:0};this.vertexBufferLayout=
[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];this.rctx=a}a.prototype.enable=function(){if(!this.isEnabled){var a=this.rctx;this.program=new p(a,"\n      #version 100\n      precision mediump float;\n\n      attribute vec2 position;\n\n      varying   vec2 fCoordinate;\n\n      void main() {\n        fCoordinate \x3d (position + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(position, -1, 1);\n      }","\n      #version 100\n      precision mediump float;\n      /**\n       * @license\n       * Copyright (c) 2011 NVIDIA Corporation. All rights reserved.\n       *\n       * TO  THE MAXIMUM  EXTENT PERMITTED  BY APPLICABLE  LAW, THIS SOFTWARE  IS PROVIDED\n       * *AS IS*  AND NVIDIA AND  ITS SUPPLIERS DISCLAIM  ALL WARRANTIES,  EITHER  EXPRESS\n       * OR IMPLIED, INCLUDING, BUT NOT LIMITED  TO, NONINFRINGEMENT,IMPLIED WARRANTIES OF\n       * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO EVENT SHALL  NVIDIA\n       * OR ITS SUPPLIERS BE  LIABLE  FOR  ANY  DIRECT, SPECIAL,  INCIDENTAL,  INDIRECT,  OR\n       * CONSEQUENTIAL DAMAGES WHATSOEVER (INCLUDING, WITHOUT LIMITATION,  DAMAGES FOR LOSS\n       * OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY\n       * OTHER PECUNIARY LOSS) ARISING OUT OF THE  USE OF OR INABILITY  TO USE THIS SOFTWARE,\n       * EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\n       */\n\n      #define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n      #define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n      #define FXAA_SEARCH_STEPS        16\n      #define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n      #define FXAA_SUBPIX_CAP          (3.0/4.0)\n      #define FXAA_SUBPIX_TRIM         (1.0/4.0)\n      #define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\n\n      uniform vec2 uRcpFrameDimension;\n      uniform sampler2D uColorTexture;\n      varying vec2 fCoordinate;\n\n      // Return the luma, the estimation of luminance from rgb inputs.\n      // This approximates luma using one FMA instruction,\n      // skipping normalization and tossing out blue.\n      // FxaaLuma() will range 0.0 to 2.963210702.\n      float FxaaLuma(vec3 rgb) {\n        return rgb.y * (0.587 / 0.299) + rgb.x;\n      }\n      vec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\n        return (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n      }\n      vec4 FxaaTexOff(sampler2D tex, vec2 pos, ivec2 off, vec2 rcpFrame) {\n        float x \x3d pos.x + float(off.x) * rcpFrame.x;\n        float y \x3d pos.y + float(off.y) * rcpFrame.y;\n        return texture2D(tex, vec2(x, y));\n      }\n\n      // pos is the output of FxaaVertexShader interpolated across screen.\n      // xy -\x3e actual texture position {0.0 to 1.0}\n      // rcpFrame should be a uniform equal to  {1.0/frameWidth, 1.0/frameHeight}\n      vec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {\n        vec3 rgbN \x3d FxaaTexOff(tex, pos.xy, ivec2( 0,-1), rcpFrame).xyz;\n        vec3 rgbW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1, 0), rcpFrame).xyz;\n        vec3 rgbM \x3d FxaaTexOff(tex, pos.xy, ivec2( 0, 0), rcpFrame).xyz;\n        vec3 rgbE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1, 0), rcpFrame).xyz;\n        vec3 rgbS \x3d FxaaTexOff(tex, pos.xy, ivec2( 0, 1), rcpFrame).xyz;\n        float lumaN \x3d FxaaLuma(rgbN);\n        float lumaW \x3d FxaaLuma(rgbW);\n        float lumaM \x3d FxaaLuma(rgbM);\n        float lumaE \x3d FxaaLuma(rgbE);\n        float lumaS \x3d FxaaLuma(rgbS);\n        float rangeMin \x3d min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\n        float rangeMax \x3d max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\n        float range \x3d rangeMax - rangeMin;\n        if (range \x3c max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD)) {\n          return rgbM;\n        }\n        vec3 rgbL \x3d rgbN + rgbW + rgbM + rgbE + rgbS;\n        float lumaL \x3d (lumaN + lumaW + lumaE + lumaS) * 0.25;\n        float rangeL \x3d abs(lumaL - lumaM);\n        float blendL \x3d max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\n        blendL \x3d min(FXAA_SUBPIX_CAP, blendL);\n        vec3 rgbNW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1,-1), rcpFrame).xyz;\n        vec3 rgbNE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1,-1), rcpFrame).xyz;\n        vec3 rgbSW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1, 1), rcpFrame).xyz;\n        vec3 rgbSE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1, 1), rcpFrame).xyz;\n        rgbL +\x3d (rgbNW + rgbNE + rgbSW + rgbSE);\n        rgbL *\x3d vec3(1.0/9.0);\n        float lumaNW \x3d FxaaLuma(rgbNW);\n        float lumaNE \x3d FxaaLuma(rgbNE);\n        float lumaSW \x3d FxaaLuma(rgbSW);\n        float lumaSE \x3d FxaaLuma(rgbSE);\n        float edgeVert \x3d\n          abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\n          abs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\n          abs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\n        float edgeHorz \x3d\n          abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\n          abs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\n          abs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\n        bool horzSpan \x3d edgeHorz \x3e\x3d edgeVert;\n        float lengthSign \x3d horzSpan ? -rcpFrame.y : -rcpFrame.x;\n        if(!horzSpan) {\n          lumaN \x3d lumaW;\n          lumaS \x3d lumaE;\n        }\n        float gradientN \x3d abs(lumaN - lumaM);\n        float gradientS \x3d abs(lumaS - lumaM);\n        lumaN \x3d (lumaN + lumaM) * 0.5;\n        lumaS \x3d (lumaS + lumaM) * 0.5;\n        if (gradientN \x3c gradientS)\n        {\n          lumaN \x3d lumaS;\n          lumaN \x3d lumaS;\n          gradientN \x3d gradientS;\n          lengthSign *\x3d -1.0;\n        }\n        vec2 posN;\n        posN.x \x3d pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\n        posN.y \x3d pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\n        gradientN *\x3d FXAA_SEARCH_THRESHOLD;\n        vec2 posP \x3d posN;\n        vec2 offNP \x3d horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\n        float lumaEndN \x3d lumaN;\n        float lumaEndP \x3d lumaN;\n        bool doneN \x3d false;\n        bool doneP \x3d false;\n        posN +\x3d offNP * vec2(-1.0, -1.0);\n        posP +\x3d offNP * vec2( 1.0,  1.0);\n        for(int i \x3d 0; i \x3c FXAA_SEARCH_STEPS; i++) {\n          if(!doneN) {\n            lumaEndN \x3d FxaaLuma(texture2D(tex, posN.xy).xyz);\n          }\n          if(!doneP) {\n            lumaEndP \x3d FxaaLuma(texture2D(tex, posP.xy).xyz);\n          }\n          doneN \x3d doneN || (abs(lumaEndN - lumaN) \x3e\x3d gradientN);\n          doneP \x3d doneP || (abs(lumaEndP - lumaN) \x3e\x3d gradientN);\n          if(doneN \x26\x26 doneP) { break; }\n          if(!doneN) {\n            posN -\x3d offNP;\n          }\n          if(!doneP) {\n            posP +\x3d offNP;\n          }\n        }\n        float dstN \x3d horzSpan ? pos.x - posN.x : pos.y - posN.y;\n        float dstP \x3d horzSpan ? posP.x - pos.x : posP.y - pos.y;\n        bool directionN \x3d dstN \x3c dstP;\n        lumaEndN \x3d directionN ? lumaEndN : lumaEndP;\n        if(((lumaM - lumaN) \x3c 0.0) \x3d\x3d ((lumaEndN - lumaN) \x3c 0.0)) {\n          lengthSign \x3d 0.0;\n        }\n        float spanLength \x3d (dstP + dstN);\n        dstN \x3d directionN ? dstN : dstP;\n        float subPixelOffset \x3d (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\n        vec3 rgbF \x3d texture2D(tex, vec2(\n          pos.x + (horzSpan ? 0.0 : subPixelOffset),\n          pos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\n        return FxaaLerp3(rgbL, rgbF, blendL);\n      }\n\n      void main() {\n        vec4 color;\n        vec2 screenCoord \x3d fCoordinate;\n        // if (screenCoord.x \x3c 0.5) {\n          color.rgb \x3d FxaaPixelShader(screenCoord, uColorTexture, uRcpFrameDimension);\n        // } else if (screenCoord.x \x3c 0.501 \x26\x26 screenCoord.x \x3e 0.499) {\n        //   color.rgb \x3d vec3(1,0,0);\n        // } else {\n        //   color \x3d texture2D(uColorTexture, fCoordinate);\n        // }\n        color.a \x3d 1.0;\n        gl_FragColor \x3d color;\n      }",
this.vertexAttributeLocations);var c=new Float32Array([-1,-1,3,-1,-1,3]);this.vao=new m(a,this.vertexAttributeLocations,{geometry:this.vertexBufferLayout},{geometry:new f(a,34962,35044,c)});this.isEnabled=!0}};a.prototype.disable=function(){this.isEnabled&&(this.program.dispose(),this.program=null,this.vao.dispose(),this.vao=null,this.isEnabled=!1)};a.prototype.render=function(a,c){this.enable();var b=this.rctx;b.bindVAO(this.vao);b.bindFramebuffer(c);var e=0,g=0;null!=c?(e=c.descriptor.width,g=c.descriptor.height):
(e=b.gl.canvas.width,g=b.gl.canvas.height);b.bindProgram(this.program);b.bindTexture(a.colorTexture,0);this.program.setUniform1i("uColorTexture",0);this.program.setUniform2f("uRcpFrameDimension",1/e,1/g);b.setFaceCullingEnabled(!1);b.drawArrays(4,0,3)};return a}()})},"esri/views/3d/webgl-engine/lib/SmaaRenderPass":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/enums".split(" "),
function(a,h,p,m,f,e,l,g){return function(){function a(a){this.isEnabled=!1;this.vertexAttributeLocations={vPosition:0};this.vertexBufferLayout=[{name:"vPosition",count:2,type:5126,offset:0,stride:8,normalized:!1}];this.rctx=a}a.prototype.enable=function(){if(!this.isEnabled){var a=this.rctx;this.programEdgeDetect=new p(a,"\n      #define SHADER_NAME SMAA::EdgeDetect\n      precision highp float;\n      precision highp int;\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n\n      void SMAAEdgeDetectionVS( vec2 texcoord ) {\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n        fOffset[2] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n        SMAAEdgeDetectionVS( fTexCoord );\n      }",
"\n      #define SHADER_NAME SMAA::EdgeDetect\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_THRESHOLD 0.05\n      #define SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR 2\n      #define SMAA_USE_COLOR_EDGE_DETECTION 0\n\n      uniform sampler2D tColor;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n\n      vec4 SMAALumaEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n        // Calculate the threshold:\n        vec2 threshold \x3d vec2(SMAA_THRESHOLD, SMAA_THRESHOLD);\n\n        // Calculate lumas:\n        vec3 weights \x3d vec3(0.2126, 0.7152, 0.0722);\n        float L \x3d dot(texture2D(colorTex, texcoord).rgb, weights);\n\n        float Lleft \x3d dot(texture2D(colorTex, offset[0].xy).rgb, weights);\n        float Ltop  \x3d dot(texture2D(colorTex, offset[0].zw).rgb, weights);\n\n        // We do the usual threshold:\n        vec4 delta;\n        delta.xy \x3d abs(L - vec2(Lleft, Ltop));\n        vec2 edges \x3d step(threshold, delta.xy);\n\n        // Then discard if there is no edge:\n        if (dot(edges, vec2(1.0, 1.0)) \x3d\x3d 0.0) discard;\n\n        // Calculate right and bottom deltas:\n        float Lright \x3d dot(texture2D(colorTex, offset[1].xy).rgb, weights);\n        float Lbottom  \x3d dot(texture2D(colorTex, offset[1].zw).rgb, weights);\n        delta.zw \x3d abs(L - vec2(Lright, Lbottom));\n\n        // Calculate the maximum delta in the direct neighborhood:\n        vec2 maxDelta \x3d max(delta.xy, delta.zw);\n\n        // Calculate left-left and top-top deltas:\n        float Lleftleft \x3d dot(texture2D(colorTex, offset[2].xy).rgb, weights);\n        float Ltoptop \x3d dot(texture2D(colorTex, offset[2].zw).rgb, weights);\n        delta.zw \x3d abs(vec2(Lleft, Ltop) - vec2(Lleftleft, Ltoptop));\n\n        // Calculate the final maximum delta:\n        maxDelta \x3d max(maxDelta.xy, delta.zw);\n        float finalDelta \x3d max(maxDelta.x, maxDelta.y);\n\n        // Local contrast adaptation:\n        edges.xy *\x3d step(finalDelta, float(SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR) * delta.xy);\n\n        return vec4( edges, 0.0, 0.0 );\n      }\n\n      vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n        vec2 threshold \x3d vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n        // Calculate color deltas:\n        vec4 delta;\n        vec3 C \x3d texture2D( colorTex, texcoord ).rgb;\n\n        vec3 Cleft \x3d texture2D( colorTex, offset[0].xy ).rgb;\n        vec3 t \x3d abs( C - Cleft );\n        delta.x \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Ctop \x3d texture2D( colorTex, offset[0].zw ).rgb;\n        t \x3d abs( C - Ctop );\n        delta.y \x3d max( max( t.r, t.g ), t.b );\n\n        // We do the usual threshold:\n        vec2 edges \x3d step( threshold, delta.xy );\n\n        // Then discard if there is no edge:\n        if ( dot( edges, vec2( 1.0, 1.0 ) ) \x3d\x3d 0.0 )\n            discard;\n\n        // Calculate right and bottom deltas:\n        vec3 Cright \x3d texture2D( colorTex, offset[1].xy ).rgb;\n        t \x3d abs( C - Cright );\n        delta.z \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Cbottom  \x3d texture2D( colorTex, offset[1].zw ).rgb;\n        t \x3d abs( C - Cbottom );\n        delta.w \x3d max( max( t.r, t.g ), t.b );\n\n        // Calculate the maximum delta in the direct neighborhood:\n        float maxDelta \x3d max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n        // Calculate left-left and top-top deltas:\n        vec3 Cleftleft  \x3d texture2D( colorTex, offset[2].xy ).rgb;\n        t \x3d abs( C - Cleftleft );\n        delta.z \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Ctoptop \x3d texture2D( colorTex, offset[2].zw ).rgb;\n        t \x3d abs( C - Ctoptop );\n        delta.w \x3d max( max( t.r, t.g ), t.b );\n\n        // Calculate the final maximum delta:\n        maxDelta \x3d max( max( maxDelta, delta.z ), delta.w );\n\n        // Local contrast adaptation in action:\n        edges.xy *\x3d step( maxDelta, float(SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR) * delta.xy );\n\n        return vec4( edges, 0.0, 0.0 );\n      }\n\n      void main() {\n        #if SMAA_USE_COLOR_EDGE_DETECTION\n          gl_FragColor \x3d SMAAColorEdgeDetectionPS( fTexCoord, fOffset, tColor );\n        #else\n          gl_FragColor \x3d SMAALumaEdgeDetectionPS( fTexCoord, fOffset, tColor );\n        #endif\n      }",
this.vertexAttributeLocations);this.programBlendWeights=new p(a,"\n      #define SHADER_NAME SMAA::BlendWeights\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_MAX_SEARCH_STEPS 8\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n      varying vec2 fPixCoord;\n\n      void SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n        fPixCoord \x3d texcoord * uResolution.zw;\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );\n        fOffset[2] \x3d vec4( fOffset[0].xz, fOffset[1].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * uResolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n        SMAABlendingWeightCalculationVS( fTexCoord );\n      }",
"\n      #define SHADER_NAME SMAA::BlendWeights\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_MAX_SEARCH_STEPS 8\n      #define SMAA_AREATEX_MAX_DISTANCE 16\n      #define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )\n      #define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )\n\n      #define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * uResolution.xy, 0.0 )\n\n      uniform sampler2D tEdges;\n      uniform sampler2D tArea;\n      uniform sampler2D tSearch;\n      uniform vec4 uResolution;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n      varying vec2 fPixCoord;\n\n      vec2 round( vec2 x ) {\n        return sign( x ) * floor( abs( x ) + 0.5 );\n      }\n\n      float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n        e.r \x3d bias + e.r * scale;\n        return 255.0 * texture2D( searchTex, e, 0.0 ).r;\n      }\n\n      float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 0.0, 1.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord -\x3d vec2( 2.0, 0.0 ) * uResolution.xy;\n          if ( ! ( texcoord.x \x3e end \x26\x26 e.g \x3e 0.8281 \x26\x26 e.r \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.x +\x3d 0.25 * uResolution.x;\n        texcoord.x +\x3d uResolution.x;\n        texcoord.x +\x3d 2.0 * uResolution.x;\n        texcoord.x -\x3d uResolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n        return texcoord.x;\n      }\n\n      float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 0.0, 1.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord +\x3d vec2( 2.0, 0.0 ) * uResolution.xy;\n          if ( ! ( texcoord.x \x3c end \x26\x26 e.g \x3e 0.8281 \x26\x26 e.r \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.x -\x3d 0.25 * uResolution.x;\n        texcoord.x -\x3d uResolution.x;\n        texcoord.x -\x3d 2.0 * uResolution.x;\n        texcoord.x +\x3d uResolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n        return texcoord.x;\n      }\n\n      float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 1.0, 0.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord +\x3d vec2( 0.0, 2.0 ) * uResolution.xy;\n          if ( ! ( texcoord.y \x3e end \x26\x26 e.r \x3e 0.8281 \x26\x26 e.g \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.y -\x3d 0.25 * uResolution.y;\n        texcoord.y -\x3d uResolution.y;\n        texcoord.y -\x3d 2.0 * uResolution.y;\n        texcoord.y +\x3d uResolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );\n        return texcoord.y;\n      }\n\n      float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 1.0, 0.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord -\x3d vec2( 0.0, 2.0 ) * uResolution.xy;\n          if ( ! ( texcoord.y \x3c end \x26\x26 e.r \x3e 0.8281 \x26\x26 e.g \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.y +\x3d 0.25 * uResolution.y;\n        texcoord.y +\x3d uResolution.y;\n        texcoord.y +\x3d 2.0 * uResolution.y;\n        texcoord.y -\x3d uResolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );\n        return texcoord.y;\n      }\n\n      vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n        vec2 texcoord \x3d float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n        texcoord \x3d SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n        texcoord.y +\x3d SMAA_AREATEX_SUBTEX_SIZE * offset;\n        return texture2D( areaTex, texcoord, 0.0 ).rg;\n      }\n\n      vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n        vec4 weights \x3d vec4( 0.0, 0.0, 0.0, 0.0 );\n        vec2 e \x3d texture2D( edgesTex, texcoord ).rg;\n        if ( e.g \x3e 0.0 ) {\n          vec2 d;\n          vec2 coords;\n          coords.x \x3d SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n          coords.y \x3d offset[ 1 ].y;\n          d.x \x3d coords.x;\n          float e1 \x3d texture2D( edgesTex, coords, 0.0 ).r;\n          coords.x \x3d SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n          d.y \x3d coords.x;\n          d \x3d d * uResolution.z - pixcoord.x;\n          vec2 sqrt_d \x3d sqrt( abs( d ) );\n          coords.y -\x3d 1.0 * uResolution.y;\n          float e2 \x3d SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n          weights.rg \x3d SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n        }\n        if ( e.r \x3e 0.0 ) {\n          vec2 d;\n          vec2 coords;\n          coords.y \x3d SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n          coords.x \x3d offset[ 0 ].x;\n          d.x \x3d coords.y;\n          float e1 \x3d texture2D( edgesTex, coords, 0.0 ).g;\n          coords.y \x3d SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n          d.y \x3d coords.y;\n          d \x3d d * uResolution.w - pixcoord.y;\n          vec2 sqrt_d \x3d sqrt( abs( d ) );\n          coords.y -\x3d 1.0 * uResolution.y;\n          float e2 \x3d SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n          weights.ba \x3d SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\n          // for some reason the following lines are necessary to prevent\n          // texture lookup precision issues on some Intel integrated graphics chips\n          vec4 dbg \x3d (offset[ 0 ]+offset[ 1 ]+offset[ 2 ] + coords.xyyx);\n          weights.r +\x3d 0.00000001 * dot(vec4(0,1,0,1),dbg);\n        }\n        return weights;\n      }\n\n      void main() {\n        gl_FragColor \x3d SMAABlendingWeightCalculationPS( fTexCoord, fPixCoord, fOffset, tEdges, tArea, tSearch, ivec4( 0.0 ) );\n      }",
this.vertexAttributeLocations);this.programBlur=new p(a,"\n      #define SHADER_NAME SMAA::NeighborhoodBlending\n      precision highp float;\n      precision highp int;\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[2];\n\n      void SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n\n        SMAANeighborhoodBlendingVS(fTexCoord);\n      }",
"\n      #define SHADER_NAME SMAA::NeighborhoodBlending\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_DEBUG_SPLIT_VIEW 0\n\n      uniform sampler2D tBlendWeights;\n      uniform sampler2D tColor;\n      uniform vec4 uResolution;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[2];\n\n      vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n        vec4 a;\n        a.xz \x3d texture2D( blendTex, texcoord ).xz;\n        a.y \x3d texture2D( blendTex, offset[ 1 ].zw ).g;\n        a.w \x3d texture2D( blendTex, offset[ 1 ].xy ).a;\n\n        if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) \x3c 1e-5 ) {\n          return texture2D( colorTex, texcoord, 0.0 );\n        } else {\n          vec2 offset;\n          offset.x \x3d a.a \x3e a.b ? a.a : -a.b;\n          offset.y \x3d a.g \x3e a.r ? -a.g : a.r;\n\n          if ( abs( offset.x ) \x3e abs( offset.y )) {\n            offset.y \x3d 0.0;\n          } else {\n            offset.x \x3d 0.0;\n          }\n\n          vec4 C \x3d texture2D( colorTex, texcoord, 0.0 );\n          texcoord +\x3d sign( offset ) * uResolution.xy;\n          vec4 Cop \x3d texture2D( colorTex, texcoord, 0.0 );\n\n          float s \x3d abs( offset.x ) \x3e abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n          //C.xyz \x3d pow(C.xyz, vec3(2.2));\n          //Cop.xyz \x3d pow(Cop.xyz, vec3(2.2));\n          vec4 mixed \x3d mix(C, Cop, s);\n          //mixed.xyz \x3d pow(mixed.xyz, vec3(1.0 / 2.2));\n\n          return mixed;\n        }\n      }\n\n      void main() {\n        gl_FragColor \x3d SMAANeighborhoodBlendingPS( fTexCoord, fOffset, tColor, tBlendWeights );\n\n        #if SMAA_DEBUG_SPLIT_VIEW // split the view in the middle and display the unprocessed image on the right\n          // test stuff\n          if (fTexCoord.x \x3e 0.5) {\n            if (fTexCoord.x \x3c 0.5 + uResolution.x) {\n              gl_FragColor \x3d vec4(0, 0, 1, 1);\n            } else {\n              gl_FragColor \x3d texture2D(tColor, fTexCoord);\n            }\n          }\n        #endif // DEBUG\n      }",
this.vertexAttributeLocations);var c=new Float32Array([-1,-1,3,-1,-1,3]);this.vao=new m(a,this.vertexAttributeLocations,{geometry:this.vertexBufferLayout},{geometry:new f(a,34962,35044,c)});this.tmpFramebufferEdges=l.createWithAttachments(this.rctx,{target:3553,pixelFormat:6407,dataType:5121,samplingMode:9729,wrapMode:33071,width:4,height:4},{colorTarget:0,depthStencilTarget:0});this.tmpFramebufferBlend=l.createWithAttachments(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,
wrapMode:33071,width:4,height:4},{colorTarget:0,depthStencilTarget:0});this.textureArea=this.loadTextureFromBase64("data:image/png;base64,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\x3d",
9729,6407);this.textureSearch=this.loadTextureFromBase64("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII\x3d",9728,6409);this.isEnabled=!0}};a.prototype.disable=function(){this.isEnabled&&(this.programEdgeDetect.dispose(),this.programEdgeDetect=null,this.programBlendWeights.dispose(),this.programBlendWeights=null,this.programBlur.dispose(),this.programBlur=null,this.vao.dispose(),
this.vao=null,this.textureArea.dispose(),this.textureArea=null,this.textureSearch.dispose(),this.textureSearch=null,this.tmpFramebufferBlend.dispose(),this.tmpFramebufferBlend=null,this.tmpFramebufferEdges.dispose(),this.tmpFramebufferEdges=null,this.isEnabled=!1)};a.prototype.render=function(a,c){this.enable();var b=this.rctx,e=0,g=0;null!=c?(e=c.descriptor.width,g=c.descriptor.height):(e=b.gl.canvas.width,g=b.gl.canvas.height);b.bindVAO(this.vao);b.setFaceCullingEnabled(!0);b.setCullFace(1029);
b.setFrontFace(2305);b.setBlendingEnabled(!1);b.setDepthTestEnabled(!1);b.setViewport(0,0,e,g);this.tmpFramebufferEdges.resize(e,g);b.bindFramebuffer(this.tmpFramebufferEdges);b.setClearColor(0,0,0,1);b.clear(b.gl.COLOR_BUFFER_BIT);b.bindProgram(this.programEdgeDetect);b.bindTexture(a.colorTexture,0);this.programEdgeDetect.setUniform1i("tColor",0);this.programEdgeDetect.setUniform4f("uResolution",1/e,1/g,e,g);b.drawArrays(4,0,3);this.tmpFramebufferBlend.resize(e,g);b.bindFramebuffer(this.tmpFramebufferBlend);
b.setClearColor(0,0,1,1);b.clear(b.gl.COLOR_BUFFER_BIT);b.bindProgram(this.programBlendWeights);this.programBlendWeights.setUniform4f("uResolution",1/e,1/g,e,g);b.bindTexture(this.textureSearch,1);this.programBlendWeights.setUniform1i("tSearch",1);b.bindTexture(this.textureArea,2);this.programBlendWeights.setUniform1i("tArea",2);b.bindTexture(this.tmpFramebufferEdges.colorTexture,3);this.programBlendWeights.setUniform1i("tEdges",3);b.drawArrays(4,0,3);b.bindFramebuffer(c);b.setClearColor(0,1,0,1);
b.clear(b.gl.COLOR_BUFFER_BIT);b.bindProgram(this.programBlur);this.programBlur.setUniform4f("uResolution",1/e,1/g,e,g);b.bindTexture(a.colorTexture,0);this.programBlur.setUniform1i("tColor",0);b.bindTexture(this.tmpFramebufferBlend.colorTexture,1);this.programBlur.setUniform1i("tBlendWeights",1);b.drawArrays(4,0,3);b.setBlendingEnabled(!0);b.setDepthTestEnabled(!0)};a.prototype.loadTextureFromBase64=function(a,c,g){var b=new Image;b.src=a;var f=new e(this.rctx,{pixelFormat:g,dataType:5121,wrapMode:33071,
samplingMode:c},!1!==b.complete?b:null);b.complete||(b.onload=function(){f.resize(b.width,b.height);f.setData(b)});return f};return a}()})},"esri/views/3d/webgl-engine/lib/Camera":function(){define(["require","exports","./Util","./gl-matrix"],function(a,h,p,m){r l=m.vec3d,g=m.vec4d,c=m.mat4d;a=function(){function a(a,b,e){this._viewUp=l.create();this._viewForward=
l.create();this._viewRight=l.create();this._viewport=g.create();this._padding=g.create();this._fov=55/180*Math.PI;this._near=0;this._far=1E3;this._viewDirty=!0;this._viewMatrix=c.create();this._projectionDirty=!0;this._projectionMatrix=c.create();this._viewInverseTransposeMatrixDirty=!0;this._viewInverseTransposeMatrix=null;this._frustumPlanesDirty=!0;this._frustumPlanes=[g.create(),g.create(),g.create(),g.create(),g.create(),g.create()];this._fullViewport=null;this.aboveGround=!0;this._eye=l.create(a);
this._center=l.create(b);this._up=void 0!==e?l.create(e):l.create([0,0,1]);this._padding=g.create()}Object.defineProperty(a.prototype,"eye",{get:function(){return this._eye},set:function(a){this._compareAndSetView(a,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"center",{get:function(){return this._center},set:function(a){this._compareAndSetView(a,this._center)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"up",{get:function(){return this._up},
set:function(a){this._compareAndSetView(a,this._up)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewMatrix",{get:function(){this._ensureViewClean();return this._viewMatrix},set:function(a){c.set(a,this._viewMatrix);this._viewDirty=!1;this._frustumPlanesDirty=this._viewInverseTransposeMatrixDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewForward",{get:function(){this._ensureViewClean();return this._viewForward},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"viewUp",{get:function(){this._ensureViewClean();return this._viewUp},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewRight",{get:enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"near",{get:function(){return this._near},set:function(a){this._near!==a&&(this._near=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"far",{get:function(){return this._far},set:function(a){this._far!==a&&(this._far=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewport",{get:function(){return this._viewport},set:function(a){this.x=a[0];this.y=a[1];this.width=a[2];this.height=a[3]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"x",{get:function(){return this._viewport[0]},set:function(a){a+=this._padding[3];this._viewport[0]!==a&&(this._viewport[0]=
a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this._viewport[1]},set:function(a){a+=this._padding[2];this._viewport[1]!==a&&(this._viewport[1]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"width",{get:function(){return this._viewport[2]},set:function(a){a-=this._padding[1]+this._padding[3];this._viewport[2]!==a&&(this._viewport[2]=
a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:set:function(a){a-=this._padding[0]+this._padding[2];this._viewport[3]!==a&&(this._viewport[3]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullWidth",{get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullViewport",{get:function(){this._fullViewport||(this._fullViewport=g.create());this._fullViewport[0]=this._viewport[0]-this._padding[3];this._fullViewport[1]=this._viewport[1]-this._padding[2];this._fullViewport[2]=this.fullWidth;this._fullViewport[3]=this.fullHeight;return this._fullViewport},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"padding",{get:function(){return this._padding},set:function(a){if(this._padding[0]!==a[0]||this._padding[1]!==a[1]||this._padding[2]!==a[2]||this._padding[3]!==a[3])this._viewport[0]+=a[3]-this._padding[3],this._viewport[1]+=a[2]-this._padding[2],this._viewport[2]-=a[1]+a[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=
a[0]+a[2]-(this._padding[0]+this._padding[2]),g.set(a,this._padding),this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var a=this.width,b=this.height,e=this.near*Math.tan(this.fovY/2),g=e*this.aspect;c.frustum(-g*(1+2*this._padding[3]/a),g*(1+2*this._padding[1]/a),-e*(1+2*this._padding[2]/b),e*(1+2*this._padding[0]/b),this.near,this.far,this._projectionMatrix);this._projectionDirty=
!1}return this._projectionMatrix},set:function(a){c.set(a,this._projectionMatrix);this._projectionDirty=!1;this._frustumPlanesDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fov",{get:function(){return this._fov},set:enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fovX",{get:function(){return p.fovd2fovx(this._fov,this.width,this.height)},set:function(a){this._fov=p.fovx2fovd(a,
this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fovY",{get:set:function(a){this._fov=p.fovy2fovd(a,this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"distance",{get:enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"angleOfElevation",{get:function(){l.subtract(this._center,this._eye,b);l.normalize(b);var a=l.dot(this._center,b)/l.length(this._center);return Math.acos(p.clamp(a,-1,1))-.5*Math.PI},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"frustumPoints",{get:function(){return this.computeFrustumPoints()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"frustumPlanes",{get:function(){this._frustumPlanesDirty&&(this._frustumPlanes=this._computeFrustumPlanes(this._frustumPlanes),
this._frustumPlanesDirty=!1);return this._frustumPlanes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewInverseTransposeMatrix",{get:function(){if(this._viewInverseTransposeMatrixDirty||this._viewDirty)this._viewInverseTransposeMatrix||(this._viewInverseTransposeMatrix=c.create()),c.inverse(this.viewMatrix,this._viewInverseTransposeMatrix),c.transpose(this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1;return this._viewInverseTransposeMatrix},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"perPixelRatio",{get:function(){return Math.tan(this.fovX/2)/this.width},enumerable:!0,configurable:!0});a.prototype.copyFrom=function(a){l.set(a._eye,this._eye);l.set(a._center,this._center);l.set(a._up,this._up);g.set(a._viewport,this._viewport);g.set(a._padding,this._padding);this._near=a._near;this._far=a._far;this._fov=a._fov;this.aboveGround=a.aboveGround;a._viewDirty?this._frustumPlanesDirty=this._viewDirty=!0:(c.set(a._viewMatrix,this._viewMatrix),
l.set(a._viewRight,this._viewRight),l.set(a._viewUp,this._viewUp),l.set(a._viewForward,this._viewForward),this._viewDirty=!1);a._projectionDirty?this._frustumPlanesDirty=this._projectionDirty=!0:(c.set(a._projectionMatrix,this._projectionMatrix),this._projectionDirty=!1);return this};a.prototype.copy=a.prototype.equals=function(a){return f(this._eye,a._eye)&&f(this._center,a._center)&&f(this._up,a._up)&&e(this._viewport,a._viewport)&&e(this._padding,
a._padding)&&this._near===a._near&&this._far===a._far&&this._fov===a._fov};a.prototype.almostEquals=function(a,b){b=l.dist(this.eye,this.center)*(b||5E-4);b*=b;if(b=l.dist2(a.eye,this.eye)<b&&l.dist2(a.center,this.center)<b&&.001>Math.abs(a.fov-this.fov)){var c=a.padding,e=this.padding;a=e[0]-c[0];b=e[1]-c[1];var d=e[2]-c[2],c=e[3]-c[3];b=.5>a*a+b*b+d*d+c*c}return b};a.prototype.markViewDirty=a.prototype.computePixelSizeAt=function(a){return 2*
l.dist(a,this._eye)*Math.tan(this.fovX/2)/this.width};a.prototype.computePixelSizeAtDist=function(a){return 2*a*Math.tan(this.fovX/2)/this.width};a.prototype.computeDistanceFromRadius=function(a,b){return a/Math.tan(Math.min(this.fovX,this.fovY)/(2*(b||1)))};a.prototype.copyFrustumPlanes=function(a){if(!a){a=Array(6);for(var b=0;6>b;++b)a[b]=g.create()}for(var c=this.frustumPlanes,b=0;6>b;b++)g.set(c[b],a[b]);return a};a.prototype.computeFrustumPoints=function(a){if(!a){a=Array(8);for(var b=0;8>b;++b)a[b]=
l.create()}p.matrix2frustum(this.viewMatrix,this.projectionMatrix,a);return a};a.prototype.setGLViewport=function(a){var b=this.viewport,c=this.padding;a.setViewport(b[0]-c[3],b[1]-c[2],b[2]+c[1]+c[3],b[3]+c[0]+c[2])};a.prototype.projectPoint=function(a,b,e){void 0===e&&(e=!1);g.set4(a[0],a[1],a[2],1,q);c.multiplyVec4(this.viewMatrix,q);e&&(b[2]=-q[2]);c.multiplyVec4(this.projectionMatrix,q);l.scale(q,1/Math.abs(q[3]));a=this.fullViewport;b[0]=p.lerp(0,a[0]+a[2],.5+.5*q[0]);b[1]=p.lerp(0,a[1]+a[3],
.5+.5*q[1]);e||(b[2]=.5*(q[2]+1));return b};a.prototype.unprojectPoint=function(a,b,e){void 0===e&&(e=!1);if(e)return console.error("Camera.unprojectPoint() not yet implemented for linear Z"),null;c.multiply(this.projectionMatrix,this.viewMatrix,x);if(!c.inverse(x))return null;e=this.fullViewport;q[0]=2*(a[0]-e[0])/e[2]-1;q[1]=2*(a[1]-e[1])/e[3]-1;q[2]=2*a[2]-1;q[3]=1;c.multiplyVec4(x,q);if(0===q[3])return null;b[0]=q[0]/q[3];b[1]=q[1]/q[3];b[2]=q[2]/q[3];return b};a.prototype.computeUpOnSphere=function(){l.subtract(this.center,
this.eye,y);var a=l.length(this.center);1>a?l.set3(0,0,1,this.up):Math.abs(l.dot(y,this.center))>.9999*l.length(y)*a||(l.cross(y,this.center,this.up),l.cross(this.up,y,this.up),l.normalize(this.up))};a.prototype._compareAndSetView=function(a,b){f(a,b)||(l.set(a,b),this._frustumPlanesDirty=this._viewDirty=!0)};a.prototype._computeFrustumPlanes=function(a){if(!a){a=Array(6);for(var b=0;6>b;++b)a[b]=g.create()}p.matrix2frustumPlanes(this.viewMatrix,this.projectionMatrix,a);return a};a.prototype._ensureViewClean=
function(){this._viewDirty&&(c.lookAt(this._eye,this._center,this._up,this._viewMatrix),l.set3(-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10],this._viewForward),l.set3(this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9],this._viewUp),l.set3(this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8],this._viewRight),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)};return a}();var b=l.create(),q=g.create(),x=c.create(),y=l.create();return a})},"esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial":function(){define("require exports dojo/text!./TexOnlyGLMaterial.xml ./MaterialUtil ../../lib/RenderSlot ../../lib/gl-matrix ../../../../webgl/Program ../../../../webgl/enums ../../lib/DefaultVertexAttributeLocations".split(" "),
function(a,h,p,m,f,e,l,g,c){var b=e.vec4d.createFrom(1,1,1,1);return function(){function a(a,b,c,e,g){this.id=m.__GLMaterial_id++;this.program=a.get("texOnly");this.color=c;this.depthFunc=g;this.blend=e;this.texGLName=b}a.prototype.getId=function(){return this.id};a.prototype.beginSlot=function(a){return a===f.INTERNAL_MATERIAL};a.prototype.getProgram=function(){return this.program};a.prototype.setColor=function(a){this.color=a};a.prototype.bind=function(a,c){a.bindProgram(this.program);this.program.setUniformMatrix4fv("model",
m.IDENTITY);this.program.setUniformMatrix4fv("proj",c.proj);this.program.setUniform4fv("color",void 0!==this.color?this.color:b);this.program.setUniform1i("tex",0);a.bindTexture(this.texGLName,0);this.blend&&(a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA));a.setDepthTestEnabled(!0);void 0!==this.depthFunc&&a.setDepthFunction(this.depthFunc)};a.prototype.release=function(a){void 0!==this.depthFunc&&a.setDepthFunction(513);
this.blend&&a.setBlendingEnabled(!1)};a.prototype.bindView=function(a,b){m.bindView(b.origin,b.view,this.program)};a.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",b.transformation)};a.prototype.getDrawMode=function(a){return a.gl.TRIANGLES};a.loadShaders=function(a,b,e,g){a._parse(p);a=new l(g,a.vertexShaderTexOnly,a.fragmentShaderTexOnly,c.Default3D);e.add("texOnly",a)};return a}()})},"esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":function(){define(["require",
"exports"],function(a,h){h.Pos3=[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}];h.Pos3Tex=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}];h.Pos3Color=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:16,normalized:!1}];h.Pos3Norm=[{name:"position",count:3,type:5126,offset:0,stride:24,normalized:!1},{name:"normal",count:3,
type:5126,offset:12,stride:24,normalized:!1}];h.Pos3NormTex=[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}];h.Pos3NormCol=[{name:"position",count:3,type:5126,offset:0,stride:28,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:28,normalized:!1},{name:"color",count:4,type:5121,offset:24,stride:28,normalized:!1}];h.Pos3NormTexCol=
[{name:"position",count:3,type:5126,offset:0,stride:36,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:36,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:36,normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:36,normalized:!1}];h.Pos3NormTexRegion=[{name:"position",count:3,type:5126,offset:0,stride:40,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:40,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:40,normalized:!1},{name:"region",
count:4,type:5123,offset:32,stride:40,normalized:!1}];h.Pos3NormTexRegionCol=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:44,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:44,normalized:!1},{name:"color",count:4,type:5121,offset:40,stride:44,normalized:!1}];h.Pos2=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];h.Pos2Tex=
[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];h.Model=[{name:"model",count:16,type:5126,offset:0,stride:128,normalized:!1,divisor:1},{name:"modelNormal",count:16,type:5126,offset:64,stride:128,normalized:!1,divisor:1}];h.ModelCol=[{name:"model",count:16,type:5126,offset:0,stride:144,normalized:!1,divisor:1},{name:"modelNormal",count:16,type:5126,offset:64,stride:144,normalized:!1,divisor:1},{name:"instanceColor",
count:4,type:5126,offset:128,stride:144,normalized:!1,divisor:1}]})},"esri/views/3d/webgl-engine/lib/webgl-utils":function(){define([],function(){var a=return{create3DContext:a,setupWebGL:detectWebGL:function(){var h;try{h=window.WebGLRenderingContext}catch(m){h=[!1,0]}var p;try{p=a(document.createElement("canvas"))}catch(m){p=[!1,1]}h?p?(h=p,h=[!0,{VERSION:h.getParameter(h.VERSION),SHADING_LANGUAGE_VERSION:h.getParameter(h.SHADING_LANGUAGE_VERSION),VENDOR:h.getParameter(h.VENDOR),RENDERER:h.getParameter(h.RENDERER),
EXTENSIONS:h.getSupportedExtensions(),MAX_TEXTURE_SIZE:h.getParameter(h.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:h.getParameter(h.MAX_RENDERBUFFER_SIZE),MAX_VERTEX_TEXTURE_IMAGE_UNITS:h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]):h=[!1,1]:h=[!1,0];return h}}})},"esri/views/3d/webgl-engine/parts/Viewport":function(){define("require exports dojo/has ../lib/PerformanceTimer ../lib/Camera ../lib/Util ../lib/BitSet ../lib/gl-matrix ./Visualizer".split(" "),function(a,h,p,m,f,e,l,g,c){var b=g.vec3;
a=g.vec4d;var q=g.mat4d,x=[0,0],y=q.create(),t=[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()],u={get:;return function(){function a(a,e,d,k){this._content={};this._visibleContent=new l;this._frustumCullingEnabled=!0;this._maxFarNearRatio=2E4;this._stats={renderGeometriesTotal:0,renderGeometriesVisible:0,visualizerRenderTimer:null,viewportRenderTimer:null};this._needsRender=!0;this._rctx=k;this._gl=k.gl;this._visualizer=new c(a,e,d,this._rctx);this._camera=
new f(b.createFrom(0,100,-100),b.createFrom(0,0,0))}a.prototype.getCombinedStats=function(){var a={},b=this._visualizer.getCombinedStats(),d;for(d in b)a[d]=b[d];a.renderGeometriesTotal=this._stats.renderGeometriesTotal;a.renderGeometriesVisible=this._stats.renderGeometriesVisible;void 0!==this._gl.getUsedTextureMemory&&(a.textureMemory=this._gl.getUsedTextureMemory());void 0!==this._gl.getUsedRenderbufferMemory&&(a.renderbufferMemory=this._gl.getUsedRenderbufferMemory());void 0!==this._gl.getUsedVBOMemory&&
(a.VBOMemory=this._gl.getUsedVBOMemory());if(void 0!==this._gl.getUsedTextureMemoryStats){var b=this._gl.getUsedTextureMemoryStats(),c;for(c in b)a["texMem type: "+c]=b[c]}return a};a.prototype.dispose=function(){this._visualizer.dispose();this._visualizer=null};a.prototype.setLightingData=function(a){this._visualizer.setLightingData(a)};a.prototype.getLightingData=function(){return this._visualizer.getLightingData()};a.prototype.getViewParams=function(a){var b=this._visualizer.getViewParams(a);if(!a||
a.frustumCullingEnabled)b.frustumCullingEnabled=this._frustumCullingEnabled;if(!a||a.maxFarNearRatio)b.maxFarNearRatio=this._maxFarNearRatio;return b};a.prototype.setViewParams=function(a){void 0!==a.frustumCullingEnabled&&(this._frustumCullingEnabled=a.frustumCullingEnabled);void 0!==a.maxFarNearRatio&&(this._maxFarNearRatio=-1===a.maxFarNearRatio?2E4:a.maxFarNearRatio);this._visualizer.setViewParams(a);this._needsRender=!0};a.prototype.setRenderParams=function(a){this._visualizer.setRenderParams(a)};
a.prototype.getRenderParams=function(){return this._visualizer.getRenderParams()};a.prototype.getFrustumObjects=function(){var a={},b;for(b in this._content)this._visibleContent.get(this._content[b].idx)&&(a[this._content[b].name]=1);return a};a.prototype.modify=function(a,b,d,c){this._visualizer.modify(a,b,d,c);this._content=this._visualizer.getContent()};a.prototype.getContent=function(){return this._content};a.prototype.setSelectionObject=function(a,b){this._visualizer.setSelectionObject(a,b)};
a.prototype.setCamera=function(a){this._camera.copyFrom(a);this._computeVisibleContentAndUpdateNearFar();this._needsRender=!0};a.prototype.getCamera=function(){return this._camera};a.prototype.getPickRay=function(a,b,d){return this.pickRayWithBeginPoint(a,void 0,this._camera.viewMatrix,b,d)};a.prototype.pickRayWithBeginPoint=function(a,b,d,c,e){return this._visualizer.getPickRay(a,b,this._camera,d,c,e)};a.prototype.addExternalRenderer=function(a,b){return this._visualizer.addExternalRenderer(a,b)};
a.prototype.removeExternalRenderer=function(a){return this._visualizer.removeExternalRenderer(a)};a.prototype.getExternalRenderers=function(){return this._visualizer.getExternalRenderers()};a.prototype.render=function(a,b){var d=this._computeVisibleContentAndUpdateNearFar();this._visualizer.render(this._camera,a,d,b)};a.prototype.resetNeedsRender=function(){this._needsRender=!1;this._visualizer.resetNeedsRender()};a.prototype.needsRender=function(){return this._needsRender||this._visualizer.needsRender()};
a.prototype._computeVisibleContentAndUpdateNearFar=function(){return this._frustumCullingEnabled||0<this._maxFarNearRatio?(x[1]=0,this._computeFrustumCullingAndNearFar(this._camera.eye,this._visibleContent,x),0<this._maxFarNearRatio&&0<x[1]&&(this._camera.far=x[1],this._camera.near=Math.max(x[0],this._camera.far/this._maxFarNearRatio)),this._visibleContent):u};a.prototype._computeFrustumCullingAndNearFar=function(a,b,d){q.perspective(this._camera.fovY,this._camera.aspect,1,10,y);e.matrix2frustumPlanes(this._camera.viewMatrix,
y,t);b.clearAll();this._stats.renderGeometriesTotal=0;this._stats.renderGeometriesVisible=0;a=-Number.MAX_VALUE;var c=-Number.MAX_VALUE,g=t[0][0],f=t[0][1],n=t[0][2],l=t[0][3],m=t[1][0],h=t[1][1],r=t[1][2],w=t[1][3],u=t[2][0],p=t[2][1],x=t[2][2],P=t[2][3],I=t[3][0],J=t[3][1],Q=t[3][2],S=t[3][3],ga=t[4][0],L=t[4][1],R=t[4][2],U=t[4][3],T=t[5][3],N;for(N in this._content){var Z=this._content[N];this._stats.renderGeometriesTotal++;if(!Z.material.isBackdrop){var H=Z.center,O=H[0],aa=H[1],ba=H[2],H=Z.bsRadius;
if(g*O+f*aa+n*ba+l>H)continue;if(m*O+h*aa+r*ba+w>H)continue;if(u*O+p*aa+x*ba+P>H)continue;if(I*O+J*aa+Q*ba+S>H)continue;aa=ga*O+L*aa+R*ba;O=aa+H;H=-aa+H;O>a&&(a=O);H>c&&(c=H)}b.set(Z.idx);this._stats.renderGeometriesVisible++}b=a!==-Number.MAX_VALUE;0<this._stats.renderGeometriesVisible&&b&&(d[0]=.99*Math.max(1-(a+U),2),d[1]=1.01*Math.max(10+(c+T),d[0]+1))};return a}()})},"esri/views/3d/webgl-engine/lib/PerformanceTimer":function(){define(["require","exports","./Util"],function(a,h,p){return function(){function a(a){this._filterSampleIndex=
0;this._lastTime=NaN;this._numMeasurements=this._totalTime=0;this._filterSamples=Array(a);this.reset();this._filterSize=a}a.prototype.reset=function(){for(var a=this._filterSampleIndex=0;a<this._filterSize;a++)this._filterSamples[a]=NaN};a.prototype.start=a.prototype.stop=function(){this._lastTime=p.performance.now()-this._tsStart;this._totalTime+=this._lastTime;this._numMeasurements++;this._filterSize&&(this._filterSamples[this._filterSampleIndex]=this._lastTime,
this._filterSampleIndex=(this._filterSampleIndex+1)%this._filterSize);return this._lastTime};a.prototype.getLast=function(){return this._lastTime};a.prototype.getLastFiltered=function(){for(var a=0,e=0;e<this._filterSamples.length;e++)a+=this._filterSamples[e];return a/this._filterSamples.length};a.prototype.getAverage=a.prototype.getTotal=function(){return this._totalTime};a.prototype.getNumMeasurements=function(){return this._numMeasurements};
return a}()})},"esri/views/3d/webgl-engine/parts/Visualizer":function(){define("require exports ../lib/Renderer ../lib/SSAOHelperObscurance ../lib/ShadowMap ../lib/NearFarCalc ../lib/Util ../lib/gl-matrix ../lib/RenderPass ../lib/HighlightHelper ../lib/OffscreenRenderingHelper".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){var x=g.vec3d,y=g.mat4d,t=l.assert;return function(){function a(a,c,g,d){this._drawSSAOMapDebugQuad=this._drawShadowMapDebugQuad=!1;this._needsRender=!0;this._content={};this._rctx=
d;this._renderer=new p(a,c,g,this._rctx,!1);this._programRep=a;this._shadowMap=new f(a,this._rctx);this._ssaoHelper=new m(a,g,this._rctx,this.setNeedsRender.bind(this));this._nearFarCalc=new e;this._highlightHelper=new b(a,g,this._rctx);this._offscreenRenderingHelper=new q(a,this._rctx)}a.prototype.getCombinedStats=function(){return this._renderer.getCombinedStats()};a.prototype.dispose=function(){this._renderer.dispose();this._shadowMap.getEnableState()&&this._shadowMap.setEnableState(!1);this._shadowMap.dispose();
this._ssaoHelper.getEnableState()&&this._ssaoHelper.setEnableState(!1);this._ssaoHelper.dispose();this._highlightHelper.getEnableState()&&this._highlightHelper.setEnableState(!1);this._offscreenRenderingHelper.getEnableState()&&this._offscreenRenderingHelper.setEnableState(!1)};a.prototype.setLightingData=function(a){this._renderer.setLightingData(a)};a.prototype.getLightingData=function(){return this._renderer.getLightingData()};a.prototype.getViewParams=function(a){var b=a||{};if(!a||a.pixelRatio)b.pixelRatio=
this._renderer.getPixelRatio();return b};a.prototype.setViewParams=function(a){null!=a.pixelRatio&&this._renderer.setPixelRatio(a.pixelRatio)};a.prototype.setRenderParams=function(a){void 0!==a.shadowMapResolution&&!1===this._shadowMap.getEnableState()&&this._shadowMap.setTextureResolution(a.shadowMapResolution);void 0!==a.shadowMap&&a.shadowMap!==this._shadowMap.getEnableState()&&this._shadowMap.setEnableState(a.shadowMap);void 0!==a.shadowMapMaxCascades&&this._shadowMap.setMaxNumCascades(a.shadowMapMaxCascades);
!0!==this._highlightHelper.getEnableState()&&this._highlightHelper.setEnableState(!0);void 0!==a.ssao&&a.ssao!==this._ssaoHelper.getEnableState()&&this._ssaoHelper.setEnableState(a.ssao);void 0!==a.ssaoAttenuation&&this._ssaoHelper.setAttenuation(a.ssaoAttenuation);void 0!==a.ssaoRadius&&this._ssaoHelper.setRadius(a.ssaoRadius);void 0!==a.ssaoFilterRadius&&console.error("The property ssaoFilterRadius is no longer supported as a render parameter.");void 0!==a.ssaoSamples&&this._ssaoHelper.setSamples(a.ssaoSamples);
void 0!==a.drawShadowMapDebugQuad&&(this._drawShadowMapDebugQuad=a.drawShadowMapDebugQuad);void 0!==a.drawSSAODebugQuad&&(this._drawSSAOMapDebugQuad=a.drawSSAODebugQuad);this._ssaoHelper.getEnableState()?this._renderer.ssaoEnabled=!0:this._renderer.ssaoEnabled=!1;void 0!==a.offscreenRendering&&a.offscreenRendering!==this._offscreenRenderingHelper.getEnableState()&&this._offscreenRenderingHelper.setEnableState(a.offscreenRendering);void 0!==a.antialiasingEnabled&&(this._renderer.renderOptions.antialiasing=
a.antialiasingEnabled?"smaa":"none");void 0!==a.earlyOcclusionPixelDraw&&(this._renderer.renderOptions.earlyOcclusionPixelDraw=a.earlyOcclusionPixelDraw);this._needsRender=!0};a.prototype.getRenderParams=function(){var a={};this._shadowMap.getIsSupported()&&(a.shadowMap=this._shadowMap.getEnableState(),a.shadowMapResolution=this._shadowMap.getTextureResolution(),a.shadowMapMaxCascades=this._shadowMap.getMaxNumCascades());this._ssaoHelper.getIsSupported()&&(a.ssao=this._ssaoHelper.getEnableState(),
a.ssaoAttenuation=this._ssaoHelper.getAttenuation(),a.ssaoRadius=this._ssaoHelper.getRadius(),a.ssaoFilterRadius=this._ssaoHelper.getFilterRadius(),a.ssaoSamples=this._ssaoHelper.getSamples());return a};a.prototype.modify=function(a,b,c,d){this._renderer.modify(a,b,c,d);for(d=0;d<b.length;++d)delete this._content[b[d].uniqueName];for(d=0;d<a.length;++d)this._content[a[d].uniqueName]=a[d];for(d=0;d<c.length;++d)t(this._content[c[d].renderGeometry.uniqueName]===c[d].renderGeometry)};a.prototype.getContent=
function(){return this._content};a.prototype.getPickRay=function(a,b,c,d,e,g){x.unproject(x.createFrom(a[0],a[1],0),d,c.projectionMatrix,c.fullViewport,e);x.unproject(x.createFrom(a[0],a[1],1),d,c.projectionMatrix,c.fullViewport,g)};a.prototype.getProjectionMatrix=function(a,b,c,d,e){b=l.fovx2fovy(b,a[2],a[3]);y.perspective(180*b/Math.PI,a[2]/a[3],c,d,e)};a.prototype.setSelectionObject=function(a,b){this._renderer.setSelectionObject(a,b)};a.prototype.addExternalRenderer=function(a,b){return this._renderer.addExternalRenderer(a,
b)};a.prototype.removeExternalRenderer=function(a){return this._renderer.removeExternalRenderer(a)};a.prototype.getExternalRenderers=function(){return this._renderer.getExternalRenderers()};a.prototype.resetNeedsRender=a.prototype.needsRender=a.prototype.setNeedsRender=function(){this._needsRender=!0};a.prototype.render=function(a,b,e,d){var g=a.viewport,f;if(this._shadowMap.getEnableState()){f=
this._nearFarCalc.calculateSceneNearFar(a,this._content,e);this._shadowMap.prepare(a,b,this._content,e,f);b=this._shadowMap.getCascades();for(f=0;f<b.length;++f){var n=b[f];n.camera.setGLViewport(this._rctx);this._renderer.renderGeometryPass(c.MATERIAL_DEPTH_SHADOWMAP,n.camera,e)}this._shadowMap.finish(d);a.setGLViewport(this._rctx)}this._shadowMap.bindAll(this._programRep);this._renderer.renderAuxiliaryBuffers(a,e,this._shadowMap,this._ssaoHelper,d,this._offscreenRenderingHelper);this._renderer.render(a,
e,this._shadowMap,this._ssaoHelper,d,this._highlightHelper,this._offscreenRenderingHelper);this._drawShadowMapDebugQuad&&this._shadowMap.getEnableState()&&(a=y.ortho(g[0],g[2],g[1],g[3],-1,1),this._shadowMap.drawDebugQuad(a));this._drawSSAOMapDebugQuad&&this._ssaoHelper.getEnableState()&&(a=y.ortho(g[0],g[2],g[1],g[3],-1,1),this._ssaoHelper.drawQuad(a))};return a}()})},"esri/views/3d/webgl-engine/lib/SSAOHelperObscurance":function(){define("require exports ../../../../core/Logger ./Util ./gl-matrix dojo/text!../materials/internal/ssao.xml ../../../webgl/Program ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u){var r=f.vec3d,n=f.vec4d,w=p.getLogger("esri.views.3d.webgl-engine");a=function(){function a(a,b,d,c){this._enabled=!1;this._BLUR_F=2;this._attenuation=.5;this._radius=3;this._samples=16;this._viewportToRestore=n.create();this._rctx=d;this._programRep=a;this._textureRep=b;this._requestRender=c;this._emptyTexture=new g(d,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:4,height:4},null)}a.prototype.dispose=a.prototype.getIsSupported=function(){var a=this._rctx,b=-1!==a.parameters.versionString.indexOf("WebGL 0.93"),d=-1!==a.parameters.versionString.indexOf("WebGL 0.94");return a.extensions.standardDerivatives&&!(b||d)};a.prototype.setEnableState=function(a){a?this.enable():this.disable()};a.prototype.getEnableState=function(){return this._enabled};a.prototype.enable=function(){var a=this;if(!this.getEnableState())if(this.getIsSupported()){this._enabled=!0;var b={target:3553,
pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},d={colorTarget:0,depthStencilTarget:0};this._ssaoFBO=c.createWithAttachments(this._rctx,b,d);this._blur0FBO=c.createWithAttachments(this._rctx,b,d);this._blur1FBO=c.createWithAttachments(this._rctx,b,d);var e=new Image;e.src="data:image/png;base64,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\x3d\x3d";
e.onload=function(){a._noiseTexture=new g(a._rctx,{target:3553,pixelFormat:6408,dataType:5121,hasMipmap:!0,width:D,height:D},e);a._requestRender()}}else w.warn("SSAO is not supported for this browser or hardware")};a.prototype.getQuadVAO=function(){if(!this._quadVAO){var a=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this._quadVAO=new b(this._rctx,u.Default3D,{geometry:t.Pos2},{geometry:q.createVertex(this._rctx,35044,a)})}return this._quadVAO};a.prototype.disable=function(){this.getEnableState()&&(this._enabled=
!1,this._quadVAO&&this._quadVAO.dispose(!0),this._noiseTexture&&this._noiseTexture.dispose(),this._blur1FBO.dispose(),this._blur0FBO.dispose(),this._ssaoFBO.dispose(),this._ssaoFBO=this._blur0FBO=this._blur1FBO=this._noiseTexture=this._quadVAO=null)};a.prototype.setAttenuation=function(a){this._attenuation=a};a.prototype.getAttenuation=function(){return this._attenuation};a.prototype.setRadius=function(a){this._radius=a};a.prototype.getRadius=function(){return this._radius};a.prototype.getFilterRadius=
function(){return 4};a.prototype.setSamples=function(a){this._samples=a};a.prototype.getSamples=function(){return this._samples};a.prototype.computeSSAO=function(a,b,c,e){if(this._noiseTexture){m.assert(this.getEnableState());var g=this._rctx,f=c.width,l=c.height,h=f/this._BLUR_F,q=l/this._BLUR_F;this._ssaoFBO.resize(f,l);this._blur0FBO.resize(h,q);this._blur1FBO.resize(h,q);h=1*f;q=1*l;g.bindFramebuffer(this._ssaoFBO);n.set(a.fullViewport,this._viewportToRestore);g.setViewport(0,0,f,l);var t=this._programRep.get(8>=
this._samples?"ssao8":16>=this._samples?"ssao16":32>=this._samples?"ssao32":"ssao64"),w=this._programRep.get("blur"),u=a.projectionMatrix;d[0]=-2/(h*u[0]);d[1]=-2/(q*u[5]);d[2]=(1-u[2])/u[0];d[3]=(1+u[6])/u[5];u=0===u[11];t.setUniform2f("rnmScale",f/D,l/D);t.setUniform3fv("pSphere",8>=this._samples?k:16>=this._samples?v:32>=this._samples?A:z);g.bindProgram(t);t.setUniform1f("numSpiralTurns",this._samples<B.length?B[this._samples]:5779);t.setUniform4fv("projInfo",new Float32Array(d));f=1/a.computePixelSizeAtDist(1);
t.setUniform1f("projScale",1*f);t.setUniform2f("screenDimensions",h,q);u?(t.setUniform2f("nearFar",a.near,a.far),t.setUniform2f("zScale",0,-1)):(t.setUniform2f("nearFar",a.near,a.far),t.setUniform2f("zScale",1,0));var p=2*this._radius,l=r.dist(a.eye,a.center),p=20*a.computePixelSizeAtDist(l),p=Math.max(.1,p);t.setUniform1f("radius",p);t.setUniform1f("intensity",4*this._attenuation/Math.pow(p,6));t.setUniform1i("rnm",0);t.setUniform1i("normalMap",1);t.setUniform1i("depthMap",2);g.bindTexture(this._noiseTexture,
0);g.bindTexture(e.colorTexture,1);g.bindTexture(c.colorTexture,2);c=this.getQuadVAO();g.bindVAO(c);g.drawArrays(5,0,x.vertexCount(c,"geometry"));g.bindTexture(this._ssaoFBO.colorTexture,0);g.setViewport(0,0,h/this._BLUR_F,q/this._BLUR_F);g.bindFramebuffer(this._blur0FBO);w.setUniform2f("screenDimensions",h,q);w.setUniform1i("tex",0);w.setUniform1i("normalMap",1);w.setUniform1i("depthMap",2);w.setUniform2f("blurSize",0,1*this._BLUR_F/q);w.setUniform1i("radius",4);w.setUniform1f("g_BlurFalloff",.08);
w.setUniform2f("nearFar",a.near,a.far);5E4<l&&(f=Math.max(0,f-(l-5E4)));w.setUniform1f("projScale",f);u?w.setUniform2f("zScale",0,-1):w.setUniform2f("zScale",1,0);g.drawArrays(5,0,x.vertexCount(c,"geometry"));w.setUniform2f("blurSize",1*this._BLUR_F/h,0);g.bindFramebuffer(this._blur1FBO);g.bindTexture(this._blur0FBO.colorTexture,0);g.drawArrays(5,0,x.vertexCount(c,"geometry"));g.bindFramebuffer(b);g.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3])}};
a.prototype.setUniforms=function(a){var b=this.getEnableState()&&this._noiseTexture,d=this._rctx;d.bindTexture(b?this._blur1FBO.colorTexture:this._emptyTexture,6);d.setActiveTexture(0);a.setUniform1i("ssaoTex",6);b?a.setUniform4f("viewportPixelSz",this._viewportToRestore[0],this._viewportToRestore[1],1/this._ssaoFBO.width,1/this._ssaoFBO.height):a.setUniform4f("viewportPixelSz",-1,-1,-1,-1)};a.prototype.bindAll=function(a){a=a.getProgramsUsingUniform("viewportPixelSz");for(var b=0;b<a.length;b++)this.setUniforms(a[b])};
a.prototype.drawQuad=function(a){m.assert(this.getEnableState());var d=this._programRep.get("showDepth");this._debugQuadVAO||(this._debugQuadVAO=new b(this._rctx,u.Default3D,{geometry:t.Pos2Tex},{geometry:q.createVertex(this._rctx,35044,C)}));var c=this._rctx;c.setDepthTestEnabled(!1);d.setUniformMatrix4fv("proj",new Float32Array(a));d.setUniform1i("depthTex",0);c.bindTexture(this._ssaoFBO.colorTexture,0);c.bindVAO(this._debugQuadVAO);c.drawArrays(5,0,x.vertexCount(this._debugQuadVAO,"geometry"));
c.setDepthTestEnabled(!0)};a.loadShaders=function(a,b,d,c){m.assert(null==a.samples);a.samples="samplesUNDEF";a._parse(e);b=new l(c,a.vertexShaderShowDepth,a.fragmentShaderShowDepth,u.Default3D);var g=a.createFsSSAOSrcObscurance,k=new l(c,a.vsUVQuad,g.replace("samplesUNDEF","8"),u.Default3D),f=new l(c,a.vsUVQuad,g.replace("samplesUNDEF","16"),u.Default3D),n=new l(c,a.vsUVQuad,g.replace("samplesUNDEF","32"),u.Default3D),g=new l(c,a.vsUVQuad,g.replace("samplesUNDEF","64"),u.Default3D);c=new l(c,a.vsUVQuad,
a.fsBlurEdgeAware,u.Default3D,["RADIUS "+(4).toString()]);d.add("showDepth",b);d.add("ssao8",k);d.add("ssao16",f);d.add("ssao32",n);d.add("ssao64",g);d.add("blur",c);delete a.samples};return a}();var d=n.create(),k=new Float32Array([.186937,0,0,.677503,0,0,-.782832,.128424,.557187,.248064,.460317,-.659755,.062892,.918659,.312829,-.241031,-.814826,.224206,-.642866,.132138,-.45016,.145727,-.590568,-.626141,.005017,-.002234,.012668]),v=new Float32Array([.186937,0,0,.700542,0,0,-.864858,-.481795,-.111713,
-.624773,.102853,-.730153,-.387172,.260319,.007229,-.222367,-.642631,-.707697,-.01336,-.014956,.169662,.122575,.1544,-.456944,-.177141,.85997,-.42346,-.131631,.814545,.524355,-.779469,.007991,.624833,.308092,.209288,.35969,.359331,-.184533,-.377458,.192633,-.482999,-.065284,.233538,.293706,-.055139,.417709,-.386701,.442449,-.301656,-.836426,.408344]),A=new Float32Array([.837372,0,0,.723531,-.467287,.034157,.169582,-.31169,-.881801,.696236,.455215,-.204568,-.304514,.528086,.626381,-.053116,.222507,
.037523,.199755,.311291,.916799,-.681552,-.516264,.501792,-.37127,.021088,.737477,-.029503,.209188,-.95298,-.573731,.009962,-.154202,-.257345,-.905958,.282747,.370779,.527867,-.669424,-.601758,-.191278,-.708243,.271796,.782684,.535565,-.006867,-.015312,-.017276,.419958,.265628,.233036,-.543898,.554747,-.174055,-.079242,.053475,-.099539,.372042,-.339267,-.357362,.015781,-.011352,.042707,-.340564,-.272507,-.067725,.799249,-.127948,.586808,.450015,.01965,-.416454,-.506524,.323229,.206546,-.087316,-.311097,
.466049,.146374,-.34528,-.045904,-.152614,-.926686,-.287529,-.665726,-.032904,.246643,.248703,.637193,-.062541,-.073706,.495925,-.315143,.05946,-.116042,.075586]),z=new Float32Array([.186937,0,0,.605726,-.313457,-.097616,.003541,.781245,.283011,-.225029,-.373279,.274442,-.047511,.04992,-.226365,.627629,-.623617,-.463628,.133094,-.318299,.528128,.262035,.100234,-.09012,.178335,-.426972,-.666048,-.27306,-.207352,.05514,-.613649,-.063395,.060608,-.283391,-.41382,-.087565,.136768,.506126,.484137,-.593808,
-.344603,.453164,.675326,.124799,-.697865,-.33502,.411337,-.09337,-.15271,.002908,-.063582,.366733,-.699739,.401148,-.519536,-.585625,-.508413,.106482,-.428709,-.260221,.012847,-.118806,.016962,-.188182,.49945,.452364,.586617,.722539,-.23302,.111295,.202827,.066695,-.036503,.315842,.896467,-.039109,-.270116,-.080062,.613435,.508787,.538656,-.352275,.566869,-.666275,.887876,-.138341,-.434135,-.444711,.269156,.119506,-.029457,-.077316,.754474,.274125,-.13876,-.37082,-.73268,.332723,.568545,-.203992,
.878922,-.430778,.541154,-.546752,.11786,-3.93E-4,-.083318,.059333,-.341406,-.117017,-.318568,-.262425,-.457913,.848753,.89229,-.30157,.322416,.742328,.032262,.643827,.048091,-.078044,-.49908,.064858,.549944,-.796252,-.230688,.88978,-.010153,.397241,-.27645,.405666,-.46593,.131187,-.600166,.333834,-.078219,.73837,-.870169,-.411658,-.222175,-.492421,.741454,.293757,-.591244,.389112,-.388324,.792346,.578552,.088459,-.121858,-.437241,-.472535,-.374835,.302427,.721264,.057485,.204085,-.126575,.510325,
.481492,-.579888,-.29411,-.82136,.156404,-.819717,-.042466,.456573,.079884,.07019,.179002,.220279,.970222,-.088025,-.299911,-.234627,-.820794,.912112,.243306,.317869,.241336,.161841,-.721568,.301135,-.635993,-.0939,-.514731,-.089673,.850964,-.905087,.314604,-.098397]),D=64,B=[1,1,1,2,3,2,5,2,3,2,3,3,5,5,3,4,7,5,5,7,9,8,5,5,7,7,7,8,5,8,11,12,7,10,13,8,11,8,7,14,11,11,13,12,13,19,17,13,11,18,19,11,11,14,17,21,15,16,17,18,13,17,11,17,19,18,25,18,19,19,29,21,19,27,31,29,21,18,17,29,31,31,23,18,25,26,
25,23,19,34,19,27,21,25,39,29,17,21,27,29],C=new Float32Array([0,0,0,0,512,0,1,0,0,512,0,1,512,512,1,1]);return a})},"esri/views/3d/webgl-engine/lib/ShadowMap":function(){define("./Camera ./Util ./gl-matrix ../../../../core/Logger ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ./DefaultVertexAttributeLocations ./DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){var x=p.vec2d,y=p.vec3d,t=
p.vec4d,u=p.mat3d,r=p.mat4d,n=p.mat4,w=m.getLogger("esri.views.3d.webgl-engine");return function(d,k){function m(a,b){y.set3(a[b],a[b+3],a[b+6],Fa);return Fa}var p=k.gl,z,D=4096,B,C=new f(k,{target:p.TEXTURE_2D,pixelFormat:p.RGBA,dataType:p.UNSIGNED_BYTE,samplingMode:p.NEAREST,width:4,height:4}),F=1,K=2,M=[0,0,0,0,0];this.dispose=var E=function(){this.camera=new a;this.lightMat=r.create()},V=[],P,I,J;for(P=0;4>P;++P)V[P]=new E;this.getIsSupported=
this.setTextureResolution=this.getTextureResolution=function(){return D};this.setMaxNumCascades=function(a){K=h.clamp(Math.floor(a),1,4)};this.getMaxNumCascades=function(){return K};this.setEnableState=function(a){a?this.enable():this.disable()};this.getEnableState=this.getDepthTexture=function(){return z};this.enable=function(){this.getEnableState()||(this.getIsSupported()?(z=new f(k,{target:p.TEXTURE_2D,pixelFormat:p.RGBA,dataType:p.UNSIGNED_BYTE,wrapMode:p.CLAMP_TO_EDGE,
samplingMode:p.NEAREST,flipped:!0,width:D,height:D}),B=e.createWithAttachments(k,z,{colorTarget:0,depthStencilTarget:1,width:D,height:D})):w.warn("Shadow maps are not supported for this browser or hardware"))};this.disable=function(){this.getEnableState()&&B&&(B.dispose(),z=B=void 0)};var Q=r.create(),S=r.create(),ga=t.create(),L=Array(8);for(P=0;8>P;++P)L[P]=t.create();var R=y.create(),U=y.create(),T=x.create(),N=x.create(),Z=x.create(),H=x.create(),O=x.create(),aa=r.create(),ba=y.create();this.prepare=
function(a,b,d,c,e){h.assert(this.getEnableState());r.multiply(a.projectionMatrix,a.viewMatrix,Q);var g=e[0],f=e[1];2>g&&(g=2);2>f&&(f=2);g>=f&&(g=2,f=4);F=Math.min(1+Math.floor(h.logWithBase(f/g,4)),K);d=Math.pow(f/g,1/F);for(e=0;e<F+1;++e)M[e]=g*Math.pow(d,e);r.inverse(Q,S);r.lookAt([0,0,0],[-b[0],-b[1],-b[2]],[0,1,0],aa);d=a.viewMatrix;a=a.projectionMatrix;for(e=0;e<F;++e){c=V[e];g=-M[e];f=-M[e+1];g=(a[10]*g+a[14])/Math.abs(a[11]*g+a[15]);f=(a[10]*f+a[14])/Math.abs(a[11]*f+a[15]);h.assert(g<f);
for(I=0;8>I;++I)for(t.set4(0===I%4||3==I%4?-1:1,0===I%4||1==I%4?-1:1,4>I?g:f,1,ga),r.multiplyVec4(S,ga,L[I]),J=0;3>J;++J)L[I][J]/=L[I][3];y.negate(L[0],ba);r.translate(aa,ba,c.camera.viewMatrix);for(I=0;8>I;++I)r.multiplyVec3(c.camera.viewMatrix,L[I]);y.set(L[0],R);y.set(L[0],U);for(I=1;8>I;++I)for(J=0;3>J;++J)R[J]=Math.min(R[J],L[I][J]),U[J]=Math.max(U[J],L[I][J]);R[2]-=200;U[2]+=200;c.camera.near=-U[2];c.camera.far=-R[2];g=1/L[0][3];f=1/L[4][3];h.assert(g<f);var n=g+Math.sqrt(g*f),l=Math.sin(Math.acos(d[2]*
b[0]+d[6]*b[1]+d[10]*b[2])),n=n/l,g=L,q=n,w=l,l=T,u=N,v=Z,A=H,n=O;x.set2(0,0,ma);for(var z=void 0,z=0;4>z;++z)x.add(ma,g[z],ma);x.scale(ma,.25);x.set2(0,0,wa);for(z=4;8>z;++z)x.add(wa,g[z],wa);x.scale(wa,.25);x.lerp(g[4],g[5],.5,na[0]);x.lerp(g[5],g[6],.5,na[1]);x.lerp(g[6],g[7],.5,na[2]);x.lerp(g[7],g[4],.5,na[3]);for(var E=0,C=x.dist2(na[0],ma),z=1;4>z;++z){var P=x.dist2(na[z],ma);P<C&&(C=P,E=z)}x.subtract(na[E],g[E+4],sa);z=sa[0];sa[0]=-sa[1];sa[1]=z;x.subtract(wa,ma,Ea);x.lerp(sa,Ea,w);x.normalize(sa);
E=w=void 0;w=E=x.dot(x.subtract(g[0],ma,pa),sa);for(z=1;8>z;++z)C=x.dot(x.subtract(g[z],ma,pa),sa),C<w?w=C:C>E&&(E=C);x.set(ma,l);x.scale(sa,w-q,pa);x.add(l,pa,l);for(var P=-1,X=1,z=q=C=0;8>z;++z){x.subtract(g[z],l,qa);x.normalize(qa);var ea=sa[0]*qa[1]-sa[1]*qa[0];0<ea?ea>P&&(P=ea,C=z):ea<X&&(X=ea,q=z)}h.verify(0<P,"leftArea");h.verify(0>X,"rightArea");x.scale(sa,w,ua);x.add(ua,ma,ua);x.scale(sa,E,va);x.add(va,ma,va);Ca[0]=-sa[1];Ca[1]=sa[0];u=h.rayRay2D(l,g[q],va,x.add(va,Ca,pa),1,u);v=h.rayRay2D(l,
g[C],va,pa,1,v);A=h.rayRay2D(l,g[C],ua,x.add(ua,Ca,pa),1,A);g=h.rayRay2D(l,g[q],ua,pa,1,n);h.verify(u,"rayRay");h.verify(v,"rayRay");h.verify(A,"rayRay");h.verify(g,"rayRay");v=T;g=N;l=H;A=O;n=c.camera.projectionMatrix;x.scale(x.subtract(l,A,Aa),.5);W[0]=Aa[0];W[1]=Aa[1];W[2]=0;W[3]=Aa[1];W[4]=-Aa[0];W[5]=0;W[6]=Aa[0]*Aa[0]+Aa[1]*Aa[1];W[7]=Aa[0]*Aa[1]-Aa[1]*Aa[0];W[8]=1;W[6]=-x.dot(m(W,0),v);W[7]=-x.dot(m(W,1),v);v=x.dot(m(W,0),l)+W[6];u=x.dot(m(W,1),l)+W[7];z=x.dot(m(W,0),A)+W[6];A=x.dot(m(W,1),
A)+W[7];v=-(v+z)/(u+A);W[0]+=W[1]*v;W[3]+=W[4]*v;W[6]+=W[7]*v;v=1/(x.dot(m(W,0),l)+W[6]);u=1/(x.dot(m(W,1),l)+W[7]);W[0]*=v;W[3]*=v;W[6]*=v;W[1]*=u;W[4]*=u;W[7]*=u;W[2]=W[1];W[5]=W[4];W[8]=W[7];W[7]+=1;v=x.dot(m(W,1),g)+W[7];u=x.dot(m(W,2),g)+W[8];z=x.dot(m(W,1),l)+W[7];A=x.dot(m(W,2),l)+W[8];v=-.5*(v/u+z/A);W[1]+=W[2]*v;W[4]+=W[5]*v;W[7]+=W[8]*v;v=x.dot(m(W,1),g)+W[7];u=x.dot(m(W,2),g)+W[8];z=-u/v;W[1]*=z;W[4]*=z;W[7]*=z;n[0]=W[0];n[1]=W[1];n[2]=0;n[3]=W[2];n[4]=W[3];n[5]=W[4];n[6]=0;n[7]=W[5];n[8]=
0;n[9]=0;n[10]=1;n[11]=0;n[12]=W[6];n[13]=W[7];n[14]=0;n[15]=W[8];c.camera.projectionMatrix[10]=2/(R[2]-U[2]);c.camera.projectionMatrix[14]=-(R[2]+U[2])/(R[2]-U[2]);r.multiply(c.camera.projectionMatrix,c.camera.viewMatrix,c.lightMat);g=D/2;c.camera.viewport[0]=0===e%2?0:g;c.camera.viewport[1]=0===Math.floor(e/2)?0:g;c.camera.viewport[2]=g;c.camera.viewport[3]=g}M[F]=100*f;k.bindFramebuffer(B);k.bindTexture(null,7);k.setClearColor(1,1,1,1);k.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT);k.setBlendingEnabled(!1)};
var X=[];this.getCascades=function(){for(var a=0;a<F;++a)X[a]=V[a];X.length=F;return X};this.finish=function(a){h.assert(this.getEnableState());k.bindFramebuffer(a)};this.bind=function(a){var b=this.getEnableState();k.bindTexture(b?z:C,7);k.bindProgram(a);a.setUniform1i("depthTex",7);a.setUniform1f("depthHalfPixelSz",b?.5/D:-1);a.setUniform1i("shadowMapNum",F);a.setUniform4f("shadowMapDistance",M[0],M[1],M[2],M[3])};this.bindAll=function(a){a=a.getProgramsUsingUniform("shadowMapDistance");for(var b=
0;b<a.length;b++)this.bind(a[b])};var ea=n.create(),la=new Float32Array(64);this.bindView=function(a,b){if(this.getEnableState()){var d;n.translate(V[0].lightMat,b,ea);for(d=0;16>d;++d)la[d]=ea[d];n.translate(V[1].lightMat,b,ea);for(d=0;16>d;++d)la[16+d]=ea[d];n.translate(V[2].lightMat,b,ea);for(d=0;16>d;++d)la[32+d]=ea[d];n.translate(V[3].lightMat,b,ea);for(d=0;16>d;++d)la[48+d]=ea[d];a.setUniformMatrix4fv("shadowMapMatrix",la)}};E=new Float32Array(16);E[0]=0;E[1]=0;E[2]=0;E[3]=0;E[4]=256;E[5]=0;
E[6]=1;E[7]=0;E[8]=0;E[9]=256;E[10]=0;E[11]=1;E[12]=256;E[13]=256;E[14]=1;E[15]=1;var ta=new l(k,c.Default3D,{geometry:b.Pos2Tex},{geometry:g.createVertex(k,p.STATIC_DRAW,E)});this.drawDebugQuad=function(a){h.assert(this.getEnableState());var b=d.get("showDepth");k.setDepthTestEnabled(!1);k.bindProgram(b);b.setUniformMatrix4fv("proj",a);b.setUniform1i("depthTex",0);k.bindTexture(z,0);k.bindVAO(ta);q.assertCompatibleVertexAttributeLocations(ta,b);k.drawArrays(p.TRIANGLE_STRIP,0,q.vertexCount(ta,"geometry"));
k.setDepthTestEnabled(!0)};var ma=x.create(),wa=x.create(),na=[x.create(),x.create(),x.create(),x.create()],sa=x.create(),Ea=x.create(),pa=x.create(),qa=x.create(),ua=x.create(),va=x.create(),Ca=x.create(),Fa=y.create(),Aa=x.create(),W=u.create()}})},"esri/views/3d/webgl-engine/lib/NearFarCalc":function(){define(["require","exports","./Util","./gl-matrix","./ComponentUtils"],function(a,h,p,m,f){a=m.vec3d;var e=m.vec4d,l=m.mat4d;m=function(){function a(){this._context={content:[],near:[],far:[],nearSpecial:[],
farSpecial:[],bestNear:0,bestFar:0,bestNear2:0,bestFar2:0};this._boundingInfoHelper=new g}a.prototype._resetContext=function(){var a=this._context;a.content.length=0;a.near.length=0;a.far.length=0;a.nearSpecial.length=0;a.farSpecial.length=0;a.bestNear=Number.MAX_VALUE;a.bestFar=-Number.MAX_VALUE;return this._context};a.prototype.calculateSceneNearFar=function(a,b,c){var e=this._resetContext(),g=a.viewMatrix,d=g[2],k=g[6],l=g[10],m=g[14],h=0,q;for(q in b)if(g=b[q],!f.isAllHidden(g.instanceParameters.componentVisibilities,
g.componentOffsets)&&g.castShadow&&c.get(g.idx)){var r=g.bsRadius,t=g.center,u=d*t[0]+k*t[1]+l*t[2]+m,t=u-r,r=u+r;e.content[h]=g;e.near[h]=-r;e.far[h]=-t;++h}if(0===h)return[e.bestNear,e.bestFar];for(b=0;b<h;++b)e.near[b]>e.bestFar&&(e.bestFar=e.near[b]),2<e.near[b]&&e.far[b]<e.bestNear&&(e.bestNear=e.far[b]);e.bestNear2=Math.max(.5*e.bestNear,2);e.bestFar2=2*e.bestFar;for(b=d=c=0;b<h;++b)e.near[b]<e.bestNear&&(e.near[b]>=e.bestNear2?e.bestNear=e.near[b]:e.nearSpecial[c++]=b),e.far[b]>e.bestFar&&
(e.far[b]<=e.bestFar2?e.bestFar=e.far[b]:e.farSpecial[d++]=b);if(0===c&&0===d)return[e.bestNear,e.bestFar];e.nearSpecial.length=c;e.farSpecial.length=d;e.nearSpecial.sort(;e.farSpecial.sort(;this._boundingInfoHelper.init(a,e);for(b=0;b<c;++b)e.near[e.nearSpecial[b]]<e.bestNear&&(g=e.content[e.nearSpecial[b]],a=g.boundingInfo,this._boundingInfoHelper.includeNearBoundingInfoRec(a,
g.transformation));for(b=0;b<d;++b)e.far[e.farSpecial[b]]>e.bestFar&&(g=e.content[e.farSpecial[b]],a=g.boundingInfo,this._boundingInfoHelper.includeFarBoundingInfoRec(a,g.transformation));return[e.bestNear,e.bestFar]};return a}();var g=function(){function a(){this._clippingHelper=new c;this._planes=[e.create(),e.create(),e.create(),e.create(),e.create(),e.create()];this._viewProj=l.create();this._view=l.create()}a.prototype.init=function(a,b){this._context=b;l.set(a.viewMatrix,this._view);l.multiply(a.projectionMatrix,
this._view,this._viewProj);a.copyFrustumPlanes(this._planes);this._clippingHelper.init(b)};a.prototype.includeNearBoundingInfoRec=function(a,b){var c=a.getBSRadius(),e=a.getCenter();l.multiplyVec3(b,e,q);var e=q[0],g=q[1],d=q[2],c=c*Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10]));if(!(this._planes[0][0]*e+this._planes[0][1]*g+this._planes[0][2]*d+this._planes[0][3]>c||this._planes[1][0]*e+this._planes[1][1]*g+this._planes[1][2]*
d+this._planes[1][3]>c||this._planes[2][0]*e+this._planes[2][1]*g+this._planes[2][2]*d+this._planes[2][3]>c||this._planes[3][0]*e+this._planes[3][1]*g+this._planes[3][2]*d+this._planes[3][3]>c||(e=this._view[2]*e+this._view[6]*g+this._view[10]*d+this._view[14],g=e+c,2>-(e-c)||-g>=this._context.bestNear)))if(-g>this._context.bestNear2)this._context.bestNear=-g;else{if(100<c&&(c=a.getChildren(),void 0!==c)){for(a=0;8>a;++a)void 0!==c[a]&&this.includeNearBoundingInfoRec(c[a],b);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,
b,a.getBBMin(),a.getBBMax())}};a.prototype.includeFarBoundingInfoRec=function(a,b){var c=a.getBSRadius(),e=a.getCenter();l.multiplyVec3(b,e,q);var e=q[0],g=q[1],d=q[2],c=c*Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10]));if(!(this._planes[0][0]*e+this._planes[0][1]*g+this._planes[0][2]*d+this._planes[0][3]>c||this._planes[1][0]*e+this._planes[1][1]*g+this._planes[1][2]*d+this._planes[1][3]>c||this._planes[2][0]*e+this._planes[2][1]*
g+this._planes[2][2]*d+this._planes[2][3]>c||this._planes[3][0]*e+this._planes[3][1]*g+this._planes[3][2]*d+this._planes[3][3]>c||(e=this._view[2]*e+this._view[6]*g+this._view[10]*d+this._view[14]-c,-e<=this._context.bestFar)))if(-e<this._context.bestFar2)this._context.bestFar=-e;else{if(100<c&&(c=a.getChildren(),void 0!==c)){for(a=0;8>a;++a)void 0!==c[a]&&this.includeFarBoundingInfoRec(c[a],b);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,b,a.getBBMin(),a.getBBMax())}};return a}(),
c=function(){function a(){this._clipP=Array(8);for(var a=0;8>a;++a)this._clipP[a]=e.create()}a.prototype.init=function(a){this._context=a};a.prototype.intersectFrustumAABB=function(a,c,e,g){l.multiply(a,c,x);for(a=0;8>a;++a){c=this._clipP[a];var f=0===a||3===a||4===a||7===a?e[0]:g[0],d=0===a||1===a||4===a||5===a?e[1]:g[1],k=4>a?e[2]:g[2];c[0]=x[0]*f+x[4]*d+x[8]*k+x[12];c[1]=x[1]*f+x[5]*d+x[9]*k+x[13];c[2]=x[2]*f+x[6]*d+x[10]*k+x[14];c[3]=x[3]*f+x[7]*d+x[11]*k+x[15]}for(a=0;12>a;++a){e=this._clipTriangle(this._clipP[b[a][0]],
this._clipP[b[a][1]],this._clipP[b[a][2]]);g=!0;for(c=0;c<e.length;++c)if(f=e[c][3],2<=f){g=!1;break}if(!g)for(c=0;c<e.length;++c)f=e[c][3],f<this._context.bestNear&&(this._context.bestNear=f),f>this._context.bestFar&&(this._context.bestFar=f)}};a.prototype._inside=function(a,b){if(0===b)return a[0]>=-a[3];if(1===b)return a[1]>=-a[3];if(2===b)return a[0]<=a[3];if(3===b)return a[1]<=a[3];p.assert(!1)};a.prototype._intersect=function(a,b,c){var g=0;0===c?g=(-a[3]-a[0])/(b[0]-a[0]+b[3]-a[3]):1===c?g=
(-a[3]-a[1])/(b[1]-a[1]+b[3]-a[3]):2===c?g=(a[3]-a[0])/(b[0]-a[0]-b[3]+a[3]):3===c&&(g=(a[3]-a[1])/(b[1]-a[1]-b[3]+a[3]));return e.lerp(a,b,g,e.create())};a.prototype._clipTriangle=function(a,b,c){a=[a,b,c];for(b=0;4>b;++b){c=a;a=[];for(var e=0;e<c.length;++e){var g=c[e],d=c[(e+1)%c.length];this._inside(d,b)?(this._inside(g,b)||a.push(this._intersect(g,d,b)),a.push(d)):this._inside(g,b)&&a.push(this._intersect(g,d,b))}}return a};return a}(),b=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,
7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],q=a.create(),x=l.create();return m})},"esri/views/3d/webgl-engine/lib/HighlightHelper":function(){define("require exports ./Util ./gl-matrix dojo/text!../materials/internal/highlight.xml ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y){var t=
m.vec4d;return function(){function a(a,b,c){this.blur1Fbo=this.blur0Fbo=this.quadVAO=null;this._rctx=c;this.viewportToRestore=t.create();this.programRep=a;this.color=t.create();this.exponent=.3;this.fill=.1;t.set4(1,0,.5,1,this.color)}a.prototype.createQuadVAO=function(){var a=this._rctx,b=new Float32Array([-1,-1,1,-1,-1,1,1,1]);return new g(a,y.Default3D,{geometry:x.Pos2},{geometry:c.createVertex(a,35044,b)})};a.prototype.getIsSupported=function(){return!0};a.prototype.setEnableState=function(a){a?
this.enable():this.disable()};a.prototype.getEnableState=function(){return null!==this.blur0Fbo};a.prototype.enable=function(){this.quadVAO=this.createQuadVAO();var a={colorTarget:0,depthStencilTarget:0,width:0,height:0};this.blur0Fbo=e.create(this._rctx,a);this.blur1Fbo=e.create(this._rctx,a)};a.prototype.disable=function(){this.getEnableState()&&(this.quadVAO.dispose(!0),this.blur1Fbo.dispose(),this.blur0Fbo.dispose(),this.blur1Fbo=this.blur0Fbo=this.quadVAO=null)};a.prototype.getHighlightFBO=function(){return this.blur0Fbo};
a.prototype.render=function(a,c,e){this.updateDebugData();var d=this._rctx;p.assert(this.getEnableState());t.set(a.fullViewport,this.viewportToRestore);a=Math.ceil(e.width/2);var g=Math.ceil(e.height/2);this.blur0Fbo.resize(a,g);this.blur1Fbo.resize(a,g);var f=this.programRep.get("highlight-blur"),n=this.programRep.get("highlight-apply");d.bindVAO(this.quadVAO);d.setDepthWriteEnabled(!1);d.setDepthTestEnabled(!1);d.setBlendingEnabled(!1);d.bindFramebuffer(this.blur0Fbo);d.bindTexture(e.colorTexture,
0);d.bindProgram(f);f.setUniform1i("tex",0);f.setUniform2f("blurSize",1/a,0);d.setViewport(0,0,a,g);d.drawArrays(5,0,b.vertexCount(this.quadVAO,"geometry"));d.bindFramebuffer(this.blur1Fbo);this.blur0Fbo.colorTexture.setSamplingMode(9729);d.bindTexture(this.blur0Fbo.colorTexture,0);f.setUniform2f("blurSize",0,1/g);d.drawArrays(5,0,b.vertexCount(this.quadVAO,"geometry"));d.bindFramebuffer(c);d.setBlendingEnabled(!0);d.setBlendFunctionSeparate(770,771,1,771);d.setViewport(this.viewportToRestore[0],
this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3]);d.bindProgram(n);n.setUniform1i("tex",0);this.blur1Fbo.colorTexture.setSamplingMode(9729);d.bindTexture(this.blur1Fbo.colorTexture,0);n.setUniform1i("origin",1);n.setUniform4fv("color",this.color);n.setUniform1f("exponent",this.exponent);n.setUniform1f("fill",this.fill);d.bindTexture(e.colorTexture,1);d.drawArrays(5,0,b.vertexCount(this.quadVAO,"geometry"));d.bindVAO(null);d.setDepthWriteEnabled(!0);d.setDepthTestEnabled(!0);
d.setBlendingEnabled(!1)};a.prototype.updateDebugData=function(){window.webglEngineHighlightColor?t.set(window.webglEngineHighlightColor,this.color):window.webglEngineHighlightColor=[this.color[0],this.color[1],this.color[2],this.color[3]];void 0!==window.webglEngineHighlightExponent?this.exponent=window.webglEngineHighlightExponent:window.webglEngineHighlightExponent=this.exponent;void 0!==window.webglEngineHighlightFill?this.fill=window.webglEngineHighlightFill:window.webglEngineHighlightFill=this.fill};
a.loadShaders=function(a,b,c,d){a._parse(f);b=new l(d,a.vsHighlightBlurG9,a.fsHighlightBlurG9,y.Default3D);a=new l(d,a.vsHighlightApply,a.fsHighlightApply,y.Default3D);c.add("highlight-blur",b);c.add("highlight-apply",a)};return a}()})},"esri/views/3d/webgl-engine/lib/OffscreenRenderingHelper":function(){define("require exports ./Util dojo/text!../materials/internal/offscreen.xml ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Program ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x){return function(){function a(a,b){this._enabled=!1;this.height=this.width=0;this._programRep=a;this._rctx=b;this.height=this.width=null}a.prototype.enable=function(){if(!this.getEnableState()){var a=this._rctx;this._enabled=!0;this.framebuffer=f.createWithAttachments(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:a.extensions.depthTexture?4:3});this.quadVAO=this.createQuadVAO(a)}};
a.prototype.disable=function(){this.getEnableState()&&(this._enabled=!1,this.framebuffer.dispose(),this.quadVAO.dispose(!0),this._depthStencilTextureCached=this.quadVAO=this.framebuffer=null)};a.prototype.createQuadVAO=function(a){var b=new Float32Array([-1,-1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,1,1,1]);return new e(a,x.Default3D,{geometry:q.Pos2Tex},{geometry:l.createVertex(a,35044,b)})};a.prototype.setEnableState=a.prototype.getEnableState=function(){return this._enabled};
a.prototype.getColorTexture=function(){return this.framebuffer.colorTexture};a.prototype.getDepthTexture=function(){return a.supportsDepthTexture(this._rctx.extensions)?this.framebuffer.depthStencilTexture||this._depthStencilTextureCached:null};a.supportsDepthTexture=function(a){return!!a.depthTexture};a.prototype.initializeFrame=function(a){p.assert(this.getEnableState());var b=this._rctx,c=b.gl;a=a.fullViewport;this.width=a[2];this.height=a[3];this.framebuffer.resize(this.width,this.height);b.bindFramebuffer(this.framebuffer);
b.setStencilWriteMask(255);b.setClearStencil(0);b.setClearColor(0,0,0,1);b.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT)};a.prototype.bindFramebuffer=a.prototype.getFramebuffer=function(){return this.framebuffer};a.prototype.detachDepthTextureFromBuffer=function(){this._depthStencilTextureCached=this.framebuffer.depthStencilTexture;this.framebuffer.detachDepthStencilTexture()};a.prototype.restoreDepthTextureToBuffer=a.prototype.drawQuad=function(a){p.assert(this.getEnableState());a=this._rctx;var b=a.gl,e=this._programRep.get("offscreenProgram");a.bindFramebuffer();a.setDepthTestEnabled(!1);a.clear(b.COLOR_BUFFER_BIT);a.bindProgram(e);e.setUniform1i("tex",1);a.bindTexture(this.framebuffer.colorTexture,1);a.bindVAO(this.quadVAO);a.drawArrays(5,0,c.vertexCount(this.quadVAO,"geometry"));a.setDepthTestEnabled(!0)};a.loadShaders=function(a,b,c,e){a._parse(m);a=new g(e,a.vsOffscreenRenderer,
a.fsOffscreenRenderer,x.Default3D);c.add("offscreenProgram",a)};return a}()})},"esri/views/3d/webgl-engine/materials/repository":function(){define("dojo/text!./internal/util.xml ./BillboardMaterial ./ColorMaterial ./HUDMaterial ./LeafCardMaterial ./Material ./RibbonLineMaterial ./WaterMaterial ./internal/SimpleGLMaterial ./internal/TexOnlyGLMaterial ./internal/BlendLayers".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){return{initializeShaders:function(x,y,t,u){x._parse(a);c.loadShaders(x,y,t,u);b.loadShaders(x,
y,t,u);e.loadShaders(x,y,t,u);h.loadShaders(x,y,t,u);m.loadShaders(x,y,t,u);f.loadShaders(x,y,t,u);l.loadShaders(x,y,t,u);g.loadShaders(x,y,t,u);q.loadShaders(x,y,t,u);p.loadShaders(x,y,t,u)}}})},"esri/views/3d/webgl-engine/materials/BillboardMaterial":function(){define("dojo/text!./BillboardMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(a,h,p,m,f,e,l){var g=
function(a,g){h.basicMaterialConstructor(this,g);var f=e.Pos3NormTex;this.getSize=function(){return 1.05};this.dispose=function(){};this.getTextureId=function(){return a};this.getOutputAmount=function(a){var b=l.getStride(f)/4;return a*b*6};this.getVertexBufferLayout=function(){return f};this.fillInterleaved=function(a,b,c,e,d,g){e=h.fill;var f=a.faces.indices.va,k=a.vertexAttr.va.data,n=a.vertexAttr.tc4.data,l=a.vertexAttr.n0.data,m=a.vertexAttr.n1.data,q=a.vertexAttr.n2.data;a=a.vertexAttr.n3.data;
for(var r=0;r<f.length;++r){var t=4*f[r],w=3*f[r];g+=e(k,t,d,g,b,3);g+=e(l,w,d,g,c,3);d[g++]=n[t];d[g++]=n[t+1];g+=e(k,t,d,g,b,3);g+=e(m,w,d,g,c,3);d[g++]=n[t+2]+1;d[g++]=n[t+1];g+=e(k,t,d,g,b,3);g+=e(q,w,d,g,c,3);d[g++]=n[t+2]+1;d[g++]=n[t+3]+1;g+=e(k,t,d,g,b,3);g+=e(q,w,d,g,c,3);d[g++]=n[t+2]+1;d[g++]=n[t+3]+1;g+=e(k,t,d,g,b,3);g+=e(a,w,d,g,c,3);d[g++]=n[t];d[g++]=n[t+3]+1;g+=e(k,t,d,g,b,3);g+=e(l,w,d,g,c,3);d[g++]=n[t];d[g++]=n[t+1]}};this.intersect=function(){};this.getGLMaterials=function(){return{color:c,
depthShadowMap:q,normal:void 0,depth:b,highlight:void 0}};this.getAllTextureIds=function(){return[a]}},c=function(a,b,c){h.basicGLMaterialConstructor(this,a);var e=p.TRANSPARENT_MATERIAL,g=b.get("billboard");h.singleTextureGLMaterialConstructor(this,c,{textureId:a.getTextureId()});this.beginSlot=function(a){return e===a};this.getProgram=function(){return g};this.bind=function(a,b){a.bindProgram(g);this.bindTexture(a,g);a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,
a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0)};this.release=function(a){};this.bindView=function(a,b){h.bindView(b.origin,b.view,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation);g.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},b=function(a,b,c,e){h.basicGLMaterialConstructor(this,a);var g=p.TRANSPARENT_MATERIAL,f=null==e?b.get("billboardDepth"):b.get("billboardDepthShadowMap");h.singleTextureGLMaterialConstructor(this,
c,{textureId:a.getTextureId()});this.beginSlot=function(a){return g===a};this.getProgram=function(){return f};this.bind=function(a,b){a.bindProgram(f);this.bindTexture(a,f);f.setUniform2fv("nearFar",b.nearFar)};this.release=function(a){};this.bindView=function(a,b){h.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.detUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},q=function(a,c,e){b.call(this,a,c,e,!0)};g.loadShaders=function(b,c,e,
g){b._parse(a);var l=new m(g,b.vertexShaderBillboard,b.fragmentShaderBillboard,f.Default3D),n=c.get("fsDepthTextured");c=c.get("fsDepthTexturedShadowMap");n=new m(g,b.vertexShaderBillboardDepth,n.source,f.Default3D,n.defines);b=new m(g,b.vertexShaderBillboardDepth,c.source,f.Default3D,c.defines);e.add("billboard",l);e.add("billboardDepth",n);e.add("billboardDepthShadowMap",b)};return g})},"esri/views/3d/webgl-engine/materials/ColorMaterial":function(){define("dojo/_base/lang dojo/text!./ColorMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../lib/Util ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(a,h,p,m,f,e,l,g,c){f=function(a,e){p.basicMaterialConstructor(this,e);a=a||{};a.color=a.color||[1,1,1,1];a.polygonOffset=a.polygonOffset||!1;a.vertexColors=a.vertexColors||!1;var f=g.Pos3Color;this.getParams=function(){return a};this.setColor=function(b){a.color=b;this.notifyDirty("matChanged")};this.getColor=function(){return a.color};this.setTransparent=function(b){a.transparent=b;this.notifyDirty("matChanged")};this.getTransparent=function(b){return a.transparent};this.dispose=function(){};
this.getOutputAmount=function(a){var b=c.getStride(f)/4;return a*b};this.getVertexBufferLayout=function(){return f};this.fillInterleaved=function(a,b,c,e,d,g,l){p.fillInterleaved(a,b,c,e,f,d,g,l)};this.intersect=p.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:b,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:q}};this.getAllTextureIds=function(){return[]}};var b=function(b,c,e){p.basicGLMaterialConstructor(this,b);var g=a.clone(b.getParams()),f=c.get("colorMaterial"),
n=b.getColor();this.beginSlot=function(a){return a===(1>n[3]?m.TRANSPARENT_MATERIAL:m.OPAQUE_MATERIAL)};this.getProgram=function(){return f};this.updateParameters=function(){g.color=b.getColor();g.transparent=b.getTransparent()};this.bind=function(a,b){a.bindProgram(f);f.setUniform4fv("eColor",g.color);a.setFaceCullingEnabled(!1);g.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(1,1));g.transparent&&(a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,
a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA));a.setDepthTestEnabled(!0)};this.release=function(a){a.setPolygonOffsetFillEnabled(!1);g.transparent&&a.setBlendingEnabled(!1)};this.bindView=function(a,b){p.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},q=function(b,c,e){p.basicGLMaterialConstructor(this,b);var g=a.clone(b.getParams()),f=c.get("colorMaterial"),n=[1,1,1,1];this.beginSlot=function(a){return a===
(1>n[3]?m.TRANSPARENT_MATERIAL:m.OPAQUE_MATERIAL)};this.getProgram=function(){return f};this.updateParameters=this.bind=function(a,b){a.bindProgram(f);f.setUniform4fv("eColor",g.color);a.setFaceCullingEnabled(!1);g.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(1,1))};this.release=this.bindView=function(a,b){p.bindView(b.origin,b.view,f)};this.bindInstance=function(a,
b){f.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};f.programs=null;f.loadShaders=function(a,b,c,g){a._parse(h);a=new e(g,a.vertexShaderColorMaterial,a.fragmentShaderColorMaterial,l.Default3D);c.add("colorMaterial",a)};return f})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("dojo/_base/lang dojo/text!./HUDMaterial.xml ./internal/MaterialUtil ../lib/ShaderVariations ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../../../webgl/Util".split(" "),
function(a,h,p,m,f,e,l,g,c,b){function q(a,b,d){d[0]=a[0]*(b[2]-b[0])+b[0];d[1]=a[1]*(b[3]-b[1])+b[1]}var x=e.vec2d,y=e.vec3d,t=e.mat4d,u=f.assert,r=f.VertexAttrConstants,n={"bottom-left":[0,0],bottom:[.5,0],"bottom-right":[1,0],left:[0,.5],center:[.5,.5],right:[1,.5],"top-left":[0,1],top:[.5,1],"top-right":[1,1]},w=[253/255,231/255,229/255];f=function(a,c){p.basicMaterialConstructor(this,c);a=a||null;a.texCoordScale=a.texCoordScale||[1,1];a.occlusionTest=void 0!==a.occlusionTest?a.occlusionTest:
!0;a.color=a.color||[1,1,1,1];a.screenMinMaxSize=a.screenMinMaxSize||[0,1E5];a.outlineColor=a.outlineColor||[1,1,1,1];a.outlineSize=a.outlineSize||0;a.textureIsSignedDistanceField=a.textureIsSignedDistanceField?1:0;a.distanceFieldBoundingBox=a.distanceFieldBoundingBox;a.vvSizeEnabled=a.vvSizeEnabled||!1;a.vvSizeMinSize=a.vvSizeMinSize||[1,1,1];a.vvSizeMaxSize=a.vvSizeMaxSize||[100,100,100];a.vvSizeOffset=a.vvSizeOffset||[0,0,0];a.vvSizeFactor=a.vvSizeFactor||[1,1,1];a.vvColorEnabled=a.vvColorEnabled||
!1;a.vvColorValues=a.vvColorValues||[0,0,0,0,0,0,0,0];a.vvColorColors=a.vvColorColors||[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0];a.screenOffset?a.screenOffset.forEach(function(b,d){a.screenOffset[d]=2*b}):a.screenOffset=[0,0];"string"===typeof a.anchorPos?(u(n[a.anchorPos],"HUDMaterial: invalid anchorPos specified"),a.anchorPos=n[a.anchorPos]):a.anchorPos||(a.anchorPos=n.center);null==a.shaderPolygonOffset&&(a.shaderPolygonOffset=1E-5);var e=[{name:"position",count:3,type:5126,
offset:0,stride:76,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:76,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:76,normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:76,normalized:!1},{name:"size",count:2,type:5126,offset:36,stride:76,normalized:!1},{name:"auxpos1",count:4,type:5126,offset:44,stride:76,normalized:!1},{name:"auxpos2",count:4,type:5126,offset:60,stride:76,normalized:!1}],g=b.getStride(e),f=g/4;this.dispose=function(){};this.getParameterValues=
function(){var b={color:a.color,texCoordScale:a.texCoordScale,polygonOffset:a.polygonOffset,anchorPos:a.anchorPos,screenOffset:a.screenOffset,screenMinMaxSize:a.screenMinMaxSize,shaderPolygonOffset:a.shaderPolygonOffset,textureIsSignedDistanceField:a.textureIsSignedDistanceField,outlineColor:a.outlineColor,outlineSize:a.outlineSize,distanceFieldBoundingBox:a.distanceFieldBoundingBox,vvSizeEnabled:a.vvSizeEnabled,vvSizeMinSize:a.vvSizeMinSize,vvSizeMaxSize:a.vvSizeMaxSize,vvSizeOffset:a.vvSizeOffset,
vvSizeFactor:a.vvSizeFactor,vvColorEnabled:a.vvColorEnabled,vvColorValues:a.vvColorValues,vvColorColors:a.vvColorColors};a.textureId&&(b.textureId=a.textureId);a.direction&&(b.direction=a.direction);return b};this.setParameterValues=function(b){for(var d in b)"textureId"===d&&u(a.textureId,"Can only change texture of material that already has a texture"),"direction"===d&&u(a.direction,"Can only change direction of HUDMaterial which was initialized with a direction"),a[d]=b[d];this.notifyDirty("matChanged")};
this.getParams=function(){return a};this.getOutputAmount=function(a){return a*f*6};this.getVertexBufferLayout=function(){return e};this.fillInterleaved=function(d,c,k,n,l,m){var h=4*m;n=p.fill;for(var q=d.faces.indices[r.POSITION],t=d.vertexAttr[r.POSITION].data,w=m+b.findAttribute(e,r.POSITION).offset/4,v=0;v<q.length;++v){var u=3*q[v];n(t,u,l,w,c,3);w+=f;n(t,u,l,w,c,3);w+=f;n(t,u,l,w,c,3);w+=f;n(t,u,l,w,c,3);w+=f;n(t,u,l,w,c,3);w+=f;n(t,u,l,w,c,3);w+=f}c=d.faces.indices[r.NORMAL];t=d.vertexAttr[r.NORMAL].data;
w=m+b.findAttribute(e,r.NORMAL).offset/4;for(v=0;v<c.length;++v)u=3*c[v],n(t,u,l,w,k,3),w+=f,n(t,u,l,w,k,3),w+=f,n(t,u,l,w,k,3),w+=f,n(t,u,l,w,k,3),w+=f,n(t,u,l,w,k,3),w+=f,n(t,u,l,w,k,3),w+=f;w=m+b.findAttribute(e,r.UV0).offset/4;v=d.vertexAttr[r.UV0].data;null==v||3>=v.length?(k=u=0,c=a.texCoordScale[0],t=a.texCoordScale[1]):(u=d.vertexAttr[r.UV0].data[0],k=d.vertexAttr[r.UV0].data[1],c=d.vertexAttr[r.UV0].data[2],t=d.vertexAttr[r.UV0].data[3]);c=Math.min(1.99999,c+1);t=Math.min(1.99999,t+1);for(v=
0;v<q.length;++v)l[w]=u,l[w+1]=k,w+=f,l[w]=c,l[w+1]=k,w+=f,l[w]=c,l[w+1]=t,w+=f,l[w]=c,l[w+1]=t,w+=f,l[w]=u,l[w+1]=t,w+=f,l[w]=u,l[w+1]=k,w+=f;q=d.faces.indices[r.COLOR];k=d.vertexAttr[r.COLOR].data;w=h+b.findAttribute(e,r.COLOR).offset;h=new Uint8Array(l.buffer);for(v=0;v<q.length;++v)u=4*q[v],n(k,u,h,w,null,4),w+=g,n(k,u,h,w,null,4),w+=g,n(k,u,h,w,null,4),w+=g,n(k,u,h,w,null,4),w+=g,n(k,u,h,w,null,4),w+=g,n(k,u,h,w,null,4),w+=g;h=d.faces.indices[r.SIZE];u=d.vertexAttr[r.SIZE].data;w=m+b.findAttribute(e,
r.SIZE).offset/4;for(v=0;v<h.length;++v)q=u[2*h[v]],k=u[2*h[v]+1],l[w]=q,l[w+1]=k,w+=f,l[w]=q,l[w+1]=k,w+=f,l[w]=q,l[w+1]=k,w+=f,l[w]=q,l[w+1]=k,w+=f,l[w]=q,l[w+1]=k,w+=f,l[w]=q,l[w+1]=k,w+=f;if(null!=d.faces.indices[r.AUXPOS1]&&null!=d.vertexAttr[r.AUXPOS1])for(h=d.faces.indices[r.AUXPOS1],q=d.vertexAttr[r.AUXPOS1].data,w=m+b.findAttribute(e,"auxpos1").offset/4,v=0;v<h.length;++v)u=4*h[v],n(q,u,l,w,null,4),w+=f,n(q,u,l,w,null,4),w+=f,n(q,u,l,w,null,4),w+=f,n(q,u,l,w,null,4),w+=f,n(q,u,l,w,null,4),
w+=f,n(q,u,l,w,null,4),w+=f;if(null!=d.faces.indices[r.AUXPOS2]&&null!=d.vertexAttr[r.AUXPOS2])for(h=d.faces.indices[r.AUXPOS2],d=d.vertexAttr[r.AUXPOS2].data,w=m+b.findAttribute(e,"auxpos2").offset/4,v=0;v<h.length;++v)u=4*h[v],n(d,u,l,w,null,4),w+=f,n(d,u,l,w,null,4),w+=f,n(d,u,l,w,null,4),w+=f,n(d,u,l,w,null,4),w+=f,n(d,u,l,w,null,4),w+=f,n(d,u,l,w,null,4),w+=f};var l=y.create(),m=y.create(),h=t.create();t.identity(h);var w=[0,0],v=[0,0];this.intersect=function(b,d,c,e,g,f,k,n){if(e.isSelection&&
e.enableHUDSelection){g=d=1;n&&(g=n(h),d=g[0],g=g[5]);n=b.getData().getVertexAttr()[r.POSITION];b=b.getData().getVertexAttr()[r.SIZE];u(3<=n.size);f=e.point;var p=e.camera;a.textureIsSignedDistanceField?q(a.anchorPos,a.distanceFieldBoundingBox,v):x.set(a.anchorPos,v);for(var A=0;A<n.data.length/n.size;A++){var z=A*n.size;y.set3(n.data[z],n.data[z+1],n.data[z+2],l);t.multiplyVec3(c,l,l);z=A*b.size;w[0]=b.data[z]*d;w[1]=b.data[z+1]*g;p.projectPoint(l,m);if(-1<m[0]){var z=m[0]-1-(0<v[0]?w[0]*v[0]:0),
D=z+w[0]+2,B=m[1]-1-(0<v[1]?w[1]*v[1]:0),H=B+w[1]+2;if(a.textureIsSignedDistanceField)var O=a.outlineSize/2,E=a.distanceFieldBoundingBox,z=z+w[0]*E[0],B=B+w[1]*E[1],D=D-w[0]*(1-E[2]),H=H-w[1]*(1-E[3]),z=z-O,D=D+O,B=B-O,H=H+O;f[0]>z&&f[0]<D&&f[1]>B&&f[1]<H&&(D=e.p0,B=e.p1,m[0]=f[0],m[1]=f[1],p.unprojectPoint(m,l),z=y.negate(e.getDirection(),y.create()),D=y.dist(D,l)/y.dist(D,B),k(D,z,-1,1,!0))}}}};this.getGLMaterials=function(){return{color:d,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:k}};
this.getAllTextureIds=this._textureDirty=!1;this.setTextureDirty=;var d=function(b,d,c){function e(){return d.shaderVariators.HUDMaterial.getProgram([!!n.direction,!!n.worldScale,n.occlusionTest,n.textureIsSignedDistanceField,!!n.vvSizeEnabled,!!n.vvColorEnabled])}p.basicGLMaterialConstructor(this,b);var g=l.OCCLUSION_PIXELS,f=l.OVERLAY,k=0,n=a.clone(b.getParams()),m=d.get("hudOcclusionTestPixel"),h=e();p.singleTextureGLMaterialConstructor(this,
c,n);this.beginSlot=function(a){k=a;return n.occlusionTest?a===g||a===f:a===f};this.getProgram=function(){return k===g&&n.occlusionTest?m:h};this.getAllPrograms=function(){return[m,h]};this.updateParameters=function(){var a=b.getParams();n.color=a.color;n.texCoordScale=a.texCoordScale;n.polygonOffset=a.polygonOffset;n.anchorPos=a.anchorPos;n.screenOffset=a.screenOffset;n.screenMinMaxSize=a.screenMinMaxSize;n.direction=a.direction;n.shaderPolygonOffset=a.shaderPolygonOffset;n.textureIsSignedDistanceField=
a.textureIsSignedDistanceField;n.outlineColor=a.outlineColor;n.outlineSize=a.outlineSize;n.vvSizeEnabled=a.vvSizeEnabled;n.vvSizeMinSize=a.vvSizeMinSize;n.vvSizeMaxSize=a.vvSizeMaxSize;n.vvSizeOffset=a.vvSizeOffset;n.vvSizeFactor=a.vvSizeFactor;n.vvColorEnabled=a.vvColorEnabled;n.vvColorValues=a.vvColorValues;n.vvColorColors=a.vvColorColors;this.updateTexture(a.textureId);h=e()};var r=[0,0];this.bind=function(a,d){b._textureDirty&&(this.renderTexture(a),b._textureDirty=!1);var c=a.gl,e=d.cameraAboveGround?
1:-1;if(k===g&&n.occlusionTest)a.bindProgram(m),m.setUniform1f("cameraGroundRelative",e),m.setUniform1f("polygonOffset",n.shaderPolygonOffset),m.setUniform4fv("viewport",d.viewport),m.setUniform4f("color",w[0],w[1],w[2],1),a.setDepthFunction(c.LEQUAL);else{a.bindProgram(h);h.setUniform1f("cameraGroundRelative",e);this.bindTexture(a,h);h.setUniform1i("framebufferTex",1);a.bindTexture(d.framebufferTex,1);a.setActiveTexture(0);h.setUniform3fv("markerColor",w);h.setUniform4fv("viewport",d.viewport);h.setUniform4fv("overrideColor",
n.color);h.setUniform1f("pixelRatio",d.pixelRatio);h.setUniform1f("polygonOffset",n.shaderPolygonOffset);n.textureIsSignedDistanceField&&(h.setUniform4fv("outlineColor",n.outlineColor),h.setUniform1f("outlineSize",n.outlineSize));n.vvSizeEnabled&&(h.setUniform3fv("vvSizeMinSize",n.vvSizeMinSize),h.setUniform3fv("vvSizeMaxSize",n.vvSizeMaxSize),h.setUniform3fv("vvSizeOffset",n.vvSizeOffset),h.setUniform3fv("vvSizeFactor",n.vvSizeFactor));n.vvColorEnabled&&(h.setUniform1fv("vvColorValues",n.vvColorValues),
h.setUniform4fv("vvColorColors",n.vvColorColors));if(n.worldScale){var c=[-1,-1],e=n.screenMinMaxSize,f=d.proj;d=d.viewport[2]/d.pixelRatio;e&&(0!==f[11]?(d=Math.tan(2*Math.atan(1/f[0])/2)/d*2,c[0]=e[0]*d,c[1]=e[1]*d):x.scale(e,2/(f[0]*d),c));h.setUniform2fv("minMaxWorldSizeFactor",c)}n.direction&&h.setUniform3fv("direction",n.direction);h.setUniform2fv("texScale",n.texCoordScale);h.setUniform2fv("screenOffset",n.screenOffset);n.textureIsSignedDistanceField?(q(n.anchorPos,n.distanceFieldBoundingBox,
r),h.setUniform2fv("anchorPos",r)):h.setUniform2fv("anchorPos",n.anchorPos);n.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setBlendingEnabled(!0)}};this.release=function(a){var b=a.gl;k===g&&n.occlusionTest?a.setDepthFunction(b.LESS):(a.setPolygonOffsetFillEnabled(!1),a.setBlendingEnabled(!1))};this.bindView=function(a,b){a=b.origin;k===g&&n.occlusionTest?(p.bindView(a,b.view,m),p.bindCamPos(a,b.viewInvTransp,m)):(p.bindView(a,b.view,h),p.bindCamPos(a,b.viewInvTransp,
h))};this.bindInstance=function(a,b){k===g&&n.occlusionTest?(m.setUniformMatrix4fv("model",b.transformation),m.setUniformMatrix4fv("modelNormal",b.transformationNormal)):h.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){a=a.gl;return k===g&&n.occlusionTest?a.POINTS:a.TRIANGLES}},k=function(b,d,c){function e(){return d.shaderVariators.HUDMaterialHighlight.getProgram([!!g.direction,!!g.worldScale,g.occlusionTest,g.textureIsSignedDistanceField,!!g.vvSizeEnabled,!!g.vvColorEnabled])}
p.basicGLMaterialConstructor(this,b);var g=a.clone(b.getParams()),f=d.get("hudOcclusionTestPixel"),k=e();p.singleTextureGLMaterialConstructor(this,c,g);this.beginSlot=function(a){return a===l.OVERLAY};this.getProgram=function(){return k};this.getAllPrograms=function(){return[f,k]};this.updateParameters=function(){var a=b.getParams();g.color=a.color;g.texCoordScale=a.texCoordScale;g.polygonOffset=a.polygonOffset;g.anchorPos=a.anchorPos;g.screenOffset=a.screenOffset;g.screenMinMaxSize=a.screenMinMaxSize;
g.direction=a.direction;g.shaderPolygonOffset=a.shaderPolygonOffset;g.textureIsSignedDistanceField=a.textureIsSignedDistanceField;g.outlineColor=a.outlineColor;g.outlineSize=a.outlineSize;this.updateTexture(a.textureId);k=e()};var n=[0,0];this.bind=function(a,d){b._textureDirty&&(this.renderTexture(a),b._textureDirty=!1);a.bindProgram(k);this.bindTexture(a,k);k.setUniform1i("framebufferTex",1);a.bindTexture(d.framebufferTex,1);a.setActiveTexture(0);k.setUniform3fv("markerColor",w);k.setUniform4fv("viewport",
d.viewport);k.setUniform4fv("overrideColor",g.color);k.setUniform1f("pixelRatio",d.pixelRatio);k.setUniform1f("polygonOffset",g.shaderPolygonOffset);g.textureIsSignedDistanceField&&(k.setUniform4fv("outlineColor",g.outlineColor),k.setUniform1f("outlineSize",g.outlineSize));if(g.worldScale){var c=[-1,-1],e=g.screenMinMaxSize,f=d.proj;d=d.viewport[2]/d.pixelRatio;e&&(0!==f[11]?(f=Math.tan(2*Math.atan(1/f[0])/2)/d*2,c[0]=e[0]*f,c[1]=e[1]*f):x.scale(e,2/(f[0]*d),c));k.setUniform2fv("minMaxWorldSizeFactor",
c)}g.direction&&k.setUniform3fv("direction",g.direction);k.setUniform2fv("texScale",g.texCoordScale);k.setUniform2fv("screenOffset",g.screenOffset);g.textureIsSignedDistanceField?(q(g.anchorPos,g.distanceFieldBoundingBox,n),k.setUniform2fv("anchorPos",n)):k.setUniform2fv("anchorPos",g.anchorPos);g.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setBlendingEnabled(!0)};this.release=this.bindView=function(a,
b){a=b.origin;p.bindView(a,b.view,k);p.bindCamPos(a,b.viewInvTransp,k)};this.bindInstance=function(a,b){k.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};f.loadShaders=function(a,b,d,e){a._parse(h);var f=0<e.parameters.maxVertexTextureImageUnits,k=new m("hud",["vertexShaderHUD","fragmentShaderHUD"],null,d,b,a,e);k.addBinaryShaderSnippetSuffix("Direction","Direction",[!0,!1]);k.addBinaryShaderSnippetSuffix("WorldScale","WorldScale",[!0,!1]);k.addDefine("OcclTest",
f?"OCCL_TEST":"OCCL_PIXELSHADER");k.addDefine("SDF","SIGNED_DISTANCE_FIELD");k.addDefine("vvSize","VV_SIZE");k.addDefine("vvColor","VV_COLOR");d.shaderVariators.HUDMaterial=k;b=new m("hudHighlight",["vertexShaderHUD","fragmentShaderHUDHighlight"],null,d,b,a,e);b.addBinaryShaderSnippetSuffix("Direction","Direction",[!0,!1]);b.addBinaryShaderSnippetSuffix("WorldScale","WorldScale",[!0,!1]);b.addDefine("OcclTest",f?"OCCL_TEST":"OCCL_PIXELSHADER");b.addDefine("SDF","SIGNED_DISTANCE_FIELD");b.addDefine("vvSize",
"VV_SIZE");b.addDefine("vvColor","VV_COLOR");d.shaderVariators.HUDMaterialHighlight=b;a=new g(e,a.vertexShaderOcclusionTestPixel,a.fragmentShaderSimple,c.Default3D);d.add("hudOcclusionTestPixel",a)};return f})},"esri/views/3d/webgl-engine/lib/ShaderVariations":function(){define(["dojo/_base/lang","./Util","../../../webgl/Program","./DefaultVertexAttributeLocations"],function(a,h,p,m){var f=h.assert,e=return function(l,g,c,b,h,x,y){f(2===g.length,"you must specify shader snippet prefixes for vertex and fragment shaders");
c&&0!==c.length||(c=[]);var q=[],u=!1,r={};this.addDefine=function(a,b,d,c){f(!u,"you cannot add another variable after the first program has been generated");f(a,"you must specify a program name suffix");q.push({programNameSuffixes:["",a],shaderNameSuffixes:c||a,defineStr:b,affectsShaderTypes:d||[!0,!0]})};this.addBinaryShaderSnippetSuffix=function(a,b,d){f(!u,"you cannot add another variable after the first program has been generated");f(a,"you must specify a program name suffix");q.push({programNameSuffixes:["",
a],shaderSnippetSuffixes:["",b],affectsShaderTypes:d||[!0,!0]})};this.addNaryShaderSnippetSuffix=function(a,b){f(!u,"you cannot add another variable after the first program has been generated");var d=a.map(function(a){f(null!=a.value,"value must always be specified");return a.value});q.push({values:d,programNameSuffixes:a.map(function(a,b){return null!=a.programNameSuffix?a.programNameSuffix:d[b]}),shaderSnippetSuffixes:a.map(,affectsShaderTypes:b||[!0,!0]})};this.getShaderVariation=function(b){f(b.length===q.length,"you must specify a value for each variable");for(var e=l,d=a.clone(g),k=a.clone(g),n=a.clone(c),h=0;h<q.length;h++){var m=q[h],r=b[h],t;m.values?(t=m.values.indexOf(r),f(0<=t,"invalid value "+r+" for variable "+h)):t=r?1:0;e+=m.programNameSuffixes[t];for(r=0;2>r;r++)m.affectsShaderTypes[r]&&(m.shaderSnippetSuffixes&&(d[r]+=m.shaderSnippetSuffixes[t],k[r]+=m.shaderSnippetSuffixes[t]),m.defineStr&&t&&
(n.push(m.defineStr),k[r]+=m.shaderNameSuffixes))}return{programName:e,shaderSnippetNames:d,shaderNames:k,defines:n}};this.getProgram=function(a,c,d){c=c||x;d=d||y;u=!0;var g=a.reduce(e,"");if(r[g])return r[g];a=this.getShaderVariation(a);var n=b.get(a.programName);if(n)return n;var l,n=a.shaderSnippetNames[0];l=c[n];f(null!=l,"shader snippet '"+n+"' does not exist");n=a.shaderSnippetNames[1];c=c[n];f(null!=c,"shader snippet '"+n+"' does not exist");n=new p(d,l,c,m.Default3D,a.defines);r[g]=n;b.add(a.programName,
n);return n}}})},"esri/views/3d/webgl-engine/materials/LeafCardMaterial":function(){define("dojo/text!./LeafCardMaterial.xml ./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../../../webgl/Util".split(" "),function(a,h,p,m,f,e,l,g){function c(){r=(9301*r+49297)%233280;return r/233280}var b=m.vec3,q=m.mat4,x=m.mat4d;m=function(a,e,d,f,l,m){h.basicMaterialConstructor(this,m);var k=[{name:"position",count:3,type:5126,
offset:0,stride:44,normalized:!1},{name:"normal",count:4,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:4,type:5126,offset:28,stride:44,normalized:!1}],n=g.getStride(k)/4;this.getAmbient=function(){return e};this.getDiffuse=function(){return d};this.getSpecular=function(){return f};this.getShininess=function(){return l};this.dispose=function(){};this.getTextureId=function(){return a};this.getOutputAmount=function(a){var b=0,d;for(d=0;d<a/6;d++)0===d%1&&(b+=6);a=b;for(d=b=0;d<a/6;d++)0===
d%1&&(b+=6);return b*n};this.getVertexBufferLayout=function(){return k};this.reduce=function(a,b){var d=a.position,c=a.normal;a=a.uv0;for(var e=[],g=[],f=[],k=0,n=0;n<d.length/6;n++)if(0===n%b)for(var l=0;6>l;l++)e[k]=d[6*n+l],g[k]=c[6*n+l],f[k]=a[6*n+l],k++;return{position:e,normal:g,uv0:f}};this.fillInterleaved=function(a,d,e,g,f,k){g=h.fill;var l=this.reduce(a.faces.indices,1),l=this.reduce(l,1),m=this.getOutputAmount(a.faces.indices.position.length);p.assert(m===l.position.length*n);var r=l.position,
t=l.normal,w=l.uv0,l=a.vertexAttr.position.data,u=a.vertexAttr.normal.data,v=a.vertexAttr.uv0.data,A=b.create();a=r.length/6;for(var m=k,y=b.createFrom(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),z=b.createFrom(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),D=0;D<a;++D){for(var B=b.create(),E=b.create(),H=[100,100,-100,-100],O=b.create(),C=0;6>C;++C){var M=6*D+C,F=3*r[M],K=3*t[M],M=2*w[M];B[0]+=l[F+0];B[1]+=l[F+1];B[2]+=l[F+2];E[0]+=u[K+0];E[1]+=u[K+1];E[2]+=u[K+2];K=v[M+0];M=v[M+
1];H[0]=Math.min(H[0],K);H[1]=Math.min(H[1],M);H[2]=Math.max(H[2],K);H[3]=Math.max(H[3],M);0===C&&b.set3(l[F+0],l[F+1],l[F+2],O)}B[0]/=6;B[1]/=6;B[2]/=6;E[0]/=6;E[1]/=6;E[2]/=6;B[0]+=.1*(2*c()-1);B[1]+=.1*(2*c()-1);B[2]+=.1*(2*c()-1);void 0!==d&&(x.multiplyVec3(d,O,O),x.multiplyVec3(d,B,B),x.multiplyVec3(e,E,E));b.add(B,A,A);b.max(y,B,y);b.min(z,B,z);H[0]+=.01;H[1]+=.01;H[2]-=.01;H[3]-=.01;for(C=0;4>C;C++)H[C]=Math.min(H[C],.99999);C=2*c()*Math.PI;O=1.41*b.dist(O,B);k+=g(B,0,f,k,void 0,3);k+=g(E,
0,f,k,void 0,3);f[k++]=0;f[k++]=H[0];f[k++]=H[1];f[k++]=C;f[k++]=O;k+=g(B,0,f,k,void 0,3);k+=g(E,0,f,k,void 0,3);f[k++]=0;f[k++]=H[2]+1;f[k++]=H[1];f[k++]=C;f[k++]=O;k+=g(B,0,f,k,void 0,3);k+=g(E,0,f,k,void 0,3);f[k++]=0;f[k++]=H[2]+1;f[k++]=H[3]+1;f[k++]=C;f[k++]=O;k+=g(B,0,f,k,void 0,3);k+=g(E,0,f,k,void 0,3);f[k++]=0;f[k++]=H[2]+1;f[k++]=H[3]+1;f[k++]=C;f[k++]=O;k+=g(B,0,f,k,void 0,3);k+=g(E,0,f,k,void 0,3);f[k++]=0;f[k++]=H[0];f[k++]=H[3]+1;f[k++]=C;f[k++]=O;k+=g(B,0,f,k,void 0,3);k+=g(E,0,f,
k,void 0,3);f[k++]=0;f[k++]=H[0];f[k++]=H[1];f[k++]=C;f[k++]=O}A[0]/=a;A[1]/=a;A[2]/=a;d=b.create();b.add(y,z,d);b.scale(d,.5,d);k=b.create();b.subtract(y,z,k);k[0]=Math.abs(k[0])/2;k[1]=Math.abs(k[1])/2;k[2]=Math.abs(k[2])/2;r=b.create(A);r[1]-=(y[1]-z[1])/3;y=b.create();z=b.create();l=b.create();t=[b.create(),b.create(),b.create(),b.create()];A=[0,0,0,0];w=q.create();for(D=0;D<a;++D){b.set3(f[m],f[m+1],f[m+2],l);b.subtract(l,r,y);b.normalize(y,y);z=b.subtract(l,d,z);b.normalize(z,z);v=Math.abs(b.dot(z,
[1,0,0]));C=Math.abs(b.dot(z,[0,1,0]));u=Math.abs(b.dot(z,[0,0,1]));v=v*Math.abs(d[0]-l[0])/k[0];v+=C*Math.abs(d[1]-l[1])/k[1];v+=u*Math.abs(d[2]-l[2])/k[2];for(C=0;4>C;C++)q.identity(w),q.rotate(w,.8*(2*c()-1),[0,1,0],w),q.rotate(w,.8*(2*c()-1),[1,0,0],w),q.multiplyVec3(w,y,t[C]),A[C]=.5+.5*v-.2*(2*c()-1);u=.8+.3*(2*c()-1);for(C=0;6>C;++C){var la;switch(C){case 0:la=0;break;case 1:la=1;break;case 2:la=2;break;case 3:la=2;break;case 4:la=3;break;case 5:la=0}m+=3;m+=g(t[la],0,f,m,e,3);f[m++]=A[la];
m+=3;f[m++]*=u}}};this.intersect=function(){};this.getGLMaterials=function(){return{color:y,depthShadowMap:u,normal:void 0,depth:t,highlight:void 0}};this.getAllTextureIds=;var y=function(a,b,d){h.basicGLMaterialConstructor(this,a);var c=f.TRANSPARENT_MATERIAL,e=b.get("leafCard");h.singleTextureGLMaterialConstructor(this,d,{textureId:a.getTextureId()});this.beginSlot=function(a){return c===a};this.getProgram=function(){return e};var g=a.getAmbient(),n=a.getDiffuse(),l=a.getSpecular(),
m=a.getShininess();this.bind=function(a,b){a.bindProgram(e);this.bindTexture(a,e);e.setUniform3fv("ambient",g);e.setUniform3fv("diffuse",n);e.setUniform3fv("specular",l);e.setUniform1f("shininess",m);e.setUniform1f("trafoScale",1);a.setBlendingEnabled(!1);a.setDepthTestEnabled(!0)};this.release=function(a){};this.bindView=function(a,b){h.bindView(b.origin,b.view,e);h.bindCamPos(b.origin,b.viewInvTransp,e)};this.bindInstance=function(a,b){e.setUniformMatrix4fv("model",b.transformation);e.setUniformMatrix4fv("modelNormal",
b.transformationNormal);a=b.transformation;e.setUniform1f("trafoScale",(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8])+Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])+Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))/3)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},t=function(a,b,d,c){h.basicGLMaterialConstructor(this,a);var e=f.TRANSPARENT_MATERIAL,g=null==c?b.get("leafCardDepth"):b.get("leafCardDepthShadowMap");h.singleTextureGLMaterialConstructor(this,d,{textureId:a.getTextureId()});this.beginSlot=function(a){return e===
a};this.getProgram=function(){return g};this.bind=function(a,b){a.bindProgram(g);this.bindTexture(a,g);g.setUniform2fv("nearFar",b.nearFar)};this.release=function(a){};this.bindView=function(a,b){h.bindView(b.origin,b.view,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation);a=b.transformation;g.setUniform1f("trafoScale",(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8])+Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])+Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))/3)};this.getDrawMode=
function(a){return a.gl.TRIANGLES}},u=function(a,b,d){t.call(this,a,b,d,!0)};m.loadShaders=function(b,c,d,g){b._parse(a);var f=new e(g,b.vertexShaderLeafCard,b.fragmentShaderLeafCard,l.Default3D),k=c.get("fsDepthTextured");c=c.get("fsDepthTexturedShadowMap");k=new e(g,b.vertexShaderLeafCardDepth,k.source,l.Default3D,k.defines);b=new e(g,b.vertexShaderLeafCardDepth,c.source,l.Default3D,c.defines);d.add("leafCard",f);d.add("leafCardDepth",k);d.add("leafCardDepthShadowMap",b)};var r=1234;return m})},
"esri/views/3d/webgl-engine/materials/Material":function(){define("dojo/_base/lang dojo/text!./Material.xml ./internal/MaterialUtil ../../../webgl/Program ../lib/ShaderVariations ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util ../../support/mathUtils".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x){function y(a,b){var d=b.vvSizeEnabled||b.vvRotationEnabled;b.vvSizeEnabled?(a.setUniform3fv("vvSizeMinSize",b.vvSizeMinSize),
a.setUniform3fv("vvSizeMaxSize",b.vvSizeMaxSize),a.setUniform3fv("vvSizeOffset",b.vvSizeOffset),a.setUniform3fv("vvSizeFactor",b.vvSizeFactor)):d&&a.setUniform3fv("vvSizeValue",b.vvSizeValue);d&&(a.setUniform3fv("vvAnchorValue",b.vvAnchorValue),b.vvRotationEnabled?a.setUniform1f("vvRotationValue",x.deg2rad(b.vvRotationValue)):a.setUniformMatrix4fv("vvRotationValue",u(b.vvRotationValue,v)));b.vvColorEnabled&&(a.setUniform1fv("vvColorValues",b.vvColorValues),a.setUniform4fv("vvColorColors",b.vvColorColors))}
function t(a,b){a.vvSizeEnabled=b.vvSizeEnabled;a.vvSizeMinSize=b.vvSizeMinSize;a.vvSizeMaxSize=b.vvSizeMaxSize;a.vvSizeOffset=b.vvSizeOffset;a.vvSizeFactor=b.vvSizeFactor;a.vvSizeValue=b.vvSizeValue;a.vvRotationValue=b.vvRotationValue;a.vvAnchorValue=b.vvAnchorValue}function u(a,b){w.identity(b);w.rotateZ(b,-x.deg2rad(a));return b}var r=e.assert,n=l.vec3,w=l.mat4,d,k=n.create(),v=w.create();e=function(a,d){p.basicMaterialConstructor(this,d);a=a||{};a.ambient=a.ambient||[.2,.2,.2];a.diffuse=a.diffuse||
[.8,.8,.8];a.specular=a.specular||[0,0,0];a.externalColor=a.externalColor||[1,1,1,1];a.externalColorMixMode=a.externalColorMixMode||p.externalColorMixModes.multiply;a.shininess=a.shininess||10;a.opacity=void 0!==a.opacity?a.opacity:1;a.blendModeOneOne=a.blendModeOneOne||!1;a.inverseWindingOrder=a.inverseWindingOrder||!1;a.vertexColors=a.vertexColors||!1;a.flipV=a.flipV||!1;a.doubleSided=a.doubleSided||!1;a.cullFace=a.cullFace||void 0;a.instanced=a.instanced||!1;this.instanced=!!a.instanced;a.writeStencil=
a.writeStencil||!1;a.textureId||(a.reflTextureId=void 0);a.receiveSSAO=void 0!==a.receiveSSAO?a.receiveSSAO:!0;a.vvSizeEnabled=a.vvSizeEnabled||!1;a.vvSizeMinSize=a.vvSizeMinSize||[1,1,1];a.vvSizeMaxSize=a.vvSizeMaxSize||[100,100,100];a.vvSizeOffset=a.vvSizeOffset||[0,0,0];a.vvSizeFactor=a.vvSizeFactor||[1,1,1];a.vvSizeValue=a.vvSizeValue||[1,1,1];a.vvAnchorValue=a.vvAnchorValue||[0,0,0];a.vvRotationEnabled=a.vvRotationEnabled||!1;a.vvRotationValue=a.vvRotationValue||0;a.vvColorEnabled=a.vvColorEnabled||
!1;a.vvColorValues=a.vvColorValues||[0,0,0,0,0,0,0,0];a.vvColorColors=a.vvColorColors||[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0];d=a.textureId?a.atlasRegions?"Pos3NormTexRegion":"Pos3NormTex":"Pos3Norm";a.vertexColors&&(d+="Col");var c=b[d],e=null;a.instanced&&(e=[],q.addDescriptor(e,"model",16,5126,!1,1),q.addDescriptor(e,"modelNormal",16,5126,!1,1),-1<a.instanced.indexOf("color")&&q.addDescriptor(e,"instanceColor",4,5126,!1,1),-1<a.instanced.indexOf("featureAttribute")&&
q.addDescriptor(e,"instanceFeatureAttribute",4,5126,!1,1));var g=this.isVisible.bind(this);this.isVisible=function(){return g()&&0<a.opacity};this.dispose=function(){};this.getParams=function(){return a};this.getParameterValues=function(){var b={ambient:a.ambient,diffuse:a.diffuse,specular:a.specular,externalColor:a.externalColor,externalColorMixMode:a.externalColorMixMode,shininess:a.shininess,opacity:a.opacity,transparent:a.transparent,polygonOffset:a.polygonOffset,reflectivity:a.reflectivity,atlasRegions:a.atlasRegions,
flipV:a.flipV,doubleSided:a.doubleSided,cullFace:a.cullFace,writeStencil:a.writeStencil,receiveSSAO:a.receiveSSAO,vvSizeEnabled:a.vvSizeEnabled,vvSizeMinSize:a.vvSizeMinSize,vvSizeMaxSize:a.vvSizeMaxSize,vvSizeOffset:a.vvSizeOffset,vvSizeFactor:a.vvSizeFactor,vvSizeValue:a.vvSizeValue,vvRotationEnabled:a.vvRotationEnabled,vvRotationValue:a.vvRotationValue,vvAnchorValue:a.vvAnchorValue,vvColorEnabled:a.vvColorEnabled,vvColorValues:a.vvColorValues,vvColorColors:a.vvColorColors};a.textureId&&(b.textureId=
a.textureId,b.initTexture=a.initTexture);return b};this.setParameterValues=function(b){for(var d in b)"textureId"===d&&r(a.textureId,"Can only change texture of material that already has a texture"),a[d]=b[d];this.notifyDirty("matChanged")};this.getOutputAmount=function(a){var b=q.getStride(c)/4;return a*b};this.getVertexBufferLayout=function(){return c};this.getInstanceBufferLayout=function(){return e};this.fillInterleaved=function(a,b,d,e,g,f,k){p.fillInterleaved(a,b,d,e,c,g,f,k)};this.intersect=
p.intersectTriangleGeometry;this.getGLMaterials=this.getAllTextureIds=function(){var b=[];a.textureId&&b.push(a.textureId);a.reflTextureId&&b.push(a.reflTextureId);return b}};e.paramsFromOldConstructor=function(a,b,d,c,e,g,f,k,n,l,m,h,q){return{textureId:a,transparent:b,ambient:d,diffuse:c,specular:e,shininess:g,opacity:f,polygonOffset:k,initTexture:n,reflTextureId:l,reflectivity:m,flipV:h,doubleSided:q,cullFace:void 0}};var A=
function(a,b){var d=a.gl;(b.cullFace?"none"===b.cullFace:b.transparent)?a.setFaceCullingEnabled(!1):(a.setFaceCullingEnabled(!0),"front"===b.cullFace&&a.setCullFace(d.FRONT))},z=function(a,b){var d=a.gl;(b.cullFace?"none"===b.cullFace:b.transparent)?a.setFaceCullingEnabled(!0):(a.setFaceCullingEnabled(!1),"front"===b.cullFace&&a.setCullFace(d.BACK))},D=B=function(b,c,e){p.basicGLMaterialConstructor(this,b);var g=
a.clone(b.getParams()),f=D(g.transparent,g.writeStencil);p.singleTextureGLMaterialConstructor(this,e,g);var l=p.aquireIfNotUndefined(g.reflTextureId,g.reflInitTexture,e);l&&(l=l.getGLTexture());r(!(g.atlasRegions&&g.reflTextureId),"Atlas texture with reflection is not yet supported");var m=g.textureId?g.atlasRegions?"AtlasTextured":"Textured":"none";this.instanced=d&&g.instanced;var h=!!this.instanced&&-1<this.instanced.indexOf("color");this._loadProgram=function(a,b){return c.shaderVariators.Material.getProgram([m,
!!g.reflTextureId,g.vertexColors,g.flipV,g.doubleSided,!!this.instanced,h,a,b,!!g.vvSizeEnabled,!!g.vvColorEnabled,!!g.vvRotationEnabled])};var q=this._loadProgram(!1,g.receiveSSAO),w=this._loadProgram(!0,g.receiveSSAO),u=null,v="AtlasTextured"===m,x=this.dispose;this.dispose=this.beginSlot=function(a){return f===a};this.getProgram=this.getAllPrograms=function(){return[w,q]};this.updateParameters=function(){var a=b.getParams();
g.ambient=a.ambient;g.diffuse=a.diffuse;g.specular=a.specular;g.externalColor=a.externalColor;g.externalColorMixMode=a.externalColorMixMode;g.shininess=a.shininess;g.opacity=a.opacity;g.polygonOffset=a.polygonOffset;g.reflectivity=a.reflectivity;g.flipV=a.flipV;g.doubleSided=a.doubleSided;g.cullFace=a.cullFace;g.receiveSSAO=a.receiveSSAO;t(g,a);g.vvColorEnabled=a.vvColorEnabled;g.vvColorValues=a.vvColorValues;g.vvColorColors=a.vvColorColors;g.transparent!=a.transparent&&(f=D(a.transparent),g.transparent=
a.transparent);g.initTexture=a.initTexture;this.updateTexture(a.textureId);a.atlasRegions&&(g.atlasRegions=a.atlasRegions);g.blendModeOneOne=a.blendModeOneOne;g.inverseWindingOrder=a.inverseWindingOrder;q=this._loadProgram(!1,g.receiveSSAO);w=this._loadProgram(!0,g.receiveSSAO)};this.bind=function(a,b){var d=a.gl;u=b.shadowMap&&b.shadowMap.getEnableState()?w:q;a.bindProgram(u);u.setUniform3fv("ambient",g.ambient);u.setUniform3fv("diffuse",g.diffuse);u.setUniform3fv("specular",g.specular);u.setUniform4fv("externalColor",
g.externalColor);u.setUniform1i("externalColorMixMode",g.externalColorMixMode);u.setUniform1f("shininess",g.shininess);u.setUniform1f("opacity",g.opacity);b.shadowMap||u.setUniform1f("depthHalfPixelSz",-1);y(u,g);this.bindTexture(a,u);v&&this.bindTextureSize(a,u);a.setBlendFunctionSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA);void 0!==l&&(u.setUniform1i("reflTex",1),a.bindTexture(l,1),u.setUniform1f("reflectivity",g.reflectivity));g.inverseWindingOrder&&a.setFrontFace(d.CW);
g.transparent?(a.setBlendingEnabled(!0),g.blendModeOneOne?(a.setBlendFunction(d.ONE,d.ONE),a.setDepthWriteEnabled(!1)):a.setBlendFunctionSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA)):a.setBlendingEnabled(!1);g.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(2,2));A(a,g);a.setDepthTestEnabled(!0)};this.release=function(a,b){b=a.gl;a.setPolygonOffsetFillEnabled(!1);z(a,g);a.setBlendingEnabled(!1);a.setBlendFunctionSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,
b.ONE,b.ONE_MINUS_SRC_ALPHA);a.setDepthWriteEnabled(!0);a.setFrontFace(b.CCW)};this.bindView=function(a,b){u=b.shadowMap&&b.shadowMap.getEnableState()?w:q;a=b.origin;p.bindView(a,b.view,u);p.bindCamPos(a,b.viewInvTransp,u);b.shadowMap&&b.shadowMap.bindView(u,a)};this.bindInstance=function(a,b){u.setUniformMatrix4fv("model",b.transformation);u.setUniformMatrix4fv("modelNormal",b.transformationNormal);h&&b.instanceParameters&&(a=b.instanceParameters.color)&&(n.multiply(g.ambient,a,k),u.setUniform3fv("ambient",
k),n.multiply(g.diffuse,a,k),u.setUniform3fv("diffuse",k),u.setUniform1f("opacity",g.opacity*a[3]))};this.getDrawMode=function(a){return a.gl.TRIANGLES}},C=function(b,c,e,g){p.basicGLMaterialConstructor(this,b);var f=a.clone(b.getParams());this.instanced=d&&f.instanced;var k=q.hasAttribute(b.getVertexBufferLayout(),"uv0")?"Textured":"none",n=c.shaderVariators.MaterialDepth.getProgram([k,f.flipV,!!this.instanced,!!g,!!f.vvSizeEnabled,!!f.vvRotationEnabled]),l=D(f.transparent,f.writeStencil);p.singleTextureGLMaterialConstructor(this,
e,f);this.beginSlot=function(a){return l===a};this.getProgram=function(){return n};this.updateParameters=function(){var a=b.getParams();f.initTexture=a.initTexture;f.cullFace=a.cullFace;f.inverseWindingOrder=a.inverseWindingOrder;f.flipV=a.flipV;t(f,a);this.updateTexture(a.textureId)};this.bind=function(a,b){var d=a.gl;a.bindProgram(n);n.setUniform2fv("nearFar",b.nearFar);f.inverseWindingOrder&&a.setFrontFace(d.CW);y(n,f);this.bindTexture(a,n);A(a,f);a.setDepthTestEnabled(!0)};this.release=function(a){var b=
a.gl;z(a,f);f.inverseWindingOrder&&a.setFrontFace(b.CCW)};this.bindView=function(a,b){p.bindView(b.origin,b.view,n)};this.bindInstance=function(a,b){n.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},F=K=function(b,c,e){p.basicGLMaterialConstructor(this,b);var g=a.clone(b.getParams()),f=q.hasAttribute(b.getVertexBufferLayout(),"uv0")?"Textured":"none";this.instanced=d&&g.instanced;var k=c.shaderVariators.MaterialNormal.getProgram([f,
g.flipV,!!this.instanced,!!g.vvSizeEnabled,!!g.vvRotationEnabled]),n=D(g.transparent,g.writeStencil);p.singleTextureGLMaterialConstructor(this,e,g);this.beginSlot=function(a){return n===a};this.getProgram=function(){return k};this.updateParameters=function(){var a=b.getParams();g.initTexture=a.initTexture;g.cullFace=a.cullFace;g.inverseWindingOrder=a.inverseWindingOrder;g.flipV=a.flipV;t(g,a);this.updateTexture(a.textureId)};this.bind=function(a,b){var d=a.gl;a.bindProgram(k);this.bindTexture(a,k);
k.setUniformMatrix4fv("viewNormal",b.viewInvTransp);y(k,g);A(a,g);g.inverseWindingOrder&&a.setFrontFace(d.CW);a.setDepthTestEnabled(!0)};this.release=function(a){var b=a.gl;z(a,g);g.inverseWindingOrder&&a.setFrontFace(b.CCW)};this.bindView=function(a,b){p.bindView(b.origin,b.view,k)};this.bindInstance=function(a,b){k.setUniformMatrix4fv("model",b.transformation);k.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},M=function(b,c,e,f){p.basicGLMaterialConstructor(this,
b);var k=a.clone(b.getParams());f=q.hasAttribute(b.getVertexBufferLayout(),"uv0")?"Textured":"none";this.instanced=d&&k.instanced;var n=c.shaderVariators.MaterialHighlight.getProgram([f,k.flipV,!!this.instanced,!!k.vvSizeEnabled,!!k.vvRotationEnabled]),l=g.OPAQUE_MATERIAL;p.singleTextureGLMaterialConstructor(this,e,k);this.beginSlot=function(a){return l===a};this.getProgram=function(){return n};this.updateParameters=function(){var a=b.getParams();k.initTexture=a.initTexture;k.cullFace=a.cullFace;
k.inverseWindingOrder=a.inverseWindingOrder;k.flipV=a.flipV;t(k,a);this.updateTexture(a.textureId)};this.bind=function(a,b){b=a.gl;a.bindProgram(n);this.bindTexture(a,n);y(n,k);A(a,k);k.inverseWindingOrder&&a.setFrontFace(b.CW);a.setDepthTestEnabled(!0)};this.release=function(a){var b=a.gl;z(a,k);k.inverseWindingOrder&&a.setFrontFace(b.CW)};this.bindView=function(a,b){p.bindView(b.origin,b.view,n)};this.bindInstance=this.getDrawMode=function(a){return a.gl.TRIANGLES}};e.loadShaders=function(a,b,e,g){a._parse(h);d=g.extensions.angleInstancedArrays;g.extensions.shaderTextureLOD;g.extensions.standardDerivatives;var k=new f("phong",["vsPhong","fsPhong"],null,e,b,a,g);k.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);k.addBinaryShaderSnippetSuffix("Refl","Refl",[!1,!0]);k.addDefine("Color","VERTEXCOLORS");
k.addDefine("FlipV","FLIPV");k.addDefine("DoubleSided","DOUBLESIDED");k.addDefine("Instanced","INSTANCED");k.addDefine("InstColor","INSTANCEDCOLOR");k.addDefine("ReceiveShadows","RECEIVE_SHADOWS");k.addDefine("ReceiveSSAO","RECEIVE_SSAO");k.addDefine("vvSize","VV_SIZE");k.addDefine("vvColor","VV_COLOR");k.addDefine("vvRotation","VV_ROTATION");e.shaderVariators.Material=k;k=new f("depth",["vsDepth","fsDepth"],null,e,b,a,g);k.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},
{value:"Textured"},{value:"AtlasTextured"}]);k.addDefine("FlipV","FLIPV");k.addDefine("Instanced","INSTANCED");k.addDefine("ShadowMap","BIAS_SHADOWMAP");k.addDefine("vvSize","VV_SIZE");k.addDefine("vvRotation","VV_ROTATION");e.shaderVariators.MaterialDepth=k;k=new f("normal",["vsNormal","fsNormal"],null,e,b,a,g);k.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);k.addDefine("FlipV","FLIPV");k.addDefine("Instanced",
"INSTANCED");k.addDefine("vvSize","VV_SIZE");k.addDefine("vvRotation","VV_ROTATION");e.shaderVariators.MaterialNormal=k;k=new f("highlight",["vsNormal","fsNormal"],null,e,b,a,g);k.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);k.addDefine("FlipV","FLIPV");k.addDefine("Instanced","INSTANCED");k.addDefine("vvSize","VV_SIZE");k.addDefine("vvRotation","VV_ROTATION");e.shaderVariators.MaterialHighlight=k;var k=new m(g,
a.vsDepth,a.fsDepth,c.Default3D,["BIAS_SHADOWMAP 1"]),n=new m(g,a.vsDepthTextured,a.fsDepthTextured,c.Default3D,["BIAS_SHADOWMAP 1"]),l=new m(g,a.vsDepth,a.fsDepth,c.Default3D),q=new m(g,a.vsDepthTextured,a.fsDepthTextured,c.Default3D),r=new m(g,a.vsNormal,a.fsNormal,c.Default3D),t=new m(g,a.vsNormalTextured,a.fsNormalTextured,c.Default3D),w=new m(g,a.vsHighlight,a.fsHighlight,c.Default3D);g=new m(g,a.vsHighlightTextured,a.fsHighlightTextured,c.Default3D);e.add("depthShadowMap",k);e.add("depthTexturedShadowMap",
n);e.add("depth",l);e.add("depthTextured",q);e.add("normal",r);e.add("normalTextured",t);e.add("highlight",w);e.add("highlightTextured",g);b.add("fsDepth",{source:a.fsDepth});b.add("fsDepthTextured",{source:a.fsDepthTextured});b.add("fsDepthShadowMap",{source:a.fsDepthShadowMap,defines:["BIAS_SHADOWMAP 1"]});b.add("fsDepthTexturedShadowMap",{source:a.fsDepthTextured,defines:["BIAS_SHADOWMAP 1"]});b.add("vsDepth",{source:a.vsDepth});b.add("fsNormal",{source:a.fsNormal})};return e})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("dojo/_base/lang dojo/text!./RibbonLineMaterial.xml ./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(a,h,p,m,f,e,l,g,c,b){var q=[255,255,255,255],x=[0,0,0,0],y=f.vec3d,t=f.vec2d,u=f.mat4d,r=y.create(),n=y.create(),w=y.create(),d=y.create(),k=t.create(),v=t.create(),A=y.create(),z=y.create();f=function(a,e){p.basicMaterialConstructor(this,e);var g=m.VertexAttrConstants;a=a||{};a.color=a.color||[1,1,1,1];a.width=a.width||0;a.type=a.type||"screen";a.join=a.join||"miter";a.miterLimit="miter"===a.join?a.miterLimit||5:a.miterLimit;var f="wall"===a.type?2:4,l=c.Pos3Tex;"wall"!==a.type&&(l=[{name:"position",
count:3,type:5126,offset:0,stride:64,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:64,normalized:!1},{name:"auxpos1",count:3,type:5126,offset:20,stride:64,normalized:!1},{name:"auxpos2",count:3,type:5126,offset:32,stride:64,normalized:!1},{name:"color",count:4,type:5126,offset:44,stride:64,normalized:!1},{name:"size",count:1,type:5126,offset:60,stride:64,normalized:!1}]);this.canBeMerged=!1;this.getParams=function(){return a};this.getParameterValues=function(){var b={color:a.color,
width:a.width,type:a.type,join:a.join,polygonOffset:a.polygonOffset};"miter"===a.join&&(b.miterLimit=a.miterLimit);return b};this.setParameterValues=function(b){for(var d in b)b.hasOwnProperty(d)&&(m.assert("type"!==d,"RibbonLineMaterial: type cannot be changed after creation"),a[d]=b[d]);this.notifyDirty("matChanged")};this.dispose=function(){};this.getOutputAmount=function(a){return((a/2+1-2)*f+4)*b.getStride(l)/4};this.getVertexBufferLayout=function(){return l};this.fillInterleaved=function(b,
d,c,e,f,k){c=b.vertexAttr[g.POSITION].data;e=b.vertexAttr[g.COLOR]?b.vertexAttr[g.COLOR].data:q;var n=b.vertexAttr[g.SIZE]?b.vertexAttr[g.SIZE].data:x;(b=b.faces&&b.faces.indices&&b.faces.indices.position)&&b.length!=2*(c.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");if("wall"===a.type){e=k;n=c.length/3;k=0;b=c[0];for(var l=c[1],m=c[2],h,r,t,w=0;w<n;w++){var p=3*w;h=b;r=l;t=m;b=c[p];l=c[p+1];m=c[p+2];d&&(b=d[0]*b+d[4]*l+d[8]*m+d[12],l=d[1]*b+d[5]*l+d[9]*m+d[13],m=d[2]*b+
d[6]*l+d[10]*m+d[14]);k+=Math.sqrt((b-h)*(b-h)+(l-r)*(l-r)+(m-t)*(m-t));f[e++]=b;f[e++]=l;f[e++]=m;f[e++]=k;f[e++]=-1;f[e++]=b;f[e++]=l;f[e++]=m;f[e++]=k;f[e++]=1}}else{b=c.length/3;l=c[0];m=c[1];h=c[2];r=0;d&&(l=d[0]*l+d[4]*m+d[8]*h+d[12],m=d[1]*l+d[5]*m+d[9]*h+d[13],h=d[2]*l+d[6]*m+d[10]*h+d[14]);t=l;var w=m,p=h,u=c[3],v=c[4],A=c[5];d&&(u=d[0]*u+d[4]*v+d[8]*A+d[12],v=d[1]*u+d[5]*v+d[9]*A+d[13],A=d[2]*u+d[6]*v+d[10]*A+d[14]);for(var y=0;y<b;y++){var z=3*y;y<b-1&&(u=c[z+3],v=c[z+4],A=c[z+5],d&&(u=
d[0]*u+d[4]*v+d[8]*A+d[12],v=d[1]*u+d[5]*v+d[9]*A+d[13],A=d[2]*u+d[6]*v+d[10]*A+d[14]));r+=Math.sqrt((t-l)*(t-l)+(w-m)*(w-m)+(p-h)*(p-h));f[k++]=t;f[k++]=w;f[k++]=p;f[k++]=r;f[k++]=0===y?-1.2:-1;f[k++]=l;f[k++]=m;f[k++]=h;f[k++]=u;f[k++]=v;f[k++]=A;f[k++]=e[0];f[k++]=e[1];f[k++]=e[2];f[k++]=e[3];f[k++]=n[0];f[k++]=t;f[k++]=w;f[k++]=p;f[k++]=r;f[k++]=0===y?1.2:1;f[k++]=l;f[k++]=m;f[k++]=h;f[k++]=u;f[k++]=v;f[k++]=A;f[k++]=e[0];f[k++]=e[1];f[k++]=e[2];f[k++]=e[3];f[k++]=n[0];0<y&&y<b-1&&(f[k++]=t,f[k++]=
w,f[k++]=p,f[k++]=r,f[k++]=-1.2,f[k++]=l,f[k++]=m,f[k++]=h,f[k++]=u,f[k++]=v,f[k++]=A,f[k++]=e[0],f[k++]=e[1],f[k++]=e[2],f[k++]=e[3],f[k++]=n[0],f[k++]=t,f[k++]=w,f[k++]=p,f[k++]=r,f[k++]=1.2,f[k++]=l,f[k++]=m,f[k++]=h,f[k++]=u,f[k++]=v,f[k++]=A,f[k++]=e[0],f[k++]=e[1],f[k++]=e[2],f[k++]=e[3],f[k++]=n[0]);l=t;m=w;h=p;t=u;w=v;p=A}}};this.intersect=function(b,c,e,f,l,h,q){if(f.isSelection){c=b.getData().getVertexAttr(g.position).position.data;b=b.getData().getVertexAttr(g.SIZE).size;b=(b&&b.data[0])+
a.width;l=Number.MAX_VALUE;var t,p;h=f.camera;for(var x=f.point,D=0;D<c.length-5;D+=3){r[0]=c[D];r[1]=c[D+1];r[2]=c[D+2];u.multiplyVec3(e,r);n[0]=c[D+3];n[1]=c[D+4];n[2]=c[D+5];u.multiplyVec3(e,n);h.projectPoint(r,k);h.projectPoint(n,v);if(0>k[2]&&0<v[2])y.subtract(r,n,w),t=h.frustumPlanes,p=-(y.dot(t[4],r)+t[4][3]),t=p/y.dot(w,t[4]),y.scale(w,t,w),y.add(r,w,r),h.projectPoint(r,k);else if(0<k[2]&&0>v[2])y.subtract(n,r,w),t=h.frustumPlanes,p=-(y.dot(t[4],n)+t[4][3]),t=p/y.dot(w,t[4]),y.scale(w,t,w),
y.add(n,w,n),h.projectPoint(n,v);else if(0>k[2]&&0>v[2])continue;t=m.projectVectorVector2D(k,v,x);t<l&&(l=t,y.set(r,A),y.set(n,z))}e=f.p0;f=f.p1;l<b/2+4&&(c=m.linelineDistance3D(A,z,e,f),b=Number.MAX_VALUE,c[0]&&(y.subtract(c[2],e,d),b=y.length(d)/y.dist(e,f)),q(b,d))}};this.getGLMaterials=function(){return{color:D,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=;var D=function(b,d){p.basicGLMaterialConstructor(this,b);var c=a.clone(b.getParams());
c.miterLimit="miter"===c.join?c.miterLimit:0;delete c.join;var g=d.get("ribbonLine_"+c.type);this.updateParameters=function(){var a=b.getParams();c.polygonOffset=a.polygonOffset;c.color=a.color;c.width=a.width;c.miterLimit="miter"===a.join?a.miterLimit:0};this.beginSlot=this.getProgram=function(){return g};this.bind=function(a,b){a.bindProgram(g);g.setUniform4fv("eColor",c.color);g.setUniform1f("miterLimit",c.miterLimit);g.setUniform1f("nearPlane",b.nearFar[0]);
"screen"===c.type?(g.setUniform2fv("screenSize",[b.viewport[2],b.viewport[3]]),g.setUniform1f("extLineWidth",c.width*b.pixelRatio)):g.setUniform1f("extLineWidth",c.width);c.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setFaceCullingEnabled(!1);a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0);a.setDepthWriteEnabled(1<=c.color[3])};this.release=function(a){c.polygonOffset&&
a.setPolygonOffsetFillEnabled(!1);a.setBlendingEnabled(!1);a.setDepthWriteEnabled(!0)};this.bindView=this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLE_STRIP}};f.loadShaders=function(a,b,d,c){a._parse(h);b=new l(c,a.vsRibbonLine,a.fsRibbonLine,g.Default3D,["SCREENSCALE"]);var e=new l(c,a.vsRibbonLine,a.fsRibbonLine,g.Default3D);a=new l(c,a.vsRibbonLine,a.fsRibbonLine,g.Default3D,
["WALL"]);d.add("ribbonLine_screen",b);d.add("ribbonLine_strip",e);d.add("ribbonLine_wall",a)};return f})},"esri/views/3d/webgl-engine/materials/WaterMaterial":function(){define("dojo/text!./WaterMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(a,h,p,m,f,e,l){var g=function(a,g,f,m,t,p){h.basicMaterialConstructor(this,p);var b=e.Pos3;this.dispose=function(){};
this.getNoiseTextureId=function(){return a};this.getReflTextureId=function(){return g};this.getColor=function(){return f};this.getScale=function(){return m};this.getSpeed=function(){return t};this.getOutputAmount=function(a){return a*l.getStride(b)/4};this.getVertexBufferLayout=function(){return b};this.fillInterleaved=function(a,c,d,e,g,f,l){h.fillInterleaved(a,c,d,e,b,g,f,l)};this.intersect=h.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:c,depthShadowMap:void 0,normal:void 0,
depth:void 0,highlight:void 0}};this.getAllTextureIds=,c=function(a,c,e){h.basicGLMaterialConstructor(this,a);var b=p.TRANSPARENT_MATERIAL,g=c.get("water");c={noiseTextureId:a.getNoiseTextureId(),reflTextureId:a.getReflTextureId()};h.multiTextureGLMaterialConstructor(this,e,c,[["noiseTextureId",void 0,"noiseTex"],["reflTextureId",void 0,"reflTex"]]);var f=a.getColor(),l=a.getScale(),n=a.getSpeed(),m=Date.now();this.beginSlot=function(a){return b===a};this.getProgram=function(){return g};
this.bind=function(a,b){a.bindProgram(g);this.bindTextures(a,g);g.setUniform3fv("color",f);g.setUniform1f("scale",l);a=(Date.now()-m)/1E5*n;a-=Math.floor(a);g.setUniform1f("speed",a);b.shadowMap||g.setUniform1f("depthHalfPixelSz",-1)};this.release=this.bindView=function(a,b){a=b.origin;h.bindView(a,b.view,g);h.bindCamPos(a,b.viewInvTransp,g);b.shadowMap&&b.shadowMap.bindView(g,a)};this.bindInstance=this.getDrawMode=;
g.loadShaders=function(b,c,e,g){b._parse(a);b=new m(g,b.vertexShaderWater,b.fragmentShaderWater,f.Default3D);e.add("water",b)};return g})},"esri/views/3d/webgl-engine/materials/internal/BlendLayers":function(){define(["dojo/text!./BlendLayers.xml","../../../../webgl/Program","../../lib/DefaultVertexAttributeLocations"],function(a,h,p){return{loadShaders:function(m,f,e,l){m._parse(a);m=new h(l,m.vertexShaderBlendLayers,m.fragmentShaderBlendLayers,p.Default3D);e.add("blendLayers",m)}}})},"esri/views/3d/webgl-engine/lib/tracer":function(){define(["require",
"exports","./webgl-debug"],function(a,h,p){var m=null,f=[];h.enabled=!1;h.begin=function(){h.enabled&&(m=[])};h.trace=function(a){h.enabled&&null!=m&&m.push(a)};h.end=function(){if(h.enabled){var a=m;m=null;a&&(f.forEach(,f.length=0);return a}};h.instrumentContext=function(a){return h.enabled?p.makeDebugContext(a,void 0,function(a,e){h.enabled&&m&&m.push("gl."+a+"("+p.glFunctionArgsToString(a,e)+")")}):a};h.request=function(a){f.push(a)}})},"esri/views/3d/webgl-engine/lib/webgl-debug":function(){define([],
function(){function a(a){if(null==c){c={};b={};for(var e in a)"number"==typeof a[e]&&(c[a[e]]=e,b[e]=a[e])}}function h(){if(null==c)throw"WebGLDebugUtils.init(ctx) not called";}function p(a){h();var b=c[a];return void 0!==b?"gl."+b:"/*UNKNOWN WebGL ENUM*/ 0x"+a.toString(16)+""}function m(a,c,e,f){a=g[a];if(void 0!==a&&(a=a[c],void 0!==a&&a[e])){if("object"===typeof a[e]&&void 0!==a[e].enumBitwiseOr){c=a[e].enumBitwiseOr;e=0;a=[];for(var l=0;l<c.length;++l){var m=b[c[l]];0!==(f&m)&&(e|=m,a.push(p(m)))}return e===
f?a.join(" | "):p(f)}return p(f)}return null===f?"null":void 0===f?"undefined":f.toString()}function f(a,b,c){a.__defineGetter__(c,;a.__defineSetter__(c,function(a){b[c]=a})}function e(b,c,g,l){function h(a,b){return function(){g&&g(b,arguments);var d=a[b].apply(a,arguments),e=l.getError();0!=e&&(q[e]=!0,c(e,b,arguments));return d}}l=l||b;a(b);c=c||function(a,b,d){for(var c="",e=d.length,g=0;g<e;++g)c+=(0==g?"":", ")+m(b,e,g,d[g]);a="WebGL error "+p(a)+" in "+b+"("+c+")";window.console&&
window.console.error?window.console.error(a):window.console&&window.console.log&&window.console.log(a)};var q={},n={},t;for(t in b)if("function"==typeof b[t])if("getExtension"!=t)n[t]=h(b,t);else{var d=h(b,t);n[t]=function(){var a=d.apply(b,arguments);return e(a,c,g,l)}}else f(n,b,t);n.getError=function(){for(var a in q)if(q.hasOwnProperty(a)&&q[a])return q[a]=!1,a;return b.NO_ERROR};return n}function l(a){var b=a.getParameter(a.MAX_VERTEX_ATTRIBS),c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c);
for(var e=0;e<b;++e)a.disableVertexAttribArray(e),a.vertexAttribPointer(e,4,a.FLOAT,!1,0,0),a.vertexAttrib1f(e,0);a.deleteBuffer(c);b=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);for(e=0;e<b;++e)a.activeTexture(a.TEXTURE0+e),a.bindTexture(a.TEXTURE_CUBE_MAP,null),a.bindTexture(a.TEXTURE_2D,null);a.activeTexture(a.TEXTURE0);a.useProgram(null);a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.disable(a.BLEND);
a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.DITHER);a.disable(a.SCISSOR_TEST);a.blendColor(0,0,0,0);a.blendEquation(a.FUNC_ADD);a.blendFunc(a.ONE,a.ZERO);a.clearColor(0,0,0,0);a.clearDepth(1);a.clearStencil(-1);a.colorMask(!0,!0,!0,!0);a.cullFace(a.BACK);a.depthFunc(a.LESS);a.depthMask(!0);a.depthRange(0,1);a.frontFace(a.CCW);a.hint(a.GENERATE_MIPMAP_HINT,a.DONT_CARE);a.lineWidth(1);a.pixelStorei(a.PACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,
!1);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);a.UNPACK_COLORSPACE_CONVERSION_WEBGL&&a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.BROWSER_DEFAULT_WEBGL);a.polygonOffset(0,0);a.sampleCoverage(1,!1);a.scissor(0,0,a.canvas.width,a.canvas.height);a.stencilFunc(a.ALWAYS,0,4294967295);a.stencilMask(4294967295);a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.viewport(0,0,a.canvas.width,a.canvas.height);for(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT|a.STENCIL_BUFFER_BIT);a.getError(););}var g={enable:{1:{0:!0}},
disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,
6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,
1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,
2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},c=null,b=null;return{init:a,mightBeEnum:function(a){h();return void 0!==c[a]},glEnumToString:p,glFunctionArgToString:m,glFunctionArgsToString:function(a,b){for(var c="",e=b.length,g=0;g<e;++g)c+=(0==g?"":", ")+m(a,e,g,b[g]);return c},makeDebugContext:e,makeLostContextSimulatingCanvas:function(a){function b(a){return"function"==
typeof a?a:function c(){for(var a=Object.keys(M),b=0;b<a.length;++b)delete M[a]}function e(){++C;z||B==C&&a.loseContext()}function g(a,b){var d=a[b];return function(){e();if(!z)return d.apply(a,arguments)}}function m(a){return{statusMessage:a,preventDefault:}function n(a){for(var b in a)"function"==typeof a[b]?d[b]=g(a,b):f(d,a,b);d.getError=function(){e();if(!z)for(var a;a=h.getError();)M[a]=!0;for(a in M)if(M[a])return delete M[a],a;return d.NO_ERROR};
var c="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(b=0;b<c.length;++b){var k=c[b];d[k]=function(b){return function(){e();if(z)return null;var d=b.apply(a,arguments);d.__webglDebugContextLostId__=p;D.push(d);return d}}(a[k])}c="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(b=0;b<c.length;++b)k=c[b],d[k]=function(b){return function(){e();return z?null:b.apply(a,arguments)}}(d[k]);c="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(b=0;b<c.length;++b)k=c[b],d[k]=function(b){return function(){e();return z?!1:b.apply(a,arguments)}}(d[k]);d.checkFramebufferStatus=function(b){return function(){e();return z?d.FRAMEBUFFER_UNSUPPORTED:b.apply(a,arguments)}}(d.checkFramebufferStatus);d.getAttribLocation=function(b){return function(){e();
return z?-1:b.apply(a,arguments)}}(d.getAttribLocation);d.getVertexAttribOffset=function(b){return function(){e();return z?0:b.apply(a,arguments)}}(d.getVertexAttribOffset);d.isContextLost=function(){return z};return d}var h,d,k=[],q=[];d={};var p=1,z=!1,D=[],B=0,C=0,F=!1,K=0,M={};a.getContext=function(b){return function(){var c=b.apply(a,arguments);if(c instanceof WebGLRenderingContext){if(c!=h){if(h)throw"got different context";h=c;d=n(h)}return d}return c}}(a.getContext);(function(a){var d=a.addEventListener;
a.addEventListener=function(c,e,g){switch(c){case "webglcontextlost":k.push(b(e));break;case "webglcontextrestored":q.push(b(e));break;default:d.apply(a,arguments)}}})(a);a.loseContext=function(){if(!z){z=!0;B=0;for(++p;h.getError(););c();M[h.CONTEXT_LOST_WEBGL]=!0;var b=m("context lost"),d=k.slice();setTimeout(function(){for(var c=0;c<d.length;++c)d[c](b);0<=K&&setTimeout(function(){a.restoreContext()},K)},0)}};a.restoreContext=function(){z&&q.length&&setTimeout(function(){if(!F)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var a=0;a<D.length;++a){var b=D[a];b instanceof WebGLBuffer?h.deleteBuffer(b):b instanceof WebGLFramebuffer?h.deleteFramebuffer(b):b instanceof WebGLProgram?h.deleteProgram(b):b instanceof WebGLRenderbuffer?h.deleteRenderbuffer(b):b instanceof WebGLShader?h.deleteShader(b):b instanceof WebGLTexture&&h.deleteTexture(b)}l(h);z=!1;C=0;F=!1;for(var a=q.slice(),b=m("context restored"),d=0;d<a.length;++d)a[d](b)},0)};a.loseContextInNCalls=function(a){if(z)throw"You can not ask a lost contet to be lost";
B=C+a};a.getNumCalls=function(){return C};a.setRestoreTimeout=function(a){K=a};return a},resetToInitialState:l}})},"esri/views/webgl/RenderingContext":function(){define(["require","exports","./enums","./Extensions"],function(a,h,p,m){a=function(){function a(a,f){this.gl=null;this._extensions=void 0;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState=
{r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=
1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this.gl=a;this._extensions=new m(a,f);f=a.getParameter(a.VIEWPORT);this._viewport={x:f[0],y:f[1],width:f[2],height:f[3]};f=this.extensions.textureFilterAnisotropic;this._parameters={versionString:a.getParameter(a.VERSION),maxVertexTextureImageUnits:a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
maxVertexAttributes:a.getParameter(a.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:f?a.getParameter(f.MAX_TEXTURE_MAX_ANISOTROPY_EXT):void 0,maxTextureImageUnits:a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)};this.enforceState()}Object.defineProperty(a.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0});a.prototype.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a)};a.prototype.setBlendColor=a.prototype.setBlendFunction=a.prototype.setBlendFunctionSeparate=function(a,f,g,c){if(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==g||this._blendFunctionState.dstRGB!==f||this._blendFunctionState.dstAlpha!==
c)this.gl.blendFuncSeparate(a,f,g,c),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=g,this._blendFunctionState.dstRGB=f,this._blendFunctionState.dstAlpha=c};a.prototype.setBlendEquation=a.prototype.setBlendEquationSeparate=function(a,f){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==f)this.gl.blendEquationSeparate(a,
f),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=f};a.prototype.setColorMask=function(a,f,g,c){if(this._colorMaskState.r!==a||this._colorMaskState.g!==f||this._colorMaskState.b!==g||this._colorMaskState.a!==c)this.gl.colorMask(a,f,g,c),this._colorMaskState.r=a,this._colorMaskState.g=f,this._colorMaskState.b=g,this._colorMaskState.a=c};a.prototype.setClearColor=function(a,f,g,c){if(this._clearColor.r!==a||this._clearColor.g!==f||this._clearColor.b!==g||this._clearColor.a!==c)this.gl.clearColor(a,
f,g,c),this._clearColor.r=a,this._clearColor.g=f,this._clearColor.b=g,this._clearColor.a=c};a.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a)};a.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a)};a.prototype.setPolygonOffset=
a.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a)};a.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=a)};a.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),
this._scissorTestEnabled=a)};a.prototype.setScissorRect=function(a,f,g,c){if(this._scissorRect.x!==a||this._scissorRect.y!==f||this._scissorRect.width!==g||this._scissorRect.height!==c)this.gl.scissor(a,f,g,c),this._scissorRect.x=a,this._scissorRect.y=f,this._scissorRect.width=g,this._scissorRect.height=c};a.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a)};a.prototype.setClearDepth=
function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)};a.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a)};a.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a)};a.prototype.setDepthRange=a.prototype.setStencilTestEnabled=
a.prototype.setClearStencil=a.prototype.setStencilFunction=function(a,f,g){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==f||this._stencilFunction.mask!==g)this.gl.stencilFunc(a,f,g),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=
f,this._stencilFunction.mask=g};a.prototype.setStencilFunctionSeparate=a.prototype.setStencilWriteMask=a.prototype.setStencilOp=
a.prototype.setStencilOpSeparate=a.prototype.setLineWidth=a.prototype.setActiveTexture=a.prototype.clear=a.prototype.drawArrays=
a.prototype.drawElements=function(a,f,g,c){5123===g?this.gl.drawElements(a,f,g,c):5125===g&&this._extensions.elementIndexUint?this.gl.drawElements(a,f,g,c):console.warn("Data type is uint however extension OES_Element_index_unit is not supported therefore this draw call cannot be made")};a.prototype.drawArraysInstanced=function(a,f,g,c){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawArraysInstancedANGLE(a,f,g,c):console.error("Extension ANGLE_instanced_arrays isn't supported!")};
a.prototype.drawElementsInstanced=function(a,f,g,c,b){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawElementsInstancedANGLE(a,f,g,c,b):console.error("Extension ANGLE_instanced_arrays isn't supported!")};a.prototype.setViewport=a.prototype.getViewport=function(){return this._viewport};a.prototype.bindProgram=a.prototype.bindTexture=function(e,f){void 0===f&&(f=0);-1===a._MAX_TEXTURE_IMAGE_UNITS&&(a._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(f>=a._MAX_TEXTURE_IMAGE_UNITS||0>f)&&console.error("Input texture unit is out of range of available units!");var g=this._textureUnitMap[f];this.setActiveTexture(f);
null==e?(null!=g&&this.gl.bindTexture(g.descriptor.target,null),this._textureUnitMap[f]=null):g&&g.id===e.id?e.applyChanges():(this.gl.bindTexture(e.descriptor.target,e.glName),e.applyChanges(),this._textureUnitMap[f]=e)};a.prototype.bindFramebuffer=a.prototype.bindBuffer=a.prototype.unbindBuffer=a.prototype.bindVAO=a.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};a.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};a.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};a.prototype.resetState=a.prototype.enforceState=function(){var a=this.gl,f=this._extensions.vao;f&&f.bindVertexArrayOES(null);for(var g=0;g<this.parameters.maxVertexAttributes;g++)a.disableVertexAttribArray(g);
this._activeVertexBuffer?a.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):a.bindBuffer(34962,null);this._activeIndexBuffer?a.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):a.bindBuffer(34963,null);if(f&&this._activeVertexArrayObject){if(f=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(f)}a.bindFramebuffer(a.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);a.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);a.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);!0===this._blendEnabled?a.enable(this.gl.BLEND):a.disable(this.gl.BLEND);a.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);a.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);
a.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);a.clearDepth(this._clearDepth);a.clearStencil(this._clearStencil);a.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);a.cullFace(this._cullFace);a.depthFunc(this._depthFunction);a.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);a.depthMask(this._depthWriteEnabled);a.frontFace(this._frontFace);
a.lineWidth(this._lineWidth);!0===this._polygonCullingEnabled?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);a.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL);a.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?a.enable(a.SCISSOR_TEST):a.disable(a.SCISSOR_TEST);a.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,
this._stencilFunction.mask);a.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);a.stencilMask(this._stencilWriteMask);for(f=0;f<this.parameters.maxTextureImageUnits;f++)a.activeTexture(p.BASE_TEXTURE_UNIT+f),a.bindTexture(3553,null),(g=this._textureUnitMap[f])&&a.bindTexture(g.descriptor.target,g.glName);a.activeTexture(p.BASE_TEXTURE_UNIT+
this._activeTextureUnit);a.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};a._bindBuffer=return a}();a._MAX_TEXTURE_IMAGE_UNITS=-1;return a})},"esri/views/webgl/Extensions":function(){define(["require","exports"],function(a,h){return function(){function a(a,f){this._compressedTextureS3TCInit=this._shaderTextureLODInit=this._textureFilterAnisotropicInit=
this._depthTextureInit=this._elementIndexUintInit=this._standardDerivativesInit=this._angleInstancedArraysInit=this._vaoInit=!1;this._gl=a;f&&f.disabledExtensions&&(a=f.disabledExtensions,a.vao&&(this._vao=null,this._vaoInit=!0),a.angleInstancedArrays&&(this._angleInstancedArrays=null,this._angleInstancedArraysInit=!0),a.standardDerivatives&&(this._standardDerivatives=null,this._standardDerivativesInit=!0),a.elementIndexUint&&(this._elementIndexUint=null,this._elementIndexUintInit=!0),a.depthTexture&&
(this._depthTexture=null,this._depthTextureInit=!0),a.textureFilterAnisotropic&&(this._textureFilterAnisotropic=null,this._textureFilterAnisotropicInit=!0),a.compressedTextureS3TC&&(this._compressedTextureS3TC=null,this._compressedTextureS3TCInit=!0),a.shaderTextureLOD&&(this._shaderTextureLOD=null,this._shaderTextureLODInit=!0))}Object.defineProperty(a.prototype,"vao",{get:function(){this._vaoInit||(this._vao=this._gl.getExtension("OES_vertex_array_object")||this._gl.getExtension("MOZ_OES_vertex_array_object")||
this._gl.getExtension("WEBKIT_OES_vertex_array_object"),this._vaoInit=!0);return this._vao},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angleInstancedArrays",{get:function(){this._angleInstancedArraysInit||(this._angleInstancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._angleInstancedArraysInit=!0);return this._angleInstancedArrays},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"standardDerivatives",{get:function(){this._standardDerivativesInit||
(this._standardDerivatives=this._gl.getExtension("OES_standard_derivatives"),this._standardDerivativesInit=!0);return this._standardDerivatives},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"elementIndexUint",{get:function(){this._elementIndexUintInit||(this._elementIndexUint=this._gl.getExtension("OES_element_index_uint"),this._elementIndexUintInit=!0);return this._elementIndexUint},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depthTexture",{get:function(){this._depthTextureInit||
(this._depthTexture=this._gl.getExtension("WEBGL_depth_texture")||this._gl.getExtension("MOZ_WEBGL_depth_texture")||this._gl.getExtension("WEBKIT_WEBGL_depth_texture"),this._depthTextureInit=!0);return this._depthTexture},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureFilterAnisotropic",{get:function(){this._textureFilterAnisotropicInit||(this._textureFilterAnisotropic=this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||
this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._textureFilterAnisotropicInit=!0);return this._textureFilterAnisotropic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"shaderTextureLOD",{get:function(){this._shaderTextureLODInit||(this._shaderTextureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._shaderTextureLODInit=!0);return this._shaderTextureLOD},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"compressedTextureS3TC",{get:function(){this._compressedTextureS3TCInit||
(this._compressedTextureS3TC=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTextureS3TCInit=!0);return this._compressedTextureS3TC},enumerable:!0,configurable:!0});return a}()})},"esri/views/3d/webgl-engine/lib/ProgramRepository":function(){define(["require","exports","./Util"],function(a,h,p){return function(){function a(){this._nextId=0;this._programsByName={};this._namesById=[];this._programRefCount=[];this.shaderVariators={};this._commonUniforms={model:[],modelNormal:[],
lightDirection:[],proj:[],shadowMapDistance:[],viewportPixelSz:[]}}a.prototype.dispose=function(){for(var a in this._programsByName)this._programsByName[a].dispose();this._programRefCount=this._namesById=this._programsByName=null};a.prototype.add=function(a,e){p.assert(null==this._programsByName[a]);this._programsByName[a]=e;this._namesById[e.id]=a};a.prototype.get=function(a){return this._programsByName[a]};a.prototype.getProgramsUsingUniform=a.prototype.increaseRefCount=
function(a){var e=a.id;this._programRefCount[e]?this._programRefCount[e]++:(this._programRefCount[e]=1,this._findCommonUniforms(a))};a.prototype.decreaseRefCount=function(a){var e=a.id;1<this._programRefCount[e]?this._programRefCount[e]--:(this._forgetCommonUniforms(a),this._programRefCount[e]=0)};a.prototype._getNextId=a.prototype._findCommonUniforms=function(a){for(var e in this._commonUniforms)a.hasUniform(e)&&(p.assert(-1===this._commonUniforms[e].indexOf(a),
"common uniforms of program have already been determined"),this._commonUniforms[e].push(a))};a.prototype._forgetCommonUniforms=function(a){for(var e in this._commonUniforms){var f=this._commonUniforms[e],g=f.indexOf(a);-1<g&&(f[g]=f[f.length-1],f.pop())}};return a}()})},"esri/views/support/screenshotUtils":function(){define(["require","exports","dojo/_base/lang"],function(a,h,p){h.adjustScreenshotSettings=function(a,f){a=p.mixin({format:"png",quality:100},a||{});var e,l;a.includePadding?(e=f.width,
l=f.height):(e=f.width-f.padding.left-f.padding.right,l=f.height-f.padding.top-f.padding.bottom);var g=e/l;void 0!==a.width&&void 0===a.height?a.height=a.width/g:void 0!==a.height&&void 0===a.width&&(a.width=g*a.height);void 0!==a.height&&(a.height=Math.floor(a.height));void 0!==a.width&&(a.width=Math.floor(a.width));a.area||a.includePadding||(a.area={x:f.padding.left,y:f.padding.top,width:e,height:l});return a};h.resampleHermite=)},"esri/views/3d/webgl-engine/lib/Selector":function(){define("require exports dojo/has ./PerformanceTimer ./gl-matrix ./Object3D".split(" "),
function(a,h,p,m,f,e){var l=f.vec3d,g=f.mat4d,c=g.create(),b=l.create(),q=l.create();a=function(){function a(a,b,c,e,f,d,k){void 0===k&&(k=!1);this.dir=l.create();this.normalDir=null;this.minResult=new x;this.maxResult=new x;this.invertedM=g.create();this.enableHUDSelection=!0;this.enableInvisibleTerrain=!1;this.enableBackfacesTerrain=!0;this.performanceInfo={queryDuration:0,numObjectsTested:0};this.intersectObject=this.intersectObject.bind(this);this.init(a,b,c,e,f,d,k)}a.prototype.init=function(a,
b,c,e,g,d,f){b&&c&&l.subtract(c,b,this.dir);this.minResult.init(b,c);this.maxResult.init(b,c);this.numObjectsTested=0;this.point=e;this.camera=g;this.isSelection=f;this.layers=a;this.p0=b;this.p1=c;this.hudResults=[];null==d&&(d=1E-5);this.tolerance=d;if(this.layers)for(a=0;a<this.layers.length;++a)if(b=this.layers[a],c=b.getSpatialQueryAccelerator?b.getSpatialQueryAccelerator():void 0)c.forEachAlongRay(this.p0,this.dir,this.intersectObject);else for(b=b.getObjects(),c=0;c<b.length;++c)this.intersectObject(b[c])};
a.prototype.getDirection=function(){this.normalDir||(this.normalDir=l.create(),l.normalize(this.dir,this.normalDir));return this.normalDir};a.prototype.intersectObject=function(a){var e=this;this.numObjectsTested++;for(var f=a.getId(),n=a.getGeometryRecords(),l=a.getObjectTransformation(),d,k=0;k<n.length;k++){var h=n[k],m=h.geometry,t=h.materials,p=h.instanceParameters;d=m.getId();g.set(l,c);g.multiply(c,h.getShaderTransformation());g.inverse(c,this.invertedM);g.multiplyVec3(this.invertedM,this.p0,
b);g.multiplyVec3(this.invertedM,this.p1,q);t[0].intersect(m,p,c,this,b,q,function(b,c,g,k,n){0<=b&&(n?(n=new x,n.set(a,f,b,c,k,a.getCenter(),d,g),e.hudResults.push(n)):((null==e.minResult.priority||k>=e.minResult.priority)&&(null==e.minResult.dist||b<e.minResult.dist)&&e.minResult.set(a,f,b,c,k,null,d,g),(null==e.maxResult.priority||k>=e.maxResult.priority)&&(null==e.maxResult.dist||b>e.maxResult.dist)&&e.maxResult.set(a,f,b,c,k,null,d,g)))},h.customTransformation)}};a.prototype.getMinResult=function(){return this.minResult};
a.prototype.getMaxResult=function(){return this.maxResult};a.prototype.getHudResults=function(){return this.hudResults};return a}();a.DEFAULT_TOLERANCE=1E-5;a.Result=typeof x;var x=function(){function a(a,b){this.normal=l.create();this.init(a,b)}a.prototype.getIntersectionPoint=function(a){if(null==this.dist)return!1;l.lerp(this.p0,this.p1,this.dist,a);return!0};a.prototype.set=function(a,b,c,g,f,d,k,h){this.dist=c;l.set(g,this.normal);this.targetType=a?a instanceof e?"StageObject":"StagePoint":"None";
this.target=a;this.name=b;this.priority=f;this.center=d;this.geometryId=k;this.triangleNr=h};a.prototype.setIntersector=function(a){this.intersector=a};a.prototype.init=function(a,b){this.dist=void 0;this.targetType="None";this.priority=this.name=this.target=void 0;this.triangleNr=this.geometryId=this.center=null;this.intersector="stage";this.p0=a;this.p1=b};return a}();return a})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("require exports ./IdGen ./Util ./gl-matrix ./ComponentUtils ./ModelContentType ./GeometryRecord".split(" "),
function(a,h,p,m,f,e,l,g){var c=m.assert,b=f.mat4d,q=f.vec3d,x=m.VertexAttrConstants;a=function(){function a(c){void 0===c&&(c={});this._bvObjectSpace=new y;this._bvWorldSpace=new y;this._bvDirty=!0;this._hasVolatileTransformation=!1;this.id=a._idGen.gen(c.idHint);this.name=c.name;this.castShadow=null!=c.castShadow?c.castShadow:!0;this.metadata=c.metadata;this.objectTransformation=b.identity();this._initializeGeometryRecords(c.geometries,c.materials,c.transformations)}a.prototype._initializeGeometryRecords=
function(a,e,f){if(Array.isArray(a)){c(e.length===a.length,"Object3D: materials don't match geometries");c(f.length===a.length,"Object3D: transformations don't match geometries");this.geometryRecords=Array(a.length);this.geometries=a.slice();for(var n=0;n<a.length;n++)c(Array.isArray(e[n]),"Object3D: materials parameter must be array of array"),this.geometryRecords[n]=new g(a[n],e[n].slice(),b.create(f[n]),{});this._hasVolatileTransformation=!1}else this.geometryRecords=[],this.geometries=[]};a.prototype.getId=
function(){return this.id};Object.defineProperty(a.prototype,"parentLayer",{get:function(){return this._parentLayer},set:function(a){c(null==this._parentLayer||null==a,"Object3D can only be added to a single Layer");this._parentLayer=a},enumerable:!0,configurable:!0});a.prototype.getParentLayer=function(){return this.parentLayer};a.prototype.addParentLayer=function(a){this.parentLayer=a};a.prototype.removeParentLayer=a.prototype.getNumGeometryRecords=function(){return this.geometryRecords.length};
a.prototype.getFirstGeometryIndex=function(a){a=this.geometries.indexOf(a);c(-1<a,"Object3D.getFirstGeometryIndex: geometry not found");return a};a.prototype.findGeometryRecords=function(a){for(var b=[],c=0;c<this.geometries.length;c++)this.geometries[c]===a&&b.push(this.geometryRecords[c]);return b};a.prototype.getGeometryRecord=function(a){c(0<=a&&a<this.geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this.geometryRecords[a]};a.prototype.getGeometryRecords=function(){return this.geometryRecords};
a.prototype.addGeometry=function(a,e,f,l,d,k){c(Array.isArray(e),"Object3D.addGeometry: materials must be array");this.geometries.push(a);a=new g(a,e.slice(),b.create(f),l||{},d,k);this.geometryRecords.push(a);this._hasVolatileTransformation=this.geometryRecords.some(function(a){return!!a.customTransformation});this._notifyDirty("objGeometryAdded",a);this._invalidateBoundingVolume();return a};a.prototype.hasGeometry=a.prototype.removeGeometry=function(a){var b=
this.geometryRecords.splice(a,1)[0];this._hasVolatileTransformation=this.geometryRecords.some(function(a){return!!a.customTransformation});this.geometries.splice(a,1);this._notifyDirty("objGeometryRemoved",b);this._invalidateBoundingVolume();return b};a.prototype.geometryVertexAttrsUpdated=function(a){this._notifyDirty("vertexAttrsUpdated",this.geometryRecords[a]);this._invalidateBoundingVolume()};a.prototype.geometryColorAttrsUpdated=
a.prototype.isAllHidden=function(){for(var a=0,b=this.geometryRecords;a<b.length;a++){var c=b[a],g=c.instanceParameters.componentVisibilities,c=c.geometry.getData().componentOffsets;if(!e.isAllHidden(g,c))return!1}return!0};a.prototype.isAllVisible=function(){for(var a=0,b=this.geometryRecords;a<b.length;a++){var c=b[a],g=c.instanceParameters.componentVisibilities,c=c.geometry.getData().componentOffsets;if(!e.isAllVisible(g,c))return!1}return!0};a.prototype.setFacerangeColors=function(a,b){var c=
this.geometryRecords;if(1!==c.length)console.warn("face range colors currently support only one geometry record");else{var c=c[0].geometry,e=c.data.vertexAttributes;if(null!=c.originalColors||!a.every()if(null==c.originalColors&&(c.originalColors=e[x.COLOR].data,e[x.COLOR].data=new c.originalColors.constructor(c.originalColors)),e=e[x.COLOR].data,null!=e){for(var d=0;d<a.length;d++){var g=a[d],f=null==g.faceRanges?0:12*g.faceRanges[0],l=null==g.faceRanges?e.length:
12*(g.faceRanges[1]+1);if(null!=g.color)if("blend"===b)for(var h=g.color[0],m=g.color[1],q=g.color[2],g=g.color[3];f<l;f+=4)e[f+0]=c.originalColors[f+0]*h,e[f+1]=c.originalColors[f+1]*m,e[f+2]=c.originalColors[f+2]*q,e[f+3]=c.originalColors[f+3]*g;else for(h=255*g.color[0],m=255*g.color[1],q=255*g.color[2],g=255*g.color[3];f<l;f+=4)e[f+0]=h,e[f+1]=m,e[f+2]=q,e[f+3]=g;else for(;f<l;f++)e[f]=c.originalColors[f]}this.geometryColorAttrsUpdated(0)}}};a.prototype.hasComponents=function(){for(var a=!1,b=
0;b<this.geometries.length&&!(a=this.geometries[b].getData(),a=e.hasComponents(a.componentOffsets));b++);return a};a.prototype.setComponentVisibility=function(a,b,c){var g=a.instanceParameters.componentVisibilities,d=a.geometry.getData().componentOffsets;b=e.updateVisibility(g,d,b,c);a.instanceParameters.componentVisibilities=b;this._notifyDirty("componentVisibilityChanged",a)};a.prototype.getComponentVisibility=a.prototype.hideAllComponents=
function(){for(var a=0,b=this.geometryRecords;a<b.length;a++){var c=b[a],g=e.hideAllComponents(c.instanceParameters.componentVisibilities);c.instanceParameters.componentVisibilities=g}this._notifyDirty("componentVisibilityChanged")};a.prototype.unhideAllComponents=function(){for(var a=0,b=this.geometryRecords;a<b.length;a++){var c=b[a],g=e.unhideAllComponents(c.instanceParameters.componentVisibilities);c.instanceParameters.componentVisibilities=g}this._notifyDirty("componentVisibilityChanged")};a.prototype.getFaceRangeIndexFromTriangleNr=
function(a){var b=this.metadata.faceRanges;if(null!=b)for(var c=0;c<b.length;c++)if(b[c][0]<=a&&b[c][1]>=a)return c};a.prototype.getFaceRangeFromTriangleNr=function(a){a=this.getFaceRangeIndexFromTriangleNr(a);var b=this.metadata.faceRanges;return a?[b[a]]:null};a.prototype.setGeometryTransformation=function(a,e){c(0<=a&&a<this.geometryRecords.length,"Object3d.setGeometryTransformation: index out of range");var f=this.geometryRecords[a];e=new g(f.geometry,f.materials,b.create(e),f.instanceParameters);
this.geometryRecords[a]=e;this._notifyDirty("objGeometryReplaced",[f,e]);this._invalidateBoundingVolume()};a.prototype.getObjectTransformation=function(){return b.create(this.objectTransformation)};a.prototype.setObjectTransformation=function(a){b.set(a,this.objectTransformation);this._invalidateBoundingVolume();this._notifyDirty("objTransformation")};a.prototype.getCombinedStaticTransformation=function(a,c){c=c||b.create();b.multiply(this.objectTransformation,a.getStaticTransformation(),c);return c};
a.prototype.getCombinedShaderTransformation=function(a,c){c=c||b.create();b.multiply(this.objectTransformation,a.getShaderTransformation(),c);return c};a.prototype.hasVolativeTransformation=function(){return this._hasVolatileTransformation};a.prototype.getCastShadow=function(){return this.castShadow};a.prototype.setCastShadow=function(a){this.castShadow=a};a.prototype.getMetadata=function(){return this.metadata};a.prototype.getName=function(){return this.name};a.prototype.getBBMin=function(a){this._validateBoundingVolume();
return a?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin};a.prototype.getBBMax=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax};a.prototype.getCenter=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.center:this._bvWorldSpace.center};a.prototype.getBSRadius=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius};a.prototype._validateBoundingVolume=function(){if(this._bvDirty||
this._hasVolatileTransformation){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var a=q.create(),c=q.create(),e=0;e<this.geometryRecords.length;++e)for(var g=this.geometries[e],d=this.geometryRecords[e].getShaderTransformation(),f=g.getNumGroups(),l=0;l<f;++l){var h=g.getBoundingInfo(l);b.multiplyVec3(d,h.getBBMin(),a);b.multiplyVec3(d,h.getBBMax(),c);for(var m=0;3>m;++m)this._bvObjectSpace.bbMin[m]=Math.min(this._bvObjectSpace.bbMin[m],a[m],c[m]),this._bvObjectSpace.bbMax[m]=Math.max(this._bvObjectSpace.bbMax[m],
a[m],c[m]);b.multiplyVec3(this.objectTransformation,a);b.multiplyVec3(this.objectTransformation,c);for(m=0;3>m;++m)this._bvWorldSpace.bbMin[m]=Math.min(this._bvWorldSpace.bbMin[m],a[m],c[m]),this._bvWorldSpace.bbMax[m]=Math.max(this._bvWorldSpace.bbMax[m],a[m],c[m])}q.lerp(this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5,this._bvObjectSpace.center);q.lerp(this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5,this._bvWorldSpace.center);m=this._getScaleFactor(this.objectTransformation);for(e=0;e<
this.geometryRecords.length;++e)for(var g=this.geometries[e],d=this.geometryRecords[e].getShaderTransformation(),t=this._getScaleFactor(d),f=g.getNumGroups(),l=0;l<f;++l){h=g.getBoundingInfo(l);b.multiplyVec3(d,h.getCenter(),a);var p=q.dist(a,this._bvObjectSpace.center),h=h.getBSRadius()*t;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,p+h);b.multiplyVec3(this.objectTransformation,a,c);p=q.dist(c,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,
p+h*m)}this._bvDirty=!1}};a.prototype._getScaleFactor=function(a){return Math.max(Math.max(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))};a.prototype._invalidateBoundingVolume=function(){this._bvDirty=!0;this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace)};a.prototype._notifyDirty=function(a,b,c,e){this._parentLayer&&(c=c||l.OBJECT,this._parentLayer.notifyDirty(a,b,c,e||this))};return a}();
a._idGen=new p;var y=function(){function a(){this.bbMin=q.create();this.bbMax=q.create();this.center=q.create();this.bsRadius=0}a.prototype.init=function(){q.set3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,this.bbMin);q.set3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,this.bbMax);q.set3(0,0,0,this.center);this.bsRadius=0};a.prototype.getCenter=function(){return this.center};a.prototype.getBSRadius=function(){return this.bsRadius};return a}();return a})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define(["require",
"exports","./IdGen"],function(a,h,p){a=function(){function a(f,e,l,g,c,b){this.id=a._idGen.gen(f.getId());this.geometry=f;this.materials=e;this.transformation=l;this.instanceParameters=g;this.origin=c;this.customTransformation=b}a.prototype.getId=function(){return this.id};a.prototype.getStaticTransformation=function(){return this.transformation};a.prototype.getShaderTransformation=return a}();
a._idGen=new p;return a})},"esri/views/3d/support/aaBoundingBox":function(){define(["require","exports","./aaBoundingRect"],function(a,h,p){function m(a){return a[0]>=a[3]?0:a[3]-a[0]}function f(a){return a[1]>=a[4]?0:a[4]-a[1]}function e(a){return a[2]>=a[5]?0:a[5]-a[2]}function l(a){return 6===a.length}h.create=function(a){void 0===a&&(a=h.ZERO);return[a[0],a[1],a[2],a[3],a[4],a[5]]};h.fromExtent=h.fromMinMax=function(a,c){return[a[0],
a[1],a[2],c[0],c[1],c[2]]};h.expand=function(a,c,b){void 0===b&&(b=a);var e=c.declaredClass;"esri.geometry.Extent"===e?(b[0]=Math.min(a[0],c.xmin),b[1]=Math.min(a[1],c.ymin),b[3]=Math.max(a[3],c.xmax),b[4]=Math.max(a[4],c.ymax),c.hasZ&&(b[2]=Math.min(a[2],c.zmin),b[5]=Math.max(a[5],c.zmax))):"esri.geometry.Point"===e?(b[0]=Math.min(a[0],c.x),b[1]=Math.min(a[1],c.y),b[3]=Math.max(a[3],c.x),b[4]=Math.max(a[4],c.y),c.hasZ&&(b[2]=Math.min(a[2],c.z),b[5]=Math.min(a[5],c.z))):l(c)?(b[0]=Math.min(a[0],c[0]),
b[1]=Math.min(a[1],c[1]),b[2]=Math.min(a[2],c[2]),b[3]=Math.max(a[3],c[3]),b[4]=Math.max(a[4],c[4]),b[5]=Math.max(a[5],c[5])):p.is(c)?(b[0]=Math.min(a[0],c[0]),b[1]=Math.min(a[1],c[1]),b[3]=Math.max(a[3],c[2]),b[4]=Math.max(a[4],c[3])):Array.isArray(c)&&(2===c.length?(b[0]=Math.min(a[0],c[0]),b[1]=Math.min(a[1],c[1]),b[3]=Math.max(a[3],c[0]),b[4]=Math.max(a[4],c[1])):3===c.length&&(b[0]=Math.min(a[0],c[0]),b[1]=Math.min(a[1],c[1]),b[2]=Math.min(a[2],c[2]),b[3]=Math.max(a[3],c[0]),b[4]=Math.max(a[4],
c[1]),b[5]=Math.max(a[5],c[2])));return b};h.expandBuffer=function(a,c,b,e,f){void 0===f&&(f=a);var g=a[0],l=a[1],h=a[2],m=a[3],n=a[4];a=a[5];for(var q=0;q<e;q++)g=Math.min(g,c[b+3*q]),l=Math.min(l,c[b+3*q+1]),h=Math.min(h,c[b+3*q+2]),m=Math.max(m,c[b+3*q]),n=Math.max(n,c[b+3*q+1]),a=Math.max(a,c[b+3*q+2]);f[0]=g;f[1]=l;f[2]=h;f[3]=m;f[4]=n;f[5]=a;return f};h.allFinite=function(a){for(var c=0;6>c;c++)if(!isFinite(a[c]))return!1;return!0};h.width=m;h.depth=f;h.height=e;h.center=function(a,c){void 0===
c&&(c=[0,0,0]);c[0]=a[0]+m(a)/2;c[1]=a[1]+f(a)/2;c[2]=a[2]+e(a)/2;return c};h.size=function(a,c){void 0===c&&(c=[0,0,0]);c[0]=m(a);c[1]=f(a);c[2]=e(a);return c};h.contains=function(a,c){return c[0]>=a[0]&&c[1]>=a[1]&&c[2]>=a[2]&&c[0]<=a[3]&&c[1]<=a[4]&&c[2]<=a[5]};h.containsWithMargin=function(a,c,b){return c[0]>=a[0]-b&&c[1]>=a[1]-b&&c[2]>=a[2]-b&&c[0]<=a[3]+b&&c[1]<=a[4]+b&&c[2]<=a[5]+b};h.containsAabb=function(a,c){return c[0]>=a[0]&&c[1]>=a[1]&&c[2]>=a[2]&&c[3]<=a[3]&&c[4]<=a[4]&&c[5]<=a[5]};
h.intersectsAabb=function(a,c){return Math.max(c[0],a[0])<=Math.min(c[3],a[3])&&Math.max(c[1],a[1])<=Math.min(c[4],a[4])&&Math.max(c[2],a[2])<=Math.min(c[5],a[5])};h.offset=function(a,c,b,e,f){void 0===f&&(f=a);f[0]=a[0]+c;f[1]=a[1]+b;f[2]=a[2]+e;f[3]=a[3]+c;f[4]=a[4]+b;f[5]=a[5]+e;return f};h.setMin=function(a,c,b){void 0===b&&(b=a);b[0]=c[0];b[1]=c[1];b[2]=c[2];b!==a&&(b[3]=a[3],b[4]=a[4],b[5]=a[5]);return b};h.setMax=function(a,c,b){void 0===b&&(b=a);b[3]=c[0];b[4]=c[1];b[5]=c[2];b!==a&&(b[0]=
a[0],b[1]=a[1],b[2]=a[2]);return a};h.set=h.toRect=function(a,c){c||(c=p.create());c[0]=a[0];c[1]=a[1];c[2]=a[3];c[3]=a[4];return c};h.fromRect=function(a,c){a[0]=c[0];a[1]=c[1];a[3]=c[2];a[4]=c[3];return a};h.is=l;h.isPoint=function(a){return 0===m(a)&&0===f(a)&&0===e(a)};h.equals=function(a,c,b){if(null==a||null==c)return a===c;if(!l(a)||!l(c))return!1;if(b)for(var e=0;e<a.length;e++){if(!b(a[e],c[e]))return!1}else for(e=
0;e<a.length;e++)if(a[e]!==c[e])return!1;return!0};h.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];h.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];h.ZERO=[0,0,0,0,0,0]})},"esri/views/3d/support/aaBoundingRect":function(){define(["require","exports"],function(a,h){function p(a){return a[0]>=a[2]?0:a[2]-a[0]}function m(a){return a[1]>=a[3]?0:a[3]-a[1]}.create=function(a){void 0===a&&(a=h.ZERO);return[a[0],
a[1],a[2],a[3]]};h.fromExtent=h.expand=function(a,l,g){void 0===g&&(g=a);var c=l.declaredClass;"esri.geometry.Extent"===c?(g[0]=Math.min(a[0],l.xmin),g[1]=Math.min(a[1],l.ymin),g[2]=Math.max(a[2],l.xmax),g[3]=Math.max(a[3],l.ymax)):"esri.geometry.Point"===c?(g[0]=Math.min(a[0],l.x),g[1]=Math.min(a[1],l.y),g[2]=Math.max(a[2],l.x),g[3]=Math.max(a[3],l.y)):f(l)?(g[0]=Math.min(a[0],l[0]),g[1]=Math.min(a[1],l[1]),g[2]=Math.max(a[2],l[2]),g[3]=Math.max(a[3],
l[3])):!Array.isArray(l)||2!==l.length&&3!==l.length||(g[0]=Math.min(a[0],l[0]),g[1]=Math.min(a[1],l[1]),g[2]=Math.max(a[2],l[0]),g[3]=Math.max(a[3],l[1]));return g};h.allFinite=function(a){for(var e=0;4>e;e++)if(!isFinite(a[e]))return!1;return!0};h.width=p;h.height=m;h.center=function(a,f){void 0===f&&(f=[0,0]);f[0]=a[0]+p(a)/2;f[1]=a[1]+m(a)/2;return f};h.contains=function(a,f){return f[0]>=a[0]&&f[1]>=a[1]&&f[0]<=a[2]&&f[1]<=a[3]};h.containsWithMargin=function(a,f,g){return f[0]>=a[0]-g&&f[1]>=
a[1]-g&&f[0]<=a[2]+g&&f[1]<=a[3]+g};h.offset=function(a,f,g,c){void 0===c&&(c=a);c[0]=a[0]+f;c[1]=a[1]+g;c[2]=a[2]+f;c[3]=a[3]+g;return c};h.setMin=function(a,f,g){void 0===g&&(g=a);g[0]=f[0];g[1]=f[1];g!==a&&(g[2]=a[2],g[3]=a[3]);return g};h.setMax=function(a,f,g){void 0===g&&(g=a);g[2]=f[0];g[3]=f[1];g!==a&&(g[0]=a[0],g[1]=a[1]);return a};h.set=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];a[3]=f[3];return a};h.is=f;h.isPoint=function(a){return(0===p(a)||!isFinite(a[0]))&&(0===m(a)||!isFinite(a[1]))};
h.equals=function(a,l,g){if(null==a||null==l)return a===l;if(!f(a)||!f(l))return!1;if(g)for(var c=0;c<a.length;c++){if(!g(a[c],l[c]))return!1}else for(c=0;c<a.length;c++)if(a[c]!==l[c])return!1;return!0};h.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];h.ZERO=[0,0,0,0]})},"esri/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ./ElevationInfo ../../support/aaBoundingBox ../../support/aaBoundingRect ../../webgl-engine/Stage ../../webgl-engine/lib/Util".split(" "),
function(a,h,p,m,f,e,l,g,c,b){var q=b.assert;a=function(){function a(a,b,c,d,f,g){this.graphics3DSymbolLayer=a;this.renderGeometries=b;this.uniqueMaterials=c;this.uniqueTextures=d;this.boundingBox=f;this.elevationInfo=new e(g);this.stage=null;this._visibilityFlags={};this._shown=!1}a.prototype.initialize=function(a,b){this.stage=b;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)b.add(c.ModelContentType.MATERIAL,this.uniqueMaterials[a]);if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)b.add(c.ModelContentType.TEXTURE,
this.uniqueTextures[a])};a.prototype.isDraped=function(){return!0};a.prototype.areVisibilityFlagsSet=function(a,b){for(var c=!0,d=Object.keys(this._visibilityFlags),e=0;e<d.length;e++){var f=d[e];if(f!==b){if(f===a)return this._visibilityFlags[f];c=c&&this._visibilityFlags[f]}}return c};a.prototype.setVisibilityFlag=function(a,b){this._visibilityFlags[a]=b;return this._calcAndSetVisibility()};a.prototype._calcAndSetVisibility=function(){var a=this.areVisibilityFlagsSet();return this._shown!==a?(this._shown=
a,q(!!this.stage,"Graphics3DDrapedGraphicLayer must be initialized first"),this._shown?this.stage.getTextureGraphicsRenderer().addRenderGeometries(this.renderGeometries):this.stage.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),!0):!1};a.prototype.destroy=function(){if(this.stage){var a=this.stage;this._shown&&a.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries);this._shown=!1;if(this.uniqueMaterials)for(var b=0;b<this.uniqueMaterials.length;b++)a.remove(c.ModelContentType.MATERIAL,
this.uniqueMaterials[b].getId());if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)a.remove(c.ModelContentType.TEXTURE,this.uniqueTextures[b].getId());this.stage=null}};a.prototype.mustAlignToTerrain=function(){return!1};a.prototype.alignWithElevation=function(a,b){};a.prototype.setDrawOrder=function(a,b,c){var d=this;this.uniqueMaterials&&this.uniqueMaterials.forEach(function(c){c.setRenderPriority(a);d._shown&&(b[c.getId()]=!0)})};a.prototype.getBSRadius=function(){return this.renderGeometries.reduce(0)};a.prototype.getCenterObjectSpace=a.prototype.getProjectedBoundingBox=function(a,b,c){return f(this,void 0,void 0,function(){var d,e,f;return m(this,function(g){switch(g.label){case 0:l.set(c,l.NEGATIVE_INFINITY);for(d=0;d<this.renderGeometries.length;d++)e=this.renderGeometries[d],this._getRenderGeometryProjectedBoundingRect(e,x,a),l.expand(c,x);if(!b)return[3,5];l.center(c,t);f=void 0;g.label=1;case 1:return g.trys.push([1,3,,4]),[4,
b.queryElevation(t[0],t[1])];case 2:return f=g.sent(),[3,4];case 3:return g.sent(),f=null,[3,4];case 4:null!=f&&(c[2]=Math.min(c[2],f),c[5]=Math.max(c[5],f)),g.label=5;case 5:return[2,c]}})})};a.prototype._getRenderGeometryProjectedBoundingRect=function(a,b,c){if(this.boundingBox)l.set(y,this.boundingBox);else{var d=a.center;a=a.bsRadius;y[0]=d[0]-a;y[1]=d[1]-a;y[2]=d[2]-a;y[3]=d[0]+a;y[4]=d[1]+a;y[5]=d[2]+a}c(y,0,2);return l.toRect(y,b)};return a}();var x=g.create(),y=[0,0,0,0,0,0],t=[0,0,0];return a})},
"esri/views/3d/layers/graphics/ElevationAligners":function(){define("require exports ../../../../geometry/Point ../../lib/glMatrix ../../support/projectionUtils ../../webgl-engine/lib/Util ./Graphics3DSymbolCommonCode ./graphicUtils ./ElevationInfo".split(" "),function(a,h,p,m,f,e,l,g,c){var b=e.VertexAttrConstants;a=m.vec3d;var q=new p,x=a.create(),y=a.create(),t=a.create(),u={verticalDistanceToGround:0,terrainElevation:0};h.perVertexElevationAligner=function(a,e,f){var d=a.stageObject,g=a.elevationInfo;
q.spatialReference=e.spatialReference;for(var n=d.getGeometryRecords(),m=n.length,r=g.mode!==c.MODES.ABSOLUTE_HEIGHT,w=0,p=0;p<m;p++){var C=n[p].geometry,F=n[p].getShaderTransformation();y[0]=F[12];y[1]=F[13];y[2]=F[14];C.invalidateBoundingInfo();for(var F=C.getData().getVertexAttr(),K=F[b.POSITION],C=K.data,F=F.mapPos.data,K=K.size,M=C.length/K,E=0,V=0,P=!1,I=0,J=0;J<M;J++){q.x=F[V++];q.y=F[V++];q.z=F[V++];t[0]=C[E];t[1]=C[E+1];t[2]=C[E+2];var Q=l.computeElevation(e,q,g,r?u:null);r&&(I+=u.terrainElevation);
x[0]=C[E]+y[0];x[1]=C[E+1]+y[1];x[2]=C[E+2]+y[2];f.setAltitude(Q,x,0);C[E]=x[0]-y[0];C[E+1]=x[1]-y[1];C[E+2]=x[2]-y[2];Q=h.updateThresholdInMeters/f.unitInMeters;if(Math.abs(t[0]-C[E])>=Q||Math.abs(t[1]-C[E+1])>=Q||Math.abs(t[2]-C[E+2])>=Q)P=!0;E+=K}w+=I/M;P&&d.geometryVertexAttrsUpdated(p)}a.alignedTerrainElevation=w/m};h.perObjectElevationAligner=function(a,b,e){var d=a.elevationInfo,k=d.centerPointInElevationSR,n=0,m=0;if(a.stageObject.metadata.usesVerticalDistanceToGround)n=l.computeElevation(b,
k,d,u),g.updateVertexAttributeAuxpos1w(a.stageObject,u.verticalDistanceToGround),m=u.terrainElevation;else{var q=d.mode!==c.MODES.ABSOLUTE_HEIGHT,n=l.computeElevation(b,k,d,q?u:null);q&&(m=u.terrainElevation)}b=a.stageObject.getObjectTransformation();d=[b[12],b[13],b[14]];h.iterativeUpdatesEnabled?e.setAltitudeOfTransformation(n,b):(x[0]=k.x,x[1]=k.y,x[2]=n,f.computeLinearTransformation(k.spatialReference,x,b,e.spatialReference)&&a.stageObject.setObjectTransformation(b));e=h.updateThresholdInMeters/
e.unitInMeters;(Math.abs(b[12]-d[0])>=e||Math.abs(b[13]-d[1])>=e||Math.abs(b[14]-d[2])>=e)&&a.stageObject.setObjectTransformation(b);a.alignedTerrainElevation=m};h.perObjectVerticalDistanceToGroundAligner=function(a,b,c){c=a.elevationInfo;var d={verticalDistanceToGround:0};l.computeElevation(b,c.centerPointInElevationSR,c,d);g.updateVertexAttributeAuxpos1w(a.stageObject,d.verticalDistanceToGround)};h.updateThresholdInMeters=.01;h.iterativeUpdatesEnabled=!0})},"esri/views/3d/support/projectionUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Point ./mathUtils ./earthUtils ../lib/glMatrix ../webgl-engine/lib/BufferVectorMath".split(" "),
function(a,h,p,m,f,e){var l=f.vec3d,g=f.mat4d,c=e.Vec3Compact,b=l.create(),q=l.create(),x=l.create(),y=p.deg2rad(1),t=p.rad2deg(1),u=new a({wkt:'\r\n      GEOCCS["Spherical geocentric",\r\n        DATUM["Not specified",\r\n          SPHEROID["Sphere",'+m.earthRadius+',0]],\r\n        PRIMEM["Greenwich",0.0,\r\n          AUTHORITY["EPSG","8901"]],\r\n        UNIT["m",1.0],\r\n        AXIS["Geocentric X",OTHER],\r\n        AXIS["Geocentric Y",EAST],\r\n        AXIS["Geocentric Z",NORTH]\r\n      ]\r\n    '}),
r=m.earthRadius,n=function(a){return a===u?1:a.isWGS84?2:a.isWebMercator?3:0};a=function(a,b,d,c){d[c++]=a[b++];d[c++]=a[b++];d[c]=a[b]};var w=function(a,b,d,c){var e=.4999999*Math.PI,f=y*a[b+1],f=p.clamp(f,-e,e),e=Math.sin(f);d[c++]=y*a[b]*r;d[c++]=r/2*Math.log((1+e)/(1-e));d[c]=a[b+2]},d=function(a,b,d,c){var e=r+a[b+2],f=y*a[b+1];a=y*a[b];b=Math.cos(f);d[c++]=Math.cos(a)*b*e;d[c++]=Math.sin(a)*b*e;d[c]=Math.sin(f)*e},k=[void 0,d,a,w],v=[void 0,function(a,b,d,e){var f=c.length(a,b),g=p.asin(a[b+
2]/f);a=(0<a[b+1]?1:-1)*p.acos(a[b]/(Math.cos(g)*f));d[e++]=t*a;d[e++]=t*g;d[e]=f-r},a,function(a,b,d,c){d[c++]=t*(a[b++]/r);d[c++]=t*(Math.PI/2-2*Math.atan(Math.exp(-1*a[b++]/r)));d[c]=a[b]}];return{SphericalRenderSpatialReference:u,vectorToVector:function(a,d,c,e){2===a.length?(b[0]=a[0],b[1]=a[1],b[2]=0,a=b):a===c&&(l.set(a,b),a=b);return this.bufferToBuffer(a,d,0,c,e,0,1)},pointToVector:function(a,d,c){b[0]=a.x;b[1]=a.y;b[2]=a.z||0;return this.bufferToBuffer(b,a.spatialReference,0,d,c,0,1)},vectorToPoint:function(a,
d,c,e){"esri.SpatialReference"===c.declaredClass?(e=c,c=new h({spatialReference:e})):e=e||c.spatialReference;return this.bufferToBuffer(a,d,0,b,e,0,1)?(c.x=b[0],c.y=b[1],c.z=b[2],c.spatialReference=e,c):null},xyzToVector:function(a,d,c,e,f,g){b[0]=a;b[1]=d;b[2]=c;return this.bufferToBuffer(b,e,0,f,g,0,1)},bufferToBuffer:function(a,b,d,c,e,f,g){g=g||1;var l=n(b),h=n(e);g=d+3*g;if(l!==h||0===l&&!b.equals(e))if(0<l&&0<h)if(2!==h)if(e=k[h],2!==l)for(l=v[l];d<g;d+=3,f+=3)l(a,d,q,0,b.wkid),e(q,0,c,f);else for(;d<
g;d+=3,f+=3)e(a,d,c,f);else for(l=v[l];d<g;d+=3,f+=3)l(a,d,c,f,b.wkid);else return!1;else if(c!==a||d!==f)for(;d<g;d++,f++)c[f]=a[d];return!0},computeLinearTransformation:function(a,b,c,e){var f=n(a),k=n(e);if(f===k&&(0!==f||a.equals(e)))return g.identity(c),g.translate(c,b),!0;if(1===k){if(e=v[f])return e(b,0,q,0,a.wkid),d(q,0,x,0),e=y*q[0],b=y*q[1],a=Math.sin(e),e=Math.cos(e),f=Math.sin(b),b=Math.cos(b),c[0]=-a,c[4]=-f*e,c[8]=b*e,c[12]=x[0],c[1]=e,c[5]=-f*a,c[9]=b*a,c[13]=x[1],c[2]=0,c[6]=b,c[10]=
f,c[14]=x[2],c[3]=0,c[7]=0,c[11]=0,c[15]=1,!0}else if(3===k&&(2===f||1===f))return v[f](b,0,q,0,a.wkid),a=y*q[1],w(q,0,x,0),g.identity(c),g.translate(c,x),a=1/Math.cos(a),g.scale(c,[a,a,1]),!0;return!1},mbsToMbs:function(a,b,c,e){var f=n(b),g=n(e);if(f===g&&(0!==f||b.equals(e)))return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],!0;if(1===g){if(e=v[f])return e(a,0,q,0,b.wkid),d(q,0,c,0),c[3]=a[3],!0}else if(3===g&&(2===f||1===f))return v[f](a,0,q,0,b.wkid),b=y*q[1],b=Math.abs(b)+Math.asin(a[3]/(r+a[2])),
w(q,0,c,0),c[3]=b>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(b)*a[3],!0;return!1},extentToBoundingBox:function(a,d,c){if(null==a)return!1;var e;b[0]=null!=a.xmin?a.xmin:0;b[1]=null!=a.ymin?a.ymin:0;b[2]=null!=a.zmin?a.zmin:0;e=this.bufferToBuffer(b,a.spatialReference,0,d,c,0,1);b[0]=null!=a.xmax?a.xmax:0;b[1]=null!=a.ymax?a.ymax:0;b[2]=null!=a.zmax?a.zmax:0;e=e&&this.bufferToBuffer(b,a.spatialReference,0,d,c,3,1);null==a.xmin&&(d[0]=-Infinity);null==a.ymin&&(d[1]=-Infinity);null==a.zmin&&(d[2]=-Infinity);
null==a.xmax&&(d[3]=Infinity);null==a.ymax&&(d[4]=Infinity);null==a.zmax&&(d[5]=Infinity);return e},extentToBoundingRect:function(a,d,c){if(null==a)return!1;var e;b[0]=null!=a.xmin?a.xmin:0;b[1]=null!=a.ymin?a.ymin:0;b[2]=null!=a.zmin?a.zmin:0;e=this.bufferToBuffer(b,a.spatialReference,0,b,c,0,1);d[0]=b[0];d[1]=b[1];b[0]=null!=a.xmax?a.xmax:0;b[1]=null!=a.ymax?a.ymax:0;b[2]=null!=a.zmax?a.zmax:0;e=e&&this.bufferToBuffer(b,a.spatialReference,0,b,c,0,1);d[2]=b[0];d[3]=b[1];null==a.xmin&&(d[0]=-Infinity);
null==a.ymin&&(d[1]=-Infinity);null==a.xmax&&(d[2]=Infinity);null==a.ymax&&(d[3]=Infinity);return e},webMercator:{x2lon:y2lat:function(a){return Math.PI/2-2*Math.atan(Math.exp(-1*a/r))},lon2x:lat2y:function(a){a=Math.sin(a);return r/2*Math.log((1+a)/(1-a))}}}})},"esri/views/3d/support/earthUtils":function(){define(["dojo/_base/lang","./mathUtils","../../../geometry/Point","../../../geometry/SpatialReference","../../../geometry/support/webMercatorUtils"],
function(a,h,p,m,f){var e=6378137*Math.PI,l=new p(0,0,m.WGS84),g={earthRadius:6378137,halfEarthCircumference:e,earthCircumference:2*e,metersPerDegree:e/180,getGreatCircleDistance:function(c,b,e,f){void 0===e&&void 0===f&&a.isObject(c)&&a.isObject(b)&&(e=b.get("longitude"),f=b.get("latitude"),b=c.get("latitude"),c=c.get("longitude"));b=h.deg2rad(b);f=h.deg2rad(f);c=h.deg2rad(c);var g=h.deg2rad(e);e=Math.sin((b-f)/2);c=Math.sin((c-g)/2);b=12756274*h.asin(Math.sqrt(e*e+Math.cos(b)*Math.cos(f)*c*c));
return b=Math.round(1E4*b)/1E4},getGreatCircleSpanAt:function(a,b,e){var c=b.spatialReference,f=new p(b.x,a.y,c),g=new p(e.x,a.y,c);b=new p(a.x,b.y,c);a=new p(a.x,e.y,c);return{lon:this.getGreatCircleDistance(f,g),lat:this.getGreatCircleDistance(b,a)}},getLonDeltaForDistance:function(a,b,e){a=e/6378137;b=h.deg2rad(b);a=Math.sin(a/2);b=Math.cos(b);b=2*h.asin(Math.sqrt(a*a/(b*b)));return h.rad2deg(b)},getLatDeltaForDistance:function(a,b,e){return h.rad2deg(e/6378137)},getLatLonDeltaForDistance:function(a,
b,e){return{lat:this.getLatDeltaForDistance(a,b,e),lon:this.getLonDeltaForDistance(a,b,e)}},getMaxCameraAltitude:function(a){a=h.deg2rad(a/2);return 6378137*(1-Math.sin(a))/Math.sin(a)},getViewExtentDistance:function(a,b){b=h.deg2rad(b/2);return 12756274*h.acos((Math.pow(a+6378137,2)+Math.pow(6378137,2)-Math.pow((a+6378137)*Math.cos(b)-Math.sqrt(Math.pow(Math.cos(b)*(a+6378137),2)-a*a-12756274*a),2))/(12756274*(a+6378137)))},computeCarthesianDistance:function(a,b){function c(a){var b=h.deg2rad(a.get("latitude")),
c=h.deg2rad(a.get("longitude")),e=Math.cos(b);a=6378137+(a.z||0);return[Math.cos(c)*e*a,Math.sin(b)*a,-Math.sin(c)*e*a]}a=c(a);b=c(b);b=[b[0]-a[0],b[1]-a[1],b[2]-a[2]];return Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])},longitudeToTimezone:function(a,b){a/=15;b||(a=Math.round(a));return a},positionToTimezone:function(a,b){a.spatialReference.wkid!==m.WGS84.wkid?f.webMercatorToGeographic(a,!1,l):(l.x=a.x,l.y=a.y);l.z=a.z;b||(b={hours:0,minutes:0,seconds:0});b.hours=g.longitudeToTimezone(l.x,!0);a=b.hours%
1;b.hours-=a;b.minutes=60*a;a=b.minutes%1;b.minutes-=a;b.seconds=Math.round(60*a);return b}};return g})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["require","exports"],function(a,h){(function(a){a.length=function(a,f){var e=a[f],l=a[f+1];a=a[f+2];return Math.sqrt(e*e+l*l+a*a)};a.normalize=function(a,f){var e=a[f],l=a[f+1],g=a[f+2],e=1/Math.sqrt(e*e+l*l+g*g);a[f]*=e;a[f+1]*=e;a[f+2]*=e};a.scale=function(a,f,e){a[f]*=e;a[f+1]*=e;a[f+2]*=e};a.add=function(a,f,e,l,g,c){void 0===
c&&(c=f);g=g||a;g[c]=a[f]+e[l];g[c+1]=a[f+1]+e[l+1];g[c+2]=a[f+2]+e[l+2]};a.subtract=function(a,f,e,l,g,c){void 0===c&&(c=f);g=g||a;g[c]=a[f]-e[l];g[c+1]=a[f+1]-e[l+1];g[c+2]=a[f+2]-e[l+2]}})(h.Vec3Compact||(h.Vec3Compact={}))})},"esri/views/3d/layers/graphics/Graphics3DSymbolCommonCode":function(){define("../../../../geometry/Point ../../../../geometry/support/mathUtils ./graphicUtils ./ElevationInfo ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/lib/Object3D".split(" "),function(a,
h,p,m,f,e,l){var g=e.mat4d,c=e.vec3d.create(),b=g.identity(),q={x:0,y:0,z:0,spatialReference:null},x={createStageObjectForPoint:function(a,e,f,g,h,d,k,m,q,p,y){var n=e?e.length:0,t=this._context.clippingExtent;x.reprojectPoint(a,c,this._context.elevationProvider.spatialReference);if(t&&!x.pointInBox2D(c,t))return null;x.reprojectPoint(a,c,this._context.renderSpatialReference);t=this._context.localOriginFactory.getOrigin(c);k=new l({castShadow:!1,metadata:{layerId:m,graphicId:q,usesVerticalDistanceToGround:void 0===
p?!1:p},idHint:k});for(m=0;m<n;m++)k.addGeometry(e[m],f[m],g?g[m]:b,h,t,y);a=x.setObjectElevation(k,a,d,this._context.renderSpatialReference,this._context.elevationProvider);return{object:k,terrainElevation:a.terrainElevation}},extendPointGraphicElevationInfo:function(a,b,e){a=a.elevationInfo;e=e.spatialReference;x.reprojectPoint(b,c,e);a.centerPointInElevationSR={x:c[0],y:c[1],z:b.hasZ?c[2]:void 0,spatialReference:e}},placePointOnPolyline:function(b){var c=b.paths[0],c=h.getPointOnPath(c,h.getPathLength(c)/
2);return new a(c[0],c[1],c[2],b.spatialReference)},placePointOnPolygon:function(a){return p.computeCentroid(a)},computeElevation:function(a,b,c,e){var f=0,d=b.z||0,g=0,g=c.mode,n=c.offset||0;g===m.MODES.ON_THE_GROUND?(f=g=a.getElevation(b)||0,e&&(e.verticalDistanceToGround=0,e.terrainElevation=g)):g===m.MODES.RELATIVE_TO_GROUND?(g=a.getElevation(b)||0,f=n,null==c.featureExpression&&(f+=d),e&&(e.verticalDistanceToGround=f,e.terrainElevation=g),f+=g):g===m.MODES.ABSOLUTE_HEIGHT&&(f=d+n,e&&(g=a.getElevation(b)||
0,e.verticalDistanceToGround=f-g,e.terrainElevation=g));return f},applyElevation:function(a,b,c,e,f,d,g){var k=g.mode,n=g.offset,l=0,h=0,t=0;q.spatialReference=a.spatialReference;c*=3;f*=3;for(var r=0;r<d;++r)q.x=b[c+0],q.y=b[c+1],q.z=b[c+2],k===m.MODES.ON_THE_GROUND?(h=l=a.getElevation(q)||0,t+=l):k===m.MODES.RELATIVE_TO_GROUND?(l=a.getElevation(q)||0,h=l+n,null==g.featureExpression&&(h+=q.z),t+=l):k===m.MODES.ABSOLUTE_HEIGHT&&(h=q.z+n),e[f+0]=b[c+0],e[f+1]=b[c+1],e[f+2]=h,c+=3,f+=3;return{terrainElevation:t/
d}},setObjectElevation:function(a,b,e,g,l){var d=0,k;if(a.metadata.usesVerticalDistanceToGround)d=x.computeElevation(l,b,e,y),p.updateVertexAttributeAuxpos1w(a,y.verticalDistanceToGround),k=y.terrainElevation;else{var n=e.mode!==m.MODES.ABSOLUTE_HEIGHT,d=x.computeElevation(l,b,e,n?y:null);n&&(k=y.terrainElevation)}e=a.getObjectTransformation();c[0]=b.x;c[1]=b.y;c[2]=d;f.computeLinearTransformation(b.spatialReference,c,e,g)?a.setObjectTransformation(e):console.warn("Could not locate symbol object properly, it might be misplaced");
return{terrainElevation:k}},getSingleSizeDriver:function(a){return isFinite(a[0])?a[0]:null},isCounterClockwise:function(a){for(var b=0,c=a.length-1,e=0;e<c;e++)b+=a[e][0]*a[e+1][1]-a[e+1][0]*a[e][1];return 0<=b},copyPointData:function(a,b,c,e,f,d){e*=3;for(var g=0;g<f;++g){var n=a[b++];c[e++]=n[0];c[e++]=n[1];c[e++]=d?n[2]:0}return e/3},copyPathData:function(a,b){for(var c=a.length,e=Array(c),f=Array(c),d=Array(c),g=0,l=0,h=0,m=0,q=0;q<c;++q)m+=a[q].length;for(var m=new Float64Array(3*m),t=0,p=c-
1;0<=p;p--){var u=a[p];if(x.isCounterClockwise(u))e[g++]=u;else{for(var y=u.length,q=0;q<g;++q)y+=e[q].length;q={index:t,pathLengths:Array(g+1),count:y,holeIndices:Array(g)};q.pathLengths[0]=u.length;0<u.length&&(d[h++]={index:t,count:u.length});t=x.copyPointData(u,0,m,t,u.length,b);for(u=0;u<g;++u)y=e[u],q.holeIndices[u]=t,q.pathLengths[u+1]=y.length,0<y.length&&(d[h++]={index:t,count:y.length}),t=x.copyPointData(y,0,m,t,y.length,b);g=0;0<q.count&&(f[l++]=q)}}for(u=0;u<g;++u)y=e[u],0<y.length&&(d[h++]=
{index:t,count:y.length}),t=x.copyPointData(y,0,m,t,y.length,b);l<c&&(f.length=l);h<c&&(d.length=h);return{vertexData:m,polygons:f,outlines:d}},copyVertices:function(a,b,c,e,f){b*=3;e*=3;for(var d=0;d<f;++d)c[e++]=a[b++],c[e++]=a[b++],c[e++]=a[b++]},chooseOrigin:function(a,b,c,e){b=Math.floor(b+(c-1)/2);e[0]=a[3*b+0];e[1]=a[3*b+1];e[2]=a[3*b+2]},subtractCoordinates:function(a,b,c,e){b*=3;for(var f=0;f<c;++f)a[b++]-=e[0],a[b++]-=e[1],a[b++]-=e[2]},setZ:function(a,b,c,e){b*=3;for(var f=0;f<c;++f)a[b+
2]=e,b+=3},offsetZ:function(a,b,c,e){b*=3;for(var f=0;f<c;++f)a[b+2]+=e,b+=3},scaleZ:function(a,b,c,e){b*=3;for(var f=0;f<c;++f)a[b+2]*=e,b+=3},flatArrayToArrayOfArrays:function(a,b,c){var e=[];b*=3;for(var f=0;f<c;++f)e.push([a[b++],a[b++],a[b++]]);return e},reproject:reprojectPoint:getGeometryVertexData3D:function(a,b,c,e,f,d){var g=f.spatialReference;a=x.copyPathData(a,b);b=a.vertexData;var n=b.length/
3,l=new Float64Array(b.length);c.equals(g)?x.copyVertices(b,0,l,0,b.length):x.reproject(b,0,c,l,0,g,n);c=x.applyElevation(f,l,0,b,0,n,d);g.equals(e)||x.reproject(b,0,g,b,0,e,n);return{geometryData:a,vertexData:b,eleVertexData:l,terrainElevation:c.terrainElevation}},getGeometryVertexDataDraped:function(a,b,c){a=x.copyPathData(a,!1);var e=a.vertexData,g=e.length/3;b.equals(c)||f.bufferToBuffer(e,b,0,e,c,0,g);return{geometryData:a,vertexData:e}},computeBoundingBox:function(a,b,c,e){e[0]=Number.MAX_VALUE;
e[1]=Number.MAX_VALUE;e[2]=Number.MAX_VALUE;e[3]=-Number.MAX_VALUE;e[4]=-Number.MAX_VALUE;e[5]=-Number.MAX_VALUE;b*=3;for(var f=0;f<c;++f){var d=a[b++],g=a[b++],n=a[b++];d<e[0]&&(e[0]=d);g<e[1]&&(e[1]=g);n<e[2]&&(e[2]=n);d>e[3]&&(e[3]=d);g>e[4]&&(e[4]=g);n>e[5]&&(e[5]=n)}return e},pointInBox2D:function(a,b){return!(a[0]>b[3]||a[0]<b[0]||a[1]>b[4]||a[1]<b[1])},boxesIntersect2D:function(a,b){return!(b[0]>a[3]||b[3]<a[0]||b[1]>a[4]||b[4]<a[1])},boundingBoxClipped:function(a,b){return b?!x.boxesIntersect2D(a,
b):!1},ELEV_MODES:m.MODES},y={verticalDistanceToGround:0,terrainElevation:0};return x})},"esri/views/3d/layers/graphics/SignedDistanceFunctions":function(){define(["require","exports","../../support/mathUtils"],function(a,h,p){unction f(a,b,f){a=p.clamp(a,0,.9999991);var c=m(a*e[0]),g=m(a*e[1]),h=m(a*e[2]);a=m(a*e[3]);b[f+0]=256*(c-c*l[0]);b[f+1]=256*(g-c*l[1]);b[f+2]=256*(h-g*l[2]);b[f+3]=256*(a-h*l[3])}var e=[16777216,65536,256,1],l=[0,1/256,1/256,1/256],g=
[1/16777216,1/65536,1/256,1];h.packFloat=f;h.unpackFloat=function(a,b){var c=a[b+1]/256,e=a[b+2]/256,f=a[b+3]/256;a=0+a[b+0]/256*g[0];a+=c*g[1];a+=e*g[2];return a+=f*g[3]};h.computeSignedDistancefieldCicle=function(a,b){var c=new Uint8Array(4*a*a),e=a/2-.5;b/=2;for(var g=0;g<a;g++)for(var l=0;l<a;l++){var h=l+a*g,m=l-e,n=g-e,m=Math.sqrt(m*m+n*n)-b,m=m/a+.5;f(m,c,4*h)}return c};h.computeSignedDistancefieldSquare=function(a,b,e){e&&(b/=Math.SQRT2);for(var c=new Uint8Array(4*a*a),g=0;g<a;g++)for(var l=
0;l<a;l++){var h=l-.5*(a-.5),m=g-.5*(a-.5),n=g*a+l;if(e)var q=(h+m)/Math.SQRT2,m=(m-h)/Math.SQRT2,h=q;h=Math.max(Math.abs(h),Math.abs(m))-.5*b;h=h/a+.5;f(h,c,4*n)}return c};h.computeSignedDistancefieldCrossAndX=function(a,b,e){e&&(b*=Math.SQRT2);b*=.5;for(var c=new Uint8Array(4*a*a),g=0;g<a;g++)for(var l=0;l<a;l++){var h=l-.5*a+0,m=g-.5*a+0,n=g*a+l;if(e)var q=(h+m)/Math.SQRT2,m=(m-h)/Math.SQRT2,h=q;h=Math.abs(h);m=Math.abs(m);q=void 0;q=h>m?h>b?Math.sqrt((h-b)*(h-b)+m*m):m:m>b?Math.sqrt(h*h+(m-b)*
(m-b)):h;q=q/a+.5;f(q,c,4*n)}return c}})},"esri/views/3d/layers/graphics/FastSymbolUpdates":function(){define(["require","exports","../../../../renderers/support/utils","../../lib/glMatrix","../../support/mathUtils"],function(a,h,p,m,f){unction l(a){return"number"===typeof a}unction c(a,d,c,f,n){var k=a.minSize,h=a.maxSize;if(a.expression)return g(n,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=
f.symbolSize[c],d.minSize[c]=a,d.maxSize[c]=a,d.offset[c]=d.minSize[c],d.factor[c]=0,d.type[c]=1,!0;if(e(a.field)){if(e(a.stops)){if(2===a.stops.length&&l(a.stops[0].size)&&l(a.stops[1].size))return b(a.stops[0].size,a.stops[1].size,a.stops[0].value,a.stops[1].value,d,c),d.type[c]=1,!0;g(n,"Could not convert size info: stops only supported with 2 elements");return!1}if(l(k)&&l(h)&&e(a.minDataValue)&&e(a.maxDataValue))return b(k,h,a.minDataValue,a.maxDataValue,d,c),d.type[c]=1,!0;if(null!=p.meterIn[a.valueUnit])return d.minSize[c]=
-Infinity,d.maxSize[c]=Infinity,d.offset[c]=0,d.factor[c]=1/p.meterIn[a.valueUnit],d.type[c]=1,!0;"unknown"===a.valueUnit?g(n,"Could not convert size info: proportional size not supported"):g(n,"Could not convert size info: scale-dependent size not supported");return!1}if(!e(a.field)){if(a.stops&&a.stops[0]&&l(a.stops[0].size))return d.minSize[c]=a.stops[0].size,d.maxSize[c]=a.stops[0].size,d.offset[c]=d.minSize[c],d.factor[c]=0,d.type[c]=1,!0;if(l(k))return d.minSize[c]=k,d.maxSize[c]=k,d.offset[c]=
k,d.factor[c]=0,d.type[c]=1,!0}g(n,"Could not convert size info: unsupported variant of sizeInfo");return!1}unction q(a,b,d,e){if(a.normalizationField||a.valueRepresentation)return g(e,"Could not convert size info: unsupported property"),null;var f=a.field;if(null!=f&&"string"!==typeof f)return g(e,"Could not convert size info: field is not a string"),null;if(!b.size)b.size=
{field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!b.size.field)b.size.field=a.field;else if(a.field!==b.size.field)return g(e,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(f=c(a,b.size,0,d,e))?b:null;case "height":return(f=c(a,b.size,2,d,e))?b:null;case "depth":return(f=c(a,b.size,1,d,e))?b:null;case "width-and-depth":return(f=c(a,b.size,0,d,e))&&c(a,b.size,1,d,e),f?b:null;case null:case void 0:case "all":return(f=
(f=(f=c(a,b.size,0,d,e))&&c(a,b.size,1,d,e))&&c(a,b.size,2,d,e))?b:null;default:return g(e,'Could not convert size info: unknown axis "'+a.axis+'""'),null}}nction t(a,b,d){if(a.normalizationField)return g(d,"Could not convert color info: unsupported property"),null;if("string"===typeof a.field)if(a.stops){if(8<a.stops.length)return g(d,"Could not convert color info: too many color stops"),null;b.color={field:a.field,values:[],colors:[]};a=a.stops;for(d=
0;8>d;++d){var c=a[Math.min(d,a.length-1)];b.color.values[d]=c.value;y(b.color.colors,d,c.color)}}else if(a.colors){if(!e(a.minDataValue)||!e(a.maxDataValue))return g(d,"Could not convert color info: missing data values"),null;if(2!==a.colors.length)return g(d,"Could not convert color info: invalid colors array"),null;b.color={field:a.field,values:[],colors:[]};b.color.values[0]=a.minDataValue;y(b.color.colors,0,a.colors[0]);b.color.values[1]=a.maxDataValue;y(b.color.colors,1,a.colors[1]);for(d=2;8>
d;++d)b.color.values[d]=a.maxDataValue,y(b.color.colors,d,a.colors[1])}else return g(d,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length||a.colors&&0<=a.colors.length)for(a=a.stops&&0<=a.stops.length?a.stops[0].color:a.colors[0],b.color={field:null,values:Array(8),colors:Array(32)},d=0;8>d;d++)b.color.values[d]=Infinity,y(b.color.colors,d,a);else return g(d,"Could not convert color info: no field and no colors/stops"),null;return b}function u(a,b,d){return a?
(a=a.reduce(function(a,c){if(!a)return a;if(c.valueExpression)return g(d,"Could not convert visual variables: arcade expressions not supported"),null;switch(c.type){case "size":return q(c,a,b,d);case "color":return t(c,a,d);case "rotation":return"string"===typeof c.field?a.rotation={field:c.field,rotationType:c.rotationType}:(g(d,"Could not convert rotation info: field is not a string"),a=null),a;default:return g(d,"Could not convert visual variables: unsupported type "+c.type),null}},{size:null,
color:null,rotation:null}))&&a.size&&!x(a.size,b,d)?null:a:null}function r(a){return a&&(null!=a.size||null!=a.rotation)}function n(a,b,d){return!!a!==!!b||a&&a.field!==b.field?!1:!0}function w(a,b){var d={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvAnchorValue:null,vvRotationEnabled:!1,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null},c=r(a);a&&a.size?(d.vvSizeEnabled=!0,d.vvSizeMinSize=a.size.minSize,d.vvSizeMaxSize=a.size.maxSize,
d.vvSizeOffset=a.size.offset,d.vvSizeFactor=a.size.factor):a&&c&&(d.vvSizeValue=b.transformation.scale);a&&a.rotation&&(d.vvRotationEnabled=!0);a&&c&&(d.vvRotationValue=b.transformation.rotation,d.vvAnchorValue=b.transformation.anchor);a&&a.color&&(d.vvColorEnabled=!0,d.vvColorValues=a.color.values,d.vvColorColors=a.color.colors);return d}h.convertVisualVariables=u;h.initFastSymbolUpdatesState=function(a,b,d){return b&&a&&!a.disableFastUpdates?(a=u(a.visualVariables,d))?{enabled:!0,visualVariables:a,
materialParameters:w(a,d),customTransformation:r(a)}:{enabled:!1}:{enabled:!1}};h.updateFastSymbolUpdatesState=function(a,b,d){if(!b||!a.enabled)return!1;var c=a.visualVariables;b=u(b.visualVariables,d);if(!(b&&n(c.size,b.size,"size")&&n(c.color,b.color,"color")&&n(c.rotation,b.rotation,"rotation")))return!1;a.visualVariables=b;a.materialParameters=w(b,d);a.customTransformation=r(b);return!0};h.getMaterialParams=w;var d;(function(a){var b=m.mat4d,d=m.vec3,c=b.create(),e=d.create();a.evaluateModelTransform=
function(a,d,g){if(!a.vvSizeEnabled&&!a.vvRotationEnabled)return g;b.identity(c);var k=0;a.vvRotationEnabled&&(k+=d[2]);null!=a.vvRotationValue&&(k+=f.deg2rad(a.vvRotationValue));0!==k&&b.rotateZ(c,-k,c);if(a.vvSizeEnabled){for(k=0;3>k;++k){var n=a.vvSizeOffset[k]+d[0]*a.vvSizeFactor[k],l=k;var h=a.vvSizeMinSize[k],m=a.vvSizeMaxSize[k],n=n<h?h:n>m?m:n;e[l]=n}b.scale(c,e,c)}else b.scale(c,a.vvSizeValue,c);b.translate(c,a.vvAnchorValue,c);b.multiply(g,c,c);return c}})(d||(d={}));h.evaluateModelTransform=
d.evaluateModelTransform})},"esri/renderers/support/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/date/locale ../../Color ../../core/numberUtils dojo/i18n!../nls/smartMapping dojo/i18n!dojo/cldr/nls/gregorian".split(" "),function(a,h,p,m,f,e,l){function g(a){return a&&h.map(a,function(a){return new m(a)})}function c(a,b,c){var d="";0===b?d=q.lt+" ":b===c&&(d=q.gt+" ");return d+a}var b={},q={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%"},x={millisecond:0,second:1,minute:2,
hour:3,day:4,month:5,year:6},y={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},day:{selector:"date",dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},year:{selector:"date",dateOptions:{selector:"year"}}},
t={formatLength:"short",fullYear:!0},u={formatLength:"short"};a.mixin(b,{meterIn:{inches:39.3701,feet:3.28084,yards:1.09361,miles:6.21371E-4,"nautical-miles":5.39957E-4,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,"decimal-degrees":180/20015077},timelineDateFormatOptions:{selector:"date",dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(b,c){var e=[];null==b||b instanceof Date||(b=new Date(b));c=c||{};c=a.mixin({},c);var d=c.selector?c.selector.toLowerCase():
null,f=!d||-1<d.indexOf("time"),d=!d||-1<d.indexOf("date");f&&(c.timeOptions=c.timeOptions||u,c.timeOptions&&(c.timeOptions=a.mixin({},c.timeOptions),c.timeOptions.selector=c.timeOptions.selector||"time",e.push(c.timeOptions)));d&&(c.dateOptions=c.dateOptions||t,c.dateOptions&&(c.dateOptions=a.mixin({},c.dateOptions),c.dateOptions.selector=c.dateOptions.selector||"date",e.push(c.dateOptions)));e&&e.length?(e=h.map(e,function(a){return p.format(b,a)}),c=1==e.length?e[0]:l["dateTimeFormat-medium"].replace(/\'/g,
"").replace(/\{(\d+)\}/g,function(a,b){return e[b]})):c=p.format(b);return c},createColorStops:function(a){var e=a.values,g=a.colors,d=a.labelIndexes,k=a.isDate,l=a.dateFormatOptions;a=[];return a=h.map(e,function(a,n){var m=null;if(!d||-1<h.indexOf(d,n)){var q;(q=k?b.formatDate(a,l):f.format(a))&&(m=c(q,n,e.length-1))}return{value:a,color:g[n],label:m}})},updateColorStops:function(a){var e=a.stops,g=a.changes,d=a.isDate,k=a.dateFormatOptions,l=[],m,q=h.map(e,function(a){return a.value});h.forEach(g,
;m=f.round(q,{indexes:l});h.forEach(e,function(a,g){a.value=q[g];if(null!=a.label){var n,l=null;(n=d?b.formatDate(m[g],k):f.format(m[g]))&&(l=c(n,g,e.length-1));a.label=l}})},createClassBreakLabel:function(a){var b=a.minValue,c=a.maxValue,d=a.isFirstBreak?"":q.gt+" ";a="percent-of-total"===a.normalizationType?q.pct:"";b=null==b?"":f.format(b);c=null==c?"":f.format(c);return d+b+a+" "+e.minToMax+" "+c+a},setLabelsForClassBreaks:function(a){var c=a.classBreaks,
e=a.classificationMethod,d=a.normalizationType,g=[];c&&c.length&&("standard-deviation"===e?console.log("setLabelsForClassBreaks: cannot set labels for class breaks generated using 'standard-deviation' method."):a.round?(g.push(c[0].minValue),h.forEach(c,function(a){g.push(a.maxValue)}),g=f.round(g),h.forEach(c,function(a,c){a.label=b.createClassBreakLabel({minValue:0===c?g[0]:g[c],maxValue:g[c+1],isFirstBreak:0===c,normalizationType:d})})):h.forEach(c,function(a,c){a.label=b.createClassBreakLabel({minValue:a.minValue,
maxValue:a.maxValue,isFirstBreak:0===c,normalizationType:d})}))},updateClassBreak:function(a){var c=a.classBreaks,e=a.normalizationType,d=a.change,f=d.index,d=d.value,g=-1,l=-1,h=c.length;"standard-deviation"===a.classificationMethod?console.log("updateClassBreak: cannot update labels for class breaks generated using 'standard-deviation' method."):(0===f?g=f:f===h?l=f-1:(l=f-1,g=f),-1<g&&g<h&&(a=c[g],a.minValue=d,a.label=b.createClassBreakLabel({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===
g,normalizationType:e})),-1<l&&l<h&&(a=c[l],a.maxValue=d,a.label=b.createClassBreakLabel({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===l,normalizationType:e})))},calculateDateFormatInterval:function(a){var b,c,d=a.length,e,f,g,l,m,q,t=Infinity,p;a=h.map(a,function(a){return new Date(a)});for(b=0;b<d-1;b++){e=a[b];g=[];m=Infinity;q="";for(c=b+1;c<d;c++)f=a[c],f=e.getFullYear()!==f.getFullYear()&&"year"||e.getMonth()!==f.getMonth()&&"month"||e.getDate()!==f.getDate()&&"day"||e.getHours()!==
f.getHours()&&"hour"||e.getMinutes()!==f.getMinutes()&&"minute"||e.getSeconds()!==f.getSeconds()&&"second"||"millisecond",l=x[f],l<m&&(m=l,q=f),g.push(f);m<t&&(t=m,p=q)}return p},createUniqueValueLabel:function(a){var c=a.value,e=a.fieldInfo,d=a.domain;a=a.dateFormatInterval;var g=String(c);(d=d&&d.codedValues?d.getName(c):null)?g=d:"number"===typeof c&&(g=e&&"esriFieldTypeDate"===e.type?b.formatDate(c,a&&y[a]):f.format(c));return g},cloneColorVariable:function(b){var c;b&&(c=a.mixin({},b),c.colors=
g(c.colors),c.stops=c.stops&&h.map(c.stops,function(b){b=a.mixin({},b);b.color&&(b.color=new m(b.color));return b}),c.legendOptions&&(c.legendOptions=a.mixin({},c.legendOptions)));return c},cloneOpacityVariable:function(b){var c;if(b){c=a.mixin({},b);if(b=c.opacityValues)c.opacityValues=b.slice(0);if(b=c.stops)c.stops=h.map(b,function(b){return a.mixin({},b)});if(b=c.legendOptions)c.legendOptions=a.mixin({},b)}return c},cloneSizeVariable:function(c){var e;c&&(e=a.mixin({},c),e.stops&&(e.stops=h.map(e.stops,
),(c=e.minSize)&&"object"===typeof c&&(e.minSize=b.cloneSizeVariable(c)),(c=e.maxSize)&&"object"===typeof c&&(e.maxSize=b.cloneSizeVariable(c)),c=e.legendOptions)&&(e.legendOptions=a.mixin({},c),c=c.customValues)&&(e.legendOptions.customValues=c.slice(0));return e}});return b})},"esri/core/numberUtils":function(){define(["dojo/number","dojo/i18n!dojo/cldr/nls/number"],function(a,h){ar m=/^-?(\d+)(\.(\d+))?$/i,f=new RegExp("\\"+h.decimal+
"0+$","g"),e=/(\d)0*$/g,l={numDigits:function(a){var c=String(a),b=c.match(m);a={integer:0,fractional:0};b&&b[1]?(a.integer=b[1].split("").length,a.fractional=b[3]?b[3].split("").length:0):-1<c.toLowerCase().indexOf("e")&&(b=c.split("e"),c=b[0],b=b[1],c&&b&&(c=Number(c),b=Number(b),(a=0<b)||(b=Math.abs(b)),c=l.numDigits(c),a?(c.integer+=b,c.fractional=b>c.fractional?0:c.fractional-b):(c.fractional+=b,c.integer=b>c.integer?1:c.integer-b),a=c));return a},percentChange:function(a,c,b,e){var f={previous:null,
next:null},g;null!=b&&(g=a-b,f.previous=Math.floor(Math.abs(100*(c-b-g)/g)));null!=e&&(g=e-a,f.next=Math.floor(Math.abs(100*(e-c-g)/g)));return f},round:function(a,c){a=a.slice(0);var b,e,f,g,h,m,r,n,w=c&&null!=c.tolerance?c.tolerance:2,d=c&&c.indexes,k=c&&null!=c.strictBounds?c.strictBounds:!1;if(d)d.sort(p);else for(d=[],h=0;h<a.length;h++)d.push(h);for(h=0;h<d.length;h++)if(n=d[h],c=a[n],b=0===n?null:a[n-1],e=n===a.length-1?null:a[n+1],f=l.numDigits(c),f=f.fractional){m=0;for(r=!1;m<=f&&!r;){g=
c;r=m;var v=void 0,A=void 0,v=Number(g.toFixed(r));v<g?A=v+1/Math.pow(10,r):(A=v,v-=1/Math.pow(10,r));v=Number(v.toFixed(r));A=Number(A.toFixed(r));g=[v,A];g=k&&0===h?g[1]:g[0];r=w;var v=l.percentChange(c,g,b,e),z=A=void 0,A=void 0,A=null==v.previous||v.previous<=r,z=null==v.next||v.next<=r;r=A=A&&z||v.previous+v.next<=2*r;m++}r&&(a[n]=g)}return a},format:function(g,c){c=c||{places:20,round:-1};(g=a.format(g,c))&&(g=g.replace(e,"$1").replace(f,""));return g}};return l})},"esri/views/3d/webgl-engine/lib/Geometry":function(){define(["require",
"exports","./IdGen","./Util","./BoundingInfo"],function(a,h,p,m,f){a=function(){function a(e,f,c){this.singleUse=!1;this.originalColors=null;this.id=a.__idGen.gen(f);this.data=e;this.boundingInfos=c||[];m.assert(1<=e.faces.length)}a.prototype.getId=function(){return this.id};a.prototype.getData=function(){return this.data};Object.defineProperty(a.prototype,"numGroups",{get:function(){return this.data.faces.length},enumerable:!0,configurable:!0});a.prototype.getNumGroups=function(){return this.numGroups};
a.prototype.calculateAABB=function(a,e){var c=this.data.faces[a],b="triangle"===c.type?3:1;a=c.indices[c.positionKey];var c=this.data.vertexAttributes[c.positionKey].data,f=null!=e?(e[1]+1)*b:a.length,g=Infinity,l=Infinity,h=Infinity,m=-Infinity,p=-Infinity,n=-Infinity;for(e=null!=e?e[0]*b:0;e<f;e++)var w=3*a[e],b=c[w],d=c[w+1],w=c[w+2],g=Math.min(g,b),l=Math.min(l,d),h=Math.min(h,w),m=Math.max(m,b),p=Math.max(p,d),n=Math.max(n,w);return[g,l,h,m,p,n]};a.prototype.calculateBoundingInfo=function(a,
e){a=this.data.faces[a];var c="triangle"===a.type?3:1,b=a.indices[a.positionKey];if(0===b.length)for(var b=new Uint32Array(c),g=0;g<c;++g)b[g]=g;g=b.length;m.assert(0===g%c);for(var l=g/c,h=new Uint32Array(l),g=0;g<l;++g)h[g]=g;return new f(h,c,b,this.data.vertexAttributes[a.positionKey],e)};a.prototype.getBoundingInfo=function(a){var e=this.boundingInfos[a];null==e&&(e=this.calculateBoundingInfo(a),this.boundingInfos[a]=e);return e};a.prototype.invalidateBoundingInfo=return a}();a.__idGen=new p;return a})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define(["require","exports","./Util","./gl-matrix"],function(a,h,p,m){var f=m.vec3d;return function(){function a(a,e,c,b,h){p.assert(1<=a.length);p.assert(0===c.length%e);p.assert(c.length>=a.length*e);p.assert(3===b.size||4===b.size);this.primitiveIndices=a;this.indices=c;this.position=b;this._numIndexPerPrimitive=e;this._faceRange=h;var g=b.data;b=b.size;var l=0,m=a.length;null!=h&&(l=h[0],m=h[1]+
1);var q=b*c[e*a[l]];this.bbMin=f.createFrom(g[q],g[q+1],g[q+2]);this.bbMax=f.create(this.bbMin);for(h=l;h<m;++h)for(var r=e*a[h],n=0;n<e;++n)for(var q=b*c[r+n],w=0;3>w;++w){var d=g[q+w];d<this.bbMin[w]?this.bbMin[w]=d:d>this.bbMax[w]&&(this.bbMax[w]=d)}this.center=f.create();f.lerp(this.bbMin,this.bbMax,.5,this.center);this.bsRadius=0;for(h=l;h<m;++h)for(r=e*a[h],n=0;n<e;++n)q=b*c[r+n],l=g[q]-this.center[0],w=g[q+1]-this.center[1],q=g[q+2]-this.center[2],q=l*l+w*w+q*q,q>this.bsRadius&&(this.bsRadius=
q);this.bsRadius=Math.sqrt(this.bsRadius)}a.prototype.getCenter=function(){return this.center};a.prototype.getBSRadius=function(){return this.bsRadius};a.prototype.getBBMin=function(){return this.bbMin};a.prototype.getBBMax=function(){return this.bbMax};a.prototype.getPrimitiveIndices=function(){return this.primitiveIndices};a.prototype.getIndices=function(){return this.indices};a.prototype.getPosition=function(){return this.position};a.prototype.getChildren=function(){if(this.children)return this.children;
if(1<f.dist2(this.bbMin,this.bbMax)){for(var e=f.lerp(this.bbMin,this.bbMax,.5,f.create()),g=this.primitiveIndices.length,c=new Uint8Array(g),b=Array(8),h=0;8>h;++h)b[h]=0;for(var m=this.position.size,h=0;h<g;++h){for(var p=0,t=this._numIndexPerPrimitive*this.primitiveIndices[h],u=this.position.data,r=m*this.indices[t],n=u[r],w=u[r+1],d=u[r+2],k=1;k<this._numIndexPerPrimitive;++k){var r=m*this.indices[t+k],v=u[r],A=u[r+1],r=u[r+2];v<n&&(n=v);A<w&&(w=A);r<d&&(d=r)}n<e[0]&&(p|=1);w<e[1]&&(p|=2);d<e[2]&&
(p|=4);c[h]=p;++b[p]}for(h=p=0;8>h;++h)0<b[h]&&++p;if(2>p)return;e=Array(8);for(h=0;8>h;++h)e[h]=0<b[h]?new Uint32Array(b[h]):void 0;for(h=0;8>h;++h)b[h]=0;for(h=0;h<g;++h)p=c[h],e[p][b[p]++]=this.primitiveIndices[h];this.children=Array(8);for(h=0;8>h;++h)void 0!==e[h]&&(this.children[h]=new a(e[h],this._numIndexPerPrimitive,this.indices,this.position))}return this.children};return a}()})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define(["./GeometryData","./BufferVectorMath","./Util",
"./gl-matrix"],function(a,h,p,m){function f(a,b,c,e,f){if(Math.abs(l.dot(b,a))>f)return!1;l.cross(a,b,c);l.normalize(c);l.cross(c,a,e);l.normalize(e);return!0}function e(a,b,c,e,g,d,k){return f(a,b,g,d,k)||f(a,c,g,d,k)||f(a,e,g,d,k)}var l=m.vec3,g=m.vec3d,c=p.VertexAttrConstants,b=h.Vec3Compact,q=g.create(),x=g.create(),y={createSphereGeometry:function(b,e,f,g,h,d,k){b=b||50;g=void 0!==g?g:-Math.PI;h=void 0!==h?h:2*Math.PI;d=void 0!==d?d:.5*-Math.PI;k=void 0!==k?k:Math.PI;var n=Math.max(3,Math.floor(e)||
8),m=Math.max(2,Math.floor(f)||6),q=(n+1)*(m+1);f=new Float32Array(3*q);e=new Float32Array(3*q);var q=new Float32Array(2*q),t,w,r=[],u=l.create(),x=0;for(w=0;w<=m;w++){var y=[],E=w/m,V=d+E*k,P=Math.cos(V);for(t=0;t<=n;t++){var I=t/n,J=g+I*h,Q=Math.cos(J)*P*b,S=Math.sin(V)*b,J=-Math.sin(J)*P*b;f[3*x]=Q;f[3*x+1]=S;f[3*x+2]=J;l.set3(Q,S,J,u);l.normalize(u);e[3*x]=u[0];e[3*x+1]=u[1];e[3*x+2]=u[2];q[2*x]=I;q[2*x+1]=E;y.push(x);++x}r.push(y)}b=new Uint32Array(2*n*(m-1)*3);for(w=x=0;w<m;w++)for(t=0;t<n;t++)g=
r[w][t],h=r[w][t+1],d=r[w+1][t+1],k=r[w+1][t],0===w?(b[x++]=g,b[x++]=d,b[x++]=k):w===m-1?(b[x++]=g,b[x++]=h,b[x++]=d):(b[x++]=g,b[x++]=h,b[x++]=d,b[x++]=d,b[x++]=k,b[x++]=g);p.assert(x===b.length);n={};n[c.POSITION]=b;n[c.NORMAL]=b;n[c.UV0]=b;m={};m[c.POSITION]={size:3,data:f};m[c.NORMAL]={size:3,data:e};m[c.UV0]={size:2,data:q};return new a(m,n)},createPolySphereGeometry:function(e,f,g){function n(a,c){a>c&&(a=c+(c=a,0));var f=a.toString()+"."+c.toString();if(k[f])return k[f];var g=d.length;d.length+=
3;b.add(d,3*a,d,3*c,d,g);b.scale(d,g,e/b.length(d,g));g/=3;return k[f]=g}var l,d;g?(d=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],g=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]):(g=e*(1+Math.sqrt(5))/2,d=[-e,g,0,e,g,0,-e,-g,0,e,-g,0,0,-e,g,0,e,g,0,-e,-g,0,e,-g,g,0,-e,g,0,e,-g,0,-e,-g,0,e],g=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]);for(l=0;l<d.length;l+=3)b.scale(d,l,e/b.length(d,l));var k={};for(l=0;l<f;l++){for(var h=
g.length,m=new Uint32Array(4*h),q=0;q<h;q+=3){var p=g[q],t=g[q+1],r=g[q+2],u=n(p,t),x=n(t,r),y=n(r,p),E=4*q;m[E]=p;m[E+1]=u;m[E+2]=y;m[E+3]=t;m[E+4]=x;m[E+5]=u;m[E+6]=r;m[E+7]=y;m[E+8]=x;m[E+9]=u;m[E+10]=x;m[E+11]=y}g=m;k={}}f=new Float32Array(d);for(l=0;l<f;l+=3)b.normalize(f,l);d=new Float32Array(d);l={};l[c.POSITION]=g;l[c.NORMAL]=g;g={};g[c.POSITION]={size:3,data:d};g[c.NORMAL]={size:3,data:f};return new a(g,l)},createPointGeometry:function(b,e,f,g,l,d,k){var n=new Float32Array(3);n[0]=e?e[0]:
0;n[1]=e?e[1]:0;n[2]=e?e[2]:0;e=new Float32Array(3);e[0]=b?b[0]:0;e[1]=b?b[1]:0;e[2]=b?b[2]:1;if(null==d)b=new Float32Array(2),b[0]=0,b[1]=0;else{b=new Float32Array(d.length);for(var h=0;h<d.length;h++)b[h]=d[h]}d=new Uint8Array(4);d[0]=f?255*f[0]:255;d[1]=f?255*f[1]:255;d[2]=f?255*f[2]:255;d[3]=f&&3<f.length?255*f[3]:255;f=new Float32Array(2);f[0]=null!=g&&2==g.length?g[0]:1;f[1]=null!=g&&2==g.length?g[1]:1;if(null!=l){var m=new Float32Array(4);m[0]=l[0];m[1]=l[1];m[2]=l[2];m[3]=l[3]}if(null!=k){var q=
new Float32Array(4);q[0]=k[0];q[1]=k[1];q[2]=k[2];q[3]=k[3]}h=new Uint32Array(1);h[0]=0;g={};g[c.POSITION]=h;g[c.NORMAL]=h;g[c.UV0]=h;g[c.COLOR]=h;g[c.SIZE]=h;null!=l&&(g[c.AUXPOS1]=h);null!=k&&(g[c.AUXPOS2]=h);h={};h[c.POSITION]={size:3,data:n};h[c.NORMAL]={size:3,data:e};h[c.UV0]={size:b.length,data:b};h[c.COLOR]={size:4,data:d};h[c.SIZE]={size:2,data:f};null!=l&&(h[c.AUXPOS1]={size:4,data:m});null!=k&&(h[c.AUXPOS2]={size:4,data:q});return new a(h,g,a.DefaultOffsets,"point")},createPointArrayGeometry:function(b,
e){for(var f=new Float32Array(3*b.length),g=new Float32Array(e?3*b.length:3),l=new Uint32Array(b.length),d=new Uint32Array(b.length),k=0;k<b.length;k++)f[3*k]=b[k][0],f[3*k+1]=b[k][1],f[3*k+2]=b[k][2],e&&(g[3*k]=e[k][0],g[3*k+1]=e[k][1],g[3*k+2]=e[k][2]),l[k]=k,d[k]=0;e||(g[0]=0,g[1]=1,g[2]=0);b=new Float32Array(2);b[0]=0;b[1]=0;k={};k[c.POSITION]=l;k[c.NORMAL]=e?l:d;k[c.UV0]=d;e={};e[c.POSITION]={size:3,data:f};e[c.NORMAL]={size:3,data:g};e[c.UV0]={size:2,data:b};return new a(e,k,a.DefaultOffsets,
"point")},createTriangleGeometry:function(){var b=new Float32Array(9);b[0]=0;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=100;b[6]=100;b[7]=0;b[8]=0;var e=new Uint32Array(3);e[0]=0;e[1]=1;e[2]=2;var f=new Float32Array(3);f[0]=0;f[1]=1;f[2]=0;var g=new Uint32Array(3);g[0]=0;g[1]=0;g[2]=0;var l=new Float32Array(2);l[0]=0;l[1]=0;var d=new Uint32Array(3);d[0]=0;d[1]=0;d[2]=0;var k={};k[c.POSITION]=e;k[c.NORMAL]=g;k[c.UV0]=d;e={};e[c.POSITION]={size:3,data:b};e[c.NORMAL]={size:3,data:f};e[c.UV0]={size:2,data:l};return new a(e,
k)},createSquareGeometry:function(b){var e,f,g=new Float32Array(12);if(b)for(e=0;4>e;e++)for(f=0;3>f;f++)g[3*e+f]=b[e][f];else g[0]=-1,g[1]=-1,g[2]=0,g[3]=1,g[4]=-1,g[5]=0,g[6]=1,g[7]=1,g[8]=0,g[9]=-1,g[10]=1,g[11]=0;f=new Uint32Array(6);f[0]=0;f[1]=1;f[2]=2;f[3]=2;f[4]=3;f[5]=0;b=new Float32Array(3);b[0]=0;b[1]=0;b[2]=1;var l=new Uint32Array(6);for(e=0;6>e;e++)l[e]=0;e=new Float32Array(8);e[0]=0;e[1]=0;e[2]=1;e[3]=0;e[4]=1;e[5]=1;e[6]=0;e[7]=1;var d=new Uint8Array(4);d[0]=255;d[1]=255;d[2]=255;d[3]=
255;var k={};k[c.POSITION]=f;k[c.NORMAL]=l;k[c.UV0]=f;k[c.COLOR]=l;f={};f[c.POSITION]={size:3,data:g};f[c.NORMAL]={size:3,data:b};f[c.UV0]={size:2,data:e};f[c.COLOR]={size:4,data:d};return new a(f,k)},createBoxGeometry:function(){var b,e,f=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],g=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],l=[0,0,1,0,1,1,0,1],d=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],k=Array(36);for(b=0;6>
b;b++)for(e=0;6>e;e++)k[6*b+e]=b;var h=Array(36);for(b=0;6>b;b++)h[6*b+0]=0,h[6*b+1]=1,h[6*b+2]=2,h[6*b+3]=2,h[6*b+4]=3,h[6*b+5]=0;return function(b){var e;Array.isArray(b)||(b=[b,b,b]);var n=new Float32Array(24);for(e=0;8>e;e++)n[3*e]=f[e][0]*b[0],n[3*e+1]=f[e][1]*b[1],n[3*e+2]=f[e][2]*b[2];b={};b[c.POSITION]=new Uint32Array(d);b[c.NORMAL]=new Uint32Array(k);b[c.UV0]=new Uint32Array(h);e={};e[c.POSITION]={size:3,data:n};e[c.NORMAL]={size:3,data:new Float32Array(g)};e[c.UV0]={size:2,data:new Float32Array(l)};
return new a(e,b)}}(),createDiamondGeometry:function(){var b=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],e=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],f=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],g=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];return function(n){var d;Array.isArray(n)||(n=[n,n,n]);var k=new Float32Array(18);for(d=0;6>d;d++)k[3*d]=b[d][0]*n[0],k[3*d+1]=b[d][1]*n[1],k[3*d+2]=b[d][2]*n[2];n={};n[c.POSITION]=new Uint32Array(f);n[c.NORMAL]=
new Uint32Array(g);d={};d[c.POSITION]={size:3,data:k};d[c.NORMAL]={size:3,data:new Float32Array(e)};return new a(d,n)}}(),createTetrahedronGeometry:function(){var b=l.createFrom(-.5,0,-.5),e=l.createFrom(.5,0,-.5),f=l.createFrom(0,0,.5),g=l.createFrom(0,.5,0),h=l.create(),d=l.create(),k=l.create(),m=l.create(),q=l.create();l.subtract(b,g,h);l.subtract(b,e,d);l.cross(h,d,k);l.normalize(k,k);l.subtract(e,g,h);l.subtract(e,f,d);l.cross(h,d,m);l.normalize(m,m);l.subtract(f,g,h);l.subtract(f,b,d);l.cross(h,
d,q);l.normalize(q,q);var p=[b,e,f,g],x=[0,-1,0,k[0],k[1],k[2],m[0],m[1],m[2],q[0],q[1],q[2]],y=[0,1,2,3,1,0,3,2,1,3,0,2],C=[0,0,0,1,1,1,2,2,2,3,3,3];return function(b){var d;Array.isArray(b)||(b=[b,b,b]);var e=new Float32Array(12);for(d=0;4>d;d++)e[3*d]=p[d][0]*b[0],e[3*d+1]=p[d][1]*b[1],e[3*d+2]=p[d][2]*b[2];b={};b[c.POSITION]=new Uint32Array(y);b[c.NORMAL]=new Uint32Array(C);d={};d[c.POSITION]={size:3,data:e};d[c.NORMAL]={size:3,data:new Float32Array(x)};return new a(d,b)}}(),createConeGeometry:function(b,
e,f,g){var n=0,d=l.createFrom(0,n,0),k=l.createFrom(0,n+b,0),h=l.createFrom(0,-1,0),m=l.createFrom(0,1,0);g&&(n=b,k=l.createFrom(0,0,0),d=l.createFrom(0,n,0),h=l.createFrom(0,1,0),m=l.createFrom(0,-1,0));var d=[k,d],h=[h,m],m=f+2,q=0,k=Math.sqrt(b*b+e*e);if(g)for(g=f-1;0<=g;g--)q=2*Math.PI/f*g,p=l.createFrom(Math.cos(q)*e,n,Math.sin(q)*e),d.push(p),q=l.createFrom(b*Math.cos(q)/k,-e/k,b*Math.sin(q)/k),h.push(q);else for(g=0;g<f;g++){var q=2*Math.PI/f*g,p=l.createFrom(Math.cos(q)*e,n,Math.sin(q)*e);
d.push(p);q=l.createFrom(b*Math.cos(q)/k,e/k,b*Math.sin(q)/k);h.push(q)}b=new Uint32Array(6*(f+2));f=new Uint32Array(6*(f+2));n=e=0;for(g=3;g<d.length;g++)b[e++]=1,b[e++]=g-1,b[e++]=g,f[n++]=0,f[n++]=0,f[n++]=0;b[e++]=d.length-1;b[e++]=2;b[e++]=1;f[n++]=0;f[n++]=0;f[n++]=0;for(g=3;g<d.length;g++)b[e++]=g,b[e++]=g-1,b[e++]=0,f[n++]=g,f[n++]=g-1,f[n++]=1;b[e++]=0;b[e++]=2;b[e++]=d.length-1;f[n++]=1;f[n++]=2;f[n++]=h.length-1;n=1;Array.isArray(n)||(n=[n,n,n]);e=new Float32Array(3*m);for(g=0;g<m;g++)e[3*
g]=d[g][0]*n[0],e[3*g+1]=d[g][1]*n[1],e[3*g+2]=d[g][2]*n[2];d=new Float32Array(3*m);for(g=0;g<m;g++)d[3*g]=h[g][0],d[3*g+1]=h[g][1],d[3*g+2]=h[g][2];h={};h[c.POSITION]=b;h[c.NORMAL]=f;m={};m[c.POSITION]={size:3,data:e};m[c.NORMAL]={size:3,data:d};return new a(m,h)},createCylinderGeometry:function(b,e,f,g,h,d){g||(g=l.createFrom(1,0,0));h||(h=l.createFrom(0,0,0));d=void 0===d?!0:d;var k=l.create();l.normalize(g,k);g=l.create();l.scale(k,Math.abs(b),g);var n=l.create();l.scale(g,-.5,n);l.add(n,h);var m=
l.createFrom(0,1,0);Math.abs(.2>1-l.dot(k,m))&&l.set3(0,0,1,m);var q=l.create();l.cross(k,m,q);l.normalize(q);l.cross(q,k,m);var p=2*f+(d?2:0),t=f+(d?2:0);h=new Float32Array(3*p);b=new Float32Array(3*t);var w=new Float32Array(2*p),r=new Uint32Array(3*f*(d?4:2)),x=new Uint32Array(3*f*(d?4:2));d&&(h[3*(p-2)+0]=n[0],h[3*(p-2)+1]=n[1],h[3*(p-2)+2]=n[2],w[2*(p-2)]=0,w[2*(p-2)+1]=0,h[3*(p-1)+0]=h[3*(p-2)+0]+g[0],h[3*(p-1)+1]=h[3*(p-2)+1]+g[1],h[3*(p-1)+2]=h[3*(p-2)+2]+g[2],w[2*(p-1)]=1,w[2*(p-1)+1]=1,b[3*
(t-2)+0]=-k[0],b[3*(t-2)+1]=-k[1],b[3*(t-2)+2]=-k[2],b[3*(t-1)+0]=k[0],b[3*(t-1)+1]=k[1],b[3*(t-1)+2]=k[2]);var k=u,y,V=0,P=l.create(),I=l.create();for(u=0;u<f;u++)y=2*Math.PI/f*u,l.scale(m,Math.sin(y),P),l.scale(q,Math.cos(y),I),l.add(P,I),b[3*u+0]=P[0],b[3*u+1]=P[1],b[3*u+2]=P[2],l.scale(P,e),l.add(P,n),h[3*u+0]=P[0],h[3*u+1]=P[1],h[3*u+2]=P[2],w[2*u+0]=u/f,w[2*u+1]=0,h[3*(u+f)+0]=h[3*u+0]+g[0],h[3*(u+f)+1]=h[3*u+1]+g[1],h[3*(u+f)+2]=h[3*u+2]+g[2],w[2*(u+f)+0]=u/f,
w[2*u+1]=1,y=(u+1)%f,k(V++,u,u),k(V++,u+f,u),k(V++,y,y),k(V++,y,y),k(V++,u+f,u),k(V++,y+f,y);if(d){for(u=0;u<f;u++)y=(u+1)%f,k(V++,p-2,t-2),k(V++,u,t-2),k(V++,y,t-2);for(u=0;u<f;u++)y=(u+1)%f,k(V++,u+f,t-1),k(V++,p-1,t-1),k(V++,y+f,t-1)}e={};e[c.POSITION]=r;e[c.NORMAL]=x;e[c.UV0]=r;f={};f[c.POSITION]={size:3,data:h};f[c.NORMAL]={size:3,data:b};f[c.UV0]={size:2,data:w};return new a(f,e)},createTubeGeometry:function(a,b,c,e,f){c=c||10;e=null!=e?e:!0;p.assert(1<a.length);for(var d=[],g=[],n=0;n<c;n++){d.push([0,
-n-1,-((n+1)%c)-1]);var l=n/c*2*Math.PI;g.push([Math.cos(l)*b,Math.sin(l)*b])}return y.createPathExtrusionGeometry(g,a,[[0,0,0]],d,e,f)},createSquareTubeGeometry:function(a,b,c){c=c||!0;p.assert(1<a.length);b*=Math.SQRT2;return y.createPathExtrusionGeometry([[b,b],[-b,b],[-b,-b],[b,-b]],a,[],[[-1,-2,-3],[-3,-4,-1]],c,[[0,1],[-1,0],[0,-1],[1,0]])},createPathExtrusionGeometry:function(b,f,g,n,h,d,k){var m,q=b.length,p=new Float32Array(f.length*q*3+(6*g.length||0)),t=new Float32Array(f.length*q+(2*g.length||
0)),w=new Float32Array(f.length*q*3+(g?6:0)),r=0,x=0,u=0,y=(f.length-1)*q*6+6*n.length,E=new Uint32Array(y),y=new Uint32Array(y),V=0,P=0,I=l.create(),J=l.create(),Q=l.create(),S=l.create(),ga=l.create(),L=l.create(),R=l.create(),U=l.create(),T=l.create(),N=l.create(),Z=l.create(),H=l.create();l.set3(0,1,0,H);l.subtract(f[1],f[0],J);l.normalize(J);h?(l.add(f[0],d,Z),l.normalize(Z,Q)):l.set3(0,0,1,Q);e(J,Q,H,H,L,Q,.99619469809);l.set(Q,S);for(m=0;m<g.length;m++)l.scale(L,g[m][0],T),l.scale(Q,g[m][2],
Z),l.add(T,Z),l.add(T,f[0]),p[r++]=T[0],p[r++]=T[1],p[r++]=T[2],t[u++]=0;w[x++]=-J[0];w[x++]=-J[1];w[x++]=-J[2];for(m=0;m<n.length;m++)E[V++]=0<n[m][0]?n[m][0]:-n[m][0]-1+g.length,E[V++]=0<n[m][1]?n[m][1]:-n[m][1]-1+g.length,E[V++]=0<n[m][2]?n[m][2]:-n[m][2]-1+g.length,y[P++]=0,y[P++]=0,y[P++]=0;var O=g.length;m=g.length-1;for(var aa,ba=0;ba<f.length;ba++){aa=!1;0<ba&&(h?(l.add(f[ba],d,Z),l.normalize(Z,Q)):l.set3(0,0,1,Q),l.set(J,I),l.set(I,Z),ba<f.length-1?(l.subtract(f[ba+1],f[ba],J),l.normalize(J),
l.add(Z,J)):aa=!0,e(Z,Q,S,H,L,Q,.99619469809),l.set(Q,S));k&&(e(J,Q,S,H,U,R,.99619469809),l.set(R,ga));for(var X=0;X<q;X++)if(l.scale(L,b[X][0],T),l.scale(Q,b[X][1],Z),l.add(T,Z),k?(l.scale(U,k[X][0],N),l.scale(R,k[X][1],Z),l.add(N,Z),l.normalize(N),l.scale(N,-1)):l.normalize(T,N),w[x++]=N[0],w[x++]=N[1],w[x++]=N[2],l.add(T,f[ba]),p[r++]=T[0],p[r++]=T[1],p[r++]=T[2],t[u++]=b[X][1],!aa){var ea=(X+1)%q;E[V++]=O+X;E[V++]=O+q+X;E[V++]=O+ea;E[V++]=O+ea;E[V++]=O+q+X;E[V++]=O+q+ea;if(k)for(ea=0;6>ea;ea++)y[P++]=
O-m+X;else for(ea=0;6>ea;ea++)y[P++]=E[V-6+ea]-m}O+=q}aa=f[f.length-1];for(m=0;m<g.length;m++)l.scale(L,g[m][0],T),l.scale(Q,g[m][1],Z),l.add(T,Z),l.add(T,aa),p[r++]=T[0],p[r++]=T[1],p[r++]=T[2],t[u++]=0;b=x/3;w[x++]=J[0];w[x++]=J[1];w[x++]=J[2];q=O-q;for(m=0;m<n.length;m++)E[V++]=0<=n[m][0]?O+n[m][0]:-n[m][0]-1+q,E[V++]=0<=n[m][2]?O+n[m][2]:-n[m][2]-1+q,E[V++]=0<=n[m][1]?O+n[m][1]:-n[m][1]-1+q,y[P++]=b,y[P++]=b,y[P++]=b;n={};n[c.POSITION]=E;n[c.NORMAL]=y;E={};E[c.POSITION]={size:3,data:p};E.zOffset=
{size:1,data:t};E[c.NORMAL]={size:3,data:w};return new a(E,n)},createPolylineGeometry:function(b){p.assert(1<b.length,"createPolylineGeometry(): polyline needs at least 2 points");p.assert(3===b[0].length,"createPolylineGeometry(): malformed vertex");for(var e=new Float32Array(3*b.length),f=new Uint32Array(2*(b.length-1)),g=0,l=0,d=0;d<b.length;d++){for(var k=0;3>k;k++)e[g++]=b[d][k];0<d&&(f[l++]=d-1,f[l++]=d)}b={};g={};b[c.POSITION]=f;g[c.POSITION]={size:3,data:e};return new a(g,b,a.DefaultOffsets,
"line")},addVertexColors:function(b,e,f){var g,l,d;if(f){var k={};f=b.getVertexAttr();for(d in f)k[d]=f[d];b=b.getFaces();f=Array(b.length);for(l=0;l<b.length;l++){g={};for(d in b[l].indices)g[d]=b[l].indices[d];f[l]={type:b[l].type,indices:g,positionKey:b[l].positionKey}}b=new a(f,k)}e=e||[1,1,1,1];d=new Uint8Array(4);d[0]=255*e[0];d[1]=255*e[1];d[2]=255*e[2];d[3]=255*(3<e.length?e[3]:1);b.getVertexAttr()[c.COLOR]={size:4,data:d};f=b.getFaces();for(l=0;l<f.length;l++)e=f[l],g=new Uint32Array(e.indices[e.positionKey].length),
e.indices[c.COLOR]=g;return b},addNormals:function(a){var b=a.getVertexAttr();a=a.getFaces();for(var c=h.Vec3Compact.subtract,e=a.map(.reduce(,e=new Float32Array(3*e),f=b.position.data,d=0,k=0;k<a.length;k++){for(var l=a[k].indices.position,m=new Uint32Array(l.length),p=0;p<l.length;p+=3){c(f,3*l[p],f,3*l[p+2],x,0);c(f,3*l[p],f,3*l[p+1],q,0);g.cross(q,x);g.normalize(q);var t=d/3;e[d++]=q[0];e[d++]=q[1];e[d++]=q[2];m[p]=t;m[p+
1]=t;m[p+2]=t}a[k].indices.normal=m}b.normal={size:3,data:e}},cgToGIS:function(a){var b=a.getVertexAttr();a=b.position.data;var b=b.normal.data,c,e;if(b)for(c=0;c<b.length;c+=3)e=b[c+1],b[c+1]=-b[c+2],b[c+2]=e;if(a)for(c=0;c<a.length;c+=3)e=a[c+1],a[c+1]=-a[c+2],a[c+2]=e}};return y})},"esri/views/3d/webgl-engine/lib/GeometryData":function(){define(["require","exports","./Util","./ComponentUtils"],function(a,h,p,m){function f(a,b){var c=a.reduce(function(a,c){c=c.indices[b];return a+(null==c?0:c.length)},
0),e=new Uint32Array(c),f=0,g=0;a.forEach(function(a){var c=a.indices[b];if(null!=c){var n=c.length,l=c.byteLength;e.set(c,f);a.indices[b]=new Uint32Array(e.buffer,g,n);f+=n;g+=l}});return e}function e(a){var b={},c;c=p.getFirstObjectValue(a);c=c.data.length/c.size;if(c>l||null==g){for(;c>l;)l*=2;g=new Uint32Array(l);for(var e=0;e<l;e++)g[e]=e}c=new Uint32Array(g.buffer,0,c);for(var f in a)b[f]=c;return b}a=function(){function a(b,c,g,l){void 0===c&&(c=a.DefaultIndices);void 0===g&&(g=a.DefaultOffsets);
void 0===l&&(l="triangle");var h=[],q={},r={},n=Array.isArray(b);n?(h=b,r=c):(r=b,q=c,q===a.DefaultIndices&&(q=e(r)));if(n)if(1<h.length&&(g=h.map(,g.push(h[h.length-1].componentRange[1]+1),g=new Uint32Array(g)),1===h.length){c=h[0];for(var w in r)b=c.indices,q[w]=b[w]}else for(w in r)q[w]=f(h,w);else{b=p.getFirstObjectValue(q).length;n=c=void 0;g===a.DefaultOffsets?(c=0,n=b):(c=g[0],n=g[g.length-1]);var d=n-c,k=c*Uint32Array.BYTES_PER_ELEMENT;b={};for(w in q)b[w]=
new Uint32Array(q[w].buffer,k,d);h.push({type:l,positionKey:"position",indices:b,componentRange:[c,n-1]})}this._id=a.getNewId();this._faces=h;this._vertexAttributes=r;this._indices=q;this._componentOffsets=m.createOffsets(g);this._primitiveType=l}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"faces",{get:function(){return this._faces},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexAttributes",
{get:function(){return this._vertexAttributes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indices",{get:function(){return this._indices},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"componentOffsets",{get:function(){return this._componentOffsets},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexCount",{get:enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"positionKey",
{get:function(){return"position"},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"primitiveType",{get:function(){return this._primitiveType},enumerable:!0,configurable:!0});a.prototype.toRenderData=function(){return{id:this._id.toString(),faces:this._faces[0],vertexAttr:this._vertexAttributes}};a.prototype.estimateGpuMemoryUsage=function(){var a=0;this._indices.position&&(a+=12*this._indices.position.length);this._indices.normal&&(a+=12*this._indices.normal.length);this._indices.uv0&&
(a+=8*this._indices.uv0.length);this._indices.color&&(a+=4*this._indices.color.length);return a};a.prototype.getId=function(){return this.id};a.prototype.getFaces=function(){return this.faces};a.prototype.getVertexAttr=function(){return this.vertexAttributes};a.getNewId=return a}();a._id=0;a.AxisOrder={CG:0,GIS:1};a.DefaultIndices={};a.DefaultOffsets=new Uint32Array(0);var l=1,g=null;return a})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("require exports ./IdGen ./Util ./DDSUtil ./gl-matrix ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/Util ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t){function u(a,b,c,e,f,n,l){l=!1!==l;var d=new Image;d.onerror=function(){n(null);d.onerror=void 0;d.onload=void 0};d.onload=function(){m.assert(1<=d.width&&1<=d.height);c.samplingMode=l?9987:9729;c.hasMipmap=l;if(m.isPowerOfTwo(d.width)&&m.isPowerOfTwo(d.height))c.width=d.width,c.height=d.height,b=new g(a,c,d);else var b=r(a,d,c,e,f);a.bindTexture(b);n(b);d.onerror=void 0;d.onload=void 0};d.src=b}function r(a,d,e,f,h){var k=m.nextHighestPowerOfTwo(d.width),p=m.nextHighestPowerOfTwo(d.height);
m.assert(k!==d.width||p!==d.height);e.width=k;e.height=p;var w=new g(a,e),r=l.createWithAttachments(a,w,{colorTarget:0,depthStencilTarget:0});d=new g(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,maxAnisotropy:8},d);a.bindFramebuffer(r);void 0===h&&(h=a.getViewport(),h=[h.x,h.y,h.width,h.height]);a.setViewport(0,0,k,p);f=f.get("texOnly");k=n.identity();a.bindProgram(f);f.setUniformMatrix4fv("model",k);f.setUniformMatrix4fv("view",k);f.setUniformMatrix4fv("proj",
k);f.setUniform4fv("color",new Float32Array([1,1,1,1]));f.setUniform1i("tex",0);f=new b(a,t.Default3D,{geometry:y.Pos3Tex},{geometry:q.createVertex(a,35044,m.createQuadVertexUvBuffer())});a.bindTexture(d,0);a.bindVAO(f);a.setDepthTestEnabled(!1);a.setBlendingEnabled(!1);a.drawArrays(5,0,c.vertexCount(f,"geometry"));a.setDepthTestEnabled(!0);a.bindFramebuffer(null);a.setViewport(h[0],h[1],h[2],h[3]);f.dispose(!0);d.dispose();a.bindFramebuffer(null);r.detachColorTexture();r.dispose();e.hasMipmap&&w.generateMipmap();
return w}var n=e.mat4d;a=function(){function a(b,c,e){this.data=b;this.id=a.idGen.gen(c);this.unloadFunc=void 0;this.params=e||{};this.params.wrapClamp=this.params.wrapClamp||!1;this.params.mipmap=!1!==this.params.mipmap;this.params.noUnpackFlip=this.params.noUnpackFlip||!1;this.estimatedTexMemRequiredMB=a.estimateTexMemRequiredMB(this.data,this.params)}a.estimateTexMemRequiredMB=function(a,b){return null==a?0:a instanceof ArrayBuffer||a instanceof Uint8Array?a.byteLength/1E6:a instanceof Image||
a instanceof ImageData||a instanceof HTMLCanvasElement?1.3*a.width*a.height*4/1E6:1.3*b.width*b.height*4/1E6||0};a.prototype.getId=function(){return this.id};a.prototype.getEstimatedTexMemRequiredMB=function(){return this.estimatedTexMemRequiredMB};a.prototype.dispose=a.prototype.deferredLoading=a.prototype.getWidth=function(){return this.params.width};a.prototype.getHeight=function(){return this.params.height};a.prototype.initializeThroughUpload=
function(b,c,e,n,l){var d=this.data;c.flipped=!this.params.noUnpackFlip;c.samplingMode=this.params.mipmap?9987:9729;c.hasMipmap=this.params.mipmap;if("string"===typeof d)u(b,d,c,e,n,l,this.params.mipmap);else if(d instanceof Image||d instanceof ImageData||d instanceof HTMLCanvasElement)this.params.width=d.width,this.params.height=d.height,!this.params.mipmap&&this.params.wrapClamp||m.isPowerOfTwo(d.width)&&m.isPowerOfTwo(d.height)?(c.width=d.width,c.height=d.height,c=new g(b,c,d)):c=r(b,d,c,e,n),
b.bindTexture(c),l(c);else if(d instanceof ArrayBuffer&&this.params.encoding===a.DDS_ENCODING)c=f.createDDSTexture(b,c,d,this.params.mipmap),b.bindTexture(c),l(c);else if(d instanceof Uint8Array&&this.params.encoding===a.DDS_ENCODING)c=f.createDDSTexture(b,c,d.buffer,this.params.mipmap),b.bindTexture(c),l(c);else if(d instanceof Uint8Array)m.assert(0<this.params.width&&0<this.params.height),c.pixelFormat=1===this.params.components?6409:6408,c.width=this.params.width,c.height=this.params.height,c=
new g(b,c,d),b.bindTexture(c),l(c);else if(null!==d)throw console.warn("Unsupported image data"),Error("Unsupported image data");this.data=void 0};a.prototype.setUnloadFunc=function(a){this.unloadFunc=a};a.prototype.unload=function(){void 0!==this.unloadFunc&&(this.unloadFunc(this.id),this.unloadFunc=void 0)};return a}();a.idGen=new p;a.DDS_ENCODING="image/vnd-ms.dds";return a})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["require","exports","../../../webgl/Texture","../../../webgl/enums"],
function(a,h,p,m){function f(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}var e=f("DXT1"),l=f("DXT3"),g=f("DXT5");h.createDDSTexture=function(a,b,f,h){var c=new Int32Array(f,0,31);if(542327876!==c[0])return console.error("Invalid magic number in DDS header"),null;if(!(c[20]&4))return console.error("Unsupported format, must contain a FourCC code"),null;var m=c[21],q;switch(m){case e:m=8;q=33776;break;case l:m=16;q=33778;break;case g:m=16;q=33779;break;
default:return console.error("Unsupported FourCC code:",String.fromCharCode(m&255,m>>8&255,m>>16&255,m>>24&255)),null}var r=1;c[2]&131072&&!1!==h&&(r=Math.max(1,c[7]));h=c[4];var n=c[3],w=c[1]+4,d,k;b.samplingMode=1<r?9987:9729;b.hasMipmap=1<r;b.width=c[4];b.height=c[3];b=new p(a,b);a.bindTexture(b);for(c=0;;++c){c<r&&(k=Math.floor((h+3)/4)*Math.floor((n+3)/4)*m,d=new Uint8Array(f,w,k));a.gl.compressedTexImage2D(a.gl.TEXTURE_2D,c,q,h,n,0,d);w+=k;if(1===h&&1===n||1===r)break;h=Math.max(1,h>>1);n=Math.max(1,
n>>1)}return b}})},"esri/symbols/ObjectSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/promiseUtils ../core/Error ./Symbol3DLayer ./support/Symbol3DMaterial ./support/Symbol3DResource ../views/3d/support/aaBoundingBox ../views/3d/layers/graphics/Graphics3DObjectSymbolLayer ../views/3d/layers/graphics/objectResourceUtils ../core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y){a=t=function(a){function c(b){b=
a.call(this)||this;b.material=null;b.resource=null;b.type="Object";b.width=void 0;b.height=void 0;b.depth=void 0;b.anchor=void 0;b.heading=void 0;return b}p(c,a);c.prototype.computeResourceSize=c.prototype.computeSize=c.prototype.computeSizeWithResourceSize=function(a){if(null==this.width&&null==this.height&&
null==this.depth){var b=this._isPrimitive()?10:1;return[b*a[0],b*a[1],b*a[2]]}for(var b=[this.width,this.depth,this.height],d,c=0;3>c;c++){var e=b[c];if(null!=e){d=e/a[c];break}}for(c=0;3>c;c++)null==b[c]&&(b[c]=a[c]*d);return b};c.prototype.clone=function(){return new t({heading:this.heading,anchor:this.anchor,depth:this.depth,enabled:this.enabled,height:this.height,material:this.material&&this.material.clone(),resource:this.resource&&this.resource.clone(),width:this.width})};c.prototype._fetchBoundingBox=
function(){var a=this;if(this._isPrimitive()){var b=q.PRIMITIVE_BOUNDING_BOX[this.resource.primitive];return b?f.resolve(b):f.reject(new e("symbol:invalid-resource","The symbol does not have a valid resource"))}var d=this.resource.href;return d===this._cachedResourceUrl?f.resolve(this._cachedResourceBoundingBox):x.fetch(d).then(function(b){a._cachedResourceBoundingBox=x.computeBoundingBox(b);a._cachedResourceUrl=d;return a._cachedResourceBoundingBox})};c.prototype._isPrimitive=function(){return!this.resource||
"string"!==typeof this.resource.href};return c}(y.declared(l));m([y.property({type:g.default})],a.prototype,"material",void 0);m([y.property({type:c.default,json:{write:!0}})],a.prototype,"resource",void 0);m([y.property()],a.prototype,"type",void 0);m([y.property({json:{write:!0}})],a.prototype,"width",void 0);m([y.property({json:{write:!0}})],a.prototype,"height",void 0);m([y.property({json:{write:!0}})],a.prototype,"depth",void 0);m([y.property({json:{write:!0}})],a.prototype,"anchor",void 0);
m([y.property({json:{write:!0}})],a.prototype,"heading",void 0);a=t=m([y.subclass("esri.symbols.ObjectSymbol3DLayer")],a);var t;return a})},"esri/views/3d/layers/graphics/Graphics3DObjectSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang ../../../../Color ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./graphicUtils ./FastSymbolUpdates ./objectResourceUtils ../../lib/glMatrix ../../support/aaBoundingBox ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material ../../webgl-engine/materials/internal/MaterialUtil".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d){var k=y.mat4d,v=y.vec3d,A=[1,1,1],z=[1,1,1,1],D=[0,0,0];a=[-.5,-.5,-.5,.5,.5,.5];h=[-.5,-.5,0,.5,.5,1];var B={sphere:a,cube:a,cylinder:h,cone:h,"inverted-cone":h,tetrahedron:[-.5,-.5,0,.5,.5,.5],diamond:a},C=[u.ModelContentType.MATERIAL,u.ModelContentType.TEXTURE,u.ModelContentType.GEOMETRY];e=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}p(e,a);e.prototype._prepareResources=function(){var a=this.symbol,b=this._getStageIdHint();
a.resource&&a.resource.href?this._prepareModelResources(a.resource.href,b):this._preparePrimitiveResources(a.resource?a.resource.primitive:"sphere",b)};e.prototype._preparePrimitiveResources=function(a,b){var c=this.symbol;if("sphere"===a)this._geometryData=n.createPolySphereGeometry(.5,2,!0);else if("cube"===a)this._geometryData=n.createBoxGeometry(1);else if("cylinder"===a)this._geometryData=n.createCylinderGeometry(1,.5,32,[0,0,1],[0,0,.5]);else if("cone"===a)0>c.height?(this._geometryData=n.createConeGeometry(1,
.5,15,!0),c.height=-c.height):this._geometryData=n.createConeGeometry(1,.5,15,!1),n.cgToGIS(this._geometryData);else if("inverted-cone"===a)this._geometryData=n.createConeGeometry(1,.5,15,!0),n.cgToGIS(this._geometryData);else if("tetrahedron"===a)this._geometryData=n.createTetrahedronGeometry(1),n.cgToGIS(this._geometryData);else if("diamond"===a)this._geometryData=n.createDiamondGeometry(1),n.cgToGIS(this._geometryData);else{console.warn("Unknown object symbol primitive: "+a);this.reject();return}this._geometry=
new r(this._geometryData,b);this._context.stage.add(u.ModelContentType.GEOMETRY,this._geometry);this._resourceBoundingBox=B[a];this._resourceSize=t.size(this._resourceBoundingBox);this._symbolSize=c.computeSizeWithResourceSize(this._resourceSize);a=this._getMaterialOpacity();a={specular:[0,0,0],shininess:3,opacity:a,transparent:1>a||this._isPropertyDriven("opacity"),instanced:["transformation"],ambient:A,diffuse:A};if(this._isPropertyDriven("color"))a.externalColor=z;else{var e=c.material?f.toUnitRGBA(c.material.color):
z;a.externalColor=e}c.material&&c.material.colorMixMode&&(a.externalColorMixMode=d.externalColorMixModes[c.material.colorMixMode]);this._fastUpdates=q.initFastSymbolUpdatesState(this._context.renderer,this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());this._fastUpdates.enabled?(m.mixin(a,this._fastUpdates.materialParameters),a.instanced.push("featureAttribute")):this._hasPerInstanceColor()&&a.instanced.push("color");this._material=new w(a,b+"_objectmat");this._context.stage.add(u.ModelContentType.MATERIAL,
this._material);this.resolve()};e.prototype._prepareModelResources=function(a,b){var d=this;b={materialParamsMixin:{instanced:["transformation"]},bakeTransformations:!0,idHint:b,streamDataSupplier:this._context.streamDataSupplier};this._fastUpdates=q.initFastSymbolUpdatesState(this._context.renderer,this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());this._fastUpdates.enabled?(m.mixin(b.materialParamsMixin,this._fastUpdates.materialParameters),b.materialParamsMixin.instanced.push("featureAttribute")):
this._hasPerInstanceColor()&&b.materialParamsMixin.instanced.push("color");this._symbolLoaderPromise=x.fetch(a,b);this._symbolLoaderPromise.then(function(a){d._symbolLoaderPromise=null;if(!d.isRejected()){var b=a.stageResources,c=d._context.stage,e=d._computeModelColorOverride(d.symbol.material),f=d._computeModelOpacityOverride(),g=b[u.ModelContentType.MATERIAL];a.originalMaterialOpacities=Array(g.length);g.forEach(function(b,d){var c=b.getParameterValues();a.originalMaterialOpacities[d]=c.opacity;
e&&b.setParameterValues(e);null!=f.overwrite?b.setParameterValues({opacity:f.overwrite,transparent:f.blendingRequired}):null!=f.multiply&&(c.opacity*=f.multiply,c.transparent=1>c.opacity,b.setParameterValues({opacity:c.opacity,transparent:c.transparent}))});C.forEach(function(a){for(var d=b[a],e=0;d&&e<d.length;e++)c.add(a,d[e])});d._resourceBoundingBox=x.computeBoundingBox(a);d._resourceSize=t.size(d._resourceBoundingBox);d._pivotOffset=a.pivotOffset;d._symbolSize=d.symbol.computeSizeWithResourceSize(d._resourceSize);
d._i3sModel=a;q.updateFastSymbolUpdatesState(d._fastUpdates,d._context.renderer,d._fastVisualVariableConvertOptions())&&g.forEach(;d.resolve()}},};e.prototype._forEachMaterial=function(a){this._i3sModel?this._i3sModel.stageResources[u.ModelContentType.MATERIAL].forEach(a):a(this._material)};e.prototype._computeModelOpacityOverride=function(){var a={overwrite:null,
blendingRequired:!1,multiply:null},b=this._getMaterialOpacity();this._isPropertyDriven("opacity")?(a.overwrite=b,a.blendingRequired=!0):this.symbol.material&&void 0!==this.symbol.material.transparency?(a.overwrite=b,a.blendingRequired=1>a.overwrite):1>b&&(a.multiply=b,a.blendingRequired=!0);return a};e.prototype._computeModelColorOverride=function(a){var b={};a&&a.colorMixMode&&(b.externalColorMixMode=d.externalColorMixModes[a.colorMixMode]);this._isPropertyDriven("color")?b.externalColor=z:a&&a.color?
b.externalColor=f.toUnitRGBA(a.color):(b.externalColor=z,b.externalColorMixMode=d.externalColorMixModes.ignore);return b};e.prototype.destroy=function(){this.isFulfilled()||this.reject();this._symbolLoaderPromise&&this._symbolLoaderPromise.cancel();var a=this._context.stage;if(this._i3sModel){var b=this._i3sModel.stageResources;C.forEach(function(d){for(var c=b[d],e=0;c&&e<c.length;e++)a.remove(d,c[e].getId())})}else this._material&&a.remove(u.ModelContentType.MATERIAL,this._material.getId()),this._geometry&&
a.remove(u.ModelContentType.GEOMETRY,this._geometry.getId())};e.prototype._getGeometry=function(a){a=a.geometry;return"polyline"===a.type?c.placePointOnPolyline(a):"polygon"===a.type?c.placePointOnPolygon(a):"extent"===a.type?a.center:"point"!==a.type?(this._logWarning("unsupported geometry type for object symbol: "+a.type),null):a};e.prototype.createGraphics3DGraphic=function(a,b){var d=this._getGeometry(a);if(null===d)return null;var c="graphic"+a.uid,e=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,
d,b,e,c,a.uid)};e.prototype.layerPropertyChanged=function(a,b,d){var e=this;if("opacity"===a){if(this._i3sModel){var f=this._computeModelOpacityOverride();this._i3sModel.stageResources[u.ModelContentType.MATERIAL].forEach(function(a,b){null!=f.overwrite?a.setParameterValues({opacity:f.overwrite,transparent:f.blendingRequired}):(b=e._i3sModel.originalMaterialOpacities[b],null!=f.multiply&&(b*=f.multiply),a.setParameterValues({opacity:b,transparent:1>b}))})}else b=this._getMaterialOpacity(),this._material.setParameterValues({opacity:b,
transparent:1>b||this._isPropertyDriven("opacity")});return!0}if("elevationInfo"===a){this._updateElevationInfo();a=this._context.elevationProvider;var k=this._context.renderCoordsHelper,n=g.perObjectElevationAligner,h=c.ELEV_MODES.ABSOLUTE_HEIGHT,m;for(m in b){var q=b[m],p=q._graphics[d];p&&p instanceof l&&(q=this._getGraphicElevationInfo(q.graphic),p.elevationAligner=q.mode!==h?n:null,p.elevationInfo.set(q),n(p,a,k))}return!0}return!1};e.prototype.applyRendererDiff=function(a,b,d,c){var e=this,
f;for(f in a.diff)switch(f){case "visualVariables":if(q.updateFastSymbolUpdatesState(this._fastUpdates,b,this._fastVisualVariableConvertOptions()))this._forEachMaterial(function(a){return a.setParameterValues(e._fastUpdates.materialParameters)});else return!1;break;default:return!1}return!0};e.prototype._createAs3DShape=function(a,d,e,f,n,h){var m=this,p=null,t=null;if(a=this._getFastUpdateAttrValues(a))p=p||{},p.featureAttribute=a,t=!this._fastUpdates.enabled&&this._hasPerInstanceColor()&&(p=p||{},p.color=b.mixinColorAndOpacity(e.color,e.opacity));var w=this._context.layer.id;a=k.identity();this._applyObjectRotation(e,this.symbol,a);this._applyObjectScale(e,a);this._applyAnchor(a);if(this._i3sModel){e=this._i3sModel.stageResources[u.ModelContentType.GEOMETRY];var r=this._i3sModel.materialsByComponent;n=c.createStageObjectForPoint.call(this,d,null,null,null,null,f,n,w,h);if(null===n)return null;for(h=0;h<
e.length;h++)n.object.addGeometry(e[h],r[h],a,p,null,t)}else n=c.createStageObjectForPoint.call(this,d,[this._geometry],[[this._material]],[a],p,f,n,w,h,null,t);if(null===n)return null;if(this._fastUpdates.enabled){var x=q.getMaterialParams(this._fastUpdates.visualVariables,this._fastVisualVariableConvertOptions());this._forEachMaterial(function(a){return a.setParameterValues(x)})}n.object.setCastShadow(!0);t=null;f.mode!==c.ELEV_MODES.ABSOLUTE_HEIGHT&&(t=g.perObjectElevationAligner);f=new l(this,
n.object,null,null,null,t,f,l.VisibilityModes.REMOVE_OBJECT);f.alignedTerrainElevation=n.terrainElevation;c.extendPointGraphicElevationInfo(f,d,this._context.elevationProvider);return f};e.prototype._computeObjectScale=function(a){var b=Array(3),d=this._isPropertyDriven("size")&&a&&a.size?a.size:this._symbolSize,c,e=0;for(a=2;0<=a;a--){var f=d[a],g=void 0;if(null!=f&&isFinite(f))g=f/this._resourceSize[a];else if("symbolValue"===f||0===a&&!c)g=this._symbolSize[a]/this._resourceSize[a];null!=g&&(c=
b[a]=g,e=Math.max(e,Math.abs(g)))}for(a=2;0<=a;a--)null==b[a]?b[a]=c:0===b[a]&&(b[a]=.001*e);c=this._context.renderCoordsHelper.unitInMeters;for(a=2;0<=a;a--)b[a]/=c;return b};e.prototype._applyObjectScale=function(a,b){this._fastUpdates.enabled&&this._fastUpdates.customTransformation||(a=this._computeObjectScale(a),1===a[0]&&1===a[1]&&1===a[2]||k.scale(b,a))};e.prototype._applyObjectRotation=function(a,b,d){if(!this._fastUpdates.enabled||!this._fastUpdates.customTransformation)return a=(a.rotationAngle||
0)+(b.heading||0),0!==a?k.rotateZ(d,-a/180*Math.PI,d):null};e.prototype._computeAnchor=function(){switch(this.symbol.anchor){case "center":return v.scale(t.center(this._resourceBoundingBox),-1);case "bottom":var a=t.center(this._resourceBoundingBox);return[-a[0],-a[1],-this._resourceBoundingBox[2]];default:return this._pivotOffset?v.scale(this._pivotOffset,-1,Array(3)):D}};e.prototype._applyAnchor=function(a){if(!this._fastUpdates.enabled||!this._fastUpdates.customTransformation){var b=this._computeAnchor();
b&&k.translate(a,b)}};e.prototype._hasPerInstanceColor=e.prototype._supportsShaderVisualVariables=function(){return this._context.stage.has("angleInstancedArrays")?!0:!1};e.prototype._fastVisualVariableConvertOptions=function(){var a=this._resourceBoundingBox?t.size(this._resourceBoundingBox):A,b=this._resourceBoundingBox?this._computeAnchor():D;return{modelSize:a,symbolSize:this._symbolSize||A,unitInMeters:this._context.renderCoordsHelper.unitInMeters,
transformation:{anchor:b,scale:this._symbolSize&&this._resourceSize?this._computeObjectScale():A,rotation:this.symbol.heading||0}}};return e}(e);e.PRIMITIVE_BOUNDING_BOX=B;return e})},"esri/views/3d/layers/graphics/objectResourceUtils":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang dojo/Deferred ../../../../request ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/materials/internal/MaterialUtil ../../webgl-engine/lib/Texture ../../support/aaBoundingBox".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u){function r(a,c){var e=[],f=[],l=[],h=[],p=[],r=[],u="meshsymbol_"+a.model.name,z=a.textureDefinitions,D={},B;for(B in z){var S=z[B],ga=S.images[0].data;A(ga,"symbol resources must have embedded texture data (at the moment)");var L="/textureDefinitions/"+B,ga=new t(S.encoding+";base64,"+ga,u,{noUnpackFlip:!0});p.push(ga);D[L]={engineTexObj:ga,transparent:"rgba"===S.channels}}z=a.model.geometries;B=a.materialDefinitions;for(S=0;S<z.length;S++){L=z[S];if(!L.params.components){var ga=
L,R=ga.params;A(R.material);R.components=[{id:1,material:ga.params.material,texture:ga.params.texture,region:ga.params.texture}];R.faces&&(R.faces.componentIndices=[R.faces.position.count])}var ga=L.params.components,U=ga.length,R=L.params.faces,T=L.params.vertexAttributes,N=L.params.topology||"Indexed",Z={},H;for(H in T){var O=T[H],aa=O.values;A(O.values,"symbol resources with external geometry bin not yet supported");if(c.bakeTransformations){if("position"===H){var ba=L.transformation,aa=aa.slice(0);
d(aa,3,0,aa.length,w,ba)}if("normal"===H){ba=v.create();aa=aa.slice(0);var X=ba,ea=L.transformation,la=ea[0],ta=ea[1],ma=ea[2],wa=ea[3],na=ea[4],sa=ea[5],Ea=ea[6],pa=ea[7],qa=ea[8],ua=ea[9],va=ea[10],Ca=ea[11],Fa=ea[12],Aa=ea[13],W=ea[14],ea=ea[15],Ka=la*sa-ta*na,Ra=la*Ea-ma*na,Ua=la*pa-wa*na,La=ta*Ea-ma*sa,Sa=ta*pa-wa*sa,da=ma*pa-wa*Ea,Ja=qa*Aa-ua*Fa,za=qa*W-va*Fa,qa=qa*ea-Ca*Fa,ja=ua*W-va*Aa,ua=ua*ea-Ca*Aa,va=va*ea-Ca*W;if(Ca=Ka*va-Ra*ua+Ua*ja+La*qa-Sa*za+da*Ja)Ca=1/Ca,X[0]=(sa*va-Ea*ua+pa*ja)*
Ca,X[1]=(Ea*qa-na*va-pa*za)*Ca,X[2]=(na*ua-sa*qa+pa*Ja)*Ca,X[3]=(ma*ua-ta*va-wa*ja)*Ca,X[4]=(la*va-ma*qa+wa*za)*Ca,X[5]=(ta*qa-la*ua-wa*Ja)*Ca,X[6]=(Aa*da-W*Sa+ea*La)*Ca,X[7]=(W*Ua-Fa*da-ea*Ra)*Ca,X[8]=(Fa*Sa-Aa*Ua+ea*Ka)*Ca;d(aa,3,0,aa.length,n,ba)}}Z[H]={data:aa,size:O.valuesPerElement}}T=void 0;O=Array(U);if("Indexed"===N){var T=R.componentIndices,Qa;for(Qa in R);}else"PerAttributeArray"!==N?console.warn("I3S symbol loader: unsupported topology type "+N):1!==U&&console.warn("I3S symbol loader: if topology is not Indexed, only single component geometries are supported");
l.push([]);for(U=0;U<ga.length;U++){N=ga[U];aa={type:"triangle",positionKey:"position",indices:{}};if(T)for(var xa in R)"componentIndices"!==xa&&(ba=R[xa],A(ba.values,"symbol resources with external geometry bin not yet supported"),aa.indices[xa]=new Uint32Array(ba.values));else{ba=Z.position.data.length/Z.position.size;X=new Uint32Array(ba);for(la=0;la<ba;la++)X[la]=la;var ba=X,ra;for(ra in Z)aa.indices[ra]=ba}O[U]=aa;aa=void 0;N.texture&&(aa=D[N.texture].engineTexObj.getId());ba=h[N.material]?h[N.material][N.texture]:
null;ba||(ba=N.material.substring(N.material.lastIndexOf("/")+1),ba=B[ba].params,1===ba.transparency&&(ba.transparency=0),aa={ambient:ba.diffuse,diffuse:ba.diffuse,specular:ba.specular,shininess:ba.shininess,opacity:1-ba.transparency,transparent:0<ba.transparency,textureId:aa,doubleSided:!0,cullFace:"none",flipV:!1,externalColorMixMode:y.externalColorMixModes[ba.externalColorMixMode||"tint"]},c.materialParamsMixin&&m.mixin(aa,c.materialParamsMixin),ba=new x(aa,u),h[N.material]||(h[N.material]={}),
h[N.material][N.texture]=ba,f.push(ba));l[S].push(ba)}ga=new b(new q(O,Z),u);L=k.create(L.transformation);c.bakeTransformations&&k.identity(L);e.push(ga);r.push(L)}return{stageResources:(Pa={},Pa[g.ModelContentType.TEXTURE]=p,Pa[g.ModelContentType.MATERIAL]=f,Pa[g.ModelContentType.GEOMETRY]=e,Pa),geometryTransformations:r,materialsByComponent:l,pivotOffset:a.model.pivotOffset};var Pa}function n(a,b,d){var c=b[0],e=b[1];b=b[2];a[0]=c*d[0]+e*d[3]+b*d[6];a[1]=c*d[1]+e*d[4]+b*d[7];a[2]=c*d[2]+e*d[5]+
b*d[8];return a}function w(a,b,d){var c=b[0],e=b[1];b=b[2];var f=d[3]*c+d[7]*e+d[11]*b+d[15]||1;a[0]=(d[0]*c+d[4]*e+d[8]*b+d[12])/f;a[1]=(d[1]*c+d[5]*e+d[9]*b+d[13])/f;a[2]=(d[2]*c+d[6]*e+d[10]*b+d[14])/f;return a}function d(a,b,d,c,e,f){b||(b=3);d||(d=0);c=c?Math.min(c*b+d,a.length):a.length;for(var g=z;d<c;d+=b)g[0]=a[d],g[1]=a[d+1],g[2]=a[d+2],e(g,g,f),a[d]=g[0],a[d+1]=g[1],a[d+2]=g[2];return a}var k=l.mat4d,v=l.mat3d;a=l.vec3d;var A=c.assert;h.fetch=function(a,b){b=b||{};if(b.streamDataSupplier){var d=
b.streamDataSupplier.request(a,"json"),c=new f(function(){return b.streamDataSupplier.cancelRequest(d)});d.then(function(a,d){a=r(d,b);c.resolve(a)},function(){c.reject()});return c.promise}var g=e(a),k=new f(function(){return g.cancel()});g.then(function(a){a=r(a.data,b);k.resolve(a)},function(){k.reject()});return k.promise};h.computeBoundingBox=function(a){var b=a.stageResources[g.ModelContentType.GEOMETRY];a=a.geometryTransformations;for(var d=u.create(u.NEGATIVE_INFINITY),c=[0,0,0],e=[0,0,0],
f=0;f<b.length;f++)for(var n=b[f],l=n.getNumGroups(),h=0;h<l;++h){var m=n.getBoundingInfo(h);k.multiplyVec3(a[f],m.getBBMin(),c);k.multiplyVec3(a[f],m.getBBMax(),e);for(m=0;3>m;++m){if(c[m]>e[m]){var q=c[m];c[m]=e[m];e[m]=q}d[m]=Math.min(d[m],c[m]);d[m+3]=Math.max(d[m+3],e[m])}}return d};h.createStageResources=r;var z=a.create()})},"esri/symbols/LineSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/screenUtils ./Symbol3DLayer ../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l){a=g=function(a){function b(b){b=a.call(this)||this;b.material=null;b.type="Line";b.size=1;return b}p(b,a);b.prototype.clone=function(){return new g({enabled:this.enabled,material:this.material&&this.material.clone(),size:this.size})};return b}(l.declared(e));m([l.property()],a.prototype,"material",void 0);m([l.property()],a.prototype,"type",void 0);m([l.property({json:{write:!0}}),l.cast(f.toPt)],a.prototype,"size",void 0);a=g=m([l.subclass("esri.symbols.LineSymbol3DLayer")],
a);var g;return a})},"esri/symbols/PathSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Symbol3DLayer ../core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e){a=l=function(a){function c(b){b=a.call(this)||this;b.material=null;b.type="Path";b.size=void 0;return b}p(c,a);c.prototype.readSize=c.prototype.clone=function(){return new l({enabled:this.enabled,material:this.material&&
this.material.clone(),size:this.size})};return c}(e.declared(f));m([e.property()],a.prototype,"material",void 0);m([e.property()],a.prototype,"type",void 0);m([e.property({json:{write:!0}})],a.prototype,"size",void 0);m([e.reader("size",["size","width"])],a.prototype,"readSize",null);a=l=m([e.subclass("esri.symbols.PathSymbol3DLayer")],a);var l;return a})},"esri/symbols/FillSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Symbol3DLayer ./support/Symbol3DOutline ../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l){a=g=function(a){function b(b){b=a.call(this)||this;b.type="Fill";b.material=null;b.outline=null;return b}p(b,a);b.prototype.clone=function(){return new g({enabled:this.enabled,material:this.material&&this.material.clone(),outline:this.outline&&this.outline.clone()})};return b}(l.declared(f));m([l.property()],a.prototype,"type",void 0);m([l.property()],a.prototype,"material",void 0);m([l.property({type:e.default,json:{write:!0}})],a.prototype,"outline",void 0);a=g=m([l.subclass("esri.symbols.FillSymbol3DLayer")],
a);var g;return a})},"esri/symbols/ExtrudeSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Symbol3DLayer ../core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e){a=l=function(a){function c(b){b=a.call(this)||this;b.type="Extrude";b.size=void 0;b.material=null;return b}p(c,a);c.prototype.clone=function(){return new l({enabled:this.enabled,material:this.material&&this.material.clone(),size:this.size})};return c}(e.declared(f));
m([e.property()],a.prototype,"type",void 0);m([e.property({json:{write:!0}})],a.prototype,"size",void 0);m([e.property()],a.prototype,"material",void 0);a=l=m([e.subclass("esri.symbols.ExtrudeSymbol3DLayer")],a);var l;return a})},"esri/symbols/TextSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang ../core/screenUtils ./Symbol3DLayer ../core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e,l,g){a=c=function(a){function b(b){b=
a.call(this)||this;b.font=null;b.material=null;b.size=void 0;b.text=void 0;b.type="Text";return b}p(b,a);b.prototype.writeFont=b.prototype.clone=function(){return new c({enabled:this.enabled,font:this.font&&f.clone(this.font),material:this.material&&this.material.clone(),size:this.size,text:this.text})};return b}(g.declared(l));m([g.property()],a.prototype,"font",void 0);m([g.writer("font")],a.prototype,"writeFont",null);m([g.property()],a.prototype,"material",
void 0);m([g.property({json:{write:!0}}),g.cast(e.toPt)],a.prototype,"size",void 0);m([g.property({json:{write:!0}})],a.prototype,"text",void 0);m([g.property()],a.prototype,"type",void 0);a=c=m([g.subclass("esri.symbols.TextSymbol3DLayer")],a);var c;return a})},"esri/symbols/support/Thumbnail":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor".split(" "),function(a,h,p,m,f,e){a=
l=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}p(c,a);c.prototype.clone=function(){return new l({url:this.url})};return c}(f.declared(e));m([f.property({type:String})],a.prototype,"url",void 0);a=l=m([f.subclass("esri.symbols.support.Thumbnail")],a);h.Thumbnail=a;Object.defineProperty(h,"__esModule",{value:!0});h.default=a;var l})},"esri/symbols/support/StyleOrigin":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../portal/Portal".split(" "),
function(a,h,p,m,f,e,l){a=g=function(a){(b,a);b.prototype.clone=function(){return new g({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})};return b}(f.declared(e));m([f.property({type:String})],a.prototype,"name",void 0);m([f.property({type:String})],a.prototype,"styleUrl",void 0);m([f.property({type:String})],a.prototype,"styleName",void 0);m([f.property({type:l})],a.prototype,"portal",
void 0);a=g=m([f.subclass("esri.symbols.support.StyleOrigin")],a);var g;return a})},"esri/symbols/SimpleLineSymbol":function(){define(["../core/declare","dojo/_base/lang","../core/lang","../core/screenUtils","./LineSymbol"],function(a,h,p,m,f){var e={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dash-dot",STYLE_DASHDOTDOT:"long-dash-dot-dot",STYLE_NULL:"none",STYLE_SHORTDASH:"short-dash",STYLE_SHORTDOT:"short-dot",STYLE_SHORTDASHDOT:"short-dash-dot",STYLE_SHORTDASHDOTDOT:"short-dash-dot-dot",
STYLE_LONGDASH:"long-dash",STYLE_LONGDASHDOT:"long-dash-dot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},l={color:[0,0,0,1],style:e.STYLE_SOLID,width:.75,cap:e.CAP_BUTT,join:e.JOIN_MITER,miterLimit:7.5},g=a(f,{declaredClass:"esri.symbols.SimpleLineSymbol",properties:{type:"simple-line-symbol",style:{value:e.STYLE_SOLID,json:{read:function(a,b){return p.valueOf(this._jsonStyles,a)||void 0},write:function(a,b){b.style=this._jsonStyles[a]}}},
cap:{value:e.CAP_BUTT,json:{read:!1,write:!1}},join:{value:e.JOIN_MITER,json:{read:!1,write:!1}},miterLimit:{value:7.5,cast:m.toPt,json:{read:!1,write:!1}}},_jsonStyles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot","dash-dot":"esriSLSDashDot","long-dash-dot-dot":"esriSLSDashDotDot",none:"esriSLSNull","inside-frame":"esriSLSInsideFrame","short-dash":"esriSLSShortDash","short-dot":"esriSLSShortDot","short-dash-dot":"esriSLSShortDashDot","short-dash-dot-dot":"esriSLSShortDashDotDot","long-dash":"esriSLSLongDash",
"long-dash-dot":"esriSLSLongDashDot"},getDefaults:function(){return h.mixin(this.inherited(arguments),l)},normalizeCtorArgs:function(a,b,e,f,g,l){if(a&&"string"!==typeof a)return a;var c={};null!=a&&(c.style=a);null!=b&&(c.color=b);null!=e&&(c.width=m.toPt(e));null!=f&&(c.cap=f);null!=g&&(c.join=g);null!=l&&(c.miterLimit=m.toPt(l));return c},clone:function(){return new g({color:p.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit})}});h.mixin(g,
e);g.defaultProps=l;return g})},"esri/symbols/LineSymbol":function(){define(["../core/declare","../core/screenUtils","./Symbol"],function(a,h,p){return a(p,{declaredClass:"esri.symbols.LineSymbol",properties:{color:{},type:"simple-line-symbol",width:{value:.75,cast:h.toPt,json:{write:!0}}}})})},"esri/symbols/SimpleMarkerSymbol":function(){define("../core/declare dojo/_base/lang ../core/lang ../core/screenUtils ./MarkerSymbol ./SimpleLineSymbol".split(" "),function(a,h,p,m,f,e){var l={style:"circle",
color:[255,255,255,.25],outline:new e,size:12,angle:0,xoffset:0,yoffset:0},g=a(f,{declaredClass:"esri.symbols.SimpleMarkerSymbol",properties:{color:{json:{write:function(a,b){a&&"x"!==this.style&&"cross"!==this.style&&(b.color=a.toJSON())}}},type:"simple-marker-symbol",size:{value:12},style:{type:String,value:"circle",json:{read:write:function(a,b){b.style=this._styles[a]}}},path:{type:String,value:null,set:json:{write:!0}},outline:{type:e,json:{write:!0}}},_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},getDefaults:function(){return h.mixin(this.inherited(arguments),l)},normalizeCtorArgs:function(a,b,e,f){if(a&&"string"!==typeof a)return a;var c={};a&&(c.style=a);null!=b&&(c.size=m.toPt(b));e&&(c.outline=e);f&&(c.color=f);return c},clone:function(){return new g({angle:this.angle,color:p.clone(this.color),outline:this.outline&&
this.outline.clone(),size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})},_setDim:function(a,b,e){this._targetWidth=m.toPt(a);this._targetHeight=m.toPt(b);this._spikeSize=m.toPt(e)}});h.mixin(g,{STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"});g.defaultProps=l;return g})},"esri/symbols/MarkerSymbol":function(){define(["../core/declare","../core/screenUtils","./Symbol"],function(a,h,
p){return a(p,{declaredClass:"esri.symbols.MarkerSymbol",properties:{angle:{value:0,json:{read:function(a){return a&&-1*a},write:function(a,f){f.angle=a&&-1*a}}},type:{},xoffset:{value:0,cast:h.toPt,json:{write:!0}},yoffset:{value:0,cast:h.toPt,json:{write:!0}},size:{value:9,cast:json:{write:!0}}}})})},"esri/symbols/PictureMarkerSymbol":function(){define("../core/declare dojo/_base/lang ../core/lang ../core/screenUtils ../core/urlUtils ./MarkerSymbol".split(" "),
function(a,h,p,m,f,e){var l={width:12,height:12,angle:0,xoffset:0,yoffset:0},g=a(e,{declaredClass:"esri.symbols.PictureMarkerSymbol",properties:{color:{json:{write:!1}},type:"picture-marker-symbol",url:{dependsOn:["source"],json:{read:!1},get:function(){return this.source?this.source.url:void 0},set:function(a){var b;a&&0===a.indexOf("data:")?(b=a.substring(5,a.indexOf(";")),this.source={url:a,contentType:b,imageData:a.substring(13+b.length)}):this.source={url:a}}},source:{json:{read:{source:["imageData",
"url"],reader:function(a,b,e){a=f.read(b.url,e);return b.imageData?{url:a,contentType:b.contentType,imageData:b.imageData}:{url:a}}},write:function(a,b,e,g){a.imageData&&(b.imageData=a.imageData);a.contentType&&(b.contentType=a.contentType);a.url&&(b.url=f.write(a.url,g))}}},height:{json:{read:{source:["height","size"],reader:function(a,b){return b.size||a}},write:!0},cast:m.toPt},width:{json:{read:{source:["width","size"],reader:function(a,b){return b.size||a}},write:!0},cast:m.toPt},size:{json:{write:!1}}},
getDefaults:function(){return h.mixin(this.inherited(arguments),l)},normalizeCtorArgs:function(a,b,e){if(a&&"string"!==typeof a&&null==a.imageData)return a;var c={};a&&(c.url=a);null!=b&&(c.width=m.toPt(b));null!=e&&(c.height=m.toPt(e));return c},clone:function(){return new g({angle:this.angle,height:this.height,source:p.clone(this.source),width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}});g.defaultProps=l;return g})},"esri/symbols/PictureFillSymbol":function(){define("../core/declare dojo/_base/lang ../core/lang ../core/screenUtils ../core/urlUtils ./FillSymbol".split(" "),
function(a,h,p,m,f,e){var l={xscale:1,yscale:1,xoffset:0,yoffset:0,width:12,height:12},g=a(e,{declaredClass:"esri.symbols.PictureFillSymbol",properties:{type:"picture-fill-symbol",url:{dependsOn:["source"],json:{read:!1},get:set:function(a){var b;a&&0===a.indexOf("data:")?(b=a.substring(5,a.indexOf(";")),this.source={url:a,contentType:b,imageData:a.substring(13+b.length)}):this.source={url:a}}},xscale:{value:1,json:{write:!0}},yscale:{value:1,
json:{write:!0}},width:{value:12,cast:m.toPt,json:{write:!0}},height:{value:12,cast:m.toPt,json:{write:!0}},xoffset:{value:0,cast:m.toPt,json:{write:!0}},yoffset:{value:0,cast:m.toPt,json:{write:!0}},source:{json:{read:{source:["imageData","url"],reader:function(a,b,e){a=f.read(b.url,e);return b.imageData?{url:a,contentType:b.contentType,imageData:b.imageData}:{url:a}}},write:function(a,b,e,g){a.imageData&&(b.imageData=a.imageData);a.contentType&&(b.contentType=a.contentType);a.url&&(b.url=f.write(a.url,
g))}}}},getDefaults:function(){return h.mixin(this.inherited(arguments),l)},normalizeCtorArgs:function(a,b,e,f){if(a&&"string"!==typeof a&&null==a.imageData)return a;var c={};a&&(c.url=a);b&&(c.outline=b);null!=e&&(c.width=m.toPt(e));null!=f&&(c.height=m.toPt(f));return c},clone:function(){return new g({color:p.clone(this.color),height:this.height,outline:this.outline&&this.outline.clone(),source:p.clone(this.source),width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale})}});
g.defaultProps=l;return g})},"esri/symbols/FillSymbol":function(){define(["../core/declare","./Symbol","./SimpleLineSymbol"],function(a,h,p){return a(h,{declaredClass:"esri.symbols.FillSymbol",properties:{outline:{type:p,json:{write:!0}},type:null}})})},"esri/symbols/SimpleFillSymbol":function(){define(["../core/declare","dojo/_base/lang","../core/lang","./FillSymbol","./SimpleLineSymbol"],function(a,h,p,m,f){var e={style:"solid",outline:new f,color:[0,0,0,.25]},l=a(m,{declaredClass:"esri.symbols.SimpleFillSymbol",
properties:{color:{},type:"simple-fill-symbol",style:{value:"solid",type:String,json:{read:function(a){return p.valueOf(this._styles,a)||void 0},write:}},_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical","forward-diagonal":"esriSFSForwardDiagonal","backward-diagonal":"esriSFSBackwardDiagonal",cross:"esriSFSCross","diagonal-cross":"esriSFSDiagonalCross"},getDefaults:function(){return h.mixin(this.inherited(arguments),
e)},normalizeCtorArgs:function(a,c,b){if(a&&"string"!==typeof a)return a;var e={};a&&(e.style=a);c&&(e.outline=c);b&&(e.color=b);return e},clone:function(){return new l({color:p.clone(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}});h.mixin(l,{STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forward-diagonal",STYLE_BACKWARD_DIAGONAL:"backward-diagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonal-cross"});
l.defaultProps=e;return l})},"esri/symbols/TextSymbol":function(){define("../core/declare dojo/_base/lang ../core/lang ../core/screenUtils ../Color ./Symbol ./Font".split(" "),function(a,h,p,m,f,e,l){var g={x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:{},angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},c=a(e,{declaredClass:"esri.symbols.TextSymbol",properties:{backgroundColor:{type:f,json:{write:!0}},borderLineColor:{type:f,json:{write:!0}},borderLineSize:{type:Number,json:{write:!0}},
color:{},font:{type:l,json:{write:!0}},horizontalAlignment:{value:"center",json:{write:!0}},kerning:{value:!0,json:{write:!0}},haloColor:{type:f,json:{write:!0}},haloSize:{type:Number,cast:m.toPt,json:{write:!0}},rightToLeft:{json:{write:!0}},rotated:{value:!1,json:{write:!0}},text:{type:String,json:{write:!0}},type:"text-symbol",verticalAlignment:{type:String,json:{write:!0}},xoffset:{value:0,type:Number,cast:m.toPt,json:{write:!0}},yoffset:{value:0,type:Number,cast:m.toPt,json:{write:!0}},angle:{type:Number,
value:0,json:{read:function(a){return a&&-1*a},write:function(a,c){c.angle=a&&-1*a}}},width:{json:{write:!0}}},getDefaults:function(){return h.mixin(this.inherited(arguments),g)},normalizeCtorArgs:function(a,c,e){if(a&&"string"!==typeof a)return a;var b={};a&&(b.text=a);c&&(b.font=c);e&&(b.color=e);return b},clone:function(){return new c({angle:this.angle,backgroundColor:p.clone(this.backgroundColor),borderLineColor:p.clone(this.borderLineColor),borderLineSize:this.borderLineSize,color:p.clone(this.color),
font:this.font&&this.font.clone(),haloColor:p.clone(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}});h.mixin(c,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});
c.defaultProps=g;return c})},"esri/symbols/Font":function(){define(["dojo/_base/lang","../core/JSONSupport","../core/lang","../core/screenUtils"],function(a,h,p,m){var f={style:"normal",variant:"normal",weight:"normal",size:9,family:"serif",decoration:"none"},e=h.createSubclass({declaredClass:"esri.symbols.Font",properties:{decoration:{},family:{},size:{cast:m.toPt},style:{},variant:{},weight:{}},getDefaults:function(){return f},normalizeCtorArgs:function(a,e,c,b,f){if(a&&"string"!==typeof a)return a;
var g={};null!=a&&(g.size=m.toPt(a));null!=e&&(g.style=e);null!=c&&(g.variant=c);null!=b&&(g.weight=b);f&&(g.family=f);return g},toJSON:clone:);e.defaultProps=f;a.mixin(e,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",
STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});return e})},"esri/symbols/PointSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ./Symbol3D ../core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e,l){a=g=function(a){function b(b){b=a.call(this)||this;b.type="point-symbol-3d";return b}p(b,
a);b.prototype.clone=function(){return new g({styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};return b}(l.declared(e));m([l.property()],a.prototype,"type",void 0);m([l.shared(["Icon","Object","Text"])],a.prototype,"_allowedLayerTypes",void 0);a=g=m([l.subclass("esri.symbols.PointSymbol3D")],a);var g;return a})},"esri/symbols/LineSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ./Symbol3D ../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l){a=g=function(a){function b(b){b=a.call(this)||this;b.type="line-symbol-3d";return b}p(b,a);b.prototype.clone=function(){return new g({styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};return b}(l.declared(e));m([l.property()],a.prototype,"type",void 0);m([l.shared(["Line","Path","Text"])],a.prototype,"_allowedLayerTypes",void 0);a=g=m([l.subclass("esri.symbols.LineSymbol3D")],a);var g;return a})},"esri/symbols/PolygonSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ./Symbol3D ../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l){a=g=function(a){function b(b){b=a.call(this)||this;b.type="polygon-symbol-3d";return b}p(b,a);b.prototype.clone=function(){return new g({styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};b.fromJSON=function(a){var b=new g;b.read(a);if(2===b.symbolLayers.length&&"Fill"===b.symbolLayers.getItemAt(0).type&&"Line"===b.symbolLayers.getItemAt(1).type){var c=b.symbolLayers.getItemAt(0),e=b.symbolLayers.getItemAt(1);
!e.enabled||a.symbolLayers&&a.symbolLayers[1]&&!1===a.symbolLayers[1].enable||(c.outline={size:e.size,color:e.material.color});b.symbolLayers.removeAt(1)}return b};return b}(l.declared(e));m([l.property()],a.prototype,"type",void 0);m([l.shared("Extrude Fill Line Icon Object Text".split(" "))],a.prototype,"_allowedLayerTypes",void 0);a=g=m([l.subclass("esri.symbols.PolygonSymbol3D")],a);var g;return a})},"esri/symbols/MeshSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ./Symbol3D ../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l){a=g=function(a){function b(b){b=a.call(this)||this;b.type="mesh-symbol-3d";return b}p(b,a);b.prototype.clone=function(){return new g({styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};return b}(l.declared(e));m([l.property()],a.prototype,"type",void 0);m([l.shared(["Fill"])],a.prototype,"_allowedLayerTypes",void 0);a=g=m([l.subclass("esri.symbols.MeshSymbol3D")],a);var g;return a})},"esri/symbols/LabelSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ./Symbol3D ../core/accessorSupport/decorators".split(" "),
function(a,h,p,m,f,e,l){a=g=function(a){function b(b){b=a.call(this)||this;b.type="label-symbol-3d";return b}p(b,a);b.prototype.clone=function(){return new g({styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};return b}(l.declared(e));m([l.property()],a.prototype,"type",void 0);m([l.shared(["Text"])],a.prototype,"_allowedLayerTypes",void 0);a=g=m([l.subclass("esri.symbols.LabelSymbol3D")],a);var g;return a})},"esri/symbols/WebStyleSymbol":function(){define("require exports ../core/tsSupport/extendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/urlUtils ../core/Logger ../core/requireUtils ./Symbol ../portal/Portal".split(" "),
function(a,h,p,m,f,e,l,g,c,b){var q=l.getLogger("esri.symbols.WebStyleSymbol");h=x=function(b){(c,b);c.prototype._readStyleUrl=function(a,b,c){return e.read(a,c)};c.prototype._writeStyleUrl=function(a,b,c,f){b.styleUrl=e.write(a,f)};c.prototype._writeType=c.prototype.read=function(a,b){this.portal=b?b.portal:void 0;this.inherited(arguments,
[a,b]);return this};c.prototype.clone=c.prototype.fetchSymbol=function(){var b=this;return g.when(a,"./support/symbolUtils").then(function(a){a=a.fetchStyleSymbol(b,{portal:b.portal});a.otherwise(;return a})};return c}(f.declared(c));m([f.property({json:{write:!1}})],h.prototype,"color",void 0);m([f.property({type:String,
json:{write:!0}})],h.prototype,"styleName",void 0);m([f.property({type:b,json:{write:!1}})],h.prototype,"portal",void 0);m([f.property({type:String,json:{write:!0}})],h.prototype,"styleUrl",void 0);m([f.reader("styleUrl")],h.prototype,"_readStyleUrl",null);m([f.writer("styleUrl")],h.prototype,"_writeStyleUrl",null);m([f.property({type:String,json:{write:!0}})],h.prototype,"name",void 0);m([f.property({type:String,readOnly:!0,json:{read:!1}})],h.prototype,"type",void 0);m([f.writer("type")],h.prototype,
"_writeType",null);h=x=m([f.subclass("esri.symbols.WebStyleSymbol")],h);var x;return h})},"esri/symbols/support/symbolConversion":function(){define("require exports dojo/_base/lang ../../core/Error ../Font ../SimpleLineSymbol ../SimpleMarkerSymbol ../PictureMarkerSymbol ../SimpleFillSymbol ../TextSymbol ../WebStyleSymbol ../Symbol3D ../LineSymbol3D ../PointSymbol3D ../PolygonSymbol3D ../LabelSymbol3D ../LineSymbol3DLayer ../IconSymbol3DLayer ../FillSymbol3DLayer ../TextSymbol3DLayer ../../Color".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v){function A(a){var b=a.color?a.color.clone():new v([255,255,255]),d,c,e;a instanceof g?(a.color&&0===a.color.r&&0===a.color.g&&0===a.color.b&&(b=new v([255,255,255])),d=a.source.imageData&&a.source.contentType?{href:"data:"+a.source.contentType+";base64,"+a.source.imageData}:{href:a.url},c=a.width<=a.height?a.height:a.width):(d=a.style,d in z?d=z[d]:(console.log(d+' cannot be mapped to Icon symbol. Fallback to "circle"'),d="circle"),d={primitive:d},
c=a.size,a.outline&&a.outline.color&&0<a.outline.width&&(e={size:a.outline.width,color:a.outline.color.clone()}));return new t(new w({size:c,screenOffset:[a.xoffset,a.yoffset],resource:d,material:{color:b},outline:e}))}var z={};z[l.STYLE_CIRCLE]="circle";z[l.STYLE_CROSS]="cross";z[l.STYLE_DIAMOND]="kite";z[l.STYLE_SQUARE]="square";z[l.STYLE_X]="x";h.to3D=function(a,h,t){void 0===h&&(h=!1);void 0===t&&(t=!1);if(!a)return{symbol:null};var w;if(a instanceof x||a instanceof q)w=a;else if(a instanceof
e)w=new y(new n({size:a.width||1,material:{color:a.color?a.color.clone():[255,255,255]}}));else if(a instanceof l)w=A(a);else if(a instanceof g)w=A(a);else if(a instanceof c)w=new d({material:{color:a.color?a.color.clone():[255,255,255]}}),a.outline&&a.outline.color&&(w.outline={size:a.outline.width||0,color:a.outline.color}),w=new u(w);else if(a instanceof b){switch(a.verticalAlignment){case "top":w="top";break;case "middle":w="center";break;case "bottom":w="bottom";break;default:w="center"}switch(a.horizontalAlignment){case "left":w+=
"Left";break;case "center":w+="Center";break;case "right":w+="Right";break;default:w+="Center"}var v=p.clone(f.defaultProps);a.font&&p.mixin(v,a.font);w=new r(new k({size:v.size,font:{family:v.family,weight:v.weight,style:v.style},material:{color:a.color.clone()},placement:w,screenOffset:[a.xoffset,a.yoffset],text:a.text}))}else return{error:new m("symbol-conversion:unsupported-2d-symbol","Unsupported 2D symbol of tyoe '"+(a.type||a.declaredClass)+"'",{symbol:a})};h&&(w.id=a.id);if(t&&w.isInstanceOf(x))for(a=
0;a<w.symbolLayers.length;++a)w.symbolLayers.getItemAt(a)._ignoreDrivers=!0;return{symbol:w}}})},"esri/tasks/QueryTask":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/accessorSupport/decorators dojo/_base/lang ../request ./Task ./support/FeatureSet ./support/Query ../geometry/Extent ../geometry/support/normalizeUtils".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y){a=function(a){(c,a);c.prototype.execute=function(a,b){var c=this;return y.normalizeCentralMeridian(a.geometry?[a.geometry]:[]).then(function(d){d=c._encode(l.mixin({},c.parsedUrl.query,{f:"json"},a.toJSON({geometry:d&&d[0]})));if(c.source){var e={source:c.source.toJSON()};d.layer=JSON.stringify(e)}c.gdbVersion&&(d.gdbVersion=c.gdbVersion);d={query:d,callbackParamName:"callback"};if(c.requestOptions||b)d=l.mixin({},c.requestOptions,b,d);return g(c.parsedUrl.path+
"/query",d)}).then(this._handleExecuteResponse)};c.prototype.executeRelationshipQuery=function(a,b){a=this._encode(l.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);a={query:a,callbackParamName:"callback"};if(this.requestOptions||b)a=l.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/queryRelatedRecords",a).then(this._handleExecuteRelationshipQueryResponse)};c.prototype.executeForIds=function(a,b){var c=this;return y.normalizeCentralMeridian(a.geometry?
[a.geometry]:[]).then(function(d){d=c._encode(l.mixin({},c.parsedUrl.query,{f:"json",returnIdsOnly:!0},a.toJSON({geometry:d&&d[0]})));if(c.source){var e={source:c.source.toJSON()};d.layer=JSON.stringify(e)}c.gdbVersion&&(d.gdbVersion=c.gdbVersion);d={query:d,callbackParamName:"callback"};if(c.requestOptions||b)d=l.mixin({},c.requestOptions,b,d);return g(c.parsedUrl.path+"/query",d)}).then(this._handleExecuteForIdsResponse)};c.prototype.executeForCount=function(a,b){var c=this;return y.normalizeCentralMeridian(a.geometry?
[a.geometry]:[]).then(function(d){d=c._encode(l.mixin({},c.parsedUrl.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJSON({geometry:d&&d[0]})));if(c.source){var e={source:c.source.toJSON()};d.layer=JSON.stringify(e)}c.gdbVersion&&(d.gdbVersion=c.gdbVersion);d={query:d,callbackParamName:"callback"};if(c.requestOptions||b)d=l.mixin({},c.requestOptions,b,d);return g(c.parsedUrl.path+"/query",d)}).then(this._handleExecuteForCountResponse)};c.prototype.executeForExtent=function(a,b){var c=this;
return y.normalizeCentralMeridian(a.geometry?[a.geometry]:[]).then(function(d){d=c._encode(l.mixin({},c.parsedUrl.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJSON({geometry:d&&d[0]})));if(c.source){var e={source:c.source.toJSON()};d.layer=JSON.stringify(e)}c.gdbVersion&&(d.gdbVersion=c.gdbVersion);d={query:d,callbackParamName:"callback"};if(c.requestOptions||b)d=l.mixin({},c.requestOptions,b,d);return g(c.parsedUrl.path+"/query",d)}).then(this._handleExecuteForExtentResponse)};c.prototype._handleExecuteResponse=
c.prototype._handleExecuteRelationshipQueryResponse=function(a){a=a.data;var c=a.geometryType,e=a.spatialReference,d={};a.relatedRecordGroups.forEach(function(a){var f=b.fromJSON({geometryType:c,spatialReference:e,features:a.relatedRecords});if(null!=a.objectId)d[a.objectId]=f;else for(var g in a)a.hasOwnProperty(g)&&"relatedRecords"!==g&&(d[a[g]]=f)});return d};c.prototype._handleExecuteForIdsResponse=function(a){return a.data.objectIds};c.prototype._handleExecuteForCountResponse=
function(a){a=a.data;var b=a.features,c=a.objectIds;if(c)a=c.length;else{if(b)throw Error("Unable to perform query. Please check your parameters.");a=a.count}return a};c.prototype._handleExecuteForExtentResponse=function(a){a=a.data;if(a.hasOwnProperty("extent"))a.extent=x.fromJSON(a.extent);else{if(a.features)throw Error("Layer does not support extent calculation.");if(a.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");}return a};return c}(e.declared(c));m([e.property()],
a.prototype,"gdbVersion",void 0);m([e.property()],a.prototype,"source",void 0);m([f(0,e.cast(q))],a.prototype,"execute",null);m([f(0,e.cast(q))],a.prototype,"executeForIds",null);m([f(0,e.cast(q))],a.prototype,"executeForCount",null);m([f(0,e.cast(q))],a.prototype,"executeForExtent",null);return a=m([e.subclass("esri.tasks.QueryTask")],a)})},"esri/tasks/Task":function(){define(["dojo/_base/lang","../core/Accessor","../core/urlUtils"],function(a,h,p){return h.createSubclass({declaredClass:"esri.tasks.Task",
normalizeCtorArgs:function(h,f){if("string"!==typeof h)return h;var e={};h&&(e.url=h);f&&a.mixin(e,f);return e},properties:{normalization:{value:!0},parsedUrl:{value:null,readOnly:!0,dependsOn:["url"],get:function(){return this._parseUrl(this.url)}},requestOptions:{value:null},url:{value:null,type:String}},_parseUrl:_useSSL:function(){var a=this.parsedUrl,f=/^http:/i;this.url&&this.set("url",this.url.replace(f,"https:"));a&&a.path&&(a.path=a.path.replace(f,
"https:"))},_encode:function(h,f,e){var l,g,c={},b,m;for(b in h)if("declaredClass"!==b&&(l=h[b],g=typeof l,null!==l&&void 0!==l&&"function"!==g))if(a.isArray(l))for(c[b]=[],m=l.length,g=0;g<m;g++)c[b][g]=this._encode(l[g]);else"object"===g?l.toJSON&&(g=l.toJSON(e&&e[b]),"esri.tasks.support.FeatureSet"===l.declaredClass&&g.spatialReference&&(g.sr=g.spatialReference,delete g.spatialReference),c[b]=f?g:JSON.stringify(g)):c[b]=l;return c}})})},"esri/tasks/support/FeatureSet":function(){define("../../core/kebabDictionary ../../core/JSONSupport ../../core/lang ../../Graphic ../../layers/support/Field ../../geometry/SpatialReference ../../geometry/support/graphicsUtils ../../geometry/support/jsonUtils dojo/_base/lang".split(" "),
function(a,h,p,m,f,e,l,g,c){a=a({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"});return h.createSubclass({declaredClass:"esri.tasks.support.FeatureSet",getDefaults:function(){return c.mixin(this.inherited(arguments),{features:[]})},properties:{displayFieldName:null,exceededTransferLimit:null,features:{value:null,json:{read:function(a,c){var b=e.fromJSON(c.spatialReference);a=a.map(function(a){var c=
m.fromJSON(a);a=a.geometry&&a.geometry.spatialReference;c.geometry&&!a&&(c.geometry.spatialReference=b);return c});c.transform&&this._hydrate(c.transform,c.geometryType,a);return a}}},fields:{value:null,type:[f]},geometryType:{value:null,json:{read:a.fromJSON}},spatialReference:{type:e}},toJSON:function(a){var b={hasZ:this.hasZ,hasM:this.hasM};this.displayFieldName&&(b.displayFieldName=this.displayFieldName);this.fields&&(b.fields=this.fields.map(function(a){return a.toJSON()}));this.spatialReference?
b.spatialReference=this.spatialReference.toJSON():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJSON());this.features[0]&&(this.features[0].geometry&&(b.geometryType=g.getJsonType(this.features[0].geometry)),b.features=l._encodeGraphics(this.features,a));b.exceededTransferLimit=this.exceededTransferLimit;b.transform=this.transform;return p.fixJson(b)},quantize:function(a){var b=a.translate[0],c=a.translate[1],e=a.scale[0],f=a.scale[1],
g=this.features,l=n=this.geometryType,function(a){return Math.round((a-b)/e)},,h,d;h=0;for(d=g.length;h<d;h++)n(g[h].geometry)||(g.splice(h,1),h--,d--);this.transform=a;return this},_hydrate:function(a,c,e){if(a){var b=a.translate[0],f=a.translate[1],g=a.scale[0],l=a.scale[1],n=function(a,b,c){if("esriGeometryPoint"===a)return if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){a=a.rings||a.paths;var d,e,f,g,k,n,l,h;d=0;for(e=a.length;d<e;d++)for(k=a[d],f=0,g=k.length;f<g;f++)n=k[f],0<f?(l+=n[0],h+=n[1]):(l=n[0],h=n[1]),n[0]=b(l),n[1]=c(h)};if("esriGeometryEnvelope"===a)return if("esriGeometryMultipoint"===a)return function(a){a=a.points;var d,e,f,g,k;d=0;for(e=a.length;d<e;d++)f=a[d],0<d?(g+=f[0],
k+=f[1]):(g=f[0],k=f[1]),f[0]=b(g),f[1]=c(k)}}(c,;a=0;for(c=e.length;a<c;a++)e[a].geometry&&n(e[a].geometry)}}})})},"esri/layers/support/Field":function(){define(["../../core/kebabDictionary","../../core/JSONSupport","./CodedValueDomain","./RangeDomain"],function(a,h,p,m){var f=a({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",
esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"}),e=h.createSubclass({declaredClass:"esri.layers.support.Field",properties:{alias:null,domain:{value:null,json:{read:function(a,e){e=a&&a.type;return"range"===e?new m(a):"codedValue"===e?new p(a):null}}},editable:!1,length:-1,name:null,nullable:!0,type:{json:{read:f.fromJSON}}},clone:
toJSON:function(){return{alias:this.alias,domain:this.domain&&this.domain.toJSON(),editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:f.toJSON(this.type)}}});return e})},"esri/layers/support/CodedValueDomain":function(){define(["../../core/lang","./Domain","dojo/_base/array","dojo/_base/lang"],function(a,h,p,m){return h.createSubclass({declaredClass:"esri.layers.support.CodedValueDomain",properties:{codedValues:{value:null},type:{value:"coded-value"}},getName:toJSON:)})},"esri/layers/support/Domain":function(){define(["../../core/kebabDictionary","../../core/JSONSupport","../../core/lang"],function(a,h,p){var m=a({codedValue:"coded-value"});return h.createSubclass({declaredClass:"esri.layers.support.Domain",properties:{name:{value:null},type:{json:{read:m.fromJSON},value:null}},
toJSON:function(){return p.fixJson({name:this.name,type:m.toJSON(this.type)})}})})},"esri/layers/support/RangeDomain":function(){define(["../../core/lang","./Domain"],function(a,h){return h.createSubclass({declaredClass:"esri.layers.support.RangeDomain",properties:{maxValue:{json:{read:{source:["range"],reader:function(a,h){return h.range&&h.range[1]}}}},minValue:{json:{read:{source:["range"],reader:function(a,h){return h.range&&h.range[0]}}}},type:{value:"range"}},toJSON:)})},"esri/geometry/support/graphicsUtils":function(){define(["require","exports","dojo/_base/array","../Extent"],function(a,h,p,m){h.graphicsExtent=function(a){var e=a[0].geometry,f=e.extent,g=e;null===f&&(f=new m(g.x,g.y,g.x,g.y,e.spatialReference));for(var c=1;c<a.length;c++){var g=e=a[c].geometry,b=e.extent;null===b&&(b=new m(g.x,g.y,g.x,g.y,e.spatialReference));f=f.clone().union(b)}return 0>f.width&&0>f.height?null:f};h.getGeometries=
h._encodeGraphics=function(a,e){var f=[];p.forEach(a,function(a,c){a=a.toJSON();var b={};if(a.geometry){var g=e&&e[c];b.geometry=g&&g.toJSON()||a.geometry}a.attributes&&(b.attributes=a.attributes);f[c]=b});return f}})},"esri/tasks/support/Query":function(){define(["../../core/Accessor","../../core/kebabDictionary","../../core/lang","../../geometry/support/jsonUtils","dojo/_base/array"],function(a,h,p,m,f){var e=h({esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),l=h({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),
g=h({upperLeft:"upper-left",lowerLeft:"lower-left"});return a.createSubclass({declaredClass:"esri.tasks.support.Query",properties:{spatialRelationship:"intersects",text:null,where:"",geometry:null,geometryPrecision:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,maxAllowableOffset:null,multipatchOption:null,num:null,start:null,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,
distance:null,units:"meters",resultOffset:null,resultRecordCount:null,quantizationParameters:null,sqlFormat:null},toJSON:function(a){var b={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:e.toJSON(this.spatialRelationship),maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision,returnZ:this.returnZ,returnM:this.returnM,sqlFormat:this.sqlFormat},c=a&&a.geometry||this.geometry,h=this.objectIds,y=this.outFields,t=this.outSpatialReference,u=this.groupByFieldsForStatistics,
r=this.orderByFields,n=this.outStatistics;a=this.distance;c&&(b.geometry=c,b.geometryType=m.getJsonType(c),b.inSR=c.spatialReference.wkid||JSON.stringify(c.spatialReference.toJSON()));h&&(b.objectIds=h.join(","));y&&(b.outFields=y.join(","));this.returnDistinctValues&&(b.returnDistinctValues=!0);u&&(b.groupByFieldsForStatistics=u.join(","));r&&(b.orderByFields=r.join(","));if(n){var w=[];f.forEach(n,;b.outStatistics=JSON.stringify(w)}t?b.outSR=t.wkid||JSON.stringify(t.toJSON()):
c&&(b.outSR=c.spatialReference.wkid||JSON.stringify(c.spatialReference.toJSON()));c=this.timeExtent;b.time=c?c.toJSON().join(","):null;(c=this.relationParam)&&b.spatialRel===e.toJSON("relation")&&(b.relationParam=c);a&&(b.distance=this.distance,b.units=l.toJSON(this.units));this.hasOwnProperty("start")&&(b.resultOffset=this.start,b.resultRecordCount=10,""===b.where&&(b.where="1\x3d1"));this.hasOwnProperty("num")&&(b.resultRecordCount=this.num);b.pixelSize=this.pixelSize?JSON.stringify(this.pixelSize.toJSON()):
null;b.multipatchOption=this.multipatchOption;this.quantizationParameters&&(a=p.clone(this.quantizationParameters),a.originPosition&&(a.originPosition=g.toJSON(a.originPosition)),b.quantizationParameters=JSON.stringify(a));b._ts=this._ts;return b}})})},"esri/geometry/support/normalizeUtils":function(){define("dojo/_base/array dojo/Deferred ../../config ../../tasks/GeometryService ../Polyline ../Polygon ./webMercatorUtils ./spatialReferenceUtils ./jsonUtils".split(" "),function(a,h,p,m,f,e,l,g,c){unction q(a,b){var d=a.paths||a.rings,c,e,f=d.length,g;for(c=0;c<f;c++)for(g=d[c].length,e=0;e<g;e++){var n=a.getPoint(c,e);a.setPoint(c,e,n.clone().offset(b,0))}return a}nction t(a,d,c){var e=a.x||a[0],f;e>d?(f=b(e,d),a.x?a=a.clone().offset(-2*f*d,0):a[0]=e+-2*f*d):e<c&&(f=b(e,c),a.x?a=a.clone().offset(-2*f*c,0):a[0]=e+-2*f*c);return a}function u(c,d){var e=-1;a.forEach(d.cutIndexes,function(f,g){var k=d.geometries[g];a.forEach(k.rings||k.paths,function(d,c){a.some(d,function(a){if(!(180>a[0])){a=0;var e,f=d.length,g;for(e=0;e<f;e++)g=d[e][0],a=g>a?g:a;a=Number(a.toFixed(9));a=-360*b(a,180);f=d.length;for(e=0;e<f;e++)g=k.getPoint(c,e),
k.setPoint(c,e,g.clone().offset(a,0))}return!0})});f===e?k.rings?a.forEach(k.rings,function(a){c[f]=c[f].addRing(a)}):a.forEach(k.paths,:(e=f,c[f]=k)});return c}ar n;return{_straightLineDensify:x,normalizeCentralMeridian:function(w,d){var k=new h;d||(n||(n=new m({url:p.geometryServiceUrl})),
d=n);var r=[],x=[],z,D,B,C,F,K,M,E,V=0;a.forEach(w,function(d){if(d)if(z||(z=d.spatialReference,D=g.getInfo(z),C=(B=z.isWebMercator)?2.0037508342788905E7:180,F=B?-2.0037508342788905E7:-180,K=B?102100:4326,M=new f({paths:[[[C,F],[C,C]]],spatialReference:{wkid:K}}),E=new f({paths:[[[F,F],[F,C]]],spatialReference:{wkid:K}})),D){var k=c.fromJSON(d.toJSON()),n=d.extent;"point"===d.type?r.push(t(k,C,F)):"multipoint"===d.type?(k.points=a.map(k.points,,r.push(k)):"extent"===d.type?
(k=n.clone()._normalize(null,null,D),r.push(k.rings?new e(k):k)):n?(d=2*b(n.xmin,F)*C,k=0===d?k:q(k,d),n=n.clone().offset(d,0),n.intersects(M)&&n.xmax!==C?(V=n.xmax>V?n.xmax:V,k=y(k,B),x.push(k),r.push("cut")):n.intersects(E)&&n.xmin!==F?(V=2*n.xmax*C>V?2*n.xmax*C:V,k=y(k,B,360),x.push(k),r.push("cut")):r.push(k)):r.push(k)}else r.push(d);else r.push(d)});for(var P=new f,I=b(V,C),J=-90,Q=I;0<I;){var S=-180+360*I;P.addPath([[S,J],[S,-1*J]]);J*=-1;I--}0<x.length&&0<Q?d?d.cut(x,P).then(function(b){x=
u(x,b);var c=[];a.forEach(r,;0<c.length?d.simplify(c).then(.otherwise(function(a){k.reject(a)}):k.resolve(r)}).otherwise(function(a){k.reject(a)}):k.reject(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):
(a.forEach(r,,k.resolve(r));return k.promise},getDenormalizedExtent:function(a){if(!a)return null;var b=a.extent;if(!b)return null;var c=a.spatialReference&&g.getInfo(a.spatialReference);if(!c)return b;var e=c.valid[0],c=c.valid[1],f=b.width,n=b.xmax,l=b.xmin;if("extent"===a.type||0===f||f<=c||f>2*c||n<e||l>c)return b;var h;switch(a.type){case "polygon":if(1<a.rings.length)h=r(a.rings);else return b;break;case "polyline":if(1<
a.paths.length)h=r(a.paths);else return b;break;case "multipoint":h=a.points}a=Math.min;for(var e=Math.max,m=b.clone(),q=0;q<h.length;q++){var p=h[q][0];0>p?(p+=c,l=e(p,l)):(p-=c,n=a(p,n))}m.xmin=n;m.xmax=l;return m.width<f?(m.xmin-=c,m.xmax-=c,m):b}}})},"esri/tasks/GeometryService":function(){define("../core/kebabDictionary ../core/accessorSupport/ensureType ../geometry/Extent ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ../geometry/support/jsonUtils ../request ./Task ./support/ProjectParameters dojo/_base/lang".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q){var x=a({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"}),y=h.ensureType(b);a=c.createSubclass({declaredClass:"esri.tasks.GeometryService",areasAndLengths:function(a,b){a={query:q.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/areasAndLengths",a).then(function(a){return a.data})},autoComplete:function(a,
b,c){var f=a[0].spatialReference;a={query:q.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(f.toJSON()),polygons:JSON.stringify(this._encodeGeometries(a).geometries),polylines:JSON.stringify(this._encodeGeometries(b).geometries)}),callbackParamName:"callback"};if(this.requestOptions||c)a=q.mixin({},this.requestOptions,c,a);return g(this.parsedUrl.path+"/autoComplete",a).then(function(a){return(a.data.geometries||[]).map(function(a){return new e({spatialReference:f,rings:a.rings})})})},buffer:function(a,
b){var c=q.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),f=a.outSpatialReference||a.geometries[0].spatialReference;a={query:c,callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/buffer",a).then(function(a){return(a.data.geometries||[]).map(function(a){return new e({spatialReference:f,rings:a.rings})})})},cut:function(a,b,c){var e=a[0].spatialReference,f=a.map(function(a){return a.toJSON()});a={query:q.mixin({},this.parsedUrl.query,
{f:"json",sr:JSON.stringify(e.toJSON()),target:JSON.stringify({geometryType:l.getJsonType(a[0]),geometries:f}),cutter:JSON.stringify(b.toJSON())}),callbackParamName:"callback"};if(this.requestOptions||c)a=q.mixin({},this.requestOptions,c,a);return g(this.parsedUrl.path+"/cut",a).then(function(a){a=a.data;return{cutIndexes:a.cutIndexes,geometries:(a.geometries||[]).map(function(a){return l.fromJSON(a).set("spatialReference",e)})}})},convexHull:function(a,b){var c=a[0].spatialReference;a={query:q.mixin({},
this.parsedUrl.query,{f:"json",sr:JSON.stringify(c.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/convexHull",a).then(function(a){return l.fromJSON(a.data.geometry).set("spatialReference",c)})},densify:function(a,b){var c=q.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),e=a.geometries[0].spatialReference;a={query:c,callbackParamName:"callback"};if(this.requestOptions||
b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/densify",a).then(function(a){return(a.data.geometries||[]).map(function(a){return l.fromJSON(a).set("spatialReference",e)})})},difference:function(a,b,c){var e=a[0].spatialReference;a={query:q.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(e.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a)),geometry:JSON.stringify({geometryType:l.getJsonType(b),geometry:b.toJSON()})}),callbackParamName:"callback"};if(this.requestOptions||
c)a=q.mixin({},this.requestOptions,c,a);return g(this.parsedUrl.path+"/difference",a).then(function(a){return(a.data.geometries||[]).map(function(a){return l.fromJSON(a).set("spatialReference",e)})})},distance:function(a,b){a={query:q.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/distance",a).then(this._handleDistanceResponse)},fromGeoCoordinateString:function(a,b){var c=
{};q.isObject(a.sr)?c.sr=a.sr.wkid||JSON.stringify(a.sr.toJSON()):c.sr=a.sr;c.strings=JSON.stringify(a.strings);c.conversionType=x.toJSON(a.conversionType||"mgrs");c.conversionMode=a.conversionMode;a={query:q.mixin({},this.parsedUrl.query,{f:"json"},c),callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/fromGeoCoordinateString",a).then(this._handleFromGeoCoordinateResponse)},generalize:function(a,b){var c=q.mixin({},this.parsedUrl.query,
{f:"json"},a.toJSON()),e=a.geometries[0].spatialReference;a={query:c,callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/generalize",a).then(function(a){return(a.data.geometries||[]).map(function(a){return l.fromJSON(a).set("spatialReference",e)})})},intersect:function(a,b,c){var e=a[0].spatialReference;a={query:q.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(e.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a)),
geometry:JSON.stringify({geometryType:l.getJsonType(b),geometry:b.toJSON()})}),callbackParamName:"callback"};if(this.requestOptions||c)a=q.mixin({},this.requestOptions,c,a);return g(this.parsedUrl.path+"/intersect",a).then(function(a){return(a.data.geometries||[]).map(function(a){return l.fromJSON(a).set("spatialReference",e)})})},lengths:function(a,b){a={query:q.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,
b,a);return g(this.parsedUrl.path+"/lengths",a).then(function(a){return a.data})},labelPoints:function(a,b){var c=a.map(function(a){return a.toJSON()}),e=a[0].spatialReference;a={query:q.mixin({},this.parsedUrl.query,{f:"json",sr:e.wkid?e.wkid:JSON.stringify(e.toJSON()),polygons:JSON.stringify(c)}),callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/labelPoints",a).then(function(a){return(a.data.labelPoints||[]).map(function(a){return l.fromJSON(a).set("spatialReference",
e)})})},offset:function(a,b){var c=q.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),e=a.geometries[0].spatialReference;a={query:c,callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/offset",a).then(function(a){return(a.data.geometries||[]).map(})},project:function(a,b){a=y(a);var c=q.mixin({},a.toJSON(),this.parsedUrl.query,{f:"json"}),e=a.outSR,f=l.getJsonType(a.geometries[0]),
d=this._decodeGeometries;a={query:c,callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/project",a).then(function(a){return d(a.data,f,e)})},relation:function(a,b){a={query:q.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/relation",a).then(this._handleRelationResponse)},reshape:function(a,b,c){var e=
a.spatialReference;a={query:q.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(e.toJSON()),target:JSON.stringify({geometryType:l.getJsonType(a),geometry:a.toJSON()}),reshaper:JSON.stringify(b.toJSON())}),callbackParamName:"callback"};if(this.requestOptions||c)a=q.mixin({},this.requestOptions,c,a);return g(this.parsedUrl.path+"/reshape",a).then(function(a){return l.fromJSON(a.data.geometry).set("spatialReference",e)})},simplify:function(a,b){var c=a[0].spatialReference,e=q.mixin({},this.parsedUrl.query,
{f:"json",sr:c.wkid?c.wkid:JSON.stringify(c.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),f=l.getJsonType(a[0]),d=this._decodeGeometries;a={query:e,callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/simplify",a).then(},toGeoCoordinateString:function(a,b){var c={};q.isObject(a.sr)?c.sr=a.sr.wkid||JSON.stringify(a.sr.toJSON()):c.sr=a.sr;c.coordinates=JSON.stringify(a.coordinates);
c.conversionType=x.toJSON(a.conversionType||"mgrs");c.conversionMode=a.conversionMode;c.numOfDigits=a.numOfDigits;c.rounding=a.rounding;c.addSpaces=a.addSpaces;a={query:q.mixin({},this.parsedUrl.query,{f:"json"},c),callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/toGeoCoordinateString",a).then(this._handleToGeoCoordinateResponse)},trimExtend:function(a,b){var c=q.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),e=a.sr;
a={query:c,callbackParamName:"callback"};if(this.requestOptions||b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/trimExtend",a).then(function(a){return(a.data.geometries||[]).map(})},union:function(a,b){var c=a[0].spatialReference;a={query:q.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(c.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),callbackParamName:"callback"};if(this.requestOptions||
b)a=q.mixin({},this.requestOptions,b,a);return g(this.parsedUrl.path+"/union",a).then(function(a){return l.fromJSON(a.data.geometry).set("spatialReference",c)})},_handleRelationResponse:function(a){return a.data.relations},_handleDistanceResponse:_handleToGeoCoordinateResponse:function(a){return a.data.strings},_handleFromGeoCoordinateResponse:function(a){return a.data.coordinates},_encodeGeometries:_decodeGeometries:function(a,b,c){var e=l.getGeometryType(b);a=a.geometries;var f=[],d={spatialReference:c.toJSON()},g=q.mixin;a.forEach(;return f},_toProjectGeometry:_fromProjectedGeometry:);q.mixin(a,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,
UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,
UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,
UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",
UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return a})},"esri/tasks/support/ProjectParameters":function(){define(["dojo/_base/array","../../core/Accessor","../../core/lang","../../geometry/support/jsonUtils"],function(a,h,p,m){return h.createSubclass({declaredClass:"esri.tasks.support.ProjectParameters",properties:{geometries:null,outSR:null,transformation:null,transformForward:null},toJSON:)})},"esri/tasks/support/StatisticDefinition":function(){define(["../../core/Accessor"],
function(a){return a.createSubclass({declaredClass:"esri.tasks.support.StatisticDefinition",properties:{maxPointCount:null,maxRecordCount:null,maxVertexCount:null,onStatisticField:null,outStatisticFieldName:null,statisticType:null},toJSON:)})},"esri/layers/graphics/controllers/OnDemandController2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/Evented ../../../core/HandleRegistry ../../../core/Promise ../../../geometry/Extent ./support/TileSet ../../../views/2d/layers/support/TileQueue ../../../views/2d/layers/support/TileStrategy ../../../views/2d/layers/support/TileInfoView ../../../views/2d/layers/support/TileKey ../../support/GraphicsManager ../../support/TileInfo".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n){(();a=function(a){function d(b){var d=a.call(this)||this;d._handles=new g;d._pendingQueries=new Map;d.layer=b.layer;d.layerView=b.layerView;d.graphics=b.graphics;d._tileInfo=n.create({spatialReference:d.layerView.view.spatialReference,size:512});d._tileInfoView=new t(d._tileInfo);d._tileQueue=new x({tileInfoView:d._tileInfoView,process:function(a){return d._fetchTile(a)}});d._tileSet=new q({layer:d.layer,
tileInfo:d._tileInfo});d._graphicsManager=new r({graphics:d.graphics,objectIdField:d.layer.objectIdField});d._tileStrategy=new y({container:{addTile:function(a){d._graphicsManager.add(a.featureSet.features,a.intentId);d._graphicsManager.removeIntent(a.intentId)},removeTile:removeAllTiles:,fetchTile:requestUpdate:
tileInfoView:d._tileInfoView,cachePolicy:"purge"});d._handles.add([d.layer.watch("definitionExpression",function(){return d._refresh()}),d.layer.on("edits",function(a){return d._editsHandler(a)})],"layer");return d}p(d,a);d.prototype.destroy=function(){this._handles.destroy();this._graphicsManager.destroy();this._tileStrategy.destroy();this._tileQueue.clear();this._pendingQueries.forEach(};Object.defineProperty(d.prototype,"graphics",{set:function(a){var b=
this,d=this._get("graphics");d!==a&&(this._handles.remove("graphics"),d&&d.forEach(,a&&(a.forEach(,this._handles.add([a.on("after-add",,a.on("after-remove",],"graphics")),this._set("graphics",a))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"updating",{get:
enumerable:!0,configurable:!0});d.prototype.update=function(a){this._tileQueue.pause();this._tileQueue.state=a.state;this._tileStrategy.update(a);this._tileQueue.resume();this.notifyChange("updating")};d.prototype._fetchTile=function(a){var b=this,d=this._graphicsManager.createIntentToAdd(),c=this._tileSet.fetch(a).then(function(b){return{key:a,intentId:d,attached:!0,coords:[0,0],featureSet:b,dispose:function(){}}});c.otherwise(function(){return b._graphicsManager.removeIntent(d)});return c};d.prototype._refresh=
function(){var a=this;this._tileQueue.reset();this._tileStrategy.updateTiles(function(b){var d=a._graphicsManager.createIntentToAdd(),c=a._tileSet.fetch(b.key).then(function(c){a._graphicsManager.remove(b.featureSet.features);b.intentId=d;b.featureSet=c;a._graphicsManager.add(b.featureSet.features,b.intentId);return b});c.always(;return c});this.notifyChange("updating")};d.prototype._editsHandler=function(a){var b=this,d=function(a){return a.objectId},
c=a.deletedFeatures.map(d);this._graphicsManager.delete(c);a=a.addedFeatures.concat(a.updatedFeatures).map(d);if(a.length){d=this.layer.createQuery();d.objectIds=a;d.outSpatialReference=this._tileInfo.spatialReference;var e=this._graphicsManager.createIntentToAdd(a);a=this.layer.queryFeatures(d);this._pendingQueries.set(e,a);this.notifyChange("updating");a.then(.always(function(){b._graphicsManager.removeIntent(e);b._pendingQueries.delete(e);b.notifyChange("updating")})}};
d.prototype._refetchHandler=function(a,d){var c=this,e=a.features;if(e){var f=this._tileInfo.spatialReference;this._tileStrategy.tiles.forEach(function(a,d){d=a.key.extent;var g=new b({xmin:d[0],ymin:d[1],xmax:d[2],ymax:d[3],spatialReference:f});e.forEach(function(b){b.geometry&&g.intersects(b.geometry)&&c._addFeatureToTile(b,a)})});this._graphicsManager.add(e,d)}};d.prototype._addFeatureToTile=function(a,b){var d=b.featureSet.features||[],c=this.layer.objectIdField,e=a.attributes&&a.attributes[c],
f;d.some(function(a){(a.attributes&&a.attributes[c])===e&&(f=a);return!!f});f?(f.geometry=a.geometry,f.attributes=a.attributes):d.push(a);b.featureSet.features=d};return d}(f.declared(e,c,l));m([f.property()],a.prototype,"graphics",null);m([f.property()],a.prototype,"layer",void 0);m([f.property()],a.prototype,"layerView",void 0);m([f.property()],a.prototype,"updating",null);return a=m([f.subclass("esri.layers.graphics.controllers.OnDemandController2D")],a)})},"esri/layers/graphics/controllers/support/TileSet":function(){define(["require",
"exports","../../../../geometry/Extent"],function(a,h,p){return function(){.prototype.fetch=function(a){return this._queryTile(a)};a.prototype._queryTile=a.prototype._createQuery=function(a){this.tileInfo.updateTileInfo(a);var e=this.tileInfo.spatialReference,f=a.extent,g=f[0],c=f[1],b=f[2],f=f[3],h=this.layer.createQuery();h.geometry=new p({xmin:g,ymin:c,xmax:b,ymax:f,spatialReference:e});
h.outSpatialReference=e;this._setResolutionParams(h,a);return h};a.prototype._setResolutionParams=function(a,e){var f=this.layer,g=f.geometryType;if("polyline"===g||"polygon"===g)e=this.tileInfo.lodAt(e.level).resolution,"polyline"===g&&(a.maxAllowableOffset=e),f.supportsCoordinatesQuantization&&(a.quantizationParameters={mode:"view",originPosition:"upperLeft",tolerance:e,extent:f.fullExtent})};return a}()})},"esri/views/2d/layers/support/TileQueue":function(){define(["require","exports","../../../../core/QueueProcessor"],
function(a,h,p){ar f=new Set,e=[],l=new Map;return function(){function a(a){var b=this;this.tileInfoView=a.tileInfoView;this._queue=new p({concurrency:6,process:a.process,peeker:function(a){return b._peek(a)}})}a.prototype.clear=function(){this._queue.clear()};a.prototype.find=a.prototype.has=function(a){return this._queue.has(a)};a.prototype.pause=function(){return this._queue.pause()};
a.prototype.push=function(a){return this._queue.push(a)};a.prototype.reset=function(){return this._queue.reset()};a.prototype.resume=function(){return this._queue.resume()};a.prototype._peek=function(a){var b=this;if(!this.state)return a[0];var c=this.tileInfoView,g=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY;a.forEach(function(a){var d=b.tileInfoView.getTileScale(a);l.has(d)||(l.set(d,[]),g=Math.max(d,g),h=Math.min(d,h));l.get(d).push(a);f.add(d)});var p=this.state.scale;l.has(p)||(m(e,f),
e.sort(),p=e.reduce(e[0]));p=Math.min(p,g);p=Math.max(p,h);a=l.get(p);var u=c.getClosestInfoForScale(p),r=u.getColumnForX(this.state.center[0]),n=u.getRowForY(this.state.center[1]);a.sort(;f.clear();l.clear();return a[0]};return a}()})},"esri/core/QueueProcessor":function(){define(["require",
"exports","dojo/Deferred","./Queue"],function(a,h,p,m){var f={};return function(){function a(a){this._apiPromises=new Map;this._resolvingPromises=new Map;this._isPaused=!1;this.concurrency=1;a.concurrency&&(this.concurrency=a.concurrency);this._queue=new m(a.peeker?{peeker:a.peeker}:void 0);this.process=a.process}a.prototype.clear=function(){this._queue.clear();var a=[];this._resolvingPromises.forEach(function(e){return a.push(e)});this._resolvingPromises.clear();a.forEach(function(a){return a.cancel()});
a.length=0;this._apiPromises.forEach(function(e){return a.push(e)});this._apiPromises.clear();a.forEach(function(a){return a.cancel()});this._isPaused=!1};a.prototype.find=a.prototype.has=function(a){return this._apiPromises.has(a)};a.prototype.pause=function(){this._isPaused=!0};a.prototype.push=function(a){var e=this,c=new p(function(b){e._resolvingPromises.has(a)?
e._resolvingPromises.get(a).cancel(b):(e._remove(a),e._scheduleNext())});this._add(a,c);this._scheduleNext();return c.promise};a.prototype.reset=function(){var a=[];this._resolvingPromises.forEach(function(e){return a.push(e)});this._resolvingPromises.clear();a.forEach(function(a){return a.cancel(f)})};a.prototype.resume=a.prototype._scheduleNext=a.prototype._next=function(){this._resolvingPromises.size!==
this.concurrency&&this._process(this._queue.pop())};a.prototype._process=function(a){var e=this;if(null!=a){var c=this._apiPromises.get(a),b=this.process(a);b&&"function"===typeof b.then?(this._resolvingPromises.set(a,b),b.then(function(b){b===f?e._process(a):(c.reject(b),e._remove(a),e._scheduleNext())})):(c.resolve(b),this._remove(a),this._scheduleNext())}};a.prototype._add=a.prototype._remove=
return a}()})},"esri/core/Queue":"esri/views/2d/layers/support/TileStrategy":function(){define(["require","exports","../../../../core/LRUCache","./TileKey"],function(a,h,p,m){ar e=[],l=[null,null],g=[],c=new p(30),b=new m(0,0,0,0);return function(){function a(a){this._tilesToRender=new Map;this._requests=new Map;this._updates=new Map;this._prevResolution=Number.POSITIVE_INFINITY;
this._isStationary=!1;this.cachePolicy="keep";this.tiles=new Map;this.container=a.container;this.tileInfoView=a.tileInfoView;this.requestUpdate=a.requestUpdate;this.fetchTile=a.fetchTile;a.cachePolicy&&(this.cachePolicy=a.cachePolicy)}a.prototype.destroy=function(){this._requests&&(this._requests.forEach(function(a){a.isFulfilled()||a.cancel()}),this._tilesToRender=this._requests=null)};Object.defineProperty(a.prototype,"updating",{get:
enumerable:!0,configurable:!0});a.prototype.update=function(a){var l=this,h=this.tiles,m=this._tilesToRender,q=this._requests,n=this._updates,p=this.tileInfoView.getTileCoverage(a.state);if(p){var d=p.lodInfo.level,k=a.state.resolution>this._prevResolution;this._createCoverageList(e,p);m.clear();for(var x=0,A=0;A<e.length;A++){var z=e[A];if(h.has(z)){var D=h.get(z);m.set(z,D);x++;if(D.attached)continue}else c.has(z)?x++:q.has(z)||this._getTile(z,a);k||this._addParentTile(z,m)}var B=x===e.length;!this._isStationary&&
a.stationary&&this.requestUpdate();this._isStationary=a.stationary;var C=[],F=[];h.forEach(function(a,c){b.set(c);m.has(c)||(!k&&B||!l.tileInfoView.intersects(p,b)?"purge"===l.cachePolicy?C.push(c):(b.level>d||!l.tileInfoView.intersects(p,b))&&C.push(c):F.push(c))});for(D=0;D<F.length;D++)z=F[D],m.set(z,h.get(z));for(a=0;a<C.length;a++)z=C[a],n.has(z)&&(n.get(z).cancel(),f(n,z)),D=h.get(z),D.dispose(),f(h,z);this.container.removeAllTiles();m.forEach(;q.forEach(function(a,
c){b.set(c);if(b.level>d||!l.tileInfoView.intersects(p,b))a.cancel(),g.push(c)});for(h=0;h<g.length;h++)z=g[h],f(q,z);g.length=0}};a.prototype.updateTiles=function(a,b){var c=this;this._tilesToRender.forEach(function(e,g){e.attached&&(e=a(e,b))&&(c._updates.has(g)&&(c._updates.get(g).cancel(),f(c._updates,g)),e.then(function(a){f(c._updates,g);c._tilesToRender.has(g)&&c._tilesToRender.set(g,a);c.requestUpdate()}).otherwise(function(a){f(c._updates,g);c.requestUpdate();if(a&&"cancel"!==a.dojoType)throw a;
}),c._updates.set(g,e))})};a.prototype._addParentTile=function(a,b){this._getAvailableParentTile(l,a);l[0]&&!b.has(l[0])&&b.set(l[0],l[1])};a.prototype._getTile=function(a,e){var g=this;e=this.fetchTile(a,e).then(function(c){b.set(a);g.tileInfoView.getTileCoords(c.coords,b);c.resolution=g.tileInfoView.getTileResolution(b);e=g.tileInfoView.tileInfo.size;c.width=e[0];c.height=e[1];g.tiles.set(a,c);f(g._requests,a);g.requestUpdate();var e}).otherwise(function(b){b&&"no data"===b.message&&c.insert(a,
a);f(g._requests,a)});this._requests.set(a,e)};a.prototype._getAvailableParentTile=function(a,b){a[0]=null;for(a[1]=null;b=this.tileInfoView.getTileParentId(b);)if(this.tiles.has(b)){a[0]=b;a[1]=this.tiles.get(b);break}return a};a.prototype._createCoverageList=function(a,c){a.length=0;var e=c.spans;c=c.lodInfo;var f=c.level;if(0!==e.length)for(var g=0;g<e.length;g++)for(var n=e[g],l=n.row,d=n.colTo,n=n.colFrom;n<=d;n++)b.set(f,l,c.normalizeCol(n),c.getWorldForColumn(n)),a.push(b.id)};return a}()})},
"esri/core/LRUCache":"esri/views/2d/layers/support/TileKey":function(){define(["require","exports","../../../../core/ObjectPool"],function(a,h,p){a=function(){function a(a,
e,l,g){"string"===typeof a?(a=a.split("/"),e=a[1],l=a[2],g=a[3],this.level=+a[0],this.row=+e,this.col=+l,this.world=+g||0):a&&"object"===typeof a?(this.level=a.level||0,this.row=a.row||0,this.col=a.col||0,this.world=a.world||0):(this.level=+a||0,this.row=+e||0,this.col=+l||0,this.world=+g||0)}a.from=a.getId=Object.defineProperty(a.prototype,"id",
{get:enumerable:!0,configurable:!0});a.prototype.equals=a.prototype.release=a.prototype.set=function(a,e,l,g){var c=typeof a;if("object"===c)return a;"string"===c?(a=a.split("/"),e=a[1],l=a[2],g=a[3],this.level=parseFloat(a[0]),this.row=parseFloat(e),this.col=parseFloat(l),this.world=parseFloat(g)):(this.level=a,this.row=
e,this.col=l,this.world=g);return this};a.prototype.toString=return a}();a.pool=new p(a,!0,null,25,50);return a})},"esri/views/2d/layers/support/TileInfoView":function(){define("require exports ./LODInfo ./TileKey ./TileSpan ./TileCoverage".split(" "),function(a,h,p,m,f,e){var l=function(){.create=function(b,c){b[1]>c[1]&&(n=[c,b],b=n[0],c=n[1]);n=b[0];b=b[1];var e=c[0];c=c[1];var f=e-n,g=c-b,g=0!==g?f/g:0,l=(Math.ceil(b)-b)*g,h=(Math.floor(b)-b)*g;return new a(n,Math.floor(b),Math.ceil(c),g,0>f?l:h,0>f?h:l,0>f?e:n,0>f?n:e);var n};a.prototype.incrRow=a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};a.prototype.getRightCol=return a}(),g=[[0,0],
[0,0],[0,0],[0,0]];return function(){function a(a,c){var b=this;this.tileInfo=a;this.fullExtent=c;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=a.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var f=this._lodInfos=e.map(function(b){return p.create(a,b,c)});e.forEach(this);this._wrap=a.spatialReference.isWrappable}a.prototype.getTileBounds=function(a,c){var b=
this._infoByLevel[c.level];return b?b.getTileBounds(a,c):a};a.prototype.getTileCoords=function(a,c){var b=this._infoByLevel[c.level];return b?b.getTileCoords(a,c):a};a.prototype.getTileCoverage=function(a){var b=this.getClosestInfoForScale(a.scale),c=e.pool.acquire(b),h=this._wrap,m;m=Infinity;var p=-Infinity,r,n,w=c.spans;g[0][0]=g[0][1]=g[1][1]=g[3][0]=0;g[1][0]=g[2][0]=a.size[0];g[2][1]=g[3][1]=a.size[1];for(var d=0;d<g.length;d++){var k=g[d];a.toMap(k,k);k[0]=b.getColumnForX(k[0]);k[1]=b.getRowForY(k[1])}a=
[];k=3;for(d=0;4>d;d++){if(g[d][1]!==g[k][1]){var v=l.create(g[d],g[k]);m=Math.min(v.ymin,m);p=Math.max(v.ymax,p);void 0===a[v.ymin]&&(a[v.ymin]=[]);a[v.ymin].push(v)}k=d}if(null==m||null==p||100<p-m)return null;for(k=[];m<p;){null!=a[m]&&(k=k.concat(a[m]));r=Infinity;n=-Infinity;for(d=k.length-1;0<=d;d--)v=k[d],r=Math.min(r,v.getLeftCol()),n=Math.max(n,v.getRightCol());r=Math.floor(r);n=Math.floor(n);if(m>=b.first[1]&&m<=b.last[1])if(h)if(b.size[0]<b.worldSize[0])for(v=Math.floor(n/b.worldSize[0]),
d=Math.floor(r/b.worldSize[0]);d<=v;d++)w.push(new f(m,Math.max(b.getFirstColumnForWorld(d),r),Math.min(b.getLastColumnForWorld(d),n)));else w.push(new f(m,r,n));else r>b.last[0]||n<b.first[0]||(r=Math.max(r,b.first[0]),n=Math.min(n,b.last[0]),w.push(new f(m,r,n)));m+=1;for(d=k.length-1;0<=d;d--)v=k[d],v.ymax>=m?v.incrRow():k.splice(d,1)}return c};a.prototype.getTileIdAtParent=a.prototype.getTileParentId=a.prototype.getTileResolution=function(a){return(a=
this._infoByLevel[a.level])?a.resolution:-1};a.prototype.getTileScale=a.prototype.intersects=function(a,c){var b=m.pool.acquire(c);c=this._infoByLevel[b.level];var e=a.lodInfo;if(e.resolution>c.resolution){var f=m.pool.acquire(this.getTileIdAtParent(e,b)),g=e.denormalizeCol(f.col,f.world);c=a.spans.some(function(a){return a.row===f.row&&a.colFrom<=g&&a.colTo>=g});m.pool.release(b);m.pool.release(f);return c}if(e.resolution<c.resolution){var l=
a.spans.reduce([Infinity,-Infinity,Infinity,-Infinity]);a=l[0];var n=l[1],h=l[2],l=l[3],d=c.denormalizeCol(b.col,b.world),k=e.getColumnForX(c.getXForColumn(d)),p=e.getRowForY(c.getYForRow(b.row)),d=e.getColumnForX(c.getXForColumn(d+1))-1;c=e.getRowForY(c.getYForRow(b.row+1))-1;m.pool.release(b);return!(k>l||d<h||p>n||c<a)}var q=e.denormalizeCol(b.col,b.world);c=a.spans.some(;m.pool.release(b);return c};a.prototype.getClosestInfoForScale=return a}()})},"esri/views/2d/layers/support/LODInfo":function(){define(["require","exports","./TileKey","../../../../geometry/support/spatialReferenceUtils"],function(a,h,p,m){eturn function(){.create=function(e,g,c){var b=m.getInfo(e.spatialReference),l=[e.origin.x,e.origin.y],h=[e.size[0]*g.resolution,e.size[1]*g.resolution],p=[-Infinity,-Infinity],t=[Infinity,Infinity],u=[Infinity,Infinity];c&&(f(p,Math.max(0,Math.floor((c.xmin-l[0])/h[0])),Math.max(0,Math.floor((l[1]-c.ymax)/h[1]))),f(t,Math.max(0,
Math.floor((c.xmax-l[0])/h[0])),Math.max(0,Math.floor((l[1]-c.ymin)/h[1]))),f(u,t[0]-p[0]+1,t[1]-p[1]+1));var r;b?(e=[Math.ceil(Math.round(2*b.origin[1]/g.resolution)/e.size[0]),u[1]],b=[Math.floor((b.origin[0]-l[0])/h[0]),p[1]],c=[e[0]-b[0]-1,t[1]],r=!0):(b=p,c=t,e=u,r=!1);return new a(g.level,g.resolution,g.scale,l,p,t,u,h,b,c,e,r)};a.prototype.normalizeCol=a.prototype.denormalizeCol=a.prototype.getWorldForColumn=a.prototype.getFirstColumnForWorld=a.prototype.getLastColumnForWorld=a.prototype.getColumnForX=a.prototype.getXForColumn=a.prototype.getRowForY=a.prototype.getYForRow=a.prototype.getTileBounds=function(a,e){e=p.pool.acquire(e);var c=this.getXForColumn(this.denormalizeCol(e.col,e.world)),b=this.getYForRow(e.row+1),f=this.getXForColumn(this.denormalizeCol(e.col,e.world)+1),g=this.getYForRow(e.row);a[0]=c;a[1]=b;a[2]=f;a[3]=g;p.pool.release(e);return a};a.prototype.getTileCoords=function(a,e){e=p.pool.acquire(e);f(a,this.getXForColumn(this.denormalizeCol(e.col,e.world)),this.getYForRow(e.row));
p.pool.release(e);return a};return a}()})},"esri/views/2d/layers/support/TileSpan":function(){define(["require","exports","../../../../core/ObjectPool"],function(a,h,p){a=);a.pool=new p(a,!0);return a})},"esri/views/2d/layers/support/TileCoverage":function(){define(["require","exports","../../../../core/ObjectPool","../../../../core/ArrayPool","./TileSpan"],function(a,h,p,m,f){a=function(){.prototype.release=return a}();a.pool=new p(a,!0);return a})},"esri/layers/support/GraphicsManager":function(){define(["../../core/Accessor"],function(a){var h=0;return a.createSubclass({constructor:function(){this._deletedGraphicsIndex=new Set;this._intentsIndex=new Map},destroy:properties:{graphics:null,indexById:{value:null,
dependsOn:["graphics","objectIdField"],get:function(){return this._createIndexById(this.graphics&&this.graphics.toArray(),this.objectIdField)}},objectIdField:null},_intentsIndex:null,_oldIndex:null,_deletedGraphicsIndex:null,beginPagedUpdate:addPage:revertPagedUpdate:function(){var a=this._removeLeftOnly(this.indexById,this._oldIndex);this.indexById=this._oldIndex;this._oldIndex=null;this.graphics.removeMany(a)},
endPagedUpdate:function(){var a=this._removeLeftOnly(this._oldIndex,this.indexById);this._oldIndex=null;this.graphics.removeMany(a)},findGraphic:function(a){return(a=this.indexById&&this.indexById.get(a))&&a.graphic},removeAll:add:function(a,h){a&&a.length&&(this.indexById=this.indexById||new Map,a=this._updateAndExtractNew(a,this.indexById,this._oldIndex,h),this.graphics.removeMany(a.toRemove),this.graphics.addMany(a.toAdd))},
remove:function(a){this._remove(a,!1)},delete:isDeleted:function(a){return this._deletedGraphicsIndex.has(a)},createIntentToAdd:function(a){a&&this._intentsIndex.forEach(this);var m=h++;this._intentsIndex.set(m,{ignoredIds:new Set});return m},findIntent:function(a){return this._intentsIndex.get(a)},removeIntent:function(a){this._intentsIndex.delete(a)},_createIndexById:function(a,h){var f;if(a&&a.length&&h){var e,
l,g;f=new Map;for(e=0;l=a[e];e++)g=l.attributes&&l.attributes[h],null!=g&&f.set(g,{graphic:l,refCount:1})}return f},_updateAndExtractNew:function(a,h,f,e){var l=[],g=[],c=a?a.length:0,b=this.objectIdField,m=this.findIntent(e);for(e=0;e<c;e++){var p=a[e],y=p.attributes&&p.attributes[b];if(null!=y){var t=f&&f.get(y);(t=h.get(y)||t)?m&&m.ignoredIds.has(y)||(h.set(y,{graphic:p,refCount:t.refCount+1}),g.push(t.graphic),l.push(p)):this.isDeleted(y)||(h.set(y,{graphic:p,refCount:1}),l.push(p))}else l.push(p)}return{toRemove:g,
toAdd:l}},_remove:function(a,h){a=a||[];a="object"===typeof a[0]?a.map(function(a){return a.attributes&&a.attributes[this.objectIdField]}.bind(this)):a;var f=this._extractGraphics(a,this._oldIndex),e=this._extractGraphics(a,this.indexById);a.forEach(function(a){h&&this._deletedGraphicsIndex.add(a);this._removeFromIndex(a,this._oldIndex,h);this._removeFromIndex(a,this.indexById,h)}.bind(this));this.graphics.removeMany(f.concat(e))},_removeFromIndex:function(a,h,f){if(h&&h.has(a))if(f)h.delete(a);else{f=
h.get(a);var e=f.refCount-1;0===e?h.delete(a):f.refCount=e}},_removeLeftOnly:function(a,h){var f=[];a&&a.forEach(function(e,l){var g=e.graphic;!g||h&&h.has(l)||(--e.refCount,0===e.refCount&&a.delete(l),f.push(g))});return f},_extractGraphics:function(a,h){return a&&h?a.map(:[]}})})},"esri/layers/graphics/controllers/SnapshotController":function(){define("dojo/_base/lang dojo/promise/all ../../support/GraphicsManager ../../../core/Accessor ../../../core/Promise ../../../core/Evented ../../../core/HandleRegistry ../../../geometry/support/scaleUtils".split(" "),
function(a,h,p,m,f,e,l,g){return m.createSubclass([f,e],{declaredClass:"esri.layers.graphics.controllers.SnapshotController",constructor:initialize:function(){this.addResolvingPromise(h([this.layer,this.layerView]));this.then(this._init.bind(this))},destroy:function(){this.cancelQuery();this._gManager&&(this._gManager.destroy(),this._gManager=null);this._handles.destroy();this._pendingQueries=this._handles=null},_cancelErrorMsg:"SnapshotController: query cancelled",
_featureResolution:{value:1,scale:3780},_gManager:null,_handles:null,_maxFeatures:{point:16E3,multipoint:8E3,polyline:4E3,polygon:4E3,multipatch:4E3},_source:null,_started:!1,properties:{_pendingQueries:null,updating:{value:!1,dependsOn:["_pendingQueries"],get:function(){return!!(this._pendingQueries&&0<this._pendingQueries.size)}},graphics:{value:null,set:function(a){this._get("graphics")!==a&&(this._handles.remove("graphics"),a&&(this._collectionChanged({added:a.toArray()}),this._handles.add(a.on("change",
this._collectionChanged.bind(this)),"graphics")),this._set("graphics",a))}},extent:{},hasAllFeatures:!1,hasFeatures:!1,layer:null,layerView:null,maxPageSize:null,pageSize:null,paginationEnabled:!1},update:startup:function(){this._started||(this._started=!0,this._resolutionParams=this._getResolutionParams(),this._queryFeatures())},refresh:cancelQuery:function(){this._pendingQueries&&(this._pendingQueries.forEach(function(a,
b){a.isFulfilled()||a.cancel(Error(this._cancelErrorMsg))}.bind(this)),this._pendingQueries.clear(),this.notifyChange("updating"))},_init:function(){var a=this.layer,b=a.advancedQueryCapabilities;this.paginationEnabled=!(!b||!b.supportsPagination);this._source=a.source;this.pageSize=null==this.maxPageSize?a.maxRecordCount:Math.min(a.maxRecordCount,this.maxPageSize);this._gManager=new p({graphics:this.graphics,objectIdField:a.objectIdField});this._setupStateWatchers()},_getResolutionParams:function(){var a=
this.layer,b=a.supportsCoordinatesQuantization,e;if("polyline"===a.geometryType||"polygon"===a.geometryType){var f=g.getUnitValue(this.layerView.view.spatialReference);null!=f&&(e=this._featureResolution.scale,f=this._featureResolution.value/f,e=a.maxScale?a.maxScale:a.minScale?Math.min(e,a.minScale):Math.min(e,g.getScale(this.layerView.view,a.fullExtent)),e*=f/this._featureResolution.scale)}return e?{maxAllowableOffset:b?null:e,quantizationParameters:b?{mode:"view",originPosition:"upperLeft",tolerance:e,
extent:a.fullExtent}:null}:null},_setupStateWatchers:function(){this._handles.add([this.watch("extent",this.refresh.bind(this)),this.layer.watch("definitionExpression",this.refresh.bind(this)),this.layer.on("edits",this._editsHandler.bind(this))])},_createQueryParams:function(){var c=this.layerView,b=this.layer.createQuery();b.outSpatialReference=c.view.spatialReference;b.geometry=this.extent;a.mixin(b,this._resolutionParams);this.paginationEnabled&&(b.start=0,b.num=this.pageSize);return b},_queryFeatures:function(){this.cancelQuery();
this.hasAllFeatures=this.hasFeatures=!1;this._gManager.beginPagedUpdate();this.emit("query-start");this._executeQuery(this._createQueryParams())},_executeQuery:function(a){var b=this._source.queryFeatures(a),c=this._gManager.createIntentToAdd();this._querySetup(c,b);b.then(this._processFeatureSet.bind(this,a,c)).otherwise(this._queryError.bind(this,c)).always(this._queryTeardown.bind(this,c))},_processFeatureSet:function(a,b,e){var c=e.exceededTransferLimit,f=e.features,g=this.layer.geometryType.toLowerCase().replace(/^esriGeometry/i,
""),h=this._maxFeatures[g]||0,g=f?f.length:0,l=this._gManager.graphics.length+g,n=l>=h;n&&(h=l-h)&&f.splice(g-h,h);a=c&&this.paginationEnabled&&!n?this._queryNextPage(a):!1;f&&this._gManager.addPage(f,b);this.hasFeatures=!0;a||(this._gManager.endPagedUpdate(),this.hasAllFeatures=!c,this.emit("query-end",{success:!0}));return e},_queryNextPage:function(a){a.start+=this.pageSize;this._executeQuery(a);return!0},_queryError:function(a,b){b&&"cancel"===b.dojoType&&!this.hasFeatures?this._gManager.revertPagedUpdate():
this._gManager.endPagedUpdate();this.emit("query-end",{success:!1})},_querySetup:function(a,b){this._pendingQueries.set(a,b);this.notifyChange("updating")},_queryTeardown:function(a){this._gManager.removeIntent(a);this._pendingQueries.delete(a);this.notifyChange("updating")},_collectionChanged:function(a){var b,c,e;if(e=a.added)for(b=0;c=e[b];b++)c.layer=this.layer;if(e=a.removed)for(b=0;c=e[b];b++)c.layer=null},_editsHandler:function(a){var b=function(a){return a.objectId},c=a.deletedFeatures.map(b);
this._gManager.delete(c);a=a.addedFeatures.concat(a.updatedFeatures).map(b);a.length&&(b=this._createQueryParams(),b.objectIds=a,b=this._source.queryFeatures(b),a=this._gManager.createIntentToAdd(a),this._querySetup(a,b),b.then(this._processRefetch.bind(this,a)).otherwise(this._refetchError.bind(this,a)).always(this._queryTeardown.bind(this,a)))},_processRefetch:function(a,b){(b=b.features)&&this._gManager.add(b,a)},_refetchError:function(a,b){}})})},"esri/layers/graphics/sources/FeatureLayerSource":function(){define("dojo/_base/lang ../../../core/Accessor ../../../core/Promise ../../../core/urlUtils ../../../core/Error ../../../request ../../../tasks/QueryTask".split(" "),
function(a,h,p,m,f,e,l){return h.createSubclass([p],{getDefaults:function(e){var c=this.inherited(arguments),b=e.layer;b&&(c=a.mixin(c,{url:b.url,layerId:b.layerId,gdbVersion:b.gdbVersion}));return c},initialize:properties:{layer:{},layerId:{},gdbVersion:{},parsedUrl:{dependsOn:["url","layerId"],get:function(){var a=this.url?m.urlToObject(this.url):null;null!=this.layerId&&null!=a&&(a.path=m.join(a.path,this.layerId.toString()));return a}},
queryTask:{dependsOn:["parsedUrl","gdbVersion"],get:function(){return new l({url:this.parsedUrl.path,gdbVersion:this.gdbVersion})}},url:{}},applyEdits:function(a){var c=a.addFeatures.map(this._serializeFeature.bind(this)),b=a.updateFeatures.map(this._serializeFeature.bind(this));a=this._getFeatureIds(a.deleteFeatures);c={f:"json",adds:c.length?JSON.stringify(c):null,updates:b.length?JSON.stringify(b):null,deletes:a.length?a.join(","):null};return e(this.parsedUrl.path+"/applyEdits",{query:c,method:"post",
responseType:"json",callbackParamName:"callback"}).then(this._createEditsResult.bind(this))},queryFeatures:function(a){return this.queryTask.execute(a)},queryObjectIds:function(a){return this.queryTask.executeForIds(a)},queryFeatureCount:function(a){return this.queryTask.executeForCount(a)},queryExtent:function(a){return this.queryTask.executeForExtent(a)},_fixSymbolUrls:function(a){if(a){var c=this.parsedUrl.path+"/images/",b=[a.symbol,a.defaultSymbol];(a=a.classBreakInfos||a.uniqueValueInfos)&&
a.forEach(function(a){b.push(a.symbol)});b.forEach(function(a){var b=a&&a.url;b&&-1===b.search(/https?\:/i)&&(a.url=c+b)})}},_updateUrl:function(a){a&&(this.url=this.url.replace(/^http:/i,"https:"))},_fetchService:function(){return null==this.layerId?e(this.url,{query:{f:"json"},responseType:"json",callbackParamName:"callback"}).then(function(a){this._updateUrl(a.ssl);(a=a.data)&&a.layers&&a.layers[0]&&(this.layerId=a.layers[0].id);return this._fetchServiceLayer()}.bind(this)):this._fetchServiceLayer()},
_fetchServiceLayer:function(){return e(this.parsedUrl.path,{query:a.mixin({f:"json"},this.parsedUrl.query),responseType:"json",callbackParamName:"callback"}).then(function(a){this._updateUrl(a.ssl);a=a.data;this._fixSymbolUrls(a.drawingInfo&&a.drawingInfo.renderer);this.layerDefinition=a}.bind(this))},_serializeFeature:function(a){var c=a.geometry;a=a.attributes;return{geometry:c&&c.toJSON(),attributes:a}},_getFeatureIds:function(a){var c=this.layer.objectIdField,b=a[0],e=!(!b||null==b.objectId),
f=!(!b||!b.attributes);return a.map(function(a){var b=null;e?b=a.objectId:f&&(b=a.attributes&&a.attributes[c]);return b},this)},_createEditsResult:function(a){var c={};a=a.data;c.addFeatureResults=a.addResults?a.addResults.map(this._createFeatureEditResult.bind(this)):[];c.updateFeatureResults=a.updateResults?a.updateResults.map(this._createFeatureEditResult.bind(this)):[];c.deleteFeatureResults=a.deleteResults?a.deleteResults.map(this._createFeatureEditResult.bind(this)):[];return c},_createFeatureEditResult:function(a){var c=
a.success?null:a.error||{};return{objectId:a.objectId,globalId:a.globalId,error:c?new f("feature-layer-source:edit-failure",c.description,{code:c.code}):null}}})})},"esri/layers/graphics/sources/MemorySource":function(){define("../../../core/Collection ../../../core/Promise ../../../core/promiseUtils ../../../core/Error ../../../tasks/support/FeatureSet ../../../Graphic ../QueryEngine".split(" "),function(a,h,p,m,f,e,l){return a.ofType(e).createSubclass([h],{properties:{layer:{value:null},_queryEngine:{value:null,
dependsOn:["layer.loaded"],get:function(){return this.get("layer.loaded")?new l({features:this,objectIdField:this.layer.objectIdField}):null}}},queryFeatures:function(a){return this._queryEngine?this._queryEngine.queryFeatures(a).then(:this._rejectQuery("Not ready to execute query")},queryObjectIds:function(a){return this._queryEngine?this._queryEngine.queryObjectIds(a):this._rejectQuery("Not ready to execute query")},queryFeatureCount:function(a){return this._queryEngine?
this._queryEngine.queryFeatureCount(a):this._rejectQuery("Not ready to execute query")},queryExtent:function(a){return this._queryEngine?this._queryEngine.queryExtent(a):this._rejectQuery("Not ready to execute query")},_rejectQuery:)})},"esri/layers/graphics/QueryEngine":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Error ../../core/promiseUtils ../../geometry/support/graphicsUtils".split(" "),
function(a,h,p,m,f,e,l,g,c){a=function(a){(b,a);b.prototype.queryFeatures=function(a){if(this.features)if(a)if(this._isSupportedQuery(a)){var b=this._createFilters(a);a=b.length?this._executeQuery(a,b):this._rejectQuery("Invalid query")}else a=this._rejectQuery("Unsupported query");else a=this._returnAllFeatures();else a=this._rejectQuery("Engine not initialized");return a};b.prototype.queryObjectIds=
function(a){return this.objectIdField?this.queryFeatures(a).then(this._getObjectIds.bind(this)):this._rejectQuery("Unsupported query")};b.prototype.queryFeatureCount=b.prototype.queryExtent=function(a){var b=this;return this.queryFeatures(a).then(};b.prototype._returnAllFeatures=b.prototype._executeQuery=function(a,
b){var c=this,e=this.features.filter(;return g.resolve(e.toArray())};b.prototype._isSupportedQuery=function(a){var b=!0;if(null!=a.distance||null!=a.geometryPrecision||a.groupByFieldsForStatistics&&a.groupByFieldsForStatistics.length||null!=a.maxAllowableOffset||a.multipatchOption||null!=a.num||a.orderByFields&&a.orderByFields.length||a.outFields&&a.outFields.length||a.outSpatialReference||a.outStatistics&&a.outStatistics.length||a.pixelSize||
a.quantizationParameters||a.relationParam||a.returnDistinctValues||null!=a.start||a.text||a.timeExtent||a.where||a.objectIds&&a.objectIds.length&&!this.objectIdField)b=!1;return b};b.prototype._createFilters=function(a){var b=[];a.objectIds&&a.objectIds.length&&b.push(this._createObjectIdFilter());a.geometry&&"extent"===a.geometry.type&&"intersects"===a.spatialRelationship&&b.push(this._createExtentFilter());return b};b.prototype._createExtentFilter=function(){return function(a,b){a=a.geometry;b=
b.geometry;return a&&b.intersects(a)}};b.prototype._createObjectIdFilter=function(){var a=this;return function(b,c){b=b.attributes;return-1<c.objectIds.indexOf(b&&b[a.objectIdField])}};b.prototype._rejectQuery=function(a){return g.reject(new l(this.declaredClass,a))};b.prototype._getObjectIds=function(a){var b=this.objectIdField,c=[];a.forEach(function(a){a=(a=a.attributes)&&a[b];null!=a&&c.push(a)});return c};b.prototype._getExtent=return b}(f.declared(e));
m([f.property()],a.prototype,"features",void 0);m([f.property()],a.prototype,"objectIdField",void 0);return a=m([f.subclass("esri.layers.graphics.QueryEngine")],a)})},"esri/layers/TileLayer":function(){define("dojo/_base/lang dojo/io-query ../request ../core/urlUtils ../core/promiseUtils ../geometry/SpatialReference ./TiledLayer ./mixins/ArcGISMapService ./mixins/ArcGISCachedService ./mixins/OperationalLayer ./mixins/PortalLayer ./support/arcgisLayers ./support/arcgisLayerUrl".split(" "),function(a,
h,p,m,f,e,l,g,c,b,q,x,y){return l.createSubclass([g,c,b,q],{declaredClass:"esri.layers.TileLayer",_mapsWithAttribution:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_attributionServices:["services.arcgisonline.com/arcgis/rest/services","servicesdev.arcgisonline.com/arcgis/rest/services","servicesqa.arcgisonline.com/arcgis/rest/services"],normalizeCtorArgs:function(b,c){return"string"===typeof b?a.mixin({},{url:b},c):b},load:function(){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service","Map Service"]}).always(this._fetchService.bind(this)))},
properties:{operationalLayerType:{get:function(){if(this.capabilities)return-1!==this.capabilities.indexOf("Map")?"ArcGISTiledMapServiceLayer":"ArcGISTiledImageServiceLayer";var a=this.url||this.portalItem&&this.portalItem.url;return a&&/\/ImageServer(\/|\/?$)/i.test(a)?"ArcGISTiledImageServiceLayer":"ArcGISTiledMapServiceLayer"}},attributionDataUrl:{dependsOn:["parsedUrl"],get:function(){return this._getDefaultAttribution(this._getMapName(this.parsedUrl.path.toLowerCase()))}},popupTemplates:null,
tileServers:{dependsOn:["parsedUrl"],value:null,cast:function(a){return Array.isArray(a)?a.map(:null},get:,type:{value:"tile",json:{read:!1}},spatialReference:{json:{read:{source:["spatialReference","tileInfo"],reader:function(a,b){return(a=a||b.tileInfo&&b.tileInfo.spatialReference)&&e.fromJSON(a)}}}}},getTileUrl:function(a,b,c){var e=this.tileServers,f=this.parsedUrl.query?h.objectToQuery(this.parsedUrl.query):
"";this.token&&(f=f+(f?"\x26":"")+"token\x3d"+encodeURIComponent(this.token));this.resampling&&!this.tilemapCache&&this.supportsBlankTile&&(f=f+(f?"\x26":"")+"blankTile\x3dfalse");this.refreshTimestamp&&(f=f+(f?"\x26":"")+"_ts\x3d"+this.refreshTimestamp);return(e&&e.length?e[b%e.length]:this.parsedUrl.path)+"/tile/"+a+"/"+b+"/"+c+(f?"?"+f:"")},_fetchService:function(){return f.resolve().then(function(){return this.resourceInfo||p(this.parsedUrl.path,{query:a.mixin({f:"json"},this.parsedUrl.query),
responseType:"json",callbackParamName:"callback"})}.bind(this)).then(function(a){a.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));this.read(a.data,{origin:"service",url:this.parsedUrl});if(10.1===this.version&&!y.isHostedAgolService(this.url))return x.fetchServerVersion(this.url).then(bind(this)).otherwise(function(){})}.bind(this))},_getMapName:_getDefaultAttribution:function(a){if(a){var b;a=a.toLowerCase();for(var c=0,e=this._mapsWithAttribution.length;c<e;c++)if(b=this._mapsWithAttribution[c],-1<b.toLowerCase().indexOf(a))return m.makeAbsolute("//static.arcgis.com/attribution/"+b)}},_getDefaultTileServers:function(a){var b=-1!==a.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),c=-1!==a.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return b||c?[a,a.replace(b?/server\.arcgisonline/i:/services\.arcgisonline/i,b?"services.arcgisonline":
"server.arcgisonline")]:[]}})})},"esri/layers/support/arcgisLayers":function(){define("require exports dojo/_base/lang dojo/when ./arcgisLayerUrl ../../core/promiseUtils ../../core/requireUtils ../../request ../../core/Error ./arcgisLayerUrl".split(" "),function(a,h,p,m,f,e,l,g,c,b){function q(a,b){return a.sublayerIds.map(function(d){return new a.Constructor(p.mixin({},b,{layerId:d,sublayerTitleMode:"service-name"}))})}function x(f){var g=b.parse(f);if(!g)return e.reject(new c("arcgis-layers:url-mismatch",
"The url '${url}' is not a valid arcgis resource",{url:f}));var d=g.serverType,k=g.sublayer,n={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"};switch(d){case "MapServer":d=null!=k?"FeatureLayer":t(f).then(;break;case "ImageServer":d=r(f).then(function(a){var b=a.tileInfo&&a.tileInfo.format;return a.tileInfo?b&&"LERC"===b.toUpperCase()&&a.cacheType&&"elevation"===a.cacheType.toLowerCase()?"ElevationLayer":
"TileLayer":"ImageryLayer"});break;case "SceneServer":d=r(g.url.path).then(function(a){var b={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer"};return a&&Array.isArray(a.layers)&&0<a.layers.length&&(a=a.layers[0].layerType,null!=b[a])?b[a]:"SceneLayer"});break;default:d=n[d]}var h={FeatureLayer:!0,SceneLayer:!0},p={parsedUrl:g,Constructor:null,sublayerIds:null},q;return m(d).then(function(a){q=a;if(h[a]&&null==k)return y(f).then(}).then(function(){return l.when(a,"../"+q)}).then(}function y(a){return r(a).then(function(a){return a&&Array.isArray(a.layers)?a.layers.map(function(a){return a.id}).reverse():[]})}unction u(a,b){a=a.Constructor.prototype.declaredClass;return"esri.layers.FeatureLayer"===a||"esri.layers.StreamLayer"===a?p.mixin({returnZ:!0,outFields:["*"]},b):b}function r(a){return g(a,
{responseType:"json",callbackParamName:"callback",query:{f:"json"}}).then(function(a){return a.data})}h.fromUrl=function(b){return x(b.url).then(function(c){var d=u(c,p.mixin({},b.properties,{url:b.url}));return c.sublayerIds?l.when(a,"../GroupLayer").then(function(a){var b=new a({title:c.parsedUrl.title});q(c,d).forEach(function(a){return b.add(a)});return e.resolve(b)}):e.resolve(new c.Constructor(d))})};h.fetchServerVersion=function(a){if(!f.test(a))return e.reject();a=a.replace(/(.*\/rest)\/.*/i,
"$1")+"/info";return g(a,{query:{f:"json"},responseType:"json",callbackParamName:"callback"}).then(function(a){return a.data&&a.data.currentVersion?a.data.currentVersion:e.reject()})}})},"esri/layers/FeatureLayer":function(){define("require dojo/_base/lang dojo/io-query ../Graphic ../PopupTemplate ../request ../core/kebabDictionary ../core/MultiOriginJSONSupport ../core/Collection ../core/Error ../core/Logger ../core/lang ../core/HandleRegistry ../core/promiseUtils ../core/requireUtils ../core/urlUtils ../geometry/Extent ../geometry/SpatialReference ../geometry/support/normalizeUtils ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/support/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/support/arcadeUtils ../renderers/support/jsonUtils ../renderers/support/styleUtils ../tasks/support/FeatureSet ../tasks/support/Query ./Layer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/ArcGISService ./graphics/sources/MemorySource ./support/Field ./support/FeatureType ./support/LabelClass ./support/labelingInfo ./support/arcgisLayerUrl ./support/ElevationInfo".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v,A,z,D,B,C,F,K,M,E,V,P,I,J,Q,S,ga,L,R,U,T,N){l=l({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});var Z=q.getLogger("esri.layers.FeatureLayer");q=function(a,b){a=M.fromJSON(b.featureSet);return new S({layer:this,items:a&&a.features||[]})};var H=V.createSubclass([P,I,J,Q,g],{declaredClass:"esri.layers.FeatureLayer",viewModulePaths:{"2d":"../views/2d/layers/FeatureLayerView2D",
"3d":"../views/3d/layers/FeatureLayerView3D"},constructor:function(){this._handles=new y},normalizeCtorArgs:function(a,b){return"string"===typeof a?h.mixin({},{url:a},b):a},load:function(){var a;a=this.source&&(Array.isArray(this.source)||this.source.isInstanceOf&&this.source.isInstanceOf(c));a=this.portalItem&&a?t.resolve():this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]}).always(function(){if(this.url&&null==this.layerId&&/FeatureServer\/*$/i.test(this.url))return this._fetchFirstLayerId().then(bind(this))}.bind(this)).then(function(){if(!this.url&&!this._hasMemorySource())throw new b("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.createGraphicsSource().then(this._initLayerProperties.bind(this))}.bind(this));this.addResolvingPromise(a)},_handles:null,_rndProps:"field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),
_visVariableProps:["field","normalizationField"],properties:{advancedQueryCapabilities:{json:{origins:{service:{read:{source:["advancedQueryCapabilities","supportsStatistics","supportsAdvancedQueries"],reader:function(a,b){return this._readAdvancedQueryCapabilities(b)}}}},read:{source:["layerDefinition.supportsAdvancedQueries","layerDefinition.supportsStatistics"],reader:function(a,b){return this._readAdvancedQueryCapabilities(b.layerDefinition)}}}},allowGeometryUpdates:{json:{origins:{service:{read:{reader:function(a){return this._readAllowGeometryUpdates(a)}}}},
read:{source:"layerDefinition.allowGeometryUpdates",reader:function(a){return this._readAllowGeometryUpdates(a)}}}},allRenderers:{readOnly:!0,dependsOn:["loaded","renderer","fields"],get:,capabilities:{json:{origins:{service:{read:{reader:function(a){return this._readCapabilities(a)}}}},read:{source:"layerDefinition.capabilities",reader:function(a){return this._readCapabilities(a)}}},dependsOn:["loaded"],get:function(){var a=this._get("capabilities");
!a&&this.loaded&&this._hasMemorySource()&&(a={operations:{supportsAdd:!0,supportsDelete:!0,supportsEditing:!0,supportsQuery:!0,supportsUpdate:!0}});return a}},copyright:{value:null,json:{origins:{service:{read:{source:"copyrightText"}}},read:{source:"layerDefinition.copyrightText"}}},definitionExpression:{value:null,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}},defaultSymbol:{json:{read:z.read}},
elevationInfo:{type:N,value:null,json:{origins:{service:{read:{source:"elevationInfo"},write:{target:"elevationInfo",enabled:!1}}},read:{source:"layerDefinition.elevationInfo"},write:{target:"layerDefinition.elevationInfo"}}},fields:{value:null,type:[ga],json:{origins:{service:{read:!0}},read:{source:"layerDefinition.fields"}}},fullExtent:{value:null,type:n,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}},gdbVersion:null,generalizeForScale:4E3,geometryType:{json:{origins:{service:{read:l.fromJSON}},
read:{source:"layerDefinition.geometryType",reader:l.fromJSON}}},hasAttachments:{value:!1,readOnly:!0,get:json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasAttachments"}}},hasM:{value:!1,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}},hasZ:{value:!1,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}},id:{json:{origins:{service:{read:!1},portalItem:{read:!1}}}},isTable:{value:!1,
readOnly:!0,json:{origins:{service:{read:{source:"type",reader:function(a){return"Table"===a}}}},read:{source:"layerDefinition.type",reader:}},labelsVisible:{value:!1,json:{read:{source:["showLabels"],reader:,write:},labelingInfo:{value:null,type:[R],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:U.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",
reader:U.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}},layerId:{json:{origins:{service:{read:{source:["id"],reader:function(a,b){return b.id}}}},read:!1}},legendEnabled:{value:!0,json:{read:{source:["showLegend"],reader:function(a,b){return null!=b.showLegend?b.showLegend:!0}},write:function(a,b){a||(b.showLegend=!1)}}},maxRecordCount:{value:null,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.maxRecordCount"}}},minScale:{json:{origins:{service:{read:{source:["minScale",
"effectiveMinScale"],reader:function(a,b){return b.effectiveMinScale||a}},write:{target:["minScale"],enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},maxScale:{json:{origins:{service:{read:{source:["maxScale","effectiveMaxScale"],reader:,write:{target:"maxScale",enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}},objectIdField:{json:{origins:{service:{read:{source:["objectIdField",
"fields"],reader:function(a,b){return this._readObjectIdField(b)}}}},read:{source:["layerDefinition.objectIdField","layerDefinition.fields"],reader:function(a,b){return this._readObjectIdField(b.layerDefinition)}}}},operationalLayerType:"ArcGISFeatureLayer",outFields:{value:null,dependsOn:["requiredFields"],get:function(){var a=this._get("outFields"),b=this.requiredFields;a?-1===a.indexOf("*")&&b.forEach(function(b){-1===a.indexOf(b)&&a.push(b)}):a=b;this.loaded&&(a=a.filter(function(a){return"*"===
a||!!this.getField(a)},this),a=a.map(function(a){return"*"===a?a:this.getField(a).name},this));return a},set:function(a){var b=this.requiredFields;a?-1===a.indexOf("*")&&b.forEach(:a=b;this.loaded&&(a=a.filter(this),a=a.map(function(a){return"*"===a?a:this.getField(a).name},this));this._set("outFields",a)}},parsedUrl:{dependsOn:["layerId"],get:function(){var a=this.url?r.urlToObject(this.url):null;null!=this.layerId&&
null!=a&&(a.path=r.join(a.path,this.layerId.toString()));return a}},popupEnabled:{value:!0,json:{read:{source:["disablePopup"],reader:function(a,b){return null!=b.disablePopup?!b.disablePopup:!0}},write:function(a,b){a||(b.disablePopup=!0)}}},popupTemplate:{value:null,type:f,json:{read:{source:["popupInfo"],reader:,write:function(a,b){a&&(b.popupInfo=a.toJSON())}}},relationships:null,renderer:{set:function(a){var b=this._getAllRenderers(a);
this._fixRendererFields(b);this._set("renderer",a)},json:{origins:{service:{read:{source:["drawingInfo.renderer","defaultSymbol","type"],reader:,write:{target:"drawingInfo.renderer",enabled:!1}}},read:{source:["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol","layerDefinition.type"],reader:function(a,b,d){return this._readRenderer(null,b.layerDefinition,d)}},write:{target:"layerDefinition.drawingInfo.renderer"}}},requiredFields:{dependsOn:["allRenderers"],
get:function(){var a=this.timeInfo,b=[this.objectIdField,this.typeIdField,this.editFieldsInfo&&this.editFieldsInfo.creatorField,a&&a.startTimeField,a&&a.endTimeField,this.trackIdField],d=this._rndProps,c=[];this.allRenderers.forEach(function(a){d.forEach(function(d){b.push(h.getObject(d,!1,a))});a.valueExpression&&(c=c.concat(C.extractFieldNames(a.valueExpression)));a.visualVariables&&a.visualVariables.forEach(function(a){this._visVariableProps.forEach(;a.valueExpression&&
(c=c.concat(C.extractFieldNames(a.valueExpression)))},this)},this);b=b.concat(c);b=b.concat(this.dataAttributes);return b.filter(function(a,b,d){return!!a&&d.indexOf(a)===b&&"function"!==typeof a})}},returnM:!1,returnZ:!1,source:{json:{origins:{portalItem:{read:{source:["featureSet"],reader:q}},webMap:{read:{source:["featureSet"],reader:q}}}},cast:function(a){return a&&(Array.isArray(a)||a.isInstanceOf&&a.isInstanceOf(c))?new S({layer:this,items:a}):a},set:function(a){var b=this._get("source");b!==
a&&(b&&b.isInstanceOf&&b.isInstanceOf(S)&&this._resetMemorySource(b),a&&a.isInstanceOf&&a.isInstanceOf(S)&&this._initMemorySource(a),this._set("source",a))}},supportsCoordinatesQuantization:!1,serviceDefinitionExpression:{json:{origins:{service:{read:{source:["definitionExpression"],reader:}}}},spatialReference:{json:{origins:{service:{read:{source:"extent",reader:function(a){if(a&&a.spatialReference)return w.fromJSON(a.spatialReference)}}}},read:{source:"layerDefinition.extent",
reader:}},title:{json:{origins:{portalItem:{read:{source:["layerDefinition.title","layerDefinition.name","title"],reader:function(a,b){a=b.layerDefinition&&b.layerDefinition.name;b=b.title||b.layerDefinition&&b.layerDefinition.title;if(a)return this._readTitleFromName(a);if("item-title"===this.sublayerTitleMode&&b)return b}}},service:{read:{source:"name",reader:function(a,b){return this._readTitleFromName(a)}}}}}},sublayerTitleMode:{type:String,
value:"item-title"},trackIdField:{json:{read:{source:["timeInfo.trackIdField"],reader:}},type:{value:"feature",json:{read:!1}},typeIdField:{json:{origins:{service:{read:function(a,b){return this._readTypeIdField(a,b)}}},read:{source:"layerDefinition.typeIdField",reader:function(a,b){return this._readTypeIdField(a,b.layerDefinition)}}}},types:{json:{origins:{service:{read:function(a,b){return this._readTypes(a,b)}}},read:{source:"layerDefinition.types",
reader:}},url:{set:function(a){var b=r.urlToObject(a),d=T.parse(b.path);d&&null!=d.sublayer&&(null==this.layerId&&(this.layerId=d.sublayer),b=p.objectToQuery(b.query),a=d.url.path,b&&(a=a+"?"+b));this._set("url",a)},json:{write:function(a,b){a&&r.isProtocolRelative(a)&&(a="https:"+a);a&&(b.url=a);null!=this.layerId&&(a=r.urlToObject(a))&&(b.url=r.join(a.path,""+this.layerId),a.query&&Object.keys(a.query)&&(b.url+="?"+p.objectToQuery(a.query)))}}},
userIsAdmin:!1,version:{json:{origins:{service:{read:{source:"currentVersion capabilities drawingInfo hasAttachments htmlPopupType relationships timeInfo typeIdField types".split(" "),reader:}},read:{source:"layerDefinition.currentVersion layerDefinition.capabilities layerDefinition.drawingInfo layerDefinition.hasAttachments layerDefinition.htmlPopupType layerDefinition.typeIdField layerDefinition.types".split(" "),reader:}},
visible:{json:{origins:{portalItem:{read:{source:["visibility","layerDefinition.defaultVisibility"],reader:function(a,b){if(b.layerDefinition&&null!=b.layerDefinition.defaultVisibility)return!!b.layerDefinition.defaultVisibility;if(null!=b.visibility)return!!b.visibility}},write:{target:"layerDefinition.defaultVisibility"}}}}}},applyEdits:function(a){return this.load().then(function(){return this.source.applyEdits?this._processApplyEditsParams(a).then(function(a){return this.source.applyEdits(a).then(function(a){var b=
function(a){return a.filter(.map(function(a){return x.clone(a)})},b={addedFeatures:b(a.addFeatureResults),updatedFeatures:b(a.updateFeatureResults),deletedFeatures:b(a.deleteFeatureResults)};(b.addedFeatures.length||b.updatedFeatures.length||b.deletedFeatures.length)&&this.emit("edits",b);return a}.bind(this))}.bind(this)):t.reject(new b("FeatureLayer","Layer source does not support applyEdits capability"))}.bind(this))},createGraphicsSource:function(){return this._hasMemorySource()?
(this.emit("graphics-source-create",{graphicsSource:this.source}),t.resolve(this.source)):u.when(a,"./graphics/sources/FeatureLayerSource").then(function(a){return new a({layer:this})}.bind(this)).then(function(a){this.emit("graphics-source-create",{graphicsSource:a});return a}.bind(this))},createGraphicsController:function(b){var d=b.layerView,e=c.ofType(m),f=this.source,g=f&&f.isInstanceOf&&f.isInstanceOf(c),k=h.mixin(b.options||{},{layer:this,layerView:d,graphics:g?f:new e});return g?t.resolve(k):
u.when(a,"2d"===d.view.type?"./graphics/controllers/AutoController2D":"./graphics/controllers/SnapshotController").then(function(a){return new a(k)}.bind(this)).then(function(a){this.emit("graphics-controller-create",{graphicsController:a});return a}.bind(this))},createQuery:function(){var a=new E;a.returnGeometry=!0;a.returnZ=this.hasZ&&this.returnZ||null;a.returnM=this.hasM&&this.returnM||null;a.outFields=this.outFields;a.where=this.definitionExpression||"1\x3d1";a.multipatchOption="multipatch"===
this.geometryType?"xyFootprint":null;return a},getFieldDomain:function(a,b){var d,c;b=(b=b&&b.feature)&&b.attributes;var e=this.typeIdField&&b&&b[this.typeIdField];null!=e&&this.types&&this.types.some(this);c||d||(d=this._getLayerDomain(a));return d},getField:function(a,b){var d;if(b=b||this.fields)a=a.toLowerCase(),b.some(function(b){b&&b.name.toLowerCase()===a&&(d=b);return!!d});
return d},graphicChanged:queryFeatures:function(a){var d=this;a=a||this.createQuery();if(!this.source.queryFeatures)return t.reject(new b("FeatureLayer","Layer source does not support queryFeatures capability"));var c=this.popupTemplate;return this.source.queryFeatures(a).then(function(a){a&&a.features&&a.features.forEach(;return a})},queryObjectIds:function(a){a=a||this.createQuery();return this.source.queryObjectIds?
this.source.queryObjectIds(a):t.reject(new b("FeatureLayer","Layer source does not support queryObjectIds capability"))},queryFeatureCount:function(a){a=a||this.createQuery();return this.source.queryFeatureCount?this.source.queryFeatureCount(a):t.reject(new b("FeatureLayer","Layer source does not support queryFeatureCount capability"))},queryExtent:function(a){a=a||this.createQuery();return this.source.queryExtent?this.source.queryExtent(a):t.reject(new b("FeatureLayer","Layer source does not support queryExtent capability"))},
read:function(a,b){switch(b&&b.origin){case "web-map":this.inherited(arguments,[{outFields:["*"]},b]);break;case "web-scene":this.inherited(arguments,[{mode:H.MODE_SNAPSHOT,returnZ:!0,outFields:["*"]},b])}var d=a.featureCollection;if(d){var c=d.layers;c&&1===c.length&&(this.inherited(arguments,[c[0],b]),null!=d.showLegend&&this.inherited(arguments,[{showLegend:d.showLegend},b]))}this.inherited(arguments,[a,b]);return this},write:function(a,d){if(d&&"web-scene"===d.origin&&d.messages){if(!this.url)return d.messages.push(new b("layer:unsupported",
"Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' require a url to a service to be written to web scenes",{layer:this})),null;if(this.isTable)return d.messages.push(new b("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using a Table source cannot written to web scenes",{layer:this})),null}return this.inherited(arguments)},_getLayerDomain:function(a){var b;this.fields&&this.fields.some(;
return b},_fetchFirstLayerId:function(){return e(this.url,{query:{f:"json"},callbackParamName:"callback",responseType:"json"}).then(function(a){if(a.data&&Array.isArray(a.data.layers)&&0<a.data.layers.length)return a.data.layers[0].id})},_initLayerProperties:function(a){this.source||(this.source=a);a.url&&(this.url=a.url);a.layerDefinition&&this.read(a.layerDefinition,{origin:"service",url:this.parsedUrl});this._verifySource();this._verifyFields();this._addSymbolUrlTokens();this._fixRendererFields(this._getAllRenderers(this.renderer));
this.watch("token",bind(this));return K.loadStyleRenderer(this,{origin:"service"})},_findUrlBasedSymbols:function(){var a=this.renderer;if(!a)return[];var b=[];a.symbol&&b.push(a.symbol);a.defaultSymbol&&b.push(a.defaultSymbol);(a=a.classBreakInfos||a.uniqueValueInfos)&&a.forEach(function(a){a.symbol&&b.push(a.symbol)});return b.filter(function(a){return!!a.url})},_addSymbolUrlTokens:function(){var a=this.token;!this._hasMemorySource()&&a&&this._findUrlBasedSymbols().forEach(function(b){var d=
b.url;if(d&&-1!==d.search(/https?\:/i)&&!/[?&]token=/.test(d)){var c=-1===d.indexOf("?")?"?":"\x26",d=d+c+"token\x3d"+a;b.source?(c=x.clone(b.source),c.url=d,b.source=c):b.url=d}})},_getAllRenderers:function(a){var b=[];a&&[a,a.trackRenderer,a.observationRenderer,a.latestObservationRenderer].forEach(function(a){a&&(b.push(a),a.rendererInfos&&a.rendererInfos.forEach()});return b},_fixRendererFields:function(a){var b=this.fields;a&&b&&a.forEach(function(a){this._fixFieldName(this._rndProps,
a);a.visualVariables&&a.visualVariables.forEach(function(a){this._fixFieldName(this._visVariableProps,a)},this)},this)},_fixFieldName:function(a,b){a&&a.forEach(function(a){var d=h.getObject(a,!1,b);(d=d&&"function"!==typeof d&&this.getField(d))&&h.setObject(a,d.name,b)},this)},_verifyFields:function(){var a=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+a+")");this.isTable||this._hasMemorySource()||-1!==
a.search(/\/FeatureServer\//i)||this.fields&&this.fields.some(||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+a+")")},_fixTemplates:function(a,b){a&&a.forEach(function(a){(a=a.prototype&&a.prototype.attributes)&&b&&delete a[b]})},_verifySource:function(){if(this._hasMemorySource()){if(this.url)throw new b("feature-layer:mixed-source-and-url",
"FeatureLayer cannot be created with both an in-memory source and a url");var a=["geometryType","fields","objectIdField"];if(!a.every(this))throw new b("feature-layer:missing-property","FeatureLayer created as feature collection requires properties: "+a.join(),{requiredProperties:a});}else{if(this.isTable)throw new b("feature-layer:source-type-not-supported","The table feature service type is not yet supported",{sourceType:"Table"});if(!this.url)throw new b("feature-layer:source-or-url-required",
"FeatureLayer requires either a url, a valid portal item or a source");}},_initMemorySource:function(a){a.forEach(bind(this));this._handles.add([a.on("after-add",bind(this)),a.on("after-remove",bind(this))],"fl-source")},_resetMemorySource:function(a){a.forEach(bind(this));this._handles.remove("fl-source")},_hasMemorySource:function(){return!(this.url||!this.source)},_readTitleFromName:function(a){var b=
this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?T.titleFromUrlAndName(this.url,a):a;if(a=a||this.url&&T.parse(this.url).title)return"item-title-and-service-name"===this.sublayerTitleMode&&b&&(a=b+" - "+a),T.cleanTitle(a)},_readAdvancedQueryCapabilities:function(a){return a.advancedQueryCapabilities||{supportsPagination:!1,supportsQueryWithDistance:!1,supportsReturningQueryExtent:!1,supportsStatistics:a.supportsStatistics,supportsOrderBy:a.supportsAdvancedQueries,
supportsDistinct:a.supportsAdvancedQueries}},_readAllowGeometryUpdates:function(a){return null==a?!0:a},_readCapabilities:function(a){a=a?a.toLowerCase().split(",").map(function(a){return a.trim()}):[];var b=-1!==a.indexOf("editing"),d=b&&-1!==a.indexOf("create"),c=b&&-1!==a.indexOf("delete"),e=b&&-1!==a.indexOf("update");!b||d||c||e||(d=c=e=!0);return{operations:{supportsAdd:d,supportsDelete:c,supportsEditing:b,supportsQuery:-1!==a.indexOf("query"),supportsUpdate:e}}},_readObjectIdField:function(a){if(a.objectIdField)return a.objectIdField;
if(a.fields)for(var b=0;b<a.fields.length;b++){var d=a.fields[b];if("esriFieldTypeOID"===d.type)return d.name}},_readRenderer:function(a,b,d){var c;if(a=b.drawingInfo&&b.drawingInfo.renderer||void 0)(a=F.read(a,b,d)||void 0)||Z.error("Failed to create renderer",{rendererDefinition:b.drawingInfo.renderer,layer:this,context:d});else if(b.defaultSymbol)z.read(b.defaultSymbol,b,d),b.types&&b.types.length?(a=new B({defaultSymbol:c,field:b.typeIdField}),b.types.forEach(function(b){a.addUniqueValueInfo(b.id,
z.read(b.symbol,b,d))})):a=new D({symbol:c});else if("Table"!==b.type){switch(b.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":c=new k;break;case "esriGeometryPolyline":c=new v;break;case "esriGeometryPolygon":c=new A}a=c&&new D({symbol:c})}return a},_readTypeIdField:function(a,b){a&&(b=this.getField(a,b.fields))&&(a=b.name);return a},_readTypes:function(a,b){var d=(b=b.editFieldsInfo)&&b.creatorField,c=b&&b.editorField;return a&&a.map(function(a){a=new L(a);this._fixTemplates(a.templates,
d);this._fixTemplates(a.templates,c);return a},this)},_readVersion:function(a){return a.currentVersion?a.currentVersion:a.hasOwnProperty("capabilities")||a.hasOwnProperty("drawingInfo")||a.hasOwnProperty("hasAttachments")||a.hasOwnProperty("htmlPopupType")||a.hasOwnProperty("relationships")||a.hasOwnProperty("timeInfo")||a.hasOwnProperty("typeIdField")||a.hasOwnProperty("types")?10:9.3},_processApplyEditsParams:function(a){if(!a)return t.reject(new b("feature-layer:missing-parameters","'addFeatures', 'updateFeatures' or 'deleteFeatures' parameter is required"));
a=h.mixin({},a);a.addFeatures=a.addFeatures||[];a.updateFeatures=a.updateFeatures||[];a.deleteFeatures=a.deleteFeatures||[];if(a.addFeatures.length||a.updateFeatures.length||a.deleteFeatures.length){var d=function(a){var b=new m;b.geometry=a.geometry;b.attributes=a.attributes;return b};a.addFeatures=a.addFeatures.map(d);a.updateFeatures=a.updateFeatures.map(d);return this._normalizeGeometries(a).then(function(a){return t.resolve(a)})}return t.reject(new b("feature-layer:missing-parameters","'addFeatures', 'updateFeatures' or 'deleteFeatures' parameter is required"))},
_normalizeGeometries:function(a){var b=a.addFeatures,c=a.updateFeatures,e=b.concat(c).map(function(a){return a.geometry});return d.normalizeCentralMeridian(e).then(function(d){var e=b.length,f=c.length;d.slice(0,e).forEach(function(b,d){a.addFeatures[d].geometry=b});d.slice(e,e+f).forEach(;return a})}});return H})},"esri/renderers/SimpleRenderer":function(){define(["../core/declare","../core/lang","../symbols/support/jsonUtils","./Renderer"],function(a,
h,p,m){var f=a(m,{declaredClass:"esri.renderers.SimpleRenderer",properties:{description:{value:null,json:{write:!0}},label:{value:null,json:{write:!0}},symbol:{value:null,json:{read:p.read,write:function(a,f,g,c){f.symbol=p.write(a,{},c)}}},type:"simple"},getSymbol:clone:function(){return new f({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:h.clone(this.visualVariables),authoringInfo:h.clone(this.authoringInfo)})}});
return f})},"esri/renderers/Renderer":function(){define("../core/declare ../core/Accessor ../core/JSONSupport ../core/kebabDictionary ../core/screenUtils ../core/lang ../core/Error dojo/_base/lang ../Color ./support/utils ./support/arcadeUtils".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){var x=m({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),y=m({widthAndDepth:"width-and-depth"}),t=m({classedSize:"classed-size",classedColor:"classed-color",univariateColorSize:"univariate-color-size"}),
u=m({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),r=m({percentTotal:"percent-of-total"}),n=Math.PI;return a([h,p],{declaredClass:"esri.renderers.Renderer",properties:{authoringInfo:{value:null,json:{read:function(a,b){a&&(a=e.clone(a),a.type&&(a.type=t.fromJSON(a.type)),a.classificationMethod&&(a.classificationMethod=u.fromJSON(a.classificationMethod)),
a.visualVariables&&a.visualVariables.forEach(function(a){a.type&&(a.type=x.fromJSON(a.type));a.style&&(a.style=r.fromJSON(a.style))}));return a},write:function(a,b){a&&(a=e.clone(a),a.type&&(a.type=t.toJSON(a.type)),a.classificationMethod&&(a.classificationMethod=u.toJSON(a.classificationMethod)),a.visualVariables&&a.visualVariables.forEach(function(a){a.type&&(a.type=x.toJSON(a.type));a.style&&(a.style=r.toJSON(a.style))}));b.authoringInfo=a}}},requiredFields:{dependsOn:["visualVariables"],get:function(){var a=
Object.create(null);this.collectRequiredFields(a);return Object.keys(a)}},type:{readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}},visualVariables:{json:{read:{source:["visualVariables","rotationType","rotationExpression"],reader:,write:function(a,b,c,e){var d=[];a.forEach(function(a,b){"size"===a.type?d.push(this._writeSizeInfo(a,e,b)):"color"===a.type?d.push(this._writeColorInfo(a,e,b)):"opacity"===a.type?d.push(this._writeOpacityInfo(a,e,b)):"rotation"===
a.type&&d.push(this._writeRotationInfo(a,e,b))},this);b.visualVariables=d}}}},constructor:function(){this._cache={}},_rotationRE:/^\[([^\]]+)\]$/i,_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_visualVariablesSetter:function(a){var b=this._cache;this.visualVariables&&this.visualVariables.forEach(this);a&&a.some(&&a.sort(;a&&a.forEach(this);this._set("visualVariables",a)},getSymbol:getVisualVariableValues:function(a,b){var d=this.visualVariables,c;d&&(c=d.map(function(d){var c,e=d.type,f=e+"Info";b=g.mixin({},b);b[f]=d;switch(e){case "size":c=this.getSize(a,b);break;case "color":c=this.getColor(a,b);break;case "opacity":c=
this.getOpacity(a,b);break;case "rotation":c=this.getRotationAngle(a,b)}return{variable:d,value:c}},this).filter(this));return c},hasVisualVariables:getVisualVariablesForType:function(a,b){var d=this.visualVariables,c;d&&(c=d.filter()&&0===c.length&&(c=void 0);return c},getSize:getSizeRangeAtScale:function(a,b){var d;a=this._getVarInfo(a,"size");var c=this._cache[a.cacheKey],
e={scale:b};(a=a.variable)&&b&&(b=a.minSize,a=a.maxSize,b="object"===typeof b&&b?this._getSize({},b,c&&c.minSize,e):b,c="object"===typeof a&&a?this._getSize({},a,c&&c.maxSize,e):a,null!=b||null!=c)&&(d={minSize:b,maxSize:c});return d},getColor:function(a,b){var d=this._getVarInfo(b&&b.colorInfo,"color");return this._getColorComponent(a,d.variable,this._cache[d.cacheKey],b)},getOpacity:function(a,b){var d=this._getVarInfo(b&&b.opacityInfo,"opacity");return this._getColorComponent(a,d.variable,this._cache[d.cacheKey],
b,!0)},getRotationAngle:function(a,b){var d=this._getVarInfo(b&&b.rotationInfo,"rotation"),c=d.variable,e=this._cache[d.cacheKey],d="arithmetic"===c.rotationType,c=c.field,e=e&&e.compiledFunc,f=a.attributes,n=0;if(c||e)e?n=q.executeFunction(e,q.createExecContext(a,q.getView(b))):g.isFunction(c)?n=c.apply(this,arguments):f&&(n=f[c]||0),n="number"!==typeof n||isNaN(n)?null:(n+(d?-90:0))*(d?-1:1);return n},collectRequiredFields:function(a){var b=[];this.visualVariables&&(b=b.concat(this.visualVariables));
b.forEach(function(b){b&&b.field&&(a[b.field]=!0);b&&b.normalizationField&&(a[b.normalizationField]=!0)})},_getVarInfo:function(a,b){var d;a&&a.type===b&&this.visualVariables?(d=this.visualVariables.indexOf(a),a=this.visualVariables[d]):this.visualVariables&&(a=(a=this.getVisualVariablesForType(b))&&a[0],d=this.visualVariables.indexOf(a));return{variable:a,cacheKey:d}},_readSizeInfo:function(a){a.axis&&(a.axis=y.fromJSON(a.axis));return a},_readColorInfo:function(a){a&&(a.colors&&a.colors.forEach(function(b,
e){g.isArray(b)?a.colors[e]=c.fromJSON(b):a.colors[e]=new c(b)}),a.stops&&a.stops.forEach(function(b,e){b.color&&g.isArray(b.color)?a.stops[e].color=c.fromJSON(b.color):b.color&&(a.stops[e].color=new c(b.color))}));return a},_readOpacityInfo:function(a){var b;a&&(b=g.mixin({},a),b.transparencyValues&&(b.opacityValues=b.transparencyValues.map(,delete b.transparencyValues),b.stops&&(b.stops=b.stops.map());return b},_readVariables:function(a,b){a&&(a=a.map(function(a){a=e.clone(a);a.type=x.fromJSON(a.type);"size"===a.type?a=this._readSizeInfo(a):"color"===a.type?a=this._readColorInfo(a):"opacity"===a.type&&(a=this._readOpacityInfo(a));return a},this));var d=b.rotationType;if(b=b.rotationExpression)d={type:"rotation",rotationType:d},(b=b.match(this._rotationRE))&&b[1]&&(d.field=b[1],a||(a=[]),a.push(d));return a},_createCache:function(a){var b=a&&a.valueExpression,c=q.createSyntaxTree(b),
c=q.createFunction(c),e=!(!a||!a.expression)||this._viewScaleRE.test(b);return{ipData:this._interpolateData(a),hasExpr:!!b,compiledFunc:c,isScaleDriven:e}},_processColorInfo:function(a){a&&(a.colors&&a.colors.forEach(function(b,e){b instanceof c||(a.colors[e]=new c(b))}),a.stops&&a.stops.forEach(function(b,e){!b.color||b.color instanceof c||(a.stops[e].color=new c(b.color))}),this._sortStops(a.stops));return this._createCache(a)},_processOpacityInfo:function(a){this._sortStops(a&&a.stops);return this._createCache(a)},
_processSizeInfo:function(a){a.stops&&Array.isArray(a.stops)?a.stops=this._processSizeInfoStops(a.stops):(a.minSize=a.minSize&&this._processSizeInfoSize(a.minSize),a.maxSize=a.maxSize&&this._processSizeInfoSize(a.maxSize));return{root:this._createCache(a),minSize:this._createCache(a.minSize),maxSize:this._createCache(a.maxSize)}},_processSizeInfoSize:function(a){"object"===typeof a?a.stops=this._processSizeInfoStops(a.stops):a=f.toPt(a);return a},_processSizeInfoStops:function(a){a&&Array.isArray(a)&&
(a.forEach(,this._sortStops(a));return a},_sortStops:function(a){a&&Array.isArray(a)&&a.sort(function(a,b){return a.value-b.value})},_processRotationInfo:function(a){return this._createCache(a)},_getSize:function(a,d,c,e,f){var k=a.attributes,h=d.field,l=d.stops,m=0,p=c&&c.hasExpr,r=c&&c.compiledFunc,t=c&&c.ipData,w=c&&c.isScaleDriven,x="number"===typeof a,v=x?a:null;if(h||w||p){var u=e&&e.scale,y=f?f[0]:d.minSize,A=f?f[1]:d.maxSize,S=d.minDataValue,ga=d.maxDataValue,
L=d.valueUnit||"unknown",R=d.valueRepresentation,m=d.scaleBy,U=d.normalizationField,T=k?parseFloat(k[U]):void 0,N=e&&e.shape;w?v=null==u?this._getAverageValue(d):u:"number"!==typeof v&&(p?v=q.executeFunction(r,q.createExecContext(a,q.getView(e))):g.isFunction(h)?v=h.apply(this,arguments):k&&(v=k[h]));if(null==v||U&&!x&&(isNaN(T)||0===T))return null;isNaN(T)||x||(v/=T);if(l)A=this._lookupData(v,t),v=A[0],y=A[1],v===y?m=l[v].size:(v=l[v].size,l=l[y].size,m=v+(l-v)*A[2]);else if(null!=y&&null!=A&&null!=
S&&null!=ga)v<=S?m=y:v>=ga?m=A:(l=(v-S)/(ga-S),"area"===m&&N?(y=(v="circle"===N)?n*Math.pow(y/2,2):y*y,l=y+l*((v?n*Math.pow(A/2,2):A*A)-y),m=v?2*Math.sqrt(l/n):Math.sqrt(l)):m=y+l*(A-y));else if("unknown"===L)null!=y&&null!=S?(y&&S?(l=v/S,m="circle"===N?2*Math.sqrt(l*Math.pow(y/2,2)):"square"===N||"diamond"===N||"image"===N?Math.sqrt(l*Math.pow(y,2)):l*y):m=v+(y||S),m=m<y?y:m,null!=A&&m>A&&(m=A)):m=v;else{l=(e&&e.resolution?e.resolution:1)*b.meterIn[L];if("area"===R)m=Math.sqrt(v/n)/l,m*=2;else if(m=
v/l,"radius"===R||"distance"===R)m*=2;null!=y&&m<y&&(m=y);null!=A&&m>A&&(m=A)}}else d&&(m=l&&l[0]&&l[0].size,null==m&&(m=d.minSize));return m=isNaN(m)?0:m},_getAverageValue:function(a){var b=a.stops,c;b?(c=b[0].value,a=b[b.length-1].value):(c=a.minDataValue||0,a=a.maxDataValue||0);return(c+a)/2},_getColorComponent:function(a,b,c,e,f,n){var d=a.attributes,k=b&&b.field,h="number"===typeof a,l=h?a:null,m=c&&c.hasExpr,p=c&&c.compiledFunc,r=c&&c.ipData,t;if(k||m){var w=b.normalizationField,x=d?parseFloat(d[w]):
void 0;"number"!==typeof l&&(m?l=q.executeFunction(p,q.createExecContext(a,q.getView(e))):g.isFunction(k)?l=k.apply(this,arguments):d&&(l=d[k]));null==l||w&&!h&&(isNaN(x)||0===x)||(isNaN(x)||h||(l/=x),t=f?this._getOpacity(l,b,r):this._getColor(l,b,r))}else b&&(d=b.stops,f?(t=d&&d[0]&&d[0].opacity,null==t&&(t=b.opacityValues&&b.opacityValues[0])):t=d&&d[0]&&d[0].color||b.colors&&b.colors[0]);n&&(n.data=l,n.value=t);return n||t},_interpolateData:function(a){var b;if(a)if(a.colors||a.opacityValues){var c=
(a.colors||a.opacityValues).length,e=a.minDataValue,f=(a.maxDataValue-e)/(c-1);b=[];for(a=0;a<c;a++)b[a]=e+a*f}else a.stops&&(b=a.stops.map(function(a){return a.value}));return b},_getOpacity:_getOpacValue:function(a,b){return a.opacityValues?a.opacityValues[b]:a.stops[b].opacity},_getColor:function(a,
b,e){a=this._lookupData(a,e);var d;b=b||this.colorInfo;a&&(d=a[0],e=a[1],d=d===e?this._getColorObj(b,d):c.blendColors(this._getColorObj(b,d),this._getColorObj(b,e),a[2]),d=new c(d));return d},_getColorObj:_lookupData:function(a,b){var c;if(b){var d=0,e=b.length-1;b.some(;c=[d,e,(a-b[d])/(b[e]-b[d])]}return c},_processForContext:function(a,b,c){b&&"web-scene"===b.origin?(b.messages&&(a.expression&&
b.messages.push(new l("property:unsupported",a.type+"VisualVariable.expression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:c+".expression",context:b})),a.valueExpression&&b.messages.push(new l("property:unsupported",a.type+"VisualVariable.valueExpression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:c+".valueExpression",context:b})),a.valueExpressionTitle&&b.messages.push(new l("property:unsupported",
a.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:c+".valueExpressionTitle",context:b}))),delete a.expression,delete a.valueExpression,delete a.valueExpressionTitle):"size"===a.type&&this._convertExpressionToArcade(a)},_writeRotationInfo:function(a,b,c){a&&(a=g.mixin({},a),this._processForContext(a,b,"visualVariables["+c+"]"),a.type=x.toJSON(a.type),a=e.fixJson(a,!0));return a},_convertExpressionToArcade:_writeSizeInfo:function(a,b,c){if(a){a=g.mixin({},a);this._processForContext(a,b,"string"===typeof c?c:"visualVariables["+c+"]");var d=a.minSize,f=a.maxSize;d&&(a.minSize="number"===typeof d?d:this._writeSizeInfo(d,b,"visualVariables["+c+"].minSize"));f&&(a.maxSize="number"===typeof f?f:this._writeSizeInfo(f,b,"visualVariables["+c+"].maxSize"));b=a.legendOptions;c=a.axis;a.type=x.toJSON(a.type);c&&(a.axis=y.toJSON(c));b&&(a.legendOptions=g.mixin({},
b),b=b.customValues)&&(a.legendOptions.customValues=b.slice(0));a.stops&&(a.stops=a.stops.map(function(a){a=g.mixin({},a);null===a.label&&delete a.label;return a}));a=e.fixJson(a,!0)}return a},_writeColorInfo:function(a,b,f){a&&(a=g.mixin({},a),this._processForContext(a,b,"visualVariables["+f+"]"),a.type=x.toJSON(a.type),a.colors&&(a.colors=a.colors.map(function(a){return c.toJSON(a)})),a.stops&&(a.stops=a.stops.map(function(a){a=g.mixin({},a);a.color&&(a.color=c.toJSON(a.color));null===a.label&&
delete a.label;return a})),a.legendOptions&&(a.legendOptions=g.mixin({},a.legendOptions)),a=e.fixJson(a,!0));return a},_writeOpacityInfo:function(a,b,c){var d;a&&(d=g.mixin({},a),this._processForContext(d,b,"visualVariables["+c+"]"),d.type=x.toJSON(d.type),d.opacityValues&&(d.transparencyValues=d.opacityValues.map(,delete d.opacityValues),d.stops&&(d.stops=d.stops.map(function(a){a=g.mixin({},a);a.transparency=100*(1-a.opacity);delete a.opacity;null===a.label&&delete a.label;
return a})),d.legendOptions&&(d.legendOptions=g.mixin({},d.legendOptions)),d=e.fixJson(d,!0));return d}})})},"esri/renderers/support/arcadeUtils":function(){define("require exports dojo/_base/lang ../../arcade/arcade ../../arcade/Dictionary ../../geometry/SpatialReference".split(" "),function(a,h,p,m,f,e){function l(a){var b;try{b=a?m.parseScript(a):null}catch(y){b=null}return b}var g=/^\$feature\./i,c=new e,b={vars:{$feature:"any",$view:"any"}};h.createSyntaxTree=l;h.createFunction=function(a,c){c=
c||p.clone(b);a="string"===typeof a?l(a):a;var e;try{e=a?m.compileScript(a,c):null}catch(t){e=null}return e};h.createExecContext=function(a,b){return{vars:{$feature:m.constructFeature(a),$view:b}}};h.evalSyntaxTree=function(a,b){return m.executeScript(a,b,c)};h.executeFunction=h.extractFieldNames=function(a){if(!a)return[];a="string"===typeof a?l(a):a;var b=[];m.extractFieldLiterals(a).forEach(;b.sort();return b.filter(};h.dependsOnView=h.getView=function(a){return a&&a.viewingMode&&null!=a.scale?new f({viewingMode:a.viewingMode,scale:a.scale}):"any"}})},"esri/arcade/arcade":function(){define("require exports ./arcadeRuntime ./parser ./Feature ./arcadeCompiler dojo/has".split(" "),function(a,h,p,m,f,e,l){h.compileScript=function(a,c){return l("csp-restrictions")?e.compileScript(a,c)};h.constructFeature=
function(a){return f.fromFeature(a)};h.parseScript=function(a){return m.parseScript(a)};h.validateScript=function(a,c){return m.validateScript(a,c,"simple")};h.scriptCheck=h.parseAndExecuteScript=function(a,c,b){return p.executeScript(m.parseScript(a),c,b)};h.executeScript=function(a,c,b){return p.executeScript(a,c,b)};h.referencesMember=function(a,c){return p.referencesMember(a,c)};h.referencesFunction=function(a,c){return p.referencesFunction(a,
c)};h.extractFieldLiterals=function(a,c){void 0===c&&(c=!1);return m.extractFieldLiterals(a,c)}})},"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../Graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../geometry/SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v,A){nction B(a,c){try{switch(c.type){case "EmptyStatement":return b.voidOperation;case "VariableDeclarator":var d=null===c.init?null:B(a,c.init);d===b.voidOperation&&(d=null);var e=c.id.name.toLowerCase();null!==a.localScope?a.localScope[e]={value:d,valueset:!0,node:c.init}:a.globalScope[e]=
{value:d,valueset:!0,node:c.init};return b.voidOperation;case "VariableDeclaration":for(var f=0;f<c.declarations.length;f++)B(a,c.declarations[f]);return b.voidOperation;case "BlockStatement":var g;a:{for(var k=b.voidOperation,f=0;f<c.body.length;f++)if(k=B(a,c.body[f]),k instanceof b.ReturnResult||k===b.breakResult||k===b.continueResult){g=k;break a}g=k}return g;case "FunctionDeclaration":var n=c.id.name.toLowerCase();a.globalScope[n]={valueset:!0,node:null,value:new t(c,a)};return b.voidOperation;
case "ReturnStatement":var h;if(null===c.argument)h=new b.ReturnResult(b.voidOperation);else{var l=B(a,c.argument);h=new b.ReturnResult(l)}return h;case "IfStatement":var m;if("AssignmentExpression"===c.test.type||"UpdateExpression"===c.test.type)throw Error(q.nodeErrorMessage(c.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var p=B(a,c.test);if(!0===p)m=B(a,c.consequent);else if(!1===p)m=null!==c.alternate?B(a,c.alternate):b.voidOperation;else throw Error(q.nodeErrorMessage(c,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));
return m;case "ExpressionStatement":var r;if("AssignmentExpression"===c.expression.type||"UpdateExpression"===c.expression.type)r=B(a,c.expression);else{var w=B(a,c.expression);r=w===b.voidOperation?b.voidOperation:new b.ImplicitResult(w)}return r;case "AssignmentExpression":var u;var v=B(a,c.right),f=null,z="";if("MemberExpression"===c.left.type){f=B(a,c.left.object);z=!0===c.left.computed?B(a,c.left.property):c.left.property.name;if(b.isArray(f))if(b.isNumber(z)){0>z&&(z=f.length+z);if(0>z||z>f.length)throw Error("Assignment outside of array bounds");
if(z===f.length&&"\x3d"!==c.operator)throw Error("Invalid Parameter");f[z]=F(v,c.operator,f[z],c)}else throw Error("Invalid Parameter");else if(f instanceof x){if(!1===b.isString(z))throw Error("Dictionary accessor must be a string");if(!0===f.hasField(z))f.setField(z,F(v,c.operator,f.field(z),c));else{if("\x3d"!==c.operator)throw Error("Invalid Parameter");f.setField(z,F(v,c.operator,null,c))}}else if(f instanceof y){if(!1===b.isString(z))throw Error("Feature accessor must be a string");if(!0===
f.hasField(z))f.setField(z,F(v,c.operator,f.field(z),c));else{if("\x3d"!==c.operator)throw Error("Invalid Parameter");f.setField(z,F(v,c.operator,null,c))}}else{if(b.isImmutableArray(f))throw Error("Array is Immutable");throw Error("Invalid Parameter");}u=b.voidOperation}else if(f=c.left.name.toLowerCase(),null!==a.localScope&&void 0!==a.localScope[f])a.localScope[f]={value:F(v,c.operator,a.localScope[f].value,c),valueset:!0,node:c.right},u=b.voidOperation;else if(void 0!==a.globalScope[f])a.globalScope[f]=
{value:F(v,c.operator,a.globalScope[f].value,c),valueset:!0,node:c.right},u=b.voidOperation;else throw Error("Variable not recognised");return u;case "UpdateExpression":var A;var H,f=null,z="";if("MemberExpression"===c.argument.type){f=B(a,c.argument.object);z=!0===c.argument.computed?B(a,c.argument.property):c.argument.property.name;if(b.isArray(f))if(b.isNumber(z)){0>z&&(z=f.length+z);if(0>z||z>=f.length)throw Error("Assignment outside of array bounds");H=b.toNumber(f[z]);f[z]="++"===c.operator?
H+1:H-1}else throw Error("Invalid Parameter");else if(f instanceof x){if(!1===b.isString(z))throw Error("Dictionary accessor must be a string");if(!0===f.hasField(z))H=b.toNumber(f.field(z)),f.setField(z,"++"===c.operator?H+1:H-1);else throw Error("Invalid Parameter");}else if(f instanceof y){if(!1===b.isString(z))throw Error("Feature accessor must be a string");if(!0===f.hasField(z))H=b.toNumber(f.field(z)),f.setField(z,"++"===c.operator?H+1:H-1);else throw Error("Invalid Parameter");}else{if(b.isImmutableArray(f))throw Error("Array is Immutable");
throw Error("Invalid Parameter");}A=!1===c.prefix?H:"++"===c.operator?H+1:H-1}else if(f=c.argument.name.toLowerCase(),null!==a.localScope&&void 0!==a.localScope[f])H=b.toNumber(a.localScope[f].value),a.localScope[f]={value:"++"===c.operator?H+1:H-1,valueset:!0,node:c},A=!1===c.prefix?H:"++"===c.operator?H+1:H-1;else if(void 0!==a.globalScope[f])H=b.toNumber(a.globalScope[f].value),a.globalScope[f]={value:"++"===c.operator?H+1:H-1,valueset:!0,node:c},A=!1===c.prefix?H:"++"===c.operator?H+1:H-1;else throw Error("Variable not recognised");
return A;case "BreakStatement":return b.breakResult;case "ContinueStatement":return b.continueResult;case "ForStatement":null!==c.init&&B(a,c.init);z={testResult:!0,lastAction:b.voidOperation};do b:{u=a;v=c;A=z;if(null!==v.test){A.testResult=B(u,v.test);if(!1===A.testResult)break b;if(!0!==A.testResult)throw Error(q.nodeErrorMessage(v,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}A.lastAction=B(u,v.body);A.lastAction===b.breakResult?A.testResult=!1:A.lastAction instanceof b.ReturnResult?A.testResult=
!1:null!==v.update&&B(u,v.update)}while(!0===z.testResult);f=z.lastAction instanceof b.ReturnResult?z.lastAction:b.voidOperation;return f;case "ForInStatement":return C(a,c);case "Identifier":var D;var I;try{var J=c.name.toLowerCase();if(null!==a.localScope&&void 0!==a.localScope[J])I=a.localScope[J],!0!==I.valueset&&(I.value=B(a,I.node),I.valueset=!0),D=I.value;else if(void 0!==a.globalScope[J])I=a.globalScope[J],!0!==I.valueset&&(I.value=B(a,I.node),I.valueset=!0),D=I.value;else throw Error(q.nodeErrorMessage(c,
"RUNTIME","VARIABLENOTFOUND"));}catch(za){throw za;}return D;case "MemberExpression":return M(a,c);case "Literal":return c.value;case "ThisExpression":throw Error(q.nodeErrorMessage(c,"RUNTIME","NOTSUPPORTED"));case "CallExpression":return P(a,c);case "UnaryExpression":return E(a,c);case "BinaryExpression":return V(a,c);case "LogicalExpression":var Z;a:try{if("AssignmentExpression"===c.left.type||"UpdateExpression"===c.left.type)throw Error(q.nodeErrorMessage(c.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));
if("AssignmentExpression"===c.right.type||"UpdateExpression"===c.right.type)throw Error(q.nodeErrorMessage(c.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var K=[B(a,c.left),B(a,c.right)],Q=K[0],S=K[1];if(b.isBoolean(Q)&&b.isBoolean(S))switch(c.operator){case "||":Z=Q||S;break a;case "\x26\x26":Z=Q&&S;break a;default:throw Error(q.nodeErrorMessage(c,"RUNTIME","ONLYORORAND"));}else throw Error(q.nodeErrorMessage(c,"RUNTIME","ONLYBOOLEAN"));}catch(za){throw za;}return Z;case "ConditionalExpression":throw Error(q.nodeErrorMessage(c,
"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{for(f=[],z=0;z<c.elements.length;z++){var L=B(a,c.elements[z]);if(b.isFunctionParameter(L))throw Error(q.nodeErrorMessage(c,"RUNTIME","FUNCTIONCONTEXTILLEGAL"));L===b.voidOperation?f.push(null):f.push(L)}}catch(za){throw za;}return f;case "ObjectExpression":f={};for(z=0;z<c.properties.length;z++){var N=B(a,c.properties[z]);if(b.isFunctionParameter(N.value))throw Error("Illegal Argument");if(!1===b.isString(N.key))throw Error("Illegal Argument");
f[N.key.toString()]=N.value===b.voidOperation?null:N.value}var R=new x(f);R.immutable=!1;return R;case "Property":return{key:"Identifier"===c.key.type?c.key.name:B(a,c.key),value:B(a,c.value)};case "Array":throw Error(q.nodeErrorMessage(c,"RUNTIME","NOTSUPPORTED"));default:throw Error(q.nodeErrorMessage(c,"RUNTIME","UNREOGNISED"));}}catch(za){throw za;}}function C(a,c){var d=B(a,c.right);"VariableDeclaration"===c.left.type&&B(a,c.left);var e=null,f="VariableDeclaration"===c.left.type?c.left.declarations[0].id.name:
c.left.name;null!==a.localScope&&void 0!==a.localScope[f]&&(e=a.localScope[f]);null===e&&void 0!==a.globalScope[f]&&(e=a.globalScope[f]);if(null===e)throw Error(q.nodeErrorMessage(c,"RUNTIME","VARIABLENOTDECLARED"));if(b.isArray(d)||b.isString(d)){for(var d=d.length,g=0;g<d&&(e.value=g,f=B(a,c.body),f!==b.breakResult);g++)if(f instanceof b.ReturnResult)return f;return b.voidOperation}if(b.isImmutableArray(d)){for(g=0;g<d.length()&&(e.value=g,f=B(a,c.body),f!==b.breakResult);g++)if(f instanceof b.ReturnResult)return f;
return b.voidOperation}if(d instanceof x||d instanceof y)for(d=d.keys(),g=0;g<d.length&&(e.value=d[g],f=B(a,c.body),f!==b.breakResult);g++){if(f instanceof b.ReturnResult)return f}else return b.voidOperation}unction K(a,c,d,e){c=c.toLowerCase();switch(c){case "hasz":return a=a.hasZ,void 0===a?!1:a;case "hasm":return a=a.hasM,void 0===a?!1:a;case "spatialreference":return c=a.spatialReference._arcadeCacheId,void 0===c&&(d=!0,Object.freeze&&Object.isFrozen(a.spatialReference)&&(d=!1),d&&(T++,c=a.spatialReference._arcadeCacheId=T)),a=new x({wkt:a.spatialReference.wkt,
wkid:a.spatialReference.wkid}),void 0!==c&&(a._arcadeCacheId="SPREF"+c.toString()),a}switch(a.type){case "extent":switch(c){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return a=a[c],void 0!==a?a:null;case "type":return"Extent"}break;case "polygon":switch(c){case "rings":return c=b.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===c&&(T++,c=T,b.isVersion4?a.cache._arcadeCacheId=c:a.setCacheValue("_arcadeCacheId",c)),a=new k(a.rings,
a.spatialReference,!0===a.hasZ,!0===a.hasM,c);case "type":return"Polygon"}break;case "point":switch(c){case "x":case "y":case "z":case "m":return void 0!==a[c]?a[c]:null;case "type":return"Point"}break;case "polyline":switch(c){case "paths":return c=b.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===c&&(T++,c=T,b.isVersion4?a.cache._arcadeCacheId=c:a.setCacheValue("_arcadeCacheId",c)),a=new k(a.paths,a.spatialReference,!0===a.hasZ,!0===a.hasM,c);case "type":return"Polyline"}break;
case "multipoint":switch(c){case "points":return c=b.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===c&&(T++,c=T,b.isVersion4?a.cache._arcadeCacheId=c:a.setCacheValue("_arcadeCacheId",c)),a=new v(a.points,a.spatialReference,!0===a.hasZ,!0===a.hasM,c,1);case "type":return"Multipoint"}}throw Error(q.nodeErrorMessage(e,"RUNTIME","PROPERTYNOTFOUND"));}function M(a,c){try{var d=B(a,c.object);if(null===d)throw Error(q.nodeErrorMessage(c,"RUNTIME","NOTFOUND"));if(!1===c.computed){if(d instanceof
x||d instanceof y)return d.field(c.property.name);if(d instanceof A)return K(d,c.property.name,a,c);throw Error(q.nodeErrorMessage(c,"RUNTIME","INVALIDTYPE"));}var e=B(a,c.property);if(d instanceof x||d instanceof y){if(b.isString(e))return d.field(e)}else if(d instanceof A){if(b.isString(e))return K(d,e,a,c)}else if(b.isArray(d)){if(b.isNumber(e)&&isFinite(e)&&Math.floor(e)===e){0>e&&(e=d.length+e);if(e>=d.length||0>e)throw Error(q.nodeErrorMessage(c,"RUNTIME","OUTOFBOUNDS"));return d[e]}}else if(b.isString(d)){if(b.isNumber(e)&&
isFinite(e)&&Math.floor(e)===e){0>e&&(e=d.length+e);if(e>=d.length||0>e)throw Error(q.nodeErrorMessage(c,"RUNTIME","OUTOFBOUNDS"));return d[e]}}else if(b.isImmutableArray(d)&&b.isNumber(e)&&isFinite(e)&&Math.floor(e)===e){0>e&&(e=d.length()+e);if(e>=d.length()||0>e)throw Error(q.nodeErrorMessage(c,"RUNTIME","OUTOFBOUNDS"));return d.get(e)}throw Error(q.nodeErrorMessage(c,"RUNTIME","INVALIDTYPE"));}catch(ba){throw ba;}}function E(a,c){try{var d=B(a,c.argument);if(b.isBoolean(d)){if("!"===c.operator)return!d;
if("-"===c.operator)return-1*b.toNumber(d);if("+"===c.operator)return 1*b.toNumber(d);throw Error(q.nodeErrorMessage(c,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===c.operator)return-1*b.toNumber(d);if("+"===c.operator)return 1*b.toNumber(d);throw Error(q.nodeErrorMessage(c,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(aa){throw aa;}}function V(a,c){try{var d=[B(a,c.left),B(a,c.right)],e=d[0],f=d[1];switch(c.operator){case "\x3d\x3d":return b.equalityTest(e,f);case "\x3d":return b.equalityTest(e,
f);case "!\x3d":return!b.equalityTest(e,f);case "\x3c":return b.greaterThanLessThan(e,f,c.operator);case "\x3e":return b.greaterThanLessThan(e,f,c.operator);case "\x3c\x3d":return b.greaterThanLessThan(e,f,c.operator);case "\x3e\x3d":return b.greaterThanLessThan(e,f,c.operator);case "+":return b.isString(e)||b.isString(f)?b.toString(e)+b.toString(f):b.toNumber(e)+b.toNumber(f);case "-":return b.toNumber(e)-b.toNumber(f);case "*":return b.toNumber(e)*b.toNumber(f);case "/":return b.toNumber(e)/b.toNumber(f);
case "%":return b.toNumber(e)%b.toNumber(f);default:throw Error(q.nodeErrorMessage(c,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(X){throw X;}}unction I(a){return null==a?"":b.isArray(a)||b.isImmutableArray(a)?"Array":b.isDate(a)?
"Date":b.isString(a)?"String":b.isBoolean(a)?"Boolean":b.isNumber(a)?"Number":a instanceof x?"Dictionary":a instanceof y?"Feature":a instanceof e?"Point":a instanceof p?"Polygon":a instanceof f?"Polyline":a instanceof g?"Multipoint":a instanceof l?"Extent":b.isFunctionParameter(a)?"Function":a===b.voidOperation?"":"number"===typeof a&&isNaN(a)?"Number":"Unrecognised Type"}function J(a,c,d,e){try{var f=B(a,c.arguments[d]);if(b.equalityTest(f,e))return B(a,c.arguments[d+1]);var g=c.arguments.length-
d;return 1===g?B(a,c.arguments[d]):2===g?null:J(a,c,d+2,e)}catch(ea){throw ea;}}unction S(a,b){var c=a.length,d=Math.floor(c/2);if(0===c)return[];if(1===c)return[a[0]];var e=S(a.slice(0,d),b);a=S(a.slice(d,c),b);for(c=[];0<e.length||0<a.length;)0<
e.length&&0<a.length?(d=b(e[0],a[0]),isNaN(d)&&(d=0),0>=d?(c.push(e[0]),e=e.slice(1)):(c.push(a[0]),a=a.slice(1))):0<e.length?(c.push(e[0]),e=e.slice(1)):0<a.length&&(c.push(a[0]),a=a.slice(1));return c}function ga(a,c,d){try{var e=a.body;if(d.length!==a.params.length)throw Error("Invalid Parameter calls to function.");for(var f=0;f<d.length;f++)c.localScope[a.params[f].name.toLowerCase()]={d:null,value:d[f],valueset:!0,node:null};var g=B(c,e);if(g instanceof b.ReturnResult)return g.value;if(g===
b.breakResult)throw Error("Cannot Break from a Function");if(g===b.continueResult)throw Error("Cannot Continue from a Function");return g instanceof b.ImplicitResult?g.value:g}catch(ea){throw ea;}}function L(a,b,c){return D(a,b,function(b,d,e){b={spatialReference:a.spatialReference,applicationCache:void 0===a.applicationCache?null:a.applicationCache,globalScope:a.globalScope,depthCounter:a.depthCounter+1,console:a.console,localScope:{}};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");
return ga(c,b,e)})}function R(a){return function(){var b={applicationCache:void 0===a.context.applicationCache?null:a.context.applicationCache,spatialReference:a.context.spatialReference,console:a.context.console,localScope:{},depthCounter:a.context.depthCounter+1,globalScope:a.context.globalScope};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");return ga(a.definition,b,arguments)}}function U(a){console.log(a)}var T=0,N={};u.registerFunctions(N,D);r.registerFunctions(N,D);n.registerFunctions(N,
D);w.registerFunctions(N,D);d.registerFunctions(N,D);N["typeof"]=function(a,c){return D(a,c,function(a,c,d){b.pcCheck(d,1,1);a=I(d[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};N.iif=function(a,c){try{b.pcCheck(null===c.arguments?[]:c.arguments,3,3);var d=B(a,c.arguments[0]);if(!1===b.isBoolean(d))throw Error("IF Function must have a boolean test condition");return!0===d?B(a,c.arguments[1]):B(a,c.arguments[2])}catch(aa){throw aa;}};N.decode=N.when=N.top=
function(a,c){return D(a,c,function(a,c,d){b.pcCheck(d,2,2);if(b.isArray(d[0]))return b.toNumber(d[1])>=d[0].length?d[0].slice(0):d[0].slice(0,b.toNumber(d[1]));if(b.isImmutableArray(d[0]))return b.toNumber(d[1])>=d[0].length()?d[0].slice(0):d[0].slice(0,b.toNumber(d[1]));throw Error("Top cannot accept this parameter type");})};N.first=function(a,c){return D(a,c,function(a,c,d){b.pcCheck(d,1,1);return b.isArray(d[0])?0===d[0].length?null:d[0][0]:b.isImmutableArray(d[0])?0===d[0].length()?null:d[0].get(0):
null})};N.sort=function(a,c){return D(a,c,function(a,c,d){b.pcCheck(d,1,2);a=d[0];b.isImmutableArray(a)&&(a=a.toArray());if(!1===b.isArray(a))throw Error("Illegal Argument");if(1<d.length){if(!1===b.isFunctionParameter(d[1]))throw Error("Illegal Argument");var e=R(d[1]);a=S(a,}else{if(0===a.length)return[];d={};for(c=0;c<a.length;c++){var f=I(a[c]);""!==f&&(d[f]=!0)}if(!0===d.Array||!0===d.Dictionary||!0===d.Feature||!0===d.Point||!0===d.Polygon||!0===d.Polyline||!0===
d.Multipoint||!0===d.Extent||!0===d.Function)return a.slice(0);c=0;var f="",g;for(g in d)c++,f=g;a=1<c||"String"===f?S(a,function(a,c){if(null===a||void 0===a||a===b.voidOperation)return null===c||void 0===c||c===b.voidOperation?0:1;if(null===c||void 0===c||c===b.voidOperation)return-1;a=b.toString(a);c=b.toString(c);return a<c?-1:a===c?0:1}):"Number"===f?S(a,function(a,b){return a-b}):"Boolean"===f?S(a,function(a,b){return a===b?0:b?-1:1}):"Date"===f?S(a,function(a,b){return b-a}):a.slice(0)}return a})};
h.functionHelper={fixSpatialReference:b.fixSpatialReference,parseArguments:z,standardFunction:D};h.executeScript=function(a,d,e){e||(e=new c(102100));var f=d.vars,g=d.customfunctions,k={};f||(f={});g||(g={});var n=new x({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});n.immutable=!1;k.textformatting={value:n,valueset:!0,node:null};k.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};k.pi={value:Math.PI,valueset:!0,node:null};for(var h in N)k[h]=
{value:new b.NativeFunction(N[h]),valueset:!0,node:null};for(h in g)k[h]={value:new b.NativeFunction(g[h]),"native":!0,valueset:!0,node:null};for(h in f)k[h]=f[h]instanceof m?{value:new y(f[h]),valueset:!0,node:null}:{value:f[h],valueset:!0,node:null};a=B({spatialReference:e,globalScope:k,localScope:null,console:d.console?d.console:U,depthCounter:1,applicationCache:void 0===d.applicationCache?null:d.applicationCache},a.body[0].body);a instanceof b.ReturnResult&&(a=a.value);a instanceof b.ImplicitResult&&
(a=a.value);a===b.voidOperation&&(a=null);if(a===b.breakResult)throw Error("Cannot return BREAK");if(a===b.continueResult)throw Error("Cannot return CONTINUE");if(a instanceof t)throw Error("Cannot return FUNCTION");if(a instanceof b.NativeFunction)throw Error("Cannot return FUNCTION");return a};h.extractFieldLiterals=function(a,b){void 0===b&&(b=!1);return q.findFieldLiterals(a,b)};h.validateScript=function(a,b){return q.validateScript(a,b,"simple")};h.referencesMember=function(a,b){return q.referencesMember(a,
b)};h.referencesFunction=function(a,b){return q.referencesFunction(a,b)}})},"esri/arcade/languageUtils":function(){define("require exports ../geometry/Geometry ../moment dojo/number ./ImmutableArray ../kernel ./ImmutablePointArray ./ImmutablePathArray dojo/_base/array ../geometry/Point ./FunctionWrapper".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x){function y(a,b,c){if(""===b||null===b||void 0===b||b===c||b===c)return a;do a=a.replace(b,c);while(-1!==a.indexOf(b));return a}nction r(a){return"boolean"===typeof a}unction w(a){return a instanceof Array}function d(a){return a instanceof Date}unction v(a,b){a=m(a);return void 0===b||null===b||""===b?a.format():a.format(A(b))}
nction D(a,b){if(a===b||null===a&&b===h.voidOperation||null===b&&a===h.voidOperation)return!0;if(d(a)&&d(b))return a.getTime()===b.getTime();if(a instanceof c||a instanceof g)return a.equalityTest(b);if(a instanceof q&&b instanceof q){var e=void 0,f=void 0;h.isVersion4?(e=a.cache._arcadeCacheId,
f=b.cache._arcadeCacheId):(e=a.getCacheValue("_arcadeCacheId"),f=b.getCacheValue("_arcadeCacheId"));if(void 0!==e&&null!==e)return e===f}return void 0!==a&&void 0!==b&&null!==a&&null!==b&&"object"===typeof a&&"object"===typeof b&&(a._arcadeCacheId===b._arcadeCacheId&&void 0!==a._arcadeCacheId&&null!==a._arcadeCacheId||a._underlyingGraphic===b._underlyingGraphic&&void 0!==a._underlyingGraphic&&null!==a._underlyingGraphic)?!0:!1}function B(a,b){if(u(a))return a;if(null===a)return"";if(n(a))return k(a,
b);if(r(a))return a.toString();if(d(a))return v(a,b);if(a instanceof p)return JSON.stringify(a.toJSON());if(w(a)){b=[];for(var c=0;c<a.length;c++)b[c]=F(a[c]);return"["+b.join(",")+"]"}if(a instanceof e){b=[];for(c=0;c<a.length();c++)b[c]=F(a.get(c));return"["+b.join(",")+"]"}return null!==a&&"object"===typeof a&&void 0!==a.castToText?a.castToText():t(a)?"object, Function":""}unction F(a){if(null!==a){if(r(a)||n(a)||u(a))return JSON.stringify(a);if(a instanceof p||a instanceof e||a instanceof Array)return C(a);if(a instanceof Date)return JSON.stringify(v(a,
""));if(null!==a&&"object"===typeof a&&void 0!==a.castToText)return a.castToText()}return"null"}function K(a,b){return n(a)?a:null===a||""===a?0:d(a)?NaN:r(a)?a?1:0:""===a||void 0===a?NaN:void 0!==b&&u(a)?(b=y(b,"\u2030",""),b=y(b,"\u00a4",""),f.parse(a,{pattern:b})):a===h.voidOperation?0:Number(a)}function M(a,c){var d;b.some(c.fields,function(b){b.name===a&&(d=b.domain);return!!d});return d}a=function(){return ();var E=function(){return function(a){this.value=a}}(),V=function(){return function(a){this.fn=
a}}(),P=);h.NativeFunction=V;h.ImplicitResult=E;h.ReturnResult=a;h.SizzleFunction=P;h.isVersion4=0===l.version.indexOf("4.");h.voidOperation={type:"VOID"};h.breakResult={type:"BREAK"};h.continueResult={type:"CONTINUE"};h.multiReplace=y;h.isFunctionParameter=t;h.isSimpleType=function(a){return u(a)||n(a)||d(a)||r(a)||null===a||a===h.voidOperation||"number"===typeof a?!0:!1};h.defaultUndefined=h.isString=u;h.isBoolean=r;
h.isNumber=n;h.isArray=w;h.isFeatureCursor=h.isImmutableArray=h.isDate=d;h.pcCheck=h.generateUUID=h.formatNumber=
k;h.formatDate=v;h.standardiseDateFormat=A;h.greaterThanLessThan=h.equalityTest=D;h.toString=B;h.toNumberArray=h.toStringExplicit=C;h.toNumber=K;h.toDate=function(a,b){return d(a)?a:u(a)&&(a=m(a,[void 0===b||null===b||""===b?m.ISO_8601:b]),a.isValid())?
a.toDate():null};h.toDateM=function(a,b){return d(a)?m(a):u(a)&&(a=m(a,[void 0===b||null===b||""===b?m.ISO_8601:b]),a.isValid())?a:null};h.toBoolean=function(a){if(r(a))return a;if(u(a)){if(a=a.toLowerCase(),"true"===a)return!0}else if(n(a))return 0===a||isNaN(a)?!1:!0;return!1};h.fixSpatialReference=function(a,b){if(null===a)return null;if(null===a.spatialReference||void 0===a.spatialReference)a.spatialReference=b;return a};h.getDomainValue=function(a,b){if(!a||!a.domain)return null;var c=null;b=
"string"===a.field.type||"esriFieldTypeString"===a.field.type?B(b):K(b);for(var d=0;d<a.domain.codedValues.length;d++){var e=a.domain.codedValues[d];e.code===b&&(c=e)}return null===c?null:c.name};h.getDomainCode=function(a,b){if(!a||!a.domain)return null;var c=null;b=B(b);for(var d=0;d<a.domain.codedValues.length;d++){var e=a.domain.codedValues[d];e.name===b&&(c=e)}return null===c?null:c.code};h.getDomain=function(a,c,d,e){void 0===d&&(d=null);if(!c||!c.fields)return null;for(var f=null,g=0;g<c.fields.length;g++){var k=
c.fields[g];k.name.toLowerCase()===a.toString().toLowerCase()&&(f=k)}if(null===f)return null;var n,h;e||(e=d&&c.typeIdField&&d._field(c.typeIdField));null!=e&&b.some(c.types,;h||n||(n=M(a,c));return{field:f,domain:n}}})},"esri/moment":"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel",
"moment/moment"],function(a,h,p,m){var f={ar:1,"ar-dz":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bs:1,cs:1,da:1,de:1,"de-at":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-nz":1,es:1,"es-do":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1};h.load=)},"moment/moment":function(){((this,function(){unction h(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}nction f(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}tion b(a){null==a._pf&&
(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null});return a._pf}function q(a){if(null==a._isValid){var c=b(a),d=bc.call(c.parsedDateParts,,d=!isNaN(a._d.getTime())&&0>c.overflow&&!c.empty&&!c.invalidMonth&&!c.invalidWeekday&&!c.nullInput&&!c.invalidFormat&&!c.userInvalidated&&(!c.meridiem||c.meridiem&&d);a._strict&&(d=d&&0===c.charsLeftOver&&
0===c.unusedTokens.length&&void 0===c.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}nction t(a,c){var d,e,f;y(c._isAMomentObject)||(a._isAMomentObject=c._isAMomentObject);y(c._i)||(a._i=c._i);y(c._f)||(a._f=c._f);y(c._l)||(a._l=c._l);y(c._strict)||(a._strict=c._strict);y(c._tzm)||(a._tzm=c._tzm);y(c._isUTC)||(a._isUTC=c._isUTC);y(c._offset)||
(a._offset=c._offset);y(c._pf)||(a._pf=b(c));y(c._locale)||(a._locale=c._locale);if(0<Eb.length)for(d in Eb)e=Eb[d],f=c[e],y(f)||(a[e]=f);return a}{return function(d){if(null!=
d){if(this.isValid())this._d["set"+(this._isUTC?"UTC":"")+b](d);a.updateOffset(this,c);return this}return V(this,b)}}tion Q(a){var b=a.match(Rb),c,d;c=0;for(d=b.length;c<d;c++)b[c]=kb[b[c]]?kb[b[c]]:J(b[c]);return function(c){var e="",f;for(f=0;f<d;f++)e+=b[f]instanceof Function?b[f].call(c,a):b[f];return e}}],d=[],e=[],f=[],g,k,n,h;for(g=0;7>g;g++)k=c([2E3,1]).day(g),n=this.weekdaysMin(k,""),h=this.weekdaysShort(k,""),k=this.weekdays(k,""),b.push(n),d.push(h),e.push(k),
f.push(n),f.push(h),f.push(k);b.sort(a);d.sort(a);e.sort(a);f.sort(a);for(g=0;7>g;g++)d[g]=T(d[g]),e[g]=T(e[g]),f[g]=T(f[g]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+f.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+b.join("|")+")","i")}ion Fa(a,b){a&&(a=y(b)?W(a):Aa(a,b))&&(xb=a);return xb._abbr}function Aa(a,b){if(null!==b){var c=Sb;b.abbr=a;if(null!=Ia[a])A("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),
c=Ia[a]._config;else if(null!=b.parentLocale)if(null!=Ia[b.parentLocale])c=Ia[b.parentLocale]._config;else return pb[b.parentLocale]||(pb[b.parentLocale]=[]),pb[b.parentLocale].push({name:a,config:b}),null;Ia[a]=new B(D(c,b));pb[a]&&pb[a].forEach(;Fa(a);return Ia[a]}delete Ia[a];return null}ction Ua(b){var c=ic.exec(b._i);null!==c?b._d=new Date(+c[1]):(Ra(b),!1===b._isValid&&(delete b._isValid,a.createFromInputFallback(b)))}unction Sa(c){var d,e=[],f;if(!c._d){f=new Date(a.now());f=c._useUTC?[f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate()]:[f.getFullYear(),f.getMonth(),f.getDate()];if(c._w&&null==c._a[Ya]&&null==c._a[Za]){var g,k,n,h,l,m;g=c._w;if(null!=g.GG||null!=g.W||null!=g.E){if(l=1,m=4,k=La(g.GG,c._a[Wa],wa(xa(),1,4).year),
n=La(g.W,1),h=La(g.E,1),1>h||7<h)d=!0}else if(l=c._locale._week.dow,m=c._locale._week.doy,n=wa(xa(),l,m),k=La(g.gg,c._a[Wa],n.year),n=La(g.w,n.week),null!=g.d){if(h=g.d,0>h||6<h)d=!0}else if(null!=g.e){if(h=g.e+l,0>g.e||6<g.e)d=!0}else h=l;1>n||n>na(k,l,m)?b(c)._overflowWeeks=!0:null!=d?b(c)._overflowWeekday=!0:(d=ma(k,n,h,l,m),c._a[Wa]=d.year,c._dayOfYear=d.dayOfYear)}c._dayOfYear&&(d=La(c._a[Wa],f[Wa]),c._dayOfYear>(X(d)?366:365)&&(b(c)._overflowDayOfYear=!0),d=la(d,0,c._dayOfYear),c._a[Za]=d.getUTCMonth(),
c._a[Ya]=d.getUTCDate());for(d=0;3>d&&null==c._a[d];++d)c._a[d]=e[d]=f[d];for(;7>d;d++)c._a[d]=e[d]=null==c._a[d]?2===d?1:0:c._a[d];24===c._a[Na]&&0===c._a[Xa]&&0===c._a[$a]&&0===c._a[gb]&&(c._nextDay=!0,c._a[Na]=0);c._d=(c._useUTC?la:ea).apply(null,e);null!=c._tzm&&c._d.setUTCMinutes(c._d.getUTCMinutes()-c._tzm);c._nextDay&&(c._a[Na]=24)}}function da(c){if(c._f===a.ISO_8601)Ra(c);else{c._a=[];b(c).empty=!0;var d=""+c._i,e,f,g,k,n,h=d.length,m=0;g=ga(c._f,c._locale).match(Rb)||[];for(e=0;e<g.length;e++){k=
g[e];if(f=(d.match(R(k,c))||[])[0])n=d.substr(0,d.indexOf(f)),0<n.length&&b(c).unusedInput.push(n),d=d.slice(d.indexOf(f)+f.length),m+=f.length;if(kb[k]){if(f?b(c).empty=!1:b(c).unusedTokens.push(k),n=c,null!=f&&l(Ib,k))Ib[k](f,n._a,n,k)}else c._strict&&!f&&b(c).unusedTokens.push(k)}b(c).charsLeftOver=h-m;0<d.length&&b(c).unusedInput.push(d);12>=c._a[Na]&&!0===b(c).bigHour&&0<c._a[Na]&&(b(c).bigHour=void 0);b(c).parsedDateParts=c._a.slice(0);b(c).meridiem=c._meridiem;d=c._a;e=Na;h=c._locale;g=c._a[Na];
m=c._meridiem;null!=m&&(null!=h.meridiemHour?g=h.meridiemHour(g,m):null!=h.isPM&&((h=h.isPM(m))&&12>g&&(g+=12),h||12!==g||(g=0)));d[e]=g;Sa(c);Ka(c)}}unction za(a){var c=a._i,d=a._f;a._locale=a._locale||W(a._l);if(null===c||void 0===d&&""===c)return x({nullInput:!0});"string"===typeof c&&(a._i=c=a._locale.preparse(c));if(r(c))return new u(Ka(c));
if(f(c))a._d=c;else if(h(d)){var e,k,n;if(0===a._f.length)b(a).invalidFormat=!0,a._d=new Date(NaN);else{for(c=0;c<a._f.length;c++)if(d=0,e=t({},a),null!=a._useUTC&&(e._useUTC=a._useUTC),e._f=a._f[c],da(e),q(e)&&(d+=b(e).charsLeftOver,d+=10*b(e).unusedTokens.length,b(e).score=d,null==n||d<n))n=d,k=e;g(a,k||e)}}else d?da(a):ja(a);q(a)||(a._d=null);return a}function ja(b){var c=b._i;void 0===c?b._d=new Date(a.now()):f(c)?b._d=new Date(c.valueOf()):"string"===typeof c?Ua(b):h(c)?(b._a=e(c.slice(0),,Sa(b)):"object"===typeof c?Ja(b):m(c)?b._d=new Date(c):a.createFromInputFallback(b)}function Qa(a,b,c,d,e){var f={};if(!0===c||!1===c)d=c,c=void 0;var g;if(g=p(a))a:{g=a;for(var k in g){g=!1;break a}g=!0}if(g||h(a)&&0===a.length)a=void 0;f._isAMomentObject=!0;f._useUTC=f._isUTC=e;f._l=c;f._i=a;f._f=b;f._strict=d;a=new u(Ka(za(f)));a._nextDay&&(a.add(1,"d"),a._nextDay=void 0);return a}ha(a,b){var c=a,d=null;ca(a)?c=
{ms:a._milliseconds,d:a._days,M:a._months}:m(a)?(c={},b?c[b]=a:c.milliseconds=a):(d=kc.exec(a))?(c="-"===d[1]?-1:1,c={y:0,d:w(d[Ya])*c,h:w(d[Na])*c,m:w(d[Xa])*c,s:w(d[$a])*c,ms:w(ya(1E3*d[gb]))*c}):(d=lc.exec(a))?(c="-"===d[1]?-1:1,c={y:ia(d[2],c),M:ia(d[3],c),w:ia(d[4],c),d:ia(d[5],c),h:ia(d[6],c),m:ia(d[7],c),s:ia(d[8],c)}):null==c?c={}:"object"===typeof c&&("from"in c||"to"in c)&&(d=xa(c.from),c=xa(c.to),d.isValid()&&c.isValid()?(c=oa(c,d),d.isBefore(c)?c=Y(d,c):(c=Y(c,d),c.milliseconds=-c.milliseconds,
c.months=-c.months),d=c):d={milliseconds:0,months:0},c={},c.ms=d.milliseconds,c.M=d.months);c=new Pa(c);ca(a)&&l(a,"_locale")&&(c._locale=a._locale);return c}nction tb(a,b){return function(c,d){var e;null===d||isNaN(+d)||
(A(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),e=c,c=d,d=e);c=ha("string"===typeof c?+c:c,d);mb(this,c,a);return this}}function mb(b,c,d,e){var f=c._milliseconds,g=ya(c._days);c=ya(c._months);if(b.isValid()){e=null==e?!0:e;f&&b._d.setTime(b._d.valueOf()+f*d);if(g&&(f=V(b,"Date")+g*d,b.isValid()))b._d["set"+(b._isUTC?"UTC":"")+"Date"](f);c&&O(b,V(b,"Month")+c*d);e&&a.updateOffset(b,
g||c)}}{var a=Kb(this._milliseconds)/1E3,b=Kb(this._days),c=Kb(this._months),d,e;d=n(a/60);e=n(d/60);a%=60;d%=60;var f=n(c/12),c=c%12,g=this.asSeconds();return g?(0>g?"-":"")+"P"+(f?f+"Y":"")+(c?c+"M":"")+(b?b+"D":"")+(e||d||a?"T":"")+(e?e+"H":"")+(d?d+"M":"")+(a?a+"S":""):"P0D"}
var Pb,bc=Array.prototype.some?Array.prototype.some:Eb=a.momentProperties=[],Fb=!1,Qb={};a.suppressDeprecationWarnings=!1;a.deprecationHandler=null;var cc=Object.keys?Object.keys:nb={},Oa={},Rb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,
wb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Gb={},kb={},Tb=/\d/,Ta=/\d\d/,Ub=/\d{3}/,Lb=/\d{4}/,zb=/[+-]?\d{6}/,Ha=/\d\d?/,Vb=/\d\d\d\d?/,Wb=/\d\d\d\d\d\d?/,Ab=/\d{1,3}/,Mb=/\d{1,4}/,Bb=/[+-]?\d{1,6}/,mc=/\d+/,Cb=/[+-]?\d+/,nc=/Z|[+-]\d\d:?\d\d/gi,Db=/Z|[+-]\d\d(?::?\d\d)?/gi,qb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Hb={},Ib={},Wa=0,Za=1,Ya=2,Na=3,Xa=4,$a=5,gb=6,dc=7,ec=8,Ma=Array.prototype.indexOf?Array.prototype.indexOf:
I("M",["MM",2],"Mo",;I("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});I("MMMM",0,0,function(a){return this.localeData().months(this,a)});C("month","M");Oa.month=8;L("M",Ha);L("MM",Ha,Ta);L("MMM",function(a,b){return b.monthsShortRegex(a)});L("MMMM",function(a,b){return b.monthsRegex(a)});N(["M","MM"],;N(["MMM","MMMM"],function(a,c,d,e){e=
d._locale.monthsParse(a,e,d._strict);null!=e?c[Za]=e:b(d).invalidMonth=a});var Xb=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;I("Y",0,0,;I(0,["YY",2],0,function(){return this.year()%100});I(0,["YYYY",4],0,"year");I(0,["YYYYY",5],0,"year");I(0,["YYYYYY",6,!0],0,"year");C("year","y");Oa.year=1;L("Y",Cb);L("YY",Ha,Ta);L("YYYY",Mb,Lb);L("YYYYY",Bb,zb);L("YYYYYY",Bb,zb);N(["YYYYY","YYYYYY"],Wa);N("YYYY",;N("YY",;N("Y",;a.parseTwoDigitYear=var Yb=E("FullYear",!0);I("w",["ww",2],"wo","week");I("W",["WW",2],"Wo","isoWeek");C("week","w");C("isoWeek","W");Oa.week=5;Oa.isoWeek=5;L("w",Ha);L("ww",Ha,Ta);L("W",Ha);L("WW",Ha,Ta);Z(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=w(a)});I("d",0,"do","day");I("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});
I("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});I("dddd",0,0,;I("e",0,0,"weekday");I("E",0,0,"isoWeekday");C("day","d");C("weekday","e");C("isoWeekday","E");Oa.day=11;Oa.weekday=11;Oa.isoWeekday=11;L("d",Ha);L("e",Ha);L("E",Ha);L("dd",function(a,b){return b.weekdaysMinRegex(a)});L("ddd",function(a,b){return b.weekdaysShortRegex(a)});L("dddd",function(a,b){return b.weekdaysRegex(a)});Z(["dd","ddd","dddd"],;Z(["d","e","E"],;I("H",["HH",2],0,"hour");I("h",["hh",2],0,pa);I("k",["kk",2],0,;I("hmm",0,0,;I("hmmss",0,0,;I("Hmm",0,0,;I("Hmmss",0,0,;qa("a",!0);qa("A",!1);C("hour","h");Oa.hour=13;L("a",ua);L("A",ua);L("H",Ha);L("h",Ha);L("HH",Ha,Ta);L("hh",Ha,Ta);L("hmm",Vb);L("hmmss",Wb);L("Hmm",Vb);L("Hmmss",Wb);N(["H","HH"],Na);N(["a","A"],;N(["h","hh"],;N("hmm",;N("hmmss",;N("Hmm",;N("Hmmss",;var oc=E("Hours",!0),Sb={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",
LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",ordinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),meridiemParse:/[ap]\.?m?\.?/i},Ia={},pb={},xb,fc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
hc=/Z|[+-]\d\d(?::?\d\d)?/,yb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Jb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",
/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ic=/^\/?Date\((\-?\d+)/i;a.createFromInputFallback=v("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",;a.ISO_8601=function(){};var pc=v("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",,qc=v("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",;G("Z",":");G("ZZ","");L("Z",
Db);L("ZZ",Db);N(["Z","ZZ"],;var jc=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var kc=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,lc=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;ha.fn=Pa.prototype;var rc=tb(1,"add"),sc=tb(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";a.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Zb=v("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",
;I(0,["gg",2],0,function(){return this.weekYear()%100});I(0,["GG",2],0,;Va("gggg","weekYear");Va("ggggg","weekYear");Va("GGGG","isoWeekYear");Va("GGGGG","isoWeekYear");C("weekYear","gg");C("isoWeekYear","GG");Oa.weekYear=1;Oa.isoWeekYear=1;L("G",Cb);L("g",Cb);L("GG",Ha,Ta);L("gg",Ha,Ta);L("GGGG",Mb,Lb);L("gggg",Mb,Lb);L("GGGGG",Bb,zb);L("ggggg",Bb,zb);Z(["gggg","ggggg","GGGG","GGGGG"],;Z(["gg","GG"],;I("Q",0,"Qo","quarter");C("quarter","Q");Oa.quarter=7;L("Q",Tb);N("Q",;I("D",["DD",2],"Do","date");C("date","D");Oa.date=9;L("D",Ha);L("DD",Ha,Ta);L("Do",;N(["D","DD"],Ya);N("Do",;var $b=E("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear");C("dayOfYear","DDD");Oa.dayOfYear=
4;L("DDD",Ab);L("DDDD",Ub);N(["DDD","DDDD"],;I("m",["mm",2],0,"minute");C("minute","m");Oa.minute=14;L("m",Ha);L("mm",Ha,Ta);N(["m","mm"],Xa);var tc=E("Minutes",!1);I("s",["ss",2],0,"second");C("second","s");Oa.second=15;L("s",Ha);L("ss",Ha,Ta);N(["s","ss"],$a);var uc=E("Seconds",!1);I("S",0,0,function(){return~~(this.millisecond()/100)});I(0,["SS",2],0,;I(0,["SSS",3],0,"millisecond");I(0,["SSSS",4],0,function(){return 10*
this.millisecond()});I(0,["SSSSS",5],0,function(){return 100*this.millisecond()});I(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});I(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});I(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});I(0,["SSSSSSSSS",9],0,;C("millisecond","ms");Oa.millisecond=16;L("S",Ab,Tb);L("SS",Ab,Ta);L("SSS",Ab,Ub);var cb;for(cb="SSSS";9>=cb.length;cb+="S")L(cb,mc);for(cb="S";9>=cb.length;cb+="S")N(cb,
ob);var vc=E("Milliseconds",!1);I("z",0,0,"zoneAbbr");I("zz",0,0,"zoneName");var fa=u.prototype;fa.add=rc;fa.calendar=function(b,c){b=b||xa();var d=oa(b,this).startOf("day"),d=a.calendarFormat(this,d)||"sameElse";c=c&&(z(c[d])?c[d].call(this,b):c[d]);return this.format(c||this.localeData().calendar(d,this,xa(b)))};fa.clone=fa.diff=function(a,b,c){var d;if(!this.isValid())return NaN;a=oa(a,this);if(!a.isValid())return NaN;d=6E4*(a.utcOffset()-this.utcOffset());b=F(b);
if("year"===b||"month"===b||"quarter"===b){d=12*(a.year()-this.year())+(a.month()-this.month());var e=this.clone().add(d,"months"),f;0>a-e?(f=this.clone().add(d-1,"months"),a=(a-e)/(e-f)):(f=this.clone().add(d+1,"months"),a=(a-e)/(f-e));a=-(d+a)||0;"quarter"===b?a/=3:"year"===b&&(a/=12)}else a=this-a,a="second"===b?a/1E3:"minute"===b?a/6E4:"hour"===b?a/36E5:"day"===b?(a-d)/864E5:"week"===b?(a-d)/6048E5:a;return c?a:n(a)};fa.endOf=fa.format=fa.from=function(a,b){return this.isValid()&&(r(a)&&a.isValid()||xa(a).isValid())?ha({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};fa.fromNow=function(a){return this.from(xa(),a)};fa.to=fa.toNow=fa.get=fa.invalidAt=fa.isAfter=fa.isBefore=fa.isBetween=fa.isSame=fa.isSameOrAfter=function(a,b){return this.isSame(a,b)||this.isAfter(a,b)};fa.isSameOrBefore=fa.isValid=fa.lang=Zb;fa.locale=jb;fa.localeData=ub;fa.max=qc;fa.min=pc;fa.parsingFlags=fa.set=
fa.startOf=fa.subtract=sc;fa.toArray=fa.toObject=fa.toDate=fa.toISOString=fa.inspect=
function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");var a="["+a+'("]',c=0<this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+c+"-MM-DD[T]HH:mm:ss.SSS"+(b+'[")]'))};fa.toJSON=fa.toString=fa.unix=fa.valueOf=fa.creationData=fa.year=Yb;fa.isLeapYear=fa.weekYear=fa.isoWeekYear=fa.quarter=fa.quarters=fa.month=aa;fa.daysInMonth=fa.week=fa.weeks=fa.isoWeek=fa.isoWeeks=fa.weeksInYear=fa.isoWeeksInYear=fa.date=
$b;fa.day=fa.days=fa.weekday=fa.isoWeekday=fa.dayOfYear=fa.hour=fa.hours=oc;fa.minute=fa.minutes=tc;fa.second=fa.seconds=uc;fa.millisecond=fa.milliseconds=vc;fa.utcOffset=function(b,c){var d=this._offset||0,e;if(!this.isValid())return null!=b?this:
NaN;if(null!=b){if("string"===typeof b){if(b=ka(Db,b),null===b)return this}else 16>Math.abs(b)&&(b*=60);!this._isUTC&&c&&(e=15*-Math.round(this._d.getTimezoneOffset()/15));this._offset=b;this._isUTC=!0;null!=e&&this.add(e,"m");d!==b&&(!c||this._changeInProgress?mb(this,ha(b-d,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?d:15*-Math.round(this._d.getTimezoneOffset()/15)};fa.utc=fa.local=fa.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm);else if("string"===typeof this._i){var a=ka(nc,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this};fa.hasAlignedHourOffset=fa.isDST=fa.isLocal=fa.isUtcOffset=fa.isUtc=Ba;fa.isUTC=Ba;fa.zoneAbbr=function(){return this._isUTC?"UTC":""};fa.zoneName=fa.dates=v("dates accessor is deprecated. Use date instead.",$b);fa.months=v("months accessor is deprecated. Use month instead",aa);fa.years=
v("years accessor is deprecated. Use year instead",Yb);fa.zone=v("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",;fa.isDSTShifted=v("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",;var Ga=B.prototype;Ga.calendar=Ga.longDateFormat=Ga.invalidDate=
Ga.ordinal=Ga.preparse=vb;Ga.postformat=vb;Ga.relativeTime=Ga.pastFuture=Ga.set=function(a){var b,c;for(c in a)b=a[c],z(b)?this[c]=b:this["_"+c]=b;this._config=a;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)};
Ga.months=Ga.monthsShort=Ga.monthsParse=Ga.monthsRegex=function(a){if(this._monthsParseExact)return l(this,"_monthsRegex")||ba.call(this),a?this._monthsStrictRegex:this._monthsRegex;l(this,"_monthsRegex")||(this._monthsRegex=qb);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};Ga.monthsShortRegex=function(a){if(this._monthsParseExact)return l(this,"_monthsRegex")||ba.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;
l(this,"_monthsShortRegex")||(this._monthsShortRegex=qb);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};Ga.week=Ga.firstDayOfYear=function(){return this._week.doy};Ga.firstDayOfWeek=function(){return this._week.dow};Ga.weekdays=Ga.weekdaysMin=
function(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin};Ga.weekdaysShort=Ga.weekdaysParse=Ga.weekdaysRegex=function(a){if(this._weekdaysParseExact)return l(this,"_weekdaysRegex")||Ea.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex;l(this,"_weekdaysRegex")||(this._weekdaysRegex=qb);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};Ga.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return l(this,"_weekdaysRegex")||Ea.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;l(this,
"_weekdaysShortRegex")||(this._weekdaysShortRegex=qb);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};Ga.weekdaysMinRegex=Ga.isPM=
Ga.meridiem=Fa("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:);a.lang=v("moment.lang is deprecated. Use moment.locale instead.",Fa);a.langData=v("moment.langData is deprecated. Use moment.localeData instead.",W);var ab=Math.abs,wc=bb("ms"),xc=bb("s"),yc=bb("m"),zc=bb("h"),Ac=bb("d"),Bc=bb("w"),Cc=bb("M"),Dc=bb("y"),Ec=fb("milliseconds"),Fc=fb("seconds"),
Gc=fb("minutes"),Hc=fb("hours"),Ic=fb("days"),Jc=fb("months"),Kc=fb("years"),db=Math.round,eb={s:45,m:45,h:22,d:26,M:11},Kb=Math.abs,Da=Pa.prototype;Da.abs=Da.add=Da.subtract=Da.as=function(a){var b,c=this._milliseconds;a=F(a);if("month"===a||"year"===a)return b=this._days+c/864E5,b=this._months+4800*b/146097,"month"===a?b:b/12;b=this._days+Math.round(146097*this._months/4800);switch(a){case "week":return b/7+c/6048E5;case "day":return b+c/864E5;case "hour":return 24*b+c/36E5;case "minute":return 1440*b+c/6E4;case "second":return 86400*b+c/1E3;case "millisecond":return Math.floor(864E5*b)+c;default:throw Error("Unknown unit "+a);}};Da.asMilliseconds=
wc;Da.asSeconds=xc;Da.asMinutes=yc;Da.asHours=zc;Da.asDays=Ac;Da.asWeeks=Bc;Da.asMonths=Cc;Da.asYears=Dc;Da.valueOf=Da._bubble=Da.get=function(a){a=F(a);return this[a+"s"]()};Da.milliseconds=Ec;Da.seconds=Fc;Da.minutes=Gc;Da.hours=Hc;Da.days=Ic;Da.weeks=Da.months=Jc;Da.years=Kc;Da.humanize=function(a){var b=this.localeData(),c;c=!a;var d=ha(this).abs(),e=db(d.as("s")),f=db(d.as("m")),g=db(d.as("h")),k=db(d.as("d")),n=db(d.as("M")),d=db(d.as("y")),e=e<eb.s&&["s",e]||1>=f&&["m"]||f<eb.m&&["mm",f]||1>=g&&["h"]||
g<eb.h&&["hh",g]||1>=k&&["d"]||k<eb.d&&["dd",k]||1>=n&&["M"]||n<eb.M&&["MM",n]||1>=d&&["y"]||["yy",d];e[2]=c;e[3]=0<+this;e[4]=b;c=ac.apply(null,e);a&&(c=b.pastFuture(+this,c));return b.postformat(c)};Da.toISOString=rb;Da.toString=rb;Da.toJSON=rb;Da.locale=jb;Da.localeData=ub;Da.toIsoString=v("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",rb);Da.lang=Zb;I("X",0,0,"unix");I("x",0,0,"valueOf");L("x",Cb);L("X",/[+-]?\d+(\.\d{1,3})?/);N("X",;N("x",;a.version="2.17.1";Pb=xa;a.fn=fa;a.min=function(){var a=[].slice.call(arguments,0);return ra("isBefore",a)};a.max=a.now=a.utc=c;a.unix=a.months=function(a,b){return hb(a,b,"months")};a.isDate=f;a.locale=Fa;a.invalid=x;a.duration=ha;a.isMoment=r;a.weekdays=function(a,b,c){return ib(a,
b,c,"weekdays")};a.parseZone=a.localeData=W;a.isDuration=ca;a.monthsShort=a.weekdaysMin=function(a,b,c){return ib(a,b,c,"weekdaysMin")};a.defineLocale=Aa;a.updateLocale=a.locales=
a.weekdaysShort=a.normalizeUnits=F;a.relativeTimeRounding=a.relativeTimeThreshold=function(a,b){if(void 0===eb[a])return!1;if(void 0===b)return eb[a];eb[a]=b;return!0};a.calendarFormat=a.prototype=fa;return a})},"esri/arcade/ImmutableArray":"esri/arcade/ImmutablePointArray":function(){define("require exports ../core/tsSupport/extendsHelper ./ImmutableArray ../geometry/Point ../kernel".split(" "),function(a,h,p,m,f,e){var l=
0===e.version.indexOf("4.");return function(a){(c,a);c.prototype.get=function(a){if(void 0===this._lazyPt[a]){var b=this._elements[a];if(void 0===b)return;var c=this._hasZ,e=this._hasM,g=null,g=c&&!e?new f(b[0],b[1],b[2],void 0,this._spRef):e&&c?new f(b[0],b[1],void 0,b[2],this._spRef):c&&e?new f(b[0],b[1],b[2],b[3],this._spRef):new f(b[0],b[1],this._spRef);
l?g.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString():g.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString());this._lazyPt[a]=g}return this._lazyPt[a]};c.prototype.equalityTest=function(a){return a===this?!0:null===a||!1===a instanceof c?!1:a.getUniqueHash()===this.getUniqueHash()};c.prototype.getUniqueHash=return c}(m)})},"esri/arcade/ImmutablePathArray":function(){define(["require",
"exports","../core/tsSupport/extendsHelper","./ImmutableArray","./ImmutablePointArray"],function(a,h,p,m,f){return m)})},"esri/arcade/FunctionWrapper":"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(a,h){function p(a,b,c,e){void 0!==a.fmin&&
(a.min=a.fmin);void 0!==a.fmax&&(a.max=a.fmax);return"0"!==a.min&&c.length<Number(a.min)||"*"!==a.max&&c.length>Number(a.max)?-2:1}function m(a,b,c){if(null!==c.localScope&&void 0!==c.localScope[a.toLowerCase()]){var d=c.localScope[a.toLowerCase()];if("FormulaFunction"===d.type||"any"===d.type)return void 0===d.signature&&(d.signature={min:"0",max:"*"}),p(d.signature,a,b,c)}return void 0!==c.globalScope[a.toLowerCase()]&&(d=c.globalScope[a.toLowerCase()],"FormulaFunction"===d.type||"any"===d.type)?
(void 0===d.signature&&(d.signature={min:"0",max:"*"}),p(d.signature,a,b,c)):-1}function f(a,b){void 0===b&&(b=!0);var c=y(a,"SYNTAX","UNREOGNISED");try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?y(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==a.id.type?y(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):null!==a.init?f(a.init,!1):"";case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)if(c=f(a.declarations[e],b),""!==c)return c;
return"";case "ForInStatement":c=f(a.left,b);if(""!==c)break;if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return y(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return y(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return y(a,"SYNTAX","LEFTNOTVAR");c=f(a.right,b);if(""!==c)break;c=f(a.body,b);if(""!==c)break;return"";case "ForStatement":if(null!==a.test&&(c=f(a.test,b),""!==c))break;if(null!==a.init&&(c=f(a.init,b),""!==c))break;if(null!==
a.update&&(c=f(a.update,b),""!==c))break;if(null!==a.body&&(c=f(a.body,b),""!==c))break;return"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":c=f(a.test,b);if(""!==c)break;if(null!==a.consequent&&(c=f(a.consequent,!1),""!==c))break;if(null!==a.alternate&&(c=f(a.alternate,!1),""!==c))break;return"";case "BlockStatement":for(var g=[],e=0;e<a.body.length;e++)"EmptyStatement"!==a.body[e].type&&g.push(a.body[e]);a.body=g;for(e=0;e<a.body.length;e++)if(c=
f(a.body[e],b),""!==c)return c;return"";case "FunctionDeclaration":return!1===b?y(a,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==a.id.type?y(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):f(a.body,!1);case "ReturnStatement":return null!==a.argument?f(a.argument,b):"";case "UpdateExpression":return"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?y(a,"SYNTAX","ASSIGNMENTTOVARSONLY"):f(a.argument,b);case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type)return y(a,
"SYNTAX","ASSIGNMENTTOVARSONLY");c=f(a.left,b);if(""!==c)break;switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return y(a,"SYNTAX","OPERATORNOTRECOGNISED")}return f(a.right,!1);case "ExpressionStatement":return f(a.expression,!1);case "Identifier":c="";break;case "MemberExpression":c=f(a.object,b);if(""!==c)break;return!0===a.computed?f(a.property,b):"";case "Literal":return"";case "ThisExpression":return y(a,"SYNTAX","NOTSUPPORTED");case "CallExpression":if("Identifier"!==
a.callee.type)return y(a,"SYNTAX","ONLYNODESSUPPORTED");c="";for(e=0;e<a.arguments.length;e++)if(c=f(a.arguments[e],b),""!==c)return c;return"";case "UnaryExpression":c=f(a.argument,b);break;case "BinaryExpression":c=f(a.left,b);if(""!==c)break;c=f(a.right,b);if(""!==c)break;switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:return y(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":c=
f(a.left,b);if(""!==c)break;c=f(a.right);if(""!==c)break;switch(a.operator){case "\x26\x26":case "||":break;default:return y(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return y(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":c="";for(e=0;e<a.elements.length&&(c=f(a.elements[e],b),""===c);e++);break;case "Array":return y(a,"SYNTAX","NOTSUPPORTED");case "ObjectExpression":c="";for(e=0;e<a.properties.length&&(c="",null!==a.properties[e].key&&("Literal"!==a.properties[e].key.type&&
"Identifier"!==a.properties[e].key.type&&(c=y(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[e].key.type&&(g=a.properties[e].key.value,"string"===typeof g||g instanceof String||(c=y(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")))),""===c&&(c=f(a.properties[e],b)),""===c);e++);break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return y(a,"SYNTAX","ONLYLITERAL");if("Identifier"!==a.key.type&&(c=f(a.key,b),""!==c))break;c=f(a.value,b)}return c}catch(A){throw A;
}}function e(a,c){var d=y(a,"SYNTAX","UNREOGNISED"),f=null,g="";try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type)return y(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");null!==c.localScope?void 0!==c.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==c.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase();var n=null===a.init?"":e(a.init,c);if(""!==n)return n;null===c.localScope?c.globalScope[a.id.name.toLowerCase()]={type:"any"}:
c.localScope[a.id.name.toLowerCase()]={type:"any"};return"";case "FunctionDeclaration":f=b(a.id.name.toLowerCase(),a,c);g=q(a,c);if(""!==g)return g;if(null!==c.localScope)return y(a,"SYNTAX","GLOBALFUNCTIONSONLY");f.isnative=!1;c.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[f]};return"";case "VariableDeclaration":for(var d="",h=0;h<a.declarations.length&&(d=e(a.declarations[h],c),""===d);h++);break;case "IfStatement":d=e(a.test,c);if(""!==d)break;if("AssignmentExpression"===
a.test.type||"UpdateExpression"===a.test.type)return y(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");if(null!==a.consequent&&(d=e(a.consequent,c),""!==d))break;if(null!==a.alternate&&(d=e(a.alternate,c),""!==d))break;return"";case "EmptyStatement":return"";case "BlockStatement":for(h=0;h<a.body.length;h++)if(d=e(a.body[h],c),""!==d)return d;return"";case "ReturnStatement":return null!==a.argument?e(a.argument,c):"";case "ForInStatement":if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return y(a,
"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return y(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return y(a,"SYNTAX","LEFTNOTVAR");d=e(a.left,c);if(""!==d)break;d=e(a.right,c);if(""!==d)break;d=e(a.body,c);if(""!==d)break;return"";case "ForStatement":if(null!==a.init&&(d=e(a.init,c),""!==d))break;if(null!==a.test&&(d=e(a.test,c),""!==d))break;if(null!==a.body&&(d=e(a.body,c),""!==d))break;if(null!==a.update&&(d=e(a.update,c),""!==d))break;return"";case "BreakStatement":return"";
case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type)return y(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var l=!1;if("MemberExpression"===a.argument.type)return e(a.argument,c);null!==c.localScope&&void 0!==c.localScope[a.argument.name.toLowerCase()]&&(l=!0);void 0!==c.globalScope[a.argument.name.toLowerCase()]&&(l=!0);return!1===l?"Identifier "+a.argument.name+" has not been declared.":"";case "AssignmentExpression":if("Identifier"!==
a.left.type&&"MemberExpression"!==a.left.type)return y(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var p=e(a.right,c);if(""!==p)return p;l=!1;if("MemberExpression"===a.left.type)return p=e(a.left,c),""!==p?p:"";null!==c.localScope&&void 0!==c.localScope[a.left.name.toLowerCase()]&&(l=!0);void 0!==c.globalScope[a.left.name.toLowerCase()]&&(l=!0);return!1===l?"Identifier "+a.left.name+" has not been declared.":"";case "ExpressionStatement":return e(a.expression,c);case "Identifier":var r=a.name.toLowerCase();
if(null!==c.localScope&&void 0!==c.localScope[r])return"";d=void 0!==c.globalScope[r]?"":y(a,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":d=e(a.object,c);if(""!==d)break;return!0===a.computed?e(a.property,c):"";case "Literal":return"";case "ThisExpression":d=y(a,"SYNTAX","NOTSUPPORTED");break;case "CallExpression":if("Identifier"!==a.callee.type)return y(a,"SYNTAX","ONLYNODESSUPPORTED");d="";for(h=0;h<a.arguments.length;h++)if(d=e(a.arguments[h],c),""!==d)return d;var t=m(a.callee.name,
a.arguments,c);-1===t&&(d=y(a,"SYNTAX","NOTFOUND"));-2===t&&(d=y(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":d=e(a.argument,c);break;case "BinaryExpression":d=e(a.left,c);if(""!==d)break;d=e(a.right,c);if(""!==d)break;return"";case "LogicalExpression":d=e(a.left,c);if(""!==d)break;if("AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type)return y(a.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");d=e(a.right,c);if(""!==d)break;return"AssignmentExpression"===a.right.type||
"UpdateExpression"===a.right.type?y(a.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):"";case "ConditionalExpression":return y(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":d="";for(h=0;h<a.elements.length&&(d=e(a.elements[h],c),""===d);h++);break;case "ObjectExpression":d="";for(h=0;h<a.properties.length;h++){d="";if(null!==a.properties[h].key&&("Literal"!==a.properties[h].key.type&&"Identifier"!==a.properties[h].key.type&&(d=y(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[h].key.type)){var x=
a.properties[h].key.value;"string"===typeof x||x instanceof String||(d=y(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===d&&(d=e(a.properties[h],c));if(""!==d)break}break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return y(a,"SYNTAX","ONLYLITERAL");if("Identifier"!==a.key.type&&(d=e(a.key,c),""!==d))break;d=e(a.value,c);break;case "Array":return y(a,"SYNTAX","NOTSUPPORTED")}return d}catch(M){throw M;}}function l(a,b){var c=!1;try{switch(a.type){case "VariableDeclarator":return null!==
a.init?l(a.init,b):c;case "FunctionDeclaration":return l(a.body,b);case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)if(l(a.declarations[e],b))return!0;return c;case "IfStatement":return l(a.test,b)||null!==a.consequent&&l(a.consequent,b)||null!==a.alternate&&l(a.alternate,b)?!0:c;case "EmptyStatement":return c;case "BlockStatement":for(e=0;e<a.body.length;e++)if(l(a.body[e],b))return!0;return c;case "ReturnStatement":return null!==a.argument?l(a.argument,b):c;case "UpdateExpression":return l(a.argument,
b);case "AssignmentExpression":return(c=l(a.right,b))?c:l(a.left,b);case "ExpressionStatement":return l(a.expression,b);case "ForInStatement":return(c=l(a.left,b))||(c=l(a.right,b))?c:c=l(a.body,b);case "ForStatement":if(null!==a.init&&(c=l(a.init,b))||null!==a.test&&(c=l(a.test,b))||null!==a.body&&(c=l(a.body,b)))return c;null!==a.update&&(c=l(a.update,b));return c;case "BreakStatement":return c;case "ContinueStatement":return c;case "Compound":return c;case "Identifier":return b.toLowerCase()===
a.name.toLowerCase();case "MemberExpression":if(c=l(a.object,b))return c;!0===a.computed&&(c=l(a.property,b));return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":for(e=0;e<a.arguments.length;e++)l(a.arguments[e],b)&&(c=!0);return c;case "ArrayExpression":for(e=0;e<a.elements.length;e++)l(a.elements[e],b)&&(c=!0);return c;case "UnaryExpression":return l(a.argument,b);case "BinaryExpression":return(c=l(a.left,b))?c:c=l(a.right,b);case "LogicalExpression":return(c=l(a.left,
b))?c:c=l(a.right,b);case "ObjectExpression":for(e=0;e<a.properties.length;e++)l(a.properties[e],b)&&(c=!0);return c;case "Property":return c=l(a.value,b);case "ConditionalExpression":return c;case "Array":return c;default:return c}}catch(v){throw v;}}function g(a,b){var c=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?g(a.init,b):c;case "FunctionDeclaration":return g(a.body,b);case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)if(g(a.declarations[e],b))return!0;
return c;case "IfStatement":return g(a.test,b)||null!==a.consequent&&g(a.consequent,b)||null!==a.alternate&&g(a.alternate,b)?!0:c;case "EmptyStatement":return c;case "BlockStatement":for(e=0;e<a.body.length;e++)if(g(a.body[e],b))return!0;return c;case "ReturnStatement":return null!==a.argument?g(a.argument,b):c;case "UpdateExpression":return g(a.argument,b);case "AssignmentExpression":return g(a.left,b)?!0:g(a.right,b);case "ExpressionStatement":return g(a.expression,b);case "ForInStatement":return(c=
g(a.left,b))||(c=g(a.right,b))?c:c=g(a.body,b);case "ForStatement":if(null!==a.init&&(c=g(a.init,b))||null!==a.test&&(c=g(a.test,b))||null!==a.body&&(c=g(a.body,b)))return c;null!==a.update&&(c=g(a.update,b));return c;case "BreakStatement":return c;case "ContinueStatement":return c;case "Compound":return c;case "Identifier":return c;case "MemberExpression":if(c=g(a.object,b))return c;!0===a.computed&&(c=g(a.property,b));return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":if(a.callee.name.toLowerCase()===
b.toLowerCase())return!0;for(e=0;e<a.arguments.length;e++)g(a.arguments[e],b)&&(c=!0);return c;case "ArrayExpression":for(e=0;e<a.elements.length;e++)g(a.elements[e],b)&&(c=!0);return c;case "UnaryExpression":return g(a.argument,b);case "BinaryExpression":return(c=g(a.left,b))?c:c=g(a.right,b);case "LogicalExpression":return(c=g(a.left,b))?c:c=g(a.right,b);case "ConditionalExpression":return c;case "ObjectExpression":for(e=0;e<a.properties.length;e++)g(a.properties[e],b)&&(c=!0);return c;case "Property":return c=
g(a.value,b);case "Array":return c;default:return c}}catch(v){throw v;}}function c(a,b){var d=[],e;try{switch(a.type){case "VariableDeclarator":return null!==a.init?c(a.init,b):d;case "FunctionDeclaration":return c(a.body,b);case "VariableDeclaration":for(var f=0;f<a.declarations.length;f++)e=c(a.declarations[f],b),d=d.concat(e);return d;case "ForInStatement":return e=c(a.left,b),d=d.concat(e),e=c(a.right,b),d=d.concat(e),e=c(a.body,b),d=d.concat(e);case "ForStatement":return null!==a.init&&(e=c(a.init,
b),d=d.concat(e)),null!==a.test&&(e=c(a.test,b),d=d.concat(e)),null!==a.body&&(e=c(a.body,b),d=d.concat(e)),null!==a.update&&(e=c(a.update,b),d=d.concat(e)),d;case "IfStatement":return e=c(a.test,b),d=d.concat(e),null!==a.consequent&&(e=c(a.consequent,b),d=d.concat(e)),null!==a.alternate&&(e=c(a.alternate,b),d=d.concat(e)),d;case "EmptyStatement":return d;case "BlockStatement":for(f=0;f<a.body.length;f++)e=c(a.body[f],b),d=d.concat(e);return d;case "ReturnStatement":return null!==a.argument?c(a.argument,
b):d;case "UpdateExpression":return c(a.argument,b);case "AssignmentExpression":return d=c(a.left,b),d=d.concat(c(a.right,b));case "ExpressionStatement":return c(a.expression,b);case "BreakStatement":return d;case "ContinueStatement":return d;case "Compound":return d;case "Identifier":return d;case "MemberExpression":if("Identifier"!==a.object.type)return d;if(!1===a.computed)d.push(a.object.name.toLowerCase()+"."+a.property.name.toLowerCase());else try{"Literal"===a.property.type&&"string"===typeof a.property.value&&
d.push(a.object.name.toLowerCase()+"."+a.property.value.toString().toLowerCase())}catch(A){}return d;case "Literal":return d;case "ThisExpression":return d;case "CallExpression":for(f=0;f<a.arguments.length;f++)e=c(a.arguments[f],b),d=d.concat(e);return d;case "ArrayExpression":for(f=0;f<a.elements.length;f++)e=c(a.elements[f],b),d=d.concat(e);return d;case "UnaryExpression":return c(a.argument,b);case "ObjectExpression":for(f=0;f<a.properties.length;f++)e=c(a.properties[f],b),d=d.concat(e);return d;
case "Property":return c(a.value,b);case "BinaryExpression":return e=c(a.left,b),d=d.concat(e),e=c(a.right,b),d=d.concat(e);case "LogicalExpression":return e=c(a.left,b),d=d.concat(e),e=c(a.right,b),d=d.concat(e);case "ConditionalExpression":return d;case "Array":return d;default:return d}}catch(A){throw A;}}function b(a,b,c){c=[];if(void 0!==b.params&&null!==b.params)for(var d=0;d<b.params.length;d++)c.push("any");return{name:a,"return":"any",params:c}}unction x(a,b,c,e){var d={};if(void 0===a||null===a)a={};if(void 0===c||null===c)c={};d.infinity={type:"any"};d.textformatting={type:"any"};d.pi={type:"any"};for(var f in b)if("simple"!==e||"simple"===e&&"a"===b[f].av)d[f]={type:"FormulaFunction",signature:b[f]};for(b=0;b<c.length;b++)f=c[b],d[f.name]={type:"FormulaFunction",signature:f};for(f in a)d[f]=a[f],d[f].type="any";
return d}function y(a,b,c){var d="";switch(b){case "SYNTAX":d="Syntax Error: ";break;case "RUNTIME":d="Runtime Error: ";break;default:d="Syntax Error: "}try{switch(a.type){case "IfStatement":switch(c){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(c){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";
break;case "ASSIGNMENTTOVARSONLY":d+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":d+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(c){case "GLOBALFUNCTIONSONLY":d+=" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":d+=" Function Definition must have an identifier"}break;case "VariableDeclaration":d+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(c){case "FUNCTIONVARIABLEDECLARATOR":d+=
" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":d+=" Variable Definition must have an identifier"}break;case "Identifier":d+=" Identifier Not Found. ";d+=a.name;break;case "ObjectExpression":switch(c){case "OBJECTPROPERTYMUSTBESTRING":d+=" Property name must be a string"}break;case "ForStatement":switch(c){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(c){case "ONLY1VAR":d+=" Can only declare 1 var for use with IN";
break;case "CANNOTDECLAREVAL":d+=" Can only declare value for use with IN";break;case "LEFTNOVAR":d+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":d+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":d+="This type cannot be used in an IN loop"}break;case "MemberExpression":switch(c){case "PROPERTYNOTFOUND":d+="Cannot find member property. ";d+=!1===a.computed?a.property.name:"";break;case "OUTOFBOUNDS":d+="Out of Bounds. ";d+=!1===a.computed?
a.property.name:"";break;case "NOTFOUND":d+="Cannot call member method on null. ";d+=!1===a.computed?a.property.name:"";break;case "INVALIDTYPE":d+="Cannot call member property on object of this type. ",d+=!1===a.computed?a.property.name:""}break;case "Property":switch(c){case "ONLYLITERAL":d+="Property names must be literals or identifiers"}break;case "Literal":break;case "ThisExpression":d+="THIS construct is not supported.";case "CallExpression":switch(c){case "WRONGSIGNATURE":d+="Function signature does not match: ";
d+=a.callee.name;break;case "ONLYNODESUPPORTED":d+="Functions must be declared.";d+=a.callee.name;break;case "NOTAFUNCTION":d+="Not a Function: ";d+=a.callee.name;break;case "NOTFOUND":d+="Function Not Found: "+a.callee.name}break;case "UnaryExpression":switch(c){case "NOTSUPPORTEDUNARYOPERATOR":d+="Operator "+a.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":d+="Unary operator "+a.operator+" cannot be used with this argument."}case "BinaryExpression":switch(c){case "OPERATORNOTRECOGNISED":d+=
"Binary Operator not recognised "+a.operator}break;case "LogicalExpression":switch(c){case "ONLYBOOLEAN":d+="Operator "+a.operator+" cannot be used. Only || or \x26\x26 are allowed values";break;case "ONLYORORAND":d+="Logical Expression "+a.operator+" being applied to parameters that are not boolean."}return"";case "ConditionalExpression":d+="Conditional statements not supported.";break;case "ArrayExpression":switch(c){case "FUNCTIONCONTEXTILLEGAL":d+=" Cannot Put Function inside Array."}break;case "Array":d+=
"Expression contains unrecognised array structure.";break;default:d+="Expression contains unrecognised code structures."}}catch(v){throw v;}return d}unction u(a,b,c,e,f){void 0===f&&(f=!0);b={globalScope:b.globalScope,localScope:{}};for(f=0;f<a.params.length;f++)b.localScope[a.params[f].name.toLowerCase()]={type:"any"};r(a.body,b,c,e,!1)}function r(a,c,d,e,f){void 0===f&&(f=!0);if(null===a)throw Error("Unnexpexted Expression Syntax");
y(a,"SYNTAX","UNREOGNISED");var g=null;try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type){e.push(t(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"));break}"Identifier"!==a.id.type?e.push(t(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(null!==c.localScope?void 0!==c.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==c.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase(),null===c.localScope?c.globalScope[a.id.name.toLowerCase()]={type:"any"}:
c.localScope[a.id.name.toLowerCase()]={type:"any"});null===a.init?"":r(a.init,c,d,e,f);break;case "FunctionDeclaration":!1===f&&e.push(t(a,"SYNTAX","GLOBALFUNCTIONSONLY"));"Identifier"!==a.id.type&&e.push(t(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"));g=b("",a,c);u(a,c,d,e,f);null!==c.localScope&&e.push(t(a,"SYNTAX","GLOBALFUNCTIONSONLY"));g.isnative=!1;"Identifier"===a.id.type&&(c.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[g]});break;case "VariableDeclaration":for(var k=
0;k<a.declarations.length;k++)r(a.declarations[k],c,d,e,f);break;case "IfStatement":null!==a.test&&(r(a.test,c,d,e,f),"AssignmentExpression"!==a.test.type&&"UpdateExpression"!==a.test.type||e.push(t(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));null!==a.consequent&&r(a.consequent,c,d,e,f);null!==a.alternate&&r(a.alternate,c,d,e,f);break;case "EmptyStatement":break;case "BlockStatement":if(null!==a.body)for(k=0;k<a.body.length;k++)r(a.body[k],c,d,e,f);break;case "ReturnStatement":null!==
a.argument&&r(a.argument,c,d,e,f);break;case "ForInStatement":"VariableDeclaration"===a.left.type?(1<a.left.declarations.length&&e.push(t(a,"SYNTAX","ONLY1VAR")),null!==a.left.declarations[0].init&&e.push(t(a,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==a.left.type&&e.push(t(a,"SYNTAX","LEFTNOTVAR"));r(a.left,c,d,e,f);r(a.right,c,d,e,f);r(a.body,c,d,e,f);break;case "ForStatement":null!==a.init&&r(a.init,c,d,e,f);null!==a.test&&r(a.test,c,d,e,f);null!==a.body&&r(a.body,c,d,e,f);null!==a.update&&r(a.update,
c,d,e,f);break;case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?e.push(t(a,"SYNTAX","ASSIGNMENTTOVARSONLY")):("Identifier"===a.argument.type&&(g=!1,!1===d&&(null!==c.localScope&&void 0!==c.localScope[a.argument.name.toLowerCase()]&&(g=!0),void 0!==c.globalScope[a.argument.name.toLowerCase()]&&(g=!0),!1===g&&e.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+
a.argument.name+" has not been declared."}))),"MemberExpression"===a.argument.type&&r(a.argument,c,d,e,f));break;case "AssignmentExpression":"Identifier"!==a.left.type&&"MemberExpression"!==a.left.type&&e.push(t(a,"SYNTAX","ASSIGNMENTTOVARSONLY"));switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:e.push(t(a,"SYNTAX","OPERATORNOTRECOGNISED"))}r(a.right,c,d,e,f);g=!1;"Identifier"===a.left.type&&(null!==c.localScope&&void 0!==c.localScope[a.left.name.toLowerCase()]&&
(g=!0),void 0!==c.globalScope[a.left.name.toLowerCase()]&&(g=!0),!1===d&&!1===g&&e.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."}));"MemberExpression"===a.left.type&&r(a.left,c,d,e,f);break;case "ExpressionStatement":r(a.expression,c,d,e,f);break;case "Identifier":var h=a.name.toLowerCase();if(null!==c.localScope&&void 0!==c.localScope[h])break;void 0===c.globalScope[h]&&!1===d&&e.push(t(a,"SYNTAX","VARIABLENOTFOUND"));
break;case "MemberExpression":r(a.object,c,d,e,f);!0===a.computed&&r(a.property,c,d,e,f);break;case "Literal":return"";case "ThisExpression":e.push(t(a,"SYNTAX","NOTSUPPORTED"));break;case "CallExpression":"Identifier"!==a.callee.type&&e.push(t(a,"SYNTAX","ONLYNODESSUPPORTED"));for(k=0;k<a.arguments.length;k++)r(a.arguments[k],c,d,e,f);var l=m(a.callee.name,a.arguments,c);!1===d&&-1===l&&e.push(t(a,"SYNTAX","NOTFOUND"));-2===l&&e.push(t(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":r(a.argument,
c,d,e,f);break;case "BinaryExpression":r(a.left,c,d,e,f);r(a.right,c,d,e,f);switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:e.push(t(a,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(a.operator){case "\x26\x26":case "||":break;default:e.push(t(a,"SYNTAX","OPERATORNOTRECOGNISED"))}r(a.left,c,d,e,f);"AssignmentExpression"!==a.left.type&&"UpdateExpression"!==a.left.type||
e.push(t(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));r(a.right,c,d,e,f);"AssignmentExpression"!==a.right.type&&"UpdateExpression"!==a.right.type||e.push(t(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));break;case "ConditionalExpression":e.push(t(a,"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(k=0;k<a.elements.length;k++)r(a.elements[k],c,d,e,f);break;case "Array":e.push(t(a,"SYNTAX","NOTSUPPORTED"));case "ObjectExpression":for(k=0;k<a.properties.length;k++)r(a.properties[k],
c,d,e,f);break;case "Property":"Literal"!==a.key.type&&"Identifier"!==a.key.type&&e.push(t(a,"SYNTAX","ONLYLITERAL"));"Literal"===a.key.type&&r(a.key,c,d,e,f);r(a.value,c,d,e,f);break;default:e.push(t(a,"SYNTAX","UNRECOGNISED"))}}catch(C){e.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Unnexpected Syntax"})}}h.functionDecls={concatenate:{min:"0",max:"*",av:"a"},split:{min:"2",max:"4",av:"a"},guid:{min:"0",max:"1",av:"a"},today:{min:"0",max:"0",av:"a"},now:{min:"0",
max:"0",av:"a"},timestamp:{min:"0",max:"0",av:"a"},day:{min:"1",max:"1",av:"a"},month:{min:"1",max:"1",av:"a"},year:{min:"1",max:"1",av:"a"},hour:{min:"1",max:"1",av:"a"},second:{min:"1",max:"1",av:"a"},millisecond:{min:"1",max:"1",av:"a"},minute:{min:"1",max:"1",av:"a"},weekday:{min:"1",max:"1",av:"a"},toutc:{min:"1",max:"1",av:"a"},tolocal:{min:"1",max:"1",av:"a"},date:{min:"0",max:"7",av:"a"},datediff:{min:"2",max:"3",av:"a"},dateadd:{min:"2",max:"3",av:"a"},trim:{min:"1",max:"1",av:"a"},text:{min:"1",
max:"2",av:"a"},left:{min:"2",max:"2",av:"a"},right:{min:"2",max:"2",av:"a"},mid:{min:"2",max:"3",av:"a"},upper:{min:"1",max:"1",av:"a"},proper:{min:"1",max:"2",av:"a"},lower:{min:"1",max:"1",av:"a"},find:{min:"2",max:"3",av:"a"},iif:{min:"3",max:"3",av:"a"},decode:{min:"2",max:"*",av:"a"},when:{min:"2",max:"*",av:"a"},defaultvalue:{min:"2",max:"2",av:"a"},isempty:{min:"1",max:"1",av:"a"},maplayer:{min:"2",max:"3",av:"f"},domaincode:{min:"3",max:"4",av:"a"},domainname:{min:"2",max:"4",av:"a"},polygon:{min:"1",
max:"1",av:"a"},point:{min:"1",max:"1",av:"a"},polyline:{min:"1",max:"1",av:"a"},extent:{min:"1",max:"1",av:"a"},multipoint:{min:"1",max:"1",av:"a"},geometry:{min:"1",max:"1",av:"a"},featurelayer:{min:"1",max:"3",av:"f"},featurecollection:{min:"1",max:"1",av:"f"},buffer:{min:"2",max:"4",av:"f"},area:{min:"1",max:"2",av:"f"},sumarea:{min:"1",max:"2",av:"f"},length:{min:"1",max:"2",av:"f"},sumlength:{min:"1",max:"2",av:"f"},count:{min:"0",max:"*",av:"a"},filter:{min:"2",max:"2",av:"f"},envelopeintersects:{min:"2",
max:"2",av:"f"},intersects:{min:"2",max:"2",av:"f"},contains:{min:"2",max:"2",av:"f"},overlaps:{min:"2",max:"2",av:"f"},within:{min:"2",max:"2",av:"f"},touches:{min:"2",max:"2",av:"f"},crosses:{min:"2",max:"2",av:"f"},union:{min:"1",max:"2",av:"f",fmin:1},difference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},intersection:{min:"2",max:"2",av:"f",fmin:2,fmax:3},symmetricdifference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},number:{min:"1",max:"2",av:"a"},acos:{min:"1",max:"1",av:"a"},asin:{min:"1",max:"1",
av:"a"},atan:{min:"1",max:"1",av:"a"},atan2:{min:"2",max:"2",av:"a"},ceil:{min:"1",max:"2",av:"a"},floor:{min:"1",max:"2",av:"a"},round:{min:"1",max:"2",av:"a"},cos:{min:"1",max:"1",av:"a"},exp:{min:"1",max:"1",av:"a"},log:{min:"1",max:"1",av:"a"},min:{min:"0",max:"*",av:"a"},console:{min:"0",max:"*",av:"a"},max:{min:"0",max:"*",av:"a"},pow:{min:"2",max:"2",av:"a"},random:{min:"0",max:"0",av:"a"},sqrt:{min:"1",max:"1",av:"a"},sin:{min:"1",max:"1",av:"a"},tan:{min:"1",max:"1",av:"a"},abs:{min:"1",
max:"1",av:"a"},isnan:{min:"1",max:"1",av:"a"},stdev:{min:"0",max:"*",av:"a"},average:{min:"0",max:"*",av:"a"},mean:{min:"0",max:"*",av:"a"},sum:{min:"0",max:"*",av:"a"},variance:{min:"0",max:"*",av:"a"},distinct:{min:"0",max:"*",av:"a"},addfield:{min:"3",max:"3",av:"f"},removefield:{min:"2",max:"2",av:"f"},aggregate:{min:"3",max:"3",av:"f"},dissolve:{min:"2",max:"3",av:"f"},changeshape:{min:"2",max:"4",av:"f"},first:{min:"1",max:"1",av:"a"},top:{min:"2",max:"2",av:"a"},orderby:{min:"2",max:"2",av:"f"},
"boolean":{min:"1",max:"1",av:"a"},dictionary:{min:"0",max:"*",av:"a"},servicearea:{min:"2",max:"*",av:"f"},equals:{min:"2",max:"2",av:"a"},"typeof":{min:"1",max:"1",av:"a"},reverse:{min:"1",max:"1",av:"a"},replace:{min:"3",max:"4",av:"a"},sort:{min:"1",max:"2",av:"a"},feature:{min:"1",max:"*",av:"a"},haskey:{min:"2",max:"2",av:"a"},indexof:{min:"2",max:"2",av:"a"},centroid:{min:"1",max:"1",av:"f"},multiparttosinglepart:{min:"1",max:"1",av:"f"}};h.checkFunctionSignature=p;h.findFunction=m;h.validateLanguageNode=
f;h.testValidityOfExpression=e;h.referencesMemberImpl=l;h.referencesMember=function(a,b){return!0===l(a.body[0].body,b.toLowerCase())?!0:!1};h.referencesFunctionImpl=g;h.referencesFunction=function(a,b){return!0===g(a.body[0].body,b)?!0:!1};h.findFieldLiteralsImpl=c;h.findFieldLiterals=function(a,b){return c(a.body[0].body,b)};h.extractFunctionDeclaration=b;h.validateFunction=q;h.constructGlobalScope=x;h.validateScript=function(a,b,c){void 0===c&&(c="full");b={globalScope:x(b.vars,h.functionDecls,
b.customFunctions,c),localScope:null};return e(a.body[0].body,b)};h.validateLanguage=h.nodeErrorMessage=y;h.makeError=t;h.extractAllIssuesInFunction=u;h.extractAllIssues=r;h.checkScript=function(a,b,c,e){void 0===e&&(e="full");var d=[];if("BlockStatement"!==a.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];if(null===b||void 0===b)b={vars:{},customFunctions:[]};b={globalScope:x(b.vars,
h.functionDecls,b.customFunctions,e),localScope:null};try{r(a.body[0].body,b,c,d)}catch(A){}return d}})},"esri/arcade/Dictionary":function(){define(["require","exports","./languageUtils","../geometry/Geometry","./ImmutableArray"],function(a,h,p,m,f){return function(){function a(e){this.attributes=null;this.plain=!1;this.immutable=!0;this.attributes=e instanceof a?e.attributes:void 0===e?{}:null===e?{}:e}a.prototype.field=a.prototype.setField=a.prototype.hasField=a.prototype.keys=a.prototype.castToText=function(){var a="",e;for(e in this.attributes){""!==a&&(a+=",");var c=this.attributes[e];null==c?c="null":p.isBoolean(c)||p.isNumber(c)||p.isString(c)?a+=JSON.stringify(e)+":"+JSON.stringify(c):c instanceof m?a+=JSON.stringify(e)+":"+p.toStringExplicit(c):c instanceof f?a+=JSON.stringify(e)+":"+p.toStringExplicit(c):c instanceof Array?a+=JSON.stringify(e)+":"+p.toStringExplicit(c):
c instanceof Date?a+=JSON.stringify(e)+":"+JSON.stringify(c):null!==c&&"object"===typeof c&&void 0!==c.castToText&&(a+=JSON.stringify(e)+":"+c.castToText())}return"{"+a+"}"};return a}()})},"esri/arcade/Feature":function(){define("require exports dojo/_base/lang ../geometry/Geometry ../Graphic ../geometry/support/jsonUtils ./Dictionary ./languageUtils ./ImmutableArray ../geometry/Point".split(" "),function(a,h,p,m,f,e,l,g,c,b){return function(){function a(b,c,g){this._layer=this.attributes=this.geometry=
null;this.immutable=this._datesfixed=!0;b instanceof a?(this.attributes=b.attributes,this.geometry=b.geometry,b._layer&&(this._layer=b._layer)):b instanceof f?(this.geometry=b.geometry,this.attributes=void 0===b.attributes?{}:null===b.attributes?{}:b.attributes,b._layer?(this._layer=b._layer,this._datesfixed=!1):b.layer&&(this._layer=b.layer,this._datesfixed=!1)):b instanceof l?(this.attributes=b.field("attributes"),null!==this.attributes&&(this.attributes=this.attributes instanceof l?this.attributes.attributes:
null),this.geometry=b.field("geometry"),null!==this.geometry&&(this.geometry instanceof l?this.geometry=a.parseGeometryFromDictionary(this.geometry):this.geometry instanceof m||(this.geometry=null))):(c instanceof m||null===c?(this.geometry=c,this.attributes=void 0===b?{}:null===b?{}:b):"string"===typeof b?(b=JSON.parse(b),null!==b.geometry&&void 0!==b.geometry&&(this.geometry=e.fromJSON(b.geometry)),this.attributes=void 0===b.attributes?{}:null===b.attributes?{}:b.attributes):(void 0===b?this.attributes=
{}:null===b&&(this.attributes={}),this.geometry=null),void 0!==g&&(this._layer=g))}a.prototype.castToText=function(){var a="",b;for(b in this.attributes){""!==a&&(a+=",");var e=this.attributes[b];null==e?e="null":g.isBoolean(e)||g.isNumber(e)||g.isString(e)?a+=JSON.stringify(b)+":"+JSON.stringify(e):e instanceof m?a+=JSON.stringify(b)+":"+g.toStringExplicit(e):e instanceof c?a+=JSON.stringify(b)+":"+g.toStringExplicit(e):e instanceof Array?a+=JSON.stringify(b)+":"+g.toStringExplicit(e):e instanceof
Date?a+=JSON.stringify(b)+":"+JSON.stringify(e):null!==e&&"object"===typeof e&&void 0!==e.castToText&&(a+=JSON.stringify(b)+":"+e.castToText())}return'{"geometry":'+(null===this.geometry?"null":g.toStringExplicit(this.geometry))+',"attributes":{'+a+"}}"};a.prototype._fixDates=function(){for(var a=[],b=0;b<this._layer.fields.length;b++){var c=this._layer.fields[b];"date"!==c.type&&"esriFieldTypeDate"!==c.type||a.push(c.name)}0<a.length&&this._fixDateFields(a);this._datesfixed=!0};a.prototype._fixDateFields=
function(a){this.attributes=p.mixin({},this.attributes);for(var b=0;b<a.length;b++){var c=this.attributes[a[b]];if(null!==c)if(void 0===c)for(var e in this.attributes){if(e.toLowerCase()===a[b]){c=this.attributes[e];null===c||c instanceof Date||(this.attributes[e]=new Date(c));break}}else c instanceof Date||(this.attributes[a[b]]=new Date(c))}};a.prototype.field=function(a){!1===this._datesfixed&&this._fixDates();var b=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var c in this.attributes)if(c.toLowerCase()===
b)return this.attributes[c];if(this._hasFieldDefinition(b))return null;throw Error("Field not Found");};a.prototype._hasFieldDefinition=a.prototype._field=function(a){!1===this._datesfixed&&this._fixDates();var b=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var c in this.attributes)if(c.toLowerCase()===b)return this.attributes[c];
return null};a.prototype.setField=function(a,b){if(this.immutable)throw Error("Feature is Immutable");if(!1===g.isSimpleType(b))throw Error("Illegal Value Assignment to Feature");var c=a.toLowerCase();if(void 0===this.attributes[a])for(var e in this.attributes)if(e.toLowerCase()===c){this.attributes[e]=b;return}this.attributes[a]=b};a.prototype.hasField=a.prototype.keys=a.fromFeature=a.parseGeometryFromDictionary=function(b){b=a.convertDictionaryToJson(b,!0);void 0!==b.spatialreference&&(b.spatialReference=b.spatialreference,delete b.spatialreference);void 0!==b.rings&&(b.rings=
this.fixPathArrays(b.rings,!0===b.hasZ,!0===b.hasM));void 0!==b.paths&&(b.paths=this.fixPathArrays(b.paths,!0===b.hasZ,!0===b.hasM));void 0!==b.points&&(b.points=this.fixPointArrays(b.points,!0===b.hasZ,!0===b.hasM));return e.fromJSON(b)};a.fixPathArrays=a.fixPointArrays=function(a,e,f){var g=
[];if(a instanceof Array)for(var h=0;h<a.length;h++){var l=a[h];l instanceof b?e&&f?g.push([l.x,l.y,l.z,l.m]):e?g.push([l.x,l.y,l.z]):f?g.push([l.x,l.y,l.m]):g.push([l.x,l.y]):g.push(l)}else if(a instanceof c)for(h=0;h<a.length();h++)l=a.get(h),l instanceof b?e&&f?g.push([l.x,l.y,l.z,l.m]):e?g.push([l.x,l.y,l.z]):f?g.push([l.x,l.y,l.m]):g.push([l.x,l.y]):g.push(l);return g};a.convertDictionaryToJson=a.parseAttributesFromDictionary=a.fromJson=function(b){var c=null;null!==b.geometry&&void 0!==b.geometry&&(c=e.fromJSON(b.geometry));var f={};if(null!==b.attributes&&void 0!==b.attributes)for(var h in b.attributes){var l=b.attributes[h];if(g.isString(l)||g.isNumber(l)||g.isBoolean(l)||
g.isDate(l))f[h]=l;else throw Error("Illegal Argument");}return new a(f,c)};a.prototype.domainValueLookup=a.prototype.domainCodeLookup=function(a,b,c){if(null===this._layer||!this._layer.fields)return null;a=g.getDomain(a,this._layer,this,c);return g.getDomainCode(a,b)};return a}()})},"esri/arcade/functions/date":function(){define(["require",
"exports","../../moment","../languageUtils"],function(a,h,p,m){.registerFunctions=function(a,h){a.today=a.now=a.timestamp=a.toutc=a.tolocal=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,1,1);a=m.toDate(e[0]);return null===a?null:p.utc([a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),
a.getSeconds(),a.getMilliseconds()]).toDate()})};a.day=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,1,1);a=m.toDate(e[0]);return null===a?NaN:a.getDate()})};a.month=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,1,1);a=m.toDate(e[0]);return null===a?NaN:a.getMonth()})};a.year=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,1,1);a=m.toDate(e[0]);return null===a?NaN:a.getFullYear()})};a.hour=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,1,1);a=m.toDate(e[0]);return null===
a?NaN:a.getHours()})};a.second=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,1,1);a=m.toDate(e[0]);return null===a?NaN:a.getSeconds()})};a.millisecond=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,1,1);a=m.toDate(e[0]);return null===a?NaN:a.getMilliseconds()})};a.minute=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,1,1);a=m.toDate(e[0]);return null===a?NaN:a.getMinutes()})};a.weekday=a.date=function(a,c){return h(a,c,function(a,c,e){m.pcCheck(e,0,7);if(3===e.length)return f(new Date(m.toNumber(e[0]),m.toNumber(e[1]),m.toNumber(e[2]),0,0,0,0));if(4===e.length)return f(new Date(m.toNumber(e[0]),m.toNumber(e[1]),m.toNumber(e[2]),m.toNumber(e[3]),0,0,0));if(5===e.length)return f(new Date(m.toNumber(e[0]),m.toNumber(e[1]),m.toNumber(e[2]),m.toNumber(e[3]),m.toNumber(e[4]),0,0));if(6===e.length)return f(new Date(m.toNumber(e[0]),m.toNumber(e[1]),m.toNumber(e[2]),
m.toNumber(e[3]),m.toNumber(e[4]),m.toNumber(e[5]),0));if(7===e.length)return f(new Date(m.toNumber(e[0]),m.toNumber(e[1]),m.toNumber(e[2]),m.toNumber(e[3]),m.toNumber(e[4]),m.toNumber(e[5]),m.toNumber(e[6])));if(2===e.length){a=m.toString(e[1]);if(""===a)return null;a=m.standardiseDateFormat(a);e=p(m.toString(e[0]),a,!0);return!0===e.isValid()?e.toDate():null}if(1===e.length){if(m.isString(e[0])&&""===e[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;a=m.toNumber(e[0]);return!1===
isNaN(a)?f(new Date(a)):m.toDate(e[0])}if(0===e.length)return new Date})};a.datediff=a.dateadd=})},"esri/arcade/functions/string":function(){define(["require","exports","../languageUtils","../Feature"],function(a,h,p,m){h.registerFunctions=function(a,e){a.trim=function(a,f){return e(a,f,function(a,
b,e){p.pcCheck(e,1,1);return p.toString(e[0]).trim()})};a.upper=function(a,f){return e(a,f,function(a,b,e){p.pcCheck(e,1,1);return p.toString(e[0]).toUpperCase()})};a.proper=
a.lower=a.guid=a.console=a.mid=a.find=a.left=a.right=a.split=a.text=a.concatenate=a.reverse=a.replace=a.domainname=function(a,f){return e(a,f,function(a,b,e){p.pcCheck(e,2,4);if(e[0]instanceof m)return e[0].domainValueLookup(p.toString(e[1]),e[2],void 0===e[3]?void 0:
p.toNumber(e[3]));throw Error("Invalid Parameter");})};a.domaincode=})},"esri/arcade/functions/maths":function(){define(["require","exports","../languageUtils","dojo/number"],function(a,h,p,m){.registerFunctions=function(a,h){a.number=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,2);a=e[0];return p.isNumber(a)?a:null===a?0:p.isDate(a)||p.isBoolean(a)||""===a||void 0===a?Number(a):p.isString(a)?void 0!==e[1]?(e=p.multiReplace(e[1],"\u2030",""),e=p.multiReplace(e,"\u00a4",""),m.parse(a,{pattern:e})):Number(a.trim()):Number(a)})};
a.abs=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.abs(p.toNumber(e[0]))})};a.acos=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.acos(p.toNumber(e[0]))})};a.asin=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.asin(p.toNumber(e[0]))})};a.atan=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.atan(p.toNumber(e[0]))})};a.atan2=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,2,2);return Math.atan2(p.toNumber(e[0]),
p.toNumber(e[1]))})};a.ceil=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,2);return 2===e.length?(a=p.toNumber(e[1]),isNaN(a)&&(a=0),f("ceil",p.toNumber(e[0]),-1*a)):Math.ceil(p.toNumber(e[0]))})};a.round=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,2);return 2===e.length?(a=p.toNumber(e[1]),isNaN(a)&&(a=0),f("round",p.toNumber(e[0]),-1*a)):Math.round(p.toNumber(e[0]))})};a.floor=a.cos=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.cos(p.toNumber(e[0]))})};a.isnan=a.exp=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.exp(p.toNumber(e[0]))})};a.log=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.log(p.toNumber(e[0]))})};
a.pow=a.random=a.sin=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.sin(p.toNumber(e[0]))})};a.sqrt=function(a,c){return h(a,c,function(a,c,e){p.pcCheck(e,1,1);return Math.sqrt(p.toNumber(e[0]))})};a.tan=
a.defaultvalue=a.isempty=a["boolean"]=})},"esri/arcade/functions/geometry":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/support/jsonUtils ../languageUtils ../Dictionary ../Feature".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x){h.registerFunctions=function(a,h){a.polygon=function(a,e){return h(a,e,function(e,f,d){b.pcCheck(d,1,1);e=null;if(d[0]instanceof q){if(e=b.fixSpatialReference(x.parseGeometryFromDictionary(d[0]),a.spatialReference),!1===e instanceof m)throw Error("Illegal Parameter");}else e=d[0]instanceof m?c.fromJSON(d[0].toJSON()):b.fixSpatialReference(new m(JSON.parse(d[0])),a.spatialReference);if(null!==e&&!1===e.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return e})};a.polyline=function(a,e){return h(a,e,function(e,g,d){b.pcCheck(d,1,1);e=null;if(d[0]instanceof q){if(e=b.fixSpatialReference(x.parseGeometryFromDictionary(d[0]),a.spatialReference),!1===e instanceof f)throw Error("Illegal Parameter");}else e=d[0]instanceof f?c.fromJSON(d[0].toJSON()):b.fixSpatialReference(new f(JSON.parse(d[0])),a.spatialReference);if(null!==e&&!1===e.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return e})};a.point=function(a,f){return h(a,f,function(f,g,d){b.pcCheck(d,1,1);f=null;if(d[0]instanceof q){if(f=b.fixSpatialReference(x.parseGeometryFromDictionary(d[0]),a.spatialReference),!1===f instanceof e)throw Error("Illegal Parameter");}else f=d[0]instanceof e?c.fromJSON(d[0].toJSON()):b.fixSpatialReference(new e(JSON.parse(d[0])),a.spatialReference);if(null!==f&&!1===f.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return f})};a.multipoint=function(a,e){return h(a,e,function(e,f,d){b.pcCheck(d,1,1);e=null;if(d[0]instanceof q){if(e=b.fixSpatialReference(x.parseGeometryFromDictionary(d[0]),a.spatialReference),!1===e instanceof g)throw Error("Illegal Parameter");}else e=d[0]instanceof g?c.fromJSON(d[0].toJSON()):b.fixSpatialReference(new g(JSON.parse(d[0])),a.spatialReference);if(null!==e&&!1===e.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return e})};a.extent=function(a,p){return h(a,p,function(h,p,d){b.pcCheck(d,1,1);h=null;d[0]instanceof q?h=b.fixSpatialReference(x.parseGeometryFromDictionary(d[0]),a.spatialReference):d[0]instanceof e?(h={xmin:d[0].x,ymin:d[0].y,xmax:d[0].x,ymax:d[0].y,spatialReference:d[0].spatialReference.toJSON()},d[0].hasZ?(h.zmin=d[0].z,h.zmax=d[0].z):d[0].hasM&&(h.mmin=d[0].m,h.mmax=d[0].m),h=c.fromJSON(h)):h=d[0]instanceof m?c.fromJSON(d[0].extent.toJSON()):d[0]instanceof f?c.fromJSON(d[0].extent.toJSON()):
d[0]instanceof g?c.fromJSON(d[0].extent.toJSON()):d[0]instanceof l?c.fromJSON(d[0].toJSON()):b.fixSpatialReference(new l(JSON.parse(d[0])),a.spatialReference);if(null!==h&&!1===h.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return h})};a.geometry=function(a,e){return h(a,e,function(e,f,d){b.pcCheck(d,1,1);e=null;e=d[0]instanceof x?b.fixSpatialReference(d[0].geometry,a.spatialReference):d[0]instanceof
q?b.fixSpatialReference(x.parseGeometryFromDictionary(d[0]),a.spatialReference):b.fixSpatialReference(c.fromJSON(JSON.parse(d[0])),a.spatialReference);if(null!==e&&!1===e.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return e})};a.feature=function(a,c){return h(a,c,function(c,e,d){if(0===d.length)throw Error("Missing Parameters");c=null;if(1===d.length)if(b.isString(d[0]))c=x.fromJson(JSON.parse(d[0]));
else if(d[0]instanceof x)c=new x(d[0]);else if(d[0]instanceof p)c=new x(null,d[0]);else if(d[0]instanceof q)c=d[0].hasField("geometry")?d[0].field("geometry"):null,e=d[0].hasField("attributes")?d[0].field("attributes"):null,null!==c&&c instanceof q&&(c=x.parseGeometryFromDictionary(c)),null!==e&&(e=x.parseAttributesFromDictionary(e)),c=new x(e,c);else throw Error("Illegal Argument");else{if(2===d.length){e=c=null;if(null!==d[0])if(d[0]instanceof p)c=d[0];else if(c instanceof q)c=x.parseGeometryFromDictionary(d[0]);
else throw Error("Illegal Argument");if(null!==d[1])if(d[1]instanceof q)e=x.parseAttributesFromDictionary(d[1]);else throw Error("Illegal Argument");}else{c=null;e={};if(null!==d[0])if(d[0]instanceof p)c=d[0];else if(c instanceof q)c=x.parseGeometryFromDictionary(d[0]);else throw Error("Illegal Argument");for(var f=1;f<d.length;f+=2){var g=b.toString(d[f]),h=d[f+1];if(null===h||void 0===h||b.isString(h)||isNaN(h)||b.isDate(h)||b.isNumber(h)||b.isBoolean(h)){if(b.isFunctionParameter(h)||!1===b.isSimpleType(h))throw Error("Illegal Argument");
e[g]=h===b.voidOperation?null:h}else throw Error("Illegal Argument");}}c=new x(e,c)}c.geometry=b.fixSpatialReference(c.geometry,a.spatialReference);c.immutable=!1;return c})};a.dictionary=function(a,c){return h(a,c,function(a,c,d){if(0===d.length)throw Error("Missing Parameters");if(0!==d.length%2)throw Error("Missing Parameters");a={};for(c=0;c<d.length;c+=2){var e=b.toString(d[c]),f=d[c+1];if(null===f||void 0===f||b.isString(f)||isNaN(f)||b.isDate(f)||b.isNumber(f)||b.isBoolean(f)){if(b.isFunctionParameter(f))throw Error("Illegal Argument");
a[e]=f===b.voidOperation?null:f}else throw Error("Illegal Argument");}d=new q(a);d.immutable=!1;return d})};a.haskey=a.indexof=})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(a,h,p,m){.registerFunctions=)},"esri/arcade/functions/fieldStats":function(){define(["require","exports","../languageUtils"],function(a,h,p){decodeStatType=h.calculateStat=)},"esri/arcade/parser":function(){define(["require","exports","./treeAnalysis","./lib/esprima"],function(a,h,p,m){h.parseScript=function(a){a=m.parse("function _() { "+a+"\n}");if(null===a.body||void 0===a.body)throw Error("No formula provided.");if(0===a.body.length)throw Error("No formula provided.");if(0===a.body.length)throw Error("No formula provided.");
if("BlockStatement"!==a.body[0].body.type)throw Error("Invalid formula content.");var e=p.validateLanguage(a);if(""!==e)throw Error(e);return a};h.scriptCheck=function(a,e,h,g){var c=[];try{var b=m.parse("function _() { "+a+"\n}",{tolerant:!0,loc:!0}),f=b.errors;if(0<f.length)for(var l=0;l<f.length;l++)c.push({line:f[l].lineNumber,character:f[l].column,reason:f[l].description});var y=p.checkScript(b,e,h,g);for(e=0;e<y.length;e++)c.push(y[e])}catch(t){try{"Unexpected token }"===t.description&&(t.index=
("function _() { "+a+"\n}").length-1)?c.push({line:t.lineNumber,character:t.column,reason:"Unexpected end of script"}):c.push({line:t.lineNumber,character:t.column,reason:t.description})}catch(u){}}return c};h.extractFieldLiterals=h.validateScript=h.referencesMember=function(a,e){return p.referencesMember(a,e)};h.referencesFunction=)},"esri/arcade/lib/esprima":function(){((this,function(a){nction m(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}nction l(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=
a||92===a||128<=a&&Pa.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function g(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||48<=a&&57>=a||92===a||128<=a&&Pa.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function c(a){a=a.toLowerCase();switch(a.length){case 2:return"if"===a||"in"===a;case 3:return"var"===a||"for"===a;case 4:return"else"===a;case 5:return"break"===a;case 6:return"return"===a;case 8:return"function"===a.toLowerCase()||"continue"===a;default:return!1}}function b(a,
b,c,d,e){h("number"===typeof c,"Comment must have valid position");ia.lastCommentStart>=c||(ia.lastCommentStart=c,a={type:a,value:b},Y.range&&(a.range=[c,d]),Y.loc&&(a.loc=e),Y.comments.push(a),Y.attachComment&&(Y.leadingComments.push(a),Y.trailingComments.push(a)))}function q(a){var c,d,f;c=G-a;for(d={start:{line:ka,column:G-oa-a}};G<Ba;)if(f=ca.charCodeAt(G),++G,e(f)){Y.comments&&(a=ca.slice(c+a,G-1),d.end={line:ka,column:G-oa-1},b("Line",a,c,G-1,d));13===f&&10===ca.charCodeAt(G)&&++G;++ka;oa=G;
return}Y.comments&&(a=ca.slice(c+a,G),d.end={line:ka,column:G-oa},b("Line",a,c,G,d))}function x(){var a,c;for(c=0===G;G<Ba;)if(a=ca.charCodeAt(G),32===a||9===a||11===a||12===a||160===a||5760<=a&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a))++G;else if(e(a))++G,13===a&&10===ca.charCodeAt(G)&&++G,++ka,oa=G,c=!0;else if(47===a)if(a=ca.charCodeAt(G+1),47===a)++G,++G,q(2),c=!0;else if(42===a){++G;++G;a:{var d=a=void 0,f=void 0,f=void 0;Y.comments&&
(a=G-2,d={start:{line:ka,column:G-oa-2}});for(;G<Ba;)if(f=ca.charCodeAt(G),e(f))13===f&&10===ca.charCodeAt(G+1)&&++G,++ka,++G,oa=G,G>=Ba&&J();else{if(42===f&&47===ca.charCodeAt(G+1)){++G;++G;Y.comments&&(f=ca.slice(a+2,G-2),d.end={line:ka,column:G-oa},b("Block",f,a,G,d));break a}++G}J()}}else break;else if(c&&45===a)if(45===ca.charCodeAt(G+1)&&62===ca.charCodeAt(G+2))G+=3,q(3);else break;else if(60===a)if("!--"===ca.slice(G+1,G+4))++G,++G,++G,++G,q(4);else break;else break}function y(a){var b,c,d=
0;b="u"===a?4:2;for(a=0;a<b;++a)if(G<Ba&&m(ca[G]))c=ca[G++],d=16*d+"0123456789abcdef".indexOf(c.toLowerCase());else return"";return String.fromCharCode(d)}function t(){var a,b;a=ca.charCodeAt(G++);b=String.fromCharCode(a);92===a&&(117!==ca.charCodeAt(G)&&J(),++G,(a=y("u"))&&"\\"!==a&&l(a.charCodeAt(0))||J(),b=a);for(;G<Ba;){a=ca.charCodeAt(G);if(!g(a))break;++G;b+=String.fromCharCode(a);92===a&&(b=b.substr(0,b.length-1),117!==ca.charCodeAt(G)&&J(),++G,(a=y("u"))&&"\\"!==a&&g(a.charCodeAt(0))||J(),
b+=a)}return b}function u(){var a=G,b=ca.charCodeAt(G),c,d=ca[G];switch(b){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++G,Y.tokenize&&(40===b?Y.openParenToken=Y.tokens.length:123===b&&(Y.openCurlyToken=Y.tokens.length)),{type:da.Punctuator,value:String.fromCharCode(b),lineNumber:ka,lineStart:oa,start:a,end:G};default:if(c=ca.charCodeAt(G+1),61===c)switch(b){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return G+=
2,{type:da.Punctuator,value:String.fromCharCode(b)+String.fromCharCode(c),lineNumber:ka,lineStart:oa,start:a,end:G};case 33:case 61:return G+=2,61===ca.charCodeAt(G)&&++G,{type:da.Punctuator,value:ca.slice(a,G),lineNumber:ka,lineStart:oa,start:a,end:G}}}b=ca.substr(G,4);if("\x3e\x3e\x3e\x3d"===b)return G+=4,{type:da.Punctuator,value:b,lineNumber:ka,lineStart:oa,start:a,end:G};b=b.substr(0,3);if("\x3e\x3e\x3e"===b||"\x3c\x3c\x3d"===b||"\x3e\x3e\x3d"===b)return G+=3,{type:da.Punctuator,value:b,lineNumber:ka,
lineStart:oa,start:a,end:G};b=b.substr(0,2);if(d===b[1]&&0<="+-\x3c\x3e\x26|".indexOf(d)||"\x3d\x3e"===b)return G+=2,{type:da.Punctuator,value:b,lineNumber:ka,lineStart:oa,start:a,end:G};if(0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(d))return++G,{type:da.Punctuator,value:d,lineNumber:ka,lineStart:oa,start:a,end:G};J()}function r(){var a,b,c;c=ca[G];h(p(c.charCodeAt(0))||"."===c,"Numeric literal must start with a decimal digit or a decimal point");b=G;a="";if("."!==c){a=ca[G++];c=ca[G];if("0"===a){if("x"===
c||"X"===c){++G;for(a="";G<Ba&&m(ca[G]);)a+=ca[G++];0===a.length&&J();l(ca.charCodeAt(G))&&J();return{type:da.NumericLiteral,value:parseInt("0x"+a,16),lineNumber:ka,lineStart:oa,start:b,end:G}}if("b"===c||"B"===c){++G;for(c="";G<Ba;){a=ca[G];if("0"!==a&&"1"!==a)break;c+=ca[G++]}0===c.length&&J();G<Ba&&(a=ca.charCodeAt(G),(l(a)||p(a))&&J());return{type:da.NumericLiteral,value:parseInt(c,2),lineNumber:ka,lineStart:oa,start:b,end:G}}if("o"===c||"O"===c||f(c)){f(c)?(c=!0,a="0"+ca[G++]):(c=!1,++G,a="");
for(;G<Ba&&f(ca[G]);)a+=ca[G++];c||0!==a.length||J();(l(ca.charCodeAt(G))||p(ca.charCodeAt(G)))&&J();return{type:da.NumericLiteral,value:parseInt(a,8),octal:c,lineNumber:ka,lineStart:oa,start:b,end:G}}c&&p(c.charCodeAt(0))&&J()}for(;p(ca.charCodeAt(G));)a+=ca[G++];c=ca[G]}if("."===c){for(a+=ca[G++];p(ca.charCodeAt(G));)a+=ca[G++];c=ca[G]}if("e"===c||"E"===c){a+=ca[G++];c=ca[G];if("+"===c||"-"===c)a+=ca[G++];if(p(ca.charCodeAt(G)))for(;p(ca.charCodeAt(G));)a+=ca[G++];else J()}l(ca.charCodeAt(G))&&
J();return{type:da.NumericLiteral,value:parseFloat(a),lineNumber:ka,lineStart:oa,start:b,end:G}}function n(){ha=null;x();V("Regular Expression language structures not supported")}unction d(){var a;a=Y.tokens[Y.tokens.length-1];if(!a)return w();if("Punctuator"===a.type){if("]"===a.value)return u();if(")"===a.value)return a=Y.tokens[Y.openParenToken-1],!a||"Keyword"!==a.type||"if"!==a.value.toLowerCase()&&"while"!==a.value.toLowerCase()&&"for"!==a.value.toLowerCase()&&"with"!==
a.value.toLowerCase()?u():w();if("}"===a.value){if(Y.tokens[Y.openCurlyToken-3]&&"Keyword"===Y.tokens[Y.openCurlyToken-3].type){if(a=Y.tokens[Y.openCurlyToken-4],!a)return u()}else if(Y.tokens[Y.openCurlyToken-4]&&"Keyword"===Y.tokens[Y.openCurlyToken-4].type){if(a=Y.tokens[Y.openCurlyToken-5],!a)return w()}else return u();if(0<=za.indexOf(a.value))return u()}return w()}return"Keyword"===a.type&&"this"!==a.value?w():u()}function k(){var a;x();if(G>=Ba)return{type:da.EOF,lineNumber:ka,lineStart:oa,
start:G,end:G};a=ca.charCodeAt(G);if(l(a)){var b;a=G;if(92===ca.charCodeAt(G))b=t();else a:{var k;for(b=G++;G<Ba;){k=ca.charCodeAt(G);if(92===k){G=b;b=t();break a}if(g(k))++G;else break}b=ca.slice(b,G)}return{type:1===b.length?da.Identifier:c(b)?da.Keyword:"null"===b.toLowerCase()?da.NullLiteral:"true"===b.toLowerCase()||"false"===b.toLowerCase()?da.BooleanLiteral:da.Identifier,value:b,lineNumber:ka,lineStart:oa,start:a,end:G}}if(40===a||41===a||59===a)return u();if(39===a||34===a){var n="",q,v,w;
k=!1;var z,A;z=ka;A=oa;a=ca[G];h("'"===a||'"'===a,"String literal must starts with a quote");b=G;for(++G;G<Ba;)if(q=ca[G++],q===a){a="";break}else if("\\"===q)if((q=ca[G++])&&e(q.charCodeAt(0)))++ka,"\r"===q&&"\n"===ca[G]&&++G,oa=G;else switch(q){case "u":case "x":if("{"===ca[G]){++G;v=q=void 0;q=ca[G];v=0;for("}"===q&&J();G<Ba;){q=ca[G++];if(!m(q))break;v=16*v+"0123456789abcdef".indexOf(q.toLowerCase())}(1114111<v||"}"!==q)&&J();q=65535>=v?String.fromCharCode(v):String.fromCharCode((v-65536>>10)+
55296,(v-65536&1023)+56320);n+=q}else w=G,(v=y(q))?n+=v:(G=w,n+=q);break;case "n":n+="\n";break;case "r":n+="\r";break;case "t":n+="\t";break;case "b":n+="\b";break;case "f":n+="\f";break;case "v":n+="\x0B";break;default:f(q)?(v="01234567".indexOf(q),0!==v&&(k=!0),G<Ba&&f(ca[G])&&(k=!0,v=8*v+"01234567".indexOf(ca[G++]),0<="0123".indexOf(q)&&G<Ba&&f(ca[G])&&(v=8*v+"01234567".indexOf(ca[G++]))),n+=String.fromCharCode(v)):n+=q}else if(e(q.charCodeAt(0)))break;else n+=q;""!==a&&J();return{type:da.StringLiteral,
value:n,octal:k,startLineNumber:z,startLineStart:A,lineNumber:ka,lineStart:oa,start:b,end:G}}return 46===a?p(ca.charCodeAt(G+1))?r():u():p(a)?r():Y.tokenize&&47===a?d():u()}function v(){var a,b,c;x();a={start:{line:ka,column:G-oa}};b=k();a.end={line:ka,column:G-oa};b.type!==da.EOF&&(c=ca.slice(b.start,b.end),a={type:Ja[b.type],value:c,range:[b.start,b.end],loc:a},b.regex&&(a.regex={pattern:b.regex.pattern,flags:b.regex.flags}),Y.tokens.push(a));return b}function A(){var a;a=ha;G=a.end;ka=a.lineNumber;
oa=a.lineStart;ha="undefined"!==typeof Y.tokens?v():k();G=a.end;ka=a.lineNumber;oa=a.lineStart;return a}function z(){var a,b,c;a=G;b=ka;c=oa;ha="undefined"!==typeof Y.tokens?v():k();G=a;ka=b;oa=c}nction C(a){this.start=a.type===da.StringLiteral?{line:a.startLineNumber,column:a.start-a.startLineStart}:{line:a.lineNumber,column:a.start-a.lineStart};this.end=null}function F(){G=ha.start;ha.type===da.StringLiteral?
(ka=ha.startLineNumber,oa=ha.startLineStart):(ka=ha.lineNumber,oa=ha.lineStart);Y.range&&(this.range=[G,0]);Y.loc&&(this.loc=new B)}unction M(){var a,b,c,d;a=G;b=ka;c=oa;x();d=ka!==b;G=a;ka=b;oa=c;return d}function E(a,b,c){var d=Error("Line "+a+": "+c);d.index=b;d.lineNumber=a;d.column=b-oa+1;d.description=c;return d}function V(a){var b,c;b=Array.prototype.slice.call(arguments,1);c=a.replace(/%(\d)/g,function(a,c){h(c<b.length,
"Message reference must be in range");return b[c]});throw E(ka,G,c);}function P(a){var b,c;b=Array.prototype.slice.call(arguments,1);c=a.replace(/%(\d)/g,function(a,c){h(c<b.length,"Message reference must be in range");return b[c]});c=E(ka,G,c);if(Y.errors)Y.errors.push(c);else throw c;}function I(a,b){var c=ra.UnexpectedToken;a&&(c=b?b:a.type===da.EOF?ra.UnexpectedEOS:a.type===da.Identifier?ra.UnexpectedIdentifier:a.type===da.NumericLiteral?ra.UnexpectedNumber:a.type===da.StringLiteral?ra.UnexpectedString:
ra.UnexpectedToken);c=c.replace("%0",a?a.value:"ILLEGAL");return a&&"number"===typeof a.lineNumber?E(a.lineNumber,a.start,c):E(ka,G,c)}unction Q(a,b){a=I(a,b);if(Y.errors)Y.errors.push(a);else throw a;}nction L(a){var b=A();b.type===da.Keyword&&
b.value.toLowerCase()===a.toLowerCase()||J(b)}tion Z(a,b){var c,d=new F;b=ya;c=W();ya=b;return d.finishFunctionExpression(null,a,[],c)}function H(){var a,b;a=ya;ya=!0;b=Ra();
b=Z(b.params);ya=a;return b}function O(){var a,b=new F;a=A();return a.type===da.StringLiteral||a.type===da.NumericLiteral?(ya&&a.octal&&Q(a,ra.StrictOctalLiteral),b.finishLiteral(a)):b.finishIdentifier(a.value)}function aa(){var a,b,c,d=new F;a=ha;if(a.type===da.Identifier)return b=O(),"get"!==a.value||R(":")||R("(")?"set"!==a.value||R(":")||R("(")?R(":")?(A(),a=qa(),d.finishProperty("init",b,a,!1,!1)):R("(")?(a=H(),d.finishProperty("init",b,a,!0,!1)):d.finishProperty("init",b,b,!1,!0):(b=O(),S("("),
a=ha,a.type!==da.Identifier?(S(")"),Q(a),a=Z([])):(c=[va()],S(")"),a=Z(c,a)),d.finishProperty("set",b,a,!1,!1)):(b=O(),S("("),S(")"),a=Z([]),d.finishProperty("get",b,a,!1,!1));if(a.type===da.EOF||a.type===da.Punctuator)J(a);else{b=O();if(R(":"))return A(),a=qa(),d.finishProperty("init",b,a,!1,!1);if(R("("))return a=H(),d.finishProperty("init",b,a,!0,!1);J(A())}}function ba(a){var b=[],c,d,e={},f=String,g=new F;for(!0!==a&&S("{");!R("}");)a=aa(),c=a.key.type===ja.Identifier?a.key.name:f(a.key.value),
d="init"===a.kind?xa.Data:"get"===a.kind?xa.Get:xa.Set,c="$"+c,Object.prototype.hasOwnProperty.call(e,c)?(e[c]===xa.Data?ya&&d===xa.Data?P(ra.StrictDuplicateProperty):d!==xa.Data&&P(ra.AccessorDataProperty):d===xa.Data?P(ra.AccessorDataProperty):e[c]&d&&P(ra.AccessorGetSet),e[c]|=d):e[c]=d,b.push(a),R("}")||ga();S("}");return g.finishObjectExpression(b)}function X(){var a,b,c,d;if(R("("))return S("("),R(")")?(A(),b=Qa.ArrowParameterPlaceHolder):(++ia.parenthesisCount,b=ua(),S(")")),b;if(R("[")){b=
[];var e=new F;for(S("[");!R("]");)R(",")?(A(),b.push(null)):(b.push(qa()),R("]")||S(","));A();return e.finishArrayExpression(b)}if(R("{"))return ba();a=ha.type;d=new F;if(a===da.Identifier)c=d.finishIdentifier(A().value);else if(a===da.StringLiteral||a===da.NumericLiteral)ya&&ha.octal&&Q(ha,ra.StrictOctalLiteral),c=d.finishLiteral(A());else if(a===da.Keyword){if(U("function")){d=null;var f;c=[];var g=[],k,h=new F;L("function");R("(")||(d=va());f=Ra(b);c=f.params;g=f.defaults;a=f.stricted;b=f.firstRestricted;
f.message&&(e=f.message);k=ya;f=W();ya&&b&&J(b,e);ya&&a&&Q(a,e);ya=k;return h.finishFunctionExpression(d,c,g,f)}U("this")?(A(),c=d.finishThisExpression()):J(A())}else a===da.BooleanLiteral?(b=A(),b.value="true"===b.value.toLowerCase(),c=d.finishLiteral(b)):a===da.NullLiteral?(b=A(),b.value=null,c=d.finishLiteral(b)):R("/")||R("/\x3d")?(c="undefined"!==typeof Y.tokens?d.finishLiteral(w()):d.finishLiteral(n()),z()):J(A());return c}function ea(){var a=[];S("(");if(!R(")"))for(;G<Ba;){a.push(qa());if(R(")"))break;
ga()}S(")");return a}function la(){S(".");var a,b=new F;a=A();a.type===da.Identifier||a.type===da.Keyword||a.type===da.BooleanLiteral||a.type===da.NullLiteral||J(a);return b.finishIdentifier(a.value)}function ta(){var a;S("[");a=ua();S("]");return a}function ma(){var a,b,c=new F;L("new");var d;h(ia.allowIn,"callee of new expression always allow in keyword.");d=ha;for(a=U("new")?ma():X();;)if(R("["))b=ta(),a=(new K(d)).finishMemberExpression("[",a,b);else if(R("."))b=la(),a=(new K(d)).finishMemberExpression(".",
a,b);else break;b=R("(")?ea():[];return c.finishNewExpression(a,b)}function wa(){var a,b,c=ha,d,e=ia.allowIn;b=ha;ia.allowIn=!0;for(a=U("new")?ma():X();;)if(R("."))d=la(),a=(new K(b)).finishMemberExpression(".",a,d);else if(R("("))d=ea(),a=(new K(b)).finishCallExpression(a,d);else if(R("["))d=ta(),a=(new K(b)).finishMemberExpression("[",a,d);else break;ia.allowIn=e;ha.type!==da.Punctuator||!R("++")&&!R("--")||M()||(N(a)||P(ra.InvalidLHSInAssignment),b=A(),a=(new K(c)).finishPostfixExpression(b.value,
a));return a}function na(){var a,b,c;ha.type!==da.Punctuator&&ha.type!==da.Keyword?b=wa():R("++")||R("--")?(c=ha,a=A(),b=na(),N(b)||P(ra.InvalidLHSInAssignment),b=(new K(c)).finishUnaryExpression(a.value,b)):R("+")||R("-")||R("~")||R("!")?(c=ha,a=A(),b=na(),b=(new K(c)).finishUnaryExpression(a.value,b)):U("delete")||U("void")||U("typeof")?(c=ha,a=A(),b=na(),b=(new K(c)).finishUnaryExpression(a.value,b),ya&&"delete"===b.operator&&b.argument.type===ja.Identifier&&P(ra.StrictDelete)):b=wa();return b}
unction Ea(){var a,b,c,d,e,f;a=ha;b=na();if(b===Qa.ArrowParameterPlaceHolder)return b;c=ha;d=sa(c,ia.allowIn);if(0===d)return b;c.prec=d;A();a=[a,ha];f=na();for(e=[b,c,f];0<(d=sa(ha,ia.allowIn));){for(;2<e.length&&d<=e[e.length-2].prec;)f=e.pop(),c=e.pop().value,b=e.pop(),a.pop(),b=(new K(a[a.length-1])).finishBinaryExpression(c,b,f),e.push(b);c=A();c.prec=d;e.push(c);a.push(ha);b=na();e.push(b)}d=e.length-1;b=e[d];for(a.pop();1<d;)b=(new K(a.pop())).finishBinaryExpression(e[d-1].value,
e[d-2],b),d-=2;return b}function pa(a){var b,c,d,e,f,g,k;e=[];f=[];g=0;k={paramSet:{}};b=0;for(c=a.length;b<c;b+=1)if(d=a[b],d.type===ja.Identifier)e.push(d),f.push(null),Ka(k,d,d.name);else if(d.type===ja.AssignmentExpression)e.push(d.left),f.push(d.right),++g,Ka(k,d.left,d.left.name);else return null;k.message===ra.StrictParamDupe&&(a=ya?k.stricted:k.firstRestricted,J(a,k.message));0===g&&(f=[]);return{params:e,defaults:f,rest:null,stricted:k.stricted,firstRestricted:k.firstRestricted,message:k.message}}
function qa(){var a,b,c,d,e;a=ia.parenthesisCount;b=e=ha;var f,g;g=ha;c=Ea();c!==Qa.ArrowParameterPlaceHolder&&R("?")&&(A(),f=ia.allowIn,ia.allowIn=!0,b=qa(),ia.allowIn=f,S(":"),f=qa(),c=(new K(g)).finishConditionalExpression(c,b,f));if(c===Qa.ArrowParameterPlaceHolder||R("\x3d\x3e"))if(ia.parenthesisCount===a||ia.parenthesisCount===a+1)if(c.type===ja.Identifier?d=pa([c]):c.type===ja.AssignmentExpression?d=pa([c]):c.type===ja.SequenceExpression?d=pa(c.expressions):c===Qa.ArrowParameterPlaceHolder&&
(d=pa([])),d)return a=d,e=new K(e),S("\x3d\x3e"),d=ya,c=R("{")?W():qa(),ya&&a.firstRestricted&&J(a.firstRestricted,a.message),ya&&a.stricted&&Q(a.stricted,a.message),ya=d,e.finishArrowFunctionExpression(a.params,a.defaults,c,c.type!==ja.BlockStatement);ha.type!==da.Punctuator?a=!1:(a=ha.value,a="\x3d"===a||"*\x3d"===a||"/\x3d"===a||"%\x3d"===a||"+\x3d"===a||"-\x3d"===a||"\x3c\x3c\x3d"===a||"\x3e\x3e\x3d"===a||"\x3e\x3e\x3e\x3d"===a||"\x26\x3d"===a||"^\x3d"===a||"|\x3d"===a);a&&(N(c)||P(ra.InvalidLHSInAssignment),
b=A(),a=qa(),c=(new K(e)).finishAssignmentExpression(b.value,c,a));return c}function ua(){var a,b=ha;a=qa();if(R(",")){for(a=[a];G<Ba&&R(",");)A(),a.push(qa());a=(new K(b)).finishSequenceExpression(a)}return a}function va(){var a,b=new F;a=A();a.type!==da.Identifier&&J(a);return b.finishIdentifier(a.value)}function Ca(a){var b=null,c,d=new F;c=va();"const"===a?(S("\x3d"),b=qa()):R("\x3d")&&(A(),b=qa());return d.finishVariableDeclarator(c,b)}function Fa(a){var b=[];do{b.push(Ca(a));if(!R(","))break;
A()}while(G<Ba);return b}function Aa(a){var b=ha.type,c,d;b===da.EOF&&J(ha);if(b===da.Punctuator&&"{"===ha.value){if(a){S("{");var e=ha;a=G;c=ka;d=oa;A();b=R(":");ha=e;G=a;ka=c;oa=d;if((ha.type===da.Identifier||ha.type===da.StringLiteral)&&b)return ba(!0);a=new F;for(c=[];G<Ba&&!R("}");){d=La();if("undefined"===typeof d)break;c.push(d)}S("}");return a.finishBlockStatement(c)}return ba()}a=new F;if(b===da.Punctuator)switch(ha.value){case ";":return a=new F,S(";"),a.finishEmptyStatement();case "(":return c=
ua(),T(),a.finishExpressionStatement(c)}else if(b===da.Keyword)switch(ha.value.toLowerCase()){case "break":return c=null,L("break"),59===ca.charCodeAt(G)?(A(),ia.inIteration||ia.inSwitch||V(ra.IllegalBreak),a=a.finishBreakStatement(null)):M()?(ia.inIteration||ia.inSwitch||V(ra.IllegalBreak),a=a.finishBreakStatement(null)):(ha.type===da.Identifier&&(c=va(),d="$"+c.name,Object.prototype.hasOwnProperty.call(ia.labelSet,d)||V(ra.UnknownLabel,c.name)),T(),null!==c||ia.inIteration||ia.inSwitch||V(ra.IllegalBreak),
a=a.finishBreakStatement(c)),a;case "continue":return c=null,L("continue"),59===ca.charCodeAt(G)?(A(),ia.inIteration||V(ra.IllegalContinue),a=a.finishContinueStatement(null)):M()?(ia.inIteration||V(ra.IllegalContinue),a=a.finishContinueStatement(null)):(ha.type===da.Identifier&&(c=va(),d="$"+c.name,Object.prototype.hasOwnProperty.call(ia.labelSet,d)||V(ra.UnknownLabel,c.name)),T(),null!==c||ia.inIteration||V(ra.IllegalContinue),a=a.finishContinueStatement(c)),a;case "for":var f,g,k;g=ia.allowIn;f=
b=e=null;L("for");S("(");if(R(";"))A();else{if(U("var")){ia.allowIn=!1;var h=new F;f=A();k=Fa();f=h.finishVariableDeclaration(k,f.value);ia.allowIn=g;1===f.declarations.length&&U("in")&&(A(),c=f,d=ua(),f=null)}else ia.allowIn=!1,f=ua(),ia.allowIn=g,U("in")&&(N(f)||P(ra.InvalidLHSInForIn),A(),c=f,d=ua(),f=null);"undefined"===typeof c&&S(";")}"undefined"===typeof c&&(R(";")||(b=ua()),S(";"),R(")")||(e=ua()));S(")");k=ia.inIteration;ia.inIteration=!0;g=Aa(!0);ia.inIteration=k;return"undefined"===typeof c?
a.finishForStatement(f,b,e,g):a.finishForInStatement(c,d,g);case "function":return Ua(a);case "if":return L("if"),S("("),c=ua(),S(")"),d=Aa(!0),U("else")?(A(),b=Aa(!0)):b=null,a.finishIfStatement(c,d,b);case "return":return c=null,L("return"),ia.inFunctionBody||P(ra.IllegalReturn),32===ca.charCodeAt(G)&&l(ca.charCodeAt(G+1))?(c=ua(),T(),a=a.finishReturnStatement(c)):M()?a=a.finishReturnStatement(null):(R(";")||R("}")||ha.type===da.EOF||(c=ua()),T(),a=a.finishReturnStatement(c)),a;case "var":return L("var"),
c=Fa(),T(),a.finishVariableDeclaration(c,"var")}c=ua();if(c.type===ja.Identifier&&R(":"))return A(),b="$"+c.name,Object.prototype.hasOwnProperty.call(ia.labelSet,b)&&V(ra.Redeclaration,"Label",c.name),ia.labelSet[b]=!0,d=Aa(!1),delete ia.labelSet[b],a.finishLabeledStatement(c,d);T();return a.finishExpressionStatement(c)}function W(){var a,b=[],c,d,e,f,g,k=new F;for(S("{");G<Ba&&ha.type===da.StringLiteral;){c=ha;a=La();b.push(a);if(a.expression.type!==ja.Literal)break;a=ca.slice(c.start+1,c.end-1);
"use strict"===a?(ya=!0,d&&Q(d,ra.StrictOctalLiteral)):!d&&c.octal&&(d=c)}c=ia.labelSet;d=ia.inIteration;e=ia.inSwitch;f=ia.inFunctionBody;g=ia.parenthesizedCount;ia.labelSet={};ia.inIteration=!1;ia.inSwitch=!1;ia.inFunctionBody=!0;for(ia.parenthesizedCount=0;G<Ba&&!R("}");){a=La();if("undefined"===typeof a)break;b.push(a)}S("}");ia.labelSet=c;ia.inIteration=d;ia.inSwitch=e;ia.inFunctionBody=f;ia.parenthesizedCount=g;return k.finishBlockStatement(b)}function Ka(a,b,c){c="$"+c;ya?Object.prototype.hasOwnProperty.call(a.paramSet,
c)&&(a.stricted=b,a.message=ra.StrictParamDupe):!a.firstRestricted&&Object.prototype.hasOwnProperty.call(a.paramSet,c)&&(a.firstRestricted=b,a.message=ra.StrictParamDupe);a.paramSet[c]=!0}function Ra(a){a={params:[],defaultCount:0,defaults:[],firstRestricted:a};S("(");if(!R(")"))for(a.paramSet={};G<Ba;){var b=a,c=void 0,d=void 0,e=void 0,c=ha,d=va();Ka(b,c,c.value);R("\x3d")&&(A(),e=qa(),++b.defaultCount);b.params.push(d);b.defaults.push(e);if(R(")"))break;S(",")}S(")");0===a.defaultCount&&(a.defaults=
[]);return{params:a.params,defaults:a.defaults,stricted:a.stricted,firstRestricted:a.firstRestricted,message:a.message}}function Ua(){var a,b=[],c=[],d,e,f,g,k,h=new F;L("function");a=va();d=Ra(f);b=d.params;c=d.defaults;e=d.stricted;f=d.firstRestricted;d.message&&(g=d.message);k=ya;d=W();ya&&f&&J(f,g);ya&&e&&Q(e,g);ya=k;return h.finishFunctionDeclaration(a,b,c,d)}function La(){if(ha.type===da.Keyword)return"function"===ha.value.toLowerCase()?Ua():Aa(!1);if(ha.type!==da.EOF)return Aa(!1)}function Sa(){var a,
b,c,d=[];for(a=0;a<Y.tokens.length;++a)b=Y.tokens[a],c={type:b.type,value:b.value},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),Y.range&&(c.range=b.range),Y.loc&&(c.loc=b.loc),d.push(c);Y.tokens=d}var da,Ja,za,ja,Qa,xa,ra,Pa,ca,ya,G,ka,oa,Ba,ha,ia,Y;da={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};Ja={};Ja[da.BooleanLiteral]="Boolean";Ja[da.EOF]="\x3cend\x3e";Ja[da.Identifier]="Identifier";Ja[da.Keyword]=
"Keyword";Ja[da.NullLiteral]="Null";Ja[da.NumericLiteral]="Numeric";Ja[da.Punctuator]="Punctuator";Ja[da.StringLiteral]="String";Ja[da.RegularExpression]="RegularExpression";za="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");ja={AssignmentExpression:"AssignmentExpression",
ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",
Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Qa={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};xa={Data:1,Get:2,Set:4};ra={UnexpectedToken:"Unexpected token %0",
UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",
NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",
StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",
StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};Pa={NonAsciiIdentifierStart:/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/,
NonAsciiIdentifierPart:/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/};
K.prototype=F.prototype={processComment:function(){var a,b,c,d=Y.bottomRightStack,e,f,g=d[d.length-1];if(!(this.type===ja.Program&&0<this.body.length)){if(0<Y.trailingComments.length){c=[];for(e=Y.trailingComments.length-1;0<=e;--e)f=Y.trailingComments[e],f.range[0]>=this.range[1]&&(c.unshift(f),Y.trailingComments.splice(e,1));Y.trailingComments=[]}else g&&g.trailingComments&&g.trailingComments[0].range[0]>=this.range[1]&&(c=g.trailingComments,delete g.trailingComments);if(g)for(;g&&g.range[0]>=this.range[0];)a=
g,g=d.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<Y.leadingComments.length)for(b=[],e=Y.leadingComments.length-1;0<=e;--e)f=Y.leadingComments[e],f.range[1]<=this.range[0]&&(b.unshift(f),Y.leadingComments.splice(e,1));b&&0<b.length&&(this.leadingComments=b);c&&0<c.length&&(this.trailingComments=c);d.push(this)}},finish:function(){Y.range&&(this.range[1]=G);Y.loc&&(this.loc.end=
new D,Y.source&&(this.loc.source=Y.source));Y.attachComment&&this.processComment()},finishArrayExpression:function(a){this.type=ja.ArrayExpression;this.elements=a;this.finish();return this},finishAssignmentExpression:function(a,b,c){this.type=ja.AssignmentExpression;this.operator=a;this.left=b;this.right=c;this.finish();return this},finishBinaryExpression:function(a,b,c){this.type="||"===a||"\x26\x26"===a?ja.LogicalExpression:ja.BinaryExpression;this.operator=a;this.left=b;this.right=c;this.finish();
return this},finishBlockStatement:function(a){this.type=ja.BlockStatement;this.body=a;this.finish();return this},finishBreakStatement:function(a){this.type=ja.BreakStatement;this.label=a;this.finish();return this},finishCallExpression:function(a,b){this.type=ja.CallExpression;this.callee=a;this.arguments=b;this.finish();return this},finishConditionalExpression:function(a,b,c){this.type=ja.ConditionalExpression;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishContinueStatement:function(a){this.type=
ja.ContinueStatement;this.label=a;this.finish();return this},finishEmptyStatement:function(){this.type=ja.EmptyStatement;this.finish();return this},finishExpressionStatement:function(a){this.type=ja.ExpressionStatement;this.expression=a;this.finish();return this},finishForStatement:function(a,b,c,d){this.type=ja.ForStatement;this.init=a;this.test=b;this.update=c;this.body=d;this.finish();return this},finishForInStatement:function(a,b,c){this.type=ja.ForInStatement;this.left=a;this.right=b;this.body=
c;this.each=!1;this.finish();return this},finishFunctionDeclaration:function(a,b,c,d){this.type=ja.FunctionDeclaration;this.id=a;this.params=b;this.defaults=c;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishFunctionExpression:function(a,b,c,d){this.type=ja.FunctionExpression;this.id=a;this.params=b;this.defaults=c;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishIdentifier:function(a){this.type=ja.Identifier;
this.name=a;this.finish();return this},finishIfStatement:function(a,b,c){this.type=ja.IfStatement;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishLiteral:function(a){this.type=ja.Literal;this.value=a.value;this.raw=ca.slice(a.start,a.end);a.regex&&(this.regex=a.regex);this.finish();return this},finishMemberExpression:function(a,b,c){this.type=ja.MemberExpression;this.computed="["===a;this.object=b;this.property=c;this.finish();return this},finishObjectExpression:function(a){this.type=
ja.ObjectExpression;this.properties=a;this.finish();return this},finishPostfixExpression:function(a,b){this.type=ja.UpdateExpression;this.operator=a;this.argument=b;this.prefix=!1;this.finish();return this},finishProgram:function(a){this.type=ja.Program;this.body=a;this.finish();return this},finishProperty:function(a,b,c,d,e){this.type=ja.Property;this.key=b;this.value=c;this.kind=a;this.method=d;this.shorthand=e;this.finish();return this},finishReturnStatement:function(a){this.type=ja.ReturnStatement;
this.argument=a;this.finish();return this},finishUnaryExpression:function(a,b){this.type="++"===a||"--"===a?ja.UpdateExpression:ja.UnaryExpression;this.operator=a;this.argument=b;this.prefix=!0;this.finish();return this},finishVariableDeclaration:function(a,b){this.type=ja.VariableDeclaration;this.declarations=a;this.kind=b;this.finish();return this},finishVariableDeclarator:function(a,b){this.type=ja.VariableDeclarator;this.id=a;this.init=b;this.finish();return this}};a.version="2.0.0-dev";a.tokenize=
function(a,b){var c,d;c=String;"string"===typeof a||a instanceof String||(a=c(a));ca=a;G=0;ka=0<ca.length?1:0;oa=0;Ba=ca.length;ha=null;ia={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};Y={};b=b||{};b.tokens=!0;Y.tokens=[];Y.tokenize=!0;Y.openParenToken=-1;Y.openCurlyToken=-1;Y.range="boolean"===typeof b.range&&b.range;Y.loc="boolean"===typeof b.loc&&b.loc;"boolean"===typeof b.comment&&b.comment&&(Y.comments=[]);"boolean"===typeof b.tolerant&&b.tolerant&&
(Y.errors=[]);try{z();if(ha.type===da.EOF)return Y.tokens;for(A();ha.type!==da.EOF;)try{A()}catch(Va){if(Y.errors){Y.errors.push(Va);break}else throw Va;}Sa();d=Y.tokens;"undefined"!==typeof Y.comments&&(d.comments=Y.comments);"undefined"!==typeof Y.errors&&(d.errors=Y.errors)}catch(Va){throw Va;}finally{Y={}}return d};a.parse=function(a,b){var c,d;d=String;"string"===typeof a||a instanceof String||(a=d(a));ca=a;G=0;ka=0<ca.length?1:0;oa=0;Ba=ca.length;ha=null;ia={allowIn:!0,labelSet:{},parenthesisCount:0,
inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};Y={};"undefined"!==typeof b&&(Y.range="boolean"===typeof b.range&&b.range,Y.loc="boolean"===typeof b.loc&&b.loc,Y.attachComment="boolean"===typeof b.attachComment&&b.attachComment,Y.loc&&null!==b.source&&void 0!==b.source&&(Y.source=d(b.source)),"boolean"===typeof b.tokens&&b.tokens&&(Y.tokens=[]),"boolean"===typeof b.comment&&b.comment&&(Y.comments=[]),"boolean"===typeof b.tolerant&&b.tolerant&&(Y.errors=[]),Y.attachComment&&(Y.range=
!0,Y.comments=[],Y.bottomRightStack=[],Y.trailingComments=[],Y.leadingComments=[]));try{var e;x();z();e=new F;ya=!1;var f;a=[];for(var g,k,h;G<Ba;){g=ha;if(g.type!==da.StringLiteral)break;f=La();a.push(f);if(f.expression.type!==ja.Literal)break;k=ca.slice(g.start+1,g.end-1);"use strict"===k?(ya=!0,h&&Q(h,ra.StrictOctalLiteral)):!h&&g.octal&&(h=g)}for(;G<Ba;){f=La();if("undefined"===typeof f)break;a.push(f)}c=e.finishProgram(a);"undefined"!==typeof Y.comments&&(c.comments=Y.comments);"undefined"!==
typeof Y.tokens&&(Sa(),c.tokens=Y.tokens);"undefined"!==typeof Y.errors&&(c.errors=Y.errors)}catch(hb){throw hb;}finally{Y={}}return c};a.Syntax=function(){var a,b={};"function"===typeof Object.create&&(b=Object.create(null));for(a in ja)ja.hasOwnProperty(a)&&(b[a]=ja[a]);"function"===typeof Object.freeze&&Object.freeze(b);return b}()})},"esri/arcade/arcadeCompiler":function(){define("require exports ../geometry/Polygon ../Graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../geometry/SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w,d,k,v){unction z(a,b){try{switch(b.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return K(a,b);case "VariableDeclaration":for(var c=[],d=0;d<b.declarations.length;d++)c.push(z(a,b.declarations[d]));return c.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return F(a,b);case "FunctionDeclaration":var d=b.id.name.toLowerCase(),e={applicationCache:void 0===
a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,symbols:a.symbols,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<e.depthCounter)throw Error("Exceeded maximum function depth");for(var f="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; var lscope \x3d [];\n ",g=0;g<b.params.length;g++){var k=b.params[g].name.toLowerCase(),h=Q(k,a);e.localScope._SymbolsMap[k]=
h;f+="lscope['"+h+"']\x3darguments["+g.toString()+"];\n"}f+=F(e,b.body)+"\n return lastStatement; }, runtimeCtx))";f+="\n lastStatement \x3d lc.voidOperation; \n";void 0!==a.globalScope[d]?c="gscope['"+d+"']\x3d"+f:void 0!==a.globalScope._SymbolsMap[d]?c="gscope['"+a.globalScope._SymbolsMap[d]+"']\x3d"+f:(h=Q(d,a),a.globalScope._SymbolsMap[d]=h,c="gscope['"+h+"']\x3d"+f);return c;case "ReturnStatement":var l;l=null===b.argument?"return lc.voidOperation;":"return "+z(a,b.argument)+";";return l;case "IfStatement":if("AssignmentExpression"===
b.test.type||"UpdateExpression"===b.test.type)throw Error(q.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var n=z(a,b.test),m=S(a),p="var "+m+" \x3d "+n+";\n if ("+m+" \x3d\x3d\x3d true) {\n"+C(a,b.consequent)+"\n }\n",p=null!==b.alternate?p+("else if ("+m+"\x3d\x3d\x3dfalse)   { \n"+C(a,b.alternate)+"}\n"):p+("else if ("+m+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n");return p+="else { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";
case "ExpressionStatement":var r;r="AssignmentExpression"===b.expression.type?"lastStatement \x3d lc.voidOperation; "+z(a,b.expression)+" \n ":"lastStatement \x3d "+z(a,b.expression)+";";return r;case "AssignmentExpression":return B(a,b);case "UpdateExpression":return D(a,b);case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":c="lastStatement \x3d lc.voidOperation; \n";null!==b.init&&(c+=z(a,b.init));var t=S(a),u=S(a),c=c+("var "+t+" \x3d true;")+"\n do { ";
null!==b.update&&(c+=" if ("+t+"\x3d\x3d\x3dfalse) {\n "+z(a,b.update)+"  \n}\n "+t+"\x3dfalse; \n");null!==b.test&&(c+="var "+u+" \x3d "+z(a,b.test)+";",c+="if ("+u+"\x3d\x3d\x3dfalse) { break; } else if ("+u+"!\x3d\x3dtrue) { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n");c+=z(a,b.body);null!==b.update&&(c+="\n "+z(a,b.update));return c+("\n"+t+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation;");case "ForInStatement":var v=S(a),y=S(a),
w=S(a),x="var "+v+" \x3d "+z(a,b.right)+";\n";"VariableDeclaration"===b.left.type&&(x+=z(a,b.left));var A="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name,A=A.toLowerCase(),c="";null!==a.localScope&&(void 0!==a.localScope[A]?c="lscope['"+A+"']":void 0!==a.localScope._SymbolsMap[A]&&(c="lscope['"+a.localScope._SymbolsMap[A]+"']"));""===c&&(void 0!==a.globalScope[A]?c="gscope['"+A+"']":void 0!==a.globalScope._SymbolsMap[A]&&(c="gscope['"+a.globalScope._SymbolsMap[A]+"']"));
x=x+("if ("+v+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ")+("else if (lc.isArray("+v+") || lc.isString("+v+")) {")+("var "+y+"\x3d"+v+".length; \n")+("for(var "+w+"\x3d0; "+w+"\x3c"+y+"; "+w+"++) {\n");x+=c+"\x3d"+w+";\n";x+=z(a,b.body);x+="\n}\n";x+=" lastStatement \x3d lc.voidOperation; \n";x+=" \n}\n";x+="else if (lc.isImmutableArray("+v+")) {";x=x+("var "+y+"\x3d"+v+".length(); \n")+("for(var "+w+"\x3d0; "+w+"\x3c"+y+"; "+w+"++) {\n");x+=c+"\x3d"+w+";\n";x+=z(a,b.body);x+=
"\n}\n";x+=" lastStatement \x3d lc.voidOperation; \n";x+=" \n}\n";x+="else if (( "+v+" instanceof lang.Dictionary) || ( "+v+" instanceof lang.Feature)) {";x=x+("var "+y+"\x3d"+v+".keys(); \n")+("for(var "+w+"\x3d0; "+w+"\x3c"+y+".length; "+w+"++) {\n");x+=c+"\x3d"+y+"["+w+"];\n";x+=z(a,b.body);x+="\n}\n";x+=" lastStatement \x3d lc.voidOperation; \n";x+=" \n}\n";return x+"else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return E(a,b);case "MemberExpression":var H;try{c=void 0,c=
!0===b.computed?z(a,b.property):"'"+b.property.name+"'",H="lang.member("+z(a,b.object)+","+c+")"}catch(za){throw za;}return H;case "Literal":return null===b.value||void 0===b.value?"null":JSON.stringify(b.value);case "ThisExpression":throw Error(q.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==b.callee.type)throw Error(q.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));var O=b.callee.name.toLowerCase(),c="";null!==a.localScope&&(void 0!==a.localScope[O]?
c="lscope['"+O+"']":void 0!==a.localScope._SymbolsMap[O]&&(c="lscope['"+a.localScope._SymbolsMap[O]+"']"));""===c&&(void 0!==a.globalScope[O]?c="gscope['"+O+"']":void 0!==a.globalScope._SymbolsMap[O]&&(c="gscope['"+a.globalScope._SymbolsMap[O]+"']"));if(""!==c)for(d="[",e=0;e<b.arguments.length;e++)0<e&&(d+=", "),d+=z(a,b.arguments[e]);else throw Error(q.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(za){throw za;}return"lang.callfunc("+c+","+(d+"]")+",runtimeCtx)";case "UnaryExpression":var M;
try{M="lang.unary("+z(a,b.argument)+",'"+b.operator+"')"}catch(za){throw za;}return M;case "BinaryExpression":var I;try{I="lang.binary("+z(a,b.left)+","+z(a,b.right)+",'"+b.operator+"')"}catch(za){throw za;}return I;case "LogicalExpression":var J;try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(q.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(q.nodeErrorMessage(b.right,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));J="lang.logical("+z(a,b.left)+","+z(a,b.right)+",'"+b.operator+"')"}catch(za){throw za;}return J;case "ConditionalExpression":throw Error(q.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{c=[];for(d=0;d<b.elements.length;d++)"Literal"===b.elements[d].type?c.push(z(a,b.elements[d])):c.push("lang.aCheck("+z(a,b.elements[d])+",'ArrayExpression')");f="["+c.join(",")+"]"}catch(za){throw za;}return f;case "ObjectExpression":c="lang.dictionary([";
for(d=0;d<b.properties.length;d++){var g=b.properties[d],V="Identifier"===g.key.type?"'"+g.key.name+"'":z(a,g.key),P=z(a,g.value);0<d&&(c+=",");c+="lang.strCheck("+V+",'ObjectExpression'),lang.aCheck("+P+", 'ObjectExpression')"}return c+"])";case "Property":throw Error("Should not get here");case "Array":throw Error(q.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));default:throw Error(q.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(za){throw za;}}nction C(a,b){return"BlockStatement"===b.type?z(a,b):"ReturnStatement"===b.type?z(a,b):"BreakStatement"===b.type?z(a,b):"ContinueStatement"===b.type?z(a,b):"UpdateExpression"===b.type?"lastStatement \x3d "+z(a,b)+";":"ExpressionStatement"===b.type?z(a,b):"ObjectExpression"===b.type?"lastStatement \x3d "+z(a,b)+";":z(a,b)}unction K(a,c){var d=null===c.init?null:z(a,c.init);d===b.voidOperation&&(d=null);c=c.id.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[c])return"lscope['"+
c+"']\x3d"+d+";";if(void 0!==a.localScope._SymbolsMap[c])return"lscope['"+a.localScope._SymbolsMap[c]+"']\x3d"+d+";";var e=Q(c,a);a.localScope._SymbolsMap[c]=e;return"lscope['"+e+"']\x3d"+d+";"}if(void 0!==a.globalScope[c])return"gscope['"+c+"']\x3d"+d+";";if(void 0!==a.globalScope._SymbolsMap[c])return"gscope['"+a.globalScope._SymbolsMap[c]+"']\x3d"+d+";";e=Q(c,a);a.globalScope._SymbolsMap[c]=e;return"gscope['"+e+"']\x3d"+d+";"}function M(a,c,e){c=c.toLowerCase();switch(c){case "hasz":return a=a.hasZ,
void 0===a?!1:a;case "hasm":return a=a.hasM,void 0===a?!1:a;case "spatialreference":return c=a.spatialReference._arcadeCacheId,void 0===c&&(e=!0,Object.freeze&&Object.isFrozen(a.spatialReference)&&(e=!1),e&&(R++,c=a.spatialReference._arcadeCacheId=R)),a=new x({wkt:a.spatialReference.wkt,wkid:a.spatialReference.wkid}),void 0!==c&&(a._arcadeCacheId="SPREF"+c.toString()),a}switch(a.type){case "extent":switch(c){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return a=
a[c],void 0!==a?a:null;case "type":return"Extent"}break;case "polygon":switch(c){case "rings":return c=b.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===c&&(R++,c=R,b.isVersion4?a.cache._arcadeCacheId=c:a.setCacheValue("_arcadeCacheId",c)),a=new d(a.rings,a.spatialReference,!0===a.hasZ,!0===a.hasM,c);case "type":return"Polygon"}break;case "point":switch(c){case "x":case "y":case "z":case "m":return void 0!==a[c]?a[c]:null;case "type":return"Point"}break;case "polyline":switch(c){case "paths":return c=
b.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===c&&(R++,c=R,b.isVersion4?a.cache._arcadeCacheId=c:a.setCacheValue("_arcadeCacheId",c)),a=new d(a.paths,a.spatialReference,!0===a.hasZ,!0===a.hasM,c);case "type":return"Polyline"}break;case "multipoint":switch(c){case "points":return c=b.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===c&&(R++,c=R,b.isVersion4?a.cache._arcadeCacheId=c:a.setCacheValue("_arcadeCacheId",c)),a=new k(a.points,a.spatialReference,
!0===a.hasZ,!0===a.hasM,c,1);case "type":return"Multipoint"}}throw Error(q.nodeErrorMessage(e,"RUNTIME","PROPERTYNOTFOUND"));}unction V(a){return null===a?"":b.isArray(a)||b.isImmutableArray(a)?"Array":b.isDate(a)?"Date":b.isString(a)?"String":b.isBoolean(a)?"Boolean":b.isNumber(a)?"Number":a instanceof x?"Dictionary":a instanceof y?"Feature":a instanceof e?"Point":a instanceof p?"Polygon":a instanceof f?"Polyline":a instanceof g?"Multipoint":a instanceof l?"Extent":b.isFunctionParameter(a)?"Function":a===b.voidOperation?"":"number"===typeof a&&isNaN(a)?"Number":"Unrecognised Type"}
function P(a,c,d,e){try{if(b.equalityTest(c[d],e))return c[d+1];var f=c.length-d;return 1===f?c[d]:2===f?null:P(a,c,d+2,e)}catch(ea){throw ea;}}nction Q(a,b){b.symbols.symbolCounter++;return"_T"+b.symbols.symbolCounter.toString()} R=0,U={};t.registerFunctions(U,A);u.registerFunctions(U,A);r.registerFunctions(U,A);n.registerFunctions(U,A);w.registerFunctions(U,A);U["typeof"]=U.iif=U.decode=U.when=U.top=U.first=U.sort=function(a,c){return A(a,c,function(a,c,d){b.pcCheck(d,1,2);c=d[0];b.isImmutableArray(c)&&(c=c.toArray());if(!1===b.isArray(c))throw Error("Illegal Argument");if(1<d.length){if(!1===b.isFunctionParameter(d[1]))throw Error("Illegal Argument");c=J(c,}else{if(0===c.length)return[];for(var e={},f=0;f<c.length;f++){var g=V(c[f]);""!==g&&(e[g]=!0)}if(!0===e.Array||!0===e.Dictionary||!0===e.Feature||!0===e.Point||
!0===e.Polygon||!0===e.Polyline||!0===e.Multipoint||!0===e.Extent||!0===e.Function)return c.slice(0);var f=0,g="",k;for(k in e)f++,g=k;c=1<f||"String"===g?J(c,:"Number"===g?J(c,function(a,b){return a-b}):"Boolean"===g?J(c,:"Date"===g?J(c,:c.slice(0)}return c})};for(var T in U)U[T]=new b.NativeFunction(U[T]);var N=function(){};N.prototype=U;h.functionHelper={fixSpatialReference:b.fixSpatialReference,parseArguments:standardFunction:A};h.executeScript=h.extractFieldLiterals=function(a,b){void 0===b&&(b=!1);return q.findFieldLiterals(a,b)};h.validateScript=h.referencesMember=function(a,b){return q.referencesMember(a,b)};h.referencesFunction=function(a,b){return q.referencesFunction(a,b)};var Z={error:functionDepthchecker:function(a,b){return function(){b.depthCounte++;if(64<b.depthCounter)throw Error("Exceeded maximum function depth");var c=a.apply(this,arguments);b.depthCounte--;return c}},aCheck:Dictionary:x,Feature:y,dictionary:strCheck:function(a,c){if(!1===b.isString(a))throw Error("Illegal Argument");return a},unary:function(a,c){if(b.isBoolean(a)){if("!"===c)return!a;
if("-"===c)return-1*b.toNumber(a);if("+"===c)return 1*b.toNumber(a);throw Error(q.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===c)return-1*b.toNumber(a);if("+"===c)return 1*b.toNumber(a);throw Error(q.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logical:function(a,c,d){if(b.isBoolean(a)&&b.isBoolean(c))switch(d){case "||":return a||c;case "\x26\x26":return a&&c;default:throw Error(q.nodeErrorMessage("LogicalExpression",
"RUNTIME","ONLYORORAND"));}else throw Error(q.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));},binary:function(a,c,d){switch(d){case "\x3d\x3d":return b.equalityTest(a,c);case "\x3d":return b.equalityTest(a,c);case "!\x3d":return!b.equalityTest(a,c);case "\x3c":return b.greaterThanLessThan(a,c,d);case "\x3e":return b.greaterThanLessThan(a,c,d);case "\x3c\x3d":return b.greaterThanLessThan(a,c,d);case "\x3e\x3d":return b.greaterThanLessThan(a,c,d);case "+":return b.isString(a)||b.isString(c)?
b.toString(a)+b.toString(c):b.toNumber(a)+b.toNumber(c);case "-":return b.toNumber(a)-b.toNumber(c);case "*":return b.toNumber(a)*b.toNumber(c);case "/":return b.toNumber(a)/b.toNumber(c);case "%":return b.toNumber(a)%b.toNumber(c);default:throw Error(q.nodeErrorMessage({type:"BinaryExpression"},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(a,c,d){switch(c){case "\x3d":return a===b.voidOperation?null:a;case "/\x3d":return b.toNumber(d)/b.toNumber(a);case "*\x3d":return b.toNumber(d)*b.toNumber(a);
case "-\x3d":return b.toNumber(d)-b.toNumber(a);case "+\x3d":return b.isString(d)||b.isString(a)?b.toString(d)+b.toString(a):b.toNumber(d)+b.toNumber(a);case "%\x3d":return b.toNumber(d)%b.toNumber(a);default:throw Error(q.nodeErrorMessage("AssignmentExpression","RUNTIME","OPERATORNOTRECOGNISED"));}},update:memberupdate:function(a,c,d,e){var f;if(b.isArray(a))if(b.isNumber(c)){0>c&&(c=a.length+c);if(0>
c||c>=a.length)throw Error("Assignment outside of array bounds");f=b.toNumber(a[c]);a[c]="++"===d?f+1:f-1}else throw Error("Invalid Parameter");else if(a instanceof x){if(!1===b.isString(c))throw Error("Dictionary accessor must be a string");if(!0===a.hasField(c))f=b.toNumber(a.field(c)),a.setField(c,"++"===d?f+1:f-1);else throw Error("Invalid Parameter");}else if(a instanceof y){if(!1===b.isString(c))throw Error("Feature accessor must be a string");if(!0===a.hasField(c))f=b.toNumber(a.field(c)),
a.setField(c,"++"===d?f+1:f-1);else throw Error("Invalid Parameter");}else{if(b.isImmutableArray(a))throw Error("Array is Immutable");throw Error("Invalid Parameter");}return!1===e?f:"++"===d?f+1:f-1},assignmember:member:function(a,c){if(null===a)throw Error(q.nodeErrorMessage("MemberExpression","RUNTIME","NOTFOUND"));if(a instanceof x||a instanceof y){if(b.isString(c))return a.field(c)}else if(a instanceof v){if(b.isString(c))return M(a,c,"MemberExpression")}else if(b.isArray(a)){if(b.isNumber(c)&&isFinite(c)&&Math.floor(c)===c){0>c&&(c=a.length+c);if(c>=a.length||0>c)throw Error(q.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a[c]}}else if(b.isString(a)){if(b.isNumber(c)&&
isFinite(c)&&Math.floor(c)===c){0>c&&(c=a.length+c);if(c>=a.length||0>c)throw Error(q.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a[c]}}else if(b.isImmutableArray(a)&&b.isNumber(c)&&isFinite(c)&&Math.floor(c)===c){0>c&&(c=a.length()+c);if(c>=a.length()||0>c)throw Error(q.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a.get(c)}throw Error(q.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));},callfunc:;h.compileScript=function(a,d){void 0===d&&(d=null);null===d&&(d={vars:{},customfunctions:{}});d={globalScope:ga(d.vars,U,d.customfunctions),localScope:null,console:L,symbols:{symbolCounter:0}};a=z(d,a.body[0].body);""===a&&(a="lc.voidOperation;");d={lc:b,lang:Z,postProcess:prepare:function(a,b){b||(b=new c(102100));var d=a.vars,e=a.customfunctions,f=new N;d||(d={});e||(e={});var g=new x({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});g.immutable=!1;f._SymbolsMap={textformatting:1,infinity:1,pi:1};f.textformatting=g;f.infinity=Number.POSITIVE_INFINITY;f.pi=Math.PI;for(var k in e)f[k]=e[k],
f._SymbolsMap[k]=1;for(k in d)f._SymbolsMap[k]=1,f[k]=d[k]instanceof m?new y(d[k]):d[k];return{spatialReference:b,globalScope:f,localScope:null,console:a.console?a.console:L,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===a.applicationCache?null:a.applicationCache}}};return(new Function("context","spatialReference","var runtimeCtx\x3dthis.prepare(context, spatialReference);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+
a+"\n return lastStatement; } \n return this.postProcess(mainBody());")).bind(d)}})},"esri/renderers/UniqueValueRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/lang ../core/urlUtils ../core/Logger ../core/Error ../core/arrayUtils ../portal/Portal ../symbols/WebStyleSymbol ../symbols/support/jsonUtils ../symbols/support/symbolUtils ./Renderer ./support/arcadeUtils ./support/diffUtils".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n){var w=g.getLogger("esri.renderers.UniqueValueRenderer");a=d=function(a){function f(c){c=a.call(this)||this;c._valueInfoMap={};c._isDefaultSymbolDerived=!1;c.type="uniqueValue";c.field=null;c.field2=null;c.field3=null;c.valueExpression=null;c.valueExpressionTitle=null;c.legendOptions=null;c.defaultLabel=null;c.fieldDelimiter=null;c.portal=null;c.styleOrigin=null;c.diff={uniqueValueInfos:function(a,c){if(a||c){if(!a||!c)return{type:"complete",oldValue:a,newValue:c};
for(var d=!1,e={type:"collection",added:[],removed:[],changed:[]},f=function(f){var g=b.find(a,function(a){return a.value===c[f].value});g?n.diff(g,c[f])&&(e.changed.push({type:"complete",oldValue:g,newValue:c[f]}),d=!0):(e.added.push(c[f]),d=!0)},g=0;g<c.length;g++)f(g);f=function(f){b.find(c,function(b){return b.value===a[f].value})||(e.removed.push(a[f]),d=!0)};for(g=0;g<a.length;g++)f(g);return d?e:void 0}}};c._set("uniqueValueInfos",[]);return c}p(f,a);f.prototype.writeValueExpression=function(a,
b,d,e){e&&"web-scene"===e.origin?a&&e.messages&&e.messages.push(new c("property:unsupported",this.declaredClass+".valueExpression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:"valueExpression",context:e})):b.valueExpression=a};f.prototype.writeValueExpressionTitle=function(a,b,d,e){e&&"web-scene"===e.origin?a&&e.messages&&e.messages.push(new c("property:unsupported",this.declaredClass+".valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",
{instance:this,propertyName:"valueExpressionTitle",context:e})):b.valueExpressionTitle=a};Object.defineProperty(f.prototype,"compiledFunc",{get:function(){return r.createFunction(this.valueExpression)},enumerable:!0,configurable:!0});f.prototype.readLegendOptions=function(a){return e.clone(a)};f.prototype.writeLegendOptions=function(a,b,d,f){f&&"web-scene"===f.origin?a&&f.messages&&f.messages.push(new c("property:unsupported",this.declaredClass+".legendOptions is not supported in Web Scene. Please remove this property to save the Web Scene.",
{instance:this,propertyName:"legendOptions",context:f})):b.legendOptions=e.clone(a)};Object.defineProperty(f.prototype,"defaultSymbol",{set:enumerable:!0,configurable:!0});f.prototype.readDefaultSymbol=f.prototype.writeDefaultSymbol=function(a,b,c,d){!this._isDefaultSymbolDerived&&(a=y.write(a,{},d))&&(b.defaultSymbol=a)};f.prototype.readPortal=function(a,b,c){return c.portal||q.getDefault()};
f.prototype.readStyleOrigin=function(a,b,c){if(b.styleName)return Object.freeze({styleName:b.styleName});if(b.styleUrl)return a=l.read(b.styleUrl,c),Object.freeze({styleUrl:a})};f.prototype.writeStyleOrigin=function(a,b,c,d){a.styleName?b.styleName=a.styleName:a.styleUrl&&(b.styleUrl=l.write(a.styleUrl,d))};Object.defineProperty(f.prototype,"uniqueValueInfos",{set:function(a){this.styleOrigin?w.error("#uniqueValueInfos\x3d","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):
(this._set("uniqueValueInfos",a.slice(0)),this._updateValueInfoMap())},enumerable:!0,configurable:!0});f.prototype.readUniqueValueInfos=function(a,b,c){if(Array.isArray(a))return a.map(function(a){a=e.clone(a);a.symbol=y.read(a.symbol,b,c);return a})};f.prototype.writeUniqueValueInfos=function(a,b,c,d){this.styleOrigin||(b.uniqueValueInfos=(this.uniqueValueInfos||[]).map(function(a){a=e.clone(a);a.symbol&&(a.symbol=y.write(a.symbol,{},d));a.value+="";return e.fixJson(a)}))};f.prototype.addUniqueValueInfo=
function(a,b){this.styleOrigin?w.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(a="object"===typeof a?a:{value:a,symbol:b},this.uniqueValueInfos.push(a),this._valueInfoMap[a.value+""]=a)};f.prototype.removeUniqueValueInfo=function(a){if(this.styleOrigin)w.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var b=0;b<this.uniqueValueInfos.length;b++)if(this.uniqueValueInfos[b].value+
""===a+""){delete this._valueInfoMap[a];this.uniqueValueInfos.splice(b,1);break}};f.prototype.getUniqueValueInfo=function(a,b){var c=this.field,d=a.attributes;if(this.valueExpression)c=r.executeFunction(this.compiledFunc,r.createExecContext(a,r.getView(b)));else if(this.field2){a=this.field2;b=this.field3;var e=[];c&&e.push(d[c]);a&&e.push(d[a]);b&&e.push(d[b]);c=e.join(this.fieldDelimiter||"")}else c=c&&"function"===typeof c?c(a):d[c];return this._valueInfoMap[c+""]};f.prototype.getSymbol=function(a,
b){return(a=this.getUniqueValueInfo(a,b))&&a.symbol||this.defaultSymbol};f.prototype.clone=function(){var a=new d({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:e.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:e.clone(this.visualVariables),legendOptions:e.clone(this.legendOptions),authoringInfo:e.clone(this.authoringInfo)});this._isDefaultSymbolDerived&&
(a._isDefaultSymbolDerived=!0);a._set("portal",this.portal);var b=e.clone(this.uniqueValueInfos);this.styleOrigin&&(a._set("styleOrigin",Object.freeze(e.clone(this.styleOrigin))),Object.freeze(b));a._set("uniqueValueInfos",b);a._updateValueInfoMap();return a};f.prototype.collectRequiredFields=function(a){this.inherited(arguments);[this.field,this.field2,this.field3].forEach(function(b){b&&(a[b]=!0)})};f.prototype.populateFromStyle=function(){var a=this;return t.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(b){var c=
[];a._valueInfoMap={};b&&b.data&&Array.isArray(b.data.items)&&b.data.items.forEach(function(d){var e=new x({styleUrl:b.styleUrl,styleName:b.styleName,portal:a.portal,name:d.name});a.defaultSymbol||d.name!==b.data.defaultItem||(a.defaultSymbol=e,a._isDefaultSymbolDerived=!0);e={value:d.name,symbol:e};c.push(e);a._valueInfoMap[d.name]=e});a._set("uniqueValueInfos",Object.freeze(c));!a.defaultSymbol&&a.uniqueValueInfos.length&&(a.defaultSymbol=a.uniqueValueInfos[0].symbol,a._isDefaultSymbolDerived=!0);
return a})};f.prototype._updateValueInfoMap=function(){var a=this;this._valueInfoMap={};this.uniqueValueInfos.forEach(function(b){return a._valueInfoMap[b.value+""]=b})};f.fromPortalStyle=function(a,b){var c=new d(b&&b.properties);c._set("styleOrigin",Object.freeze({styleName:a}));c._set("portal",b&&b.portal||q.getDefault());b=c.populateFromStyle();b.otherwise(function(b){w.error("#fromPortalStyle('"+a+"'[, ...])","Failed to create unique value renderer from style name",b)});return b};f.fromStyleUrl=
function(a,b){b=new d(b&&b.properties);b._set("styleOrigin",Object.freeze({styleUrl:a}));b=b.populateFromStyle();b.otherwise(function(b){w.error("#fromStyleUrl('"+a+"'[, ...])","Failed to create unique value renderer from style URL",b)});return b};return f}(f.declared(u));m([f.property()],a.prototype,"type",void 0);m([f.property({json:{read:{source:"field1"},write:{target:"field1"}}})],a.prototype,"field",void 0);m([f.property({json:{write:!0}})],a.prototype,"field2",void 0);m([f.property({json:{write:!0}})],
a.prototype,"field3",void 0);m([f.property({json:{write:!0}})],a.prototype,"valueExpression",void 0);m([f.writer("valueExpression")],a.prototype,"writeValueExpression",null);m([f.property({json:{write:!0}})],a.prototype,"valueExpressionTitle",void 0);m([f.writer("valueExpressionTitle")],a.prototype,"writeValueExpressionTitle",null);m([f.property({dependsOn:["valueExpression"]})],a.prototype,"compiledFunc",null);m([f.property({json:{write:!0}})],a.prototype,"legendOptions",void 0);m([f.reader("legendOptions")],
a.prototype,"readLegendOptions",null);m([f.writer("legendOptions")],a.prototype,"writeLegendOptions",null);m([f.property({json:{write:!0}})],a.prototype,"defaultLabel",void 0);m([f.property()],a.prototype,"defaultSymbol",null);m([f.reader("defaultSymbol")],a.prototype,"readDefaultSymbol",null);m([f.writer("defaultSymbol")],a.prototype,"writeDefaultSymbol",null);m([f.property({json:{write:!0}})],a.prototype,"fieldDelimiter",void 0);m([f.property({type:q,readOnly:!0})],a.prototype,"portal",void 0);
m([f.reader("portal",["styleName"])],a.prototype,"readPortal",null);m([f.property({readOnly:!0,json:{write:!0}})],a.prototype,"styleOrigin",void 0);m([f.reader("styleOrigin",["styleName","styleUrl"])],a.prototype,"readStyleOrigin",null);m([f.writer("styleOrigin")],a.prototype,"writeStyleOrigin",null);m([f.property()],a.prototype,"uniqueValueInfos",null);m([f.reader("uniqueValueInfos")],a.prototype,"readUniqueValueInfos",null);m([f.writer("uniqueValueInfos")],a.prototype,"writeUniqueValueInfos",null);
m([f.property({dependsOn:["field","field2","field3"],readOnly:!0})],a.prototype,"requiredFields",void 0);a=d=m([f.subclass("esri.renderers.UniqueValueRenderer")],a);var d;return a})},"esri/symbols/support/symbolUtils":function(){define("require exports dojo/has dojo/_base/lang ../Symbol3D ./jsonUtils ./Thumbnail ./StyleOrigin ../../core/urlUtils ../../core/promiseUtils ../../core/Error ../../request ../../portal/Portal ../../portal/PortalQueryParams".split(" "),function(a,h,p,m,f,e,l,g,c,b,q,x,y,
t){function u(a,b){a=c.normalize(c.makeAbsolute(a,b));b=a.lastIndexOf("/");return-1===b?{url:a,base:a,filename:null}:{url:a,base:a.slice(0,b),filename:a.slice(b+1)}}function r(a,b){w(a,}unction w(a,b){n(a,function(a){(a=a.resource)&&a.href&&(a.href=b(a.href))})}function d(a){w(a,function(a){return/\.svg$/.test(a)?(a.slice(0,a.length-4)+".png").replace("/resource/","/resource/png/"):a})}function k(a,b){a=m.clone(a);
r(a,b);(p("ie")||p("trident"))&&d(a);return e.fromJSON(a)}function v(a,b){var c=u(a,b&&b.url&&b.url.path);return C(c.url).then(function(b){return{reference:{styleUrl:a},data:b.data,base:c.base,filename:c.filename,styleUrl:a}})}function A(a,c){c=c.portal||y.getDefault();var d,e=c.url+" - "+a;return F[e]?b.resolve(F[e]):z(a,c).then(.then(function(b){b={data:b,base:d.itemUrl,filename:"data",styleName:a};return F[e]=b})}function z(a,b){return b.load().then(function(){if(!b.stylesGroupQuery)throw new q("layer-templates:styles-group-query-missing",
"The styles group query needs to be configured in the portal to query styles");var a=new t({disableExtraQuery:!0,query:b.stylesGroupQuery});return b.queryGroups(a)}).then(function(b){b=b.results;if(!b||!Array.isArray(b)||0===b.length)throw new q("layer-templates:styles-missing","The styles group does not contain any styles");b=b[0];var c=new t({disableExtraQuery:!0,query:'typekeywords:"'+a+'"'});return b.queryItems(c)}).then(function(b){b=b.results;if(!b||!Array.isArray(b)||0===b.length)throw new q("layer-templates:style-missing",
"The style '${styleName}' is not part of the styles group",{styleName:a});return b[0].load()})}function D(a,c){return a.styleUrl?v(a.styleUrl,c):a.styleName?A(a.styleName,c):b.reject(new q("layer-templates:style-url-and-name-missing","Either styleUrl or styleName is required in layerDefinition"))}function B(a,c,d){for(var e=function(b){if(b.name===c){var e=u(b.webRef,a.base);return{value:C(e.url).then(function(h){(h=k(h.data,e.base))&&h.isInstanceOf(f)&&(b.thumbnail&&(b.thumbnail.href?h.thumbnail=
new l.default({url:b.thumbnail.href}):b.thumbnail.imageData&&(h.thumbnail=new l.default({url:"data:image/png;base64,"+b.thumbnail.imageData}))),a.styleUrl?h.styleOrigin=new g({portal:d.portal,styleUrl:a.styleUrl,name:c}):a.styleName&&(h.styleOrigin=new g({portal:d.portal,styleName:a.styleName,name:c})));return h})}}},h=0,n=a.data.items;h<n.length;h++){var m=e(n[h]);if("object"===typeof m)return m.value}return b.reject(new q("layer-templates:symbol-name-not-found","The symbol name '${symbolName}' could not be found",
{symbolName:c}))}function C(a){var b={responseType:"json"};/\.json$/.test(a)||(b.query={f:"json"});return x(c.normalize(a),b)}h.fetchStyleFromUrl=v;var F={};h.fetchStyle=D;h.fetchStyleSymbol=function(a,c){return a.name?D(a,c).then(:b.reject(new q("layer-templates:style-symbol-reference-name-missing","Missing name in style symbol reference"))};h.fetchSymbolFromStyle=B;h.fetchSymbolSet=function(a){var c=a.data;if(!c.symbolSetUrl)return b.reject(new q("layer-templates:symbol-set-url-missing",
"Style does not provide symbol set URL",{style:c}));var d=u(c.symbolSetUrl,a.base);return C(d.url).then(function(a){a=a.data;if(0===a.length||!a[0].name)throw new q("layer-templates:symbol-set-missing-data","Invalid syntax or missing data in symbol set",{style:c});for(var b={},e=0;e<a.length;e++){var f=k(a[e],d.base);b[a[e].name]=f;a[e].name===c.defaultItem&&(b.defaultSymbol=f)}b.defaultSymbol||(b.defaultSymbol=b[a[0].name]);return b})};h.createSymbol=function(a,b){return a?k(a,b&&b.url&&b.url.path):
null};h.styleNameFromItem=function(a){var b=0;for(a=a.typeKeywords;b<a.length;b++){var c=a[b];if(/^Esri.*Style$/.test(c))return c}};h.isVolumetricSymbol=function(a){return(a=a&&a.symbolLayers)?a.some(:!1}})},"esri/renderers/support/diffUtils":function(){define("require exports dojo/_base/lang ../../core/Accessor ../../core/Collection ../../core/accessorSupport/utils".split(" "),function(a,h,p,m,f,e){function l(a){return a instanceof
f?Object.keys(a.items):a instanceof m?e.getProperties(a).keys():a?Object.keys(a):[]}function g(a,b){return a instanceof f?a.items[b]:a[b]}function c(a,b){return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length:!1}unction q(a,e){var f=a.diff;if(f&&p.isFunction(f))return f(a,e);var h=l(a),n=l(e);if(0!==h.length||0!==n.length){if(!h.length||!n.length||c(a,e))return{type:"complete",oldValue:a,newValue:e};var m=n.filter(function(a){return-1===h.indexOf(a)}),
d=h.filter(,m=h.filter(function(b){return-1<n.indexOf(b)&&g(a,b)!==g(e,b)}).concat(m,d).sort();if((d=b(a))&&-1<x.indexOf(d)&&m.length)return{type:"complete",oldValue:a,newValue:e};var k,t;for(t in m){var d=m[t],y=g(a,d),z=g(e,d),D=void 0;p.isFunction(y)||p.isFunction(z)||y===z||!(D=f&&f[d]&&p.isFunction(f[d])?f[d](y,z):"object"===typeof y&&"object"===typeof z&&b(y)===b(z)?q(y,z):{type:"complete",oldValue:y,newValue:z})||(k=k||{type:"partial",diff:{}},k.diff[d]=
D)}return k}}var x=["esri.Color","esri.portal.Portal"];h.diff=function(a,c){if(!p.isFunction(a)&&!p.isFunction(c)&&(a||c))return!a||!c||"object"===typeof a&&"object"===typeof a&&b(a)!==b(c)?{type:"complete",oldValue:a,newValue:c}:q(a,c)}})},"esri/renderers/support/jsonUtils":function(){define(["../../core/Warning","../SimpleRenderer","../UniqueValueRenderer","../ClassBreaksRenderer"],function(a,h,p,m){var f={simple:h,uniqueValue:p,classBreaks:m},e={fromJson:function(a){try{throw Error("fromJson is deprecated, use fromJSON instead");
}catch(g){console.warn(g.stack)}return e.fromJSON(a)},read:function(e,g,c){if(e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type)return c&&c.messages&&c.messages.push(new a("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:c})),null;if(g=e?f[e.type]||null:null)return g=new g,g.read(e,c),g;c&&c.messages&&e&&c.messages.push(new a("renderer:unsupported","Renderers of type '"+(e.type||"unknown")+"' are not supported",{definition:e,
context:c}));return null},fromJSON:function(a){var e=a?f[a.type]||null:null;return e?e.fromJSON(a):null}};return e})},"esri/renderers/ClassBreaksRenderer":function(){define("../core/declare ../core/lang ../core/kebabDictionary ../core/Error dojo/_base/array dojo/_base/lang ../symbols/support/jsonUtils ./Renderer ./support/arcadeUtils".split(" "),function(a,h,p,m,f,e,l,g,c){var b=p({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),q=p({esriClassifyNaturalBreaks:"natural-breaks",
esriClassifyEqualInterval:"equal-interval",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyGeometricalInterval:"geometrical-interval"}),x=a(g,{declaredClass:"esri.renderers.ClassBreaksRenderer",properties:{backgroundFillSymbol:{value:null,json:{read:l.read,write:function(a,b,c,e){if(a=l.write(a,{},e))b.backgroundFillSymbol=a}}},classBreakInfos:{set:function(a){this._symbols={};a&&a.forEach(this._processCBInfo,this);this._set("classBreakInfos",a)},json:{read:{source:["classBreakInfos",
"minValue"],reader:function(a,b,c){var e=b.minValue;if(a&&Array.isArray(a)){var f=a[0]&&null!=a[0].classMaxValue;return a.map(function(a){a=h.clone(a);if(f){var d=a.classMaxValue;a.minValue=e;e=a.maxValue=d}a.symbol=l.read(a.symbol,b,c);return a})}return a}},write:function(a,b,c,e){a=this.classBreakInfos||[];c=a[0]&&a[0].minValue;b.minValue=-Infinity===c?-Number.MAX_VALUE:c;b.classBreakInfos=f.map(a,function(a){a=h.clone(a);a.symbol&&(a.symbol=l.write(a.symbol,{},e));a.classMaxValue=Infinity===a.maxValue?
Number.MAX_VALUE:a.maxValue;delete a.minValue;delete a.maxValue;return h.fixJson(a)})}}},classificationMethod:{value:null,json:{read:q.fromJSON,write:function(a,b){if(a=q.toJSON(a))b.classificationMethod=a}}},defaultLabel:{value:null,json:{write:!0}},defaultSymbol:{value:null,json:{read:l.read,write:function(a,b,c,e){if(a=l.write(a,{},e))b.defaultSymbol=a}}},valueExpression:{value:null,json:{write:function(a,b,c,e){e&&"web-scene"===e.origin?a&&e.messages&&e.messages.push(new m("property:unsupported",
this.declaredClass+".valueExpression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:"valueExpression",context:e})):b.valueExpression=a}}},valueExpressionTitle:{value:null,json:{write:function(a,b,c,e){e&&"web-scene"===e.origin?a&&e.messages&&e.messages.push(new m("property:unsupported",this.declaredClass+".valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:"valueExpressionTitle",
context:e})):b.valueExpressionTitle=a}}},compiledFunc:{dependsOn:["valueExpression"],get:,legendOptions:{value:null,json:{read:function(a){return h.clone(a)},write:function(a,b,c,e){e&&"web-scene"===e.origin?a&&e.messages&&e.messages.push(new m("property:unsupported",this.declaredClass+".legendOptions is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:"legendOptions",context:e})):
b.legendOptions=h.clone(a)}}},field:{value:null,json:{write:!0}},isMaxInclusive:!0,normalizationField:{value:null,json:{write:!0}},normalizationTotal:{value:null,json:{write:!0}},normalizationType:{value:null,dependsOn:["normalizationField","normalizationTotal"],get:function(){var a=this._get("normalizationType"),b=!!this.normalizationField,c=null!=this.normalizationTotal;if(b||c)a=b&&"field"||c&&"percent-of-total",b&&c&&console.warn("warning: both normalizationField and normalizationTotal are set!");
else if("field"===a||"percent-of-total"===a)a=null;return a},json:{read:b.fromJSON,write:function(a,c){if(a=b.toJSON(a))c.normalizationType=a}}},requiredFields:{dependsOn:["field","normalizationField"]},type:"classBreaks"},constructor:addClassBreakInfo:function(a,b,c){a=e.isObject(a)?a:{minValue:a,maxValue:b,symbol:c};this.classBreakInfos.push(a);this._processCBInfo(a)},removeClassBreakInfo:function(a,b){var c,e,f=this.classBreakInfos.length,g=
this._symbols;for(e=0;e<f;e++)if(c=[this.classBreakInfos[e].minValue,this.classBreakInfos[e].maxValue],c[0]==a&&c[1]==b){delete g[a+"-"+b];this.classBreakInfos.splice(e,1);break}},getBreakIndex:function(a,b){var f=this.field,g=a.attributes,h=this.classBreakInfos.length,l=this.isMaxInclusive;if(this.valueExpression)a=c.executeFunction(this.compiledFunc,c.createExecContext(a,c.getView(b)));else if(e.isFunction(f))a=f(a);else if(a=parseFloat(g[f]),b=this.normalizationType)if(f=parseFloat(this.normalizationTotal),
g=parseFloat(g[this.normalizationField]),"log"===b)a=Math.log(a)*Math.LOG10E;else if("percent-of-total"===b&&!isNaN(f))a=a/f*100;else if("field"===b&&!isNaN(g)){if(isNaN(a)||isNaN(g))return-1;a/=g}if(null!=a&&!isNaN(a)&&"number"===typeof a)for(g=0;g<h;g++)if(b=[this.classBreakInfos[g].minValue,this.classBreakInfos[g].maxValue],b[0]<=a&&(l?a<=b[1]:a<b[1]))return g;return-1},getClassBreakInfo:function(a,b){a=this.getBreakIndex(a,b);return-1!==a?this.classBreakInfos[a]:null},getSymbol:function(a,b){a=
this.getBreakIndex(a,b);return(a=-1<a&&[this.classBreakInfos[a].minValue,this.classBreakInfos[a].maxValue])?this._symbols[a[0]+"-"+a[1]]:this.defaultSymbol},clone:function(){return new x({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),classificationMethod:this.classificationMethod,defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
classBreakInfos:h.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:h.clone(this.visualVariables),legendOptions:h.clone(this.legendOptions),authoringInfo:h.clone(this.authoringInfo)})},collectRequiredFields:function(a){this.inherited(arguments);[this.field,this.normalizationField].forEach(},_processCBInfo:function(a){var b=
a.minValue,c=a.maxValue,e=a.symbol;e&&!e.declaredClass&&(a.symbol=l.fromJSON(e));this._symbols[b+"-"+c]=a.symbol}});return x})},"esri/renderers/support/styleUtils":function(){define(["require","exports","../../core/promiseUtils","../../core/Warning"],function(a,h,p,m){h.loadStyleRenderer=function(a,e){var f=a&&a.getAtOrigin&&a.getAtOrigin("renderer",e.origin);return f&&"uniqueValue"===f.type&&f.styleOrigin?f.populateFromStyle().otherwise(function(f){e&&e.messages&&e.messages.push(new m("renderer:style-reference",
"Failed to create unique value renderer from style reference: "+f.message,{error:f,context:e}));a.clear("renderer",e.origin)}).then(:p.resolve(null)}})},"esri/layers/support/FeatureType":function(){define("../../core/declare dojo/_base/lang dojo/_base/array ../../core/lang ../../symbols/support/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),function(a,h,p,m,f,e,l,g,c){return a(null,{declaredClass:"esri.layers.support.FeatureType",
constructor:function(a){if(a&&h.isObject(a)){this.id=a.id;this.name=a.name;var b=a.symbol;b&&(this.symbol=f.fromJSON(b));var b=a.domains,m,p=this.domains={};for(m in b)if(b.hasOwnProperty(m)){var t=b[m];switch(t.type){case "range":p[m]=new e(t);break;case "codedValue":p[m]=new l(t);break;case "inherited":p[m]=new g(t)}}if(m=a.templates)for(b=this.templates=[],a=0;a<m.length;a++)b.push(new c(m[a]))}},toJSON:)})},"esri/layers/support/InheritedDomain":function(){define(["../../core/declare","./Domain"],function(a,h){return a([h],{declaredClass:"esri.layers.support.InheritedDomain"})})},"esri/layers/support/FeatureTemplate":function(){define(["../../core/declare","dojo/_base/lang","../../core/lang","../../Graphic"],function(a,
h,p,m){a=a(null,{declaredClass:"esri.layers.support.FeatureTemplate",constructor:function(a){a&&h.isObject(a)&&(this.name=a.name,this.description=a.description,this.drawingTool=a.drawingTool,a=a.prototype,this.prototype=new m(a.geometry,null,a.attributes))},toJSON:function(){return p.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJSON()})}});h.mixin(a,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",
TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",
TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});return a})},"esri/layers/support/LabelClass":function(){define("../../core/JSONSupport ../../core/lang ../../core/kebabDictionary ../../core/Error dojo/_base/lang dojo/number ../../PopupTemplate ../../widgets/Popup/PopupRendererViewModel ../../renderers/support/arcadeUtils ../../symbols/support/jsonUtils".split(" "),function(a,h,p,m,f,e,l,g,c,b){var q=/__begin__/ig,x=/__end__/ig,y=/^__begin__/i,t=/__end__$/i,
u=p({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",
esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",
esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"}),r=a.createSubclass({declaredClass:"esri.layers.support.LabelClass",properties:{name:{value:null,json:{write:!0}},labelExpression:{value:null,json:{write:!0}},labelExpressionInfo:{value:null,json:{write:function(a,b,c,e){a=h.fixJson(a&&f.clone(a));e&&"web-scene"===e.origin?(a.expression&&
(e.messages&&e.messages.push(new m("property:unsupported",this.declaredClass+".labelExpressionInfo.expression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:"labelExpressionInfo.expression",context:e})),delete a.expression),b.labelExpressionInfo=a):b.labelExpressionInfo=this._processLabelExpressionInfo(a)}}},labelPlacement:{value:null,json:{read:write:function(a,b){if(a=u.toJSON(a))b.labelPlacement=
a}}},maxScale:{value:0,json:{write:function(a,b){if(a||this.minScale)b.maxScale=a}}},minScale:{value:0,json:{write:function(a,b){if(a||this.maxScale)b.minScale=a}}},requiredFields:{readOnly:!0,dependsOn:["labelExpression","labelExpressionInfo","where"],get:function(){var a=Object.create(null);this._collectRequiredFields(a);return Object.keys(a)}},symbol:{value:null,json:{read:b.read,write:function(a,c,d,e){c.symbol=b.write(a,{},e)}}},useCodedValues:{value:null,json:{write:!0}},where:{value:null,json:{write:!0}}},
getLabelExpression:function(){var a={expression:"",type:"none"};this.labelExpressionInfo?this.labelExpressionInfo.value?(a.expression=this.labelExpressionInfo.value,a.type="conventional"):this.labelExpressionInfo.expression&&(a.expression=this.labelExpressionInfo.expression,a.type="arcade"):this._validateLabelExpression(this.labelExpression)&&(a.expression=this._convertLabelExpression(this.labelExpression),a.type="conventional");return a},getOptions:function(){var a={},b=this.labelExpressionInfo;
if(b){var d=b.expression;d&&!b.value&&(a.hasArcadeExpression=!0,a.compiledArcadeFunc=c.createFunction(d))}return a},clone:function(){return new r({labelExpression:this.labelExpression,labelExpressionInfo:f.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:this.symbol.clone(),where:this.where,useCodedValues:this.useCodedValues})},_collectRequiredFields:function(a){this._collectLabelExpressionRequiredFields(this.getLabelExpression(),
a);this._collectWhereRequiredFields(this.where,a)},_validateLabelExpression:_convertLabelExpression:_collectWhereRequiredFields:function(a,b){null!=a&&(a=a.split(" "),3===a.length&&(b[a[0]]=!0),7===a.length&&(b[a[0]]=!0,b[a[4]]=!0))},_collectLabelExpressionRequiredFields:function(a,b){"arcade"===a.type?c.extractFieldNames(a.expression).forEach(:(a=a.expression.match(/{[^}]*}/g))&&
a.forEach(function(a){b[a.slice(1,-1)]=!0})},_processLabelExpressionInfo:function(a){a&&a.value&&(a.expression=this._convertTemplatedStringToArcade(a.value));return a},_convertTemplatedStringToArcade:function(a){var b;a&&(b=f.replace(a,,b=y.test(b)?b.replace(y,""):'"'+b,b=t.test(b)?b.replace(t,""):b+'"',b=b.replace(q,'" + ').replace(x,' + "'));return b}});r.evaluateWhere=function(a,b){var c=try{if(null==a)return!0;var e=a.split(" ");if(3===e.length)return c(b[e[0]],e[1],e[2]);if(7===e.length){var f=c(b[e[0]],e[1],e[2]),g=e[3],h=c(b[e[4]],e[5],e[6]);switch(g){case "AND":return f&&h;case "OR":return f||h}}return!1}catch(D){console.log("Error.: can't parse \x3d "+a)}};r.buildLabelText=function(a,b,d,e){var f="";if(e&&
e.hasArcadeExpression)e.compiledArcadeFunc&&(a=c.createExecContext(b),a=c.executeFunction(e.compiledArcadeFunc,a),null!=a&&(f=a.toString()));else var g=b&&b.attributes||{},f=a.replace(/{[^}]*}/g,function(a){return r.formatField(a.slice(1,-1),a,g,d,e)});return f};r.formatField=function(a,b,c,k,m){var d;for(d=0;d<k.length;d++)if(k[d].name==a){b=c[k[d].name];var n=k[d].domain;if(n&&f.isObject(n)){if("codedValue"==n.type)for(a=0;a<n.codedValues.length;a++)n.codedValues[a].code==b&&(b=n.codedValues[a].name);
else"range"==n.type&&n.minValue<=b&&b<=n.maxValue&&(b=n.name);break}n=k[d].type;"date"==n?(n=m&&m.dateFormat||"shortDate",n=l.prototype._dateFormatKebabDict.fromJSON(n),(n="DateFormat"+g.prototype._dateFormats[n])&&(b=h.substitute({myKey:b},"{myKey:"+n+"}"))):("integer"==n||"small-integer"==n||"long"==n||"double"==n)&&m&&m.numberFormat&&m.numberFormat.digitSeparator&&m.numberFormat.places&&(b=e.format(b,{places:m.numberFormat.places}))}return null==b?"":b};return r})},"esri/widgets/Popup/PopupRendererViewModel":function(){define("../../core/Accessor ../../core/Error ../../core/HandleRegistry ../../core/lang ../../core/urlUtils ../../core/promiseUtils ../../core/watchUtils ../../request ../../tasks/support/StatisticDefinition ../../tasks/support/Query ../../tasks/QueryTask dojo/_base/lang dojo/promise/all dojo/i18n!dojo/cldr/nls/number".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t){var u=/\'/g,r=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/ig,n=/(\{([^\{\r\n]+)\})/g,w={attachments:"attachments",fields:"fields",media:"media",text:"text"},d={"short-date":"(datePattern: 'M/d/y', selector: 'date')","short-date-le":"(datePattern: 'd/M/y', selector: 'date')","long-month-day-year":"(datePattern: 'MMMM d, y', selector: 'date')","day-short-month-year":"(datePattern: 'd MMM y', selector: 'date')","long-date":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",
"short-date-short-time":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-le-short-time":"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-short-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')","short-date-le-short-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')","short-date-long-time":"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",
"short-date-le-long-time":"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-long-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')","short-date-le-long-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-year":"(datePattern: 'MMMM y', selector: 'date')","short-month-year":"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"};return a.createSubclass({declaredClass:"esri.widgets.Popup.PopupRendererViewModel",
properties:{content:{readOnly:!0},contentEnabled:!0,contentTypes:{readOnly:!0},formattedAttributes:{readOnly:!0},graphic:{},title:{readOnly:!0},waitingForContent:{readOnly:!0}},constructor:initialize:function(){this._handles.add([l.init(this,"graphic",bind(this)),l.init(this,"contentEnabled",bind(this))])},destroy:function(){this._handles.destroy();this._handles=
null;this._clearRelatedInfo();this._cancelPromises();this.graphic=null;this._set("title",null);this._set("content",null);this._set("waitingForContent",null)},content:null,contentEnabled:!0,contentTypes:w,formattedAttributes:null,graphic:null,title:"",waitingForContent:!1,_handles:null,_contentPromise:null,_contentPromises:null,_relatedRecordsPromise:null,_relatedRecordsQueryPromises:[],_relatedRecordsLayerPromises:[],_relatedLayersInfo:null,_relatedInfo:null,_dateFormats:d,_addValuesToHref:function(a,
b,c,d){b=this._trimString(b);return m.substitute(b&&0===b.indexOf("${")?c:d,a)},_cancelPromises:function(){this._contentPromises&&(this._contentPromises.forEach(function(a){a.cancel()},this),this._contentPromises=null);this._contentPromise&&(this._contentPromise.cancel(),this._contentPromise=null);this._relatedRecordsQueryPromises.forEach(function(a){a.cancel()});this._relatedRecordsQueryPromises.length=0;this._relatedRecordsLayerPromises.length&&(this._relatedRecordsLayerPromises.forEach(,
this._relatedRecordsLayerPromises.length=0);this._relatedRecordsPromise&&(this._relatedRecordsPromise.cancel(),this._relatedRecordsPromise=null)},_clearRelatedInfo:_compileContent:function(a,b){var c=a.content;if("function"===typeof c&&(c=c.call(null,{graphic:a.graphic}))&&c.nodeName)return c;if("string"===typeof c)return this._compileText(a,{type:w.text,text:c}).text;if(Array.isArray(c))return c.map(function(c,d){d=(d=b&&b[d])&&d.value;switch(c.type){case w.attachments:return this._proxyAttachments(c,
d);case w.fields:return c;case w.media:return this._compileMedia(a,c);case w.text:return this._compileText(a,c)}},this);if(c)try{throw new h(this.declaredClass+"::invalid content type.");}catch(z){console.warn(z.stack)}},_compileMedia:function(a,b){b=x.clone(b);var c=b.mediaInfos,d=a.attributes,e=a.layer,f=this.formattedAttributes.global,g=a.substOptions,k,h;c&&(k=[],c.forEach(function(b){h=0;var c=b.value;switch(b.type){case "image":var l=c.sourceURL,l=l&&this._trimString(m.substitute(d,this._fixTokens(l,
e)));h=!!l;break;case "pie-chart":case "line-chart":case "column-chart":case "bar-chart":var n,l=c.normalizeField;c.fields=c.fields.map(this);l&&(n=this._getLayerFieldInfo(e,l),c.normalizeField=n?n.name:l);h=c.fields.some(function(a){return m.isDefined(d[a])||-1!==a.indexOf("relationships/")&&this._relatedInfo},this);break;default:return}if(h){b=x.clone(b);var c=b.value,l=b.title?this._processFieldsInLinks(this._fixTokens(b.title,e),d):
"",p=b.caption?this._processFieldsInLinks(this._fixTokens(b.caption,e),d):"";b.title=l?this._trimString(m.substitute(f,l,g)):"";b.caption=p?this._trimString(m.substitute(f,p,g)):"";if("image"===b.type)c.sourceURL=m.substitute(d,this._fixTokens(c.sourceURL,e)),c.linkURL&&(c.linkURL=this._trimString(m.substitute(d,this._fixTokens(c.linkURL,e))));else{var q,r=(l=a.template)&&l.fieldInfos;c.fields.forEach(function(a,b){if(-1!==a.indexOf("relationships/"))a=this._getRelatedChartInfos(e,r,a,c,d,g),Array.isArray(a)?
c.fields=a:c.fields[b]=a;else{var f=d[a],f=void 0===f?null:f;q=d[c.normalizeField]||0;f&&q&&(f/=q);var k=r&&this._getFieldInfo(r,a);c.fields[b]={y:f,tooltip:(k&&k.label||a)+":"+this._formatValue(f,{fieldInfos:r,fieldName:a,layer:e,substOptions:g,preventPlacesFormatting:!!q})}}},this)}k.push(b)}},this));b.mediaInfos=k;return b},_compileText:function(a,b){if((b=x.clone(b))&&b.text){var c=a.attributes,d=this.formattedAttributes.global,e=a.substOptions;a=this._processFieldsInLinks(this._fixTokens(b.text,
a.layer),c);b.text=this._trimString(m.substitute(d,a,e))}return b},_compileTitle:function(a){var b="",c=a.title,d=a.layer,e=a.attributes,f=a.substOptions,g=this.formattedAttributes.global;c&&("function"===typeof c&&(c=c.call(null,{graphic:a.graphic})),"string"===typeof c&&-1===c.indexOf("{relationships/")&&(a=this._processFieldsInLinks(this._fixTokens(c,d),e),b=this._trimString(m.substitute(g,a,f))));return b},_createGraphicInfo:function(a,b){var c=a.getEffectivePopupTemplate(),e=c&&c.title,f=c&&
c.content,g=a.layer,k=g&&g._getDateOpts&&g._getDateOpts().properties,h=x.clone(a.attributes)||{};return{graphic:a,template:c,title:e,content:f,contentEnabled:b,layer:g,attributes:h,properties:k,substOptions:{dateFormat:{properties:k,formatter:"DateFormat"+d["short-date-short-time"]}}}},_fixTokens:function(a,b){return a.replace(n,function(a,c,d){return(a=this._getLayerFieldInfo(b,d))?"{"+a.name+"}":c}.bind(this))},_encodeAttributes:function(a){var b=x.clone(a)||{};Object.keys(b).forEach(function(a){var c=
b[a];"string"===typeof c&&(c=encodeURIComponent(c).replace(u,"\x26apos;"),b[a]=c)});return b},_formatAttributesToFieldInfos:function(a,b,c,d,e){a.forEach(function(f){var g=f.fieldName,k=this._getLayerFieldInfo(b,g);k&&(g=f.fieldName=k.name);e[g]=this._formatValue(e[g],{fieldInfos:a,fieldName:g,layer:b,substOptions:c});d&&f.format&&f.format.dateFormat&&(f=d.indexOf(g),-1<f&&d.splice(f,1))},this)},_formatAttributes:function(a,b,c,d,e,f){var g=x.clone(e);this._relatedInfo&&Object.keys(this._relatedInfo).forEach(function(a){var b=
this._relatedInfo[a];a=this._relatedLayersInfo[a];b&&(b.relatedFeatures.forEach(this._relatedFeaturesAttributes.bind(this,a,e,g)),b.relatedStatsFeatures.forEach(this._relatedStatsAttributes.bind(this,a,e,g)))},this);a&&this._formatAttributesToFieldInfos(a,b,c,d,g);if(b){var k=b.typeIdField;Object.keys(e).forEach(function(a){if(-1===a.indexOf("relationships/")){var c=e[a];if(m.isDefined(c)){var d=this._getDomainName(b,f,a,c);m.isDefined(d)?g[a]=d:a===k&&(c=this._getTypeName(b,f,c),m.isDefined(c)&&
(g[a]=c))}}},this)}return g},_formatValue:function(a,b){var c=b.fieldInfos,e=b.fieldName,f=b.substOptions,c=c&&this._getFieldInfo(c,e),g=x.clone(c),c=b.preventPlacesFormatting;(b=this._getLayerFieldInfo(b.layer,e))&&"date"===b.type&&(b=g.format||{},b.dateFormat=b.dateFormat||"short-date-short-time",g.format=b);b=g&&g.format;e="number"===typeof a&&f.dateFormat.properties&&-1===f.dateFormat.properties.indexOf(e)&&(!b||!b.dateFormat);if(!m.isDefined(a)||!g||!m.isDefined(b))return e?this._forceLTR(a):
a;var k="",h=[],g=b.hasOwnProperty("places")||b.hasOwnProperty("digitSeparator"),l=b.hasOwnProperty("digitSeparator")?b.digitSeparator:!0;if(g)k="NumberFormat",m.isDefined(b.places)&&(!c||0<b.places)&&(h.push("places: "+Number(b.places)),k+="("+h.join(",")+")");else if(b.dateFormat)k="DateFormat"+d[b.dateFormat]||d["short-date-short-time"];else return e?this._forceLTR(a):a;a=m.substitute({myKey:a},"{myKey:"+k+"}",f)||"";g&&!l&&t.group&&(a=a.replace(new RegExp("\\"+t.group,"g"),""));return e?this._forceLTR(a):
a},_forceLTR:_getDomainName:_getFieldInfo:function(a,b){b=b.toLowerCase();for(var c,d=0;d<a.length;d++){var e=a[d];if(e.fieldName&&e.fieldName.toLowerCase()===b){c=e;break}}return c},_getLayerFieldInfo:_getTypeName:function(a,b){return(a=a.getType&&a.getType(b))&&a.name},_processFieldsInLinks:function(a,b){var c=
this._encodeAttributes(b);a&&(a=a.replace(r,bind(this)));return a},_proxyAttachments:function(a,b){a=x.clone(a);b&&!(b instanceof h)&&b.attachmentInfos&&b.attachmentInfos.length&&(b=b.attachmentInfos.map(this),a.attachmentInfos=b);return a},_queryAttachments:function(a){var b=a.layer,c=a.attributes;a=b&&b.objectIdField;c=c&&a&&c[a];if(a&&b.hasAttachments&&c)return this._queryAttachmentInfos(b,c)},_queryAttachmentInfos:function(a,
b){var c=a.url+"/"+a.layerId+"/"+b+"/attachments",d=a.token||"";return g(c,{query:{f:"json",token:d},callbackParamName:"callback"}).then(function(a){a=a.data;a.attachmentInfos.forEach(function(a){a.url=c+"/"+a.id;d&&(a.url+="?token\x3d"+d);a.objectId=b});return a})},_queryContent:function(a){var b=a.template,b=b&&b.content;if(!b||"string"===typeof b||"function"===typeof b)return e.resolve();if(!Array.isArray(b))return e.reject(new h(this.declaredClass+"::Invalid content type."));var c=[],d={};b.forEach(function(b,
e){b.type===w.attachments&&(b=this._queryAttachments(a))&&(d[e]=b,c.push(b))},this);this._contentPromises=c;return 0===c.length?e.resolve():e.eachAlways(d).always(bind(this))},_trimString:_updateContent:function(a){if(a.contentEnabled){var b=this._queryContent(a).then(function(b){this._set("content",this._compileContent(a,b))}.bind(this),function(a){console.log(this.declaredClass+"::error loading template",a)}.bind(this)).always(bind(this));return this._contentPromise=b}return e.resolve()},_createFormattedAttributes:function(a){var b=a.graphic,c=a.attributes,d=a.layer,e=a.template,f=a.substOptions,g=a.properties,k={global:this._formatAttributes(e&&e.fieldInfos,d,f,g,c,b),content:[]};a=e&&e.content;Array.isArray(a)&&a.forEach(function(a,e){a.type===w.fields&&a.fieldInfos&&(k.content[e]=this._formatAttributes(a.fieldInfos,d,f,g,c,b))},this);return k},_updateGraphic:function(a,b){if(this._handles&&(this._clearRelatedInfo(),
this._cancelPromises(),this._set("title",""),this._set("content",null),this._set("formattedAttributes",null),this._set("waitingForContent",!1),a)){this._set("waitingForContent",!0);var c=this._createGraphicInfo(a,b);this._relatedRecordsPromise=this._checkForRelatedRecords(c).then(function(){this._set("formattedAttributes",this._createFormattedAttributes(c));this._set("title",this._compileTitle(c));return this._updateContent(c)}.bind(this)).always(function(){this._relatedRecordsPromise=null;this._relatedRecordsLayerPromises.length=
0;this._relatedRecordsQueryPromises.length=0;this._set("waitingForContent",!1)}.bind(this))}},_getAllFieldInfos:function(a){var b=[],c=a.template,d=c&&c.fieldInfos;a=a.contentEnabled;d&&(b=b.concat(d));a&&(c=c&&c.content,Array.isArray(c)&&c.forEach(function(a){b=b.concat(a&&a.fieldInfos)},this));return b},_checkForRelatedRecords:function(a){var b=this._getAllFieldInfos(a).filter(function(a){return a&&a.fieldName&&-1!==a.fieldName.indexOf("relationships/")},this);return a.layer&&b&&0<b.length?this._getRelatedRecords({graphic:a.graphic,
fieldsInfo:b}):e.resolve()},_relatedFeaturesAttributes:function(a,b,c,d){Object.keys(d.attributes).forEach(function(e){if("esriRelCardinalityOneToOne"===a.relation.cardinality){var f=this._toRelatedFieldName([a.relation.id,e]);b[f]=c[f]=d.attributes[e]}},this)},_relatedStatsAttributes:function(a,b,c,d){Object.keys(d.attributes).forEach(function(e){var f=this._toRelatedFieldName([a.relation.id,e]);b[f]=c[f]=d.attributes[e]},this)},_getRelatedChartInfos:function(a,b,c,d,e,f){var g,k,h,l,m,n;g=[];n=
this._fromRelatedFieldName(c);m=n[0];k=this._relatedInfo[m];m=this._relatedLayersInfo[m];k&&k.relatedFeatures.forEach(function(k){var m=k.attributes,p;Object.keys(m).forEach(function(k){if(k===n[1]){p={};l=m[k];d.normalizeField&&(h=-1!==d.normalizeField.indexOf("relationships/")?m[this._fromRelatedFieldName(d.normalizeField)[1]]:e[d.normalizeField]);l&&h&&(l/=h);if(d.tooltipField)if(-1!==d.tooltipField.indexOf("relationships/"))k=this._fromRelatedFieldName(d.tooltipField)[1],k=m[k],p.tooltip=k+": "+
this._formatValue(l,{fieldInfos:b,fieldName:k,layer:a,substOptions:f,preventPlacesFormatting:!!h});else{if(k=this._getLayerFieldInfo(a,c))c=k.name;p.tooltip=c+": "+this._formatValue(l,{fieldInfos:b,fieldName:d.tooltipField,layer:a,substOptions:f,preventPlacesFormatting:!!h})}else p.tooltip=l;p.y=l;g.push(p)}},this)},this);return"esriRelCardinalityOneToMany"===m.relation.cardinality||"esriRelCardinalityManyToMany"===m.relation.cardinality?g:g[0]},_getRelatedRecords:function(a){var b=a.graphic;return this._relatedLayersInfo?
this._queryRelatedLayers(b).then(function(a){this._setRelatedRecords(a);return a}.bind(this)):this._getRelatedLayersInfo(a).then(function(a){Object.keys(a).forEach(function(b){a[b]&&(this._relatedLayersInfo[b].relatedLayerInfo=a[b].data)},this);return this._queryRelatedLayers(b).then(bind(this))}.bind(this))},_getRelatedLayersInfo:function(a){var b=a.fieldsInfo,d,e={};d=a.graphic.layer;this._relatedLayersInfo||(this._relatedLayersInfo={});b.forEach(function(a){var b,
e,f;b=this._fromRelatedFieldName(a.fieldName);e=b[0];b=b[1];if(e){if(!this._relatedLayersInfo[e]){var g=d&&d.relationships;g&&g.some(;f&&(this._relatedLayersInfo[e]={relation:f,relatedFields:[],outStatistics:[]})}this._relatedLayersInfo[e]&&(this._relatedLayersInfo[e].relatedFields.push(b),a.statisticType&&(a=new c({statisticType:a.statisticType,onStatisticField:b,outStatisticFieldName:b}),this._relatedLayersInfo[e].outStatistics.push(a)))}},this);Object.keys(this._relatedLayersInfo).forEach(function(a){var b;
this._relatedLayersInfo[a]&&(b=this._relatedLayersInfo[a].relation,b=d.url+"/"+b.relatedTableId,this._relatedLayersInfo[a].relatedLayerUrl=b,e[a]=g(b,{query:{f:"json"},callbackParamName:"callback"}))},this);Object.keys(e).forEach(this);return y(e)},_queryRelatedLayers:function(a){var b={};Object.keys(this._relatedLayersInfo).forEach(function(c){b[c]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[c]})},this);return y(b)},
_queryRelatedLayer:function(a){var c,d,e,f,g,k,h,l,m;c=a.graphic;d=c.layer.layerId;h=a.relatedInfo;a=h.relatedLayerInfo;l=h.relatedLayerUrl;m=h.relation;a&&a.relationships&&a.relationships.some(;e&&(a.fields.some(function(a){if(a.name===e.keyField)return f=-1!==["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a.type)?"number":"string",!0}),g="string"===f?e.keyField+"\x3d'"+c.attributes[m.keyField]+
"'":e.keyField+"\x3d"+c.attributes[m.keyField],g=new b({where:g,outFields:h.relatedFields}),h.outStatistics&&0<h.outStatistics.length&&a.supportsStatistics&&(k=new b({where:g.where,outFields:g.outFields,outStatistics:h.outStatistics})),a=new q({url:l}),g=[a.execute(g)],k&&g.push(a.execute(k)));this._relatedRecordsQueryPromises=this._relatedRecordsQueryPromises.concat(g);return y(g)},_setRelatedRecords:function(a){this._relatedInfo=[];Object.keys(a).forEach(function(b){if(a[b]){var c=a[b];this._relatedInfo[b]=
{relatedFeatures:c[0].features};m.isDefined(c[1])&&(this._relatedInfo[b].relatedStatsFeatures=c[1].features)}},this)},_fromRelatedFieldName:function(a){return-1!==a.indexOf("relationships/")?a.split("/").slice(1):[]},_toRelatedFieldName:function(a){return a&&0<a.length?"relationships/"+a[0]+"/"+a[1]:""}})})},"esri/layers/support/labelingInfo":function(){define(["require","exports","./LabelClass"],function(a,h,p){var m=/\[([^\[\]]+)\]/ig;h.reader=function(a,e,h){var f=this;return a?a.map(function(a){var b=
new p;b.read(a,h);if(b.labelExpression){var c=e.fields||e.layerDefinition&&e.layerDefinition.fields||f.fields;b.labelExpression=b.labelExpression.replace(m,function(a,b){a:if(c){a=b.toLowerCase();for(var e=0;e<c.length;e++){var f=c[e].name;if(f.toLowerCase()===a){b=f;break a}}}return"["+b+"]"})}return b}):null}})},"esri/layers/support/ElevationInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../core/kebabDictionary".split(" "),
function(a,h,p,m,f,e,l){a=l({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",absoluteHeight:"absolute-height"});h=g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}p(b,a);b.prototype.clone=return b}(f.declared(e));m([f.property({type:Number,json:{write:!0}})],h.prototype,"value",void 0);h=g=m([f.subclass("esri.layers.support.FeatureExpression")],h);e=c=function(a){(b,a);b.prototype.write=function(a,b){return this.offset||this.mode||this.featureExpression?this.inherited(arguments):null};b.prototype.clone=function(){return new c({mode:this.mode,offset:this.offset,featureExpression:this.featureExpression?this.featureExpression.clone():void 0})};return b}(f.declared(e));m([f.property({type:h,json:{write:!0}})],e.prototype,"featureExpression",void 0);m([f.property({type:String,json:{read:a.read,write:a.write}})],e.prototype,"mode",void 0);m([f.property({type:Number,
json:{write:!0}})],e.prototype,"offset",void 0);e=c=m([f.subclass("esri.layers.support.ElevationInfo")],e);var g,c;return e})},"esri/plugins/popupManager":function(){define(["../views/PopupManager"],function(a){return{add:function(h,p){h.popupManager||(h.popupManager=new a(p),h.popupManager.view=h)},remove:})},"esri/views/PopupManager":function(){define("require ../core/promiseUtils dojo/_base/array dojo/on dojo/Deferred dojo/promise/all ../layers/support/layerUtils ../geometry/support/scaleUtils ../geometry/Extent ../tasks/support/Query ../layers/GroupLayer ../core/Accessor".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x){var y;return x.createSubclass({declaredClass:"esri.views.PopupManager",properties:{map:{dependsOn:["view.map"],readOnly:!0}},constructor:destroy:_clickHandle:null,_featureLayersCache:null,enabled:!1,_enabledSetter:function(a){this._clickHandle&&(a?this._clickHandle.resume():this._clickHandle.pause());this._set("enabled",a)},_mapGetter:view:null,_viewSetter:function(a){this._clickHandle&&(this._clickHandle.remove(),this._clickHandle=null);a&&(this._clickHandle=m.pausable(a,"click",this._clickHandler.bind(this)),this.enabled||this._clickHandle.pause());this._set("view",a)},getMapLayer:_showPopup:function(a){unction l(a){return d.allLayerViews.find(function(b){return b.layer===
a})}function m(a){if(null==a)return!1;var b=l(a);return null==b?!1:a.loaded&&!b.suspended&&(a.popupEnabled&&a.popupTemplate||"graphics"===a.type||b.getPopupData)}function t(a){return(a=l(a))&&a.hasDraped}var d=this.view,k=d.popup,v=this,y=[],x="3d"===d.type;p.forEach(this.map.layers.toArray(),function(a){a.isInstanceOf(q)?p.forEach(a.layers.toArray(),function(a){!m(a)||x&&!t(a)||y.push(a)}):!m(a)||x&&!t(a)||y.push(a)});0<d.graphics.length&&y.push(d.graphics);var D=null;a.graphic&&(a.graphic.popupTemplate||
m(a.graphic.layer))&&(D=a.graphic);if(y.length||D){var B=[],C=!!D;if(D)D.layer&&"scene"===D.layer.type?B.unshift(this._fetchSceneAttributes(D.layer,[D])):D.getEffectivePopupTemplate()&&(F=new f,B.unshift(F.resolve([D])));else{var F=v._calculateClickTolerance(y),D=a.mapPoint;if(!D){e();return}var K=1;d.state&&(K=d.state.resolution);(B=d.basemapTerrain)&&B.overlayManager&&(K=B.overlayManager.overlayPixelSizeInMapUnits(D));F*=K;B&&!B.spatialReference.equals(d.spatialReference)&&(F*=g.getUnitValueForSR(B.spatialReference)/
g.getUnitValueForSR(d.spatialReference));var B=D.clone().offset(-F,-F),D=D.clone().offset(F,F),M=new c(Math.min(B.x,D.x),Math.min(B.y,D.y),Math.max(B.x,D.x),Math.max(B.y,D.y),d.spatialReference),B=y.map(function(c){var d;if("imagery"===c.type){d=new b;d.geometry=a.mapPoint;var e=l(c),f={rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0};f.layerView=e;d=c.queryVisibleRasters(d,f).then(function(a){C=C||0<a.length;return a})}else if("csv"===c.type||!v._featureLayersCache[c.id]&&"function"!==
typeof c.queryFeatures){if("map-image"===c.type)return e=l(c),e.getPopupData(M);var f=[],g;"esri.core.Collection\x3cesri.Graphic\x3e"===c.declaredClass?(e=c,g=!0):"graphics"===c.type?(e=c.graphics,g=!0):(e=(e=l(c))&&e.loadedGraphics,g=!1);e&&(f=e.filter(function(a){return a&&(!g||a.popupTemplate)&&a.visible&&M.intersects(a.geometry)}).toArray());0<f.length&&(C=!0,d="scene"===c.type?v._fetchSceneAttributes(c,f):h.resolve(f))}else e=c.createQuery(),e.geometry=M,d=c.queryFeatures(e).then(function(a){a=
a.features;C=C||0<a.length;return a});return d}).filter(,E=function(a){return a.reduce(function(a,b){return a.concat(b.items?E(b.items):b)},[])},B=E(B)}p.some(B,||C?B.length&&k.open({promises:B,location:a.mapPoint}):e()}else e()},_fetchSceneAttributes:function(a,b){return this.view.whenLayerView(a).then(function(c){var e=this._getOutFields(a.popupTemplate),f=b.map(;
return h.eachAlways(f)}.bind(this)).then(},_getSubLayerFeatureLayers:function(b,c){var g=c||new f,h=[];c=b.length;var q=Math.floor(this.view.extent.width/this.view.width),d=this.view.scale,k=!1,t=this,u=0;a:for(;u<c;u++){var x=b[u],D=x.dynamicLayerInfos||x.layerInfos;if(D){var B=null;x._params&&(x._params.layers||x._params.dynamicLayers)&&(B=x.visibleLayers);for(var B=l._getVisibleLayers(D,B),C=l._getLayersForScale(d,D),F=D.length,K=0;K<F;K++){var M=
D[K],E=M.id,V=x.popupTemplates[E];if(!M.subLayerIds&&V&&V.popupTemplate&&-1<p.indexOf(B,E)&&-1<p.indexOf(C,E)){if(!y){k=!0;break a}var P=x.id+"_"+E,I=this._featureLayersCache[P];I&&I.loadError||(I||((I=V.layerUrl)||(I=M.source?this._getLayerUrl(x.url,"/dynamicLayer"):this._getLayerUrl(x.url,E)),I=new y(I,{id:P,drawMode:!1,mode:y.MODE_SELECTION,outFields:this._getOutFields(V.popupTemplate),resourceInfo:V.resourceInfo,source:M.source}),this._featureLayersCache[P]=I),I.setDefinitionExpression(x.layerDefinitions&&
x.layerDefinitions[E]),I.setGDBVersion(x.gdbVersion),I.popupTemplate=V.popupTemplate,I.setMaxAllowableOffset(q),I.setUseMapTime(!!x.useMapTime),x.layerDrawingOptions&&x.layerDrawingOptions[E]&&x.layerDrawingOptions[E].renderer&&I.setRenderer(x.layerDrawingOptions[E].renderer),h.push(I))}}}}if(k){var J=new f;a(["../layers/FeatureLayer"],;J.then(}else{var Q=[];p.forEach(h,;Q.length?e(Q).then(:(h=p.filter(h,,g.resolve(h))}return g.promise},_getLayerUrl:_getOutFields:function(a){var b;"esri.PopupTemplate"===a.declaredClass&&a.fieldInfos?(b=[],p.forEach(a.fieldInfos,):b=["*"];return b},_calculateClickTolerance:function(a){var b=6;p.forEach(a,;
return b},_clickHandler:function(a){ar c=this.view,e=a.screenPoint,f=this;if(0===a.button&&c.popup&&c.ready){var d="3d"===c.type,g=c.map.allLayers.some(function(a){if(a.isInstanceOf(q))return!1;var c;null==a?c=!1:(c=b(a),c=null==c?!1:a.loaded&&!c.suspended&&(a.popupEnabled&&a.popupTemplate||"graphics"===a.type||c.getPopupData));c&&!(c=!d)&&(c=(a=b(a))&&a.hasDraped);return c?!0:!1});null!=e?this.view.hitTest(e.x,e.y).then(function(b){0<
b.results.length?f._showPopup(b.results[0]):g&&f._showPopup(a)}):f._showPopup(a)}}})})},"esri/layers/support/layerUtils":function(){define(["dojo/_base/array"],function(a){return{_serializeLayerDefinitions:function(h){var p=[],m=!1,f=/[:;]/;if(h&&(a.forEach(h,,0<p.length)){var e;m?(e={},a.forEach(p,,e=JSON.stringify(e)):(e=[],a.forEach(p,,e=e.join(";"));return e}return null},_serializeTimeOptions:_getVisibleLayers:function(h,p){var m=[],f,e;if(!h)return m;if(p)for(m=p.concat(),e=0;e<h.length;e++)p=h[e],f=a.indexOf(h,p.id),p.subLayerIds&&-1<f&&(m.splice(f,1),m=m.concat(p.subLayerIds));else m=this._getDefaultVisibleLayers(h);return m},_getDefaultVisibleLayers:_getLayersForScale:})},
"esri/layers/GroupLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Layer ../core/MultiOriginJSONSupport ./mixins/PortalLayer ./mixins/OperationalLayer ../support/LayersMixin ../core/accessorSupport/utils ../core/accessorSupport/decorators".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){a=function(a){function c(b){b=a.call(this)||this;b._visibilityHandles={};b.fullExtent=void 0;b.operationalLayerType="GroupLayer";b.spatialReference=void 0;
b.type="group";b._visibilityWatcher=b._visibilityWatcher.bind(b);return b}p(c,a);c.prototype.initialize=function(){this._enforceVisibility(this.visibilityMode,this.visible);this.watch("visible",this._visibleWatcher.bind(this),!0)};c.prototype._writeLayers=function(a,b,c,e){var f=[];if(!a)return f;a.forEach(function(a){a.write&&(a=a.write(null,e))&&a.layerType&&f.push(a)});b.layers=f};Object.defineProperty(c.prototype,"visibilityMode",{set:function(a){var b=this._get("visibilityMode")!==a;this._set("visibilityMode",
a);b&&this._enforceVisibility(a,this.visible)},enumerable:!0,configurable:!0});c.prototype.load=function(){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]}));return this};c.prototype.layerAdded=function(a,b){a.visible&&"exclusive"===this.visibilityMode?this._turnOffOtherLayers(a):"inherited"===this.visibilityMode&&(a.visible=this.visible);this._visibilityHandles[a.uid]=a.watch("visible",this._visibilityWatcher,!0)};c.prototype.layerRemoved=
function(a,b){if(b=this._visibilityHandles[a.uid])b.remove(),delete this._visibilityHandles[a.uid];this._enforceVisibility(this.visibilityMode,this.visible)};c.prototype._turnOffOtherLayers=function(a){this.layers.forEach(};c.prototype._enforceVisibility=function(a,c){if(b.getProperties(this).initialized){var e=this.layers,f=e.find(;switch(a){case "exclusive":e.length&&!f&&(f=e.getItemAt(0),f.visible=!0);this._turnOffOtherLayers(f);
break;case "inherited":e.forEach(}}};c.prototype._visibleWatcher=function(a){"inherited"===this.visibilityMode&&this.layers.forEach(function(b){b.visible=a})};c.prototype._visibilityWatcher=function(a,b,c,e){switch(this.visibilityMode){case "exclusive":a?this._turnOffOtherLayers(e):this._isAnyLayerVisible()||(e.visible=!0);break;case "inherited":e.visible=this.visible}};c.prototype._isAnyLayerVisible=return c}(q.declared(f,
c,e,g,l));m([q.shared({"2d":"../views/layers/GroupLayerView","3d":"../views/layers/GroupLayerView"})],a.prototype,"viewModulePaths",void 0);m([q.property()],a.prototype,"fullExtent",void 0);m([q.property({json:{read:!1,write:{ignoreOrigin:!0}}})],a.prototype,"layers",void 0);m([q.writer("layers")],a.prototype,"_writeLayers",null);m([q.property()],a.prototype,"operationalLayerType",void 0);m([q.property({json:{write:!1}})],a.prototype,"portalItem",void 0);m([q.property()],a.prototype,"spatialReference",
void 0);m([q.property({json:{read:!1}})],a.prototype,"type",void 0);m([q.property({json:{read:!1,write:!1}})],a.prototype,"url",void 0);m([q.property({value:"independent",json:{write:!0}})],a.prototype,"visibilityMode",null);return a=m([q.subclass("esri.layers.GroupLayer")],a)})},"esri/portal/support/layersCreator":function(){define("require exports dojo/has ../../core/promiseUtils ../../core/requireUtils ../../layers/Layer ../../renderers/support/styleUtils".split(" "),function(a,h,p,m,f,e,l){function g(b,
c,d){var e,g;return f.when(a,"../../layers/"+c).then(function(a){var c={};b.itemId&&(c.portalItem={id:b.itemId,portal:d.context.portal});g=e=new a(c);g.read(b,d.context);return l.loadStyleRenderer(g,d.context).then(})}function c(a,b){var c=a.layerType||a.type;!c&&b&&b.defaultLayerType&&(c=b.defaultLayerType);var e;switch(b.context.origin){case "web-scene":switch(b.context.layerContainerType){case "basemap":e=t;break;case "ground":e=y;break;default:e=x}break;default:switch(b.context.layerContainerType){case "basemap":e=
r;break;default:e=u}}return g(a,e[c]||"UnknownLayer",b)}function b(a,b,c){return b&&b.filter?c.then(function(a){var c=b.filter(a);return void 0===c?m.resolve(a):c instanceof e?m.resolve(c):c}):c}function q(a,e,d){if(!e)return[];for(var f=[],g=[],h=0;h<e.length;h++){var l=e[h],n=c(l,d);f.push(n);g.push(null);if("GroupLayer"===l.layerType&&l.layers&&Array.isArray(l.layers)&&0<l.layers.length){l=l.layers.map(;f.push.apply(f,l);for(var p=0;p<l.length;p++)g.push(n)}}var q={};
return f.map(function(c,e){var f=function(a,b){q[b.id]=e;var c=a.findIndex(function(a){if(!a.id)return!1;a=q[a.id];return void 0===a?!1:e<a});0>c&&(c=void 0);a.add(b,c)};return b(a,d,c).then(function(b){if(null===g[e])f(a,b);else return g[e].then(function(a){f(a.layers,b);return m.resolve(b)});return m.resolve(b)})})}var x={ArcGISFeatureLayer:"FeatureLayer",ArcGISMapServiceLayer:"MapImageLayer",PointCloudLayer:"PointCloudLayer",ArcGISSceneServiceLayer:"SceneLayer",IntegratedMeshLayer:"IntegratedMeshLayer",
ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"TileLayer",ArcGISTiledMapServiceLayer:"TileLayer",GroupLayer:"GroupLayer",OpenStreetMap:"OpenStreetMapLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",VectorTileLayer:"VectorTileLayer",DefaultTileLayer:"TileLayer"},y={ArcGISTiledElevationServiceLayer:"ElevationLayer",DefaultTileLayer:"ElevationLayer"},t={ArcGISTiledMapServiceLayer:"TileLayer",ArcGISTiledImageServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",
WebTiledLayer:"WebTileLayer",DefaultTileLayer:"TileLayer",VectorTileLayer:"VectorTileLayer"},u={ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISStreamLayer:"StreamLayer",ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"TileLayer",ArcGISTiledMapServiceLayer:"TileLayer",GroupLayer:"GroupLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",
WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",GeoRSS:"GeoRSSLayer",KML:"UnsupportedLayer",WMS:"UnsupportedLayer",DefaultTileLayer:"TileLayer"},r={ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISTiledImageServiceLayer:"TileLayer",ArcGISTiledMapServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WebTiledLayer:"WebTileLayer",bingLayer:"UnsupportedLayer",WMS:"UnsupportedLayer",DefaultTileLayer:"TileLayer"};
h.createLayer=c;h.processLayer=b;h.populateLayers=q;h.populateOperationalLayers=)},"esri/views/layers/LayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Evented ../../core/Identifiable ../../core/Promise ../../core/HandleRegistry ../../core/Logger".split(" "),function(a,h,p,m,f,e,l,g,c,b,q){a=function(a){function c(){var c=null!==
a&&a.apply(this,arguments)||this;c.handles=new b;c.parent=null;c.view=null;return c}p(c,a);c.prototype.initialize=function(){var a=this;this.addResolvingPromise(this.layer);this.otherwise(function(b){if("layerview:create-error"!==b.name){var c=a.layer&&a.layer.id||"no id",e=a.layer&&a.layer.title||"no title";q.getLogger(a.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+e+"', id: '"+c+"')",b)}})};c.prototype.destroy=function(){this.layer=this.parent=null};Object.defineProperty(c.prototype,
"layer",{get:function(){return this._get("layer")},set:function(a){this.handles.remove("layer");a&&this.handles.add(a.on("refresh",this.refresh.bind(this)),"layer");this._set("layer",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"suspended",{get:enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"updating",{get:enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"visible",{get:set:function(a){void 0===a?this._clearOverride("visible"):this._override("visible",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fullOpacity",{get:function(){var a=this.get("layer.opacity"),a=null!=a?a:1,b=this.get("parent.fullOpacity");return a*(null!=b?b:1)},enumerable:!0,configurable:!0});c.prototype.refresh=c.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&
this.get("layer.loaded")&&this.visible||!1};c.prototype.isUpdating=function(){return!1};return c}(f.declared(e,l,g,c));m([f.property({value:null})],a.prototype,"layer",null);m([f.property()],a.prototype,"parent",void 0);m([f.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],a.prototype,"suspended",null);m([f.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],a.prototype,"updating",null);m([f.property()],a.prototype,"view",void 0);m([f.property({dependsOn:["layer.visible"]})],
a.prototype,"visible",null);m([f.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],a.prototype,"fullOpacity",null);return a=m([f.subclass("esri.views.layers.LayerView")],a)})},"esri/views/View":function(){define("dojo/_base/lang ../Graphic ../core/Accessor ../core/Collection ../core/CollectionFlattener ../core/Evented ../core/HandleRegistry ../core/Promise ../core/watchUtils ../core/promiseUtils ../core/Scheduler ../geometry/SpatialReference ../geometry/Extent ./BreakpointsOwner ./LayerViewManager ./BasemapView ./GroundView ./support/DefaultsFromMap".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x,y,t,u,r,n,w){return p.createSubclass([g,e,t],{declaredClass:"esri.views.View",properties:{allLayerViews:{readOnly:!0},basemapView:{},animation:{},resizing:{},interacting:{},graphics:{type:m.ofType(h)},groundView:{},defaultsFromMap:w,initialExtent:{readOnly:!0,type:y,dependsOn:["defaultsFromMap.extent"]},initialExtentRequired:{},layerViews:{type:m},map:{},ready:{readOnly:!0,dependsOn:"map spatialReference width height initialExtentRequired initialExtent defaultsFromMap.isDone map.loaded".split(" ")},
size:{readOnly:!0,dependsOn:["width","height"],get:,spatialReference:{type:x,dependsOn:["defaultsFromMap.spatialReference"]},stationary:{dependsOn:["animation","interacting","resizing"]},type:{},updating:{},padding:{},width:{},height:{}},constructor:function(a){this._viewHandles=new l;this._viewHandles.add(this.watch("ready",function(a,b){this._currentSpatialReference=a?this.spatialReference:null;this.notifyChange("spatialReference");!a&&b&&this.layerViewManager.empty()}.bind(this)));
this.allLayerViews=new f({root:this,rootCollectionNames:["basemapView.baseLayerViews","groundView.layerViews","layerViews","basemapView.referenceLayerViews"],getChildrenFunction:function(a){return a.layerViews}});this.defaultsFromMap=new w({view:this})},getDefaults:function(){return a.mixin(this.inherited(arguments),{layerViews:[],graphics:[],padding:{left:0,top:0,right:0,bottom:0}})},initialize:function(){var a=this.validate().then(function(){this._isValid=!0;this.notifyChange("ready");return c.whenOnce(this,
"ready")}.bind(this));this.addResolvingPromise(a);this.basemapView=new r({view:this});this.groundView=new n({view:this});this.layerViewManager=new u({view:this});this._resetInitialViewPropertiesFromContent()},destroy:function(){this.basemapView.destroy();this.groundView.destroy();this.destroyLayerViews();this.defaultsFromMap.destroy();this.defaultsFromMap=null;this._viewHandles.destroy();this.map=null},destroyLayerViews:_viewHandles:null,_isValid:!1,_readyCycleForced:!1,
_userSpatialReference:null,_currentSpatialReference:null,animation:null,basemapView:null,groundView:null,graphics:null,_graphicsSetter:function(a){this._graphicsView&&(this._graphicsView.graphics=a);this._set("graphics",a)},interacting:!1,layerViews:null,map:null,_mapSetter:function(a){var b=this._get("map");a!==b&&(a&&a.load&&a.load(),this._forceReadyCycle(),this._resetInitialViewPropertiesFromContent(),this._set("map",a))},padding:null,_readyGetter:function(){return!(!this._isValid||this._readyCycleForced||
!this.map||0===this.width||0===this.height||!this.spatialReference||this.map.load&&!this.map.loaded||!(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isDone)||!this.isSpatialReferenceSupported(this.spatialReference))},spatialReference:null,_spatialReferenceGetter:function(){return this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null},_spatialReferenceSetter:stationary:!0,_stationaryGetter:type:null,updating:!1,initialExtentRequired:!0,initialExtent:null,_initialExtentGetter:whenLayerView:getDefaultSpatialReference:validate:isSpatialReferenceSupported:
_resetInitialViewPropertiesFromContent:function(){if(this.defaultsFromMap){var a=this.defaultsFromMap.start.bind(this.defaultsFromMap);this.defaultsFromMap.reset();this._currentSpatialReference=null;this.notifyChange("spatialReference");this._viewHandles.remove("defaultsFromMap");this._viewHandles.add([c.watch(this,"spatialReference",a),c.watch(this,"initialExtentRequired",a),q.schedule(a)],"defaultsFromMap")}},_forceReadyCycle:function(){this.ready&&(this._readyCycleForced=!0,this.notifyChange("ready"),
c.whenFalseOnce(this,"ready",bind(this)))}})})},"esri/views/BreakpointsOwner":function(){define("../core/Accessor ../core/ArrayPool ../core/HandleRegistry ../core/watchUtils dojo/_base/lang dojo/dom-class".split(" "),function(a,h,p,m,f,e){var l={widthBreakpoint:{getValue:function(a){var b=a.viewSize[0];a=a.breakpoints;var c=this.values;return b<=a.xsmall?c.xsmall:b<=a.small?c.small:b<=a.medium?c.medium:b<=a.large?c.large:c.xlarge},values:{xsmall:"xsmall",
small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",
large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue:values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",
large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue:values:{portrait:"portrait",landscape:"landscape"},
valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},g={xsmall:544,small:768,medium:992,large:1200};return a.createSubclass({properties:{breakpoints:{},orientation:{},widthBreakpoint:{},heightBreakpoint:{}},constructor:function(){this._handles=new p},getDefaults:function(){return f.mixin(this.inherited(arguments),{breakpoints:g})},initialize:destroy:function(){this._removeActiveClassNames();
this._handles.destroy();this.view=this._handles=null},_breakpointsSetter:function(a){var b=this._get("breakpoints");if(a!==b){var b=(b=a)&&b.xsmall<b.small&&b.small<b.medium&&b.medium<b.large,c;b||(c=JSON.stringify(g,null,2),console.warn("provided breakpoints are not valid, using defaults:"+c));a=b?a:g;this._set("breakpoints",f.mixin({},a))}},_updateClassNames:function(){if(this.container){var a=h.acquire(),b=h.acquire(),e=!1,f,g,m;for(f in l)g=this[f],m=l[f].getValue({viewSize:this.size,breakpoints:this.breakpoints}),
g!==m&&(e=!0,this[f]=m,b.push(l[f].valueToClassName[g]),a.push(l[f].valueToClassName[m]));e&&(this._applyClassNameChanges(a,b),h.release(a),h.release(b))}},_applyClassNameChanges:function(a,b){var c=this.container;c&&(e.remove(c,b),e.add(c,a))},_removeActiveClassNames:function(){var a=this.container,b;if(a)for(b in l)e.remove(a,l[b].valueToClassName[this[b]])}})})},"esri/views/LayerViewManager":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/Error ../core/HandleRegistry ../core/Scheduler ../core/promiseUtils ../core/watchUtils ./LayerViewFactory".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q,x){a=function(a){function e(){var b=a.call(this)||this;b._promisesMap=new Map;b._layerViewsMap=new Map;b._handles=new g;b.factory=new x;b.ready=!1;b.layersToLayerViews=function(){var a=new Map;a.set("view.map.basemap.baseLayers","view.basemapView.baseLayerViews");a.set("view.map.ground.layers","view.groundView.layerViews");a.set("view.map.layers","view.layerViews");a.set("view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews");return a}();b._doWork=
b._doWork.bind(b);b.refresh=b.refresh.bind(b);b._handles.add(q.init(b,"view.ready",);b._handles.add(b.watch(["view.map.basemap","view.map.ground","view.map.layers","ready"],b.refresh),"watcher");return b}p(e,a);e.prototype.destroy=function(){this.empty();this.view=null;this.factory.destroy();this.factory=null;this._handles.destroy();this._map=this._layerViewsMap=this._promisesMap=this._handles=null};e.prototype.empty=function(){this._layerViewsMap.forEach(this._disposeLayerView,
this);this._promisesMap.forEach(;this._layerViewsMap.clear();this._promisesMap.clear();this._refreshCollections()};e.prototype.refresh=function(){var a=this._handles;a.remove("refresh");a.add(c.schedule(this._doWork),"refresh")};e.prototype.whenLayerView=function(a){this.refresh();this._doWork();return this._promisesMap.has(a)?this._promisesMap.get(a):b.reject(new l("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:a}))};e.prototype._doWork=
function(){var a=this,b=this._handles,c=this.get("view.map");this._map!==c&&(this.empty(),this._map=c);if(b.has("refresh")){b.remove("refresh");b.remove("collection-change");this.factory.paused=!this.ready;var e=this._map&&this._map.allLayers;e&&(e.forEach(this._createLayerView,this),this._refreshCollections(),this._promisesMap.forEach(function(b,c){e.includes(c)||a._disposeLayerView(a._layerViewsMap.get(c),c)}),b.add(e.on("change",this.refresh),"collection-change"))}};e.prototype._refreshCollections=
function(){var a=this;this.layersToLayerViews.forEach(function(b,c){a._populateLayerViewsOwners(a.get(c),a.get(b),a.view)})};e.prototype._populateLayerViewsOwners=function(a,b,c){var e=this;if(a&&b){var d=0;a.forEach(function(a){var f=e._layerViewsMap.get(a);f&&(f.layer=a,f.parent=c,b.getItemAt(d)!==f&&b.splice(d,0,f),a.layers&&e._populateLayerViewsOwners(a.layers,f.layerViews,f),d+=1)});d<b.length&&b.splice(d,b.length)}else b&&b.removeAll()};e.prototype._createLayerView=function(a){var c=this,e=
this.view,f=this.factory,d=this._layerViewsMap,g=this._promisesMap;d.has(a)?a.load():g.has(a)||(f=f.create(e,a).then(function(f){if(!c._map||!c._map.allLayers.some()throw new l("view:no-layerview-for-layer","The layer has been removed from the map",{layer:a});d.set(a,f);c._refreshCollections();a.emit("layerview-create",{view:e,layerView:f});e.emit("layerview-create",{layer:a,layerView:f});return b.resolve(f)}),g.set(a,f),f.always(this.refresh))};e.prototype._disposeLayerView=
function(a,b){if(this._promisesMap.has(b)&&(this._promisesMap.get(b).cancel(),this._promisesMap.delete(b),a)){b=a.layer;var c=a.view;this.factory.dispose(a);a.layer=a.parent=a.view=null;this._layerViewsMap.delete(b);b.emit("layerview-destroy",{view:c,layerView:a});c.emit("layerview-destroy",{layer:b,layerView:a})}};return e}(f.declared(e));m([f.property()],a.prototype,"ready",void 0);m([f.property()],a.prototype,"view",void 0);return a=m([f.subclass("esri.views.LayerViewManager")],a)})},"esri/views/LayerViewFactory":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators dojo/Deferred dojo/when ../core/Accessor ../core/Collection ../core/Error ../core/watchUtils".split(" "),
function(a,h,p,m,f,e,l,g,c,b,q){a=function(a){function f(){var b=null!==a&&a.apply(this,arguments)||this;b.creationRequests=new c;b.paused=!0;return b}p(f,a);f.prototype.initialize=function(){var a=this;q.whenFalse(this,"paused",!0)};f.prototype.destroy=function(){this.creationRequests.drain(function(a){return a.deferred.cancel(void 0)})};Object.defineProperty(f.prototype,"working",{get:
enumerable:!0,configurable:!0});f.prototype.create=function(a,c){var f=this.getLayerViewPromise(c);if(f)return f;var g=this.creationRequests,h={deferred:new e(function(){var a=new b("cancelled:layerview-create","layerview creation cancelled",{layer:c});g.remove(h);h.creationPromise&&h.creationPromise.cancel(a);return a}),view:a,layer:c,started:!1,creationPromise:null};g.push(h);this.paused||this._processRequest(h);return h.deferred.promise};f.prototype.dispose=
f.prototype.getLayerViewPromise=function(a){var b=this.creationRequests&&this.creationRequests.find(function(b){return b.layer===a});return b&&b.deferred.promise};f.prototype._processRequest=function(a){var c=this;if(!a.started){a.started=!0;var e=a.deferred,f=a.layer,g=a.view;f.load().then(function(b){if(!e.isCanceled())return a.creationPromise=b.createLayerView(g),a.creationPromise}).then(function(b){return e.isCanceled()?b:a.creationPromise=l(b)}).otherwise(function(a){e.isCanceled()||e.reject(new b("layerview:create-error",
"layerview creation failed",{layer:f,error:a}))}).then(function(b){c.creationRequests&&c.creationRequests.remove(a);e.isFulfilled()?b&&c.dispose(b):e.resolve(b);return b})}};return f}(f.declared(g));m([f.property()],a.prototype,"creationRequests",void 0);m([f.property()],a.prototype,"paused",void 0);m([f.property()],a.prototype,"view",void 0);m([f.property({dependsOn:["paused","creationRequests.length"],readOnly:!0})],a.prototype,"working",null);return a=m([f.subclass("esri.views.LayerViewFactory")],
a)})},"esri/views/BasemapView":function(){define(["../core/Accessor","../core/Collection","../core/watchUtils"],function(a,h,p){return a.createSubclass({declaredClass:"esri.views.BasemapView",properties:{view:{},baseLayerViews:{type:h},referenceLayerViews:{type:h}},constructor:function(){this._loadingHdl=p.init(this,"view.map.basemap",this._loadBasemap)},getDefaults:destroy:_suspendedGetter:function(){return this.view?this.view.suspended:!0},_loadBasemap:)})},"esri/views/GroundView":function(){define(["../core/Accessor","../core/Collection"],function(a,h){return a.createSubclass({declaredClass:"esri.views.GroundView",properties:{view:{},layerViews:{type:h},suspended:{get:},getDefaults:destroy:function(){this.view=null}})})},"esri/views/support/DefaultsFromMap":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators dojo/_base/lang ../../core/Accessor ../../core/watchUtils ../../core/HandleRegistry".split(" "),
function(a,h,p,m,f,e,l,g,c){a=b=function(a){function f(e){e=a.call(this)||this;e.isDone=!1;e.spatialReference=null;e.extent=null;e.mapCollectionPaths=b.DefaultMapCollectionPaths.slice();e._handles=new c;e._waitTask=null;e._isStarted=!1;return e}p(f,a);f.prototype.normalizeCtorArgs=function(a){a=e.mixin({},a);this._set("view",a.view);delete a.view;return a};f.prototype.initialize=function(){var a=this;this.watch("mapCollectionPaths",};f.prototype.destroy=
function(){this._handles&&(this._handles.destroy(),this._handles=null,this._isStarted=!1);this._cancelLoading()};f.prototype.reset=function(){this._handles.removeAll();this._isStarted=!1;this._set("spatialReference",null);this._set("extent",null);this._set("isDone",!1)};f.prototype.start=function(){this._handles.removeAll();this._isStarted=!0;for(var a=this._updateLayerChange.bind(this),b=0;b<this.mapCollectionPaths.length;b++)this._handles.add(g.on(this.view,"map."+this.mapCollectionPaths[b],"change",
a,a,a))};f.prototype.supportedSpatialReferenceForLayer=function(a){if(a.spatialReference&&this.view.isSpatialReferenceSupported(a.spatialReference,a))return a.spatialReference};f.prototype._ownerNameFromCollectionName=function(a){var b=a.lastIndexOf(".");return-1===b?"view":"view."+a.slice(0,b)};f.prototype._ensureLoadedOwnersFromCollectionName=function(a){a=this._ownerNameFromCollectionName(a).split(".");for(var b,c=0;c<a.length;c++){b=this.get(a.slice(0,c+1).join("."));if(!b)break;if(b.load&&!b.isFulfilled())return{owner:null,
loading:b.load()}}return{owner:b}};f.prototype._cancelLoading=function(){this._waitTask=null};f.prototype._updateWhen=function(a){var b=this,c=!0,e=!1,f=a.always(function(){c?e=!0:f===b._waitTask&&b._update()}),c=!1;e||(this._waitTask=f);return e};f.prototype._updateLayerChange=function(){this.spatialReference||this.isDone&&this._set("isDone",!1);this._update()};f.prototype._update=function(){this._cancelLoading();if(!this.isDone){for(var a=!1,b=0;b<this.mapCollectionPaths.length;b++){var c="map."+
this.mapCollectionPaths[b],e=this._ensureLoadedOwnersFromCollectionName(c);if(e.loading&&!this._updateWhen(e.loading)){a=!0;break}e=e.owner;if(!(!e||e.isRejected&&e.isRejected())&&(c=this.view.get(c))&&this._processSpatialReferenceSources(c)){a=!0;break}}a||this._set("isDone",!0);this.isDone&&!this.spatialReference&&this.defaultSpatialReference&&this._set("spatialReference",this.defaultSpatialReference)}};f.prototype._processSpatialReferenceSources=function(a){for(var b=0;b<a.length;b++){var c=a.getItemAt(b);
if(c.load&&!c.isFulfilled()&&!this._updateWhen(c.load()))return!0;if(!c.load||c.isResolved()){var e=c.fullExtent,f=this.supportedSpatialReferenceForLayer(c);!f&&this.extent||!e||this._set("extent",e);if(f)return this._set("spatialReference",f),this._set("isDone",!0),!0;if(c.layers&&this._processSpatialReferenceSources(c.layers))return!0}}return!1};return f}(f.declared(l));a.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"];m([f.property({readOnly:!0})],
a.prototype,"isDone",void 0);m([f.property({readOnly:!0})],a.prototype,"view",void 0);m([f.property({readOnly:!0})],a.prototype,"spatialReference",void 0);m([f.property({readOnly:!0})],a.prototype,"extent",void 0);m([f.property()],a.prototype,"mapCollectionPaths",void 0);m([f.property()],a.prototype,"defaultSpatialReference",void 0);a=b=m([f.subclass("esri.views.support.DefaultsFromMap")],a);var b;return a})},"esri/views/ViewAnimation":function(){define(["../core/declare","dojo/Deferred","../core/Accessor",
"../core/Promise","../core/Scheduler"],function(a,h,p,m,f){var e={RUNNING:"running",FINISHED:"finished",STOPPED:"stopped"};a=a([p,m],{declaredClass:"esri.views.ViewAnimation",properties:{state:{value:null},target:{value:null}},constructor:function(){this._dfd=new h;this.addResolvingPromise(this._dfd.promise)},initialize:stop:function(){this.state=e.STOPPED;f.schedule(this._dfd.resolve)},finish:function(){this.state=e.FINISHED;f.schedule(this._dfd.resolve)}});a.State=
e;return a})},"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderSimple"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderSimple"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 color;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderTexOnly"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4(position, 1.0)).xyz, 1.0);\r\n\t\tvtc \x3d $uv0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderTexOnly"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec4 color;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tgl_FragColor \x3d texColor * color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/ssao.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\t\x3csnippet name\x3d"createFsSSAOSrc"\x3e\x3c![CDATA[\r\n\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D rnm;\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\tuniform float\t\tssaoAtt;\r\n\tuniform vec2\t\trnmScale;\r\n\tuniform float\t\tradius;\r\n\tuniform vec2\t\tnearFar;\r\n\tuniform vec3\t\tpSphere[64];\r\n\r\n\tvarying vec2\t\tuv;\r\n\r\n\tconst\tint\t\t samples \x3d\t$samples;\r\n\tconst\tfloat\t\tstrength \x3d .07;\r\n\tconst\tfloat\t\tfalloff \x3d .000002;\r\n\r\n\t$rgba2float\r\n\tvoid main(void) {\r\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\r\n\t\tfloat currentPixelDepth \x3d rgba2float(texture2D(depthMap, uv));\r\n\t\tvec3 ep \x3d vec3(uv.xy, currentPixelDepth);\r\n\t\tvec3 norm \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, uv).xyz;\r\n\t\tfloat bl \x3d .0;\r\n\t\tfloat f \x3d mix(nearFar.x, nearFar.y, currentPixelDepth) / nearFar.x;\r\n\t\tfloat radD \x3d radius / f;\r\n\t\tradD \x3d min(radD, .5);\r\n\t\tfloat depthDifference;\r\n\t\tvec3 ray;\r\n\r\n\t\tfor(int i \x3d 0; i \x3c samples; ++i) {\r\n\t\t\tray \x3d radD*reflect(pSphere[i], fres);\r\n\t\t\tvec2 tc \x3d ep.xy + sign(dot(ray, norm) ) * ray.xy;\r\n\t\t\tif (tc.x \x3e\x3d .0 \x26\x26 tc.y \x3e\x3d .0 \x26\x26 tc.x \x3c\x3d 1.0 \x26\x26 tc.y \x3c\x3d 1.0) {\r\n\t\t\t\tfloat occluderDepth \x3d rgba2float(texture2D(depthMap, tc));\r\n\t\t\t\tvec3 occluderNormal \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, tc).xyz;\r\n\t\t\t\tdepthDifference \x3d currentPixelDepth - occluderDepth;\r\n\t\t\t\tbl +\x3d step(falloff, depthDifference) * (1.0 - dot(occluderNormal, norm)) * (1.0 - smoothstep(falloff, strength, depthDifference));\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tfloat ao \x3d 1.0 + bl * (-1.38 / float(samples)) * ssaoAtt;\r\n\t\tgl_FragColor.a \x3d ao;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"getDepthLinear"\x3e\x3c![CDATA[\r\n\tfloat getDepthLinear(vec2 ssC) {\r\n\t\treturn -(rgba2float(texture2D(depthMap, ssC))*(nearFar[1] - nearFar[0])+nearFar[0]);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"createFsSSAOSrcObscurance"\x3e\x3c![CDATA[\r\n\tprecision highp float;\r\n\r\n\tuniform mat4 projMatrixInv;\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\r\n\tuniform float     intensity;\r\n\r\n\tuniform float projScale;\r\n\tuniform float     radius;\r\n\tuniform vec2      nearFar;\r\n\r\n\tuniform vec4      projInfo;\r\n\r\n\tconst\tint\t\t samples \x3d\t$samples;\r\n\r\n\tuniform vec2\t  screenDimensions;\r\n\r\n\t//noise texture lookup could be replaced with hash function if WebGL gets XOR functionality\r\n\tuniform vec3\t\tpSphere[64]; //tap position\r\n\tuniform vec2\t\trnmScale;\r\n\tuniform sampler2D rnm; //noise texture\r\n\r\n\t//set z scaling, used to prevent division in ortho mode\r\n\tuniform vec2 zScale;\r\n\r\n\tvarying vec2  uv;\r\n\tvarying vec4  camPos;\r\n\r\n\t$rgba2float\r\n\t$getDepthLinear\r\n\r\n\t/** Returns a unit vector and a screen-space radius for the tap on a unit disk (the caller should scale by the actual disk radius) */\r\n\t/*uniform float numSpiralTurns;\r\n\tvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\r\n\t\t// Radius relative to ssR\r\n\t\tfloat alpha \x3d (float(sampleNumber) + 0.5) * (1.0 / float(samples));\r\n\t\tfloat angle \x3d alpha * (numSpiralTurns * 6.28) + spinAngle;\r\n\r\n\t\tssR \x3d alpha;\r\n\t\treturn vec2(cos(angle), sin(angle));\r\n\t}*/\r\n\r\n\r\n\tfloat radius2 \x3d radius * radius;\r\n\r\n\tfloat fallOffFunction(float vv, float vn, float bias) {\r\n\t\t// A: From the HPG12 paper\r\n\t\t// Note large epsilon to avoid overdarkening within cracks\r\n\t\t// return float(vv \x3c radius2) * max((vn - bias) / (epsilon + vv), 0.0) * radius2 * 0.6;\r\n\r\n\t\t// B: Smoother transition to zero (lowers contrast, smoothing out corners). [Recommended]\r\n\t\tfloat f \x3d max(radius2 - vv, 0.0); return f * f * f * max(vn-bias, 0.0);\r\n\r\n\t\t// C: Medium contrast (which looks better at high radii), no division.  Note that the\r\n\t\t// contribution still falls off with radius^2, but we\'ve adjusted the rate in a way that is\r\n\t\t// more computationally efficient and happens to be aesthetically pleasing.\r\n\t\t// return 4.0 * max(1.0 - vv * invRadius2, 0.0) * max(vn - bias, 0.0);\r\n\r\n\t\t// D: Low contrast, no division operation\r\n\t\t// return 2.0 * float(vv \x3c radius * radius) * max(vn - bias, 0.0);\r\n\t}\r\n\r\n\r\n\t/** Compute the occlusion due to sample point \\a Q about camera-space point \\a C with unit normal \\a n_C */\r\n\tfloat aoValueFromPositionsAndNormal(vec3 C, vec3 n_C, vec3 Q) {\r\n\t\tvec3 v \x3d Q - C;\r\n\t\tfloat vv \x3d dot(v, v);\r\n\t\tfloat vn \x3d dot(normalize(v), n_C);\r\n\t\treturn fallOffFunction(vv, vn, 0.1);\r\n\t}\r\n\r\n\r\n\t/** Reconstruct camera-space P.xyz from screen-space S \x3d (x, y) in\r\n\t\tpixels and camera-space z \x3c 0.  Assumes that the upper-left pixel center\r\n\t\tis at (0.5, 0.5) [but that need not be the location at which the sample tap\r\n\t\twas placed!]\r\n\r\n\t\tCosts 3 MADD.  Error is on the order of 10^3 at the far plane, partly due to z precision.\r\n\t  */\r\n\tvec3 reconstructCSPosition(vec2 S, float z) {\r\n\t\treturn vec3(( (S.xy) * projInfo.xy + projInfo.zw)*(z*zScale.x+zScale.y), z);\r\n\t}\r\n\r\n\tvoid main(void)\r\n\t{\r\n\r\n\t\t//Hash function used in the HPG12 AlchemyAO paper\r\n\t\t//Not supported in WebGL -\x3e using texture lookup as in old SSAO shader instead\r\n\t\t//ivec2 ssC \x3d ivec2(gl_FragCoord.xy);\r\n\t\t//float randomPatternRotationAngle \x3d float((3 * ssC.x ^ ssC.y + ssC.x * ssC.y) * 10);\r\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\r\n\r\n\t   float currentPixelDepth \x3d getDepthLinear(uv);\r\n\r\n\t   if (-currentPixelDepth\x3enearFar.y || -currentPixelDepth\x3cnearFar.x) {\r\n\t\tgl_FragColor \x3d vec4(0);\r\n\t\treturn;\r\n\t   }\r\n\r\n\t   vec3 currentPixelPos \x3d reconstructCSPosition(gl_FragCoord.xy,currentPixelDepth);\r\n\r\n\t   // get the normal of current fragment\r\n\t   vec4 norm4 \x3d texture2D(normalMap, uv);\r\n\t   vec3 norm \x3d vec3(-1.0) + 2.0 * norm4.xyz;\r\n\t   bool isTerrain \x3d norm4.w\x3c0.5;\r\n\r\n\t   float sum \x3d .0;\r\n\r\n\t   vec4 occluderFragment;\r\n\t   vec3 ray;\r\n\r\n\t   vec3 tapPixelPos;\r\n\r\n\t\t//TODO the factor 2.0 should not be necessary, but makes ssao much nicer. bug or deviation from CE somewhere else?\r\n\t   float ps \x3d projScale/(2.0*currentPixelPos.z*zScale.x+zScale.y);\r\n\r\n\t   for(int i \x3d 0; i \x3c samples; ++i)\r\n\t   {\r\n\t\t  // get a vector (randomized inside of a sphere with radius 1.0) from a texture and reflect it\r\n\t\t  //float ssR;\r\n\t\t  //vec2 unitOffset \x3d tapLocation(i, randomPatternRotationAngle, ssR);\r\n\t\t  // get the depth of the occluder fragment\r\n\t\t  //vec2 offset \x3d vec2(-unitOffset*radius*ssR*ps);\r\n\r\n\t\t  vec2 unitOffset \x3d reflect(pSphere[i], fres).xy;\r\n\t\t  vec2 offset \x3d vec2(-unitOffset*radius*ps);\r\n\r\n\r\n\t\t  //don\'t use current or very nearby samples\r\n\t\t  if ( abs(offset.x)\x3c2.0 || abs(offset.y)\x3c2.0) continue;\r\n\r\n\r\n\t\t  vec2 tc \x3d vec2(gl_FragCoord.xy + offset);\r\n\t\t  if (tc.x \x3c 0.0 || tc.y \x3c 0.0 || tc.x \x3e screenDimensions.x || tc.y \x3e screenDimensions.y) continue;\r\n\t\t  vec2 tcTap \x3d tc/screenDimensions;\r\n\t\t  float occluderFragmentDepth \x3d getDepthLinear(tcTap);\r\n\r\n\t\t  if (isTerrain) {\r\n\t\t  \tbool isTerrainTap \x3d texture2D(normalMap, tcTap).w\x3c0.5;\r\n\t\t  \tif (isTerrainTap)\r\n\t\t  \t\tcontinue;\r\n\t\t  }\r\n\r\n\t\t  tapPixelPos \x3d reconstructCSPosition(tc, occluderFragmentDepth);\r\n\r\n\t\t  sum+\x3d aoValueFromPositionsAndNormal(currentPixelPos, norm, tapPixelPos);\r\n\t   }\r\n\r\n\t   // output the result\r\n\r\n\t\tfloat A \x3d max(1.0-sum*intensity/float(samples),0.0);\r\n\r\n\t\t// Anti-tone map to reduce contrast and drag dark region farther\r\n\t\t// (x^0.2 + 1.2 * x^4)/2.2\r\n\t\tA \x3d (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\r\n\r\n\r\n\t   //gl_FragColor \x3d vec4(norm/2.0+0.5, 1.0);\r\n\t   //gl_FragColor \x3d vec4(-currentPixelDepth/1000.0);\r\n\t   //gl_FragColor \x3d vec4(tapPixelPos.x/100.0);\r\n\t   gl_FragColor \x3d vec4(A);\r\n\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsBlurEdgeAware"\x3e\x3c![CDATA[\r\n\tprecision highp float;\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\tuniform sampler2D tex;\r\n\r\n\r\n\tuniform vec2 blurSize;\r\n\r\n\r\n\tuniform float g_BlurFalloff;\r\n\tuniform float projScale;\r\n\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tuniform vec2\t\tnearFar;\r\n\r\n\t//set z scaling, used to prevent division in ortho mode\r\n\tuniform vec2 zScale;\r\n\r\n\t$rgba2float\r\n\t$getDepthLinear\r\n\r\n\tfloat BlurFunction(vec2 uv, float r, float center_d, inout float w_total, float sharpness)\r\n\t{\r\n\t\tfloat c \x3d texture2D(tex, uv).r;\r\n\t\tfloat d \x3d getDepthLinear(uv);\r\n\r\n\t\tfloat ddiff \x3d d - center_d;\r\n\r\n\t\tfloat w \x3d exp(-r*r*g_BlurFalloff - ddiff*ddiff*sharpness);\r\n\r\n\t\tw_total +\x3d w;\r\n\r\n\t\treturn w*c;\r\n\t}\r\n\r\n\tvoid main(void)\r\n\t{\r\n\r\n\t\tfloat b \x3d 0.0;\r\n\t\tfloat w_total \x3d 0.0;\r\n\r\n\t\tfloat center_d \x3d  getDepthLinear(uv);\r\n\r\n\t\tfloat sharpness \x3d -0.05*projScale/(center_d*zScale.x+zScale.y);\r\n\t\tfor (int r \x3d -RADIUS; r \x3c\x3d RADIUS; ++r)\r\n\t\t{\r\n\t\t\tfloat rf \x3d float(r);\r\n\t\t\tvec2 uvOffset \x3d uv + rf*blurSize;\r\n\t\t\tb +\x3d BlurFunction(uvOffset, rf, center_d, w_total, sharpness);\r\n\t\t}\r\n\r\n\t\tgl_FragColor \x3d vec4(b/w_total);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\t\x3csnippet name\x3d"fsBlurSrc0"\x3e\x3c![CDATA[\r\n\tprecision highp float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform float blurSize;\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main() {\r\n\t\tint rad \x3d RADIUS - 1;\r\n\r\n\t\tvec4 sum \x3d vec4(0.0);\r\n\t\tfor (int k \x3d -RADIUS; k \x3c\x3d RADIUS; ++k) { \t\t// NOTE for-variable-init must be a const expression\r\n\t\t\tfloat fi \x3d float(k);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurSrc1"\x3e\x3c![CDATA[\r\n\t\t}\r\n\r\n\t\tgl_FragColor \x3d sum / float(RADIUS * RADIUS);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurH"\x3e\x3c![CDATA[\r\n\t$fsBlurSrc0\r\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x + fi * blurSize, uv.y)) * (float(rad) - abs(fi) + 1.0);\r\n\t$fsBlurSrc1\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurV"\x3e\x3c![CDATA[\r\n\t$fsBlurSrc0\r\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x, uv.y + fi * blurSize)) * (float(rad) - abs(fi) + 1.0);\r\n\t$fsBlurSrc1\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/highlight.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n5-tap gaussian blur with linear sampling\r\nThis technique requires linear filtering on source texture\r\nhttp://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurL5"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[5];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.407333;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.407333;\r\n    blurCoordinates[3] \x3d uv + blurSize * 3.294215;\r\n    blurCoordinates[4] \x3d uv - blurSize * 3.294215;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurL5"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[5];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.093913;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.093913;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n7-tap gaussian blur with sigma\x3d1.5\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurG7"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[7];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurG7"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[7];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.266346;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.215007;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.215007;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.113085;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.113085;\r\n    sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.038735;\r\n    sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.038735;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n9-tap gaussian blur with sigma\x3d2.0\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurG9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurG9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.202360;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.179044;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.179044;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.124009;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.124009;\r\n    sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.067234;\r\n    sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.067234;\r\n    sum +\x3d texture2D(tex, blurCoordinates[7]) * 0.028532;\r\n    sum +\x3d texture2D(tex, blurCoordinates[8]) * 0.028532;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n9-tap manhattan distance\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurM9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurM9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float f0 \x3d texture2D(tex, blurCoordinates[0]).x;\r\n    float f1 \x3d texture2D(tex, blurCoordinates[1]).x - 1.0 / 5.0;\r\n    float f2 \x3d texture2D(tex, blurCoordinates[2]).x - 1.0 / 5.0;\r\n    float f3 \x3d texture2D(tex, blurCoordinates[3]).x - 2.0 / 5.0;\r\n    float f4 \x3d texture2D(tex, blurCoordinates[4]).x - 2.0 / 5.0;\r\n    float f5 \x3d texture2D(tex, blurCoordinates[5]).x - 3.0 / 5.0;\r\n    float f6 \x3d texture2D(tex, blurCoordinates[6]).x - 3.0 / 5.0;\r\n    float f7 \x3d texture2D(tex, blurCoordinates[7]).x - 4.0 / 5.0;\r\n    float f8 \x3d texture2D(tex, blurCoordinates[8]).x - 4.0 / 5.0;\r\n\r\n    vec4 m1 \x3d max(vec4(f1,f2,f3,f4), vec4(f5,f6,f7,f8));\r\n    vec2 m2 \x3d max(m1.xy, m1.zw);\r\n    float m3 \x3d max(f0, max(m2.x, m2.y));\r\n    gl_FragColor \x3d vec4(m3, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n17-tap manhattan+diagonal distance\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurM17"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[17];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    vec2 blurSizeD \x3d vec2(blurSize.x * sign(blurSize.x + blurSize.y), blurSize.y * sign(blurSize.x - blurSize.y));\r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n\r\n    blurCoordinates[ 9] \x3d uv + blurSizeD * 1.0;\r\n    blurCoordinates[10] \x3d uv - blurSizeD * 1.0;\r\n    blurCoordinates[11] \x3d uv + blurSizeD * 2.0;\r\n    blurCoordinates[12] \x3d uv - blurSizeD * 2.0;\r\n    blurCoordinates[13] \x3d uv + blurSizeD * 3.0;\r\n    blurCoordinates[14] \x3d uv - blurSizeD * 3.0;\r\n    blurCoordinates[15] \x3d uv + blurSizeD * 4.0;\r\n    blurCoordinates[16] \x3d uv - blurSizeD * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurM17"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[17];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float f0 \x3d texture2D(tex, blurCoordinates[0]).x;\r\n    float f1 \x3d texture2D(tex, blurCoordinates[1]).x - 1.0 / 5.0;\r\n    float f2 \x3d texture2D(tex, blurCoordinates[2]).x - 1.0 / 5.0;\r\n    float f3 \x3d texture2D(tex, blurCoordinates[3]).x - 2.0 / 5.0;\r\n    float f4 \x3d texture2D(tex, blurCoordinates[4]).x - 2.0 / 5.0;\r\n    float f5 \x3d texture2D(tex, blurCoordinates[5]).x - 3.0 / 5.0;\r\n    float f6 \x3d texture2D(tex, blurCoordinates[6]).x - 3.0 / 5.0;\r\n    float f7 \x3d texture2D(tex, blurCoordinates[7]).x - 4.0 / 5.0;\r\n    float f8 \x3d texture2D(tex, blurCoordinates[8]).x - 4.0 / 5.0;\r\n\r\n    float f9 \x3d texture2D(tex, blurCoordinates[ 9]).x - 1.0 * 1.41421356237 / 5.0;\r\n    float f10 \x3d texture2D(tex, blurCoordinates[10]).x - 1.0 * 1.41421356237 / 5.0;\r\n    float f11 \x3d texture2D(tex, blurCoordinates[11]).x - 2.0 * 1.41421356237 / 5.0;\r\n    float f12 \x3d texture2D(tex, blurCoordinates[12]).x - 2.0 * 1.41421356237 / 5.0;\r\n    float f13 \x3d texture2D(tex, blurCoordinates[13]).x - 3.0 * 1.41421356237 / 5.0;\r\n    float f14 \x3d texture2D(tex, blurCoordinates[14]).x - 3.0 * 1.41421356237 / 5.0;\r\n    float f15 \x3d texture2D(tex, blurCoordinates[15]).x - 4.0 * 1.41421356237 / 5.0;\r\n    float f16 \x3d texture2D(tex, blurCoordinates[16]).x - 4.0 * 1.41421356237 / 5.0;\r\n\r\n    vec4 m1 \x3d max(vec4(f1,f2,f3,f4), vec4(f5,f6,f7,f8));\r\n    vec4 m2 \x3d max(vec4(f9,f10,f11,f12), vec4(f13,f14,f15,f16));\r\n    vec4 m3 \x3d max(m1, m2);\r\n    vec2 m4 \x3d max(m3.xy, m3.zw);\r\n    float m6 \x3d max(f0, max(m4.x, m4.y));\r\n    gl_FragColor \x3d vec4(m6, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n(2N+1)^2-tap distance field\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurDF"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates;\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5);\r\n    blurCoordinates \x3d blurSize;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurDF"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates;\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float result \x3d 0.0;\r\n    for (float x\x3d-5.0; x\x3c\x3d5.0; ++x) {\r\n      for (float y\x3d-5.0; y\x3c\x3d5.0; ++y) {\r\n        vec2 duv \x3d vec2(x, y);\r\n        vec2 uv2 \x3d uv + duv * blurCoordinates;\r\n        result \x3d max(result, texture2D(tex, uv2).x - length(duv) / 5.0);\r\n      }\r\n    }\r\n    gl_FragColor \x3d vec4(result, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\nMerging blurred halos with source image\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightApply"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0); \r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightApply"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  uniform sampler2D origin;\r\n\r\n  uniform vec4 color;\r\n  uniform float exponent;\r\n  uniform float fill;\r\n\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    // Read the highlight intensity from the blurred highlight image\r\n    float highlight \x3d texture2D(tex, uv).x;\r\n\r\n    // Discard all pixels which are not affected by highlight\r\n    if (highlight \x3d\x3d 0.0) {\r\n      discard;\r\n    }\r\n\r\n    // Discard the interior of highlighted objects, so that only the halo remain\r\n    vec4 origin_color \x3d texture2D(origin, uv);\r\n    if (any(notEqual(origin_color,vec4(0,0,0,0)))) {\r\n      gl_FragColor \x3d vec4(color.xyz, fill);\r\n      return;\r\n    }\r\n\r\n    // Transfer function\r\n    // highlight \x3d pow(highlight, 0.5); // increase contrast, for gaussian blur\r\n    // highlight \x3d pow(highlight, 2.0); // decrease constrast, for manhattan distance\r\n    // highlight \x3d tanh(10*highlight); // test\r\n    highlight \x3d smoothstep(0.0, exponent, highlight);\r\n    // highlight \x3d pow(highlight, exponent);\r\n\r\n    // Blending equation: gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n    // I.e., color should not be premultiplied with alpha\r\n    gl_FragColor \x3d vec4(color.xyz, highlight);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/offscreen.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  attribute vec2 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n\r\n  void main(void) {\r\n    gl_Position \x3d vec4(position.xy, 0.0, 1.0);\r\n    vtc \x3d $uv0.xy * 0.5 + 0.5;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  varying vec2 vtc;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor;\r\n  }\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/util.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"matchPixelCenter"\x3e\x3c![CDATA[\r\n\tvec4 matchPixelCenter(vec4 clipCoord, vec2 widthHeight) {\r\n\t\tvec2 xy \x3d vec2(.500123) + .5 * clipCoord.xy / clipCoord.w;\r\n\t\tvec2 ij \x3d floor(xy * widthHeight);\r\n\t\tvec2 pixelSz \x3d vec2(1.0) / widthHeight;\r\n\t\tvec2 result \x3d (((vec2(.5) + ij) * pixelSz) * 2.0 - vec2(1.0)) * clipCoord.w;\r\n\t\treturn vec4(result.x, result.y, clipCoord.z, clipCoord.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"float2rgba"\x3e\x3c![CDATA[\r\n\tvec4 float2rgba(const in float v) {\r\n\t\tvec4 enc \x3d vec4(1.0, 255.0, 65025.0, 16581375.0) * v;\r\n\t\tenc \x3d fract(enc);\r\n\t\tenc -\x3d enc.yzww * vec4(1.0/255.0, 1.0/255.0, 1.0/255.0, 0.0);\r\n\t\treturn enc;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"rgba2float"\x3e\x3c![CDATA[\r\n\tfloat rgba2float(vec4 rgba) {\r\n\t\treturn dot(rgba, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0));\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"calcFragDepth"\x3e\x3c![CDATA[\r\n\t#extension GL_OES_standard_derivatives : enable\r\n\r\n\tfloat calcFragDepth(const in float depth) {\r\n\t\t//calc polygon offset\r\n\t\tconst float SLOPE_SCALE \x3d 2.0;\r\n\t\tconst float BIAS \x3d 2.0 * .000015259;\t\t// 1 / (2^16 - 1)\r\n\t\tfloat m \x3d max(abs(dFdx(depth)), abs(dFdy(depth)));\r\n\t\tfloat result \x3d depth + SLOPE_SCALE * m + BIAS;\r\n\t\treturn clamp(result, .0, .999999);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"evalShadow"\x3e\x3c![CDATA[\r\n\t$rgba2float\r\n\r\n\t// "matrix" parameter used to have const qualifier as well, but IE11 couldn\'t deal with it at time of writing.\r\n\t// once IE11 is fine with it, const should probably be re-introduced\r\n\tfloat evalShadow(const in vec3 vpos, const in float depth, const in sampler2D depthTex, const int num, const in vec4 distance, in mat4 matrix[4], const in float halfPxSz) {\r\n\t\t//choose correct cascade\r\n\t\tint i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\r\n\r\n\t\tif (i \x3e\x3d num) return .0;\r\n\r\n\t\tmat4 mat \x3d i \x3d\x3d 0 ? matrix[0] : i \x3d\x3d 1 ? matrix[1] : i \x3d\x3d 2 ? matrix[2] : matrix[3];\r\n\r\n\t\tvec4 lv \x3d mat * vec4(vpos, 1.0);\r\n\t\tlv.xy /\x3d lv.w;\r\n\r\n\t\t//vertex completely outside? -\x3e no shadow\r\n\t\tvec3 lvpos \x3d .5 * lv.xyz + vec3(.5);\r\n\t\tif (lvpos.z \x3e\x3d 1.0) return .0;\r\n\t\tif (lvpos.x \x3c .0 || lvpos.x \x3e 1.0 || lvpos.y \x3c .0 || lvpos.y \x3e 1.0) return .0;\r\n\r\n\t\t//calc coord in cascade texture\r\n\t\tvec2 uv \x3d vec2(float(i - 2 * (i / 2)) *.5, float(i / 2) * .5) + .5 * lvpos.xy;\r\n\r\n\t\tfloat texSize \x3d .5 / halfPxSz;\r\n\r\n\t\t//filter, offset by half pixels\r\n\t\tvec2 st \x3d fract((vec2(halfPxSz) + uv) * texSize);\r\n\r\n\t\tfloat s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\r\n\t\treturn mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"normal2envTC"\x3e\x3c![CDATA[\r\n\tvec2 normal2envTC(vec3 normal) {\r\n\t\tfloat v \x3d .5 + .5 * asin(normal.y) * 0.63661977;\r\n\t\tfloat u \x3d .5 - .5 * atan(normal.z, normal.x) * 0.31830988;\r\n\t\treturn vec2(u, v);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderShowDepth"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tattribute vec2 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * vec4($position.x, $position.y, .0, 1.0);\r\n\t\tvtc \x3d $uv0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fragmentShaderShowDepth"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D depthTex;\r\n\tvarying vec2 vtc;\r\n\t$rgba2float\r\n\tvoid main() {\r\n\t//\tgl_FragColor \x3d vec4(vec3(texture2D(depthTex, vtc).a), 1.0);\r\n\t\tgl_FragColor \x3d vec4(rgba2float(texture2D(depthTex, vtc)));\r\n\t//\tgl_FragColor \x3d texture2D(depthTex, vtc);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsUVQuad"\x3e\x3c![CDATA[\r\n\tattribute vec2 $position;\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n\t\tuv \x3d $position * .5 + vec2(.5);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"toScreenCoords"\x3e\x3c![CDATA[\r\n\tvec4 toScreenCoords(vec3 vertex) {\r\n\t\tvec4 vClipSpace \x3d proj * view * vec4((model * vec4(vertex, 1.0)).xyz, 1.0);\r\n\t\tvClipSpace.xy *\x3d screenSize;\r\n\t\treturn vClipSpace/abs(vClipSpace.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vvUniforms"\x3e\x3c![CDATA[\r\n#if defined(VV_SIZE) || defined(VV_ROTATION)\r\n\t#define VV_CUSTOM_MODEL_MATRIX\r\n#endif\r\n\r\n#if defined(VV_SIZE)\r\n\tuniform vec3 vvSizeMinSize;\r\n\tuniform vec3 vvSizeMaxSize;\r\n\tuniform vec3 vvSizeOffset;\r\n\tuniform vec3 vvSizeFactor;\r\n#elif defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tuniform vec3 vvSizeValue;\r\n#endif\r\n\r\n#if defined(VV_ROTATION)\r\n\tuniform float vvRotationValue;\r\n#elif defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tuniform mat4 vvRotationValue;\r\n#endif\r\n\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\tuniform vec3 vvAnchorValue;\r\n#endif\r\n\r\n#ifdef VV_COLOR\r\n\t#define VV_COLOR_N 8\r\n\tuniform float vvColorValues[VV_COLOR_N];\r\n\tuniform vec4 vvColorColors[VV_COLOR_N];\r\n#endif\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vvFunctions"\x3e\x3c![CDATA[\r\n// Evaluation of size\r\n#if defined(VV_SIZE)\r\n\tvec3 vvGetScale(vec4 featureAttribute) {\r\n\t\treturn clamp(vvSizeOffset + featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\r\n\t}\r\n#elif defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tvec3 vvGetScale(vec4 featureAttribute) {\r\n\t\treturn vvSizeValue;\r\n\t}\r\n#endif\r\n\r\n// Evaluation of rotation\r\n#if defined(VV_ROTATION)\r\n\tmat4 vvGetRotation(vec4 featureAttribute) {\r\n\t\tfloat angle \x3d featureAttribute.z + vvRotationValue; // add symbol rotation to VV rotation\r\n\r\n\t\tfloat sinA \x3d sin(angle);\r\n\t\tfloat cosA \x3d cos(angle);\r\n\r\n\t\treturn mat4(cosA, -sinA, 0, 0,\r\n\t\t            sinA,  cosA, 0, 0,\r\n\t\t               0,     0, 1, 0,\r\n\t\t               0,     0, 0, 1);\r\n\t}\r\n#elif defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tmat4 vvGetRotation(vec4 featureAttribute) {\r\n\t\treturn vvRotationValue;\r\n\t}\r\n#endif\r\n\r\n// Applying the model matrix\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\tvec4 vvTransformPosition(vec3 position, vec4 featureAttribute) {\r\n\t\treturn vvGetRotation(featureAttribute) * vec4(vvGetScale(featureAttribute) * (position + vvAnchorValue), 1.0);\r\n\t}\r\n\r\n\tvec4 vvTransformNormal(vec3 normal, vec4 featureAttribute) {\r\n\t\t// Normal transform is the inverse transpose of model transform\r\n\t\treturn vvGetRotation(featureAttribute) * vec4(normal / vvGetScale(featureAttribute), 1.0);\r\n\t}\r\n#endif\r\n\r\n#ifdef VV_COLOR\r\n\tvec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\r\n\t\tfloat value \x3d featureAttribute.y;\r\n\t\tif (value \x3c\x3d values[0]) {\r\n\t\t\treturn colors[0];\r\n\t\t}\r\n\r\n\t\tfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n\t\t\tif (values[i] \x3e\x3d value) {\r\n\t\t\t\tfloat f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\r\n\t\t\t\treturn mix(colors[i-1], colors[i], f);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn colors[VV_COLOR_N - 1];\r\n\t}\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"rgb2hsv"\x3e\x3c![CDATA[\r\nvec3 rgb2hsv(vec3 c)\r\n{\r\n\tvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\r\n\tvec4 p \x3d mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\r\n\tvec4 q \x3d mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\r\n\r\n\tfloat d \x3d q.x - min(q.w, q.y);\r\n\tfloat e \x3d 1.0e-10;\r\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"hsv2rgb"\x3e\x3c![CDATA[\r\nvec3 hsv2rgb(vec3 c)\r\n{\r\n\tvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n\tvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"externalColorMixMode"\x3e\x3c![CDATA[\r\n$rgb2hsv\r\n$hsv2rgb\r\n\r\nvec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\r\n  if (mode \x3d\x3d 1 /* multiply */) {\r\n    return internalColor * textureColor * externalColor;\r\n  }\r\n  else if (mode \x3d\x3d 2 /* ignore */ ) {\r\n    return internalColor * textureColor;\r\n  }\r\n  else if (mode \x3d\x3d 3 /* replace */ ) {\r\n    return externalColor;\r\n  }\r\n  else {\r\n    // tint (or something invalid)\r\n    vec3 hsvIn \x3d rgb2hsv(internalColor * textureColor);\r\n    vec3 hsvTint \x3d rgb2hsv(externalColor);\r\n    vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, hsvIn.z * hsvTint.z);\r\n    return hsv2rgb(hsvOut);\r\n  }\r\n}\r\n\r\nfloat mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\r\n  if (mode \x3d\x3d 2 /* ignore */ ) {\r\n    return internalOpacity * textureOpacity;\r\n  }\r\n  else if (mode \x3d\x3d 3 /* replace */ ) {\r\n    return externalOpacity;\r\n  }\r\n  else {\r\n    // multiply or tint (or something invalid)\r\n    return internalOpacity * textureOpacity * externalOpacity;\r\n  }\r\n}\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/BillboardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBillboard"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tconst float size \x3d 1.05;\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\tvec3 zDir \x3d normalize(-pos);\r\n\t\tvec3 xDir \x3d normalize(cross(vec3(.0, 1.0, .0), zDir));\r\n\t\tvec3 yDir \x3d cross(zDir, xDir);\r\n\t\tpos +\x3d xDir * (uv01.x - .5) * size;\r\n\t\tpos +\x3d yDir * (uv01.y - .5) * size;\r\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvtc \x3d uv;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderBillboard"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec3 lightDirection;\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .15) discard;\r\n\t\tgl_FragColor \x3d texColor;\r\n\t\tgl_FragColor.rgb *\x3d lightAmbient.rgb * lightAmbient.w + lightDiffuse.rgb * lightDiffuse.w * dot(lightDirection, vnormal);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBillboardDepth"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec2 nearFar;\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying float depth;\r\n\tconst float size \x3d 1.05;\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\tpos.x +\x3d (uv01.x - .5) * size;\r\n\t\tpos.y +\x3d (uv01.y - .5) * size;\r\n\t\tvec4 eye \x3d vec4(pos, 1.0);\r\n\t\tgl_Position \x3d proj * eye;\r\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\r\n\t\tvtc \x3d uv;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/ColorMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderColorMaterial"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $color;\r\n\r\n\tvarying vec4 vColor; \r\n\r\n\tvoid main(void) {\r\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255;\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderColorMaterial"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 eColor;\r\n\tvarying vec4 vColor;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d vColor * eColor;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/HUDMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"HUDMaterialCommonVariables"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tuniform vec4 viewport;\r\n\tuniform vec3 camPos;\r\n\tuniform float pixelRatio;\r\n\tuniform vec2 screenOffset;\r\n\tuniform vec2 anchorPos;\r\n\tuniform float polygonOffset;\r\n\tuniform float cameraGroundRelative;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec2 $uv0;\r\n\tattribute vec4 $color;\r\n  attribute vec2 $size;\r\n  attribute vec4 $auxpos1;\r\n  attribute vec4 $auxpos2;\r\n\r\n\tvarying vec4 vcolor;\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n \tvarying vec4 vtc;\r\n#else\r\n\tvarying vec2 vtc;\r\n\tvarying vec2 vsize;\r\n\tuniform sampler2D framebufferTex;\r\n\tuniform vec3 markerColor;\r\n#endif\r\n\r\n$vvUniforms\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"matchPixelOrigin"\x3e\x3c![CDATA[\r\n\tvec4 matchPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\r\n\t\tvec2 xy \x3d vec2(.5) + .5 * clipCoord.xy / clipCoord.w;\r\n\t\tvec2 pixelSz \x3d vec2(1.0) / widthHeight;\r\n\t\tvec2 ij \x3d floor((xy + .5 * pixelSz) * widthHeight);\r\n\t\tvec2 result \x3d ((ij * pixelSz) * 2.0 - vec2(1.0)) * clipCoord.w;\r\n\t\treturn vec4(result.x, result.y, clipCoord.z, clipCoord.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"calcPosMatchPixelCenter"\x3e\x3c![CDATA[\r\n\r\n\t\tvec3 posModel \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tvec3 posView \x3d (view * vec4(posModel, 1.0)).xyz;\r\n\r\n\t\tvec3 vnormal \x3d (modelNormal * vec4($normal, 1.0)).xyz;\r\n\r\n\t\t// groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise\r\n\t\tfloat pointGroundSign \x3d sign(pointGroundDistance);\r\n\t\tif (pointGroundSign \x3d\x3d 0.0) {\r\n\t\t  pointGroundSign \x3d 1.0;\r\n\t\t}\r\n\r\n\t\tfloat groundRelative \x3d cameraGroundRelative * pointGroundSign;\r\n\t\t// cameraGroundRelative must not be 0 (guaranteed by HUDMaterial.js)\r\n\r\n\t\t// view angle dependent part of polygon offset emulation\r\n\t\t// we take the absolute value because the sign that is dropped is\r\n\t\t// instead introduced using the ground-relative position of the symbol and the camera\r\n\t\tfloat cosAlpha \x3d clamp(dot(vnormal * pointGroundSign, normalize(camPos - posModel)), 0.01, 1.0);\r\n\t\tif (polygonOffset \x3e .0) {\r\n\t\t\tfloat tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\r\n\t\t\tfloat factor \x3d (1.0 - tanAlpha / viewport[2]);\r\n\t\t\t// same side of the terrain\r\n\t\t\tif (groundRelative \x3e 0.0) {\r\n\t\t\t\tposView *\x3d factor;\r\n\t\t\t}\r\n\t\t\t// opposite sides of the terrain\r\n\t\t\telse {\r\n\t\t\t\tposView /\x3d factor;\r\n\t\t\t}\r\n\t\t}\r\n\r\n    \tposView +\x3d centerOffset;\r\n\r\n\t\tvec4 posProj \x3d proj * vec4(posView, 1.0);\r\n\r\n\t\t// constant part of polygon offset emulation\r\n\t\tposProj.z -\x3d groundRelative * polygonOffset * posProj.w;\r\n\r\n\t\tposProjCenter \x3d matchPixelCenter(posProj, viewport.zw);\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUD"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n\r\n\t$matchPixelCenter\r\n\t$matchPixelOrigin\r\n\t$vvFunctions\r\n\r\n\tvoid main(void) {\r\n\r\n\t\tvec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n\r\n#ifdef VV_SIZE\r\n\t\t// only use width (.xx) for proportional scaling\r\n\t\t// (if no width was defined in vv, width\r\n\t\t//  will be a copy of height vv)\r\n\t\tvec2 inputSize \x3d vvGetScale($auxpos2).xx * $size;\r\n#else\r\n\t\tvec2 inputSize \x3d $size;\r\n#endif\r\n\r\n\t\tvec2 combinedSize \x3d inputSize * pixelRatio;\r\n\r\n\t\tvec4 posProjCenter;\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\t\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\t\tfloat dist \x3d distance(camPos, posModel);\r\n\t\t\tposProj.xy +\x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffset)/ viewport.zw * posProj.w;\r\n\t\t\tvtc.xy \x3d uv;\r\n\t\t\tvsize \x3d inputSize;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tgl_Position \x3d matchPixelOrigin(posProj, viewport.zw);\r\n\r\n#ifdef VV_COLOR\r\n\t\tvcolor \x3d vvGetColor($auxpos2, vvColorValues, vvColorColors);\r\n#else\r\n\t\tvcolor \x3d $color / 255.0;\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDWorldScale"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n\r\n\tuniform vec2 minMaxWorldSizeFactor;\r\n\r\n\t$matchPixelCenter\r\n\t$vvFunctions\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n#ifdef VV_SIZE\r\n\t\tvec2 combinedSize \x3d vvGetScale($auxpos2).xy * $size;\r\n#else\r\n\t\tvec2 combinedSize \x3d $size;\r\n#endif\r\n\r\n\t\tvec4 posProjCenter;\r\n\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\t\t\tfloat scale \x3d 1.0;\r\n\t\t\tvec2 minMaxWorldSize \x3d distance(camPos, position)*minMaxWorldSizeFactor;\r\n\t\t\tif (minMaxWorldSize.x \x3e combinedSize.y)\r\n\t\t\t\tscale \x3d minMaxWorldSize.x / combinedSize.y;\r\n\t\t\telse if (minMaxWorldSize.y \x3e 0.0)\r\n\t\t\t\tscale \x3d min(1.0, minMaxWorldSize.y / combinedSize.y);\r\n\r\n\t\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\t\tposView.xy +\x3d (uv01 - anchorPos) * combinedSize * scale;\r\n\t\t\tvtc.xy \x3d uv;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tposProj \x3d proj * vec4(posView,1.0);\r\n\t\tposProj.xy +\x3d screenOffset / viewport.zw * posProj.w;\r\n\t\tgl_Position \x3d posProj;\r\n\r\n#ifdef VV_COLOR\r\n\t\tvcolor \x3d vvGetColor($auxpos2, vvColorValues, vvColorColors);\r\n#else\r\n\t\tvcolor \x3d $color / 255.0;\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\r\n\x3csnippet name\x3d"calcLabelDirections"\x3e\x3c![CDATA[\r\n\tvec2 uv01 \x3d floor($uv0);\r\n\tvec2 uv \x3d $uv0 - uv01;\r\n\r\n\tvec3 labelDir, labelDirOrtho;\r\n\r\n\tint isUp \x3d 0;\r\n\tvec2 vId \x3d (uv01 - vec2(.5, .5))*2.0;\r\n\r\n\tvec3 viewDirInNormalPlane \x3d normalize(camDir.xyz - dot(camDir.xyz, direction)*direction);\r\n\tfloat angleToNormal \x3d abs(dot(viewDirInNormalPlane,up));\r\n\tfloat angleToDirection \x3d abs(dot(camDir.xyz, direction));\r\n\tif (angleToDirection \x3c 0.985 \x26\x26 angleToNormal \x3c 0.500)\r\n\t{\r\n\t    if (angleToNormal \x3c 0.422) {\r\n\t\t    isUp \x3d 1;\r\n\t\t    labelDir \x3d direction;\r\n\t\t    labelDirOrtho \x3d up;\r\n\t\t    vId.y +\x3d 0.5;\r\n\t\t} else {\r\n\t\t    labelDir \x3d direction;\r\n            labelDirOrtho \x3d cross(viewDirInNormalPlane, direction);\r\n            vId.y +\x3d dot(labelDirOrtho, up)*0.5;\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tlabelDir \x3d direction;\r\n\t\tlabelDirOrtho \x3d normalize(cross(up,direction));\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDDirection"\x3e\x3c![CDATA[\r\n  $HUDMaterialCommonVariables\r\n  uniform vec3 direction;\r\n\r\n  $matchPixelCenter\r\n\t$vvFunctions\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n#ifdef VV_SIZE\r\n\t\tvec2 inputSize \x3d vvGetScale($auxpos2).xy * $size;\r\n#else\r\n\t\tvec2 inputSize \x3d $size;\r\n#endif\r\n\t\tvec2 combinedSize \x3d inputSize * pixelRatio;\r\n\r\n        vec4 posProjCenter;\r\n \t\t$calcPosMatchPixelCenter\r\n\r\n \t\tvec3 up \x3d vnormal;\r\n \t\tvec3 camDir \x3d normalize(vec3(view[0][2],view[1][2],view[2][2]));\r\n\r\n #ifdef OCCL_TEST\r\n \t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n #endif\r\n\r\n \t\t\t$calcLabelDirections\r\n\r\n\t\t    float scale;\r\n\t\t    if (proj[2][3] !\x3d 0.0)  // perspective projection\r\n \t\t\t    scale \x3d posProj.w*0.5/viewport[2];\r\n \t\t\telse                    // othographic projection\r\n \t\t\t    scale \x3d 2.0/proj[0][0]/viewport[2];\r\n\r\n \t\t\tposModel.xyz +\x3d labelDir * vId.x * combinedSize.x * scale ;\r\n \t\t\tposModel.xyz +\x3d labelDirOrtho * vId.y * combinedSize.y * scale;\r\n\r\n      // capability to flip upside down was lost when label texture atlases were implemented. this was the old code:\r\n \t\t\t//vec4 posDirProj \x3d proj*view*model * vec4($position+direction, 1.0);\r\n \t\t\t//vec4 posProjUnmodified \x3d proj*view*model * vec4($position, 1.0);\r\n \t\t\t//if (posDirProj.x \x3c posProjUnmodified.x)\r\n \t\t\t//{\r\n \t\t\t//\tif (isUp\x3d\x3d1)\r\n \t\t\t//\t\tuv.x \x3d texScale.x-uv.x;\r\n \t\t\t//\telse\r\n \t\t\t//\t\tuv \x3d texScale-uv;\r\n \t\t\t//}\r\n \t\t\tvtc.xy \x3d uv;\r\n #ifdef OCCL_TEST\r\n \t\t} else {\r\n \t\t\tvtc \x3d vec2(.0);\r\n \t\t}\r\n #endif\r\n\r\n #ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n \t\tvec4 pos4 \x3d proj * view * vec4(posModel,1.0);\r\n \t\tgl_Position \x3d pos4;\r\n\r\n#ifdef VV_COLOR\r\n\t\tvcolor \x3d vvGetColor($auxpos2, vvColorValues, vvColorColors);\r\n#else\r\n\t\tvcolor \x3d $color / 255.0;\r\n#endif\r\n \t}\r\n ]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDDirectionWorldScale"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n\r\n\tuniform vec2 minMaxWorldSizeFactor;\r\n\tuniform vec3 direction;\r\n\r\n\t$matchPixelCenter\r\n\t$matchPixelOrigin\r\n\t$vvFunctions\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n#ifdef VV_SIZE\r\n\t\tvec2 combinedSize \x3d vvGetScale($auxpos2).xy * $size;\r\n#else\r\n\t\tvec2 combinedSize \x3d $size;\r\n#endif\r\n\r\n\t\tvec4 posProjCenter;\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n\t\tvec3 up \x3d vnormal;\r\n\t\tvec3 camDir \x3d normalize(vec3(view[0][2],view[1][2],view[2][2]));\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\r\n\t\t\t$calcLabelDirections\r\n\r\n\t\t\tfloat scale \x3d 1.0;\r\n\t\t\tvec2 minMaxWorldSize \x3d minMaxWorldSizeFactor;\r\n\t\t\tif (proj[2][3] !\x3d 0.0)  // perspective projection\r\n\t\t\t\tminMaxWorldSize \x3d distance(camPos, position)*minMaxWorldSizeFactor;\r\n\t\t\tif (minMaxWorldSize.x \x3e combinedSize.y)\r\n\t\t\t\tscale \x3d 0.5 * minMaxWorldSize.x / combinedSize.y;\r\n\t\t\telse if (minMaxWorldSize.y \x3e 0.0)\r\n\t\t\t\tscale \x3d 0.5 * min(1.0, minMaxWorldSize.y / combinedSize.y);\r\n\r\n\t\t\tposModel.xyz +\x3d labelDir*vId.x*combinedSize.x*scale;\r\n\t\t\tposModel.xyz +\x3d labelDirOrtho*vId.y*combinedSize.y*scale;\r\n\r\n      // capability to flip upside down was lost when label texture atlases were implemented. this was the old code:\r\n\t\t\t//vec4 posDirProj \x3d proj*view*model * vec4($position+direction, 1.0);\r\n\t\t\t//vec4 posProjUnmodified \x3d proj*view*model * vec4($position, 1.0);\r\n \t\t\t//if (posDirProj.x\x3cposProjUnmodified.x)\r\n \t\t\t//{\r\n \t\t\t//\tif (isUp\x3d\x3d1)\r\n \t\t\t//\t\tuv.x \x3d texScale.x-uv.x;\r\n \t\t\t//\telse\r\n \t\t\t//\t\tuv \x3d texScale-uv;\r\n \t\t\t//}\r\n \t\t\t//uv.y +\x3d (1.0 - texScale.y);\r\n\t\t\tvtc.xy \x3d uv;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tvec4 pos4 \x3d proj * view * vec4(posModel,1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\r\n#ifdef VV_COLOR\r\n\t\tvcolor \x3d vvGetColor($auxpos2, vvColorValues, vvColorColors);\r\n#else\r\n\t\tvcolor \x3d $color / 255.0;\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDBase"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\t#extension GL_OES_standard_derivatives : require\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec4 overrideColor;\r\n\tuniform vec4 outlineColor;\r\n\tuniform float outlineSize;\r\n\r\n\tvarying vec4 vcolor;\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvarying vec4 vtc;\r\n\tuniform vec3 markerColor;\r\n\tuniform sampler2D framebufferTex;\r\n#else\r\n\tvarying vec2 vtc;\r\n\tvarying vec2 vsize;\r\n#endif\r\n\r\n\tvoid main() {\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n   \t\tif (texture2D(framebufferTex, vtc.zw).rgb !\x3d markerColor)\r\n   \t\t\tdiscard;\r\n#endif\r\n\r\n#ifdef SIGNED_DISTANCE_FIELD\r\n\t\tvec4 color \x3d vec4(0.0, 0.0, 0.0, 0.0);\r\n\t\tvec4 fillPixelColor \x3d overrideColor * vcolor;\r\n\r\n\t\t// Attempt to sample texel centers to avoid thin cross outline\r\n\t\t// disappearing with large symbol sizes.\r\n\t\t// see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041\r\n\t\tconst float txSize \x3d 128.0;\r\n\t\tvec2 scaleFactor \x3d ((vsize - txSize) / txSize);\r\n\t\tvec2 samplePos \x3d vtc + vec2(1.0, -1.0) * (1.0 / txSize) * scaleFactor;\r\n\r\n\t\t// Distance in [-0.5, 0.5]\r\n\t\tfloat d \x3d dot(texture2D(tex, samplePos), vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0)) - 0.5;\r\n\r\n\t\t// Work around loss of precision for \'d \x3d 0.0\'.\r\n\t\t// \'0\' gets normalised to 0.5 * 256 \x3d 128 before float packing, but can only\r\n\t\t// be stored in the texture as 128 / 255 \x3d 0.502.\r\n\t\t// see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603110\r\n\t\tconst float diff \x3d (128.0/255.0 - 0.5);\r\n\r\n\t\t// adjust all values, not just those close to 0, to avoid discontinuities in\r\n\t\t// the outlines of other shapes e.g. circles\r\n\t\td \x3d d - diff;\r\n\r\n\t\t// Distance in output units\r\n\t\tfloat dist \x3d d * vsize.x;\r\n\r\n\t\tfillPixelColor.a *\x3d clamp(0.5 - dist, 0.0, 1.0);\r\n\r\n\t\tif (outlineSize \x3e 0.25) {\r\n\t\t\tvec4 outlinePixelColor \x3d outlineColor;\r\n\t\t\tfloat clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\r\n\t\t\toutlinePixelColor.a *\x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\r\n\r\n\t\t\t// perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\r\n\t\t\tfloat compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\r\n\t\t\tvec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\r\n\t\t\t\tvec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\r\n\t\t\tcompositeColor /\x3d compositeAlpha;\r\n\r\n\t\t\tgl_FragColor \x3d vec4(compositeColor, compositeAlpha);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tgl_FragColor \x3d fillPixelColor;\r\n\t\t}\r\n\r\n\t\t// visualize SDF:\r\n\t\t// gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d texture2D(tex, vtc, -0.5) * overrideColor * vcolor;\r\n#endif\r\n\r\n\t\tif (gl_FragColor.a \x3c 0.1) {\r\n\t\t\tdiscard;\r\n\t\t}\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUD"\x3e\x3c![CDATA[\r\n$fragmentShaderHUDBase\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDHighlight"\x3e\x3c![CDATA[\r\n$fragmentShaderHUDBase\r\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderOcclusionTestPixel"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tuniform vec4 viewport;\r\n\tuniform vec3 camPos;\r\n\tuniform float polygonOffset;\r\n\tuniform float cameraGroundRelative;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec4 $auxpos1;\r\n\r\n\t$matchPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t    vec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n\r\n\t    vec4 posProjCenter;\r\n\t    if (dot($position, $position) \x3e 0.0) {\r\n\t\t    $calcPosMatchPixelCenter\r\n\t\t} else {\r\n\t\t    posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\r\n\t\t}\r\n\r\n\t\tgl_Position \x3d posProjCenter;\r\n\t\tgl_PointSize \x3d 1.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/LeafCardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderLeafCard"\x3e\r\n\t\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $normal;\r\n\tattribute vec4 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tvarying float ambientLeaf;\r\n\r\n\tuniform float trafoScale;\r\n\tvarying vec3 vpos;\r\n\r\n\tvec2 rotate(vec2 pos, float angle) {\r\n\t\tfloat c \x3d cos(angle);\r\n\t\tfloat s \x3d sin(angle);\r\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n\t}\r\n\r\n\tvoid main(void) {\r\n\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0.xy);\r\n\t\tvec2 uv \x3d $uv0.xy - uv01;\r\n\r\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\r\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\r\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\r\n\r\n\t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w *trafoScale;\r\n\t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w *trafoScale;;\r\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvtc \x3d uv;\r\n\t\tambientLeaf \x3d normal.w;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal.xyz, 1.0)).xyz);\r\n\t}\r\n]]\x3e\r\n\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderLeafCard"\x3e\r\n\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec3 camPos;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\r\n\tuniform vec3 ambient;\r\n\tuniform vec3 diffuse;\r\n\tuniform vec3 specular;\r\n\tuniform float shininess;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tvarying float ambientLeaf;\r\n\r\n\tvarying vec3 vpos;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\r\n\t\tvec3 a \x3d ambient * lightAmbient.rgb * lightAmbient.w;\r\n\t\tvec3 d \x3d diffuse * lightDiffuse.rgb * lightDiffuse.w * clamp(dot(vnormal, lightDirection), .0, 1.0);\r\n\r\n\t\tvec3 reflDir \x3d normalize(reflect(vpos - camPos, vnormal));\r\n\t\tfloat specDot \x3d max(dot(reflDir, lightDirection), .001);\r\n\t\tvec3 s \x3d specular * lightSpecular.rgb * lightSpecular.w * pow(specDot, shininess);\r\n\r\n\t\tgl_FragColor \x3d vec4(ambientLeaf * texColor.rgb * (a + d) + s, texColor.a);\r\n\r\n\t\t//gl_FragColor \x3d vec4(ambient,1.0);\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderLeafCardDepth"\x3e\x3c![CDATA[\r\n   \tuniform mat4 proj;\r\n   \tuniform mat4 view;\r\n   \tuniform mat4 model;\r\n   \tuniform vec2 nearFar;\r\n\r\n   \tattribute vec3 $position;\r\n   \tattribute vec4 $uv0;\r\n\r\n   \tuniform float trafoScale;\r\n\r\n   \tvarying vec2 vtc;\r\n   \tvarying float depth;\r\n\r\n   \tvec2 rotate(vec2 pos, float angle) {\r\n   \t\tfloat c \x3d cos(angle);\r\n   \t\tfloat s \x3d sin(angle);\r\n   \t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n   \t}\r\n\r\n   \tvoid main(void) {\r\n   \t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n   \t\tvec2 uv01 \x3d floor($uv0.xy);\r\n   \t\tvec2 uv \x3d $uv0.xy - uv01;\r\n\r\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\r\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\r\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\r\n\r\n   \t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w*trafoScale;\r\n   \t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w*trafoScale;\r\n   \t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n   \t\tgl_Position \x3d pos4;\r\n   \t\tvtc \x3d uv;\r\n\r\n   \t\tdepth \x3d (-pos.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\r\n\r\n   \t}\r\n ]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/Material.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n#ifdef INSTANCED\r\n    attribute mat4 model;\r\n    attribute mat4 modelNormal;\r\n#else\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n#endif\r\n#ifdef INSTANCEDCOLOR\r\n\tattribute vec4 instanceColor;\r\n#endif\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tvarying vec3 vpos;\r\n\tvarying vec3 vnormal;\r\n\r\n#ifdef VERTEXCOLORS\r\n\tattribute vec4 $color;\r\n#endif\r\n\r\n#if defined(VV_SIZE) || defined(VV_COLOR) || defined(VV_ROTATION)\r\n\tattribute vec4 instanceFeatureAttribute;\r\n#endif\r\n\r\n$vvUniforms\r\n\r\n#if defined(VERTEXCOLORS)\r\n\tvarying vec4 vcolor;\r\n#endif\r\n\r\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR)\r\n\tuniform vec4 externalColor;\r\n\tvarying vec4 vcolorExt;\r\n#endif\r\n\r\n\t$vvFunctions\r\n\r\n\tvoid main(void) {\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\t\tvpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\r\n\t\tvnormal \x3d normalize((modelNormal * vvTransformNormal($normal, instanceFeatureAttribute)).xyz);\r\n#else\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\r\n#endif\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\r\n#ifdef VERTEXCOLORS\r\n\t\tvcolor \x3d $color * 0.003921568627451; // \x3d 1/255\r\n#endif\r\n\r\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR)\r\n\t\tvcolorExt \x3d externalColor;\r\n#endif\r\n#ifdef INSTANCEDCOLOR\r\n\t\tvcolorExt *\x3d instanceColor;\r\n#endif\r\n#ifdef VV_COLOR\r\n\t\tvcolorExt *\x3d vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongSrc"\x3e\x3c![CDATA[\r\n\tuniform vec3 camPos;\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\tuniform vec3 ambient;\r\n\tuniform vec3 diffuse;\r\n\tuniform vec3 specular;\r\n\tuniform float shininess;\r\n\tuniform float opacity;\r\n\tuniform sampler2D depthTex;\r\n\tuniform int shadowMapNum;\r\n\tuniform vec4 shadowMapDistance;\r\n\tuniform mat4 shadowMapMatrix[4];\r\n\tuniform float depthHalfPixelSz;\r\n\tuniform sampler2D ssaoTex;\r\n\tuniform vec4 viewportPixelSz;\r\n\tuniform int externalColorMixMode;\r\n\tvarying vec3 vpos;\r\n\tvarying vec3 vnormal;\r\n#if defined(VERTEXCOLORS)\r\n\tvarying vec4 vcolor;\r\n#endif\r\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR)\r\n\tvarying vec4 vcolorExt;\r\n#else\r\n\tuniform vec4 externalColor;\r\n#endif\r\n\r\n#ifdef RECEIVE_SHADOWS\r\n\t$evalShadow\r\n#endif\r\n\r\n\t$externalColorMixMode\r\n\r\n\tvoid main() {\r\n\t\tvec3 a \x3d lightAmbient.rgb * lightAmbient.w;\r\n\r\n\t\tvec3 viewDir \x3d normalize(vpos - camPos);\r\n\r\n#ifndef DOUBLESIDED\r\n\t\tvec3 normal \x3d vnormal;\r\n#else\r\n\t\tvec3 normal \x3d dot(vnormal, viewDir)\x3e0.0?-vnormal:vnormal;\r\n#endif\r\n\r\n\t\tnormal \x3d normalize(normal);\r\n\t\tfloat shadow \x3d 0.0;\r\n#ifdef RECEIVE_SHADOWS\r\n\t\tshadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n#endif\r\n\t\tvec3 d \x3d (1.0 - shadow) * lightDiffuse.rgb * lightDiffuse.w * clamp(dot(normal, lightDirection), .0, 1.0);\r\n\r\n\t\tvec3 reflDir \x3d normalize(reflect(viewDir, normal));\r\n\t\tfloat specDot \x3d max(dot(reflDir, lightDirection), .001);\r\n\t\tvec3 s \x3d (1.0 - shadow) * specular * lightSpecular.rgb * lightSpecular.w * pow(specDot, shininess);\r\n\r\n#ifdef RECEIVE_SSAO\r\n\t\tfloat ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\r\n\t\tssao \x3d viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\r\n#else\r\n\t\tfloat ssao \x3d 1.0;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"externalColorMixTexture"\x3e\x3c![CDATA[\r\n#if defined(VERTEXCOLORS) \x26\x26 (defined(INSTANCEDCOLOR) || defined(VV_COLOR))\r\n\t\t// Internal colors: varying vcolor + uniform ambient/diffuse, external colors: varying vcolorExt\r\n\t\ta \x3d a * mixExternalColor(vcolor.rgb * ambient, texColor.rgb, vcolorExt.rgb, externalColorMixMode);\r\n\t\td \x3d d * mixExternalColor(vcolor.rgb * diffuse, texColor.rgb, vcolorExt.rgb, externalColorMixMode);\r\n\t\tfloat opacity_ \x3d mixExternalOpacity(vcolor.a * opacity, texColor.a, vcolorExt.a, externalColorMixMode);\r\n#elif defined(VERTEXCOLORS)\r\n\t\t// Internal colors: varying vcolor + uniform ambient/diffuse, external colors: uniform externalColor\r\n\t\ta \x3d a * mixExternalColor(vcolor.rgb * ambient, texColor.rgb, externalColor.rgb, externalColorMixMode);\r\n\t\td \x3d d * mixExternalColor(vcolor.rgb * diffuse, texColor.rgb, externalColor.rgb, externalColorMixMode);\r\n\t\tfloat opacity_ \x3d mixExternalOpacity(vcolor.a * opacity, texColor.a, externalColor.a, externalColorMixMode);\r\n#elif defined(INSTANCEDCOLOR) || defined(VV_COLOR)\r\n\t\t// Internal colors: uniform ambient/diffuse, external colors: varying vcolorExt\r\n\t\ta \x3d a * mixExternalColor(ambient, texColor.rgb, vcolorExt.rgb, externalColorMixMode);\r\n\t\td \x3d d * mixExternalColor(diffuse, texColor.rgb, vcolorExt.rgb, externalColorMixMode);\r\n\t\tfloat opacity_ \x3d mixExternalOpacity(opacity, texColor.a, vcolorExt.a, externalColorMixMode);\r\n#else\r\n\t\t// Internal colors: uniform ambient/diffuse, external colors: uniform externalColor\r\n\t\ta \x3d a * mixExternalColor(ambient, texColor.rgb, externalColor.rgb, externalColorMixMode);\r\n\t\td \x3d d * mixExternalColor(diffuse, texColor.rgb, externalColor.rgb, externalColorMixMode);\r\n\t\tfloat opacity_ \x3d mixExternalOpacity(opacity, texColor.a, externalColor.a, externalColorMixMode);\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"externalColorMix"\x3e\x3c![CDATA[\r\n\tvec4 texColor \x3d vec4(1,1,1,1);\r\n\t$externalColorMixTexture\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhong"\x3e\x3c![CDATA[\r\n\t$vsPhongSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhong"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\t$fsPhongSrc\r\n\t$externalColorMix\r\n\t\tgl_FragColor \x3d vec4(ssao * (a + d) + s, opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsPhongSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\t$fsPhongSrc\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\t$externalColorMixTexture\r\n\t\tgl_FragColor \x3d vec4(ssao * (a + d) + s, opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongAtlasTextured"\x3e\x3c![CDATA[\r\n\tattribute vec4 $uv0;\r\n\tattribute vec4 $region;\r\n\tvarying vec2 vtc;\r\n\tvarying vec4 regionV;\r\n\t$vsPhongSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0.xy;\r\n#else\r\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t\tregionV \x3d $region/65535.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongAtlasTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec2 texSize;\r\n\tvarying vec2 vtc;\r\n\tvarying vec4 regionV;\r\n\r\n\t float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\r\n\t\t// from:\r\n\t\t//   - OpenGLES Common Profile Specification Version 2.0.25, Section 3.7.7 - Texture Minification\r\n\t\t//   - https://www.opengl.org/discussion_boards/showthread.php/171485-Texture-LOD-calculation-(useful-for-atlasing)\r\n\t\t//   - http://www.linedef.com/virtual-texture-demo.html\r\n\t\tfloat deltaMaxSqr \x3d max(dot(ddx, ddx), dot(ddy, ddy));\r\n\t\treturn max(0.5 * log2(deltaMaxSqr), 0.0);\r\n\t}\r\n\r\n\t$fsPhongSrc\r\n\t\tvec2 uv \x3d vtc;\r\n\t\tuv \x3d fract(uv);\r\n\t\t//[umin, vmin, umax, vmax]\r\n\r\n\t\tvec2 atlasScale \x3d regionV.zw - regionV.xy;\r\n\t\tuv \x3d uv.xy * atlasScale + regionV.xy;\r\n\r\n\t\tvec4 texColor;\r\n\t\t#ifdef GL_OES_standard_derivatives\r\n\t\t\t#extension GL_OES_standard_derivatives : enable\r\n\r\n\t\t\t// calculate derivative of continuous texture coordinate\r\n\t\t\t// to avoid mipmapping artifacts caused by manual wrapping in shader\r\n\t\t\tvec2 dUVdx \x3d dFdx(vtc) * atlasScale;\r\n\t\t\tvec2 dUVdy \x3d dFdy(vtc) * atlasScale;\r\n\r\n\t\t\t#ifdef GL_EXT_shader_texture_lod\r\n\t\t\t\t#extension GL_EXT_shader_texture_lod : enable\r\n\r\n\t\t\t\t// workaround for artifacts in Windows 10 using Intel HD Graphics 4000 series\r\n\t\t\t\t// see: https://devtopia.esri.com/Zurich-R-D-Center/arcgis-js-api-canvas3d-issues/issues/768\r\n\t\t\t\tconst float epsilon \x3d 1.0E-32;\r\n\t\t\t\tfloat zeroUVShift \x3d uv.x \x3d\x3d 0.0 \x26\x26 uv.y \x3d\x3d 0.0 ? epsilon : 0.0;\r\n\r\n\t\t\t\ttexColor \x3d texture2DGradEXT(tex, uv + zeroUVShift, dUVdx, dUVdy);\r\n\t\t\t#else\r\n\t\t\t\t// use bias to compensate for difference in automatic vs desired mipmap level\r\n\t\t\t\tvec2 dUVdxAuto \x3d dFdx(uv);\r\n\t\t\t\tvec2 dUVdyAuto \x3d dFdy(uv);\r\n\t\t\t\tfloat mipMapLevel \x3d calcMipMapLevel(dUVdx * texSize, dUVdy * texSize);\r\n\t\t\t\tfloat autoMipMapLevel \x3d calcMipMapLevel(dUVdxAuto * texSize, dUVdyAuto * texSize);\r\n\t\t\t\ttexColor \x3d texture2D(tex, uv, mipMapLevel - autoMipMapLevel);\r\n\t\t\t#endif\r\n\t\t#else\r\n\t\t\ttexColor \x3d texture2D(tex, uv);\r\n\t\t#endif\r\n\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\t$externalColorMixTexture\r\n\t\tgl_FragColor \x3d vec4(ssao * (a + d) + s, opacity_);\r\n\t\t//gl_FragColor \x3d regionV;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongTexturedRefl"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform sampler2D reflTex;\r\n\tuniform float reflectivity;\r\n\tvarying vec2 vtc;\r\n\r\n\t$normal2envTC\r\n\r\n\t$fsPhongSrc\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\tvec4 reflColor \x3d texture2D(reflTex, normal2envTC(reflDir));\r\n\t\t$externalColorMixTexture\r\n\t\tgl_FragColor \x3d vec4(ssao * mix(a + d, reflColor.rgb * lightAmbient.rgb * lightSpecular.w, reflectivity) + s, opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepthSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n#ifdef INSTANCED\r\n\tattribute mat4 model;\r\n#else\r\n\tuniform mat4 model;\r\n#endif\r\n\tuniform vec2 nearFar;\r\n\tattribute vec3 $position;\r\n\tvarying float depth;\r\n\r\n\t$vvUniforms\r\n#if defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tattribute vec4 instanceFeatureAttribute;\r\n#endif\r\n\t$vvFunctions\r\n\r\n\tvoid main(void) {\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\t\tvec4 eye \x3d view * model * vvTransformPosition($position, instanceFeatureAttribute);\r\n#else\r\n\t\tvec4 eye \x3d view * model * vec4($position, 1.0);\r\n#endif\r\n\t\tgl_Position \x3d proj * eye;\r\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepth"\x3e\x3c![CDATA[\r\n\t$vsDepthSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepthTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsDepthSrc\r\n#ifndef FLIPV\r\n        vtc \x3d $uv0;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormalSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n#ifdef INSTANCED\r\n\tattribute mat4 model;\r\n\tattribute mat4 modelNormal;\r\n#else\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n#endif\r\n\tuniform mat4 viewNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tvarying vec3 vnormal;\r\n\r\n\t$vvUniforms\r\n#if defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tattribute vec4 instanceFeatureAttribute;\r\n#endif\r\n\t$vvFunctions\r\n\r\n\tvoid main(void) {\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\t\tgl_Position \x3d proj * view * model * vvTransformPosition($position, instanceFeatureAttribute);\r\n\t\tvnormal \x3d normalize((viewNormal * modelNormal * vvTransformNormal($normal, instanceFeatureAttribute)).xyz);\r\n#else\r\n\t\tgl_Position \x3d proj * view * model * vec4($position, 1.0);\r\n\t\tvnormal \x3d normalize((viewNormal * modelNormal * vec4($normal, 1.0)).xyz);\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormal"\x3e\x3c![CDATA[\r\n\t$vsNormalSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormalTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsNormalSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlightSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n#ifdef INSTANCED\r\n\tattribute mat4 model;\r\n#else\r\n\tuniform mat4 model;\r\n#endif\r\n\tattribute vec3 $position;\r\n\r\n\t$vvUniforms\r\n#if defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tattribute vec4 instanceFeatureAttribute;\r\n#endif\r\n\t$vvFunctions\r\n\r\n\tvoid main(void) {\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\t\tgl_Position \x3d proj * view * model * vvTransformPosition($position, instanceFeatureAttribute);\r\n#else\r\n\t\tgl_Position \x3d proj * view * model * vec4($position, 1.0);\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlight"\x3e\x3c![CDATA[\r\n\t$vsHighlightSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlightTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsHighlightSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepthSrc"\x3e\x3c![CDATA[\r\n\tvarying float depth;\r\n\r\n\tvoid main() {\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepth"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\t$calcFragDepth\r\n\t$float2rgba\r\n\t$fsDepthSrc\r\n#ifndef BIAS_SHADOWMAP\r\n\t\tgl_FragColor \x3d float2rgba(depth);\r\n#else\r\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepthTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\t$calcFragDepth\r\n\t$float2rgba\r\n\r\n\t$fsDepthSrc\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n#ifndef BIAS_SHADOWMAP\r\n\t\tgl_FragColor \x3d float2rgba(depth);\r\n#else\r\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsNormal"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec3 vnormal;\r\n\tvoid main() {\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\r\n\r\n#ifndef ALPHA_ZERO\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\r\n#endif\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsNormalTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec3 vnormal;\r\n\tvarying vec2 vtc;\r\n\tuniform sampler2D tex;\r\n\tvoid main() {\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\r\n#ifndef ALPHA_ZERO\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlight"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\tvarying vec2 vtc;\r\n\tuniform sampler2D tex;\r\n\tvoid main() {\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n    gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/RibbonLineMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsRibbonLine"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\r\n\tuniform float extLineWidth;\r\n\tuniform float nearPlane;\r\n\r\n\tattribute vec3 $position;\t\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tattribute vec4 $color;\r\n\tvarying vec4 vColor;\r\n\r\n\tattribute float size;\r\n\r\n#ifndef WALL\r\n\tuniform float miterLimit;\r\n\tattribute vec3 $auxpos1;\r\n\tattribute vec3 $auxpos2;\r\n#endif\r\n\r\n#ifdef SCREENSCALE\r\n\tuniform vec2 screenSize;\r\n\t$toScreenCoords\r\n#define VECTYPE vec2\r\n#define ZEROVEC vec2(0.0, 0.0)\r\n#define PERPENDICULAR(v) vec2(v.y, -v.x);\r\n#define ISOUTSIDE (left.x * right.y - left.y * right.x)*$uv0.y \x3e 0.0\r\n\r\n#else //ifdef SCREENSCALE\r\n\r\n#define VECTYPE vec3\r\n#define ZEROVEC vec3(0.0, 0.0, 0.0)\r\n// these macros are only valid for "strip" type lines:\r\n#define PERPENDICULAR(v) cross(up/*vec3(0.0, 1.0, 0.0)*/, v)\r\n#define ISOUTSIDE dot(cross(left, right), up/*vec3(0.0, 1.0, 0.0)*/)*$uv0.y \x3c 0.0\r\n\r\n#endif //ifdef SCREENSCALE\r\n\r\n\tfloat interp(float ncp, vec4 a, vec4 b) {\r\n\t\treturn (-ncp - a.z) / (b.z - a.z);\r\n\t}\r\n\r\n#ifdef SCREENSCALE\r\n\r\n  void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next) {\r\n\t\tfloat vnp \x3d nearPlane*0.99;\r\n\r\n\t\t//We have four vertices per point on the line. Start and end vertices \r\n\t\t//are treated differently --\x3e d \x3e 0, d \x3c 0\r\n\t\tfloat d \x3d abs($uv0.y) - 1.1;\r\n\r\n\t\t//current pos behind ncp --\x3e we need to clip\r\n\t\tif(pos.z \x3e -nearPlane) {\t\t\t\r\n\t\t\tif (d \x3c 0.0) {\r\n\t\t\t\t//previous in front of ncp\r\n\t\t\t\tif(prev.z \x3c -nearPlane) {\r\n\t\t\t\t\tpos \x3d mix(prev, pos, interp(vnp, prev, pos));\r\n\t\t\t\t\tnext \x3d pos;\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t  pos \x3d vec4(0, 0, 0, 1);\r\n\t\t\t  }\r\n\t\t\t}\r\n\t\t\t//next in front of ncp\r\n\t\t\tif(d \x3e 0.0) {\r\n\t\t\t\tif(next.z \x3c -nearPlane) {\r\n\t\t\t\t\tpos \x3d mix(pos, next, interp(vnp, pos, next));\r\n\t\t\t\t\tprev \x3d pos;\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpos \x3d vec4(0, 0, 0, 1);\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\telse { \r\n\t\t\t//current position visible \r\n\t\t\t//previous behind ncp\r\n\t\t\tif (prev.z \x3e -nearPlane) {\t\t\t\t\r\n\t\t\t\tprev \x3d mix(pos, prev, interp(vnp, pos, prev));\t\t\t\t\r\n\t\t\t}\t\t\t\t\t\r\n\t\t\t//next behind ncp\r\n\t\t\tif (next.z \x3e -nearPlane) {\r\n\t\t\t\tnext \x3d mix(next, pos, interp(vnp, next, pos));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpos\x3d proj * pos;\r\n\t\tpos.xy *\x3d screenSize;\r\n\t\tpos /\x3d pos.w;\r\n\r\n\t\tnext \x3d proj * next;\r\n\t\tnext.xy *\x3d screenSize;\r\n\t\tnext /\x3d next.w;\r\n\r\n\t\tprev \x3d proj * prev;\r\n\t\tprev.xy *\x3d screenSize;\r\n\t\tprev /\x3d prev.w;\t\t\r\n  }\r\n\r\n#endif // SCREENSCALE\r\n\r\n\tvoid main(void) {\r\n\r\n\tfloat lineWidth \x3d extLineWidth + $size; \r\n\r\n#ifdef SCREENSCALE\r\n\r\n#if 0\r\n\t\tvec4 pos \x3d toScreenCoords($position.xyz);\r\n\t\tvec2 left \x3d (pos - toScreenCoords($auxpos1)).xy;\r\n\t\tvec2 right \x3d (toScreenCoords($auxpos2) - pos).xy;\r\n#else\r\n\t\tvec4 pos  \x3d view * vec4((model * vec4($position.xyz, 1.0)).xyz, 1.0); \r\n\t\tvec4 prev \x3d view * vec4((model * vec4($auxpos1.xyz, 1.0)).xyz, 1.0); \r\n\t\tvec4 next \x3d view * vec4((model * vec4($auxpos2.xyz, 1.0)).xyz, 1.0); \r\n\r\n\t\tclipAndTransform(pos, prev, next);\r\n\r\n\t\tvec2 left \x3d (pos - prev).xy;\r\n\t\tvec2 right \x3d (next - pos).xy;\r\n#endif\r\n\r\n#else // ifdef SCREENSCALE\r\n\t\tvec4 pos \x3d vec4($position, 1.0);\r\n#ifndef WALL\r\n\t\tvec3 left \x3d $position.xyz - $auxpos1;\r\n\t\tvec3 right \x3d $auxpos2 - $position.xyz;\r\n\t\tvec3 up \x3d normalize($position.xyz);\r\n#endif // ifndef WALL\r\n#endif // ifdef SCREENSCALE\r\n\r\n#ifdef WALL\r\n\t\tfloat displacementLen \x3d lineWidth;\r\n\t\tvec3 displacementDir \x3d normalize($position.xyz);//vec3(0.0, 1.0, 0.0);\r\n#else // ifdef WALL\r\n\r\n\t\tfloat leftLen \x3d length(left);\r\n\t\tleft \x3d (leftLen \x3e 0.001) ? left/leftLen : ZEROVEC;\r\n\r\n\t\tfloat rightLen \x3d length(right);\r\n\t\tright \x3d (rightLen \x3e 0.001) ? right/rightLen : ZEROVEC;\r\n\r\n\t\t// determine if vertex is on the "outside or "inside" of the join\r\n\t\tbool isOutside \x3d ISOUTSIDE;\r\n\r\n\t\t// compute miter join position first\r\n\t\tfloat displacementLen \x3d lineWidth;\r\n\t\tVECTYPE displacementDir \x3d normalize(left + right);\r\n\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\r\n\t\tif (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\r\n\t\t\tfloat nDotSeg \x3d dot(displacementDir, left);\r\n\t\t\tdisplacementLen /\x3d length(nDotSeg*left - displacementDir);\r\n\r\n\t\t\t// limit displacement of inner vertices\r\n\t\t\tif (!isOutside)\r\n\t\t\t\tdisplacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\r\n\t\t}\r\n\r\n\t\tif (isOutside \x26\x26 (displacementLen \x3e miterLimit*lineWidth)) {\r\n\t\t\t// convert to bevel join if miterLimit is exceeded\r\n\t\t\tif (leftLen \x3c 0.001)\r\n\t\t\t    displacementDir \x3d right;\r\n\t\t\telse if (rightLen \x3c 0.001)\r\n\t\t\t\tdisplacementDir \x3d left;\r\n\t\t\telse\r\n\t\t\t\tdisplacementDir \x3d (abs($uv0.y) - 1.1 \x3c 0.0) ? left : right;\r\n\t\t\tdisplacementDir \x3d normalize(displacementDir);\r\n\t\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\r\n\t\t\tdisplacementLen \x3d lineWidth;\r\n\t\t}\r\n\r\n#endif // ifdef WALL\r\n\r\n#ifdef SCREENSCALE\r\n\t\tpos.xy +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\r\n\t\tpos.xy /\x3d screenSize;\r\n#else\r\n\t\tpos.xyz +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\r\n\t\tpos \x3d proj * view * model * pos;\r\n#endif\r\n\r\n\t\tvtc \x3d $uv0;\r\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255\r\n\t\tgl_Position \x3d pos;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsRibbonLine"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 eColor;\r\n\tvarying vec4 vColor;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d eColor * vColor;\r\n\t\t//gl_FragColor.a \x3d 1;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/WaterMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderWater"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\tvarying vec3 vpos;\r\n\r\n\tvoid main(void) {\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderWater"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec3 color;\r\n\tuniform float scale;\r\n\tuniform float speed;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\r\n\tuniform vec3 camPos;\r\n\r\n\tuniform sampler2D noiseTex;\r\n\tuniform sampler2D reflTex;\r\n\r\n\tuniform sampler2D depthTex;\r\n\tuniform int shadowMapNum;\r\n\tuniform vec4 shadowMapDistance;\r\n\tuniform mat4 shadowMapMatrix[4];\r\n\tuniform float depthHalfPixelSz;\r\n\r\n\tvarying vec3 vpos;\r\n\r\n\t$evalShadow\r\n\r\n\t$normal2envTC\r\n\r\n\tvec2 rotate(vec2 pos, float angle) {\r\n\t\tfloat c \x3d cos(angle);\r\n\t\tfloat s \x3d sin(angle);\r\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n\t}\r\n\r\n\tfloat compDelta(vec2 pos) {\r\n\t\tconst float PI_THIRD \x3d 1.04719755;\r\n\r\n\t\tfloat result \x3d .0;\r\n\t\tfloat s \x3d 1.0;\r\n\t\tfor (int i \x3d 0; i \x3c 6; ++i) {\r\n\t\t\tvec2 tc \x3d pos / (20.0 * s);\r\n\t\t\ttc +\x3d rotate(vec2(1.0 + speed, .0), PI_THIRD * float(i));\r\n\t\t\tresult +\x3d s * texture2D(noiseTex, tc).r;\r\n\t\t\ts *\x3d 1.5;\r\n\t\t}\r\n\t\treturn result * scale * .2;\r\n\t}\r\n\r\n\tvoid main() {\r\n\t\tvec3 viewVec \x3d normalize(camPos - vpos);\r\n\r\n\t\tfloat d0 \x3d compDelta(vpos.xz);\r\n\t\tfloat dx \x3d compDelta(vpos.xz + vec2(.05, .0));\r\n\t\tfloat dz \x3d compDelta(vpos.xz + vec2(.0, .05));\r\n\r\n\t\tvec3 normal \x3d normalize(vec3(d0 - dx, .05, d0 - dz));\r\n\r\n\t\tfloat fresnel \x3d clamp(1.0 - 1.25 * dot(viewVec, normal), .0, 1.0);\r\n\r\n\t\tfloat shadow \x3d 0.0;\r\n\t\tif (halfPxSz \x3e\x3d .0) {\r\n\t\t\tshadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n\t\t}\r\n\r\n\t\tvec3 reflDir \x3d reflect(-viewVec, normal);\r\n\t\tif (reflDir.y \x3c .02) reflDir.y \x3d 0.04 - reflDir.y;\r\n\r\n\t\tvec3 reflCol \x3d texture2D(reflTex, normal2envTC(reflDir)).rgb * lightAmbient.rgb*lightSpecular.w;\r\n\t\treflCol *\x3d .5 + max(lightDirection.y, .0) * .5; // ?\t+\r\n\t\tvec3 waterColor \x3d color * (lightAmbient.rgb * lightAmbient.w + (1.0 - shadow) * max(lightDirection.y, .0) * lightDiffuse.rgb * lightDiffuse.w);\r\n\t\tvec3 finalColor \x3d mix(waterColor, reflCol, .15 + .6 * fresnel);\r\n\r\n\t\tvec3 spec \x3d pow(max(dot(reflDir, lightDirection), .001), 80.0) * lightSpecular.rgb * lightSpecular.w * 2.0;\r\n\t\tfinalColor +\x3d (1.0 - shadow) * lightDiffuse.w * spec;\r\n\r\n\t\tgl_FragColor \x3d vec4(finalColor, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/BlendLayers.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBlendLayers"\x3e\x3c![CDATA[\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\r\n\tuniform float scale;\r\n\tuniform vec2 offset;\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d vec4($position, 1.0);\r\n\t\tuv \x3d $uv0 * scale + offset;;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderBlendLayers"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform float opacity;\r\n\r\n\tvoid main() {\r\n\t\tvec4 color \x3d texture2D(tex, uv);\r\n\r\n    // Note: output in pre-multiplied alpha for correct alpha compositing\r\n\t\tgl_FragColor \x3d vec4(color.xyz, 1.0) * color.a * opacity;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"*now":"*noref":1}});require.boot&&require.apply(null,require.boot);