/*! For license information please see stat-paywall.js.LICENSE.txt */
(self.webpackChunkstat=self.webpackChunkstat||[]).push([[3743],{7448:function(t,e,s){"use strict";s.d(e,{F:function(){return i}});var n=s(2187);let i=new class{get(t){return n.k.get(t)},6824:function(t,e,s){"use strict";s.d(e,{g:function(){return r}});var n=s(9245),i=s.n(n);const r={AUTH_DOMAIN:i()&&i().authDomain?i().authDomain:"",AUTH_DOMAIN_PROXY_ENABLED:i()&&i().authDomainProxyEnabled,CLIENT_ID:i()&&i().authClientId?i().authClientId:"",AUDIENCE:"https://statnews.auth0.com/userinfo",SCOPE:"openid email",RESPONSE_TYPE:"code",TOKEN_KEY:"stat_paywall_token",STATE_KEY:"stat_paywall_state",NONCE_KEY:"stat_paywall_nonce",PROFILE_KEY:"stat_paywall_profile",NEWSLETTERS_KEY:"stat_newsletters",INVOICES_KEY:"stat_invoices",CUSTOMER_KEY:"stat_customer",SUBSCRIPTION_KEY:"stat_subscription",LOOKUP_KEY:"stat_lookup",CONTACT_KEY:"stat_contact",CUSTOMER_ENDPOINT:"/wp-json/stat-paywall/v1/customer",SUBSCRIPTION_ENDPOINT:"/wp-json/stat-paywall/v1/subscription",INVOICES_ENDPOINT:"/wp-json/stat-paywall/v1/invoices",COUNT_PAID_INVOICES_ENDPOINT:"/wp-json/stat-paywall/v1/count-paid-invoices",COUPON_ENDPOINT:"/wp-json/stat-paywall/v1/coupon",PLAN_ENDPOINT:"/wp-json/stat-paywall/v1/plan",PLAN_GROUP_ENDPOINT:"/wp-json/stat-paywall/v1/plan-group",GROUP_SUBSCRIBERS_ENDPOINT:"/wp-json/stat-paywall/v1/group-subscribers",GROUP_SEATS_ENDPOINT:"/wp-json/stat-paywall/v1/group-seats",LOGIN_ANONYMOUS_ENDPOINT:"/wp-json/stat-paywall/v1/login-anonymous",LOOKUP_ENDPOINT:"/wp-json/stat-paywall/v1/lookup",LOGIN_SOURCE:"stat_login_source",PROMO_CODE:"stat_promo_code",PLAN_GROUP:"stat_paywall_plan_group",SUCCESS:"stat_success",USER_META_ENDPOINT:"/wp-json/stat-paywall/v1/user-meta",GROUP_META_ENDPOINT:"/wp-json/stat-paywall/v1/group-meta",USER_PROFILE_ENDPOINT:"/wp-json/stat-paywall/v1/user-profile",RESTRICTED_CONTENT_ENDPOINT:"/wp-json/stat-paywall/v1/restricted-content",EMAIL_ENDPOINT:"/wp-json/stat-paywall/v1/email",NEWSLETTERS_ENDPOINT:"/wp-json/stat-paywall/v1/newsletters",CONTACT_ENDPOINT:"/wp-json/stat-paywall/v1/contact",IS_ALLOWED_REFERRER_ENDPOINT:"/wp-json/stat-paywall/v1/restricted-content/is-allowed-referrer",CONNECTIONS:{GOOGLE:"google-oauth2",FACEBOOK:"facebook",LINKEDIN:"linkedin",APPLE:"apple",DATABASE:i()&&i().isProduction?"Username-Password-Authentication":"Interloop-Database"},ACCOUNT_LINK:i()&&i().accountLink?i().accountLink:"/my-account/",ACCOUNT_LINK_CANCEL:i()&&i().accountLink?i().accountLink+"cancel/":"/my-account/cancel/",ACCOUNT_LINK_EDIT:i()&&i().accountLink?i().accountLink+"edit/":"/my-account/edit/",ACCOUNT_LINK_BILLING:i()&&i().accountLink?i().accountLink+"billing/":"/my-account/billing/",ACCOUNT_LINK_GROUP_EMAILS:i()&&i().accountLink?i().accountLink+"group-emails/":"/my-account/group-emails/",ACCOUNT_LINK_PURCHASE_SEATS:i()&&i().accountLink?i().accountLink+"purchase-seats/":"/my-account/purchase-seats/",LOGIN_LINK:i()&&i().loginLink?i().loginLink:"/login/",LOGIN_GROUP_LINK:i()&&i().loginLink?i().loginLink+"group/":"/login/group/",SUBSCRIBE_LINK:i()&&i().subscribeLink?i().subscribeLink:"/subscribe/",REGISTER_LINK:i()&&i().registerLink?i().registerLink:"/register/",PLUS_SUBSCRIBE_LINK:i()&&i().plusSubscribeLink?i().plusSubscribeLink:"/stat-plus/subscribe/",PLUS_TOPIC_LINK:i()&&i().plusTopicLink?i().plusTopicLink:"/topic/stat-plus/",PLUS_LANDING_LINK:i()&&i().plusLandingLink?i().plusLandingLink:"/stat-plus/",ACTIVATE_LINK:i()&&i().activateLink?i().activateLink:"/activate/",ACTIVATE_LINK_CHECK:i()&&i().activateLink?i().activateLink+"check/":"/activate/check/",TOKEN_TTL:1200,NEWSLETTERS_TTL:3600,LOOKUP_TTL:14400,CONTACT_TTL:14400,STAT_TLDS:["stat.local","statnews.com"]}},10:function(t,e,s){"use strict";s.d(e,{r:function(){return u}});var n=s(6824),i=s(4047),r=s(7448),a=s(9245),o=s.n(a),l=s(5311),c=s.n(l);let u=new class{loginAnonymous(t){t.method="GET",t.action=n.g.LOGIN_ANONYMOUS_ENDPOINT,t.submit()}getGroupName(){let t=i.E.getIdToken();return t&&t.stat&&t.stat.group_name?t.stat.group_name:null}getGroupContact(){let t=i.E.getIdToken();return t&&t.stat&&t.stat.group_contact?t.stat.group_contact:null}getSubscribers(){let t;return new Promise(((e,s)=>{c().get(n.g.GROUP_SUBSCRIBERS_ENDPOINT).done((t=>{e(t)})).fail(((e,n,i)=>{t=e.responseJSON||`${n}: ${i}`,s(t)}))}))}addSubscribers(t){let e,s={type:"PUT",data:{emails:t}};return new Promise(((i,a)=>{c().ajax(n.g.GROUP_SUBSCRIBERS_ENDPOINT,s).done((e=>{r.F.set(n.g.PROFILE_KEY,e),i(t)})).fail(((t,s,i)=>{r.F.delete(n.g.PROFILE_KEY),e=t.responseJSON||`${s}: ${i}`,a(e)}))}))}removeSubscriber(t){let e,s={type:"DELETE",data:{email:t}};return new Promise(((i,a)=>{c().ajax(n.g.GROUP_SUBSCRIBERS_ENDPOINT,s).done((e=>{r.F.set(n.g.PROFILE_KEY,e),i(t)})).fail(((t,s,n)=>{e=t.responseJSON||`${s}: ${n}`,a(e)}))}))}getSeats(){let t;return new Promise(((e,s)=>{c().get(n.g.GROUP_SEATS_ENDPOINT).done((t=>{e(t)})).fail(((e,n,i)=>{t=e.responseJSON||`${n}: ${i}`,s(t)}))}))}addSeats(t){let e,s={type:"POST",data:{quantity:t}};return new Promise(((i,a)=>{c().ajax(n.g.GROUP_SEATS_ENDPOINT,s).done((e=>{r.F.set(n.g.CUSTOMER_KEY,e),r.F.set(n.g.SUBSCRIPTION_KEY,e.subscriptions.data[0]),r.F.delete(n.g.INVOICES_KEY),i(t)})).fail(((t,s,i)=>{r.F.delete(n.g.CUSTOMER_KEY),r.F.delete(n.g.SUBSCRIPTION_KEY),e=t.responseJSON||`${s}: ${i}`,a(e)}))}))}getProxyUrls(){let t=i.E.getIdToken();return t&&t.stat&&Array.isArray(t.stat.group_proxy_urls)?t.stat.group_proxy_urls:[]}updateGroupMeta(t){let e,s={type:"POST",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8"};return new Promise(((t,i)=>{c().ajax(n.g.GROUP_META_ENDPOINT,s).done((e=>{r.F.set(n.g.PROFILE_KEY,e),t(e)})).fail(((t,s,a)=>{r.F.delete(n.g.PROFILE_KEY),e=t.responseJSON||`${s}: ${a}`,i(e)}))}))}};o()&&(o().group=u)},7414:function(t,e,s){"use strict";s.d(e,{G:function(){return d}});var n=s(5311),i=s.n(n),r=s(1865),a=s.n(r),o=s(2421),l=s.n(o),c=s(6824),u=s(4047);let d=new class{constructor(){this.$loginLinks=i()(),this.$subscribeLinks=i()(),this.$tryLinks=i()(),this.$archiveLinks=i()(),this.loginDefaults={href:"#",text:""},this.subscribeDefaults={href:"#",text:""},this.tryDefaults={href:"#",text:""}}setLoginLinks(){let t=u.E.getIdToken();t?this.setMenuLinks(this.$loginLinks,"Log Out","#",t):this.setMenuLinks(this.$loginLinks,this.loginDefaults.text,this.loginDefaults.href,t)}setSubscribeLinks(){let t=u.E.getIdToken();t?(this.setMenuLinks(this.$subscribeLinks,"My Account",c.g.ACCOUNT_LINK,t),"unpaid"===u.E.getSubscriptionStatus()&&this.$subscribeLinks.addClass("icon-error")):(this.setMenuLinks(this.$subscribeLinks,this.subscribeDefaults.text,this.subscribeDefaults.href,t),this.$subscribeLinks.removeClass("icon-error"))}setTryLinks(){let t=u.E.getIdToken();t?this.setMenuLinks(this.$tryLinks,"STAT+",c.g.PLUS_TOPIC_LINK,t):(this.setMenuLinks(this.$tryLinks,this.tryDefaults.text,this.tryDefaults.href,t),this.$tryLinks.attr("data-stat-paywall-cta",""))}setMenuLinks(t,e,s,n){t.html(e).attr("href",s).parent().parent().parent().addClass("logged").removeClass(n?"out":"in").addClass(n?"in":"out")}statPlusSubmenu(){u.E.getIdToken()?this.$archiveLinks.removeClass("no-toggle"):this.$archiveLinks.addClass("no-toggle")}loginRedirect(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";window.location.href=!t&&e?e:t?c.g.SUBSCRIBE_LINK:c.g.LOGIN_LINK}login(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i={};n&&(i={link_source:n}),u.E.setLoginSource(i),e?this.initModal(t,():this.loginRedirect(t,s)}logout(){u.E.logout(),this.isMyAccountPage()?window.location.href=`https://${c.g.AUTH_DOMAIN}/v2/logout?returnTo=https://${window.location.host}/&client_id=${c.g.CLIENT_ID}`:window.location.reload()}isMyAccountPage(){return 0===window.location.pathname.indexOf(c.g.ACCOUNT_LINK)}isLoginPage(){return 0===window.location.pathname.indexOf(c.g.LOGIN_LINK)||0===window.location.pathname.indexOf(c.g.SUBSCRIBE_LINK)||0===window.location.pathname.indexOf(c.g.REGISTER_LINK)}useModal(t){return i()(t.currentTarget).parent().hasClass("modal")&&!this.isLoginPage()}setArchiveLinks(){let t="";t=u.E.getIdToken()?c.g.PLUS_TOPIC_LINK:c.g.PLUS_LANDING_LINK,this.$archiveLinks.length&&t&&this.$archiveLinks.attr("href",t)}setLinkDefaults(){this.$loginLinks.length&&(this.loginDefaults.href=this.$loginLinks.first().attr("href"),this.loginDefaults.text=this.$loginLinks.first().text()),this.$subscribeLinks.length&&(this.subscribeDefaults.href=this.$subscribeLinks.first().attr("href"),this.subscribeDefaults.text=this.$subscribeLinks.first().text()),this.$tryLinks.length&&(this.tryDefaults.href=this.$tryLinks.length>1?i()(this.$tryLinks.get(1)).attr("href"):this.$tryLinks.first().attr("href"),this.tryDefaults.text=this.$tryLinks.length>1?i()(this.$tryLinks.get(1)).html():this.$tryLinks.first().html())}initModal(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;Promise.all([s.e(538),s.e(7464),s.e(2288),s.e(6680),s.e(2262)]).then(s.bind(s,8621)).then((s=>{s.default.init(t).then((()=>{i()("body").trigger("stat-paywall-modal-impression",[t])})).catch((()=>{e()}))}))}getPromoFromLink(t){return new(l())(t.attr("href")).query_get(c.g.PROMO_CODE)}toggleNavLabels(){u.E.getIdToken()&&i()(".menu-main-inner").find(".header-nav.nav-secondary").attr("aria-label","My Account")}setHeaderClasses(){let t=u.E.getIdToken();i()(".header-main-inner").addClass("logged").removeClass(t?"out":"in").addClass(t?"in":"out")}init(){document.addEventListener("DOMContentLoaded",(()=>{this.$loginLinks=i()(".stat-paywall-login > a"),this.$subscribeLinks=i()(".stat-paywall-subscribe > a"),this.$tryLinks=i()("a.stat-paywall-try"),this.$archiveLinks=i()(".stat-paywall-archive > a"),this.setHeaderClasses(),this.setLinkDefaults(),this.statPlusSubmenu(),this.setLoginLinks(),this.setSubscribeLinks(),this.setTryLinks(),this.setArchiveLinks(),this.toggleNavLabels(),this.$loginLinks.on("click",(t=>{t.preventDefault(),u.E.getIdToken()?this.logout():this.login(!1,this.useModal(t))})),this.$subscribeLinks.on("click",(t=>{u.E.getIdToken()||(t.preventDefault(),this.login(!0,this.useModal(t)))})),i()("body").on("click","a[data-stat-login], a[data-stat-register], a[data-stat-subscribe]",(t=>{t.preventDefault();let e=i()(t.currentTarget),s=e.attr("href"),n=void 0!==e.attr("data-stat-subscribe"),r=n?"modal"===e.attr("data-stat-subscribe"):"modal"===e.attr("data-stat-login"),o=e.attr("data-stat-login")?e.attr("data-stat-login"):e.attr("data-stat-register");if(r){let t=this.getPromoFromLink(e);t&&a().set(c.g.PROMO_CODE,t,{expires:7,sameSite:"Lax"})}n||!s||"#"===s?this.login(n,r&&!this.isLoginPage()):this.login(n,r&&!this.isLoginPage(),s,o)}))}))}}},3989:function(t,e,s){"use strict";var n=s(7414),i=s(5311),r=s.n(i),a=s(6824),o=s(4047),l=s(10),c=s(9245),u=s.n(c),d=s(2421),g=s.n(d),h=s(2611);let p=new class{constructor(){this._contentReady=null,this._domReady=null,this.restrictedContent="",this.referrerBreaker="",this.hasAccess=o.E.hasRestrictedContentAccess()&&!o.E.isIpRestricted()&&!o.E.isGroupAdminOnly()}isRestrictedPost(){return u().postId&&u().restricted}maybeSetNonceHeader(t){u().apiNonce?t.setRequestHeader("X-WP-Nonce",u().apiNonce):u().restrictedContentNonce&&t.setRequestHeader("X-STAT-Nonce",u().restrictedContentNonce)}maybeFetchRestrictedContent(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!u().postId||!this.isRestrictedPost())return Promise.reject();let s=new(g())(a.g.RESTRICTED_CONTENT_ENDPOINT+"/"+u().postId+window.location.search),n=t||document.referrer;return n&&s.query_push({document_referrer:n}),e&&s.query_push({user_agent:e}),Promise.resolve(r().ajax(s.to_string(),{beforeSend:this.maybeSetNonceHeader}))}isAllowedReferrer(){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||document.referrer,s=t||navigator.userAgent;return e||s?Promise.resolve(r().get(a.g.IS_ALLOWED_REFERRER_ENDPOINT,{document_referrer:e,user_agent:s})):Promise.reject()}maybeDisplayReferrerBreaker(){let t=r()(".the-content"),e=t.find(".referrer-breaker");u().isSingle&&t.length&&this.referrerBreaker&&!e.length&&t.prepend(this.referrerBreaker)}displayRestrictedContent(t){let e=r()(".restricted-content-breaker"),s=e.find(".restricted-content-wrapper");e.length&&(o.E.getIdToken()&&((!this.hasAccess||t&&t.status&&(401===t.status||403===t.status))&&(s.addClass("info"),this.setNotSubscribedMessage(e)),"unpaid"===o.E.getSubscriptionStatus()&&(s.addClass("error"),this.setUnpaidMessage(e)),o.E.isIpRestricted()&&(s.addClass("warning"),this.setIpRestrictedMessage(e)),o.E.isGroupAdminOnly()&&(s.addClass("warning"),this.setIsAdminOnlyMessage(e))),this.restrictedContent?(e.replaceWith(this.restrictedContent),r()(".restricted .content-meta").show(),r()(".restricted .connect-comments").css({display:"flex"}),r()(".restricted .corrections").show(),this.maybeDisplayReferrerBreaker()):(e.show(),u().matherListener&&u().matherListener.trackPaywallStop())),r().holdReady(!1)}setNotSubscribedMessage(t){let e=t.find(".restricted-content-message");e.length&&(u().isEvent?e.html(`\n\t\t\t\t\t\t<p class="restricted-content-text">\n\t\t\t\t\t\t\tThis event is only available to STAT+ subscribers.\n\t\t\t\t\t\t\t<span class="restricted-content-complete">\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<a href="${a.g.PLUS_SUBSCRIBE_LINK}" data-stat-paywall-cta="breaker - abandoned">Complete your subscription</a> to access this event.\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t`):e.html(`\n\t\t\t\t\t\t<p class="restricted-content-text">\n\t\t\t\t\t\t\tThis article is only available to STAT+ subscribers.\n\t\t\t\t\t\t\t<span class="restricted-content-complete">\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\tTo complete your subscription, <a href="${a.g.PLUS_SUBSCRIBE_LINK}" data-stat-paywall-cta="breaker - abandoned">click here</a>.\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t`))}setUnpaidMessage(t){let e=t.find(".restricted-content-message");if(e.length)if(o.E.isGroupAdmin())e.html('\n\t\t\t\t\t<p class="restricted-content-text">\n\t\t\t\t\tThe STAT+ contract for your group has ended. Please email <a href="mailto:subscribers@statnews.com">subscribers@statnews.com</a> to learn about renewal options and reactivating the subscription.\n\t\t\t\t\t</p>\n\t\t\t\t\t');else if(o.E.isGroupSubscriber()){let t="Please email your group administrator",s=`\n\t\t\t\t\t\t\t<p class="restricted-content-text">\n\t\t\t\t\t\t\t\tThe STAT+ contract for your group has ended. ${t}, or to re-subscribe as an individual, email <a href="mailto:subscribers@statnews.com">subscribers@statnews.com</a>.\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t`,n=l.r.getGroupContact();n&&(s=s.replace(t,`${t}: <a href="mailto:${n}">${n}</a>`)),e.html(s)}else e.html(`\n\t\t\t\t\t\t<p class="restricted-content-text">\n\t\t\t\t\t\t\tYour STAT+ subscription is currently inactive due to a failed payment.\n\t\t\t\t\t\t\tPlease <a href="${a.g.ACCOUNT_LINK}">update your payment information</a>.\n\t\t\t\t\t\t\tFor assistance, please email <a href="mailto:subscribers@statnews.com">subscribers@statnews.com</a>.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t`)}setIpRestrictedMessage(t){let e=t.find(".restricted-content-message"),s=l.r.getProxyUrls(),n=s.length?`<a href="${s[0]}">${s[0]}</a>`:"your organization’s authorized network",i=l.r.getGroupContact(),r=l.r.getGroupName();e.length&&r&&i&&e.html(`\n\t\t\t\t\t<p class="restricted-content-text">\n\t\t\t\t\t\tYou are not currently able to access your STAT+ subscription because you did not log in through ${r}'s network.\n\t\t\t\t\t\tPlease log out and visit ${n} to access content and subscriber benefits! For assistance, please contact <a href="mailto:${i}">${i}</a>.\n\t\t\t\t\t</p>\n\t\t\t\t`)}setIsAdminOnlyMessage(t){let e=t.find(".restricted-content-message"),s=l.r.getGroupName(),n=o.E.getEmail();e.length&&e.html(`\n\t\t\t\t\t<p class="restricted-content-text">\n\t\t\t\t\t\t${n?n+" does":"You do"} not have access to STAT+ content through the ${s?"<i>"+s+"</i>":"current"} subscription. If you would like to adjust this, please reach out to <a href="mailto:groups@statnews.com">groups@statnews.com</a> or your account manager.\n\t\t\t\t\t</p>\n\t\t\t\t`)}maybeHideComments(){this.isRestrictedPost()&&!this.hasAccess&&r()(".single.restricted .comments-section").hide()}maybeHidePreBreaker(){this.isRestrictedPost()&&this.hasAccess&&r()(".pre-breaker-wrapper").hide()}init(){let t=new URLSearchParams(window.location.search);this.isRestrictedPost()?(this._contentReady=this.maybeFetchRestrictedContent(t.get("test_referrer"),t.get("test_user_agent")),this._domReady=new Promise(((t,e)=>{document.addEventListener("DOMContentLoaded"}))})),this._domReady.then})),Promise.all([this._domReady,this._contentReady]).then((t=>{this.restrictedContent=t[1].restricted_content,this.referrerBreaker=t[1].referrer_breaker,this.displayRestrictedContent()})).catch}))):u().isSingle&&this.isAllowedReferrer(t.get("test_referrer"),t.get("test_user_agent")).then((t=>{t.is_allowed_referrer&&t.referrer_breaker.length&&(this.referrerBreaker=t.referrer_breaker,this.maybeDisplayReferrerBreaker())})).catch(h.noop)}};u().restrictedContent=p;let _=new class{setCTALink(){let t=o.E.getIdToken()?"in":"out",e=r()(`[data-stat-paywall-cta-logged-${t}]`),s=e.find(".widget-cta-inner");e.length&&s.length&&(e.attr("href","in"===t?a.g.PLUS_TOPIC_LINK:a.g.PLUS_LANDING_LINK),s.text(e.data(`stat-paywall-cta-logged-${t}`)))}isPlusWidget(t){return 1===r()(t).find(".stat-plus-zone").length}init(){r()((()=>{this.setCTALink()})),r()("body").on("stat-sidebar-item-placed",((t,e)=>{this.isPlusWidget(e)&&this.setCTALink()}))}},E=new class{setCTAWidget(){r()(".stat-plus-article-cta").length&&(o.E.getIdToken()?(r()(".stat-plus-article-cta-logged-in").show(),r()(".stat-plus-article-cta-logged-out").hide()):(r()(".stat-plus-article-cta-logged-in").hide(),r()(".stat-plus-article-cta-logged-out").show()))}isCTAWidg}init(){r()})),r()("body").on("stat-sidebar-item-placed",((t,e)=>{this.isCTAWidget(e)&&this.setCTAWidget()}))}},N=new clas}};n.G.init(),p.init(),N.init(),0!==window.location.pathname.indexOf(a.g.LOGIN_LINK)&&0!==window.location.pathname.indexOf(a.g.REGISTER_LINK)||Promise.all([s.e(538),s.e(7464),s.e(2288),s.e(6680),s.e(1907)]).then(s.bind(s,6978)).then((t=>{t.default.init()})),0===window.location.pathname.indexOf(a.g.SUBSCRIBE_LINK)&&(Promise.all([s.e(538),s.e(7464),s.e(2288),s.e(6680),s.e(1907)]).then(s.bind(s,6978)).then((t=>{t.default.init()})),Promise.all([s.e(538),s.e(7937),s.e(3849)]).then(s.bind(s,5396)).then((t=>{t.default.init()}))),0===window.location.pathname.indexOf(a.g.ACCOUNT_LINK)&&0!==window.location.pathname.indexOf(a.g.ACCOUNT_LINK_CANCEL)&&Promise.all([s.e(538),s.e(7464),s.e(7937),s.e(1009),s.e(5409)]).then(s.bind(s,8393)).then((t=>{t.default.init()})),0===window.location.pathname.indexOf(a.g.PLUS_SUBSCRIBE_LINK)&&Promise.all([s.e(538),s.e(7464),s.e(2288),s.e(6680),s.e(7937),s.e(1009),s.e(7235)]).then(s.bind(s,880)).then((t=>{t.default.init()})),0===window.location.pathname.indexOf(a.g.ACTIVATE_LINK)&&Promise.all([s.e(538),s.e(7464),s.e(2288),s.e(6680),s.e(8215)]).then(s.bind(s,9949)).then})),0===window.location.pathname.indexOf(a.g.ACCOUNT_LINK_CANCEL)&&o.E.deleteCaches(!1)},4047:function(t,e,s){"use strict";s.d(e,{}});var n=s(5311),i=s.n(n),r=s(1865),a=s.n(r);function o(t){this.message=t}o.prototype=new Error,o.prototype.name="InvalidCharacterError";var l="undefined"!=typeof window&&window.atob&&window.atob.bind(window)u.prototype=new Error,u.prototype.name="InvalidTokenError";var d=s(2421),g=s.n(d),h=s(6824),p=s(7448),_=s(9245),E=s.n(_),N=s(7414),T=s(2611);let I=new class{constructor(){this.isIdTokenImpersonated()&&this.deleteCaches(),this.isUnsubscribedFromPlusNewsletters=!1}getNewsletters(){let t,e,s=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t=p.F.get(h.g.NEWSLETTERS_KEY),new Promise(((n,r)=>{s&&t&&this._isCacheFresh(t,h.g.NEWSLETTERS_TTL)?n(t):i().get(h.g.NEWSLETTERS_ENDPOINT).done((t=>{p.F.set(h.g.NEWSLETTERS_KEY,t),n(t)})).fail(((t,s,n)=>{e=t.responseJSON||`${s}: ${n}`,r(e)}))}))}getJ}getIdToken(){let t,e=this.getJWT(),s=Math.floor(Date.now()/1e3),n=p.F.get(h.g.NONCE_KEY);if(void 0===e)return null;try{}(e)}catch(t){return this.logout(),null}return t&&s>=t.exp||t&&t.nonce&&n!==t.nonce?(this.logout(),null):}getId(){let t=this.getIdToken();return t&&t.sub?t.sub:null}_getObject(t){let e,s,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=h.g[t.toUpperCase()+"_KEY"],l=p.F.get(o);return n=null===a?h.g[t.toUpperCase()+"_ENDPOINT"]:h.g[t.toUpperCase()+"_ENDPOINT"]+`/${a}`,new Promise(((a,c)=>{if(r&&l)return e="object"==typeof l&&(t===l.object||"list"===l.object),void(e?a(l):c(l));i().get(n).done})).fail(((t,e,n)=>{s=t.responseJSON||`${e}: ${n}`,p.F.set(o,s),c(s)}))}))}getCustomer(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getObject("customer",t&&this._isTokenFresh())}getInvoices(){let t,e,s,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,l="invoices",c=h.g[l.toUpperCase()+"_KEY"],u=p.F.get(c);return s=new(g())(h.g[l.toUpperCase()+"_ENDPOINT"]),s.query_set({limit:r,starting_after:a,ending_before:o}),new Promise(((r,a)=>{n&&u&&(t="object"==typeof u&&"list"===u.object,t&&u._statEndpoint===s.to_string())?r(u):i().get(s.to_string()).done((t=>{t._statEndpoint=s.to_string(),p.F.set(c,t),r(t)})).fail(((t,s,n)=>{p.F.delete(c),e=t.responseJSON||`${s}: ${n}`,a(e)}))}))}setPlanGroup(t,e){a().set(h.g.PLAN_GROUP,t,{expires:e,sameSite:"Lax"})}removePlanGroup(){a().remove(h.g.PLAN_GROUP)}getPlanGroupName(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=new(g())(window.location.href).query_get();return e.plan_group?e.plan_group:t?a().get(h.g.PLAN_GROUP):""}getPlan(t){return this._getObject("plan",!1,t)}getPlanGro}getProfile(){let t,e,s=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t=p.F.get(h.g.PROFILE_KEY),new Promise(((n,r)=>{this.isGroupSubscriberAnonymous()?n(null):s&&t&&this._isTokenFresh()?n(t):i().get(h.g.USER_PROFILE_ENDPOINT).done((t=>{p.F.set(h.g.PROFILE_KEY,t),n(t)})).fail(((t,s,n)=>{p.F.delete(h.g.PROFILE_KEY),e=t.responseJSON||`${s}: ${n}`,r(e)}))}))}updateProfileCac}hasSubscripti}hasValidSubscription(){let t=this.getSubscriptionStatus();return t?"canceled"!==t&&"unpaid"!==t:null}deleteCaches(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];p.F.delete(h.g.PROFILE_KEY),p.F.delete(h.g.CUSTOMER_KEY),p.F.delete(h.g.SUBSCRIPTION_KEY),p.F.delete(h.g.INVOICES_KEY),p.F.delete(h.g.NEWSLETTERS_KEY),p.F.delete(h.g.LOOKUP_KEY),p.F.delete(h.g.CONTACT_KEY),t&&p.F.delete(h.g.NONCE_KEY)}logout(){a().remove(h.g.TOKEN_KEY),this.deleteCaches()}getRole(){let t=this.getIdToken();return t&&t.stat&&t.stat.role?t.stat.role:""}getOrg(){let t=this.getIdToken();return t&&t.stat&&t.stat.org?t.stat.org:""}getJobLevel(){let t=this.getIdToken();return t&&t.stat&&t.stat.joblevel?t.stat.joblevel:""}getRegistrationSource(){let t=this.getIdToken();return t&&t.stat&&t.stat.registration_source?t.stat.registration_source:""}getLoginsCount(){let t=this.getIdToken();return t&&t.stat&&t.stat.logins_count?t.stat.logins_count:0}getEma}hasRestrictedContentAccess(){return!!this.hasSubscription()||"staff"===this.getRole()||"vip"===this.getRole()}_isTokenFresh(){let t,e=this.getIdToken();return!!e&&(!e.stat||"canceled"!==e.stat.subscription_status)&&!(!e.stat||!e.stat.last_refresh)&&(t=Math.round(Date.now()/1e3),t-e.stat.last_refresh<h.g.TOKEN_TTL)}_isCacheFresh(t,e){let s;return!(!t||!t.last_refresh)&&(s=Math.round(Date.now()/1e3),s-t.last_refresh<e)}isIdTokenImpersonated(){let t=this.getIdToken();return!!t&&!(!t.stat||!t.stat.impersonated)}isIpRestricted(){return(arguments.length>0&&void 0!==arguments[0]&&!arguments[0]||this.isGroupSubscriber())&&"ip_restricted"===this.getRole()}isGroupAdminOnly(){let t=this.getIdToken();return!!t&&t.stat&&t.stat.role&&"group_admin_only"===t.stat.role}_getCustomerId(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getIdToken();return e?e.stat&&e.stat.customer_id?e.stat.customer_id:t&&t.app_metadata&&t.app_metadata.customer_id?t.app_metadata.customer_id:null:null}_getSubscriptionId(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getIdToken();return e?e.stat&&e.stat.subscription_id?e.stat.subscription_id:t&&t.app_metadata&&t.app_metadata.subscription_id?t.app_metadata.subscription_id:null:nul}isGroupSubscriber(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==this._getSubscriptionId(t)}isGroupSubscriberAnonymous(){return null!==this._getSubscriptionId()&&"anonymous"===this.getId()}isGroupAdmin(){let t=this.getRole();return!(!t||!["group_admin","group_admin_only"].includes(t))}isCustomer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==this._getCustomerId(t)}getSubscription(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getObject("subscription",t&&this._isTokenFresh())}getSubscriptionStatus(){let t=this.getIdToken();return(t&&t.stat&&t.stat.subscription_status?t.stat.subscription_status:"")||null}getSubscriptionPlanTy}getName(t){let e="";return t.email!==t.name&&(e=t.name),t.user_metadata&&t.user_metadata.name&&(e=t.user_metadata.name),e}changePassword(t){let e={client_id:h.g.CLIENT_ID,connection:h.g.CONNECTIONS.DATABASE,email:t};return Promise.resolve(i().post("https://"+h.g.AUTH_DOMAIN+"/dbconnections/change_password",e))}createCustomer(t){let e;return new Promise(((s,n)=>{i().post(h.g.CUSTOMER_ENDPOINT,t).done((t=>{p.F.set(h.g.CUSTOMER_KEY,t),p.F.set(h.g.SUBSCRIPTION_KEY,t.subscriptions.data[0]),s(t)})).fail(((t,s,i)=>{p.F.delete(h.g.CUSTOMER_KEY),p.F.delete(h.g.SUBSCRIPTION_KEY),e=t.responseJSON||`${s}: ${i}`,n(e)}))}))}updateNewsletters(t){let e,s={type:"PUT",data:{newsletters:t}};return new Promise(((t,n)=>{i().ajax(h.g.NEWSLETTERS_ENDPOINT,s).done((e=>{p.F.set(h.g.NEWSLETTERS_KEY,e),t(e)})).fail(((t,s,i)=>{p.F.delete(h.g.NEWSLETTERS_KEY),e=t.responseJSON||`${s}: ${i}`,n(e)}))}))}updateCustomer(t){let e,s={type:"PUT",data:t};return new Promise(((t,n)=>{i().ajax(h.g.CUSTOMER_ENDPOINT,s).done((e=>{p.F.set(h.g.CUSTOMER_KEY,e),p.F.set(h.g.SUBSCRIPTION_KEY,e.subscriptions.data[0]),t(e)})).fail(((t,s,i)=>{p.F.delete(h.g.CUSTOMER_KEY),p.F.delete(h.g.SUBSCRIPTION_KEY),e=t.responseJSON||`${s}: ${i}`,n(e)}))}))}mergeEmail(){let t,e={type:"PATCH"};return new Promise(((s,n)=>{i().ajax(h.g.EMAIL_ENDPOINT,e).done((t=>{s(t)})).fail(((e,s,i)=>{t=e.responseJSON||`${s}: ${i}`,n(t)}))}))}reactivateSubscription(){let t,e={type:"PATCH"};return new Promise(((s,n)=>{i().ajax(h.g.SUBSCRIPTION_ENDPOINT,e).done((t=>{p.F.set(h.g.CUSTOMER_KEY,t),p.F.set(h.g.SUBSCRIPTION_KEY,t.subscriptions.data[0]),s(t)})).fail(((e,s,i)=>{t=e.responseJSON||`${s}: ${i}`,n(t)}))}))}updateUserMeta(t){let e,s={type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8"};return new Promise(((t,n)=>{i().ajax(h.g.USER_META_ENDPOINT,s).done((e=>{p.F.set(h.g.PROFILE_KEY,e),t(e)})).fail(((t,s,i)=>{p.F.delete(h.g.PROFILE_KEY),e=t.responseJSON||`${s}: ${i}`,n(e)}))}))}updateEmail(t){let e,s={type:"PUT",data:{email:t}};return new Promise(((t,n)=>{i().ajax(h.g.EMAIL_ENDPOINT,s).done((e=>{p.F.set(h.g.PROFILE_KEY,e),t(e)})).fail(((t,s,i)=>{p.F.delete(h.g.PROFILE_KEY),e=t.responseJSON||`${s}: ${i}`,n(e)}))}))}verifyEmail(t){let e,s={result_url:t};return new Promise(((t,n)=>{i().post(h.g.EMAIL_ENDPOINT,s).done((e=>{t(e)})).fail(((t,s,i)=>{e=t.responseJSON||`${s}: ${i}`,n(e)}))}))}countPaidInvoices(){let t,e={count_trial_invoices:arguments.length>0&&void 0!==arguments[0]&&arguments[0],limit:arguments.length>1&&void 0!==arguments[1]?arguments[1]:10};return new Promise(((s,n)=>{i().get(h.g.COUNT_PAID_INVOICES_ENDPOINT,e).done((t=>{s(t)})).fail(((e,s,i)=>{t=e.responseJSON||`${s}: ${i}`,n(t)}))}))}getCoupon(t){let e;return new Promise(((s,n)=>{i().get(`${h.g.COUPON_ENDPOINT}/${t}`).done})).fail(((t,s,i)=>{e=t.responseJSON||`${s}: ${i}`,n(e)}))}))}isUnsubscribedFromNewsletters(t){if(this.isEmailVerified()&&this.hasValidSubscription()&&!this.isGroupSubscriberAnonymous()){let e=!0;return this.getNewsletters(!0).then((s=>(s[t]&&s[t].length&&s[t].forEach})),e))).catch1))}return Promise.resolve(!1}setLoginSource(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(N.G.isLoginPage())return;let e=new(g())(window.location.href);if(window.location.pathname===h.g.PLUS_LANDING_LINK){let t=window.location.protocol+"//"+window.location.host;e=new(g())(t+h.g.PLUS_TOPIC_LINK)}(0,T.isEmpty)(t)||e.query_push(t),a().set(h.g.LOGIN_SOURCE,e.to_string(),{expires:1,sameSite:"Lax"})}lookup(){let t,e,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n={email:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",include_group_info:arguments.length>1&&void 0!==arguments[1]&&arguments[1],include_subscription_info:arguments.length>2&&void 0!==arguments[2]&&arguments[2]};return t=p.F.get(h.g.LOOKUP_KEY),new Promise(((r,a)=>{s&&t&&this._isCacheFresh(t,h.g.LOOKUP_TTL)&&t.user_is_logged_in===this.isLoggedIn()?r(t):i().get(h.g.LOOKUP_ENDPOINT,n).done((t=>{p.F.set(h.g.LOOKUP_KEY,t),r(t)})).fail(((t,s,n)=>{e=t.responseJSON||`${s}: ${n}`,a(e)}))}))}getContact(){let t,e,s=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t=p.F.get(h.g.CONTACT_KEY),s&&t&&this._isCacheFresh(t,h.g.CONTACT_TTL)&&t.user_is_logged_in===this.isLoggedIn()?t:new Promise(((t,s)=>{i().get(h.g.CONTACT_ENDPOINT).done((e=>{p.F.set(h.g.CONTACT_KEY,e),t(e)})).fail(((t,n,i)=>{e=t.responseJSON||`${n}: ${i}`,s(e)}))}))}};i()(window).on("stat-paywall-plan-group"})),I.isUnsubscribedFromNewsletters("stat_plus_newsletters").then})),E()&&(E().user=I)},186},924}}]);