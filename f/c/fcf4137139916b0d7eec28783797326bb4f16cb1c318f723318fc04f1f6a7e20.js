(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{1266:function(e,t,s){"use strict";s.r(t);var i=s(5),a=s(1102),r=s(820),o=s(510),n=s(871),l=s(590),c=s(565),u=s(87),d=s(156),h=s(17),m=s(810),p=s(829),k=s(844),v=s(845),b=s(1116),f={components:{BaseButton:s(508).a,FormRow:o.o,ThreadDuplicates:r.a,FormMessageList:o.m,ControlLoader:n.a,FormInputLabeled:o.i,FormInputIcon:o.h,ControlLinkErrors:m.a,CheckVoucherCodeDuplicates:p.a,CheckBlockedLinks:k.a,GetLinkMerchantSuggestion:v.a,EventTrigger:b.a},mixins:[l.b],data:()=>Object.assign({},Object(u.d)({thread:{namespace:"threadForm",path:"thread",deep:!0}}),{submitLink:"",submitCode:"",hasErrors:!1,hasDuplicates:!1}),computed:{canSubmit(){return!this.hasDuplicates&&!this.hasErrors},voucherType:()=>h.o,inlineLinkErrorsMessages(){return this.$v?this.$v.messages.link.filter((e=>!e.title)):[]},duplicatesFilter:()=>({type:{ne:h.g}})},validations:()=>({link:[Object(c.n)(!0)],voucherCode:[Object(c.o)("voucherCode")]}),watch:{"thread.link"(){this.resetData()},"thread.voucherCode"(){this.resetData()}},methods:{resetLink(){this.thread.link="",this.thread.voucherCode="",this.resetData(),this.validateLink()},resetCode(){this.thread.voucherCode="",this.resetData()},resetData(){this.hasErrors=!1,this.hasDuplicates=!1,this.submitLink="",this.submitCode="",this.$v.clear("link")},async validateLink(){await this.$v.validate("link",this.thread.link)},async submit(){const{link:e,voucherCode:t}=this.thread;this.resetData(),await this.validateLink(),!this.$v.error.link&&e&&(this.submitLink=e,this.submitCode=t)},showFullForm(){this.$emit("show-full-form")},submitVoucher(){Object(d.b)({type:"submit",target:this.$el}),this.showFullForm()},submitWithoutLink(){this.thread.link="",this.thread.voucherCode="",this.thread.merchant={},this.showFullForm()},continueWithCode(){this.showFullForm()},setLinkErrors(e){let{hasErrors:t}=e;this.hasErrors=t},setDuplicates(e){let{hasDuplicates:t}=e;this.hasDuplicates=t}}},C=s(44),g=Object(C.a)(f,(function(){var e=this,t=e._self._c;return t("section",{directives:[{name:"track",rawName:"v-track:linkForm.view",value:{type:e.voucherType},expression:"{ type: voucherType }",arg:"linkForm",modifiers:{view:!0}}],staticClass:"flex flex--dir-col flex--grow-1 space--fromW2-h-4 space--h-3 space--t-3 space--b-2"},[t("div",{staticClass:"flex--grow-1 space--mb-3"},[t("h1",{staticClass:"size--all-xxxl size--fromW2-xxl text--b text--color-charcoalTint space--t-3"},[e._v(" "+e._s("Condividi un codice sconto con milioni di persone")+" ")]),t("p",{staticClass:"size--all-l text--color-greyShade space--mt-3 space--fromW2-mt-1 space--mb-3"},[e._v(" "+e._s("Inserisci il codice e il link tramite il quale sarà possibile ottenere il tuo codice sconto")+" ")]),t("form",{staticClass:"width--all-12",on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[t("div",{staticClass:"flex boxAlign-ai--all-c"},[t("div",{staticClass:"flex--grow-1"},[t("ol",{staticClass:"flex flex--dir-col flex--fromW2-dir-row"},[t("FormRow",{staticClass:"space--fromW2-r-2 flex--grow-1 width--fromW2-10",attrs:{error:e.$v.error.link}},[t("FormInputLabeled",{attrs:{id:"link",name:"link",placeholder:"https://negozi.it/...",inputmode:"url"},on:{input:e.resetData,change:e.validateLink},scopedSlots:e._u([{key:"prependIcon",fn:function(){return[t("FormInputIcon",{attrs:{name:"link"}})]},proxy:!0}]),model:{value:e.thread.link,callback:function(t){e.$set(e.thread,"link","string"==typeof t?t.trim():t)},expression:"thread.link"}}),t("FormMessageList",{staticClass:"hide--fromW2",attrs:{messages:e.$v.messages.link}})],1),t("FormRow",{attrs:{error:e.$v.error.voucherCode}},[t("FormInputLabeled",{staticClass:"space--t-2 space--fromW2-t-0",attrs:{id:"voucherCode",name:"voucherCode",placeholder:"Codice sconto"},on:{input:e.resetData},scopedSlots:e._u([{key:"prependIcon",fn:function(){return[t("FormInputIcon",{attrs:{name:"scissors"}})]},proxy:!0}]),model:{value:e.thread.voucherCode,callback:function(t){e.$set(e.thread,"voucherCode",t)},expression:"thread.voucherCode"}}),t("FormMessageList",{attrs:{messages:e.$v.messages.voucherCode}})],1)],1)]),e.canSubmit?t("div",{staticClass:"space--l-2 hide--toW2"},[t("BaseButton",{staticClass:"width--all-12",attrs:{type:"submit",variant:"primary",mode:"brand",disabled:!e.thread.link}},[e._v(" "+e._s("Iniziamo!")+" ")])],1):e._e()]),e.submitLink?t("CheckBlockedLinks",{attrs:{link:e.submitLink},on:{request:e.setLinkErrors},scopedSlots:e._u([{key:"default",fn:function({isLoading:s,hasErrors:i,errors:a}){return[i?t("ControlLinkErrors",{attrs:{"error-messages":a},on:{cancel:e.resetLink}}):t("CheckVoucherCodeDuplicates",{attrs:{link:e.submitLink,code:e.submitCode,"thread-id":e.thread.threadId,filter:e.duplicatesFilter},on:{request:e.setDuplicates},scopedSlots:e._u([{key:"default",fn:function({isLoading:a,hasDuplicates:r,duplicates:o}){return[t("div",[t("GetLinkMerchantSuggestion",{attrs:{link:e.submitLink,"keep-alive":!s}}),s||a?t("ControlLoader",[e._v(" "+e._s("Verifica possibili duplicati")+" ")]):r?t("ThreadDuplicates",{attrs:{type:e.voucherType,threads:o},on:{cancel:e.resetCode,continue:e.continueWithCode}}):e._e(),t("EventTrigger",{attrs:{"is-loading":s||a,"has-errors":i||r},on:{trigger:e.submitVoucher}})],1)]}}],null,!0)})]}}],null,!1,1252119478)}):e._e(),t("FormMessageList",{staticClass:"hide--toW2",attrs:{messages:e.$v.messages.link}}),e.canSubmit?t("div",{staticClass:"hide--fromW2 space--mt-3"},[t("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithLink.click",arg:"submitWithLink",modifiers:{click:!0}}],staticClass:"width--all-12 space--mb-3",attrs:{variant:"primary",mode:"brand",type:"submit",disabled:!e.thread.link}},[e._v(" "+e._s("Iniziamo!")+" ")])],1):e._e()],1)]),e.canSubmit?t("div",{staticClass:"hAlign--all-c"},[t("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithoutLink.click",arg:"submitWithoutLink",modifiers:{click:!0}}],attrs:{variant:"tertiary",mode:"default"},on:{click:e.submitWithoutLink}},[e._v(" "+e._s("Non ho un link")+" ")])],1):e._e()])}),[],!1,null,null,null),L=g.exports,_=Object(i.defineComponent)({__name:"voucher-submission-wizard",setup:e=>({__sfc:!0,ThreadSubmissionWizardContent:a.a,VoucherSubmissionLinkForm:L,VOUCHER_TYPE:h.o})}),w=Object(C.a)(_,(function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t(s.ThreadSubmissionWizardContent,{attrs:{"thread-type":s.VOUCHER_TYPE}},[t(s.VoucherSubmissionLinkForm,{staticClass:"flex--grow-1",on:{"show-full-form":function(t){return e.$emit("show-full-form")}}})],1)}),[],!1,null,null,null);t.default=w.exports},829:function(e,t,s){"use strict";var i=s(5),a=s(545),r=s(617),o=s(716);const n=()=>{let e=null;const t=Object(i.ref)([]),{isLoading:s,setLoader:n}=Object(a.a)(),l=()=>{t.value=[],s.value&&Object(o.a)(e)};return{duplicates:t,checkDuplicates:(s,i,a)=>{i&&(l(),(s=>{let{link:i,code:a,filter:o}=s;e=Object(r.b)(i,a,o),e.request.then((e=>{e&&(t.value=e)})).finally(n())})({link:s,code:i,filter:a}))},resetDuplicates:l,isLoading:s}};var l=Object(i.defineComponent)({__name:"check-voucher-code-duplicates",props:{link:null,code:null,filter:null},setup(e){const t=e,{duplicates:s,isLoading:a,checkDuplicates:r,resetDuplicates:o}=n(),l=Object(i.computed)((()=>!!s.value.length));return Object(i.watch)((()=>t.code),(()=>{t.code?r(t.link,t.code,t.filter):o()}),{immediate:!0}),Object(i.onBeforeUnmount)((()=>{o()})),{__sfc:!0,props:t,duplicates:s,isLoading:a,checkDuplicates:r,resetDuplicates:o,hasDuplicates:l}}}),c=s(44),u=Object(c.a)(l,(function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",[e._t("default",null,{isLoading:s.isLoading,duplicates:s.duplicates,hasDuplicates:s.hasDuplicates,reset:s.resetDuplicates})],2)}),[],!1,null,null,null);t.a=u.exports}}]);ype:"submit",disabled:a.isSubmitBtnDisabled}},[e._v(" "+e._s("Continuer")+" ")])],1):e._e()]),a.linkValueToValidate?t(a.CheckBlockedLinks,{staticClass:"space--mt-3",attrs:{link:a.linkValueToValidate},on:{request:a.setLinkErrors},scopedSlots:e._u([{key:"default",fn:function({isLoading:i,hasErrors:s,errors:n}){return[s?t(a.ControlLinkErrors,{attrs:{"error-messages":n},on:{cancel:a.resetLink}}):t(a.CheckLinkDuplicates,{attrs:{link:a.linkValueToValidate,filter:{type:{ne:a.MERCHANT_GENERIC_OFFER_TYPE}}},scopedSlots:e._u([{key:"default",fn:function({isLoading:n,hasDuplicates:r,duplicates:l,isSoftDuplicates:o}){return[t("div",[e.isEditing?e._e():t(a.GetLinkSuggestion,{attrs:{link:a.linkValueToValidate,"keep-alive":!i}}),t(a.GetLinkMerchantSuggestion,{attrs:{link:a.linkValueToValidate,"keep-alive":!i}}),r||s?e._e():t("div",{staticClass:"space--mt-3"},[t(a.FormWizardProgressBar,{attrs:{"is-loading":i||n,"has-errors":s||r},on:{end:a.continueWithLink}}),t("div",{staticClass:"space--mt-5 hAlign--all-c"},[t(a.FormWizardProgressBarInfo,{attrs:{list:a.progressBarInfolist}})],1)],1),r?t(a.ThreadDuplicates,{attrs:{type:a.DEAL_TYPE,threads:l,"is-soft-duplicates":o},on:{cancel:a.resetLink,continue:a.continueWithLink}}):e._e()],1)]}}],null,!0)})]}}],null,!1,998225480)}):e._e(),t(a.ControlLinkErrors,{attrs:{"error-messages":a.$v.messages.link},on:{cancel:a.resetLink}}),a.canSubmit?t("div",{staticClass:"hide--fromW2 space--mt-3"},[t(a.BaseButton,{staticClass:"width--all-12 space--mb-3",attrs:{variant:"primary",mode:"brand",type:"submit",disabled:a.isSubmitBtnDisabled}},[e._v(" "+e._s("Continuer")+" ")])],1):e._e()],1)]),a.canSubmit?t("div",{staticClass:"hAlign--all-c"},[t(a.BaseButton,{directives:[{name:"track",rawName:"v-track:submitWithoutLink.click",arg:"submitWithoutLink",modifiers:{click:!0}}],attrs:{variant:"tertiary",mode:"default"},on:{click:a.submitWithoutLink}},[e._v(" "+e._s("Je n'ai pas de lien")+" ")])],1):e._e()])}),[],!1,null,null,null),S=L.exports,y=Object(i.defineComponent)({__name:"step-link",props:{isEditing:{type:Boolean},currentStep:null},setup:e=>({__sfc:!0,FormWizardStepBase:s.a,FormWizardStepTitle:n.a,StepLinkForm:S})}),C=Object(_.a)(y,(function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t(a.FormWizardStepBase,{attrs:{"align-center":""},scopedSlots:e._u([{key:"title",fn:function(){return[t(a.FormWizardStepTitle,{staticClass:"hAlign--all-c"},[e._v(" "+e._s("Partagez un bon plan avec des millions de personnes")+" ")])]},proxy:!0},{key:"sub-title",fn:function(){return[t("p",{staticClass:"size--all-l size--fromW3-xxl text--color-charcoalTint hAlign--all-c"},[e._v(" "+e._s("Entrez le lien de la page où il est possible de profiter du deal / d'obtenir davantage d'informations.")+" ")])]},proxy:!0},{key:"form",fn:function(){return[e._t("default",(function(){return[t(a.StepLinkForm,{ref:"form",attrs:{"is-editing":e.isEditing,"current-step":e.currentStep},on:{continue:function(t){return e.$emit("continue",t)},"change-link":function(t){return e.$emit("trap")}}})]}))]},proxy:!0}],null,!0)})}),[],!1,null,null,null);t.default=C.exports},163:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(5);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{immediate:s=!1}=a,n=Object(i.ref)(!1);let r=null;function l(){n.value&&o(),n.value=!0,r=setInterval(e,t)}function o(){n.value=!1,clearInterval(r)}return s&&l(),Object(i.onUnmounted)(o),{isActive:n,set:l,clear:o}}},165:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(5),s=a(163),n=function(e){return e[e.NOT_STARTED=0]="NOT_STARTED",e[e.MAX_PROGRESS=99]="MAX_PROGRESS",e[e.FINISHED=100]="FINISHED",e}(n||{});const r=function(){let{timeConstant:e=1e4,stopOnMaxProgress:t=!1,intervalFrequency:a=1e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=Object(i.ref)(0),l=Object(i.ref)(0),o=Object(i.ref)(!1),{set:c,clear:u}=Object(s.a)(d,a);function d(){r.value+=a;const i=100*(1-Math.exp(-1*r.value/e));l.value=t?Math.min(i,n.MAX_PROGRESS):i}return{startLoader:function(){u(),d(),c(),o.value=!0},completeLoader:function(){u(),l.value=n.MAX_PROGRESS,setTimeout((()=>{l.value=n.FINISHED,o.value=!1}),a)},endLoader:function(){u(),l.value=n.FINISHED,o.value=!1},progressBarPercentage:l,isLoaderInProgress:o}}},570:function(e,t,a){var i=a(760),s=a(307);e.exports=function(e,t,a){return void 0===a&&(a=t,t=void 0),void 0!==a&&(a=(a=s(a))==a?a:0),void 0!==t&&(t=(t=s(t))==t?t:0),i(s(e),t,a)}},729:function(e,t,a){"use strict";var i={props:{alignCenter:{type:Boolean,default:!1}},computed:{containerClasses(){return{"boxAlign-ai--all-c":this.alignCenter}},hasTitle(){return!!this.$scopedSlots.title},hasSubTitle(){return!!this.$scopedSlots["sub-title"]}}},s=a(45),n=Object(s.a)(i,(function(){var e=this,t=e._self._c;return t("Transition",e._g({attrs:{appear:"",name:"slide-in","leave-active-class":"hide","leave-to-class":"hide"}},e.$listeners),[t("section",{staticClass:"flex flex--grow-1 flex--shrink-0 boxAlign-jc--all-c width--all-12",class:e.containerClasses},[t("div",{staticClass:"flex flex--dir-col space--fromW2-h-4 space--h-3 space--fromW3-t-6 space--b-4 boxAlign-ai--all-c width--all-12"},[e.hasTitle?t("div",{staticClass:"space--mb-4 width--all-12 width--max-pageNarrow"},[e._t("title")],2):e._e(),e.hasSubTitle?t("div",{staticClass:"space--mb-4 width--all-12 width--max-pageNarrow"},[e._t("sub-title")],2):e._e(),e._t("form"),e._t("footnotes")],2)])])}),[],!1,null,null,null);t.a=n.exports},730:function(e,t,a){"use strict";var i=a(45),s=Object(i.a)({},(function(e,t){return e("h1",{staticClass:"size--all-xxxl text--color-charcoal text--b",class:t.data.staticClass},[t._t("default")],2)}),[],!0,null,null,null);t.a=s.exports},760:function(e,t){e.exports=function(e,t,a){return e==e&&(void 0!==a&&(e=e<=a?e:a),void 0!==t&&(e=e>=t?e:t)),e}},889:function(e,t,a){"use strict";var i=a(5),s=a(544),n=a(616),r=a(715);const l=()=>{let e=null;const t=Object(i.ref)([]),a=Object(i.ref)(!1),{isLoading:l,setLoader:o}=Object(s.a)(),c=()=>{t.value=[],a.value=!1,l.value&&Object(r.a)(e)};return{duplicates:t,checkDuplicates:(i,s)=>{i&&(c(),((i,s)=>{e=Object(n.a)(i,s),e.request.then((e=>{e&&(t.value=e.threads,a.value=e.isSoftDuplicates)})).finally(o())})(i,s))},resetDuplicates:c,isLoading:l,isSoftDuplicates:a}};var o=Object(i.defineComponent)({__name:"check-link-duplicates",props:{link:null,filter:null},setup(e){const t=e,{duplicates:a,isLoading:s,isSoftDuplicates:n,checkDuplicates:r,resetDuplicates:o}=l(),c=Object(i.computed)((()=>!!a.value.length));return Object(i.watch)((()=>t.link),(()=>{r(t.link,t.filter)}),{immediate:!0}),Object(i.onBeforeUnmount)((()=>{o()})),{__sfc:!0,props:t,duplicates:a,isLoading:s,isSoftDuplicates:n,checkDuplicates:r,resetDuplicates:o,hasDuplicates:c}}}),c=a(45),u=Object(c.a)(o,(function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",[e._t("default",null,{isLoading:a.isLoading,duplicates:a.duplicates,isSoftDuplicates:a.isSoftDuplicates,hasDuplicates:a.hasDuplicates,reset:a.resetDuplicates})],2)}),[],!1,null,null,null);t.a=u.exports},961:function(e,t,a){"use strict";var i=a(570),s=a.n(i),n={props:{value:{type:Number,required:!0},max:{type:Number,default:100},color:{type:String,default:""}},computed:{percentage(){return Math.round(100*s()(this.value/this.max,0,1))},colorClass(){return this.color?"text--color-".concat(this.color):null}}},r=a(45),l=Object(r.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"progressBar",class:e.colorClass,attrs:{"aria-label":`${e.percentage}%`}},[t("div",{staticClass:"progressBar-progress",style:{right:100-e.percentage+"%"}})])}),[],!1,null,null,null);t.a=l.exports},963:function(e,t,a){"use strict";var i=a(93),s=a(654),n=a(715),r=a(611);let l=null,o=null;var c={props:{link:{type:String,default:""},keepAlive:{type:Boolean,default:!1}},watch:{link:{handler:"linkChange",immediate:!0}},beforeDestroy(){this.keepAlive||this.cancelRequest()},methods:Object.assign({},Object(i.b)("threadForm",["getFormSuggestionsFromLink","getProductSpecificationFromLink","clearFormSuggestionsFromLink"]),{linkChange(e,t){e!==t&&(this.reset(),this.link&&(this.request(),this.requestProductSpecification()))},async request(){l=await this.getFormSuggestionsFromLink({url:this.link}),l&&l.request.then(r.a).catch((()=>{})).finally(Object(s.a)(this,"isLoading"))},async requestProductSpecification(){o=await this.getProductSpecificationFromLink({url:this.link}),o&&o.request.catch((()=>{}))},cancelRequest(){this.isLoading&&(Object(n.a)(l),Object(n.a)(o))},reset(){this.cancelRequest(),this.clearFormSuggestionsFromLink()}}),render(){return this.$scopedSlots.default?this.$scopedSlots.default({isLoading:this.isLoading}):null}},u=a(45),d=Object(u.a)(c,undefined,undefined,!1,null,null,null);t.a=d.exports}}]);