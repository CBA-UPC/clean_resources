(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2793],{92793:function(e,t,n){"use strict";n.r(t),n.d(t,{servicePush:);var r,a=n(809),i=n.n(a),o=n(92447),s=n(38347),c=n(81923),u=n.n(c),f=(n(42567),n(32196)),p=n(6188),l=!f.sk&&"undefined"!==typeof(null===(r=navigator)||void 0===r?void 0:r.serviceWorker),d=function(e){var t=e.data,n=(t=void 0===t?{}:t).firebaseMessaging;if(n){var r=n.payload.notification,a=n.type,i=r.title,o=r.click_action,c=void 0===o?window.location.pathname:o,u=(0,s.Z)(r,["title","click_action"]);switch(a){case"notification-clicked":window.location.push(c);break;case"push-received":new Notification(i,u).addEventListener("click",()}}},b={init:function(){var e=this;return(0,o.Z)(i().mark((function t(){var n,r,a,o,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={apiKey:"AIzaSyCQacdw4a3CGV8PWBTBpxacVdo68vPePqU",projectId:"life-test-259610",messagingSenderId:"1028984457389",appId:"1:1028984457389:web:d2f019bde222eee48d5e24"},u().apps.length){t.next=18;break}return u().initializeApp(n),l&&navigator.serviceWorker.addEventListener("message",d),t.prev=4,r=u().messaging(),t.next=8,r.getToken();case 8:if(a=t.sent,localStorage.setItem("fcm_token",a),o=JSON.parse(localStorage.getItem("subscribeToPushNotification")),s=o.lastDateInSec,!(Math.round((new Date).getTime()/1e3)-s>604800)){t.next=14;break}return t.next=14,e.subscribe();case 14:t.next=18;break;case 16:t.prev=16,t.t0=t.catch(4);case 18:case"end":return t.stop()}}),t,null,[[4,16]])})))()},getToken:function(){return(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u().messaging(),e.next=3,t.getToken();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},isSubscribed:function(){return(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Notification&&"granted"===Notification.permission&&!!localStorage.getItem("fcm_token"));case 1:case"end":return e.stop()}}),e)})))()},subscribe:function(){return(0,o.Z)(i().mark((function e(){var t,n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window,!(n=t.Notification)||"granted"!==n.permission){e.next=10;break}return e.next=4,b.getToken();case 4:return r=e.sent,localStorage.setItem("fcm_token",r),e.next=8,p.bl.post("/push/subscribe",{token:r});case 8:localStorage.removeItem("subscribeToPushNotification"),localStorage.setItem("subscribeToPushNotification",JSON.stringify({lastDateInSec:Math.round((new Date).getTime()/1e3),wasSubscribed:!0,token:r}));case 10:case"end":return e.stop()}}),e)})))()},unsubscribe:function(){return(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getToken();case 2:return t=e.sent,e.next=5,p.bl.post("/push/unsubscribe",{token:t});case 5:localStorage.removeItem("subscribeToPushNotification"),localStorage.removeItem("fcm_token"),localStorage.setItem("subscribeToPushNotification",JSON.stringify({lastDateInSec:Math.round((new Date).getTime()/1e3),wasSubscribed:!1,token:null}));case 8:case"end":return e.stop()}}),e)})))()},destroy:function(){return(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l&&navigator.serviceWorker.removeEventListener("message",d);case 1:case"end":return e.stop()}}),e)})))()}}}}]);