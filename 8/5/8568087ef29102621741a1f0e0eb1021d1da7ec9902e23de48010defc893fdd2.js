(function(w,x){var h=Brid.Util,I=Brid.event;w.$bp.Advertising=Brid.Abstract.extend({currentAdsManager:null,adManagers:[],adSDKConfigReference:{brid:"VAST",ima:"GoogleIMA"},_iqAvailable:!1,adsLog:init:function a(c,b){if(c.config.hideAdContainer)return null;a.base.call(this,c,b);this.adsLog("Advertising init",c.tag);this.el=this.createElement();this.somse="";this.skippedFired=!1;this.adsPool=[];this.ads={};this.adManagers=[];this.currentAdsManager=null;
this.optimize_price=this.player.config.optimize_price;b=this.ads;var d=c.config;c.advertising=!0;b.adOffset=d.adOffset?parseInt(d.adOffset):0;b.adFrequency=d.adFrequency?parseInt(d.adFrequency):0;b.bridAdPartner=!!d.Partner.bridAdPartner;b.adFrequency=0===b.adFrequency?1:b.adFrequency;Brid.log("Advertising ads.adOffset",b.adOffset,"ads.adFrequency",b.adFrequency);b=function(a,b){var d=[],e=!1;a&&a.map(;if(1===d.length&&"VAST"==d[0]){var f=[];if(c.currentSource.id&&
c.currentSource.Ad||0<c.videos.length&&c.videos[0].Ad)c.currentSource.id&&c.currentSource.Ad?(Brid.log("Take ads from currentSource"),a=c.currentSource.Ad):(Brid.log("Take ads from first video"),a=c.videos[0].Ad),Brid.log("playerAds",a),a.map(;else if(c.config.AdSchedule){Brid.log("Take ads from new player settings");
var r=c.config.AdSchedule;h.each(["preroll","midroll","postroll"],}else c.config.Ad&&(Brid.log("Take ads from player settings"),a=c.config.Ad,Brid.log("playerAds",a),a.map();Brid.log("Final Array",f);if(0<f.length)for(a=0;a<f.length;a++)if(Brid.log("Check url: ",f[a]),f[a].url){if(f[a].url&&(-1!=f[a].url.indexOf("googleads")||-1!=f[a].url.indexOf("21760922134")||-1!=f[a].url.indexOf("brid_parser=ima"))){e=!0;break}}else if(f[a]&&(-1!=f[a].indexOf("googleads")||
-1!=f[a].indexOf("21760922134")||-1!=f[a].indexOf("brid_parser=ima"))){e=!0;break}a=c.config.Partner;if(a.program){var l=a.program;a=l.desktop;var l=l.mobile,p=a&&0<a.length,u=l&&0<l.length;if(l=Brid.isMobilePlatform?u?l:[]:p?a:l)for(a=0;a<l.length;a++)if(l[a].url&&l[a].url&&(-1!=l[a].url.indexOf("googleads")||-1!=l[a].url.indexOf("21760922134")||-1!=l[a].url.indexOf("brid_parser=ima"))){e=!0;break}}}0===d.length?d=Brid.isMobilePlatform?["VAST","GoogleIMA"]:["GoogleIMA","VAST"]:1===d.length&&("VAST"===
d[0]&&e&&d.push("GoogleIMA"),"GoogleIMA"===d[0]&&d.push("VAST"));return d}(d.adSDK,this.adSDKConfigReference);Brid.log("Advertising adManagerClasses",b);b.map(this.$f();c.adsManager=this;if(c.isReady)this.onPlayerReady();else c.addOnce("ready",this.$f(this.onPlayerReady));(h.isAmp()||c.config.use_tcfapi_locator)&&this.createTCFInsideIframe();c.add("newContent",this.$f(this.checkScheduledAds));
c.add(["stopped","skipped"],this.$f(this.onEnded));c.add("playerresize",this.$f(this.onResize));c.add("start",this.$f(this.resetSkippedFired))},createElement:techCall:techGet:resetSkippedFired:onPlayerReady:setupAdsLoader:checkScheduledAds:function(a){this.adsLog("Advertising checkScheduledAds");a&&"newContent"==a.type&&(this.player.config.AdSchedule||this.player.config.Ad)&&(this.adsLog("Advertising adsPool reset"),this.adsPool=[]);var c=this,b,d=this.player,f=this.ads,e=d.currentSource,m=d.config.AdSchedule?!0:!1,n=e.Ad;if(0==this.adsPool.length)if(this.adsLog("Advertising adsPool setup"),Brid.log("Advertising adsPool setup currentSouurce",
e),m){d.config.loop_ads&&(Brid.log("Loop ADS cuepoint setup"),d.config.AdSchedule.data||(d.config.AdSchedule.data={}),d.config.AdSchedule.data.midroll||(d.config.AdSchedule.data.midroll={adTimeType:"s",cuepoints:""}),0<parseInt(d.config.loop_frequency)&&e.duration&&0<parseInt(e.duration)&&(d.config.AdSchedule.data.midroll.cuepoints="2"),0<parseInt(d.config.loop_frequency)&&"object"==typeof d.config.video&&(d.config.AdSchedule.data.midroll.cuepoints="2"));if(d.config.loop_pods&&(Brid.log("Loop PODS cuepoint setup"),
d.config.AdSchedule.data||(d.config.AdSchedule.data={}),d.config.AdSchedule.data.midroll||(d.config.AdSchedule.data.midroll={adTimeType:"s",cuepoints:""}),0<parseInt(d.config.pod_frequency)&&e.duration&&0<parseInt(e.duration)))for(d.config.AdSchedule.data.midroll.cuepoints="",m=1;m<parseInt(e.duration/d.config.pod_frequency)+1;m++)d.config.AdSchedule.data.midroll.cuepoints+=m*d.config.pod_frequency,m<parseInt(e.duration/d.config.pod_frequency)&&(d.config.AdSchedule.data.midroll.cuepoints+=",");var q=
{preroll:{adTimeType:"s",adType:"0"},midroll:{adType:"1"},postroll:{adTimeType:"s",adType:"2"},overlay:{adType:"3",adTimeType:"s"},banner:{adType:"4",adTimeType:"s"}},r=JSON.parse(JSON.stringify(d.config.AdSchedule));h.each(["preroll","midroll","postroll","overlay","banner"],}else this.adsPool=d.config.Ad?JSON.parse(JSON.stringify(d.config.Ad)):[];this.flagOurAd=!1;this.priority=0;this.ourAdPos=-1;f.overlay=f.midroll=f.postroll=f.preroll=f.banner=null;d.hasPreroll=!1;d.hasPostroll=!1;d.hasMidroll=!1;d.hasOverlay=!1;d.values.lastMidrollPlayedAt=null;d.values.midrollsSet=null;d.remove("beforeStart",this.$f(this.onBeforeStart));
d.remove("timeupdate",this.$f(this.checkForAd));this.adManagers=this.adManagers.filter(function(a){return!a.error});if(this.player.config.monetize)if(d.showOnAd()||d.tech.support.monetizable&&e.monetize&&this.checkOffsetAndFrequency()&&0!==this.adManagers.length){if(d.config.freqCap&&(e=h.getLocalStorage(d.config.id+"_cap"),!(a&&a.data&&a.data.reinit)&&e&&"1"===e))return;this.contentCompleteCalled=!1;0<this.adsPool.length&&this.adsPool.map(;n&&n.map(;a=f.preroll;var n=f.midroll,e=f.postroll,m=f.overlay,l=f.banner;a&&(a.adTags=this.selectAdTagsByPlatform(a));n&&(n.adTags=this.selectAdTagsByPlatform(n),n.cuepoints=n.cuepoints.split(",").map();e&&(e.adTags=this.selectAdTagsByPlatform(e));l&&(l.adTags=this.selectAdTagsByPlatform(l));m&&(m.adTags=this.selectAdTagsByPlatform(m));var p=d.config.Partner,u=d.currentSource.age_gate_id?parseInt(d.currentSource.age_gate_id):
0;Brid.log("Advertising checkForScheduledAds ageGateID",u);var g=p.program;p.exclude&&g&&(g=this.excludeDfpBackfill(g,p.exclude));if(!this.flagOurAd&&f.bridAdPartner&&2>u&&g&&((this.networkAdTags=this.selectAdTagsByPlatform(g))||g.backfill_prebid||g.backfill_a9)){this.networkAdTags&&(b=this.networkAdTags[0]);Brid.log("Ad program networkAdTags",b,"Ad program prebid tags",g.backfill_prebid,"Ad program A9 tags",g.backfill_a9);if(a){a.adTags=a.adTags||[[]];-1<p.mb.indexOf("b")&&(g.backfill_prebid&&g.backfill_prebid.preroll||
g.backfill_a9&&g.backfill_a9.preroll)&&(a.adTags=a.adTags.map(function(a,b){g.backfill_prebid&&g.backfill_prebid.preroll&&g.backfill_prebid.preroll[b]&&(a=a.concat(g.backfill_prebid.preroll[b]));g.backfill_a9&&g.backfill_a9.preroll&&g.backfill_a9.preroll[b]&&(a=a.concat(g.backfill_a9.preroll[b]));return a}));b&&(a.adTags=a.adTags.map(function(a){if("b"==p.mb)return a.concat(b);if("f"==p.mb)return b.concat(a);if("bf"==p.mb)return b.concat(a).concat(b)}));if(-1<p.mb.indexOf("f"))if("f"==p.mb){if(g.backfill_prebid&&
g.backfill_prebid.preroll||g.backfill_a9&&g.backfill_a9.preroll)a.adTags=a.adTags.map(function(a,b){g.backfill_prebid&&g.backfill_prebid.preroll&&g.backfill_prebid.preroll[b]&&(a=[g.backfill_prebid.preroll[b]].concat(a));g.backfill_a9&&g.backfill_a9.preroll&&g.backfill_a9.preroll[b]&&(a=[g.backfill_a9.preroll[b]].concat(a));return a})}else if(g.frontfill_prebid&&g.frontfill_prebid.preroll||g.frontfill_a9&&g.frontfill_a9.preroll)a.adTags=a.adTags.map(function(a,b){g.frontfill_prebid&&g.frontfill_prebid.preroll&&
g.frontfill_prebid.preroll[b]&&(a=[g.frontfill_prebid.preroll[b]].concat(a));g.frontfill_a9&&g.frontfill_a9.preroll&&g.frontfill_a9.preroll[b]&&(a=[g.frontfill_a9.preroll[b]].concat(a));return a});a.adTags.priority=0;a.adTags.pod=0}if(e){e.adTags=e.adTags||[[]];-1<p.mb.indexOf("b")&&(g.backfill_prebid&&g.backfill_prebid.postroll||g.backfill_a9&&g.backfill_a9.postroll)&&(e.adTags=e.adTags.map(function(a,b){g.backfill_prebid&&g.backfill_prebid.postroll&&g.backfill_prebid.postroll[b]&&(a=a.concat(g.backfill_prebid.postroll[b]));
g.backfill_a9&&g.backfill_a9.postroll&&g.backfill_a9.postroll[b]&&(a=a.concat(g.backfill_a9.postroll[b]));return a}));b&&(e.adTags=e.adTags.map(function(a){if("b"==p.mb)return a.concat(b);if("f"==p.mb)return b.concat(a);if("bf"==p.mb)return b.concat(a).concat(b)}));if(-1<p.mb.indexOf("f"))"f"==p.mb&&(g.backfill_prebid&&g.backfill_prebid.postroll||g.backfill_a9&&g.backfill_a9.postroll)&&(e.adTags=e.adTags.map(function(a,b){g.backfill_prebid&&g.backfill_prebid.postroll&&g.backfill_prebid.postroll[b]&&
(a=[g.backfill_prebid.postroll[b]].concat(a));g.backfill_a9&&g.backfill_a9.postroll&&g.backfill_a9.postroll[b]&&(a=[g.backfill_a9.postroll[b]].concat(a));return a}));else if(g.frontfill_prebid&&g.frontfill_prebid.preroll||g.frontfill_a9&&g.frontfill_a9.preroll)e.adTags=e.adTags.map(function(a,b){g.frontfill_prebid&&g.frontfill_prebid.postroll&&g.frontfill_prebid.postroll[b]&&(a=[g.frontfill_prebid.postroll[b]].concat(a));g.frontfill_a9&&g.frontfill_a9.postroll&&g.frontfill_a9.postroll[b]&&(a=[g.frontfill_a9.postroll[b]].concat(a));
return a});e.adTags.priority=0;e.adTags.pod=0}if(n){n.adTags=n.adTags||[[]];-1<p.mb.indexOf("b")&&(g.backfill_prebid&&g.backfill_prebid.midroll||g.backfill_a9&&g.backfill_a9.midroll)&&(n.adTags=n.adTags.map();b&&(n.adTags=n.adTags.map(function(a){if("b"==
p.mb)return a.concat(b);if("f"==p.mb)return b.concat(a);if("bf"==p.mb)return b.concat(a).concat(b)}));if(-1<p.mb.indexOf("f"))if("f"==p.mb){if(g.backfill_prebid&&g.backfill_prebid.midroll||g.backfill_a9&&g.backfill_a9.midroll)n.adTags=n.adTags.map(function(a,b){g.backfill_prebid&&g.backfill_prebid.midroll&&g.backfill_prebid.midroll[b]&&(a=[g.backfill_prebid.midroll[b]].concat(a));g.backfill_a9&&g.backfill_a9.midroll&&g.backfill_a9.midroll[b]&&(a=[g.backfill_a9.midroll[b]].concat(a));return a})}else if(g.frontfill_prebid&&
g.frontfill_prebid.midroll||g.frontfill_a9&&g.frontfill_a9.midroll)n.adTags=n.adTags.map(;n.adTags.priority=0;n.adTags.pod=0}a||n||e||(a=f.preroll={adTimeType:"s",adType:"0",cuepoints:null,overlayDuration:"10",overlayStartAt:null,played:!1},a.adTags=
a.adTags||[[]],a.adTags=a.adTags[0].concat([b]),a.adTags.priority=0,a.adTags.pod=0)}d.hasPreroll=!!(a&&a.adTags&&a.adTags.length&&a.adTags.some(function(a){return 0<a.length}));d.hasPostroll=!!(e&&e.adTags&&e.adTags.length&&e.adTags.some(function(a){return 0<a.length}));d.hasMidroll=!!(n&&n.adTags&&n.adTags.length&&n.adTags.some(function(a){return 0<a.length}));d.hasOverlay=!!(m&&m.adTags&&m.adTags.length&&m.adTags.some();d.hasBanner=!1;d.A9&&d.Prebid&&(d.hasPreroll&&
(a.adTags=this.mergeA9WithPrebid(a.adTags)),d.hasMidroll&&(n.adTags=this.mergeA9WithPrebid(n.adTags)),d.hasPostroll&&(e.adTags=this.mergeA9WithPrebid(e.adTags)));if(!this.flagOurAd&&(l&&(l.adTags||l.mobile)||g&&g.banner)){var l=l||{mobile:[],adType:"4"},u=g&&g.banner,k=!!(d.config.Prebid&&d.config.Prebid.midroll&&d.config.Prebid.midroll.length||d.config.A9&&d.config.A9.midroll&&d.config.A9.midroll.length),v=!1;d.hasBanner=!0;Brid.log("Advertising add BannerAd",l,u);this.bannerManagerAdded||(this.adManagers.push(new Brid.BannerAd(d,
{container:this.el,wrapper:this})),this.bannerManagerAdded=!0);var t=l.adTags||l.mobile||[],t="string"===typeof t?[t]:t;Array.isArray(t[0])&&(t[0]=t[0][0]);l.adTags=t;u&&(l.adTags=l.adTags.concat(u));l.adTags.map(function(a){Brid.log("Advertising add BannerAd",a.overlayDuration,l.overlayDuration);var b=a[0]?a[0]:a.url?a:{id:"",url:a};b.url&&-1!=b.url.indexOf("<|>")||(b.url+="<|>"+(void 0===a.overlayDuration?l.overlayDuration:a.overlayDuration)||"")});if(d.hasMidroll||n&&n.adTags&&k)Brid.log("Add banner fallback for midroll"),
d.config.banner_is_fallback?n.adTags=n.adTags.map(function(a){return a.concat(l.adTags.slice())}):n.adTags.push(l.adTags.slice()),v=!0;d.hasPreroll?d.config.banner_is_fallback?a.adTags=a.adTags.map(:a.adTags.push(l.adTags.slice()):v||(l.adTags=[l.adTags],a=f.preroll=l,d.hasPreroll=!0);d.hasPreroll&&(f.preroll.adTags.priority=0,f.preroll.adTags.pod=0)}Brid.log("Advertising preroll",a,"midroll",n,"postroll",e,"overlay",m);d.tech.support.adManagement?(f.bridAd=
this.networkAdTags,f.flagOurAd=this.flagOurAd,d.techCall("ads",f),g&&d.techCall("setProgram",g),this.techCall("destroyAdsLoader"),this.hide()):(this.show(),(d.hasPreroll||d.config.loop_pods)&&d.add("beforeStart",this.$f(this.onBeforeStart)),(d.hasMidroll||d.hasOverlay)&&d.add("timeupdate",this.$f(this.checkForAd)),d.add("ended",this.$f(this.onEnded)))}else Brid.warn("Advertising Shouldn't play ads on non monetizable techs | Video or player not monetized | No Ad Managers initialized due to Ad Blocker or Network Error"),
this.hide(),this.frequencyLimit=!0,this.techCall("destroyAdsLoader")},checkOffsetAndFrequency:onBeforeStart:checkPreroll:checkForMidroll:checkForOverlay:checkForAd:getScheduledCuepoints:getFloorPriceBasic:getFloorPrice:removePassedCuepoints:mergeA9WithPrebid:function(a){for(var c,b,d=["normal","backfill","frontfill"],f=e=0;e<a.length;e++){if(this.player.config.AdSchedule){Brid.log("mergeA9WithPrebid AdSchedule exists",JSON.parse(JSON.stringify(a[e])));var m=a[e].filter(function(a){return"prebid-smartadserver"==a.source&&f(a,"normal")}),
h=a[e].filter(function(a){return"prebid"==a.source&&f(a,"normal")}),q=a[e].filter(;if(0<h.length&&0<q.length)for(var r=0;r<q.length;r++)for(var l=0;l<h.length;l++)q[r].id==h[l].id&&(Brid.log("Merge A9 and Prebid with the same ad source id"),(b=q[r].url.match(/[&?]cust_params=(.*)(&|$)/i))&&b[1]&&(c=b[1].split("%26").filter(function(a){return 0==a.indexOf("amzn")}),0<c.length&&(Brid.log("A9 merging params to prebid url",c,h[l].data),b=a[e].indexOf(h[l]),
c=h[l].url.replace(/[&?]cust_params=/i,"$&"+c.join("%26")+"%26"),c={id:q[r].id,sc:q[r].sc,url:c,source:"combined",data:h[l].data},a[e]=a[e].filter(function(a){return a.id!=q[r].id}),a[e].splice(b,0,c))));if(0<m.length&&0<q.length)for(r=0;r<q.length;r++)for(l=0;l<m.length;l++)q[r].id==m[l].id&&(Brid.log("Merge A9 and Prebid smartadserver with the same ad source id"),(b=q[r].url.match(/[&?]cust_params=(.*)(&|$)/i))&&b[1]&&(c=b[1].split("%26").filter(function(a){return 0==a.indexOf("amzn")}),0<c.length&&
(Brid.log("Merge A9 and Prebid smartadserver",c,m[l].data),b=a[e].indexOf(m[l]),(h=c.find(function(a){return 0===a.indexOf("amznsz")}))&&c.push(h.replace("amznsz","size")),c=m[l].url.replace(/([&?]tgt=)/i,"\\$1"+c.join("%3B")+"%3B"),c={id:q[r].id,sc:q[r].sc,url:c,source:"combined",data:m[l].data},a[e]=a[e].filter(,a[e].splice(b,0,c))))}d.forEach(function(b){var c,d=a[e].find(function(a){return"prebid-smartadserver"==a.source&&f(a,b)});var k=a[e].find(function(a){return"prebid"==
a.source&&f(a,b)});var h=a[e].find(;if(k&&h&&(c=h.url.match(/[&?]cust_params=(.*)(&|$)/i))&&c[1]){var m=c[1].split("%26").filter(function(a){return 0==a.indexOf("amzn")});0<m.length&&(Brid.log("Merge A9 and Prebid",b,m,k.data),c=a[e].indexOf(k),m=k.url.replace(/[&?]cust_params=/i,"$&"+m.join("%26")+"%26"),k={id:"",url:m,source:"combined",data:k.data},a[e]=a[e].filter(function(a){return!f(a,b)}),a[e].splice(c,0,k))}d&&h&&(c=h.url.match(/[&?]cust_params=(.*)(&|$)/i))&&
c[1]&&(m=c[1].split("%26").filter(,0<m.length&&(Brid.log("Merge A9 and Prebid smartadserver",b,m,d.data),c=a[e].indexOf(d),(h=m.find()&&m.push(h.replace("amznsz","size")),m=d.url.replace(/([&?]tgt=)/i,"\\$1"+m.join("%3B")+"%3B"),k={id:"",url:m,source:"combined",data:d.data},a[e]=a[e].filter(,a[e].splice(c,0,k)))})}return a},onEnded:checkPostroll:iframeHasFocus:setAd:appendPod:replacePrebidTag:playAd:selectAdTagsByPlatform:excludeDfpBackfill:function(a,c){var b={},d=a.desktop&&0<a.desktop.length,f=a.mobile&&0<a.mobile.length,e=a.banner&&0<a.banner.length,d=Brid.isMobilePlatform?f?a.mobile:null:d?a.desktop:a.mobile;a.backfill_prebid&&(b.backfill_prebid=a.backfill_prebid);a.backfill_a9&&(b.backfill_a9=a.backfill_a9);if(d){var m=
"";Brid.isMobilePlatform?(b.mobile=[],m="mobile"):(b.desktop=[],m="desktop");d=d.map(}e&&a.banner.map(function(a,c){-1==a.url.indexOf("google")&&(b.banner||(b.banner=[]),b.banner.push(a))});return b},selectPriorityAdTag:function(a){var c=null,b=this.player.config,d=b.Partner.program;Brid.log("Advertising selectPriorityAdTag",a);if(!a||0==a.length)return!1;
(this.flagOurAd?!this.ads.overlay||!this.ads.overlay.playing:1)&&a[a.pod]&&a.priority<a[a.pod].length?(c=a[a.pod][a.priority],a.priority++):a.priority=0;Brid.log("Advertising tag",c,"pod",a.pod,"priority",a.priority);if(b.loop_ads&&c&&c.frequency&&0<c.frequency&&(this.adSourceRequestNumArray||(this.adSourceRequestNumArray={}),this.adSourceRequestNumArray[c.id]||(this.adSourceRequestNumArray[""+c.id]=0),this.adSourceRequestNumArray[""+c.id]++>=c.frequency))return!1;c&&0==a.pod&&(this.player.slotImps=
this.player.sessionImps);this.flagOurAd=!!(c&&b.backfill_monetize&&d&&(d.desktop&&-1!==d.desktop.indexOf(c)||d.mobile&&-1!==d.mobile.indexOf(c)||d.banner&&-1!==d.banner.indexOf(c)))||c&&c.backfill;c&&c.url&&0===c.url.indexOf("http://")&&(c.url=c.url.substr(5));return c},selectAdsManager:preRequestAd:getAdData:requestAd:function(a){nction f(a){Brid.error("--- BridPlayer --- IP fetch failed",a);Promise.resolve("IP ERROR")}n g(a){Brid.exLog("requestAd: ",a,"currentAdsManager",z.name);Brid.log("doRequest: ","tag",a,"pod",t.adTags.pod,"priority",t.adTags.priority);if(Brid.Util.adBlockerEnabled)k.trigger("adBlock",{flagOurAd:v.flagOurAd,at:t.adType,am:z.name,ai:t.currentID});else{var b=t.adTags.pod,c=t.adTags.priority-1;v.flagOurAd?(0>v.ourAdPos&&(v.ourAdPos=c),k.trigger("ourAdRequest",{am:z.name,at:"BannerAd"===z.name?"4":t.adType,pp:b,wp:c-v.ourAdPos,baid:t.adTags[b][c].id})):
k.showOnAd()?k.trigger("adUnitRequest",{am:z.name,at:"BannerAd"===z.name?"4":t.adType,pp:b,wp:c,baid:t.adTags[b][c].id,sc:t.adTags[b][c].sc,bidder:t.adTags[b][c].bidder}):k.showOnAd()||(Brid.log("Brid Advertising trigger partnerAdRequest",c),k.trigger("partnerAdRequest",{am:z.name,at:"BannerAd"===z.name?"4":t.adType,pp:b,wp:c,baid:t.adTags[b][c].id,sc:t.adTags[b][c].sc,bidder:t.adTags[b][c].bidder}))}if("3"!=t.adType){b="";for(c=32;0<c;--c)b+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*
Math.random())];v.somse=b;k.trigger("requestAd",t);k.add("adImpression",function(){Array.prototype.slice.call(arguments,1);(!arguments[0].data||arguments[0].data.s&&arguments[0].data.s!=v.somse)&&k.trigger("incrementCredit")});k.add("adEnd",}v.doStartAdCalled=!1;v.techCall("requestAd",a)}var k=this.player,v=this,t=this.currentAdObject;var A=
t.adTags.priority-1;var G=x.BridIframeBurst?w.top:w,y=G.document;k.fireTicks&&0==t.adType&&0==t.adTags.pod&&0==A&&!this.flagOurAd&&(k.timer.tick("request"),k.trigger("tick",{tickType:"rq",tickTime:k.timer.ticks.request}));k.waitingForAd=!0;0==t.adTags.pod&&0==A&&(this.adPlayed=!1);this.checkGdprCalled=this.adErrored=this.isPodTag=this.adSkipped=!1;this.contextualHash=btoa('{"url":"'+G.location.href+'"}');var z=this.currentAdsManager=this.selectAdsManager(a);A=-1<a.indexOf("doubleclick")&&25>a.indexOf("doubleclick");
var I=-1<a.indexOf("springserve")&&15>a.indexOf("springserve");if(this.player.values.tcfActionNotCompleted)Brid.log("GDPR __tcfapi user action not completed"),this.onContentResumeRequested();else if(!k.isPipActive||"BannerAd"!==z.name&&"3"!==this.currentAdObject.adType){this.tempTime||0!=t.adTags.pod||(this.tempTime=k.currentTime());if(k.config.autoplayStickyAdOnly||k.config.pause_after_preroll)void 0===k.config.autoplayInviewOriginal&&(k.config.autoplayInviewOriginal=k.config.autoplayInview),k.closed=
!1;if(z&&!z.error){if(A&&"GoogleIMA"==z.name)this.hasAdRules=-1!=a.indexOf("ad_rule=1");else{this.hasAdRules=!1;if(-1!=a.toLowerCase().indexOf("[timestamp]")){var C=(new Date).getTime();a=b(a,"[timestamp]",C)}-1!=a.toLowerCase().indexOf("[referrer_url]")&&(a=b(a,"[referrer_url]",encodeURIComponent(A?h.getEmbededUrl():y.referrer)))}if(-1!=a.toLowerCase().indexOf("[brid_upr]")){var y=400,C=k.highestBid,H=0,E=0,D=4,D="";k.config.Partner.floor_setup&&k.config.Partner.floor_setup.default_floor_val&&(y=
parseInt(k.config.Partner.floor_setup.default_floor_val));k.config.Partner.floor_setup&&k.config.Partner.floor_setup.default_floor_geo&&k.config.Partner.floor_setup.default_floor_geo[k.config.co]&&(y=parseInt(k.config.Partner.floor_setup.default_floor_geo[k.config.co]));var J=1E3;k.config.Partner.floor_setup&&k.config.Partner.floor_setup.max_floor_val&&(J=parseInt(k.config.Partner.floor_setup.max_floor_val));var K=400;k.config.Partner.floor_setup&&k.config.Partner.floor_setup.min_floor_val&&(K=parseInt(k.config.Partner.floor_setup.min_floor_val));
k.Prebid&&k.Prebid.cachedBids&&0<k.Prebid.cachedBids.length&&(H=k.Prebid.cachedBids[0].cpm);k.A9&&k.A9.cachedBids&&0<k.A9.cachedBids.length&&(E=k.A9.cachedBids[0].cpm);D=Math.max(H,E,C);0<D&&(y=parseInt(120*D),y=25<y%50?y-y%50+50:y-y%50,y=y>J?J:y,y=y<K?K:y);D="brid"+y;k.config.Partner.upr_values&&k.config.Partner.upr_values[y]&&(D=k.config.Partner.upr_values[y]);a=b(a,"[brid_upr]",D)}-1!=a.toLowerCase().indexOf("[description_url]")&&(a=b(a,"[description_url]",encodeURIComponent(h.getEmbededUrl())));
-1!=a.toLowerCase().indexOf("[page_url]")&&(a=b(a,"[page_url]",encodeURIComponent(h.getEmbededUrl())));-1!=a.toLowerCase().indexOf("[video_title]")&&(a=b(a,"[video_title]",encodeURIComponent(k.currentSource.title)));-1!=a.toLowerCase().indexOf("[video_duration]")&&(a=b(a,"[video_duration]",k.duration()||k.currentSource.duration));-1!=a.toLowerCase().indexOf("[video_channel]")&&(a=b(a,"[video_channel]",encodeURIComponent(k.currentSource&&k.currentSource.channel&&k.currentSource.channel.name||"")));
-1!=a.toLowerCase().indexOf("[video_id]")&&(a=b(a,"[video_id]",k.currentSource.id));-1!=a.toLowerCase().indexOf("[player_width]")&&k.el&&(k.el.clientWidth||parseInt(k.el.style.width))&&(a=b(a,"[player_width]",k.el.clientWidth||parseInt(k.el.style.width)));-1!=a.toLowerCase().indexOf("[player_height]")&&k.el&&(k.el.clientHeight||parseInt(k.el.style.height))&&(a=b(a,"[player_height]",k.el.clientHeight||parseInt(k.el.style.height)));-1!=a.toLowerCase().indexOf("[player_id]")&&(a=b(a,"[player_id]",k.config.id));
-1!=a.toLowerCase().indexOf("[player_os]")&&(a=b(a,"[player_os]","l"==h.getOS()?"o":h.getOS()));-1!=a.toLowerCase().indexOf("[player_type]")&&(a=b(a,"[player_type]","Brid.Player"==k.name?"p":"o"));-1!=a.toLowerCase().indexOf("[player_size]")&&(a=b(a,"[player_size]",k.config.id+"_"+k.getSizeStr()));-1!=a.toLowerCase().indexOf("%5bplayer_size%5d")&&(a=b(a,"%5Bplayer_size%5D",k.config.id+"_"+k.getSizeStr()));-1!=a.toLowerCase().indexOf("[autoplay]")&&(a=b(a,"[autoplay]",k.config.autoplay?"1":"0"));-1!=
a.toLowerCase().indexOf("[preroll_start]")&&(a=b(a,"[preroll_start]",k.config.autoplay?"autoplay":"clicktoplay"));-1!=a.toLowerCase().indexOf("[plcmt]")&&(a=b(a,"[plcmt]",k.config.autoplay?"2":"1"));-1!=a.toLowerCase().indexOf("[description]")&&(a=b(a,"[description]",encodeURIComponent(k.currentSource.description)));-1!=a.toLowerCase().indexOf("[mediafile_url]")&&(a=b(a,"[mediafile_url]",encodeURIComponent(k.currentSource.src)));-1!=a.toLowerCase().indexOf("[dnt]")&&(a=b(a,"[dnt]",navigator.doNotTrack&&
"1"===navigator.doNotTrack?"1":"0"));-1!=a.toLowerCase().indexOf("[viewability]")&&(a=b(a,"[viewability]",k.isPlayerInView()?"1":"0"));-1!=a.toLowerCase().indexOf("[vpmute]")&&(a=b(a,"[vpmute]",k.muted()?"1":"0"));-1!=a.toLowerCase().indexOf("[ppid]")&&(a=b(a,"[ppid]",h.getPPID()||""));-1!=a.toLowerCase().indexOf("[uid]")&&(a=b(a,"[uid]",h.getSession()));-1!=a.toLowerCase().indexOf("[video_tags]")&&(a=b(a,"[video_tags]",encodeURIComponent(k.currentSource.tags||"")));-1!=a.toLowerCase().indexOf("[video_iab_categories]")&&
(a=b(a,"[video_iab_categories]",encodeURIComponent(k.currentSource.iab_categories||"")));-1!=a.toLowerCase().indexOf("[step_contextual]")&&(a=b(a,"[step_contextual]",encodeURIComponent(h.getStepValues("contextual").join(","))));-1!=a.toLowerCase().indexOf("[step_1p_segment]")&&(a=b(a,"[step_1p_segment]",encodeURIComponent(h.getStepValues("segment").join(","))));-1!=a.toLowerCase().indexOf("[step_limited_ads]")&&(a=b(a,"[step_limited_ads]",encodeURIComponent(h.getStepValues("limitedads").join(","))));
-1!=a.toLowerCase().indexOf("[brid_site]")&&(a=b(a,"[brid_site]",encodeURIComponent(k.config.Partner?k.config.Partner.domain_short:"")));-1!=a.toLowerCase().indexOf("[video_origin]")&&k.currentSource&&k.currentSource.origin_video&&(a=b(a,"[video_origin]",encodeURIComponent(k.currentSource.origin_video)));-1!=a.toLowerCase().indexOf("[brid_ppid]")&&"undefined"!==typeof brid_ppid&&(a=b(a,"[brid_ppid]",encodeURIComponent(brid_ppid)));if(-1!=a.toLowerCase().indexOf("[brid_")){C=a;for(H=/\[brid_([a-zA-Z0-9_-]+)\]/g;y=
H.exec(a);)E=w.bridMacros||G.bridMacros||{},C=b(C,y[0],encodeURIComponent("object"==typeof E&&y[1]in E?E[y[1]]:""));a=C}-1!=a.toLowerCase().indexOf("[user_agent]")&&(a=b(a,"[user_agent]",encodeURIComponent(h.ua)));if(k.currentSource.customParams&&A&&!this.flagOurAd)for(B in k.currentSource.customParams)k.currentSource.customParams.hasOwnProperty(B)&&(a=b(a,"[item-"+B+"]",encodeURIComponent(k.currentSource.customParams[B])));try{var F=w.localStorage?w.localStorage.getItem("_pdfps"):!1;if(F&&(A||I)){var L=
"permutive="+JSON.parse(F).join();a=c(a,A?"cust_params":"brid_permutive",L)}}catch(M){Brid.error("--- BridPlayer --- LocalStorage Error",M)}Promise.all([d(a),m()]).then(}else{Brid.error("--- BridPlayer --- Unsupported adTag or Ad Manager initialization failed");Brid.exLog("Unsupported adTag or Ad Manager initialization failed");F=t.adTags.pod;A=t.adTags.priority-1;L=this.flagOurAd&&0<this.ourAdPos?A-this.ourAdPos:A;var B=z?z.name:"AdBlock";B={ec:9999,am:B,pub:this.flagOurAd?"b":"p",
pp:F,wp:L,at:"BannerAd"===B?"4":t.adType};0<=A&&(B.baid=t.adTags[F][A].id,B.sc=t.adTags[F][A].sc);k.trigger("adErrorAnalytics",B);this.preRequestAd(t)?Brid.log("Advertising prerequest success"):(Brid.log("Advertising prerequest fail"),this.hide(),this.adErrored=!0,this.resetManager(),k.trigger("adError",{message:"Unsupported adTag or Ad Manager initialization failed"}),this.onContentResumeRequested())}}else Brid.log("PIP : A banner or an overlay is stopped from loading. Picture-in-picture mode was active."),
this.onContentResumeRequested()},handleOptimizeAdTag:handleNextPod:
stopNonLinear:onAdError:onAdStart:onAdImpression:function(){var a=this.currentAdObject,c=this.player,b=this.currentAdsManager,d=a.adTags.pod,f=a.adTags.priority-1,e={spotx:"SpotX",rubicon:"Rubicon",ix:"ix",pubmatic:"Pubmatic",openx:"OpenX",onevideo:"Adapt",telaria:"Telaria",appnexus:"Appnexus",triplelift:"Triplelift",amazon:"Amazon",
unruly:"Unruly",rise:"Rise",videobyte:"VideoByte",onetag:"OneTag",yahoossp:"Yahoo",kargo:"Kargo",gumgum:"GumGum",sharethrough:"ShareThrough","33across":"33Across"};c.fireTicks&&0==d&&0==a.adType&&(c.timer.tick("adimpression"),c.trigger("tick",{tickType:"ai",tickTime:c.timer.ticks.adimpression,wp:f}),c.fireTicks=!1);c.waitingForAd=!1;c.waitForInViewAdAutoplay=!1;this.adPlayed=!0;this.techGet("isLinear")&&(c.adInProgress=!0);Brid.log("Advertising onAdImpression flagOurAd",this.flagOurAd);var m={s:this.somse};
if("GoogleIMA"==b.name&&b.currentAd&&(c.config.Prebid&&c.config.Prebid.creatives||c.config.Partner&&c.config.Partner.gam_creatives)){var n=a.adTags[d][f].data||{};var q=b.currentAd.getCreativeId(),r=b.currentAd.getWrapperCreativeIds()||[],l=b.currentAd.getWrapperAdSystems(),p=l.some(;r.push(q);var u=c.config.Prebid&&c.config.Prebid.creatives?c.config.Prebid.creatives:c.config.Partner.gam_creatives,q=r.find(,l=l.find(;n.bidder=q?u[q].toLowerCase():n.bidder&&l&&"prebid.org wrapper"==l?e[n.bidder]?e[n.bidder].toLowerCase():n.bidder.toLowerCase():p?"adsense/adx":"other";n.source=a.adTags[d][f].source;m=h.merge(m,n)}"GoogleIMA"==b.name&&b.currentAd&&a.adTags[d][f].source&&"prebid"==a.adTags[d][f].source&&(n=a.adTags[d][f].data||{},-1==a.adTags[d][f].url.indexOf("pubads")&&(n.source="prebid",n.bidder=n.bidder.toLowerCase(),m=h.merge(m,n)));c.sessionImps++;c.config.loop_ads&&c.sessionImps==parseInt(c.config.max_impressions)&&
(c.config.monetize=!1);c.trigger("adImpression",m);m.bidder&&m.source&&("prebid"==m.source||"combined"==m.source)&&c.trigger("bidderImpression",m);c.config.autohide_ad_controls||c.trigger("show");this.flagOurAd?c.trigger("ourAdImpression",{am:b.name,at:"BannerAd"===b.name?"4":a.adType,pp:d,wp:f-this.ourAdPos,baid:a.adTags[d][f].id}):c.showOnAd()?c.trigger("adUnitImpression",{am:b.name,at:"BannerAd"===b.name?"4":a.adType,pp:d,wp:f,baid:a.adTags[d][f].id,sc:a.adTags[d][f].sc,bidder:a.adTags[d][f].bidder,
cpm:a.adTags[d][f].cpm}):c.showOnAd()||c.trigger("partnerAdImpression",{am:b.name,at:"BannerAd"===b.name?"4":a.adType,pp:d,wp:f,baid:a.adTags[d][f].id,sc:a.adTags[d][f].sc,bidder:a.adTags[d][f].bidder,cpm:a.adTags[d][f].cpm})},onAdComplete:function(){var a=this.currentAdObject,c=this.player,b=this.currentAdsManager,d=a.adTags.pod,f=a.adTags.priority-1;Brid.log("Advertising onAdComplete",a,f,d);this.adSkipped||c.trigger("adComplete",{wp:f-this.ourAdPos-1,pod:d,pods:a.adTags.length});this.flagOurAd?
c.trigger("ourAdComplete",{am:b.name,at:"BannerAd"===b.name?"4":a.adType,pp:d,wp:f-this.ourAdPos,baid:a.adTags[d][f].id}):c.showOnAd()?c.trigger("adUnitComplete",{am:b.name,at:"BannerAd"===b.name?"4":a.adType,pp:d,wp:f,baid:a.adTags[d][f].id,sc:a.adTags[d][f].sc,bidder:a.adTags[d][f].bidder}):c.showOnAd()||c.trigger("partnerAdComplete",{am:b.name,at:"BannerAd"===b.name?"4":a.adType,pp:d,wp:f,baid:a.adTags[d][f].id,sc:a.adTags[d][f].sc,bidder:a.adTags[d][f].bidder});this.removeAdsCounter()},onAdSkipped:addAdsCounter:removeAdsCounter:onContentPauseRequested:onContentResumeRequested:function(){function a(){return e.config.autoplay&&e.config.pause_after_preroll&&!e.values.pausedAfterPreroll?(Brid.log("Advertising pausing player after preroll autoplayStickyAdOnly",e.config.autoplayStickyAdOnly),e.SlideInView&&e.SlideInView._toDefault(),e.values.pausedAfterPreroll=!0,e.config.autoplayInview=!1,e.addOnce("start",,-1===
e.currentSrc().indexOf(e.currentSource.src)&&Brid.isIPhone&&(e.src(e.currentSource),e.trigger("timeupdate")),e.trigger("pause"),e.trigger("showPoster"),e.pause(),!0):!1}function c(){if(null!==e.children){Brid.log("Advertising resumeContent");if(e.config.loop_ads&&this.ads.midroll&&this.ads.midroll.cuepoints&&0==this.ads.midroll.cuepoints.length&&!e.lood_ads_running_pods){var c=parseInt(e.currentTime()+parseInt(e.config.loop_frequency));e.tag.duration>c&&this.ads.midroll.cuepoints.push(c)}e.config.autoplayStickyAdOnly&&
(Brid.log("Advertising autoplayStickyAdOnly positionType",e.positionType,"isPlayerInView",e.isPlayerInView(),"adPlayed",this.adPlayed),e.config.autoplay_on_ad=!1,e.SlideInView&&e.SlideInView.close&&e.SlideInView.close.trigger("close"),e.closed=!0);a()||(!h&&(!e.currentSource.error&&-1===e.currentSrc().indexOf(e.currentSource.src)&&Brid.isIPhone||!e.currentSource.error&&-1===e.currentSrc().indexOf(e.currentSource.src)&&0==e.tag.currentTime||""==e.tag.src)?(Brid.log("Advertising onContentResumeRequested 1"),
e.stopTrackingCurrentTime(),e.trigger("stopTrackingTime"),Brid.isIPhone?e.addOnce("loadedmetadata",b):e.addOnce("loadedmetadata",d),e.src(e.currentSource),e.load(),Brid.isIPhone||e.play()):h?(Brid.log("Advertising onContentResumeRequested 3"),Brid.isIPhone&&-1===e.currentSrc().indexOf(e.currentSource.src)&&(this.adSkipped&&e.src(e.currentSource),0==e.tag.currentTime&&(e.remove("ended",this.$f(this.onEnded)),e.src(e.currentSource),e.newContent=!0,e.trigger("newContent")),e.trigger("showPoster")),e.remove("loadedmetadata",
d),f.tempTime=null):(Brid.log("Advertising onContentResumeRequested 2"),f.tempTime?Brid.isIPhone&&0==e.tag.currentTime?(e.load(),e.addOnce("loadedmetadata",b)):setTimeout(300):e.play()))}}r f=this,e=f.player,h=f.contentCompleteCalled,n=0,q=this.currentAdObject.adTags.pod;"Brid.OSPlayer"==e.name&&e.config.loop_unit&&e.config.delay_ad_call&&0<parseInt(e.config.delay_ad_call)&&
(n=parseInt(e.config.delay_ad_call));if(null!==e.children){Brid.log("Advertising onContentResumeRequested contentCompleteCalled",h,"currentSrc",e.currentSrc(),"currentSource",e.currentSource.src,"_this.tempTime",f.tempTime,"player current Time",e.tag.currentTime,"autoplay_on_ad",e.config.autoplay_on_ad,"adErrored",this.adErrored,"adPlayed",this.adPlayed,"player.userInteracted",e.userInteracted,"doStartAdCalled",this.doStartAdCalled,"adsManager name",this.currentAdsManager?this.currentAdsManager.name:
"NULL");e.config.loop_ads&&(Brid.log("IZROKAN POD: "+q+" UKUPNO PODS-a: "+this.currentAdObject.adTags.length),Brid.log("LOOP NUM: "+this.currentAdObject.adTags[q][0].loop_num),q+1<this.currentAdObject.adTags.length&&this.currentAdObject.adTags[q][0].loop_num!=this.currentAdObject.adTags[q+1][0].loop_num||q+1==this.currentAdObject.adTags.length)&&(e.sessionLoopCount++,e.slotImps==e.sessionImps?e.sessionError++:e.sessionError=0,e.config.loop_ads&&0<parseInt(e.config.error_limit)&&e.sessionError==parseInt(e.config.error_limit)&&
(e.config.monetize=!1),e.slotImps=e.sessionImps);if(this.currentAdObject&&(this.currentAdObject.adTags.pod+1<this.currentAdObject.adTags.length||"Brid.OSPlayer"==e.name&&e.config.loop_unit||e.config.loop_pods&&e.currentPodIteration<parseInt(e.config.loop_pods_num)-1&&e.slotIterationImps<parseInt(e.config.imps_per_slot))&&(!e.closed||e.currentSrc())&&(this.currentAdsManager&&"GoogleIMA"==this.currentAdsManager.name&&this.currentAdsManager.adsManager&&0==this.currentAdsManager.adsManager.getCuePoints().length&&
this.currentAdsManager.adsLoader&&(Brid.log("CALL adsLoader.contentComplete 1"),this.currentAdsManager.adsLoader.contentComplete()),e.config.monetize)){if("Brid.OSPlayer"==e.name&&e.config.loop_unit||e.config.loop_pods)if("Brid.OSPlayer"==e.name&&e.config.loop_unit){e.slotImps==e.sessionImps&&e.sessionError++;if(0<parseInt(e.config.error_limit)&&e.sessionError==parseInt(e.config.error_limit)){e.fadeOutParent();return}this.adsLog("Advertising adsPool reset for ad unit");this.adsPool=[];this.checkScheduledAds();
this.currentAdObject="0"==this.currentAdObject.adType?this.ads.preroll:"1"==this.currentAdObject.adType?this.ads.midroll:this.ads.postroll}else e.config.loop_pods&&(e.currentPodIteration++,Brid.log("TESTIRAJ",this.currentAdObject.adType,e.config.pod_frequency,e.tag.currentTime),"1"==this.currentAdObject.adType&&e.tag.currentTime%parseInt(e.config.pod_frequency)>parseInt(e.config.pod_frequency)-1&&(e.currentPodIteration=parseInt(e.config.loop_pods_num)),this.adsPool=[],this.checkScheduledAds(),this.currentAdObject=
"0"==this.currentAdObject.adType?this.ads.preroll:"1"==this.currentAdObject.adType?this.ads.midroll:this.ads.postroll);else this.currentAdObject.adTags.pod++;Brid.log("Advertising going to next pod",this.currentAdObject,this.currentAdObject.adTags.pod,e.currentPodIteration);this.reset();this.currentAdObject.adTags.priority=0;e.config.optimize_price&&"Brid.Player"==e.name&&(!e.config.loop_pods||this.adErrored)||e.config.optimize_price&&"Brid.OSPlayer"==e.name&&!e.config.loop_unit||e.config.optimize_price&&
"Brid.OSPlayer"==e.name&&e.config.loop_unit&&this.adErrored?(e.handlingNextPod=!0,setTimeout(function(){this.handleNextPod()}.bind(this),n)):("Brid.OSPlayer"==e.name&&e.config.loop_unit&&!this.adErrored&&(this.handleOptimizeAdTag("0",this.currentAdObject.adTags.pod),this.currentAdObject="0"==this.currentAdObject.adType?this.ads.preroll:"1"==this.currentAdObject.adType?this.ads.midroll:this.ads.postroll),!e.config.loop_pods||this.adErrored||e.config.upr||(this.handleOptimizeAdTag(this.currentAdObject.adType,
this.currentAdObject.adTags.pod),this.currentAdObject="0"==this.currentAdObject.adType?this.ads.preroll:"1"==this.currentAdObject.adType?this.ads.midroll:this.ads.postroll),setTimeout(bind(this),n),e.config.loop_ads&&(e.lood_ads_running_pods=!0,c.apply(this)));return}e.config.loop_pods&&(e.currentPodIteration=0,e.slotIterationImps=0,this.currentAdObject&&"1"==this.currentAdObject.adType&&(this.currentAdObject.cuepoints=this.currentAdObject.cuepoints.filter(function(a){return a>e.tag.currentTime}),this.ads.midroll.cuepoints=this.ads.midroll.cuepoints.filter());
if(!this.adPlayed&&!this.adErrored&&this.currentAdsManager&&"GoogleIMA"==this.currentAdsManager.name&&this.currentAdsManager.adsManager&&!this.currentAdsManager.adsManager.getCuePoints().find(&&this.currentAdObject&&2>this.currentAdObject.adTags.length)this.onAdError("GoogleIMA All ads completed without an impression");else this.currentAdsManager&&"GoogleIMA"==this.currentAdsManager.name&&this.currentAdsManager.adsManager&&0==this.currentAdsManager.adsManager.getCuePoints().length&&
this.currentAdsManager.adsLoader&&(Brid.log("CALL adsLoader.contentComplete 1a"),this.currentAdsManager.adsLoader.contentComplete(),!Brid.isIPhone&&this.currentAdsManager.currentAd&&this.currentAdsManager.currentAd.isLinear()&&"2"!==this.currentAdObject.adType&&setTimeout(bind(this),100)),f.reset(),e.trigger("adsCompleted"),e.muted(e.values.muted),e.volume(e.values.volume),e.remove("ended",f.$f(f.onEnded)),e.add("ended",f.$f(f.onEnded)),e.currentSrc()&&(!e.config.autoplay_on_ad||f.adPlayed||e.userInteracted||e.config.autoplayStickyAdOnly?(e.config.loop_ads&&(e.lood_ads_running_pods=!1),setTimeout(this.$f(c),0)):(Brid.log("ULECEMO OVDE BESNO!!!"),e.onScrollFunc&&(Brid.log("REMOVE SCROLL ALSO"),e.removeScroll()),this.adErrored=
!0,e.config.call_ads_on_click&&(e.newContent=!0,e.loadedmetadataDispatched=!1,e.add("beforeStart",this.$f(this.onBeforeStart)),this.ads.preroll&&this.ads.preroll.played&&this.player.config.monetize&&(this.ads.preroll.played=!1,this.ads.preroll.adTags.pod=0,this.ads.preroll.adTags.priority=0),e.try_preroll_again=!0,e.config.call_ads_on_click=!1,e.config.autoplay=!1)))}},reset:resetManager:start:stop:play:function(a){a=
this.player;a.tech.support.adManagement?a.techCall("play"):this.currentAdsManager&&this.techCall("togglePlay",!0)},pause:togglePlay:duration:function(){return this.player.tech.support.adManagement?this.player.techGet("duration"):this.currentAdsManager?this.techGet("duration"):0},currentTime:volume:hide:function(){for(var a=0,c=this.adManagers.length;a<c;a++)this.techCall("hide",null,this.adManagers[a])},show:onResize:isLinear:createTCFInsideIframe:);Brid.GoogleIMA=Brid.Abstract.extend({adsManager:null,adsLoader:null,adDisplayContainer:null,ad:null,hasAdRules:!1,isVPAID:!1,vpaidMode:"",adTimeout:15,init:isMoatConfigured:initializeMoatTrackingFunction:onDependencyLoad:hide:function(){this.el&&h.css(this.el,{display:"none"})},show:function(){this.el&&h.css(this.el,{display:"block"})},onUserInteraction:setVPAIDMode:setupAdsLoader:contentComplete:requestAd:function(c){var b=this.player;var d=!b.config.ima_secure_mode;if(-1!==c.indexOf("ima3vpaid.appspot.com")){var f=h.queryStringToObj(c.split("?")[1]);Brid.log("GoogleIMA stripIMAWrapper",f);c=f.adTagUrl?decodeURIComponent(f.adTagUrl):
c}this.adTag=c;this.logError=this._hasResponse=!1;if("undefined"===typeof google||"undefined"===typeof google.ima)this.error=!0,this.parent.onAdError("Google IMA not initialized. Make sure Ad blocker is disabled",!0),this.hide();else{this.adsLoader||this.setupAdsLoader();this.show();if(-1!=c.toLowerCase().indexOf("brid_vpaidmode")||-1!=c.toLowerCase().indexOf("brid_adtimeout"))d=c.split("?")[1]?h.queryStringToObj(c.split("?")[1]):-1!=c.toLowerCase().indexOf("brid_vpaidmode=insecure")?{brid_vpaidmode:"insecure"}:
{},Brid.log("GoogleIMA requestAd params",d),this.adTimeout=d.brid_adtimeout||this.adTimeout,d=d.brid_vpaidmode&&"insecure"==d.brid_vpaidmode,c=c.replace("&brid_vpaidmode=insecure","");d?this.setVPAIDMode(google.ima.ImaSdkSettings.VpaidMode.INSECURE):this.setVPAIDMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);c=h.removeParam("brid_parser",c);d=new google.ima.AdsRequest;h.validateURL(c)?d.adTagUrl=c:-1!==c.indexOf("<VAST")&&-1!==c.indexOf("</VAST>")?d.adsResponse=c:(Brid.error("--- BridPlayer --- VAST Template or Ad Tag ndo not have a proper format"),
Brid.exLog("VAST Template or Ad Tag does not have a proper format"),this.parent.onAdError("VAST Template or Ad Tag do not have a proper format"));d.linearAdSlotWidth=b.el.offsetWidth;d.linearAdSlotHeight=b.el.offsetHeight;d.nonLinearAdSlotWidth=b.el.offsetWidth;d.nonLinearAdSlotHeight=b.el.offsetHeight;b.config.maxNonlinearHeight&&(f=b.config.maxNonlinearHeight,"string"==typeof f&&-1!=f.indexOf("%")&&(f=parseFloat(f)*b.el.offsetHeight/100),d.nonLinearAdSlotHeight=Math.min(b.el.offsetHeight,parseInt(f)),
Brid.log("GoogleIMA setting nonLinearAdSlotHeight",d.nonLinearAdSlotHeight,"player height",b.el.offsetHeight));d.vastLoadTimeout=1E3*this.adTimeout;var e=b.config.autoplay,f=b.muted();Brid.log("GoogleIMA autoplayAllowed",e,"autoplayRequiresMuted",f,"continuousPlayback",b.isNextQueued());d.setAdWillAutoPlay(e);d.setContinuousPlayback(b.isNextQueued());c=b.config.Partner&&["20786","20977","21393"].includes(b.config.Partner.id)&&/iu=\/21760922134[\/,]/.test(c);e=b.config.ima_vpmute||"auto";if(b.config.ima_force_vpmute||
c)e="not_muted";"dont_send"!=e&&d.setAdWillPlayMuted("auto"==e?f:!1);try{this.adsLoader.requestAds(d)}catch(m){Brid.error("--- BridPlayer --- Google IMA Error. Google IMA initialization failed",m),Brid.exLog("Google IMA Error. Google IMA initialization failed",m),this.parent.onAdError("Google IMA Error. Google IMA initialization failed")}}},onAdsManagerLoaded:onInteraction:function(){Brid.event.remove(x.body,
"click",this.$f(this.onInteraction));this.onUserInteraction();this.doStartAd()},doStartAd:function(){var c=this.player;Brid.log("GoogleIMA doStartAd 1");this.parent.doStartAdCalled=!0;this.adsManager.init(c.el.offsetWidth,c.el.offsetHeight,google.ima.ViewMode.NORMAL);this._hasResponse=!0;Brid.log("Bice da smo ovde",c.config.autoplayInview,!c.isPlayerInView(),c.config.viewability,c.name);Brid.log("isMidroll","1"===this.parent.currentAdObject.adType);if(c.name&&"Brid.Player"==c.name){if(c.config.autoplayInview&&
!c.config.autoplayStickyAdOnly&&!c.isPlayerInView()&&(c.config.pauseAdOffView||c.config.autoplay_on_ad)&&!this.started){c.waitForInViewAdAutoplay=!0;this.parent.paused=!0;return}}else if(c.config.autoplayInview&&!c.isPlayerInView()&&c.config.viewability){this.parent.paused=!0;return}this.started=!0;Brid.log("GoogleIMA doStartAd 2");this.volume(c.values.muted?0:c.values.volume||0);this.parent.paused=!1;this.adsManager.start()},onAdEvent:function(c){var b=this.player,d=google.ima.AdEvent.Type,f=this.currentAd=
c.getAd();Brid.log("GoogleIMA onAdEvent",c.type);Brid.exLog("GoogleIMA AdEvent",c.type);switch(c.type){case d.LOADED:Brid.log("GOOGLE IMA AD LOADED","Ad System",f.getAdSystem(),"Advertiser name",f.getAdvertiserName());Brid.log("Creative Ad ID",f.getCreativeAdId(),"Creative ID",f.getCreativeId());Brid.log("Creative Trafficking params",f.getTraffickingParameters());Brid.log("Wrapper Ad IDs",f.getWrapperAdIds(),"Wrapper ad systems",f.getWrapperAdSystems());Brid.log("Wrapper Creative Ad ID",f.getWrapperCreativeIds());
1<this.currentAd.getAdPodInfo().getTotalAds()&&(this.parent.isPodTag=!0);this.show();Brid.log("Current ad is linear",f.isLinear(),f.isLinear);if(f.isLinear())Brid.log("GoogleIMA LOADED setVolume muted",b.values.muted,"volume",b.values.volume),this.checkIsVPAID(f),this.volume(b.values.muted?0:b.values.volume||0);else if(b.currentSrc())b.isPlaying?"1"===this.parent.currentAdObject.adType&&b.paused()&&(this.onContentResumeRequested(),Brid.log("Call onContentResumeRequested 2")):(this.parent.adPlayed=
!0,this.onContentResumeRequested(),Brid.log("Call onContentResumeRequested 1"));else{this.onAdError("Google IMA Error. Outstream units do not support non-linear ads");break}Brid.isMobilePlatform&&Array.prototype.map.call(b.el.getElementsByTagName("video"),;this.onResize(null);break;case d.STARTED:Brid.isIPhone&&
b.isFullScreen&&b.toggleFullScreen(!b.isFullScreen);this.parent.onAdStart(this.isVPAID);f.isLinear()&&b.trigger("adDuration",{duration:f.getDuration()});Brid.event.remove(x.body,"click",this.$f(this.onInteraction));Brid.log("GoogleIMA STARTED setVolume muted",b.values.muted,"volume",b.values.volume);this.volume(b.values.muted?0:b.values.volume||0);break;case d.IMPRESSION:this.parent.nonceManager&&(Brid.log("GoogleIMA PAL sendAdImpression"),this.parent.nonceManager.sendAdImpression());b.showOnAd()&&
b.config.autoplayInview&&!b.isPlayerInView()&&(Brid.log("CALLING OUTSTREAM PAUSE"),this.adsManager.pause());Brid.isMobilePlatform&&b.showOnAd()&&setTimeout(this.$f(,1E3);this.parent.onAdImpression();Brid.log("GoogleIMA IMPRESSION setVolume muted",b.values.muted,"volume",b.values.volume);this.volume(b.values.muted?0:b.values.volume||0);break;case d.DURATION_CHANGE:this.onResize(null);
b.trigger("durationChange");break;case d.PAUSED:b.config.blockAdPause&&!b.pausedOnInteraction?this.adsManager.resume():(Brid.log("SAD SMO OVDE"),this.parent.paused=!0,b.trigger("pause"),b.trigger("adPause"));Brid.isMobilePlatform||"autoplayEnabled"==h.autoplayMode||(h.autoplayPromise=h.testAutoplaySupport(),h.autoplayPromise.then();break;case d.CLICK:this.parent.nonceManager&&(Brid.log("GoogleIMA PAL sendAdClick"),this.parent.nonceManager.sendAdClick());
b.trigger("adClicked");break;case d.RESUMED:this.parent.paused=!1;b.trigger("play");b.trigger("adResume");break;case d.FIRST_QUARTILE:b.trigger("adFirstQuartile");break;case d.MIDPOINT:b.trigger("adMidpoint");break;case d.THIRD_QUARTILE:b.trigger("adThirdQuartile");break;case d.COMPLETE:this.parent.onAdComplete();break;case d.LOG:c=c.getAdData();c.adError&&(this.logError=!0,Brid.log("GoogleIMA non-fatal error occurred: "+c.adError.getMessage()),this.onAdError(c.adError.getMessage()));break;case d.SKIPPED:this.parent.onAdSkipped();
break;case d.ALL_ADS_COMPLETED:case d.USER_CLOSE:var e=this.player.adsManager.currentAdObject,e=e?e.adTags.pod:0;Brid.log("GoogleIMA",c.type,"getRemainingTime",this.adsManager.getRemainingTime(),"player.waitingForAd",this.player.waitingForAd);Brid.log("GoogleIMA",c.type,"ad pod",e);if(this.player.waitingForAd&&0<e)Brid.log("Ignore ALL_ADS_COMPLETED");else{if(c.type===d.USER_CLOSE)if(.1>=this.adsManager.getRemainingTime())this.parent.onAdComplete();else this.parent.onAdSkipped();if(!this._contentResumeCalled||
this.adsManager&&0<this.adsManager.getCuePoints().length&&-1!=this.adsManager.getCuePoints().indexOf(-1))this.onContentResumeRequested();!1===f.isLinear()&&this.parent.reset();this.resetManager()}}},onContentPauseRequested:function(){Brid.log("GoogleIMA onContentPauseRequested");this._contentResumeCalled=!1;this.parent.onContentPauseRequested()},onContentResumeRequested:onAdError:onLastSecond:checkIsVPAID:stop:resetManager:destroyAdsLoader:isLinear:function(){return this.currentAd?this.currentAd.isLinear():null},start:function(){Brid.log("GoogleIMA start",this._hasResponse);var c=this.player;this.adsManager&&this._hasResponse?(this.volume(c.values.muted?0:c.values.volume||0),this.parent.paused=!1,this.started=!0,this.adsManager.start()):c.waitingForAd=!0},togglePlay:
duration:function(){return this.currentAd?this.currentAd.getDuration():0},currentTime:volume:onResize:supportsAdTag:);Brid.VAST=Brid.Abstract.extend({closeTimeout:null,hasAdRules:!1,
isVPAID:!1,jsLoaded:!1,cssLoaded:!1,_hasResponse:!1,adTimeout:15,pbTechInitialized:!1,init:onJSLoaded:setupAdsLoader:function(){Brid.log("Brid.VAST setupAdsLoader");if(!this.adsManager){try{var b=this.adsManager=new Brid.AdSDK.AdsManager(this.player,{},this.el)}catch(d){Brid.error("Brid VAST ERROR. Brid VAST SDK could not be initialized",d);this.error=!0;this.parent.onAdError("Brid VAST ERROR. Brid VAST SDK could not be initialized",
!0);return}this.player&&this.player.tech&&this.player.tech.support.adManagement?this.hide():(b.add("vast.adClickThru",this.$f(this.onClickThru)),b.add("vast.adEnd",this.$f(this.onAdEnd)),b.add("vast.adStart",this.$f(this.onAdStart)),b.add("vast.contentPauseRequested",this.$f(this.onContentPauseRequested)),b.add("vast.contentResumeRequested",this.$f(this.onContentResumeRequested)),b.add("vast.adImpression",this.$f(this.onAdImpression)),b.add("vast.adVideoStart",this.$f(this.onAdVideoStart)),b.add("vast.adSkip",
this.$f(this.onAdSkiped)),b.add("vast.adError",this.$f(this.onAdError)),b.add("vast.adDurationChange",this.$f(this.onAdDurationChange)),b.add("vast.adPause",this.$f(this.onAdPause)),b.add("vast.adResume",this.$f(this.onAdResume)),b.add("vast.adVideoComplete",this.$f(this.onAdComplete)),b.add("vast.selected3rdParty",this.$f(this.on3rdPartySelected)),b.add(["vast.firstQuartile","vast.midpoint","vast.thirdQuartile"],this.$f(),this.player.add("userInteraction",this.$f(this.onUserInteraction)),this.player.add("lastSecond",this.$f(this.onLastSecond)))}},contentComplete:function(){},requestAd:function(b){var d=x.BridIframeBurst?w.top:w;0<b.indexOf("//googleads")&&10>b.indexOf("//googleads")&&(b="https://ima3vpaid.appspot.com/?adTagUrl="+b+"&type=js");if(-1!=b.toLowerCase().indexOf("brid_adtimeout")){var f=
h.queryStringToObj(b);Brid.log("VAST requestAd params",f);this.adTimeout=f.brid_adtimeout||this.adTimeout;b=h.removeParam("brid_adtimeout",b)}b=h.removeParam("brid_parser",b);0<b.indexOf("pubads")&&10>b.indexOf("pubads")&&(b=h.removeParam("impl",b),b=h.removeParam("output",b),b=b+"&output=xml_vast4"+(this.player.config.autoplay?"&vpa=auto":"&vpa=click"),b+=this.player.muted()?"&vpmute=1":"&vpmute=0",b+=h.addAfszv(this.player.el.offsetWidth,this.player.el.offsetHeight),d.googleToken&&d.googleToken[4]&&
""!=d.googleToken[4]&&(b=b+"&jar="+d.googleToken[4]),b+=h.isAmp()?"&is_amp=1":"&is_amp=0",b=b+"&scor="+Math.floor(4503599627370496*Math.random()));Brid.exLog("Brid.VAST requestAd",b);this.adsManager||this.setupAdsLoader();this.show();this.adUnit=null;this._hasResponse=!1;this.adsManager.config.adCancelTimeout=1E3*this.adTimeout;this.adsManager.requestAd(b,this.$f(this.onAdResponse))},onAdResponse:function(){var b=this.player,d=this.parent.currentAdObject,f=d.adTags.pod,e=d.adTags.priority-1;b.fireTicks&&
0==d.adType&&0==f&&(b.timer.tick("adresponse"),b.trigger("tick",{tickType:"ar",tickTime:b.timer.ticks.adresponse,wp:e}));Brid.exLog("Brid.VAST onAdResponse");this._hasResponse=!0;this.show();h.autoplayVideoSupported||b.userInteracted?(this.pbTechInitialized=!0,this.doStartAd()):Brid.event.add(x.body,"click",this.$f(this.onInteraction,this.id),!0)},onUserInteraction:onInteraction:doStartAd:onAdStart:onAdImpression:onAdVideoStart:function(){this.onResize()},onAdComplete:onAdSkiped:onAdEnd:onContentPauseRequested:onContentResumeRequested:onAdPause:onClickThru:onAdResume:onAdDurationChange:function(){this.player.trigger("durationchange")},on3rdPartySelected:onAdError:stop:onLastSecond:resetManager:destroyAdsLoader:isLinear:start:togglePlay:duration:currentTime:volume:hide:function(){this.el&&h.css(this.el,{display:"none"})},show:function(){this.el&&h.css(this.el,{display:"block"})},onResize:supportsAdTag:);Brid.BannerAd=Brid.Abstract.extend({default:{adRequestTimeout:15E3,adDuration:15},init:
iframeBannerResizeCallback:requestAd:executeJS:onAdLoaded:start:stop:initTimeouts:
onAdEnd:onAdLoadError:isLinear:
resetManager:setupAdsLoader:function(){},contentComplete:onAnyAdResized:
onResize:hide:function(){this.el&&h.css(this.el,{display:"none"})},show:supportsAdTag:togglePlay:duration:currentTime:volume:);w.$bp.plugin("bridgima",
;I.trigger(x,"bridpluginloaded")})(window,document);
