(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[627],{"1w9C":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("mXGw"),r=a("QjXU"),i=function(e,t,a){var i=function(e){var t=Object(r.__read)(Object(n.useState)(null),2),a=t[0],i=t[1],l=Object(n.useCallback)(e,[]);return Object(n.useEffect)((,[l]),a}(e(t));return Object(n.useMemo)((function(){return i&&a?i.getDataManager(a):void 0}),[a,i])}},"44+c":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("Ea7i"),r=a("6ib3"),i=a("Ohvh"),l=a("JSSH");function o(e){var t,a=e.template,o=e.candidate,c=e.instrumentClick,u=e.getOrUpdatePendingCreates,s=e.errorCallback,d=e.shouldShowStorageErrorDialog,m=e.showStorageErrorDialog;a&&!a.TemplateBinaryUrl&&a.Binaries&&a.Binaries.length>0&&(a.TemplateBinaryUrl=(null===(t=a.Binaries.find((function(e){var t,a;return"wac"===(null===(t=e.Platform)||void 0===t?void 0:t.toLowerCase())||"online"===(null===(a=e.Platform)||void 0===a?void 0:a.toLowerCase())})))||void 0===t?void 0:t.Url)||"");var p=Object(i.a)(a.Application)||r.a.None;return{tileConfig:Object(l.a)(a),id:a.AssetId,assetId:a.AssetId,templateType:a.IsPremium?"Premium":"Standard",app:p,handleClick:function(){d&&d(a.Application||"")?m&&m({workloadId:a.AssetId,area:"CreateOnTemplates",subArea:"Templates",isTemplate:!0}):Object(n.a)({app:p,candidate:o,getOrUpdatePendingCreates:u,template:a,instrumentClick:c,errorCallback:s})}}}},"6fXp":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a("B5kz"),r=a("5PdT"),i=a("CaQ9");function l(){var e=Object(i.a)().data,t=["EncryptionKey",null==e?void 0:e.puid];return Object(n.c)(t,(,{cacheTime:1/0,staleTime:1/0,enabled:!!e})}},JSSH:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("tBub"),r=a("qecA");function i(e,t){var a,n;if(e){var r=e.find((function(e){return"MT"===e.ImageType}));return r?r.Url:void 0}if(t){var i=null===(a=t.find((function(e){return"large"===e.ImageSize.toLowerCase()})))||void 0===a?void 0:a.Url,l=null===(n=t.find(())||void 0===n?void 0:n.Url;return i||l}}function l(e){if(e){var t=e.find((function(e){return"LT"===e.ImageType})),a=e.find(();return t||a}}function o(e,t){return{title:e.Title,ariaLabel:e.Title,thumbnail:i(e.Thumbnails,e.Images),appName:Object(r.a)(e),extension:e.TemplateBinaryUrl?Object(n.a)(t?e.TemplateBinaryUrl.slice(0,e.TemplateBinaryUrl.indexOf("&",e.TemplateBinaryUrl.lastIndexOf("."))):e.TemplateBinaryUrl):"",galleryThumbnail:t?void 0:l(e.Thumbnails)}}},Ke3b:Qcgp:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a("NrNW"),r=a("1w9C"),i=a("6fXp"),l=a("CaQ9"),o=a("h8qh"),c=a("Ke3b"),u=a("Coo+"),s=a("mXGw");function d(e){switch(e){case"default":return function(){return a.e(166).then(a.bind(null,"vS1s"))};case"default-enterprise":return function(){return a.e(640).then(a.bind(null,"EVfI"))};case"custom":return default:return }var m=function(e,t){var a,m,p,v=Object(i.a)().data,f=Object(l.a)().data,b=Object(n.a)().data,T=null===(m=null===(a=Object(u.a)())||void 0===a?void 0:a.data)||void 0===m?void 0:m.result,O=Object(c.a)().data,g=null===(p=Object(o.a)())||void 0===p?void 0:p.data,j=Object(s.useMemo)((function(){if(v&&f&&g&&b&&T&&O&&t)return{encryptionKeyResult:v,identity:f,locStrings:g,officeComponentContext:b,providerType:t,templatesConfig:O,userEntitlements:T,app:e}}),[v,f,g,b,T,O,t,e]);return Object(r.a)(d,t,j)}},XNH3:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a("QjXU"),r=a("1aUa"),i=a("ijiB"),l=a("6ib3"),o=a("Ohvh"),c=a("ZcZ3"),u=a("a3FV"),s=a("l+H3"),d=a("lUkk"),m=a("Dn7E"),p=a("rTyw"),v=a("mXGw"),f=a("qecA"),b=a("44+c");function T(e,t,a){var T=Object(n.__read)(Object(s.a)(),2),O=T[0],g=T[1],j=Object(v.useCallback)((function(t,a,n){if(n&&n.AssetId){var i=Object(o.a)(n.Application)||l.a.None,s=Object(c.a)(i);Object(d.a)({id:n.AssetId,area:e,subArea:"Templates",result:s&&Object(r.a)(t)?"Refer":"Navigate",target:s&&Object(r.a)(t)?Object(p.a)(s):"Other",eventName:u.a.TemplateClick}),Object(m.a)({featureName:"Create",eventName:u.a.TemplateClickResult,area:e,params:{ElementId:n.AssetId,Action:t,DocumentType:Object(f.a)(n),TemplateType:n.IsPremium?"Premium":"Standard"}})}}),[e]),w=Object(i.a)();return Object(v.useCallback)((function(e){if(t)return Object(b.a)({template:e,candidate:t,instrumentClick:j,getOrUpdatePendingCreates:w,errorCallback:a,shouldShowStorageErrorDialog:g,showStorageErrorDialog:O})}),[t,a,w,j,g,O])}},ZcZ3:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("6ib3"),r=a("Tqea");function i(e){switch(e){case n.a.Word:return"WordOnline";case n.a.Excel:return"ExcelOnline";case n.a.PowerPoint:return"PowerPointOnline";case n.a.OneNote:return"OneNoteOnline";case n.a.Sway:return"Sway";case n.a.Visio:return"VisioOnline";case n.a.Project:case n.a.ProjectOperations:case n.a.Portfolio:return"Project";case n.a.PowerBI:return"PowerBIv2";default:return Object(r.a)(e)}}},gEPa:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return N}));var n=a("QjXU"),r=a("JlDK"),i=a("NrNW"),l=a("SnJU"),o=a("bTtP"),c=a("bcUD"),u=a("faO/"),s=a("6ib3"),d=a("RV7E"),m=a("Ohvh"),p=a("CaQ9"),v=a("/Oio"),f=a("l+H3"),b=a("wVmX"),T=a("EXRb"),O=a("mXGw"),g=a.n(O),j=a("p/uK"),w=a("sLnE"),C=Object(j.a)({wordUpsellPreview:{height:"130%"},excelUpsellPreview:{width:"105%",height:"117%"},powerpointUpsellPreview:{width:"103%",height:"110%"},allTemplatesCard:Object(n.__assign)({backgroundColor:"transparent",boxShadow:"none"},w.a.padding("0px"))}),P=a("h8qh");function h(e,t,a){if(t&&a)return t["".concat(e).concat(a)]}function k(e,t){var a,n,r,i,l,o,c,u,s,d;if(e&&t)return{blankTemplateAriaLabel:null!==(a=h("blankTemplateAriaLabel",e,t))&&void 0!==a?a:"",blankTemplateText:null!==(n=h("blankTemplateText",e,t))&&void 0!==n?n:"",createSectionTitle:e.createSectionTitle,premiumTemplatesDiamond:e.premiumTemplatesDiamond,premiumTemplatesAriaLabel:null!==(r=h("premiumTemplatesAriaLabel",e,t))&&void 0!==r?r:"",premiumTemplatesText:null!==(i=h("premiumTemplatesText",e,t))&&void 0!==i?i:"",startPageMoreTemplatesLinkText:null!==(l=h("startPageMoreTemplatesLinkText",e,t))&&void 0!==l?l:"",startPageMoreTemplatesLinkAriaLabel:null!==(o=h("startPageMoreTemplatesLinkText",e,t))&&void 0!==o?o:"",startPageMoreTemplatesTileText:null!==(c=h("startPageMoreTemplatesTileText",e,t))&&void 0!==c?c:"",startPageMoreTemplatesTileAriaLabel:null!==(u=h("startPageMoreTemplatesTileText",e,t))&&void 0!==u?u:"",startPageTemplateAriaLabel:null!==(s=h("startPageTemplateAriaLabel",e,t))&&void 0!==s?s:"",templatesLoadingError:null!==(d=null==e?void 0:e.templatesLoadingError)&&void 0!==d?d:""}}var y=a("NZpx"),L=a("hu41"),E=a("CU8J"),I=a("qyk8"),S=a("laSs"),U=a("B5kz"),x=a("Qcgp"),A=a("m7fW"),M=a("XNH3"),D=a("Coo+"),B=function(e,t){return t?Object(T.a)(e,"officestartresources","premium_templates_upsell_".concat(t),"png"):Object(T.a)(e,"officestartresources","premium_templates_upsell","png")},N=function(e){var t,a,j=e.fileType,w=e.createConfig,h=Object(O.useMemo)((function(){var e;return null!==(e=Object(m.a)(j))&&void 0!==e?e:s.a.None}),[j]),N=function(e){var t=Object(P.a)().data;return Object(O.useMemo)((function(){var e=new Map,a=null==t?void 0:t.createSectionResources;return e.set(s.a.Excel,k(a,s.a.Excel)),e.set(s.a.Word,k(a,s.a.Word)),e.set(s.a.PowerPoint,k(a,s.a.PowerPoint)),e.set(s.a.Visio,k(a,s.a.Visio)),e}),[null==t?void 0:t.createSectionResources]).get(e)}(h),_=Object(O.useCallback)((function(e){switch(e.resultType){case"OpenNewDocFailed":Object(d.c)({category:"CreateFile",error:"OpenNewDocFailed",fileType:h,fallbackSiteUrl:e.documentWebUrl});break;case"OpenBlockedByPopupBlocker":Object(d.c)({category:"CreateFile",error:"OpenBlockedByPopupBlocker",fileType:h,fallbackSiteUrl:e.documentWebUrl});break;default:Object(d.c)({category:"CreateFile",error:"Generic",fileType:h})}}),[h]),Q=Object(l.a)("CreateOnStart",[h],_),W=Object(p.a)().data,X=Object(i.a)().data,V=Object(O.useMemo)((,[]),q=(0,Object(n.__read)(Object(f.a)(),2)[1])(j),F=Object(b.a)(),H=(null==W?void 0:W.isMsa)&&!F&&!(null==W?void 0:W.isPipl),R=C(),G=Object(c.a)({experiences:[u.a.PremiumTemplates]}),J=Object(O.useCallback)((function(){if(G){var e="https://products.office.com/compare-all-microsoft-office-products?tab=1&".concat((null==X?void 0:X.workload)==v.a.Hwa?"cmmq7dpcsv9":"cmmrto2blpr");G(u.a.PremiumTemplates,e)}}),[null==X?void 0:X.workload,G]),K=function(e,t,a,n){var r,l,o,c=null===(o=null===(l=null===(r=Object(D.a)())||void 0===r?void 0:r.data)||void 0===l?void 0:l.result)||void 0===o?void 0:o.IsGovernment,u=Object(i.a)().data,d=Object(y.a)().data,m=Object(E.a)().data,p=function(e,t){var a=Object(x.a)(e,t),n=["TemplatesData",t,e];return Object(U.c)(n,(function(){return null==a?void 0:a.getTemplatesData(e,(function(e){return U.a.setQueryData(n,e)}))}),{staleTime:1/0,cacheTime:1/0,enabled:a})}(e,null==a?void 0:a.templatesDataProvider),v=p.data,f=p.isLoading,b=p.isError,T=p.isSuccess,g=Object(A.a)(e,null==a?void 0:a.templatesDataProvider).data,j=Object(L.a)(),w=Object(O.useMemo)((,[e,j]),C=Object(M.a)("CreateOnStart",w,n),P=Object(O.useMemo)((function(){var t;return null!==(t=null==g?void 0:g.result.map((function(t){return{name:t.Title,iconName:"folder",onClick:function(){null==u||u.router.navigateTo({route:"Templates",app:e},!1,{driveId:t.DriveId})}}})))&&void 0!==t?t:[]}),[null==g?void 0:g.result,e,null==u?void 0:u.router]),h=Object(O.useMemo)((function(){for(var e,a,n=null!==(e=null==v?void 0:v.result.Template)&&void 0!==e?e:[],r=[],i=0;i<n.length;i++){var l=n[i],o=C(l),c=null==o?void 0:o.tileConfig.thumbnail,u=null==o?void 0:o.tileConfig.ariaLabel,s=c&&u?{url:c,altText:u}:void 0;o&&r.push({name:l.Title,ariaLabel:(null==t?void 0:t.startPageTemplateAriaLabel)&&Object(I.a)(t.startPageTemplateAriaLabel,null!==(a=l.Title)&&void 0!==a?a:""),assetId:l.AssetId,thumbnail:s,onClick:null==o?void 0:o.handleClick})}return r}),[v,C,t]),k=Object(O.useMemo)((function(){var n,r=function(e,t,a,n,r){var i,l,o,c="";switch(e){case s.a.Visio:if(null===(i=null==r?void 0:r.modernTemplatesGates)||void 0===i?void 0:i.modernTemplatesEnabled)return c;var u=Date.now(),d=null!==(l=null==a?void 0:a.correlationId)&&void 0!==l?l:"",m=null!==(o=null==a?void 0:a.preferredCulture)&&void 0!==o?o:"",p=n?"1":"0";c="".concat("https://office.live.com/start/Visio.aspx?auth=2","&").concat("lpOrigin=OFFICECOM-WEB.START","&").concat("correlationId=").concat(d,"&").concat("omkt=").concat(m,"&").concat("ds=").concat(p,"&").concat("ct=").concat(u);var v=null==t?void 0:t.scenarioId;v&&(c="".concat(c,"&").concat("scenarioid=").concat(v))}return c}(e,d,u,c,null==m?void 0:m.result);return{templatesLinkText:null!==(n=null==t?void 0:t.startPageMoreTemplatesLinkText)&&void 0!==n?n:"",templatePageHref:r,navigateToTemplates:function(){r?window.open(r,"_blank"):null==u||u.router.navigateTo({route:"Templates",app:e},!1)},displayType:null==a?void 0:a.displayType}}),[e,d,u,null==t?void 0:t.startPageMoreTemplatesLinkText,null==m?void 0:m.result,c,null==a?void 0:a.displayType]),B=Object(O.useCallback)((function(e,t){var a=e?"Templates_Error_Impression":"Templates_Impression",n=e?"":t.map(().join(";");Object(S.a)({eventName:a,area:"Templates",distribution:n,totalSize:t.length})}),[]);return Object(O.useMemo)((function(){return a&&t?{templateItems:P.concat(h),templatesLoading:f||!b&&!T,templatesLoadingError:b,templatesLoadingErrorText:null==t?void 0:t.templatesLoadingError,logTemplatesImpression:B,moreTemplateOptions:k}:void 0}),[a,t,P,h,f,b,T,B,k])}(h,N,null==w?void 0:w.templatesProviderConfig,_),z=Object(O.useMemo)((function(){var e,t,a,n,i,l=[];if(N&&(null===(e=Q[0])||void 0===e?void 0:e.onClick)){var o={name:null!==(t=N.blankTemplateText)&&void 0!==t?t:"",onClick:Q[0].onClick,ariaLabel:N.blankTemplateAriaLabel};l.push(o)}if(N&&(null===(a=null==w?void 0:w.templatesProviderConfig)||void 0===a?void 0:a.displayType)&&(null===(n=null==K?void 0:K.moreTemplateOptions)||void 0===n?void 0:n.navigateToTemplates)){var c=null===(i=null==K?void 0:K.moreTemplateOptions)||void 0===i?void 0:i.navigateToTemplates,u={name:N.startPageMoreTemplatesTileText,onClick:c,ariaLabel:N.startPageMoreTemplatesTileAriaLabel,cardPreview:g.a.createElement((function(){return g.a.createElement(r.a,null,g.a.createElement("img",{src:X?Object(T.a)(X.cdnDomain,"officestartresources","all_templates_tile","svg"):void 0,alt:null==N?void 0:N.startPageMoreTemplatesTileText}))}),null),customCss:R.allTemplatesCard,isShowMoreTemplatesCard:!0};l.push(u)}return l}),[X,Q,null===(t=null==w?void 0:w.templatesProviderConfig)||void 0===t?void 0:t.displayType,N,R.allTemplatesCard,null===(a=null==K?void 0:K.moreTemplateOptions)||void 0===a?void 0:a.navigateToTemplates]),Z=Object(O.useMemo)((function(){var e;if(H&&N){var t={Excel:R.excelUpsellPreview,PowerPoint:R.powerpointUpsellPreview,Word:R.wordUpsellPreview};return{name:null!==(e=N.premiumTemplatesText)&&void 0!==e?e:"",onClick:J,ariaLabel:N.premiumTemplatesAriaLabel,isPremiumUpsell:!0,cardPreview:g.a.createElement((function(){return g.a.createElement(r.a,null,g.a.createElement("img",{src:X?V.has(h.toLowerCase())?B(X.cdnDomain,h.toLowerCase()):B(X.cdnDomain):void 0,alt:null==N?void 0:N.premiumTemplatesAriaLabel,className:t[h]||""}))}),null)}}}),[h,X,N,V,J,H,R.excelUpsellPreview,R.powerpointUpsellPreview,R.wordUpsellPreview]);return h!==s.a.None&&N?g.a.createElement(o.a,{createItems:z,premiumUpsellItem:Z,templateSectionInfo:K,config:w,sectionTitle:N.createSectionTitle,isStorageQuotaErrorApplicable:q}):null}},m7fW:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("B5kz"),r=a("Qcgp");function i(e,t){var a=Object(r.a)(e,t),i=["EnterpriseTemplatesLibrariesData",e,t];return Object(n.c)(i,(function(){var e;return null===(e=null==a?void 0:a.getEnterpriseTemplateLibraries)||void 0===e?void 0:e.call(a,()}),{staleTime:1/0,cacheTime:1/0,enabled:a&&(null==a?void 0:a.getEnterpriseTemplateLibraries)})}},mpo9:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return m}));var n,r,i,l=a("E7ar"),o=a("8wW2"),c=!1;function u(){if(!c){c=!0;var e=void 0;try{e=Object(l.a)("userStorageCache")}catch(e){Object(o.a)().handleError(e)}n=e?e.content:{},r=!!e&&e.firstUse,i=e?e.firstUseTimestamp:0}}function s(){return u(),n}function d(){return u(),r},qecA:function(e,t,a){"use strict";function n(e){var t;return(null===(t=e.Application)||void 0===t?void 0:t.toLowerCase())||""}a.d(t,"a",(function(){return n}))},tBub:function(e,t,a){"use strict";function n(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)}a.d(t,"a",()}}]);
//# sourceMappingURL=vendors~app-create.d632156f09cf4aae851a.chunk.v7.js.map