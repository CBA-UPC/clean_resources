!this,function(e){"use strict";var t=ar A=/[^a-zA-Z0-9\\_:.-]/gim,n=/</g,r=/>/g,a=/&#([a-zA-Z0-9]*);?/gim,o=/&quot;/g,s=/&colon;?/gim,u=/&newline;?/gim,c=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,d=/u\s*r\s*l\s*\(.*/gi,g=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,l=/"/g,h=I={indexOf:function(e,t){var i,A;for(i=0,A=e.length;i<A;i++)if(e[i]===t)return i;return -1},forEach:function(e,t,i){var A,n;for(A=0,n=e.length;A<n;A++)t.call(i,e[A],A,e)},some:function(e,t,i){var A,n;for(A=0,n=e.length;A<n;A++)if(t.call(i,e[A],A,e))return!0;return!1},trim:isArray:includes:function(e,t){if("string"==typeof e)return -1!==e.indexOf(t);for(var i=0;i<e.length;i++)if(e[i]===t)return!0;return!1},spaceIndex:uniq:function(e){for(var t={},i=[],A=0;A<e.length;A++)t[e[A]]||(i.push(e[A]),t[e[A]]=!0);return i},from:keys:;unction f(e){var t,i,A,n,r,a,o,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;for(e=e);c<e.length;)n=(t=e.charCodeAt(c++))>>2,r=(3&t)<<4|(i=e.charCodeAt(c++))>>4,a=(15&i)<<2|(A=e.charCodeAt(c++))>>6,o=63&A,isNaN(i)?a=o=64:isNaN(A)&&(o=64),u=u+s.charAt(n)+s.charAt(r)+s.charAt(a)+s.charAt(o);return u}function m(e){var t,i,A,n,r,a,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="",u=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");u<e.length;)t=o.indexOf(e.charAt(u++))<<2|(n=o.indexOf(e.charAt(u++)))>>4,i=(15&n)<<4|(r=o.indexOf(e.charAt(u++)))>>2,A=(3&r)<<6|(a=o.indexOf(e.charAt(u++))),s+=String.fromCharCode(t),64!==r&&(s+=String.fromCharCode(i)),64!==a&&(s+=String.fromCharCode(A));return s)}function _(e,t,i){var A="",n=0,r=!1,a=!1,o=0,s=e.length,u="",c="";e:for(o=0;o<s;o++){var d=e.charAt(o);if(!1===r){if("<"===d){r=o;continue}}else if(!1===a){if("<"===d){A+=i(e.slice(n,o)),r=o,n=o;continue}if(">"===d||o===s-1){A+=i(e.slice(n,r)),u=c=e.slice(r,o+1)),A+=t(r,A.length,u,c,"</"===c.slice(0,2)),n=o+1,r=!1;continue}if('"'===d||"'"===d)for(var g=1,l=e.charAt(o-g);""===l.trim()||"="===l;){if("="===l){a=d;continue e}l=e.charAt(o-++g)}}else if(d===a){a=!1;continue}}return n<s&&(A+=i(e.substr(n))),A}function v(e,t){var i=0,n=0,r=[],a=!1,o=e.length;or(var u=0;u<o;u++){var c=e.charAt(u),d=void 0;if(!1!==a||"="!==c){if(!1===a||u!==n){if(/\s|\n|\t/.test(c)){if(e=e.replace(/\s|\n|\t/g," "),!1===a){if(-1===(d=function(e,t){for(;t<e.length;t++){var i=e[t];if(" "!==i)return"="===i?t:-1}return -1}(e,u))){s(I.trim(e.slice(i,u))),a=!1,i=u+1;continue}u=d-1;continue}if(-1===(d=function(e,t){for(;t>0;t--){var i=e[t];if(" "!==i)return"="===i?t:-1}return -1}(e,u-1))){s(a,C(I.trim(e.slice(i,u)))),a=!1,i=u+1;continue}}}else{if(-1===(d=e.indexOf(c,u+1)))break;s(a,I.trim(e.slice(n+1,d))),a=!1,i=(u=d)+1}}else a=e.slice(i,u),i=u+1,n='"'===e.charAt(i)||"'"===e.charAt(i)?i:function(e,t){for(;t<e.length;t++){var i=e[t];if(" "!==i)return"'"===i||'"'===i?t:-1}return -1}(e,u+1)}return i<e.length&&(!1===a?s(e.slice(i)):s(a,C(I.trim(e.slice(i))))),I.trim(r.join(" "))}function p(e,t,i){var A,n;if(i=function(e){for(var t="",i=0,A=e.length;i<A;i++)t+=32>e.charCodeAt(i)?" ":e.charAt(i);return I.trim(t)}(i.replace(o,'"').replace(a,.replace(s,":").replace(u," ")),"href"===t||"src"===t){if("#"===(i=I.trim(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"tel:"!==i.substr(0,4)&&"data:image/"!==i.substr(0,11)&&"ftp://"!==i.substr(0,6)&&"./"!==i.substr(0,2)&&"../"!==i.substr(0,3)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===t){if(c.lastIndex=0,c.test(i))return""}else if("style"===t&&(g.lastIndex=0,g.test(i)||(d.lastIndex=0,d.test(i)&&(c.lastIndex=0,c.test(i)))))return"";return i=h(i.replace(l,"&quot;"))}var E=y=function(){function e(e){var t=e||{});t.stripIgnoreTag&&(t.onIgnoreTag,t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=p,t.escapeHtml=h,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t,i,A,n,r,a=this.options,o=a.whiteList,s=a.onTag,u=a.onIgnoreTag,c=a.onTagAttr,d=a.onIgnoreTagAttr,g=a.safeAttrValue,l=a.escapeHtml;a.stripBlankChar&&(e=e.split("").filter(.join("")),a.allowCommentTag||(e=e));var h=!1;a.stripIgnoreTagBody&&(t=a.stripIgnoreTagBody,"function"!=typeof(i=u)&&(i=function(){}),A=!Array.isArray(t),n=[],r=!1,u=(h={onIgnoreTag:function(e,a,o){if(A||-1!==I.indexOf(t,e)){if(o.isClosing){var s="[/removed]",u=o.position+s.length;return n.push([!1!==r?r:o.position,u]),r=!1,s}return r||(r=o.position),"[removed]"}return i(e,a,o)},remove:).onIgnoreTag);var C=_(e,function(e,t,i,A,n){var r={sourcePosition:e,position:t,isClosing:n,isWhite:Object.prototype.hasOwnProperty.call(o,i)},a=s(i,A,r);if(null!=a)return a;if(r.isWhite){if(r.isClosing)return"</".concat(i,">");var h=A),C=o[i],f=v(h.html,function(e,t){var A=-1!==I.indexOf(C,e),n=c(i,e,t,A);return null==n?A?(t=g(i,e,t,null))?"".concat(e,'="').concat(t,'"'):e:null==(n=d(i,e,t,A))?void 0:n:n});return A="<".concat(i),f&&(A+=" ".concat(f)),h.closing&&(A+=" /"),A+=">"}return null==(a=u(i,A,r))?l(A):a},l);return h&&(C=h.remove(C)),C},e}(),R=Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")(),b=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var t,i,A="douyin_web";if(!I.includes(A,"bid"))return A;if(e.config&&e.config.bid)return e.config.bid;if(R&&R._xssBid)return R._xssBid;if(R&&R.slardar&&"function"==typeof R.slardar.config){var n=(R.slardar.config()||{}).bid;if(n)return n}if(R&&R.Slardar&&"function"==typeof R.Slardar.config){var r=(R.Slardar.config()||{}).bid;if(r)return r}return(null===(i=null===(t=null==R?void 0:R.Slardar)||void 0===t?void 0:t._baseParams)||void 0===i?void 0:i.bid)||"argus"},this.getConfigRegion=function(){var t;return I.includes("cn","region")?e.config&&e.config.region?e.config.region:((null===(t=null==R?void 0:R.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():"cn"},this.gerReportUrl=return e.prototype.setConfig=function(e){this.config=e},e.prototype.upload=function(){var e=this,t=this.gerReportUrl();!this.lock&&t&&0!==this.batchData.length&&(this.lock=!0,setTimeout(function(){var i=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),R.fetch(t,{method:"post",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}).catch(function(e){}),e.lock=!1,e.upload()},this.timeout))},e.prototype.generateKey=e.prototype.push=e.prototype.report=function(e){var t=this.generateKey(e);if(R.fetch&&e.collectKey){var i="object"==typeof window?window.location.href:"SSR";e.documentUrl=i;var A={age:Math.floor(Date.now()),type:"xss",url:i,body:e,"user-agent":""};"enforce"===e.disposition&&"SSR"!==i||(A.url=t),"SSR"===i&&(A.url="SSR___".concat(A.url),A.body.ssr=!0),this.push(A)}},e}()),Z=function(e){for(var t=0,i=function(i){Array.isArray(e[i])?0===e[i].length?delete e[i]:(e[i]=I.from(I.uniq(e[i])),t+=e[i].length):0===I.keys(e[i]).length?delete e[i]:I.keys(e[i]).forEach(function(A){e[i][A]=I.from(I.uniq(e[i][A])),t+=e[i][A].length})},A=0,n=I.keys(e);A<n.length;A++)i(n[A]);return{count:t,ret:e}};function k(e,t){return b.setConfig(t),new y(t).process(e)}function T(e){var t,i=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===i)return{html:"",closing:"/"===e[e.length-2]};var A="/"===(e=e.slice(i+1,-1).trim())[e.length-1];return A&&(e=e.slice(0,-1).trim()),{html:e,closing:A}}var V=function(e){return -1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,.replace(/(\t|\n|\r)/g,"").toLowerCase()};function S(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=V(e),I.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!I.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var i=["expression(","behavior:","view-source:"];if(I.some(i,function(t){return -1!==e.indexOf(t)}))return I.forEach(i,function(i){-1!==e.indexOf(i)&&t&&t(i)}),!1;var A=["data:application","data:javascript","data:text/html","data:texthtml"];if(I.some(A,)return I.forEach(A,,!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var n=e.slice(11).replace(/\s/g,"").trim();return!!I.some(["void","void(0)","void0","false","undefined",";"],||(t&&t("javascript:"),!1)}return!0}var D=function(e,t){var i,A,n="<%= isSaveValidUrl =>";if("string"!=typeof e||(A=Number("<%= urlLimit =>"),void 0!==i&&(A=i),"NaN"!==e.toString()&&-1!==A&&e.length>=A)||S(e,t))return e;try{if(!0===(n=JSON.parse(n))||"true"===n){var r=new URL(e);return r.origin+r.pathname}}catch(e){}return"#"};function G(e,t,A){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!S(e=V(e)))return!1;var n,r={url:(n=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[])[0],scheme:n[1],slash:n[2],host:n[3],port:n[4],path:n[5],query:n[6],hash:n[7]},a=r.scheme,o=r.host;return A?!!A(e):!(!a||!o)&&(!I.includes(["http","https","file"],a)||("object"==typeof window&&window&&(t=i(i([],t,!0),[location.host],!1)),I.some(t,))}var B={a:["target","title","spellcheck","rel"],canvas:[],abbr:["title"],address:[],area:["shape","coords","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:["dir"],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["alt","title","width","height","decoding"],ins:["datetime"],li:[],mark:[],nav:[],ol:["start"],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],delete:[],form:[],strong:[],mask:["maskunits","x","y","width","height","fill"],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],wbr:[],video:["autoplay","controls","loop","preload","height","width"],svg:["viewBox","version","xmlns","fill","width","height","stroke","stroke-width","style"],path:["d","fill","opacity","stroke","p-id","fill-rule","clip-rule","stroke-width","stroke-linecap","stroke-linejoin","fill-opacity","mask"],rect:["x","y","width","height","fill","stroke","rx"],g:[]},w={collect:null,initCollect:function(){this.collect={whiteList:{},filterProtocol:[]}},removeCollect:function(){var e=Z(this.collect),t=e.count,i=e.ret;return this.collect=null,{collectKey:0===t?null:JSON.stringify(i),collectMode:"white"}},onIgnoreTagAttr:function(e,t,A){return e&&I.indexOf(["href","src"],t)>-1?w.domainWhiteList&&Array.isArray(w.domainWhiteList)&&w.domainWhiteList.length>0&&!G(A,i([],w.domainWhiteList,!0))?"":"".concat(t,'="').concat(D(A,function(e){var t;null===(t=w.collect)||void 0===t||t.filterProtocol.push(e)}),'"'):e&&(I.indexOf(["style","class","id"],t)>-1||t.indexOf("data-")>-1)?"".concat(t,'="').concat(A,'"'):(w.collect.whiteList[e]=w.collect.whiteList[e]||[],void w.collect.whiteList[e].push(t))},onIgnoreTag:function(e,t){if("style"===e)return t;_(t,function(e,t,i,A){v(T(A).html.replace("/",""),},h)},whiteList:B,mergeWhiteList:function(e){for(var t,i={},A=0,n=I.keys(B);A<n.length;A++)i[t=n[A]]=I.from(B[t]);for(var r=0,a=I.keys(e);r<a.length;r++)i[t=a[r]]=t in B?B[t].concat(e[t]):I.from(e[t]);return i},setWhiteList:;try{var N={},L="merge";I.includes(L,"override")&&(w.whiteList=N.whiteList),I.includes(L,"merge")&&w.setWhiteList(N.whiteList)}catch(e){}var W=function(e,t){for(var i={},A=0,n=I.keys(e);A<n.length;A++){var r=n[A];Array.isArray(e[r])?i[r]=I.from(e[r]):i[r]=W({},e[r])}for(var a=0,o=I.keys(t);a<o.length;a++)(r=o[a])in e?Array.isArray(e[r])?i[r]=e[r].concat(t[r]):i[r]=W(e[r],t[r]):Array.isArray(t[r])?i[r]=I.from(t[r]):i[r]=W({},t[r]);return i},Y={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var F={};F.blackAttrRegExps&&(F.blackAttrRegExps=F.blackAttrRegExps.map();var O="merge";I.includes(O,"override")&&(Y=F),I.includes(O,"merge")&&(Y=W(Y,F))}catch(e){}var x={mode:"black",whiteList:{},blackConfig:Y,collect:null,initCollect:removeCollect:function(){var e=Z(x.collect),t=e.count,i=e.ret;return x.collect=null,{collectKey:0===t?null:JSON.stringify(i),collectMode:"black"}},onIgnoreTag:function(e,t){var i;if(!I.includes(Y.blackTags,e))return _(t,function(e,t,i,A,n){if(-1!==i.indexOf("/"))return h(A);if(n)return"</".concat(i,">");var r=T(A),a=v(r.html,function(e,t){var A,n=0;if(Y.blackList[i]&&I.includes(Y.blackList[i],e)&&(x.collect.blackList[i]=x.collect.blackList[i]||[],x.collect.blackList[i].push(e),n++),Y.blackAttrRegExps.length&&Y.blackAttrRegExps.some(function(t){return t.test(e)})&&I.forEach(Y.blackAttrRegExps,,Y.blackAttrs.length&&I.includes(Y.blackAttrs,e)&&(Y.blackAttrs.push(e),n++),!n){if(Y.filterList&&Y.filterList[i]&&I.includes(Y.filterList[i],e)){var r=D(t,function(e){var t;null===(t=x.collect)||void 0===t||t.filterProtocol.push(e)});return r!==t&&(x.collect.filterList[i]=x.collect.filterList[i]||[],x.collect.filterList[i].push(e)),t?"".concat(e,"='").concat(r,"'"):e}return Y.filterAttrs&&I.includes(Y.filterAttrs,e)?((r=D(t,)!==t&&(null===(A=x.collect)||void 0===A||A.filterAttrs.push(e)),t?"".concat(e,"='").concat(r,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}});return A="<".concat(i),a&&(A+=" ".concat(a)),r.closing&&(A+=" /"),A+=">"},h);null===(i=x.collect)||void 0===i||i.blackTags.push(e)}},U=function(e){var t=e.reportOnly,i=void 0===t||t,A=e.block;return i&&"all"===i?"report":("string"==typeof i&&("true"===i&&(i=!0),"false"===i&&(i=!1)),A?"enforce":i?"report":"enforce")},X=function(e){return function(i,A,n){if(!i||"string"!=typeof i)return i;var r=A;e===k&&(r=w).initCollect();var a=e(i,r);if(E(a)===E(i))return i;if(!n)return a;var o=n.logType,s=U(n),u=r.removeCollect();return b.report(t(t({type:o,disposition:s},u),{sourceText:f(i),filterText:f(a)})),"enforce"===s?a:i}},M=X(function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new y(t).process(e)}),K=X(k),Q=function(e,t,i){var A=[],n=D(e,function(e){A.push(e)});if(n===e)return e;A=I.from(I.uniq(A));var r=t||i||{};if(!r)return n;var a=r.logType,o=U(i);return b.report({type:a,disposition:o,collectKey:A.join("___"),collectData:JSON.stringify(A),collectMode:"black",sourceText:f(e),filterText:f(n)}),"enforce"===o?n:e},P=R._xssProject||{},H=R.xssNamespace||{},J="3.0.26",z={FilterXSS:y,version:J,webpackPluginVersion:"<%= webpackPluginVersion =>",reportOnly:"<%= reportOnly =>",filterXSS:M,_filterXSS:K,filterUrl:Q,Config:w,BlackConfig:x,project:P,setProjectName:;H.douyin_web=z,R.xssNamespace=H,R.Math&&!R.Math.xssNamespace&&(R.Math.xssNamespace=H),P[J]=z,R.globalThis=R,R.getFilterXss=R.xss=z,R.isSafeUrl=G,R.isSafeDomain=G,R.isSafeProtocol=S,R._xssProject=P,R._xssProjectName&&(P[R._xssProjectName]=z);var j=z.setProjectName.bind(z);e.BlackConfig=x,e.Config=w,e.FilterXSS=y,e._filterXSS=K,e.filterUrl=Q,e.filterXSS=M,e.isSafeDomain=G,e.isSafeProtocol=S,e.isSafeUrl=G,e.project=P,e.setProjectName=j,e.setXssNamespace=function(e){var t=e.appId,i=e.bid,A=e.region;H[t]=z,w.bid=i,w.region=A,w.enabled=!0},e.xssNamespace=H,Object.defineProperty(e,"__esModule",{value:!0})});"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([[1423],{45221:function(e,t,i){.d(t,{Z:function(){return A}}),i(98495)},63598:function(e,t,i){i.d(t,{Z:function(){return a}});var A=i(43807),n=i(11079);i(38747),i(74985),i(93524),i(98495);var r=),a=)},49478:function(e,t,i){i.d(t,{Z:function(){return n}}),i(801);var A=!function(){var e="_localstorage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}(),n={length:A?localStorage.length:0,clear:function(e){try{for(var t=localStorage.length-1;t>=0;t--){var i=localStorage.key(t);0===i.indexOf(e)&&localStorage.removeItem(i)}}catch(e){}},getItem:function(e){try{return localStorage.getItem(e)}catch(e){return null}},key:function(e){try{return localStorage.key(e)}catch(e){return null}},setItem:function(e,t){try{localStorage.setItem(e,t)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},isSupport:A}},3059:function(e,t,i){i.d(t,{Z:function(){return r}});var A=i(43807),n=i(11079);i(71602),i(3156);var r=function(){function e(){(0,A.Z)(this,e);var t,i,n=new Promise(function(e,A){t=e,i=A});return n.resolve=t,n.reject=i,n}return(0,n.Z)(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}()},97069:function(e,t,i){(t,{zh:function(){return a},XK:function(){return u},v8:function(){return y},vI:function(){return f},Xb:function(){return s},Ic:function(){return C}}),i(71602),i(3156);let a=function(){eturn r(e,[{key:"repeat",value:,{key:"repeatInterval",value:,{key:"clear",value:]),e}();var o=!);let s={length:o?localStorage.length:0,clear:function(e){try{for(var t=localStorage.length-1;t>=0;t--){var i=localStorage.key(t);0===i.indexOf(e)&&localStorage.removeItem(i)}}catch(e){}},getItem:function(e){try{return localStorage.getItem(e)}catch(e){return null}},key:setItem:removeItem:isSupport:o};var u=function(){function e(){A(this,e);var t,i,n=new Promise(function(e,A){t=e,i=A});return n.resolve=t,n.reject=i,n}return r(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}();i(59564),i(93567),i(19858),i(68685),i(22454);var c="IWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO3ZhciBlPXt9LHQ9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtmdW5jdGlvbiBhKHQscyl7ZVt0XT1zZXRUaW1lb3V0KChmdW5jdGlvbigpe3Bvc3RNZXNzYWdlKHtkYXRhOntmYWtlSWQ6dH19KSxhKHQscyl9KSxzKX1wb3N0TWVzc2FnZSh7ZXZlbnQ6InJlYWR5In0pLGFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLChmdW5jdGlvbihzKXt0cnl7dmFyIHI9cy5kYXRhLG89dm9pZCAwPT09cj97fTpyLGM9by5hY3Rpb24sbj1vLmZha2VJZCxpPW8udGltZTtzd2l0Y2goYyl7Y2FzZSJzZXRJbnRlcnZhbCI6YShuLGkpO2JyZWFrO2Nhc2UiY2xlYXJJbnRlcnZhbCI6Y2FzZSJjbGVhclRpbWVvdXQiOnQuY2FsbChlLG4pJiYoY2xlYXJUaW1lb3V0KGVbbl0pLGRlbGV0ZSBlW25dKTticmVhaztjYXNlInNldFRpbWVvdXQiOmVbbl09c2V0VGltZW91dCgoZnVuY3Rpb24oKXtwb3N0TWVzc2FnZSh7ZGF0YTp7ZmFrZUlkOm59fSksdC5jYWxsKGUsbikmJmRlbGV0ZSBlW25dfSksaSl9fWNhdGNoKGQpe3Bvc3RNZXNzYWdlKHtldmVudDoiZXJyb3IiLGRhdGE6e2Vycm9yOmR9fSl9fSkpfSgpOwo=",d="undefined"!=typeof window&&window.Blob&&new Blob([atob(c)],{type:"text/javascript;charset=utf-8"});ar l,h={},I=0;if("undefined"!=typeof Worker){var C,f,m,_=!1,v=!1,p=function(){if(!m){var e=Promise.withResolvers(),t=e.promise,i=e.resolve,A=e.reject;m=t;try{(l=new g).addEventListener("message",function(e){var t=e.data,n=t.event,r=t.data;switch(n){case"error":v=!0,A(r.error);break;case"ready":_=!0,i();break;default:var a=r.fakeId;if(a in h){var o=h[a]||{},s=o.cb,u=o.param,c=o.keepAlive,d=o.type;if("setInterval"!==d&&delete h[a],!c&&document.hidden)return;if("function"==typeof s)try{s.apply(window,u)}catch(e){}}}}),l.addEventListener("error",}catch(e){v=!0,A(e)}}return m},E=function(e,t){v?t&&t():_?e():p().then(e,t)};C=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("function"!=typeof e)throw Error("cb must be a function");for(var A=function(){do 2147483647===I?I=0:I++;while((I in h));return I}(),n=arguments.length,r=Array(n>3?n-3:0),a=3;a<n;a++)r[a-3]=arguments[a];return h[A]={cb:e,param:r,keepAlive:!!i,type:"setInterval"},E(function(){A in h&&(h[A].degradeId=setInterval(e,t))}),A},f=function(e){if("number"==typeof e&&e in h){var t=h[e].degradeId;delete h[e],E(}}}else C=setInterval,f=clearInterval;i(49118),i(19232),i(36766),i(71654);var y=function(){eturn r(e,null,[{key:"parse",value:,{key:"parseXmlString",value:function(e){if(void 0===e)return null;var t,i=new window.DOMParser;try{(t=i.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}return t}},{key:"parseDOMChildren",value:function(t,i){if(t.nodeType===Node.DOCUMENT_NODE){for(var A={},n=t.childNodes,r=0;r<n.length;r++){var a=n[r];a.nodeType===Node.ELEMENT_NODE&&(A=e.parseDOMChildren(a))}return A}if(t.nodeType===Node.ELEMENT_NODE){var o={};o.__cnt=0;for(var s=[],u=t.childNodes,c=0;c<u.length;c++){var d=u[c],g=e.getNodeLocalName(d);if(d.nodeType!==Node.COMMENT_NODE){var l="".concat(i,".").concat(g);if(o.__cnt++,null==o[g]){var h=e.parseDOMChildren(d,l);if("#text"!==g||/[^\s]/.test(h)){var I={};I[g]=h,s.push(I)}o[g]=h,e.toArrayAccessForm(o,g)}else{null==o[g]||o[g]instanceof Array||(o[g]=[o[g]],e.toArrayAccessForm(o,g,l));var C=e.parseDOMChildren(d,l);if("#text"!==g||/[^\s]/.test(C)){var f={};f[g]=C,s.push(f)}o[g][o[g].length]=C}}}for(var m=0;m<t.attributes.length;m++){var _=t.attributes[m];o.__cnt++;var v=_.value;o[_.name]=v}var p=t.prefix;return null!=p&&""!==p&&(o.__cnt++,o.__prefix=p),null!=o["#text"]&&(o.__text=o["#text"],o.__text instanceof Array&&(o.__text=o.__text.join("\n")),delete o["#text"],delete o["#text_asArray"]),null!=o["#cdata-section"]&&(o.__cdata=o["#cdata-section"],delete o["#cdata-section"],delete o["#cdata-section_asArray"]),1===o.__cnt&&null!=o.__text?o=o.__text:1===o.__cnt&&null!=o.__cdata&&(o=o.__cdata),delete o.__cnt,o}if(t.nodeType===Node.TEXT_NODE||t.nodeType===Node.CDATA_SECTION_NODE)return t.nodeValue}},{key:"getNodeLocalName",value:function(e){var t=e.localName;return null==t&&(t=e.baseName),(null==t||""===t)&&(t=e.nodeName),t}},{key:"toArrayAccessForm",value:function(e,t){e[t]instanceof Array||(e[t]=[e[t]])}}]),e}();Promise.withResolvers||(Promise.withResolvers=},99206:function(e,t,i){i.d(t,{Z:function(){return eS}}),i(73872);var A,n,r,a=i(43807),o=i(15737),s=i(62014),u=i(90029),c=i(94465),d=i(11079),g=i(55492),l=i(12348),h=i(6228);i(31807),i(86357),i(19232),i(56551),i(23978),i(71602),i(3156),i(49118),i(15009),i(26108),i(81904),i(96613),i(57275),i(84764),i(85248);var I=function(){return"undefined"!=typeof navigator&&10>parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))&&!window.MSStream},C=f=function(){function e(){var t=this;(0,a.Z)(this,e),this.enabled=!1,C()?(this._wakeLock=null,this.handleVisibilityChange=document.addEventListener("visibilitychange",this.handleVisibilityChange),document.addEventListener("fullscreenchange",this.handleVisibilityChange)):I()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"mp4","data:video/mp4;base64, AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw"),this._addSourceToVideo(this.noSleepVideo,"webm","data:video/webm;base64,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"),this.noSleepVideo.addEventListener("loadedmetadata",)}return(0,d.Z)(e,[{key:"_addSourceToVideo",value:,{key:"visible",get:,{key:"isEnabled",get:function(){return this.enabled}},{key:"enable",value:function(){var e=this;if(C()&&this.visible)return navigator.wakeLock.request("screen").then(.catch(function(){e.enabled=!1});if(I())return this.disable(),this.noSleepTimer=window.setInterval(15e3),this.enabled=!0,Promise.resolve();if(null!==(t=this.noSleepVideo)&&void 0!==t&&t.paused){var t,i=this.noSleepVideo.play();return i&&i.then(.catch(}}},{key:"disable",value:,{key:"toPlay",value:,{key:"destroy",value:function(){this.disable(),this.handleVisibilityChange&&(document.removeEventListener("visibilitychange",this.handleVisibilityChange),document.removeEventListener("fullscreenchange",this.handleVisibilityChange)),this.onTimeupdate&&this.noSleepVideo.removeEventListener("timeupdate",this.onTimeupdate),this.noSleepVideo=null,this.handleVisibilityChange=null}}]),e}();unction _(){var e=A||(A=document.querySelector("#hackAudioPP"));if(!e){m();return}(!1!==e.paused||!1!==e.muted)&&(e.muted=!1,e.play().catch(function(e){}))}var v=i(46076);i(59564),i(40352),i(65539),i(21165),i(93392),i(56197),i(91319),i(51547),i(87017),i(29290),i(89947),i(16523),i(44159),i(95383),i(69124),i(26409),i(10894),i(52649),i(69027),i(31280),i(12540),i(2590),i(38062),i(58966),i(57510);var p=new(function(){function e(){var t=this;(0,a.Z)(this,e);try{var i=/xgd=(\d)/.exec(document.cookie);this._status=!!i,this._level=i&&i[1]}catch(e){this._status=!1}["group","groupEnd","log","warn","error"].forEach(function(e){t[e]=function(i,A,n,r,a,o,s,u,c,d){if(t._status){var g,l=[A,n,r,a,o,s,u,c,d].filter(;(g=console)[e].apply(g,["["+i+"]:"].concat((0,v.Z)(l)))}}})}return(0,d.Z)(e,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return"2"===this._level}}]),e}());(75521);var y="xg-video",R=!1;try{R=WebAssembly&&WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))}catch(e){}var b={preloadDecoder:!1,reuseWasmDecoder:!0,reuseMseForAudio:!1,preciseSeekLimit:120,h264WithWebcodec:!0,lowDecodeThreshold:75,lowDecodeFpsDelta:10,tempDisabledThreshold:40,wasmFallbackToAsm:!1,audioWithMse:!0,canUseThreadMode:!1,offscreenCanvas:!1,disabledDuration:43200,longDisabledDuration:604800,evaluateVVCount:0,disabledByLowdecodePrecent:.5,maxDecodeOnceWasm:R?6:8,maxDecodeOnceFirstTime:8,maxDecodeOnceWebcodec:20};unction k(){if("undefined"==typeof customElements)return!1;var e=customElements.get(y);return R&&!!(null!=e&&e.h265SimdUrl)}function T(){if("undefined"==typeof customElements)return!1;var e=customElements.get(y);return!!window.SharedArrayBuffer&&!!(null!=e&&e.h265ThreadUrl)}var V=!1;try{V=(null===(n=localStorage)||void 0===n?void 0:null===(r=n.getItem)||void 0===r?void 0:r.call(n,"_sds"))==="y"}catch(e){}var S=0,D=0,G=0,B=!1;function w(e){try{localStorage.setItem("xgv_dis",e),(2===e||3===e)&&localStorage.setItem("xgv_dist",new Date().getTime())}catch(e){}}ar L=i(1987),W=i.n(L),Y=i(34979),F=i(32436),O=i.n(F);i(29994);var x={WAITING:0,CANPLAY:1,PLAY:2,PLAYING:3,PAUSE:4,SEEKING:5,SEEKED:6,LOADEDDATA:7,LOADEDMETADATA:8,TIMEUPDATE:9,DURATION_CHANGE:10,VOLUME_CHANGE:11,PROGRESS:12,ERROR:13,ENDED:14,RESIZE:15,LOADSTART:16,DECODE_FPS:17,LOW_DECODE:18,LARGE_AV_GAP:19,FIRST_FRAME:20,CANVAS_LAYOUT:21},U=["waiting","canplay","play","playing","pause","seeking","seeked","loadeddata","loadedmetadata","timeupdate","durationchange","volumechange","progress","error","ended","resize","loadstart","decodefps","lowdecode","largeavgap","firstframe","canvaslayout"],X={AUDIO:{AUDIO_READY:"audio_ready",AUDIO_NOT_ALLOWED_AUTOPLAY:"audio_not_allowed_autoplay",AUDIO_WAITING:"audio_waiting",AUDIO_SYNC_DTS:"audio_sync_dts"},VIDEO:{VIDEO_DECODER_INIT:"video_decode_init",VIDEO_READY:"video_ready",VIDEO_WAITING:"video_waiting",AUTO_RUN:"auto_run",DECODE_LOW_FPS:"decode_low_fps",UPDATE_VIDEO_FILLTYPE:"update_video_filltype",UPDATE_VIDEO_COVER_POSITION:"update_video_cover_position"},TIMELINE:{PLAY_EVENT:"play_event",SET_METADATA:"set_metadata",APPEND_CHUNKS:"append_chunks",START_RENDER:"start_render",DO_PLAY:"do_play",DO_PAUSE:"do_pause",DO_SEEK:"do_seek",SET_PLAYBACKRATE:"set_playbackrate",SYNC_DTS:"sync_dts",RESET_BASE_DTS:"reset_base_dts",UPDATE_VOLUME:"update_volume",SINGLE_TRACK:"single_track",DESTROY:"destroy",READY:"ready",UPDATE_GL_OPTIONS:"update_gl_options",SET_VIDEO_DURATION:"set_video_duration",SET_PLAY_MODE:"set_play_mode",UPDATE_CAPABILITY_LEVEL:"update_capability_level",INNER_DEGRADE:"inner_degrade",ADJUST_SEEK_TIME:"adjust_seek_time",CHASE_FRAME:"chase_frame",END_OF_STREAM:"end_of_stream",UPDATE_SEGMENT_END:"update_segment_end"},VIDEO_EVENTS:x,DECODE_EVENTS:{INIT:"init",READY:"decoderready",REMUX:"remux",INIT_FAILED:"initfailed",DATAREADY:"dataReady",PLAY_FAILED:"playfailed",FRAGMENT_END:"fragmentEnd",APPEND_VIDEO:"appendVideo",FIRST_FRAME:"firstFrame",DECODED:"decoded",RENDE_END:"rendeEnd",CHASE_VIDEO_FRAME:"chaseVideoFrame",CHASE_VIDEO_FRAME_END:"chaseVideoFrameEnd",CHASE_AUDIO_FRAME:"chaseAudioFrame",INIT_SEGMENT:"initSegment",MEDIA_SEGMENT:"mediaSegment",FRAME_MAX_COUNY:"frameMaxCount",FRAME_MIN_COUNY:"frameMinCount"}},M=function(e){(0,o.Z)(A,e);var t,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(A);if(t){var n=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function A(e,t){var n;return(0,a.Z)(this,A),(n=i.call(this))._config=e,n._parent=t,n._meta=null,n._ready=!1,n._isLive=!0,n._innerDegrade=!1,n._singleTrack=-1,n}return(0,d.Z)(A,[{key:"analyse",get:function(){return this._parent.analyse}},{key:"isLive",get:function(){return this._isLive}},{key:"innerDegrade",get:function(){return this._innerDegrade}},{key:"noAudio",get:function(){return 1===this._singleTrack||2===this._singleTrack}},{key:"noVideo",get:function(){return 3===this._singleTrack}},{key:"duration",get:function(){return this._timeRange.duration},set:function(e){this._timeRange&&(this._timeRange.duration=e)}},{key:"_bindEvents",value:function(){var e=this;this._parent.on(X.TIMELINE.APPEND_CHUNKS,this._appendChunk.bind(this)),this._parent.on(X.TIMELINE.RESET_BASE_DTS,this._resetDts.bind(this)),this._parent.on(X.TIMELINE.START_RENDER,this._startRender.bind(this)),this._parent.on(X.TIMELINE.DO_PLAY,this._doPlay.bind(this)),this._parent.on(X.TIMELINE.DO_PAUSE,this._doPause.bind(this)),this._parent.on(X.TIMELINE.DO_SEEK,this._doSeek.bind(this)),this._parent.on(X.TIMELINE.DESTROY,this._destroy.bind(this)),this._parent.on(X.TIMELINE.CHASE_FRAME,this._doChaseFrame.bind(this)),this._parent.on(X.TIMELINE.SINGLE_TRACK,function(t){e._singleTrack=t}),this._parent.on(X.TIMELINE.SET_PLAY_MODE,,this._parent.on(X.TIMELINE.INNER_DEGRADE,,this._parent.on(X.TIMELINE.SET_VIDEO_DURATION,}}]),A}(W());i(64200);var K=function(){function e(t){(0,a.Z)(this,e),this.TAG="AudioTimeRange",this._parent=t,this._buffers=[],this._duration=0,this._baseDts=0,this._lastBuffer=null}return(0,d.Z)(e,[{key:"isLive",get:function(){return this._parent.isLive}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"buffered",get:function(){var e=this;if(this.isLive)return{length:this._duration?1:0,start:function(){return 0},end:function(){return e._duration}};var t=this._mergeBufferRanges();return{length:t.length,start:function(e){var i=t[e];return i?i.start:0},end:function(e){var i=t[e];return i?i.end:1/0}}}},{key:"resetDts",value:function(e){this._baseDts=e}},{key:"_transitionSamples",value:function(e){for(var t=e.numberOfChannels,i=e.length,A=0;A<t;A++){for(var n=e.getChannelData(A),r=0;r<512;r++)n[r]=n[r]*r/512;for(var a=i-512;a<i;a++)n[a]=n[a]*(i-a)/512}}},{key:"append",value:function(e,t,i,A){-1===this._baseDts&&(this._baseDts=i),this._transitionSamples(e);var n=(i-this._baseDts)/1e3,r=n+t,a={start:n,end:r,startDts:i,source:e,duration:t,delay:A};return(p.log(this.TAG,"add new buffer range, startDts:".concat(i,", [").concat(a.start," , ").concat(a.end,"]")),this._buffers.filter(function(e){return e.start===n}).length)?void 0:(this._buffers.push(a),this.isLive&&(this._duration=r),a.start)}},{key:"deletePassed",value:,{key:"canSeek",value:function(e){var t=this._buffers[this._buffers.length-1];return!!t&&!(t.start<e)}},{key:"_mergeBufferRanges",value:function(){var e=this._buffers.slice().sort(function(e,t){return e.start>t.start?1:-1}),t=e.length,i=[];if(!t)return i;for(var A={start:e[0].start,end:e[0].end},n=1;n<t;n++){var r=e[n];.5>Math.abs(A.end-r.start)?A.end=r.end:(i.push(A),A={start:r.start,end:r.end})}return i.push(A),i}},{key:"getBuffer",value:function(e){if(this.isLive)return this._buffers.shift();var t=this._buffers.filter([0];return(p.log(this.TAG,"get audio buffer , currentTime:".concat(e," ,buffer:[").concat(t&&t.start," , ").concat(t&&t.end,"]")),0!==e||t)?t:this._buffers[0]}},{key:"hasBuffer",value:function(){var e;return!!(null!==(e=this._buffers)&&void 0!==e&&e.length)}}]),e}(),Q=[-5504,-5248,-6016,-5760,-4480,-4224,-4992,-4736,-7552,-7296,-8064,-7808,-6528,-6272,-7040,-6784,-2752,-2624,-3008,-2880,-2240,-2112,-2496,-2368,-3776,-3648,-4032,-3904,-3264,-3136,-3520,-3392,-22016,-20992,-24064,-23040,-17920,-16896,-19968,-18944,-30208,-29184,-32256,-31232,-26112,-25088,-28160,-27136,-11008,-10496,-12032,-11520,-8960,-8448,-9984,-9472,-15104,-14592,-16128,-15616,-13056,-12544,-14080,-13568,-344,-328,-376,-360,-280,-264,-312,-296,-472,-456,-504,-488,-408,-392,-440,-424,-88,-72,-120,-104,-24,-8,-56,-40,-216,-200,-248,-232,-152,-136,-184,-168,-1376,-1312,-1504,-1440,-1120,-1056,-1248,-1184,-1888,-1824,-2016,-1952,-1632,-1568,-1760,-1696,-688,-656,-752,-720,-560,-528,-624,-592,-944,-912,-1008,-976,-816,-784,-880,-848,5504,5248,6016,5760,4480,4224,4992,4736,7552,7296,8064,7808,6528,6272,7040,6784,2752,2624,3008,2880,2240,2112,2496,2368,3776,3648,4032,3904,3264,3136,3520,3392,22016,20992,24064,23040,17920,16896,19968,18944,30208,29184,32256,31232,26112,25088,28160,27136,11008,10496,12032,11520,8960,8448,9984,9472,15104,14592,16128,15616,13056,12544,14080,13568,344,328,376,360,280,264,312,296,472,456,504,488,408,392,440,424,88,72,120,104,24,8,56,40,216,200,248,232,152,136,184,168,1376,1312,1504,1440,1120,1056,1248,1184,1888,1824,2016,1952,1632,1568,1760,1696,688,656,752,720,560,528,624,592,944,912,1008,976,816,784,880,848],P=[-32124,-31100,-30076,-29052,-28028,-27004,-25980,-24956,-23932,-22908,-21884,-20860,-19836,-18812,-17788,-16764,-15996,-15484,-14972,-14460,-13948,-13436,-12924,-12412,-11900,-11388,-10876,-10364,-9852,-9340,-8828,-8316,-7932,-7676,-7420,-7164,-6908,-6652,-6396,-6140,-5884,-5628,-5372,-5116,-4860,-4604,-4348,-4092,-3900,-3772,-3644,-3516,-3388,-3260,-3132,-3004,-2876,-2748,-2620,-2492,-2364,-2236,-2108,-1980,-1884,-1820,-1756,-1692,-1628,-1564,-1500,-1436,-1372,-1308,-1244,-1180,-1116,-1052,-988,-924,-876,-844,-812,-780,-748,-716,-684,-652,-620,-588,-556,-524,-492,-460,-428,-396,-372,-356,-340,-324,-308,-292,-276,-260,-244,-228,-212,-196,-180,-164,-148,-132,-120,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,32124,31100,30076,29052,28028,27004,25980,24956,23932,22908,21884,20860,19836,18812,17788,16764,15996,15484,14972,14460,13948,13436,12924,12412,11900,11388,10876,10364,9852,9340,8828,8316,7932,7676,7420,7164,6908,6652,6396,6140,5884,5628,5372,5116,4860,4604,4348,4092,3900,3772,3644,3516,3388,3260,3132,3004,2876,2748,2620,2492,2364,2236,2108,1980,1884,1820,1756,1692,1628,1564,1500,1436,1372,1308,1244,1180,1116,1052,988,924,876,844,812,780,748,716,684,652,620,588,556,524,492,460,428,396,372,356,340,324,308,292,276,260,244,228,212,196,180,164,148,132,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,0],H=new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]),J={decodeG711:function(e,t){if("g7110a"===t)return function(e){for(var t=new Uint8Array(2*e.length),i=0,A=0;i<e.length;){var n=Q[e[i]];if(void 0===n)throw Error("can not decode g711 alaw data!");t[A]=255&n,t[A+1]=n>>8,i+=1,A+=2}return t}(e);if("g7110m"===t)return function(e){for(var t=new Uint8Array(2*e.length),i=0,A=0;i<e.length;){var n=P[e[i]];if(void 0===n)throw Error("can not decode g711 ulaw data!");t[A]=255&n,t[A+1]=n>>8,i+=1,A+=2}return t}(e);throw Error("no supported format=".concat(t," for g711"))},createAudioBufferFromPcm:function(e,t,i,A,n){for(var r=t.byteLength/i/n,a=e.createBuffer(i,r,A),o=new DataView(t),s=0;s<i;s++)for(var u,c=a.getChannelData(s),d=void 0,g=0;g<r;g++)d=o.getUint16(2*i*g+2*s,!0),c[g]=(u=d)>=32768?-(65536-u)/32768:u/32767;return{audioBuffer:a,duration:r/A}},packageAACToAdts:function(e,t){var i,A,n,r,a,o,s,u,c=new Uint8Array(t.data.byteLength+7),d=(i=t.data,A=e.sampleRateIndex,n=e.channelCount,r=e.config,a=A,A=(o=(7&r[0])<<1|r[1]>>>7)!==a?o:a,(s=new Uint8Array(7))[0]=255,s[1]=240,s[1]=1|s[1],s[2]=64,s[2]=s[2]|60&A<<2,s[2]=s[2]|1&n>>2,s[3]=192&n<<6,u=i.byteLength+7,s[3]=s[3]|3&u>>11,s[4]=255&u>>3,s[5]=224&u<<5,s[5]=31|s[5],s[6]=252,s);return c.set(d),c.set(t.data,7),c},concatAdts:checkRefillFrame:,z={INIT_AUDIO_ERR:"create new AudioContext error"},j=function(e){(0,o.Z)(r,e);var t,i,A,n=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(r);if(t){var A=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,A)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function r(e,t){var i;return(0,a.Z)(this,r),i=n.call(this,e,t),(0,h.Z)((0,g.Z)(i),"doPause",i._doPause),i.TAG="AudioRender",i._timeRange=new K((0,g.Z)(i)),i._lastTimeLineTime=0,i._sampleQueue=[],i._source=null,i._audioCanAutoplay=!0,i._lastBuffer=null,i._inDecoding=!1,i._endOfStream=!1,i._delay=0,i._isSourceBufferEnd=-1,i._onSourceBufferEnded=i._onSourceBufferEnded.bind((0,g.Z)(i)),i._initAudioCtx(e.volume||.6),i._bindEvents(),i}return(0,d.Z)(r,[{key:"baseDts",get:function(){return this._timeRange._baseDts}},{key:"currentTime",get:,{key:"preloadTime",get:,{key:"timescale",get:function(){return 1e3}},{key:"buffered",get:function(){return this._timeRange.buffered}},{key:"ctxState",get:function(){return this._audioCtx.state}},{key:"audioCanAutoplay",get:function(){return this._audioCanAutoplay}},{key:"resume",value:,{key:"canSeek",value:function(e){return this._timeRange.canSeek(e)}},{key:"_assembleErr",value:,{key:"_emitTimelineEvents",value:function(e,t,i){var A,n;null===(A=this._parent)||void 0===A||null===(n=A.emit)||void 0===n||n.call(A,e,t,i)}},{key:"_initAudioCtx",value:function(e){var t=this;p.log(this.TAG,"init audioCtx");var i=window.AudioContext||window.webkitAudioContext;if(this._audioCtx=new i,!this._audioCtx){p.warn(this.TAG,"create webaudio error!"),setTimeout(function(){t._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ERROR,t._assembleErr(z.INIT_AUDIO_ERR))});return}return this._gainNode=this._audioCtx.createGain(),this._gainNode.gain.value=e,this._gainNode.connect(this._audioCtx.destination),this._audioCanAutoplay="running"===this._audioCtx.state,p.log(this.TAG,"webAudio state:",this._audioCtx.state),m(),this._bindAudioCtxEvent(),this._audioCtx.suspend()}},{key:"_bindAudioCtxEvent",value:function(){var e=this;this._onStateChange=function(){e._audioCtx&&"running"===e._audioCtx.state&&e._ready&&e._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.PLAYING)},this._audioCtx.addEventListener("statechange",this._onStateChange)}},{key:"_bindEvents",value:function(){var e=this;(0,l.Z)((0,u.Z)(r.prototype),"_bindEvents",this).call(this),this._parent.on(X.DECODE_EVENTS.CHASE_AUDIO_FRAME,this._doChaseFrame.bind(this)),this._parent.on(X.TIMELINE.UPDATE_VOLUME,function(t){e._gainNode&&(e._gainNode.gain.value=isFinite(t)?t:1,e._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.VOLUME_CHANGE))}),this._parent.on(X.TIMELINE.END_OF_STREAM,function(){var t;e._endOfStream=!0,e.noAudio||null!==(t=e._timeRange)&&void 0!==t&&t.hasBuffer()||null==e||e._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ENDED)})}},{key:"_appendChunk",value:function(e,t){if(!this.noAudio){this._meta||(this._meta=t,p.warn(this.TAG,"audio set metadata",this._meta));var i=t.samples;if(i.length){if(this._sampleQueue=this._sampleQueue.concat(i),t.samples=[],"aac"===this._meta.codecType){if(this._inDecoding)return;this._decodeAACWrapper()}else this._decodeG711()}}}},{key:"_resetDts",value:function(e,t){"video"!==t&&this._timeRange.resetDts(e)}},{key:"_doPlay",value:function(){if(!this.noAudio&&!this._parent.seeking){if(!this._source&&this.currentTime){this._startRender();return}this.resume()}}},{key:"_doPause",value:,{key:"_reInitAudioCtx",value:function(e){var t=this;if(this._lastTimeLineTime=e,this._lastBuffer=null,this._lastAudioBufferInfo=null,this._delay=0,!(this._ready&&this._audioCtx.currentTime))return Promise.resolve();var i=this._gainNode.gain.value;return this._audioCtx.close().then(}},{key:"_doSeek",value:,{key:"_doChaseFrame",value:function(e){var t=this,i=e.position,A=this._timeRange.deletePassed(i);A&&(p.log(this.TAG,"_doChaseFrame","startTime:",A.start,"buffeLength:",this.buffered.end(0)-A.start),this._reInitAudioCtx(A.start).then(function(){t._startRender(),t._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.TIMEUPDATE)}).catch(function(e){}))}},{key:"_decodeAACWrapper",value:(i=(0,Y.Z)(O().mark(function e(){var t,i,A,n,r,a,o,s,u;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._sampleQueue.length,i=this._sampleQueue[0],!((A=(this._sampleQueue[t-1].dts-i.dts)/this.timescale)<1)){e.next=6;break}return e.abrupt("return");case 6:for(o=0,n=parseInt(A/3-1)||1,r=parseInt(t/n),a=[];o<n;o++)o<n-1?a.push(this._sampleQueue.slice(o*r,(o+1)*r)):a.push(this._sampleQueue.slice(o*r));return this._sampleQueue=[],this._inDecoding=!0,e.prev=12,e.next=15,this._decodeCycle(a);case 15:!this._isLive&&(u=(s=this._timeRange._buffers)[s.length-1])&&this._emitTimelineEvents(X.TIMELINE.UPDATE_SEGMENT_END,u.end),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ERROR,this._assembleErr("ERROR_MSG.DECODE_ERR:".concat(e.t0&&e.t0.message)));case 21:this._inDecoding=!1;case 22:case"end":return e.stop()}},e,this,[[12,18]])})),function(){return i.apply(this,arguments)})},{key:"_decodeCycle",value:(A=(0,Y.Z)(O().mark(),function(e){return A.apply(this,arguments)})},{key:"_decodeAAC",value:function(e){var t=this,i=e[0],A=0;J.checkRefillFrame(e);var n=e.map(,r=J.concatAdts(n,0);return new Promise(function(e,n){var a=t._audioCtx.decodeAudioData(r.buffer,function(n){if(t._timeRange){if(t._lastAudioBufferInfo&&t.isLive){var r=t._lastAudioBufferInfo,a=r.dts+r.duration;(A=i.dts-a)>1&&(t._timeRange._duration+=A/1e3,p.log(t.TAG,"_decodeAAC","audio data dts is not continue, last end dts:",a,",now start Dts:",i.dts,"delay:",A))}t._lastAudioBufferInfo={duration:Math.floor(1e3*n.duration),dts:i.dts};var o=t._timeRange.append(n,n.duration,i.dts,A/1e3);if(!t._ready){var s=.5>Math.abs(o+n.duration-t.currentTime);(t.isLive||!s)&&(t._ready=!0,p.log(t.TAG,"_decodeAAC","set ready true start=",o),t.emit(X.AUDIO.AUDIO_READY,o))}t._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.PROGRESS),t._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.DURATION_CHANGE),e()}},n);a.catch&&a.catch(n)})}},{key:"_decodeG711",value:function(){var e=this._sampleQueue.length,t=this._sampleQueue[0];if(!((this._sampleQueue[e-1].dts-t.dts)/this.timescale<.5)){var i=this._sampleQueue.reduce(0),A=new Uint8Array(i),n=0,r=0;this._sampleQueue.forEach(,this._sampleQueue=[];try{var a=this._meta,o=a.codecType,s=a.channelCount,u=a.sampleSize,c=a.sampleRate,d=J.decodeG711(A,o),g=J.createAudioBufferFromPcm(this._audioCtx,d.buffer,s,c,u/8),l=g.audioBuffer,h=g.duration,I=this._timeRange.append(l,h,n,0);this._ready||(this._ready=!0,p.log(this.TAG,"_decodeG711","set ready true"),this.emit(X.AUDIO.AUDIO_READY,I)),this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.PROGRESS),this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.DURATION_CHANGE)}catch(e){this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ERROR,this._assembleErr("ERROR_MSG.DECODE_ERR:".concat(e&&e.message)))}}}},{key:"_onSourceBufferEnded",value:,{key:"_ajustSeekTime",value:,{key:"_getAudioBuffer",value:function(e){var t=this;if(this._timeRange){var i=this._timeRange.getBuffer(this._lastBuffer?this._lastBuffer.end:this.currentTime,0);if(!i){if((this._endOfStream||!this._isLive)&&this.currentTime-this.duration>-.5){this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.TIMEUPDATE),this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ENDED);return}this._ready=!1,this._audioCtx.suspend(),this.emit(X.AUDIO.AUDIO_WAITING),e&&(this._onAudioReady||(this._onAudioReady=function(e){t._ajustSeekTime(e)}),this.removeListener(X.AUDIO.AUDIO_READY,this._onAudioReady),this.once(X.AUDIO.AUDIO_READY,this._onAudioReady));return}if(e){this._ajustSeekTime(i.start),this.emit(X.AUDIO.AUDIO_READY);return}return i}}},{key:"_startRender",value:function(e){if(!this.noAudio){if("video"===e&&this.isLive&&this._ready&&!this._isSourceBufferEnd){this._doPlay();return}var t=this._getAudioBuffer();if(t){"suspended"===this._audioCtx.state&&(this._audioCtx.resume().catch(,_()),this._lastBuffer=t,this._source=null;var i=this._audioCtx.createBufferSource();i.buffer=t.source,i.loop=!1,this._source=i,i.addEventListener("ended",this._onSourceBufferEnded),i.connect(this._gainNode),t.delay&&t.delay>.001&&(this._delay+=t.delay),this.startDts=t.startDts;try{this._isSourceBufferEnd=!1,i.start()}catch(e){}t.startDts&&this._emitTimelineEvents(X.TIMELINE.SYNC_DTS,t.startDts)}}}},{key:"_destroy",value:]),r}(M);i(81107),i(31385),i(90259),i(68229),i(61151),i(42416),i(93567),i(19858);var q=i(5385),$=i(68917);r ei={"mp4a.40.5":1,"mp4a.40.2":2},eA=new(function(){function e(){(0,a.Z)(this,e),(0,h.Z)(this,"_queue",[]),"undefined"!=typeof document&&(this._tempMedia=document.createElement("video"))}return(0,d.Z)(e,[{key:"tempMedia",get:function(){return this._tempMedia}},{key:"hasCached",get:,{key:"getCachedMedia",value:,{key:"cacheMedia",value:function(e){var t=e.codec,i=e.media,A=e.mse,n=ei[t];if(this._queue=this._queue.filter(function(e){e.mse&&!e.mse.isOpened&&e.mse.unbindMedia();var t,i=null===(t=e.mse)||void 0===t?void 0:t.isOpened;return!i&&e.media&&(e.media.canuse=0),i}),i.canuse=0,!t||this._queue.filter(.length>2){null==A||A.endOfStream(),null==A||A.unbindMedia();return}i.canuse=1,this._queue.push({codec:n,media:i,mse:A})}}]),e}()),en=function(e){(0,o.Z)(c,e);var t,i,A,n,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(c);if(t){var A=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,A)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(e,t){var i,A;return(0,a.Z)(this,c),i=r.call(this,e,t),(0,h.Z)((0,g.Z)(i),"_media",void 0),(0,h.Z)((0,g.Z)(i),"_isTempMedia",!1),(0,h.Z)((0,g.Z)(i),"_mse",void 0),(0,h.Z)((0,g.Z)(i),"_remuxer",null),(0,h.Z)((0,g.Z)(i),"_codec",""),(0,h.Z)((0,g.Z)(i),"_sourceCreated",!1),(0,h.Z)((0,g.Z)(i),"_needInitSegment",!0),(0,h.Z)((0,g.Z)(i),"_seekNoSideEffect",!1),(0,h.Z)((0,g.Z)(i),"_startRendered",!1),(0,h.Z)((0,g.Z)(i),"_firstTimeAppendedBuffer",!1),(0,h.Z)((0,g.Z)(i),"_sampleQueue",[]),(0,h.Z)((0,g.Z)(i),"_inProcessing",!1),(0,h.Z)((0,g.Z)(i),"_duration",0),(0,h.Z)((0,g.Z)(i),"_mediaCache",eA),(0,h.Z)((0,g.Z)(i),"_resetDts",function(){}),(0,h.Z)((0,g.Z)(i),"_onCanplay",,(0,h.Z)((0,g.Z)(i),"_onPlaying",function(){i._parent.ready&&(i._audioCanAutoplay=!0,i._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.PLAYING))}),(0,h.Z)((0,g.Z)(i),"_onWaiting",function(){if(!i._seekNoSideEffect){try{for(var e,t=i._media.buffered,A=i._media.currentTime,n=0,r=0,a=t.length;r<a;r++)t.start(r)<A&&t.end(r)>A&&(n=t.end(r)-A);if(Math.abs(n)>.5)return;if(Math.abs(i._media.duration-i._media.currentTime)<(i.duration>60?.5:.3)){i._reuseMse||i._mse.endOfStream(),null===(e=(0,g.Z)(i))||void 0===e||e._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ENDED);return}}catch(e){}i._ready=!1,i.emit(X.AUDIO.AUDIO_WAITING)}}),(0,h.Z)((0,g.Z)(i),"_onSeeked",function(){if(i._seekNoSideEffect||i._isLive){i._seekNoSideEffect=!1;return}p.log(i.TAG,"seeked","_readyStatus:",i._ready),i._ready||(i._media.pause(),i._ready=!0,i.emit(X.AUDIO.AUDIO_READY,!0))}),(0,h.Z)((0,g.Z)(i),"_onProgress",function(){if(i._media.readyState<=1){var e=i._getBufferGap();e>0&&e<1&&(i._media.currentTime+=e+.05,p.warn(i.TAG,"progress, gap=",e))}i._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.PROGRESS),i._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.DURATION_CHANGE)}),(0,h.Z)((0,g.Z)(i),"_onEnded",function(){var e;p.log(i.TAG,"ended!"),null===(e=(0,g.Z)(i))||void 0===e||e._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ENDED)}),(0,h.Z)((0,g.Z)(i),"_onOnceProgress",function(){if(i._media.buffered.length){var e=i._media.buffered.start(0);e&&(i._media.currentTime=e+.05,p.log(i.TAG,"start gap:",e)),i._media.removeEventListener("progress",i._onOnceProgress)}}),(0,h.Z)((0,g.Z)(i),"_onError",function(){var e;i._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ERROR,i._assembleErr("audio error: ".concat(null===(e=i._media.error)||void 0===e?void 0:e.message),3))}),(0,h.Z)((0,g.Z)(i),"_appendChunk",function(e,t){if(!i.noAudio&&t.samples.length){if(!i._codec&&(2!==t.objectType&&5!==t.objectType?i._codec="mp4a.40.5":i._codec=t.codec,i._isTempMedia&&i._switchMedia(i._codec)),t.samples.forEach(,t.samples=[],!i._meta){i._meta=et(et({},t),{},{exist:function(){return!0},hasSample:function(){return!0},samples:[]}),p.warn(i.TAG,"audio set metadata",i._meta),i._doAppendWrapper();return}i._meta.sampleRate!==t.sampleRate&&(p.warn(i.TAG,"discontinue: ".concat(i._meta.sampleRate," -> ").concat(t.sampleRate)),i._needInitSegment=!0,Object.keys(t).forEach(),!i._inProcessing&&i._sampleQueue.length&&i._doAppendWrapper()}}),(0,h.Z)((0,g.Z)(i),"_doAppend",(A=(0,Y.Z)(O().mark(function e(t){var A,n,r;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i._remuxer||(i._remuxer=new q.N({samples:[],exist:function(){return!1}},t)),A=t.samples,i._sourceCreated){e.next=12;break}return i.analyse.addAudioMseOpenStart(),e.next=6,i._mse.open();case 6:i._sourceCreated=!0,p.log(i.TAG,"video/mp4;codecs=".concat(i._codec)),i._mse.createSource(t.type,"video/mp4;codecs=".concat(i._codec)),i.analyse.addAudioMseOpend(),p.log(i.TAG,"sb created!"),i._checkAutoPlay();case 12:if(n=i._remuxer.remux(i._needInitSegment),!(i._needInitSegment&&!n.audioInitSegment)){e.next=15;break}return e.abrupt("return");case 15:return i._needInitSegment=!1,r=[],n.audioInitSegment&&r.push(i._mse.append(t.type,n.audioInitSegment)),n.audioSegment&&r.push(i._mse.append(t.type,n.audioSegment)),e.abrupt("return",Promise.all(r).then(.then();case 20:case"end":return e.stop()}},e)})),function(e){return A.apply(this,arguments)})),(0,h.Z)((0,g.Z)(i),"_doPlay",,(0,h.Z)((0,g.Z)(i),"_doPause",,(0,h.Z)((0,g.Z)(i),"_doSeek",function(e){p.log(i.TAG,"doSeek, t=",e),i._ready=!1,i._media.currentTime=e}),(0,h.Z)((0,g.Z)(i),"_doChaseFrame",,(0,h.Z)((0,g.Z)(i),"_startRender",,i.TAG="AudioMseRender",i._reuseMse=b.reuseMseForAudio,i._initMedia(),i}return(0,d.Z)(c,[{key:"isMse",get:function(){return!0}},{key:"media",get:function(){return this._media}},{key:"currentTime",get:function(){return this._media.currentTime}},{key:"buffered",get:function(){return this._media.buffered}},{key:"duration",get:function(){return isNaN(this._media.duration)?1/0:this._media.duration},set:,{key:"audioCanAutoplay",get:function(){return this._audioCanAutoplay||this.noAudio}},{key:"readyState",get:,{key:"_initMedia",value:function(){if(!this._reuseMse||!eA.hasCached){p.log(this.TAG,"init media and mse directly"),this._media=document.createElement("video"),this._media.autoplay=!0,this._media.canuse=1,this._mse=new $.d1,this._bindEvents(),this._bindMediaEvents(),this._mse.bindMedia(this._media);return}p.log(this.TAG,"bind media temporary"),this._media=eA.tempMedia,this._bindEvents(),this._isTempMedia=!0}},{key:"_switchMedia",value:function(e){var t=this._media,i=eA.getCachedMedia(ei[e]);i?(p.warn(this.TAG,"switch to cached media for audio play! codec=".concat(e)),this._media=i.media,this._mse=i.mse,this._bindMediaEvents(),this._updateDuration(this._duration),this._media.currentTime=.05,this._sourceCreated=!0,this._audioCanAutoplay=!0,this.analyse.addAudioMseOpend()):this._initMedia(),this._media.volume=t.volume,this._media.playbackRate=t.playbackRate,this._isTempMedia=!1}},{key:"_getBufferGap",value:,{key:"canSeek",value:function(){return!0}},{key:"resume",value:function(){return this._media.play()}},{key:"pause",value:,{key:"seekNoSideEffect",value:,{key:"dump",value:function(){}},{key:"_emitTimelineEvents",value:,{key:"_assembleErr",value:function(e,t){var i=Error(e);return i.code=3,i.subCode=t,i}},{key:"_bindEvents",value:function(){var e=this;(0,l.Z)((0,u.Z)(c.prototype),"_bindEvents",this).call(this),this._parent.on(X.DECODE_EVENTS.CHASE_AUDIO_FRAME,this._doChaseFrame),this._parent.on(X.TIMELINE.UPDATE_VOLUME,function(t){e._media.volume=t,e._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.VOLUME_CHANGE)}),this._parent.on(X.TIMELINE.END_OF_STREAM,function(){if(!e.reuseMseForAudio){var t;null===(t=e._mse)||void 0===t||t.endOfStream()}}),this._parent.on(X.TIMELINE.SET_PLAYBACKRATE,}},{key:"_bindMediaEvents",value:,{key:"_updateDuration",value:(i=(0,Y.Z)(O().mark(function e(t){return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._mse){e.next=9;break}if(this._mse.isOpened){e.next=4;break}return e.next=4,this._mse.open();case 4:if(this._mse){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this._mse.updateDuration(t);case 8:p.log(this.TAG,"update duration",t);case 9:case"end":return e.stop()}},e,this)})),},{key:"_doAppendWrapper",value:(A=(0,Y.Z)(O().mark(function e(){var t;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._meta){e.next=2;break}return e.abrupt("return");case 2:return this._meta.samples=this._sampleQueue.slice(),this._meta.baseMediaDecodeTime=this._meta.samples[0].baseMediaDecodeTime,this._sampleQueue=[],e.prev=5,this._inProcessing=!0,e.next=9,this._doAppend(this._meta);case 9:if(t=e.sent,this.isLive&&this._emitTimelineEvents(X.TIMELINE.UPDATE_SEGMENT_END,t),this._inProcessing=!1,!this._sampleQueue.length){e.next=15;break}return e.next=15,this._doAppendWrapper();case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ERROR,this._assembleErr("audio error: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message),3));case 20:case"end":return e.stop()}},e,this,[[5,17]])})),function(){return A.apply(this,arguments)})},{key:"_checkAutoPlay",value:function(){var e=this;this._media.addEventListener("canplay",function t(){if(e._media){var i=e._media.volume;e._media.volume=Math.min(i,.1);var A=e._media.play();(A=A.then?A:Promise.reject()).then(.catch(function(){p.warn(e.TAG,"can’t auto play!"),e._audioCanAutoplay=!1,e.emit(X.AUDIO.AUDIO_NOT_ALLOWED_AUTOPLAY)}).finally(function(){e._media&&(e._media.volume=i,e._startRendered||(e._media.pause(),p.log(e.TAG,"auto paused by checkAutoPlay!")),e._media.removeEventListener("canplay",t))})}})}},{key:"_destroy",value:(n=(0,Y.Z)(O().mark(function e(){var t,i,A,n;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p.log(this.TAG,"destroy audio render"),this._remuxer=null,this.removeAllListeners(),this._media.removeEventListener("canplay",this._onCanplay),this._media.removeEventListener("playing",this._onPlaying),this._media.removeEventListener("waiting",this._onWaiting),this._media.removeEventListener("seeked",this._onSeeked),this._media.removeEventListener("progress",this._onProgress),this._media.removeEventListener("ended",this._onEnded),this._media.removeEventListener("progress",this._onOnceProgress),this._media.removeEventListener("error",this._onError),this._reuseMse){e.next=18;break}return null===(t=this._mse)||void 0===t||t.endOfStream(),e.next=15,null===(i=this._mse)||void 0===i?void 0:i.unbindMedia();case 15:this._media&&(this._media.canuse=0),e.next=21;break;case 18:null!==(A=this._media.buffered)&&void 0!==A&&A.length&&(null===(n=this._mse)||void 0===n||n.clearAllBuffer()),eA.cacheMedia({codec:this._codec,media:this._media,mse:this._mse}),p.log(this.TAG,"cache media for audio play, codec=",this._codec);case 21:this._mse=null,this._meta=null,this._media=null,this._mediaCache=null;case 25:case"end":return e.stop()}},e,this)})})}],[{key:"isSupported",value:function(){return b.audioWithMse&&!!window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="mp4a.40.5"')}}]),c}(M);i(8170),i(31640);var er=function(){function e(t){(0,a.Z)(this,e),this.TAG="VideoTimeRange",this._parent=t,this._baseDts=0,this._lastDuration=0,this._duration=0,this._bitrate=0,this._totalSize=0,this._buffers=[],this._currentFrameQueue=[],this._frameIndexInQueue=0,this._delayEstimateList=[],this._keyframeQueue=[]}return(0,d.Z)(e,[{key:"isLive",get:function(){return this._parent.isLive}},{key:"baseDts",get:function(){return this._baseDts}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"buffered",ge}},{key:"bufferStart",ge}},{key:"frameLength",get:function(){return this._currentFrameQueue.length}},{key:"keyFrameLength",get:function(){return this._keyframeQueue.length}},{key:"totalSize",get:function(){return this._totalSize}},{key:"bitrate",get:function(){return this._bitrate},set:function(e){this._bitrate=e}},{key:"lastDuration",get:function(){return this._lastDuration}},{key:"frames",get:function(){return this._currentFrameQueue}},{key:"getCurrentTime",valu}},{key:"resetDts",value:function(e){this._baseDts=e}},{key:"_mergeBufferRanges",value:function(){var e=this._buffers.slice().sort(function(e,t){return e.start>t.start?1:-1}),t=e.length,i=[];if(!t)return i;for(var A={start:e[0].start,end:e[0].end},n=1;n<t;n++){var r=e[n];.1>Math.abs(A.end-r.start)?A.end=r.end:r.end>A.end&&(i.push(A),A={start:r.start,end:r.end})}return i.push(A),i}},{key:"_caclBaseDts",valu}},{key:"_updateDuration",valu}},{key:"_estimateBitRate",valu}},{key:"_beforeAppendVodBuffer",valu}},{key:"_appendVodBuffer",valu}},{key:"_afterAppendVodBuffer",value:function(){var e;if(this._buffers.filte}).length){for(var t=this._buffers,i=this._buffers.length,A=[],n=this._buffers[0],r=1;r<i;r++)null!==(e=t[r].frames[0])&&void 0!==e&&e.keyframe?(A.push(n),n=t[r]):(n.frames=n.frames.concat(t[r].frames),n.end=t[r].end,n.duartion=n.end-n.start);A.push(n),this._buffers=A}}},{key:"_recordKeyframes",valu}},{key:"toAnnexBNalu",value:function(e){e.forEach(function(e){var t=e.units;if(t){var i=t.reduc},0),A=new Uint8Array(i),n=0;t.forEach(function(e){A.set([0,0,0,1],n),n+=4,A.set(e,n),n+=e.byteLength}),t=null,e.units=null,e.data=A}})}},{key:"append",value:function(e,t,i){if(i&&this.toAnnexBNalu(e),this._caclBaseDts(e[0]),t&&this._updateDuration(e),this._estimateBitRate(e),this._recordKeyframes(e),this.isLive){this._currentFrameQueue=this._currentFrameQueue.concat(e);return}this._beforeAppendVodBuffer(e)}},{key:"updateSegmentEnd",value:function(e){var t=this._buffers[this._buffers.length-1];t&&(.5>Math.abs(t.end-e)||(t.end=e,t.duartion=e-t.start,p.log(this.TAG,"video data lack, reset end:",e)))}},{key:"getFrame",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.isLive)return this._currentFrameQueue.shift();if(!(e=this._currentFrameQueue[this._frameIndexInQueue])){if(!(e=this._currentFrameQueue[--this._frameIndexInQueue])||!this.switchBuffer((e.dts-this._baseDts)/1e3,this._frameIndexInQueue++,t))return;return this.getFrame(++t)}return this._frameIndexInQueue++,e}},{key:"getFramesForPreciseSeek",valu}},{key:"updateFrameIndexForPreciseSeek",value:function(e){this._frameIndexInQueue=e}},{key:"switchBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!(i>=20)){e=e||this.bufferStart;var A=this._buffers.filte})[0];if(!A){var n=this._buffers.find(function(t){return t.start>=e});return n&&n.start-e<1?(this._currentFrameQueue=n.frames.slice(0),this._frameIndexInQueue=0,n):void 0}if(A.frames[0].dts/1e3>=e)return this._currentFrameQueue=A.frames.slice(0),this._frameIndexInQueue=0,p.log(this.TAG,"switch video buffer, time:".concat(e," , buffer:[").concat(A.start," , ").concat(A.end,"], index=0")),A;if(A.frames.length>t)return this._currentFrameQueue=A.frames.slice(0),p.log(this.TAG,"switch video buffer, in the same gop and more frame got, time:".concat(e," , buffer:[").concat(A.start," , ").concat(A.end,"], index=").concat(t)),A;p.log(this.TAG,"switch video buffer, in the same gop and no more frame got, time:".concat(e," , buffer:[").concat(A.start," , ").concat(A.end,"], index=").concat(t))}}},{key:"getSeekStartPosition",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(this._keyframeQueue.forEac}),t&&(p.warn(this.TAG,"getSeekStartPosition: ".concat(e,", position:").concat(t.position)),e-t.position<i))return t}},{key:"getSeekStartPositionBehind",value:function(e,t){for(var i=0,A=this._keyframeQueue.length;i<A;i++){var n=this._keyframeQueue[i];if(n.position>=e)return p.warn(this.TAG,"getSeekStartPositionBehind: ".concat(e,", position:").concat(n.position)),n}return this.getSeekStartPosition(e,t)}},{key:"nextFrame",valu}},{key:"deletePassed",valu}},{key:"getDtsOfTime",valu}},{key:"clean",valu}},{key:"destroy",value:function(){this._currentFrameQueue=[],this._buffers=[]}}]),e}(}var eo=function(){function e(t){(0,a.Z)(this,e),this.TAG="FrameQueue",this._parent=t,this._lastGopId=0,this._frames=[]}return(0,d.Z)(e,[{key:"currentTimeDts",get:function(){return this._parent.preciseVideoDts}},{key:"length",get:function(){return this._frames.length}},{key:"frames",get:function(){return this._frames}},{key:"append",value:function(e){if(!e.info){ea(e);return}this._frames.push(e)}},{key:"appendVodFrame",valu}},{key:"nextFrame",valu}},{key:"shift",valu}},{key:"deletePassed",value:function(e){this._frames=this._frames.filter(function(t){return!!t.info&&t.info.dts>e||(ea(t),!1)})}},{key:"empty",valu}},{key:"destroy",valu}}]),e}(),es=function(){function e(t){(0,a.Z)(this,e),this.TAG="DecodeEstimate",this._lowDecodeThreshold=b.lowDecodeThreshold/5,this._lowDecodeFpsDelta=b.lowDecodeFpsDelta,this._needEstimate=!0,this._parent=t,this._lastDecodeDot=0,this._lastDecodeCost=0,this._lastFrameDts=0,this._dtsDeltas=[],this._decodeCosts=[],this._lowDecodeQueue=[],this._fps=0,this._decodeFps=0,this._gopLength=0,this._webcodec=!1}return(0,d.Z)(e,[{key:"fps",get:function(){return this._fps}},{key:"decodeFps",get:function(){return this._decodeFps}},{key:"decodeCost",get:function(){return this._lastDecodeCost}},{key:"gopLength",get:function(){return this._gopLength}},{key:"webcodec",set:function(e){this._webcodec=e}},{key:"updateGopCount",valu}},{key:"needEstimateFps",valu}},{key:"addDecodeInfo",valu}},{key:"resetDecodeDot",valu}},{key:"reset",valu}},{key:"_estimateFps",value:function(e){if(this._needEstimate){if(!this._lastFrameDts){this._lastFrameDts=e.dts;return}var t=e.dts-this._lastFrameDts;if(this._lastFrameDts=e.dts,!(Math.abs(t)>200)){this._dtsDeltas.push(t);var i=this._dtsDeltas.length;i<5||(this._fps=Math.ceil(1e3/this._avg(this._dtsDeltas,i)),p.log(this.TAG,"estimate fps:",this._fps),this._needEstimate=!1)}}}},{key:"_estimateDecodeFps",value:function(e){if(!this._lastDecodeDot){this._lastDecodeDot=performance.now();return}var t=performance.now(),i=t-this._lastDecodeDot;this._lastDecodeDot=t,e.cost=i,this._lastDecodeCost=i,this._decodeCosts.push(i);var A=this._decodeCosts.length;if(!(A<5)){var n=this._avg(this._decodeCosts,A);this._decodeFps=Math.floor(1e3/n),this._decodeCosts=[],this._lowDecodeDetect()}}},{key:"_avg",value:function(e,t){return Math.floor(e.reduc},0)/t)||1}},{key:"_lowDecodeDetect",value:function(){if(!this._decodeFps){this._parent.emit(X.VIDEO.DECODE_LOW_FPS,0);return}this._decodeFps<this._fps*this._parent.playbackRate+(this.webcodec?0:this._lowDecodeFpsDelta)?this._lowDecodeQueue.push(this._decodeFps):this._lowDecodeQueue.pop(),this._lowDecodeQueue.length>this._lowDecodeThreshold&&(this._lowDecodeQueue=[],p.log(this.TAG,"解码效率过低,应该降级"),this._parent.emit(X.VIDEO.DECODE_LOW_FPS,this._decodeFps))}}(){this._parent=null}}]),e}();i(68685);var eu=[],ec=function(){function e(t,i,A){var n=this;(0,a.Z)(this,e),(0,h.Z)(this,"TAG","RenderWorker"),(0,h.Z)(this,"timerWorkerCache",eu),(0,h.Z)(this,"_errorOccur",!1),(0,h.Z)(this,"_doTask",function(e){var t,i;if("NEXT_TICK"===e.data.type){null===(t=n._task)||void 0===t||t.call(n);return}if("RENDER_ERR"===e.data.type){n._emitError(e.data.msg);return}"RESIZE_EVENT"===e.data.type&&(null===(i=n._parent)||void 0===i||i.emitResizeEvent())}),(0emitError(e.message)}),(0,h.Z)(this,"_emitError",function(e){n._errorOccur=!0,n._worker&&(n._worker._cvs=null,n._worker._offscreen=null),n._cvs&&(n._cvs._worker=null),n._parent._emitError(e,3)}),this._task=t,this._parent=A;var r=this._initCanvasWorkerPair(i),o=(0,c.Z)(r,2),s=o[0],u=o[1];u&&(this._worker=u,this._cvs=s,this._bindEvent())}return(0,d.Z)(e,[{key:"canvas",get:function(){return this._cvs}},{key:"_initCanvasWorkerPair",value:function(e){var t,i=this,A=e.canvas||(null===(t=eu.pop())||void 0===t?void 0:t._cvs)||document.createElement("canvas");if(A.style.margin="auto",A.style.position="absolute",A.style.pointerEvents="none",A._worker)return p.log(this.TAG,"init canvas && worker, use cached,",A.width,A.height),[A,A._worker];try{var n=new Blob(["\n  class FrameRender {\n    constructor (configs) {\n      this.TAG = 'FrameRender'\n      this.configs = Object.assign({}, configs)\n      this.canvas = this.configs.canvas\n      this.meta = Object.assign({}, this.configs.meta)\n      this._initMeta()\n      this._initContextGL()\n      if (this.contextGL) {\n        this._initProgram()\n        this._initBuffers()\n        this._initTextures()\n      }\n    }\n\n    _initMeta () {\n      this.chroma = this.meta.chromaFormat\n      this.height = this.meta.height\n      this.width = this.meta.width\n      if (this.canvas.width !== this.meta.width || this.canvas.height !== this.meta.height) {\n        this.canvas.width = this.meta.width\n        this.canvas.height = this.meta.height\n        self.postMessage({\n          type: 'RESIZE_EVENT'\n        })\n      }\n      this.clear()\n    }\n\n    _initContextGL () {\n      if (this.configs.type === '2d') {\n        this.ctx = this.canvas.getContext('2d')\n        return\n      }\n      var canvas = this.canvas\n      let gl = null\n\n      var validContextNames = ['webgl', 'experimental-webgl', 'moz-webgl', 'webkit-3d']\n      let nameIndex = 0\n\n      while (!gl && nameIndex < validContextNames.length) {\n        var contextName = validContextNames[nameIndex]\n\n        try {\n          gl = canvas.getContext(contextName, this.configs.glCtxOptions)\n          break\n        } catch (e) {\n          gl = null\n        }\n\n        if (!gl || typeof gl.getParameter !== 'function') {\n          gl = null\n        }\n\n        ++nameIndex\n      }\n\n      this.contextGL = gl\n    }\n\n    _initProgram () {\n      var gl = this.contextGL\n\n      // vertex shader is the same for all types\n      var vertexShaderScript\n      var fragmentShaderScript\n      vertexShaderScript = [\n        'attribute vec4 vertexPos;',\n        'attribute vec4 texturePos;',\n        'attribute vec4 uTexturePos;',\n        'attribute vec4 vTexturePos;',\n        'varying vec2 textureCoord;',\n        'varying vec2 uTextureCoord;',\n        'varying vec2 vTextureCoord;',\n\n        'void main()',\n        '{',\n        '  gl_Position = vertexPos;',\n        '  textureCoord = texturePos.xy;',\n        '  uTextureCoord = uTexturePos.xy;',\n        '  vTextureCoord = vTexturePos.xy;',\n        '}'\n      ].join('')\n\n      fragmentShaderScript = [\n        'precision highp float;',\n        'varying highp vec2 textureCoord;',\n        'varying highp vec2 uTextureCoord;',\n        'varying highp vec2 vTextureCoord;',\n        'uniform sampler2D ySampler;',\n        'uniform sampler2D uSampler;',\n        'uniform sampler2D vSampler;',\n        'uniform mat4 YUV2RGB;',\n\n        'void main(void) {',\n        '  highp float y = texture2D(ySampler,  textureCoord).r;',\n        '  highp float u = texture2D(uSampler,  uTextureCoord).r;',\n        '  highp float v = texture2D(vSampler,  vTextureCoord).r;',\n        '  gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;',\n        '}'\n      ].join('')\n\n      var YUV2RGB = [1.16438, 0.0, 1.59603, -0.87079, 1.16438, -0.39176, -0.81297, 0.52959, 1.16438, 2.01723, 0.0, -1.08139, 0, 0, 0, 1]\n      var vertexShader = gl.createShader(gl.VERTEX_SHADER)\n      gl.shaderSource(vertexShader, vertexShaderScript)\n      gl.compileShader(vertexShader)\n      if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) {\n        console.log('Vertex shader failed to compile: ' + gl.getShaderInfoLog(vertexShader))\n      }\n\n      var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER)\n      gl.shaderSource(fragmentShader, fragmentShaderScript)\n      gl.compileShader(fragmentShader)\n      if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n        console.log('Fragment shader failed to compile: ' + gl.getShaderInfoLog(fragmentShader))\n      }\n\n      var program = gl.createProgram()\n      gl.attachShader(program, vertexShader)\n      gl.attachShader(program, fragmentShader)\n      gl.linkProgram(program)\n      if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        console.log('Program failed to compile: ' + gl.getProgramInfoLog(program))\n      }\n\n      gl.useProgram(program)\n\n      var YUV2RGBRef = gl.getUniformLocation(program, 'YUV2RGB')\n      gl.uniformMatrix4fv(YUV2RGBRef, false, YUV2RGB)\n\n      this.shaderProgram = program\n    }\n\n    _initBuffers () {\n      var gl = this.contextGL\n      const program = this.shaderProgram\n\n      var vertexPosBuffer = gl.createBuffer()\n      gl.bindBuffer(gl.ARRAY_BUFFER, vertexPosBuffer)\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 1, -1, 1, 1, -1, -1, -1]), gl.STATIC_DRAW)\n\n      var vertexPosRef = gl.getAttribLocation(program, 'vertexPos')\n      gl.enableVertexAttribArray(vertexPosRef)\n      gl.vertexAttribPointer(vertexPosRef, 2, gl.FLOAT, false, 0, 0)\n\n      var texturePosBuffer = gl.createBuffer()\n      gl.bindBuffer(gl.ARRAY_BUFFER, texturePosBuffer)\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 0, 0, 0, 1, 1, 0, 1]), gl.STATIC_DRAW)\n\n      var texturePosRef = gl.getAttribLocation(program, 'texturePos')\n      gl.enableVertexAttribArray(texturePosRef)\n      gl.vertexAttribPointer(texturePosRef, 2, gl.FLOAT, false, 0, 0)\n\n      this.texturePosBuffer = texturePosBuffer\n\n      var uTexturePosBuffer = gl.createBuffer()\n      gl.bindBuffer(gl.ARRAY_BUFFER, uTexturePosBuffer)\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 0, 0, 0, 1, 1, 0, 1]), gl.STATIC_DRAW)\n\n      var uTexturePosRef = gl.getAttribLocation(program, 'uTexturePos')\n      gl.enableVertexAttribArray(uTexturePosRef)\n      gl.vertexAttribPointer(uTexturePosRef, 2, gl.FLOAT, false, 0, 0)\n\n      this.uTexturePosBuffer = uTexturePosBuffer\n\n      var vTexturePosBuffer = gl.createBuffer()\n      gl.bindBuffer(gl.ARRAY_BUFFER, vTexturePosBuffer)\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 0, 0, 0, 1, 1, 0, 1]), gl.STATIC_DRAW)\n\n      var vTexturePosRef = gl.getAttribLocation(program, 'vTexturePos')\n      gl.enableVertexAttribArray(vTexturePosRef)\n      gl.vertexAttribPointer(vTexturePosRef, 2, gl.FLOAT, false, 0, 0)\n\n      this.vTexturePosBuffer = vTexturePosBuffer\n    }\n\n    _initTextures () {\n      var gl = this.contextGL\n      var program = this.shaderProgram\n      var yTextureRef = this._initTexture()\n      var ySamplerRef = gl.getUniformLocation(program, 'ySampler')\n      gl.uniform1i(ySamplerRef, 0)\n      this.yTextureRef = yTextureRef\n\n      var uTextureRef = this._initTexture()\n      var uSamplerRef = gl.getUniformLocation(program, 'uSampler')\n      gl.uniform1i(uSamplerRef, 1)\n      this.uTextureRef = uTextureRef\n\n      var vTextureRef = this._initTexture()\n      var vSamplerRef = gl.getUniformLocation(program, 'vSampler')\n      gl.uniform1i(vSamplerRef, 2)\n      this.vTextureRef = vTextureRef\n\n      // fix WebGL: INVALID_OPERATION: texImage2D: ArrayBufferView not big enough for request\n      //  texture bound to texture unit 1 is not renderable. It might be non-power-of-2 or have incompatible texture filtering (maybe)\n      gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1)\n    }\n\n    _initTexture () {\n      var gl = this.contextGL\n\n      var textureRef = gl.createTexture()\n      gl.bindTexture(gl.TEXTURE_2D, textureRef)\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST)\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST)\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n      gl.bindTexture(gl.TEXTURE_2D, null)\n\n      return textureRef\n    }\n\n    _drawPictureGL (data, width, height, yLinesize, uvLinesize) {\n      var ylen = yLinesize * height\n      let uvlen = (uvLinesize * height) / 2\n      if (this.chroma === 444 || this.chroma === 422) {\n        uvlen *= 2\n      }\n      data = new Uint8Array(data)\n      var renderData = {\n        yData: data.subarray(0, ylen),\n        uData: data.subarray(ylen, ylen + uvlen),\n        vData: data.subarray(ylen + uvlen, ylen + uvlen + uvlen)\n      }\n      this._drawPictureGL420(renderData, width, height, yLinesize, uvLinesize)\n    }\n\n    _drawPictureGL420 (data, width, height, yLinesize, uvLinesize) {\n      var gl = this.contextGL\n      var texturePosBuffer = this.texturePosBuffer\n      var uTexturePosBuffer = this.uTexturePosBuffer\n      var vTexturePosBuffer = this.vTexturePosBuffer\n\n      var yTextureRef = this.yTextureRef\n      var uTextureRef = this.uTextureRef\n      var vTextureRef = this.vTextureRef\n\n      var yData = data.yData\n      var uData = data.uData\n      var vData = data.vData\n\n      var yDataPerRow = yLinesize\n      var yRowCnt = height\n\n      var uDataPerRow = uvLinesize\n      let uRowCnt = height / 2\n\n      if (this.chroma === 422 || this.chroma === 444) {\n        uRowCnt = height\n      }\n\n      var vDataPerRow = uvLinesize\n      var vRowCnt = uRowCnt\n\n      var ratiow = this.canvas.width / this.width\n      var ratioh = this.canvas.height / this.height\n      let left = 0\n      let top = 0\n      let w = this.canvas.width\n      let h = this.canvas.height\n      if (ratiow < ratioh) {\n        h = (this.height * this.canvas.width) / this.width\n        top = parseInt((this.canvas.height - (this.height * this.canvas.width) / this.width) / 2)\n      } else {\n        w = (this.width * this.canvas.height) / this.height\n        left = parseInt((this.canvas.width - (this.width * this.canvas.height) / this.height) / 2)\n      }\n      gl.viewport(left, top, w, h)\n\n      const texturePosValues = new Float32Array([1, 0, 0, 0, 1, 1, 0, 1])\n      gl.bindBuffer(gl.ARRAY_BUFFER, texturePosBuffer)\n      gl.bufferData(gl.ARRAY_BUFFER, texturePosValues, gl.DYNAMIC_DRAW)\n\n      const uTexturePosValues = new Float32Array([1, 0, 0, 0, 1, 1, 0, 1])\n      gl.bindBuffer(gl.ARRAY_BUFFER, uTexturePosBuffer)\n      gl.bufferData(gl.ARRAY_BUFFER, uTexturePosValues, gl.DYNAMIC_DRAW)\n\n      const vTexturePosValues = new Float32Array([1, 0, 0, 0, 1, 1, 0, 1])\n      gl.bindBuffer(gl.ARRAY_BUFFER, vTexturePosBuffer)\n      gl.bufferData(gl.ARRAY_BUFFER, vTexturePosValues, gl.DYNAMIC_DRAW)\n\n      gl.activeTexture(gl.TEXTURE0)\n      gl.bindTexture(gl.TEXTURE_2D, yTextureRef)\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, yDataPerRow, yRowCnt, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, yData)\n\n      gl.activeTexture(gl.TEXTURE1)\n      gl.bindTexture(gl.TEXTURE_2D, uTextureRef)\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, uDataPerRow, uRowCnt, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, uData)\n\n      gl.activeTexture(gl.TEXTURE2)\n      gl.bindTexture(gl.TEXTURE_2D, vTextureRef)\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, vDataPerRow, vRowCnt, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, vData)\n\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4)\n    }\n\n    _drawPicture2d (data) {\n      if (!data) {\n        return\n      }\n      if (this.canvas) {\n        if (!this.ctx) {\n          this.ctx = this.canvas.getContext('2d')\n        }\n        var width = data.displayWidth || data.width\n        var height = data.displayHeight || data.height\n        if (this.canvas.height !== height || this.canvas.width !== width) {\n          this.canvas.height = height\n          this.canvas.width = width\n        }\n        try {\n          this.ctx.drawImage(data.dom || data, 0, 0, width, height)\n        } catch (error) {\n          // console.error(this.TAG, '_drawPicture2d', data, data.dom, error, error.message)\n        }\n      }\n    }\n\n    _resize (width, height) {\n      if (this.canvas.width !== width || this.canvas.height !== height) {\n        this.width = width\n        this.height = height\n        this.canvas.width = width\n        this.canvas.height = height\n        self.postMessage({\n          type: 'RESIZE_EVENT'\n        })\n      }\n    }\n\n    render (data, width, height, yLinesize, uvLinesize) {\n      this._resize(width, height)\n      var gl = this.contextGL\n      if (gl) {\n        this._drawPictureGL(data, width, height, yLinesize, uvLinesize)\n      } else {\n        this._drawPicture2d(data)\n      }\n    }\n\n    updateMeta (meta) {\n      this.meta = Object.assign({}, meta)\n      this._initMeta()\n    }\n\n    clear () {\n      if (this.contextGL) {\n        this.contextGL.clear(this.contextGL.DEPTH_BUFFER_BIT | this.contextGL.COLOR_BUFFER_BIT)\n      }\n    }\n  }\n\n  var timer\n  var frameRender\n\n  function initTimer (interval) {\n    stopTimer()\n    clearInterval(timer)\n    timer = setInterval(function () {\n      self.postMessage({ type: 'NEXT_TICK' })\n    }, interval)\n  }\n\n  function stopTimer () {\n    clearInterval(timer)\n  }\n\n  function initWebgl (canvas, meta, type) {\n    try {\n      frameRender = new FrameRender({\n        canvas,\n        meta,\n        type\n      })\n    } catch (e) {\n      self.postMessage({\n        type: 'RENDER_ERR',\n        msg: e && e.message\n      })\n    }\n  }\n\n  self.onmessage = function (e) {\n    var { type, interval } = e.data\n    switch (type) {\n      case 'START':\n        initTimer(interval)\n        break\n      case 'DESTROY':\n        stopTimer()\n        break\n      case 'OFFSCREEN_CANVAS':\n        if (!frameRender) {\n          initWebgl(e.data.canvas, e.data.meta, e.data.ctxType)\n        }\n        break\n      case 'UPDATE_META':\n        frameRender && frameRender.updateMeta(e.data.meta)\n        break\n      case 'RENDER':\n        try {\n          frameRender && frameRender.render(e.data.data, e.data.width, e.data.height, e.data.yLinesize, e.data.uvLinesize)\n        } catch (e) {\n          self.postMessage({\n            type: 'RENDER_ERR',\n            msg: e && e.message\n          })\n        }\n        break\n      case 'CLEAR':\n        frameRender && frameRender.clear()\n        break\n      default:\n    }\n  }\n"],{type:"application/javascript"}),r=new Worker(URL.createObjectURL(n));if(b.offscreenCanvas){var a=A.transferControlToOffscreen();r._offscreen=a,r._cvs=A,A._worker=r}return p.log(this.TAG,"init canvas && worker, new created"),[A,remitError(e.message)})}return[]}},{krror",this._onError)}},{key:"startLoop",value:function(e){var t;(e=parseInt(e))<10?e=10:e>60?e=60:e-=8,null===(t=this._worker)||void 0===t||t.postMessage({type:"START",interval:e})}},{key:"stopLoop",value:function(){this._worker.postMessage({type:"DESTROY"})}},{key:"initRenderContext",value:function(e){var t,i,A,n=e.meta,r=e.type;if(null!==(t=this._worker)&&void 0!==t&&t._offscreen&&(this._worker._offscreen.width=n.width,this._worker._offscreen.height=n.height),null!==(i=this._worker)&&void 0!==i&&null!==(A=i._offscreen)&&void 0!==A&&A.cloned){this._worker.postMessage({type:"UPDATE_META",meta:n});return}this._worker.postMessage({type:"OFFSCREEN_CANVAS",canvas:this._worker._offscreen,meta:n,ctxType:r},[this._worker._offscreen]),this._worker._offscreen.cloned=1}},{key:"render",value:function(e,t,i,A,n){this._worker.postMessage({type:"RENDER",data:e,width:t,height:i,yLinesize:A,uvLinesize:n},[e])}},{key:"destroy",value:function(e){this._worker&&(this._worker.postMessage({type:"DESTROY"}),this._worker.removeEventListener("message",this._doTask),this._worker.removeEventListener("error",this._onError),e&&!this._errorOccur&&(eu.push(this._worker),this._worker.postMessage({type:"CLEAR"}),p.log(this.TAG,"cache render worker")),this._worker=null,this._task=null)}}]),e}(),ed=function(e){(0,o.Z)(A,e);var t,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(A);if(t){var n=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function A(e,t){var n;return(0,a.Z)(this,A),(n=i.call(this,e,t))._timeRange=new er((0,g.Z)(n)),n._decodeEstimate=new es((0,g.Z)(n)),n._frameQueue=new eo((0,g.Z)(n)),n._lastTimeupdate=0,n._renderCost=0,n._canAutoPlay=!0,n._videoDecode=!1,n._inSeeking=!1,n._frameRender=null,n._configuration=null,n._canvasLayoutDone=!1,n._render=n._render.bind((0,g.Z)(n)),n._renderWorker=new ec(n._render,e,(0,g.Z)(n)),n._canvas=n._renderWorker.canvas,n._bindEvents(),n}return(0,d.Z)(A,[{key:"canAutoPlay",get:function(){return this._canAutoPlay}},{key:"canvas",get:function(){return this._canvas}},{key:"timescale",get:function(){returnhis._meta.fpsDen||24}},{key:"decodeFps",get:function(){return this._decodeEstimate.decodeFps}},{key:"decodeCost",get:function(){return this._decodeEstimate.decodeCost}},{key:"renderCost",get:function(){return this._renderCost}},{key:"totalSize",get:function(){return this._timeRange.totalSize}},{key:"bitrate",get:function(){return this._t_timeRange.bitrate=e}},{key:"gopLength",get:function(){return this._decodeEstimate.gopLengts._canvas.height<720}},{key:"buffered",get:function(){return this._timeRange.buffered}},{key:"inSeeking",get:function(){return this._inSeeking}s/this.playbackRate)}},{key:"playbackRate",get:function(){return this._playbackRate||1}},{key:"baseDts",get:function(){return this._timeRange.baseDts}},{his.preciseVideoDts)}},{key:"timelinePosition",get:function(){return this._parent.timelinePosition}},{key:"lasttTimelinePosition||0},set:function(e){this._lastTimelinePosition=e}},{kdioDts||this.baseDts},set:function(e){this._audioDts=e}},{key:"preciseVideoDts",get:function(){return this.audioSyncDts+Math.floor((this.timelinePosition-this.lastTimelinePosition)*1e3)}},?4:e>=4?3:e>=2?2:1:is._meta||{}).codec)}},{key:"videoDecode",get:function(){return this._videoDecode}},{key:"decoderMode",get:function(){var e;return null===(e=this._decodeController)||void 0===e?void 0:e.decoderMode}},{ke,thiE(e.sps[0],e.pps[0])}},{key:"see){this._inSeeking=e}},{keyange.getDtsOfTime(e)}},{ke(){this._whenReady()}},{ken(){this._render(!0)}},{key:"getSeekStartPosition",value:function(e,t){return this._timeRange.getSeekStartPosition(e,t)}},{key:"getSeekStarttPositionBehind(e,t)}},{key:"canSeek",value:function(){throw Error("need override by children")}},{key:"emitResizeEvent",value:function(){this===null||void 0===this||this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.RESIZE)}},{key:"_assembleErr",value:function(e,t){var i=Error(e);return i.code=3,i.subCode=t,i}},{key:"_emitError",value:function(e,t){this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ERROR,this._assembleErr(e,t))}},{key:"_emit0===A||A.emit(e,t,i)}},{key:"_bindEvents",value:function(){var e=this;(0,l.Z)((0,u.Z)(A.prototype),"_bindEvents",t,", pY=").concat(h))};this._parent.on(X.VIDEO.UPDATE_VIDEO_FILLTYPE,function(i,A){var n=A.width,r=A.height,a=e._canvas,o=a.width,s=a.height,u=!n||n/r>o/s;if(p.warn(e.TAG,"UPDATE_VIDEO_FILLTYPE isGapX =",u,"type =",i,o,s,n,r),e._canvas.style.maxWidth="initial",e._canvas.style.maxHeight="initial","cover"===i){if(u){e._canvas.style.left=0,e._canvas.style.top=0,e._canvas.style.height="auto",e._canvas.style.width="100%",t({width:n,height:r},0,.5);return}e._canvas.style.left=0,e._canvas.style.top=0,e._canvas.style.width="auto",e._canvas.style.height="100%",t({width:n,height:r},.5,0);return}if("fill"===i){e._canvas.style.width="100%",e._canvas.style.height="100%";return}e._canvas.style.top=0,e._canvas.style.bottom=0,e._canvas.style.left=0,e._canvas.style.right=0,e._canvas.style.maxWidth="100%",e._canvas.style.maxHeight="100%",e._canvas.style.width="initial",e._canvas.style.height="initial",o<n&&s<r&&(o/n>s/r?e._canvas.style.width="100%":e._canvas.style.height="100%")}),this._parent.on(X.VIDEO.UPDATE_VIDEO_COVER_POSITION,t),this._parent.on(X.TIMELINE.SYNC_DTS,function(t){var i,A=e._frameQueue.nextFrame(),n=A&&A.info&&A.info.dts;if(e.lastTimelinePosition=e.timelinePosition,e.noAudio){var r=e._timeRange.nextFrame();t=t||n||r&&r.dts||0}if(e.audioSyncDts=t,n&&n-t>500&&e._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.LARGE_AV_GAP,{aDts:t,vDts:n,frameLength:e._frameQueue.length,currentTime:e._parent.currentTime,duration:e._parent.duration}),p.log(e.TAG,"audio current buffer play finish, next buffer dts=",t,"currentTime:",e._parent.currentTime,"preciseVideoDts:",e.preciseVideoDts,"next video frame dts:",n,"frame length:",e._frameQueue.length),!e._isLive&&!(null!==(i=e._parent)&&void 0!==i&&i.seeking)){var a=e._timeRange.nextFrame();if(a){var o=(a.dts-a.baseDts)/1e3;e._parent.currentTime-o>1&&(p.warn(e.TAG,"丢帧!"),e.ajustSeekTime(e._parent.currentTime))}}}),this._parent.on(X.Te._config.glCtxOptions=t}),this._parent.on(X.TIMELINE.UPDATE_SEGMENT_END,this._updateSegmentEnd.bind(this)),this.on(X.VIDEO.AUTO_RUN,this._startRender.bind(this)),this._parent.on(X.kRate=t,e._startRender()})}},{key:"ajustSeekTime",value:function(){throw Error("need override by children")s._timeRange.resetDts(e)}},e"),this._initDecoder()}}},{key:"_initDecoder",value:function(){throw Error("need override by children")}},{key:"_whenDecoderReady",value:function(){throw Error("need override by children")}},{key:"_appendChunk",value:function(){throw Error("need override by children")}},{key:"_startDecode",value:function(){throw Error("need override by children")}},{key:"_receiveFrame",value:function(e,t){if(this._parent&&this._timeRange){var i=e.info||{};if(this._decodeEstimate.addDecodeInfo(i),this._checkCanvasLayout(e),!this._isLive&&((i.output||i.keyframe)&&(this.setSeekingStatus(!1),p.warn(this.TAG,"set seeking status=",!1)),this.inSeeking)){p.log(this.TAG,"drop frame"),ea(e);return}this._isLive?this._frameQueue.append(e):this._frameQueue.appendVodFrame(e),t&&t(),!this._ready&&this.readyState>=1&&this._whenReady()}}},{key:"_checkCanvasLayout",value:function(e){this._canvasLayoutDone||e.width!==this._canvas.width||(e.width/e.height).toFixed(2)!==(this._canvas.width/this._canvas.height).toFixed(2)||(this===null||void 0===this||this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.CANVAS_LAYOUT),this._canvasLayoutDone=!0)}},startLoop(this.interval)}},{key:"_render",value:function(){throw Error("need override by children")}},{key:"_updateSegmentEnd",value:function(){throw Error("need override by children")}},{key:"_whenReady",value:function(){this._ready=!0,this.emit(X.VIDEO.VIDEO_READY),this.noAudio&&this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.PLAYING)}},{key:"_doPlay",value:function(){this._renderWorker.startLoop(_renderWorker.stopLoopis._frameQueue.destroy()}},{key:"_doChaseFrame",value:function(){throw Error("need override by children")}},{key:"destroy",value:function(e){var t,i,A,n,r,a;null===(t=this._renderWorker)||void 0===t||t.destroy(e),null===(i=this._timeRange)||void 0===i||i.destroy(),null===(A=this._frameQueue)||void 0===A||A.destroy(),null===(n=this._frameRender)||void 0===n||null===(r=n.destroy)||void 0===r||r.call(n),null===(a=this._decodeEstimate)||void 0===a||a.destroy(),this._renderWorker=null,this._canvas=null,this._timeRange=null,this._frameQueue=null,this._frameRender=null,this._decodeEstimate=null,this._parent=null,this.removeAllListeners()}}]),A}(M),eg=function(e){(0,o.Z)(A,e);var t,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(A);if(t){var n=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function A(e){var t;return(0,a.Z)(this,A),t=i.call(this),(0,h.Z)((0,g.Z)(t),"_parent",null),(0,h.Z)((0,g.Z)(t),"_decoderReady",!1),(0,h.Z)((0,g.Z)(t),"_inDecoding",!1),(0,h.Z)((0,g.Z)(t),"_toDecodeFirstframe",!0),(0,h.Z)((0,g.Z)(t),"_id",new Date().getMilliseconds()),(0,h.Z)((0,g.Z)(t),"_workerErrorCallback",null),(0,h.Z)((0,g.Z)(t),"_workerMessageCallback",null),(0,h.Z)((0,g.Z)(t),"_decoderWorker",null),t._parent=e,t}return(0,d.Z)(A,[{key:"analyse",get:function(){return this._parent.analyse}},{key:"inDecoding",get:function(){return this._inDecoding}},{key:"decoderMode",get:function(){return this._decoderMode}},{key:"decoderReady",get:function(){return this._decoderReady}_continueDecodeThreshold}},{key:"maxDecodeOnce",get:function(){return this._maxDecodeOnce}},{key:"meta",get:function(){var e;return null===(e=this._parent)||void &&(this._parent._meack=t,this._initWorker()}},{key:"_initWorker",value:function(){throw Error("need override by children")}},{key:"checkToDecode",value:function(e){if(this.webcodec){e<=this.needToDecode&&this.doDecode();return}!this._inDecoding&&e<=this.needToDecode&&this.doDecode(ge({msg:"finish_flag"}))}},{key:"preciseSeek",value:function(e){var t,i,A,n,r=this,a=null===(t=this._parent)||void 0===t?void 0:null===(i=t._timeRange)||void 0===i?void 0:i.getFramesForPreciseSeek(1e3*e),o=a.length;if(o<this.maxDecodeOnce){this.doDecode();return}null===(A=this._parent)||void 0===A||null===(n=A._timeRange)||void 0===n||n.updateFrameIndexForPreciseSeek(o),p.enable&&p.log(this.TAG,"doDecode ".concat(a.length," frames for odeInternal(e,!0,t>=o-6)}),this._inDecoding=!0,this._decoderWorker.postMessage({msg:"finish_flag"})}},{key:"_getFramesToDecode",value:function(){var e=this._parent,t=e._timeRange,i=e._decodeEstimate;if(this._decoderReady&&t){var A=t.frameLength;if(A){var n=this._toDecodeFirstframe?b.maxDecodeOnceFirstTime:this.maxDecodeOnce;1===A&&i.resetDecodeDot(performance.now());for(var r=[];n>0;){var a=t&&t.getFrame();if(!a)break;r.push(a),a.gopId&&a.gopId-1==0&&i.updateGopCount(),n--}return r}}}},{key:ta:n,info:A},[n.buffer])}},{key:"_initDecoderWithConfiguration",value:function(){throw Error("need override by children")}},{key:"flushDecoder",value:function(){this._decoderWorker.postMessage({msg:"flush"d override by children")}}]),A}(W());function el(e,t,i){var A;return function(n){var r,a,o,s,u;return A=A||rray(A.buffer))}return i}(e,void 0!==i&&i)).indexOf("\n",10)+1,s=a.substring(o)+(r?"//# sourceMappingURL="+r:""),u=new Blob([s],{type:"application/javascript"}),URL.createObjectURL(u)),new Worker(A,n)}}var eh=el("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgdmFyIGRlY29kZXIgPSBudWxsOwoKICB2YXIgZnJhbWVRdWV1ZSA9IFtdOwoKICB2YXIgcmVjZWl2ZUZyYW1lVGltZXIgPSAwOwoKICB2YXIgaGFzUmVjZWl2ZUZyYW1lID0gZmFsc2U7CgogIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CiAgICBzd2l0Y2ggKGUuZGF0YS5tc2cpIHsKICAgICAgY2FzZSAnY29uZmlndXJhdGlvbic6CiAgICAgICAgZGVjb2RlciA9IG5ldyBzZWxmLlZpZGVvRGVjb2Rlcih7CiAgICAgICAgICBvdXRwdXQ6IGZ1bmN0aW9uIChmcmFtZSkgewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZGVjb2RlZCEnLCBkZWNvZGVyLmRlY29kZVF1ZXVlU2l6ZSwgZnJhbWVRdWV1ZS5sZW5ndGgpCgogICAgICAgICAgICBoYXNSZWNlaXZlRnJhbWUgPSB0cnVlOwoKICAgICAgICAgICAgaWYgKHJlY2VpdmVGcmFtZVRpbWVyKSB7CiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHJlY2VpdmVGcmFtZVRpbWVyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZiA9IGZyYW1lUXVldWUuc2hpZnQoKTsKICAgICAgICAgICAgaWYgKCFmKSB7CiAgICAgICAgICAgICAgZnJhbWUuY2xvc2UoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICdERUNPREVEJywKICAgICAgICAgICAgICAgIHdpZHRoOiBmcmFtZS5kaXNwbGF5V2lkdGgsCiAgICAgICAgICAgICAgICBoZWlnaHQ6IGZyYW1lLmRpc3BsYXlIZWlnaHQsCiAgICAgICAgICAgICAgICBpbmZvOiBmLAogICAgICAgICAgICAgICAgYnVmZmVyOiBmcmFtZQogICAgICAgICAgICAgIH0sIFtmcmFtZV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGVjb2Rlci5kZWNvZGVRdWV1ZVNpemUgPT09IGZyYW1lUXVldWUubGVuZ3RoKSB7CiAgICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAnQkFUQ0hfRklOSVNIX0ZMQUcnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ1tXZWJjb2RlY1dvcmtlcl06JywgZSk7CiAgICAgICAgICAgIGlmIChlLm1lc3NhZ2UgPT09ICdDb2RlYyByZWNsYWltZWQgZHVlIHRvIGluYWN0aXZpdHkuJykgcmV0dXJuCiAgICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6ICdGQUlMRUQnLAogICAgICAgICAgICAgIG1lc3NhZ2U6IGUgJiYgZS5tZXNzYWdlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHNlbGYuVmlkZW9EZWNvZGVyLmlzQ29uZmlnU3VwcG9ydGVkKGUuZGF0YS5kYXRhKQogICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN0YXR1cykgewogICAgICAgICAgICBpZiAoc3RhdHVzLnN1cHBvcnRlZCkgewogICAgICAgICAgICAgIGRlY29kZXIuY29uZmlndXJlKGUuZGF0YS5kYXRhKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1dlYmNvZGVjV29ya2VyXTonLCAnaXNDb25maWdTdXBwb3J0ZWQnLCBzdGF0dXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgdHlwZTogJ0RFQ09ERVJfUkVBRFknIH0pOwoKICAgICAgICAgICAgLy8g5o6i5rWL6ZW/5pe26Ze05peg6Kej56CB5bin6L6T5Ye6LOmZjee6p+WIsHdhc20KICAgICAgICAgICAgcmVjZWl2ZUZyYW1lVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBpZiAoaGFzUmVjZWl2ZUZyYW1lKSByZXR1cm4KICAgICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgdHlwZTogJ0ZBSUxFRCcsIG1lc3NhZ2U6ICdubyBmcmFtZSBvdXRwdXQnIH0pOwogICAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgdHlwZTogJ0ZBSUxFRCcsCiAgICAgICAgICAgICAgbWVzc2FnZTogZSAmJiBlLm1lc3NhZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICBicmVhawogICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgIHZhciBkID0gZS5kYXRhLmRhdGE7CgogICAgICAgIHZhciBzYW1wbGVJbmZvID0gZS5kYXRhLmluZm87CgogICAgICAgIGZyYW1lUXVldWUucHVzaChzYW1wbGVJbmZvKTsKCiAgICAgICAgdmFyIGZyYW1lU2l6ZSA9IGQuYnl0ZUxlbmd0aCAtIDQ7CgogICAgICAgIHZhciBkdiA9IG5ldyBEYXRhVmlldyhuZXcgQXJyYXlCdWZmZXIoNCkpOwoKICAgICAgICBkdi5zZXRVaW50MzIoMCwgZnJhbWVTaXplLCBmYWxzZSk7CgogICAgICAgIGQuc2V0KG5ldyBVaW50OEFycmF5KGR2LmJ1ZmZlciksIDApOwoKICAgICAgICBpZiAoc2FtcGxlSW5mby5rZXlmcmFtZSkgewogICAgICAgICAgZGVjb2Rlci5mbHVzaCgpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGNodW5rID0gbmV3IHNlbGYuRW5jb2RlZFZpZGVvQ2h1bmsoewogICAgICAgICAgdHlwZTogc2FtcGxlSW5mby5rZXlmcmFtZSA/ICdrZXknIDogJ2RlbHRhJywKICAgICAgICAgIHRpbWVzdGFtcDogc2FtcGxlSW5mby5wdHMsCiAgICAgICAgICBkYXRhOiBkCiAgICAgICAgfSk7CiAgICAgICAgZGVjb2Rlci5kZWNvZGUoY2h1bmspOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ2Rlc3Ryb3knOgogICAgICAgIGlmIChkZWNvZGVyKSB7CiAgICAgICAgICBkZWNvZGVyLmZsdXNoKCk7CiAgICAgICAgICBkZWNvZGVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIGNsZWFyVGltZW91dChyZWNlaXZlRnJhbWVUaW1lcik7CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSAnY2hlY2tEZWNvZGUnOgogICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ0NIRUNLX1RPX0RFQ09ERScsCiAgICAgICAgICBkYXRhOiBNYXRoLmFicyhkZWNvZGVyLmRlY29kZVF1ZXVlU2l6ZSAtIGZyYW1lUXVldWUubGVuZ3RoKSA9PT0gMAogICAgICAgIH0pOwogICAgICAgIGJyZWFrCiAgICB9CiAgfSk7Cgp9KCkpOwoK",null,!1),eI=b.maxDecodeOnceWebcodec,eC=function(e){(0,o.Z)(A,e);var t,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(A);if(t){var n=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function A(){var e;(0,a.Z)(this,A);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=i.call.apply(i,[this].concat(n)),(0,h.Z)((0,g.Z)(e),"TAG","WebCodecController"),(0,h.Z)((0,g.Z)(e),"_decoderMode",5),(0,h.Z)((0,g.Z)(e),"_maxDecodeOnce",eI),(0,h.Z)((0,g.Z)(e),"_continueDecodeThreshold",eI/2),(0,h.Z)((0,g.Z)(e),"_avccpushed",!1),e}return(0,d.Z)(A,[{key:"webcodec",get:function(){return!0}_continueDecodeThreshold}},{key:"_initWorker",value:function(){var e=this;p.log(this.TAG,"start init webcodec worker");var t=new eh;t.onMessage=function(t){var i,A;switch(t.data.type){case"DECODER_READY":p.log(e.TAG,"webcodec worker ready "),e._decoderReady=!0,e._workerMessageCallback({type:"DECODER_READY"});break;case"DECODED":if(e._inDecoding=!0,(null===(i=t.data)||void 0===i?void 0:null===(A=i.info)||void 0===A?void 0:A.id)!==e._id)return;e._workerMessageCallback({type:"RECEIVE_FRAME",data:t.data});break;case"BATCH_FINISH_FLAG":if(e._inDecoding=!1,!e._workerMessageCallback)return;e._workerMessageCallback({type:"BATCH_FINISH"});break;case"CHECK_TO_DECODE":e._inDecoding=t.data.data;break;case"FAILED":e._whenError(t.data.message)}},t.onError=function(t){var i,A,n=null===(i=e._parent)||void 0===i?void 0:null===(A=i._parent)||void 0===A?void 0:A._parent;n&&n.removeChild(n.querySelector("canvas")),e._whenError(t.message)},t.addEventListener("message",t.onMessage),t.addEventListener("error",t.onError),this._decoderWorker=t,this._initDecoderWithConfiguration(t,this._parent.configuration)}._workerErrorCallback(e)}},{key:"_initDecodet}}),this._avccpushed=!0}},{kage({msg:"checkDecode"this._decoderWorker=null}}],[{key:"isSupported",value:function(){return b.h264WithWebcodec&&!!window.VideoDecoder&&!1!==A.canUse}}]),A}(eg),ef=el("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tZXZhbCAqLwogIC8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovCiAgLy8g55uu5YmN5LuF5pSv5oyBeXV2NDIwCgogIGZ1bmN0aW9uIHNoaW1JbXBvcnRTY3JpcHRzIChzcmMpIHsKICAgIHJldHVybiBmZXRjaChzcmMpCiAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICByZXR1cm4gcmVzLnRleHQoKQogICAgICB9KQogICAgICAudGhlbihmdW5jdGlvbiAodGV4dCkgewogICAgICAgIGV2YWwodGV4dCk7CiAgICAgICAgc2VsZi5Nb2R1bGUgPSBNb2R1bGU7CiAgICAgICAgc2VsZi5hZGRPblBvc3RSdW4gPSBhZGRPblBvc3RSdW47CiAgICAgIH0pCiAgfQoKICB2YXIgTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RIID0gMTAyNCAqIDEwMjQgKiAzOwogIHZhciBpbml0VHMgPSAwOwoKICB2YXIgRGVjb2RlciA9IGZ1bmN0aW9uIChzZWxmKSB7CiAgICB0aGlzLmluaXRlZCA9IGZhbHNlOwogICAgdGhpcy5pbmZvSWQgPSAwOwogICAgdGhpcy5zZWxmID0gc2VsZjsKICAgIHRoaXMubWV0YSA9IHRoaXMuc2VsZi5tZXRhOwogICAgdGhpcy50cyA9IDA7CiAgICB0aGlzLmluZm9saXN0ID0gW107CiAgICBzZWxmLnBhcl9icm9hZHdheU9uQnJvYWR3YXlJbml0ZWQgPSB0aGlzLmJyb2Fkd2F5T25Ccm9hZHdheUluaXRlZC5iaW5kKHRoaXMpOwogICAgc2VsZi5wYXJfYnJvYWR3YXlPblBpY3R1cmVEZWNvZGVkID0gdGhpcy5icm9hZHdheU9uUGljdHVyZURlY29kZWQuYmluZCh0aGlzKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS50b1U4QXJyYXkgPSBmdW5jdGlvbiAocHRyLCBsZW5ndGgpIHsKICAgIHJldHVybiBNb2R1bGUuSEVBUFU4LnN1YmFycmF5KHB0ciwgcHRyICsgbGVuZ3RoKQogIH07CgogIERlY29kZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICBNb2R1bGUuX2Jyb2Fkd2F5SW5pdCgwLCAxKTsKICAgIHRoaXMub2Zmc2V0ID0gTW9kdWxlLl9icm9hZHdheUNyZWF0ZVN0cmVhbShNQVhfU1RSRUFNX0JVRkZFUl9MRU5HVEgpOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLmJyb2Fkd2F5T25QaWN0dXJlRGVjb2RlZCA9IGZ1bmN0aW9uICgKICAgIG9mZnNldCwKICAgIHdpZHRoLAogICAgaGVpZ2h0LAogICAgaW5mb2lkLAogICAgc2xpY2VUeXBlCiAgKSB7CiAgICB2YXIgaW5mbyA9IHRoaXMuaW5mb2xpc3Quc2hpZnQoKTsKICAgIHZhciB5Um93Y291bnQgPSBoZWlnaHQ7CiAgICB2YXIgdXZSb3djb3VudCA9IGhlaWdodCAvIDI7CiAgICB2YXIgeUxpbmVzaXplID0gd2lkdGg7CiAgICB2YXIgdXZMaW5lc2l6ZSA9IHdpZHRoIC8gMjsKICAgIGlmICh0aGlzLm1ldGEgJiYgKHRoaXMubWV0YS5jaHJvbWFGb3JtYXQgPT09IDQ0NCB8fCB0aGlzLm1ldGEuY2hyb21hRm9ybWF0ID09PSA0MjIpKSB7CiAgICAgIHV2Um93Y291bnQgPSBoZWlnaHQ7CiAgICB9CiAgICBpZiAoaW5mbyAmJiBpbmZvLnByZWNpc2VTZWVrKSB7CiAgICAgIGlmICghaW5mby5vdXRwdXQpIHJldHVybgogICAgfQoKICAgIHZhciBkYXRhID0gdGhpcy50b1U4QXJyYXkob2Zmc2V0LCB5TGluZXNpemUgKiB5Um93Y291bnQgKyAyICogKHV2TGluZXNpemUgKiB1dlJvd2NvdW50KSk7CiAgICAvLyB0aGlzLmluZm9saXN0W2luZm9pZF0gPSBudWxsOwogICAgdmFyIGRhdGV0ZW1wID0gbmV3IFVpbnQ4QXJyYXkoZGF0YS5sZW5ndGgpOwogICAgZGF0ZXRlbXAuc2V0KGRhdGEpOwogICAgdmFyIGJ1ZmZlciA9IGRhdGV0ZW1wLmJ1ZmZlcjsKCiAgICB0aGlzLnNlbGYucG9zdE1lc3NhZ2UoCiAgICAgIHsKICAgICAgICBtc2c6ICdERUNPREVEJywKICAgICAgICB3aWR0aCwKICAgICAgICBoZWlnaHQsCiAgICAgICAgeUxpbmVzaXplLAogICAgICAgIHV2TGluZXNpemUsCiAgICAgICAgaW5mbywKICAgICAgICBidWZmZXIKICAgICAgfSwKICAgICAgW2J1ZmZlcl0KICAgICk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuYnJvYWR3YXlPbkJyb2Fkd2F5SW5pdGVkID0gZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMuaW5pdGVkKSB7CiAgICAgIHJldHVybgogICAgfQogICAgdGhpcy5pbml0ZWQgPSB0cnVlOwogICAgdmFyIGNvc3QgPSAwOwogICAgaWYgKGluaXRUcykgewogICAgICBjb3N0ID0gcGVyZm9ybWFuY2Uubm93KCkgLSBpbml0VHM7CiAgICB9CiAgICB0aGlzLnNlbGYucG9zdE1lc3NhZ2UoeyBtc2c6ICdERUNPREVSX1JFQURZJywgY29zdCB9KTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAoZGF0YSwgaW5mbykgewogICAgbGV0IHRpbWUgPSBwYXJzZUludChuZXcgRGF0ZSgpLmdldFRpbWUoKSk7CiAgICBsZXQgaW5mb2lkID0gdGltZSAtIE1hdGguZmxvb3IodGltZSAvIDEwZTgpICogMTBlODsKICAgIHRoaXMuaW5mb2xpc3QucHVzaChpbmZvKTsKICAgIGlmIChpbmZvICYmIGluZm8ua2V5ZnJhbWUpIHsKICAgICAgdGhpcy5pbmZvbGlzdCA9IFtpbmZvXTsKICAgICAgTW9kdWxlLl9icm9hZHdheUZsdXNoU3RyZWFtKGluZm9pZCk7CiAgICB9CiAgICBNb2R1bGUuSEVBUFU4LnNldChkYXRhLCB0aGlzLm9mZnNldCk7CiAgICBNb2R1bGUuX2Jyb2Fkd2F5UGxheVN0cmVhbShkYXRhLmxlbmd0aCwgdGhpcy5pbmZvSWQpOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKCkgewogICAgTW9kdWxlLl9icm9hZHdheUZsdXNoU3RyZWFtKCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHsKICAgIE1vZHVsZS5fYnJvYWR3YXlFeGl0KCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUudXBkYXRlTWV0YSA9IGZ1bmN0aW9uIChtZXRhKSB7CiAgICB0aGlzLm1ldGEgPSBtZXRhOwogIH07CgogIHZhciBkZWNvZGVyOwoKICBmdW5jdGlvbiBvblBvc3RSdW4gKCkgewogICAgZGVjb2RlciA9IG5ldyBEZWNvZGVyKHRoaXMpOwogICAgZGVjb2Rlci5pbml0KCk7CiAgfQoKICB2YXIgV0FTTV9DRE5fUEFUSF9QUkVGSVggPSAnJzsKCiAgZnVuY3Rpb24gaW5pdCAodXJsKSB7CiAgICBXQVNNX0NETl9QQVRIX1BSRUZJWCA9IHVybC5zcGxpdCgnLycpLnNsaWNlKDAsIC0xKS5qb2luKCcvJyk7CiAgICBpbml0VHMgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgIHZhciBpc0RlZ3JhZGUgPSAvYXNtLy50ZXN0KHVybCk7CiAgICBpZiAoIWRlY29kZXIpIHsKICAgICAgdmFyIHRhc2s7CgogICAgICBpZiAoIXNlbGYuaW1wb3J0U2NyaXB0cykgewogICAgICAgIHRhc2sgPSBzaGltSW1wb3J0U2NyaXB0cyh1cmwpOwogICAgICB9IGVsc2UgewogICAgICAgIHRhc2sgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICBpZiAoIXNlbGYuY29uc29sZSkgewogICAgICAgICAgICBzZWxmLmNvbnNvbGUgPSB7CiAgICAgICAgICAgICAgbG9nOiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICAgICAgICB3YXJuOiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICAgICAgICBpbmZvOiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkge30KICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNlbGYuaW1wb3J0U2NyaXB0cyh1cmwpOwogICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGFzawogICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChpc0RlZ3JhZGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ2F1dG8gaW5zdGFuY2UgRGVjb2RlciEnKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIG9uUG9zdFJ1bi5jYWxsKHNlbGYpOwogICAgICAgICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSkKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoc2VsZi5tKSB7CiAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgICAgICAgLm0oewogICAgICAgICAgICAgICAgaW5zdGFudGlhdGVXYXNtOiBmdW5jdGlvbiAoaW5mbywgcmVjZWl2ZUluc3RhbmNlKSB7CiAgICAgICAgICAgICAgICAgIGZldGNoKGAke1dBU01fQ0ROX1BBVEhfUFJFRklYfS9kZWNvZGVyLndhc20uanNgKQogICAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiByZXMuYXJyYXlCdWZmZXIoKSkKICAgICAgICAgICAgICAgICAgICAudGhlbihidWZmZXIgPT4gewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKGJ1ZmZlciwgaW5mbykKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWNlaXZlSW5zdGFuY2UocmVzdWx0Lmluc3RhbmNlKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKE1vZCkgewogICAgICAgICAgICAgICAgc2VsZi5Nb2R1bGUgPSBNb2Q7CiAgICAgICAgICAgICAgICBvblBvc3RSdW4uY2FsbChzZWxmKTsKICAgICAgICAgICAgICB9KQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgIGFkZE9uUG9zdFJ1bihvblBvc3RSdW4uYmluZChzZWxmKSk7CgogICAgICAgICAgICBNb2R1bGUub25SdW50aW1lSW5pdGlhbGl6ZWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgTW9kdWxlLm9uQWJvcnQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHJlamVjdChlICYmIGUubWVzc2FnZSA/IGUgOiBuZXcgRXJyb3IoJ3dhc20gaW5pdCBlcnJvcicpKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ3dhc20gbG9hZCB0aW1lb3V0JykpOwogICAgICAgICAgICB9LCA2MDAwKTsKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBtc2c6ICdJTklUX0ZBSUxFRCcsCiAgICAgICAgICAgIGxvZzogZS5tZXNzYWdlCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0KICB9CgogIHNlbGYub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKICAgIHZhciBkYXRhID0gZS5kYXRhOwogICAgaWYgKCFkYXRhLm1zZykgewogICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICBtc2c6ICdFUlJPUjppbnZhbGlkIG1lc3NhZ2UnCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGRhdGEubXNnICE9PSAnaW5pdCcgJiYgZGF0YS5tc2cgIT09ICdwcmVsb2FkJyAmJiAhZGVjb2RlcikgcmV0dXJuCiAgICAgIHN3aXRjaCAoZGF0YS5tc2cpIHsKICAgICAgICBjYXNlICdwcmVsb2FkJzoKICAgICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdpbml0JzoKICAgICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICd1cGRhdGVtZXRhJzoKICAgICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICAgIGRlY29kZXIudXBkYXRlTWV0YShkYXRhLm1ldGEpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdpbml0RGVjb2Rlcic6CiAgICAgICAgICBkZWNvZGVyLmRlY29kZShkYXRhLmRhdGEpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgICAgZGVjb2Rlci5kZWNvZGUoZGF0YS5kYXRhLCBkYXRhLmluZm8pOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdmbHVzaCc6CiAgICAgICAgICBkZWNvZGVyLmZsdXNoKCk7CiAgICAgICAgICBicmVhawogICAgICAgIGNhc2UgJ2ZpbmlzaF9mbGFnJzoKICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBtc2c6ICdCQVRDSF9GSU5JU0hfRkxBRycKICAgICAgICAgIH0pOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdkZXN0b3J5JzoKICAgICAgICAgIGRlY29kZXIuZGVzdHJveSgpOwogICAgICAgICAgYnJlYWsKICAgICAgfQogICAgfQogIH07Cgp9KCkpOwoK",null,!1),em=el("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tZXZhbCAqLwogIC8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovCiAgLy8g55uu5YmN5LuF5pSv5oyBeXV2NDIwCgogIGZ1bmN0aW9uIHNoaW1JbXBvcnRTY3JpcHRzIChzcmMpIHsKICAgIHJldHVybiBmZXRjaChzcmMpCiAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICByZXR1cm4gcmVzLnRleHQoKQogICAgICB9KQogICAgICAudGhlbihmdW5jdGlvbiAodGV4dCkgewogICAgICAgIGV2YWwodGV4dCk7CiAgICAgICAgc2VsZi5Nb2R1bGUgPSBNb2R1bGU7CiAgICAgICAgc2VsZi5hZGRPblBvc3RSdW4gPSBhZGRPblBvc3RSdW47CiAgICAgIH0pCiAgfQoKICB2YXIgTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RIID0gMTAyNCAqIDEwMjQgKiA1OyAvLyDliIbphY0gNU0g56m66Ze05a2Y5YKo5bin5pWw5o2uCiAgdmFyIEJBVENIX0RFQ09ERV9TSVpFID0gODsgLy8g5LiA5qyh5aSE55CG55qE5bin5pWw6YePCiAgdmFyIGluaXRUcyA9IDA7CgogIHZhciBEZWNvZGVyID0gZnVuY3Rpb24gKHNlbGYpIHsKICAgIHRoaXMuaW5pdGVkID0gZmFsc2U7CiAgICB0aGlzLmluZm9JZCA9IDA7CiAgICB0aGlzLnNlbGYgPSBzZWxmOwogICAgdGhpcy5tZXRhID0gc2VsZi5tZXRhOwogICAgdGhpcy50cyA9IDA7CiAgICB0aGlzLmluZm9saXN0ID0gW107CiAgICBzZWxmLnBhcl9icm9hZHdheU9uQnJvYWR3YXlJbml0ZWQgPSB0aGlzLmJyb2Fkd2F5T25Ccm9hZHdheUluaXRlZC5iaW5kKHRoaXMpOwogICAgc2VsZi5wYXJfYnJvYWR3YXlPblBpY3R1cmVEZWNvZGVkID0gdGhpcy5icm9hZHdheU9uUGljdHVyZURlY29kZWQuYmluZCh0aGlzKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS50b1U4QXJyYXkgPSBmdW5jdGlvbiAocHRyLCBsZW5ndGgpIHsKICAgIHJldHVybiBNb2R1bGUuSEVBUFU4LnN1YmFycmF5KHB0ciwgcHRyICsgbGVuZ3RoKQogIH07CgogIERlY29kZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICBNb2R1bGUuX2Jyb2Fkd2F5SW5pdCgwLCAyKTsKCiAgICAvLyDlrZjlgqjluKfmlbDmja7nmoRidWZmZXLlvIDlp4vkvY3nva4KICAgIHRoaXMuc3RyZWFtQnVmZmVyUHRyID0gTW9kdWxlLl9icm9hZHdheUNyZWF0ZVN0cmVhbShNQVhfU1RSRUFNX0JVRkZFUl9MRU5HVEgpOwogICAgdGhpcy5zdHJlYW1CdWZmZXIgPSB0aGlzLnRvVThBcnJheSh0aGlzLnN0cmVhbUJ1ZmZlclB0ciwgTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RIKTsKICAgIC8vIOeUqOadpeWtmOWCqOavj+W4p3NpemXnmoTmlbDmja7nmoTlvIDlp4vkvY3nva4KICAgIHRoaXMuYnVmZmVyU2l6ZXNQdHIgPSBNb2R1bGUuX21hbGxvYyg0ICogQkFUQ0hfREVDT0RFX1NJWkUpOwogICAgdGhpcy5idWZmZXJTaXplcyA9IHRoaXMudG9VOEFycmF5KHRoaXMuYnVmZmVyU2l6ZXNQdHIsIDQgKiBCQVRDSF9ERUNPREVfU0laRSk7CiAgICB0aGlzLnN0cmVhbUJ1ZmZlck9mZnNldCA9IDA7CiAgICB0aGlzLmZyYW1lTGVuc09mZnNldCA9IDA7CiAgICB0aGlzLmZyYW1lTGVuc0J1ZmZlciA9IG5ldyBVaW50MzJBcnJheShCQVRDSF9ERUNPREVfU0laRSk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuYnJvYWR3YXlPblBpY3R1cmVEZWNvZGVkID0gZnVuY3Rpb24gKG9mZnNldCwgd2lkdGgsIGhlaWdodCkgewogICAgdmFyIGluZm8gPSB0aGlzLmluZm9saXN0LnNoaWZ0KCk7CiAgICB2YXIgeVJvd2NvdW50ID0gaGVpZ2h0OwogICAgdmFyIHV2Um93Y291bnQgPSBoZWlnaHQgLyAyOwogICAgdmFyIHlMaW5lc2l6ZSA9IHdpZHRoOwogICAgdmFyIHV2TGluZXNpemUgPSB3aWR0aCAvIDI7CiAgICBpZiAodGhpcy5tZXRhICYmICh0aGlzLm1ldGEuY2hyb21hRm9ybWF0ID09PSA0NDQgfHwgdGhpcy5tZXRhLmNocm9tYUZvcm1hdCA9PT0gNDIyKSkgewogICAgICB1dlJvd2NvdW50ID0gaGVpZ2h0OwogICAgfQogICAgdmFyIGRhdGEgPSB0aGlzLnRvVThBcnJheShvZmZzZXQsIHlMaW5lc2l6ZSAqIHlSb3djb3VudCArIDIgKiAodXZMaW5lc2l6ZSAqIHV2Um93Y291bnQpKTsKICAgIC8vIHRoaXMuaW5mb2xpc3RbaW5mb2lkXSA9IG51bGw7CiAgICB2YXIgZGF0ZXRlbXAgPSBuZXcgVWludDhBcnJheShkYXRhLmxlbmd0aCk7CiAgICBkYXRldGVtcC5zZXQoZGF0YSk7CiAgICB2YXIgYnVmZmVyID0gZGF0ZXRlbXAuYnVmZmVyOwoKICAgIHRoaXMuc2VsZi5wb3N0TWVzc2FnZSgKICAgICAgewogICAgICAgIG1zZzogJ0RFQ09ERUQnLAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICB5TGluZXNpemUsCiAgICAgICAgdXZMaW5lc2l6ZSwKICAgICAgICBpbmZvLAogICAgICAgIGJ1ZmZlcgogICAgICB9LAogICAgICBbYnVmZmVyXQogICAgKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5icm9hZHdheU9uQnJvYWR3YXlJbml0ZWQgPSBmdW5jdGlvbiAoKSB7CiAgICBpZiAodGhpcy5pbml0ZWQpIHsKICAgICAgcmV0dXJuCiAgICB9CiAgICB0aGlzLmluaXRlZCA9IHRydWU7CiAgICB2YXIgY29zdCA9IDA7CiAgICBpZiAoaW5pdFRzKSB7CiAgICAgIGNvc3QgPSBwZXJmb3JtYW5jZS5ub3coKSAtIGluaXRUczsKICAgIH0KICAgIHRoaXMuc2VsZi5wb3N0TWVzc2FnZSh7IG1zZzogJ0RFQ09ERVJfUkVBRFknLCBjb3N0IH0pOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLnN0b3JlQnVmZmVyID0gZnVuY3Rpb24gKGRhdGEsIGZJbmZvKSB7CiAgICBpZiAoZkluZm8gJiYgZkluZm8ua2V5ZnJhbWUpIHsKICAgICAgdGhpcy5mbHVzaCgpOwogICAgfQogICAgdGhpcy5pbmZvbGlzdC5wdXNoKGZJbmZvKTsKICAgIHRoaXMuc3RyZWFtQnVmZmVyLnNldChkYXRhLCB0aGlzLnN0cmVhbUJ1ZmZlck9mZnNldCk7CiAgICB0aGlzLmZyYW1lTGVuc0J1ZmZlclt0aGlzLmZyYW1lTGVuc09mZnNldF0gPSBkYXRhLmxlbmd0aDsKICAgIHRoaXMuc3RyZWFtQnVmZmVyT2Zmc2V0ICs9IGRhdGEubGVuZ3RoOwogICAgdGhpcy5mcmFtZUxlbnNPZmZzZXQgKz0gMTsKICAgIHRoaXMuYmF0Y2hEZWNvZGUoKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5iYXRjaERlY29kZSA9IGZ1bmN0aW9uIChmbHVzaCkgewogICAgLy8g5pSSMTDluKflpITnkIbkuIDmrKEg5oiW6ICFIOW8uuWItuino+eggQogICAgdmFyIHRvZG8gPSB0aGlzLmZyYW1lTGVuc09mZnNldCA+PSBCQVRDSF9ERUNPREVfU0laRSB8fCAoZmx1c2ggJiYgdGhpcy5mcmFtZUxlbnNPZmZzZXQpOwogICAgaWYgKHRvZG8pIHsKICAgICAgdGhpcy5idWZmZXJTaXplcy5zZXQobmV3IFVpbnQ4QXJyYXkodGhpcy5mcmFtZUxlbnNCdWZmZXIuYnVmZmVyKSwgMCk7CiAgICAgIE1vZHVsZS5fYnJvYWR3YXlQbGF5U3RyZWFtMSh0aGlzLmJ1ZmZlclNpemVzUHRyLCB0aGlzLmZyYW1lTGVuc09mZnNldCk7CiAgICAgIHRoaXMuZnJhbWVMZW5zT2Zmc2V0ID0gMDsKICAgICAgdGhpcy5zdHJlYW1CdWZmZXJPZmZzZXQgPSAwOwogICAgfQogIH07CgogIERlY29kZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChkYXRhKSB7CiAgICB0aGlzLnN0cmVhbUJ1ZmZlci5zZXQoZGF0YSk7CiAgICBNb2R1bGUuX2Jyb2Fkd2F5UGxheVN0cmVhbShkYXRhLmxlbmd0aCwgMCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmJhdGNoRGVjb2RlKHRydWUpOwogICAgTW9kdWxlLl9icm9hZHdheUZsdXNoU3RyZWFtKCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHsKICAgIE1vZHVsZS5fYnJvYWR3YXlFeGl0KCk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUudXBkYXRlTWV0YSA9IGZ1bmN0aW9uIChtZXRhKSB7CiAgICB0aGlzLm1ldGEgPSBtZXRhOwogIH07CgogIHZhciBkZWNvZGVyOwoKICBmdW5jdGlvbiBvblBvc3RSdW4gKCkgewogICAgZGVjb2RlciA9IG5ldyBEZWNvZGVyKHRoaXMpOwogICAgZGVjb2Rlci5pbml0KCk7CiAgfQoKICB2YXIgV0FTTV9DRE5fUEFUSF9QUkVGSVggPSAnJzsKCiAgZnVuY3Rpb24gaW5pdCAodXJsKSB7CiAgICBXQVNNX0NETl9QQVRIX1BSRUZJWCA9IHVybC5zcGxpdCgnLycpLnNsaWNlKDAsIC0xKS5qb2luKCcvJyk7CiAgICBpbml0VHMgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgIGlmICghZGVjb2RlcikgewogICAgICB2YXIgdGFzazsKCiAgICAgIGlmICghc2VsZi5pbXBvcnRTY3JpcHRzKSB7CiAgICAgICAgdGFzayA9IHNoaW1JbXBvcnRTY3JpcHRzKHVybCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFzayA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgIGlmICghc2VsZi5jb25zb2xlKSB7CiAgICAgICAgICAgIHNlbGYuY29uc29sZSA9IHsKICAgICAgICAgICAgICBsb2c6IGZ1bmN0aW9uICgpIHt9LAogICAgICAgICAgICAgIHdhcm46IGZ1bmN0aW9uICgpIHt9LAogICAgICAgICAgICAgIGluZm86IGZ1bmN0aW9uICgpIHt9LAogICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7fQogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2VsZi5pbXBvcnRTY3JpcHRzKHVybCk7CiAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICB0YXNrCiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIGZldGNoKFdBU01fQ0ROX1BBVEhfUFJFRklYICsgJy9kZWNvZGVyLndvcmtlci5qcycpCiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICByZXR1cm4gcmVzLmJsb2IoKQogICAgICAgICAgICB9KQogICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoYmxvYikgewogICAgICAgICAgICAgIHJldHVybiBzZWxmLm0oewogICAgICAgICAgICAgICAgbG9jYXRlRmlsZTogZnVuY3Rpb24gKHN1ZmZpeCkgewogICAgICAgICAgICAgICAgICBpZiAoL1wud29ya2VyXC5qcyQvLnRlc3Qoc3VmZml4KSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgaWYgKC9cLndhc20kLy50ZXN0KHN1ZmZpeCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gV0FTTV9DRE5fUEFUSF9QUkVGSVggKyAnL2RlY29kZXIud2FzbScKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoL1wubWVtJC8udGVzdChzdWZmaXgpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFdBU01fQ0ROX1BBVEhfUFJFRklYICsgJy9kZWNvZGVyLmpzLm1lbScKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG1haW5TY3JpcHRVcmxPckJsb2I6IFdBU01fQ0ROX1BBVEhfUFJFRklYICsgJy9kZWNvZGVyLmpzJwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChNb2QpIHsKICAgICAgICAgICAgICBzZWxmLk1vZHVsZSA9IE1vZDsKICAgICAgICAgICAgICBvblBvc3RSdW4uY2FsbChzZWxmKTsKICAgICAgICAgICAgfSkKICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIG1zZzogJ0lOSVRfRkFJTEVEJywKICAgICAgICAgICAgbG9nOiBlLm1lc3NhZ2UKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfQogIH0KCiAgc2VsZi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkgewogICAgdmFyIGRhdGEgPSBlLmRhdGE7CiAgICBpZiAoZGF0YS5tc2cgIT09ICdpbml0JyAmJiBkYXRhLm1zZyAhPT0gJ3ByZWxvYWQnICYmICFkZWNvZGVyKSByZXR1cm4KICAgIHN3aXRjaCAoZGF0YS5tc2cpIHsKICAgICAgY2FzZSAncHJlbG9hZCc6CiAgICAgICAgaW5pdChkYXRhLnVybCk7CiAgICAgICAgQkFUQ0hfREVDT0RFX1NJWkUgPSBkYXRhLmJhdGNoRGVjb2RlQ291bnQ7CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSAnaW5pdCc6CiAgICAgICAgc2VsZi5tZXRhID0gZGF0YS5tZXRhOwogICAgICAgIEJBVENIX0RFQ09ERV9TSVpFID0gZGF0YS5iYXRjaERlY29kZUNvdW50OwogICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ3VwZGF0ZW1ldGEnOgogICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICBkZWNvZGVyLnVwZGF0ZU1ldGEoZGF0YS5tZXRhKTsKICAgICAgICBicmVhawogICAgICBjYXNlICdpbml0RGVjb2Rlcic6CiAgICAgICAgaWYgKGRlY29kZXIuZnJhbWVMZW5zT2Zmc2V0KSB7CiAgICAgICAgICBkZWNvZGVyLmJhdGNoRGVjb2RlKHRydWUpOwogICAgICAgIH0KICAgICAgICBkZWNvZGVyLmZsdXNoKCk7CiAgICAgICAgZGVjb2Rlci5kZWNvZGUoZGF0YS5kYXRhKTsKICAgICAgICBicmVhawogICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgIGRlY29kZXIuc3RvcmVCdWZmZXIoZGF0YS5kYXRhLCBkYXRhLmluZm8pOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ2ZsdXNoJzoKICAgICAgICBkZWNvZGVyLmZsdXNoKCk7CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSAnZmluaXNoX2ZsYWcnOgogICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgbXNnOiAnQkFUQ0hfRklOSVNIX0ZMQUcnCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSAnZGVzdG9yeSc6CiAgICAgICAgZGVjb2Rlci5kZXN0cm95KCk7CiAgICAgICAgYnJlYWsKICAgIH0KICB9OwoKfSgpKTsKCg==",null,!1),e_=el("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tZXZhbCAqLwogIC8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovCgogIGZ1bmN0aW9uIHNoaW1JbXBvcnRTY3JpcHRzIChzcmMpIHsKICAgIHJldHVybiBmZXRjaChzcmMpCiAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICByZXR1cm4gcmVzLnRleHQoKQogICAgICB9KQogICAgICAudGhlbihmdW5jdGlvbiAodGV4dCkgewogICAgICAgIGV2YWwodGV4dCk7CiAgICAgICAgc2VsZi5Nb2R1bGUgPSBNb2R1bGU7CiAgICAgICAgc2VsZi5hZGRPblBvc3RSdW4gPSBhZGRPblBvc3RSdW47CiAgICAgIH0pCiAgfQoKICB2YXIgTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RIID0gMTAyNCAqIDEwMjQ7CiAgdmFyIGluaXRUcyA9IDA7CgogIHZhciBEZWNvZGVyID0gZnVuY3Rpb24gKHNlbGYpIHsKICAgIHRoaXMuaW5pdGVkID0gZmFsc2U7CiAgICB0aGlzLnNlbGYgPSBzZWxmOwogICAgdGhpcy5tZXRhID0gc2VsZi5tZXRhOwogICAgdGhpcy5pbmZvbGlzdCA9IFtdOwogICAgc2VsZi5wYXJfYnJvYWR3YXlPbkJyb2Fkd2F5SW5pdGVkID0gdGhpcy5icm9hZHdheU9uQnJvYWR3YXlJbml0ZWQuYmluZCh0aGlzKTsKICAgIHNlbGYucGFyX2Jyb2Fkd2F5T25QaWN0dXJlRGVjb2RlZCA9IHRoaXMuYnJvYWR3YXlPblBpY3R1cmVEZWNvZGVkLmJpbmQodGhpcyk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUudG9VOEFycmF5ID0gZnVuY3Rpb24gKHB0ciwgbGVuZ3RoKSB7CiAgICByZXR1cm4gTW9kdWxlLkhFQVBVOC5zdWJhcnJheShwdHIsIHB0ciArIGxlbmd0aCkKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkgewogICAgTW9kdWxlLl9icm9hZHdheUluaXQoKTsKICAgIHRoaXMuc3RyZWFtQnVmZmVyID0gdGhpcy50b1U4QXJyYXkoCiAgICAgIE1vZHVsZS5fYnJvYWR3YXlDcmVhdGVTdHJlYW0oTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RILCAwKSwgLy8gMDog5YWz6ZetIGZmbXBlZyBsb2csCiAgICAgIE1BWF9TVFJFQU1fQlVGRkVSX0xFTkdUSAogICAgKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5icm9hZHdheU9uUGljdHVyZURlY29kZWQgPSBmdW5jdGlvbiAoCiAgICBvZmZzZXQsCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIHlMaW5lc2l6ZSwKICAgIHV2TGluZXNpemUsCiAgICBpbmZvaWQsCiAgICBrZXlGcmFtZQogICkgewogICAgbGV0IGZpcnN0RnJhbWUgPSB0aGlzLmluZm9saXN0WzBdOwogICAgaWYgKGZpcnN0RnJhbWUgJiYgZmlyc3RGcmFtZS5rZXlmcmFtZSAmJiAha2V5RnJhbWUpIHJldHVybgoKICAgIGxldCBpbmZvID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5pbmZvbGlzdC5zaGlmdCgpKTsKICAgIGxldCB5Um93Y291bnQgPSBoZWlnaHQ7CiAgICBsZXQgdXZSb3djb3VudCA9IGhlaWdodCAvIDI7CiAgICBpZiAoCiAgICAgIHRoaXMubWV0YSAmJgogICAgICAodGhpcy5tZXRhLmNocm9tYUZvcm1hdCA9PT0gNDQ0IHx8IHRoaXMubWV0YS5jaHJvbWFGb3JtYXQgPT09IDQyMikKICAgICkgewogICAgICB1dlJvd2NvdW50ID0gaGVpZ2h0OwogICAgfQogICAgdmFyIGRhdGEgPSB0aGlzLnRvVThBcnJheShvZmZzZXQsIHlMaW5lc2l6ZSAqIHlSb3djb3VudCArIDIgKiAodXZMaW5lc2l6ZSAqIHV2Um93Y291bnQpKTsKICAgIHZhciBkYXRldGVtcCA9IG5ldyBVaW50OEFycmF5KGRhdGEubGVuZ3RoKTsKICAgIGRhdGV0ZW1wLnNldChkYXRhKTsKICAgIHZhciBidWZmZXIgPSBkYXRldGVtcC5idWZmZXI7CgogICAgdGhpcy5zZWxmLnBvc3RNZXNzYWdlKAogICAgICB7CiAgICAgICAgbXNnOiAnREVDT0RFRCcsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIHlMaW5lc2l6ZSwKICAgICAgICB1dkxpbmVzaXplLAogICAgICAgIGluZm8sCiAgICAgICAgYnVmZmVyCiAgICAgIH0sCiAgICAgIFtidWZmZXJdCiAgICApOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLmJyb2Fkd2F5T25Ccm9hZHdheUluaXRlZCA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuaW5pdGVkID0gdHJ1ZTsKICAgIHZhciBjb3N0ID0gMDsKICAgIGlmIChpbml0VHMpIHsKICAgICAgY29zdCA9IHBlcmZvcm1hbmNlLm5vdygpIC0gaW5pdFRzOwogICAgfQogICAgdGhpcy5zZWxmLnBvc3RNZXNzYWdlKHsgbXNnOiAnREVDT0RFUl9SRUFEWScsIGNvc3QgfSk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlID0gZnVuY3Rpb24gKGRhdGEsIGluZm8pIHsKICAgIGlmIChpbmZvKSB7CiAgICAgIHRoaXMuaW5mb2xpc3QucHVzaChpbmZvKTsKICAgIH0KICAgIGlmIChpbmZvICYmIGluZm8ua2V5ZnJhbWUpIHsKICAgICAgdGhpcy5pbmZvbGlzdCA9IFtpbmZvXTsKICAgIH0KICAgIHRoaXMuc3RyZWFtQnVmZmVyLnNldChkYXRhKTsKICAgIE1vZHVsZS5fYnJvYWR3YXlQbGF5U3RyZWFtKGRhdGEubGVuZ3RoLCAwKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkgewogICAgTW9kdWxlLl9icm9hZHdheUV4aXQoKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS51cGRhdGVNZXRhID0gZnVuY3Rpb24gKG1ldGEpIHsKICAgIHRoaXMubWV0YSA9IG1ldGE7CiAgfTsKCiAgdmFyIGRlY29kZXI7CgogIGZ1bmN0aW9uIG9uUG9zdFJ1biAoKSB7CiAgICBkZWNvZGVyID0gbmV3IERlY29kZXIodGhpcyk7CiAgICBkZWNvZGVyLmluaXQoKTsKICB9CgogIHZhciBXQVNNX0NETl9QQVRIX1BSRUZJWCA9ICcnOwoKICBmdW5jdGlvbiBpbml0ICh1cmwpIHsKICAgIFdBU01fQ0ROX1BBVEhfUFJFRklYID0gdXJsLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpLmpvaW4oJy8nKTsKICAgIGluaXRUcyA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgdmFyIGlzRGVncmFkZSA9IC9hc20vLnRlc3QodXJsKTsKICAgIGlmICghZGVjb2RlcikgewogICAgICB2YXIgdGFzazsKICAgICAgaWYgKCFzZWxmLmltcG9ydFNjcmlwdHMpIHsKICAgICAgICB0YXNrID0gc2hpbUltcG9ydFNjcmlwdHModXJsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXNrID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgaWYgKCFzZWxmLmNvbnNvbGUpIHsKICAgICAgICAgICAgc2VsZi5jb25zb2xlID0gewogICAgICAgICAgICAgIGxvZzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgd2FybjogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgaW5mbzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBzZWxmLmltcG9ydFNjcmlwdHModXJsKTsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRhc2sKICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoaXNEZWdyYWRlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhdXRvIGluc3RhbmNlIERlY29kZXIhJyk7CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICBvblBvc3RSdW4uY2FsbChzZWxmKTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHNlbGYKICAgICAgICAgICAgLm0oewogICAgICAgICAgICAgIGluc3RhbnRpYXRlV2FzbTogZnVuY3Rpb24gKGluZm8sIHJlY2VpdmVJbnN0YW5jZSkgewogICAgICAgICAgICAgICAgZmV0Y2goYCR7V0FTTV9DRE5fUEFUSF9QUkVGSVh9L2RlY29kZXIud2FzbS5qc2ApCiAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiByZXMuYXJyYXlCdWZmZXIoKSkKICAgICAgICAgICAgICAgICAgLnRoZW4oYnVmZmVyID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gV2ViQXNzZW1ibHkuaW5zdGFudGlhdGUoYnVmZmVyLCBpbmZvKQogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlY2VpdmVJbnN0YW5jZShyZXN1bHQuaW5zdGFuY2UpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKE1vZCkgewogICAgICAgICAgICAgIHNlbGYuTW9kdWxlID0gTW9kOwogICAgICAgICAgICAgIG9uUG9zdFJ1bi5jYWxsKHNlbGYpOwogICAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgbXNnOiAnSU5JVF9GQUlMRUQnLAogICAgICAgICAgICBsb2c6IGUubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CiAgfQoKICBzZWxmLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CiAgICB2YXIgZGF0YSA9IGUuZGF0YTsKICAgIGlmICgoZGF0YS5tc2cgIT09ICdpbml0JyAmJiBkYXRhLm1zZyAhPT0gJ3ByZWxvYWQnKSAmJiAhZGVjb2RlcikgcmV0dXJuCiAgICBzd2l0Y2ggKGRhdGEubXNnKSB7CiAgICAgIGNhc2UgJ3ByZWxvYWQnOgogICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ2luaXQnOgogICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIG1zZzogJ0xPRycsCiAgICAgICAgICBsb2c6ICd3b3JrZXIgaW5pdGVkJwogICAgICAgIH0pOwogICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ3VwZGF0ZW1ldGEnOgogICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICBkZWNvZGVyLnVwZGF0ZU1ldGEoZGF0YS5tZXRhKTsKICAgICAgICBicmVhawogICAgICBjYXNlICdpbml0RGVjb2Rlcic6CiAgICAgICAgZGVjb2Rlci5kZWNvZGUoZGF0YS5kYXRhKTsKICAgICAgICBicmVhawogICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgIGRlY29kZXIuZGVjb2RlKGRhdGEuZGF0YSwgZGF0YS5pbmZvKTsKICAgICAgICBicmVhawogICAgICBjYXNlICdmaW5pc2hfZmxhZyc6CiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBtc2c6ICdCQVRDSF9GSU5JU0hfRkxBRycKICAgICAgICB9KTsKICAgICAgICBicmVhawogICAgICBjYXNlICdkZXN0b3J5JzoKICAgICAgICBkZWNvZGVyLmRlc3Ryb3koKTsKICAgICAgICBicmVhawogICAgfQogIH07Cgp9KCkpOwoK",null,!1),ev=new(function(){function e(){(0,a.Z)(this,e),(0,h.Z)(this,"_queue",[]),(0,h.Z)(this,"_pendingDecoder",null),(0,h.Z)(this,"TAG","DecoderCache")}return(0,d.Z)(eurn this._initDecoder(e)}},{key:"_initDecoder",value:function(e){var t,i,A,n,r,a=this,o=b,s=o.preloadDecoder,u=o.maxDecodeOnceWasm;e=e||s;var c=Z(),d=c.H264_DECODER_URL,g=c.H265_SIMD_DECODER_URL,l=c.H265_DECODER_URL,h=c.H265_THREAD_DECODER_URL,I=1;if("h265"===e&&(k()?(n=new ef,r=g,I=2):T()&&b.canUseThreadMode?(n=new em,r=h,I=1):(n=new ef,r=l,I=3)),"h264"===e&&(n=new e_,r=d,I=3),!n)return Promise.resolvse(function(e,A){t=e,i=A})).resolve=t,A.reject=i,A);n.postMessage({msg:"preload",batchDecodeCount:u,url:r}),this._pendingDecoder=n,n.id=Date.now()+parseInt(1e3*Math.random()),n.isHevc="h265"===e,n.using=!1,n.ready=!1,p.log(this.TAG,"start init decoder worker, id=",n.id,"hevc=",n.isHevc,"mode=",I);var f=function e(t){a._pendingDecoder=null;var i=t.data.msg;switch(("DECODER_READY"===i||"INIT_FAILED"===i)&&(n.removeEventListener("message",e),n.removeEventListener("error",m)),i){case"DECODER_READY":p.log(a.TAG,"decoder worker inited!, id=",n.id,"cost:",t.data.cost),n.ready=!0,n.using||a._queue.push(n),C.resolve();break;case"INIT_FAILED":p.log(a.TAG,"decoder worker init failed!",t.data.log)ull==t?void 0:t.message)};return n.addEventListener("message",f),n.addEventListener("error",m),C}},{key:"cacheDecoder",value:function(e){e.using=!1,e.ready=!0,e.id||(e.id=Date.now()+parseInt(1e3*Math.random())),this._queue.push(e),p.log(this.TAG,"cache decoder, id=",e.id),"h265"===b.preloadDecodereturn!e.using&&e.isHevc}).length&&this.genDecoder("h265")}},{keydy=").concat(t.ready)),t}}]),e}()),ep=b.maxDecodeOnceWasm,eE=function(e){(0,o.Z)(A,e);var t,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(A);if(t){var n=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function A(){var e;(0,a.Z)(this,A);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=i.call.apply(i,[this].concat(n)),(0,h.Z)((0,g.Z)(e),"TAG","WasmController"),(0,h.Z)((0,g.Z)(e),"_avccpushed",!1),(0,h.Z)((0,g.Z)(e),"_maxDecodeOnce",ep),(0,h.Z)((0,g.Z)(e),"_continueDecodeThreshold",ep/2),(0,h.Z)((0,g.Z)(e),"_wasmInitCost",0),(0,h.Z)((0,g.Z)(e),"_threadSupported",T()&&b.canUseThreadMode),(0,h.Z)((0,g.Z)(e),"_simdSuppported",k()),(0,h.Z)((0,g.Z)(e),"_decoderMode","undefined"!=typeof window&&window.WebAssembly?3:4),e}return(0,d.Z)(A,[{key:"wasmInitCost",get:function(){var e;return null===(e=this._decoderWorker)||void 0===e?void 0:e._wasmInitCost}},{key:"isHevc",get:function(){var e;return null===(e=this._parent)||void 0===e?void 0:e.isHevc}},{key:"_selectDecodeWorker",value:function(){this.analyse.addWasmInit();var e,t=Z(),i=t.H264_DECODER_URL,A=t.H265_DECODER_URL,n=t.H265_THREAD_DECODER_URL,r=t.H265_SIMD_DECODER_URL,a=t.ASM_H264_DECODER_URL,o=t.ASM_H265_DECODER_URL;if(p.log(this.TAG,"start init wasm worker:",performance.now(),"hevc:",this.isHevc,"decoderMode:",this._decoderMode),this.isHevc){if(!(e=1===this._decoderMode?n:2===this._decoderMode?r:3===this._decoderMode?A:o)){this._workerErrorCallback("no found decoder url, decodeMode:".concat(this._decoderMode));return}return{decoder:1===this._decoderMode?new em:new ef,url:e}}if(!(e=4===this._decoderMode?a:i)){this._workerErrorCallback("no found decoder url, decodeMode:".concat(this._decoderMode));return}return{decoder:new e_,url:e}}}itDecodeWorkerInternal()}},{key:"_initDecodeWorkerInternal",value:function(){var e=ev.getCachedDecoder(this.isHevc);if(e){p.warn(this.TAG,"select decoder from cache"),this.analyse.addWasmInit(),this._avccpushed=!1,this._bindWorkerEvent(e),this._decoderWorker=e,e.ready&&(this._decoderReady=!0,this._initDecoderWithConfiguration(e,this.meta),this._workerMessageCallback({type:"DECODER_READY",data:e}),p.log(this.TAG,"decoder ready!"));return}var t=this._selectDecodeWorker()||{},i=t.decoder,A=t.url;i&&(this._avccpushed=!1,this._bindWorkerEvent(i),i.isHevc=this.isHevc,i.postMessage({msg:"init",meta:this.meta,batchDecodeCount:ep,url:A}),this._decoderWorker=i)}},{key:"_bindWorkerEvent",value:function(e){var t=this,i=function(i,A){p.log(t.TAG,"worker failed: ",i,A),t._terminateWorker(e),t._decoderWorker=null,!1===b.wasmFallbackToAsm||4===t._decoderMode?t._workerErrorCallback(i):(t._decoderMode=1===t._decoderMode||2===t._decoderMode?3:4,t._initDecodeWorkerInternal())};e._onMessage=function(A){var n,r;switch(A.data.msg){case"DECODER_READY":if(p.log(t.TAG,"wasm worker ready!","cost:",A.data.cost),t._decoderReady=!0,e._wasmInitCost=parseInt(A.data.cost),!t.meta)return;t._avccpushed||t._initDecoderWithConfiguration(e,t.meta),t.emit(X.VIDEO.VIDEO_DECODER_INIT,e),t._workerMessageCallback({type:"DECODER_READY",data:e});break;case"DECODED":if(t._inDecoding=!0,(null===(n=A.data)||void 0===n?void 0:null===(r=n.info)||void 0===r?void 0:r.id)!==t._id)return;t._workerMessageCallback({type:"RECEIVE_FRAME",data:A.data});break;case"BATCH_FINISH_FLAG":if(t._inDecoding=!1,!t._workerMessageCallback)return;t._workerMessageCallback({type:"BATCH_FINISH"});break;case"INIT_FAILED":i(Anction(e){i(e.message,2)},e.addEventListener("message",e._onMessage),e.addEventListener("error",e._onError)}},{key:"_initDecoderWithConfiguration",value:function(e,t){p.log(this.TAG,"init decoder with configuration"),this._avccpushed=!0,e.postMessage({msg:"updatemeta",meta:t});var i=[t.rawVps||t.vps[0],t.rawSps||t.sps[0],t.rawPps||t.pps[0]].feturn e+(t.byteLength+4)},0),n=new Uiset(e,r),r+=e.byteLength}),e.postMessage({msg:"initDecoder",data:n})}},{key:"destroy",value:function(){if(this._decoderWorker){if(b.reuseWasmDecoder){this._offWorkerBind(this._decoderWorker),ev.cacheDecoder(this._decoderWorker),this._decoderWorker=null;return}this._terminateWorker(this._decoderWorker),this._decoderWorker=null}}},{knd unbind worker event")}},{keydestroy decoder worker")}}]),A}(eg);i(71654),i(38765);var ey=function(){function e(t,i){(0,a.Z)(this,e),this.TAG="FrameRender",this.configs=Object.assign({},t),this.parent=i,this.canvas=this.configs.canvas,this.meta=Object.assign({},this.configs.meta),this._initMeta(),this._initContextGL(),this.contextGL&&(this._initProgram(),this._initBuffers(),this._initTextures())}return(0,d.Z)(e,[{key:"_initMeta",value:function(){this.chroma=this.meta.chromaFormat,this.height=this.meta.height,this.width=this.meta.width,(this.canvas.width!==this.meta.width||this.canvas.height!==this.meta.height)&&(this.canvas.width=this.meta.width,this.canvas.height=this.meta.height,this.parent.emitResizeEvent())}},{key:"_initContextGL",value:function(){if("2d"===this.configs.type){this.ctx=this.canvas.getContext("2d");return}for(var e=this.canvas,t=null,i=["webgl","experimental-webgl","moz-webgl","webkit-3d"],A=0;!t&&A<i.length;){var n=i[A];try{t=e.getContext(n,this.configs.glCtxOptions),p.log("FrameRender","use=",n,this.configs.glCtxOptions);break}catch(e){t=null}t&&"function"==typeof t.getParameter||(t=null),++A}this.contextGL=t}},{key:"_initProgram",value:function(){var e=this.contextGL,t=e.createShader(e.VERTEX_SHADER);e.shaderSource(t,"attribute vec4 vertexPos;\nattribute vec4 texturePos;\nattribute vec4 uTexturePos;\nattribute vec4 vTexturePos;\nvarying vec2 textureCoord;\nvarying vec2 uTextureCoord;\nvarying vec2 vTextureCoord;\nvoid main()\n{\n  gl_Position = vertexPos;\n  textureCoord = texturePos.xy;\n  uTextureCoord = uTexturePos.xy;\n  vTextureCoord = vTexturePos.xy;\n}"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS);var i=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(i,"precision highp float;\nvarying highp vec2 textureCoord;\nvarying highp vec2 uTextureCoord;\nvarying highp vec2 vTextureCoord;\nuniform sampler2D ySampler;\nuniform sampler2D uSampler;\nuniform sampler2D vSampler;\nuniform mat4 YUV2RGB;\nvoid main(void) {\n  highp float y = texture2D(ySampler,  textureCoord).r;\n  highp float u = texture2D(uSampler,  uTextureCoord).r;\n  highp float v = texture2D(vSampler,  vTextureCoord).r;\n  gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;\n}"),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS);var A=e.createProgram();e.attachShader(A,t),e.attachShader(A,i),e.linkProgram(A),e.getProgramParameter(A,e.LINK_STATUS),e.useProgram(A);var n=e.getUniformLocation(A,"YUV2RGB");e.uniformMatrix4fv(n,!1,[1.16438,0,1.59603,-.87079,1.16438,-.39176,-.81297,.52959,1.16438,2.01723,0,-1.08139,0,0,0,1]),this.shaderProgram=A}},this.vTexturePosBuffer=s}},{ei(e.UNPACK_ALIGNMENT,1)}},ure(e.TEXTURE_2D,null),t}},{key:"_drawPictureGL",value:function(e,t,i,A,n){var r=A*i,a=n*i/2;(444===this.chroma||422===this.chroma)&&(a*=2);var o={yData:(e=new Uint8Array(e)).subarray(0,r),uData:e.subarray(r,r+a),vData:e.subarray(r+a,r+a+a)};this._drawPictureGL420(o,t,i,A,n)}},{key:"_drawPictureGL420",value:function(e,t,i,A,n){var r=this.contextGL,a=this.texturePosBuffer,o=this.uTexturePosBuffer,s=this.vTexturePosBuffer,u=this.yTextureRef,c=this.uTextureRef,d=this.vTextureRef,g=e.yData,l=e.uData,h=e.vData,I=i/2;(422===this.chroma||444===this.chroma)&&(I=i);var C=I,f=this.canvas.width/this.width,m=this.canvas.height/this.height,_=0,v=0,p=this.canvas.width,E=this.canvas.height;f<m?(E=this.height*this.canvas.width/this.width,v=parseInt((this.canvas.height-this.height*this.canvas.width/this.width)/2)):(p=this.width*this.canvas.height/this.height,_=parseInt((this.canvas.width-this.width*this.canvas.height/this.height)/2)),r.viewport(_,v,p,E);var y=new Float32Array([1,0,0,0,1,1,0,1]);r.bindBuffer(r.ARRAY_BUFFER,a),r.bufferData(r.ARRAY_BUFFER,y,r.DYNAMIC_DRAW);var R=new Float32Array([1,0,0,0,1,1,0,1]);r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,R,r.DYNAMIC_DRAW);var b=new Float32Array([1,0,0,0,1,1,0,1]);r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferData(r.ARRAY_BUFFER,b,r.DYNAMIC_DRAW),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,u),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,A,i,0,r.LUMINANCE,r.UNSIGNED_BYTE,g),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,c),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,n,I,0,r.LUMINANCE,r.UNSIGNED_BYTE,l),r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,d),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,n,C,0,r.LUMINANCE,r.UNSIGNED_BYTE,h),r.drawArrays(r.TRIANGLE_STRIP,0,4)}},{key:"_drawPicture2d",value:function(e){if(e&&this.canvas){this.ctx||(this.ctx=this.canvas.getContext("2d"));var t=e.displayWidth||e.width,i=e.displayHeight||e.height;(this.canvas.height!==i||this.canvas.width!==t)&&(this.canvas.height=i,this.canvas.width=t);try{this.ctx.drawImage(e.dom||e,0,0,t,i)}catch(e){}}}},{key:"_resize",value:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,this.parent.emitResizeEvent):this._drawPicture2d(e)meta=Object.assign({},e)}rent=e,this.resetMeta(t)}},{key:"destroy",value:function(){this.parent=null,this.canvas.style.display="none",this.canvas&&(this.canvas.glInstance=null,this.canvas=null)}}]),e}(),eR=function(e){(0,o.Z)(A,e);var t,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(A);if(t){var n=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function A(){var e;(0,a.Z)(this,A);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=i.call.apply(i,[this].concat(n)),(0,h.Z)((0,g.Z)(e),"TAG","VideoRenderWithDecoder"),(0,h.Z)((0,g.Z)(e),"_hideRenderFlag",0),(0,h.Z)((0,g.Z)(e),"_recentMeta",null),(0,h.Z)((0,g.Z)(e),"_inChaseFrame",!1),(0,h.Z)((0,g.Z)(eion(t){e._emitError(t,1)}),(0,h.Z)((0,g.Z)(e),"_decoderMessageCallback",function(t){var i,A,n,r=t.type,a=t.data;switch(r){case"DECODER_READY":e.analyse.addWasmReady(),e._startDecode();break;case"RECEIVE_FRAME":if(e._inChaseFrame&&!(null!==(i=e._decodeController)&&void 0!==i&&i.webcodec))return;e._receiveFrame(a);break;case"BATCH_FINISH":null===(A=(0,g.Z)(e))||void 0===A||A._decodeEstimate.resetDecodeDot(),e._inChaseFrame&&(e._inChaseFrame=!1,e._frameQueue.empty()),e._ready||e.inSeeking||null===(n=e._decodeController)||void 0===n||!n.decoderReady||e._startDecode()}}),e}return(0,d.Z)(A=e?void 0:e.wasmInitCosturn 1===this.decodeMode}},{key:"lowlatency",get:function(){return this._parent.lowlatency}}info&&e.info.dts||0)/1e3}},{key:"offscreenUsed",get:function(){return b.offscreenCanvas}},{key:"ajustSeekTime",value:function(e,t){var i;p.warn(this.TAG,"ajust seek time[preciseSeek:".concat(!!t,"]: "),e),this._frameQueue.empty(),null===(i=this._decodeController)||void 0===i||i.flushDecoder(),this._switchVideoBuffer(e,alue:function(){return!0}},{key:"_appendChunk",value:function(e){if(!this.noVideo&&this._timeRange){if(this._meta){if(this._recentMeta.width!==e.width||this._recentMeta.height!==e.height){p.warn(this.TAG,"metadata changed! width: ".concat(this._recentMeta.width," -> ").concat(e.width,", height: ").concat(this._recentMeta.height," -> ").concat(e.height));var t=e.samples[0];t&&(this._recentMeta=t.meta=Object.assign({},e,{samples:null}))}}else{this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.LOADEDMETADATA),this._recentMeta=this._meta=Object.assign({},e,{samples:null}),p.warn(this.TAG,"video set metadata",this._meta,"configuration:",this.configuration);var i,A,n=e.fpsNum/e.fpsDen;n?p.log(this.TAG,"detect fps:",n):p.warn(this.TAG,"no detect fps,start estimate"),this._selectDecoder(),this._initDecoder(),this._initFrameRender()}this._timeRange.append(e.samples,this._isLive&&this.noAudio,!this.videoDecode),e.samples=[],!this.inSeeking&&(this.isLive||this._timeRange.frameLength||this._switchVideoBuffer(this._parent.currentTime),!this._ready&&null!==(i=this._decodeController)&&void 0!==i&&i.decoderReady&&(this.noAudio||!(null!==(A=this._decodeController)&&void 0!==A&&A.inDecoding))&&this._startDecode(),this.noAudio&&this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.DURATION_CHANGE))}}},{key:"_selectDecoder",value:function(){if(!this.isHevc&&eC.isSupported()){this._decodeController=new eC(this),this._decodeEstimate.webcodec=!0;return}this._decodeController=new eE(this)}},s._decoderErrorCallback)}},{key:"_initFrameRender",value:function(){try{if(this.offscreenUsed){this._renderWorker.initRenderContext({meta:this._meta,type:this._decodeController.webcodec?"2d":""}),this._frameRender=function(){};return}var e=Object.assign(this._config,{meta:this._meta,canvas:this._canvas,type:this._decodeController.webcodec?"2d":""});this._frameRender=new ey(e,this),p.log(this.TAG,"create frameRender with config",e)}catch(e){this._emitError(e&&e.message,2)}}},void 0===e||e.doDecode()}},{key:"_switchVideoBuffer",value:function(e,t){var i,A=this._timeRange.switchBuffer(e);if(A){if(this.noAudio&&this._parent.emit(X.TIMELINE.SYNC_DTS,this.getDtsOfTime(A.start)),t){null===(i=this._decodeController)||void 0===i||i.preciseSeek(e);return}this._startDecode(t)}}},{kthis._frameQueue.length)}},{key:"_render",value:function(e){if(!this.noVideo){var t,i,A,n=this._frameQueue&&this._frameQueue.nextFrame();if(!n){if(p.log(this.TAG,"lack frame, ","inDecoding:",null===(i=this._decodeController)||void 0===i?void 0:i.inDecoding),this._checkToDecode(),this.noAudio){if(!this.isLive&&.5>Math.abs(this.currentTime-this.duration)){this===null||void 0===this||this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.TIMEUPDATE),this===null||void 0===this||this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ENDED),null===(A=this._timeRange)||void 0===A||A.clean();return}this._timeRange.frameLength||(this._ready=!1,this.emit(X.VIDEO.VIDEO_WAITING))}return}var r=n.info;if(!r){this._frameQueue.shift();return}this._renderDts=r.dts;var a=r.dts-this.preciseVideoDts;if(e||!(a>0)||!(a<6e4)){this._frameQueue.shift(this.preciseVideoDts),Math.abs(this._lastTimeupdate-r.dts)>250&&(this._emitTimelineEvents(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.TIMEUPDATE,{pts:r.originPts/90}),this._lastTimeupdate=r.dts),p.long&&p.log(this.TAG,"render delay:".concat(a," , timelinePosition:").concat(this.preciseVideoDts," , dts:").concat(r.dts," , cost:").concat(r.cost," , gopID:").concat(r.gopId," , rest:").concat(this._frameQueue.length,", buffer frame:").concat(this._timeRange.frameLength));var o=performance.now();this._hideRenderFlag++,"visible"===document.visibilityState?this.offscreenUsed?this._renderWorker.render(n.buffer,n.width,n.height,n.yLinesize,n.uvLinesize):this._frameRender.render(n.buffer,n.width,n.height,n.yLinesize,n.uvLinesize):this._hideRenderFlag%15&&(this.offscreenUsed?this._renderWorker.render(n.buffer,n.width,n.height,n.yLinesize,n.uvLinesize):this._frameRender.render(n.buffer,n.width,n.height,n.yLinesize,n.uvLinesize)),null!==(t=this._decodeController)&&void 0!==t&&t.webcodec&&n.buffer.close(),this._renderCost=performance.now()-o,this._checkToDecode()}}}},{key:t||t.updateSegmentEnd(e)}},{key:"_doChaseFrame",value:function(e){var t=e.frame;this._inChaseFrame=!0,this._timeRange.deletePassed(t.dts),this._frameQueue.empty(),this.noAudio&&this._parent.emit(X.TIMELINE.SYNC_DTS,t.dts)}},{key:"_destroy",value:function(e){var t;p.log(this.TAG,"destroy video render"),(0,l.Z)((0,u.Z)(A.prototype),"destroy",this).call(this,e),null===(t=this._decodeController)||void 0===t||t.destroy(),this._decodeController=null}}]),A}(ed),eb=function(e))s);return(0,s.Z)(this,e)});function A(e,t){var n;return(0,a.Z)(this,A),(n=i.call(this)).TAG="TimeLine",n._parent=t,n._seeking=!1,n.audioRender=en.isSupported()?new en(e,(0,g.Z)(n)):new j(e,(0,g.Z)(n)),n.videoRender=new eR(e,(0,g.Z)(n)),n._readyStatus={audio:!1,video:!1},n._paused=!0,n._switchToMultiWorker=!1,n._lowdecodeEmited=!1,n._startPlayed=!1,n._emitReady=!1,n._singleTrack=-1,n._bindEvent(),n._decodeVideo=e.video,n._seekDirection=1,n}return(0,d.Z)(A,[{key:"analyse",get:function(){return this._parent.a&this._readyStatus.){return e.currentTik||2===this._singleTrack}},{key:"isLive",get:function(){return this._parent.n(){return this._seeking}},{key:"decodeFps",get:function(){return this.videoRender.decodeFps}},{key:"decodeCost",get:function(){return this.videoRender.decodeCost}},{key:"renderCost",get:function(){return this.videoRender.renderCost}},{key:"wasmInitCost",get:function(){return this.videoRender.wasmInitCost}},{key:"fps",get:function(){return this.videoRender.fps}},{key:"totalSize",get:function(){return this.videoRender.totalSize}},{key:"bitrate",get:function(){return this.videoRender.bitrate}},{key:"gopLength",get:function(){return this.videoRender.gopLength.audioRender.currentTime}},{k.audioRender.curren this.videoRender.canvas}},{key:"readyState",get:function(){return this.audioRender.readyState}},{key:"buffered",get:function(){var e=this;return this.noAudio?this.videoRender.buffered:this.audioRender.isMse||this.isLive?this.audioRender.buffered:{length:this.audioRender.buffered.length,start:function(t){return Math.max(e.audioRender.buffered.start(t),e.videoRendeoRender.buffered.end(t)is.videoRender.duration)}},{key:"paused",get:function(){return this._paused},set:function(e){this._paused=e}},{key:"lowlatency",get:function(){return this._parent.lowlatency}},{key:"decoderMode",get:function(){return this.videoRender.decoderMode}},{key:"currentAudioCanAutoplay",get:function(){return this.audioRender.audioCanAutoplay}},{key:"_checkInBuffer",value:function(){for(var e=this.buffered,t=0,i=e.length;t<i;t++)if(e.start(t)<=this.currentTime+.1&&e.end(t)>=this.currentTime)return!0;return!1}},{key:is._readyStatus.video=!1}},{key:"_bindEvent",value:function(){var e=this;this.videoRender.setRemux(t)}),this.on(X.DECODE_EVENTS.CHASE_AUDIO_FRAME,t)}),this.audioRender.on(X.AUDIO.AUDIO_READY,function(t){p.log(e.TAG,"audio ready! seeking=",e._seeking,"seeked:",!!t,"paused:",e._paused),e._seeking&&setTimeout(function(){try{var t=1===e._seekDirection?e.videoRender.getSeekStartPositionBehind(e.currentTime,1/0):e.videoRender.getSeekStartPosition(e.currentTime,1/0);if(e.audioRender.isMse&&t){if(b.preciseSeekLimit>e.duration&&e.currentTime>.1){e.audioRender.seekNoSideEffect({position:e.currentTime+.1}),e.videoRender.ajustSeekTime(e.currentTime,!0);return}e.audioRender.seekNoSideEffect({position:t.position+.1}),e.videoRender.ajustSeekTime(t.position);return}e.videoRender.ajustSeekTime(e.currentTime)}catch(e){}},10),e._readyStatus.video&&e._startRender(e._seeking&&t),e._readyStatus.audio=!0,e._startPlayed||e.analyse.addAudioReady()}),this.audioRender.on(X.AUDIO.A{e._emitReady&&e.pause()}),this.audioRender.on(X.AUDIO.AUDIO_WAITING,function(){!e.noAudio&&e.currentTime&&(p.warn(e.TAG,"lack data, audio waiting,currentTime:",e.currentTime),e.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.WAITING),e.emit(X.TIMELINE.DO_PAUSE),e._readyStatus.audio=!1)}),this.videoRender.on(X.VIDEO.VIDEO_WAITING,function(){p.warn(e.TAG,"lack data, video waiting"),e.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.WAITING),e.emit(X.TIMELINE.DO_PAUSE),e._readyStatus.video=!1}),this.videoRender.on(X.VIDEO.VIDEO_READY,function(){p.log(e.TAG,"video ready!"),e._startPlayed||e.analyse.addVideoReady(),e._readyStatus.audio&&e._startRender(e._seeking),e._readyStatus.video=!0}),this.videoRender.on(X.VIDEO.DECODE_LOW_FPS,function(t){e.currentTime<.1||(e.analyse.increaseLowDecodeCount(t),e._lowdecodeEmited||(D++,e._lowdecodeEmited=!0),e.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.LOW_DECODE))}),this.on(X.TIMELINE.SINGLE_TRACK,function(t){e._singleTrack=t,(1===t||2===t)&&(e._readyStatus.audio=!0),3===t&&(e._readyStatus.video=!0),e.emit(X.TIMELINE.SYNC_DTS,0)}),t=null,e.audioRender=null}),this.on(X.TIMELINE.DO_PLAY,function(){e.emit(X.TIMELINE.START_RENDER),e._paused=!1,e.noAudio&&e.emit(X.TIMELINE.SYNC_DTS,0)})}},{key:"_startRender",value:function(e){if(!this._parent.error&&this.videoRender){if(this.noAudio&&this.emit(X.TIMELINE.SYNC_DTS,0),this.videoRender.forceRender(),!this.isLive&&this._paused&&this.seeking&&this._checkInBuffer()){p.log(this.TAG,"set seeking = false"),this._seeking=!1,this.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.SEEKED),p.groupEnd();return}this._startPlayed||(this.analyse.addFirstframe(),this.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.LOADEDDATA),this.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.FIRST_FRAME),this._startPlayed=!0),p.log(this.TAG,"emit canplay"),this.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.CANPLAY),this._parent.autoplay&&(p.warn(this.TAG,"startRender: time=",this.currentTime,"paused:",this.paused,"seeking:",this.seeking),this.emit(X.TIMELINE.START_RENDER)),this.emit(X.TIMELINE.READY),this._emitReady=!0,this._seeking&&e&&(p.log(this.TAG,"set seeking = false"),this._seeking=!1,this.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.SEEKED),p.groupEnd())}}},{key:"_checkHlsTracks",value:function(e){if(!(null==e?void 0:e.samples[0])){if(!this.buffered.length){var t=Error("lack video sample");t.code=3,this.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.ERROR,t)}return!1}return!0}},{key:"appendBuffer",value:function(e,t){this.emit(X.TIMELINE.APPEND_CHUNKS,e,t),this.noAudio&&this._seeking&&this.videoRender.ajustSeekTime(this.currentTime)}},{key:"play",value:function(){var e=this;return new Promise(function(t,i){var A=e.currentAudioCanAutoplay;e.noAudio?A=!0:e.audioRender&&e.audioRender.resume().then(function(){if(p.log(e.TAG,"audio render resumed, pause status: ".concat(e._paused,", audioCanAutoplay:").concat(e.currentAudioCanAutoplay)),e._paused||!e.currentAudioCanAutoplay){A=!1,e.emit(X.TIMELINE.DO_PAUSE);return}A=!0}).catch(function(){}),setTimeout(function(){if(p.log(e.TAG,"play() timer done, resumed=".concat(A,", paused=").concat(e.paused)),!A){if(!e.paused){p.log(e.TAG,"audioCtx can't autoplay"),e.pause(),i({name:"NotAllowedError"});return}e.pause(),t();return}e._paused=!1,t()},e.audioRender.isMse?10:60)})}},{key:"pause",value:function(){var e,t;(!this._paused||null===(e=this.audioRender)||void 0===e||null===(t=e.media)||void 0===t||!t.paused)&&(this.ready||this._seeking)&&(this.emit(X.TIMELINE.DO_PAUSE),this._paused=!0,this.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.PAUSE))}},{key:"seek",value:function(e){var t=this;if(this._seeking&&p.groupEnd(),this.isLive){if(this.currentTime<.1||!this.currentAudioCanAutoplay||this.paused)return;var i=this.videoRender.getSeekStartPosition(e,this._parent.preloadTime+1);if(i){if(i.position<this.currentTime)return;var A=this.audioRender.canSeek(i.position),n=this.videoRender.canSeek(i);if(!A||!n){p.log(this.TAG,"seek, !!!!!!!!!can not seek, audioCanSeek:",A,"videoCanSeek:",n);return}p.warn(this.TAG,"seek, chase frame to time: ",i.position,"currentTime:",this.currentTime,"duration:",this.duration),this.videoRender.videoDecode?(this.audioRender.doPause(),i.position=i.position-1.5,this.emit(X.DECODE_EVENTS.CHASE_VIDEO_FRAME,i)):this.emit(X.TIMELINE.CHASE_FRAME,i)}return}e>=this.duration&&(e=this.duration-1),e<0&&(e=0),p.group(this.TAG,"start seek to:".concat(e,", set seeking status=true")),this._seeking=!0,this.videoRender.setSeekingStatus(!0),this.noAudio?(this.emit(X.TIMELINE.SYNC_DTS,this.videoRender.getDtsOfTime(e)),this.videoRender.ajustSeekTime(e)):this._resetReadyStatus(),this._seekDirection=this.currentTime<e?1:2,this.emit(X.TIMELINE.DO_SEEK,e),new Promise(function(e){t.emit(X.TIMELINE.PLAY_EVENT,X.VIDEO_EVENTS.SEEKING),e()})}}]),A}(W());i(60089);var eZ={FIRST_DATA:1,AUDIO_MSE_OPEN_START:2,AUDIO_MSE_OPEND:3,AUDIO_FIRSTTIME_APPENDED:4,AUDIO_READY:5,WASM_WORKER_INIT:6,WASM_WORKER_READY:7,FIRST_FRAME_TODECODE:8,VIDEO_READY:9,FIRST_FRAME:10,WAITIGN:11,SEEKING:12,SEEKED:13},ek=Object.entries(eZ),eT=function(){function e(){(0,a.Z)(this,e),(0,h.Z)(this,"_dot",[]),(0,h.Z)(this,"_currentLowDecodeCount",0)}return(0,d.Z)(e,[dot:parseInt(e.dot-t)}})}},{key:"getStats",value:function(e){var t,i=this.getBootStats(),A=i.length;return{bootStats:i,currentState:A?i[A-1].action:0,bitrate:Math.abs(e.bitrate/1e3),decodeFps:e.decodeFps,fps:e.fps,playbackRate:e.playbackRate,firstframe:null===(t=i.filter(function(e){return 10===e.action})[0])||void 0===t?void 0:t.dot,width:e.videoWidth,height:e.videoHeight,decoderMode:e.decoderMode,vv:S,lowdecodeVV:D,h265FailureRate:Math.floor(D/S*100),currentLowDecodeCount:this._currentLowDecodeCount}}}t.push(r.dot-i)}return t}},{key:"addFirstData",value:function(){this._dot.push({action:eZ.FIRST_DATA,dot:this._getTimestap()})}},{key:"addAudioBoundMedia",value:function(){this._dot.push({action:eZ.AUDIO_BOUND_MEDIA,dot:this._getTimestap()})}},{key:"addAudioMseOpenStart",value:function(){this._dot.push({action:eZ.AUDIO_MSE_OPEN_START,dot:this._getTimestap()})}},{key:"addAudioMseOpend",value:function(){this._dot.push({action:eZ.AUDIO_MSE_OPEND,dot:this._getTimestap()})}},{key:"addAudioFirstTimeAppended",value:function(){this._dot.push({action:eZ.AUDIO_FIRSTTIME_APPENDED,dot:this._getTimestap()})}},{key:"addAudioReady",value:function(){this._dot.push({action:eZ.AUDIO_READY,dot:this._getTimestap()})}},{key:"addWasmInit",value:function(){this._dot.push({action:eZ.WASM_WORKER_INIT,dot:this._getTimestap()})}},{key:"addWasmReady",value:function(){this._dot.push({action:eZ.WASM_WORKER_READY,dot:this._getTimestap()})}},{key:"addFirstFrameToDecode",value:function(){this._dot.push({action:eZ.FIRST_FRAME_TODECODE,dot:this._getTimestap()})}},{key:"addVideoReady",value:function(){this._dot.push({action:eZ.VIDEO_READY,dot:this._getTimestap()})}},{key:"addFirstframe",value:function(){this._dot.push({action:eZ.FIRST_FRAME,dot:this._getTimestap()});var e,t=null===(e=this.getBootStats().filter(function(e){return 10===e.action})[0])||void 0===e?void 0:e.dot;if(t>=500){B=!0;return}t>=800&&w(3)}},{key:"addWaiting",value:function(){this._dot.push({action:eZ.WAITIGN,dot:this._getTimestap()})}},{key:"addSeeking",value:function(){this._dot.push({action:eZ.SEEKING,dot:this._getTimestap()})ot:this._getTimestap()})}},return performance.now()}},{key:"increaseLowDecodeCount",value:function(e){this._currentLowDecodeCount++,this._currentLowDecodeCount>=1&&e<=b.tempDisabledThreshold&&(p.warn("Analyse","disabled!, fps=".concat(e,", threshold=").concat(b.tempDisabledThreshold)),wcodeCount=0,this._dot=[]}}]),e}(),eV={LOW_LATENCY:1,NO_AUDIO:2,NO_VIDEO:3},eS=function(e){(0,o.Z)(n,e);var t,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(n);if(t){var A=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,A)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function n(){var e;return(0,a.Z)(this,n),(e=i.call(this)).TAG="XGVideo",e._proxyProps(),e._isLive=!0,e._vMeta=null,e._aMeta=null,e._resizeObserver=null,e._eventsBackup=[],e._domConnected=!1,e._hevc="h265"===b.preloadDecoder,e._hevc||(e._degradeVideo=document.createElement("video")),e._onTouchEnd=e._onTouchEnd.bind((0,g.Z)(e)),e.analyse=new eT,e}return(0,d.Z)(n,[{key:"_proxyProps",value:function(){var e=this;Object.getOwnPropertyNames(n.prototype).forEach(function(t){/^__/.test(t)&&Object.defineProperty(is[ttry{this[t]=e}catch(e){}}})})}},{key:"addEventListener",value:function(e,t,i){(0,l.Z)((0,u.Z)(n.prototype),"addEventListener",this).call(this,e,t,i),this._degradeVideo&&this._eventsBackup.push([e,t,i])}},{key:"removeEventListener",value:function(e,t,i){(0,l.Z)((0,u.Z)(n.prototype),"removeEventListener",this).call(this,e,t,i),this._degradeVideo&&(this._eventsBackup=dler===t&&A.capture===i)}))}},{key:"setAttribute",value:function(e,t){var i;(0,l.Z)((0,u.Z)(n.prototype),"setAttribute",this).call(this,e,t),"src"!==e&&(null===(i=this._degradeVideo)||void 0===i||i.setAttribute(e,t))}},{key:"_init",value:function(){this.analyse.reset(),this.timeline=new eb({volume:this.volume,canvas:this.querySelector("canvas"),videoContext:this.videoContext,videoDecode:this.videoDecode,maxVideoHeight:this.getAttribute("maxVideoHeight"),endLevel:parseInt(this.getAttribute("endLevel"))},this),p.log(this.TAG,"timeline init"),this._noSleep=new f,this._logFirstFrame=!1,this._playRequest=null,this._degradeVideoUserGestured=!1,this._bindEvents(),this._vMeta&&!this.videoDecode&&this.setVideoMeta(this._vMeta),this._glCtxOptions&&(this.glCtxOptions=this._glCtxOptions),this.timeline&&(this.innerDegrade&&this.timeline.emit(X.TIMELINE.INNER_DEGRADE),this.timeline.emit(X.TIMELINE.SET_PLAY_MODE,this._isLive?"LIVE":"VOD"),this.timeline.emit(X.TIMELINE.SET_PLAYBACKRATE,this.playbackRate),this.muted=this.muted)}},{key:"_bindEvents",value:function(){var e=this;this.timeline.on(X.TIMELINE.PLAY_EVENT,function(t,i){var A,n;if(t===x.LOADEDDATA&&(e.querySelector("canvas")||(p.log(e.TAG,"_bindEvents, appendChild canvas"),e.appendChild(e.canvas)),e.canvas.style.display="block",null===(n=e.timeline)||void 0===n||n.emit(X.TIMELINE.SET_PLAYBACKRATE,e.playbackRate)),(t===x.RESIZE&&null!==(A=e.timeline)&&void 0!==A&&A.ready||t===x.CANVAS_LAYOUT)&&Promise.resolve().then(function(){e.updateVideoPostion()}),t===x.ERROR){if(p.warn(e.TAG,"detect error:",null==i?void 0:i.message),e.pause(),e._disabled(!0),e.innerDegrade||5===e.decoderMode){e.degradeInfo={decodeFps:e.decodeFps,bitrate:e.bitrate,wasmInitCost:e.wasmInitCost,fps:e.fps,url:e.src,msg:null==i?void 0:i.message,decoderMode:e.decoderMode},e._innerDispatchEvent("lowdecode");return}e._err=i}if(t===x.LOW_DECODE){e._disabled(),e.degradeInfo={decodeFps:e.decodeFps,bitrate:e.bitrate,wasmInitCost:e.wasmInitCost,fps:e.fps,url:e.src,decoderMode:e.decoderMode},e._innerDispatchEvent(U[t],e.degradeInfo);return}if(t===x.LARGE_AV_GAP&&(e.unsyncInfo=i),t===x.ENDED){if(e.paused)return;e.pause()}t===x.PROGRESS&&e._noSleep.toPlay(),t===x.WAITING&&e.analyse.addWaiting(),t===x.SEEKING&&e.analyse.addSeeking(),t===x.SEEKED&&e.analyse.addSeeked(),e._innerDispatchEvent(U[t],i)})}},{key:"_disabled",value:function(e){if(this.innerDegrade||e){if(e){if(b.evaluateVVCount){B=!0;return}w(1);return}if(!b.evaluateVVCount){if(this.decodeFps/this.fps<=.6&&this.bitrate<2e6){w(1);return}w(2)}}}},{key:"degrade",value:function(e){var t=this;this.querySelector("canvas")?this.replaceChild(this._degradeVideo,this.canvas):this.appendChild(this._degradeVideo),this.destroy(),this._eventsBackup.forEach(function(e){var i,A=(0,c.Z)(e,3),r=A[0],a=A[1],o=A[2];(0,l.Z)((0,u.Z)(n.prototype),"removeEventListener",t).call(t,r,a,o),null===(i=t._degradeVideo)||void 0===i||i.addEventListener(r,a,o)}),this._eventsBackup=[],e&&(this._degradeVideo.muted=!1,this._degradeVideo.src=e,this._degradeVideo.load())}},{key:"disconnectedCallback",value:function(){if(this._domConnected=!1,p.log(this.TAG,"video disconnected"),document.removeEventListener("touchend",this._onTouchEnd,!0),this.querySelector("canvas"))try{this.removeChild(this.querySelector("canvas")),p.log(this.TAG,"remove canvas child")}catch(e){}this.destroy(!0),this._resizeObserver&&this._resizeObserver.disconnect(this)}},{key:"connectedCallback",value:function(){var e,t,i,A=this;if((null===(e=this.childNodes[0])||void 0===e?void 0:null===(t=e.tagName)||void 0===t?void 0:null===(i=t.toLocaleLowerCase)||void 0===i?void 0:i.call(t))==="source"){B=!0;var n=Error("not supported source type");n.code=3,this._err=n,this._innerDispatchEvent("error",n);return}p.log(this.TAG,"video connected to document",performance.now()),this.timeline||this._init(),this.style.width="100%",this.style.height="100%",this.style.position="absolute",this.style.left="0px",this.style.top="0px",document.addEventListener("touchend",this._onTouchEnd,!0),ResizeObserver&&(this._resizeOb&&A.updateVideoPostion()}),this._resizeObserver.observe(this)),this._domConnected=!0}}&&this._noSleep.enable()}},{key:"_degradeVideoInteract",value:function(){var e=this;if(this._degradeVideo&&(1===this.innerDegrade||3===this.innerDegrade)){if(this._degradeVideoUserGestured)return;var t=this._degrradeVideoUserGestured=!0}).catch(function(e){})}}},{key:"play",value:function(e){var t=this;if(!this.tiout(function(){e()},800)});p.log(this.TAG,"play() called, ready:".concat(this.timeline.ready,", paused:").concat(this.timeline.paused,", force:").concat(e)),this._degradeVideoInteract();var i=0;if(this.timeline.ready&&this.timeline.paused||e){if(e=e||this._isLive,this._playRequest=null,!e)return this.timeline.emit(X.TIMELINE.DO_PLAY),this._innerDispatchEvent("play"),Promise.resolve();this.destroy(),nt("waiting")}catch(e){}},300)}return this._playRequest||!this.timeline.ready||this.timeline.paused?(p.log(this.TAG,"request play!"),this._playRequest=this.{t._playRequest=null})})}),this._playRequest):Promise.resolve()}},{key:"pause",value:function(){this._playRequest=null,this.timeline&&this.timeline.pause();try{var e;this._noSleep.disable(),(e=A||(A=document.querySelector("#hackAudioPP")))&&e.pause()}catch(e){}}},{key:"load",value:function(){}},{key:"appendBuffer",value:function(e,t){if(this.timeline&&!this._err){if(!this._logFirstFrame){var i=e&&e.samples[0],A=t&&t.samples[0];if(!i&&!A)return;if(i||A){var n=(null==e?void 0:e.duration)/((null==e?void 0:e.formatTimescale)||1/0),r=(null==t?void 0:t.duration)/((null==t?void 0:t.formatTimescale)||1/0);p.warn(this.TAG,"video firstDts:".concat(i&&i.dts," , audio firstDts:").concat(A&&A.dts," videoTrack.duration=").concat(n,", audioTrack.duration=").concat(r)),this._logFirstFrame=!0,(n||r)&&(this.setPlayMode("VOD"),this.timeline.emit(X.TIMELINE.SET_PLAY_MODE,this._isLive?"LIVE":"VOD"),this.duration=Math.min(n||r,r||n)),this.analyse.addFirstData()}this.lowlatency&&(p.warn(this.TAG,"single track! type=",eV.LOW_LATENCY),this.timeline.emit(X.TIMELINE.SINGLE_TRACK,eV.LOW_LATENCY)),t.exist()||(p.warn(this.TAG,"single track! type=",eV.NO_AUDIO),this.timeline.emit(X.TIMELINE.SINGLE_TRACK,eV.NO_AUDIO)),e.exist()||(p.warn(this.TAG,"single track! type=",eV.NO_VIDEO),this.timeline.emit(X.TIMELINE.SINGLE_TRACK,eV.NO_VIDEO))}e.formatTimescale&&e.samples.forEach(function(t){t.dts=Math.floor(t.dts/e.formatTimescale*1e3),t.pts=Math.floor(t.pts/e.formatTimescale*1e3)}),t.formatTims/t.formatTimescale*1e3)}),this.timeline.appendBuffer(e,t)}}},{key:"setAudioMeta",value:function(e){this._aMeta=e,this.timeline.emit(X.TIMELINE.SET_METADATA,"audio",e)}},{key:"setVideoMeta",value:function(e){(this._isLive||!this._vMeta)&&(this.timeline.emit(X.TIMELINE.SET_METADATA,"video",e),this._vMeta=e)}},{key:"setDecodeMode",value:function(e){this.setAttribute("decodeMode",e)}}{this._isLive="LIVE"===e}},{key:"endOfStream",value:function(){var e;this.currentTime&&(null===(e=this.timeline)||void 0===e||e.emit(X.TIMELINE.END_OF_STREAM))}},{key:"updateVideoPostion",value:function(){var e;null===(e=this.timeline)||void 0===e||e.emit(X.VIDEO.UPDATE_VIDEO_FILLTYPE,this.xgfillType,this.containerLayout)}},{key:"_stomEvent(e,{detail:t}))}},{key:"destroy",value:function(e){this.timeline&&(this._noSleep.destroy(),p.log(this.TAG,"call destroy"),this.timeline.emit(X.TIMELINE.DESTROY,e),this.querySelector("video")&&this.removeChild(this.querySelector("video")),this.timeline=null,this._err=null,this._noSleep=null,this._eventsBackup=[])}},{key:"updateObjectPosition",value:function(e,t){this.timeline.emit(X.VIDEO.UPDATE_VIDEO_COVER_POSITION,this.containerLayout,e,t),this._degradeVideo&&(this._degradeVideo.style.objectPosition="".concat(100*e,"% ").concat(100*t,"%"))}},{kDecode=this.videoDecode)}},{key:"live",get:function(){return this._isLive}},{key:"lowlatency",get:function(){return"true"===this.getAttribute("lowlatency")},set:function(e){this.setAttribute("lowlatency",e)}},{key:"autoplay",get:function(){return"true"===this.getAtAttribute("autoplay",e)}},{key:"__canvas",get:function(){return this.timeline.canvas}},{key:"__ended",get:function(){return .5>Math.abs(this.currentTime-this.duratwidth")||this.videoWidth},set:function(e){this.setAttribute("width","number"==typeof e?"".concat(e,"px"):e),this.canvas.widts.getAttribute("height")},set:function(e){this.setAttribute("height","number"==typeof e?"".concat(e,"px"):e),this.canvas.height=e}},{key:"__videoWidth",get:function(){return this.canvas.width}},{key:"__videoHeight",get:function(){return this.canvas.height}},{key:"__volume",get:function(){return Number(this.getAttribute("volume"))},set:function(e){e<=0&&(e=0),e>=1&&(e=1),this.setAttribute("volume",e),this.muted||this.timeline.emit(X.TIMELINE.UPDATE_VOLUME,e)}},{key:"__muted",get:function(){return"true"===this.getAttribute("muted")},set:function(e){this.setAttribute("muted",e),this._degradeVideoInteract(),this._noSleep.enable(),this.timeline.emit(X.TIMELINE.UPDATE_VOLUME,e?0:this.volume)}},{key:"__currentTime",get:function(){return this.timeline?Math.min(this.timeline.currentTime,this.timeline.duration):0},set:function(e){this._seek(e)}},{key:"_seek",value:function(e){this.timeline&&(this.buffered.length||this.play(),this.paused&&!this._isLive&&e<1&&this.play(),this.timeline.seek(Number(e))0:thhEvent("durationchange")}},{key:"__seeking",get:function(){return this.timeline.seeking}},{key:"__paused",get:function(){return this.timeline.paused}},{key:"__fps",get:function(){return this.timeline.fps}},{key:"__decodeFps",get:function(){return this.timeline.decodeFps}his.timeline.decodeCost)}},{key:"__renderCost",get:function(){return this.timeline.renderCost}},{key:"__wasmInitCost",get:function(){return this.timeline.wasmInitCost}},{key:"__totalSize",get:function(){return this.timeline.totalSize}},{key:"__bitrate",get:function(){return this.timeline.bitrate}},{key:"__gopLength",get:function(){return this.timeline.gopLength}},{key:"__readyState",get:function(){return this.timeline.readyState}},{key:"__buffered",get:function(){return this.timeline.buffered}},{key:"__decoderMode",get:function(){return this.timeline.decoderMode}},{key:"src",get:function(){var e;return this.getAttribute("src")||(null===(e=this.childNodes[0])||void 0===e?void 0:e.src)||""},set:function(e){p.log(this.TAG,"set src ",e),this.setAttribute("src",e),this._vMeta=null,this._domConnected&&!this.buffered.length||(this.play(!0),this.timeline||this._init()),this._innerDispatchEvent("loadstart"),S++}},{key:"currentSrc",get:function(){var e;return this.getAttribute("src")||(null===(e=this.childNodes[0])||void 0===e?void 0:e.src)||""}bute("playbackrate")||1)},set:function(e){var t;this.setAttribute("playbackrate",e),null===(t=this.timeline)||void 0===t||t.emit(X.TIMELINE.SET_PLAYBACKRATE,e)}},{key:"networkState",get:function(){return 1N(t)tribute("preloadtime",e)}tribute("innerdegrade"))}},INE.UPDATE_GL_OPTIONS,e)}},{key:"__error",get:function(){return this._err},set:function(e){this.timeline.emit(X.TIMELINE.PLAY_EVENT,x.ERROR,e)}},{key:"degradeVideo",get:function(){return this._degradeVideo}},{key:"degradeInfo",get:function(){return this._deradeInfo},set:function(e){this._deradeInfo=e}},{key:"unsyncInfo",get:function(){return this._unsyncInfo},set:function(e){this._unsyncInfo=Attribute("data-xgfill")}},{h,height:e.clientHeight}tAttribute("decodeMode"oid 0===t?void 0:t.media}},{key:"audioMediaCache",get:function(){var e,t;return(null===(e=this.timeline)||void 0===e?void 0:null===(t=e.audioRender)||void 0===t?void 0:t._mediaCache)||[s.analyse.getStats(this)}},{key:"getSeekElapses",value:function(){return this.analyse.seekElapses()}},{keUse=!0,n.cleanDisabled()}},{key:"cleanDisabledCache",value:function(){N()}},{key:"dump",value:function(){var e=this.buffered;return Arurn[e.start(i),e.end(i)]})}}],[{key:"version",get:function(){return"0.1.6-next.24"}},{key:"init",value:function(e){var t=e.h264Url,i=e.h264AsmUrl,A=e.h265AsmUrl,r=e.h265Url,a=e.h265ThreadUrl,o=e.h265SimdUrl;n.h264Url=t||n.h264Url,n.h265Url=r||n.h265Url,n.h265AsmUrl=A||n.h265AsmUrl,n.h264AsmUrl=i||n.h264AsmUrl,n.h265ThreadUrl=a||n.h265ThreadUrl,n.h265SimdUrl=o||n.h265SimdUrl}},{key:alue:function(){return b}},{key:tor.hardwareConcurrency}}},{key:"setDecodeCapacity",value:function(e){b=Object.assign({},b,e,{offscreenCanvas:e.offscreenCanvas&&!!window.OffscreenCanvas}),e.preloadDecoder&&ev.genDecoder().catch(function(){})}},{key:"genDecoder",value:function(e){return ev.genDecoder(e)}},{ed",value:function(){N()}},{key:"isSupported",value:function(){return!!function(){if("undefined"==typeof customElements)return!1;if(V)return!0;var e=!1,t=!1;try{var i=new(window.AudioContext||window.webkitAudioContext);i.close(),i=null,e=!0}catch(e){}try{for(var A=document.createElement("canvas"),n=["webgl","experimental-webgl","moz-webgl","webkit-3d"],r=0;r<n.length;r++){var a=A.getContext(n[r]);if(a){var o=a.getExtension("WEBGL_debug_renderer_info"),s=a.getParameter(o.UNMASKED_RENDERER_WEBGL);s&&-1===s.indexOf("SwiftShader")&&-1===s.indexOf("Intel(R) HD")&&(t=!0),a=null,A=null;break}}V=e&&t&&!!WebAssembly,localStorage.setItem("_sds",V?"y":"n")}catch(e){}return V}()&&(!!n.forceCanUse||!1===function(){if(!0===(!!B||0!==b.evaluateVVCount&&(S>=b.evaluateVVCount&&(G=D/S,S=0,D=0),G>=b.disabledByLowdecodePrecent&&(B=!0),B)))return!0;try{var e=localStorage.getItem("xgv_dis");if(!e)return!1;if("1"===e)return!0;if("2"===e){var t=localStorage.getItem("xgv_dist")||0;if(t=Number(t),(new Date().getTime()-t)/1e3<b.disabledDuration)return!0;N()}if("3"===e){var i=localStorage.getItem("xgv_dist")||0;if(i=Number(i),(new Date().getTime()-i)/1e3<b.longDisabledDuration)return!0;N()}}catch(e){}}())}}]),n}("undefined"!=typeof HTMLElement?HTMLElement:function(){});(0,h.Z)(eS,"decoderCache",ev),eS.init({h264Url:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/decoder/1.1.1/h264/decoder.js",h264AsmUrl:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/decoder/1.1.1/h264/decoder_asm.js",h265Url:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/codec/base/decoder.js",h265SimdUrl:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/codec/high/decoder_1656041798666.js",h265ThreadUrl:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/codec/main/decoder.js",h265AsmUrl:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/codec/high/decoder_asm.js"}),eS.setEleName=function(e){y=e;var t=function(e){(0,o.Z)(A,e);var t,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(A);if(t){var n=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments,i.apply(this,arguments)}return A}(eS);"undefined"!=typeof customElements&&(customElements.get(y)||customElements.define(y,t))};try{"undefined"!=typeof customElements&&(customElements.get(y)||customElements.define(y,eS))}catch(e){}}}]);