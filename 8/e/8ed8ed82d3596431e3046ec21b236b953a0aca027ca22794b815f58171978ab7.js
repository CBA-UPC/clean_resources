var Ext=Ext||{};if(!Ext.Carousel){Ext.Carousel={}}if(!Ext.app){Ext.app={}}if(!Ext.behavior){Ext.behavior={}}if(!Ext.carousel){Ext.carousel={}}if(!Ext.data){Ext.data={}}if(!Ext.data.association){Ext.data.association={}}if(!Ext.data.identifier){Ext.data.identifier={}}if(!Ext.data.proxy){Ext.data.proxy={}}if(!Ext.data.reader){Ext.data.reader={}}if(!Ext.data.writer){Ext.data.writer={}}if(!Ext.device){Ext.device={}}if(!Ext.device.communicator){Ext.device.communicator={}}if(!Ext.device.connection){Ext.device.connection={}}if(!Ext.dom){Ext.dom={}}if(!Ext.env){Ext.env={}}if(!Ext.event){Ext.event={}}if(!Ext.event.publisher){Ext.event.publisher={}}if(!Ext.event.recognizer){Ext.event.recognizer={}}if(!Ext.field){Ext.field={}}if(!Ext.form){Ext.form={}}if(!Ext.fx){Ext.fx={}}if(!Ext.fx.animation){Ext.fx.animation={}}if(!Ext.fx.easing){Ext.fx.easing={}}if(!Ext.fx.layout){Ext.fx.layout={}}if(!Ext.fx.layout.card){Ext.fx.layout.card={}}if(!Ext.fx.runner){Ext.fx.runner={}}if(!Ext.layout){Ext.layout={}}if(!Ext.layout.wrapper){Ext.layout.wrapper={}}if(!Ext.lib){Ext.lib={}}if(!Ext.log){Ext.log={}}if(!Ext.log.formatter){Ext.log.formatter={}}if(!Ext.log.writer){Ext.log.writer={}}if(!Ext.mixin){Ext.mixin={}}if(!Ext.proxy){Ext.proxy={}}if(!Ext.scroll){Ext.scroll={}}if(!Ext.scroll.indicator){Ext.scroll.indicator={}}if(!Ext.slider){Ext.slider={}}if(!Ext.util){Ext.util={}}if(!Ext.util.paintmonitor){Ext.util.paintmonitor={}}if(!Ext.util.sizemonitor){Ext.util.sizemonitor={}}if(!Ext.util.translatable){Ext.util.translatable={}}if(!Ext.viewport){Ext.viewport={}}var InfinityMobile=InfinityMobile||{};if(!InfinityMobile.controller){InfinityMobile.controller={}}if(!InfinityMobile.model){InfinityMobile.model={}}if(!InfinityMobile.profile){InfinityMobile.profile={}}if(!InfinityMobile.store){InfinityMobile.store={}}if(!InfinityMobile.util){InfinityMobile.util={}}if(!InfinityMobile.view){InfinityMobile.view={}}if(!InfinityMobile.view.desktop){InfinityMobile.view.desktop={}}if(!InfinityMobile.view.phone){InfinityMobile.view.phone={}}if(!InfinityMobile.view.tablet){InfinityMobile.view.tablet={}}(Ext.cmd={}));(();(();Ext.String={trimRegex:/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,escapeRe:/('|\\)/g,formatRe:/\{(\d+)\}/g,escapeRegexRe:/([-.*+?^${}()|[\]\/\\])/g,htmlEncode:((),htmlDecode:((),urlAppend:trim:function(a){return a.replace(Ext.String.trimRegex,"")},capitalize:ellipsis:escapeRegex:function(a){return a.replace(Ext.String.escapeRegexRe,"\\$1")},escape:toggle:leftPad:function(b,c,d){var a=String(b);d=d||" ";while(a.length<c){a=d+a}return a},format:repeat:;Ext.htmlEncode=Ext.String.htmlEncode;Ext.htmlDecode=Ext.String.htmlDecode;Ext.urlAppend=Ext.String.urlAppend;(();(();Ext.num=(();Ext.Function={flexSetter:bind:pass:alias:clone:createInterceptor:createDelayed:defer:createSequence:createBuffered:createThrottled:interceptBefore:interceptAfter:;Ext.defer=Ext.Function.alias(Ext.Function,"defer");Ext.pass=Ext.Function.alias(Ext.Function,"pass");Ext.bind=Ext.Function.alias(Ext.Function,"bind");Ext.JSON=new (();if(!Ext.util){Ext.util={}}Ext.util.JSON=Ext.JSON;Ext.encode=Ext.JSON.encode;Ext.decode=Ext.JSON.decode;Ext.Error={raise:;Ext.Date={now:Date.now,toString:;((Ext.Function.flexSetter);(();((Ext.Class,Ext.Function.alias,Array.prototype.slice,Ext.Array.from,Ext.global);((Ext.ClassManager,Ext.Class,Ext.Function.flexSetter,Ext.Function.alias,Ext.Function.pass,Ext.Array.from,Ext.Array.erase,Ext.Array.include);(();Ext.setVersion("touch","2.4.0.487");Ext.apply(Ext,{version:Ext.getVersion("touch"),idSeed:0,repaint:id:getBody:getHead:getDoc:getCmp:function(a){return Ext.ComponentMgr.get(a)},copyTo:destroy:getDom:removeNode:defaultSetupConfig:{eventPublishers:{dom:{xclass:"Ext.event.publisher.Dom"},touchGesture:{xclass:"Ext.event.publisher.TouchGesture",recognizers:{drag:{xclass:"Ext.event.recognizer.Drag"},tap:{xclass:"Ext.event.recognizer.Tap"},doubleTap:{xclass:"Ext.event.recognizer.DoubleTap"},longPress:{xclass:"Ext.event.recognizer.LongPress"},swipe:{xclass:"Ext.event.recognizer.Swipe"},pinch:{xclass:"Ext.event.recognizer.Pinch"},rotate:{xclass:"Ext.event.recognizer.Rotate"},edgeSwipe:{xclass:"Ext.event.recognizer.EdgeSwipe"}}},componentDelegation:{xclass:"Ext.event.publisher.ComponentDelegation"},componentPaint:{xclass:"Ext.event.publisher.ComponentPaint"},elementPaint:{xclass:"Ext.event.publisher.ElementPaint"},elementSize:{xclass:"Ext.event.publisher.ElementSize"}},logger:{enabled:true,xclass:"Ext.log.Logger",minPriority:"deprecate",writers:{console:{xclass:"Ext.log.writer.Console",throwOnErrors:true,formatter:{xclass:"Ext.log.formatter.Default"}}}},animator:{xclass:"Ext.fx.Runner"},viewport:{xclass:"Ext.viewport.Viewport"}},isSetup:false,frameStartTime:+new Date(),setupListeners:[],onSetup:setup:application:factoryConfig:factory:deprecateClassMember:deprecateClassMembers:deprecateProperty:deprecatePropertyValue:deprecateMethod:deprecateClassMethod:isReady:false,readyListeners:[],triggerReady:onDocumentReady:callback:);(Ext.cmd.derive("Ext.env.Browser",Ext.Base,{statics:{browserNames:{ie:"IE",firefox:"Firefox",safari:"Safari",chrome:"Chrome",opera:"Opera",dolfin:"Dolfin",webosbrowser:"webOSBrowser",chromeMobile:"ChromeMobile",chromeiOS:"ChromeiOS",silk:"Silk",other:"Other"},engineNames:{webkit:"WebKit",gecko:"Gecko",presto:"Presto",trident:"Trident",other:"Other"},enginePrefixes:{webkit:"AppleWebKit/",gecko:"Gecko/",presto:"Presto/",trident:"Trident/"},browserPrefixes:{ie:"MSIE ",firefox:"Firefox/",chrome:"Chrome/",safari:"Version/",opera:"OPR/",dolfin:"Dolfin/",webosbrowser:"wOSBrowser/",chromeMobile:"CrMo/",chromeiOS:"CriOS/",silk:"Silk/"}},styleDashPrefixes:{WebKit:"-webkit-",Gecko:"-moz-",Trident:"-ms-",Presto:"-o-",Other:""},stylePrefixes:{WebKit:"Webkit",Gecko:"Moz",Trident:"ms",Presto:"O",Other:""},propertyPrefixes:{WebKit:"webkit",Gecko:"moz",Trident:"ms",Presto:"o",Other:""},is:Ext.emptyFn,name:null,version:null,engineName:null,engineVersion:null,setFlag:function(a,b){if(typeof b=="undefined"){b=true}this.is[a]=b;this.is[a.toLowerCase()]=b;return this},constructor:function(p){this.userAgent=p;var l=this.statics(),c=p.match(new RegExp("((?:"+Ext.Object.getValues(l.browserPrefixes).join(")|(?:")+"))([\\w\\._]+)")),b=p.match(new RegExp("((?:"+Ext.Object.getValues(l.enginePrefixes).join(")|(?:")+"))([\\w\\._]+)")),g=l.browserNames,k=g.other,f=l.engineNames,o=f.other,n="",m="",h=false,e,d,a;e=this.is=if(c){k=g[Ext.Object.getKey(l.browserPrefixes,c[1])];n=new Ext.Version(c[2])}if(b){o=f[Ext.Object.getKey(l.enginePrefixes,b[1])];m=new Ext.Version(b[2])}if(o=="Trident"&&k!="IE"){k="IE";var j=p.match(/.*rv:(\d+.\d+)/);if(j&&j.length){j=j[1];n=new Ext.Version(j)}}if(p.match(/FB/)&&k==="Other"){k=g.safari;o=f.webkit}else{if(p.match(/Android.*Chrome/g)){k="ChromeMobile"}else{c=p.match(/OPR\/(\d+.\d+)/);if(c){k="Opera";n=new Ext.Version(c[1])}}}if(k==="Safari"&&p.match(/BB10/)){k="BlackBerry"}Ext.apply(this,{engineName:o,engineVersion:m,name:k,version:n});this.setFlag(k);if(n){this.setFlag(k+(n.getMajor()||""));this.setFlag(k+n.getShortVersion())}for(d in g){if(g.hasOwnProperty(d)){a=g[d];this.setFlag(a,k===a)}}this.setFlag(a);if(m){this.setFlag(o+(m.getMajor()||""));this.setFlag(o+m.getShortVersion())}for(d in f){if(f.hasOwnProperty(d)){a=f[d];this.setFlag(a,o===a)}}this.setFlag("Standalone",!!navigator.standalone);this.setFlag("Ripple",!!document.getElementById("tinyhippos-injected")&&!Ext.isEmpty(window.top.ripple));this.setFlag("WebWorks",!!window.blackberry);if(typeof window.PhoneGap!="undefined"||typeof window.Cordova!="undefined"||typeof window.cordova!="undefined"){h=true;this.setFlag("PhoneGap");this.setFlag("Cordova")}else{if(!!window.isNK){h=true;this.setFlag("Sencha")}}if(/(Glass)/i.test(p)){this.setFlag("GoogleGlass")}if(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)(?!.*FBAN)/i.test(p)){h=true}this.setFlag("WebView",h);this.isStrict=document.compatMode=="CSS1Compat";this.isSecure=/^https/i.test(window.location.protocol);return this},getStyleDashPrefix:function(){return this.styleDashPrefixes[this.engineName]},getStylePrefix:function(){return this.stylePrefixes[this.engineName]},getVendorProperyName:getPreferredTranslationMethod:,1,0,0,0,0,0,[Ext.env,"Browser"],);(Ext.cmd.derive("Ext.env.OS",Ext.Base,{statics:{names:{ios:"iOS",android:"Android",windowsPhone:"WindowsPhone",webos:"webOS",blackberry:"BlackBerry",rimTablet:"RIMTablet",mac:"MacOS",win:"Windows",tizen:"Tizen",linux:"Linux",bada:"Bada",chrome:"ChromeOS",other:"Other"},prefixes:{tizen:"(Tizen )",ios:"i(?:Pad|Phone|Pod)(?:.*)CPU(?: iPhone)? OS ",android:"(Android |HTC_|Silk/)",windowsPhone:"Windows Phone ",blackberry:"(?:BlackBerry|BB)(?:.*)Version/",rimTablet:"RIM Tablet OS ",webos:"(?:webOS|hpwOS)/",bada:"Bada/",chrome:"CrOS "}},is:Ext.emptyFn,name:null,version:null,setFlag:constructor:,1,0,0,0,0,0,[Ext.env,"OS"],);(Ext.cmd.derive("Ext.env.Feature",Ext.Base,{constructor:getTestElement:isStyleSupported:isStyleSupportedWithoutPrefix:isEventSupported:getSupportedPropertyName:registerTest:Ext.Function.flexSetter(},1,0,0,0,0,0,[Ext.env,"Feature"],);(Ext.cmd.derive("Ext.dom.Query",Ext.Base,{select:selectNode:is:isXml:,0,0,0,0,0,0,[Ext.dom,"Query"],);(Ext.cmd.derive("Ext.dom.Helper",Ext.Base,{emptyTags:/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,confRe:/tag|children|cn|html|tpl|tplData$/i,endRe:/end/i,attribXlat:{cls:"class",htmlFor:"for"},closeTags:{},decamelizeName:),generateMarkup:generateStyles:markup:applyStyles:createContextualFragment:insertHtml:insertBefore:function(a,c,b){return this.doInsert(a,c,b,"beforebegin")},insertAfter:function(a,c,b){return this.doInsert(a,c,b,"afterend")},insertFirst:function(a,c,b){return this.doInsert(a,c,b,"afterbegin")},append:overwrite:doInsert:createTemplate:,0,0,0,0,0,0,[Ext.dom,"Helper"],);(Ext.cmd.derive("Ext.mixin.Identifiable",Ext.Base,{statics:{uniqueIds:{}},isIdentifiable:true,mixinId:"identifiable",idCleanRegex:/\.|[^\w\-]/g,defaultIdPrefix:"ext-",defaultIdSeparator:"-",getOptimizedId:function(){return this.id},getUniqueId:setId:function(a){this.id=a},getId:,0,0,0,0,0,0,[Ext.mixin,"Identifiable"],0));(Ext.cmd.derive("Ext.dom.Element",Ext.Base,{alternateClassName:"Ext.Element",observableType:"element",statics:{CREATE_ATTRIBUTES:{style:"style",className:"className",cls:"cls",classList:"classList",text:"text",hidden:"hidden",html:"html",children:"children"},create:documentElement:null,cache:{},get:data:serializeForm:serializeNode:,isElement:true,constructor:attach:getUniqueId:setId:setHtml:function(a){this.dom.innerHTML=a},getHtml:function(){return this.dom.innerHTML},setText:redraw:isPainted:((),set:is:getValue:getAttribute:setSizeState:destroy:,1,["element"],["element"],{element:true},["widget.element"],[[Ext.mixin.Identifiable.prototype.mixinId||Ext.mixin.Identifiable.$className,Ext.mixin.Identifiable]],[Ext.dom,"Element",Ext,"Element"],);Ext.dom.Element.addStatics({numberRe:/\d+$/,unitRe:/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,camelRe:/(-[a-z])/gi,cssRe:/([a-z0-9-]+)\s*:\s*([^;\s]+(?:\s*[^;\s]+)*);?/gi,opacityRe:/alpha\(opacity=(.*)\)/i,propertyCache:{},defaultUnit:"px",borders:{l:"border-left-width",r:"border-right-width",t:"border-top-width",b:"border-bottom-width"},paddings:{l:"padding-left",r:"padding-right",t:"padding-top",b:"padding-bottom"},margins:{l:"margin-left",r:"margin-right",t:"margin-top",b:"margin-bottom"},addUnits:isAncestor:parseBox:unitizeBox:camelReplaceFn:normalize:fromPoint:parseStyles:);Ext.dom.Element.addMembers({appendChild:function(a){this.dom.appendChild(Ext.getDom(a));return this},removeChild:append:appendTo:insertBefore:function(a){a=Ext.getDom(a);a.parentNode.insertBefore(this.dom,a);return this},insertAfter:insertFirst:insertSibling:replace:replaceWith:doReplaceWith:createChild:wrap:wrapAllChildren:unwrapAllChildren:unwrap:detach:insertHtml:);Ext.dom.Element.override({getX:function(){return this.getXY()[0]},getY:getXY:getOffsetsTo:setX:setY:setXY:getLeft:function(){return parseInt(this.getStyle("left"),10)||0},getRight:function(){return parseInt(this.getStyle("right"),10)||0},getTop:function(){return parseInt(this.getStyle("top"),10)||0},getBottom:translatePoints:setBox:getBox:getPageBox:);Ext.dom.Element.addMembers({WIDTH:"width",HEIGHT:"height",MIN_WIDTH:"min-width",MIN_HEIGHT:"min-height",MAX_WIDTH:"max-width",MAX_HEIGHT:"max-height",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left",VISIBILITY:1,DISPLAY:2,OFFSETS:3,SEPARATOR:"-",trimRe:/^\s+|\s+$/g,wordsRe:/\w/g,spacesRe:/\s+/,styleSplitRe:/\s*(?::|;)\s*/,transparentRe:/^(?:transparent|(?:rgba[(](?:\s*\d+\s*[,]){3}\s*0\s*[)]))$/i,classNameSplitRegex:/[\s]+/,borders:{t:"border-top-width",r:"border-right-width",b:"border-bottom-width",l:"border-left-width"},paddings:{t:"padding-top",r:"padding-right",b:"padding-bottom",l:"padding-left"},margins:{t:"margin-top",r:"margin-right",b:"margin-bottom",l:"margin-left"},defaultUnit:"px",isSynchronized:false,synchronize:addCls:removeCls:replaceCls:hasCls:setCls:toggleCls:swapCls:setWidth:function(a){return this.setLengthValue(this.WIDTH,a)},setHeight:function(a){return this.setLengthValue(this.HEIGHT,a)},setSize:setMinWidth:function(a){return this.setLengthValue(this.MIN_WIDTH,a)},setMinHeight:function(a){return this.setLengthValue(this.MIN_HEIGHT,a)},setMaxWidth:function(a){return this.setLengthValue(this.MAX_WIDTH,a)},setMaxHeight:function(a){return this.setLengthValue(this.MAX_HEIGHT,a)},setTop:function(a){return this.setLengthValue(this.TOP,a)},setRight:function(a){return this.setLengthValue(this.RIGHT,a)},setBottom:function(a){return this.setLengthValue(this.BOTTOM,a)},setLeft:setMargin:function(b){var a=this.dom.style;if(b||b===0){b=this.self.unitizeBox((b===true)?5:b);a.setProperty("margin",b,"important")}else{a.removeProperty("margin-top");a.removeProperty("margin-right");a.removeProperty("margin-bottom");a.removeProperty("margin-left")}},setPadding:function(b){var a=this.dom.style;if(b||b===0){b=this.self.unitizeBox((b===true)?5:b);a.setProperty("padding",b,"important")}else{a.removeProperty("padding-top");a.removeProperty("padding-right");a.removeProperty("padding-bottom");a.removeProperty("padding-left")}},setBorder:setLengthValue:setVisible:getVisibilityMode:setVisibilityMode:show:hide:setVisibility:styleHooks:{},addStyles:isStyle:getStyleValue:getStyle:setStyle:getHeight:function(b){var c=this.dom,a=b?(c.clientHeight-this.getPadding("tb")):c.offsetHeight;return a>0?a:0},getWidth:getBorderWidth:function(a){return this.addStyles(a,this.borders)},getPadding:applyStyles:getSize:repaint:getMargin:translate:)});Ext.dom.Element.addMembers({getParent:function(){return Ext.get(this.dom.parentNode)},getFirstChild:contains:findParent:findParentNode:up:select:query:down:child:parent:function(a,b){return this.matchNode("parentNode","parentNode",a,b)},next:function(a,b){return this.matchNode("nextSibling","nextSibling",a,b)},prev:function(a,b){return this.matchNode("previousSibling","previousSibling",a,b)},first:function(a,b){return this.matchNode("nextSibling","firstChild",a,b)},last:matchNode:isAncestor:);(Ext.cmd.derive("Ext.dom.CompositeElementLite",Ext.Base,{alternateClassName:["Ext.CompositeElementLite","Ext.CompositeElement"],statics:{importElementMethods:function(){}},constructor:isComposite:true,getElement:transformElement:function(a){return Ext.getDom(a)},getCount:function(){return this.elements.length},add:invoke:item:addListener:each:fill:filter:indexOf:replaceElement:clear:addElements:first:function(){return this.item(0)},last:contains:removeElement:,1,0,0,0,0,0,[Ext.dom,"CompositeElementLite",Ext,"CompositeElementLite",Ext,"CompositeElement"],);(Ext.cmd.derive("Ext.event.ListenerStack",Ext.Base,{currentOrder:"current",length:0,constructor:add:getAt:getAll:count:create:remove:,1,0,0,0,0,0,[Ext.event,"ListenerStack"],0));(Ext.cmd.derive("Ext.event.Controller",Ext.Base,{isFiring:false,listenerStack:null,constructor:setInfo:function(a){this.info=a},getInfo:function(){return this.info},setListenerStacks:function(a){this.listenerStacks=a},fire:doFire:connect:resume:isInterrupted:stop:pause:,1,0,0,0,0,0,[Ext.event,"Controller"],0));(Ext.cmd.derive("Ext.event.Dispatcher",Ext.Base,{statics:{getInstance:setInstance:function(a){this.instance=a;return this}},config:{publishers:{}},wildcard:"*",constructor:getListenerStack:getController:applyPublishers:registerPublisher:getCachedActivePublishers:cacheActivePublishers:getActivePublishers:hasListener:addListener:function(e,f,b){var g=this.getActivePublishers(e,b),d=g.length,c,a;a=this.doAddListener.apply(this,arguments);if(a&&d>0){for(c=0;c<d;c++){g[c].subscribe(f,b)}}return a},doAddListener:removeListener:doRemoveListener:clearListeners:dispatchEvent:doDispatchEvent:getWildcardListenerStacks:getPublisher:,1,0,0,0,0,0,[Ext.event,"Dispatcher"],0));(Ext.cmd.derive("Ext.mixin.Mixin",Ext.Base,{onClassExtended:,0,0,0,0,0,0,[Ext.mixin,"Mixin"],0));(Ext.cmd.derive("Ext.mixin.Observable",Ext.mixin.Mixin,{mixinConfig:{id:"observable",hooks:{destroy:"destroy"}},alternateClassName:"Ext.util.Observable",isObservable:true,observableType:"observable",validIdRegex:/^([\w\-]+)$/,observableIdPrefix:"#",listenerOptionsRegex:/^(?:delegate|single|delay|buffer|args|prepend)$/,eventFiringSuspended:false,config:{listeners:null,bubbleEvents:null},constructor:function(a){this.initConfig(a)},applyListeners:function(a){if(a){this.addListener(a)}},applyBubbleEvents:getOptimizedObservableId:function(){return this.observableId},getObservableId:getOptimizedEventDispatcher:function(){return this.eventDispatcher},getEventDispatcher:getManagedListeners:getUsedSelectors:fireEvent:fireAction:doFireEvent:doAddListener:addDispatcherListener:doRemoveListener:removeDispatcherListener:clearManagedListeners:changeListener:addListener:function(b,e,d,c,a){return this.changeListener(this.doAddListener,b,e,d,c,a)},toggleListener:addBeforeListener:function(a,d,c,b){return this.addListener(a,d,c,b,"before")},addAfterListener:function(a,d,c,b){return this.addListener(a,d,c,b,"after")},removeListener:removeBeforeListener:function(a,d,c,b){return this.removeListener(a,d,c,b,"before")},removeAfterListener:clearListeners:hasListener:suspendEvents:function(){this.eventFiringSuspended=true},resumeEvents:relayEvents:relayEvent:createEventRelayer:enableBubble:createEventBubbler:getBubbleTarget:function(){return false},destroy:addEvents:Ext.emptyFn},1,0,0,0,0,[[Ext.mixin.Identifiable.prototype.mixinId||Ext.mixin.Identifiable.$className,Ext.mixin.Identifiable]],[Ext.mixin,"Observable",Ext.util,"Observable"],);(Ext.cmd.derive("Ext.Evented",Ext.Base,{alternateClassName:"Ext.EventedBase",statics:{generateSetter:,initialized:false,constructor:initialize:doSet:onClassExtended:,1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext,"Evented",Ext,"EventedBase"],0));(Ext.cmd.derive("Ext.AbstractComponent",Ext.Evented,{onClassExtended:getElementConfig:Ext.emptyFn,referenceAttributeName:"reference",referenceSelector:"[reference]",addReferenceNode:initElement:,0,0,0,0,0,0,[Ext,"AbstractComponent"],0));(Ext.cmd.derive("Ext.util.HashMap",Ext.Base,{constructor:getCount:function(){return this.length},getData:getKey:add:replace:remove:removeByKey:get:function(a){return this.map[a]},clear:containsKey:function(a){return this.map[a]!==undefined},contains:getKeys:function(){return this.getArray(true)},getValues:function(){return this.getArray(false)},getArray:each:clone:findKey:,1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.util,"HashMap"],0));(Ext.cmd.derive("Ext.AbstractManager",Ext.Base,{typeName:"type",constructor:get:function(a){return this.all.get(a)},register:function(a){this.all.add(a)},unregister:function(a){this.all.remove(a)},registerType:isRegistered:function(a){return this.types[a]!==undefined},create:onAvailable:each:getCount:function(){return this.all.getCount()}},1,0,0,0,0,0,[Ext,"AbstractManager"],0));(Ext.cmd.derive("Ext.mixin.Traversable",Ext.mixin.Mixin,{mixinConfig:{id:"traversable"},setParent:hasParent:getParent:function(){return this.parent},getAncestors:getAncestorIds:,0,0,0,0,0,0,[Ext.mixin,"Traversable"],0));(Ext.cmd.derive("Ext.ComponentManager",Ext.Base,{alternateClassName:"Ext.ComponentMgr",singleton:true,constructor:register:unregister:isRegistered:get:function(a){return this.map[a]},create:registerType:Ext.emptyFn},1,0,0,0,0,0,[Ext,"ComponentManager",Ext,"ComponentMgr"],0));(();(Ext.cmd.derive("Ext.util.Format",Ext.Base,{singleton:true,defaultDateFormat:"m/d/Y",escapeRe:/('|\\)/g,trimRe:/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,formatRe:/\{(\d+)\}/g,escapeRegexRe:/([-.*+?^${}()|[\]\/\\])/g,dashesRe:/-/g,iso8601TestRe:/\d\dT\d\d/,iso8601SplitRe:/[- :T\.Z\+]/,ellipsis:escapeRegex:function(a){return a.replace(Ext.util.Format.escapeRegexRe,"\\$1")},escape:function(a){return a.replace(Ext.util.Format.escapeRe,"\\$1")},toggle:trim:leftPad:format:htmlEncode:function(a){return !a?a:String(a).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},htmlDecode:date:,0,0,0,0,0,0,[Ext.util,"Format"],0));(Ext.cmd.derive("Ext.Template",Ext.Base,{inheritableStatics:{from:,constructor:isTemplate:true,disableFormats:false,re:/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,apply:applyOut:applyTemplate:set:compileARe:/\\/g,compileBRe:/(\r\n|\n)/g,compileCRe:/'/g,compile:insertFirst:function(b,a,c){return this.doInsert("afterBegin",b,a,c)},insertBefore:function(b,a,c){return this.doInsert("beforeBegin",b,a,c)},insertAfter:function(b,a,c){return this.doInsert("afterEnd",b,a,c)},append:doInsert:overwrite:,1,0,0,0,0,0,[Ext,"Template"],0));(Ext.cmd.derive("Ext.XTemplateParser",Ext.Base,{constructor:doTpl:Ext.emptyFn,parse:topRe:/(?:(\{\%)|(\{\[)|\{([^{}]*)\})|(?:<tpl([^>]*)\>)|(?:<\/tpl>)/g,actionsRe:/\s*(elif|elseif|if|for|exec|switch|case|eval)\s*\=\s*(?:(?:"([^"]*)")|(?:'([^']*)'))\s*/g,propRe:/prop=(?:(?:"([^"]*)")|(?:'([^']*)'))/,defaultRe:/^\s*default\s*$/,elseRe:/^\s*else\s*$/},1,0,0,0,0,0,[Ext,"XTemplateParser"],0));(Ext.cmd.derive("Ext.XTemplateCompiler",Ext.XTemplateParser,{useEval:Ext.isGecko,useIndex:Ext.isIE6||Ext.isIE7,useFormat:true,propNameRe:/^[\w\d\$]*$/,compile:generate:doText:doExpr:doTag:doElse:doEval:doIf:function(b,c){var a=this;if(b==="."){a.body.push("if (values) {\n")}else{if(a.propNameRe.test(b)){a.body.push("if (",a.parseTag(b),") {\n")}else{a.body.push("if (",a.addFn(b),a.callFn,") {\n")}}if(c.exec){a.doExec(c.exec)}},doElseIf:doSwitch:doCase:doDefault:doEnd:doFor:createArrayTest:("isArray" in Array)?function(a){return"Array.isArray(c"+a+")"}:doExec:addFn:parseTag:evalTpl:newLineRe:/\r\n|\r|\n/g,aposRe:/[']/g,intRe:/^\s*(\d+)\s*$/,tagRe:/([\w-\.\#\$]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\/]\s?[\d\.\+\-\*\/\(\)]+)?/},0,0,0,0,0,0,[Ext,"XTemplateCompiler"],);(Ext.cmd.derive("Ext.XTemplate",Ext.Template,{emptyObj:{},apply:applyOut:compile:statics:{getTpl:},0,0,0,0,0,0,[Ext,"XTemplate"],0));(Ext.cmd.derive("Ext.behavior.Behavior",Ext.Base,{constructor:onComponentDestroy:Ext.emptyFn},1,0,0,0,0,0,[Ext.behavior,"Behavior"],0));(Ext.cmd.derive("Ext.fx.easing.Abstract",Ext.Base,{config:{startTime:0,startValue:0},isEasing:true,isEnded:false,constructor:applyStartTime:updateStartTime:reset:getValue:Ext.emptyFn},1,0,0,0,0,0,[Ext.fx.easing,"Abstract"],0));(Ext.cmd.derive("Ext.fx.easing.Linear",Ext.fx.easing.Abstract,{config:{duration:0,endValue:0},updateStartValue:updateEndValue:getValue:,0,0,0,0,["easing.linear"],0,[Ext.fx.easing,"Linear"],0));(Ext.cmd.derive("Ext.util.translatable.Abstract",Ext.Evented,{config:{useWrapper:null,easing:null,easingX:null,easingY:null},x:0,y:0,activeEasingX:null,activeEasingY:null,isAnimating:false,isTranslatable:true,constructor:function(a){this.initConfig(a)},factoryEasing:applyEasing:applyEasingX:function(a){return this.factoryEasing(a)},applyEasingY:doTranslate:Ext.emptyFn,translate:translateAxis:animate:translateAnimated:doAnimationFrame:stopAnimation:refresh:destroy:,1,0,0,0,0,0,[Ext.util.translatable,"Abstract"],0));(Ext.cmd.derive("Ext.util.translatable.Dom",Ext.util.translatable.Abstract,{config:{element:null},applyElement:function(a){if(!a){return}return Ext.get(a)},updateElement:function(){this.refresh()}},0,0,0,0,0,0,[Ext.util.translatable,"Dom"],0));(Ext.cmd.derive("Ext.util.translatable.CssTransform",Ext.util.translatable.Dom,{doTranslate:destroy:,0,0,0,0,0,0,[Ext.util.translatable,"CssTransform"],0));(Ext.cmd.derive("Ext.util.translatable.ScrollPosition",Ext.util.translatable.Dom,{type:"scrollposition",config:{useWrapper:true},getWrapper:doTranslate:destroy:,0,0,0,0,0,0,[Ext.util.translatable,"ScrollPosition"],0));(Ext.cmd.derive("Ext.util.translatable.CssPosition",Ext.util.translatable.Dom,{doTranslate:destroy:,0,0,0,0,0,0,[Ext.util.translatable,"CssPosition"],0));(Ext.cmd.derive("Ext.util.Translatable",Ext.Base,{constructor:,1,0,0,0,0,0,[Ext.util,"Translatable"],0));(Ext.cmd.derive("Ext.behavior.Translatable",Ext.behavior.Behavior,{setConfig:getTranslatable:function(){return this.translatable},onTranslatableDestroy:function(){delete this.translatable},onComponentDestroy:function(){var a=this.translatable;if(a){a.destroy()}}},0,0,0,0,0,0,[Ext.behavior,"Translatable"],0));(Ext.cmd.derive("Ext.util.Draggable",Ext.Base,{isDraggable:true,config:{cls:"x-draggable",draggingCls:"x-dragging",element:null,constraint:"container",disabled:null,direction:"both",initialOffset:{x:0,y:0},translatable:{}},DIRECTION_BOTH:"both",DIRECTION_VERTICAL:"vertical",DIRECTION_HORIZONTAL:"horizontal",defaultConstraint:{min:{x:-Infinity,y:-Infinity},max:{x:Infinity,y:Infinity}},containerWidth:0,containerHeight:0,width:0,height:0,constructor:applyElement:updateElement:updateInitialOffset:updateCls:applyTranslatable:setExtraConstraint:addExtraConstraint:applyConstraint:updateConstraint:getContainerConstraint:getContainer:onElementResize:function(a,b){this.width=b.width;this.height=b.height;this.refresh()},onContainerResize:onContainerDestroy:detachListeners:isAxisEnabled:onPress:function(a){this.fireAction("touchstart",[this,a])},onRelease:onDragStart:initDragStart:onDrag:doDrag:onDragEnd:setOffset:getOffset:function(){return this.offset},refreshConstraint:function(){this.setConstraint(this.currentConstraint)},refreshOffset:refresh:enable:function(){return this.setDisabled(false)},disable:destroy:,1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.util,"Draggable"],function(){}));(Ext.cmd.derive("Ext.behavior.Draggable",Ext.behavior.Behavior,{setConfig:getDraggable:function(){return this.draggable},onDraggableDestroy:onComponentDestroy:,0,0,0,0,0,0,[Ext.behavior,"Draggable"],0));(("x-");(Ext.cmd.derive("Ext.layout.Abstract",Ext.Base,{isLayout:true,constructor:function(a){this.initialConfig=a},setContainer:onItemAdd:function(){},onItemRemove:function(){},onItemMove:function(){},onItemCenteredChange:function(){},onItemFloatingChange:function(){},onItemDockedChange:function(){},onItemInnerStateChange:function(){}},1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.layout,"Abstract"],0));(Ext.cmd.derive("Ext.mixin.Bindable",Ext.mixin.Mixin,{mixinConfig:{id:"bindable"},bind:unbind:,0,0,0,0,0,0,[Ext.mixin,"Bindable"],0));(Ext.cmd.derive("Ext.util.Wrapper",Ext.Base,{constructor:bindSize:onBoundSizeChange:wrap:destroy:,1,0,0,0,0,[[Ext.mixin.Bindable.prototype.mixinId||Ext.mixin.Bindable.$className,Ext.mixin.Bindable]],[Ext.util,"Wrapper"],0));(Ext.cmd.derive("Ext.layout.wrapper.BoxDock",Ext.Base,{config:{direction:"horizontal",element:{className:"x-dock"},bodyElement:{className:"x-dock-body"},innerWrapper:null,sizeState:false,container:null},positionMap:{top:"start",left:"start",bottom:"end",right:"end"},constructor:function(a){this.items={start:[],end:[]};this.itemsCount=0;this.initConfig(a)},addItems:function(a){var b,d,c;for(b=0,d=a.length;b<d;b++){c=a[b];this.addItem(c)}},addItem:removeItem:getItemsSlice:function(c){var a=this.getContainer(),b=this.items,h=[],g,d,f,e;for(g=b.start,d=0,f=g.length;d<f;d++){e=g[d];if(a.indexOf(e)>c){h.push(e)}}for(g=b.end,d=0,f=g.length;d<f;d++){e=g[d];if(a.indexOf(e)>c){h.push(e)}}return h},applyElement:function(a){return Ext.Element.create(a)},updateElement:function(a){a.addCls("x-dock-"+this.getDirection())},applyBodyElement:function(a){return Ext.Element.create(a)},updateBodyElement:function(a){this.getElement().append(a)},updateInnerWrapper:updateSizeState:function(b){var a=this.getInnerWrapper();this.getElement().setSizeState(b);if(a){a.setSizeState(b)}},destroy:,1,0,0,0,0,0,[Ext.layout.wrapper,"BoxDock"],0));(Ext.cmd.derive("Ext.layout.wrapper.Inner",Ext.Base,{config:{sizeState:null,container:null},constructor:function(a){this.initConfig(a)},getElement:setInnerWrapper:Ext.emptyFn,getInnerWrapper:Ext.emptyFn},1,0,0,0,0,0,[Ext.layout.wrapper,"Inner"],0));(Ext.cmd.derive("Ext.layout.Default",Ext.layout.Abstract,{isAuto:true,config:{animation:null},centerWrapperClass:"x-center",dockWrapperClass:"x-dock",positionMap:{top:"start",left:"start",middle:"center",bottom:"end",right:"end"},positionDirectionMap:{top:"vertical",bottom:"vertical",left:"horizontal",right:"horizontal"},setContainer:monitorSizeStateChange:function(){this.monitorSizeStateChange=Ext.emptyFn;this.container.on("sizestatechange","onContainerSizeStateChange",this)},monitorSizeFlagsChange:onItemAdd:onItemInnerStateChange:insertInnerItem:insertBodyItem:removeInnerItem:function(a){a.element.detach()},removeBodyItem:onItemRemove:onItemMove:onItemCenteredChange:onItemFloatingChange:onBeforeItemDockedChange:function(a,c,b){if(b){this.undockItem(a)}},onAfterItemDockedChange:onContainerSizeStateChange:onContainerSizeFlagsChange:refreshDockedItemLayoutSizeFlags:dockItem:getDockWrapper:undockItem:destroy:,0,0,0,0,["layout.auto","layout.default"],0,[Ext.layout,"Default"],0));(Ext.cmd.derive("Ext.layout.Box",Ext.layout.Default,{config:{orient:"horizontal",align:"start",pack:"start"},layoutBaseClass:"x-layout-tablebox",itemClass:"x-layout-tablebox-item",setContainer:onItemInnerStateChange:function(b,a){Ext.layout.Default.prototype.onItemInnerStateChange.apply(this,arguments);b.toggleCls(this.itemClass,a)},onItemFlexChange:function(){}},0,0,0,0,["layout.tablebox"],0,[Ext.layout,"Box"],0));(Ext.cmd.derive("Ext.fx.layout.card.Abstract",Ext.Evented,{isAnimation:true,config:{direction:"left",duration:null,reverse:null,layout:null},updateLayout:function(){this.enable()},enable:disable:onActiveItemChange:Ext.emptyFn,destroy:,0,0,0,0,0,0,[Ext.fx.layout.card,"Abstract"],0));(Ext.cmd.derive("Ext.fx.State",Ext.Base,{isAnimatable:{"background-color":true,"background-image":true,"background-position":true,"border-bottom-color":true,"border-bottom-width":true,"border-color":true,"border-left-color":true,"border-left-width":true,"border-right-color":true,"border-right-width":true,"border-spacing":true,"border-top-color":true,"border-top-width":true,"border-width":true,bottom:true,color:true,crop:true,"font-size":true,"font-weight":true,height:true,left:true,"letter-spacing":true,"line-height":true,"margin-bottom":true,"margin-left":true,"margin-right":true,"margin-top":true,"max-height":true,"max-width":true,"min-height":true,"min-width":true,opacity:true,"outline-color":true,"outline-offset":true,"outline-width":true,"padding-bottom":true,"padding-left":true,"padding-right":true,"padding-top":true,right:true,"text-indent":true,"text-shadow":true,top:true,"vertical-align":true,visibility:true,width:true,"word-spacing":true,"z-index":true,zoom:true,transform:true},constructor:setConfig:function(a){this.set(a);return this},setRaw:function(a){this.data=a;return this},clear:setTransform:set:unset:getData:function(){return this.data}},1,0,0,0,0,0,[Ext.fx,"State"],0));(Ext.cmd.derive("Ext.fx.animation.Abstract",Ext.Evented,{isAnimation:true,config:{name:"",element:null,before:null,from:{},to:{},after:null,states:{},duration:300,easing:"linear",iteration:1,direction:"normal",delay:0,onBeforeStart:null,onEnd:null,onBeforeEnd:null,scope:null,reverse:null,preserveEndState:false,replacePrevious:true},STATE_FROM:"0%",STATE_TO:"100%",DIRECTION_UP:"up",DIRECTION_DOWN:"down",DIRECTION_LEFT:"left",DIRECTION_RIGHT:"right",stateNameRegex:/^(?:[\d\.]+)%$/,constructor:applyElement:function(a){return Ext.get(a)},applyBefore:function(a,b){if(a){return Ext.factory(a,Ext.fx.State,b)}},applyAfter:setFrom:function(a){return this.setState(this.STATE_FROM,a)},setTo:function(a){return this.setState(this.STATE_TO,a)},getFrom:function(){return this.getState(this.STATE_FROM)},getTo:setStates:getStates:function(){return this.states},stop:function(){this.fireEvent("stop",this)},destroy:setState:getState:function(a){return this.getStates()[a]},getData:,1,0,0,0,0,0,[Ext.fx.animation,"Abstract"],0));(Ext.cmd.derive("Ext.fx.animation.Slide",Ext.fx.animation.Abstract,{alternateClassName:"Ext.fx.animation.SlideIn",config:{direction:"left",out:false,offset:0,easing:"auto",containerBox:"auto",elementBox:"auto",isElementBoxFit:true,useCssTransform:true},reverseDirectionMap:{up:"down",down:"up",left:"right",right:"left"},applyEasing:getContainerBox:getElementBox:getData:,0,0,0,0,["animation.slide","animation.slideIn"],0,[Ext.fx.animation,"Slide",Ext.fx.animation,"SlideIn"],0));(Ext.cmd.derive("Ext.fx.animation.SlideOut",Ext.fx.animation.Slide,{config:{out:true}},0,0,0,0,["animation.slideOut"],0,[Ext.fx.animation,"SlideOut"],0));(Ext.cmd.derive("Ext.fx.animation.Fade",Ext.fx.animation.Abstract,{alternateClassName:"Ext.fx.animation.FadeIn",config:{out:false,before:{display:null,opacity:0},after:{opacity:null},reverse:null},updateOut:,0,0,0,0,["animation.fade","animation.fadeIn"],0,[Ext.fx.animation,"Fade",Ext.fx.animation,"FadeIn"],0));(Ext.cmd.derive("Ext.fx.animation.FadeOut",Ext.fx.animation.Fade,{config:{out:true,before:{}}},0,0,0,0,["animation.fadeOut"],0,[Ext.fx.animation,"FadeOut"],0));(Ext.cmd.derive("Ext.fx.animation.Flip",Ext.fx.animation.Abstract,{config:{easing:"ease-in",direction:"right",half:false,out:null},getData:,0,0,0,0,["animation.flip"],0,[Ext.fx.animation,"Flip"],0));(Ext.cmd.derive("Ext.fx.animation.Pop",Ext.fx.animation.Abstract,{alternateClassName:"Ext.fx.animation.PopIn",config:{out:false,before:{display:null,opacity:0},after:{opacity:null}},getData:,0,0,0,0,["animation.pop","animation.popIn"],0,[Ext.fx.animation,"Pop",Ext.fx.animation,"PopIn"],0));(Ext.cmd.derive("Ext.fx.animation.PopOut",Ext.fx.animation.Pop,{config:{out:true,before:{}}},0,0,0,0,["animation.popOut"],0,[Ext.fx.animation,"PopOut"],0));(Ext.cmd.derive("Ext.fx.Animation",Ext.Base,{constructor:,1,0,0,0,0,0,[Ext.fx,"Animation"],0));(Ext.cmd.derive("Ext.fx.layout.card.Style",Ext.fx.layout.card.Abstract,{config:{inAnimation:{before:{visibility:null},preserveEndState:false,replacePrevious:true},outAnimation:{preserveEndState:false,replacePrevious:true}},constructor:updateDirection:function(a){this.getInAnimation().setDirection(a);this.getOutAnimation().setDirection(a)},updateDuration:function(a){this.getInAnimation().setDuration(a);this.getOutAnimation().setDuration(a)},updateReverse:function(a){this.getInAnimation().setReverse(a);this.getOutAnimation().setReverse(a)},incrementEnd:applyInAnimation:function(b,a){return Ext.factory(b,Ext.fx.Animation,a)},applyOutAnimation:function(b,a){return Ext.factory(b,Ext.fx.Animation,a)},updateInAnimation:function(a){a.setScope(this)},updateOutAnimation:onActiveItemChange:destroy:,1,0,0,0,0,0,[Ext.fx.layout.card,"Style"],0));(Ext.cmd.derive("Ext.fx.layout.card.Slide",Ext.fx.layout.card.Style,{config:{inAnimation:{type:"slide",easing:"ease-out"},outAnimation:{type:"slide",easing:"ease-out",out:true}},updateReverse:function(a){this.getInAnimation().setReverse(a);this.getOutAnimation().setReverse(a)}},0,0,0,0,["fx.layout.card.slide"],0,[Ext.fx.layout.card,"Slide"],0));(Ext.cmd.derive("Ext.fx.layout.card.Cover",Ext.fx.layout.card.Style,{config:{reverse:null,inAnimation:{before:{"z-index":100},after:{"z-index":0},type:"slide",easing:"ease-out"},outAnimation:{easing:"ease-out",from:{opacity:0.99},to:{opacity:1},out:true}},updateReverse:function(a){this.getInAnimation().setReverse(a);this.getOutAnimation().setReverse(a)}},0,0,0,0,["fx.layout.card.cover"],0,[Ext.fx.layout.card,"Cover"],0));(Ext.cmd.derive("Ext.fx.layout.card.Reveal",Ext.fx.layout.card.Style,{config:{inAnimation:{easing:"ease-out",from:{opacity:0.99},to:{opacity:1}},outAnimation:{before:{"z-index":100},after:{"z-index":0},type:"slide",easing:"ease-out",out:true}},updateReverse:,0,0,0,0,["fx.layout.card.reveal"],0,[Ext.fx.layout.card,"Reveal"],0));(Ext.cmd.derive("Ext.fx.layout.card.Fade",Ext.fx.layout.card.Style,{config:{reverse:null,inAnimation:{type:"fade",easing:"ease-out"},outAnimation:{type:"fade",easing:"ease-out",out:true}}},0,0,0,0,["fx.layout.card.fade"],0,[Ext.fx.layout.card,"Fade"],0));(Ext.cmd.derive("Ext.fx.layout.card.Flip",Ext.fx.layout.card.Style,{config:{duration:500,inAnimation:{type:"flip",half:true,easing:"ease-out",before:{"backface-visibility":"hidden"},after:{"backface-visibility":null}},outAnimation:{type:"flip",half:true,easing:"ease-in",before:{"backface-visibility":"hidden"},after:{"backface-visibility":null},out:true}},onActiveItemChange:updateDuration:function(d){var c=d/2,b=this.getInAnimation(),a=this.getOutAnimation();b.setDelay(c);b.setDuration(c);a.setDuration(c)}},0,0,0,0,["fx.layout.card.flip"],0,[Ext.fx.layout.card,"Flip"],0));(Ext.cmd.derive("Ext.fx.layout.card.Pop",Ext.fx.layout.card.Style,{config:{duration:500,inAnimation:{type:"pop",easing:"ease-out"},outAnimation:{type:"pop",easing:"ease-in",out:true}},updateDuration:,0,0,0,0,["fx.layout.card.pop"],0,[Ext.fx.layout.card,"Pop"],0));(Ext.cmd.derive("Ext.fx.layout.card.Scroll",Ext.fx.layout.card.Abstract,{config:{duration:150},constructor:function(a){this.initConfig(a)},getEasing:updateDuration:function(a){this.getEasing().setDuration(a)},onActiveItemChange:startAnimation:doAnimationFrame:stopAnimation:,1,0,0,0,["fx.layout.card.scroll"],0,[Ext.fx.layout.card,"Scroll"],0));(Ext.cmd.derive("Ext.fx.layout.Card",Ext.Base,{constructor:,1,0,0,0,0,0,[Ext.fx.layout,"Card"],0));(Ext.cmd.derive("Ext.layout.Card",Ext.layout.Default,{isCard:true,layoutClass:"x-layout-card",itemClass:"x-layout-card-item",applyAnimation:updateAnimation:setContainer:onContainerInitialized:onContainerActiveItemChange:onItemInnerStateChange:doActiveItemChange:destroy:,0,0,0,0,["layout.card"],0,[Ext.layout,"Card"],0));(Ext.cmd.derive("Ext.layout.Fit",Ext.layout.Default,{isFit:true,layoutClass:"x-layout-fit",itemClass:"x-layout-fit-item",setContainer:onContainerSizeFlagsChange:onItemInnerStateChange:,0,0,0,0,["layout.fit"],0,[Ext.layout,"Fit"],0));(Ext.cmd.derive("Ext.layout.FlexBox",Ext.layout.Box,{config:{align:"stretch"},layoutBaseClass:"x-layout-box",itemClass:"x-layout-box-item",setContainer:applyOrient:updateOrient:onItemInnerStateChange:refreshItemSizeState:refreshAllItemSizedStates:onContainerSizeFlagsChange:onItemSizeChange:doItemSizeChange:onItemFlexChange:doItemFlexChange:redrawContainer:setItemFlex:convertPosition:applyAlign:function(a){return this.convertPosition(a)},updateAlign:applyPack:function(a){return this.convertPosition(a)},updatePack:,0,0,0,0,["layout.box"],0,[Ext.layout,"FlexBox"],0));(Ext.cmd.derive("Ext.layout.Float",Ext.layout.Default,{config:{direction:"left"},layoutClass:"layout-float",itemClass:"layout-float-item",setContainer:onItemInnerStateChange:updateDirection:,0,0,0,0,["layout.float"],0,[Ext.layout,"Float"],0));(Ext.cmd.derive("Ext.layout.HBox",Ext.layout.FlexBox,{},0,0,0,0,["layout.hbox"],0,[Ext.layout,"HBox"],0));(Ext.cmd.derive("Ext.layout.VBox",Ext.layout.FlexBox,{config:{orient:"vertical"}},0,0,0,0,["layout.vbox"],0,[Ext.layout,"VBox"],0));(Ext.cmd.derive("Ext.layout.wrapper.Dock",Ext.Base,{config:{direction:"horizontal",element:{className:"x-dock"},bodyElement:{className:"x-dock-body"},innerWrapper:null,sizeState:false,container:null},positionMap:{top:"start",left:"start",bottom:"end",right:"end"},constructor:addItems:addItem:removeItem:getItemsSlice:applyElement:function(a){return Ext.Element.create(a)},updateElement:applyBodyElement:function(a){return Ext.Element.create(a)},updateBodyElement:function(a){this.getElement().append(a)},updateInnerWrapper:updateSizeState:destroy:,1,0,0,0,0,0,[Ext.layout.wrapper,"Dock"],0));(Ext.cmd.derive("Ext.util.Filter",Ext.Base,{isFilter:true,config:{property:null,value:null,filterFn:Ext.emptyFn,anyMatch:false,exactMatch:false,caseSensitive:false,root:null,id:undefined,scope:null},applyId:constructor:function(a){this.initConfig(a)},applyFilterFn:createFilterFn:createValueMatcher:,1,0,0,0,0,0,[Ext.util,"Filter"],0));(Ext.cmd.derive("Ext.util.AbstractMixedCollection",Ext.Base,{constructor:allowFunctions:false,add:getKey:function(a){return a.id},replace:addAll:each:eachKey:findBy:insert:remove:function(a){return this.removeAt(this.indexOf(a))},removeAll:removeAt:removeAtKey:function(a){return this.removeAt(this.indexOfKey(a))},getCount:function(){return this.length},indexOf:function(a){return Ext.Array.indexOf(this.items,a)},indexOfKey:function(a){return Ext.Array.indexOf(this.keys,a)},get:getAt:function(a){return this.items[a]},getByKey:function(a){return this.map[a]},contains:function(a){return Ext.Array.contains(this.items,a)},containsKey:clear:first:last:sum:collect:extractValues:getRange:filter:filterBy:findIndex:findIndexBy:createValueMatcher:clone:,1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.util,"AbstractMixedCollection"],0));(Ext.cmd.derive("Ext.util.Sorter",Ext.Base,{isSorter:true,config:{property:null,sorterFn:null,root:null,transform:null,direction:"ASC",id:undefined},constructor:function(a){this.initConfig(a)},applyId:createSortFunction:defaultSortFn:updateDirection:function(){this.updateSortFn()},updateSortFn:toggle:,1,0,0,0,0,0,[Ext.util,"Sorter"],0));(Ext.cmd.derive("Ext.util.Sortable",Ext.mixin.Mixin,{isSortable:true,mixinConfig:{hooks:{destroy:"destroy"}},defaultSortDirection:"ASC",initSortable:sort:onBeforeSort:Ext.emptyFn,decodeSorters:getSorters:function(){return this.sorters.items},destroy:,0,0,0,0,0,0,[Ext.util,"Sortable"],0));(Ext.cmd.derive("Ext.util.MixedCollection",Ext.util.AbstractMixedCollection,{constructor:doSort:function(a){this.sortBy(a)},_sort:sortBy:reorder:sortByKey:,1,0,0,0,0,[["sortable",Ext.util.Sortable]],[Ext.util,"MixedCollection"],0));(Ext.cmd.derive("Ext.ItemCollection",Ext.util.MixedCollection,{getKey:function(a){return a.getItemId()},has:,0,0,0,0,0,0,[Ext,"ItemCollection"],0));(Ext.cmd.derive("Ext.fx.easing.Momentum",Ext.fx.easing.Abstract,{config:{acceleration:30,friction:0,startVelocity:0},alpha:0,updateFriction:updateStartVelocity:updateAcceleration:getValue:getFrictionFactor:getVelocity:,0,0,0,0,0,0,[Ext.fx.easing,"Momentum"],0));(Ext.cmd.derive("Ext.fx.easing.Bounce",Ext.fx.easing.Abstract,{config:{springTension:0.3,acceleration:30,startVelocity:0},getValue:,0,0,0,0,0,0,[Ext.fx.easing,"Bounce"],0));(Ext.cmd.derive("Ext.fx.easing.BoundMomentum",Ext.fx.easing.Abstract,{config:{momentum:null,bounce:null,minMomentumValue:0,maxMomentumValue:0,minVelocity:0.01,startVelocity:0},applyMomentum:function(a,b){return Ext.factory(a,Ext.fx.easing.Momentum,b)},applyBounce:updateStartTime:updateStartVelocity:function(a){this.getMomentum().setStartVelocity(a)},updateStartValue:function(a){this.getMomentum().setStartValue(a)},reset:getValue:,0,0,0,0,0,0,[Ext.fx.easing,"BoundMomentum"],0));(Ext.cmd.derive("Ext.fx.easing.EaseOut",Ext.fx.easing.Linear,{config:{exponent:4,duration:1500},getValue:,0,0,0,0,["easing.ease-out"],0,[Ext.fx.easing,"EaseOut"],0));(Ext.cmd.derive("Ext.scroll.Scroller",Ext.Evented,{config:{element:null,direction:"auto",fps:"auto",disabled:null,directionLock:false,momentumEasing:{momentum:{acceleration:30,friction:0.5},bounce:{acceleration:30,springTension:0.3},minVelocity:1},bounceEasing:{duration:400},outOfBoundRestrictFactor:0.5,startMomentumResetTime:300,maxAbsoluteVelocity:6,containerSize:"auto",size:"auto",autoRefresh:true,initialOffset:{x:0,y:0},slotSnapSize:{x:0,y:0},slotSnapOffset:{x:0,y:0},slotSnapEasing:{duration:150},translatable:{translationMethod:"auto",useWrapper:false}},cls:"x-scroll-scroller",containerCls:"x-scroll-container",dragStartTime:0,dragEndTime:0,isDragging:false,isAnimating:false,constructor:applyElement:function(a){if(!a){return}return Ext.get(a)},updateElement:applyTranslatable:function(b,a){return Ext.factory(b,Ext.util.Translatable,a)},updateTranslatable:updateFps:attachListeneners:function(){this.getContainer().on(this.listeners)},detachListeners:function(){this.getContainer().un(this.listeners)},updateDisabled:updateInitialOffset:applyDirection:updateDirection:isAxisEnabled:applyMomentumEasing:function(b){var a=Ext.fx.easing.BoundMomentum;return{x:Ext.factory(b,a),y:Ext.factory(b,a)}},applyBounceEasing:function(b){var a=Ext.fx.easing.EaseOut;return{x:Ext.factory(b,a),y:Ext.factory(b,a)}},updateBounceEasing:applySlotSnapEasing:getMinPosition:getMaxPosition:refreshMaxPosition:function(){this.maxPosition=null;this.getMaxPosition()},applyContainerSize:applySize:updateAutoRefresh:applySlotSnapSize:function(a){if(typeof a=="number"){return{x:a,y:a}}return a},applySlotSnapOffset:getContainer:refresh:onElementResize:function(a,b){this.setSize({x:b.width,y:b.height});this.refresh()},onContainerResize:scrollTo:scrollToTop:scrollToEnd:scrollBy:onTouchStart:function(){this.isTouching=true;this.stopAnimation()},onTouchEnd:onDragStart:onAxisDrag:onDrag:onDragEnd:getAnimationEasing:onAnimationFrame:onAnimationEnd:function(){this.snapToBoundary();this.onScrollEnd()},stopAnimation:onScrollEnd:snapToSlot:getSnapPosition:snapToBoundary:destroy:,1,0,0,0,0,0,[Ext.scroll,"Scroller"],function(){}));());((this);(Ext.cmd.derive("Ext.TaskQueue",Ext.Base,{singleton:true,pending:false,mode:true,constructor:requestRead:function(c,b,a){this.request(true);this.readQueue.push(arguments)},requestWrite:request:watch:run:,1,0,0,0,0,0,[Ext,"TaskQueue"],0));(Ext.cmd.derive("Ext.scroll.indicator.Abstract",Ext.Component,{config:{baseCls:"x-scroll-indicator",axis:"x",value:null,length:null,minLength:6,hidden:true,ui:"dark",autoHide:true},cachedConfig:{ratio:1,barCls:"x-scroll-bar",active:true},barElement:null,barLength:0,gapLength:0,getElementConfig:applyRatio:refresh:updateBarCls:function(a){this.barElement.addCls(a)},updateAxis:updateValue:updateActive:doSetHidden:applyLength:updateLength:doUpdateLength:setOffset:doSetOffset:,0,0,["component"],{component:true},0,0,[Ext.scroll.indicator,"Abstract"],0));(Ext.cmd.derive("Ext.scroll.indicator.CssTransform",Ext.scroll.indicator.Abstract,{config:{cls:"csstransform"}},0,0,["component"],{component:true},0,0,[Ext.scroll.indicator,"CssTransform"],0));(Ext.cmd.derive("Ext.scroll.indicator.ScrollPosition",Ext.scroll.indicator.Abstract,{config:{cls:"scrollposition"},getElementConfig:updateValue:doUpdateLength:doSetOffset:,0,0,["component"],{component:true},0,0,[Ext.scroll.indicator,"ScrollPosition"],0));(Ext.cmd.derive("Ext.scroll.indicator.Rounded",Ext.scroll.indicator.Abstract,{config:{cls:"rounded"},constructor:getElementConfig:refresh:doUpdateLength:function(c){if(!this.isDestroyed){var b=this.getAxis(),a=this.endElement,e=this.middleElement.dom.style,d=this.endElementLength,h=c-d,g=h-this.startElementLength,f=this.transformPropertyName;if(b==="x"){a.translate(h,0);e[f]="translate3d(0, 0, 0) scaleX("+g+")"}else{a.translate(0,h);e[f]="translate3d(0, 0, 0) scaleY("+g+")"}}}},1,0,["component"],{component:true},0,0,[Ext.scroll.indicator,"Rounded"],0));(Ext.cmd.derive("Ext.scroll.Indicator",Ext.Base,{alternateClassName:"Ext.util.Indicator",constructor:,1,0,0,0,0,0,[Ext.scroll,"Indicator",Ext.util,"Indicator"],0));(Ext.cmd.derive("Ext.scroll.View",Ext.Evented,{alternateClassName:"Ext.util.ScrollView",config:{indicatorsUi:"dark",element:null,scroller:{},indicators:{x:{axis:"x"},y:{axis:"y"}},indicatorsHidingDelay:100,cls:"x-scroll-view"},processConfig:constructor:setConfig:updateIndicatorsUi:applyScroller:function(a,b){return Ext.factory(a,Ext.scroll.Scroller,b)},applyIndicators:updateIndicators:updateScroller:isAxisEnabled:applyElement:function(a){if(a){return Ext.get(a)}},updateElement:showIndicators:hideIndicators:doHideIndicators:onScrollStart:onScrollEnd:function(){this.hideIndicators()},onScroll:setIndicatorValue:refreshIndicator:refresh:function(){return this.getScroller().refresh()},refreshIndicators:destroy:,1,0,0,0,0,0,[Ext.scroll,"View",Ext.util,"ScrollView"],0));(Ext.cmd.derive("Ext.behavior.Scrollable",Ext.behavior.Behavior,{constructor:onComponentPainted:setConfig:getScrollView:function(){return this.scrollView},onScrollViewDestroy:onComponentDestroy:function(){var a=this.scrollView;if(a){a.destroy()}}},1,0,0,0,0,0,[Ext.behavior,"Scrollable"],0));(Ext.cmd.derive("Ext.util.InputBlocker",Ext.Base,{singleton:true,blockInputs:unblockInputs:,0,0,0,0,0,0,[Ext.util,"InputBlocker"],0));(Ext.cmd.derive("Ext.Mask",Ext.Component,{config:{baseCls:"x-mask",transparent:false,top:0,left:0,right:0,bottom:0},initialize:onHide:onEvent:updateTransparent:,0,["mask"],["component","mask"],{component:true,mask:true},["widget.mask"],0,[Ext,"Mask"],0));(Ext.cmd.derive("Ext.Container",Ext.Component,{alternateClassName:"Ext.lib.Container",eventedConfig:{activeItem:0,scrollable:null},config:{layout:null,control:{},defaults:null,items:null,autoDestroy:true,defaultType:null,useBodyElement:null,masked:null,modal:null,hideOnMaskTap:null},isContainer:true,constructor:getElementConfig:applyMasked:mask:unmask:function(){this.setMasked(false)},setParent:applyModal:updateModal:updateHideOnMaskTap:updateZIndex:updateBaseCls:updateUseBodyElement:applyItems:applyControl:onFirstItemAdd:getLayout:updateDefaultType:applyDefaults:factoryItem:factoryItemWithDefaults:add:doAdd:remove:doResetActiveItem:doRemove:removeAll:getAt:function(a){return this.items.getAt(a)},getInnerAt:function(a){return this.innerItems[a]},removeAt:removeInnerAt:has:hasInnerItem:indexOf:function(a){return this.getItems().indexOf(a)},innerIndexOf:function(a){return this.innerItems.indexOf(a)},insertInner:onInnerItemMove:Ext.emptyFn,removeInner:insert:doInsert:insertFirst:insertLast:insertBefore:insertAfter:onItemAdd:doItemLayoutAdd:onItemRemove:doItemLayoutRemove:onItemMove:doItemLayoutMove:onItemInnerStateChange:getInnerItems:function(){return this.innerItems},getDockedItems:applyActiveItem:animateActiveItem:doSetActiveItem:show:function(){Ext.Component.prototype.show.apply(this,arguments);var a=this.getModal();if(a){a.setHidden(false)}return this},hide:doSetHidden:setRendered:getScrollableBehavior:applyScrollable:doSetScrollable:function(){},getScrollable:getRefItems:getComponent:getDockedComponent:query:child:down:destroy:,1,["container"],["component","container"],{component:true,container:true},["widget.container"],0,[Ext,"Container",Ext.lib,"Container"],);(Ext.cmd.derive("Ext.util.Point",Ext.Base,{radianToDegreeConstant:180/Math.PI,statics:{fromEvent:fromTouch:from:,constructor:clone:copy:function(){return this.clone.apply(this,arguments)},copyFrom:toString:equals:isCloseTo:isWithin:function(){return this.isCloseTo.apply(this,arguments)},translate:roundedEquals:getDistanceTo:getAngleTo:,3,0,0,0,0,0,[Ext.util,"Point"],0));(Ext.cmd.derive("Ext.util.LineSegment",Ext.Base,{constructor:intersects:getLength:getAngleToX:getInBetweenPoint:toString:,3,0,0,0,0,0,[Ext.util,"LineSegment"],0));(Ext.cmd.derive("Ext.Panel",Ext.Container,{alternateClassName:"Ext.lib.Panel",isPanel:true,config:{baseCls:"x-panel",bodyPadding:null,bodyMargin:null,bodyBorder:null},getElementConfig:applyBodyPadding:function(a){if(a===true){a=5}if(a){a=Ext.dom.Element.unitizeBox(a)}return a},updateBodyPadding:function(a){this.element.setStyle("padding",a)},applyBodyMargin:function(a){if(a===true){a=5}if(a){a=Ext.dom.Element.unitizeBox(a)}return a},updateBodyMargin:function(a){this.element.setStyle("margin",a)},applyBodyBorder:updateBodyBorder:alignTo:,0,["panel"],["component","container","panel"],{component:true,container:true,panel:true},["widget.panel"],0,[Ext,"Panel",Ext.lib,"Panel"],0));(Ext.cmd.derive("Ext.Button",Ext.Component,{cachedConfig:{pressedCls:"x-button-pressing",badgeCls:"x-badge",hasBadgeCls:"x-hasbadge",labelCls:"x-button-label",iconCls:null},config:{badgeText:null,text:null,icon:false,iconAlign:"left",pressedDelay:0,handler:null,scope:null,autoEvent:null,ui:"normal",baseCls:"x-button"},template:[{tag:"span",reference:"badgeElement",hidden:true},{tag:"span",className:"x-button-icon",reference:"iconElement"},{tag:"span",reference:"textElement",hidden:true}],initialize:updateBadgeText:updateText:updateHtml:updateBadgeCls:function(b,a){this.badgeElement.replaceCls(a,b)},updateHasBadgeCls:function(b,c){var a=this.element;if(a.hasCls(c)){a.replaceCls(c,b)}},updateLabelCls:function(b,a){this.textElement.replaceCls(a,b)},updatePressedCls:function(b,c){var a=this.element;if(a.hasCls(c)){a.replaceCls(c,b)}},updateIcon:updateIconCls:updateIconAlign:refreshIconAlign:function(){this.updateIconAlign(this.getIconAlign())},applyAutoEvent:updateAutoEvent:hideIconElement:function(){this.iconElement.removeCls("x-shown");this.iconElement.addCls("x-hidden")},showIconElement:applyUi:getUi:applyPressedDelay:onPress:onRelease:function(a){this.fireAction("release",[this,a],"doRelease")},doRelease:onTap:doTap:,0,["button"],["component","button"],{component:true,button:true},["widget.button"],0,[Ext,"Button"],function(){}));(Ext.cmd.derive("Ext.data.Connection",Ext.Base,{statics:{requestId:0},config:{url:null,async:true,method:null,username:"",password:"",disableCaching:true,disableCachingParam:"_dc",timeout:30000,extraParams:null,defaultHeaders:null,useDefaultHeader:true,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:true,defaultXhrHeader:"XMLHttpRequest",autoAbort:false},textAreaRe:/textarea/i,multiPartRe:/multipart\/form-data/i,lineBreakRe:/\r\n/g,constructor:request:upload:onUploadComplete:onAfterUploadComplete:isFormUpload:getForm:setOptions:function(l,k){var h=this,e=l.params||{},g=h.getExtraParams(),d=l.urlParams,c=l.url||h.getUrl(),j=l.jsonData,b,a,f;if(Ext.isFunction(e)){e=e.call(k,l)}if(Ext.isFunction(c)){c=c.call(k,l)}c=this.setupUrl(l,c);f=l.data||l.rawData||l.binaryData||l.xmlData||j||null;if(j&&!Ext.isPrimitive(j)){f=Ext.encode(f)}if(l.binaryData){if(f instanceof Array){f=(new Uint8Array(l.binaryData))}if(f instanceof Uint8Array){f=f.buffer}}if(Ext.isObject(e)){e=Ext.Object.toQueryString(e)}if(Ext.isObject(g)){g=Ext.Object.toQueryString(g)}e=e+((g)?((e)?"&":"")+g:"");d=Ext.isObject(d)?Ext.Object.toQueryString(d):d;e=this.setupParams(l,e);b=(l.method||h.getMethod()||((e||f)?"POST":"GET")).toUpperCase();this.setupMethod(l,b);a=l.disableCaching!==false?(l.disableCaching||h.getDisableCaching()):false;if(a){c=Ext.urlAppend(c,(l.disableCachingParam||h.getDisableCachingParam())+"="+(new Date().getTime()))}if((b=="GET"||f)&&e){e=null}if(d){c=Ext.urlAppend(c,d)}return{url:c,method:b,data:f||e||null}},setupUrl:setupParams:setupMethod:setupHeaders:getXhrInstance:((),isLoading:abort:abortAll:function(){this.abort()},onStateChange:clearTimeout:cleanup:onComplete:parseStatus:createResponse:createException:,1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.data,"Connection"],0));(Ext.cmd.derive("Ext.Ajax",Ext.data.Connection,{singleton:true,autoAbort:false},0,0,0,0,0,0,[Ext,"Ajax"],0));(Ext.cmd.derive("Ext.Anim",Ext.Base,{isAnim:true,disableAnimations:false,defaultConfig:{from:{},to:{},duration:250,delay:0,easing:"ease-in-out",autoClear:true,out:true,direction:null,reverse:false},opposites:{left:"right",right:"left",up:"down",down:"up"},constructor:initConfig:run:onTransitionEnd:,1,0,0,0,0,0,[Ext,"Anim"],);(Ext.cmd.derive("Ext.ComponentQuery",Ext.Base,{singleton:true},0,0,0,0,0,0,[Ext,"ComponentQuery"],);(Ext.cmd.derive("Ext.Decorator",Ext.Component,{isDecorator:true,config:{component:{}},statics:{generateProxySetter:generateProxyGetter:,onClassExtended:applyComponent:updateComponent:doUnsetComponent:doSetComponent:setRendered:setDisabled:destroy:,0,0,["component"],{component:true},0,0,[Ext,"Decorator"],0));(Ext.cmd.derive("Ext.Img",Ext.Component,{config:{src:null,baseCls:"x-img",imageCls:"x-img-image",backgroundCls:"x-img-background",mode:"background"},beforeInitialize:initialize:hide:show:updateMode:updateImageCls:function(b,a){this.replaceCls(a,b)},updateBackgroundCls:onTap:function(a){this.fireEvent("tap",this,a)},onAfterRender:function(){this.updateSrc(this.getSrc())},updateSrc:detachListeners:onLoad:function(a){this.detachListeners();if(this.getMode()==="background"){this.element.dom.style.backgroundImage='url("'+this.imageObject.src+'")'}this.fireEvent("load",this,a)},onError:doSetWidth:function(b){var a=(this.getMode()==="background")?this.element:this.imageElement;a.setWidth(b);Ext.Component.prototype.doSetWidth.apply(this,arguments)},doSetHeight:destroy:,0,["image","img"],["component","image","img"],{component:true,image:true,img:true},["widget.image","widget.img"],0,[Ext,"Img"],0));(Ext.cmd.derive("Ext.Label",Ext.Component,{config:{baseCls:"x-label"}},0,["label"],["component","label"],{component:true,label:true},["widget.label"],0,[Ext,"Label"],0));(Ext.cmd.derive("Ext.LoadMask",Ext.Mask,{config:{message:"Loading...",cls:"x-loading-mask",messageCls:"x-mask-message",indicator:true},getTemplate:updateMessage:updateMessageCls:updateIndicator:,0,["loadmask"],["component","mask","loadmask"],{component:true,mask:true,loadmask:true},["widget.loadmask"],0,[Ext,"LoadMask"],function(){}));(Ext.cmd.derive("Ext.Title",Ext.Component,{config:{baseCls:"x-title",title:""},updateTitle:function(a){this.setHtml(a)}},0,["title"],["component","title"],{component:true,title:true},["widget.title"],0,[Ext,"Title"],0));(Ext.cmd.derive("Ext.Spacer",Ext.Component,{config:{},constructor:,1,["spacer"],["component","spacer"],{component:true,spacer:true},["widget.spacer"],0,[Ext,"Spacer"],0));(Ext.cmd.derive("Ext.Toolbar",Ext.Container,{isToolbar:true,config:{baseCls:"x-toolbar",ui:"dark",title:null,defaultType:"button",minHeight:null,layout:{type:"hbox",align:"center"}},hasCSSMinHeight:true,constructor:applyTitle:updateTitle:showTitle:function(){var a=this.getTitle();if(a){a.show()}},hideTitle:,1,["toolbar"],["component","container","toolbar"],{component:true,container:true,toolbar:true},["widget.toolbar"],0,[Ext,"Toolbar"],function(){}));(Ext.cmd.derive("Ext.field.Input",Ext.Component,{tag:"input",cachedConfig:{cls:"x-form-field",focusCls:"x-field-focus",maskCls:"x-field-mask",useMask:"auto",type:"text",checked:false},config:{baseCls:"x-field-input",name:null,value:null,isFocused:false,tabIndex:null,placeHolder:null,minValue:null,maxValue:null,stepValue:null,maxLength:null,autoComplete:null,autoCapitalize:null,autoCorrect:null,readOnly:null,maxRows:null,pattern:null,startValue:false,fastFocus:true},getTemplate:initElement:updateFastFocus:useManualMaxLength:applyUseMask:updateUseMask:updatePattern:function(a){this.updateFieldAttribute("pattern",a)},updateFieldAttribute:updateCls:updateType:updateName:function(a){this.updateFieldAttribute("name",a)},getValue:applyValue:updateValue:setValue:updateTabIndex:function(a){this.updateFieldAttribute("tabIndex",a)},testAutoFn:updateMaxLength:updatePlaceHolder:function(a){this.updateFieldAttribute("placeholder",a)},applyAutoComplete:function(a){return this.testAutoFn(a)},updateAutoComplete:function(a){var b=a?"on":"off";this.updateFieldAttribute("autocomplete",b)},applyAutoCapitalize:function(a){return this.testAutoFn(a)},updateAutoCapitalize:function(b){var a=b?"on":"off";this.updateFieldAttribute("autocapitalize",a)},applyAutoCorrect:function(a){return this.testAutoFn(a)},updateAutoCorrect:updateMinValue:function(a){this.updateFieldAttribute("min",a)},updateMaxValue:function(a){this.updateFieldAttribute("max",a)},updateStepValue:function(a){this.updateFieldAttribute("step",a)},checkedRe:/^(true|1|on)/i,getChecked:applyChecked:setChecked:updateChecked:updateReadOnly:updateMaxRows:function(a){this.updateFieldAttribute("rows",a)},doSetDisabled:isDirty:reset:function(){this.setValue(this.originalValue)},onInputTap:function(a){this.fireAction("inputtap",[this,a],"doInputTap")},doInputTap:onMaskTap:function(a){this.fireAction("masktap",[this,a],"doMaskTap")},doMaskTap:showMask:function(){if(this.getUseMask()){this.mask.setStyle("display","block")}},hideMask:focus:blur:select:onFocus:function(a){this.fireAction("focus",[a],"doFocus")},doFocus:onTouchStart:onBlur:doBlur:onClearIconTap:onClearIconPress:function(){this.clearIcon.addCls("x-pressing")},onClearIconRelease:function(){this.clearIcon.removeCls("x-pressing")},onClick:function(a){this.fireEvent("click",a)},onChange:onPaste:function(a){if(this.useManualMaxLength()){this.trimValueToMaxLength()}this.fireEvent("paste",a)},onKeyUp:onKeyDown:function(){this.ignoreInput=true},onInput:onKeyPress:onMouseDown:trimValueToMaxLength:,0,["input"],["component","input"],{component:true,input:true},["widget.input"],0,[Ext.field,"Input"],0));(Ext.cmd.derive("Ext.field.Field",Ext.Decorator,{alternateClassName:"Ext.form.Field",isField:true,isFormField:true,config:{baseCls:"x-field",label:null,labelAlign:"left",labelWidth:"30%",labelWrap:false,clearIcon:null,required:false,inputType:null,name:null,value:null,tabIndex:null},platformConfig:[{theme:["Windows","MountainView","Blackberry","Tizen"],labelAlign:"top"}],cachedConfig:{labelCls:null,requiredCls:"x-field-required",inputCls:null},getElementConfig:updateLabel:updateLabelAlign:updateLabelCls:updateLabelWidth:updateLabelWrap:updateRequired:updateRequiredCls:initialize:doInitValue:reset:resetOriginalValue:isDirty:function(){return false}},0,["field"],["component","field"],{component:true,field:true},["widget.field"],0,[Ext.field,"Field",Ext.form,"Field"],function(){}));(Ext.cmd.derive("Ext.field.Text",Ext.field.Field,{alternateClassName:"Ext.form.Text",config:{ui:"text",clearIcon:true,placeHolder:null,maxLength:null,autoComplete:null,autoCapitalize:null,autoCorrect:null,readOnly:null,component:{xtype:"input",type:"text",fastFocus:true},bubbleEvents:["action"]},initialize:syncEmptyCls:updateValue:getValue:updatePlaceHolder:function(a){this.getComponent().setPlaceHolder(a)},updateMaxLength:function(a){this.getComponent().setMaxLength(a)},updateAutoComplete:function(a){this.getComponent().setAutoComplete(a)},updateAutoCapitalize:function(a){this.getComponent().setAutoCapitalize(a)},updateAutoCorrect:function(a){this.getComponent().setAutoCorrect(a)},updateReadOnly:updateInputType:function(a){var b=this.getComponent();if(b){b.setType(a)}},updateName:function(a){var b=this.getComponent();if(b){b.setName(a)}},updateTabIndex:updateInputCls:doSetDisabled:showClearIcon:hideClearIcon:onKeyUp:function(a){this.fireAction("keyup",[this,a],"doKeyUp")},doKeyUp:doAction:function(){this.blur()},onClearIconTap:doClearIconTap:onChange:onFocus:onBlur:onPaste:function(a){this.fireEvent("paste",this,a)},onMouseDown:focus:function(){this.getComponent().focus();return this},blur:function(){this.getComponent().blur();return this},select:resetOriginalValue:reset:isDirty:,0,["textfield"],["component","field","textfield"],{component:true,field:true,textfield:true},["widget.textfield"],0,[Ext.field,"Text",Ext.form,"Text"],0));(Ext.cmd.derive("Ext.app.Action",Ext.Base,{config:{scope:null,application:null,controller:null,action:null,args:[],url:undefined,data:{},title:null,beforeFilters:[],currentFilterIndex:-1},constructor:applyBeforeFilters:execute:function(){this.resume()},resume:applyUrl:applyController:urlEncode:,1,0,0,0,0,0,[Ext.app,"Action"],0));(Ext.cmd.derive("Ext.app.Controller",Ext.Base,{config:{refs:{},routes:{},control:{},before:{},application:{},stores:[],models:[],views:[]},constructor:function(a){this.initConfig(a);this.mixins.observable.constructor.call(this,a)},init:Ext.emptyFn,launch:Ext.emptyFn,redirectTo:execute:applyBefore:applyControl:applyRefs:applyRoutes:applyStores:function(a){return this.getFullyQualified(a,"store")},applyModels:function(a){return this.getFullyQualified(a,"model")},applyViews:function(a){return this.getFullyQualified(a,"view")},getFullyQualified:control:ref:getRef:hasRef:,1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.app,"Controller"],function(){}));(Ext.cmd.derive("Ext.app.History",Ext.Base,{config:{actions:[],updateUrl:true,token:""},constructor:add:back:applyToken:detectStateChange:onStateChange:,1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.app,"History"],0));(Ext.cmd.derive("Ext.app.Profile",Ext.Base,{config:{namespace:"auto",name:"auto",controllers:[],models:[],views:[],stores:[],application:null},constructor:isActive:function(){return false},launch:Ext.emptyFn,applyNamespace:applyName:getDependencies:,1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.app,"Profile"],0));(Ext.cmd.derive("Ext.app.Route",Ext.Base,{config:{conditions:{},url:null,controller:null,action:null,initialized:false},constructor:function(a){this.initConfig(a)},recognize:initialize:recognizes:function(a){return this.matcherRegex.test(a)},matchesFor:argsFor:urlFor:createMatcherRegex:,1,0,0,0,0,0,[Ext.app,"Route"],0));(Ext.cmd.derive("Ext.app.Router",Ext.Base,{config:{routes:[],defaults:{action:"index"}},constructor:function(a){this.initConfig(a)},connect:recognize:draw:clear:,1,0,0,0,0,0,[Ext.app,"Router"],function(){}));(Ext.cmd.derive("Ext.app.Application",Ext.app.Controller,{config:{profiles:[],controllers:[],history:{},name:null,appFolder:"app",router:{},controllerInstances:[],profileInstances:[],currentProfile:null,launch:Ext.emptyFn,enableLoader:true,requires:[],themeVariationPrefix:"x-theme-variation-",themeVariationTransitionCls:null,themeVariation:null},constructor:dispatch:redirectTo:control:getController:onProfilesLoaded:loadControllerDependencies:onDependenciesLoaded:gatherDependencies:instantiateStores:instantiateControllers:applyControllers:function(a){return this.getFullyQualified(a,"controller")},applyProfiles:applyName:updateName:applyRouter:applyHistory:onHistoryChange:updateThemeVariation:,1,0,0,0,0,0,[Ext.app,"Application"],function(){}));(Ext.cmd.derive("Ext.carousel.Item",Ext.Decorator,{config:{baseCls:"x-carousel-item",component:null,translatable:true}},0,0,["component"],{component:true},0,0,[Ext.carousel,"Item"],0));Ext.define("Ext.carousel.Indicator",{extend:Ext.Component,xtype:"carouselindicator",alternateClassName:"Ext.Carousel.Indicator",config:{baseCls:"x-carousel-indicator",direction:"horizontal"},initialize:updateDirection:addIndicator:removeIndicator:setActiveIndex:onTap:destroy:);(Ext.cmd.derive("Ext.util.TranslatableGroup",Ext.util.translatable.Abstract,{config:{items:[],activeIndex:0,itemLength:{x:0,y:0}},applyItems:doTranslate:,0,0,0,0,0,0,[Ext.util,"TranslatableGroup"],0));Ext.define("Ext.carousel.Carousel",{extend:Ext.Container,alternateClassName:"Ext.Carousel",xtype:"carousel",config:{baseCls:"x-carousel",direction:"horizontal",directionLock:false,animation:{duration:250,easing:{type:"ease-out"}},indicator:true,ui:"dark",itemConfig:{},bufferSize:1,itemLength:null},itemLength:0,offset:0,flickStartOffset:0,flickStartTime:0,dragDirection:0,count:0,painted:false,activeIndex:-1,beforeInitialize:updateBufferSize:setRendered:onSizeChange:onItemAdd:doItemLayoutAdd:function(a){if(a.isInnerItem()){return}Ext.Container.prototype.doItemLayoutAdd.apply(this,arguments)},onItemRemove:doItemLayoutRemove:function(a){if(a.isInnerItem()){return}Ext.Container.prototype.doItemLayoutRemove.apply(this,arguments)},onInnerItemMove:doItemLayoutMove:isIndexDirty:getTranslatable:onDragStart:onDrag:onDragEnd:applyAnimation:updateDirection:setOffset:setOffsetAnimated:onAnimationEnd:refresh:refreshSizing:refreshOffset:refreshActiveItem:getActiveIndex:function(){return this.activeIndex},refreshActiveIndex:refreshCarouselItems:refreshInactiveCarouselItems:getMaxItemIndex:getInnerItemIndex:getInnerItemAt:applyActiveItem:doSetActiveItem:next:previous:applyIndicator:updateIndicator:destroy:,;(Ext.cmd.derive("Ext.mixin.Sortable",Ext.mixin.Mixin,{mixinConfig:{id:"sortable"},config:{sorters:null,defaultSortDirection:"ASC",sortRoot:null},dirtySortFn:false,sortFn:null,sorted:false,applySorters:createSortersCollection:function(){this._sorters=Ext.create("Ext.util.Collection",function(a){return a.getId()});return this._sorters},addSorter:addSorters:insertSorter:insertSorters:removeSorter:removeSorters:updateSortFn:getSortFn:function(){if(this.dirtySortFn){return this.updateSortFn()}return this.sortFn},sort:findInsertionIndex:,0,0,0,0,0,0,[Ext.mixin,"Sortable"],0));(Ext.cmd.derive("Ext.mixin.Filterable",Ext.mixin.Mixin,{mixinConfig:{id:"filterable"},config:{filters:null,filterRoot:null},dirtyFilterFn:false,filterFn:null,filtered:false,applyFilters:createFiltersCollection:addFilter:addFilters:insertFilter:insertFilters:removeFilters:updateFilterFn:filter:isFiltered:getFilterFn:,0,0,0,0,0,0,[Ext.mixin,"Filterable"],0));(Ext.cmd.derive("Ext.util.Collection",Ext.Base,{config:{autoFilter:true,autoSort:true},constructor:updateAutoSort:function(a,b){if(b===false&&a&&this.items.length){this.sort()}},updateAutoFilter:insertSorters:removeSorters:applyFilters:addFilters:removeFilters:filter:updateAfterFilter:sort:handleSort:add:getKey:function(a){return a.id},replace:addAll:each:eachKey:findBy:function(e,d){var f=this.keys,b=this.items,c=0,a=b.length;for(;c<a;c++){if(e.call(d||window,b[c],f[c])){return b[c]}}return null},filterBy:insert:insertAll:remove:removeAll:removeAt:removeAtKey:function(a){return this.removeAt(this.indexOfKey(a))},getCount:function(){return this.length},indexOf:indexOfKey:updateIndices:get:getAt:function(a){return this.items[a]},getByKey:function(a){return this.map[a]},contains:containsKey:function(a){return typeof this.map[a]!="undefined"},clear:first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},getRange:function(f,a){var e=this,c=e.items,b=[],d;if(c.length<1){return b}f=f||0;a=Math.min(typeof a=="undefined"?e.length-1:a,e.length-1);if(f<=a){for(d=f;d<=a;d++){b[b.length]=c[d]}}else{for(d=f;d>=a;d--){b[b.length]=c[d]}}return b},findIndexBy:function(d,c,h){var g=this,f=g.keys,a=g.items,b=h||0,e=a.length;for(;b<e;b++){if(d.call(c||g,a[b],f[b])){return b}}return -1},clone:function(){var e=this,f=new this.self(),d=e.keys,a=e.items,b=0,c=a.length;for(;b<c;b++){f.add(d[b],a[b])}f.getKey=e.getKey;return f},destroy:function(){this.callSuper();this.clear()}},1,0,0,0,0,[["sortable",Ext.mixin.Sortable],["filterable",Ext.mixin.Filterable]],[Ext.util,"Collection"],0));(Ext.cmd.derive("Ext.data.Operation",Ext.Base,{config:{synchronous:true,action:null,filters:null,sorters:null,grouper:null,start:null,limit:null,batch:null,callback:null,scope:null,resultSet:null,records:null,request:null,response:null,withCredentials:null,params:null,url:null,page:null,node:null,model:undefined,addRecords:false},started:false,running:false,complete:false,success:undefined,exception:false,error:undefined,constructor:function(a){this.initConfig(a)},applyModel:function(a){if(typeof a=="string"){a=Ext.data.ModelManager.getModel(a);if(!a){Ext.Logger.error("Model with name "+arguments[0]+" doesnt exist.")}}if(a&&!a.prototype.isModel&&Ext.isObject(a)){a=Ext.data.ModelManager.registerType(a.storeId||a.id||Ext.id(),a)}return a},getRecords:setStarted:function(){this.started=true;this.running=true},setCompleted:setSuccessful:function(){this.success=true},setException:hasException:function(){return this.exception===true},getError:function(){return this.error},isStarted:function(){return this.started===true},isRunning:function(){return this.running===true},isComplete:function(){return this.complete===true},wasSuccessful:allowWrite:process:processRead:processCreate:processUpdate:processDestroy:findCurrentRecord:updateRecord:,1,0,0,0,0,0,[Ext.data,"Operation"],0));(Ext.cmd.derive("Ext.data.ResultSet",Ext.Base,{config:{loaded:true,count:null,total:null,success:false,records:null,message:null},constructor:function(a){this.initConfig(a)},applyCount:updateRecords:,1,0,0,0,0,0,[Ext.data,"ResultSet"],0));(Ext.cmd.derive("Ext.data.reader.Reader",Ext.Base,{alternateClassName:["Ext.data.Reader","Ext.data.DataReader"],isReader:true,config:{idProperty:undefined,clientIdProperty:"clientId",totalProperty:"total",successProperty:"success",messageProperty:null,rootProperty:"",implicitIncludes:true,model:undefined},constructor:function(a){this.initConfig(a)},fieldCount:0,applyModel:function(a){if(typeof a=="string"){a=Ext.data.ModelManager.getModel(a);if(!a){Ext.Logger.error("Model with name "+arguments[0]+" doesnt exist.")}}if(a&&!a.prototype.isModel&&Ext.isObject(a)){a=Ext.data.ModelManager.registerType(a.storeId||a.id||Ext.id(),a)}return a},applyIdProperty:updateModel:createAccessor:Ext.emptyFn,createFieldAccessExpression:function(){return"undefined"},buildExtractors:buildRecordDataExtractor:getFields:getData:function(a){return a},getResponseData:function(a){return a},getRoot:function(a){return a},read:process:readRecords:extractData:readAssociated:getAssociatedDataRoot:onMetaChange:,1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.data.reader,"Reader",Ext.data,"Reader",Ext.data,"DataReader"],);(Ext.cmd.derive("Ext.data.reader.Json",Ext.data.reader.Reader,{alternateClassName:"Ext.data.JsonReader",config:{record:null,useSimpleAccessors:false},objectRe:/[\[\.]/,getResponseData:buildExtractors:getRoot:extractData:createAccessor:),createFieldAccessExpression:,0,0,0,0,["reader.json"],0,[Ext.data.reader,"Json",Ext.data,"JsonReader"],0));(Ext.cmd.derive("Ext.data.writer.Writer",Ext.Base,{alternateClassName:["Ext.data.DataWriter","Ext.data.Writer"],config:{writeAllFields:true,nameProperty:"name"},constructor:function(a){this.initConfig(a)},write:writeDate:getRecordData:,1,0,0,0,["writer.base"],0,[Ext.data.writer,"Writer",Ext.data,"DataWriter",Ext.data,"Writer"],0));(Ext.cmd.derive("Ext.data.writer.Json",Ext.data.writer.Writer,{alternateClassName:"Ext.data.JsonWriter",config:{rootProperty:undefined,encode:false,allowSingle:true,encodeRequest:false},applyRootProperty:writeRecords:,0,0,0,0,["writer.json"],0,[Ext.data.writer,"Json",Ext.data,"JsonWriter"],0));(Ext.cmd.derive("Ext.data.Batch",Ext.Base,{config:{autoStart:false,pauseOnException:true,proxy:null},current:-1,total:0,isRunning:false,isComplete:false,hasException:false,constructor:add:start:runNextOperation:pause:function(){this.isRunning=false},runOperation:,1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.data,"Batch"],0));(Ext.cmd.derive("Ext.data.proxy.Proxy",Ext.Evented,{alternateClassName:["Ext.data.DataProxy","Ext.data.Proxy"],config:{batchOrder:"create,update,destroy",batchActions:true,model:null,reader:{type:"json"},writer:{type:"json"}},isProxy:true,applyModel:updateModel:applyReader:function(b,a){return Ext.factory(b,Ext.data.Reader,a,"reader")},updateReader:onMetaChange:function(b){var a=this.getReader().getModel();if(!this.getModel()&&a){this.setModel(a)}this.fireEvent("metachange",this,b)},applyWriter:function(b,a){return Ext.factory(b,Ext.data.Writer,a,"writer")},create:Ext.emptyFn,read:Ext.emptyFn,update:Ext.emptyFn,destroy:Ext.emptyFn,onDestroy:batch:onBatchComplete:,0,0,0,0,["proxy.proxy"],0,[Ext.data.proxy,"Proxy",Ext.data,"DataProxy",Ext.data,"Proxy"],function(){}));(Ext.cmd.derive("Ext.data.proxy.Client",Ext.data.proxy.Proxy,{alternateClassName:"Ext.proxy.ClientProxy",clear:function(){}},0,0,0,0,0,0,[Ext.data.proxy,"Client",Ext.proxy,"ClientProxy"],0));(Ext.cmd.derive("Ext.data.proxy.Memory",Ext.data.proxy.Client,{alternateClassName:"Ext.data.MemoryProxy",isMemoryProxy:true,config:{data:[]},finishOperation:create:function(){this.finishOperation.apply(this,arguments)},update:function(){this.finishOperation.apply(this,arguments)},destroy:function(){this.finishOperation.apply(this,arguments)},read:clear:Ext.emptyFn},0,0,0,0,["proxy.memory"],0,[Ext.data.proxy,"Memory",Ext.data,"MemoryProxy"],0));(Ext.cmd.derive("Ext.data.SortTypes",Ext.Base,{singleton:true,stripTagsRE:/<\/?[^>]+>/gi,none:function(a){return a},asText:asUCText:asUCString:asDate:asFloat:asInt:,0,0,0,0,0,0,[Ext.data,"SortTypes"],0));(Ext.cmd.derive("Ext.data.Types",Ext.Base,{singleton:true,stripRe:/[\$,%]/g,dashesRe:/-/g,iso8601TestRe:/\d\dT\d\d/,iso8601SplitRe:/[- :T\.Z\+]/},0,0,0,0,0,0,[Ext.data,"Types"],);(Ext.cmd.derive("Ext.data.Field",Ext.Base,{isField:true,config:{name:null,type:"auto",convert:undefined,dateFormat:null,allowNull:true,defaultValue:undefined,mapping:null,sortType:undefined,sortDir:"ASC",allowBlank:true,persist:true,encode:null,decode:null,bubbleEvents:"action"},constructor:applyType:updateType:applySortType:applyConvert:hasCustomConvert:function(){return this._hasCustomConvert}},1,0,0,0,["data.field"],0,[Ext.data,"Field"],0));(Ext.cmd.derive("Ext.data.identifier.Simple",Ext.Base,{statics:{AUTO_ID:1},config:{prefix:"ext-record-"},constructor:function(a){this.initConfig(a)},generate:,1,0,0,0,["data.identifier.simple"],0,[Ext.data.identifier,"Simple"],0));(Ext.cmd.derive("Ext.data.ModelManager",Ext.AbstractManager,{alternateClassName:["Ext.ModelMgr","Ext.ModelManager"],singleton:true,modelNamespace:null,registerType:onModelDefined:Ext.emptyFn,getModel:create:,0,0,0,0,0,0,[Ext.data,"ModelManager",Ext,"ModelMgr",Ext,"ModelManager"],);(Ext.cmd.derive("Ext.data.Request",Ext.Base,{config:{action:null,params:null,method:"GET",url:null,operation:null,proxy:null,disableCaching:false,headers:{},callbackKey:null,jsonP:null,jsonData:null,xmlData:null,withCredentials:null,username:null,password:null,callback:null,scope:null,timeout:30000,records:null,directFn:null,args:null,useDefaultXhrHeader:null},constructor:function(a){this.initConfig(a)}},1,0,0,0,0,0,[Ext.data,"Request"],0));(Ext.cmd.derive("Ext.data.proxy.Server",Ext.data.proxy.Proxy,{alternateClassName:"Ext.data.ServerProxy",config:{url:null,pageParam:"page",startParam:"start",limitParam:"limit",groupParam:"group",sortParam:"sort",filterParam:"filter",directionParam:"dir",enablePagingParams:true,simpleSortMode:false,noCache:true,cacheString:"_dc",timeout:30000,api:{create:undefined,read:undefined,update:undefined,destroy:undefined},extraParams:{}},constructor:create:function(){return this.doRequest.apply(this,arguments)},read:function(){return this.doRequest.apply(this,arguments)},update:function(){return this.doRequest.apply(this,arguments)},destroy:function(){return this.doRequest.apply(this,arguments)},setExtraParam:buildRequest:processResponse:getResponseResult:function(a){return a},setException:applyEncoding:function(a){return Ext.encode(a)},encodeSorters:function(d){var b=[],c=d.length,a=0;for(;a<c;a++){b[a]={property:d[a].getProperty(),direction:d[a].getDirection()}}return this.applyEncoding(b)},encodeFilters:getParams:buildUrl:getUrl:doRequest:function(){},afterRequest:Ext.emptyFn},1,0,0,0,["proxy.server"],0,[Ext.data.proxy,"Server",Ext.data,"ServerProxy"],0));(Ext.cmd.derive("Ext.data.proxy.Ajax",Ext.data.proxy.Server,{alternateClassName:["Ext.data.HttpProxy","Ext.data.AjaxProxy"],config:{withCredentials:false,useDefaultXhrHeader:true,username:null,password:null,actionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"},headers:{}},doRequest:getMethod:createRequestCallback:,0,0,0,0,["proxy.ajax"],0,[Ext.data.proxy,"Ajax",Ext.data,"HttpProxy",Ext.data,"AjaxProxy"],0));(Ext.cmd.derive("Ext.data.association.Association",Ext.Base,{alternateClassName:"Ext.data.Association",config:{ownerModel:null,ownerName:undefined,associatedModel:null,associatedName:undefined,associationKey:undefined,primaryKey:"id",reader:null,type:null,name:undefined},statics:{create:,constructor:function(a){this.initConfig(a)},applyName:applyOwnerModel:applyOwnerName:function(a){if(!a){a=this.getOwnerModel().modelName}a=a.slice(a.lastIndexOf(".")+1);return a},updateOwnerModel:function(a,b){if(b){this.setOwnerName(a.modelName)}},applyAssociatedModel:applyAssociatedName:updateAssociatedModel:applyReader:updateReader:,1,0,0,0,0,0,[Ext.data.association,"Association",Ext.data,"Association"],0));(Ext.cmd.derive("Ext.util.Inflector",Ext.Base,{singleton:true,plurals:[[(/(quiz)$/i),"$1zes"],[(/^(ox)$/i),"$1en"],[(/([m|l])ouse$/i),"$1ice"],[(/(matr|vert|ind)ix|ex$/i),"$1ices"],[(/(x|ch|ss|sh)$/i),"$1es"],[(/([^aeiouy]|qu)y$/i),"$1ies"],[(/(hive)$/i),"$1s"],[(/(?:([^f])fe|([lr])f)$/i),"$1$2ves"],[(/sis$/i),"ses"],[(/([ti])um$/i),"$1a"],[(/(buffal|tomat|potat)o$/i),"$1oes"],[(/(bu)s$/i),"$1ses"],[(/(alias|status|sex)$/i),"$1es"],[(/(octop|vir)us$/i),"$1i"],[(/(ax|test)is$/i),"$1es"],[(/^person$/),"people"],[(/^man$/),"men"],[(/^(child)$/),"$1ren"],[(/s$/i),"s"],[(/$/),"s"]],singulars:[[(/(quiz)zes$/i),"$1"],[(/(matr)ices$/i),"$1ix"],[(/(vert|ind)ices$/i),"$1ex"],[(/^(ox)en/i),"$1"],[(/(alias|status)es$/i),"$1"],[(/(octop|vir)i$/i),"$1us"],[(/(cris|ax|test)es$/i),"$1is"],[(/(shoe)s$/i),"$1"],[(/(o)es$/i),"$1"],[(/(bus)es$/i),"$1"],[(/([m|l])ice$/i),"$1ouse"],[(/(x|ch|ss|sh)es$/i),"$1"],[(/(m)ovies$/i),"$1ovie"],[(/(s)eries$/i),"$1eries"],[(/([^aeiouy]|qu)ies$/i),"$1y"],[(/([lr])ves$/i),"$1f"],[(/(tive)s$/i),"$1"],[(/(hive)s$/i),"$1"],[(/([^f])ves$/i),"$1fe"],[(/(^analy)ses$/i),"$1sis"],[(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i),"$1$2sis"],[(/([ti])a$/i),"$1um"],[(/(n)ews$/i),"$1ews"],[(/people$/i),"person"],[(/s$/i),""]],uncountable:["sheep","fish","series","species","money","rice","information","equipment","grass","mud","offspring","deer","means"],singular:function(b,a){this.singulars.unshift([b,a])},plural:clearSingulars:function(){this.singulars=[]},clearPlurals:function(){this.plurals=[]},isTransnumeral:pluralize:function(f){if(this.isTransnumeral(f)){return f}var e=this.plurals,d=e.length,a,c,b;for(b=0;b<d;b++){a=e[b];c=a[0];if(c==f||(c.test&&c.test(f))){return f.replace(c,a[1])}}return f},singularize:classify:ordinalize:,0,0,0,0,0,0,[Ext.util,"Inflector"],);(Ext.cmd.derive("Ext.data.association.HasMany",Ext.data.association.Association,{alternateClassName:"Ext.data.HasManyAssociation",config:{foreignKey:undefined,store:undefined,storeName:undefined,filterProperty:null,autoLoad:false,autoSync:false},constructor:applyName:applyStoreName:function(a){if(!a){a=this.getName()+"Store"}return a},applyForeignKey:function(b){if(!b){var a=this.getInverseAssociation();if(a){b=a.getForeignKey()}else{b=this.getOwnerName().toLowerCase()+"_id"}}return b},applyAssociationKey:updateForeignKey:function(b,d){var a=this.getAssociatedModel().getFields(),c=a.get(b);if(!c){c=new Ext.data.Field({name:b});a.add(c);a.isDirty=true}if(d){c=a.get(d);if(c){a.remove(c);a.isDirty=true}}},applyStore:onAddRecords:onRemoveRecords:updateStore:read:updateInverseInstances:getInverseAssociation:function(){var a=this.getOwnerModel().modelName;return this.getAssociatedModel().associations.findBy(function(b){return b.getType().toLowerCase()==="belongsto"&&b.getAssociatedModel().modelName===a})}},1,0,0,0,["association.hasmany"],0,[Ext.data.association,"HasMany",Ext.data,"HasManyAssociation"],0));(Ext.cmd.derive("Ext.data.association.BelongsTo",Ext.data.association.Association,{alternateClassName:"Ext.data.BelongsToAssociation",config:{foreignKey:undefined,getterName:undefined,setterName:undefined,instanceName:undefined},applyForeignKey:updateForeignKey:applyInstanceName:function(a){if(!a){a=this.getAssociatedName()+"BelongsToInstance"}return a},applyAssociationKey:function(a){if(!a){var b=this.getAssociatedName();a=b[0].toLowerCase()+b.slice(1)}return a},applyGetterName:function(a){if(!a){var b=this.getAssociatedName();a="get"+b[0].toUpperCase()+b.slice(1)}return a},applySetterName:function(a){if(!a){var b=this.getAssociatedName();a="set"+b[0].toUpperCase()+b.slice(1)}return a},updateGetterName:function(b,c){var a=this.getOwnerModel().prototype;if(c){delete a[c]}if(b){a[b]=this.createGetter()}},updateSetterName:function(b,c){var a=this.getOwnerModel().prototype;if(c){delete a[c]}if(b){a[b]=this.createSetter()}},createSetter:createGetter:read:getInverseAssociation:,0,0,0,0,["association.belongsto"],0,[Ext.data.association,"BelongsTo",Ext.data,"BelongsToAssociation"],0));(Ext.cmd.derive("Ext.data.association.HasOne",Ext.data.association.Association,{alternateClassName:"Ext.data.HasOneAssociation",config:{foreignKey:undefined,getterName:undefined,setterName:undefined,instanceName:undefined},applyForeignKey:updateForeignKey:applyInstanceName:applyAssociationKey:applyGetterName:function(a){if(!a){var b=this.getAssociatedName();a="get"+b[0].toUpperCase()+b.slice(1)}return a},applySetterName:updateGetterName:function(b,c){var a=this.getOwnerModel().prototype;if(c){delete a[c]}if(b){a[b]=this.createGetter()}},updateSetterName:createSetter:createGetter:read:getInverseAssociation:,0,0,0,0,["association.hasone"],0,[Ext.data.association,"HasOne",Ext.data,"HasOneAssociation"],0));(Ext.cmd.derive("Ext.data.Error",Ext.Base,{config:{field:null,message:""},constructor:function(a){this.initConfig(a)}},1,0,0,0,0,0,[Ext.data,"Error"],0));(Ext.cmd.derive("Ext.data.Errors",Ext.util.Collection,{isValid:getByField:add:,0,0,0,0,0,0,[Ext.data,"Errors"],0));(Ext.cmd.derive("Ext.data.Model",Ext.Base,{alternateClassName:"Ext.data.Record",isModel:true,config:{idProperty:"id",data:null,fields:undefined,validations:null,associations:null,hasMany:null,hasOne:null,belongsTo:null,proxy:null,identifier:{type:"simple"},clientIdProperty:"clientId",isErased:false,useCache:true},staticConfigs:["idProperty","fields","validations","associations","hasMany","hasOne","belongsTo","clientIdProperty","identifier","useCache","proxy"],statics:{EDIT:"edit",REJECT:"reject",COMMIT:"commit",cache:{},generateProxyMethod:generateCacheId:,inheritableStatics:{load:,editing:false,dirty:false,phantom:false,constructor:mergeData:setData:handleInlineAssociationData:setId:getId:setConvertedData:get:function(a){return this.data[a]},set:isEqual:beginEdit:cancelEdit:endEdit:changedWhileEditing:getChanges:isModified:function(a){return this.modified.hasOwnProperty(a)},save:erase:reject:commit:afterEdit:afterReject:function(){this.notifyStores("afterReject")},afterCommit:notifyStores:copy:getData:getAssociatedData:prepareAssociatedData:join:function(a){Ext.Array.include(this.stores,a)},unjoin:setDirty:validate:isValid:function(){return this.validate().isValid()},toUrl:destroy:applyProxy:updateProxy:applyAssociations:function(a){if(a){this.addAssociations(a,"hasMany")}},applyBelongsTo:function(a){if(a){this.addAssociations(a,"belongsTo")}},applyHasMany:function(a){if(a){this.addAssociations(a,"hasMany")}},applyHasOne:addAssociations:applyValidations:addValidations:applyFields:updateFields:applyIdentifier:getFieldName:function(a){return a.getName()},sortConvertFields:onClassExtended:,1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.data,"Model",Ext.data,"Record"],0));(Ext.cmd.derive("Ext.data.StoreManager",Ext.util.Collection,{alternateClassName:["Ext.StoreMgr","Ext.data.StoreMgr","Ext.StoreManager"],singleton:true,register:unregister:lookup:getKey:function(a){return a.getStoreId()}},0,0,0,0,0,0,[Ext.data,"StoreManager",Ext,"StoreMgr",Ext.data,"StoreMgr",Ext,"StoreManager"],);(Ext.cmd.derive("Ext.util.Grouper",Ext.util.Sorter,{isGrouper:true,config:{groupFn:null,sortProperty:null,sorterFn:,defaultSortFn:updateProperty:standardGroupFn:getGroupString:,0,0,0,0,0,0,[Ext.util,"Grouper"],0));(Ext.cmd.derive("Ext.data.Store",Ext.Evented,{statics:{create:,isStore:true,config:{storeId:undefined,data:null,autoLoad:null,autoSync:false,model:undefined,proxy:undefined,fields:null,remoteSort:false,remoteFilter:false,remoteGroup:false,filters:null,sorters:null,grouper:null,groupField:null,groupDir:null,getGroupString:null,pageSize:25,totalCount:null,clearOnPageLoad:true,params:{},modelDefaults:{},autoDestroy:false,syncRemovedRecords:true,destroyRemovedRecords:true,buffered:false,plugins:null},currentPage:1,constructor:applyPlugins:function(a){var c,b,d;if(!a){return a}a=[].concat(a);for(b=0,c=a.length;b<c;b++){d=a[b];a[b]=Ext.factory(d,"Ext.plugin.Plugin",null,"plugin")}return a},updatePlugins:function(d,a){var c,b;if(d){for(b=0,c=d.length;b<c;b++){d[b].init(this)}}if(a){for(b=0,c=a.length;b<c;b++){Ext.destroy(a[b])}}},createDataCollection:applyStoreId:updateStoreId:applyModel:updateModel:applyProxy:updateProxy:applyData:clearData:function(){this.setData(null)},addData:updateAutoLoad:isAutoLoading:updateGroupField:updateGroupDir:function(a){var b=this.getGrouper();if(b){b.setDirection(a)}},applyGetGroupString:applyGrouper:updateGrouper:isGrouped:updateSorters:updateSortTypes:updateFilters:function(a){this.data.setFilters(a)},add:insert:remove:removeAt:removeAll:doRemoveAll:each:function(b,a){this.data.each(b,a)},getCount:function(){return this.data.items.length||0},getAllCount:getAt:function(a){return this.data.getAt(a)},getRange:getById:indexOf:function(a){return this.data.indexOf(a)},indexOfId:function(a){return this.data.indexOfKey(a)},afterEdit:afterReject:afterCommit:afterErase:applyRemoteFilter:function(b){var a=this.getProxy();return b||(a&&a.isSQLProxy===true)},applyRemoteSort:function(b){var a=this.getProxy();return b||(a&&a.isSQLProxy===true)},applyRemoteGroup:updateRemoteFilter:function(a){this.data.setAutoFilter(!a)},updateRemoteSort:sort:filter:filterBy:queryBy:clearFilter:isFiltered:function(){return this.data.filtered},isSorted:function(){return this.data.sorted},getSorters:function(){var a=this.data.getSorters();return(a)?a.items:[]},getFilters:getGroups:getGroupString:find:findRecord:findExact:findBy:load:isLoading:function(){return Boolean(this.loading)},isLoaded:function(){return Boolean(this.loaded)},sync:first:function(){return this.data.first()},last:function(){return this.data.last()},sum:min:max:average:getBatchListeners:onBatchComplete:onBatchException:onProxyLoad:doDataRefresh:onProxyWrite:onCreateRecords:function(b,a,c){},onUpdateRecords:function(b,a,c){},onDestroyRecords:onMetaChange:getNewRecords:getUpdatedRecords:getRemovedRecords:function(){return this.removed},loadPage:nextPage:previousPage:destroy:,1,0,0,0,["store.store"],0,[Ext.data,"Store"],0));(Ext.cmd.derive("Ext.data.ArrayStore",Ext.data.Store,{config:{proxy:{type:"memory",reader:"array"}},loadData:,0,0,0,0,["store.array"],0,[Ext.data,"ArrayStore"],);(Ext.cmd.derive("Ext.data.Validations",Ext.Base,{alternateClassName:"Ext.data.validations",singleton:true,config:{presenceMessage:"must be present",lengthMessage:"is the wrong length",formatMessage:"is the wrong format",inclusionMessage:"is not included in the list of acceptable values",exclusionMessage:"is not an acceptable value",emailMessage:"is not a valid email address"},constructor:function(a){this.initConfig(a)},getMessage:emailRe:/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/,presence:length:email:format:inclusion:exclusion:,1,0,0,0,0,0,[Ext.data,"Validations",Ext.data,"validations"],0));(Ext.cmd.derive("Ext.data.reader.Array",Ext.data.reader.Json,{alternateClassName:"Ext.data.ArrayReader",config:{totalProperty:undefined,successProperty:undefined},createFieldAccessExpression:,0,0,0,0,["reader.array"],0,[Ext.data.reader,"Array",Ext.data,"ArrayReader"],0));(Ext.cmd.derive("Ext.device.communicator.Default",Ext.Base,{SERVER_URL:"http://localhost:3000",callbackDataMap:{},callbackIdMap:{},idSeed:0,globalScopeId:"0",generateId:getId:getCallbackId:getCallbackData:function(a){return this.callbackDataMap[a]},invoke:send:doSend:,0,0,0,0,0,0,[Ext.device.communicator,"Default"],0));(Ext.cmd.derive("Ext.device.communicator.Android",Ext.device.communicator.Default,{doSend:,0,0,0,0,0,0,[Ext.device.communicator,"Android"],0));(Ext.cmd.derive("Ext.device.Communicator",Ext.Base,{singleton:true,constructor:,1,0,0,0,0,0,[Ext.device,"Communicator"],0));(Ext.cmd.derive("Ext.device.connection.Abstract",Ext.Evented,{config:{online:false,type:null},UNKNOWN:"Unknown connection",ETHERNET:"Ethernet connection",WIFI:"WiFi connection",CELL_2G:"Cell 2G connection",CELL_3G:"Cell 3G connection",CELL_4G:"Cell 4G connection",NONE:"No network connection",isOnline:function(){return this.getOnline()}},0,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.device.connection,"Abstract"],0));(Ext.cmd.derive("Ext.device.connection.Sencha",Ext.device.connection.Abstract,{constructor:onConnectionChange:,1,0,0,0,0,0,[Ext.device.connection,"Sencha"],0));(Ext.cmd.derive("Ext.device.connection.Cordova",Ext.device.connection.Abstract,{alternateClassName:"Ext.device.connection.PhoneGap",constructor:syncOnline:getOnline:function(){this.syncOnline();return this._online},getType:,1,0,0,0,0,0,[Ext.device.connection,"Cordova",Ext.device.connection,"PhoneGap"],0));(Ext.cmd.derive("Ext.device.connection.Simulator",Ext.device.connection.Abstract,{getOnline:,0,0,0,0,0,0,[Ext.device.connection,"Simulator"],0));(Ext.cmd.derive("Ext.device.Connection",Ext.Base,{singleton:true,constructor:,1,0,0,0,0,0,[Ext.device,"Connection"],0));(Ext.cmd.derive("Ext.event.Event",Ext.Base,{alternateClassName:"Ext.EventObject",isStopped:false,set:stopEvent:function(){return this.stopPropagation()},stopPropagation:,0,0,0,0,0,0,[Ext.event,"Event",Ext,"EventObject"],0));(Ext.cmd.derive("Ext.event.Dom",Ext.event.Event,{constructor:stopEvent:preventDefault:function(){this.browserEvent.preventDefault()},getPageX:function(){return this.pageX||this.browserEvent.pageX},getPageY:getXY:getTarget:getTime:function(){return this.time},setDelegatedTarget:function(a){this.delegatedTarget=a},makeUnpreventable:,1,0,0,0,0,0,[Ext.event,"Dom"],0));(Ext.cmd.derive("Ext.event.Touch",Ext.event.Dom,{constructor:cloneTouches:,1,0,0,0,0,0,[Ext.event,"Touch"],0));(Ext.cmd.derive("Ext.event.publisher.Publisher",Ext.Base,{targetType:"",idSelectorRegex:/^#([\w\-]+)$/i,constructor:handles:getHandledEvents:function(){return this.handledEvents},setDispatcher:function(a){this.dispatcher=a},subscribe:function(){return false},unsubscribe:function(){return false},unsubscribeAll:notify:function(){return false},getTargetType:function(){return this.targetType},dispatch:,1,0,0,0,0,0,[Ext.event.publisher,"Publisher"],0));(Ext.cmd.derive("Ext.event.publisher.ComponentDelegation",Ext.event.publisher.Publisher,{targetType:"component",optimizedSelectorRegex:/^#([\w\-]+)((?:[\s]*)>(?:[\s]*)|(?:\s*))([\w\-]+)$/i,handledEvents:["*"],getSubscribers:subscribe:unsubscribe:notify:matchesSelector:dispatch:publish:,0,0,0,0,0,0,[Ext.event.publisher,"ComponentDelegation"],0));(Ext.cmd.derive("Ext.event.publisher.ComponentPaint",Ext.event.publisher.Publisher,{targetType:"component",handledEvents:["erased"],eventNames:{painted:"painted",erased:"erased"},constructor:getSubscribers:setDispatcher:subscribe:unsubscribe:onBeforeComponentRenderedChange:onBeforeComponentHiddenChange:onComponentRenderedChange:onComponentHiddenChange:dispatchQueue:publish:,1,0,0,0,0,0,[Ext.event.publisher,"ComponentPaint"],0));(Ext.cmd.derive("Ext.event.publisher.Dom",Ext.event.publisher.Publisher,{targetType:"element",idOrClassSelectorRegex:/^([#|\.])([\w\-]+)$/,handledEvents:["focus","blur","paste","input","change","keyup","keydown","keypress","submit","transitionend","animationstart","animationend"],classNameSplitRegex:/\s+/,SELECTOR_ALL:"*",constructor:getSubscribers:getVendorEventName:bindListeners:bindListener:attachListener:removeListener:doesEventBubble:subscribe:unsubscribe:getElementTarget:getBubblingTargets:dispatch:publish:doPublish:matchesSelector:),onEvent:getSubscribersCount:,1,0,0,0,0,0,[Ext.event.publisher,"Dom"],0));(Ext.cmd.derive("Ext.util.paintmonitor.Abstract",Ext.Base,{config:{element:null,callback:Ext.emptyFn,scope:null,args:[]},eventName:"",monitorClass:"",constructor:bindListeners:function(b){var a=this;if(this.eventName==Ext.browser.is.WebKit?"webkitAnimationEnd":"animationend"&&Ext.os.is.iOS){a.paintTimeout=setTimeout(function(){if(!a.elementHasPainted){a.onElementPainted({animationName:"x-paint-monitor-helper"})}},100)}this.monitorElement[b?"addEventListener":"removeEventListener"](this.eventName,function(c){a.elementHasPainted=true;a.onElementPainted(c);if(a.paintTimeout!=null){clearTimeout(a.paintTimeout)}},true)},applyElement:function(a){if(a){return Ext.get(a)}},updateElement:onElementPainted:function(){},destroy:,1,0,0,0,0,0,[Ext.util.paintmonitor,"Abstract"],0));(Ext.cmd.derive("Ext.util.paintmonitor.CssAnimation",Ext.util.paintmonitor.Abstract,{eventName:Ext.browser.is.WebKit?"webkitAnimationEnd":"animationend",monitorClass:"cssanimation",onElementPainted:,0,0,0,0,0,0,[Ext.util.paintmonitor,"CssAnimation"],0));(Ext.cmd.derive("Ext.util.paintmonitor.OverflowChange",Ext.util.paintmonitor.Abstract,{eventName:Ext.browser.is.Firefox?"overflow":"overflowchanged",monitorClass:"overflowchange",onElementPainted:,0,0,0,0,0,0,[Ext.util.paintmonitor,"OverflowChange"],0));(Ext.cmd.derive("Ext.util.PaintMonitor",Ext.Base,{constructor:,1,0,0,0,0,0,[Ext.util,"PaintMonitor"],0));Ext.define("InfinityMobile.util.PaintMonitor",{override:"Ext.util.PaintMonitor",constructor:,function(){});(Ext.cmd.derive("Ext.event.publisher.ElementPaint",Ext.event.publisher.Publisher,{targetType:"element",handledEvents:["painted"],constructor:function(){this.monitors={};Ext.event.publisher.Publisher.prototype.constructor.apply(this,arguments)},subscribe:unsubscribe:onElementPainted:,1,0,0,0,0,0,[Ext.event.publisher,"ElementPaint"],0));(Ext.cmd.derive("Ext.mixin.Templatable",Ext.mixin.Mixin,{mixinConfig:{id:"templatable"},referenceAttributeName:"reference",referenceSelector:"[reference]",getElementConfig:getElementTemplate:initElement:linkElement:function(a,b){this.link(a,b)},doInitElement:,0,0,0,0,0,0,[Ext.mixin,"Templatable"],0));(Ext.cmd.derive("Ext.util.sizemonitor.Abstract",Ext.Base,{config:{element:null,callback:Ext.emptyFn,scope:null,args:[]},width:0,height:0,contentWidth:0,contentHeight:0,constructor:bindListeners:Ext.emptyFn,applyElement:function(a){if(a){return Ext.get(a)}},updateElement:applyArgs:refreshMonitors:Ext.emptyFn,forceRefresh:function(){Ext.TaskQueue.requestRead("refresh",this)},getContentBounds:function(){return this.detectorsContainer.getBoundingClientRect()},getContentWidth:function(){return this.detectorsContainer.offsetWidth},getContentHeight:function(){return this.detectorsContainer.offsetHeight},refreshSize:refresh:destroy:,1,0,0,0,0,[[Ext.mixin.Templatable.prototype.mixinId||Ext.mixin.Templatable.$className,Ext.mixin.Templatable]],[Ext.util.sizemonitor,"Abstract"],0));(Ext.cmd.derive("Ext.util.sizemonitor.Default",Ext.util.sizemonitor.Abstract,{updateElement:function(a){},bindListeners:getContentBounds:getContentWidth:function(){return this.getElement().getWidth()},getContentHeight:function(){return this.getElement().getHeight()}},0,0,0,0,0,0,[Ext.util.sizemonitor,"Default"],0));(Ext.cmd.derive("Ext.util.sizemonitor.Scroll",Ext.util.sizemonitor.Abstract,{getElementConfig:constructor:bindListeners:forceRefresh:onScroll:refreshMonitors:,1,0,0,0,0,0,[Ext.util.sizemonitor,"Scroll"],0));(Ext.cmd.derive("Ext.util.sizemonitor.OverflowChange",Ext.util.sizemonitor.Abstract,{constructor:getElementConfig:bindListeners:onExpand:onShrink:refreshMonitors:,1,0,0,0,0,0,[Ext.util.sizemonitor,"OverflowChange"],0));(Ext.cmd.derive("Ext.util.SizeMonitor",Ext.Base,{constructor:,1,0,0,0,0,0,[Ext.util,"SizeMonitor"],0));Ext.define("InfinityMobile.util.SizeMonitor",{override:"Ext.util.SizeMonitor",constructor:,function(){});(Ext.cmd.derive("Ext.event.publisher.ElementSize",Ext.event.publisher.Publisher,{targetType:"element",handledEvents:["resize"],constructor:subscribe:unsubscribe:onElementResize:,1,0,0,0,0,0,[Ext.event.publisher,"ElementSize"],0));(Ext.cmd.derive("Ext.event.publisher.TouchGesture",Ext.event.publisher.Dom,{isNotPreventable:/^(select|a)$/i,handledEvents:["touchstart","touchmove","touchend","touchcancel"],mouseToTouchMap:{mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},lastEventType:null,config:{moveThrottle:0,recognizers:{}},constructor:function(a){var b=function(){if(window.screen.width<=1024&&navigator.userAgent.toLowerCase().indexOf("macintosh")!=-1&&d()&&!Ext.os.is.Phone){return true}return false};var d=function(){return"ontouchstart" in window};var c=this;this.eventProcessors={touchstart:this.onTouchStart,touchmove:this.onTouchMove,touchend:c.onTouchEnd,touchcancel:c.onTouchEnd};this.eventToRecognizerMap={};this.activeRecognizers=[];this.touchesMap={};this.currentIdentifiers=[];if(Ext.browser.is.Chrome&&Ext.os.is.Android){this.screenPositionRatio=Ext.browser.version.gt("18")?1:1/window.devicePixelRatio}else{if(Ext.browser.is.AndroidStock4){this.screenPositionRatio=1}else{if(Ext.os.is.BlackBerry){this.screenPositionRatio=1/window.devicePixelRatio}else{if(Ext.browser.engineName=="WebKit"&&Ext.os.is.Desktop){this.screenPositionRatio=1}else{this.screenPositionRatio=window.innerWidth/window.screen.width}}}}this.initConfig(a);if(Ext.feature.has.Touch||b()){c.onTargetTouchMove=c.onTargetTouchMove.bind(c);c.onTargetTouchEnd=c.onTargetTouchEnd.bind(c)}return Ext.event.publisher.Dom.prototype.constructor.call(this)},applyRecognizers:handles:doesEventBubble:function(){return true},onEvent:function(f){var d=f.type,b=this.lastEventType,c=[f];if(this.eventProcessors[d]){this.eventProcessors[d].call(this,f);if(d==="touchend"&&b&&b==="touchstart"){f.preventDefault()}this.lastEventType=d;return}if("button" in f&&f.button>0){return}else{if(d==="mousedown"&&b&&b!=="mouseup"){var a=document.createEvent("MouseEvent");a.initMouseEvent("mouseup",f.bubbles,f.cancelable,document.defaultView,f.detail,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.metaKey,f.relatedTarget);this.onEvent(a)}if(d!=="mousemove"){this.lastEventType=d}f.identifier=1;f.touches=(d!=="mouseup")?c:[];f.targetTouches=(d!=="mouseup")?c:[];f.changedTouches=c;this.eventProcessors[this.mouseToTouchMap[d]].call(this,f)}},registerRecognizer:onRecognized:publish:getCommonTargets:invokeRecognizers:getActiveRecognizers:function(){return this.activeRecognizers},updateTouch:updateTouches:factoryEvent:onTouchStart:function(f){var k=f.changedTouches,g=f.target,h=k.length,a=this.isNotPreventable,b=(f.type==="touchstart"),j=this,d,c,l;this.updateTouches(k);f=this.factoryEvent(f);k=f.changedTouches;if(Ext.browser.is.AndroidStock&&this.currentIdentifiers.length>=2){f.preventDefault()}if(b){g.addEventListener("touchmove",j.onTargetTouchMove,{passive:true});g.addEventListener("touchend",j.onTargetTouchEnd);g.addEventListener("touchcancel",j.onTargetTouchEnd)}for(d=0;d<h;d++){c=k[d];this.publish("touchstart",c.targets,f,{touch:c})}if(!this.isStarted){this.isStarted=true;this.invokeRecognizers("onStart",f)}this.invokeRecognizers("onTouchStart",f);l=g.parentNode||{}},onTouchMove:onAnimationFrame:doTouchMove:onTouchEnd:onTargetTouchMove:onTargetTouchEnd:function(g){var d=this,f=g.target,b=0,h;for(identifier in this.touchesMap){h=this.touchesMap[identifier].target;if(h===f){b++}}if(b<=1){f.removeEventListener("touchmove",d.onTargetTouchMove);f.removeEventListener("touchend",d.onTargetTouchEnd);f.removeEventListener("touchcancel",d.onTargetTouchEnd)}if(!Ext.getBody().contains(f)){var a=false;try{d.onTouchEnd(g)}catch(c){console.error("[TouchGesture]: Error attempting onTouchEnd, Manually firing.\n",c);a=true}}}},1,0,0,0,0,0,[Ext.event.publisher,"TouchGesture"],function(){if(Ext.feature.has.Pointer){this.override({pointerToTouchMap:{MSPointerDown:"touchstart",MSPointerMove:"touchmove",MSPointerUp:"touchend",MSPointerCancel:"touchcancel",pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"},touchToPointerMapEdge:{touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},touchToPointerMap:{touchstart:"MSPointerDown",touchmove:"MSPointerMove",touchend:"MSPointerUp",touchcancel:"MSPointerCancel"},attachListener:onEvent:)}else{if(!Ext.browser.is.Ripple&&(Ext.os.is.ChromeOS||!Ext.feature.has.Touch)){var a=function(){if(window.screen.width<=1024&&navigator.userAgent.toLowerCase().indexOf("macintosh")!=-1&&b()&&!Ext.os.is.Phone){return true}return false};var b=function(){return"ontouchstart" in window};if(a()){}else{this.override({handledEvents:["touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup"]})}}}}));(Ext.cmd.derive("Ext.event.recognizer.Recognizer",Ext.Base,{handledEvents:[],config:{onRecognized:Ext.emptyFn,onFailed:Ext.emptyFn,callbackScope:null},constructor:function(a){this.initConfig(a);return this},getHandledEvents:function(){return this.handledEvents},onStart:Ext.emptyFn,onEnd:Ext.emptyFn,fail:fire:,1,0,0,0,0,[[Ext.mixin.Identifiable.prototype.mixinId||Ext.mixin.Identifiable.$className,Ext.mixin.Identifiable]],[Ext.event.recognizer,"Recognizer"],0));(Ext.cmd.derive("Ext.event.recognizer.Touch",Ext.event.recognizer.Recognizer,{onTouchStart:Ext.emptyFn,onTouchMove:Ext.emptyFn,onTouchEnd:Ext.emptyFn},0,0,0,0,0,0,[Ext.event.recognizer,"Touch"],0));(Ext.cmd.derive("Ext.event.recognizer.SingleTouch",Ext.event.recognizer.Touch,{inheritableStatics:{NOT_SINGLE_TOUCH:1,TOUCH_MOVED:2},onTouchStart:,0,0,0,0,0,0,[Ext.event.recognizer,"SingleTouch"],0));(Ext.cmd.derive("Ext.event.recognizer.DoubleTap",Ext.event.recognizer.SingleTouch,{inheritableStatics:{DIFFERENT_TARGET:3},config:{maxDuration:300,moveDistance:15},handledEvents:["singletap","doubletap"],singleTapTimer:null,startTime:0,lastTapTime:0,onTouchStart:onTouchMove:onEnd:fireSingleTap:,0,0,0,0,0,0,[Ext.event.recognizer,"DoubleTap"],0));(Ext.cmd.derive("Ext.event.recognizer.Drag",Ext.event.recognizer.SingleTouch,{isStarted:false,startPoint:null,previousPoint:null,lastPoint:null,handledEvents:["dragstart","drag","dragend"],config:{minDistance:8},constructor:onTouchStart:tryDragStart:onTouchMove:onAxisDragEnd:resetInfo:updateInfo:onTouchEnd:,1,0,0,0,0,0,[Ext.event.recognizer,"Drag"],0));(Ext.cmd.derive("Ext.event.recognizer.Swipe",Ext.event.recognizer.SingleTouch,{handledEvents:["swipestart","swipe"],inheritableStatics:{MAX_OFFSET_EXCEEDED:16,MAX_DURATION_EXCEEDED:17,DISTANCE_NOT_ENOUGH:18},config:{minDistance:80,maxOffset:35,maxDuration:1000},onTouchStart:onTouchMove:onTouchEnd:,0,0,0,0,0,0,[Ext.event.recognizer,"Swipe"],0));(Ext.cmd.derive("Ext.event.recognizer.EdgeSwipe",Ext.event.recognizer.Swipe,{handledEvents:["edgeswipe","edgeswipestart","edgeswipeend"],inheritableStatics:{NOT_NEAR_EDGE:19},config:{minDistance:60},onTouchStart:onTouchMove:onTouchEnd:,0,0,0,0,0,0,[Ext.event.recognizer,"EdgeSwipe"],0));(Ext.cmd.derive("Ext.event.recognizer.LongPress",Ext.event.recognizer.SingleTouch,{inheritableStatics:{DURATION_NOT_ENOUGH:32},config:{minDuration:1000},handledEvents:["longpress"],fireLongPress:onTouchStart:onTouchMove:onTouchEnd:fail:,0,0,0,0,0,0,[Ext.event.recognizer,"LongPress"],);(Ext.cmd.derive("Ext.event.recognizer.MultiTouch",Ext.event.recognizer.Touch,{requiredTouchesCount:2,isTracking:false,isStarted:false,onTouchStart:onTouchEnd:function(a){this.end(a)},start:end:,0,0,0,0,0,0,[Ext.event.recognizer,"MultiTouch"],0));(Ext.cmd.derive("Ext.event.recognizer.Pinch",Ext.event.recognizer.MultiTouch,{requiredTouchesCount:2,handledEvents:["pinchstart","pinch","pinchend"],startDistance:0,lastTouches:null,onTouchMove:function(c){if(!this.isTracking||c.touches[1]==null){return}var b=Array.prototype.slice.call(c.touches),d,a,f;if(b!=null){d=b[0].point;a=b[1].point;f=d.getDistanceTo(a);if(f===0){return}if(!this.isStarted){this.isStarted=true;this.startDistance=f;this.fire("pinchstart",c,b,{touches:b,distance:f,scale:1})}else{this.fire("pinch",c,b,{touches:b,distance:f,scale:f/this.startDistance})}}this.lastTouches=b},fireEnd:fail:,0,0,0,0,0,0,[Ext.event.recognizer,"Pinch"],0));(Ext.cmd.derive("Ext.event.recognizer.Rotate",Ext.event.recognizer.MultiTouch,{requiredTouchesCount:2,handledEvents:["rotatestart","rotate","rotateend"],startAngle:0,lastTouches:null,lastAngle:null,onTouchMove:function(h){if(!this.isTracking||h.touches[1]==null){return}var g=Array.prototype.slice.call(h.touches),b=this.lastAngle,d,f,c,a,j,k;d=g[0].point;f=g[1].point;c=d.getAngleTo(f);if(b!==null){k=Math.abs(b-c);a=c+360;j=c-360;if(Math.abs(a-b)<k){c=a}else{if(Math.abs(j-b)<k){c=j}}}this.lastAngle=c;if(!this.isStarted){this.isStarted=true;this.startAngle=c;this.fire("rotatestart",h,g,{touches:g,angle:c,rotation:0})}else{this.fire("rotate",h,g,{touches:g,angle:c,rotation:c-this.startAngle})}this.lastTouches=g},fireEnd:,0,0,0,0,0,0,[Ext.event.recognizer,"Rotate"],0));(Ext.cmd.derive("Ext.event.recognizer.Tap",Ext.event.recognizer.SingleTouch,{handledEvents:["tap","tapcancel"],config:{moveDistance:15},onTouchStart:onTouchMove:onTouchEnd:,0,0,0,0,0,0,[Ext.event.recognizer,"Tap"],0));(Ext.cmd.derive("Ext.field.Checkbox",Ext.field.Field,{alternateClassName:"Ext.form.Checkbox",qsaLeftRe:/[\[]/g,qsaRightRe:/[\]]/g,isCheckbox:true,config:{ui:"checkbox",value:"",checked:false,tabIndex:-1,component:{xtype:"input",type:"checkbox",useMask:true,cls:"x-input-checkbox"}},platformConfig:[{theme:["Windows","Blackberry","Tizen"],labelAlign:"left"}],initialize:function(){var b=this,a=b.getComponent();Ext.field.Field.prototype.initialize.call(this);a.on({scope:b,order:"before",masktap:"onMaskTap"});a.doMaskTap=Ext.emptyFn;b.label.on({scope:b,tap:"onMaskTap"})},doInitValue:function(){var a=this,b=a.getInitialConfig();if(b.hasOwnProperty("value")){a.originalState=b.value}if(b.hasOwnProperty("checked")){a.originalState=b.checked}Ext.field.Field.prototype.doInitValue.apply(this,arguments)},updateInputType:function(a){var b=this.getComponent();if(b){b.setType(a)}},updateName:function(a){var b=this.getComponent();if(b){b.setName(a)}},getChecked:function(){this._checked=this.getComponent().getChecked();return this._checked},getSubmitValue:function(){return(this.getChecked())?Ext.isEmpty(this._value)?true:this._value:null},setChecked:updateChecked:function(a){this.getComponent().setChecked(a);if(this.initialized){this.onChange()}},onMaskTap:function(a,c){var b=this,d=b.getComponent().input.dom;if(b.getDisabled()){return false}d.checked=!d.checked;b.onChange(c);return false},onChange:function(d){var c=this,b=c._checked,a=c.getChecked();if(b!=a){if(a){c.fireEvent("check",c,d)}else{c.fireEvent("uncheck",c,d)}c.fireEvent("change",c,a,b)}},doChecked:Ext.emptyFn,doUnChecked:Ext.emptyFn,isChecked:function(){return this.getChecked()},check:function(){return this.setChecked(true)},uncheck:function(){return this.setChecked(false)},getSameGroupFields:function(){var k=this,l=k.up("formpanel")||k.up("fieldset"),b=k.getName(),h=k.qsaLeftRe,c=k.qsaRightRe,f=k.getBaseCls().split(" ").join("."),g=[],a,e,d,j;if(!l){l=Ext.Viewport}b=b.replace(h,"\\[");b=b.replace(c,"\\]");a=Ext.query("[name="+b+"]",l.element.dom);j=a.length;for(d=0;d<j;d++){e=a[d];e=Ext.fly(e).up("."+f);if(e&&e.id){g.push(Ext.getCmp(e.id))}}return g},getGroupValues:function(){var a=[];this.getSameGroupFields().forEach(function(b){if(b.getChecked()){a.push(b.getValue())}});return a},setGroupValues:function(a){this.getSameGroupFields().forEach(function(b){b.setChecked((a.indexOf(b.getValue())!==-1))});return this},resetGroupValues:function(){this.getSameGroupFields().forEach(;return this},reset:function(){this.setChecked(this.originalState);return this}},0,["checkboxfield"],["component","field","checkboxfield"],{component:true,field:true,checkboxfield:true},["widget.checkboxfield"],0,[Ext.field,"Checkbox",Ext.form,"Checkbox"],0));(Ext.cmd.derive("Ext.field.Radio",Ext.field.Checkbox,{alternateClassName:"Ext.form.Radio",isRadio:true,config:{ui:"radio",component:{type:"radio",cls:"x-input-radio"}},getValue:setValue:function(a){this._value=a;return this},getSubmitValue:function(){var a=this._value;if(typeof a=="undefined"||a==null){a=true}return(this.getChecked())?a:null},updateChecked:function(a){this.getComponent().setChecked(a);if(this.initialized){this.refreshGroupValues()}},onMaskTap:function(a,c){var b=this,d=b.getComponent().input.dom;if(b.getDisabled()){return false}if(!b.getChecked()){d.checked=true}b.refreshGroupValues();return false},getGroupValue:function(){var a=this.getSameGroupFields(),c=a.length,b=0,d;for(;b<c;b++){d=a[b];if(d.getChecked()){return d.getValue()}}return null},setGroupValue:function(d){var a=this.getSameGroupFields(),c=a.length,b=0,e;for(;b<c;b++){e=a[b];if(e.getValue()===d){e.setChecked(true);return e}}},refreshGroupValues:function(){var a=this.getSameGroupFields(),c=a.length,b=0,d;for(;b<c;b++){d=a[b];d.onChange()}}},0,["radiofield"],["component","field","checkboxfield","radiofield"],{component:true,field:true,checkboxfield:true,radiofield:true},["widget.radiofield"],0,[Ext.field,"Radio",Ext.form,"Radio"],0));(Ext.cmd.derive("Ext.slider.Thumb",Ext.Component,{config:{baseCls:"x-thumb",pressedCls:"x-thumb-pressing",draggable:{direction:"horizontal"}},platformConfig:[{platform:["ie10"],draggable:{translatable:{translationMethod:"csstransform"}}}],elementWidth:0,initialize:getTemplate:updatePressedCls:onPress:onRelease:function(a){this.fireAction("release",[this,a],"doRelease")},doRelease:onDragStart:function(){if(this.isDisabled()){return false}this.relayEvent(arguments)},onDrag:function(){if(this.isDisabled()){return false}this.relayEvent(arguments)},onDragEnd:onElementResize:getElementWidth:function(){return this.elementWidth}},0,["thumb"],["component","thumb"],{component:true,thumb:true},["widget.thumb"],0,[Ext.slider,"Thumb"],0));(Ext.cmd.derive("Ext.slider.Slider",Ext.Container,{config:{baseCls:"x-slider",thumbConfig:{draggable:{translatable:{easingX:{duration:300,type:"ease-out"}}}},increment:1,value:0,minValue:0,maxValue:100,allowThumbsOverlapping:false,animation:true,readOnly:false},elementWidth:0,offsetValueRatio:0,activeThumb:null,constructor:initialize:factoryThumb:getThumbs:function(){return this.innerItems},getThumb:refreshOffsetValueRatio:onThumbResize:onResize:refresh:function(){this.refreshValue()},setActiveThumb:onThumbDragStart:onThumbDrag:setIndexValue:onThumbDragEnd:getThumbIndex:function(a){return this.getThumbs().indexOf(a)},refreshThumbConstraints:onTap:updateThumbs:function(a){this.add(a)},applyValue:updateValue:refreshValue:constrainValue:setThumbsCount:setValues:function(a){this.setValue(a)},getValues:function(){return this.getValue()},applyIncrement:updateAllowThumbsOverlapping:function(b,a){if(typeof a!="undefined"){this.refreshValue()}},updateMinValue:function(b,a){if(typeof a!="undefined"){this.refreshValue()}},updateMaxValue:function(b,a){if(typeof a!="undefined"){this.refreshValue()}},updateIncrement:doSetDisabled:,1,["slider"],["component","container","slider"],{component:true,container:true,slider:true},["widget.slider"],0,[Ext.slider,"Slider"],function(){}));(Ext.cmd.derive("Ext.field.Slider",Ext.field.Field,{alternateClassName:"Ext.form.Slider",config:{cls:"x-slider-field",tabIndex:-1,readOnly:false},proxyConfig:{increment:1,value:0,minValue:0,maxValue:100},constructor:initialize:applyComponent:function(a){return Ext.factory(a,Ext.slider.Slider)},updateComponent:onSliderChange:function(){this.fireEvent.apply(this,[].concat("change",this,Array.prototype.slice.call(arguments)))},onSliderDragStart:function(){this.fireEvent.apply(this,[].concat("dragstart",this,Array.prototype.slice.call(arguments)))},onSliderDrag:function(){this.fireEvent.apply(this,[].concat("drag",this,Array.prototype.slice.call(arguments)))},onSliderDragEnd:setValues:function(a){this.setValue(a);this.updateMultipleState()},getValues:function(){return this.getValue()},reset:doSetDisabled:updateReadOnly:function(a){this.getComponent().setReadOnly(a)},isDirty:updateMultipleState:,1,["sliderfield"],["component","field","sliderfield"],{component:true,field:true,sliderfield:true},["widget.sliderfield"],0,[Ext.field,"Slider",Ext.form,"Slider"],0));(Ext.cmd.derive("Ext.slider.Toggle",Ext.slider.Slider,{config:{baseCls:"x-toggle",minValueCls:"x-toggle-off",maxValueCls:"x-toggle-on"},initialize:applyMinValue:function(){return 0},applyMaxValue:function(){return 1},applyIncrement:function(){return 1},updateMinValueCls:function(c,b){var a=this.element;if(b&&a.hasCls(b)){a.replaceCls(b,c)}},updateMaxValueCls:setValue:setIndexValue:onChange:toggle:function(){var a=this.getValue();this.setValue((a==1)?0:1);return this},onTap:,0,0,["component","container","slider"],{component:true,container:true,slider:true},0,0,[Ext.slider,"Toggle"],0));(Ext.cmd.derive("Ext.field.Toggle",Ext.field.Slider,{alternateClassName:"Ext.form.Toggle",config:{cls:"x-toggle-field",labelAlign:"left",activeLabel:null,inactiveLabel:null},platformConfig:[{theme:["Windows"],labelAlign:"left"},{theme:["Blackberry","MountainView"],activeLabel:"On",inactiveLabel:"Off"}],proxyConfig:{minValueCls:"x-toggle-off",maxValueCls:"x-toggle-on"},applyComponent:updateActiveLabel:function(b,a){if(b!=a){this.getComponent().element.dom.setAttribute("data-activelabel",b)}},updateInactiveLabel:setValue:getValue:onSliderChange:toggle:onChange:,0,["togglefield"],["component","field","sliderfield","togglefield"],{component:true,field:true,sliderfield:true,togglefield:true},["widget.togglefield"],0,[Ext.field,"Toggle",Ext.form,"Toggle"],0));(Ext.cmd.derive("Ext.fx.runner.Css",Ext.Evented,{prefixedProperties:{transform:true,"transform-origin":true,perspective:true,"transform-style":true,transition:true,"transition-property":true,"transition-duration":true,"transition-timing-function":true,"transition-delay":true,animation:true,"animation-name":true,"animation-duration":true,"animation-iteration-count":true,"animation-direction":true,"animation-timing-function":true,"animation-delay":true},lengthProperties:{top:true,right:true,bottom:true,left:true,width:true,height:true,"max-height":true,"max-width":true,"min-height":true,"min-width":true,"margin-bottom":true,"margin-left":true,"margin-right":true,"margin-top":true,"padding-bottom":true,"padding-left":true,"padding-right":true,"padding-top":true,"border-bottom-width":true,"border-left-width":true,"border-right-width":true,"border-spacing":true,"border-top-width":true,"border-width":true,"outline-width":true,"letter-spacing":true,"line-height":true,"text-indent":true,"word-spacing":true,"font-size":true,translate:true,translateX:true,translateY:true,translateZ:true,translate3d:true},durationProperties:{"transition-duration":true,"transition-delay":true,"animation-duration":true,"animation-delay":true},angleProperties:{rotate:true,rotateX:true,rotateY:true,rotateZ:true,skew:true,skewX:true,skewY:true},lengthUnitRegex:/([a-z%]*)$/,DEFAULT_UNIT_LENGTH:"px",DEFAULT_UNIT_ANGLE:"deg",DEFAULT_UNIT_DURATION:"ms",formattedNameCache:{},constructor:getStyleSheet:applyRules:applyStyles:formatName:formatValue:,1,0,0,0,0,0,[Ext.fx.runner,"Css"],0));(Ext.cmd.derive("Ext.fx.runner.CssTransition",Ext.fx.runner.Css,{listenersAttached:false,constructor:attachListeners:onTransitionEnd:onAnimationEnd:onAllAnimationsEnd:hasRunningAnimations:refreshRunningAnimationsData:getRunningData:getTestElement:getCssStyleValue:run:onAnimationStop:,1,0,0,0,0,0,[Ext.fx.runner,"CssTransition"],0));(Ext.cmd.derive("Ext.fx.Runner",Ext.Base,{constructor:,1,0,0,0,0,0,[Ext.fx,"Runner"],0));(Ext.cmd.derive("Ext.log.Base",Ext.Base,{config:{},constructor:function(a){this.initConfig(a);return this}},1,0,0,0,0,0,[Ext.log,"Base"],0));(();(Ext.cmd.derive("Ext.log.formatter.Formatter",Ext.log.Base,{config:{messageFormat:"{message}"},format:substitute:,0,0,0,0,0,0,[Ext.log.formatter,"Formatter"],0));(Ext.cmd.derive("Ext.log.formatter.Default",Ext.log.formatter.Formatter,{config:{messageFormat:"[{priorityName}][{callerDisplayName}] {message}"},format:,0,0,0,0,0,0,[Ext.log.formatter,"Default"],0));(Ext.cmd.derive("Ext.log.writer.Writer",Ext.log.Base,{config:{formatter:null,filters:{}},constructor:updateFilters:write:doWrite:Ext.emptyFn},1,0,0,0,0,0,[Ext.log.writer,"Writer"],0));(Ext.cmd.derive("Ext.log.writer.Console",Ext.log.writer.Writer,{config:{throwOnErrors:true,throwOnWarnings:false},doWrite:,0,0,0,0,0,0,[Ext.log.writer,"Console"],0));(Ext.cmd.derive("Ext.viewport.Default",Ext.Container,{PORTRAIT:"portrait",LANDSCAPE:"landscape",config:{autoMaximize:false,autoBlurInput:true,preventPanning:true,preventZooming:false,autoRender:true,layout:"card",width:"100%",height:"100%",useBodyElement:true,menus:{}},isReady:false,isViewport:true,isMaximizing:false,id:"ext-viewport",isInputRegex:/^(input|textarea|select|a)$/i,focusedElement:null,fullscreenItemCls:"x-fullscreen",constructor:onDomReady:onReady:onElementFocus:onElementBlur:function(){this.focusedElement=null},render:applyAutoBlurInput:function(a){var b=(Ext.feature.has.Touch)?"touchstart":"mousedown";if(a){this.addWindowListener(b,this.doBlurInput,false)}else{this.removeWindowListener(b,this.doBlurInput,false)}return a},applyAutoMaximize:applyPreventPanning:applyPreventZooming:doAutoMaximizeOnReady:doAutoMaximizeOnOrientationChange:doBlurInput:doPreventPanning:function(a){},doPreventZooming:addWindowListener:function(b,c,a){window.addEventListener(b,c,Boolean(a))},removeWindowListener:doAddListener:supportsOrientation:onResize:onOrientationChange:fireOrientationChangeEvent:updateSize:waitUntil:maximize:function(){this.fireMaximizeEvent()},fireMaximizeEvent:doSetHeight:function(a){Ext.getBody().setHeight(a);Ext.Container.prototype.doSetHeight.apply(this,arguments)},doSetWidth:scrollToTop:getWindowWidth:function(){return window.innerWidth},getWindowHeight:function(){return window.innerHeight},getWindowOuterHeight:function(){return window.outerHeight},getWindowOrientation:getOrientation:function(){return this.orientation},getSize:determineOrientation:onItemFullscreenChange:setMenu:removeMenu:fixMenuSize:showMenu:hideMenu:hideAllMenus:hideOtherMenus:toggleMenu:sideForDirection:sideForSwipeDirection:onTap:onSwipeStart:onEdgeSwipeStart:onEdgeSwipe:onEdgeSwipeEnd:,1,["viewport"],["component","container","viewport"],{component:true,container:true,viewport:true},["widget.viewport"],0,[Ext.viewport,"Default"],0));(Ext.cmd.derive("Ext.viewport.Android",Ext.viewport.Default,{config:{translatable:{translationMethod:"csstransform"}},constructor:getWindowWidth:function(){return this.element.getWidth()},getWindowHeight:getDummyInput:doBlurInput:hideKeyboardIfNeeded:doFireOrientationChangeEvent:determineOrientation:getActualWindowOuterHeight:maximize:isHeightMaximized:supportsOrientation:function(){return false},onResize:function(){this.waitUntil(function(){var c=this.windowWidth,f=this.windowHeight,e=this.getWindowWidth(),a=this.getWindowHeight(),d=this.getOrientation(),b=this.determineOrientation();return((c!==e&&f!==a)&&d!==b)},function(){var b=this.getOrientation(),a=this.determineOrientation();this.fireOrientationChangeEvent(a,b)},Ext.emptyFn,250)},doPreventZooming:,1,0,["component","container","viewport"],{component:true,container:true,viewport:true},0,0,[Ext.viewport,"Android"],);(Ext.cmd.derive("Ext.viewport.Ios",Ext.viewport.Default,{isFullscreen:isHomeScreen:constructor:maximize:getScreenHeight:onElementFocus:onElementBlur:onTouchStart:scrollToTop:,1,0,["component","container","viewport"],{component:true,container:true,viewport:true},0,0,[Ext.viewport,"Ios"],);(Ext.cmd.derive("Ext.viewport.WindowsPhone",Ext.viewport.Default,{alternateClassName:"Ext.viewport.WP",config:{translatable:{translationMethod:"csstransform"}},initialize:supportsOrientation:function(){return false},onResize:,0,0,["component","container","viewport"],{component:true,container:true,viewport:true},0,0,[Ext.viewport,"WindowsPhone",Ext.viewport,"WP"],0));(Ext.cmd.derive("Ext.viewport.Viewport",Ext.Base,{constructor:,1,0,0,0,0,0,[Ext.viewport,"Viewport"],0));(Ext.cmd.derive("InfinityMobile.model.MyModel",Ext.data.Model,{config:{fields:[{name:"landscapeBackgroundImage",type:"string"},{name:"showOnPortrait",type:"boolean"},{name:"dataURL",type:"string"},{name:"name",type:"string"},{name:"showOnLandscape",type:"boolean"},{name:"rootKeyPath",type:"string"},{name:"shareBetweenCanvasses",type:"boolean"},{name:"states",type:"auto"},{name:"position",type:"auto"},{name:"customizables",type:"auto"},{name:"anchors",type:"auto"},{name:"globalID",type:"string"},{name:"borders",type:"auto"},{name:"paddings",type:"auto"},{name:"identifier",type:"string"},{name:"defaultState",type:"string"},{name:"events",type:"auto"},{name:"subviews",type:"auto"},{name:"portraitBackgroundImage",type:"string"},{name:"type",type:"string"}]}},0,0,0,0,["model.mymodel"],0,[InfinityMobile.model,"MyModel"],0));(Ext.cmd.derive("InfinityMobile.store.EditionFlatplan",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"EditionFlatplan",proxy:{type:"ajax",noCache:false,url:"http://localhost/psapp/FlatPlans/c3cb755a-199f-4183-ae5f-82b2ed0980d7.txt",reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"EditionFlatplan"],0));(Ext.cmd.derive("InfinityMobile.store.LatestEditionFlatplan",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"LatestEditionFlatplan",proxy:{type:"ajax",url:"http://localhost/psapp/FlatPlans/c3cb755a-199f-4183-ae5f-82b2ed0980d7.txt",reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"LatestEditionFlatplan"],0));(Ext.cmd.derive("InfinityMobile.store.ArchiveStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"ArchiveStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"ArchiveStore"],0));(Ext.cmd.derive("InfinityMobile.store.SettingStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"SettingStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"SettingStore"],0));(Ext.cmd.derive("InfinityMobile.store.SearchStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"SearchStore",proxy:{type:"ajax",reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"SearchStore"],0));(Ext.cmd.derive("InfinityMobile.store.SearchHighlightStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"SearchHighlightStore",proxy:{type:"ajax",reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"SearchHighlightStore"],0));(Ext.cmd.derive("InfinityMobile.store.MediaStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"MediaStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"MediaStore"],0));(Ext.cmd.derive("InfinityMobile.store.ArticleStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"ArticleStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"ArticleStore"],0));(Ext.cmd.derive("InfinityMobile.store.LanguageStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"LanguageStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"LanguageStore"],0));(Ext.cmd.derive("InfinityMobile.store.PuzzleArchiveStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"PuzzleArchiveStore",proxy:{type:"ajax",reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"PuzzleArchiveStore"],0));(Ext.cmd.derive("InfinityMobile.controller.AppController",Ext.app.Controller,{config:{refs:{main:"main",infinitecarousel:"infinitecarousel"},control:{main:{removeSplash:"removeSplashScreen",trackingReady:"trackingReady"}}},init:function(){var a=this;a.initApp();a.canScroll=false;a.removedSplash=false;if(a.isNewPWA()){document.body.className+=" pwa-v2"}a.setupRenderOptions()},setupRenderOptions:fixOrientationBug:initApp:function(){var b=this;currentProfile="tablet";if(this.getApplication().getCurrentProfile()!=null){currentProfile=this.getApplication().getCurrentProfile().getName()}$(document).on("dragstart",function(){return false});if(typeof(Worker)!=="undefined"){}else{}this.hasSmartBannerMetaTag();b.fixIPhoneLandscape();document.body.addEventListener("touchstart",function(d){if($(".smartbanner")[0]!=null){if($(d.target).parents(".smartbanner").length){d.stopPropagation()}}if($(d.target).parents(".fc-consent-root").length){d.stopPropagation()}if($(d.target).parents("#adb-ps-ee-container").length){d.stopPropagation()}if(typeof OneTrust!="undefined"){if($(d.target).parents(".optanon-alert-box-wrapper").length||$(d.target).parents("#optanon").length||d.target.className.indexOf("opt-cookie-settings-menu")>=0){d.stopPropagation();b.canScroll=true}if(d.target&&$("#onetrust-banner-sdk")[0]!=null&&$(d.target).parents("#onetrust-banner-sdk")&&$(d.target).parents("#onetrust-banner-sdk").length){d.stopPropagation()}}if($(".loginContainer")[0]!=null){b.canScroll=true}else{b.canScroll=false}});if((Ext.os.is.iOS&&(typeof iOSVersion==="function"&&iOSVersion()>=11.2))||(Ext.os.is.Android&&navigator.userAgent.indexOf("Edge")>=0)){document.body.addEventListener("gesturestart",function(d){d.preventDefault()},false);Ext.Viewport.element.dom.addEventListener("touchmove",function(d){d.preventDefault()})}else{document.body.addEventListener("touchmove",function(d){if(!b.canScroll&&!(Ext.browser.is.Firefox&&currentProfile=="desktop")){d.preventDefault()}},false)}if(Ext.browser.userAgent.indexOf("CrOS")!=-1){currentProfile="desktop";Ext.os.is.Desktop=true;Ext.os.is.Phone=false;Ext.os.is.Tablet=false}if(navigator.userAgent.indexOf("Edge")!=-1){document.body.className+=" x-edge"}b.setPrintPageStyling();b.setMainPanel();if(Ext.os.is.Android&&Ext.browser.is.Chrome){b.loadDimensionsAndroid()}else{b.loadDimensions()}device=currentProfile;var c=qs.appid;b.initAppReader();try{if(localStorage.getItem("udid")==null){udid=b.createUdid();localStorage.setItem("udid",udid)}else{udid=localStorage.getItem("udid")}}catch(a){}},isEditionApp:function(){if(typeof(EDITIONAPP)!=="undefined"){return true}return false},isNewPWA:function(){if(typeof(NEWPWA)!=="undefined"){return true}return false},hasSmartBannerMetaTag:function(){var c=this;var d=document.querySelector('meta[name="apple-itunes-app"]');console.log(d);if(d!=null&&Ext.browser.is.Safari&&(currentProfile=="tablet"||currentProfile=="largetablet")){c.hasSmartBanner=true}var a=document.getElementsByClassName("smartbanner--android");if(a!=null&&a[0]!=null){try{Ext.Viewport.element.dom.style.maxHeight="calc(100% - 84px)";Ext.Viewport.element.dom.style.minHeight="calc(100% - 84px)"}catch(b){console.error("[AppController]: Error Caught\n",b)}}document.addEventListener("smartbanner.view",function(){Ext.Viewport.element.dom.style.maxHeight="calc(100% - 84px)";Ext.Viewport.element.dom.style.minHeight="calc(100% - 84px)"});document.addEventListener("smartbanner.exit",function(){Ext.Viewport.element.dom.style.maxHeight="";Ext.Viewport.element.dom.style.minHeight=""})},fixIPhoneLandscape:function(){var a=this;if(currentProfile=="phone"&&Ext.os.is.iOS){document.addEventListener("focusout",}if((currentProfile=="phone"&&Ext.os.is.iOS&&(Ext.browser.is.Safari||Ext.browser.is.Chrome||Ext.browser.is.ChromeMobile||Ext.browser.is.ChromeiOS))||a.hasSmartBanner){var c=1;$("html").addClass("iphone safari");a.deviceOrientation="portrait";var b=400;if(parseFloat(iOSVersion())>=11){if(a.removeSplashScreen){b=50}else{b=100}}if(a.returnOrientation()=="landscape"){setTimeout(function(){var d=window.innerHeight;if(d==337){d=340}if(window.innerHeight==screen.width&&parseFloat(iOSVersion())==11){console.log("something went wrong");a.retryResize(b,c,a)}else{$(window).scrollTop(a.returnScrollValueForIphone());$("html").css("height",d+"px");a.deviceOrientation="landscape";a.setupResizeEvent(a)}},b)}else{setTimeout(function(){$("html").css("height",window.innerHeight+"px");a.setupResizeEvent(a)},b)}}},retryResize:function(b,c,a){setTimeout(function(){if(window.innerHeight==screen.width&&c<5){c++;console.log("something went wrong again");a.retryResize(b,c,a)}else{$(window).scrollTop(a.returnScrollValueForIphone());$("html").css("height",window.innerHeight+"px");a.setupResizeEvent();a.deviceOrientation="landscape"}},b)},returnScrollValueForIphone:function(){var a=0;if(typeof iOSVersion==="function"&&iOSVersion()>=10){a=-1}return a},setupResizeEvent:function(){var a=this;$(window).on("resize",function(c){console.log("resize event",window.innerHeight);var d=a.returnScrollValueForIphone();$(window).scrollTop(d);$("html").css("height",window.innerHeight+"px");var b=400;if(parseFloat(iOSVersion())<=11){b=800}setTimeout(function(){$(window).scrollTop(d);$("html").css("height",window.innerHeight+"px");if(a.deviceOrientation==a.returnOrientation()){var e=a.getInfinitecarousel();e.onResize(true)}a.deviceOrientation=a.returnOrientation()},b)})},checkTribuneCommunity:function(){if(settings.reader.showZonesOnLaunch=="true"&&settings.zones.zone.length>0){try{var b="";if(settings.zones.mainzone!=null){b=settings.zones.mainzone.guid}else{b=settings.zones.zone[0].guid}if(getCookie("zone_default")==""){mainPanel.fireEvent("toolbarZones")}}catch(a){}}},createUdid:initialiseGA:function(c){if(typeof OneTrust=="undefined"||this.hasOneTrustConsent()){var b=document.createElement("SCRIPT");b.async=true;b.src="https://www.googletagmanager.com/gtag/js?id="+c;document.head.appendChild(b);window.dataLayer=window.dataLayer||[];gtag=function(){dataLayer.push(arguments)};gtag("js",new Date());var a={send_page_view:false};if(typeof settings!="undefined"&&settings.tracking!=null&&settings.tracking.anonymizeIp=="true"){a.anonymize_ip=true}gtag("config",c,a);this.hasGaInit=true}},hasOneTrustConsent:function(){if(typeof OneTrust!="undefined"&&settings.oneTrust!=null&&typeof OnetrustActiveGroups!="undefined"){if(settings.oneTrust.categories!=null&&OnetrustActiveGroups.indexOf(settings.oneTrust.categories.analytics)==-1){return false}}return true},initialiseComScore:loadDimensions:loadDimensionsAndroid:setMainPanel:setSplashScreen:removeSplashScreen:function(a){var b=this;if(!b.removedSplash){if(a!=null){clearInterval(a.clearSplash)}if(Ext.os.is.iOS&&currentProfile=="phone"&&typeof hasSplashScreenDuration!="undefined"&&hasSplashScreenDuration!="False"){window.addEventListener("com.pagesuite.replica.splashScreenRemoved",function(){console.log("splash removed");var e=b.getInfinitecarousel();var d=e.getActiveItem();var c=true;var f=function(){console.log("callback!")};if(d!=null&&d.completeImageLoaded!=null){if(Ext.os.is.iOS&&d.paintCheck!=null&&!d.paintCheck()){d.layoutImages(d.image,d.image,d.landscapeimage);d.resetPage();d.resetZoom()}d.completeImageLoaded(c,f)}})}clearSplash();b.removedSplash=true}},initAppReader:isNullOrEmpty:function(a){return typeof a==="undefined"||a.trim()==""},adCookieCheck:function(){return !this.isNullOrEmpty(getCookie("adFree-"+publicationguid))||!this.isNullOrEmpty(getCookie("addFree-"+publicationguid))||this.hasAdEntitlementCookieForSuppGroup()},hasAdEntitlementCookieSetting:function(){return typeof settings!="undefined"&&settings.reader!=null&&settings.reader.checkAdvertEntitlements=="true"},hasAdEntitlementCookieForSuppGroup:function(){try{if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.supplements!=null&&settings.menu.supplements.supplementGroupGuids!=null){var d=false;var e=settings.menu.supplements.supplementGroupGuids;for(var c=0;c<e.length;c++){var a=e[c];d=!this.isNullOrEmpty(getCookie("adFree-"+a.groupGuid))||!this.isNullOrEmpty(getCookie("addFree-"+a.groupGuid));if(d){return true}}}}catch(b){console.warn("Unable to check supplements\n",b);return false}},checkAdvertEntitlements:function(){if(this.adCookieCheck()&&this.hasAdEntitlementCookieSetting()){try{settings.wrapAd=null;settings.reader.bannerAd=null;settings.reader.wrapAd=null;settings.reader.popupAdvert=null;settings.reader.popupAdvertMpu=null;settings.leftHandAd=null;settings.reader.interstitialAdFlow=null;settings.reader.interstitial=null;settings.menu.sponsor=null}catch(a){console.warn("cannot clear adverts")}}},checkPageModeSettings:function(){var d=this;if(!!settings&&!!settings.reader&&settings.reader.savePageMode==="true"){console.log("Setting to save pageMode and zoomMode is true. Retrieving mode from localStorage");try{if(typeof localStorage!=="undefined"){var c=localStorage.getItem("pageMode_"+publicationguid);if(c!==null){settings.reader.defaultPageMode=c}var b=localStorage.getItem("zoomMode_"+publicationguid);if(b!==null){settings.reader.zoomMode=b}}else{console.warn("[AppController] localStorage is not available")}}catch(a){console.warn("[AppController] Error caught:",a)}}},loadReader:function(d){var b=this;settings=d.data.items[0].raw;if(settings.reader.loadMediaOnEveryPage=="true"&&loadMediaEveryPage===true){settings.articlepopover.disableArticleCarousel="true";settings.hideArticleBtn="true";settings.menu.hideArticles="true";settings.articles=null}b.checkPageModeSettings();b.handleSettingsForArticlePopoverPageThumbnail();b.handleSettingsForSharing();InfinityMobile.controller.ReaderPuzzlesController.setSetting(settings);this.checkAdvertEntitlements();language=Ext.getStore("LanguageStore").data.items[0].raw;InfinityMobile.controller.ReaderPuzzlesController.setLanguage(language);mainPanel.fireEvent("settingsLoaded");b.handleSettingsForUserAccessCookie();var a=function(){b.checkTribuneCommunity();b.checkEgmontRestriction();if(typeof(PDFJS)!=="undefined"){if(settings.page.pdfDisableFontFace!=null&&settings.page.pdfDisableFontFace=="true"){PDFJS.disableFontFace=true}}var e=b.loadReaderView(e);b.loadArchiveStore();if(settings.push!=null&&(window.location.protocol=="https:"||document.location.hostname=="localhost")){}var f=Ext.getStore("SettingStore");if(settings.tracking){var g=settings.tracking.trackingType;if(g=="GA"){b.initialiseGA(f.data.items[0].raw.tracking.accoundid)}else{if(g=="DA"){b.initialiseComScore(f.data.items[0].raw.tracking.accoundid)}}}if(Ext.os.is.Desktop&&settings.fullscreenPrompt!=null){Ext.create("InfinityMobile.view.FullscreenPrompt",{})}b.openAndCloseTracking();mainPanel.fireEvent("checkDataCapture");mainPanel.fireEvent("createDataCapture")};if(typeof(EDITIONAPP)!="undefined"&&EDITIONAPP){var c=function(h){if(h.data.type=="settingsData"){settings=h.data.settings;if(settings.bookmarks.appBookmarks!=null){var g="bookmarks"+editionguid;if(settings.bookmarks.bookmarkLS!=null){g="bookmarks"+settings.bookmarks.bookmarkLS}if(settings.bookmarks.appBookmarks!=""){var e=atob(settings.bookmarks.appBookmarks);try{localStorage.setItem(g,e)}catch(f){}}else{try{localStorage.removeItem(g)}catch(f){}}}mainPanel.fireEvent("initTracking");b.loadArticlesForArticleView(a);window.removeEventListener("message",c)}};window.addEventListener("message",c);window.parent.postMessage({type:"updateSettings",settings:settings},"*")}else{b.loadArticlesForArticleView(a)}},trackingReady:function(){var b=this;var a=Ext.getStore("SettingStore");if(settings.tracking){var c=settings.tracking.trackingType;if(c=="GA"){b.initialiseGA(a.data.items[0].raw.tracking.accoundid)}else{if(c=="DA"){b.initialiseComScore(a.data.items[0].raw.tracking.accoundid)}}}},checkEgmontRestriction:function(){var c=getCookie("flipped"+editionguid);if(c!=""&&settings.subscription!=null&&settings.subscription.pageRestriction!=null){try{var d=unescape(window.atob(c));c=JSON.parse(d)}catch(b){console.warn(b.message);console.warn(b.stack)}if(c.visibilityMessage!=null){settings.subscription={pageRestriction:{title:c.visibilityMessage.header,pages:c.visibilityMessage.maxFreePreviewPages,desc:c.visibilityMessage.message,redirectUrl:decodeURIComponent(c.visibilityMessage.actionUrl),logo:"http://edition.pagesuite-professional.co.uk/get_image.aspx?w=280&eid="+editionguid,type:settings.subscription.pageRestriction.type}};settings.menu.hideBookmarks="true";if(settings.subscription.pageRestriction.pages%2==0){settings.subscription.pageRestriction.pages++}}else{loggedIn="true";settings.subscription.pageRestriction.name=c.name;settings.subscription.pageRestriction.code=c.code}var a=getCookie("bookmarks"+editionguid);if(a==""){settings.menu.hideBookmarks="true"}}},openAndCloseTracking:function(){var a=this;if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){}else{if(typeof trackReaderEvent!="undefined"){trackReaderEvent("openPublication")}window.onbeforeunload=function(){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("closePublication")}}}},loadReaderView:function(d){var c=this;if(navigator.onLine){var a="";if(stage){a="&stage=true"}var b="";if(typeof version!="undefined"&&version!=null&&version.trim()!=""){b="&version="+version}$.ajax({crossDomain:true,type:"GET",contentType:"application/json; charset=utf-8",async:true,url:"../load_reader_view.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight+a+b+"&editionapp="+this.isEditionApp()+"&newpwa="+this.isNewPWA()}).done(}},modifyReaderView:function(a){var n=this;var l=settings.reader;var o=settings.topbar;var g=n.getApplication().getController("LayoutController").getToolbarIconSubViewObject(InfinityMobile.controller.LayoutController.SUBVIEW.TOOLBAR_ICON.PAGES_BROWSER.ITEM_ID);if(!!g){a.subviews.push(g)}var q=a.subviews;var h=false;if(typeof(EDITIONAPP)!="undefined"&&EDITIONAPP&&n.isNewPWA()){h=true}for(var c=0;c<q.length;c++){var p=q[c];switch(p.globalID){case"ThumbLogo":case"ThumbLogoSmall":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.url!=null){f.bindings.url=o.logo;if(p.globalID=="ThumbLogoSmall"&&o.smallLogo){f.bindings.url=o.smallLogo}}}if(o.logoUrl!=null&&o.logoUrl!=""){var r=p.events.onTouch;for(var b=0;b<r.length;b++){var e=r[b];e.action="topBarOpenUrl";e.url=o.logoUrl}}if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){try{p.events.onTouch=[];p.events.onTouch.push({action:"editionAppClose",url:o.logoUrl});p.position.landscape["width"]=30;p.position.portrait["width"]=30}catch(k){console.error("CAUGHT:",k)}}break;case"TopBar":case"topbar":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.backgroundColor!=null){f.bindings.backgroundColor=o.backgroundColor.indexOf("#")==-1?"#"+o.backgroundColor:o.backgroundColor}if(f.bindings.opacity!=null&&o.opacity!=null){f.bindings.opacity=parseFloat(o.opacity)}}if(currentProfile=="desktop"){p.type="PSLTopBar"}break;case"ShareIconEdition":case"Share":if(h){if(settings.menu.hidePages!=null&&settings.menu.hidePages=="true"){n.moveIconRight(p)}if(settings.menu.hidePrint!=null&&settings.menu.hidePrint=="true"){n.moveIconRight(p)}if(settings.menu.hideBookmarks!=null&&settings.menu.hideBookmarks=="true"){n.moveIconRight(p)}}if(settings.menu.hideSharing!=null&&settings.menu.hideSharing=="true"){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}else{var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.url!=null&&o.shareicon!=null&&o.shareicon!="someimage.png"){f.bindings.url=o.shareicon}}}break;case"BookmarkIconEdition":case"Bookmark":if(h){if(settings.menu.hidePages!=null&&settings.menu.hidePages=="true"){n.moveIconRight(p)}if(settings.menu.hidePrint!=null&&settings.menu.hidePrint=="true"){n.moveIconRight(p)}}if(settings.menu.hideBookmarks!=null&&settings.menu.hideBookmarks=="true"){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}else{var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(!!f.bindings.url){if(f.name=="default"&&!!o.bookmarksicon&&o.bookmarksicon!="someimage.png"){f.bindings.url=o.bookmarksicon}else{if(f.name=="selected"&&!!o.bookmarkfilled&&o.bookmarkfilled!="someimage.png"){f.bindings.url=o.bookmarkfilled}}}}}break;case"PrintIconEdition":case"Print":if(h){if(settings.menu.hidePages!=null&&settings.menu.hidePages=="true"){n.moveIconRight(p)}}if(settings.menu.hidePrint!=null&&settings.menu.hidePrint=="true"){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}else{var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.url!=null&&o.printicon!=null&&o.printicon!="someimage.png"){f.bindings.url=o.printicon}}}break;case"PagesIconEdition":case"Pages":if(settings.menu.hidePages!=null&&settings.menu.hidePages=="true"){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}else{var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.url!=null&&o.pagesicon!=null&&o.pagesicon!="someimage.png"){f.bindings.url=o.pagesicon}}}break;case"ClippingIconEdition":case"Clipping":if(h){if(settings.menu.hidePages!=null&&settings.menu.hidePages=="true"){n.moveIconRight(p)}if(settings.menu.hidePrint!=null&&settings.menu.hidePrint=="true"){n.moveIconRight(p)}if(settings.menu.hideBookmarks!=null&&settings.menu.hideBookmarks=="true"){n.moveIconRight(p)}if(settings.menu.hideSharing!=null&&settings.menu.hideSharing=="true"){n.moveIconRight(p)}if(settings.menu.hideDownload!=null&&settings.menu.hideDownload=="true"){n.moveIconRight(p)}}if(settings.menu.hideClipping!=null&&settings.menu.hideClipping=="true"){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}break;case"DownloadIconEdition":case"Download":if(h){if(settings.menu.hidePages!=null&&settings.menu.hidePages=="true"){n.moveIconRight(p)}if(settings.menu.hidePrint!=null&&settings.menu.hidePrint=="true"){n.moveIconRight(p)}if(settings.menu.hideBookmarks!=null&&settings.menu.hideBookmarks=="true"){n.moveIconRight(p)}if(settings.menu.hideSharing!=null&&settings.menu.hideSharing=="true"){n.moveIconRight(p)}}if(settings.menu.hideDownload!=null&&settings.menu.hideDownload=="true"){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}break;case"PageDPSToggleIconEdition":case"PageDPSToggleButtonEdition":if(h){if(settings.menu.hidePages!=null&&settings.menu.hidePages=="true"){n.moveIconRight(p)}if(settings.menu.hidePrint!=null&&settings.menu.hidePrint=="true"){n.moveIconRight(p)}if(settings.menu.hideBookmarks!=null&&settings.menu.hideBookmarks=="true"){n.moveIconRight(p)}if(settings.menu.hideSharing!=null&&settings.menu.hideSharing=="true"){n.moveIconRight(p)}if(settings.menu.hideDownload!=null&&settings.menu.hideDownload=="true"){n.moveIconRight(p)}if(settings.menu.hideClipping!=null&&settings.menu.hideClipping=="true"){n.moveIconRight(p)}}if(l.toggleDPS=="false"){p.position.landscape.width=0;p.position.landscape.height=0}else{var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];console.log(f);if(f.bindings.url!=null){if(f.name=="default"&&o.singlepageicon!=null&&o.singlepageicon!="someimage.png"){f.bindings.url=o.singlepageicon}if(f.name=="selected"&&o.doublepageicon!=null&&o.doublepageicon!="someimage.png"){f.bindings.url=o.doublepageicon}}}}break;case"PageZoomToggleIconEdition":case"PageZoomToggleButtonEdition":if(settings.menu.hideSharing!=null&&settings.menu.hideSharing=="true"){this.moveIconRight(p)}if(l.toggleZoomMode=="false"){p.position.landscape.width=0;p.position.landscape.height=0}else{if(showPagesIcon){n.moveIconLeft(p)}if(n.isNewPWA()){var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];console.log(f);if(f.bindings.url!=null){if(f.name=="default"&&o.fitpageselectedicon!=null&&o.fitpageselectedicon!="someimage.png"){f.bindings.url=o.fitpageselectedicon}if(f.name=="selected"&&o.fillpageicon!=null&&o.fillpageicon!="someimage.png"){f.bindings.url=o.fillpageicon}}}}}break;case"PreviousPageTextEdition":case"NextPageTextEdition":var s=p.states;var d=p.position;if(s!=null&&s[0]!=null){var m=s[0].bindings;if(m!=null&&m.text!=null){m.text=p.globalID=="PreviousPageTextEdition"?language.prevShort:language.nextShort}}if(d!=null){d.portrait.autoWidth=true}break;case"PreviousPageIcon":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.url!=null&&o.previousicon!="someimage.png"){f.bindings.url=o.previousicon}}break;case"NextPageIcon":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];f.bindings.url=o.nexticon;if(f.bindings.url!=null&&o.nexticon!="someimage.png"){f.bindings.url=o.nexticon}}break;case"FirstPageIcon":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];f.bindings.url=o.firsticon;if(f.bindings.url!=null&&o.firsticon!="someimage.png"){f.bindings.url=o.firsticon}}break;case"LastPageIcon":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];f.bindings.url=o.lasticon;if(f.bindings.url!=null&&o.lasticon!="someimage.png"){f.bindings.url=o.lasticon}}break;case"ArchiveIcon":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];f.bindings.url=o.archiveicon;if(f.bindings.url!=null&&o.archiveicon!="someimage.png"){f.bindings.url=o.archiveicon}}break;case"SectionsIcon":case"SectionListIcon":var s=p.states;if(typeof settings!="undefined"&&(settings.bookmarks==null||settings.bookmarks.length==0)){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}else{for(var b=0;b<s.length;b++){var f=s[b];f.bindings.url=o.sectionlisticon;if(f.bindings.url!=null&&o.sectionlisticon!="someimage.png"){if(settings.newsday!=null&&settings.newsday.sectionsIcon!=null){f.bindings.url=settings.newsday.sectionsIcon}else{f.bindings.url=o.sectionlisticon}}}}break;case"SearchIcon":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.url!=null&&o.searchicon!="someimage.png"){f.bindings.url=o.searchicon}if(this.isEditionApp()&&device=="phone"){f.bindings.url="https://s3-eu-west-1.amazonaws.com/dev-ps-feed-edition-templates/82260c6a-360d-474d-bcea-b51a65ecf989/assets/ICONS_WHITE/Close_icon.png"}}if(this.isEditionApp()&&device=="phone"){if(p.events.onTouch!=null&&p.events.onTouch.length>0){var e=p.events.onTouch[0];e.action="editionAppClose"}}if(settings.menu.hideSearch!=null){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}break;case"MenuIcon":case"Menuicon":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.url!=null&&o.menuicon!="someimage.png"){f.bindings.url=o.menuicon}}break;case"PageText":var s=p.states;for(var b=0;b<s.length;b++){var f=s[b];if(f.bindings.textColor!=null){f.bindings.textColor="#"+o.color}}break;case"SinglePageToggle":case"DoublePageToggle":if(p.globalID=="SinglePageToggle"){p.states[0].bindings.url=o.singlepageselectedicon;p.states[1].bindings.url=o.singlepageselectedicon;p.states[2].bindings.url=o.singlepageicon}else{if(p.globalID=="DoublePageToggle"){p.states[0].bindings.url=o.doublepageicon;p.states[1].bindings.url=o.doublepageicon;p.states[2].bindings.url=o.doublepageselectedicon}}if(l.toggleDPS=="false"){p.position.landscape.width=0;p.position.landscape.height=0}break;case"ZoomBar":p.type="PSLZoom";break;case"PageZoomToggleIcon":if(p.states.length>0){p.states[0].bindings.url=o.fitpageicon}if(p.states.length>1){p.states[1].bindings.url=o.fillpageicon}case"PageFillIcon":case"pagefillicon":case"PageFitIcon":case"pagefiticon":case"PageFill":case"PageFit":if(l.toggleZoomMode=="false"){p.position.landscape.width=0;p.position.landscape.height=0;p.position.portrait.width=0;p.position.portrait.height=0}else{if(p.globalID=="PageZoomToggleIcon"&&settings.reader.zoomMode=="fit"){p.defaultState="selected"}}break;default:break}}},moveIconLeft:function(b){var a=50;if(currentProfile=="phone"){a=39}b.position.portrait.x-=a;b.position.landscape.x-=a},moveIconRight:function(b){var a=50;if(currentProfile=="phone"){a=39}b.position.portrait.x+=a;b.position.landscape.x+=a},loadReaderStore:function(c){if(navigator.onLine){var d=Ext.getStore("EditionFlatplan");d.viewjson=c;var a="&lm="+latestLM;var b="&version=production";if(version=="stage"){b="&version=stage"}d.setProxy({url:"../get_page_groups_from_eid.aspx?pubid="+publicationguid+"&eid="+editionguid+a+b});var e=function(){$.ajax({url:"../get_targeted_adverts.aspx?pubid="+publicationguid+"&edid="+editionguid,success:function(m){if(m!=null){window.targetedAds=m;if(d.data!=null&&d.data.items[0]!=null&&d.data.items[0].raw!=null&&d.data.items[0].raw.pageGroups){var h=d.data.items[0].raw.pageGroups}if(h!=null){for(var l in m){if(m[l]!=null&&m[l].page!=null&&m[l].adunit!=null){var k=m[l];var j=k.page-1;if(h[j]!=null&&h[j].pages[0]!=null){h[j].pages[0].adunit=k.adunit}}}}}}});if(settings!=null&&settings.newsday!=null&&settings.newsday.specialArchive!=null){var f="&lm="+latestLM;var g="../../editionshtml5_json.aspx?publicationguid="+settings.newsday.specialArchive.archiveGuid+"&maxnumber="+settings.newsday.specialArchive.archiveSize+f+"&specialArchive=true";$.ajax({url:g,success:)}};d.on("load",e);d.load()}},loadArchiveStore:function(){var f=this;if(navigator.onLine){var a=settings.menu;var b=30;if(a!=null){b=a.archiveLength}var e="&lm="+latestLM;var j="&version=production";if(version=="stage"){j="&version=stage"}var c="";if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.previewCookie!=null&&settings.menu.previewCookie!=""){if(typeof getCookie==="function"){var g=getCookie(settings.menu.previewCookie);c=g!=null&&g!=""?"&preview=true":""}}var h="../../editionshtml5_json.aspx?publicationguid="+publicationguid+"&maxnumber="+b+e+j+c;if(currentProfile=="desktop"){h="../../editionsdesktop_json.aspx?publicationguid="+publicationguid+"&maxnumber="+b+e+j+c}var d=Ext.getStore("ArchiveStore");d.setProxy({url:h});d.load({callback:function(l,k,o){var m=f.getApplication();if(o&&m){var n=m.getController("ReaderController");if(n&&n.openArchiveModal&&typeof n.openArchiveModalOnLoad==="function"){n.openArchiveModalOnLoad()}}}})}},loadSettingsStore:function(){var h="";try{if(localStorage.getItem("checkLanguage"+publicationguid)!=null){var e=localStorage.getItem("checkLanguage"+publicationguid);if(e!="false"){h="&language="+e}}}catch(c){}var d=Ext.getStore("SettingStore");d.on({load:"loadReader",scope:this});var b="&version=production";if(version=="stage"){b="&version=stage"}var a="&lm="+latestLM;var f="&os=windows";if(Ext.os.is.MacOS){f="&os=mac"}else{if(Ext.os.is.Android){f="&os=android"}else{if(Ext.os.is.iOS){f="&os=ios"}}}var g="";if(typeof versionNumber!="undefined"&&versionNumber!=null&&versionNumber.toString()){g="&buildVersion="+versionNumber}d.setProxy({url:"../get_settings.aspx?pubid="+publicationguid+"&edid="+editionguid+g+"&device="+currentProfile+b+h+a+f+"&editionapp="+this.isEditionApp()});d.load()},loadArticleStore:function(){var c=Ext.getStore("ArticleStore");c.on({load:"loadLanguageStore",scope:this});var a="&lm="+latestLM;var b="../get_articles.aspx?edid="+editionguid+"&pubid="+publicationguid+a;c.setProxy({url:b});c.load()},loadArticlesForArticleView:function(f){var b=this;if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.articleViewOnly=="true")||(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"))){var b=this;if(settings.reader!=null&&settings.reader.articleViewOnly=="true"){document.body.className+=" fullscreen-article-reader"}var e=Ext.getStore("ArticleStore");e.un("load","loadLanguageStore",this);var d=if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){d=function(g){b.getApplication().getController("ArticleController").setArticleStoreDictionary();f(g)}}var a="&lm="+latestLM;var c="https://edition.pagesuite.com/popovers/get_popovers_list.aspx?sdk_based=true&edition="+editionguid+a;if(window.location.host.indexOf("stage.edition.pagesuite.com")>=0){}language.article=language.page;b.templateRequest=$.ajax({type:"GET",contentType:"text/plain",async:true,url:c,success:)}else{f()}},loadLanguageStore:function(){var c=Ext.getStore("LanguageStore");c.on({load:"loadSettingsStore",scope:this});var b="&version=production";if(version=="stage"){b="&version=stage"}var a="&lm="+latestLM;c.setProxy({url:"../get_language.aspx?pubid="+publicationguid+"&edid="+editionguid+a+b});c.load()},initializePush:returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android||(Ext.os.is.iOS&&currentProfile!="desktop")){if(currentProfile=="phone"&&Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(window.innerWidth>window.innerHeight){a="landscape"}else{a="portrait"}}}else{if(currentProfile=="desktop"){a="landscape"}}return a},setPrintPageStyling:function(){var c=this;var b=document.createElement("style");document.head.appendChild(b);var d="size: auto; margin: 0mm;";if(navigator.userAgent.indexOf("Edge")!=-1){d="size: auto; margin: 1cm"}else{if(Ext.browser.is.IE){d="size: auto; margin: 1cm"}}try{b.sheet.insertRule("@page{ "+d+" }")}catch(a){b.sheet.insertRule("@page{ "+d+" }",0)}},handleSettingsForArticlePopoverPageThumbnail:function(){var b=this;if(typeof settings!="object"||!!settings===false){return}var a=false;a="articlepopover" in settings&&typeof settings.articlepopover=="object"&&"pageThumbnail" in settings.articlepopover&&!!settings.articlepopover.pageThumbnail&&settings.articlepopover.pageThumbnail.toLowerCase()==="true";if(a===true){settings.articlepopover["enableFullscreen"]="true"}},hasPageRestriction:function(){var a=typeof settings==="object"&&settings!=null;a=a&&"subscription" in settings&&typeof settings.subscription==="object"&&settings.subscription!=null;a=a&&"pageRestriction" in settings.subscription&&typeof settings.subscription.pageRestriction==="object"&&settings.subscription.pageRestriction!=null;return a},hasPageRestrictionRedirectInSameTab:function(){var a=this.hasPageRestriction()&&"redirectInSameTab" in settings.subscription.pageRestriction&&!!settings.subscription.pageRestriction.redirectInSameTab?settings.subscription.pageRestriction.redirectInSameTab:null;return !!a&&(typeof a==="string"?a.toLowerCase()==="true":a===true)},getPageRestrictionRedirectUrl:function(){var b="";if(!this.hasPageRestriction()){return b}b=settings.subscription.pageRestriction.redirectUrl;if(!!b===false){b="";return b}if(b.indexOf("{{PUBID}}")!==-1){b=b.replace("{{PUBID}}",publicationguid)}else{if(b.indexOf("{{{PUBID}}}")!==-1){b=b.replace("{{{PUBID}}}",publicationguid)}}b=b.trim();b+=this.getQueryParamSeparator(b);var c=window.location.href;var a=settings.subscription.pageRestriction.pages||1;c+=this.getQueryParamSeparator(c)+"pnum="+a;b+="returnurl="+encodeURIComponent(c);return b},getQueryParamSeparator:function(a){if(typeof a!=="string"||a.length===0){return""}var b=a.charAt(a.length-1);if(b==="&"||b==="?"){return""}return a.indexOf("?")>-1?"&":"?"},getUserAccessInfoFromCookie:function(){var c={foundCookie:false,foundAccessLevels:false,userId:"",accessLevels:null};var b=getCookie("UserAccess-"+publicationguid);if(!!b){try{var d=JSON.parse(b);if(!(typeof d==="object"&&d!=null)){return c}c.foundCookie=true;c.userId=("userId" in d)?d.userId:"";if(!("accessLevels" in d&&typeof d.accessLevels==="object"&&d.accessLevels!=null)){return c}c.foundAccessLevels=Object.keys(d.accessLevels).length>0;c.accessLevels=d.accessLevels}catch(a){console.warn("[AppController]: Error Caught\n",a)}}return c},handleSettingsForUserAccessCookie:function(){var c=this.getUserAccessInfoFromCookie();if(!c.foundCookie||!c.foundAccessLevels){return}var b="fullEditionAccess" in c.accessLevels&&(c.accessLevels.fullEditionAccess===true||c.accessLevels.fullEditionAccess==="true");var a="hasValidLogin" in c.accessLevels&&(c.accessLevels.hasValidLogin===true||c.accessLevels.hasValidLogin==="true");if(b===true){settings.subscription["pageRestriction"]=null}if("hasValidLogin" in c.accessLevels){loggedIn=a===true&&b===true?"true":"false"}},hasValidLoginViaUserAccessCookie:function(){var a=null;var b=this.getUserAccessInfoFromCookie();if(!b.foundCookie||!b.foundAccessLevels){return a}if("hasValidLogin" in b.accessLevels){a=b.accessLevels.hasValidLogin===true||b.accessLevels.hasValidLogin==="true"}return a},getParamsfromURL:function(b,c){var a=b.indexOf("&"+c+"=");if(a===-1){return null}var d=b.substring(a+c.length+2).split("&")[0];return isNaN(d)?d:Number(d)},handleSettingsForSharing:function(){if(typeof settings!="object"||settings==null||settings.sharing==null){return}var a=settings.sharing.articleShareUrl;if(a!=null&&!!a){if(a.indexOf("?")>=0){a+="&share=true"}else{a+="?share=true"}settings.sharing.articleShareUrl=a}},getPwaSetting:function(){var a=this.isNewPWA()&&this.isEditionApp();if(!a||typeof settings!="object"||settings==null||typeof settings.pwa!="object"||settings.pwa==null){return{}}return settings.pwa},getPwaAppCode:function(){var a=this.getPwaSetting();var b=a.appCode;if(b==null){return""}return b},addPwaAppCodeQueryParamToUrl:function(a){if(typeof a=="undefined"||!!a===false){return a}var b=this.getPwaAppCode();if(!b){return a}if(a.indexOf("?")>=0){a+="&appcode="+b}else{a+="?appcode="+b}return a}},0,0,0,0,0,0,[InfinityMobile.controller,"AppController"],0));(Ext.cmd.derive("InfinityMobile.controller.LayoutController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel",layoutviewcontroller:"layoutviewcontroller",carousel:"infinitecarousel2d",readerToolbarBottom:"readertoolbarbottom",reader:"reader",layouttoolbar:"layouttoolbar"},control:{main:{trapEvent:"TrapEvent"},layoutviewcontroller:{loadViewController:"layoutViewController"},readerpageviewer:{hideWrapAds:"hideWrapAds",showWrapAds:"showWrapAds"},mainPanel:{toggleToolbarIcon:"toggleToolbarIcon"}}},statics:{SUBVIEW:{TOOLBAR_ICON:{EVENT:{TOGGLE:"toggleToolbarIcon"},PAGES_BROWSER:{ITEM_ID:"mobileToolbarPagesBrowserIcon"},STATE:{ACTIVE:"active",INACTIVE:"inactive"}}},getPagesBrowserToolbarIconSetting:function(){var a={};a.enableMobileTopbarPagesBrowserButton="enableMobileTopbarPagesBrowserButton" in settings.topbar&&settings.topbar.enableMobileTopbarPagesBrowserButton=="true"?true:false;a.pagesBrowserIconUrl="pagesBrowserIconUrl" in settings.topbar&&!!settings.topbar.pagesBrowserIconUrl?settings.topbar.pagesBrowserIconUrl:"";a.pagesBrowserFilledIconUrl="pagesBrowserFilledIconUrl" in settings.topbar&&!!settings.topbar.pagesBrowserFilledIconUrl?settings.topbar.pagesBrowserFilledIconUrl:"";a.enabled=!!a.enableMobileTopbarPagesBrowserButton&&!!a.pagesBrowserIconUrl&&!!a.pagesBrowserFilledIconUrl&&settings.menu.hidePages!="true";return a}},init:function(){var a=this;a.articleStore=Ext.getStore("ArticleStore")},layoutViewController:TrapEvent:function(e,c,g,d,a,b){var f=this;if(c.events[e]!=null){$.each(c.events[e],function(k,x){if(true){switch(x.action){case"removeView":mainPanel.removeView();break;case"loadView":var n=x.target;var t=Ext.getCmp(x.target);if(t!=null){var r="";if(x.viewid=="%Share Link%"){r=g["Share Link"]}else{r=x.viewid}t.loadViewByID(r)}else{if(g!=null&&(g["Share Link"]!=null)){var h="";if(g!=null){if(g["Share Link"]!=null){h=g["Share Link"]}}mainPanel.loadArticle(h)}else{if(x.viewid!=undefined&&x.viewid!=""){if(x.presentationStyle=="lightBox"){mainPanel.loadModalView(x,g,d,a)}else{mainPanel.loadview(x.viewid,g,d,a)}}}}break;case"set text":var p;p=Ext.getCmp(x.target);if(p!=null){p.setHtml(x.text)}else{console.log("No target")}break;case"loadDigitalEdition":var w="";var j="";if(x.publication=="%publicationguid%"||x.publicationguid=="%publicationguid%"){j=g.publicationguid}else{j=x.publication}if(x.edition=="%editionguid%"||x.editionguid=="%editionguid%"){w=g.editionguid}else{w=x.edition}var q=Ext.os.deviceType;if(q=="Desktop"){mainPanel.loadFlashReader(x.publication,w)}else{mainPanel.loadReader(applicatiionPlatformID,x.publication,w)}break;case"left":mainPanel.fireEvent("readerLeft");break;case"right":mainPanel.fireEvent("readerRight");break;case"showTutorial":mainPanel.fireEvent("showTutorial");break;case"openReaderMenu":mainPanel.fireEvent("openReaderMenu",x);break;case"loadURL":if(x.target!=null){Ext.Viewport.setMasked({xtype:"loadmask",message:"Loading"});var y=Ext.getCmp("collection"+x.target);if(y!=null){var u=y.json.templates[0].template;var h=g.url+"&maxarticles=2";$.ajax({crossDomain:true,type:"GET",async:true,data:{base64Url:$.base64.encode(h)},url:"../../API/binary_proxy.aspx"}).done(}}break;case"openURL":window.open(x.url,"_blank");break;case"topBarOpenUrl":if(settings.topbar!=null&&settings.topbar.logoOpenSameTab=="true"){if(loggedIn=="true"&&settings.subscription!=null&&settings.subscription.pageRestriction=="unique"){var l=settings.topbar.logoUrl.replace("{{PUBID}}",publicationguid);l=l.replace("{{EDID}}",editionguid);window.open(l,"_self")}else{window.open(x.url,"_self")}}else{window.open(x.url,"_blank")}break;case"changeState":var n=Ext.getCmp(x.target);if(n!=null){if(n.updateState!=null){n.updateState(x.state)}else{n.parent.updateState(x.state)}}break;case"toggleState":var n=Ext.getCmp(x.target);if(n!=null){if(n.toggleState!=null){n.toggleState()}else{if(n.parent.toggleState!=null){n.parent.toggleState()}}}break;case"clipping":mainPanel.fireEvent("toolbarClipping");break;case"download":if(g!=null){var m={publicationguid:g.publicationguid,publicationname:g.publicationname,editionguid:g.editionguid,editionname:g.editionname,editiondate:g.editiondate,imageurl:g.imageurl};var v="edition"+g.editionguid;try{if(localStorage.getItem(v)==null){localStorage.setItem(v,JSON.stringify(m))}}catch(o){}}else{mainPanel.fireEvent("toolbarDownload")}break;case"removeDownload":var v="edition"+g.editionguid;try{if(localStorage.getItem(v)!=null){localStorage.removeItem(v)}}catch(o){}break;case"toggle dps mode":console.log("TOGGLING DPS");mainPanel.fireEvent("toggleDPSMode");break;case"dps mode on":mainPanel.fireEvent("dpsModeOn");break;case"dps mode off":mainPanel.fireEvent("dpsModeOff");break;case"sendFeedback":location.href="mailto:support@pagesuite.co.uk?subject=Feedback&body=Feedback";break;case"refresh":location.reload();break;case"clearCache":try{localStorage.clear()}catch(o){}location.reload();break;case"search":mainPanel.fireEvent("showSearch",g);break;case"editionAppClose":window.parent.postMessage("editionAppClose","*");break;case"jump to page":var s=parseInt(c.events.onTouch[0]["page number"])-1;console.log(b);if(s==0&&typeof settings!="undefined"&&settings.reader!=null&&settings.reader.reverse=="true"){s=flatPlanData.pageGroups.length-1}mainPanel.fireEvent("pagejump",s);break;case"FirstPage":mainPanel.fireEvent("readerFirst");break;case"LastPage":mainPanel.fireEvent("readerLast");break;case"FullScreen":mainPanel.fireEvent("fullscreenMode");break;case"Fit":mainPanel.fireEvent("zoomModeFit");break;case"Fill":mainPanel.fireEvent("zoomModeFill");break;case"Toggle Aspect Mode":mainPanel.fireEvent("toggleAspect");break;case"pageNumber":mainPanel.fireEvent("pageNumber",b);break;case"pageBrowser":mainPanel.fireEvent("toolbarPages",b);break;case"Archive":mainPanel.fireEvent("archive");break;case"Sections List":mainPanel.fireEvent("toolbarSectionList");break;case"Zones":mainPanel.fireEvent("toolbarZones");break;case"tweet":case"share":mainPanel.fireEvent("toolbarShare",b);break;case"PageLoaded":mainPanel.fireEvent("toolbarBookmarks");case"bookmark":if(typeof NEWPWA!="undefined"&&NEWPWA===true){mainPanel.fireEvent("pwaBookmark")}else{mainPanel.fireEvent("bookmark")}break;case"print":if(typeof NEWPWA!="undefined"&&NEWPWA===true){mainPanel.fireEvent("newPWAPrint")}else{mainPanel.fireEvent("loadPrintMenu")}break;default:console.log(x.action)}}})}},GetState:AddBorder:AddText:function(o,c,a,s,g,e){var q=this;var d=q.GetState(o,"text");if(s!=null&&s!=undefined){if(d.indexOf("%")==0&&d.indexOf(".")==-1){d=d.replace(d,s[d.substr(1,d.length-2)])}else{if(d.indexOf("%")==0){var h=$.JSONPath({data:s,resultType:"VALUE",keepHistory:true});var j=h.query("$."+d.substr(1,d.length-2));d=j[0]}}}var p=q.GetState(o,"textSize");var l=q.GetState(o,"justification");var k=q.GetState(o,"textColor");var b=q.GetState(o,"opacity");var n=q.GetState(o,"backgroundColor");var r=q.GetState(o,"objectOpacity");if(n==null){n="#ffffff"}if(r==null){r="1"}if(c==null){c=""}var f=Ext.create("Ext.Panel",{html:d,id:o.identifier+c,height:o.position[Ext.Viewport.orientation].height,style:{opacity:r,"vertical-align":"middle","line-height":"25px"}});var m=Ext.create("InfinityMobile.view.LayoutTextView",{json:o,parentContainer:e,listeners:[{element:"element",event:"tap",fn:],items:[{style:"width:auto;height:100%;text-align:"+l+";font-size:"+p+"px;",items:[f]}]});return m},AddButton:AddTableView:AddCollectionView:AddImage:function(p,d,b,r,j,g){var q=this;var e=q.GetState(p,"url");if(settings.newsday!=null){switch(p.globalID.toLowerCase()){case"firstpageicon":if(settings.newsday.firstPageIcon!=null){if(settings.newsday.firstPageIcon.length>0){e=settings.newsday.firstPageIcon}}break;case"lastpageicon":if(settings.newsday.lastPageIcon!=null){if(settings.newsday.lastPageIcon.length>0){e=settings.newsday.lastPageIcon}}break;case"":if(e=="http://html5.pagesuite.com/reader/assets/reader%20icons/back-transparent.png"){if(settings.newsday.prevPageIcon!=null){if(settings.newsday.prevPageIcon.length>0){e=settings.newsday.prevPageIcon}}}if(e=="http://html5.pagesuite.com/reader/assets/reader%20icons/next-transparent.png"){if(settings.newsday.nextPageIcon!=null){if(settings.newsday.nextPageIcon.length>0){e=settings.newsday.nextPageIcon}}}break}}if(r!=null){if(e.indexOf("%")==0&&e.indexOf(".")==-1){e=e.replace(e,r[e.substr(1,e.length-2)])}else{if(e.indexOf("%")==0){var l=$.JSONPath({data:r,resultType:"VALUE",keepHistory:true});var m=l.query("$."+e.substr(1,e.length-2));if(m.length>0){e=m[0]}else{e=""}}}}if(e.indexOf("{width}")>-1){e=e.replace("{width}","186")}if(e.indexOf("{height}")>-1){e=e.replace("{height}","110")}if(e.indexOf("get_image")>-1){var h=p.position[Ext.Viewport.orientation].height.toString();if(h.indexOf(".")>-1){h=h.substr(0,h.indexOf("."))}var c=(h*window.devicePixelRatio);if(c.toString().indexOf(".")>-1){c=c.toString().substr(0,c.toString().indexOf("."))}e=e+="&h="+c}if(e=="http://origin.media.cdn.pagesuite.com/psapps/images/45/puzzle.png"){}var n=p.borders[Ext.Viewport.orientation]["top"].width.substr(0,p.borders[Ext.Viewport.orientation]["top"].width.length-2)+p.borders[Ext.Viewport.orientation]["bottom"].width.substr(0,p.borders[Ext.Viewport.orientation]["bottom"].width.length-2);var f=p.borders[Ext.Viewport.orientation]["left"].width.substr(0,p.borders[Ext.Viewport.orientation]["left"].width.length-2)+p.borders[Ext.Viewport.orientation]["right"].width.substr(0,p.borders[Ext.Viewport.orientation]["right"].width.length-2);var k=q.GetState(p,"scaleMode");var a="background-size: contain;";if(k!=null&&k=="aspect fill"){var a="background-size: cover;"}if(d==null){d=""}if(p.globalID=="ThumbLogo"){a+="background-position: left center;"}if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){a+=" background-color: #"+settings.topbar.color+";";var s=Ext.create("Ext.Container",{scrollable:null,height:"100%",width:"100%",id:p.identifier+d,style:a,cls:"x-img-background"});s.setStyle({webkitMaskImage:"url("+e+")",oMaskImage:"url("+e+")",mozMaskImage:"url("+e+")",maskImage:"url("+e+")",webkitMaskSize:"contain",oMaskSize:"contain",mozMaskSize:"contain",maskSize:"contain",webkitMaskRepeat:"no-repeat",oMaskRepeat:"no-repeat",mozMaskRepeat:"no-repeat",maskRepeat:"no-repeat",webkitMaskPosition:"center",oMaskPosition:"center",mozMaskPosition:"center",maskPosition:"center"})}else{var s=Ext.create("Ext.Img",{src:e,scrollable:null,height:"100%",width:"100%",id:p.identifier+d,style:a})}var o=Ext.create("InfinityMobile.view.LayoutView",{contenttype:"image",scrollable:null,json:p,parentContainer:g,listeners:[{element:"element",event:"tap",fn:function(t){if(r!=null){q.TrapEvent("onTouch",p,r,j,d,s.element)}else{q.TrapEvent("onTouch",p,null,j,d,s.element)}t.stopPropagation();t.preventDefault()}}],items:s});return o},AddShape:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.LayoutView",{json:c,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(j){if(h!=null){f.TrapEvent("onTouch",c,h,e,b,a.element)}else{f.TrapEvent("onTouch",c,null,e,b,a.element)}j.stopPropagation()}}]});return a},AddSlider:AddTopBar:AddAdvert:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.LayoutAdvertView",{json:c,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(){if(h!=null){f.TrapEvent("onTouch",c,h,e,b)}else{f.TrapEvent("onTouch",c,null,e,b)}}}]});return a},AddVideo:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.LayoutVideoView",{json:c,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(){if(h!=null){f.TrapEvent("onTouch",c,h,e,b)}else{f.TrapEvent("onTouch",c,null,e,b)}}}]});return a},AddWebView:AddViewController:AddReader:function(D,n){var q=this;if(settings.topbar.toggleTopBar=="true"){D.position.portrait.y=0;D.position.landscape.y=0;D.position.portrait.height+=40;D.position.landscape.height+=40}n.flatplandata=n.config.flatplandata;var K=n.flatplandata;var e=K.pageGroups;q.editionGuid=K.editionGUID;var I=0;var z=q.retrievePageNumber();var b;if(pageNumber!=""){I=q.setStartingPageNum(pageNumber,e.length);b=true}else{if(z!=1){b=false;I=z-1}}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){I=e.length-I-1}var u=settings.reader.defaultPageMode;var o=settings.reader.zoomMode;var x=q.getSectionPageNumberForSectionDeepLinking();if(x!=null){I=x;b=true}if(b){I+=q.getAdvertsOffset(I+1)}if(u=="double"&&q.returnOrientation()=="landscape"){I=K.pageMapper[I+1]-1}var t=settings.page.renderMode;var w=Ext.create("InfinityMobile.view.2DInfiniteCarousel",{width:"100%",flex:1,json:D,pageNumber:I,data:e,pageXPath:"pages",landscapePageIncrement:2,mode:u,zoomMode:o,pageTemplate:function(Q,S,M){var P=this;if(pageOffset!=0){S=Math.min((S+pageOffset),(M.length-1));Q=M[S].pages[0]}var O="";if((S-1)>=0){O=M[(S-1)].pages[0]}var N="";if((S+1)<=(M.length-1)){N=M[(S+1)].pages[0]}S=S-pageOffset;var L="InfinityMobile.view.ReaderPageViewer";if(t=="PDF"){L="InfinityMobile.view.ReaderPageViewerPDF"}if(Q!=null&&Q.type=="advert"&&settings.reader.interstitialPageFlow!=null){card=Ext.create("InfinityMobile.view.AdvertPageViewer",{pageNo:S,advertType:settings.reader.interstitialPageFlow.type,networkCode:settings.reader.interstitialPageFlow.networkCode,adUnit:settings.reader.interstitialPageFlow.adUnit,advertSize:settings.reader.interstitialPageFlow.size,adUrl:settings.reader.interstitialPageFlow.url,adLink:settings.reader.interstitialPageFlow.link,targeting:settings.reader.interstitialPageFlow.targeting,side:Q.side});return card}else{var R=Ext.create(L,{page:Q,previousPage:O,nextPage:N,pageNo:S,mode:P._mode,editionGuid:K.editionGUID,zoomMode:P._zoomMode});return R}},returnPage:);var J="e1e1e1";if(settings.reader.backgroundColor!=null){J=settings.reader.backgroundColor}var s="none";var H="cover";var C="no-repeat";var v="center";if(settings.reader.backgroundImage!=""){s="url('"+settings.reader.backgroundImage+"')";switch(settings.reader.backgroundImageLayout){case"cover":default:H="cover";C="no-repeat";v="center";break;case"contain":H="contain";C="no-repeat";v="center";break;case"stretch":H="100% 100%";C="no-repeat";v="center";break;case"repeat":H="auto";C="repeat";v="left top";break}}var m=Ext.create("InfinityMobile.view.LayoutView",{id:"reader",layout:"vbox",json:D,parentContainer:n,items:[w]});m.setStyle({backgroundColor:"#"+J,backgroundImage:s,backgroundSize:H,backgroundRepeat:C,backgroundPosition:v});if(settings.reader.bannerAd!=null){var l="InfinityMobile.view.tablet.ReaderBannerAd";switch(currentProfile){case"phone":l="InfinityMobile.view.phone.ReaderBannerAd";break;case"tablet":default:l="InfinityMobile.view.tablet.ReaderBannerAd";break}var h=typeof I!="undefined"?editionFlatplanData.pageMapper[parseInt(I)+1]:1;var r=typeof startingSection!="undefined"?startingSection:"";var G=Ext.create(l,{pageNumber:h,section:r});if(settings.reader.bannerAd.position=="top"){var d=settings.topbar.backgroundColor.indexOf("#")==0?settings.topbar.backgroundColor:"#"+settings.topbar.backgroundColor;if(typeof hexaToRgba==="function"&&typeof q.hexToRgb==="function"){if(d.length>=8){d=hexaToRgba(d)}else{var g=q.hexToRgb(d);var F=settings.topbar.opacity!=null?settings.topbar.opacity:"0.9";d="rgba("+g.r+","+g.g+","+g.b+","+F+")"}}G.setStyle({backgroundColor:d});G.setStyle({borderBottom:"1px solid #ffffff"});G.setDocked("top");n.insert(0,G)}else{if(settings.reader.bannerAd.canBeClosed==null||settings.reader.bannerAd.canBeClosed=="false"){m.add(G)}else{G.setBottom(0);Ext.Viewport.add(G)}}}var c=0;var y=q.returnRSSTickerSpeed();if(settings.RSSTicker!=null){var k=settings.RSSTicker.split("|");var j=Ext.create("InfinityMobile.view.ReaderTicker",{url:k[1],num:k[0],leadText:k.length>=3?k[2]:"",tickerSpeed:y});c=40;m.add(j)}q.articles=q.getApplication().getController("ArticleController").getArticles();var a=Ext.getStore("SettingStore");var A=[];if(a.data.items[0].raw.bookmarks!=null){A=a.data.items[0].raw.bookmarks.bookmark}if(q.articles!=null&&q.articles.length>0){if(currentProfile=="desktop"){var p=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){p=false}}if(p){var f=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:q.articles,sections:A,mode:"toggle"})}else{var f=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:q.articles,sections:A,mode:"toggle"})}}else{var f=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:q.articles,sections:A,mode:"toggle"})}Ext.Viewport.add(f)}else{if(currentProfile=="desktop"){var p=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){p=false}}if(p){var f=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:q.articles,sections:A,mode:"toggle"})}else{var f=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:q.articles,sections:A,mode:"toggle"})}}else{var f=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:q.articles,sections:A,mode:"toggle"})}Ext.Viewport.add(f)}q.checkOpenBrowserOnLaunch(f);if(settings.reader.dataCapture!=null){try{var E=localStorage.getItem("datacapture"+publicationguid)}catch(B){var E=null}if(E==null){if(currentProfile!="phone"){f.hideMe()}}}return m},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(currentProfile=="phone"){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(window.innerWidth>window.innerHeight){a="landscape"}else{a="portrait"}}}else{if(currentProfile=="desktop"){a="landscape"}}return a},AddDesktopReader:function(I,s){var w=this;var x=this;if(typeof settings=="object"&&"reader" in settings&&typeof settings.reader=="object"&&"disableTooltip" in settings.reader){var z="";switch(settings.reader.disableTooltip){case"all":z=" hide-tooltip";break;case"article":z=" hide-article-tooltip";break;default:}if(!!z){document.body.className+=z}}if(settings.topbar.toggleTopBar=="true"){I.position.portrait.y=0;I.position.landscape.y=0;I.position.portrait.height+=40;I.position.landscape.height+=40}s.flatplandata=s.config.flatplandata;var R=s.flatplandata;var e=R.pageGroups;w.editionGuid=R.editionGUID;var O=0;var G=w.retrievePageNumber();var b;if(pageNumber!=""){O=w.setStartingPageNum(pageNumber,e.length);b=true}else{if(G!=1){b=false;O=G-1}}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){O=e.length-O-1}var B=settings.reader.defaultPageMode;var t=settings.reader.zoomMode;var v="";if(settings.wrapAd!=null&&settings.wrapAd.dualAdvert!=null){v=settings.wrapAd.dualAdvert}var K="";if((typeof isTribReader!="undefined"&&isTribReader==true)||settings.reader.enableReaderPadding=="true"){K="20px 150px"}if(settings.wrapAd!=null&&settings.reader.enableReaderPadding=="true"){K="20px 200px";if(v=="left"){K="20px 0 20px 350px"}else{if(v=="right"){K="20px 350px 20px 0"}}}else{if(settings.wrapAd!=null){K="0px 200px";if(v=="left"){K="0 0 0 350px"}else{if(v=="right"){K="0 350px 0 0"}}}}var F=w.getSectionPageNumberForSectionDeepLinking();if(F!=null){O=F;b=true}if(b){O+=w.getAdvertsOffset(O+1)}if(B=="double"){O=R.pageMapper[O+1]-1}var g=Ext.create("InfinityMobile.view.PDFInfiniteCarousel",{width:"100%",flex:1,json:I,pageNumber:O,data:e,pageXPath:"pages",landscapePageIncrement:2,mode:B,zoomMode:t,cls:"pdfinfinitecarousel "+t,style:"padding:"+K+";",pageTemplate:function(W,al,ab){var ao=this;var an="InfinityMobile.view.ReaderPageViewer";if(currentProfile=="desktop"){an="InfinityMobile.view.desktop.DesktopPageViewer"}var ac="";var U="";var aa="";var am="";var ak="";var T="";var V=al+1;if(V%2==0){V++}V--;V=V+pageOffset;var aj=V;if(aj<=(ab.length-1)){am=ab[(aj)].pages[0]}var Y=(V-1);if(Y>=0){if(ab[Y]!=null){aa=ab[Y].pages[0]}}var ap=(V-2);if(ap>=0){U=ab[ap].pages[0]}var ag=(V-3);if(ag>=0){var S=ab[ag].pages[0];if(S.type=="page"){ac=ab[ag].pages[0]}}var Z=(V+1);if(Z<=(ab.length-1)){ak=ab[(Z)].pages[0]}var af=(V+2);if(af<=(ab.length-1)){var ae=ab[af].pages[0];if(ae.type=="page"){T=ab[(af)].pages[0]}}if((am.type=="advert"||aa.type=="advert")&&settings.reader.interstitialPageFlow!=null){console.log(am,aa);var ai=am!=null&&am.type=="advert"?am:aa;var X=x.returnSection(ai.pageNum);card=Ext.create("InfinityMobile.view.AdvertPageViewer",{pageNo:al,advertType:settings.reader.interstitialPageFlow.type,networkCode:settings.reader.interstitialPageFlow.networkCode,adUnit:settings.reader.interstitialPageFlow.adUnit,advertSize:settings.reader.interstitialPageFlow.size,adUrl:settings.reader.interstitialPageFlow.url,adLink:settings.reader.interstitialPageFlow.link,targeting:settings.reader.interstitialPageFlow.targeting,side:W.side,section:X});return card}else{var ah=Ext.create(an,{pageNo:al,rightPage:am,leftPage:aa,previousPage:U,hiddenLeftPage:ac,nextPage:ak,hiddenRightPage:T,mode:ao._mode,zoomMode:ao._zoomMode,editionGuid:R.editionGUID});return ah}},returnPage:function(S,V){var T=this;var U="";if(S>=0&&S<T.getData().length-1){U=T.getData()[S].pages[0]}return U}});var Q="e1e1e1";if(settings.reader.backgroundColor!=null){Q=settings.reader.backgroundColor}var A="none";if(settings.reader.backgroundImage!=""){A="url('"+settings.reader.backgroundImage+"')"}var N="cover";var J="no-repeat";var C="center";switch(settings.reader.backgroundImageLayout){case"cover":default:N="cover";J="no-repeat";C="center";break;case"contain":N="contain";J="no-repeat";C="center";break;case"stretch":N="100% 100%";J="no-repeat";C="center";break;case"repeat":N="auto";J="repeat";C="left top";break}var D="0";if(settings.reader.fillPadding!=null){D="0 "+settings.reader.fillPadding+"px"}var f="";if(settings.menu!=null&&settings.menu.sectionList!=null&&settings.menu.sectionList.useSectionScroller=="true"&&settings.bookmarks!=null&&settings.bookmarks.bookmark!=null&&settings.bookmarks.bookmark.length>0){f=" reader-with-scroller"}var r=Ext.create("InfinityMobile.view.LayoutView",{id:"reader",cls:"dekstopreader"+f,layout:"vbox",json:I,parentContainer:s,items:[g],fillPadding:D});r.setStyle({backgroundColor:"#"+Q,backgroundImage:A,backgroundSize:N,backgroundRepeat:J,backgroundPosition:C});var m=typeof O!="undefined"?editionFlatplanData.pageMapper[parseInt(O)+1]:1;var y=typeof startingSection!="undefined"?startingSection:"";var h=0;if(settings.reader.bannerAd!=null){var p="InfinityMobile.view.tablet.ReaderBannerAd";switch(currentProfile){case"phone":p="InfinityMobile.view.phone.ReaderBannerAd";break;case"tablet":default:p="InfinityMobile.view.tablet.ReaderBannerAd";break}var M=Ext.create(p,{pageNumber:m,section:y});if(settings.reader.bannerAd.position=="top"){var d=settings.topbar.backgroundColor.indexOf("#")==0?settings.topbar.backgroundColor:"#"+settings.topbar.backgroundColor;if(typeof hexaToRgba==="function"&&typeof w.hexToRgb==="function"){if(d.length>=8){d=hexaToRgba(d)}else{var k=w.hexToRgb(d);var L=settings.topbar.opacity!=null?settings.topbar.opacity:"0.9";d="rgba("+k.r+","+k.g+","+k.b+","+L+")"}}M.setStyle({backgroundColor:d});M.setStyle({borderBottom:"1px solid #ffffff"});M.setDocked("top");s.insert(0,M)}else{if(settings.reader.bannerAd.canBeClosed==null||settings.reader.bannerAd.canBeClosed=="false"){h=110;r.add(M)}else{M.setBottom(0);Ext.Viewport.add(M)}}}if(settings.wrapAd!=null){if(settings.wrapAd.type=="image"){if(settings.wrapAd.leftSideImage!=null){var y=typeof startingSection!="undefined"?startingSection:"";var o=Ext.create("InfinityMobile.view.BackgroundWrapAdItem",{bottom:h,left:0,url:settings.wrapAd.leftSideLink,img:settings.wrapAd.leftSideImage,side:"left",pageNo:m,section:y});r.add(o)}if(settings.wrapAd.rightSideImage!=null){var q=Ext.create("InfinityMobile.view.BackgroundWrapAdItem",{bottom:h,right:0,url:settings.wrapAd.rightSideLink,img:settings.wrapAd.rightSideImage,side:"right",pageNo:m,section:y});r.add(q)}}else{var o=Ext.create("InfinityMobile.view.BackgroundWrapAdItem",{bottom:h,left:0,side:"left",pageNo:m,section:y});r.add(o);var q=Ext.create("InfinityMobile.view.BackgroundWrapAdItem",{bottom:h,right:0,side:"right",pageNo:m,section:y});r.add(q)}}var c=0;var E=w.returnRSSTickerSpeed();if(settings.RSSTicker!=null){var n=settings.RSSTicker.split("|");var l=Ext.create("InfinityMobile.view.ReaderTicker",{url:n[1],num:n[0],leadText:n.length>=3?n[2]:"",docked:"bottom",itemId:"ticker",tickerSpeed:E});Ext.Viewport.add(l);c=40}var P=w.articleStore.uniqueArticles;var a=Ext.getStore("SettingStore");var H=[];if(a.data.items[0].raw.bookmarks!=null){H=a.data.items[0].raw.bookmarks.bookmark}if(P!=null&&P.length>0){if(currentProfile=="desktop"){var u=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){u=false}}if(u){var j=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:P,sections:H,mode:"toggle"})}else{var j=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:P,sections:H,mode:"toggle"})}}else{var j=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:P,sections:H,mode:"toggle"})}Ext.Viewport.add(j);j.show()}else{if(currentProfile=="desktop"){var u=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){u=false}}if(u){var j=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:P,sections:H,mode:"toggle"})}else{var j=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:P,sections:H,mode:"toggle"})}}else{var j=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:P,sections:H,mode:"toggle"})}Ext.Viewport.add(j);j.show()}w.checkOpenBrowserOnLaunch(j);if(settings.reader.dataCapture!=null){if(localStorage.getItem("datacapture"+publicationguid)==null){j.hideMe()}}return r},checkOpenBrowserOnLaunch:function(a){var b=this;if(a){var c=typeof settings!="undefined"&&!!settings.menu?settings.menu.browserTabOnLaunch:null;if(!!c){switch(c.toLowerCase()){case"supplements":if(!!settings.menu&&!!settings.menu.supplements&&settings.menu.supplements.showSupplementsTab){a.supplementsTabTap()}break;case"pages":if(!!settings.menu&&!!settings.menu&&(settings.menu.hidePages==null||settings.menu.hidePages=="false")){a.pagesTabTap()}break;case"articles":if(!!settings.menu&&!!settings.menu&&settings.menu.hideArticles==null){a.articleTabTap()}break}}}},returnSection:function(a){var e=this;var h=settings.bookmarks.bookmark;var f=null;if(h!=null&&h.length>0){for(var c in h){var b=parseInt(h[c].pageNumber);if(h[c].start!=null){b=h[c].start}var g=h[parseInt(c)+1];var d=null;if(g!=null){d=g.pageNumber;if(g.start!=null){d=g.start}}if(parseInt(a)>=b&&(d==null||parseInt(a)<parseInt(d))){f=h[c].name;break}}}return f},checkSectionsMatch:function(b,c){var a=false;if(b==c){a=true}else{if(b.replace("&","and")==c){a=true}else{if(b.replace("&","+")==c){a=true}else{if(b.replace("+","and")==c){a=true}else{if(b.replace("+","&")==c){a=true}else{if(c.replace("&","and")==b){a=true}else{if(c.replace("+","and")==b){a=true}}}}}}}return a},setStartingPageNum:function(b,a){var c=0;if(parseInt(b)>=1&&parseInt(b)<=a){c=parseInt(b)-1}return c},retrievePageNumber:AddTextField:getSubViews:function(g,f,b,a,c){var d=this;var e=[];$.each(g.subviews,function(w,B){switch(B.type){case"PSLImageView":if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(B.events.onTouch!=null){for(var n=0;n<B.events.onTouch.length;n++){var v=B.events.onTouch[n];if(v!=null&&v.action=="editionAppClose"){var j=settings.topbar.feedEditionLogo;if(B.states!=null){for(var m=0;m<B.states.length;m++){B.states[m].bindings.url=j}}}}}}var h=d.AddImage(B,b,0,f,c,a);e.push(h);break;case"PSLLabel":var u=d.AddText(B,b,0,f,c,a);e.push(u);break;case"PSLShape":case"PSLHorizontalKeyline":case"PSLVerticalKeyline":var u=d.AddShape(B,b,0,f,c,a);e.push(u);break;case"PSLButton":var k=d.AddButton(B,b,0,f,c,a);e.push(k);break;case"PSLAdvertView":var p=d.AddAdvert(B,b,0,f,c,a);e.push(p);break;case"PSLVideoPlayerView":var r=d.AddVideo(B,b,0,f,c,a);e.push(r);break;case"PSLWebView":var o=d.AddWebView(B,b,0,f,c,a);e.push(o);break;case"PSLTableView":var s=function(x){var y=d.AddTableView(B,0,x,a);e.push(y)};d.getCollectionType(B,s);break;case"PSLCollectionView":var s=d.getCollectionType(B,s);break;case"PSLViewController":var A=d.AddViewController(B,b,0,f,c,a);e.push(A);break;case"PSLReaderViewController":if(currentProfile=="desktop"){d.myReader=d.AddDesktopReader(B,a);if(settings.menu!=null&&settings.menu.sectionList!=null&&settings.menu.sectionList.useSectionScroller=="true"&&settings.bookmarks!=null&&settings.bookmarks.bookmark!=null&&settings.bookmarks.bookmark.length>0){var t=Ext.create("InfinityMobile.view.desktop.SectionScroller",{});e.push(t)}}else{d.myReader=d.AddReader(B,a)}e.push(d.myReader);break;case"PSLTextField":var z=d.AddTextField(B,b,0,f,c,a);e.push(z);break;case"PSLZoom":var l=d.AddSlider(B,b,0,f,c,a);e.push(l);break;case"PSLTopBar":var q=d.AddTopBar(B,b,0,f,c,a);e.push(q);break;default:console.log("Missing "+B.type);break}});return e},getCollectionType:hideWrapAds:function(){var a=this;var b=Ext.ComponentQuery.query(".backgroundwrapaditem");for(ad in b){b[ad].hide()}},showWrapAds:hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},getSectionPageNumberForSectionDeepLinking:function(){var a=this;return(typeof startAtSection!="undefined"&&!!startAtSection)?a.getSectionPageNumber(startAtSection):null},getSectionPageNumber:function(e){var g=null;if(typeof e!="undefined"&&!!e){e=decodeURIComponent(e.replace(/\s/g,"").toLowerCase());if(typeof settings=="object"&&"bookmarks" in settings&&typeof settings.bookmarks=="object"&&"bookmark" in settings.bookmarks&&Array.isArray(settings.bookmarks.bookmark)){var d=this;var h=settings.bookmarks.bookmark;try{for(var b=0;b<h.length;b++){var f=h[b];var a=f.name.replace(/\s/g,"").toLowerCase();if(d.checkSectionsMatch(a,e)===true){g=((parseInt(f.pageNumber)-1)>-1)?parseInt(f.pageNumber)-1:g;break}}}catch(c){g=null}}}return g},getAdvertsOffset:function(a){if(isNaN(a)===true){return 0}var b=typeof flatPlanData.pdfPages[a-1]=="object"?flatPlanData.pdfPages[a-1]:{};var c="pages" in b&&Array.isArray(b.pages)&&b.pages.length>0?b.pages[0]:{};return"advertsAdded" in c?c.advertsAdded:0},getToolbarIconSubViewObject:function(c){var b=this;var a=null;switch(c){case b.statics().SUBVIEW.TOOLBAR_ICON.PAGES_BROWSER.ITEM_ID:a=b.getMobileToolbarPagesBrowserIconSubViewObj();break;default:}return a},getMobileToolbarPagesBrowserIconSubViewObj:function(){var c=this;var a=c.statics().getPagesBrowserToolbarIconSetting();if(InfinityMobile.controller.ReaderController.isNewPWA()||a.enabled===false||currentProfile=="desktop"){return null}var b={subviews:[],rootKeyPath:"",borders:{portrait:{right:{type:"Solid",width:"0px",color:"#000000"},bottom:{type:"Solid",width:"0px",color:"#000000"},top:{type:"Solid",width:"0px",color:"#000000"},left:{type:"Solid",width:"0px",color:"#000000"}},landscape:{right:{type:"Solid",width:"0px",color:"#000000"},bottom:{type:"Solid",width:"0px",color:"#000000"},top:{type:"Solid",width:"0px",color:"#000000"},left:{type:"Solid",width:"0px",color:"#000000"}}},defaultState:"default",anchors:{portrait:{anchorWidth:false,anchorLeft:true,anchorRight:false,anchorBottom:false,anchorTop:true,anchorHeight:false},landscape:{anchorWidth:false,anchorLeft:true,anchorRight:false,anchorBottom:false,anchorTop:true,anchorHeight:false}},states:[{name:"default",templates:[],orientation:{portrait:true,landscape:false},bindings:{isPushInboxIcon:false,objectOpacity:1,cornerRadius:0,zoom:false,pan:false,scaleMode:"aspect fit",usesPublication:false,url:a.pagesBrowserIconUrl,opacity:0,backgroundColor:"#ffffff"}},{bindings:{url:a.pagesBrowserFilledIconUrl},name:"selected",orientation:{landscape:false,portrait:true},templates:[]}],shareBetweenCanvasses:false,globalID:"PagesBrowserIconEdition",paddings:{portrait:{right:{width:"0px"},bottom:{width:"0px"},top:{width:"0px"},left:{width:"0px"}},landscape:{right:{width:"0px"},bottom:{width:"0px"},top:{width:"0px"},left:{width:"0px"}}},showOnPortrait:true,showOnLandscape:true,name:"",type:"PSLImageView",identifier:"3d8fc158-357f-472f-bca0-91cd92ed9311",position:{portrait:{x:215,width:24,autoWidth:false,y:8,height:24},landscape:{x:343,width:24,autoWidth:false,y:8,height:24}},dataURL:"",events:{onTouch:[{action:"pageBrowser",data:{},rules:[],target:"%readerguid%",transition:"instant"}]}};if(currentProfile=="phone"){b.position.portrait.x=42;b.position.landscape.x=42}return b},toggleToolbarIcon:function(e,d){var c=this;var a=typeof d!="undefined"&&!!d?d:null;switch(e){case c.statics().SUBVIEW.TOOLBAR_ICON.PAGES_BROWSER.ITEM_ID:if(currentProfile=="desktop"){break}var b=!!c.getLayoutviewcontroller()?c.getLayoutviewcontroller().getComponent(c.statics().SUBVIEW.TOOLBAR_ICON.PAGES_BROWSER.ITEM_ID):null;if(!(typeof b=="object"&&"toggleState" in b&&typeof b.toggleState=="function"&&!!a)){break}if(a==c.statics().SUBVIEW.TOOLBAR_ICON.STATE.ACTIVE&&b.currentState!="default"){b.currentState="default"}if(a==c.statics().SUBVIEW.TOOLBAR_ICON.STATE.INACTIVE&&b.currentState!="selected"){b.currentState="selected"}b.toggleState();break;default:}},returnRSSTickerSpeed:function(){var b=currentProfile=="phone"?"100":"80";if(settings.RSSTickerSpeed){var a=settings.RSSTickerSpeed.split("|");if(a.length>=3){switch(currentProfile){case"desktop":b=a[0];break;case"tablet":case"largetablet":b=a[1];break;case"phone":b=a[2];break;default:b=a[0];break}}}return b}},0,0,0,0,0,0,[InfinityMobile.controller,"LayoutController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderController",Ext.app.Controller,{config:{stores:["EditionFlatplan"],refs:{carousel:"infinitecarousel2d",readerView:"#reader",readerPanel:"reader",main:"#rootPanel",readerViewController:"#readerViewController",readerhelper:"readerhelper",readerlanguage:"readerlanguage",downloadEditionButton:"#ReaderMenuDownload",interstitial:"interstitial",readerpageviewer:"readerpageviewer",zoomSlider:"zoomSlider",navbutton:"navbutton",articlecarousel:"articlecarousel",articlescontainer:"articlescontainer",layouttoolbar:"layouttoolbar",readermenutts:"readermenutts",readertoolbarbottom:"readertoolbarbottom",bannerAd:"readerbannerad",sectionscroller:"sectionscroller",readermenu:"readermenu",pagerestriction:"pagerestriction",readerarticlepopoveritem:"readerarticlepopoveritem",readeradvertpageviewer:"readeradvertpageviewer"},control:{carousel:{pagechange:"readerPageChange2",idle:"readerIdle",notidle:"killActiveRequest",showLeft:"showLeft",hideLeft:"hideLeft",showRight:"showRight",hideRight:"hideRight",resizeArticleController:"resizeArticleController",updatePageNumber:"setCurrentPageNumber",killAd:"hideBannerAd",trackSwipeItemChange:"trackSwipeItemChange",loadBannerAd:"loadBannerAd",forceLoadBannerAd:"forceLoadBannerAd"},readerPanel:{cacheEdition:"cacheEdition",ready:"readerContainerReady",toggleNavButtons:"toggleNavButtons"},readerhelper:{next:"helperNext",close:"closeHelper",articleHelper:"articleHelper"},articlehelper:{close:"closeHelper"},readerlanguage:{cancel:"languageCancel",update:"languageUpdate"},downloadEditionButton:{click:"downloadEdition"},interstitial:{closeInterstitial:"closeInterstitial"},main:{pagejump:"jumpToPage",checkActivePageInToolbarBottom:"checkActivePageInToolbarBottom",clearAdvertInterval:"clearAdvertInterval",resumeAdvertInterval:"resumeAdvertInterval",settingsLoaded:"settingsLoaded",pauseAutoRefreshingAdverts:"pauseAutoRefreshingAdverts",resumeAutoRefreshingAdverts:"resumeAutoRefreshingAdverts"},zoomSlider:{zoomStart:"zoomStart",zoom:"zoom",zoomEnd:"zoomEnd"},navbutton:{jumpToPage:"jumpToPage",scrollLeft:"scrollLeft",scrollRight:"scrollRight",scrollUp:"scrollUp",scrollDown:"scrollDown",trackOnEndPan:"trackOnEndPan"},readerpageviewer:{hideNavButtons:"hideNavButtons",showNavButtons:"showNavButtons",hideTop:"hideTop",showTop:"showTop",hideBottom:"hideBottom",showBottom:"showBottom",fitMode:"fitMode",fillMode:"fillMode",checkWrapAd:"checkWrapAd",checkPagesBrowser:"checkPagesBrowser",setupPrintContainer:"setupPrintContainer",nextSection:"nextSection",previousSection:"previousSection",trackManualPageTurn:"trackManualPageTurn",loadBannerAd:"loadBannerAd"},articlesectionitemimg:{jumpToPage:"jumpToPage"},articlesectionitem:{jumpToPage:"jumpToPage"},backgroundwrapaditem:{resizeWrapAds:"resizeWrapAds"},articlescontainer:{checkActivePageInBrowser:"checkActivePageInBrowser"},clippingoptionsmenu:{setupPrintContainer:"setupPrintContainer"},readerbannerad:{bannerAdClose:"bannerAdClose",bannerHidden:"bannerHidden",bannerShown:"bannerShown"},sectionscroller:{sectionScrollerInit:"sectionScrollerInit"},sectionscrolleritem:{jumpToSection:"jumpToSection"},readerpagethumbnail:{toggleCheckBox:"toggleCheckBox",checkCheckBox:"checkCheckBox",uncheckCheckBox:"uncheckCheckBox"}}},statics:{hasAutoRefreshSettingForWrapperAds:function(){if(typeof settings=="object"&&"wrapAd" in settings&&typeof settings.wrapAd=="object"){var b="refresh" in settings.wrapAd&&settings.wrapAd.refresh=="true";var a="refreshIntervalDuration" in settings.wrapAd&&!!settings.wrapAd.refreshIntervalDuration;return b&&a}return false},hasAutoRefreshSettingForBannerAd:function(){if(typeof settings=="object"&&"reader" in settings&&typeof settings.reader=="object"&&"bannerAd" in settings.reader&&typeof settings.reader.bannerAd=="object"){var c="refresh" in settings.reader.bannerAd&&settings.reader.bannerAd.refresh=="true";var a="refreshIntervalDuration" in settings.reader.bannerAd&&!!settings.reader.bannerAd.refreshIntervalDuration;var b="enableAutoRefresh" in settings.reader.bannerAd&&settings.reader.bannerAd.enableAutoRefresh=="true";return c&&a&&!b}return false},isNewPWA:function(){return typeof NEWPWA!="undefined"&&NEWPWA===true},ADVERT:{AUTO_REFRESH:{ACTION:{PAUSE:"pause",RESUME:"resume"},EVENT:{PAUSE:"pauseAutoRefreshingAdverts",RESUME:"resumeAutoRefreshingAdverts"}}}},init:function(){var b=this;b.loadPage=null;b.preRolAd=false;var a=Ext.getStore("EditionFlatplan");a.on({load:"editionFlatplanLoad",scope:this});b.canLoadAd=true;b.initializeDB();b.initCacheVariables();b.canChangeAd=true;b.bannerTimeout=null;pageOffset=0;b.swipesUntilNewBannerAd=0;b.advertRefreshCounter=0;pagesRead=[];Ext.Viewport.on("orientationchange",function(){b.ttsStateChange()});ttsFlag={status:"STOPPED"}},initCacheVariables:function(){var c=this;var a=document.createElement("canvas");var b=a.getContext("2d");c.needToClearBuffer=false;c.canProgressiveDownload=true;devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1;c.bufferValue=typeof settings!="undefined"&&settings.page!=null&&settings.page.bufferCount!=null?settings.page.bufferCount:6;c.needToClearBuffer=true;c.canProgressiveDownload=true;activerequest=null},initializeDB:function(){var a=this},editionFlatplanLoad:function(a){var c=this;flatPlanData=a.data.items[0].raw;flatPlanData.sectionPageCount=0;flatPlanData.frontOffset=0;flatPlanData.backOffset=0;c.storeOriginalNumbers();c.checkLeftHandAdvert();c.checkCheckSectionPages();c.checkAdvertInPageFlow();c.setFirendlyPageNumbering(flatPlanData);if(settings.reader.reverse!=null&&settings.reader.reverse=="true"){flatPlanData.pageGroups=flatPlanData.pageGroups.reverse();for(var b=0;b<flatPlanData.pageGroups.length;b++){flatPlanData.pageGroups[b].pages[0].pageNum=b+1;flatPlanData.pageGroups[b].pages[0].pageName=flatPlanData.pageGroups[b].pages[0].origPageNum}}c.setPageOffset();c.setupPdfPageGroups();c.loadEditionMedia(flatPlanData,a);c.mediaController=c.getApplication().getController("MediaController")},setupPdfPageGroups:storeOriginalNumbers:setAdTargeting:function(a){$.ajax({url:"../get_targeted_adverts.aspx?pubid="+publicationguid+"&edid="+editionguid,success:function(g){if(g!=null){if(a.pageGroups!=null){var b=a.pageGroups}if(a.pageMapper!=null){var f=a.pageMapper}if(b!=null&&f!=null){for(var e in g){if(g[e]!=null&&g[e].page!=null&&g[e].adunit!=null){var d=g[e];var c=f[d.page];if(b[c-1]!=null&&b[c-1].pages[0]!=null){b[c-1].pages[0].adunit=d.adunit}}}}}}})},setFirendlyPageNumbering:function(m){if(settings.reader.friendlyNumbering!=null){var s=m.pageGroups.length-(m.totalAdvertsAdded!=null?m.totalAdvertsAdded:0);m.friendlyPageMapper={};var n=settings.reader.friendlyNumbering;try{n=n[n.length-1]=="|"?n:n+"|"}catch(q){console.warn("[ReaderController] Error Caught: \n",q)}var d=n.split("|");var a=[];var c=0;for(var p=0;p<d.length;p++){var l=d[p];var j=parseInt(d[p].split(":")[1]);if(l!=""){var b={name:d[p].split(":")[0],pageNumber:j};a.push(b);if(p>0){a[p-1].sectionLength=(j-c);if(p==(d.length-2)){a[p].sectionLength=s-j}}else{if(p==0){a[p].sectionLength=m.pageGroups.length-(m.totalAdvertsAdded!=null?m.totalAdvertsAdded:0)}}c=j}}if(a.length>0){var k=a[0];var r=null;if(a.length>1){r=a[1]}var o=m.pageGroups;var e=1;var g=1;var f=0;for(var p=0;p<o.length;p++){var h=o[p].pages[0];if(r!=null){if(r.pageNumber==p-f){e++;g=1;k=r;if(a.length>e){r=a[e]}else{r=null}}}if(h.type=="page"){h.pageName=k.name+g;h.sectionLength=k.sectionLength;m.friendlyPageMapper[h.pageName]=p;g++}else{f++}}}}},setPageOffset:function(){var d=this;var f=settings.reader.pageOffset;if(settings.reader.pageOffset!=null){flatPlanData.totalPages=flatPlanData.pageGroups.length;flatPlanData.frontPageNames=f.pageOffsetFront.split("|");flatPlanData.backPageNames=f.pageOffsetBack.split("|");if(flatPlanData.frontPageNames!=""){flatPlanData.frontOffset=flatPlanData.frontPageNames.length}else{flatPlanData.frontOffset=0}if(flatPlanData.backPageNames!=""){flatPlanData.backOffset=flatPlanData.backPageNames.length}else{flatPlanData.backOffset=0}flatPlanData.totalOffset=parseInt(flatPlanData.frontOffset)+parseInt(flatPlanData.backOffset);var c=flatPlanData.pageGroups;for(var a=0;a<c.length-flatPlanData.backOffset;a++){var e=c[a+pageOffset].pages[0];if(e.type!="advert"){if(a<flatPlanData.frontOffset){e.pageName=flatPlanData.frontPageNames[a]}else{var b=e.advertsAdded!=null?e.advertsAdded:0;e.pageName=parseInt(e.pageNum)-parseInt(flatPlanData.frontOffset)-parseInt(b)}}}for(var a=0;a<flatPlanData.backOffset;a++){var e=c[(c.length-1)-a].pages[0];e.pageName=flatPlanData.backPageNames[a]}}},checkLeftHandAdvert:checkCheckSectionPages:function(){var h=this;var e=settings.reader.sectionFront;if(e!=null||(typeof isTribReader!="undefined"&&isTribReader==true)){var a=settings.bookmarks;if(a!=null&&a.bookmark!=null&&a.bookmark.length>0){var c=[];for(var f=(a.bookmark.length-1);f>=0;f--){var j=a.bookmark[f];var m=parseInt(j.pageNumber);if(m!=1){c.push(parseInt(j.pageNumber))}c.sort(function(o,n){return n-o})}var d=0;for(var f=0;f<c.length;f++){var m=c[f];if(m%2==1){var m=c[f];var k="resources/images/branding/previous-section@2x.png";if(e.previousPageImage!=null&&e.previousPageImage!=""){k=e.previousPageImage}var l={image:k,pageIndex:m-1,pageNum:m,pdf:"",versionKey:"",view:0,type:"sectionpage",direction:"previous"};var g={pages:[l]};flatPlanData.pageGroups.splice(m-1+pageOffset,0,g);d++;var b="resources/images/branding/previous-section@2x.png";if(e.nextPageImage!=null&&e.nextPageImage!=""){b=e.nextPageImage}var l={image:b,pageIndex:m-2,pageNum:m-1,pdf:"",versionKey:"",view:0,type:"sectionpage",direction:"next"};var g={pages:[l]};flatPlanData.pageGroups.splice(m-1+pageOffset,0,g);d++}}flatPlanData.sectionPageCount=d;flatPlanData.bookmarks=c}}},checkAdvertInPageFlow:function(){flatPlanData.totalAdvertsAdded=0;if(settings.reader.interstitialPageFlow!=null){var k=settings.reader.interstitialPageFlow;var h=k.count;var e=false;if(k.displaySections!=null&&k.displaySections=="true"){e=true}var l=JSON.parse(JSON.stringify(flatPlanData.pageGroups));var d=0;var b=0;console.log("IS SECTION: "+e);if(e){var c=settings.bookmarks;var a=[];if(c!=null&&c.bookmark!=null&&c.bookmark.length>1){for(var f=1;f<c.bookmark.length;f++){var j=parseInt(c.bookmark[f].page)-1;if(j%2==1){j++}a.push(j)}}console.log(a);for(var f=pageOffset;f<l.length;f++){var g=flatPlanData.pageGroups[f+b].pages[0];g.pageName=g.pageNum;g.pageNum+=d;g.advertsAdded=d;if(f!=pageOffset&&a.includes(f)){flatPlanData.pageGroups.splice(f+1+b,0,{pages:[{type:"advert",advert:k,pdf:"",pageIndex:g.pageNum+1,pageNum:g.pageNum+1,pageName:"Advertisement",side:"left"}]});flatPlanData.pageGroups.splice(f+2+b,0,{pages:[{type:"advert",advert:k,pdf:"",pageIndex:g.pageNum+1,pageNum:g.pageNum+1,pageName:"Advertisement",side:"right"}]});d++;b+=2}}}else{for(var f=pageOffset;f<l.length;f++){var g=flatPlanData.pageGroups[f+b].pages[0];g.pageName=g.pageNum;g.pageNum+=d;g.advertsAdded=d;if(f!=pageOffset&&f%h==pageOffset){flatPlanData.pageGroups.splice(f+1+b,0,{pages:[{type:"advert",advert:k,pdf:"",pageIndex:g.pageNum+1,pageNum:g.pageNum+1,pageName:"Advertisement",side:"left"}]});flatPlanData.pageGroups.splice(f+2+b,0,{pages:[{type:"advert",advert:k,pdf:"",pageIndex:g.pageNum+1,pageNum:g.pageNum+1,pageName:"Advertisement",side:"right"}]});d++;b+=2}}}flatPlanData.totalAdvertsAdded=b}},loadEditionMedia:function(f,c){var h=this;if(typeof loadMediaEveryPage!="undefined"&&loadMediaEveryPage){if(typeof startpageNumber!="undefined"){h.readyToLoadEdition=settings!=null&&settings.reader!=null&&settings.reader.defaultPageMode=="double"?false:true;if(f.pageGroups[startpageNumber-2]==null||f.pageGroups[startpageNumber]==null){h.readyToLoadEdition=true}h.makeMediaRequest(startpageNumber,f,c);if(settings!=null&&settings.reader!=null&&settings.reader.defaultPageMode=="double"){if(startpageNumber%2==0){var a=f.pageGroups[startpageNumber];if(a!=null){var k=a.pages[0];h.makeMediaRequest(k.pageNum,f,c)}}else{var b=f.pageGroups[startpageNumber-2];if(b!=null){var e=b.pages[0];h.makeMediaRequest(e.pageNum,f,c)}}}}}else{var j=Ext.getStore("MediaStore");j.on({load:function(){h.loadEdition(f,c.viewjson)}});var g="&lm="+latestLM;var l="&version=production";if(version=="stage"){l="&version=stage"}var d="";if(typeof verify!="undefined"&&verify!="false"){d="&verify="+verify}j.setProxy({url:"../get_media.aspx?edid="+editionguid+g+l+d});j.load()}},makeMediaRequest:function(a,e,b){var d=this;var c=e.pageGroups[a-1].pages[0];mainPanel.fireEvent("loadMediaForPage",c,function(){if(d.readyToLoadEdition){d.loadEdition(e,b.viewjson)}else{d.readyToLoadEdition=true}})},loadEdition:function(f,b){var e=this;editionFlatplanData=f;editionFlatplanData.pageMapper={};editionFlatplanData.reversePageMapper={};var a=editionFlatplanData.pageGroups;e.editionGuid=editionFlatplanData.editionGUID;e.updateFlatplan();for(var c=0;c<a.length;c++){var d=a[c].pages[0];d.pageIndex=c+1;if(d.type!="sectionpage"&&d.type!="leftHandAd"){editionFlatplanData.pageMapper[d.pageNum]=d.pageIndex-pageOffset}editionFlatplanData.reversePageMapper[d.pageIndex-pageOffset]=d.pageNum}var h="";if(currentProfile==="desktop"){if((typeof isTribReader!="undefined"&&isTribReader==true)||settings.reader.enableReaderPadding=="true"){h="20px 150px"}if(settings.wrapAd!=null&&settings.reader.enableReaderPadding=="true"){h="20px 200px"}else{if(settings.wrapAd!=null){h="0px 200px"}}}var g=function(){if(e.getReaderPanel()==null){var t=Ext.create("InfinityMobile.view.LayoutViewController",{id:"readerViewController",json:b,flatplandata:editionFlatplanData,cls:"reader2",width:"100%",height:"100%",padding:h});e.leftBtn=Ext.create("InfinityMobile.view.NavButton",{itemId:"leftBtn",xtype:"navbutton",left:0,style:"background-image:url('../assets/nav/left-arrow.png');left:0px;top:50%;transform:translateY(-50%);background-size:contain;background-repeat:no-repeat;",direction:"left",pagesLength:a.length-pageOffset});e.rightBtn=Ext.create("InfinityMobile.view.NavButton",{itemId:"rightBtn",xtype:"navbutton",right:0,style:"background-image:url('../assets/nav/right-arrow.png');right:0px;top:50%;transform:translateY(-50%);background-size:contain;background-repeat:no-repeat;",direction:"right",pagesLength:a.length-pageOffset});var v="11";if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){v="122"}e.topBtn=Ext.create("InfinityMobile.view.NavButton",{itemId:"topBtn",xtype:"navbutton",top:v+"px",left:"50%",style:"background-image:url('../assets/nav/right-arrow.png');left:50%;top:"+v+"px;transform:translateX(-50%) rotate(270deg);-webkit-transform:translateX(-50%) rotate(270deg);background-size:contain;background-repeat:no-repeat;",direction:"up",pagesLength:a.Length});if((settings.reader.bannerAd!=null&&((settings.reader.bannerAd.canBeClosed==null)||settings.reader.bannerAd.canBeClosed=="false"))&&settings.RSSTicker!=null&&settings.reader.bannerAd.position!="top"){var j=82}else{if(settings.reader.bannerAd!=null&&((settings.reader.bannerAd.canBeClosed==null)||settings.reader.bannerAd.canBeClosed=="false")&&settings.reader.bannerAd.position!="top"){var j=82}else{if(settings.RSSTicker!=null){var j=-28}else{var j=-28}}}e.toggledOn=true;e.bottomBtn=Ext.create("InfinityMobile.view.NavButton",{itemId:"topBtn",xtype:"navbutton",bottom:j+"px",left:"50%",style:"background-image:url('../assets/nav/right-arrow.png');left:50%;bottom:"+j+"px;transform:translateX(-50%) rotate(90deg);-webkit-transform:translateX(-50%) rotate(90deg);background-size:contain;background-repeat:no-repeat;",direction:"down",pagesLength:a.Length});e.topBtn.hide();if(settings.reader.zoomMode!="fill"){e.bottomBtn.hide();e.fill=false}else{e.fill=true}var y=e.getCarousel();if(y.config.pageNumber==0){e.leftBtn.hide()}if(settings.reader.toggleNavButtons=="true"){if(settings.reader.startToggledNavButtonsOn=="false"){e.toggleNavButtons()}}var o=Ext.create("InfinityMobile.view.Reader",{viewType:"reader",items:[{flex:1,layout:"fit",style:"background-color:white",itemId:"readerItems",items:[{xtype:"readertoolbarbottom",bottom:0,width:"100%",height:190},t]}]});var p=true;if(currentProfile=="desktop"){if((settings.newsday!=null&&settings.newsday.extraTopBar=="true")||settings.topbar.extraTopBarLogo=="true"||settings.topbar.extraTopBarMenu=="true"){var s=Ext.create("InfinityMobile.view.desktop.ExtraTopBar",{topBarColor:settings.topbar.backgroundColor});var w=e.getLayouttoolbar();if(w!=null){$(w.element.dom).css("top","0px")}o.insert(0,s);p=false}if(settings.dateSelector!=null&&p){var m=Ext.create("InfinityMobile.view.desktop.ArchiveSelector",{});m.setZIndex(2);o.insert(0,m)}}var x=o.getComponent("readerItems");if(x!=null&&currentProfile=="desktop"){x.add(e.leftBtn);x.add(e.rightBtn);x.add(e.topBtn);x.add(e.bottomBtn)}mainPanel.add(o);if(currentProfile=="phone"){e.leftBtn.destroy();e.rightBtn.destroy();e.topBtn.destroy();e.bottomBtn.destroy()}if(settings.dynamic!=null){var n=Ext.getStore("ArticleStore");n=n.data.items[0].raw;if(settings.dynamic.showDynamicArticleFirst=="true"&&n.articles.length>0){var u="InfinityMobile.view.ArticleReader";var r=Ext.create(u,{orientation:e.returnOrientation()});mainPanel.add(r);mainPanel.setActiveItem(r)}else{mainPanel.setActiveItem(o)}}else{mainPanel.setActiveItem(o)}var k="helper"+publicationguid;if(typeof(customHelperName)!="undefined"&&customHelperName!=""){k=customHelperName}try{var l=localStorage.getItem(k)}catch(q){var l=null}if(settings.newsday!=null){if(document.cookie.indexOf("newsdayHelper")==-1){e.loadHelperView()}}else{if(l==null){if(Ext.browser.is.IE){if(document.cookie.indexOf(k)==-1){e.loadHelperView()}}else{e.loadHelperView()}}else{e.checkLanguage()}}var y=e.getCarousel()}};e.cacheThumb(a[0].pages[0]);e.openArchiveModalOnLoad();g();e.checkArticle()},openArchiveModalOnLoad:function(){var g=this;var d=window.location.href;var e="archiveopen";g.openArchiveModal=false;var c=d.toLowerCase().indexOf(e);if(c!==-1){var a=d.slice(c).split("=");if(a.length>1){g.openArchiveModal=a[1].toLowerCase().includes("true")}else{g.openArchiveModal=false}}if(g.openArchiveModal&&settings&&settings.menu&&settings.menu.hideArchive==null){var b=Ext.getStore("ArchiveStore");var f=[];if(b&&b.data.items[0]!=null){if(b.data.items[0].raw.editions!=null&&b.data.items[0].raw.editions!=""){f=b.data.items[0].raw.editions.edition;if(f.length!=0){mainPanel.fireEvent("toolbarArchive",g)}}}}},checkArticle:function(){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.articleViewOnly=="true"){mainPanel.fireEvent("showArticlePopover")}else{if(typeof artGuid!="undefined"&&!!artGuid&&typeof EDITIONAPP!="undefined"&&EDITIONAPP){var c=Ext.getStore("MediaStore");if(!!c&&!!c.data&&!!c.data.items&&!!c.data.items[0]&&!!c.data.items[0].raw&&!!c.data.items[0].raw.media&&!!c.data.items[0].raw.media.article){var a=c.data.items[0].raw.media.article;var d;for(var b=0;b<a.length;b++){var e=a[b];if(!!e&&e.file==artGuid){d={config:{mediaObject:e,articleIndex:e.uniquearticleindex,article:e.file}};break}}if(!!d){mainPanel.fireEvent("showArticlePopover",d,artGuid)}}}}},updateFlatplan:function(){var c=this;if(typeof settings!="undefined"&&settings.page!=null&&settings.page.pdf=="encrypted.pdf"||settings.page.pdf=="encryptedv3.pdf"){for(var b=0;b<editionFlatplanData.pageGroups.length;b++){var a=editionFlatplanData.pageGroups[b];editionFlatplanData.pageGroups[b].pages[0]=c.updatePdfUrl(a.pages[0])}}},loadHelperView:function(){var a=this;helperDisabled=false;if((settings.reader.disableHelperScreenOnLaunch!=null&&settings.reader.disableHelperScreenOnLaunch=="true")||(typeof isShared!="undefined"&&isShared=="true")){helperDisabled=true}if(a.openArchiveModal){helperDisabled=true}if(!helperDisabled){if(settings.dynamic!=null){if(settings.dynamic.showDynamicArticleFirst!="true"){a.helper()}}else{a.helper()}}},helper:function(){var b=this;if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){}}else{if(currentProfile=="desktop"){var g=b.getLayouttoolbar();if(g!=null){g.howToTap()}}else{var e="InfinityMobile.view.tablet.ReaderHelper";switch(currentProfile){case"phone":e="InfinityMobile.view.phone.ReaderHelper";break;case"tablet":default:e="InfinityMobile.view.tablet.ReaderHelper";break}var f=Ext.create(e,{});var d=typeof settings!="undefined"&&!!settings.menu?settings.menu.browserTabOnLaunch:null;if(!!d){Ext.Viewport.add(f);f.setZIndex(10000000)}else{mainPanel.add(f)}f.show();var c=b.getCarousel();c.addCls("blur");var a=b.getArticlescontainer();if(a!=null){a.addCls("blur");a.disableEvents()}}}},helperNext:function(g){var d=this;var e="resources/images/branding/mobile-overlay-part2-wht.png";var a="resources/images/branding/mobile-overlay-landscape-part2-wht.png";if(settings.reader.helperScreen!=null){if(settings.reader.helperScreen.portrait2!=null){e=settings.reader.helperScreen.portrait2}if(settings.reader.helperScreen.landscape2!=null){a=settings.reader.helperScreen.landscape2}}var f=Ext.getStore("ArticleStore");if(f!=null&&f.data!=null&&f.data.items[0]!=null&&f.data.items[0].raw!=null&&settings.newsday!=null){var c=f.data.items[0].raw.articles;if(c!=null&&c.length==0){e="resources/images/branding/mobile-overlay-part2-no-article-wht.png";a="resources/images/branding/mobile-overlay-landscape-part2-no-article-wht.png"}}var b="<img class='portraitOnly' src='"+e+"' style='width:100%' /><img class='landscapeOnly' src='"+a+"' style='width:100%' />";g.container.setHtml(b);g.nextButton.hide();g.continueButton.show()},closeHelper:function(f){var c=this;var e=c.getCarousel();e.removeCls("blur");f.destroy();var d="helper"+publicationguid;if(typeof(customHelperName)!="undefined"&&customHelperName!=""){d=customHelperName}if(settings.newsday!=null){c.setCookie("newsdayHelper","true")}else{try{localStorage.setItem(d,"complete")}catch(b){}}c.checkLanguage();var a=c.getArticlescontainer();if(a!=null){a.removeCls("blur");a.enableEvents()}if(typeof isTribReader!="undefined"&&isTribReader==true){c.checkTrialScreen()}},setCookie:function(d,g){var f=this;var b=new Date().getDay();switch(b){case 0:b="Sun";break;case 1:b="Mon";break;case 2:b="Tues";break;case 3:b="Wed";break;case 4:b="Thu";break;case 5:b="Fri";break;case 6:b="Sat";break}var c=new Date().getDate();var h=new Date().getMonth();switch(h){case 0:h="Jan";break;case 1:h="Feb";break;case 2:h="Mar";break;case 3:h="Apr";break;case 4:h="May";break;case 5:h="Jun";break;case 6:h="Jul";break;case 7:h="Aug";break;case 8:h="Sep";break;case 9:h="Oct";break;case 10:h="Nov";break;case 11:h="Dec";break}var e=new Date().getFullYear()+1;var a=b+", "+c+" "+h+" "+e+" 12:00:00 UTC";document.cookie=d+"="+g+";expires="+a+";path=/"},checkTrialScreen:checkLanguage:function(){var a=this},checkEdgeBrowser:languageCancel:languageUpdate:latestEditionFlatplanLoad:readerContainerReady:function(b){var c=this;var a=c.getCarousel();c.readerPageChange2(a)},canDesktopTouchSwipe:function(){if(settings.reader.enablePageSwipe=="true"){return true}else{return false}},readerPageChange2:function(e,h,c){var g=this;g.killActiveRequest();if(g.loadPage!=null){clearInterval(g.loadPage)}g.preventBannerCloseResize=true;var a=500;if(currentProfile=="desktop"&&!(g.canDesktopTouchSwipe())){a=100}else{if(g.canDesktopTouchSwipe()){a=500;if(Ext.browser.is.Firefox){a=1000}}}var j=function(){g.loadImages(g,e)};if(g.canDesktopTouchSwipe()){j=function(){if(!e.isCarouselDragging){g.loadImages(g,e)}}}g.loadPage=setInterval(j,a);g.trackPage(e);g.clearBufferPage(e);g.checkAdvertAutoRefresh();g.checkAdvert();g.checkInterstitial();g.checkWrapperAds();g.checkNavigationButtons(e);g.stopAudio();g.stopVideo(c);g.reloadGIFs(h);g.ttsStateChange();g.updatePagesBrowser();g.updateSectionScroller();g.updateBannerPageSwipes();g.checkPageRestriction(e,h,c);g.checkAdvertPageFlow();try{g.setCurrentPageNumber(e)}catch(f){}mainPanel.fireEvent("removeSplash");g.setupPrintContainer();var d=g.getParamsfromURL(window.location.search,"search");var b=g.getParamsfromURL(window.location.search,"pnum");if(b&&!!d&&d.trim().length>1){mainPanel.fireEvent("loadPageSearchResults",b,d)}g.checkAdbridg(h,c)},isLeftHandAdAdbridg:function(){return typeof settings!="undefined"&&settings.leftSideAd&&settings.leftSideAd.type=="adbridg"},checkAdbridg:function(b,g){var d=this;var e=1500;d.adbridgTimeout;if(!!d.adbridgTimeout){clearTimeout(d.adbridgTimeout)}if(d.hasDoneFirstCheck){var a=typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.adbridg?settings.reader.adbridg:{};var c=d.isLeftHandAdAdbridg();if(!!g&&!!g.advertDiv&&c&&!!g.destroyPage0){g.destroyPage0()}if(!!a.domain&&typeof AdBridg!="undefined"){d.adbridgTimeout=setTimeout(function(){if(!!a.domain&&typeof AdBridg!="undefined"){window.AdBridg.cmd.push({action:"spa_pv_shutdown",action:"spa_pv_initialize",config:{targeting:{DOMAIN:a.domain,"PAGE-TYPE":"index"}}})}if(!!b&&c&&!!b.reloadPage0){b.reloadPage0()}},e)}}else{var c=d.isLeftHandAdAdbridg();if(b==null){b=d.getCarousel().getActiveItem()}var f=!!b&&!!b.config.leftPage?b.config.leftPage:b.config.previousPage;if(c&&(!!f&&f.type=="leftHandAd")){b.setupAdbridgLeftSideAdvert()}}d.hasDoneFirstCheck=true},checkAdvertPageFlow:checkAdvertAutoRefresh:function(){var a=this;if(a.bannerAdInterval!=null){clearInterval(a.bannerAdInterval)}},updateBannerPageSwipes:pagesuiteReports:function(a){var d=this;var e=a._pageNumber+1;var b=e-(e%2);var h=e+(1-e%2);var g="&pl="+b+"&pr="+h;if(d.returnOrientation()=="portrait"||a._mode=="single"){g="&pr="+e}if(reports!=null&&visitorguid!=null&&startpageNumber!=null&&window.location.protocol!="https:"){var c=reports+"track.aspx?html5=true&eid="+editionguid+"&vid="+visitorguid+g+"&device="+currentProfile;var f=this.getSubscriberGUID();if(f!=undefined){c+="&subscriber="+f}$.ajax({crossDomain:true,type:"GET",async:true,url:c,cache:false})}},getSubscriberGUID:function(){var c=getCookie("subscriber");if(!c){return undefined}var b=new RegExp("(?:^|&)guid(?:=([^&#]*)|&|#|$)","i");var a=b.exec(c,"i");if(!a){return undefined}if(!a[1]){return undefined}return decodeURIComponent(a[1].replace(/\+/g," "))},clearBufferPage:function(e){var g=this;if(g.needToClearBuffer){var a=e._pageNumber;var c=editionFlatplanData.pageGroups;var f=g.bufferValue;var j=Math.max(0,a-f);var b=Math.min(c.length-1,a+f);for(var d=0;d<c.length;d++){if(d<j||d>b){var h=c[d].pages[0];g.clearBuffer(h)}}}},checkAdvert:function(){var g=this;g.canLoadAd=false;if(g.bannerTimeout!=null){clearTimeout(g.bannerTimeout)}var a=g.getCarousel();var c=a.getActiveItem().getPageNo();var j=g.returnAdvertOffset(c+pageOffset);var b=c;var f=flatPlanData.pageGroups[b];var e=a.getActiveItem();var k=g.getBannerAd();if(f!=null&&f.pages[0]!=null&&f.pages[0].type=="advert"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.hideOnAdvertPage=="true"&&k!=null){k.canBeClosed="true";k.hide();e.resizeAdvert();g.hiddenBanner=true;return}else{if(g.hiddenBanner&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.hideOnAdvertPage=="true"&&k!=null){k.show();k.canBeClosed=settings.reader.bannerAd.canBeClosed;e.pageResize!=null?e.pageResize():e.onResize();g.hiddenBanner=false}}var h=1500;var d=typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.refreshViaPostMessage=="true";if(d){h=500}g.bannerTimeout=setTimeout(h)},trackPage:function(e){var g=this;var f=g.returnCorrectPageNumber(e);var a=f.split("-");mainPanel.fireEvent("trackPageTurn",a);this.handlePenskeTracking(e);return;var f=g.returnCorrectPageNumber(e);var a=f.split("-");if(typeof trackReaderEvent!="undefined"){var k=settings.bookmarks.bookmark;var j=null;if(k!=null&&k.length>0){var h=parseInt(e._pageNumber)+1;for(var d in k){if(h>=k[d].pageNumber&&(k[parseInt(d)+1]==null||h<k[parseInt(d)+1].pageNumber)){j=k[d].name;break}}}var c=g.getArticlesInView(a);trackReaderEvent("pageTurn",{pageNum:f,pageNumArray:a,section:j,articles:c})}if(settings.tracking!=null){var b=settings.tracking.trackingType;if(b=="GA"){g.gaPageChange(settings.tracking.accoundid,f)}else{if(b=="DA"&&typeof trackDaPageView!="undefined"){trackDaPageView("PDF|"+editionName+"|"+f,"Digital Edition")}}}g.trackTribune(e)},handlePenskeTracking:function(){if(settings.advancedLinkTracking=="true"){var b=this;var a=b.getCarousel();var c=b.returnCorrectPageNumber(a);var d=c.split("-");var e=b.getLinksInView(d);mainPanel.fireEvent("advancedLinks",d,e)}},getLinksInView:function(a){var e=this;var j={};var f=Ext.getStore("MediaStore").data.items[0].raw.media.link;if(f!=null&&f.length>0&&a!=null&&a.length>0){if(a.length>1){firstPage=a[0];secondPage=a[1];allPages=a[0]+"-"+a[1];j[firstPage]=[];j[secondPage]=[];j[allPages]=[];for(var b in a){var g=a[b];for(var h in f){var d=f[h];if(d.page==g){var c=d.url;j[g].push(c);j[allPages].push(c)}}}}else{allPages=a[0];j[allPages]=[];for(var h in f){var d=f[h];if(d.page==allPages){var c=d.url;j[allPages].push(c)}}}}return j},getArticlesInView:function(a){var e=this;var b=[];var g=Ext.getStore("MediaStore").data.items[0].raw.media.article;if(g!=null&&g.length>0&&a!=null&&a.length>0){for(var c in a){var h=a[c];for(var j in g){var f=g[j];if(f.page==h){var d={};d.guid=f.file;d.x=f.x;d.y=f.y;d.width=f.width;d.height=f.height;d.page=f.page;b.push(d)}}}}return b},checkPageRestriction:function(k,p,d){var n=this;if(loggedIn.toLowerCase()!="true"){if(settings.subscription.pageRestriction!=null){var e=k._pageNumber;var o=parseInt(settings.subscription.pageRestriction.pages);var j=o-1;if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){e=(k.getData().length-1-e);j=(k.getData().length-1-j)}var h=false;for(var g=0;g<pagesRead.length;g++){if(pagesRead[g]==editionFlatplanData.reversePageMapper[parseInt(k._pageNumber)+1]){h=true}}var r=settings.subscription.pageRestriction.pages;if(settings.subscription.pageRestriction.pages%2==0||startpageNumber>1){r++}var a=n.returnCorrectPageNumber(k);if(settings.subscription.pageRestriction.type=="unique"&&!h&&pagesRead.length<=r){var c=a.split("-");for(var g in c){if(pagesRead.length<settings.subscription.pageRestriction.pages&&k._mode=="single"){pagesRead.push(c[g])}else{if(pagesRead.length<r&&k._mode=="double"){pagesRead.push(c[g])}else{var q=n.getCarousel();q.jumpToPage(d.config.pageNo);var f=Ext.create("InfinityMobile.view.PageRestriction",{});if(settings.subscription.pageRestriction.disableRedirect==null){if(settings.subscription.pageRestriction.redirectUrl!=null){window.open(settings.subscription.pageRestriction.redirectUrl,"_blank")}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}break}}}}}else{if(e>=o&&settings.subscription.pageRestriction.type!="unique"){var q=n.getCarousel();q.jumpToPage(j);if(settings.subscription.pageRestriction.disableRedirect=="true"){var l=n.getPagerestriction();if(l==null){var f=Ext.create("InfinityMobile.view.PageRestriction",{})}}if(settings.subscription.pageRestriction.disableRedirect==null&&settings.subscription.pageRestriction.type!="url"){if(settings.subscription.pageRestriction.redirectUrl!=null){var b=n.getApplication().getController("AppController").getPageRestrictionRedirectUrl();var m=n.getApplication().getController("AppController").hasPageRestrictionRedirectInSameTab();window.open(!!b?b:settings.subscription.pageRestriction.redirectUrl,m?"_self":"_blank")}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}}}}}}},stopVideo:function(a){if(a!=null){if(a.pauseVideos!=null){a.pauseVideos()}}},reloadGIFs:function(a){if(a!=null){if(a.tryReloadGIF!=null){a.tryReloadGIF()}}},stopAudio:function(){var a=this;if(a.mediaController!=null){a.mediaController.stopAudio()}},checkAudio:function(a){var d=this;var f=a.getActiveItem();var b=f.audioObjects;for(var c in b){if(b[c]){if(a._pageNumber==b[c].config.mediaObject.page){if(b[c].config.mediaObject.autoPlay=="true"){b[c].playSound()}}}}var e=f.mp4Objects;for(var c in e){if(e[c]){if(e[c].config.mediaObject.autoPlay=="true"&&!e[c].closed){if(e[c].videoType=="mp4"){e[c].video.play()}else{if(e[c].videoType=="youtube"){e[c].playVideo()}}}}}},updatePagesBrowser:function(){var a=this;if(a.getArticlescontainer()!=null){if(a.getArticlescontainer().mode=="pages"){a.checkActivePageInBrowser(a.getArticlescontainer())}}},readerPageChange:function(b){var x=this;var u=x.returnCorrectPageNumber(b);var y=u.split("-");if(typeof trackReaderEvent!="undefined"){var m=settings.bookmarks.bookmark;var e=null;if(m!=null&&m.length>0){var w=parseInt(b._pageNumber)+1;for(var q in m){if(w>=m[q].pageNumber&&(m[parseInt(q)+1]==null||w<m[parseInt(q)+1].pageNumber)){e=m[q].name;break}}}trackReaderEvent("pageTurn",{pageNum:u,pageNumArray:y,section:e})}if(currentProfile=="desktop"){x.setupPrintContainer()}x.killActiveRequest();if(currentProfile=="desktop"){x.checkNavigationButtons(b)}x.mediaController.stopAudio();var f=b.getActiveItem();if(currentProfile=="desktop"){var j=f.audioObjects;for(var q in j){if(j[q]){if(b._pageNumber+1==j[q].mediaObject.page){if(j[q].mediaObject.autoPlay=="true"){j[q].playSound()}}}}var k=f.mp4Objects;for(var q in k){if(k[q]){if(k[q].mediaObject.autoPlay=="true"){if(k[q].videoType=="mp4"){k[q].video.play()}else{if(k[q].videoType=="youtube"){k[q].playVideo()}}}}}}if(x.loadPage!=null){clearInterval(x.loadPage)}var v=500;if(currentProfile=="desktop"){v=100}x.loadPage=setInterval(function(){x.loadImages(x,b)},v);if(x.needToClearBuffer){var h=b._pageNumber;var g=editionFlatplanData.pageGroups;var t=x.bufferValue;var r=Math.max(0,h-t);var s=Math.min(g.length-1,h+t);for(var q=0;q<g.length;q++){if(q<r||q>s){var a=g[q].pages[0];x.clearBuffer(a)}}}if(loggedIn.toLowerCase()!="true"){if(settings.subscription.pageRestriction!=null){var o=b._pageNumber;var d=parseInt(settings.subscription.pageRestriction.pages);var n=d-1;if(o>=d){var p=x.getCarousel();p.jumpToPage(n);var c=Ext.create("InfinityMobile.view.PageRestriction",{});if(settingStore.data.items[0].raw.subscription.pageRestriction.disableRedirect==null){if(settingStore.data.items[0].raw.subscription.pageRestriction.redirectUrl!=null){window.open(settingStore.data.items[0].raw.subscription.pageRestriction.redirectUrl,"_blank")}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}}}}}if(settings.tracking!=null){var l=settings.tracking.trackingType;if(l=="GA"){x.gaPageChange(settings.tracking.accoundid,h)}else{if(l=="DA"){trackDaPageView("PDF|"+editionName+"|"+h,"Digital Edition")}else{x.omniturePageChange()}}}else{if(typeof isTribReader!="undefined"&&isTribReader==true){x.trackTribune(b)}}x.ttsStateChange();if(x.getArticlescontainer()!=null){if(x.getArticlescontainer().mode=="pages"){x.checkActivePageInBrowser(x.getArticlescontainer())}}},setupPrintContainer:function(){var j=this;var g=j.getCarousel();var l=editionFlatplanData.reversePageMapper[(g._pageNumber)+1]-1+pageOffset;var d=editionFlatplanData.pageGroups;var k=d[l].pages[0];var b="";if(!g.isDPS()){l=editionFlatplanData.pageMapper[l+1]-1}if(j.returnOrientation()=="landscape"&&g._mode=="double"&&l>1&&l<(d.length-1)){var a="100%";if(currentProfile=="largetablet"&&Ext.os.is.iPad){a="75%;"}if(l%2==0+pageOffset){var c=l-1;var e=d[c].pages[0];var h="";if(e.type!="sectionpage"){h="top:100%;";b="<div style='position:absolute;width:"+a+";height:100%'>"+j.printPageHtml(e)+"</div>"}if(k.type!="sectionpage"){b+="<div style='position:absolute;width:"+a+";height:100%;"+h+"'>"+j.printPageHtml(k)+"</div>"}}else{var c=l+1;var e=d[c].pages[0];var h="";if(k.type!="sectionpage"){h="top:100%;";b="<div style='position:absolute;width:"+a+";height:100%'>"+j.printPageHtml(k)+"</div>"}if(e.type!="sectionpage"){b+="<div style='position:absolute;width:"+a+";height:100%;"+h+"'>"+j.printPageHtml(e)+"</div>"}}}else{if(currentProfile=="desktop"){l=editionFlatplanData.reversePageMapper[l+1]-1;if(d[l]!=null){k=d[l].pages[0]}}b=j.printPageHtml(k)}var f=$(".printContainer")[0];f.innerHTML=b},printPageHtml:function(b){var c=this;var a="";var d=b.image;if(d!=null){if(window.location.protocol=="https:"){d=d.replace("http://pages.cdn.pagesuite.com","https://s3-eu-west-1.amazonaws.com/origin.pages.cdn.pagesuite.com")}if(window.location.protocol=="https:"){d=d.replace("http://pages.cdn.pagesuite.com","https://s3-eu-west-1.amazonaws.com/origin.pages.cdn.pagesuite.com")}if(settings.page.useMobileFullJpg=="true"){d="https://pages-mobile.pagesuite.com/images/"+b.guid+"/full.jpg"}else{if(settings.page.highResImage||settings.page.optimisedImage){d=d.replace("page.jpg","largepage.jpg")}else{if(settings.page.jpg!=null&&settings.page.jpg!="page.jpg"){d=d.replace("page.jpg",settings.page.jpg)}}}if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){a='<img src="'+d+'" style="left:50%;transform:translateX(-50%);position:absolute;max-height:100%;max-width:100%;" />'}else{a='<img src="'+d+'" style="width:100%;height:100%;object-fit: contain" />'}}return a},setCurrentPageNumber:function(a){var e=this;if(settings.reader.trackPagePosition!=null&&settings.reader.trackPagePosition=="true"){var c=new Date();c=c.setHours(c.getHours());var b=a._pageNumber+1;if(a.isDPS!=null&&a.isDPS()){b=editionFlatplanData.reversePageMapper[b]}if(settings.reader!=null&&settings.reader.reverse=="true"){b=editionFlatplanData.pageGroups.length-b+1}var f={pageNumber:b,date:c};try{localStorage.setItem("page"+editionguid,JSON.stringify(f))}catch(d){}}},trackTribune:checkNavigationButtons:function(b){var a=this;if(currentProfile=="desktop"){if(b._pageNumber>0){if(settings.reader.toggleNavButtons!=null&&settings.reader.toggleNavButtons=="true"){if(a.toggledOn){a.showLeft()}}else{a.showLeft()}}else{a.hideLeft()}if(b._pageNumber==(b.getData().length-1-pageOffset)){a.hideRightIcon()}else{if(settings.reader.toggleNavButtons!=null&&settings.reader.toggleNavButtons=="true"){if(a.toggledOn){a.showRightIcon()}}else{a.showRightIcon()}}}},gaPageChange:function(c,a){var b=this;if(typeof ga!="undefined"){ga("set","page","/"+(a));b.setGaCustomerId();ga("send",{hitType:"pageview",title:publicationName+" - "+editionName})}},setGaCustomerId:function(){var a="";if(typeof getCookie==="function"){a=getCookie("gatid")}if(typeof gtag!="undefined"&&a!=null&&a!=""){gtag("set",{user_id:a,send_page_view:false})}},omniturePageChange:clearBuffer:getParamsfromURL:function(b,c){var a=b.indexOf("&"+c+"=");if(a==-1){return null}var d=b.substring(a+c.length+2).split("&")[0];return isNaN(d)?d:Number(d)},loadImages:function(j,e){var g=this;clearInterval(j.loadPage);g.setupPrintContainer();g.checkAudio(e);g.refreshBannerAd(e._pageNumber+1);var b="Image";if(currentProfile=="desktop"){b="PDF"}else{b=settings.page.renderMode}if(b=="PDF"){g.loadPDFs(e);g.tryRenderPDFPage(e)}else{var f=e.getItems().items;var d=e.getActiveItem();var k="";var h="";for(var c=0;c<f.length;c++){var a=f[c];if(a.getPageNo()!=d.getPageNo()){if(k==""){k=a}else{h=a}}}g.loadPageImage(d,true,function(){g.loadPageImage(k,false,function(){g.loadPageImage(h,false,function(){e.fireEvent("idle",e)})})})}},loadPageImage:function(b,a,c){if(b!=null&&b.completeImageLoaded!=null){if(Ext.os.is.iOS&&b.paintCheck!=null&&!b.paintCheck()){b.layoutImages(b.image,b.image,b.landscapeimage);b.resetPage();b.resetZoom()}b.completeImageLoaded(a,c)}},loadPDFs:function(c){var g=this;if(settings.page.ignorePDF==null){var b=editionFlatplanData.pageGroups;var d=g.returnMappedPageNumber(c,c._pageNumber);var f=b[d+pageOffset].pages[0];g.tryCachePDFPage(f);if(g.returnOrientation()=="landscape"){var e;if(d%2==0){e=Math.max(0,d-1)}else{e=Math.min(b.length-1,d+1)}if(b[e+pageOffset]!=null){var a=b[e+pageOffset].pages[0];g.tryCachePDFPage(a)}}setTimeout(function(){g.bufferPDFS(b,d)},100)}},returnMappedPageNumber:bufferPDFS:tryCachePDFPage:function(a){var b=this;if(a.cached==null){b.cachePDF(a);if(typeof loadMediaEveryPage!="undefined"&&loadMediaEveryPage){mainPanel.fireEvent("loadMediaForPage",a)}a.cached=true}},cachePDF:function(c){var e=this;var b="page.pdf";if(settings.page.pdf!=null){b=settings.page.pdf}if(c.pdf!=""){var g=c.pdf;if(settings.page.pdf!=null){g=g.replace("page.pdf",b)}if(window.location.protocol=="https:"){g=g.replace("http://","https://")}var a={url:g};if(g.toLowerCase().indexOf("encrypted.pdf")!=-1){a.password=c.guid}if(g.toLowerCase().indexOf("encryptedv3.pdf")!=-1){a.password=e.decryptV3(c.guid)}if(g.toLowerCase().indexOf("encryptedv4.pdf")!=-1){a.password=e.decryptV4(c.guid)}var f=function(h){var j=returnPdfJsBaseVersion()==1?h.pdfInfo.numPages:h.numPages;if(j>0){h.getPage(1).then(}};if(returnPdfJsBaseVersion()==1){var d=PDFJS.getDocument(a);d.then(f)}else{if(returnPdfJsBaseVersion()>=2){if(window.myPdfWorker==null){window.myPdfWorker=new PDFJS.PDFWorker("myPdfWorker")}a.worker=window.myPdfWorker;var d=PDFJS.getDocument(a);d.promise.then(f)}}d.pageNo=c.pageNum;c.pdfRequest=d}},updatePdfUrl:function(h){var f=this;if(h.type=="page"){var g={"0":"e","1":"f","2":"0","3":"1","4":"2","5":"3","6":"4","7":"5","8":"6","9":"7",a:"8",A:"8",b:"9",B:"9",c:"a",C:"a",d:"b",D:"b",e:"c",E:"c",f:"d",F:"d"};var a=h.guid;var e=a.split("-");var b="";for(var c=0;c<e.length;c++){var k=e[c];var d="";var j=k[k.length-1];d=k.substring(0,k.length-1)+g[j];if(c<e.length-1){d+="-"}b+=d}h.guid=b;h.pdf=h.pdf.replace(a,b);h.image=h.image.replace(a,b)}return h},tryRenderPDFPage:renderPDFPage:function(b){var a=this;b.completePDFLoaded()},killActiveRequest:readerIdle:startCaching:function(c){var h=this;var b=editionFlatplanData.pageGroups;var e=c._pageNumber;var a=Math.max(0,e-h.bufferValue);var d=Math.min(b.length-1,e+h.bufferValue);for(var f=a;f<d;f++){var g=b[f].pages[0];if(!h.isIdle){break}if(typeof loadMediaEveryPage!="undefined"&&loadMediaEveryPage){mainPanel.fireEvent("loadMediaForPage",g)}if(g.cached==null&&g.type=="page"){h.cachePage(g,function(){h.startCaching(c)});g.cached=true;break}}},cacheThumb:function(d){var c=this;if(d.image!=null){var b=d.image;if(window.location.protocol=="https:"){}if(settings.page.optimisedImage=="true"){b=b.replace("page.jpg","largepage.jpg")}else{if(settings.page.jpg!=null&&settings.page.jpg!="page.jpg"){b=b.replace("page.jpg",settings.page.jpg)}}var a=document.createElement("img");if(b.toLowerCase().indexOf("encrytptedv3.jpg")!=-1){b=c.decryptAES(byteArray,pageGuid)}a.src=b}},cachePage:function(e,f){var g=this;var d=g.editionGuid;var c=g.retrievePageGuid(e);g.cacheThumb(e);var j=settings.page;var b=300;if(j.lowres!=null){b=j.lowres}var h="https://pages.pagesuite.com/";if(flatPlanData.pagesDomain!=null){h=flatPlanData.pagesDomain+"/"}var a=h+c[0]+"/"+c[1]+"/"+c+"/tile/page_90_"+b+".json";if(settings.page!=null&&settings.page.encryptionVersion=="2"){a=h+c[0]+"/"+c[1]+"/"+c+"/tile/page_90_"+b+"_crypt.json"}g.loadInline(d,e,a,c,b,f)},loadWorker:loadInline:function(h,g,c,f,d,b){var e=this;var a="";if(settings.page.pdf!=null){a="&pdf="+settings.page.pdf.replace(".pdf","")}g.request=$.ajax({crossDomain:true,type:"GET",contentType:"application/json",async:true,cache:true,url:c,success:function(j){g.tileImage=e.createImagesArray(j,g);if(b!=null){b();$(g.request).trigger("loaded")}},error:function(k){if(k.statusText!="abort"){var j="https://tile.html5.pagesuite-professional.co.uk/get_image_jpg_tile.aspx";if(settings.page.customTilingURL!=null){j=settings.page.customTilingURL}var l=j+"?edid="+h+"&pguid="+f+"&dpi="+d+a;$.ajax({crossDomain:true,type:"GET",contentType:"application/json",async:true,cache:true,url:l,success:function(m){g.tileImage=e.createImagesArray(m,g);if(b!=null){b();$(g.request).trigger("loaded")}},error:function(m,n){}})}}});activerequest={page:g}},createImagesArray:function(g,f){var d=this;var e=[];for(var c=0;c<g.images.length;c++){var h=document.createElement("img");var a=g.images[c];var b=a.url;if(window.location.protocol=="https:"){b=b.replace("http://pages.cdn.pagesuite.com",flatPlanData.pagesDomain)}d.setImageSrc(h,b,f);h.startX=a.startX;h.startY=a.startY;h.width=a.width;h.height=a.height;e.push(h)}return e},getEncryptedImageSrc:function(b,d,a){var c=this;var e=new XMLHttpRequest();e.open("GET",b,true);e.responseType="arraybuffer";e.onload=function(g){var j=e.response;var f=new Uint8Array(j);if(settings.page.encryptionVersion=="3"){a=c.decryptV3(a)}else{if(settings.page.encryptionVersion=="4"){a=c.decryptV4(a,true)}}var h=c.decryptAES(f,a);$(d).attr("src",h)};e.send()},decryptV4:function(c,d){var e=this;c=c.replace(/-/g,"");var b=new RegExp(e.aesRegex(settings.page.checksum).replace(/\//,""));var f=new RegExp(/([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/);var a=c.replace(f,b).replace(/\//g,"");if(d){a=a.splice(7,0,"-").splice(12,0,"-").splice(17,0,"-").splice(22,0,"-")}return a},aesRegex:function(b){if(typeof CryptoJS!="undefined"){var c=CryptoJS.enc.Hex.parse("02e656e46f3f441cbfa21c72b5a0bfcf");var e=CryptoJS.enc.Base64.parse(b);var a=CryptoJS.AES.decrypt({ciphertext:e},c,{keySize:16,iv:CryptoJS.enc.Hex.parse("00000000-0000-0000-0000-000000000000".replace(/-/g,"")),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});var d=CryptoJS.enc.Utf8.stringify(a);return d}},decryptV3:function(b){gString=b.replace(/-/gi,"");seed=parseInt(gString.substring(0,2),16);gChars=Array.from(gString);for(i=0;i<32;i++){seed=((3*seed+7)%32);var a=gChars[i];gChars[i]=gChars[seed];gChars[seed]=a}gString=gChars.join("");return gString},decryptAES:function(e,a){var d=this;if(typeof CryptoJS!="undefined"){var c=CryptoJS.enc.Hex.parse(a.replace(/-/g,""));var g=d.byteArrayToWordArray(e);var b=CryptoJS.AES.decrypt({ciphertext:g},c,{keySize:16,iv:CryptoJS.enc.Hex.parse("00000000-0000-0000-0000-000000000000".replace(/-/g,"")),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});var f=CryptoJS.enc.Base64.stringify(b);return"data:image/jpeg;base64,"+f}},byteArrayToWordArray:function(c){var b=[],a;for(a=0;a<c.length;a++){b[(a/4)|0]|=c[a]<<(24-8*a)}return CryptoJS.lib.WordArray.create(b,c.length)},setImageSrc:function(d,c,e){var b=this;var a=c;if((settings.page.encryptionVersion=="2"||settings.page.encryptionVersion=="3")&&a!=""){b.getEncryptedImageSrc(a,d,e.guid)}else{$(d).attr("src",a)}},retrievePageGuid:function(c){var b=c.image.split("/");var a=b[b.length-2];return a},getPage:changeAdvert:checkInterstitial:function(){var d=this;var c=settings.reader.interstitial;if(c!=null){if(c.launchOnLoad=="true"&&!d.preRollAd){d.preRollAd=true;var f="InfinityMobile.view.tablet.Interstitial";switch(currentProfile){case"phone":f="InfinityMobile.view.phone.Interstitial";break;case"tablet":default:f="InfinityMobile.view.tablet.Interstitial";break}var b=Ext.create(f,{});Ext.Viewport.add(b);var e=d.getCarousel();e.disableTiling();if(currentProfile=="desktop"){e.onDragEnd()}}}if(c!=null&&(c.mode=="overlay"||c.mode=="swipe")){var a=c.count;if(pageSwipes===null){pageSwipes=0}else{pageSwipes++;if(pageSwipes%a==0){var f="InfinityMobile.view.tablet.Interstitial";switch(currentProfile){case"phone":f="InfinityMobile.view.phone.Interstitial";break;case"tablet":default:f="InfinityMobile.view.tablet.Interstitial";break}var b=Ext.create(f,{});Ext.Viewport.add(b);var e=d.getCarousel();e.disableTiling()}}}},closeInterstitial:function(){var a=this;var b=a.getCarousel();b.enableTiling()},killBannerAd:hideBannerAd:function(){var b=this;if(b.canChangeAd){var a=b.getBannerAd();if(a!=null){if(!(settings.topbar.hideTopbarOnFullscreen&&isFullscreen)){a.hideAdvert()}}}},destroyBannerAd:function(){var b=this;if(b.canChangeAd){var a=b.getBannerAd();if(a!=null){if(!(settings.topbar.hideTopbarOnFullscreen&&isFullscreen)){a.destroyAdvert()}}}},loadBannerAd:function(){var e=this;if(e.canChangeAd){var d=e.getBannerAd();if(d!=null){if(!(settings.topbar.hideTopbarOnFullscreen&&isFullscreen)){var a=[];var f=e.getCarousel();var g=f.getActiveItem();var b=g.getPageNo()+parseInt(1);if(settings.newsday!=null&&settings.newsday.showBannerOnLeftAdFailure=="true"&&(g.leftHandAdLoaded==false)&&!e.hasLoadedFallbackAd){e.hasLoadedFallbackAd=true;var c=e.getTargeting();d.setTargeting(c);d.loadAdvert(c)}else{e.hasLoadedFallbackAd=false;if(e.canGetBannerExcludedPages()){if(settings.newsday!=null&&settings.newsday.showBannerOnSingle=="true"&&e.isSinglePage()){}else{a=settings.reader.bannerAd.hideOnPages.split(",")}}if($.inArray(b+"",a)==-1){var c=e.getTargeting();d.setTargeting(c);if(currentProfile!="desktop"){if(e.canLoadAd){d.pageNumber=b;d.section=e.returnSection(b);d.loadAdvert(c)}}else{d.pageNumber=b;d.section=e.returnSection(b);d.loadAdvert(c)}}else{d.destroyAdvert()}}}}if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.refresh!=null&&settings.reader.bannerAd.refresh=="true"){e.canChangeAd=true;e.setupBannerAutoRefresh(d)}else{e.canChangeAd=false}}},setupBannerAutoRefresh:function(c){var d=this;if(typeof settings!="undefined"&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.enableAutoRefresh=="true"&&d.statics().hasAutoRefreshSettingForBannerAd()===false){var e=15000;var a=settings.reader.bannerAd;if(a.autoRefreshDuration!=null&&!isNaN(a.autoRefreshDuration)){e=a.autoRefreshDuration*1000}var b=a.maxRefreshes;d.advertRefreshCounter=0;if(d.bannerAdInterval!=null){clearInterval(d.bannerAdInterval)}d.bannerAdInterval=setInterval(function(){if(c!=null&&typeof c.refreshAdvert==="function"&&b>d.advertRefreshCounter){var f=c.adSlot!=null?c.adSlot:c.adslot;if(f!=null){console.log("REFRESHING LEADERBOARD: ",f);c.refreshAdvert();d.advertRefreshCounter++}}else{clearInterval(d.bannerAdInterval)}},e)}},returnSection:function(a){var e=this;var h=settings.bookmarks.bookmark;var f=null;if(h!=null&&h.length>0){for(var c in h){var b=parseInt(h[c].pageNumber);if(h[c].start!=null){b=h[c].start}var g=h[parseInt(c)+1];var d=null;if(g!=null){d=g.pageNumber;if(g.start!=null){d=g.start}}if(parseInt(a)>=b&&(d==null||parseInt(a)<parseInt(d))){f=h[c].name;break}}}return f},isSinglePage:function(){var a=this;var b=a.getCarousel();var c=b.getActiveItem();if((b._mode=="single"&&currentProfile=="desktop")||((a.returnOrientation()=="portrait"||b._mode=="single")&&currentProfile!="desktop")){return true}return false},forceLoadBannerAd:function(){var c=this;var b=c.getTargeting();var a=c.getBannerAd();if(a!=null){a.loadAdvert(b)}},canGetBannerExcludedPages:function(){var a=this;var b=a.getCarousel();if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.refresh!=null&&settings.reader.bannerAd.refresh=="true"&&settings.reader.bannerAd.hideOnPages!=null&&settings.reader.bannerAd.hideOnPages.length>0){return true}return false},getTargeting:function(){var d=this;var f=d.getCarousel();var g=f.getActiveItem();var c=null;var e=f._pageNumber+1;var a=e-1;var b=(currentProfile=="desktop"&&f._mode=="double")||(currentProfile!="desktop"&&f._mode=="double"&&d.returnOrientation()=="landscape");if(b&&e%2==1){a=e-1}if(editionFlatplanData.pageGroups[a]!=null&&editionFlatplanData.pageGroups[a].pages[0].adunit!=null){c=editionFlatplanData.pageGroups[a].pages[0].adunit}else{if(b&&e%2==0&&editionFlatplanData.pageGroups[a+1]!=null&&editionFlatplanData.pageGroups[a+1].pages[0].adunit!=null){c=editionFlatplanData.pageGroups[a+1].pages[0].adunit}}return c},refreshBannerAd:function(){var f=this;if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){if(f.swipesUntilNewBannerAd==0){var b=Ext.Viewport.query("readerbannerad");if(b.length<1){var j="InfinityMobile.view.tablet.ReaderBannerAd";switch(currentProfile){case"phone":j="InfinityMobile.view.phone.ReaderBannerAd";break;case"tablet":default:j="InfinityMobile.view.tablet.ReaderBannerAd";break}var a=Ext.create(j,{pageNumber:pageNumber});if(settings.reader.bannerAd.position=="top"){var h=settings.topbar.backgroundColor.indexOf("#")==0?settings.topbar.backgroundColor:"#"+settings.topbar.backgroundColor;if(typeof hexaToRgba==="function"&&typeof f.hexToRgb==="function"){if(h.length>=8){h=hexaToRgba(h)}else{var g=f.hexToRgb(h);var d=settings.topbar.opacity!=null?settings.topbar.opacity:"0.9";h="rgba("+g.r+","+g.g+","+g.b+","+d+")"}}a.setStyle({borderBottom:"1px solid #ffffff",backgroundColor:h});a.setDocked("top");var c=f.getReaderViewController();c.insert(0,a);a.show();try{c.updateLayout()}catch(e){}this.bannerShown(a,true)}else{Ext.Viewport.add(a);a.show();a.setBottom(0)}a.loadAdvert()}}}},checkPayWall:trackOmniture:returnCorrectPageNumber:function(h){var m=this;var a=h._pageNumber;if((h._mode=="double"&&currentProfile=="desktop")||(currentProfile!="desktop"&&m.returnOrientation()=="landscape"&&h._mode=="double")){a=editionFlatplanData.reversePageMapper[parseInt(a)+1]-1}var n=flatPlanData.pageMapper[a+1];n=flatPlanData.pageGroups[n-1+pageOffset]!=null?flatPlanData.pageGroups[n-1+pageOffset].pages[0].pageName:n;var g=flatPlanData.sectionPageCount!=null?flatPlanData.sectionPageCount:0;var b=flatPlanData.totalAdvertsAdded!=null?flatPlanData.totalAdvertsAdded:0;var j=h.getData().length-pageOffset-g-b;var e=n.toString();if(m.returnOrientation()=="landscape"&&h._mode=="double"){if(isNaN(n)){try{var d=flatPlanData.pageMapper[a+1];if(d>1&&d<j){var l=flatPlanData.pageGroups[a];if(a%2==0){var f=flatPlanData.pageGroups[a-1];e=f.pages[0].pageName+"-"+l.pages[0].pageName}else{var c=flatPlanData.pageGroups[a+1];e=l.pages[0].pageName+"-"+c.pages[0].pageName}}}catch(k){e=n}}else{if(n>1&&n<j){if(n%2==0){e=n+"-"+(n+1)}else{e=(n-1)+"-"+n}}}}return e},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(currentProfile=="desktop"){a="landscape"}else{if(Ext.os.is.Android){if(currentProfile=="phone"){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(screen.width>screen.height){a="landscape"}else{a="portrait"}}}}return a},jumpToPage:zoomStart:function(d,c){var b=this;var a=b.getCarousel();b.readerActiveItem=a.getActiveItem();if(b.readerActiveItem.onZoomStart!=null){b.readerActiveItem.onZoomStart(d,c)}else{d.sliderElement.dom.value=1}},zoom:function(c,b){var a=this;if(a.readerActiveItem!=null){if(a.readerActiveItem.onZoom!=null){a.readerActiveItem.onZoom(c,b)}else{c.sliderElement.dom.value=1}}},zoomEnd:function(c,b){var a=this;document.activeElement.blur();if(a.readerActiveItem!=null){if(a.readerActiveItem.onZoomEnd!=null){a.readerActiveItem.onZoomEnd(c,b)}else{c.sliderElement.dom.value=1}}},hideNavButtons:showNavButtons:hideTop:showTop:hideBottom:showBottom:scrollLeft:function(){var b=this;var a=b.getCarousel();if(a.getActiveItem().getScrollable().getScroller().position.x-50>0){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x-50)}else{a.getActiveItem().getScrollable().getScroller().scrollTo(0)}},scrollRight:function(){var b=this;var a=b.getCarousel();if(a.getActiveItem().getScrollable().getScroller().position.x+50<a.getActiveItem().getScrollable().getScroller().maxPosition.x){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x+50)}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().maxPosition.x)}},scrollUp:function(){var b=this;var a=b.getCarousel();if(a.getActiveItem().getScrollable()!=null){if(a.getActiveItem().getScrollable().getScroller().position.y-50>0){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().position.y-50);b.showTop();b.showBottom()}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,0);b.hideTop();b.showBottom()}}},scrollDown:function(){var b=this;var a=b.getCarousel();if(a.getActiveItem().getScrollable()!=null){if(a.getActiveItem().getScrollable().getScroller().position.y+50<a.getActiveItem().getScrollable().getScroller().maxPosition.y){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().position.y+50);b.showBottom();b.showTop()}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().maxPosition.y);b.hideBottom();b.showTop()}}},showLeft:function(){var a=this;if(a.leftBtn.isHidden()){a.leftBtn.show()}},hideLeft:function(){var a=this;if(!a.leftBtn.isHidden()){a.leftBtn.hide()}},showRightIcon:hideRightIcon:fitMode:function(){var a=this;var b=a.getCarousel();if(a.topBtn!=null){a.hideTop()}if(a.bottomBtn!=null){a.hideBottom()}},fillMode:function(){var a=this;var b=a.getCarousel();var c=b.getActiveItem();if(c.scroller!=null){if(c.scroller.position.y<=0){a.hideTop();a.showBottom()}else{if(c.scroller.position.y>=c.scroller.maxPosition.y){a.showTop();a.hideBottom()}else{a.showTop();a.showBottom()}}}},resizeArticleController:function(){var a=this;if(a.getArticlecarousel()!=null){a.getArticlecarousel().onSizeChange()}},getZoomValue:resizeWrapAds:function(a){var b=this;var d=true;if(settings.wrapAd!=null&&settings.wrapAd.hideLeftWrapperOnFirstPage=="true"){var c=b.getCarousel();if(c!=null&&c.getActiveItem().getPageNo()==0&&a.side=="left"){a.removeCls("showWrapper");a.addCls("hideWrapper");d=false}}if(settings.wrapAd!=null&&settings.wrapAd.hideWrapperOnPortrait=="true"){if($(window).width()/$(window).height()<=1.4){a.removeCls("showWrapper");a.addCls("hideWrapper")}else{if(d){a.addCls("showWrapper");a.removeCls("hideWrapper");if(!a.advertInitialised){a.setupAdvert()}}}}},checkWrapAd:function(b){var a=this},toggleNavButtons:function(){var b=this;if(currentProfile!="phone"){if(b.toggledOn==true){b.bottomBtn.element.dom.style.display="none";b.topBtn.element.dom.style.display="none";b.leftBtn.element.dom.style.display="none";b.rightBtn.element.dom.style.display="none";b.toggledOn=false}else{var c=b.getCarousel();if(c.getActiveItem().scale==1){if(c._pageNumber>0){b.leftBtn.element.dom.style.display=""}if(c._pageNumber<c.getData().length-1){b.rightBtn.element.dom.style.display=""}if(c._zoomMode=="fill"){var a=c.getActiveItem().scroller;if(a.position.y>a.minPosition.y){b.topBtn.element.dom.style.display=""}if(a.position.y<a.maxPosition.y){b.bottomBtn.element.dom.style.display=""}}}else{b.bottomBtn.element.dom.style.display="";b.topBtn.element.dom.style.display="";b.leftBtn.element.dom.style.display="";b.rightBtn.element.dom.style.display=""}b.toggledOn=true}}},articleHelper:ttsStateChange:function(){if(typeof settings!="undefined"&&settings.tts!=null){var b=this;if(b.getLayouttoolbar()!=null){var a=b.getLayouttoolbar().ttsToggle}else{var a=ttsFlag}if(a!=null){if(window.speechSynthesis!=null){if(window.speechSynthesis.paused==true){window.speechSynthesis.resume();a.status="STOPPED"}if(window.speechSynthesis.speaking==true){window.speechSynthesis.cancel();if(a.status!="STOPPED"){a.status="FINISHED"}a.removeCls("playing")}setTimeout(function(){if(a.status=="FINISHED"&&(settings.tts.autoplay==true||settings.tts.autoplay=="true")){if(a==ttsFlag){var c="noicon";b.getApplication().getController("MediaController").playArticleTTS(a,c)}else{b.getApplication().getController("MediaController").playArticleTTS(a)}}},200)}}}},checkActivePageInBrowser:function(l){var k=this;var o=k.getCarousel();if(o!=null){var e=o.getActiveItem();var n=e.getPageNo();var a=flatPlanData.pageGroups[n+pageOffset].pages[0].origPageNum-1;if((settings.reader.reverse!=null&&settings.reader.reverse=="true")){try{a=parseInt(flatPlanData.pageGroups[n+pageOffset].pages[0].pageNum)-1}catch(j){}}if(e.xtype==="readeradvertpageviewer"){a=-1}if(l.mode=="pages"){var p=l.contentArea.items.items[0].items.items[a];var h=l.contentArea.items.items[0].items.items;if(h!=null){for(var d in h){$(h[d].img).css("border","")}}if(p!=null){var c=p.img;if(c!=null){var b=0;if(currentProfile=="desktop"){if(o._mode=="double"){if(a%2==1){if(o.getActiveItem().config.rightPage.type!="sectionpage"){if(a+1<h.length){b=$(h[a-1].img).width()+10;$(h[a+1].img).css("border","5px solid #"+settings.reader.buttonColour)}}}else{if(a-1>0){if(o.getActiveItem().config.leftPage.type!="sectionpage"){$(h[a-1].img).css("border","5px solid #"+settings.reader.buttonColour)}}}}else{b=($(c).width()/2)+15}$(c).css("border","5px solid #"+settings.reader.buttonColour)}else{if(k.returnOrientation()=="landscape"){if(o._mode=="double"){if(a%2==1){if(o.getActiveItem().landscapeimage.src.indexOf("resources/images/branding/next-section@2x.png")==-1){if(a+1<h.length){b=$(h[a-1].img).width()+10;$(h[a+1].img).css("border","5px solid #"+settings.reader.buttonColour)}}}else{if(a-1>0){if(o.getActiveItem().image.src.indexOf("resources/images/branding/previous-section@2x.png")==-1){$(h[a-1].img).css("border","5px solid #"+settings.reader.buttonColour)}}}}else{b=($(c).width()/2)+15}}else{b=($(c).width()/2)+15}$(c).css("border","5px solid #"+settings.reader.buttonColour)}var g=!!settings.RSSTicker?document.body.clientWidth:$(document).width();var f=p.element.dom.offsetLeft-(g/2)+b;if(l.scrollType=="senchaScroller"){var m=100;if(currentProfile=="phone"){m=250}setTimeout(function(){var q=l.getComponent("con").getScrollable().getScroller();var s=l.getComponent("con");var r=null;if(f<q.minPosition.x){f=q.minPosition.x}else{if(f>q.maxPosition.x){f=q.maxPosition.x}}q.scrollTo(f,0,{duration:100})},250)}else{if(f<0){f=0}else{if(f>l.contentArea.element.dom.scrollWidth){f=l.contentArea.element.dom.scrollWidth}}l.contentArea.element.dom.scrollLeft=f}}}}}},checkActivePageInToolbarBottom:function(k){var q=this;var l=q.getCarousel();if(l!=null){var g=l.getActiveItem();var a=g.getPageNo();var s=flatPlanData.pageGroups[a+pageOffset].pages[0].origPageNum-1;if((settings.reader.reverse!=null&&settings.reader.reverse=="true")){try{s=a}catch(o){}}if(g.xtype==="readeradvertpageviewer"){s=-1}var p=k.getItems().items;if(p[1]!=null){p=p[1].items.items;if(p[0]!=null){p=p[0].items.items;for(var m in p){var f=$(p[m].element.dom).find("img");if(f.length>0){var j=f[0];$(j).css("border","")}}if(p[s]!=null){var h=$(p[s].element.dom).find("img");var e=0;if(q.returnOrientation()=="landscape"){if(l._mode=="double"){if(s%2==1){if(s+1<p.length){var c=$(p[s+1].element.dom).find("img");if(c.length>0){var d=c[0];$(d).css("border","5px solid #"+settings.reader.buttonColour)}}}else{if(s-1>0){var c=$(p[s-1].element.dom).find("img");if(c.length>0){var d=c[0];$(d).css("border","5px solid #"+settings.reader.buttonColour);e+=$(d).width()+20}}}}}if(h.length>0){var r=h[0];$(r).css("border","5px solid #"+settings.reader.buttonColour);var b=p[s].element.dom.offsetLeft-e;var n=k.scrollerContainer.getScrollable().getScroller();setTimeout(function(){if(b>n.maxPosition.x){b=n.maxPosition.x}n.scrollTo(b,0,{duration:100})},200)}}}}}},returnAdvertOffset:function(c){var b=this;var d=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var e=settings.reader.interstitialPageFlow;var a=editionFlatplanData.pageGroups[c-1];if(a!=null&&a.pages[0]!=null){if(!isNaN(a.pages[0].advertsAdded)){d=a.pages[0].advertsAdded}}}return d},checkPagesBrowser:bannerAdClose:function(b){var c=this;var c=this;var e=c.getReaderView();b.hide();var a=if(currentProfile!="desktop"){setTimeout(function(){a()},1000)}else{a()}var d=c.getCarousel();var f=d.getActiveItem();if(f.startTiling!=null){f.startTiling();f.scroller.refresh()}if(settings.reader.bannerAd!=null){if(settings.reader.bannerAd.position=="top"){c.updateNavButtons();c.forcePageResizeOnHide()}c.swipesUntilNewBannerAd=settings.reader.bannerAd.swipeCount}},nextSection:function(){var a=this;var b=a.getCarousel();if(b!=null){b.next()}},previousSection:function(){var a=this;var b=a.getCarousel();if(b!=null){b.previous()}},trackOnEndPan:function(){var b=this;var a=b.getCarousel();if(b.trackPan!=null){b.trackPan(a.getActiveItem())}},returnPagePosition:function(c){var d=this;if(c!=null){var b=c.scroller;var a=(b.position.x/c.scale)-(c.initialTranslateX);var e=(b.position.y/c.scale);if(c.mode=="double"&&(c.config.leftPage==null||c.config.leftPage.type!="page")){a=a-c.width}return{x:a,y:e}}else{return null}},trackSwipeItemChange:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("pageSwipe")}},trackManualPageTurn:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("manualPageTurn")}},sectionScrollerInit:function(e){var g=this;var k=g.getCarousel();var d=k.getActiveItem();if(d!=null){var a=d.config.pageNo;a=editionFlatplanData.reversePageMapper[parseInt(a)+1];var c;var j=e.sectionArea.getItems().items;for(var f in j){var h=j[f].section;var b=j[parseInt(f)+1]!=null?j[parseInt(f)+1].section:null;if(b!=null&&a>=parseInt(h.pageNumber)&&a<parseInt(b.pageNumber)){j[f].setSelected(true);c=j[f];break}else{if((a>=parseInt(h.pageNumber)&&b==null)){j[f].setSelected(true);c=j[f];break}}}if(c!=null){e.scrollIntoCentre(c)}}},updateSectionScroller:function(){var c=this;if(settings.menu!=null&&settings.menu.sectionList!=null&&settings.menu.sectionList.useSectionScroller=="true"&&settings.bookmarks!=null&&settings.bookmarks.bookmark!=null&&settings.bookmarks.bookmark.length>0){var b=c.getSectionscroller();if(b!=null){var d=b.sectionArea.getItems().items;for(var a in d){if(d[a].selected){d[a].setSelected(false)}}c.sectionScrollerInit(b)}}},jumpToSection:function(c){var a=this;var b=a.getCarousel();b.jumpToPage(parseInt(c.pageNumber-1))},toggleCheckBox:function(c,b){var a=this;if(a.getCheckedStatus(c)){a.uncheckCheckBox(c)}else{a.checkCheckBox(c)}},checkCheckBox:function(a){a.labelCheckfield.addCls("showTick");a.labelCheckfield.removeCls("hideTick");a.labelCheckfield.check()},getCheckedStatus:function(a){return a.labelCheckfield.isChecked()},uncheckCheckBox:function(a){a.labelCheckfield.removeCls("showTick");a.labelCheckfield.addCls("hideTick");a.labelCheckfield.uncheck()},clearAdvertInterval:function(){var a=this;if(a.bannerAdInterval!=null){clearInterval(a.bannerAdInterval)}if(a.bannerTimeout!=null){clearTimeout(a.bannerTimeout)}},resumeAdvertInterval:function(){var b=this;var a=b.getBannerAd();if(a!=null){b.setupBannerAutoRefresh(a)}},hideWrapAd:function(a){var b=this;var d="0px";if(settings.wrapAd!=null&&settings.reader.enableReaderPadding=="true"){d="20px 150px"}var c=b.getCarousel();c.element.dom.style.padding=d;a.hide()},showWrapAd:function(a){var b=this;var d="";if(settings.wrapAd!=null&&settings.wrapAd.dualAdvert!=null){d=settings.wrapAd.dualAdvert}if(settings.wrapAd!=null&&settings.reader.enableReaderPadding=="true"){padding="20px 200px";if(d=="left"){padding="20px 0 20px 350px"}else{if(d=="right"){padding="20px 350px 20px 0"}}}else{if(settings.wrapAd!=null){padding="0px 200px";if(d=="left"){padding="0 0 0 350px"}else{if(d=="right"){padding="0 350px 0 0"}}}}var c=b.getCarousel();c.element.dom.style.padding=padding;a.show()},checkWrapperAds:function(){var h=this;if(typeof settings!="undefined"&&settings.wrapAd!=null){var a=h.getCarousel();var b=Ext.ComponentQuery.query("backgroundwrapaditem");if(h.wrapAdTimeout!=null){clearTimeout(h.wrapAdTimeout)}console.log(a.getActiveItem().getPageNo());var d=a.getActiveItem().getPageNo();var j=h.returnAdvertOffset(d+pageOffset);var c=d;var g=flatPlanData.pageGroups[c];var f=a.getActiveItem();if(currentProfile=="desktop"){if(g!=null&&g.pages[0]!=null&&g.pages[0].type=="advert"&&settings.wrapAd.hideOnAdvertPage=="true"){for(var e in b){var k=b[e];h.hideWrapAd(k)}h.hasHiddenWrapAds=true;f.resizeAdvert();return}else{if(settings.wrapAd.hideOnAdvertPage=="true"&&h.hasHiddenWrapAds){for(var e in b){var k=b[e];h.showWrapAd(k)}f.pageResize();h.hasHiddenWrapAds=false}}}h.wrapAdTimeout=setTimeout(function(){for(var l in b){var m=b[l];m.pageNo=editionFlatplanData.pageMapper[parseInt(a._pageNumber)+1];m.section=h.returnSection(m.pageNo);if(settings.wrapAd.refresh=="true"&&("refreshIntervalDuration" in settings.wrapAd===false||!!settings.wrapAd.refreshIntervalDuration===false)){m.refreshAdvert()}else{if(!m.advertInitialised){m.setupAdvert()}}if(a._pageNumber>0&&settings.wrapAd.hideLeftWrapperOnFirstPage=="true"&&m.side=="left"){if((settings.wrapAd.hideWrapperOnPortrait=="true"&&$(window).width()/$(window).height()>1.4)||settings.wrapAd.hideWrapperOnPortrait==null||settings.wrapAd.hideWrapperOnPortrait=="false"){m.addCls("showWrapper");m.removeCls("hideWrapper");if(!m.advertInitialised){m.setupAdvert()}}}else{if(a._pageNumber==0&&settings.wrapAd.hideLeftWrapperOnFirstPage=="true"&&m.side=="left"){m.removeCls("showWrapper");m.addCls("hideWrapper")}}}},500)}},bannerShown:function(b,a){var c=this;if(b.position!="top"&&b.canBeClosed!="true"){if(c.bottomBtn!=null&&currentProfile=="desktop"){c.bottomBtn.setStyle({transition:""});c.bottomBtn.setBottom(82)}if(a){c.forcePageResizeOnShow()}}else{if(b.position=="top"&&a){c.updateReaderAppearance(a);c.forcePageResizeOnShow()}}},bannerHidden:function(a,c){var b=this;if(a.position!="top"&&a.canBeClosed!="true"){if(b.bottomBtn!=null&&currentProfile=="desktop"){b.bottomBtn.setStyle({transition:"bottom 1s"});b.bottomBtn.setBottom(-28)}if(c){b.forcePageResizeOnHide()}}else{if(a.position=="top"&&c){b.updateReaderAppearance();b.forcePageResizeOnHide()}}},forcePageResizeOnHide:function(){var a=this;if(a.showBannerTimeout!=null){clearTimeout(a.showBannerTimeout)}var b=a.getCarousel();if(b._zoomMode=="fit"){a.hideBannerTimeout=setTimeout(function(){a.forceReRender(b);b.onResize()},1000)}else{a.hideBannerTimeout=setTimeout(function(){var c=b.getActiveItem();if(c!=null&&c.xtype=="readeradvertpageviewer"){c.loadAdvert()}else{a.forceReRender(b);if(!a.preventBannerCloseResize){}c.scroller.refresh();a.preventBannerCloseResize=false}},1000)}},forcePageResizeOnShow:function(){var a=this;if(a.hideBannerTimeout!=null){clearTimeout(a.hideBannerTimeout)}var b=a.getCarousel();if(b._zoomMode=="fit"){a.showBannerTimeout=setTimeout(1000)}else{var c=b.getActiveItem();a.showBannerTimeout=setTimeout(function(){try{a.forceReRender(b);b.onResize();if(!!c&&typeof c.manuallyUpdateScrollerSize=="function"){c.manuallyUpdateScrollerSize()}}catch(d){console.warn("[Error]: ",d)}},1000)}},forceReRender:updateReaderAppearance:function(a){var b=this;b.updateMenu();b.updateHelper();b.updateNavButtons(a)},updateNavButtons:function(a){var b=this;if(b.topBtn!=null&&currentProfile=="desktop"){if(!a){b.topBtn.setStyle({transition:"all 1s"})}else{b.topBtn.setStyle({transition:""})}var c=Ext.Viewport.query("readerbannerad");if(c.length==0||(c[0]!=null&&c[0].getHeight()==0)){b.topBtn.setTop(11);b.topBtn.setStyle({top:"11px"})}else{b.topBtn.setTop(122);b.topBtn.setStyle({top:"122px"})}}},updateMenu:function(){var a=this;if(currentProfile!="phone"){var b=a.getReadermenu();if(b!=null){b.checkTop()}}},updateHelper:function(){var b=this;if(currentProfile!="desktop"){var a=b.getReaderhelper();if(a!=null){a.setPadding()}}},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},settingsLoaded:function(){var a=this;a.bufferValue=typeof settings!="undefined"&&settings.page!=null&&settings.page.bufferCount!=null?settings.page.bufferCount:6},pauseAutoRefreshingAdverts:function(){var a=this;a.manageAutoRefreshingWrapperAdverts(a.statics().ADVERT.AUTO_REFRESH.ACTION.PAUSE);a.manageAutoRefreshingBannerAdvert(a.statics().ADVERT.AUTO_REFRESH.ACTION.PAUSE);a.manageInPageFlowAdvertsRefreshing(a.statics().ADVERT.AUTO_REFRESH.ACTION.PAUSE)},resumeAutoRefreshingAdverts:function(){var a=this;a.manageAutoRefreshingWrapperAdverts(a.statics().ADVERT.AUTO_REFRESH.ACTION.RESUME);a.manageAutoRefreshingBannerAdvert(a.statics().ADVERT.AUTO_REFRESH.ACTION.RESUME);a.manageInPageFlowAdvertsRefreshing(a.statics().ADVERT.AUTO_REFRESH.ACTION.RESUME)},manageAutoRefreshingWrapperAdverts:function(d){if(typeof d!="undefined"&&!!d){var c=this;var e=Ext.ComponentQuery.query("backgroundwrapaditem");var a=false;for(var b in e){switch(d){case c.statics().ADVERT.AUTO_REFRESH.ACTION.PAUSE:if(e[b].isCustomAd()){e[b].disableCustomAdRefresh()}else{e[b].pauseAutoRefresh()}break;case c.statics().ADVERT.AUTO_REFRESH.ACTION.RESUME:if(e[b].isCustomAd()){e[b].enableCustomAdRefresh()}else{e[b].resumeAutoRefresh()}break;default:a=true;break}if(a){break}}}},manageAutoRefreshingBannerAdvert:function(c){if(typeof c!="undefined"&&!!c){var b=this;var a=b.getBannerAd();if(typeof a!="undefined"&&!!a){switch(c){case b.statics().ADVERT.AUTO_REFRESH.ACTION.PAUSE:if(a.isCustomAd()){a.disableCustomAdRefresh()}else{a.pauseAutoRefresh()}break;case b.statics().ADVERT.AUTO_REFRESH.ACTION.RESUME:if(a.isCustomAd()){a.enableCustomAdRefresh()}else{a.resumeAutoRefresh()}break;default:break}}}},manageInPageFlowAdvertsRefreshing:function(e){if(typeof e!="undefined"&&!!e){var d=this;var c=Ext.ComponentQuery.query("readeradvertpageviewer");var a=false;for(var b in c){switch(e){case d.statics().ADVERT.AUTO_REFRESH.ACTION.PAUSE:if(c[b].isCustomAd()){c[b].disableCustomAdRefresh()}break;case d.statics().ADVERT.AUTO_REFRESH.ACTION.RESUME:if(c[b].isCustomAd()){c[b].enableCustomAdRefresh()}break;default:a=true;break}if(a){break}}}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderController"],0));(Ext.cmd.derive("InfinityMobile.controller.ArticleController",Ext.app.Controller,{config:{refs:{articlereader:"articlereader",articlereaderitemlrg:"articlereaderitemlrg",articlereaderitemsmall:"articlereaderitemsmall",articlereaderitemmedwide:"articlereaderitemmedwide",articlereaderitemmedtall:"articlereaderitemmedtall",articlereaderitemmedwidetall:"articlereaderitemmedwidetall",articlereaderitemtopstories:"articlereaderitemtopstories",articleview:"articleview",articlereadersectionbtn:"articlereadersectionbtn",articlereaderlivenewsbtn:"articlereaderlivenewsbtn",articlereadertopbarbtn:"articlereadertopbarbtn",articlereadertoggleviewoptions:"articlereadertoggleviewoptions",articlereadermenu:"articlereadermenu",articlescontainer:"articlescontainer",reader:"infinitecarousel2d",articlescontainer:"articlescontainer",articlereaderpanelcontainer:"articlereaderpanelcontainer",howtoarticlescontainer:"howtoarticlescontainer",howtoreader:"howtoreader",livenewsticker:"livenewsticker",layoutview:"layoutview",articlecarousel:"articlecarousel"},control:{articlereader:{initialized:"readerInitialize"},articlereaderitemlrg:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articlereaderitemsmall:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articlereaderitemmedwide:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articlereaderitemmedtall:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articlereaderitemmedwidetall:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articleview:{initializeArticlePopover:"initializeArticlePopover"},articlereaderitemtopstories:{tileTapped:"tileTapped"},articlereadersectionbtn:{loadSection:"loadSection"},articlereaderlivenewsbtn:{liveNewsTiles:"liveNewsTiles"},articlereadertopbarbtn:{toolbarMenu:"toolbarMenu",toggleReaderOptions:"toggleReaderOptions"},articlereadertoggleviewoptions:{replicaPaperView:"replicaPaperView",dynamicView:"dynamicView"},articleview:{initializeLivePopover:"initializeLivePopover",liveNext:"liveNext",livePrevious:"livePrevious"},livenewsticker:{liveNewsTickerArticle:"liveNewsTickerArticle"},readerpageviewer:{resizeArticlesBrowser:"resizeArticlesBrowser"},infinitecarousel2d:{resizeDynamicArticles:"resizeDynamicArticles"},infinitecarousel:{resizeDynamicArticles:"resizeDynamicArticles"},articlescontainer:{expandArticles:"expandArticles"},articlereaderitemphone:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},howtoarticlescontainer:{howToArticlesInit:"howToArticlesInit"},howtoreader:{howToReaderInit:"howToReaderInit"}}},init:function(){var b=this;articleMode="dynamic";b.articleStore=Ext.getStore("ArticleStore");b.articleStore.on({load:"setArticles",scope:this});var a=Ext.getStore("SettingStore");a.on({load:"setSections",scope:this});b.loaded=false},setArticles:function(){var a=this;a.setArticleStoreDictionary();a.articles=[];a.mediaStore=Ext.getStore("MediaStore");a.mediaStore.on({load:function(b){a.matchMediaToArticle(b)}})},setArticleStoreDictionary:function(a){var c=this;articleDictionary={};if(c.articleStore.data.items[0]!=null){c.articleStore.rawArticles=c.articleStore.data.items[0].raw.articles!=null?c.articleStore.data.items[0].raw.articles:c.articleStore.data.items[0].raw.popovers;if(c.articleStore.rawArticles!=null){for(var b=0;b<c.articleStore.rawArticles.length;b++){var d=c.articleStore.rawArticles[b];if(d.guid!=null){articleDictionary[d.guid]=d}else{articleDictionary[d.id]=d}}}}},matchMediaToArticle:function(){var b=this;var a=true;if(settings.newsday!=null){a=false}if(a){b.setUniqueArticles()}},setUniqueArticles:function(){var e=this;var a=e.mediaStore.data.items[0].raw.media.article;var d="";var c={};e.articleStore.uniqueArticles=[];for(var b=0;b<a.length;b++){var g=a[b];if(g.file!=""&&c[g.file]==null){c[g.file]="set";e.articleStore.uniqueArticles.push(g.file);if(settings.dynamic!=null){var f=$.extend(true,{},articleDictionary[g.file]);f.config={};f.config.articleIndex=a[b].uniquearticleindex;e.articles.push(f)}}}},setSections:function(a){var b=this;b.settings=a.data.items[0].raw;b.sections=[];if(a.data.items[0].raw.bookmarks!=null){b.sections=a.data.items[0].raw.bookmarks.bookmark}},sortSections:function(){var a=this},getArticles:getSectionsWithArticles:getSections:function(){var e=this;var h=[];var c=Ext.getStore("MediaStore");var d=c.media.uniquearticle;for(var b=0;b<e.sections.length;b++){var g=e.sections[b];g.articles=[];for(var a=0;a<d.length;a++){var f=d[a];if(e.sections[b+1]!=null){if(parseFloat(e.sections[b].pageNumber)<=parseFloat(f.page)&&parseFloat(e.sections[b+1].pageNumber)>parseFloat(f.page)){g.articles.push(f)}}else{if(parseFloat(e.sections[b].pageNumber)<=parseFloat(f.page)){g.articles.push(f)}}}h.push(g)}return h},findArticle:readerInitialize:function(c,b){var a=this;if(currentProfile=="phone"){a.articleReaderLoadPhone(c,b)}else{a.articleReaderLoad(c,b)}},articleReaderLoadPhone:function(k,m){var y=this;articleMode="dynamic";if(y.getArticlescontainer()!=null){y.getArticlescontainer().destroy()}k.content.removeAll();var s=k.content;var w;var d=true;if(m!=1){var q=Ext.create("InfinityMobile.view.ArticleReaderTopBarBtn",{imageUrl:"../assets/dynamicarticles/dynamic-mode-ic-white@2x.png",left:0,width:60,height:25,top:8,type:"btn",action:"toggleReaderOptions",tooltipText:"Toggle View"});var c=Ext.create("InfinityMobile.view.ArticleReaderTopBarBtn",{imageUrl:y.settings.topbar.logo,left:60,width:120,height:32,top:4,type:"logo"});k.toolBar.add(c);k.toolBar.add(q);y.loadSectionButtons(k)}for(var o=0;o<y.articles.length;o++){y.articles[o].sections=[];for(var t=0;t<y.sections.length;t++){if(y.articles[o].pageNumber>=y.sections[t].page){y.articles[o].sections[0]=y.sections[t].name.toUpperCase()}}}if(y.sections[0]!=null&&settings.dynamic.enableAllArticles!="true"){y.firstSection=y.sections[0].name.toUpperCase();y.loadSection(y.sections[0].name.toUpperCase());setTimeout(function(){k.loadReaderPhone()},800)}else{y.firstSection=language.dynamicArticles.all;var d=true;var s=y.articleReader.content;var w;var r;var t=0;if(y.settings.dynamic.weather==null){}else{if(y.settings.dynamic.weather.url.length>0){var l=Ext.create("InfinityMobile.view.phone.ArticleReaderItemTopStories",{expandAnim:"expandTopStory 0.2s forwards",shrinkAnim:"shrinkTopStory 0.2s ease-out",articles:[]});y.articleReader.content.add(l)}}var a=y.articles;while(t<a.length){if(d){r=Ext.create("InfinityMobile.view.phone.ArticleReaderPanelContainer");var w=Ext.create("InfinityMobile.view.phone.ArticleReaderItemContainer");if(a.length>(t)){var v=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[t],articleIndex:t});w.add(v)}if(a.length>(t+1)){var p=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:50%;",article:a[t+1],articleIndex:t+1});w.add(p)}if(a.length>(t+2)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:0px;",article:a[t+2],articleIndex:t+2});w.add(n)}if(a.length>(t+3)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:50%;",article:a[t+3],articleIndex:t+3});w.add(n)}if(a.length>(t+4)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:0px;",article:a[t+4],articleIndex:t+4});w.add(n)}if(a.length>(t+5)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:50%;",article:a[t+5],articleIndex:t+5});w.add(n)}t+=6;if(t<a.length){d=false;r.add(w);if(y.settings.dynamic.adverts!=null){if(y.settings.dynamic.adverts.bannerAd!=null){var b=Ext.create("InfinityMobile.view.phone.ArticleReaderBannerAd",{style:"height:200px;width:100%;"});r.add(b)}}}else{r.add(w);var f=w.items.length;if(f%2==1){f+=1}var u=f*100;r.element.dom.style.height=u+"px"}}else{var w=Ext.create("InfinityMobile.view.phone.ArticleReaderItemContainer");if(a.length>(t)){var v=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[t],articleIndex:t});w.add(v)}if(a.length>(t+1)){var p=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:50%;",article:a[t+1],articleIndex:t+1});w.add(p)}if(a.length>(t+2)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:0px;",article:a[t+2],articleIndex:t+2});w.add(n)}if(a.length>(t+3)){var j=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:50%;",article:a[t+3],articleIndex:t+3});w.add(j)}if(a.length>(t+4)){var g=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:0px;",article:a[t+4],articleIndex:t+4});w.add(g)}if(a.length>(t+5)){var e=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:50%;",article:a[t+5],articleIndex:t+5});w.add(e)}t+=6;d=true;r.add(w);if(t>=a.length){var f=w.items.length;if(f%2==1){f+=1}var u=f*100;if(y.settings.dynamic.adverts!=null){if(y.settings.dynamic.adverts.bannerAd!=null){u+=650}else{u+=600}}else{u+=600}r.element.dom.style.height=u+"px"}}if(d){y.articleReader.content.add(r);if(y.articleReader.content.getScrollable()!=null){y.articleReader.content.getScrollable().getScroller().scrollTo(0,0)}else{y.articleReader.scollDesktop.scrollLeft=0}}}}},articleReaderLoad:function(l,p){var G=this;articleMode="dynamic";if(G.getArticlescontainer()!=null){G.getArticlescontainer().destroy()}l.content.removeAll();var A=true;var z=l.content;var E;if(p!=1){var u=Ext.create("InfinityMobile.view.ArticleReaderTopBarBtn",{imageUrl:"../assets/dynamicarticles/dynamic-mode-ic-white@2x.png",left:0,width:60,height:25,top:8,type:"btn",action:"toggleReaderOptions",tooltipText:"Toggle View"});var c=Ext.create("InfinityMobile.view.ArticleReaderTopBarBtn",{imageUrl:G.settings.topbar.logo,left:60,width:120,height:32,top:4,type:"logo"});l.toolBar.add(c);l.toolBar.add(u);G.loadLiveNews(l);G.loadSectionButtons(l)}for(var r=0;r<G.articles.length;r++){G.articles[r].sections=[];for(var C=0;C<G.sections.length;C++){if(G.articles[r].pageNumber>=G.sections[C].page){G.articles[r].sections[0]=G.sections[C].name.toUpperCase()}}}if($(document).height()>768&&(currentProfile=="desktop"||currentProfile=="largetablet")){G.tileMode="large";G.currentSection=language.dynamicArticles.all;var v;var C=0;while(C<G.articles.length){if(currentProfile=="desktop"||currentProfile=="largetablet"){if(A){v=Ext.create("InfinityMobile.view.desktop.ArticleReaderPanelContainer");E=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(G.articles.length>(C)){if(C!=0||(G.getSectionsWithArticles()<2&&G.settings.dynamic.weather==null)){var m=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemLrg",{expandAnim:"expandTopStory 0.2s ease-in",shrinkAnim:"shrinkTopStory 0.2s ease-out",style:"position:absolute;top:0px;left;0px;",article:G.articles[C],articleIndex:C});E.add(m)}else{if(G.getSectionsWithArticles()<2&&(G.settings.dynamic.weather==null||G.settings.dynamic.weather.url.length==0)){var m=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemLrg",{expandAnim:"expandTopStory 0.2s ease-in",shrinkAnim:"shrinkTopStory 0.2s ease-out",style:"position:absolute;top:0px;left;0px;",article:G.articles[C],articleIndex:C});E.add(m)}else{var b=[];C-=1;for(var r=0;r<G.sections.length;r++){var e=G.sections[r];var H=G.sections[r+1];for(var o=0;o<G.articles.length;o++){var f=G.articles[o];if(H!=null){if(e.pageNumber<=f.pageNumber&&H.pageNumber>f.pageNumber){b[b.length]=f;break}}else{if(G.sections[r].pageNumber<=G.articles[o].pageNumber){b[b.length]=f;break}}}}if(b.length==0){b[0]=G.articles[0];C+=1}var m=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemTopStories",{expandAnim:"expandTopStory 0.2s forwards",shrinkAnim:"shrinkTopStory 0.2s ease-out",style:"position:absolute;top:0px;left;0px;",articles:b});E.add(m)}}}if(G.articles.length>(C+1)){if(G.settings.dynamic.adverts!=null){if(G.settings.dynamic.adverts.bannerAd!=null){var q=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:G.articles[C+1],articleIndex:C+1})}else{var q=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:G.articles[C+1],articleIndex:C+1})}E.add(q)}else{var q=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:G.articles[C+1],articleIndex:C+1});E.add(q)}}if(G.articles.length>(C+2)){if(G.settings.dynamic.adverts!=null){if(G.settings.dynamic.adverts.bannerAd!=null){var n=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col2LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:G.articles[C+2],articleIndex:C+2})}else{var n=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col2LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:G.articles[C+2],articleIndex:C+2})}E.add(n)}else{var n=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col2LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:G.articles[C+2],articleIndex:C+2});E.add(n)}}if(G.articles.length>(C+3)){if(G.settings.dynamic.adverts!=null){if(G.settings.dynamic.adverts.bannerAd!=null){var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col3LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:G.articles[C+3],articleIndex:C+3})}else{var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col3LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:G.articles[C+3],articleIndex:C+3})}E.add(k)}else{var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col3LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:G.articles[C+3],articleIndex:C+3});E.add(k)}}if(G.articles.length>=(C+4)){if(G.settings.dynamic.adverts!=null){if(G.settings.dynamic.adverts.bannerAd!=null){var a=Ext.create("InfinityMobile.view.desktop.ArticleReaderBannerAd",{style:"position:absolute;top:90%;height:100%;width:100%;",height:"15%",settings:G.settings.dynamic.adverts.bannerAd});E.add(a)}}}C+=4;if(C<G.articles.length){A=false;v.add(E)}else{v.add(E);$(v.element.dom).css("width","768px")}}else{E=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(G.articles.length>C){var t=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow1Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow1Col1Right 0.2s ease-out",style:"position:absolute;top:0px;left:0px;",article:G.articles[C],articleIndex:C});E.add(t)}if(G.articles.length>(C+1)){var q=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedWide",{expandAnim:"expandRow1Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow1Col2Right 0.2s ease-out",style:"position:absolute;top:0px;left:256px;",article:G.articles[C+1],articleIndex:C+1});E.add(q)}if(G.articles.length>(C+2)){var n=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col1Right 0.2s ease-out",style:"position:absolute;top:30%;left:0px;",article:G.articles[C+2],articleIndex:C+2});E.add(n)}if(G.articles.length>(C+3)){var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col2Right 0.2s ease-out",style:"position:absolute;top:30%;left:256px;",article:G.articles[C+3],articleIndex:C+3});E.add(k)}if(G.articles.length>(C+4)){var j=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col3Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col3Right 0.2s ease-out",style:"position:absolute;top:30%;left:512px;",article:G.articles[C+4],articleIndex:C+4});E.add(j)}if(G.articles.length>(C+5)){var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow3Col1Right 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:G.articles[C+5],articleIndex:C+5});E.add(g)}if(G.articles.length>(C+6)){var d=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedWideTall",{expandAnim:"expandRow3Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow3Col2Right 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:G.articles[C+6],articleIndex:C+6});E.add(d)}v.add(E);C+=7;A=true}}if(A){var w;var B;var F;if(G.settings.dynamic.adverts!=null){if(G.settings.dynamic.adverts.interstitial!=null&&C<G.articles.length){var D=$(document).height()-120;var s=D*0.8;var w=((s*0.3)*2)+(s*0.45)-10;B=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitialContainer");F=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitial",{adHeight:w,settings:G.settings.dynamic.adverts.interstitial})}}l.content.add(v);if(F!=null&&B!=null){B.add(F);l.content.add(B)}}else{}}}else{G.tileMode="small";G.currentSection=language.dynamicArticles.all;G.buildTilesSmall(G.articles,language.dynamicArticles.all)}if(currentProfile=="desktop"){if(Ext.browser.is.IE){setTimeout(function(){var h=0;var x=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(v in x){h+=$(x[v].element.dom).width()+10}var y=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(interstitial in y){h+=$(y[interstitial].element.dom).width()+5}if(settings.dynamic.rss==null){G.articleReader.content.element.down(".x-container").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}else{G.articleReader.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}},100)}G.dynamicKeyControls(l)}},dynamicKeyControls:function(b){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.articleViewOnly=="true"){}else{window.onkeydown=function(c){if(currentProfile=="desktop"&&!Ext.browser.is.IE){if(c.keyCode==39&&b!=null){if(b.scrollDesktop.scrollLeft+120<b.scrollDesktop.scrollWidth){b.scrollDesktop.scrollLeft=b.scrollDesktop.scrollLeft+120}else{b.scrollDesktop.scrollLeft=b.scrollDesktop.scrollWidth}}else{if(c.keyCode==37&&b!=null){if(b.scrollDesktop.scrollLeft-120>0){b.scrollDesktop.scrollLeft=b.scrollDesktop.scrollLeft-120}else{b.scrollDesktop.scrollLeft=0}}}}else{if(c.keyCode==39){if(b.content.getScrollable().getScroller().position.x+120<b.content.getScrollable().getScroller().maxPosition.x){b.content.getScrollable().getScroller().scrollTo(b.content.getScrollable().getScroller().position.x+120)}else{b.content.getScrollable().getScroller().scrollTo(b.content.getScrollable().getScroller().maxPosition.x)}}else{if(c.keyCode==37){if(b.content.getScrollable().getScroller().position.x-120>0){b.content.getScrollable().getScroller().scrollTo(b.content.getScrollable().getScroller().position.x-120)}else{b.content.getScrollable().getScroller().scrollTo(0)}}}}};window.onkeyup=""}},loadLiveNews:loadSectionButtons:function(k){var m=this;m.articleReader=k;if(!m.loaded){var j=this;var p=Ext.create("Ext.Container",{docked:"top",height:40,padding:5,width:"100%",style:"border-bottom: 1px solid #929292;text-align:center;"});if(currentProfile=="desktop"){var a=Ext.create("Ext.Container",{height:40,scrollable:{direction:"horizontal",indicators:false,directionLock:true},layout:{type:"hbox",pack:"middle"}})}else{var a=Ext.create("Ext.Container",{scrollable:{direction:"horizontal",indicators:false,directionLock:true},height:40,layout:{type:"hbox"}})}m.buttons=[];if(settings.dynamic.rss!=null){if(settings.dynamic.rss.url!=null){if(settings.dynamic.rss.url.length>0){var f=Ext.create("InfinityMobile.view.ArticleReaderLiveNewsBtn",{width:125,height:40,section:language.dynamicArticles.liveNews});if(a!=null){a.add(f);m.buttons[m.buttons.length]=f}}}}if(currentProfile!="phone"||settings.dynamic.enableAllArticles=="true"){var g=Ext.create("InfinityMobile.view.ArticleReaderSectionBtn",{section:language.dynamicArticles.all,width:60,height:40});a.add(g);m.buttons[m.buttons.length]=g}else{if(m.sections.length==0){var g=Ext.create("InfinityMobile.view.ArticleReaderSectionBtn",{section:language.dynamicArticles.all,width:60,height:40});a.add(g);m.buttons[m.buttons.length]=g}}for(var h=0;h<m.sections.length;h++){var n=false;for(var o=0;o<m.articles.length;o++){if(m.sections[h+1]!=null){if(parseFloat(m.sections[h].pageNumber)<=parseFloat(m.articles[o].pageNumber)&&parseFloat(m.sections[h+1].pageNumber)>parseFloat(m.articles[o].pageNumber)){n=true;break}}else{if(parseFloat(m.sections[h].pageNumber)<=parseFloat(m.articles[o].pageNumber)){n=true;break}}}if(m.sections[h].name.length==0){n=false}if(n){var e=document.createElement("canvas");var l=e.getContext("2d");l.font="14px Arial";var b=l.measureText(m.sections[h].name.toUpperCase()).width*1.2;var d=Ext.create("InfinityMobile.view.ArticleReaderSectionBtn",{section:m.sections[h].name.toUpperCase(),width:b,height:40});a.add(d);m.buttons[m.buttons.length]=d}}p.add(a);k.content.add(p);m.loaded=true}},liveNewsTiles:function(){var a=this;if(a.settings.dynamic.rss!=null){if(a.settings.dynamic.rss.url!=null){a.currentSection=language.dynamicArticles.liveNews;$.ajax({url:"../../rssWrapper.aspx?base64url="+encodeURIComponent(btoa(a.settings.dynamic.rss.url)),dataType:"json",success:function(d){if(d.feed&&d.feed.entries){var c=[];$.each(d.feed.entries,function(f,g){c.push(g)});a.articleReader.content.removeAll();for(var b=0;b<a.buttons.length;b++){if(a.buttons[b].section==language.dynamicArticles.liveNews){a.buttons[b].element.down("span").dom.style.color="#b22930"}else{a.buttons[b].element.dom.style.color="#929292"}}if(currentProfile=="phone"){a.buildTilesPhone(c,language.dynamicArticles.liveNews)}else{if($(document).height()>768&&(currentProfile=="desktop"||currentProfile=="largetablet")){a.buildTiles(c,language.dynamicArticles.liveNews)}else{a.buildTilesSmall(c,language.dynamicArticles.liveNews)}}}}})}}},buildTilesSmall:function(a,d){var t=this;if(d==language.dynamicArticles.liveNews){var g={};for(var o=0;o<a.length;o++){a[o].sections=[];a[o].sections[0]=d;a[o].headline=a[o].title;a[o].body=a[o].content;a[o].subHeadline="";a[o].byline=a[o].author;if(a[o].images!=null){}else{if(a[o].mediaGroups!=null){if(a[o].mediaGroups[0].contents!=null){if(a[o].mediaGroups[0].contents[0].thumbnails!=null){var e=[{url:a[o].mediaGroups[0].contents[0].thumbnails[0].url}];a[o].images=e;a[o].images[0].url="image_resize.aspx?w=700&url="+a[o].images[0].url}else{if(a[o].mediaGroups[0].contents[0].url!=null){var e=[{url:a[o].mediaGroups[0].contents[0].url}];a[o].images=e;a[o].images[0].url="image_resize.aspx?w=700&url="+a[o].images[0].url}else{a[o].images=[]}}}else{a[o].images=[]}}else{a[o].images=[]}}a[o].live=true;a[o].url=a[o].link;a[o].config={};a[o].config.articleIndex=o}t.liveArticles=a}var m=true;var l=t.articleReader.content;var r;var j;var o=0;while(o<a.length){if(currentProfile=="desktop"||currentProfile=="largetablet"||currentProfile=="tablet"){if(m){j=Ext.create("InfinityMobile.view.desktop.ArticleReaderPanelContainer");r=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(settings.dynamic.weather!=null&&o==0&&d==language.dynamicArticles.all){if(settings.dynamic.weather.url!=null){if(settings.dynamic.weather.url.length>0){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWeatherContainer",{expandAnim:"expandSmallViewTopLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopLeft 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",weather:settings.dynamic.weather.url});r.add(q);o--}else{if(a.length>o){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWide",{expandAnim:"expandSmallViewTopLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopLeft 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[o],articleIndex:o,bannerAdCheck:"true"});r.add(q)}}}else{if(a.length>o){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWide",{expandAnim:"expandSmallViewTopLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopLeft 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[o],articleIndex:o,bannerAdCheck:"true"});r.add(q)}}}else{if(a.length>o){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWide",{expandAnim:"expandSmallViewTopLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopLeft 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[o],articleIndex:o,bannerAdCheck:"true"});r.add(q)}}if(a.length>(o+1)){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewTopRight 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopRight 0.2s ease-out",style:"position:absolute;top:0%;left:512px;",article:a[o+1],articleIndex:o+1,bannerAdCheck:"true"});r.add(q)}var c=true;if(settings.dynamic.adverts!=null){if(settings.dynamic.adverts.bannerAd!=null){var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderBannerAd",{style:"position:absolute;top:72.5%;height:100%;width:100%;",height:"32.5%",settings:settings.dynamic.adverts.bannerAd});r.add(b);c=false;o-=2}}if(c){if(a.length>(o+2)){if(a[o+2]!=null){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileMed",{expandAnim:"expandSmallViewBottomLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewBottomLeft 0.2s ease-out",style:"position:absolute;top:52.5%;left:0px;",article:a[o+2],articleIndex:o+2});r.add(q)}}if(a.length>(o+3)){if(a[o+3]!=null){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileMed",{expandAnim:"expandSmallViewBottomRight 0.2s ease-in",shrinkAnim:"shrinkSmallViewBottomRight 0.2s ease-out",style:"position:absolute;top:52.5%;left:384px;",article:a[o+3],articleIndex:o+3});r.add(q)}}}o+=4;if(o<a.length){m=false;j.add(r)}else{j.add(r);$(j.element.dom).css("width","768px")}}else{r=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(a.length>o){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewTop1 0.2s ease-in",shrinkAnim:"shrinkSmallViewTop1 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[o],articleIndex:o});r.add(q)}if(a.length>o+1){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewTop2 0.2s ease-in",shrinkAnim:"shrinkSmallViewTop2 0.2s ease-out",style:"position:absolute;top:0%;left:256px;",article:a[o+1],articleIndex:o+1});r.add(q)}if(a.length>o+2){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewTopRight 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopRight 0.2s ease-out",style:"position:absolute;top:0%;left:512px;",article:a[o+2],articleIndex:o+2});r.add(q)}if(a.length>o+3){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewBottom1 0.2s ease-in",shrinkAnim:"shrinkSmallViewBottom1 0.2s ease-out",style:"position:absolute;top:52.5%;left:0px;",article:a[o+3],articleIndex:o+3});r.add(q)}if(a.length>o+4){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWide",{expandAnim:"expandSmallViewBottom2 0.2s ease-in",shrinkAnim:"shrinkSmallViewBottom2 0.2s ease-out",style:"position:absolute;top:52.5%;left:256px;",article:a[o+4],articleIndex:o+4});r.add(q)}j.add(r);o+=5;m=true}}if(m){var n;var s;if(t.settings.dynamic.adverts!=null){if(t.settings.dynamic.adverts.interstitial!=null&&o<a.length){var p=$(document).height()-120;var f=p*0.8;var k=((f*0.3)*2)+(f*0.45)-10;n=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitialContainer");s=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitial",{adHeight:k,settings:t.settings.dynamic.adverts.interstitial})}}t.articleReader.content.add(j);if(s!=null&&n!=null){n.add(s);t.articleReader.content.add(n)}}else{}if(currentProfile=="desktop"){if(Ext.browser.is.IE){setTimeout(function(){var h=0;var u=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(j in u){h+=$(u[j].element.dom).width()+10}var v=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(interstitial in v){h+=$(v[interstitial].element.dom).width()+5}if(settings.dynamic.rss==null){t.articleReader.content.element.down(".x-container").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}else{t.articleReader.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}},100)}if(t.articleReader.scrollDesktop!=null){t.articleReader.scrollDesktop.scrollLeft=0}}else{if(t.articleReader.content.getScrollable()!=null){t.articleReader.content.getScrollable().getScroller().scrollTo(0)}}}},buildTilesPhone:buildTiles:function(a,d){var z=this;if(d==language.dynamicArticles.liveNews){var p={};for(var v=0;v<a.length;v++){a[v].sections=[];a[v].sections[0]=d;a[v].headline=a[v].title;a[v].body=a[v].content;a[v].subHeadline="";a[v].byline=a[v].author;if(a[v].images!=null){}else{if(a[v].mediaGroups!=null){if(a[v].mediaGroups[0].contents!=null){if(a[v].mediaGroups[0].contents[0].thumbnails!=null){var n=[{url:a[v].mediaGroups[0].contents[0].thumbnails[0].url}];a[v].images=n;a[v].images[0].url="image_resize.aspx?w=700&url="+a[v].images[0].url}else{if(a[v].mediaGroups[0].contents[0].url!=null){var n=[{url:a[v].mediaGroups[0].contents[0].url}];a[v].images=n;a[v].images[0].url="image_resize.aspx?w=700&url="+a[v].images[0].url}else{a[v].images=[]}}}else{a[v].images=[]}}else{a[v].images=[]}}a[v].live=true;a[v].url=a[v].link;a[v].config={};a[v].config.articleIndex=v}z.liveArticles=a}var t=true;var s=z.articleReader.content;var x;var q;var v=0;while(v<a.length){if(currentProfile=="desktop"||currentProfile=="largetablet"||currentProfile=="tablet"){if(t){q=Ext.create("InfinityMobile.view.desktop.ArticleReaderPanelContainer");x=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(a.length>(v)){var j=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemLrg",{expandAnim:"expandTopStory 0.2s ease-in",shrinkAnim:"shrinkTopStory 0.2s ease-out",style:"position:absolute;top:0px;left;0px;",article:a[v],articleIndex:v});x.add(j)}if(a.length>(v+1)){if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.bannerAd!=null){var l=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:a[v+1],articleIndex:v+1})}else{var l=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:a[v+1],articleIndex:v+1})}x.add(l)}else{var l=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:a[v+1],articleIndex:v+1});x.add(l)}}if(a.length>(v+2)){if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.bannerAd!=null){var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col2LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:a[v+2],articleIndex:v+2})}else{var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col2LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:a[v+2],articleIndex:v+2})}x.add(k)}else{var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col2LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:a[v+2],articleIndex:v+2});x.add(k)}}if(a.length>(v+3)){if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.bannerAd!=null){var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col3LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:a[v+3],articleIndex:v+3})}else{var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col3LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:a[v+3],articleIndex:v+3})}x.add(g)}else{var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col3LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:a[v+3],articleIndex:v+3});x.add(g)}}if(a.length>(v+4)){if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.bannerAd!=null){var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderBannerAd",{height:"15%",style:"position:absolute;top:90%;height:100%;width:100%;",settings:z.settings.dynamic.adverts.bannerAd});x.add(b)}}}v+=4;if(v<a.length){t=false;q.add(x)}else{q.add(x);$(q.element.dom).css("width","768px")}}else{x=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(a.length>v){var o=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow1Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow1Col1Right 0.2s ease-out",style:"position:absolute;top:0px;left:0px;",article:a[v],articleIndex:v});x.add(o)}if(a.length>(v+1)){var l=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedWide",{expandAnim:"expandRow1Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow1Col2Right 0.2s ease-out",style:"position:absolute;top:0px;left:256px;",article:a[v+1],articleIndex:v+1});x.add(l)}if(a.length>(v+2)){var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col1Right 0.2s ease-out",style:"position:absolute;top:30%;left:0px;",article:a[v+2],articleIndex:v+2});x.add(k)}if(a.length>(v+3)){var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col2Right 0.2s ease-out",style:"position:absolute;top:30%;left:256px;",article:a[v+3],articleIndex:v+3});x.add(g)}if(a.length>(v+4)){var f=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col3Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col3Right 0.2s ease-out",style:"position:absolute;top:30%;left:512px;",article:a[v+4],articleIndex:v+4});x.add(f)}if(a.length>(v+5)){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow3Col1Right 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:a[v+5],articleIndex:v+5});x.add(e)}if(a.length>(v+6)){var c=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedWideTall",{expandAnim:"expandRow3Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow3Col2Right 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:a[v+6],articleIndex:v+6});x.add(c)}q.add(x);v+=7;t=true}}if(t){var u;var y;if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.interstitial!=null&&v<a.length){var w=$(document).height()-120;var m=w*0.8;var r=((m*0.3)*2)+(m*0.45)-10;u=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitialContainer");y=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitial",{adHeight:r,settings:z.settings.dynamic.adverts.interstitial})}}z.articleReader.content.add(q);if(y!=null&&u!=null){u.add(y);z.articleReader.content.add(u)}}else{}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(Ext.browser.is.IE){setTimeout(100)}z.articleReader.scrollDesktop.scrollLeft=0}else{z.articleReader.content.getScrollable().getScroller().scrollTo(0)}}},loadSection:function(g){var f=this;var b=true;f.currentSection=g;var c="";switch(g){case language.dynamicArticles.all:if(currentProfile=="phone"){f.articleReaderLoadPhone(f.articleReader,1)}else{f.articleReaderLoad(f.articleReader,1)}if(f.articleReader.content.getScrollable()!=null){f.articleReader.content.getScrollable().getScroller().scrollTo(0,0)}b=false;for(var a=0;a<f.buttons.length;a++){if(f.buttons[a].section==language.dynamicArticles.all){f.buttons[a].element.dom.style.color="#b22930"}else{if(f.buttons[a].section==language.dynamicArticles.liveNews){f.buttons[a].element.down("span").dom.style.color="#929292"}else{f.buttons[a].element.dom.style.color="#929292"}}}break}if(b){var e=[];for(var d=0;d<f.articles.length;d++){for(var a=0;a<f.articles[d].sections.length;a++){if(f.articles[d].sections[a]==g){e[e.length]=f.articles[d];break}}}for(var a=0;a<f.buttons.length;a++){if(f.buttons[a].section==g){f.buttons[a].element.dom.style.color="#b22930"}else{if(f.buttons[a].section==language.dynamicArticles.liveNews){f.buttons[a].element.down("span").dom.style.color="#929292"}else{f.buttons[a].element.dom.style.color="#929292"}}}f.articleReader.content.removeAll();if(e.length>0){f.displayedArticles=e;if(currentProfile=="phone"){f.buildTilesPhone(e,g)}else{if($(document).height()>768&&(currentProfile=="desktop"||currentProfile=="largetablet")){f.buildTiles(e,c)}else{f.buildTilesSmall(e,c)}}}else{f.noTiles(g)}}},noTiles:function(b){var a=this},showArticlePopover:initializeArticlePopover:tileTapped:toolbarMenu:toggleReaderOptions:replicaPaperView:function(j){var g=this;articleMode="replica";g.loaded=false;g.getArticlereadertoggleviewoptions().destroy();var c=g.articleReader.config.orientation;g.articleReader.destroy();g.articleReader=null;mainPanel.setActiveItem(0);if(g.getLivenewsticker()!=null){g.getLivenewsticker().show();g.getLivenewsticker().loadTicker()}var a=g.getReader();a.fireEvent("pagechange",a);if(currentProfile=="desktop"){g.getReader().onResize()}else{if(g.returnOrientation()!=c){g.getReader().onResize()}}g.getApplication().getController("PageTurnController").setupKeys();if(g.articles.length>0){var e=Ext.getStore("SettingStore");var b=0;if(e.data.items[0].raw.RSSTicker!=null){b=40}var h=[];if(e.data.items[0].raw.bookmarks!=null){h=e.data.items[0].raw.bookmarks.bookmark}if(currentProfile=="desktop"){var f=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){f=false}}if(f){var d=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle"})}else{var d=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle"})}}else{var d=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle"})}Ext.Viewport.add(d);d.show()}else{if(currentProfile=="desktop"){var f=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){f=false}}if(f){var d=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle",bottom:b})}else{var d=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle",bottom:b})}}else{var d=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle",bottom:b})}Ext.Viewport.add(d);d.show()}},dynamicView:function(a){var b=this;if(b.articleReader!=null){if(currentProfile=="phone"){b.articleReaderLoadPhone(b.articleReader,1)}else{b.articleReaderLoad(b.articleReader,1)}}else{var c="InfinityMobile.view.ArticleReader";var d=Ext.create(c,{orientation:b.returnOrientation()});mainPanel.add(d);mainPanel.setActiveItem(d)}if(a!=null){a.hide()}},readerarticlehide:function(){var a=this;a.dynamicKeyControls(a.articleReader)},liveArticleClick:function(f,c){var g=this;var g=this;var j=g.getArticleview();if(j!=null){j.destroy()}var b=f.config.articleIndex;var e=5;var h="InfinityMobile.view.tablet.ReaderArticlePopover";switch(currentProfile){case"phone":h="InfinityMobile.view.phone.ReaderArticlePopover";break;case"tablet":h="InfinityMobile.view.tablet.ReaderArticlePopover";break;case"desktop":h="InfinityMobile.view.desktop.ReaderArticlePopover";break;default:h="InfinityMobile.view.tablet.ReaderArticlePopover";break}if(c.length==null){var f=Ext.create(h,{mediaController:g,isLive:"true",articleIndex:b})}else{var f=Ext.create(h,{mediaController:g,isLive:"true",articleIndex:b,articles:c})}if(currentProfile!="desktop"){if(articleMode=="dynamic"){mainPanel.add(f);mainPanel.setActiveItem(f)}else{mainPanel.add(f);mainPanel.setActiveItem(f)}}var a="Article";if(language.article!=null){a=language.article}var d=f.articleText.getHtml().replace("Article",a);f.articleText.setHtml(d)},initializeLivePopover:function(d,c){var e=this;var b=d.content;if(c.length==null){var f=e.liveArticles}else{var f=c}var a=d.config.articleIndex;e.articleCarousel=Ext.create("InfinityMobile.view.ArticleCarousel",{width:"100%",height:"100%",pageNumber:a,data:f,pageTemplate:function(j,k,h){if(currentProfile=="desktop"){return Ext.create("InfinityMobile.view.desktop.ReaderLiveArticlePopoverItem",{pageNo:k,page:h[k],highlightMode:d.highlightMode,readAloudMode:d.readAloudMode})}else{return Ext.create("InfinityMobile.view.ReaderLiveArticlePopoverItem",{pageNo:k,page:h[k],highlightMode:d.highlightMode,readAloudMode:d.readAloudMode})}}});b.add(e.articleCarousel);var g=f[a];d.articleText.setHtml("Article "+((a)+1)+" / "+f.length);if(currentProfile!="phone"){e.getApplication().getController("ArticlePopoverController").articleLoadShare(d,g)}if(trackOmniture=="True"){trackArticle(g.page,g.description)}e.articleKeyControl();e.articleCarousel.on({hide:function(){e.dynamicKeyControls()}})},liveNext:function(a){var b=this;var c=b.getArticlecarousel();if(c!=null){c.next()}},livePrevious:function(a){var b=this;var c=b.getArticlecarousel();if(c!=null){c.previous()}},articleKeyControl:function(){var b=this;var a=b.getArticlecarousel();window.onkeyup=function(c){if($("#slider").val()==1){if(c.keyCode==39){a.next(0)}else{if(c.keyCode==37){a.previous()}}}};window.onkeydown=,liveNewsTickerArticle:resizeArticlesBrowser:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().resizeOb()}},resizeDynamicArticles:function(){var c=this;var d=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(container in d){if(d[container].onResize!=null){d[container].onResize()}}if(currentProfile!="phone"){var d=Ext.ComponentQuery.query(".articlereaderpanelcontainer");if(d.length>0){if($(document).height()>768){if(c.tileMode=="small"){if(c.currentSection==language.dynamicArticles.liveNews){c.liveNewsTiles()}else{c.loadSection(c.currentSection)}c.tileMode="large"}}else{if(c.tileMode=="large"){if(c.currentSection==language.dynamicArticles.liveNews){c.liveNewsTiles()}else{c.loadSection(c.currentSection)}c.tileMode="small"}}}}if(currentProfile!="phone"){var e=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(container in e){e[container].onResize()}var b=Ext.ComponentQuery.query(".dynamicarticlesinterstitial");for(ad in b){b[ad].onResize()}}var a=Ext.ComponentQuery.query(".articlereaderitemweathertile");for(tile in a){a[tile].onResize()}if(currentProfile=="phone"){var a=Ext.ComponentQuery.query(".articlereaderbannerad");for(tile in a){a[tile].onResizeFn()}}if(currentProfile!="phone"){var a=Ext.ComponentQuery.query(".articlereaderitemmedtall");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemmedwidetall");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemsmall");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemlrg");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemtopstoryitem");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemmedwide");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".smallviewtilesmall");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".smallviewtilemed");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".smallviewtilewide");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".smallviewtileweather");for(tile in a){a[tile].resize()}}},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},expandArticles:howToArticlesInit:function(b){var a=this;if(a.getArticles()!=null&&a.getArticles().length==0){b.setHtml(language.howToUse.browseNoArticleDesc)}},howToReaderInit:function(a){var b=this;if(b.getArticles()==null||b.getArticles().length==0){a.hide()}}},0,0,0,0,0,0,[InfinityMobile.controller,"ArticleController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderToolbarController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel",readerPanel:"reader",readerView:"#reader",readerMenu:"readermenu",readerToolBar:"readertoolbar",readerToolbarBottom:"readertoolbarbottom",readerPages:"readerpages",readerPagesContainer:"#pagescontainer",readerArchive:"readerarchive",readerArchiveContainer:"#archivecontainer",readerArchiveMonthItem:"archiveMonthItem",readerarticlepopover:"articleview",readerViewController:"#readerViewController",carousel:"infinitecarousel2d",backButton:"button[action=toolbarback]",menuCloseButton:".ReaderMenuClose",blocker:"blocker",navbutton:"navbutton",readerpageviewer:"readerpageviewer",readerpagenumber:"readerpagenumber",layoutview:"layoutview",layouttoolbar:"layouttoolbar",extratopbar:"extratopbar",layouttoolbartoggleicon:"layouttoolbartoggleicon",articlescontainer:"articlescontainer",sectionListOverlay:"sectionlistoverlay",sectionlistoverlayitem:"sectionlistoverlayitem",zonesOverlay:"zonesoverlay",zonesOverlayItem:"zonesoverlayitem",supplementsOverlay:"supplementsoverlay",readerFree:"readerfree",fullscreenprompt:"fullscreenprompt",readerbannerad:"readerbannerad",articlecarousel:"articlecarousel"},control:{readerPanel:{ready:"readerContainerReady",readertap:"readerTap"},carousel:{pagechange:"readerPageChange",updatePageNumber:"readerPageChange"},readerToolbarBottom:{initialized:"toolbarBottomInit"},readerPages:{initialized:"renderPagesLoad"},readerArchive:{initialized:"renderArchiveLoad"},readerspecialarchive:{initialized:"renderSpecialArchiveLoad",initializeExtraArchive:"renderExtraArchiveLoad"},readerArchiveMonthItem:{changeMonth:"changeArchiveMonth",changeYear:"changeArchiveYear",changeDecade:"changeArchiveDecade"},mainPanel:{openReaderMenu:"toolbarMenu",readerRight:"toolbarNext",readerLeft:"toolbarPrevious",readerFirst:"toolbarFirst",readerLast:"toolbarLast",readerJumpToPage:"jumpToPage",showTutorial:"toolbarShowTutorial",toggleDPSMode:"toggleDPSMode",dpsModeOn:"dpsModeOn",dpsModeOff:"dpsModeOff",fullscreenMode:"toolbarFullscreen",zoomModeFit:"zoomModeFit",zoomModeFill:"zoomModeFill",toggleAspect:"toggleAspect",pageNumber:"toolbarPageNumber",toolbarShare:"toolbarShare",articleShare:"articleShare",toolbarHowTo:"toolbarHowTo",toolbarSectionList:"toolbarSectionList",toolbarZones:"toolbarZones",toolbarSupplements:"toolbarSupplements",archive:"renderArchive",toggleZoomMode:"toggleZoomMode",accountIcon:"accountIcon",showMyAccount:"showMyAccount",trackPreviousClick:"trackPreviousClick",trackNextClick:"trackNextClick"},navbutton:{toolbarNext:"toolbarNext",toolbarPrevious:"toolbarPrevious"},readerpagenumber:{jumpToPage:"readerPageNumberJumpToPage",hide:"readerPageNumberHide",hideArticlesContainer:"hideArticlesContainer",showArticlesContainer:"showArticlesContainer"},layouttoolbar:{readAloudPage:"readAloudPage"},layouttoolbartoggleicon:{addToggleGroup:"addToggleGroup",toggleGroupState:"toggleGroupState"},readertoolbarsharemenu:{loadShare:"toolbarLoadShare",shareMenuClose:"shareMenuClose"},zonesOverlay:{initialized:"zonesInitialized",close:"zonesClose"},zonesOverlayItem:{zoneEdition:"toolbarZoneEdition"},supplementsOverlay:{initialized:"supplementsInitialized"},sectionListOverlay:{initialized:"sectionListInitialized",close:"sectionListClose"},sectionlistoverlayitem:{sectionListPage:"toolbarSectionListPage"},readerFree:{close:"closeFree",subscribe:"subscribeFree",login:"loginFree"},fullscreenprompt:{launchfullscreen:"toolbarFullscreen"},readermenushareitem:{shareTap:"shareTap"},readerdpsprompt:{sharePage:"sharePage"},overlay:{enableArticlesContainer:"enableArticlesContainer"},shareslideritem:{shareFullscreenArticle:"shareFullscreenArticle"}}},init:function(){var a=this;a.showToolbar=true;pageSwipes=null;isFullscreen=false;a.checkArchive();a.toggleGroups={};window.addEventListener("keydown",function(c){var b=c.keyCode||c.which;if(b==122){if(!Ext.browser.is.IE){c.preventDefault();a.toolbarFullscreen()}else{c.preventDefault()}}})},checkArchive:archiveLoad:function(h){var e=this;if(settings.menu!=null){if(settings.menu.archiveUsesTabs!=null&&(settings.menu.archivePaginationType!=null&&settings.menu.archivePaginationType=="month")){if(h.data.items[0].raw.editions!=null&&h.data.items[0].raw.editions!=""){var d=h.data.items[0].raw.editions.edition;h.months=[];if(d.length>0){var f=d[0];var a=f["@month"];var g=f["@year"];h.editionToLoad="month"+a+g;for(var c=0;c<d.length;c++){var b=d[c];var a=b["@month"];var g=b["@year"];var j="month"+a+g;if(h[j]==null){h.months.push(a+" "+g);h[j]=[b]}else{h[j].push(b)}}}}}else{if(settings.menu.archiveUsesTabs!=null&&(settings.menu.archivePaginationType!=null&&settings.menu.archivePaginationType=="year")){e.setupYearArchive(h)}else{if(settings.menu.archiveUsesTabs!=null&&(settings.menu.archivePaginationType!=null&&settings.menu.archivePaginationType=="decade")){e.setupArchiveDecade(h)}else{}}}}},setupYearArchive:function(j){var f=this;if(j.data.items[0].raw.editions!=null&&j.data.items[0].raw.editions!=""){var e=j.data.items[0].raw.editions.edition;j.years=[];if(e.length>0){var g=e[0];var h=g["@year"];j.editionToLoad="year"+h;for(var d=0;d<e.length;d++){var b=e[d];var a=b["@month"];var h=b["@year"];var c="year"+h;if(j[c]==null){j.years.push(h);j[c]=[b]}else{j[c].push(b)}}}console.log(j)}},setupArchiveDecade:function(j){var f=this;if(j.data.items[0].raw.editions!=null&&j.data.items[0].raw.editions!=""){var e=j.data.items[0].raw.editions.edition;j.decades=[];if(e.length>0){var g=e[0];var h=g["@year"];var b=h.substr(0,3)+"0";j.editionToLoad="decade"+b;for(var d=0;d<e.length;d++){var c=e[d];var h=c["@year"];var b=h.substr(0,3)+"0";var a="decade"+b;if(j[a]==null){j.decades.push(b);j[a]=[c]}else{j[a].push(c)}}}}},readerTap:toggleNavButtons:toolbarDisplay:toolbarFullscreen:function(){var f=this;if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen()}else{if(document.documentElement.msRequestFullscreen){document.documentElement.msRequestFullscreen()}else{if(document.documentElement.mozRequestFullScreen){document.documentElement.mozRequestFullScreen()}else{if(document.documentElement.webkitRequestFullscreen){document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}}}if(currentProfile=="desktop"&&settings.topbar.hideTopbarOnFullscreen!=null&&settings.topbar.hideTopbarOnFullscreen=="true"){var e=f.getExtratopbar();if(e!=null){e.hide()}var a=$("#reader")[0];if(a!=null){$(a).addClass("readerFullscreen")}var b=f.getReaderbannerad();if(b!=null){b.hide()}var c=Ext.ComponentQuery.query(".navbutton");for(var d in c){if(c[d].direction=="up"){c[d].setTop(-28)}else{if(c[d].direction=="down"){c[d].setBottom(-28)}}}isFullscreen=true;var g=function(){if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){var m=f.getExtratopbar();if(m!=null){m.show()}var h=$("#reader")[0];if(h!=null){$(h).removeClass("readerFullscreen")}var j=f.getReaderbannerad();if(j!=null){j.show()}var k=Ext.ComponentQuery.query(".navbutton");for(var l in k){if(k[l].direction=="up"){k[l].setTop(11)}else{if(k[l].direction=="down"){k[l].setBottom(82)}}}isFullscreen=false;document.removeEventListener("webkitfullscreenchange",g,false);document.removeEventListener("mozfullscreenchange",g,false);document.removeEventListener("MSFullscreenChange",g,false);document.removeEventListener("fullscreenchange",g,false)}};if(document.addEventListener){document.addEventListener("webkitfullscreenchange",g,false);document.addEventListener("mozfullscreenchange",g,false);document.addEventListener("MSFullscreenChange",g,false);document.addEventListener("fullscreenchange",g,false)}}}else{isFullscreen=false;if(document.exitFullscreen){document.exitFullscreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}}}},toolbarBack:toolbarFirst:function(){var a=this.getCarousel();this.resetZoom();a.jumpToFirst();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"First page icon"})}},toolbarPrevious:function(){var a=this;var b=this.getCarousel();this.resetZoom();this.getApplication().getController("PageTurnController").goLeft();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"Previous page icon"});a.trackHeaderNav("previous")}},toolbarNext:function(b){var a=this;var c=this.getCarousel();this.resetZoom();this.getApplication().getController("PageTurnController").goRight();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"next page icon"});a.trackHeaderNav("next")}},trackNextClick:function(){var a=this;if(typeof trackReaderEvent!="undefined"){a.trackHeaderNav("next")}},trackPreviousClick:function(){var a=this;if(typeof trackReaderEvent!="undefined"){a.trackHeaderNav("previous")}},trackHeaderNav:function(b){var d=this;var c="";switch(b){case"next":c="nextClick";break;case"previous":c="previousClick";break}var a=d.getCarousel();var e=function(){var h=d.returnCorrectPageNumber(a);var k=h.split("-");var l=[];for(var f=0;f<k.length;f++){var j=k[f];console.log(j);l.push(d.getSectionName(parseInt(j)))}var g=flatPlanData.pdfPages.length;if(typeof trackReaderEvent==="function"){trackReaderEvent(c,{pageNumArray:k,section:l,totalPages:g})}a.removeListener("activeitemchange",e)};a.on("activeitemchange",e)},getSectionName:function(a){var c=this;var e=settings.bookmarks.bookmark;var d=null;if(e!=null&&e.length>0){for(var b in e){if(a>=e[b].pageNumber&&(e[parseInt(b)+1]==null||a<e[parseInt(b)+1].pageNumber)){d=e[b].name;break}}}return d},returnCorrectPageNumber:toolbarLast:jumpToPage:function(b){var c=this;var a=c.getCarousel();a.jumpToPage(parseInt(b)-1)},toolbarPageNumber:readerPageNumberJumpToPage:function(a){var b=this;a.hide()},readerPageNumberHide:function(d){var e=this;var a=e.getCarousel();var b=(a._pageNumber+1);if((a._mode=="double"&&currentProfile=="desktop")||(currentProfile!="desktop"&&e.returnOrientation()=="landscape"&&a._mode=="double")){b=flatPlanData.reversePageMapper[b]}var g=e.getPageNumber(d);var f=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[g-1]!=null?flatPlanData.pdfPages[g-1].pages[0].advertsAdded:0;g+=f;if(g!=-1){var h=d.maxValue;var c=Math.min(g,h);c=Math.max(c,1);if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){c=(a.getData().length-c)+1}if(b!=c){a.jumpToPage(c-1)}}},getPageNumber:function(a){var b=this;var c=1;if(settings.reader.friendlyNumbering!=null||(editionFlatplanData.frontOffset!=null&&editionFlatplanData.frontOffset>0)){c=b.getPageNumberFriendly(a)}else{c=b.getPageNumberInt(a)}return c},getPageNumberFriendly:getPageNumberInt:function(a){var b=parseInt(a.pageNumberTextBox.value);if(editionFlatplanData.frontOffset!=null&&editionFlatplanData.frontOffset>0){b+=parseInt(editionFlatplanData.frontOffset)}if(b<1){b=-1}if(b>flatPlanData.pageGroups.length){b=-1}return b},getPageNumberString:function(e){var c=-1;e=e.toUpperCase();if(flatPlanData.friendlyPageMapper!=null&&flatPlanData.friendlyPageMapper[e]!=null){c=flatPlanData.friendlyPageMapper[e]+1}else{if(editionFlatplanData.frontOffset!=null&&editionFlatplanData.frontOffset>0&&editionFlatplanData.frontPageNames!=null){for(var b in editionFlatplanData.frontPageNames){var a=editionFlatplanData.frontPageNames[b];if(a.toLowerCase()==e.toLowerCase()){c=parseInt(b)+1;break}}if(editionFlatplanData.backPageNames!=null&&c==-1){for(var b in editionFlatplanData.backPageNames){var a=editionFlatplanData.backPageNames[b];if(a.toLowerCase()==e.toLowerCase()){var d=1;if(settings.reader.reverse=="true"&&editionFlatplanData.backPageNames!=null){d=0}c=parseInt(editionFlatplanData.pageGroups.length)-b;break}}}}}return c},returnReversePageMapper:hideScrollNavBtns:resetZoom:function(){var a=this;if(currentProfile=="desktop"){if($("#slider").val()>1){var b=a.getCarousel();var c=b.getActiveItem();c.resetZoom();c.resetPage()}}},toolbarShowTutorial:function(){console.log("Showing Tutorial!")},toggleDPSMode:dpsModeOn:function(){var c=this;var d=this.getCarousel();if(d.getMode()=="single"){d.toggleDPS();if(settings.advancedLinkTracking=="true"){this.getApplication().getController("ReaderController").handlePenskeTracking()}var a=c.getArticlescontainer();if(a!=null){a.fireEvent("checkActivePageInBrowser",a)}if(currentProfile=="desktop"){var b=c.getLayouttoolbar();if(b!=null&&settings.tts!=null){b.fireEvent("stopArticleTTS",b.ttsToggle,"na")}}else{if(settings.tts!=null){mainPanel.fireEvent("stopArticleTTS",ttsFlag,"na")}}if((iOSVersion()=="10.3"&&Ext.os.is.iOS&&currentProfile=="phone")||((currentProfile=="desktop"||Ext.os.is.Android)&&(Ext.browser.is.Chrome||Ext.browser.name=="ChromeMobile"))){c.getApplication().getController("ReaderController").setupPrintContainer()}}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"Double page mode icon"})}},dpsModeOff:function(){var c=this;var d=this.getCarousel();if(d.getMode()=="double"){d.toggleDPS();if(settings.advancedLinkTracking=="true"){this.getApplication().getController("ReaderController").handlePenskeTracking()}var a=c.getArticlescontainer();if(a!=null){a.fireEvent("checkActivePageInBrowser",a)}if(currentProfile=="desktop"){var b=c.getLayouttoolbar();if(b!=null&&settings.tts!=null){b.fireEvent("stopArticleTTS",b.ttsToggle,"na")}}else{if(settings.tts!=null){mainPanel.fireEvent("stopArticleTTS",ttsFlag,"na")}}if((iOSVersion()=="10.3"&&Ext.os.is.iOS&&currentProfile=="phone")||((currentProfile=="desktop"||Ext.os.is.Android)&&(Ext.browser.is.Chrome||Ext.browser.name=="ChromeMobile"))){c.getApplication().getController("ReaderController").setupPrintContainer()}}c.stopAudio();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"Single page mode icon"})}},stopAudio:function(){var d=this;var e=d.getCarousel();if(e!=null){var c=e.getActiveItem();var a=c.audioObjects;if(a!=null&&a.length>0){for(var b in a){a[b].stopSound()}}}},zoomModeFit:function(){var a=this;if(currentProfile=="desktop"){a.desktopTryRemovePadding()}var b=this.getCarousel();if(b.getZoomMode()=="fill"){b.toggleZoomMode()}else{if(b.getActiveItem().scale>1&&b.getZoomMode()=="fit"){b._zoomMode="fill";b.toggleZoomMode()}}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"page fit mode icon"})}},zoomModeFill:toggleAspect:function(){var a=this.getCarousel();a.toggleZoomMode();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"toggle zoom mode icon"})}},desktopTrySetPadding:desktopTryRemovePadding:function(){var b=this;var a=b.getReaderView();console.log(a);if(a.config.fillPadding!=null){a.setPadding(0)}},toolbarMenu:function(){var a=this;var b="right";a.hideArticlesContainer();if((settings.newsday!=null&&settings.newsday.menuDirection=="left")||(settings.topbar.extraTopBarMenu=="true"&&currentProfile=="desktop")){b="left"}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"menu icon"});trackReaderEvent("menu")}var d="InfinityMobile.view.tablet.ReaderMenu";if(typeof EDITIONAPP!=="undefined"&&EDITIONAPP){switch(currentProfile){case"phone":d="InfinityMobile.view.phone.ReaderMenuFeedApp";break;case"tablet":default:d="InfinityMobile.view.tablet.ReaderMenuFeedApp";break}}else{switch(currentProfile){case"phone":d="InfinityMobile.view.phone.ReaderMenu";break;case"tablet":default:d="InfinityMobile.view.tablet.ReaderMenu";break}}var c=Ext.create(d,{direction:b,sections:a.getApplication().getController("ArticleController").getSections()});Ext.Viewport.add(c);c.show();mainPanel.fireEvent("trackMenuOpen")},readerContainerReady:readerPageChange:function(g){var k=this;k.getApplication().getController("BookmarkController").pwaToggleEditionPageBookmarkIcon();if(settings.reader.friendlyNumbering!=null){k.readerPageChangeFriendly(g)}else{if(settings.reader.pageOffset!=null){k.readerPageChangeOffset(g)}else{var l=k.returnCurrentPageNumber(g);var c=g.getData();var a=flatPlanData.totalAdvertsAdded!=null?flatPlanData.totalAdvertsAdded:0;var h=c.length-pageOffset-flatPlanData.sectionPageCount-a;if((settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=c.length-l+1}var b=k.returnPageNumberString(l,h,g);g.json=g.config.json;var e=g.json.events.onValueChange[0];if(e!=null){var m=e.text;var j=e.target;if(b=="Advertisement"){var f=(typeof language!="undefined"&&language!=null&&language.advertisement!=null)?language.advertisement:"Advertisement";m="<div style='text-overflow:ellipsis;overflow:hidden;height:100%;width:100%;' >"+f+"</div>"}else{if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){m=m.replace("%HPAGE%",h).replace("%HPCOUNT%",b);m=m.replace("Page ","")}else{m=m.replace("%HPAGE%",b).replace("%HPCOUNT%",h);m=m.replace("Page ","")}}var d=Ext.getCmp(j);if(d!=null){d.setHtml(m)}}}}},readerPageChangeFriendly:function(a){var q=this;var o=(a._pageNumber+1);var h=a.getData();var s=h.length-pageOffset-flatPlanData.sectionPageCount;a.json=a.config.json;var d=a.json.events.onValueChange[0];if(d!=null){var k=d.text;var r=d.target;var m=q.getCarousel();var l=m.getActiveItem().getPageNo();var j=q.returnAdvertOffset(l+pageOffset);var b=l;var e=flatPlanData.pageGroups[b].pages[0];var f=m.getActiveItem();if(e.pageName!=null&&e.type!="advert"){if(a._mode=="double"&&q.returnOrientation()=="landscape"){if(o!=1&&o!=s){var p=o;if(o%2==0){p=o+1}else{p=o-1}var n=Math.min(o,p);var c=Math.max(o,p);k=h[n-1].pages[0].pageName+" & "+h[c-1].pages[0].pageName+" / "+h[a._pageNumber].pages[0].sectionLength}else{k=h[a._pageNumber].pages[0].pageName+" / "+h[a._pageNumber].pages[0].sectionLength}}else{k=e.pageName+" / "+e.sectionLength}}else{if(e.type=="advert"){k=typeof language!="undefined"&&language.advertisement!=null&&language.advertisement.trim()!=""?language.advertisement:"Advertisement"}else{k=k.replace("%HPAGE%",o).replace("%HPCOUNT%",h.length)}}var g=Ext.getCmp(r);if(g!=null){g.setHtml(k)}}},returnAdvertOffset:readerPageChangeOffset:function(g){var m=this;var n=g.getActiveItem().getPageNo()+1;var c=g.getData();var j=flatPlanData.totalAdvertsAdded!=null?flatPlanData.totalAdvertsAdded:0;var p=flatPlanData.frontOffset!=null?flatPlanData.frontOffset:0;var k=c.length-pageOffset-flatPlanData.sectionPageCount-j;if(settings.reader.reverse=="true"){n=k-n+1}g.json=g.config.json;var e=g.json.events.onValueChange[0];if(e!=null){var o=e.text;var l=e.target;if(c[g._pageNumber+pageOffset].pages[0].pageName!=null){if(g._mode=="double"&&m.returnOrientation()=="landscape"){var f=flatPlanData.pageGroups[n-pageOffset]!=null?flatPlanData.pageGroups[n-pageOffset].pages[0].origPageNum:n;if(n!=1&&f!=k){var b=n;if(n%2==0){b=n+1}else{b=n-1}var h=Math.min(n,b);var a=Math.max(n,b);o=m.returnPageNumberStringOffset({firstPage:c[h-1+pageOffset]!=null?c[h-1+pageOffset].pages[0]:null,secondPage:c[a-1+pageOffset]!=null?c[a-1+pageOffset].pages[0]:null})}else{if(n==k&&k%2==1){o=m.returnPageNumberStringOffset({firstPage:c[n-1-1+pageOffset]!=null?c[n-1-1+pageOffset].pages[0]:null,secondPage:c[n-1+pageOffset]!=null?c[n-1+pageOffset].pages[0]:null})}else{o=m.returnPageNumberStringOffset({firstPage:c[n-1+pageOffset].pages[0]})}}}else{o=m.returnPageNumberStringOffset({firstPage:c[n-1+pageOffset].pages[0]})}}else{o=o.replace("%HPAGE%",n).replace("%HPCOUNT%",c.length)}var d=Ext.getCmp(l);if(d!=null){if(isNaN(o)){o="<div style='text-overflow:ellipsis;overflow:hidden;height:100%;width:100%;font-size:15px;' >"+o+"</div>"}d.setHtml(o)}}},returnPageNumberStringOffset:function(g){var d=this;var e="";var f=g.firstPage;var c=g.secondPage;var a=true;if(f!=null&&isNaN(f.pageName)){a=false}else{if(c!=null&&isNaN(c.pageName)){a=false}}if(f!=null&&f.type!="advert"&&c!=null&&c.type!="advert"){e=f.pageName+" & "+c.pageName}else{if(f!=null){e=f.pageName}}if(a){var b=flatPlanData.totalAdvertsAdded!=null?flatPlanData.totalAdvertsAdded:0;e+=" / "+(flatPlanData.totalPages-flatPlanData.totalOffset-pageOffset-b)}return e},returnPageNumberString:function(d,f,b){var e=this;var g=flatPlanData.pageMapper[d]-1;d=flatPlanData.pageGroups[g+pageOffset]!=null&&flatPlanData.pageGroups[g+pageOffset].pages[0].pageName!=null?flatPlanData.pageGroups[g+pageOffset].pages[0].pageName:d;if(b._mode=="double"&&e.returnOrientation()=="landscape"){if(d!="Advertisement"&&d!=1&&(d!=f||(d==f&&d%2==1))){var a=d;if(d%2==0){a=d+1}else{a=d-1}if(flatPlanData.bookmarks==null||((flatPlanData.bookmarks.indexOf(a)==-1)&&flatPlanData.bookmarks.indexOf(a+1)==-1)||e.evenNumberSectionCheck(a,d)){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){var c=a+"-"+d;if(d>a){c=d+"-"+a}}else{var c=d+"-"+a;if(d>a){c=a+"-"+d}}return c}else{if(a>d&&(flatPlanData.bookmarks==null||((flatPlanData.bookmarks.indexOf(a)==-1)&&flatPlanData.bookmarks.indexOf(d)==-1))){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){var c=a+"-"+d;if(d>a){c=d+"-"+a}}else{var c=d+"-"+a;if(d>a){c=a+"-"+d}}return c}}}}return d.toString()},evenNumberSectionCheck:function(a,b){console.log(a);if(a<b){return flatPlanData.bookmarks!=null&&(flatPlanData.bookmarks.indexOf(a)!=-1)&&a%2==0&&flatPlanData.bookmarks.indexOf(b)==-1}else{return flatPlanData.bookmarks!=null&&(flatPlanData.bookmarks.indexOf(a)!=-1)&&a%2==0}},returnCurrentPageNumber:returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android||(Ext.os.is.iOS&&currentProfile!="desktop")){if(currentProfile=="phone"&&Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(window.innerWidth>window.innerHeight){a="landscape"}else{a="portrait"}}}else{if(currentProfile=="desktop"){a="landscape"}}return a},toolbarBottomInit:renderPages:function(){var c=this;var a=c.getReaderToolbarBottom();var b=a.scrollerContainer;b.removeAll(true);var d={xtype:"readerpages"};b.add(d)},renderPagesLoad:function(a){var n=this;var d=n.getCarousel().getData();var l=n.getReaderPages();var o=n.getReaderPagesContainer();var c=n.getReaderToolbarBottom();if(c!=null){var j=c.scroller.getScroller()}else{if(n.getArticlescontainer().scrollType=="senchaScroller"){var j=n.getArticlescontainer().getComponent("con").getScrollable().getScroller()}}for(var k=pageOffset;k<d.length;k++){var p=d[k].pages[0];if(p.type=="page"){var f=p.pageNum;var e=f;if(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true"){e=d.length-f+1}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){var b=(e)+" "+language.page;if(p.pageName!=null){var b=p.pageName+" "+language.page}}else{var b=language.page+" "+(e);if(p.pageName!=null){var b=language.page+" "+p.pageName}}var h="http://edition.pagesuite.com";if(window.location.protocol=="https:"){h="https://"+location.host}if(settings.topbar.smallLogo!=null){var r=settings.topbar.smallLogo}else{var r=settings.topbar.logo}var m=p.origPageNum;var g=Ext.create("InfinityMobile.view.ReaderPagesItem",{id:"page"+f,imgSrc:h+"/get_image.aspx?w=280&eid="+editionguid+"&pnum="+m,html:"<img id='imagepage"+f+"' src='"+r+"' class='readerPage placeholder' style='width:140px'  />",cls:"page-container",height:"100%",items:[{top:130,height:30,left:10,width:"120px",padding:"5 7 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; border-radius:5px; text-align:center",html:b,cls:"page-container-text-box"}]});var q=g.element.down("img").dom;g.element.on({tap:scope:g});o.add(g)}}},renderArchive:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("archive")}if(typeof EDITIONAPP!=="undefined"&&EDITIONAPP&&window.parent!=null){window.parent.postMessage("openArchive","*")}else{a.disableArticlesContainer();var c="InfinityMobile.view.tablet.ReaderArchive";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ReaderArchive";break;case"desktop":c="InfinityMobile.view.desktop.ReaderArchive";break;case"tablet":if($(document).height()<700||$(document).width()<700){c="InfinityMobile.view.phone.ReaderArchive";break}break;default:c="InfinityMobile.view.tablet.ReaderArchive";break}var b=Ext.create(c,{});Ext.Viewport.add(b);b.show()}},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},renderArchiveLoad:renderArchiveMonths:function(f){var g=this;var c=f.archiveMonthsContainer;var b=c.config.monthdirection;if(c!=null){var e=Ext.getStore("ArchiveStore");if(settings.menu.archivePaginationType=="month"){var j=e.months}else{if(settings.menu.archivePaginationType=="year"){var j=e.years}else{var j=e.decades}}for(var d=0;d<j.length;d++){var a=j[d];var h=Ext.create("InfinityMobile.view.ReaderArchiveMonthItem",{name:a,monthDirection:b});c.add(h)}}},changeArchiveMonth:changeArchiveYear:function(e){var c=this;var b="year"+e.name;var a=Ext.getStore("ArchiveStore");a.editionToLoad=b;var d=c.getReaderArchive();c.renderArchivePages(d)},changeArchiveDecade:function(e){var c=this;var b="decade"+e.name;var a=Ext.getStore("ArchiveStore");a.editionToLoad=b;var d=c.getReaderArchive();c.renderArchivePages(d)},renderArchivePages:function(g){var e=this;var b=Ext.getStore("ArchiveStore");var d=[];if(b.editionToLoad==null){if(b.data.items[0].raw.editions!=null&&b.data.items[0].raw.editions!=""){d=b.data.items[0].raw.editions.edition}g.hideMonthContainer()}else{d=b[b.editionToLoad]}var h=g.archiveItemsContainer;h.removeAll(true,true);if(d.length!=null){for(var c=0;c<d.length;c++){var f=d[c];var a=Ext.create("InfinityMobile.view.ReaderPageThumbnail",{editionGuid:f["@editionguid"],editionName:f["@name"],thumbType:"edition"});h.add(a)}}else{var f=d;var a=Ext.create("InfinityMobile.view.ReaderPageThumbnail",{editionGuid:f["@editionguid"],editionName:f["@name"],thumbType:"edition"});h.add(a)}},renderArchiveScroll:function(){var l=this;console.log("RENDER ARCHIVE SCROLL");var j=Ext.getStore("ArchiveStore");var k=j.data.items[0].raw.editions.edition;var h=l.getReaderPages();var a=l.getReaderToolbarBottom();var e=a.getScrollable().getScroller();var g=Ext.Viewport.getWindowWidth()+e.position.x;var f=0;for(var d=0;d<k.length;d++){var b=k[d];if(f<g){var m=document.getElementById("imageedition"+(d+1));if(m.src==""){var c=location.protocol+"//"+location.host;if(location.hostname=="localhost"){c=location.protocol+"//edition.pagesuite.com"}m.src=c+"/get_image.aspx?w=280&eid="+b["@editionguid"]}}f+=150}e.on({scope:this,scrollend:l.renderPagesScroll,single:true})},clickPage:function(e,g){e.stopPropagation();var d=this;var c=parseInt(g.id.replace("imagepage",""));var b=d.getCarousel();if((settings.reader.reverse!=null&&settings.reader.reverse=="true")){}var f=this.getCarousel();f.jumpToPage((c-1));var a=d.getReaderToolbarBottom();if(a!=null){}d.trackPagesBrowserNavigation()},trackPagesBrowserNavigation:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("pagesBrowser")}},toggleTopBar:toggleTopBarDesktop:toggleTopBarMobile:addToggleGroup:toggleGroupState:toolbarPages:function(){var c=this;console.log("READER PAGES");var a=c.getReaderToolbarBottom();var b=a.scrollerContainer;b.removeAll(true);var d={xtype:"readerpages"};b.add(d);a.setStyle({visibility:"visible"})},toolbarShare:function(a){var b=this;console.log("SHARE");console.log(a);if(b.getArticlescontainer()!=null){b.disableArticlesContainer()}b.shareMenu=Ext.create("InfinityMobile.view.desktop.ReaderToolbarShareMenu");if(settings.newsday!=null){Ext.Viewport.add(b.shareMenu);b.shareMenu.show();b.shareMenu.setLeft("50%");b.shareMenu.setTop("50%");b.shareMenu.setStyle({transform:"translate3d(-50%,-50%,0px)"})}else{b.shareMenu.showBy(a)}},articleShare:function(a){var b=this;b.shareMenu=Ext.create("InfinityMobile.view.desktop.ReaderToolbarShareMenu",{sharingType:"article",articleGuId:a.articleGuId});Ext.Viewport.add(b.shareMenu);b.shareMenu.show();b.shareMenu.setLeft("50%");b.shareMenu.setTop("50%");b.shareMenu.setStyle({transform:"translate3d(-50%,-50%,0px)"})},toolbarLoadShare:populateShare:function(e){var d=this;var f=settings.sharing.allSharing;d.keyDownFunction=window.onkeydown;window.onkeydown=null;for(var b=0;b<f.length;b++){var a=f[b];var c=settings.sharing[a];d.addShareItem(e,c.icon,c.link,a)}},addShareItem:function(c,n,f,l){var k=this;var o=k.getCarousel();var g=o.getActiveItem();var e=g.config.pageNo+1;var m=(typeof c.sharingType!="undefined"&&c.sharingType=="article")?true:false;var a=(typeof c.articleGuId!="undefined"&&c.articleGuId!="")?c.articleGuId:"";if(g.xtype!="readeradvertpageviewer"){e=editionFlatplanData.reversePageMapper[e];var d=flatPlanData.pageMapper[e];var h=flatPlanData.pageGroups!=null&&flatPlanData.pageGroups[d-1+pageOffset]!=null?flatPlanData.pageGroups[d-1+pageOffset].pages[0].advertsAdded:0;e-=h;if(settings.reader!=null&&settings.reader.reverse=="true"){e=(o.getData().length)-e+1}}else{e=null}if(f.indexOf("pinterest")!=-1){f=f.replace("{0}",encodeURIComponent(location.protocol+"//"+location.host+"/get_image.aspx?w=280&eid="+editionguid+"&pnum="+e));f=f.replace("{1}","http://html5.pagesuite.com/desktop/share.aspx?edid="+editionguid+"&title="+encodeURIComponent(publicationName)+"&editionName="+encodeURIComponent(editionName)+"&pnum="+e);f=f.replace("{2}",encodeURIComponent(publicationName+" - "+editionName));var j=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:n,link:f,pnum:e,type:"pinterest",toolbar:true,articleSharing:m,articleGuId:a})}else{if(f.indexOf("mailto:")==-1){var b="http://html5.pagesuite.com/desktop/share.aspx?edid="+editionguid+"&title="+encodeURIComponent(publicationName)+"&editionName="+encodeURIComponent(editionName)+"&pnum="+e;var j=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:n,link:f,pnum:e,type:l,toolbar:true,articleSharing:m,articleGuId:a})}else{var l="";if(f.indexOf("mailto:")!=null){l="email"}var j=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:n,message:publicationName+" - "+editionName,link:f,pnum:e,type:l,toolbar:true,articleSharing:m,articleGuId:a})}}c.sharingContainer.add(j);c.setWidth($(c.element.dom).width()+40)},shareMenuClose:function(){var a=this;window.onkeydown=a.keyDownFunction;a.enableArticlesContainer()},showArticlesContainer:hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}},toolbarHowTo:function(o,u,t,c,m){var w=this;if(w.hasHowTo==null||!w.hasHowTo){w.hasHowTo=true;var e=window.onkeydown;window.onkeydown=null;if(w.getArticlescontainer()!=null){if(w.getArticlescontainer().mode!="toggle"){w.getArticlescontainer().hide()}w.getArticlescontainer().addCls("blur");w.getArticlescontainer().disableEvents()}var r=typeof settings!="undefined"&&settings.howTo!=null&&settings.howTo.btnColour!=null?"#"+settings.howTo.btnColour:"#458FBB";var f=language.continueText;var g=Ext.create("Ext.Container",{height:40,width:160,bottom:100,zIndex:51,left:"50%",cls:"howTo-continue btn pointerCursor",html:"<p style='top:50%;left:50%;position:absolute;-webkit-transform:translate3d(-50%, -50%,0);transform:translate3d(-50%, -50%, 0);'>"+f+"</p>",style:"-webkit-transform:translateX(-50%);transform:translateX(-50%);background-color:"+r+";color:white;z-index:10000;",initialize:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)}});Ext.Viewport.add(g);var q=w.getCarousel();q.addCls("blur");var s=Ext.ComponentQuery.query(".navbutton");for(btn in s){s[btn].addCls("blur")}var h=false;if(settings.sharing!=null){var d=Ext.create("InfinityMobile.view.desktop.HowToEditionOptions",{modal:!h});if(o!=null){h=true;d.showBy(o)}}if(settings.howTo.showMoreEditionOptions!=null&&settings.howTo.showMoreEditionOptions=="true"){var b=Ext.create("InfinityMobile.view.desktop.HowToMoreEditionOptions",{modal:!h});h=true;b.showBy(m)}var k=Ext.create("InfinityMobile.view.desktop.HowToPageControl",{modal:!h});if(u!=null){h=true;k.showBy(u)}var j=Ext.create("InfinityMobile.view.desktop.HowToViewOptions",{modal:!h});if(t!=null){h=true;j.showBy(t)}var l=Ext.create("InfinityMobile.view.desktop.HowToReader",{modal:!h});h=true;Ext.Viewport.add(l);if(settings.newsday==null){var n=Ext.create("InfinityMobile.view.desktop.HowToMenuIcon",{});if(c!=null){n.showBy(c)}}if(w.getArticlescontainer()!=null){var p=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer=="true"){p=false}}if(p){var v=Ext.create("InfinityMobile.view.desktop.HowToArticlesContainer",{bottom:40,left:60});Ext.Viewport.add(v);v.show()}}var a=Ext.getStore("ArticleStore");if(settings.newsday!=null){if(settings.newsday.articleHelper=="true"&&(a!=null&&a.data.items[0].raw.articles.length>0)){f="Next"}}g.element.on({tap:function(){var y=this;window.onkeydown=e;y.hasHowTo=false;if(d!=null){d.destroy()}if(b!=null){b.destroy()}k.destroy();j.destroy();l.destroy();g.destroy();mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);if(v!=null){v.destroy()}if(n){n.destroy()}var z="helper"+publicationguid;if(typeof(customHelperName)!="undefined"&&customHelperName!=""){z=customHelperName}try{if(settings.newsday!=null){y.setCookie("newsdayHelper","true")}else{localStorage.setItem(z,"complete")}}catch(A){y.setCookie(z,"complete")}if(typeof isTribReader!="undefined"&&isTribReader==true){y.checkTrialScreen()}else{y.removeBlur()}var x=Ext.create("InfinityMobile.view.ReaderArticleHelper",{});if(settings.newsday!=null){if(settings.newsday.articleHelper=="true"&&(a!=null&&a.data.items[0].raw.articles.length>0)){Ext.Viewport.add(x);x.show()}}},scope:w})}},checkTrialScreen:helperFree:function(b){showTrialScreen=true;var a="InfinityMobile.view.desktop.ReaderFree";var b=Ext.create(a,{});mainPanel.add(b);b.show()},removeBlur:closeFree:function(b){var a=this;a.removeBlur();mainPanel.remove(b,true)},subscribeFree:function(b){var a=this;a.removeBlur();mainPanel.remove(b,true);a.showPayPanel()},loginFree:function(b){var a=this;a.removeBlur();mainPanel.remove(b,true);fncLoginPopupShow()},showPayPanel:function(){fncFreeTrialSubscribe()},setCookie:toolbarZones:zonesInitialized:zonesClose:function(a){var b=this;console.log("zones close");a.hide()},toolbarZoneEdition:function(d,m,f){var h=this;var e="";if(m!=""&&typeof editionguid!="undefined"&&m==editionguid){var a=h.getZonesOverlay();if(a!=null){a.destroy()}}else{if(m!=""){e="?edid="+m}else{e="?pubid="+f}}var n="";if(qs.localhost!=null&&qs.localhost=="true"){n="&localhost=true"}var k="default.aspx";try{var j="";if(settings.zones.mainzone!=null){j=settings.zones.mainzone.guid}else{j=settings.zones.zone[0].guid}var l=hostName.substring(hostName.indexOf("."));var c=new Date();c.setTime(c.getTime()+(365*24*60*60*1000));var b="expires="+c.toUTCString();setCookie("zone_default",l,b,f)}catch(g){}if(e!=""){window.location.href=k+e+n}},toolbarSectionList:function(c){var b=this;var d="InfinityMobile.view.desktop.SectionListOverlay";switch(currentProfile){case"phone":d="InfinityMobile.view.phone.SectionListOverlay";break;case"tablet":d="InfinityMobile.view.tablet.SectionListOverlay";break;case"desktop":d="InfinityMobile.view.desktop.SectionListOverlay";break}var a=Ext.create(d,{});Ext.Viewport.add(a);a.show()},sectionListInitialized:function(b,d){var g=this;var j=settings.bookmarks.bookmark;for(var c=0;c<j.length;c++){var k=j[c];var l=true;var f=d.getItems().items;for(var h in f){var a=f[h];if(a.sectionListText==k.name&&a.sectionListPageNumber==k.page&&a.sectionListPageNumber==k.pageNumber){l=false;break}}if(l){var e=Ext.create("InfinityMobile.view.desktop.SectionListOverlayItem",{sectionListText:k.name,sectionListPageNumber:k.pageNumber});d.add(e)}}},sectionListClose:function(b){var a=this;b.hide()},toolbarSectionListPage:function(b,f){var e=this;var d=e.getSectionListOverlay();d.hide();var a=e.getCarousel();var g=0;for(var c=0;c<=Object.entries(flatPlanData.pageGroups).length;c++){if(flatPlanData.pageGroups[c]!=null&&flatPlanData.pageGroups[c].pages[0]!=null&&(flatPlanData.pageGroups[c].pages[0].type=="page")&&(f==flatPlanData.pageGroups[c].pages[0].origPageNum)){g=flatPlanData.pageGroups[c].pages[0].pageNum;break}}a.jumpToPage(parseInt(g)-1);e.trackSectionNavigation()},trackSectionNavigation:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("jumpToSection")}},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},readAloudPage:function(){var b=this;var a=this.getApplication().getController("ArticlePopoverController");if(readAloud!=null&&a!=null){console.log(readAloud);readAloud.type="PAGE";switch(readAloud.status){case"STOPPED":readAloud.Status="PLAYING";b.getPageTextAndRead(a);break;case"PLAYING":a.stopReading();break}}},getPageTextAndRead:function(b){var c=this;var d=c.getCarousel();if(d!=null&&d.getActiveItem()!=null){var e=d.getActiveItem();var a=null;if(e._mode=="double"){a=c.getQueryStringDoublePage(e)}else{}if(a!=null){$.ajax({url:"../get_page_text.aspx"+a,async:false,success:)}}},getQueryStringDoublePage:function(c){var b=this;var a=null;var d=null;if(c.config.leftPage!=null&&c.config.leftPage.type=="page"&&c.config.leftPage.guid!=null){a=c.config.leftPage.guid}if(c.config.rightPage!=null&&c.config.rightPage.type=="page"&&c.config.rightPage.guid!=null){d=c.config.rightPage.guid}if(d!=null&&a!=null){return"?dpsmode=double&leftguid="+a+"&rightguid="+d}else{if(d!=null){return"?dpsmode=single&pageguid="+d}else{if(a!=null){return"?dpsmode=single&pageguid="+a}}}return null},toggleZoomMode:function(a){var b=this;var c=b.getCarousel();if(c._zoomMode=="fill"){a.status="fit";a.iconUrl=settings.topbar.fillpageicon;a.loadIcon()}else{a.status="fill";a.iconUrl=settings.topbar.fitpageicon;a.loadIcon()}c.toggleZoomMode()},renderSpecialArchiveLoad:function(e){var c=this;if(typeof specialArchive!="undefined"&&specialArchive.edition.length>0){var f=e.archiveItemsContainer;f.removeAll(true,true);for(var b=0;b<specialArchive.edition.length;b++){var d=specialArchive.edition[b];var a=Ext.create("InfinityMobile.view.ReaderArchiveItem",{editionGuid:d["@editionguid"],editionName:d["@name"]});f.add(a)}}},renderExtraArchiveLoad:function(e,c){var f=e.archiveItemsContainer;f.removeAll(true,true);for(var b=0;b<c.length;b++){var d=c[b];var a=Ext.create("InfinityMobile.view.ReaderArchiveItem",{editionGuid:d["@editionguid"],editionName:d["@name"]});f.add(a);a.show()}},shareTap:function(g){var n=this;var m=n.getCarousel();if(g.type.toLowerCase()=="twitter"&&g.url.indexOf("article_popover")!=-1){var q=g.link.replace("{0}",encodeURIComponent(g.message)).replace("{1}",g.url)}else{var q=g.link.replace("{0}",g.url).replace("{1}",encodeURIComponent(g.message))}q=q.replace("message=","body=");q=q.replace(/&apos;/g,"'");q=q.replace(/%26apos%3B/g,"'");var a=false;var h=n.getReaderarticlepopover();if(h==null&&g.articleGuId==""){if(m!=null&&currentProfile=="desktop"&&m._mode=="double"){a=true}else{if(m!=null&&currentProfile!="desktop"&&m._mode=="double"&&n.returnOrientation()=="landscape"){a=true}}}if(a){var k=m.getActiveItem();if(currentProfile=="desktop"){var l=k.config.leftPage;var d=k.config.rightPage}else{if(k._pageNo%2==0){var l=k._previousPage;var d=k._page}else{var l=k._page;var d=k._nextPage}}if(l!=null&&l!=""&&l.type=="page"&&d!=null&&d!=""&&d.type=="page"){var o=l.origPageNum;var f=d.origPageNum;if(settings.reader!=null&&settings.reader.reverse=="true"){o=editionFlatplanData.pageGroups.length-o+1;f=editionFlatplanData.pageGroups.length-f+1}var c=o;var j=f;var e=editionFlatplanData.pdfPages[o-1]!=null?editionFlatplanData.pdfPages[o-1].pages[0]:null;var p=editionFlatplanData.pdfPages[f-1]!=null?editionFlatplanData.pdfPages[f-1].pages[0]:null;if(e!=null&&e.pageName!=null&&e.pageName!=null){c=e.pageName}if(p!=null&&p.pageName!=null&&p.pageName!=null){j=p.pageName}var b=Ext.create("InfinityMobile.view.ReaderDpsPrompt",{leftPageNo:o,leftDisplayNo:c,rightPageNo:f,rightDisplayNo:j,promptType:"share",url:q,shareType:g.type,shareMessage:g.message});Ext.Viewport.add(b);b.show()}else{n.share(q,g.type,g.pnum,g.message)}}else{console.log(g);n.share(q,g.type,g.pnum,g.message)}if(n.shareMenu!=null){if(n.shareMenu.loaded){n.shareMenuClose()}n.shareMenu.destroy()}},share:function(n,l,a,o){var k=this;if(settings.tracking!=null&&settings.tracking.trackingType=="DA"&&typeof trackDaEvent!=null){trackDaEvent("Share via "+l,"Social")}var p="page";var b=k.getReaderarticlepopover();if(b!=null){p="article"}if(p=="page"&&typeof EDITIONAPP!="undefined"&&EDITIONAPP&&settings.reader.shareViaPwa=="true"){if(n.indexOf("pinterest")!=-1&&!o.length){o=encodeURIComponent("https://edition.pagesuite-professional.co.uk/get_image.aspx?w=600&eid="+editionguid+"&pnum="+a)}window.parent.postMessage({type:"sharePage",data:{type:l,pnum:a,message:o,section:this.getSectionName(a),editionguid:editionguid,editionname:typeof editionName!="undefined"?editionName:null,editiondate:typeof editionDate!="undefined"?editionDate:null,publicationname:typeof publicationName!="undefined"?publicationName:null}},"*")}else{if(n.indexOf("mailto:")!=-1){try{if(typeof trackReaderEvent!="undefined"){if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&p=="article"){var c=this.getArticlecarousel().getActiveItem();var f=c.article;j=f.pageNumber;m=this.getSectionName(f.pageNumber);var d={pageNumber:j,section:m,description:o,socialType:l,shareType:p,headline:o};trackReaderEvent("articleShare",d)}else{trackReaderEvent("email",{pageNum:a,description:o,shareType:p})}}}catch(e){console.error("[ReaderToolbarController] Error Caught:\n",e)}if(Ext.browser.userAgent.indexOf("CrOS")!=-1){window.open(n)}else{if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&window.top!=null){window.top.location.href=n}else{window.location.href=n}}}else{window.open(n);if(typeof trackReaderEvent!="undefined"){if(n.indexOf("facebook")!=-1){l="facebook"}else{if(n.indexOf("twitter")!=-1){l="twitter"}else{if(n.indexOf("google")!=-1){l="google+"}else{if(n.indexOf("linkedin")!=-1){l="linkedin"}else{if(n.indexOf("pinterest")!=-1){l="pinterest"}}}}}var j=a;var m;if(p=="article"&&b!=null){var c=this.getArticlecarousel().getActiveItem();if(c!=null){var f=c.article;j=f!=null?f.pageNumber:j;m=this.getSectionName(j)}}var h={pageNum:a,pageNumber:j,description:o,socialType:l,shareType:p,section:m,headline:o};if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&p=="article"){trackReaderEvent("articleShare",h)}else{trackReaderEvent("social",h)}}}if(a==null&&p=="article"){var g=k.getArticlecarousel().getActiveItem();if(g!=null&&g.config.page!=null&&g.config.page.page!=null){a=g.config.page.page}}if(settings.tracking!=null&&settings.tracking.trackingType=="GA"&&typeof gtag!="undefined"){gtag("event","Share",{event_category:"Share",event_label:l+" - "+(p=="page"?"Page "+a:o),event_value:p=="page"?"Page "+a:o,value:p=="page"?"Page "+a:o,page_number:a,page_path:"/"+a})}}},sharePage:function(b,d){var c=this;if(b!=null&&b.url!=null&&d!=null){var a=b.url.replace(/pnum=[0-9]*/g,"pnum="+d.pageNo).replace(/pnum%3D[0-9]*%26/g,"pnum%3D"+d.pageNo+"%26");c.share(a,b.shareType,d.pageNo,b.shareMessage);b.destroy()}else{console.warn("Unable to share")}},accountIcon:function(){var a=this;window.open(editionDomain+"my_account.aspx?eid="+editionguid,"_blank")},showMyAccount:function(){var b=this;if(currentProfile=="desktop"){var a=b.getLayouttoolbar();if(a!=null){a.showAccountIcon()}}},toolbarSupplements:function(){var b="InfinityMobile.view.desktop.SupplementsOverlay";var a=Ext.create(b,{});Ext.Viewport.add(a);a.show()},supplementsInitialized:function(b,g){var f=this;var a=settings.menu.supplements.supplement;for(var d=0;d<a.length;d++){var e=a[d];var c=Ext.create("InfinityMobile.view.desktop.ZonesOverlayItem",{zoneItem:e});g.add(c)}},shareFullscreenArticle:function(c,j){var h=this;var l=h.getReaderarticlepopover();var n=l.articleCarousel;if(n!=null){var d=n.getActiveItem();var b=d.articleItem;var f=d.data;if(d!=null&&d.articleItem!=null){var m=b.headline!=null&&b.headline.trim()!=""?b.headline:language.page+" "+b.articleNumber;var a=f.sharelink;if(j.toLowerCase()=="twitter"){var k=c.link.replace("{0}",encodeURIComponent(m)).replace("{1}",a)}else{var k=c.link.replace("{0}",a).replace("{1}",encodeURIComponent(m))}k=k.replace("message=","body=");k=k.replace(/&apos;/g,"'");k=k.replace(/%26apos%3B/g,"'");if(k.indexOf("mailto:")>=0){try{trackReaderEvent("email",{pageNum:b.articleNumber,description:m,shareType:"Article"})}catch(e){console.error("[ReaderToolbarController]: Error Caught\n",e)}window.open(k,"_self")}else{window.open(k,"_blank");try{var g={pageNum:b.articleNumber,description:m,socialType:j,shareType:"Article"};trackReaderEvent("social",g)}catch(e){console.error("[ReaderToolbarController]: Error Caught\n",e)}}l.hideShareSlider()}}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderToolbarController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderMenuController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel",articlecarousel:"articlecarousel",readerMenu:"readermenu",readerSections:"readermenusection",readerArchive:"readerarchive",readerSpecialArchive:"readerspecialarchive",readerMenuItem:"readermenuitem",readerMenuSectionItem:"readermenusectionitem",readerarticlepopover:"articleview",reader:"reader",layouttoolbar:"layouttoolbar",carousel:"infinitecarousel2d",carousel:"infinitecarousel2d",readerToolbarBottom:"readertoolbarbottom",articlereadermenu:"articlereadermenu",articlescontainer:"articlescontainer"},control:{main:{showZones:"renderZones",close:"menuClose"},readerMenu:{close:"menuClose",loadShare:"menuLoadShare",loadSections:"menuLoadSections",loadSupplements:"menuLoadSupplements",loadZones:"menuLoadZones",loadQuickLinks:"menuLoadQuickLinks",sectionclick:"sectionClick",disableArticlesContainer:"disableArticlesContainer",enableArticlesContainer:"enableArticlesContainer",loadExtraArchiveButtons:"loadExtraArchiveButtons"},readerMenuItem:{menuPages:"menuPages",menuArchive:"menuArchive",menuSearch:"menuSearch",menuDownload:"menuDownload",menuAddNote:"menuAddNote",menuCreateClipping:"menuCreateClipping",menuBookmarks:"menuBookmark",menuGames:"menuGames",menuBreakingNews:"menuBreakingNews",menuObituaries:"menuObituaries",menuHowToUse:"menuHowToUse","menuItem menuHowToUse":"menuHowToUse",menuWhatsNew:"menuWhatsNew",menuHelp:"menuHelp","menuItem menuHelp":"menuHelp",menuDynamicArticles:"menuDynamicArticles",menuArticles:"menuArticles","menuItem menuArticles":"menuArticles",menuPrint:"menuPrint",menuUser:"menuUser",supplementItem:"menuSupplement",quickLinkItem:"menuQuickLink","quickLinkItem menuItem":"menuQuickLink",zoneItem:"menuZoneClick","zoneItem menuItem":"menuZoneClick",menuTerms:"menuTerms","menuItem menuTerms":"menuTerms",menuAccount:"menuAccount",menuSectionsBtn:"menuSectionsBtn",menuZonesBtn:"menuZonesBtn",menuStoryPref:"menuStoryPref",specialSupplmentMenuItem:"loadSpecialSupplements",menuFaq:"menuFaq","menuItem menuFaq":"menuFaq",menuSpecialArchive:"menuSpecialArchive",menuNewsdayFunbook:"menuNewsdayFunbook",menuSupplementsTab:"menuSupplementsTab",menuPrivacy:"menuPrivacy",menuHome:"menuHome",extraArchiveItem:"extraArchiveItem",menuPuzzles:"menuPuzzles"},mainPanel:{toolbarInfo:"menuHowToUse",toolbarClipping:"menuCreateClipping",toolbarPrint:"menuPrint",toolbarBookmarks:"menuBookmark",toolbarDownload:"menuDownload",toolbarArchive:"menuArchive",specialArchive:"specialArchive",mainArchive:"mainArchive",extraArchive:"extraArchive",toolbarPages:"menuPages",toolbarPuzzles:"menuPuzzles"},readerSections:{initialized:"sectionInit",back:"sectionBack",sectionclick:"sectionClick"},readerMenuSectionItem:{sectionclick:"sectionClick"},readerArchive:{close:"closeArchive",enableArticlesContainer:"enableArticlesContainer"},readerspecialarchive:{close:"closeSpecialArchive"},readerToolbarBottom:{close:"closePages"},articlereadermenu:{loadShare:"menuLoadShare"},readerspecialsupplements:{showSupplements:"showSupplements",close:"closeSupplements"},readerarticlepopover:{viewallarticles:"menuArticles"}}},init:menuInit:function(){var b="InfinityMobile.view.tablet.ReaderMenu";if(typeof EDITIONAPP!=="undefined"&&EDITIONAPP){b=""}else{switch(currentProfile){case"phone":b="InfinityMobile.view.phone.ReaderMenu";break;case"tablet":default:b="InfinityMobile.view.tablet.ReaderMenu";break}}var a=Ext.create(b,{});Ext.Viewport.add(a);a.show()},menuClose:menuDynamicArticles:returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},menuArchive:function(){var a=this;a.menuClose();if(typeof EDITIONAPP!=="undefined"&&EDITIONAPP&&window.parent!=null){window.parent.postMessage("openArchive","*")}else{a.renderArchive()}},menuPages:function(){var a=this;a.menuClose();if(a.getArticlescontainer()==null){a.renderPages()}else{a.getArticlescontainer().pagesTabTap()}if(currentProfile=="phone"){mainPanel.fireEvent("checkActivePageInToolbarBottom",a.getReaderToolbarBottom())}},menuSearch:menuAddNote:function(){var a=this;a.menuClose();mainPanel.fireEvent("addNote","")},menuCreateClipping:menuBookmark:function(){var a=this;a.menuClose();if(typeof NEWPWA!="undefined"&&NEWPWA===true){mainPanel.fireEvent("pwaBookmark","")}else{mainPanel.fireEvent("bookmark","")}},menuSections:menuLoadShare:populateShare:function(f){var e=this;var g=settings.sharing.allSharing;for(var c=0;c<g.length;c++){var b=g[c];var d=settings.sharing[b];var a=d.icon;if(settings.menu.sharingIconType!=null){switch(settings.menu.sharingIconType){case"white":default:a=d.icon;break;case"grey":a=d.iconGrey;break;case"dark":a=d.iconDark;break}}e.addShareItem(f,a,d.link,b)}},addShareItem:function(b,l,e,k){var j=this;var m=j.getCarousel();var f=m.getActiveItem();var d=f.config.pageNo+1;if(f.xtype!="readeradvertpageviewer"){d=editionFlatplanData.reversePageMapper[d];var c=flatPlanData.pageMapper[d];var g=flatPlanData.pageGroups!=null&&flatPlanData.pageGroups[c-1+pageOffset]!=null?flatPlanData.pageGroups[c-1+pageOffset].pages[0].advertsAdded:0;d-=g;if(settings.reader!=null&&settings.reader.reverse=="true"){d=(m.getData().length)-d+1}}else{d=null}if(e.indexOf("pinterest")!=-1){e=e.replace("{0}",encodeURIComponent(location.protocol+"//"+location.host+"/get_image.aspx?w=280&eid="+editionguid+"&pnum="+d));e=e.replace("{1}","http://html5.pagesuite.com/desktop/share.aspx?edid="+editionguid+"&title="+encodeURIComponent(publicationName)+"&editionName="+encodeURIComponent(editionName)+"&pnum="+d);e=e.replace("{2}",encodeURIComponent(publicationName+" - "+editionName));var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:l,link:e,pnum:d,type:"pinterest",menu:"true"})}else{if(e.indexOf("mailto:")==-1){var a="http://html5.pagesuite.com/desktop/share.aspx?edid="+editionguid+"&title="+encodeURIComponent(publicationName)+"&editionName="+encodeURIComponent(editionName)+"&pnum="+d;var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:l,link:e,type:k,pnum:d,menu:"true"})}else{var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{message:publicationName+" - "+editionName,icon:l,link:e,type:k,pnum:d,menu:true})}}b.sharingContainer.add(h)},menuLoadSections:function(c,e,f){var h=this;var m=settings.bookmarks;var b=settings.menu.sectionList;if(settings.menu.hideSectionList==null&&m.bookmark.length>0){if(settings.menu.bookmarkText!=null){f.setHtml(language.menu.sections.toUpperCase())}for(var d=0;d<m.bookmark.length;d++){var k=m.bookmark[d];var n=true;var g=e.getItems().items;for(var j in g){var a=g[j];if(a.name==k.name&&a.pageNumber==k.page&&a.pageNumber==k.pageNumber){n=false;break}}if(n){var l=Ext.create("InfinityMobile.view.ReaderMenuSectionItem",{name:k.name,pageNumber:k.pageNumber});e.add(l)}}}else{f.setHidden(true)}},menuLoadSupplements:function(g,c,h){var f=settings.menu.supplements;if(f!=null&&f.supplement.length>0){if(settings.menu.supplements.showSupplementsOverlay!=null&&settings.menu.supplements.showSupplementsOverlay=="true"){var e=Ext.create("InfinityMobile.view.ReaderMenuItem",{id:"specialSupplmentMenuItem",action:"loadSpecialSupplements",text:"Special Supplements",supplements:f.supplement});c.add(e);if(settings.menu.supplements!=null){h.setHtml("SUPPLEMENTS")}}else{h.setHtml(language.menu.supplements.toUpperCase());for(var d=0;d<f.supplement.length;d++){var a=f.supplement[d];var b=Ext.create("InfinityMobile.view.ReaderMenuItem",{cls:"supplementItem",text:a.name,guid:a.guid,editionguid:a.editionGuid});c.add(b)}}}else{h.setHidden(true)}},loadSpecialSupplements:function(a){var b=this;b.menuClose();var d="InfinityMobile.view.desktop.ReaderSpecialSupplements";switch(currentProfile){case"phone":d="InfinityMobile.view.phone.ReaderSpecialSupplements";break}var c=Ext.create(d,{supplements:a.config.supplements});Ext.Viewport.add(c);c.show()},menuLoadZones:function(b,h,e){var j=this;var g=settings.menu.zones;var c=settings.zones;if(typeof isTribReader=="undefined"){isTribReader=false}if(g!=null&&c!=null&&c.zone!=null&&c.zone.length>0&&!isTribReader){for(var d=0;d<c.zone.length;d++){var k=c.zone[d];var f="zoneItem";if(settings.newsday!=null){f+=" menuItem"}var a=Ext.create("InfinityMobile.view.ReaderMenuItem",{cls:f,text:k.name,guid:k.guid,editionguid:k.editionGuid});h.add(a)}}else{e.setHidden(true)}},menuZoneClick:function(c){var b=this;var a="";if(qs.localhost!=null&&qs.localhost=="true"){a="&localhost=true"}if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){window.parent.postMessage({type:"openEdition",editionguid:c.config.editionguid},"*")}}else{window.location.href="default.aspx?&edid="+c.config.editionguid+a;window.open(quickLink.config.url)}},menuLoadQuickLinks:function(a,f,c){var h=this;var e=settings.menu.quickLinks;if(e!=null&&e.quickLink.length>0){for(var g=0;g<e.quickLink.length;g++){var d=e.quickLink[g];var j="quickLinkItem";if(settings.newsday!=null){j+=" menuItem"}var b=Ext.create("InfinityMobile.view.ReaderMenuItem",{cls:j,text:d.name,url:d.value});f.add(b)}}else{if(c!=null){c.setHidden(true)}}},menuSupplement:function(b){if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){window.parent.postMessage({type:"openEdition",editionguid:b.config.editionguid,publicationguid:b.config.guid},"*")}}else{var a=location.protocol+"//"+location.host+"/launch.aspx?";if(b.config.editionguid!=""){a+="eid="+b.config.editionguid}else{a+="pbid="+b.config.guid}if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.supplements!=null&&settings.menu.supplements.openSupplementInNewTab=="true"){window.open(a)}else{window.location.href=a}}},menuQuickLink:menuDownload:menuGames:function(){var a=this;a.openLink("http://games.courant.com/")},menuBreakingNews:function(){var a=this;a.openLink("http://www.courant.com/breaking-news/")},menuObituaries:function(){var a=this;a.openLink("http://www.legacy.com/obituaries/hartfordcourant")},openLink:function(a){window.open(a)},renderPages:function(){var c=this;console.log("READER PAGES");var a=c.getReaderToolbarBottom();var b=a.scrollerContainer;b.removeAll(true);var d={xtype:"readerpages"};b.add(d);a.setStyle({visibility:"visible"})},closePages:renderArchive:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("archive")}a.disableArticlesContainer();var c="InfinityMobile.view.tablet.ReaderArchive";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ReaderArchive";break;case"desktop":c="InfinityMobile.view.desktop.ReaderArchive";break;case"tablet":c="InfinityMobile.view.tablet.ReaderArchive";break;default:c="InfinityMobile.view.tablet.ReaderArchive";break}var b=Ext.create(c,{});Ext.Viewport.add(b);b.show()},closeArchive:function(a){a.hide()},closeSpecialArchive:function(a){a.hide()},sectionInit:sectionClose:function(){var a=this;var b=a.getReaderSections();b.hide()},sectionBack:function(){var a=this;a.sectionClose();a.menuInit()},sectionClick:function(e){var d=this;var g=d.getReaderMenu();if(g!=null){var f=g.sectionsContainer;if(f!=null){var a=f.getItems().items;if(a!=null){for(var b=0;b<a.length;b++){var c=a[b];if(c!=null){c.setupStyling()}}}}}e.element.dom.style.backgroundColor="#458fbb";setTimeout(function(){if(typeof EDITIONAPP==="undefined"||!EDITIONAPP){if(g!=null){d.menuClose()}else{d.sectionClose()}}var j=d.getCarousel();var h=flatPlanData.pdfPages[parseInt(e.pageNumber)-1].pages[0].pageNum-1;j.jumpToPage(h)},100)},trackSectionNavigation:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("jumpToSection")}},menuHowToUse:function(){var a=this;a.menuClose();if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){window.parent.postMessage({type:"helper"},"*")}}else{if(a.getArticlescontainer()!=null){if(a.getArticlescontainer().mode!="toggle"){a.getArticlescontainer().hide()}a.getArticlescontainer().addCls("blur");a.getArticlescontainer().disableEvents()}showTrialScreen=false;if(currentProfile!="desktop"){var b="InfinityMobile.view.tablet.ReaderHelper";switch(currentProfile){case"phone":b="InfinityMobile.view.phone.ReaderHelper";break;case"tablet":default:b="InfinityMobile.view.tablet.ReaderHelper";break}var c=Ext.create(b,{});mainPanel.add(c);c.show();a.getCarousel().addCls("blur")}else{a.getLayouttoolbar().howToTap()}}},menuWhatsNew:menuHelp:function(){var e=this;e.menuClose();var c=navigator.platform;if(Ext.os.is.Android){var h=/;\s*([^;]+)\s+Build\//g;var d=h.exec(navigator.userAgent);if(d!=null&&d[1]!=null){var b=d[1];c=b}else{if(navigator.userAgent.indexOf("Android")!=-1){c="Android"}}}var a="\r\n\r\nDevice: "+c;a+="\r\n";a+="Reader Version: "+versionNumber;a+="\r\n";a+="OS: "+Ext.os.name+", Version: "+Ext.os.version.version;a+="\r\n";a+="Browser: "+Ext.browser.name+", Version: "+Ext.browser.version.version;a+="\r\n";a+="User Agent: "+navigator.userAgent;a=encodeURIComponent(a);var f="";if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.contactUsSubject!=null){f="&subject="+encodeURIComponent(settings.menu.contactUsSubject)}if(Ext.browser.userAgent.indexOf("CrOS")!=-1){window.open("mailto:"+settings.menu.contactUsEmailAddress+"?body="+a+f)}else{try{if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&window.top!=null){var j=settings.menu.contactUsEmailAddress;if(j!=null&&(j.indexOf("http://")>=0||j.indexOf("https://")>=0)){window.open(j,"_blank")}else{window.top.location.href="mailto:"+settings.menu.contactUsEmailAddress+"?body="+a+f}}else{var j=settings.menu.contactUsEmailAddress;if(j!=null&&(j.indexOf("http://")>=0||j.indexOf("https://")>=0)){window.open(j,"_blank")}else{window.location.href="mailto:"+settings.menu.contactUsEmailAddress+"?body="+a+f}}}catch(g){}}},menuPrint:function(){var a=this;a.menuClose();if(typeof NEWPWA!="undefined"&&NEWPWA===true){mainPanel.fireEvent("newPWAPrint")}else{mainPanel.fireEvent("loadPrintMenu")}},menuArticles:function(a){var f=this;var c=f.getArticlescontainer();var e=false;if(a.id.indexOf("ext-articleview")>=0){e=true;c.prepForArticlePopoverView()}if(currentProfile=="phone"&&!e){f.menuDynamicArticles()}else{if(c!=null&&c.articleTabTap!=null){c.articleTabTap()}else{f.grabArticles()}if(e){var b=f.getArticlecarousel();if(!!b){var h=b.getActiveItem();var g=h.article;var d=!!g?g.guid:h.articleguid;f.scrollToCurrentArticle(d)}}}f.menuClose()},scrollToCurrentArticle:function(k){var h=this;try{if(settings.reader!=null&&settings.reader.reverse=="true"){return}var c=h.getArticlescontainer();var d=c.contentArea;var a=h.findArticleInBrowser(k);if(!!a){var b=a.element.dom.offsetLeft;if(c.scrollType=="desktopScroller"){d.element.dom.scrollLeft=b}else{var j=d.getScrollable();var e=j.getScroller();var f=Math.min(b,e.maxPosition.x);e.scrollTo(f)}}}catch(g){console.warn("[ReaderMenuController] Error Caught:\n",g)}},findArticleInBrowser:function(n){var h=this;var d=h.getArticlescontainer();var e=d.contentArea;var l=e.getItems().items||[];var o=[];var a;for(var j=0;j<l.length;j++){var c=l[j];var g=c.getItems().items;var k=g[0];var m=k.getItems().items;if(!!m){for(var f=0;f<m.length;f++){var b=m[f];console.log(b);if(b.hasArticle(n)){a=b;break}}}if(!!a){break}}return a},grabArticles:function(){var b=this;var a=b.createArticlesContainer();a.show();a.articleTabTap()},createArticlesContainer:function(){var c=this;c.articles=c.getApplication().getController("ArticleController").getArticles();var b=Ext.getStore("SettingStore");var e=[];if(b.data.items[0].raw.menu.bookmarks!=null){e=b.data.items[0].raw.menu.bookmarks.bookmark}if(currentProfile=="phone"){var a=Ext.create("InfinityMobile.view.phone.ArticlesContainer",{articles:c.articles,sections:e})}else{var d="InfinityMobile.view.ArticlesContainer";if(currentProfile=="tablet"||currentProfile=="largetablet"){d="InfinityMobile.view.tablet.ArticlesContainer"}if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){d="InfinityMobile.view.tablet.ArticlesContainer"}}var a=Ext.create(d,{articles:c.articles,sections:e})}Ext.Viewport.add(a);return a},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},menuUser:function(){if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){var a=new Date();a.setMonth(a.getMonth()-12);setCookie("SID",location.host,a,"");window.parent.postMessage("userLoggedOut","*")}}else{$.ajax({url:"logout.aspx?pubid="+publicationguid}).done(}},menuTerms:function(){var b=this;if(currentProfile=="phone"){var a=Ext.create("InfinityMobile.view.phone.readerTerms",{})}else{var a=Ext.create("InfinityMobile.view.desktop.readerTerms",{})}b.menuClose()},menuAccount:menuSectionsBtn:function(){var a=this;a.getMainPanel().fireEvent("toolbarSectionList");a.menuClose()},menuZonesBtn:menuStoryPref:showSupplements:closeSupplements:function(a){a.hide()},menuFaq:function(){var a=this;if(settings.menu.faqUrl!=null){window.open(settings.menu.faqUrl)}},specialArchive:function(){var d=this;try{var c=d.getReaderArchive();d.closeArchive(c)}catch(b){var a=d.getReaderSpecialArchive();d.closeSpecialArchive(a)}d.renderSpecialArchive()},mainArchive:function(){var b=this;var a=b.getReaderSpecialArchive();b.closeSpecialArchive(a);b.renderArchive()},menuSpecialArchive:function(){var a=this;a.menuClose();a.renderSpecialArchive()},menuNewsdayFunbook:function(){var a=this;a.menuClose();window.location.href="../redirfunbook.aspx?edid="+editionguid},renderSpecialArchive:function(){var a=this;a.disableArticlesContainer();var c="InfinityMobile.view.tablet.ReaderSpecialArchive";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ReaderSpecialArchive";break;case"desktop":c="InfinityMobile.view.desktop.ReaderSpecialArchive";break;case"tablet":c="InfinityMobile.view.tablet.ReaderSpecialArchive";break;default:c="InfinityMobile.view.tablet.ReaderSpecialArchive";break}var b=Ext.create(c,{});Ext.Viewport.add(b);b.show()},menuSupplementsTab:function(){var b=this;if(b.getArticlescontainer()!=null){b.getArticlescontainer().supplementsTabTap()}else{var a=b.createArticlesContainer();a.show();a.supplementsTabTap()}b.menuClose()},menuPrivacy:function(){var a=this;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.privacyPolicyUrl!=null){window.open(settings.menu.privacyPolicyUrl,"_blank")}},menuHome:function(){var a=this.getCarousel();if(a!=null){this.menuClose();a.jumpToPage(0)}},loadExtraArchiveButtons:function(d,a){var e=this;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.extraArchives!=null){var b=settings.menu.extraArchives;for(var c=0;c<b.length;c++){var g=b[c];var f=Ext.create("InfinityMobile.view.ReaderMenuItem",{id:"extraArchiveItem",action:"openExtraArchiveItem",text:g.name,cls:"menuItem menuExtraArchive",clickType:"id",pubid:g.pubid,desc:g.desc});d.menuEditionOptionsSection.insert(a,f);f.show();a++}}},extraArchiveItem:function(e,b){var d=this;var f=function(g){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("archive")}d.menuClose();d.disableArticlesContainer();var j="InfinityMobile.view.tablet.ReaderSpecialArchive";switch(currentProfile){case"phone":j="InfinityMobile.view.phone.ReaderSpecialArchive";break;case"desktop":j="InfinityMobile.view.desktop.ReaderSpecialArchive";break;case"tablet":j="InfinityMobile.view.tablet.ReaderSpecialArchive";break;default:j="InfinityMobile.view.tablet.ReaderSpecialArchive";break}var h=Ext.create(j,{editions:g,desc:e.config.desc,titleText:e.config.text});Ext.Viewport.add(h);h.show()};if(d.editions[e.config.pubid]==null){Ext.Viewport.setMasked({xtype:"loadmask",message:"Loading",zIndex:99999999999});var a="&lm="+latestLM;var c="../../editionshtml5_json.aspx?publicationguid="+e.config.pubid+"&maxnumber=30"+a+"";$.ajax({url:c,success:function(g){if(g!=null&&g.editions!=null&&g.editions.edition){d.editions[e.config.pubid]=g.editions.edition;f(d.editions[e.config.pubid])}Ext.Viewport.setMasked(false)}})}else{f(d.editions[e.config.pubid])}},extraArchive:function(e,b){var d=this;var f=function(l){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("archive")}try{var k=d.getReaderArchive();d.closeArchive(k)}catch(h){var g=d.getReaderSpecialArchive();d.closeSpecialArchive(g)}d.disableArticlesContainer();var m="InfinityMobile.view.tablet.ReaderSpecialArchive";switch(currentProfile){case"phone":m="InfinityMobile.view.phone.ReaderSpecialArchive";break;case"desktop":m="InfinityMobile.view.desktop.ReaderSpecialArchive";break;case"tablet":m="InfinityMobile.view.tablet.ReaderSpecialArchive";break;default:m="InfinityMobile.view.tablet.ReaderSpecialArchive";break}var j=Ext.create(m,{editions:l,titleText:e.config.text});Ext.Viewport.add(j);j.show()};if(d.editions[e.config.pubid]==null){Ext.Viewport.setMasked({xtype:"loadmask",message:"Loading",zIndex:99999999999,cls:"archive-spinner"});var a="&lm="+latestLM;var c="../../editionshtml5_json.aspx?publicationguid="+e.config.pubid+"&maxnumber=30"+a+"";$.ajax({url:c,success:function(g){if(g!=null&&g.editions!=null&&g.editions.edition){d.editions[e.config.pubid]=g.editions.edition;f(d.editions[e.config.pubid])}Ext.Viewport.setMasked(false)}})}else{f(d.editions[e.config.pubid])}},menuPuzzles:,0,0,0,0,0,0,[InfinityMobile.controller,"ReaderMenuController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderSearchController",Ext.app.Controller,{config:{stores:["SearchStore"],refs:{readerPanel:"reader",mainPanel:"#rootPanel",searchPanel:"search",searchItem:"searchItem",carousel:"infinitecarousel2d",articlescontainer:"articlescontainer"},control:{mainPanel:{toolbarSearch:"toolbarSearch",showSearch:"showSearch",loadPageSearchResults:"loadPageSearchResults"},searchPanel:{close:"close",search:"search",searchCurrentEdition:"searchCurrentEdition",searchAllEditions:"searchAllEditions",showSearchDate:"showSearchDate",searchDate:"searchDate",enableArticlesContainer:"enableArticlesContainer",searchPreviousResults:"searchPreviousResults",searchInit:"searchInit",previousPage:"previousPage",nextPage:"nextPage"},searchItem:{click:"selectSearchItem"}}},init:function(){var b=this;b.forceCancel=false;b.searchPageNo=0;b.currentSearch;b.currentSearchType;var a=Ext.getStore("SearchStore");a.on({load:"searchLoad",scope:this})},searchInit:function(a){var e=this;e.searchType="current";if(localStorage.getItem("previousSearch"+publicationguid)){var d=localStorage.getItem("previousSearch"+publicationguid);var d=JSON.parse(d);if((d.local&&d.edition==editionguid)||(!d.local&&d.searchType!="current")){if(d.local){a.searchType="e"}else{a.searchType="p"}e.searchType=d.searchType;var b=Ext.getStore("SearchStore");var c={search:{results:d.results}};var a=e.getSearchPanel();a.searchTermBox.setValue(d.term);a.searchTerm=d.term;b.data.items[0]={raw:c};e.searchLoad(b)}}},close:function(a){a.hide()},toolbarSearch:function(){var a=this;a.showSearch("")},showSearch:function(b){var c=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"search icon"})}c.disableArticlesContainer();if(c.searchContainer!=null){c.searchContainer.show()}else{var d="InfinityMobile.view.tablet.ReaderSearch";switch(currentProfile){case"phone":d="InfinityMobile.view.phone.ReaderSearch";break;case"desktop":d="InfinityMobile.view.desktop.ReaderSearch";break;case"tablet":default:d="InfinityMobile.view.tablet.ReaderSearch";break}var a=Ext.create(d,{searchTerm:b});Ext.Viewport.add(a);a.show();c.searchContainer=a}},search:function(){var q=this;var a=q.getSearchPanel();var p=a.searchTerm;q.hideSearchDate();if(p!=""){var e=a.searchType;var r=a.searchResultsContainer;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("search",{search:p,searchType:a.searchType,dateFrom:a.dateFrom,dateTo:a.dateTo})}var d=0;if(p==q.currentSearch&&q.currentSearchType==e){d=q.searchPageNo}else{q.searchPageNo=d}var b="../../searchjson.aspx?q="+encodeURIComponent(p)+"&eid="+editionguid+"&t="+e+"&p="+d+"&rp=100&f=100&s=r&version="+version;if(e=="d"){var l=a.dateFrom;var f=a.dateTo;if(typeof isTribReader!="undefined"){if(isTribReader){var h=l.split("-");l=h[2]+"-"+h[0]+"-"+h[1];var s=f.split("-");f=s[2]+"-"+s[0]+"-"+s[1]}}if(settings.menu.useAmericanDateFormat!=null&&settings.menu.useAmericanDateFormat=="true"){if(currentProfile=="desktop"){var h=l.split("-");l=h[2]+"-"+h[0]+"-"+h[1];var s=f.split("-");f=s[2]+"-"+s[0]+"-"+s[1]}}if(settings.menu.dateFormat!=null){l=a.dateFrom;f=a.dateTo;var k=convertDateFormat(settings.menu.dateFormat);var c;if(k.indexOf(".")!=-1){c="."}else{if(k.indexOf("-")!=-1){c="-"}}var g=k.split(c);var m=l.split(c);var j=f.split(c);l="";var h=[];var s=[];f="";for(var n=0;n<g.length;n++){if(g[n].toLowerCase()=="dd"){h[2]=m[n];s[2]=j[n]}else{if(g[n].toLowerCase()=="mm"){h[1]=m[n];s[1]=j[n]}else{if(g[n].toLowerCase()=="yy"){h[0]=m[n];s[0]=j[n]}}}}l=h[0]+"-"+h[1]+"-"+h[2];f=s[0]+"-"+s[1]+"-"+s[2]}b="../../searchjson.aspx?q="+p+"&eid="+editionguid+"&t="+e+"&dfrom="+l+"&dto="+f+"&p="+d+"&rp=100&f=100&s=r&version="+version}switch(e){case"e":mainPanel.fireEvent("searchCurrentEdition",p);q.searchType="current";break;case"p":mainPanel.fireEvent("searchAllEditions",p);q.searchType="all";break;case"d":mainPanel.fireEvent("searchDate",p,l,f);q.searchType="date";break}q.currentSearchType=e;var o=Ext.getStore("SearchStore");o.setProxy({url:b});o.removeAll(true);o.load();q.searchMask=Ext.create("InfinityMobile.view.ReaderSearchLoadingMask",{scope:q,cancelClick:function(){q.cancelSearch()}});a.add(q.searchMask)}},cancelSearch:function(){var a=this;try{a.forceCancel=true;if(!a.searchMask.isDestroyed){a.searchMask.destroy()}Ext.Ajax.abort()}catch(b){console.error(b)}},searchCurrentEdition:function(){var b=this;var a=b.getSearchPanel();a.searchType="e";b.search()},searchAllEditions:showSearchDate:hideSearchDate:searchDate:searchLoad:function(e){var r=this;if(!r.forceCancel){var a=r.getSearchPanel();var s=a.searchResultsContainer;s.removeAll(true);if(a!=null){if(e.data.items[0]!=null){if(e.data.items[0].raw.search!=null&&e.data.items[0].raw.search.results!=null){var s=a.searchResultsContainer;s.removeAll(true);a.previousSearch=[];var n=e.data.items[0].raw.search.results;var d=n["@hitCount"];var f=Math.ceil(d/200);r.currentSearch=a.searchTerm;if(n.result!=null){if(settings.menu.searchStoreLastResults=="true"){var q=false;if(r.searchType=="current"){q=true}var p=a.searchTerm;var k={term:p,local:q,edition:editionguid,results:n,searchType:r.searchType};localStorage.setItem("previousSearch"+publicationguid,JSON.stringify(k))}if(!a.hasSearched){a.hasSearched=true;if(settings.menu!=null&&settings.menu.searchLastResults=="true"){a.searchLastResultsInput.setDisabled(false)}}var j=n.result;if(!$.isArray(j)){var c=Ext.create("InfinityMobile.view.ReaderSearchItem",{pageNumber:j["@pnum"],offsetNum:j["@offsetPnum"],name:j["@name"],editionGuid:j["@eid"],textString:j["#text"],searchType:a.searchType});var o={pageNumber:j["@pnum"],offsetNum:j["@offsetPnum"],name:j["@name"],editionGuid:j["@eid"],textString:j["#text"],searchType:a.searchType};a.previousSearch.push(o);s.add(c)}else{for(var m=0;m<j.length;m++){var l=j[m];var c=Ext.create("InfinityMobile.view.ReaderSearchItem",{pageNumber:l["@pnum"],offsetNum:l["@offsetPnum"],name:l["@name"],editionGuid:l["@eid"],textString:l["#text"],searchType:a.searchType});var o={pageNumber:l["@pnum"],offsetNum:l["@offsetPnum"],name:l["@name"],editionGuid:l["@eid"],textString:l["#text"],searchType:a.searchType};a.previousSearch.push(o);s.add(c)}}if(f>1){r.setupPagination(e,f,a)}else{a.pageNavArea.hide()}}else{var g="No results to display. Please try another search term.";if(language.search!=null&&language.search.noResults!=null){g=language.search.noResults}s.add({padding:20,html:g});a.pageNavArea.hide()}if(currentProfile=="desktop"&&Ext.browser.is.IE&&(navigator.msMaxTouchPoints==null||navigator.msMaxTouchPoints==0)){if(a.searchResultsContainer!=null){}}}else{if(e.data.items[0].raw.Error!=null){var h=Ext.create("InfinityMobile.view.ReaderPrompt",{title:e.data.items[0].raw.Error,message:e.data.items[0].raw.Message});h.show();a.pageNavArea.hide()}}}else{if(e.data.items[0]!=null&&e.data.items[0].raw!=null&&e.data.items[0].raw.Error!=null){var h=Ext.create("InfinityMobile.view.ReaderPrompt",{title:e.data.items[0].raw.Error,message:e.data.items[0].raw.Message});Ext.Viewport.add(h);h.show();a.pageNavArea.hide()}else{var b=typeof language!="undefined"&&language.errorMsg!=null?language.errorMsg:"Sorry, an error has occured";var h=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:b});Ext.Viewport.add(h);h.show();a.pageNavArea.hide()}}}}else{r.forceCancel=false}if(!r.searchMask.isDestroyed&&!r.searchMask.isDestroying){r.searchMask.setStyle("opacity: 0");r.searchMask.getModal().setStyle("opacity: 0");setTimeout(function(){r.searchMask.destroy()},1000)}if(currentProfile!="desktop"){r.setupScroller(s)}},setupScroller:function(a){if(Ext.browser.is.Firefox&&Ext.os.is.Android){a.setupNativeScrolling()}else{a.setupSenchaScroller()}},setupPagination:function(c,a,b){var e=this;b.pageNavArea.show();b.pageNavContainer.removeAll();for(var d=0;d<a;d++){var f=Ext.create("Ext.Container",{html:d+1,height:"100%",width:"auto",pageNum:d,margin:"0px 10px",style:"cursor: pointer;"});if(d==e.searchPageNo){f.element.dom.className+=" active-search-page";f.element.dom.style.color="rgba(69, 143, 187, 1)"}f.element.on({tap:function(){e.searchPageNo=this.config.pageNum;e.search()},scope:f});b.pageNavContainer.add(f)}},_OBSELETE_selectSearchItem:function(d){var e=this;if(d.editionGuid==editionguid){var a=e.getCarousel();var c=parseInt(d.pageNumber)-1;if(settings.reader!=null&&settings.reader.reverse=="true"){c=(a.getData().length-1)-c}c=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[c]!=null?flatPlanData.pdfPages[c].pages[0].pageNum-1:c;a.jumpToPage(c);e.loadPageSearchResults(c)}else{if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){window.parent.postMessage({type:"openEdition",editionguid:d.editionGuid,pagenumber:d.pageNumber},"*")}}else{window.location.href=location.protocol+"//"+location.host+"/launch.aspx?eid="+d.editionGuid+"&pnum="+d.pageNumber}}var b=e.getSearchPanel();e.close(b)},_OBSELETE_loadPageSearchResults:function(l,n){var h=this;var a="";var e="";if(l%2==1){a=l+pageOffset;e=l+1+pageOffset}else{e=l+pageOffset;a=l-1+pageOffset}if(flatPlanData.pdfPages!=null){a=flatPlanData.pdfPages[a]!=null?flatPlanData.pdfPages[a].pages[0].pageIndex-1:0;e=flatPlanData.pdfPages[e]!=null?flatPlanData.pdfPages[e].pages[0].pageIndex-1:0}else{a=editionFlatplanData.pageMapper[a+1]-1;e=editionFlatplanData.pageMapper[e+1]-1}var b=editionFlatplanData.pageGroups;var j="";if(a>=0&&b[a]!=null){var k=b[a].pages[0];j=h.retrievePageGuid(k)}var m="";if(e<=(b.length-2)&&b[e]!=null){var g=b[e].pages[0];m=h.retrievePageGuid(g)}var d=h.getSearchPanel();var f;if(d){f=d.searchTerm}else{f=n}var c=Ext.getStore("SearchHighlightStore");c.leftPageNumber=a;c.rightPageNumber=e;c.leftPageGuid=j;c.rightPageGuid=m;c.term=f;c.setProxy({url:"../../searchhighlight.aspx?leftpageguid="+j+"&rightpageguid="+m+"&term="+f});c.load()},selectSearchItem:function(e){var f=this;var d=f.getSearchPanel();var h=settings&&settings.menu;var b=h&&h.searchResultsInNewTab;if(e.editionGuid==editionguid){var a=f.getCarousel();var c=parseInt(e.pageNumber)-1;if(settings.reader!=null&&settings.reader.reverse=="true"){c=(a.getData().length-1)-c}c=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[c]!=null?flatPlanData.pdfPages[c].pages[0].pageNum-1:c;a.jumpToPage(c);f.loadPageSearchResults(parseInt(e.pageNumber));f.close(d)}else{if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){window.parent.postMessage({type:"openEdition",editionguid:e.editionGuid,pagenumber:e.pageNumber},"*")}f.close(d)}else{var g=location.protocol+"//"+location.host+"/launch.aspx?eid="+e.editionGuid+"&pnum="+e.pageNumber;if(b!=null&&b=="true"){g+="&search="+(d?d.searchTerm:"");window.open(g,"_blank")}else{window.location.href=g;f.close(d)}}}},loadPageSearchResults:function(o,r){if(flatPlanData.pdfPages==null){return}o=parseInt(o);if(o<1){o=1}var k=flatPlanData.pdfPages.length;if(o>k){o=k}if(settings.reader!=null&&settings.reader.reverse=="true"){o=(k-o)+1}k=undefined;var m=this;var c=null;var f=null;if(o%2==1){f=o;c=o-1}else{c=o;f=o+1}var p=flatPlanData.pdfPages[c-1]!=null?flatPlanData.pdfPages[c-1]:null;var a=flatPlanData.pdfPages[f-1]!=null?flatPlanData.pdfPages[f-1]:null;var j=!!p?(p.pages[0].pageIndex-1):null;var l=!!a?(a.pages[0].pageIndex-1):null;c=j;f=l;var h=j!=null?flatPlanData.pageGroups[j]:null;var b=l!=null?flatPlanData.pageGroups[l]:null;var n=!!h?m.retrievePageGuid(h.pages[0]):"";var q=!!b?m.retrievePageGuid(b.pages[0]):"";var e=m.getSearchPanel();var g;if(e){g=e.searchTerm}else{g=r}var d=Ext.getStore("SearchHighlightStore");d.leftPageNumber=c;d.rightPageNumber=f;d.leftPageGuid=n;d.rightPageGuid=q;d.term=g;d.setProxy({url:"../../searchhighlight.aspx?leftpageguid="+n+"&rightpageguid="+q+"&term="+g});d.load()},retrievePageGuid:disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},searchPreviousResults:function(){var j=this;var a=j.getSearchPanel();var b=a.searchTerm;if(a!=null&&b!=null&&b.length>0){var d="Searching";if(language.search!=null&&language.search.searching!=null){d=language.search.searching}a.setMasked({xtype:"loadmask",message:d});var h=a.searchResultsContainer;var f=a.previousSearch;var e=j.returnResults(f,b);if(e!=null&&e.length>0&&h!=null){h.removeAll();for(var c in e){h.add(e[c])}}else{h.removeAll();var g="No results to display. Please try another search term.";if(language.search!=null&&language.search.noResults!=null){g=language.search.noResults}h.add({padding:20,html:g})}a.setMasked(false);if(currentProfile!="desktop"){j.setupScroller(searchPanelItemsContainer)}}},returnResults:function(l,c){var j=this;var d=[];for(var e in l){var a=l[e];var n=a.textString;if(n.toLowerCase().indexOf(c.toLowerCase())!=-1){var h="<b>";var m="</b>";var k=n.toLowerCase().indexOf(c.toLowerCase());var f=k+c.length+h.length;var b=a.textString.splice(k,0,h).splice(f,0,m);var g=Ext.create("InfinityMobile.view.ReaderSearchItem",{pageNumber:a.pageNumber,name:a.name,editionGuid:a.editionGuid,textString:b,searchType:a.searchType});d.push(g)}}return d},previousPage:function(d){var f=this;if(f.searchPageNo!=null&&f.searchPageNo>0){f.searchPageNo-=1;var c=d.pageNavContainer;var e=c.getItems().items;var a=c.getScrollable().getScroller();var g=e[f.searchPageNo];var h=a.position.x;var b=g.element.dom.offsetLeft;if(b<h){a.scrollTo(Math.min((b),a.maxPosition.x),0)}f.search()}},nextPage:function(c){var g=this;if(g.searchPageNo<c.pageNavContainer.getItems().items.length-1){g.searchPageNo+=1;var a=c.pageNavContainer;var f=a.getItems().items;var e=a.getScrollable().getScroller();var d=f[g.searchPageNo];var h=e.position.x;var b=e.container.dom.clientWidth;var j=d.element.dom.clientWidth;var k=d.element.dom.offsetLeft;if(k-j>h){e.scrollTo(Math.max((k+j)-b,e.minPosition.x),0)}g.search()}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderSearchController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderDownloadController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel",reader:"reader",carousel:"infinitecarousel2d",readerDownload:"download",readerDownloadItem:"downloaditem",articlescontainer:"articlescontainer",readerDownloadScreen:"downloadscreen",articlescontainer:"articlescontainer"},control:{mainPanel:{showDownload:"showDownload"},readerDownload:{close:"closeDownload",selectAll:"selectAll",selectNone:"selectNone",download:"download",enableArticlesContainer:"enableArticlesContainer",loadPages:"loadPages"},readerDownloadItem:{toggleCheckBox:"toggleCheckBox"},readerDownloadScreen:{back:"closeDownloadScreen"}}},init:function(){},showDownload:function(){var e=this;e.disableArticlesContainer();var f="InfinityMobile.view.tablet.ReaderDownload";switch(currentProfile){case"phone":f="InfinityMobile.view.phone.ReaderDownload";break;case"desktop":f="InfinityMobile.view.desktop.ReaderDownload";break;case"tablet":default:f="InfinityMobile.view.tablet.ReaderDownload";break}var a=Ext.create(f,{});Ext.Viewport.add(a);a.show();if(settings.menu.downloadStartType=="allSelected"){var b=e.getAllDownloadItems(a);for(var d=0;d<b.length;d++){var c=b[d];c.fireEvent("checkCheckBox",c)}}},closeDownload:function(a){a.hide()},selectAll:function(b){var e=this;var a=e.getAllDownloadItems(b);for(var d=0;d<a.length;d++){var c=a[d];c.fireEvent("checkCheckBox",c)}},selectNone:function(b){var e=this;var a=e.getAllDownloadItems(b);for(var d=0;d<a.length;d++){var c=a[d];c.fireEvent("uncheckCheckBox",c)}},getAllDownloadItems:function(a){return a.downloadItemsContainer.getItems().items},download:function(h){var j=this;var d=j.getAllDownloadItems(h);var k="";for(var f=0;f<d.length;f++){var g=d[f];if(j.getCheckedStatus(g)){var e=g.getPageIndex();if(settings.reader!=null&&settings.reader.reverse=="true"){e=d.length-e+1}if(k!=""){k+="|"}k+=(e)}}if(k!=""){var a="Scheduling PDFs";if(typeof language!=null&&language.download!=null&&language.download.scheduleMessage!=null){a=language.download.scheduleMessage}h.setMasked({xtype:"loadmask",message:a});j.downloadPDF(k);mainPanel.fireEvent("trackDownload");mainPanel.fireEvent("download",k)}else{var c="Please select the page(s) that you would like to download";if(typeof language!="undefined"&&language.download!=null&&language.download.downloadSelectPrompt!=null){c=language.download.downloadSelectPrompt}var b=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:c});Ext.Viewport.add(b);b.show()}if(typeof trackDaEvent!="undefined"){trackDaEvent("Download Edition","Digital Edition")}if(typeof trackReaderEvent!="undefined"){if(k!=null&&k!=""){trackReaderEvent("download",{downloadedPages:k.split("|")})}}},downloadPDF:postPages:function(c){var b=this;var a="../../Queue_PDF.aspx";$.ajax({crossDomain:true,type:"POST",contentType:"text/plain",data:c,async:true,url:a,cache:false,success:function(d){if(d.indexOf("http://")!=-1||d.indexOf("https://")!=-1){b.schedulePDF(d)}},error:)},schedulePDF:function(a){var b=this;$.ajax({crossDomain:true,type:"GET",async:true,url:a,cache:false,success:function(e){var c=b.getReaderDownload();c.setMasked(false);var d='Your PDF request is being prepared. Please click "Ok" to continue';if(typeof language!=null&&language.download!=null&&language.download.prepareMessage!=null){d=language.download.prepareMessage}if(settings.reader.openDownloadsInNewTab!=null&&settings.reader.openDownloadsInNewTab=="true"){var f=Ext.create("InfinityMobile.view.DownloadPrompt",{message:d,url:a})}else{b.showDownloadScreen(a)}},error:function(f){var c=b.getReaderDownload();if(c!=null){c.setMasked(false)}var e="There was an error with your download request. Please try again later";if(typeof language!=null&&language.download!=null&&language.download.errorMessage!=null){e=language.download.errorMessage}var d=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:e});Ext.Viewport.add(d);d.show()}})},showDownloadScreen:function(b){var c=this;var a=c.getReaderDownload();a.hide();var d=Ext.create("InfinityMobile.view.ReaderDownloadScreen",{downloadUrl:b,startingOrientation:c.returnOrientation()});if(c.getArticlescontainer()!=null){c.getArticlescontainer().hideMe()}mainPanel.add(d);mainPanel.setActiveItem(d)},closeDownloadScreen:retrievePageGuid:function(b){var d=this;var a=d.getCarousel().getData();if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.reverse=="true"){b=a.length-b+1}var c=a[b-1];thisActualPage=c.pages[0];return thisActualPage.image.split("/")[5]},loadPages:function(f,b){var h=this;var a=h.getCarousel().getData();var j=a.length;if(typeof loggedIn!="undefined"&&loggedIn.toLowerCase()!="true"&&settings.subscription.pageRestriction!=null){j=parseInt(settings.subscription.pageRestriction.pages)}if((settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")||(settings.reader.reverse=="true")){var c=0;if(typeof loggedIn!="undefined"&&loggedIn.toLowerCase()!="true"&&settings.subscription.pageRestriction!=null){c=a.length-settings.subscription.pageRestriction.pages}for(var e=a.length-1;e>=c;e--){var g=h.createDownloadItem(e);if(g!=null){b.add(g)}}}else{if(settings.subscription!=null&&settings.subscription.pageRestriction!=null&&settings.subscription.pageRestriction.type=="unique"){var k=pagesRead;for(var e in k){var d=k[e];var g=h.createDownloadItem(d-1);if(g!=null){b.add(g)}}}else{for(var e=0;e<j;e++){var g=h.createDownloadItem(e);if(g!=null){b.add(g)}}}}},createDownloadItem:function(e){var h=this;var a=h.getCarousel().getData();var f=a[e].pages[0];if(f.type=="page"){var g=f.origPageNum!=null?f.origPageNum:f.pageNum;var c=f.pageIndex;var d=g;if(f.pageName!=null&&f.pageName!=""){d=f.pageName}var b=Ext.create("InfinityMobile.view.ReaderPageThumbnail",{editionGuid:editionguid,pageNo:g,pageIndex:c,displayNum:d,thumbType:"page",toggle:true});return b}},checkCheckBox:function(a){a.editionLabelCheckBox.check()},getCheckedStatus:function(a){return a.labelCheckfield.isChecked()},uncheckCheckBox:toggleCheckBox:returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderDownloadController"],0));(Ext.cmd.derive("InfinityMobile.controller.SubscribeController",Ext.app.Controller,{config:{refs:{main:"#rootPanel",subscribe:"subscribe",login:"login"},control:{main:{checkLogin:"checkLogin"},subscribe:{close:"subscribeClose",login:"subscribeShowLogin",digital:"subscribeDigital",premium:"subscribePremium"},login:{back:"loginBack",login:"tryLogIn"}}},init:function(){},checkLogin:function(){var a=this},showSubscribe:subscribeClose:function(a){a.hide()},subscribeDigital:subscribePremium:subscribe:function(a){var c=this;try{localStorage.setItem("login","someLogin")}catch(b){}c.subscribeClose(a)},subscribeShowLogin:function(a){var b=this;b.subscribeClose(a);b.showLogin()},showLogin:loginBack:function(b){var a=this;a.closeLogin(b);a.showSubscribe()},closeLogin:function(a){a.hide()},tryLogIn:function(){console.log("Logging In")}},0,0,0,0,0,0,[InfinityMobile.controller,"SubscribeController"],0));(Ext.cmd.derive("InfinityMobile.controller.MediaController",Ext.app.Controller,{config:{refs:{main:"main",readerView:"#reader",readerlinkobject:"readerlinkobject",readerarticleobject:"readerarticleobject",readerarticlepopover:"articleview",layouttoolbar:"layouttoolbar",articlecarousel:"articlecarousel",reader:"reader",readerCarousel:"infinitecarousel2d",readerpageviewer:"readerpageviewer",readervideo:"readervideo",readervideocontrols:"readervideocontrols",readerimage:"readerimage",imagegallery:"imagegallery",readerimagelinkobject:"readerimagelinkobject",readervideolinkobject:"readervideolinkobject",readerogalleryobject:"readerogalleryobject",readerovideoobject:"readerovideoobject",zoomSlider:"zoomSlider",sharepopup:"sharepopup",articlereader:"articlereader",articlescontainer:"articlescontainer",imagecarousel:"imagecarousel",lightboxlink:"lightboxlink",readermenutts:"readermenutts",dynamicimagegallery:"dynamicimagegallery",livenewsticker:"livenewsticker",sectionpopup:"sectionpopup",readerMenu:"readermenu"},control:{main:{stopArticleTTS:"stopArticleTTS",loadMediaForPage:"loadMediaForPage",openUrlFrame:"openUrlFrame"},readerpageviewer:{loadMedia:"loadMediaPage",clearMedia:"clearMediaPage",checkAudioOnToggle:"checkAudioOnToggle",reloadGIF:"reloadGIF"},readerlinkobject:{linkClick:"linkClick",setupArticleTooltip:"setupArticleTooltip",hideArticleTooltip:"hideArticleTooltip",updateArticleTooltipPosition:"updateArticleTooltipPosition",popupLink:"popupLinkClick"},readerarticleobject:{setupArticleTooltip:"setupArticleTooltip",hideArticleTooltip:"hideArticleTooltip",updateArticleTooltipPosition:"updateArticleTooltipPosition"},readervideo:{videoloaded:"videoLoaded",timeupdated:"videoTimeUpdated",checkActivePageVideo:"checkActivePageVideo",autoplayVideo:"autoplayVideo"},readervideocontrols:{videoplay:"videoPlay",videofullscreen:"videoFullscreen"},readerimage:{fullscreenImage:"fullscreenImage",linkClick:"linkClick",setupArticleTooltip:"setupArticleTooltip",hideArticleTooltip:"hideArticleTooltip",updateArticleTooltipPosition:"updateArticleTooltipPosition"},imagegallery:{initialized:"galleryinitialized",close:"closegallery",bottomToolbar:"bottomToolbar"},readerimagelinkobject:{lightbox:"lightbox"},readervideolinkobject:{lightbox:"lightbox"},readerarticlepopoveritem:{galleryClickFromArticle:"galleryClickFromArticle",ovideoclicked:"ovideoclicked",galleryClick:"galleryClick",trackOLink:"trackOLink"},readeraudiomediaobject:{playAudio:"playAudio",pauseAudio:"pauseAudio",stopAudio:"stopAudio",checkActivePage:"checkActivePage"},readerogalleryobject:{galleryClick:"galleryClick"},readerogallery:{closeOGallery:"closeOGallery",ogalleryinitialized:"ogalleryinitialized",ogalleryinitializedArticle:"ogalleryinitializedArticle"},readerovideoobject:{ovideoclicked:"ovideoclicked"},readerovideo:{closeOVideo:"closeOVideo",oVideoError:"oVideoError",ovideoinitialized:"ovideoinitialized",trackOVideoPlay:"trackOVideoPlay",trackOVideoComplete:"trackOVideoComplete",trackOVideoPause:"trackOVideoPause",videoInit:"videoInit",preRollStarted:"preRollStarted",preRollEnded:"preRollEnded",preRollSkipped:"preRollSkipped"},readerimagegallerythumb:{navigateGallery:"navigateGallery"},readermediaobject:{triggerMedia:"triggerMedia"},articlePopoverInterstitial:{scaleInterstitial:"scaleInterstitial",scaleInterstitialOnDevice:"scaleInterstitialOnDevice"},lightboxlink:{close:"closeLightBoxLink"},dynamicimagegallery:{galleryVisible:"galleryVisible",galleryInvisible:"galleryInvisible"},sectionpopup:{loadSectionsPopup:"loadSectionsPopup"},readersectionpopupitem:{jumpToSectionPage:"jumpToSectionPage"},readerwebpopoverobject:{openWebpopover:"openWebpopover",webpopoverClosed:"webpopoverClosed"}}},init:function(){var a=this;a.startComic=0;a.startPuzzle=0;a.mediaObjects=new Array();a.mediaStore=Ext.getStore("MediaStore");if(typeof loadMediaEveryPage!="undefined"&&loadMediaEveryPage){a.mediaStore.media={webpopover:[],article:[],link:[],image:[],video:[],vimeo:[],audio:[],flash:[],ogallery:[],olink:[],ovideo:[]}}else{a.mediaStore.on({load:"mediaLoaded",scope:a})}a.searchHighlightStore=Ext.getStore("SearchHighlightStore");a.searchHighlightStore.on({load:"searchHighlightLoaded",scope:a});a.articleStore=Ext.getStore("ArticleStore");a.nextCounter=0;a.previousCounter=0;a.showAdAt=5;a.loadedFirstPage=false;if(Ext.os.is.iOS){a.iOsVoices=[{name:"pt-BR",voiceURI:"pt-BR",lang:"pt-BR",localService:true,"default":true},{name:"fr-CA",voiceURI:"fr-CA",lang:"fr-CA",localService:true,"default":true},{name:"sk-SK",voiceURI:"sk-SK",lang:"sk-SK",localService:true,"default":true},{name:"th-TH",voiceURI:"th-TH",lang:"th-TH",localService:true,"default":true},{name:"ro-RO",voiceURI:"ro-RO",lang:"ro-RO",localService:true,"default":true},{name:"no-NO",voiceURI:"no-NO",lang:"no-NO",localService:true,"default":true},{name:"fi-FI",voiceURI:"fi-FI",lang:"fi-FI",localService:true,"default":true},{name:"pl-PL",voiceURI:"pl-PL",lang:"pl-PL",localService:true,"default":true},{name:"de-DE",voiceURI:"de-DE",lang:"de-DE",localService:true,"default":true},{name:"nl-NL",voiceURI:"nl-NL",lang:"nl-NL",localService:true,"default":true},{name:"id-ID",voiceURI:"id-ID",lang:"id-ID",localService:true,"default":true},{name:"tr-TR",voiceURI:"tr-TR",lang:"tr-TR",localService:true,"default":true},{name:"it-IT",voiceURI:"it-IT",lang:"it-IT",localService:true,"default":true},{name:"pt-PT",voiceURI:"pt-PT",lang:"pt-PT",localService:true,"default":true},{name:"fr-FR",voiceURI:"fr-FR",lang:"fr-FR",localService:true,"default":true},{name:"ru-RU",voiceURI:"ru-RU",lang:"ru-RU",localService:true,"default":true},{name:"es-MX",voiceURI:"es-MX",lang:"es-MX",localService:true,"default":true},{name:"zh-HK",voiceURI:"zh-HK",lang:"zh-HK",localService:true,"default":true},{name:"sv-SE",voiceURI:"sv-SE",lang:"sv-SE",localService:true,"default":true},{name:"hu-HU",voiceURI:"hu-HU",lang:"hu-HU",localService:true,"default":true},{name:"zh-TW",voiceURI:"zh-TW",lang:"zh-TW",localService:true,"default":true},{name:"es-ES",voiceURI:"es-ES",lang:"es-ES",localService:true,"default":true},{name:"zh-CN",voiceURI:"zh-CN",lang:"zh-CN",localService:true,"default":true},{name:"nl-BE",voiceURI:"nl-BE",lang:"nl-BE",localService:true,"default":true},{name:"en-GB",voiceURI:"en-GB",lang:"en-GB",localService:true,"default":true},{name:"ar-SA",voiceURI:"ar-SA",lang:"ar-SA",localService:true,"default":true},{name:"ko-KR",voiceURI:"ko-KR",lang:"ko-KR",localService:true,"default":true},{name:"cs-CZ",voiceURI:"cs-CZ",lang:"cs-CZ",localService:true,"default":true},{name:"en-ZA",voiceURI:"en-ZA",lang:"en-ZA",localService:true,"default":true},{name:"en-AU",voiceURI:"en-AU",lang:"en-AU",localService:true,"default":true},{name:"da-DK",voiceURI:"da-DK",lang:"da-DK",localService:true,"default":true},{name:"en-US",voiceURI:"en-US",lang:"en-US",localService:true,"default":true},{name:"en-IE",voiceURI:"en-IE",lang:"en-IE",localService:true,"default":true},{name:"he-IL",voiceURI:"he-IL",lang:"he-IL",localService:true,"default":true},{name:"hi-IN",voiceURI:"hi-IN",lang:"hi-IN",localService:true,"default":true},{name:"el-GR",voiceURI:"el-GR",lang:"el-GR",localService:true,"default":true},{name:"ja-JP",voiceURI:"ja-JP",lang:"ja-JP",localService:true,"default":true}]}},mediaLoaded:function(b){var c=this;if(b.data.items.length>0){var a=b.data.items[0].raw;b.media=a.media}if(settings.reader.loadMediaOnEveryPage!=null&&settings.reader.loadMediaOnEveryPage=="true"){c.checkEveryPageMedia(b.media)}c.getApplication().getController("ArticlePopoverController").mediaLoaded(b)},checkEveryPageMedia:function(b){var a=this;if(b!=null){if(b.image!=null){a.checkEveryPageMediaType(b.image)}}},checkEveryPageMediaType:function(p){var m=this;var d=p.length;var q=[];var j=0;for(var g=0;g<d;g++){var f=p[g];if(f.param3!=null&&f.param3=="EVERYPAGE"){var e=flatPlanData.pageGroups.length;for(var o=0;o<e;o++){var l=o+1;var c=true;if(f.param4!=null&&f.param4.length>0){var a=f.param4;switch(a.toLowerCase()){case"even":if(l%2==0){c=false}break;case"odd":if(l%2==1){c=false}break;default:var k=a.split(",");var b=k.indexOf(l+"");if(b!=-1){if(k[b]==f.page+""){q.push(g-j);j++}c=false}break}}if(c){var h=jQuery.extend({},f);h.page=l;p.push(h)}}}}for(var n in q){p.splice(n,1,0)}},returnAdvertOffset:loadMediaForPage:function(b,c){var a=this;if(b!=null){if(b.hasLoadedMedia){}else{if(b.isLoadingMedia){}else{a.getMediaForPage(b,c)}}}},getMediaForPage:function(b,c){var a=this;if(b!=null){b.isLoadingMedia=true;$.ajax({url:"../get_media_by_page_no.aspx?pnum="+b.pageNum+"&edid="+editionguid,success:function(d){b.isLoadingMedia=false;b.hasLoadedMedia=true;a.addMediaToStore(d.media);a.mediaLoaded(Ext.getStore("MediaStore"));if(c!=null&&typeof c==="function"){c()}},error:)}},addMediaToStore:function(h){var f=this;if(h!=null){var e=Object.keys(h);for(var d in e){var c=e[d];var b=h[c];if(b!=null){for(var a in b){var g=b[a];f.pushToMediaStore(c,g)}}}}},pushToMediaStore:function(a,c){var d=this;var b=Ext.getStore("MediaStore");var e=b.media[a].find(;if(!e){b.media[a].push(c)}b.media[a].sort(function(g,f){if(parseInt(g.page)>parseInt(f.page)){return 1}else{if(parseInt(g.page)<parseInt(f.page)){return -1}else{return 0}}})},loadMediaPage:function(b,a,h){var f=this;a=a;var e=f.returnAdvertOffset(b.getPageNo());a=a-e;if(typeof loadMediaEveryPage!="undefined"&&loadMediaEveryPage){var d=flatPlanData.pageGroups[a-1];if(d!=null){var g=d.pages[0];if(!g.hasLoadedMedia){f.loadMediaForPage(g,;return}}}if(currentProfile=="desktop"){}if(settings.reader.reverse!=null&&settings.reader.reverse=="true"){a=flatPlanData.pageGroups.length-a+1}f.clearAllExistingMedia(h);var c=document.createDocumentFragment();f.loadWebpopover(f.mediaStore.media,a,c);f.loadArticleMediaPage(f.mediaStore.media,a,h,b,c);f.loadImageMediaPage(f.mediaStore.media,a,h,b,true);f.loadVideoMediaPage(f.mediaStore.media,a,h,b,c);f.loadVimeoMedia(f.mediaStore.media,a,h,b,c);f.loadBrightcoveMedia(f.mediaStore.media,a,h,b,c);f.loadAudioMedia(f.mediaStore.media,a,h,b,c);f.loadHtmlAnim(f.mediaStore.media,a,h,c);f.loadOGallery(f.mediaStore.media,a,h,c);f.loadOVideo(f.mediaStore.media,a,h,c);f.loadOLink(f.mediaStore.media,a,h,c);f.loadLinkMediaPage(f.mediaStore.media,a,h,b,c);f.loadWatermarkMediaPage(f.mediaStore.media,a,h,b,true);h.appendChild(c);f.mediaDiv=h;f.pageNumber=a},reloadGIF:function(b,a,d){var c=this;c.reloadGIFs(d)},reloadGIFs:function(c){for(var b=0;b<c.children.length;b++){var a=c.children[b];var d=a.getElementsByClassName("media-image")[0];if(d!=null&&d.src.indexOf(".gif?cb=")!=-1){d.src=d.src.substring(d.src.indexOf(".gif?cb=")+4,0)+"?cb="+Math.round((new Date()).getTime()/1000)}}},loadVideos:function(b,a,d){var c=this},clearMediaPage:function(b){var a=this;a.clearAllExistingMedia(b)},clearAllExistingMedia:function(d){var a=[];for(var c=0;c<d.children.length;c++){var b=d.children[c];if(b.className.indexOf("searchHighlight")!=-1){a.push(b.cloneNode(true))}}while(d.lastChild){d.removeChild(d.lastChild)}for(var c=0;c<a.length;c++){a[c].style.visibility="visible";d.appendChild(a[c])}},loadOLink:function(a,h,f,c){var g=this;if(a.olink!=null){for(var e=0;e<a.olink.length;e++){var d=a.olink[e];var j=parseInt(d.page);if(j<=h){if(j==h){var b=Ext.create("InfinityMobile.view.ReaderOLinkObject",{mediaObject:d,pageNumber:h});c.appendChild(b.element.dom)}}else{break}if(typeof b!="undefined"){g.mediaObjects.push(b)}}}},loadOGallery:function(a,h,f,c){var g=this;if(a.ogallery!=null){for(var e=0;e<a.ogallery.length;e++){var d=a.ogallery[e];var j=parseInt(d.page);if(j<=h){if(j==h){var b=Ext.create("InfinityMobile.view.ReaderOGalleryObject",{mediaObject:d,pageNumber:h});c.appendChild(b.element.dom)}}else{break}if(typeof b!="undefined"){g.mediaObjects.push(b)}}}},loadOVideo:function(a,h,f,c){var g=this;if(a.ovideo!=null){for(var e=0;e<a.ovideo.length;e++){var d=a.ovideo[e];var j=parseInt(d.page);if(j<=h){if(j==h){var b=Ext.create("InfinityMobile.view.ReaderOVideoObject",{mediaObject:d,pageNumber:h});c.appendChild(b.element.dom)}}else{break}if(typeof b!="undefined"){g.mediaObjects.push(b)}}}},loadAudioMedia:function(b,k,g,h){var j=this;j.mediaFiles=[];h.audioObjects=[];if(b.audio!=null){for(var f=0;f<b.audio.length;f++){var m=b.audio[f];var c=parseInt(m.page);if(k==c){var e=Ext.create("InfinityMobile.view.ReaderAudioMediaObject",{mediaObject:m,page:h});g.appendChild(e.element.dom);if(h.audioObjects!=null){h.audioObjects[h.audioObjects.length]=e}else{h.audioObjects=[];h.audioObjects[0]=e}var n=m.file;var d=n.substr(0,1);var a=n.substr(1,1);var l="http://source.pagesuite.com/media/"+d+"/"+a+"/"+n+".mp3";j.mediaFiles[j.mediaFiles.length]=l;if(typeof e!="undefined"){j.mediaObjects.push(e);e=null}}}}},loadHtmlAnim:loadArticleMediaPage:function(b,m,h,j,f){var l=this;m=parseInt(m);var k=5;var e=k-1;if(b.article!=null){for(var g=0;g<b.article.length;g++){var d=b.article[g];var a=parseInt(d.page);if(a<=m){if(m==a){var c=Ext.create("InfinityMobile.view.ReaderArticleObject",{mediaObject:d,pageNumber:m,articleIndex:d.uniquearticleindex,article:d.file});f.appendChild(c.element.dom)}}else{break}}}},loadLinkMediaPage:function(a,h,e,f,c){var g=this;f.linkObjects=[];h=parseInt(h);if(h==0){g.loadLeftHandLinkMediaPage(e,f)}if(a.link!=null){for(var d=0;d<a.link.length;d++){var k=a.link[d];var j=parseInt(k.page);if(j<=h){if(h==j){if(currentProfile=="desktop"){if(k.x<0&&(h==1||h==0)){if(k.url.indexOf("?liveadvert=yes")!=-1){var b=Ext.create("InfinityMobile.view.ReaderLiveAdvertObject",{pageNumber:h,mediaObject:k,page:e,leftSideOverflow:true})}else{var b=Ext.create("InfinityMobile.view.ReaderLinkObject",{pageNumber:h,mediaObject:k,page:e,leftSideOverflow:true})}f.overflowMediaDiv.add(b)}else{if(k.url!=null&&k.url.indexOf("?liveadvert=yes")!=-1){var b=Ext.create("InfinityMobile.view.ReaderLiveAdvertObject",{pageNumber:h,mediaObject:k,page:e})}else{var b=Ext.create("InfinityMobile.view.ReaderLinkObject",{pageNumber:h,mediaObject:k,page:e})}c.appendChild(b.element.dom)}}else{if(k.url.indexOf("?liveadvert=yes")!=-1){var b=Ext.create("InfinityMobile.view.ReaderLiveAdvertObject",{pageNumber:h,mediaObject:k,page:e})}else{var b=Ext.create("InfinityMobile.view.ReaderLinkObject",{pageNumber:h,mediaObject:k,page:e})}c.appendChild(b.element.dom)}}}else{break}if(typeof b!="undefined"){g.mediaObjects.push(b);f.linkObjects.push(b)}}}},loadWebpopover:function(g,a,b){var d=this;if(g.webpopover!=null){for(var c=0;c<g.webpopover.length;c++){var h=g.webpopover[c];var e=parseInt(h.page);if(e<=a){if(e==a){var f=Ext.create("InfinityMobile.view.ReaderWebpopoverObject",{mediaObject:h,pageNumber:e});b.appendChild(f.element.dom)}}else{break}if(typeof f!="undefined"){d.mediaObjects.push(f)}else{}}}},loadLeftHandLinkMediaPage:loadImageMediaPage:function(e,q,l,o,p){var s=this;q=parseInt(q);l.imageObjects=[];var k=0;if(o.overflowMediaDiv!=null&&p){o.overflowMediaDiv.removeAll()}if(e.image!=null){for(var m=0;m<e.image.length;m++){var r=e.image[m];var h=parseInt(r.page);var b={};var f=0;for(var g=0;g<e.link.length;g++){var n=parseFloat(r.x)+parseFloat(r.width);var d=parseFloat(r.y)+parseFloat(r.height);var c=parseFloat(e.link[g].x)+parseFloat(e.link[g].width);var j=parseFloat(e.link[g].y)+parseFloat(e.link[g].height);if((parseFloat(e.link[g].x)>=parseFloat(r.x)&&parseFloat(e.link[g].x)<=parseFloat(n))&&(parseFloat(e.link[g].y)>=parseFloat(r.y)&&parseFloat(e.link[g].y)<=parseFloat(d))){b[f]=e.link[g];f++}}if(e.image[m].url!="http://LIGHTBOX"){if(q==h){if(currentProfile=="desktop"){if(r.x<0&&(q==1||q==0)){var a=Ext.create("InfinityMobile.view.ReaderImageObject",{mediaObject:r,pageNumber:q,page:l,links:b,leftSideOverflow:true});o.overflowMediaDiv.show();o.overflowMediaDiv.add(a)}else{var a=Ext.create("InfinityMobile.view.ReaderImageObject",{mediaObject:r,pageNumber:q,page:l,links:b});l.appendChild(a.element.dom)}}else{var a=Ext.create("InfinityMobile.view.ReaderImageObject",{mediaObject:r,pageNumber:q,page:l,links:b});l.appendChild(a.element.dom)}k++}}else{if(q==h){var a=Ext.create("InfinityMobile.view.ReaderImageLinkObject",{mediaObject:r});l.appendChild(a.element.dom);k++;r.imageObject=a}}if(typeof a!="undefined"){s.mediaObjects.push(a)}}}},loadWatermarkMediaPage:function(f,r,l,p,q){var s=this;r=parseInt(r);l.watermrakObjects=[];var k=0;if(f.watermark!=null){for(var m=0;m<f.watermark.length;m++){var c=f.watermark[m];var o=parseInt(c.page);var b={};var g=0;for(var h=0;h<f.link.length;h++){var n=parseFloat(c.x)+parseFloat(c.width);var e=parseFloat(c.y)+parseFloat(c.height);var d=parseFloat(f.link[h].x)+parseFloat(f.link[h].width);var j=parseFloat(f.link[h].y)+parseFloat(f.link[h].height);if((parseFloat(f.link[h].x)>=parseFloat(c.x)&&parseFloat(f.link[h].x)<=parseFloat(n))&&(parseFloat(f.link[h].y)>=parseFloat(c.y)&&parseFloat(f.link[h].y)<=parseFloat(e))){b[g]=f.link[h];g++}}if(r==o){if(currentProfile=="desktop"){if(c.x<0&&(r==1||r==0)){var a=Ext.create("InfinityMobile.view.ReaderWatermarkObject",{mediaObject:c,pageNumber:r,page:l,links:b,leftSideOverflow:true});p.overflowMediaDiv.show();p.overflowMediaDiv.add(a)}else{var a=Ext.create("InfinityMobile.view.ReaderWatermarkObject",{mediaObject:c,pageNumber:r,page:l,links:b});l.appendChild(a.element.dom)}}else{var a=Ext.create("InfinityMobile.view.ReaderWatermarkObject",{mediaObject:c,pageNumber:r,page:l,links:b});l.appendChild(a.element.dom)}k++}if(typeof a!="undefined"){s.mediaObjects.push(a)}}}},fullscreenImage:galleryinitialized:closegallery:loadVideoMediaPage:function(a,k,f,h){var j=this;k=parseInt(k);if(f.videoObjects==null){f.videoObjects=[];var b=1}else{var b=f.videoObjects.length}if(a.video!=null){for(var d=0;d<a.video.length;d++){var g=a.video[d];var e=parseInt(g.page);if(a.video[d].param3!="LIGHTBOX"){if(e<=k){if(k==e){if(currentProfile=="desktop"){if(g.x<0&&(k==1||k==0)){var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f,leftSideOverflow:true});h.overflowMediaDiv.show();h.overflowMediaDiv.add(c);h.mp4Objects[h.mp4Objects.length]=c}else{var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c}}else{var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c}b++;g.videoObject=c}}else{break}}else{if(k==e){var c=Ext.create("InfinityMobile.view.ReaderVideoLinkObject",{mediaObject:g});f.appendChild(c.element.dom);b++;g.videoObject=c}}if(typeof c!="undefined"){j.mediaObjects.push(c)}}}},loadBrightcoveMedia:function(a,k,f,h){var j=this;k=parseInt(k);if(f.videoObjects==null){f.videoObjects=[];var b=1}else{var b=f.videoObjects.length}if(a.brightcove!=null){for(var d=0;d<a.brightcove.length;d++){var g=a.brightcove[d];var e=parseInt(g.page);if(a.brightcove[d].param3!="LIGHTBOX"){if(e<=k){if(k==e){if(currentProfile=="desktop"){if(g.x<0&&(k==1||k==0)){var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f,leftSideOverflow:true,type:"brightcove"});h.overflowMediaDiv.show();h.overflowMediaDiv.add(c);h.mp4Objects[h.mp4Objects.length]=c}else{var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f,type:"brightcove"});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c}}else{var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f,type:"brightcove"});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c}b++;g.videoObject=c}}else{break}}else{if(k==e){var c=Ext.create("InfinityMobile.view.ReaderVideoLinkObject",{mediaObject:g,type:"brightcove"});f.appendChild(c.element.dom);b++;g.videoObject=c}}if(typeof c!="undefined"){j.mediaObjects.push(c)}}}},loadVimeoMedia:function(a,k,f,h){var j=this;k=parseInt(k);if(f.videoObjects==null){f.videoObjects=[];var b=1}else{var b=f.videoObjects.length}if(a.vimeo!=null){for(var d=0;d<a.vimeo.length;d++){var g=a.vimeo[d];var e=parseInt(g.page);if(a.vimeo[d].param3!="LIGHTBOX"){if(e<=k){if(k==e){if(currentProfile=="desktop"){if(g.x<0&&(k==1||k==0)){var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f,leftSideOverflow:true});h.overflowMediaDiv.show();h.overflowMediaDiv.add(c);h.mp4Objects[h.mp4Objects.length]=c}else{var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c}}else{var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c}b++;g.videoObject=c}}else{break}}else{if(k==e){var c=Ext.create("InfinityMobile.view.ReaderVideoLinkObject",{mediaObject:g});f.appendChild(c.element.dom);b++;g.videoObject=c}}if(typeof c!="undefined"){j.mediaObjects.push(c)}}}},videoLoaded:function(f){var d=this;var b=f.video.duration;var a=Math.floor(b/60);var e=Math.floor(b-(a*60));if(e<10){e="0"+e}var c=f.videoControls.totalTime;c.dom.innerHTML=a+":"+e},videoTimeUpdated:videoPlay:videoFullscreen:getSectionName:function(a){var c=this;var e=settings.bookmarks.bookmark;var d=null;if(e!=null&&e.length>0){for(var b in e){if(a>=e[b].pageNumber&&(e[parseInt(b)+1]==null||a<e[parseInt(b)+1].pageNumber)){d=e[b].name;break}}}return d},linkClick:function(n,g){var w=this;var s=this.getReaderCarousel();if(!isNaN(g)){var d=g-1;if(settings.reader.reverse!=null&&settings.reader.reverse=="true"){d=flatPlanData.pageGroups.length-d-1}var k=0;try{k=w.getApplication().getController("LayoutController").getAdvertsOffset(d)}catch(m){console.warn("Advert offset not found.\n",m)}s.jumpToPage(d+k);var h=s.getActiveItem();if(typeof trackReaderEvent!="undefined"){var v=n.mediaObject.page;var j=w.getSectionName(v);trackReaderEvent("jumpToPage",{url:g,pageNum:v,section:j})}}else{if(g.indexOf("mailto:")!=-1||g.indexOf("tel:")!=-1){if(g.indexOf("tel:")!=-1){if(Ext.os.is.iOS){window.location.href=g}else{var f=window.open(g,"_blank");setTimeout(function(){f.close()},200)}}else{if(Ext.browser.userAgent.indexOf("CrOS")!=-1){window.open(g)}else{window.location.href=g}}if(typeof trackReaderEvent!="undefined"){var v=n.mediaObject.page;var j=w.getSectionName(v);trackReaderEvent("link",{url:g,pageNum:v,section:j})}}else{var b=g.split("//");var a=b[1];var u=n.pageNumber;var o="page"+u+a;var q=false;var e="";var r=Ext.getStore("MediaStore");if(a.indexOf("video")!=-1){var l=parseInt(a.replace("video",""))-1;if(r.media.video.length>l&&r.media.video[l].videoObject!=null){e=r.media.video[l].videoObject;q=true}}else{if(a.indexOf("image")!=-1){var t=parseInt(a.replace("image",""))-1;if(r.media.image.length>t&&r.media.image[t].imageObject!=null){e=r.media.image[t];q=true}}else{if(a.indexOf("animation")!=-1){var c=n.page.animObjects}}}if(e!=""){if(e.getHidden()){e.show()}}if(g.includes("http://section:")){var j=g.split("http://section:")[1];var p=w.getApplication().getController("LayoutController").getSectionPageNumber(j);p+=w.getApplication().getController("LayoutController").getAdvertsOffset(p+1);if(s._mode=="double"){p=flatPlanData.pageMapper[p+1]-1}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){p=flatPlanData.pageGroups.length-p-1}s.jumpToPage(p)}else{if(!q){if(typeof trackReaderEvent!="undefined"){var v=n.mediaObject.page;var j=w.getSectionName(v);trackReaderEvent("link",{url:g,pageNum:v,section:j})}window.open(g,"_blank")}}}}},popupLinkClick:closeLightBoxLink:bottomToolbar:clickPage:lightbox:function(d,f,a,b){var c=this;var e=Ext.create("InfinityMobile.view.ReaderLightbox",{mediaObject:f,mediaType:a,type:b});Ext.Viewport.add(e);e.show()},createClipping:clippingMenu:DeleteClippings:playAudio:pauseAudio:stopAudio:searchHighlightLoaded:searchHighlightPage:function(b,h,l,a){var g=this;var f;if(currentProfile=="desktop"){var k=l.getImageContainer(h+1-pageOffset);if(k!=null){f=k.mediaDiv}else{f=null}}else{f=l.returnMediaContainer(h+1)}var j="ffff00";if(settings.menu.searchHighlightColor!=null){j=settings.menu.searchHighlightColor}if(f!=null&&a!=null){if(a.length!=null){for(var d=0;d<a.length;d++){var e=a[d];if(e["@side"]==b){e.x=e["@xpos"];e.y=""+(parseFloat(e["@ypos"]));e.width=e["@width"];e.height=e["@height"];e.backgroundColor=j;e.depthIndex=1;e.backgroundAlpha=50;var c=Ext.create("InfinityMobile.view.ReaderMediaObject",{mediaObject:e,pageNumber:h,cls:"searchHighlight"});f.appendChild(c.element.dom)}}}else{var e=a;if(e["@side"]==b){e.x=e["@xpos"];e.y=""+(parseFloat(e["@ypos"]));e.width=e["@width"];e.height=e["@height"];e.backgroundColor=j;e.depthIndex=1;e.backgroundAlpha=50;var c=Ext.create("InfinityMobile.view.ReaderMediaObject",{mediaObject:e,pageNumber:h,cls:"searchHighlight"});f.appendChild(c.element.dom)}}}},closeOGallery:closeOVideo:function(b){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("ovideoclosed",{})}b.destroy();if(a.getArticlescontainer()!=null){a.getArticlescontainer().element.dom.style.visibility="visible"}},emailArticleShare:navigateGallery:setupArticleTooltip:function(e){var a=this;var c=a.getReaderCarousel();if(c!=null){var d=c.getActiveItem();if(d!=null){var b="";if(settings.tooltips!=null){b="background-color:#"+settings.tooltips.backgroundColor+" !important;color:#"+settings.tooltips.color+" !important"}d.tooltip.setHtml('<div style="position:absolute;'+b+'" class="articleTooltip" >'+e+"</div>");d.tooltip.show()}}},hideArticleTooltip:function(a){var c=this;var d=c.getReaderCarousel();if(d!=null){var e=d.getActiveItem();if(e!=null){try{e.tooltip.hide()}catch(b){console.error("[MediaController]:\n",b)}}}},updateArticleTooltipPosition:function(k){var l=this;var m=l.getReaderCarousel();var h=0;if((typeof isTribReader!="undefined"&&isTribReader==true)||settings.reader.enableReaderPadding=="true"){h=150}var a=0;if(settings.wrapAd!=null){h=settings.wrapAd.dualAdvert!=null&&settings.wrapAd.dualAdvert=="left"&&currentProfile=="desktop"?350:200;a=settings.wrapAd.dualAdvert!=null&&settings.wrapAd.dualAdvert=="left"&&currentProfile=="desktop"?175:0}var f=0;if(settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){var g=Ext.Viewport.query("readerbannerad");if(g.length>0){f=g[0].getHeight()}}if(m!=null){var j=m.getActiveItem();if(j!=null){if(k.pageX<($(document).width()/2)+a){var c=(k.pageX+j.scroller.position.x+20-h);var b=(k.clientY+j.scroller.position.y-40)-f;var d="translate3d("+c+"px, "+b+"px, 0) scale3d(1,1,1)";j.tooltip.element.dom.style.webkitTransform=d;j.tooltip.element.dom.style.MozTransform=d;j.tooltip.element.dom.style.msTransform=d}else{var c=(k.clientX+j.scroller.position.x-(j.tooltip.element.dom.scrollWidth+15)-h);var b=(k.clientY+j.scroller.position.y-40)-f;var d="translate3d("+c+"px, "+b+"px, 0) scale3d(1,1,1)";j.tooltip.element.dom.style.webkitTransform=d;j.tooltip.element.dom.style.MozTransform=d;j.tooltip.element.dom.style.msTransform=d}}}},checkActivePage:function(f){var b=this;var d=b.getReaderCarousel();if(d!=null){var a=d.getActiveItem();var e=flatPlanData.reversePageMapper[parseInt(a.config.pageNo)+1]-1;var c=f.config.mediaObject;if(e==c.page-1){if(f.mediaObject.autoPlay=="true"){f.playSound()}}else{if(d._mode=="double"){if(e%2==0){if(e-1==c.page-1){if(f.mediaObject.autoPlay=="true"){f.playSound()}}}}}}},checkActivePageVideo:function(b){var c=this;var d=c.getReaderCarousel();if(d!=null){if(d.getActiveItem().getPageNo()+1==b.mediaObject.page){if(b.mediaObject.autoPlay=="true"){if(b.videoType=="youtube"){b.playVideo()}else{if(Ext.browser.is.IE){setTimeout(function(){b.video.play()},1000)}else{b.video.play()}}}}else{if(d._mode=="double"){var a=d.getActiveItem().getPageNo();if(a==b.mediaObject.page){if(b.mediaObject.autoPlay=="true"){if(b.videoType=="youtube"){b.playVideo()}else{b.video.play()}}}}}}},triggerMedia:function(b){var d=this;for(var c in d.mediaObjects){if(b==d.mediaObjects[c].mediaObject.animID){var a=d.mediaObjects[c];if(a.mediaObject.appear=="TRIGGER"){a.element.dom.style.visibility="";a.appearAnim();switch(a.mediaType){case"video":if(currentProfile=="desktop"){if(a.mediaObject.autoPlay=="true"){a.playVideo()}}break}}else{switch(a.mediaType){case"video":a.playVideo();break}}break}}},scaleInterstitial:function(d,g,a){var f=this;var e=f.getReaderarticlepopover();if(e!=null){var j=e.content;if(j!=null){var b=a.element.dom.clientHeight/d.clientHeight;var c=a.element.dom.clientWidth/d.clientWidth;var h=Math.min(b,c);if(h<1){$(g).css("-ms-transform-origin","50% 0px");$(g).css("-webkit-transform-origin","50% 0px");$(g).css("-moz-transform-origin","50% 0px");$(g).css("transform-origin","50% 0px");$(g).css("-ms-transform","scale3d("+h+", "+h+", 1)");$(g).css("-webkit-transform","scale3d("+h+", "+h+", 1)");$(g).css("-moz-transform","scale3d("+h+", "+h+", 1)");$(g).css("transform","scale3d("+h+", "+h+", 1)")}}}},scaleInterstitialOnDevice:function(c,k){var f=this;var e=f.getReaderarticlepopover();if(e!=null){var l=e.content;if(l!=null){if(currentProfile=="tablet"||currentProfile=="largetablet"){if(f.returnOrientation()=="landscape"){var h=768;var b=1024}else{var b=768;var h=1024}}else{if(Ext.os.is.Phone){if(f.returnOrientation()=="landscape"){var h=320;var b=480}else{var b=320;var h=480}}}if(f.returnOrientation()=="portrait"){var d=$(l.element.dom).height()/h;var a=d*b;var j=a/b;if(a>$(document).width()){a=$(document).width();j=a/b;var g=j*h;d=g/h}}else{var j=$(l.element.dom).width()/b;var g=j*h;var d=g/h;if(g>$(document).height()-80){g=$(document).height()-80;d=g/h;var a=d*b;j=a/b}}$(k).css("height",h+"px");$(k).css("width",b+"px");$(k).css("-ms-transform-origin","50% 0px");$(k).css("-webkit-transform-origin","50% 0px");$(k).css("-moz-transform-origin","50% 0px");$(k).css("transform-origin","50% 0px");$(k).css("-ms-transform","scale3d("+j+", "+d+", 1)");$(k).css("-webkit-transform","scale3d("+j+", "+d+", 1)");$(k).css("-moz-transform","scale3d("+j+", "+d+", 1)");$(k).css("transform","scale3d("+j+", "+d+", 1)")}}},galleryVisible:function(){var a=this;if(a.getLivenewsticker()!=null){a.getLivenewsticker().hide()}},galleryInvisible:function(){var a=this;if(a.getLivenewsticker()!=null){a.getLivenewsticker().show()}},checkAudioOnToggle:loadSectionsPopup:jumpToSectionPage:oVideoError:ogalleryinitialized:function(a,e,b){var h=this;if(typeof trackReaderEvent!="undefined"){var j=a.config.obj.config.mediaObject.page;if(j==null){j=a.config.obj.config.page.page}var k=h.getSectionName(j);if(e.omniture!=null){var c=e.omniture.author;var l=e.omniture.contentTitle;var f=e.omniture.contentType;var g=e.omniture.hierarchy.replace(currentProfile+":","");var d=e.omniture.pageName.replace(currentProfile+" - ","")}trackReaderEvent("ogallery",{pageNum:j,section:k,author:c,contenttitle:l,contenttype:f,hier:g,pagename:d,photoNum:b})}},ogalleryinitializedArticle:ovideoinitialized:trackOLink:trackOVideoPlay:function(e,d,c){var b=this;console.log(e);if(typeof trackReaderEvent!="undefined"){var g=new Object();g.videoElement=e.videoElement;var a=e.config.obj.config.mediaObject.page;if(a==null){a=e.config.obj.config.page.page}var f=b.getSectionName(a);g.pageNumber=a;if(d.omniture!=null){g.author=d.omniture.author;g.contenttitle=d.omniture.contentTitle;g.contenttype=d.omniture.contentType;g.hier=d.omniture.hierarchy;g.pagename=d.omniture.pageName}g.event=c.event;g.progress=c.progress;g.duration=c.duration;trackReaderEvent("videoPlay",g)}},trackOVideoComplete:function(e,d,c){var b=this;if(typeof trackReaderEvent!="undefined"){var g=new Object();var a=e.config.obj.config.mediaObject.page;if(a==null){a=e.config.obj.config.page.page}var f=b.getSectionName(a);g.pageNumber=a;if(d.omniture!=null){g.author=d.omniture.author;g.contenttitle=d.omniture.contentTitle;g.contenttype=d.omniture.contentType;g.hier=d.omniture.hierarchy;g.pagename=d.omniture.pageName}g.event=c.event;g.progress=c.progress;g.duration=c.duration;trackReaderEvent("videoComplete",g)}},trackOVideoPause:function(e,d,c){var b=this;if(typeof trackReaderEvent!="undefined"){var g=new Object();var a=e.config.obj.config.mediaObject.page;if(a==null){a=e.config.obj.config.page.page}var f=b.getSectionName(a);g.pageNumber=a;if(d.omniture!=null){g.author=d.omniture.author;g.contenttitle=d.omniture.contentTitle;g.contenttype=d.omniture.contentType;g.hier=d.omniture.hierarchy;g.pagename=d.omniture.pageName}g.event=c.event;g.progress=c.progress;g.duration=c.duration;trackReaderEvent("videoPause",g)}},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},galleryClick:galleryClickFromArticle:function(c,a,e){var d=this;if(currentProfile=="desktop"){var b=Ext.create("InfinityMobile.view.desktop.ReaderOGallery",{images:a,article:e,obj:c})}else{var f="InfinityMobile.view.ReaderOGallery";switch(currentProfile){case"tablet":case"largetablet":f="InfinityMobile.view.tablet.ReaderOGallery";break}var b=Ext.create(f,{images:a,article:e,obj:c})}Ext.Viewport.add(b);b.show();if(d.getArticlescontainer()!=null){d.getArticlescontainer().hideMe()}},ovideoclicked:function(d,c,b){var e=this;if(b==null){b="eedition"}var a=Ext.create("InfinityMobile.view.ReaderOVideo",{url:c,obj:d,videoContentView:b});Ext.Viewport.add(a);a.show();if(e.getArticlescontainer()!=null){e.getArticlescontainer().hideMe()}},openWebpopover:function(b){var a=this;var c;switch(currentProfile){case"desktop":c="InfinityMobile.view.desktop.ReaderWebpopover";break;case"tablet":c="InfinityMobile.view.tablet.ReaderWebpopover";break;case"phone":c="InfinityMobile.view.phone.ReaderWebpopover";break;default:c="InfinityMobile.view.desktop.ReaderWebpopover"}var d=Ext.create(c,{mediaObj:b});Ext.Viewport.add(d);return d},videoInit:function(a,b){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("videoInit",{videoElement:a.videoElement,data:b,player:a.player})}},preRollStarted:function(a,b){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("preRollStarted",{videoElement:a.videoElement,data:b,player:a.player})}},preRollEnded:function(a,b){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("preRollEnded",{videoElement:a.videoElement,data:b,player:a.player})}},preRollSkipped:function(a,b){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("preRollSkipped",{videoElement:a.videoElement,data:b,player:a.player})}},openUrlFrame:function(a){var b=this;var c=b.openWebpopover({url:a,playerH:"100",playerW:"100"});if(!!c&&c.toolbar!=null){c.setText(c.toolbar,"")}},autoplayVideo:function(a,d){var c=this;var b=c.checkActiveSideForMedia(a.config.mediaObject);if(b&&a.element.dom.parentElement!=null){if((currentProfile!="desktop")){d.muted(true)}d.play()}},checkActiveSideForMedia:function(c){var b=this;var d=b.getReaderCarousel();if(d!=null){var a=d.getActiveItem();var e=b.getApplication().getController("ReaderToolbarController").returnCurrentPageNumber(d);if(e==c.page){return true}else{if(b.doublePageModeCheck()){if(e%2==1){if(e-1==c.page){return true}}else{if(e+1==c.page){return true}}}}}},doublePageModeCheck:function(){var b=this;var c=b.getReaderCarousel();var a=b.returnOrientation();if(currentProfile=="desktop"){return c._mode=="double"}else{if(a=="portrait"){return false}else{if(a=="landscape"&&c._mode=="double"){return true}}return false}}},0,0,0,0,0,0,[InfinityMobile.controller,"MediaController"],0));(Ext.cmd.derive("InfinityMobile.controller.ArticlePopoverController",Ext.app.Controller,{config:{refs:{articlecarousel:"articlecarousel",articlereader:"articlereader",articlescontainer:"articlescontainer",readerarticleobject:"readerarticleobject",readerarticlepopover:"articleview",readerCarousel:"infinitecarousel2d",reader:"reader",readerarticlepopoveritem:"readerarticlepopoveritem",layouttoolbar:"layouttoolbar",readerMenu:"readermenu",readaloudcontrols:"readaloudcontrols",readermenuarticleitem:"readermenuarticleitem",articlescontainer:"articlescontainer"},control:{main:{stopArticleTTS:"stopArticleTTS",articleClick:"articleClick",showArticlePopover:"showArticlePopover",articleViewTextSize:"articleViewTextSize",articleViewShare:"articleViewShare",articleViewPrint:"articleViewPrint",settingsLoaded:"settingsLoaded",articlePageThumbnailClick:"articlePageThumbnailClick"},readerarticleobject:{articleClick:"articleClick"},readerarticlepopover:{initialized:"readerArticleInitialize",close:"readerArticleClose",hide:"readerArticleHide",previous:"previousArticle",next:"nextArticle",sharepopup:"sharepopup",closeAndReset:"readerArticleCloseAndReset",setArticlePopoverHeight:"setArticlePopoverHeight",toggleTTS:"toggleTTS",playArticleTTS:"playArticleTTS",resumeArticleTTS:"resumeArticleTTS",pauseArticleTTS:"pauseArticleTTS",stopArtclesTTS:"stopArticleTTS",hidden:"onArticleHide",opened:"onArticleOpen",print:"articlePrint",jumpToComics:"jumpToComics",jumpToPuzzles:"jumpToPuzzles",selectTextMode:"selectTextMode",copyToClipboard:"copyToClipboard",sectionPopup:"sectionPopup",translateArticlePopover:"translateArticlePopover",translate:"translate",translateArticle:"translateArticle",popoverBurgerMenu:"popoverBurgerMenu",readAloudMode:"readAloudMode"},articlecarousel:{pagechange:"articleItemChange"},readerarticlepopoveritem:{fillPrintContainer:"fillPrintContainer",updateArticleShareAfterWrite:"updateArticleShareAfterWrite",trackArticleChange:"trackArticleChange",trackArticleLink:"trackArticleLink"},readerpageviewer:{keyControls:"keyControls"},readerpuzzlepopoveritem:{puzzleArchive:"puzzleArchive",puzzlePrint:"puzzlePrint",puzzleShare:"puzzleShare",puzzleInteractive:"puzzleInteractive"},readerpuzzlearchive:{initialized:"archiveInitialized",back:"closeArchive",archivePageChange:"archivePageChange",archiveNextPage:"archiveNextPage",archivePreviousPage:"archivePreviousPage"},readerpuzzlearchiveitem:{loadPuzzleItem:"loadPuzzleItem"},layouttoolbar:{toggleTTS:"toggleTTS",playArticleTTS:"playArticleTTS",resumeArticleTTS:"resumeArticleTTS",pauseArticleTTS:"pauseArticleTTS",stopArticleTTS:"stopArticleTTS"},readermenutts:{toggleTTS:"toggleTTS",playArticleTTS:"playArticleTTS",resumeArticleTTS:"resumeArticleTTS",pauseArticleTTS:"pauseArticleTTS",stopArticleTTS:"stopArticleTTS"},sharepopup:{loadShareIcons:"loadShareIcons"},sharepopupitem:{emailArticleShare:"emailArticleShare",trackArticleShare:"trackArticleShare"},articlereaderitemphone:{articleClick:"articleClick"},readaloudcontrols:{playArticleText:"playArticleText",pauseArticleText:"pauseArticleText",restartArticleText:"restartArticleText",stopArticleText:"stopArticleText"},readerpopovermenu:{goToComics:"goToComics",goToPuzzles:"goToPuzzles",sharepopupmenu:"sharepopupmenu"},sharepopupmenu:{loadShareIconsMenu:"loadShareIconsMenu"},articlesectionitemimg:{articleClick:"articleContainerClick"},articlesectionitem:{articleClick:"articleContainerClick"},readermenuarticleitem:{articleClick:"articleClick"}}},init:function(){var a=this;a.startComic=0;a.startPuzzle=0;a.mediaObjects=new Array();a.mediaStore=Ext.getStore("MediaStore");a.articleStore=Ext.getStore("ArticleStore");a.nextCounter=0;a.previousCounter=0;a.showAdAt=5;a.advertRefreshCounter=0;if(window.speechSynthesis!=null){readAloud={type:"",status:"STOPPED",text:"",controls:null,voicesLoaded:false};window.speechSynthesis.onvoiceschanged=function(){readAloud.voicesLoaded=true;if(readAloud.callback!=null){readAloud.callback()}window.speechSynthesis.onvoiceschanged=null};if(a.getCookie("lang")){a.currentLang=a.getCookie("lang");if(a.currentLang=="es"&&a.getReaderarticlepopover()){a.getReaderarticlepopover().inappTrans.removeCls("spain")}}else{a.currentLang="en"}a.setIosVoices()}a.flippAdvertSetting={}},setIosVoices:function(){var a=this;a.iOsVoices=[{name:"pt-BR",voiceURI:"pt-BR",lang:"pt-BR",localService:true,"default":true},{name:"fr-CA",voiceURI:"fr-CA",lang:"fr-CA",localService:true,"default":true},{name:"sk-SK",voiceURI:"sk-SK",lang:"sk-SK",localService:true,"default":true},{name:"th-TH",voiceURI:"th-TH",lang:"th-TH",localService:true,"default":true},{name:"ro-RO",voiceURI:"ro-RO",lang:"ro-RO",localService:true,"default":true},{name:"no-NO",voiceURI:"no-NO",lang:"no-NO",localService:true,"default":true},{name:"fi-FI",voiceURI:"fi-FI",lang:"fi-FI",localService:true,"default":true},{name:"pl-PL",voiceURI:"pl-PL",lang:"pl-PL",localService:true,"default":true},{name:"de-DE",voiceURI:"de-DE",lang:"de-DE",localService:true,"default":true},{name:"nl-NL",voiceURI:"nl-NL",lang:"nl-NL",localService:true,"default":true},{name:"id-ID",voiceURI:"id-ID",lang:"id-ID",localService:true,"default":true},{name:"tr-TR",voiceURI:"tr-TR",lang:"tr-TR",localService:true,"default":true},{name:"it-IT",voiceURI:"it-IT",lang:"it-IT",localService:true,"default":true},{name:"pt-PT",voiceURI:"pt-PT",lang:"pt-PT",localService:true,"default":true},{name:"fr-FR",voiceURI:"fr-FR",lang:"fr-FR",localService:true,"default":true},{name:"ru-RU",voiceURI:"ru-RU",lang:"ru-RU",localService:true,"default":true},{name:"es-MX",voiceURI:"es-MX",lang:"es-MX",localService:true,"default":true},{name:"zh-HK",voiceURI:"zh-HK",lang:"zh-HK",localService:true,"default":true},{name:"sv-SE",voiceURI:"sv-SE",lang:"sv-SE",localService:true,"default":true},{name:"hu-HU",voiceURI:"hu-HU",lang:"hu-HU",localService:true,"default":true},{name:"zh-TW",voiceURI:"zh-TW",lang:"zh-TW",localService:true,"default":true},{name:"es-ES",voiceURI:"es-ES",lang:"es-ES",localService:true,"default":true},{name:"zh-CN",voiceURI:"zh-CN",lang:"zh-CN",localService:true,"default":true},{name:"nl-BE",voiceURI:"nl-BE",lang:"nl-BE",localService:true,"default":true},{name:"en-GB",voiceURI:"en-GB",lang:"en-GB",localService:true,"default":true},{name:"ar-SA",voiceURI:"ar-SA",lang:"ar-SA",localService:true,"default":true},{name:"ko-KR",voiceURI:"ko-KR",lang:"ko-KR",localService:true,"default":true},{name:"cs-CZ",voiceURI:"cs-CZ",lang:"cs-CZ",localService:true,"default":true},{name:"en-ZA",voiceURI:"en-ZA",lang:"en-ZA",localService:true,"default":true},{name:"en-AU",voiceURI:"en-AU",lang:"en-AU",localService:true,"default":true},{name:"da-DK",voiceURI:"da-DK",lang:"da-DK",localService:true,"default":true},{name:"en-US",voiceURI:"en-US",lang:"en-US",localService:true,"default":true},{name:"en-IE",voiceURI:"en-IE",lang:"en-IE",localService:true,"default":true},{name:"he-IL",voiceURI:"he-IL",lang:"he-IL",localService:true,"default":true},{name:"hi-IN",voiceURI:"hi-IN",lang:"hi-IN",localService:true,"default":true},{name:"el-GR",voiceURI:"el-GR",lang:"el-GR",localService:true,"default":true},{name:"ja-JP",voiceURI:"ja-JP",lang:"ja-JP",localService:true,"default":true}]},getCookie:mediaLoaded:function(a){var b=this;b.setUniqueArticles(a);b.checkPuzzlesAndComics(a.media)},checkPuzzlesAndComics:setUniqueArticles:function(e){var f=this;var c=[];var b=[];var a=e.media.article;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){for(var d=a.length-1;d>=0;d--){var g=a[d];if((uniquearticleindex=$.inArray(g.file,c))==-1){b.push(g);c.push(g.file);g.uniquearticleindex=(b.length-1)}else{g.uniquearticleindex=uniquearticleindex}}}else{for(var d=0;d<a.length;d++){var g=a[d];if((uniquearticleindex=$.inArray(g.file,c))==-1){b.push(g);c.push(g.file);g.uniquearticleindex=(b.length-1)}else{g.uniquearticleindex=uniquearticleindex}}}e.media.uniquearticle=b;e.media.articleguidarray=c},articleClick:function(a,b){var d=this;mainPanel.fireEvent("readerArticleClick",a,b);if(typeof trackReaderEvent!="undefined"){var e=a.config.mediaObject;if(e!=null){var f=articleDictionary[e.file];var g={articleNumber:e.uniquearticleindex,articleGuid:f!=null?f.guid:null,headline:f!=null&&f.headline!=null?f.headline.replace(/<[^>]*>/g,""):"",author:f!=null?f.author:null,pageNum:f!=null?f.pageNumber:null,section:f!=null?d.getSectionName(f.pageNum):null}}trackReaderEvent("articleClick",g)}if(typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){b=a.config.mediaObject!=null?a.config.mediaObject.file:b}if(loggedIn.toLowerCase()!="true"){if(settings.subscription.pageRestriction!=null){var c=a.pageNumber==null?a.parentpage:a.pageNumber;if(c>=settings.subscription.pageRestriction.pages){}else{d.showArticlePopover(a,b)}}else{d.showArticlePopover(a,b)}}else{d.showArticlePopover(a,b)}},articleContainerClick:function(c,d){var g=this;var b=0;for(var e=0;e<g.mediaStore.media.articleguidarray.length;e++){var f=g.mediaStore.media.articleguidarray[e];if(f==d){b=e;break}}c.config={};c.config.pageNumber=c.pageNumber;c.config.articleIndex=b;var a=g.getArticlescontainer();if(a!=null){a.hide()}g.articleClick(c,d)},getMediaObject:function(b,c){var e=Ext.getStore("MediaStore");var f=null;if(typeof e!="object"||e==null){return mediaObjectsWithSameFileId}var a=[];try{a=Ext.getStore("MediaStore").data.items[0].raw.media.article;if(a==null||!Array.isArray(a)){a=[]}}catch(d){a=[]}var g=a.length;if(g===0){return mediaObjectsWithSameFileId}mediaObjectsWithSameFileId=a.filter(function(h){return h.file===c&&parseInt(h.page)===b});if(mediaObjectsWithSameFileId.length>0){f=mediaObjectsWithSameFileId[0]}return f},showArticlePopover:function(f,q){var x=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.articleViewOnly=="true"){var m="InfinityMobile.view.FullscreenArticlePopover";if(currentProfile=="phone"){m="InfinityMobile.view.phone.FullscreenArticlePopover"}var e=Ext.create(m,{mediaController:x,articleguid:q,articleIndex:k,hasComics:x.foundComic,hasPuzzles:x.foundPuzzle});mainPanel.add(e);mainPanel.setActiveItem(e)}else{var c=x.getArticlecarousel();if(!!c){var k=f.config.articleIndex;c.jumpToPage(k);return}var k=f.config.articleIndex;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){var l=x.mediaStore.media.uniquearticle;if(l!=null){for(var s=0;s<l.length;s++){var y=l[s];if(y.file==f.config.article){k=s;break}}}}var n=5;var u="InfinityMobile.view.tablet.ReaderArticlePopover";var b=true;switch(currentProfile){case"phone":u="InfinityMobile.view.phone.ReaderArticlePopover";b=false;break;case"tablet":u="InfinityMobile.view.tablet.ReaderArticlePopover";break;case"desktop":u="InfinityMobile.view.desktop.ReaderArticlePopover";break;default:u="InfinityMobile.view.tablet.ReaderArticlePopover";break}var e=Ext.create(u,{mediaController:x,articleguid:q,articleIndex:k,hasComics:x.foundComic,hasPuzzles:x.foundPuzzle});var h=null;if(f.mediaObject==null){var g=f.guid?f.guid:f.id;var o=f.pageNumber?f.pageNumber:f.parentpage;h=x.getMediaObject(o,g)}else{h=f.mediaObject}if(b&&f!=null&&h!=null&&e.content!=null){if(e.pageThumbnailCmp!=null){e.pageThumbnailCmp.destroy();e.pageThumbnailCmp=null}var r=x.createArticlePopoverPageThumbnail();if(r!=null){e.pageThumbnailCmp=r;e.content.add(e.pageThumbnailCmp);r=null;e.pageThumbnailCmp.updateThumbnail(h);e.content.addCls("has-page-thumbnail")}}if(k==0){e.previousArticleButton.element.dom.style.visibility="hidden"}else{if(k==x.articleStore.rawArticles.length-1){e.nextArticleButton.element.dom.style.visibility="hidden"}}var a=x.getReaderCarousel();a.fireEvent("notidle",a);if(currentProfile!="desktop"){if(articleMode=="dynamic"){mainPanel.add(e);mainPanel.setActiveItem(e)}else{Ext.Anim.run(a.getActiveItem(),{type:"fade",easing:"ease-in",after:)}}mainPanel.viewType="article";var w=Ext.getStore("SettingStore");if(w.data.items[0].raw.tracking!=null){var p=w.data.items[0].raw.tracking.trackingType;if(p=="GA"&&typeof gtag!="undefined"){var t;if(f.mediaObject==null){t=f.headline}else{t=f.mediaObject.description}x.setGaCustomerId();gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","click",{event_category:"Open Article",event_label:t,value:f.pageNumber,page_path:"/"+f.pageNumber,page_number:f.pageNumber})}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight});if((iOSVersion()=="10.3"&&Ext.os.is.iOS&&currentProfile=="phone")||((currentProfile=="desktop"||Ext.os.is.Android)&&(Ext.browser.is.Chrome||Ext.browser.name=="ChromeMobile"))){x.populatePrintContainerAndroid()}var j=e.content.getActiveItem().getActiveItem();x.setupAdvertRefresh(j);if(typeof settings!="undefined"&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.enableAutoRefresh=="true"){mainPanel.fireEvent("clearAdvertInterval")}var d=f!=null&&f.config!=null&&f.config.article!=null?f.config.article:f.file;if(typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){console.log(e);var c=x.getArticlecarousel();c.articleToTrackForOpen=d}else{x.trackOpenArticle(d,f.config.mediaObject)}try{if(currentProfile!="desktop"){x.hideArticlesContainer()}else{x.hideArticlesContainerMinusKeys()}}catch(v){console.error("[ArticlePopoverController]: \n",v)}}},createArticlePopoverPageThumbnail:function(){var e=typeof settings=="object"&&"articlepopover" in settings&&typeof settings.articlepopover=="object"&&"pageThumbnail" in settings.articlepopover&&!!settings.articlepopover.pageThumbnail&&settings.articlepopover.pageThumbnail.toLowerCase()==="true";var f=null;if(!e){return f}var b=("pageThumbnailPosition" in settings.articlepopover&&!!settings.articlepopover.pageThumbnailPosition)?String(settings.articlepopover.pageThumbnailPosition):"";var d=" position: absolute; ";var a="1.1em";var h="1.5em";var g="3em";var c={itemId:"articlePopoverPageThumbnail",additionalCssClasses:"article-popover-page-thumbnail",editionGuid:editionguid};if(currentProfile!="desktop"){h="1em";g="1.5em";c.width="130px"}switch(b.toLowerCase()){case"top right":case"topright":d=d+"top: "+a+"; right: "+g+";";break;case"bottom left":case"bottomleft":d=d+"bottom: "+a+"; left: "+h+";";break;case"bottom right":case"bottomright":d=d+"bottom: "+a+"; right: "+g+";";break;default:d=d+"top: "+a+"; left: "+h+";";break}c.additionalCss=d;f=Ext.create("InfinityMobile.view.ReaderArticlePageThumbnail",c);return f},hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}},hideArticlesContainerMinusKeys:function(){var a=this;if(a.getArticlescontainer()!=null&&a.getArticlescontainer().hideWithoutHandlingKeys!=null){a.getArticlescontainer().hideWithoutHandlingKeys()}},setGaCustomerId:function(){var a="";if(typeof getCookie==="function"){a=getCookie("gatid")}if(typeof gtag!="undefined"&&a!=null&&a!=""){gtag("set",{user_id:a,send_page_view:false})}},trackOpenArticle:function(j,a){var g=this;if(typeof trackReaderEvent!="undefined"){var b={};if(typeof articleDictionary!="undefined"){var f=articleDictionary[j];try{if(a==null){a=g.returnHotspotMediaObject(j)}var c=g.getArticlecarousel().getActiveItem();var d=c.config.page.page;var h;if(editionFlatplanData.pageGroups[d-1]!=null){h=editionFlatplanData.pageGroups[d-1].pages[0]}b={pageNumArray:f!=null?[f.pageNumber]:!!h&&!!h.pageNum?[h.pageNum]:null,pageNum:f!=null?f.pageNumber:!!h&&!!h.pageNum?h.pageNum:null,author:f!=null?f.byline:!!a&&!!a.byline?a.byline:null,articleGuid:f!=null?f.guid:!!j?j:null,headline:f!=null&&f.headline!=null?f.headline.replace(/<[^>]*>/g,""):!!a&&!!a.description?a.description:"",section:f!=null?g.getSectionName(f.pageNumber):null};if(!!h&&!!h.pageName){b.pageName=h.pageName}if(b.section==null&&!!a&&!!h&&!!h.pageNum){b.section=g.getSectionName(h.pageNum)}}catch(e){console.warn("Unable to set data for openArticle event\n",e)}}trackReaderEvent("openArticle",b)}},returnHotspotMediaObject:function(j){var e=this;try{var g=Ext.getStore("MediaStore");var f=g.getData();var a=f.items[0].raw.media;if(!!a){var h=a.article;for(var b=0;b<h.length;b++){var d=h[b];if(d.file==j){return d}}}}catch(c){console.warn("Could not grab media object with "+j+"\n",c);return null}},readerArticleInitialize:function(f){var l=this;var a=f.content;var o=l.mediaStore.media.article;var e=l.mediaStore.media.uniquearticle;l.startArticleOrientation=l.returnOrientation();var d=f.config.articleIndex;var k=e.length;if(e!=null){for(var n in e){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){e[n].articleNumber=parseFloat(e.length-1-n)+1}else{e[n].articleNumber=parseFloat(n)+1}}}var h=0;if(settings.newsday!=null){if(settings.newsday.showInterstitialInArticlePopover=="true"){e=jQuery.extend(true,[],l.mediaStore.media.uniquearticle);for(var j=d+5;j<e.length;j=j+5){var m="InfinityMobile.view.desktop.ArticlePopoverInterstitial";switch(currentProfile){case"phone":m="InfinityMobile.view.phone.ArticlePopoverInterstitial";break;case"tablet":m="InfinityMobile.view.tablet.ArticlePopoverInterstitial";break}e.splice(j,0,{isAdvert:true,viewToLoad:m})}for(var j=d-5;j>0;j=j-5){var m="InfinityMobile.view.desktop.ArticlePopoverInterstitial";h++;switch(currentProfile){case"phone":m="InfinityMobile.view.phone.ArticlePopoverInterstitial";break;case"tablet":m="InfinityMobile.view.tablet.ArticlePopoverInterstitial";break}var b=Ext.create(m,{isAdvert:true});e.splice(j,0,{isAdvert:true,viewToLoad:m})}d=d+h}}l.articleCarousel=Ext.create("InfinityMobile.view.ArticleCarousel",{width:"100%",height:"100%",pageNumber:d,offset:h,data:e,numberOfArticles:k,pageTemplate:function(s,u,q){articleguid=s.file;if((s.description!=null&&(s.description.indexOf("Puzzles")!=-1||s.description.indexOf("Comics")!=-1))&&settings.articlepopover.puzzleControls=="true"){var t="InfinityMobile.view.desktop.ReaderPuzzlePopoverItem";switch(currentProfile){case"tablet":t="InfinityMobile.view.tablet.ReaderPuzzlePopoverItem";break;case"phone":t="InfinityMobile.view.phone.ReaderPuzzlePopoverItem"}return Ext.create(t,{pageNo:u,page:s})}else{if(currentProfile=="desktop"){if(this.getData()[u].isAdvert==null){return Ext.create("InfinityMobile.view.desktop.ReaderArticlePopoverItem",{pageNo:u,page:q[u],section:l.returnSection(s.page),article:articleguid,highlightMode:f.highlightMode,readAloudMode:f.readAloudMode})}else{var t=this.getData()[u].viewToLoad;var r=Ext.create(t,{isAdvert:true});r.pageNo=u;r.config.pageNo=u;return r}}else{if(this.getData()[u].isAdvert==null){return Ext.create("InfinityMobile.view.ReaderArticlePopoverItem",{pageNo:u,page:q[u],section:l.returnSection(s.page),article:articleguid,highlightMode:f.highlightMode,readAloudMode:f.readAloudMode})}else{var t=this.getData()[u].viewToLoad;var r=Ext.create(t,{isAdvert:true});r.pageNo=u;r.config.pageNo=u;return r}}}}});a.add(l.articleCarousel);mainPanel.fireEvent("articleShow",l.articleCarousel);if(typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){}else{l.trackArticleChange(d,"Article Click",l.articleCarousel.getActiveItem())}var g=e[d];if(!l.displayViewAllArticlesText()){var c="Article";if(language.article!=null){c=language.article}f.articleText.setHtml(c+" "+((e[d].articleNumber))+" / "+k)}if(currentProfile!="phone"||(settings.articlepopover.phoneSharingInTopBar!=null&&settings.articlepopover.phoneSharingInTopBar=="true")){l.articleLoadShare(f,g)}if(trackOmniture=="True"){trackArticle(g.page,g.description)}if(currentProfile=="desktop"){l.articleKeyControl()}if(settings.newsday!=null){if(l.articleCarousel.getActiveItem()!=null){var p=l.articleCarousel.getActiveItem();if(p.loadAdvert!=null){p.loadAdvert()}if(p.loadAdvertMpu!=null){p.loadAdvertMpu()}}}if((settings.articlepopover.lazyLoadPopoverAdverts!=null&&settings.articlepopover.lazyLoadPopoverAdverts=="true")){var p=l.articleCarousel.getActiveItem();if(settings.reader.popupAdvert!=null&&(settings.reader.popupAdvert.type=="dfp"||settings.reader.popupAdvert.type=="url"||settings.reader.popupAdvert.type=="adbridg"||(p.loadType=="inline"&&p.isCustomBannerAd()))){p.loadAdvert()}if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.type=="dfp"&&p.loadType!="inline"){p.loadAdvertMpu()}if(p.loadType=="inline"&&p.isCustomMpuAd()){p.loadCustomAdvertMpu()}}},displayViewAllArticlesText:function(){return !!settings&&!!settings.articlepopover&&settings.articlepopover.enableFullscreen=="true"&&!!settings.menu&&settings.menu.hideArticles!="true"&&InfinityMobile.controller.ReaderController.isNewPWA()},returnSection:function(a){var e=this;var h=settings.bookmarks.bookmark;var f=null;if(h!=null&&h.length>0){for(var c in h){var b=parseInt(h[c].pageNumber);if(h[c].start!=null){b=h[c].start}var g=h[parseInt(c)+1];var d=null;if(g!=null){d=g.pageNumber;if(g.start!=null){d=g.start}}if(parseInt(a)>=b&&(d==null||parseInt(a)<parseInt(d))){f=h[c].name;break}}}return f},articleKeyControl:function(){var c=this;var a=c.articleCarousel;var b=true;c.upevent=window.onkeyup;c.downevent=window.onkeydown;c.isADown=false;c.isRDown=false;a.on({destroy:);if(settings.articlepopover!=null&&settings.articlepopover.disableArticleCarousel!=null&&settings.articlepopover.disableArticleCarousel=="true"){b=false}if(b){window.onkeyup=function(k){if($("#slider").val()==1){if(k.keyCode==39){a.jumpToPage(a.getActiveItem().config.pageNo+1)}else{if(k.keyCode==37){if(a.getActiveItem().config.pageNo>=1){a.jumpToPage(a.getActiveItem().config.pageNo-1)}}}}if(settings.articlepopover!=null&&settings.articlepopover.enableArticleKeyboardShortcut=="true"){if(c.isADown){var d=c.getReaderarticlepopover();var g=$(".copy-alert")[0];if(g!=null){var l=Ext.Viewport.query("#"+g.id)[0];if(l!=null){try{l.destroy()}catch(h){console.log("error :(")}}}d.fireEvent("close",d)}if(k.keyCode==18){c.isAltDown=false}if(k.keyCode==65){c.isADown=false}if((window.SpeechSynthesisUtterance!=undefined&&!Ext.browser.is.Opera&&settings.articlepopover.readAloud!=null)){if(c.isRDown){var d=c.getReaderarticlepopover();if(!d.readAloudMode){d.fireEvent("readAloudMode",d,true)}if(readAloud.status=="PLAYING"){c.stopReading()}else{var f=c.getReadaloudcontrols();var j=new Event("tap",{});f.play(j)}}if(k.keyCode==82){c.isRDown=false}}}};window.onkeydown=function(h){var j=a.getActiveItem();if(navigator.maxTouchPoints){var g=j.content.getScrollable();var d=g.getScroller();if(h.keyCode===38){if(d.position.y-20>d.minPosition.y){d.scrollTo(0,d.position.y-20)}else{d.scrollTo(0,d.minPosition.y)}}if(h.keyCode===40){if(d.position.y+20<d.maxPosition.y){d.scrollTo(0,d.position.y+20)}else{d.scrollTo(0,d.maxPosition.y)}}}else{if(h.keyCode===38){if(c.isPuzzleOrComic(j)&&Ext.browser.is.Firefox){var f=$(j.element.dom).find(".x-inner")[1];if(f!=null){f.scrollTop-=20}}else{j.content.element.dom.scrollTop-=20}}if(h.keyCode===40){if(c.isPuzzleOrComic(j)&&Ext.browser.is.Firefox){var f=$(j.element.dom).find(".x-inner")[1];if(f!=null){f.scrollTop+=20}}else{j.content.element.dom.scrollTop+=20}}}if(settings.articlepopover!=null&&settings.articlepopover.enableArticleKeyboardShortcut=="true"){if(h.keyCode==18){h.stopImmediatePropagation();c.isAltDown=true}if(h.keyCode==65){h.stopImmediatePropagation();c.isADown=true}if((window.SpeechSynthesisUtterance!=undefined&&!Ext.browser.is.Opera&&settings.articlepopover.readAloud!=null)){if(h.keyCode==82){h.stopImmediatePropagation();c.isRDown=true}}}}}else{window.onkeyup=function(d){};window.onkeydown=function(d){}}},articleLoadShare:populateShare:function(b,f){var l=this;var o=window.location.protocol;var a=o+"//"+window.location.hostname+"/infinity/article_popover_share.aspx?guid="+f.guid;if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareUrl!=null){a=settings.sharing.articleShareUrl.replace("{{DOMAIN}}",window.location.hostname).replace("{{GUID}}",f.guid).replace("{{PBID}}",publicationguid)}var g=a;try{a=l.getApplication().getController("AppController").addPwaAppCodeQueryParamToUrl(a)}catch(j){a=g;console.warn("[ArticlePopoverController]: Error Caught\n",j)}finally{g=null}if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareQueryString!=null&&settings.sharing.articleShareQueryString!=""){if(a.indexOf("?")>=0){a+="&"+settings.sharing.articleShareQueryString}else{a+="?"+settings.sharing.articleShareQueryString}}var d=f.description;if(d==null){d=f.headline;a=f.url}var h=articleDictionary[f.file];if(h!=null&&h.articleData&&h.articleData.sharelink){a=h.articleData.sharelink;d=h.articleData.headline}if(settings.newsday!=null){var n=window.location.href.substring(0,window.location.href.indexOf("?"));a=n+"?pnum="+f.page+"&edid="+editionguid+"&isshared=true";if(typeof articleDictionary!="undefined"&&articleDictionary[f.file]!=null){d=articleDictionary[f.file].headline}}a=encodeURIComponent(a);var k=settings.sharing.allSharing;for(var e=0;e<k.length;e++){var m=k[e];var c=settings.sharing[m];l.addShareItem(b,c.iconDark,c.link,a,d)}},updateArticleShareAfterWrite:function(f,d){var g=this;var e=g.getReaderarticlepopover();var a=e.topBarShare;var h=a.query("readermenushareitem");for(var c=0;c<h.length;c++){var b=h[c];b.updateMessage(d);b.updateUrl(encodeURIComponent(f))}},updateArticleShare:function(d,g){var m=this;var b=d.topBarShare;var l=b.query("readermenushareitem");if(g!=null){var c="http://"+window.location.hostname+"/infinity/article_popover_share.aspx?guid="+g.guid;if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareUrl!=null){c=settings.sharing.articleShareUrl.replace("{{DOMAIN}}",window.location.hostname).replace("{{GUID}}",g.guid).replace("{{PBID}}",publicationguid)}var h=c;try{c=m.getApplication().getController("AppController").addPwaAppCodeQueryParamToUrl(c)}catch(k){c=h;console.warn("[ArticlePopoverController]: Error Caught\n",k)}finally{h=null}c=encodeURIComponent(c);console.log(d);var e=g.description;if(e==null){e=g.headline;c=g.url}var j=articleDictionary[g.file];if(j!=null&&j.articleData&&j.articleData.sharelink){c=j.articleData.sharelink;e=j.articleData.headline}if(settings.newsday!=null){var n=window.location.href.substring(0,window.location.href.indexOf("?"));c=n+"?pnum="+g.page+"&edid="+editionguid+"&isshared=true";if(typeof articleDictionary!="undefined"&&articleDictionary[g.file]!=null){e=articleDictionary[g.file].headline}c=encodeURIComponent(c)}for(var f=0;f<l.length;f++){var a=l[f];a.updateMessage(e);a.updateUrl(c)}}},addShareItem:function(d,c,f,e,a){var b="";if(f.indexOf("mailto:")!=-1){b="email"}else{if(f.indexOf("facebook")!=-1){b="Facebook"}else{if(f.indexOf("twitter")!=-1){b="Twitter"}else{if(f.indexOf("pinterest")!=-1){b="Pinterest"}else{if(f.indexOf("google")!=-1){b="Google+"}else{if(f.indexOf("linkedin")!=-1){b="LinkedIn"}}}}}}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:c,link:f,url:e,message:a,type:b,article:"true"});d.topBarShare.add(g)},sharepopup:function(d){var k=this;var l=k.getArticlecarousel();var j=l.getActiveItem();var c=k.mediaStore.media.uniquearticle;var l=k.getArticlecarousel();var b=l.getPageNumber();var f=c[b];var a="http://"+window.location.hostname+"/infinity/article_popover_share.aspx?guid="+f.guid;if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareUrl!=null){a=settings.sharing.articleShareUrl.replace("{{DOMAIN}}",window.location.hostname).replace("{{GUID}}",f.guid).replace("{{PBID}}",publicationguid)}var g=a;try{a=k.getApplication().getController("AppController").addPwaAppCodeQueryParamToUrl(a)}catch(h){a=g;console.warn("[ArticlePopoverController]: Error Caught\n",h)}finally{g=null}if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareQueryString!=null&&settings.sharing.articleShareQueryString!=""){if(a.indexOf("?")>=0){a+="&"+settings.sharing.articleShareQueryString}else{a+="?"+settings.sharing.articleShareQueryString}}a=encodeURIComponent(a);var e=f.description;shareMenu=Ext.create("InfinityMobile.view.phone.ReaderSharePopup",{url:a,message:e,articleguid:d._articleguid})},loadShareIcons:articlePrint:function(){var d=this;var c=d.getArticlecarousel();if(c.getActiveItem()._page.description!=null&&(c.getActiveItem()._page.description.indexOf("Puzzles")!=-1||c.getActiveItem()._page.description.indexOf("Comics")!=-1)){d.puzzlePrint(c.getActiveItem())}else{var b='<html><head><link rel="stylesheet" type="text/css" href="resources/css/article.css" /><style type="text/css" media="print">@page {size: auto;/* auto is the initial value */margin: 10mm;  /* this affects the margin in the printer settings */}.articleContentHtml5{font-size:'+fontEm+"px !important}</style><script>setText = function () {}<\/script></head><body>{{ARTICLEBODY}}</body></html>";b=b.replace("{{ARTICLEBODY}}",c.getActiveItem().content.getHtml());var a=Ext.create("InfinityMobile.view.PrintPreview",{doc:b,imgCheck:true,delayImages:50});Ext.Viewport.add(a);a.show()}},previousArticle:function(){var a=this;a.articleCarousel=a.getArticlecarousel();a.articleCarousel.previous();mainPanel.fireEvent("articlePreviousClick",a.articleCarousel)},nextArticle:function(){var a=this;a.articleCarousel=a.getArticlecarousel();a.articleCarousel.next();mainPanel.fireEvent("articleNextClick",a.articleCarousel)},articleItemChange:function(d,q,f){var u=this;if(!d.carouselDestroyed){var o=u.getReaderarticlepopover();var j=u.mediaStore.media.article;var k=u.mediaStore.media.uniquearticle;var m=d.getActiveItem().config.page;if(o!=null&&o.pageThumbnailCmp!=null){if(m!=null){o.pageThumbnailCmp.updateThumbnail(m);if(!!o.pageThumbnailCmp.isHidden()){o.pageThumbnailCmp.show()}}else{if(!!o.pageThumbnailCmp.isHidden()===false){o.pageThumbnailCmp.hide()}}}var a="Article";if(language.article!=null){a=language.article}if(q.config.page!=null){var t=q.config.page.page;var p=q.config.page.description}var l="Next Article";if(u.latestArticlePage!=null){if(d.getPageNumber()<u.latestArticlePage){l="Previous Article"}}else{if(d.getPageNumber()<f._pageNo){l="Previous Article"}}mainPanel.fireEvent("articleChange",d);if(typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){if(q.isWritten){u.trackArticleChange(d.getPageNumber(),l,q)}}else{u.trackArticleChange(d.getPageNumber(),l,q)}var s=Ext.getStore("SettingStore");if(loggedIn.toLowerCase()!="true"){if(s.data.items[0].raw.subscription.pageRestriction!=null){console.log(d.getActiveItem().config.page.page);if(d.getActiveItem().config.page.page>parseInt(s.data.items[0].raw.subscription.pageRestriction.pages)){var b=s.data.items[0].raw.subscription.pageRestriction.type;d.jumpToPage(d.getActiveItem()._pageNo-1);if(b=="standard"&&settings.subscription.pageRestriction.disableRedirect==null&&settings.subscription.pageRestriction.redirectUrl!=null){var c=u.getApplication().getController("AppController").getPageRestrictionRedirectUrl();var e=u.getApplication().getController("AppController").hasPageRestrictionRedirectInSameTab();window.open(!!c?c:settings.subscription.pageRestriction.redirectUrl,e?"_self":"_blank")}}}}else{if(typeof settings!="undefined"&&settings.subscription!=null&&settings.subscription.pageRestriction!=null&&settings.subscription.pageRestriction.type=="unique"&&loggedIn.toLowerCase()!="true"){var h=d.getActiveItem();if(h!=null&&h.config.page!=null&&h.config.page.page>settings.subscription.pageRestriction.pages){d.jumpToPage(d.getActiveItem()._pageNo-1)}}}if(o.topBarShare!=null){u.updateArticleShare(o,m)}if(!u.displayViewAllArticlesText()){if(o.config.isLive==null){if(d.getActiveItem().config.isAdvert==null){if(d.getActiveItem().config.page!=null){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){console.log(d.getActiveItem().config.page);o.articleText.setHtml(d.config.numberOfArticles+" / "+(d.getActiveItem().config.page.articleNumber)+" "+a)}else{o.articleText.setHtml(a+" "+(d.getActiveItem().config.page.articleNumber)+" / "+d.config.numberOfArticles)}}else{o.articleText.setHtml(a+" "+((d.getPageNumber())+1)+" / "+k.length)}}else{o.articleText.setHtml("Advertisement")}}else{if(u.getReaderarticlepopover().config.articles==null){o.articleText.setHtml(a+" "+((d.getPageNumber())+1)+" / "+u.getApplication().getController("ArticleController").liveArticles.length)}else{o.articleText.setHtml(a+" "+((d.getPageNumber())+1)+" / "+u.getReaderarticlepopover().config.articles.length)}}}var s=Ext.getStore("SettingStore");if(settings!=null&&settings.tracking!=null){var n=settings.tracking.trackingType;if(n=="GA"&&typeof gtag!="undefined"){var h=d.getActiveItem();var g=h.article!=null?h.article:{};u.setGaCustomerId();gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","swipe",{event_category:"Swipe Article",event_label:g.headline,value:g.pageNumber,page_path:"/"+g.pageNumber,page_number:g.pageNumber})}else{if(n=="DA"&&typeof trackDaPageView!="undefined"){trackDaPageView(p,"Digital Edition")}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}}else{if(typeof isTribReader!="undefined"&&isTribReader==true){u.trackTribune(t,p)}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight});if(window.speechSynthesis!=undefined&&o.readAloudMode){u.stopReading()}u.checkTopBar(o,d);u.checkArticleAdbridg(f);if(settings.newsday!=null){if(q.isAdvert==null){if(q.loadAdvert!=null){u.checkAdvertTimer();q.loadAdvert();u.setupAdvertRefresh(q)}if(q.loadAdvertMpu!=null){q.loadAdvertMpu()}if(f!=null&&f.destroyAdverts!=null){f.destroyAdverts()}}}if(settings.articlepopover.lazyLoadPopoverAdverts!=null&&settings.articlepopover.lazyLoadPopoverAdverts=="true"||(!!settings.reader.popupAdvert&&settings.reader.popupAdvert.type=="adbridg")){if(settings.reader.popupAdvert!=null&&(settings.reader.popupAdvert.type=="dfp"||settings.reader.popupAdvert.type=="url"||settings.reader.popupAdvert.type=="adbridg"||(q.loadType=="inline"&&q.isCustomBannerAd()))&&q.loadAdvert!=null){if(settings.reader.popupAdvert.advertInArticleFlow==null||settings.reader.popupAdvert.advertInArticleFlow=="true"){if(q.mode=="html"){u.checkAdvertTimer();q.loadAdvert();u.setupAdvertRefresh(q)}else{if(q.mode=="frame"){q.loadIframeAdvert()}}}else{if(settings.reader.popupAdvert.advertInArticleFlow=="false"&&o!=null&&o.refreshAdvert!=null){o.refreshAdvert()}}}if(settings.reader.popupAdvertMpu!=null&&(settings.reader.popupAdvertMpu.type=="dfp"||settings.reader.popupAdvertMpu.type=="adbridg")&&q.loadAdvertMpu!=null&&(q.loadType!="inline"||settings.reader.popupAdvertMpu.type=="adbridg")){if(q.mode=="html"){q.loadAdvertMpu()}else{if(q.mode=="frame"){q.loadIframeAdvertMpu()}}}if(q.loadType=="inline"&&q.mode=="html"&&q.isCustomMpuAd()){q.loadCustomAdvertMpu()}try{if(f!=null&&f.destroyAdverts!=null){f.destroyAdverts()}}catch(r){console.error("[ArticlePopoverController]: Error Caught",r)}}if(settings.newsday!=null){if(typeof q.getPageNo=="function"&&q.config.page.articleNumber==1){o.previousArticleButton.element.dom.style.visibility="hidden"}else{o.previousArticleButton.element.dom.style.visibility=""}if(typeof q.getPageNo=="function"&&q.config.page.articleNumber==u.articleStore.data.items[0].raw.articles.length){o.nextArticleButton.element.dom.style.visibility="hidden"}else{o.nextArticleButton.element.dom.style.visibility=""}}else{if(o.config.isLive==null){if(q.getPageNo!=null&&q.getPageNo()==0){o.previousArticleButton.element.dom.style.visibility="hidden"}else{o.previousArticleButton.element.dom.style.visibility=""}if(q.getPageNo!=null&&q.getPageNo()==u.mediaStore.media.uniquearticle.length-1){o.nextArticleButton.element.dom.style.visibility="hidden"}else{o.nextArticleButton.element.dom.style.visibility=""}}}u.writeArticleTemplate();if((iOSVersion()=="10.3"&&Ext.os.is.iOS&&currentProfile=="phone")||((currentProfile=="desktop"||Ext.os.is.Android)&&(Ext.browser.is.Chrome||Ext.browser.name=="ChromeMobile"))){u.populatePrintContainerAndroid()}if(q&&q.showHiddenInlineAudioMedia!=null){q.showHiddenInlineAudioMedia()}if(f&&f.pauseAllAudio!=null){f.pauseAllAudio()}if(!!q&&!!q.runFlipp){q.runFlipp()}}},writeArticleTemplate:function(){var b=this;if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){var a=b.getArticlecarousel();var c=a.getActiveItem();if(c!=null){c.writeArticleTemplate()}}},destroyOldAdbridgSlots:function(e){var d=this;var a=typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.popupAdvert?settings.reader.popupAdvert:{};var b=typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.popupAdvertMpu?settings.reader.popupAdvertMpu:{};if(a.type=="adbridg"&&(!!e&&!!e.advertDivID)){var f=document.querySelector("#"+e.advertDivID);console.log(f);if(!!f){f.parentElement.removeChild(f)}}if(b.type=="adbridg"&&(!!e&&!!e.advertDivIDMpu)){var c=document.querySelector("#"+e.advertDivIDMpu);console.log(c);if(!!c){c.parentElement.removeChild(c)}}},checkArticleAdbridg:function(c){var a=this;var b=currentProfile=="desktop"?300:500;a.adbridgTimeout;if(!!a.adbridgTimeout){clearTimeout(a.adbridgTimeout)}a.destroyOldAdbridgSlots(c);if(a.hasDoneFirstCheck){a.adbridgTimeout=setTimeout(function(){var d=typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.adbridg?settings.reader.adbridg:{};if(!!d.domain&&typeof AdBridg!="undefined"){window.AdBridg.cmd.push({action:"spa_pv_shutdown",action:"spa_pv_initialize",config:{targeting:{DOMAIN:d.domain,"PAGE-TYPE":"article"}}})}},b)}a.hasDoneFirstCheck=true},checkAdvertTimer:function(){var a=this;if(a.bannerAdInterval!=null){clearInterval(a.bannerAdInterval);a.advertRefreshCounter=0}},setupAdvertRefresh:function(c){var d=this;if(typeof settings!="undefined"&&(settings.reader.popupAdvert!=null&&settings.reader.popupAdvert.enableAutoRefresh=="true")||(settings.newsday!=null&&settings.newsday.articleBannderAd!=null&&settings.newsday.articleBannderAd.enableAutoRefresh=="true")){var e=15000;if(settings.newsday!=null){var a=settings.newsday.articleBannderAd}else{var a=settings.reader.popupAdvert}if(a.autoRefreshDuration!=null&&!isNaN(a.autoRefreshDuration)){e=a.autoRefreshDuration*1000}var b=a.maxRefreshes;d.advertRefreshCounter=0;if(d.bannerAdInterval!=null){clearInterval(d.bannerAdInterval)}d.bannerAdInterval=setInterval(function(){if(c!=null&&typeof c.refreshAdvert==="function"&&b>d.advertRefreshCounter){var f=c.adSlot!=null?c.adSlot:c.adslot;if(f!=null){console.log("REFRESHING POPOVER LEADERBOARD: ",f);c.refreshAdvert();d.advertRefreshCounter++}}else{clearInterval(d.bannerAdInterval)}},e)}},checkTopBar:function(b,a){var c=this;var d=a.getActiveItem();if(d.id.indexOf("readerarticlepopoveritem")!=-1||d.id.indexOf("readerlivearticlepopoveritem")){if(b.readAloudControls!=null&&b.readAloudMode&&window.SpeechSynthesisUtterance!=undefined){b.readAloudControls.show()}}else{if(b.readAloudControls!=null&&b.readAloudMode&&window.SpeechSynthesisUtterance!=undefined){b.readAloudControls.hide()}}},populatePrintContainerAndroid:function(){var c=this;var f=mainPanel.getActiveItem();if(currentProfile!="desktop"){if(f.config.viewType!=null&&f.config.viewType=="reader"){}else{var b=c.getArticlecarousel();var e=b.getActiveItem();var a=e.config.page;if(typeof a!="undefined"&&a!=null&&a.description!=null&&(a.description.indexOf("Puzzles")!=-1||a.description.indexOf("Comics")!=-1)){c.prepPuzzlePrintAndroid(e)}else{c.prepArticlePrintAndroid()}}}else{var d=c.getReaderarticlepopover();if(d!=null){var b=c.getArticlecarousel();var e=b.getActiveItem();var a=e.config.page;if(a!=null){if(a.description!=null&&(a.description.indexOf("Puzzles")!=-1||a.description.indexOf("Comics")!=-1)){c.prepPuzzlePrintAndroid(e)}else{c.prepArticlePrintAndroid()}}}}},prepPuzzlePrintAndroid:function(e){var d=this;if(e.printImage!=null){var g=e.printImage.dom.src;var b="<img class='puzzleImage' src='"+g+"' />";b="<img src='"+g+"' style='position:absolute;width:100%;height:100%;object-fit: contain;' />";d.writePrintHtml(b)}else{var k=d.getArticlecarousel();puzzleHtmlObject=k.getActiveItem().content;var h=/<div class=\"contentImage\">(.*?)(<div class=\"clImageCaption\">[\\w+\\s(),-./\\&%$£@]*<\/div>.*?)?<\/div>/g;var j=h.exec(puzzleHtmlObject.getHtml());if(j!=null&&j[0]!=null){var c=j[0];var a=/<img.+?src=[\"'](.+?)[\"'].*?>/g;var f=a.exec(c);if(f[1]!=null&&f[1].indexOf("left-image-arrow")==-1&&f[1].indexOf("left-image-arrow")==-1){var b="<img src='"+f[1]+"' style='position:absolute;width:100%;height:100%;object-fit: contain;' />";if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){b="<div style='width:100%;height:100%;text-align:center;'><img src='"+f[1]+"' style='position:relative;width:auto;max-height:100%;max-width:100%;height:auto' /></div>"}d.writePrintHtml(b)}else{d.writePrintHtml("")}}else{d.writePrintHtml("")}}},prepArticlePrintAndroid:function(){var e=this;var d=e.getArticlecarousel();var b="phoneArticle";if(currentProfile=="tablet"){b="tabletArticle"}if(d.getActiveItem().content!=null){var a="<div class='"+b+"'>"+d.getActiveItem().content.getHtml()+"</div>";var c="<style>.printContainer .articleContentHtml5, .printContainer .articleContent{font-size:"+fontEm+"px !important}</style>"+a}else{var c=""}c=c.replace(/<div*[\sa-zA-Z=\"\'\-0-9:;]* class=[\"\']mpuAdvert.*[\"\']\s?><\/div>/g,"").replace(/<div*[\sa-zA-Z=\"\'\-0-9:;]* class=[\"\']mpuAdvert mpuPhone[\"\']\s?><\/div>/g,"").replace(/<div\sid\=[\"\']ext-readerarticlepopoveritem-[0-9]*advert[\"\'][a-zA-z0-9\-\=\:\;\s\'\"]*><\/div>/g,"");c=c.replace(/<div\sid\=[\"\']flipp-div-ext-readerarticlepopoveritem-[0-9]*[\"\'][a-zA-z0-9\-\=\:\;\s\'\"]*>.*<\/div>/g,"");e.writePrintHtml(c)},fillPrintContainer,writePrintHtml:function(c){var d=this;if(((currentProfile=="desktop"||Ext.os.is.Android)&&(Ext.browser.is.Chrome||Ext.browser.name=="ChromeMobile"))||(Ext.os.is.iOS&&iOSVersion()=="10.3"&&currentProfile=="phone")){var b=$(".printContainer")[0];b.innerHTML=c;if(Ext.os.is.Android&&currentProfile=="phone"){var a=$(b).find(".articleContentHtml5")[0];if(a!=null){$(a).addClass("printAndroid")}}}},returnArticleMediaObjectByNumber:function(c){var d=this;var a=d.mediaStore.media.article;if(!!a){for(var b=0;b<a.length;b++){var e=a[b];if(e.uniquearticleindex==c){return e}}}},trackArticleChange:function(f,m,g){var l=this;if(typeof trackReaderEvent!="undefined"&&(!g.isAdvert||g.isAdvert==null)){var o=l.mediaStore.media.article;thisArticle=l.returnArticleMediaObjectByNumber(f);if(thisArticle==null){thisArticle=o[f]}if(g.config.page!=null&&g.article!=null){var h=g.config.page.page;var b=editionFlatplanData.pageGroups.filter(function(q){return q.pages[0].origPageNum==h});if(!!b&&b.length>0){thisEditionPage=!!b&&!!b[0].pages&&!!b[0].pages[0]?b[0].pages[0]:null}if(!thisEditionPage){thisEditionPage=editionFlatplanData.pageGroups[h-1+pageOffset].pages[0]}var c="";var j="";var e=l.mediaStore.media.allArticles;var n=o[thisArticle.file];if(n!=null){c=n.author}else{if(g!=null&&g.article!=null&&g.article.byline){c=g.article.byline}else{if(g!=null&&g.article!=null&&g.article.articleData!=null){c=g.article.articleData.author}}}if(settings.newsday!=null){c=g.article.byline;if(g.article.reporters!=null){for(var d in g.article.reporters){c+=", "+g.article.reporters[d].name}}if(g.article["content-id"]!=null){j=g.article["content-id"]}}var a=thisArticle.guid;if(typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){a=thisArticle.file}var k={pageNum:thisEditionPage.origPageNum,pageName:thisEditionPage.pageName,description:thisArticle.description,author:c,type:m,navType:m,articleGuid:a,headline:g.article.headline!=null?g.article.headline.replace(/<[^>]*>/g,""):"",section:l.getSectionName(thisEditionPage.origPageNum),contentItemId:j,articleNumber:f,articleExternalId:!!g&&!!g.article?g.article.uniqueId:null,contentUrl:!!g&&!!g.article?g.article.shareUrl:null};var p=l.getArticlecarousel();if(p!=null&&p.articleToTrackForOpen==a){trackReaderEvent("openArticle",k);p.articleToTrackForOpen=null}trackReaderEvent("article",k)}else{if(g.config.page!=null){var h=g.config.page.page;if(editionFlatplanData.pageGroups[h-1]!=null){var b=editionFlatplanData.pageGroups.filter(function(q){return q.pages[0].origPageNum==h});if(!!b&&b.length>0){thisEditionPage=!!b&&!!b[0].pages&&!!b[0].pages[0]?b[0].pages[0]:null}if(!thisEditionPage){thisEditionPage=editionFlatplanData.pageGroups[h-1+pageOffset].pages[0]}var c="";var e=l.mediaStore.media.allArticles;var n=o[thisArticle.file];if(n!=null){c=n.author}else{if(thisArticle!=null&&thisArticle.byline!=null&&thisArticle.byline.trim()!=""){c=thisArticle.byline}}var k={pageNum:thisEditionPage.pageNum,pageName:thisEditionPage.pageName,description:thisArticle.description,author:c,type:m,navType:m,articleGuid:thisArticle.guid,section:l.getSectionName(thisEditionPage.origPageNum),articleNumber:f};trackReaderEvent("article",k)}}}}l.trackArticleTurnMather(f,m,g);if(window.htlbid==null){g.newPageViewForHtlbidCustomAdPending=true}else{this.sendNewPageViewForHtlbidCustomAd()}},sendNewPageViewForHtlbidCustomAd:function(){try{if(window.htlbid!=null){htlbid.cmd=htlbid.cmd||[];htlbid.cmd.push(function(){htlbid.newPage()})}}catch(a){console.warn("[TrackingController]: Error Caught\n",a)}},returnEditionPage:function(a){var c=this;var b=editionFlatplanData.pageGroups.filter(function(d){return d.pages[0].origPageNum==a});if(!!b&&b.length>0){thisEditionPage=!!b&&!!b[0].pages&&!!b[0].pages[0]?b[0].pages[0]:null}if(!thisEditionPage){thisEditionPage=editionFlatplanData.pageGroups[a-1+pageOffset].pages[0]}return thisEditionPage},trackArticleTurnMather:function(f,m,g){var l=this;if(typeof matherAnalyticsInstance!="undefined"){try{var k=!!g&&!!g.article?g.article:null;var d=!!k?(k.pageNumber!=null?k.pageNumber:(k.parentpage!=null?k.parentpage:-1)):-1;var a=!!k?(k.guid!=null&&!!k.guid?k.guid:(k.id!=null&&!!k.id?k.id:null)):null;var e=!!k?(k.byline!=null&&k.byline?k.byline:(k.author!=null&&!!k.author?k.author:"")):"";var b=!!k?k.headline:"";var c=[d];var o=l.returnEditionPage(g.config.page.page);var n=l.getSectionName(o.origPageNum);var h=l.getApplication().getController("TrackingController").getSubscriberInfoForMather().userId;matherAnalyticsInstance.sendEvent({detail:{trackingData:{"app-data":publicationName+", version "+versionNumber,"app-id":publicationguid,"app-name":publicationName,"date-time-stamp":new Date().toUTCString(),"edition-date":typeof publishDate!="undefined"?publishDate:editionName,"edition-id":editionguid,"edition-name":editionName,"edition-publish-datetime":typeof publishDateTime!="undefined"?publishDateTime:null,orientation:l.returnOrientation(),"parent-page-number":!!c?c.toString():"","pub-id":publicationguid,"pub-name":publicationName,section:n,"user-id":h,"user-information":h,useragent:navigator.userAgent,"article-id":a,"article-number":parseInt(f)+1,author:e,headline:b}}},{properties:{documentTitle:"%PAGETITLE%",pageNumber:"%PGNO%",pageType:"Article",section:"%SECTION%",userId:"%USERID%",articleId:"%ARTICLEID%",articlePublishTime:"%ARTICLEPUBTIME%",articleUpdateTime:"%ARTICLEUPDATETIME%",author:"%AUTHOR%"}})}catch(j){console.warn("[TrackingController]: Error Caught\n",j)}}},readerArticleCloseAndReset:function(d,a){var c=this;c.readerArticleClose(d);c.stopReading();var b=c.returnOrientation();if(b!=c.startArticleOrientation){c.getReaderCarousel().onResize(null)}},getSectionName,trackTribune,readerArticleClose:function(d){var j=this;var f=j.getReader();var a=j.getReaderCarousel();var p=a.getItems().items;var n=a.getPageNumber()+1;var q=j.getArticlecarousel();q.carouselDestroyed=true;var m=true;if(q!=null){if(q.getActiveItem().config.page!=null){var c=q.getActiveItem().config.page.page;if(settings.reader.interstitialPageFlow!=null&&c!=null){c=flatPlanData.pdfPages[c-1].pages[0].pageNum}}else{m=false}}if(q.getActiveItem()!=null&&q.getActiveItem().id!=null&&q.getActiveItem().id.indexOf("live")!=-1){m=false;if(currentProfile=="desktop"){if(a._mode=="double"&&a._zoomMode=="fit"){j.getApplication().getController("PageTurnController").setupKeys()}else{j.keyControls()}}}try{if(localStorage.getItem("returnToPage"+publicationguid)!=null){if(localStorage.getItem("returnToPage"+publicationguid)=="false"){m=false}}}catch(h){}j.checkAdvertTimer();mainPanel.fireEvent("resumeAdvertInterval");j.trackCloseArticle();d.highlightMode=false;if(typeof settings!="undefined"&&settings.articlepopover!=null&&(settings.articlepopover.jumpToPageOnClose==null||settings.articlepopover.jumpToPageOnClose=="false")){m=false}if(j.closingFromPageThumbnailClick===true){m=true}if(m){if(currentProfile=="desktop"){var l=n;var k=l;if(a._mode=="double"||settings.reader.interstitialPageFlow!=null){var k=j.returnLandscapePageNo(n);l=flatPlanData.reversePageMapper[n];k=flatPlanData.reversePageMapper[l]}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.reverse=="true"){c=flatPlanData.pageGroups.length+1-c}if(l!=c&&k!=c){a.jumpToPage(c-1,true)}Ext.Viewport.remove(d);if(a._mode=="double"&&a._zoomMode=="fit"){j.getApplication().getController("PageTurnController").setupKeys()}else{j.keyControls()}}else{if(currentProfile=="phone"){if(j.getArticlereader()==null){if(d.isLive==null){var l=n;var k=l;if((j.returnOrientation()=="landscape"&&a._mode=="double")||settings.reader.interstitialPageFlow!=null){var k=j.returnLandscapePageNo(n);l=flatPlanData.reversePageMapper[n];k=flatPlanData.reversePageMapper[l]}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.reverse=="true"){c=flatPlanData.pageGroups.length+1-c}if(n!=c&&k!=c){var o=a._landscapePageIncrement;if(j.returnOrientation()=="landscape"&&a._mode=="double"){a._overrideLandscape=true;a._landscapePageIncrement=2}else{a._landscapePageIncrement=1}a.jumpToPage(c-1,true);a._landscapePageIncrement=o;a._overrideLandscape=false}}}mainPanel.remove(d,true);if(articleMode=="dynamic"){mainPanel.setActiveItem(j.getArticlereader())}var b=j.getArticlescontainer();if(b!=null){b.element.dom.style.visibility="visible"}}else{var b=j.getArticlescontainer();var l=n;var k=l;if(d.isLive==null){if((j.returnOrientation()=="landscape"&&a._mode=="double")||settings.reader.interstitialPageFlow!=null){var k=j.returnLandscapePageNo(n);l=flatPlanData.reversePageMapper[n];k=flatPlanData.reversePageMapper[l]}if(b!=null){b.element.dom.style.visibility="visible"}if(articleMode!="dynamic"){mainPanel.setActiveItem(f);mainPanel.remove(d,true);if(n!=c&&k!=c){var o=a._landscapePageIncrement;if(j.returnOrientation()=="landscape"&&a._mode=="double"){a._overrideLandscape=true;a._landscapePageIncrement=2}else{a._landscapePageIncrement=1}a.jumpToPage(c-1,true);a._landscapePageIncrement=o;a._overrideLandscape=false}}else{if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.reverse=="true"){c=flatPlanData.pageGroups.length+1-c}if(j.getArticlereader()==null){if(n!=c&&k!=c){var o=a._landscapePageIncrement;if(j.returnOrientation()=="landscape"&&a._mode=="double"){a._overrideLandscape=true;a._landscapePageIncrement=2}else{a._landscapePageIncrement=1}a.jumpToPage(c-1,true);a._landscapePageIncrement=o;a._overrideLandscape=false}}}}mainPanel.remove(d,true);mainPanel.setActiveItem(j.getArticlereader())}}}else{d.destroy();var g=j.getArticlereader();if(currentProfile=="phone"&&g!=null){mainPanel.setActiveItem(g)}}if(settings.articlepopover!=null&&settings.articlepopover.readAloud!=null&&window.speechSynthesis!=null){j.stopReading()}mainPanel.viewType="reader";if((Ext.os.is.iOS&&iOSVersion()=="10.3"&&currentProfile=="phone")||((currentProfile=="desktop"||Ext.os.is.Android)&&(Ext.browser.is.Chrome||Ext.browser.name=="ChromeMobile"))){a.getActiveItem().fireEvent("setupPrintContainer",a.getActiveItem())}if(Ext.os.is.iOS){a.onSizeChange();var e=a.getActiveItem();if(e!=null&&e.paintCheck!=null&&!e.paintCheck()){e.imageLoaded()}}},trackCloseArticle:function(){var h=this;var l=h.getArticlecarousel();var d=l.getActiveItem();if(typeof trackReaderEvent!="undefined"&&(!d.isAdvert||d.isAdvert==null)){var k=h.mediaStore.media.article;thisArticle=k[d._pageNo];if(d.config.page!=null&&d.article!=null){try{var e=d.config.page.page;thisEditionPage=editionFlatplanData.pageGroups[e-1].pages[0];var a="";var c=h.mediaStore.media.allArticles;var j=k[thisArticle.file];if(j!=null){a=j.author}else{a=d.article.byline}if(settings.newsday!=null){a=d.article.byline;if(d.article.reporters!=null){for(var b in d.article.reporters){a+=", "+d.article.reporters[b].name}}}var g={pageNum:thisEditionPage.pageNum,pageName:thisEditionPage.pageName,description:thisArticle.description,author:a,articleGuid:thisArticle.guid,headline:d.article.headline!=null?d.article.headline.replace(/<[^>]*>/g,""):"",section:h.getSectionName(thisEditionPage.pageNum)};trackReaderEvent("closeArticle",g)}catch(f){}}else{if(d.config.page!=null){try{var e=d.config.page.page;thisEditionPage=editionFlatplanData.pageGroups[e-1].pages[0];var a="";var c=h.mediaStore.media.allArticles;var j=k[thisArticle.file];if(j!=null){a=j.author}var g={pageNum:thisEditionPage.pageNum,pageName:thisEditionPage.pageName,description:thisArticle.description,author:a,articleGuid:thisArticle.guid,section:h.getSectionName(thisEditionPage.pageNum)};trackReaderEvent("closeArticle",g)}catch(f){}}}}},onArticleOpen:function(){var b=this;if(b.getLayouttoolbar()!=null&&b.getLayouttoolbar().ttsToggle!=null){var a=b.getLayouttoolbar().ttsToggle}else{var a=null}b.onArticleHide(a)},onArticleHide:function(a){var b=this;if(window.speechSynthesis.paused==true){window.speechSynthesis.resume()}if(window.speechSynthesis.speaking==true){window.speechSynthesis.cancel()}if(a!=null){a.status="STOPPED"}},readerArticleHide:function(b){var a=this;if(currentProfile=="desktop"){if(articleMode=="dynamic"){a.getApplication().getController("ArticleController").readerarticlehide()}else{a.keyControls()}}else{}},returnLandscapePageNo,returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},puzzleArchive:function(g){var c=this;var b=c.getArticlecarousel();var f=b.getActiveItem();var d=f.content;if(currentProfile=="desktop"){var e="InfinityMobile.view.desktop.ReaderPuzzleArchive"}else{var e="InfinityMobile.view.ReaderPuzzleArchive";d=f.contentCard}var a=Ext.create(e,{puzzleArchiveParent:f});d.add(a);d.setActiveItem(a);f.bottomBar.setHeight(0)},archiveInitialized,puzzleArchiveStoreLoad:function(f){var g=this;var h=f.puzzleArchive;var d=f.data.items[0].raw;if(d.archive!=null){h.archiveLength=d.archiveLength;for(var e=h.location;e<h.location+9;e++){if(e<d.archive.length){var l=d.archive[e];var j=Ext.create("InfinityMobile.view.ReaderPuzzleArchiveItem",{image:l.image,text:l.name,mediaobject:l.guid,puzzleArchive:h})}h.container.add(j)}var a=Math.ceil(h.archiveLength/10);if(a>=9){for(var k=1;k<10;k++){var c=Ext.create("InfinityMobile.view.ReaderArchivePageButton",{pageNo:k,puzzleArchive:h});h.pagesControl.add(c)}}else{for(var k=1;k<=a;k++){var c=Ext.create("InfinityMobile.view.ReaderArchivePageButton",{pageNo:k,puzzleArchive:h});h.pagesControl.add(c)}}}h.page=1;var b=g.getReaderarticlepopover();b.setMasked(false)},loadPuzzleItem:function(e){var d=this;var b=e.config.puzzleArchive;var a=b.config.puzzleArchiveParent;var c=a.content;a.articleguid=e.config.mediaobject;a.getContent();var f=a.content;if(currentProfile!="desktop"){f=a.contentCard}f.remove(b);f.setActiveItem[c];a.element.down(".x-innerhtml").dom.style.height="";a.bottomBar.show();a.bottomBar.setHeight(60)},closeArchive:function(b){var c=this;var a=c.getArticlecarousel();var e=a.getActiveItem();var d=e.content;if(currentProfile!="desktop"){d=e.contentCard}d.remove(b);d.setActiveItem[0];e.bottomBar.setHeight(60)},puzzlePrint:function(f){var e=this;if(currentProfile=="desktop"){var b=f.element.down("img").dom.src;var c="print.aspx?edid="+editionguid+"&type=puzzle&url="+encodeURIComponent(b);window.open(c)}else{var b=f.element.down("img").dom.src;var d="<img src='"+b+"' style='max-width:21cm; max-height:26.7cm' />";var a=Ext.create("InfinityMobile.view.PrintPreview",{doc:d});Ext.Viewport.add(a);a.show()}},puzzleShare,puzzleInteractive:function(c){var a=this;var b="http://games.courant.com/gamedetails/daily-crossword/";if(settings.menu.gamesLink!=null){b=settings.menu.gamesLink}window.open(b)},jumpToComics:function(a){var b=this;b.articleCarousel.jumpToPage(parseFloat(b.startComic))},jumpToPuzzles,selectTextMode:function(){var e=this;var d=e.getArticlecarousel().items.items;for(var c=0;c<d.length;c++){var b=d[c];var a=e.articleCarousel;if(!e.isPuzzleOrComic(b)){b.toggleToTextMode()}}var f=e.getReaderarticlepopover();if(f!=null){if(f.highlightMode){e.highlightDisable();f.highlightMode=false}else{e.highlightInstructions();f.highlightMode=true}}},isPuzzleOrComic:function(a){var b=this;var c=a.config.page.description;if(c!=null&&(c.indexOf("Comics - ")!=-1||c.indexOf("Puzzles - ")!=-1)){return true}else{return false}},copyToClipboard:function(){var c=this;var b="";var d;var a=c.getReaderarticlepopover();var f=c.getArticlecarousel().getActiveItem();if(f.article!=null&&f.article.articleData!=null){b=f.article.articleData.body}else{if(c.getArticlecarousel().getActiveItem().articleText){b=c.getArticlecarousel().getActiveItem().articleText}else{if(c.getArticlecarousel().getActiveItem().article){var e=c.getCurrentArticle();b=e.headline+String.fromCharCode(13)+e.subHeadline+String.fromCharCode(13)+e.byline+String.fromCharCode(13)+e.body}else{if(c.getArticlecarousel().getActiveItem().initialConfig.page.headline!=null){var e=c.getArticlecarousel().getActiveItem().initialConfig.page;b=e.headline+String.fromCharCode(13)+e.subHeadline+String.fromCharCode(13)+e.byline+String.fromCharCode(13)+e.body}else{}}}}d=new Clipboard(".copyButton",{text:function(){if(b.search("contentHead")!=-1){var k=b.split(/<[^>]*contentHead[^>]*>/g);var h=k[1].slice(0,k[1].indexOf("</div>")).replace(/<[^>]*>/g," ");var j=k[1].slice(k[1].indexOf("</div>"));b=k[0]+h+j+String.fromCharCode(13)}if(b.search("contentDeck")!=-1){var k=b.split(/<[^>]*contentDeck[^>]*>/g);var h=k[1].slice(0,k[1].indexOf("</div>")).replace(/<[^>]*>/g," ");var j=k[1].slice(k[1].indexOf("</div>"));b=k[0]+h+j+String.fromCharCode(13)}if(b.search("contentByline")!=-1){var k=b.split(/<[^>]*contentByline[^>]*>/g);var h=k[1].slice(0,k[1].indexOf("</div>")).replace(/<[^>]*>/g," ");var j=k[1].slice(k[1].indexOf("</div>"));b=k[0]+h+j+String.fromCharCode(13)}b=b.replace(/<\/?p[^>]*>/g,String.fromCharCode(13)).replace(/<br[^>]*>/g,String.fromCharCode(13)).replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&glt;/g,"<").replace(/(&rsquo;|&lsquo;)/g,"'").replace(/&ndash;/g,"-").replace(/&mdash;/g,"\u2014").replace(/&hellip;/g,"...").replace(/(&rdquo;|&ldquo;)/g,'"').replace(/  +/g," ").replace(/\s\s+/g,String.fromCharCode(13)).trim().replace("PREVIOUS IMAGE Image NEXT IMAGE","");var g;b=g(b);return b}});d.on("success",function(k){var g=typeof language!="undefined"&&language.articlePopover!=null&&language.articlePopover.copySuccess!=null?language.articlePopover.copySuccess:"Article copied to clipboard.";var h=new InfinityMobile.view.Overlay({html:"<div class='tick-icon'></div> "+g,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000},cls:"copy-alert font15"});h.setZIndex(2147483641);var j=h.getModal();if(j!=null){j.setZIndex(2147483640)}Ext.Viewport.add(h);setTimeout(function(){h.addCls("hideAlert");if(h.element!=null){$(h.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert")}},800);setTimeout(function(){h.destroy()},1800);k.clearSelection();d.destroy()});console.log(d);d.on("error",function(j){if(currentProfile=="desktop"){var g=new InfinityMobile.view.Overlay({html:"Press CTRL + C (on Windows) or CMD + C (on Mac) to copy.",style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000},cls:"copy-alert font15"});g.setZIndex(2147483641);var h=g.getModal();if(h!=null){h.setZIndex(2147483640)}Ext.Viewport.add(g);d.destroy()}else{var k=typeof language!="undefined"&&language.articlePopover!=null&&language.articlePopover.copyFailure!=null?language.articlePopover.copyFailure:"Article failed to copy.";var g=new InfinityMobile.view.Overlay({html:"<div class='cross-icon'></div> "+k,style:{backgroundColor:"#fff",color:"#000",zIndex:2.111111111111111e+24},cls:"copy-alert font15"});a.add(g);setTimeout,800);setTimeout(function(){g.destroy()},1800)}});if(currentProfile!="desktop"){$(".copyButton").click()}},highlightInstructions:function(){var f=this;var e=typeof language!="undefined"&&language.articlePopover!=null&&language.articlePopover.articleHighlightMode!=null?language.articlePopover.articleHighlightMode:"Highlighted Text Mode";var b=typeof language!="undefined"&&language.articlePopover!=null&&language.articlePopover.articleHighlightMessage!=null?language.articlePopover.articleHighlightMessage:"Click and drag to highlight copy";var a=typeof language!="undefined"&&language.close!=null?language.close:"Close";var d=new InfinityMobile.view.Overlay({html:'<div class="highlightClose pointerCursor" style="color:rgb(69, 145, 184);position:absolute;top:0px;right:0px;font-size:11px;display:inline-flex;"><div style="padding:3px">'+a+'</div><img  src="../assets/article view/article-close-btn.png" style="width:15px;height:15px;margin:5px;"></div><span style="font-weight:bold;">'+e+"</span><br />"+b,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000,textAlign:"center",lineHeight:1.8},padding:15,zIndex:2147483641,cls:"copy-alert font15"});var c=d.getModal();if(c!=null){c.setZIndex(2147483640)}d.hide;Ext.Viewport.add(d);var g=$(d.element.dom).find(".highlightClose");if(g[0]!=null){g[0].onclick=function(){d.hide()};g[0].addEventListener("touchstart",function(){d.hide()})}},highlightDisable:function(){var d=this;var a=typeof language!="undefined"&&language.articlePopover!=null&&language.articlePopover.articleHighlightDisabled!=null?language.articlePopover.articleHighlightDisabled:"Highlight Text Mode Disabled";var c=new InfinityMobile.view.Overlay({html:a,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000,textAlign:"center",lineHeight:1.8},padding:15,zIndex:1e+21,cls:"copy-alert font15"});var b=c.getModal();if(b!=null){b.setZIndex(2147483640)}Ext.Viewport.add(c);setTimeout(function(){c.addCls("hideAlert");if(c.element!=null){$(c.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert")}},1000);setTimeout(function(){c.destroy()},2000)},translateArticle:function(d){var k=this;var l=k.getArticlecarousel();var f=l.getActiveItem();var a="http://translate.google.com/translate?langpair=en|es&u=";if(settings.translateUrl!=null){a=settings.translateUrl+"?langpair=en|es&u="}var e=window.location.origin;var c=window.location.pathname.split("/");if(f.isLive!=null&&f.isLive){if(f.config.page!=null&&f.config.page.link!=null){var b=f.config.page.link}}else{var j="";if(f.config.page!=null&&f.config.page.guid!=null){j=f.config.page.guid}else{if(f.articleGuid!=null){j=f.articleGuid}}var b=location.protocol+"//"+location.host+"/infinity/article_popover_share.aspx?guid="+j+"&html5="+currentProfile;var g=b;try{b=k.getApplication().getController("AppController").addPwaAppCodeQueryParamToUrl(b)}catch(h){b=g;console.warn("[ArticlePopoverController]: Error Caught\n",h)}finally{g=null}if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareQueryString!=null&&settings.sharing.articleShareQueryString!=""){if(b.indexOf("?")>=0){b+="&"+settings.sharing.articleShareQueryString}else{b+="?"+settings.sharing.articleShareQueryString}}}a+=encodeURIComponent(b);window.open(a)},translate,keyControls:function(){var d=this;var a=d.getReaderCarousel();var c=false;var b=false;window.onkeyup=function(f){f.stopPropagation();if(f.keyCode==91){c=false}if(f.keyCode==37||f.keyCode==39){b=false}};window.onkeydown=function(f){if(f.keyCode==91){c=true}if($("#slider").val()>1){f.stopImmediatePropagation();if(f.keyCode==39){if(a.getActiveItem().getScrollable().getScroller().position.x+50<a.getActiveItem().getScrollable().getScroller().maxPosition.x){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x+50)}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().maxPosition.x)}}else{if(f.keyCode==37){if(a.getActiveItem().getScrollable().getScroller().position.x-50>0){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x-50)}else{a.getActiveItem().getScrollable().getScroller().scrollTo(0)}}}}else{f.stopImmediatePropagation();if(f.keyCode==39){if(!c){if(!b){b=true;d.getApplication().getController("PageTurnController").goRight()}}}else{if(f.keyCode==37){if(a.getActiveItem().config.pageNo>=1){if(!c){if(!b){b=true;d.getApplication().getController("PageTurnController").goLeft()}}}}}}if(f.keyCode===38){if(a.getActiveItem().getScrollable().getScroller().position.y-50>0){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().position.y-50);if(a.getActiveItem().zoomMode!="fit"){d.getApplication().getController("ReaderController").showTop();if(a.getActiveItem().getScrollable().getScroller().position.y-30<a.getActiveItem().getScrollable().getScroller().maxPosition.y){d.getApplication().getController("ReaderController").showBottom()}else{d.getApplication().getController("ReaderController").hideBottom()}}}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,0);if(a.getActiveItem().zoomMode!="fit"){d.getApplication().getController("ReaderController").hideTop();d.getApplication().getController("ReaderController").showBottom()}}}if(f.keyCode===40){if(a.getActiveItem().getScrollable().getScroller().position.y+50<a.getActiveItem().getScrollable().getScroller().maxPosition.y){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().position.y+50);if(a.getActiveItem().zoomMode!="fit"){d.getApplication().getController("ReaderController").showBottom();if(a.getActiveItem().getScrollable().getScroller().position.y+30>0){d.getApplication().getController("ReaderController").showTop()}else{d.getApplication().getController("ReaderController").hideTop()}}}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().maxPosition.y);if(a.getActiveItem().zoomMode!="fit"){d.getApplication().getController("ReaderController").hideBottom();d.getApplication().getController("ReaderController").showTop()}}}}},archivePageChange:function(c,b){var f=this;c.location.location=(b*10);var d=c.config.puzzleArchiveParent.getPage().guid;var g=((b-1)*10);var a=(((b-1)*10)+9);$.ajax({url:"../puzzle_archive.aspx?guid="+d+"&beginning="+g+"&end="+a,success});var e=f.getReaderarticlepopover();e.setMasked({xtype:"loadmask",message:"Loading"})},puzzleArchiveStoreLoadPageChange,archiveNextPage:function(b){var c=this;if(b.page!=null){var a=Math.ceil(b.archiveLength/10);if(b.page<a){c.archivePageChange(b,b.page+1)}}},archivePreviousPage,playArticleTTS:function(o,j){var u=this;o.status="PLAYING";if(j){if(j=="noicon"){}else{if(j=="na"){o.addCls("playing")}else{j.addCls("playing")}}}if(currentProfile=="desktop"){var b=u.getLayouttoolbar();if(b!=null){b.ttsToggle.addCls("playing");b.ttsToggle.status="PLAYING"}var m=u.getReaderMenu();if(m!=null){m.menuLayout.getComponent("editionOptionsSection").getComponent("menuTTS").ttsicon.addCls("playing")}ttsFlag.status="PLAYING"}if(window.speechSynthesis.speaking==true){window.speechSynthesis.cancel()}var l="";if(o.xtype=="layouttoolbaricon"||o==ttsFlag){var a=u.getReaderCarousel();var c="?";var e=0;if(settings.leftSideAd!=null){e=1}if(u.returnOrientation()=="portrait"||a.getMode()!="double"){var h=a.getActiveItem();var q=h.getPageNo();c+="dpsmode=single";if(typeof editionFlatplanData!="undefined"&&editionFlatplanData!=null){var d=editionFlatplanData.pageGroups[q+e];var n=d.pages[0].guid;c+="&pageguid="+encodeURIComponent(n);$.ajax({url:"../get_page_text.aspx"+c,async:false,success:function(v){u.speak(v,o,j)}})}}else{var h=a.getActiveItem();var q=h.getPageNo();c+="dpsmode=double";if(typeof editionFlatplanData!="undefined"&&editionFlatplanData!=null){var d=editionFlatplanData.pageGroups[q+e];var n=d.pages[0].guid;if(q%2==1){c+="&leftguid="+encodeURIComponent(n);var s=editionFlatplanData.pageGroups[q+1+e];if(s!=null){var f=s.pages[0].guid;c+="&rightguid="+encodeURIComponent(f)}}else{c+="&rightguid="+encodeURIComponent(n);var k=editionFlatplanData.pageGroups[q-1+e];if(k!=null){var r=k.pages[0].guid;c+="&leftguid="+encodeURIComponent(r)}}$.ajax({url:"../get_page_text.aspx"+c,async:true,success})}}}else{if(u.getArticlecarousel().getActiveItem().articleText){l=u.getArticlecarousel().getActiveItem().articleText;u.speak(l,o,j)}else{if(u.getArticlecarousel().getActiveItem().article){var g=u.getCurrentArticle();var t=g.body;var p=document.createElement("textarea");p.innerHTML=t;var t=p.value;l=g.headline+". "+g.subHeadline+". "+g.byline+". "+t;u.speak(l,o,j);delete p}else{if(u.getArticlecarousel().getActiveItem().initialConfig.page.headline!=null){var g=u.getArticlecarousel().getActiveItem().initialConfig.page;l=g.headline+". "+g.subHeadline+". "+g.byline+". "+g.body;u.speak(l,o,j)}else{u.stopArticleTTS(o,j)}}}}},resumeArticleTTS,pauseArticleTTS,stopArticleTTS,getCurrentArticle,callbackArticleTTS,getPageText,setArticlePopoverHeight,sectionPopup,emailArticleShare:function(l,d,f){var k=this;var o=k.getArticlecarousel();var m=k.mediaStore.media.article;var e=o._pageNumber;var a=d+f;if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareUrl!=null){a=settings.sharing.articleShareUrl.replace("{{DOMAIN}}",window.location.hostname).replace("{{GUID}}",f).replace("{{PBID}}",publicationguid)}var c=a;try{a=k.getApplication().getController("AppController").addPwaAppCodeQueryParamToUrl(a)}catch(h){a=c;console.warn("[ArticlePopoverController]: Error Caught\n",h)}finally{c=null}if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareQueryString!=null&&settings.sharing.articleShareQueryString!=""){if(a.indexOf("?")>=0){a+="&"+settings.sharing.articleShareQueryString}else{a+="?"+settings.sharing.articleShareQueryString}}a=encodeURIComponent(a);if(Ext.browser.is.Safari&&currentProfile=="phone"&&(typeof EDITIONAPP!="undefined"&&EDITIONAPP)){window.parent.postMessage({type:"mailto",articleUrl:l+"&body="+a},"*")}else{window.location.href=l+"&body="+a}if(typeof trackReaderEvent!="undefined"&&typeof trackReaderEvent==="function"&&typeof articleDictionary!=null){var b=o.getActiveItem().config.page;var g=articleDictionary[b.file];var n="";var j={pageNum:g.pageNumber,description:g.headline,socialType:n,shareType:"article"};trackReaderEvent("email",j)}},trackArticleShare:function(g,b,c){var f=this;if(typeof trackReaderEvent!="undefined"&&typeof trackReaderEvent==="function"&&typeof articleDictionary!=null){var j=f.getArticlecarousel();var a=j.getActiveItem().config.page;var d=articleDictionary[a.file];var h="";if(g.indexOf("facebook")>=0){h="facebook"}else{if(g.indexOf("twitter")>=0){h="twitter"}else{if(g.indexOf("linkedin")>=0){h="linkedin"}else{if(g.indexOf("google")>=0){h="google+"}else{if(g.indexOf("pinterest")>=0){h="pinterest"}}}}}var e={pageNum:d.pageNumber,pageNumber:d.pageNumber,description:d.headline,socialType:h,shareType:"article"};trackReaderEvent("social",e)}},playArticleText:function(){var a=this;readAloud.type="ARTICLE";a.setPopoverTooltipText(language.readAloud.stop);switch(readAloud.status){case"STOPPED":case"PLAYING":console.log("PAUSE");window.speechSynthesis.cancel();var b=a.getArticleText();a.read(b);break;case"PAUSED":console.log("CONTINUE");window.speechSynthesis.paused=true;window.speechSynthesis.speaking=false;readAloud.status="PLAYING";window.speechSynthesis.resume();break}},pauseArticleText:function(){var a=this;console.log("PAUSE!");setTimeout(function(){window.speechSynthesis.pause()},3000);readAloud.type="ARTICLE";readAloud.status="PAUSED"},restartArticleText:function(){var a=this;a.stopReading()},stopReading:function(){var a=this;window.speechSynthesis.cancel();a.setPopoverTooltipText(language.readAloud.play);readAloud.status="STOPPED";if(readAloud.controls!=null&&readAloud.controls.playBtn!=null){readAloud.controls.playBtn.addCls("playReadAloud");if(readAloud.controls.type=="play-stop"){readAloud.controls.playBtn.removeCls("stopReadAloud")}else{readAloud.controls.playBtn.removeCls("pauseReadAloud")}}},setPopoverTooltipText,stopArticleText:function(){var a=this;a.stopReading()},readAloudMode:function(b,j){var h=this;var e=h.getReaderarticlepopover();var k=h.getArticlecarousel();var g=k.items.items;if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){if(e!=null){if(e.readAloudMode){h.readAloudDisable();h.disableReadAloud(e);h.stopReading()}else{h.readAloudInstructions(j);e.readAloudMode=true;e.ttsToggle.addCls("playing");h.checkTopBar(e,k)}}}else{if(e!=null){if(e.highlightMode){for(var d=0;d<g.length;d++){var a=g[d];if(!h.isPuzzleOrComic(a)){a.toggleToTextMode()}}e.highlightMode=false}}for(var d=0;d<g.length;d++){var a=g[d];var f=k;if(!h.isPuzzleOrComic(a)){a.toggleToTextMode()}}if(e!=null){if(e.readAloudMode){h.readAloudDisable();h.disableReadAloud(e);h.stopReading()}else{h.readAloudInstructions(j);e.readAloudMode=true;e.ttsToggle.addCls("playing");h.checkTopBar(e,k)}}var c=k.getActiveItem();if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){if(c.mode=="html"){c.loadAdvert()}else{if(c.mode=="frame"){c.loadIframeAdvert()}}}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvertMpu!=null){if(c.mode=="html"){c.loadAdvertMpu()}else{if(c.mode=="frame"){c.loadIframeAdvertMpu()}}}}},disableReadAloud:function(b){var a=this;if(b!=null){a.showArticleTools(b);b.readAloudMode=false;b.ttsToggle.removeCls("playing")}},readAloudInstructions:function(h){var d=this;var e=typeof language!="undefined"&&language.readAloud!=null&&language.readAloud.readAloudMode!=null?language.readAloud.readAloudMode:"Read Aloud Mode";var a=typeof language!="undefined"&&language.readAloud!=null&&language.readAloud.readAloudMessage!=null?language.readAloud.readAloudMessage:"Press the play button to read the article.<br />Alternatively, highlight<br /> the text you wish to be read";var j=typeof language!="undefined"&&language.close!=null?language.close:"Close";var b=new InfinityMobile.view.Overlay({html:'<div class="highlightClose pointerCursor" style="color:rgb(69, 145, 184);position:absolute;top:0px;right:0px;font-size:11px;display:inline-flex;"><div style="padding:3px">'+j+'</div><img  src="../assets/article view/article-close-btn.png" style="width:15px;height:15px;margin:5px;"></div><span style="font-weight:bold;">'+e+"</span><br />"+a,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000,textAlign:"center",lineHeight:1.8},padding:15,zIndex:1e+21,cls:"copy-alert"});var f=b.getModal();if(f!=null){f.setZIndex(2147483640)}var c=function(){b.addCls("hideAlert");if(b.element!=null){$(b.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert")}setTimeout(function(){b.destroy()},1000)};if(h==true){setTimeout(c,3000)}else{b.hide=c}Ext.Viewport.add(b);var g=$(b.element.dom).find(".highlightClose");if(g[0]!=null){g[0].onclick=function(){b.hide()};g[0].addEventListener("touchstart",function(){b.hide()})}d.setupHighlightListener()},setupHighlightListener,hideArticleTools,showArticleTools:function(a){if(a!=null){if(settings.articlepopover.translate!=null&&a.config.isLive!="true"){a.topBarTranslate.show()}if(settings.articlepopover.copy!=null&&settings.articlepopover.copy=="true"){a.copyButton.show()}if(settings.articlepopover.print!=null&&settings.articlepopover.print=="true"&&(!(Ext.os.is.Android&&Ext.browser.is.Firefox)&&(navigator.userAgent.indexOf("EdgiOS")==-1))){a.topBarPrint.show()}if(settings.articlepopover.articleHighlight!=null&&settings.articlepopover.articleHighlight=="true"){a.topBarSelectText.show()}a.readAloudControls.hide()}},getArticleText:function(){var e=this;var j=e.getArticlecarousel();if(j!=null){var d=j.getActiveItem();if(d!=null){var b=d.element.down(".articleiframe")}if(b==null){b=d.element.down(".article-template-frame")}}var g="";if(b!=null){var f=b.dom.contentDocument;if(window.getSelection){g=f.getSelection().toString()}else{if(f.selection&&f.selection.type!="Control"){g=f.selection.createRange().text}}if(g.trim().length>0){return g}else{var c=e.getArticlecarousel().getActiveItem();if(c.article!=null&&c.article.articleData!=null){var k=b.dom.contentDocument||b.dom.contentWindow.document;return k.body.innerHTML}else{if(e.getArticlecarousel().getActiveItem().articleText){g=e.getArticlecarousel().getActiveItem().articleText.replace("NEXT IMAGE<img","<img").replace("PREVIOUS IMAGE<img","<img").replace(">Image</div>","></div>");return g}else{if(e.getArticlecarousel().getActiveItem().article){var d=e.getCurrentArticle();var h=d.body;var a=document.createElement("textarea");a.innerHTML=h;var h=a.value;g=d.headline+". "+d.subHeadline+". "+d.byline+". "+h;return g;delete a}else{if(e.getArticlecarousel().getActiveItem().initialConfig.page.headline!=null){var d=e.getArticlecarousel().getActiveItem().initialConfig.page;g=d.headline+". "+d.subHeadline+". "+d.byline+". "+d.body;return g}else{e.stopArticleTTS(toggle,alticon)}}}}}}},read:function(h){var f=this;if(h!=null){h=h.split("'").join("\u2018").replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/\s\s+/g," ").trim();if(!h.startsWith("<<Error>>")){if(h.length>200&&(Ext.os.is.Android)){sentences=h.split(". ");for(var d=0;d<sentences.length;d++){sentence=sentences[d].trim();if(sentence.length>0){audio=new SpeechSynthesisUtterance(sentence);audio.lang=settings.articlepopover.readAloud.lang;if(navigator.appVersion.indexOf("Edge")==-1){audio.voice=f.getVoice(window.speechSynthesis,settings.articlepopover.readAloud.lang)}if(navigator.appVersion.indexOf("Edge")==-1&&Ext.browser.is.Chrome){audio.rate=0.6}else{audio.rate=0.8}if(d==sentences.length-1){audio.onend=function(){f.stopReading()}}readAloud.utterance=audio;window.speechSynthesis.speak(audio);readAloud.status="PLAYING";readAloud.text=h}}}else{if(Ext.browser.is.Chrome){readAloud.offset=0;var b=new SpeechSynthesisUtterance(h);b.rate=0.7;if(navigator.appVersion.indexOf("Edge")==-1){var g=false;if(Ext.os.is.MacOS){try{g=f.returnVoiceName(settings.articlepopover.readAloud.lang)}catch(e){console.warn(e)}}if(!!g){try{var a=window.speechSynthesis.getVoices();b.lang=settings.articlepopover.readAloud.lang;var c=jQuery.grep(a)[0]}catch(e){console.warn(e)}b.voice=c||null}else{b.voice=f.getVoice(window.speechSynthesis,settings.articlepopover.readAloud.lang)}}else{b.rate=0.9}readAloud.status="PLAYING";readAloud.text=h;if(readAloud.voicesLoaded||navigator.appVersion.indexOf("Edge")!=-1){f.chunkSpeechUtterance(b,function(){f.stopReading()}),function(){f.stopReading()}}else{readAloud.callback=function(){f.chunkSpeechUtterance(b,function(){f.stopReading()}),function(){f.stopReading()}}}}else{if(f.u==null||currentProfile=="desktop"){f.u=new SpeechSynthesisUtterance()}f.u.text=h;f.u.lang=settings.articlepopover.readAloud.lang;if(navigator.appVersion.indexOf("Edge")==-1&&!(Ext.os.is.iOS||Ext.os.is.MacOS)){f.u.voice=f.getVoice(window.speechSynthesis,settings.articlepopover.readAloud.lang)}if(settings.tts!=null&&settings.tts.rate!=null){f.u.rate=parseFloat(settings.tts.rate)}else{if(navigator.appVersion.indexOf("Edge")==-1&&Ext.browser.is.Chrome){f.u.rate=0.6}else{f.u.rate=0.8}}if(settings.tts!=null&&settings.tts.pitch!=null){f.u.pitch=parseFloat(settings.tts.pitch)}f.u.onend=function(){f.stopReading()};f.u.onerror=function(j){f.stopReading()};if(Ext.os.is.iOS||Ext.os.is.MacOS){var a=window.speechSynthesis.getVoices();if(a.length==0){a=f.iOsVoices}f.u.lang=settings.articlepopover.readAloud.lang;f.u.voice=f.getVoice(f.u,settings.articlepopover.readAloud.lang);var g=f.returnVoiceName(f.u.lang);if(!!g){var c=jQuery.grep(a,function(j){return j.lang==f.u.lang&&j.name==g})[0];f.u.voice=c||null}else{f.u.voice=jQuery.grep(a)[0]}console.log(f.u);window.speechSynthesis.speak(f.u)}else{setTimeout(function(){console.log(f.u);window.speechSynthesis.speak(f.u)},0)}readAloud.status="PLAYING";readAloud.text=h}}}}},returnVoiceName:function(c){var a=this;var b;if(Ext.os.is.iOS||Ext.os.is.MacOS){switch(c){case"en-US":b="Samantha";break}}return b},chunkSpeechUtterance:function(d,g){var c=this;var b;var h=(readAloud&&readAloud.offset!==undefined?d.text.substring(readAloud.offset):d.text);h.trim();if(d!=null&&d.voice!=null&&d.voice.voiceURI!=null&&d.voice.voiceURI=="native"){b=d;b.text=h;b.addEventListener("end")}else{var j=160;var k=new RegExp("^[\\s\\S]{"+Math.floor(j/2)+","+j+"}[.!?,]{1}|^[\\s\\S]{1,"+j+"}$|^[\\s\\S]{1,"+j+"} ");var a=h.match(k);if(a[0]===undefined||a[0].length<2){if(g!=null){g();readAloud.offset=0}return}var f=a[0];if(f.startsWith(". ")){b=new SpeechSynthesisUtterance(f.replace(". ","  "))}else{b=new SpeechSynthesisUtterance(f)}b.rate=d.rate;b.voice=d.voice;b.lang=d.lang;var e;for(e in d){if(d.hasOwnProperty(e)&&e!=="text"){b[e]=d[e]}}b.addEventListener("end")}console.log(b);setTimeout(function(){if(readAloud.status=="STOPPED"){c.stopReading()}else{window.speechSynthesis.speak(b)}},0)},getVoice,readAloudDisable:function(){var a=this;var b=typeof language!="undefined"&&language.readAloud!=null&&language.readAloud.readAloudDisabled!=null?language.readAloud.readAloudDisabled:"Read Aloud Mode Disabled";a.disableMessage(b)},disableMessage,popoverBurgerMenu:function(){var b=this;var c="InfinityMobile.view.phone.ReaderPopoverMenu";if(currentProfile!="phone"){c="InfinityMobile.view.tablet.ReaderPopoverMenu"}var a=Ext.create(c,{hasComics:b.foundComic,hasPuzzles:b.foundPuzzle});Ext.Viewport.add(a)},sharepopupmenu:function(e,a){var l=this;var m=l.getArticlecarousel();var d=l.mediaStore.media.uniquearticle;var m=l.getArticlecarousel();var c=m.getPageNumber();var g=m.getActiveItem().config.page;console.log(m.getActiveItem());var b="http://"+window.location.hostname+"/infinity/article_popover_share.aspx?guid="+g.guid;if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareUrl!=null){b=settings.sharing.articleShareUrl.replace("{{DOMAIN}}",window.location.hostname).replace("{{GUID}}",g.guid).replace("{{PBID}}",publicationguid)}var h=b;try{b=l.getApplication().getController("AppController").addPwaAppCodeQueryParamToUrl(b)}catch(k){b=h;console.warn("[ArticlePopoverController]: Error Caught\n",k)}finally{h=null}if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareQueryString!=null&&settings.sharing.articleShareQueryString!=""){if(b.indexOf("?")>=0){b+="&"+settings.sharing.articleShareQueryString}else{b+="?"+settings.sharing.articleShareQueryString}}b=encodeURIComponent(b);var f=g.description;if(typeof settings!="undefined"&&(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true")){var j=articleDictionary[g.file];if(j!=null&&j.articleData&&j.articleData.sharelink){b=j.articleData.sharelink;f=j.articleData.headline}}shareMenu=Ext.create("InfinityMobile.view.ReaderPopoverMenuShare",{url:b,message:f,articleguid:g.guid});a.add(shareMenu)},goToComics:function(a){var b=this;if(b.getReaderarticlepopover()!=null){b.jumpToComics(b.getReaderarticlepopover());a.hide()}},goToPuzzles:function(a){var b=this;if(b.getReaderarticlepopover()!=null){b.jumpToPuzzles(b.getReaderarticlepopover());a.hide()}},loadShareIconsMenu:function(k){var g=this;var a=k.config.url;var c=k.config.message;if(settings.sharing!=null){var f=settings.sharing.allSharing;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){try{f=f.reverse()}catch(e){console.error("[ArticlePopoverController]:\n",e)}}for(var d=0;d<f.length;d++){var h=f[d];var b=settings.sharing[h];var j=Ext.create("InfinityMobile.view.phone.ReaderSharePopupItem",{icon:b.icon,articleLink:b.link,color:"ff0000",url:a,message:c,articleguid:k.articleguid});k.shareBtnsContainer.add(j)}}},articleViewTextSize:function(){var b=this;var a=b.getReaderarticlepopover();a.toggleTextSlider()},articleViewShare,articleViewPrint:function(){var b=this;var c=b.getReaderarticlepopover();var a=c.articleCarousel;if(a!=null){var d=a.getActiveItem();d.printIframe()}},settingsLoaded,getFlippAdvertSetting,articlePageThumbnailClick:function(a){var b=this;b.closingFromPageThumbnailClick=true;b.readerArticleClose(b.getReaderarticlepopover());b.closingFromPageThumbnailClick=false},trackArticleLink:function(a,b){if(typeof trackReaderEvent!=="function"||typeof a!=="object"){return}trackReaderEvent("articleLink",a)}},0,0,0,0,0,0,[InfinityMobile.controller,"ArticlePopoverController"],0));(Ext.cmd.derive("InfinityMobile.controller.TrackingController",Ext.app.Controller,{config:{refs:{main:"#rootPanel",carousel:"infinitecarousel2d"},control:{main:{trackPageTurn:"trackPageTurn",trackArticleTurn:"trackArticleTurn",trackPan:"trackPan",trackZoomLevel:"trackZoomLevel",trackMouseWheel:"trackMouseWheel",trackMenuClose:"trackMenuClose",trackMenuOpen:"trackMenuOpen",trackMenuOption:"trackMenuOption",trackMenuSection:"trackMenuSection",trackMenuHeader:"trackMenuHeader",trackImageGalleryOpen:"trackImageGalleryOpen",trackImageChange:"trackImageChange",trackImageGalleryClose:"trackImageGalleryClose",trackTopBarIcon:"trackTopBarIcon",trackDownload:"trackDownload",initTracking:"initTracking",trackAdvertClick:"trackAdvertClick"}}},init:function(){var b=this;b.trackingType="PS";if(typeof EDITIONAPP=="undefined"||!EDITIONAPP){var a=Ext.getStore("ArchiveStore");a.on({load:"initTracking",scope:this,delay:10})}},initTracking:function(){var a=this;if(settings.tracking!=null){if(settings.tracking.trackingType.toUpperCase()=="OMNITURE"){a.trackingType="OM"}else{a.trackingType=settings.tracking.trackingType.toUpperCase()}}a.setupDataLayerTracking()},setupDataLayerTracking:function(){var c=this;if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&settings.tracking!=null&&settings.tracking.trackingType=="feedEdition"&&typeof TrackingFactory!="undefined"&&typeof ReplicaAnalyticsDataLayer!="undefined"&&c.tracker==null){try{var d=settings.tracking;if(d.iframeTracking){c.tracker=true;if(c.replicaAnalyticsDataLayer==null&&typeof IframeAnalyticsDataLayer!="undefined"){c.replicaAnalyticsDataLayer=new IframeAnalyticsDataLayer(publicationName,publicationguid,versionNumber)}}else{var b=new TrackingFactory();c.tracker=b.setupTracking(d.type,d.id,d.events,d.customDimensions,TrackingOptions.REPLICA,d.trackingConfig);if(c.replicaAnalyticsDataLayer==null&&typeof ReplicaAnalyticsDataLayer!="undefined"){c.replicaAnalyticsDataLayer=new ReplicaAnalyticsDataLayer(publicationName,publicationguid,versionNumber)}}if(c.replicaAnalyticsDataLayer){c.replicaAnalyticsDataLayer.trackEvent("com.pagesuite.replica.launchEdition",Object.create(c.replicaAnalyticsDataLayer.baseData))}if(c.tracker!=null&&c.ReplicaAnalyticsDataLayer){c.dataLayerTrackingSet=true}}catch(a){console.error("[TrackingController]: Error setting up analytics\n",a)}}else{if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&typeof ReplicaAnalyticsDataLayer!="undefined"&&c.tracker==null){if(c.replicaAnalyticsDataLayer==null&&typeof IframeAnalyticsDataLayer!="undefined"){c.replicaAnalyticsDataLayer=new IframeAnalyticsDataLayer(publicationName,publicationguid,versionNumber)}}else{if(typeof trackReaderEvent!="undefined"&&trackReaderEvent!=null){try{trackReaderEvent("editionLoad",{edition:editionguid})}catch(a){console.error("[TrackingController] Error Caught:\n",a)}}}}},trackPageTurn:function(a){var b=this;b.trackPageTurnPS(a);b.trackPageTurnCustom(a);switch(b.trackingType){case"GA":b.trackPageTurnGA(a);break;case"DA":b.trackPageTurnDA(a);break;case"OM":case"OT":default:break}b.trackPageTurnMather(a)},trackPageTurnMather:function(c){var d=this;if(typeof matherAnalyticsInstance!="undefined"){try{var f=d.getSectionInfo(c);var e=f.section;var g=f.sectionsInView;var b=d.getSubscriberInfoForMather().userId;matherAnalyticsInstance.sendEvent({detail:{trackingData:{"app-data":publicationName+", version "+versionNumber,"app-id":publicationguid,"app-name":publicationName,"date-time-stamp":new Date().toUTCString(),"edition-date":typeof publishDate!="undefined"?publishDate:editionName,"edition-id":editionguid,"edition-name":editionName,"edition-publish-datetime":typeof publishDateTime!="undefined"?publishDateTime:null,orientation:d.returnOrientation(),"page-number":c,"parent-page-number":!!c?c.toString():"","pub-id":publicationguid,"pub-name":publicationName,section:g,"section-string":e,"user-id":b,"user-information":b,useragent:navigator.userAgent}}},{properties:{documentTitle:"%PAGETITLE%",email:"%EMAIL%",pageNumber:"%PGNO%",pageType:"Page",section:"%SECTION%",userId:"%USERID%"}})}catch(a){console.warn("[TrackingController]: Error Caught\n",a)}}},getSubscriberGUID:function(){var c=getCookie("subscriber");if(!c){return undefined}var b=new RegExp("(?:^|&)guid(?:=([^&#]*)|&|#|$)","i");var a=b.exec(c,"i");if(!a){return undefined}if(!a[1]){return undefined}return decodeURIComponent(a[1].replace(/\+/g," "))},getSubscriberInfoForMather:function(){var b={userId:""};var c=getCookie("UserAccess-"+publicationguid);if(!!c){try{var d=JSON.parse(c);b.userId=(typeof d==="object"&&"userId" in d)?d.userId:""}catch(a){console.warn("[TrackingController]: Error Caught\n",a)}}return b},trackPageTurnPS:function(a){var c=this;var e="&pr="+a[0];if(a.length>1){e="&pl="+a[0]+"&pr="+a[1]}if(reports!=null&&visitorguid!=null&&startpageNumber!=null&&c.hasOneTrustConsent()){var b=reports+"track.aspx?html5=true&eid="+editionguid+"&vid="+visitorguid+e+"&device="+currentProfile;var d=this.getSubscriberGUID();if(d!=undefined){b+="&subscriber="+d}$.ajax({crossDomain:true,type:"GET",async:true,url:b,cache:false})}},hasOneTrustConsent:function(){if(typeof OneTrust!="undefined"&&settings.oneTrust!=null&&typeof OnetrustActiveGroups!="undefined"){if(settings.oneTrust.categories!=null&&OnetrustActiveGroups.indexOf(settings.oneTrust.categories.analytics)==-1){return false}}return true},setGaCustomerId:function(){var a="";if(typeof getCookie==="function"){a=getCookie("gatid")}if(typeof gtag!="undefined"&&a!=null&&a!=""){gtag("set",{user_id:a,send_page_view:false})}},trackPageTurnGA:function(c){var d=this;if(typeof gtag!="undefined"){var a=d.returnFriendlyPageNumber(c);d.setGaCustomerId();var b={page_title:publicationName+" - "+editionName,page_path:"/"+(a),page_number:a,send_page_view:false};if(typeof settings!="undefined"&&settings.tracking!=null&&settings.tracking.anonymizeIp=="true"){b.anonymize_ip=true}gtag("config",settings.tracking.accoundid,b);gtag("event","page_view",{page_title:publicationName+" - "+editionName,page_path:"/"+(a),send_to:settings.tracking.accoundid})}},trackPageTurnDA:function(b){var c=this;if(typeof trackDaPageView!="undefined"){var a=c.returnFriendlyPageNumber(b);trackDaPageView("PDF|"+editionName+"|"+a,"Digital Edition")}},trackPageTurnCustom:function(b){var e=this;if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&e.tracker==null){e.setupDataLayerTracking()}if(typeof trackReaderEvent!="undefined"){var g=e.getSectionInfo(b);var a=e.returnFriendlyPageNumber(b);var f=g.section;var h=g.sectionsInView;var c=e.getArticlesInView(b);var d=flatPlanData.pdfPages.length;trackReaderEvent("pageTurn",{pageNum:a,pageNumArray:b,section:f,sectionsArray:h,articles:c,totalPages:d})}},getSectionInfo:function(b){var j=this;var a=j.returnFriendlyPageNumber(b);var n=settings.bookmarks.bookmark;var m=null;var g=[];try{if(n!=null&&n.length>0){for(var l in b){var k=b[l];if(isNaN(k)&&typeof flatPlanData!="undefined"&&flatPlanData.friendlyPageMapper!=null){k=flatPlanData.friendlyPageMapper[k]+1}for(var e in n){var c=parseInt(n[e].pageNumber);if(n[e].start!=null){c=n[e].start}var d=n[parseInt(e)+1];var f=null;if(d!=null){f=d.pageNumber;if(d.start!=null){f=d.start}}if(parseInt(k)>=c&&(f==null||parseInt(k)<parseInt(f))){m=n[e].name;g.push(n[e].name);break}}}}}catch(h){console.error("[TrackingController]:\n",h)}return{section:m,sectionsInView:g}},returnFriendlyPageNumber:function(c){var a=this;var b="";if(c.length>1){b=c[0]+"-"+c[1]}else{b=c[0]}return b},trackArticleTurn:function(b){var a=this;a.trackArticleTurnPS(b);a.trackArticleTurnCustom(b);switch(a.trackingType){case"GA":a.trackArticleTurnGA(b);break;case"DA":a.trackArticleTurnDA(b);break;case"OM":case"OT":default:break}a.trackArticleTurnMather(b)},trackArticleTurnMather:function(){var d=this;if(typeof matherAnalyticsInstance!="undefined"){try{var c=[1];var f=d.getSectionInfo(c);var e=f.section;var g=f.sectionsInView;var b=d.getSubscriberInfoForMather().userId;matherAnalyticsInstance.sendEvent({detail:{trackingData:{"app-data":publicationName+", version "+versionNumber,"app-id":publicationguid,"app-name":publicationName,"date-time-stamp":new Date().toUTCString(),"edition-date":typeof publishDate!="undefined"?publishDate:editionName,"edition-id":editionguid,"edition-name":editionName,"edition-publish-datetime":typeof publishDateTime!="undefined"?publishDateTime:null,orientation:d.returnOrientation(),"page-number":c,"parent-page-number":!!c?c.toString():"","pub-id":publicationguid,"pub-name":publicationName,section:g,"section-string":e,"user-id":b,"user-information":b,useragent:navigator.userAgent}}},{properties:{documentTitle:"%PAGETITLE%",pageNumber:"%PGNO%",pageType:"Page",section:"%SECTION%",userId:"%USERID%"}})}catch(a){console.warn("[TrackingController]: Error Caught\n",a)}}},trackArticleTurnPS,trackArticleTurnGA:function(b){var a=this;if(typeof gtag!="undefined"){}},trackArticleTurnDA:function(b){var a=this;if(typeof trackDaArticleView!="undefined"){trackDaArticleView("ARTICLE|"+editionName+"|"+b.headline,"Digital Edition")}},trackArticleTurnCustom:function(b){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("article",b)}},trackEvent,trackEventPS:function(b,f){var c=this;var d="http://reports.pagesuite-professional.co.uk";if(location.protocol=="https:"){d=typeof reports!="undefined"?reports:"https://subscriber.pagesuite-professional.co.uk"}if(b=="link"){var a=d+"/track.aspx?html5=true&link="+f[2]+"_"+f[3];var e=this.getSubscriberGUID();if(e!=undefined){a+="&subscriber="+e}$.ajax({crossDomain:true,type:"GET",async:true,url:a})}else{}},trackEventGA:function(a,c){var b=this;b.setGaCustomerId();ga("send","event",a,"click",c.length>0?c[0]:"",c.length>1?c[1]:"")},trackEventDA:function(a){var b=this;if(typeof trackDaEvent!="undefined"){trackDaEvent(a,"Digital Edition")}},trackEventCustom:function(){var a=this},trackPan:function(a){var c=this;if(typeof trackReaderEvent!="undefined"&&a!=null){var f={};f.zoomScale=a.scale;var d=c.returnCorrectPageNumber(c.getCarousel());var e=d.split("-");f.page=e;var b=c.getArticlesInView(e);f.articles=b;f.pagePos=c.returnPagePosition(a);f.pageWidth=c.returnPageWidth(a);f.pageHeight=c.returnPageHeight(a);f.sidePadding=a.initialTranslateX;trackReaderEvent("panPage",f)}},getArticlesInView:function(a){var f=this;var b=[];try{var h=Ext.getStore("MediaStore").data.items[0]!=null?Ext.getStore("MediaStore").data.items[0].raw.media.article:null;if(h!=null&&h.length>0&&a!=null&&a.length>0){for(var c in a){var j=a[c];if(!!flatPlanData.friendlyPageMapper){j=flatPlanData.friendlyPageMapper[j]+1}for(var k in h){var g=h[k];var l=typeof articleDictionary!="undefined"&&!!articleDictionary?articleDictionary[g.file]:{};if(g.page==j){var d={};d.guid=g.file;d["article-id"]=g.file;d.x=g.x;d.y=g.y;d.width=g.width;d.height=g.height;d.page=g.page;d.headline=!!l?l.headline:g.description;d.author=!!l&&!!l.author?l.author:(!!l&&!!l.byline?l.byline:g.byline);if(typeof l=="object"&&!!l){if(l.uniqueId!=null){d["custom-article-id"]=l.uniqueId}if(l.shareUrl!=null){d["content-url"]=l.shareUrl}}b.push(d)}}}}}catch(e){console.warn("[TrackingController] Error Caught:\n",e)}return b},returnCorrectPageNumber:function(a){var e=this;var c=(a._pageNumber+1);var d=a.getData().length;var b=c.toString();if(e.returnOrientation()=="landscape"&&a._mode=="double"){if(c>1&&c<d){if(c%2==0){b=c+"-"+(c+1)}else{b=(c-1)+"-"+c}}}return b},returnOrientation,returnPagePosition:function(c){var e=this;if(c!=null){var b=c.scroller;if(b!=null){var a=(b.position.x/c.scale)-(c.initialTranslateX);var h=(b.position.y/c.scale);var g=c.mode!=null?c.mode:c._mode;var f=e.returnLeftPage(c);if(g=="double"&&(f==null||f.type!="page")){var d=currentProfile=="desktop"?c.width:c.initialImageWidth;a=a-d}return{x:a,y:h}}else{return null}}else{return null}},returnLeftPage:function(a){if(currentProfile=="desktop"){return a.config.leftPage}else{return a.config.previousPage}},trackZoomLevel:function(a){var c=this;if(typeof trackReaderEvent!="undefined"){var f={};f.zoomScale=a.scale;var d=c.returnCorrectPageNumber(c.getCarousel());var e=d.split("-");f.page=e;var b=c.getArticlesInView(e);f.articles=b;f.pagePos=c.returnPagePosition(a);f.pageWidth=c.returnPageWidth(a);f.pageHeight=c.returnPageHeight(a);f.sidePadding=a.initialTranslateX;trackReaderEvent("zoomLevel",f)}},trackMouseWheel,returnPageWidth:function(a){if(currentProfile=="desktop"){return a.width}else{return a.initialImageWidth}},returnPageHeight:function(a){if(currentProfile=="desktop"){return a.height}else{return a.initialImageHeight}},trackMenuClose:function(){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("menuClose")}},trackMenuOpen:function(){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("menuOpen",{})}},trackMenuOption:function(c,b){if(typeof trackReaderEvent!="undefined"){var a={itemId:c};if(c=="quickLinkItem"){a.url=b.config.url}trackReaderEvent("menuOption",a)}},trackMenuSection:function(a){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("menuSection",{name:a.name,pageNumber:a.pageNumber})}},trackMenuHeader:function(a,b){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("menuHeader",{itemId:a.config.itemId,minimized:a.config.minimized})}},trackImageGalleryOpen:function(){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("imageGalleryOpen",{})}},trackImageChange:function(){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("imageChange",{})}},trackImageGalleryClose:function(){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("imageGalleryClose",{})}},trackTopBarIcon:function(a){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("topBarIcon",{event:a})}},trackDownload:function(){var a=this;switch(a.trackingType){case"GA":if(typeof gtag!="undefined"){gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","Download Button",{event_category:"Download",event_label:editionName})}break}},trackAdvertClick:function(r){var q=this;var o=Ext.getStore("SettingStore");if(!o||!o.data.items[0]){return}var n=o.data.items[0].raw;var p=InfinityMobile.app.getController("ReaderController");var s=p&&p.returnCorrectPageNumber(q.getCarousel());if(n==null||n.tracking==null){return}var j=n.tracking.trackingType;if(j!=="GA"||typeof gtag==="undefined"){return}var l={event_category:"Open Advert",page_path:"/"+s,page_number:s};var g="";var a="";if(s.includes("Advertisement")){l.page_path="/Advertisement";l.page_number="Advertisement"}switch(r){case"banner":var c=n&&n.reader&&n.reader.popupAdvert;g="Article Banner Advert";a=c&&c.link;break;case"bannerMPU":var k=n&&n.reader&&n.reader.popupAdvertMpu;g="Article MPU Advert";a=k&&k.link;break;case"interstitial":var d=n&&n.reader&&n.reader.interstitial;g="Interstitial Advert";a=d&&d.link;break;case"inFlow":var e=n&&n.reader&&n.reader.interstitialPageFlow;g="In-Flow Advert";a=e&&e.url;break;case"imageBanner":var f=n&&n.reader&&n.reader.bannerAd;g="Banner Advert";a=f&&f.link;break;case"imageWrapper-left":var h=n&&n.wrapAd;g="Wrapper Advert";a=h&&h.leftSideLink;break;case"imageWrapper-right":var h=n&&n.wrapAd;g="Wrapper Advert";a=h&&h.rightSideLink;break;case"imageSponsor":var b=n&&n.menu&&n.menu.sponsor;g="Menu Sponsor";a=b&&b.link;break;default:return}l.event_label=g;l.value=a;l.send_to=n.tracking.accoundid,gtag("set",{page_title:publicationName+" - "+editionName});try{gtag("event","click",l)}catch(m){console.error("Failed to send GA Event:",m)}}},0,0,0,0,0,0,[InfinityMobile.controller,"TrackingController"],0));(Ext.cmd.derive("InfinityMobile.controller.DataCaptureController",Ext.app.Controller,{config:{refs:{main:"main",datacaptureform:"datacaptureform",articlescontainer:"articlescontainer",layouttoolbar:"layouttoolbar"},control:{main:{checkDataCapture:"checkDataCapture",createDataCapture:"createDataCapture"},datacapture:{submitDataCapture:"submitDataCapture"},datacaptureform:{sendData:"sendData",closeDataCapture:"closeDataCapture"}}},init:function(){var a=this},createDataCapture:function(){var c=this;if(settings.reader.dataCapture!=null){try{var a=localStorage.getItem("datacapture"+publicationguid)}catch(b){var a=null}if(a==null){dataCaptureFunc=function(){if(Ext.os.is.Phone){var d=Ext.create("InfinityMobile.view.phone.DataCaptureForm",{logo:settings.reader.dataCapture.logo,welcomeText:settings.reader.dataCapture.welcomeText,settings:settings.reader.dataCapture})}else{var d=Ext.create("InfinityMobile.view.DataCaptureForm",{logo:settings.reader.dataCapture.logo,welcomeText:settings.reader.dataCapture.welcomeText,settings:settings.reader.dataCapture})}Ext.Viewport.add(d)};if(Ext.getStore("LanguageStore")==null){console.log("language undefined");Ext.getStore("LanguageStore").on({load})}else{dataCaptureFunc()}}}},closeDataCapture,sendData:function(e,f){var d=this;var c="{";if(f.firstname!=null){c+='"firstname":"'+f.firstname+'",'}if(f.surname!=null){c+='"surname":"'+f.surname+'",'}if(f.email!=null){c+='"email":"'+f.email+'",'}if(f.houseNo!=null){c+='"houseNo":"'+f.houseNo+'",'}if(f.address!=null){c+='"address":"'+f.address+'",'}if(f.postcode!=null){c+='"postcode":"'+f.postcode+'",'}if(f.telephone!=null){c+='"telephone":"'+f.telephone+'",'}if(f.keepMeUpdated!=null){c+='"keepMeUpdated":"true",'}if(f.password!=null){c+='"password":"'+f.password+'",'}c+='"consent":[';if(f.consentItems!=null){for(var b in f.consentItems){var a=f.consentItems[b];c+="{";c+='"consentTypeId":"'+a.consentItem.consentTypeId+'",';c+='"checked":"'+a.checkbox.checked+'"';c+="},"}c=c.substring(0,c.length-1)}c+="]";c+="}";$.post("../dataCapture.aspx",{dataCaptureJsonStr:btoa(c),pubid:publicationguid},function(j){try{parser=new DOMParser();var p=parser.parseFromString(j,"text/xml").getElementsByTagName("result")[0];if(p!=null){console.log(p.attributes);var n=p.attributes.message;if(n==null){var l=p.attributes.SubscriberGUID.value;if(typeof setCookie!="undefined"){var m=location.host;loggedIn="true"}var g=d.getLayouttoolbar();if(g!=null&&g.showAccountIcon!=null){g.showAccountIcon()}localStorage.setItem("datacapture"+publicationguid,"true");e.destroy()}else{var o=p.attributes.message.value;var h=Ext.create("InfinityMobile.view.ReaderPrompt",{title:language.errorMsg,message:o});h.show();Ext.Viewport.add(h)}}}catch(k){console.log(k)}});if(d.getArticlescontainer()!=null){d.getArticlescontainer().element.dom.style.visibility=""}},checkDataCapture,submitDataCapture},0,0,0,0,0,0,[InfinityMobile.controller,"DataCaptureController"],0));(Ext.cmd.derive("InfinityMobile.controller.PrintController",Ext.app.Controller,{config:{refs:{main:"main",printmenu:"printmenu",printItem:"printitem",articlescontainer:"articlescontainer",carousel:"infinitecarousel2d",articleCarousel:"articlecarousel",readerarticlepopover:"articleview"},control:{main:{loadPrintMenu:"loadPrintMenu",printArticleTemplate:"printArticleTemplate",newPWAPrint:"newPWAPrint"},printmenu:{loadPages:"loadPages",close:"closePrint",selectAll:"selectAll",selectNone:"selectNone",print:"print",enableArticlesContainer:"enableArticlesContainer"},printItem:{toggleCheckBox:"toggleCheckBox"},readerarticlepopover:{articlePrint:"articlePrintInternal"},readerpuzzlepopoveritem:{puzzlePrintMobile:"puzzlePrintInternal"},printscreen:{back:"printBack",printIframe:"printIframe"}}},init:function(){var b=this;canResize=true;printingClipping=false;b.internalPrint=false;b.printingIframe=false;window.onbeforeprint=function(){if(b.internalPrint==false&&!printingClipping&&!b.printingIframe&&!Ext.os.is.iOS){b.browserPrint();b.trackNativePrint()}};var a=window.matchMedia("print");a.addListener(function(c){if(c.matches){console.log(c.matches);if((((currentProfile=="desktop"||Ext.os.is.Android)&&(Ext.browser.is.Chrome||Ext.browser.name=="ChromeMobile")))||(Ext.os.is.iOS&&iOSVersion()=="10.3")){}else{canResize=false;if(b.internalPrint==false&&!printingClipping&&!b.printingIframe){b.browserPrint();b.trackNativePrint()}}}else{canResize=true;b.internalPrint=false}})},browserPrint:function(){var c=this;var e=mainPanel.getActiveItem();if(mainPanel.viewType=="reader"){c.setPrintType("page-print");c.pagePrint(false)}else{var b=c.getArticleCarousel();var d=b.getActiveItem();var a=d.config.page;if(settings.reader.iframePopover!=null&&settings.reader.iframePopover=="true"){c.setPrintType("article-print")}else{if(a.description.indexOf("Puzzles")!=-1||a.description.indexOf("Comics")!=-1){c.puzzlePrint(d,false);c.setPrintType("puzzle-print")}else{c.articlePrint(d,false);c.setPrintType("article-print")}}}},loadPrintMenu:function(){var b=this;b.disableArticlesContainer;switch(currentProfile){case"desktop":var a=Ext.create("InfinityMobile.view.desktop.ReaderPrint",{});break;case"phone":var a=Ext.create("InfinityMobile.view.phone.ReaderPrint",{});break;default:var a=Ext.create("InfinityMobile.view.tablet.ReaderPrint",{});break}Ext.Viewport.add(a);a.show()},getSectionName,loadPages:function(a,l){var h=this;var f=Ext.getStore("EditionFlatplan");h.pages=f.data.items[0].raw.pageGroups;var j=h.pages.length;if(typeof loggedIn!="undefined"&&loggedIn.toLowerCase()!="true"&&settings.subscription.pageRestriction!=null){j=parseInt(settings.subscription.pageRestriction.pages)}if((settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")||(settings.reader.reverse=="true")){var c=0;if(typeof loggedIn!="undefined"&&loggedIn.toLowerCase()!="true"&&settings.subscription.pageRestriction!=null){c=h.pages.length-settings.subscription.pageRestriction.pages}for(var e=h.pages.length-1;e>=c;e--){var g=h.createPrintItem(e);if(g!=null){l.add(g)}}}else{if(settings.subscription!=null&&settings.subscription.pageRestriction!=null&&settings.subscription.pageRestriction.type=="unique"&&loggedIn.toLowerCase()!="true"){var k=pagesRead;for(var e in k){var d=k[e];var g=h.createPrintItem(d-1);if(g!=null){l.add(g)}}}else{for(var e=0;e<j;e++){var b=h.createPrintItem(e);if(b!=null){l.add(b)}}}}},createPrintItem:function(d){var g=this;var e=g.pages[d].pages[0];if(e.type=="page"){var f=e.origPageNum!=null?e.origPageNum:e.pageNum;var b=e.pageIndex;var c=f;if(e.pageName!=null&&e.pageName!=""){c=e.pageName}var a=Ext.create("InfinityMobile.view.ReaderPageThumbnail",{editionGuid:editionguid,pageNo:f,pageIndex:b,displayNum:c,thumbType:"page",toggle:true});return a}return null},closePrint:function(a){a.hide()},selectAll:function(c){var e=this;var a=e.getAllPrintItems(c);for(var d=0;d<a.length;d++){var b=a[d];e.checkCheckBox(b)}},selectNone,getAllPrintItems,newPWAPrint:function(){var u=this;var a=u.getCarousel();var q=a.getActiveItem();var p=[];if((a._mode=="double"&&currentProfile=="desktop")||(currentProfile!="desktop"&&u.returnOrientation()=="landscape"&&a._mode=="double")){var g=null;var t=null;if(currentProfile=="desktop"){g=q.config.leftPage;t=q.config.rightPage}else{if(q._pageNo%2==0){g=q._previousPage;t=q._page}else{g=q._page;t=q._nextPage}}if(!!g&&!!g.type&&g.type=="page"){var o=g.origPageNum!=null?g.origPageNum:g.pageNum;p.push(o)}if(!!t&&!!t.type&&t.type=="page"){var j=t.origPageNum!=null?t.origPageNum:t.pageNum;p.push(j)}}else{var b=flatPlanData.pageMapper[a._pageNumber+1];var e=flatPlanData.pageGroups[b-1+pageOffset]!=null?flatPlanData.pageGroups[b-1+pageOffset].pages[0]:null;if(!!e&&!!e.type&&e.type=="page"){p.push(e.origPageNum!=null?e.origPageNum:e.pageNum)}}if(p.length>0){var c="print.aspx?edid="+editionguid+"&device="+currentProfile+"&type=pages&pages=";var n=p.join(",");c+=n;if(currentProfile=="desktop"){mainPanel.fireEvent("print",p.join("|"));window.open(c)}else{var m=Ext.create("InfinityMobile.view.ReaderPrintScreen",{printUrl:c});Ext.Viewport.add(m);m.show()}if(typeof trackReaderEvent!="undefined"&&typeof trackReaderEvent==="function"){try{var h=[];var l=[];for(var f=0;f<p.length;f++){var r=p[f];h.push(r);l.push(this.getSectionName(r))}trackReaderEvent("printPWA",{pageNumArray:h,sectionsArray:l})}catch(s){console.error("[PrintController]:\n",s)}}}else{var d="Page(s) not printable.";var k=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:d});Ext.Viewport.add(k);k.show()}},print:function(g){var m=this;var l=m.getAllPrintItems(g);var f=[];for(var h in l){if(m.getCheckedStatus(l[h])){f[f.length]=l[h]}}if(f.length>0){var e="print.aspx?edid="+editionguid+"&device="+currentProfile+"&type=pages&pages=";var p="";for(var o in f){p+=f[o]._pageNo+","}if(p[p.length-1]==","){p=p.substring(0,p.length-1)}e+=p;if(currentProfile=="desktop"){mainPanel.fireEvent("print",p.replace(/,/g,"|"));window.open(e)}else{var b=Ext.create("InfinityMobile.view.ReaderPrintScreen",{printUrl:e});Ext.Viewport.add(b);b.show()}if(typeof trackReaderEvent!="undefined"&&typeof trackReaderEvent==="function"){var k=f;try{var d=[];var q=[];for(var n=0;n<k.length;n++){var r=k[n];d.push(r._pageNo);q.push(this.getSectionName(r._pageNo))}trackReaderEvent("printPWA",{pageNumArray:d,sectionsArray:q})}catch(j){console.error("[PrintController]:\n",j)}trackReaderEvent("print",f)}}else{var c=typeof language!="undefined"&&language.print!=null&&language.print.printSelectPrompt!=null?language.print.printSelectPrompt:"Please select the page(s) that you would like to print";var a=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:c});Ext.Viewport.add(a);a.show()}},toggleCheckBox:function(a,b){var c=this;if(settings.menu.printSinglePageOnly!=null&&settings.menu.printSinglePageOnly=="true"){c.selectNone(c.getPrintmenu())}if(c.getCheckedStatus(a)){c.uncheckCheckBox(a)}else{c.checkCheckBox(a)}},getCheckedStatus,checkCheckBox:function(a){a.labelCheckfield.setCls("showTick");a.labelCheckfield.check()},uncheckCheckBox,disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer,articlePrintInternal:function(b){var c=this;c.internalPrint=true;var a=c.getArticleCarousel();var d=a.getActiveItem();if(d._page.description!=null&&(d._page.description.indexOf("Puzzles")!=-1||d._page.description.indexOf("Comics")!=-1)){c.puzzlePrintCheck(d)}else{c.setPrintType("article-print");c.articlePrint(b,true)}if(typeof trackReaderEvent!="undefined"&&typeof trackReaderEvent==="function"){if(typeof EDITIONAPP=="undefined"||!EDITIONAPP){trackReaderEvent("printArticle",d)}else{d.article.section=this.getSectionName(d.article.pageNumber);trackReaderEvent("printArticle",d.article)}c.trackNativePrint()}},articlePrint:function(f,e){var g=this;var d=g.getArticleCarousel();var b="phoneArticle";if(currentProfile=="tablet"){b="tabletArticle"}if(d.getActiveItem().content!=null){var a="<div class='"+b+"'>"+d.getActiveItem().content.getHtml()+"</div>";var c="<style>@media print {@page{size: auto;margin: 12mm 12mm 12mm 12mm;}} .printContainer .articleContentHtml5, .printContainer .articleContent{font-size:"+fontEm+"px !important;}</style>"+a;if(typeof NEWPWA!="undefined"&&NEWPWA===true){c="<style>@media print {@page{size: auto;margin: 12mm 5mm 12mm 5mm;}} .printContainer .articleContentHtml5, .printContainer .articleContent{font-size:"+fontEm+"px !important;margin: 12mm;}</style>"+a}}else{var c=""}c=c.replace(/<div*[\sa-zA-Z=\"\'\-0-9:;]* class=[\"\']mpuAdvert[\"\']\s?><\/div>/g,"").replace(/<div\sid\=[\"\']ext-readerarticlepopoveritem-[0-9]*advert[\"\'][a-zA-z0-9\-\=\:\;\s\'\"]*><\/div>/g,"");g.printHtmlAndroid(c,e)},puzzlePrintCheck:function(d){var c=this;if(currentProfile=="desktop"){var a=d.element.down("img").dom.src;var b="print.aspx?edid="+editionguid+"&type=puzzle&url="+encodeURIComponent(a);window.open(b,"_blank")}else{c.puzzlePrint(d,true)}},puzzlePrintInternal,puzzlePrint:function(f,d){var e=this;if(f.printImage!=null){var h=f.printImage.dom.src;var b="<img class='puzzleImage' src='"+h+"' />";b="<img src='"+h+"' style='position:absolute;width:100%;height:100%;object-fit: contain;' />";e.printHtmlAndroid(b,d)}else{var l=e.getArticleCarousel();puzzleHtmlObject=l.getActiveItem().content;var j=/<div class=\"contentImage\">(.*?)(<div class=\"clImageCaption\">[\\w+\\s(),-./\\&%$£@]*<\/div>.*?)?<\/div>/g;var k=j.exec(puzzleHtmlObject.getHtml());if(k!=null&&k[0]!=null){var c=k[0];var a=/<img.+?src=[\"'](.+?)[\"'].*?>/g;var g=a.exec(c);if(g[1]!=null&&g[1].indexOf("left-image-arrow")==-1&&g[1].indexOf("left-image-arrow")==-1){var b="<img src='"+g[1]+"' style='position:absolute;width:100%;height:100%;object-fit: contain;' />";if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){b="<div style='width:100%;height:100%;text-align:center;'><img src='"+g[1]+"' style='position:relative;width:auto;max-height:100%;max-width:100%;height:auto' /></div>"}e.printHtmlAndroid(b,d)}else{e.printHtmlAndroid("",d)}}else{e.printHtmlAndroid("",d)}}},pagePrint:function(f){var j=this;var g=j.getCarousel();var l=editionFlatplanData.reversePageMapper[(g._pageNumber)+1]-1+pageOffset;var d=editionFlatplanData.pageGroups;var k=d[l].pages[0];if(!g.isDPS()){l=editionFlatplanData.pageMapper[l+1]-1}var c="";if(j.returnOrientation()=="landscape"&&g._mode=="double"&&l>=1+pageOffset&&l<(d.length-1)){var a="100%";var m="100%";if(currentProfile=="largetablet"&&Ext.os.is.iPad){a="75%;";m="150%"}if(l%2==pageOffset){var b=l-1;var e=d[b].pages[0];var h="";if(e.type!="sectionpage"){h="top:125%;";c="<div style='width:"+a+";height:"+m+";font-size:0px;text-align:center'>"+j.printPageHtml(e)+"</div>"}if(k.type!="sectionpage"){c+="<div style='width:"+a+";height:"+m+";font-size:0px;text-align:center'>"+j.printPageHtml(k)+"</div>"}}else{var b=l+1;var e=d[b].pages[0];var h="";if(k.type!="sectionpage"){h="top:125%;";c="<div style='width:"+a+";height:"+m+";font-size:0px;text-align:center'>"+j.printPageHtml(k)+"</div>"}if(e.type!="sectionpage"){c+="<div style='width:"+a+";height:"+m+";font-size:0px;text-align:center'>"+j.printPageHtml(e)+"</div>"}}j.setPrintType("page-print page-print-double")}else{if(currentProfile=="largetablet"&&Ext.os.is.iPad){c+="<div style='width:100%;height:150%;font-size:0px;text-align:center'>"+j.printPageHtml(k)+"</div>"}else{if(Ext.os.is.iPad){c+="<div style='width:100%;height:100%;font-size:0px;text-align:center'>"+j.printPageHtml(k)+"</div>"}else{c=j.printPageHtml(k)}}}setTimeout(j.printHtmlAndroid(c,f))},printPageHtml:function(a){var b=this;if(currentProfile=="desktop"){return b.printDesktopPageHtml(a)}else{return b.printMobilePageHtml(a)}},printMobileHtml5Test:function(j){var e=this;var b=j.tileImage[0];var g="bottom:50%";var a="0%;";var c=0;var m="object-position: 100% 0;";var l=j.tileImage[0].src;var k=j.tileImage[1].src;var h=j.tileImage[2].src;var f=j.tileImage[3].src;var d="";d+="<img src='"+l+"' style='width:50%;height:auto%;object-fit:contain;object-position:0 0;' />";d+="<img src='"+h+"' style='width:50%;height:auto%;object-fit:contain;object-position:100% 0;' />";d+="<img src='"+k+"' style='width:50%;height:auto%;object-fit:contain;object-position:0 100%;' />";d+="<img src='"+f+"' style='width:50%;height:auto%;object-fit:contain;object-position:100% 100%;' />";d="<div style='width:100%;height:100%;font-size:0px;' >"+d+"</div>";return d},printMobilePageHtml:function(c){var d=this;var b="";if(c.tileImage!=null){var a=c.tileImage[0].src;var h=c.tileImage[1].src;var g=c.tileImage[2].src;var e=c.tileImage[3].src;var b="";b+="<img src='"+a+"' style='object-fit:contain;object-position:0 0;max-height:49%;max-width:50%;' />";b+="<img src='"+g+"' style='object-fit:contain;object-position:100% 0;max-height:49%;max-width:50%;' /><br />";b+="<img src='"+h+"' style='object-fit:contain;object-position:0 100%;max-height:49%;max-width:50%;' />";b+="<img src='"+e+"' style='object-fit:contain;object-position:100% 100%;max-height:49%;max-width:50%;' />"}else{if(c.image!=null){var f=c.image;if(c.pageNum>1){if(c.image.indexOf("pages.cdn.pagesuite.com")!=-1){f="http://pages.mobile.cdn.pagesuite.com/images/"+d.retrievePageGuid(c)+"/tablet.jpg"}}b+="<img src='"+f+"' style='position:absolute;width:100%;height:100%;object-fit: contain' />"}}return b},printDesktopPageHtml:function(b){var c=this;var a="";var d=b.image;if(settings.page.useMobileFullJpg=="true"){d="http://pages.mobile.cdn.pagesuite.com/images/"+b.guid+"/full.jpg"}else{if(settings.page.highResImage||settings.page.optimisedImage){d=d.replace("page.jpg","largepage.jpg")}else{if(settings.page.jpg!=null&&settings.page.jpg!="page.jpg"){d=d.replace("page.jpg",settings.page.jpg)}}}if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){a='<img src="'+d+'" style="left:50%;transform:translateX(-50%);position:absolute;max-height:100%;max-width:100%;" />'}else{if(Ext.browser.is.Chrome||Ext.browser.is.Safari){a='<img src="'+d+'" style="width:100%;height:100%;object-fit: contain" />'}else{a='<img src="'+d+'" style="position:absolute;width:100%;height:100%;object-fit: contain" />'}}return a},retrievePageGui},returnOrientatio},printHtmlAndroid:function(d,b){var e=this;var c=$(".printContainer")[0];c.innerHTML=d;if(Ext.os.is.Android&&currentProfile=="phone"){var a=$(c).find(".articleContentHtml5")[0];if(a!=null){$(a).addClass("printAndroid")}}if(b){if(Ext.os.is.iOS){}setTimeout(function(){window.print()},100)}},setPrintType:function(b){var a=document.getElementsByClassName("printContainer")[0];if(a!=null){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){b+=" justify-right "}a.className="printContainer "+b}},printBack:function(c){var b=this;if(c!=null){var a=$(".printContainer")[0];a.innerHTML=b.previousContent;b.printingIframe=false;c.destroy()}},printIframe:function(c){var d=this;var a=c.document;if(a!=null){var b=$(".printContainer")[0];if(!d.printingIframe){d.previousContent=b.innerHTML}d.printingIframe=true;b.innerHTML="<style> .printContainer img{ max-height:100%;max-width:100%; } .printContainer div{text-align:center;}</style> "+a.body.innerHTML;window.print()}},trackNativePrint:function(){var s=this;if(typeof EDITIONAPP=="undefined"||!EDITIONAPP){var d=mainPanel.getActiveItem();var g={};if(mainPanel.viewType=="reader"){var b=s.getCarousel();var r=editionFlatplanData.reversePageMapper[(b._pageNumber)+1]-1+pageOffset;var j=editionFlatplanData.pageGroups;var a=j[r].pages[0];if(!b.isDPS()){r=editionFlatplanData.pageMapper[r+1]-1}if(s.returnOrientation()=="landscape"&&b._mode=="double"&&r>=1+pageOffset&&r<(j.length-1)){if(r%2==pageOffset){var l=r-1;var f=j[l].pages[0]}else{var l=r+1;var f=j[l].pages[0]}try{var j=[];var o=[];var n=[a,f];for(var h=0;h<n.length;h++){var q=n[h];o.push(this.getSectionName(q.origPageNum))}}catch(p){console.error("[PrintController]:\n",p)}g.pageNumArray=[a.pageName,f.pageName];g.sectionsArray=o}else{try{var j=[];var o=[];var n=[a,f];for(var h=0;h<n.length;h++){var q=n[h];o.push(this.getSectionName(q.origPageNum))}}catch(p){console.error("[PrintController]:\n",p)}g.pageNumArray=[a.pageName];g.sectionsArray=o}}else{var c=s.getArticleCarousel();var e=c.getActiveItem();if(e!=null&&e.article!=null){var k=e.config.page.page;var m=flatPlanData.pageMapper[k];g.pageNumArray=[flatPlanData.pageGroups[m-1].pages[0].pageName];g.sectionsArray=[e.config.section];g.headline=e.article.headline;g.articleGuid=e.article.guid;g.articleNumber=e.config.page.articleNumber}console.log(e)}console.log(g);if(typeof trackReaderEvent==="function"){trackReaderEvent("printNative",g)}}},printArticleTemplate:function(){var b=this;var a=b.getArticleCarousel();if(a){var d=a.getActiveItem();if(d&&d.content!=null){var c=d.content.element.dom.getElementsByTagName("IFRAME");if(c!=null&&c[0]!=null){c[0].contentWindow.print()}}}}},0,0,0,0,0,0,[InfinityMobile.controller,"PrintController"],0));(Ext.cmd.derive("InfinityMobile.controller.ClippingController",Ext.app.Controller,{config:{refs:{main:"main",clippingbox:"clippingbox",clippingarea:"clippingarea",clippingmenu:"clippingmenu",readerCarousel:"infinitecarousel2d",reader:"reader",readerpageviewer:"readerpageviewer",clippingmenudeleteprompt:"clippingmenudeleteprompt",clippingoptionsmenu:"clippingoptionsmenu",articlescontainer:"articlescontainer",extratopbar:"extratopbar"},control:{main:{createClipping:"createClippingBox"},clippingbox:{createClipping:"createClipping"},clippingmenu:{DeleteClippings:"DeleteClippings"},clippingmenudeleteprompt:{DeleteClippings:"DeleteClippings",deleteItem:"deleteItem"},clippingarea:{createClip:"createClip",resetClippingArea:"resetClippingArea",enableArticlesContainer:"enableArticlesContainer"},clippingprompt:{createClippingBox:"createClippingBox"},readerpageviewer:{resizeClipping:"resizeClipping"},infinitecarousel:{resizeClipping:"resizeClipping"},clippingitems:{deleteItem:"deleteItem"},clippingoptionsmenu:{enableArticlesContainer:"enableArticlesContainer"}}},init:function(){var a=this;a.clippings=[];a.clippingsWidth=[];a.clippingsHeight=[]},createClippingBox:function(){var j=this;var d;var l=j.getReaderCarousel();var b=l.getActiveItem();var e=j.getReader();var c=j.getReaderpageviewer();j.disableArticlesContainer();try{var k=localStorage.getItem("clippingPrompt"+publicationguid)}catch(g){var k=null}if(k!=null){if(currentProfile=="desktop"){var a=Ext.create("InfinityMobile.view.ClippingArea",{readerActiveItem:b,reader:e})}else{var a=Ext.create("InfinityMobile.view.tablet.ClippingArea",{readerActiveItem:b,reader:e})}Ext.Viewport.add(a);a.show();if(currentProfile=="desktop"){var h=j.getExtratopbar();if(h!=null){h.setZIndex(0)}}}else{if(currentProfile=="phone"){var f=Ext.create("InfinityMobile.view.phone.clippingPrompt",{readerActiveItem:b,reader:e})}else{var f=Ext.create("InfinityMobile.view.clippingPrompt",{readerActiveItem:b,reader:e})}}},getPrefi},createClipping:function(n){var j=this;var l=document.getElementById("clipper");var m=n.x;var k=n.y;var a=0;var e=n.readerActiveItem;var g=n.reader;var f=e.zoomDiv.dom.style.transform;var p=f.substring(f.indexOf("scale3d(")+8,f.length-4).split(",");var o=(j.naturalW/e.imagetoload.clientWidth);var h=(j.naturalH/e.imagetoload.clientHeight);if(m!=0&&k!=0){if(document.getElementById("slider").value==1){if(e._mode=="double"){m=n.x-((g.element.dom.clientWidth/2)-e.imagetoload.clientWidth);a=e._pageNo;if(n.x>(g.element.dom.clientWidth/2)){m-=e.imagetoload.clientWidth;a=e._pageNo+1}m=(m*o);if(g.element.dom.clientHeight-40<e.mediaDiv.dom.clientHeight){k=n.y-40+e.getScrollable().getScroller().position.y}else{k=n.y-40;var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.ticker!=null){k=k-(((g.element.dom.clientHeight-80)-e.imagetoload.clientHeight)/2)}else{k=k-(((g.element.dom.clientHeight-40)-e.imagetoload.clientHeight)/2)}}k=k*h}else{m=n.x-(((g.element.dom.clientWidth)-e.imagetoload.clientWidth)/2);m=m*o;a=e._pageNo+1;if(g.element.dom.clientHeight-40<e.mediaDiv.dom.clientHeight){k=n.y-40+e.getScrollable().getScroller().position.y}else{k=n.y-40;var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.ticker!=null){k=k-(((g.element.dom.clientHeight-80)-e.imagetoload.clientHeight)/2)}else{k=k-(((g.element.dom.clientHeight-40)-e.imagetoload.clientHeight)/2)}}k=k*h}a=flatPlanData.reversePageMapper[a];var d="http://clippings.pagesuite.com";if(location.protocol=="https:"){d="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){a=(editionFlatplanData.pageGroups.length-a)+1}var b=d+"/create_clipping.aspx?eid="+editionguid+"&pnum="+a+"&x="+Math.floor(m)+"&y="+Math.floor(k)+"&h="+Math.floor(l.offsetHeight*(j.naturalH/e.imagetoload.clientHeight))+"&w="+Math.floor(l.offsetWidth*(j.naturalW/e.imagetoload.clientWidth))}else{a=e._pageNo;if(n.x>=e.imagetoload.clientWidth){}else{}var d="http://clippings.pagesuite.com";if(location.protocol=="https:"){d="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){a=(editionFlatplanData.pageGroups.length-a)+1}var b=d+"/create_clipping.aspx?eid="+editionguid+"&pnum="+a+"&x="+Math.floor(m)+"&y="+Math.floor(k)+"&h="+Math.floor(l.offsetHeight*(j.naturalH/e.imagetoload.clientHeight)/document.getElementById("slider").value)+"&w="+Math.floor(l.offsetWidth*(j.naturalW/e.imagetoload.clientWidth)/document.getElementById("slider").value)}}j.clippings[j.clippings.length]=b;j.clippingMenu();j.clipper=null;n.destroy()},mapPositio},clippingMenu:function(){var a=this;var b=a.getClippingoptionsmenu();if(b!=null){b.clippingsContainer.removeAll(true,true);b.images=a.clippings;b.addThumbnails();b.show()}else{if(currentProfile=="phone"){var c=Ext.create("InfinityMobile.view.phone.ClippingOptionsMenu",{images:a.clippings,widths:a.clippingsWidth,heights:a.clippingsHeight});Ext.Viewport.add(c);c.show()}else{if(currentProfile=="desktop"){var c=Ext.create("InfinityMobile.view.desktop.ClippingOptionsMenu",{images:a.clippings,widths:a.clippingsWidth,heights:a.clippingsHeight})}else{var c=Ext.create("InfinityMobile.view.ClippingOptionsMenu",{images:a.clippings,widths:a.clippingsWidth,heights:a.clippingsHeight})}}}},DeleteClipping},createClip:function(f,e,g,d,a){var b=this;var c=b.getReaderCarousel();if(currentProfile=="desktop"){if(c._mode=="single"){b.createClipSingle(f,e,g,d,a)}else{b.createClipDouble(f,e,g,d,a)}}else{if(b.returnOrientation()=="portrait"){b.createClipPortrait(f,e,g,d,a)}else{if(c._mode=="single"){b.createClipPortrait(f,e,g,d,a)}else{b.createClipLandscape(f,e,g,d,a)}}}},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},createClipPortrait:function(e,s,l,r,v){var F=this;var C=true;var p=l.image;var k=l.landscapeimage;var t=p;if(t.clientWidth==0){t=k}var d=t.naturalWidth;var c=t.naturalHeight;var j=$(t).offset();var I=l._pageNo+1;if(l.scale==1){var G=c/$(t).height();if(l.scroller.position.y>0){var u=l.scroller.position.y}else{var u=0}var n=parseInt(((parseFloat(e)+5)-j.left+l.scroller.position.x)*G);var m=parseInt(((parseFloat(s)+5)-j.top+l.scroller.position.y-u)*G);var B=parseInt(($(r.element.dom).height()-10)*G);var o=parseInt(($(r.element.dom).width()-10)*G);if((n>d)||(n+o<0)||(m+B<0)||(m>c)){C=false}else{o=parseInt(Math.min(o,(t.clientWidth*G)-n)-1);B=parseInt(Math.min(B,(t.clientHeight*G)-m));if(m<0){var g=m+B;m=0;B=g}if(n<0){var D=n+o;n=0;o=D}if(n<0||n+o>l.initialImageWidth*G||m<0||m+B>l.initialImageHeight*G){C=false}else{I=flatPlanData.pageGroups[I-1+pageOffset]!=null?flatPlanData.pageGroups[I-1+pageOffset].pages[0].origPageNum:I;var H="http://clippings.pagesuite.com";if(location.protocol=="https:"){H="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){I=(editionFlatplanData.pageGroups.length-I)+1}var f=H+"/create_clipping.aspx?eid="+editionguid+"&pnum="+I+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}}else{if(l.scroller.position.y>0){var u=40}else{var u=40}if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){u-=40}}var q=l.scale;var A=l.translateX;var b=parseFloat((l.scroller.position.x)+parseFloat(e));var G=c/($(t).height()*q);var a=parseFloat(l.scroller.position.y+parseFloat(s)-u);var E=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){E=F.returnTopBannerOffset()}var n=parseInt(((b+5)-A)*G);var m=parseInt(((a+5)-E)*G);var B=parseInt(($(r.element.dom).height()-10)*G);var o=parseInt(($(r.element.dom).width()-10)*G);if((n>d)||(n+o<0)||(m+B<0)||(m>c)){C=false}else{o=parseInt(Math.min(o,((t.clientWidth*q)*G)-n)-1);B=parseInt(Math.max(Math.min(B,((t.clientHeight*q)*G)-m),0));if(m<0){var g=m+B;m=0;B=g}if(n<0){var D=n+o;n=0;o=D}if(n<0||n+o>(l.initialImageWidth*q)*G||m<0||m+B>(l.initialImageHeight*q)*G){C=false}else{I=flatPlanData.pageGroups[I-1+pageOffset]!=null?flatPlanData.pageGroups[I-1+pageOffset].pages[0].origPageNum:I;var H="http://clippings.pagesuite.com";if(location.protocol=="https:"){H="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){I=(editionFlatplanData.pageGroups.length-I)+1}var f=H+"/create_clipping.aspx?eid="+editionguid+"&pnum="+I+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}}if(C){$.ajax({url:f,beforeSend:function(){Ext.Viewport.setMasked({xtype:"loadmask",message:language.clippings.clippingSpinner})},error:function(){Ext.Viewport.setMasked(false);prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}}).done(function(h){Ext.Viewport.setMasked(false);if(h.Status=="success"){F.clippings[F.clippings.length]=h.Value;F.clippingsWidth[F.clippingsWidth.length]=o;F.clippingsHeight[F.clippingsHeight.length]=B;v.selfDestruct();F.clippingMenu()}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}})}else{var z=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(z);z.show()}},createClipLandscape:function(d,g,q,b,f){var t=this;var C=false;if($(q.image).width()==0||q.image.stayHidden){var K=false}else{var K=true;var e=$(q.image).offset()}if($(q.landscapeimage).width()==0||q.landscapeimage.stayHidden){var k=false}else{var k=true;var J=$(q.landscapeimage).offset()}var a;if(J==null){a=$(q.portraitMediaDiv).offset().left+$(q.portraitMediaDiv).width()}else{a=$(q.landscapeimage).offset().left}if(K){if(q.scale==1){if((parseFloat(d)+5)<=a){var l=q.image.pageNumber;var m=q.image.naturalWidth;var n=q.image.naturalHeight;var B=m/$(q.image).width();var A=n/$(q.image).height();if(q.scroller.position.y>0){var O=q.scroller.position.y}else{var O=0}var F=parseInt(((parseFloat(d)+5)-e.left+q.scroller.position.x)*B);var E=parseInt(((parseFloat(g)+5)-e.top+q.scroller.position.y-O)*A);var M=parseInt(($(b.element.dom).height()-10)*B);var G=parseInt(($(b.element.dom).width()-10)*A);if((F+G<0)||(E+M<0)||(E>q.naturalHeight)){C=false}else{G=parseInt(Math.min(G,((q.image.clientWidth+q.landscapeimage.clientWidth-1)*B)-F)-1);M=parseInt(Math.max(Math.min(M,((q.image.clientHeight)*B)-E),0));if(F<0){var D=F+G;F=0;G=D}if(E<0){var L=E+M;E=0;M=L}if(F<0||E<0||E+M>$(q.portraitMediaDiv).height()*A){C=false}else{C=true;l=flatPlanData.pageGroups[l-1]!=null?flatPlanData.pageGroups[l-1].pages[0].origPageNum:l;var p="http://clippings.pagesuite.com";if(location.protocol=="https:"){p="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=p+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+F+"&y="+E+"&h="+M+"&w="+G+"&nw="+m+"&nh="+n}}}}else{var z=q.scale;var o=q.translateX;var s=parseFloat((q.scroller.position.x)+parseFloat(d));var u=($(q.image).width()*z)+o;if(s+5<=u){var l=q.image.pageNumber;var m=q.image.naturalWidth;var n=q.image.naturalHeight;var O=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){O-=40}}var B=m/($(q.image).width()*z);var A=n/($(q.image).height()*z);var r=parseFloat(q.scroller.position.y+parseFloat(g)-O);var j=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){j=t.returnTopBannerOffset()}var F=parseInt(((s+5)-o)*B);var E=parseInt(((r+5)-j)*A);var M=parseInt(($(b.element.dom).height()-10)*B);var G=parseInt(($(b.element.dom).width()-10)*A);if((F+G<0)||(E+M<0)||(E>q.naturalHeight)){C=false}else{G=parseInt(Math.min(G,(((q.landscapeimage.clientWidth+q.image.clientWidth-1)*z)*B)-F)-1);M=parseInt(Math.max(Math.min(M,((q.image.clientHeight*z)*B)-E),0));if(F<0){var D=F+G;F=0;G=D}if(E<0){var L=E+M;E=0;M=L}if(F<0||E<0||E+M>($(q.landscapeimage).height()*z)*A){C=false}else{C=true;l=flatPlanData.pageGroups[l-1]!=null?flatPlanData.pageGroups[l-1].pages[0].origPageNum:l;var p="http://clippings.pagesuite.com";if(location.protocol=="https:"){p="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=p+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+F+"&y="+E+"&h="+M+"&w="+G+"&nw="+m+"&nh="+n}}}}}if(k){if(q.scale==1){if(((parseFloat(d)+5)>=J.left&&(parseFloat(d)+5)<=J.left+$(q.landscapeimage).width())||!K){var l=q.landscapeimage.pageNumber;var m=q.landscapeimage.naturalWidth;var n=q.landscapeimage.naturalHeight;var B=m/$(q.landscapeimage).width();var A=n/$(q.landscapeimage).height();if(q.scroller.position.y>0){var O=q.scroller.position.y}else{var O=0}var F=parseInt(((parseFloat(d)+5)-J.left+q.scroller.position.x)*B);var E=parseInt(((parseFloat(g)+5)-J.top+q.scroller.position.y-O)*A);var M=parseInt(($(b.element.dom).height()-10)*B);var G=parseInt(($(b.element.dom).width()-10)*A);if((!K&&F+G<0)||(F>q.landscapeimage.naturalWidth)||(E+M<0)||(E>q.landscapeimage.naturalHeight)){C=false}else{G=parseInt(Math.min(G,($(q.landscapeimage).width()*B)-F)-1);M=parseInt(Math.min(M,($(q.landscapeimage).height()*B)-E));if(E<0){var L=E+M;E=0;M=L}if(F<0){var D=F+G;F=0;G=D}if(F<0||F+G>$(q.landscapeimage).width()*B||E<0||E+M>$(q.landscapeimage).height()*A){C=false}else{C=true;l=flatPlanData.pageGroups[l-1]!=null?flatPlanData.pageGroups[l-1].pages[0].origPageNum:l;var p="http://clippings.pagesuite.com";if(location.protocol=="https:"){p="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=p+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+F+"&y="+E+"&h="+M+"&w="+G+"&nw="+m+"&nh="+n}}}}else{var z=q.scale;var I=q.translateX+($(q.landscapeimage).width()*z);var s=parseFloat((q.scroller.position.x)+parseFloat(d));var u=I+($(q.landscapeimage).width()*z);if((s+5>=I&&s+5<=u)||!K){var l=q.landscapeimage.pageNumber;var m=q.landscapeimage.naturalWidth;var n=q.landscapeimage.naturalHeight;var O=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){O-=40}}var B=m/($(q.landscapeimage).width()*z);var A=n/($(q.landscapeimage).height()*z);var r=parseFloat(q.scroller.position.y+parseFloat(g)-O);var H=$(q.landscapeimage).height()*z;var N=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){N=t.returnTopBannerOffset()}var F=parseInt(((s+5)-I)*B);var E=parseInt(((r+5)-N)*A);var M=parseInt(($(b.element.dom).height()-10)*B);var G=parseInt(($(b.element.dom).width()-10)*A);if((!K&&F+G<0)||(F>q.landscapeimage.naturalWidth)||(E+M<0)||(E>q.landscapeimage.naturalHeight)){C=false}else{G=parseInt(Math.min(G,(($(q.landscapeimage).width()*z)*B)-F-1));M=parseInt(Math.max(Math.min(M,(($(q.landscapeimage).height()*z)*B)-E),0));if(E<0){var L=E+M;E=0;M=L}if(F<0){var D=F+G;F=0;G=D}if(F+G>($(q.landscapeimage).width()*z)*A||E<0||E+M>($(q.landscapeimage).height()*z)*A){C=false}else{C=true;l=flatPlanData.pageGroups[l-1]!=null?flatPlanData.pageGroups[l-1].pages[0].origPageNum:l;var p="http://clippings.pagesuite.com";if(location.protocol=="https:"){p="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=p+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+F+"&y="+E+"&h="+M+"&w="+G+"&nw="+m+"&nh="+n}}}}}if(C){$.ajax({url:c,beforeSend:function(){Ext.Viewport.setMasked({xtype:"loadmask",message:language.clippings.clippingSpinner})},error:function(){Ext.Viewport.setMasked(false);prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}}).don})}else{var v=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(v);v.show()}},createClipSingle:function(d,g,r,b,f){var u=this;var L=true;var k=true;if(r.rightSide.element.dom.style.visibility=="hidden"){k=false}else{L=false}var D=true;if(L){var e=$(r.leftSideImg).offset();e.top=e.top;if(e.top<0){e.top=0}var a=u.getReaderCarousel();var P=40;if(a.getActiveItem().zoomMode=="fill"&&$("#slider").val()<=1){P=0}else{if(a.getActiveItem().zoomMode=="fit"&&$("#slider").val()<=1){P=0}else{P=40}}var l=r.leftSideImageContainer.pageNo;var m=r.leftSideImg.naturalWidth;var n=r.leftSideImg.naturalHeight;if($("#slider").val()<=1){var C=m/r.leftSideWidth;var B=n/r.leftSideHeight;if(r.zoomMode=="fill"){if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top")||settings.dateSelector!=null)){e.top=40+u.returnTopBannerOffset()}else{if(r.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){}else{P+=40}}else{P+=40}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.enableReaderPadding=="true"){P+=20}}}}var G=parseInt(((parseFloat(d)+5)-e.left+r.scroller.position.x)*C);var F=parseInt(((parseFloat(g)+5)-e.top+r.scroller.position.y-P)*B);var N=parseInt(($(b.element.dom).height()-10)*C);var H=parseInt(($(b.element.dom).width()-10)*B);if((G>r.naturalWidth)||(G+H<0)||(F+N<0)||(F>r.leftSideNaturalHeight)){D=false}else{H=parseInt(Math.min(H,(r.leftSideWidth*C)-G));N=parseInt(Math.max(Math.min(N,(r.leftSideNaturalHeight)-F-1),0));if(F<0){var M=F+N;F=0;N=M}if(G<0){var E=G+H;G=0;H=E}if(G<0||G+H>r.width*C||F<0||F+N>r.leftSideHeight*B){D=false}else{l=flatPlanData.pageGroups[l-1+pageOffset]!=null?flatPlanData.pageGroups[l-1+pageOffset].pages[0].origPageNum:l;var q="http://clippings.pagesuite.com";if(location.protocol=="https:"){q="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=q+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+G+"&y="+F+"&h="+N+"&w="+H+"&nw="+m+"&nh="+n}}}else{var A=$("#slider").val();if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){P-=40}}var p=r.initialTranslateX*A;if(!!settings.wrapAd&&settings.wrapAd.side!="left"){p+=200}else{if(settings.reader.enableReaderPadding!=null&&settings.reader.enableReaderPadding=="true"){p+=150}}var t=parseFloat((r.scroller.position.x)+parseFloat(d));var v=p+(r.width*A);var C=m/(r.leftSideWidth*A);var B=n/(r.leftSideHeight*A);var j=0;if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top")||settings.dateSelector!=null)){j=u.returnTopBannerOffset()}var s=parseFloat(r.scroller.position.y+parseFloat(g)-P);var o=r.height*A;if(settings.reader.enableReaderPadding!=null&&settings.reader.enableReaderPadding=="true"){s-=20}var G=parseInt(((t+5)-p)*C);var F=parseInt(((s+5)-j)*B);var N=parseInt(($(b.element.dom).height()-10)*B);var H=parseInt(($(b.element.dom).width()-10)*C);H=parseInt(Math.max(Math.min(H,(r.leftSideNaturalWidth)-G-1),0));N=parseInt(Math.max(Math.min(N,(r.leftSideNaturalHeight)-F-1),0));if(F<0){var M=F+N;F=0;N=M}if(G<0){var E=G+H;G=0;H=E}if(G<0||G+H>(r.leftSideWidth*A)*C||F<0||F+N>(r.leftSideHeight*A)*C){D=false}else{l=flatPlanData.pageGroups[l-1+pageOffset]!=null?flatPlanData.pageGroups[l-1+pageOffset].pages[0].origPageNum:l;var q="http://clippings.pagesuite.com";if(location.protocol=="https:"){q="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=q+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+G+"&y="+F+"&h="+N+"&w="+H+"&nw="+m+"&nh="+n}}}else{if(k){var K=$(r.rightSideImg).offset();K.top=K.top;if(K.top<0){K.top=0}var P=40;var a=u.getReaderCarousel();if(a.getActiveItem().zoomMode=="fill"&&$("#slider").val()<=1){P=0}else{if(a.getActiveItem().zoomMode=="fit"&&$("#slider").val()<=1){P=0}else{P=40}}var l=r.rightSideImageContainer.pageNo;var m=r.rightSideImg.naturalWidth;var n=r.rightSideImg.naturalHeight;if($("#slider").val()<=1){var C=m/r.width;var B=n/r.height;if(r.zoomMode=="fill"){if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top")||settings.dateSelector!=null)){K.top=40+u.returnTopBannerOffset()}else{if(r.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){}else{P+=40}}else{P+=40}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.enableReaderPadding=="true"){P+=20}}}}var G=parseInt(((parseFloat(d)+5)-K.left+r.scroller.position.x)*C);var F=parseInt(((parseFloat(g)+5)-K.top+r.scroller.position.y-P)*C);var N=parseInt(($(b.element.dom).height()-10)*C);var H=parseInt(($(b.element.dom).width()-10)*C);if((G>r.naturalWidth)||(G+H<0)||(F+N<0)||(F>r.naturalHeight)){D=false}else{H=parseInt(parseInt(Math.min(H,(r.width*C)-G)));N=parseInt(Math.max(Math.min(N,(r.rightSideNaturalHeight)-F-1),0));if(F<0){var M=F+N;F=0;N=M}if(G<0){var E=G+H;G=0;H=E}if(G<0||G+H>r.width*C||F<0||F+N>r.height*C){D=false}else{l=flatPlanData.pageGroups[l-1+pageOffset]!=null?flatPlanData.pageGroups[l-1+pageOffset].pages[0].origPageNum:l;var q="http://clippings.pagesuite.com";if(location.protocol=="https:"){q="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=q+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+G+"&y="+F+"&h="+N+"&w="+H+"&nw="+m+"&nh="+n}}}else{var A=$("#slider").val();var J=r.initialTranslateX*A;if(!!settings.wrapAd&&settings.wrapAd.side!="left"){J+=200}else{if(settings.reader.enableReaderPadding!=null&&settings.reader.enableReaderPadding=="true"){J+=150}}if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){P-=40}}var t=parseFloat((r.scroller.position.x)+parseFloat(d));var v=J+(r.width*A);var C=m/(r.width*A);var B=n/(r.height*A);var O=0;if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top")||settings.dateSelector!=null)){O=u.returnTopBannerOffset()}var s=parseFloat(r.scroller.position.y+parseFloat(g)-P);var I=r.height*A;if(settings.reader.enableReaderPadding!=null&&settings.reader.enableReaderPadding=="true"){s-=20}var G=parseInt(((t+5)-J)*C);var F=parseInt(((s+5)-O)*C);var N=parseInt(($(b.element.dom).height()-10)*C);var H=parseInt(($(b.element.dom).width()-10)*C);if((G>r.naturalWidth)||(G+H<0)||(F+N<0)||(F>r.naturalHeight)){D=false}else{H=parseInt(Math.max(Math.min(H,(r.rightSideNaturalWidth)-G-1),0));N=parseInt(Math.max(Math.min(N,(r.rightSideNaturalHeight)-F-1),0));if(F<0){var M=F+N;F=0;N=M}if(G<0){var E=G+H;G=0;H=E}if(G<0||G+H>(r.width*A)*C||F<0||F+N>(r.height*A)*C){D=false}else{l=flatPlanData.pageGroups[l-1+pageOffset]!=null?flatPlanData.pageGroups[l-1+pageOffset].pages[0].origPageNum:l;var q="http://clippings.pagesuite.com";if(location.protocol=="https:"){q="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=q+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+G+"&y="+F+"&h="+N+"&w="+H+"&nw="+m+"&nh="+n}}}}}if(D){$.ajax({url:c,beforeSend:function(){Ext.Viewport.setMasked({xtype:"loadmask",message:language.clippings.clippingSpinner})}}).done(function(h){Ext.Viewport.setMasked(false);if(h.Status=="success"){u.clippings[u.clippings.length]=h.Value;u.clippingsWidth[u.clippingsWidth.length]=H;u.clippingsHeight[u.clippingsHeight.length]=N;f.selfDestruct();u.clippingMenu()}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}})}else{var z=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(z);z.show()}},createClipDouble:function(d,g,q,b,f){var t=this;var M=true;var k=true;if(q.leftPage==null||q.config.leftPage.type=="sectionpage"){M=false}if(q.rightPage==null||q.config.rightPage.type=="sectionpage"){k=false}if(M){var e=$(q.leftSideImg).offset();e.top=e.top;if(e.top<0){e.top=0}}if(k){var L=$(q.rightSideImg).offset();L.top=L.top;if(L.top<0){L.top=0}}var a;if(L!=null){a=L.left}else{a=e.left+$(q.leftSideImg).width()}var D=false;if(M){if($("#slider").val()<=1){if((parseFloat(d)+5)<=a){var l=q.leftSideImageContainer.pageNo;var m=q.leftSideImg.naturalWidth;var n=q.leftSideImg.naturalHeight;var C=m/q.width;var B=n/q.height;if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top")||settings.dateSelector!=null)&&q.zoomMode=="fill"){e.top=40+t.returnTopBannerOffset();var Q=0}else{if(q.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){var Q=0}else{var Q=40}}else{var Q=40}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.enableReaderPadding=="true"){Q+=20}}else{var Q=0}}var G=parseInt(((parseFloat(d)+5)-e.left+q.scroller.position.x)*C);var F=parseInt(((parseFloat(g)+5)-e.top+q.scroller.position.y-Q)*C);var P=parseInt(($(b.element.dom).height()-10)*C);var H=parseInt(($(b.element.dom).width()-10)*C);if((G+H<0)||(F+P<0)||(F>q.leftSideNaturalHeight)){D=false}else{var K=q.leftSideWidth!=null?q.leftSideWidth:0;var u=q.rightSideWidth!=null?q.rightSideWidth:0;H=parseInt(Math.min(H,((K+u)*C)-G));P=parseInt(Math.min(P,(q.leftSideNaturalHeight)-F-1));if(G<0){var E=G+H;G=0;H=E}if(F<0){var N=F+P;F=0;P=N}if(F+P>q.leftSideNaturalHeight){D=false}else{D=true;l=flatPlanData.pageGroups[l-1+pageOffset]!=null?flatPlanData.pageGroups[l-1+pageOffset].pages[0].origPageNum:l;var p="http://clippings.pagesuite.com";if(location.protocol=="https:"){p="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=p+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+G+"&y="+F+"&h="+P+"&w="+H+"&nw="+m+"&nh="+n}}}}else{var A=$("#slider").val();var o=q.initialTranslateX*A;if(!!settings.wrapAd&&settings.wrapAd.side!="left"){o+=200}else{if(settings.reader.enableReaderPadding!=null&&settings.reader.enableReaderPadding=="true"){o+=150}}var s=parseFloat((q.scroller.position.x)+parseFloat(d));var v=(q.width*A)+o;if(s+5<=v){var l=q.leftSideImageContainer.pageNo;var m=q.leftSideImg.naturalWidth;var n=q.leftSideImg.naturalHeight;var C=m/(q.width*A);var B=n/(q.leftSideHeight*A);var j=0;if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top")||settings.dateSelector!=null)){j=t.returnTopBannerOffset()}var r=parseFloat(q.scroller.position.y+parseFloat(g));var I=q.height*A;if(settings.reader.enableReaderPadding!=null&&settings.reader.enableReaderPadding=="true"){r-=20}var Q=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){Q-=40}}var G=parseInt(((s+5)-o)*C);var F=parseInt(((r+5)-Q-(q.initialTranslateY*A)-j)*C);var P=parseInt(($(b.element.dom).height()-10)*C);var H=parseInt(($(b.element.dom).width()-10)*C);if((G+H<0)||(F+P<=0)||(F>q.leftSideNaturalHeight)){D=false}else{var K=q.leftSideWidth!=null?q.leftSideWidth:0;var u=q.rightSideWidth!=null?q.rightSideWidth:0;H=parseInt(Math.max(Math.min(H,(q.leftSideNaturalWidth)-G-1),0));P=parseInt(Math.max(Math.min(P,(q.leftSideNaturalHeight)-F-1),0));if(G<0){var E=G+H;G=0;H=E}if(F<0){var N=F+P;F=0;P=N}if(F+P>q.leftSideNaturalHeight){D=false}else{D=true;l=flatPlanData.pageGroups[l-1+pageOffset]!=null?flatPlanData.pageGroups[l-1+pageOffset].pages[0].origPageNum:l;var p="http://clippings.pagesuite.com";if(location.protocol=="https:"){p="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=p+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+G+"&y="+F+"&h="+P+"&w="+H+"&nw="+m+"&nh="+n}}}}}if(k){if($("#slider").val()<=1){if(((parseFloat(d)+5)>=L.left&&(parseFloat(d)+5)<=L.left+q.width)||!M){var l=q.rightSideImageContainer.pageNo;var m=q.rightSideImg.naturalWidth;var n=q.rightSideImg.naturalHeight;var C=m/q.rightSideWidth;var B=n/q.rightSideHeight;if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top")||settings.dateSelector!=null)&&q.zoomMode=="fill"){L.top=40+t.returnTopBannerOffset();var Q=0}else{if(q.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){var Q=0}else{var Q=40}}else{var Q=40}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.enableReaderPadding=="true"){Q+=20}}else{var Q=0}}var G=parseInt(((parseFloat(d)+5)-L.left+q.scroller.position.x)*C);var F=parseInt(((parseFloat(g)+5)-L.top+q.scroller.position.y-Q)*C);var P=parseInt(($(b.element.dom).height()-10)*C);var H=parseInt(($(b.element.dom).width()-10)*C);if((!M&&G+H<0)||(G>q.naturalWidth)||(F+P<=0)||(F>q.rightSideNaturalHeight)){D=false}else{H=parseInt(Math.min(H,(q.width*C)-G));P=parseInt(Math.min(P,(q.rightSideNaturalHeight)-F-1));if(F<0){var N=F+P;F=0;P=N}if(G<0){var E=G+H;G=0;H=E}if((G<0&&!M)){D=false}else{D=true;l=flatPlanData.pageGroups[l-1+pageOffset]!=null?flatPlanData.pageGroups[l-1+pageOffset].pages[0].origPageNum:l;var p="http://clippings.pagesuite.com";if(location.protocol=="https:"){p="https://integrations.pagesuite.com"}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=p+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+G+"&y="+F+"&h="+P+"&w="+H+"&nw="+m+"&nh="+n}}}}else{var A=$("#slider").val();var J=(q.initialTranslateX+q.width)*A;if(!!settings.wrapAd&&settings.wrapAd.side!="left"){J+=200}else{if(settings.reader.enableReaderPadding!=null&&settings.reader.enableReaderPadding=="true"){J+=150}}var s=parseFloat((q.scroller.position.x)+parseFloat(d));var v=J+(q.width*A);if((s+5>=J&&s+5<=v)||!M){var l=q.rightSideImageContainer.pageNo;var m=q.rightSideImg.naturalWidth;var n=q.rightSideImg.naturalHeight;var C=m/(q.rightSideWidth*A);var B=n/(q.rightSideHeight*A);var O=0;if(typeof settings!="undefined"&&((settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top")||settings.dateSelector!=null)){O=t.returnTopBannerOffset()}var r=parseFloat(q.scroller.position.y+parseFloat(g));var I=q.height*A;if(settings.reader.enableReaderPadding!=null&&settings.reader.enableReaderPadding=="true"){r-=20}var Q=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){Q-=40}}var G=parseInt(((s+5)-J)*C);var F=parseInt(((r+5)-Q-(q.initialTranslateY*A)-O)*C);var P=parseInt(($(b.element.dom).height()-10)*C);var H=parseInt(($(b.element.dom).width()-10)*C);if((!M&&G+H<0)||(G>q.rightSideNaturalWidth)||(F+P<0)||(F>q.rightSideNaturalHeight)){D=false}else{H=parseInt(Math.max(Math.min(H,(q.rightSideNaturalWidth)-G-1),0));P=parseInt(Math.min(P,(q.rightSideNaturalHeight)-F-1));if(F<0){var N=F+P;F=0;P=N}if(G<0){var E=G+H;G=0;H=E}if((G<0&&!M)){D=false}else{D=true;var p="http://clippings.pagesuite.com";if(location.protocol=="https:"){p="https://integrations.pagesuite.com"}l=flatPlanData.pageGroups[l-1+pageOffset]!=null?flatPlanData.pageGroups[l-1+pageOffset].pages[0].origPageNum:l;if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){l=(editionFlatplanData.pageGroups.length-l)+1}var c=p+"/create_clipping.aspx?eid="+editionguid+"&pnum="+l+"&x="+G+"&y="+F+"&h="+P+"&w="+H+"&nw="+m+"&nh="+n}}}else{if(!M){D=false}}}}if(D){$.ajax({url:c,beforeSen}}).done(function(h){Ext.Viewport.setMasked(false);console.log(h.Status);if(h.Status=="success"){t.clippings[t.clippings.length]=h.Value;t.clippingsWidth[t.clippingsWidth.length]=H;t.clippingsHeight[t.clippingsHeight.length]=P;f.selfDestruct();t.clippingMenu()}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}})}else{var z=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(z);z.show()}},resizeClipping:function(){var a=this;if(a.getClippingarea()!=null){a.getClippingarea().resize()}},resetClippingArea:function(b){var c=b.readerActiveItem;var a=b.reader;b.selfDestruct();if(currentProfile=="desktop"){var d=Ext.create("InfinityMobile.view.ClippingArea",{readerActiveItem:c,reader:a})}else{var d=Ext.create("InfinityMobile.view.tablet.ClippingArea",{readerActiveItem:c,reader:a})}Ext.Viewport.add(d);d.show()},deleteIte},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},returnTopBannerOffset:function(){var a=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){a+=currentProfile=="phone"?60:110}if(typeof settings!="undefined"&&settings.dateSelector!=null&&currentProfile=="desktop"){a+=40}return a}},0,0,0,0,0,0,[InfinityMobile.controller,"ClippingController"],0));(Ext.cmd.derive("InfinityMobile.controller.PdfController",Ext.app.Controller,{config:{refs:{readerpageviewer:"readerpageviewer",infiniteCarousel:"infinitecarousel2d"},control:{readerpageviewer:{renderPDF:"processPDF",activeItemCheck:"activeItemCheck"},infiniteCarousel:{pausePDF:"pausePage",resumePDF:"resumePage"}}},init:function(){var c=this;if(typeof(PDFJS)!=="undefined"){pdfRenderQueue=[];c.isBusy=false;c.isPaused=false;c.blocked=false;c.currentRenderPage=null;PDFJS.isPaused=false;var a="resources/js/pdf/";if(typeof pdfDirectory!="undefined"){a=pdfDirectory}if(returnPdfJsBaseVersion()==1){PDFJS.workerSrc=a+"/pdf.worker.js"}else{if(returnPdfJsBaseVersion()>=2){PDFJS.GlobalWorkerOptions.workerSrc=a+"/pdf.worker.min.js"}}c.firstEverRender=true;if(!Ext.browser.is.Chrome){c.firstEverRender=false}var b=Ext.getStore("SettingStore");b.on({load:"initPDFSettings",scope:this,delay:10})}},initPDFSettings:function(){if(settings.page.pdfEnableWorker!=null&&settings.page.pdfEnableWorker=="true"){if(returnPdfJsBaseVersion()==1){PDFJS.disableWorker=false}}else{if(returnPdfJsBaseVersion()==1){PDFJS.disableWorker=true}}},getPDFRenderQueue:function(){return pdfRenderQueue},addToQueu},insertToQueu},checkExistingPageInQueu},removeFromQueu},checkQueu},isOnCurrentPag},selectClosestPag},processPD},tryRenderPD},renderPDF:function(e,c,h,d,j,k,b){var g=this;if(g.isOnCurrentPage(d)&&g.checkExistingPageInQueue(h,d)==-1){g.isBusy=true;g.currentRenderPage=e.render(c);g.currentRenderPage.page=e;g.currentRenderPage.pageNumber=h;g.currentRenderPage.imagePageNumber=d;g.currentRenderPage.renderContext=c;g.currentRenderPage.callback=j;g.currentRenderPage.cancelCallback=k;g.currentRenderPage.resetCallback=b;g.setupCanvas(c);var };var a=function(l){if(l=="cancelled"){g.isBusy=false;k()}else{if(g.isOnCurrentPage(d)){g.isBusy=false;g.checkQueue()}}};if(returnPdfJsBaseVersion()==1){g.currentRenderPage.then(f,a)}else{if(returnPdfJsBaseVersion()>=2){g.currentRenderPage.promise.then(f,a)}}}else{if(g.checkExistingPageInQueue(h,d)!=-1){b()}g.checkQueue()}},setupCanvas:function(b){var e=this;var d=b.canvasContext;var a=d.canvas;a.style.visibility="hidden";if(a.dpi>1){a.width=a.pageWidth*a.dpi;a.height=a.pageHeight*a.dpi;a.style.width=a.pageWidth+"px";a.style.height=a.pageHeight+"px";try{d._transformMatrix=[a.dpi,0,0,a.dpi,0,0];d.setTransform(1,0,0,1,0,0);d.scale(a.dpi,a.dpi)}catch(c){a.width=a.pageWidth;a.height=a.pageHeight;a.style.width=a.pageWidth+"px";a.style.height=a.pageHeight+"px"}}else{a.width=a.pageWidth;a.height=a.pageHeight;a.style.width=a.pageWidth+"px";a.style.height=a.pageHeight+"px";d.setTransform(1,0,0,1,0,0)}},isAnotherPageRequestInQueue:function(){var a=this},pausePag},resumePage:function(){var a=this;a.isPaused=false;a.checkQueue()},activeItemChec},hideBackgroundImag}},0,0,0,0,0,0,[InfinityMobile.controller,"PdfController"],0));(Ext.cmd.derive("InfinityMobile.controller.PageTurnController",Ext.app.Controller,{config:{refs:{pagecontainer2:"readerpageviewer",infinitecarousel:"infinitecarousel2d",navbutton:"navbutton",bannerAd:"readerbannerad",readerarticlepopover:"articleview"},control:{pagecontainer2:{returnPageRight:"returnPageRight",finishTurnRight:"finishTurnRight",returnPageLeft:"returnPageLeft",finishTurnLeft:"finishTurnLeft",returnPageBottomRight:"returnPageBottomRight",finishTurnBottomRight:"finishTurnBottomRight",returnPageBottomLeft:"returnPageBottomLeft",finishTurnBottomLeft:"finishTurnBottomLeft",autoTurnRight:"autoTurnRight",autoTurnLeft:"autoTurnLeft",autoTurnBottomRight:"autoTurnBottomRight",autoTurnBottomLeft:"autoTurnBottomLeft",setupKeys:"setupKeys",goRight:"goRight",goLeft:"goLeft",killBannerAd:"killBannerAd"},navbutton:{autoTurnRight:"goRight",autoTurnLeft:"goLeft"}}},init:function(){var c=this;var d=c.getInfinitecarousel();c.setupKeys();var b=$(document).width();var a=$(document).height();pixelMove=b*0.01;c.turning=false;if(Ext.browser.is.IE){flipSound=new Audio("resources/audio/pageTurnShort.mp3")}else{flipSound=new Audio("resources/audio/pageTurnShort.wav")}if(typeof flipSound!="undefined"&&flipSound!=null){flipSound.onende}}},setupKeys:function(){var a=this;a.isAltDown=false;a.isADown=false;window.onkeydown=function(c){var b=a.getInfinitecarousel();var d=b.getActiveItem();if($("#slider").val()<=1){if(c.keyCode==39&&d.topRight!=null&&d.topRight.element.dom.style.visibility!="hidden"){a.goRight()}else{if(c.keyCode==39){a.nonAnimateRight(a.getInfinitecarousel())}}if(c.keyCode==37&&d.topLeft!=null&&d.topLeft.element.dom.style.visibility!="hidden"){a.goLeft()}else{if(c.keyCode==37){a.nonAnimateLeft(a.getInfinitecarousel())}}if(c.keyCode===38){if(d.getScrollable().getScroller().position.y-30>0){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().position.y-30);if(d.zoomMode!="fit"){a.getApplication().getController("ReaderController").showTop();if(d.getScrollable().getScroller().position.y-30<d.getScrollable().getScroller().maxPosition.y){a.getApplication().getController("ReaderController").showBottom()}else{a.getApplication().getController("ReaderController").hideBottom()}}}else{d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,0);if(d.zoomMode!="fit"){a.getApplication().getController("ReaderController").hideTop();a.getApplication().getController("ReaderController").showBottom()}}}if(c.keyCode===40){if(d.getScrollable().getScroller().position.y+30<d.getScrollable().getScroller().maxPosition.y){if(d.zoomMode!="fit"){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().position.y+30);a.getApplication().getController("ReaderController").showBottom();if(d.getScrollable().getScroller().position.y+30>0){a.getApplication().getController("ReaderController").showTop()}else{a.getApplication().getController("ReaderController").hideTop()}}}else{d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().maxPosition.y);if(d.zoomMode!="fit"){a.getApplication().getController("ReaderController").hideBottom();a.getApplication().getController("ReaderController").showTop()}}}}else{c.stopImmediatePropagation();if(c.keyCode==39){if(d.getScrollable().getScroller().position.x+30<d.getScrollable().getScroller().maxPosition.x){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x+30)}else{d.getScroller().scrollTo(d.getScrollable().getScroller().maxPosition.x)}}else{if(c.keyCode==37){if(d.getScrollable().getScroller().position.x-30>0){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x-30)}else{d.getScrollable().getScroller().scrollTo(0)}}else{if(c.keyCode===38){if(d.getScrollable().getScroller().position.y-30>0){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().position.y-30)}else{d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,0)}}else{if(c.keyCode===40){if(d.getScrollable().getScroller().position.y+30<d.getScrollable().getScroller().maxPosition.y){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().position.y+30)}else{d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().maxPosition.y)}}}}}}if(settings.articlepopover!=null&&settings.articlepopover.enableArticleKeyboardShortcut=="true"){if(c.keyCode==18){c.stopImmediatePropagation();a.isAltDown=true}if(c.keyCode==65){c.stopImmediatePropagation();a.isADown=true}}};window.onkeyup=function(f){if(settings.articlepopover!=null&&settings.articlepopover.enableArticleKeyboardShortcut=="true"){if(a.isADown){if(typeof articleDictionary!="undefined"){var c=$.map(articleDictionar});if(c!=null&&c.length>0){f.stopImmediatePropagation();var b=c[0];var d=articleDictionary[b];d.config={};d.config.articleIndex=0;mainPanel.fireEvent("articleClick",d,b)}}}if(f.keyCode==18){a.isAltDown=false}if(f.keyCode==65){a.isADown=false}}}},goRight:function(b){var c=this;c.killBannerAd();var e=c.getInfinitecarousel();if(currentProfile=="desktop"){if(e._mode=="double"){var f=e.getActiveItem();if(!c.checkSectionPageNext(f)){var a=e._pageNumber;var d=e.getData();if(a!=null&&d!=null&&a<d.length-pageOffset-1){c.animateRight(f)}}else{c.nonAnimateRight(e)}}else{c.nonAnimateRight(e)}}else{c.nonAnimateRight(e)}},killBannerA},checkSectionPageNext:function(a){if(a.config.nextPage==null||a.config.nextPage.type=="sectionpage"||a.config.nextPage.type=="advert"){return true}return false},animateRight:function(b){var a=this;if(b.diffX==null&&b.topRight!=null){b.diffX=($(b.topRight.element.dom).offset().left+$(b.topRight.element.dom)[0].getBoundingClientRect().width)-width}if(b.diffY==null&&b.topRight!=null){b.diffY=$(b.topRight.element.dom).offset().top}if(b.topRight!=null&&b.topRight.element.dom.style.visibility!="hidden"){a.autoTurnRight(b)}else{a.nonAnimateRight(a.getInfinitecarousel())}},nonAnimateRight:function(a){a.next()},goLeft:function(a){var b=this;b.killBannerAd();var c=b.getInfinitecarousel();if(currentProfile=="desktop"){if(c._mode=="double"){var d=c.getActiveItem();if(!b.checkSectionPagePrevious(d)){b.animateLeft(d)}else{b.nonAnimateLeft(c)}}else{b.nonAnimateLeft(c)}}else{b.nonAnimateLeft(c)}},checkSectionPagePreviou},animateLeft:function(b){var a=this;if(b.diffX==null){b.diffX=-$(b.topLeft.element.dom).offset().left}if(b.diffY==null){b.diffY=$(b.topLeft.element.dom).offset().top}if(b.topLeft.element.dom.style.visibility!="hidden"){a.autoTurnLeft(b)}},nonAnimateLeft:function(a){a.previous()},checkTurnRight:function(){var a=this},checkTurnLeft:function(){var a=this},returnPageRight:function(c,a){var b=this;if(!b.turning){b.turning=true;b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX<($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset){c.pageX+=pixelMove}else{e=true}if(c.pageY>1+a.diffY){c.pageY-=pixelMove}else{d=true}if(c.pageY<1+a.diffY){c.pageY=1+a.diffY}if(c.pageX>($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset){c.pageX=($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset}if(e&&d){clearInterval(b.timer);setTimeout(function(){b.turning=false},30);var f=b.getInfinitecarousel().getActiveItem();f.rightSideGradient.style.visibility="hidden";f.leftSideGradient.style.visibility="hidden";$(f.leftSideDiv).css("transform","");$(f.rightSideDiv).css("transform","");$(f.leftSideImageContainer).css("transform","");$(f.rightSideImageContainer).css("transform","");f.mediaDivContainer.element.dom.style.display="";f.leftSideTileCanvas.style.display="";f.rightSideTileCanvas.style.display="";f.rightSide.element.dom.style.zIndex="9";f.leftSide.element.dom.style.zIndex="9";if(f.getPageNo()==0&&f.config.leftPage.type=="leftHandAd"&&(f.config.leftPage.adType=="dfp"||f.config.leftPage.adType=="adbridg")){f.leftSide.setZIndex(20);f.removeCls("disableIframe")}$(f.rightSideNextPageContainer).css("transform","");$(f.rightNextPage).css("visibility","hidden");if(!Ext.browser.is.IE){if(f.element.dom.parentElement!=null){f.element.dom.parentElement.parentElement.style.overflow="hidden"}}b.showTiledImage(f);f.mouseDown=false}else{a.drag(c)}},10)}},finishTurnRight:function(d,a){var c=this;if(!c.turning){c.turning=true;clearInterval(c.timer);var b=c.getInfinitecarousel().getActiveItem();c.disableCorners(b);if(settings.reader.disablePageTurnSound!="true"&&typeof flipSound!="undefined"){flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}c.timer=setInterval(function(){c.turning=true;var f=false;var e=false;if(d.pageX>1+a.diffX){d.pageX-=pixelMove}else{f=true}if(d.pageY>1+a.diffY){d.pageY-=pixelMove}else{e=true}if(d.pageX<1+a.diffX){d.pageX=1+a.diffX}if(d.pageY<1+a.diffY){d.pageY=1+a.diffY}if(f&&e){clearInterval(c.timer);c.timer=null}else{a.drag(d)}if(c.timer==null){c.getInfinitecarousel().getActiveItem().mouseDown=false;c.showTiledImage(b);setTimeout(function(){c.completeTurnRight()},30)}},10)}},returnPageLeft:function(c,a){var b=this;if(!b.turning){b.turning=true;b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX>1+(a.diffX*-1)){c.pageX-=pixelMove}else{e=true}if(c.pageY>a.diffY-1){c.pageY-=pixelMove}else{d=true}if(c.pageX<1+(a.diffX*-1)){c.pageX=1+(a.diffX*-1)}if(c.pageY<a.diffY-1){c.pageY=a.diffY-1}if(e&&d){clearInterval(b.timer);setTimeout(function(){b.turning=false},30);b.getInfinitecarousel().getActiveItem().mouseDown=false;var f=b.getInfinitecarousel().getActiveItem();f.rightSideGradient.style.visibility="hidden";f.leftSideGradient.style.visibility="hidden";$(f.leftSideDiv).css("overflow","visible");$(f.rightSideDiv).css("overflow","visible");$(f.leftSideDiv).css("transform","");$(f.rightSideDiv).css("transform","");$(f.leftSideImageContainer).css("transform","");$(f.rightSideImageContainer).css("transform","");f.mediaDivContainer.element.dom.style.display="";f.leftSideTileCanvas.style.display="";f.rightSideTileCanvas.style.display="";f.rightSide.element.dom.style.zIndex="9";f.leftSide.element.dom.style.zIndex="9";if(f.getPageNo()==0&&f.config.leftPage.type=="leftHandAd"&&(f.config.leftPage.adType=="dfp"||f.config.leftPage.adType=="adbridg")){f.leftSide.setZIndex(20);f.removeCls("disableIframe")}$(f.leftSidePrevPageContainer).css("transform","");$(f.leftPrevPage).css("visibility","hidden");if(!Ext.browser.is.IE){if(f.element.dom.parentElement!=null){f.element.dom.parentElement.parentElement.style.overflow="hidden"}}b.showTiledImage(f)}else{a.dragLeft(c)}},10)}},finishTurnLeft:function(d,a){var c=this;if(!c.turning){c.turning=true;clearInterval(c.timer);var b=c.getInfinitecarousel().getActiveItem();c.disableCorners(b);if(settings.reader.disablePageTurnSound!="true"&&typeof flipSound!="undefined"){flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}c.timer=setInterval(function(){c.turning=true;var f=false;var e=false;if(d.pageX<($(a.element.dom).width()/2)+a.width){d.pageX+=pixelMove}else{f=true}if(d.pageY>1+a.diffY){d.pageY-=pixelMove}else{e=true}if(f&&e){clearInterval(c.timer);c.timer=null}if(d.pageX<($(a.element.dom).width()/2)+a.width){d.pageX=($(a.element.dom).width()/2)+a.width}if(d.pageY<1+a.diffY){d.pageY=1+a.diffY}a.dragLeft(d);if(c.timer==null){c.getInfinitecarousel().getActiveItem().mouseDown=false;c.showTiledImage(b);setTimeout(function(){c.completeTurnLeft()},15)}},10)}},returnPageBottomRight:function(c,a){var b=this;if(!b.turning){b.turning=true;b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX<($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset){c.pageX+=pixelMove}else{e=true}if(c.pageY<$(a.element.dom).height()+a.diffY){c.pageY+=pixelMove}else{d=true}if(c.pageX>($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset){c.pageX=($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset}if(c.pageY>$(a.element.dom).height()+a.diffY){c.pageY=$(a.element.dom).height()+a.diffY}if(e&&d){clearInterval(b.timer);setTimeout(function(){b.turning=false},30);b.getInfinitecarousel().getActiveItem().mouseDown=false;var f=b.getInfinitecarousel().getActiveItem();f.rightSideGradient.style.visibility="hidden";f.leftSideGradient.style.visibility="hidden";$(b.leftSideDiv).css("overflow","visible");$(b.rightSideDiv).css("overflow","visible");f.mediaDivContainer.element.dom.style.display="";f.leftSideTileCanvas.style.display="";f.rightSideTileCanvas.style.display="";f.rightSide.element.dom.style.zIndex="9";f.leftSide.element.dom.style.zIndex="9";if(f.getPageNo()==0&&f.config.leftPage.type=="leftHandAd"&&(f.config.leftPage.adType=="dfp"||f.config.leftPage.adType=="adbridg")){f.leftSide.setZIndex(20);f.removeCls("disableIframe")}$(f.rightNextPage).css("visibility","hidden");if(!Ext.browser.is.IE){if(f.element.dom.parentElement!=null){f.element.dom.parentElement.parentElement.style.overflow="hidden"}}b.showTiledImage(f)}else{a.dragBottomRight(c)}},10)}},finishTurnBottomRight:function(d,a){var c=this;if(!c.turning){c.turning=true;clearInterval(c.timer);var b=c.getInfinitecarousel().getActiveItem();c.disableCorners(b);if(settings.reader.disablePageTurnSound!="true"&&typeof flipSound!="undefined"){flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}c.timer=setInterval(function(){c.turning=true;var f=false;var e=false;if(d.pageX>1+(a.diffX*-1)){d.pageX-=pixelMove}else{f=true}if(d.pageY<a.height+a.diffY){d.pageY+=pixelMove}else{e=true}if(f&&e){clearInterval(c.timer);c.timer=null}if(d.pageX<1+(a.diffX*-1)){d.pageX=1+(a.diffX*-1)}if(d.pageY>a.height+a.diffY){d.pageY=a.height+a.diffY}a.dragBottomRight(d);if(c.timer==null){c.getInfinitecarousel().getActiveItem().mouseDown=false;c.showTiledImage(b);setTimeout(function(){c.completeTurnRight()},30)}},15)}},returnPageBottomLeft:function(c,a){var b=this;b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX>1+(a.diffX*-1)){c.pageX-=pixelMove}else{e=true}if(c.pageY<$(a.element.dom).height()+a.diffY){c.pageY+=pixelMove}else{d=true}if(c.pageX<1+(a.diffX*-1)){c.pageX=1+(a.diffX*-1)}if(c.pageY>$(a.element.dom).height()+(a.diffY*2)){c.pageY=$(a.element.dom).height()+(a.diffY*2)}if(e&&d){clearInterval(b.timer);setTimeout(function(){b.turning=false},30);b.getInfinitecarousel().getActiveItem().mouseDown=false;var f=b.getInfinitecarousel().getActiveItem();f.rightSideGradient.style.visibility="hidden";f.leftSideGradient.style.visibility="hidden";$(b.leftSideDiv).css("overflow","visible");$(b.rightSideDiv).css("overflow","visible");f.mediaDivContainer.element.dom.style.display="";f.leftSideTileCanvas.style.display="";f.rightSideTileCanvas.style.display="";$(f.rightSideTileDiv).css("display","");$(f.leftSideTileDiv).css("display","");f.rightSide.element.dom.style.zIndex="9";f.leftSide.element.dom.style.zIndex="9";if(f.getPageNo()==0&&f.config.leftPage.type=="leftHandAd"&&(f.config.leftPage.adType=="dfp"||f.config.leftPage.adType=="adbridg")){f.leftSide.setZIndex(20);f.removeCls("disableIframe")}$(f.leftPrevPage).css("visibility","hidden");if(!Ext.browser.is.IE){if(f.element.dom.parentElement!=null){f.element.dom.parentElement.parentElement.style.overflow="hidden"}}b.showTiledImage(f)}else{a.dragBottomLeft(c)}},10)},finishTurnBottomLeft:function(d,a){var c=this;if(!c.turning){c.turning=true;clearInterval(c.timer);var b=c.getInfinitecarousel().getActiveItem();c.disableCorners(b);if(settings.reader.disablePageTurnSound!="true"&&typeof flipSound!="undefined"){flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}c.timer=setInterval(function(){c.turning=true;var f=false;var e=false;if(d.pageX<($(a.element.dom).width()/2)+a.width){d.pageX+=pixelMove}else{f=true}if(d.pageY<a.height+a.diffY){d.pageY+=pixelMove}else{e=true}if(f&&e){clearInterval(c.timer);c.timer=null}if(d.pageX>($(a.element.dom).width()/2)+a.width){d.pageX=($(a.element.dom).width()/2)+a.width}if(d.pageY>a.height+a.diffY){d.pageY=a.height+a.diffY}a.dragBottomLeft(d);if(c.timer==null){c.getInfinitecarousel().getActiveItem().mouseDown=false;c.showTiledImage(b);setTimeout(function(){c.completeTurnLeft()},15)}},15)}},playSound:function(){var a=this;if((settings.reader.disablePageTurnSound!=null&&settings.reader.disablePageTurnSound=="true")||typeof flipSound==="undefined"){return}flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()},autoTurnRigh},completeTurnRight:function(){var b=this;b.turning=false;var a=b.getInfinitecarousel().getActiveItem();$(a.leftSideDiv).css("transform","");$(a.leftSideImageContainer).css("transform","");$(a.leftPrevPage).css("transform","");$(a.leftPrevPage).css("visibility","hidden");$(a.rightSideDiv).css("transform","");$(a.rightSideImageContainer).css("transform","");$(a.rightNextPage).css("transform","");$(a.rightNextPage).css("visibility","hidden");a.rightSideGradient.style.visibility="hidden";a.leftSideGradient.style.visibility="hidden";$(a.leftSideDiv).css("overflow","visible");$(a.rightSideDiv).css("overflow","visible");a.mediaDivContainer.element.dom.style.display="";a.leftSideTileCanvas.style.display="";a.rightSideTileCanvas.style.display="";if(!a.overflowMediaDiv.isHidden()){a.overflowMediaDiv.setZIndex(20)}a.rightSide.element.dom.style.zIndex="9";a.leftSide.element.dom.style.zIndex="9";if(a.getPageNo()==0&&a.config.leftPage.type=="leftHandAd"&&(a.config.leftPage.adType=="dfp"||a.config.leftPage.adType=="adbridg")){a.leftSide.setZIndex(20);a.removeCls("disableIframe")}b.getInfinitecarousel().next();a.playCssAnimations();$(a.rightSideNextPageContainer).css("display","none");$(a.leftSidePrevPageContainer).css("display","none");$(a.rightSideTileDiv).css("display","");$(a.leftSideTileDiv).css("display","");if(!Ext.browser.is.IE){if(a.element!=null&&a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}setTimeout(function(){if(!b.turning){b.getApplication().getController("PdfController").resumePage();b.enableCorners(a)}},300)},autoTurnLef},completeTurnLeft:function(){var b=this;var a=b.getInfinitecarousel().getActiveItem();$(a.rightSideDiv).css("transform","");$(a.rightSideImageContainer).css("transform","");$(a.rightNextPage).css("transform","");$(a.rightNextPage).css("visibility","hidden");$(a.leftSideDiv).css("transform","");$(a.leftSideImageContainer).css("transform","");$(a.leftPrevPage).css("transform","");$(a.leftPrevPage).css("visibility","hidden");a.rightSideGradient.style.visibility="hidden";a.leftSideGradient.style.visibility="hidden";$(a.leftSideDiv).css("overflow","visible");$(a.rightSideDiv).css("overflow","visible");b.turning=false;a.mediaDivContainer.element.dom.style.display="";a.leftSideTileCanvas.style.display="";a.rightSideTileCanvas.style.display="";a.rightSide.element.dom.style.zIndex="9";a.leftSide.element.dom.style.zIndex="9";if(a.getPageNo()==0&&a.config.leftPage.type=="leftHandAd"&&(a.config.leftPage.adType=="dfp"||a.config.leftPage.adType=="adbridg")){a.leftSide.setZIndex(20);a.removeCls("disableIframe")}b.getInfinitecarousel().previous();a.playCssAnimations();$(a.rightSideNextPageContainer).css("display","none");$(a.leftSidePrevPageContainer).css("display","none");$(a.rightSideTileDiv).css("display","");$(a.leftSideTileDiv).css("display","");if(!Ext.browser.is.IE){if(a.element!=null&&a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}setTimeout(function(){if(!b.turning){b.getApplication().getController("PdfController").resumePage();b.enableCorners(a)}},300)},autoTurnBottomRigh},completeTurnBottomRight:function(){var b=this;var a=b.getInfinitecarousel().getActiveItem();$(a.leftSideDiv).css("transform","");$(a.leftSideDiv).css("top",0);$(a.leftSideDiv).css("bottom","");$(a.leftSideImageContainer).css("transform","");$(a.leftSideImageContainer).css("top",0);$(a.leftSideImageContainer).css("bottom","");$(a.leftPrevPage).css("transform","");$(a.leftPrevPage).css("visibility","hidden");$(a.rightSideDiv).css("transform","");$(a.rightSideDiv).css("top",0);$(a.rightSideDiv).css("bottom","");$(a.rightSideImageContainer).css("transform","");$(a.rightSideImageContainer).css("top",0);$(a.rightSideImageContainer).css("bottom","");$(a.rightNextPage).css("transform","");$(a.rightNextPage).css("visibility","hidden");a.rightSideGradient.style.visibility="hidden";a.leftSideGradient.style.visibility="hidden";$(a.leftSideDiv).css("overflow","visible");$(a.rightSideDiv).css("overflow","visible");a.bottomRight.element.dom.style.visibility="visible";a.mediaDivContainer.element.dom.style.display="";a.leftSideTileCanvas.style.display="";a.rightSideTileCanvas.style.display="";if(!a.overflowMediaDiv.isHidden()){a.overflowMediaDiv.setZIndex(20)}a.rightSide.element.dom.style.zIndex="9";a.leftSide.element.dom.style.zIndex="9";if(a.getPageNo()==0&&a.config.leftPage.type=="leftHandAd"&&(a.config.leftPage.adType=="dfp"||a.config.leftPage.adType=="adbridg")){a.leftSide.setZIndex(20);a.removeCls("disableIframe")}setTimeout(function(){a.bottomRightTapped=false},100);b.turning=false;$(a.rightSideNextPageContainer).css("display","none");$(a.leftSidePrevPageContainer).css("display","none");$(a.rightSideTileDiv).css("display","");$(a.leftSideTileDiv).css("display","");if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}b.getInfinitecarousel().next();a.playCssAnimations();setTimeout(function(){if(!b.turning){b.getApplication().getController("PdfController").resumePage()}},300)},autoTurnBottomLef},completeTurnBottomLeft:function(){var b=this;var a=b.getInfinitecarousel().getActiveItem();$(a.rightSideDiv).css("transform","");$(a.rightSideDiv).css("top",0);$(a.rightSideDiv).css("bottom","");$(a.rightSideImageContainer).css("transform","");$(a.rightSideImageContainer).css("top",0);$(a.rightSideImageContainer).css("bottom","");$(a.rightNextPage).css("transform","");$(a.rightNextPage).css("visibility","hidden");$(a.leftSideDiv).css("transform","");$(a.leftSideDiv).css("top",0);$(a.leftSideDiv).css("bottom","");$(a.leftSideImageContainer).css("transform","");$(a.leftSideImageContainer).css("top",0);$(a.leftSideImageContainer).css("bottom","");$(a.leftPrevPage).css("transform","");$(a.leftPrevPage).css("visibility","hidden");a.rightSideGradient.style.visibility="hidden";a.leftSideGradient.style.visibility="hidden";$(a.leftSideDiv).css("overflow","visible");$(a.rightSideDiv).css("overflow","visible");b.turning=false;a.mediaDivContainer.element.dom.style.display="";a.leftSideTileCanvas.style.display="";a.rightSideTileCanvas.style.display="";a.rightSide.element.dom.style.zIndex="9";a.leftSide.element.dom.style.zIndex="9";if(a.getPageNo()==0&&a.config.leftPage.type=="leftHandAd"&&(a.config.leftPage.adType=="dfp"||a.config.leftPage.adType=="adbridg")){a.leftSide.setZIndex(20);a.removeCls("disableIframe")}b.getInfinitecarousel().previous();a.playCssAnimations();$(a.rightSideNextPageContainer).css("display","none");$(a.leftSidePrevPageContainer).css("display","none");$(a.rightSideTileDiv).css("display","");$(a.leftSideTileDiv).css("display","");if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}setTimeout(function(){a.bottomLeftTapped=false},100);setTimeou},300)},disableCorners:function(a){var b=this;a.topRight.element.removeListener({dragstart:"startDrag",drag:"drag",dragend:"endDrag",scope:a});a.topLeft.element.removeListener({dragstart:"startDragLeft",drag:"dragLeft",dragend:"endDragLeft",scope:a});a.bottomRight.element.removeListener({dragstart:"startDragBottomRight",drag:"dragBottomRight",dragend:"endDragBottomRight",scope:a});a.bottomLeft.element.removeListener({dragstart:"startDragBottomLeft",drag:"dragBottomLeft",dragend:"endDragBottomLeft",scope:a})},enableCorners:function(a){var b=this;if(a!=null){if(a.topRight!=null){a.topRight.element.addListener({dragstart:"startDrag",drag:"drag",dragend:"endDrag",scope:a})}if(a.topLeft!=null){a.topLeft.element.addListener({dragstart:"startDragLeft",drag:"dragLeft",dragend:"endDragLeft",scope:a})}if(a.bottomRight!=null){a.bottomRight.element.addListener({dragstart:"startDragBottomRight",drag:"dragBottomRight",dragend:"endDragBottomRight",scope:a})}if(a.bottomLeft!=null){a.bottomLeft.element.addListener({dragstart:"startDragBottomLeft",drag:"dragBottomLeft",dragend:"endDragBottomLeft",scope:a})}}},showTiledImage:function(a){if(settings.page.ignorePDF!=null){$(a.rightSideTileDiv).css("display","");$(a.leftSideTileDiv).css("display","")}}},0,0,0,0,0,0,[InfinityMobile.controller,"PageTurnController"],0));(Ext.cmd.derive("InfinityMobile.controller.PushController",Ext.app.Controller,{config:{refs:{main:"main"},control:{main:{initializepush:"initialisePush"}}},init:function(){var a=this;a.isPushEnabled=false},initialisePush:function(){var a=this;a.createManifest();if("serviceWorker" in navigator){if(navigator.serviceWorker.controller!=null){a.subscribe()}else{var b=Math.round(new Date().getTime()/1000);navigator.serviceWorker.register("service-worker.js?t="+b).then(function(c){a.subscribe()})}console.log(navigator.serviceWorker.controller)}else{console.warn("Service workers aren't supported in this browser.")}},createManifes},intialiseStat},subscrib},unsubscrib},sendSubscriptionToServe}},0,0,0,0,0,0,[InfinityMobile.controller,"PushController"],0));(Ext.cmd.derive("InfinityMobile.controller.BookmarkController",Ext.app.Controller,{config:{refs:{main:"main",bookmarkContainer:"readerbookmark",bookmarkitem:"bookmarkitem",carousel:"infinitecarousel2d",articlescontainer:"articlescontainer",readerdpsprompt:"readerdpsprompt",readerarticlepopover:"articleview",layoutToolbar:"layouttoolbar",readerViewController:"#readerViewController"},control:{main:{bookmark:"showBookmarks",pwaBookmark:"pwaBookmark",articleViewBookmark:"articleViewBookmark",loadBookmarks:"loadBookmarks"},bookmarkContainer:{close:"closeBookmarks",loadBookmarks:"loadBookmarks",addBookmark:"addBookmark",enableArticlesContainer:"enableArticlesContainer"},bookmarkitem:{loadPage:"loadBookmarkPage",deleteBookmark:"deleteBookmark"},readerbookmarkthumbnail:{addDpsBookmark:"addDpsBookmark",toggleDpsBookmark:"toggleDpsBookmark",pwaAddDpsBookmark:"pwaAddDpsBookmark"},readerdpsprompt:{toggleDpsBookmark:"toggleDpsBookmark",addToggledBookmark:"addToggledBookmark"},articleview:{checkArticleBookmark:"checkArticleBookmark"}}},init:function(){var a=this},showBookmarks:function(){var f=this;f.disableArticlesContainer();var h="InfinityMobile.view.tablet.ReaderBookmark";switch(currentProfile){case"phone":h="InfinityMobile.view.phone.ReaderBookmark";break;case"desktop":h="InfinityMobile.view.desktop.ReaderBookmark";break;case"tablet":default:h="InfinityMobile.view.tablet.ReaderBookmark";break}var c=Ext.create(h,{});Ext.Viewport.add(c);c.show();var g=f.getCarousel();var d=f.getApplication().getController("ReaderController").returnCorrectPageNumber(g);var e=d.split("-");if(e.length>1){c.toggleBookmarkTextBox.hide();var b="Add";if(typeof language!=null&&language.bookmarks.add!=null){b=language.bookmarks.add}c.addBookmarkButton.setText(b);c.bookmarkAddContainer.layout.setPack("left");var a=c.bookmarkAddContainer.getComponent("padding");a.setWidth(0)}},loadBookmarks:function(b){var d=this;d.bookmarksJson=d.retrieveBookmarks();if(b!=null){for(var c=0;c<d.bookmarksJson.length;c++){var a=d.bookmarksJson[c];d.addBookmarkItem(b,a)}d.setBookmarkText(b.addBookmarkTextBox)}},addBookmarkItem:function(b,c){var d=this;var a=Ext.create("InfinityMobile.view.BookmarkItem",{bookmarkItem:c});if(b!=null&&b.bookmarksContainer!=null){b.bookmarksContainer.add(a)}},retrieveBookmarks:function(){var d=this;var c=[];var b="bookmarks"+editionguid;if(settings.bookmarks.bookmarkLS!=null){b="bookmarks"+settings.bookmarks.bookmarkLS}try{if(localStorage.getItem(b)!=null){c=JSON.parse(localStorage.getItem(b))}}catch(a){}if(settings.subscription!=null&&settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.type=="unique"&&loggedIn=="true"){c=d.setEgmontBookmarks(settings.subscription.pageRestriction)}}return c},setBookmarkText:function(c){var a=this;if(settings.subscription!=null&&settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.type=="unique"&&loggedIn=="true"){var b="page";if(typeof language!=null&&language.page!=null){b=language.page}c.value=settings.subscription.pageRestriction.name+", "+b+" "+a.retrievePageNumber()}}},setEgmontBookmarks:function(f){var a=getCookie("bookmarks"+editionguid);try{var h=decodeURIComponent(unescape(window.atob(a)));var d=JSON.parse(h)}catch(c){console.warn(c.message);console.warn(c.stack)}var e=[];if(d.length>0){for(var b in d){var g={name:d[b].name,pageNumber:d[b].pageNo,issueCode:d[b].issueCode};e.push(g)}}return e},setBookmarks:function(){var c=this;var b="bookmarks"+editionguid;if(settings.bookmarks.bookmarkLS!=null){b="bookmarks"+settings.bookmarks.bookmarkLS}try{localStorage.setItem(b,JSON.stringify(c.bookmarksJson))}catch(a){}if(typeof(EDITIONAPP)!="undefined"&&EDITIONAPP){console.log(c.bookmarksJson);window.parent.postMessage({type:"bookmarks",bookmarks:c.bookmarksJson},"*")}},toggleDpsBookmark:function(a){var e=this;var d=e.getReaderdpsprompt();if(d.leftPage!="undefined"){d.leftPage.setStyle({border:""});d.leftPage.active=false}if(d.rightPage!="undefined"){d.rightPage.setStyle({border:""});d.rightPage.active=false}a.setStyle({border:"4px solid rgb(69, 143, 187)"});a.active=true;var f="page";if(typeof language!=null&&language.page!=null){f=language.page}if(settings.subscription!=null&&settings.subscription.pageRestriction!=null&&settings.subscription.pageRestriction.name!=null){d.bookmarkNameValue.value=a.textboxValue+", "+f+" "+a.pageNo}if(typeof NEWPWA!="undefined"&&NEWPWA===true){if(!!d&&"bookmarkAddButton" in d&&!!d.bookmarkAddButton&&"setText" in d.bookmarkAddButton&&!!d.bookmarkAddButton.setText){var b=e.pwaIsEditionPageBookmarked(a.pageNo);var c=typeof language!="undefined"&&!!language&&"bookmarks" in language&&!!language.bookmarks?language.bookmarks:{};var g="";if(b===false){g="add" in c&&!!c.add?c.add:"Add"}else{g="remove" in c&&!!c.remove?c.remove:"Remove"}d.bookmarkAddButton.setText(g)}}},addBookmark:function(g){var w=this;var v=g.addBookmarkTextBox;var u=w.retrievePageNumber();var a=w.getCarousel();if(a.getActiveItem().xtype!="readeradvertpageviewer"){if((a._mode=="double"&&currentProfile=="desktop")||(currentProfile!="desktop"&&w.returnOrientation()=="landscape"&&a._mode=="double")){u=editionFlatplanData.reversePageMapper[parseInt(u)]}u=flatPlanData.pageMapper[u];u=flatPlanData.pageGroups[u-1+pageOffset].pages[0].origPageNum;if(settings.reader!=null&&settings.reader.reverse=="true"){}if(settings.subscription!=null&&settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.type=="unique"&&loggedIn=="true"){v.value=settings.subscription.pageRestriction.name}}var p=false;if(a!=null&&currentProfile=="desktop"&&a._mode=="double"){p=true}else{if(a!=null&&currentProfile!="desktop"&&a._mode=="double"&&w.returnOrientation()=="landscape"){p=true}}if(p){var k=a.getActiveItem();if(currentProfile=="desktop"){var l=k.config.leftPage;var t=k.config.rightPage}else{if(k._pageNo%2==0){var l=k._previousPage;var t=k._page}else{var l=k._page;var t=k._nextPage}}if(l!=null&&l!=""&&l.type=="page"&&t!=null&&t!=""&&t.type=="page"){var b=l.origPageNum;var e=t.origPageNum;var r=b;var c=e;if(settings.reader!=null&&settings.reader.reverse=="true"){b=(editionFlatplanData.pageGroups.length-l.pageIndex)+1;e=(editionFlatplanData.pageGroups.length-t.pageIndex)+1}else{var d=editionFlatplanData.pdfPages[b-1]!=null?editionFlatplanData.pdfPages[b-1].pages[0]:null;var s=editionFlatplanData.pdfPages[e-1]!=null?editionFlatplanData.pdfPages[e-1].pages[0]:null;if(d!=null&&d.pageName!=null&&d.pageName!=null){r=d.pageName}if(s!=null&&s.pageName!=null&&s.pageName!=null){c=s.pageName}}var n=Ext.create("InfinityMobile.view.ReaderDpsPrompt",{leftPageNo:b,leftDisplayNo:r,rightPageNo:e,rightDisplayNo:c,textboxValue:v.value,promptType:"bookmarks"});Ext.Viewport.add(n);n.show();return}}var o=g.bookmarksContainer.getItems().items;var m="true";for(var q=0;q<o.length;q++){if(v.value==o[q].bookmarkItem.name){m="falseName"}if(o[q].bookmarkItem.editionguid!=null){if(o[q].bookmarkItem.pageNumber==u&&o[q].bookmarkItem.editionguid==editionguid){m="falsePage"}}else{if(o[q].bookmarkItem.pageNumber==u){m="falsePage"}}}if(m=="true"&&v.value==""){m="emptyName"}if(m=="true"){var j=this.getSectionName(u);var h={name:v.value,pageNumber:u,editionguid:editionguid,editionname:editionName,editiondate:editionDate,publicationguid:publicationguid,publicationname:publicationName,section:j,itemType:"edition",type:"page"};w.bookmarksJson.push(h);w.setBookmarks();w.addBookmarkItem(g,h);w.trackBookmarks("bookmarkAdded",h);w.resetTextBox(v)}else{if(m=="falseName"){var f=typeof language!="undefined"&&language.bookmarks!=null&&language.bookmarks.bookmarkNameUsed!=null?language.bookmarks.bookmarkNameUsed:"This name has already been used";var n=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:f});Ext.Viewport.add(n);n.show()}else{if(m=="falsePage"){var n=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:language.bookmarks.bookmarkAlreadyAdded});Ext.Viewport.add(n);n.show()}else{if(m=="emptyName"){var f=typeof language!="undefined"&&language.bookmarks!=null&&language.bookmarks.bookmarkEnterName!=null?language.bookmarks.bookmarkEnterName:"Please enter a name";var n=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:f});Ext.Viewport.add(n);n.show();w.setTextBoxValidation(v)}}}}}else{var n=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:language.bookmarks.bookmarkInvalidPage});Ext.Viewport.add(n);n.show()}},articleViewBookmark:function(){var g=this;var b=g.getReaderarticlepopover();var c=b.articleCarousel.getActiveItem();var e=c.articleItem;var h=e.parentpage;var a=this.isArticleBookmarked(e);if(!a){var j=this.getSectionName(h);var f={name:e.headline!=null&&e.headline.trim()!=""?e.headline:language.page+" "+e.articleNumber,pageNumber:h,articleGuid:e.id,image:e.image,editionguid:editionguid,editionname:editionName,editiondate:editionDate,publicationguid:publicationguid,publicationname:publicationName,section:j,itemType:"edition",type:"article"};g.bookmarksJson.push(f);g.setBookmarks();try{g.trackBookmarks("bookmarkAdded",f)}catch(d){console.error("[BookmarkController]: Error Caught\n",d)}}else{g.removeArticleBookmark(e)}b.updateBookmark(!a)},removeArticleBookmark:function(e){var d=this;if(d.bookmarksJson!=null){for(var b=0;b<d.bookmarksJson.length;b++){var c=d.bookmarksJson[b];console.log(c.articleGuid);if(c.articleGuid==e.id){d.bookmarksJson.splice(b,1);break}}}d.setBookmarks();try{d.trackBookmarks("bookmarkRemoved",d.bookmarksJson[index])}catch(a){console.error("[BookmarkController]: Error Caught\n",a)}},trackBookmark},getSectionName:function(a){var c=this;var e=settings.bookmarks.bookmark;var d=null;if(e!=null&&e.length>0){for(var b in e){if(a>=e[b].pageNumber&&(e[parseInt(b)+1]==null||a<e[parseInt(b)+1].pageNumber)){d=e[b].name;break}}}return d},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){a="landscape"}}return a},removeBookmarkItem:function(a){var b=this;b.trackBookmarks("bookmarkRemoved",b.bookmarksJson[a]);b.bookmarksJson.splice(a,1);b.setBookmarks()},setTextBoxValidatio},resetTextBo},retrievePageNumbe},loadBookmarkPage:function(e){var d=this;if(e.bookmarkItem.editionguid==editionguid){var b=e.bookmarkItem.pageNumber-1;b=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[b]!=null?flatPlanData.pdfPages[b].pages[0].pageNum-1:b;var a=d.getCarousel();var c=d.getBookmarkContainer();if(settings.reader!=null&&settings.reader.reverse=="true"){b=(a.getData().length-1)-b}a.jumpToPage(b);d.closeBookmarks(c)}else{window.location.href=location.protocol+"//"+location.host+"/launch.aspx?eid="+e.bookmarkItem.editionguid+"&pnum="+e.bookmarkItem.pageNumber}},deleteBookmar},closeBookmarks:function(a){var b=this;a.hide()},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},addDpsBookmark:function(a){var j=this;var b=a.pageNo;var m=j.getBookmarkContainer();var h=m.bookmarksContainer.getItems().items;var e=j.getReaderdpsprompt();var l=e.bookmarkNameValue;var k=l.value;var o="true";for(var f=0;f<h.length;f++){if(k==h[f].bookmarkItem.name){o="falseName"}if(h[f].bookmarkItem.editionguid!=null){if(h[f].bookmarkItem.pageNumber==b&&h[f].bookmarkItem.editionguid==editionguid){o="falsePage"}}else{console.log("HITTING PAGE CHECK");if(h[f].bookmarkItem.pageNumber==b){o="falsePage"}}}if(o=="true"&&k==""){o="emptyName"}if(o=="true"){var n=this.getSectionName(b);var g={name:k,pageNumber:b,editionguid:editionguid,editionname:editionName,editiondate:editionDate,publicationguid:publicationguid,publicationname:publicationName,section:n,itemType:"edition"};j.bookmarksJson.push(g);j.setBookmarks();j.addBookmarkItem(m,g);j.trackBookmarks("bookmarkAdded",g);j.resetTextBox(l);e.destroy()}else{if(o=="falseName"){var d=typeof language!="undefined"&&language.bookmarks!=null&&language.bookmarks.bookmarkNameUsed!=null?language.bookmarks.bookmarkNameUsed:"This name has already been used";var c=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:d});Ext.Viewport.add(c);c.show();j.setTextBoxValidation(l)}else{if(o=="falsePage"){var c=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:language.bookmarks.bookmarkAlreadyAdded});Ext.Viewport.add(c);c.show()}else{if(o=="emptyName"){var d=typeof language!="undefined"&&language.bookmarks!=null&&language.bookmarks.bookmarkEnterName!=null?language.bookmarks.bookmarkEnterName:"Please enter a name";var c=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:d});Ext.Viewport.add(c);c.show();j.setTextBoxValidation(l)}}}}},addToggledBookmark:function(c,a){var b=this;if(typeof NEWPWA!="undefined"&&NEWPWA===true){b.pwaAddDpsBookmark(c)}else{b.addDpsBookmark(c)}},checkArticleBookmar},isArticleBookmarked:function(a){var d=this;var e=false;if(d.bookmarksJson!=null){for(var b=0;b<d.bookmarksJson.length;b++){var c=d.bookmarksJson[b];console.log(c.articleGuid);if(c.articleGuid==a.id){return true}}}return e},pwaBookmark:function(){try{var s=this;var a=s.getCarousel();var o=a.getActiveItem();var j=0;var n=null;var c="invalid page";if(o.xtype=="readeradvertpageviewer"){throw c}if((a._mode=="double"&&currentProfile=="desktop")||(currentProfile!="desktop"&&s.returnOrientation()=="landscape"&&a._mode=="double")){var l=null;var r=null;if(currentProfile=="desktop"){l=o.config.leftPage;r=o.config.rightPage}else{if(o._pageNo%2==0){l=o._previousPage;r=o._page}else{l=o._page;r=o._nextPage}}if(!!l&&!!l.type&&l.type=="page"){j+=1;n="left"}if(!!r&&!!r.type&&r.type=="page"){j+=1;n="right"}switch(j){case 1:s.pwaAddEditionPageBookmark(n=="left"?l.origPageNum:r.origPageNum);break;case 2:var d=l.origPageNum;var f=r.origPageNum;var q=d;var e=f;var k=editionFlatplanData.pdfPages[d-1]!=null?editionFlatplanData.pdfPages[d-1].pages[0]:null;var p=editionFlatplanData.pdfPages[f-1]!=null?editionFlatplanData.pdfPages[f-1].pages[0]:null;if(typeof k=="object"&&!!k&&"pageName" in k&&!!k.pageName){q=k.pageName}if(typeof p=="object"&&!!p&&"pageName" in p&&!!p.pageName){e=p.pageName}var m=Ext.create("InfinityMobile.view.ReaderDpsPrompt",{leftPageNo:d,leftDisplayNo:q,rightPageNo:f,rightDisplayNo:e,textboxValue:"",promptType:"bookmarks"});Ext.Viewport.add(m);m.show();break;default:throw c}}else{var b=flatPlanData.pageMapper[a._pageNumber+1];var h=flatPlanData.pageGroups[b-1+pageOffset]!=null?flatPlanData.pageGroups[b-1+pageOffset].pages[0]:null;if(!!h&&!!h.type&&h.type=="page"){s.pwaAddEditionPageBookmark(h.origPageNum)}else{throw c}}}catch(g){console.error("[BookmarkController]: Error Caught\n",g);if(typeof g=="string"){if(g==c){var m=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:language.bookmarks.bookmarkInvalidPage});Ext.Viewport.add(m);m.show()}}}},pwaAddDpsBookmark:function(c){var b=this;b.pwaAddEditionPageBookmark(c.pageNo);var a=b.getReaderdpsprompt();if(!!a){a.destroy()}},pwaIsEditionPageBookmarked:function(b){var d=false;try{if(typeof b!="undefined"&&b!==null&&b!=""){var g=this;g.bookmarksJson=g.retrieveBookmarks();var f=typeof g.bookmarksJson!="undefined"&&!!g.bookmarksJson?g.bookmarksJson.length:0;for(var c=0;c<f;c++){var a=g.bookmarksJson[c];if(!("editionguid" in a&&!!a.editionguid&&a.editionguid==editionguid)){continue}if(!("type" in a&&!!a.type&&a.type=="page")){continue}if(!("itemType" in a&&!!a.itemType&&a.itemType=="edition")){continue}if("pageNumber" in a&&a.pageNumber!==null&&a.pageNumber!=""&&a.pageNumber==b){d=true;break}}}}catch(e){d=null;console.error("[BookmarkController]: Error Caught\n",e)}return d},pwaIsEditionOneOfDoublePageBookmarked:function(){var e=this;var a=e.getCarousel();var d=a.getActiveItem();var c=false;if(d.xtype=="readeradvertpageviewer"){return c}if((a._mode=="double"&&currentProfile=="desktop")||(currentProfile!="desktop"&&e.returnOrientation()=="landscape"&&a._mode=="double")){var f=null;var b=null;if(currentProfile=="desktop"){f=d.config.leftPage;b=d.config.rightPage}else{if(d._pageNo%2==0){f=d._previousPage;b=d._page}else{f=d._page;b=d._nextPage}}if(!!f&&!!f.type&&f.type=="page"){c=e.pwaIsEditionPageBookmarked(f.origPageNum)}if(c===false&&!!b&&!!b.type&&b.type=="page"){c=e.pwaIsEditionPageBookmarked(b.origPageNum)}return c}},pwaAddEditionPageBookmark:function(b){var f=false;try{if(typeof b!="undefined"&&b!==null&&b!=""){var d=this;var g=d.pwaIsEditionPageBookmarked(b);if(g===false){var e=this.getSectionName(b);var a={name:"",pageNumber:b,editionguid:editionguid,editionname:editionName,editiondate:editionDate,publicationguid:publicationguid,publicationname:publicationName,section:e,itemType:"edition",type:"page"};d.bookmarksJson.push(a);f=true;d.setBookmarks();d.pwaToggleEditionPageBookmarkIcon();d.trackBookmarks("bookmarkAdded",a)}else{if(g==true){d.pwaRemoveEditionPageBookmark(b)}}}}catch(c){f=false;console.error("[BookmarkController]: Error Caught\n",c)}finally{return f}},pwaRemoveEditionPageBookmark:function(b){var h=null;var g=null;try{if(typeof b!="undefined"&&b!==null&&b!=""){var f=this;f.bookmarksJson=f.retrieveBookmarks();var e=typeof f.bookmarksJson!="undefined"&&!!f.bookmarksJson?f.bookmarksJson.length:0;for(var c=0;c<e;c++){var a=f.bookmarksJson[c];if(!("editionguid" in a&&!!a.editionguid&&a.editionguid==editionguid)){continue}if(!("type" in a&&!!a.type&&a.type=="page")){continue}if(!("itemType" in a&&!!a.itemType&&a.itemType=="edition")){continue}if("pageNumber" in a&&a.pageNumber!==null&&a.pageNumber!=""&&a.pageNumber==b){h=c;break}}}if(h!==null&&h>-1){g=f.bookmarksJson.splice(h,1);if(g!==null&&g.length>0){f.trackBookmarks("bookmarkRemoved",g[0]);f.setBookmarks();f.pwaToggleEditionPageBookmarkIcon()}}}catch(d){console.error("[BookmarkController]: Error Caught\n",d)}},pwaToggleEditionPageBookmarkIcon:function(){if(!(typeof NEWPWA!="undefined"&&NEWPWA===true)){return}var h=this;var b=h.getApplication();var m=!!b?b.getController("ReaderController"):null;var l=!!m&&"isSinglePage" in m&&typeof m.isSinglePage==="function"?m.isSinglePage():null;if(l===null){return}var a=false;if(l===true){var d=h.getCarousel();var c=flatPlanData.pageMapper[d._pageNumber+1];var f=flatPlanData.pageGroups[c-1+pageOffset]!=null?flatPlanData.pageGroups[c-1+pageOffset].pages[0]:null;a=h.pwaIsEditionPageBookmarked(f.origPageNum)}else{a=h.pwaIsEditionOneOfDoublePageBookmarked()}var k=null;var g=null;var e=null;var j=null;if(currentProfile==="desktop"){k=h.getLayoutToolbar();e=typeof k!="undefined"&&!!k?k:null;j=!!e&&"menuBookmarks" in e?e.menuBookmarks:null}else{g=h.getReaderViewController();e=typeof g!="undefined"&&!!g?g:null;j=!!e?e.getComponent("tabPhoneViewBookmark"):null}if(!(!!j&&"updateState" in j&&typeof j.updateState=="function")){return}j.updateState(a===true?"selected":"default")}},0,0,0,0,0,0,[InfinityMobile.controller,"BookmarkController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderPuzzlesController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel"},control:{mainPanel:{showPuzzlesPopup:"showPuzzlesPopup"}}},statics:{LANGUAGE:{},setLanguage:function(b){var a={puzzles:"Puzzles"};if(typeof b=="object"&&"puzzles" in b&&typeof b.puzzles=="object"){a.puzzles=("puzzles" in b.puzzles&&!!b.puzzles.puzzles)?b.puzzles.puzzles:a.puzzles}InfinityMobile.controller.ReaderPuzzlesController.LANGUAGE=a},SETTING:{},setSetting:function(a){var b={topbar:{puzzlesIconUrl:""},menu:{puzzlesEnabled:false,iframeUrlForPuzzles:""}};if("puzzlesIconUrl" in a.topbar&&!!a.topbar.puzzlesIconUrl){b.topbar.puzzlesIconUrl=a.topbar.puzzlesIconUrl}if("iframeUrlForPuzzles" in a.menu&&!!a.menu.iframeUrlForPuzzles){b.menu.iframeUrlForPuzzles=a.menu.iframeUrlForPuzzles}if("puzzlesEnabled" in a.menu&&!!a.menu.puzzlesEnabled){b.menu.puzzlesEnabled=a.menu.puzzlesEnabled=="true"||a.menu.puzzlesEnabled=="True"||a.menu.puzzlesEnabled===true}InfinityMobile.controller.ReaderPuzzlesController.SETTING=b},hasSettingEnabledForPuzzlesPopup:function(){return InfinityMobile.controller.ReaderPuzzlesController.SETTING.menu.puzzlesEnabled===true&&!!InfinityMobile.controller.ReaderPuzzlesController.SETTING.menu.iframeUrlForPuzzles}},init:function(){},showPuzzlesPopup:function(){var b=this;if(b.statics().hasSettingEnabledForPuzzlesPopup()){var c="";switch(currentProfile){case"tablet":c="InfinityMobile.view.tablet.ReaderPuzzlesPopup";break;case"phone":c="InfinityMobile.view.phone.ReaderPuzzlesPopup";break;default:c="InfinityMobile.view.desktop.ReaderPuzzlesPopup";break}var a=Ext.create(c,{});if(a!=null){Ext.Viewport.add(a);a.show()}}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderPuzzlesController"],0));(Ext.cmd.derive("InfinityMobile.view.Overlay",Ext.Panel,{config:{modal:true,hideOnMaskTap:true,centered:true},initialize:function(){var a=this;a.handleKeyDown();a.handleJustifiedText()},handleJustifiedText:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right")}},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},revertKeyDown:function(){var a=this;window.onkeydown=a.keyDownFunction},show:function(){var a=this;Ext.Panel.prototype.show.apply(this,arguments);if(!!a.skipAutoRefreshingAdvertsHandler===false){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)}},hide:function(){var a=this;Ext.Panel.prototype.hide.apply(this,arguments);if(!!a.skipAutoRefreshingAdvertsHandler===false){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME)}a.revertKeyDown();a.fireEvent("enableArticlesContainer");if(a.isSearch==null){Ext.Viewport.remove(a,true)}},destroy:function(){var a=this;a.revertKeyDown();a.fireEvent("enableArticlesContainer");Ext.Panel.prototype.destroy.apply(this,arguments)},setSquareCorners:function(a){var b=this;a=typeof(a)==typeof(true)&&a===true;if((typeof settings!="undefined"&&settings.newsday!=null)||a===true){b.setStyle({borderRadius:"0px"});b.element.down("div").dom.style.borderRadius="0px"}}},0,["overlay"],["component","container","panel","overlay"],{component:true,container:true,panel:true,overlay:true},["widget.overlay"],0,[InfinityMobile.view,"Overlay"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderSpecialSupplements",InfinityMobile.view.Overlay,{config:{id:"supplementscontainer",width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{itemId:"toolBar",height:40,style:"background-color:#e6e6e6",items:[{top:10,left:10,html:"<b>Special Supplements</b>"},{id:"toolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"bodyContainer",padding:"20",layout:"vbox",flex:1,style:"font-size:15px",items:[{itemId:"itemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{cls:"archiveitemphone"}}]}]},initialize:function(){var b=this;var a=b.getComponent("toolBar");b.toolBarClose=a.getComponent("toolBarClose");var c=b.getComponent("bodyContainer");b.itemsContainer=c.getComponent("itemsContainer");b.setCloseListener();b.fireEvent("showSupplements",b)},setCloseListener:function(){var a=this;a.toolBarClose.element.on("tap",function(){a.close()})},close:function(){var a=this;a.fireEvent("close",a)}},0,["readerspecialsupplements"],["component","container","panel","overlay","readerspecialsupplements"],{component:true,container:true,panel:true,overlay:true,readerspecialsupplements:true},["widget.readerspecialsupplements"],0,[InfinityMobile.view.phone,"ReaderSpecialSupplements"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuItem",Ext.Container,{config:{style:"font-size:14px;color:#cccccc;cursor:pointer",icon:"",text:""},initialize:function(){var a=this;if(typeof EDITIONAPP!=="undefined"&&EDITIONAPP){$(this.element.dom).css("font-size",currentProfile!="phone"?"20px":"14px");$(this.element.dom).css("border-bottom","1px solid grey");this.element.dom.style.color="white"}if(a.config.id!=null){a.id=a.config.id}if(a.config.clickType!=null){}a.setupText(a.getText());a.element.on({tap:"onTap",scope:a})},setupText:function(b){var a=this;a.setStyle("font-size:14px;color:#"+settings.menu.textColor+";cursor:pointer");if(b!=null){switch(b.toLowerCase()){case"special archive":if(settings.newsday!=null&&settings.newsday.specialArchive!=null&&settings.newsday.specialArchive.name!=null){a.setHtml(settings.newsday.specialArchive.name)}else{a.setHtml(b)}break;case"edition options":a.setHtml(language.menu.editionOptions);break;case"archive":a.setHtml(language.archive.archive);break;case"download":a.setHtml(language.download.download);break;case"bookmarks":a.setHtml(language.bookmarks.bookmarks);break;case"create clipping":a.setHtml(language.clippings.createClipping);break;case"print":a.setHtml(language.print.print);break;case"sections":if(a.id!="menuSectionsBtn"){a.setHtml(language.menu.sections)}else{a.setHtml(a.getText())}break;case"supplements":a.setHtml(language.menu.supplements);break;case"quick links":a.setHtml(language.menu.quickLinks);break;case"info":a.setHtml(language.menu.info);break;case"how to use":a.setHtml(language.howToUse.howToUse);break;case"contact us":a.setHtml(language.menu.contactUs);break;case"user options":a.setHtml(language.menu.userOptions);break;case"logout":a.setHtml(language.menu.logout);break;case"zones":if(a.id!="menuZonesBtn"){a.setHtml(language.menu.zones)}else{a.setHtml(a.getText())}break;case"articles":a.setHtml(language.articlesContainer.articles);break;case"pages":a.setHtml(language.articlesContainer.pages);break;case"terms and conditions":a.setHtml(language.menu.terms);break;case"my account":a.setHtml(language.menu.myAccount);break;case"search":a.setHtml(language.search.search);break;case"faq":a.setHtml(language.menu.faq);break;case"supplements tab":a.setHtml(a.getFormattedName(language.menu.supplements));break;case"privacy policy":a.setHtml(language.privacyPolicy);break;case"puzzles":a.setHtml(InfinityMobile.controller.ReaderPuzzlesController.LANGUAGE.puzzles);break;default:a.setHtml(a.getText());break}}},getFormattedName:function(c){c=c.toLowerCase();splitText=c.split(" ");var b="";for(var a in splitText){b+=splitText[a][0].toUpperCase()+splitText[a].substring(1,splitText[a].length).toLowerCase()+" "}return b.trim()},onTap:function(b){var a=this;if(a.config.clickType==null||a.config.clickType=="cls"){if(a.config.cls!=null){a.fireEvent(a.config.cls,a,"");mainPanel.fireEvent(a.config.cls,a,"")}else{a.fireEvent(a.id,a,"");mainPanel.fireEvent(a.id,a,"")}}else{a.fireEvent(a.id,a,"");mainPanel.fireEvent(a.id,a,"")}if(a.config.cls!=null&&a.config.cls.indexOf("quickLinkItem")>=0){mainPanel.fireEvent("trackMenuOption","quickLinkItem",a)}else{mainPanel.fireEvent("trackMenuOption",a.id)}b.stopPropagation()}},0,["readermenuitem"],["component","container","readermenuitem"],{component:true,container:true,readermenuitem:true},["widget.readermenuitem"],0,[InfinityMobile.view,"ReaderMenuItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPopoverMenuItem",Ext.Container,{config:{style:"font-size:14px;color:#cccccc",icon:"",text:""},initialize:function(){var a=this;if(a.config.event!=null){a.event=a.config.event}if(a.event=="highlightText"){a.fireEvent("checkHighlightMode",a)}a.setHtml(a.getText());a.element.on({tap:"onTap",scope:a})},onTap:function(b){var a=this;a.fireEvent("closePopoverMenu");switch(a.event){case"copyArticle":a.addCls("copyButtonMenu");a.fireEvent("copyToClipboard","menu");break;case"highlightText":a.fireEvent("selectTextMode",a);break}}},0,["readerpopovermenuitem"],["component","container","readerpopovermenuitem"],{component:true,container:true,readerpopovermenuitem:true},["widget.readerpopovermenuitem"],0,[InfinityMobile.view,"ReaderPopoverMenuItem"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderPopoverMenu",Ext.Container,{config:{width:"100%",layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:100%;transition:all 0.5s ease;max-width:0px;",left:0,top:0,height:"100%",zIndex:99999999,items:[{itemId:"menuLayout",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{margin:15},scrollable:{direction:"vertical",directionLock:true},items:[{itemId:"menuHeader",html:"Menu",margin:0,height:40,padding:"10 15 10 15",style:"color:rgb(204, 204, 204);background-color:rgb(128, 128, 128);",items:[{itemId:"menuHeaderClose",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{itemId:"menuInteractiveContainer",layout:"vbox",margin:"15 0 0 0",defaults:{padding:15},items:[{id:"menuComic",xtype:"readermenuitem",margin:"0 0 15 0",padding:"5 15 5 15",text:"Comics"},{id:"menuPuzzle",xtype:"readermenuitem",margin:"0 0 15 0",padding:"5 15 5 15",text:"Puzzles"}]},{id:"menuText",xtype:"readermenuitem",height:2,style:"background-color:rgb(128, 128, 128);",margin:"0px 15px 0px 15px"},{itemId:"menuTextContainer",layout:"vbox",margin:"0 0 0 0",style:"white-space: nowrap;overflow: hidden;",defaults:{padding:15},items:[{id:"menuCopy",xtype:"readerpopovermenuitem",event:"copyArticle",text:"Copy Article",hidden:true},{id:"menuHighlight",xtype:"readerpopovermenuitem",event:"highlightText",text:"Toggle Highlight Text",hidden:true}]},{id:"menuShare",xtype:"readermenuitem",height:2,style:"background-color:rgb(128, 128, 128);",margin:"0px 15px 0px 15px"},{itemId:"topBarShare",layout:"hbox"}]}]},initialize:function(){var a=this;if(a.config.hasComics!=null){a.hasComics=a.config.hasComics}if(a.config.hasPuzzles!=null){a.hasPuzzles=a.config.hasPuzzles}a.menuLayout=a.getComponent("menuLayout");a.menuHeader=a.menuLayout.getComponent("menuHeader");a.menuClose=a.menuHeader.getComponent("menuHeaderClose");a.menuInteractiveContainer=a.menuLayout.getComponent("menuInteractiveContainer");a.menuComic=a.menuInteractiveContainer.getComponent("menuComic");a.menuPuzzle=a.menuInteractiveContainer.getComponent("menuPuzzle");a.menuDivider=a.menuLayout.getComponent("menuText");a.menuShareDivider=a.menuLayout.getComponent("menuShare");a.setCloseListener();a.menuShare=a.menuLayout.getComponent("topBarShare");a.setShare();a.setComicListener();a.setPuzzleListener();a.checkDivider();a.handleJustifiedText();a.on("painted",function(){a.element.dom.style.maxWidth="100%"})},setShare:function(){var a=this;a.fireEvent("sharepopupmenu",a,a.menuShare)},setCloseListener:function(){var a=this;a.menuClose.element.on("tap",function(){a.element.dom.style.maxWidth="0%";setTimeout(function(){a.destroy()},500)})},loadSections:function(){var a=this;a.fireEvent("burgerMenuLoadSections",a,a.menuSectionsContainer)},checkDivider:function(){var a=this;if(settings.articlepopover.interactive!="true"||(!a.hasComics&&!a.hasPuzzles)){a.menuDivider.hide();a.menuShareDivider.hide()}},setComicListener:function(){var a=this;if(settings.articlepopover.interactive=="true"&&a.hasComics){a.menuComic.setHtml('<div style="display:inline-flex;"><img style="cursor:hand;cursor:pointer;width:28px;height:28px;" src="../assets/article%20view/comics-ic-white.png"><span style="padding:5px;color:white;">Comics</div>');a.menuComic.element.on({tap:function(){a.fireEvent("goToComics",a)}})}else{a.menuComic.hide()}},setPuzzleListener:function(){var a=this;if(settings.articlepopover.interactive=="true"&&a.hasPuzzles){a.menuPuzzle.setHtml('<div style="display:inline-flex;"><img style="cursor:hand;cursor:pointer;width:28px;height:28px;" src="../assets/article%20view/puzzle-ic-white.png"><span style="padding:5px;color:white;">Puzzles</div>');a.menuPuzzle.element.on({tap:function(){a.fireEvent("goToPuzzles",a)}})}else{a.menuPuzzle.hide()}},checkInteractiveContainer:function(){var a=this;if(!a.hasComics&&!a.hasPuzzles){a.menuShareDivider.hide()}},hide:function(){var a=this;a.element.dom.style.maxWidth="0%";setTimeout(function(){a.destroy()},500)},handleJustifiedText:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right");a.menuClose.setRight(false);a.menuClose.setLeft(0);a.menuShare.getLayout().setPack("end")}}},0,["readerpopovermenu"],["component","container","readerpopovermenu"],{component:true,container:true,readerpopovermenu:true},["widget.readerpopovermenu"],0,[InfinityMobile.view.phone,"ReaderPopoverMenu"],0));(Ext.cmd.derive("InfinityMobile.view.phone.StoryWindowPreferences",Ext.Container,{config:{id:"archivecontainer",width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"toolbar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{id:"toolbarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",layout:"vbox",width:"100%",flex:1,style:"background-color:white;border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em",scrollable:{direction:"vertical"},items:[{itemId:"containerText",margin:20,html:"If you turn this setting off, you will always return to the last page of the paper you viewed."},{itemId:"toggleSetting",padding:"20 20",margin:"0 0 40 0",width:"100%",style:"background-color:#eeeeee;position:relative;",html:"<div style=\"max-width:90%;\" >Return to page featuring last story viewed: </div><input class='pointerCursor' type='checkbox' style='margin-left:5px;position:absolute;right:20px;top:50%;transform:translate3d(0px, -50%, 0px);width:15px;height:15px;' class=\"pointerCursor\" onclick='if(this.checked){ this.checked = false; } else{ this.checked = true }' ></input>"}]}]},initialize:function(){var b=this;var a=b.getComponent("toolbar");b.toolbarClose=a.getComponent("toolbarClose");b.bodyContainer=b.getComponent("bodyContainer");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 1)"});b.title=a.getComponent("title");b.title.setHtml("Window Story Preferences");b.setToggleListener();b.setCloseListener();b.checkCurrentSetting()},setCloseListener:function(){var b=this;b.toolbarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolbarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.destroy()},setToggleListener:function(){var a=this;a.toggle=a.bodyContainer.getComponent("toggleSetting");a.toggle.element.on({tap:a.toggleCheck,scope:a})},toggleCheck:function(){var b=this;var d=$(b.toggle.element.dom).find("input");if(d.length>0){var c=d[0];if(c.checked){c.checked=false;try{localStorage.setItem("returnToPage"+publicationguid,"false")}catch(a){}}else{c.checked=true;try{localStorage.setItem("returnToPage"+publicationguid,"true")}catch(a){}}}},checkCurrentSetting:function(){var c=this;try{var b=localStorage.getItem("returnToPage"+publicationguid);var e=$(c.toggle.element.dom).find("input");if(b!=null&&e.length>0){var d=e[0];if(b=="true"){d.checked=true}else{if(b=="false"){d.checked=false}}}}catch(a){}}},0,["storywindowpreferences"],["component","container","storywindowpreferences"],{component:true,container:true,storywindowpreferences:true},["widget.storywindowpreferences"],0,[InfinityMobile.view.phone,"StoryWindowPreferences"],0));(Ext.cmd.derive("InfinityMobile.view.phone.DataCaptureForm",Ext.Container,{config:{height:"100%",width:"100%",fullscreen:true,modal:true,centered:true,style:"background-color:white;overflow:hidden;",scrollable:{direction:"vertical"},layout:{type:"vbox",packed:"middle"},items:[{itemId:"brandingLogo",height:120,width:"calc(100% - 10px)",margin:"20 10 20 10"},{itemId:"welcomeMsg",padding:"10 20 10 20",style:"text-align:center;"},{itemId:"form",padding:"20 20 20 20",defaults:{margin:"10 0 10 0"},items:[{itemId:"firstname",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="First Name"/>'},{itemId:"surname",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Last Name"/>'},{itemId:"email",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Email Address*"/>'},{itemId:"password",width:"100%",height:50,html:'<input type="password" style="padding:20px 10px 20px 10px; height:40px;width:100%;" placeholder="Password*"/>'},{itemId:"confirmPassword",width:"100%",height:50,html:'<input type="password" style="padding:20px 10px 20px 10px; height:40px;width:100%;" placeholder="Confirm Password*"/>'},{itemId:"consentArea",width:"100%"},{itemId:"privacyPolicy",width:"100%",hidden:true},{itemId:"houseNo",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="House No/Name"/>'},{itemId:"address",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Address"/>'},{itemId:"postcode",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Postcode"/>'},{itemId:"telephone",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Telephone No"/>'},{itemId:"required",html:"* Required Field",style:"font-size:12px;"},{itemId:"termsCheckbox",html:"<input type='checkbox' style:'height:10px;'/><label style='padding-left:5px;font-size:14px;'></label><a style='padding-left:5px;font-size:14px;'></a>"},{itemId:"updatedCheckbox",html:"<input type='checkbox' style:'height:10px;'/><label style='padding-left:5px;font-size:14px;'>Keep me updated on the latest news</label>"},{itemId:"errorMsg",hidden:true,html:"*Please make sure the required fields above are completed.",style:"color:red;"},{itemId:"passwordErrorMsg",hidden:true,html:"*Invalid Password. Passwords either do not match or do not meet the requirements. Your password must be at least 8 characters long, include upper and lower case letters, a number, and a special character (!, @, #, $, %, ^, &, *)",style:"color:red;"}]},{itemId:"buttonContainer",width:"calc(100%-10px)",height:180,layout:{type:"vbox",pack:"middle"},padding:"10 20 10 20",defaults:{margin:"10 0 10 0"},items:[{itemId:"registerBtn",height:60,width:"calc(100%-10px)",style:"text-align:center;vertical-align: middle;line-height:60px;",html:"<p>Register</p>"},{itemId:"skipBtn",height:60,width:"100%",style:"text-align:center;color:rgb(0, 0, 0);background-color:rgb(229, 229, 229);vertical-align:middle;line-height:60px;",html:"Skip"}]}]},initialize:function(){var a=this;if(a.config.logo!=null){a.logo=a.config.logo}if(a.config.welcomeText!=null){a.welcomeText=a.config.welcomeText}if(a.config.settings!=null){a.settings=a.config.settings}a.brandingLogo=a.getComponent("brandingLogo");a.welcomeTextArea=a.getComponent("welcomeMsg");a.form=a.getComponent("form");a.buttonContainer=a.getComponent("buttonContainer");a.registerBtn=a.buttonContainer.getComponent("registerBtn");a.skipBtn=a.buttonContainer.getComponent("skipBtn");a.errorMsg=a.form.getComponent("errorMsg");a.passwordErrorMsg=a.form.getComponent("passwordErrorMsg");a.termsCheck=a.form.getComponent("termsCheckbox");a.brandingLogo.setStyle({backgroundImage:"url("+a.logo+")",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"});a.welcomeTextArea.setHtml(language.dataCapture.containerText);a.setupFormFields();a.setupTouchDevices();a.registerBtn.element.on({tap:a.register,scope:a});a.registerBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.skipBtn.element.on({tap:function(){this.fireEvent("closeDataCapture",this);this.destroy()},scope:a});if(Ext.os.is.iOS){a.on({painted:function(){var b=this;setTimeou},2000)},scope:a})}},refreshScrollerSize:function(){try{var b=this;b.scrollable=b.getScrollable();b.scroller=b.scrollable.getScroller();b.scroller.refresh()}catch(a){console.warn("[DataCaptureForm]: Error Caught\n",a)}},setupTouchDevices:function(){var a=this;var b=function(){this.focus()};a.firstname.element.on({tap:b});a.surname.element.on({tap:b});a.email.element.on({tap:b});a.houseNo.element.on({tap:b});a.address.element.on({tap:b});a.postcode.element.on({tap:b});a.telephone.element.on({tap:b});a.updatedCheckbox.element.on({tap:b});a.termsCheck.element.on({tap:b});a.passwordArea.element.on({tap:b});a.confirmPasswordArea.element.on({tap:b})},setupFormFields:function(){var a=this;a.firstname=a.form.getComponent("firstname");a.surname=a.form.getComponent("surname");a.email=a.form.getComponent("email");a.houseNo=a.form.getComponent("houseNo");a.address=a.form.getComponent("address");a.postcode=a.form.getComponent("postcode");a.telephone=a.form.getComponent("telephone");a.updatedCheckbox=a.form.getComponent("updatedCheckbox");a.consentArea=a.form.getComponent("consentArea");a.passwordArea=a.form.getComponent("password");a.confirmPasswordArea=a.form.getComponent("confirmPassword");a.privacyPolicy=a.form.getComponent("privacyPolicy");a.hasTerms=false;$(a.email.element.down("input").dom).attr("placeholder",language.dataCapture.email+"*");a.requiredText=a.form.getComponent("required");a.requiredText.setHtml(language.dataCapture.required);if(a.settings.firstname!=null){if(a.settings.firstname.hasFirstname!=null){if(a.settings.firstname.required=="true"){$(a.firstname.element.down("input").dom).attr("placeholder",language.dataCapture.firstName+"*");a.firstname.required=true}else{$(a.firstname.element.down("input").dom).attr("placeholder",language.dataCapture.firstName);a.firstname.required=false}}else{a.firstname.hide()}}else{a.firstname.hide()}if(a.settings.surname!=null){if(a.settings.surname.hasSurname!=null){if(a.settings.surname.required=="true"){$(a.surname.element.down("input").dom).attr("placeholder",language.dataCapture.lastName+"*");a.surname.required=true}else{$(a.surname.element.down("input").dom).attr("placeholder",language.dataCapture.lastName);a.surname.required=false}}else{a.surname.hide()}}else{a.surname.hide()}if(a.settings.houseNo!=null){if(a.settings.houseNo.hasHouseNo!=null){if(a.settings.houseNo.required=="true"){$(a.houseNo.element.down("input").dom).attr("placeholder",language.dataCapture.houseNo+"*");a.houseNo.required=true}else{$(a.houseNo.element.down("input").dom).attr("placeholder",language.dataCapture.houseNo);a.houseNo.required=false}}else{a.houseNo.hide()}}else{a.houseNo.hide()}if(a.settings.address!=null){if(a.settings.address.hasAddress!=null){if(a.settings.address.required=="true"){$(a.address.element.down("input").dom).attr("placeholder",language.dataCapture.address+"*");a.address.required=true}else{a.address.required=false;$(a.address.element.down("input").dom).attr("placeholder",language.dataCapture.address)}}else{a.address.hide()}}else{a.address.hide()}if(a.settings.postcode!=null){if(a.settings.postcode.hasPostcode!=null){if(a.settings.postcode.required=="true"){$(a.postcode.element.down("input").dom).attr("placeholder",language.dataCapture.postCode+"*");a.postcode.required=true}else{$(a.postcode.element.down("input").dom).attr("placeholder",language.dataCapture.postCode);a.postcode.required=false}}else{a.postcode.hide()}}else{a.postcode.hide()}if(a.settings.telephone!=null){if(a.settings.telephone.hasTelephone!=null){if(a.settings.telephone.required=="true"){$(a.telephone.element.down("input").dom).attr("placeholder",language.dataCapture.telephone+"*");a.telephone.required=true}else{$(a.telephone.element.down("input").dom).attr("placeholder",language.dataCapture.telephone);a.telephone.required=false}}else{a.telephone.hide()}}else{a.telephone.hide()}$(a.passwordArea.element.down("input").dom).attr("placeholder",language.dataCapture.password+"*");a.passwordArea.required=true;$(a.confirmPasswordArea.element.down("input").dom).attr("placeholder",language.dataCapture.confirmPassword+"*");a.confirmPasswordArea.required=true;a.passwordErrorMsg.setHtml("*"+language.dataCapture.invalidPassword);if(a.settings.hasOptIn=="true"){a.updatedCheckbox.element.down("label").dom.innerHTML=language.dataCapture.optIn}else{a.updatedCheckbox.hide()}if(a.settings.terms!=null){a.hasTerms=true;if(a.settings.terms.termsUrl!=null){a.termsCheck.element.down("a").dom.href=a.settings.terms.termsUrl;a.termsCheck.element.down("a").dom.innerHTML=language.dataCapture.terms}else{a.termsCheck.element.down("label").dom.innerHTML=language.dataCapture.terms}}else{a.termsCheck.hide()}a.registerBtn.setHtml(language.register);if(a.settings.showSkip!="true"){a.skipBtn.hide()}else{a.skipBtn.setHtml(language.skip)}a.setupConsentCheckboxes();a.setupPrivacyPolicy()},setupPrivacyPolicy:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.dataCapture!=null&&settings.reader.dataCapture.consent!=null){var c=settings.reader.dataCapture.consent;if(c.privacyPolicyUrl!=null&&c.privacyPolicyUrl.length>0){var b=typeof language!="undefined"&&language.dataCapture!=null&&language.dataCapture.privacyPolicy!=null?language.dataCapture.privacyPolicy:"Privacy Policy";a.privacyPolicy.setHtml("<a href='#'>"+b+"</a>");a.privacyPolicy.element.on("tap",function(d){d.preventDefault();window.open(c.privacyPolicyUrl,"_blank")});a.privacyPolicy.show()}}},setupConsentCheckboxes:function(){var d=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.dataCapture!=null&&settings.reader.dataCapture.consent!=null){var e=settings.reader.dataCapture.consent;var f=e.consentItems;for(var c in f){var b=f[c];var a=Ext.create("InfinityMobile.view.ConsentField",{consentItem:b});d.consentArea.add(a)}}},register:function(){var A=this;var f=false;var n={};var v=null;var m=null;var u=null;var k=null;var g=null;var B=null;var z=null;var h=A.firstname.element.down("input").dom;var r=A.surname.element.down("input").dom;var y=A.email.element.down("input").dom;var e=A.houseNo.element.down("input").dom;var c=A.address.element.down("input").dom;var d=A.postcode.element.down("input").dom;var p=A.telephone.element.down("input").dom;var t=A.updatedCheckbox.element.down("input");var l=A.termsCheck.element.down("input");if(A.firstname.required){if(h.value.length==0){h.style.border="1px solid red";f=true}else{n.firstname=h.value;h.style.border=""}}else{if(h.value.length>0){n.firstname=h.value}}if(A.surname.required){if(r.value.length==0){r.style.border="1px solid red";f=true}else{n.surname=r.value;r.style.border=""}}else{if(r.value.length>0){n.surname=r.value}}if(A.validateEmail(y.value)){if(y.value.length==0){y.style.border="1px solid red";f=true}else{n.email=y.value;y.style.border=""}}else{y.style.border="1px solid red";f=true}if(A.houseNo.required){if(e.value.length==0){e.style.border="1px solid red";f=true}else{n.houseNo=e.value;e.style.border=""}}else{if(e.value.length>0){n.houseNo=e.value}}if(A.address.required){if(c.value.length==0){c.style.border="1px solid red";f=true}else{n.address=c.value;c.style.border=""}}else{if(c.value.length>0){n.houseNo=c.value}}if(A.postcode.required){if(d.value.length==0){d.style.border="1px solid red";f=true}else{n.postcode=d.value;d.style.border=""}}else{if(d.value.length>0){n.postcode=d.value}}if(A.telephone.required){if(p.value.length==0){p.style.border="1px solid red";f=true}else{n.telephone=p.value;p.style.border=""}}else{if(p.value.length>0){n.postcode=p.value}}if(!A.updatedCheckbox.isHidden()){if(t.is(":checked")){n.keepMeUpdated="true"}}var j=true;if(!A.termsCheck.isHidden()){if(l.dom.checked){j=true}else{j=false}}var b=A.passwordArea.element.down("input").dom.value;var o=A.confirmPasswordArea.element.down("input").dom.value;if(b!=o){A.passwordArea.element.down("input").dom.style.border="1px solid red";A.confirmPasswordArea.element.down("input").dom.style.border="1px solid red";f=true;A.passwordErrorMsg.show()}else{if(b.match(/(?=^.{8,}$)(?=.*\d)(?=.*[!@#$%^&*]+)(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)){n.password=b;A.passwordArea.element.down("input").dom.style.border="";A.confirmPasswordArea.element.down("input").dom.style.border="";A.passwordErrorMsg.hide()}else{A.passwordArea.element.down("input").dom.style.border="1px solid red";A.confirmPasswordArea.element.down("input").dom.style.border="1px solid red";f=true;A.passwordErrorMsg.show()}}var a=A.consentArea.getItems().items;n.consentItems=[];for(var q in a){var s=a[q];if(s.blocksSubscription&&!s.checkbox.checked){f=true;s.element.dom.style.border="1px solid red"}else{s.element.dom.style.border=""}n.consentItems.push(s)}if(f||!j){A.errorMsg.show();try{A.refreshScrollerSize()}catch(w){console.warn("[DataCaptureForm]: Error Caught\n",w)}}else{A.fireEvent("sendData",A,n);A.destroy()}console.log(n)},validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}},0,["datacaptureform"],["component","container","datacaptureform"],{component:true,container:true,datacaptureform:true},["widget.datacaptureform"],0,[InfinityMobile.view.phone,"DataCaptureForm"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemWeatherTile",Ext.Container,{config:{cls:"articlereaderitemweathertile",style:"float:left;z-index:6;background-color:#9fb0b9;",layout:"hbox",items:[{itemId:"title",layout:"vbox",flex:1,items:[{html:"<p class='.thirteen' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;padding:20px 0px 0px 20px;'>WEATHER</p>"},{itemId:"location"},{itemId:"desc"}]},{itemId:"temp",flex:1,items:[{itemId:"tempDisplay",centered:true}]},{itemId:"toggle",layout:"vbox",padding:20,flex:1,items:[{itemId:"toggleContainer",layout:{type:"hbox",pack:"center",align:"middle"},flex:1,items:[{html:"<p style='color:white;font-size:13px;padding-right:5px;padding-top:0.2em;'>&deg;C</p>"},{cls:"toggle",itemId:"toggleField",xtype:"togglefield",style:"background:transparent;"},{html:"<p style='color:white;font-size:13px;padding-left:5px;padding-top:0.2em;'>&deg;F</p>"}]},{itemId:"weatherIcon",flex:5}]}]},initializ},onResize:function(){var a=this;a.onResizeFn()}},0,["articlereaderitemweathertile"],["component","container","articlereaderitemweathertile"],{component:true,container:true,articlereaderitemweathertile:true},["widget.articlereaderitemweathertile"],0,[InfinityMobile.view.phone,"ArticleReaderItemWeatherTile"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderBannerAd",Ext.Panel,{config:{style:"padding:0px:overflow:none;",width:"100%",height:50,items:[{itemId:"advert",cls:"advert"}]},initializ},loadAdver},onResizeF}},0,["articlereaderbannerad"],["component","container","panel","articlereaderbannerad"],{component:true,container:true,panel:true,articlereaderbannerad:true},["widget.articlereaderbannerad"],0,[InfinityMobile.view.phone,"ArticleReaderBannerAd"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemTopStoryItem",Ext.Panel,{config:{style:"float:left;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:0,top:0,left:0,right:0,cls:"backgroundImage aspectfill"},{itemId:"title",style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold",bottom:5,top:5,left:5,right:5,height:"100%",padding:10}]},initializ},setBackgroundImag},setNoImag},onTa},liveTap:function(){var a=this;window.open(a.article.url)},testFunc:function(){console.log("TEST")}},0,["articlereaderitemtopstoryitem"],["component","container","panel","articlereaderitemtopstoryitem"],{component:true,container:true,panel:true,articlereaderitemtopstoryitem:true},["widget.articlereaderitemtopstoryitem"],0,[InfinityMobile.view.phone,"ArticleReaderItemTopStoryItem"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemPhone",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;z-index:7;overflow:hidden;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;overflow:hidden;",height:"100%"}]},initializ},loadImag},setBackgroundImag},setNoImag},onTa},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemphone"],["component","container","panel","articlereaderitemphone"],{component:true,container:true,panel:true,articlereaderitemphone:true},["widget.articlereaderitemphone"],0,[InfinityMobile.view.phone,"ArticleReaderItemPhone"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemTopStories",Ext.Container,{config:{width:"100%",style:"float:left;z-index:6;background-color:white;",items:[{itemId:"carousel",xtype:"carousel",top:5,bottom:5,left:5,right:5,margin:10,direction:"horizontal",style:"z-index:6;"}]},initializ},handleItemChange:function(){var a=this}},0,["articlereaderitemtopstories"],["component","container","articlereaderitemtopstories"],{component:true,container:true,articlereaderitemtopstories:true},["widget.articlereaderitemtopstories"],0,[InfinityMobile.view.phone,"ArticleReaderItemTopStories"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemContainer",Ext.Container,{config:{width:"calc(100%)",height:600}},0,["articlereaderitemcontainer"],["component","container","articlereaderitemcontainer"],{component:true,container:true,articlereaderitemcontainer:true},["widget.articlereaderitemcontainer"],0,[InfinityMobile.view.phone,"ArticleReaderItemContainer"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderPanelContainer",Ext.Container,{config:{cls:"articlereaderpanelcontainer",layout:{type:"vbox"},style:"margin: 10px;"},initializ}},0,["articlereaderpanelcontainer"],["component","container","articlereaderpanelcontainer"],{component:true,container:true,articlereaderpanelcontainer:true},["widget.articlereaderpanelcontainer"],0,[InfinityMobile.view.phone,"ArticleReaderPanelContainer"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ClippingOptionsMenu",Ext.Container,{config:{id:"clippingmenu",width:"100%",height:"100%",style:"background:white !important;",layout:"vbox",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{id:"clippingOptionsToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,scrollable:{direction:"vertical"},items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0",html:"<p style='font-size:14px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><p style='font-size:10px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p>"},{id:"clippingsContainer",itemId:"clippingsContainer",style:"border: 1px solid #e6e6e6;",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:140,height:140,margin:"7 8 16 7",cls:"archiveitemphone"}},{itemId:"buttonsContainer",layout:"hbox",height:60,items:[{itemId:"previewBtn",flex:1,cls:"btn",margin:"15 5 5 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/preview-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Preview",margin:5,style:"color:white;font-size:10pt;"}]},{itemId:"downloadBtn",flex:1,cls:"btn",margin:"15 0 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/downloads-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Save",margin:5,style:"color:white;font-size:10pt;"}]}]},{itemId:"printButtonContainer",layout:"hbox",height:50,items:[{itemId:"printBtn",cls:"btn",flex:1,margin:"5 0 5 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/print-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Print",margin:5,style:"color:white;font-size:11pt;text-align:center;"}]}]},{itemId:"shareButtonContainer",layout:"hbox",height:60,items:[{itemId:"shareBtn",cls:"btn",flex:2,margin:"5 0 15 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/share-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Share",margin:5,style:"color:white;font-size:11pt;"}]}]}]}]},initialize:function(){var b=this;b.clippingsToolbar=b.getComponent("clippingOptionsToolBar");b.clippingsToolbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.closeBtn=b.clippingsToolbar.getComponent("clippingOptionsToolBarClose");b.clippingsBody=b.getComponent("clippingOptionsBodyContainer");b.clippingsContainer=b.clippingsBody.getComponent("clippingsContainer");b.buttonsContainer=b.clippingsBody.getComponent("buttonsContainer");b.shareButtonContainer=b.clippingsBody.getComponent("shareButtonContainer");b.previewBtn=b.buttonsContainer.getComponent("previewBtn");b.downloadBtn=b.buttonsContainer.getComponent("downloadBtn");b.shareBtn=b.shareButtonContainer.getComponent("shareBtn");b.printButtonContainer=b.clippingsBody.getComponent("printButtonContainer");b.printBtn=b.printButtonContainer.getComponent("printBtn");b.title=b.clippingsToolbar.getComponent("title");b.title.setHtml(language.clippings.clippingsOptions);b.clippingOptionsContainerText=b.clippingsBody.getComponent("clippingOptionsContainerText");b.clippingOptionsContainerText.setHtml("<p style='font-size:16px;'>"+language.clippings.ClippingsOptionsText+"</p><br /><p style='font-size:12px;color:#444444'>"+language.clippings.clippingsPleaseNote+"</p>");b.previewBtn.getComponent("Preview").setHtml(language.clippings.preview);b.downloadBtn.getComponent("Save").setHtml(language.clippings.save);b.shareBtn.getComponent("Share").setHtml(language.clippings.share);b.printBtn.getComponent("Print").setHtml(language.clippings.print);b.previewBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.downloadBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.printBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.shareBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.closeBtn.element.on("tap",function(){b.destroy()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeBtn.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}if(b.config.images!=null){b.images=b.config.images}if(b.config.widths!=null){b.widths=b.config.widths}if(b.config.heights!=null){b.heights=b.config.heights}b.addThumbnails();b.previewBtn.element.on({tap:b.preview,scope:b});b.downloadBtn.element.on({tap:b.download,scope:b});b.shareBtn.element.on({tap:b.shareTap,scope:b});if(Ext.browser.is.Firefox){b.printButtonContainer.hide()}else{b.printBtn.element.on({tap:b.print,scope:b})}mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},preview:function(){var d=this;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c=true;break}}if(c){var a=Ext.create("InfinityMobile.view.ClippingMenuPreview",{images:d.images,clippingMenu:d})}else{d.promptUser(language.clippings.selectClippings)}},downloa},print:function(){var h=this;var e=false;var c="";var j=[];for(var g=0;g<h.images.length;g++){var k=h.images[g];if(h.clippingsContainer.innerItems[g].clicked){if(!e){e=true}j[j.length]=k;c+="<div style='width:100%; height:100%; position:relative'>";c+="<img src='"+k+"' style='height:auto;width:auto;max-height:100%;max-width:100%;' />";c+="</div>"}}if(e){if(Ext.os.is.Android||Ext.os.is.iOS){printingClipping=true;var f=$(".printContainer")[0];var d=1000+(j.length*800);f.innerHTML=c;Ext.Viewport.setMasked({xtype:"loadmask",message:"Loading",zIndex:999999999});function b(){printingClipping=false;h.fireEvent("setupPrintContainer");window.removeEventListener("afterprint",b,false)}setTimeout(function(){Ext.Viewport.setMasked(false);window.print();window.addEventListener("afterprint",b,false)},d)}else{var a=Ext.create("InfinityMobile.view.PrintPreview",{doc:c,imgCheck:true});Ext.Viewport.add(a);a.show()}}else{h.promptUser(language.clippings.selectClippings)}},shareTap:function(){var d=this;d.shareBtn.removeAll();d.shareBtn.element.dom.style.backgroundColor="#e6e6e6";var b=d.getShareObjects();d.shareBtn.add(b);var a=Ext.getStore("SettingStore");d.emailBtn=d.shareBtn.getComponent("email");d.facebookBtn=d.shareBtn.getComponent("facebook");d.twitterBtn=d.shareBtn.getComponent("twitter");d.linkedinBtn=d.shareBtn.getComponent("linkedin");d.googleBtn=d.shareBtn.getComponent("google");d.googleBtn.hide();d.pinterestBtn=d.shareBtn.getComponent("pinterest");d.whatsappBtn=d.shareBtn.getComponent("whatsapp");var c=a.data.items[0].raw.sharing;console.log(c);if(c!=null&&c.allSharing.indexOf("email")==-1){d.emailBtn.hide()}else{d.emailBtn.element.on({tap:d.emailShare,scope:d})}if(c!=null&&c.allSharing.indexOf("facebook")==-1){d.facebookBtn.hide()}else{d.facebookBtn.element.on({tap:d.facebookShare,scope:d})}if(c!=null&&c.allSharing.indexOf("twitter")==-1){d.twitterBtn.hide()}else{d.twitterBtn.element.on({tap:d.twitterShare,scope:d})}if(c!=null&&c.allSharing.indexOf("linkedIn")==-1){d.linkedinBtn.hide()}else{d.linkedinBtn.element.on({tap:d.linkedinShare,scope:d})}if(c!=null&&c.allSharing.indexOf("pinterest")==-1){d.pinterestBtn.hide()}else{d.pinterestBtn.element.on({tap:d.pinterestShare,scope:d})}if(c!=null&&c.allSharing.indexOf("whatsapp")==-1){d.whatsappBtn.hide()}else{if(c!=null&&c.whatsapp!=null){d.whatsappBtn.element.dom.style.backgroundImage="url("+c.whatsapp.iconDark+")";d.whatsappBtn.element.on({tap:d.whatsappShare,scope:d})}}},getShareObjects:function(){var a=this;var b=null;if(settings.newsday!=null&&settings.newsday.useFontAwesome=="true"){b=[{itemId:"email",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-envelope fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"facebook",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-facebook-official fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"twitter",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-twitter fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"linkedin",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-linkedin-square fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"google",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-google-plus fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"pinterest",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-pinterest fa-lg pointerCursor" aria-hidden="true"></i>'}]}else{b=[{itemId:"email",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/email-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"facebook",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/facebook-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"twitter",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/twitter-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"linkedin",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/linkedin-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"google",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/google-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"pinterest",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/pinterest-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"whatsapp",width:30,height:30,cls:"pointerCursor",style:"background-size:contain;background-position:center;background-repeat:no-repeat;"}]}return b},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingItems",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingsContainer.add(c);c.show()}},promptUser:function(b){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:b})},getSubject:function(){var a="Clippings from "+publicationName;if(settings.clippings.clippingSubject!=null){a=settings.clippings.clippingSubject}return a},getShareUrl:function(b){var c=this;var d=window.location.host;var a=b.split("/");b="https://"+d+"/html5/reader/get_clipping.aspx?edid="+a[5]+"&pnum="+a[6]+"&time="+a[7];return b},emailShare:function(){var d=this;var e=false;var f=d.getSubject();var a="mailto:?subject="+encodeURIComponent(f)+"&body=";var c="To view a clipping, please select one of the links below:\n\n";if(settings.clippings.clippingsBody!=null){c=settings.clippings.clippingsBody+"\n\n"}for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c+=d.getShareUrl(d.images[b])+" \n\n";e=true}}if(e){var c=a+encodeURIComponent(c);if(window.parent!=null&&(typeof NEWPWA!="undefined"&&NEWPWA===true)){window.parent.postMessage({type:"sendEmail",message:c},"*")}else{window.location.href=c}}else{d.promptUser(language.clippings.selectClippings)}},facebookShare:function(){var e=this;var a="";var f=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=encodeURIComponent(e.getShareUrl(e.images[c]));d=true}else{d=false;f=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();window.open("http://www.facebook.com/sharer/sharer.php?m2w&u="+a+"&title="+encodeURIComponent(b))}else{e.promptUser(f)}},twitterShare:function(){var e=this;var a="";var g=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=e.getShareUrl(e.images[c]);d=true}else{d=false;g=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();var f=encodeURIComponent(b+" - "+a);window.open("http://twitter.com/intent/tweet?text="+f)}else{e.promptUser(g)}},linkedinShare:function(){var f=this;var a="";var g=null;var e=false;for(var d=0;d<f.images.length;d++){if(f.clippingsContainer.innerItems[d].clicked){if(!e){a=f.getShareUrl(f.images[d]);e=true}else{e=false;g=language.clippings.selectOneClipping;break}}}if(e){var c=f.getSubject();var b=encodeURIComponent(c+" - "+a);window.open("http://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(a)+"&title="+b)}else{f.promptUser(g)}},googleShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.getShareUrl(d.images[b]);c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("https://plus.google.com/share?url="+encodeURIComponent(a))}else{d.promptUser(e)}},pinterestShare:function(){var e=this;var a="";var f=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=e.getShareUrl(e.images[c]);d=true}else{d=false;f=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();window.open("http://pinterest.com/pin/create/bookmarklet/?media="+encodeURIComponent(a)+"&is_video=false&description="+encodeURIComponent(b))}else{e.promptUser(f)}},whatsappShare:function(){var f=this;var b="";var g=null;var e=false;for(var d=0;d<f.images.length;d++){if(f.clippingsContainer.innerItems[d].clicked){if(!e){b=f.getShareUrl(f.images[d]);e=true}else{e=false;g=language.clippings.selectOneClipping;break}}}if(e){var a=Ext.getStore("SettingStore");var c=a.data.items[0].raw.sharing;if(c!=null&&c.whatsapp!=null){window.open(c.whatsapp.link.replace("{0}",encodeURIComponent(b)))}}else{f.promptUser(g)}},destroy:function(){var a=this;Ext.Container.prototype.destroy.apply(this,arguments);mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME)}},0,["clippingoptionsmenu"],["component","container","clippingoptionsmenu"],{component:true,container:true,clippingoptionsmenu:true},["widget.clippingoptionsmenu"],0,[InfinityMobile.view.phone,"ClippingOptionsMenu"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ClippingArea",Ext.Panel,{config:{modal:true,hideOnMaskTap:true,fullscreen:true,style:"position:absolute;top:-100%;",items:[{itemId:"backgroundTop",layout:"hbox"},{itemId:"clipArea",layout:{type:"hbox",align:"stretch"},height:"auto",width:"200%",items:[{itemId:"clipBox",html:'<div class="clipper" style="display:none;position:relative;top:0px;width:30px;overflow:auto;height:30px;border:4px solid rgb(69, 143, 187);"><div class="ui-resizable-handle ui-resizable-se se-handle" ></div></div>'},{itemId:"backgroundRight",flex:1,style:"background-color:rgba(0, 0, 0, 0.5)"}]},{itemId:"backgroundBottom",items:[{itemId:"controlPanel",width:120,height:40,style:{backgroundColor:"rgba(0,0,0,0.7)",borderRadius:"5px",position:"absolute",margin:"5px 0px 5px 0px",zIndex:"999"},hidden:true,layout:"hbox",items:[{itemId:"cancel",width:40,height:40,style:{backgroundImage:'url("resources/images/reader icons/close-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}},{itemId:"reset",height:40,width:40,style:{backgroundImage:'url("resources/images/reader icons/refresh-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}},{itemId:"confirm",height:40,width:40,style:{backgroundImage:'url("resources/images/reader icons/tick-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}}]}]},{itemId:"backgroundLeft"}]},initialize:function(){var b=this;b.clipperDrawn=false;var a=b.getComponent("clipArea");b.clipBox=a.getComponent("clipBox");b.top=b.getComponent("backgroundTop");b.left=b.getComponent("backgroundLeft");b.bottom=b.getComponent("backgroundBottom");b.controlPanel=b.bottom.getComponent("controlPanel");b.cancel=b.controlPanel.getComponent("cancel");b.reset=b.controlPanel.getComponent("reset");b.confirm=b.controlPanel.getComponent("confirm");b.setupSizing();b.origDocH=$(document).height();b.origDocW=$(document).width();if(currentProfile){b.setupPhone()}if(b.config.reader!=null){b.reader=b.config.reader}if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}b.setupButtonEvents();b.preventBrowserBehaviour();b.setupTouchEvents();mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},setupTouchEvents:function(){var a=this;a.element.dom.addEventListener("touchstart",function(b){a.mouseDown(b)});a.element.dom.addEventListener("touchend",function(b){a.mouseUp(b)});a.setupDraggableHandle()},setupDraggableHandle:function(){var a=this;a.draggableHandle=a.element.down(".ui-resizable-handle");a.draggableHandle.dom.style.width="50px";a.draggableHandle.dom.style.height="50px";a.draggableHandle.dom.addEventListener("touchstart",function(b){b.stopPropagation();var k=b.changedTouches[0].clientX;var h=b.changedTouches[0].clientY;var c=$(".clipper").width();var j=$(".clipper").height();var d="";switch(a.getPrefix().css){case"-webkit-":d=a.element.dom.style.webkitTransform;break;case"-ms-":d=a.element.dom.style.msTransform;break;default:d=a.element.dom.style.transform;break}var g=d.substring(d.indexOf("(")+1,d.indexOf(")")).split(",");var f=g[0].substring(0,g[0].indexOf("p"));var e=g[1].substring(0,g[1].indexOf("p"));a.move=function(l){l.stopPropagation();l.preventDefault();a.resizeClippingBox(l.changedTouches[0].clientX,l.changedTouches[0].clientY,f,e,k,h,c,j);a.checkControlsPosition()};document.addEventListener("touchmove",a.move)});a.draggableHandle.dom.addEventListener("touchend",function(b){document.removeEventListener("touchstart",null)})},mouseDown:function(h){var e=this;h.preventDefault();if(!e.clipperDrawn){var c="translate3d("+h.changedTouches[0].clientX+"px, "+(h.changedTouches[0].clientY)+"px, 0px)";e.applyTransform(e.element.dom,c);$(".clipper").css("display","");e.controlPanel.show();var l=h.changedTouches[0].clientX;var k=h.changedTouches[0].clientY;e.clipperDrawn=true;e.move=function(m){m.stopPropagation();m.preventDefault();e.drawClippingBox(l,k,m.changedTouches[0].clientX,m.changedTouches[0].clientY);e.checkControlsPosition()};document.addEventListener("touchmove",e.move)}else{var d="";switch(e.getPrefix().css){case"-webkit-":d=e.element.dom.style.webkitTransform;break;case"-ms-":d=e.element.dom.style.msTransform;break;default:d=e.element.dom.style.transform;break}var f=d.substring(d.indexOf("(")+1,d.indexOf(")")).split(",");var j=parseFloat(f[0].substring(0,f[0].indexOf("p")));var g=parseFloat(f[1].substring(0,f[1].indexOf("p")));var b=h.changedTouches[0].clientX;var a=h.changedTouches[0].clientY;e.move=function(m){m.preventDefault();var o=b-m.changedTouches[0].clientX;var n=a-m.changedTouches[0].clientY;e.moveClippingBox(j,g,o,n);e.checkControlsPosition()};document.addEventListener("touchmove",e.move)}},resizeClippingBox:function(b,a,j,e,q,o,c,p){var g=this;if(b>parseFloat(j)){var n=c+b-q;var d=j}else{var d=b;var n=parseFloat(j)-b}if(a>parseFloat(e)){var f=p+a-o;var l=e}else{var l=a;var f=parseFloat(e)-a}if(d<0){var m=0-d;d=0;n-=m}if(l<0){var k=0-l;l=0;f-=k}g.element.dom.style.transform="translate3d("+d+"px, "+(l)+"px, 0px)";g.element.dom.style.webkitTransform="translate3d("+d+"px, "+(l)+"px, 0px)";g.element.dom.style.mozTransform="translate3d("+d+"px, "+(l)+"px, 0px)";g.element.dom.style.msTransform="translate3d("+d+"px, "+(l)+"px, 0px)";if(parseInt(d)+parseInt(n)>$(document).width()){n=$(document).width()-d}if(parseInt(l)+parseInt(f)>$(window).height()){f=$(window).height()-l}$(".clipper").css("height",f);$(".clipper").css("width",n)},moveClippingBox:function(e,d,j,h){var b=this;var f=e-j;var c=d-h;var g=b.clipBox.element.dom;if(f<0){f=0}if(c<0){c=0}if(f>$(document).width()-$(g).width()){f=$(document).width()-$(g).width()}if(c>window.innerHeight-$(g).height()){c=window.innerHeight-$(g).height()}var a="translate3d("+f+"px, "+(c)+"px, 0px)";b.element.dom.style.webkitTransform=a;b.element.dom.style.mozTransform=a;b.element.dom.style.msTransform=a;b.element.dom.style.transform=a},drawClippingBox:function(n,m,b,a){var f=this;var j;var c;if(b>n){var l=b-n;var c=n}else{var l=n-b;var c=b}if(a>m){var e=a-m;var j=m}else{var e=m-a;var j=a}if(c<0){var k=0-c;c=0;l-=k}if(j<0){var g=0-j;j=0;e-=g}var d="translate3d("+c+"px, "+(j)+"px, 0px)";f.element.dom.style.webkitTransform=d;f.element.dom.style.mozTransform=d;f.element.dom.style.msTransform=d;f.element.dom.style.transform=d;if(parseInt(c)+parseInt(l)>$(document).width()){l=$(document).width()-c}if(parseInt(j)+parseInt(e)>$(window).height()){e=$(window).height()-j}$(".clipper").css("height",e);$(".clipper").css("width",l)},checkControlsPosition:function(){var e=this;var b=e.controlPanel.element.dom;var a=e.clipBox.element.dom;var d=a.getBoundingClientRect().top;var c=a.getBoundingClientRect().right;var h=window.innerHeight-$(a).height()-50;var g=$(window).width();var f="";if(d>=h){if($(a).width()-90>=0){f="translate3d(0px,-30px,0px)"}else{if(c+90>=g){f="translate3d(-100%,-30px,0px)"}else{f="translate3d("+$(a).width()+"px,-30px,0px)"}}}else{if($(a).width()-90>=0){f="translateX("+($(a).width()-90)+"px)"}else{if(c+90>=g){f="translate3d(-100%,-30px,0px)"}else{f="translateX(0px)"}}}$(b).css("-webkit-transform",f);$(b).css("-moz-transform",f);$(b).css("-ms-transform",f);$(b).css("transform",f)},mouseUp:function(b){var a=this;b.preventDefault();document.removeEventListener("touchmove",a.move)},applyTransfor},preventBrowserBehaviour:function(){var a=this;a.element.on({dragstart:function(b){b.stopPropagation()},drag:function(b){b.stopPropagation()},dragend:function(b){b.stopPropagation()}})},setupButtonEvents:function(){var a=this;a.confirm.element.on({tap:a.keyPress,scope:a});a.cancel.element.on({tap:a.selfDestruct,scope:a});a.reset.element.on({tap:a.resize,scope:a})},setupPhone:function(){var a=this;a.controlPanel.setHeight(30);a.controlPanel.setWidth(90);a.cancel.setHeight(30);a.cancel.setWidth(30);a.reset.setHeight(30);a.reset.setWidth(30);a.confirm.setHeight(30);a.confirm.setWidth(30)},setupSizing:function(){var c=this;var b=$(document).width();var a=window.innerHeight;c.top.setHtml("<div style='position:relative;width:"+(b*2)+"px;height:"+a+"px;background-color:rgba(0, 0, 0, 0.5)'></div>");c.left.setHtml("<div style='position:absolute;left:-200%;top:0%;width:"+(b*2)+"px;height:"+(a*2.5)+"px;background-color:rgba(0, 0, 0, 0.5)'></div>");c.bottom.setHtml("<div style='position:relative;width:"+(b*2)+"px;height:"+(a*2)+"px;background-color:rgba(0, 0, 0, 0.5)'></div>")},keyPres},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},selfDestruc},resize:function(){var a=this;a.setupSizing();a.fireEvent("resetClippingArea",a)},destroy:function(){var a=this;mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["clippingarea"],["component","container","panel","clippingarea"],{component:true,container:true,panel:true,clippingarea:true},["widget.clippingarea"],0,[InfinityMobile.view.tablet,"ClippingArea"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ClippingArea",Ext.Panel,{config:{modal:true,hideOnMaskTap:true,fullscreen:true,style:"position:absolute;top:-100%;",items:[{itemId:"backgroundTop",layout:"hbox",items:[{itemId:"clipBtn",hidden:false,height:30,width:60,html:"Clip"},{itemId:"resetBtn",hidden:false,height:30,width:60,html:"Reset"},{itemId:"cancelBtn",hidden:false,height:30,width:60,html:"Cancel"}]},{itemId:"clipArea",layout:{type:"hbox",align:"stretch"},height:"auto",width:"200%",items:[{itemId:"clipBox",html:'<div class="clipper" style="display:none;position:relative;top:0px;width:30px;overflow:auto;height:30px;border:4px solid rgb(69, 143, 187);"><div class="ui-resizable-handle ui-resizable-se se-handle" ></div></div>'},{itemId:"backgroundRight",flex:1,style:"background-color:rgba(0, 0, 0, 0.5)"}]},{itemId:"backgroundBottom"},{itemId:"backgroundLeft"}]},initializ},bannerAdCheck:function(){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.reader.bannerAd!=null){b.element.dom.style.top="calc(-100% - 110px)"}},fillCheck:function(){var b=this;if(b.readerActiveItem.zoomMode=="fill"){var a=($(b.reader.element.dom).height()/b.readerActiveItem.height)*100;b.element.dom.style.top="calc(-"+a+"% + "+b.readerActiveItem.scroller.position.y+"px)"}},zoomChec},keyPres},mouseDow},mouseUp:function(b){var a=this;b.preventDefault();document.removeEventListener("touchmove",a.move)},selfDestruc},resize:function(){var a=this;a.fireEvent("resetClippingArea",a)}},0,["clippingarea"],["component","container","panel","clippingarea"],{component:true,container:true,panel:true,clippingarea:true},["widget.clippingarea"],0,[InfinityMobile.view.phone,"ClippingArea"],0));(Ext.cmd.derive("InfinityMobile.view.phone.clippingPrompt",Ext.Container,{config:{modal:true,centered:true,width:"80%",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingPromptToolBar",height:40,items:[{itemId:"clippingTitle",top:10,left:10,html:"Create Clipping"}]},{id:"clippingPromptBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingPromptContainerText",margin:"0 0 20px 0"},{itemId:"buttonArea",padding:"20",layout:"hbox",items:[{itemId:"checkbox",flex:1,html:"<input class='check' type='checkbox' ><label style='font-size:8px;padding:5px;'>Don't show again.</label></input>"},{itemId:"button",flex:1,html:"Ok",style:"text-align:center;margin: 5px;border-style:solid;height:30px;width:120px;"}]}]}]},initialize:function(){var b=this;var a=b.getComponent("clippingPromptToolBar");b.clippingTitle=a.getComponent("clippingTitle");b.clippingTitle.setHtml(language.clippings.createClipping);a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.clippingPromptBody=b.getComponent("clippingPromptBodyContainer");b.buttonArea=b.clippingPromptBody.getComponent("buttonArea");b.button=b.buttonArea.getComponent("button");b.checkbox=b.buttonArea.getComponent("checkbox").element.down(".check");b.bodyText=b.clippingPromptBody.getComponent("clippingPromptContainerText");if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}if(b.config.reader!=null){b.reader=b.config.reader}b.buttonArea.getComponent("checkbox").element.on({ta},scope:b.buttonArea.getComponent("checkbox")});b.setupText();b.button.element.on({tap:b.okay,scope:b});b.button.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});if(settings.newsday){b.element.dom.style.borderRadius=""}mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},okay:function(){var b=this;console.log(b.checkbox.dom.checked);if(b.checkbox.dom.checked){try{localStorage.setItem("clippingPrompt"+publicationguid,"set")}catch(a){}}if(currentProfile=="desktop"){var c=Ext.create("InfinityMobile.view.ClippingArea",{readerActiveItem:b.readerActiveItem,reader:b.reader})}else{var c=Ext.create("InfinityMobile.view.tablet.ClippingArea",{readerActiveItem:b.readerActiveItem,reader:b.reader})}Ext.Viewport.add(c);c.show();b.destroy()},setupTex}},0,["clippingprompt"],["component","container","clippingprompt"],{component:true,container:true,clippingprompt:true},["widget.clippingprompt"],0,[InfinityMobile.view.phone,"clippingPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ClippingOptions",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>Clipping Options</b>"},{id:"clippingOptionsToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0",html:"<p style='font-size:12px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><br /><p style='font-size:10px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p>"},{itemId:"clippingScroller",height:"180px",layout:"hbox",scrollable:{direction:"horizontal"}},{itemId:"options",items:[{itemId:"ButtonsDiv"},{itemId:"EmailDiv"}]}]}]},initializ},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingMenuThumb",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingScroller.add(c);c.show()}},promptUser:function(){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt")},updateImages:function(a){var b=this;b.images=a;b.clippingScroller.removeAll(true);b.addThumbnails()}},0,["clippingoptions"],["component","container","clippingoptions"],{component:true,container:true,clippingoptions:true},["widget.clippingoptions"],0,[InfinityMobile.view.phone,"ClippingOptions"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleSectionItem",Ext.Container,{config:{height:"100%",width:250,layout:"vbox",style:"border:5px solid transparent;",items:[{itemId:"bodyContainer1",height:200,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;"}]},initializ},loadArticle},returnBodyTex},body1Tap:function(){var a=this;console.log("ARTICLE TOP TAP");a.fireEvent("jumpToPage",a.article1.pageNumber-1);a.fireEvent("articleClick",a.article1,a.article1.guid);a.container.destroy()}},0,["articlesectionitem"],["component","container","articlesectionitem"],{component:true,container:true,articlesectionitem:true},["widget.articlesectionitem"],0,[InfinityMobile.view.phone,"ArticleSectionItem"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleSectionItemImg",Ext.Container,{config:{height:"100%",width:280,layout:"vbox",style:"border:5px solid transparent;",items:[{itemId:"image",height:125,style:"border:5px solid transparent;"},{itemId:"bodyContainer",height:75,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;"}]},initializ},loadArticl},onTa}},0,["articlesectionitemimg"],["component","container","articlesectionitemimg"],{component:true,container:true,articlesectionitemimg:true},["widget.articlesectionitemimg"],0,[InfinityMobile.view.phone,"ArticleSectionItemImg"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticlesSectionContainer",Ext.Container,{config:{height:250,layout:"vbox",style:"margin-left:15px solid transparent !important;margin-right:15px solid transparent !important;",items:[{itemId:"sectionTitle",height:40,style:"background-color:black;opacity:0.95;color:white;font-size:18px;font-weight:bold;"},{itemId:"sectionBody",height:360,layout:"hbox",style:"background-color:rgba(0,0,0,0.8);"}]},initializ},loadArticle}},0,["articlesectioncontainer"],["component","container","articlesectioncontainer"],{component:true,container:true,articlesectioncontainer:true},["widget.articlesectioncontainer"],0,[InfinityMobile.view.phone,"ArticlesSectionContainer"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ArticlesContainer",Ext.Container,{config:{width:"100%",height:440,zIndex:100000,bottom:-40,items:[{itemId:"sectionToolbar",width:"100%",height:40,top:0,layout:"hbox",style:"background-color:rgba(0,0,0,0.8);border-bottom:1px solid gray;overflow:hidden;",items:[{itemId:"sectionArea",height:40,width:"100%",layout:"hbox",style:"overflow:hidden;"},{itemId:"expandBtn",cls:"pointerCursor",height:40,width:"40px",right:40,style:'border-left:1px solid gray;background-image:url("resources/images/reader icons/expand ic.png");background-size:60% 50%;background-repeat:no-repeat;background-position:center;'},{itemId:"closeBtn",cls:"pointerCursor",height:40,width:"40px",right:0,style:'border-left:1px solid gray;background-image:url("resources/images/reader icons/close btn.png");background-size:60% 50%;background-repeat:no-repeat;background-position:center;'}]},{itemId:"con",layout:"hbox",top:40,style:"background-color:rgba(0,0,0,0.8);",width:"100%",height:"360px",scrollable:{direction:"horizontal"}}]},initialize:function(){var d=this;d.sectionIndex=null;d.sectionToolbar=d.getComponent("sectionToolbar");d.sectionArea=d.sectionToolbar.getComponent("sectionArea");d.closeBtn=d.sectionToolbar.getComponent("closeBtn");d.expandBtn=d.sectionToolbar.getComponent("expandBtn");d.contentArea=d.getComponent("con");d.pagesHeight=180;d.scrollType="senchaScroller";d.offset=0;if(d.config.articles!=null){d.articles=d.config.articles}if(d.config.sections!=null){d.sections=d.config.sections}if(d.config.mode!=null){d.mode=d.config.mode}d.checkMode();d.sortSections();if(d.articles!=null&&d.articles.length>0&&settings.articles!=null){d.display="articles";d.mode="start";d.loadContainer()}else{d.display="articles";d.mode="start"}d.checkSections();d.getComponent("con").getScrollable().getScroller().on({scroll:d.onScroll,scope:d});d.element.on({hide:d.hideMe,scope:d});if(currentProfile=="tablet"||currentProfile=="largetablet"){d.tabletMode()}d.closeBtn.element.on({tap:d.hide,scope:d});d.expandBtn.element.on({tap:d.expand,scope:d});if(d.sectionArea.getScrollable()==null){d.sectionArea.setScrollable({direction:"horizontal"})}Ext.Viewport.on("orientationchange",function(){d.resizeOb()});var e=d.sectionArea&&d.sectionArea.getScrollable();var b=e&&e.getScroller();var a=b&&b.getElement();if(Ext.browser.is.Firefox&&b&&a&&a.dom){var c=a.dom;var f=e.getElement().dom;if(!!c&&!!f){b.on({scrollstart:function(j){var h=$(c).width()-$(f).width();var g=$(c).height()-$(f).height();b.maxPosition={x:h,y:g}},scope:d})}}},sortSections:function(){var a=this},tabletMod},checkMod},checkSections:function(){var a=this;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hidePageBrowserSections=="true"&&a.display=="pages"){a.sectionArea.addCls("hide-sections")}else{if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hideArticleBrowserSections=="true"&&a.display=="articles"){a.sectionArea.addCls("hide-sections")}else{a.sectionArea.removeCls("hide-sections")}}},loadContainer:function(){var h=this;var d=Ext.getStore("ArticleStore");var b=d.uniqueArticles;if(h.sections.length>0){var l=[];if(h.sections[0].pageNumber>1){h.sections.unshift({page:1,pageNumber:1,name:""})}for(var f=0;f<h.sections.length;f++){var e=[];var g=parseInt(h.sections[f].page);for(var j=0;j<b.length;j++){if(h.sections[f+1]!=null){var c=articleDictionary[b[j]];var a=c!=null?c.pageNumber!=null?c.pageNumber:c.parentpage:null;if(c!=null&&a>=g&&a<parseInt(h.sections[f+1].page)){e.push(b[j])}}else{var c=articleDictionary[b[j]];var a=c!=null?c.pageNumber!=null?c.pageNumber:c.parentpage:null;if(c!=null&&a>=g){e.push(b[j])}}}if(e.length>0){var k=Ext.create("InfinityMobile.view.ArticlesSectionContainer",{section:h.sections[f],articles:e,container:h});h.getComponent("con").add(k)}}}else{var k=Ext.create("InfinityMobile.view.ArticlesSectionContainer",{section:"All",articles:b,container:h});h.getComponent("con").add(k)}},loadSectionsBtns:function(){var l=this;l.sectionArea.removeAll();var j=0;for(var h=0;h<l.sections.length;h++){if(h==0){var d="white"}else{var d="gray"}var f=Ext.getStore("ArticleStore");var c=f.uniqueArticles;if(c.length>0){var g=[];var k=parseInt(l.sections[h].page);for(var m=0;m<c.length;m++){if(l.sections[h+1]!=null){var e=articleDictionary[c[m]];var a=e!=null?e.pageNumber!=null?e.pageNumber:e.parentpage:null;if(e!=null&&a>=k&&a<parseInt(l.sections[h+1].page)){g.push(c[m])}}else{var e=articleDictionary[c[m]];var a=e!=null?e.pageNumber!=null?e.pageNumber:e.parentpage:null;if(e!=null&&a>=k){g.push(c[m])}}}if(g.length>0){var b=Ext.create("Ext.Container",{cls:"browserBtn",height:40,html:l.sections[h].name!=null?l.sections[h].name.trim():"",style:"color:"+d+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:j,articleContainer:l,section:l.sections[h]});l.sectionArea.add(b);b.element.on({tap:function(){l.sectionTap(this,this.config.articleContainer)},painted:function(){var o=this.config.articleContainer;var n=o.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(n)},scope:b});j+=1}}else{if(l.sections.length>0){var b=Ext.create("Ext.Panel",{cls:"browserBtn",height:40,html:l.sections[h].name!=null?l.sections[h].name.trim():"",style:"color:"+d+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:j,articleContainer:l,section:l.sections[h]});l.sectionArea.add(b);b.element.on({tap:function(){l.sectionTap(this,this.config.articleContainer)},painted:function(){var o=this.config.articleContainer;var n=o.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(n)},scope:b});j+=1}}}},scrollSectionsArea:function(k,h){var e=this;var b=k.element.dom.offsetLeft;var g=e.sectionArea.getScrollable();if(g!=null&&g.getScroller()!=null){var d=g.getScroller();var c=d.position.x;if(h=="back"){if(c+40>b){var a=Math.max(b-10,0);d.scrollTo(a)}}else{if(h=="next"){var l=$(k.element.dom).width()+b;var j=($(document).width()-120);if(j+c<l){var f=(l+10)-j;var a=Math.min(f,d.maxPosition.x);d.scrollTo(a)}}}}},setActiveSections:function(b,h){var d=this;var f=d.getActiveSection();for(var c=0;c<d.sectionArea.items.items.length;c++){var g=d.sectionArea.items.items[c];if(g!=null){$(g.element.dom).css("color","gray");g.config.isActive=false}}for(var c=b;c<=h;c++){var g=d.sectionArea.items.items[c];if(g!=null){$(g.element.dom).css("color","white");g.config.isActive=true}}var a=d.getActiveSection();var e="back";if(a.pos>f.pos){e="next"}if(a.sectionBtn!=null){d.scrollSectionsArea(a.sectionBtn,e)}},getActiveSection:function(){var d=this;var c=d.sectionArea.items.items;var a={};for(var b in c){if(c[b].config.isActive==true){a.pos=c[b].config.position;a.sectionBtn=c[b];break}}return a},loadSectionBtnsPages:function(){var d=this;d.sectionArea.removeAll();var c=0;for(var b=0;b<d.sections.length;b++){if(b==0){var a="white"}else{var a="gray"}var e=Ext.create("Ext.Panel",{cls:"browserBtn",height:40,html:d.sections[b].name.trim(),style:"color:"+a+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:c,articleContainer:d,section:d.sections[b]});d.sectionArea.add(e);e.element.on({ta},painted:function(){var g=this.config.articleContainer;var f=g.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(f)},scope:e});c+=1}},onScroll:function(n){var o=this;if(o.mode=="articles"){if(n.position.x>0){var m=0;var j;for(var k=0;k<o.getComponent("con").items.items.length;k++){var f=o.getComponent("con").items.items[k].element.dom.offsetLeft;if(o.getComponent("con").items.items[k+1]!=null){var a=o.getComponent("con").items.items[k+1].element.dom.offsetLeft;if(n.position.x>=f&&parseInt(n.position.x)<parseInt(a)){m=k;j=f;break}}else{m=k;j=f;break}}var l=0;for(var k=m;k<o.getComponent("con").items.items.length;k++){if(n.position.x+$(document).width()>=parseFloat(o.getComponent("con").items.items[k].element.dom.offsetLeft)){l=k}}for(var k=0;k<o.getComponent("con").items.items.length;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","gray")}}for(var k=m;k<=l;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","white")}}var q=o.contentArea.getItems().items;for(var k=m;k<=l;k++){var c=q[k].items.items[0].items.items;for(var p=0;p<c.length;p++){if((n.position.x-350<=c[p].element.dom.offsetLeft&&n.position.x+$(document).width()>=c[p].element.dom.offsetLeft)||c[p].element.dom.offsetLeft==0){if(c[p].loadImage!=null){c[p].loadImage();if(Ext.browser.is.Firefox){o.getComponent("con").getScrollable().getScroller().maxPosition.x=$(o.getComponent("con").element.dom).find(".x-scroll-scroller").width()-$(o.getComponent("con").element.dom).width()+20}}}}}}else{m=0;var l=0;for(var k=m;k<o.getComponent("con").items.items.length;k++){if(n.position.x+$(document).width()>=parseFloat(o.getComponent("con").items.items[k].element.dom.offsetLeft)){l=k}}for(var k=0;k<o.getComponent("con").items.items.length;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","gray")}}for(var k=m;k<=l;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","white")}}}}else{if(o.mode=="pages"){if(n.position.x>0){var m=0;var g=[];for(var k=0;k<o.sectionArea.getItems().length;k++){var h=o.getComponent("con").items.items[0].items.items[o.sections[k].page-1];if(h!=null){g[k]=h.element.dom.offsetLeft}}for(var k=0;k<=g.length;k++){if(g[k+1]!=null){if(parseInt(n.position.x)>=parseInt(g[k])&&parseInt(n.position.x)<parseInt(g[k+1])){m=k;break}}else{m=k;break}}var l=0;for(var k=m;k<g.length;k++){if(n.position.x+$(document).width()>=parseFloat(g[k])){l=k}}o.setActiveSections(m,l);var b=o.contentArea.getItems().items[0].innerItems;for(var k=0;k<b.length;k++){if((n.position.x<=b[k].element.dom.offsetLeft&&n.position.x+$(document).width()>=b[k].element.dom.offsetLeft)||b[k].element.dom.offsetLeft==0){if(b[k].loadImage!=null){b[k].loadImage();if(Ext.browser.is.Firefox){o.getComponent("con").getScrollable().getScroller().maxPosition.x=$(o.getComponent("con").element.dom).find(".x-scroll-scroller").width()-$(o.getComponent("con").element.dom).width()+20}}}}}else{m=0;var l=0;var g=[];for(var k=0;k<o.sections.length;k++){var h=o.getComponent("con").items.items[0].items.items[o.sections[k].page];if(h!=null){g[k]=h.element.dom.offsetLeft}}for(var k=m;k<g.length;k++){if(n.position.x+$(document).width()>=parseFloat(g[k]-150)){l=k}}for(var k=0;k<o.sectionArea.items.items.length;k++){var d=o.sectionArea.items.items[k];$(d.element.dom).css("color","gray")}for(var k=m;k<=l;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","white")}}}}}},articleTabTap:function(m){var l=this;if(m!=null){m.stopPropagation()}if(l.display=="pages"||l.display=="supplements"||l.mode=="start"||l.mode=="toggle"){l.getComponent("con").removeAll();l.loadContainer()}var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.dynamic!=null){var f=80;l.expandBtn.show()}else{var f=40;l.expandBtn.hide()}l.sectionArea.setWidth($(document).width()-f);l.display="articles";l.getComponent("con").getScrollable().getScroller().scrollTo(1);l.checkSections();var j=0;var h=0;for(var g=j;g<l.getComponent("con").items.items.length;g++){if($(document).width()>=parseFloat(l.getComponent("con").items.items[g].element.dom.offsetLeft)){h=g}}if(l.sections>0){for(var g=0;g<l.getComponent("con").items.items.length;g++){var b=l.sectionArea.items.items[g];$(b.element.dom).css("color","gray")}for(var g=j;g<=h;g++){var b=l.sectionArea.items.items[g];if(b!=null){$(b.element.dom).css("color","white")}}}var o=l.contentArea.getItems().items;for(var g=j;g<=h;g++){if(o[g]!=null){var a=o[g].items.items[0].items.items;if(a!=null){for(var n=0;n<a.length;n++){if((0<=a[n].element.dom.offsetLeft&&$(document).width()>=a[n].element.dom.offsetLeft)||a[n].element.dom.offsetLeft==0){if(a[n].loadImage!=null){a[n].loadImage();if(Ext.browser.is.Firefox){l.getComponent("con").getScrollable().getScroller().maxPosition.x=$(l.getComponent("con").element.dom).find(".x-scroll-scroller").width()-$(l.getComponent("con").element.dom).width()+20}}}}}}}if(l.mode=="toggle"||l.mode=="start"){try{switch(l.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toggleToArticle { 0%{ -webkit-transform:translate3d(0px, 400px, 0px); } 100%{ -webkit-transform:translate3d(0px, 0px, 0px); } }",0);l.element.dom.style.webkitAnimation="toggleToArticle 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes toggleToArticle { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);l.element.dom.style.animation="toggleToArticle 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toggleToArticle { 0%{ -ms-transform:translate3d(0px, 400px, 0px); } 100%{ -ms-transform:translate3d(0px, 0px, 0px); } }",0);l.element.dom.style.msAnimation="toggleToArticle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes toggleToArticle { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);l.element.dom.style.animation="toggleToArticle 0.5s forwards";break}l.mode="articles";try{$(l.articleTabText.dom).attr("class","pageArticleTab");$(l.pagesTabText.dom).attr("class","")}catch(d){}if(currentProfile=="desktop"){window.onkeydown=null}l.setModal({style:"opacity:0;"});l.setHideOnMaskTap(true)}catch(k){}l.handlePresence()}else{if(l.mode=="pages"){try{l.mode="articles";switch(l.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToArticle { 0%{ -webkit-transform:translate3d(0px, 160px, 0px); } 100%{ -webkit-transform:translate3d(0px, 0px, 0px); } }",0);l.element.dom.style.webkitAnimation="pagesToArticle 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes pagesToArticle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);l.element.dom.style.animation="pagesToArticle 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToArticle { 0%{ -ms-transform:translate3d(0px, 160px, 0px); } 100%{ -ms-transform:translate3d(0px, 0px, 0px); } }",0);l.element.dom.style.msAnimation="pagesToArticle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToArticle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);l.element.dom.style.animation="pagesToArticle 0.5s forwards"}try{$(l.articleTabText.dom).attr("class","pageArticleTab");$(l.pagesTabText.dom).attr("class","")}catch(d){}if(currentProfile=="desktop"){window.onkeydown=null}l.setModal({style:"opacity:0;"});l.setHideOnMaskTap(true)}catch(k){}l.handlePresence()}else{if(l.mode=="articles"){try{switch(l.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articleToToggle { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);l.element.dom.style.webkitAnimation="articleToToggle 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);l.element.dom.style.animation="articleToToggle 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articleToToggle { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);l.element.dom.style.msAnimation="articleToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);l.element.dom.style.animation="articleToToggle 0.5s forwards";break}l.mode="toggle";try{$(l.articleTabText.dom).attr("class","");$(l.pagesTabText.dom).attr("class","")}catch(d){}l.setHideOnMaskTap(false);l.setModal(false);if(currentProfile=="desktop"){if(l.keyDownFunc!=null){window.onkeydown=l.keyDownFunc}}}catch(k){}l.handleAbsence()}}}l.loadSectionsBtns()},pagesTabTap:function(n){var m=this;if(n!=null){n.stopPropagation()}if(m.display=="articles"||m.display=="supplements"){m.getComponent("con").removeAll();var a=Ext.create("InfinityMobile.view.ReaderPages",{articlesContainer:m});m.getComponent("con").add(a);m.getComponent("con").setScrollable({direction:"horizontal"});m.getComponent("con").setPadding(10,10,10,10);a.element.on({painte},scope:a})}m.expandBtn.hide();var g=(m.pagesHeight);m.sectionArea.setWidth($(document).width()-40);m.display="pages";m.checkSections();index=0;var j=0;var c=[];for(var h=0;h<m.sections.length;h++){var f=m.getComponent("con").items.items[0].items.items[m.sections[h].page];if(f!=null){c[h]=f.element.dom.offsetLeft}}for(var h=index;h<c.length;h++){if($(document).width()>=parseFloat(c[h]-150)){j=h}}if(m.sections>0){for(var h=0;h<m.sectionArea.items.items.length;h++){var b=m.sectionArea.items.items[h];$(b.element.dom).css("color","gray")}for(var h=index;h<=j;h++){var b=m.sectionArea.items.items[h];if(b!=null){$(b.element.dom).css("color","white")}}}setTimeout(function(){var e=m.contentArea.getItems().items[0].innerItems;for(var o=0;o<e.length;o++){if((0<=e[o].element.dom.offsetLeft&&$(document).width()>=e[o].element.dom.offsetLeft)){e[o].loadImage();if(Ext.browser.is.Firefox){m.getComponent("con").getScrollable().getScroller().maxPosition.x=$(m.getComponent("con").element.dom).find(".x-scroll-scroller").width()-$(m.getComponent("con").element.dom).width()+20}}}},200);m.getComponent("con").getScrollable().getScroller().scrollTo(1);if(m.mode=="toggle"||m.mode=="start"){try{switch(m.getPrefix().css){case"-webkit-":try{document.styleSheets[0].insertRule("@-webkit-keyframes toggleToPages { 0%{ -webkit-transform:translate3d(0px, 400px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);m.element.dom.style.webkitAnimation="toggleToPages 0.5s forwards"}catch(l){m.element.dom.style.webkitTransform="translate3d(0px, 160px, 0px)";m.hasAnimationErrored=true;console.error("[ArticlesContainer]: Error Caught\n",l)}break;case"-moz-":document.styleSheets[0].insertRule("@keyframes toggleToPages { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);m.element.dom.style.animation="toggleToPages 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toggleToPages { 0%{ -ms-transform:translate3d(0px, 400px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);m.element.dom.style.msAnimation="toggleToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes toggleToPages { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);m.element.dom.style.animation="toggleToPages 0.5s forwards";break}m.mode="pages";try{$(m.pagesTabText.dom).attr("class","pageArticleTab");$(m.articleTabText.dom).attr("class","")}catch(d){}if(currentProfile=="desktop"){window.onkeydown=null}m.setModal({style:"opacity:0;"});m.setHideOnMaskTap(true)}catch(k){console.error("[ArticlesContainer]: Error Caught",k)}m.handlePresence()}else{if(m.mode=="articles"){try{switch(m.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articlesToPages { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);m.element.dom.style.webkitAnimation="articlesToPages 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);m.element.dom.style.animation="articlesToPages 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articlesToPages { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);m.element.dom.style.msAnimation="articlesToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);m.element.dom.style.animation="articlesToPages 0.5s forwards";break}m.mode="pages";try{$(m.pagesTabText.dom).attr("class","pageArticleTab");$(m.articleTabText.dom).attr("class","")}catch(d){}if(currentProfile=="desktop"){window.onkeydown=null}m.setModal({style:"opacity:0;"});m.setHideOnMaskTap(true)}catch(k){}m.handlePresence()}else{if(m.mode=="pages"){try{switch(m.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToToggle { 0%{ -webkit-transform:translate3d(0px, 160px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);m.element.dom.style.webkitAnimation="pagesToToggle 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);m.element.dom.style.animation="pagesToToggle 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToToggle { 0%{ -ms-transform:translate3d(0px, 160px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);m.element.dom.style.msAnimation="pagesToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);m.element.dom.style.animation="pagesToToggle 0.5s forwards";break}m.mode="toggle";try{$(m.pagesTabText.dom).attr("class","");$(m.articleTabText.dom).attr("class","")}catch(d){}m.setHideOnMaskTap(false);m.setModal(false);if(currentProfile=="desktop"){if(m.keyDownFunc!=null){window.onkeydown=m.keyDownFunc}}}catch(k){}m.handleAbsence()}else{if(m.mode=="start"){m.mode="toggle"}}}}Ext.Viewport.on("orientationchange",function(){m.fireEvent("checkActivePageInBrowser",m)});m.fireEvent("checkActivePageInBrowser",m);m.loadSectionBtnsPages()},setModalTa},hideMe:function(){var a=this;a.element.dom.style.visibility="hidden"},hide:function(){var b=this;if(b.mode!="start"&&b.mode!="toggle"){b.handleAbsence()}if(b.mode=="articles"){try{switch(b.getPrefix().css){case"-webkit-":if(b.hasAnimationErrored){b.element.dom.style.webkitTransform="translate3d(0px, 400px, 0px)"}else{document.styleSheets[0].insertRule("@-webkit-keyframes articleToToggle { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);b.element.dom.style.webkitAnimation="articleToToggle 0.5s forwards"}break;case"-moz-":document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);b.element.dom.style.animation="articleToToggle 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articleToToggle { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);b.element.dom.style.msAnimation="articleToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);b.element.dom.style.animation="articleToToggle 0.5s forwards";break}b.mode="toggle";try{$(b.articleTabText.dom).attr("class","");$(b.pagesTabText.dom).attr("class","")}catch(a){}b.setHideOnMaskTap(false);b.setModal(false);if(currentProfile=="desktop"){if(b.keyDownFunc!=null){window.onkeydown=b.keyDownFunc}}}catch(c){}}else{try{switch(b.getPrefix().css){case"-webkit-":if(b.hasAnimationErrored){b.element.dom.style.webkitTransform="translate3d(0px, 400px, 0px)"}else{document.styleSheets[0].insertRule("@-webkit-keyframes pagesToToggle { 0%{ -webkit-transform:translate3d(0px, 200px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);b.element.dom.style.webkitAnimation="pagesToToggle 0.5s forwards"}break;case"-moz-":document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 200px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);b.element.dom.style.animation="pagesToToggle 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToToggle { 0%{ -ms-transform:translate3d(0px, 200px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);b.element.dom.style.msAnimation="pagesToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 200px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);b.element.dom.style.animation="pagesToToggle 0.5s forwards";break}b.mode="toggle";try{$(b.pagesTabText.dom).attr("class","");$(b.articleTabText.dom).attr("class","")}catch(a){}b.setHideOnMaskTap(false);b.setModal(false);if(currentProfile=="desktop"){if(b.keyDownFunc!=null){window.onkeydown=b.keyDownFunc}}}catch(c){}}setTimeout(function(){b.resetFromArticlePopoverView()},500)},sectionTap:function(b,c){if(c.mode=="articles"){var d=c.getComponent("con").items.items[b.config.position+c.offset].element.dom.offsetLeft;if(d>c.getComponent("con").getScrollable().getScroller().maxPosition.x){d=c.getComponent("con").getScrollable().getScroller().maxPosition.x}c.getComponent("con").getScrollable().getScroller().scrollTo(d+1)}else{if(c.mode=="pages"){var a=c.sections[b.config.position].page;var d=c.getComponent("con").items.items[0].items.items[a-1].element.dom.offsetLeft;if(d>c.getComponent("con").getScrollable().getScroller().maxPosition.x){d=c.getComponent("con").getScrollable().getScroller().maxPosition.x+150}c.getComponent("con").getScrollable().getScroller().scrollTo(d)}}if(typeof trackReaderEvent!="undefined"){if(c.mode=="pages"){console.log(b.config.section,b.section);trackReaderEvent("sectionItemClick",{section:b.config.section.name,pageNumber:b.config.section.page})}}},resizeOb:function(){var b=this;if(b.mode=="pages"){setTimeout(function(){b.sectionArea.element.dom.style.width=($(document).width()-40)+"px"},100)}else{var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.dynamic!=null){var c=80;b.expandBtn.show()}else{var c=40;b.expandBtn.hide()}if(b.sectionArea.element!=null){b.sectionArea.element.dom.style.width=($(document).width()-c)+"px"}}},expand:function(b){var a=this;b.stopPropagation();a.fireEvent("expandArticles")},disableEvents:function(){var a=this;a.element.dom.style.pointerEvents="none"},enableEvents:function(){var a=this;a.element.dom.style.pointerEvents=""},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},supplementsTabTap:function(d){var c=this;if(d!=null){d.stopPropagation()}if(c.display!="supplements"){c.getComponent("con").removeAll();if(c.scrollType=="senchaScroller"){c.getComponent("con").setScrollable({direction:"horizontal"})}else{c.contentArea.setHeight(210)}c.loadSupplements();c.getComponent("con").setPadding(10,10,10,10)}c.expandBtn.hide();c.sectionArea.removeAll();c.display="supplements";c.checkSections();c.getComponent("con").getScrollable().getScroller().scrollTo(1);if(c.mode=="toggle"||c.mode=="start"){try{switch(c.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toggleToPages { 0%{ -webkit-transform:translate3d(0px, 400px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.webkitAnimation="toggleToPages 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes toggleToPages { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.animation="toggleToPages 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toggleToPages { 0%{ -ms-transform:translate3d(0px, 400px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.msAnimation="toggleToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes toggleToPages { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.animation="toggleToPages 0.5s forwards";break}c.mode="supplements";try{$(c.pagesTabText.dom).attr("class","pageArticleTab");$(c.articleTabText.dom).attr("class","")}catch(b){}if(currentProfile=="desktop"){window.onkeydown=null}c.setModal({style:"opacity:0;"});c.setHideOnMaskTap(true)}catch(f){}c.handlePresence()}else{if(c.mode=="articles"){try{switch(c.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articlesToPages { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.webkitAnimation="articlesToPages 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.animation="articlesToPages 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articlesToPages { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.msAnimation="articlesToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.animation="articlesToPages 0.5s forwards";break}c.mode="supplements";try{$(c.pagesTabText.dom).attr("class","pageArticleTab");$(c.articleTabText.dom).attr("class","")}catch(b){}if(currentProfile=="desktop"){window.onkeydown=null}c.setModal({style:"opacity:0;"});c.setHideOnMaskTap(true)}catch(f){}c.handlePresence()}else{if(c.mode=="supplements"){try{switch(c.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToToggle { 0%{ -webkit-transform:translate3d(0px, 160px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);c.element.dom.style.webkitAnimation="pagesToToggle 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);c.element.dom.style.animation="pagesToToggle 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToToggle { 0%{ -ms-transform:translate3d(0px, 160px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);c.element.dom.style.msAnimation="pagesToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);c.element.dom.style.animation="pagesToToggle 0.5s forwards";break}c.mode="toggle";try{$(c.pagesTabText.dom).attr("class","");$(c.articleTabText.dom).attr("class","")}catch(b){}c.setHideOnMaskTap(false);c.setModal(false);if(currentProfile=="desktop"){if(c.keyDownFunc!=null){window.onkeydown=c.keyDownFunc}}}catch(f){}handleAbsence()}else{if(c.mode=="pages"){try{switch(c.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articlesToPages { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.webkitAnimation="articlesToPages 0.5s forwards";break;case"-moz-":document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.animation="articlesToPages 0.5s forwards";break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articlesToPages { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.msAnimation="articlesToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);c.element.dom.style.animation="articlesToPages 0.5s forwards";break}c.mode="supplements";try{$(c.pagesTabText.dom).attr("class","pageArticleTab");$(c.articleTabText.dom).attr("class","")}catch(b){}if(currentProfile=="desktop"){window.onkeydown=null}c.setModal({style:"opacity:0;"});c.setHideOnMaskTap(true)}catch(a){}c.handlePresence()}else{if(c.mode=="start"){c.mode="toggle"}}}}}},loadSupplements:function(){var d=this;var b=d.getComponent("con");if(settings.menu.supplements!=null){var e=settings.menu.supplements.supplement;if(e!=null){for(var c in e){var a=Ext.create("InfinityMobile.view.ReaderSpecialSupplementsItem",{publicationGuid:e[c].guid,publicationName:e[c].name,editionGuid:e[c].editionGuid,width:140,margin:"0px 5px",style:"max-height: 190px;overflow: visible;"});a.editionLabel.setTop(130);a.editionLabel.setBottom();b.add(a)}}}},handlePresence:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE);if(currentProfile!="desktop"){mainPanel.fireEvent(InfinityMobile.controller.LayoutController.SUBVIEW.TOOLBAR_ICON.EVENT.TOGGLE,InfinityMobile.controller.LayoutController.SUBVIEW.TOOLBAR_ICON.PAGES_BROWSER.ITEM_ID,InfinityMobile.controller.LayoutController.SUBVIEW.TOOLBAR_ICON.STATE.ACTIVE)}},handleAbsence:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);if(currentProfile!="desktop"){mainPanel.fireEvent(InfinityMobile.controller.LayoutController.SUBVIEW.TOOLBAR_ICON.EVENT.TOGGLE,InfinityMobile.controller.LayoutController.SUBVIEW.TOOLBAR_ICON.PAGES_BROWSER.ITEM_ID,InfinityMobile.controller.LayoutController.SUBVIEW.TOOLBAR_ICON.STATE.INACTIVE)}},prepForArticlePopoverView:function(){var a=this;a.setModal({style:"opacity:0;z-index: 10000000;"});a.setZIndex(10000001)},resetFromArticlePopoverView:function(){var a=this;a.setModal(false);a.setZIndex(100000)}},0,["articlescontainer"],["component","container","articlescontainer"],{component:true,container:true,articlescontainer:true},["widget.articlescontainer"],0,[InfinityMobile.view.tablet,"ArticlesContainer"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticlesContainer",Ext.Container,{config:{width:"100%",height:"250px",bottom:0,modal:{style:"opacity:0;"},hideOnMaskTap:true,layout:"hbox",scrollable:{direction:"horizontal"}},initializ},loadContaine},onScrol}},0,["articlescontainer"],["component","container","articlescontainer"],{component:true,container:true,articlescontainer:true},["widget.articlescontainer"],0,[InfinityMobile.view.phone,"ArticlesContainer"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.SplashScreen",Ext.Panel,{config:{id:"splashscreen",layout:{type:"vbox",align:"center",pack:"middle"},width:"100%",height:"100%",style:"background-color:#1e1e1e;",items:[{style:"text-align:center",html:'<img src="resources/images/tablet-loading-logo.png" style="max-width:75%" />'},{style:"text-align:center",html:'<div style="background-image:url(resources/images/loading.gif); background-repeat:no-repeat; background-size:contain"><img src="resources/images/loading-graphic.png" style="height:60px; margin:5px 10px 5px 15px" /></div>'}]}},0,["splashscreen"],["component","container","panel","splashscreen"],{component:true,container:true,panel:true,splashscreen:true},["widget.splashscreen"],0,[InfinityMobile.view.tablet,"SplashScreen"],0));(Ext.cmd.derive("InfinityMobile.view.phone.SplashScreen",Ext.Panel,{config:{id:"splashscreen",layout:{type:"vbox",align:"center",pack:"middle"},width:"100%",height:"100%",style:"background-color:#1e1e1e;",items:[{style:"text-align:center",html:'<img src="resources/images/mobile-loading-logo.png" style="max-width:75%" />'},{style:"text-align:center",html:'<div style="background-image:url(resources/images/loading.gif); background-repeat:no-repeat; background-size:contain"><img src="resources/images/loading-graphic.png" style="height:40px; margin:5px 10px 5px 13px" /></div>'}]}},0,["splashscreen"],["component","container","panel","splashscreen"],{component:true,container:true,panel:true,splashscreen:true},["widget.splashscreen"],0,[InfinityMobile.view.phone,"SplashScreen"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderHelper",Ext.Container,{config:{width:"100%",height:"100%",top:0,left:0,layout:"vbox",items:[{height:40,itemId:"helperPadding"},{itemId:"container",style:"background-color:rgba(0, 0, 0, 0.7)",flex:1,cls:"backgroundImage fillwidth",layout:{type:"vbox",align:"center"},items:[{itemId:"continueButton",cls:"helpertabletButton",width:"100%",style:"text-align:center"}]}]},initialize:function(){var a=this;a.container=a.getComponent("container");a.continueButton=a.container.getComponent("continueButton");a.helperPadding=a.getComponent("helperPadding");a.setImages();a.setPadding();a.continueListener();mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},setImages:function(){var c=this;var d="http://html5.pagesuite.com/desktop/stage/resources/images/helper-portrait-overlay-tablet.png";var a="http://html5.pagesuite.com/desktop/stage/resources/images/helper-landscape-overlay-tablet.png";if(settings.reader.helperScreen!=null){if(settings.reader.helperScreen.portrait!=null){d=settings.reader.helperScreen.portrait}if(settings.reader.helperScreen.landscape!=null){a=settings.reader.helperScreen.landscape}}var e=Ext.getStore("ArticleStore");if(e!=null&&e.data!=null&&e.data.items[0]!=null&&e.data.items[0].raw!=null&&settings.newsday!=null){var b=e.data.items[0].raw.articles;if(b!=null&&b.length==0){d="resources/images/branding/helper-portrait-overlay-tablet-2-no-article.png";a="resources/images/branding/helper-landscape-overlay-tablet-white-no-article.png"}}c.container.setHtml("<img class='portraitOnly' src='"+d+"' style='width:100%' /><img class='landscapeOnly' src='"+a+"' style='width:100%' />")},continueListener:function(){var d=this;var e=true;var c=Ext.getStore("ArticleStore");if(settings.newsday!=null){if(settings.newsday.articleHelper=="true"&&(c!=null&&c.data.items[0].raw.articles.length>0)){e=false;d.continueButton.setHeight(35);d.continueButton.setStyle({textAlign:"center"});d.continueButton.setLayout({type:"hbox",pack:"center",align:"middle"});var f=Ext.create("Ext.Container",{html:"Next >"});var b=Ext.create("Ext.Container",{width:200,height:"100%",style:"background-color:#4591b8; color: white;",layout:{type:"hbox",pack:"center",align:"middle"}});b.add(f);d.continueButton.add(b);d.continueButton.element.on("tap",function(){d.fireEvent("articleHelper",d)})}}if(e){var a="resources/images/mobile-btn2.png";if(settings.reader.helperScreen!=null&&settings.reader.helperScreen.continueBtn!=null){a=settings.reader.helperScreen.continueBtn}d.continueButton.setHtml("<img id='continuehelper' src='"+a+"' style='width:200px' />");d.continueButton.element.on("tap",function(){d.fireEvent("close",d)});if(Ext.browser.is.Firefox){d.continueButton.setLeft(0)}}},setPadding:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){var d=Ext.Viewport.query("readerbannerad");if(d.length>0){var c=d[0].getHeight();var b=c+40;a.helperPadding.setHeight(b);a.continueButton.setTop("calc(65% + "+c+"px)")}}},destroy:function(){var a=this;mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);Ext.Container.prototype.destroy.apply(this,arguments)}},0,["readerhelper"],["component","container","readerhelper"],{component:true,container:true,readerhelper:true},["widget.readerhelper"],0,[InfinityMobile.view.tablet,"ReaderHelper"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderHelper",Ext.Container,{config:{width:"100%",height:"100%",top:0,left:0,layout:"vbox",items:[{height:40,itemId:"helperPadding"},{itemId:"container",style:"background-color:rgba(0, 0, 0, 0.7)",flex:1,scrollable:{direction:"vertical",directionLock:true},items:[{itemId:"nextButton",cls:"helperphoneButton",html:"<div style='width:100%; text-align:center'><img id='nexthelper' src='resources/images/mobile-btn1.png' style='width:120px;' /></div>"},{itemId:"continueButton",cls:"helperphoneButton",hidden:true,html:"<div style='width:100%; text-align:center'><img id='continuehelper' src='resources/images/mobile-btn2.png' style='width:120px;' /></div>"}]}]},initialize:function(){var a=this;a.container=a.getComponent("container");a.nextButton=a.container.getComponent("nextButton");a.continueButton=a.container.getComponent("continueButton");a.helperPadding=a.getComponent("helperPadding");a.setImages();a.setPadding();a.nextListener();a.continueListener();mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},setImage},nextListener:function(){var b=this;if(settings.reader.helperScreen!=null&&settings.reader.helperScreen.next!=null){var a=settings.reader.helperScreen.next;b.nextButton.setHtml("<div style='width:100%; text-align:center'><img id='nexthelper' src='"+a+"' style='width:120px;' /></div>")}b.nextButton.element.on("tap",function(){b.fireEvent("next",b)})},continueListener:function(){var c=this;var d=true;var b=Ext.getStore("ArticleStore");if(settings.newsday!=null){if(settings.newsday.articleHelper=="true"&&(b!=null&&b.data.items[0].raw.articles.length>0)){d=false;c.continueButton.setHtml("<div style='width:100%; text-align:center'><img src='resources/images/mobile-btn1.png' style='width:150px;' /></div>");c.continueButton.element.on("tap",function(){c.fireEvent("articleHelper",c)})}}if(d){var a="resources/images/mobile-btn2.png";if(settings.reader.helperScreen!=null&&settings.reader.helperScreen.continueBtn!=null){a=settings.reader.helperScreen.continueBtn}c.continueButton.setHtml("<div style='width:100%; text-align:center'><img id='continuehelper' src='"+a+"' style='width:150px;' /></div>");c.continueButton.element.on("tap",function(){c.fireEvent("close",c)})}},setPadding:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){var c=Ext.Viewport.query("readerbannerad");if(c.length>0){var b=c[0].getHeight()+40;a.helperPadding.setHeight(b)}}},destroy:function(){var a=this;mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);Ext.Container.prototype.destroy.apply(this,arguments)}},0,["readerhelper"],["component","container","readerhelper"],{component:true,container:true,readerhelper:true},["widget.readerhelper"],0,[InfinityMobile.view.phone,"ReaderHelper"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuTTS",Ext.Container,{config:{defaults:{width:30,height:30,margin:"0 15 0 0"},items:[{itemId:"TTSicon",status:"STOPPED",cls:"pointerCursor"}]},initialize:function(){var a=this;a.ttsicon=a.getComponent("TTSicon");if(ttsFlag.status=="PLAYING"){a.ttsicon.addCls("playing")}if(window.SpeechSynthesisUtterance===undefined||settings.tts===undefined||(typeof isTribReader!="undefined"&&isTribReader=="True")){a.hide();a.setHeight(0)}else{a.setTtsToggleListener()}if(settings.newsday!=null&&settings.newsday.menuShareItemSize!=null){a.setDefaults({width:settings.newsday.menuShareItemSize+"px",height:settings.newsday.menuShareItemSize+"px",margin:"0 15 0 0"})}if(settings.newsday!=null&&settings.newsday.useFontAwesome=="true"){a.ttsicon.setHtml('<span class="fa fa-volume-up fa-lg pointerCursor" aria-hidden="true" stlye="color:white;margin:8px;"></span>')}else{a.ttsicon.setStyle({backgroundImage:'url("resources/images/reader%20icons/speech-ic-wht2.png")',backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"})}},setTtsToggleListener:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined){a.ttsicon.element.on({tap:function(){switch(ttsFlag.status){case"STOPPED":case"FINISHED":a.fireEvent("playArticleTTS",ttsFlag,a.ttsicon);break;case"PAUSED":a.fireEvent("resumeArticleTTS",ttsFlag,a.ttsicon);break;case"PLAYING":a.fireEvent("pauseArticleTTS",ttsFlag,a.ttsicon);break;default:a.fireEvent("stopArticleTTS",ttsFlag,a.ttsicon)}mainPanel.fireEvent("close")}})}}},0,["readermenutts"],["component","container","readermenutts"],{component:true,container:true,readermenutts:true},["widget.readermenutts"],0,[InfinityMobile.view,"ReaderMenuTTS"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuShare",Ext.Container,{config:{defaults:{width:30,height:30,margin:"0 10 15 0"}},initialize:function(){var a=this;if(settings.newsday!=null){if(settings.newsday.menuShareItemSize!=null){a.setDefaults({width:settings.newsday.menuShareItemSize+"px",height:settings.newsday.menuShareItemSize+"px",margin:"0 15 15 0"})}}if(currentProfile=="phone"&&(settings.articlepopover.phoneSharingInTopBar!=null&&settings.articlepopover.phoneSharingInTopBar=="true")){a.setDefaults({width:30,height:30,margin:"0 6 15 0"})}},shareLoade}},0,["readermenushare"],["component","container","readermenushare"],{component:true,container:true,readermenushare:true},["widget.readermenushare"],0,[InfinityMobile.view,"ReaderMenuShare"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderMenuold",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px)",right:0,top:40,items:[{itemId:"menuLayout",cls:"mainMenu",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",scrollable:{direction:"vertical",directionLock:true},items:[{itemId:"menuHeader",html:"Menu",margin:0,height:40,style:"background-color:#2c2f32; color:#ffffff",padding:"10 15 10 15",items:[{itemId:"menuHeaderClose",cls:"pointerCursor",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{id:"menuEditionOptions",cls:"menuSectionHeader menuEditionOptions",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",padding:"10 15 10 15",text:"EDITION OPTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/minimise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"editionOptionsSection",cls:"menuSectionContent menuEditionOptions",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15},minimized:false,items:[{id:"menuPages",cls:"menuItem menuPages",clickType:"id",xtype:"readermenuitem",text:"Pages"},{id:"menuArchive",cls:"menuItem menuArchive",clickType:"id",xtype:"readermenuitem",text:"Archive"},{id:"menuSpecialArchive",cls:"menuItem menuSpecialArchive",clickType:"id",xtype:"readermenuitem",text:"Special Archive"},{id:"menuArticles",cls:"menuItem menuArticles",xtype:"readermenuitem",text:"Articles"},{id:"menuDynamicArticles",cls:"menuItem menuDynamicArticles",clickType:"id",xtype:"readermenuitem",text:"Advanced"},{id:"menuDownload",cls:"menuItem menuDownload",clickType:"id",xtype:"readermenuitem",text:"Download"},{id:"menuSearch",cls:"menuItem menuSearch",clickType:"id",xtype:"readermenuitem",text:"Search"},{id:"menuBookmarks",cls:"menuItem menuBookmarks",clickType:"id",xtype:"readermenuitem",text:"Bookmarks"},{id:"menuSupplementsTab",cls:"menuItem menuSupplementsTab",clickType:"id",xtype:"readermenuitem",text:"Supplements Tab"},{id:"menuCreateClipping",cls:"menuItem menuCreateClipping",clickType:"id",xtype:"readermenuitem",text:"Create Clipping"},{id:"menuPrint",cls:"menuItem menuPrint",clickType:"id",xtype:"readermenuitem",text:"Print"},{id:"menuTTS",cls:"menuItem menuSharing",xtype:"readermenutts",layout:"vbox"},{id:"menuSharing",cls:"menuItem menuSharing",xtype:"readermenushare",layout:"vbox"}]},{itemId:"sponsorEdition",style:"background-color:rgb(80, 80, 80);font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;cursor:pointer",padding:"10 15 10 15",height:40,width:"100%",items:[{html:"SPONSORED",style:"font-size:10px;",top:5,right:5}]},{id:"menuSections",cls:"menuSectionHeader menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"SECTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSectionsContainer",cls:"menuSectionContent menuSections",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuSupplements",cls:"menuSectionHeader menuSupplements",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"SUPPLEMENTS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSupplementsContainer",cls:"menuSectionContent menuSupplements",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuZones",cls:"menuSectionHeader menuZones",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"ZONES",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuZonesContainer",cls:"menuSectionContent menuZones",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuQuickLinks",cls:"menuSectionHeader menuQuickLinks",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"QUICK LINKS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuQuickLinksContainer",cls:"menuSectionContent menuQuickLinks",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuInfo",cls:"menuSectionHeader menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"INFO",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuInfoContainer",cls:"menuSectionContent menuInfo",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuHowToUse",xtype:"readermenuitem",cls:"menuItem menuHowToUse",clickType:"id",text:"How to use"},{id:"menuHelp",xtype:"readermenuitem",cls:"menuItem menuHelp",clickType:"id",text:"Contact Us"},{id:"menuTerms",cls:"menuItem menuTerms",clickType:"id",xtype:"readermenuitem",text:"Terms and Conditions"},{id:"menuFaq",cls:"menuItem menuFaq",clcikType:"id",xtype:"readermenuitem",text:"FAQ"},{id:"menuStoryPref",cls:"menuItem menuStoryPref",clickType:"id",xtype:"readermenuitem",text:"Story Window Preferences"}]},{id:"menuUserOp",cls:"menuSectionHeader menuUserOp",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"USER OPTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuUserContainer",cls:"menuSectionContent menuUserOp",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuAccount",xtype:"readermenuitem",cls:"menuItem menuAccount",clickType:"id",text:"My Account"},{id:"menuUser",xtype:"readermenuitem",cls:"menuItem menuUser",clickType:"id",text:"Logout"}]},{itemId:"sponsorInfo",style:"background-color:rgb(80, 80, 80);font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;cursor:pointer ",padding:"10 15 10 15",height:40,width:"100%",items:[{html:"SPONSORED",style:"font-size:10px;",top:5,right:5}]}]}]},initialize:function(){var c=this;var a=Ext.getStore("SettingStore");if(c.config.direction!=null){c.direction=c.config.direction}if(c.direction=="left"){c.setRight("");c.setLeft(0);c.setZIndex(999999)}c.menuLayout=c.getComponent("menuLayout");if(settings.menu.background.length>6){var b=hexaToRgba(settings.menu.background);c.menuLayout.setStyle("background-color: rgba("+b+")")}else{c.menuLayout.setStyle("background-color:#"+settings.menu.background+";")}c.menuLayout.getComponent("editionOptionsSection").getComponent("menuDynamicArticles").hide();c.menuHeader=c.menuLayout.getComponent("menuHeader");c.menuHeaderClose=c.menuHeader.getComponent("menuHeaderClose");c.checkArchive();c.checkDownload();c.checkClipping();c.checkPrint();c.checkBookmarks();c.checkHowToUse();c.checkHelp();c.checkLogout();c.checkTerms();c.checkSearch();c.checkPagesContainer();c.checkArticlesContainer();c.checkMenuHeader();c.checkStoryWindowPrefs();c.checkFaq();c.checkSpecialArchive();c.checkSupplementsTab();c.sharingContainer=c.menuLayout.getComponent("editionOptionsSection").getComponent("menuSharing");c.sectionsHeaderContainer=c.menuLayout.getComponent("menuSections");c.sectionsContainer=c.menuLayout.getComponent("menuSectionsContainer");c.supplementsHeaderContainer=c.menuLayout.getComponent("menuSupplements");c.supplementsContainer=c.menuLayout.getComponent("menuSupplementsContainer");c.zonesHeaderContainer=c.menuLayout.getComponent("menuZones");c.zonesContainer=c.menuLayout.getComponent("menuZonesContainer");c.quickLinksHeaderContainer=c.menuLayout.getComponent("menuQuickLinks");c.quickLinksContainer=c.menuLayout.getComponent("menuQuickLinksContainer");c.sponsorEdition=c.menuLayout.getComponent("sponsorEdition");c.sponsorInfo=c.menuLayout.getComponent("sponsorInfo");c.sponsorSetup();c.loadShare();c.loadSections();c.loadSupplements();c.loadZones();c.loadQuickLinks();c.setupMouseListener();c.setupHeaders();c.fireEvent("disableArticlesContainer")},checkSupplementsTab:function(){var a=this;a.supplementsTab=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSupplementsTab");if(currentProfile=="desktop"){a.supplementsTab.hide()}else{if(settings.menu.supplements==null||settings.menu.supplements.showSupplementsTab!="true"||settings.menu.supplements.supplement.length==0){a.supplementsTab.hide()}}},checkSpecialArchive:function(){var a=this;a.specialArchive=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSpecialArchive");if(typeof specialArchive==="undefined"||specialArchive==null||specialArchive.length==0){a.specialArchive.hide()}},setupMouseListener:function(){var b=this;if(currentProfile=="desktop"){b.scroller=b.menuLayout.getScrollable().getScroller();var a=function(f){var e=b.scroller.maxPosition;var h=b.scroller.minPosition;var c=b.scroller.position;var g=30;if(f=="up"){var d=c.y-g;if(d>h.y){b.scroller.scrollTo(0,d)}else{if(d<=h.y){b.scroller.scrollTo(0,h.y)}}}else{if(f=="down"){var d=c.y+g;if(d<e.y){b.scroller.scrollTo(0,d)}else{if(d>=e.y){b.scroller.scrollTo(0,e.y)}}}}};b.element.dom.onmousewheel=function(c){var d="down";if(c.deltaY<0||c.wheelDelta>0){d="up"}a(d)};b.element.dom.addEventListener("DOMMouseScroll",function(c){var d="down";if(c.detail<0){d="up"}a(d)})}},checkFaq:function(){var a=this;a.menuFaq=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuFaq");if(settings.menu.enableFaq==null||settings.menu.enableFaq=="false"){a.menuFaq.hide()}},checkStoryWindowPrefs:function(){var b=this;b.menuStoryPref=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuStoryPref");var a=Ext.getStore("ArticleStore");if(settings.newsday==null||(a==null||a.data.items[0].raw.articles.length<=0)){b.menuStoryPref.hide()}},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){a.fireEvent("close")})},checkMenuHeader:function(){var a=this;if(settings.newsday!=null){a.setTop(0);a.setStyle({height:"100%"});a.setCloseListener()}else{a.menuHeader.hide()}},checkPagesContaine},checkArticlesContaine},checkSearc},setupHeaders:function(){var b=this;b.editionOptionsHeaderContainer=b.menuLayout.getComponent("menuEditionOptions");var c=language.menu.editionOptions.toUpperCase();b.editionOptionsHeaderContainer.setHtml(c);b.editionOptionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.editionOptionsHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("editionOptionsSection"),b.editionOptionsHeaderContainer)},scope:b});if(!b.menuLayout.getComponent("editionOptionsSection").config.minimized){b.calculateSectionHeight(b.menuLayout.getComponent("editionOptionsSection"))}b.sectionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.sectionsHeaderContainer.element.on({tap:function(){b.headerTap(b.sectionsContainer,b.sectionsHeaderContainer)},scope:b});b.supplementsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.supplementsHeaderContainer.element.on({tap:function(){b.headerTap(b.supplementsContainer,b.supplementsHeaderContainer)},scope:b});b.zonesHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.zonesHeaderContainer.element.on({tap:function(){b.headerTap(b.zonesContainer,b.zonesHeaderContainer)},scope:b});b.quickLinksHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.quickLinksHeaderContainer.element.on({tap:function(){b.headerTap(b.quickLinksContainer,b.quickLinksHeaderContainer)},scope:b});b.menuInfoHeaderContainer=b.menuLayout.getComponent("menuInfo");var a=language.menu.info.toUpperCase();b.menuInfoHeaderContainer.setHtml(a);b.menuInfoHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.menuInfoHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuInfoContainer"),b.menuLayout.getComponent("menuInfo"))},scope:b});b.menuUserHeaderContainer=b.menuLayout.getComponent("menuUserOp");b.menuUserHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.menuUserHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuUserContainer"),b.menuLayout.getComponent("menuUserOp"))},scope:b});if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){if(b.editionOptionsHeaderContainer!=null){b.editionOptionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.editionOptionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}if(b.sectionsHeaderContainer!=null){b.sectionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.sectionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.supplementsHeaderContainer!=null){b.supplementsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.supplementsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.zonesHeaderContainer!=null){b.zonesHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.zonesHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.quickLinksHeaderContainer!=null){b.quickLinksHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.quickLinksHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuInfoHeaderContainer!=null){b.menuInfoHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuInfoHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuUserHeaderContainer!=null){b.menuUserHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuUserHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}}},calculateSectionHeight:function(d){var b=this;for(var a=0;a<d.items.items.length;a++){var c=d.items.items[a];if(!c.getHidden()){height+=parseFloat($(c.element.dom).height())}}d.element.dom.style.maxHeight=height+"px"},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},headerTap:function(f,g){var d=this;if(f.config.minimized){var b=0;f.setDefaults({padding:"15px 0px 15px 0px"});for(var c=0;c<f.items.items.length;c++){var e=f.items.items[c];if(!e.getHidden()){b+=parseFloat($(e.element.dom).height())}}f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.element.dom.style.maxHeight=b+"px";setTimeout(function(){var h=d.menuLayout.getScrollable().getScroller();var k=g.element.dom;var j=h.maxPosition.y,l=(k.offsetTop>j)?j:k.offsetTop;h.scrollTo(0,l,true)},420);var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/minimise-menu-option.png')"}f.config.minimized=false;mainPanel.fireEvent("trackMenuHeader",f,g)}else{f.setDefaults({padding:"0px 0px 0px 0px"});f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.setStyle({maxHeight:"0px"});var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/maximise-menu-option.png')"}f.config.minimized=true;mainPanel.fireEvent("trackMenuHeader",f,g)}},checkPages:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPages");if(settings.menu.hidePages!=null){if(settings.menu.hidePages){a.hide()}}else{if(settings.menu.pagesText!=null){}}},checkArchive:function(){var d=this;var b=d.menuLayout.getComponent("editionOptionsSection").getComponent("menuArchive");if(settings.menu.hideArchive!=null){if(settings.menu.hideArchive){b.hide()}}else{if(settings.menu.archiveText!=null){var a=Ext.getStore("ArchiveStore");var c=[];if(a.data.items[0]!=null){if(a.data.items[0].raw.editions!=null){c=a.data.items[0].raw.editions.edition;if(c.length==0){b.hide()}}}}}},checkDownload:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuDownload");if(settings.menu.hideDownload!=null){if(settings.menu.hideDownload){a.hide()}}else{if(settings.menu.downloadText!=null){}}},checkClipping:function(){var a=this;var b=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuCreateClipping");if(settings.menu.hideClipping!=null){b.hide()}else{}},checkArticles:function(){var c=this;var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.hideArticleBtn!=null){c.menuLayout.getComponent("editionOptionsSection").getComponent("menuArticles").hide()}else{var a=InfinityMobile.app.getController("ArticleController").getArticles();if(a==null||a.length==0){c.menuLayout.getComponent("editionOptionsSection").getComponent("menuArticles").hide()}}},checkPrin},checkBookmarks:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuBookmarks");if(settings.menu.hideBookmarks!=null){a.hide()}else{if(settings.menu.bookmarkText!=null){}}},checkHowToUse:function(){var b=this;var a=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuHowToUse");if(settings.menu.hideHowToUse!=null){if(settings.menu.hideHowToUse){a.hide()}}else{if(settings.menu.howToUseText!=null){}}},checkHelp:function(){var b=this;var a=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuHelp")},loadShare:function(){var a=this;a.fireEvent("loadShare",a)},loadSections:function(){var a=this;a.fireEvent("loadSections",a,a.sectionsContainer,a.sectionsHeaderContainer)},loadSupplements:function(){var a=this;a.fireEvent("loadSupplements",a,a.supplementsContainer,a.supplementsHeaderContainer)},loadZones:function(){var a=this;a.fireEvent("loadZones",a,a.zonesContainer,a.zonesHeaderContainer)},loadQuickLinks:function(){var a=this;a.fireEvent("loadQuickLinks",a,a.quickLinksContainer,a.quickLinksHeaderContainer)},checkWhatsNewBanner:function(){var c=this;var a=c.whatsNewContainer.element.down(".bannerIcon").dom;try{if(localStorage.getItem("versionwhatsnew"+version.replace(/g./g,"_"))!=null){a.style.display="none"}}catch(b){}},sponsorSetu},checkLogout:function(){var a=this;if(loggedIn.toLowerCase()!="true"){a.menuLayout.getComponent("menuUserContainer").hide();a.menuLayout.getComponent("menuUserOp").hide()}else{if(settings.menu.hideMyAccount!=null&&settings.menu.hideMyAccount=="true"){a.menuLayout.getComponent("menuUserContainer").getComponent("menuAccount").hide()}}},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments);mainPanel.fireEvent("trackMenuClose")},checkTerms:function(){var a=this;a.menuTerms=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuTerms");if(settings.menu.terms==null){a.menuTerms.hide()}},show:function(){var a=this;a.handleKeyDown();InfinityMobile.view.Overlay.prototype.show.apply(this,arguments)},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null}},0,["readermenu"],["component","container","panel","overlay","readermenu"],{component:true,container:true,panel:true,overlay:true,readermenu:true},["widget.readermenu"],0,[InfinityMobile.view.tablet,"ReaderMenuold"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderMenu",InfinityMobile.view.Overlay,{config:{width:"100%",layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:100%",right:0,top:0,height:"100%",cls:"reader-menu",items:[{itemId:"menuLayout",cls:"mainMenu",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{margin:15},scrollable:{direction:"vertical",directionLock:true},items:[{itemId:"menuHeader",cls:"menuHeader",html:"Menu",margin:0,height:40,style:"background-color:#2c2f32; color:#ffffff",padding:"10 15 10 15",items:[{itemId:"menuHeaderClose",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{id:"menuEditionOptions",cls:"menuSectionHeader menuEditionOptions",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"EDITION OPTIONS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/minimise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"editionOptionsSection",cls:"menuSectionContent menuEditionOptions",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15},minimized:false,items:[{id:"menuPages",cls:"menuItem menuPages",clickType:"id",xtype:"readermenuitem",text:"Pages"},{id:"menuArticles",cls:"menuItem menuArticles",clickType:"id",xtype:"readermenuitem",text:"Articles"},{id:"menuArchive",cls:"menuItem menuArchive",clickType:"id",xtype:"readermenuitem",text:"Archive"},{id:"menuSpecialArchive",cls:"menuItem menuSpecialArchive",clickType:"id",xtype:"readermenuitem",text:"Special Archive"},{id:"menuNewsdayFunbook",cls:"menuItem menuFunbook",clickType:"id",xtype:"readermenuitem",text:"Fun Book",hidden:true},{id:"menuDownload",cls:"menuItem menuDownload",clickType:"id",xtype:"readermenuitem",text:"Download"},{id:"menuSearch",cls:"menuItem menuSearch",clickType:"id",xtype:"readermenuitem",text:"Search"},{id:"menuBookmarks",cls:"menuItem menuBookmarks",clickType:"id",xtype:"readermenuitem",text:"Bookmarks"},{id:"menuSupplementsTab",cls:"menuItem menuSupplementsTab",clickType:"id",xtype:"readermenuitem",text:"Supplements Tab"},{id:"menuCreateClipping",cls:"menuItem menuCreateClipping",clickType:"id",xtype:"readermenuitem",text:"Create Clipping"},{id:"menuPrint",xtype:"readermenuitem",text:"Print"},{id:"menuPuzzles",cls:"menuItem",clickType:"id",xtype:"readermenuitem",text:"Puzzles"},{id:"menuTTS",cls:"menuItem menuSharing",xtype:"readermenutts",layout:"vbox"},{id:"menuSharing",cls:"menuItem menuSharing",margin:0,xtype:"readermenushare"}]},{id:"sponsorEdition",style:"background-color:rgb(80, 80, 80);font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;cursor:pointer",margin:0,padding:"10 15 10 15",height:40,width:"100%",items:[{html:"SPONSORED",style:"font-size:10px;",top:5,right:5}]},{id:"menuSections",cls:"menuSectionHeader menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"SECTIONS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSectionsContainer",cls:"menuSectionContent menuSections",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuSupplements",cls:"menuSectionHeader menuSupplements",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"SUPPLEMENTS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSupplementsContainer",cls:"menuSectionContent menuSupplements",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuZones",cls:"menuSectionHeader menuZones",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",margin:"0 0 0 0",padding:"10 15 10 15",text:"ZONES",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuZonesContainer",cls:"menuSectionContent menuZones",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuQuickLinks",cls:"menuSectionHeader menuQuickLinks",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"QUICK LINKS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuQuickLinksContainer",cls:"menuSectionContent menuQuickLinks",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuInfo",cls:"menuSectionHeader menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"INFO",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuInfoContainer",cls:"menuSectionContent menuInfo",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuHowToUse",xtype:"readermenuitem",cls:"menuItem menuHowToUse",text:"How to use"},{id:"menuHelp",xtype:"readermenuitem",cls:"menuItem menuHelp",text:"Contact Us"},{id:"menuTerms",xtype:"readermenuitem",cls:"menuItem menuTerms",text:"Terms and Conditions"},{id:"menuFaq",cls:"menuItem menuFaq",clickType:"id",xtype:"readermenuitem",text:"FAQ"},{id:"menuPrivacy",cls:"menuItem menuPrivacy",clickType:"id",xtype:"readermenuitem",text:"Privacy Policy"},{id:"menuStoryPref",cls:"menuItem menuStoryPref",clickType:"id",xtype:"readermenuitem",text:"Story Window Preferences"}]},{id:"menuUserOp",cls:"menuSectionHeader menuUserOp",xtype:"readermenuitem",margin:0,style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"USER OPTIONS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuUserContainer",cls:"menuSectionContent menuUserOp",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuAccount",xtype:"readermenuitem",text:"My Account"},{id:"menuUser",xtype:"readermenuitem",text:"Logout"}]},{id:"sponsorInfo",style:"background-color:rgb(80, 80, 80);font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;cursor:pointer ",padding:"10 15 10 15",margin:0,height:40,width:"100%",items:[{html:"SPONSORED",style:"font-size:10px;",top:5,right:5}]},{cls:"opt-cookie-settings-menu",itemId:"oneTrustCookieSettings",html:"Cookie Settings",margin:0,padding:15,height:46}]}]},initialize:function(){var c=this;c.menuLayout=c.getComponent("menuLayout");if(settings.menu.background.length>6){var b=hexaToRgba(settings.menu.background);c.menuLayout.setStyle("background-color: rgba("+b+")")}else{c.menuLayout.setStyle("background-color:#"+settings.menu.background+";")}var d=c.menuLayout.getComponent("menuHeader");d.setStyle("background-color:#"+settings.menu.headerBackground+";color:#"+settings.menu.headerTextColor);d.setHtml(language.menu.menu);c.menuHeaderClose=d.getComponent("menuHeaderClose");c.setupMenuHeaderClose();var a=Ext.getStore("SettingStore");c.setCloseListener();c.menuEditionOptionsSection=c.menuLayout.getComponent("editionOptionsSection");c.oneTrustCookieSettings=c.menuLayout.getComponent("oneTrustCookieSettings");c.checkPages();c.checkArchive();c.checkDownload();c.checkClipping();c.checkArticles();c.checkPrint();c.checkBookmarks();c.checkHowToUse();c.checkHelp();c.checkLogout();c.checkTerms();c.checkSearch();c.checkStoryWindowPrefs();c.checkFaq();c.checkSpecialArchive();c.checkFunBook();c.checkPrivacyPolicy();c.checkSupplementsTab();c.checkExtraArchives();c.checkOneTrustCookieSettings();c.initializePuzzlesMenu();c.sharingContainer=c.menuLayout.getComponent("editionOptionsSection").getComponent("menuSharing");c.sectionsHeaderContainer=c.menuLayout.getComponent("menuSections");c.sectionsContainer=c.menuLayout.getComponent("menuSectionsContainer");c.supplementsHeaderContainer=c.menuLayout.getComponent("menuSupplements");c.supplementsContainer=c.menuLayout.getComponent("menuSupplementsContainer");c.zonesHeaderContainer=c.menuLayout.getComponent("menuZones");c.zonesContainer=c.menuLayout.getComponent("menuZonesContainer");c.quickLinksHeaderContainer=c.menuLayout.getComponent("menuQuickLinks");c.quickLinksContainer=c.menuLayout.getComponent("menuQuickLinksContainer");c.sponsorEdition=c.menuLayout.getComponent("sponsorEdition");c.sponsorInfo=c.menuLayout.getComponent("sponsorInfo");c.sponsorSetup();c.loadShare();c.loadSections();c.loadSupplements();c.loadQuickLinks();c.loadZones();c.setupHeaders();c.handleJustifiedText()},checkOneTrustCookieSettings:function(){var b=this;if(settings.oneTrust!=null&&typeof OneTrust!="undefined"){b.oneTrustCookieSettings.setStyle("font-size:14px;color:#"+settings.menu.textColor+";cursor:pointer");try{b.oneTrustCookieSettings.element.on({scope:b,tap:function(d){if(typeof OneTrust!="undefined"){try{OneTrust.ToggleInfoDisplay()}catch(c){console.error("[ReaderMenu]: Error Caught\n",c)}}}})}catch(a){console.error("[ReaderMenu]: Error Caught\n",ex)}}else{b.oneTrustCookieSettings.hide()}},checkPrivacyPolicy:function(){var a=this;var b=a.menuLayout.getComponent("menuInfoContainer");a.menuPrivacy=b.getComponent("menuPrivacy");if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.privacyPolicyUrl!=null){a.menuPrivacy.show()}else{a.menuPrivacy.hide()}},checkSupplementsTab:function(){var a=this;a.supplementsTab=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSupplementsTab");if(currentProfile=="desktop"){a.supplementsTab.hide()}else{if(settings.menu.supplements==null||settings.menu.supplements.showSupplementsTab!="true"||settings.menu.supplements.supplement.length==0){a.supplementsTab.hide()}}},checkSpecialArchive:function(){var a=this;a.specialArchive=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSpecialArchive");if(typeof specialArchive==="undefined"||specialArchive==null||specialArchive.length==0){a.specialArchive.hide()}},checkFunBook:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuNewsdayFunbook");if(settings.newsday!=null&&settings.newsday.showFunbookInMainMenu!=null&&settings.newsday.showFunbookInMainMenu=="true"){a.setHidden(false)}},checkFaq:function(){var a=this;a.menuFaq=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuFaq");if(settings.menu.enableFaq==null||settings.menu.enableFaq=="false"){a.menuFaq.hide()}},checkStoryWindowPrefs:function(){var b=this;b.menuStoryPref=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuStoryPref");var a=Ext.getStore("ArticleStore");if(settings.newsday==null||(a==null||a.data.items[0].raw.articles.length<=0)){b.menuStoryPref.hide()}},checkSearch:function(){var a=this;a.searchBtn=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSearch");if(settings.newsday!=null){if(settings.newsday.menuSearch=="false"){a.searchBtn.hide()}}else{if(typeof EDITIONAPP==="undefined"){a.searchBtn.hide()}}},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){a.fireEvent("close");mainPanel.fireEvent("trackMenuClose")})},setupHeaders:function(){var b=this;b.editionOptionsHeaderContainer=b.menuLayout.getComponent("menuEditionOptions");var c=language.menu.editionOptions.toUpperCase();b.editionOptionsHeaderContainer.setHtml(c);b.editionOptionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.editionOptionsHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("editionOptionsSection"),b.editionOptionsHeaderContainer)},scope:b});if(!b.menuLayout.getComponent("editionOptionsSection").config.minimized){b.calculateSectionHeight(b.menuLayout.getComponent("editionOptionsSection"))}b.sectionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.sectionsHeaderContainer.element.on({tap:function(){b.headerTap(b.sectionsContainer,b.sectionsHeaderContainer)},scope:b});b.supplementsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.supplementsHeaderContainer.element.on({tap:function(){b.headerTap(b.supplementsContainer,b.supplementsHeaderContainer)},scope:b});b.zonesHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.zonesHeaderContainer.element.on({tap:function(){b.headerTap(b.zonesContainer,b.zonesHeaderContainer)},scope:b});b.quickLinksHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.quickLinksHeaderContainer.element.on({tap:function(){b.headerTap(b.quickLinksContainer,b.quickLinksHeaderContainer)},scope:b});b.menuInfoHeaderContainer=b.menuLayout.getComponent("menuInfo");var a=language.menu.info.toUpperCase();b.menuInfoHeaderContainer.setHtml(a);b.menuInfoHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.menuInfoHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuInfoContainer"),b.menuLayout.getComponent("menuInfo"))},scope:b});b.menuUserHeaderContainer=b.menuLayout.getComponent("menuUserOp");b.menuUserHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.menuUserHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuUserContainer"),b.menuLayout.getComponent("menuUserOp"))},scope:b});if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){if(b.editionOptionsHeaderContainer!=null){b.editionOptionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.editionOptionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}if(b.sectionsHeaderContainer!=null){b.sectionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.sectionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.supplementsHeaderContainer!=null){b.supplementsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.supplementsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.zonesHeaderContainer!=null){b.zonesHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.zonesHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.quickLinksHeaderContainer!=null){b.quickLinksHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.quickLinksHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuInfoHeaderContainer!=null){b.menuInfoHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuInfoHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuUserHeaderContainer!=null){b.menuUserHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuUserHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}}},calculateSectionHeight:function(d){var b=this;for(var a=0;a<d.items.items.length;a++){var c=d.items.items[a];if(!c.getHidden()){height+=parseFloat($(c.element.dom).height())}}if(Ext.browser.is.Firefox){height+=60}d.element.dom.style.maxHeight=height+"px"},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},headerTap:function(f,g){var d=this;if(f.config.minimized){var b=0;f.setDefaults({padding:"15px 0px 15px 0px"});for(var c=0;c<f.items.items.length;c++){var e=f.items.items[c];if(!e.getHidden()){b+=parseFloat($(e.element.dom).height())}}f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.element.dom.style.maxHeight=b+"px";setTimeout(function(){var h=d.menuLayout.getScrollable().getScroller();var k=g.element.dom;var j=h.maxPosition.y,l=(k.offsetTop>j)?j:k.offsetTop;h.scrollTo(0,l,true)},420);var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/minimise-menu-option.png')"}f.config.minimized=false}else{f.setDefaults({padding:"0px 0px 0px 0px"});f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.setStyle({maxHeight:"0px"});var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/maximise-menu-option.png')"}f.config.minimized=true}},checkPages:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPages");if(settings.menu.hidePages!=null){if(settings.menu.hidePages){a.hide()}}else{if(settings.menu.pagesText!=null){}}},checkArchive:function(){var d=this;var b=d.menuArchive=d.menuLayout.getComponent("editionOptionsSection").getComponent("menuArchive");if(settings.menu.hideArchive!=null){if(settings.menu.hideArchive){b.hide()}}else{if(settings.menu.archiveText!=null){var a=Ext.getStore("ArchiveStore");var c=[];if(a.data.items[0]!=null){if(a.data.items[0].raw.editions!=null&&a.data.items[0].raw.editions.edition!=null){c=a.data.items[0].raw.editions.edition;if(c.length==0){b.hide()}}}}}},checkExtraArchives:function(){var b=this;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.extraArchives!=null){var a=b.returnExtraArchivesIndex();b.fireEvent("loadExtraArchiveButtons",b,a)}},returnExtraArchivesIndex:function(){var d=this;var c=0;if(typeof settings!="undefined"){try{var a=d.menuEditionOptionsSection.getItems().items;if(settings.menu!=null&&!settings.menu.hideArchive&&d.menuArchive!=null){c=a.indexOf(d.menuArchive)+1}if(typeof specialArchive!="undefined"&&specialArchive!=null&&specialArchive.edition!=null&&specialArchive.edition.length>0&&d.specialArchive!=null){c=a.indexOf(d.specialArchive)+1}}catch(b){console.error("[ReaderMenu] \t",b)}}return c},checkDownload:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuDownload");if(settings.menu.hideDownload!=null){if(settings.menu.hideDownload){a.hide()}}else{if(settings.menu.downloadText!=null){}}},checkClipping:function(){var a=this;var b=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuCreateClipping");if(settings.menu.hideClipping!=null){b.hide()}else{}},checkArticle},checkPrint:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPrint");if(settings.menu.hidePrint!=null){if(settings.menu.hidePrint){a.hide()}}else{if(settings.menu.disablePrintMobile=="true"||(Ext.os.is.Android&&Ext.browser.is.Firefox)){a.hide()}}},checkBookmarks:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuBookmarks");if(settings.menu.hideBookmarks!=null){a.hide()}else{if(settings.menu.bookmarkText!=null){}}},checkHowToUse:function(){var b=this;var a=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuHowToUse");if(settings.menu.hideHowToUse!=null){if(settings.menu.hideHowToUse){a.hide()}}else{if(settings.menu.howToUseText!=null){}}},checkHelp:function(){var b=this;var a=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuHelp")},loadShare:function(){var a=this;a.fireEvent("loadShare",a)},loadSections:function(){var a=this;a.fireEvent("loadSections",a,a.sectionsContainer,a.sectionsHeaderContainer)},loadSupplements:function(){var a=this;a.fireEvent("loadSupplements",a,a.supplementsContainer,a.supplementsHeaderContainer)},loadQuickLinks:function(){var a=this;a.fireEvent("loadQuickLinks",a,a.quickLinksContainer,a.quickLinksHeaderContainer)},loadZones:function(){var a=this;a.fireEvent("loadZones",a,a.zonesContainer,a.zonesHeaderContainer)},checkWhatsNewBanner:function(){var c=this;var a=c.whatsNewContainer.element.down(".bannerIcon").dom;try{if(localStorage.getItem("versionwhatsnew"+version.replace(/g./g,"_"))!=null){a.style.display="none"}}catch(b){}},sponsorSetup:function(){var b=this;if(settings.menu.sponsor==null){b.sponsorEdition.hide();b.sponsorInfo.hide()}else{if(settings.menu.sponsor.type=="adbridg"){var a=Ext.create("Ext.Container",{padding:0});a.setHtml("<div id='"+(b.id+"_menusponsor")+"' data-adbridg-ad-class='adb-ee-menu'></div>");if(settings.menu.sponsor.position=="top"){b.menuLayout.getComponent("editionOptionsSection").insert(0,a)}else{b.menuLayout.getComponent("editionOptionsSection").add(a)}b.sponsorEdition.hide();b.sponsorInfo.hide()}else{if(settings.menu.sponsor.type!="image"){var a=Ext.create("InfinityMobile.view.Advert",{advert:settings.menu.sponsor,xtype:"advertview",padding:0});if(settings.menu.sponsor.position=="top"){b.menuLayout.getComponent("editionOptionsSection").insert(0,a)}else{b.menuLayout.getComponent("editionOptionsSection").add(a)}b.sponsorEdition.hide();b.sponsorInfo.hide()}else{if(b.sponsorEdition!=null){b.sponsorEdition.setHtml("<img style='height:20px;width:auto;' src='"+settings.menu.sponsor.image+"' />");b.sponsorEdition.url=settings.menu.sponsor.link;if(settings.menu.sponsor.link!=null&&settings.menu.sponsor.link.length>0){b.sponsorEdition.element.on({tap:function(){var c=this;window.open(c.url);mainPanel.fireEvent("trackAdvertClick","imageSponsor")},scope:b.sponsorEdition})}}if(b.sponsorInfo!=null){b.sponsorInfo.setHtml("<img style='height:20px;width:auto;' src='"+settings.menu.sponsor.image+"' />");b.sponsorInfo.url=settings.menu.sponsor.link;if(settings.menu.sponsor.link!=null&&settings.menu.sponsor.link.length>0){b.sponsorInfo.element.on({tap:function(){var c=this;window.open(c.url);mainPanel.fireEvent("trackAdvertClick","imageSponsor")},scope:b.sponsorInfo})}}}}}},checkLogout:function(){var b=this;var c=InfinityMobile.app.application.getController("AppController").hasValidLoginViaUserAccessCookie();var a=loggedIn.toLowerCase()=="true"||c===true;if(!a||settings.menu.hideUserOptions=="true"){b.menuLayout.getComponent("menuUserContainer").hide();b.menuLayout.getComponent("menuUserOp").hide()}else{if(settings.menu.hideMyAccount!=null&&settings.menu.hideMyAccount=="true"){b.menuLayout.getComponent("menuUserContainer").getComponent("menuAccount").hide()}}},checkTerms:function(){var a=this;a.menuTerms=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuTerms");if(settings.menu.terms==null){a.menuTerms.hide()}},handleJustifiedText:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right");a.menuHeaderClose.setRight(false);a.menuHeaderClose.setLeft(0)}},initializePuzzlesMenu:function(){var a=this;a.menuPuzzles=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuPuzzles");if(a.menuPuzzles!=null&&!InfinityMobile.controller.ReaderPuzzlesController.hasSettingEnabledForPuzzlesPopup()){a.menuPuzzles.hide()}},setupMenuHeaderClose:function(){var b=this;var a=settings&&settings.menu&&settings.menu.menuHeaderCloseURL;if(a&&a.length>0){var c="<img src='"+a+"' style='width:20px' />";b.menuHeaderClose.setHtml(c)}}},0,["readermenu"],["component","container","panel","overlay","readermenu"],{component:true,container:true,panel:true,overlay:true,readermenu:true},["widget.readermenu"],0,[InfinityMobile.view.phone,"ReaderMenu"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderMenuSection",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px)",right:0,top:40,items:[{itemId:"sectionitemscontainer",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{padding:15},items:[{id:"menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc",margin:"0 0 15 0",padding:"5 15 5 15",text:"SECTIONS"}]}]},initializ}},0,["readermenusection"],["component","container","panel","overlay","readermenusection"],{component:true,container:true,panel:true,overlay:true,readermenusection:true},["widget.readermenusection"],0,[InfinityMobile.view.tablet,"ReaderMenuSection"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderMenuSection",InfinityMobile.view.Overlay,{config:{width:"100%",layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:100%",right:0,top:0,items:[{itemId:"menuHeader",html:"Menu",margin:0,height:40,style:"background-color:#2c2f32; color:#ffffff",padding:"10 15 10 15",items:[{itemId:"menuHeaderClose",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{itemId:"sectionitemscontainer",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{padding:15},items:[{id:"menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc",margin:"0 0 15 0",padding:"5 15 5 15",text:"SECTIONS"}]}]},initializ},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){a.hide()})},backtapped:function(){var a=this;a.fireEvent("back",a)}},0,["readermenusection"],["component","container","panel","overlay","readermenusection"],{component:true,container:true,panel:true,overlay:true,readermenusection:true},["widget.readermenusection"],0,[InfinityMobile.view.phone,"ReaderMenuSection"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArchive",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);a.setupVars();a.setTracking();a.setupLanguage();a.setupEvents();a.setSquareCorners();a.setupTabSelector()},setupVars:function(){var a=this;a.archiveToolBar=a.getComponent("archiveToolBar");if(a.archiveToolBar!=null){a.archiveToolBarClose=a.archiveToolBar.getComponent("archiveToolBarClose");a.title=a.archiveToolBar.getComponent("title")}a.archiveBodyContainer=a.getComponent("archiveBodyContainer");if(a.archiveBodyContainer!=null){a.archiveContainerText=a.archiveBodyContainer.getComponent("archiveContainerText");a.archiveGlobalContainer=a.archiveBodyContainer.getComponent("archiveItemsGlobalContainer");if(a.archiveGlobalContainer!=null){a.archiveItemsContainer=a.archiveGlobalContainer.getComponent("archiveItemsContainer")}}a.titleStr="Archive";a.archiveContainerTextStr="Select a thumbnail to view an edition from the archive";if(typeof language!="undefined"&&language.archive){a.titleStr=language.archive.archive;a.archiveContainerTextStr=language.archive.archiveContainerText}},setupLanguage:function(){var a=this;if(a.archiveToolBar!=null){a.archiveToolBar.setText(a.titleStr)}if(a.archiveContainerText!=null){a.setText(a.archiveContainerText,a.archiveContainerTextStr)}},setText:function(a,b){if(a!=null){a.setHtml(b)}},setTracking:function(){var a=this;if(typeof settings!="undefined"&&settings.tracking!=null){var b=settings.tracking.trackingType;if(b=="DA"&&typeof trackDaPageView!="undefined"){trackDaPageView("Archive","Digital Edition")}}},close:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)},hideMonthContainer:function(){var a=this;if(a.archiveMonthsContainer!=null){a.archiveMonthsContainer.hide()}},setupTabSelector:function(){var c=this;var a=false;if(settings.newsday!=null&&settings.newsday.specialArchive!=null){a=true}else{if(settings.menu!=null&&settings.menu.extraArchives!=null){a=true}}if(a){if(c.archiveContainerText!=null){c.archiveContainerText.hide()}var b=Ext.create("InfinityMobile.view.ArchiveTabSelector",{startName:"Archive"});c.insert(1,b)}},setupEvents:function(){var a=this;a.setupHorizontalPaginationEvents()},setupHorizontalPaginationEvents:function(){var d=this;var f=d.archiveMonthHorizontalContainer!=null?d.archiveMonthHorizontalContainer.getScrollable():d.archiveMonthsContainer.getScrollable();var c=f!=null?f.getScroller():null;var a=currentProfile=="phone"?2:4;var g=5;if(d.rightArrow!=null){var b;var l=function(m){m.preventDefault();b=setInterval(function(){if(c!=null){var n=c.position.x+a;n<=c.maxPosition.x?c.scrollTo(n,0):c.scrollTo(c.maxPosition.x)}},g)};var h=function(m){m.preventDefault();if(b!=null){clearInterval(b)}};d.rightArrow.element.dom.addEventListener("touchstart",l);d.rightArrow.element.dom.addEventListener("touchend",h);d.rightArrow.element.dom.addEventListener("touchcancel",h);if(currentProfile=="desktop"){d.rightArrow.element.dom.addEventListener("mousedown",l);d.rightArrow.element.dom.addEventListener("mouseup",h);d.rightArrow.element.dom.addEventListener("mouseleave",h)}}if(d.leftArrow!=null){var e;var k=function(m){m.preventDefault();e=setInterval(function(){if(c!=null){var n=c.position.x-a;n>=c.minPosition.x?c.scrollTo(n,0):c.scrollTo(c.minPosition.x)}},g)};var j=function(m){m.preventDefault();if(e!=null){clearInterval(e)}};d.leftArrow.element.dom.addEventListener("touchstart",k);d.leftArrow.element.dom.addEventListener("touchend",j);d.leftArrow.element.dom.addEventListener("touchcancel",j);if(currentProfile=="desktop"){d.leftArrow.element.dom.addEventListener("mousedown",k);d.leftArrow.element.dom.addEventListener("mouseup",j);d.leftArrow.element.dom.addEventListener("mouseleave",j)}}}},0,["readerarchiveparent"],["component","container","panel","overlay","readerarchiveparent"],{component:true,container:true,panel:true,overlay:true,readerarchiveparent:true},["widget.readerarchiveparent"],0,[InfinityMobile.view,"ReaderArchive"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOverlayTitle",Ext.Container,{config:{height:40,width:"100%",cls:"overlay-title",layout:"hbox",style:" position: relative;",padding:10,items:[{itemId:"title",flex:1,height:"100%",style:"text-overflow: ellipsis; overflow: hidden; white-space: nowrap;"},{id:"toolBarClose",cls:"pointerCursor",width:40,height:"100%",style:"text-align:center;",html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},initialize:function(){var a=this;a.setupVars();a.setupListeners();a.setupAppearance();a.setTitleStyle()},setupVars:function(){var a=this;a.title=a.getComponent("title");a.closeBtn=a.getComponent("toolBarClose");a.parentOverlay=a.getParent();if(a.config.titleTxt!=null){a.titleTxt=a.config.titleTxt}if(a.config.destroyOnClose!=null){a.destroyOnClose=a.config.destroyOnClose}if(a.config.rounded!=null){a.rounded=a.config.rounded}a.titleBarTextColour="#e6e6e6";a.titleBarColour="#000000";if(typeof settings!="undefined"&&settings.reader!=null){a.titleBarTextColour="#"+settings.reader.overlayTitleBarTextColour;a.titleBarColour="#"+settings.reader.overlayTitleBarColour}},setupListeners:function(){var a=this;a.closeBtn.element.on({tap:a.close,scope:a})},close:function(){var a=this;a.parentOverlay=a.getParent();if(a.parentOverlay!=null){a.destroyOnClose?a.parentOverlay.destroy():a.parentOverlay.hide()}},setupAppearance:function(){var a=this;a.setText(a.titleTxt);a.setColours();a.setRounded(a.rounded);a.setCloseBtnStyling()},setText:function(b){var a=this;a.title.setHtml("<span>"+b+"</span>")},setColours:function(){var a=this;a.setStyle({color:a.titleBarTextColour,backgroundColor:"rgba("+hexToRgb(a.titleBarColour)+", 0.9)"})},setRounded:function(a){var b=this;a&&!(typeof settings!="undefined"&&settings.newsday!=null)?b.setStyle("border-top-left-radius:0.3em;border-top-right-radius:0.3em"):"border-top-left-radius:0em;border-top-right-radius:0em"},setCloseBtnStyling:function(){var b=this;if(typeof settings!="undefined"&&settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeBtn.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setTitleStyle:function(){var b=this,c=b.getComponent("title"),a=c.element.dom.getElementsByClassName("x-innerhtml")[0];a.style="text-overflow:ellipsis; overflow:hidden; white-space:nowrap";b.handleJustifiedText()},handleJustifiedText:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.remove(a.closeBtn,false);a.insert(0,a.closeBtn)}}},0,["readeroverlaytitle"],["component","container","readeroverlaytitle"],{component:true,container:true,readeroverlaytitle:true},["widget.readeroverlaytitle"],0,[InfinityMobile.view,"ReaderOverlayTitle"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderItemsContainer",Ext.Container,{config:{cls:"reader-items-container"},initialize:function(){var a=this;switch(currentProfile){case"desktop":a.setupNativeScrolling();break;default:if(Ext.browser.is.Firefox&&Ext.os.is.Android){a.setupNativeScrolling()}else{if(a.config.preventScrollerSetup){break}a.setupSenchaScroller()}break}},setupNativeScrolling:function(){var c=this;if(Ext.browser.is.IE){var b=c.element.down(".x-inner");if(b!=null){var a=b.dom;a.style.msOverflowY="auto";a.style.overflowY="auto";a.style.msOverflowStyle="scrollbar";a.style.msTouchAction="pan-y"}}else{c.setStyle({overflowY:"scroll",webkitOverflowScrolling:"touch",msOverflowY:"auto",msOverflowStyle:"scrollbar",msTouchAction:"pan-x pan-y",touchAction:"pan-x pan-y"})}},setupSenchaScroller:function(){var a=this;a.setScrollable({direction:"vertical",directionLock:true})}},0,["readeritemscontainer"],["component","container","readeritemscontainer"],{component:true,container:true,readeritemscontainer:true},["widget.readeritemscontainer"],0,[InfinityMobile.view,"ReaderItemsContainer"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderArchive",InfinityMobile.view.ReaderArchive,{config:{id:"archivecontainer",height:"100%",width:"100%",style:"padding:0px;max-height:700px;max-width:700px;",items:[{id:"archiveToolBar",xtype:"readeroverlaytitle",titleTxt:"Archive",parentOverlay:this,destoryOnClose:true,rounded:true},{id:"archiveBodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{itemId:"archiveContainerText",margin:"0 0 20px 0"},{itemId:"archiveMonthContainerHorizontal",layout:"hbox",items:[{itemId:"leftArrow",html:"<img src='resources/images/LeftArrow_Icon.png' style='width:20px' />"},{itemId:"archiveMonthsContainer",height:30,flex:1,layout:"hbox",margin:"0 15px 0 15px",padding:"0 0 10px 0",monthdirection:"horizontal",scrollable:{direction:"horizontal",directionLock:true},defaults:{height:20,margin:"0 20px 0 0",padding:0,style:"font-weight:bold",type:"shortDate"},items:[]},{itemId:"rightArrow",html:"<img src='resources/images/RightArrow_Icon.png' style='width:20px' />"}]},{layout:"hbox",height:560,itemId:"archiveItemsGlobalContainer",items:[{itemId:"archiveMonthsContainer",width:180,height:"100%",monthdirection:"vertical",scrollable:{direction:"vertical",directionLock:true}},{id:"archiveItemsContainer",xtype:"readeritemscontainer",flex:1,defaults:{width:145,margin:"0 8 16 7",cls:"archiveitemphone"}}]}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderArchive.prototype.initialize.apply(this,arguments);a.setMonthPagination();a.setArchiveSelector();a.fireEvent("initialized",a)},setupVars:function(){var a=this;InfinityMobile.view.ReaderArchive.prototype.setupVars.apply(this,arguments);if(a.archiveBodyContainer!=null){a.archiveMonthsHorizontalContainer=a.archiveBodyContainer.getComponent("archiveMonthContainerHorizontal");if(a.archiveMonthsHorizontalContainer!=null){a.archiveMonthHorizontalContainer=a.archiveMonthsHorizontalContainer.getComponent("archiveMonthsContainer");a.rightArrow=a.archiveMonthsHorizontalContainer.getComponent("rightArrow");a.leftArrow=a.archiveMonthsHorizontalContainer.getComponent("leftArrow")}}if(a.archiveGlobalContainer!=null){a.archiveMonthVerticalContainer=a.archiveGlobalContainer.getComponent("archiveMonthsContainer")}},setMonthPagination:function(){var b=this;var a=b.archiveMonthVerticalContainer;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.archiveUsesTabs!=null){if(settings.menu.archiveMonthDirection!=null&&settings.menu.archiveMonthDirection.toLowerCase()!=null&&settings.menu.archiveMonthDirection.toLowerCase()=="horizontal"){a=b.archiveMonthHorizontalContainer}}if(a==b.archiveMonthHorizontalContainer){b.archiveMonthVerticalContainer.hide()}else{b.archiveMonthsHorizontalContainer.hide()}b.archiveMonthsContainer=a},setArchiveSelector:function(){var a=this;if(typeof settings!="undefined"&&settings.newsday!=null){a.setStyle({borderRadius:"0px"});a.element.down("div").dom.style.borderRadius="0px";a.archiveSelector=Ext.create("InfinityMobile.view.desktop.ArchiveSelector",{});a.archiveSelector.setStyle({backgroundColor:"transparent"});a.archiveSelector.element.dom.style.color="";a.archiveSelector.setMargin("0 0 10px 0");a.archiveSelector.setPadding(0);a.archiveSelector.element.on("tap",function(){a.archiveSelector.focus()});a.archiveBodyContainer.insert(0,a.archiveSelector);a.archiveGlobalContainer.setHeight(520);a.archiveItemsContainer.setHeight(520)}}},0,["readerarchive"],["component","container","panel","overlay","readerarchiveparent","readerarchive"],{component:true,container:true,panel:true,overlay:true,readerarchiveparent:true,readerarchive:true},["widget.readerarchive"],0,[InfinityMobile.view.tablet,"ReaderArchive"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderArchive",InfinityMobile.view.ReaderArchive,{config:{id:"archivecontainer",width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"archiveToolBar",xtype:"readeroverlaytitle",titleTxt:"Archive",destoryOnClose:true,rounded:false},{id:"archiveBodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,style:"font-size:15px",items:[{itemId:"archiveContainerText"},{height:20},{itemId:"archiveMonthContainer",layout:"hbox",items:[{itemId:"leftArrow",style:"position:absolute; left:5px",html:"<img src='resources/images/LeftArrow_Icon.png' style='width:20px' />"},{itemId:"rightArrow",style:"position:absolute; right:5px",html:"<img src='resources/images/RightArrow_Icon.png' style='width:20px' />"},{itemId:"archiveMonthsContainer",height:30,flex:1,layout:"hbox",margin:"0 15px 0 15px",padding:"0 0 10px 0",monthdirection:"horizontal",scrollable:{direction:"horizontal",directionLock:true},defaults:{height:20,margin:"0 20px 0 0",padding:0,style:"font-weight:bold;text-align:center;",type:"shortDate"},items:[]}]},{id:"archiveItemsContainer",flex:1,xtype:"readeritemscontainer",defaults:{cls:"archiveitemphone"}}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderArchive.prototype.initialize.apply(this,arguments);a.setArchiveSelector();a.fireEvent("initialized",a)},setupVars:function(){var a=this;InfinityMobile.view.ReaderArchive.prototype.setupVars.apply(this,arguments);if(a.archiveBodyContainer!=null){a.archiveItemsContainer=a.archiveBodyContainer.getComponent("archiveItemsContainer");a.archiveMonthContainer=a.archiveBodyContainer.getComponent("archiveMonthContainer");if(a.archiveMonthContainer!=null){a.archiveMonthsContainer=a.archiveMonthContainer.getComponent("archiveMonthsContainer");a.leftArrow=a.archiveMonthContainer.getComponent("leftArrow");a.rightArrow=a.archiveMonthContainer.getComponent("rightArrow")}}},hideMonthContainer:function(){var a=this;if(a.archiveMonthContainer!=null){a.archiveMonthContainer.hide()}},setArchiveSelector:function(){var a=this;if(typeof settings!="undefined"&&settings.newsday!=null){a.setStyle({borderRadius:"0px"});a.element.down("div").dom.style.borderRadius="0px";a.archiveSelector=Ext.create("InfinityMobile.view.phone.ArchiveSelector",{});a.archiveSelector.setStyle({backgroundColor:"transparent"});a.archiveSelector.element.dom.style.color="";a.archiveSelector.setMargin("0 0 10px 0");a.archiveSelector.setPadding(0);a.archiveSelector.element.on("tap",function(){a.archiveSelector.focus()});a.archiveBodyContainer.insert(0,a.archiveSelector)}}},0,["readerarchive"],["component","container","panel","overlay","readerarchiveparent","readerarchive"],{component:true,container:true,panel:true,overlay:true,readerarchiveparent:true,readerarchive:true},["widget.readerarchive"],0,[InfinityMobile.view.phone,"ReaderArchive"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSearch",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);a.setupVars();a.setupLanguage();a.setupRadioBtns();a.setupStyle();a.setupEventListeners();a.setInitialSearchTerm();a.setSquareCorners();a.search()},setupVars:function(){var c=this;c.isSearch=true;c.hasSearched=false;c.previousSearch=[];c.searchTerm=c._searchTerm;c.searchType="e";c.previousSearchType="current";c.searchToolBar=c.getComponent("seachToolBar");c.searchBar=c.getComponent("searchBar");c.searchSelector=c.getComponent("searchTypeContainer");c.newSearchInput=c.searchSelector.getComponent("new-search");c.searchLastResultsInput=c.searchSelector.getComponent("search-results");c.searchTermBox=c.searchBar.getComponent("searchTerm");if(c.searchTermBox.element.down(".search-field")!=null){c.input=c.searchTermBox.element.down(".search-field").dom;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){c.input.dir="rtl"}}c.searchTermButton=c.searchBar.getComponent("searchButton");if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){c.searchTermButton.setLeft(10);c.searchTermButton.setRight(false)}c.searchResultsContainer=c.getComponent("searchResults");c.pageNavArea=c.getComponent("pageNav");c.pageNavContainer=c.pageNavArea.getComponent("pageNavContainer");c.previousPage=c.pageNavArea.getComponent("previous");c.nextPage=c.pageNavArea.getComponent("next");c.searchButtonsContainer=c.getComponent("searchButtonsContainer");c.topButtonBar=c.searchButtonsContainer.getComponent("topButtonContainer");c.searchCurrentEdition=c.searchButtonsContainer.getComponent("topButtonContainer").getComponent("searchCurrentEdition");c.searchCurrentEdition.addCls("active-search");c.searchAllEditions=c.searchButtonsContainer.getComponent("topButtonContainer").getComponent("searchAllEditions");c.showSearchDate=c.searchButtonsContainer.getComponent("topButtonContainer").getComponent("showSearchDate");c.dateButton=c.showSearchDate.getComponent("btn");c.showSearchDateButton=c.dateButton.getComponent("btnText");c.bottomButtonBar=c.searchButtonsContainer.getComponent("bottomButtonContainer");c.searchLastResults=c.bottomButtonBar.getComponent("searchPreviousResults");c.searchLastResultsText=c.searchLastResults.getComponent("btnText");c.searchDateContainer=c.showSearchDate.getComponent("searchDateContainer");c.fromDateContainer=c.searchDateContainer.getComponent("startDate");c.startDate=c.fromDateContainer.element.down("input");c.endDateContainer=c.searchDateContainer.getComponent("endDate");c.endDate=c.endDateContainer.element.down("input");c.searchDate=c.searchDateContainer.getComponent("searchDate");c.titleStr="Search";c.placeHolderTxt="Enter keyword...";c.currentEditionTxt="Current Edition";c.allEditionsTxt="All Editions";c.dateTxt="Date";if(typeof language!=null){var b=language.search;if(b!=null){if(b.search!=null){c.titleStr=b.search}if(b.enterKeyword!=null){c.placeHolderTxt=b.enterKeyword}if(b.currentEdition!=null){c.currentEditionTxt=b.currentEdition}if(b.allEditions!=null){c.allEditionsTxt=b.allEditions}if(b.date!=null){c.dateTxt=b.date}}}c.searchLastResultsSetting=false;c.overlayTitleBarColour="#000000";c.overlayTextBarColour="#e6e6e6";if(typeof settings!="undefined"){var d=settings.menu;if(d!=null&&d.searchLastResults=="true"){c.searchLastResultsSetting=true}var a=settings.reader;if(a!=null&&a.overlayTitleBarTextColour!=null){c.overlayTextBarColour=a.overlayTitleBarTextColour}if(a!=null&&a.overlayTitleBarColour!=null){c.overlayTitleBarColour=a.overlayTitleBarColour}}},setupLanguage:function(){var a=this;if(a.searchToolBar!=null&&a.searchToolBar.setText!=null&&a.titleStr!=null){a.searchToolBar.setText(a.titleStr)}if(a.input!=null&&a.placeHolderTxt!=null){a.input.placeholder=a.placeHolderTxt}if(a.searchCurrentEdition!=null&&a.searchCurrentEdition.setText!=null&&a.currentEditionTxt!=null){a.searchCurrentEdition.setText(a.currentEditionTxt)}if(a.searchAllEditions!=null&&a.searchAllEditions.setText!=null&&a.allEditionsTxt!=null){a.searchAllEditions.setText(a.allEditionsTxt)}if(a.dateButton!=null&&a.dateButton.setText!=null&&a.dateTxt!=null){a.dateButton.setText(a.dateTxt)}if(a.searchDate!=null&&a.searchDate.setText!=null&&a.titleStr!=null){a.searchDate.setText(a.titleStr)}},setText:function(a,b){if(a!=null){a.setHtml(b)}},setupRadioBtns:function(){var a=this;if(a.searchLastResultsSetting){a.newSearchInput.on({change:function(){if(a.newSearchInput.isChecked()){a.bottomButtonBar.hide();a.topButtonBar.show()}}});a.searchLastResultsInput.on({chang}})}else{a.searchSelector.hide()}},setupEventListeners:function(){var a=this;if(a.fromDateContainer!=null&&a.fromDateContainer.element!=null){a.setListener(a.fromDateContainer.element,"tap",function(){var b=this;b.startDate.focus()},a)}if(a.endDateContainer!=null&&a.endDateContainer.element!=null){a.setListener(a.endDateContainer.element,"tap",function(){var b=this;b.endDate.focus()},a)}if(a.searchCurrentEdition!=null&&a.searchCurrentEdition.setTap!=null){a.searchCurrentEdition.setTap(function(){a.searchTerm=a.input.value;a.previousSearchType="current";a.searchCurrentEdition.addCls("active-search");a.searchAllEditions.removeCls("active-search");a.dateButton.removeCls("active-search");a.fireEvent("searchCurrentEdition")})}if(a.searchAllEditions!=null&&a.searchAllEditions.setTap!=null){a.searchAllEditions.setTap(function(){a.searchTerm=a.input.value;a.previousSearchType="all";a.searchCurrentEdition.removeCls("active-search");a.searchAllEditions.addCls("active-search");a.dateButton.removeCls("active-search");a.fireEvent("searchAllEditions")})}if(a.dateButton!=null&&a.dateButton.element!=null){a.setListener(a.dateButton.element,"tap",function(){a.previousSearchType="datePicker";a.searchCurrentEdition.removeCls("active-search");a.searchAllEditions.removeCls("active-search");a.dateButton.addCls("active-search");a.fireEvent("showSearchDate")},a)}if(a.searchDate!=null&&a.searchDate.element!=null){a.setListener(a.searchDate.element,"tap",function(b){a.searchTerm=a.input.value;a.previousSearchType="date";a.fireEvent("searchDate");b.stopPropagation()},a)}if(a.searchLastResults!=null&&a.searchLastResults.setTap!=null){a.searchLastResults.setTap(function(b){a.searchTerm=a.input.value;a.fireEvent("searchPreviousResults");b.stopPropagation()})}if(a.searchTermBox!=null&&a.searchTermBox.element!=null){a.setListener(a.searchTermBox.element,"tap",function(){var b=$(a.searchTermBox.element.dom).find("input")[0];if(b!=null){b.focus()}},a.searchTermBox);if(a.input!=null){a.searchTermBox.setValu};a.searchTermBox.getValu}}}if(a.previousPage!=null){a.previousPage.element.on({tap:function(){a.fireEvent("previousPage",a)}})}if(a.nextPage!=null){a.nextPage.element.on({tap:function(){a.fireEvent("nextPage",a)}})}},setListener:function(a,d,c,b){if(a!=null&&d!=null){a.on(d,c,b)}},setupStyle:function(){var b=this;if(b.searchSelector!=null){b.searchSelector.setStyle({color:b.overlayTextBarColour,backgroundColor:"rgba("+hexToRgb(b.overlayTitleBarColour)+", 0.9)"})}if(b.searchBar!=null){b.searchBar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"})}if(settings.menu!=null&&settings.menu.searchEnableAllEdition=="false"){b.searchAllEditions.hide()}var a="true";if(settings.menu.searchDisableDateTextFields!=null){a=settings.menu.searchDisableDateTextFields}if(currentProfile=="desktop"){b.on("painted",function(){var f=$(b.showSearchDate.element.dom).find("input");if(f.length==2){f[0].type="text";f[1].type="text";var c="yy-mm-dd";if(settings.menu.useAmericanDateFormat!=null&&settings.menu.useAmericanDateFormat=="true"){c="mm-dd-yy";var d=new Date();f[0].value=(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getFullYear();f[1].value=(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getFullYear()}if(typeof isTribReader!="undefined"){if(isTribReader){c="mm-dd-yy";var d=new Date();f[0].value=(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getFullYear();f[1].value=(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getFullYear()}}if(settings.menu.dateFormat!=null){c=convertDateFormat(settings.menu.dateFormat);f[0].value=b.getDateFromFormat(settings.menu.dateFormat);f[1].value=b.getDateFromFormat(settings.menu.dateFormat)}if(settings.menu!=null&&settings.menu.searchOldestDate!=null){var e=new Date(settings.menu.searchOldestDate);var g=e.getFullYear()+":"+new Date().getFullYear();$(f[0]).datepicker({dateFormat:c,beforeShow:function(h){if(a=="true"){h.disabled=true}},onClose:function(h){if(a=="true"){if(this!=null){this.disabled=false}}},yearRange:g,minDate:e});$(f[1]).datepicker({dateFormat:c,beforeShow:function(h){if(a=="true"){h.disabled=true}},onClose:function(h){if(a=="true"){if(this!=null){this.disabled=false}}},yearRange:g,minDate:e})}else{$(f[0]).datepicker({dateFormat:c,beforeShow:function(h){if(a=="true"){h.disabled=true}},onClose:function(h){if(a=="true"){if(this!=null){this.disabled=false}}}});$(f[1]).datepicker({dateFormat:c,beforeSho},onClos}})}}if(settings.menu.searchStoreLastResults=="true"&&localStorage.getItem("previousSearch"+publicationguid)!=null){b.fireEvent("searchInit",b)}})}},getDateFromFormat:function(a){var f;if(a.indexOf(".")!=-1){f="."}else{if(a.indexOf("-")!=-1){f="-"}}var d=a.split(f);var e="";var b=new Date();for(var c=0;c<d.length;c++){if(d[c].toLowerCase()=="dd"||d[c].toLowerCase()=="d"){e+=b.getDate()}else{if(d[c].toLowerCase()=="mm"||d[c].toLowerCase()=="m"){e+=(b.getMonth()+1)}else{if(d[c].toLowerCase()=="yy"||d[c].toLowerCase()=="yyyy"){e+=b.getFullYear()}}}if(c<d.length-1){e+=f}}return e},setInitialSearchTer},search:function(){var a=this;a.searchTerm=a.input.value;if(a.searchTerm!=""){a.fireEvent("search")}},show:function(){var a=this;a.keyFunc=window.onkeydown;a.setupEnterSearch();InfinityMobile.view.Overlay.prototype.show.apply(this,arguments)},setupEnterSearch:function(){var a=this;window.onkeydown=function(b){if(b.keyCode==13){a.searchTerm=a.input.value;if(a.searchLastResultsSetting&&(a.searchLastResultsInput!=null&&a.searchLastResultsInput.isChecked())){a.fireEvent("searchPreviousResults")}else{switch(a.previousSearchType){case"current":a.fireEvent("searchCurrentEdition");break;case"all":a.fireEvent("searchAllEditions");break;case"date":a.previousSearchType="datePicker";a.fireEvent("showSearchDate");event.stopPropagation();break;case"datePicker":a.previousSearchType="date";a.fireEvent("searchDate");event.stopPropagation();break}}}}}},0,["searchparent"],["component","container","panel","overlay","searchparent"],{component:true,container:true,panel:true,overlay:true,searchparent:true},["widget.searchparent"],0,[InfinityMobile.view,"ReaderSearch"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOverlayButton",Ext.Container,{config:{width:150,height:40,cls:"pointerCursor btn",layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"btnText"}]},initialize:function(){var a=this;a.setupVars();a.setupAppearance(a.btnColour,a.txtColour);a.setText(a.txt)},setupVars:function(){var b=this;b.btnTxt=b.getComponent("btnText");b.txtColour="#ffffff";if(typeof settings!="undefined"&&settings.reader!=null&&settings.buttonTextColour!=null){var a=settings.reader.buttonTextColour;b.txtColour=a.indexOf("#")>=0?a:"#"+a}b.btnColour="#458FBB";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.buttonColour!=null){var c=settings.reader.buttonColour;b.btnColour=c.indexOf("#")>=0?c:"#"+c}if(b.config.txt!=null){b.txt=b.config.txt}},setupAppearance:function(c,a){var b=this;b.setStyle({color:a,backgroundColor:"rgba("+hexToRgb(c)+",0.9)"})},setText:function(a){var b=this;if(b.btnTxt!=null){b.btnTxt.setHtml(a)}},setTap:function(b){var a=this;a.element.on("tap",b)}},0,["readeroverlaybutton"],["component","container","readeroverlaybutton"],{component:true,container:true,readeroverlaybutton:true},["widget.readeroverlaybutton"],0,[InfinityMobile.view,"ReaderOverlayButton"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderSearch",InfinityMobile.view.ReaderSearch,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;",zindex:3,layout:"vbox",searchTerm:"",cls:"searchOverlay",items:[{id:"seachToolBar",xtype:"readeroverlaytitle",titleTxt:"Search",parentOverlay:this,destoryOnClose:false,rounded:true},{itemId:"searchBar",height:50,padding:5,cls:"searchBar",items:[{id:"searchTerm",height:30,style:"color:red; font-size:12px;",width:"100%",html:"<input class='search-field' type='text' placeholder='' style='width:100%; height:35px; padding-left:10px;' />"},{id:"searchButton",cls:"searchicon pointerCursor",html:"<img src='../assets/search/grey-search-ic.png' style='width:20px; height:20px' />",right:10,top:15}]},{itemId:"searchTypeContainer",cls:"search-type-container",width:"100%",height:40,padding:5,layout:{type:"hbox",align:"center",pack:"middle"},defaults:{labelAlign:"right",labelWidth:"",labelWrap:true,style:"background-color:transparent; display:block; font-size:14px;font-weight:normal;transform:translateX(-20px);"},items:[{xtype:"radiofield",name:"search-type",itemId:"new-search",label:"New Search",checked:true},{xtype:"radiofield",name:"search-type",itemId:"search-results",label:"Search Within Results",disabled:true,checked:false}]},{itemId:"searchButtonsContainer",cls:"searchButtonsBar",items:[{itemId:"topButtonContainer",width:"100%",height:"100%",layout:{type:"hbox",pack:"center",align:"middle"},height:60,style:"z-index:1",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"searchCurrentEdition",cls:"pointerCursor btn",xtype:"readeroverlaybutton",txt:"Current Edition"},{width:25},{itemId:"searchAllEditions",cls:"pointerCursor btn",xtype:"readeroverlaybutton",txt:"All Editions"},{width:25},{itemId:"showSearchDate",cls:"pointerCursor btn",width:150,style:"background-color:#458fbb;color:#ffffff",items:[{itemId:"btn",xtype:"readeroverlaybutton",txt:"Date"},{itemId:"searchDateContainer",top:45,cls:"searchDate hidden",layout:"vbox",padding:10,items:[{itemId:"startDateText"},{itemId:"startDate",html:"<input type='date' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"endDateText"},{itemId:"endDate",html:"<input type='date' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"searchDate",cls:"pointerCursor btn",xtype:"readeroverlaybutton",txt:"Search"}]}]}]},{itemId:"bottomButtonContainer",height:"100%",margin:"0 20",hidden:true,layout:{type:"hbox",pack:"center",align:"middle"},height:60,style:"z-index:1",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"searchPreviousResults",cls:"pointerCursor btn",style:"background-color:#458fbb;color:#ffffff;min-width:500px",xtype:"readeroverlaybutton",txt:"Search Within Results"}]}]},{itemId:"searchResults",layout:"vbox",xtype:"readeritemscontainer",cls:"searchResults",flex:1,preventScrollerSetup:true},{itemId:"pageNav",layout:{type:"hbox",align:"middle",pack:"center"},height:50,width:"100%",style:"border-top: 1px solid #e1e1e1;",hidden:true,items:[{itemId:"previous",height:"100%",width:50,style:'background-image:url("../assets/article%20view/left-article-arrow.png");background-size: 50%; background-position:center;background-repeat: no-repeat;border-right: 1px solid #e1e1e1;'},{itemId:"pageNavContainer",flex:1,height:"100%",layout:{type:"hbox",align:"middle",pack:"center"},scrollable:{direction:"horizontal"}},{itemId:"next",height:"100%",width:50,style:'background-image:url("../assets/article%20view/right-article-arrow.png");background-size: 50%; background-position:center;background-repeat: no-repeat;border-left: 1px solid #e1e1e1'}]}]},setupStyle:function(){var a=this;InfinityMobile.view.ReaderSearch.prototype.setupStyle.apply(this,arguments);if(settings.menu!=null&&settings.menu.searchOldestDate){$(a.startDate.dom).attr("min",settings.menu.searchOldestDate);$(a.endDate.dom).attr("min",settings.menu.searchOldestDate)}}},0,["search"],["component","container","panel","overlay","searchparent","search"],{component:true,container:true,panel:true,overlay:true,searchparent:true,search:true},["widget.search"],0,[InfinityMobile.view.tablet,"ReaderSearch"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderSearch",InfinityMobile.view.ReaderSearch,{config:{width:"100%",height:"100%",style:"padding:0px",zindex:3,layout:"vbox",searchTerm:"",cls:"searchOverlay",items:[{id:"seachToolBar",xtype:"readeroverlaytitle",titleTxt:"Search",parentOverlay:this,destoryOnClose:false,rounded:false},{id:"searchBar",cls:"searchBar",height:50,padding:5,items:[{id:"searchTerm",height:30,style:"color:red; font-size:12px;",html:"<input class='search-field' type='text' placeholder='' style='width:100%; height:35px; padding-left:10px' />"},{id:"searchButton",cls:"searchiconphone",html:"<img src='../assets/search/grey-search-ic.png' style='width:20px; height:20px' />",right:10,top:15}]},{itemId:"searchTypeContainer",cls:"search-type-container",width:"100%",height:40,padding:5,layout:{type:"hbox",align:"center",pack:"middle"},defaults:{align:"left",labelAlign:"right",labelWidth:"",labelWrap:true,style:"background-color:transparent; display:block; font-size:14px;font-weight:normal;transform:translateX(-20px);"},items:[{xtype:"radiofield",name:"search-type",itemId:"new-search",label:"New Search",checked:true},{xtype:"radiofield",name:"search-type",itemId:"search-results",label:"Search Within Results",disabled:true,checked:false}]},{itemId:"searchButtonsContainer",cls:"searchButtonsBar",items:[{itemId:"topButtonContainer",width:"100%",height:"100%",layout:{type:"hbox",pack:"center",align:"middle"},height:40,style:"z-index:1",defaults:{height:30,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"searchCurrentEdition",cls:"btn",flex:1,style:"font-size:14px",xtype:"readeroverlaybutton",txt:"Current Edition"},{width:10},{itemId:"searchAllEditions",cls:"btn",flex:1,style:"font-size:14px",xtype:"readeroverlaybutton",txt:"All Editions"},{width:10},{itemId:"showSearchDate",cls:"btn",flex:1,style:"font-size:14px",items:[{itemId:"btn",width:"100%",height:"100%",xtype:"readeroverlaybutton",txt:"Date"},{itemId:"searchDateContainer",top:40,right:0,cls:"searchDate hidden",layout:"vbox",padding:10,items:[{itemId:"startDateText"},{itemId:"startDate",html:"<input type='date' class='datefield' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"endDateText"},{itemId:"endDate",html:"<input type='date' class='datefield' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"searchDate",cls:"btn",height:30,xtype:"readeroverlaybutton",txt:"Search"}]}]}]},{itemId:"bottomButtonContainer",width:"100%",height:"100%",hidden:true,layout:{type:"hbox",pack:"center",align:"middle"},height:40,style:"z-index:1",defaults:{height:30,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"searchPreviousResults",cls:"pointerCursor btn",padding:"0 10",width:"100%",style:"background-color:#458fbb;color:#ffffff;font-size:14px;",xtype:"readeroverlaybutton",txt:"Search Within Results"}]}]},{id:"searchResults",layout:"vbox",flex:1,xtype:"readeritemscontainer",cls:"searchResults",preventScrollerSetup:true},{itemId:"pageNav",layout:{type:"hbox",align:"middle",pack:"center"},height:50,width:"100%",style:"border-top: 1px solid #e1e1e1;",hidden:true,items:[{itemId:"previous",height:"100%",width:50,style:'background-image:url("../assets/article%20view/left-article-arrow.png");background-size: 50%; background-position:center;background-repeat: no-repeat;border-right: 1px solid #e1e1e1;'},{itemId:"pageNavContainer",flex:1,height:"100%",layout:{type:"hbox",align:"middle",pack:"center"},scrollable:{direction:"horizontal"}},{itemId:"next",height:"100%",width:50,style:'background-image:url("../assets/article%20view/right-article-arrow.png");background-size: 50%; background-position:center;background-repeat: no-repeat;border-left: 1px solid #e1e1e1'}]}]},setupStyle:function(){var a=this;InfinityMobile.view.ReaderSearch.prototype.setupStyle.apply(this,arguments);if(settings.menu!=null&&settings.menu.searchOldestDate){$(a.startDate.dom).attr("min",settings.menu.searchOldestDate);$(a.endDate.dom).attr("min",settings.menu.searchOldestDate)}}},0,["search"],["component","container","panel","overlay","searchparent","search"],{component:true,container:true,panel:true,overlay:true,searchparent:true,search:true},["widget.search"],0,[InfinityMobile.view.phone,"ReaderSearch"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderDownload",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);a.setupVars();a.setupLanguage();a.setupListeners();a.setupTracking();a.loadPages()},setupVars:function(){var a=this;a.downloadToolBar=a.getComponent("downloadToolBar");a.downloadBody=a.getComponent("downloadBody");a.downloadButtonContainer=a.downloadBody.getComponent("downloadButtonsContainer");a.downloadSelectAll=a.downloadButtonContainer.getComponent("downloadSelectAll");a.downloadSelectNone=a.downloadButtonContainer.getComponent("downloadSelectNone");a.download=a.downloadButtonContainer.getComponent("download");a.bodyContent=a.downloadBody.getComponent("bodyText");a.downloadItemsContainer=a.downloadBody.getComponent("downloadItems");a.bodyTxt="Select a thumbnail to download or choose 'Select All' to download the whole edition";if(typeof language!="undefined"&&language.download!=null&&language.download.downloadContainerText!=null){a.bodyTxt=language.download.downloadContainerText;a.selectAllTxt=language.download.downloadSelectAll;a.selectNoneTxt=language.download.downloadSelectNone;a.downloadTxt=language.download.download}},setupLanguage:function(){var a=this;a.setText(a.bodyContent,a.bodyTxt);if(a.downloadSelectAll!=null&&a.downloadSelectAll.setText!=null){a.downloadSelectAll.setText(a.selectAllTxt)}if(a.downloadSelectNone!=null&&a.downloadSelectNone.setText!=null){a.downloadSelectNone.setText(a.selectNoneTxt)}if(a.download!=null&&a.download.setText!=null){a.download.setText(a.downloadTxt)}if(a.downloadToolBar!=null&&a.downloadToolBar.setText!=null){a.downloadToolBar.setText(a.downloadTxt)}},setText:function(a,b){if(a!=null){a.setHtml(b)}},loadPages:function(){var a=this;a.fireEvent("loadPages",a,a.downloadItemsContainer)},setupListeners:function(){var a=this;if(a.downloadSelectAll!=null){a.downloadSelectAll.setTap(function(){a.fireEvent("selectAll",a)})}if(a.downloadSelectNone!=null){a.downloadSelectNone.setTap(function(){a.fireEvent("selectNone",a)})}if(a.download!=null){a.download.setTap(function(){a.fireEvent("download",a)})}},setupTracking:function(){var a=this;if(typeof settings!="undefined"&&settings.tracking!=null){var b=settings.tracking.trackingType;if(b=="DA"){if(typeof(trackDaPageView)=="function"){trackDaPageView("Downloads","Digital Edition")}}}}},0,["downloadparent"],["component","container","panel","overlay","downloadparent"],{component:true,container:true,panel:true,overlay:true,downloadparent:true},["widget.downloadparent"],0,[InfinityMobile.view,"ReaderDownload"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderDownload",InfinityMobile.view.ReaderDownload,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;",zindex:3,layout:"vbox",searchTerm:"",items:[{id:"downloadToolBar",xtype:"readeroverlaytitle",titleTxt:"Download",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"downloadBody",cls:"overlaybody",flex:1,padding:25,layout:"vbox",items:[{itemId:"bodyText"},{itemId:"downloadButtonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"downloadSelectAll",xtype:"readeroverlaybutton",txt:"Select All"},{width:25},{itemId:"downloadSelectNone",xtype:"readeroverlaybutton",txt:"Select None"},{width:25},{itemId:"download",xtype:"readeroverlaybutton",txt:"Download"}]},{itemId:"downloadItems",flex:1,xtype:"readeritemscontainer",defaults:{width:150,height:200,style:"overflow:hidden;",margin:"0 6 10 6"}}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderDownload.prototype.initialize.apply(this,arguments)}},0,["download"],["component","container","panel","overlay","downloadparent","download"],{component:true,container:true,panel:true,overlay:true,downloadparent:true,download:true},["widget.download"],0,[InfinityMobile.view.tablet,"ReaderDownload"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderDownload",InfinityMobile.view.ReaderDownload,{config:{width:"100%",height:"100%",style:"padding:0px",zindex:3,layout:"vbox",searchTerm:"",items:[{id:"downloadToolBar",xtype:"readeroverlaytitle",titleTxt:"Download",parentOverlay:this,destoryOnClose:true,rounded:false},{itemId:"downloadBody",cls:"overlaybody",flex:1,padding:15,layout:"vbox",items:[{itemId:"bodyText",style:"font-size:15px"},{itemId:"downloadButtonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:70,style:"font-size:15px",defaults:{height:30,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"downloadSelectAll",xtype:"readeroverlaybutton",txt:"Select All",flex:1},{width:25},{itemId:"downloadSelectNone",xtype:"readeroverlaybutton",txt:"Select None",flex:1},{width:25},{itemId:"download",xtype:"readeroverlaybutton",txt:"Download",flex:1}]},{itemId:"downloadItems",flex:1,xtype:"readeritemscontainer",defaults:{cls:"archiveitemphone"}}]}]}},0,["download"],["component","container","panel","overlay","downloadparent","download"],{component:true,container:true,panel:true,overlay:true,downloadparent:true,download:true},["widget.download"],0,[InfinityMobile.view.phone,"ReaderDownload"],0));(Ext.cmd.derive("InfinityMobile.view.ReadAloudControls",Ext.Container,{config:{style:"margin:-3px 0px 0px 10px;border-radius:10px;display:inline-block !important;width:35px; height:38px;",items:[{itemId:"controlPanel",height:"100%",width:"100%",layout:{type:"hbox"},style:"padding:3%;",items:[{cls:"audioControl",itemId:"play",style:"height:100%;width:35px;background-size:70% 70%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;",isPlaying:false},{width:"5%",height:"100%"},{width:"5%",height:"100%"},{cls:"audioControl",itemId:"restart",height:"100%",width:"30%",style:'background:url("resources/images/refresh-white.png") black;background-size:80% 80%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;'}]}]},initialize:function(){var a=this;if(a.config.target!=null){a.target=a.config.target}a.controlPanel=a.getComponent("controlPanel");a.playBtn=a.controlPanel.getComponent("play");a.playBtn.addCls("playReadAloud");a.restartBtn=a.controlPanel.getComponent("restart");a.setButtonListeners()},setButtonListeners:function(){var a=this;a.restartBtn.hide();a.type="play-stop";a.playBtn.element.on({tap:a.play,scope:a});a.restartBtn.element.on({tap:a.restart,scope:a})},pla},paus},restar}},0,["readaloudcontrols"],["component","container","readaloudcontrols"],{component:true,container:true,readaloudcontrols:true},["widget.readaloudcontrols"],0,[InfinityMobile.view,"ReadAloudControls"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderArticlePopover",Ext.Container,{config:{style:"padding:0px; border-radius:0px; background-color:white;",articleguid:"a3d9d9eb-36b5-46b6-94ee-31978e22dc78",cls:"articlepopover",fullscreen:true,layout:"vbox",zIndex:9999999,items:[{itemId:"topBar",cls:"popoverTopBar",height:50,layout:"hbox",style:"background-color:white;",items:[{itemId:"controls",width:"100%",padding:"10px 20px 0px 20px",height:50,layout:"hbox",items:[{itemId:"topBarShare",xtype:"readermenushare",layout:"hbox"},{itemId:"copyButton",cls:"topBarCopyButton popoverTool",baseCls:"copyButton",hidden:true,text:"Copy Article"},{itemId:"topBarSelectText",cls:"topBarSelectText popoverTool",hidden:true,html:'<div class="textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text-highlight-ic.png" ></div>'},{layout:"hbox",itemId:"interactiveContent",hidden:true,items:[{itemId:"topBarComic",html:'<img class="comic-btn" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/comics-ic.png">',cls:"popoverTool"},{itemId:"topBarPuzzle",html:'<img class="puzzle-btn" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/puzzle-ic.png">',cls:"popoverTool"}]},{itemId:"topBarPrint",html:'<div><img class="print-btn" style="cursor:hand;cursor:pointer;width:28px;height:28px;" src="'+location.protocol+"//"+location.host+'/tribune/print-icon.png"></div>',cls:"popoverTool"},{itemId:"textControl",html:'<div class="textSizeHtml5"><img class="textIncrease" style="cursor:hand;cursor:pointer;width:30px;height:30px;margin-right:15px;" src="../assets/article%20view/Text_Increase_Icon.png" ontouchstart="increaseText()" onclick="increaseText()"><img class="textDecrease" style="cursor:hand;cursor:pointer;width:30px;height:30px;" src="../assets/article%20view/Text_Decrease_Icon.png" ontouchstart="decreaseText()" onclick="decreaseText()"></div>',cls:"popoverTool"},{itemId:"topBarTranslate",cls:"topBarTranslate popoverTool",html:'<div><img style="cursor:hand;cursor:pointer;width:28px;height:28px;margin-top:2px;" src="../assets/article view/Spain.png"></div>'},{itemId:"ttsControl",baseCls:"ttsToggle",status:"STOPPED"},{itemId:"readAloudControls",cls:"popoverTool read-aloud",xtype:"readaloudcontrols",hidden:true}]},{itemId:"closeButton",top:0,right:0,padding:"10px 20px 10px 20px",style:"color:#4291b6",layout:{type:"hbox",align:"center"},items:[{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:"Close"},{width:10},{itemId:"closeImg",height:26,html:'<img src="../assets/article view/article-close-btn.png" style="width:26px;" />'}]}]},{width:"100%",height:100,itemId:"advertTop"},{itemId:"content",flex:1,cls:"innerhtmlfullheight"},{width:"100%",height:100,itemId:"advertBottom"},{itemId:"bottomNav",cls:"articleFooter",height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",align:"center"},items:[{itemId:"previousArticleButton",width:150,padding:"10 0 0 20",height:"100%",layout:"hbox",cls:"previousArticle",style:"white-space:nowrap;",items:[{itemId:"prev",cls:"previousArticleImg",html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{itemId:"previousArticle",html:"Previous Article",padding:"0 0 0 5"}]},{flex:1},{itemId:"articleText",html:"Article X / Y"},{flex:1},{itemId:"nextArticleButton",padding:"10 20 0 0",height:"100%",cls:"nextArticle",layout:{type:"hbox"},items:[{itemId:"nextArticle",html:"Next Article",padding:"0 5 0 0"},{itemId:"next",cls:"nextArticleImg",html:"<img style='height:20px' src='../assets/article view/right-article-arrow.png' />"}]}]}]},initialize:function(){var b=this;b.highlightMode=false;if(b.config.hasComics!=null){b.hasComics=b.config.hasComics}if(b.config.hasPuzzles!=null){b.hasPuzzles=b.config.hasPuzzles}b.content=b.getComponent("content");var a=b.getComponent("topBar");b.topBar=a.getComponent("controls");b.topBarShare=b.topBar.getComponent("topBarShare");b.closeButton=a.getComponent("closeButton");b.closeTxt=b.closeButton.getComponent("closeTxt");b.closeImg=b.closeButton.getComponent("closeImg");b.topBarPrint=b.topBar.getComponent("topBarPrint");b.ttsToggle=b.topBar.getComponent("ttsControl");b.readAloudControls=b.topBar.getComponent("readAloudControls");b.copyButton=b.topBar.getComponent("copyButton");b.interactiveContent=b.topBar.getComponent("interactiveContent");b.topBarComic=b.interactiveContent.getComponent("topBarComic");b.topBarPuzzle=b.interactiveContent.getComponent("topBarPuzzle");b.topBarSections=b.interactiveContent.getComponent("topBarSections");b.topBarTranslate=b.topBar.getComponent("topBarTranslate");b.bottomNavContainer=b.getComponent("bottomNav");if(settings.articlepopover.bottomBarColor!=null){b.bottomNavContainer.setStyle({backgroundColor:"#"+settings.articlepopover.bottomBarColor,color:"#"+settings.articlepopover.bottomFontColor})}b.previousArticleButton=b.bottomNavContainer.getComponent("previousArticleButton");b.nextArticleButton=b.bottomNavContainer.getComponent("nextArticleButton");b.articleText=b.bottomNavContainer.getComponent("articleText");b.nextArticleText=b.nextArticleButton.getComponent("nextArticle");b.previousArticleText=b.previousArticleButton.getComponent("previousArticle");b.setArticlePopoverText();b.topBarTextControls=b.topBar.getComponent("textControl");b.topBarSelectText=b.topBar.getComponent("topBarSelectText");b.advertTop=b.getComponent("advertTop");b.advertBottom=b.getComponent("advertBottom");b.closeTxt.setHtml(language.close);b.setCloseButtonListener();b.setCopyButtonListener();b.setupTextHighlight();b.setComicPuzzleListener();b.setTranslateListener();b.setNextButtonListener();b.setPreviousButtonListener();b.setTtsToggleListener();b.setupPrint();b.setupTextResize();b.setupReadAloud();b.setupInteractiveContent();b.checkAdvert();b.checkJustification();b.setArticleTextListeners();if(b.articleReader!=null){b.fireEvent("initializeArticlePopover",b);b.ttsToggle.hide()}else{if(b.config.isLive==null){b.fireEvent("initialized",b)}else{if(b.config.articles==null){b.fireEvent("initializeLivePopover",b);b.ttsToggle.hide()}else{b.fireEvent("initializeLivePopover",b,b.config.articles)}}}b.orientation=b.returnOrientation();if(settings.newsday!=null){b.addCls("popUp");b.topBarPrint.hide();if(settings.newsday.useFontAwesome=="true"){b.prevIcon=b.previousArticleButton.getComponent("prev");if(b.prevIcon!=null){b.prevIcon.setHtml('<i class="fa fa-angle-left fa-lg" style="position:relative;top:-1px;margin:2px;" aria-hidden="true"></i>')}b.nextIcon=b.nextArticleButton.getComponent("next");if(b.nextIcon!=null){b.nextIcon.setHtml('<i class="fa fa-angle-right fa-lg" style="position:relative;top:-1px;margin:2px;" aria-hidden="true"></i>')}}if(settings.newsday.useNewsdayPopover!=null){if(settings.newsday.useNewsdayPopover=="true"){if(settings.reader.overlayTitleBarColour!=null){a.setStyle({backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+",0.9)"})}b.closeButton.removeAll();var c=Ext.create("Ext.Container",{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:'<img src="resources/images/article-close-btn-white.png" style="width:26px;" />'});b.closeButton.add(c);b.closeButton.setPadding("10px 7px 10px 7px");if(settings.topbar.color!=null){b.closeButton.setStyle({color:"#"+settings.topbar.color})}b.closeButton.setPadding("12px 16px");b.topBar.insert(0,b.closeButton);b.topBar.setPadding("5px 0px 0px 0px");b.topBarTextControls.hide();b.topBarShare.setPadding("3px 0px 0px 5px")}}if(settings.newsday.hideShareIcons!=null){if(settings.newsday.hideShareIcons=="true"){b.topBarShare.removeAll()}}}b.hideTopBar();mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},setArticlePopoverText:function(){var a=this;if(language.articlePopover!=null){if(language.articlePopover.nextArticle){a.nextArticleText.setHtml(language.articlePopover.nextArticle)}if(language.articlePopover.previousArticle){a.previousArticleText.setHtml(language.articlePopover.previousArticle)}}},setArticleTextListeners:function(){var b=this;if(!!settings&&!!settings.articlepopover&&settings.articlepopover.enableFullscreen=="true"&&!!settings.menu&&settings.menu.hideArticles!="true"){b.articleText.element.on("tap",function(){b.fireEvent("viewallarticles",b)});if(InfinityMobile.controller.ReaderController.isNewPWA()){var a=!!language&&!!language.articlePopover&&!!language.articlePopover.viewAllArticles?language.articlePopover.viewAllArticles:"View All Articles";b.articleText.setHtml(a)}}},hideTopBar:function(){var a=this;if(settings.articlepopover.hideArticleControls!=null&&settings.articlepopover.hideArticleControls.toLowerCase()=="true"){a.topBar.hide();a.bottomNavContainer.hide();a.topBarShare.hide()}else{if(settings.articlepopover.disableArticleCarousel!=null&&settings.articlepopover.disableArticleCarousel.toLowerCase()=="true"){a.bottomNavContainer.hide()}}},setupInteractiveContent:function(){var a=this;if(settings.articlepopover.interactive=="true"){a.interactiveContent.show()}else{a.interactiveContent.hide()}},setArticlePopoverText:function(){var a=this;if(language.articlePopover!=null){if(language.articlePopover.nextArticle){a.nextArticleText.setHtml(language.articlePopover.nextArticle)}if(language.articlePopover.previousArticle){a.previousArticleText.setHtml(language.articlePopover.previousArticle)}}},setupTextResize:function(){var a=this;if(settings.articlepopover.textResize!="true"){a.topBarTextControls.hide()}else{a.topBarTextControls.show()}},setupPrint:function(){var a=this;if(settings.articlepopover.print=="true"&&(!(Ext.os.is.Android&&Ext.browser.is.Firefox)&&(navigator.userAgent.indexOf("EdgiOS")==-1))){a.topBarPrint.show();a.topBarPrint.element.on("tap",function(){if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){mainPanel.fireEvent("printArticleTemplate")}else{mainPanel.fireEvent("articlePrint",a);a.fireEvent("articlePrint")}})}else{a.topBarPrint.hide()}},setupTextHighlight:function(){var a=this;if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){a.topBarSelectText.hide()}else{if(settings.articlepopover.articleHighlight=="true"){a.topBarSelectText.show();a.topBarSelectText.element.on("tap",function(){a.fireEvent("selectTextMode",a)})}else{a.topBarSelectText.hide()}}},setupReadAloud:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined&&settings.articlepopover.readAloud!=null){a.ttsToggle.show()}else{a.ttsToggle.hide()}},setCopyButtonListener:function(){var a=this;if(!(document.queryCommandSupported&&document.queryCommandSupported("copy"))||settings.articlepopover.copy!="true"){a.copyButton.hide()}else{a.copyButton.show();a.copyButton.element.on({tap:function(){a.fireEvent("copyToClipboard","popover")}})}},setTranslateListener:function(){var a=this;if(settings.articlepopover.translate!=null){a.topBarTranslate.show();a.topBarTranslate.element.on({tap:function(b){b.stopPropagation();a.fireEvent("translateArticle",a)}})}else{a.topBarTranslate.hide()}},setComicPuzzleListener:function(){var a=this;if(a.hasComics){a.topBarComic.element.on("tap",function(b){b.preventDefault();a.fireEvent("jumpToComics",a)})}else{a.topBarComic.hide()}if(a.hasPuzzles){a.topBarPuzzle.element.on("tap",function(b){b.preventDefault();a.fireEvent("jumpToPuzzles",a)})}else{a.topBarPuzzle.hide()}},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},setArticleWidth:function(){var b=this;var a=Math.min(screen.width,screen.height);b.setWidth(a)},setTtsToggleListener:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined){a.ttsToggle.element.on({tap:function(){a.fireEvent("readAloudMode",a)}})}},setCloseButtonListener:function(){var a=this;a.closeButton.element.on({tap:"tap",scope:this})},setPreviousButtonListener:function(){var a=this;a.previousArticleButton.element.on("tap",function(b){b.preventDefault();b.stopPropagation();a.fireEvent("previous")})},setNextButtonListener:function(){var a=this;a.nextArticleButton.element.on("tap",function(b){b.preventDefault();b.stopPropagation();a.fireEvent("next")})},tap:function(){var a=this;if(a.returnOrientation()!=a.orientation){a.fireEvent("closeAndReset",a,a.returnOrientation())}else{a.fireEvent("close",a)}},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},checkAdvert:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;if(a!=null&&a.advertInArticleFlow=="false"){if(a.position=="top"){b.advertBottom.hide();b.setupAdvert(b.advertTop)}else{b.advertTop.hide();b.setupAdvert(b.advertBottom)}}else{b.advertTop.hide();b.advertBottom.hide()}}else{b.advertTop.hide();b.advertBottom.hide()}},setupAdvert:function(b){var c=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;c.advert=b;switch(a.type){case"dfp":c.setupDfpAdvert(b,a);break;case"image":c.setupImageAdvert(b,a);break}}},setupDfpAdvert:function(b,a){var c=this;c.networkCode=a.networkCode;c.adUnit=a.adUnit;c.advertHolder=Ext.create("Ext.Container");b.add(c.advertHolder);c.advertDivID=c.advertHolder.id+"advert";c.advertHolder.setHtml("<div id='"+c.advertDivID+"' style='height:90px;text-align:center;padding:5px;'></div>");c.on("painted",c.loadDfpAdvert)},setupImageAdvert:function(b,a){var c=this;if(a!=null){b.setHtml("<img src='"+a.url+"' style='margin:auto;display:block;margin-top:5px;' />");b.element.on("tap",function(){window.open(a.link)})}},loadDfpAdvert:function(){var a=this;googletag.cmd.push(function(){a.adslot=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("728"),parseInt("90")],a.advertDivID).addService(googletag.pubads().updateCorrelator());if(settings.reader.popupAdvert.targeting!=null&&settings.reader.bannerAd.targeting.length>0){var b=settings.reader.popupAdvert.targeting.split("|");for(var d in b){var e=b[d];var c=e.split("*");if(c!=null&&c.length>=2){a.adslot.setTargeting(c[0],c[1])}}}googletag.enableServices();googletag.display(a.advertDivID)})},refreshAdvert:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;if(a.type=="dfp"){b.advert.removeAll(true,true);if(b.refreshTimeout!=null){clearTimeout(b.refreshTimeout)}b.refreshTimeout=setTimeout(function(){b.checkAdvert();b.loadDfpAdvert()},1000)}}},checkJustification:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right");a.topBar.getLayout().setPack("end");a.closeButton.setRight("");a.closeButton.setLeft(0);a.closeButton.remove(a.closeTxt,false);a.closeButton.add(a.closeTxt);a.closeButton.remove(a.closeImg,false);a.closeButton.insert(0,a.closeImg)}},destroy:function(){var a=this;mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);Ext.Container.prototype.destroy.apply(this,arguments)}},0,["articleview"],["component","container","articleview"],{component:true,container:true,articleview:true},["widget.articleview"],0,[InfinityMobile.view.tablet,"ReaderArticlePopover"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderArticlePopover",Ext.Container,{config:{cls:"articlepopover",fullscreen:true,style:"padding:0px; border-radius:0px; background-color:white;",layout:"vbox",articleguid:"a3d9d9eb-36b5-46b6-94ee-31978e22dc78",zIndex:"9999999",items:[{itemId:"topBar",cls:"popoverTopBar",height:48,layout:"hbox",style:"background-color:white;",items:[{itemId:"controls",layout:"hbox",width:"100%",padding:"8px 0 0 0",height:48,items:[{width:15},{itemId:"topBarMenu",html:'<div class="article-menu textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:28px;height:28px;padding-top:5px;padding-bottom:1px;" src="resources/images/menu-black.png"></div>'},{itemId:"topBarShareButton",html:'<div class="article-menu textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:28px;height:28px;padding-top:5px;padding-bottom:1px;" src="resources/images/reader%20icons/share-black.png"></div>',hidden:true},{itemId:"topBarMenuPadding",width:5},{itemId:"copyButton",baseCls:"copyButton",hidden:true},{width:5,itemId:"copyButtonPadding"},{itemId:"topBarSelectText",html:'<div class="textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text-highlight-ic.png" ></div>',hidden:true},{width:5,itemId:"topBarSelectTextPadding"},{itemId:"topBarShare",xtype:"readermenushare",layout:"hbox",margin:"0 6 0 0"},{layout:"hbox",itemId:"interactiveContent",hidden:true,items:[{itemId:"topBarComic",html:'<img class="comic-btn" style="cursor:hand;cursor:pointer;width:28px;height:28px;" src="../assets/article%20view/comics-ic.png">'},{width:5},{itemId:"topBarPuzzle",html:'<img class="puzzle-btn" style="cursor:hand;cursor:pointer;width:28px;height:28px;" src="../assets/article%20view/puzzle-ic.png">'},{width:5}]},{itemId:"topBarPrint",html:'<div ><img class="print-btn" style="cursor:hand;cursor:pointer;width:28px;height:28px;" src="'+location.protocol+"//"+location.host+'/tribune/print-icon.png"></div>'},{width:5},{itemId:"textControl",html:'<div class="textSizeHtml5"><img class="textIncrease" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text_Increase_Icon.png" ontouchstart="increaseText()" onclick="increaseText()">&nbsp;<img class="textDecrease" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text_Decrease_Icon.png" ontouchstart="decreaseText()" onclick="decreaseText()"></div>'},{itemId:"topBarTranslate",cls:"topBarTranslate popoverToolMobile",html:'<div ><img  style="cursor:hand;cursor:pointer;width:28px;height:28px;margin-top:2px;" src="../assets/article view/Spain.png"></div>'},{itemId:"ttsControl",baseCls:"ttsToggle",status:"STOPPED"},{itemId:"readAloudControls",cls:"popoverTool read-aloud",xtype:"readaloudcontrols",hidden:true},{itemId:"inappTranslate",baseCls:"inappTranslate",cls:"spain"}]},{itemId:"closeButton",top:0,right:0,padding:"10px 15px 10px 20px",style:"color:#4291b6",layout:{type:"hbox",align:"center"},items:[{height:26,html:'<img src="../assets/article view/article-close-btn.png" style="width:26px;" />'}]},{itemId:"sharingDropdown",style:"background-color: #dfe0df;",layout:{type:"hbox"},top:48,width:"100%",height:48,padding:"10 0 0 15",hidden:true}]},{width:"100%",height:60,itemId:"advertTop"},{itemId:"content",flex:1,cls:"innerhtmlfullheight"},{width:"100%",height:60,itemId:"advertBottom"},{itemId:"bottomNav",cls:"articleFooter",height:40,style:"background-color:#dfe0df; color: #4591B8; font-size:15px",layout:{type:"hbox",align:"center"},items:[{itemId:"previousArticleButton",cls:"previousArticle",flex:1,padding:"0 0 0 5",height:"100%",layout:{type:"hbox",align:"center"},items:[{itemId:"prev",cls:"previousArticleImg",height:20,html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{itemId:"previousArticle",html:"Previous",padding:"0 0 0 5"}]},{width:10},{itemId:"articleText",padding:"0 0 0 0",html:"Article X / Y"},{width:10},{itemId:"nextArticleButton",cls:"nextArticle",flex:1,padding:"0 5 0 0",height:"100%",layout:{type:"hbox",pack:"end",align:"center"},items:[{itemId:"nextArticle",html:"Next",padding:"0 5 0 0"},{itemId:"next",height:20,cls:"nextArticleImg",html:"<img style='height:20px;' src='../assets/article view/right-article-arrow.png' />"}]}]}]},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);a.highlightMode=false;a.content=a.getComponent("content");a.topBarContainer=a.getComponent("topBar");var c=a.topBar=a.topBarContainer.getComponent("controls");a.topBarShare=c.getComponent("topBarShare");a.topBarShareDropdown=a.topBarContainer.getComponent("sharingDropdown");a.topBarMenu=c.getComponent("topBarMenu");a.topBarShareButton=c.getComponent("topBarShareButton");if((settings.articlepopover.phoneSharingInTopBar!=null&&settings.articlepopover.phoneSharingInTopBar=="true")){a.topBarMenu.hide();if(screen.width<340){a.topBarContainer.setZIndex(1000);console.log(a.topBarContainer);a.topBarShare.hide();a.topBarShareButton.show();a.addShareButtonListener();a.topBarShare.setMargin("0, 0, 10, 0");a.topBarShareDropdown.add(a.topBarShare);a.topBarShare.show()}else{a.topBarShare.show()}}a.topBarMenuPadding=a.topBar.getComponent("topBarMenuPadding");a.topBarTextControls=a.topBar.getComponent("textControl");a.closeButton=a.topBarContainer.getComponent("closeButton");a.setCloseButtonListener();a.readAloudControls=a.topBar.getComponent("readAloudControls");a.topBarPrint=a.topBar.getComponent("topBarPrint");a.copyButton=a.topBar.getComponent("copyButton");a.copyButtonPadding=a.topBar.getComponent("copyButtonPadding");a.interactiveContent=a.topBar.getComponent("interactiveContent");a.topBarComic=a.interactiveContent.getComponent("topBarComic");a.topBarPuzzle=a.interactiveContent.getComponent("topBarPuzzle");a.topBarTranslate=a.topBar.getComponent("topBarTranslate");a.topBarSelectText=a.topBar.getComponent("topBarSelectText");a.topBarSelectTextPadding=a.topBar.getComponent("topBarSelectTextPadding");a.ttsToggle=a.topBar.getComponent("ttsControl");a.bottomNavContainer=a.getComponent("bottomNav");if(settings.articlepopover.bottomBarColor!=null){a.bottomNavContainer.setStyle({backgroundColor:"#"+settings.articlepopover.bottomBarColor,color:"#"+settings.articlepopover.bottomFontColor})}a.previousArticleButton=a.bottomNavContainer.getComponent("previousArticleButton");a.nextArticleButton=a.bottomNavContainer.getComponent("nextArticleButton");a.articleText=a.bottomNavContainer.getComponent("articleText");a.advertTop=a.getComponent("advertTop");a.advertBottom=a.getComponent("advertBottom");a.setMenuListener();a.setComicPuzzleListener();a.setTranslateListener();a.setCopyButtonListener();a.setupTextHighlight();a.setupPrint();a.setNextButtonListener();a.setPreviousButtonListener();a.setupReadAloud();a.setTtsToggleListener();a.setupTextResize();a.checkAdvert();a.checkJustification();a.setArticleTextListeners();a.inappTrans=a.topBar.getComponent("inappTranslate");a.inappTrans.hide();var b=a.getComponent("bottomNav");a.previousArticleButton=b.getComponent("previousArticleButton");a.nextArticleButton=b.getComponent("nextArticleButton");a.articleText=b.getComponent("articleText");a.nextArticleText=a.nextArticleButton.getComponent("nextArticle");a.previousArticleText=a.previousArticleButton.getComponent("previousArticle");a.setArticlePopoverText();if(a.articleReader!=null){a.fireEvent("initializeArticlePopover",a);a.ttsToggle.hide()}else{if(a.config.isLive==null){a.fireEvent("initialized",a)}else{if(a.config.articles==null){a.fireEvent("initializeLivePopover",a);a.ttsToggle.hide()}else{a.fireEvent("initializeLivePopover",a,a.config.articles)}}}a.orientation=a.returnOrientation();a.hideTopBar();if(settings.newsday!=null){a.addCls("popUp");a.topBarPrint.hide();a.topBarMenu.hide();if(settings.newsday.useFontAwesome=="true"){a.prevIcon=a.previousArticleButton.getComponent("prev");if(a.prevIcon!=null){a.prevIcon.setHtml('<i class="fa fa-angle-left fa-lg" style="position:relative;top:-1px;margin:2px;" aria-hidden="true"></i>')}a.nextIcon=a.nextArticleButton.getComponent("next");if(a.nextIcon!=null){a.nextIcon.setHtml('<i class="fa fa-angle-right fa-lg" style="position:relative;top:-1px;margin:2px;" aria-hidden="true"></i>')}}if(settings.newsday.useNewsdayPopover!=null){if(settings.newsday.useNewsdayPopover=="true"){if(settings.reader.overlayTitleBarColour!=null){a.topBarContainer.setStyle({backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+",0.9)"})}a.closeButton.removeAll();var d=Ext.create("Ext.Container",{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:'<img src="resources/images/article-close-btn-white.png" style="width:26px;" />'});a.closeButton.add(d);a.closeButton.setPadding("5px 7px 10px 7px");if(settings.topbar.color!=null){a.closeButton.setStyle({color:"#"+settings.topbar.color})}a.closeButton.setPadding("12px 10px");a.topBar.insert(0,a.closeButton);a.topBarTextControls.hide()}}if(settings.newsday.hideShareIcons!=null){if(settings.newsday.hideShareIcons=="true"){a.topBarShare.hide()}}}mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},setArticleTextListeners:function(){var b=this;if(!!settings&&!!settings.articlepopover&&settings.articlepopover.enableFullscreen=="true"&&!!settings.menu&&settings.menu.hideArticles!="true"){b.articleText.element.on("tap",function(){b.fireEvent("viewallarticles",b)});if(InfinityMobile.controller.ReaderController.isNewPWA()){var a=!!language&&!!language.articlePopover&&!!language.articlePopover.viewAllArticles?language.articlePopover.viewAllArticles:"View All Articles";b.articleText.setHtml(a)}}},hideTopBar:function(){var a=this;if(settings.articlepopover.hideArticleControls!=null&&settings.articlepopover.hideArticleControls.toLowerCase()=="true"){a.topBarTextControls.hide();a.bottomNavContainer.hide();a.copyButton.hide();a.topBarSelectText.hide();a.topBarPrint.hide();a.topBarTextControls.hide();a.topBarMenu.hide();a.topBarTranslate.hide();a.ttsToggle.hide()}else{if(settings.articlepopover.disableArticleCarousel!=null&&settings.articlepopover.disableArticleCarousel.toLowerCase()=="true"){a.bottomNavContainer.hide()}}},addShareButtonListener:function(){var a=this;a.topBarShareButton.element.on("tap",function(b){b.preventDefault();b.stopPropagation();if(a.topBarShareDropdown.getHidden()){a.topBarShareDropdown.show()}else{a.topBarShareDropdown.hide()}});a.content.element.on("touchstart",function(b){b.preventDefault();b.stopPropagation();if(!a.topBarShareDropdown.getHidden()){a.topBarShareDropdown.hide()}})},setArticlePopoverText:function(){var a=this;if(language.articlePopover!=null){if(language.next){a.nextArticleText.setHtml(language.next)}if(language.previous){a.previousArticleText.setHtml(language.previous)}}},setupTextResize:function(){var a=this;if(settings.articlepopover.textResize!="true"){a.topBarTextControls.hide()}else{a.topBarTextControls.show()}},setupPrint:function(){var a=this;if(settings.articlepopover.print=="true"&&(!(Ext.os.is.Android&&Ext.browser.is.Firefox)&&(navigator.userAgent.indexOf("EdgiOS")==-1))){a.topBarPrint.show();a.topBarPrint.element.on({tap:a.print,scope:a})}else{a.topBarPrint.hide()}},setupTextHighlight:function(){var a=this;if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){a.topBarSelectText.hide();a.topBarSelectTextPadding.hide()}else{if(settings.articlepopover.articleHighlight=="true"){a.topBarSelectText.show();a.topBarSelectTextPadding.show();a.topBarSelectText.element.on("tap",function(){a.fireEvent("selectTextMode",a)})}else{a.topBarSelectText.hide();a.topBarSelectTextPadding.hide()}}},setupReadAloud:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined&&settings.articlepopover.readAloud!=null){a.ttsToggle.show()}else{a.ttsToggle.hide()}},setComicPuzzleListener:function(){var a=this;a.topBarComic.element.on("tap",function(b){b.preventDefault();a.fireEvent("jumpToComics",a)});a.topBarPuzzle.element.on("tap",function(b){b.preventDefault();a.fireEvent("jumpToPuzzles",a)})},setCopyButtonListener:function(){var a=this;if(!(document.queryCommandSupported&&document.queryCommandSupported("copy"))||settings.articlepopover.copy!="true"){a.copyButton.hide();a.copyButtonPadding.hide()}else{a.copyButton.show();a.copyButton.element.on({tap:function(){a.fireEvent("copyToClipboard","popover")}})}},setMenuListener:function(){var a=this;if(settings.sharing==null&&!a.hasComics&&!a.hasPuzzles){a.topBarMenu.hide();a.topBarMenuPadding.hide()}else{a.topBarMenu.element.on({ta}})}},hexToRg},setArticleWidt},setCloseButtonListene},onBeforeUnload:function(){},setPreviousButtonListener:function(){var a=this;a.previousArticleButton.element.on("tap",function(b){b.preventDefault();b.stopPropagation();a.fireEvent("previous")})},setNextButtonListener:function(){var a=this;a.nextArticleButton.element.on("tap})},setAppTranslateListene},tap:function(){var a=this;if(a.returnOrientation()!=a.orientation){a.fireEvent("closeAndReset",a,a.returnOrientation())}else{a.fireEvent("close",a)}},setShareListener:function(){},share:function(){var a=this;a.fireEvent("sharepopup",a)},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},setTtsToggleListener:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined){a.ttsToggle.element.on({tap:function(){a.fireEvent("readAloudMode",a)}})}},setTranslateListener:function(){var a=this;if(settings.articlepopover.translate!=null){a.topBarTranslate.show();a.topBarTranslate.element.on({ta}})}else{a.topBarTranslate.hide()}},print:function(b){var a=this;b.preventDefault();if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){mainPanel.fireEvent("printArticleTemplate")}else{mainPanel.fireEvent("articlePrint",a);a.fireEvent("articlePrint",a)}},checkAdvert:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;if(a!=null&&a.advertInArticleFlow=="false"){if(a.position=="top"){b.advertBottom.hide();b.setupAdvert(b.advertTop)}else{b.advertTop.hide();b.setupAdvert(b.advertBottom)}}else{b.advertTop.hide();b.advertBottom.hide()}}else{b.advertTop.hide();b.advertBottom.hide()}},setupAdvert:function(b){var c=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;c.advert=b;switch(a.type){case"dfp":c.setupDfpAdvert(b,a);break;case"image":c.setupImageAdvert(b,a);break}}},setupDfpAdvert:function(b,a){var c=this;c.networkCode=a.networkCode;c.adUnit=a.adUnit;c.advertHolder=Ext.create("Ext.Container");b.add(c.advertHolder);c.advertDivID=c.advertHolder.id+"advert";c.advertHolder.setHtml("<div id='"+c.advertDivID+"' style='height:90px;text-align:center;padding:5px;'></div>");c.on("painted",c.loadDfpAdvert)},setupImageAdvert:function(b,a){var c=this;if(a!=null){b.setHtml("<img src='"+a.url+"' style='margin:auto;display:block;margin-top:5px;max-width:100%;max-height:100%;' />");b.element.on("tap",function(){window.open(a.link)})}},loadDfpAdvert:function(){var a=this;googletag.cmd.push(function(){a.adslot=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("320"),parseInt("50")],a.advertDivID).addService(googletag.pubads().updateCorrelator());if(settings.reader.popupAdvert.targeting!=null&&settings.reader.bannerAd.targeting.length>0){var b=settings.reader.popupAdvert.targeting.split("|");for(var d in b){var e=b[d];var c=e.split("*");if(c!=null&&c.length>=2){a.adslot.setTargeting(c[0],c[1])}}}googletag.enableServices();googletag.display(a.advertDivID)})},refreshAdvert:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;if(a.type=="dfp"){b.advert.removeAll(true,true);if(b.refreshTimeout!=null){clearTimeout(b.refreshTimeout)}b.refreshTimeout=setTimeout(function(){b.checkAdvert();b.loadDfpAdvert()},1000)}}},checkJustification:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right");a.topBar.getLayout().setPack("end");a.closeButton.setRight("");a.closeButton.setLeft(0);a.topBar.remove(a.topBarMenu,false);a.topBar.add(a.topBarMenu)}},destroy:function(){var a=this;mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);Ext.Container.prototype.destroy.apply(this,arguments)}},0,["articleview"],["component","container","articleview"],{component:true,container:true,articleview:true},["widget.articleview"],0,[InfinityMobile.view.phone,"ReaderArticlePopover"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderWhatsNew",InfinityMobile.view.Overlay,{config:{width:700,height:700,style:"padding:0px;",layout:"vbox",items:[{itemId:"toolbar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>What's New</b>"},{itemId:"toolbarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",flex:1,margin:20,layout:"vbox",scrollable:{direction:"vertical",directionLock:true},items:[{html:"<iframe src='whatsnew.html' style='width:100%; border:none; pointer-events: none;' onload='javascript:resizeIframe(this);' />"}]}]},initializ},setCloseListener:function(){var a=this;a.toolbarClose.element.on("tap",function(){a.hide()})}},0,["whatsnew"],["component","container","panel","overlay","whatsnew"],{component:true,container:true,panel:true,overlay:true,whatsnew:true},["widget.whatsnew"],0,[InfinityMobile.view.tablet,"ReaderWhatsNew"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderWhatsNew",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{itemId:"toolbar",height:40,style:";border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>What's New</b>"},{itemId:"toolbarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",flex:1,margin:20,layout:"vbox",scrollable:{direction:"vertical",directionLock:true},items:[{html:"<iframe src='whatsnew.html' style='width:100%; border:none; pointer-events: none;' onload='javascript:resizeIframe(this);' />"}]}]},initializ},setCloseListener:function(){var a=this;a.toolbarClose.element.on("tap",function(){a.hide()})}},0,["whatsnew"],["component","container","panel","overlay","whatsnew"],{component:true,container:true,panel:true,overlay:true,whatsnew:true},["widget.whatsnew"],0,[InfinityMobile.view.phone,"ReaderWhatsNew"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.Interstitial",Ext.Container,{config:{cls:"innerhtmlfullheight",style:"padding:0px;",modal:true,hideOnMaskTap:true,centered:true,items:[{itemId:"advert",cls:"advert"}]},initialize:function(){var c=this;c.iframeLoaded=false;c.advertContainer=c.getComponent("advert");if(currentProfile=="tablet"){c.closeBtn=Ext.create("Ext.Container",{id:"closebtn",top:-30,right:-30,width:100,height:100,padding:"10 10 50 50",items:[{html:'<img src="../assets/interstitial/interstitial-close-btn.png" style="width:40px;height:40px" />'}],cls:"backgroundImage"})}else{var a=typeof language!="undefined"&&language.close!=null&&language.close.trim()!=""?language.close:"Close";c.closeBtn=Ext.create("Ext.Container",{top:-30,right:0,layout:"hbox",items:[{html:a,style:"color:white;font-size:14px;padding-top:2px;padding-right:2px;"},{html:'<img src="resources/images/reader icons/close-white.png" style="width:16px;height:14px" />'}]})}var d=typeof language!="undefined"&&language.advertisement!=null&&language.advertisement.trim()!=""?language.advertisement.toUpperCase():"ADVERTISEMENT";var e=Ext.create("Ext.Container",{top:-30,left:"50%",html:d,style:"color:white;text-align:center;transform:translateX(-50%);"});c.add(e);c.add(c.closeBtn);c.closeBtn.element.on({tap:"closetap",scope:c});var b=settings.reader.interstitial;if(b.type.toLowerCase()=="url"){c.setupUrlInterstitial(b)}else{if(b.type.toLowerCase()=="image"){c.setInterstitialImage(b)}else{c.setupDFPInterstitial(b)}}if(currentProfile=="desktop"){c.keyDownFunc=window.onkeydown;window.onkeydown=null}else{}},setupDFPInterstitial:function(a){var b=this;if(settings.reader.interstitial.isFullScreen!=null&&settings.reader.interstitial.isFullScreen=="fullscreen"){b.setupDFPInterstitialFullscreen(a)}else{b.setupDFPInterstitialPopup(a)}},setupDFPInterstitialPopup:function(a){var b=this;b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";b.advertContainer.setHtml("<div id='"+b.advertDivID+"' style='height:100%;max-width: 70%'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.on("painted",b.loadAdvert,b,{delay:10,single:true});Ext.Viewport.on({resize:function(){b.resizeDfpAdvert(b.iframe,b.thisFrameContent)},scope:b})},setupDFPInterstitialFullscreen:function(c){var e=this;e.setHideOnMaskTap(false);e.closeBtn.hide();var d=c.networkCode;var a=c.adUnit;var b="resources/webpages/interstitial.aspx?nc="+d+"&au="+a+"&device="+currentProfile+"&pguid="+publicationguid;e.setCls("interstitialoverlayphonefullscreen");e.advertContainer.setHtml("<iframe style='border:none;width:100vw;height:100vh;' scrolling='no' src='"+b+"' />");e.iframe=e.advertContainer.element.down("iframe").dom;closeAdvertFrame=function(){e.hide()};if(currentProfile=="desktop"){e.keyDownFunc=window.onkeydown;window.onkeydown=null}},setupUrlInterstitial:function(a){var b=this;if(settings.reader.interstitial.isFullScreen!=null&&settings.reader.interstitial.isFullScreen=="fullscreen"){b.setupUrlInterstitialFullscreen(a)}else{b.setupUrlInterstitialPopup(a)}if(settings.reader.interstitial.onlyShowWhenLoaded!=null&&settings.reader.interstitial.onlyShowWhenLoaded=="true"){b.setHidden(true)}showAdvertFrame=function(){b.setHidden(false)};closeAdvertFrame=function(){b.hide()}},setupUrlInterstitialPopup:function(b){var c=this;closeAdvertFrame=function(){c.hide()};showAdvertFrame=function(){};if(currentProfile=="desktop"){var a=settings.reader.interstitial.landscapeUrl}else{var a=settings.reader.interstitial.portraitUrl}c.advertContainer.setHtml("<iframe style='border:none;' scrolling='no' src='"+a+"' />");c.iframe=c.advertContainer.element.down("iframe").dom;c.iframe.onload=function(){c.thisFrameContent=c.iframe.contentDocument||c.iframe.contentWindow.document;c.getIframeDimensions(c.iframe,c.thisFrameContent)};Ext.Viewport.on({resize:c.resizeUrlAdvert,scope:c})},setupUrlInterstitialFullscreen:function(b){var c=this;var a=settings.reader.interstitial.portraitUrl;c.setCls("interstitialoverlayphonefullscreen");c.advertContainer.setHtml("<iframe style='border:none;width:100vw;height:100vh;' scrolling='no' src='"+a+"' />");c.iframe=c.advertContainer.element.down("iframe").dom},resizeUrlAdvert:function(){var a=this;a.getIframeDimensions(a.iframe,a.thisFrameContent)},getIframeDimensions:function(e,c){var f=this;var d=$(c).width();var a=$(c).height();if(a>$(window).height()-140){var h=a;a=$(window).height()-140;var g=a/h;d=d*g}if(d>$(window).width()-40){var b=d;d=$(window).width()-40;var g=d/b;a=a*g}f.setIframeDimensions(e,d,a)},setIframeDimensions:function(c,b,a){c.style.width=b+"px";c.style.height=a+"px"},setInterstitialImage:function(c){var d=this;d.advertDivID=d.id+"advert";var b=c.url;var a=c.portraitUrl;if(b==""){b=a}if(a==""){a=b}if(currentProfile=="desktop"||b==a){d.setStyle({top:"10px"});d.advertContainer.setHtml("<img style='max-width:70vw;max-height:70vh;display:block' src='"+b+"' />")}else{d.advertContainer.setHtml("<img class='mobileInterstitialImage portraitimage' style='max-width:75vw;max-height:75vh;display:block' src='"+a+"' /><img class='mobileInterstitialImage landscapeimage' style='max-width:75vw;max-height:75vh;display:block' src='"+b+"' />")}if(c.link!=null){if(c.link.length>0){d.advertContainer.addCls("pointerCursor");d.advertContainer.element.on({tap:function(){window.open(c.link,"_blank");mainPanel.fireEvent("trackAdvertClick","interstitial")}})}}},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},onResizeF},loadAdvert:function(){var f=this;try{var e=settings.reader.interstitial;var d=e!=null&&e.adSize!=null?e.adSize.split(",")[0]:768;var a=e!=null&&e.adSize!=null?e.adSize.split(",")[1]:1024}catch(c){var d=768;var a=1024}googletag.cmd.push(function(){f.adSlot1=googletag.defineSlot("/"+f.networkCode+"/"+f.adUnit,[parseInt(d),parseInt(a)],f.advertDivID);f.adSlot1.addService(googletag.pubads().updateCorrelator());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(f.advertDivID)});function b(h){var k=h.slot;if(k===f.adSlot1&&!f.iframeLoaded){var j=$(f.element.dom).find("iframe");if(j[0]!=null){try{googletag.pubads().removeEventListener("slotRenderEnded",b);f.iframe=j[0];f.thisFrameContent=f.iframe.contentDocument||f.iframe.contentWindow.document;f.iframeLoaded=true;f.resizeDfpAdvert(f.iframe,f.thisFrameContent)}catch(g){console.warn("[Interstitial] Error Caught:\n\t",g)}}}}if(!f.iframeLoaded){try{googletag.pubads().addEventListener("slotRenderEnded",b)}catch(c){console.warn("[Interstitial] Error Caught:\n\t",c)}}},resizeDfpAdvert:function(f,k){var g=this;var c=$(f).width();var j=$(f).height()+30;var e=1;var b=0;var h=20;if(currentProfile=="desktop"){h=40}var a=$(window).height()-20;var d=$(window).width()-h;if(j>a){e=a/j}if(c*e>d){e=d/(c);b=-((c-d)*0.5-(h/2))}else{if(c>d){b=-((c-d)*0.5)}}g.setDfpScale(e,b)},setDfpScale:function(c,b){var a=this;if(!Ext.browser.is.Firefox&&!Ext.browser.is.IE){a.element.dom.style.webkitTransformOrigin="center";a.element.dom.style.mozTransformOrigin="center";a.element.dom.style.msTransformOrigin="center";a.element.dom.style.transformOrigin="center";a.element.dom.style.webkitTransform="translate3d("+b+"px, "+((c*30)+5)+"px, 0px) scale3d("+c+", "+c+", 1)";a.element.dom.style.msTransform="translate3d("+b+"px, "+((c*30)+5)+"px, 0px) scale3d("+c+", "+c+", 1)";a.element.dom.style.moztransform="translate3d("+b+"px, "+((c*30)+5)+"px, 0px) scale3d("+c+", "+c+", 1)";a.element.dom.style.transform="translate3d("+b+"px, "+((c*30)+5)+"px, 0px) scale3d("+c+", "+c+", 1)"}else{a.element.dom.style.webkitTransform="scale3d("+c+", "+c+", 1)";a.element.dom.style.msTransform="scale3d("+c+", "+c+", 1)";a.element.dom.style.moztransform="scale3d("+c+", "+c+", 1)";a.element.dom.style.transform=" scale3d("+c+", "+c+", 1)"}},closeta},hide:function(){var a=this;if(a.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([a.adSlot1])}if(currentProfile=="desktop"){window.onkeydown=a.keyDownFunc}Ext.Container.prototype.hide.apply(this,arguments);Ext.Viewport.remove(a,true)}},0,["interstitial"],["component","container","interstitial"],{component:true,container:true,interstitial:true},["widget.interstitial"],0,[InfinityMobile.view.tablet,"Interstitial"],0));(Ext.cmd.derive("InfinityMobile.view.phone.Interstitial",Ext.Container,{config:{fullscreen:true,cls:"interstitialoverlayphone",layout:"fit",style:"padding:0px;max-height:100%",modal:true,hideOnMaskTap:true,centered:true,items:[{itemId:"advertLand",cls:"advert",layout:"fit"}]},initialize:function(){var b=this;b.advertContainer=b.getComponent("advertLand");b.advertContainerPortrait=b.getComponent("advertPortrait");b.closeBtn=Ext.create("Ext.Container",{id:"closebtn",top:0,right:0,width:100,height:100,padding:"10 10 50 50",items:[{html:'<img src="../assets/interstitial/interstitial-close-btn.png" style="width:40px;height:40px" />'}],cls:"backgroundImage"});b.add(b.closeBtn);b.closeBtn.element.on({tap:"closetap",scope:b});var a=settings.reader.interstitial;if(a.type.toLowerCase()=="url"){b.setupUrlInterstitial(a)}else{if(a.type.toLowerCase()=="image"){b.setInterstitialImage(a)}else{b.setupDFPInterstitial(a)}}},setupDFPInterstitial:function(a){var b=this;if(settings.reader.interstitial.isFullScreen!=null&&settings.reader.interstitial.isFullScreen=="fullscreen"){b.setupDFPInterstitialFullscreen(a)}else{b.setupDFPInterstitialPopup(a)}},setupDFPInterstitialPopup:function(a){var b=this;b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";b.advertContainer.setHtml("<div id='"+b.advertDivID+"' style='height:100%;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.on("painted",b.loadAdvert,b,{delay:10,single:true});Ext.Viewport.on({resize:function(){b.resizeDfpAdvert(b.iframe,b.thisFrameContent)},scope:b})},setupDFPInterstitialFullscreen:function(c){var e=this;e.setHideOnMaskTap(false);e.closeBtn.hide();var d=c.networkCode;var a=c.adUnit;var b="resources/webpages/interstitial.aspx?nc="+d+"&au="+a+"&device="+currentProfile+"&pguid="+publicationguid;e.setCls("interstitialoverlayphonefullscreen");e.advertContainer.setHtml("<iframe style='border:none;width:100vw;height:100vh;' scrolling='no' src='"+b+"' />");e.iframe=e.advertContainer.element.down("iframe").dom;closeAdvertFrame=function(){e.hide()}},setupUrlInterstitial:function(a){var b=this;if(settings.reader.interstitial.isFullScreen!=null&&settings.reader.interstitial.isFullScreen=="fullscreen"){b.setupUrlInterstitialFullscreen(a)}else{b.setupUrlInterstitialPopup(a)}if(settings.reader.interstitial.onlyShowWhenLoaded!=null&&settings.reader.interstitial.onlyShowWhenLoaded=="true"){b.setHidden(true)}showAdvertFrame=function(){b.setHidden(false)};closeAdvertFrame=function(){b.hide()}},setupUrlInterstitialPopup:function(b){var c=this;var a=settings.reader.interstitial.portraitUrl;c.advertContainer.setHtml("<iframe style='border:none;' scrolling='no' src='"+a+"' />");c.iframe=c.advertContainer.element.down("iframe").dom;c.iframe.onloa};Ext.Viewport.on({resize:c.resizeUrlAdvert,scope:c})},setupUrlInterstitialFullscreen:function(b){var c=this;var a=settings.reader.interstitial.portraitUrl;c.setCls("interstitialoverlayphonefullscreen");c.advertContainer.setHtml("<iframe style='border:none;width:100vw;height:100vh;' scrolling='no' src='"+a+"' />");c.iframe=c.advertContainer.element.down("iframe").dom;closeAdvertFrame=function(){c.hide()}},resizeUrlAdver},getIframeDimensions:function(e,c){var f=this;var d=$(c).width();var a=$(c).height();if(a>$(window).height()-140){var h=a;a=$(window).height()-140;var g=a/h;d=d*g}if(d>$(window).width()-40){var b=d;d=$(window).width()-40;var g=d/b;a=a*g}f.setIframeDimensions(e,d,a)},setIframeDimensions:function(c,b,a){c.style.width=b+"px";c.style.height=a+"px"},setInterstitialImage:function(c){var d=this;var b=c.url;var a=c.portraitUrl;if(b==""){b=a}if(a==""){a=b}if(b==a){d.advertContainer.setHtml("<img style='max-width:100vw;max-height:100vh;display:block' src='"+b+"' />")}else{d.advertContainer.setHtml("<img class='mobileInterstitialImage portraitimage' style='max-width:100vw;max-height:100vh;display:block' src='"+a+"' /><img class='mobileInterstitialImage landscapeimage' style='max-width:100vw;max-height:100vh;display:block' src='"+b+"' />")}if(c.link!=null){if(c.link.length>0){d.advertContainer.addCls("pointerCursor");d.advertContainer.element.on({tap:function(){window.open(c.link,"_blank");mainPanel.fireEvent("trackAdvertClick","interstitial")}})}}},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},onResizeF},loadAdvert:function(){var e=this;try{var d=settings.reader.interstitial;var c=d!=null&&d.adSize!=null?d.adSize.split(",")[0]:320;var a=d!=null&&d.adSize!=null?d.adSize.split(",")[1]:480}catch(b){var c=320;var a=480}googletag.cmd.push(function(){e.adSlot1=googletag.defineSlot("/"+e.networkCode+"/"+e.adUnit,[parseInt(c),parseInt(a)],e.advertDivID);e.adSlot1.addService(googletag.pubads().updateCorrelator());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(e.advertDivID)});var f=$(e.element.dom).find("iframe");if(f[0]!=null){e.iframe=f[0];e.thisFrameContent=e.iframe.contentDocument||e.iframe.contentWindow.document;e.resizeDfpAdvert(e.iframe,e.thisFrameContent)}},resizeDfpAdvert:function(f,k){var g=this;var c=$(f).width();var j=$(f).height();var e=1;var b=0;var h=20;var a=$(window).height();var d=$(window).width()-h;if(j>a){e=a/j}if(c*e>d){e=d/(c);console.log(d,c);b=-((c-d)*0.5-(h/2))}else{if(c>d){b=-((c-d)*0.5)}}g.setDfpScale(e,b)},setDfpScale:function(c,b){var a=this;a.element.dom.style.transformOrigin="center top";a.element.dom.style.transform="translate3d("+b+"px, "+0+"px, 0px) scale3d("+c+", "+c+", 1)"},closetap:function(){var a=this;a.fireEvent("closeInterstitial",a);a.hide()},hide:function(){var a=this;if(a.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([a.adSlot1])}Ext.Container.prototype.hide.apply(this,arguments);Ext.Viewport.remove(a,true)}},0,["interstitial"],["component","container","interstitial"],{component:true,container:true,interstitial:true},["widget.interstitial"],0,[InfinityMobile.view.phone,"Interstitial"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticlePopoverAd",Ext.Panel,{config:{style:"padding:0px",items:[{itemId:"advert",cls:"advert"}]},initializ},loadAdvert:function(){var a=this;console.log("Loading Ad 320x50");googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("320"),parseInt("50")],a.advertDivID);b.addService(googletag.pubads().updateCorrelator());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})},onResizeF}},0,["articlePopoverAd"],["component","container","panel","articlePopoverAd"],{component:true,container:true,panel:true,articlePopoverAd:true},["widget.articlePopoverAd"],0,[InfinityMobile.view.phone,"ArticlePopoverAd"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ArticlePopoverInterstitial",Ext.Panel,{config:{style:"padding:0px",items:[{itemId:"advert",cls:"advert",style:"position:relative; top:50%; transform: translateY(-50%);"}]},initialize:function(){var f=this;f.destroyed=false;f.advertTimeout=1000;f.loaded=false;f.advertContainer=f.getComponent("advert");var a=settings.newsday.articlePopoverInterstitial;if(a!=null){f.width="768";if(a.width!=null){f.width=a.width}f.height="1024";if(a.height!=null){f.height=a.height}if(a.type==null||a.type=="dfp"){f.networkCode=a.networkCode;f.adUnit=a.adUnit;f.advertDivID=f.id+"advert";f.advertContainer.setHtml("<div style='text-align:center;height:100%'><div id='"+f.advertDivID+"' class='interstitialAdvertTablet' style='display:inline-block;height:100%;margin-left:0;margin-right:0;'></div></div>");f.advertDiv=f.element.down("#"+f.advertDivID);f.advertDiv.dom.style.visibility="hidden";f.on("painted",f.loadAdvert,f,{delay:10,single:true});f.on("resize",f.onResizeFn,f)}else{if(a.type.indexOf("custom|")>=0){var e=a.type.replace("custom|","");var d=a.type.split("|");var e=d[1];var b=d[2];f.advertContainer.element.dom.style.textAlign="center";var c=function(){if(f.advertContainer.element.dom&&window[e]!=null){f.customBannerAd=new window[e](f.id+"article-interstitial",f.advertContainer.element.dom,currentProfile,a.config);f.customBannerAd.loadAdvert()}};if(a.config==null){f.ajaxRequest=$.ajax({url:b+(b.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(g){f.hasConfig=true;console.log(g);settings.newsday.articlePopoverInterstitial.config=g;if(!f.destroyed){c()}}})}else{c()}}else{f.url=a.url;f.advertContainer.setHtml("<div style='text-align:center;height:100%'><div id='"+f.advertDivID+"' class='interstitialAdvertDesktop' style='display:inline-block;height:100%;margin-left:0;margin-right:0;'><iframe src='"+f.url+"' style='border:none;height:"+f.height+"px' /></div></div>")}}}},frameTouchStart:function(b){var a=this;a.articleCarousel=a.returnArticleCarousel();a.articleCarousel.frameDragStart(b)},frameTouchMove:function(b){var a=this;a.articleCarousel.frameDrag(b)},frameTouchEnd:function(b){var a=this;a.articleCarousel.frameDragEnd(b)},returnArticleCarousel:function(){var a=this;return a.parent},loadAdvert:function(){var a=this;if(!a.loaded){setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt(a.width),parseInt(a.height)],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)});a.setTouchEvents();a.onResizeFn(a);a.advertDiv.dom.style.visibility=""}},a.advertTimeout)}a.loaded=true},setTouchEvent},onResizeFn:function(){var b=this;if(b.advertDiv.down("iframe")!=null){var a=b.advertDiv.down("iframe").dom;b.fireEvent("scaleInterstitial",a,b.advertDiv.dom,b)}},destroy:function(){var a=this;a.destroyed=true;Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["articlePopoverInterstitial"],["component","container","panel","articlePopoverInterstitial"],{component:true,container:true,panel:true,articlePopoverInterstitial:true},["widget.articlePopoverInterstitial"],0,[InfinityMobile.view.tablet,"ArticlePopoverInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticlePopoverInterstitial",Ext.Panel,{config:{style:"padding:0px",items:[{itemId:"advert",cls:"advert",style:"position:relative; top:50%; transform: translateY(-50%);"}]},initialize:function(){var f=this;f.destroyed=false;f.advertTimeout=1000;f.loaded=false;f.advertContainer=f.getComponent("advert");var a=settings.newsday.articlePopoverInterstitial;if(a!=null){f.width="320";if(a.width!=null){f.width=a.width}f.height="480";if(a.height!=null){f.height=a.height}if(a.type==null||a.type=="dfp"){f.networkCode=a.networkCode;f.adUnit=a.adUnit;f.advertDivID=f.id+"advert";f.advertContainer.setHtml("<div style='text-align:center;height:100%'><div id='"+f.advertDivID+"' class='interstitialAdvertPhone' style='display:inline-block;height:100%;'></div></div>");f.advertDiv=f.element.down("#"+f.advertDivID);f.advertDiv.dom.style.visibility="hidden";f.on("painted",f.loadAdvert,f,{delay:10,single:true});f.on("resize",f.onResizeFn,f)}else{if(a.type.indexOf("custom|")>=0){var d=a.type.split("|");var e=d[1];var b=d[2];f.advertContainer.element.dom.style.textAlign="center";var c=function(){if(f.advertContainer.element.dom&&window[e]!=null){f.customBannerAd=new window[e](f.id+"article-interstitial",f.advertContainer.element.dom,currentProfile,a.config);f.customBannerAd.loadAdvert()}};if(a.config==null){f.ajaxRequest=$.ajax({url:b+(b.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(g){f.hasConfig=true;console.log(g);settings.newsday.articlePopoverInterstitial.config=g;if(!f.destroyed){c()}}})}else{c()}}else{f.url=a.url;f.advertContainer.setHtml("<div style='text-align:center;height:100%'><div id='"+f.advertDivID+"' class='interstitialAdvertDesktop' style='display:inline-block;height:100%;margin-left:0;margin-right:0;'><iframe src='"+f.url+"' style='border:none;height:"+f.height+"px' /></div></div>")}}}},loadAdvert:function(){var a=this;if(!a.loaded){setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt(a.width),parseInt(a.height)],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)});a.onResizeFn(a);a.setupTouchListeners();a.advertDiv.dom.style.visibility=""}},a.advertTimeout)}a.loaded=true},setupTouchListeners:function(){var c=this;if(c.advertDiv.down("iframe")!=null){var b=c.advertDiv.down("iframe").dom;var a=b.contentDocument||b.contentWindow.document;a.addEventListener("touchstart});a.addEventListener("touchmove",function(d){c.frameTouchMove(d);d.preventDefault()});a.addEventListener("touchend",function(d){c.frameTouchEnd(d)})}},onResizeFn:function(a){var c=this;if(c.advertDiv.down("iframe")!=null){var b=c.advertDiv.down("iframe").dom;b.onload=function(){c.setupTouchListeners()};c.fireEvent("scaleInterstitial",b,c.advertDiv.dom,c)}},frameTouchStart:function(b){var a=this;a.articleCarousel=a.returnArticleCarousel();a.articleCarousel.frameDragStart(b)},frameTouchMove:function(b){var a=this;a.articleCarousel.frameDrag(b)},frameTouchEnd:function(b){var a=this;a.articleCarousel.frameDragEnd(b)},returnArticleCarousel:function(){var a=this;return a.parent},destroy:function(){var a=this;a.destroyed=true;Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["articlePopoverInterstitial"],["component","container","panel","articlePopoverInterstitial"],{component:true,container:true,panel:true,articlePopoverInterstitial:true},["widget.articlePopoverInterstitial"],0,[InfinityMobile.view.phone,"ArticlePopoverInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderSharePopup",Ext.Container,{config:{fullscreen:true,modal:true,centered:true,height:"100%;",width:"100%;",style:"background-color:white;width:100%;height:100%;",layout:"vbox",items:[{itemId:"titleBar",style:"",html:"<div style='width:100%;padding:5px;'>Share</div>",items:[{itemId:"ToolBarClose",top:5,right:5,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"sharebtns",width:"100%",flex:1}]},initializ},setCloseButtonListener:function(){var b=this;b.toolbarClose.element.on("tap",function(){b.destroy()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolbarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},loadShareButtons:function(){var a=this;a.fireEvent("loadShareIcons",a)},setButton},getURLmedia:function(){if(window.location.href.indexOf("pubid")!=-1){var a=window.location.href.indexOf("pubid");var b=window.location.href.substring(a+6,window.location.length);var c=b.split("&");return"pubid="+c[0]}else{if(window.location.href.indexOf("edid")!=-1){var a=window.location.href.indexOf("edid");var b=window.location.href.substring(a+5,window.location.length);var c=b.split("&");return"edid="+c[0]}}},handleChange:function(){var a=this;a.setButtons()}},0,["sharepopup"],["component","container","sharepopup"],{component:true,container:true,sharepopup:true},["widget.sharepopup"],0,[InfinityMobile.view.phone,"ReaderSharePopup"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderSharePopupItem",Ext.Container,{config:{margin:5,height:30,cls:"sharepopupitem",layout:{type:"vbox",align:"center",pack:"middle"},items:[{itemId:"iconImage",width:30,height:30}]},initializ},setColor:function(){var a=this;a.setStyle({backgroundColor:a.color})},setIco},setArticleLink:function(){var a=this;a.element.on("tap",function(){if(a.articleLink.indexOf("twitter")!=-1&&a.url.indexOf("article_popover")!=-1){var b=a.articleLink.replace("{0}",a.message).replace("{1}",a.url)}else{var b=a.articleLink.replace("{0}",a.url).replace("{1}",a.message)}b=b.replace(/&apos;/g,"'");if(b.indexOf("mailto:")!=-1){var c="http://"+window.location.host+"/infinity/article_popover_share.aspx?guid=";a.fireEvent("emailArticleShare",b,c,a.articleguid)}else{a.fireEvent("trackArticleShare",b,c,a.articleguid);window.open(b)}})}},0,["sharepopupitem"],["component","container","sharepopupitem"],{component:true,container:true,sharepopupitem:true},["widget.sharepopupitem"],0,[InfinityMobile.view.phone,"ReaderSharePopupItem"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderBannerAd",Ext.Container,{config:{width:"100%",height:110,padding:10,style:"transition: height 1s;",layout:{type:"hbox",align:"center",pack:"middle"}},statics:{hasAutoRefreshSetting:function(){return InfinityMobile.controller.ReaderController.hasAutoRefreshSettingForBannerAd()}},initialize:function(){var a=this;a.canLoadDFPAdvert=false;a.loadDFPAdvertOnPainted=false;a.bannerAd=a.getComponent("bannerAd");if(a.config.pageNumber!=null){a.pageNumber=a.config.pageNumber}if(a.config.section!=null){a.section=a.config.section}a.position=settings.reader.bannerAd.position;a.canBeClosed=settings.reader.bannerAd.canBeClosed;if(settings.reader.bannerAd.collapseAdOnFail=="true"){if(typeof googletag!="undefined"&&googletag.pubads!=null){googletag.pubads().addEventListener("slotRenderEnded",function(b){if(a.adslot==b.slot){if(b.isEmpty){a.hide();console.log("ERROR: No creative has been served.")}else{a.show()}}})}else{setTimeout(function(){a.hide()},1000)}}a.on("painted",a.setCanLoadDFPAdvert,a,{delay:10,single:true})},setTargeting:function(a){var b=this;b.targeting=a},setCanLoadDFPAdvert:function(){var a=this;a.canLoadDFPAdvert=true;if(a.loadDFPAdvertOnPainted){a.loadDFPAdvert()}},loadAdvert:function(){var h=this;var g=settings.reader.bannerAd.refreshViaPostMessage=="true";var f=h.getItems().items.length;if(f>0&&!g){h.destroyAdvert()}if(h.isCustomAd()&&!h.hasAddedBannerDiv){h.hasAddedBannerDiv=true;h.add({itemId:"bannerAd",cls:"readerBannerAd"})}f=h.getItems().items.length;if((f==0)&&!h.isCustomAd()){h.add({itemId:"bannerAd",cls:"readerBannerAd"})}h.bannerAd=h.getComponent("bannerAd");if(settings.reader.bannerAd!=null){var e=settings.reader.bannerAd.type.toLowerCase();if(e.indexOf("custom|")>=0){if(h.customAd==null&&!h.isLoadingConfig){var c=settings.reader.bannerAd.type.split("|");var d=c[1];var a=c[2];var b=function(){h.customAd=new window[d](h.id+"banner-ad",h.bannerAd.element.dom,currentProfile,settings.reader.bannerAd.config);h.customAd.loadAdvert(h.pageNumber,h.section)};if(settings.reader.bannerAd.config==null){h.isLoadingConfig=true;h.ajaxRequest=$.ajax({url:a+(a.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(j){h.hasConfig=true;h.isLoadingConfig=false;console.log(j);settings.reader.bannerAd.config=j;if(!h.isDestroyed){b()}}})}else{b()}}else{if(this.customAd!=null){this.customAd.refreshAdvert(h.pageNumber,h.section)}}}else{switch(e){case"dfp":default:h.setDFPAdvert();break;case"image":h.setImageAdvert();break;case"url":if(h.urlHasBeenSetup&&g){h.postMessageToRefresh()}else{h.setUrlAdvert()}break;case"adbridg":h.setupAdbridg();break}}}},isCustomAd:function(){var c=this;try{if(settings.reader.bannerAd!=null){var b=settings.reader.bannerAd.type.toLowerCase();if(b.indexOf("custom|")>=0){return true}}}catch(a){console.warn("[ReaderBannerAd]: Error Caught",a)}return false},enableCustomAdRefresh:function(){var a=this;if(a.isCustomAd()&&a.customAd!=null){a.customAd.enableRefreshAdvert()}},disableCustomAdRefresh:function(){var a=this;if(a.isCustomAd()&&a.customAd!=null){a.customAd.disableRefreshAdvert()}},destroyAdvert:function(){var b=this;var a="";if(settings.reader.bannerAd!=null){a=settings.reader.bannerAd.type.toLowerCase()}if(a!="dfp"&&settings.reader.bannerAd.refreshViaPostMessage!="true"&&a.indexOf("custom|")==-1&&a!="adbridg"){b.removeAll(true,true)}},destroyAdvert2:function(){var a=this},refreshAdvert:function(b){var c=this;if(!(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.removeDefaultTargeting=="true")){c.adslot.setTargeting("pos",b)}if(c.adslot!=null){c.setDfpTargeting(c.adslot)}try{googletag.pubads().refresh([c.adslot])}catch(a){}},setDFPAdvert:function(){var a=this;a.networkCode=settings.reader.bannerAd.networkCode;a.adUnit=settings.reader.bannerAd.adUnit;a.setupHtmlForBanner();if(a.canLoadDFPAdvert){a.loadDFPAdvert()}else{a.loadDFPAdvertOnPainted=true}},setupHtmlForBanner:function(){var a=this;a.advertDivID=a.bannerAd.id+"advert";if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){a.setUpToggleableBanner();a.bannerAdHolder.setHtml("<div id='"+a.advertDivID+"' style='height:90px;'></div>");a.advertDiv=a.bannerAdHolder.element.down("#"+a.advertDivID);a.loadDFPAdvertOnPainted=true}else{a.bannerAd.setHtml("<div id='"+a.advertDivID+"' style='height:90px;'></div>");a.advertDiv=a.element.down("#"+a.advertDivID)}},setupAdbridg:function(){var a=this;a.setupHtmlForBanner();a.checkAdbridge(a.advertDiv.dom)},checkAdbridge:function(b){var a=this;if(!!b&&(typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.adbridg)){b.setAttribute("data-adbridg-ad-class","adb-ee-728x90")}},setDfpTargeting:function(f){var d=this;if(settings.reader.bannerAd.targeting!=null&&settings.reader.bannerAd.targeting.length>0){var a=settings.reader.bannerAd.targeting.split("|");for(var c in a){var e=a[c];var b=e.split("*");if(b!=null&&b.length>=2){b[1]=b[1].replace("{{PAGE}}",d.pageNumber).replace("{{SECTION}}",d.section);f.setTargeting(b[0],b[1])}}}},loadDFPAdvert:function(){var c=this;var b="top-banner";if(c.targeting!=null){b=c.targeting}if(!c.dfpInit){try{googletag.cmd.push(function(){c.adslot=googletag.defineSlot("/"+c.networkCode+"/"+c.adUnit,[parseInt("728"),parseInt("90")],c.advertDivID).addService(googletag.pubads().updateCorrelator());if(!(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.removeDefaultTargeting=="true")){c.adslot.setTargeting("pos",b)}c.setDfpTargeting(c.adslot);googletag.enableServices();googletag.display(c.advertDivID);c.dfpInit=true;c.startAutoRefresh(b)})}catch(a){console.warn(a)}}else{if(!c.statics().hasAutoRefreshSetting()&&!c.isAutoRefreshing()){c.refreshAdvert(b)}}},startAutoRefresh:function(b){if(!(typeof b!="undefined"&&!!b)){return}var c=this;if(c.isAutoRefreshing()){c.stopAutoRefresh()}if(c.statics().hasAutoRefreshSetting()){var a=parseInt(settings.reader.bannerAd.refreshIntervalDuration);if(isNaN(a)===true||a<15){a=15}a*=1000;c.refreshIntervalTimeoutID=setInterval(function(){c.refreshAdvert(b)},a)}},isAutoRefreshing:function(){var a=this;return"refreshIntervalTimeoutID" in a&&!!a.refreshIntervalTimeoutID},stopAutoRefresh:function(){var a=this;if(a.isAutoRefreshing()){clearInterval(a.refreshIntervalTimeoutID);a.refreshIntervalTimeoutID=null}},pauseAutoRefresh:function(){var a=this;if(a.isAutoRefreshing()){a.autoRefreshPaused=true;a.stopAutoRefresh()}},hasAutoRefreshPaused:function(){var a=this;return"autoRefreshPaused" in a&&!!a.autoRefreshPaused},resumeAutoRefresh:function(){var b=this;if(b.hasAutoRefreshPaused()){b.autoRefreshPaused=false;var a="top-banner";if(b.targeting!=null){a=b.targeting}b.startAutoRefresh(a)}},setImageAdvert:function(){var b=this;var a=b.bannerAd;if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){b.setUpToggleableBanner();a=b.bannerAdHolder}a.setHtml("<img src='"+settings.reader.bannerAd.url+"' />");a.element.on("tap",function(){window.open(settings.reader.bannerAd.link);mainPanel.fireEvent("trackAdvertClick","imageBanner")})},setUrlAdvert:function(){var b=this;var a=settings.reader.bannerAd.url;var d="edid="+editionguid+"&w=728&h=90";if(b.pageNumber!=null){d+="&pnum="+b.pageNumber}var c="top-banner";if(settings.reader.bannerAd.targettingIdentifier!=null){c=settings.reader.bannerAd.targettingIdentifier}if(b.targeting!=null){c=b.targeting}a=a.replace("{{{POS}}}",c);if(a.indexOf("?")==-1){a+="?"+d}else{a+="&"+d}if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){b.setUpToggleableBanner();b.bannerAdHolder.setHtml("<iframe width='728' height='95' style='border:none;overflow:hidden' src='"+a+"' />")}else{b.bannerAd.setHtml("<iframe width='728' height='95' style='border:none;overflow:hidden' src='"+a+"' />")}b.urlHasBeenSetup=true},postMessageToRefresh:function(){var c=this;var b=c.element.dom.querySelector("iframe");if(b!=null){posValue="top-banner";if(settings.reader.bannerAd.targettingIdentifier!=null){posValue=settings.reader.bannerAd.targettingIdentifier}if(c.targeting!=null){posValue=c.targeting}try{b.contentWindow.postMessage({refresh:true,targeting:posValue},"*")}catch(a){console.error("[ReaderBannerAd]:\n",a)}}},setUpToggleableBanner:function(){var b=this;var d=-30;if(b.position=="top"){d=0}var a="Close";if(typeof language!="undefined"&&language.close!=null&&language.close.trim()!=""){a=language.close}var c=Ext.ComponentQuery.query("container[id=bannerCloseBtn]");if(c==null||c.length==0){b.bannerAdHolder=Ext.create("Ext.Container",{style:"width: 728px; height: 90px; position:relative",items:[{id:"bannerCloseBtn",html:'<div style="height:30px;background:rgba(0,0,0,0.8);position:absolute;right:0;top:'+d+'px;cursor:pointer; display: flex;"><div style="color: white; padding: 4px 0px 5px 5px; display: inline;">'+a+'</div><img style="max-width: 100%; height: 20px; margin: 5px;" src="resources/images/reader icons/close-white.png"></div>'}]});b.add(b.bannerAdHolder);b.closeBtn=b.bannerAdHolder.getComponent("bannerCloseBtn")}b.setupCloseButton()},setupCloseButton:function(a){var b=this;b.closeBtn.element.on("tap",function(){b.fireEvent("bannerAdClose",b)});if(settings.reader.bannerAd.canBeClosed!="true"||b.config.advertType=="article"){b.closeBtn.hide()}},hide:function(){var b=this;var a=false;if(b.canBeClosed=="true"){if(b.position=="top"&&!b.isHidden()){a=true}Ext.Container.prototype.hide.apply(this,arguments)}else{if(b.getHeight()>0){a=true}b.setHeight(0)}b.fireEvent("bannerHidden",b,a)},show:function(){var b=this;var a=false;if(b.canBeClosed=="true"){if(b.position=="top"&&b.isHidden()){a=true}Ext.Container.prototype.show.apply(this,arguments)}else{if(b.getHeight()==0){a=true}b.setHeight(110)}b.fireEvent("bannerShown",b,a)},destroy:function(){this.isDestroyed=true;try{if(!!this.adslot&&typeof googletag!="undefined"){googletag.destroySlots([this.adslot])}}catch(a){console.warn("Error Destroying Slot",a)}Ext.Container.prototype.destroy.apply(this,arguments)}},0,["readerbannerad"],["component","container","readerbannerad"],{component:true,container:true,readerbannerad:true},["widget.readerbannerad"],0,[InfinityMobile.view.tablet,"ReaderBannerAd"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderBannerAd",Ext.Container,{config:{style:"text-align:center; transition: height 1s",width:"100%",padding:"5px 0 5px 0",height:60,layout:{type:"hbox",align:"center",pack:"middle"}},statics:{hasAutoRefreshSetting:function(){return InfinityMobile.controller.ReaderController.hasAutoRefreshSettingForBannerAd()}},initialize:function(){var a=this;a.canLoadDFPAdvert=false;a.loadDFPAdvertOnPainted=false;if(a.config.pageNumber!=null){a.pageNumber=a.config.pageNumber}if(a.config.section!=null){a.section=a.config.section}a.position=settings.reader.bannerAd.position;a.canBeClosed=settings.reader.bannerAd.canBeClosed;if(settings.reader.bannerAd.collapseAdOnFail=="true"){if(typeof googletag!="undefined"&&googletag.pubads!=null){googletag.pubads().addEventListener("slotRenderEnded",function(b){if(a.adslot==b.slot){if(b.isEmpty){a.hide();console.log("ERROR: No creative has been served.")}else{a.show()}}})}else{a.hide()}}a.on("painted",a.setCanLoadDFPAdvert,a,{delay:10,single:true})},loadAdvert:function(){var h=this;var g=settings.reader.bannerAd.refreshViaPostMessage=="true";var f=h.getItems().items.length;if(f>0&&!g){h.destroyAdvert()}if(h.isCustomAd()&&!h.hasAddedBannerDiv){h.hasAddedBannerDiv=true;h.add({itemId:"bannerAd"})}f=h.getItems().items.length;if(f==0&&!h.isCustomAd()){h.add({itemId:"bannerAd"})}h.bannerAd=h.getComponent("bannerAd");if(settings.reader.bannerAd!=null){var e=settings.reader.bannerAd.type.toLowerCase();if(e.indexOf("custom|")>=0){if(h.customAd==null&&!h.isLoadingConfig){var c=settings.reader.bannerAd.type.split("|");var d=c[1];var a=c[2];var b=function(){h.customAd=new window[d](h.id+"banner-ad",h.bannerAd.element.dom,currentProfile,settings.reader.bannerAd.config);h.customAd.loadAdvert(h.pageNumber,h.section)};if(settings.reader.bannerAd.config==null){h.isLoadingConfig=true;h.ajaxRequest=$.ajax({url:a+(a.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(j){h.hasConfig=true;h.isLoadingConfig=false;console.log(j);settings.reader.bannerAd.config=j;if(!h.isDestroyed){b()}}})}else{b()}}else{this.customAd.refreshAdvert(h.pageNumber,h.section)}}else{switch(e){case"dfp":default:h.setDFPAdvert();break;case"image":h.setImageAdvert();break;case"url":if(h.urlHasBeenSetup&&g){h.postMessageToRefresh()}else{h.setUrlAdvert()}break;case"adbridg":h.setupAdbridg();break}}}},isCustomAd:function(){var c=this;try{if(settings.reader.bannerAd!=null){var b=settings.reader.bannerAd.type.toLowerCase();if(b.indexOf("custom|")>=0){return true}}}catch(a){console.warn("[ReaderBannerAd]: Error Caught",a)}return false},enableCustomAdRefresh:function(){var a=this;if(a.isCustomAd()&&a.customAd!=null){a.customAd.enableRefreshAdvert()}},disableCustomAdRefresh:function(){var a=this;if(a.isCustomAd()&&a.customAd!=null){a.customAd.disableRefreshAdvert()}},destroyAdvert:function(){var b=this;var a="";if(settings.reader.bannerAd!=null){a=settings.reader.bannerAd.type.toLowerCase()}if(a!=null&&a!="dfp"&&a.indexOf("custom|")==-1&&a!="adbridg"){b.removeAll(true,true)}},setCanLoadDFPAdvert:function(){var a=this;a.canLoadDFPAdvert=true;if(a.loadDFPAdvertOnPainted){a.loadDFPAdvert()}},setTargeting:function(a){var b=this;b.targeting=a},setDFPAdvert:function(){var b=this;var a=b.getComponent("bannerAd");b.networkCode=settings.reader.bannerAd.networkCode;b.adUnit=settings.reader.bannerAd.adUnit;b.setupHtmlForBanner();if(b.canLoadDFPAdvert){b.loadDFPAdvert()}else{b.loadDFPAdvertOnPainted=true}},setupHtmlForBanner:function(){var b=this;var a=b.getComponent("bannerAd");b.advertDivID=b.bannerAd.id+"advert";if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){b.setUpToggleableBanner();b.bannerAdHolder.setHtml("<div id='"+b.advertDivID+"' style='height:50px;'></div>");b.advertDiv=b.bannerAdHolder.element.down("#"+b.advertDivID);b.loadDFPAdvertOnPainted=true}else{a.setHtml("<div id='"+b.advertDivID+"' style='height:50px;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID)}},setDfpTargeting:function(f){var d=this;if(settings.reader.bannerAd.targeting!=null&&settings.reader.bannerAd.targeting.length>0){var a=settings.reader.bannerAd.targeting.split("|");for(var c in a){var e=a[c];var b=e.split("*");if(b!=null&&b.length>=2){b[1]=b[1].replace("{{PAGE}}",d.pageNumber).replace("{{SECTION}}",d.section);f.setTargeting(b[0],b[1])}}}},setupAdbridg:function(){var a=this;a.setupHtmlForBanner();a.checkAdbridge(a.advertDiv.dom)},checkAdbridge:function(b){var a=this;if(!!b&&(typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.adbridg)){b.setAttribute("data-adbridg-ad-class","adb-ee-320x50")}},loadDFPAdvert:function(){var c=this;var b="top-banner";if(c.targeting!=null){b=c.targeting}if(!c.dfpInit){try{googletag.cmd.push(function(){c.adslot=googletag.defineSlot("/"+c.networkCode+"/"+c.adUnit,[parseInt("320"),parseInt("50")],c.advertDivID).addService(googletag.pubads());c.adslot.addService(googletag.pubads().updateCorrelator());if(!(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.removeDefaultTargeting=="true")){c.adslot.setTargeting("pos",b)}c.setDfpTargeting(c.adslot);googletag.enableServices();c.dfpInit=true;c.startAutoRefresh(b)});googletag.cmd.push(function(){googletag.display(c.advertDivID)})}catch(a){}}else{if(!c.statics().hasAutoRefreshSetting()&&!c.isAutoRefreshing()){c.refreshAdvert(b)}}},startAutoRefresh:function(b){if(!(typeof b!="undefined"&&!!b)){return}var c=this;if(c.isAutoRefreshing()){c.stopAutoRefresh()}if(c.statics().hasAutoRefreshSetting()){var a=parseInt(settings.reader.bannerAd.refreshIntervalDuration);if(isNaN(a)===true||a<15){a=15}a*=1000;c.refreshIntervalTimeoutID=setInterval(function(){c.refreshAdvert(b)},a)}},isAutoRefreshing:function(){var a=this;return"refreshIntervalTimeoutID" in a&&!!a.refreshIntervalTimeoutID},stopAutoRefresh:function(){var a=this;if(a.isAutoRefreshing()){clearInterval(a.refreshIntervalTimeoutID);a.refreshIntervalTimeoutID=null}},pauseAutoRefresh:function(){var a=this;if(a.isAutoRefreshing()){a.autoRefreshPaused=true;a.stopAutoRefresh()}},hasAutoRefreshPaused:function(){var a=this;return"autoRefreshPaused" in a&&!!a.autoRefreshPaused},resumeAutoRefresh:function(){var b=this;if(b.hasAutoRefreshPaused()){b.autoRefreshPaused=false;var a="top-banner";if(b.targeting!=null){a=b.targeting}b.startAutoRefresh(a)}},setImageAdvert:function(){var b=this;var a=b.bannerAd;if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){b.setUpToggleableBanner();a=b.bannerAdHolder}a.setHtml("<img src='"+settings.reader.bannerAd.url+"' style='height:50px' />");a.element.on("tap",function(){window.open(settings.reader.bannerAd.link);mainPanel.fireEvent("trackAdvertClick","imageBanner")})},setUrlAdvert:function(){var c=this;var b=c.getComponent("bannerAd");var a=settings.reader.bannerAd.url;var e="edid="+editionguid+"&w=320&h=50";if(c.pageNumber!=null){e+="&pnum="+c.pageNumber}var d="top-banner";if(settings.reader.bannerAd.targettingIdentifier!=null){d=settings.reader.bannerAd.targettingIdentifier}if(c.targeting!=null){d=c.targeting}a=a.replace("{{{POS}}}",d);if(a.indexOf("?")==-1){a+="?"+e}else{a+="&"+e}if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){c.setUpToggleableBanner();c.bannerAdHolder.setHtml("<iframe width='320' height='50' style='border:none;' scrolling='no' src='"+a+"' />")}else{b.setHtml("<iframe width='320' height='50' style='border:none;' scrolling='no' src='"+a+"' />")}c.urlHasBeenSetup=true},postMessageToRefresh:function(){var c=this;var b=c.element.dom.querySelector("iframe");if(b!=null){posValue="top-banner";if(settings.reader.bannerAd.targettingIdentifier!=null){posValue=settings.reader.bannerAd.targettingIdentifier}if(c.targeting!=null){posValue=c.targeting}try{b.contentWindow.postMessage({refresh:true,targeting:posValue},"*")}catch(a){console.error("[ReaderBannerAd]:\n",a)}}},setUpToggleableBanner:function(){var b=this;var d=-30;if(b.position=="top"){d=0}var a="Close";if(typeof language!="undefined"&&language.close!=null&&language.close.trim()!=""){a=language.close}var c=Ext.ComponentQuery.query("container[id=bannerCloseBtn]");if(c==null||c.length==0){b.bannerAdHolder=Ext.create("Ext.Container",{style:"width: 320px; height: 50px; position:relative",items:[{id:"bannerCloseBtn",html:'<div style="height:30px;background:rgba(0,0,0,0.8);position:absolute;right:0;top:'+d+'px;cursor:pointer; display: flex;"><div style="color: white; padding: 4px 0px 5px 5px; display: inline;">'+a+'</div><img style="max-width: 100%; height: 20px; margin: 5px;" src="resources/images/reader icons/close-white.png"></div>'}]});b.add(b.bannerAdHolder);b.closeBtn=b.bannerAdHolder.getComponent("bannerCloseBtn")}b.setupCloseButton()},setupCloseButto},refreshAdvert:function(b){var c=this;if(!(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.removeDefaultTargeting=="true")){c.adslot.setTargeting("pos",b)}if(!!c.adslot){c.setDfpTargeting(c.adslot)}try{googletag.pubads().refresh([c.adslot])}catch(a){}},hide:function(){var b=this;var a=false;if(b.canBeClosed=="true"){if(b.position=="top"&&!b.isHidden()){a=true}Ext.Container.prototype.hide.apply(this,arguments)}else{if(b.getHeight()>0){a=true}b.setHeight(0)}b.fireEvent("bannerHidden",b,a)},show:function(){var b=this;var a=false;if(b.canBeClosed=="true"){if(b.position=="top"&&b.isHidden()){a=true}Ext.Container.prototype.show.apply(this,arguments)}else{if(b.getHeight()==0){a=true}b.setHeight(60)}b.fireEvent("bannerShown",b,a)},destroy:function(){this.isDestroyed=true;try{if(!!this.adslot&&typeof googletag!="undefined"){googletag.destroySlots([this.adslot])}}catch(a){console.warn("Error Destroying Slot",a)}Ext.Container.prototype.destroy.apply(this,arguments)}},0,["readerbannerad"],["component","container","readerbannerad"],{component:true,container:true,readerbannerad:true},["widget.readerbannerad"],0,[InfinityMobile.view.phone,"ReaderBannerAd"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderBookmark",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);a.setupVars();a.setupLanguage();a.setupListeners();a.fireEvent("loadBookmarks",a)},setupVars:function(){var a=this;a.toolbar=a.getComponent("bookmarkToolBar");a.bodyContainer=a.getComponent("bookmarkBodyContainer");a.helperTextContainer=a.bodyContainer.getComponent("bookmarkHelperText");a.bookmarkAddContainer=a.bodyContainer.getComponent("bookmarkAddContainer");a.addBookmarkTextBox=a.bookmarkAddContainer.element.down(".bookmarkName").dom;a.addBookmarkButton=a.bookmarkAddContainer.getComponent("bookmarkAddButton");a.toggleBookmarkTextBox=a.bookmarkAddContainer.getComponent("textInput");a.inputPanel=a.bookmarkAddContainer.getComponent("textInput");a.input=a.inputPanel.element.down(".bookmarkName").dom;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.input.dir="rtl"}a.bookmarksContainer=a.bodyContainer.getComponent("bookmarksContainer");a.bookmarksTxt="Bookmarks";if(typeof language!=null&&language.bookmarks!=null&&language.bookmarks.bookmarks!=null){a.bookmarksTxt=language.bookmarks.bookmarks}a.helperTxt="Bookmarks lets you save a page from the current edition, that you can easily reference at any time";if(typeof language!=null&&language.bookmarks!=null&&language.bookmarks.bookmarksContainerText!=null){a.helperTxt=language.bookmarks.bookmarksContainerText}a.addTxt="Add";if(typeof language!=null&&language.bookmarks!=null&&language.bookmarks.add!=null){a.addTxt=language.bookmarks.add}a.placeholderTxt="Name";if(typeof language!=null&&language.bookmarks!=null&&language.bookmarks.name!=null){a.placeholderTxt=language.bookmarks.name}},setupLanguage:function(){var a=this;if(a.toolbar!=null&&a.toolbar.setText!=null&&a.bookmarksTxt!=null){a.toolbar.setText(a.bookmarksTxt)}if(a.helperTextContainer!=null&&a.helperTxt!=null){a.setText(a.helperTextContainer,a.helperTxt)}if(a.addBookmarkButton!=null&&a.addBookmarkButton.setText!=null&&a.addTxt!=null){a.addBookmarkButton.setText(a.addTxt)}if(a.input!=null&&a.placeholderTxt!=null){$(a.input).attr("placeholder",a.placeholderTxt)}},setText:function(a,b){if(a!=null){a.setHtml(b)}},setupListeners:function(){var a=this;if(a.addBookmarkButton!=null&&a.addBookmarkButton.setTap!=null){a.addBookmarkButton.setTap(function(){a.fireEvent("addBookmark",a)})}if(a.inputPanel!=null&&a.input!=null){a.inputPanel.element.on("tap",function(){a.input.focus()})}}},0,["readerbookmarkparent"],["component","container","panel","overlay","readerbookmarkparent"],{component:true,container:true,panel:true,overlay:true,readerbookmarkparent:true},["widget.readerbookmarkparent"],0,[InfinityMobile.view,"ReaderBookmark"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderBookmark",InfinityMobile.view.ReaderBookmark,{config:{itemId:"bookmarkcontainer",width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;",layout:"vbox",items:[{id:"bookmarkToolBar",xtype:"readeroverlaytitle",titleTxt:"Bookmarks",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"bookmarkBodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{itemId:"bookmarkHelperText"},{itemId:"bookmarkAddContainer",layout:{type:"hbox",align:"stretch",pack:"middle"},height:35,margin:"10px 0",items:[{flex:1,itemId:"textInput",html:"<input class='bookmarkName' type='text' placeholder='Name' style='width:100%; height:35px; padding-left:10px' />"},{itemId:"padding",width:20},{itemId:"bookmarkAddButton",width:150,xtype:"readeroverlaybutton",txt:"Add"}]},{itemId:"bookmarksContainer",flex:1,xtype:"readeritemscontainer",defaults:{width:200,margin:10}}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderBookmark.prototype.initialize.apply(this,arguments)}},0,["readerbookmark"],["component","container","panel","overlay","readerbookmarkparent","readerbookmark"],{component:true,container:true,panel:true,overlay:true,readerbookmarkparent:true,readerbookmark:true},["widget.readerbookmark"],0,[InfinityMobile.view.tablet,"ReaderBookmark"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderBookmark",InfinityMobile.view.ReaderBookmark,{config:{id:"bookmarkcontainer",width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"bookmarkToolBar",xtype:"readeroverlaytitle",titleTxt:"Bookmarks",parentOverlay:this,destoryOnClose:true,rounded:false},{itemId:"bookmarkBodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{itemId:"bookmarkHelperText"},{itemId:"bookmarkAddContainer",layout:{type:"hbox",align:"stretch",pack:"middle"},height:35,margin:"10px 0",items:[{flex:1,itemId:"textInput",html:"<input class='bookmarkName' type='text' placeholder='' style='width:100%; height:35px; padding-left:10px' />"},{itemId:"padding",width:20},{itemId:"bookmarkAddButton",width:150,xtype:"readeroverlaybutton",txt:"Add"}]},{itemId:"bookmarksContainer",flex:1,xtype:"readeritemscontainer",defaults:{cls:"bookmarkitemphone",margin:10}}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderBookmark.prototype.initialize.apply(this,arguments)}},0,["readerbookmark"],["component","container","panel","overlay","readerbookmarkparent","readerbookmark"],{component:true,container:true,panel:true,overlay:true,readerbookmarkparent:true,readerbookmark:true},["widget.readerbookmark"],0,[InfinityMobile.view.phone,"ReaderBookmark"],0));(Ext.cmd.derive("InfinityMobile.view.phone.readerTerms",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:"100%",height:"100%",style:"background-color:white;padding:0px;",fullscreen:true,height:"100%",layout:{type:"vbox"},items:[{id:"toolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{id:"ToolBarClose",top:8,right:8,html:"<img class='pointerCursor' src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"body",width:"100%",flex:1}]},initialize:function(){var b=this;b.topbar=b.getComponent("toolBar");b.title=b.topbar.getComponent("title");b.close=b.topbar.getComponent("ToolBarClose");b.bodyContainer=b.getComponent("body");b.topbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var };Ext.Viewport.on({orientationchange:c});b.title.setHtml(language.menu.terms);b.close.element.on({ta}});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.close.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}b.element.on({painted:function(){if(settings.menu.terms.url!=null){if(settings.menu.terms.url.length>0){b.bodyContainer.setHtml("<div class='iframeWrapper' style='position:absolute; width:100%; height:100%; overflow-y:scroll; -webkit-overflow-scrolling:touch;'><iframe scrolling=\"yes\" style='border:none;height:100%;width:100%;' src='"+settings.menu.terms.url+"' /></div>");var d=$(b.bodyContainer.element.dom).find(".x-innerhtml")[0];if(d!=null){d.style.height="100%"}}}},scope:b})}},0,["readerTerms"],["component","container","readerTerms"],{component:true,container:true,readerTerms:true},["widget.readerTerms"],0,[InfinityMobile.view.phone,"readerTerms"],0));(Ext.cmd.derive("InfinityMobile.view.SectionListOverlay",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);a.setupVars();a.setupLanguage();a.fireEvent("initialized",a,a.itemsContainer)},setupVars:function(){var b=this;b.toolBar=b.getComponent("toolBar");b.bodyContainer=b.getComponent("bodyContainer");b.itemsContainer=b.bodyContainer.getComponent("itemsContainer");b.titleTxt="Section List";if(typeof language!="undefined"){var a=language.sectionList;if(a!=null){var c=a.sectionList;if(c!=null){b.titleTxt=c}}}},setupLanguage:function(){var a=this;if(a.toolBar!=null&&a.toolBar.setText!=null&&a.titleTxt!=null){a.toolBar.setText(a.titleTxt)}}},0,["sectionlistoverlayparent"],["component","container","panel","overlay","sectionlistoverlayparent"],{component:true,container:true,panel:true,overlay:true,sectionlistoverlayparent:true},["widget.sectionlistoverlayparent"],0,[InfinityMobile.view,"SectionListOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.SectionListOverlay",InfinityMobile.view.SectionListOverlay,{config:{height:"100%",width:"100%",style:"padding:0px;max-height:700px;width:700px;",layout:"vbox",items:[{id:"toolBar",xtype:"readeroverlaytitle",titleTxt:"Section List",parentOverlay:this,destoryOnClose:true,rounded:true},{id:"bodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,xtype:"readeritemscontainer",defaults:{width:145,margin:"0 8 16 7"}}]}]},initialize:function(){var a=this;a.setSquareCorners();InfinityMobile.view.SectionListOverlay.prototype.initialize.apply(this,arguments)}},0,["sectionlistoverlay"],["component","container","panel","overlay","sectionlistoverlayparent","sectionlistoverlay"],{component:true,container:true,panel:true,overlay:true,sectionlistoverlayparent:true,sectionlistoverlay:true},["widget.sectionlistoverlay"],0,[InfinityMobile.view.tablet,"SectionListOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.phone.SectionListOverlay",InfinityMobile.view.SectionListOverlay,{config:{height:"100%",width:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"toolBar",xtype:"readeroverlaytitle",titleTxt:"Section List",parentOverlay:this,destoryOnClose:true,rounded:false},{id:"bodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,xtype:"readeritemscontainer",defaults:{width:145,margin:"0 8 16 7"}}]}]}},0,["sectionlistoverlay"],["component","container","panel","overlay","sectionlistoverlayparent","sectionlistoverlay"],{component:true,container:true,panel:true,overlay:true,sectionlistoverlayparent:true,sectionlistoverlay:true},["widget.sectionlistoverlay"],0,[InfinityMobile.view.phone,"SectionListOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.ZonesOverlay",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);a.setupVars();a.setupLanguage();a.setupEvents();a.fireEvent("initialized",a,a.itemsContainer);if(currentProfile!="desktop"&&a.scroller!=null&&a.scroller.maxPosition!=null&&a.scroller.maxPosition.y==0&&Ext.os.is.iOS){setTimeou},2500)}},setupVars:function(){var b=this;b.toolBar=b.getComponent("toolBar");if(b.toolBar!=null){b.toolBarClose=b.toolBar.getComponent("toolBarClose")}b.bodyContainer=b.getComponent("bodyContainer");if(b.bodyContainer!=null){b.itemsContainer=b.bodyContainer.getComponent("itemsContainer");b.scrollable=b.itemsContainer!=null?b.itemsContainer.getScrollable():null;b.scroller=b.scrollable!=null?b.scrollable.getScroller():null}b.titleTxt="Zones";if(typeof language!="undefined"&&language.menu!=null){var a=language.menu;if(a.zones!=null){b.titleTxt=a.zones}}},setupLanguage:function(){var a=this;var b=a.titleTxt;if(a.isUpper(b)){b=(b[0].toUpperCase()+b.substring(1,b.length).toLowerCase())}if(a.toolBar!=null&&a.toolBar.setText!=null){a.toolBar.setText(b)}},isUpper:function(d){var b=this;var c=true;for(var a=0;a<d.length;a++){if(d[a]==d[a].toLowerCase()){c=false}}return c},setupEvents:function(){var a=this;a.on({painted:a.setHeightOfContainer,scope:a})},setHeightOfContainer:function(){var g=this;if(currentProfile=="desktop"){var e=$(g.itemsContainer.element.dom).height();var j=$(g.itemsContainer.element.dom).width();var b=g.itemsContainer.getItems().items;var k=0;var f=0;var a=0;for(var d in b){f+=$(b[d].element.dom).width();if(a<$(b[d].element.dom).height()){a=$(b[d].element.dom).height()}}k=Math.ceil(f/j);g.setHeight((k*a)+116);if(k==1){var c=0;for(var d in b){c+=$(b[d].element.dom).width()}if(c<700){g.setWidth(c+80)}}}else{}g.element.dom.style.visibility="visible"}},0,["zonesoverlayparent"],["component","container","panel","overlay","zonesoverlayparent"],{component:true,container:true,panel:true,overlay:true,zonesoverlayparent:true},["widget.zonesoverlayparent"],0,[InfinityMobile.view,"ZonesOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ZonesOverlay",InfinityMobile.view.ZonesOverlay,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;min-height:412px;",layout:"vbox",items:[{id:"toolBar",xtype:"readeroverlaytitle",titleTxt:"Zones",parentOverlay:this,destoryOnClose:true,rounded:true},{id:"bodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,xtype:"readeritemscontainer",defaults:{width:150,margin:"0 8 16 7"}}]}]}},0,["zonesoverlay"],["component","container","panel","overlay","zonesoverlayparent","zonesoverlay"],{component:true,container:true,panel:true,overlay:true,zonesoverlayparent:true,zonesoverlay:true},["widget.zonesoverlay"],0,[InfinityMobile.view.tablet,"ZonesOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ZonesOverlay",InfinityMobile.view.ZonesOverlay,{config:{width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"toolBar",xtype:"readeroverlaytitle",titleTxt:"Zones",parentOverlay:this,destoryOnClose:true,rounded:false},{id:"bodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,xtype:"readeritemscontainer",defaults:{width:150,margin:"0 8 16 7"}}]}]}},0,["zonesoverlay"],["component","container","panel","overlay","zonesoverlayparent","zonesoverlay"],{component:true,container:true,panel:true,overlay:true,zonesoverlayparent:true,zonesoverlay:true},["widget.zonesoverlay"],0,[InfinityMobile.view.phone,"ZonesOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderArticlePopoverItem",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",article:null,cls:["loading","article-popover-item"],layout:"card",items:[{itemId:"content",flex:1,padding:"0 0 10px 0"},{itemId:"mediaHuis",hidden:true,flex:1},{itemId:"contentIframe",layout:"fit",height:"100%"}]},statics:{isCustomBannerAd:null,isCustomMpuAd:null,getBannerAdSetting:function(){var a=(typeof settings=="object"&&!!settings&&"reader" in settings&&typeof settings.reader=="object"&&!!settings.reader)?settings.reader:{};return("popupAdvert" in a&&typeof a.popupAdvert=="object"&&!!a.popupAdvert)?a.popupAdvert:{}},getMpuAdSetting:function(){var a=(typeof settings=="object"&&!!settings&&"reader" in settings&&typeof settings.reader=="object"&&!!settings.reader)?settings.reader:{};return("popupAdvertMpu" in a&&typeof a.popupAdvertMpu=="object"&&!!a.popupAdvertMpu)?a.popupAdvertMpu:{}},isBannerAdTypeCustom:function(){try{if(typeof InfinityMobile.view.desktop.ReaderArticlePopoverItem.isCustomBannerAd==="boolean"){return InfinityMobile.view.desktop.ReaderArticlePopoverItem.isCustomBannerAd}var a=InfinityMobile.view.desktop.ReaderArticlePopoverItem.getBannerAdSetting();var c="type" in a&&!!a.type?a.type:"";return c.indexOf("custom|")>=0}catch(b){console.warn("[ReaderArticlePopoverItem]: Error Caught",b)}return false},isMpuAdTypeCustom:function(){try{if(typeof InfinityMobile.view.desktop.ReaderArticlePopoverItem.isCustomMpuAd==="boolean"){return InfinityMobile.view.desktop.ReaderArticlePopoverItem.isCustomMpuAd}var c=InfinityMobile.view.desktop.ReaderArticlePopoverItem.getMpuAdSetting();var b="type" in c&&!!c.type?c.type:"";return b.indexOf("custom|")>=0}catch(a){console.warn("[ReaderArticlePopoverItem]: Error Caught",a)}return false}},initialize:function(){var d=this;d.bannerAdvertSetting=d.statics().getBannerAdSetting();d.mpuAdvertSetting=d.statics().getMpuAdSetting();if(d.statics().isCustomBannerAd==null){d.statics().isCustomBannerAd=d.statics().isBannerAdTypeCustom()}if(d.statics().isCustomMpuAd==null){d.statics().isCustomMpuAd=d.statics().isMpuAdTypeCustom()}d.painted=false;d.loadType="";d.mode="html";d.destroyed=false;d.advertTimeout=2000;if(settings.articlepopover.lazyLoadPopoverAdverts!=null&&settings.articlepopover.lazyLoadPopoverAdverts=="true"){d.advertTimeout=1500}if(d.config.pageNo!=null){d.pageNo=d.config.pageNo}if(d.config.section!=null){d.section=d.config.section}if(d.config.page!=null){d.page=d.config.page}d.content=d.getComponent("content");d.contentIframe=d.getComponent("contentIframe");d.setContentStyle();if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){}else{if((d.config.highlightMode!=null&&d.config.highlightMode==true)||(d.config.readAloudMode!=null&&d.config.readAloudMode)){d.mode="frame";d.setActiveItem(d.contentIframe)}}d.popoverType="article";if(InfinityMobile.app.getController("MediaController").currentLang){d.lang=InfinityMobile.app.getController("MediaController").currentLang}var b=false;d.mediaObject=d.config.page;if((settings.newsday!=null)||(d.getArticle()!=null&&d.mediaObject.file!=d.mediaObject.guid)){b=true;d.loadType="inline"}if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){d.setupArticleTemplate()}else{if(settings.reader.iframePopover!=null&&settings.reader.iframePopover=="true"){d.intializeForIframe()}else{if(b==true){d.article=$.extend(true,{},articleDictionary[d.getArticle()]);d.removeInlineStyling();if(settings.newsday!=null&&settings.newsday.useNewsdayTemplate!=null&&settings.newsday.useNewsdayTemplate=="true"){var c=true;d.initializeInlineNewsday()}else{var c=false;if(d.isLazyLoadingInlineDfpMpuAdvert()){d.advertTimeout=0}d.initializeInline()}if((navigator.maxTouchPoints)){d.content.setScrollable({direction:"vertical",directionLock:true});var e=$(d.element.dom).find(".x-scroll-scroller-vertical")[0];if(e!=null){$(e).addClass("verticalscroller")}d.setupScrollingEvents(d.content)}else{d.element.down(".x-container").dom.style.overflowY="scroll"}}else{var a=InfinityMobile.app.application.getController("ArticlePopoverController").flippAdvertSetting;if(!!a&&a.enabled){d.addCls("has-flipp")}d.initializeForWeb();if(navigator.maxTouchPoints){d.element.down(".x-container").dom.style.overflow="hidden";d.content.setScrollable({direction:"vertical",directionLock:true});d.setupScrollingEvents(d.content)}else{d.element.down(".x-container").dom.style.overflow="auto"}}}}},isCustomBannerAd:function(){var a=this;return a.statics().isBannerAdTypeCustom()},isCustomMpuAd:function(){var a=this;return a.statics().isMpuAdTypeCustom()},getMetaDataToSetupCustomMpuAd:function(){var c=this;var a={className:null,configUrl:""};if(c.isCustomMpuAd()){var b=c.mpuAdvertSetting.type.split("|");a.className=b[1];a.configUrl=b[2]}return a},isLazyLoadPopoverAdverts:function(){return typeof settings=="object"&&!!settings&&"articlepopover" in settings&&typeof settings.articlepopover=="object"&&!!settings.articlepopover&&"lazyLoadPopoverAdverts" in settings.articlepopover&&settings.articlepopover.lazyLoadPopoverAdverts==="true"},isLazyLoadingInlineDfpMpuAdvert:function(){var a=this;return settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.type.toLowerCase()==="dfp"&&a.isLazyLoadPopoverAdverts()},isLazyLoadCustomBannerAdvert:function(){var a=this;return a.isCustomBannerAd()&&a.isLazyLoadPopoverAdverts()},isLazyLoadCustomMpuAdvert:function(){var a=this;return a.isCustomMpuAd()&&a.isLazyLoadPopoverAdverts()},setupArticleTemplate:function(){var a=this;if(typeof articleDictionary!="undefined"&&articleDictionary[a.config.article]!=null){a.article=articleDictionary[a.config.article];a.on("painted",function(){a.painted=true;a.templateRequest=$.ajax({type:"GET",contentType:"text/plain",async:true,url:a.article.url,success:function(b){if(b!=null){articleDictionary[a.config.article].articleData=b}a.content.setHtml('<iframe id="'+a.id+'-content" class="article-template-frame" style="height: 100%; width: 100%; border: none;opacity: 0; transition: 0.3s ease opacity;"></iframe>');if(a.parent.getActiveItem()==a){a.writeTimeout=setTimeout(function(){a.setupTemplateIframe();a.writeArticleTemplate()},100)}}})},a,{delay:10,single:true})}},writeArticleTemplate:function(){var c=this;if(!c.isWritten){var b=articleDictionary[c.config.article].articleData;if(b!=null){if(c.contentTemplateIframe==null){c.setupTemplateIframe()}if(c.contentTemplateIframe!=null){if(b.body!=null){b.body=b.body.replace("<body",'<body style="font-size:'+fontEm+'px"');c.contentTemplateIframe.contentDocument.write(b.body);c.contentTemplateIframe.style.opacity=1;c.removeCls("loading");c.isWritten=true;c.fireEvent("updateArticleShareAfterWrite",b.sharelink,b.headline);try{c.contentTemplateIframe.contentDocument.close()}catch(a){console.warn("[ReaderArticlePopoverItem] Error Caught:\n\n\t",a)}c.fireEvent("trackArticleChange",c.getPageNo(),null,c)}else{if(!c.hasWrittenError){c.removeCls("loading");c.contentTemplateIframe.contentDocument.write("<html><head></head><body><h2>Oops. Something went wrong!</h2></body><html>");c.hasWrittenError=true}}c.displayTemplateTimeout=setTimeout(function(){try{setText(c.element.dom)}catch(d){console.warn("Error setting text size of an article.\n",d)}},250)}}else{c.setupArticleTemplate()}}},setupTemplateIframe:function(){var b=this;b.contentTemplateIframe=document.getElementById(b.id+"-content");if(b.contentTemplateIframe!=null){var a=b.contentTemplateIframe.contentDocument||b.contentTemplateIframe.contentWindow.document;if(a){b.templateIframeTouchStart=function(c){var d=b.getSelectedText();if(b.getSelectedText()==null||d.trim()==""){b.eventStarted=true;b.frameTouchStart(c)}};a.addEventListener("touchstart",b.templateIframeTouchStart);b.templateIframeTouchMove=function(c){if(b.eventStarted){b.frameTouchMove(c);c.preventDefault()}};a.addEventListener("touchmove",b.templateIframeTouchMove);b.templateIframeTouchEnd=function(c){if(b.eventStarted){b.frameTouchEnd(c);b.eventStarted=false}};a.addEventListener("touchend",b.templateIframeTouchEnd)}}},removeTemplateFrameTouchListeners:function(){var c=this;try{c.contentTemplateIframe=document.getElementById(c.id+"-content");if(c.contentTemplateIframe!=null){var a=c.contentTemplateIframe.contentDocument||c.contentTemplateIframe.contentWindow.document;if(a){a.removeEventListener("touchstart",c.templateIframeTouchStart);a.removeEventListener("touchmove",c.templateIframeTouchMove);a.removeEventListener("touchend",c.templateIframeTouchEnd)}}}catch(b){console.error("[ReaderArticlePopoverItem]: Error Caught",b)}},returnArticleCarousel:function(){return this.parent},frameTouchStart:function(b){var a=this;a.articleCarousel=a.returnArticleCarousel();a.articleCarousel.carouselDragStart(b)},frameTouchMove:function(b){var a=this;a.articleCarousel.carouselDrag(b)},frameTouchEnd:function(b){var a=this;a.articleCarousel.carouselDragEnd(b)},setupScrollingEvents:function(d){var b=this;var c=d.getScrollable();var a=c.getScroller();b.element.dom.onmousewheel=function(f){if(f.deltaY>0||(Ext.browser.is.IE&&f.wheelDelta<0)){if(a.position.y+30<a.maxPosition.y){a.scrollTo(0,a.position.y+30)}else{a.scrollTo(0,a.maxPosition.y)}}else{if(a.position.y-30>a.minPosition.y){a.scrollTo(0,a.position.y-30)}else{a.scrollTo(0,a.minPosition.y)}}}},getArticleTemplat},setUpImageControl},removeInlineStyling:function(){var j=this;var l=/style=["'][^\"]*["']/g;var e=j.article!=null&&j.article.body!=null?j.article.body.match(l):null;if(e!=null){for(var d=0;d<e.length;d++){if(e[d].indexOf("font-size")!=-1){var g=e[d].indexOf("font-size");var f=0;for(var k=g;k<e[d].length;k++){if(e[d][k]==";"){f=k;break}}}var c=e[d].substring(0,g)+e[d].substring(f,e[d].length);j.article.body=j.article.body.replace(e[d],c);e[d]=c;if(e[d].indexOf("line-height")!=-1){var b=e[d].indexOf("line-height");var h=0;for(var k=b;k<e[d].length;k++){if(e[d][k]==";"){h=k;break}}}var a=e[d].substring(0,b)+e[d].substring(h,e[d].length);j.article.body=j.article.body.replace(e[d],a)}}},initializeInlineNewsday:function(){var e=this;var f="<div class='container'><div class='content'><div class='articleContent'><{{LABEL}}><div class='contenthead font35'><{{HEAD}}></div><{{HEADDECK}}><{{IMAGE}}><div style='margin-bottom:15px;min-height:25px;'><{{BYLINE}}><div class='bylinecontainer' ><{{TEXTCONTROLS}}></div></div><hr /><div class='contentbody'><{{UPDATE}}><{{REVIEWBOX}}><div style='position:relative;' ><{{MPU}}><{{BODY}}></div><{{NEWSBOX}}></div><{{BANNERAD}}></div></div></div>";if(e.article.label!=null){f=f.replace("<{{LABEL}}>",'<div class="label labeldesktop" >'+e.article.label+"</div>")}else{f=f.replace("<{{LABEL}}>","")}f=e.setUpdateStory(f);f=f.replace("<{{HEAD}}>",e.article.headline);f=f.replace("<{{HEADDECK}}>",'<div class="contentdeck font25">'+e.article.subHeadline+"</div>");f=e.newsdayByline(f);if(e.article.reviewBox.trim().length>0){var g="";if(e.article.type=="REVIEW"){g='<p><span class="BOLD">REVIEW</span></p>'}var a="";if(e.article.reviewstars!=null&&e.article.reviewstars.trim().length>0&&settings.newsday.useFontAwesome=="true"){a=e.getStarRatingNewsdayHtml(e.article.reviewstars);g='<div style="margin-bottom:8px;" ><span class="BOLD" style="margin-bottom:10px;">REVIEW</span></div>'}f=f.replace("<{{REVIEWBOX}}>","<div class='reviewbox' >"+g+a+e.article.reviewBox+"</div>")}else{f=f.replace("<{{REVIEWBOX}}>","")}re=/<(a|A)?[^>]*>([^<]+)<\/(a|A)?>/g;match=0;while(match!=null){match=re.exec(e.article.body);if(match!=null&&match[0]!=null){var k=match[0].replace(">",' target="_blank" >');if(k.indexOf("mailto:")==-1){e.article.body=e.article.body.replace(match[0],k)}}}f=f.replace("<{{BODY}}>",e.article.body);if(e.article.newsBox.trim().length>0){if(e.article.newsBoxes!=null){f=e.addNewsBoxes(f)}else{f=f.replace("<{{NEWSBOX}}>","<div class='newsbox' >"+e.article.newsBox+"</div>")}}else{f=f.replace("<{{NEWSBOX}}>","")}f=f.replace("<{{TEXTCONTROLS}}>",'<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="resources/images/increase-text-size_newsday.png" ontouchstart="increaseTextNewsday()" onclick="increaseTextNewsday()">&nbsp;&nbsp;<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="resources/images/decrease-text-size_newsday.png" ontouchstart="decreaseTextNewsday()" onclick="decreaseTextNewsday()"></div>');var c=settings.newsday.articleCubeAd;if(c!=null){if(c.type!=null&&c.type.indexOf("custom|")>=0){f=f.replace("<{{MPU}}>",'<div class="mpuAdvert" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;" ><div style="padding: 5px 0px;">Advertisement</div><div class=\'mpu-article\' ></div></div>')}else{if(c.networkCode!=null&&c.adUnit!=null){e.networkCodeMpu=c.networkCode;e.adUnitMpu=c.adUnit;e.advertDivIDMpu=e.id+"mpu";f=f.replace("<{{MPU}}>",'<div class="mpuAdvert" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;" ><div style="padding: 5px 0px;">Advertisement</div><div id="'+e.advertDivIDMpu+'" ></div></div>')}else{if(c.type=="url"){f=f.replace("<{{MPU}}>",'<div class="mpuAdvert" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;" ><div style="padding: 5px 0px;">Advertisement</div><iframe style=\'height:250px;width:300px;border: none;\' src="'+c.url+'" ></iframe></div>')}}}}else{f=f.replace("<{{MPU}}>","")}var h=settings.reader.popupAdvert;if(h!=null){if(h.type!=null&&h.type.indexOf("custom|")>=0){f=f.replace("<{{BANNERAD}}>",'<div class="readerBannerAd" style="text-align: center; color: #999!important; font-size: 0.85em;height:auto; min-height:50px;" ><div style="padding: 5px 0px;">Advertisement</div><div class=\'banner-article\' ></div></div>')}else{if(h.url!=null){f=f.replace("<{{BANNERAD}}>",'<div class="readerBannerAd" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:50px;" ><div style="padding: 5px 0px;">Advertisement</div><iframe style=\'height:90px;width:728px;border: none;\' src="'+h.url+'" ></iframe></div>')}else{f=f.replace("<{{BANNERAD}}>","")}}}else{var j=settings.newsday.articleBannderAd;if(j!=null){if(j.networkCode!=null&&j.adUnit!=null){e.networkCode=j.networkCode;e.adUnit=j.adUnit;e.advertDivID=e.id+"advert";f=f.replace("<{{BANNERAD}}>","<div id='"+e.advertDivID+"' style='width:728px;height:110px;margin:auto;'></div>")}else{f=f.replace("<{{BANNERAD}}>","")}}else{f=f.replace("<{{BANNERAD}}>","")}}var b=e.initializeInlineImagesNewsday();f=f.replace("<{{IMAGE}}>",b);e.content.setHtml(f);e.removeSpinner();e.on("painted",function(){e.setImages();setNewsdayText(e.content.element.dom);e.fireEvent("fillPrintContainer",e)},e,{});e.hasVideo=false;e.hasLink=false;e.hasGallery=false;var d=$(e.element.dom).find(".articleImg")[0];if(d!=null){d.onload=function(){if(e.element!=null){var o=$(e.element.dom).find(".galleryicon")[0];$(o).css("visibility","visible");$(o).click(function(){e.viewGallery()});o.addEventListener("touchstart",function(){e.viewGallery()})}if(e.article.media!=null){if(e.article.media.length>0){for(var m in e.article.media){if(e.article.media[m].type=="OVIDEO"&&e.element!=null){var n=$(e.element.dom).find(".articlevideoicon")[0];$(n).css("display","inline");e.oVideo=e.article.media[m];if(!e.hasVideo){$(n).click(function(){e.viewOVideo(e.oVideo)});n.addEventListener("touchstart",function(){e.viewOVideo(e.oVideo)});e.hasVideo=true}}if(e.article.media[m].type=="OLINK"){if(e.element!=null){var l=$(e.element.dom).find(".linkicon")[0];$(l).css("display","inline");e.oLink=e.article.media[m].url;if(!e.hasLink){$(l).click(function(){e.openOLink(e.oLink)});l.addEventListener("touchstart",function(){e.openOLink(e.oLink)});e.hasLink=true}}}if(e.article.media[m].type=="OGALLERY"){var l=$(e.element.dom).find(".ogalleryicon")[0];$(l).css("display","inline");e.oGallery=e.article.media[m];if(!e.hasGallery){$(l).click(function(){e.openOGallery(e.oGallery)});l.addEventListener("touchstart",function(){e.openOGallery(e.oGallery)});e.hasGallery=true}}}}}}}},setUpdateStory:function(b){var c=this;if(c.article.updateTag!=null&&c.article.updateTag.length>0){var a="<a class='updateLink updateLinkHidden pointerCursor' target='_blank' href='http://google.com'>View the updated story ></a>";b=b.replace("<{{UPDATE}}>",a);c.updateLinkAjax=$.ajax({delay:10,url:"../get_update_tag.aspx?updateTag="+encodeURIComponent(c.article.updateTag),success:function(e){var d=$(c.element.dom).find(".updateLink");if(d!=null&&e!=null&&e.content!=null&&e.content.shareLink!=null){$(d).removeClass("updateLinkHidden");$(d).attr("href",e.content.shareLink)}}})}else{b=b.replace("<{{UPDATE}}>","")}return b},addNewsBoxes:function(d){var e=this;var b="";for(var c in e.article.newsBoxes){var a="<div class='newsbox' >"+e.article.newsBoxes[c]+"</div>";b+=a}d=d.replace("<{{NEWSBOX}}>",b);return d},getStarRatingNewsdayHtml:function(c){var d=this;var a='<span class="reviewstars">';var e=Math.floor(parseFloat(c));for(var b=1;b<=e;b++){a+='<i class="fa fa-star fa-lg" aria-hidden="true"></i>'}if(parseFloat(c)>e){a+='<i class="fa fa-star-half-o fa-lg" aria-hidden="true"></i>'}a+="</span><br />";return a},newsdayByline:function(c){var d=this;var e='<div class="contentbyline font15">';if(d.article.byline.length>0){e+="By <span class='bylinespan'>"+d.article.byline+"</span>";if(d.validateEmail(d.article.reporterEmail)){e=e.replace("<span class='bylinespan'>","<span class='bylinespan pointerCursor' ontouchstart='var url = \"mailto:"+d.article.reporterEmail+"?subject="+encodeURIComponent(d.article.headline)+'"; if (Ext.browser.userAgent.indexOf("CrOS") != -1) {window.open(url);}else{window.location.href = url\');}\' onclick=\'var url = "mailto:'+d.article.reporterEmail+"?subject="+encodeURIComponent(d.article.headline)+'"; if (Ext.browser.userAgent.indexOf("CrOS") != -1) {window.open(url);}else{window.location.href = url;}\'>')}else{e=e.replace("<span class='bylinespan'>","<span>")}if(d.article.reporters!=null){for(var b in d.article.reporters){var a="";if(b==d.article.reporters.length-1){a+=" and <span class='bylinespan'>"+d.article.reporters[b].name+"<span>"}else{a+=", <span class='bylinespan'>"+d.article.reporters[b].name+"<span>"}if(d.validateEmail(d.article.reporters[b].email)){a=a.replace("<span class='bylinespan'>","<span class='bylinespan pointerCursor' ontouchstart='var url = \"mailto:"+d.article.reporters[b].email+"?subject="+encodeURIComponent(d.article.headline)+'"; if (Ext.browser.userAgent.indexOf("CrOS") != -1) {window.open(url);}else{window.location.href = url;}\' onclick=\'var url = "mailto:'+d.article.reporters[b].email+"?subject="+encodeURIComponent(d.article.headline)+'"; if (Ext.browser.userAgent.indexOf("CrOS") != -1) {window.open(url);}else{window.location.href = url;}\'>')}else{a=a.replace("<span class='bylinespan'>","<span>")}e+=a}}}e+="</div>";c=c.replace("<{{BYLINE}}>",e);return c},validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},viewGallery:function(){var a=this;a.fireEvent("galleryClickFromArticle",a,a.article.images,a.article)},viewOVideo:function(c){var b=this;var a=c.url;if(a.indexOf("http://")==-1){a="http://"+a}b.fireEvent("ovideoclicked",b,a,"story window")},openOLink:function(a){var b=this;window.open(a);b.fireEvent("trackOLink",b,a,b.article)},openOGallery:function(a){var b=this;b.fireEvent("galleryClick",b,a.url)},loadAdvert:function(){var a=this;setTimeout(function(){if(!a.destroyed){var c=settings.reader.popupAdvert;if(c!=null&&c.type.indexOf("custom|")>=0){var e=$(a.element.dom).find(".banner-article")[0];var g=c.type.split("|");var f=g[1];var k=g[2];var h=function(){if(e&&window[f]!=null&&a.customBannerAd==null){a.customBannerAd=new window[f](a.id+"article-article",e,currentProfile,c.config);a.customBannerAd.loadAdvert(a.page.page)}else{if(a.customBannerAd!=null){a.customBannerAd.refreshAdvert(a.page.page)}}};if(c.config==null){a.ajaxRequest=$.ajax({url:k+(k.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(l){a.hasConfig=true;console.log(l);settings.reader.popupAdvert.config=l;if(!a.destroyed){h();a.sendNewPageViewForHtlbidCustomAd()}}})}else{h()}}else{if(c!=null&&c.type=="url"){var d=a.element.dom.querySelector("#"+a.advertDivID);if(d!=null){console.log("hitting",d,c);d.src=c.url}}else{if(c!=null&&c.type=="adbridg"){var j=a.element.dom.querySelector("#"+a.advertDivID);console.log(j);if(!j){j=document.createElement("DIV");j.style.height="110px";j.style.width="728px";j.style.margin="15px auto";j.id=a.advertDivID;var b=a.element.dom.querySelector("#"+a.advertDivID+"-container");b.appendChild(j)}if(!!j){j.setAttribute("data-adbridg-ad-class","adb-ee-inner-728x90")}}else{googletag.cmd.push(function(){a.adSlot=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("728"),parseInt("90")],a.advertDivID);a.adSlot.addService(googletag.pubads().updateCorrelator());var p=false;if(settings.reader.popupAdvert!=null&&settings.reader.popupAdvert.targeting!=null&&settings.reader.popupAdvert.targeting.length>0){var l=settings.reader.popupAdvert.targeting.split("|");var p=false;for(var n in l){var o=l[n];var m=o.split("*");if(m!=null&&m.length>=2){m[1]=m[1].replace("{{PAGE}}",a.page.page).replace("{{SECTION}}",a.section);a.adSlot.setTargeting(m[0],m[1]);if(!p){p=m[0]=="pos"}}}}if(!p){a.adSlot.setTargeting("pos",a.getPageNo()+1)}googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})}}}}},a.advertTimeout)},refreshAdvert:function(){var a=this;googletag.pubads().refresh([a.adSlot])},loadAdvertMpu:function(){var a=this;setTimeout(function(){if(!a.destroyed){var b=typeof settings!="undefined"&&settings.newsday!=null&&settings.newsday.articleCubeAd?settings.newsday.articleCubeAd:null;if(b!=null&&b.type!=null&&b.type.indexOf("custom|")>=0){var g=$(a.element.dom).find(".mpu-article")[0];var f=b.type.split("|");var h=f[1];var d=f[2];var e=function(){if(g&&window[h]!=null&&a.customMpuAd==null){a.customMpuAd=new window[h](a.id+"mpu-article",g,currentProfile,b.config);a.customMpuAd.loadAdvert(a.page.page)}else{if(a.customMpuAd!=null){a.customMpuAd.refreshAdvert(a.page.page)}}};if(b.config==null){a.ajaxRequestMpu=$.ajax({url:d+(d.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(k){a.hasConfig=true;console.log(k);settings.newsday.articleCubeAd.config=k;if(!a.destroyed){e();a.sendNewPageViewForHtlbidCustomAd()}}})}else{e()}}else{if(!!settings.reader&&!!settings.reader.popupAdvertMpu&&settings.reader.popupAdvertMpu.type=="adbridg"){var j=a.element.dom.querySelector("#"+a.advertDivIDMpu);console.log(j);if(!j){j=document.createElement("DIV");j.id=a.advertDivIDMpu;var c=a.element.dom.querySelector("#"+a.advertDivIDMpu+"-container");if(!!c){c.appendChild(j)}}if(!!j){j.setAttribute("data-adbridg-ad-class","adb-ee-inner-300x250")}}else{googletag.cmd.push(function(){a.adSlotMpu=googletag.defineSlot("/"+a.networkCodeMpu+"/"+a.adUnitMpu,[parseInt("300"),parseInt("250")],a.advertDivIDMpu);a.adSlotMpu.addService(googletag.pubads().updateCorrelator());var o=false;if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.targeting!=null&&settings.reader.popupAdvertMpu.targeting.length>0){var k=settings.reader.popupAdvertMpu.targeting.split("|");for(var m in k){var n=k[m];var l=n.split("*");if(l!=null&&l.length>=2){l[1]=l[1].replace("{{PAGE}}",a.page.page).replace("{{SECTION}}",a.section);a.adSlotMpu.setTargeting(l[0],l[1]);if(!o){o=l[0]=="pos"}}}}if(!o){a.adSlotMpu.setTargeting("pos",a.getPageNo()+1)}if(a.isLazyLoadingInlineDfpMpuAdvert()){googletag.pubads().enableLazyLoad()}googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivIDMpu)})}}}},a.advertTimeout)},initializeInline:function(){var f=this;var j=InfinityMobile.app.application.getController("ArticlePopoverController").flippAdvertSetting;var b=j.enabled;var g="<div class='container'><div class='content'><div class='articleContent' style='font-size:"+fontEm+"px'><div class='contentHead font35'><{{BANNERTOP}}><{{HEAD}}></div><{{HEADDECK}}><{{IMAGE}}><br /><{{BYLINE}}><br /><div class='contentBody "+(b?"has-flipp":"")+" font15'><{{MPU}}><{{BODY}}><{{FLIPP}}><{{BANNERBOTTOM}}></div></div></div></div>";if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.placeInBody!=null&&settings.reader.popupAdvertMpu.placeInBody=="true"){var d=3;if(settings.reader.popupAdvertMpu.paragraphIndex!=null){d=parseInt(settings.reader.popupAdvertMpu.paragraphIndex)}g=g.replace("<{{MPU}}>","");var h=/<br.*?><br.*?>/g;var a=0;var e=false;while((match=h.exec(f.article.body))!=null){if(a==d-1){f.article.body=f.article.body.splice(match.index+match.length-1,match[0].length,match+"<{{MPU}}>");e=true;break}a++}if(!e){f.article.body+="<{{MPU}}>"}}g=g.replace("<{{HEAD}}>",f.article.headline);g=g.replace("<{{HEADDECK}}>",'<div class="contentDeck font25">'+f.article.subHeadline+"</div>");g=g.replace("<{{BYLINE}}>",f.article.byline!=null?'<div class="contentByline font15">'+f.article.byline+"</div>":"");g=g.replace("<{{BODY}}>",f.article.body);var c=f.initializeInlineImages();g=g.replace("<{{IMAGE}}>",c);if(settings.reader.popupAdvert!=null){if(settings.reader.popupAdvert.advertInArticleFlow==null||settings.reader.popupAdvert.advertInArticleFlow=="true"){if(f.isCustomBannerAd()){g=f.setupCustomInlineDfpBanner(g)}else{switch(settings.reader.popupAdvert.type.toLowerCase()){case"dfp":g=f.setupInlineDfpBanner(g);break;case"image":g=f.setupInlineImageBanner(g);break;case"url":g=f.setupInlineUrlBanner(g);break;case"adbridg":g=f.setupInlineAdbridgBanner(g);break}}}else{g=g.replace("<{{BANNERTOP}}>","");g=g.replace("<{{BANNERBOTTOM}}>","")}}else{g=g.replace("<{{BANNERTOP}}>","");g=g.replace("<{{BANNERBOTTOM}}>","")}if(f.mpuAdvertSetting.type!=null){if(f.isCustomMpuAd()){g=f.setupCustomInlineDfpMpu(g)}else{switch(f.mpuAdvertSetting.type.toLowerCase()){case"dfp":g=f.setupInlineDfpMpu(g);break;case"image":g=f.setupInlineImageMpu(g);break;case"adbridg":g=f.setupInlineAdbridgMpu(g);break}}}else{g=g.replace("<{{MPU}}>","")}g=g.replace("<{{FLIPP}}>",f.returnFlippHtml());f.content.setHtml(g);f.removeSpinner();f.content.element.on({scope:f.content,delegate:"a",tap:function(n){var m=-1;var l="";if(f.article!=null&&!!f.article){m=f.article.pageNumber!=null?f.article.pageNumber:(f.article.parentpage!=null?f.article.parentpage:m);l=f.article.headline!=null?f.article.headline:l}var k={linkUrl:n.target.href,linkName:n.target.innerText,articleNumber:f.getPageNo(),headline:l,pageNum:m};f.fireEvent("trackArticleLink",k,f)}});f.on("painted",function(){f.painted=true;if(f.mode=="frame"){f.setFrame()}f.setImages();f.checkInlineAudioMedia();if(f.element!=null){setText(f.element.dom)}if(f.parent.getActiveItem()==f){f.runFlipp()}f.fireEvent("fillPrintContainer",f)},f,{});f.on("painted",function(){if(f.element!=null){var l=$(f.element.dom).find(".fullscreengalleryicon");if(l!=null&&l.length>0){$(l).click(function(){f.createFullscreenGallery(f.article)});if(navigator.maxTouchPoints!=null){var k;l[0].addEventListener("touchstart",function(m){k=m.timeStamp});l[0].addEventListener("touchend",function(m){if(m.timeStamp-k<200){f.createFullscreenGallery(f.article)}})}}}})},runFlipp:function(){var a=InfinityMobile.app.application.getController("ArticlePopoverController").flippAdvertSetting;if(!!a&&a.enabled&&!this.hasSetupFlippOnArticle){var c=this;var b=undefined;window.flippxp=window.flippxp||{run:[]};console.log("[FLIPP] Registering flipp-div-"+c.id+" with flippxp");window.flippxp.run.pus});this.hasSetupFlippOnArticle=true}},returnFlippHtml:function(){var c=this;var a=InfinityMobile.app.application.getController("ArticlePopoverController").flippAdvertSetting;var d=a.enabled;var b=d?'<div id="flipp-div-'+c.id+'"><div class="flipp-ux-header" style="display: none; text-align: center; margin: 20px 0px; color: gray;"><a>'+a.headerText+"</a></div></div>":"";console.log("[FLIPP] Adding flipp-div-"+c.id+" to the DOM");return b},checkInlineAudioMedia:function(){var e=this;try{var b=$(e.element.dom).find("audio.inline-article-media");if(b!=null){for(var d=0;d<b.length;d++){var a=b[d];a.onmousedown=function(f){f.stopPropagation()};a.onmspointerdown=function(f){f.stopPropagation()};a.ontouchstart=function(f){f.stopPropagation()};a.ontouchmove=function(f){f.stopPropagation()};a.ontouchend=function(f){f.stopPropagation()};if(e.parent.getActiveItem()!=e){if(Ext.browser.is.Chrome){a.style.opacity="0";a.style.transition="0.5s ease opacity"}}}}}catch(c){console.warn("[ReaderArticlePopoverItem]: Error Caught\n",c)}},showHiddenInlineAudioMedia:function(){var e=this;try{if(Ext.browser.is.Chrome){var b=$(e.element.dom).find("audio.inline-article-media");if(b!=null){for(var d=0;d<b.length;d++){var a=b[d];a.style.display="inline-block";a.style.opacity="1"}}}}catch(c){console.warn("[ReaderArticlePopoverItem]: Error Caught\n",c)}},pauseAllAudio:function(){var e=this;var b=e.element!=null?$(e.element.dom).find("audio"):null;if(b!=null&&e.parent.getActiveItem()!=e){for(var d=0;d<b.length;d++){var a=b[d];try{a.pause()}catch(c){console.warn("[ReaderArticlePopoverItem]: Error Caught\n",c)}}}},setupInlineAdbridgBanner:function(d){var c=this;c.advertDivID=c.id+"advert";var b="<div id='"+c.advertDivID+"-container' style='min-height:110px;'><div id='"+c.advertDivID+"' style='width:728px;height:110px;margin:15px auto;'></div></div>";var a=settings.reader.popupAdvert;switch(a.position.toLowerCase()){case"bottom":d=d.replace("<{{BANNERBOTTOM}}>",b);d=d.replace("<{{BANNERTOP}}>","");break;case"top":d=d.replace("<{{BANNERTOP}}>",b);d=d.replace("<{{BANNERBOTTOM}}>","");break}c.on("painted",function(){if(c.parent.getActiveItem()==c){c.loadAdvert()}});return d},setupInlineDfpBanner:function(d){var b=this;var a=settings.reader.popupAdvert;if(a.networkCode!=null&&a.adUnit){b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";if(a.customClass!=null&&a.customClass.trim().length>0){var c=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"]>","g");d=d.replace(c,"<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:auto;'>");d=d.replace("<{{BANNERTOP}}>","");d=d.replace("<{{BANNERBOTTOM}}>","")}else{switch(a.position.toLowerCase()){case"bottom":d=d.replace("<{{BANNERBOTTOM}}>","<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:15px auto;'></div>");d=d.replace("<{{BANNERTOP}}>","");break;case"top":d=d.replace("<{{BANNERTOP}}>","<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:auto;'></div>");d=d.replace("<{{BANNERBOTTOM}}>","");break}}}b.on("painted",function(){if(settings.articlepopover.lazyLoadPopoverAdverts==null||settings.articlepopover.lazyLoadPopoverAdverts=="false"){b.loadAdvert()}});return d},setupCustomInlineDfpBanner:function(e){var b=this;if(!b.isCustomBannerAd()){return e}b.advertDivID=b.id+"advert";var c=true;var a="readerBannerAd";if(b.bannerAdvertSetting.customClass!=null&&b.bannerAdvertSetting.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+b.bannerAdvertSetting.customClass+"[\\'\\\"]>","g");e=e.replace(d,"<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:auto;'><div class='banner-article'></div>");e=e.replace("<{{BANNERTOP}}>","");e=e.replace("<{{BANNERBOTTOM}}>","")}else{if(b.bannerAdvertSetting.position!=null){switch(b.bannerAdvertSetting.position.toLowerCase()){case"bottom":e=e.replace("<{{BANNERBOTTOM}}>","<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:15px auto;'><div class='banner-article'></div></div>");e=e.replace("<{{BANNERTOP}}>","");break;case"top":e=e.replace("<{{BANNERTOP}}>","<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:auto;'><div class='banner-article'></div></div>");e=e.replace("<{{BANNERBOTTOM}}>","");break;default:c=false;break}}else{e=e.replace("<{{BANNERTOP}}>","");e=e.replace("<{{BANNERBOTTOM}}>","");c=false}}if(c===true){b.on("painted",function(){if(!b.isLazyLoadCustomBannerAdvert()){b.loadAdvert()}},b,{single:true})}return e},setupInlineImageBanner:function(f){var d=this;var b=settings.reader.popupAdvert;d.advertDivID=d.id+"advert";if(b.url!=null){var a="";var c="";if(b.link!=null&&b.link.trim().length>0){a="cursor:pointer;";c="onclick=\"window.open('"+b.link+'\');" ontouchstart="this.start = event.timeStamp" ontouchend="if(event.timeStamp - this.start < 75){window.open(\''+b.link+"');}\""}if(b.customClass!=null&&b.customClass.trim().length>0){var e=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+b.customClass+"[\\'\\\"]>","g");f=f.replace(e,"<div "+c+" id='"+d.advertDivID+"' style='"+a+'width:728px;height:110px;margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' >")}else{if(b.position!=null&&b.position=="top"){f=f.replace("<{{BANNERTOP}}>","<div "+c+" id='"+d.advertDivID+"' style='"+a+'width:728px;height:110px;margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;'></div>");f=f.replace("<{{BANNERBOTTOM}}>","")}else{f=f.replace("<{{BANNERBOTTOM}}>","<div "+c+" id='"+d.advertDivID+"' style='"+a+'width:728px;height:110px;margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;'></div>");f=f.replace("<{{BANNERTOP}}>","")}}d.content.element.on({scope:d.content,delegate:"#"+d.advertDivID,tap:function(){mainPanel.fireEvent("trackAdvertClick","banner")}})}return f},setupInlineUrlBanner:function(d){var b=this;var a=settings.reader.popupAdvert;b.advertDivID=b.id+"advert";if(a.url!=null){var c=settings.articlepopover.lazyLoadPopoverAdverts=="true"?"":"src='"+a.url+"' ";if(a.position!=null&&a.position=="top"){d=d.replace("<{{BANNERTOP}}>","<iframe "+c+" id='"+b.advertDivID+"' style='width:728px;height: 90px; margin: 20px auto; display: inherit; border: none;'></iframe>");d=d.replace("<{{BANNERBOTTOM}}>","")}else{d=d.replace("<{{BANNERBOTTOM}}>","<iframe "+c+" id='"+b.advertDivID+"' style='width:728px;height: 90px; margin: 20px auto; display: inherit; border: none;'></iframe>");d=d.replace("<{{BANNERTOP}}>","")}}return d},setupInlineAdbridgMpu:function(e){var c=this;var a=settings.reader.popupAdvertMpu;c.advertDivIDMpu=c.id+"mpu";var b="mpuAdvert mpudesktop";if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.placeInBody!=null&&settings.reader.popupAdvertMpu.placeInBody=="true"){b+=" mpu-inbody"}if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_s]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"][\\s]?>","g");e=e.replace(d,'<div id="'+c.advertDivIDMpu+"-container\" class='"+b+"' ><div id='"+c.advertDivIDMpu+"'></div></div>");e=e.replace("<{{MPU}}>","")}else{e=e.replace("<{{MPU}}>",'<div id="'+c.advertDivIDMpu+"-container\" class='"+b+"' ><div id='"+c.advertDivIDMpu+"'></div></div>")}c.on("painted",function(){if(c.parent.getActiveItem()==c){c.loadAdvertMpu()}});return e},setupInlineDfpMpu:function(e){var c=this;var a=settings.reader.popupAdvertMpu;if(a.networkCode!=null&&a.adUnit){c.networkCodeMpu=a.networkCode;c.adUnitMpu=a.adUnit;c.advertDivIDMpu=c.id+"mpu";var b="mpuAdvert mpudesktop";if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.placeInBody!=null&&settings.reader.popupAdvertMpu.placeInBody=="true"){b+=" mpu-inbody"}if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_s]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"][\\s]?>","g");e=e.replace(d,'<div id="'+c.advertDivIDMpu+"\" class='"+b+"' >");e=e.replace("<{{MPU}}>","")}else{e=e.replace("<{{MPU}}>",'<div id="'+c.advertDivIDMpu+"\" class='"+b+"' ></div>")}c.on("painted",function(){console.count("Desktop - Painted");if((settings.articlepopover.lazyLoadPopoverAdverts==null||settings.articlepopover.lazyLoadPopoverAdverts=="false")||c.isLazyLoadingInlineDfpMpuAdvert()){c.loadAdvertMpu()}})}return e},setupCustomInlineDfpMpu:function(d){var b=this;if(!b.isCustomMpuAd()){return d}var a="mpuAdvert mpudesktop";if(b.mpuAdvertSetting.placeInBody=="true"){a+=" mpu-inbody"}if(b.mpuAdvertSetting.customClass!=null&&b.mpuAdvertSetting.customClass.trim().length>0){var c=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_s]*class=[\\'\\\"]"+b.mpuAdvertSetting.customClass+"[\\'\\\"][\\s]?>","g");d=d.replace(c,"<div class='"+a+"' style=\"text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;\"><div class='mpu-article'></div>");d=d.replace("<{{MPU}}>","")}else{d=d.replace("<{{MPU}}>",'<div class="'+a+'" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;"><div class=\'mpu-article\'></div></div>')}b.on("painted",function(){if(!b.isLazyLoadCustomMpuAdvert()){b.loadCustomAdvertMpu()}},b,{single:true});return d},loadCustomAdvertMpu:function(){var a=this;setTimeout(function(){if(a.destroyed===true||a.isCustomMpuAd()===false){return}var c=$(a.element.dom).find(".mpu-article")[0];var d=a.getMetaDataToSetupCustomMpuAd();var b=function(){if(c&&window[d.className]!=null&&a.customMpuAd==null){a.customMpuAd=new window[d.className](a.id+"mpu-article",c,currentProfile,a.mpuAdvertSetting.config);a.customMpuAd.loadAdvert(a.page.page)}else{if(a.customMpuAd!=null){a.customMpuAd.refreshAdvert(a.page.page)}}};if(a.mpuAdvertSetting.config==null){a.ajaxRequestMpu=$.ajax({url:d.configUrl+(d.configUrl.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(e){a.hasConfig=true;a.mpuAdvertSetting.config=e;if(!a.destroyed){b()}},error:function(e,g,f){}})}else{b()}},a.advertTimeout)},setupInlineImageMpu:function(f){var d=this;var b=settings.reader.popupAdvertMpu;d.advertDivIDMpu=d.id+"mpu";if(b.url!=null){var a="";var c="";if(b.link!=null&&b.link.trim().length>0){a="cursor:pointer;";c="onclick=\"window.open('"+b.link+'\');" ontouchstart="this.start = event.timeStamp" ontouchend="if(event.timeStamp - this.start < 75){window.open(\''+b.link+"');}\""}if(b.customClass!=null&&b.customClass.trim().length>0){var e=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_s]*class=[\\'\\\"]"+b.customClass+"[\\'\\\"][\\s]?>","g");f=f.replace(e,'<div id="'+d.advertDivIDMpu+"\" class='mpuAdvert' style='"+a+'background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' "+c+">");f=f.replace("<{{MPU}}>","")}else{f=f.replace("<{{MPU}}>",'<div id="'+d.advertDivIDMpu+"\" class='mpuAdvert' style='"+a+'background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' "+c+"></div>")}d.content.element.on({scope:d.content,delegate:"#"+d.advertDivIDMpu,tap:function(){mainPanel.fireEvent("trackAdvertClick","bannerMPU")}})}return f},createFullscreenGallery:function(d){var b=this;var a=[];for(image in d.images){a.push({url:d.images[image].url})}if(currentProfile=="desktop"){var e="InfinityMobile.view.desktop.ImageGallery"}else{var e="InfinityMobile.view.tablet.ImageGallery"}var c=Ext.create(e,{images:a,article:d,dynamicview:false,zIndex:99999999});Ext.Viewport.add(c);c.show()},initializeInlineImagesNewsday:function(){var d=this;var g=d.article.images;var a="";if(g!=null&&g.length>0){var b="<div class=\"contentImage imagecontainerblack\"><div class=\"imageandiconscontainer\"><div class=\"iconscontainer\" ><div class='articlevideoicon pointerCursor'></div><div class='linkicon pointerCursor' ></div><div class='ogalleryicon pointerCursor' ></div><div class='galleryicon pointerCursor' ></div></div><img class='articleImg' src=\"{{imageurl}}\" alt=\"\" /></div>{{imagecaption}}</div>";var c="";var e=g[0];var f="";if(e.credit!=null){if(e.credit.trim().length>0){f=" ("+e.credit+")"}}c+=b.replace("{{imageurl}}",e.url.replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com")).replace("{{imagecaption}}",'<div class="contentcaption captionlineheight font13">'+e.caption+f+"</div>");a=c}return a},initializeInlineImages:function(){var j=this;var l=j.article.images;var c="NEXT IMAGE";if(language.articlePopover.nextImage!=null){c=language.articlePopover.nextImage.toUpperCase()}var k="PREVIOUS IMAGE";if(language.articlePopover.previousImage!=null){k=language.articlePopover.previousImage.toUpperCase()}var m="";if(l!=null&&l.length>0){var f="<div class=\"contentImages\" style='position:relative;'><div style='position:absolute;top:0px;right:0px;z-index:1;'>{{fullscreengallery}}</div>{{imagescontent}}</div>";var g='<div class="contentImage"><img src="{{imageurl}}" alt="" />{{imagecaption}}</div>';var b="";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){for(var h=l.length-1;h>=0;h--){var d=l[h];var a=d.url;a=a.replace("http://media.cdn.pagesuite.com","https://media.pagesuite.com").replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com");b+=g.replace("{{imageurl}}",a).replace("{{imagecaption}}",'<div class="contentCaption font13">'+d.caption+"</div>")}}else{for(var h=0;h<l.length;h++){var d=l[h];var a=d.url;a=a.replace("http://media.cdn.pagesuite.com","https://media.pagesuite.com").replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com");b+=g.replace("{{imageurl}}",a).replace("{{imagecaption}}",'<div class="contentCaption font13">'+d.caption+"</div>")}}var e='<div class="imageControls"><a href="javascript:void(0)" class="previousImage">'+k+'<img class="imgPreviousImage" src="'+location.protocol+"//"+location.host+'/tribune/left-image-arrow.png" alt="" /></a><div class="imageCount">Image</div><a href="javascript:void(0)" class="nextImage">'+c+'<img class="imgNextImage" src="'+location.protocol+"//"+location.host+'/tribune/right-image-arrow.png" alt="" /></a></div>';b+=e;if(settings.articlepopover!=null&&settings.articlepopover.enablePopoverImageGallery!=null&&settings.articlepopover.enablePopoverImageGallery=="true"){f=f.replace("{{fullscreengallery}}","<div class='fullscreengalleryicon pointerCursor' ></div>")}else{f=f.replace("{{fullscreengallery}}","")}m=f.replace("{{imagescontent}}",b)}return m},checkLanguag},initializeLanguage:function(){var a=this;a.on("painted",a.getLanguageContent,a,{delay:10,single:true})},getLanguageContent:function(){var a=this},initializeForWeb:function(){var a=this;if(a.getPage()!=null){if(a.getPage().file==a.getPage().guid){a.popoverType="guid"}a.articleguid=a.getPage().file}a.on("painted",a.getContent,a,{delay:10,single:true})},setContentStyle:function(){var a=this;if(currentProfile=="tablet"){a.content.setPadding("0 20px 0 20px")}},getContent:function(){var d=this;var a=d.articleguid;d.painted=true;d.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");if(typeof isTribReader!="undefined"&&isTribReader&&(d.lang=="es"||d.lang=="en")){var b="&lang="+d.lang}else{var b=""}var c="../article_popover.aspx?articleguid="+a+"&html5="+currentProfile;if(d.popoverType=="guid"){d.content.element.dom.style.overflowY="";c="../article_popover.aspx?guid="+a+"&html5="+currentProfile}$.ajax({crossDomain:true,type:"GET",contentType:"text/html",async:true,url:c,success:function(j){var k=Ext.getStore("SettingStore");var l=j;var g=l.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(g){l=g[1]}d.articleText=l;l+="<script>setText()<\/script>";l=l.replace("<{{navbar}}>","");if(settings.reader.popupAdvert!=null){var n=settings.reader.popupAdvert;switch(n.type.toLowerCase()){case"dfp":l=d.setupDfpAdvertContent(l);break;case"image":l=d.setupImageAdvertContent(l);break}}if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.customClass!=null){var q=settings.reader.popupAdvertMpu;switch(q.type.toLowerCase()){case"dfp":l=d.setupDfpAdvertContentMpu(l);break}}var e=d.returnFlippHtml();l+=e;d.removeSpinner();d.unmask();d.content.setHtml(l);d.content.setPadding("0px");d.parseGalleryItemsForMediaObjectArticle(l);if(d.mode=="frame"){d.setFrame()}else{if(d.parent.getActiveItem()==d){d.runFlipp()}}if(settings.reader.popupAdvert!=null&&(settings.articlepopover.lazyLoadPopoverAdverts==null||settings.articlepopover.lazyLoadPopoverAdverts=="false")){d.loadAdvert()}if(settings.reader.popupAdvertMpu!=null){if(settings.reader.popupAdvertMpu.customClass==null){switch(settings.reader.popupAdvertMpu.type.toLowerCase()){case"dfp":d.setUpMpuInline();break}}if(settings.articlepopover.lazyLoadPopoverAdverts==null||settings.articlepopover.lazyLoadPopoverAdverts=="false"){d.loadAdvertMpu()}}d.setImages();d.setGalleryButtonForMediaObjectArticle();if(d.element!=null){d.printImage=d.element.down(".printImage")}if(d.content.element!=null){setText(d.content.element.dom)}d.setStyle({visibility:"inherit"});d.fireEvent("fillPrintContainer",d);if($(d.element.dom).find(".DS-storyimage__link")!=null){if($(d.element.dom).find(".DS-storyimage__link")[0]!=null){var o=$(d.element.dom).find(".DS-storyimage__link")[0];var h=$(o).find("img")[0];var p=o.parentElement;d.imgUrl=$(o).attr("href");o.remove();p.appendChild(h);$(h).addClass("pointerCursor");h.onclick=function(){d.mediaHuisImgClick()}}}if(typeof isTribReader!="undefined"){if(isTribReader){var f=$(d.element.dom).find(".articleContentHtml5");if(f.length>0){$(f[0]).css("padding-right","25px");$(f[0]).css("padding-left","25px")}}}d.content.element.on({scope:d.content,delegate:"a",tap:function(m){if(currentProfile!="desktop"){window.location.href=m.target}}})}})},parseGalleryItemsForMediaObjectArticle:function(g){var j=this;if(settings.articlepopover!=null&&settings.articlepopover.enablePopoverImageGallery!=null&&settings.articlepopover.enablePopoverImageGallery=="true"){try{var a=new DOMParser();var e=a.parseFromString(g,"text/html").getElementsByClassName("contentImage");var c=a.parseFromString(g,"text/html").getElementsByClassName("contentHead");console.log(j.content.element.dom);console.log(a);console.log(j.content.element.dom.getElementsByClassName("contentImage"));j.galleryArticles={headline:c[0].innerHTML,images:[]};for(var d=0;d<e.length;d++){var f={};var b=e[d].innerHTML.match(/<img [^>]*src="[^"]*"[^>]*>/gm);f.url=b[0].replace(/.*src="([^"]*)".*/,"$1");f.caption=e[d].innerText;j.galleryArticles.images.push(f)}delete a}catch(h){console.warn("[ReaderArticlePopoverItem]: Error Caught\n",h)}}},setGalleryButtonForMediaObjectArticle:function(){var d=this;if(settings.articlepopover!=null&&settings.articlepopover.enablePopoverImageGallery!=null&&settings.articlepopover.enablePopoverImageGallery=="true"){var e=document.querySelectorAll(".contentImage");for(var c=0;c<e.length;c++){e[c].insertAdjacentHTML("afterbegin","<div style='position:absolute;top:0px;right:0px;z-index:1;'><div class='fullscreengalleryicon pointerCursor'></div></div>")}var b=$(d.element.dom).find(".fullscreengalleryicon");if(b!=null&&b.length>0){$(b).click(function(){d.createFullscreenGallery(d.galleryArticles)});if(navigator.maxTouchPoints!=null){var a;b[0].addEventListener("touchstart",function(f){a=f.timeStamp});b[0].addEventListener("touchend",function(f){if(f.timeStamp-a<200){d.createFullscreenGallery(d.galleryArticles)}})}}}},setupDfpAdvertConten},setupDfpAdvertContentMpu:function(c){var b=this;var a=settings.reader.popupAdvertMpu;if(a.networkCode!=null&&a.adUnit){b.networkCodeMpu=a.networkCode;b.adUnitMpu=a.adUnit;b.advertDivIDMpu=b.id+"mpu";if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"]>","g");c=c.replace(d,'<div id="'+b.advertDivIDMpu+"\" class='mpuAdvert' >")}b.on("painted",function(){b.loadAdvert()})}return c},setUpMpuInlin},setupImageAdvertContent:function(f){var e=this;var b=settings.reader.popupAdvert;e.advertDivID=e.id+"advert";if(b.url!=null){var a="";var d="";if(b.link!=null&&b.link.trim().length>0){a="cursor:pointer;";d="onclick=\"window.open('"+b.link+'\');" ontouchstart="this.start = event.timeStamp" ontouchend="if(event.timeStamp - this.start < 75){window.open(\''+b.link+"');}\""}var c="<div "+d+" id='"+e.advertDivID+"' style='"+a+'width:728px;height:110px;margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' ></div>";if(b.customClass!=null&&b.customClass.trim().length>0){var g=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+b.customClass+"[\\'\\\"]>","g");f=f.replace(g,"<div "+d+" id='"+e.advertDivID+"' style='"+a+'width:728px;height:110px;margin:auto;background-image:url(" + popupAdvertSettings.url + ");background-size:contain;background-position:center;background-repeat:no-repeat;\' >')}else{if(b.position!=null&&b.position=="top"){f=c+"</div>"+f;f=f.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}else{f=f+c+"</div>";f=f.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}}}return f},mediaHuisImgClic},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var f=this;var d=1;var c=1;var b=f.id;if(currentProfile=="tablet"){var e=$("#"+b+" img").get(0);if(e!=null){if(e.naturalWidth==0){e.onload=function(){var g=this;if(g.naturalWidth<(screen.width/2)){var h=$("#"+b+" .articleContent")[0];h.className="articleContent float background-image-overwrite"}}}}}if($("#"+b+" .contentImage").size()>1){if(currentProfile=="phone"){if(typeof isTribReader!="undefined"&&isTribReader&&(f.lang&&f.lang=="es")){$("#"+b+" .nextImage")[0].childNodes[0].textContent="ANTERIOR";$("#"+b+" .previousImage")[0].childNodes[0].textContent="SIGUIENTE"}else{$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREVIOUS"}}else{if(typeof isTribReader!="undefined"&&isTribReader&&(f.lang&&f.lang=="es")){$("#"+b+" .nextImage")[0].childNodes[0].textContent="ANTERIOR IMAGEN";$("#"+b+" .previousImage")[0].childNodes[0].textContent="SIGUIENTE IMAGEN"}}c=$("#"+b+" .contentImage").size();if(c>1){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){$("#"+b+" .contentImage:lt("+(c-1)+")").hide();$("#"+b+" .nextImage").hide()}else{$("#"+b+" .contentImage:gt(0)").hide();$("#"+b+" .previousImage").hide()}a()}else{if(c==1){$("#"+b+" .imageControls").hide()}}$("#"+b+" .nextImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").next();h.hide();if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){d--}else{d++}a();g.fadeIn();$("#"+b+" .previousImage").show();if(g.is("#"+b+" .contentImage:last")){$("#"+b+" .nextImage").hide()}mainPanel.fireEvent("articleNextImageClick",f,d)});$("#"+b+" .previousImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").prev();h.hide();if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){d++}else{d--}a();g.fadeIn();$("#"+b+" .nextImage").show();if(g.is("#"+b+" .contentImage:first")){$("#"+b+" .previousImage").hide()}mainPanel.fireEvent("articlePreviousImageClick",f,d)})}else{$("#"+b+" .imageControls").hide()}function a(){if(typeof isTribReader!="undefined"&&isTribReader&&(f.lang&&f.lang=="es")){var h="Imagen "+d.toString()+" de "+c.toString()}else{var j=typeof language!="undefined"&&language.image!=null?language.image:"Image";var g=typeof language!="undefined"&&language.of!=null?language.of:"of";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){var h=c.toString()+" / "+d.toString()+" "+j}else{var h=j+" "+d.toString()+" "+g+" "+c.toString()}}$("#"+b+" .imageCount").text(h)}},intializeForIframe:function(){var a=this;if(a.getPage()!=null){if(a.getPage().file==a.getPage().guid){a.popoverType="guid"}a.articleguid=a.getPage().file}a.on("painted",a.getIframeContent,a,{delay:10,single:true})},getIframeContent:function(){var d=this;var a=d.articleguid;d.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");var c="../article_popover_for_iframe.aspx?guid="+a+"&html5="+currentProfile;if(d.popoverType=="guid"){d.content.element.dom.style.overflowY="";c="../article_popover_for_iframe.aspx?guid="+a+"&html5="+currentProfile}d.content.setHtml('<iframe style="border:none;width:100%;height:100%;" class="iframePopover" src="'+c+'" />');var b=$(d.content.element.dom).find(".iframePopover")[0];b.onload=function(){d.removeSpinner();if(b.contentWindow.SetPlatformType!=null){b.contentWindow.SetPlatformType("web")}if(b.contentWindow!=null&&typeof b.contentWindow.updateText=="function"&&typeof fontEm!="undefined"){b.contentWindow.updateText(fontEm)}$(".printContainer")[0].innerHTML=("<div class='DS-layout-detail DS-modus-replica DS-is-online miller-loaded LB-layout-detail LB-modus-replica LB-platform-web merriweather-400-loaded merriweather-700-loade'><div class='DS-root' style='padding: 20px;'>"+b.contentDocument.documentElement.innerHTML.trim()+"</div></div>")}},destroy:function(){var b=this;if(b.adSlot!=null&&typeof googletag!="undefined"){googletag.destroySlots([b.adSlot])}if(b.adSlotMpu!=null&&typeof googletag!="undefined"){googletag.destroySlots([b.adSlotMpu])}try{b.destroyAdverts()}catch(a){console.error("ReaderArticlePopoverItem]: Error Caught",a)}b.destroyed=true;if(b.updateLinkAjax!=null&&typeof b.updateLinkAjax.abort==="function"){b.updateLinkAjax.abort()}if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){b.removeTemplateFrameTouchListeners();if(b.templateRequest&&typeof b.templateRequest.abort==="function"){b.templateRequest.abort()}if(b.writeTimeout!=null){clearTimeout(b.writeTimeout)}if(b.displayTemplateTimeout!=null){clearTimeout(b.displayTemplateTimeout)}}try{Ext.Container.prototype.destroy.apply(this,arguments)}catch(a){}},getSelectedText:function(){var c=this;var d="";try{if(c.contentTemplateIframe!=null){var a=c.contentTemplateIframe.contentDocument||c.contentTemplateIframe.contentWindow.document;if(typeof a.getSelection!="undefined"){d=a.getSelection().toString()}else{if(typeof a.selection!="undefined"&&a.selection.type=="Text"){d=a.selection.createRange().text}}}}catch(b){console.log("[ReaderArticlePopoverItem]: Error Caught",b)}return d},setFrame:function(){var a=this;a.mode=="frame";a.setIframeContent()},toggleToTextMode:function(){var a=this;if(a.mode=="html"){if(a.painted){a.setIframeContent()}a.setActiveItem(a.contentIframe);a.mode="frame"}else{a.setActiveItem(a.content);a.mode="html"}},checkAdbridgAdvertStylingForIframe:function(){var d=this;var b="";var a=typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.popupAdvert?settings.reader.popupAdvert:{};if(a.type=="adbridg"){b+="#"+d.advertDivID+"-container { display:none; }\n"}var c=typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.popupAdvertMpu?settings.reader.popupAdvertMpu:{};if(c.type=="adbridg"){b+="#"+d.advertDivIDMpu+"-container { display:none; }\n"}return !!b?"<style>"+b+"</style>":""},setIframeContent:function(){var h=this;if(h.contentIframe!=null&&h.contentIframe.getHtml()==null){h.contentIframe.setHtml("<iframe class=\"articleiframe\" style='width:100%; height:100%; border:none'></iframe>");var d=h.contentIframe.element.down("iframe").dom;var k="phoneArticle";if(currentProfile=="tablet"){k="tabletArticle"}var a="<div class='"+k+"'>"+h.content.getHtml()+'</div><script>setImages("'+currentProfile+'");<\/script>';var c="";if(typeof customCSS!="undefined"){var m=customCSS.split("|");for(var e=0;e<m.length;e++){var l=atob(m[e]);c+="<link rel='stylesheet' type='text/css' href='"+l+"' />"}}var j="<script>cols[i].style.fontSize = font35Size;<\/script>";var g="<style>body { margin:0 } p { margin:0; padding:0; } .articleContentHtml5, .articleContent { overflow:auto !important; /*padding: 0 20px*/; height: 100% !important; font-size:"+fontEm+"px } .imageControls{ display:none; }</style><script>function updateText(fontsize) { document.getElementsByClassName('articleContent')[0].style.fontSize = fontsize + 'px' }<\/script>";var f="<html><head>{{HEAD}}</head><body class='in-iframe'>{{BODY}}</body></html>";var b="<link rel='stylesheet' type='text/css' href='resources/css/article.css'>"+c+'<script src="resources/js/articleGallery.js?build='+buildguid+'"><\/script><script>window.onload = function(){ setImages(); }<\/script>'+g;b+=h.checkAdbridgAdvertStylingForIframe();f=f.replace("{{HEAD}}",b);f=f.replace("{{BODY}}",a);f=f.replace("setText()","");h.iframe=d.contentWindow?d.contentWindow:(d.contentDocument.document?d.contentDocument.document:d.contentDocument);f=h.checkIframeAdvert(f);h.iframe.document.write(f)}},checkIframeAdvert:function(c){var b=this;var a=c;if(typeof settings!="undefined"&&settings.reader!=null){if(settings.reader.popupAdvert!=null){a=b.setupIframeAdvert(settings.reader.popupAdvert,a)}if(settings.reader.popupAdvertMpu!=null){a=b.setupIframeMpuAdvert(settings.reader.popupAdvertMpu,a)}return a}},setupIframeMpuAdvert:function(c,a){var b=this;switch(c.type){case"dfp":return b.setupDfpIframeMpuAdvert(c,a);break;default:return a;break}},setupIframeAdvert:function(b,c){var a=this;switch(b.type){case"dfp":return a.setupDfpIframeAdvert(b,c);break;default:return c}},setupDfpIframeMpuAdvert:function(f,c){var e=this;if(c!=null){var g=c;e.advertIframeDivIDMpu=e.advertDivIDMpu+"-iframe";g=g.replace(e.advertDivIDMpu,e.advertIframeDivIDMpu);var b="";if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.targeting!=null&&settings.reader.popupAdvertMpu.targeting.length>0){b="var targets = '"+settings.reader.popupAdvertMpu.targeting+'\'.split("|");for (var i in targets) {var thisTarget = targets[i];var values = thisTarget.split("*");if (values != null && values.length >= 2) {values[1] = values[1].replace("{{PAGE}", \''+e.page.page+"').replace(\"{{SECTION}}\", '"+e.section+"');adSlot1.setTargeting(values[0], values[1]);}}"}var d="";var a=e.returnGoogletagString();if(g.indexOf(a)==-1){d=a}g=d+"<script>window.loadAdvertMpu = function(){\ngoogletag.cmd.push(function () {\nvar adSlot1 = googletag.defineSlot('/"+e.networkCodeMpu+"/"+e.adUnitMpu+"', [parseInt('300'), parseInt('250')],'"+e.advertIframeDivIDMpu+"');\nadSlot1.addService(googletag.pubads().updateCorrelator());"+b+"googletag.enableServices();\n});\ngoogletag.cmd.push(function () {\ngoogletag.display('"+e.advertIframeDivIDMpu+"');\n});\n} <\/script>"+g;return g}},setupDfpIframeAdver},returnGoogletagString:function(){return'<script>var googletag = googletag || {};googletag.cmd = googletag.cmd || [];(function () {var gads = document.createElement("script");gads.async = true; gads.type = "text/javascript"; var useSSL = "https:" == document.location.protocol;gads.src = (useSSL ? "https:" : "http:") + "//www.googletagservices.com/tag/js/gpt.js"; var node = document.getElementsByTagName("script")[0];node.parentNode.insertBefore(gads, node);})();<\/script >'},loadIframeAdvertMpu:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvertMpu!=null){switch(settings.reader.popupAdvertMpu.type){case"dfp":a.loadIframeDfpAdvertMpu();break}}},loadIframeAdvert:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){switch(settings.reader.popupAdvert.type){case"dfp":a.loadIframeDfpAdvert();break}}},loadIframeDfpAdvertMpu:function(){var a=this;setTimeout(function(){if(!a.destroyed){if(a.iframe!=null&&a.iframe.loadAdvertMpu!=null){a.iframe.loadAdvertMpu()}}},a.advertTimeout)},loadIframeDfpAdvert:function(){var a=this;setTimeout(function(){if(!a.destroyed){if(a.iframe!=null&&a.iframe.loadAdvert!=null){a.iframe.loadAdvert()}}},a.advertTimeout)},translateArticl},getContentLang:function(){var c=this;var a=c.articleguid;c.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");var b="http://edition.pagesuite.com/tribune/article_popover_phil.aspx?guid="+a+"&html5="+currentProfile+"&lang=es";if(c.popoverType=="guid"){c.content.element.dom.style.overflowY="";b="http://edition.pagesuite.com/tribune/article_popover_phil.aspx?guid="+a+"&html5="+currentProfile+"&lang=es"}$.ajax({crossDomain:true,type:"GET",contentType:"text/html",async:true,url:b,success:function(h){var j=Ext.getStore("SettingStore");if(j.data.items[0].raw.reader.popupAdvert!=null){var k=j.data.items[0].raw.reader.popupAdvert.position;if(k=="top"){switch(currentProfile){case"phone":var l=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var l=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var l=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break}c.add(l);l.show()}}var n=h;var e=n.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(e){n=e[1]}c.articleText=n;n+="<script>setText()<\/script>";c.removeSpinner();c.content.setHtml(n);c.content.setPadding("0px");c.setImages();if(c.content.element!=null){setText(c.content.element.dom)}c.setStyle({visibility:"inherit"});if(j.data.items[0].raw.reader.popupAdvert!=null){if(k=="bottom"){switch(currentProfile){case"phone":var g=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{padding:"10px 0 0 0"});break}c.add(g);g.show()}}if($(c.element.dom).find(".DS-storyimage__link")!=null){if($(c.element.dom).find(".DS-storyimage__link")[0]!=null){var o=$(c.element.dom).find(".DS-storyimage__link")[0];var f=$(o).find("img")[0];var p=o.parentElement;c.imgUrl=$(o).attr("href");o.remove();p.appendChild(f);$(f).addClass("pointerCursor");f.onclick=function(){c.mediaHuisImgClick()}}}if(typeof isTribReader!="undefined"){if(isTribReader){var d=$(c.element.dom).find(".articleContentHtml5");if(d.length>0){$(d[0]).css("padding-right","25px");$(d[0]).css("padding-left","25px")}}}c.content.element.on({scope:c.content,delegate:"a",tap:function(m){if(currentProfile!="desktop"){window.location.href=m.target}}})}})},sendNewPageViewForHtlbidCustomAd:function(){try{if(this.newPageViewForHtlbidCustomAdPending===true){this.newPageViewForHtlbidCustomAdPending=false;InfinityMobile.app.application.getController("ArticlePopoverController").sendNewPageViewForHtlbidCustomAd()}}catch(a){console.warn("[ReaderArticlePopoverItem]: Error Caught",a)}},destroyAdverts:function(){if(!this.destroyed){if(this.customBannerAd!=null&&this.customBannerAd.destroyAdvert!=null){this.customBannerAd.destroyAdvert();this.customBannerAd=null}if(this.customMpuAd!=null&&this.customMpuAd.destroyAdvert!=null){this.customMpuAd.destroyAdvert();this.customMpuAd=null}}}},0,["readerarticlepopoveritem"],["component","container","readerarticlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true},["widget.readerarticlepopoveritem"],0,[InfinityMobile.view.desktop,"ReaderArticlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArticlePopoverItem",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",section:"",article:null,cls:["loading","article-popover-item"],layout:"vbox",items:[{itemId:"content",flex:1,layout:"card",cls:"verticalscrollfixedwidth",items:[{layout:"fit",itemId:"contentHtml"},{itemId:"contentIframe",cls:"contentIframe",layout:"fit",height:"100%"}]}]},statics:{isCustomBannerAd:null,isCustomMpuAd:null,getBannerAdSetting:function(){var a=(typeof settings=="object"&&!!settings&&"reader" in settings&&typeof settings.reader=="object"&&!!settings.reader)?settings.reader:{};return("popupAdvert" in a&&typeof a.popupAdvert=="object"&&!!a.popupAdvert)?a.popupAdvert:{}},getMpuAdSetting:function(){var a=(typeof settings=="object"&&!!settings&&"reader" in settings&&typeof settings.reader=="object"&&!!settings.reader)?settings.reader:{};return("popupAdvertMpu" in a&&typeof a.popupAdvertMpu=="object"&&!!a.popupAdvertMpu)?a.popupAdvertMpu:{}},isBannerAdTypeCustom:function(){try{if(typeof InfinityMobile.view.desktop.ReaderArticlePopoverItem.isCustomBannerAd==="boolean"){return InfinityMobile.view.desktop.ReaderArticlePopoverItem.isCustomBannerAd}var a=InfinityMobile.view.desktop.ReaderArticlePopoverItem.getBannerAdSetting();var c="type" in a&&!!a.type?a.type:"";return c.indexOf("custom|")>=0}catch(b){console.warn("[ReaderArticlePopoverItem]: Error Caught",b)}return false},isMpuAdTypeCustom:function(){try{if(typeof InfinityMobile.view.ReaderArticlePopoverItem.isCustomMpuAd==="boolean"){return InfinityMobile.view.ReaderArticlePopoverItem.isCustomMpuAd}var c=InfinityMobile.view.ReaderArticlePopoverItem.getMpuAdSetting();var b="type" in c&&!!c.type?c.type:"";return b.indexOf("custom|")>=0}catch(a){console.warn("[ReaderArticlePopoverItem]: Error Caught",a)}return false}},initialize:function(){var f=this;f.bannerAdvertSetting=f.statics().getBannerAdSetting();f.mpuAdvertSetting=f.statics().getMpuAdSetting();if(f.statics().isCustomBannerAd==null){f.statics().isCustomBannerAd=f.statics().isBannerAdTypeCustom()}if(f.statics().isCustomMpuAd==null){f.statics().isCustomMpuAd=f.statics().isMpuAdTypeCustom()}f.loadType="";f.destroyed=false;f.advertTimeout=2000;if(settings.articlepopover.lazyLoadPopoverAdverts!=null&&settings.articlepopover.lazyLoadPopoverAdverts=="true"){f.advertTimeout=1500}f.contentCard=f.getComponent("content");f.content=f.contentCard.getComponent("contentHtml");f.contentIframe=f.contentCard.getComponent("contentIframe");if(f.config.pageNo!=null){f.pageNo=f.config.pageNo}if(f.config.section!=null){f.section=f.config.section}if(f.config.page!=null){f.page=f.config.page}f.popoverType="article";f.painted=false;f.mode="html";if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){}else{if((f.config.highlightMode!=null&&f.config.highlightMode==true)||(f.config.readAloudMode!=null&&f.config.readAloudMode)){f.mode="frame";f.contentCard.setActiveItem(f.contentIframe)}}if(InfinityMobile.app.getController("MediaController").currentLang){f.lang=InfinityMobile.app.getController("MediaController").currentLang}var d=false;f.mediaObject=f.config.page;if((settings.newsday)||(f.getArticle()!=null&&f.mediaObject.file!=f.mediaObject.guid)){d=true;f.loadType="inline"}var c=true;if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){c=false;f.setupArticleTemplate()}else{if(settings.reader.iframePopover!=null&&settings.reader.iframePopover=="true"){f.intializeForIframe()}else{if(d){f.article=$.extend(true,{},articleDictionary[f.getArticle()]);if(settings.newsday!=null&&settings.newsday.useNewsdayTemplate!=null&&settings.newsday.useNewsdayTemplate=="true"){var e=true;f.initializeInlineNewsday()}else{var e=false;if(f.isLazyLoadingInlineDfpMpuAdvert()){f.advertTimeout=0}f.initializeInline()}var b=InfinityMobile.app.application.getController("ArticlePopoverController").flippAdvertSetting;if(b.enabled){c=false;f.setupNativeScrolling()}}else{var b=InfinityMobile.app.application.getController("ArticlePopoverController").flippAdvertSetting;if(b.enabled){c=false;f.addCls("has-flipp");f.setupNativeScrolling()}f.initializeForWeb()}}}if(c){f.contentArea=f.content;f.contentArea.setScrollable({direction:"vertical",directionLock:true});var a=$(f.element.dom).find(".x-scroll-scroller-vertical")[0];f.setContentAreaPadding(a)}},setupNativeScrolling:function(){var d=this;var c=d.element.down(".x-container:not(.verticalscrollfixedwidth)").dom;c.style.overflowY="scroll";d.setContentAreaPadding(c);var a,b=0;var e=false;touchstar};touchmove=function(l){try{var h=l.touches[0].clientY;var j=l.touches[0].clientX;var f=h-a;var g=j-b;if(Math.abs(f)>Math.abs(g)){e=true;if(f>0){console.log("Dragging down");l.stopPropagation()}else{console.log("Dragging up");l.stopPropagation()}}else{e=false}a=h;b=j}catch(k){console.warn("[ReaderArticlePopoverItem] Error Caught:\n\n\t Unable to determine drag.")}};touchen};c.ontouchstart=touchstart;c.ontouchmove=touchmove},setContentAreaPadding:function(b){if(b==null){return}var c=this;var d=20;var a="tabletArticle";if(currentProfile=="phone"){d=15;a="phoneArticle"}c.addCls(a);if(settings.articlepopover.articlePadding!=null){d=parseInt(settings.articlepopover.articlePadding)}$(b).css("padding","0px "+d+"px")},isCustomBannerAd:function(){var a=this;return a.statics().isBannerAdTypeCustom()},isCustomMpuAd:function(){var a=this;return a.statics().isMpuAdTypeCustom()},getMetaDataToSetupCustomMpuAd:function(){var c=this;var a={className:null,configUrl:""};if(c.isCustomMpuAd()){var b=c.mpuAdvertSetting.type.split("|");a.className=b[1];a.configUrl=b[2]}return a},isLazyLoadPopoverAdverts:function(){return typeof settings=="object"&&!!settings&&"articlepopover" in settings&&typeof settings.articlepopover=="object"&&!!settings.articlepopover&&"lazyLoadPopoverAdverts" in settings.articlepopover&&settings.articlepopover.lazyLoadPopoverAdverts==="true"},isLazyLoadingInlineDfpMpuAdvert:function(){var a=this;return settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.type.toLowerCase()==="dfp"&&a.isLazyLoadPopoverAdverts()},isLazyLoadCustomBannerAdvert:function(){var a=this;return a.isCustomBannerAd()&&a.isLazyLoadPopoverAdverts()},isLazyLoadCustomMpuAdvert:function(){var a=this;return a.isCustomMpuAd()&&a.isLazyLoadPopoverAdverts()},setupArticleTemplate:function(){var a=this;if(typeof articleDictionary!="undefined"&&articleDictionary[a.config.article]!=null){a.article=articleDictionary[a.config.article];a.setHeight("100%");a.setWidth("100%");a.content.setHeight("100%");a.content.setWidth("100%");a.content.addCls("template-article-area");a.on("painted",function(){a.templateRequest=$.ajax({type:"GET",contentType:"text/plain",async:true,url:a.article.url,success:function(c){if(c!=null){articleDictionary[a.config.article].articleData=c}var b="display: inline-block; -webkit-overflow-scrolling: touch; height: 100%; width:100%; position:relative;";if(Ext.os.is.iOS){b+="overflow-y: auto;"}else{b+="overflow: hidden"}a.content.setHtml('<div class="iframe-wrapper" style="'+b+'"><iframe id="'+a.id+'-content" class="article-template-frame" style="height: 100%; width: 100%; border: none; opacity: 0; transition: 0.3s ease opacity;"></iframe></div>');if(a.parent.getActiveItem()==a){a.writeTimeout=setTimeout(function(){a.contentTemplateIframe=document.getElementById(a.id+"-content");a.writeArticleTemplate()},100)}}})},a,{delay:10,single:true})}},writeArticleTemplate:function(){var c=this;if(!c.isWritten){var b=articleDictionary[c.config.article].articleData;if(b!=null){c.contentTemplateIframe=document.getElementById(c.id+"-content");if(c.contentTemplateIframe!=null){if(b.body!=null){b.body=b.body.replace("<body",'<body style="font-size:'+fontEm+'px"');c.contentTemplateIframe.contentDocument.write(b.body);c.contentTemplateIframe.style.opacity=1;c.removeCls("loading");c.isWritten=true;c.fireEvent("updateArticleShareAfterWrite",b.sharelink,b.headline);try{c.contentTemplateIframe.contentDocument.close()}catch(a){console.warn("[ReaderArticlePopoverItem] Error Caught:\n\n\t",a)}c.fireEvent("trackArticleChange",c.getPageNo(),null,c)}else{if(!c.hasWrittenError){c.removeCls("loading");c.contentTemplateIframe.contentDocument.write("<html><head></head><body><h2>Oops. Something went wrong!</h2></body><html>");c.hasWrittenError=true}}c.displayTemplateTimeout=setTimeout(function(){try{setText(c.element.dom)}catch(d){console.warn("Error setting text size of an article.\n",d)}},250)}c.setupTemplateIframe()}else{c.setupArticleTemplate()}}},setupTemplateIframe:function(){var b=this;if(b.contentTemplateIframe!=null){var a=b.contentTemplateIframe.contentDocument||b.contentTemplateIframe.contentWindow.document;if(a){b.templateIframeTouchStart=function(c){var d=b.getSelectedText();if(b.getSelectedText()==null||d.trim()==""){b.eventStarted=true;b.frameTouchStart(c)}};a.addEventListener("touchstart",b.templateIframeTouchStart);b.templateIframeTouchMov};a.addEventListener("touchmove",b.templateIframeTouchMove);b.templateIframeTouchEnd=function(c){if(b.eventStarted){b.frameTouchEnd(c);b.eventStarted=false}};a.addEventListener("touchend",b.templateIframeTouchEnd)}}},removeTemplateFrameTouchListeners:function(){var c=this;try{c.contentTemplateIframe=document.getElementById(c.id+"-content");if(c.contentTemplateIframe!=null){var a=c.contentTemplateIframe.contentDocument||c.contentTemplateIframe.contentWindow.document;if(a){a.removeEventListener("touchstart",c.templateIframeTouchStart);a.removeEventListener("touchmove",c.templateIframeTouchMove);a.removeEventListener("touchend",c.templateIframeTouchEnd)}}}catch(b){console.error("[ReaderArticlePopoverItem]: Error Caught",b)}},returnArticleCarousel:function(){return this.parent},frameTouchStart:function(b){var a=this;a.articleCarousel=a.returnArticleCarousel();a.articleCarousel.carouselDragStart(b)},frameTouchMove:function(b){var a=this;a.articleCarousel.carouselDrag(b)},frameTouchEnd:function(b){var a=this;a.articleCarousel.carouselDragEnd(b)},initializeInlineNewsday:function(){var C=this;var a="<div class='container'><div><div class='textcontent'><{{LABEL}}><div class='contenthead font35'><{{HEAD}}></div><{{HEADDECK}}><div class='articleContent'><{{IMAGE}}><div class='bylineContainer' style='margin-bottom:15px;min-height:25px;'><{{BYLINE}}><div class='bylinecontainer' ><{{TEXTCONTROLS}}></div><hr /><div class='contentbody'><{{UPDATE}}><{{REVIEWBOX}}><div class=\"pcontent\" style='position:relative;' ><{{MPU}}><{{BODY}}></div><{{NEWSBOX}}></div><{{BANNERAD}}></div></div></div></div>";if(C.article.label!=null){a=a.replace("<{{LABEL}}>",'<div class="label" >'+C.article.label+"</div>")}else{a=a.replace("<{{LABEL}}>","")}a=C.setUpdateStory(a);a=a.replace("<{{HEAD}}>",C.article.headline);a=a.replace("<{{HEADDECK}}>",'<div class="contentdeck font25">'+C.article.subHeadline+"</div>");a=C.newsdayByline(a);if(C.article.reviewBox.trim().length>0){var m="";if(C.article.type=="REVIEW"){m='<p><span class="BOLD">REVIEW</span></p>'}var l="";if(C.article.reviewstars!=null&&C.article.reviewstars.trim().length>0&&settings.newsday.useFontAwesome=="true"){l=C.getStarRatingNewsdayHtml(C.article.reviewstars);m='<div style="margin-bottom:8px;" ><span class="BOLD" style="margin-bottom:10px;">REVIEW</span></div>'}a=a.replace("<{{REVIEWBOX}}>","<div class='reviewbox' >"+m+l+C.article.reviewBox+"</div>")}else{a=a.replace("<{{REVIEWBOX}}>","")}a=a.replace("<{{BODY}}>",C.article.body);if(C.article.newsBox.trim().length>0){if(C.article.newsBoxes!=null){a=C.addNewsBoxes(a)}else{a=a.replace("<{{NEWSBOX}}>","<div class='newsbox' >"+C.article.newsBox+"</div>")}}else{a=a.replace("<{{NEWSBOX}}>","")}a=a.replace("<{{TEXTCONTROLS}}>",'<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="resources/images/increase-text-size_newsday.png" ontouchstart="increaseTextNewsday()" onclick="increaseTextNewsday()">&nbsp;&nbsp;<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="resources/images/decrease-text-size_newsday.png" ontouchstart="decreaseTextNewsday()" onclick="decreaseTextNewsday()"></div>');var B=settings.newsday.articleCubeAd;if(B!=null&&currentProfile!="phone"){if(B.type!=null&&B.type.indexOf("custom|")>=0){a=a.replace("<{{MPU}}>",'<div class="mpuAdvert" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;" ><div style="padding: 5px 0px;">Advertisement</div><div class=\'mpu-article\' ></div></div>')}else{if(B.networkCode!=null&&B.adUnit!=null){C.networkCodeMpu=B.networkCode;C.adUnitMpu=B.adUnit;C.advertDivIDMpu=C.id+"mpu";var c="mpuAdvert";if(currentProfile=="phone"){c="mpuPhone"}a=a.replace("<{{MPU}}>",'<div class="'+c+'" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;" ><div style="padding: 5px 0px;">Advertisement</div><div id="'+C.advertDivIDMpu+'" ></div></div>')}else{if(B.type=="url"){a=a.replace("<{{MPU}}>",'<div class="mpuAdvert" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;" ><div style="padding: 5px 0px;">Advertisement</div><iframe style=\'height:250px;width:300px;border:none;\' src="'+B.url+'" ></iframe></div>')}}}}else{a=a.replace("<{{MPU}}>","")}var q=settings.reader.popupAdvert;if(q!=null){if(q.type!=null&&q.type.indexOf("custom|")>=0){a=a.replace("<{{BANNERAD}}>",'<div class="readerBannerAd" style="text-align: center; color: #999!important; font-size: 0.85em;height:auto; min-height:50px;" ><div style="padding: 5px 0px;">Advertisement</div><div class=\'banner-article\' style=\'display: inline-block; position: relative;\'></div></div>')}else{if(q.url!=null){var p=728;var y=110;if(currentProfile=="phone"){p=320;y=70}a=a.replace("<{{BANNERAD}}>",'<div class="readerBannerAd" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:50px;" ><div style="padding: 5px 0px;">Advertisement</div><iframe style=\'height:'+y+"px;width:"+p+"px;border: none;' src=\""+q.url+'" ></iframe></div>')}else{a=a.replace("<{{BANNERAD}}>","")}}}else{var x=settings.newsday.articleBannerAd;if(x!=null&&currentProfile!="phone"){if(x.networkCode!=null&&x.adUnit!=null){C.networkCode=x.networkCode;C.adUnit=x.adUnit;C.advertDivID=C.id+"advert";var p=728;var y=110;if(currentProfile=="phone"){p=320;y=70}a=a.replace("<{{BANNERAD}}>","<div id='"+C.advertDivID+"' style='width:"+p+"px;height:"+y+"px;margin:auto;'></div>")}}else{if(x!=null&&currentProfile=="phone"){if(x.networkCode!=null&&x.adUnit!=null){C.networkCode=x.networkCode;C.adUnit=x.adUnit;C.advertDivID=C.id+"advert";var s=Ext.create("Ext.Container",{width:"100%",height:50,html:"<div id='"+C.advertDivID+"' style='width:320px;height:50px;margin:auto;'></div>"});C.add(s);a=a.replace("<{{BANNERAD}}>","")}}else{a=a.replace("<{{BANNERAD}}>","")}}}var z=C.initializeInlineImagesNewsday();a=a.replace("<{{IMAGE}}>",z);C.content.setHtml(a);var B=settings.newsday.articleCubeAd;if(B!=null&&currentProfile=="phone"){if(B.type!=null&&B.type.indexOf("custom|")>=0){var c="mpuPhone";var b=$(C.content.element.dom).find(".pcontent")[0];var o=b.getElementsByTagName("p");if(o.length>0){var n=b;var u=document.createElement("div");u.className=c;u.style.textAlign="center";u.style.color="#999";u.style.fontSize="0.8em";u.style.height="auto";u.style.minHeight="260px";var g=document.createElement("div");g.innerText="Advertisement";g.style.padding="5px 0px";var k=document.createElement("div");k.className="mpu-article";k.style.border="none";k.style.width="300px";k.style.display="inline-block";u.appendChild(g);u.appendChild(k);var j;if(o.length>4){j=o[3];n.insertBefore(u,j)}else{j=o[o.length-1];n.appendChild(u)}}}else{if(B.networkCode!=null&&B.adUnit!=null){C.networkCodeMpu=B.networkCode;C.adUnitMpu=B.adUnit;C.advertDivIDMpu=C.id+"mpu";var c="mpuPhone";var b=$(C.content.element.dom).find(".pcontent")[0];var o=b.getElementsByTagName("p");if(o.length>0){var n=b;var u=document.createElement("div");u.className=c;u.style.textAlign="center";u.style.color="#999";u.style.fontSize="0.8em";u.style.height="auto";u.style.minHeight="260px";var g=document.createElement("div");g.innerText="Advertisement";g.style.padding="5px 0px";var k=document.createElement("div");k.id=C.advertDivIDMpu;u.appendChild(g);u.appendChild(k);var j;if(o.length>4){j=o[3];n.insertBefore(u,j)}else{j=o[o.length-1];n.appendChild(u)}}}else{if(B.type=="url"){var c="mpuPhone";var b=$(C.content.element.dom).find(".pcontent")[0];var o=b.getElementsByTagName("p");if(o.length>0){var n=b;var u=document.createElement("div");u.className=c;u.style.textAlign="center";u.style.color="#999";u.style.fontSize="0.8em";u.style.height="auto";u.style.minHeight="260px";var g=document.createElement("div");g.innerText="Advertisement";g.style.padding="5px 0px";var k=document.createElement("iframe");k.src=B.url;k.style.height="250px";k.style.width="300px";k.style.border="none";u.appendChild(g);u.appendChild(k);var j;if(o.length>4){j=o[3];n.insertBefore(u,j)}else{j=o[o.length-1];n.appendChild(u)}}}}}}var A=$(C.content.element.dom).find(".x-scroll-scroller")[0];if(A!=null){$(A).addClass("customscroller")}if(currentProfile=="phone"){var t=$(C.element.dom).find(".bylineContainer")[0];$(t).css("margin-bottom","");var f=$(C.element.dom).find(".bylineContainerNewsday")[0];$(f).removeClass("bylineContainerNewsday")}C.removeSpinner();C.on("painted",function(){C.setImages();setNewsdayText(C.content.element.dom);if(Ext.os.is.Android){C.fireEvent("fillPrintContainer",C)}},C,{});C.hasVideo=false;C.hasLink=false;C.hasGallery=false;var D=$(C.element.dom).find(".articleImg")[0];if(D!=null){var r=$(C.element.dom).find(".galleryicon")[0];$(r).css("visibility","visible");$(r).click(function(){C.viewGallery()});r.addEventListener("touchstart",function(){C.viewGallery()});if(C.article.media!=null){if(C.article.media.length>0){for(var v in C.article.media){if(C.article.media[v].type=="OVIDEO"){var e=$(C.element.dom).find(".articlevideoicon")[0];$(e).css("display","inline");C.oVideo=C.article.media[v];if(!C.hasVideo){$(e).click(function(){C.viewOVideo(C.oVideo)});e.addEventListener("touchstart",function(){C.viewOVideo(C.oVideo)})}C.hasVideo=true}if(C.article.media[v].type=="OLINK"){var d=$(C.element.dom).find(".linkicon")[0];$(d).css("display","inline");C.oLink=C.article.media[v].url;if(!C.hasLink){$(d).click(function(){C.openOLink(C.oLink)});d.addEventListener("touchstart",function(){C.openOLink(C.oLink)});C.hasLink=true}}if(C.article.media[v].type=="OGALLERY"){var d=$(C.element.dom).find(".ogalleryicon")[0];$(d).css("display","inline");C.oGallery=C.article.media[v];if(!C.hasGallery){$(d).click(function(){C.openOGallery(C.oGallery)});d.addEventListener("touchstart",function(){C.openOGallery(C.oGallery)});C.hasGallery=true}}}}}}C.content.element.on({scope:C.content,delegate:"a",tap:function(w){var h=$(w.target).attr("href");if(!h.startsWith("http://")&&!h.startsWith("https://")&&!h.startsWith("mailto:")&&!h.startsWith("tel:")){h="http://"+h}if(h.indexOf("mailto:")!=-1){window.location.href=h}else{window.open(h,"_blank")}}})},setUpdateStory:function(b){var c=this;if(c.article.updateTag!=null&&c.article.updateTag.length>0){var a="<a class='updateLink updateLinkHidden pointerCursor' target='_blank' href='http://google.com'>View the updated story ></a>";b=b.replace("<{{UPDATE}}>",a);c.updateLinkAjax=$.ajax({delay:10,url:"../get_update_tag.aspx?updateTag="+encodeURIComponent(c.article.updateTag),success:function(e){var d=$(c.element.dom).find(".updateLink");if(d!=null&&e!=null&&e.content!=null&&e.content.shareLink!=null){$(d).removeClass("updateLinkHidden");$(d).attr("href",e.content.shareLink)}}})}else{b=b.replace("<{{UPDATE}}>","")}return b},addNewsBoxes:function(d){var e=this;var b="";for(var c in e.article.newsBoxes){var a="<div class='newsbox' >"+e.article.newsBoxes[c]+"</div>";b+=a}d=d.replace("<{{NEWSBOX}}>",b);return d},getStarRatingNewsdayHtml:function(c){var d=this;var a='<span class="reviewstars">';var e=Math.floor(parseFloat(c));for(var b=1;b<=e;b++){a+='<i class="fa fa-star fa-lg" aria-hidden="true"></i>'}if(parseFloat(c)>e){a+='<i class="fa fa-star-half-o fa-lg" aria-hidden="true"></i>'}a+="</span><br />";return a},newsdayByline:function(c){var d=this;var e='<div class="contentbyline font15">';if(d.article.byline.length>0){e+="By <span class='bylinespan'>"+d.article.byline+"</span>";if(d.validateEmail(d.article.reporterEmail)){e=e.replace("<span class='bylinespan'>","<span class='bylinespan pointerCursor' ontouchstart='window.location.href = \"mailto:"+d.article.reporterEmail+"?subject="+encodeURIComponent(d.article.headline)+"\";' onclick='window.location.href = \"mailto:"+d.article.reporterEmail+"?subject="+encodeURIComponent(d.article.headline)+"\";'>")}else{e=e.replace("<span class='bylinespan'>","<span>")}if(d.article.reporters!=null){for(var b in d.article.reporters){var a="";if(b==d.article.reporters.length-1){a+=" and <span class='bylinespan'>"+d.article.reporters[b].name+"<span>"}else{a+=", <span class='bylinespan'>"+d.article.reporters[b].name+"<span>"}if(d.validateEmail(d.article.reporters[b].email)){a=a.replace("<span class='bylinespan'>","<span class='bylinespan pointerCursor' ontouchstart='window.location.href = \"mailto:"+d.article.reporters[b].email+"?subject="+encodeURIComponent(d.article.headline)+"\";' onclick='window.location.href = \"mailto:"+d.article.reporters[b].email+"?subject="+encodeURIComponent(d.article.headline)+"\";'>")}else{a=a.replace("<span class='bylinespan'>","<span>")}e+=a}}}e+="</div>";c=c.replace("<{{BYLINE}}>",e);return c},validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},viewGaller},viewOVideo:function(c){var b=this;var a=c.url;if(a.indexOf("http://")==-1){a="http://"+a}b.fireEvent("ovideoclicked",b,a,"story window")},openOLin},openOGaller},loadAdvert:function(){var a=this;setTimeout(function(){if(!a.destroyed){var c=settings.reader.popupAdvert;if(c!=null&&c.type.indexOf("custom|")>=0){var e=$(a.element.dom).find(".banner-article")[0];var j=c.type.split("|");var g=j[1];var n=j[2];var l=function(){if(e&&window[g]!=null&&a.customBannerAd==null){a.customBannerAd=new window[g](a.id+"article-article",e,currentProfile,c.config);a.customBannerAd.loadAdvert(a.page.page)}else{if(a.customBannerAd!=null){a.customBannerAd.refreshAdvert(a.page.page)}}};if(c.config==null){a.ajaxRequest=$.ajax({url:n+(n.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(h){a.hasConfig=true;console.log(h);settings.reader.popupAdvert.config=h;if(!a.destroyed){l();a.sendNewPageViewForHtlbidCustomAd()}}})}else{l()}}else{if(c!=null&&c.type=="url"){var d=a.element.dom.querySelector("#"+a.advertDivID);if(d!=null){console.log("hitting",d,c);d.src=c.url}}else{if(c!=null&&c.type=="adbridg"){var m=a.element.dom.querySelector("#"+a.advertDivID);console.log(m);if(!m){m=document.createElement("DIV");m.style.height=currentProfile=="phone"?"70px":"110px";m.style.width=currentProfile=="phone"?"320px":"728px";m.style.margin="15px auto";m.id=a.advertDivID;var b=a.element.dom.querySelector("#"+a.advertDivID+"-container");b.appendChild(m)}if(!!m){if(currentProfile=="phone"){m.setAttribute("data-adbridg-ad-class","adb-ee-inner-320x50")}else{m.setAttribute("data-adbridg-ad-class","adb-ee-inner-728x90")}}}else{var k=728;var f=90;if(currentProfile=="phone"){k=320;f=50}googletag.cmd.push(function(){if(document.getElementById(a.advertDivID)!=null){a.adSlot=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[k,f],a.advertDivID);a.adSlot.addService(googletag.pubads().updateCorrelator());var r=false;if(settings.reader.popupAdvert!=null&&settings.reader.popupAdvert.targeting!=null&&settings.reader.popupAdvert.targeting.length>0){var h=settings.reader.popupAdvert.targeting.split("|");for(var p in h){var q=h[p];var o=q.split("*");if(o!=null&&o.length>=2){o[1]=o[1].replace("{{PAGE}}",a.page.page).replace("{{SECTION}}",a.section);a.adSlot.setTargeting(o[0],o[1]);if(!r){r=o[0]=="pos"}}}}if(!r){a.adSlot.setTargeting("pos",a.getPageNo()+1)}googletag.enableServices()}});googletag.cmd.push(function(){if(document.getElementById(a.advertDivID)!=null){googletag.display(a.advertDivID)}})}}}}},a.advertTimeout)},refreshAdvert:function(){var a=this;googletag.pubads().refresh([a.adSlot])},loadAdvertMpu:function(){var a=this;setTimeout(function(){if(!a.destroyed){var b=typeof settings!="undefined"&&settings.newsday!=null&&settings.newsday.articleCubeAd?settings.newsday.articleCubeAd:null;if(b!=null&&b.type!=null&&b.type.indexOf("custom|")>=0){var g=$(a.element.dom).find(".mpu-article")[0];var f=b.type.split("|");var h=f[1];var d=f[2];var e=function(){if(g&&window[h]!=null&&a.customMpuAd==null){a.customMpuAd=new window[h](a.id+"mpu-article",g,currentProfile,b.config);a.customMpuAd.loadAdvert(a.page.page)}else{if(a.customMpuAd!=null){a.customMpuAd.refreshAdvert(a.page.page)}}};if(b.config==null){a.ajaxRequestMpu=$.ajax({url:d+(d.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(k){a.hasConfig=true;console.log(k);settings.newsday.articleCubeAd.config=k;if(!a.destroyed){e();a.sendNewPageViewForHtlbidCustomAd()}}})}else{e()}}else{if(!!settings.reader&&!!settings.reader.popupAdvertMpu&&settings.reader.popupAdvertMpu.type=="adbridg"){var j=a.element.dom.querySelector("#"+a.advertDivIDMpu);console.log(j);if(!j){j=document.createElement("DIV");j.id=a.advertDivIDMpu;var c=a.element.dom.querySelector("#"+a.advertDivIDMpu+"-container");if(!!c){c.appendChild(j)}}if(!!j){j.setAttribute("data-adbridg-ad-class","adb-ee-inner-300x250")}}else{if(a.adSlotMpu==null){googletag.cmd.push(function(){if(document.getElementById(a.advertDivIDMpu)!=null){a.adSlotMpu=googletag.defineSlot("/"+a.networkCodeMpu+"/"+a.adUnitMpu,[parseInt("300"),parseInt("250")],a.advertDivIDMpu);a.adSlotMpu.addService(googletag.pubads().updateCorrelator());var o=false;if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.targeting!=null&&settings.reader.popupAdvertMpu.targeting.length>0){var k=settings.reader.popupAdvertMpu.targeting.split("|");for(var m in k){var n=k[m];var l=n.split("*");if(l!=null&&l.length>=2){l[1]=l[1].replace("{{PAGE}}",a.page.page).replace("{{SECTION}}",a.section);a.adSlotMpu.setTargeting(l[0],l[1]);if(!o){o=l[0]=="pos"}}}}if(!o){a.adSlotMpu.setTargeting("pos",a.getPageNo()+1)}if(a.isLazyLoadingInlineDfpMpuAdvert()){googletag.pubads().enableLazyLoad()}googletag.enableServices()}});googletag.cmd.push(function(){if(document.getElementById(a.advertDivIDMpu)!=null){googletag.display(a.advertDivIDMpu)}})}}}}},a.advertTimeout)},initializeInline:function(){var f=this;var j=InfinityMobile.app.application.getController("ArticlePopoverController").flippAdvertSetting;var b=j.enabled;var g="<div class='container'><div class='content'><div class='articleContent' style='font-size:"+fontEm+"px'><div class='contentHead font35'><{{BANNERTOP}}><{{HEAD}}></div><{{HEADDECK}}><{{IMAGE}}><br /><{{BYLINE}}><br /><div class='contentBody "+(b?"has-flipp":"")+" font15'><{{MPU}}><{{BODY}}><{{FLIPP}}><{{BANNERBOTTOM}}></div></div></div></div>";g=g.replace("<{{HEAD}}>",f.article.headline);g=g.replace("<{{HEADDECK}}>",'<div class="contentDeck font25">'+f.article.subHeadline+"</div>");g=g.replace("<{{BYLINE}}>",f.article.byline!=null?'<div class="contentByline font15">'+f.article.byline+"</div>":"");if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.placeInBody!=null&&settings.reader.popupAdvertMpu.placeInBody=="true"){var d=3;if(settings.reader.popupAdvertMpu.paragraphIndex!=null){d=parseInt(settings.reader.popupAdvertMpu.paragraphIndex)}g=g.replace("<{{MPU}}>","");var h=/<br.*?><br.*?>/g;var a=0;var e=false;while((match=h.exec(f.article.body))!=null){if(a==d-1){f.article.body=f.article.body.splice(match.index+match.length-1,match[0].length,match+"<{{MPU}}>");e=true;break}a++}if(!e){f.article.body+="<{{MPU}}>"}}g=g.replace("<{{BODY}}>",f.article.body);var c=f.initializeInlineImages();g=g.replace("<{{IMAGE}}>",c);if(settings.reader.popupAdvert!=null){if(settings.reader.popupAdvert.advertInArticleFlow==null||settings.reader.popupAdvert.advertInArticleFlow=="true"){if(f.isCustomBannerAd()){g=f.setupCustomInlineDfpBanner(g)}else{switch(settings.reader.popupAdvert.type.toLowerCase()){case"dfp":g=f.setupInlineDfpBanner(g);break;case"image":g=f.setupInlineImageBanner(g);break;case"url":g=f.setupInlineUrlBanner(g);break;case"adbridg":g=f.setupInlineAdbridgBanner(g);break}}}else{g=g.replace("<{{BANNERTOP}}>","");g=g.replace("<{{BANNERBOTTOM}}>","")}}else{g=g.replace("<{{BANNERTOP}}>","");g=g.replace("<{{BANNERBOTTOM}}>","")}if(f.mpuAdvertSetting.type!=null){if(f.isCustomMpuAd()){g=f.setupCustomInlineDfpMpu(g)}else{switch(f.mpuAdvertSetting.type.toLowerCase()){case"dfp":g=f.setupInlineDfpMpu(g);break;case"image":g=f.setupInlineImageMpu(g);break;case"adbridg":g=f.setupInlineAdbridgMpu(g);break}}}else{g=g.replace("<{{MPU}}>","")}g=g.replace("<{{FLIPP}}>",f.returnFlippHtml());f.content.setHtml(g);f.removeSpinner();f.on("painted",function(){f.painted=true;if(f.mode=="frame"){f.setFrame()}f.setImages();setText(f.element.dom);f.checkInlineAudioMedia();if(f.parent.getActiveItem()==f){f.runFlipp()}if(Ext.os.is.Android){f.fireEvent("fillPrintContainer",f)}},f,{buffer:1});f.on("painted",function(){var l=$(f.element.dom).find(".fullscreengalleryicon");if(l!=null&&l.length>0){$(l).click(function(){f.createFullscreenGallery(f.article)});var k;l[0].addEventListener("touchstart",function(m){k=m.timeStamp});l[0].addEventListener("touchend",function(m){if(m.timeStamp-k<200){f.createFullscreenGallery(f.article)}})}});f.content.element.on({scope:f.content,delegate:"a",tap:function(o){var l=$(o.target).attr("href");var n=-1;var m="";if(f.article!=null&&!!f.article){n=f.article.pageNumber!=null?f.article.pageNumber:(f.article.parentpage!=null?f.article.parentpage:n);m=f.article.headline!=null?f.article.headline:m}var k={linkUrl:l,linkName:o.target.innerText,articleNumber:f.getPageNo(),headline:m,pageNum:n};f.fireEvent("trackArticleLink",k,f);if(!l.startsWith("http://")&&!l.startsWith("https://")&&!l.startsWith("mailto:")&&!l.startsWith("tel:")){l="http://"+l}if(l.indexOf("mailto:")!=-1){window.location.href=l}else{window.open(l,"_blank")}}})},runFlipp:function(){var c=this;var a=InfinityMobile.app.application.getController("ArticlePopoverController").flippAdvertSetting;if(!!a&&a.enabled&&!this.hasSetupFlippOnArticle){var c=this;var b=undefined;window.flippxp=window.flippxp||{run:[]};console.log("[FLIPP] Registering flipp-div-"+c.id+" with flippxp");window.flippxp.run.push(function(){var d={userKey:b,dwellExpandable:true,experienceLimit:1};var e=InfinityMobile.controller.ReaderController.isNewPWA();if(e){d.rootElement="#"+c.id+" .x-inner"}window.flippxp.registerSlot("#flipp-div-"+c.id,a.publisherName,a.publisherSiteId,[a.publisherZoneId],d)});this.hasSetupFlippOnArticle=true}},returnFlippHtm},checkInlineAudioMedia:function(){var e=this;try{var b=$(e.element.dom).find("audio.inline-article-media");if(b!=null){for(var d=0;d<b.length;d++){var a=b[d];a.ontouchstart=function(f){f.stopPropagation()};a.ontouchmove=function(f){f.stopPropagation()};a.ontouchend=function(f){f.stopPropagation()};console.log("SETTING",e.element.dom);if(e.parent.getActiveItem()!=e){if(Ext.browser.is.Chrome){a.style.opacity="0";a.style.transition="0.5s ease opacity"}}}}}catch(c){console.warn("[ReaderArticlePopoverItem]: Error Caught\n",c)}},showHiddenInlineAudioMedia:function(){var e=this;try{if(Ext.browser.is.Chrome){var b=$(e.element.dom).find("audio.inline-article-media");if(b!=null){for(var d=0;d<b.length;d++){var a=b[d];a.style.display="inline-block";a.style.opacity="1"}}}}catch(c){console.warn("[ReaderArticlePopoverItem]: Error Caught\n",c)}},pauseAllAudio:function(){var e=this;var b=e.element!=null?$(e.element.dom).find("audio"):null;if(b!=null&&e.parent.getActiveItem()!=e){for(var d=0;d<b.length;d++){var a=b[d];try{a.pause()}catch(c){console.warn("[ReaderArticlePopoverItem]: Error Caught\n",c)}}}},setupInlineAdbridgBanner:function(f){var d=this;d.advertDivID=d.id+"advert";var c="width:728px;height:110px;";var e="110px";switch(currentProfile){case"phone":c="width:320px;height:70px;";e="70px";break;default:c="width:728px;height:110px;";break}var b="<div id='"+d.advertDivID+"-container' style='min-height:"+e+";'><div id='"+d.advertDivID+"' style='"+c+"margin:15px auto;'></div></div>";var a=settings.reader.popupAdvert;switch(a.position.toLowerCase()){case"bottom":f=f.replace("<{{BANNERBOTTOM}}>",b);f=f.replace("<{{BANNERTOP}}>","");break;case"top":f=f.replace("<{{BANNERTOP}}>",b);f=f.replace("<{{BANNERBOTTOM}}>","");break}d.on("painted",function(){if(d.parent.getActiveItem()==d){d.loadAdvert()}});return f},setupInlineDfpBanner:function(e){var c=this;var a=settings.reader.popupAdvert;if(a.networkCode!=null&&a.adUnit){c.networkCode=a.networkCode;c.adUnit=a.adUnit;c.advertDivID=c.id+"advert";var b="width:728px;height:110px;";switch(currentProfile){case"phone":b="width:320px;height:70px;";break;default:b="width:728px;height:110px;";break}if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"]>","g");e=e.replace(d,"<div id='"+c.advertDivID+"' style='"+b+"margin:auto;'>");e=e.replace("<{{BANNERTOP}}>","");e=e.replace("<{{BANNERBOTTOM}}>","")}else{switch(a.position.toLowerCase()){case"bottom":e=e.replace("<{{BANNERBOTTOM}}>","<div id='"+c.advertDivID+"' class='article-banner' style='"+b+"margin:15px auto;'></div>");e=e.replace("<{{BANNERTOP}}>","");break;case"top":e=e.replace("<{{BANNERTOP}}>","<div id='"+c.advertDivID+"' class='article-banner' style='"+b+"margin:auto;'></div>");e=e.replace("<{{BANNERBOTTOM}}>","");break}}}c.on("painted",function(){if(settings.articlepopover.lazyLoadPopoverAdverts==null||settings.articlepopover.lazyLoadPopoverAdverts=="false"){c.loadAdvert()}});return e},setupCustomInlineDfpBanner:function(f){var c=this;if(!c.isCustomBannerAd()){return f}c.advertDivID=c.id+"advert";var d=true;var b="readerBannerAd";var a="width:728px;height:110px;";if(currentProfile=="phone"){a="width:320px;height:70px;"}a+="max-width:100%;";if(c.bannerAdvertSetting.customClass!=null&&c.bannerAdvertSetting.customClass.trim().length>0){var e=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+c.bannerAdvertSetting.customClass+"[\\'\\\"]>","g");f=f.replace(e,"<div id='"+c.advertDivID+"' style='"+a+"margin:auto;'><div class='banner-article' style='display: inline-block; left: 50%;position: relative;transform: translateX(-50%);'></div>");f=f.replace("<{{BANNERTOP}}>","");f=f.replace("<{{BANNERBOTTOM}}>","")}else{if(c.bannerAdvertSetting.position!=null){switch(c.bannerAdvertSetting.position.toLowerCase()){case"bottom":f=f.replace("<{{BANNERBOTTOM}}>","<div id='"+c.advertDivID+"' class='article-banner' style='"+a+"margin:15px auto;'><div class='banner-article' style='display: inline-block; left: 50%;position: relative;transform: translateX(-50%);'></div></div>");f=f.replace("<{{BANNERTOP}}>","");break;case"top":f=f.replace("<{{BANNERTOP}}>","<div id='"+c.advertDivID+"' class='article-banner' style='"+a+"margin:auto;'><div class='banner-article' style='display: inline-block; left: 50%;position: relative;transform: translateX(-50%);'></div></div>");f=f.replace("<{{BANNERBOTTOM}}>","");break;default:d=false;break}}else{f=f.replace("<{{BANNERTOP}}>","");f=f.replace("<{{BANNERBOTTOM}}>","");d=false}}if(d===true){c.on("painted",function(){if(!c.isLazyLoadCustomBannerAdvert()){c.loadAdvert()}},c,{single:true})}return f},setupInlineImageBanner:function(g){var e=this;var b=settings.reader.popupAdvert;e.advertDivID=e.id+"advert";if(b.url!=null){var a="";var c="";if(b.link!=null&&b.link.trim().length>0){a="cursor:pointer;";c="onclick=\"window.open('"+b.link+'\');" ontouchstart="this.start = event.timeStamp" ontouchend="if(event.timeStamp - this.start < 75){window.open(\''+b.link+"');}\""}var d="width:728px;height:110px;";switch(currentProfile){case"phone":d="width:320px;height:70px;";break;default:d="width:728px;height:110px;";break}if(b.customClass!=null&&b.customClass.trim().length>0){var f=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+b.customClass+"[\\'\\\"]>","g");g=g.replace(f,"<div "+c+" id='"+e.advertDivID+"' style='"+a+d+';margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' >")}else{if(b.position!=null&&b.position=="top"){g=g.replace("<{{BANNERTOP}}>","<div "+c+" id='"+e.advertDivID+"' style='"+a+d+'margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;'></div>");g=g.replace("<{{BANNERBOTTOM}}>","")}else{g=g.replace("<{{BANNERBOTTOM}}>","<div "+c+" id='"+e.advertDivID+"' style='"+a+d+'margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;'></div>");g=g.replace("<{{BANNERTOP}}>","")}}e.content.element.on({scope:e.content,delegate:"#"+e.advertDivID,tap:function(){mainPanel.fireEvent("trackAdvertClick","banner")}})}return g},setupInlineUrlBanner:function(e){var c=this;var a=settings.reader.popupAdvert;c.advertDivID=c.id+"advert";if(a.url!=null){var d=settings.articlepopover.lazyLoadPopoverAdverts=="true"?"":"src='"+a.url+"' ";var b="width:728px;height:90px;";switch(currentProfile){case"phone":b="width:320px;height:60px;";break;default:b="width:728px;height:90px;";break}if(a.position!=null&&a.position=="top"){e=e.replace("<{{BANNERTOP}}>","<iframe "+d+" id='"+c.advertDivID+"' style='"+b+" margin: 20px auto; display: inherit; border: none;'></iframe>");e=e.replace("<{{BANNERBOTTOM}}>","")}else{e=e.replace("<{{BANNERBOTTOM}}>","<iframe "+d+" id='"+c.advertDivID+"' style='"+b+" margin: 20px auto; display: inherit; border: none;'></iframe>");e=e.replace("<{{BANNERTOP}}>","")}}return e},setupInlineAdbridgMpu:function(e){var c=this;var a=settings.reader.popupAdvertMpu;c.advertDivIDMpu=c.id+"mpu";var b="mpuAdvert";if(currentProfile=="phone"){b+=" mpuPhone"}else{b+=" mputablet"}if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.placeInBody!=null&&settings.reader.popupAdvertMpu.placeInBody=="true"){b+=" mpu-inbody"}if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_s]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"][\\s]?>","g");e=e.replace(d,'<div id="'+c.advertDivIDMpu+"-container\" class='"+b+"' ><div id='"+c.advertDivIDMpu+"'></div></div>");e=e.replace("<{{MPU}}>","")}else{e=e.replace("<{{MPU}}>",'<div id="'+c.advertDivIDMpu+"-container\" class='"+b+"' ><div id='"+c.advertDivIDMpu+"'></div></div>")}c.on("painted",function(){if(c.parent.getActiveItem()==c){c.loadAdvertMpu()}});return e},setupInlineDfpMpu:function(e){var c=this;var a=settings.reader.popupAdvertMpu;if(a.networkCode!=null&&a.adUnit){c.networkCodeMpu=a.networkCode;c.adUnitMpu=a.adUnit;c.advertDivIDMpu=c.id+"mpu";var b="mpuAdvert";if(currentProfile=="phone"){b+=" mpuPhone"}else{b+=" mputablet"}if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.placeInBody!=null&&settings.reader.popupAdvertMpu.placeInBody=="true"){b+=" mpu-inbody"}if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_s]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"][\\s]?>","g");e=e.replace(d,'<div id="'+c.advertDivIDMpu+"\" class='"+b+"' >");e=e.replace("<{{MPU}}>","")}else{e=e.replace("<{{MPU}}>",'<div id="'+c.advertDivIDMpu+"\" class='"+b+"' ></div>")}c.on("painted",function(){if((settings.articlepopover.lazyLoadPopoverAdverts==null||settings.articlepopover.lazyLoadPopoverAdverts=="false")||c.isLazyLoadingInlineDfpMpuAdvert()){c.loadAdvertMpu()}},c,{buffer:1})}return e},setupCustomInlineDfpMpu:function(d){var b=this;if(!b.isCustomMpuAd()){return d}var a="mpuAdvert";if(currentProfile=="phone"){a+=" mpuPhone"}else{a+=" mputablet"}if(b.mpuAdvertSetting.placeInBody=="true"){a+=" mpu-inbody"}if(b.mpuAdvertSetting.customClass!=null&&b.mpuAdvertSetting.customClass.trim().length>0){var c=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_s]*class=[\\'\\\"]"+b.mpuAdvertSetting.customClass+"[\\'\\\"][\\s]?>","g");d=d.replace(c,"<div class='"+a+"' style=\"text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;\"><div class='mpu-article'></div>");d=d.replace("<{{MPU}}>","")}else{d=d.replace("<{{MPU}}>",'<div class="'+a+'" style="text-align: center; color: #999!important; font-size: 0.8em;height:auto; min-height:260px;"><div class=\'mpu-article\'></div></div>')}b.on("painted},b,{single:true});return d},loadCustomAdvertMpu:function(){var a=this;setTimeout(function(){if(a.destroyed===true||a.isCustomMpuAd()===false){return}var c=$(a.element.dom).find(".mpu-article")[0];var d=a.getMetaDataToSetupCustomMpuAd();var b=function(){if(c&&window[d.className]!=null&&a.customMpuAd==null){a.customMpuAd=new window[d.className](a.id+"mpu-article",c,currentProfile,a.mpuAdvertSetting.config);a.customMpuAd.loadAdvert(a.page.page)}else{if(a.customMpuAd!=null){a.customMpuAd.refreshAdvert(a.page.page)}}};if(a.mpuAdvertSetting.config==null){a.ajaxRequestMpu=$.ajax({url:d.configUrl+(d.configUrl.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(e){a.hasConfig=true;a.mpuAdvertSetting.config=e;if(!a.destroyed){b()}},erro}})}else{b()}},a.advertTimeout)},setupInlineImageMpu:function(g){var e=this;var b=settings.reader.popupAdvertMpu;e.advertDivIDMpu=e.id+"mpu";if(b.url!=null){var a="";var c="";if(b.link!=null&&b.link.trim().length>0){a="cursor:pointer;";c="onclick=\"window.open('"+b.link+'\');" ontouchstart="this.start = event.timeStamp" ontouchend="if(event.timeStamp - this.start < 75){window.open(\''+b.link+"');}\""}var d="mpuAdvert";if(currentProfile=="phone"){d+=" mpuPhone"}else{d+=" mputablet"}if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.placeInBody!=null&&settings.reader.popupAdvertMpu.placeInBody=="true"){d+=" mpu-inbody"}if(b.customClass!=null&&b.customClass.trim().length>0){var f=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_s]*class=[\\'\\\"]"+b.customClass+"[\\'\\\"][\\s]?>","g");g=g.replace(f,'<div id="'+e.advertDivIDMpu+"\" class='"+d+"' style='"+a+'background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' "+c+">");g=g.replace("<{{MPU}}>","")}else{g=g.replace("<{{MPU}}>",'<div id="'+e.advertDivIDMpu+"\" class='"+d+"' style='"+a+'background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' "+c+"></div>")}e.content.element.on({scope:e.content,delegate:"#"+e.advertDivIDMpu,tap:function(){mainPanel.fireEvent("trackAdvertClick","bannerMPU")}})}return g},createFullscreenGallery:function(d){var b=this;var a=[];for(image in d.images){a.push({url:d.images[image].url})}var e="InfinityMobile.view.tablet.ImageGallery";if(currentProfile=="desktop"){var e="InfinityMobile.view.desktop.ImageGallery"}else{var e="InfinityMobile.view.tablet.ImageGallery"}var c=Ext.create(e,{images:a,article:d,dynamicview:false,zIndex:99999999});Ext.Viewport.add(c);c.show()},spea},callback:function(a){var b=this;if(a){}else{}},getArticleTemplat},setContentHeigh},setUpImageControl},initializeInlineImagesNewsday:function(){var d=this;var g=d.article.images;var a="";if(g!=null&&g.length>0){var b="<div class=\"contentImage imagecontainerblack\"><div class=\"imageandiconscontainer\"><div class=\"iconscontainer\" ><div class='articlevideoicon pointerCursor'></div><div class='linkicon pointerCursor' ></div><div class='ogalleryicon pointerCursor' ></div><div class='galleryicon pointerCursor' ></div></div><img class='articleImg' src=\"{{imageurl}}\" alt=\"\" /></div>{{imagecaption}}</div>";var c="";var e=g[0];var f="";if(e.credit!=null){if(e.credit.trim().length>0){f=" ("+e.credit+")"}}c+=b.replace("{{imageurl}}",e.url).replace("{{imagecaption}}",'<div class="contentcaption captionlineheight font13">'+e.caption+f+"</div>");a=c}return a},initializeInlineImages:function(){var j=this;var l=j.article.images;var c="NEXT IMAGE";if(language.articlePopover.nextImage!=null){c=language.articlePopover.nextImage.toUpperCase()}var k="PREVIOUS IMAGE";if(language.articlePopover.previousImage!=null){k=language.articlePopover.previousImage.toUpperCase()}var m="";if(l!=null&&l.length>0){var f="<div class=\"contentImages\" style='position:relative;'><div style='position:absolute;top:0px;right:0px;z-index:1;'>{{fullscreengallery}}</div>{{imagescontent}}</div>";var g='<div class="contentImage"><img src="{{imageurl}}" alt="" />{{imagecaption}}</div>';var b="";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){for(var h=l.length-1;h>=0;h--){var d=l[h];var a=d.url;a=a.replace("http://media.cdn.pagesuite.com","https://media.pagesuite.com").replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com");b+=g.replace("{{imageurl}}",a).replace("{{imagecaption}}",'<div class="contentCaption font13">'+d.caption+"</div>")}}else{for(var h=0;h<l.length;h++){var d=l[h];var a=d.url;a=a.replace("http://media.cdn.pagesuite.com","https://media.pagesuite.com").replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com");b+=g.replace("{{imageurl}}",a).replace("{{imagecaption}}",'<div class="contentCaption font13">'+d.caption+"</div>")}}var e='<div class="imageControls"><a href="javascript:void(0)" class="previousImage">'+k+'<img class="imgPreviousImage" src="'+location.protocol+"//"+location.host+'/tribune/left-image-arrow.png" alt="" /></a><div class="imageCount">Image</div><a href="javascript:void(0)" class="nextImage">'+c+'<img class="imgNextImage" src="'+location.protocol+"//"+location.host+'/tribune/right-image-arrow.png" alt="" /></a></div>';b+=e;if(settings.articlepopover!=null&&settings.articlepopover.enablePopoverImageGallery!=null&&settings.articlepopover.enablePopoverImageGallery=="true"){f=f.replace("{{fullscreengallery}}","<div class='fullscreengalleryicon pointerCursor' ></div>")}else{f=f.replace("{{fullscreengallery}}","")}m=f.replace("{{imagescontent}}",b)}return m},checkLanguage:function(){var e=this;var a=navigator.language.substring(0,2);try{var d=localStorage.getItem("checkLanguage"+publicationguid)}catch(c){var d=null}if(d==null){if(settings.reader.language!="en"){e.sourceLanguage="en";e.targetLanguage=settings.reader.language;return false}}else{if(d!="false"){var b=localStorage.getItem("checkLanguage"+publicationguid);if(b!=settings.reader.language){e.sourceLanguage=settings.reader.language;e.targetLanguage=b;return false}}else{if(settings.reader.language!="en"){e.sourceLanguage="en";e.targetLanguage=settings.reader.language;return false}}}return true},initializeForWeb:function(){var a=this;if(a.getPage()!=null){if(a.getPage().file==a.getPage().guid){a.popoverType="guid"}a.articleguid=a.getPage().file}a.on("painted",a.getContent,a,{delay:10,single:true})},getContent:function(){var c=this;var a=c.articleguid;c.painted=true;c.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");if((typeof isTribReader!="undefined"&&isTribReader==true)&&(c.lang=="es"||c.lang=="en")){var d="&lang="+c.lang}else{var d=""}var b="../article_popover.aspx?articleguid="+a+"&html5="+currentProfile+d;if(c.popoverType=="guid"){b="../article_popover.aspx?guid="+a+"&html5="+currentProfile+d}$.ajax({crossDomain:true,type:"GET",contentType:"text/html",async:true,url:b,success:function(g){var j=Ext.getStore("SettingStore");var k=g;var f=k.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(f){k=f[1]}c.articleText=k;k+="<script>setText()<\/script>";if(settings.reader.popupAdvert!=null){var l=settings.reader.popupAdvert;switch(l.type.toLowerCase()){case"dfp":k=c.setupDfpAdvertContent(k);break;case"image":k=c.setupImageAdvertContent(k);break}}if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.customClass!=null){var o=settings.reader.popupAdvertMpu;switch(o.type.toLowerCase()){case"dfp":k=c.setupDfpAdvertContentMpu(k);break}}var e=c.returnFlippHtml();k+=e;c.removeSpinner();c.unmask();c.content.setHtml(k);c.parseGalleryItemsForMediaObjectArticle(k);if(c.mode=="frame"){c.setFrame()}else{if(c.parent.getActiveItem()==c){c.runFlipp()}}if(settings.reader.popupAdvert!=null&&(settings.articlepopover.lazyLoadPopoverAdverts==null||settings.articlepopover.lazyLoadPopoverAdverts=="false")){c.loadAdvert()}if(settings.reader.popupAdvertMpu!=null&&(settings.articlepopover.lazyLoadPopoverAdverts==null||settings.articlepopover.lazyLoadPopoverAdverts=="false")){if(settings.reader.popupAdvertMpu.customClass==null){switch(settings.reader.popupAdvertMpu.type.toLowerCase()){case"dfp":c.setUpMpuInline();break}}c.loadAdvertMpu()}if(c.mode=="frame"){c.setFrame()}else{if(Ext.os.is.iOS){var n=c.contentArea.getScrollable();var h=!!n?n.getScroller():null;setTimeout(function(){try{if(!!h){h.applySize("auto");h.refresh(h)}}catch(m){console.warn("[ReaderArticlePopoverItem] Error Caught: \n\tTrying to refresh scroller.\n\n",m)}},1000)}}c.setImages();c.setGalleryButtonForMediaObjectArticle();if(c.element!=null){c.printImage=c.element.down(".printImage")}if(c.content.element!=null){setText(c.content.element.dom)}c.setStyle({visibility:"inherit"});if(Ext.os.is.Android){c.fireEvent("fillPrintContainer",c)}c.content.element.on({scope:c.content,delegate:"a",tap:function(m){if(currentProfile!="desktop"){var p=true;if(typeof m.target===object&&m.target.href!=null&&m.target.href=="javascript:void(0)"){p=false}else{if(typeof m.target===object&&m.target.href!=null){p=false}}if(p){window.location.href=m.target}}}})}})},parseGalleryItemsForMediaObjectArticle:function(g){var j=this;if(settings.articlepopover!=null&&settings.articlepopover.enablePopoverImageGallery!=null&&settings.articlepopover.enablePopoverImageGallery=="true"){try{var a=new DOMParser();var e=a.parseFromString(g,"text/html").getElementsByClassName("contentImage");var c=a.parseFromString(g,"text/html").getElementsByClassName("contentHead");console.log(j.content.element.dom);console.log(a);console.log(j.content.element.dom.getElementsByClassName("contentImage"));j.galleryArticles={headline:c[0].innerHTML,images:[]};for(var d=0;d<e.length;d++){var f={};var b=e[d].innerHTML.match(/<img [^>]*src="[^"]*"[^>]*>/gm);f.url=b[0].replace(/.*src="([^"]*)".*/,"$1");f.caption=e[d].innerText;j.galleryArticles.images.push(f)}delete a}catch(h){console.warn("[ReaderArticlePopoverItem]: Error Caught\n",h)}}},setGalleryButtonForMediaObjectArticle:function(){var d=this;if(settings.articlepopover!=null&&settings.articlepopover.enablePopoverImageGallery!=null&&settings.articlepopover.enablePopoverImageGallery=="true"){var e=document.querySelectorAll(".contentImage");for(var c=0;c<e.length;c++){e[c].insertAdjacentHTML("afterbegin","<div style='position:absolute;top:0px;right:0px;z-index:1;'><div class='fullscreengalleryicon pointerCursor'></div></div>")}var b=$(d.element.dom).find(".fullscreengalleryicon");if(b!=null&&b.length>0){$(b).click(function(){d.createFullscreenGallery(d.galleryArticles)});if(navigator.maxTouchPoints!=null){var a;b[0].addEventListener("touchstart",function(f){a=f.timeStamp});b[0].addEventListener("touchend",function(f){if(f.timeStamp-a<200){d.createFullscreenGallery(d.galleryArticles)}})}}}},setupDfpAdvertConten},setupDfpAdvertContentMp},setUpMpuInline:function(){var d=this;var c=$(d.element.dom).find(".contentBody")[0];if(c!=null){var a=settings.reader.popupAdvertMpu;d.networkCodeMpu=a.networkCode;d.adUnitMpu=a.adUnit;d.advertDivIDMpu=d.id+"mpu";var b="mpuAdvert";if(currentProfile=="phone"){b="mpuPhone"}c.innerHTML='<div id="'+d.advertDivIDMpu+"\" class='"+b+"' ></div>"+c.innerHTML}},setupImageAdvertContent:function(g){var f=this;var b=settings.reader.popupAdvert;f.advertDivID=f.id+"advert";var e="width:728px;height:110px;";switch(currentProfile){case"phone":e="width:320px;height:70px;";break;default:e="width:728px;height:110px;";break}if(b.url!=null){var a="";var d="";if(b.link!=null&&b.link.trim().length>0){a="cursor:pointer;";d="onclick=\"window.open('"+b.link+'\');" ontouchstart="this.start = event.timeStamp" ontouchend="if(event.timeStamp - this.start < 75){window.open(\''+b.link+"');}\""}var c="<div "+d+" id='"+f.advertDivID+"' style='"+a+e+'margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' >";if(b.customClass!=null&&b.customClass.trim().length>0){var h=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+b.customClass+"[\\'\\\"]>","g");g=g.replace(h,c)}else{if(b.position!=null&&b.position=="top"){g=c+"</div>"+g;g=g.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}else{g=g+c+"</div>";g=g.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}}}return g},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var g=this;var f=1;var c=1;var j=g.id;var b=false;if(settings.articlepopover.enableImageTabletResize!=null&&settings.articlepopover.enableImageTabletResize=="true"){b=true}if(currentProfile=="tablet"&&b){var h=$("#"+j+" img").get(0);if(h!=null){e(h)}}if($("#"+j+" .contentImage").size()>1){if(currentProfile=="phone"){$("#"+j+" .nextImage")[0].childNodes[0].textContent="";$("#"+j+" .previousImage")[0].childNodes[0].textContent=""}else{if((typeof isTribReader!="undefined"&&isTribReader==true)&&(g.lang&&g.lang=="es")){$("#"+j+" .nextImage")[0].childNodes[0].textContent="ANTERIOR IMAGEN";$("#"+j+" .previousImage")[0].childNodes[0].textContent="SIGUIENTE IMAGEN"}else{}}c=$("#"+j+" .contentImage").size();if(c>1){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){$("#"+j+" .contentImage:lt("+(c-1)+")").hide();$("#"+j+" .nextImage").hide()}else{$("#"+j+" .contentImage:gt(0)").hide();$("#"+j+" .previousImage").hide()}d()}else{if(c==1){$("#"+j+" .imageControls").hide()}}$("#"+j+" .nextImage").on("click touchstart",function(){var m=$("#"+j+" .contentImage:visible");var k=$("#"+j+" .contentImage:visible").next();var l=$(k[0]).find("img:first").get(0);m.hide();if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){f--}else{f++}d();k.fadeIn();$("#"+j+" .previousImage").show();if(k.is("#"+j+" .contentImage:last")){$("#"+j+" .nextImage").hide()}mainPanel.fireEvent("articleNextImageClick",g,f)});$("#"+j+" .previousImage").on("click touchstart",function(){var m=$("#"+j+" .contentImage:visible");var k=$("#"+j+" .contentImage:visible").prev();var l=$(k[0]).find("img:first").get(0);m.hide();if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){f++}else{f--}d();k.fadeIn();$("#"+j+" .nextImage").show();if(k.is("#"+j+" .contentImage:first")){$("#"+j+" .previousImage").hide()}mainPanel.fireEvent("articlePreviousImageClick",g,f)})}else{$("#"+j+" .imageControls").hide()}function d(){if((typeof isTribReader!="undefined"&&isTribReader==true)&&(g.lang&&g.lang=="es")){var l="Imagen "+f.toString()+" de "+c.toString()}else{var m=typeof language!="undefined"&&language.image!=null?language.image:"Image";var k=typeof language!="undefined"&&language.of!=null?language.of:"of";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){var l=c.toString()+" / "+f.toString()}else{var l=m+" "+f.toString()+" "+k+" "+c.toString()}$("#"+j+" .imageCount").text(l)},intializeForIfram},getIframeContent:function(){var e=this;var b=e.articleguid;e.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");var d="../article_popover.aspx?articleguid="+b+"&html5="+currentProfile;if(e.popoverType=="guid"){e.content.element.dom.style.overflowY="";d="../article_popover.aspx?guid="+b+"&html5="+currentProfile}e.content.setScrollable("none");e.content.setHtml('<div class=\'iframeWrapper\' style=\'position:absolute; width:100%; height:100%; overflow-y:scroll; -webkit-overflow-scrolling:touch;\'><iframe style="border:none;width:100%; height:100%" class="iframePopover" src="'+d+'" /></div>');var a=$(e.element.dom).find(".x-scroll-scroller")[0];if(a!=null){$(a).css("padding","0px 0px")}var c=$(e.content.element.dom).find(".iframePopover")[0];c.onload=function(){e.removeSpinner();if(c.contentWindow.SetPlatformType!=null){c.contentWindow.SetPlatformType("web")}if(c.contentWindow!=null&&typeof c.contentWindow.updateText=="function"&&typeof fontEm!="undefined"){c.contentWindow.updateText(fontEm)}try{$(".printContainer")[0].innerHTML=("<div class='DS-layout-detail DS-modus-replica DS-is-online miller-loaded LB-layout-detail LB-modus-replica LB-platform-web merriweather-400-loaded merriweather-700-loaded'><div class='DS-root' style='padding: 20px;'>"+c.contentDocument.documentElement.innerHTML.trim()+"</div></div>")}catch(f){}}},destroy:function(){var b=this;if(b.adSlot!=null&&typeof googletag!="undefined"){googletag.destroySlots([b.adSlot])}if(b.adSlotMpu!=null&&typeof googletag!="undefined"){googletag.destroySlots([b.adSlotMpu])}try{b.destroyAdverts()}catch(a){console.error("ReaderArticlePopoverItem]: Error Caught",a)}b.destroyed=true;if(b.updateLinkAjax!=null&&typeof b.updateLinkAjax.abort==="function"){b.updateLinkAjax.abort()}if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){b.removeTemplateFrameTouchListeners();if(b.templateRequest&&typeof b.templateRequest.abort==="function"){b.templateRequest.abort()}if(b.writeTimeout!=null){clearTimeout(b.writeTimeout)}if(b.displayTemplateTimeout!=null){clearTimeout(b.displayTemplateTimeout)}}Ext.Container.prototype.destroy.apply(this,arguments)},getSelectedText:function(){var c=this;var d="";try{if(c.contentTemplateIframe!=null){var a=c.contentTemplateIframe.contentDocument||c.contentTemplateIframe.contentWindow.document;if(typeof a.getSelection!="undefined"){d=a.getSelection().toString()}else{if(typeof a.selection!="undefined"&&a.selection.type=="Text"){d=a.selection.createRange().text}}}}catch(b){console.log("[ReaderArticlePopoverItem]: Error Caught",b)}return d},setFrame:function(){var a=this;a.mode=="frame";a.setIframeContent()},toggleToTextMode:function(){var a=this;if(a.mode=="html"){if(a.painted){a.setIframeContent()}a.contentCard.setActiveItem(a.contentIframe);a.mode="frame"}else{a.contentCard.setActiveItem(a.content);a.mode="html"}},checkAdbridgAdvertStylingForIframe:function(){var d=this;var b="";var a=typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.popupAdvert?settings.reader.popupAdvert:{};if(a.type=="adbridg"){b+="#"+d.advertDivID+"-container { display:none; }\n"}var c=typeof settings!="undefined"&&!!settings.reader&&!!settings.reader.popupAdvertMpu?settings.reader.popupAdvertMpu:{};if(c.type=="adbridg"){b+="#"+d.advertDivIDMpu+"-container { display:none; }\n"}return !!b?"<style>"+b+"</style>":""},setIframeContent:function(){var a=this;if(a.contentIframe!=null&&a.contentIframe.getHtml()==null){a.contentIframe.setHtml("<iframe class=\"articleiframe\" style='width:100%; height:100%; border:none'></iframe>");requestAnimationFrame(function(){var e=a.contentIframe.element.down("iframe").dom;var n="phoneArticle";if(currentProfile=="tablet"){n="tabletArticle"}var b="<div class='"+n+"'>"+a.content.getHtml()+'</div><script>setImages("'+currentProfile+'");<\/script>';var d="";if(typeof customCSS!="undefined"){var q=customCSS.split("|");for(var f=0;f<q.length;f++){var o=atob(q[f]);d+="<link rel='stylesheet' type='text/css' href='"+o+"' />"}}var k="20";if(currentProfile=="phone"){k="15"}var m="<script>cols[i].style.fontSize = font35Size;<\/script>";var h="<style>body { margin:0 } p { margin:0; padding:0; } .articleContentHtml5, .articleContent { overflow:auto !important; -webkit-overflow-scrolling:touch; padding: 0 "+k+"px; height: 100% !important; font-size:"+fontEm+"px; max-width:100%; } .imageControls{ display:none; }</style><script>function updateText(fontsize) { document.getElementsByClassName('articleContent')[0].style.fontSize = fontsize + 'px' }<\/script>";var g="<html><head>{{HEAD}}</head><body class='in-iframe'>{{BODY}}</body></html>";var c="<link rel='stylesheet' type='text/css' href='resources/css/article.css'>"+d+'<script src="resources/js/articleGallery.js?build='+buildguid+'"><\/script><script>window.onload = function(){ setImages(); }<\/script>'+h;c+=a.checkAdbridgAdvertStylingForIframe();g=g.replace("{{HEAD}}",c);g=g.replace("{{BODY}}",b);g=g.replace("setText()","");var j=function(){return e.contentWindow?e.contentWindow:(e.contentDocument?e.contentDocument.document:e.contentDocument)};a.iframe=j();var l=function(r){r=a.checkIframeAdvert(r);a.iframe.document.write(r);a.iframe.addEventListener("gesturestart",function(s){s.preventDefault()})};if(a.iframe==null){var p=function(){a.iframe=j();l(g);e.removeEventListener("load",p)};e.addEventListener("load",p)}else{l(g)}})}},checkIframeAdver},setupIframeMpuAdver},setupIframeAdver},setupDfpIframeMpuAdver},setupDfpIframeAdvert:function(f,g){var e=this;var a=g;if(a!=null){var j=a;e.advertIframeDivId=e.advertDivID+"-iframe";j=j.replace(e.advertDivID,e.advertIframeDivId);var c="";if(settings.reader.popupAdvert!=null&&settings.reader.popupAdvert.targeting!=null&&settings.reader.popupAdvert.targeting.length>0){c="var targets = '"+settings.reader.popupAdvert.targeting+'\'.split("|");for (var i in targets) {var thisTarget = targets[i];var values = thisTarget.split("*");if (values != null && values.length >= 2) {values[1] = values[1].replace("{{PAGE}", \''+e.page.page+"').replace(\"{{SECTION}}\", '"+e.section+"');adSlot1.setTargeting(values[0], values[1]);}}"}var b="728";var d="90";if(currentProfile=="phone"){b="320";d="50"}j=e.returnGoogletagString()+"<script>window.loadAdvert = function(){\ngoogletag.cmd.push(function () {\nvar adSlot1 = googletag.defineSlot('/"+e.networkCode+"/"+e.adUnit+"', [parseInt('"+b+"'), parseInt('"+d+"')],'"+e.advertIframeDivId+"');\nadSlot1.addService(googletag.pubads().updateCorrelator());"+c+"googletag.enableServices();\n});\ngoogletag.cmd.push(function () {\ngoogletag.display('"+e.advertIframeDivId+"');\n});\n} <\/script>"+j;return j}},returnGoogletagString:function(){return'<script>var googletag = googletag || {};googletag.cmd = googletag.cmd || [];(function () {var gads = document.createElement("script");gads.async = true; gads.type = "text/javascript"; var useSSL = "https:" == document.location.protocol;gads.src = (useSSL ? "https:" : "http:") + "//www.googletagservices.com/tag/js/gpt.js"; var node = document.getElementsByTagName("script")[0];node.parentNode.insertBefore(gads, node);})();<\/script >'},loadIframeAdvertMpu:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvertMpu!=null){switch(settings.reader.popupAdvertMpu.type){case"dfp":a.loadIframeDfpAdvertMpu();break}}},loadIframeAdver},loadIframeDfpAdvertMpu:function(){var a=this;setTimeout(function(){if(!a.destroyed){if(a.iframe!=null&&a.iframe.loadAdvertMpu!=null){a.iframe.loadAdvertMpu()}}},a.advertTimeout)},loadIframeDfpAdver},sendNewPageViewForHtlbidCustomAd:function(){try{if(this.newPageViewForHtlbidCustomAdPending===true){this.newPageViewForHtlbidCustomAdPending=false;InfinityMobile.app.application.getController("ArticlePopoverController").sendNewPageViewForHtlbidCustomAd()}}catch(a){console.warn("[ReaderArticlePopoverItem]: Error Caught",a)}},destroyAdverts:function(){if(!this.destroyed){if(this.customBannerAd!=null&&this.customBannerAd.destroyAdvert!=null){this.customBannerAd.destroyAdvert();this.customBannerAd=null}if(this.customMpuAd!=null&&this.customMpuAd.destroyAdvert!=null){this.customMpuAd.destroyAdvert();this.customMpuAd=null}}}},0,["readerarticlepopoveritem"],["component","container","readerarticlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true},["widget.readerarticlepopoveritem"],0,[InfinityMobile.view,"ReaderArticlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderPuzzlePopoverItem",InfinityMobile.view.ReaderArticlePopoverItem,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",layout:"vbox",items:[{itemId:"content",flex:1,layout:"card",items:[{scrollable:{direction:"vertical",directionLock:true},itemId:"contentHtml"}]},{itemId:"bottomBar",cls:"bottomBar",height:60,style:"font-size: 14px;",layout:{type:"hbox",pack:"middle",align:"center"},items:[{itemId:"archive",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/archive-ic.png' style='height:32px' />"},{width:5},{html:"Archive"}]},{width:10},{itemId:"print",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/print-icon.png' style='height:32px' />"},{width:5},{html:"Print"}]},{width:10},{itemId:"share",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{itemId:"shareText",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/share-ic.png' style='height:32px' />"},{width:5},{html:"Share"}]},{itemId:"shareFrame",hidden:true,layout:{type:"hbox",pack:"middle",align:"center"}}]},{itemId:"interactivemargin",width:10},{itemId:"interactive",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/interactive-ic.png' style='height:32px' />"},{width:5},{html:"Interactive Version"}]}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderArticlePopoverItem.prototype.initialize.apply(this,arguments);a.bottomBar=a.getComponent("bottomBar");a.archiveButton=a.bottomBar.getComponent("archive");a.printButton=a.bottomBar.getComponent("print");a.shareButton=a.bottomBar.getComponent("share");a.shareText=a.shareButton.getComponent("shareText");a.shareFrame=a.shareButton.getComponent("shareFrame");a.interactiveMargin=a.bottomBar.getComponent("interactivemargin");a.interactiveButton=a.bottomBar.getComponent("interactive");a.setArchiveListener();a.setPrintListener();a.setShareListener();a.setInteractiveListener();a.setUpShare();a.checkInteractive();a.checkBottomBar()},checkBottomBar:function(){var a=this;if(!(settings.articlepopover.puzzleBottomBar!=null&&settings.articlepopover.puzzleBottomBar=="true")){a.bottomBar.hide()}},setUpShare:function(){var f=this;var g="http://"+window.location.hostname+"/infinity/article_popover_share.aspx?guid="+f.articleguid;var a=g;try{g=InfinityMobile.app.application.getController("AppController").addPwaAppCodeQueryParamToUrl(g)}catch(c){g=a;console.warn("[ReaderPuzzlePopoverItem]: Error Caught\n",c)}finally{a=null}message=f.config.page.description;var b=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"http://html5.pagesuite.com/preview/assets/article%20view/email-ic.png",link:"mailto:?body={0}&subject={1}",url:g,message:message,height:30,width:30});f.shareFrame.add(b);var e=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"http://html5.pagesuite.com/preview/assets/article%20view/facebook-ic.png",link:"http://www.facebook.com/sharer/sharer.php?m2w&u={0}&title={1}",url:g,message:message,height:30,width:30});f.shareFrame.add(e);var d=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"http://html5.pagesuite.com/preview/assets/article%20view/twitter-ic.png",link:"http://twitter.com/intent/tweet?text={0} - {1}",url:g,message:message,height:30,width:30});f.shareFrame.add(d)},setArchiveListener:function(){var a=this;if(settings.articlepopover.puzzleArchive!=null&&settings.articlepopover.puzzleArchive=="true"){a.archiveButton.element.on("tap",function(){a.fireEvent("puzzleArchive",a)})}else{a.archiveButton.hide()}},setPrintListener:function(){var a=this;a.printButton.element.on("tap",function(){a.fireEvent("puzzlePrintMobile",a)})},setShareListener:function(){var a=this;a.shareButton.element.on("tap",function(){a.fireEvent("puzzleShare",a)})},setInteractiveListener:function(){var a=this;a.interactiveButton.element.on("tap",function(){a.fireEvent("puzzleInteractive",a)})},checkInteractive:function(){var a=this;if(a.getPage().title!="Interactive Puzzle"){a.interactiveMargin.setHidden(true);a.interactiveButton.setHidden(true)}}},0,["readerpuzzlepopoveritem"],["component","container","readerarticlepopoveritem","readerpuzzlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true,readerpuzzlepopoveritem:true},["widget.readerpuzzlepopoveritem"],0,[InfinityMobile.view.tablet,"ReaderPuzzlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderPuzzlePopoverItem",InfinityMobile.view.ReaderArticlePopoverItem,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",layout:"vbox",items:[{itemId:"content",flex:1,layout:"card",items:[{scrollable:{direction:"vertical",directionLock:true},itemId:"contentHtml"}]},{itemId:"bottomBar",cls:"bottomBar",height:60,style:"font-size: 12px;",layout:{type:"hbox",pack:"middle",align:"center"},items:[{flex:1},{itemId:"archive",width:90,height:30,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/archive-ic.png' style='height:20px' />"},{width:5},{html:"Archive"}]},{itemId:"archiveMargin",flex:1},{itemId:"print",width:90,height:30,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/print-icon.png' style='height:20px' />"},{width:5},{html:"Print"}]},{itemId:"interactivemargin",flex:1},{itemId:"interactive",width:90,height:30,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/interactive-ic.png' style='height:20px' />"},{width:5},{html:"Interactive"}]},{flex:1}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderArticlePopoverItem.prototype.initialize.apply(this,arguments);a.bottomBar=a.getComponent("bottomBar");a.archiveButton=a.bottomBar.getComponent("archive");a.archiveMargin=a.bottomBar.getComponent("archiveMargin");a.printButton=a.bottomBar.getComponent("print");a.interactiveMargin=a.bottomBar.getComponent("interactivemargin");a.interactiveButton=a.bottomBar.getComponent("interactive");a.setArchiveListener();a.setPrintListener();a.setInteractiveListener();a.checkInteractive();a.checkBottomBar()},checkBottomBar:function(){var a=this;if(!(settings.articlepopover.puzzleBottomBar!=null&&settings.articlepopover.puzzleBottomBar=="true")){a.bottomBar.hide()}},setArchiveListener:function(){var a=this;if(settings.articlepopover.puzzleArchive!=null&&settings.articlepopover.puzzleArchive=="true"){a.archiveButton.element.on("tap",function(){a.fireEvent("puzzleArchive",a)})}else{a.archiveButton.hide();a.archiveMargin.hide()}},setPrintListener:function(){var a=this;a.printButton.element.on("tap",function(){a.fireEvent("puzzlePrintMobile",a)})},setShareListener:function(){var a=this;a.shareButton.element.on("tap",function(){a.fireEvent("puzzleShare",a)})},setInteractiveListener:function(){var a=this;a.interactiveButton.element.on("tap",function(){a.fireEvent("puzzleInteractive",a)})},checkInteractive:function(){var a=this;if(a.getPage().title!="Interactive Puzzle"){a.interactiveMargin.setHidden(true);a.interactiveButton.setHidden(true)}}},0,["readerpuzzlepopoveritem"],["component","container","readerarticlepopoveritem","readerpuzzlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true,readerpuzzlepopoveritem:true},["widget.readerpuzzlepopoveritem"],0,[InfinityMobile.view.phone,"ReaderPuzzlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArchiveSelector",Ext.Panel,{config:{height:60,padding:"0 10px",layout:{type:"vbox",align:"center"},items:[{itemId:"selectEdition",style:"font-size:11pt;",html:"Select edition:",width:"100%"},{height:10},{itemId:"container",width:"100%",layout:"hbox",items:[{style:"font-size:11pt;",html:"<div class='selectBox'><select id='yearDropDown'></select></div>"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='monthDropDown'></select></div>"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='dayDropDown'></select></div>"},{width:10},{itemId:"change",height:25,cls:"pointerCursor",style:"font-size:11pt;position:relative;",html:'<span style="position:absolute;bottom:0px;text-decoration:underline;">Change</span>'}]}]},initializ},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},populateYearDropDow},populateMonthDropDow},populateDayDropDow},addOptio},setTodaysDat},formatDat},trimMonthToCurrent:function(){var a=this},trimDayToMont},trimDayToCurren},trimDay:function(a){},changeEditio}},0,["archiveselector"],["component","container","panel","archiveselector"],{component:true,container:true,panel:true,archiveselector:true},["widget.archiveselector"],0,[InfinityMobile.view.phone,"ArchiveSelector"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderSpecialArchive",InfinityMobile.view.Overlay,{config:{id:"archivecontainer",height:"100%",width:"100%",style:"padding:0px;max-height:700px;max-width:700px;",items:[{id:"archiveToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{id:"archiveToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"archiveBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"archiveContainerText",margin:"0 0 20px 0"},{layout:"hbox",height:560,itemId:"archiveItemsGlobalContainer",items:[{id:"archiveItemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:145,margin:"0 8 16 7",cls:"archiveitemphone"}}]}]}]},initialize:function(){var e=this;var a=e.getComponent("archiveToolBar");e.archiveToolBarClose=a.getComponent("archiveToolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});e.title=a.getComponent("title");var b=e.config.titleText==null?settings.newsday.specialArchive.name:e.config.titleText;e.title.setHtml(b);var c=e.getComponent("archiveBodyContainer");e.archiveContainerText=c.getComponent("archiveContainerText");var d=e.config.desc==null?settings.newsday.specialArchive.specialArchiveContainerText:e.config.desc;e.archiveContainerText.setHtml(d);var f=c.getComponent("archiveItemsGlobalContainer");e.archiveItemsContainer=f.getComponent("archiveItemsContainer");e.setCloseListener();if(e.config.editions==null){e.fireEvent("initialized",e)}else{e.fireEvent("initializeExtraArchive",e,e.config.editions)}e.setupTabSelector()},setCloseListener:function(){var b=this;b.archiveToolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.archiveToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setupTabSelector:function(){var c=this;var a=false;if(settings.newsday!=null&&settings.newsday.specialArchive!=null){a=true}else{if(settings.menu!=null&&settings.menu.extraArchives!=null){a=true}}if(a){c.archiveContainerText.hide();var d=c.config.editions==null?settings.newsday.specialArchive.name:c.config.titleText;var b=Ext.create("InfinityMobile.view.ArchiveTabSelector",{startName:d});c.insert(1,b)}},close:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["readerspecialarchive"],["component","container","panel","overlay","readerspecialarchive"],{component:true,container:true,panel:true,overlay:true,readerspecialarchive:true},["widget.readerspecialarchive"],0,[InfinityMobile.view.tablet,"ReaderSpecialArchive"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderSpecialArchive",InfinityMobile.view.Overlay,{config:{id:"archivecontainer",width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"archiveToolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{id:"archiveToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"archiveBodyContainer",padding:"20",layout:"vbox",flex:1,style:"font-size:15px",items:[{itemId:"archiveContainerText"},{height:20},{id:"archiveItemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{cls:"archiveitemphone"}}]}]},initialize:function(){var e=this;var a=e.getComponent("archiveToolBar");e.archiveToolBarClose=a.getComponent("archiveToolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});e.title=a.getComponent("title");var b=e.config.titleText==null?settings.newsday.specialArchive.name:e.config.titleText;e.title.setHtml(b);var c=e.getComponent("archiveBodyContainer");e.archiveItemsContainer=c.getComponent("archiveItemsContainer");e.archiveContainerText=c.getComponent("archiveContainerText");var d=e.config.desc==null?settings.newsday.specialArchive.specialArchiveContainerText:e.config.desc;e.archiveContainerText.setHtml(d);e.setCloseListener();if(e.config.editions==null){e.fireEvent("initialized",e)}else{e.fireEvent("initializeExtraArchive",e,e.config.editions)}e.setupTabSelector()},setCloseListener:function(){var b=this;b.archiveToolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.archiveToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setupTabSelector:function(){var c=this;var a=false;if(settings.newsday!=null&&settings.newsday.specialArchive!=null){a=true}else{if(settings.menu!=null&&settings.menu.extraArchives!=null){a=true}}if(a){c.archiveContainerText.hide();var d=c.config.editions==null?settings.newsday.specialArchive.name:c.config.titleText;var b=Ext.create("InfinityMobile.view.ArchiveTabSelector",{startName:d});c.insert(1,b)}},close:function(){var a=this;a.fireEvent("close",a)}},0,["readerspecialarchive"],["component","container","panel","overlay","readerspecialarchive"],{component:true,container:true,panel:true,overlay:true,readerspecialarchive:true},["widget.readerspecialarchive"],0,[InfinityMobile.view.phone,"ReaderSpecialArchive"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPrint",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);a.setupVars();a.setupLanguage();a.setupListeners();a.checkSelectAll(a.printSinglePageOnly);a.loadPages()},setupVars:function(){var a=this;a.toolbar=a.getComponent("toolbar");a.printBody=a.getComponent("body");a.buttonContainer=a.printBody.getComponent("buttonsContainer");a.selectAll=a.buttonContainer.getComponent("selectAll");a.selectAllMargin=a.buttonContainer.getComponent("selectAllMargin");a.selectNone=a.buttonContainer.getComponent("selectNone");a.selectNoneMargin=a.buttonContainer.getComponent("selectNoneMargin");a.print=a.buttonContainer.getComponent("print");a.title=a.toolbar.getComponent("title");a.desc=a.printBody.getComponent("desc");a.printItemsContainer=a.printBody.getComponent("printItems");a.printSinglePageOnly=false;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.printSinglePageOnly=="true"){a.printSinglePageOnly=true}a.titleStr="Print";if(typeof language!="undefined"&&language.print!=null&&language.print.print!=null){a.titleStr=language.print.print}a.printDesc="To print, simply select the pages that you wish to print out and select the 'Print' button.";if(typeof language!="undefined"&&language.print!=null&&language.print.printContainerText!=null){a.printDesc=language.print.printContainerText}a.selectAllTxt="Select All";if(typeof language!="undefined"&&language.print!=null&&language.print.selectAll!=null){a.selectAllTxt=language.print.selectAll}a.selectNoneTxt="Select None";if(typeof language!="undefined"&&language.print!=null&&language.print.printSelectNone!=null){a.selectNoneTxt=language.print.printSelectNone}},setupLanguage:function(){var a=this;if(a.toolbar!=null&&a.toolbar.setText!=null){a.toolbar.setText(a.titleStr)}if(a.selectAll!=null&&a.selectAll.setText!=null){a.selectAll.setText(a.selectAllTxt)}if(a.selectNone!=null&&a.selectNone.setText!=null){a.selectNone.setText(a.selectNoneTxt)}if(a.print!=null&&a.print.setText!=null){a.print.setText(a.titleStr)}if(a.desc!=null){a.setText(a.desc,a.printDesc)}},setText:function(a,b){if(a!=null){a.setHtml(b)}},loadPages:function(){var a=this;a.fireEvent("loadPages",a,a.printItemsContainer)},setupListeners:function(){var a=this;if(a.selectAll!=null&&a.selectAll.setTap!=null){a.selectAll.setTap(function(){a.fireEvent("selectAll",a)})}if(a.selectNone!=null&&a.selectNone.setTap!=null){a.selectNone.setTap(function(){a.fireEvent("selectNone",a)})}if(a.print!=null&&a.print.setTap!=null){a.print.setTap(function(){a.fireEvent("print",a)})}},checkSelectAll:function(b){var a=this;if(b){if(a.selectAll!=null&&a.selectAllMargin!=null){a.selectAll.hide();a.selectAllMargin.hide()}if(a.selectNone!=null&&a.selectNoneMargin!=null){a.selectNone.hide();a.selectNoneMargin.hide()}}}},0,["printmenuparent"],["component","container","panel","overlay","printmenuparent"],{component:true,container:true,panel:true,overlay:true,printmenuparent:true},["widget.printmenuparent"],0,[InfinityMobile.view,"ReaderPrint"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderPrint",InfinityMobile.view.ReaderPrint,{config:{width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{id:"toolbar",xtype:"readeroverlaytitle",titleTxt:"Print",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"body",cls:"overlaybody",flex:1,padding:25,layout:"vbox",items:[{itemId:"desc"},{itemId:"buttonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"selectAll",xtype:"readeroverlaybutton",txt:"Select All"},{itemId:"selectAllMargin",width:25},{itemId:"selectNone",xtype:"readeroverlaybutton",txt:"Select None"},{itemId:"selectNoneMargin",width:25},{itemId:"print",xtype:"readeroverlaybutton",txt:"Print"}]},{itemId:"printItems",flex:1,xtype:"readeritemscontainer",defaults:{width:145,margin:"0 6 10 6"}}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderPrint.prototype.initialize.apply(this,arguments)}},0,["printmenu"],["component","container","panel","overlay","printmenuparent","printmenu"],{component:true,container:true,panel:true,overlay:true,printmenuparent:true,printmenu:true},["widget.printmenu"],0,[InfinityMobile.view.tablet,"ReaderPrint"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderPrint",InfinityMobile.view.ReaderPrint,{config:{width:"100%",height:"100%",style:"padding:0px",layout:"vbox",items:[{id:"toolbar",xtype:"readeroverlaytitle",titleTxt:"Print",parentOverlay:this,destoryOnClose:true,rounded:false},{itemId:"body",cls:"overlaybody",flex:1,padding:15,layout:"vbox",items:[{itemId:"desc"},{itemId:"buttonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:70,style:"font-size:15px",defaults:{height:30,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"selectAll",xtype:"readeroverlaybutton",txt:"Select All",flex:1},{itemId:"selectAllMargin",width:25},{itemId:"selectNone",xtype:"readeroverlaybutton",txt:"Select None",flex:1},{itemId:"selectNoneMargin",width:25},{itemId:"print",xtype:"readeroverlaybutton",txt:"Print",flex:1}]},{itemId:"printItems",flex:1,xtype:"readeritemscontainer",defaults:{width:"46%",margin:"0 6 10 6"}}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderPrint.prototype.initialize.apply(this,arguments)}},0,["printmenu"],["component","container","panel","overlay","printmenuparent","printmenu"],{component:true,container:true,panel:true,overlay:true,printmenuparent:true,printmenu:true},["widget.printmenu"],0,[InfinityMobile.view.phone,"ReaderPrint"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderWebpopover",InfinityMobile.view.Overlay,{config:{style:"padding:0px",zIndex:999999},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);if(a.config.mediaObj!=null){a.mediaObj=a.config.mediaObj}a.initialiseChildVariables();a.configurePopover();a.initialiseIframe();a.setSquareCorners()},initialiseChildVariables:function(){var a=this;a.desktopBody=a.getComponent("body");a.webpopoverIframe=a.desktopBody.getComponent("webpopoverIframe");a.toolbar=a.getComponent("toolbar")},setText:function(a,b){if(a!=null){a.setText(b)}},configurePopover:function(){var e=this;if(e.desktopBody!=null||typeof e.desktopBody!="undefined"){e.setHeight(e.mediaObj.playerH+"%");e.setWidth(e.mediaObj.playerW+"%");var d,b=$(e.desktopBody.element.dom).find("x-container"),c=$(e.desktopBody.element.dom).find("x-innerhtml");if(b!=null){var a=e.desktopBody.element.dom.getElementsByClassName("x-container")[0];a.style.height="100%";a.style.padding=0}if(c!=null){var f=e.desktopBody.element.dom.getElementsByClassName("x-innerhtml")[0];f.style.height="100%"}e.setText(e.toolbar,e.mediaObj.url);return}console.error("desktopBody is not defined");return},initialiseIframe:function(){var a=this;if(a.webpopoverIframe!=null||typeof a.webpopoverIframe!="undefined"){var b=$(a.webpopoverIframe.element.dom).find(".popoverIframe");if(b!=null||b.length<=0){$(b[0]).attr("src",a.mediaObj.url);return}console.error("Couldn't locate Iframe DOM element");return}console.error("Iframe is not defined");return},getIframeTitle:function(){var a=this;a.on("painted",function(){a.iframe=a.desktopBody.element.dom.getElementsByTagName("iframe")[0];a.iframe.onload=function(){try{var b=a.iframe.contentWindow.document;if(b!=null||typeof b!="undefined"){a.setText(a.toolbar,b.title)}}catch(c){console.error(c);return}}})}},0,["webpopoverparent"],["component","container","panel","overlay","webpopoverparent"],{component:true,container:true,panel:true,overlay:true,webpopoverparent:true},["widget.webpopoverparent"],0,[InfinityMobile.view,"ReaderWebpopover"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderWebpopover",InfinityMobile.view.ReaderWebpopover,{cls:"popover-parent",config:{layout:"vbox",items:[{id:"toolbar",xtype:"readeroverlaytitle",titleTxt:"",style:"padding: 10px;",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"body",cls:"overlaybody",flex:1,width:"100%",layout:"vbox",style:"overflow:hidden;position:relative;",items:[{itemId:"webpopoverIframe",layout:"fit",xtype:"panel",padding:0,top:0,right:0,left:0,bottom:0,html:"<div class='iframe-container'><iframe class='popoverIframe'style='height:100%;width:100%;border:none;' src=''><p>This browser doesn't support iframes</p></iframe></div>"}]}]},initialize:function(){InfinityMobile.view.ReaderWebpopover.prototype.initialize.apply(this,arguments)}},0,["webpopover"],["component","container","panel","overlay","webpopoverparent","webpopover"],{component:true,container:true,panel:true,overlay:true,webpopoverparent:true,webpopover:true},["widget.webpopover"],0,[InfinityMobile.view.tablet,"ReaderWebpopover"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderWebpopover",InfinityMobile.view.ReaderWebpopover,{cls:"popover-parent",config:{layout:"vbox",items:[{id:"toolbar",xtype:"readeroverlaytitle",titleTxt:"",padding:10,parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"body",cls:"overlaybody",flex:1,width:"100%",layout:"vbox",style:"overflow:hidden;position:relative;",items:[{itemId:"webpopoverIframe",layout:"fit",xtype:"panel",padding:0,top:0,right:0,left:0,bottom:0,html:"<div class='iframe-container'><iframe class='popoverIframe'style='height:100%;width:100%;border:none;' src=''><p>This browser doesn't support iframes</p></iframe></div>"}]}]},initialize:function(){InfinityMobile.view.ReaderWebpopover.prototype.initialize.apply(this,arguments)},configurePopover:function(){InfinityMobile.view.ReaderWebpopover.prototype.configurePopover.apply(this,arguments);var a=this;a.setHeight("100%");a.setWidth("100%")}},0,["webpopover"],["component","container","panel","overlay","webpopoverparent","webpopover"],{component:true,container:true,panel:true,overlay:true,webpopoverparent:true,webpopover:true},["widget.webpopover"],0,[InfinityMobile.view.phone,"ReaderWebpopover"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderMenuFeedApp",InfinityMobile.view.Overlay,{config:{itemId:"container",layout:"hbox",style:"background-color:#1e1e1e;padding:0; border-radius:0;height: 100% ;transition: top 1s;transform: translateX(100%); transition: 0.5s ease all;",right:0,top:0,baseCls:"menu",cls:"reader-menu",width:"auto",items:[{itemId:"articlesContainer",height:"100%",width:375,defaults:{width:"100%"},scrollable:{direction:"vertical",directionLock:true},layout:"vbox"},{itemId:"menuContentsContainer",height:"100%",width:225,layout:"vbox",items:[{itemId:"menuHeader",margin:0,height:40,padding:"10 15 10 15",items:[{itemId:"menuHeaderClose",cls:"pointerCursor",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{itemId:"menuScroller",scrollable:{direction:"vertical",directionLock:true},height:"calc(100% - 40px)",layout:"vbox",items:[{id:"menuHome",cls:"menuItem menuHome",clickType:"id",xtype:"readermenuitem",text:"Home",height:60,padding:15},{id:"menuSections",cls:"menuSectionHeader menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:20px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"SECTIONS",height:60},{itemId:"menuSectionsContainer",cls:"menuSectionContent menuSections",layout:"vbox",margin:0,defaults:{padding:15,height:60},style:"overflow:hidden;",minimized:false},{id:"menuEditionOptions",cls:"menuSectionHeader menuEditionOptions",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:20px;color:#cccccc;border-bottom:0.5px solid gray;",padding:"15 15",text:"EDITION OPTIONS",height:60},{itemId:"editionOptionsSection",cls:"menuSectionContent menuEditionOptions",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15,height:60},minimized:false,items:[{id:"menuPages",cls:"menuItem menuPages",clickType:"id",xtype:"readermenuitem",text:"Pages"},{id:"menuArchive",cls:"menuItem menuArchive",clickType:"id",xtype:"readermenuitem",text:"Archive"},{id:"menuSpecialArchive",cls:"menuItem menuSpecialArchive",clickType:"id",xtype:"readermenuitem",text:"Special Archive"},{id:"menuNewsdayFunbook",cls:"menuItem menuFunbook",clickType:"id",xtype:"readermenuitem",text:"Fun Book",hidden:true},{id:"menuArticles",cls:"menuItem menuArticles",xtype:"readermenuitem",text:"Articles"},{id:"menuDownload",cls:"menuItem menuDownload",clickType:"id",xtype:"readermenuitem",text:"Download"},{id:"menuSearch",cls:"menuItem menuSearch",clickType:"id",xtype:"readermenuitem",text:"Search"},{id:"menuBookmarks",cls:"menuItem menuBookmarks",clickType:"id",xtype:"readermenuitem",text:"Bookmarks"},{id:"menuSupplementsTab",cls:"menuItem menuSupplementsTab",clickType:"id",xtype:"readermenuitem",text:"Supplements Tab"},{id:"menuCreateClipping",cls:"menuItem menuCreateClipping",clickType:"id",xtype:"readermenuitem",text:"Create Clipping"},{id:"menuPrint",cls:"menuItem menuPrint",clickType:"id",xtype:"readermenuitem",text:"Print"},{id:"menuSharing",cls:"menuItem menuSharing",xtype:"readermenushare",layout:"vbox"}]},{id:"menuSupplements",cls:"menuSectionHeader menuSupplements",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:20px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"SUPPLEMENTS",height:60},{itemId:"menuSupplementsContainer",cls:"menuSectionContent menuSupplements",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;",minimized:false},{id:"menuZones",cls:"menuSectionHeader menuZones",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:20px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"ZONES",height:60},{itemId:"menuZonesContainer",cls:"menuSectionContent menuZones",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;",minimized:false},{id:"menuQuickLinks",cls:"menuSectionHeader menuQuickLinks",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:20px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"QUICK LINKS",height:60},{itemId:"menuQuickLinksContainer",cls:"menuSectionContent menuQuickLinks",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;",minimized:false},{id:"menuInfo",cls:"menuSectionHeader menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:20px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"INFO",height:60},{itemId:"menuInfoContainer",cls:"menuSectionContent menuInfo",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;",minimized:false,items:[{id:"menuHowToUse",xtype:"readermenuitem",cls:"menuItem menuHowToUse",clickType:"id",text:"How to use"},{id:"menuHelp",xtype:"readermenuitem",cls:"menuItem menuHelp",clickType:"id",text:"Contact Us"},{id:"menuTerms",cls:"menuItem menuTerms",clickType:"id",xtype:"readermenuitem",text:"Terms and Conditions"},{id:"menuFaq",cls:"menuItem menuFaq",clcikType:"id",xtype:"readermenuitem",text:"FAQ"},{id:"menuPrivacy",cls:"menuItem menuPrivacy",clickType:"id",xtype:"readermenuitem",text:"Privacy Policy"},{id:"menuStoryPref",cls:"menuItem menuStoryPref",clickType:"id",xtype:"readermenuitem",text:"Story Window Preferences"}]},{id:"menuUserOp",cls:"menuSectionHeader menuUserOp",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:20px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",height:60,text:"USER OPTIONS"},{itemId:"menuUserContainer",cls:"menuSectionContent menuUserOp",layout:"vbox",margin:0,defaults:{padding:15,height:60},style:"overflow:hidden;",minimized:false,items:[{id:"menuAccount",xtype:"readermenuitem",cls:"menuItem menuAccount",clickType:"id",text:"My Account"},{id:"menuUser",xtype:"readermenuitem",cls:"menuItem menuUser",clickType:"id",text:"Logout"}]}]}]}]},initialize:function(){InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);this.setSquareCorners();this.setupVars();this.setColours();this.setCloseListener();this.checkArchive();this.checkDownload();this.checkClipping();this.checkPrint();this.checkBookmarks();this.checkHowToUse();this.checkLogout();this.checkTerms();this.checkSearch();this.checkPagesContainer();this.checkArticlesContainer();this.checkStoryWindowPrefs();this.checkFaq();this.checkSpecialArchive();this.checkSupplementsTab();this.checkPrivacyPolicy();this.loadShare();this.loadSections();this.loadSupplements();this.loadZones();this.loadQuickLinks();this.setupArticles();this.setupMouseListener();this.on({painted:this.animateMenu,scope:this})},animateMen},setupVars:function(){this.menuContentsContainer=this.getComponent("menuContentsContainer");this.menuScroller=this.menuContentsContainer.getComponent("menuScroller");this.articlesContainer=this.getComponent("articlesContainer");this.menuHeader=this.menuContentsContainer.getComponent("menuHeader");this.menuHeaderClose=this.menuHeader.getComponent("menuHeaderClose");this.sectionHeader=this.menuScroller.getComponent("menuSections");this.editionOptionsHeader=this.menuScroller.getComponent("menuEditionOptions");this.menuSupplementsHeader=this.menuScroller.getComponent("menuSupplements");this.menuSupplementsContainer=this.menuScroller.getComponent("menuSupplementsContainer");this.menuZonesHeader=this.menuScroller.getComponent("menuZones");this.menuZonesContainer=this.menuScroller.getComponent("menuZonesContainer");this.menuQuickLinksHeader=this.menuScroller.getComponent("menuQuickLinks");this.menuQuickLinksContainer=this.menuScroller.getComponent("menuQuickLinksContainer");this.menuInfoHeader=this.menuScroller.getComponent("menuInfo");this.menuInfoContainer=this.menuScroller.getComponent("menuInfoContainer");this.userOptionsHeader=this.menuScroller.getComponent("menuUserOp");this.logoutOption=this.userOptionsHeader;this.editionOptionsSection=this.menuScroller.getComponent("editionOptionsSection");this.sharingContainer=this.editionOptionsSection.getComponent("menuSharing");this.sectionsHeaderContainer=this.menuScroller.getComponent("menuSections");this.sectionsContainer=this.menuScroller.getComponent("menuSectionsContainer");this.sections=this.config.sections!=null?this.config.sections:this.sections;this.sectionIndex=0},setColours:function(){if(typeof settings!=="undefined"&&settings.menu!=null){this.setComponentColour(this.menuContentsContainer,"2f2f2f");this.setComponentColour(this.articlesContainer,"e3e3e3");this.setComponentColour(this.sectionHeader,"bfbfbf","ffffff");this.setComponentColour(this.editionOptionsHeader,"bfbfbf","ffffff");this.setComponentColour(this.userOptionsHeader,"bfbfbf","ffffff");this.setComponentColour(this.menuInfoHeader,"bfbfbf","ffffff");this.setComponentColour(this.menuSupplementsHeader,"bfbfbf","ffffff");this.setComponentColour(this.menuZonesHeader,"bfbfbf","ffffff");this.setComponentColour(this.menuQuickLinksHeader,"bfbfbf","ffffff");this.menuHeader.setStyle("border-bottom: 1px solid gray")}},setComponentColour:function(b,a,c){var e=currentProfile!="phone"?"font-size: 20px;":"font-size: 14px;";if(a.length>6){var d=hexaToRgba(a);e+=" background-color: rgba("+d+")"}else{e+=" background-color:#"+a+";"}if(c!=null){e+=" color: #"+c+";"}b.setStyle(e)},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){a.fireEvent("close")})},loadSections:function(){var a=this;a.fireEvent("loadSections",a,a.sectionsContainer,a.sectionsHeaderContainer);this.setupSectionTapEvents();this.setSelectedSectionColour()},setupSectionTapEvents:function(){var c=this;var d=this.sectionsContainer.getItems().items;for(var a=0;a<d.length;a++){var b=d[a];b.element.on({tap:function(){c.sectionIndex=d.indexOf(this);c.setSelectedSectionColour();c.setupArticles()},scope:b})}},setSelectedSectionColour:function(){var c=this.sectionsContainer.getItems().items;for(var a=0;a<c.length;a++){var b=c[a];b.element.dom.style.backgroundColor=""}if(c[this.sectionIndex]!=null){c[this.sectionIndex].element.dom.style.backgroundColor="#ADD8E6"}},loadShare:function(){var a=this;a.fireEvent("loadShare",a)},checkArchive:function(){var d=this;var b=d.editionOptionsSection.getComponent("menuArchive");if(settings.menu.hideArchive!=null){if(settings.menu.hideArchive){b.hide()}}else{if(settings.menu.archiveText!=null){var a=Ext.getStore("ArchiveStore");var c=[];if(a.data.items[0]!=null){if(a.data.items[0].raw.editions!=null&&a.data.items[0].raw.editions!=""){c=a.data.items[0].raw.editions.edition;if(c.length==0){b.hide()}}}}}},checkDownload:function(){var b=this;var a=b.editionOptionsSection.getComponent("menuDownload");if(settings.menu.hideDownload!=null){if(settings.menu.hideDownload){a.hide()}}},checkClipping:function(){var a=this;var b=a.editionOptionsSection.getComponent("menuCreateClipping");if(settings.menu.hideClipping!=null){b.hide()}},checkPrint:function(){var b=this;var a=b.editionOptionsSection.getComponent("menuPrint");if(settings.menu.hidePrint!=null){if(settings.menu.hidePrint){a.hide()}}else{if(currentProfile!="desktop"){if(settings.menu.disablePrintMobile=="true"||(Ext.os.is.Android&&Ext.browser.is.Firefox)){a.hide()}}}},checkBookmarks:function(){var b=this;var a=b.editionOptionsSection.getComponent("menuBookmarks");if(settings.menu.hideBookmarks!=null){a.hide()}},checkLogout:function(){var a=this;console.log(loggedIn);if(loggedIn.toLowerCase()!="true"){a.menuScroller.getComponent("menuUserContainer").hide();a.menuScroller.getComponent("menuUserOp").hide()}a.menuScroller.getComponent("menuUserContainer").getComponent("menuAccount").hide()},checkHowToUse:function(){var b=this;var a=b.menuInfoContainer.getComponent("menuHowToUse");if(settings.menu.hideHowToUse!=null){if(settings.menu.hideHowToUse){a.hide()}}},checkTerms:function(){var a=this;a.menuTerms=a.menuInfoContainer.getComponent("menuTerms");if(settings.menu.terms==null){a.menuTerms.hide()}},checkSearch:function(){var a=this;a.searchBtn=a.editionOptionsSection.getComponent("menuSearch");if(Ext.os.is.Desktop){a.searchBtn.hide()}else{if(settings.newsday!=null){if(settings.newsday.menuSearch=="false"){a.searchBtn.hide()}}else{a.searchBtn.hide()}}},checkPagesContainer:function(){var b=this;b.pagesBtn=b.editionOptionsSection.getComponent("menuPages");var a=true;if(settings.newsday!=null){a=false}if(a){if(Ext.os.is.Desktop){b.pagesBtn.hide()}}},checkArticlesContainer:function(){var c=this;c.articlesBtn=c.editionOptionsSection.getComponent("menuArticles");var a=false;if(Ext.os.is.Desktop){c.articlesBtn.hide();a=true}if(settings.newsday!=null){c.articlesBtn.hide();a=true}if(!a){if(settings.hideArticleBtn!=null){c.articlesBtn.hide()}else{var b=InfinityMobile.app.getController("ArticleController").getArticles();if(b==null||b.length==0){c.articlesBtn.hide()}}}},checkStoryWindowPrefs:function(){var b=this;b.menuStoryPref=b.menuInfoContainer.getComponent("menuStoryPref");var a=Ext.getStore("ArticleStore");if(settings.newsday==null||(a==null||a.data.items[0].raw.articles.length<=0)){b.menuStoryPref.hide()}},checkFaq:function(){var a=this;a.menuFaq=a.menuInfoContainer.getComponent("menuFaq");if(settings.menu.enableFaq==null||settings.menu.enableFaq=="false"){a.menuFaq.hide()}},checkSpecialArchive:function(){var a=this;a.specialArchive=a.editionOptionsSection.getComponent("menuSpecialArchive");if(typeof specialArchive==="undefined"||specialArchive==null||specialArchive.length==0){a.specialArchive.hide()}},checkPrivacyPolicy:function(){var a=this;a.menuPrivacy=a.menuInfoContainer.getComponent("menuPrivacy");if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.privacyPolicyUrl!=null){a.menuPrivacy.show()}else{a.menuPrivacy.hide()}},checkSupplementsTab:function(){var a=this;a.supplementsTab=a.editionOptionsSection.getComponent("menuSupplementsTab");if(currentProfile=="desktop"){a.supplementsTab.hide()}else{if(settings.menu.supplements==null||settings.menu.supplements.showSupplementsTab!="true"||settings.menu.supplements.supplement.length==0){a.supplementsTab.hide()}}},loadSupplements:function(){var a=this;a.fireEvent("loadSupplements",a,a.menuSupplementsContainer,a.menuSupplementsHeader)},loadZones:function(){var a=this;a.fireEvent("loadZones",a,a.menuZonesContainer,a.menuZonesHeader)},loadQuickLinks:function(){var a=this;a.fireEvent("loadQuickLinks",a,a.menuQuickLinksContainer,a.menuQuickLinksHeader)},setupMouseListener:function(){var b=this;if(currentProfile=="desktop"){b.scroller=b.menuScroller.getScrollable().getScroller();b.articleScroller=this.articlesContainer.getScrollable().getScroller();var a=function(g,d){var f=d.maxPosition;var j=d.minPosition;var c=d.position;var h=30;if(g=="up"){var e=c.y-h;if(e>j.y){d.scrollTo(0,e)}else{if(e<=j.y){d.scrollTo(0,j.y)}}}else{if(g=="down"){var e=c.y+h;if(e<f.y){d.scrollTo(0,e)}else{if(e>=f.y){d.scrollTo(0,f.y)}}}}};b.menuScroller.element.dom.onmousewheel=function(c){var d="down";if(c.deltaY<0||c.wheelDelta>0){d="up"}a(d,b.scroller)};b.menuScroller.element.dom.addEventListener("DOMMouseScroll",function(c){var d="down";if(c.detail<0){d="up"}a(d,b.scroller)});b.articlesContainer.element.dom.onmousewheel=function(c){var d="down";if(c.deltaY<0||c.wheelDelta>0){d="up"}a(d,b.articleScroller)};b.articlesContainer.element.dom.addEventListener("DOMMouseScroll",function(c){var d="down";if(c.detail<0){d="up"}a(d,b.articleScroller)})}},setupArticles:function(){var e=this;var f=this.sections[this.sectionIndex];if(f!=null){this.articlesContainer.removeAll();this.articlesContainer.show();for(var c=0;c<f.articles.length;c++){var d=f.articles[c];var a=articleDictionary[d.file];var b=Ext.create("InfinityMobile.view.ReaderMenuArticleItem",{articleMedia:d,articleObject:a,sectionName:f.name,menu:e});this.articlesContainer.add(b)}}else{this.articlesContainer.hide()}}},0,["readermenu"],["component","container","panel","overlay","readermenu"],{component:true,container:true,panel:true,overlay:true,readermenu:true},["widget.readermenu"],0,[InfinityMobile.view.tablet,"ReaderMenuFeedApp"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderMenuFeedApp",InfinityMobile.view.tablet.ReaderMenuFeedApp,{config:{itemId:"container",layout:"hbox",style:"background-color:#1e1e1e;padding:0; border-radius:0;height: 100% ;transition: top 1s;transform: translateX(100%); transition: 0.5s ease all; overflow: hidden;",right:0,top:0,baseCls:"menu",cls:"reader-menu",width:"calc(100% - 50px)",items:[{itemId:"articlesContainer",height:"calc(100% - 40px)",width:"100%",style:"position: absolute; transform: translateX(100%); transition: 0.5s ease all;",right:0,top:40,defaults:{width:"100%"},scrollable:{direction:"vertical",directionLock:true},layout:"vbox"},{itemId:"menuContentsContainer",height:"100%",width:"100%",layout:"vbox",items:[{itemId:"menuHeader",margin:0,height:40,padding:"10 15 10 15",style:"transition: 0.3s ease all;",items:[{itemId:"menuHeaderClose",cls:"pointerCursor",right:0,top:0,height:40,width:40,padding:10,style:'background-image: url("../assets/Menu/close-btn-white.png"); transition: 0.3s ease all;background-size: 50%; background-position: center; background-repeat: no-repeat;'}]},{itemId:"menuScroller",scrollable:{direction:"vertical",directionLock:true},height:"calc(100% - 40px)",layout:"vbox",items:[{id:"menuHome",cls:"menuItem menuHome",clickType:"id",xtype:"readermenuitem",text:"Home",height:50,padding:15},{id:"menuSections",cls:"menuSectionHeader menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",padding:"15 15",text:"SECTIONS",height:50},{itemId:"menuSectionsContainer",cls:"menuSectionContent menuSections",layout:"vbox",margin:0,defaults:{padding:15,height:50},style:"overflow:hidden;",minimized:false},{id:"menuEditionOptions",cls:"menuSectionHeader menuEditionOptions",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",padding:"15 15",text:"EDITION OPTIONS",height:50},{itemId:"editionOptionsSection",cls:"menuSectionContent menuEditionOptions",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15,height:50},minimized:false,items:[{id:"menuPages",cls:"menuItem menuPages",clickType:"id",xtype:"readermenuitem",text:"Pages"},{id:"menuArchive",cls:"menuItem menuArchive",clickType:"id",xtype:"readermenuitem",text:"Archive"},{id:"menuSpecialArchive",cls:"menuItem menuSpecialArchive",clickType:"id",xtype:"readermenuitem",text:"Special Archive"},{id:"menuNewsdayFunbook",cls:"menuItem menuFunbook",clickType:"id",xtype:"readermenuitem",text:"Fun Book",hidden:true},{id:"menuArticles",cls:"menuItem menuArticles",xtype:"readermenuitem",text:"Articles"},{id:"menuDownload",cls:"menuItem menuDownload",clickType:"id",xtype:"readermenuitem",text:"Download"},{id:"menuSearch",cls:"menuItem menuSearch",clickType:"id",xtype:"readermenuitem",text:"Search"},{id:"menuBookmarks",cls:"menuItem menuBookmarks",clickType:"id",xtype:"readermenuitem",text:"Bookmarks"},{id:"menuSupplementsTab",cls:"menuItem menuSupplementsTab",clickType:"id",xtype:"readermenuitem",text:"Supplements Tab"},{id:"menuCreateClipping",cls:"menuItem menuCreateClipping",clickType:"id",xtype:"readermenuitem",text:"Create Clipping"},{id:"menuPrint",cls:"menuItem menuPrint",clickType:"id",xtype:"readermenuitem",text:"Print"},{id:"menuSharing",cls:"menuItem menuSharing",xtype:"readermenushare",layout:"vbox"}]},{id:"menuSupplements",cls:"menuSectionHeader menuSupplements",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"SUPPLEMENTS",height:50},{itemId:"menuSupplementsContainer",cls:"menuSectionContent menuSupplements",layout:"vbox",margin:0,defaults:{padding:15,height:50},style:"overflow:hidden;",minimized:false},{id:"menuZones",cls:"menuSectionHeader menuZones",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"ZONES",height:50},{itemId:"menuZonesContainer",cls:"menuSectionContent menuZones",layout:"vbox",margin:0,defaults:{padding:15,height:50},style:"overflow:hidden;",minimized:false},{id:"menuQuickLinks",cls:"menuSectionHeader menuQuickLinks",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"QUICK LINKS",height:50},{itemId:"menuQuickLinksContainer",cls:"menuSectionContent menuQuickLinks",layout:"vbox",margin:0,defaults:{padding:15,height:50},style:"overflow:hidden;",minimized:false},{id:"menuInfo",cls:"menuSectionHeader menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",text:"INFO",height:50},{itemId:"menuInfoContainer",cls:"menuSectionContent menuInfo",layout:"vbox",margin:0,defaults:{padding:15,height:50},style:"overflow:hidden;",minimized:false,items:[{id:"menuHowToUse",xtype:"readermenuitem",cls:"menuItem menuHowToUse",clickType:"id",text:"How to use"},{id:"menuHelp",xtype:"readermenuitem",cls:"menuItem menuHelp",clickType:"id",text:"Contact Us"},{id:"menuTerms",cls:"menuItem menuTerms",clickType:"id",xtype:"readermenuitem",text:"Terms and Conditions"},{id:"menuFaq",cls:"menuItem menuFaq",clcikType:"id",xtype:"readermenuitem",text:"FAQ"},{id:"menuPrivacy",cls:"menuItem menuPrivacy",clickType:"id",xtype:"readermenuitem",text:"Privacy Policy"},{id:"menuStoryPref",cls:"menuItem menuStoryPref",clickType:"id",xtype:"readermenuitem",text:"Story Window Preferences"}]},{id:"menuUserOp",cls:"menuSectionHeader menuUserOp",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"15 15",height:50,text:"USER OPTIONS"},{itemId:"menuUserContainer",cls:"menuSectionContent menuUserOp",layout:"vbox",margin:0,defaults:{padding:15,height:50},style:"overflow:hidden;",minimized:false,items:[{id:"menuAccount",xtype:"readermenuitem",cls:"menuItem menuAccount",clickType:"id",text:"My Account"},{id:"menuUser",xtype:"readermenuitem",cls:"menuItem menuUser",clickType:"id",text:"Logout"}]}]}]}]},initializ},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){if(a.isArticlesOpen){a.closeArticles()}else{a.fireEvent("close")}})},setupVars:function(){InfinityMobile.view.tablet.ReaderMenuFeedApp.prototype.setupVars.apply(this,arguments);this.sectionIndex=-1},setupSectionTapEvents:function(){var c=this;var d=this.sectionsContainer.getItems().items;for(var a=0;a<d.length;a++){var b=d[a];b.element.on({tap:function(){c.sectionIndex=d.indexOf(this);c.setupArticles();c.openArticles()},scope:b})}},openArticles:function(){this.menuHeader.element.dom.style.backgroundColor="rgb(227, 227, 227)";this.menuHeaderClose.element.dom.style.backgroundImage="url(https://s3-eu-west-1.amazonaws.com/dev-ps-feed-edition-templates/82260c6a-360d-474d-bcea-b51a65ecf989/assets/arrow_right_black.png)";this.menuHeaderClose.element.dom.style.backgroundSize="25%";this.articlesContainer.element.dom.style.transform="translateX(0px)";this.isArticlesOpen=true},closeArticles:function(){this.menuHeader.element.dom.style.backgroundColor="";this.menuHeaderClose.element.dom.style.backgroundImage='url("../assets/Menu/close-btn-white.png")';this.menuHeaderClose.element.dom.style.backgroundSize="50%";this.articlesContainer.element.dom.style.transform="translateX(100%)";this.isArticlesOpen=false}},0,["readermenu"],["component","container","panel","overlay","readermenu"],{component:true,container:true,panel:true,overlay:true,readermenu:true},["widget.readermenu"],0,[InfinityMobile.view.phone,"ReaderMenuFeedApp"],0));(Ext.cmd.derive("InfinityMobile.view.TextSizeSlider",Ext.Container,{config:{height:"auto",width:650,layout:"vbox",style:"padding: 20px 30px; border-radius: 0 0 24px 24px; max-width: 100%; background-color: white; transition: 0.5s ease all; -webkit-box-shadow: 0 3px 4px rgba(0,0,0,.3);box-shadow: 0 3px 4px rgba(0,0,0,.3); transform: translate3d(0px, -100%, 0);",items:[{itemId:"textContainer",width:"100%",zIndex:9,layout:"vbox",style:"text-align: center; border-bottom: 1px solid #f0f0f0;",defaults:{margin:"10px 0px"},items:[{itemId:"title",html:"Text Size",style:"font-weight: bold; font-size: 0.9em;"},{itemId:"desc",html:"Change this scale to increase or decrease font size",style:"font-size: 0.7em; color: #9b9b9b;"}]},{itemId:"inputContainer",layout:"hbox",width:"100%",height:50,zIndex:9,margin:"10px 0px",style:"background-color: #000; padding: 15px 25px; border-radius: 13px;",items:[{itemId:"smallLetter",width:40,height:"100%",html:'<div style="height:50px; padding: 10px;">A</div>',style:"color:white; font-size: 1.1em; text-align: center;"},{itemId:"slider",flex:1,height:"100%"},{itemId:"bigLetter",width:40,height:"100%",html:'<div style="height:50px; padding: 10px;">A</div>',style:"color:white; font-size: 1.4em; text-align: center;"}]},{itemId:"closeContainer",width:"100%",zIndex:9,layout:"vbox",style:"text-align: center;border-top: 1px solid #f0f0f0;",defaults:{margin:"10px 0px"},items:[{itemId:"closeBtn",html:"Close",cls:"pointerCursor",style:"font-size: 0.7em; color: #9b9b9b;font-weight: bold; "}]},{itemId:"mask",height:"200vh",width:"200vw",top:-15,left:"-100vw",zIndex:8}]},initialize:function(){var a=this;a.setupVars();a.setupSlider();if(Ext.os.is.iOS){setTimeout(function(){a.colorSlidBar()},100)}else{a.on({painted:function(){a.colorSlidBar()},delay:10})}a.setupEvents()},setupVars:function(){var a=this;a.textSizeSlidValue=4;a.fontScale=1;if(a.config.closeFunc!=null){a.closeFunc=a.config.closeFunc}a.closeContainer=a.getComponent("closeContainer");a.closeBtn=a.closeContainer.getComponent("closeBtn");a.inputContainer=a.getComponent("inputContainer");a.sliderContainer=a.inputContainer.getComponent("slider");a.mask=a.getComponent("mask");a.mask.hide()},setupSlider:function(){var d=this;var c="<div class='ticks' style='height: 2px; display: flex; align-items: center; justify-content: center; flex-direction: row; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: calc(100% - 25px); pointer-events: none; z-index:9;'>";for(var b=0;b<10;b++){c+="<div class='tick' style='top:-1px; width: calc(100% / 10); height: 2px; border-radius: 50%; position: relative;'><span style='position: absolute; width: 2px; height: 2px; background-color: #FFFFFF;'></span></div>"}c+="</div>";var a='<input id="article-text-slider" class="slider text-size-slider" max="11" min="1" step="1" value="'+d.textSizeSlidValue+'" type="range" >';d.sliderContainer.setHtml(c+a);setTimeout(function(){d.slider=document.getElementById("article-text-slider");d.slider.addEventListener("touchstart",function(g){g.stopPropagation()});d.slider.addEventListener("touchmove",function(g){g.stopPropagation()});d.slider.addEventListener("touchend",function(g){g.stopPropagation()});try{var f=localStorage.getItem("fontslidervalue_"+publicationguid);if(f!=null){d.slider.value=f;d.onSliderInput(f)}}catch(e){console.error("[TextSizeSlider]: Error Caught \n",e)}d.colorSlidBar();d.slider.oninput=function(h){console.log(h);var g=parseInt(h.target.value);d.onSliderInput(g)}},200)},onSliderInpu},setupEvents:function(){var a=this;a.closeBtn.element.on("tap",function(){a.fireEvent("close",a);if(a.closeFunc!=null){a.closeFunc(a)}});a.mask.element.on("tap",function(){a.fireEvent("close",a)})},slideAway:function(){var a=this;a.element.dom.style.webkitTransform="translate3d(0%, -100%, 0)";a.element.dom.style.mozTransform="translate3d(0%, -100%, 0)";a.element.dom.style.transform="translate3d(0%, -100%, 0)";a.mask.hide()},slideIn:function(){var a=this;a.element.dom.style.webkitTransform="translate3d(0%, 0%, 0)";a.element.dom.style.mozTransform="translate3d(0%, 0%, 0)";a.element.dom.style.transform="translate3d(0%, 0%, 0)";a.mask.show()},colorSlidBar:function(){var d=this;try{var c=((d.textSizeSlidValue-1)/d.fontScale)*(100/10);var a="linear-gradient(to right, #FFFFFF "+c+"%,#002339 "+c+"%)";this.slider.style.background=a}catch(b){console.error("[TextSizeSlider]: Exception Caught \n",b)}},setTextSize:function(a){var c=this;var d=parseInt(a);stepChange=c.textSizeSlidValue<d?(d-c.textSizeSlidValue)*0.25:(c.textSizeSlidValue-d)*-0.25;c.textSizeSlidValue=d;try{if(!isNaN(c.textSizeSlidValue)){localStorage.setItem("fontslidervalue_"+publicationguid,c.textSizeSlidValue)}}catch(b){console.error("[TextSizeSlider]: Error Caught\n",b)}console.log(stepChange);c.fontSizeInPixel=d;c.fireEvent("textResize",stepChange)}},0,["textsizeslider"],["component","container","textsizeslider"],{component:true,container:true,textsizeslider:true},["widget.textsizeslider"],0,[InfinityMobile.view,"TextSizeSlider"],0));(Ext.cmd.derive("InfinityMobile.view.ShareSlider",Ext.Container,{config:{height:"auto",width:650,cls:"share-slider",layout:"vbox",style:"padding: 20px 30px; border-radius: 0 0 24px 24px; max-width: 100%; background-color: white; transition: 0.5s ease all; -webkit-box-shadow: 0 3px 4px rgba(0,0,0,.3);box-shadow: 0 3px 4px rgba(0,0,0,.3); transform: translate3d(0px, -100%, 0);",items:[{itemId:"textContainer",width:"100%",zIndex:9,layout:"vbox",style:"text-align: center; border-bottom: 1px solid #f0f0f0;",defaults:{margin:"10px 0px"},items:[{itemId:"title",html:"Share",style:"font-weight: bold; font-size: 0.9em;"}]},{itemId:"inputContainer",layout:{type:"hbox",align:"center",pack:"middle"},width:"100%",cls:"shareOptions",height:50,zIndex:9,margin:"10px 0px",style:"padding: 15px 25px;overflow-x: auto; -webkit-overflow-scroll: touch;",defaults:{margin:"0px 40px"},scrollable:{direction:"horizontal",directionLock:"true"},items:[]},{itemId:"closeContainer",width:"100%",zIndex:9,layout:"vbox",style:"text-align: center;border-top: 1px solid #f0f0f0;",defaults:{margin:"10px 0px"},items:[{itemId:"closeBtn",html:"Close",cls:"pointerCursor",style:"font-size: 0.7em; color: #9b9b9b;font-weight: bold; "}]},{itemId:"mask",height:"200vh",width:"200vw",top:-15,left:"-100vw",zIndex:8}]},initialize:function(){var a=this;a.setupVars();a.setupEvents();a.setupShareOptions()},setupVars:function(){var a=this;if(a.config.closeFunc!=null){a.closeFunc=a.config.closeFunc}a.closeContainer=a.getComponent("closeContainer");a.closeBtn=a.closeContainer.getComponent("closeBtn");a.inputContainer=a.getComponent("inputContainer");if(currentProfile=="phone"){a.inputContainer.setDefaults({margin:"0px 30px"})}a.mask=a.getComponent("mask");a.mask.hide()},setupEvents:function(){var a=this;a.closeBtn.element.on("tap",function(){a.fireEvent("close",a);if(a.closeFunc!=null){a.closeFunc(a)}});a.mask.element.on("tap",function(){a.fireEvent("close",a)})},slideAway:function(){var a=this;a.element.dom.style.webkitTransform="translate3d(0%, -100%, 0)";a.element.dom.style.mozTransform="translate3d(0%, -100%, 0)";a.element.dom.style.transform="translate3d(0%, -100%, 0)";a.mask.hide()},slideIn:function(){var a=this;a.element.dom.style.webkitTransform="translate3d(0%, 0%, 0)";a.element.dom.style.mozTransform="translate3d(0%, 0%, 0)";a.element.dom.style.transform="translate3d(0%, 0%, 0)";a.mask.show()},setupShareOptions:function(){var e=this;if(typeof settings!="undefined"){var b=settings.sharing;if(b!=null&&b.allSharing!=null){for(var a=0;a<b.allSharing.length;a++){var d=b.allSharing[a];if(b[d]!=null){var c=Ext.create("InfinityMobile.view.ShareSliderItem",{shareObj:b[d],type:d});e.inputContainer.add(c)}}}}}},0,["shareslider"],["component","container","shareslider"],{component:true,container:true,shareslider:true},["widget.shareslider"],0,[InfinityMobile.view,"ShareSlider"],0));(Ext.cmd.derive("InfinityMobile.view.PwaContentBrowser",Ext.Container,{config:{itemId:"bottomBarExpanded",height:450,width:"100%",style:"transition: 0.5s ease all; -webkit-transform: translate3d(0px, 100%, 0); -moz-transform: translate3d(0px, 100%, 0); transform: translate3d(0px, 100%, 0);",layout:{type:"vbox",align:"stretch",pack:"start"},items:[{itemId:"mask",height:"200vh",width:"200vw",top:"-100vh",left:"-100vw",zIndex:8,style:"background-color: rgba(0, 0, 0, 0.6); transition: 0.5s ease all;"},{itemId:"content",height:"100%",width:"100%",padding:10,style:"background-color: rgb(230, 230, 230); border-radius: 10px 10px 0px 0px; -webkit-box-shadow: 10px -8px 10px -10px rgba(0,0,0,.3), -10px -8px 10px -10px rgba(0,0,0,.3);box-shadow: 10px -8px 10px -10px rgba(0,0,0,.3), -10px -8px 10px -10px rgba(0,0,0,.3);",zIndex:9,layout:{type:"vbox",align:"stretch",pack:"start"},items:[{itemId:"header",height:55,zIndex:9,layout:{type:"hbox",align:"stretch",pack:"center"},defaults:{height:55},items:[{style:"line-height:55px; font-weight:bold",html:"Page Browser"},{itemId:"close",cls:"pointerCursor",style:"position:absolute;right:0; line-height:55px; padding: 0 20px",html:"Close"}]},{itemId:"section",cls:"content-browser-section-scroller",style:"border-top: 1px solid black; border-bottom: 1px solid black; white-space: nowrap;",scrollable:{direction:"horizontal",directionLock:true},height:40,zIndex:9},{itemId:"articles",flex:1,padding:"10px 0",style:"overflow: auto;white-space: nowrap;vertical-align:top;",zIndex:9}]}]},initialize:function(){var a=this;a.setupVars();a.setupEvents()},setupVars:function(){var a=this;a.contentArea=a.getComponent("content");a.mask=a.getComponent("mask");a.bottombarSections=a.contentArea.getComponent("section");a.bottombarArticles=a.contentArea.getComponent("articles");a.headerSpace=a.contentArea.getComponent("header");a.closeBtn=a.headerSpace.getComponent("close");if(currentProfile!="desktop"||(currentProfile=="desktop"&&navigator.maxTouchPoints)){a.bottombarArticles.element.dom.style.overflow="visible";a.usesSenchaScroller=true;a.bottombarArticles.setScrollable({direction:"horizontal",directionLock:true})}},setArticles:function(){var a=this;var b=Ext.getStore("ArticleStore");if(b!=null&&b.data!=null&&b.data.items[0]!=null&&b.data.items[0].raw!=null&&b.data.items[0].raw.popovers!=null){a.articles=b.data.items[0].raw.popovers}},setupArticles:function(){var b=this;for(var a=0;a<b.articles.length;a++){var d=b.articles[a];var c=Ext.create("Ext.Container",{cls:"pointerCursor",items:[{flex:1.33,style:{width:"100%",backgroundImage:'url("'+d.image+'")',backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"top",borderTopLeftRadius:"10px",borderTopRightRadius:"10px"}},{itemId:"pageNoHtml",html:language.page+" "+d.articleNumber,style:"height:40px; line-height:40px; width:100%; padding:10px"},{flex:1,style:"padding:10px; font-size:1.1em; font-weight:bold; overflow:hidden;position:relative; width:100%",html:"<div style='position:absolute; top:10px; bottom:10px; left:10px; right: 10px; height:100%; column-count:1; column-gap:0; orphans:1; widows: 1; overflow:hidden'>"+d.headline+"</div>"}],height:305,width:200,style:"font-size: 16px; display: inline-block; white-space: normal; margin-right:10px; background-color:white; border-radius:10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 3px 4px",layout:{type:"vbox",align:"center",pack:"start"}});c.articleNumber=d.articleNumber;c.element.articleIndex=a;c.setSelected=function(){var e=this.getComponent("pageNoHtml");if(e!=null){e.setHtml("<b>"+language.page+" "+this.articleNumber+"</b>")}};c.resetSelected=function(){var e=this.getComponent("pageNoHtml");if(e!=null){e.setHtml(language.page+" "+this.articleNumber)}};c.element.on({tap:function(){b.parent.articleCarousel.jumpToPage(this.articleIndex);b.updateSelectedArticle(this.articleIndex)}});b.bottombarArticles.add(c)}},setupSections:function(){var c=this;for(var b=0;b<settings.bookmarks.bookmark.length;b++){var a=settings.bookmarks.bookmark[b];var d=Ext.create("Ext.Container",{cls:"pointerCursor",section:a,style:"display:inline-block; margin-right:30px;line-height:38px",html:a.name});d.setSelected=function(){this.setHtml("<b>"+this.config.section.name+"</b>")};d.resetSelecte};d.element.sectionIndex=b;d.element.on({tap:function(){c.jumpToSection(c.parent.articleCarousel,settings.bookmarks.bookmark[this.sectionIndex],true)}});c.bottombarSections.add(d)}},scrollToArticle:function(d){var e=this;var b=210;var c=(d)*b;if(e.usesSenchaScroller){e.bottombarArticles.getScrollable().getScroller().scrollTo(c,0)}else{var a=e.bottombarArticles.element.dom;a.scroll(c,0)}},setActiveSection:function(a){var h=this;var j=h.articles[a];var k=h.bottombarSections.items.items;for(var e=0;e<k.length;e++){var c=k[e];c.resetSelected()}var d;for(var e=0;e<settings.bookmarks.bookmark.length;e++){var b=settings.bookmarks.bookmark[e];if(parseInt(b.pageNumber)<=j.parentpage){d=e}}var l=k[d];l.setSelected();var f=l.element.dom.offsetLeft;var g=h.bottombarSections.getScrollable().getScroller();g.scrollTo(Math.min(f,g.maxPosition.x),0)},setActiveArticle:function(a){var e=this;var f=e.bottombarArticles.getItems();if(f!=null){var b=f.items;if(b!=null){for(var d=0;d<b.length;d++){var c=b[d];c.resetSelected()}var g=b[a];g.setSelected()}}},jumpToSection:function(j,h,g){var f=this;var b=parseInt(h.pageNumber);var c=-1;for(var e=0;e<f.articles.length;e++){var d=f.articles[e];var a=d.parentpage;if(a>=b){c=e;break}}if(c!=-1){j.jumpToPage(c);if(g){f.updateSelectedArticle(c)}}},updateSelectedArticle:function(a){var b=this;b.scrollToArticle(a);b.setActiveSection(a);b.setActiveArticle(a)},setupEvents:function(){var a=this;a.closeBtn.element.on({tap:function(){a.fireEvent("close")},scope:a});a.mask.element.on({tap:function(){a.fireEvent("close")},scope:a})},slideAway:function(){var a=this;a.element.dom.style.webkitTransform="translate3d(0%, 100%, 0)";a.element.dom.style.mozTransform="translate3d(0%, 100%, 0)";a.element.dom.style.transform="translate3d(0%, 100%, 0)";a.mask.element.dom.style.backgroundColor="transparent";setTimeout(function(){a.mask.hide()},500)},slideIn:function(){var a=this;a.element.dom.style.webkitTransform="translate3d(0%, 0%, 0)";a.element.dom.style.mozTransform="translate3d(0%, 0%, 0)";a.element.dom.style.transform="translate3d(0%, 0%, 0)";a.mask.show();a.mask.element.dom.style.backgroundColor="rgba(0, 0, 0, 0.6)"}},0,["pwacontentbrowser"],["component","container","pwacontentbrowser"],{component:true,container:true,pwacontentbrowser:true},["widget.pwacontentbrowser"],0,[InfinityMobile.view,"PwaContentBrowser"],0));(Ext.cmd.derive("InfinityMobile.view.FullscreenArticlePopover",Ext.Container,{config:{height:"100%",width:"100%",zIndex:"999999",layout:{type:"vbox"},items:[{itemId:"topBar",width:"100%",height:55,padding:"10px",top:0,style:"background-color:rgb(230, 230, 230);    border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;   -webkit-box-shadow: 0 3px 4px rgba(0,0,0,.3);box-shadow: 0 3px 4px rgba(0,0,0,.3);",zIndex:20,layout:"hbox",defaults:{cls:"pointerCursor"},items:[{itemId:"backBtn",docked:"left"},{itemId:"printBtn",docked:"right"},{itemId:"bookmarkBtn",docked:"right"},{itemId:"shareBtn",docked:"right"},{itemId:"textSizeBtn",docked:"right"}]},{itemId:"logo",cls:"fullscreen-article-logo",top:0,height:32,width:240,left:"50%",margin:"10px 0px",style:"-webkit-transform: translate3d(-50%, 0px, 0); -moz-transform: translate3d(-50%, 0px, 0); transform: translate3d(-50%, 0px, 0)",zIndex:21},{itemId:"textSlider",xtype:"textsizeslider",right:0,top:45,zIndex:19},{itemId:"shareSlider",xtype:"shareslider",right:0,top:45,zIndex:19},{itemId:"content",width:"100%",flex:1,padding:"55px 0px",style:"background-color: white;"},{bottom:0,padding:10,height:55,itemId:"bottomBar",width:"100%",style:"background-color: rgb(230, 230, 230); border-top-left-radius: 10px; border-top-right-radius: 10px; -webkit-box-shadow: 10px -8px 10px -10px rgba(0,0,0,.3), -10px -8px 10px -10px rgba(0,0,0,.3);box-shadow: 10px -8px 10px -10px rgba(0,0,0,.3), -10px -8px 10px -10px rgba(0,0,0,.3);",layout:{type:"hbox",align:"center",pack:"middle"},defaults:{cls:"pointerCursor"},items:[{itemId:"prevBtn",layout:"hbox",docked:"left",height:"100%"},{itemId:"articleText",html:"Article X / Y"},{itemId:"nextBtn",layout:"hbox",docked:"right",height:"100%"}]},{xtype:"pwacontentbrowser",itemId:"pwacontentbrowser",bottom:0,zIndex:22}]},isBottomBarExpanded:false,articles:[],initialize:function(){var a=this;a.setupVars();a.setArticles();a.setupArticlesCarousel();a.setupTopbar();a.setupBottombar();a.setupKeyListeners();a.setupListeners()},setupVars:function(){var a=this;a.iconHeight=currentProfile=="phone"?25:30;a.iconWidth=currentProfile=="phone"?25:30;a.textSliderHidden=true;a.shareSliderHidden=true;a.contentBrowserHidden=true;a.topbar=a.getComponent("topBar");a.bottombar=a.getComponent("bottomBar");a.contentContainer=a.getComponent("content");a.textSlider=a.getComponent("textSlider");a.shareSlider=a.getComponent("shareSlider");a.topBarIconContainer=a.topbar.getComponent("backBtn");a.brandLogo=a.getComponent("logo");a.topbarBookmarkContainer=a.topbar.getComponent("bookmarkBtn");a.topbarPrintContainer=a.topbar.getComponent("printBtn");if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hidePrint=="true"){a.topbarPrintContainer.hide()}if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hideBookmarks=="true"){a.topbarBookmarkContainer.hide()}if(currentProfile=="phone"){a.topbarPrintContainer.hide()}a.topbarShareContainer=a.topbar.getComponent("shareBtn");if(typeof settings=="undefined"||settings.sharing==null||settings.sharing.allSharing==null||settings.sharing.allSharing.length==0||settings.menu.hideSharing=="true"){a.sharingDisabled=true;a.topbarShareContainer.hide()}a.topbarTextSizeContainer=a.topbar.getComponent("textSizeBtn");a.previousArticleButton=a.bottombar.getComponent("prevBtn");a.nextArticleButton=a.bottombar.getComponent("nextBtn");a.articleText=a.bottombar.getComponent("articleText");a.contentBrowser=a.getComponent("pwacontentbrowser");mainPanel.fireEvent("loadBookmarks")},setupTopbar:function(){var a=this;a.setupTopbarButton("editionAppClose",settings.topbar.feedEditionLogo,a.iconHeight,a.iconWidth,a.topBarIconContainer);a.setupTopbarButton("articleViewPrint",settings.topbar.printicon,a.iconHeight,a.iconWidth,a.topbarPrintContainer);a.setupTopbarButton("articleViewShare",settings.topbar.shareicon,a.iconHeight,a.iconWidth,a.topbarShareContainer);a.setupTopbarButton("articleViewTextSize",settings.topbar.textsizeicon,a.iconHeight,a.iconWidth,a.topbarTextSizeContainer);if(a.brandLogo!=null&&typeof settings!="undefined"&&settings.topbar.logo!=null&&settings.topbar.logo.trim()!=""){a.brandLogo.setStyle({backgroundImage:'url("'+settings.topbar.logo+'")',backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",padding:"5px 0px"})}},setupTopbarButton:function(h,c,a,b,e){var d=currentProfile=="phone"?"14px 4px":"10px";var g={itemId:h,setting:h,event:h,iconUrl:c,height:a,width:b,style:"margin:"+d+";",iconHeight:a,iconWidth:b,cls:"article-control-button"};var f=Ext.create("InfinityMobile.view.desktop.LayoutToolBarIconView",g);e.add(f)},setupBottombar:function(){var a=this;a.setupBottombarButton("articleViewPrev",settings.topbar.previousicon,"Prev",false,24,24,a.previousArticleButton);a.setupBottombarButton("articleViewNext",settings.topbar.nexticon,"Next",true,24,24,a.nextArticleButton);a.setupBottomBarArticles();a.bottombar.element.on({tap:function(b){a.bottomBarTap()},scope:a});a.nextArticleButton.element.on({tap:function(b){a.articleCarousel.next();b.stopPropagation()},scope:a});a.previousArticleButton.element.on({ta},scope:a})},setupBottomBarArticles:function(){var c=this;c.contentBrowser.setArticles();c.contentBrowser.setupArticles();c.contentBrowser.setupSections();try{var d="contentBrowser_"+publicationguid;var b=localStorage.getItem(d);if(b!="true"){c.contentBrowser.slideIn();c.contentBrowserHidden=false;localStorage.setItem(d,"true")}else{c.contentBrowser.slideAway();c.contentBrowserHidden=true}}catch(a){console.warn("[FullscreenArticlePopover]: Error Accessing localStorage\n",a);c.contentBrowser.slideIn();c.contentBrowserHidden=false}setTimeou},200)},bottomBarTap:function(){var a=this;a.contentBrowser.slideIn();a.contentBrowser.updateSelectedArticle(a.articleCarousel.getPageNumber());a.contentBrowserHidden=false},closeBottomBarExpanded:function(){var a=this;console.log("CLOSE BUTTON TAPPED");a.bottombarBasic.setHidden(false);a.bottombarExpanded.setHidden(true);a.isBottomBarExpanded=false},setupBottombarButton:function(c,a,h,b,j,d,k){var g={itemId:c,setting:c,event:c,iconUrl:a,height:j,width:d,margin:"16 5",iconHeight:j,iconWidth:d};var f=currentProfile=="phone"?"15px 0px":"20px 0px";var e=Ext.create("InfinityMobile.view.desktop.LayoutToolBarIconView",g);var h=Ext.create("Ext.Container",{items:[{html:"<div>"+h+"</div>"}],height:"100%",style:"font-size: 16px;position:relative; top: 50%; -webkit-transform: translate3d(0px, -50%, 0); -moz-transform: translate3d(0px, -50%, 0);transform: translate3d(0px, -50%, 0);",layout:{type:"vbox",align:"center",pack:"middle"}});k.setHeight("100%");k.add(e);if(b){k.insert(0,h)}else{k.add(h)}},setArticles:function(){var a=this;var b=Ext.getStore("ArticleStore");if(b!=null&&b.data!=null&&b.data.items[0]!=null&&b.data.items[0].raw!=null&&b.data.items[0].raw.popovers!=null){a.articles=b.data.items[0].raw.popovers}},setupArticlesCarousel:function(){var l=this;var h=Ext.getStore("ArticleStore");l.deleteArticleFontCookie();var n=0;var m=parseInt(startpageNumber,10)||-1;if(m>0){n=Math.min(m,l.articles.length)-1}for(var j=0;j<l.articles.length;j++){var d=l.articles[j];d.index=j;d.articleNumber=j+1;if(typeof artGuid!="undefined"&&d.id==artGuid){n=j}}if(typeof startAtSection!="undefined"&&startAtSection!=""){var c=decodeURIComponent(startAtSection.replace(/\s/g,"").toLowerCase());var o=settings.bookmarks.bookmark;for(var j=0;j<o.length;j++){var b=o[j];var e=b.name.replace(/\s/g,"").toLowerCase();if(l.checkSectionsMatch(e,c)===true){var g=l.returnSectionPage(b);n=g!=null?g:n;break}}}l.hideOrShowArticleNavigation(n);h.data.items[0].raw.popovers=l.articles;l.articleCarousel=Ext.create("InfinityMobile.view.ArticleCarousel",{width:"100%",height:"100%",pageNumber:n,data:l.articles,pageTemplate:function(r,s,p){var q=Ext.create("InfinityMobile.view.FullscreenArticlePopoverItem",{articleItem:r,pageNo:s,popoverContainer:l});return q}});l.articleCarousel.getActiveItem().trackOnWrite=true;l.contentContainer.add(l.articleCarousel);var a="Article";if(language.article!=null){a=language.article}l.articleText.setHtml(a+" "+(l.articleCarousel.getPageNumber()+1)+" / "+l.articles.length);var f=l.articleCarousel.getActiveItem();l.fireEvent("checkArticleBookmark",f.articleItem,l);try{l.trackPageChange(f)}catch(k){console.error("[FullscreenArticlePopover]: Error Caught\n",k)}l.hideShowArticleControls(n);l.articleCarousel.on("activeitemchange",function(){l.deleteArticleFontCookie();var s=l.articleCarousel.getActiveItem();var p=l.articleCarousel.getItems().items;if(p!=null){for(var q=0;q<p.length;q++){var r=p[q];s.element.dom.className=s.element.dom.className.replace("active-article","")}}if(s!=null){s.element.dom.className+=" active-article";if(!s.hasSetupContent){s.writeIframeContent();window.focus()}l.deleteArticleFontCookie();l.hideShowArticleControls(l.articleCarousel.getPageNumber());l.hideOrShowArticleNavigation(l.articleCarousel.getPageNumber());l.fireEvent("checkArticleBookmark",s.articleItem,l);l.trackPageChange(s)}})},returnSectionPage:function(f){var e=this;var d=parseInt(f.pageNumber);var b=-1;for(var c=0;c<e.articles.length;c++){var g=e.articles[c];var a=g.parentpage;if(a>=d){b=c;break}}if(b!=-1){return b}else{return null}},checkSectionsMatch:function(b,c){var a=false;if(b==c){a=true}else{if(b.replace("&","and")==c){a=true}else{if(b.replace("&","+")==c){a=true}else{if(b.replace("+","and")==c){a=true}else{if(b.replace("+","&")==c){a=true}else{if(c.replace("&","and")==b){a=true}else{if(c.replace("+","and")==b){a=true}}}}}}}return a},trackPageChange:function(a){var b=this;console.log(a);if(a.data!=null){var c={pageNum:a.config.articleItem.parentpage,pageName:a.config.articleItem.headline,description:a.config.articleItem.headline,author:a.data.author,type:"Swipe Article",articleGuid:a.config.articleItem.id,headline:a.config.articleItem.headline,articleNumber:a.config.articleItem.articleNumber-1};if(typeof trackReaderEvent==="function"){trackReaderEvent("article",c)}}else{a.trackOnWrite=true}},hideShowArticleControls:function(a){var b=this;if(a==0){b.topbarTextSizeContainer.hide();b.topbarShareContainer.hide()}else{b.topbarTextSizeContainer.show();if(!b.sharingDisabled){b.topbarShareContainer.show()}}},deleteArticleFontCookie:function(){var a=this;document.cookie="articlefontstep=delete; expires=Wed, 1 Jan 2019 12:00:00 UTC; SameSite=None; Secure"},hideOrShowArticleNavigation:function(a){var c=this;var d=Ext.getStore("ArticleStore");if(d!=null&&d.data!=null&&d.data.items[0]!=null&&d.data.items[0].raw!=null&&d.data.items[0].raw.popovers!=null){var b=d.data.items[0].raw.popovers;if(a==0){c.hideOrShowButton(c.previousArticleButton,true);c.hideOrShowButton(c.nextArticleButton,false)}else{if(a==b.length-1){c.hideOrShowButton(c.previousArticleButton,false);c.hideOrShowButton(c.nextArticleButton,true)}else{c.hideOrShowButton(c.previousArticleButton,false);c.hideOrShowButton(c.nextArticleButton,false)}}}},hideOrShowButton:function(b,a){if(a){b.element.dom.style.visibility="hidden"}else{b.element.dom.style.visibility="visible"}},getTextSliderSize:function(){return(this.textSlider.textSizeSlidValue-4)*0.25},setupKeyListeners:function(){var a=this;window.onkeydown=null;window.onkeydown=function(b){if(a.articleCarousel!=null){switch(b.keyCode){case 37:a.articleCarousel.previous();break;case 39:a.articleCarousel.next();break}}}},setupListeners:function(){var a=this;a.textSlider.on({close:function(){this.hideTextSlider()},textResize:function(e){var b=this.articleCarousel.getItems().items;console.log(b);for(var c=0;c<b.length;c++){var d=b[c];console.log(d);if(d!=null){d.setTextSize(e)}}},scope:a});a.shareSlider.on({close:function(){this.hideShareSlider()},scope:a});a.contentBrowser.on({close:function(){this.hideContentBrowser()},scope:a})},toggleTextSlider:function(){var a=this;a.hideShareSlider();if(a.textSliderHidden){a.showTextSlider()}else{a.hideTextSlider()}},hideTextSlider:function(){var a=this;a.textSlider.slideAway();a.topbarTextSizeContainer.removeAll();a.setupTopbarButton("articleViewTextSize",settings.topbar.textsizeicon,a.iconHeight,a.iconWidth,a.topbarTextSizeContainer);a.textSliderHidden=true},showTextSlider:function(){var a=this;a.textSlider.slideIn();a.topbarTextSizeContainer.removeAll();a.setupTopbarButton("articleViewTextSize",settings.topbar.textsizeiconselected,a.iconHeight,a.iconWidth,a.topbarTextSizeContainer);a.textSliderHidden=false},toggleShareSlider:function(){var a=this;a.hideTextSlider();if(a.shareSliderHidden){a.showShareSlider()}else{a.hideShareSlider()}},hideShareSlider:function(){var a=this;a.shareSlider.slideAway();a.topbarShareContainer.removeAll();a.setupTopbarButton("articleViewShare",settings.topbar.shareicon,a.iconHeight,a.iconWidth,a.topbarShareContainer);a.shareSliderHidden=true},showShareSlider:function(){var a=this;a.shareSlider.slideIn();a.topbarShareContainer.removeAll();a.setupTopbarButton("articleViewShare",settings.topbar.shareiconselected,a.iconHeight,a.iconWidth,a.topbarShareContainer);a.shareSliderHidden=false},updateBookmark:function(a){var c=this;var b=a?settings.topbar.bookmarkfilled:settings.topbar.bookmarksicon;if(c.isBookmarked!=a){c.isBookmarked=a;c.topbarBookmarkContainer.removeAll(true);c.setupTopbarButton("articleViewBookmark",b,c.iconHeight,c.iconWidth,c.topbarBookmarkContainer)}},hideContentBrowser:function(){var a=this;a.contentBrowser.slideAway();a.contentBrowserHidden=true}},0,["articleview"],["component","container","articleview"],{component:true,container:true,articleview:true},["widget.articleview"],0,[InfinityMobile.view,"FullscreenArticlePopover"],0));(Ext.cmd.derive("InfinityMobile.view.phone.FullscreenArticlePopover",InfinityMobile.view.FullscreenArticlePopover,{config:{height:"100%",width:"100%",zIndex:"999999",layout:{type:"vbox"},items:[{itemId:"topBar",width:"100%",height:55,padding:"10px",top:0,style:"background-color:rgb(230, 230, 230);    border-bottom-left-radius: 30px 20px; border-bottom-right-radius: 30px 20px;   -webkit-box-shadow: 0 3px 4px rgba(0,0,0,.3);box-shadow: 0 3px 4px rgba(0,0,0,.3);",zIndex:20,layout:"hbox",defaults:{cls:"pointerCursor"},items:[{itemId:"backBtn",docked:"left"},{itemId:"printBtn",docked:"right"},{itemId:"bookmarkBtn",docked:"right"},{itemId:"shareBtn",docked:"right"},{itemId:"textSizeBtn",docked:"right"}]},{itemId:"logo",cls:"fullscreen-article-logo",top:0,left:"50%",margin:"14px 0px",style:"-webkit-transform: translate3d(-50%, 0px, 0); -moz-transform: translate3d(-50%, 0px, 0); transform: translate3d(-50%, 0px, 0); height: 24px; width:150px;",zIndex:21},{itemId:"textSlider",xtype:"textsizeslider",right:0,top:50,zIndex:19},{itemId:"shareSlider",xtype:"shareslider",right:0,top:50,zIndex:19},{itemId:"content",width:"100%",flex:1,padding:"55px 0px",style:"background-color: white;"},{bottom:0,padding:10,itemId:"bottomBar",width:"100%",height:55,style:"background-color: rgb(230, 230, 230); border-top-left-radius: 30px 20px; border-top-right-radius: 30px 20px; -webkit-box-shadow: 10px -8px 10px -10px rgba(0,0,0,.3), -10px -8px 10px -10px rgba(0,0,0,.3);box-shadow: 10px -8px 10px -10px rgba(0,0,0,.3), -10px -8px 10px -10px rgba(0,0,0,.3);",layout:{type:"hbox",align:"center",pack:"middle"},defaults:{cls:"pointerCursor"},items:[{itemId:"prevBtn",layout:"hbox",docked:"left"},{itemId:"articleText",html:"Article X / Y"},{itemId:"nextBtn",layout:"hbox",docked:"right"}]},{xtype:"pwacontentbrowser",itemId:"pwacontentbrowser",bottom:0,zIndex:22}]},initialize:function(){var a=this;InfinityMobile.view.FullscreenArticlePopover.prototype.initialize.apply(this,arguments)}},0,["articleviewphone"],["component","container","articleview","articleviewphone"],{component:true,container:true,articleview:true,articleviewphone:true},["widget.articleviewphone"],0,[InfinityMobile.view.phone,"FullscreenArticlePopover"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPuzzlesPopup",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);a.setupVars();a.setupLanguage();a.setupPopupBodyContent()},setupVars:function(){var a=this;a.puzzlesPopupToolbar=a.getComponent("puzzlesPopupToolbar");a.puzzlesPopupBody=a.getComponent("puzzlesPopupBody");a.iframeUrlForPuzzles=InfinityMobile.controller.ReaderPuzzlesController.SETTING.menu.iframeUrlForPuzzles||null},hasPuzzlesPopupToolbar:function(){var a=this;return a.puzzlesPopupToolbar!=null},hasPuzzlesPopupBody:function(){var a=this;return a.puzzlesPopupBody!=null},hasIframeUrlForPuzzles:function(){var a=this;return !!a.iframeUrlForPuzzles},setupLanguage:function(){var a=this;if(a.hasPuzzlesPopupToolbar()){a.puzzlesPopupToolbar.setText(InfinityMobile.controller.ReaderPuzzlesController.LANGUAGE.puzzles)}},setupPopupBodyConten},setupIframe:function(){var b=this;if(b.hasPuzzlesPopupBody()&&b.hasIframeUrlForPuzzles()){b.showLoadingSpinner();var a=document.createElement("iframe");a.setAttribute("style","position: absolute;");a.setAttribute("width","100%");a.setAttribute("height","100%");a.setAttribute("scrolling","auto");a.setAttribute("frameborder","0");a.onload=function(){b.hideLoadingSpinner()};a.setAttribute("src",b.iframeUrlForPuzzles);b.puzzlesPopupBody.setHtml(a)}},showLoadingSpinner:function(){var a=this;if(a.hasPuzzlesPopupBody()){a.puzzlesPopupBody.addCls("loading")}},hideLoadingSpinner:function(){var a=this;if(a.hasPuzzlesPopupBody()){a.puzzlesPopupBody.removeCls("loading")}}},0,["puzzlespopupparent"],["component","container","panel","overlay","puzzlespopupparent"],{component:true,container:true,panel:true,overlay:true,puzzlespopupparent:true},["widget.puzzlespopupparent"],0,[InfinityMobile.view,"ReaderPuzzlesPopup"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderPuzzlesPopup",InfinityMobile.view.ReaderPuzzlesPopup,{config:{width:"100%",height:"100%",style:"padding:0px;",zIndex:1000002,layout:"vbox",items:[{id:"puzzlesPopupToolbar",xtype:"readeroverlaytitle",titleTxt:"Puzzles",parentOverlay:this,destoryOnClose:true,rounded:false},{itemId:"puzzlesPopupBody",cls:"overlaybody",flex:1,padding:0,layout:"vbox"}]},initialize:function(){var a=this;a.setSquareCorners(true);InfinityMobile.view.ReaderPuzzlesPopup.prototype.initialize.apply(this,arguments);console.log("Puzzles: Tablet")}},0,["puzzlespopup"],["component","container","panel","overlay","puzzlespopupparent","puzzlespopup"],{component:true,container:true,panel:true,overlay:true,puzzlespopupparent:true,puzzlespopup:true},["widget.puzzlespopup"],0,[InfinityMobile.view.tablet,"ReaderPuzzlesPopup"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderPuzzlesPopup",InfinityMobile.view.ReaderPuzzlesPopup,{config:{width:"100%",height:"100%",style:"padding:0px;",zIndex:1000002,layout:"vbox",items:[{id:"puzzlesPopupToolbar",xtype:"readeroverlaytitle",titleTxt:"Puzzles",parentOverlay:this,destoryOnClose:true,rounded:false},{itemId:"puzzlesPopupBody",cls:"overlaybody",flex:1,padding:0,layout:"vbox"}]},initialize:function(){var a=this;a.setSquareCorners(true);InfinityMobile.view.ReaderPuzzlesPopup.prototype.initialize.apply(this,arguments)}},0,["puzzlespopup"],["component","container","panel","overlay","puzzlespopupparent","puzzlespopup"],{component:true,container:true,panel:true,overlay:true,puzzlespopupparent:true,puzzlespopup:true},["widget.puzzlespopup"],0,[InfinityMobile.view.phone,"ReaderPuzzlesPopup"],0));(Ext.cmd.derive("InfinityMobile.profile.phone",Ext.app.Profile,{config:{name:"phone",views:["ReaderSpecialSupplements","ReaderPopoverMenu","StoryWindowPreferences","DataCaptureForm","ArticleReaderItemWeatherTile","ArticleReaderBannerAd","ArticleReaderItemTopStoryItem","ArticleReaderItemPhone","ArticleReaderItemTopStories","ArticleReaderItemContainer","ArticleReaderPanelContainer","ClippingOptionsMenu","ClippingArea","clippingPrompt","ClippingOptions","ArticleSectionItem","ArticleSectionItemImg","ArticlesSectionContainer","ArticlesContainer","SplashScreen","ReaderHelper","ReaderMenu","ReaderMenuSection","ReaderArchive","ReaderSearch","ReaderDownload","ReaderArticlePopover","ReaderWhatsNew","Interstitial","ArticlePopoverAd","ArticlePopoverInterstitial","ReaderSharePopup","ReaderSharePopupItem","ReaderBannerAd","ReaderBookmark","readerTerms","SectionListOverlay","ZonesOverlay","ReaderPuzzlePopoverItem","ArchiveSelector","ReaderSpecialArchive","ReaderPrint","ReaderWebpopover","ReaderMenuFeedApp","FullscreenArticlePopover","ReaderPuzzlesPopup"]},viewport:{autoMaximize:true},isActive:function(){var b=Ext.os.is.Phone;var c=navigator.userAgent;var d=/Kindle/i.test(c)||/Silk/i.test(c)||/KFTT/i.test(c)||/KFOT/i.test(c)||/KFJWA/i.test(c)||/KFJWI/i.test(c)||/KFSOWI/i.test(c)||/KFTHWA/i.test(c)||/KFTHWI/i.test(c)||/KFAPWA/i.test(c)||/KFAPWI/i.test(c);if(d){b=true}if(Ext.os.is.Android){if(navigator.userAgent.search(/mobile/i)==-1){var a=Math.min(screen.height,screen.width);if(a>720){b=false}else{b=true}}}if(navigator.userAgent.toLowerCase().indexOf("ipad")!=-1){b=false}return b}},0,0,0,0,0,0,[InfinityMobile.profile,"phone"],0));(Ext.cmd.derive("InfinityMobile.profile.largetablet",Ext.app.Profile,{config:{name:"largetablet"},isActive:function(){var b=false;if(Ext.os.is.Tablet||this.isIpadPro()){var a=Math.min(screen.height,screen.width);if(a>800){b=true}}return b},isIpadPro:function(){if(window.screen.width>834&&window.screen.width<=1024&&navigator.userAgent.toLowerCase().indexOf("macintosh")!=-1&&this.is_touch_device()&&!Ext.os.is.Phone){Ext.os.is.iOS=true;Ext.os.is.Desktop=false;return true}return false},is_touch_device:function(){return"ontouchstart" in window}},0,0,0,0,0,0,[InfinityMobile.profile,"largetablet"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderMenu",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px);transition: top 1s",right:0,top:40,baseCls:"menu",cls:"reader-menu",items:[{itemId:"menuLayout",cls:"mainMenu",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",scrollable:{direction:"vertical",directionLock:true},items:[{itemId:"menuHeader",html:"Menu",margin:0,height:40,style:"background-color:#2c2f32; color:#ffffff",padding:"10 15 10 15",items:[{itemId:"menuHeaderClose",cls:"pointerCursor",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{id:"menuEditionOptions",cls:"menuSectionHeader menuEditionOptions",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",padding:"10 15 10 15",text:"EDITION OPTIONS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/minimise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"editionOptionsSection",cls:"menuSectionContent menuEditionOptions",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15},minimized:false,items:[{id:"menuPages",cls:"menuItem menuPages",clickType:"id",xtype:"readermenuitem",text:"Pages"},{id:"menuArchive",cls:"menuItem menuArchive",clickType:"id",xtype:"readermenuitem",text:"Archive"},{id:"menuSpecialArchive",cls:"menuItem menuSpecialArchive",clickType:"id",xtype:"readermenuitem",text:"Special Archive"},{id:"menuNewsdayFunbook",cls:"menuItem menuFunbook",clickType:"id",xtype:"readermenuitem",text:"Fun Book",hidden:true},{id:"menuArticles",cls:"menuItem menuArticles",xtype:"readermenuitem",text:"Articles"},{id:"menuDynamicArticles",cls:"menuItem menuDynamicArticles",clickType:"id",xtype:"readermenuitem",text:"Advanced"},{id:"menuDownload",cls:"menuItem menuDownload",clickType:"id",xtype:"readermenuitem",text:"Download"},{id:"menuSearch",cls:"menuItem menuSearch",clickType:"id",xtype:"readermenuitem",text:"Search"},{id:"menuBookmarks",cls:"menuItem menuBookmarks",clickType:"id",xtype:"readermenuitem",text:"Bookmarks"},{id:"menuSupplementsTab",cls:"menuItem menuSupplementsTab",clickType:"id",xtype:"readermenuitem",text:"Supplements Tab"},{id:"menuCreateClipping",cls:"menuItem menuCreateClipping",clickType:"id",xtype:"readermenuitem",text:"Create Clipping"},{id:"menuPrint",cls:"menuItem menuPrint",clickType:"id",xtype:"readermenuitem",text:"Print"},{id:"menuPuzzles",cls:"menuItem",clickType:"id",xtype:"readermenuitem",text:"Puzzles"},{id:"menuTTS",cls:"menuItem menuSharing",xtype:"readermenutts",layout:"vbox"},{id:"menuSharing",cls:"menuItem menuSharing",xtype:"readermenushare",layout:"vbox"}]},{itemId:"sponsorEdition",style:"background-color:rgb(80, 80, 80);font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;cursor:pointer",padding:"10 15 10 15",height:40,width:"100%",items:[{html:"SPONSORED",style:"font-size:10px;",top:5,right:5}]},{id:"menuSections",cls:"menuSectionHeader menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"SECTIONS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSectionsContainer",cls:"menuSectionContent menuSections",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuSupplements",cls:"menuSectionHeader menuSupplements",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"SUPPLEMENTS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSupplementsContainer",cls:"menuSectionContent menuSupplements",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuZones",cls:"menuSectionHeader menuZones",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"ZONES",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuZonesContainer",cls:"menuSectionContent menuZones",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuQuickLinks",cls:"menuSectionHeader menuQuickLinks",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"QUICK LINKS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuQuickLinksContainer",cls:"menuSectionContent menuQuickLinks",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuInfo",cls:"menuSectionHeader menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"INFO",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuInfoContainer",cls:"menuSectionContent menuInfo",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuHowToUse",xtype:"readermenuitem",cls:"menuItem menuHowToUse",clickType:"id",text:"How to use"},{id:"menuHelp",xtype:"readermenuitem",cls:"menuItem menuHelp",clickType:"id",text:"Contact Us"},{id:"menuTerms",cls:"menuItem menuTerms",clickType:"id",xtype:"readermenuitem",text:"Terms and Conditions"},{id:"menuFaq",cls:"menuItem menuFaq",clcikType:"id",xtype:"readermenuitem",text:"FAQ"},{id:"menuPrivacy",cls:"menuItem menuPrivacy",clickType:"id",xtype:"readermenuitem",text:"Privacy Policy"},{id:"menuStoryPref",cls:"menuItem menuStoryPref",clickType:"id",xtype:"readermenuitem",text:"Story Window Preferences"}]},{id:"menuUserOp",cls:"menuSectionHeader menuUserOp",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"USER OPTIONS",items:[{itemId:"toggleSection",cls:"menuToggle",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuUserContainer",cls:"menuSectionContent menuUserOp",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuAccount",xtype:"readermenuitem",cls:"menuItem menuAccount",clickType:"id",text:"My Account"},{id:"menuUser",xtype:"readermenuitem",cls:"menuItem menuUser",clickType:"id",text:"Logout"}]},{itemId:"sponsorInfo",style:"background-color:rgb(80, 80, 80);font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;cursor:pointer ",padding:"10 15 10 15",height:40,width:"100%",items:[{html:"SPONSORED",style:"font-size:10px;",top:5,right:5}]},{cls:"opt-cookie-settings-menu",itemId:"oneTrustCookieSettings",html:"Cookie Settings",margin:0,padding:15,height:46}]}]},initialize:function(){var c=this;Ext.Viewport.addCls("menu");var a=Ext.getStore("SettingStore");if(c.config.direction!=null){c.direction=c.config.direction}if(c.direction=="left"){c.setRight("");c.setLeft(0);c.setZIndex(999999)}c.menuLayout=c.getComponent("menuLayout");if(settings.menu.background.length>6){var b=hexaToRgba(settings.menu.background);c.menuLayout.setStyle("background-color: rgba("+b+")")}else{c.menuLayout.setStyle("background-color:#"+settings.menu.background+";")}c.menuEditionOptionsSection=c.menuLayout.getComponent("editionOptionsSection");c.menuLayout.getComponent("editionOptionsSection").getComponent("menuDynamicArticles").hide();c.menuHeader=c.menuLayout.getComponent("menuHeader");c.menuHeaderClose=c.menuHeader.getComponent("menuHeaderClose");c.setupMenuHeaderClose();c.oneTrustCookieSettings=c.menuLayout.getComponent("oneTrustCookieSettings");c.checkArchive();c.checkDownload();c.checkClipping();c.checkPrint();c.checkBookmarks();c.checkHowToUse();c.checkHelp();c.checkLogout();c.checkTerms();c.checkSearch();c.checkPagesContainer();c.checkArticlesContainer();c.checkMenuHeader();c.checkStoryWindowPrefs();c.checkFaq();c.checkSpecialArchive();c.checkFunBook();c.checkExtraArchives();c.checkSupplementsTab();c.checkPrivacyPolicy();c.checkOneTrustCookieSettings();c.initializePuzzlesMenu();c.sharingContainer=c.menuLayout.getComponent("editionOptionsSection").getComponent("menuSharing");c.sectionsHeaderContainer=c.menuLayout.getComponent("menuSections");c.sectionsContainer=c.menuLayout.getComponent("menuSectionsContainer");c.supplementsHeaderContainer=c.menuLayout.getComponent("menuSupplements");c.supplementsContainer=c.menuLayout.getComponent("menuSupplementsContainer");c.zonesHeaderContainer=c.menuLayout.getComponent("menuZones");c.zonesContainer=c.menuLayout.getComponent("menuZonesContainer");c.quickLinksHeaderContainer=c.menuLayout.getComponent("menuQuickLinks");c.quickLinksContainer=c.menuLayout.getComponent("menuQuickLinksContainer");c.sponsorEdition=c.menuLayout.getComponent("sponsorEdition");c.sponsorInfo=c.menuLayout.getComponent("sponsorInfo");c.sponsorSetup();c.loadShare();c.loadSections();c.loadSupplements();c.loadZones();c.loadQuickLinks();c.setupMouseListener();c.checkTop();c.setupHeaders();c.handleJustifiedText();if(Ext.browser.is.IE){c.handleIe()}c.fireEvent("disableArticlesContainer")},checkOneTrustCookieSettings:function(){var b=this;if(settings.oneTrust!=null&&typeof OneTrust!="undefined"){b.oneTrustCookieSettings.setStyle("font-size:14px;color:#"+settings.menu.textColor+";cursor:pointer");try{b.oneTrustCookieSettings.element.on({scope:b,tap:function(d){if(typeof OneTrust!="undefined"){try{OneTrust.ToggleInfoDisplay()}catch(c){console.error("[ReaderMenu]: Error Caught\n",c)}}}})}catch(a){console.error("[ReaderMenu]: Error Caught\n",ex)}}else{b.oneTrustCookieSettings.hide()}},checkPrivacyPolicy:function(){var a=this;var b=a.menuLayout.getComponent("menuInfoContainer");a.menuPrivacy=b.getComponent("menuPrivacy");if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.privacyPolicyUrl!=null){a.menuPrivacy.show()}else{a.menuPrivacy.hide()}},checkTop:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){var c=Ext.Viewport.query("readerbannerad");if(c.length>0){if(settings.newsday!=null){a.setTop(0)}else{var b=c[0].getHeight()+40;a.setTop(b);a.setHeight("calc( 100% - "+b+"px)")}}}},handleIe:function(){var b=this;b.menuLayout.setWidth("100%");var a=$(b.menuLayout.element.dom).find(".x-inner")[0];if(a!=null){$(a).addClass("ie-inner")}},checkSupplementsTab:function(){var a=this;a.supplementsTab=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSupplementsTab");if(currentProfile=="desktop"){a.supplementsTab.hide()}else{if(settings.menu.supplements==null||settings.menu.supplements.showSupplementsTab!="true"||settings.menu.supplements.supplement.length==0){a.supplementsTab.hide()}}},checkSpecialArchive:function(){var a=this;a.specialArchive=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSpecialArchive");if(typeof specialArchive==="undefined"||specialArchive==null||specialArchive.length==0){a.specialArchive.hide()}},checkFunBook:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuNewsdayFunbook");if(settings.newsday!=null&&settings.newsday.showFunbookInMainMenu!=null&&settings.newsday.showFunbookInMainMenu=="true"){a.setHidden(false)}},setupMouseListener:function(){var b=this;if(currentProfile=="desktop"){b.scroller=b.menuLayout.getScrollable().getScroller();var a=function(f){var e=b.scroller.maxPosition;var h=b.scroller.minPosition;var c=b.scroller.position;var g=30;if(f=="up"){var d=c.y-g;if(d>h.y){b.scroller.scrollTo(0,d)}else{if(d<=h.y){b.scroller.scrollTo(0,h.y)}}}else{if(f=="down"){var d=c.y+g;if(d<e.y){b.scroller.scrollTo(0,d)}else{if(d>=e.y){b.scroller.scrollTo(0,e.y)}}}}};b.element.dom.onmousewheel=function(c){var d="down";if(c.deltaY<0||c.wheelDelta>0){d="up"}a(d)};b.element.dom.addEventListener("DOMMouseScroll",function(c){var d="down";if(c.detail<0){d="up"}a(d)})}},checkFaq:function(){var a=this;a.menuFaq=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuFaq");if(settings.menu.enableFaq==null||settings.menu.enableFaq=="false"){a.menuFaq.hide()}},checkStoryWindowPrefs:function(){var b=this;b.menuStoryPref=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuStoryPref");var a=Ext.getStore("ArticleStore");if(settings.newsday==null||(a==null||a.data.items[0].raw.articles.length<=0)){b.menuStoryPref.hide()}},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){a.fireEvent("close")})},checkMenuHeade},checkPagesContainer:function(){var b=this;b.pagesBtn=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPages");var a=true;if(settings.newsday!=null){a=false}if(a){if(currentProfile=="desktop"){b.pagesBtn.hide()}}},checkArticlesContainer:function(){var c=this;c.articlesBtn=c.menuLayout.getComponent("editionOptionsSection").getComponent("menuArticles");var a=false;if(currentProfile=="desktop"){c.articlesBtn.hide();a=true}if(settings.newsday!=null){c.articlesBtn.hide();a=true}if(!a){if(settings.hideArticleBtn!=null){c.articlesBtn.hide()}else{var b=InfinityMobile.app.getController("ArticleController").getArticles();if(b==null||b.length==0){c.articlesBtn.hide()}}}},checkSearch:function(){var a=this;a.searchBtn=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSearch");if(currentProfile=="desktop"){a.searchBtn.hide()}else{if(settings.newsday!=null){if(settings.newsday.menuSearch=="false"){a.searchBtn.hide()}}else{a.searchBtn.hide()}}},setupHeaders:function(){var b=this;b.editionOptionsHeaderContainer=b.menuLayout.getComponent("menuEditionOptions");var c=language.menu.editionOptions.toUpperCase();b.editionOptionsHeaderContainer.setHtml(c);b.editionOptionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.editionOptionsHeaderContainer.element.on({ta},scope:b});if(!b.menuLayout.getComponent("editionOptionsSection").config.minimized){b.calculateSectionHeight(b.menuLayout.getComponent("editionOptionsSection"))}b.sectionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.sectionsHeaderContainer.element.on({tap:function(){b.headerTap(b.sectionsContainer,b.sectionsHeaderContainer)},scope:b});b.supplementsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.supplementsHeaderContainer.element.on({tap:function(){b.headerTap(b.supplementsContainer,b.supplementsHeaderContainer)},scope:b});b.zonesHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.zonesHeaderContainer.element.on({tap:function(){b.headerTap(b.zonesContainer,b.zonesHeaderContainer)},scope:b});b.quickLinksHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.quickLinksHeaderContainer.element.on({ta},scope:b});b.menuInfoHeaderContainer=b.menuLayout.getComponent("menuInfo");var a=language.menu.info.toUpperCase();b.menuInfoHeaderContainer.setHtml(a);b.menuInfoHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.menuInfoHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuInfoContainer"),b.menuLayout.getComponent("menuInfo"))},scope:b});b.menuUserHeaderContainer=b.menuLayout.getComponent("menuUserOp");b.menuUserHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#"+settings.menu.headerTextColor);b.menuUserHeaderContainer.element.on({ta},scope:b});if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){if(b.editionOptionsHeaderContainer!=null){b.editionOptionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.editionOptionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}if(b.sectionsHeaderContainer!=null){b.sectionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.sectionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.supplementsHeaderContainer!=null){b.supplementsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.supplementsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.zonesHeaderContainer!=null){b.zonesHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.zonesHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.quickLinksHeaderContainer!=null){b.quickLinksHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.quickLinksHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuInfoHeaderContainer!=null){b.menuInfoHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuInfoHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuUserHeaderContainer!=null){b.menuUserHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuUserHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}}},calculateSectionHeigh},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},headerTap:function(f,g){var d=this;if(f.config.minimized){var b=0;f.setDefaults({padding:"15px 0px 15px 0px"});for(var c=0;c<f.items.items.length;c++){var e=f.items.items[c];if(!e.getHidden()){b+=parseFloat($(e.element.dom).height())}}f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.element.dom.style.maxHeight=b+"px";setTimeou},420);var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/minimise-menu-option.png')"}f.config.minimized=false;mainPanel.fireEvent("trackMenuHeader",f,g)}else{f.setDefaults({padding:"0px 0px 0px 0px"});f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.setStyle({maxHeight:"0px"});var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/maximise-menu-option.png')"}f.config.minimized=true;mainPanel.fireEvent("trackMenuHeader",f,g)}},checkPages:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPages");if(settings.menu.hidePages!=null){if(settings.menu.hidePages){a.hide()}}else{if(settings.menu.pagesText!=null){}}},checkArchive:function(){var d=this;var b=d.menuArchive=d.menuLayout.getComponent("editionOptionsSection").getComponent("menuArchive");if(settings.menu.hideArchive!=null){if(settings.menu.hideArchive){b.hide()}}else{if(settings.menu.archiveText!=null){var a=Ext.getStore("ArchiveStore");var c=[];if(a.data.items[0]!=null){if(a.data.items[0].raw.editions!=null&&a.data.items[0].raw.editions!=""){c=a.data.items[0].raw.editions.edition;if(c.length==0){b.hide()}}}}}},checkExtraArchives:function(){var b=this;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.extraArchives!=null){var a=b.returnExtraArchivesIndex();b.fireEvent("loadExtraArchiveButtons",b,a)}},returnExtraArchivesIndex:function(){var d=this;var c=0;if(typeof settings!="undefined"){try{var a=d.menuEditionOptionsSection.getItems().items;if(settings.menu!=null&&!settings.menu.hideArchive&&d.menuArchive!=null){c=a.indexOf(d.menuArchive)+1}if(typeof specialArchive!="undefined"&&specialArchive!=null&&specialArchive.edition!=null&&specialArchive.edition.length>0&&d.specialArchive!=null){c=a.indexOf(d.specialArchive)+1}}catch(b){console.error("[ReaderMenu] \t",b)}}return c},checkDownload:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuDownload");if(settings.menu.hideDownload!=null){if(settings.menu.hideDownload){a.hide()}}else{if(settings.menu.downloadText!=null){}}},checkClippin},checkArticle},checkPrint:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPrint");if(settings.menu.hidePrint!=null){if(settings.menu.hidePrint){a.hide()}}else{if(currentProfile!="desktop"){if(settings.menu.disablePrintMobile=="true"||(Ext.os.is.Android&&Ext.browser.is.Firefox)){a.hide()}}}},checkBookmarks:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuBookmarks");if(settings.menu.hideBookmarks!=null){a.hide()}else{if(settings.menu.bookmarkText!=null){}}},checkHowToUs},checkHel},loadShare:function(){var a=this;a.fireEvent("loadShare",a)},loadSections:function(){var a=this;a.fireEvent("loadSections",a,a.sectionsContainer,a.sectionsHeaderContainer)},loadSupplements:function(){var a=this;a.fireEvent("loadSupplements",a,a.supplementsContainer,a.supplementsHeaderContainer)},loadZones:function(){var a=this;a.fireEvent("loadZones",a,a.zonesContainer,a.zonesHeaderContainer)},loadQuickLink},checkWhatsNewBanner:function(){var c=this;var a=c.whatsNewContainer.element.down(".bannerIcon").dom;try{if(localStorage.getItem("versionwhatsnew"+version.replace(/g./g,"_"))!=null){a.style.display="none"}}catch(b){}},sponsorSetup:function(){var b=this;if(settings.menu.sponsor==null){b.sponsorEdition.hide();b.sponsorInfo.hide()}else{if(settings.menu.sponsor.type=="adbridg"){b.setWidth(320);var a=Ext.create("Ext.Container",{padding:0});a.setHtml("<div id='"+(b.id+"_menusponsor")+"' data-adbridg-ad-class='adb-ee-menu'></div>");if(settings.menu.sponsor.position=="top"){b.menuLayout.getComponent("editionOptionsSection").insert(0,a)}else{b.menuLayout.getComponent("editionOptionsSection").add(a)}b.sponsorEdition.hide();b.sponsorInfo.hide()}else{if(settings.menu.sponsor.type!="image"){if(settings.menu.sponsor.dfpType=="banner"){b.setWidth(320);settings.menu.sponsor.usePhoneBanner="true"}else{if(settings.menu.sponsor.dfpType=="mpu"){b.setWidth(300)}}var a=Ext.create("InfinityMobile.view.Advert",{advert:settings.menu.sponsor,xtype:"advertview",padding:0});if(settings.menu.sponsor.position=="top"){b.menuLayout.getComponent("editionOptionsSection").insert(0,a)}else{b.menuLayout.getComponent("editionOptionsSection").add(a)}b.sponsorEdition.hide();b.sponsorInfo.hide()}else{if(b.sponsorEdition!=null){b.sponsorEdition.setHtml("<img style='height:20px;width:auto;' src='"+settings.menu.sponsor.image+"' />");b.sponsorEdition.url=settings.menu.sponsor.link;if(settings.menu.sponsor.link!=null&&settings.menu.sponsor.link.length>0){b.sponsorEdition.element.on({tap:function(){var c=this;window.open(c.url);mainPanel.fireEvent("trackAdvertClick","imageSponsor")},scope:b.sponsorEdition})}}if(b.sponsorInfo!=null){b.sponsorInfo.setHtml("<img style='height:20px;width:auto;' src='"+settings.menu.sponsor.image+"' />");b.sponsorInfo.url=settings.menu.sponsor.link;if(settings.menu.sponsor.link!=null&&settings.menu.sponsor.link.length>0){b.sponsorInfo.element.on({tap:function(){var c=this;window.open(c.url);mainPanel.fireEvent("trackAdvertClick","imageSponsor")},scope:b.sponsorInfo})}}}}}},checkLogout:function(){var b=this;var c=InfinityMobile.app.application.getController("AppController").hasValidLoginViaUserAccessCookie();var a=loggedIn.toLowerCase()=="true"||c===true;if(!a||settings.menu.hideUserOptions=="true"){b.menuLayout.getComponent("menuUserContainer").hide();b.menuLayout.getComponent("menuUserOp").hide()}else{if(settings.menu.hideMyAccount!=null&&settings.menu.hideMyAccount=="true"){b.menuLayout.getComponent("menuUserContainer").getComponent("menuAccount").hide()}}},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments);Ext.Viewport.removeCls("menu");mainPanel.fireEvent("trackMenuClose")},checkTerm},show:function(){var a=this;a.handleKeyDown();InfinityMobile.view.Overlay.prototype.show.apply(this,arguments)},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},handleJustifiedText:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right")}},initializePuzzlesMenu:function(){var a=this;a.menuPuzzles=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuPuzzles");if(a.menuPuzzles!=null&&!InfinityMobile.controller.ReaderPuzzlesController.hasSettingEnabledForPuzzlesPopup()){a.menuPuzzles.hide()}},setupMenuHeaderClose:function(){var b=this;var a=settings&&settings.menu&&settings.menu.menuHeaderCloseURL;if(b.menuHeaderClose&&a&&a.length>0){var c="<img src='"+a+"' style='width:20px' />";b.menuHeaderClose.setHtml(c)}}},0,["readermenu"],["component","container","panel","overlay","readermenu"],{component:true,container:true,panel:true,overlay:true,readermenu:true},["widget.readermenu"],0,[InfinityMobile.view.tablet,"ReaderMenu"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ArticlePopoverAd",Ext.Container,{config:{width:"100%",height:110,padding:10,layout:{type:"hbox",align:"center",pack:"middle"}},initializ},setCanLoadDFPAdver},loadAdver},destroyAdvert:function(){var a=this;a.removeAll(true)},setDFPAdver},loadDFPAdvert:function(){var a=this;googletag.cmd.push(function(){googletag.defineSlot("/30709998/eedition.dhbusinessledger.com",[300,250],"divMPU").addService(googletag.pubads().updateCorrelator());googletag.enableServices()});googletag.cmd.push(function(){googletag.display("divMPU")})},setImageAdver},setUrlAdver}},0,["readerbannerad"],["component","container","readerbannerad"],{component:true,container:true,readerbannerad:true},["widget.readerbannerad"],0,[InfinityMobile.view.tablet,"ArticlePopoverAd"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ImageGallery",Ext.Container,{config:{modal:true,fullscreen:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:20,baseCls:"dynamicgallery",items:[{itemId:"portrait",height:"100%",width:"100%",layout:"vbox",items:[{itemId:"closeBtnRow",height:50,width:"100%",items:[{itemId:"closeBtn",cls:"pointerCursor",right:0,top:0,margin:10,height:25,width:25,style:{backgroundImage:"url('resources/images/reader icons/close-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}]},{itemId:"imageCarousel",cls:"portrait-carousel",height:"40%",width:"100%",xtype:"carousel",style:"background-color:rgb(75,75,75)"},{itemId:"galleryCounterPanel",width:"100%",height:50,layout:"hbox",items:[{itemId:"previous",height:30,width:30,margin:10,cls:"pointerCursor"},{itemId:"counterPanel",height:"100%",layout:{type:"hbox",pack:"center"},style:{color:"white"},items:[{itemId:"cameraIcon",height:30,width:30,margin:10,style:{backgroundImage:"url('resources/images/reader icons/photo-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},{itemId:"counter",height:50,layout:{type:"vbox",pack:"center"},items:[{itemId:"text"}]}]},{itemId:"next",width:30,height:30,margin:10,cls:"pointerCursor"}]},{itemId:"galleryInfo",width:"100%",padding:10,layout:"vbox",scrollable:{direction:"vertical",indicators:false},style:{color:"white"},items:[{itemId:"title",style:{fontSize:"25px",fontWeight:"bold"},margin:"10 0"},{itemId:"caption",style:{fontSize:"14px"},margin:"10 0"}]},{itemId:"imageScroller",scrollable:{direction:"horizontal"},height:150,width:"100%",layout:"hbox",padding:10}]},{itemId:"landscape",height:"100%",width:"100%",layout:"vbox",items:[{itemId:"closeBtnRow",height:50,width:"100%",items:[{itemId:"counterPanel",height:"100%",layout:{type:"hbox",pack:"center"},style:{color:"white"},items:[{itemId:"cameraIcon",height:30,width:30,margin:10,style:{backgroundImage:"url('resources/images/reader icons/photo-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},{itemId:"counter",height:50,layout:{type:"vbox",pack:"center"},items:[{itemId:"text"}]}]},{itemId:"closeBtn",cls:"pointerCursor",right:0,top:0,margin:10,height:25,width:25,style:{backgroundImage:"url('resources/images/reader icons/close-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}]},{itemId:"galleryPanel",layout:"hbox",width:"100%",flex:1,items:[{itemId:"previous",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"},{itemId:"imageCarousel",cls:"landscape-carousel",xtype:"carousel",height:"100%",style:"background-color:rgb(75,75,75)"},{itemId:"next",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"}]},{height:50,width:"100%"},{itemId:"imageScroller",scrollable:{direction:"horizontal"},bottom:-150,height:150,width:"100%",layout:"hbox",padding:10,style:{backgroundColor:"rgba(0,0,0,0.7)"}}]}]},initialize:function(){var c=this;if(c.config.article!=null){c.article=c.config.article}if(c.config.images!=null){c.images=c.config.images}if(c.config.dynamicview!=null){c.dynamicview=c.config.dynamicview}if(c.dynamicview||c.dynamicview==null){c.setCentered(true)}c.portraitImagesLoaded=false;c.landscapeImagesLoaded=false;c.portrait=c.getComponent("portrait");c.landscape=c.getComponent("landscape");c.porGalleryInfo=c.portrait.getComponent("galleryInfo");c.porImageCarousel=c.portrait.getComponent("imageCarousel");c.porGalleryCounterPanel=c.portrait.getComponent("galleryCounterPanel");c.porImageScroller=c.portrait.getComponent("imageScroller");c.title=c.porGalleryInfo.getComponent("title");c.caption=c.porGalleryInfo.getComponent("caption");c.title.setHtml(c.article.headline);c.porCounterPanel=c.porGalleryCounterPanel.getComponent("counterPanel");c.porCounter=c.porCounterPanel.getComponent("counter");c.porCamera=c.porCounterPanel.getComponent("cameraIcon");c.landCloseBtnRow=c.landscape.getComponent("closeBtnRow");c.landCounterPanel=c.landCloseBtnRow.getComponent("counterPanel");c.landCounter=c.landCounterPanel.getComponent("counter");c.landGalleryPanel=c.landscape.getComponent("galleryPanel");c.landImageCarousel=c.landGalleryPanel.getComponent("imageCarousel");c.landImageScroller=c.landscape.getComponent("imageScroller");c.landCamera=c.landCounterPanel.getComponent("cameraIcon");c.porImageCarousel.on({activeitemchange:c.handleItemChange,scope:c});c.landImageCarousel.on({activeitemchange:c.handleItemChange,scope:c});c.scrollerHidden=true;c.landImageCarousel.element.on({tap:c.toggleScroller,scope:c});if(!c.portraitImagesLoaded){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){for(var b=c.images.length-1;b>=0;b--){var d=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:c.images[b],position:b});c.porImageCarousel.add(d);var e=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:c.images[b].url,carousel:c.porImageCarousel,index:b,style:{transition:"all ease 0.5s"}});if(b==c.images.length-1){e.element.dom.style.border="2px solid white"}c.porImageScroller.add(e)}}else{for(var b in c.images){var d=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:c.images[b],position:b});c.porImageCarousel.add(d);var e=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:c.images[b].url,carousel:c.porImageCarousel,index:b,style:{transition:"all ease 0.5s"}});if(b==0){e.element.dom.style.border="2px solid white"}c.porImageScroller.add(e)}}c.portraitImagesLoaded=true}if(!c.landscapeImagesLoaded){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){for(var b=c.images.length-1;b>=0;b--){var d=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:c.images[b],position:b});c.landImageCarousel.add(d);var e=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:c.images[b].url,carousel:c.landImageCarousel,index:b,style:{transition:"all ease 0.5s"}});if(b==c.images.length-1){e.element.dom.style.border="2px solid white"}c.landImageScroller.add(e)}}else{for(var b in c.images){var d=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:c.images[b],position:b});c.landImageCarousel.add(d);var e=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:c.images[b].url,carousel:c.landImageCarousel,index:b,style:{transition:"all ease 0.5s"}});if(b==0){e.element.dom.style.border="2px solid white"}c.landImageScroller.add(e)}}c.landscapeImagesLoaded=true}if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){try{c.porImageCarousel.setActiveItem(c.porImageCarousel.getItems().items[c.images.length]);setTimeout(function(){try{var g=c.porImageScroller.getScrollable().getScroller();g.scrollToEnd();g=c.landImageScroller.getScrollable().getScroller();g.scrollToEnd()}catch(f){console.error("[ImageGallery]:\n",f)}},100)}catch(a){console.error("[ImageGallery]:\n",a)}}if(c.returnOrientation()=="portrait"){c.portraitSetup()}else{c.landscapeSetup()}c.orientationChange=function(){setTimeout(function(){if(c.returnOrientation()=="portrait"){c.portraitSetup();c.porImageCarousel.onSizeChange()}else{c.landscapeSetup();c.landImageCarousel.onSizeChange()}},200)};if(Ext.os.is.Android){$(window).on("resize",c.orientationChange)}else{Ext.Viewport.on({orientationchange:c.orientationChange,scope:c})}c.on({painted:function(){c.fireEvent("galleryVisible");mainPanel.fireEvent("trackImageGalleryOpen")},destroy:function(){c.fireEvent("galleryInvisible")}});c.handleJustification()},handleItemChange:function(c,f,b){var d=this;if(d.images!=null){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){d.porCounter.setHtml(d.images.length+" / "+(parseFloat(f.position)+1));d.landCounter.setHtml(d.images.length+" / "+(parseFloat(f.position)+1))}else{d.porCounter.setHtml((parseFloat(f.position)+1)+" of "+d.images.length);d.landCounter.setHtml((parseFloat(f.position)+1)+" of "+d.images.length)}d.caption.setHtml("");if(d.article.images[f.position].caption!=null){if(d.article.images[f.position].caption.trim().length>0){d.caption.setHtml(d.article.images[f.position].caption)}else{if(d.article.shortStory!=null){d.caption.setHtml(d.article.shortStory)}}}else{if(d.article.shortStory!=null){d.caption.setHtml(d.article.shortStory)}}}var a=f.position;var e=b!=null?b.position:null;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a=d.images.length-f.position-1;if(b!=null){e=d.images.length-b.position-1}}if(d.porImageScroller.getItems().items[a]!=null){d.porImageScroller.getItems().items[a].element.dom.style.border="2px solid white";d.porImageCarousel.setActiveItem(parseFloat(a))}if(b!=null){if(d.porImageScroller.getItems().items[e]!=null){d.porImageScroller.getItems().items[e].element.dom.style.border=""}}if(d.landImageScroller.getItems().items[a]!=null){d.landImageScroller.getItems().items[a].element.dom.style.border="2px solid white";d.landImageCarousel.setActiveItem(parseFloat(a))}if(b!=null){if(d.landImageScroller.getItems().items[e]!=null){d.landImageScroller.getItems().items[e].element.dom.style.border=""}}if(c.config.cls.indexOf(d.returnOrientation())!=-1){console.log("hitting");mainPanel.fireEvent("trackImageChange")}},portraitSetup:function(){var a=this;a.landscape.hide();a.portrait.show();a.closeBtnRow=a.portrait.getComponent("closeBtnRow");a.closeBtn=a.closeBtnRow.getComponent("closeBtn");a.closeBtn.element.on({ta},scope:a});a.previousBtn=a.porGalleryCounterPanel.getComponent("previous");a.previousBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-back-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.nextBtn=a.porGalleryCounterPanel.getComponent("next");a.nextBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-next-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.previousBtn.element.on({tap:a.previous,scope:a});a.nextBtn.element.on({tap:a.next,scope:a});a.portraitPainted()},portraitPainte},landscapeSetu},toggleScrolle},landscapePainted:function(){var a=this;a.landImageCarousel.setWidth($(document).width()-100)},next:function(){var a=this;if(a.returnOrientation()=="portrait"){a.porImageCarousel.next()}else{a.landImageCarousel.next()}},previou},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},destroy:function(){var a=this;if(Ext.os.is.Android){$(window).off("resize",a.orientationChange)}else{Ext.Viewport.un("orientationchange",a.orientationChange)}Ext.Container.prototype.destroy.apply(this,arguments)},handleJustification:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right");a.porImageScroller.getLayout().setPack("end");a.landImageScroller.getLayout().setPack("end");a.porCounterPanel.remove(a.porCamera,false);a.porCounterPanel.add(a.porCamera);a.landCounterPanel.remove(a.landCamera,false);a.landCounterPanel.add(a.landCamera)}}},0,["dynamicimagegallery"],["component","container","dynamicimagegallery"],{component:true,container:true,dynamicimagegallery:true},["widget.dynamicimagegallery"],0,[InfinityMobile.view.tablet,"ImageGallery"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderOGallery",Ext.Container,{config:{fullscreen:true,modal:true,style:"background-color:black;",height:"100%",width:"100%",zIndex:99999999,layout:{type:"vbox"},items:[{itemId:"content",flex:1,width:"100%",layout:{type:"vbox"},items:[{itemId:"closeBtn",right:10,top:10,width:40,height:40,cls:"backgroundImage pointerCursor",style:"background-image:url('resources/images/article-close-btn-white.png');background-size:contain;"},{itemId:"images",directionLock:true,flex:6,width:"100%",style:"background-color:black;"},{itemId:"caption",width:"100%",style:"background-color:#333333;color:white;padding: 10px;max-height:200px;min-height:40px;",flex:1,scrollable:{directionLock:true,direction:"vertical"}}]},{itemId:"navBar",docked:"bottom",height:40,width:"100%",layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"prev",width:25,style:"text-align:center",html:'<i class="fa fa-angle-left fa-lg" aria-hidden="true"></i>'},{itemId:"counter",margin:"0px 20px 0px 20px"},{itemId:"next",width:25,style:"text-align:center",html:'<i class="fa fa-angle-right fa-lg" aria-hidden="true"></i>'}]}]},initialize:function(){var d=this;d.content=d.getComponent("content");d.navBar=d.getComponent("navBar");d.navBar.setStyle({backgroundColor:"#"+settings.topbar.backgroundColor,color:"#"+settings.topbar.color});if(d.config.article!=null){d.article=d.config.article}d.previousBtn=d.navBar.getComponent("prev");d.nextBtn=d.navBar.getComponent("next");d.counter=d.navBar.getComponent("counter");if(d.config.url!=null){d.url=d.config.url;d.captions=[];d.content.getComponent("closeBtn").element.on({tap:"close",scope:d});var g=Ext.create("InfinityMobile.view.ReaderOGalleryLoading",{});if(d.useSettingDrivenUrl()){var b=d.url.replace("ace-stage.newsday.com/","").replace("http://","");b="../../Newsday/getAtex.aspx?url="+d.returnFormattedUrl(settings.newsday.atexMediaUrl)+b+"?device=ipad-4&_dc=1445010088130&limit=25"}else{if(d.url.indexOf("http://")!=-1){var b=d.url.substring(7,d.url.length)}else{b=d.url}b="../../Newsday/getatex.aspx?url=http://www.newsday.com/iosfeeds/"+b+"?device=tablet&_dc=1445010088130&limit=25"}$.ajax({type:"GET",url:b,data:{get_param:"value"},dataType:"json",complete:function(){g.destroy()},success:function(k){var h=[];d.images=k.content.images;for(var j=0;j<k.content.images.length;j++){var m={imageUrl:k.content.images[j].image_path,pageNo:j,config:{pageNo:j}};d.captions[j]=k.content.images[j].caption;h[h.length]=m}d.counter.setHtml("1 of "+d.captions.length);d.setupCarousel(h);d.itemChange(d.carousel);d.data=k;var l="1 of "+d.captions.length;if(k.content.pagedata!=null&&k.omniture==null){d.data.omniture=k.omniture=k.content.pagedata;if(k.content.pagedata.pagename!=null){k.omniture.pageName=k.content.pagedata.pagename}d.data.omniture.hierarchy=k.omniture.hierarchy=k.content.pagedata.hier}d.fireEvent("ogalleryinitialized",d,k,l)}})}else{if(d.config.images!=null){d.images=d.config.images;d.captions=[];d.content.getComponent("closeBtn").element.on({tap:"close",scope:d});var g=Ext.create("InfinityMobile.view.ReaderOGalleryLoading",{});var a=[];for(var c=0;c<d.images.length;c++){var e={imageUrl:d.images[c].url,pageNo:c,config:{pageNo:c}};a[a.length]=e;var f="";if(d.images[c].credit!=null){if(d.images[c].credit.trim().length>0){f=" ("+d.images[c].credit+")"}}d.captions[c]=d.images[c].caption+f}g.destroy();d.counter.setHtml("1 of "+d.captions.length);d.setupCarousel(a);d.on("painted",function(){d.itemChange(d.carousel)})}}d.previousBtn.element.on({tap:function(){d=this;d.carousel.previous()},scope:d});d.nextBtn.element.on({ta},scope:d})},returnFormattedUrl:function(a){return !!a&&a[a.length-1]!="/"?(location.protocol+"//"+a+"/"):(location.protocol+"//"+a)},useSettingDrivenUrl:function(){return typeof settings!="undefined"&&settings.newsday!=null&&!!settings.newsday.atexMediaUrl},close:function(){var a=this;a.fireEvent("closeOGallery",a)},setupCarouse},itemChange:function(c,m,b,j){var l=this;l.index=l.carousel.getActiveItem().getPageNo();if(l.captions[l.index]!=null&&l.captions[l.index].trim().length>0){var g=l.images!=null&&l.images[l.index].image_title!=null&&l.images[l.index].image_title!=""?"<p style='font-weight:bold;'>"+l.images[l.index].image_title+"</p>":"";console.log(l.images[l.index]);l.content.getComponent("caption").setHtml("<div class=\"captionText\" style='width:100%;color:white;padding:10px;'>"+g+"<p>"+l.captions[l.index]+"</p></div>");l.content.getComponent("caption").show()}else{l.content.getComponent("caption").hide()}var d=$(l.element.dom).find(".captionText");if(d.length>0){var k=$(d[0]).height();if(k>120){l.content.getComponent("caption").setHeight(140)}else{l.content.getComponent("caption").setHeight(k+20)}}l.content.getComponent("caption").getScrollable().getScroller().scrollTo(0,0);l.counter.setHtml((c.getActiveItem().getPageNo()+1)+" of "+l.captions.length);var h=(c.getActiveItem().getPageNo()+1)+" of "+l.captions.length;if(l.url!=null){if(l.data!=null){l.fireEvent("ogalleryinitialized",l,l.data,h)}}else{var a=l.article.byline;if(l.article.reporters!=null&&l.article.reporters.length>0){for(var f in l.article.reporters){a+=", "+l.article.reporters[f].name}}var e={author:a,contentTitle:l.article.headline,contentType:"photolist"};l.fireEvent("ogalleryinitializedArticle",l,e,h)}}},0,["readerogallery"],["component","container","readerogallery"],{component:true,container:true,readerogallery:true},["widget.readerogallery"],0,[InfinityMobile.view.tablet,"ReaderOGallery"],0));(Ext.cmd.derive("InfinityMobile.profile.tablet",Ext.app.Profile,{config:{name:"tablet",views:["SplashScreen","ReaderHelper","ReaderMenu","ReaderMenuSection","ReaderArchive","ReaderSearch","ReaderDownload","ReaderArticlePopover","ReaderWhatsNew","Interstitial","ArticlePopoverAd","ArticlePopoverInterstitial","ReaderBannerAd","ReaderBookmark","ClippingArea","ImageGallery","SectionListOverlay","ZonesOverlay","ArticlesContainer","ReaderPuzzlePopoverItem","ReaderOGallery","ReaderSpecialArchive","ReaderPrint","ReaderWebpopover","ReaderMenuFeedApp","ReaderPuzzlesPopup"]},isActive:function(){if(navigator.userAgent.toLowerCase().indexOf("ipad")!=-1){currentProfile="tablet";return true}if(window.screen.width<=834&&navigator.userAgent.toLowerCase().indexOf("macintosh")!=-1&&this.is_touch_device()&&!Ext.os.is.Phone){Ext.os.is.iOS=true;Ext.os.is.Desktop=false;currentProfile="tablet";return true}return Ext.os.is.Tablet},is_touch_devic}},0,0,0,0,0,0,[InfinityMobile.profile,"tablet"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderSpecialSupplements",InfinityMobile.view.Overlay,{config:{id:"supplementscontainer",width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{itemId:"toolBar",height:40,style:"background-color:#e6e6e6",items:[{top:10,left:10,html:"<b>Special Supplements</b>"},{id:"toolBarClose",top:8,right:8,cls:"pointerCursor",html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"bodyContainer",padding:"20",layout:"vbox",flex:1,style:"font-size:15px",items:[{itemId:"itemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:150,margin:"0 8 16 7",cls:"archiveitemphone"}}]}]},initializ},setCloseListene},close:function(){var a=this;a.fireEvent("close",a)}},0,["readerspecialsupplements"],["component","container","panel","overlay","readerspecialsupplements"],{component:true,container:true,panel:true,overlay:true,readerspecialsupplements:true},["widget.readerspecialsupplements"],0,[InfinityMobile.view.desktop,"ReaderSpecialSupplements"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderMenu",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px)",right:0,top:40,items:[{itemId:"menuLayout",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{margin:15},scrollable:{direction:"vertical",directionLock:true},items:[{id:"menuShare",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"EDITION OPTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/minimise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"editionOptionsSection",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15},minimized:false,items:[{id:"menuArchive",xtype:"readermenuitem",text:"Archive"},{id:"menuDownload",xtype:"readermenuitem",text:"Download"},{id:"menuSharing",xtype:"readermenushare"}]},{itemId:"menuQuickLinksContainer",layout:"vbox",margin:0,defaults:{padding:15}},{id:"menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"INFO",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuInfoContainer",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;",minimized:true,height:0,items:[{id:"menuHelp",xtype:"readermenuitem",text:"Contact Us"}]}]}]},initializ},headerTa},checkWhatsNewBanne},loadShar}},0,["articlereadermenu"],["component","container","panel","overlay","articlereadermenu"],{component:true,container:true,panel:true,overlay:true,articlereadermenu:true},["widget.articlereadermenu"],0,[InfinityMobile.view.desktop,"ArticleReaderMenu"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemInterstitialContainer",Ext.Container,{config:{cls:"articlereaderiteminterstitialcontainer",layout:{type:"hbox"},style:"margin: 50px;display:inline;"},initializ},onResiz}},0,["articlereaderiteminterstitialcontainer"],["component","container","articlereaderiteminterstitialcontainer"],{component:true,container:true,articlereaderiteminterstitialcontainer:true},["widget.articlereaderiteminterstitialcontainer"],0,[InfinityMobile.view.desktop,"ArticleReaderItemInterstitialContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemInterstitial",Ext.Panel,{config:{style:"padding:5px",cls:"articlereaderiteminterstitial",items:[{itemId:"advert",cls:"advert"}]},initializ},loadAdver},onResize:function(){var a=this;a.onResizeFn()}},0,["articlereaderiteminterstitial"],["component","container","panel","articlereaderiteminterstitial"],{component:true,container:true,panel:true,articlereaderiteminterstitial:true},["widget.articlereaderiteminterstitial"],0,[InfinityMobile.view.desktop,"ArticleReaderItemInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemWeatherTile",Ext.Container,{config:{cls:"articlereaderitemweathertile",style:"float:left;z-index:6;background-color:#90A4B0;",layout:"vbox",items:[{itemId:"title",layout:"vbox",style:"position:absolute;top:0px;left:0px;z-index:10;",items:[{html:"<p class='.thirteen' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;padding:20px 0px 0px 20px;'>WEATHER</p>"},{itemId:"location"},{html:"<p class='ten' style='color:white;font-family:Open Sans, sans-serif;font-size:10px;font-weight:normal;padding:5px 0px 0px 20px;'>Source: BBC Weather</p>"}]},{itemId:"toggle",layout:"hbox",padding:20,style:"position:absolute;top:0px;right:0px;z-index:10;",items:[{html:"<p style='color:white;font-size:13px;padding-right:5px;padding-top:0.2em;'>&deg;C</p>"},{cls:"toggle",itemId:"toggleField",xtype:"togglefield",style:"background:transparent;"},{html:"<p style='color:white;font-size:13px;padding-left:5px;padding-top:0.2em;'>&deg;F</p>"}]},{itemId:"weather",width:"100%",layout:"hbox"},{itemId:"extraDetails",width:"100%",layout:"hbox"}]},initializ},onTa},onResize:function(){var a=this;a.onResizeFn()}},0,["articlereaderitemweathertile"],["component","container","articlereaderitemweathertile"],{component:true,container:true,articlereaderitemweathertile:true},["widget.articlereaderitemweathertile"],0,[InfinityMobile.view.desktop,"ArticleReaderItemWeatherTile"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemTopStoryItem",Ext.Panel,{config:{style:"float:left;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:0,top:0,left:0,right:0,cls:"backgroundImage aspectfill"},{itemId:"title",style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold",bottom:0,top:0,left:0,right:0,height:"100%",padding:10}]},initializ},setBackgroundImage:function(){var c=this;var a=c.article.images;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;left:0px;right;0px;top:0px;bottom:0px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";c.imageAspect=false;if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;'>"+c.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;'>"+c.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;>"+c.article.byline+"</p></div>");c.image=new Image();c.image.src=c.firstImage.url;c.image.onload=function(){if(c.element!=null){var g=c.image.naturalWidth/c.image.naturalHeight;var e=$(c.element.dom).width()/$(c.element.dom).height();if(g<1.25&&e>1.25){c.imageAspect=true;var f=$(c.element.dom).height()/c.image.naturalHeight;var d=c.image.naturalWidth*f;if(d>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}}}},setNoImage:function(){var g=this;g.titleContainer.resetFloating();g.titleContainer.setStyle("background-color:#EEEEEE; color:black;");var f="";if(g.article.sections.length>1){for(var e=0;e<g.article.sections.length;e++){f+=g.article.sections[e]+"/"}f=f.substring(0,f.length-1)}else{if(g.article.sections[0]!=null){f=g.article.sections[0]}}if(g.article.shortStory!=null){var b=g.article.shortStory.replace("<div></div>","");if(b==null){b=""}}else{var b=""}var h=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+g.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+g.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+g.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+b+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});h.element.on({painte},scope:g});g.titleContainer.add(h);if(g.article.body!=null){if(g.article.body.indexOf("<p>")!=-1){g.article.body=g.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var a=localStorage.getItem("bodyFontSize"+publicationguid)}catch(d){var a=null}if(a!=null){var c=a}else{var c=16}g.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:g.article.body,style:"overflow:hidden;font-size:"+c+"px;font-weight:normal;font-family:Open Sans, sans-serif;z-index:16;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var e=this;var h=e.titleContainer.getComponent("title");if(h!=null){var a=h.element.down(".sectionText").dom.clientHeight+h.element.down(".headlineText").dom.clientHeight+h.element.down(".subheadlineText").dom.clientHeight+h.element.down(".bylineText").dom.clientHeight;var c=$(this.element.dom).height()-a;h.element.down(".shortStory").dom.style.maxHeight=(c-(c%14)-26)+"px";if(parseFloat(h.element.down(".bylineText").dom.clientHeight)+parseFloat(h.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".bylineText").dom.style.visibility="hidden";e.bylineHidden=true}else{h.element.down(".bylineText").dom.style.visibility="";e.bylineHidden=false}if(parseFloat(h.element.down(".subheadlineText").dom.clientHeight)+parseFloat(h.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".subheadlineText").dom.style.visibility="hidden";e.subheadlineHidden=true}else{h.element.down(".subheadlineText").dom.style.visibility="";e.subheadlineHidden=false}}if(e.hasImage){var g=e.image.naturalWidth/e.image.naturalHeight;var d=$(e.element.dom).width()/$(e.element.dom).height();if(g<1.3&&d>1.25){e.imageAspect=true;var f=$(e.element.dom).height()/e.image.naturalHeight;var b=e.image.naturalWidth*f;if(b>$(e.element.dom).width()/2){e.imageContainer.element.dom.style.backgroundSize="50%";e.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{e.imageContainer.element.dom.style.backgroundSize=" auto 100%";e.imageContainer.element.dom.style.backgroundPosition="0% 0%"}e.titleContainer.element.down(".tileText").dom.style.bottom="";e.titleContainer.element.down(".tileText").dom.style.top="50%";e.titleContainer.element.down(".tileText").dom.style.left="55%";e.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}else{e.imageAspect=false;e.imageContainer.element.dom.style.backgroundSize="cover";e.imageContainer.element.dom.style.backgroundPosition="50% 0%";e.imageContainer.element.dom.style.backgroundColor="gray";e.titleContainer.element.down(".tileText").dom.style.bottom="10px";e.titleContainer.element.down(".tileText").dom.style.top="";e.titleContainer.element.down(".tileText").dom.style.left="10px";e.titleContainer.element.down(".tileText").dom.style.transform=""}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(q){var v=this;var g=v.parent.parent.element;var x=v.titleContainer.getComponent("title");var l=false;if(l){v.fireEvent("articleClick",v.article,v.article.guid)}else{if(!v.hasImage&&!v.expand){if(v.titleContainer.getComponent("articleBody")!=null){if(v.titleContainer.getComponent("articleBody").isHidden()){v.titleContainer.getComponent("articleBody").show()}else{v.titleContainer.getComponent("articleBody").hide()}}}clearInterval(v.timer);if(!v.expand){v.fireEvent("tileTapped",v);v.titleContainer.setPadding(40);if(v.titleContainer.getComponent("title")!=null){var a=v.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var k=localStorage.getItem("bylineFontSize"+publicationguid)}catch(p){var k=null}if(k!=null){var m=k}else{var m=18}$(".byline").css("font-size",m+"px")}var j=v.element.down(".headlineText");if(j!=null){$(j.dom).attr("class","headline");try{var t=localStorage.getItem("headlineFontSize"+publicationguid)}catch(p){var t=null}if(t!=null){var r=t}else{var r=32}$(".headline").css("font-size",r+"px")}var h=v.element.down(".subheadlineText");if(h!=null){$(h.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(p){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=v.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(p){var b=null}if(b!=null){var s=b}else{var s=18}$(".section").css("font-size",s+"px")}}if(v.article.body.indexOf("<p>")!=-1){v.article.body=v.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(v.hasImage){v.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292;z-index:16;",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(g.dom.scrollHeight),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+v.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+v.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+v.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+v.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+v.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var n=v.articlePop.getComponent("title").element.down("div");n.dom.style.padding="40px";v.sharingImage=v.articlePop.getComponent("title").getComponent("sharing");v.setupSharing(true);v.sharingImage.show();v.imageContainer.hide();v.titleContainer.hide();v.articlePop.getComponent("image").element.dom.style.background="url('"+v.firstImage.url+"')";if(v.imageAspect){v.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";v.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{v.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";v.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}v.add(v.articlePop);try{var u=localStorage.getItem("bodyFontSize"+publicationguid)}catch(p){var u=null}if(u!=null){var w=u}else{var w=16}$(".articleText").css("font-size",w+"px");try{var k=localStorage.getItem("bylineFontSize"+publicationguid)}catch(p){var k=null}if(k!=null){var m=k}else{var m=18}$(".byline").css("font-size",m+"px");try{var t=localStorage.getItem("headlineFontSize"+publicationguid)}catch(p){var t=null}if(t!=null){var r=t}else{var r=32}$(".headline").css("font-size",r+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(p){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(p){var b=null}if(b!=null){var s=b}else{var s=18}$(".section").css("font-size",s+"px");v.articlePop.getComponent("title").element.dom.style.position="relative";v.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){v.articlePop.setScrollable(false);v.desktopScroll=v.element.down(".x-scroll-view");if(v.desktopScroll!=null){v.desktopScroll.dom.style.overflowY="scroll";v.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(v.desktopScroll.down(".x-scroll-container")!=null){$(v.element.dom).on("animationend",function(){v.desktopScroll.down(".x-scroll-container").dom.style.height=(v.articlePop.items.items[0].element.dom.clientHeight+v.articlePop.items.items[1].element.dom.clientHeight+40)+"px"})}}v.stopPropFunction=function(y){y.stopPropagation()};v.element.dom.onmousewheel=v.stopPropFunction;v.element.dom.addEventListener("DOMMouseScroll",v.stopPropFunction)}}else{v.articlePop.getScrollable().getScroller().on({scroll:function(B){var A=v.articlePop.getComponent("image").element.dom.style.height.substring(0,v.articlePop.getComponent("image").element.dom.style.height.length-2);var z=v.articlePop.getScrollable().getScroller().position.y;var y=v.articlePop.getComponent("image").element.dom.style.height.substring(0,v.articlePop.getComponent("image").element.dom.style.height.length-2);if(((A-z)/y)>0){v.articlePop.getComponent("image").element.dom.style.top=(z)+"px";v.articlePop.getComponent("image").element.dom.style.opacity=((A-z)/y)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){v.titleContainer.setScrollable(false);v.desktopScroll=v.element.down(".x-scroll-view");if(v.desktopScroll!=null){v.desktopScroll.dom.style.overflowY="scroll";v.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(v.desktopScroll.down(".x-scroll-container")!=null){$(v.element.dom).on("animationend",function(){if(v.desktopScroll.down(".x-scroll-indicator-dark")!=null){v.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}v.desktopScroll.down(".x-scroll-container").dom.style.height=(v.titleContainer.items.items[0].element.dom.clientHeight+v.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}v.stopPropFunction=function(y){y.stopPropagation()};v.element.dom.onmousewheel=v.stopPropFunction;v.element.dom.addEventListener("DOMMouseScroll",v.stopPropFunction)}}else{v.titleContainer.setScrollable(true);v.titleContainer.getScrollable().getScroller().setDirectionLock(true);var o=v.titleContainer.getScrollable().getScroller()}v.titleContainer.element.dom.style.zIndex=14;if(v.sharingContainer=v.titleContainer.getComponent("title")!=null){v.sharingContainer=v.titleContainer.getComponent("title").getComponent("sharing");v.sharingContainer.show();v.setupSharing(false);v.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none"}if(v.bylineHidden){console.log(v.bylineHidden);x.element.down(".bylineText").dom.style.visibility=""}if(v.subheadlineHidden){x.element.down(".subheadlineText").dom.style.visibility=""}}v.element.dom.style.position="absolute";v.element.dom.style.left="0px",v.element.dom.style.top="0px";g.dom.style.zIndex=8;v.expand=true;g.dom.style.animation=v.expandAnim;v.element.dom.style.animationFillMode="forwards"}else{if(q.target.className.indexOf("x-scroll-view")==-1){if(v.hasImage){v.titleContainer.setPadding(10);if(v.sharingImage!=null){v.sharingImage.hide()}if(v.sharingContainer!=null){if(v.sharingContainer.hide!=null){v.sharingContainer.hide()}}if(v.titleContainer.getComponent("title")!=null){v.titleContainer.setScrollable(false);if(v.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){v.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}if(v.articlePop!=null){v.articlePop.destroy()}v.imageContainer.show();v.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(v.desktopScroll!=null){if(v.desktopScroll.dom!=null){v.desktopScroll.dom.style.overflowY=""}v.element.dom.onmousewheel=null;v.element.dom.removeEventListener("DOMMouseScroll",v.stopPropFunction)}}v.expand=false;g.dom.style.animation=v.shrinkAnim;setTimeout(function(){v.element.dom.style.zIndex=4},300)}else{v.titleContainer.setPadding(10);if(v.sharingImage!=null){v.sharingImage.hide()}if(v.sharingContainer!=null){if(v.sharingContainer.hide!=null){v.sharingContainer.hide()}}if(v.titleContainer.getComponent("title")!=null){v.titleContainer.setScrollable(false);if(v.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){v.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){v.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var j=v.element.down(".headline");if(j!=null){$(j.dom).attr("class","headlineText")}var h=v.element.down(".subheadline");if(h!=null){$(h.dom).attr("class","subheadlineText")}var a=v.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=v.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(v.desktopScroll!=null){v.desktopScroll.dom.style.overflowY="";v.element.dom.onmousewheel=null;v.element.dom.removeEventListener("DOMMouseScroll",v.stopPropFunction);if(Ext.browser.is.IE){v.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}if(v.titleContainer.getComponent("title")!=null){v.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display=""}if(v.bylineHidden){x.element.down(".bylineText").dom.style.visibility="hidden"}if(v.subheadlineHidden){x.element.down(".subheadlineText").dom.style.visibility="hidden"}if(v.titleContainer.getComponent("articleBody")!=null){if(v.titleContainer.getComponent("articleBody").isHidden()){v.titleContainer.getComponent("articleBody").show()}else{v.titleContainer.getComponent("articleBody").hide()}}v.expand=false;g.dom.style.animation=v.shrinkAnim;setTimeout(function(){v.element.dom.style.zIndex=4},300)}}}}},liveTap:function(){var a=this;window.open(a.article.url)},setupTextSize:function(){var o=this;if(o.expand){try{var n=localStorage.getItem("bylineFontSize"+publicationguid)}catch(m){var n=null}if(n!=null){var h=n}else{var h=18}$(".byline").css("font-size",h+"px");try{var c=localStorage.getItem("headlineFontSize"+publicationguid)}catch(m){var c=null}if(c!=null){var p=c}else{var p=32}$(".headline").css("font-size",p+"px");try{var b=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(m){var b=null}if(b!=null){var k=b}else{var k=20}$(".subheadline").css("font-size",k+"px");try{var g=localStorage.getItem("sectionFontSize"+publicationguid)}catch(m){var g=null}if(g!=null){var f=g}else{var f=18}$(".section").css("font-size",f+"px");try{var e=localStorage.getItem("bodyFontSize"+publicationguid)}catch(m){var e=null}if(e!=null){var a=e}else{var a=16}$(".articleText").css("font-size",a+"px")}else{if(!o.hasImage){if(o.element!=null){var d=o.element.down(".headline");if(d!=null){$(d.dom).attr("class","headlineText")}var l=o.element.down(".subheadline");if(l!=null){$(l.dom).attr("class","subheadlineText")}var j=o.element.down(".byline");if(j!=null){$(j.dom).attr("class","bylineText")}var q=o.element.down(".section");if(q!=null){$(q.dom).attr("class","sectionText")}}}}},testFunc:function(){console.log("TEST")}},0,["articlereaderitemtopstoryitem"],["component","container","panel","articlereaderitemtopstoryitem"],{component:true,container:true,panel:true,articlereaderitemtopstoryitem:true},["widget.articlereaderitemtopstoryitem"],0,[InfinityMobile.view.desktop,"ArticleReaderItemTopStoryItem"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemTopStories",Ext.Container,{config:{width:"768px",style:"float:left;z-index:6;background-color:black;",items:[{itemId:"leftBtn",width:30,height:66.6,style:"background-image:url('../assets/nav/left-arrow.png');position:absolute;left:5px;top:50%;transform:translateY(-50%);background-size:contain;background-repeat:no-repeat;z-index:7;"},{itemId:"carousel",xtype:"carousel",top:5,bottom:5,left:5,right:5,style:"z-index:6;"},{itemId:"rightBtn",width:30,height:66.6,style:"background-image:url('../assets/nav/right-arrow.png');position:absolute;right:5px;top:50%;transform:translateY(-50%);background-size:contain;background-repeat:no-repeat;z-index:7;"}]},initializ},leftScroll:function(){var a=this;a.carousel.previous()},rightScrol},handleItemChang},onTa}},0,["articlereaderitemtopstories"],["component","container","articlereaderitemtopstories"],{component:true,container:true,articlereaderitemtopstories:true},["widget.articlereaderitemtopstories"],0,[InfinityMobile.view.desktop,"ArticleReaderItemTopStories"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticlePopoverItemDynamic",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",style:"background-color:white",layout:"vbox",items:[{itemId:"content",flex:1,padding:"0 0 10px 0",style:"overflow-y:scroll;"}]},initializ},setContentStyl},getConten},removeSpinner:function(){var a=this;a.removeCls("loading")},setImage}},0,["readerarticlepopoveritemdynamic"],["component","container","readerarticlepopoveritemdynamic"],{component:true,container:true,readerarticlepopoveritemdynamic:true},["widget.readerarticlepopoveritemdynamic"],0,[InfinityMobile.view.desktop,"ArticlePopoverItemDynamic"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemMedWideTall",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;",height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setStyle("height:45%;overflow:hidden;width:512px;");a.height=45;a.width=512;a.x=a.element.dom.style.left.substring(0,a.element.dom.style.left.length-2);a.y=a.element.dom.style.top.substring(0,a.element.dom.style.top.length-1);a.top=a.y;a.left=a.x;a.timer;a.timer2;a.timer3;a.timer4;a.section=a.getComponent("section");a.height=a.element.dom.clientHeight;if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";c.imageAspect=false;if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;'>"+c.article.headline+"</p></div>");c.image=new Image();c.image.src=c.firstImage.url;c.image.onload=function(){var g=c.image.naturalWidth/c.image.naturalHeight;if(c.element!=null){var e=$(c.element.dom).width()/$(c.element.dom).height();if(g<1.2&&e>1.25){c.imageAspect=true;var f=$(c.element.dom).height()/c.image.naturalHeight;var d=c.image.naturalWidth*f;if(d>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}}};if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}},setNoImage:function(){var f=this;f.titleContainer.resetFloating();f.titleContainer.setStyle("background-color:#EEEEEE; color:black;");f.hasImage=false;f.sectionStr="";if(f.article.sections.length>1){for(var e=0;e<f.article.sections.length;e++){f.sectionStr+=f.article.sections[e]+"/"}f.sectionStr=f.sectionStr.substring(0,f.sectionStr.length-1)}else{if(f.article.sections[0]!=null){f.sectionStr=f.article.sections[0]}}if(f.article.shortStory!=null){var b=f.article.shortStory.replace("<div></div>","");if(b==null){b=""}}else{var b=""}if(f.sectionStr=="LIVE NEWS"){if(f.article.link!=null){if(f.article.link.length>0){f.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+f.article.link+"\")' onclick='window.open(\""+f.article.link+"\")'>Click here to view full story</p>"}}}var g=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+f.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+f.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+f.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+b+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});g.element.on({painted:function(){if(!f.paintedTitle){var h=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var j=$(this.element.dom).height()-h;g.element.down(".shortStory").dom.style.maxHeight=(j-(j%14)-26)+"px";if(g.element.down(".bylineText").dom.clientHeight+g.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}if(g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadline=true}f.paintedTitle=true}},scope:f});f.titleContainer.add(g);if(f.article.body!=null){if(f.article.body.indexOf("<p>")!=-1){f.article.body=f.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var a=localStorage.getItem("bodyFontSize"+publicationguid)}catch(d){var a=null}if(a!=null){var c=a}else{var c=16}f.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:f.article.body,style:"overflow:hidden;font-size:"+c+"px;font-weight:normal;font-family:Open Sans, sans-serif;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var e=this;var h=e.titleContainer.getComponent("title");if(h!=null){var a=h.element.down(".sectionText").dom.clientHeight+h.element.down(".headlineText").dom.clientHeight+h.element.down(".subheadlineText").dom.clientHeight+h.element.down(".bylineText").dom.clientHeight;var c=$(this.element.dom).height()-a;h.element.down(".shortStory").dom.style.maxHeight=(c-(c%14)-26)+"px";if(parseFloat(h.element.down(".bylineText").dom.clientHeight)+parseFloat(h.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".bylineText").dom.style.visibility="hidden";e.bylineHidden=true}else{h.element.down(".bylineText").dom.style.visibility="";e.bylineHidden=false}if(parseFloat(h.element.down(".subheadlineText").dom.clientHeight)+parseFloat(h.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".subheadlineText").dom.style.visibility="hidden";e.subheadline=true}else{h.element.down(".subheadlineText").dom.style.visibility="";e.subheadlineHidden=false}}if(e.hasImage){var g=e.image.naturalWidth/e.image.naturalHeight;var d=$(e.element.dom).width()/$(e.element.dom).height();if(g<1.2&&d>1.25){e.imageAspect=true;var f=$(e.element.dom).height()/e.image.naturalHeight;var b=e.image.naturalWidth*f;if(b>$(e.element.dom).width()/2){e.imageContainer.element.dom.style.backgroundSize="50%";e.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{e.imageContainer.element.dom.style.backgroundSize=" auto 100%";e.imageContainer.element.dom.style.backgroundPosition="0% 0%"}e.titleContainer.element.down(".tileText").dom.style.bottom="";e.titleContainer.element.down(".tileText").dom.style.top="50%";e.titleContainer.element.down(".tileText").dom.style.left="55%";e.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}else{e.imageAspect=false;e.imageContainer.element.dom.style.backgroundSize="cover";e.imageContainer.element.dom.style.backgroundPosition="50% 0%";e.imageContainer.element.dom.style.backgroundColor="gray";e.titleContainer.element.down(".tileText").dom.style.bottom="10px";e.titleContainer.element.down(".tileText").dom.style.top="";e.titleContainer.element.down(".tileText").dom.style.left="10px";e.titleContainer.element.down(".tileText").dom.style.transform=""}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(p){var u=this;var w=u.titleContainer.getComponent("title");var k=false;if(k&&u.sectionStr.indexOf("LIVE NEWS")==-1){u.fireEvent("articleClick",u.article,u.article.guid)}else{if(k&&u.sectionStr.indexOf("LIVE NEWS")!=1){u.fireEvent("liveArticleClick",u.article)}else{if(!u.hasImage&&!u.expand){if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}}clearInterval(u.timer);clearInterval(u.timer2);clearInterval(u.timer3);clearInterval(u.timer);if(!u.expand){u.fireEvent("tileTapped",u);u.titleContainer.setPadding(40);if(u.titleContainer.getComponent("title")!=null){var a=u.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px")}var h=u.element.down(".headlineText");if(h!=null){$(h.dom).attr("class","headline");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px")}var g=u.element.down(".subheadlineText");if(g!=null){$(g.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=u.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px")}}if(u.article.body.indexOf("<p>")!=-1){u.article.body=u.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(u.hasImage){u.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(u.imageContainer.element.dom.scrollHeight*1.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+u.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+u.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+u.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+u.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+u.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var m=u.articlePop.getComponent("title").element.down("div");m.dom.style.padding="40px";u.sharingImage=u.articlePop.getComponent("title").getComponent("sharing");u.setupSharing(true);u.sharingImage.show();u.imageContainer.hide();u.titleContainer.hide();u.articlePop.getComponent("image").element.dom.style.background="url('"+u.firstImage.url+"')";if(u.imageAspect){u.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{u.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}u.add(u.articlePop);try{var t=localStorage.getItem("bodyFontSize"+publicationguid)}catch(o){var t=null}if(t!=null){var v=t}else{var v=16}$(".articleText").css("font-size",v+"px");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px");u.articlePop.getComponent("title").element.dom.style.position="relative";u.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.articlePop.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.articlePop.items.items[0]!=null&&u.articlePop.items.items[1]!=null){u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.articlePop.items.items[0].element.dom.clientHeight+u.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.articlePop.getScrollable().getScroller().on({scroll:function(A){var z=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);var y=u.articlePop.getScrollable().getScroller().position.y;var x=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);if(((z-y)/x)>0){u.articlePop.getComponent("image").element.dom.style.top=(y)+"px";u.articlePop.getComponent("image").element.dom.style.opacity=((z-y)/x)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.titleContainer.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.desktopScroll.down(".x-scroll-indicator-dark")!=null){u.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.titleContainer.items.items[0].element.dom.clientHeight+u.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.titleContainer.setScrollable(true);u.titleContainer.getScrollable().getScroller().setDirectionLock(true);var n=u.titleContainer.getScrollable().getScroller();n.container.dom.offsetParent.style.zIndex=14}u.sharingContainer=u.titleContainer.getComponent("title").getComponent("sharing");u.sharingContainer.show();u.setupSharing(false);u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(u.bylineHidden){console.log(u.bylineHidden);w.element.down(".bylineText").dom.style.visibility=""}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility=""}}u.element.dom.style.zIndex=10;u.expand=true;u.element.dom.style.animation=u.expandAnim;u.element.dom.style.animationFillMode="forwards"}else{if(p.target.className.indexOf("x-scroll-view")==-1&&p.target.className.indexOf("fullStoryLink")==-1){if(u.hasImage){u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}u.articlePop.destroy();u.imageContainer.show();u.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction)}}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}else{u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var h=u.element.down(".headline");if(h!=null){$(h.dom).attr("class","headlineText")}var g=u.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var a=u.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=u.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="";u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction);if(Ext.browser.is.IE){u.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(u.bylineHidden){w.element.down(".bylineText").dom.style.visibility="hidden"}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility="hidden"}if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemmedwidetall"],["component","container","panel","articlereaderitemmedwidetall"],{component:true,container:true,panel:true,articlereaderitemmedwidetall:true},["widget.articlereaderitemmedwidetall"],0,[InfinityMobile.view.desktop,"ArticleReaderItemMedWideTall"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemMedTall",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;",height:"100%"}]},initializ},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}c.titleContainer.setHtml("<div style='position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;'>"+c.article.headline+"</p></div>")},setNoImage:function(){var f=this;f.titleContainer.resetFloating();f.titleContainer.setStyle("background-color:#EEEEEE; color:black;");f.hasImage=false;f.sectionStr="";if(f.article.sections.length>1){for(var e=0;e<f.article.sections.length;e++){f.sectionStr+=f.article.sections[e]+"/"}f.sectionStr=f.sectionStr.substring(0,f.sectionStr.length-1)}else{if(f.article.sections[0]!=null){f.sectionStr=f.article.sections[0]}}if(f.article.shortStory!=null){var b=f.article.shortStory.replace("<div></div>","");if(b==null){b=""}}else{var b=""}if(f.sectionStr=="LIVE NEWS"){if(f.article.link!=null){if(f.article.link.length>0){f.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+f.article.link+"\")' onclick='window.open(\""+f.article.link+"\")'>Click here to view full story</p>"}}}var g=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+f.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+f.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+f.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+b+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});g.element.on({painted:function(){if(!f.paintedTitle){var h=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var j=$(this.element.dom).height()-h;g.element.down(".shortStory").dom.style.maxHeight=(j-(j%14)-26)+"px";if(g.element.down(".bylineText").dom.clientHeight+g.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}if(g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadline=true}f.paintedTitle=true}},scope:f});f.titleContainer.add(g);if(f.article.body!=null){if(f.article.body.indexOf("<p>")!=-1){f.article.body=f.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var a=localStorage.getItem("bodyFontSize"+publicationguid)}catch(d){var a=null}if(a!=null){var c=a}else{var c=16}f.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:f.article.body,style:"overflow:hidden;font-size:"+c+"px;font-weight:normal;font-family:Open Sans, sans-serif;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resiz},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(p){var u=this;var w=u.titleContainer.getComponent("title");var k=false;if(k&&u.sectionStr.indexOf("LIVE NEWS")==-1){u.fireEvent("articleClick",u.article,u.article.guid)}else{if(k&&u.sectionStr.indexOf("LIVE NEWS")!=1){u.fireEvent("liveArticleClick",u.article)}else{if(!u.hasImage&&!u.expand){if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}}clearInterval(u.timer);clearInterval(u.timer2);clearInterval(u.timer3);clearInterval(u.timer);if(!u.expand){u.fireEvent("tileTapped",u);u.titleContainer.setPadding(40);if(u.titleContainer.getComponent("title")!=null){var a=u.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px")}var h=u.element.down(".headlineText");if(h!=null){$(h.dom).attr("class","headline");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px")}var g=u.element.down(".subheadlineText");if(g!=null){$(g.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=u.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px")}}if(u.article.body.indexOf("<p>")!=-1){u.article.body=u.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(u.hasImage){u.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(u.imageContainer.element.dom.scrollHeight*1.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+u.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+u.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+u.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+u.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+u.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var m=u.articlePop.getComponent("title").element.down("div");m.dom.style.padding="40px";u.sharingImage=u.articlePop.getComponent("title").getComponent("sharing");u.setupSharing(true);u.sharingImage.show();u.imageContainer.hide();u.titleContainer.hide();u.articlePop.getComponent("image").element.dom.style.background="url('"+u.firstImage.url+"')";u.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%";u.add(u.articlePop);try{var t=localStorage.getItem("bodyFontSize"+publicationguid)}catch(o){var t=null}if(t!=null){var v=t}else{var v=16}$(".articleText").css("font-size",v+"px");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px");u.articlePop.getComponent("title").element.dom.style.position="relative";u.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.articlePop.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.articlePop.items.items[0]!=null&&u.articlePop.items.items[1]!=null){u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.articlePop.items.items[0].element.dom.clientHeight+u.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.articlePop.getScrollable().getScroller().on({scroll:function(A){var z=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);var y=u.articlePop.getScrollable().getScroller().position.y;var x=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);if(((z-y)/x)>0){u.articlePop.getComponent("image").element.dom.style.top=(y)+"px";u.articlePop.getComponent("image").element.dom.style.opacity=((z-y)/x)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.titleContainer.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.desktopScroll.down(".x-scroll-indicator-dark")!=null){u.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.titleContainer.items.items[0].element.dom.clientHeight+u.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.titleContainer.setScrollable(true);u.titleContainer.getScrollable().getScroller().setDirectionLock(true);var n=u.titleContainer.getScrollable().getScroller();n.container.dom.offsetParent.style.zIndex=14}u.sharingContainer=u.titleContainer.getComponent("title").getComponent("sharing");u.sharingContainer.show();u.setupSharing(false);u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(u.bylineHidden){console.log(u.bylineHidden);w.element.down(".bylineText").dom.style.visibility=""}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility=""}}u.element.dom.style.zIndex=8;u.expand=true;u.element.dom.style.animation=u.expandAnim;u.element.dom.style.animationFillMode="forwards"}else{if(p.target.className.indexOf("x-scroll-view")==-1&&p.target.className.indexOf("fullStoryLink")==-1){if(u.hasImage){u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}u.articlePop.destroy();u.imageContainer.show();u.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction)}}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}else{u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var h=u.element.down(".headline");if(h!=null){$(h.dom).attr("class","headlineText")}var g=u.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var a=u.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=u.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="";u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction);if(Ext.browser.is.IE){u.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(u.bylineHidden){w.element.down(".bylineText").dom.style.visibility="hidden"}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility="hidden"}if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemmedtall"],["component","container","panel","articlereaderitemmedtall"],{component:true,container:true,panel:true,articlereaderitemmedtall:true},["widget.articlereaderitemmedtall"],0,[InfinityMobile.view.desktop,"ArticleReaderItemMedTall"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemMedWide",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;",height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setStyle("height:30%;overflow:hidden;width:512px;");a.height=30;a.width=512;a.x=a.element.dom.style.left.substring(0,a.element.dom.style.left.length-2);a.y=a.element.dom.style.top.substring(0,a.element.dom.style.top.length-1);a.top=a.y;a.left=a.x;a.timer;a.timer2;a.timer3;a.timer4;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImag},setNoImage:function(){var f=this;f.titleContainer.resetFloating();f.titleContainer.setStyle("background-color:#EEEEEE; color:black;");f.sectionStr="";if(f.article.sections.length>1){for(var e=0;e<f.article.sections.length;e++){f.sectionStr+=f.article.sections[e]+"/"}f.sectionStr=f.sectionStr.substring(0,sectionStr.length-1)}else{if(f.article.sections[0]!=null){f.sectionStr=f.article.sections[0]}}if(f.article.shortStory!=null){var b=f.article.shortStory.replace("<div></div>","");if(b==null){b=""}}else{var b=""}if(f.sectionStr=="LIVE NEWS"){if(f.article.link!=null){if(f.article.link.length>0){f.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+f.article.link+"\")' onclick='window.open(\""+f.article.link+"\")'>Click here to view full story</p>"}}}var g=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+f.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+f.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+f.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+b+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});g.element.on({painted:function(){if(!f.paintedTitle){var h=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var j=$(this.element.dom).height()-h;g.element.down(".shortStory").dom.style.maxHeight=(j-(j%14)-26)+"px";if(g.element.down(".bylineText").dom.clientHeight+g.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}if(g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadlineHidden=true}f.paintedTitle=true}},scope:f});f.titleContainer.add(g);if(f.article.body!=null){if(f.article.body.indexOf("<p>")!=-1){f.article.body=f.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var a=localStorage.getItem("bodyFontSize"+publicationguid)}catch(d){var a=null}if(a!=null){var c=a}else{var c=16}f.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:f.article.body,style:"overflow:hidden;font-size:"+c+"px;font-weight:normal;font-family:Open Sans, sans-serif;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var e=this;var h=e.titleContainer.getComponent("title");if(h!=null){var a=h.element.down(".sectionText").dom.clientHeight+h.element.down(".headlineText").dom.clientHeight+h.element.down(".subheadlineText").dom.clientHeight+h.element.down(".bylineText").dom.clientHeight;var c=$(this.element.dom).height()-a;h.element.down(".shortStory").dom.style.maxHeight=(c-(c%14)-26)+"px";if(parseFloat(h.element.down(".bylineText").dom.clientHeight)+parseFloat(h.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".bylineText").dom.style.visibility="hidden";e.bylineHidden=true}else{h.element.down(".bylineText").dom.style.visibility="";e.bylineHidden=false}if(parseFloat(h.element.down(".subheadlineText").dom.clientHeight)+parseFloat(h.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".subheadlineText").dom.style.visibility="hidden";e.subheadlineHidden=true}else{h.element.down(".subheadlineText").dom.style.visibility="";e.subheadlineHidden=false}}if(e.hasImage){var g=e.image.naturalWidth/e.image.naturalHeight;var d=$(e.element.dom).width()/$(e.element.dom).height();if(g<1.2&&d>1.25){e.imageAspect=true;var f=$(e.element.dom).height()/e.image.naturalHeight;var b=e.image.naturalWidth*f;if(b>$(e.element.dom).width()/2){e.imageContainer.element.dom.style.backgroundSize="50%";e.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{e.imageContainer.element.dom.style.backgroundSize=" auto 100%";e.imageContainer.element.dom.style.backgroundPosition="0% 0%"}e.titleContainer.element.down(".tileText").dom.style.bottom="";e.titleContainer.element.down(".tileText").dom.style.top="50%";e.titleContainer.element.down(".tileText").dom.style.left="55%";e.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}else{e.imageAspect=false;e.imageContainer.element.dom.style.backgroundSize="cover";e.imageContainer.element.dom.style.backgroundPosition="50% 0%";e.imageContainer.element.dom.style.backgroundColor="gray";e.titleContainer.element.down(".tileText").dom.style.bottom="10px";e.titleContainer.element.down(".tileText").dom.style.top="";e.titleContainer.element.down(".tileText").dom.style.left="10px";e.titleContainer.element.down(".tileText").dom.style.transform=""}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(p){var u=this;var k=false;var w=u.titleContainer.getComponent("title");if(k&&u.sectionStr.indexOf("LIVE NEWS")==-1){u.fireEvent("articleClick",u.article,u.article.guid)}else{if(k&&u.sectionStr.indexOf("LIVE NEWS")!=1){u.fireEvent("liveArticleClick",u.article)}else{if(!u.hasImage&&!u.expand){if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}}clearInterval(u.timer);clearInterval(u.timer2);clearInterval(u.timer3);clearInterval(u.timer);if(!u.expand){u.fireEvent("tileTapped",u);u.titleContainer.setPadding(40);if(u.titleContainer.getComponent("title")!=null){var a=u.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px")}var h=u.element.down(".headlineText");if(h!=null){$(h.dom).attr("class","headline");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px")}var g=u.element.down(".subheadlineText");if(g!=null){$(g.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=u.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px")}}if(u.article.body.indexOf("<p>")!=-1){u.article.body=u.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(u.hasImage){u.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(u.imageContainer.element.dom.scrollHeight*1.5),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+u.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+u.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+u.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+u.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+u.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var m=u.articlePop.getComponent("title").element.down("div");m.dom.style.padding="40px";u.sharingImage=u.articlePop.getComponent("title").getComponent("sharing");u.setupSharing(true);u.sharingImage.show();u.imageContainer.hide();u.titleContainer.hide();u.articlePop.getComponent("image").element.dom.style.background="url('"+u.firstImage.url+"')";if(u.imageAspect){u.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{u.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}u.add(u.articlePop);try{var t=localStorage.getItem("bodyFontSize"+publicationguid)}catch(o){var t=null}if(t!=null){var v=t}else{var v=16}$(".articleText").css("font-size",v+"px");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px");u.articlePop.getComponent("title").element.dom.style.position="relative";u.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.articlePop.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.articlePop.items.items[0]!=null&&u.articlePop.items.items[1]!=null){u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.articlePop.items.items[0].element.dom.clientHeight+u.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.articlePop.getScrollable().getScroller().on({scroll:function(A){var z=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);var y=u.articlePop.getScrollable().getScroller().position.y;var x=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);if(((z-y)/x)>0){u.articlePop.getComponent("image").element.dom.style.top=(y)+"px";u.articlePop.getComponent("image").element.dom.style.opacity=((z-y)/x)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.titleContainer.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.desktopScroll.down(".x-scroll-indicator-dark")!=null){u.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.titleContainer.items.items[0].element.dom.clientHeight+u.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.titleContainer.setScrollable(true);u.titleContainer.getScrollable().getScroller().setDirectionLock(true);var n=u.titleContainer.getScrollable().getScroller();n.container.dom.offsetParent.style.zIndex=14}u.sharingContainer=u.titleContainer.getComponent("title").getComponent("sharing");u.sharingContainer.show();u.setupSharing(false);u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(u.bylineHidden){console.log(u.bylineHidden);w.element.down(".bylineText").dom.style.visibility=""}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility=""}}u.element.dom.style.zIndex=10;u.expand=true;u.element.dom.style.animation=u.expandAnim;u.element.dom.style.animationFillMode="forwards"}else{if(p.target.className.indexOf("x-scroll-view")==-1&&p.target.className.indexOf("fullStoryLink")==-1){if(u.hasImage){u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}u.articlePop.destroy();u.imageContainer.show();u.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction)}}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}else{u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var h=u.element.down(".headline");if(h!=null){$(h.dom).attr("class","headlineText")}var g=u.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var a=u.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=u.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="";u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction);if(Ext.browser.is.IE){u.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(u.bylineHidden){w.element.down(".bylineText").dom.style.visibility="hidden"}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility="hidden"}if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemmedwide"],["component","container","panel","articlereaderitemmedwide"],{component:true,container:true,panel:true,articlereaderitemmedwide:true},["widget.articlereaderitemmedwide"],0,[InfinityMobile.view.desktop,"ArticleReaderItemMedWide"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderBannerAd",Ext.Panel,{config:{style:"padding:0px:overflow:none;",width:"100%",items:[{itemId:"advert",cls:"advert",style:"position:absolute;top:50%;left:50%;transform:translate3d(-50%, -50%, 0px);"}]},initializ},loadAdver},onResizeF}},0,["articlereaderbannerad"],["component","container","panel","articlereaderbannerad"],{component:true,container:true,panel:true,articlereaderbannerad:true},["widget.articlereaderbannerad"],0,[InfinityMobile.view.desktop,"ArticleReaderBannerAd"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemContainer",Ext.Container,{config:{height:"80%",width:768}},0,["articlereaderitemcontainer"],["component","container","articlereaderitemcontainer"],{component:true,container:true,articlereaderitemcontainer:true},["widget.articlereaderitemcontainer"],0,[InfinityMobile.view.desktop,"ArticleReaderItemContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemSmall",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;z-index:7;overflow:hidden;height:30% !important;width: 256px !important",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;",height:"100%"}]},initializ},setBackgroundImag},setNoImage:function(){var f=this;f.titleContainer.resetFloating();f.titleContainer.setStyle("background-color:#EEEEEE; color:black;overflow:hidden;");f.sectionStr="";if(f.article.sections.length>1){for(var e=0;e<f.article.sections.length;e++){f.sectionStr+=f.article.sections[e]+"/"}f.sectionStr=f.sectionStr.substring(0,sectionStr.length-1)}else{if(f.article.sections[0]!=null){f.sectionStr=f.article.sections[0]}}if(f.article.shortStory!=null){var b=f.article.shortStory.replace("<div></div>","");if(b==null){b=""}}else{var b=""}if(f.sectionStr=="LIVE NEWS"){if(f.article.link!=null){if(f.article.link.length>0){f.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+f.article.link+"\")' onclick='window.open(\""+f.article.link+"\")'>Click here to view full story</p>"}}}var g=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+f.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;'>"+f.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;margin-bottom:5px;'>"+f.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px !important;font-weight:normal !important;'>"+b+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});g.element.on({painte},scope:f});f.titleContainer.add(g);if(f.article.body!=null){if(f.article.body.indexOf("<p>")!=-1){f.article.body=f.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var a=localStorage.getItem("bodyFontSize"+publicationguid)}catch(d){var a=null}if(a!=null){var c=a}else{var c=16}f.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:f.article.body,style:"overflow:hidden;font-size:"+c+"px;font-weight:normal;font-family:Open Sans, sans-serif;padding-bottom:5px;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resiz},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(p){var u=this;var k=false;var w=u.titleContainer.getComponent("title");if(k&&u.sectionStr.indexOf("LIVE NEWS")==-1){u.fireEvent("articleClick",u.article,u.article.guid)}else{if(k&&u.sectionStr.indexOf("LIVE NEWS")!=1){u.fireEvent("liveArticleClick",u.article)}else{if(!u.hasImage&&!u.expand){if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}}clearInterval(u.timer);clearInterval(u.timer2);clearInterval(u.timer3);clearInterval(u.timer);if(!u.expand){u.fireEvent("tileTapped",u);u.titleContainer.setPadding(40);if(u.titleContainer.getComponent("title")!=null){var a=u.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px")}var h=u.element.down(".headlineText");if(h!=null){$(h.dom).attr("class","headline");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px")}var g=u.element.down(".subheadlineText");if(g!=null){$(g.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=u.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px")}}if(u.article.body.indexOf("<p>")!=-1){u.article.body=u.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(u.hasImage){u.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(u.imageContainer.element.dom.scrollHeight*2.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+u.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+u.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+u.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+u.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-weight:normal;'>"+u.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var m=u.articlePop.getComponent("title").element.down("div");m.dom.style.padding="40px";u.sharingImage=u.articlePop.getComponent("title").getComponent("sharing");u.setupSharing(true);u.sharingImage.show();u.imageContainer.hide();u.titleContainer.hide();u.articlePop.getComponent("image").element.dom.style.background="url('"+u.firstImage.url+"')";u.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%";u.add(u.articlePop);try{var t=localStorage.getItem("bodyFontSize"+publicationguid)}catch(o){var t=null}if(t!=null){var v=t}else{var v=16}$(".articleText").css("font-size",v+"px");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px");u.articlePop.getComponent("title").element.dom.style.position="relative";u.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.articlePop.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.articlePop.items.items[0]!=null&&u.articlePop.items.items[1]!=null){u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.articlePop.items.items[0].element.dom.clientHeight+u.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.articlePop.getScrollable().getScroller().on({scroll:function(A){var z=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);var y=u.articlePop.getScrollable().getScroller().position.y;var x=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);if(((z-y)/x)>0){u.articlePop.getComponent("image").element.dom.style.top=(y)+"px";u.articlePop.getComponent("image").element.dom.style.opacity=((z-y)/x)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.titleContainer.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.titleContainer.setScrollable(true);u.titleContainer.getScrollable().getScroller().setDirectionLock(true);var n=u.titleContainer.getScrollable().getScroller();n.container.dom.offsetParent.style.zIndex=14}u.sharingContainer=u.titleContainer.getComponent("title").getComponent("sharing");u.sharingContainer.show();u.setupSharing(false);u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(u.bylineHidden&&w.element.down(".bylineText")!=null){w.element.down(".bylineText").dom.style.visibility=""}if(u.subheadlineHidden&&w.element.down(".subheadlineText")!=null){w.element.down(".subheadlineText").dom.style.visibility=""}}u.element.dom.style.position="absolute";u.element.dom.style.zIndex=10;u.expand=true;u.element.dom.style.mozAnimation=u.expandAnim;u.element.dom.style.animation=u.expandAnim;u.element.dom.style.animationFillMode="forwards"}else{if(p.target.className.indexOf("x-scroll-view")==-1&&p.target.className.indexOf("fullStoryLink")==-1){if(u.hasImage){u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}u.articlePop.destroy();u.imageContainer.show();u.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction)}}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}else{u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}var h=u.element.down(".headline");if(h!=null){$(h.dom).attr("class","headlineText")}var g=u.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var a=u.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=u.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="";u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction);if(Ext.browser.is.IE){u.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(u.bylineHidden){w.element.down(".bylineText").dom.style.visibility="hidden"}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility="hidden"}if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemsmall"],["component","container","panel","articlereaderitemsmall"],{component:true,container:true,panel:true,articlereaderitemsmall:true},["widget.articlereaderitemsmall"],0,[InfinityMobile.view.desktop,"ArticleReaderItemSmall"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemLrg",Ext.Panel,{config:{padding:5,style:"float:left;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold",padding:10,height:"100%"}]},initializ},setBackgroundImag},setNoImage:function(){var f=this;f.titleContainer.resetFloating();f.titleContainer.setStyle("background-color:#EEEEEE; color:black;");f.sectionStr="";if(f.article.sections.length>1){for(var d=0;d<f.article.sections.length;d++){f.sectionStr+=f.article.sections[d]+"/"}f.sectionStr=f.sectionStr.substring(0,sectionStr.length-1)}else{if(f.article.sections[0]!=null){f.sectionStr=f.article.sections[0]}}if(f.article.shortStory!=null){var a=f.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(f.sectionStr=="LIVE NEWS"){if(f.article.link!=null){if(f.article.link.length>0){f.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+f.article.link+"\")' onclick='window.open(\""+f.article.link+"\")'>Click here to view full story</p>"}}}var g=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+f.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+f.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+f.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});g.element.on({painte},scope:f});f.titleContainer.add(g);if(f.article.body!=null){if(f.article.body.indexOf("<p>")!=-1){f.article.body=f.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var e=localStorage.getItem("bodyFontSize"+publicationguid)}catch(c){var e=null}if(e!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}f.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",width:"100%",html:f.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",flex:1,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resiz},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(p){var u=this;var w=u.titleContainer.getComponent("title");var k=false;if(k&&u.sectionStr.indexOf("LIVE NEWS")==-1){u.fireEvent("articleClick",u.article,u.article.guid)}else{if(k&&u.sectionStr.indexOf("LIVE NEWS")!=1){u.fireEvent("liveArticleClick",u.article)}else{if(!u.hasImage&&!u.expand){if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}}clearInterval(u.timer);if(!u.expand){u.fireEvent("tileTapped",u);u.titleContainer.setPadding(40);if(u.titleContainer.getComponent("title")!=null){var a=u.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px")}var h=u.element.down(".headlineText");if(h!=null){$(h.dom).attr("class","headline");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px")}var g=u.element.down(".subheadlineText");if(g!=null){$(g.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=u.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px")}}if(u.article.body.indexOf("<p>")!=-1){u.article.body=u.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(u.hasImage){u.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(u.imageContainer.element.dom.scrollHeight*1.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+u.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+u.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+u.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+u.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+u.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var m=u.articlePop.getComponent("title").element.down("div");m.dom.style.padding="40px";u.sharingImage=u.articlePop.getComponent("title").getComponent("sharing");u.setupSharing(true);u.sharingImage.show();u.imageContainer.hide();u.titleContainer.hide();u.articlePop.getComponent("image").element.dom.style.background="url('"+u.firstImage.url+"')";if(u.imageAspect){u.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{u.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}u.add(u.articlePop);try{var t=localStorage.getItem("bodyFontSize"+publicationguid)}catch(o){var t=null}if(t!=null){var v=t}else{var v=16}$(".articleText").css("font-size",v+"px");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px");u.articlePop.getComponent("title").element.dom.style.position="relative";u.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.articlePop.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.articlePop.getScrollable().getScroller().on({scrol}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.titleContainer.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend})}}u.stopPropFunctio};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.titleContainer.setScrollable(true);u.titleContainer.getScrollable().getScroller().setDirectionLock(true);var n=u.titleContainer.getScrollable().getScroller();n.container.dom.offsetParent.style.zIndex=14}u.sharingContainer=u.titleContainer.getComponent("title").getComponent("sharing");u.sharingContainer.show();u.setupSharing(false);u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(u.bylineHidden){console.log(u.bylineHidden);w.element.down(".bylineText").dom.style.visibility=""}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility=""}}u.element.dom.style.position="absolute";u.element.dom.style.left="0px",u.element.dom.style.top="0px";u.element.dom.style.zIndex=8;u.expand=true;u.element.dom.style.animation=u.expandAnim;u.element.dom.style.animationFillMode="forwards"}else{if(p.target.className.indexOf("x-scroll-view")==-1&&p.target.className.indexOf("fullStoryLink")==-1){if(u.hasImage){u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}u.articlePop.destroy();u.imageContainer.show();u.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction)}}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}else{u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){1;u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var h=u.element.down(".headline");if(h!=null){$(h.dom).attr("class","headlineText")}var g=u.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var a=u.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=u.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="";u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction);if(Ext.browser.is.IE){u.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(u.bylineHidden){w.element.down(".bylineText").dom.style.visibility="hidden"}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility="hidden"}if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeou},300)}}}}}},liveTa}},0,["articlereaderitemlrg"],["component","container","panel","articlereaderitemlrg"],{component:true,container:true,panel:true,articlereaderitemlrg:true},["widget.articlereaderitemlrg"],0,[InfinityMobile.view.desktop,"ArticleReaderItemLrg"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderArticlePopover",Ext.Container,{config:{style:"padding:0px; border-radius:0px; background-color:white;",articleguid:"a3d9d9eb-36b5-46b6-94ee-31978e22dc78",cls:"articlepopover",fullscreen:true,modal:true,centered:true,hideOnMaskTap:true,height:"80%",width:"80%",maxHeight:768,maxWidth:1024,layout:"vbox",zIndex:20,items:[{itemId:"tooltiptool",cls:"tooltiptoolbar",style:"z-index:10000",hidden:true},{itemId:"topBar",cls:"popoverTopBar",height:50,layout:"hbox",items:[{itemId:"controls",layout:"hbox",width:"100%",padding:"10px 20px 0px 20px",height:50,items:[{itemId:"topBarShare",xtype:"readermenushare",layout:"hbox"},{itemId:"copyButton",cls:"topBarCopyButton popoverTool",baseCls:"copyButton",hidden:true,text:"Copy Article"},{itemId:"topBarSelectText",cls:"topBarSelectText popoverTool",html:'<div class="textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text-highlight-ic.png" ></div>',hidden:true,text:"Article Highlight Mode"},{layout:"hbox",itemId:"interactiveContent",hidden:true,items:[{itemId:"topBarComic",html:'<img class="comic-btn" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/comics-ic.png">',text:"Comics",cls:"popoverTool"},{itemId:"topBarPuzzle",html:'<img class="puzzle-btn" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/puzzle-ic.png">',text:"Puzzles",cls:"popoverTool"},{itemId:"topBarSections",html:'<img class="sections-btn" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/sections-ic-black.png">',hidden:true}]},{itemId:"topBarPrint",html:'<img class="print-btn" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="'+location.protocol+"//"+location.host+'/tribune/print-icon.png" />',text:"Print",cls:"popoverTool"},{itemId:"textControls",html:'<div class="textSizeHtml5"><img class="textIncrease" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text_Increase_Icon.png" ontouchstart="increaseText()" onclick="increaseText()">&nbsp;&nbsp;<img class="textDecrease" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text_Decrease_Icon.png" ontouchstart="decreaseText()" onclick="decreaseText()"></div>'},{itemId:"topBarTranslate",cls:"topBarTranslate pointerCursor popoverTool",html:'<div class="textSizeHtml5"><span style="top: -8px;position: relative;margin: 8px;color: rgb(66, 145, 182);">Translate</span><img style="cursor:hand;cursor:pointer;width:28px;height:28px;margin-top:2px;" src="../assets/article view/Spain.png"></div>',right:125,padding:6,hidden:true},{itemId:"inappTranslate",baseCls:"inappTranslate",cls:"spain"},{itemId:"ttsControl",cls:"popoverTool",baseCls:"ttsToggle",status:"STOPPED"},{itemId:"readAloudControls",cls:"popoverTool read-aloud",xtype:"readaloudcontrols",hidden:true}]},{itemId:"closeButton",cls:"pointerCursor",top:0,right:0,padding:"10px 20px 10px 20px",style:"color:#4291b6",layout:{type:"hbox",align:"center"},items:[{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:"Close"},{width:10},{itemId:"closeImg",height:26,html:'<img src="../assets/article view/article-close-btn.png" style="width:26px;" />'}]}]},{width:"100%",height:100,itemId:"advertTop"},{itemId:"content",flex:1,cls:"popovercontent innerhtmlfullheight"},{width:"100%",height:100,itemId:"advertBottom"},{itemId:"bottomNav",cls:"articleFooter",height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",align:"center"},items:[{itemId:"previousArticleButton",width:155,padding:"10 0 0 20",height:"100%",layout:"hbox",cls:"previousArticle pointerCursor",items:[{itemId:"prev",cls:"previousArticleImg",html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{itemId:"previousArticle",style:"white-space:nowrap;",html:"Previous Article",cls:"articleFooterBtnText",padding:"0 0 0 5"}]},{flex:1},{itemId:"articleText",html:"Article X / Y"},{flex:1},{itemId:"nextArticleButton",padding:"10 20 0 0",height:"100%",layout:{type:"hbox"},cls:"nextArticle pointerCursor",items:[{itemId:"nextArticle",cls:"articleFooterBtnText",style:"white-space:nowrap;",html:"Next Article",padding:"0 5 0 0"},{itemId:"next",cls:"nextArticleImg",html:"<img style='height:20px' src='../assets/article view/right-article-arrow.png' />"}]}]}]},initialize:function(){var b=this;b.highlightMode=false;if(settings.articlepopover.enableFullscreen==="true"){b.removeCls("articlepopover");b.addCls("enable-fullscreen-articlepopover")}if(b.config.hasComics!=null){b.hasComics=b.config.hasComics}if(b.config.hasPuzzles!=null){b.hasPuzzles=b.config.hasPuzzles}b.content=b.getComponent("content");var d=20;if(settings.articlepopover.articlePadding!=null){d=parseInt(settings.articlepopover.articlePadding)}b.content.setPadding("0 "+d+"px");var a=b.getComponent("topBar");b.topBar=a.getComponent("controls");b.topBarShare=b.topBar.getComponent("topBarShare");b.topBarFrame=b.topBarShare.element.down("iframe");b.topBarPrint=b.topBar.getComponent("topBarPrint");b.topBarTextControls=b.topBar.getComponent("textControls");b.closeButton=a.getComponent("closeButton");b.closeTxt=b.closeButton.getComponent("closeTxt");b.closeTxt.setHtml(language.close);b.closeImg=b.closeButton.getComponent("closeImg");b.setCloseButtonListener();b.readAloudControls=b.topBar.getComponent("readAloudControls");b.bottomNavContainer=b.getComponent("bottomNav");if(settings.articlepopover.bottomBarColor!=null){b.bottomNavContainer.setStyle({backgroundColor:"#"+settings.articlepopover.bottomBarColor,color:"#"+settings.articlepopover.bottomFontColor})}b.previousArticleButton=b.bottomNavContainer.getComponent("previousArticleButton");b.nextArticleButton=b.bottomNavContainer.getComponent("nextArticleButton");b.articleText=b.bottomNavContainer.getComponent("articleText");var c=b.getComponent("bottomNav");b.previousArticleButton=c.getComponent("previousArticleButton");b.nextArticleButton=c.getComponent("nextArticleButton");b.nextArticleText=b.nextArticleButton.getComponent("nextArticle");b.previousArticleText=b.previousArticleButton.getComponent("previousArticle");b.setArticlePopoverText();b.articleText=c.getComponent("articleText");b.ttsToggle=b.topBar.getComponent("ttsControl");b.copyButton=b.topBar.getComponent("copyButton");if(window.SpeechSynthesisUtterance===undefined||settings.tts===undefined){b.ttsToggle.hide()}b.inappTrans=b.topBar.getComponent("inappTranslate");b.inappTrans.hide();b.topBarTranslate=b.topBar.getComponent("topBarTranslate");b.topBarSelectText=b.topBar.getComponent("topBarSelectText");b.interactiveContent=b.topBar.getComponent("interactiveContent");b.topBarComic=b.interactiveContent.getComponent("topBarComic");b.topBarPuzzle=b.interactiveContent.getComponent("topBarPuzzle");b.topBarSections=b.interactiveContent.getComponent("topBarSections");b.advertTop=b.getComponent("advertTop");b.advertBottom=b.getComponent("advertBottom");b.setupReadAloud();b.setNextButtonListener();b.setPreviousButtonListener();b.setTtsToggleListener();b.setCopyButtonListener();b.setTranslateListener();b.setupTextResize();b.setupTextHighlight();b.setupPrint();b.setupTextResize();b.setupInteractiveContent();b.setComicPuzzleListener();b.checkAdvert();b.checkJustification();b.setArticleTextListeners();if(b.articleReader!=null){b.fireEvent("initializeArticlePopover",b);b.ttsToggle.hide()}else{if(b.config.isLive==null){b.fireEvent("initialized",b)}else{if(b.config.articles==null){b.fireEvent("initializeLivePopover",b);b.ttsToggle.hide()}else{b.fireEvent("initializeLivePopover",b,b.config.articles)}}}if(settings.newsday!=null){b.addCls("popUp");b.topBarPrint.hide();if(settings.newsday.useFontAwesome=="true"){b.prevIcon=b.previousArticleButton.getComponent("prev");if(b.prevIcon!=null){b.prevIcon.setHtml('<i class="fa fa-angle-left fa-lg" style="position:relative;top:-2px;margin:2px;" aria-hidden="true"></i>')}b.nextIcon=b.nextArticleButton.getComponent("next");if(b.nextIcon!=null){b.nextIcon.setHtml('<i class="fa fa-angle-right fa-lg" style="position:relative;top:-2px;margin:2px;" aria-hidden="true"></i>')}}if(settings.newsday.useNewsdayPopover!=null){if(settings.newsday.useNewsdayPopover=="true"){if(settings.reader.overlayTitleBarColour!=null){a.setStyle({backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+",0.9)"})}b.closeButton.removeAll();var e=Ext.create("Ext.Container",{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:'<img src="resources/images/article-close-btn-white.png" style="width:26px;" />'});b.closeButton.add(e);if(settings.topbar.color!=null){b.closeButton.setStyle({color:"#"+settings.topbar.color})}b.closeButton.setPadding("12px 16px");b.topBar.insert(0,b.closeButton);b.topBar.setPadding("5px 0px 0px 0px");b.topBarTextControls.hide();b.topBarShare.setPadding("3px 0px 0px 5px")}}if(settings.newsday.hideShareIcons!=null){if(settings.newsday.hideShareIcons=="true"){b.topBarShare.removeAll()}}}b.hideTopBar();if(navigator.maxTouchPoints&&navigator.appVersion.indexOf("Edge")!=-1){}else{b.setTooltips()}b.adjustModal();mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},setArticleTextListeners:function(){var b=this;if(!!settings&&!!settings.articlepopover&&settings.articlepopover.enableFullscreen=="true"&&!!settings.menu&&settings.menu.hideArticles!="true"){b.articleText.element.on("tap",function(){b.fireEvent("viewallarticles",b)});b.articleText.element.dom.style.cursor="pointer";if(InfinityMobile.controller.ReaderController.isNewPWA()){var a=!!language&&!!language.articlePopover&&!!language.articlePopover.viewAllArticles?language.articlePopover.viewAllArticles:"View All Articles";b.articleText.setHtml(a)}}},hideTopBar:function(){var a=this;if(settings.articlepopover.hideArticleControls!=null&&settings.articlepopover.hideArticleControls.toLowerCase()=="true"){a.topBar.hide();a.bottomNavContainer.hide()}else{if(settings.articlepopover.disableArticleCarousel!=null&&settings.articlepopover.disableArticleCarousel.toLowerCase()=="true"){a.bottomNavContainer.hide()}}},setupInteractiveContent:function(){var a=this;if(settings.articlepopover.interactive=="true"){a.interactiveContent.show()}else{a.interactiveContent.hide()}},setArticlePopoverText:function(){var a=this;if(language.articlePopover!=null){if(language.articlePopover.nextArticle){a.nextArticleText.setHtml(language.articlePopover.nextArticle)}if(language.articlePopover.previousArticle){a.previousArticleText.setHtml(language.articlePopover.previousArticle)}}},setupTextResize:function(){var a=this;if(settings.articlepopover.textResize!="true"){a.topBarTextControls.hide()}else{a.topBarTextControls.show()}},setupPrint:function(){var a=this;if(settings.articlepopover.print=="true"){a.topBarPrint.show();a.topBarPrint.element.on("tap",function(){if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){mainPanel.fireEvent("printArticleTemplate")}else{if(settings.reader.iframePopover!=null&&settings.reader.iframePopover=="true"){window.print()}else{mainPanel.fireEvent("articlePrint",a);a.fireEvent("articlePrint")}}})}else{a.topBarPrint.hide()}},setupTextHighlight:function(){var a=this;if(settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){a.topBarSelectText.hide()}else{if(settings.articlepopover.articleHighlight=="true"){a.topBarSelectText.show();a.topBarSelectText.element.on("tap",function(){a.fireEvent("selectTextMode",a)})}else{a.topBarSelectText.hide()}}},setupTextResize:function(){var a=this;if(settings.articlepopover.textResize!="true"){a.topBarTextControls.hide()}else{a.topBarTextControls.show()}},adjustModa},setupReadAloud:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined&&!Ext.browser.is.Opera&&settings.articlepopover.readAloud!=null){a.ttsToggle.show()}else{a.ttsToggle.hide()}},setTranslateListener:function(){var a=this;if(settings.articlepopover.translate!=null&&a.config.isLive!="true"){a.topBarTranslate.show();a.topBarTranslate.element.on({tap:function(b){b.stopPropagation();a.fireEvent("translateArticle",a)}})}else{a.topBarTranslate.hide()}},setComicPuzzleListene},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},setArticleWidth:function(){var b=this;var a=Math.min(screen.width,screen.height);b.setWidth(a)},setCloseButtonListener:function(){var a=this;a.closeButton.element.on({tap:"tap",scope:this})},setTtsToggleListene},setCopyButtonListener:function(){var a=this;if(settings.articlepopover.copy!="true"){a.copyButton.hide()}else{a.copyButton.show();a.copyButton.element.on({tap:function(){a.fireEvent("copyToClipboard")}})}},setPreviousButtonListener:function(){var a=this;if(a.config.isLive!=null){a.previousArticleButton.element.on("tap",function(){a.fireEvent("livePrevious",a)})}else{a.previousArticleButton.element.on("tap",function(){a.fireEvent("previous")})}},setNextButtonListene},setAppTranslateListener:function(){var a=this;a.inappTrans.element.on({tap:function(){a.fireEvent("translate",a.inappTrans)}})},tap:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;a.tap()},setTooltips:function(){var b=this;b.tooltip=b.getComponent("tooltiptool");if(settings.tooltips!=null){b.tooltip.setStyle({backgroundColor:"#"+settings.tooltips.backgroundColor,color:"#"+settings.tooltips.color})}b.topBarShare.on("painted});b.setupTooltipMouseFunctions(b.copyButton.element.dom,language.articlePopover.copyTool,false);b.setupTooltipMouseFunctions(b.topBarSelectText.element.dom,"Article Highlight Mode",false);if(b.topBarComic!=null){b.setupTooltipMouseFunctions(b.topBarComic.element.dom,"Comics",false)}if(b.topBarPuzzle!=null){b.setupTooltipMouseFunctions(b.topBarPuzzle.element.dom,"Puzzles",false)}b.setupTooltipMouseFunctions(b.topBarPrint.element.dom,language.print.print,false);var d=$(b.topBarTextControls.element.dom).find(".textIncrease")[0];if(d!=null){b.setupTooltipMouseFunctions(d,language.articlePopover.enlargeText,false)}var c=$(b.topBarTextControls.element.dom).find(".textDecrease")[0];if(c!=null){b.setupTooltipMouseFunctions(c,language.articlePopover.reduceText,false)}b.setupTooltipMouseFunctions(b.ttsToggle.element.dom,language.readAloud.readAloudMode,false);var a=b.readAloudControls;if(a!=null){a.element.dom.onmouseove};a.element.dom.onmouseout=function(){b.tooltip.setHtml("");b.tooltip.hide();b.element.dom.onmousemove=null}}},setupTooltipMouseFunctions:function(c,d,b){var a=this;if(b){c.onmouseove};c.onmouseou}}else{c.onmouseover=function(f){a.tooltip.setHtml(d);a.tooltip.show();a.tooltipShare()};c.onmouseout=function(f){a.tooltip.setHtml("");a.tooltip.hide();a.element.dom.onmousemove=null}}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(b.layerX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(b.layerX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(b.layerX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},tooltipShare:function(){var a=this;a.element.dom.onmousemove=(function(b){var d=b.pageX-$(a.element.dom).offset().left;var c=d+15;a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(c)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(c)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(c)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},checkAdvert:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;if(a!=null&&a.advertInArticleFlow=="false"){if(a.position=="top"){b.advertBottom.hide();b.setupAdvert(b.advertTop)}else{b.advertTop.hide();b.setupAdvert(b.advertBottom)}}else{b.advertTop.hide();b.advertBottom.hide()}}else{b.advertTop.hide();b.advertBottom.hide()}},setupAdvert:function(b){var c=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;c.advert=b;switch(a.type){case"dfp":c.setupDfpAdvert(b,a);break;case"image":c.setupImageAdvert(b,a);break}}},setupDfpAdvert:function(b,a){var c=this;c.networkCode=a.networkCode;c.adUnit=a.adUnit;c.advertHolder=Ext.create("Ext.Container");b.add(c.advertHolder);c.advertDivID=c.advertHolder.id+"advert";c.advertHolder.setHtml("<div id='"+c.advertDivID+"' style='height:90px;text-align:center;padding:5px;'></div>");c.on("painted",c.loadDfpAdvert)},setupImageAdvert:function(b,a){var c=this;if(a!=null){b.setHtml("<img src='"+a.url+"' style='margin:auto;display:block;margin-top:5px;' />");b.element.on("tap",function(){window.open(a.link)})}},loadDfpAdvert:function(){var a=this;googletag.cmd.push(function(){a.adslot=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("728"),parseInt("90")],a.advertDivID).addService(googletag.pubads().updateCorrelator());if(settings.reader.popupAdvert.targeting!=null&&settings.reader.bannerAd.targeting.length>0){var b=settings.reader.popupAdvert.targeting.split("|");for(var d in b){var e=b[d];var c=e.split("*");if(c!=null&&c.length>=2){a.adslot.setTargeting(c[0],c[1])}}}googletag.enableServices();googletag.display(a.advertDivID)})},refreshAdvert:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){var a=settings.reader.popupAdvert;if(a.type=="dfp"){b.advert.removeAll(true,true);if(b.refreshTimeout!=null){clearTimeout(b.refreshTimeout)}b.refreshTimeout=setTimeout(function(){b.checkAdvert();b.loadDfpAdvert()},1000)}}},checkJustification:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right");a.topBar.getLayout().setPack("end");a.closeButton.setRight("");a.closeButton.setLeft(0);a.closeButton.remove(a.closeTxt,false);a.closeButton.add(a.closeTxt);a.closeButton.remove(a.closeImg,false);a.closeButton.insert(0,a.closeImg)}},destroy:function(){var a=this;mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);Ext.Container.prototype.destroy.apply(this,arguments)}},0,["articleview"],["component","container","articleview"],{component:true,container:true,articleview:true},["widget.articleview"],0,[InfinityMobile.view.desktop,"ReaderArticlePopover"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticlePopoverInterstitial",Ext.Panel,{config:{style:"padding:0px",items:[{itemId:"advert",cls:"advert",style:"position:relative; top:50%; transform: translateY(-50%);"}]},initialize:function(){var f=this;f.destroyed=false;f.advertTimeout=1000;f.loaded=false;f.advertContainer=f.getComponent("advert");var a=settings.newsday.articlePopoverInterstitial;if(a!=null){f.width="768";if(a.width!=null){f.width=a.width}f.height="1024";if(a.height!=null){f.height=a.height}if(a.type==null||a.type=="dfp"){f.networkCode=a.networkCode;f.adUnit=a.adUnit;f.advertDivID=f.id+"advert";f.advertContainer.setHtml("<div style='text-align:center;height:100%'><div id='"+f.advertDivID+"' class='interstitialAdvertDesktop' style='display:inline-block;height:100%;margin-left:0;margin-right:0;'></div></div>");f.advertDiv=f.element.down("#"+f.advertDivID);f.advertDiv.dom.style.visibility="hidden";f.on("painted",f.loadAdvert,f,{delay:10,single:true});f.on("resize",f.onResizeFn,f)}else{if(a.type.indexOf("custom|")>=0){var d=a.type.split("|");var e=d[1];var b=d[2];f.advertContainer.element.dom.style.textAlign="center";var c=function(){if(f.advertContainer.element.dom&&window[e]!=null){f.customBannerAd=new window[e](f.id+"article-interstitial",f.advertContainer.element.dom,currentProfile,a.config);f.customBannerAd.loadAdvert()}};if(a.config==null){f.ajaxRequest=$.ajax({url:b+(b.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(g){f.hasConfig=true;console.log(g);settings.newsday.articlePopoverInterstitial.config=g;if(!f.destroyed){c()}}})}else{c()}}else{f.url=a.url;f.advertContainer.setHtml("<div style='text-align:center;height:100%'><div id='"+f.advertDivID+"' class='interstitialAdvertDesktop' style='display:inline-block;height:100%;margin-left:0;margin-right:0;'><iframe src='"+f.url+"' style='border:none;height:"+f.height+"px' /></div></div>")}}}f.mouseMove=false},frameTouchStart:function(b){var a=this;a.mouseMove=true;a.articleCarousel=a.returnArticleCarousel();b.changedTouches=[{screenX:b.screenX}];console.log(b);a.articleCarousel.frameDragStart(b);b.stopPropagation()},frameTouchMove:function(b){var a=this;if(a.mouseMove){console.log("MOUSE MOVE");b.changedTouches=[{screenX:b.screenX}];a.articleCarousel.frameDrag(b)}b.stopPropagation()},frameTouchEnd:function(b){var a=this;b.changedTouches=[{screenX:b.screenX}];a.articleCarousel.frameDragEnd(b);a.mouseMove=false;b.stopPropagation()},returnArticleCarousel:function(){var a=this;return a.parent},loadAdvert:function(){var a=this;if(!a.loaded){setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt(a.width),parseInt(a.height)],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)});a.setTouchEvents();a.onResizeFn(a);a.advertDiv.dom.style.visibility=""}},a.advertTimeout)}a.loaded=true},loadAdvertUrl:function(){var a=this;if(!a.loaded){a.on("painted",a.loadAdvertUrl,a,{delay:10,single:true})}},setTouchEvents:function(){var b=this;if(b.advertDiv.down("iframe")!=null){var a=b.advertDiv.down("iframe").dom;a.onload=function(){var c=a.contentDocument||a.contentWindow.document;c.addEventListener("click});c.addEventListener("mousedown});c.addEventListener("mousemove",function(d){b.frameTouchMove(d);d.preventDefault()});c.addEventListener("mouseup})}}},onResizeF},destroy:function(){var a=this;a.destroyed=true;Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["articlePopoverInterstitial"],["component","container","panel","articlePopoverInterstitial"],{component:true,container:true,panel:true,articlePopoverInterstitial:true},["widget.articlePopoverInterstitial"],0,[InfinityMobile.view.desktop,"ArticlePopoverInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.DesktopPageViewer",Ext.Panel,{config:{height:"100%",width:"100%",scrollable:"both",maxScale:3,mode:"double",zoomMode:"fit",maxZoomWidth:3500,cls:"zoomed-out",items:[{itemId:"scrollerDiv",items:[{itemId:"zoomDiv",style:"visibility: hidden",items:[{itemId:"overflowMediaDiv",left:0,top:0,hidden:true,height:"100%",width:"50%",zIndex:20},{itemId:"hiddenLeft",left:"0%",top:0,height:"100%",width:"50%",style:"visibility:hidden;",html:"<img id='hiddenLeftImg' src='' style='position:absolute;'/><div class='hiddenGradientLeft' style='position:absolute;right:0%;' ></div>"},{itemId:"leftSide",left:0,top:0,height:"100%",width:"50%",html:"<div class='leftSideDiv' style='position:absolute;top:0%;right:0%;transform-origin:100% 0% 0px;z-index:10000' ><div class='leftPreviousPageContainer' style='z-index:10;position:absolute;transform-origin:100% 0% 0px;visibility:hidden;right:0%;top0%;'><div class='leftSideGradient' style='position:absolute'></div><img class='leftPrevPage' style='position:absolute;' /></div><div class='leftSideImgContainer' style='position:absolute;top:0%;right:0%;'><img class='leftSideImg' style='display:block;' /><div class='tileDiv'><canvas id='tileCanvas' /></div></div></div>"},{itemId:"hiddenRight",left:"50%",top:0,height:"100%",width:"50%",style:"visibility:hidden;",html:"<img id='hiddenRightImg' src='' style='position:absolute;' /><div class='hiddenGradientRight' style='position:absolute;' ></div>"},{itemId:"rightSide",left:"50%",top:0,height:"100%",width:"50%",html:"<div class='rightSideDiv' style='position:absolute;top:0%;left:0%;transform-origin:0% 0% 0px;' ><div class='rightNextPageContainer' style='z-index:10;position:absolute;transform-origin:0% 0% 0px;visibility:hidden;' ><div class='rightSideGradient' style='position:absolute;'></div><img class='rightNextPage' style='position:absolute;' /></div><div class='rightSideImgContainer' style='position:absolute;'><img class='rightSideImg' style='display:block;' /><div class='tileDiv'><canvas id='tileCanvas' /></div></div></div>"},{itemId:"mediaDivContainer",cls:"innerhtmlfullheight",left:0,top:0,width:"100%",height:"100%",html:"<div class='leftPageMediaDiv mediaDiv' style='width:50%;height:100%;display:inline-block;position:relative'></div><div class='rightPageMediaDiv mediaDiv' style='width:50%;display:inline-block;height:100%;position:relative'></div>"}]},{itemId:"tooltip",style:"position:absolute !important;left:0px;top:0px;",left:0,top:0,width:0,height:0,hidden:true}]},{cls:"cornerPoint",itemId:"topRight",style:"width:60px;height:60px;position:absolute;right:0%;top:0%;z-index:100001;visibility:visible;overflow:hidden;",html:"<img class='gifRight' loop='false' style='visibility:hidden;'/>"},{cls:"cornerPoint",itemId:"topLeft",style:"width:60px;height:60px;position:absolute;left:0%;top:0%;z-index:100001;visibility:visible;overflow:hidden",html:"<img class='gifLeft' loop='false' style='visibility:hidden;'/>"},{cls:"cornerPoint",itemId:"bottomRight",style:"width:60px;height:60px;position:absolute;right:0%;bottom:0%;z-index:100001;visibility:visible;overflow:hidden;",html:"<img class='gifBottomRight' loop='false' style='visibility:hidden;'/>"},{cls:"cornerPoint",itemId:"bottomLeft",style:"width:60px;height:60px;position:absolute;left:0%;bottom:0%;z-index:100001;visibility:visible;overflow:hidden;",html:"<img class='gifBottomLeft' loop='false' style='visibility:hidden;'/>"}]},beforeInitialize:function(){var a=this;a.isinitialized=false;a.isPageRendered=false;a.hasTiled=false;a.leftThumbnailLoaded=false;a.rightThumbnailLoaded=false;a.scale=1;a.zoomMode=a.config.zoomMode;a.mode=a.config.mode;a.scaledCanvas=false;a.zoomTileInterval=null;a.viewDestroyed=false;a.renderedMedia=false;a.currentZoomLevel=1;a.zoomLevels=1;a.doToggleCheck=true;if(typeof settings!="undefined"){if(settings.reader.doubleTapFullZoom!=null&&settings.reader.doubleTapFullZoom=="false"){a.zoomLevels=2;if(settings.reader.doubleTapZoomLevels!=null){a.zoomLevels=parseInt(settings.reader.doubleTapZoomLevels)}}if(settings.page!=null&&settings.page.maxWidthPercentage){a.maxWidthPercentage=settings.page.maxWidthPercentage}}},initialize:function(){var d=this;var c=Ext.getStore("SettingStore");d.advertCounter=0;d.readerPaddingY=0;d.readerPaddingX=0;d.wrapAdOffset=0;d.topPadding=0;var e=false;if(typeof isTribReader!="undefined"){if(isTribReader){e=true}}if(e||window.settings.reader.enableReaderPadding=="true"){d.wrapAdOffset=150;d.topPadding=20}if(window.settings.wrapAd!=null){d.wrapAdOffset=window.settings.wrapAd.dualAdvert!=null&&window.settings.wrapAd.dualAdvert=="left"?350:200}d.audioObjects=[];d.mp4Objects=[];d.topRight=d.getComponent("topRight");d.topLeft=d.getComponent("topLeft");d.bottomRight=d.getComponent("bottomRight");d.bottomLeft=d.getComponent("bottomLeft");d.zoomLevel="none";d.scrollerDivContainer=d.getComponent("scrollerDiv");d.scrollerDiv=d.scrollerDivContainer.element;d.scrollerDiv.addListener({scope:d,doubletap:d.onDoubleTap,pinchstart:d.onPinchStart,pinch:d.onPinch,pinchend:d.onPinchEnd});d.zoomDivContainer=d.scrollerDivContainer.getComponent("zoomDiv");d.zoomDiv=d.zoomDivContainer.element;d.rightSide=d.zoomDivContainer.getComponent("rightSide");d.leftSide=d.zoomDivContainer.getComponent("leftSide");d.hiddenRight=d.zoomDivContainer.getComponent("hiddenRight");d.hiddenLeft=d.zoomDivContainer.getComponent("hiddenLeft");d.overflowMediaDiv=d.zoomDivContainer.getComponent("overflowMediaDiv");d.mediaDivContainer=d.zoomDivContainer.getComponent("mediaDivContainer");d.mediaDiv=d.mediaDivContainer.element;d.tooltip=d.scrollerDivContainer.getComponent("tooltip");d.scroller=d.getScrollable().getScroller();d.scroller.setDisabled(true);d.scroller.on({scrol},scrollend:d.scrollEnd,scope:d});d.setupPages();d.on("painted",d.pagePainted,d,{delay:10,single:true});d.topRight.element.addListener({dragstart:"startDrag",drag:"drag",dragend:"endDrag",scope:d});d.topRight.element.on("tap",function(g){if(g!=null){g.stopPropagation()}d.fireEvent("killBannerAd",d);if(d.diffX==null){d.diffX=($(d.topRight.element.dom).offset().left+$(d.topRight.element.dom)[0].getBoundingClientRect().width)-$(d.element.dom).width()}if(d.diffY==null){d.diffY=$(d.topRight.element.dom).offset().top}$(d.rightSideDiv).css("transform-origin","0% 0% 0px");$(d.rightSideImg).css("transform-origin","0% 0% 0px");$(d.rightNextPage).css("transform-origin","0% 0% 0px");$(d.rightSideGradient).css("transform-origin","0% 0% 0px");$(d.rightSideDiv).css("bottom","");$(d.rightSideImg).css("top","0%");$(d.rightSideImg).css("bottom","");$(d.rightSideImg).css("left","0%");$(d.rightNextPage).css("top","0%");$(d.rightNextPage).css("bottom","");$(d.rightNextPage).css("left","0% ");$(d.rightSideGradient).css("top","0%");$(d.rightSideGradient).css("bottom","");$(d.rightSideGradient).css("left","0% ");$(d.rightSideGradient).css("z-index","11");d.rightSide.element.dom.style.zIndex="10";d.leftSide.element.dom.style.zIndex="9";$(d.gifRight).css("visibility","hidden");d.fireEvent("autoTurnRight",d)});d.enter=false;d.mouseDown=false;d.topRight.element.dom.onmouseenter=function(h){if(!d.mouseDown){if(d.timer!=null){clearInterval(d.timer);d.timer=null}$(d.gifRight).css("visibility","visible");$(d.gifRight).attr("src","resources/images/cornerpeel_00010.png");var g=60;if((navigator.maxTouchPoints)){g=70}$(d.gifRight).css("transform","translate3d("+g+"px, "+g+"px, 0px)");d.timer=setInterval(function(){g--;$(d.gifRight).css("transform","translate3d("+g+"px, "+-g+"px, 0px)");if(g==0){clearInterval(d.timer);d.timer=null}},5);d.mouseDown=false}};d.topRight.element.dom.onmouseleave=function(h){if(!d.mouseDown){if(d.timer!=null){clearInterval(d.timer);d.timer=null}if(!Ext.browser.is.IE){$(d.gifRight).attr("src","resources/images/cornerpeel_00010.png")}var g=0;d.timer=setInterval(function(){g++;$(d.gifRight).css("transform","translate3d("+g+"px, "+-g+"px, 0px)");var j=60;if((navigator.maxTouchPoints)){j=70}if(g==j){clearInterval(d.timer);d.timer=null}},5);d.mouseDown=false}};d.topLeft.element.addListener({dragstart:"startDragLeft",drag:"dragLeft",dragend:"endDragLeft",scope:d});d.topLeft.element.on("tap});d.topLeft.element.dom.onmouseenter=function(h){if(!d.mouseDown){if(d.timer!=null){clearInterval(d.timer);d.timer=null}$(d.gifLeft).attr("src","resources/images/cornerpeel_00010.png");$(d.gifLeft).css("visibility","visible");var g=60;if((navigator.maxTouchPoints)){g=70}$(d.gifLeft).css("transform","translate3d("+g+"px, "+g+"px, 0px)");d.timer=setInterval(function(){g--;$(d.gifLeft).css("transform","rotate(270deg) scale3d(1, 1, 1) translate3d("+g+"px, "+-g+"px, 0px)");if(g==0){clearInterval(d.timer);d.timer=null}},5);d.mouseDown=false}};d.topLeft.element.dom.onmouseleave=function(h){if(!d.mouseDown){if(d.timer!=null){clearInterval(d.timer);d.timer=null}if(!Ext.browser.is.IE){$(d.gifRight).attr("src","resources/images/cornerpeel_00010.png")}var g=0;d.timer=setInterval(function(){g++;$(d.gifLeft).css("transform","rotate(270deg) scale3d(1, 1, 1) translate3d("+g+"px, "+-g+"px, 0px)");var j=60;if((navigator.maxTouchPoints)){j=70}if(g==j){clearInterval(d.timer);d.timer=null}},5);d.mouseDown=false}};d.bottomRight.element.addListener({dragstart:"startDragBottomRight",drag:"dragBottomRight",dragend:"endDragBottomRight",scope:d});d.bottomRightTapped=false;d.bottomRight.element.on("tap});d.bottomLeft.element.addListener({dragstart:"startDragBottomLeft",drag:"dragBottomLeft",dragend:"endDragBottomLeft",scope:d});d.bottomRight.element.dom.onmouseenter=function(h){if(!d.mouseDown){if(d.timer!=null){clearInterval(d.timer);d.timer=null}$(d.gifBottomRight).attr("src","resources/images/cornerpeel_00010.png");$(d.gifBottomRight).css("visibility","visible");var g=60;if((navigator.maxTouchPoints)){g=70}$(d.gifBottomRight).css("transform","translate3d("+g+"px, "+g+"px, 0px)");d.timer=setInterval(function(){g--;$(d.gifBottomRight).css("transform","rotate(90deg) translate3d("+g+"px, "+-g+"px, 0px)");if(g==0){clearInterval(d.timer);d.timer=null}},5);d.mouseDown=false}},d.bottomRight.element.dom.onmouseleav};d.bottomLeftTapped=false;d.bottomLeft.element.on("tap});d.bottomLeft.element.dom.onmouseente};d.bottomLeft.element.dom.onmouseleav};if(d.zoomMode=="fill"){d.topRight.hide();d.topLeft.hide();d.bottomRight.hide();d.bottomLeft.hide();var a;var b;var f=false;d.element.dom.onmousewheel=(function(h){f=true;if(a==null){a=Date.now()}if(!!b){clearTimeout(b);b=null}var g=30;if(Date.now()-a>=10){if(h.wheelDelta>0){if(d.scroller.position.y-g>0){d.scroller.scrollTo(d.scroller.position.x,d.scroller.position.y-g);d.fireEvent("showTop");d.fireEvent("showBottom")}else{d.scroller.scrollTo(d.scroller.position.x,0);d.fireEvent("hideTop");d.fireEvent("showBottom")}}else{if(d.scroller.position.y+120<d.scroller.maxPosition.y){d.scroller.scrollTo(d.scroller.position.x,d.scroller.position.y+g);d.fireEvent("showBottom");d.fireEvent("showTop")}else{d.scroller.scrollTo(d.scroller.position.x,d.scroller.maxPosition.y);d.fireEvent("hideBottom");d.fireEvent("showTop")}}a=Date.now()}b=setTimeout(function(){if(!f){d.onMouseEnd();a=null}},500);f=false});d.element.dom.addEventListener("DOMMouseScroll",function(h){f=true;if(a==null){a=Date.now()}if(!!b){clearTimeout(b);b=null}var g=30;if(Date.now()-a>=10){if(h.detail<=0){if(d.scroller.position.y-g>0){d.scroller.scrollTo(d.scroller.position.x,d.scroller.position.y-g);d.fireEvent("showTop");d.fireEvent("showBottom")}else{d.scroller.scrollTo(d.scroller.position.x,0);d.fireEvent("hideTop");d.fireEvent("showBottom")}}else{if(d.scroller.position.y+g<d.scroller.maxPosition.y){d.scroller.scrollTo(d.scroller.position.x,d.scroller.position.y+g);d.fireEvent("showBottom");d.fireEvent("showTop")}else{d.scroller.scrollTo(d.scroller.position.x,d.scroller.maxPosition.y);d.fireEvent("hideBottom");d.fireEvent("showTop")}}a=Date.now()}b=setTimeou},500);f=false})}else{d.toggleZoomMode("fit")}d.pauseFlashingLinks();if((navigator.maxTouchPoints)){$(d.topRight.element.dom).css("height","70px");$(d.topRight.element.dom).css("width","70px");$(d.topLeft.element.dom).css("height","70px");$(d.topLeft.element.dom).css("width","70px");$(d.bottomRight.element.dom).css("height","70px");$(d.bottomRight.element.dom).css("width","70px");$(d.bottomLeft.element.dom).css("height","70px");$(d.bottomLeft.element.dom).css("width","70px")}d.element.addListener({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragFinished",scope:d});d.isinitialized=true},setupPages:function(){var b=this;b.rightPageObject=b.config.rightPage;b.rightPage=b.config.rightPage.image;b.leftPageObject=b.config.leftPage;b.leftPage=b.config.leftPage.image;b.prevPageObject=b.config.previousPage;b.prevPage=b.config.previousPage.image;b.hiddenLeftPageObject=b.config.hiddenLeftPage;b.hiddenLeftPage=b.config.hiddenLeftPage.image;b.nextPageObject=b.config.nextPage;b.nextPage=b.config.nextPage.image;b.hiddenRightPageObject=b.config.hiddenRightPage;b.hiddenRightPage=b.config.hiddenRightPage.image;b.initialTranslateX=0;b.initialTranslateY=0;b.offsetX=0;b.offsetY=0;b.rightSideDiv=b.rightSide.element.down(".rightSideDiv").dom;b.rightSideNextPageContainer=b.rightSide.element.down(".rightNextPageContainer").dom;b.rightSideGradient=b.rightSide.element.down(".rightSideGradient").dom;b.rightNextPage=b.rightSide.element.down(".rightNextPage").dom;b.rightSideImageContainer=b.rightSide.element.down(".rightSideImgContainer").dom;b.rightSideImg=b.rightSide.element.down(".rightSideImg").dom;b.rightSideMediaDiv=b.mediaDivContainer.element.down(".rightPageMediaDiv").dom;b.rightSideTileDiv=b.rightSide.element.down(".tileDiv").dom;b.rightSideTileCanvas=b.rightSide.element.down("canvas").dom;b.rightSideImageContainer.image=b.rightSideImg;b.rightSideImageContainer.mediaDiv=b.rightSideMediaDiv;b.rightSideImageContainer.tileDiv=b.rightSideTileDiv;b.rightSideImageContainer.tileCanvas=b.rightSideTileCanvas;var a=b.getPageNo()+1;if(a%2==1){b.rightSideImageContainer.pageNo=a}else{b.rightSideImageContainer.pageNo=(a+1)}b.hiddenRightImg=b.hiddenRight.element.dom.children[0].children[0].children[0];b.hiddenRightGradient=b.hiddenRight.element.dom.children[0].children[0].children[1];b.leftSideDiv=b.leftSide.element.down(".leftSideDiv").dom;b.leftSidePrevPageContainer=b.leftSide.element.down(".leftPreviousPageContainer").dom;b.leftSideGradient=b.leftSide.element.down(".leftSideGradient").dom;b.leftPrevPage=b.leftSide.element.down(".leftPrevPage").dom;b.leftSideImageContainer=b.leftSide.element.down(".leftSideImgContainer").dom;b.leftSideImg=b.leftSide.element.down(".leftSideImg").dom;b.leftSideMediaDiv=b.mediaDivContainer.element.down(".leftPageMediaDiv").dom;b.leftSideTileDiv=b.leftSide.element.down(".tileDiv").dom;b.leftSideTileCanvas=b.leftSide.element.down("canvas").dom;b.leftSideImageContainer.image=b.leftSideImg;b.leftSideImageContainer.mediaDiv=b.leftSideMediaDiv;b.leftSideImageContainer.tileDiv=b.leftSideTileDiv;b.leftSideImageContainer.tileCanvas=b.leftSideTileCanvas;var a=b.getPageNo()+1;if(a%2==1){b.leftSideImageContainer.pageNo=(a-1)}else{b.leftSideImageContainer.pageNo=a}b.hiddenLeftImg=b.hiddenLeft.element.dom.children[0].children[0].children[0];b.hiddenLeftGradient=b.hiddenLeft.element.dom.children[0].children[0].children[1];b.checkPageMode(b.mode)},returnAdvertOffset:function(c){var b=this;var d=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var e=settings.reader.interstitialPageFlow;var a=editionFlatplanData.pageGroups[c-1];if(a!=null&&a.pages[0]!=null){if(!isNaN(a.pages[0].advertsAdded)){d=a.pages[0].advertsAdded}}}return d},setupPageTabs:function(){var g=this;g.pageTabs=settings.pageTabs;if(g.pageTabs!=null&&g.pageTabs.length>0){if(g.rightPageTabContainer==null&&g.leftPageTabContainer==null){g.rightPageTabContainer=Ext.create("InfinityMobile.view.PageTabContainer",{right:-40,top:0});g.leftPageTabContainer=Ext.create("InfinityMobile.view.PageTabContainer",{left:-40,top:0})}g.leftPageTabContainer.removeAll();g.rightPageTabContainer.removeAll();var b=g.getPageNo();var a=g.returnPageNos();for(var e in g.pageTabs){var f=g.pageTabs[e];var d=g.returnPageTabSide(f,a);var c=g.leftPageTabContainer;if(d=="right"){c=g.rightPageTabContainer}if(d!="none"){var h=Ext.create("InfinityMobile.view.PageTab",{pageNo:f.target,type:f.type,bgColour:f.bgColour,textColour:f.textColour,title:f.title,rolloutTitle:f.rolloutTitle,rolloutDesc:f.desc,rolloutTarget:f.rolloutTarget,rolloutType:f.rolloutType,side:d});c.add(h)}}g.zoomDiv.appendChild(g.rightPageTabContainer.element.dom);g.zoomDiv.appendChild(g.leftPageTabContainer.element.dom)}},removePageTabs:function(){var a=this;if(a.leftPageTabContainer!=null){a.zoomDiv.removeChild(a.leftPageTabContainer.element.dom);a.leftPageTabContainer.destroy();a.leftPageTabContainer=null}if(a.rightPageTabContainer!=null){a.zoomDiv.removeChild(a.rightPageTabContainer.element.dom);a.rightPageTabContainer.destroy();a.rightPageTabContainer=null}},returnPageTabSide:function(c,a){var d=this;var b="none";var e=c.target;if(c.rolloutType=="PAGE"&&c.rolloutTarget!=null){e=c.rolloutTarget}if(!isNaN(e)&&e!=-1){if(typeof flatPlanData!="undefined"&&flatPlanData.frontOffset!=null){e=Math.min(parseInt(e)+flatPlanData.frontOffset,flatPlanData.pageGroups.length)}}if(d.mode=="double"){if(a.left!=null&&a.right!=null){if((e>a.left&&e>a.right)||(c.type=="rollout"&&c.rolloutType!="PAGE")){b="right"}else{if(e<a.left&&e<a.right){b="left"}}}else{if(a.right!=null){b="right"}else{if(a.left!=null){b="left"}}}}else{if(a.left!=null&&a.right!=null){if(a.right!=null&&(e>a.right||c.type=="rollout"&&c.rolloutType!="PAGE")){b="right"}else{if(a.right!=null&&e<a.right){b="left"}}}else{if(c.type=="rollout"&&c.rolloutType!="PAGE"){b="right"}else{if(a.right!=null&&e<a.right){b="left"}else{if(a.right!=null&&e>a.right){b="right"}else{if(a.left!=null&&e>a.left){b="right"}else{if(a.left!=null&&e<a.left){b="left"}}}}}}}return b},hasPageTabs:function(){return settings.pageTabs!=null&&settings.pageTabs.length>0},returnPageNos:function(){var b=this;var c={};if(b.mode=="double"){if(b.leftPageObject!=null&&b.leftPageObject.type=="page"){c.left=b.leftPageObject.pageNum}if(b.rightPageObject!=null&&b.rightPageObject.type=="page"){c.right=b.rightPageObject.pageNum}}else{var a=parseInt(b.getPageNo())+1;if(b.rightPageObject!=null&&b.rightPageObject.type=="page"&&b.rightPageObject.pageNum==a){c.right=b.rightPageObject.pageNum}if(b.leftPageObject!=null&&b.leftPageObject.type=="page"&&b.leftPageObject.pageNum==a){c.left=b.leftPageObject.pageNum}}return c},onDragStart:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDrag:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDragFinished:function(c){var b=this;var a=b.scroller.position;b.zoomPosition=b.scroller.position;if(b.scale>1){c.stopPropagation()}},pagePainted:function(){var a=this;if(a.element!=null){a.setPageWidth();if(settings.leftSideAd!=null&&a.config.leftPage.type=="leftHandAd"&&(a.config.leftPage.adType=="dfp"||a.config.leftPage.adType=="url"||a.config.leftPage.adType=="adbridg")){a.rightSidePainted()}else{a.leftSidePainted();if(a.rightPage!=null){a.rightSidePainted()}else{a.rightSide.element.dom.style.zIndex="8"}}if(settings.wrapAd!=null){if(settings.wrapAd.hideLeftWrapperOnFirstPage!=null){if(settings.wrapAd.hideLeftWrapperOnFirstPage=="true"){a.fireEvent("checkWrapAd",a)}}}a.playCssAnimations()}},setPageWidth:function(){var a=this;if(a.hasPageTabs()){a.pageWidth=a.element.dom.clientWidth-80}else{a.pageWidth=a.element.dom.clientWidth}a.pageHeight=a.element.dom.clientHeight},leftSidePainted:function(){var b=this;var a=false;b.setImageSrc(b.leftSideImg,b.leftPage,b.leftPageObject);b.leftSideImg.type=b.config.leftPage.type;if(b.getPageNo()==0&&b.config.leftPage.type!="leftHandAd"){b.leftSide.setHeight("");b.leftSideDiv.style.height=""}b.setImageSrc(b.leftPrevPage,b.prevPage,b.prevPageObject);if(b.prevPage==null){b.topLeft.element.dom.style.visibility="hidden";b.bottomLeft.element.dom.style.visibility="hidden"}else{b.topLeft.element.dom.style.visibility="";b.bottomLeft.element.dom.style.visibility=""}if(b.hiddenLeftPage!=null){if(b.hiddenLeftPage.trim().length>0){$(b.hiddenLeftImg).css("display","none");b.setImageSrc(b.hiddenLeftImg,b.hiddenLeftPage,b.hiddenLeftPageObject)}else{$(b.hiddenLeftImg).css("visibility","hidden")}}else{$(b.hiddenLeftImg).css("visibility","hidden")}$(b.leftSideImg).css("visibility","hidden");$(b.leftPrevPage).css("display","none");$(b.leftSidePrevPageContainer).css("display","none");$(b.leftSidePrevPageContainer).css("background-color","white");b.leftPrevPage.onloa};b.leftSideImg.onload=function(){if(!b.viewDestroyed){if(b.config.leftPage.type!="sectionpage"){b.leftSideImageLoad()}if(b.config.rightPage.type=="sectionpage"){b.rightSideImageLoad()}if(b.mode=="single"){if(b.returnActiveImageContainer().className.indexOf("leftSideImgContainer")!=-1){$(b.leftSideImg).css("visibility","")}else{$(b.leftSideImg).css("visibility","hidden")}}else{$(b.leftSideImg).css("visibility","")}if(a){$(b.hiddenLeftImg).css("display","")}else{b.hiddenLeftImg.onload=function(){$(b.hiddenLeftImg).css("display","")}}}};b.hiddenLeftImg.onload=function(){a=true};if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){b.leftSide.setZIndex(9)}else{b.leftSide.element.dom.style.zIndex="10"}if(b.getPageNo()==0&&b.config.leftPage.type=="leftHandAd"&&(b.config.leftPage.adType=="dfp"||b.config.leftPage.adType=="url"||b.config.leftPage.adType=="adbridg")){b.leftSide.setZIndex(20)}},getImageUrl:function(b,c){var a=this;if(b!=null&&c.type!="leftHandAd"){if(window.location.protocol=="https:"){b=b.replace("http://pages.cdn.pagesuite.com","https://s3-eu-west-1.amazonaws.com/origin.pages.cdn.pagesuite.com")}if(settings.page.useMobileFullJpg){return"https://pages-mobile.pagesuite.com/images/"+c.guid+"/full.jpg"}else{if(settings.page.highResImage||settings.page.optimisedImage){return b.replace("page.jpg","largepage.jpg")}else{if(settings.page.jpg!=null&&settings.page.jpg!="page.jpg"){return b.replace("page.jpg",settings.page.jpg)}}}}else{if(c.type=="leftHandAd"&&c.adType=="dfp"){a.setupDfpLeftSideAdvert()}else{if(c.type=="leftHandAd"&&c.adType=="url"){a.setupUrlLeftSideAdvert()}else{if(c.type=="leftHandAd"&&c.adType=="adbridg"){if(a.advertDiv==null){}}}}}return b},setupUrlLeftSideAdvert:function(){var d=this;d.leftSideImg.style.width="";d.leftSideImg.style.height="";d.leftSideImg.src="";d.advertDiv=document.createElement("iframe");d.advertDiv.id=d.id+"leftSideAd";d.advertDiv.style.verticalAlign="middle";d.advertDiv.src=settings.leftSideAd.advertUrl;d.resizeUrlAdvert();d.advertDiv.style.border="none";d.leftSideImageContainer.style.display="inline-block";d.leftSideImageContainer.style.height="100%";d.leftSideImageContainer.style.width="";d.leftSideMediaDiv.style.visibility="hidden";d.leftSideImageContainer.appendChild(d.advertDiv);if(Ext.browser.is.IE){d.leftSideImageContainer.style.top="-30px"}if(settings.leftSideAd.adSizes!=null){var b="1024";var a="768";if(settings.leftSideAd.adSizes!=null){var c=settings.leftSideAd.adSizes.split(",");if(c!=null&&c.length==2){a=c[0];b=c[1]}}var e=$(d.leftSideImageContainer).find("iframe");if(e[0]!=null){d.iframe=e[0];d.iframe.style.height=b+"px";d.iframe.style.width=a+"px";d.thisFrameContent=d.iframe.contentDocument||d.iframe.contentWindow.document;d.resizeDfp()}}},resizeUrlAdvert:function(){var a=this;if(settings.leftSideAd.adSizes!=null&&a.iframe!=null){a.resizeDfp()}else{if(a.advertDiv!=null){a.advertDiv.style.height=a.height+"px";a.advertDiv.style.width=a.width+"px"}}},setupDfpLeftSideAdver},setupAdbridgLeftSideAdvert:function(){var c=this;if(!!c.advertDiv){return}var d=function(f){if(!!c.advertDiv&&f.slot.getSlotElementId()==c.advertDiv.id){c.adbridgSize=f.size;c.resizeAdbridg();a.removeEventListener("slotRenderEnded",d)}};try{var a=googletag.pubads().addEventListener("slotRenderEnded",d)}catch(b){console.warn("[DesktopPageViewer] Error caught:\n\t",b)}c.advertDiv=document.createElement("div");c.advertDiv.id=c.id+c.advertCounter+"leftSideAd";c.advertDiv.style.verticalAlign="middle";c.leftSideImageContainer.style.display="inline-block";c.leftSideImageContainer.style.height="100%";c.leftSideImageContainer.style.width="";c.leftSideImageContainer.appendChild(c.advertDiv);c.checkAdbridg(c.advertDiv);c.advertCounter++},checkAdbridg:function(b){var a=this;if(!!b&&(typeof settings!="undefined"&&!!settings.leftSideAd&&settings.leftSideAd.type=="adbridg")){b.setAttribute("data-adbridg-ad-class","adb-ee-sponsorship")}},setDfp:function(){var d=this;if(d.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([d.adSlot1])}var b="1024";var a="768";if(settings.leftSideAd.adSizes!=null){var c=settings.leftSideAd.adSizes.split(",");if(c!=null&&c.length==2){a=c[0];b=c[1]}}googletag.cmd.push(function(){try{d.adSlot1=googletag.defineSlot("/"+settings.leftSideAd.networkcode+"/"+settings.leftSideAd.adunit,[parseInt(a),parseInt(b)],d.advertDiv.id);d.adSlot1.addService(googletag.pubads());googletag.pubads().addEventListener("slotRenderEnded",function(g){if(g.slot==d.adSlot1){d.leftHandAdLoaded=!g.isEmpty;if(g.isEmpty&&settings.reader.bannerAd!=null&&settings.newsday!=null&&settings.newsday.showBannerOnLeftAdFailure=="true"){console.log("IS EMPTY");d.fireEvent("loadBannerAd")}d.resizeDfp()}});d.setDfpTargeting(d.adSlot1);googletag.enableServices()}catch(f){console.log(f)}});googletag.cmd.push(function(){googletag.display(d.advertDiv.id);try{if(googletag.pubads().isInitialLoadDisabled()){googletag.pubads().refresh([d.adSlot1])}}catch(f){console.warn("[DesktopPageViewer]: Error Caught\n",f)}});var e=$(d.leftSideImageContainer).find("iframe");if(e[0]!=null){d.iframe=e[0];d.thisFrameContent=d.iframe.contentDocument||d.iframe.contentWindow.document;d.resizeDfp()}},setDfpTargeting:function(f){var d=this;if(settings.leftSideAd&&settings.leftSideAd.targeting!=null&&settings.leftSideAd.targeting.length>0){var a=settings.leftSideAd.targeting.split("|");for(var c in a){var e=a[c];var b=e.split("*");if(b!=null&&b.length>=2){b[1]=b[1].replace("{{PAGE}}",d.pageNumber).replace("{{SECTION}}",d.section);f.setTargeting(b[0],b[1])}}}},resizeAdbridg:function(){var e=this;var d=e.height;var b=e.width;if(!d||!b){console.log("NO WIDTH OR HEIGHT");return}if(!!e.adbridgSize){var a=e.adbridgSize[0];var c=e.adbridgSize[1]}var f=1;if(a>b){f=b/a}if((c*f)>d){f=d/c}e.applyAdvertScale(f)},resizeDfp:function(){var d=this;var c=d.height;var a=1024;if(settings.leftSideAd.adSizes!=null){var b=settings.leftSideAd.adSizes.split(",");if(b!=null&&b.length==2){a=b[1]}}var e=1;if(a>c){e=c/a}d.applyAdvertScale(e)},applyAdvertScale:function(b){var a=this;if(!!a.advertDiv){a.advertDiv.style.transformOrigin="100% 0%";a.advertDiv.style.transform="scale3d("+b+", "+b+", 1)"}},leftSideImageLoad:function(b){var c=this;if(c.element!=null){if(c.leftPage!=null){var a=c.isActivePage(c.leftSideImageContainer,c.rightSideImageContainer);if(c.zoomMode=="fit"){c.leftSideImageFit()}else{c.leftSideImageFill();c.setUpPageTurnForImageFill()}if(a){c.pageLoaded(c.leftSideImageContainer)}c.leftThumbnailLoaded=true;c.fireEvent("leftThumbnailLoaded");if(c.config.leftPage.type=="sectionpage"){c.leftSide.element.dom.style.zIndex=15;$(c.leftSideImg).addClass("pointerCursor");c.leftSideImg.onclick=function(){c.fireEvent("goLeft")};c.leftSideImg.addEventListener("touchstart",function(){c.fireEvent("goLeft")})}else{c.leftSide.element.dom.style.zIndex=10}if(c.config.leftPage.type=="leftHandAd"){c.leftSide.setHeight("");c.leftSideDiv.style.height="";if(settings.leftSideAd.link!=null){c.leftSideMediaDiv.onclick=function(){window.open(settings.leftSideAd.link,"_blank")};c.leftSideMediaDiv.addEventListener("touchstart",function(){window.open(settings.leftSideAd.link,"_blank")});$(c.leftSideMediaDiv).addClass("pointerCursor")}}}}},leftSideImageFit:function(){var f=this;var b=f.isActivePage(f.leftSideImageContainer,f.rightSideImageContainer);f.naturalWidth=f.leftSideNaturalWidth=$(f.leftSideImg)[0].naturalWidth;f.naturalHeight=f.leftSideNaturalHeight=$(f.leftSideImg)[0].naturalHeight;var g=f.naturalWidth/f.naturalHeight;f.leftSideHeight=f.height=$(f.element.dom).height()-f.readerPaddingY;f.leftSideWidth=f.width=f.height*g;var d=0;if(f.hasPageTabs()){d=40}var e=$(f.element.dom).width()/2-f.readerPaddingX-d;if(f.mode=="single"){e=$(f.element.dom).width()}if(f.config.leftPage.type=="sectionpage"){}if(f.width<e){f.leftSideImageContainer.initialImageWidth=f.width;f.leftSideImageContainer.initialImageHeight=f.height;f.initialTranslateY=f.readerPaddingY;f.leftSideImageContainer.style.width=f.width+"px";if(f.config.leftPage.type!="sectionpage"){$(f.leftSideImg).css("height",f.height)}$(f.leftSideImg).css("width",f.width);$(f.leftSidePrevPageContainer).css("height",f.height);$(f.leftSidePrevPageContainer).css("width",f.width);$(f.leftPrevPage).css("height",f.height+"px");$(f.leftPrevPage).css("width",(f.width)+"px");$(f.leftSideImg).css("transform-origin","100% 0% 0px");$(f.hiddenLeftImg).css("height",f.height);$(f.hiddenLeftImg).css("width",f.width);$(f.hiddenLeftGradient).css("height",f.height);$(f.hiddenLeftGradient).css("width",f.width);$(f.leftSideImageContainer).css("height","");var c=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));c=Math.sqrt(c);$(f.leftSideDiv).css("height",c+"px");$(f.leftSideDiv).css("width",c+"px");$(f.topLeft.element.dom).css("top",f.top+f.readerPaddingY);$(f.topLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.hiddenLeftImg).css("right",0);if(b){if(f.mode=="single"){f.initialTranslateX=((e)-f.width)/2;f.rightSide.element.dom.style.visibility="hidden";f.leftSide.element.dom.style.visibility="visible";$(f.rightSideImg).css("z-index","1")}else{f.initialTranslateX=(($(f.element.dom).width()/2)-f.width)}}}else{var g=f.naturalHeight/f.naturalWidth;f.leftSideWidth=f.width=e;f.leftSideHeight=f.height=f.width*g;if(f.hasPageTabs()){f.initialTranslateX=d}f.leftSideImageContainer.initialImageWidth=f.width;f.leftSideImageContainer.initialImageHeight=f.height;f.leftSideImageContainer.style.width=f.width+"px";$(f.leftSideImg).css("height",f.height);$(f.leftSideImg).css("width",f.width);$(f.leftSidePrevPageContainer).css("height",f.height);$(f.leftSidePrevPageContainer).css("width",f.width);$(f.leftPrevPage).css("height",f.height);$(f.leftPrevPage).css("width",f.width);$(f.hiddenLeftImg).css("height",f.height);$(f.hiddenLeftImg).css("width",f.width);$(f.hiddenLeftGradient).css("height",f.height);$(f.hiddenLeftGradient).css("width",f.width);var c=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));c=Math.sqrt(c);$(f.leftSideDiv).css("height",c+"px");$(f.leftSideDiv).css("width",c+"px");if(f.config.leftPage.type!="sectionpage"&&f.config.leftPage.type!="leftHandAd"){if(f.height>=f.rightSideHeight||(f.rightSideHeight==null||isNaN(f.rightSideHeight))){f.top=($(f.element.dom).height()-f.height)/2}else{f.top=($(f.element.dom).height()-f.rightSideHeight)/2}}if(b){f.initialTranslateY=f.top;if(typeof isTribReader!="undefined"&&isTribReader==true){f.initialTranslateY=0}}$(f.topLeft.element.dom).css("top",f.top+f.readerPaddingY);$(f.topLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("bottom",f.top)}if(f.config.leftPage.type=="sectionpage"){$(f.leftSideImageContainer).css("height","");$(f.leftSideImg).css("height","");$(f.leftSideImageContainer).css("width",$(f.rightSideImageContainer).width());$(f.leftSideImg).css("width",$(f.rightSideImageContainer).width());f.topLeft.hide();f.bottomLeft.hide()}var h=60;if((navigator.maxTouchPoints)){h=70}f.gifLeft=f.topLeft.element.down("img").dom;$(f.gifLeft).css("width",h);$(f.gifLeft).css("height",h);$(f.gifLeft).css("transform","rotate(180deg) scale3d(1, 1, 1) translate3d(60px, 60px, 0px)");f.gifBottomLeft=f.bottomLeft.element.down("img").dom;$(f.gifBottomLeft).css("width",h);$(f.gifBottomLeft).css("height",h);$(f.gifBottomLeft).css("transform","scale3d(-1, 1, 1) translate3d(60px, 60px, 0px)")},leftSideImageFill:function(){var f=this;var b=f.isActivePage(f.leftSideImageContainer,f.rightSideImageContainer);f.naturalWidth=f.leftSideNaturalWidth=$(f.leftSideImg)[0].naturalWidth;f.naturalHeight=f.leftSideNaturalHeight=$(f.leftSideImg)[0].naturalHeight;var g=f.naturalHeight/f.naturalWidth;var e=$(f.element.dom).width()/2-f.readerPaddingX;if(f.mode=="single"){e=$(f.element.dom).width()-(f.readerPaddingX*2);if(b){$(f.rightSideImg).css("z-index","1")}}var d=2000;if(f.maxWidthPercentage!=null){d=e*(f.maxWidthPercentage/100)}f.leftSideWidth=f.width=Math.min(e,d);f.leftSideHeight=f.height=(f.width*g)+f.readerPaddingY;$(f.leftSideImg).css("width",f.width);$(f.leftSideImg).css("height",f.height-f.readerPaddingY);$(f.leftSideImageContainer).css("height",f.height-f.readerPaddingY);$(f.leftSideImageContainer).css("width",f.width);$(f.leftSideDiv).css("width",f.width);$(f.leftSideDiv).css("height",f.height-f.readerPaddingY);f.leftSideImageContainer.initialImageWidth=f.width;f.leftSideImageContainer.initialImageHeight=f.height-f.readerPaddingY;f.initialTranslateY=f.readerPaddingY;f.initialTranslateX=((e)-f.width)/2+f.readerPaddingX;if(f.mode=="double"){f.initialTranslateX=f.initialTranslateX*2}$(f.leftSideImg).css("height",f.height-f.readerPaddingY);$(f.leftSideImg).css("width",f.width);$(f.leftSidePrevPageContainer).css("height",f.height-f.readerPaddingY);$(f.leftSidePrevPageContainer).css("width",f.width);$(f.leftPrevPage).css("height",f.height-f.readerPaddingY);$(f.leftPrevPage).css("width",f.width);$(f.hiddenLeftImg).css("height",f.height-f.readerPaddingY);$(f.hiddenLeftImg).css("width",f.width);$(f.hiddenLeftGradient).css("height",f.height-f.readerPaddingY);$(f.hiddenLeftGradient).css("width",f.width);var c=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));c=Math.sqrt(c);$(f.leftSideDiv).css("height",c+"px");$(f.leftSideDiv).css("width",c+"px");f.scroller.setDisabled(false);if(f.scroller.maxPosition.x==0){f.scroller.setDirection("vertical")}f.scroller.setDirectionLock(true);var h=60;if((navigator.maxTouchPoints)){h=70}f.gifLeft=f.topLeft.element.down("img").dom;$(f.gifLeft).css("width",h);$(f.gifLeft).css("height",h);$(f.gifLeft).css("transform","rotate(180deg) scale3d(1, 1, 1) translate3d(60px, 60px, 0px)");if(f.config.leftPage.type=="sectionpage"){f.scroller.maxPosition.y=$(f.rightSideImg).height()-($(document).height()-$(f.rightSideImg).offset().top)}else{if(f.config.rightPage.type=="sectionpage"){f.scroller.maxPosition.y=$(f.leftSideImg).height()-($(document).height()-$(f.leftSideImg).offset().top)}}},rightSidePainted:function(){var b=this;var a=false;if(!Ext.browser.is.IE){if(b.element.dom.parentElement!=null){b.element.dom.parentElement.parentElement.style.overflow="hidden"}}b.top=0;$(b.rightSideImg).css("visibility","hidden");$(b.rightNextPage).css("display","none");$(b.rightSideNextPageContainer).css("display","none");$(b.rightSideNextPageContainer).css("background-color","white");b.rightNextPage.onloa};b.rightSideImg.onload=function(){if(!b.viewDestroyed){if(b.config.rightPage.type!="sectionpage"){b.rightSideImageLoad()}if(b.config.leftPage.type=="sectionpage"){b.leftSideImageLoad()}$(b.rightSideImg).css("visibility","");if(a){$(b.hiddenRightImg).css("display","")}else{b.hiddenRightImg.onloa}}if(settings.leftSideAd!=null&&b.config.leftPage!=null&&b.config.leftPage.type=="leftHandAd"&&(b.config.leftPage.adType=="dfp"||b.config.leftPage.adType=="url"||b.config.leftPage.adType=="adbridg")){b.leftSidePainted()}}};b.hiddenRightImg.onloa};var c=60;if((navigator.maxTouchPoints)){c=70}b.gifRight=b.topRight.element.down("img").dom;b.gifBottomRight=b.bottomRight.element.down("img").dom;$(b.gifRight).css("width",c);$(b.gifRight).css("height",c);$(b.gifBottomRight).css("width",c);$(b.gifBottomRight).css("height",c);$(b.gifRight).css("transform","translate3d(60px, 60px, 0px)");$(b.gifBottomRight).css("transform","translate3d(60px, 60px, 0px)");b.setImageSrc(b.rightSideImg,b.rightPage,b.rightPageObject);b.rightSideImg.type=b.config.rightPage.type;$(b.rightSideImg).css("position","absolute");b.setImageSrc(b.rightNextPage,b.nextPage,b.nextPageObject);if(b.nextPage==null){b.topRight.element.dom.style.visibility="hidden";b.bottomRight.element.dom.style.visibility="hidden"}if(b.hiddenRightPage!=null){if(b.hiddenRightPage.length>0){$(b.hiddenRightImg).css("display","none");b.setImageSrc(b.hiddenRightImg,b.hiddenRightPage,b.hiddenRightPageObject)}else{$(b.hiddenRightImg).css("visibility","hidden")}}else{$(b.hiddenRightImg).css("visibility","hidden")}$(b.rightSideImageContainer).css("transform-origin","0% 0% 0px");b.rightSide.element.dom.style.zIndex="9"},rightSideImageLoad:function(b){var c=this;if(c.element!=null){if(c.rightPage!=null){var a=c.isActivePage(c.rightSideImageContainer,c.leftSideImageContainer);if(c.zoomMode=="fit"){c.rightSideImageFit()}else{c.rightSideImageFill();c.setUpPageTurnForImageFill()}if(a){c.pageLoaded(c.rightSideImageContainer)}c.rightThumbnailLoaded=true;c.fireEvent("rightThumbnailLoaded");if(c.config.rightPage.type=="sectionpage"){c.rightSide.element.dom.style.zIndex=15;$(c.rightSideImg).addClass("pointerCursor");$(c.rightSideImg).css("z-index","99999");c.rightSideImg.onclick=function(){c.fireEvent("goRight")};c.rightSideImg.addEventListener("touchstart",function(){c.fireEvent("goRight")})}else{c.rightSide.element.dom.style.zIndex=10}}}},rightSideImageFit:function(){var f=this;var b=f.isActivePage(f.rightSideImageContainer,f.leftSideImageContainer);f.naturalWidth=f.rightSideNaturalWidth=$(f.rightSideImg)[0].naturalWidth;f.naturalHeight=f.rightSideNaturalHeight=$(f.rightSideImg)[0].naturalHeight;var g=f.naturalWidth/f.naturalHeight;f.rightSideHeight=f.height=$(f.element.dom).height()-f.readerPaddingY;f.rightSideWidth=f.width=(f.height*g);if(f.config.rightPage.type=="sectionpage"){if(f.leftSideImg!=null){f.width=$(f.leftSideImg).width()}f.topRight.hide();f.bottomRight.hide()}var d=0;if(f.hasPageTabs()){d=40}var e=$(f.element.dom).width()/2-f.readerPaddingX-d;if(f.mode=="single"){e=$(f.element.dom).width()}if(f.width<e){f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height;f.initialTranslateY=f.readerPaddingY;if(f.config.rightPage.type!="sectionpage"){$(f.rightSideImg).css("height",f.height)}else{$(f.rightSideImg).css("height","")}$(f.rightSideImg).css("width",f.width);$(f.rightSideImageContainer).css("height",f.height);$(f.rightSideImageContainer).css("width",f.width);$(f.rightSideNextPageContainer).css("height",f.height);$(f.rightSideNextPageContainer).css("width",f.width);$(f.rightNextPage).css("height",f.height);$(f.rightNextPage).css("width",f.width);$(f.hiddenRightImg).css("height",f.height);$(f.hiddenRightImg).css("width",f.width);$(f.hiddenRightGradient).css("height",f.height);$(f.hiddenRightGradient).css("width",f.width);var c=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));c=Math.sqrt(c);$(f.rightSideDiv).css("height",c+"px");$(f.rightSideDiv).css("width",c+"px");$(f.topRight.element.dom).css("top",f.top+f.readerPaddingY);$(f.topRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));if(b){if(f.mode=="single"){f.initialTranslateX=((e)-f.width)/2}else{f.initialTranslateX=(($(f.element.dom).width()/2)-f.width)}}}else{var g=f.naturalHeight/f.naturalWidth;f.rightSideWidth=f.width=e;f.rightSideHeight=f.height=f.width*g;f.initialTranslateX=d;f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height;$(f.rightSideImg).css("height",f.height);$(f.rightSideImg).css("width",f.width);$(f.rightSideImageContainer).css("height",f.height);$(f.rightSideImageContainer).css("width",f.width);$(f.rightSideNextPageContainer).css("height",f.height);$(f.rightSideNextPageContainer).css("width",f.width);$(f.rightNextPage).css("height",f.height);$(f.rightNextPage).css("width",f.width);$(f.hiddenRightImg).css("height",f.height);$(f.hiddenRightImg).css("width",f.width);$(f.hiddenRightGradient).css("height",f.height);$(f.hiddenRightGradient).css("width",f.width);var c=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));c=Math.sqrt(c);$(f.rightSideDiv).css("height",c+"px");$(f.rightSideDiv).css("width",c+"px");if(f.config.rightPage.type!="sectionpage"){if(f.height>=f.leftSideHeight||(f.leftSideHeight==null||isNaN(f.leftSideHeight))){f.top=($(f.element.dom).height()-f.height)/2}else{f.top=($(f.element.dom).height()-f.leftSideHeight)/2}}if(b){f.initialTranslateY=f.top;if(typeof isTribReader!="undefined"&&isTribReader==true){f.initialTranslateY=0}}$(f.topRight.element.dom).css("top",f.top+f.readerPaddingY);$(f.topRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("bottom",f.top)}if(f.config.leftPage.type=="sectionpage"){$(f.leftSideImageContainer).css("height","");$(f.leftSideImageContainer).css("width",f.width);$(f.leftSideImg).css("width",f.width)}else{if(f.config.leftPage.type=="leftHandAd"&&f.config.leftPage.adType=="adbridg"){f.resizeAdbridg()}}},rightSideImageFill:function(){var f=this;var b=f.isActivePage(f.rightSideImageContainer,f.leftSideImageContainer);f.naturalWidth=f.rightSideNaturalWidth=$(f.rightSideImg)[0].naturalWidth;f.naturalHeight=f.rightSideNaturalHeight=$(f.rightSideImg)[0].naturalHeight;var g=f.naturalHeight/f.naturalWidth;var e=$(f.element.dom).width()/2-f.readerPaddingX;if(f.mode=="single"){e=$(f.element.dom).width()-(f.readerPaddingX*2)}var d=2000;if(f.maxWidthPercentage!=null){d=e*(f.maxWidthPercentage/100)}f.rightSideWidth=f.width=Math.min(e,d);f.rightSideHeight=f.height=(f.width*g)+f.readerPaddingY;$(f.rightSideImg).css("width",f.width);$(f.rightSideImg).css("height",f.height-f.readerPaddingY);$(f.rightSideImageContainer).css("height",f.height-f.readerPaddingY);$(f.rightSideImageContainer).css("width",f.width);$(f.rightSideDiv).css("width",f.width);$(f.rightSideDiv).css("height",f.height-f.readerPaddingY);f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height-f.readerPaddingY;f.initialTranslateY=f.readerPaddingY;f.initialTranslateX=((e)-f.width)/2+f.readerPaddingX;if(f.mode=="double"){f.initialTranslateX=f.initialTranslateX*2}$(f.rightSideImageContainer).css("height",f.height-f.readerPaddingY);$(f.rightSideImageContainer).css("width",f.width);$(f.rightSideNextPageContainer).css("height",f.height-f.readerPaddingY);$(f.rightSideNextPageContainer).css("width",f.width);$(f.rightNextPage).css("height",f.height-f.readerPaddingY);$(f.rightNextPage).css("width",f.width);$(f.hiddenRightImg).css("height",f.height-f.readerPaddingY);$(f.hiddenRightImg).css("width",f.width);$(f.hiddenRightGradient).css("height",f.height-f.readerPaddingY);$(f.hiddenRightGradient).css("width",f.width);var c=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));c=Math.sqrt(c);$(f.rightSideDiv).css("height",c+"px");$(f.rightSideDiv).css("width",c+"px");f.scroller.setDisabled(false);if(f.scroller.maxPosition.x==0){f.scroller.setDirection("vertical")}f.scroller.setDirectionLock(true);if(f.config.rightPage.type=="sectionpage"){f.scroller.maxPosition.y=$(f.leftSideImg).height()-($(document).height()-$(f.leftSideImg).offset().top);f.topRight.hide();f.bottomRight.hide()}else{if(f.config.leftPage.type=="sectionpage"){f.scroller.maxPosition.y=$(f.rightSideImg).height()-($(document).height()-$(f.rightSideImg).offset().top)}else{if(f.config.leftPage.type=="leftHandAd"&&f.config.leftPage.adType=="adbridg"){f.resizeAdbridg()}}}},pageLoaded:function(a){var b=this;b.imagePageHeight=a.initialImageHeight;b.imageNaturalHeight=a.image.naturalHeight;b.zoomDivContainer.setStyle("visibility:visible");var c=(settings.page.maxZoomLevel*1000)/a.initialImageWidth;var d=Math.max(1,c);b.setMaxScale(d);$("#slider").attr("max",d);b.isPageRendered=true;b.resetPage()},isActivePag},returnActiveImageContaine},getImageContaine},getThumbnail:function(c,b){var a=this;var d="";if(b.image!=null){d=b.image;if(b.pageNum>1){if(b.image.indexOf("pages.cdn.pagesuite.com")!=-1){}}}c.src=d},completePDFLoaded:function(b){var a=this;if(a.isinitialized&&(!a.hasTiled||a.doToggleCheck)){a.doToggleCheck=false;mainPanel.fireEvent("removeSplash");a.loadPDFs(b);a.tryRenderMedia(true)}else{}},loadPDFs:function(c){var b=this;b.leftSideImageContainer.tileDiv.style.display="";b.rightSideImageContainer.tileDiv.style.display="";if(b.leftThumbnailLoaded){b.loadPDF(b.leftSideImageContainer,b.leftSideImg,c)}else{b.on("leftThumbnailLoaded})}if(b.rightThumbnailLoaded){b.loadPDF(b.rightSideImageContainer,b.rightSideImg,c);if(settings.page.ignorePDF=="true"&&b.rightNextPage!=null&&b.rightNextPage.src!=""){var a=document.createElement("img");a.src=b.rightNextPage.src.replace("/page.jpg","/largepage.jpg")}}else{b.on("rightThumbnailLoaded",function(){b.loadPDF(b.rightSideImageContainer,b.rightSideImg,c);if(settings.page.ignorePDF=="true"&&b.rightNextPage!=null&&b.rightNextPage.src!=""){var d=document.createElement("img");d.src=b.rightNextPage.src.replace("/page.jpg","/largepage.jpg")}})}},loadPDF:function(b,e,f){var c=this;if(settings.page.ignorePDF==null){if(b.pageNo>0&&c.imageVisible(e)){if(e!=null){if(e.type=="page"){var d={tiled:false,pageNumber:b.pageNo,pdfPage:null};b.tilePDF=d;var a=c.returnEditionPage(b);if(a.pdfPage!=null){c.setUpTiledPDFPage(a.pdfPage,b)}else{if(a.pdf!=""){c.requestPage(a,b)}}}else{}}else{}}else{}}else{c.setupImageRender(b)}},setupImageRender:function(a){var b=this;if(a.image.src.indexOf("/page.jpg")!=-1){if(a.tileImage!=null){a.tileCanvas.style.display="none";b.resizeTileImage(a.tileImage,a)}else{a.tileImage=document.createElement("img");a.tileImage.onload=function(){a.tileDiv.appendChild(this);b.resizeTileImage(this,a)};a.tileImage.src=a.image.src.replace("/page.jpg","/largepage.jpg");a.tileCanvas.style.display="none"}}a.tileCanvas.style.width="0px"},resizeTileImage:function(e,a){var c=this;var b=a.initialImageWidth;var f=Math.min(b,1300);var d=b/f;e.style.width=f+"px";e.style.webkitTransformOrigin=0+"px "+0+"px";e.style.MozTransformOrigin=0+"px "+0+"px";e.style.msTransformOrigin=0+"px "+0+"px";e.style.transformOrigin=0+"px "+0+"px";e.style.webkitTransform="scale3d("+d+","+d+",1)";e.style.MozTransform="scale3d("+d+","+d+",1)";e.style.msTransform="scale3d("+d+","+d+",1)";e.style.transform="scale3d("+d+","+d+",1)"},imageVisibl},returnEditionPag},requestPage:function(a,b){var c=this;if(a.pdfRequest!=null){var d=function(e){var f=returnPdfJsBaseVersion()==1?e.pdfInfo.numPages:e.numPages;if(f>0){e.getPage(1).then(function(g){c.setUpTiledPDFPage(g,b)})}};if(returnPdfJsBaseVersion()==1){a.pdfRequest.then(d)}else{if(returnPdfJsBaseVersion()>=2){a.pdfRequest.promise.then(d)}}}},canDesktopTouchSwipe:function(){if(settings.reader.enablePageSwipe=="true"){return true}else{return false}},useOptimizedImage:function(){if(settings.page.highResImage||settings.page.optimisedImage){return true}else{return false}},setUpTiledPDFPage:function(m,A){var w=this;var t=true;if(settings.page.ignorePDFOnFit!=null||(w.canDesktopTouchSwipe()&&w.useOptimizedImage())){var e=w.returnImageRatio();if(e<1){t=false}}if(t){var d=A.tileCanvas;w.setupCanvasDPI(d);var f=d.dpi;var o=!!m&&!!m.pageInfo?m.pageInfo.view:m.view;var v=o[2]-o[0];var g=o[3]-o[1];var n=A.initialImageWidth*w.scale;var c=A.initialImageHeight*w.scale;var r=1200;if(settings.page.minPdfWidthDownscale!=null){r=settings.page.minPdfWidthDownscale}var l=Math.min(r,n*2);r=l;var r=Math.max(r,v);var z=r/v;var j=g*z;var y=Math.max(n/v,c/g);A.scales=w.returnPDFScale(y,c,g,z);if((A.scales.zoomScale<1)&&(settings.page.downsizing!=null&&settings.page.downsizing=="image")){A.tileDiv.style.display="none"}else{if(A.scales.zoomScale<0.333){A.tileDiv.style.display="none"}else{var s=v*A.scales.pdfScale;var q=g*A.scales.pdfScale;w.setUpCanvas(A,d,s,q);A.scales.dpi=d.dpi;var u=!!PDFJS&&returnPdfJsBaseVersion()==1?m.getViewport(A.scales.pdfScale):m.getViewport({scale:A.scales.pdfScale});if(!!window.renderOptions&&window.renderOptions.disableCanvasAlpha){var b=d.getContext("2d",{alpha:false})}else{var b=d.getContext("2d")}var k={canvasContext:b,viewport:u};var h=function(){w.displayPDF(A,d)};var a=function(){A.tileDiv.style.zIndex=-1;setTimeou},1500)};var };var p=w.getPageNo()+1;w.fireEvent("renderPDF",m,k,p,A.pageNo,h,a,x)}}}else{if(w.leftSideImageContainer!=null&&w.leftSideImageContainer.tileDiv!=null){w.leftSideImageContainer.tileDiv.style.display="none"}if(w.rightSideImageContainer!=null&&w.rightSideImageContainer.tileDiv!=null){w.rightSideImageContainer.tileDiv.style.display="none"}}},displayPDF:function(b,a){var c=this;if(b.scales.zoomScale<1){a.style.webkitTransform="scale3d("+b.scales.zoomScale+","+b.scales.zoomScale+",1)";a.style.MozTransform="scale3d("+b.scales.zoomScale+","+b.scales.zoomScale+",1)";a.style.msTransform="scale3d("+b.scales.zoomScale+","+b.scales.zoomScale+",1)"}else{a.style.webkitTransform="";a.style.MozTransform="";a.style.msTransform=""}b.tileDiv.style.zIndex="";a.style.animationName="fadeIn";a.style.animationDuration="0.25s";a.style.visibility="visible";c.hasTiled=true},returnPDFScale:function(a,d,b,e){var c={minPdfScale:e,realScale:a,pdfScale:e,zoomScale:1};if(a>e){c.pdfScale=a;c.zoomScale=1}else{c.pdfScale=e;c.zoomScale=(1/e)*a}return c},checkHighResImage:function(a,c){var b=this;devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;var d=b.returnImageRatio();if((settings.page.ignorePDFOnFit!=null||settings.page.optimisedImage!=null)&&d<1){return true}else{if(devicePixelRatio<=2&&backingStoreRatio<=1&&b.zoomMode=="fit"&&b.scale<=1&&settings.page.highResImage!=null){return true}else{return false}}},returnImageRati},setupCanvasDPI:function(a){var d=this;if(!!window.renderOptions&&window.renderOptions.disableCanvasAlpha){var b=a.getContext("2d",{alpha:false})}else{var b=a.getContext("2d")}devicePixelRatio=parseInt(window.devicePixelRatio)||1,backingStoreRatio=b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1;var c=devicePixelRatio/backingStoreRatio;if(c<1){c=1}if(settings.page.optimizeChromeHighRes!=null&&settings.page.optimizeChromeHighRes=="true"){if(Ext.browser.is.Chrome&&d.getMaxScale()>2&&d.getMaxScale()/2<d.scale){c=1}}a.dpi=c},setUpCanvas:function(c,b,g,f){var e=this;if(e.element!=null){b.style.visibility="hidden";var d=c.initialImageWidth;var a=c.initialImageHeight;c.tileDiv.style.width="100%";c.tileDiv.style.height="100%";c.tileDiv.style.top=0+"px";c.tileDiv.style.left=0+"px";c.tileDiv.style.webkitTransform="scale3d("+(1/e.scale)+","+(1/e.scale)+",1)";c.tileDiv.style.MozTransform="scale3d("+(1/e.scale)+","+(1/e.scale)+", 1)";c.tileDiv.style.msTransform="scale3d("+(1/e.scale)+","+(1/e.scale)+",1)";c.tileDiv.style.display="";b.pageWidth=g;b.pageHeight=f}},tryRenderMedi},loadMediaImage:function(c,f){var e=this;try{var a=c.pageNo;if(e.canLoadMedia(a)){var b=flatPlanData.reversePageMapper[a];e.fireEvent("loadMedia",e,b,f)}else{$(f).empty()}e.mediaLoaded=true}catch(d){}},canLoadMedi},tryReloadGIF:function(){var b=this;if(b.renderedMedia){var a=b.image;var c=b.landscapeimage;b.reloadMediaGIF(b.rightSideImageContainer,b.rightSideMediaDiv);b.reloadMediaGIF(b.leftSideImageContainer,b.leftSideMediaDiv)}},reloadMediaGIF:function(c,e){var d=this;var a=c.pageNo;if(d.canLoadMedia(a)){var b=flatPlanData.reversePageMapper[a];d.fireEvent("reloadGIF",d,b,e)}},onZoomStart:function(g,d){var c=this;c.hideCanvases();var f=(c.pageWidth/2);var e=(c.pageHeight/2);var b=f+c.scroller.position.x;var a=e+c.scroller.position.y;c.zoomPointX=((b)/(c.scale));c.zoomPointY=((a)/(c.scale));c.offsetX=(f-c.zoomPointX);c.offsetY=(e-c.zoomPointY);c.offsetScrollerX=c.offsetX+c.scroller.position.x;c.offsetScrollerY=(c.offsetY+c.scroller.position.y);c.initializeTouch(c.zoomPointX,c.zoomPointY);c.translateX+=c.offsetScrollerX;c.translateY+=c.offsetScrollerY;c.applyTransform(c.scale)},hideCanvases:function(){var c=this;var a=c.leftSideImageContainer.tileCanvas;a.style.visibility="hidden";var b=c.rightSideImageContainer.tileCanvas;b.style.visibility="hidden"},onZoom:function(c,b){var a=this;a.currentScale=b.dom.valueAsNumber;a.applyTransform(a.currentScale)},onZoomEnd:function(c,b){var a=this;if(a.currentScale<=1){a.resetPage();a.finishZoom(false);if(a.zoomMode=="fit"&&a.mode=="double"){a.showNavButtons()}else{a.hideNavButtons()}}else{a.scale=a.currentScale;a.finishZoom(false);a.hideNavButtons()}if(a.zoomTileInterval!=null){clearInterval(a.zoomTileInterval)}a.trackZoomLevel();a.zoomTileInterval=setInterval(function(){a.zoomTile(a)},500)},trackZoomLevel:function(){var a=this;mainPanel.fireEvent("trackZoomLevel",a)},zoomTil},zoomOnPoint:function(b,a){var g=this;if(g.zoomLevels>1){var h=parseFloat(g.getMaxScale().toFixed(2));var d=parseFloat(((h-1)/g.zoomLevels).toFixed(2));if(g.scale>1&&g.scale<h){for(var e=1;e<=g.zoomLevels;e++){var f=(parseFloat(d*e)+1);if(g.scale<f){g.currentZoomLevel=e;break}}}else{if(g.scale>=h){g.currentZoomLevel=g.zoomLevels+1}else{g.currentZoomLevel=1}}var c=(parseFloat(d*g.currentZoomLevel)+1);if(g.currentZoomLevel<g.zoomLevels){b=(g.scroller.position.x)/g.scale;a=(g.scroller.position.y)/g.scale;g.initializeTouch(b,a);g.scale=c;g.zoomLevel="mid";if(document.getElementById("slider")!=null){document.getElementById("slider").value=c;g.hideNavButtons()}}else{if(g.currentZoomLevel<=g.zoomLevels){b=(g.scroller.position.x)/g.scale;a=(g.scroller.position.y)/g.scale;g.initializeTouch(b,a);g.scale=h;g.zoomLevel="full";if(document.getElementById("slider")!=null){document.getElementById("slider").value=g.getMaxScale();g.hideNavButtons()}}else{g.zoomLevel="none";g.doubleTapReset()}}}else{if(g.scale==1){g.initializeTouch(b,a);g.scale=g.getMaxScale();if(document.getElementById("slider")!=null){document.getElementById("slider").value=g.getMaxScale();g.hideNavButtons()}}else{g.doubleTapReset()}}if(Ext.browser.is.Firefox&&g.zoomMode=="fill"){g.scroller.maxPosition.y=g.height-g.getScrollable()._indicators.y._length}},doubleTapRese},onDoubleTap:function(c){var b=this;b.hideCanvases();var a=b.scroller.position;b.zoomPosition=b.scroller.position;b.zoomPointX=(c.pageX-(b.wrapAdOffset)+b.scroller.position.x)/b.scale;b.zoomPointY=(c.pageY-(b.topPadding)+b.scroller.position.y)/b.scale;var f=b.scroller.position.y/b.scroller.maxPosition.y;var e=(b.pageWidth/2);var d=(b.pageHeight/2);b.offsetY=(c.pageY-b.zoomPointY);b.zoomOnPoint(b.zoomPointX,b.zoomPointY);b.finishZoom(true);b.trackZoomLevel()},resetPage:function(){var c=this;var d=c.returnActiveImageContainer();var b=d.clientWidth;var a=d.clientHeight;var e=(b*2);if(c.mode=="single"){e=b}c.zoomDiv.dom.style.width=e+"px";c.zoomDiv.dom.style.height=a+"px";c.setMediaContainer();c.translateX=c.initialTranslateX;c.translateY=c.initialTranslateY;c.scale=1;c.applyTransform(c.scale);if(document.getElementById("slider")!=null){document.getElementById("slider").value=1}if(c.zoomMode=="fit"){c.setupPageTabs()}},initializeTouch:function(b,a){var c=this;c.elementTouchX=b-c.translateX;c.elementTouchY=a-c.translateY;c.setOrigin(c.elementTouchX,c.elementTouchY)},setOrigin:function(a,c){var b=this;b.zoomDiv.dom.style.webkitTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.MozTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.msTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.transformOrigin=a+"px "+c+"px"},applyTransfor},finishZoo},resetZoom:function(o){var n=this;if(n.rightSideMediaDiv!=null){if(n.rightSideMediaDiv.children.length>0){for(var h=0;h<n.rightSideMediaDiv.children.length;h++){try{var p=n.rightSideMediaDiv.children[h].children[0].children[0].children[0].children[0].children[0];if(p.className=="tool-tip"){p.style.fontSize="12px";p.style.padding="5px";p.style.border="2px solid white";p.style.borderRadius="5px"}}catch(k){}}}}if(n.leftSideMediaDiv!=null){if(n.leftSideMediaDiv.children.length>0){for(var h=0;h<n.leftSideMediaDiv.children.length;h++){try{var p=n.leftSideMediaDiv.children[h].children[0].children[0].children[0].children[0].children[0];if(p.className=="tool-tip"){p.style.fontSize="12px";p.style.padding="5px";p.style.border="2px solid white";p.style.borderRadius="5px"}}catch(k){}}}}n.scrollerDiv.dom.style.width="";if(Ext.browser.is.IE||navigator.userAgent.indexOf("Edge")>=0){n.mediaDivContainer.setLeft("0px");n.mediaDivContainer.setWidth("100%")}else{n.mediaDivContainer.setStyle({left:"0px",width:"100%"})}var d="unset";n.overflowMediaDiv.setStyle({width:"50%",left:"0%",webkitTransform:d,MozTransform:d,msTransform:d,transform:d});if(n.zoomMode=="fit"){n.scrollerDiv.dom.style.height=""}else{if(n.mode=="single"){n.scrollerDiv.dom.style.height=$(n.returnActiveImageContainer()).height()+"px"}else{if(n.config.rightPage.type!="sectionpage"&&n.config.leftPage.type!="sectionpage"){var a=Math.max(n.leftSideImg.clientHeight,n.rightSideImg.clientHeight);n.scrollerDiv.dom.style.height=a+"px"}else{n.scrollerDiv.dom.style.height=$(n.returnActiveImageContainer()).height()+"px"}}}if(n.zoomMode=="fit"){n.scrollTo(0,0)}else{var j=n.zoomPointX-n.initialTranslateX;var g=n.zoomPointY-n.initialTranslateY;var m=j*n.scale;var l=g*n.scale;var c=m-n.zoomPointX+n.offsetX;var b=l-n.zoomPointY-n.offsetY;if(n.mode=="single"){n.translateX=n.initialTranslateX}n.translateY=n.initialTranslateY;var f=n.offsetY;n.offsetX=0;n.offsetY=0;if(b<0){b=0}if(Ext.browser.is.Firefox){b=Math.max(n.scroller.minPosition.y,b);n.scroller.refresh(n.scroller);b=Math.min(n.scroller.maxPosition.y,b)}n.scroller.scrollTo(0,b)}if(n.zoomMode=="fill"){n.scroller.setDisabled(false);n.scroller.setDirection("vertical");n.scroller.setDirectionLock(true);n.fireEvent("fillMode",n);if(n.mode=="double"){if(n.config.rightPage.type=="sectionpage"){$(n.topRight.element.dom).css("display","none")}else{$(n.topRight.element.dom).css("display","")}if(n.config.leftPage.type=="sectionpage"){$(n.topLeft.element.dom).css("display","none")}else{$(n.topLeft.element.dom).css("display","")}}}else{n.scroller.setDisabled(true);n.fireEvent("fitMode");if(n.config.rightPage.type=="sectionpage"){}if(n.config.leftPage.type=="sectionpage"){$(n.leftSideImg).css("height","")}}n.offsetX=0;n.offsetY=0;n.scroller.position.x=0;n.zoomDiv.dom.style.position="absolute";n.zoomDiv.dom.style.left="";n.hiddenLeft.element.dom.style.left="";if(n.zoomMode=="fit"){n.fireEvent("fitMode")}else{n.fireEvent("fillMode")}if(settings.reader.savePageMode=="true"){localStorage.setItem("pageMode_"+publicationguid,n.mode);localStorage.setItem("zoomMode_"+publicationguid,n.zoomMode)}if(settings.leftSideAd!=null&&n.config.leftPage.type=="leftHandAd"&&(n.config.leftPage.adType=="dfp"||n.config.leftPage.adType=="adbridg")){if(n.isinitialized){n.config.leftPage.adType=="dfp"?n.resizeDfp():n.resizeAdbridg()}}else{if(settings.leftSideAd!=null&&n.config.leftPage.type=="leftHandAd"&&n.config.leftPage.adType=="url"){n.resizeUrlAdvert()}}n.hasTiled=false;n.setCls("zoomed-out");n.startTiling()},setZoom:function(a){var v=this;currentPageDebug=this;if(v.rightSideMediaDiv!=null){if(v.rightSideMediaDiv.children.length>0){for(var p=0;p<v.rightSideMediaDiv.children.length;p++){try{var f=v.rightSideMediaDiv.children[p].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/v.scale)+"px";f.style.padding=(5/v.scale)+"px";f.style.border=(2/v.scale)+"px solid white";f.style.borderRadius=(5/v.scale)+"px";f.style.backfaceVisibility="hidden"}}catch(r){}}}}if(v.leftSideMediaDiv!=null){if(v.leftSideMediaDiv.children.length>0){for(var p=0;p<v.leftSideMediaDiv.children.length;p++){try{var f=v.leftSideMediaDiv.children[p].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/v.scale)+"px";f.style.padding=(5/v.scale)+"px";f.style.border=(2/v.scale)+"px solid white";f.style.borderRadius=(5/v.scale)+"px";f.style.backfaceVisibility="hidden"}}catch(r){}}}}var u=v.returnActiveImageContainer();v.zoomDiv.dom.style.width=(100/v.scale)+"%";var x=v.initialTranslateX;if(v.mode=="single"){x=0}if(Ext.browser.is.IE||navigator.userAgent.indexOf("Edge")>=0){v.mediaDivContainer.setLeft(x+"px");v.mediaDivContainer.setWidth("calc(100% - "+(parseInt(v.initialTranslateX)*2)+"px)")}else{v.mediaDivContainer.setStyle({left:x+"px",width:"calc(100% - "+(parseInt(v.initialTranslateX)*2)+"px)"})}var j="translate3d(-100%, 0, 0)";v.overflowMediaDiv.setStyle({width:"calc(50% - "+(v.initialTranslateX)+"px)",left:"50%",webkitTransform:j,MozTransform:j,msTransform:j,transform:j});var c=(u.initialImageWidth)*v.scale*2;var h=(v.pageWidth*v.scale);if(v.mode=="single"){c=(u.initialImageWidth)*v.scale}var m=(u.initialImageHeight)*v.scale;var b=(v.pageHeight*v.scale);var w=Math.max(c,h);var t=Math.max(m,b);v.scrollerDiv.dom.style.width=w+"px";v.scrollerDiv.dom.style.height=t+"px";v.setOrigin(0,0);var d=true;v.zoomDiv.dom.style.position="absolute";v.zoomDiv.dom.style.left="";if(v.mode=="single"){v.translateX=v.initialTranslateX*v.scale;v.translateY=v.initialTranslateY*v.scale;v.offsetX=(v.offsetX*-1)+(v.initialTranslateX*v.scale);v.offsetY=(v.offsetY)+(v.initialTranslateY*v.scale)}else{v.translateX=0;v.translateY=v.initialTranslateY*v.scale;v.offsetX=(v.offsetX*-1)+(v.initialTranslateX*v.scale);v.offsetY=((v.offsetY*-1)+(v.initialTranslateY*v.scale))*-1}v.applyTransform(v.scale);v.scroller.setDisabled(false);v.scroller.setDirection("both");var n=v.zoomPointX-v.initialTranslateX;var k=v.zoomPointY-v.initialTranslateY;var s=n*v.scale;var q=k*v.scale;var o=s-v.zoomPointX+v.offsetX;var l=q-v.zoomPointY-v.offsetY;if(v.mode=="single"){v.translateX=v.initialTranslateX}v.translateY=v.initialTranslateY;var g=v.offsetY;v.offsetX=0;v.offsetY=0;v.scroller.scrollTo(o,l);if(Ext.browser.is.Firefox){if(v.scrollerDiv.setScrollable!=null){v.scrollerDiv.setScrollable({direction:"both"});v.scrollerDiv.getScrollable().getScroller().scrollTo(o,l)}else{if(v.zoomMode=="fit"){v.scroller.maxPosition.x=h-$(v.element.dom).width();v.scroller.maxPosition.y=b-$(v.element.dom).height();if(l<=0){l=0}else{if(l>=b-$(v.element.dom).height()){l=b-$(v.element.dom).height()}}if(o<=0){o=0}else{if(o>=h-$(v.element.dom).width()){o=h-$(v.element.dom).width()}}}else{v.scroller.maxPosition.x=h-$(v.element.dom).width();v.scroller.maxPosition.y=m-$(v.element.dom).height();if(l<=0){l=0}else{if(l>=m-$(v.element.dom).height()){l=m-$(v.element.dom).height()}}if(o<=0){o=0}else{if(o>=h-$(v.element.dom).width()){o=h-$(v.element.dom).width()}}}v.scroller.scrollTo(o,l)}}if(v.scale>1){v.setCls("zoomed-in")}if(a){v.startTiling()}v.removePageTabs()},scrollTo:function(a,c){var b=this;b.scroller.scrollTo(a,c)},hideNavButtons:function(){var a=this;a.topRight.setHidden(true);a.topLeft.setHidden(true);a.bottomRight.setHidden(true);a.bottomLeft.setHidden(true)},showNavButton},startTiling:function(){var a=this;a.loadPDFs()},toggleDPS:function(c,a){var b=this;b.checkPageMode(c);b.initialTranslateX=0;b.initialTranslateY=0;b.fireEvent("checkAudioOnToggle",b);b.pauseVideos();b.resetZoom()},checkPageMod},toggleDPSDouble:function(){var b=this;b.mode="double";b.leftSide.element.dom.style.visibility="visible";$(b.leftSideImg).css("visibility","");b.leftSide.element.dom.style.right="0%";b.leftSide.setWidth("50%");b.leftSideDiv.style.left="";b.leftSideImageContainer.style.left="";b.rightSide.element.dom.style.visibility="visible";$(b.rightSideImg).css("visibility","");b.rightSide.element.dom.style.left="50%";b.rightSide.setWidth("50%");b.rightSideDiv.style.left="";b.rightSideImageContainer.style.left="";var a=b.getPageNo();a=flatPlanData.pageMapper[a+1];b.rightSide.setLeft("50%");b.hiddenRight.setHidden(false);b.hiddenLeft.setHidden(false);if(a+pageOffset==0){b.leftSide.element.dom.style.visibility="hidden"}else{if(a==2){b.hiddenLeftImg.style.visibility="hidden"}else{if(a+pageOffset==flatPlanData.pageGroups.length){b.rightSide.element.dom.style.visibility="hidden";$(b.topRight.element.dom).css("visibility","hidden");$(b.bottomRight.element.dom).css("visibility","hidden")}}}b.rightSide.element.down("canvas").show();b.leftSide.element.down("canvas").show();if(b.zoomMode=="fill"){b.setUpPageTurnForImageFill();b.removePageTabs()}else{b.hiddenRight.show();b.hiddenLeft.show();b.showNavButtons();$(b.topRight.element.dom).css("top",b.top);$(b.topRight.element.dom).css("right",($(b.element.dom).width())-b.width-($(b.element.dom).width()/2))}var c=b.parent&&b.parent.getActiveItem()?b.parent.getActiveItem():null;if(b.config.leftPage.type=="leftHandAd"&&b.config.leftPage.adType=="adbridg"&&c==b){this.setupAdbridgLeftSideAdvert()}if(settings.leftSideAd!=null&&b.config.leftPage.type=="leftHandAd"&&(b.config.leftPage.adType=="dfp"||b.config.leftPage.adType=="adbridg")){if(b.isinitialized){b.config.leftPage.adType=="dfp"?b.resizeDfp():b.resizeAdbridg()}}else{if(settings.leftSideAd!=null&&b.config.leftPage.type=="leftHandAd"&&b.config.leftPage.adType=="url"){b.resizeUrlAdvert()}}},toggleDPSSingle:function(){var j=this;j.mode="single";var g=false;if(g){var c=j.leftSide;var h=j.leftSideDiv;var m=j.leftSideImageContainer;var k=j.rightSide;var b=j.rightSideDiv;var f=j.rightSideImageContainer;a=flatPlanData.reversePageMapper[a+1];var e=j.getPageNo()+1;var l=j.returnAdvertOffset(e+pageOffset);j.leftSide.element.down("canvas").hide();c.element.dom.style.visibility="hidden";k.element.dom.style.left="0%";b.style.left="0%";f.style.left="0%"}else{var c=j.leftSide;var h=j.leftSideDiv;var m=j.leftSideImageContainer;var k=j.rightSide;var b=j.rightSideDiv;var f=j.rightSideImageContainer;var a=j.getPageNo();if(a==-1){a=0}a=flatPlanData.reversePageMapper[a+1];var e=j.getPageNo()+1;var l=j.returnAdvertOffset(e+pageOffset);if((a+l)%2==0){c=j.rightSide;h=j.rightSideDiv;m=j.rightSideImageContainer;k=j.leftSide;b=j.leftSideDiv;f=j.leftSideImageContainer;j.rightSide.element.down("canvas").hide()}else{j.leftSide.element.down("canvas").hide()}c.element.dom.style.visibility="hidden";k.element.dom.style.left="0%";if(j.returnActiveImageContainer().className.indexOf("leftSideImgContainer")!=-1){$(j.leftSideImg).css("visibility","")}else{$(j.leftSideImg).css("visibility","hidden")}b.style.left="0%";f.style.left="0%";j.rightSide.setLeft(0);j.hiddenRight.setHidden(true);j.hiddenLeft.setHidden(true);j.hideNavButtons();if(j.config.leftPage.type=="leftHandAd"&&j.config.leftPage.adType=="adbridg"&&!!j.advertDiv){var d=$("#"+j.advertDiv.id)[0];if(d!=null){$(j.advertDiv).remove();delete j.advertDiv}}}},toggleDPSNonActiv},toggleDPSPageNumber:function(g,f){var e=this;var a=e.returnReverseMappedPageNumber(e.getPageNo());var c=e.returnReverseMappedPageNumber(f.getPageNo());var b=a-c;var d=0;if(g=="double"){if(flatPlanData.bookmarks!=null){if(flatPlanData.bookmarks.indexOf(c+2)!=-1&&b>0&&c+2%2==1){d=0}else{if(flatPlanData.bookmarks.indexOf(c+1)!=-1&&b<0&&c+1%2==1){d=0}else{d=b}}}else{d=b}}else{d=parseInt(b/-2)}e.adjustPageNo(d,g)},returnMappedPageNumbe},returnReverseMappedPageNumbe},needToReloadPag},reloadPage:function(b){var a=this;a.mode=b;a.leftThumbnailLoaded=false;a.rightThumbnailLoaded=false;if(settings.leftSideAd!=null&&a.config.leftPage!=null&&a.config.leftPage.type=="leftHandAd"&&a.config.leftPage.adType=="dfp"){a.destroyDfpLeftHandAd()}a.disableTiling();a.asignPages();a.setupPages();a.renderedMedia=false;a.tryRenderMedia(false);if(a.isPageRendered){a.pagePainted();if(a.mode!="single"&&a.zoomMode!="fill"){a.finishZoom(true)}}},destroyDfpLeftHandAd:function(){var a=this;var b=$("#"+a.advertDiv.id)[0];if(b!=null){$(a.advertDiv).remove();if(a.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([a.adSlot1])}delete a.advertDiv}},asignPages:function(){var m=this;var k=editionFlatplanData.pageGroups;var g=m.getPageNo()+1+pageOffset;var e="";var a="";var j="";var c="";var n="";var p="";if(g%2==pageOffset){g++}g--;g=Math.max(0,parseInt(g));var l=g;if(l<=(k.length-1)){c=k[(l)].pages[0]}var h=(g-1);if(h>=0){j=k[h].pages[0]}var b=(g-2);if(b>=0){a=k[b].pages[0]}var d=(g-3);if(d>=0){e=k[d].pages[0]}var o=(g+1);if(o<=(k.length-1)){n=k[(o)].pages[0]}var f=(g+2);if(f<=(k.length-1)){p=k[(f)].pages[0]}m.config.rightPage=c;m.config.leftPage=j;m.config.previousPage=a;m.config.hiddenLeftPage=e;m.config.nextPage=n;m.config.hiddenRightPage=p},setInitialVariable},toggleZoomMode:function(c){var b=this;var a;var d=false;b.zoomMode=c;if(b.zoomMode=="fit"){b.fireEvent("fitMode");if(b.mode=="double"){b.hiddenRight.show();b.hiddenLeft.show();b.showNavButtons();$(b.topRight.element.dom).css("top",b.top);$(b.topRight.element.dom).css("right",($(b.element.dom).width())-b.width-($(b.element.dom).width()/2))}else{b.hideNavButtons()}b.element.dom.onmousewheel=(function(g){if(b.scale>1){d=true;clearTimeout(a);var f=!Ext.os.is.MacOS?120:30;if(g.wheelDelta>0){if(b.scroller.position.y-f>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-f);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(b.scroller.position.y+f<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+f);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}a=setTimeout(function(){if(!d){b.onMouseEnd()}},500);d=false}});b.element.dom.addEventListener("DOMMouseScroll",function(f){if(b.scale>1){d=true;clearTimeout(a);if(f.detail<=0){if(b.scroller.position.y-60>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-60);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(f.detail>=0){if(b.scroller.position.y+60<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+60);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}}a=setTimeout(function(){if(!d){b.onMouseEnd()}},500);d=false}})}else{b.hideNavButtons();b.fireEvent("fillMode");b.fireEvent("keyControls");b.removePageTabs();b.element.dom.onmousewheel=(function(g){d=true;clearTimeout(a);var f=!Ext.os.is.MacOS?120:30;if(g.wheelDelta>0){if(b.scroller.position.y-f>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-f);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(b.scroller.position.y+f<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+f);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}a=setTimeout(function(){if(!d){b.onMouseEnd()}},500);d=false});b.element.dom.addEventListener("DOMMouseScroll",function(f){d=true;clearTimeout(a);if(f.detail<=0){if(b.scroller.position.y-60>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-60);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(b.scroller.position.y+60<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+60);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}a=setTimeou},500);d=false});if(b.mode=="double"){b.setUpPageTurnForImageFill();if(b.config.rightPage.type=="sectionpage"){b.topRight.hide();b.bottomRight.hide()}}}b.initialTranslateX=0;b.initialTranslateY=0;if(b.isPageRendered){b.leftSideImageLoad();b.rightSideImageLoad();b.resetZoom();$(b.rightSideDiv).css("transform","");$(b.rightSideImageContainer).css("transform","")}if(Ext.browser.is.Firefox&&b.zoomMode=="fill"){b.scroller.maxPosition.y=b.height-b.getScrollable()._indicators.y._length}if(settings.leftSideAd!=null&&b.config.leftPage.type=="leftHandAd"&&(b.config.leftPage.adType=="dfp"||b.config.leftPage.adType=="adbridg")){if(b.isinitialized){b.config.leftPage.adType=="dfp"?b.resizeDfp():b.resizeAdbridg()}}else{if(settings.leftSideAd!=null&&b.config.leftPage.type=="leftHandAd"&&b.config.leftPage.adType=="url"){b.resizeUrlAdvert()}}},onMouseEnd:function(){mainPanel.fireEvent("trackMouseWheel",this)},setUpPageTurnForImageFill:function(){var a=this;if(a.mode=="double"){a.topRight.setHidden(false);a.topLeft.setHidden(false);a.topRight.element.dom.style.visible="visible";a.topLeft.element.dom.style.visible="visible";a.top=0;if(a.config.rightPage.type=="sectionpage"){a.topRight.setHidden(true);a.bottomRight.setHidden(true)}if(a.config.leftPage.type=="sectionpage"){a.topLeft.setHidden(true);a.bottomLeft.setHidden(true)}}$(a.topRight.element.dom).css("top",a.top+a.readerPaddingY);$(a.topRight.element.dom).css("right",0+a.readerPaddingX+(a.initialTranslateX));$(a.topLeft.element.dom).css("top",a.top+a.readerPaddingY);$(a.topLeft.element.dom).css("left",0+a.readerPaddingX+(a.initialTranslateX))},getPageNo:function(){return this.config.pageNo},adjustPageNo:function(c,d){var b=this;var e=flatPlanData.pageGroups.length-1-pageOffset;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var a=Math.min(e,Math.max(0,(b.config.pageNo+c)))}else{var a=Math.min(e,Math.max(0,(b.returnReverseMappedPageNumber(b.getPageNo())+c)))}console.log("adjusting",a,c);b.config.pageNo=a},startDrag:function(d){var c=this;if(d!=null){if(d.stopPropagation!=null){d.stopPropagation()}if(d.preventDefault!=null){d.preventDefault()}}$(c.rightSideNextPageContainer).css("display","");$(c.leftSidePrevPageContainer).css("display","");if(c.zoomMode=="fit"){c.addCls("desktoppageviewer")}c.hiddenRight.setStyle("visibility:visible;");c.leftPrevPage.style.visibility="hidden";c.pauseFlashingLinks();$(c.rightSideDiv).css("transform-origin","0% 0% 0px");$(c.rightSideImageContainer).css("transform-origin","0% 0% 0px");$(c.rightSideNextPageContainer).css("transform-origin","0% 0% 0px");$(c.rightSideGradient).css("transform-origin","0% 0% 0px");$(c.rightSideDiv).css("transform","");$(c.rightSideImageContainer).css("transform","");$(c.rightSideNextPageContainer).css("transform","");$(c.rightSideGradient).css("transform","");$(c.rightSideDiv).css("bottom","");$(c.rightSideImageContainer).css("top","0%");$(c.rightSideImageContainer).css("bottom","");$(c.rightSideImageContainer).css("left","0%");$(c.rightSideNextPageContainer).css("visibility","hidden");$(c.rightSideNextPageContainer).css("overflow","hidden");$(c.rightSideNextPageContainer).css("top","0%");$(c.rightSideNextPageContainer).css("bottom","");$(c.rightSideNextPageContainer).css("left","0% ");$(c.rightSideGradient).css("top","0%");$(c.rightSideGradient).css("bottom","");$(c.rightSideGradient).css("left","0% ");$(c.rightSideGradient).css("visibility","hidden");$(c.rightSideGradient).css("z-index","11");c.rightSide.element.dom.style.zIndex="10";c.leftSide.element.dom.style.zIndex="8";c.rightSide.setZIndex(10);c.leftSide.setZIndex(8);c.mediaDivContainer.element.dom.style.display="none";if(!c.overflowMediaDiv.isHidden()){c.overflowMediaDiv.setZIndex(1)}var a=270;var b=0.3;$(c.rightSideGradient).css("background","-webkit-linear-gradient("+a+"deg,  rgba(0,0,0,"+b+") "+(((b*100)*0.9))+"%, rgba(76,76,76,0) 100%)");$(c.rightSideGradient).css("height","70px");$(c.rightSideGradient).css("width",$(c.rightSideDiv).width());$(c.gifRight).css("visibility","hidden");$(c.rightSideDiv).css("overflow","hidden");c.diffX=($(c.topRight.element.dom).offset().left+$(c.topRight.element.dom)[0].getBoundingClientRect().width)-$(c.element.dom).width()-c.wrapAdOffset;c.diffY=$(c.topRight.element.dom).offset().top;if(!Ext.browser.is.IE){if(c.element.dom.parentElement!=null){c.element.dom.parentElement.parentElement.style.overflow="visible"}}if(settings.page.ignorePDF!=null){$(c.rightSideTileDiv).css("display","none");$(c.leftSideTileDiv).css("display","none")}c.addCls("disableIframe")},startDragLeft:function(d){var c=this;if(d!=null){if(d.stopPropagation!=null){d.stopPropagation()}if(d.preventDefault!=null){d.preventDefault()}}$(c.rightSideNextPageContainer).css("display","");$(c.leftSidePrevPageContainer).css("display","");if(c.zoomMode=="fit"){c.addCls("desktoppageviewer")}c.hiddenLeft.setStyle("visibility:visible;");c.rightNextPage.style.visibility="hidden";c.pauseFlashingLinks();$(c.leftSideDiv).css("transform-origin","100% 0% 0px");$(c.leftSideImageContainer).css("transform-origin","100% 0% 0px");$(c.leftSidePrevPageContainer).css("transform-origin","100% 0% 0px");$(c.leftSideGradient).css("transform-origin","100% 0% 0px");$(c.leftSideDiv).css("transform","");$(c.leftSideImageContainer).css("transform","");$(c.leftSidePrevPageContainer).css("transform","");$(c.leftSideGradient).css("transform","");$(c.leftSideDiv).css("bottom","");$(c.leftSideImageContainer).css("top","0%");$(c.leftSideImageContainer).css("bottom","");$(c.leftSideImageContainer).css("right","0%");$(c.leftSidePrevPageContainer).css("visibility","hidden");$(c.leftSidePrevPageContainer).css("overflow","hidden");$(c.leftSidePrevPageContainer).css("top","0%");$(c.leftSidePrevPageContainer).css("bottom","");$(c.leftSidePrevPageContainer).css("right","0% ");$(c.leftSideGradient).css("top","0%");$(c.leftSideGradient).css("bottom","");$(c.leftSideGradient).css("right","0% ");$(c.leftSideGradient).css("visibility","hidden");$(c.leftSideGradient).css("z-index","11");c.rightSide.element.dom.style.zIndex="9";c.leftSide.element.dom.style.zIndex="10";c.rightSide.setZIndex(9);c.leftSide.setZIndex(10);c.mediaDivContainer.element.dom.style.display="none";var a=270;var b=0.3;$(c.leftSideGradient).css("background","-webkit-linear-gradient("+a+"deg,  rgba(0,0,0,"+b+") "+(((b*100)*0.9))+"%, rgba(76,76,76,0) 100%)");$(c.leftSideGradient).css("height","70px");$(c.leftSideGradient).css("width",$(c.leftSideDiv).width());$(c.gifLeft).css("visibility","hidden");$(c.leftSideDiv).css("overflow","hidden");c.diffX=$(c.topLeft.element.dom).offset().left*-1+c.wrapAdOffset;c.diffY=$(c.topLeft.element.dom).offset().top;if(!Ext.browser.is.IE){if(c.element.dom.parentElement!=null){c.element.dom.parentElement.parentElement.style.overflow="visible"}}if(settings.page.ignorePDF!=null){$(c.rightSideTileDiv).css("display","none");$(c.leftSideTileDiv).css("display","none")}c.addCls("disableIframe")},startDragBottomRight:function(d){var c=this;if(d!=null){if(d.stopPropagation!=null){d.stopPropagation()}if(d.preventDefault!=null){d.preventDefault()}}if(c.zoomMode=="fit"){c.addCls("desktoppageviewer")}$(c.rightSideNextPageContainer).css("display","");$(c.leftSidePrevPageContainer).css("display","");c.hiddenRight.setStyle("visibility:visible;");c.pauseFlashingLinks();$(c.rightSideDiv).css("transform-origin","0% 100% 0px");$(c.rightSideImageContainer).css("transform-origin","0% 100% 0px");$(c.rightSideNextPageContainer).css("transform-origin","0% 100% 0px");$(c.rightSideGradient).css("transform-origin","0% 100% 0px");$(c.rightSideDiv).css("transform","");$(c.rightSideImageContainer).css("transform","");$(c.rightSideNextPageContainer).css("transform","");$(c.rightSideGradient).css("transform","");$(c.rightSideDiv).css("top","");$(c.rightSideDiv).css("bottom",0);$(c.rightSideImageContainer).css("top","");$(c.rightSideImageContainer).css("bottom","0%");$(c.rightSideImageContainer).css("left","0%");$(c.rightSideNextPageContainer).css("visibility","hidden");$(c.rightSideNextPageContainer).css("overflow","hidden");$(c.rightSideNextPageContainer).css("top","");$(c.rightSideNextPageContainer).css("bottom","0%");$(c.rightSideNextPageContainer).css("left","0% ");$(c.rightSideGradient).css("top","");$(c.rightSideGradient).css("bottom","0%");$(c.rightSideGradient).css("left","0% ");$(c.rightSideGradient).css("visibility","hidden");$(c.rightSideGradient).css("z-index","11");c.rightSide.element.dom.style.zIndex="10";c.leftSide.element.dom.style.zIndex="8";c.rightSide.setZIndex(10);c.leftSide.setZIndex(8);c.mediaDivContainer.element.dom.style.display="none";if(!c.overflowMediaDiv.isHidden()){c.overflowMediaDiv.setZIndex(1)}var a=90;var b=0.3;$(c.rightSideGradient).css("background","-webkit-linear-gradient("+a+"deg,  rgba(0,0,0,"+b+") "+(((b*100)*0.9))+"%, rgba(76,76,76,0) 100%)");$(c.rightSideGradient).css("height","70px");$(c.rightSideGradient).css("width",$(c.rightSideDiv).width());$(c.gifBottomRight).css("visibility","hidden");$(c.rightSideDiv).css("overflow","hidden");c.diffX=($(c.topRight.element.dom).offset().left+$(c.topRight.element.dom)[0].getBoundingClientRect().width)-$(c.element.dom).width()-c.wrapAdOffset;c.diffY=$(c.topRight.element.dom).offset().top;if(!Ext.browser.is.IE){if(c.element.dom.parentElement!=null){c.element.dom.parentElement.parentElement.style.overflow="visible"}}if(settings.page.ignorePDF!=null){$(c.rightSideTileDiv).css("display","none");$(c.leftSideTileDiv).css("display","none")}c.addCls("disableIframe")},startDragBottomLeft:function(d){var c=this;if(d!=null){if(d.stopPropagation!=null){d.stopPropagation()}if(d.preventDefault!=null){d.preventDefault()}}if(c.zoomMode=="fit"){c.addCls("desktoppageviewer")}$(c.rightSideNextPageContainer).css("display","");$(c.leftSidePrevPageContainer).css("display","");c.hiddenLeft.setStyle("visibility:visible;");c.pauseFlashingLinks();$(c.leftSideDiv).css("transform-origin","100% 100% 0px");$(c.leftSideImageContainer).css("transform-origin","100% 100% 0px");$(c.leftSidePrevPageContainer).css("transform-origin","100% 100% 0px");$(c.leftSideGradient).css("transform-origin","100% 100% 0px");$(c.leftSideDiv).css("transform","");$(c.leftSideImageContainer).css("transform","");$(c.leftSidePrevPageContainer).css("transform","");$(c.leftSideGradient).css("transform","");$(c.leftSideDiv).css("top","");$(c.leftSideDiv).css("bottom",0);$(c.leftSideImageContainer).css("top","");$(c.leftSideImageContainer).css("bottom","0%");$(c.leftSideImageContainer).css("right","0%");$(c.leftSidePrevPageContainer).css("visibility","hidden");$(c.leftSidePrevPageContainer).css("overflow","hidden");$(c.leftSidePrevPageContainer).css("top","");$(c.leftSidePrevPageContainer).css("bottom","0%");$(c.leftSidePrevPageContainer).css("right","0% ");$(c.leftSideGradient).css("top","");$(c.leftSideGradient).css("bottom","0%");$(c.leftSideGradient).css("right","0% ");$(c.leftSideGradient).css("visibility","hidden");$(c.leftSideGradient).css("z-index","11");c.rightSide.element.dom.style.zIndex="9";c.leftSide.element.dom.style.zIndex="10";c.rightSide.setZIndex(9);c.leftSide.setZIndex(10);c.mediaDivContainer.element.dom.style.display="none";var a=90;var b=0.3;$(c.leftSideGradient).css("background","-webkit-linear-gradient("+a+"deg,  rgba(0,0,0,"+b+") "+(((b*100)*0.9))+"%, rgba(76,76,76,0) 100%)");$(c.leftSideGradient).css("height","70px");$(c.leftSideGradient).css("width",$(c.leftSideDiv).width());$(c.gifBottomLeft).css("visibility","hidden");$(c.leftSideDiv).css("overflow","hidden");c.diffX=$(c.bottomLeft.element.dom).offset().left*-1+c.wrapAdOffset;c.diffY=$(c.topLeft.element.dom).offset().top;if(!Ext.browser.is.IE){if(c.element.dom.parentElement!=null){c.element.dom.parentElement.parentElement.style.overflow="visible"}}if(settings.page.ignorePDF!=null){$(c.rightSideTileDiv).css("display","none");$(c.leftSideTileDiv).css("display","none")}c.addCls("disableIframe")},drag:function(A){var G=this;if(A!=null){if(A.stopPropagation!=null){A.stopPropagation()}if(A.preventDefault!=null){A.preventDefault()}}G.mouseDown=true;if(G.rightSide!=null){G.rightSide.element.dom.style.zIndex=10}if(G.leftSide!=null){G.leftSide.element.dom.style.zIndex=8}var l=$(G.element.dom).width();var k=0;var h=(((A.pageX-G.diffX-G.wrapAdOffset)+l)/2);var g=(((A.pageY-G.diffY)+k)/2);var t=Math.atan2(g-k,h-l);var z=t*114.6;var E=Math.sin(t);var D=Math.sin(t-(Math.PI/2));var f=h-E*g/D+G.diffX;var c=k;var s=l+G.diffX;var q=g+D*(l-h)/E;var x=t*(180/Math.PI)+180;if(f>$(G.element.dom).width()/2&&A.pageY>G.diffY&&A.pageX<$(G.element.dom).width()+G.diffX+G.wrapAdOffset){var w=true}else{if(A.pageY>G.diffY){var F=A.pageX-($(G.element.dom).width()/2)-G.wrapAdOffset;var C=A.pageY-G.diffY;var u=F*F+C*C;var j=Math.atan2(C,F);var r=($(G.element.dom).width()/2)+Math.cos(j)*G.rightSideWidth;var p=G.diffY+Math.sin(j)*G.rightSideWidth;var l=$(G.element.dom).width();var k=0;var h=(((r-G.diffX)+l)/2);var g=(((p-G.diffY)+k)/2);var t=Math.atan2(g-k,h-l);var z=t*114.6;var E=Math.sin(t);var D=Math.sin(t-(Math.PI/2));var f=h-E*g/D+G.diffX;var c=k;var s=l+G.diffX;var q=g+D*(l-h)/E;var x=t*(180/Math.PI)+180;var w=true}else{if(A.pageX>-G.diffX+G.wrapAdOffset){h=(((A.pageX-G.diffX-G.wrapAdOffset)+l)/2);g=((0+k)/2);t=Math.atan2(g-k,h-l);z=t*114.6;E=Math.sin(t);D=Math.sin(t-(Math.PI/2));f=h-E*g/D+G.diffX;c=k;s=l+G.diffX;q=g+D*(l-h)/E;x=t*(180/Math.PI)+180;var w=true}}}if(w){adj=(l)-(f-G.diffX);opp=q;hyp=(adj*adj)+(opp*opp);hyp=Math.sqrt(hyp);trigAngle=Math.acos(adj/hyp);trigAngle=trigAngle*(180/Math.PI);var v=G.returnOffset(f-(($(G.element.dom).width())/2),trigAngle);$(G.rightSideDiv).css("transform","translate3d("+v.x+"px, "+(v.y*-1)+"px, 0px) rotate("+trigAngle+"deg)");$(G.rightSideImageContainer).css("transform","rotate("+(trigAngle*-1)+"deg) translate3d("+(v.x*-1)+"px, "+(v.y)+"px, 0px) ");nextPageRotateAngle=((z)-trigAngle);nextPageCosAngle=(90-(nextPageRotateAngle-180));newExtraLength=Math.tan(nextPageCosAngle/(180/Math.PI))*v.y;$(G.rightSideNextPageContainer).css("transform","rotate("+nextPageRotateAngle+"deg) translate3d("+((adj+newExtraLength)*-1)+"px, "+(v.y)+"px, 0px)");$(G.rightSideGradient).css("transform","translate3d("+((adj+newExtraLength))+"px, "+(v.y*-1)+"px, 0px) rotate("+(nextPageRotateAngle*-1)+"deg) ");var n=s-f;var d=c-q;var m=d/n;var o=m*f*-1;if(q>G.height){var y=(-(G.height/2)-o)/m}else{var y=(-(q/2)-o)/m}var B=(((y)-($(G.element.dom).width()/2))/($(G.element.dom).width()/2))}if(G.rightSideNextPageContainer.style.visibility!="visible"){G.rightSideNextPageContainer.style.visibility="visible"}if(G.rightNextPage.style.visibility!="visible"){G.rightNextPage.style.visibility="visible"}if(G.rightSideGradient.style.visibility!="visible"){G.rightSideGradient.style.visibility="visible"}},dragLeft:function(A){var G=this;if(A!=null){if(A.stopPropagation!=null){A.stopPropagation()}if(A.preventDefault!=null){A.preventDefault()}}G.mouseDown=true;G.rightSide.element.dom.style.zIndex=9;G.leftSide.element.dom.style.zIndex=10;var l=0;var k=0;var h=((A.pageX+G.diffX-G.wrapAdOffset)+l)/2;var g=((A.pageY-G.diffY)+k)/2;var t=Math.atan2(g-k,h-l);var z=t*114.6;var E=Math.sin(t);var C=Math.sin(t-(Math.PI/2));var f=h+E*(k-g)/C-G.diffX;var c=k;var s=l-G.diffX;if(E!=0){var q=g+C*(l-h)/E}else{var q=0}if(f<$(G.element.dom).width()/2&&A.pageY>=G.diffY&&A.pageX>-G.diffX+G.wrapAdOffset){var w=true}else{if(A.pageY>=G.diffY){var F=A.pageX-($(G.element.dom).width()/2)-G.wrapAdOffset;var D=A.pageY-G.diffY;var u=F*F+D*D;var j=Math.atan2(D,F);var r=($(G.element.dom).width()/2)+Math.cos(j)*G.width;var p=G.diffY+Math.sin(j)*G.width;h=((r+G.diffX)+l)/2;g=((p-G.diffY)+k)/2;t=Math.atan2(g-k,h-l);z=t*114.6;E=Math.sin(t);C=Math.sin(t-(Math.PI/2));f=h+E*(k-g)/C-G.diffX;c=k;s=l-G.diffX;q=g+C*(l-h)/E;var w=true}else{if(A.pageX<$(G.element.dom).width()+G.diffX+G.wrapAdOffset){h=((A.pageX+G.diffX-G.wrapAdOffset)+l)/2;g=(0.1+k)/2;t=Math.atan2(g-k,h-l);z=t*114.6;E=Math.sin(t);C=Math.sin(t-(Math.PI/2));f=h+E*(k-g)/C-G.diffX;c=k;s=l-G.diffX;q=g+C*(l-h)/E;var w=true}}}if(w){adj=f+G.diffX;opp=q;hyp=(adj*adj)+(opp*opp);hyp=Math.sqrt(hyp);trigAngle=Math.acos(adj/hyp);trigAngle=trigAngle*(180/Math.PI);if(trigAngle==0){trigAngle=90}edge1XOffset=f-($(G.element.dom).width()/2);var v=G.returnOffset((edge1XOffset),trigAngle*-1);$(G.leftSideDiv).css("transform","translate3d("+(v.x)+"px, "+(v.y*-1)+"px, 0px) rotate("+(trigAngle*-1)+"deg)");$(G.leftSideImageContainer).css("transform","rotate("+(trigAngle)+"deg) translate3d("+(v.x*-1)+"px, "+(v.y)+"px, 0px) ");nextPageRotateAngle=((z)-(trigAngle*-1));nextPageCosAngle=(90-(nextPageRotateAngle-180));newExtraLength=Math.tan(nextPageCosAngle/(180/Math.PI))*(v.y*-1);$(G.leftSidePrevPageContainer).css("transform","rotate("+(nextPageRotateAngle)+"deg) translate3d("+((adj+newExtraLength))+"px, "+(v.y)+"px, 0px)");$(G.leftSideGradient).css("transform","translate3d("+((adj+newExtraLength)*-1)+"px, "+(v.y*-1)+"px, 0px) rotate("+(nextPageRotateAngle*-1)+"deg) ");var x=t*(180/Math.PI);var n=s-f;var d=c-q;var m=d/n;var o=m*f;if(q>G.height){var y=((G.height/2)-o)/m*-1}else{var y=((q/2)-o)/m*-1}var B=1-(((y))/($(G.element.dom).width()/2))}if(G.leftSidePrevPageContainer.style.visibility!="visible"){G.leftSidePrevPageContainer.style.visibility="visible"}if(G.leftPrevPage.style.visibility!="visible"){G.leftPrevPage.style.visibility="visible"}if(G.leftSideGradient.style.visibility!="visible"){G.leftSideGradient.style.visibility="visible"}},dragBottomRight:function(B){var H=this;H.mouseDown=true;if(B!=null){if(B.stopPropagation!=null){B.stopPropagation()}if(B.preventDefault!=null){B.preventDefault()}}H.rightSide.element.dom.style.zIndex=10;H.leftSide.element.dom.style.zIndex=8;var l=$(H.element.dom).width();var k=H.rightSideHeight;var h=((B.pageX-H.diffX-H.wrapAdOffset)+l)/2;var g=((B.pageY-H.diffY)+k)/2;var t=Math.atan2(g-k,h-l);var A=t*114.6;var F=Math.sin(t+(Math.PI/2));var D=Math.sin(t);var f=h-D*(k-g)/F+H.diffX;var c=k;var s=l+H.diffX;var q=g-F*(l-h)/D;if(f>$(H.element.dom).width()/2&&B.pageY<=H.rightSideHeight+H.diffY&&B.pageX<$(H.element.dom).width()+H.diffX+H.wrapAdOffset){var w=true}else{if(B.pageY<=H.rightSideHeight+H.diffY){var G=B.pageX-($(H.element.dom).width()/2)-H.wrapAdOffset;var E=B.pageY-(H.rightSideHeight+H.diffY);var u=G*G+E*E;var j=Math.atan2(E,G);var r=($(H.element.dom).width()/2)+Math.cos(j)*H.rightSideWidth;var p=(H.rightSideHeight+H.diffY)+Math.sin(j)*H.rightSideWidth;h=((r-H.diffX)+l)/2;g=((p-H.diffY)+k)/2;t=Math.atan2(g-k,h-l);A=t*114.6;F=Math.sin(t+(Math.PI/2));D=Math.sin(t);f=h-D*(k-g)/F+H.diffX;c=k;s=l+H.diffX;q=g-F*(l-h)/D;var w=true}else{if(B.pageX>-H.diffX+H.wrapAdOffset){h=((B.pageX-H.diffX-H.wrapAdOffset)+l)/2;g=((H.rightSideHeight-0.1)+k)/2;t=Math.atan2(g-k,h-l);A=t*114.6;F=Math.sin(t+(Math.PI/2));D=Math.sin(t);f=h-D*(k-g)/F+H.diffX;c=k;s=l+H.diffX;q=g-F*(l-h)/D;var w=true}}}if(w){adj=(l)-(f-H.diffX);opp=H.rightSideHeight-q;hyp=(adj*adj)+(opp*opp);hyp=Math.sqrt(hyp);trigAngle=Math.acos(adj/hyp);trigAngle=trigAngle*(180/Math.PI);edge1XOffset=f-($(H.element.dom).width()/2);var v=H.returnOffset((edge1XOffset),trigAngle*-1);$(H.rightSideDiv).css("transform","translate3d("+(v.x)+"px, "+((v.y*-1))+"px, 0px) rotate("+(trigAngle*-1)+"deg)");$(H.rightSideImageContainer).css("transform","rotate("+(trigAngle)+"deg) translate3d("+(v.x*-1)+"px, "+(v.y)+"px, 0px) ");nextPageRotateAngle=((A)-(trigAngle*-1));nextPageCosAngle=(90-(nextPageRotateAngle-180));newExtraLength=Math.tan(nextPageCosAngle/(180/Math.PI))*(v.y);$(H.rightSideNextPageContainer).css("transform","rotate("+nextPageRotateAngle+"deg) translate3d("+((adj+newExtraLength)*-1)+"px, "+(v.y)+"px, 0px)");$(H.rightSideGradient).css("transform","translate3d("+((adj+newExtraLength))+"px, "+(v.y*-1)+"px, 0px) rotate("+(nextPageRotateAngle*-1)+"deg) ");var x=t*(180/Math.PI)+180;var n=s-f;var d=c-q;var m=d/n;var o=(-H.rightSideHeight-(m*f))*-1;if(q<0){var y=((H.rightSideHeight/2)-o)/m*-1}else{var z=((H.rightSideHeight-q)/2)+q;var y=(z-o)/m*-1}var C=(((y)-($(H.element.dom).width()/2))/($(H.element.dom).width()/2))}if(H.rightSideNextPageContainer.style.visibility!="visible"){H.rightSideNextPageContainer.style.visibility="visible"}if(H.rightNextPage.style.visibility!="visible"){H.rightNextPage.style.visibility="visible"}if(H.rightSideGradient.style.visibility!="visible"){H.rightSideGradient.style.visibility="visible"}},dragBottomLeft:function(B){var H=this;H.mouseDown=true;if(B!=null){if(B.stopPropagation!=null){B.stopPropagation()}if(B.preventDefault!=null){B.preventDefault()}}H.rightSide.element.dom.style.zIndex=9;H.leftSide.element.dom.style.zIndex=10;var l=0;var k=H.height;var h=((B.pageX+H.diffX-H.wrapAdOffset)+l)/2;var g=((B.pageY-H.diffY)+k)/2;var t=Math.atan2(g-k,h-l);var A=t*114.6;var F=Math.sin(t);var D=Math.sin(t-(Math.PI/2));var f=h+F*(k-g)/D-H.diffX;var c=k;var s=l-H.diffX;var q=g+D*(l-h)/F;if(f<$(H.element.dom).width()/2&&B.pageY<=H.height+H.diffY&&B.pageX>-H.diffX+H.wrapAdOffset){var w=true}else{if(B.pageY<=H.height+H.diffY){var G=B.pageX-($(H.element.dom).width()/2)-H.wrapAdOffset;var E=B.pageY-(H.height+H.diffY);var u=G*G+E*E;var j=Math.atan2(E,G);var r=($(H.element.dom).width()/2)+Math.cos(j)*H.width;var p=(H.height+H.diffY)+Math.sin(j)*H.width;h=((r+H.diffX)+l)/2;g=((p-H.diffY)+k)/2;t=Math.atan2(g-k,h-l);A=t*114.6;F=Math.sin(t);D=Math.sin(t-(Math.PI/2));f=h+F*(k-g)/D-H.diffX;c=k;s=l-H.diffX;q=g+D*(l-h)/F;var w=true}else{if(B.pageX<$(H.element.dom).width()+H.diffX+H.wrapAdOffset){h=((B.pageX+H.diffX-H.wrapAdOffset)+l)/2;g=((H.height-0.1)+k)/2;t=Math.atan2(g-k,h-l);A=t*114.6;F=Math.sin(t);D=Math.sin(t-(Math.PI/2));f=h+F*(k-g)/D-H.diffX;c=k;s=l-H.diffX;q=g+D*(l-h)/F;var w=true}}}if(w){adj=f+H.diffX;opp=H.height-q;hyp=(adj*adj)+(opp*opp);hyp=Math.sqrt(hyp);trigAngle=Math.acos(adj/hyp);trigAngle=trigAngle*(180/Math.PI);edge1XOffset=f-($(H.element.dom).width()/2);var v=H.returnOffset((edge1XOffset),trigAngle);$(H.leftSideDiv).css("transform","translate3d("+(v.x)+"px, "+((v.y*-1))+"px, 0px) rotate("+(trigAngle)+"deg)");$(H.leftSideImageContainer).css("transform","rotate("+(trigAngle*-1)+"deg) translate3d("+(v.x*-1)+"px, "+(v.y)+"px, 0px) ");nextPageRotateAngle=((A)-(trigAngle));nextPageCosAngle=(90-(nextPageRotateAngle-180));newExtraLength=Math.tan(nextPageCosAngle/(180/Math.PI))*(v.y*-1);$(H.leftSidePrevPageContainer).css("transform","rotate("+(nextPageRotateAngle)+"deg) translate3d("+((adj+newExtraLength))+"px, "+(v.y)+"px, 0px)");$(H.leftSideGradient).css("transform","translate3d("+((adj+newExtraLength)*-1)+"px, "+(v.y*-1)+"px, 0px) rotate("+(nextPageRotateAngle*-1)+"deg) ");var x=t*(180/Math.PI);var n=s-f;var d=c-q;var m=d/n;var o=(-H.height-(m*f))*-1;if(q<0){var y=((H.height/2)-o)/m*-1}else{var z=((H.height-q)/2)+q;var y=(z-o)/m*-1}var C=1-(((y))/($(H.element.dom).width()/2))}if(H.leftSidePrevPageContainer.style.visibility!="visible"){H.leftSidePrevPageContainer.style.visibility="visible"}if(H.leftPrevPage.style.visibility!="visible"){H.leftPrevPage.style.visibility="visible"}if(H.leftSideGradient.style.visibility!="visible"){H.leftSideGradient.style.visibility="visible"}},endDrag:function(b){var a=this;if(b!=null){if(b.stopPropagation!=null){b.stopPropagation()}}a.removeCls("desktoppageviewer");a.topRight.element.dom.style.transform="";a.playCssAnimations();if(b.pageX>=($(a.element.dom).width()/2)+a.wrapAdOffset){a.fireEvent("returnPageRight",b,a)}else{a.fireEvent("finishTurnRight",b,a);a.fireEvent("trackManualPageTurn")}if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}a.removeCls("disableIframe")},endDragLeft:function(b){var a=this;if(b!=null){if(b.stopPropagation!=null){b.stopPropagation()}}a.removeCls("desktoppageviewer");a.topLeft.element.dom.style.transform="";a.playCssAnimations();if(b.pageX<=($(a.element.dom).width()/2)+a.wrapAdOffset){a.fireEvent("returnPageLeft",b,a)}else{a.fireEvent("finishTurnLeft",b,a);a.fireEvent("trackManualPageTurn")}if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}a.removeCls("disableIframe")},endDragBottomRight:function(b){var a=this;if(b!=null){if(b.stopPropagation!=null){b.stopPropagation()}}a.removeCls("desktoppageviewer");a.bottomRight.element.dom.style.transform="";a.playCssAnimations();if(b.pageX>=($(a.element.dom).width()/2)+a.wrapAdOffset){a.fireEvent("returnPageBottomRight",b,a)}else{a.fireEvent("finishTurnBottomRight",b,a);a.fireEvent("trackManualPageTurn")}if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}a.removeCls("disableIframe")},endDragBottomLeft:function(b){var a=this;if(b!=null){if(b.stopPropagation!=null){b.stopPropagation()}}a.removeCls("desktoppageviewer");a.bottomLeft.element.dom.style.transform="";a.playCssAnimations();if(b.pageX<=($(a.element.dom).width()/2)+a.wrapAdOffset){a.fireEvent("returnPageBottomLeft",b,a)}else{a.fireEvent("finishTurnBottomLeft",b,a);a.fireEvent("trackManualPageTurn")}if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}a.removeCls("disableIframe")},returnOffse},toRadian},pageResize:function(e){var f=this;if(!videoFull){if(f.isPageRendered){f.hasTiled=false;var c=$(f.rightSideImg).width();var d=$(f.rightSideImg).height();var j=c/d;if($(f.element.dom).height()*j<$(f.element.dom).width()/2){f.height=$(f.element.dom).height();f.width=f.height*j;$(f.rightSideDiv).css("bottom","");$(f.rightSideTileCanvas).css("height",f.height);$(f.rightSideTileCanvas).css("width",f.width);$(f.rightSideTileCanvas).attr("height",f.height);$(f.rightSideTileCanvas).attr("width",f.width);$(f.rightSideImg).css("height",f.height);$(f.rightSideImg).css("width",f.width);$(f.rightSideImageContainer).css("height",f.height);$(f.rightSideImageContainer).css("width",f.width);$(f.rightNextPage).css("height",f.height);$(f.rightNextPage).css("width",f.width);$(f.hiddenRightImg).css("height",f.height);$(f.hiddenRightImg).css("width",f.width);$(f.hiddenRightGradient).css("height",f.height);$(f.hiddenRightGradient).css("width",f.width);var b=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));b=Math.sqrt(b);$(f.rightSideDiv).css("height",b+"px");$(f.rightSideDiv).css("width",b+"px");f.top=0;f.initialTranslateY=f.top;$(f.rightSideDiv).css("top","");$(f.hiddenRightImg).css("top",f.top);$(f.topRight.element.dom).css("top",f.top+f.readerPaddingY);$(f.topRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("bottom",f.top);f.initialImageWidth=f.width;f.initialImageHeight=f.height}else{j=d/c;f.width=$(f.element.dom).width()/2;f.height=f.width*j;$(f.rightSideDiv).css("bottom","");$(f.rightSideTileCanvas).css("height",f.height);$(f.rightSideTileCanvas).css("width",f.width);$(f.rightSideTileCanvas).attr("height",f.height);$(f.rightSideTileCanvas).attr("width",f.width);$(f.rightSideImg).css("height",f.height);$(f.rightSideImg).css("width",f.width);$(f.rightSideImageContainer).css("height",f.height);$(f.rightSideImageContainer).css("width",f.width);$(f.rightNextPage).css("height",f.height);$(f.rightNextPage).css("width",f.width);$(f.hiddenRightImg).css("height",f.height);$(f.hiddenRightImg).css("width",f.width);$(f.hiddenRightGradient).css("height",f.height);$(f.hiddenRightGradient).css("width",f.width);var b=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));b=Math.sqrt(b);$(f.rightSideDiv).css("height",b+"px");$(f.rightSideDiv).css("width",b+"px");f.top=($(f.element.dom).height()-f.height)/2;if(f.zoomMode=="fill"){f.top=0}f.initialTranslateY=f.top;$(f.topRight.element.dom).css("top",f.top+f.readerPaddingY);$(f.topRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("bottom",f.top);$(f.hiddenRightImg).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));f.initialImageWidth=f.width;f.initialImageHeight=f.height}var g=$(f.leftSideImg).attr("src");if(g==null){g=""}else{g=g.length}c=$(f.leftSideImg).width();d=$(f.leftSideImg).height();j=c/d;if($(f.element.dom).height()*j<$(f.element.dom).width()/2&&g>0){f.height=$(f.element.dom).height();f.width=f.height*j;$(f.leftSideDiv).css("bottom","");$(f.leftSideImg).css("height",f.height);$(f.leftSideImg).css("width",f.width);$(f.leftSideTileCanvas).css("height",f.height);$(f.leftSideTileCanvas).css("width",f.width);$(f.leftPrevPage).css("height",f.height+"px");$(f.leftPrevPage).css("width",(f.width)+"px");$(f.leftSideImg).css("transform-origin","100% 0% 0px");$(f.hiddenLeftImg).css("height",f.height);$(f.hiddenLeftImg).css("width",f.width);$(f.hiddenLeftGradient).css("height",f.height);$(f.hiddenLeftGradient).css("width",f.width);var b=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));b=Math.sqrt(b);$(f.leftSideDiv).css("height",b+"px");$(f.leftSideDiv).css("width",b+"px");f.top=0;f.initialTranslateY=f.top;$(f.leftSideDiv).css("top",f.top);$(f.hiddenLeftImg).css("top",f.top);$(f.topLeft.element.dom).css("top",f.top+f.readerPaddingY);$(f.topLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.hiddenLeftImg).css("right",0);$(f.bottomLeft.element.dom).css("bottom",f.top);f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height}else{if(g>0){j=d/c;f.width=$(f.element.dom).width()/2;f.height=f.width*j;$(f.leftSideDiv).css("bottom","");$(f.leftSideImg).css("height",f.height);$(f.leftSideImg).css("width",f.width);$(f.leftSideTileCanvas).css("height",f.height);$(f.leftSideTileCanvas).css("width",f.width);$(f.leftPrevPage).css("height",f.height);$(f.leftPrevPage).css("width",f.width);$(f.hiddenLeftImg).css("height",f.height);$(f.hiddenLeftImg).css("width",f.width);$(f.hiddenLeftGradient).css("height",f.height);$(f.hiddenLeftGradient).css("width",f.width);var b=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));b=Math.sqrt(b);$(f.leftSideDiv).css("height",b+"px");$(f.leftSideDiv).css("width",b+"px");f.top=($(f.element.dom).height()-f.height)/2;$(f.topLeft.element.dom).css("top",f.top+f.readerPaddingY);$(f.topLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("bottom",f.top);f.top=0;$(f.leftSideDiv).css("top",f.top);$(f.hiddenLeftImg).css("top",f.top);$(f.hiddenLeftImg).css("right",0);f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height}}pixelMove=$(f.element.dom).width()*0.01;$(f.rightSideDiv).css("transform","");$(f.rightSideImageContainer).css("transform","");$(f.rightNextPage).css("transform","");$(f.rightNextPage).css("visibility","hidden");$(f.leftSideDiv).css("transform","");$(f.leftSideImageContainer).css("transform","");$(f.leftSideImageContainer).css("bottom","");$(f.rightSideImageContainer).css("bottom","");$(f.rightNextPage).css("bottom","");$(f.leftPrevPage).css("bottom","");$(f.leftPrevPage).css("transform","");$(f.leftPrevPage).css("visibility","hidden");if(f.rightSideImageContainer!=null){f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height}else{f.rightSideImageContainer=f.rightSide.element.down(".rightSideImgContainer").dom;f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height}if(f.leftSideImageContainer!=null){f.leftSideImageContainer.initialImageWidth=f.width;f.leftSideImageContainer.initialImageHeight=f.height}else{f.leftSideImageContainer=f.leftSide.element.down(".leftSideImgContainer").dom;f.leftSideImageContainer.initialImageWidth=f.width;f.leftSideImageContainer.initialImageHeight=f.height}f.initialTranslateX=(($(f.element.dom).width()/2)-f.width);f.setPageWidth();if(f.scale>1){f.resetPage();f.finishZoom(false);if(f.zoomMode=="fit"&&f.mode=="double"){f.showNavButtons()}else{f.hideNavButtons()}}f.fireEvent("activeItemCheck",f)}if(settings.leftSideAd!=null&&f.config.leftPage.type=="leftHandAd"&&(f.config.leftPage.adType=="dfp"||f.config.leftPage.adType=="adbridg")){f.config.leftPage.adType=="dfp"?f.resizeDfp():f.resizeAdbridg()}else{if(settings.leftSideAd!=null&&f.config.leftPage.type=="leftHandAd"&&f.config.leftPage.adType=="url"){f.resizeUrlAdvert()}}f.fireEvent("resizeClipping");f.fireEvent("resizeArticlesBrowser")}},disableTiling:function(){var a=this;a.leftSideTileCanvas.width=0;a.leftSideTileCanvas.height=0;a.rightSideTileCanvas.width=0;a.rightSideTileCanvas.height=0;a.hasTiled=false},destroy:function(){var a=this;a.isinitialized=false;a.element.dom.innerHTML="";a.viewDestroyed=true;a.disableTiling();if(a.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([a.adSlot1])}delete a.leftSideTileCanvas;delete a.rightSideTileCanvas;delete a.scroller;delete a.scrollerDivContainer;delete a.scrollerDiv;delete a.zoomDivContainer;delete a.zoomDiv;delete a.tileDiv;delete a.rightNextPage;delete a.rightSideDiv;delete a.rightSideGradient;delete a.rightSideImageContainer;delete a.rightSideImg;delete a.rightSideMediaDiv;delete a.rightSideTileDiv;delete a.leftPrevPage;delete a.leftSideDiv;delete a.leftSideGradient;delete a.leftSideImageContainer;delete a.leftSideImg;delete a.leftSideMediaDiv;delete a.leftSideTileDiv;delete a.hiddenLeftGradient;delete a.hiddenLeftImg;delete a.hiddenRightGradient;delete a.hiddenRightImg;delete a.rightSide;delete a.leftSide;delete a.hiddenRight;delete a.hiddenLeft;delete a.topRight;delete a.topLeft;delete a.bottomRight;delete a.bottomLeft;delete a.previousPage;Ext.Panel.prototype.destroy.apply(this,arguments);delete a},hoverRight:function(){var a=this;a.rightSide.element.dom.style.zIndex="10";a.leftSide.element.dom.style.zIndex="8"},hoverLef},scrollEnd:function(){var a=this;if(a.scroller.position.y<=0){a.fireEvent("hideTop")}else{a.fireEvent("showTop")}if(a.scroller.position.y>=a.scroller.maxPosition.y){a.fireEvent("hideBottom")}else{a.fireEvent("showBottom")}mainPanel.fireEvent("trackPan",a)},onPinchStar},onPinc},onPinchEnd:function(b){var a=this;$("#slider").val(a.currentScale);if(a.currentScale<=1){a.resetPage();a.finishZoom(true);a.showNavButtons()}else{a.scale=a.currentScale;a.finishZoom(true);a.hideNavButtons()}a.trackZoomLevel()},pauseFlashingLink},playCssAnimation},pauseVideos:function(){var k=this;if(k.rightSideMediaDiv!=null){var a=[];for(var f=0;f<k.rightSideMediaDiv.children.length;f++){if(k.rightSideMediaDiv.children[f].className.indexOf("readerVideo")!=-1){var c=k.rightSideMediaDiv.children[f];$(k.element.dom).removeClass("disableIframe");if(c.className.indexOf("mp4Video")!=-1){var e=c.getElementsByTagName("iframe")[0];if(e!=null&&e.contentDocument.getElementsByTagName("video")[0]!=null){e.contentDocument.getElementsByTagName("video")[0].pause()}}else{if(c.className.indexOf("youtubeVideo")!=-1){var e=c.getElementsByTagName("iframe")[0];var b=YT.get(e.id);if(b!=null&&typeof b.pauseVideo==="function"){b.pauseVideo()}}else{if(c.className.indexOf("vimeoVideo")!=-1){var e=c.getElementsByClassName("vimeoPlayer")[0];e.contentWindow.postMessage({method:"pause",value:""},"*")}else{if(c.className.indexOf("brightcoveVideo")!=-1){try{bc(c.id+"_bc").pause()}catch(j){console.warn(j)}}}}}}}}if(k.leftSideMediaDiv!=null){var l=[];for(var f=0;f<k.leftSideMediaDiv.children.length;f++){if(k.leftSideMediaDiv.children[f].className.indexOf("readerVideo")!=-1){var c=k.leftSideMediaDiv.children[f];$(k.element.dom).removeClass("disableIframe");if(c.className.indexOf("mp4Video")!=-1){var e=c.getElementsByTagName("iframe")[0];e.contentDocument.getElementsByTagName("video")[0].pause()}else{if(c.className.indexOf("youtubeVideo")!=-1){var e=c.getElementsByTagName("iframe")[0];var b=YT.get(e.id);if(b!=null&&typeof b.pauseVideo==="function"){b.pauseVideo()}}else{if(c.className.indexOf("vimeoVideo")!=-1){var e=c.getElementsByClassName("vimeoPlayer")[0];e.contentWindow.postMessage({method:"pause",value:""},"*")}else{if(c.className.indexOf("brightcoveVideo")!=-1){try{bc(c.id+"_bc").pause()}catch(j){console.warn(j)}}}}}}}}if(!k.overflowMediaDiv.isHidden()){if(k.overflowMediaDiv.element!=null){var n=[];var g=k.overflowMediaDiv.element.dom.getElementsByClassName("mp4Video");for(var f=0;f<g.length;f++){var e=g[f].getElementsByTagName("iframe")[0];e.contentDocument.getElementsByTagName("video")[0].pause()}var m=k.overflowMediaDiv.element.dom.getElementsByClassName("youtubeVideo");for(var f=0;f<m.length;f++){var e=m[f].getElementsByTagName("iframe")[0];var b=YT.get(e.id);if(b!=null&&typeof b.pauseVideo==="function"){b.pauseVideo()}}var d=k.overflowMediaDiv.element.dom.getElementsByClassName("vimeoVideo");for(var f=0;f<d.length;f++){var e=d[f].getElementsByClassName("vimeoPlayer")[0];e.contentWindow.postMessage({method:"pause",value:""},"*")}var h=k.overflowMediaDiv.element.dom.getElementsByClassName("brightcoveVideo");for(var f=0;f<h.length;f++){var c=h[f];try{bc(c.id+"_bc").pause()}catch(j){console.warn(j)}}}}},setMediaContainer:function(){var a=this;if(a.mode=="single"){a.rightSideMediaDiv.style.width="100%";a.leftSideMediaDiv.style.width="100%";if(a.rightSideImageContainer.pageNo==a.returnActiveImageContainer().pageNo){a.rightSideMediaDiv.style.display="inline-block";a.leftSideMediaDiv.style.display="none"}else{a.rightSideMediaDiv.style.display="none";a.leftSideMediaDiv.style.display="inline-block"}}else{a.rightSideMediaDiv.style.display="inline-block";a.rightSideMediaDiv.style.width="50%";a.leftSideMediaDiv.style.display="inline-block";a.leftSideMediaDiv.style.width="50%"}},getEncryptedImageSrc:function(b,d,a){var c=this;var e=new XMLHttpRequest();e.open("GET",b,true);e.responseType="arraybuffer";e.onload=function(g){var j=e.response;var f=new Uint8Array(j);if(settings.page.encryptionVersion=="3"){a=c.decryptV3(a)}else{if(settings.page.encryptionVersion=="4"){a=c.decryptV4(a)}}var h=c.decryptAES(f,a);$(d).attr("src",h)};e.send()},decryptV4:function(c){var d=this;c=c.replace(/-/g,"");var b=new RegExp(d.aesRegex(settings.page.checksum).replace(/\//,""));var e=new RegExp(/([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/);var a=c.replace(e,b).replace(/\//g,"");a=a.splice(7,0,"-").splice(12,0,"-").splice(17,0,"-").splice(22,0,"-");return a},aesRegex:function(b){if(typeof CryptoJS!="undefined"){var c=CryptoJS.enc.Hex.parse("02e656e46f3f441cbfa21c72b5a0bfcf");var e=CryptoJS.enc.Base64.parse(b);var a=CryptoJS.AES.decrypt({ciphertext:e},c,{keySize:16,iv:CryptoJS.enc.Hex.parse("00000000-0000-0000-0000-000000000000".replace(/-/g,"")),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});var d=CryptoJS.enc.Utf8.stringify(a);return d}},decryptV3:function(b){gString=b.replace(/-/gi,"");seed=parseInt(gString.substring(0,2),16);gChars=Array.from(gString);for(i=0;i<32;i++){seed=((3*seed+7)%32);var a=gChars[i];gChars[i]=gChars[seed];gChars[seed]=a}gString=gChars.join("");return gString},decryptAES:function(e,a){var d=this;if(typeof CryptoJS!="undefined"){var c=CryptoJS.enc.Hex.parse(a.replace(/-/g,""));var g=d.byteArrayToWordArray(e);var b=CryptoJS.AES.decrypt({ciphertext:g},c,{keySize:16,iv:CryptoJS.enc.Hex.parse("00000000-0000-0000-0000-000000000000".replace(/-/g,"")),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});var f=CryptoJS.enc.Base64.stringify(b);return"data:image/jpeg;base64,"+f}},byteArrayToWordArray:function(c){var b=[],a;for(a=0;a<c.length;a++){b[(a/4)|0]|=c[a]<<(24-8*a)}return CryptoJS.lib.WordArray.create(b,c.length)},setImageSrc:function(d,c,e){var b=this;var a=b.getImageUrl(c,e);if((settings.page.encryptionVersion=="2"||settings.page.encryptionVersion=="3"||settings.page.encryptionVersion=="4")&&e.guid!=null){b.getEncryptedImageSrc(a,d,e.guid)}else{$(d).attr("src",a)}},destroyPage0:function(){var a=this;if(!!a.advertDiv&&a.config.leftPage.adType=="adbridg"){a.advertDiv.parentElement.removeChild(a.advertDiv);a.advertDiv=null}},reloadPage0:function(){var a=this;if(a.advertDiv==null&&a.config.leftPage.adType=="adbridg"&&a.mode=="double"){a.setupAdbridgLeftSideAdvert()}}},0,["readerpageviewer"],["component","container","panel","readerpageviewer"],{component:true,container:true,panel:true,readerpageviewer:true},["widget.readerpageviewer"],0,[InfinityMobile.view.desktop,"DesktopPageViewer"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutView",Ext.Container,{config:{ignorePosition:false,cls:"toolbar"},initialize:function(){var a=this;a.currentState="default";if(a.config.json.defaultState!=null&&a.config.json.defaultState!="default"){a.currentState=a.config.json.defaultState}a.json=a.config.json;a.parentContainer=a.config.parentContainer;a.layoutViewStyle();a.checkDPS();var b=Ext.create("Ext.Container",{itemId:"tooltip",style:"position:absolute !important;"});a.add(b);if(a.json.events.onTouch!=null&&currentProfile=="desktop"){a.element.dom.style.cursor="pointer";switch(a.json.events.onTouch[0].action){case"openReaderMenu":b.setHtml('<div style="position:absolute;" class="tooltip">Menu</div>');a.tooltipLeft(15);break;case"search":b.setHtml('<div style="position:absolute;" class="tooltip">Search</div>');a.tooltipRight();break;case"right":b.setHtml('<div style="position:absolute;" class="tooltip">Next Page</div>');a.tooltipRight();break;case"left":b.setHtml('<div style="position:absolute;" class="tooltip">Previous Page</div>');a.tooltipRight();break;case"dps mode off":b.setHtml('<div style="position:absolute;" class="tooltip">Single Page</div>');a.tooltipRight("dps");break;case"dps mode on":b.setHtml('<div style="position:absolute;" class="tooltip">Double Page</div>');a.tooltipRight("dps");break;case"FirstPage":b.setHtml('<div style="position:absolute;" class="tooltip">First Page</div>');a.tooltipRight();break;case"LastPage":b.setHtml('<div style="position:absolute;" class="tooltip">Last Page</div>');a.tooltipRight();break}}if(currentProfile=="desktop"&&a.json.globalID=="ZoomBar"){a.innerElement.dom.style.cursor="pointer"}if(a.currentState!="default"){a.updateState(a.currentState)}a.handleBookmark();if(a.json.globalID==="PagesBrowserIconEdition"){a.initializePagesBrowserView()}},tooltipRigh},tooltipLef},layoutViewStyl},layoutViewStyleOrientatio},layoutViewPosition:function(r,d){var v=this;var k=r.anchors[d];var w=r.position[d];var l="";var t=w.x;var s=w.y;var e=w.width;var c=w.height;var n=w.autoWidth;var f=768;var b=1024;var j=v.json;if(v.parentContainer!=null){j=v.parentContainer.json}f=j.position[d].width;b=j.position[d].height;var o=window.innerWidth;var h=window.innerHeight;l+="position: absolute;";if(k.anchorLeft||k.anchorRight||k.anchorWidth){if(!k.anchorLeft&&!k.anchorRight&&!k.anchorWidth){var a=t/f*100;l+="left: "+a+"%;";l+="width: "+e+"px;"}else{if(!k.anchorLeft&&!k.anchorRight&&k.anchorWidth){var a=t/f*100;var p=e/f*100;l+="left: "+a+"%;";l+="width: "+p+"%;"}else{if(!k.anchorLeft&&k.anchorRight&&!k.anchorWidth){var u=t+e;l+="right: "+(f-u)+"px;";l+="width: "+(n?"auto;":e+"px;")}else{if(!k.anchorLeft&&k.anchorRight&&k.anchorWidth){var u=t+e;var p=e/f*100;l+="right: "+(f-u)+"px;";l+="width: "+p+"%;"}else{if(k.anchorLeft&&!k.anchorRight&&!k.anchorWidth){l+="left: "+t+"px;";l+="width: "+e+"px;"}else{if(k.anchorLeft&&!k.anchorRight&&k.anchorWidth){var p=e/f*100;l+="left: "+t+"px;";l+="width: "+p+"%;"}else{if(k.anchorLeft&&k.anchorRight){l+="left:"+t+"px;";var u=t+e;l+="width:calc(100% - "+t+"px - "+(f-u)+"px);"}}}}}}}}if(k.anchorTop||k.anchorBottom||k.anchorHeight){if(!k.anchorTop&&!k.anchorBottom&&!k.anchorHeight){var g=s/b*100;l+="top: "+g+"%;";l+="height: "+c+"px;"}else{if(!k.anchorTop&&!k.anchorBottom&&k.anchorHeight){var g=s/b*100;var m=c/b*100;l+="top: "+g+"%;";l+="height: "+m+"%;"}else{if(!k.anchorTop&&k.anchorBottom&&!k.anchorHeight){var q=b-s-c;l+="bottom: "+q+"px;";l+="height: "+c+"px;"}else{if(!k.anchorTop&&k.anchorBottom&&k.anchorHeight){var q=s+e;var m=c/b*100;l+="top: "+(b-q)+"px;";l+="height: "+m+"%;"}else{if(k.anchorTop&&!k.anchorBottom&&!k.anchorHeight){l+="top:"+s+"px;";l+="height:"+c+"px;"}else{if(k.anchorTop&&!k.anchorBottom&&k.anchorHeight){var m=c/b*100;l+="top:"+s+"px;";l+="height:"+m+"%;"}else{if(k.anchorTop&&k.anchorBottom){l+="top:"+s+"px;";var q=s+c;l+="height:calc(100% - "+s+"px - "+(b-q)+"px);"}}}}}}}}return l},addBorde},getState:function(c,d,a,b){if(b==null){b="default"}if(c.states.length==1){return c.states[0].bindings[d]}else{var e=null;$.each(c.state});if(e.bindings==null||e.bindings[d]==undefined){return c.states[0].bindings[d]}else{return e.bindings[d]}}},updateState:function(c){var b=this;var d=b.items.items[0];var a=b.getState(b.json,"url","landscape",c);if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){d.setStyle({webkitMaskImage:"url("+a+")",oMaskImage:"url("+a+")",mozMaskImage:"url("+a+")",maskImage:"url("+a+")"})}else{d.setSrc(a)}},checkDP},toggleState:function(){var a=this;if(a.currentState=="default"){a.currentState="selected"}else{a.currentState="default"}a.updateState(a.currentState)},handleBookmark:function(){var a=this;if(a.json.globalID==="BookmarkIconEdition"){a.setItemId("tabPhoneViewBookmark")}},initializePagesBrowserView:function(){var a=this;a.setItemId(InfinityMobile.controller.LayoutController.SUBVIEW.TOOLBAR_ICON.PAGES_BROWSER.ITEM_ID);a.addCls("hide-below-375px")}},0,["layoutview"],["component","container","layoutview"],{component:true,container:true,layoutview:true},["widget.layoutview"],0,[InfinityMobile.view,"LayoutView"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.LayoutToolBarIconView",InfinityMobile.view.LayoutView,{config:{width:30,height:40,style:"background-size: contain; background-repeat: no-repeat; background-position: center; cursor:pointer; image-rendering: optimizeQuality;",cls:"toolbarIcon",items:[{itemId:"tooltip",cls:"tooltiptoolbar",style:"z-index:10000"}]},initialize:function(){var a=this;if(a.config.iconUrl!=null){a.iconUrl=a.config.iconUrl;a.loadIcon()}else{if(a.config.setting!=null){a.setting=a.config.setting;a.loadIcon()}}if(a.config.event!=null){a.event=a.config.event;a.setupEvent()}a.tooltip=a.getComponent("tooltip");a.tooltip.hide();a.element.dom.onmouseove};a.element.dom.onmouseou}},loadTooltip:function(){var a=this;console.log(settings);if(a.setting=="fullscreenicon"){a.tooltip.setHtml("Fullscreen");a.tooltipRight()}else{if(a.setting=="fitpageicon"){a.tooltip.setHtml("Page Fit");a.tooltipRight()}else{if(a.setting=="fillpageicon"){a.tooltip.setHtml("Page Fill");a.tooltipRight()}else{if(a.setting=="singlepageicon"){a.tooltip.setHtml("Single Page");a.tooltipRight()}else{if(a.setting=="doublepageicon"){a.tooltip.setHtml("Double Page");a.tooltipRight()}else{if(a.setting=="firsticon"){a.tooltip.setHtml("First Page");a.tooltipRight()}else{if(a.setting=="previousicon"){a.tooltip.setHtml("Previous Page");a.tooltipRight()}else{if(a.setting=="nexticon"){a.tooltip.setHtml("Next Page");a.tooltipRight()}else{if(a.setting=="lasticon"){a.tooltip.setHtml("Last Page");a.tooltipRight()}else{if(a.setting=="menuicon"){a.tooltip.setHtml("Menu");a.tooltipLeft()}else{if(a.setting=="searchicon"){a.tooltip.setHtml("Search");a.tooltipRight()}else{if(a.setting=="shareicon"){a.tooltip.setHtml("Share");a.tooltipRight()}else{if(a.setting=="archiveicon"){if(settings.menu.archiveText==null){a.tooltip.setHtml("Archive")}else{a.tooltip.setHtml(settings.menu.archiveText)}a.tooltipRight()}else{if(a.setting=="downloadicon"){if(settings.menu.downloadText==null){a.tooltip.setHtml("Download")}else{a.tooltip.setHtml(settings.menu.downloadText)}a.tooltipRight()}else{if(a.setting=="bookmarksicon"){if(settings.menu.bookmarkText==null){a.tooltip.setHtml("Bookmarks")}else{a.tooltip.setHtml(settings.menu.bookmarkText)}a.tooltipRight()}else{if(a.setting=="printicon"){if(settings.menu.printText==null){a.tooltip.setHtml("Print")}else{a.tooltip.setHtml(settings.menu.printText)}a.tooltipRight()}else{if(a.setting=="clippingicon"){if(settings.menu.clippingText==null){a.tooltip.setHtml("Create Clipping")}else{a.tooltip.setHtml(settings.menu.clippingText)}a.tooltipRight()}else{if(a.setting=="infoicon"){if(settings.menu.howToUseText==null){a.tooltip.setHtml("How To Use")}else{a.tooltip.setHtml(settings.menu.howToUseText)}a.tooltipRight()}else{if(a.setting=="accounticon"){a.tooltip.setHtml("Test");a.tooltipLeft()}else{a.tooltip.hide();a.setWidth("100%");console.log("-------------------- LOGO -------------------")}}}}}}}}}}}}}}}}}}}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},tooltipLef},loadIcon:function(){var b=this;var a="";if(b.iconUrl!=null){a=b.iconUrl}else{a=settings.topbar[b.setting]}if(b.setting=="archiveicon"){if(settings.newsday!=null){if(settings.newsday.archiveIcon!=null){if(settings.newsday.archiveIcon.length>0){a=settings.newsday.archiveIcon}}}}if(b.setting=="sectionlisticon"){if(settings.newsday!=null){if(settings.newsday.sectionsIcon!=null){if(settings.newsday.sectionsIcon.length>0){a=settings.newsday.sectionsIcon;b.setWidth(70)}}}}if(b.setting=="zonesicon"){if(settings.newsday!=null){if(settings.newsday.zonesIcon!=null){if(settings.newsday.zonesIcon.length>0){a=settings.newsday.zonesIcon;b.setWidth(50)}}}}if(b.setting=="firsticon"){if(settings.newsday!=null){if(settings.newsday.firstPageIcon!=null){if(settings.newsday.firstPageIcon.length>0){a=settings.newsday.firstPageIcon}}}}if(b.setting=="previousicon"){if(settings.newsday!=null){if(settings.newsday.prevPageIcon!=null){if(settings.newsday.prevPageIcon.length>0){a=settings.newsday.prevPageIcon}}}}if(b.setting=="nexticon"){if(settings.newsday!=null){if(settings.newsday.nextPageIcon!=null){if(settings.newsday.nextPageIcon.length>0){a=settings.newsday.nextPageIcon}}}}if(b.setting=="lasticon"){if(settings.newsday!=null){if(settings.newsday.lastPageIcon!=null){if(settings.newsday.lastPageIcon.length>0){a=settings.newsday.lastPageIcon}}}}if(b.setting=="puzzlesIconUrl"){b.element.dom.style.margin="1px 10px"}if(a!=""&&(typeof EDITIONAPP=="undefined"||!EDITIONAPP)){b.setStyle({backgroundImage:"url("+a+")"})}else{b.editionAppIconSetup(a,settings.topbar.color)}},editionAppIconSetup:function(a,b){if(currentProfile=="desktop"){var k=this.config.iconHeight!=null?this.config.iconHeight:23;var f=this.config.iconWidth!=null?this.config.iconWidth:this.setting=="doublepageicon"?46:23;var e={x:0,y:0};var h=this.uuidv4();var c="";try{var d=this.getBrowser()}catch(g){var d}if(d!=null&&d.name=="Safari"&&parseFloat(d.version)<12){if(typeof hexToRgb!="undefined"){var j=hexToRgb(b);c='<div class="imagemask" style="width: '+f+"px; height: "+k+"px; -webkit-mask-size: contain; mask-size: contain; -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat; -webkit-mask-position: center; mask-position: center; cursor: pointer; background-color: rgb("+j+"); -webkit-mask-image: url('"+a+"'); -o-mask-image: url('"+a+"'); -moz-mask-image: url('"+a+"'); mask-image: url('"+a+"'); \" ></div>"}}else{if(typeof hexToRgb!="undefined"){var j=hexToRgb(b);splitColour=j.split(",");var l=this.setMatrixString(parseInt(splitColour[0]),parseInt(splitColour[1]),parseInt(splitColour[2]));c='<div class="imagesvg" style=\'width: 30px; height: 30px;\' ><svg width="'+f+'" height= "'+k+'" viewBox="'+e.x+" "+e.y+" "+f+" "+k+'"><defs><filter id="filter'+h+'"><feColorMatrix id="gray" type="matrix" color-interpolation-filters="sRGB" values="'+l+'" /></filter></defs ><image x="0" y="0" width="'+f+'" height="'+k+'" filter="url(#filter'+h+')" href="'+a+'" /></svg ></div >'}}this.setHtml(c)}else{var k=this.config.iconHeight!=null?this.config.iconHeight:23;var f=this.config.iconWidth!=null?this.config.iconWidth:this.setting=="doublepageicon"?46:23;var e={x:0,y:0};var h=this.uuidv4();var c="";if(typeof hexToRgb!="undefined"){var j=hexToRgb(b);c='<div class="imagemask" style="width: '+f+"px; height: "+k+"px; -webkit-mask-size: contain; mask-size: contain; -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat; -webkit-mask-position: center; mask-position: center; cursor: pointer; background-color: rgb("+j+"); -webkit-mask-image: url('"+a+"'); -o-mask-image: url('"+a+"'); -moz-mask-image: url('"+a+"'); mask-image: url('"+a+"'); \" ></div>"}this.setHtml(c)}},getBrowser:function(){var b=navigator.userAgent,a,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(c[1])){a=/\brv[ :]+(\d+)/g.exec(b)||[];return{name:"IE",version:(a[1]||"")}}if(c[1]==="Chrome"){a=b.match(/\bOPR|Edge\/(\d+)/);if(a!=null){return{name:"Opera",version:a[1]}}}c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"];if((a=b.match(/version\/(\d+)/i))!=null){c.splice(1,1,a[1])}return{name:c[0],version:c[1]}},setMatrixString:function(d,c,a){return"0 0 0 0 "+(d/255)+" 0 0 0 0 "+(c/255)+" 0 0 0 0 "+(a/255)+" 0 0 0 1 0"},uuidv4:function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=Math.random()*16|0,a=d=="x"?b:(b&3|8);return a.toString(16)})},setupEvent:function(){var a=this;if(a.event!="toolbarShare"){a.element.on("tap",function(){if(a.setting=="editionAppClose"||a.config.setting=="editionAppClose"){window.open(settings.topbar.logoUrl,"_self")}else{if(typeof trackReaderEvent!="undefined"){}mainPanel.fireEvent("trackTopBarIcon",a.event);mainPanel.fireEvent(a.event,a)}})}}},0,["layouttoolbaricon"],["component","container","layoutview","layouttoolbaricon"],{component:true,container:true,layoutview:true,layouttoolbaricon:true},["widget.layouttoolbaricon"],0,[InfinityMobile.view.desktop,"LayoutToolBarIconView"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderZoomSlider",Ext.Container,{config:{style:"color:white;display:inline-block;",items:[{itemId:"sliderContainer",layout:"hbox",width:"100%",height:"100%",items:[{itemId:"zoomOut",cls:"zoomBtn zoomOut",width:20,height:24,style:"background-image:url(../assets/zoomSlider/decrease-ic.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"zoomSlider",cls:"zoomSlider",flex:4},{itemId:"zoomIn",cls:"zoomBtn zoomIn",width:20,height:24,style:"background-image:url(../assets/zoomSlider/increase-ic.png);background-size:contain;background-position:center;background-repeat:no-repeat;"}]},{itemId:"tooltipZoomIn",cls:"tooltip",hidden:true,style:"z-index:10000"},{itemId:"tooltipZoomOut",cls:"tooltip",hidden:true,style:"z-index:10000"}]},initialize:function(){var e=this;if(e.config.json!=null){Ext.Container.prototype.initialize.apply(this,arguments)}var a=InfinityMobile.app.getController("LayoutController");var c=Ext.getStore("SettingStore");var g="2px";var f="0px";e.sliderContainer=e.getComponent("sliderContainer");e.slider=e.sliderContainer.getComponent("zoomSlider");e.zoomOutBtn=e.sliderContainer.getComponent("zoomOut");e.zoomInBtn=e.sliderContainer.getComponent("zoomIn");e.slider.setHtml('<div style:"text-align:center;color:white;"><input id="slider" type="range" min="1" max="'+settings.page.maxZoomLevel+'" step="0.01" style="background:none;cursor:pointer;z-index:5;position:absolute;left:17.5%;top:'+g+";margin-top:"+f+';width:65%;" value="1"/></div>');if(typeof(NEWPWA)!=="undefined"){var d=typeof settings!="undefined"&&settings.topbar!=null&&settings.topbar.zoomOutIcon!=null?settings.topbar.zoomOutIcon:"../assets/zoomSlider/minus.png";var b=typeof settings!="undefined"&&settings.topbar!=null&&settings.topbar.zoomInIcon!=null?settings.topbar.zoomInIcon:"../assets/zoomSlider/plus.png";e.zoomOutBtn.setStyle({"background-image":'url("'+d+'")',"background-size":"contain","background-position":"center","background-repeat":"no-repeat"});e.zoomInBtn.setStyle({"background-image":'url("'+b+'")',"background-size":"contain","background-position":"center","background-repeat":"no-repeat"});e.element.dom.style.minWidth="80px";e.slider.setHtml('<div style:"text-align:center;color:white;"><input id="slider" type="range" min="1" max="'+settings.page.maxZoomLevel+'" step="0.01" style="background:none;cursor:pointer;z-index:5;position:absolute;top:'+g+";margin-top:"+f+';width:100%;" value="1"/></div>')}else{g=Ext.browser.is.Firefox?"0px":Ext.browser.is.IE?"3px":"-4px";e.slider.setHtml('<div style="text-align:center;color:white;padding: 0px 5px;"><input id="slider" type="range" min="1" max="'+settings.page.maxZoomLevel+'" step="0.01" style="background:none;cursor:pointer;z-index:5;width: 100%;top:'+g+';position:relative;" value="1"/></div>');var d=typeof settings!="undefined"&&settings.topbar!=null&&settings.topbar.zoomOutIcon!=null?settings.topbar.zoomOutIcon:"../assets/zoomSlider/decrease_ic_2021.png";var b=typeof settings!="undefined"&&settings.topbar!=null&&settings.topbar.zoomInIcon!=null?settings.topbar.zoomInIcon:"../assets/zoomSlider/increase_ic_2021.png";e.zoomOutBtn.setStyle({"background-image":'url("'+d+'")',"background-size":"80% 80%","background-position":"center","background-repeat":"no-repeat"});e.zoomInBtn.setStyle({"background-image":'url("'+b+'")',"background-size":"80% 80%","background-position":"center","background-repeat":"no-repeat"});e.element.dom.style.minWidth="80px"}e.firstTap=false;e.sliderElement=e.element.down("input");if(Ext.browser.name!="IE"){$(e.sliderElement.dom).mouseup(function(){if(!e.firstTap){e.firstTap=true;e.zooming()}e.zooming();e.zoomEnd()});e.sliderElement.dom.addEventListener("touchend",function(){if(!e.firstTap){e.firstTap=true;e.zooming()}e.zooming();e.zoomEnd()});e.sliderElement.dom.oninput=function(){e.zooming()}}else{$(e.sliderElement.dom).mouseup(function(){if(!e.firstTap){e.firstTap=true;e.zooming()}e.zooming();e.zoomEnd()});e.sliderElement.dom.addEventListener("touchend});e.sliderElement.dom.onchange=function(){e.zooming()}}e.startedZoom=false;clear=function(){clearInterval(e.timer)};zoo};zoomHol};zoomOutHol};zoomStopHol};zoomOu};e.zoomInBtn.canTap=true;e.zoomInBtn.element.on({tap:function(){if(e.zoomInBtn.canTap){e.zoomInBtn.canTap=false;var m=parseFloat(e.sliderElement.dom.max);var k=parseFloat(m).toFixed(2);var l=parseFloat((m-1)/4).toFixed(2);l=parseFloat(l)+parseFloat(0.01);var j=parseFloat(e.sliderElement.dom.value).toFixed(2);var h=parseFloat(j)+parseFloat(l);if(parseFloat(k)>parseFloat(j)){if(h<=k){e.sliderElement.dom.value=h;e.zoom()}else{e.sliderElement.dom.value=k;e.zoom()}e.zoomEnd();e.trackZoomIn(e.sliderElement.dom.value)}setTimeout(function(){e.zoomInBtn.canTap=true},300)}}});e.zoomOutBtn.canTap=true;e.zoomOutBtn.element.on({tap:function(){if(e.zoomOutBtn.canTap){e.zoomOutBtn.canTap=false;var l=parseFloat(e.sliderElement.dom.max);var k=parseFloat((l-1)/4).toFixed(2);k=parseFloat(k)+parseFloat(0.01);var j=parseFloat(e.sliderElement.dom.value).toFixed(2);var h=parseFloat(j)-parseFloat(k);if(j>1){if(h>=1){e.sliderElement.dom.value=h;e.zoom()}else{e.sliderElement.dom.value=1;e.zoom()}e.zoomEnd();e.trackZoomOut(e.sliderElement.dom.value)}setTimeout(function(){e.zoomOutBtn.canTap=true},300)}}});Ext.Viewport.on({resize:e.onResize,scope:e})},trackZoomOut:function(b){var a=this;mainPanel.fireEvent("zoomOut",b)},trackZoomI},onResize:function(){var a=this;if($("#slider").width()>$(a.element.dom).width()-30){if(typeof EDITIONAPP!="undefined"){}else{a.zoomInBtn.setWidth(10);a.zoomOutBtn.setWidth(10)}}else{if($("#slider").width()>$(a.element.dom).width()-40){if(typeof EDITIONAPP!="undefined"){}else{a.zoomInBtn.setWidth(14);a.zoomOutBtn.setWidth(14)}}else{if($(a.element.dom).width()*0.65<=$(a.element.dom).width()-40){$("#slider").show();a.zoomInBtn.setWidth(20);a.zoomOutBtn.setWidth(20)}}}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.tooltipZoomIn.element.dom.style.webkitTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomIn.element.dom.style.MozTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomIn.element.dom.style.msTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},zoo},zooming:function(){var a=this;if(!a.startedZoom){a.fireEvent("zoomStart",a,a.sliderElement.dom.value);a.startedZoom=true}else{a.fireEvent("zoom",a,a.sliderElement)}},zoomEnd:function(){var a=this;if(a.sliderElement.dom.value==1){a.fireEvent("zoomEnd",a,a.sliderElement)}else{a.fireEvent("zoomEnd",a,a.sliderElement)}a.startedZoom=false}},0,["zoomSlider"],["component","container","zoomSlider"],{component:true,container:true,zoomSlider:true},["widget.zoomSlider"],0,[InfinityMobile.view,"ReaderZoomSlider"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.LayoutToolBarToggleIconView",InfinityMobile.view.desktop.LayoutToolBarIconView,{config:{cls:"toolbarIcon"},initialize:function(){var a=this;a.toggleGroup=null;if(a.config.toggleGroup!=null){a.toggleGroup=a.config.toggleGroup;a.fireEvent("addToggleGroup",a,a.toggleGroup)}if(a.config.iconUrl){a.iconUrl=a.config.iconUrl}a.currentState="";if(a.config.selectedSetting!=null){a.selectedSetting=a.config.selectedSetting}else{if(a.config.iconSelectedUrl){a.iconSelectedUrl=a.config.iconSelectedUrl}}InfinityMobile.view.desktop.LayoutToolBarIconView.prototype.initialize.call(this)},setupEvent:function(){var a=this;a.element.on("tap",function(){if(a.toggleGroup!="bookmark"){a.toggleState()}mainPanel.fireEvent(a.event,a)})},toggleStat},updateState:function(b){var a=this;if(b!=a.currentState){a.currentState=b;switch(a.currentState){case"selected":a.loadSelectedIcon();break;case"":default:if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(typeof NEWPWA!="undefined"&&NEWPWA===true&&a.toggleGroup=="bookmark"){a.loadIcon()}else{a.loadDeSelectedIcon()}}else{a.loadIcon()}break}}},loadSelectedIcon:function(){var b=this;var a="";if(b.iconSelectedUrl!=null){a=b.iconSelectedUrl}else{a=settings.topbar[b.selectedSetting]}if(a!=""&&(typeof EDITIONAPP=="undefined"||!EDITIONAPP)){b.setStyle({backgroundImage:"url("+a+")"})}else{if(b.editionAppIconSetup!=null){b.editionAppIconSetup(a,settings.topbar.color)}}},loadDeSelectedIcon:function(){var b=this;var a="";if(b.iconSelectedUrl!=null){a=b.iconUrl}else{a=settings.topbar[b.setting]}if(b.editionAppIconSetup!=null){b.editionAppIconSetup(a,"8d8d8d")}}},0,["layouttoolbartoggleicon"],["component","container","layoutview","layouttoolbaricon","layouttoolbartoggleicon"],{component:true,container:true,layoutview:true,layouttoolbaricon:true,layouttoolbartoggleicon:true},["widget.layouttoolbartoggleicon"],0,[InfinityMobile.view.desktop,"LayoutToolBarToggleIconView"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.LayoutToolBarView",InfinityMobile.view.LayoutView,{config:{padding:8,layout:{type:"hbox"},id:"desktopToolbar",items:[{itemId:"tooltiptool",cls:"tooltiptoolbar",style:"z-index:10000"},{flex:1,itemId:"viewOptions",layout:"hbox",style:"overflow:hidden;",cls:"toolbarLeftContainer",defaults:{margin:"0 10px 0 0"},items:[{id:"toolbarIcon",cls:"toolbarIcon",defaults:{width:"100%",height:"100%",left:0,top:0},items:[{cls:"toolbarIconLarge",itemId:"toolbarIconLarge",style:"background-position: left center; background-size: contain; background-repeat: no-repeat;"},{cls:"toolbarIconSmall",itemId:"toolbarIconSmall",style:"background-position: left center; background-size: contain; background-repeat: no-repeat;"}]},{itemId:"accountIcon",xtype:"layouttoolbaricon",setting:"accounticon",event:"accountIcon",height:23},{itemId:"fullscreenIcon",xtype:"layouttoolbaricon",setting:"fullscreenicon",event:"fullscreenMode",height:23},{cls:"toolbarZoomBar",itemId:"toolbarZoomBar",xtype:"zoomSlider",height:23},{itemId:"zoomMode",xtype:"layouttoolbaricon",toggleGroup:"zoomMode",setting:"fitpageicon",selectedSetting:"fitpageicon",event:"toggleZoomMode",height:23},{itemId:"dpsSingle",xtype:"layouttoolbartoggleicon",toggleGroup:"dps",setting:"singlepageicon",selectedSetting:"singlepageselectedicon",event:"dpsModeOff",height:23},{itemId:"dpsDouble",xtype:"layouttoolbartoggleicon",toggleGroup:"dps",setting:"doublepageicon",selectedSetting:"doublepageselectedicon",event:"dpsModeOn",height:23}]},{width:275,style:"border-left: 1px solid #e1e1e1; border-right: 1px solid #e1e1e1; margin-top:-8px; margin-bottom:-8px",layout:"hbox",padding:"0 10px 0 10px",itemId:"readerPageControlContainer",cls:"toolbarMiddleContainer",defaults:{height:typeof(EDITIONAPP)!=="undefined"?23:40},items:[{itemId:"firstPageIcon",xtype:"layouttoolbaricon",setting:"firsticon",event:"readerFirst"},{itemId:"previousPageIcon",xtype:"layouttoolbaricon",setting:"previousicon",event:"readerLeft"},{flex:1,cls:"toolbarpagenumber",padding:"12px 0 0 0",style:"text-align:center; font-size:16px; cursor:pointer",html:"32 / 64",id:"1ab7241b-dac9-0eb5-d6f8-14ea7114913c",itemId:"readerPageNumberContainer"},{itemId:"nextPageIcon",xtype:"layouttoolbaricon",setting:"nexticon",event:"readerRight"},{itemId:"lastPageIcon",xtype:"layouttoolbaricon",setting:"lasticon",event:"readerLast"}]},{itemId:"iconsContainer",cls:"toolbarRightContainer",flex:1,style:"overflow:hidden",defaults:{margin:"0 10px 0 10px",style:"float:right; background-size: contain; background-repeat: no-repeat; background-position: center; cursor:pointer;",height:23},items:[{xtype:"layouttoolbaricon",setting:"menuicon",event:"openReaderMenu",itemId:"menuicon",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"supplementsicon",event:"toolbarSupplements",itemId:"menuSupplements",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"zonesicon",event:"toolbarZones",itemId:"menuZones",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"sectionlisticon",event:"toolbarSectionList",itemId:"menuSectionList",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"ttsicon",iconUrl:"resources/images/reader%20icons/speech-ic-wht2.png",event:"toggleTTS",itemId:"menuTTS",status:"STOPPED",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"searchicon",event:"toolbarSearch",itemId:"menuSearch",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"shareicon",event:"toolbarShare",itemId:"menuShare",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"archiveicon",event:"toolbarArchive",itemId:"menuArchive",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"puzzlesIconUrl",event:"toolbarPuzzles",itemId:"puzzlesTopbarIconBtn",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"downloadicon",event:"toolbarDownload",itemId:"menuDownload",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbartoggleicon",setting:"bookmarksicon",selectedSetting:"bookmarkfilled",event:"toolbarBookmarks",itemId:"menuBookmarks",cls:"toolbarIcon toolbarIconRight",toggleGroup:"bookmark"},{xtype:"layouttoolbaricon",setting:"printicon",event:"toolbarPrint",itemId:"menuPrint",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"clippingicon",event:"toolbarClipping",itemId:"menuClipping",cls:"toolbarIcon toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"infoicon",event:"toolbarInfo",itemId:"menuInfo",cls:"toolbarIcon toolbarIconRight"}]}]},initialize:function(){var b=this;var a="#ffffff";if(settings.topbar.color!=null){a="#"+settings.topbar.color.replace("#","")}b.setStyle({color:a});var c=b.getComponent("viewOptions");b.topBarIconContainer=c.getComponent("toolbarIcon");b.topBarIconLarge=b.topBarIconContainer.getComponent("toolbarIconLarge");b.topBarIconSmall=b.topBarIconContainer.getComponent("toolbarIconSmall");b.setUpTopBarIcon();b.ttsToggle=b.getComponent("iconsContainer").getComponent("menuTTS");if(window.SpeechSynthesisUtterance===undefined||settings.tts===undefined){b.ttsToggle.hide()}b.setTtsToggleListener();if((settings.newsday!=null&&settings.newsday.extraTopBar=="true")||settings.topbar.extraTopBarLogo=="true"){b.topBarIconContainer.hide()}InfinityMobile.view.LayoutView.prototype.initialize.apply(this,arguments);b.dpsSingle=c.getComponent("dpsSingle");b.dpsDouble=c.getComponent("dpsDouble");b.accountIcon=c.getComponent("accountIcon");b.setDPS();b.zoomMode=c.getComponent("zoomMode");b.setZoom();b.readerPageControlContainer=b.getComponent("readerPageControlContainer");b.readerPageNumberContainer=b.readerPageControlContainer.getComponent("readerPageNumberContainer");if(typeof(EDITIONAPP)!=="undefined"){b.topBarIconContainer.setWidth(30);b.readerPageControlContainer.setStyle("border-left: 1px solid #e1e1e1; border-right: 1px solid #e1e1e1; margin-top:0px; margin-bottom:0px");b.readerPageNumberContainer.setPadding("4px 0 0 0")}b.setPageNumber();b.setIcons();b.setShare();b.setHowTo();b.setupZoomSlider(c);b.setupTooltips();if((settings.newsday!=null&&settings.newsday.menuDirection=="left")||settings.topbar.extraTopBarMenu=="true"){b.menuIcon.hide()}},setupTooltips:function(){var b=this;b.tooltip=b.getComponent("tooltiptool");if(settings.tooltips!=null){b.tooltip.setStyle({backgroundColor:"#"+settings.tooltips.backgroundColor,color:"#"+settings.tooltips.color})}b.fullscreenIcon=b.getComponent("viewOptions").getComponent("fullscreenIcon");if(settings.reader!=null&&settings.reader.hideFullscreen=="true"){b.fullscreenIcon.hide()}try{if(typeof parent!="undefined"&&parent!=window){b.fullscreenIcon.hide()}}catch(a){}b.firstPageIcon=b.readerPageControlContainer.getComponent("firstPageIcon");b.previousPageIcon=b.readerPageControlContainer.getComponent("previousPageIcon");b.nextPageIcon=b.readerPageControlContainer.getComponent("nextPageIcon");b.lastPageIcon=b.readerPageControlContainer.getComponent("lastPageIcon");$(b.tooltip.element.dom).css("visibility","hidden");var c=settings.topbar.toolTips;if(language.topbar.logo!=null){b.tooltipEvent(b.topBarIconContainer.element.dom,"right",language.topbar.logo)}else{b.tooltipEvent(b.topBarIconContainer.element.dom,"right",publicationName)}b.tooltipEvent(b.fullscreenIcon.element.dom,"right",language.topbar.fullscreen);b.tooltipEventZoom();b.tooltipEvent(b.dpsSingle.element.dom,"right",language.topbar.singlePage);b.tooltipEvent(b.dpsDouble.element.dom,"right",language.topbar.doublePage);b.tooltipEvent(b.zoomContainer.zoomInBtn.element.dom,"right",language.topbar.zoomIn);b.tooltipEvent(b.zoomContainer.zoomOutBtn.element.dom,"right",language.topbar.zoomOut);b.tooltipEvent(b.accountIcon.element.dom,"right",language.menu.myAccount);b.tooltipEvent(b.firstPageIcon.element.dom,"right",language.topbar.firstPage);b.tooltipEvent(b.previousPageIcon.element.dom,"right",language.topbar.previousPage);b.tooltipEvent(b.nextPageIcon.element.dom,"left",language.topbar.nextPage);b.tooltipEvent(b.lastPageIcon.element.dom,"left",language.topbar.lastPage);b.tooltipEvent(b.menuInfo.element.dom,"left",language.howToUse.howToUse);b.tooltipEvent(b.menuClipping.element.dom,"left",language.clippings.createClipping);b.tooltipEvent(b.menuPrint.element.dom,"left",language.print.print);b.tooltipEvent(b.menuBookmarks.element.dom,"left",language.bookmarks.bookmarks);b.tooltipEvent(b.menuDownload.element.dom,"left",language.download.download);b.tooltipEvent(b.menuArchive.element.dom,"left",language.archive.archive);b.tooltipEvent(b.menuShare.element.dom,"left",language.topbar.share);b.tooltipEvent(b.menuSearch.element.dom,"left",language.search.search);b.tooltipEvent(b.menuIcon.element.dom,"left",language.menu.menu);b.tooltipEvent(b.menuZones.element.dom,"left",language.menu.zones.capitalizeFirst());b.tooltipEvent(b.menuSupplements.element.dom,"left",language.menu.supplements.capitalizeFirst());b.tooltipEvent(b.menuSectionList.element.dom,"left",language.sectionList.sectionList);b.tooltipEvent(b.ttsToggle.element.dom,"left",language.menu.readAloud);if(b.puzzlesTopbarIconBtn!=null){b.tooltipEvent(b.puzzlesTopbarIconBtn.element.dom,"left",InfinityMobile.controller.ReaderPuzzlesController.LANGUAGE.puzzles)}},tooltipEventZoom:function(){var b=this;var a=b.zoomMode.element.dom;a.onmousemove=function(){var c="";if(b.zoomMode.status=="fit"){c=language.topbar.pageFill}else{c=language.topbar.pageFit}b.tooltip.setHtml(c);b.tooltipRight();$(b.tooltip.element.dom).css("visibility","")};a.onmouseout=function(){$(b.tooltip.element.dom).css("visibility","hidden")}},tooltipEvent:function(a,b,d){var c=this;a.onmouseover=function(){c.tooltip.setHtml(d);if(b=="right"){c.tooltipRight()}else{c.tooltipLeft()}$(c.tooltip.element.dom).css("visibility","")};a.onmouseout=function(){$(c.tooltip.element.dom).css("visibility","hidden")};a.ontouchstart=function(e){e.stopPropagation()};a.ontouch=function(e){e.stopPropagation()};a.ontouchend=function(e){e.stopPropagation();setTimeout(function(){$(c.tooltip.element.dom).css("visibility","hidden")},50)}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},tooltipLeft:function(){var a=this;a.element.dom.onmousemove=(function(b){if((typeof b.target.className=="string"&&b.target.className.indexOf("tooltiptoolbar")==-1)||typeof b.target.className!="string"){a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(b.clientX-$(a.getComponent("tooltiptool").element.dom).width()-25)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(b.clientX-$(a.getComponent("tooltiptool").element.dom).width()-25)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(b.clientX-$(a.getComponent("tooltiptool").element.dom).width()-25)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"}})},setupZoomSlider:function(b){var a=this;a.zoomContainer=b.getComponent("toolbarZoomBar");if(Ext.browser.is.Chrome){if(navigator.appVersion.indexOf("Edge")!=-1){a.zoomContainer.element.dom.style.top="0%"}else{}}else{a.zoomContainer.element.dom.style.top="0%"}if(settings.newsday!=null){a.zoomContainer.addCls("newsdaySlider")}},setUpTopBarIcon:function(){var b=this;var a=settings.topbar;if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){var e={itemId:"editionAppClose",setting:"editionAppClose",event:"editionAppClose",height:23,iconUrl:settings.topbar.feedEditionLogo};var d=Ext.create("InfinityMobile.view.desktop.LayoutToolBarIconView",e);var c=Ext.create("InfinityMobile.view.desktop.LayoutToolBarIconView",e);b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconLarge.add(d);b.topBarIconSmall.add(c)}else{b.topBarIconLarge.setStyle({backgroundImage:"url('"+(a.feedEditionLogo!=null?a.feedEditionLogo:a.logo)+"')"});if(a.smallLogo!=null){var f=a.feedEditionLogo!=null?a.feedEditionLogo:a.smallLogo;b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconSmall.setStyle({backgroundImage:"url("+f+")"})}else{b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconSmall.setStyle({backgroundImage:"url("+(a.feedEditionLogo!=null?a.feedEditionLogo:a.logo)+")"})}b.topBarIconContainer.element.on("tap",function(){if(settings.topbar.logoUrl!=null){if(settings.topbar.logoOpenSameTab=="true"){if(loggedIn=="true"&&settings.subscription!=null&&settings.subscription.pageRestriction=="unique"){var g=settings.topbar.logoUrl.replace("{{PUBID}}",publicationguid);g=g.replace("{{EDID}}",editionguid);window.open(g,"_self")}else{window.open(settings.topbar.logoUrl,"_self")}}else{window.open(settings.topbar.logoUrl,"_blank")}}else{if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.reverse=="true"){mainPanel.fireEvent("readerLast")}else{mainPanel.fireEvent("readerFirst")}}})}},setDPS:function(){var b=this;var a=settings.reader;if(a.toggleDPS=="True"||a.toggleDPS=="true"){if(a.defaultPageMode=="double"){b.dpsSingle.updateState("unselected");b.dpsDouble.updateState("selected")}else{b.dpsDouble.updateState("unselected");b.dpsSingle.updateState("selected")}}else{b.dpsSingle.setHidden(true);b.dpsDouble.setHidden(true)}},setZoom:function(){var b=this;var a=settings.reader;if(a.toggleZoomMode=="True"||a.toggleZoomMode=="true"){if(a.zoomMode=="fit"){b.zoomMode.status="fit";b.zoomMode.iconUrl=settings.topbar.fillpageicon;b.zoomMode.loadIcon()}else{b.zoomMode.status="fill";b.zoomMode.iconUrl=settings.topbar.fitpageicon;b.zoomMode.loadIcon()}}else{b.zoomMode.setHidden(true)}},setPageNumber:function(){var a=this;a.readerPageNumberContainer.element.on("tap",function(){if(typeof(NEWPWA)!=="undefined"){mainPanel.fireEvent("toolbarPages",this)}else{mainPanel.fireEvent("pageNumber",this)}})},setShar},setHowTo:function(){var a=this;a.menuInfo.element.on({tap:a.howToTap,scope:a})},howToTap:function(){if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){}}else{mainPanel.fireEvent("toolbarHowTo",this.menuShare,this.readerPageNumberContainer,this.fullscreenIcon,this.menuIcon,this.menuPrint)}},setIcons:function(){var d=this;d.iconsContainer=d.getComponent("iconsContainer");d.menuIcon=d.iconsContainer.getComponent("menuicon");d.menuSearch=d.iconsContainer.getComponent("menuSearch");d.menuShare=d.iconsContainer.getComponent("menuShare");d.menuArchive=d.iconsContainer.getComponent("menuArchive");d.menuDownload=d.iconsContainer.getComponent("menuDownload");d.menuBookmarks=d.iconsContainer.getComponent("menuBookmarks");d.menuPrint=d.iconsContainer.getComponent("menuPrint");d.menuClipping=d.iconsContainer.getComponent("menuClipping");d.menuInfo=d.iconsContainer.getComponent("menuInfo");d.menuZones=d.iconsContainer.getComponent("menuZones");d.menuSupplements=d.iconsContainer.getComponent("menuSupplements");d.menuSectionList=d.iconsContainer.getComponent("menuSectionList");d.puzzlesTopbarIconBtn=d.iconsContainer.getComponent("puzzlesTopbarIconBtn");if(settings.clippings==null){d.menuClipping.hide()}if(settings.sharing==null){d.menuShare.hide()}if(settings.menu.hideMenu!=null&&settings.menu.hideMenu=="true"){d.menuIcon.hide()}if(settings.menu==null){d.menuIcon.hide();d.menuArchive.hide();d.menuDownload.hide();d.menuBookmarks.hide();d.menuPrint.hide();d.menuSearch.hide();d.menuClipping.hide();d.menuInfo.hide();if(d.menuSectionList!=null){d.menuSectionList.hide()}if(d.puzzlesTopbarIconBtn!=null){d.puzzlesTopbarIconBtn.hide()}}else{if(settings.menu.hideArchive!=null){d.menuArchive.hide()}else{var b=Ext.getStore("ArchiveStore");var c=[];if(b.data.items[0]!=null){if(b.data.items[0].raw.editions!=null&&b.data.items[0].raw.editions!=""){c=b.data.items[0].raw.editions.edition;if(c.length==0){d.menuArchive.hide()}else{if(Object.prototype.toString.call(c)==="[object Object]"){if(c["@name"]==editionName){}}}}}}if(settings.menu.hideDownload!=null){d.menuDownload.hide()}if(settings.menu.hidePrint!=null){d.menuPrint.hide()}if(settings.menu.hideBookmarks!=null){d.menuBookmarks.hide()}if(settings.menu.hideSearch!=null){d.menuSearch.hide()}if(settings.menu.hideSectionList!=null||(settings.menu.sectionList!=null&&settings.menu.sectionList.useSectionScroller=="true")){d.menuSectionList.hide()}if(settings.menu.hideHowToUse!=null&&settings.menu.hideHowToUse=="true"){d.menuInfo.hide()}if(settings.menu.supplements==null||settings.menu.supplements.showSupplementsInTopBar!="true"||(settings.menu.supplements.supplement==null||settings.menu.supplements.supplement.length==0)){d.menuSupplements.hide()}if(d.puzzlesTopbarIconBtn!=null&&!InfinityMobile.controller.ReaderPuzzlesController.hasSettingEnabledForPuzzlesPopup()){d.puzzlesTopbarIconBtn.hide()}}if(settings.bookmarks.bookmark.length==0){d.menuSectionList.hide()}if((settings.menu!=null&&settings.menu.zones==null)||settings.zones.zone==null||settings.zones.zone.length==0||settings.newsday!=null){d.menuZones.hide()}var e=InfinityMobile.app.application.getController("AppController").hasValidLoginViaUserAccessCookie();var a=loggedIn.toLowerCase()=="true"||e===true;if(!a){d.accountIcon.hide()}if(typeof NEWPWA!=="undefined"&&typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hideMyAccount=="true"){d.accountIcon.hide()}else{if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hideMyAccount=="true"){d.accountIcon.hide()}}},showAccountIcon:function(){var a=this;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hideMyAccount=="true"){if(typeof NEWPWA!=="undefined"){a.accountIcon.hide()}}else{a.accountIcon.show()}},capitaliz},setTtsToggleListener:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined){a.ttsToggle.element.on({tap:function(){a.fireEvent("readAloudPage",a)}})}}},0,["layouttoolbar"],["component","container","layoutview","layouttoolbar"],{component:true,container:true,layoutview:true,layouttoolbar:true},["widget.layouttoolbar"],0,[InfinityMobile.view.desktop,"LayoutToolBarView"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderToolbarShareMenu",Ext.Container,{config:{modal:true,width:0,height:40,hideOnMaskTap:true,style:"background:black;display:inline;",items:[{itemId:"menuSharing",xtype:"readermenushare",layout:"hbox",defaults:{margin:5}}]},initializ},loadShar},hid}},0,["readertoolbarsharemenu"],["component","container","readertoolbarsharemenu"],{component:true,container:true,readertoolbarsharemenu:true},["widget.readertoolbarsharemenu"],0,[InfinityMobile.view.desktop,"ReaderToolbarShareMenu"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToViewOptions",Ext.Container,{config:{height:50,width:0,cls:"how-to-item how-to-view-options",items:[{itemId:"graphic",width:270,height:165,left:-100,top:-30,style:"background-image:url(resources/images/howTo/view-options.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",cls:"explainationTitle",style:"color:white;text-align:center;font-size:18px;",left:-25,width:200,top:140},{itemId:"explainationText",cls:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:-25,width:200,top:160}]},initialize:function(){var a=this;a.explainationTitle=a.getComponent("explainationTitle");a.explainationText=a.getComponent("explainationText");a.explainationTitle.setHtml(language.howToUse.viewOptionsTitle);a.explainationText.setHtml(language.howToUse.viewOptionsDesc)}},0,["howtoeditionoptions"],["component","container","howtoeditionoptions"],{component:true,container:true,howtoeditionoptions:true},["widget.howtoeditionoptions"],0,[InfinityMobile.view.desktop,"HowToViewOptions"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToEditionOptions",Ext.Container,{config:{height:50,width:0,cls:"how-to-item how-to-edition-options",items:[{itemId:"graphic",width:270,height:160,right:-75,top:-28,style:"background-image:url(resources/images/howTo/edition-options2.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",cls:"explainationTitle",style:"color:white;text-align:center;font-size:18px;white-space:nowrap;",left:-230,width:200,top:140},{itemId:"explainationText",cls:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:-230,width:200,top:160}]},initialize:function(){var a=this;a.explainationTitle=a.getComponent("explainationTitle");a.explainationText=a.getComponent("explainationText");a.explainationTitle.setHtml(language.howToUse.editionOptionsTitle);a.explainationText.setHtml(language.howToUse.editionOptionsDesc);if(settings.newsday!=null){a.graphic=a.getComponent("graphic");a.graphic.setStyle({backgroundImage:"url(resources/images/howTo/share-arrow-edition-options.png)"});a.graphic.setRight(-96);a.graphic.setTop(-32);a.explainationTitle.setLeft(-190);a.explainationTitle.setTop(130);a.explainationText.setLeft(-190);a.explainationText.setTop(150)}}},0,["howtoeditionoptions"],["component","container","howtoeditionoptions"],{component:true,container:true,howtoeditionoptions:true},["widget.howtoeditionoptions"],0,[InfinityMobile.view.desktop,"HowToEditionOptions"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToMoreEditionOptions",Ext.Container,{config:{height:50,width:0,cls:"how-to-item",items:[{itemId:"graphic",width:250,height:175,right:-200,top:-28,style:"background-image:url(resources/images/howTo/print-download-archive.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",cls:"explainationTitle",style:"color:white;text-align:center;font-size:18px;white-space:nowrap;",left:-100,width:200,top:150,html:"Print, Download, Archive"},{itemId:"explainationText",cls:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:-100,width:200,top:170,html:"Print, download as PDF or find past Digital Daily editions"}]},initialize:function(){var a=this;a.explainationTitle=a.getComponent("explainationTitle");a.explainationText=a.getComponent("explainationText");if(language.howToUse.moreEditionOptionsTitle!=null){a.explainationTitle.setHtml(language.howToUse.moreEditionOptionsTitle)}if(language.howToUse.moreEditionOptionsDesc!=null){a.explainationText.setHtml(language.howToUse.moreEditionOptionsDesc)}}},0,["howtomoreeditionoptions"],["component","container","howtomoreeditionoptions"],{component:true,container:true,howtomoreeditionoptions:true},["widget.howtomoreeditionoptions"],0,[InfinityMobile.view.desktop,"HowToMoreEditionOptions"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToPageControl",Ext.Container,{config:{height:50,width:0,cls:"how-to-item",items:[{itemId:"graphic",width:270,height:180,right:-112,top:-40,style:"background-image:url(resources/images/howTo/navigate-pages2.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",cls:"explainationTitle",style:"color:white;text-align:center;font-size:18px;white-space:nowrap;",left:-195,width:200,top:145},{itemId:"explainationText",cls:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:-195,width:200,top:165}]},initializ}},0,["howtopagecontrol"],["component","container","howtopagecontrol"],{component:true,container:true,howtopagecontrol:true},["widget.howtopagecontrol"],0,[InfinityMobile.view.desktop,"HowToPageControl"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToReader",Ext.Container,{config:{height:200,width:700,centered:true,layout:{type:"hbox",pack:"middle"},cls:"how-to-item",items:[{itemId:"touchscreenHowTo",cls:"touchscreenHowTo",width:250,height:200,style:"background-image:url(resources/images/howTo/touch-screen-friendly.png);background-position:center;background-repeat:no-repeat;",items:[{itemId:"explainationTitle",cls:"explainationTitle",style:"color:white;text-align:center;font-size:18px;white-space:nowrap",left:30,width:200,top:130,hidden:true},{itemId:"explainationText",cls:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:30,width:200,top:150,hidden:true}]},{itemId:"articleHowTo",cls:"articleHowTo",width:250,height:200,style:"background-image:url(resources/images/howTo/article-popouts.png);background-position:center;background-repeat:no-repeat;",items:[{itemId:"explainationTitle",cls:"explainationTitle",style:"color:white;text-align:center;font-size:18px;white-space:nowrap",left:30,width:200,top:130,hidden:true},{itemId:"explainationText",cls:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:30,width:200,top:150,hidden:true}]}]},initialize:function(){var b=this;b.articleHowTo=b.getComponent("articleHowTo");b.articleTitle=b.articleHowTo.getComponent("explainationTitle");b.articleDesc=b.articleHowTo.getComponent("explainationText");b.touchscreenHowTo=b.getComponent("touchscreenHowTo");b.touchscreenTitle=b.touchscreenHowTo.getComponent("explainationTitle");b.touchscreenDesc=b.touchscreenHowTo.getComponent("explainationText");b.articleTitle.setHtml(language.howToUse.articleTitle);b.articleDesc.setHtml(language.howToUse.articleDesc);b.touchscreenTitle.setHtml(language.howToUse.touchscreenTitle);var a=language.howToUse.touchscreenDesc;if(settings.newsday!=null){a=a.replace("Optimised","Optimized")}b.touchscreenDesc.setHtml(a);b.fireEvent("howToReaderInit",b.articleHowTo);b.on({painted:function(){if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1||Ext.browser.is.Safari){b.touchscreenDesc.setTop(150+$(b.touchscreenTitle.element.dom).height())}else{b.touchscreenDesc.setTop(130+$(b.touchscreenTitle.element.dom).height())}b.touchscreenDesc.show();b.touchscreenTitle.show();if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1||Ext.browser.is.Safari){b.articleDesc.setTop(150+$(b.articleTitle.element.dom).height())}else{b.articleDesc.setTop(130+$(b.articleTitle.element.dom).height())}b.articleDesc.show();b.articleTitle.show()},scope:b})}},0,["howtoreader"],["component","container","howtoreader"],{component:true,container:true,howtoreader:true},["widget.howtoreader"],0,[InfinityMobile.view.desktop,"HowToReader"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.DynamicArticlesInterstitialContainer",Ext.Container,{config:{margin:"50 0 0 0"},initialize:function(){var a=this;a.setStyle("height:"+($(document).height()-120)+"px;")},onResize:function(){var a=this;if(a!=null){a.setStyle("height:"+($(document).height()-120)+"px;")}}},0,["dynamicarticlesinterstitialcontainer"],["component","container","dynamicarticlesinterstitialcontainer"],{component:true,container:true,dynamicarticlesinterstitialcontainer:true},["widget.dynamicarticlesinterstitialcontainer"],0,[InfinityMobile.view.desktop,"DynamicArticlesInterstitialContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.DynamicArticlesInterstitial",Ext.Container,{config:{style:"padding:5px 0px 0px 0px",cls:"articlereaderiteminterstitial",items:[{itemId:"advert",cls:"advert"}]},initializ},loadAdver},onResize:function(){var a=this;a.onResizeFn()}},0,["dynamicarticlesinterstitial"],["component","container","dynamicarticlesinterstitial"],{component:true,container:true,dynamicarticlesinterstitial:true},["widget.dynamicarticlesinterstitial"],0,[InfinityMobile.view.desktop,"DynamicArticlesInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToMenuIcon",Ext.Container,{config:{height:50,width:0,modal:{opacity:0},cls:"how-to-item",items:[{itemId:"graphic",width:270,height:295,right:-90,top:-28,style:"background-image:url(resources/images/howTo/menu-options2.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",cls:"explainationTitle",html:"Main Menu",style:"color:white;text-align:center;font-size:18px;",left:-200,width:200,top:275},{itemId:"explainationText",cls:"explainationText",html:"Use the menu to access a full list of options and sections for the edition",style:"color:white;text-align:center;font-size:14px;",left:-200,width:200,top:295}]},initializ}},0,["howtomenuicon"],["component","container","howtomenuicon"],{component:true,container:true,howtomenuicon:true},["widget.howtomenuicon"],0,[InfinityMobile.view.desktop,"HowToMenuIcon"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToArticlesContainer",Ext.Container,{config:{height:50,width:0,modal:{opacity:0},cls:"how-to-item howToArticlesContainer",items:[{itemId:"graphic",width:270,height:235,left:20,bottom:-15,style:"background-image:url(resources/images/howTo/browse-content.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",cls:"explainationTitle",style:"color:white;text-align:center;font-size:18px;",left:165,width:200,bottom:145},{itemId:"explainationText",cls:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:165,width:200,top:-95}]},initializ}},0,["howtoarticlescontainer"],["component","container","howtoarticlescontainer"],{component:true,container:true,howtoarticlescontainer:true},["widget.howtoarticlescontainer"],0,[InfinityMobile.view.desktop,"HowToArticlesContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileWide",Ext.Panel,{config:{padding:5,style:"float:left;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;overflow:hidden;",padding:10,height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.expand=false;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;a.imageContainer=a.getComponent("image");if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.titleContainer=a.getComponent("title");a.setStyle("height:52.5%;width:512px;overflow:hidden;");a.height=52.5;a.imageHeight=1.6;if(a.config.bannerAdCheck!=null){if(a.config.bannerAdCheck=="true"){if(settings.dynamic.adverts!=null){if(settings.dynamic.adverts.bannerAd!=null){a.setStyle("height:72.5%;width:512px;overflow:hidden;");a.height=72.5;a.expandAnim="expandSmallViewTopLeftBanner 0.2s ease-in";a.shrinkAnim="shrinkSmallViewTopLeftBanner 0.2s ease-in";a.imageHeight=1.2}}}}a.timer;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImag},setNoImage:function(){var f=this;f.titleContainer.resetFloating();f.titleContainer.setStyle("background-color:#EEEEEE; color:black;");f.sectionStr="";if(f.article.sections.length>1){for(var d=0;d<f.article.sections.length;d++){f.sectionStr+=f.article.sections[d]+"/"}f.sectionStr=f.sectionStr.substring(0,sectionStr.length-1)}else{if(f.article.sections[0]!=null){f.sectionStr=f.article.sections[0]}}if(f.article.shortStory!=null){var a=f.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(f.sectionStr=="LIVE NEWS"){if(f.article.link!=null){if(f.article.link.length>0){f.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+f.article.link+"\")' onclick='window.open(\""+f.article.link+"\")'>Click here to view full story</p>"}}}f.headlineTextSize=28;var g=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+f.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+f.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+f.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});g.element.on({painted:function(){if(!f.paintedTitle){var h=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var l=$(this.element.dom).height()-h;g.element.down(".shortStory").dom.style.maxHeight=(l-(l%14)-26)+"px";if(g.element.down(".bylineText").dom.clientHeight+g.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}if(g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadline=true}var k=false;while(!k){var j=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(j>$(f.element.dom).height()){f.headlineTextSize=f.headlineTextSize-4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",f.headlineTextSize+"px")}else{k=true;break}}f.paintedTitle=true}},scope:f});f.titleContainer.add(g);if(f.article.body!=null){if(f.article.body.indexOf("<p>")!=-1){f.article.body=f.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var e=localStorage.getItem("bodyFontSize"+publicationguid)}catch(c){var e=null}if(e!=null){var b=e}else{var b=16}f.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",width:"100%",html:f.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",padding:5,flex:1,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resiz},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(p){var u=this;var w=u.titleContainer.getComponent("title");var k=false;if(k&&u.sectionStr.indexOf("LIVE NEWS")==-1){u.fireEvent("articleClick",u.article,u.article.guid)}else{if(k&&u.sectionStr.indexOf("LIVE NEWS")!=1){u.fireEvent("liveArticleClick",u.article)}else{if(!u.hasImage&&!u.expand){if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}}clearInterval(u.timer);if(!u.expand){u.fireEvent("tileTapped",u);u.titleContainer.setPadding(40);if(u.titleContainer.getComponent("title")!=null){var a=u.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px")}var h=u.element.down(".headlineText");if(h!=null){$(h.dom).attr("class","headline");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px")}var g=u.element.down(".subheadlineText");if(g!=null){$(g.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=u.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px")}}if(u.article.body.indexOf("<p>")!=-1){u.article.body=u.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(u.hasImage){u.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(u.imageContainer.element.dom.scrollHeight*u.imageHeight),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+u.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+u.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+u.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+u.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+u.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var m=u.articlePop.getComponent("title").element.down("div");m.dom.style.padding="40px";u.sharingImage=u.articlePop.getComponent("title").getComponent("sharing");u.setupSharing(true);u.sharingImage.show();u.imageContainer.hide();u.titleContainer.hide();u.articlePop.getComponent("image").element.dom.style.backgroundImage="url('"+u.firstImage.url+"')";if(u.imageAspect){u.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{u.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}u.add(u.articlePop);try{var t=localStorage.getItem("bodyFontSize"+publicationguid)}catch(o){var t=null}if(t!=null){var v=t}else{var v=16}$(".articleText").css("font-size",v+"px");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px");u.articlePop.getComponent("title").element.dom.style.position="relative";u.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.articlePop.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.articlePop.items.items[0].element.dom.clientHeight+u.articlePop.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.articlePop.getScrollable().getScroller().on({scroll:function(A){var z=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);var y=u.articlePop.getScrollable().getScroller().position.y;var x=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);if(((z-y)/x)>0){u.articlePop.getComponent("image").element.dom.style.top=(y)+"px";u.articlePop.getComponent("image").element.dom.style.opacity=((z-y)/x)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.titleContainer.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.desktopScroll.down(".x-scroll-indicator-dark")!=null){u.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.titleContainer.items.items[0].element.dom.clientHeight+u.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.titleContainer.setScrollable(true);u.titleContainer.getScrollable().getScroller().setDirectionLock(true);var n=u.titleContainer.getScrollable().getScroller();n.container.dom.offsetParent.style.zIndex=14}u.sharingContainer=u.titleContainer.getComponent("title").getComponent("sharing");u.sharingContainer.show();u.setupSharing(false);u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(u.bylineHidden){console.log(u.bylineHidden);w.element.down(".bylineText").dom.style.visibility=""}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility=""}}u.element.dom.style.position="absolute";u.element.dom.style.zIndex=8;u.expand=true;u.element.dom.style.animation=u.expandAnim;u.element.dom.style.animationFillMode="forwards"}else{if(p.target.className.indexOf("x-scroll-view")==-1&&p.target.className.indexOf("fullStoryLink")==-1){if(u.hasImage){u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}u.articlePop.destroy();u.imageContainer.show();u.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction)}}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}else{u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var h=u.element.down(".headline");if(h!=null){$(h.dom).attr("class","headlineText")}var g=u.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var a=u.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=u.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="";u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction);if(Ext.browser.is.IE){u.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(u.bylineHidden){w.element.down(".bylineText").dom.style.visibility="hidden"}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility="hidden"}if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["smallviewtilewide"],["component","container","panel","smallviewtilewide"],{component:true,container:true,panel:true,smallviewtilewide:true},["widget.smallviewtilewide"],0,[InfinityMobile.view.desktop,"SmallViewTileWide"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileSmall",Ext.Panel,{config:{padding:5,style:"float:left;z-index:6 !important;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;overflow:hidden;",padding:10,height:"100%"}]},initializ},setBackgroundImag},setNoImage:function(){var f=this;f.titleContainer.resetFloating();f.titleContainer.setStyle("background-color:#EEEEEE; color:black;");f.hasImage=false;f.sectionStr="";if(f.article.sections.length>1){for(var d=0;d<f.article.sections.length;d++){f.sectionStr+=f.article.sections[d]+"/"}f.sectionStr=f.sectionStr.substring(0,sectionStr.length-1)}else{if(f.article.sections[0]!=null){f.sectionStr=f.article.sections[0]}}if(f.article.shortStory!=null){var a=f.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(f.sectionStr=="LIVE NEWS"){if(f.article.link!=null){if(f.article.link.length>0){f.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+f.article.link+"\")' onclick='window.open(\""+f.article.link+"\")'>Click here to view full story</p>"}}}var g=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+f.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+f.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+f.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});f.headlineTextSize=28;g.element.on({painted:function(){if(!f.paintedTitle){var h=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var l=$(this.element.dom).height()-h;g.element.down(".shortStory").dom.style.maxHeight=(l-(l%14)-26)+"px";if(g.element.down(".bylineText").dom.clientHeight+g.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}if(g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadline=true}var k=false;while(!k){var j=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(j>$(f.element.dom).height()){f.headlineTextSize=f.headlineTextSize-4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",f.headlineTextSize+"px")}else{k=true;break}}f.paintedTitle=true}},scope:f});f.titleContainer.add(g);if(f.article.body!=null){if(f.article.body.indexOf("<p>")!=-1){f.article.body=f.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var e=localStorage.getItem("bodyFontSize"+publicationguid)}catch(c){var e=null}if(e!=null){var b=e}else{var b=16}f.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",width:"100%",html:f.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",padding:5,flex:1,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resiz},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;console.log(a);if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(p){var u=this;var w=u.titleContainer.getComponent("title");var k=false;if(k&&u.sectionStr.indexOf("LIVE NEWS")==-1){u.fireEvent("articleClick",u.article,u.article.guid)}else{if(k&&u.sectionStr.indexOf("LIVE NEWS")!=1){u.fireEvent("liveArticleClick",u.article)}else{if(!u.hasImage&&!u.expand){if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}}clearInterval(u.timer);if(!u.expand){u.fireEvent("tileTapped",u);u.titleContainer.setPadding(40);if(u.titleContainer.getComponent("title")!=null){var a=u.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px")}var h=u.element.down(".headlineText");if(h!=null){$(h.dom).attr("class","headline");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px")}var g=u.element.down(".subheadlineText");if(g!=null){$(g.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=u.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px")}}if(u.article.body.indexOf("<p>")!=-1){u.article.body=u.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(u.hasImage){u.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(u.imageContainer.element.dom.scrollHeight*u.imageHeight),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+u.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+u.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+u.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+u.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+u.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var m=u.articlePop.getComponent("title").element.down("div");m.dom.style.padding="40px";u.sharingImage=u.articlePop.getComponent("title").getComponent("sharing");u.setupSharing(true);u.sharingImage.show();u.imageContainer.hide();u.titleContainer.hide();u.articlePop.getComponent("image").element.dom.style.background="url('"+u.firstImage.url+"')";u.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%";u.add(u.articlePop);try{var t=localStorage.getItem("bodyFontSize"+publicationguid)}catch(o){var t=null}if(t!=null){var v=t}else{var v=16}$(".articleText").css("font-size",v+"px");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px");u.articlePop.getComponent("title").element.dom.style.position="relative";u.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.articlePop.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.articlePop.items.items[0].element.dom.clientHeight+u.articlePop.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.articlePop.getScrollable().getScroller().on({scroll:function(A){var z=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);var y=u.articlePop.getScrollable().getScroller().position.y;var x=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);if(((z-y)/x)>0){u.articlePop.getComponent("image").element.dom.style.top=(y)+"px";u.articlePop.getComponent("image").element.dom.style.opacity=((z-y)/x)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.titleContainer.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.desktopScroll.down(".x-scroll-indicator-dark")!=null){u.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.titleContainer.items.items[0].element.dom.clientHeight+u.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.titleContainer.setScrollable(true);u.titleContainer.getScrollable().getScroller().setDirectionLock(true);var n=u.titleContainer.getScrollable().getScroller();n.container.dom.offsetParent.style.zIndex=14}u.sharingContainer=u.titleContainer.getComponent("title").getComponent("sharing");u.sharingContainer.show();u.setupSharing(false);u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(u.bylineHidden&&w.element.down(".bylineText")!=null){w.element.down(".bylineText").dom.style.visibility=""}if(u.subheadlineHidden&&w.element.down(".subheadlineText")!=null){w.element.down(".subheadlineText").dom.style.visibility=""}}u.element.dom.style.position="absolute";u.element.dom.style.zIndex=8;u.expand=true;u.element.dom.style.animation=u.expandAnim;u.element.dom.style.animationFillMode="forwards"}else{if(p.target.className.indexOf("x-scroll-view")==-1&&p.target.className.indexOf("fullStoryLink")==-1){if(u.hasImage){u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}u.articlePop.destroy();u.imageContainer.show();u.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction)}}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}else{u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var h=u.element.down(".headline");if(h!=null){$(h.dom).attr("class","headlineText")}var g=u.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var a=u.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=u.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="";u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction);if(Ext.browser.is.IE){u.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(u.bylineHidden){w.element.down(".bylineText").dom.style.visibility="hidden"}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility="hidden"}if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["smallviewtilesmall"],["component","container","panel","smallviewtilesmall"],{component:true,container:true,panel:true,smallviewtilesmall:true},["widget.smallviewtilesmall"],0,[InfinityMobile.view.desktop,"SmallViewTileSmall"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileMed",Ext.Panel,{config:{padding:5,style:"float:left;z-index:6 !important;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;overflow:hidden;",padding:10,height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.expand=false;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;a.imageContainer=a.getComponent("image");if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.titleContainer=a.getComponent("title");a.setStyle("height:52.5%;width:384px;overflow:hidden;");a.height=52.5;a.timer;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.imageAspect=false;c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.headlineTextSize=28;c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p  class='sectionText' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;'>"+c.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;'>"+c.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;>"+c.article.byline+"</p></div>");var d=new Image();d.src=c.firstImage.url;d.onload=function(){var g=d.naturalWidth/d.naturalHeight;if(g<1){c.imageAspect=true;var f=$(c.element.dom).height()/d.naturalHeight;var e=d.naturalWidth*f;if(e>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%";c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}};if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}c.titleContainer.element.on({painte},scope:c})},setNoImage:function(){var f=this;f.titleContainer.resetFloating();f.titleContainer.setStyle("background-color:#EEEEEE; color:black;");f.sectionStr="";if(f.article.sections.length>1){for(var d=0;d<f.article.sections.length;d++){f.sectionStr+=f.article.sections[d]+"/"}f.sectionStr=f.sectionStr.substring(0,sectionStr.length-1)}else{if(f.article.sections[0]!=null){f.sectionStr=f.article.sections[0]}}if(f.article.shortStory!=null){var a=f.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(f.sectionStr=="LIVE NEWS"){if(f.article.link!=null){if(f.article.link.length>0){f.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+f.article.link+"\")' onclick='window.open(\""+f.article.link+"\")'>Click here to view full story</p>"}}}var g=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+f.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+f.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+f.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+f.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});f.headlineTextSize=28;g.element.on({painte},scope:f});f.titleContainer.add(g);if(f.article.body!=null){if(f.article.body.indexOf("<p>")!=-1){f.article.body=f.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}try{var e=localStorage.getItem("bodyFontSize"+publicationguid)}catch(c){var e=null}if(e!=null){var b=e}else{var b=16}f.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",width:"100%",html:f.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",padding:5,flex:1,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var f=this;var g=f.titleContainer.getComponent("title");var c=false;var e=false;while(!e){if(f.titleContainer.element.down(".sectionText")!=null||f.titleContainer.element.down(".headlineText")){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(b>$(f.element.dom).height()){f.headlineTextSize=f.headlineTextSize-4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",f.headlineTextSize+"px")}else{c=true;e=true;break}}else{e=true}}if(f.hasImage){if(c){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;while(c){if(b<$(f.element.dom).height()){if(f.headlineTextSize+4<=20){f.headlineTextSize+=4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize)+"px");b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20}else{c=false;break}}else{$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize-4)+"px");c=false;break}}}}else{if(c){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;while(c){if(b<$(f.element.dom).height()){if(f.headlineTextSize+4<=28){f.headlineTextSize+=4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize)+"px");b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20}else{c=false;break}}else{$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize-4)+"px");f.headlineTextSize-=4;c=false;break}}}}if(g!=null){var j=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var h=$(this.element.dom).height()-j;g.element.down(".shortStory").dom.style.maxHeight=(h-(h%14)-26)+"px";if(parseFloat(g.element.down(".bylineText").dom.clientHeight)+parseFloat(g.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}else{g.element.down(".bylineText").dom.style.visibility="";f.bylineHidden=false}if(parseFloat(g.element.down(".subheadlineText").dom.clientHeight)+parseFloat(g.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadlineHidden=true}else{g.element.down(".subheadlineText").dom.style.visibility="";f.subheadlineHidden=false}}if(f.hasImage){if(f.imageAspect){var d=$(f.element.dom).height()/f.image.naturalHeight;var a=f.image.naturalWidth*d;if(a>$(f.element.dom).width()/2){f.imageContainer.element.dom.style.backgroundSize="50%";f.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{f.imageContainer.element.dom.style.backgroundSize=" auto 100%";f.imageContainer.element.dom.style.backgroundPosition="0% 0%"}}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(typeof a!="undefined"){if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}}},onTap:function(p){var u=this;var w=u.titleContainer.getComponent("title");var k=false;if(k&&u.sectionStr.indexOf("LIVE NEWS")==-1){u.fireEvent("articleClick",u.article,u.article.guid)}else{if(k&&u.sectionStr.indexOf("LIVE NEWS")!=1){u.fireEvent("liveArticleClick",u.article)}else{if(!u.hasImage&&!u.expand){if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}}clearInterval(u.timer);if(!u.expand){u.fireEvent("tileTapped",u);u.titleContainer.setPadding(40);if(u.titleContainer.getComponent("title")!=null){var a=u.element.down(".bylineText");if(a!=null){$(a.dom).attr("class","byline");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px")}var h=u.element.down(".headlineText");if(h!=null){$(h.dom).attr("class","headline");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px")}var g=u.element.down(".subheadlineText");if(g!=null){$(g.dom).attr("class","subheadline");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px")}var f=u.element.down(".sectionText");if(f!=null){$(f.dom).attr("class","section");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px")}}if(u.article.body.indexOf("<p>")!=-1){u.article.body=u.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(u.hasImage){u.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(u.imageContainer.element.dom.scrollHeight*1.6),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+u.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+u.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+u.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+u.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+u.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var m=u.articlePop.getComponent("title").element.down("div");m.dom.style.padding="40px";u.sharingImage=u.articlePop.getComponent("title").getComponent("sharing");u.setupSharing(true);u.sharingImage.show();u.imageContainer.hide();u.titleContainer.hide();u.articlePop.getComponent("image").element.dom.style.backgroundImage="url('"+u.firstImage.url+"')";if(u.imageAspect){u.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{u.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";u.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}u.add(u.articlePop);try{var t=localStorage.getItem("bodyFontSize"+publicationguid)}catch(o){var t=null}if(t!=null){var v=t}else{var v=16}$(".articleText").css("font-size",v+"px");try{var j=localStorage.getItem("bylineFontSize"+publicationguid)}catch(o){var j=null}if(j!=null){var l=j}else{var l=18}$(".byline").css("font-size",l+"px");try{var s=localStorage.getItem("headlineFontSize"+publicationguid)}catch(o){var s=null}if(s!=null){var q=s}else{var q=32}$(".headline").css("font-size",q+"px");try{var c=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(o){var c=null}if(c!=null){var d=c}else{var d=20}$(".subheadline").css("font-size",d+"px");try{var b=localStorage.getItem("sectionFontSize"+publicationguid)}catch(o){var b=null}if(b!=null){var r=b}else{var r=18}$(".section").css("font-size",r+"px");u.articlePop.getComponent("title").element.dom.style.position="relative";u.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.articlePop.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.articlePop.items.items[0].element.dom.clientHeight+u.articlePop.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.articlePop.getScrollable().getScroller().on({scroll:function(A){var z=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);var y=u.articlePop.getScrollable().getScroller().position.y;var x=u.articlePop.getComponent("image").element.dom.style.height.substring(0,u.articlePop.getComponent("image").element.dom.style.height.length-2);if(((z-y)/x)>0){u.articlePop.getComponent("image").element.dom.style.top=(y)+"px";u.articlePop.getComponent("image").element.dom.style.opacity=((z-y)/x)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){u.titleContainer.setScrollable(false);u.desktopScroll=u.element.down(".x-scroll-view");if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="scroll";u.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(u.desktopScroll.down(".x-scroll-container")!=null){$(u.element.dom).on("animationend",function(){if(u.desktopScroll.down(".x-scroll-indicator-dark")!=null){u.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}u.desktopScroll.down(".x-scroll-container").dom.style.height=(u.titleContainer.items.items[0].element.dom.clientHeight+u.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}u.stopPropFunction=function(x){x.stopPropagation()};u.element.dom.onmousewheel=u.stopPropFunction;u.element.dom.addEventListener("DOMMouseScroll",u.stopPropFunction)}}else{u.titleContainer.setScrollable(true);u.titleContainer.getScrollable().getScroller().setDirectionLock(true);var n=u.titleContainer.getScrollable().getScroller();n.container.dom.offsetParent.style.zIndex=14}u.sharingContainer=u.titleContainer.getComponent("title").getComponent("sharing");u.sharingContainer.show();u.setupSharing(false);u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(u.bylineHidden){console.log(u.bylineHidden);w.element.down(".bylineText").dom.style.visibility=""}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility=""}}u.element.dom.style.position="absolute";u.element.dom.style.zIndex=8;u.expand=true;u.element.dom.style.animation=u.expandAnim;u.element.dom.style.animationFillMode="forwards"}else{if(p.target.className.indexOf("x-scroll-view")==-1&&p.target.className.indexOf("fullStoryLink")==-1){if(u.hasImage){u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}u.articlePop.destroy();u.imageContainer.show();u.titleContainer.show();if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction)}}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}else{u.titleContainer.setPadding(10);if(u.sharingImage!=null){u.sharingImage.hide()}if(u.sharingContainer!=null){u.sharingContainer.hide()}if(u.titleContainer.getComponent("title")!=null){u.titleContainer.setScrollable(false);if(u.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){u.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var h=u.element.down(".headline");if(h!=null){$(h.dom).attr("class","headlineText")}var g=u.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var a=u.element.down(".byline");if(a!=null){$(a.dom).attr("class","bylineText")}var f=u.element.down(".section");if(f!=null){$(f.dom).attr("class","sectionText")}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(u.desktopScroll!=null){u.desktopScroll.dom.style.overflowY="";u.element.dom.onmousewheel=null;u.element.dom.removeEventListener("DOMMouseScroll",u.stopPropFunction);if(Ext.browser.is.IE){u.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}u.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(u.bylineHidden){w.element.down(".bylineText").dom.style.visibility="hidden"}if(u.subheadlineHidden){w.element.down(".subheadlineText").dom.style.visibility="hidden"}if(u.titleContainer.getComponent("articleBody").isHidden()){u.titleContainer.getComponent("articleBody").show()}else{u.titleContainer.getComponent("articleBody").hide()}u.expand=false;u.element.dom.style.animation=u.shrinkAnim;setTimeout(function(){u.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["smallviewtilemed"],["component","container","panel","smallviewtilemed"],{component:true,container:true,panel:true,smallviewtilemed:true},["widget.smallviewtilemed"],0,[InfinityMobile.view.desktop,"SmallViewTileMed"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileWeather",Ext.Container,{config:{cls:"articlereaderitemweathertile",height:"100%",width:"100%",style:"float:left;z-index:3;background-color:#90A4B0;overflow:hidden;",items:[{itemId:"title",layout:"vbox",style:"position:absolute;top:0px;left:0px;z-index:10;",items:[{html:"<p class='.thirteen' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;padding:20px 0px 0px 20px;'>WEATHER</p>"},{itemId:"location"},{html:"<p class='ten' style='color:white;font-family:Open Sans, sans-serif;font-size:10px;font-weight:normal;padding:5px 0px 0px 20px;'>Source: BBC Weather</p>"}]},{itemId:"toggle",layout:"hbox",padding:20,style:"position:absolute;top:0px;right:0px;z-index:10;",items:[{html:"<p style='color:white;font-size:13px;padding-right:5px;padding-top:0.2em;'>&deg;C</p>"},{cls:"toggle",itemId:"toggleField",xtype:"togglefield",style:"background:transparent;"},{html:"<p style='color:white;font-size:13px;padding-left:5px;padding-top:0.2em;'>&deg;F</p>"}]},{itemId:"weather",width:"100%",layout:"hbox"}]},initializ},resiz}},0,["smallviewtileweather"],["component","container","smallviewtileweather"],{component:true,container:true,smallviewtileweather:true},["widget.smallviewtileweather"],0,[InfinityMobile.view.desktop,"SmallViewTileWeather"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileWeatherContainer",Ext.Panel,{config:{style:"float:left;z-index:6;padding:5px;",layout:"vbox"},initializ},setWeatherTil}},0,["smallviewtileweathercontainer"],["component","container","panel","smallviewtileweathercontainer"],{component:true,container:true,panel:true,smallviewtileweathercontainer:true},["widget.smallviewtileweathercontainer"],0,[InfinityMobile.view.desktop,"SmallViewTileWeatherContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SectionListOverlay",InfinityMobile.view.SectionListOverlay,{config:{width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{id:"toolBar",xtype:"readeroverlaytitle",titleTxt:"Section List",parentOverlay:this,destoryOnClose:true,rounded:true},{id:"bodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,xtype:"readeritemscontainer",defaults:{width:145,margin:"0 8 16 7"}}]}]},initialize:function(){var a=this;a.setSquareCorners();InfinityMobile.view.SectionListOverlay.prototype.initialize.apply(this,arguments)}},0,["sectionlistoverlay"],["component","container","panel","overlay","sectionlistoverlayparent","sectionlistoverlay"],{component:true,container:true,panel:true,overlay:true,sectionlistoverlayparent:true,sectionlistoverlay:true},["widget.sectionlistoverlay"],0,[InfinityMobile.view.desktop,"SectionListOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SectionListOverlayItem",Ext.Container,{config:{height:40,style:"float:left;border:1px solid grey; overflow:hidden",cls:"sectionlistitem",height:175,items:[{itemId:"itemLabel",cls:"thumbInfo",bottom:0,width:"100%",minHeight:30,padding:"5px",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initializ},setTex},setImage:function(){var a=this;var b=location.protocol+"//"+location.host;if(location.hostname=="localhost"){b=location.protocol+"//edition.pagesuite.com"}var c=b+"/get_image.aspx?w=280&eid="+editionguid+"&pnum="+a.sectionListPageNumber+"&lm="+latestLM;a.setHtml("<img style='width:100%' src='"+c+"' />")},setClickEvent:function(){var a=this;a.element.on("tap",function(){a.fireEvent("sectionListPage",a,a.sectionListPageNumber)})}},0,["sectionlistoverlayitem"],["component","container","sectionlistoverlayitem"],{component:true,container:true,sectionlistoverlayitem:true},["widget.sectionlistoverlayitem"],0,[InfinityMobile.view.desktop,"SectionListOverlayItem"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ZonesOverlay",InfinityMobile.view.ZonesOverlay,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;visibility:hidden;max-width:700px;min-height:412px;",layout:"vbox",items:[{id:"toolBar",xtype:"readeroverlaytitle",titleTxt:"Zones",parentOverlay:this,destoryOnClose:true,rounded:true},{id:"bodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,xtype:"readeritemscontainer",defaults:{width:145,height:170,margin:"0 8 16 7"}}]}]}},0,["zonesoverlay"],["component","container","panel","overlay","zonesoverlayparent","zonesoverlay"],{component:true,container:true,panel:true,overlay:true,zonesoverlayparent:true,zonesoverlay:true},["widget.zonesoverlay"],0,[InfinityMobile.view.desktop,"ZonesOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ZonesOverlayItem",Ext.Container,{config:{style:"float:left;border:1px solid grey; overflow:hidden",cls:"sectionlistitem",items:[{itemId:"itemLabel",cls:"thumbInfo",bottom:0,width:"100%",minHeight:30,padding:"5px",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initializ},setTex},setImage:function(){var a=this;var d="";if(a.zoneItem.editionGuid!=null&&a.zoneItem.editionGuid!=""){d="&eid="+a.zoneItem.editionGuid}else{d="&pbid="+a.zoneItem.guid}var b=location.protocol+"//"+location.host;if(location.hostname=="localhost"){b=location.protocol+"//edition.pagesuite.com"}var c=b+"/get_image.aspx?w=280&"+d;a.setHtml("<img style='width:100%' src='"+c+"' />")},setClickEven}},0,["zonesoverlayitem"],["component","container","zonesoverlayitem"],{component:true,container:true,zonesoverlayitem:true},["widget.zonesoverlayitem"],0,[InfinityMobile.view.desktop,"ZonesOverlayItem"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderArchive",InfinityMobile.view.ReaderArchive,{config:{id:"archivecontainer",width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{id:"archiveToolBar",xtype:"readeroverlaytitle",titleTxt:"Archive",parentOverlay:this,destoryOnClose:true,rounded:true},{id:"archiveBodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{itemId:"archiveContainerText",margin:"0 0 20px 0"},{itemId:"archiveMonthContainerHorizontal",layout:"hbox",items:[{itemId:"leftArrow",cls:"pointerCursor",html:"<img src='resources/images/LeftArrow_Icon.png' style='width:20px' />"},{itemId:"archiveMonthsContainer",height:30,flex:1,layout:"hbox",margin:"0 15px 0 15px",padding:"0 0 10px 0",monthdirection:"horizontal",scrollable:{direction:"horizontal",directionLock:true},defaults:{height:20,margin:"0 20px 0 0",padding:0,style:"font-weight:bold",type:"shortDate"},items:[]},{itemId:"rightArrow",cls:"pointerCursor",html:"<img src='resources/images/RightArrow_Icon.png' style='width:20px' />"}]},{layout:"hbox",itemId:"archiveItemsGlobalContainer",flex:1,width:"100%",items:[{itemId:"archiveMonthsContainer",width:180,height:"100%",monthdirection:"vertical",style:"overflow-y:auto; overflow-x:hidden; -webkit-overflow-scrolling:touch;"},{itemId:"archiveItemsContainer",xtype:"readeritemscontainer",flex:1,height:"100%",defaults:{width:135,margin:"0 8 16 7",cls:"archiveitemphone pointerCursor"}}]}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderArchive.prototype.initialize.apply(this,arguments);a.setMonthPagination();a.fireEvent("initialized",a)},setupVars:function(){var a=this;InfinityMobile.view.ReaderArchive.prototype.setupVars.apply(this,arguments);if(a.archiveBodyContainer!=null){a.archiveMonthsHorizontalContainer=a.archiveBodyContainer.getComponent("archiveMonthContainerHorizontal");if(a.archiveMonthsHorizontalContainer!=null){a.archiveMonthHorizontalContainer=a.archiveMonthsHorizontalContainer.getComponent("archiveMonthsContainer");a.rightArrow=a.archiveMonthsHorizontalContainer.getComponent("rightArrow");a.leftArrow=a.archiveMonthsHorizontalContainer.getComponent("leftArrow")}}if(a.archiveGlobalContainer!=null){a.archiveMonthVerticalContainer=a.archiveGlobalContainer.getComponent("archiveMonthsContainer")}},setMonthPagination:function(){var b=this;var a=b.archiveMonthVerticalContainer;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.archiveUsesTabs!=null){if(settings.menu.archiveMonthDirection!=null&&settings.menu.archiveMonthDirection.toLowerCase()!=null&&settings.menu.archiveMonthDirection.toLowerCase()=="horizontal"){a=b.archiveMonthHorizontalContainer}}else{b.archiveItemsContainer.setDefaults({width:145,margin:"0 8 16 7",cls:"archiveitemphone pointerCursor"})}if(a==b.archiveMonthHorizontalContainer){b.archiveMonthVerticalContainer.hide()}else{b.archiveMonthsHorizontalContainer.hide()}b.archiveMonthsContainer=a}},0,["readerarchive"],["component","container","panel","overlay","readerarchiveparent","readerarchive"],{component:true,container:true,panel:true,overlay:true,readerarchiveparent:true,readerarchive:true},["widget.readerarchive"],0,[InfinityMobile.view.desktop,"ReaderArchive"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderDownload",InfinityMobile.view.ReaderDownload,{config:{width:700,height:"100%",style:"padding:0px;max-height:700px;",zindex:3,layout:"vbox",searchTerm:"",items:[{id:"downloadToolBar",xtype:"readeroverlaytitle",titleTxt:"Download",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"downloadBody",cls:"overlaybody",flex:1,padding:25,layout:"vbox",items:[{itemId:"bodyText"},{itemId:"downloadButtonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,items:[{itemId:"downloadSelectAll",xtype:"readeroverlaybutton",txt:"Select All"},{width:25},{itemId:"downloadSelectNone",xtype:"readeroverlaybutton",txt:"Select None"},{width:25},{itemId:"download",xtype:"readeroverlaybutton",txt:"Download"}]},{itemId:"downloadItems",xtype:"readeritemscontainer",flex:1,defaults:{width:145,margin:"0 6 10 6"}}]}]},initialize:function(){var a=this;a.setSquareCorners();InfinityMobile.view.ReaderDownload.prototype.initialize.apply(this,arguments)}},0,["download"],["component","container","panel","overlay","downloadparent","download"],{component:true,container:true,panel:true,overlay:true,downloadparent:true,download:true},["widget.download"],0,[InfinityMobile.view.desktop,"ReaderDownload"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderBookmark",InfinityMobile.view.ReaderBookmark,{config:{itemId:"bookmarkcontainer",width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{id:"bookmarkToolBar",xtype:"readeroverlaytitle",titleTxt:"Bookmarks",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"bookmarkBodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{itemId:"bookmarkHelperText"},{itemId:"bookmarkAddContainer",layout:{type:"hbox",align:"stretch",pack:"middle"},height:35,margin:"10px 0",items:[{flex:1,itemId:"textInput",html:"<input class='bookmarkName' type='text' placeholder='' style='width:100%; height:35px; padding-left:10px' />"},{itemId:"padding",width:20},{itemId:"bookmarkAddButton",width:150,xtype:"readeroverlaybutton",txt:"Add"}]},{itemId:"bookmarksContainer",flex:1,xtype:"readeritemscontainer",margin:"15 0 0 0",defaults:{width:194,margin:10}}]}]},initialize:function(){var a=this;a.setSquareCorners();InfinityMobile.view.ReaderBookmark.prototype.initialize.apply(this,arguments)}},0,["readerbookmark"],["component","container","panel","overlay","readerbookmarkparent","readerbookmark"],{component:true,container:true,panel:true,overlay:true,readerbookmarkparent:true,readerbookmark:true},["widget.readerbookmark"],0,[InfinityMobile.view.desktop,"ReaderBookmark"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.PrintMenu",InfinityMobile.view.Overlay,{config:{width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{itemId:"toolbar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"toolbarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"body",cls:"overlaybody",flex:1,padding:25,layout:"vbox",items:[{itemId:"desc"},{itemId:"buttonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"selectAll",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]},{itemId:"selectAllMargin",width:25},{itemId:"selectNone",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]},{itemId:"selectNoneMargin",width:25},{itemId:"print",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]}]},{itemId:"printItems",flex:1,defaults:{width:145,margin:"0 6 10 6"}}]}]},initialize:function(){var d=this;console.log("PRINT MENU");var c=d.getComponent("toolbar");d.toolbarClose=c.getComponent("toolbarClose");c.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var a=d.getComponent("body");var b=a.getComponent("buttonsContainer");d.selectAll=b.getComponent("selectAll");d.selectAllMargin=b.getComponent("selectAllMargin");d.selectNone=b.getComponent("selectNone");d.selectNoneMargin=b.getComponent("selectNoneMargin");d.print=b.getComponent("print");d.setCloseListener();d.setSelectAllListener();d.setSelectNoneListener();d.setPrintListener();d.title=c.getComponent("title");d.title.setHtml(language.print.print);d.desc=a.getComponent("desc");d.desc.setHtml(language.print.printContainerText);d.selectAll.getComponent("btnText").setHtml(language.print.selectAll);d.checkSelectAll();d.selectNone.getComponent("btnText").setHtml(language.print.printSelectNone);d.print.getComponent("btnText").setHtml(language.print.print);d.printItemsContainer=a.getComponent("printItems");d.loadPages();d.printItemsContainer.element.down(".x-inner").dom.style.width="100%";d.printItemsContainer.element.down(".x-inner").dom.style.display="inline";if(navigator.maxTouchPoints){d.printItemsContainer.setScrollable({direction:"vertical",directionLock:true})}else{d.printItemsContainer.element.dom.style.overflowY="scroll";d.printItemsContainer.element.dom.style.overflowX="hidden"}if(settings.newsday!=null){c.element.dom.style.borderTopLeftRadius="";c.element.dom.style.borderTopRightRadius="";d.setStyle({borderRadius:"0px"});d.element.down("div").dom.style.borderRadius="0px"}d.handleKeyDown()},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},checkSelectAll:function(){var a=this;if(settings.menu.printSinglePageOnly!=null&&settings.menu.printSinglePageOnly=="true"){a.selectAll.hide();a.selectAllMargin.hide();a.selectNone.hide();a.selectNoneMargin.hide()}},setCloseListene},setSelectAllListener:function(){var a=this;a.selectAll.element.on("tap",function(){a.fireEvent("selectAll",a)});a.selectAll.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},setSelectNoneListener:function(){var a=this;a.selectNone.element.on("tap",function(){a.fireEvent("selectNone",a)});a.selectNone.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},setPrintListener:function(){var a=this;a.print.element.on("tap",function(){a.fireEvent("print",a)});a.print.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},loadPages:function(){var a=this;a.fireEvent("loadPages",a,a.printItemsContainer)},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["printmenu"],["component","container","panel","overlay","printmenu"],{component:true,container:true,panel:true,overlay:true,printmenu:true},["widget.printmenu"],0,[InfinityMobile.view.desktop,"PrintMenu"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ClippingOptionsMenu",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:700,height:"100%",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;max-height:650px;",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,items:[{itemId:"title",top:10,left:10},{id:"clippingOptionsToolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0"},{itemId:"clippingsContainer",style:"border: 1px solid #e6e6e6;max-height:400px;",defaults:{width:198,height:150,margin:"7 8 16 7",cls:"archiveitemphone pointerCursor"}},{itemId:"buttonsContainer",layout:"hbox",height:60,items:[{itemId:"previewBtn",flex:1,cls:"pointerCursor btn",margin:"15 5 5 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/preview-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Preview",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"downloadBtn",flex:1,cls:"pointerCursor btn",margin:"15 5 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/downloads-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Save",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"printBtn",flex:1,cls:"pointerCursor btn",margin:"15 5 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/print-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Print",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"shareBtn",flex:2,cls:"pointerCursor btn",margin:"15 0 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/share-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Share",margin:5,style:"font-size:11pt;"}]}]}]}]},initialize:function(){var b=this;b.clippingsToolbar=b.getComponent("clippingOptionsToolBar");b.clippingsToolbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.closeBtn=b.clippingsToolbar.getComponent("clippingOptionsToolBarClose");b.clippingsBody=b.getComponent("clippingOptionsBodyContainer");b.clippingsContainer=b.clippingsBody.getComponent("clippingsContainer");b.buttonsContainer=b.clippingsBody.getComponent("buttonsContainer");b.previewBtn=b.buttonsContainer.getComponent("previewBtn");b.downloadBtn=b.buttonsContainer.getComponent("downloadBtn");b.printBtn=b.buttonsContainer.getComponent("printBtn");b.shareBtn=b.buttonsContainer.getComponent("shareBtn");b.title=b.clippingsToolbar.getComponent("title");b.title.setHtml(language.clippings.clippingsOptions);b.clippingOptionsContainerText=b.clippingsBody.getComponent("clippingOptionsContainerText");b.clippingOptionsContainerText.setHtml("<p style='font-size:16px;'>"+language.clippings.ClippingsOptionsText+"</p><br /><p style='font-size:12px;color:#444444'>"+language.clippings.clippingsPleaseNote+"</p>");b.previewBtn.getComponent("Preview").setHtml(language.clippings.preview);b.downloadBtn.getComponent("Save").setHtml(language.clippings.save);b.printBtn.getComponent("Print").setHtml(language.clippings.print);b.shareBtn.getComponent("Share").setHtml(language.clippings.share);b.previewBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.downloadBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.printBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.shareBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.closeBtn.element.on("tap",function(){b.destroy()});if(b.config.images!=null){b.images=b.config.images}if(b.config.widths!=null){b.widths=b.config.widths}if(b.config.heights!=null){b.heights=b.config.heights}b.addThumbnails();b.previewBtn.element.on({tap:b.preview,scope:b});b.downloadBtn.element.on({tap:b.download,scope:b});b.printBtn.element.on({tap:b.print,scope:b});b.shareBtn.element.on({tap:b.shareTap,scope:b});if(currentProfile!="desktop"){b.printBtn.hide()}b.clippingsContainer.element.down(".x-inner").dom.style.width="100%";b.clippingsContainer.element.down(".x-inner").dom.style.display="inline";if(navigator.maxTouchPoints){b.clippingsContainer.setScrollable({direction:"vertical",directionLock:true})}else{b.clippingsContainer.element.dom.style.overflowY="scroll"}b.resizeFunc=function(){if(b.element!=null){if($(b.element.dom).height>=650){b.clippingsContainer.element.dom.style.height="400px"}else{b.clippingsContainer.element.dom.style.height=($(b.element.dom).height()-80-$(b.clippingOptionsContainerText.element.dom).height()-$(b.buttonsContainer.element.dom).height())+"px"}}};b.on({painted:b.resizeFunc});Ext.Viewport.on({resize:b.resizeFunc});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeBtn.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}b.element.dom.style.borderRadius=""}b.handleKeyDown();b.handlePresence()},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},getShareUrl:function(b){var c=this;var d=window.location.host;var a=b.split("/");b="https://"+d+"/html5/reader/get_clipping.aspx?edid="+a[5]+"&pnum="+a[6]+"&timestamp="+a[7];return b},preview:function(){var d=this;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c=true;break}}if(c){var a=Ext.create("InfinityMobile.view.ClippingMenuPreview",{images:d.images,clippingMenu:d})}else{d.promptUser(language.clippings.selectClippings)}},download:function(){var j=this;var l=false;if(currentProfile=="desktop"&&!Ext.browser.is.Safari){for(var e=0;e<j.images.length;e++){if(j.clippingsContainer.innerItems[e].clicked){if(Ext.browser.is.IE){try{var d=document.createElement("canvas");var m=d.getContext("2d");var f=new Image();f.src="../get_clipping_download.aspx?b64Url="+encodeURIComponent(btoa(j.images[e]));f.onloa}}catch(h){console.log(h)}l=true}else{var k=document.createElement("a");k.target="_blank";var b=j.images[e];if(Ext.browser.is.Firefox||Ext.browser.is.Chrome){b="../get_clipping_download.aspx?b64Url="+encodeURIComponent(btoa(j.images[e]))}else{if(Ext.browser.is.Safari){b="../get_clipping_download.aspx?b64Url="+encodeURIComponent(btoa(j.images[e]))+"&attachmentHeader=true"}}k.href=b;k.download="clipping"+e+".jpg";var a=document.createEvent("MouseEvents");a.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);k.dispatchEvent(a);l=true}}}}else{var a=document.createEvent("MouseEvents");var k=null;var c=false;for(var e=0;e<j.images.length;e++){if(j.clippingsContainer.innerItems[e].clicked){if(!l){if(Ext.browser.is.Safari&&currentProfile=="desktop"){var g=window.open("../get_clipping_download.aspx?b64Url="+encodeURIComponent(btoa(j.images[e]))+"&attachmentHeader=true");setTimeout(function(){g.close()},1000)}else{k=document.createElement("a");k.target="_blank";var b=j.images[e];k.href=b;k.download="clipping"+e+".jpg";a.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null)}l=true}else{c=true;break}}}if(c){j.promptUser(language.clippings.selectOneClipping)}else{if(k!=null){k.dispatchEvent(a)}}}if(!l){j.promptUser(language.clippings.selectClippings)}},print:function(){var e=this;if(currentProfile=="desktop"){var f=false;var h=[];for(var d=0;d<e.images.length;d++){var b=e.images[d];if(e.clippingsContainer.innerItems[d].clicked){if(!f){f=true}h[h.length]=b}}if(f){var c="print.aspx?edid="+editionguid+"&type=clipping&clippingurls=";var g="";for(var a in h){g+=encodeURIComponent(h[a])+","}if(g[g.length]==","){g=g.substring(0,g.length-1)}c+=g;window.open(c)}else{e.promptUser(language.clippings.selectClippings)}}},shareTap:function(){var d=this;d.shareBtn.removeAll();d.shareBtn.element.dom.style.backgroundColor="#e6e6e6";$(d.shareBtn.element.dom).removeClass("pointerCursor");var b=d.getShareObjects();d.shareBtn.add(b);var a=Ext.getStore("SettingStore");d.emailBtn=d.shareBtn.getComponent("email");d.facebookBtn=d.shareBtn.getComponent("facebook");d.twitterBtn=d.shareBtn.getComponent("twitter");d.linkedinBtn=d.shareBtn.getComponent("linkedin");d.googleBtn=d.shareBtn.getComponent("google");d.pinterestBtn=d.shareBtn.getComponent("pinterest");var c=a.data.items[0].raw.sharing;if(c!=null&&c.allSharing[0]==null){d.emailBtn.hide()}else{d.emailBtn.element.on({tap:d.emailShare,scope:d})}if(c!=null&&c.allSharing[1]==null){d.facebookBtn.hide()}else{d.facebookBtn.element.on({tap:d.facebookShare,scope:d})}if(c!=null&&c.allSharing[2]==null){d.twitterBtn.hide()}else{d.twitterBtn.element.on({tap:d.twitterShare,scope:d})}if(c!=null&&c.allSharing[3]==null){d.linkedinBtn.hide()}else{d.linkedinBtn.element.on({tap:d.linkedinShare,scope:d})}if(c!=null&&c.allSharing[4]==null){d.googleBtn.hide()}else{d.googleBtn.element.on({tap:d.googleShare,scope:d})}if(c!=null&&c.allSharing[5]==null){d.pinterestBtn.hide()}else{d.pinterestBtn.element.on({tap:d.pinterestShare,scope:d})}},getShareObjects:function(){var a=this;var b=null;if(settings.newsday!=null&&settings.newsday.useFontAwesome=="true"){b=[{itemId:"email",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-envelope fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"facebook",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-facebook-official fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"twitter",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-twitter fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"linkedin",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-linkedin-square fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"google",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-google-plus fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"pinterest",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-pinterest fa-lg pointerCursor" aria-hidden="true"></i>'}]}else{b=[{itemId:"email",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/email-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"facebook",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/facebook-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"twitter",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/twitter-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"linkedin",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/linkedin-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"google",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/google-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"pinterest",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/pinterest-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'}]}return b},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingItems",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingsContainer.add(c);c.show()}},promptUser:function(b){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:b})},getSubject:function(){var a="Clippings from "+publicationName;if(settings.clippings.clippingSubject!=null){a=settings.clippings.clippingSubject}return a},emailShare:function(){var e=this;var f=false;var g=e.getSubject();var b="mailto:?subject="+encodeURIComponent(g)+"&body=";var d="To view a clipping, please select one of the links below:\n\n";if(settings.clippings.clippingsBody!=null){d=settings.clippings.clippingsBody+"\n\n"}for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){d+=e.getShareUrl(e.images[c])+" \n\n";f=true}}if(f){if(Ext.browser.userAgent.indexOf("CrOS")!=-1){window.open(b+encodeURIComponent(d))}else{var a=b+encodeURIComponent(d);if(window.parent!=null&&(typeof NEWPWA!="undefined"&&NEWPWA===true)){window.parent.postMessage({type:"sendEmail",message:a},"*")}else{window.location.href=a}}}else{e.promptUser(language.clippings.selectClippings)}},facebookShare:function(){var e=this;var a="";var f=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=encodeURIComponent(e.getShareUrl(e.images[c]));d=true}else{d=false;f=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();window.open("http://www.facebook.com/sharer/sharer.php?m2w&u="+a+"&title="+encodeURIComponent(b))}else{e.promptUser(f)}},twitterShare:function(){var e=this;var a="";var g=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=e.getShareUrl(e.images[c]);d=true}else{d=false;g=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();var f=encodeURIComponent(b+" - "+a);window.open("http://twitter.com/intent/tweet?text="+f)}else{e.promptUser(g)}},linkedinShare:function(){var f=this;var a="";var g=null;var e=false;for(var d=0;d<f.images.length;d++){if(f.clippingsContainer.innerItems[d].clicked){if(!e){a=f.getShareUrl(f.images[d]);e=true}else{e=false;g=language.clippings.selectOneClipping;break}}}if(e){var c=f.getSubject();var b=encodeURIComponent(c+" - "+a);window.open("http://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(a)+"&title="+b)}else{f.promptUser(g)}},googleShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.getShareUrl(d.images[b]);c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("https://plus.google.com/share?url="+encodeURIComponent(a))}else{d.promptUser(e)}},pinterestShare:function(){var e=this;var a="";var f=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=e.getShareUrl(e.images[c]);d=true}else{d=false;f=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();window.open("http://pinterest.com/pin/create/bookmarklet/?media="+encodeURIComponent(a)+"&is_video=false&description="+encodeURIComponent(b))}else{e.promptUser(f)}},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer");Ext.Container.prototype.hide.apply(this,arguments);a.handleAbsence()},show:function(){var a=this;Ext.Container.prototype.show.apply(this,arguments);a.handlePresence()},destroy:function(){var a=this;Ext.Container.prototype.destroy.apply(this,arguments);a.handleAbsence()},handlePresence:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},handleAbsence:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME)}},0,["clippingoptionsmenu"],["component","container","clippingoptionsmenu"],{component:true,container:true,clippingoptionsmenu:true},["widget.clippingoptionsmenu"],0,[InfinityMobile.view.desktop,"ClippingOptionsMenu"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",Ext.Container,{config:{cls:"articleViewBtn",style:"float:left"},initialize:function(){var a=this;if(a.config.images!=null){a.images=a.config.images}if(a.config.article!=null){a.article=a.config.article}a.setHtml("<img src='resources/images/reader icons/expand-gallery-icon.png' style='width:100%; height:auto;' />");a.element.on({tap:function(d){d.stopPropagation();var b=[];for(image in a.images){b.push({url:a.images[image].url})}if(currentProfile=="desktop"){var f="InfinityMobile.view.desktop.ImageGallery"}else{var f="InfinityMobile.view.tablet.ImageGallery"}var c=Ext.create(f,{images:b,article:a.article});Ext.Viewport.add(c)},scope:a})}},0,["fullscreengalleryicon"],["component","container","fullscreengalleryicon"],{component:true,container:true,fullscreengalleryicon:true},["widget.fullscreengalleryicon"],0,[InfinityMobile.view.desktop,"ArticleReaderFullscreenGalleryIcon"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",Ext.Container,{config:{cls:"articleViewBtn",style:"float:left"},initializ},increaseSize:function(){var l=this;try{var e=localStorage.getItem("bodyFontSize"+publicationguid)}catch(j){var e=null}if(e!=null){var a=e}else{var a=16}a=parseInt(a)+2;if(a<=66){try{localStorage.setItem("bodyFontSize"+publicationguid,a)}catch(j){}$(".articleText").css("font-size",a+"px");try{var c=localStorage.getItem("headlineFontSize"+publicationguid)}catch(j){var c=null}if(c!=null){var m=c}else{var m=32}m=parseInt(m)+2;try{localStorage.setItem("headlineFontSize"+publicationguid,m)}catch(j){}$(".headline").css("font-size",m+"px");try{var b=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(j){var b=null}if(b!=null){var h=b}else{var h=20}h=parseInt(h)+2;try{localStorage.setItem("subheadlineFontSize"+publicationguid,h)}catch(j){}$(".subheadline").css("font-size",h+"px");try{var k=localStorage.getItem("bylineFontSize"+publicationguid)}catch(j){var k=null}if(k!=null){var g=k}else{var g=18}g=parseInt(g)+2;try{localStorage.setItem("bylineFontSize"+publicationguid,g)}catch(j){}$(".byline").css("font-size",g+"px");try{var f=localStorage.getItem("sectionFontSize"+publicationguid)}catch(j){var f=null}if(f!=null){var d=f}else{var d=18}d=parseInt(d)+2;try{localStorage.setItem("sectionFontSize"+publicationguid,d)}catch(j){}$(".section").css("font-size",d+"px");if(Ext.browser.is.IE){if(l.tile.hasImage){if(l.tile.articlePop.items.items[0]!=null&&l.tile.articlePop.items.items[1]!=null){l.tile.desktopScroll.down(".x-scroll-container").dom.style.height=(l.tile.articlePop.items.items[0].element.dom.clientHeight+l.tile.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}}else{l.tile.desktopScroll.down(".x-scroll-container").dom.style.height=(l.tile.titleContainer.items.items[0].element.dom.clientHeight+l.tile.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"}}}},decreaseSize:function(){var l=this;try{var e=localStorage.getItem("bodyFontSize"+publicationguid)}catch(j){var e=null}if(e!=null){var a=e}else{var a=16}a=parseInt(a)-2;if(a>=8){try{localStorage.setItem("bodyFontSize"+publicationguid,a)}catch(j){}$(".articleText").css("font-size",a+"px");try{var c=localStorage.getItem("headlineFontSize"+publicationguid)}catch(j){var c=null}if(c!=null){var m=c}else{var m=32}m=parseInt(m)-2;try{localStorage.setItem("headlineFontSize"+publicationguid,m)}catch(j){}$(".headline").css("font-size",m+"px");try{var b=localStorage.getItem("subheadlineFontSize"+publicationguid)}catch(j){var b=null}if(b!=null){var h=b}else{var h=20}h=parseInt(h)-2;try{localStorage.setItem("subheadlineFontSize"+publicationguid,h)}catch(j){}$(".subheadline").css("font-size",h+"px");try{var k=localStorage.getItem("bylineFontSize"+publicationguid)}catch(j){var k=null}if(k!=null){var g=k}else{var g=18}g=parseInt(g)-2;try{localStorage.setItem("bylineFontSize"+publicationguid,g)}catch(j){}$(".byline").css("font-size",g+"px");try{var f=localStorage.getItem("sectionFontSize"+publicationguid)}catch(j){var f=null}if(f!=null){var d=f}else{var d=18}d=parseInt(d)-2;try{localStorage.setItem("sectionFontSize"+publicationguid,d)}catch(j){}$(".section").css("font-size",d+"px");if(Ext.browser.is.IE){if(l.tile.hasImage){if(l.tile.articlePop.items.items[0]!=null&&l.tile.articlePop.items.items[1]!=null){l.tile.desktopScroll.down(".x-scroll-container").dom.style.height=(l.tile.articlePop.items.items[0].element.dom.clientHeight+l.tile.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}}else{l.tile.desktopScroll.down(".x-scroll-container").dom.style.height=(l.tile.titleContainer.items.items[0].element.dom.clientHeight+l.tile.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"}}}}},0,["articlereadertextsizeicon"],["component","container","articlereadertextsizeicon"],{component:true,container:true,articlereadertextsizeicon:true},["widget.articlereadertextsizeicon"],0,[InfinityMobile.view.desktop,"ArticleReaderTextSizeIcon"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ImageGallery",Ext.Container,{config:{modal:true,fullscreen:true,centered:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:20,layout:"vbox",items:[{itemId:"topPanel",layout:"hbox",flex:5,items:[{itemId:"image",flex:3,layout:"hbox",items:[{itemId:"previous",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"},{itemId:"imageCarousel",flex:1,height:"100%",style:"background-color:rgb(75,75,75)"},{itemId:"next",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"}]},{itemId:"galleryContent",flex:1,layout:"vbox",items:[{itemId:"closeBtnRow",width:"100%",height:50,items:[{itemId:"closeBtn",cls:"pointerCursor",right:0,top:0,margin:10,height:25,width:25,style:{backgroundImage:"url('resources/images/reader icons/close-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}]},{itemId:"galleryCounter",height:50,margin:"10 0",width:"100%",layout:"hbox",style:{color:"white",fontSize:"20px",fontWeight:"bold"},items:[{itemId:"cameraIcon",height:30,width:30,margin:10,style:{backgroundImage:"url('resources/images/reader icons/photo-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},{itemId:"counter",height:50,layout:{type:"vbox",pack:"center"},items:[{itemId:"text"}]}]},{itemId:"galleryInfo",width:"100%",layout:"vbox",scrollable:{direction:"vertical",indicators:false},style:{color:"white"},items:[{itemId:"title",style:{fontSize:"40px",fontWeight:"bold"},margin:"10 0"},{itemId:"caption",style:{fontSize:"14px"},margin:"10 0"}]}]}]},{itemId:"imageScroller",flex:1,width:"100%",layout:"hbox",padding:10,scrollable:{direction:"horizontal"}}]},initialize:function(){var a=this;if(a.config.article!=null){a.article=a.config.article}if(a.config.images!=null){a.images=a.config.images}a.topPanel=a.getComponent("topPanel");a.image=a.topPanel.getComponent("image");a.previousBtn=a.image.getComponent("previous");a.previousBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-back-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.nextBtn=a.image.getComponent("next");a.nextBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-next-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.previousBtn.element.on({tap:a.previous,scope:a});a.nextBtn.element.on({tap:a.next,scope:a});a.galleryContent=a.topPanel.getComponent("galleryContent");a.galleryCounterPanel=a.galleryContent.getComponent("galleryCounter");a.counter=a.galleryCounterPanel.getComponent("counter");a.counterText=a.counter.getComponent("text");a.cameraIcon=a.galleryCounterPanel.getComponent("cameraIcon");a.closeBtnRow=a.galleryContent.getComponent("closeBtnRow");a.closeBtn=a.closeBtnRow.getComponent("closeBtn");a.closeBtn.element.on({ta},scope:a});a.imageScroller=a.getComponent("imageScroller");a.galleryInfo=a.galleryContent.getComponent("galleryInfo");a.title=a.galleryInfo.getComponent("title");a.title.setHtml(a.article.headline);a.caption=a.galleryInfo.getComponent("caption");Ext.Viewport.on({resize:a.resizeGallery,scope:a});a.on({painte},scope:a,destroy:function(){a.fireEvent("galleryInvisible")}});a.handleJustification()},handleItemChange:function(c){var b=this;var a=(c._pageNumber);if(b.images!=null){if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){b.counter.setHtml(b.images.length+" / "+(b.images.length-parseFloat(a)))}else{b.counter.setHtml((parseFloat(a)+1)+" of "+b.images.length)}b.caption.setHtml("");if(b.article!=null){if(b.article.images[a].caption!=null){if(b.article.images[a].caption.trim().length>0){var d="";if(b.article.images[a].credit!=null){if(b.article.images[a].credit.trim().length>0){d=" ("+b.article.images[a].credit+")"}}b.caption.setHtml(b.article.images[a].caption+d)}else{if(b.article.shortStory!=null){b.caption.setHtml(b.article.shortStory)}}}else{if(b.article.shortStory!=null){b.caption.setHtml(b.article.shortStory)}}b.setSelectedImage(a)}else{if(b.images[a].caption!=null){if(b.images[a].caption.trim().length>0){b.caption.setHtml(b.images[a].caption)}else{b.caption.setHtml("")}}b.setSelectedImage(a)}}mainPanel.fireEvent("trackImageChange")},setSelectedImage:function(a){var d=this;var c=d.imageScroller.getItems().items;for(var b=0;b<c.length;b++){if(c[b].element.dom.style.border!=""){c[b].element.dom.style.border=""}}c[a].element.dom.style.border="2px solid white"},next:function(){var a=this;a.carousel.next()},previous:function(){var a=this;a.carousel.previous()},resizeGalleryChrome:function(){var a=this;a.galleryInfo.setWidth($(document).width()-$(a.imageCarousel.element.dom).width()-150);a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10)},resizeGallery:function(){var a=this;a.carousel.onSizeChange();a.galleryInfo.setWidth(($(document).width()/4)-50);a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10)},setupCarousel:function(){var b=this;var c=b.images;var a=1;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){c=b.images.slice().reverse();a=b.images.length}b.carousel=Ext.create("InfinityMobile.view.ImageCarousel",{width:"100%",height:"100%",data:c,pageNo:a,pageNumber:a-1,pageTemplate:function(e,g,d){if(e!=null){var f=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:e,position:parseInt(e.index),pageNo:g});return f}}});b.imageCarousel.add(b.carousel);b.carousel.on({activeitemchange:b.handleItemChange,scope:b})},setupThumbnails:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){for(var a=b.images.length-1;a>=0;a--){var c=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:b.images[a].url,carousel:b.carousel,index:a,style:{transition:"all ease 0.5s"}});if(a==b.images.length-1){c.element.dom.style.border="2px solid white"}b.imageScroller.add(c)}}else{for(var a in b.images){var c=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:b.images[a].url,carousel:b.carousel,index:a,style:{transition:"all ease 0.5s"}});if(a==0){c.element.dom.style.border="2px solid white"}b.imageScroller.add(c)}}},handleJustification:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.addCls("justify-right");a.galleryCounterPanel.setPadding("0px 50px");a.galleryCounterPanel.getLayout().setPack("end");a.imageScroller.getLayout().setPack("end");a.galleryCounterPanel.remove(a.cameraIcon,false);a.galleryCounterPanel.add(a.cameraIcon)}}},0,["dynamicimagegallery"],["component","container","dynamicimagegallery"],{component:true,container:true,dynamicimagegallery:true},["widget.dynamicimagegallery"],0,[InfinityMobile.view.desktop,"ImageGallery"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArchiveSelector",Ext.Panel,{config:{height:40,padding:"0 10px",layout:{type:"hbox",align:"center"},items:[{itemId:"selectEdition",style:"font-size:11pt;",html:"Select edition:"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='yearDropDown'></select></div>"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='monthDropDown'></select></div>"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='dayDropDown'></select></div>"},{width:10},{itemId:"change",cls:"pointerCursor",style:"text-decoration:underline;font-size:11pt;",html:"Change"}]},initialize:function(){var c=this;c.datePickerYear=c.element.down("#yearDropDown").dom;c.datePickerMonth=c.element.down("#monthDropDown").dom;c.datePickerDay=c.element.down("#dayDropDown").dom;c.changeBtn=c.getComponent("change");var b=c.hexToRgb(settings.topbar.backgroundColor);if(settings.topbar!=null){c.setStyle({backgroundColor:"rgba("+b.r+","+b.g+","+b.b+",0.9)",color:"#"+settings.topbar.color})}c.changeBtn.element.on({tap:c.changeEdition,scope:c});var a=settings.dateSelector.oldestEdition.split("/");c.earliestDate=new Date(a[2],a[1],a[0]);c.on({painted:function(){c.populateYearDropDown();c.datePickerYear.selectedIndex=c.datePickerYear.options.length-1;c.populateMonthDropDown();c.datePickerMonth.selectedIndex=c.datePickerMonth.options.length-1;c.populateDayDropDown();c.datePickerDay.selectedIndex=c.datePickerDay.options.length-1;if(typeof editionDate!="undefined"&&editionDate!=null&&settings.newsday!=null){c.setAmericanDate(editionDate)}else{c.setTodaysDate()}}});if(currentProfile=="desktop"&&navigator.maxTouchPoints!=null){c.element.on("tap})}},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},firefoxMacFix:function(a){var b=this;$(a).on("mousedown",function(c){c.stopPropagation()})},populateYearDropDown:function(){var c=this;var a=new Date();for(var b=c.earliestDate.getFullYear();b<=a.getFullYear();b++){c.addOption(c.datePickerYear,b,b)}c.datePickerYear.onchange=function(){c.populateMonthDropDown();c.populateDayDropDown()};if(Ext.browser.is.Firefox&&Ext.os.is.MacOS){c.firefoxMacFix(c.datePickerYear)}},populateMonthDropDown:function(){var g=this;var f=g.datePickerMonth.options[g.datePickerMonth.selectedIndex];var b=0;var h=12;var d=new Date();g.datePickerMonth.options.length=0;if(g.datePickerYear.options[g.datePickerYear.selectedIndex].value==d.getFullYear()){h=d.getMonth()+1}if(g.datePickerYear.options[g.datePickerYear.selectedIndex].value==g.earliestDate.getFullYear()){b=g.earliestDate.getMonth()-1}for(var e=b;e<h;e++){var c="Jan";switch(e){case 0:c="Jan";break;case 1:c="Feb";break;case 2:c="Mar";break;case 3:c="Apr";break;case 4:c="May";break;case 5:c="Jun";break;case 6:c="Jul";break;case 7:c="Aug";break;case 8:c="Sep";break;case 9:c="Oct";break;case 10:c="Nov";break;case 11:c="Dec";break}g.addOption(g.datePickerMonth,c,e+1)}g.datePickerMonth.onchange=function(){g.populateDayDropDown()};if(f!=null){for(var a=0;a<g.datePickerMonth.options.length;a++){if(g.datePickerMonth.options[a].value==f.value){g.datePickerMonth.selectedIndex=a;break}}}if(Ext.browser.is.Firefox&&Ext.os.is.MacOS){g.firefoxMacFix(g.datePickerMonth)}},populateDayDropDown:function(){var e=this;var b=e.datePickerDay.options[e.datePickerDay.selectedIndex];e.datePickerDay.options.length=0;var c=new Date();var f=32;switch(e.datePickerMonth.options[e.datePickerMonth.selectedIndex].innerHTML){case"Jan":case"Mar":case"May":case"Jul":case"Aug":case"Oct":case"Dec":f=32;break;case"Apr":case"Jun":case"Sep":case"Nov":f=31;break;case"Feb":if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value%4==0){f=30}else{f=29}break}var g=1;if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value==e.earliestDate.getFullYear()&&e.datePickerMonth.options[e.datePickerMonth.selectedIndex].value==e.earliestDate.getMonth()){g=e.earliestDate.getDate()}if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value==c.getFullYear()&&e.datePickerMonth.options[e.datePickerMonth.selectedIndex].value==c.getMonth()+1){f=c.getDate()+1}for(var d=g;d<f;d++){e.addOption(e.datePickerDay,d.toString(),d.toString())}if(b!=null){for(var a=0;a<e.datePickerDay.options.length;a++){if(e.datePickerDay.options[a].value==b.value){e.datePickerDay.selectedIndex=a;break}}}if(Ext.browser.is.Firefox&&Ext.os.is.MacOS){e.firefoxMacFix(e.datePickerDay)}},addOption:function(a,d,c){var b=document.createElement("option");b.text=d;b.value=c;a.add(b)},setTodaysDate:function(){var a=this;a.todaysDate=new Date().yyyymmdd();var b=a.todaysDate.split("-");a.todayDateYear=b[0];a.todayDateMonth=b[1].toString();if(a.todayDateMonth.toString().startsWith("0")){a.todayDateMonth=a.todayDateMonth.replace("0","")}a.todayDateDay=b[2];if(a.todayDateDay.startsWith("0")){a.todayDateDay=a.todayDateDay.replace("0","")}a.datePickerYear.value=a.todayDateYear;a.datePickerMonth.value=a.todayDateMonth;a.datePickerDay.value=a.todayDateDay;a.formatDate()},formatDate:function(a,d,b){var c=this;c.trimDayToMonth();if(b==c.todayDateYear){c.trimMonthToCurrent();if(d==c.todayDateYear){c.trimDayToCurrent()}}},trimMonthToCurrent:function(){var a=this},trimDayToMonth:function(d,b){var c=this;switch(d){case"4":case"6":case"9":case"11":c.trimDays(30);break;case"2":var a=28;if(parseInt(b)%4==0){a=29}c.trimDay(a);break;default:break}},trimDayToCurrent:function(){var a=this;a.trimDay(parseInt(a.todayDateDay))},trimDay:function(a){},changeEdition:function(){var a=this;var b="";if(version!=null){b="&version="+version}window.location.href="../get_edition_by_date.aspx?pubid="+publicationguid+"&year="+a.datePickerYear.options[a.datePickerYear.selectedIndex].value+"&month="+a.datePickerMonth.options[a.datePickerMonth.selectedIndex].value+"&day="+a.datePickerDay.options[a.datePickerDay.selectedIndex].value+b},setAmericanDate:function(b){var e=this;var d=b.split("/");var f=d[0];var a=d[1];var c=d[2];if(f.startsWith("0")){f=f.replace("0","")}if(a.startsWith("0")){a=a.replace("0","")}e.datePickerYear.value=c;e.populateMonthDropDown();e.datePickerMonth.value=f;e.populateDayDropDown();e.datePickerDay.value=a}},0,["archiveselector"],["component","container","panel","archiveselector"],{component:true,container:true,panel:true,archiveselector:true},["widget.archiveselector"],0,[InfinityMobile.view.desktop,"ArchiveSelector"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.readerTerms",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:700,style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;max-height:700px;",fullscreen:true,height:"100%",layout:{type:"vbox"},items:[{itemId:"topbar",height:40,items:[{itemId:"title",top:10,left:10},{itemId:"close",cls:"pointerCursor",top:8,right:8,html:"<img class='pointerCursor' src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"body",width:"100%",flex:1}]},initialize:function(){var c=this;c.topbar=c.getComponent("topbar");c.title=c.topbar.getComponent("title");c.close=c.topbar.getComponent("close");c.bodyContainer=c.getComponent("body");c.topbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});c.title.setHtml(language.menu.terms);console.log(c.close);c.close.element.on({tap:function(){c.destroy()}});if(settings.newsday!=null){c.element.dom.style.borderRadius="0px";if(currentProfile=="largetablet"||currentProfile=="tablet"){c.bodyContainer.setHeight("200px")}if(settings.newsday.whiteCloseIcon=="true"){var b=$(c.close.element.dom).find("img");if(b.length>0){b[0].src="resources/images/article-close-btn-white.png"}}}if(settings.menu.terms.url!=null){if(settings.menu.terms.url.length>0){if(currentProfile=="desktop"){c.bodyContainer.setHtml("<iframe scrolling=\"yes\" style='border:none;height:100%;width:100%;' src='"+settings.menu.terms.url+"' />")}else{c.bodyContainer.setHtml("<div class='iframeWrapper' style='position:absolute; width:100%; height:100%; overflow-y:scroll; -webkit-overflow-scrolling:touch;'><iframe scrolling=\"yes\" style='border:none;height:100%;width:100%;' src='"+settings.menu.terms.url+"' /></div>")}var a=$(c.bodyContainer.element.dom).find(".x-innerhtml")[0];if(a!=null){a.style.height="100%"}}}}},0,["readerTerms"],["component","container","readerTerms"],{component:true,container:true,readerTerms:true},["widget.readerTerms"],0,[InfinityMobile.view.desktop,"readerTerms"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderFree",Ext.Container,{config:{width:"100%",height:"100%",top:0,left:0,layout:"vbox",items:[{height:40},{itemId:"container",style:"background-color:rgba(200, 200, 200, 0.9); font-size:28px;",flex:1,layout:{type:"vbox",align:"center",pack:"middle"},items:[{itemId:"content",width:700,height:650,layout:{type:"vbox",align:"center"},defaults:{margin:"15px 0 15px 0"},items:[{height:100,width:"100%",style:'background-image:url("resources/images/branding/logo_black.png"); background-repeat:no-repeat; background-size:contain; background-position:center'},{itemId:"freeTrialText"},{itemId:"actionContainer",height:250,margin:"15px 0",layout:"hbox",items:[{itemId:"logInContainer",width:300,height:250,style:"background-color:white; text-align:center",padding:20,layout:"vbox",items:[{margin:"20px 0 0 0",style:"font-size:20px; font-weight:bold",html:"SUBSCRIBERS"},{margin:"20px 0 0 0",style:"font-size:20px;",html:"Enjoy Unlimited Access as part of your subscription"},{itemId:"logInButton",margin:"30px 0 0 0",width:"100%",height:50,style:"line-height:50px; color:white; font-size:20px; text-align:center; background-color: rgb(25, 153, 206);",html:"Log In Now"}]},{width:20},{itemId:"trialContainer",width:300,height:250,style:"background-color:white; text-align:center",padding:20,layout:"vbox",items:[{margin:"20px 0 0 0",style:"font-size:20px; font-weight:bold",html:"NEW USERS"},{itemId:"trialText",margin:"20px 0 0 0",style:"font-size:20px;",html:"Read 30 pages free each month"},{itemId:"trialButton",margin:"30px 0 0 0",width:"100%",height:50,style:"line-height:50px; color:white; font-size:20px; text-align:center; background-color: rgb(25, 153, 206);",html:"Start Your Trial"}]}]},{height:50},{itemId:"freeText",style:"text-align:center",html:"<span style='color:#1999ce;' id='subscribeEvent'>Subscribe</span> now for unlimited access<br />Already a subscriber? <span style='color:#1999ce;' id='loginEvent'>Log In</span>"}]}]}]},initializ},continueListener:function(){var a=this;if(a.trialButton!=null){a.trialButton.element.on("tap",function(){a.fireEvent("close",a)})}},subscribeListene},loginListener:function(){var a=this;if(a.loginButton!=null){a.loginButton.element.on("tap",function(){a.fireEvent("login",a)})}}},0,["readerfree"],["component","container","readerfree"],{component:true,container:true,readerfree:true},["widget.readerfree"],0,[InfinityMobile.view.desktop,"ReaderFree"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderPuzzlePopoverItem",InfinityMobile.view.desktop.ReaderArticlePopoverItem,{config:{mediaObject:"",pageNo:"",page:"",height:"100%",cls:"readerpuzzle",layout:"vbox",style:"overflow-y:auto;",items:[{itemId:"content",layout:"card",items:[{itemId:"contentHtml"}]},{itemId:"bottomBar",cls:"bottomBar",height:60,style:"font-size: 14px;min-height:60px;",layout:{type:"hbox",pack:"middle",align:"center"},items:[{itemId:"archive",cls:"pointerCursor",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/archive-ic.png' style='height:32px' />"},{width:5},{html:"Archive"}]},{width:10},{itemId:"print",cls:"pointerCursor",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/print-icon.png' style='height:32px' />"},{width:5},{html:"Print"}]},{width:10},{itemId:"share",cls:"pointerCursor",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{itemId:"shareText",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/share-ic.png' style='height:32px' />"},{width:5},{html:"Share"}]},{itemId:"shareFrame",hidden:true,layout:{type:"hbox",pack:"middle",align:"center"}}]},{itemId:"interactivemargin",width:10},{itemId:"interactive",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/interactive-ic.png' style='height:32px' />"},{width:5},{html:"Interactive Version"}]}]}]},initialize:function(){var a=this;InfinityMobile.view.desktop.ReaderArticlePopoverItem.prototype.initialize.apply(this,arguments);a.bottomBar=a.getComponent("bottomBar");a.archiveButton=a.bottomBar.getComponent("archive");a.printButton=a.bottomBar.getComponent("print");a.shareButton=a.bottomBar.getComponent("share");a.shareText=a.shareButton.getComponent("shareText");a.shareFrame=a.shareButton.getComponent("shareFrame");a.interactiveMargin=a.bottomBar.getComponent("interactivemargin");a.interactiveButton=a.bottomBar.getComponent("interactive");a.setArchiveListener();a.setPrintListener();a.setShareListener();a.setInteractiveListener();a.setUpShare();a.checkInteractive();a.checkBottomBar();a.setupScrolling();if(navigator.maxTouchPoints){a.content.setFlex(1)}if(typeof isTribReader!="undefined"){if(isTribReader){a.setPadding("0px 25px")}}a.on({painted:function(){}})},setupScrolling:function(){var b=this;if(Ext.browser.is.IE){var a=$(b.element.dom).find(".x-inner")[1];b.content.setHeight("100%");b.content.setWidth("100%");if(a!=null){$(a).addClass("ieScroll")}}else{if(Ext.browser.is.Firefox){var a=$(b.element.dom).find(".x-inner")[1];b.content.setHeight("100%");b.content.setWidth("100%");if(a!=null){$(a).css("overflow-y","auto")}}}},checkBottomBar:function(){var a=this;if(!(settings.articlepopover.puzzleBottomBar!=null&&settings.articlepopover.puzzleBottomBar=="true")){a.bottomBar.hide()}},setUpShare:function(){var f=this;var g="http://"+window.location.hostname+"/infinity/article_popover_share.aspx?guid="+f.articleguid;var a=g;try{g=InfinityMobile.app.application.getController("AppController").addPwaAppCodeQueryParamToUrl(g)}catch(c){g=a;console.warn("[ReaderPuzzlePopoverItem]: Error Caught\n",c)}finally{a=null}message=f.config.page.description;var b=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"http://html5.pagesuite.com/preview/assets/article%20view/email-ic.png",link:"mailto:?message={0}&subject={1}",url:g,message:message,height:30,width:30,type:"email"});f.shareFrame.add(b);var e=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"http://html5.pagesuite.com/preview/assets/article%20view/facebook-ic.png",link:"http://www.facebook.com/sharer/sharer.php?u={0}&title={1}",url:g,message:message,height:30,width:30});f.shareFrame.add(e);var d=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"http://html5.pagesuite.com/preview/assets/article%20view/twitter-ic.png",link:"http://twitter.com/intent/tweet?status={0} - {1}",url:g,message:message,height:30,width:30});f.shareFrame.add(d)},setArchiveListener:function(){var a=this;if(settings.articlepopover.puzzleArchive!=null&&settings.articlepopover.puzzleArchive=="true"){a.archiveButton.element.on("tap",function(){a.fireEvent("puzzleArchive",a)})}else{a.archiveButton.hide()}},setPrintListener:function(){var a=this;a.printButton.element.on("tap",function(){a.fireEvent("puzzlePrint",a)})},setShareListener:function(){var a=this;a.shareButton.element.on("tap",function(){a.fireEvent("puzzleShare",a)})},setInteractiveListener:function(){var a=this;a.interactiveButton.element.on("tap",function(){a.fireEvent("puzzleInteractive",a)})},checkInteractiv}},0,["readerpuzzlepopoveritem"],["component","container","readerarticlepopoveritem","readerpuzzlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true,readerpuzzlepopoveritem:true},["widget.readerpuzzlepopoveritem"],0,[InfinityMobile.view.desktop,"ReaderPuzzlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderPuzzleArchive",Ext.Container,{config:{layout:"vbox",height:"100%",cls:"puzzleArchive",items:[{itemId:"topbar",height:40,style:"color: #4591B8",layout:{type:"hbox",align:"center"},items:[{itemId:"back",cls:"pointerCursor",width:150,padding:"10 0 0 20",height:"100%",layout:"hbox",style:"font-size:18px",items:[{html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{html:"Back",padding:"0 0 0 5"}]},{itemId:"title",flex:1,style:"text-align:center; font-size:22px; font-weight:bold; color:black",html:"Archive"},{width:150}]},{itemId:"containerScroll",style:"overflow-y:scroll;",items:[{itemId:"container",style:"overflow-y:auto;",defaults:{cls:"puzzlearchiveitem"}}]},{itemId:"archiveControl",bottom:0,width:"100%",height:40,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"previous",style:"color:#4591B8",html:"Previous",cls:"pointerCursor",zIndex:6,flex:1,left:0,top:20},{itemId:"pages",style:"color:#4591B8;text-align:center;",top:20,width:"100%",layout:{type:"hbox",pack:"center",align:"middle"}},{itemId:"next",style:"color:#4591B8",html:"Next",flex:1,right:0,top:20,cls:"pointerCursor"}]}]},initialize:function(){var a=this;var b=a.getComponent("topbar");a.backButton=b.getComponent("back");a.archiveControl=a.getComponent("archiveControl");a.containerScroll=a.getComponent("containerScroll");a.container=a.getComponent("containerScroll").getComponent("container");a.setBackListener();a.config.puzzleArchiveParent.bottomBar.hide();a.setHeight($(a.config.puzzleArchiveParent.element.dom).height());a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height=$(a.config.puzzleArchiveParent.element.dom).height()+"px";a.containerScroll.setHeight($(a.element.dom).height()-80);a.resizeFunction=function(){a.setHeight($(a.config.puzzleArchiveParent.element.dom).height());a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height=$(a.config.puzzleArchiveParent.element.dom).height()+"px";a.containerScroll.setHeight($(a.element.dom).height()-80)};Ext.Viewport.on({resize:a.resizeFunction});a.location=0;a.pagesControl=a.archiveControl.getComponent("pages");a.previous=a.archiveControl.getComponent("previous");a.next=a.archiveControl.getComponent("next");a.next.element.on({tap:function(){a.fireEvent("archiveNextPage",a)}});a.previous.element.on({tap:function(){a.fireEvent("archivePreviousPage",a)}});a.fireEvent("initialized",a)},setBackListener:function(){var a=this;a.backButton.element.on("tap",function(){a.config.puzzleArchiveParent.bottomBar.show();a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height="";Ext.Viewport.removeListener("resize",a.resizeFunction);a.fireEvent("back",a)})}},0,["readerpuzzlearchive"],["component","container","readerpuzzlearchive"],{component:true,container:true,readerpuzzlearchive:true},["widget.readerpuzzlearchive"],0,[InfinityMobile.view.desktop,"ReaderPuzzleArchive"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ExtraTopBar",Ext.Container,{config:{height:40,width:"100%",padding:8,zIndex:2,cls:"extraTopBar",layout:{type:"hbox"},defaults:{margin:"0 10px 0 10px",style:"float:right; background-size: contain; background-repeat: no-repeat; background-position: center; cursor:pointer;",height:24},items:[{itemId:"tooltiptool",cls:"tooltiptoolbar",style:"z-index:10000",margin:0,height:""},{xtype:"layouttoolbaricon",setting:"menuicon",event:"openReaderMenu",itemId:"menuicon"},{itemId:"toolbarIcon",cls:"toolbarIcon",defaults:{width:"100%",height:"100%",left:0,top:0},items:[{cls:"toolbarIconLarge",itemId:"toolbarIconLarge",style:"background-position: left center; background-size: contain; background-repeat: no-repeat;"},{cls:"toolbarIconSmall",itemId:"toolbarIconSmall",style:"background-position: left center; background-size: contain; background-repeat: no-repeat;"}]}]},initializ},setupTooltip},tooltipRigh},setupIcons:function(){var a=this;a.menuIcon=a.getComponent("menuicon");if(settings.newsday!=null){if(settings.newsday.menuDirection!="left"){a.menuIcon.hide()}}else{if(settings.topbar.extraTopBarMenu!="true"){a.menuIcon.hide()}}a.setupLogo();if(settings.dateSelector!=null){a.archiveSelector=Ext.create("InfinityMobile.view.desktop.ArchiveSelector",{});a.add(a.archiveSelector);a.archiveSelector.setStyle({backgroundColor:""})}if(settings.newsday!=null){if(settings.newsday.weatherIcon!=null){if(settings.newsday.weatherIcon.length>0){a.weatherPlaceholder=Ext.create("Ext.Container",{right:18,height:40,width:60,style:'background-image:url("'+settings.newsday.weatherIcon+'");background-position:center;background-size:contain;background-repeat:no-repeat;'});a.add(a.weatherPlaceholder)}}}},setupLogo:function(){var b=this;b.topBarIconContainer=b.getComponent("toolbarIcon");b.topBarIconLarge=b.topBarIconContainer.getComponent("toolbarIconLarge");b.topBarIconSmall=b.topBarIconContainer.getComponent("toolbarIconSmall");if(settings.newsday!=null||settings.topbar.extraTopBarLogo=="true"){var a=settings.topbar;b.topBarIconLarge.setStyle({backgroundImage:"url("+a.logo+")"});if(a.smallLogo!=null){var c=a.smallLogo;b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconSmall.setStyle({backgroundImage:"url("+c+")"})}else{b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconSmall.setStyle({backgroundImage:"url("+a.logo+")"})}b.topBarIconContainer.element.on("tap})}else{b.topBarIconContainer.hide()}},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}},0,["extratopbar"],["component","container","extratopbar"],{component:true,container:true,extratopbar:true},["widget.extratopbar"],0,[InfinityMobile.view.desktop,"ExtraTopBar"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderOGallery",Ext.Container,{config:{modal:true,fullscreen:true,centered:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:99999999,layout:"vbox",items:[{itemId:"topPanel",layout:"hbox",flex:5,items:[{itemId:"image",flex:3,layout:"hbox",height:"100%",items:[{itemId:"previous",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"},{itemId:"imageCarousel",height:"100%",flex:1,style:"background-color:rgb(75,75,75)"},{itemId:"next",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"}]},{itemId:"galleryContent",flex:1,layout:"vbox",items:[{itemId:"closeBtnRow",width:"100%",height:50,items:[{itemId:"closeBtn",cls:"pointerCursor",right:0,top:0,margin:10,height:25,width:25,style:{backgroundImage:"url('resources/images/article-close-btn-white.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}]},{itemId:"galleryCounter",height:60,margin:"10 0",width:"100%",layout:"hbox",style:{color:"white",fontSize:"20px",fontWeight:"bold"},items:[{itemId:"cameraIcon",height:30,width:30,margin:10,style:{backgroundImage:"url('resources/images/reader icons/photo-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},{itemId:"counter",height:50,layout:{type:"vbox",pack:"center"},items:[{itemId:"text"}]}]},{itemId:"galleryInfo",cls:"galleryInfo",width:"100%",layout:"vbox",padding:10,style:{color:"white",overflowY:"auto"},items:[{itemId:"title",width:"100%",style:{fontSize:"40px",fontWeight:"bold"},margin:"10 0"},{itemId:"caption",flex:1,width:"100%",style:{fontSize:"14px"},margin:"10 0"}]}]}]},{itemId:"imageScroller",flex:1,width:"100%",layout:"hbox",padding:10,scrollable:{direction:"horizontal"}}]},initialize:function(){var a=this;if(a.config.article!=null){a.article=a.config.article}if(a.config.images!=null){a.images=a.config.images}if(a.config.url!=null){a.url=a.config.url}a.topPanel=a.getComponent("topPanel");a.image=a.topPanel.getComponent("image");a.previousBtn=a.image.getComponent("previous");a.previousBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-back-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.nextBtn=a.image.getComponent("next");a.nextBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-next-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.previousBtn.element.on({tap:a.previous,scope:a});a.nextBtn.element.on({tap:a.next,scope:a});a.galleryContent=a.topPanel.getComponent("galleryContent");a.galleryCounterPanel=a.galleryContent.getComponent("galleryCounter");a.counter=a.galleryCounterPanel.getComponent("counter");a.counterText=a.counter.getComponent("text");a.closeBtnRow=a.galleryContent.getComponent("closeBtnRow");a.closeBtn=a.closeBtnRow.getComponent("closeBtn");a.keyFunc=window.onkeyup;window.onkeyup=null;a.closeBtn.element.on({ta},scope:a});a.imageScroller=a.getComponent("imageScroller");a.galleryInfo=a.galleryContent.getComponent("galleryInfo");if(navigator.appVersion.indexOf("Edge")!=-1){a.galleryInfo.setStyle({overflowY:"scroll"})}a.title=a.galleryInfo.getComponent("title");if(Ext.browser.is.IE){a.title.setStyle({flexShrink:0})}a.caption=a.galleryInfo.getComponent("caption");if(Ext.browser.is.Chrome){Ext.Viewport.on({resize:a.resizeGalleryChrome,scope:a})}else{Ext.Viewport.on({resize:a.resizeGallery,scope:a})}a.imageCarousel=a.image.getComponent("imageCarousel");a.on({painted:function(){if(a.url!=null){if(a.useSettingDrivenUrl()){var b=a.url.replace("ace-stage.newsday.com/","").replace("http://","");b="../../Newsday/getAtex.aspx?url="+a.returnFormattedUrl(settings.newsday.atexMediaUrl)+b+"?device=ipad-4&_dc=1445010088130&limit=25"}else{if(a.url.indexOf("http://")!=-1){var b=a.url.substring(7,a.url.length)}else{b=a.url}b="../../Newsday/getatex.aspx?url=http://www.newsday.com/iosfeeds/"+b+"?device=desktop&_dc=1445010088130&limit=25"}$.ajax({type:"GET",url:b,data:{get_param:"value"},dataType:"json",success:function(d){a.dataName=!!d.content.name?d.content.name:d.content.title;a.title.setHtml(d.content.name);a.images=[];for(var c in d.content.images){a.images[c]={url:d.content.images[c].image_path,caption:d.content.images[c].caption,index:c,image_title:d.content.images[c].image_title}}a.setupCarousel();a.setupThumbnails();if(a.images[0].caption.trim().length>0){var f="";if(a.images[0].credit!=null){if(a.images[0].credit.trim().length>0){f=" ("+a.images[0].credit+")"}}a.caption.setHtml(a.images[0].caption+f)}a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10);a.handleItemChange(a.carousel);a.data=d;if(d.content.pagedata!=null&&d.omniture==null){a.data.omniture=d.omniture=d.content.pagedata;if(d.content.pagedata.pagename!=null){d.omniture.pageName=d.content.pagedata.pagename}a.data.omniture.hierarchy=d.omniture.hierarchy=d.content.pagedata.hier}var e="1 of "+a.images.length;a.fireEvent("ogalleryinitialized",a,d,e)}})}else{a.title.setHtml(a.article.headline);a.setupCarousel();a.setupThumbnails();a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10);a.handleItemChange(a.carousel)}},scope:a})},returnFormattedUrl:function(a){return !!a&&a[a.length-1]!="/"?(location.protocol+"//"+a+"/"):(location.protocol+"//"+a)},useSettingDrivenUrl:function(){return typeof settings!="undefined"&&settings.newsday!=null&&!!settings.newsday.atexMediaUrl},setupThumbnails:function(){var d=this;for(var a in d.images){var f=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:d.images[a].url,carousel:d.carousel,index:a,style:{transition:"all ease 0.5s"}});if(a==0){f.element.dom.style.border="2px solid white"}d.imageScroller.add(f)}if(Ext.browser.is.Firefox){var c=d.imageScroller.getScrollable().getElement();var e=c.dom.scrollWidth;var b=c.dom.clientWidth;d.imageScroller.getScrollable().getScroller().maxPosition.x=e-b}},setupGalleryInfo:function(){},handleItemChange:function(g){var d=this;var a=(g._pageNumber);if(d.images!=null){d.counter.setHtml((parseFloat(a)+1)+" of "+d.images.length);d.caption.setHtml("");if(d.article!=null){if(d.article.images[a].caption!=null){if(d.article.images[a].caption.trim().length>0){var h="";if(d.article.images[a].credit!=null){if(d.article.images[a].credit.trim().length>0){h=" ("+d.article.images[a].credit+")"}}d.caption.setHtml(d.article.images[a].caption+h)}else{if(d.article.shortStory!=null){d.caption.setHtml(d.article.shortStory)}}}else{if(d.article.shortStory!=null){d.caption.setHtml(d.article.shortStory)}}d.setSelectedImage(a)}else{if(d.images[a].caption!=null){if(d.images[a].caption.trim().length>0){d.caption.setHtml(d.images[a].caption)}else{d.caption.setHtml("")}}if(d.images[a].image_title!=null&&d.images[a].image_title!=""){d.title.setHtml(d.images[a].image_title)}else{d.title.setHtml(d.dataName)}d.setSelectedImage(a)}}var f=(parseFloat(a)+1)+" of "+d.images.length;if(d.url!=null){if(d.data!=null){d.fireEvent("ogalleryinitialized",d,d.data,f)}}else{var c=d.article.byline;if(d.article.reporters!=null&&d.article.reporters.length>0){for(var b in d.article.reporters){c+=", "+d.article.reporters[b].name}}var e={author:c,contentTitle:d.article.headline,contentType:"photolist"};d.fireEvent("ogalleryinitializedArticle",d,e,f)}},setSelectedImag},next:function(){var a=this;a.carousel.next()},previous:function(){var a=this;a.carousel.previous()},resizeGalleryChrom},resizeGaller},setupCarouse}},0,["readerogallery"],["component","container","readerogallery"],{component:true,container:true,readerogallery:true},["widget.readerogallery"],0,[InfinityMobile.view.desktop,"ReaderOGallery"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.LightboxLink",Ext.Container,{config:{style:"padding:0px; border-radius:0px; background-color:white;",cls:"innerhtmlfullheight",modal:true,centered:true,hideOnMaskTap:true,height:1000,width:1000,maxHeight:"80%",maxWidth:"80%",layout:"vbox",zIndex:20,items:[{itemId:"topBar",height:40,layout:"hbox",items:[{itemId:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{flex:1,itemId:"content"}]},initializ},setCloseButtonListenter:function(){var a=this;a.closeButton.element.on("tap",function(){a.hide()})},loadMediaObjec}},0,["lightboxlink"],["component","container","lightboxlink"],{component:true,container:true,lightboxlink:true},["widget.lightboxlink"],0,[InfinityMobile.view.desktop,"LightboxLink"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderSpecialArchive",InfinityMobile.view.Overlay,{config:{id:"archivecontainer",width:700,height:"100%",style:"padding:0px;max-height:700px;",items:[{id:"archiveToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{id:"archiveToolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"archiveBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"archiveContainerText",margin:"0 0 20px 0"},{layout:"hbox",itemId:"archiveItemsGlobalContainer",items:[{id:"archiveItemsContainer",flex:1,defaults:{width:145,margin:"0 8 16 7",cls:"archiveitemphone pointerCursor"}}]}]}]},initialize:function(){var e=this;var a=e.getComponent("archiveToolBar");e.archiveToolBarClose=a.getComponent("archiveToolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});e.title=a.getComponent("title");var b=e.config.titleText==null?settings.newsday.specialArchive.name:e.config.titleText;e.title.setHtml(b);var c=e.getComponent("archiveBodyContainer");var f=c.getComponent("archiveItemsGlobalContainer");e.archiveContainerText=c.getComponent("archiveContainerText");var d=e.config.desc==null?settings.newsday.specialArchive.specialArchiveContainerText:e.config.desc;e.archiveContainerText.setHtml(d);e.archiveItemsContainer=f.getComponent("archiveItemsContainer");e.archiveItemsContainer.element.down(".x-inner").dom.style.width="100%";e.archiveItemsContainer.element.down(".x-inner").dom.style.display="inline";if(navigator.maxTouchPoints){e.archiveItemsContainer.setScrollable({direction:"vertical",directionLock:true})}else{e.archiveItemsContainer.element.dom.style.overflowY="scroll"}e.resizeFunc=function(){if($(e.element.dom).height>=700){f.element.dom.style.height="560px";e.archiveItemsContainer.element.dom.style.height="560px"}else{if(e.showTabSelector){if(e!=null&&e.element!=null){if(settings.menu.archiveUsesTabs!=null){if(settings.menu.archiveMonthDirection!=null){if(settings.menu.archiveMonthDirection=="Vertical"){f.element.dom.style.height=($(e.element.dom).height()-120)+"px";e.archiveItemsContainer.element.dom.style.height=($(e.element.dom).height()-120)+"px"}else{f.element.dom.style.height=($(e.element.dom).height()-120)+"px";e.archiveItemsContainer.element.dom.style.height=($(e.element.dom).height()-120)+"px"}}else{f.element.dom.style.height=($(e.element.dom).height()-120)+"px";e.archiveItemsContainer.element.dom.style.height=($(e.element.dom).height()-120)+"px"}}else{f.element.dom.style.height=($(e.element.dom).height()-120)+"px";e.archiveItemsContainer.element.dom.style.height=($(e.element.dom).height()-120)+"px"}}}else{if(e!=null&&e.element!=null){if(settings.menu.archiveUsesTabs!=null){if(settings.menu.archiveMonthDirection!=null){if(settings.menu.archiveMonthDirection=="Vertical"){f.element.dom.style.height=($(e.element.dom).height()-$(e.archiveContainerText.element.dom).height()-80)+"px";e.archiveItemsContainer.element.dom.style.height=($(e.element.dom).height()-$(e.archiveContainerText.element.dom).height()-80)+"px"}else{f.element.dom.style.height=($(e.element.dom).height()-$(e.archiveContainerText.element.dom).height()-80)+"px";e.archiveItemsContainer.element.dom.style.height=($(e.element.dom).height()-$(e.archiveContainerText.element.dom).height()-80)+"px"}}else{f.element.dom.style.height=($(e.element.dom).height()-$(e.archiveContainerText.element.dom).height()-80)+"px";e.archiveItemsContainer.element.dom.style.height=($(e.element.dom).height()-$(e.archiveContainerText.element.dom).height()-80)+"px"}}else{f.element.dom.style.height=($(e.element.dom).height()-80)-$(e.archiveContainerText.element.dom).height()+"px";e.archiveItemsContainer.element.dom.style.height=($(e.element.dom).height()-80)-$(e.archiveContainerText.element.dom).height()+"px"}}}}};e.setupTabSelector();e.on({painted:e.resizeFunc});Ext.Viewport.on({resize:e.resizeFunc});e.handleKeyDown();e.setCloseListener();if(e.config.editions==null){e.fireEvent("initialized",e)}else{e.fireEvent("initializeExtraArchive",e,e.config.editions)}},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},setCloseListene},setupTabSelector:function(){var b=this;b.showTabSelector=false;if(settings.newsday!=null&&settings.newsday.specialArchive!=null){b.showTabSelector=true}else{if(settings.menu!=null&&settings.menu.extraArchives!=null){b.showTabSelector=true}}if(b.showTabSelector){b.archiveContainerText.hide();var c=b.config.editions==null?settings.newsday.specialArchive.name:b.config.titleText;var a=Ext.create("InfinityMobile.view.ArchiveTabSelector",{startName:c});b.insert(1,a)}},close:function(){var a=this;a.fireEvent("close",a)},hid}},0,["readerspecialarchive"],["component","container","panel","overlay","readerspecialarchive"],{component:true,container:true,panel:true,overlay:true,readerspecialarchive:true},["widget.readerspecialarchive"],0,[InfinityMobile.view.desktop,"ReaderSpecialArchive"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SectionScroller",Ext.Container,{config:{width:"100%",height:40,cls:"section-scroller",top:40,layout:"hbox",style:"background-color:rgba(0,0,0,0.8);border-bottom:1px solid gray;overflow:hidden;",zIndex:1,items:[{itemId:"previousBtn",height:40,width:40,style:'border-right:1px solid gray;background-size:60% 50%;background-repeat:no-repeat;background-position:center;background-image:url("../assets/reader icons/back.png");',cls:"pointerCursor"},{itemId:"sectionArea",height:40,layout:"hbox",style:"overflow:hidden;",flex:1,scrollable:{direction:"horizontal",directionLock:true}},{itemId:"nextBtn",height:40,width:40,style:'border-left:1px solid gray;background-size:60% 50%;background-repeat:no-repeat;background-position:center;background-image:url("../assets/reader icons/next.png");',cls:"pointerCursor"}]},initializ},setupVars:function(){var a=this;a.previousBtn=a.getComponent("previousBtn");a.nextBtn=a.getComponent("nextBtn");a.sectionArea=a.getComponent("sectionArea");a.backgroundColour="rgba("+hexToRgb("1e1e1e")+", 0.9)";if(settings.menu.sectionList!=null&&settings.menu.sectionList.backgroundColour!=null){a.backgroundColour="rgba("+hexToRgb(settings.menu.sectionList.backgroundColour)+", 0.9)"}},loadSections:function(){var d=this;var e=settings.bookmarks.bookmark;for(var b in e){var a=e[b];var c=Ext.create("InfinityMobile.view.SectionScrollerItem",{section:a});d.sectionArea.add(c)}},setupStylin},setListener},previousSection:function(){var c=this;var d=c.sectionArea.getItems().items;var a=c.getSelectedSectionIndex(d);var b=d[parseInt(a)-1];if(b!=null){c.changeSection(b)}},nextSection:function(){var c=this;var d=c.sectionArea.getItems().items;var b=c.getSelectedSectionIndex(d);var a=d[parseInt(b)+1];if(a!=null){c.changeSection(a)}},getSelectedSectionIndex:function(d){var c=this;for(var b in d){var a=d[b];if(a.selected){return b}}return -1},changeSection:function(a){var b=this;a.onTap()},scrollIntoCentre:function(e){var b=this;var a=b.sectionArea.getScrollable().getScroller();var c=b.sectionArea.element.dom.clientWidth;var d=e.element.dom.offsetLeft;if(d<c/2){a.scrollTo(0)}else{if(d+(e.element.dom.clientWidth/2)>a.maxPosition.x+(c/2)){a.scrollTo(a.maxPosition.x)}else{a.scrollTo(d-(c/2)+(e.element.dom.clientWidth/2))}}}},0,["sectionscroller"],["component","container","sectionscroller"],{component:true,container:true,sectionscroller:true},["widget.sectionscroller"],0,[InfinityMobile.view.desktop,"SectionScroller"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderPrint",InfinityMobile.view.ReaderPrint,{config:{width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{id:"toolbar",xtype:"readeroverlaytitle",titleTxt:"Print",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"body",cls:"overlaybody",flex:1,padding:25,layout:"vbox",items:[{itemId:"desc"},{itemId:"buttonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"selectAll",xtype:"readeroverlaybutton",txt:"Select All"},{itemId:"selectAllMargin",width:25},{itemId:"selectNone",xtype:"readeroverlaybutton",txt:"Select None"},{itemId:"selectNoneMargin",width:25},{itemId:"print",xtype:"readeroverlaybutton",txt:"Print"}]},{itemId:"printItems",flex:1,xtype:"readeritemscontainer",defaults:{width:145,margin:"0 6 10 6"}}]}]},initialize:function(){var a=this;a.setSquareCorners();InfinityMobile.view.ReaderPrint.prototype.initialize.apply(this,arguments)}},0,["printmenu"],["component","container","panel","overlay","printmenuparent","printmenu"],{component:true,container:true,panel:true,overlay:true,printmenuparent:true,printmenu:true},["widget.printmenu"],0,[InfinityMobile.view.desktop,"ReaderPrint"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderSearch",InfinityMobile.view.ReaderSearch,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;",zindex:3,layout:"vbox",searchTerm:"",cls:"searchOverlay",items:[{id:"seachToolBar",xtype:"readeroverlaytitle",titleTxt:"Search",parentOverlay:this,destoryOnClose:false,rounded:true},{itemId:"searchBar",height:50,padding:5,cls:"searchBar",items:[{id:"searchTerm",height:30,style:"color:red; font-size:12px;",width:"100%",html:"<input class='search-field' type='text' placeholder='' style='width:100%; height:35px; padding-left:10px;' />"},{id:"searchButton",cls:"searchicon pointerCursor",html:"<img src='../assets/search/grey-search-ic.png' style='width:20px; height:20px' />",right:10,top:15}]},{itemId:"searchTypeContainer",cls:"search-type-container",width:"100%",height:40,padding:5,layout:{type:"hbox",align:"center",pack:"middle"},defaults:{labelAlign:"right",labelWidth:"",labelWrap:true,style:"background-color:transparent; display:block; font-size:14px;font-weight:normal;transform:translateX(-20px);"},items:[{xtype:"radiofield",name:"search-type",itemId:"new-search",label:"New Search",checked:true},{xtype:"radiofield",name:"search-type",itemId:"search-results",label:"Search Within Results",disabled:true,checked:false}]},{itemId:"searchButtonsContainer",cls:"searchButtonsBar",items:[{itemId:"topButtonContainer",width:"100%",height:"100%",layout:{type:"hbox",pack:"center",align:"middle"},height:60,style:"z-index:1",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"searchCurrentEdition",cls:"pointerCursor btn",xtype:"readeroverlaybutton",txt:"Current Edition"},{width:25},{itemId:"searchAllEditions",cls:"pointerCursor btn",xtype:"readeroverlaybutton",txt:"All Editions"},{width:25},{itemId:"showSearchDate",cls:"pointerCursor btn date-button-desktop",width:150,style:"background-color:#458fbb;color:#ffffff",items:[{itemId:"btn",xtype:"readeroverlaybutton",txt:"Date"},{itemId:"searchDateContainer",top:45,cls:"searchDate hidden",layout:"vbox",padding:10,items:[{itemId:"startDateText"},{itemId:"startDate",html:"<input type='date' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"endDateText"},{itemId:"endDate",html:"<input type='date' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"searchDate",cls:"pointerCursor btn",xtype:"readeroverlaybutton",txt:"Search"}]}]}]},{itemId:"bottomButtonContainer",height:"100%",margin:"0 20",hidden:true,layout:{type:"hbox",pack:"center",align:"middle"},height:60,style:"z-index:1",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"searchPreviousResults",cls:"pointerCursor btn",style:"min-width:500px",xtype:"readeroverlaybutton",txt:"Search Within Results"}]}]},{itemId:"searchResults",layout:"vbox",cls:"searchResults",xtype:"readeritemscontainer",flex:1},{itemId:"pageNav",layout:{type:"hbox",align:"middle",pack:"center"},height:50,width:"100%",style:"border-top: 1px solid #e1e1e1;",hidden:true,items:[{itemId:"previous",height:"100%",width:50,style:'background-image:url("../assets/article%20view/left-article-arrow.png");background-size: 50%; background-position:center;background-repeat: no-repeat;border-right: 1px solid #e1e1e1;cursor: pointer;'},{itemId:"pageNavContainer",flex:1,height:"100%",layout:{type:"hbox",align:"middle",pack:"center"},scrollable:{direction:"horizontal"}},{itemId:"next",height:"100%",width:50,style:'background-image:url("../assets/article%20view/right-article-arrow.png");background-size: 50%; background-position:center;background-repeat: no-repeat;border-left: 1px solid #e1e1e1; cursor: pointer;'}]}]}},0,["search"],["component","container","panel","overlay","searchparent","search"],{component:true,container:true,panel:true,overlay:true,searchparent:true,search:true},["widget.search"],0,[InfinityMobile.view.desktop,"ReaderSearch"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderWebpopover",InfinityMobile.view.ReaderWebpopover,{cls:"popover-parent",config:{layout:"vbox",items:[{id:"toolbar",xtype:"readeroverlaytitle",titleTxt:"",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"body",cls:"overlaybody",flex:1,width:"100%",layout:"vbox",style:"overflow:hidden;position:relative;",items:[{itemId:"webpopoverIframe",layout:"fit",xtype:"panel",padding:0,top:0,right:0,left:0,bottom:0,html:"<div class='iframe-container' style='overflow:hidden;'><iframe class='popoverIframe'style='height:100%;width:100%;border:none;' src=''><p>This browser doesn't support iframes</p></iframe></div>"}]}]},initializ}},0,["webpopover"],["component","container","panel","overlay","webpopoverparent","webpopover"],{component:true,container:true,panel:true,overlay:true,webpopoverparent:true,webpopover:true},["widget.webpopover"],0,[InfinityMobile.view.desktop,"ReaderWebpopover"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SupplementsOverlay",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;min-height:412px;",layout:"vbox",items:[{itemId:"toolBar",xtype:"readeroverlaytitle",titleTxt:"Supplements",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"bodyContainer",cls:"overlaybody",padding:"20",layout:"vbox",flex:1,items:[{itemId:"itemsContainer",flex:1,xtype:"readeritemscontainer",defaults:{width:145,height:170,margin:"0 8 16 7"}}]}]},initialize:function(){var a=this;InfinityMobile.view.Overlay.prototype.initialize.apply(this,arguments);console.log(this);a.setupVars();a.setupLanguage();a.fireEvent("initialized",a,a.itemsContainer)},setupVars:function(){var b=this;b.toolBar=b.getComponent("toolBar");if(b.toolBar!=null){b.toolBarClose=b.toolBar.getComponent("toolBarClose")}b.bodyContainer=b.getComponent("bodyContainer");if(b.bodyContainer!=null){b.itemsContainer=b.bodyContainer.getComponent("itemsContainer")}b.titleTxt="Supplements";if(typeof language!="undefined"&&language.menu!=null){var a=language.menu;if(a.supplements!=null){b.titleTxt=a.supplements}}},setupLanguage:function(){var a=this;var b=a.titleTxt;if(a.isUpper(b)){b=(b[0].toUpperCase()+b.substring(1,b.length).toLowerCase())}if(a.toolBar!=null&&a.toolBar.setText!=null){a.toolBar.setText(b)}},isUppe}},0,["supplementsoverlay"],["component","container","panel","overlay","supplementsoverlay"],{component:true,container:true,panel:true,overlay:true,supplementsoverlay:true},["widget.supplementsoverlay"],0,[InfinityMobile.view.desktop,"SupplementsOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderPuzzlesPopup",InfinityMobile.view.ReaderPuzzlesPopup,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:800px;",zIndex:1000002,layout:"vbox",items:[{id:"puzzlesPopupToolbar",xtype:"readeroverlaytitle",titleTxt:"Puzzles",parentOverlay:this,destoryOnClose:true,rounded:true},{itemId:"puzzlesPopupBody",cls:"overlaybody",flex:1,padding:0,layout:"vbox"}]},initialize:function(){var a=this;a.setSquareCorners();InfinityMobile.view.ReaderPuzzlesPopup.prototype.initialize.apply(this,arguments)}},0,["puzzlespopup"],["component","container","panel","overlay","puzzlespopupparent","puzzlespopup"],{component:true,container:true,panel:true,overlay:true,puzzlespopupparent:true,puzzlespopup:true},["widget.puzzlespopup"],0,[InfinityMobile.view.desktop,"ReaderPuzzlesPopup"],0));(Ext.cmd.derive("InfinityMobile.profile.desktop",Ext.app.Profile,{config:{name:"desktop",views:["ReaderSpecialSupplements","ArticleReaderMenu","ArticleReaderItemInterstitialContainer","ArticleReaderItemInterstitial","ArticleReaderItemWeatherTile","ArticleReaderItemTopStoryItem","ArticleReaderItemTopStories","ArticlePopoverItemDynamic","ArticleReaderItemMedWideTall","ArticleReaderItemMedTall","ArticleReaderItemMedWide","ArticleReaderBannerAd","ArticleReaderItemContainer","ArticleReaderItemSmall","ArticleReaderItemLrg","ReaderArticlePopover","ArticlePopoverInterstitial","ReaderArticlePopoverItem","DesktopPageViewer","LayoutToolBarView","LayoutToolBarIconView","LayoutToolBarToggleIconView","ReaderToolbarShareMenu","HowToEditionOptions","HowToMoreEditionOptions","HowToPageControl","HowToViewOptions","HowToReader","DynamicArticlesInterstitialContainer","DynamicArticlesInterstitial","HowToMenuIcon","HowToArticlesContainer","SmallViewTileWide","SmallViewTileSmall","SmallViewTileMed","SmallViewTileWeather","SmallViewTileWeatherContainer","SectionListOverlay","SectionListOverlayItem","ZonesOverlay","ZonesOverlayItem","ReaderArchive","ReaderDownload","ReaderBookmark","PrintMenu","ClippingOptionsMenu","ArticleReaderFullscreenGalleryIcon","ArticleReaderTextSizeIcon","ImageGallery","ArchiveSelector","readerTerms","ReaderFree","ReaderPuzzlePopoverItem","ReaderPuzzleArchive","ExtraTopBar","ReaderOGallery","LightboxLink","ReaderSpecialArchive","SectionScroller","ReaderPrint","ReaderSearch","ReaderWebpopover","SupplementsOverlay","ReaderPuzzlesPopup"]},viewport:{autoMaximize:true},isActive:function(){return Ext.os.is.Desktop},launch:function(){}},0,0,0,0,0,0,[InfinityMobile.profile,"desktop"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSpecialSupplementsItem",Ext.Container,{config:{style:"float:left;border:1px solid grey",cls:"pointerCursor",editionGuid:"",editionName:"",items:[{itemId:"archiveItemLabel",bottom:0,width:"100%",padding:"5 0 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initialize:function(){var a=this;a.publicationGuid=a.config.publicationGuid;a.publicationName=a.config.publicationName;a.editionGuid=a.config.editionGuid;a.editionLabel=a.getComponent("archiveItemLabel");var b=location.protocol+"//"+location.host;if(location.hostname=="localhost"){b=location.protocol+"//edition.pagesuite.com"}if(a.editionGuid==null||a.editionGuid.length==0){var c=b+"/get_image.aspx?w=280&pbid="+a.publicationGuid}else{var c=b+"/get_image.aspx?w=280&eid="+a.editionGuid}a.setHtml("<img style='width:100%' src='"+c+"' />");a.editionLabel.setHtml(a.publicationName);if(a.config.type==null){a.element.on({tap:"onTap",scope:a})}else{if(a.config.type=="zones"){a.element.on({ta}})}}},onTap:function(){var b=this;if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){window.parent.postMessage({type:"openEdition",editionguid:b.editionGuid},"*")}}else{var a=location.protocol+"//"+location.host+"/launch.aspx?pbid="+b.publicationGuid+"&eid="+b.editionGuid;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.supplements!=null&&settings.menu.supplements.openSupplementInNewTab=="true"){window.open(a)}else{window.location.href=a}}}},0,["specialsupplementsitem"],["component","container","specialsupplementsitem"],{component:true,container:true,specialsupplementsitem:true},["widget.specialsupplementsitem"],0,[InfinityMobile.view,"ReaderSpecialSupplementsItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPopoverMenuShare",Ext.Container,{config:{width:120,height:40,layout:"hbox",items:[{layout:"hbox",itemId:"sharebtns",width:"100%",flex:1}]},initialize:function(){var a=this;if(a.config.url!=null){a.url=a.config.url}if(a.config.icon!=null){a.icon=a.config.icon}if(a.config.articleguid!=null){a.articleguid=a.config.articleguid}a.shareBtnsContainer=a.getComponent("sharebtns");a.loadShareButtons()},setCloseButtonListener:function(){var b=this;b.toolbarClose.element.on("tap",function(){b.destroy()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolbarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},loadShareButtons:function(){var a=this;a.fireEvent("loadShareIconsMenu",a)},setButtons:function(){var c=this;if($(document).height()>$(document).width()){var a="phoneShareBtn";var b="margin-top:10%";c.getComponent("sharebtns").setScrollable("vertical")}else{var a="phoneShareBtnLand";var b="margin-left:5%;margin-top:2.5%;";c.getComponent("sharebtns").setScrollable("horizontal")}c.getComponent("sharebtns").setHtml("<div class='"+a+"' onclick='parent.socialShare(\"facebook\")' style='"+b+";background-image:url(../../readerassets/social/facebook-icon.png);background-color:#3b5998;'></div><div class='"+a+"' onclick='parent.socialShare(\"twitter\")' style='background-image:url(../../readerassets/social/twitter-icon.png);background-color:#00aced;'></div><div class='"+a+"' onclick='parent.socialShare(\"google\")' style='background-image:url(../../readerassets/social/googleplus-icon.png);background-color:#dd4b39;'></div><div class='"+a+"' onclick='parent.socialShare(\"pinterest\")' style='background-image:url(../../readerassets/social/pinterest-icon.png);background-color:#cb2027;'></div><div class='"+a+"' onclick='parent.socialShare(\"linkedin\")' style='background-image:url(../../readerassets/social/linkedin-icon.png);background-color:#007bb5;'></div><div class='"+a+"' onclick='parent.socialShare(\"email\")' style='background-image:url(../../readerassets/social/email-ic-white.png);background-color:#929292;'></div>");c.getComponent("titleBar").getComponent("ToolBarClose").element.on("tap",function(){c.destroy()});socialShare=function(e){var d=article._page.description.replace(/&apos;/g,"'");switch(e){case"facebook":var f=window.open("http://www.facebook.com/sharer/sharer.php?m2w&u="+encodeURIComponent(window.location)+"&title="+d,"_blank");break;case"twitter":window.open("http://twitter.com/intent/tweet?text="+encodeURIComponent(d+" - "+window.location));break;case"google":window.open("https://plus.google.com/share?url="+window.location);break;case"pinterest":window.open("http://pinterest.com/pin/create/bookmarklet/?media=http://edition.pagesuite-professional.co.uk/get_image.aspx?w=300&"+c.getURLmedia()+"&url="+window.location+"&is_video=false&description="+d);break;case"linkedin":window.open("http://www.linkedin.com/shareArticle?mini=true&url="+window.location+"&title="+d);break;case"email":var g="mailto:?body="+d+" - "+window.location;window.location.href=g;break}}},getURLmedi},handleChange:function(){var a=this;a.setButtons()}},0,["sharepopupmenu"],["component","container","sharepopupmenu"],{component:true,container:true,sharepopupmenu:true},["widget.sharepopupmenu"],0,[InfinityMobile.view,"ReaderPopoverMenuShare"],0));(Ext.cmd.derive("InfinityMobile.view.DownloadPrompt",Ext.Container,{config:{modal:{zIndex:999999998},centered:true,width:300,style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true,zIndex:999999999},initialize:function(){var a=this;if(a.config.message!=null){var b=a.config.message}if(a.config.url!=null){a.url=a.config.url}a.setHtml("<div style='text-align:center;padding:10px;'><p style=''>"+b+'</p></div><div style=\'text-align:center;\'><input type="button" class="btn pointerCursor" onclick="parent.ok()" ontouchend="parent.ok()" style="-webkit-appearance:none;margin: 5px;border-style:solid;font-size:12px;height:30px;margin-color:#'+settings.reader.buttonColour+";background-color:#"+settings.reader.buttonColour+";border-color:#"+settings.reader.buttonColour+";width:120px;color:#"+settings.reader.buttonTextColour+';border-radius:0px;" type="button" value="'+language.ok+'" /></div>');ok=function(){window.open(a.url);setTimeout(function(){a.destroy()},100)};if(settings.newsday!=null){a.element.dom.style.borderRadius=""}}},0,["clippingmenuprompt"],["component","container","clippingmenuprompt"],{component:true,container:true,clippingmenuprompt:true},["widget.clippingmenuprompt"],0,[InfinityMobile.view,"DownloadPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.StoryWindowPreferences",Ext.Container,{config:{id:"archivecontainer",modal:true,fullscreen:true,centered:true,width:700,style:"padding:0px;max-height:700px;",items:[{id:"toolbar",height:40,items:[{itemId:"title",top:10,left:10},{id:"toolbarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",layout:"vbox",flex:1,style:"background-color:white;",items:[{itemId:"containerText",margin:20,html:"If you turn this setting off, you will always return to the last page of the paper you viewed."},{itemId:"toggleSetting",padding:"20 20",margin:"0 0 40 0",style:"background-color:#eeeeee;",html:"Return to page featuring last story viewed: <input class='pointerCursor' type='checkbox' style='margin-left:5px;top:2px;float:right;width:15px;height:15px;' class=\"pointerCursor\" onclick='if(this.checked){ this.checked = false; } else{ this.checked = true }' ></input>"}]}]},initializ},setCloseListene},close:function(){var a=this;a.destroy()},setToggleListene},toggleChec},checkCurrentSettin}},0,["storywindowpreferences"],["component","container","storywindowpreferences"],{component:true,container:true,storywindowpreferences:true},["widget.storywindowpreferences"],0,[InfinityMobile.view,"StoryWindowPreferences"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPuzzleArchive",Ext.Container,{config:{layout:"vbox",height:"100%",cls:"puzzleArchive",items:[{itemId:"topbar",height:40,style:"color: #4591B8",layout:{type:"hbox",align:"center"},items:[{itemId:"back",cls:"pointerCursor",width:150,padding:"10 0 0 20",height:"100%",layout:"hbox",style:"font-size:18px",items:[{html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{html:"Back",padding:"0 0 0 5"}]},{itemId:"title",flex:1,style:"text-align:center; font-size:22px; font-weight:bold; color:black",html:"Archive"},{width:150}]},{itemId:"containerScroll",flex:1,scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"container",flex:1,defaults:{cls:"puzzlearchiveitem"}}]},{itemId:"archiveControl",bottom:0,width:"100%",height:40,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"previous",style:"color:#4591B8",html:"Previous",cls:"pointerCursor",zIndex:6,flex:1,left:0,top:20},{itemId:"pages",style:"color:#4591B8;text-align:center;",top:20,width:"100%",layout:{type:"hbox",pack:"center",align:"middle"}},{itemId:"next",style:"color:#4591B8",html:"Next",flex:1,right:0,top:20,cls:"pointerCursor"}]}]},initializ},setBackListene}},0,["readerpuzzlearchive"],["component","container","readerpuzzlearchive"],{component:true,container:true,readerpuzzlearchive:true},["widget.readerpuzzlearchive"],0,[InfinityMobile.view,"ReaderPuzzleArchive"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSectionPopupItem",Ext.Container,{config:{style:"font-size:14px;color:#cccccc;border-bottom:1px solid #e1e1e1;",height:50,padding:"15px 5px",width:"100%",cls:"pointerCursor",name:"",pageNumber:""},initializ},onTa}},0,["readersectionpopupitem"],["component","container","readersectionpopupitem"],{component:true,container:true,readersectionpopupitem:true},["widget.readersectionpopupitem"],0,[InfinityMobile.view,"ReaderSectionPopupItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSectionPopup",Ext.Container,{config:{width:200,height:300,layout:"hbox",style:"transition:all 0.5s ease;background-color:rgba(30,30,30,0.9);transform:translateX(40%);max-height:0px;overflow:hidden;",modal:{cls:"transparentMask sectionpopupmask"},cls:"sectionpopup",centered:true,hideOnMaskTap:true,items:[{layout:"vbox",itemId:"sectionbtns",width:"100%",flex:1,items:[{itemId:"sectionsHeader",width:"100%",height:30,padding:5,style:"background-color:#e1e1e1;",html:"Sections",items:[{itemId:"closeBtn",padding:7,top:0,right:0,html:'<img class="pointerCursor" src="../assets/reader icons/close-btn-black.png" style="height:15px;" />'}]},{itemId:"sectionsContainer",flex:1,style:"overflow-y:auto",width:"100%"}]}]},initializ},hid}},0,["sectionpopup"],["component","container","sectionpopup"],{component:true,container:true,sectionpopup:true},["widget.sectionpopup"],0,[InfinityMobile.view,"ReaderSectionPopup"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderEdgeBrowserPopup",InfinityMobile.view.Overlay,{config:{width:300,height:450,style:"padding:0px",layout:"vbox",hideOnMaskTap:false,items:[{itemId:"languageToolBar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>Microsoft Edge</b>"},{itemId:"downloadToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"languageContent",layout:"vbox",padding:20,flex:1,items:[{flex:1,html:'We have noticed that you\'re using Microsoft Edge. If you are using a touchscreen device, please make sure you enable touch events to make use of the touch features on the reader.<br /><br />To achieve this, open a new tab and type "about:flags", scroll down to the "Touch" section and select "Always on" or "Only on when a touchscreen is detected" for "Enable touch events". '},{itemId:"languageButtonsContainer",height:40,layout:"hbox",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"updateButton",flex:1,style:"background-color:#458fbb; color:white",items:[{html:"Ok"}]}]}]}]},initialize:function(){var d=this;console.log("INITIALIZE");var b=d.getComponent("languageToolBar");d.closeButton=b.getComponent("downloadToolBarClose");var a=d.getComponent("languageContent");var c=a.getComponent("languageButtonsContainer");d.updateButton=c.getComponent("updateButton");d.cancelButton=c.getComponent("cancelButton");d.setCloseListener();d.setUpdateListener()},setCloseListener:function(){var a=this;a.closeButton.element.on("tap",function(){a.destroy();try{localStorage.setItem("edgePrompt"+publicationguid,"true")}catch(b){}})},setUpdateListene}},0,["readeredgebrowser"],["component","container","panel","overlay","readeredgebrowser"],{component:true,container:true,panel:true,overlay:true,readeredgebrowser:true},["widget.readeredgebrowser"],0,[InfinityMobile.view,"ReaderEdgeBrowserPopup"],0));(Ext.cmd.derive("InfinityMobile.view.BackgroundWrapAdItem",Ext.Container,{config:{width:160,margin:25,zIndex:10000,cls:"pointerCursor"},statics:{hasAutoRefreshSettin},isCustomAd:null,hasCustomAdSetting:function(){try{if(typeof InfinityMobile.view.BackgroundWrapAdItem.isCustomAd==="boolean"){return InfinityMobile.view.BackgroundWrapAdItem.isCustomAd}if(settings.wrapAd!=null){var b="type" in settings.wrapAd&&!!settings.wrapAd.type?settings.wrapAd.type:"";return b.indexOf("custom|")>=0}}catch(a){console.warn("[BackgroundWrapAdItem]: Error Caught",a)}return false},customAdMeta:{className:"",configUrl:"",hasConfig:false,isConfigLoading:false,instancesWaitingForConfig:[]}},initialize:function(){var b=this;if(b.statics().isCustomAd===null){b.statics().isCustomAd=b.statics().hasCustomAdSetting();if(b.statics().isCustomAd){var a=settings.wrapAd.type.split("|");b.statics().customAdMeta.className=a[1];b.statics().customAdMeta.configUrl=a[2]}}if(b.config.url!=null){b.url=b.config.url}if(b.config.img!=null){b.img=b.config.img}if(b.config.side!=null){b.side=b.config.side}if(b.config.bottom!=null){b.bottom=b.config.bottom}if(b.config.pageNo!=null){b.pageNo=b.config.pageNo}if(settings.wrapAd.hideWrapperOnPortrait!=null){if(settings.wrapAd.hideWrapperOnPortrait=="true"){if($(window).width()/$(window).height()<=1.4){b.addCls("hideWrapper")}b.fireEvent("resizeWrapAds",b);Ext.Viewport.on("resize",function(){b.fireEvent("resizeWrapAds",b)})}}},setupAdvert:function(){var a=this;a.advertSettings=settings.wrapAd;if(a.statics().isCustomAd){a.setupCustomAd()}else{switch(a.advertSettings.type){case"image":default:a.setupImageAdvert();break;case"dfp":a.setupDfpAdvert();break;case"url":a.setupUrlAdvert(a.pageNo);break;case"adbridg":a.setupAdbridgAdvert();break}}},setupCustomAd:function(){var a=this;if(!($(window).width()/$(window).height()<=1.4&&settings.wrapAd.hideWrapperOnPortrait=="true")&&a.statics().isCustomAd){if(a.advertContainer1==null){var b=function(){a.resizeAdvert(a.advertContainer1)};a.setupResize(b);a.advertContainer1=Ext.create("Ext.Container",{});a.advertContainer1.setCls("wrapper-ad");a.add(a.advertContainer1);a.advertId1=a.advertContainer1.id+"wrapAd";a.advertContainer1.setHtml("<div id='"+a.advertId1+"' style='margin-bottom:25px' ></div>");var c="0px 25px 10px 25px";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null){c="0px 25px"}a.setMargin(c)}if(a.customAd==null){if(!a.statics().customAdMeta.isConfigLoading){if(settings.wrapAd.config==null){a.statics().customAdMeta.isConfigLoading=true;a.ajaxRequest=$.ajax({url:a.statics().customAdMeta.configUrl+(a.statics().customAdMeta.configUrl.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(d){a.updateCustomAdConfigLoadingFlags(true);console.log(d);settings.wrapAd.config=d;a.loadCustomAd();a.loadCustomAdForPreservedInstances()}})}else{a.loadCustomAd()}}else{a.statics().customAdMeta.instancesWaitingForConfig.push(a)}}else{if(a.customAd!=null){a.customAd.refreshAdvert(a.pageNo,a.section)}}}},enableCustomAdRefresh:function(){var a=this;if(a.statics().isCustomAd&&a.customAd!=null){a.customAd.enableRefreshAdvert()}},disableCustomAdRefresh:function(){var a=this;if(a.statics().isCustomAd&&a.customAd!=null){a.customAd.disableRefreshAdvert()}},isCustomAd:function(){var a=this;return a.statics().hasCustomAdSetting()},updateCustomAdConfigLoadingFlags:function(b){var a=this;if(typeof b==="boolean"&&a.statics().isCustomAd){a.statics().customAdMeta.hasConfig=b;a.statics().customAdMeta.isConfigLoading=!b}},loadCustomAd:function(){var a=this;if(a.statics().isCustomAd){a.customAd=new window[a.statics().customAdMeta.className](a.id+"wrapper-ad",a.advertContainer1.element.dom.querySelector("#"+a.advertId1),currentProfile,Ext.Object.merge({side:a.side,psAdObjType:"wrapAd"},settings.wrapAd.config));a.customAd.loadAdvert(a.pageNo,a.section);a.resizeAdvert(a.advertContainer1);a.advertInitialised=true}},loadCustomAdForPreservedInstances:function(){var c=this;var b=c.statics().customAdMeta.instancesWaitingForConfig.length;if(b>0){for(var a=0;a<b;a++){c.statics().customAdMeta.instancesWaitingForConfig[a].loadCustomAd()}c.statics().customAdMeta.instancesWaitingForConfig=[]}},setupUrlAdvert:function(b){var e=this;if(e.getCls().indexOf("hideWrapper")>=0){}else{e.advertContainer=Ext.create("Ext.Container",{cls:"wrapper-ad"});e.add(e.advertContainer);var c=settings.wrapAd.url;if(c.indexOf("?")==-1){c+="?side="+e.side+"&pubid="+publicationguid+"&pnum="+b}else{c+="&side="+e.side+"&pubid="+publicationguid+"&pnum="+b}var a="160";var d="600";e.advertId=e.advertContainer.id+"wrapAd";e.advertContainer.setHtml("<iframe id='"+e.advertId+"' scrolling='no' src='"+c+"' style='width:"+a+"px;height:"+d+"px;border:none;' ></iframe>");e.setMargin("0px 25px");if(e.hasPainted){e.urlAdvertPainted()}else{e.on("painted",e.urlAdvertPainted)}e.advertInitialised=true}},urlAdvertPainted:function(){var b=this;b.hasPainted=true;var a=$("#"+b.advertId)[0];if(a!=null){var c=function(){b.infiniteCarousel=$(".pdfinfinitecarousel")[0];if($(b.element.dom).outerHeight(true)>b.infiniteCarousel.clientHeight){var f=b.infiniteCarousel.clientHeight/$(b.element.dom).outerHeight(true)}else{var f=1}var e="scale3d("+f+", "+f+", 1)";b.advertContainer.element.dom.style.transform=e;var d="0% 100%";if(b.side=="right"){d="100% 100%"}b.advertContainer.element.dom.style.transformOrigin=d};c();b.setupResize(c)}},setupAdbridgAdvert:function(){var c=this;if($(window).width()/$(window).height()<=1.4&&settings.wrapAd.hideWrapperOnPortrait=="true"){}else{var a="160";var b="600";c.advertContainer1=Ext.create("Ext.Container",{cls:"wrapper-ad",marginBottom:20});c.add(c.advertContainer1);c.advertId1=c.advertContainer1.id+"wrapAd";c.advertContainer1.setHtml("<div id='"+c.advertId1+"' data-adbridg-ad-class='"+(c.side=="left"?"adb-ee-160x600-left":"adb-ee-160x600-right")+"' style='width:"+a+"px;height:"+b+"px;margin-bottom:25px' ></div>");var d="0px 25px 10px 25px";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null){d="0px 25px"}c.setMargin(d);c.advertInitialised=true}},setupDfpAdvert:function(){var c=this;if($(window).width()/$(window).height()<=1.4&&settings.wrapAd.hideWrapperOnPortrait=="true"){}else{var a="160";var b="600";if(c.advertSettings.dfpType=="mpu"){a="300";b="250";c.dualWrapAd="";if(settings.wrapAd!=null&&settings.wrapAd.dualAdvert!=null){c.dualWrapAd=settings.wrapAd.dualAdvert}if(c.dualWrapAd!=""&&c.side==c.dualWrapAd){c.setWidth(300)}if(c.dualWrapAd!=""&&c.dualWrapAd!="both"&&c.side!=c.dualWrapAd){return}var d=function(){c.resizeMpuAdvert(a,c.advertContainer1);if(c.dualWrapAd){c.resizeMpuAdvert(a,c.advertContainer2)}}}else{var d=function(){c.resizeAdvert(c.advertContainer1)};c.setupResize(d)}c.advertContainer1=Ext.create("Ext.Container",{cls:"wrapper-ad",marginBottom:20});c.add(c.advertContainer1);c.advertId1=c.advertContainer1.id+"wrapAd";c.advertContainer1.setHtml("<div id='"+c.advertId1+"' style='width:"+a+"px;height:"+b+"px; margin-bottom:25px' ></div>");if(c.dualWrapAd&&(c.side==c.dualWrapAd||c.dualWrapAd=="both")){c.advertContainer2=Ext.create("Ext.Container",{cls:"wrapper-ad"});c.add(c.advertContainer2);c.advertId2=c.advertContainer2.id+"wrapAd";c.advertContainer2.setHtml("<div id='"+c.advertId2+"' style='width:"+a+"px;height:"+b+"px;' ></div>")}c.networkCode=c.advertSettings.networkCode;c.adUnit=c.advertSettings.adUnit;var e="0px 25px 10px 25px";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null){e="0px 25px"}c.setMargin(e);if(c.hasPainted){c.loadDfpAdvert(a,b,c.advertId1,"adSlot1");d(c.advertContainer1);if(c.dualWrapAd){c.loadDfpAdvert(a,b,c.advertId2,"adSlot2");d(c.advertContainer2)}}else{c.on("painted",function(){c.hasPainted=true;c.loadDfpAdvert(a,b,c.advertId1,"adSlot1");d(c.advertContainer1);if(c.dualWrapAd){c.loadDfpAdvert(a,b,c.advertId2,"adSlot2");d(c.advertContainer2)}})}c.advertInitialised=true;c.startAutoRefresh()}},startAutoRefresh:function(){var b=this;if(b.isAutoRefreshing()){b.stopAutoRefresh()}if(b.statics().hasAutoRefreshSetting()){var a=parseInt(b.advertSettings.refreshIntervalDuration);if(isNaN(a)===true||a<15){a=15}a*=1000;b.refreshIntervalTimeoutID=setInterval(function(){b.refreshAdvert()},a)}},isAutoRefreshing:function(){var a=this;return"refreshIntervalTimeoutID" in a&&!!a.refreshIntervalTimeoutID},stopAutoRefresh:function(){var a=this;if(a.isAutoRefreshing()){clearInterval(a.refreshIntervalTimeoutID);a.refreshIntervalTimeoutID=null}},pauseAutoRefresh:function(){var a=this;if(a.isAutoRefreshing()){a.autoRefreshPaused=true;a.stopAutoRefresh()}},hasAutoRefreshPaused:function(){var a=this;return"autoRefreshPaused" in a&&!!a.autoRefreshPaused},resumeAutoRefresh:function(){var a=this;if(a.hasAutoRefreshPaused()){a.autoRefreshPaused=false;a.startAutoRefresh()}},setTargeting:function(g){var e=this;var d="targetingLeft";if(e.dualWrapAd){if(g=="adSlot1"){d="targetingRight"}}else{if(e.side=="right"){d="targetingRight"}}if(settings.wrapAd[d]!=null&&settings.wrapAd[d].length>0){var a=settings.wrapAd[d].split("|");for(var c in a){var f=a[c];var b=f.split("*");if(b!=null&&b.length>=2){b[1]=b[1].replace("{{PAGE}}",e.pageNumber).replace("{{SECTION}}",e.section);e[g].setTargeting(b[0],b[1])}}}},loadDfpAdvert:function(a,b,e,d){var c=this;googletag.cmd.push(function(){c[d]=googletag.defineSlot("/"+c.networkCode+"/"+c.adUnit,[parseInt(a),parseInt(b)],e).addService(googletag.pubads().updateCorrelator());c.setTargeting(d);googletag.enableServices();googletag.display(e);c.dfpInit=true})},resizeMpuAdvert:function(b,a){var c=this;if(b>c.element.dom.clientWidth){var f=c.element.dom.clientWidth/b}else{var f=1}var e="scale3d("+f+", "+f+", 1)";a.element.dom.style.transform=e;var d="0% 100%";a.element.dom.style.transformOrigin=d},resizeAdvert:function(a){var b=this;b.infiniteCarousel=$(".pdfinfinitecarousel")[0];if($(b.element.dom).outerHeight(true)>b.infiniteCarousel.clientHeight-10){var e=(b.infiniteCarousel.clientHeight-10)/$(b.element.dom).outerHeight(true)}else{var e=1}var d="scale3d("+e+", "+e+", 1)";a.element.dom.style.transform=d;var c="0% 100%";if(b.side=="right"){c="100% 100%"}a.element.dom.style.transformOrigin=c},setupImageAdvert:function(){var a=this;if(a.side=="left"){a.addCls("leftWrapper")}else{if(a.side=="right"){a.addCls("rightWrapper")}}a.setStyle({backgroundImage:"url("+a.img+")",backgroundPosition:"bottom center",backgroundSize:"contain",backgroundRepeat:"no-repeat",height:"calc(100% - "+(a.bottom+50)+"px)"});a.element.on({tap:a.imgTap,scope:a});a.advertInitialised=true},imgTap:function(){var a=this;window.open(a.url);mainPanel.fireEvent("trackAdvertClick","imageWrapper-"+a.side)},setupResiz},refreshAdvert:function(){var a=this;if(settings.wrapAd.type=="dfp"){if(!a.dfpInit){a.setupAdvert()}else{a.setTargeting("adSlot1");googletag.pubads().refresh([a.adSlot1]);if(a.dualWrapAd){a.setTargeting("adSlot2");googletag.pubads().refresh([a.adSlot2])}}}else{if(settings.wrapAd.type!="image"&&settings.wrapAd.type!="adbridg"){if(a.advertContainer!=null){a.removeAll(true,true)}a.setupAdvert()}else{if(!a.advertInitialised){a.setupAdvert()}}}}},0,["backgroundwrapaditem"],["component","container","backgroundwrapaditem"],{component:true,container:true,backgroundwrapaditem:true},["widget.backgroundwrapaditem"],0,[InfinityMobile.view,"BackgroundWrapAdItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPagesItem",Ext.Panel,{config:{style:"text-align:center;"},initialize:function(){var b=this;if(b.config.imgSrc!=null){b.imgSrc=b.config.imgSrc+"&lm="+latestLM}b.img=b.element.down("img").dom;if(!Ext.os.is.Phone){var a=Ext.getStore("SettingStore").data.items[0].raw;if(a.topbar.smallLogo!=null){var c=a.topbar.smallLogo}else{var c=a.topbar.logo}b.img.className="readerPage placeholder";b.img.src=c;b.img.style.maxWidth="140px";b.img.style.maxHeight="180px";b.img.style.width="";b.imgLoaded=false}else{$(b.img).one("load",function(){$(b.img).one("load",function(){b.img.className="readerPage"});b.img.src=b.imgSrc})}},loadImage:function(){var a=this;if(!a.imgLoaded){a.img.src=a.imgSrc;a.img.onload=function(){a.img.className="readerPage";a.img.style.maxWidth="";a.img.style.maxHeight="";a.img.style.width="140px"};a.imgLoaded=true}}},0,["readerpagesitem"],["component","container","panel","readerpagesitem"],{component:true,container:true,panel:true,readerpagesitem:true},["widget.readerpagesitem"],0,[InfinityMobile.view,"ReaderPagesItem"],0));(Ext.cmd.derive("InfinityMobile.view.PrintPreview",Ext.Container,{config:{height:"0px",width:"0%",modal:false,fullscreen:true,hideOnMaskTap:true,centered:true,style:"border-radius:10px",zIndex:11111},initialize:function(){var c=this;c.delayImage=800;if(c.config.delayImages!=null){c.delayImage=c.config.delayImages}if(c.config.imgCheck!=null){c.imgCheck=c.config.imgCheck}else{c.imgCheck=false}var a="0px";var b="0px";if(Ext.os.is.Android){a=$(document).height()+"px";b=$(document).width();$(c.element.dom).css("visibility","hidden")}if(currentProfile!="desktop"){c.setLeft(0)}c.setHtml("<iframe id='printIframe' name='printIframe' style='height:"+a+";width:"+b+";border:none;' ></iframe>");c.element.on({painte},scope:c})},print:function(){var b=this;b.iframe.focus();if(b.imgCheck&&!Ext.browser.is.Firefox){var a=$(b.iframe.document).find("img");var c=1000+(a.length*b.delayImage);Ext.Viewport.setMasked({xtype:"loadmask",message:"Loading"});setTimeout(function(){Ext.Viewport.setMasked(false);if(Ext.browser.is.IE){b.iframe.document.execCommand("print",false,null);b.hide()}else{if(Ext.os.is.Android){$(b.element.dom).css("visibility","visible")}b.iframe.print();if(currentProfile=="desktop"){b.hide()}else{$(b.element.dom).css("visibility","hidden")}}},c)}else{if(Ext.browser.is.IE){b.iframe.document.execCommand("print",false,null);b.hide()}else{b.iframe.print();b.hide()}}},hide:function(){var a=this;a.destroy()}},0,["printpreview"],["component","container","printpreview"],{component:true,container:true,printpreview:true},["widget.printpreview"],0,[InfinityMobile.view,"PrintPreview"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingLoad",Ext.Container,{config:{fullscreen:true,modal:true,items:[{itemID:"container",centered:true,height:150,width:150,layout:"vbox",defaults:{margin:10},style:{backgroundColor:"rgba(0,0,0,0.7)",borderRadius:"5px"},items:[{flex:2,style:{backgroundImage:"url('resources/images/loading.gif')",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"}},{flex:1,style:{color:"white",textAlign:"center"},html:"Clipping"}]}]}},0,["clippingload"],["component","container","clippingload"],{component:true,container:true,clippingload:true},["widget.clippingload"],0,[InfinityMobile.view,"ClippingLoad"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingOptionsMenu",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:700,style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,items:[{itemId:"title",top:10,left:10},{id:"clippingOptionsToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0",html:"<p style='font-size:16px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><p style='font-size:12px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p>"},{itemId:"clippingsContainer",style:"border: 1px solid #e6e6e6;",height:400,scrollable:{direction:"vertical",directionLock:true},defaults:{width:203,height:150,margin:"7 8 16 7",cls:"archiveitemphone"}},{itemId:"buttonsContainer",layout:"hbox",height:60,items:[{itemId:"previewBtn",flex:1,cls:"btn",margin:"15 5 5 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/preview-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Preview",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"downloadBtn",flex:1,cls:"btn",margin:"15 5 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/downloads-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Save",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"printBtn",flex:1,cls:"btn",margin:"15 5 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/print-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Print",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"shareBtn",flex:2,cls:"btn",margin:"15 0 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/share-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Share",margin:5,style:"font-size:11pt;"}]}]}]}]},initialize:function(){var b=this;b.clippingsToolbar=b.getComponent("clippingOptionsToolBar");b.clippingsToolbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.closeBtn=b.clippingsToolbar.getComponent("clippingOptionsToolBarClose");b.clippingsBody=b.getComponent("clippingOptionsBodyContainer");b.clippingsContainer=b.clippingsBody.getComponent("clippingsContainer");b.buttonsContainer=b.clippingsBody.getComponent("buttonsContainer");b.previewBtn=b.buttonsContainer.getComponent("previewBtn");b.downloadBtn=b.buttonsContainer.getComponent("downloadBtn");b.printBtn=b.buttonsContainer.getComponent("printBtn");b.shareBtn=b.buttonsContainer.getComponent("shareBtn");b.title=b.clippingsToolbar.getComponent("title");b.title.setHtml(language.clippings.clippingsOptions);b.clippingOptionsContainerText=b.clippingsBody.getComponent("clippingOptionsContainerText");b.clippingOptionsContainerText.setHtml("<p style='font-size:16px;'>"+language.clippings.ClippingsOptionsText+"</p><br /><p style='font-size:12px;color:#444444'>"+language.clippings.clippingsPleaseNote+"</p>");b.previewBtn.getComponent("Preview").setHtml(language.clippings.preview);b.downloadBtn.getComponent("Save").setHtml(language.clippings.save);b.printBtn.getComponent("Print").setHtml(language.clippings.print);b.shareBtn.getComponent("Share").setHtml(language.clippings.share);b.previewBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.downloadBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.printBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.shareBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.closeBtn.element.on("tap",function(){b.destroy()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeBtn.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}b.element.dom.style.borderRadius=""}if(b.config.images!=null){b.images=b.config.images}if(b.config.widths!=null){b.widths=b.config.widths}if(b.config.heights!=null){b.heights=b.config.heights}b.addThumbnails();b.previewBtn.element.on({tap:b.preview,scope:b});b.downloadBtn.element.on({tap:b.download,scope:b});if(Ext.browser.is.Firefox){b.printBtn.hide()}else{b.printBtn.element.on({tap:b.print,scope:b})}b.shareBtn.element.on({tap:b.shareTap,scope:b});if(currentProfile!="desktop"){}b.handlePresence()},previe},download:function(){var f=this;var c=false;if(currentProfile=="desktop"){for(var b=0;b<f.images.length;b++){if(f.clippingsContainer.innerItems[b].clicked){var e=document.createElement("a");e.target="_blank";e.href=f.images[b];e.download="clipping"+b+".jpg";var d=document.createEvent("MouseEvents");d.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);e.dispatchEvent(d);c=true}}}else{var d=document.createEvent("MouseEvents");var e=null;var a=false;for(var b=0;b<f.images.length;b++){if(f.clippingsContainer.innerItems[b].clicked){if(!c){e=document.createElement("a");e.target="_blank";e.href=f.images[b];e.download="clipping"+b+".jpg";d.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);c=true}else{a=true;break}}}if(a){f.promptUser(language.clippings.selectOneClipping)}else{if(e!=null){e.dispatchEvent(d)}}}if(!c){f.promptUser(language.clippings.selectClippings)}},print:function(){var g=this;var d=false;var b="";var h=[];for(var f=0;f<g.images.length;f++){var j=g.images[f];if(g.clippingsContainer.innerItems[f].clicked){if(!d){d=true}h[h.length]=j;b+="<div style='width:100%; height:100%; position:relative'>";b+="<img src='"+j+"' style='height:auto;width:auto;max-height:100%;max-width:100%;' />";b+="</div>"}}if(d){if(navigator.userAgent.toLowerCase().indexOf("fxios")>-1||(Ext.os.is.iOS&&Ext.browser.name=="ChromeiOS")){printingClipping=true;var e=$(".printContainer")[0];var c=1000+(h.length*800);e.innerHTML=b;Ext.Viewport.setMasked({xtype:"loadmask",message:"Loading",zIndex:999999999});setTimeou},c)}else{var a=Ext.create("InfinityMobile.view.PrintPreview",{imgCheck:true,doc:b});Ext.Viewport.add(a);a.show()}}else{g.promptUser(language.clippings.selectClippings)}},shareTap:function(){var d=this;d.shareBtn.removeAll();d.shareBtn.element.dom.style.backgroundColor="#e6e6e6";var b=d.getShareObjects();d.shareBtn.add(b);var a=Ext.getStore("SettingStore");d.emailBtn=d.shareBtn.getComponent("email");d.facebookBtn=d.shareBtn.getComponent("facebook");d.twitterBtn=d.shareBtn.getComponent("twitter");d.linkedinBtn=d.shareBtn.getComponent("linkedin");d.googleBtn=d.shareBtn.getComponent("google");d.pinterestBtn=d.shareBtn.getComponent("pinterest");var c=a.data.items[0].raw.sharing;if(c!=null&&c.allSharing[0]==null){d.emailBtn.hide()}else{d.emailBtn.element.on({tap:d.emailShare,scope:d})}if(c!=null&&c.allSharing[1]==null){d.facebookBtn.hide()}else{d.facebookBtn.element.on({tap:d.facebookShare,scope:d})}if(c!=null&&c.allSharing[2]==null){d.twitterBtn.hide()}else{d.twitterBtn.element.on({tap:d.twitterShare,scope:d})}if(c!=null&&c.allSharing[3]==null){d.linkedinBtn.hide()}else{d.linkedinBtn.element.on({tap:d.linkedinShare,scope:d})}if(c!=null&&c.allSharing[4]==null){d.googleBtn.hide()}else{d.googleBtn.element.on({tap:d.googleShare,scope:d})}if(c!=null&&c.allSharing[5]==null){d.pinterestBtn.hide()}else{d.pinterestBtn.element.on({tap:d.pinterestShare,scope:d})}},getShareObjects:function(){var a=this;var b=null;if(settings.newsday!=null&&settings.newsday.useFontAwesome=="true"){b=[{itemId:"email",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-envelope fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"facebook",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-facebook-official fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"twitter",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-twitter fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"linkedin",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-linkedin-square fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"google",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-google-plus fa-lg pointerCursor" aria-hidden="true"></i>'},{itemId:"pinterest",width:30,height:30,cls:"pointerCursor",html:'<i class="fa fa-pinterest fa-lg pointerCursor" aria-hidden="true"></i>'}]}else{b=[{itemId:"email",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/email-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"facebook",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/facebook-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"twitter",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/twitter-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"linkedin",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/linkedin-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"google",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/google-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"pinterest",width:30,height:30,cls:"pointerCursor",style:'background-image:url("../assets/article view/pinterest-ic.png");background-size:contain;background-position:center;background-repeat:no-repeat;'}]}return b},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingItems",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingsContainer.add(c);c.show()}},promptUse},getSubject:function(){var a="Clippings from "+publicationName;if(settings.clippings.clippingSubject!=null){a=settings.clippings.clippingSubject}return a},getShareUrl:function(b){var c=this;var d=window.location.host;var a=b.split("/");b="https://"+d+"/html5/reader/get_clipping.aspx?edid="+a[5]+"&pnum="+a[6]+"&time="+a[7];return b},emailShare:function(){var e=this;var f=false;var g=e.getSubject();var b="mailto:?subject="+encodeURIComponent(g)+"&body=";var d="To view a clipping, please select one of the links below:\n\n";if(settings.clippings.clippingsBody!=null){d=settings.clippings.clippingsBody+"\n\n"}for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){d+=e.getShareUrl(e.images[c])+" \n\n";f=true}}if(f){if(Ext.browser.userAgent.indexOf("CrOS")!=-1){window.open(b+encodeURIComponent(d))}else{var a=b+encodeURIComponent(d);if(window.parent!=null&&(typeof NEWPWA!="undefined"&&NEWPWA===true)){window.parent.postMessage({type:"sendEmail",message:a},"*")}else{window.location.href=a}}}else{e.promptUser(language.clippings.selectClippings)}},facebookShare:function(){var e=this;var a="";var f=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=encodeURIComponent(e.getShareUrl(e.images[c]));d=true}else{d=false;f=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();window.open("http://www.facebook.com/sharer/sharer.php?m2w&u="+a+"&title="+encodeURIComponent(b))}else{e.promptUser(f)}},twitterShare:function(){var e=this;var a="";var g=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=e.getShareUrl(e.images[c]);d=true}else{d=false;g=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();var f=encodeURIComponent(b+" - "+a);window.open("http://twitter.com/intent/tweet?text="+f)}else{e.promptUser(g)}},linkedinShare:function(){var f=this;var a="";var g=null;var e=false;for(var d=0;d<f.images.length;d++){if(f.clippingsContainer.innerItems[d].clicked){if(!e){a=f.getShareUrl(f.images[d]);e=true}else{e=false;g=language.clippings.selectOneClipping;break}}}if(e){var c=f.getSubject();var b=encodeURIComponent(c+" - "+a);window.open("http://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(a)+"&title="+b)}else{f.promptUser(g)}},googleShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.getShareUrl(d.images[b]);c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("https://plus.google.com/share?url="+encodeURIComponent(a))}else{d.promptUser(e)}},pinterestShare:function(){var e=this;var a="";var f=null;var d=false;for(var c=0;c<e.images.length;c++){if(e.clippingsContainer.innerItems[c].clicked){if(!d){a=e.getShareUrl(e.images[c]);d=true}else{d=false;f=language.clippings.selectOneClipping;break}}}if(d){var b=e.getSubject();window.open("http://pinterest.com/pin/create/bookmarklet/?media="+encodeURIComponent(a)+"&is_video=false&description="+encodeURIComponent(b))}else{e.promptUser(f)}},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");printingClipping=false;if(navigator.userAgent.toLowerCase().indexOf("fxios")>-1||(Ext.os.is.iOS&&Ext.browser.name=="ChromeiOS")){a.fireEvent("setupPrintContainer")}Ext.Container.prototype.hide.apply(this,arguments);a.handleAbsence()},destroy:function(){var a=this;printingClipping=false;if(navigator.userAgent.toLowerCase().indexOf("fxios")>-1||(Ext.os.is.iOS&&Ext.browser.name=="ChromeiOS")){a.fireEvent("setupPrintContainer")}Ext.Container.prototype.destroy.apply(this,arguments);a.handleAbsence()},show:function(){var a=this;Ext.Container.prototype.show.apply(this,arguments);a.handlePresence()},handlePresence:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},handleAbsence:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME)}},0,["clippingoptionsmenu"],["component","container","clippingoptionsmenu"],{component:true,container:true,clippingoptionsmenu:true},["widget.clippingoptionsmenu"],0,[InfinityMobile.view,"ClippingOptionsMenu"],0));(Ext.cmd.derive("InfinityMobile.view.liveNewsTicker",Ext.Container,{config:{padding:"5px"},initializ}},0,["livenewsticker"],["component","container","livenewsticker"],{component:true,container:true,livenewsticker:true},["widget.livenewsticker"],0,[InfinityMobile.view,"liveNewsTicker"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderTicker",Ext.Container,{config:{height:40,padding:"5px",style:"background-color:black;color:white;",zIndex:10000000,cls:"tickerLive"},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.url!=null){a.url=a.config.url}if(a.config.num!=null){a.num=a.config.num}if(a.config.leadText!=null){a.leadText=a.config.leadText}if(a.config.tickerSpeed!=null){a.tickerSpeed=a.config.tickerSpeed}a.ruleAdded=false;console.log(a.config);a.str="";setTimeout(function(){a.loadTicker=function(){$.ajax({url:"../../rssWrapper.aspx?base64url="+encodeURIComponent(btoa(a.url)),dataType:"json",success:function(d){if(d.feed&&d.feed.entries){a.articles=[];a.str="";var c="&nbsp&nbsp&#9899&nbsp&nbsp";if(Ext.browser.userAgent.indexOf("CrOS")!=-1){c="<span>&nbsp&nbsp&bull;&nbsp&nbsp</span>"}if(a.leadText!=""){a.str+="<span style='font-family:Open Sans, sans-serif;font-size:14px;color:white'>"+a.leadText+":&nbsp;</span>"+c}if(a.num!=null){for(var k=0;k<a.num;k++){if(d.feed.entries[k]!=null){a.str+="<span class='tickerLink' style='font-family:Open Sans, sans-serif;font-size:14px;color:white;cursor:pointer' ontouchstart='parent.Click("+(a.articles.length)+")' onclick='parent.Click("+(a.articles.length)+")'>"+d.feed.entries[k].title+"</span>  "+c+"  ";a.articles[a.articles.length]=d.feed.entries[k]}else{break}}}else{$.each(d.feed.entries,function(l,m){a.str+="<span class='tickerLink' style='font-family:Open Sans, sans-serif;font-size:14px;color:white;cursor:pointer' ontouchstart='parent.Click("+(a.articles.length)+")' onclick='parent.Click("+(a.articles.length)+")'>"+m.title+"</span>  "+c+"  ";a.articles[a.articles.length]=m})}}for(var e=0;e<a.articles.length;e++){a.articles[e].sections=[];a.articles[e].sections[0]="LIVE NEWS";a.articles[e].headline=a.articles[e].title;var h="Click here to view full story";if(typeof language!="undefined"&&language.articlePopover!=null&&language.articlePopover.clickHere!=null){h=language.articlePopover.clickHere}if(currentProfile=="desktop"){a.articles[e].content+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+a.articles[e].link+"\")' onclick='window.open(\""+a.articles[e].link+"\")'>"+h+"</p>"}else{a.articles[e].content+="<br /><br /><p class='fullStoryLink' data-url=\""+a.articles[e].link+'" >'+h+"</p>"}a.articles[e].body=a.articles[e].content;a.articles[e].subHeadline="";a.articles[e].byline=a.articles[e].author||"";if(a.articles[e].images!=null){}else{if(a.articles[e].mediaGroups!=null){if(a.articles[e].mediaGroups[0].contents!=null){if(a.articles[e].mediaGroups[0].contents[0].thumbnails!=null){var j=[{url:a.articles[e].mediaGroups[0].contents[0].thumbnails[0].url}];a.articles[e].images=j}else{if(a.articles[e].mediaGroups[0].contents[0].url!=null){var j=[{url:a.articles[e].mediaGroups[0].contents[0].url}];a.articles[e].images=j}}}}else{a.articles[e].images=[]}}a.articles[e].live=true;a.articles[e].url=a.articles[e].link;a.articles[e].config={};a.articles[e].config.articleIndex=e}Clic};if(Ext.browser.userAgent.indexOf("CrOS")!=-1){a.str=a.str.substring(0,a.str.length-39)}else{a.str=a.str.substring(0,a.str.length-18)}var b="marquee ticker ";if(currentProfile=="phone"){b+=" tickerPhone"}var g="";if(!!a.tickerSpeed){g="animation: tickerAnim "+a.tickerSpeed+"s linear infinite !important"}var f='<p class="'+b+'" style="'+g+'">'+a.str+"</p>";a.setHtml(f)}})};a.loadTicker();setInterval(a.loadTicker,180000)},3000);a.setupHoverEvent()},setupHoverEvent:function(){var a=this;a.element.dom.onmouseover=function(){console.log("mouseover");var b=a.element.down(".marquee");if(b!=null){console.log("found marquee");b.dom.style.animationPlayState="paused"}};a.element.dom.onmouseleave=function(){var b=a.element.down(".marquee");if(b!=null){b.dom.style.animationPlayState=""}}}},0,["livenewsticker"],["component","container","livenewsticker"],{component:true,container:true,livenewsticker:true},["widget.livenewsticker"],0,[InfinityMobile.view,"ReaderTicker"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMediaObject",Ext.Container,{config:{baseCls:"mediaObject",mediaObject:""},beforeInitializ},initialize:function(){var b=this;b.mediaObject=b.getMediaObject();b.setMediaObjectStyle();if(b.config.pageNumber!=null){b.pageNumber=b.config.pageNumber}if(b.mediaObject.animType!=null&&b.mediaObject.animType!=""){b.setAnimations()}if(b.mediaObject.isTrigger=="true"){var a=b.mediaObject.url.replace("http://","");if(a.length>0){b.addCls("pointerCursor");b.element.on("tap",function(){b.fireEvent("triggerMedia",a)})}}},setAnimation},setMediaObjectStyle:function(){var b=this;var a="";a="position:absolute;";a+="top:"+b.mediaObject.y+"%;";a+="left:"+b.mediaObject.x+"%;";a+="width:"+b.mediaObject.width+"%;";a+="height:"+b.mediaObject.height+"%;";a+="z-index:"+b.mediaObject.depthIndex+";";if(b.mediaObject.shape!=null){if(b.mediaObject.shape.toLowerCase()=="ellipse"){a+="border-radius: 50%;"}}var d=hexToRgb(b.mediaObject.backgroundColor);var c=b.mediaObject.backgroundAlpha;if(b.mediaObject.backgroundAlpha!=""){if(b.mediaObject.backgroundAlpha>1){c=(b.mediaObject.backgroundAlpha/100)}}else{c=0}a+="background:rgba("+d+","+c+");";b.element.dom.style.border="none";if(b.mediaObject.showBorder){a+="border:1px solid #"+b.mediaObject.borderColor+";"}b.styleString+=a;b.setStyle(b.styleString)},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},appearAni},fadeInAnim:function(){var a=this;switch(a.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.webkitAnimation="fadeIn "+a.mediaObject.duration+"s forwards";break;case"-moz-":if(currentProfile=="desktop"){document.styleSheets[0].insertRule("@keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.animation="fadeIn "+a.mediaObject.duration+"s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.mozAnimation="fadeIn "+a.mediaObject.duration+"s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.msAnimation="fadeIn "+a.mediaObject.duration+"s forwards";break;default:document.styleSheets[0].insertRule("@keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.animation="fadeIn "+a.mediaObject.duration+"s forwards";break}},flyInAnim:function(){var b=this;var c="LEFT";var a="flyInLeft";if(b.mediaObject.entryDir!=null&&b.mediaObject.entryDir!=""&&b.mediaObject.entryDir!="NONE"){c=b.mediaObject.entryDir}switch(c){case"LEFT":a="flyInLeft";break;case"TOP":a="flyInTop";break;case"RIGHT":a="flyInRight";break;case"BOTTOM":a="flyInBottom";break}switch(b.getPrefix().css){case"-webkit-":b.element.dom.style.webkitAnimation=a+" "+b.duration+"s forwards";break;case"-moz-":if(currentProfile=="desktop"){b.element.dom.style.animation=a+" "+b.duration+"s 0s forwards"}else{b.element.dom.style.mozAnimation=a+" "+b.duration+"s forwards"}break;case"-ms-":b.element.dom.style.msAnimation=a+" "+b.duration+"s forwards";break;default:b.element.dom.style.animation=a+" "+b.duration+"s forwards"}},bounceInAnim:function(){var b=this;var c="LEFT";var a="bounceInLeft";if(b.mediaObject.entryDir!=null&&b.mediaObject.entryDir!=""&&b.mediaObject.entryDir!="NONE"){c=b.mediaObject.entryDir}switch(c){case"LEFT":a="bounceInLeft";break;case"TOP":a="bounceInTop";break;case"RIGHT":a="bounceInRight";break;case"BOTTOM":a="bounceInBottom";break}switch(b.getPrefix().css){case"-webkit-":b.element.dom.style.webkitAnimation=a+" "+b.duration+"s forwards";break;case"-moz-":if(currentProfile=="desktop"){b.element.dom.style.animation=a+" "+b.duration+"s 0s forwards"}else{b.element.dom.style.mozAnimation=a+" "+b.duration+"s forwards"}break;case"-ms-":b.element.dom.style.msAnimation=a+" "+b.duration+"s forwards";break;default:b.element.dom.style.animation=a+" "+b.duration+"s forwards"}},elasticIn:function(){var b=this;var c="LEFT";var a="springInLeft";if(b.mediaObject.entryDir!=null&&b.mediaObject.entryDir!=""&&b.mediaObject.entryDir!="NONE"){c=b.mediaObject.entryDir}switch(c){case"LEFT":a="springInLeft";break;case"TOP":a="springInTop";break;case"RIGHT":a="springInRight";break;case"BOTTOM":a="springInBottom";break}switch(b.getPrefix().css){case"-webkit-":b.element.dom.style.webkitAnimation=a+" "+b.duration+"s 1s forwards";break;case"-moz-":if(currentProfile=="desktop"){b.element.dom.style.animation=a+" "+b.duration+"s 0s forwards"}else{b.element.dom.style.mozAnimation=a+" "+b.duration+"s 1s forwards"}break;case"-ms-":b.element.dom.style.msAnimation=a+" "+b.duration+"s 1s forwards";break;default:b.element.dom.style.animation=a+" "+b.duration+"s 1s forwards"}},removeAni},flyOutAnim:function(){var b=this;var c="LEFT";var a="flyOutLeft";if(b.mediaObject.exitDir!=null&&b.mediaObject.exitDir!=""&&b.mediaObject.exitDir!="NONE"){c=b.mediaObject.exitDir}switch(c){case"LEFT":a="flyOutLeft";break;case"TOP":a="flyOutTop";break;case"RIGHT":a="flyOutRight";break;case"BOTTOM":a="flyOutBottom";break}switch(b.getPrefix().css){case"-webkit-":b.element.dom.style.webkitAnimation=a+" "+b.duration+"s forwards";break;case"-moz-":if(currentProfile=="desktop"){b.element.dom.style.animation=a+" "+b.duration+"s forwards"}else{b.element.dom.style.mozAnimation=a+" "+b.duration+"s forwards"}break;case"-ms-":b.element.dom.style.msAnimation=a+" "+b.duration+"s forwards";break;default:b.element.dom.style.animation=a+" "+b.duration+"s forwards";break}setTimeout(function(){b.hide()},b.durationMili)},fadeOutAnim:function(){var a=this;switch(a.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.webkitAnimation="fadeOut "+a.mediaObject.duration+"s forwards";break;case"-moz-":if(currentProfile=="desktop"){document.styleSheets[0].insertRule("@keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.animation="fadeOut "+a.mediaObject.duration+"s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.mozAnimation="fadeOut "+a.mediaObject.duration+"s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.msAnimation="fadeOut "+a.mediaObject.duration+"s forwards";break;default:document.styleSheets[0].insertRule("@keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.animation="fadeOut "+a.mediaObject.duration+"s forwards";break}},setupFlash:function(){var d=this;if(d.mediaObject.flash=="true"||d.mediaObject.flash){var c=hexToRgb(d.mediaObject.backgroundColor);var e=d.mediaObject.backgroundAlpha;var b="infinite";var a=true;if(d.mediaObject.flashOnce=="true"&&d.mediaObject.backgroundAlpha==0){a=false;b=(d.mediaObject.flashSpeed*2)+"s"}else{if(d.mediaObject.flashOnce=="true"){b=(d.mediaObject.flashSpeed*2)+"s forwards"}}switch(d.getPrefix().css){case"-webkit-":d.styleString+="-webkit-animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";";break;case"-moz-":if(currentProfile=="desktop"){d.styleString+="animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";"}else{d.styleString+="-moz-animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";"}break;case"-ms-":d.styleString+="-ms-animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";";d.styleString+="animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";";break;default:d.styleString+="animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";";break}}}},0,["readermediaobject"],["component","container","readermediaobject"],{component:true,container:true,readermediaobject:true},["widget.readermediaobject"],0,[InfinityMobile.view,"ReaderMediaObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderAudioMediaObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",style:"border-radius:10px;display:inline-block !important;",items:[{itemId:"controlPanel",height:"100%",width:"100%",style:"padding:3%;",items:[{cls:"audioControl",itemId:"play",height:"100%",width:"30%",style:'background:url("resources/images/play-ic.png") black;background-size:80% 80%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;',isPlaying:false},{width:"5%",height:"100%"},{cls:"audioControl",itemId:"stop",height:"100%",width:"30%",style:'background:url("resources/images/back-to-start-ic.png") black;background-size:80% 80%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;'},{width:"5%",height:"100%"},{cls:"audioControl",itemId:"mute",height:"100%",width:"30%",style:'background:url("resources/images/unmute-ic.png") black;background-size:80% 80%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;'}]},{itemId:"closeBtn",right:10,top:-25,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backgroundImage",style:'background-image:url("../assets/article view/article-close-btn.png");background-size:contain;'}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.controlPanel=a.getComponent("controlPanel");a.playBtn=a.controlPanel.getComponent("play");a.stopBtn=a.controlPanel.getComponent("stop");a.muteBtn=a.controlPanel.getComponent("mute");a.loadSound();if(a.config.page!=null){a.page=a.config.page}a.playBtn.element.on({tap:a.playSound,scope:a});a.stopBtn.element.on({tap:a.stopSound,scope:a});a.muteBtn.element.on({tap:a.muteSound,scope:a});a.getComponent("closeBtn").element.on("tap});if(a.mediaObject.remove!="CLOSEBTN"){a.getComponent("closeBtn").hide()}if(currentProfile=="desktop"){if(a.mediaObject.autoPlay=="true"){a.fireEvent("checkActivePage",a)}}a.audioFile.onpaus}},loadSound:function(){var b=this;b.fileGuid=b.mediaObject.file;var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);var d=window.location.protocol+"//pages.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+".mp3";b.audioFile=new Audio(d)},playSoun},stopSoun},muteSoun}},0,["readeraudiomediaobject"],["component","container","readermediaobject","readeraudiomediaobject"],{component:true,container:true,readermediaobject:true,readeraudiomediaobject:true},["widget.readeraudiomediaobject"],0,[InfinityMobile.view,"ReaderAudioMediaObject"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleSectionItemImg",Ext.Container,{config:{height:"100%",width:350,layout:"vbox",style:"border:5px solid transparent;",cls:"article-container",items:[{itemId:"image",cls:"backImage",height:160,style:"background-color:gray"},{itemId:"bodyContainer",height:190,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;",cls:"article-container-text-box"}]},initialize:function(){var a=this;var b=true;a.image=a.getComponent("image");a.bodyContainer=a.getComponent("bodyContainer");if(a.config.article!=null){a.article=a.config.article;a.articleHeadline=a.article.headline;a.articleImage=null;if(a.article.images!=null&&a.article.images.length>0){a.articleImage=a.article.images[0]}else{if(a.article.image!=null&&a.article.image.trim()!=""){a.articleImage={url:a.article.image}}else{b=false}}a.articleShortStory=a.article.shortStory!=null?a.article.shortStory:""}if(a.config.container!=null){a.container=a.config.container}a.loadArticle();a.element.on({tap:a.onTap,scope:a});a.imageLoaded=b===false&&"pwaImagelessArticleWithShortStory" in a.config&&a.config.pwaImagelessArticleWithShortStory===true},loadImage:function(){var d=this;var a="cover";if(settings.reader.thumbnailImageMode!=null){if(settings.reader.thumbnailImageMode=="fit"){a="contain"}}if(!d.imageLoaded){if(d.articleImage!=null){d.articleImage.url=d.articleImage.url.replace(/ /g,"%20");var c=d.articleImage.url;if(settings.reader.thumbnailImageResize=="true"){c="image_resize.aspx?w=350&url="+d.articleImage.url}var b=new Image();b.onload=function(){$(this).remove();if(a=="contain"){d.image.addCls("backImage")}else{d.image.addCls("backImage aspectfill")}d.image.removeCls("placeholder");if(!!d.image.element){$(d.image.element.dom).css("background-image",'url("'+c+'")');d.imageLoaded=true}};b.src=c}}},loadArticle:function(){var b=this;if(settings.topbar.smallLogo!=null){var c=settings.topbar.smallLogo;var d=true}else{var c=settings.topbar.logo;var d=false}if(settings.topbar.backgroundColor!=null){var a="#"+settings.topbar.backgroundColor}else{var a="transparent"}$(b.image.element.dom).css("background-image","url('"+c+"')");if(!d){$(b.image.element.dom).css("background-size","contain")}b.image.addCls("placeholder");b.bodyContainer.setHtml("<div class='articleItem' style='line-height:20px;oveflow:hidden;' ><b style='font-size:18px !important;'>"+b.articleHeadline+"</b><br />"+b.articleShortStory+"</div>")},onTap:function(){var a=this;var b=typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"?a.article.parentpage:a.article.pageNumber;a.fireEvent("jumpToPage",a.returnCorrectPageNumber(b));if(typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){a.fireEvent("articleClick",a.article,a.article.id)}else{a.fireEvent("articleClick",a.article,a.article.guid)}},returnCorrectPageNumber:function(d){var b=this;var c=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[d-1]!=null?flatPlanData.pdfPages[d-1].pages[0].advertsAdded:0;d+=c;if(d!=-1){var e=flatPlanData.pageGroups.length;var a=Math.min(d,e);a=Math.max(a,1);if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){a=(reader.getData().length-a)+1}return a-1}return d-1},hasArticle:function(b){var a=this;return(a.article.id==b||a.article.guid==b)}},0,["articlesectionitemimg"],["component","container","articlesectionitemimg"],{component:true,container:true,articlesectionitemimg:true},["widget.articlesectionitemimg"],0,[InfinityMobile.view,"ArticleSectionItemImg"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleSectionItem",Ext.Container,{config:{height:"100%",width:350,layout:"vbox",style:"border:5px solid transparent;",items:[{itemId:"bodyContainer1",height:180,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;",cls:"article-container"},{itemId:"bodyContainer2",height:170,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;",cls:"article-container"}]},initializ},loadArticles:function(){var a=this;if(a.article1.shortStory==null){a.article1.shortStory=""}a.body1.setHtml("<div class='articleItem1' style='line-height:20px;overflow:hidden;height:140px;'><b style='font-size:18px !important;'>"+a.article1.headline+"</b><br />"+a.article1.shortStory+"</div>");if(a.article2!=null){if(a.article2.shortStory==null){a.article2.shortStory=""}a.body2.setHtml("<div class='articleItem2' style='line-height:20px;overflow:hidden;height:140px;'><b style='font-size:18px !important;'>"+a.article2.headline+"</b><br />"+a.article2.shortStory+"</div>")}},body1Tap:function(){var a=this;var b=typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"?a.article1.parentpage:a.article1.pageNumber;a.fireEvent("jumpToPage",a.returnCorrectPageNumber(b));if(typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){a.fireEvent("articleClick",a.article1,a.article1.id)}else{a.fireEvent("articleClick",a.article1,a.article1.guid)}},body2Tap:function(){var a=this;if(a.article2!=null){var b=typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"?a.article2.parentpage:a.article2.pageNumber;a.fireEvent("jumpToPage",a.returnCorrectPageNumber(b));if(typeof settings!="undefined"&&settings.articlepopover!=null&&settings.articlepopover.usePopoverListEndpoint=="true"){a.fireEvent("articleClick",a.article2,a.article2.id)}else{a.fireEvent("articleClick",a.article2,a.article2.guid)}}},returnCorrectPageNumber:function(d){var b=this;var c=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[d-1]!=null?flatPlanData.pdfPages[d-1].pages[0].advertsAdded:0;d+=c;if(d!=-1){var e=flatPlanData.pageGroups.length;var a=Math.min(d,e);a=Math.max(a,1);if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){a=(reader.getData().length-a)+1}return a-1}return d-1},hasArticle:function(b){var a=this;return(!!a.article1&&(a.article1.id==b||a.article1.guid==b))||(!!a.article2&&(a.article2.id==b||a.article2.guid==b))}},0,["articlesectionitem"],["component","container","articlesectionitem"],{component:true,container:true,articlesectionitem:true},["widget.articlesectionitem"],0,[InfinityMobile.view,"ArticleSectionItem"],0));(Ext.cmd.derive("InfinityMobile.view.ArticlesSectionContainer",Ext.Container,{config:{height:400,layout:"vbox",style:"margin-left:15px solid transparent !important;margin-right:15px solid transparent !important;",cls:"article-content-browser",items:[{itemId:"section",height:360,layout:"hbox"}]},initializ},loadArticles:function(){var j=this;var a=InfinityMobile.controller.ReaderController.isNewPWA();var k=false;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"&&j.articles!=null){for(var d=j.articles.length-1;d>=0;d--){var f=j.articles[d];var c=$.extend(true,{},articleDictionary[f]);var e=(c.images!=null&&c.images.length>0)||(c.image!=null&&c.image.trim()!="");k=a&&!e&&"shortStory" in c&&!!c.shortStory;if(e===true||k===true){var g=Ext.create("InfinityMobile.view.ArticleSectionItemImg",{article:c,pwaImagelessArticleWithShortStory:k});j.sectionBody.add(g)}else{var h=false;var l=j.articles[d-1];var m=null;if((d-1)>=0){var l=j.articles[d-1];m=$.extend(true,{},articleDictionary[l]);if(m.images!=null&&m.images.length>0){m=null}else{h=true}}else{var b=null}var g=Ext.create("InfinityMobile.view.ArticleSectionItem",{article1:c,article2:m});j.sectionBody.add(g);if(h){d--}}}}else{if(j.articles!=null){for(var d=0;d<j.articles.length;d++){var f=j.articles[d];var c=$.extend(true,{},articleDictionary[f]);var e=(c.images!=null&&c.images.length>0)||(c.image!=null&&c.image.trim()!="");k=a&&!e&&"shortStory" in c&&!!c.shortStory;if(e===true||k===true){var g=Ext.create("InfinityMobile.view.ArticleSectionItemImg",{article:c,pwaImagelessArticleWithShortStory:k});j.sectionBody.add(g)}else{var h=false;var l=j.articles[d+1];var m=null;if((d+1)<j.articles.length){var l=j.articles[d+1];m=$.extend(true,{},articleDictionary[l]);if(m.images!=null&&m.images.length>0){m=null}else{h=true}}else{var b=null}var g=Ext.create("InfinityMobile.view.ArticleSectionItem",{article1:c,article2:m});j.sectionBody.add(g);if(h){d++}}}}}}},0,["articlesectioncontainer"],["component","container","articlesectioncontainer"],{component:true,container:true,articlesectioncontainer:true},["widget.articlesectioncontainer"],0,[InfinityMobile.view,"ArticlesSectionContainer"],0));(Ext.cmd.derive("InfinityMobile.view.ArticlesContainer",Ext.Container,{config:{width:"100%",height:440,zIndex:100000,bottom:-40,items:[{itemId:"tab",cls:"pagesTab",height:40,left:0,top:-40,style:"background-color:rgba(0,0,0,0.8);border-top-right-radius:10px;color: white;",layout:"hbox",items:[{cls:"browserBtn",itemId:"pages",padding:12,height:40,style:"min-width:100px;text-align:center;font-size:11pt;"},{cls:"browserBtn",itemId:"articles",padding:12,height:40,style:"min-width:100px;text-align:center;font-size:11pt;"},{cls:"browserBtn",itemId:"supplements",padding:12,height:40,style:"min-width:100px;text-align:center;font-size:11pt;"}]},{itemId:"sectionToolbar",width:"100%",height:40,top:0,layout:"hbox",style:"background-color:rgba(0,0,0,0.8);border-bottom:1px solid gray;overflow:hidden;",items:[{itemId:"previousBtn",height:40,width:40,style:'border-right:1px solid gray;background-size:60% 50%;background-repeat:no-repeat;background-position:center;background-image:url("../assets/reader icons/back.png");',cls:"pointerCursor browser-btn"},{itemId:"sectionArea",height:40,flex:1,layout:"hbox",style:"overflow:hidden;"},{itemId:"nextBtn",height:40,width:40,style:'border-left:1px solid gray;background-size:60% 50%;background-repeat:no-repeat;background-position:center;background-image:url("../assets/reader icons/next.png");',cls:"pointerCursor browser-btn"},{itemId:"expandBtn",cls:"pointerCursor browser-btn",height:40,width:"40px",style:'border-left:1px solid gray;background-image:url("resources/images/reader icons/expand ic.png");background-size:60% 50%;background-repeat:no-repeat;background-position:center;'},{itemId:"closeBtn",cls:"pointerCursor browser-btn",height:40,width:"40px",style:'border-left:1px solid gray;background-image:url("resources/images/reader icons/close btn.png");background-size:60% 50%;background-repeat:no-repeat;background-position:center;'}]},{itemId:"con",layout:"hbox",top:40,style:"background-color:rgba(0,0,0,0.8);",width:"100%",height:"370px"}]},initialize:function(){var b=this;b.sectionIndex=null;var a=false;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer=="true"){a=true}}b.articlesHeight=400;b.tab=b.getComponent("tab");b.pagesTab=b.tab.getComponent("pages");b.pagesTabText=b.pagesTab.element.down("p");b.articleTabText=b.tab.getComponent("articles").element.down("p");b.articleTab=b.tab.getComponent("articles");b.supplementsTab=b.tab.getComponent("supplements");b.sectionToolbar=b.getComponent("sectionToolbar");b.sectionArea=b.sectionToolbar.getComponent("sectionArea");b.closeBtn=b.sectionToolbar.getComponent("closeBtn");b.expandBtn=b.sectionToolbar.getComponent("expandBtn");b.nextBtn=b.sectionToolbar.getComponent("nextBtn");b.previousBtn=b.sectionToolbar.getComponent("previousBtn");b.contentArea=b.getComponent("con");if(b.config.articles!=null){b.articles=b.config.articles}if(b.config.sections!=null){b.sections=b.config.sections}if(b.config.mode!=null){b.mode=b.config.mode}b.setupBrowser()},setupBrowser:function(){var a=this;a.checkPages();a.checkSections();a.pagesHeight=160;a.scrollType=a.setUpScrolling();a.offset=0;a.setTransition();a.checkMode();a.sortSections();a.checkArticles();a.checkScroller();a.checkSupplements();a.setupTabListeners();a.setUpSectionNavigation();a.deviceSetup()},checkSections:function(){var a=this;if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hidePageBrowserSections=="true"&&a.display=="pages"){a.sectionArea.addCls("hide-sections");a.nextBtn.element.dom.style.backgroundImage="";a.previousBtn.element.dom.style.backgroundImage="";a.nextBtn.element.dom.style.border="";a.previousBtn.element.dom.style.border=""}else{if(typeof settings!="undefined"&&settings.menu!=null&&settings.menu.hideArticleBrowserSections=="true"&&a.display=="articles"){a.sectionArea.addCls("hide-sections");a.nextBtn.element.dom.style.backgroundImage="";a.previousBtn.element.dom.style.backgroundImage="";a.nextBtn.element.dom.style.border="";a.previousBtn.element.dom.style.border=""}else{a.sectionArea.removeCls("hide-sections");a.nextBtn.element.dom.style.backgroundImage='url("../assets/reader icons/next.png")';a.previousBtn.element.dom.style.backgroundImage='url("../assets/reader icons/back.png")';a.nextBtn.element.dom.style.borderLeft="1px solid gray";a.previousBtn.element.dom.style.borderRight="1px solid gray"}}},setTransition:function(){var a=this;a.setStyle({transition:"ease transform 0.3s"})},checkPages:function(){var a=this;if(settings.menu!=null&&settings.menu.hidePages!=null){a.pagesTab.hide();return}else{a.pagesTab.setHtml(language.articlesContainer.pages)}a.pagesTab.show()},setUpScrolling:function(){var a=this;if(navigator.maxTouchPoints){a.contentArea.setScrollable({direction:"horizontal"});return"senchaScroller"}else{a.contentArea.element.dom.style.overflowX="auto";a.contentArea.element.dom.style.overflowY="hidden";a.articlesHeight=410;a.setBottom(-30);a.contentArea.element.dom.style.transition="0.1s ease all";$(a.contentArea.element.dom).on({scroll:function(b){a.onDesktopScroll(b)}});a.element.dom.onmousewhee};if(Ext.browser.is.Firefox){a.element.dom.addEventListener("DOMMouseScroll})}return"desktopScroller"}},checkMod},sortSections:function(){var a=this},checkArticles:function(b){var a=this;if(!$.isEmptyObject(articleDictionary)&&settings.articles!=null){if(!b){a.display="articles"}a.articleTab.setHtml(language.articlesContainer.articles);a.loadContainer()}else{if(!b){a.display="articles"}a.mode="start";if(settings.menu!=null&&settings.menu.hidePages!=null){}else{a.pagesTabTap()}a.articleTab.hide();return}a.articleTab.show()},loadContainer:function(){var j=this;var e=Ext.getStore("ArticleStore");var c=e.uniqueArticles;if(j.sections.length>0){var m=[];if(j.sections[0].pageNumber>1){j.sections.unshift({page:1,pageNumber:1,name:""})}var a=j.getComponent("con");for(var g=0;g<j.sections.length;g++){var f=[];var h=parseInt(j.sections[g].page);if(c!=null){for(var k=0;k<c.length;k++){if(j.sections[g+1]!=null){var d=articleDictionary[c[k]];var b=d!=null?d.pageNumber!=null?d.pageNumber:d.parentpage:null;if(d!=null&&b>=h&&b<parseInt(j.sections[g+1].page)){f.push(c[k])}}else{var d=articleDictionary[c[k]];var b=d!=null?d.pageNumber!=null?d.pageNumber:d.parentpage:null;if(d!=null&&b>=h){f.push(c[k])}}}}if(f.length>0){var l=Ext.create("InfinityMobile.view.ArticlesSectionContainer",{section:j.sections[g],articles:f,container:j});a.add(l)}}}else{var l=Ext.create("InfinityMobile.view.ArticlesSectionContainer",{section:"All",articles:c,container:j});j.contentArea.add(l)}},checkScroller:function(){var d=this;if(d.scrollType=="senchaScroller"){d.getComponent("con").getScrollable().getScroller().on({scroll:d.onScroll,scope:d})}if(d.sectionArea.getScrollable()==null){d.sectionArea.setScrollable({direction:"horizontal"})}var e=d.sectionArea&&d.sectionArea.getScrollable();var b=e&&e.getScroller();var a=b&&b.getElement();if(Ext.browser.is.Firefox&&b&&a&&a.dom){var c=a.dom;var f=e.getElement().dom;if(!!c&&!!f){b.on({scrollstart:function(j){var h=$(c).width()-$(f).width();var g=$(c).height()-$(f).height();b.maxPosition={x:h,y:g}},scope:d})}}},setupTabListeners:function(){var a=this;a.articleTab.element.on({tap:a.articleTabTap,scope:a});a.pagesTab.element.on({tap:a.pagesTabTap,scope:a});a.supplementsTab.element.on({tap:a.supplementsTabTap,scope:a});a.element.on({hide:a.hideMe,scope:a});a.closeBtn.element.on({tap:a.hide,scope:a});a.expandBtn.element.on({tap:a.expand,scope:a})},scrollSectionsArea:function(m,k){var g=this;var b=m.element.dom.offsetLeft;var j=g.sectionArea.getScrollable();if(j!=null&&j.getScroller()!=null){var f=j.getScroller();var e=f.position.x;var d=f&&f.getElement();if(k=="back"){if(e+40>b){var a=Math.max(b-10,0);f.scrollTo(a)}}else{if(k=="next"){var n=$(m.element.dom).width()+b;var l=($(document).width()-120);if(l+e<n){var h=(n+10)-l;var c=f.maxPosition.x;if(Ext.browser.is.Firefox&&d&&d.dom){c=$(d.dom).width()}var a=Math.min(h,c);f.scrollTo(a)}}}}},getActiveSectio},nextSection:function(){var e=this;var a=e.getActiveSection();var d=e.sectionArea.items.items;var c=parseInt(a.pos)+1;if(c<d.length){var b=d[c];e.sectionTap(b,e)}},previousSectio},setActiveSections:function(b,h){var d=this;var f=d.getActiveSection();for(var c=0;c<d.sectionArea.items.items.length;c++){var g=d.sectionArea.items.items[c];if(g!=null){$(g.element.dom).css("color","gray");g.config.isActive=false}}for(var c=b;c<=h;c++){var g=d.sectionArea.items.items[c];if(g!=null){$(g.element.dom).css("color","white");g.config.isActive=true}}var a=d.getActiveSection();var e="back";if(a.pos>f.pos){e="next"}if(a.sectionBtn!=null){d.scrollSectionsArea(a.sectionBtn,e)}},articleTabTap:function(e){var d=this;if(e!=null){e.stopPropagation()}if(d.scrollType=="senchaScroller"){d.getComponent("con").getScrollable().getScroller().scrollTo(1);if(window.settings!=null&&window.settings.reader!=null&&window.settings.reader.justifyText=="right"){d.contentArea.getScrollable().getScroller().scrollToEnd()}}else{d.contentArea.setHeight(370);if(window.settings!=null&&window.settings.reader!=null&&window.settings.reader.justifyText=="right"){setTimeout(function(){try{d.contentArea.element.dom.scrollLeft=d.contentArea.element.dom.scrollWidth}catch(h){console.error("[ArticlesContainer]:\n",h)}},200)}d.onDesktopScroll()}if(d.display=="pages"||d.display=="supplements"){d.getComponent("con").removeAll();d.loadContainer()}d.display="articles";d.checkSections();var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.dynamic!=null){var f=80;d.expandBtn.show()}else{var f=40;d.expandBtn.hide()}if(d.sections.length>1){f+=80}if(d.canShowNavButtons()){d.nextBtn.show();d.previousBtn.show()}var a=0;var g=0;for(var b=a;b<d.getComponent("con").items.items.length;b++){if($(document).width()>=parseFloat(d.getComponent("con").items.items[b].element.dom.offsetLeft)){g=b}}d.setActiveSections(a,g);setTimeout(function(){var k=d.contentArea.getItems().items;for(var j=a;j<=g;j++){if(k[j]!=null){var l=k[j].items.items[0].items.items;if(l!=null){for(var h=0;h<l.length;h++){if((0<=l[h].element.dom.offsetLeft&&$(document).width()>=l[h].element.dom.offsetLeft)||l[h].element.dom.offsetLeft==0){if(l[h].loadImage!=null){l[h].loadImage()}}}}}}},200);if(d.mode=="toggle"){d.animateContainer(0);d.mode="articles";if(currentProfile=="desktop"){window.onkeydown=null}d.setModal({style:"opacity:0;"});d.setHideOnMaskTap(true);mainPanel.fireEvent("showArticles");d.handlePresence()}else{if(d.mode=="pages"){d.animateContainer(0);d.mode="articles";if(currentProfile=="desktop"){window.onkeydown=null}d.setModal({style:"opacity:0;"});d.setHideOnMaskTap(true);mainPanel.fireEvent("showArticles");d.handlePresence()}else{if(d.mode=="articles"){d.animateContainer(d.articlesHeight);d.mode="toggle";d.setHideOnMaskTap(false);d.setModal(false);if(currentProfile=="desktop"){if(d.keyDownFunc!=null){window.onkeydown=d.keyDownFunc}}mainPanel.fireEvent("hideArticles");d.handleAbsence()}else{if(d.mode=="supplements"){d.animateContainer(0);d.mode="articles";if(currentProfile=="desktop"){window.onkeydown=null}d.setModal({style:"opacity:0;"});d.setHideOnMaskTap(true);mainPanel.fireEvent("showArticles");d.handlePresence()}}}}d.loadSectionsBtns()},pagesTabTap:function(d){var c=this;if(d!=null){d.stopPropagation()}if(c.display=="articles"||c.display=="supplements"){c.getComponent("con").removeAll();if(c.scrollType=="senchaScroller"){c.getComponent("con").setScrollable({direction:"horizontal"})}else{c.contentArea.setHeight(210)}var a=Ext.create("InfinityMobile.view.ReaderPages",{articlesContainer:c});c.contentArea.add(a);c.getComponent("con").setPadding(10,10,10,10);a.element.on({painted:function(){},scope:a})}c.expandBtn.hide();if(c.canShowNavButtons()){c.nextBtn.show();c.previousBtn.show()}c.display="pages";c.checkSections();index=0;var f=0;c.setActiveSections(index,f);if(c.sections>0){for(var b=0;b<c.sectionArea.items.items.length;b++){var e=c.sectionArea.items.items[b];$(e.element.dom).css("color","gray")}for(var b=index;b<=f;b++){var e=c.sectionArea.items.items[b];if(e!=null){$(e.element.dom).css("color","white")}}}setTimeou},200);if(c.mode=="toggle"){c.animateContainer(c.pagesHeight);c.deviceSetup();c.mode="pages";if(currentProfile=="desktop"){window.onkeydown=null}if(c.getModal()){c.setModal({style:"opacity:0;"})}c.setHideOnMaskTap(true);mainPanel.fireEvent("showPages");c.handlePresence()}else{if(c.mode=="articles"){c.animateContainer(c.pagesHeight);c.mode="pages";if(currentProfile=="desktop"){window.onkeydown=null}c.setModal({style:"opacity:0;"});c.setHideOnMaskTap(true);mainPanel.fireEvent("showPages");c.handlePresence()}else{if(c.mode=="pages"){c.animateContainer(c.articlesHeight);c.mode="toggle";c.setHideOnMaskTap(false);c.setModal(false);if(currentProfile=="desktop"){if(c.keyDownFunc!=null){window.onkeydown=c.keyDownFunc}}mainPanel.fireEvent("hidePages");c.handleAbsence()}else{if(c.mode=="supplements"){c.animateContainer(c.pagesHeight);c.mode="pages";if(currentProfile=="desktop"){window.onkeydown=null}c.setModal({style:"opacity:0;"});c.setHideOnMaskTap(true);mainPanel.fireEvent("showPages");c.handlePresence()}else{if(c.mode=="start"){c.mode="toggle"}}}}}c.fireEvent("checkActivePageInBrowser",c);c.loadSectionBtnsPages()},animateContainer:function(b){var a=this;a.element.dom.style.mozTransform="translate3d(0px, "+b+"px, 0px)";a.element.dom.style.webkitTransform="translate3d(0px, "+b+"px, 0px)";a.element.dom.style.msTransform="translate3d(0px, "+b+"px, 0px)";a.element.dom.style.transform="translate3d(0px, "+b+"px, 0px)"},disableEvents:function(){var a=this;a.element.dom.style.pointerEvents="none"},enableEvents:function(){var a=this;a.element.dom.style.pointerEvents=""},onScrol},onDesktopScroll:function(r){var s=this;if(s.mode=="articles"){if(s.contentArea.element.dom.scrollLeft>0){var f=0;var c;for(var o=0;o<s.getComponent("con").items.items.length;o++){var h=s.getComponent("con").items.items[o].element.dom.offsetLeft;if(s.getComponent("con").items.items[o+1]!=null){var l=s.getComponent("con").items.items[o+1].element.dom.offsetLeft;if(s.contentArea.element.dom.scrollLeft>=h&&parseInt(s.contentArea.element.dom.scrollLeft)<parseInt(l)){f=o;c=h;break}}else{f=o;c=h;break}}var q=0;for(var o=f;o<s.getComponent("con").items.items.length;o++){if(s.contentArea.element.dom.scrollLeft+$(document).width()>=parseFloat(s.getComponent("con").items.items[o].element.dom.offsetLeft)){q=o}}s.setActiveSections(f,q);var a=s.contentArea.getItems().items;for(var o in a){var b=a[o];var m=b.items.items[0].items.items;for(var j in m){var g=m[j];var n=g.element.dom;var p=s.contentArea.element.dom;if(parseFloat(p.scrollLeft)-350<=parseFloat(n.offsetLeft)&&parseFloat(p.scrollLeft)+$(document).width()>=parseFloat(n.offsetLeft)){if(g.loadImage!=null){g.loadImage()}}}}}else{f=0;var q=0;for(var o=f;o<s.getComponent("con").items.items.length;o++){if(s.contentArea.element.dom.scrollLeft+$(document).width()>=parseFloat(s.getComponent("con").items.items[o].element.dom.offsetLeft)){q=o}}s.setActiveSections(f,q)}}else{if(s.mode=="pages"){if(s.contentArea.element.dom.scrollLeft>0){var f=0;var d=[];for(var o=0;o<s.sectionArea.getItems().length;o++){var t=s.getComponent("con").items.items[0].items.items[s.sections[o].page-1];if(t!=null){d[o]=t.element.dom.offsetLeft}}for(var o=0;o<=d.length;o++){if(d[o+1]!=null){if(parseInt(s.contentArea.element.dom.scrollLeft)>=parseInt(d[o])&&parseInt(s.contentArea.element.dom.scrollLeft)<parseInt(d[o+1])){f=o;break}}else{f=o;break}}var q=0;for(var o=f;o<d.length;o++){if(s.contentArea.element.dom.scrollLeft+$(window).width()>=parseFloat(d[o])){q=o}}s.setActiveSections(f,q);var k=s.contentArea.getItems().items[0].innerItems;for(var o=0;o<k.length;o++){if((s.contentArea.element.dom.scrollLeft<=k[o].element.dom.offsetLeft&&s.contentArea.element.dom.scrollLeft+$(document).width()>=k[o].element.dom.offsetLeft)||k[o].element.dom.offsetLeft==0){if(k[o].loadImage!=null){k[o].loadImage()}}}}else{f=0;var q=0;var d=[];for(var o=0;o<s.sections.length;o++){var t=s.getComponent("con").items.items[0].items.items[s.sections[o].page];if(t!=null){d[o]=t.element.dom.offsetLeft}}for(var o=f;o<d.length;o++){if(s.contentArea.element.dom.scrollLeft+$(window).width()>=parseFloat(d[o]-150)){q=o}}s.setActiveSections(f,q)}}}},setUpSectionNavigation:function(){var a=this;if(a.canShowNavButtons()){a.nextBtn.element.on({tap:a.nextSection,scope:a});a.previousBtn.element.on({tap:a.previousSection,scope:a})}else{a.nextBtn.hide();a.previousBtn.hide()}},canShowNavButtons:function(){var a=this;return settings.menu!=null&&settings.menu.hideSectionList==null&&a.sections.length>1?true:false},deviceSetu},hideM},hide:function(){var a=this;if(a.mode=="pages"){mainPanel.fireEvent("hidePages")}else{mainPanel.fireEvent("hideArticles")}a.mode="toggle";a.setHideOnMaskTap(false);a.setModal(false);if(currentProfile=="desktop"){if(a.keyDownFunc!=null){window.onkeydown=a.keyDownFunc}}a.animateContainer(a.articlesHeight);a.handleAbsence();setTimeout(function(){a.resetFromArticlePopoverView()},500)},hideWithoutHandlingKeys:function(){var a=this;if(a.mode=="pages"){mainPanel.fireEvent("hidePages")}else{mainPanel.fireEvent("hideArticles")}a.mode="toggle";a.setHideOnMaskTap(false);a.setModal(false);a.animateContainer(a.articlesHeight)},expan},loadSectionsBtns:function(){var l=this;l.sectionArea.removeAll();var k=0;for(var h=0;h<l.sections.length;h++){if(h==0){var d="white";var n=true}else{var d="gray";var n=false}var f=Ext.getStore("ArticleStore");var c=f.uniqueArticles;if(c!=null&&c.length>0){var g=[];var j=parseInt(l.sections[h].page);for(var m=0;m<c.length;m++){if(l.sections[h+1]!=null){var e=articleDictionary[c[m]];var a=e!=null?e.pageNumber!=null?e.pageNumber:e.parentpage:null;if(e!=null&&a>=j&&a<parseInt(l.sections[h+1].page)){g.push(c[m])}}else{var e=articleDictionary[c[m]];var a=e!=null?e.pageNumber!=null?e.pageNumber:e.parentpage:null;if(e!=null&&a>=j){g.push(c[m])}}}if(g.length>0){var b=Ext.create("Ext.Container",{cls:"browserBtn",height:40,html:l.sections[h].name!=null?l.sections[h].name.trim():"",style:"color:"+d+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:k,articleContainer:l,isActive:n,section:l.sections[h]});l.sectionArea.add(b);b.element.on({tap:function(){l.sectionTap(this,this.config.articleContainer)},painted:function(){var p=this.config.articleContainer;var o=p.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(o)},scope:b});k+=1}}else{if(l.sections.length>0){var b=Ext.create("Ext.Panel",{cls:"browserBtn",height:40,html:l.sections[h].name!=null?l.sections[h].name.trim():"",style:"color:"+d+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:k,articleContainer:l,isActive:n,section:l.sections[h]});l.sectionArea.add(b);b.element.on({tap:function(){l.sectionTap(this,this.config.articleContainer)},painted:function(){var p=this.config.articleContainer;var o=p.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(o)},scope:b});k+=1}}}},loadSectionBtnsPages:function(){var e=this;e.sectionArea.removeAll();var d=0;for(var b=0;b<e.sections.length;b++){if(b==0){var a="white";var c=true}else{var a="gray";var c=false}var f=Ext.create("Ext.Panel",{cls:"browserBtn",height:40,html:e.sections[b].name.trim(),style:"color:"+a+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:d,articleContainer:e,isActive:c,section:e.sections[b]});e.sectionArea.add(f);f.element.on({ta},painte},scope:f});d+=1}},sectionTap:function(b,c){if(c.scrollType=="senchaScroller"){if(c.mode=="articles"){var d=c.contentArea.items.items[b.config.position+c.offset].element.dom.offsetLeft;if(d>c.contentArea.getScrollable().getScroller().maxPosition.x){d=c.contentArea.getScrollable().getScroller().maxPosition.x}c.contentArea.getScrollable().getScroller().scrollTo(d+1)}else{if(c.mode=="pages"){var a=c.sections[b.config.position].page;var d=c.contentArea.items.items[0].items.items[a-1].element.dom.offsetLeft;if(d>c.contentArea.getScrollable().getScroller().maxPosition.x){d=c.contentArea.getScrollable().getScroller().maxPosition.x+150}c.contentArea.getScrollable().getScroller().scrollTo(d)}}}else{if(c.mode=="articles"){var d=c.contentArea.items.items[b.config.position+c.offset].element.dom.offsetLeft;if(d>c.contentArea.element.dom.scrollWidth){d=c.contentArea.element.dom.scrollWidth}c.contentArea.element.dom.scrollLeft=parseFloat(d+1)}else{if(c.mode=="pages"){var a=c.sections[b.config.position].page;var d=c.contentArea.items.items[0].items.items[a-1].element.dom.offsetLeft;if(d>c.contentArea.element.dom.scrollWidth){d=c.contentArea.element.dom.scrollWidth+150}c.contentArea.element.dom.scrollLeft=d}}}if(typeof trackReaderEvent!="undefined"){if(c.mode=="pages"){trackReaderEvent("sectionItemClick",{section:b.config.section.name,pageNumber:b.config.section.page})}}},resizeOb:function(){var b=this;if(b.mode=="pages"){var c=40;if(b.sections.length>1){c+=80}}else{var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.dynamic!=null){var c=80;b.expandBtn.show()}else{var c=40;b.expandBtn.hide()}if(b.sections.length>1){c+=80}}},checkSupplements:function(){var a=this;if(settings.menu!=null&&settings.menu.supplements!=null&&settings.menu.supplements.showSupplementsTab=="true"&&settings.menu.supplements.supplement.length>0){a.supplementsTab.setHtml(a.getFormattedName(language.menu.supplements))}else{a.supplementsTab.hide();return}a.supplementsTab.show()},getFormattedName:function(c){c=c.toLowerCase();splitText=c.split(" ");var b="";for(var a in splitText){b+=splitText[a][0].toUpperCase()+splitText[a].substring(1,splitText[a].length).toLowerCase()+" "}return b.trim()},supplementsTabTap:function(b){var a=this;if(b!=null){b.stopPropagation()}if(a.display!="supplements"){a.getComponent("con").removeAll();if(a.scrollType=="senchaScroller"){a.getComponent("con").setScrollable({direction:"horizontal"})}else{a.contentArea.setHeight(210)}a.loadSupplements();a.getComponent("con").setPadding(10,10,10,10)}a.expandBtn.hide();a.nextBtn.hide();a.previousBtn.hide();a.sectionArea.removeAll();a.display="supplements";a.checkSections();if(a.mode=="toggle"){a.animateContainer(a.pagesHeight);a.mode="supplements";if(currentProfile=="desktop"){window.onkeydown=null}a.setModal({style:"opacity:0;"});a.setHideOnMaskTap(true);a.handlePresence()}else{if(a.mode=="articles"){a.animateContainer(a.pagesHeight);a.mode="supplements";if(currentProfile=="desktop"){window.onkeydown=null}a.setModal({style:"opacity:0;"});a.setHideOnMaskTap(true);a.handlePresence()}else{if(a.mode=="pages"){a.animateContainer(a.pagesHeight);a.mode="supplements";a.setHideOnMaskTap(false);a.setModal(false);if(currentProfile=="desktop"){window.onkeydown=null}a.handleAbsence()}else{if(a.mode=="supplements"){a.animateContainer(a.articlesHeight);a.mode="toggle";a.setHideOnMaskTap(false);a.setModal(false);if(currentProfile=="desktop"){if(a.keyDownFunc!=null){window.onkeydown=a.keyDownFunc}}a.handleAbsence()}else{if(a.mode=="start"){a.mode="toggle"}}}}}},loadSupplements:function(){var d=this;var b=d.getComponent("con");if(settings.menu.supplements!=null){var e=settings.menu.supplements.supplement;if(e!=null){for(var c in e){var a=Ext.create("InfinityMobile.view.ReaderSpecialSupplementsItem",{publicationGuid:e[c].guid,publicationName:e[c].name,editionGuid:e[c].editionGuid,width:140,margin:"0px 5px",style:"max-height: 190px;overflow: visible;"});b.add(a)}}}},handlePresence:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},handleAbsence:function(){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME)},prepForArticlePopoverView:function(){var a=this;a.pagesTab.hide();a.articleTab.hide();a.supplementsTab.hide();a.setModal({style:"opacity:0;z-index: 10000000;"});a.setZIndex(10000001)},resetFromArticlePopoverView:function(){var a=this;a.checkPages();a.checkArticles(true);a.checkSupplements();a.setModal(false);a.setZIndex(100000)}},0,["articlescontainer"],["component","container","articlescontainer"],{component:true,container:true,articlescontainer:true},["widget.articlescontainer"],0,[InfinityMobile.view,"ArticlesContainer"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingOptions",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:"60%",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>Clipping Options</b>"},{id:"clippingOptionsToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0",html:"<p style='font-size:12px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><br /><p style='font-size:10px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p>"},{itemId:"clippingScroller",height:"180px",layout:"hbox",scrollable:{direction:"horizontal"}},{itemId:"options",items:[{itemId:"ButtonsDiv"},{itemId:"EmailDiv"}]}]}]},initialize:function(){var a=this;a.toolbar=a.getComponent("clippingOptionsToolBar");a.closeBtn=a.toolbar.getComponent("clippingOptionsToolBarClose");a.bodyContainer=a.getComponent("clippingOptionsBodyContainer");a.clippingScroller=a.bodyContainer.getComponent("clippingScroller");a.options=a.bodyContainer.getComponent("options");if(a.config.images!=null){a.images=a.config.images}if(a.config.widths!=null){a.widths=a.config.widths}if(a.config.heights!=null){a.heights=a.config.heights}a.addThumbnails();a.closeBtn.element.on("tap",function(){a.destroy()});a.options.getComponent("ButtonsDiv").setHtml('<div style="width:100%;background-color:white;padding:10px;height:70px;"><input type="button" onclick="parent.download()" style="margin: 5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" value="Download" /><input type="button" onclick="parent.preview()" value="Preview" style="margin:5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#E6E6E6;background-color:#E6E6E6;border-color:#e6e6e6;width:120px;" type="button" /><input type="button" onclick="parent.deleteClip()"  style="margin:5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#e6e6e6;background-color:#e6e6e6;border-color:#e6e6e6;width:120px;" type="button" value="Delete" /></div>');a.options.getComponent("EmailDiv").setHtml('<div style="height:210px;width:100%;background-color:white;padding:10px;"><div><div style="font-size:12px;width:40%;float:left;padding:10px;"><form>Recipient email address:<br /><input id="emailTxt" style="width:90%" type="textfield" /><br /><br />Subject:<br /><input id="subjectTxt" style="width:90%" type="textfield" /></form></div><div style="font-size:12px;float:right;width:50%;padding:10px;"><form>Message:<br /><textarea id="messageTxt" style="resize:none;width:90%;" rows="4" ></textarea></form></div></div><div style="padding:10px;float:right;"><input type="button" onclick="parent.email()" value="Send" style="margin: 5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" /></div></div>');deleteCli};previe};email=function(){if(document.getElementById("emailTxt").value!=""){var d=false;var b="mailto:"+document.getElementById("emailTxt").value+"?subject='"+document.getElementById("subjectTxt").value+"'&body='"+document.getElementById("messageTxt").value+"<br /><br />";for(var c=0;c<a.images.length;c++){if(a.clippingScroller.innerItems[c].clicked){b+="<img src='"+a.images[c]+"' /><br /><br />";d=true}}if(d){b+="'";if(Ext.browser.userAgent.indexOf("CrOS")!=-1){window.open(b)}else{window.location.href=b}}else{a.promptUser()}}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuEmailPrompt")}};downloa}},addThumbnail},promptUser:function(){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt")},updateImage}},0,["clippingoptions"],["component","container","clippingoptions"],{component:true,container:true,clippingoptions:true},["widget.clippingoptions"],0,[InfinityMobile.view,"ClippingOptions"],0));(Ext.cmd.derive("InfinityMobile.view.clippingPrompt",Ext.Container,{config:{modal:true,centered:true,width:"400px",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingPromptToolBar",height:40,items:[{itemId:"clippingTitle",top:10,left:10}]},{id:"clippingPromptBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingPromptContainerText",margin:"0 0 20px 0"},{itemId:"buttonArea",padding:"20",layout:"hbox",items:[{itemId:"checkbox",flex:1,html:"<input class='check' type='checkbox' ><label style='font-size:10px;padding:5px;'></label></input>"},{itemId:"button",flex:1,cls:"pointerCursor btn",style:"text-align:center;margin: 5px;border-style:solid;height:30px;",layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"btnText",margin:5,style:"font-size:11pt;"}]}]}]}]},initialize:function(){var b=this;var a=b.getComponent("clippingPromptToolBar");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.clippingPromptBody=b.getComponent("clippingPromptBodyContainer");b.buttonArea=b.clippingPromptBody.getComponent("buttonArea");b.button=b.buttonArea.getComponent("button");b.checkbox=b.buttonArea.getComponent("checkbox").element.down(".check");b.bodyText=b.clippingPromptBody.getComponent("clippingPromptContainerText");b.clippingPromptToolBar=b.getComponent("clippingPromptToolBar");b.clippingTitle=b.clippingPromptToolBar.getComponent("clippingTitle");b.clippingTitle.setHtml(language.clippings.createClipping);if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}if(b.config.reader!=null){b.reader=b.config.reader}b.setupText();b.button.element.on({tap:b.okay,scope:b});b.button.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});if(currentProfile=="desktop"){if(navigator.maxTouchPoints){b.buttonArea.getComponent("checkbox").element.on({tap:function(d){var c=$(this.element.dom).find("input");if(c.length>0){if(c[0].checked){c[0].checked=false}else{c[0].checked=true}}},scope:b.buttonArea.getComponent("checkbox")})}}else{b.buttonArea.getComponent("checkbox").element.on({ta},scope:b.buttonArea.getComponent("checkbox")})}if(settings.newsday){b.element.dom.style.borderRadius=""}b.handleKeyDown();mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},handleKeyDow},okay:function(){var b=this;console.log(b.checkbox.dom.checked);window.onkeydown=b.keyDownFunction;if(b.checkbox.dom.checked){try{localStorage.setItem("clippingPrompt"+publicationguid,"set")}catch(a){}b.fireEvent("createClippingBox")}else{if(currentProfile=="desktop"){var d=Ext.create("InfinityMobile.view.ClippingArea",{readerActiveItem:b.readerActiveItem,reader:b.reader})}else{var d=Ext.create("InfinityMobile.view.tablet.ClippingArea",{readerActiveItem:b.readerActiveItem,reader:b.reader})}Ext.Viewport.add(d);d.show();if(currentProfile=="desktop"){var c=InfinityMobile.app.getController("ClippingController").getExtratopbar();if(c!=null){c.setZIndex(0)}}}b.destroy()},setupText:function(){var a=this;if(currentProfile=="desktop"){a.bodyText.setHtml(language.clippings.clippingsHelper+"<br /><br />"+language.clippings.clippingsExplain)}else{a.bodyText.setHtml(language.clippings.clippingsHelperMobile+"<br /><br />"+language.clippings.clippingsExplainMobile)}a.buttonArea.element.down("label").dom.innerHTML=language.clippings.clippingsDontShow;a.button.getComponent("btnText").setHtml(language.ok)}},0,["clippingprompt"],["component","container","clippingprompt"],{component:true,container:true,clippingprompt:true},["widget.clippingprompt"],0,[InfinityMobile.view,"clippingPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingBox",Ext.Container,{config:{height:"1px",width:"100px",fullscreen:true,draggable:{direction:"both",constraint:null},style:"zIndex:10;"},initializ},onDragStar},onDra},onDragFinishe}},0,["clippingbox"],["component","container","clippingbox"],{component:true,container:true,clippingbox:true},["widget.clippingbox"],0,[InfinityMobile.view,"ClippingBox"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLiveAdvertObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",items:[{itemId:"closeBtn",right:0,top:0,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backgroundImage",style:'background-image:url("../assets/article view/article-close-btn.png")'}]}]},initialize:function(){var b=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(b.config.mediaObject!=null){b.mediaObject=b.config.mediaObject}b.setHtml("<iframe style='height:100%;width:100%;' src='"+b.mediaObject.url+"' ></iframe>");b.closeBtn=b.getComponent("closeBtn");try{if(!!b.mediaObject&&!!b.mediaObject.url&&b.mediaObject.url.indexOf("hideclose=true")>=0){b.closeBtn.hide()}}catch(a){console.warn("[ReaderLiveAdvertObject]: Error Caught\n",a)}b.closeBtn.element.on("tap",function(){b.hide()})}},0,["readerliveadvertobject"],["component","container","readermediaobject","readerliveadvertobject"],{component:true,container:true,readermediaobject:true,readerliveadvertobject:true},["widget.readerliveadvertobject"],0,[InfinityMobile.view,"ReaderLiveAdvertObject"],0));(Ext.cmd.derive("InfinityMobile.view.LeftSideAdvertCover",Ext.Container,{config:{height:"100%",width:"100%",top:0,style:"display:block !important;",cls:"leftsidead",items:[{itemId:"tooltip",style:"position:absolute !important;"}]},initializ},setMediaLinkStyl}},0,["leftsideadvertcover"],["component","container","leftsideadvertcover"],{component:true,container:true,leftsideadvertcover:true},["widget.leftsideadvertcover"],0,[InfinityMobile.view,"LeftSideAdvertCover"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLiveArticlePopoverItem",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",style:"background-color:white",layout:"card",items:[{itemId:"content",flex:1,padding:"0 0 10px 0",scrollable:{direction:"vertical",directionLock:true}},{itemId:"contentIframe",layout:"fit",height:"100%"}]},initialize:function(){var a=this;a.content=a.getComponent("content");a.isLive=true;a.painted=false;a.contentIframe=a.getComponent("contentIframe");a.setContentStyle();a.on("painted",a.getContent,a,{delay:10,single:true});a.mode="html";if((a.config.highlightMode!=null&&a.config.highlightMode==true)||(a.config.readAloudMode!=null&&a.config.readAloudMode)){a.mode="frame";a.setActiveItem(a.contentIframe)}},setContentStyle:function(){var a=this;if(currentProfile=="tablet"){a.content.setPadding("0 20px 0 20px")}else{a.content.setPadding("0 15px")}},getContent:function(){var h=this;h.painted=true;var j="";if(h.getPage().headdeck!=null){j="<div class='contentDeck font25'></div><br />"}var c="";if(h.getPage().images!=null){c="<div class='contentImages' >";for(var d=0;d<h.getPage().images.length;d++){c+="<div class='contentImage'><img src='"+h.getPage().images[d].url+"' /></div>"}c+="</div><br />"}var a=h.getPage().headline!=null?h.getPage().headline:"";var e=h.getPage().byline!=null?h.getPage().byline:"";var f=h.getPage().content!=null?h.getPage().content:"";var g="<div class='contentHead font35' >"+a+"</div><br />"+j+c+"<div class='contentByline font15'>"+e+"</div><br /><div class='contentBody font15'>"+f+"</div><br />";var b=g.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(b){g=b[1]}g='<div class="articleContentHtml5" >'+g+"</div>";g+="<script>setText()<\/script>";h.removeSpinner();h.content.setHtml(g);h.setImages();if(h.mode=="frame"){h.setFrame()}if(h.content.element!=null){setText(h.content.element.dom)}h.setStyle({visibility:"inherit"});h.content.element.on({scope:h.content,delegate:".fullStoryLink",tap:function(k){k.stopPropagation();k.preventDefault();if(k.target!=null&&$(k.target).data("url")!=null){window.open($(k.target).data("url"))}}})},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var f=this;var d=1;var c=1;var b=f.id;if(currentProfile=="tablet"){var e=$("#"+b+" img").get(0);if(e!=null){if(e.naturalWidth==0){e.onload=function(){var g=this;if(g.naturalWidth<(screen.width/2)){var h=$("#"+b+" .articleContent")[0];h.className="articleContent float"}}}}}if($("#"+b+" .contentImage").size()>1){if(currentProfile=="phone"){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREVIOUS"}c=$("#"+b+" .contentImage").size();if(c>1){$("#"+b+" .contentImage:gt(0)").hide();$("#"+b+" .previousImage").hide();a()}else{if(c==1){$("#"+b+" .imageControls").hide()}}$("#"+b+" .nextImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").next();h.hide();d++;a();g.fadeIn();$("#"+b+" .previousImage").show();if(g.is("#"+b+" .contentImage:last")){$("#"+b+" .nextImage").hide()}});$("#"+b+" .previousImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").prev();h.hide();d--;a();g.fadeIn();$("#"+b+" .nextImage").show();if(g.is("#"+b+" .contentImage:first")){$("#"+b+" .previousImage").hide()}})}else{$("#"+b+" .imageControls").hide()}function a(){var g="Image "+d.toString()+" of "+c.toString();$("#"+b+" .imageCount").text(g)}},setFram},toggleToTextMode:function(){var a=this;if(a.mode=="html"){if(a.painted){a.setIframeContent()}a.setActiveItem(a.contentIframe);a.mode="frame"}else{a.setActiveItem(a.content);a.mode="html"}},setIframeContent:function(){var h=this;if(h.contentIframe.getHtml()==null){h.contentIframe.setHtml("<iframe class=\"articleiframe\" style='width:100%; height:100%; border:none'></iframe>");var d=h.contentIframe.element.down("iframe").dom;var l="phoneArticle";if(currentProfile=="tablet"){l="tabletArticle"}var a="<div class='"+l+"'>"+h.content.getHtml()+'</div><script>setImages("'+currentProfile+'");<\/script>';var c="";if(typeof customCSS!="undefined"){var n=customCSS.split("|");for(var e=0;e<n.length;e++){var m=atob(n[e]);c+="<link rel='stylesheet' type='text/css' href='"+m+"' />"}}var j="20";if(currentProfile=="phone"){j="15"}var k="<script>cols[i].style.fontSize = font35Size;<\/script>";var g="<style>body { margin:0 } p { margin:0; padding:0; } .articleContentHtml5 { padding: 0 "+j+"px; height: 100% !important; font-size:"+fontEm+"px } .imageControls{ display:none !important; } .contentImage { display:block !important; }</style><script>function setText() {}<\/script><script>function updateText(fontsize) { document.getElementsByClassName('articleContentHtml5')[0].style.fontSize = fontsize + 'px' }<\/script>";var f="<html><head>{{HEAD}}</head><body>{{BODY}}</body></html>";var b="<link rel='stylesheet' type='text/css' href='resources/css/article.css'>"+c+'<script src="resources/js/articleGallery.js?build='+buildguid+'"><\/script>'+g;f=f.replace("{{HEAD}}",b);f=f.replace("{{BODY}}",a);h.iframe=d.contentWindow?d.contentWindow:(d.contentDocument.document?d.contentDocument.document:d.contentDocument);h.iframe.document.write(f)}}},0,["readerlivearticlepopoveritemtablet"],["component","container","readerlivearticlepopoveritemtablet"],{component:true,container:true,readerlivearticlepopoveritemtablet:true},["widget.readerlivearticlepopoveritemtablet"],0,[InfinityMobile.view,"ReaderLiveArticlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReader",Ext.Panel,{showToolBar:true,config:{fullscreen:true,viewType:"dynamic",layout:{type:"vbox"},items:[{itemId:"topBar",height:40,style:"background-color:#1e1e1e;z-index:4;"},{itemId:"content",layout:{type:"hbox"},flex:1}]},initialize:function(){var b=this;var c=b.getComponent("topBar");b.toolBar=c;b.content=b.getComponent("content");b.hasPainted=false;if(currentProfile=="phone"){b.content.setLayout({type:"vbox"});b.content.setScrollable({direction:"vertical",directionLock:true})}$(b.toolBar.element.dom).css("background-color","#"+settings.topbar.backgroundColor);if(settings.dynamic.articleBehaviour=="device"){if("ontouchstart" in window||navigator.msMaxTouchPoints){settings.dynamic.articleBehaviour="momentum"}else{settings.dynamic.articleBehaviour="scrollbar"}}b.element.on({painted:function(){var e=this;if(!e.hasPainted){e.fireEvent("initialized",e);mainPanel.fireEvent("removeSplash");if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(settings.dynamic.rss==null){e.scrollDesktop=e.content.element.down(".x-container").next("div").dom}else{e.scrollDesktop=e.content.element.down(".x-container").next("div").next("div").dom}e.scrollDesktop.style.overflowX="scroll";if(Ext.browser.is.IE){e.content.setScrollable(false);e.scrollDesktop.style.overflowX="";if(settings.dynamic.rss==null){e.scrollDesktop=e.content.element.down(".x-container").next("div").down(".x-scroll-view").dom}else{e.scrollDesktop=e.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").dom}e.scrollDesktop.style.overflowX="scroll";var d=0;var f=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(container in f){d+=$(f[container].element.dom).width()+10}var g=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(interstitial in g){d+=$(g[interstitial].element.dom).width()+5}if(settings.dynamic.rss==null){e.content.element.down(".x-container").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=d+"px"}else{e.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=d+"px"}}e.element.dom.onmousewheel});e.element.dom.addEventListener("DOMMouseScroll})}else{if(currentProfile!="phone"){e.content.setScrollable({direction:"horizontal",directionLock:true})}e.element.dom.onmousewheel});e.element.dom.addEventListener("DOMMouseScroll})}e.hasPainted=true}},scope:b});if(currentProfile=="phone"){b.content.getScrollable().getScroller().on({scroll:function(d){b.loadPhoneImages(d)},scope:b});var a={position:{y:0}};b.on("painted})}},loadPhoneImage},loadReaderPhon}},0,["articlereader"],["component","container","panel","articlereader"],{component:true,container:true,panel:true,articlereader:true},["widget.articlereader"],0,[InfinityMobile.view,"ArticleReader"],0));(Ext.cmd.derive("InfinityMobile.view.NavButton",Ext.Container,{config:{cls:"pointerCursor",width:45,height:100},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.direction!=null){a.direction=a.config.direction}if(!Ext.browser.is.Firefox){a.setShowAnimation("fade");a.setHideAnimation("fadeOut")}a.duration=30;a.timer=null;a.touchTimer=null;a.isTouch=false;if(currentProfile=="desktop"){a.element.on("touchstart",function(d){d.stopPropagation();a.isScrolling=true;var f=InfinityMobile.app.getController("ReaderController").getZoomValue();if(a.direction=="left"){if(f<=1){var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode=="fill"){var b=true}else{var b=false}a.fireEvent("autoTurnLeft",b);mainPanel.fireEvent("autoTurnLeft");mainPanel.fireEvent("trackPreviousClick");a.isScrolling=false}else{a.timer=setInterval(function(){a.fireEvent("scrollLeft");mainPanel.fireEvent("scrollLeft")},a.duration)}}else{if(a.direction=="right"){if(f<=1){var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode=="fill"){var b=true}else{var b=false}a.fireEvent("autoTurnRight",b);mainPanel.fireEvent("autoTurnRight");mainPanel.fireEvent("trackNextClick");a.isScrolling=false}else{a.timer=setInterval(function(){a.fireEvent("scrollRight");mainPanel.fireEvent("scrollRight")},a.duration)}}else{if(a.direction=="up"){a.timer=setInterval(function(){a.fireEvent("scrollUp");mainPanel.fireEvent("scrollUp")},a.duration)}else{a.timer=setInterval(function(){a.fireEvent("scrollDown");mainPanel.fireEvent("scrollDown")},a.duration)}}}});a.element.on("touchend",function(b){b.stopPropagation();clearInterval(a.timer);a.timer=null;if(a.isScrolling){a.fireEvent("trackOnEndPan");a.isScrolling=false}});a.element.on("touchleave",function(b){b.stopPropagation();clearInterval(a.timer);a.timer=null;if(a.isScrolling){a.fireEvent("trackOnEndPan");a.isScrolling=false}})}else{a.element.dom.addEventListener("touchleave",function(){clearInterval(a.timer);a.timer=null});a.element.dom.addEventListener("touchstart",function(d){d.stopPropagation();var f=InfinityMobile.app.getController("ReaderController").getZoomValue();if(a.direction=="left"){if(f<=1){var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode=="fill"){var b=true}else{var b=false}a.fireEvent("autoTurnLeft",b);mainPanel.fireEvent("autoTurnLeft")}else{a.timer=setInterval(function(){a.fireEvent("scrollLeft");mainPanel.fireEvent("scrollLeft")},a.duration)}}else{if(a.direction=="right"){if(f<=1){var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode=="fill"){var b=true}else{var b=false}a.fireEvent("autoTurnRight",b);mainPanel.fireEvent("autoTurnRight")}else{a.timer=setInterval(function(){a.fireEvent("scrollRight");mainPanel.fireEvent("scrollRight")},a.duration)}}else{if(a.direction=="up"){a.timer=setInterval(function(){a.fireEvent("scrollUp");mainPanel.fireEvent("scrollUp")},a.duration)}else{a.timer=setInterva},a.duration)}}}});a.element.dom.addEventListener("touchend})}}},0,["navbutton"],["component","container","navbutton"],{component:true,container:true,navbutton:true},["widget.navbutton"],0,[InfinityMobile.view,"NavButton"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuEmailPrompt",Ext.Container,{config:{modal:true,centered:true,width:"30%",style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true},initializ}},0,["clippingmenuemailprompt"],["component","container","clippingmenuemailprompt"],{component:true,container:true,clippingmenuemailprompt:true},["widget.clippingmenuemailprompt"],0,[InfinityMobile.view,"ClippingMenuEmailPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuPreview",Ext.Container,{config:{centered:true,height:"100%",width:"100%",fullscreen:true,layout:"vbox",zIndex:99999999999999,style:"background-color:black;",items:[{itemId:"topbar",height:40,width:"100%",layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"counter",style:"color:white;"},{itemId:"close",right:0,top:0,height:40,width:40,cls:"pointerCursor",style:'background-image:url("resources/images/reader icons/close btn.png");background-size:70%;background-position:center;background-repeat:no-repeat;'}]},{itemId:"galleryContainer",flex:1,width:"100%",layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"previous",cls:"preview-btn pointerCursor",width:30,height:"100%",margin:"0 10 0 10"},{itemId:"carousel",xtype:"carousel",height:"100%",flex:1},{itemId:"next",cls:"preview-btn pointerCursor",width:30,height:"100%",margin:"0 10 0 10"}]}]},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);a.setupVars();a.setupAppearance();a.getImagesLength();a.setupEventListeners();a.setupImages()},setupVars:function(){var a=this;a.topbar=a.getComponent("topbar");if(a.topbar!=null){a.counter=a.topbar.getComponent("counter");a.closeBtn=a.topbar.getComponent("close")}a.galleryContainer=a.getComponent("galleryContainer");if(a.galleryContainer!=null){a.previousBtn=a.galleryContainer.getComponent("previous");a.galleryCarousel=a.galleryContainer.getComponent("carousel");a.nextBtn=a.galleryContainer.getComponent("next")}if(a.config.images!=null){a.images=a.config.images}if(a.config.clippingMenu!=null){a.clippingMenu=a.config.clippingMenu}a.ofTxt="of";a.imageTxt="Image";if(typeof language!="undefined"){a.ofTxt=language.of;a.imageTxt=language.image}},setupAppearance:function(){var a=this;a.previousBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-back-ic.png')",backgroundPosition:"center",backgroundSize:"70%",backgroundRepeat:"no-repeat"});a.nextBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-next-ic.png')",backgroundPosition:"center",backgroundSize:"70%",backgroundRepeat:"no-repeat"})},setupImages:function(){var b=this;for(var a=0;a<b.images.length;a++){if(b.clippingMenu.clippingsContainer.innerItems[a].clicked){var d=b.images[a];if(location.protocol=="https:"){d=d.replace("http://media.cdn.pagesuite.com","https://media.pagesuite.com")}var c=Ext.create("Ext.Container",{style:{maxHeight:($(document).height()-80),maxWidth:($(document).width()-80),padding:"10px",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)",webkitTransform:"translate(-50%,-50%)",mozTransform:"translate(-50%,-50%)",msTransform:"translate(-50%,-50%)",backgroundImage:"url('"+d+"')",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"}});b.galleryCarousel.add(c)}}},setupEventListeners:function(){var a=this;if(a.closeBtn!=null&&a.closeBtn.element!=null){a.closeBtn.element.on({tap:function(){a.destroy()},scope:a})}if(a.galleryCarousel!=null){a.galleryCarousel.on({activeitemchange:a.handleItemChange,scope:a})}if(a.previousBtn!=null){a.previousBtn.element.on({tap:a.previous,scope:a})}if(a.nextBtn!=null){a.nextBtn.element.on({tap:a.next,scope:a})}$(window).on("resize})},destro},handleItemChange:function(){var b=this;var a=parseInt(b.galleryCarousel.getActiveIndex())+1;b.counter.setHtml(b.imageTxt+" "+a+" "+b.ofTxt+" "+b.imagesLength)},previous:function(){var a=this;if(a.galleryCarousel!=null){a.galleryCarousel.previous()}},next:function(){var a=this;if(a.galleryCarousel!=null){a.galleryCarousel.next()}},getImagesLength:function(){var b=this;b.imagesLength=0;for(var a=0;a<b.images.length;a++){if(b.clippingMenu.clippingsContainer.innerItems[a].clicked){b.imagesLength++}}}},0,["clippingmenupreview"],["component","container","clippingmenupreview"],{component:true,container:true,clippingmenupreview:true},["widget.clippingmenupreview"],0,[InfinityMobile.view,"ClippingMenuPreview"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuPrompt",Ext.Container,{config:{modal:true,centered:true,width:300,style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true},initializ}},0,["clippingmenuprompt"],["component","container","clippingmenuprompt"],{component:true,container:true,clippingmenuprompt:true},["widget.clippingmenuprompt"],0,[InfinityMobile.view,"ClippingMenuPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuDeletePrompt",Ext.Container,{config:{modal:true,centered:true,width:300,style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true},initializ},deleteItem}},0,["clippingmenudeleteprompt"],["component","container","clippingmenudeleteprompt"],{component:true,container:true,clippingmenudeleteprompt:true},["widget.clippingmenudeleteprompt"],0,[InfinityMobile.view,"ClippingMenuDeletePrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuThumb",Ext.Panel,{config:{height:"180px"},initializ}},0,["clippingmenuthumb"],["component","container","panel","clippingmenuthumb"],{component:true,container:true,panel:true,clippingmenuthumb:true},["widget.clippingmenuthumb"],0,[InfinityMobile.view,"ClippingMenuThumb"],0));(Ext.cmd.derive("InfinityMobile.view.PrintMenu",InfinityMobile.view.Overlay,{config:{width:700,height:700,style:"padding:0px",layout:"vbox",items:[{itemId:"toolbar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"toolbarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"body",cls:"overlaybody",flex:1,padding:25,layout:"vbox",items:[{itemId:"desc"},{itemId:"buttonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"selectAll",cls:"pointerCursor",width:150,items:[{itemId:"btnText"}]},{itemId:"selectAllMargin",width:25},{itemId:"selectNone",cls:"pointerCursor",width:150,items:[{itemID:"btnText"}]},{itemId:"selectNoneMargin",width:25},{itemId:"print",cls:"pointerCursor",width:150,items:[{itemId:"btnText"}]}]},{itemId:"printItems",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:150,margin:"0 6 10 6"}}]}]},initialize:function(){var d=this;var c=d.getComponent("toolbar");d.toolbarClose=c.getComponent("toolbarClose");c.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var a=d.getComponent("body");var b=a.getComponent("buttonsContainer");d.selectAll=b.getComponent("selectAll");d.selectAllMargin=b.getComponent("selectAllMargin");d.selectNone=b.getComponent("selectNone");d.selectNoneMargin=b.getComponent("selectNoneMargin");d.print=b.getComponent("print");d.title=c.getComponent("title");d.title.setHtml(language.print.print);d.desc=a.getComponent("desc");d.desc.setHtml(language.print.printContainerText);d.selectAll.getComponent("btnText").setHtml(language.print.selectAll);d.checkSelectAll();d.selectNone.getComponent("btnText").setHtml(language.print.printSelectNone);d.print.getComponent("btnText").setHtml(language.print.print);d.setCloseListener();d.setSelectAllListener();d.setSelectNoneListener();d.setPrintListener();d.printItemsContainer=a.getComponent("printItems");d.loadPages()},checkSelectAll:function(){var a=this;if(settings.menu.printSinglePageOnly!=null&&settings.menu.printSinglePageOnly=="true"){a.selectAll.hide();a.selectAllMargin.hide();a.selectNone.hide();a.selectNoneMargin.hide()}},setCloseListener:function(){var a=this;a.toolbarClose.element.on("tap",function(){a.fireEvent("close",a)})},setSelectAllListene},setSelectNoneListener:function(){var a=this;a.selectNone.element.on("tap",function(){a.fireEvent("selectNone",a)})},setPrintListene},loadPage},hid}},0,["printmenu"],["component","container","panel","overlay","printmenu"],{component:true,container:true,panel:true,overlay:true,printmenu:true},["widget.printmenu"],0,[InfinityMobile.view,"PrintMenu"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderAudioObject",InfinityMobile.view.ReaderMediaObject,{config:{items:[{itemId:"closeBtn",right:0,top:-25,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backImage",style:'background-size:contain;background-image:url("../assets/article view/article-close-btn.png");'}]}],mediaObject:""},initialize:function(){var b=this;console.log("HITTING AUDIO");InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);b.fileGuid=b.mediaObject.file;var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);console.log(b);var d=window.location.protocol+"//pages.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+".mp3";b.setHtml('<audio controls ><source src="'+d+'" type="audio/mpeg"></audio>');b.setHeight(0);b.getComponent("closeBtn").element.on("tap",function(){b.hide()})}},0,0,["component","container","readermediaobject"],{component:true,container:true,readermediaobject:true},0,0,[InfinityMobile.view,"ReaderAudioObject"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutZoomSlider",InfinityMobile.view.LayoutView,{config:{style:"color:white;top:25%;display:inline-block;",items:[{itemId:"tooltipZoomIn",cls:"tooltip",hidden:true,style:"z-index:10000"},{itemId:"tooltipZoomOut",cls:"tooltip",hidden:true,style:"z-index:10000"}]},initializ},tooltipRigh},zoom:function(){var a=this;if(!a.startedZoom){a.fireEvent("zoomStart",a,a.sliderElement.dom.value);a.startedZoom=true}else{a.fireEvent("zoom",a,a.sliderElement)}},zoomin},zoomEn}},0,["zoomslider"],["component","container","layoutview","zoomslider"],{component:true,container:true,layoutview:true,zoomslider:true},["widget.zoomslider"],0,[InfinityMobile.view,"LayoutZoomSlider"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuImageScroller",Ext.Container,{config:{flex:1,itemId:"scrollerContainer",scrollable:"horizontal",indicator:false,layout:"hbox"}},0,["clippingmenuimagescroller"],["component","container","clippingmenuimagescroller"],{component:true,container:true,clippingmenuimagescroller:true},["widget.clippingmenuimagescroller"],0,[InfinityMobile.view,"ClippingMenuImageScroller"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenu",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:"60%",height:"wrap",fullscreen:true,items:[{itemId:"header",items:[{itemId:"title",items:[{id:"clippingToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"description",html:"<div style='background-color:white;border: 1px solid black;border-top:none;border-bottom:none;padding:10px;'><p style='font-size:12px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><br /><p style='font-size:10px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p></div>"}]},{itemId:"clipping",xtype:"clippingmenuimagescroller",height:"180px",layout:"hbox",width:"100%",style:"background-color:red;padding:10px;border: 1px solid black;border-top:none;border-bottom:none;"},{itemId:"options",style:"background-color:white;height:wrap;",items:[{itemId:"ButtonsDiv"},{itemId:"EmailDiv"}]}]},initialize:function(){var a=this;var b=a;if(a.config.images!=null){a.images=a.config.images}a.getComponent("header").getComponent("title").getComponent("clippingToolBarClose").element.on("tap});a.getComponent("header").getComponent("title").setHtml('<div style="background-color:#E6E6E6;padding-top:10px;padding-left:5px;padding-right:5px;padding-bottom:10px;border:1px solid black;border-bottom:none;border-top-left-radius:5px;border-top-right-radius:5px;"><h1 style="font-size:16px;">Clipping Options</h1></div>');a.addThumbnails();a.getComponent("options").getComponent("ButtonsDiv").setHtml('<div style="width:100%;background-color:white;padding:10px;height:70px;border: 1px solid black;border-top:none;border-bottom:none;"><input type="button" onclick="parent.download()" style="margin: 5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" value="Download" /><input type="button" onclick="parent.preview()" value="Preview" style="margin:5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#E6E6E6;background-color:#E6E6E6;border-color:#e6e6e6;width:120px;" type="button" /><input type="button" onclick="parent.deleteClip()"  style="margin:5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#e6e6e6;background-color:#e6e6e6;border-color:#e6e6e6;width:120px;" type="button" value="Delete" /></div>');a.getComponent("options").getComponent("EmailDiv").setHtml('<div style="height:210px;width:100%;background-color:white;padding:10px;border: 1px solid black;border-top:none;border-bottom:none;border-bottom-left-radius:5px;border-bottom-right-radius:5px;"><div><div style="font-size:12px;width:40%;float:left;padding:10px;"><form>Recipient email address:<br /><input id="emailTxt" style="width:90%" type="textfield" /><br /><br />Subject:<br /><input id="subjectTxt" style="width:90%" type="textfield" /></form></div><div style="font-size:12px;float:right;width:50%;padding:10px;"><form>Message:<br /><textarea id="messageTxt" style="resize:none;width:90%;" rows="4" ></textarea></form></div></div><div style="padding:10px;float:right;"><input type="button" onclick="parent.email()" value="Send" style="margin: 5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" /></div></div>');downloa};deleteCli};previe};email=function(){if(document.getElementById("emailTxt").value!=""){var e=false;var c="mailto:"+document.getElementById("emailTxt").value+"?subject='"+document.getElementById("subjectTxt").value+"'&body='"+document.getElementById("messageTxt").value+"<br /><br />";for(var d=0;d<b.images.length;d++){if(b.getComponent("clipping").innerItems[d].clicked){c+="<img src='"+a.images[d]+"' /><br /><br />";e=true}}if(e){c+="'";if(Ext.browser.userAgent.indexOf("CrOS")!=-1){window.open(c)}else{window.location.href=c}}else{a.promptUser()}}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuEmailPrompt")}}},addThumbnail},deleteItem},promptUse},updateImage}},0,["clippingmenu"],["component","container","clippingmenu"],{component:true,container:true,clippingmenu:true},["widget.clippingmenu"],0,[InfinityMobile.view,"ClippingMenu"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLanguagePopup",InfinityMobile.view.Overlay,{config:{width:300,height:300,style:"padding:0px",layout:"vbox",hideOnMaskTap:false,items:[{itemId:"languageToolBar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>Language</b>"},{itemId:"downloadToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"languageContent",layout:"vbox",padding:20,flex:1,items:[{flex:1,html:"We have noticed your Browser Language is different to the language of your publication. Would you like us to update the text to match your Browser Language."},{itemId:"languageButtonsContainer",height:40,layout:"hbox",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"updateButton",flex:1,style:"background-color:#458fbb; color:white",items:[{html:"Update"}]},{width:20},{itemId:"cancelButton",flex:1,style:"background-color:#458fbb; color:white",items:[{html:"Cancel"}]}]}]}]},initializ},setCancelListene},setUpdateListene}},0,["readerlanguage"],["component","container","panel","overlay","readerlanguage"],{component:true,container:true,panel:true,overlay:true,readerlanguage:true},["widget.readerlanguage"],0,[InfinityMobile.view,"ReaderLanguagePopup"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOLinkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",html:'<img class="newsdayObject" style="height100%;width:100%;image-rendering: -webkit-optimize-contrast;  image-rendering: crisp-edges;  -webkit-backface-visibility: hidden; -ms-transform: translateZ(0); -webkit-transform: translateZ(0); transform: translateZ(0);" src="./resources/images/link.png" />'},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.on({tap:"onTap",painted:function(){var c=this;try{if(Ext.os.is.iOS||Ext.browser.is.Safari){var d=c.element.down("img");var e=d.dom||null;if(e!=null){e.style.imageRendering=""}}}catch(b){console.error("[ReaderOLinkObject]: Error Caught",b)}},scope:a})},setMediaObjectStyle:function(){var a=this;a.mediaObject.backgroundAlpha=0;InfinityMobile.view.ReaderMediaObject.prototype.setMediaObjectStyle.apply(this,arguments)},onTap:function(){var c=this;var b=c.mediaObject.url;if(typeof trackReaderEvent!="undefined"){var a=c.mediaObject.page;var d=InfinityMobile.app.getController("MediaController").getSectionName(a);trackReaderEvent("link",{url:b,pageNum:a,section:d})}window.open(b)}},0,["readerolinkobject"],["component","container","readermediaobject","readerolinkobject"],{component:true,container:true,readermediaobject:true,readerolinkobject:true},["widget.readerolinkobject"],0,[InfinityMobile.view,"ReaderOLinkObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOVideo",Ext.Container,{config:{fullscreen:true,modal:true,cls:"ovideo",style:"background-color:black;",height:"100%",width:"100%",layout:"vbox",zIndex:99999999,items:[{itemId:"closeBtn",right:10,top:10,width:40,height:40,zIndex:99999999,cls:"backgroundImage pointerCursor",style:"background-image:url('resources/images/article-close-btn-white.png');background-size:contain;"},{itemId:"videoArea",flex:1,layout:"vbox",items:[{itemId:"video",style:"background-color:black;",flex:2},{itemId:"caption",width:"100%",style:"background-color:#333333;color:white;padding: 10px;",docked:"bottom",flex:1}]}]},initialize:function(){var a=this;a.start=false;a.advertPlayed=false;a.videoArea=a.getComponent("videoArea");a.video=a.videoArea.getComponent("video");a.advertId="preroll"+a.id;a.captionArea=a.getComponent("videoArea").getComponent("caption");if(a.config.url!=null){a.url=a.config.url}if(a.config.videoContentView!=null){a.videoContentView=a.config.videoContentView}a.getComponent("closeBtn").element.on({tap:"close",scope:a});a.setupLoadingIcon();a.requestVideo()},requestVideo:function(){var b=this;console.log("Requesting video");if(b.url!=null&&b.url.length>0&&b.url.indexOf("http://")!=-1){var a=b.url.substring(7,b.url.length);if(b.useSettingDrivenUrl()){a=a.replace("ace-stage.newsday.com/","");this.purl=b.returnFormattedUrl(settings.newsday.atexMediaUrl);a="../../Newsday/getAtex.aspx?url="+this.purl+a+"?device=ipad-4&_dc=1445010088130&limit=25"}else{var c="www.newsday.com";if(settings.newsday.useStageFeedDomain!=null&&settings.newsday.useStageFeedDomain=="true"){c="stage.newsday.com"}if(settings.newsday.useUpdatedAtexFeed!=null&&settings.newsday.useUpdatedAtexFeed=="true"){a="../../Newsday/getAtex.aspx?url=http://"+c+"/json/"+a+"?device=ipad2&_dc=1445010088130&limit=25"}else{a="../../Newsday/getatex.aspx?url=http://"+c+"/iosfeeds/"+a+"?device=ipad2&_dc=1445010088130&limit=25"}}console.log(a);$.ajax({type:"GET",url:a,data:{get_param:"value"},dataType:"json",success:function(d){b.setupVideo(d)},erro}})}},returnFormattedUrl:function(a){return !!a&&a[a.length-1]!="/"?(location.protocol+"//"+a+"/"):(location.protocol+"//"+a)},useSettingDrivenUrl:function(){return typeof settings!="undefined"&&settings.newsday!=null&&!!settings.newsday.atexMediaUrl},setupVide},writeBrightCoveVideoHtml:function(b){var g=this;try{if(g.useSettingDrivenUrl()&&b.omniture==null&&b.content.pagedata!=null){b.omniture=b.content.pagedata;if(b.content.pagedata.pagename!=null){b.omniture.pageName=b.content.pagedata.pagename}b.omniture.hierarchy=b.content.pagedata.hier}var h=b.content.brightcove_id!=null?b.content.brightcove_id:b.content.brightCoveAssetId,j=b.content.keywordCategory,n=b.content.purl!=null?b.content.purl:this.purl,e=b.content!=null&&b.content.brightCoveRefId!=null?b.content.brightCoveRefId.replace("policy_",""):"",o="video-js",m=n.split("/"),l=b!=null&&b.omniture!=null&&b.omniture.hierarchy!=null?b.omniture.hierarchy.split(":"):["","","",""],a=l[2],d=l[3],c=l[4]==null?l[3]:l[4];if(currentProfile!="desktop"){if(!g.advertPlayed&&settings.newsday.preRoll!=null){o+=" ad-plays-inline"}}g.video.setHtml('<video id="'+g.id+'video"data-video-id="'+h+'" data-account="2014288409001" data-player="S1u7fVkil" data-embed="default" data-application-id data-keywordcategory="'+j+'" data-purl="'+n+'" data-pid="'+e+'" data-media-channel="'+a+'" data-media-subsection-01="'+d+'" data-media-subsection-02="'+c+'" data-content-view="'+g.videoContentView+'" class="'+o+'" controls preload="metadata" onpause="parent.onpause(this)" oncanplay="parent.autoplay(this)"onplay="parent.onplay(this)" onended="parent.autoclose(this)" style="position:absolute;top:0px;right:0px;bottom:0px;left:0px;width:100%;height:100%;" ></video><div class="advert" style="height: 100%; width: 100%; position: absolute; top: 0px; z-index: 99999; display: none;"></div>');g.captionArea.setHtml("<div style='width:100%;color:white;padding:10px;'><p>"+b.content.caption+"</p></div>");g.videoElement=document.getElementById(g.id+"video");g.hasInitEvent=false;g.loadingIcon.destroy();console.log(b);b.omniture.pageName=b.omniture.pageName.replace("ipad - ","");b.omniture.hierarchy=b.omniture.hierarchy.replace("ipad:","");if(typeof bc!="undefined"){var k=g.videoElement;g.player=bc(k)}if(typeof bc!="undefined"&&!g.hasInitEvent){g.hasInitEvent=true;g.fireEvent("videoInit",g,b)}}catch(f){console.error("[ReaderOVideo]: Error Caught \n",f);g.fireEvent("oVideoError",g)}},writeVideoHtml:function(b){var a=this;a.video.setHtml('<video style="z-index:0;"  onpause="parent.onpause(this)" onplay="parent.onplay(this)" oncanplay="parent.autoplay(this)" onended="parent.autoclose(this)" id="'+a.id+'video" class="video-js vjs-default-skin small-player" controls preload="auto" width="100%" height="100%" data-setup=\'{"example_option":true}\' poser="http://video-js.zencoder.com/oceans-clip.png" playsinline><source src="'+b.content.mp4+'" type="video/mp4" /><p class="vjs-no-js">Not a compatible browser</p></video><div class=\'advert\' style=\'height:100%;width:100%;position:absolute;top:0px;z-index:99999;display:none;\'></div>');videojs(a.id+"video",{},function(){var d=document.getElementById(a.id+"video");var c=$(a.videoArea.element.dom).find(".x-innerhtml")[0];$(c).css("height","100%");a.loadingIcon.destroy()});a.captionArea.setHtml("<div style='width:100%;color:white;padding:10px;'><p>"+b.content.caption+"</p></div>");b.omniture.pageName=b.omniture.pageName.replace("ipad - ","");b.omniture.hierarchy=b.omniture.hierarchy.replace("ipad:","");window.addEventListener("keyup",a.showFullscreenOnEsc);if(isFullscreen){$(".vjs-fullscreen-control").addClass("hide-fullscreen-control")}a.fireEvent("ovideoinitialized",a,b)},setupVideoEvents:function(b){var a=this;autoplay=function(c){};autoclose=function(c){a.autoclose(c,b)};onplay=function(c){a.onplay(c,b)};onpause=function(c){a.onpause(c,b)}},onpause:function(c,e){var b=this;if(typeof trackReaderEvent!="undefined"&&!c.ended){var f=c.currentTime;var a="pause";var d=new Object();d.event=a;d.progress=f;d.duration=c.duration;b.fireEvent("trackOVideoPause",b,e,d)}},onplay:function(c,e){var b=this;if(!b.advertPlayed&&settings.newsday.preRoll!=null){b.initializeAdsDisplayContainer(c,e)}if(c.parentElement.classList.contains("ad-plays-inline")){return}if(typeof trackReaderEvent!="undefined"){var f=c.currentTime;var a="play";if(!b.start){b.start=true;a="start";f="0"}var d=new Object();d.event=a;d.progress=f;d.duration=c.duration;b.fireEvent("trackOVideoPlay",b,e,d)}},initializeAdsDisplayContainer:function(d,f){var c=this;var e=document.getElementById(c.id+"video");var a=document.getElementsByClassName("advert")[0];console.log(a);try{var g=new google.ima.AdDisplayContainer(a,d);g.initialize();d.pause();c.advertPlayed=true;c.loadInline=false;if(Ext.os.is.iOS){c.loadInline=true}c.requestAds(g,a,d,f)}catch(b){console.error("ERROR: Setting up pre-roll adverts",b);d.play()}},autoplay:function(b,c){var a=this;if(!a.advertPlayed&&settings.newsday.preRoll!=null){a.initializeAdsDisplayContainer(b,c)}else{if(!a.hasAutoPlayed){b.play();a.hasAutoPlayed=true}}},autoclose:function(b,d){if(typeof trackReaderEvent!="undefined"){var e=b.currentTime;var a="complete";var c=new Object();c.event=a;c.progress=e;c.duration=b.duration;me.fireEvent("trackOVideoComplete",me,d,c)}me.destroy()},requestAds:function(b,j,a,d){var g=this;var f=new google.ima.AdsLoader(b);onAdsManagerLoaded=function(n){adsManager=n.getAdsManager(a);var m=function(){$(j).css("display","none");var p=false;if(g.loadInline){a.src=d.content.mp4}g.checkErrors(a,d);if(g.loadInline){setTimeout(function(){a.play()},500)}else{a.play()}g.fireEvent("preRollEnded",g)};adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,h);adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,m);try{$(j).css("display","");adsManager.init(j.clientWidth,j.clientHeight,google.ima.ViewMode.NORMAL);g.oVideoResize=function(){console.log("CHANGE");if(typeof adsManager!="undefined"&&adsManager!=null){adsManager.resize(j.clientWidth,j.clientHeight,google.ima.ViewMode.NORMAL)}};window.addEventListener("resize",g.oVideoResize);adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,function(p){g.fireEvent("preRollStarted",g,p.getAd())});adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPE});adsManager.start();g.advertPlayed=true}catch(o){}};var h=function(m){console.log(m.getError());$(j).css("display","none");a.parentElement.classList.remove("ad-plays-inline");a.play();if(typeof adsManager!="undefined"&&adsManager!=null&&adsManager.destroy!=null){adsManager.destroy()}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("videoAdvertError")}};f.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,onAdsManagerLoaded,false);f.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,h,false);var c=function(){f.contentComplete()};a.onended=c;var l=settings.newsday.preRoll.adTag;var k=settings.newsday.preRoll.size;var e=new google.ima.AdsRequest();e.adTagUrl="http://pubads.g.doubleclick.net/gampad/ads?sz="+k+"&iu="+l+"&ciu_szs=&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&m_ast=vast&url=[referrer_url]&correlator=[timestamp]";e.linearAdSlotWidth=640;e.linearAdSlotHeight=400;e.nonLinearAdSlotWidth=640;e.nonLinearAdSlotHeight=150;if(!g.loadInline){}f.requestAds(e)},checkErrors:function(b,c){var a=b.getAttribute("data-videojs-error");if(a!=null){var d=parseInt(a,10);switch(d){case 1:break;case 2:break;case 3:break;case 4:b.children[0].type="video/mp4";b.children[0].src=c.content.mp4;b.load();break;case 5:break;case"Unknown":break}}},onAdsManagerLoade},showFullscreenOnEsc:function(b){var a=b.keyCode||b.which;if(a==122){b.preventDefault();b.stopPropagation();if(isFullscreen){$(".vjs-fullscreen-control").addClass("hide-fullscreen-control")}else{$(".vjs-fullscreen-control").removeClass("hide-fullscreen-control")}}if(a==27){$(".vjs-fullscreen-control").removeClass("hide-fullscreen-control")}},setupLoadingIcon:function(){var a=this;a.loadingIcon=Ext.create("Ext.Panel",{config:{modal:true,height:"100%",width:"100%",centered:true},initializ}});a.loadingIcon.show()},close:function(){var a=this;console.log("CLOSING");if(a.oVideoResize!=null&&typeof a.oVideoResize=="function"){window.removeEventListener("resize",a.oVideoResize)}window.removeEventListener("keyup",a.showFullscreenOnEsc);a.fireEvent("closeOVideo",a)},destroy:function(){this.removeAll(true);Ext.Container.prototype.destroy.apply(this,arguments)}},0,["readerovideo"],["component","container","readerovideo"],{component:true,container:true,readerovideo:true},["widget.readerovideo"],0,[InfinityMobile.view,"ReaderOVideo"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOGallery",Ext.Container,{config:{fullscreen:true,modal:true,style:"background-color:black;",height:"100%",width:"100%",zIndex:99999999,layout:{type:"vbox"},items:[{itemId:"content",flex:1,width:"100%",layout:{type:"hbox"},items:[{itemId:"closeBtn",right:10,top:10,width:40,height:40,cls:"backgroundImage pointerCursor",style:"background-image:url('resources/images/article-close-btn-white.png');background-size:contain;"},{itemId:"images",directionLock:true,height:"100%",width:"100%",style:"background-color:black;"},{itemId:"caption",bottom:0,width:"100%",style:"background-color:black;opacity:0.8;color:white;padding: 10px;max-height:200px;",hidden:true,flex:1,scrollable:{directionLock:true,direction:"vertical"}}]},{itemId:"navBar",docked:"bottom",height:40,width:"100%",layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"prev",width:25,style:"text-align:center",html:'<i class="fa fa-angle-left fa-lg" aria-hidden="true"></i>'},{itemId:"counter",margin:"0px 20px 0px 20px"},{itemId:"next",width:25,style:"text-align:center",html:'<i class="fa fa-angle-right fa-lg" aria-hidden="true"></i>'},{itemId:"captionIcon",cls:"captionicon",right:0,padding:10,html:'<i class="fa fa-info-circle fa-lg" aria-hidden="true"></i>'}]}]},initialize:function(){var k=this;k.content=k.getComponent("content");k.navBar=k.getComponent("navBar");k.navBar.setStyle({backgroundColor:"#"+settings.topbar.backgroundColor,color:"#"+settings.topbar.color});if(k.config.article!=null){k.article=k.config.article}k.captionIcon=k.navBar.getComponent("captionIcon");k.captionIcon.element.on({tap:k.caption,scope:k});k.previousBtn=k.navBar.getComponent("prev");k.nextBtn=k.navBar.getComponent("next");k.counter=k.navBar.getComponent("counter");if(k.config.url!=null){k.url=k.config.url;k.captions=[];k.content.getComponent("closeBtn").element.on({tap:"close",scope:k});var b=Ext.create("InfinityMobile.view.ReaderOGalleryLoading",{});if(k.useSettingDrivenUrl()){var c=k.url.replace("ace-stage.newsday.com/","").replace("http://","");c="../../Newsday/getAtex.aspx?url="+k.returnFormattedUrl(settings.newsday.atexMediaUrl)+c+"?device=ipad-4&_dc=1445010088130&limit=25"}else{if(k.url.indexOf("http://")!=-1){var c=k.url.substring(7,k.url.length)}else{c=k.url}c="../../Newsday/getatex.aspx?url=http://www.newsday.com/iosfeeds/"+c+"?device=phone&_dc=1445010088130&limit=25"}$.ajax({type:"GET",url:c,data:{get_param:"value"},dataType:"json",complete:function(){b.destroy()},success:function(n){var l=[];k.images=n.content.images;for(var m=0;m<n.content.images.length;m++){var p={imageUrl:n.content.images[m].image_path,pageNo:m,config:{pageNo:m}};k.captions[m]=n.content.images[m].caption;l[l.length]=p}k.counter.setHtml("1 of "+k.captions.length);if(k.captions[0]!=null){if(k.captions[0].trim().length>0){k.captionIcon.show()}else{k.captionIcon.hide()}}else{k.captionIcon.hide()}k.setupCarousel(l);k.data=n;var o="1 of "+k.captions.length;if(n.content.pagedata!=null&&n.omniture==null){k.data.omniture=n.omniture=n.content.pagedata;if(n.content.pagedata.pagename!=null){n.omniture.pageName=n.content.pagedata.pagename}k.data.omniture.hierarchy=n.omniture.hierarchy=n.content.pagedata.hier}k.fireEvent("ogalleryinitialized",k,n,o)}})}else{if(k.config.images!=null){k.images=k.config.images;k.captions=[];k.content.getComponent("closeBtn").element.on({tap:"close",scope:k});var b=Ext.create("InfinityMobile.view.ReaderOGalleryLoading",{});var d=[];for(var h=0;h<k.images.length;h++){var f={imageUrl:k.images[h].url,pageNo:h,config:{pageNo:h}};d[d.length]=f;var e="";if(k.images[h].credit!=null){if(k.images[h].credit.trim().length>0){e=" ("+k.images[h].credit+")"}}k.captions[h]=k.images[h].caption+e}b.destroy();k.counter.setHtml("1 of "+k.captions.length);if(k.captions[0]!=null){if(k.captions[0].trim().length>0){k.captionIcon.show()}else{k.captionIcon.hide()}}else{k.captionIcon.hide()}k.setupCarousel(d);var j="1 of "+k.captions.length;var a=k.article.byline;if(k.article.reporters!=null&&k.article.reporters.length>0){for(var h in k.article.reporters){a+=", "+k.article.reporters[h].name}}var g={author:a,contentTitle:k.article.headline,contentType:"photolist"};k.fireEvent("ogalleryinitializedArticle",k,g,j)}}k.previousBtn.element.on({tap:function(){k=this;k.carousel.previous()},scope:k});k.nextBtn.element.on({tap:function(){k=this;k.carousel.next()},scope:k})},returnFormattedUrl:function(a){return !!a&&a[a.length-1]!="/"?(location.protocol+"//"+a+"/"):(location.protocol+"//"+a)},useSettingDrivenUrl:function(){return typeof settings!="undefined"&&settings.newsday!=null&&!!settings.newsday.atexMediaUrl},close:function(){var a=this;a.fireEvent("closeOGallery",a)},caption:function(){var b=this;if(b.content.getComponent("caption").isHidden()){b.index=b.carousel.getActiveItem().getPageNo();if(b.captions[b.index].length>0){var c=b.images!=null&&b.images[b.index].image_title!=null&&b.images[b.index].image_title!=""?"<p style='font-weight:bold;'>"+b.images[b.index].image_title+"</p>":"";b.content.getComponent("caption").setHtml("<div style='width:100%;color:white;padding:10px;'>"+c+"<p>"+b.captions[b.index]+"</p></div>");b.content.getComponent("caption").show();var a=$(b.content.getComponent("caption").element.down(".x-innerhtml").dom).height();if(a>120){b.content.getComponent("caption").setHeight(140)}else{b.content.getComponent("caption").setHeight(a+20)}b.content.getComponent("caption").getScrollable().getScroller().scrollTo(0,0)}}else{b.content.getComponent("caption").hide()}},itemChange:function(c,l,b,h){var k=this;k.index=k.carousel.getActiveItem().getPageNo();if(!k.content.getComponent("caption").isHidden()){var f=k.images!=null&&k.images[k.index].image_title!=null&&k.images[k.index].image_title!=""?"<p style='font-weight:bold;'>"+k.images[k.index].image_title+"</p>":"";k.content.getComponent("caption").setHtml("<div style='width:100%;color:white;padding:10px;'>"+f+"<p>"+k.captions[k.index]+"</p></div>");var j=$(k.content.getComponent("caption").element.down(".x-innerhtml").dom).height();if(j>120){k.content.getComponent("caption").setHeight(140)}else{k.content.getComponent("caption").setHeight(j+20)}k.content.getComponent("caption").getScrollable().getScroller().scrollTo(0,0)}if(k.captions[k.index]!=null){if(k.captions[k.index].trim().length>0){k.captionIcon.show()}else{k.captionIcon.hide()}}else{k.captionIcon.hide()}k.counter.setHtml((c.getActiveItem().getPageNo()+1)+" of "+k.captions.length);var g=(c.getActiveItem().getPageNo()+1)+" of "+k.captions.length;if(k.url!=null){if(k.data!=null){k.fireEvent("ogalleryinitialized",k,k.data,g)}}else{var a=k.article.byline;if(k.article.reporters!=null&&k.article.reporters.length>0){for(var e in k.article.reporters){a+=", "+k.article.reporters[e].name}}var d={author:a,contentTitle:k.article.headline,contentType:"photolist"};k.fireEvent("ogalleryinitializedArticle",k,d,g)}},setupCarouse}},0,["readerogallery"],["component","container","readerogallery"],{component:true,container:true,readerogallery:true},["widget.readerogallery"],0,[InfinityMobile.view,"ReaderOGallery"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOGalleryItem",Ext.Container,{config:{pageNo:0},initializ}},0,["readerogalleryitem"],["component","container","readerogalleryitem"],{component:true,container:true,readerogalleryitem:true},["widget.readerogalleryitem"],0,[InfinityMobile.view,"ReaderOGalleryItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOGalleryLoading",Ext.Container,{config:{modal:true,fullscreen:true,centered:true,zIndex:999999999},initializ}},0,["readerogalleryloading"],["component","container","readerogalleryloading"],{component:true,container:true,readerogalleryloading:true},["widget.readerogalleryloading"],0,[InfinityMobile.view,"ReaderOGalleryLoading"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOVideoObject",InfinityMobile.view.ReaderMediaObject,{config:{html:'<img class="newsdayObject" style="height100%;width:100%; image-rendering: -webkit-optimize-contrast;  image-rendering: crisp-edges;  -webkit-backface-visibility: hidden; -ms-transform: translateZ(0); -webkit-transform: translateZ(0); transform: translateZ(0);" src="./resources/images/play.png" />'},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.on({tap:a.onTap,painted:function(){var c=this;try{if(Ext.os.is.iOS||Ext.browser.is.Safari){var d=c.element.down("img");var e=d.dom||null;if(e!=null){e.style.imageRendering=""}}}catch(b){console.error("[ReaderOLinkObject]: Error Caught",b)}},scope:a})},setMediaObjectStyle:function(){var a=this;a.mediaObject.backgroundAlpha=0;InfinityMobile.view.ReaderMediaObject.prototype.setMediaObjectStyle.apply(this,arguments)},onTap:function(){var b=this;var a=b.mediaObject.url;console.log("URL");console.log(a);console.log(b);b.fireEvent("ovideoclicked",b,a,"eedition")}},0,["readerovideoobject"],["component","container","readermediaobject","readerovideoobject"],{component:true,container:true,readermediaobject:true,readerovideoobject:true},["widget.readerovideoobject"],0,[InfinityMobile.view,"ReaderOVideoObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOGalleryObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",html:'<img class="newsdayObject" style="height100%;width:100%;image-rendering: -webkit-optimize-contrast;  image-rendering: crisp-edges; -webkit-backface-visibility: hidden; -ms-transform: translateZ(0); -webkit-transform: translateZ(0); transform: translateZ(0);" src="./resources/images/viewphotos.png" />'},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.on({tap:"onTap",painted:function(){var c=this;try{if(Ext.os.is.iOS||Ext.browser.is.Safari){var d=c.element.down("img");var e=d.dom||null;if(e!=null){e.style.imageRendering=""}}}catch(b){console.error("[ReaderOLinkObject]: Error Caught",b)}},scope:a})},setMediaObjectStyle:function(){var a=this;a.mediaObject.backgroundAlpha=0;InfinityMobile.view.ReaderMediaObject.prototype.setMediaObjectStyle.apply(this,arguments)},onTa}},0,["readerogalleryobject"],["component","container","readermediaobject","readerogalleryobject"],{component:true,container:true,readermediaobject:true,readerogalleryobject:true},["widget.readerogalleryobject"],0,[InfinityMobile.view,"ReaderOGalleryObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderVideoLinkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",style:"background-color:black;text-align:center;overflow:hidden",cls:"readerLightbox",layout:"vbox",padding:"25%"},initialize:function(){var c=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);var d=hexToRgb("000000");c.element.dom.style.background="rgba("+d+","+0+")";var b="";if(c.mediaObject.param2!=null){if(c.mediaObject.param2.length>0){var a=c.mediaObject.param2.split("|");if(a.length>1){b=a[1]}else{b="Play Video"}}else{b="Play Video"}}else{b="Play Video"}if(c.config.type=="brightcove"){if(!!c.mediaObject.param5){c.element.dom.style.backgroundImage="url('"+c.mediaObject.param5+"')";c.element.dom.style.backgroundSize="contain";c.element.dom.style.backgroundRepeat="no-repeat";c.element.dom.style.backgroundPosition="center"}}c.element.on({tap:"onTap",scope:c})},onTap:function(){var a=this;if(a.mediaObject.url=="http://LIGHTBOX"||a.mediaObject.param3=="LIGHTBOX"){a.fireEvent("lightbox",a,a.mediaObject,"video",a.config.type)}}},0,["readervideolinkobject"],["component","container","readermediaobject","readervideolinkobject"],{component:true,container:true,readermediaobject:true,readervideolinkobject:true},["widget.readervideolinkobject"],0,[InfinityMobile.view,"ReaderVideoLinkObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLightbox",Ext.Container,{config:{modal:true,centered:true,hideOnMaskTap:true,height:1000,width:1000,maxHeight:"80%",maxWidth:"80%",layout:"vbox",style:"background-color:white",items:[{itemId:"topBar",height:40,layout:"hbox",items:[{id:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"content",flex:1,cls:"innerhtmlfullheight"}]},initializ},setCloseButtonListenter:function(){var a=this;a.closeButton.element.on("tap",function(){a.close()})},setImageContent:function(){var b=this;b.fileGuid=b.mediaObject.file;var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);b.imageurl="http://pages.cdn.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+".jpg";if(location.protocol=="https:"){b.imageurl=b.imageurl.replace("http://pages.cdn.pagesuite.com","https://pages.pagesuite.com")}b.setStyle({maxHeight:"80%",maxWidth:"80%"});b.content.setHtml("<div class='backImage' style='width:100%;height:100%;background:url("+b.imageurl+")'></div>")},setVideoContent:function(){var a=this;if(a.mediaObject!=""){if(a.mediaObject.url.indexOf("http://www.youtube.com/watch")!=-1){a.initializeYoutube()}else{if(a.config.type=="brightcove"){a.initialiseBrightcove()}else{if(a.mediaObject.url.indexOf("http://")!=-1||a.mediaObject.url.indexOf("https://")!=-1||a.mediaObject.url.indexOf("tel:")!=-1){a.initialiseVimeo()}else{if(a.mediaObject.file!=""){a.initializeMP4()}}}}}},initialiseBrightcove:function(){var e=this;var a=e.mediaObject.param2.split("|");var g="https://players.brightcove.net/"+a[0]+"/"+a[1]+"_"+a[2]+"/index.min.js";window.brightcoveScriptsLoaded=window.brightcoveScriptsLoaded||[];window.brightcoveScriptsLoaded.push(g);var f="<video-js playsinline id='"+e.id+"_bc' style='display:block; height:100%; width: 100%; position: relative;' data-account='"+a[0]+"' data-player='"+a[1]+"'data-embed='"+a[2]+"' controls='' data-video-id='"+e.mediaObject.param1+"' width='300' height='300' data-application-id=\"html5-test\"></video-js>";e.content.setHtml(f);e.setHeight("100%");e.setWidth("100%");e.setZIndex(99999999);e.setStyle({maxHeight:"unset",maxWidth:"unset"});try{var c=function(){if(typeof bc!="undefined"&&!e.brightcoveVideo){e.brightcoveVideo=bc(e.id+"_bc")}if(!!e.mediaObject.autoPlay&&e.mediaObject.autoPlay.toLowerCase()=="true"&&!!e.brightcoveVideo){if(currentProfile!="desktop"){e.brightcoveVideo.muted(true)}e.brightcoveVideo.play()}};if(currentProfile!="desktop"){e.visibilityChangeListener=e.element.dom.visibilityChangeListener=function(h){if(currentProfile!="desktop"){switch(window.document.visibilityState){case"hidden":if(e.brightcoveVideo){e.brightcoveVideo.pause()}}}};window.document.addEventListener("visibilitychange",e.visibilityChangeListener)}var b=document.createElement("SCRIPT");b.src=g;b.onload=c;e.element.dom.appendChild(b);requestAnimationFrame(function(){c()})}catch(d){console.error(d,e.element.dom)}},initialiseVimeo:function(){var a=this;if(a.mediaObject.param1.indexOf("/")>-1){a.vimeoId=a.mediaObject.param1.split("/").pop()}else{a.vimeoId=a.mediaObject.param1}a.addCls("vimeoVideo");var b="https://player.vimeo.com/video/"+a.vimeoId;a.content.setHtml("<iframe class='vimeoPlayer' src='"+b+"?api=1&amp;player_id="+b+"' allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' width='100%' height='100%' frameborder='0' id='"+(a.id+"video")+"'/>")},initializeMP4:function(){var b=this;b.fileGuid=b.mediaObject.file;var d=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);b.videoUrl="http://source.pagesuite.com/media/"+d+"/"+a+"/"+b.fileGuid+".mp4";if(location.protocol=="https:"){b.videoUrl=b.videoUrl.replace("http:","https:")}var c="";if(b.mediaObject.autoPlay=="true"&&b.mediaObject.appear!="TRIGGER"&&currentProfile!="desktop"&&settings.reader.allowAutoplayVideoOnMobile=="true"){c="&muted=true"}if(b.mediaObject.param4=="true"){c+="&hidecontrols=true"}videoUrl="video.aspx?guid="+b.fileGuid+c;b.content.setHtml("<iframe allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' src='"+videoUrl+"' width='100%' height='100%'  frameborder='0' scrolling='no' />");videoplay=function(){b.videoPlayListener()}},initializeYoutube:function(){var c=this;c.youtubeCode=c.mediaObject.url.substr(c.mediaObject.url.length-11);var b="https://www.youtube.com/embed/"+c.youtubeCode;var a="";if(c.mediaObject.param4=="true"){a="&controls=0"}c.content.setHtml("<iframe onload='parent.youtubeplay()' src='"+b+"?enablejsapi=1"+a+"' width='100%' height='100%' frameborder='0' id='"+b+"'/>");youtubeplay=function(){var d=new YT.Player(document.getElementById(b),{events:{onStateChange:function(e){c.onPlayerStateChange(e)}}})}},videoPlayListener:function(){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.tracking!=null){var c=a.data.items[0].raw.tracking.trackingType;if(c=="GA"){if(typeof gtag!="undefined"){b.setGaCustomerId();gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","play",{event_category:"MP4",event_label:b.mediaObject.name,value:b.mediaObject.page,page_title:publicationName+" - "+editionName,page_path:"/"+b.mediaObject.page+" - "+publicationName+" - "+editionName,page_number:b.mediaObject.page})}}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})},onPlayerStateChange:function(c){var b=this;if(c.data==1){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.tracking!=null){var d=a.data.items[0].raw.tracking.trackingType;if(d=="GA"){if(typeof gtag!="undefined"){gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","play",{event_category:"Youtube",event_label:b.videoName,value:b.startpageNumber,page_title:publicationName+" - "+editionName,page_path:"/"+b.startpageNumber,page_number:b.startpageNumber})}}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}},destroy:function(){Ext.Container.prototype.destroy.apply(this,arguments);try{if(!!this.visibilityChangeListener){window.removeEventListener("visibilitychange",this.visibilityChangeListener)}}catch(a){console.warn("[ReaderLightbox] ErrorCaught:\n\t",a)}},close:function(){var a=this;a.destroy()},fadeI},fadeOu},hide:function(){this.close()},setGaCustomerId:function(){var a="";if(typeof getCookie==="function"){a=getCookie("gatid")}if(typeof gtag!="undefined"&&a!=null&&a!=""){gtag("set",{user_id:a,send_page_view:false})}}},0,["readerlightbox"],["component","container","readerlightbox"],{component:true,container:true,readerlightbox:true},["widget.readerlightbox"],0,[InfinityMobile.view,"ReaderLightbox"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageLinkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"readerLightbox",items:[{itemId:"tooltip",style:"position:absolute !important;"}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.on({tap:"onTap",scope:a});if(a.mediaObject!=""){var b=a.mediaObject.param2.split("|")[1];a.getComponent("tooltip").setHtml('<div style="position:absolute;" class="tool-tip">'+b+"</div>");a.element.dom.onmousemove=(function(c){if(c.clientX<($(document).width()/2)){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)"}else{a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(c.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(c.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(c.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(c.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(c.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(c.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)"}})}},onTa}},0,["readerimagelinkobject"],["component","container","readermediaobject","readerimagelinkobject"],{component:true,container:true,readermediaobject:true,readerimagelinkobject:true},["widget.readerimagelinkobject"],0,[InfinityMobile.view,"ReaderImageLinkObject"],0));(Ext.cmd.derive("InfinityMobile.view.Main",Ext.Panel,{config:{layout:"card",pageNo:"",viewType:"reader"},initialize:function(){var a=this;a.viewType=a.config.viewType;a.element.dom.addEventListener("touchmove",function(b){b.preventDefault()})},loadArticle:function(a){var b=this;b.fireEvent("loadArticle",a)},loadReade},loadFlashReade},cacheLatestEditio},loadView:function(a){var b=this;b.fireEvent("loadViewController",b,a)},loadModalView:function(b){var a=this;a.fireEvent("loadModalView",b)},removeView:function(){var a=this;a.fireEvent("removeView")}},0,["main"],["component","container","panel","main"],{component:true,container:true,panel:true,main:true},["widget.main"],0,[InfinityMobile.view,"Main"],0));(Ext.cmd.derive("InfinityMobile.view.Reader",Ext.Panel,{showToolBar:true,config:{flex:1,width:"100%",layout:"vbox",showToolBar:true,style:"transition: .4s ease-out;"},statics:{userInactivityTimeout:{userActivityEvents:["mousedown","wheel","keydown","touchstart","touchmove"],setting:{enabled:false,idleMinutesThreshold:0,inactivityPromptDisplayDurationMinutes:0,redirectionUrl:"",inactivityPromptText:{title:"Are You Still There?",description:"Your session is about to end due to inactivity"}},consumeSetting:function(){if(typeof settings=="object"&&"reader" in settings&&typeof settings.reader=="object"&&"userInactivityTimeout" in settings.reader&&typeof settings.reader.userInactivityTimeout=="object"){InfinityMobile.view.Reader.userInactivityTimeout.setting.enabled="enabled" in settings.reader.userInactivityTimeout&&settings.reader.userInactivityTimeout.enabled===true?true:InfinityMobile.view.Reader.userInactivityTimeout.setting.enabled;InfinityMobile.view.Reader.userInactivityTimeout.setting.idleMinutesThreshold="idleMinutesThreshold" in settings.reader.userInactivityTimeout&&!!settings.reader.userInactivityTimeout.idleMinutesThreshold?settings.reader.userInactivityTimeout.idleMinutesThreshold:InfinityMobile.view.Reader.userInactivityTimeout.setting.idleMinutesThreshold;InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptDisplayDurationMinutes="inactivityPromptDisplayDurationMinutes" in settings.reader.userInactivityTimeout&&!!settings.reader.userInactivityTimeout.inactivityPromptDisplayDurationMinutes?settings.reader.userInactivityTimeout.inactivityPromptDisplayDurationMinutes:InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptDisplayDurationMinutes;InfinityMobile.view.Reader.userInactivityTimeout.setting.redirectionUrl="redirectionUrl" in settings.reader.userInactivityTimeout&&!!settings.reader.userInactivityTimeout.redirectionUrl?settings.reader.userInactivityTimeout.redirectionUrl:InfinityMobile.view.Reader.userInactivityTimeout.setting.redirectionUrl;if("inactivityPromptText" in settings.reader.userInactivityTimeout&&typeof settings.reader.userInactivityTimeout.inactivityPromptText=="object"){InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptText.title="title" in settings.reader.userInactivityTimeout.inactivityPromptText&&!!settings.reader.userInactivityTimeout.inactivityPromptText.title?settings.reader.userInactivityTimeout.inactivityPromptText.title:InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptText.title;InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptText.description="description" in settings.reader.userInactivityTimeout.inactivityPromptText&&!!settings.reader.userInactivityTimeout.inactivityPromptText.description?settings.reader.userInactivityTimeout.inactivityPromptText.description:InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptText.description}}},isSettingEnabled:function(){var a=InfinityMobile.view.Reader.userInactivityTimeout.setting;return !!a.enabled&&!!a.idleMinutesThreshold&&!!a.inactivityPromptDisplayDurationMinutes&&(a.idleMinutesThreshold>a.inactivityPromptDisplayDurationMinutes)&&!!a.redirectionUrl},customEvents:{resetObserver:"resetUserInactivityObserver"}}},beforeInitialize:function(){var a=this;a.element.on({singletap:"onTap",scope:this})},initialize:function(){var a=this;a.fireEvent("ready",a);if(window.SpeechSynthesisUtterance!=undefined){$(window).unloa});window.document.addEventListener("visibilitychange",function(b){window.speechSynthesis.cancel();a.readBlur();a.visibilityListener()})}a.initializeUserInactivityObserver();a.setEventListeners()},onTap:function(){var a=this;a.fireEvent("readertap",a)},readBlu},initializeUserInactivityObserver:function(){var a=this;a.statics().userInactivityTimeout.consumeSetting();if(a.statics().userInactivityTimeout.isSettingEnabled()){a.setUserActivityListeners();a.resetUserInactivityMinutesCount();a.destroyUserInactivityObserverInterval();a.setUserInactivityObserverInverval()}},resetUserInactivityObserver:function(){var a=this;a.resetUserInactivityMinutesCount();a.destroyUserInactivityObserverInterval();a.setUserInactivityObserverInverval()},destroyUserInactivityObserver:function(){var a=this;a.destroyUserInactivityPrompt();a.resetUserInactivityMinutesCount();a.destroyUserInactivityObserverInterval()},setUserActivityListeners:function(){var a=this;a.statics().userInactivityTimeout.userActivityEvents.forEach(function(b){if("on"+b in document.documentElement){Ext.getDoc().dom.addEventListener(})}})},getUserInactivityMinutesCount:function(){var a=this;return"userInactivityMinutesCount" in a&&!!a.userInactivityMinutesCount?a.userInactivityMinutesCount:0},increaseUserInactivityMinutesCount:function(){var a=this;a.userInactivityMinutesCount=a.getUserInactivityMinutesCount()+1},resetUserInactivityMinutesCount:function(){var a=this;a.userInactivityMinutesCount=0},setUserInactivityObserverInverval:function(){var a=this;a.userInactivityObserverIntervalId=setInterval(function(){a.increaseUserInactivityMinutesCount();if(a.getUserInactivityMinutesCount()===(InfinityMobile.view.Reader.userInactivityTimeout.setting.idleMinutesThreshold-InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptDisplayDurationMinutes)){a.produceUserInactivityPrompt()}if(a.getUserInactivityMinutesCount()===InfinityMobile.view.Reader.userInactivityTimeout.setting.idleMinutesThreshold){a.destroyUserInactivityPrompt();a.redirectIdleUser()}},60000)},destroyUserInactivityObserverInterval:function(){var a=this;if("userInactivityObserverIntervalId" in a&&!!a.userInactivityObserverIntervalId){clearInterval(a.userInactivityObserverIntervalId)}},setEventListeners:function(){var a=this;mainPanel.on(a.statics().userInactivityTimeout.customEvents.resetObserver,a.statics().userInactivityTimeout.customEvents.resetObserver,a)},isUserInactivityPromptInDo},produceUserInactivityPrompt:function(){var a=this;a.destroyUserInactivityPrompt();Ext.Viewport.add(Ext.create("InfinityMobile.view.UserInactivityPrompt",{}))},destroyUserInactivityPrompt:function(){var a=this;if(a.isUserInactivityPromptInDom()){Ext.Viewport.down("userinactivityprompt").destroy()}},redirectIdleUser:function(){var e=this;if(e.statics().userInactivityTimeout.isSettingEnabled()){var b=!isNaN(e.statics().userInactivityTimeout.setting.redirectionUrl);if(b===false){if(InfinityMobile.controller.ReaderController.isNewPWA()&&e.statics().userInactivityTimeout.setting.redirectionUrl.indexOf("http")!==-1){e.destroyUserInactivityObserver();window.parent.postMessage({type:"redirect",url:e.statics().userInactivityTimeout.setting.redirectionUrl},"*")}else{e.resetUserInactivityObserver()}}else{if(b===true){var a=parseInt(e.statics().userInactivityTimeout.setting.redirectionUrl);var d=typeof settings=="object"&&"reader" in settings&&typeof settings.reader=="object"&&"reverse" in settings.reader&&settings.reader.reverse=="true";var c=Object.keys(flatPlanData.pageMapper).length;if(a<1){a=d?c:1}else{if(a>c){a=d?1:c}}if(d&&(c>a)&&a>1){a=(c-a)+1}var f=typeof flatPlanData.pdfPages[a-1]=="object"?flatPlanData.pdfPages[a-1]:{};if("pages" in f&&Array.isArray(f.pages)&&f.pages.length>0&&!!f.pages[0].advertsAdded){a+=f.pages[0].advertsAdded}mainPanel.fireEvent("pagejump",(a-1));e.resetUserInactivityObserver()}}}},visibilityListener:function(){if("visibilityState" in document&&!!document.visibilityState){if(document.visibilityState==="visible"){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME)}else{if(document.visibilityState==="hidden"){mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)}}}}},0,["reader"],["component","container","panel","reader"],{component:true,container:true,panel:true,reader:true},["widget.reader"],0,[InfinityMobile.view,"Reader"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderToolbar",Ext.Toolbar,{beforeInitialize:function(){var a=this;a.element.on({tap:"onTap",scope:this})},config:{cls:"toolbar",items:[{xtype:"button",text:"Back",action:"toolbarback"},{xtype:"container",flex:1},{xtype:"button",text:"<",action:"toolbarprevious"},{xtype:"textfield",id:"toolbarpages",placeHolder:"1 / 76",width:"105px"},{xtype:"button",text:">",action:"toolbarnext"},{xtype:"container",flex:1},{xtype:"button",text:"Menu",action:"toolbarmenu"},{itemId:"tooltip",html:'<div style="position:absolute;" class="tool-tip"></div>'}]},onTap:function(a){a.stopPropagation()}},0,["readertoolbar"],["component","container","toolbar","readertoolbar"],{component:true,container:true,toolbar:true,readertoolbar:true},["widget.readertoolbar"],0,[InfinityMobile.view,"ReaderToolbar"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderToolbarBottom",Ext.Container,{beforeInitializ},config:{style:"background-color:rgba(0, 0, 0, 0.7) !important; padding:8px; padding-top:26px; padding-bottom:0",layout:"vbox",items:[{itemId:"toolbarClose",height:26,width:75,right:-8,top:-26,padding:"0 8px 0 0",style:"font-family:arial;color:#cccccc",layout:{type:"hbox",align:"center",pack:"right"},items:[{itemId:"closeTxt",html:"Close",height:18,style:"font-size:16px;margin-right:5px"},{height:18,html:"<img src='../assets/article view/article-close-btn.png' style='width:16px' />"}]},{flex:1,itemId:"scrollerContainer",scrollable:"horizontal"}]},initializ},setCloseEvent:function(){var a=this;a.toolbarClose.element.on("tap",function(){a.fireEvent("close",a)})},onTap:function(a){a.stopPropagation()}},0,["readertoolbarbottom"],["component","container","readertoolbarbottom"],{component:true,container:true,readertoolbarbottom:true},["widget.readertoolbarbottom"],0,[InfinityMobile.view,"ReaderToolbarBottom"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPages",Ext.Container,{initialize:function(){var a=this;a.fireEvent("initialized",a)},config:{id:"pagescontainer",cls:"content-browser",layout:"hbox",height:"100%",defaults:{width:150}}},0,["readerpages"],["component","container","readerpages"],{component:true,container:true,readerpages:true},["widget.readerpages"],0,[InfinityMobile.view,"ReaderPages"],0));(Ext.cmd.derive("InfinityMobile.view.Blocker",Ext.Container,{config:{top:0,left:0,width:"100%",height:"100%",layout:"fit",style:"background:rgba(0, 0, 0, 0.75)"}},0,["blocker"],["component","container","blocker"],{component:true,container:true,blocker:true},["widget.blocker"],0,[InfinityMobile.view,"Blocker"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuClose",Ext.Container,{config:{html:"Close",style:"color:white; margin-bottom:25px"},initializ},onTa}},0,["readermenuclose"],["component","container","readermenuclose"],{component:true,container:true,readermenuclose:true},["widget.readermenuclose"],0,[InfinityMobile.view,"ReaderMenuClose"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuSection",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px)",right:0,top:40,items:[{itemId:"sectionitemscontainer",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{padding:15,style:"color:#ffffff"},items:[{style:"color:#cccccc; font-size:14px",id:"sectionitemback",html:"<img src='../assets/menu/menu-arrow-left-ic.png' style='height:13px; margin-right:10px' />BACK"}]}]},initializ},backtapped:function(){var a=this;a.fireEvent("back",a)}},0,["readermenusection"],["component","container","panel","overlay","readermenusection"],{component:true,container:true,panel:true,overlay:true,readermenusection:true},["widget.readermenusection"],0,[InfinityMobile.view,"ReaderMenuSection"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuSectionItem",Ext.Container,{config:{style:"font-size:14px;color:#cccccc;cursor:pointer",cls:"sectionItem",name:"",pageNumber:""},initialize:function(){var a=this;a.name=a._name;a.pageNumber=a._pageNumber;a.setHtml(a.name);if(settings.newsday!=null){a.addCls("menuItem")}a.element.on({tap:"onTap",scope:a});a.setupStyling()},setupStyling:function(){var a=this;this.element.dom.style.backgroundColor="rgba(0,0,0,0)";if(typeof EDITIONAPP!=="undefined"&&EDITIONAPP){$(this.element.dom).css("font-size",currentProfile!="phone"?"20px":"14px");$(this.element.dom).css("border-bottom","1px solid grey")}if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){this.element.dom.style.color="white"}a.setStyle("font-size:14px;color:#"+settings.menu.textColor+";cursor:pointer")},onTap:function(b){var a=this;a.fireEvent("sectionclick",a);b.stopPropagation();mainPanel.fireEvent("trackMenuSection",a)}},0,["readermenusectionitem"],["component","container","readermenusectionitem"],{component:true,container:true,readermenusectionitem:true},["widget.readermenusectionitem"],0,[InfinityMobile.view,"ReaderMenuSectionItem"],0));(Ext.cmd.derive("InfinityMobile.view.InfiniteCarousel",Ext.Carousel,{initialize:function(){var a=this;Ext.carousel.Carousel.prototype.initialize.call(this);a.on("activeitemchange","handleItemChange",this);a._visiblePages=Math.min(a._visiblePages,a.getData().length-pageOffset);a.setCards();a.setOrientationChange()},config:{indicator:false,data:false,pageNumber:0,skipActiveItemChange:true,pageTemplate:false,visiblePages:3,directionLock:true,landscapePageIncrement:1,mode:"double",zoomMode:"fit",overrideLandscape:false},setPageTemplate:function(a){this.pageTemplate=a},setCards:function(){var f=this;if(f._mode=="single"){f._landscapePageIncrement=1}f._skipActiveItemChange=true;var d=1;if(f.returnOrientation()=="landscape"||f._overrideLandscape==true){d=f._landscapePageIncrement}var a=f.returnMappedPageNumber(f._pageNumber);if(f._pageNumber==0){for(var c=0;c<f._visiblePages;c++){var e=Math.min((c*d),(f.getData().length-1-pageOffset));f.add(f.createCard(f.getData()[e],e,f.getData()))}f.setActiveItem(0)}else{if(a==(f.getData().length-1-pageOffset)){if(d==1){for(var c=0;c<3;c++){var h=f._pageNumber-2+c;f.add(f.createCard(f.getData()[h],h,f.getData()))}f.setActiveItem(2)}else{for(var c=0;c<3;c++){var h=f._pageNumber-4+(2*c);f.add(f.createCard(f.getData()[h],h,f.getData()))}f.setActiveItem(2)}}else{if(d==2){var b=0;for(var c=(f._pageNumber-(1*d));c<(f._pageNumber+(2*d));c+=d){var g=Math.max(c,0);g=Math.min(c,(f.getData().length-1));g=Math.max(0,g);f.add(f.createCard(f.getData()[g],g,f.getData(),b));b++}}else{for(var c=(f._pageNumber-(1*d));c<(f._pageNumber+(2*d));c+=d){f.add(f.createCard(f.getData()[c],c,f.getData()))}}f.setActiveItem(1)}}f._skipActiveItemChange=false},handleItemChange:function(h,g,d,e){var f=this;var j=1;if(f.returnOrientation()=="landscape"){j=f.getLandscapePageIncrement()}if(!f._skipActiveItemChange){if(g.getPageNo()>d.getPageNo()){var c=Math.max(d.getPageNo(),0);var b=1;var a=Math.max(g.getPageNo(),0);if(f.getData().length%2==1&&a==f.getData().length-2&&f._mode=="double"&&f.returnOrientation()=="landscape"){b=2}if(c==0||g.getPageNo()>=(f.getData().length-b-pageOffset)){}else{f.addCardToFront(h,h.getItems().items[0],j)}f._pageNumber+=j;f._pageNumber=Math.min(f._pageNumber,(f.getData().length-1-pageOffset))}else{var a=Math.max(g.getPageNo(),0);if(a==0||d.getPageNo()>=(f.getData().length-1-pageOffset)){if(a==0&&d.getPageNo()==1&&f._mode=="double"&&f.returnOrientation()=="landscape"&&f.getData().length>3){d.setPageNo(2);d.mappedPageNumber=flatPlanData.reversePageMapper[3]-1;d.imagetoload=d.landscapeimage;d.portraitTileImage=d.landscapeTileImage;h.getItems().items[2].setPageNo(4);h.getItems().items[2].mappedPageNumber=flatPlanData.reversePageMapper[5]-1;h.getItems().items[2].imagetoload=h.getItems().items[2].landscapeimage;h.getItems().items[2].portraitTileImage=h.getItems().items[2].landscapeTileImage}if(d.getPageNo()>=(f.getData().length-1-pageOffset)&&a%2==0&&d.getPageNo()>=(f.getData().length-1-pageOffset)&&(f.getData().length-pageOffset)%2==0){j=1}}else{if(d.getPageNo()==(f.getData().length-2-pageOffset)&&f.getData().length-pageOffset%2==1&&f._mode=="double"&&f.returnOrientation()=="landscape"){f.addCardToFront(h,h.getItems().items[pageOffset],0)}f.addCardToBack(h,h.getItems().items[2],j)}f._pageNumber-=j;f._pageNumber=Math.max(f._pageNumber,0)}}},returnMappedPageNumbe},returnReverseMappedPageNumber:function(a){var b=this;if(b.returnOrientation()=="landscape"&&b._mode=="double"){return(flatPlanData.pageMapper[a+1]-1)}return a},createCar},addCardToFront:function(f,c,b){var d=this;c._skipActiveItemChange=true;f.remove(c,true);var a=1;if(d.returnOrientation()=="landscape"){a=d.getLandscapePageIncrement()}var e=Math.min((d._pageNumber+b+a),d.getData().length-1-pageOffset);e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createCard(d.getData()[e],e,d.getData()))},addCardToBack:function(f,a,c){var d=this;var b=1;if(d.returnOrientation()=="landscape"){b=d.getLandscapePageIncrement()}if(a!=null){a._skipActiveItemChange=true;f.remove(a,true)}var e=(d._pageNumber-c-b);e=Math.max(e,0);f.insert(0,d.createCard(d.getData()[e],e,d.getData()))},jumpToFirst:function(){this.jumpToPage(0)},jumpToLast:function(){var a=(this.getData().length-1-pageOffset);a=flatPlanData.reversePageMapper[a];this.jumpToPage(a)},jumpToPage:function(b,d){var c=this;b=c.returnReverseMappedPageNumber(b);if(!isNaN(b)){if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){}var a=b;var a=Math.max(a,(this.getData().length-1));a=Math.min(a,0);if(b!=c._pageNumber){if(c._mode=="single"||(c.returnOrientation()=="portrait")){if(b==(c._pageNumber+1)&&!d){c.next()}else{if(b==(c._pageNumber-1)&&!d){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}else{if(b==(c._pageNumber+2)){c.next()}else{if(b==(parseInt(c._pageNumber)+1)&&this.getData().length==2&&c._pageNumber==0){c.next()}else{if(b==(parseInt(c._pageNumber)-1)&&this.getData().length==2&&c._pageNumber==1){c.previous()}else{if(b==(c._pageNumber-2)){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}}}}}c.handleMediaLoad(b)},handleMediaLoad:function(a){var b=this;if(typeof loadMediaEveryPage!="undefined"&&loadMediaEveryPage){b.hasLoadedFirstPage=b._mode=="double"?false:true;b.makeMediaRequest(a);if(b._mode=="double"){if(a%2==1){if(flatPlanData.pageGroups[parseInt(a)+1]!=null){b.makeMediaRequest(parseInt(a)+1)}}else{if(flatPlanData.pageGroups[parseInt(a)-1]!=null){b.makeMediaRequest(parseInt(a)-1)}}}}},makeMediaRequest:function(a){var b=this;var c=b.getActiveItem();mainPanel.fireEvent("loadMediaForPage",flatPlanData.pageGroups[parseInt(a)].pages[0],function(){if(b.hasLoadedFirstPage){c.renderedMedia=false;c.tryRenderMedia(true);b.hasLoadedFirstPage=false}else{b.hasLoadedFirstPage=true}})},setOrientationChange:function(){var b=this;var d=(function(){var e=0;return function(g,f){clearTimeout(e);e=setTimeout(g,f)}})();b.orientation=b.returnOrientation();if(currentProfile=="desktop"){$(window).on("resize",function(){d(function(){b.onResize()},250)})}else{if(Ext.os.is.Android){var c=0;if(navigator.userAgent.indexOf("EdgA")>=0){c=400}var a=function(f){f.stopPropagation()};$(window).on("resize",function(){b.element.dom.addEventListener("touchmove",a);if(b.orientation!=b.returnOrientation()){if(navigator.userAgent.indexOf("EdgA")>=0&&document.activeElement.tagName.toLowerCase()=="input"){document.activeElement.blur()}}setTimeout(function(){try{if(b.orientation!=b.returnOrientation()){b.orientation=b.returnOrientation();b.onResize()}}catch(f){console.warn("Error resizing pages",f)}b.element.dom.removeEventListener("touchmove",a)},c)})}else{var a=function(f){f.stopPropagation()};Ext.Viewport.on("orientationchange",function(f,h,g,e){b.element.dom.addEventListener("touchmove",a);if(currentProfile=="phone"&&Ext.os.is.iOS){setTimeout(function(){try{b.onResize();b.orientation=b.returnOrientation()}catch(k){console.warn("Error resizing pages",k)}b.element.dom.removeEventListener("touchmove",a)},800)}else{if((currentProfile=="tablet"||currentProfile=="largetablet")&&Ext.browser.is.Safari){setTimeout(function(){try{b.onResize();b.orientation=b.returnOrientation()}catch(k){console.warn("Error resizing pages",k)}b.element.dom.removeEventListener("touchmove",a)},800)}else{var j=0;if(typeof navigator!="undefined"&&navigator.userAgent!=null){if(navigator.userAgent.indexOf("FxiOS")>=0){j=800}else{if(navigator.userAgent.indexOf("EdgiOS")>=0||navigator.userAgent.toLowerCase().indexOf("crios")>=0){j=400}}}else{j=400}setTimeout(function(){try{b.onResize();b.orientation=b.returnOrientation()}catch(k){console.warn("Error resizing pages",k)}b.element.dom.removeEventListener("touchmove",a)},j)}}});if((Ext.os.is.iOS&&typeof iOSVersion!="undefined"&&parseFloat(iOSVersion())>=15)||((currentProfile=="tablet"||currentProfile=="largetablet")&&Ext.browser.is.Safari&&!Ext.os.is.Android)){b.resizeWidth=$(window).width();b.resizeHeight=window.innerHeight;$(window).on("resize",function(){d(function(){if(b.orientation==b.returnOrientation()&&(b.resizeWidth!=$(window).width()||b.resizeHeight!=window.innerHeight)){try{b.onResize();b.resizeWidth=$(window).width();b.resizeHeight=window.innerHeight}catch(e){console.warn("[InfiniteCarousel]: Error Caught\n",e)}}},1400)})}}}},isDP},onResize:function(c){var j=this;var d=mainPanel.getActiveItem();if(d.config.viewType!=null&&d.config.viewType=="reader"){j.onSizeChange();if(!c){j.adjustOnResize()}j.fireEvent("resizeArticleController");j.fireEvent("resizeDynamicArticles");j.fireEvent("resizeClipping");if(settings.newsday!=null&&settings.newsday.showBannerOnSingle=="true"&&settings.reader.bannerAd!=null){var b=j.getExcludedPagesForBanner();var a=j.getActiveItem().getPageNo()+parseInt(1);if($.inArray(a+"",b)!=-1){j.fireEvent("loadBannerAd")}}if(j.element.dom.clientWidth!=0){var f=j.getActiveItem();if(f.onResize!=null){f.onResize();f.fireEvent("setupPrintContainer")}var h=j.getItems().items;for(var e=0;e<h.length;e++){var k=h[e];if(k.getPageNo()!=f.getPageNo()){var k=h[e];if(k.onResize!=null){k.onResize()}}}}try{if(!c&&j.orientation!=j.returnOrientation()){j.checkAdvertReplacement();j.fireEvent("updatePageNumber",j)}}catch(g){console.log("[InfiniteCarousel] \n",g);j.fireEvent("updatePageNumber",j)}}else{if(d.config.viewType!=null&&d.config.viewType=="dynamic"){if(currentProfile!="desktop"){j.fireEvent("resizeDynamicArticles")}}}},checkAdvertReplacement:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var a=b.getItems().items;if(a[0]!=null&&a[0].id.indexOf("readeradvertpageviewer")>=0){b.replaceFirstCard(b,a[0],1)}else{if(a[2]!=null&&a[2].id.indexOf("readeradvertpageviewer")>=0){b.replaceLastCard(b,a[2],1)}}b.checkAdvertPlacement()}},checkAdvertPlacement:function(){var g=this;var f=g.getItems().items;var j=g.getLandscapePageIncrement();var b=1;var e=(g._pageNumber+b+j)-1;e=Math.min(parseInt(e),(g.getData().length-1));var h=g.getData()[e].pages[0];var a=(g._pageNumber-b-j)+1;a=Math.max(a,0);var c=g.getData()[a].pages[0];var d=g.getActiveItem();g.checkPageReplacement(c,f[0].config.page,function(){if(d!=f[0]){f[0]._skipActiveItemChange=true;g.remove(f[0],true);g.insert(0,g.createCard(g.getData()[a],a,g.getData()))}});g.checkPageReplacement(h,f[2].config.page,function(){if(d!=f[2]){f[2]._skipActiveItemChange=true;g.remove(f[2],true);g.add(g.createCard(g.getData()[e],e,g.getData()))}})},checkPageReplacement:function(b,a,c){if(b!=null&&b.type=="advert"&&a!=null&&a.type!="advert"&&typeof c==="function"){c()}},replaceLastCard:function(f,a,c){var d=this;a._skipActiveItemChange=true;f.remove(a,true);var b=d.getLandscapePageIncrement();var e=(d._pageNumber+c+b)-1;e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createCard(d.getData()[e],e,d.getData()))},replaceFirstCard:function(f,c,b){var d=this;var a=d.getLandscapePageIncrement();c._skipActiveItemChange=true;f.remove(c,true);var e=(d._pageNumber-b-a)+1;e=Math.max(e,0);f.insert(0,d.createCard(d.getData()[e],e,d.getData()))},adjustOnResize:function(){var c=this;var a=c.returnOrientation();if(c._mode=="double"){if(a=="portrait"){if(c._pageNumber==c.getData().length-2&&(c.getData().length+pageOffset)%2==1&&c.getData().length>3){var b=1;c.addCardToFront(c,c.getItems().items[0],b)}c._pageNumber=flatPlanData.reversePageMapper[c._pageNumber+1]-1;c.setLandscapePageIncrement(1)}else{if(c._pageNumber==c.getData().length-2&&(c.getData().length-pageOffset)%2==1&&c.getData().length>3){var b=1;if(c.returnOrientation()=="landscape"){b=c.getLandscapePageIncrement()}c.addCardToBack(c,c.getItems().items[2],2)}c._pageNumber=flatPlanData.pageMapper[c._pageNumber+1]-1;c.setLandscapePageIncrement(2)}}},disableTiling:function(){var b=this;if(b.element.dom.clientWidth!=0){var a=b.getActiveItem();a.stopTiling();setTimeout(function(){var c=b.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo!=null){if(e.getPageNo()!=a.getPageNo()){var e=c[d];e.stopTiling()}}}},100)}},enableTiling:function(){var b=this;if(b.element.dom.clientWidth!=0){var a=b.getActiveItem();a.setTiling();setTimeout(function(){var c=b.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo!=null){if(e.getPageNo()!=a.getPageNo()){var e=c[d];e.setTiling()}}}},100)}},toggleDPS:function(){var d=this;d.adjustOnToggle();var c=d.getActiveItem();c.toggleDPS();c.fireEvent("setupPrintContainer");if(settings.newsday!=null&&settings.newsday.showBannerOnSingle=="true"&&settings.reader.bannerAd!=null){var a=d.getExcludedPagesForBanner();var b=d.getActiveItem().getPageNo()+parseInt(1);if($.inArray(b+"",a)!=-1){d.fireEvent("loadBannerAd")}}setTimeout(function(){var e=d.getItems().items;for(var f=0;f<e.length;f++){var g=e[f];if(g.getPageNo()!=c.getPageNo()){var g=e[f];g.toggleDPS()}}if(settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.type=="unique"&&d._mode=="single"&&pagesRead.length>=parseInt(settings.subscription.pageRestriction.pages)){pagesRead.length=parseInt(settings.subscription.pageRestriction.pages);if(parseInt(startpageNumber)>1){}else{this.previous()}}}d.checkAdvertReplacement()},100);d.fireEvent("updatePageNumber",d)},getExcludedPagesForBanner:function(){var b=this;var a=[];if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.hideOnPages!=null&&settings.reader.bannerAd.hideOnPages.length>0){a=settings.reader.bannerAd.hideOnPages.split(",")}return a},adjustOnToggle:function(){var b=this;if(b._mode=="single"){if(b._pageNumber==b.getData().length-2&&(b.getData().length-pageOffset)%2==1){var a=1;if(b.returnOrientation()=="landscape"){a=b.getLandscapePageIncrement()}b.addCardToBack(b,b.getItems().items[2],2)}b._mode="double";b._pageNumber=flatPlanData.pageMapper[b._pageNumber+1]-1;b.setLandscapePageIncrement(2)}else{if(b._pageNumber==b.getData().length-2&&(b.getData().length-pageOffset)%2==1){var a=1;if(b.returnOrientation()=="landscape"){a=b.getLandscapePageIncrement()}b.addCardToFront(b,b.getItems().items[0],a)}b._mode="single";b._pageNumber=flatPlanData.reversePageMapper[b._pageNumber+1]-1;b.setLandscapePageIncrement(1)}},toggleZoomMode:function(){var e=this;if(e._zoomMode=="fit"){e._zoomMode="fill"}else{e._zoomMode="fit"}e.onSizeChange();var d=e.getActiveItem();d.toggleZoomMode(e._zoomMode);var a=e.getItems().items;for(var b=0;b<a.length;b++){var c=a[b];if(c.getPageNo()!=d.getPageNo()){var c=a[b];c.doToggleCheck=true;c.toggleZoomMode(e._zoomMode)}}},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android||(Ext.os.is.iOS&&currentProfile!="desktop")){if(currentProfile=="phone"&&Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(window.innerWidth>window.innerHeight){a="landscape"}else{a="portrait"}}}else{if(currentProfile=="desktop"){a="landscape"}}return a},onDragEnd:function(f){try{var d=this;Ext.carousel.Carousel.prototype.onDragEnd.apply(this,arguments);if(typeof trackReaderEvent!="undefined"){var b=f.absDeltaX,a=f.absDeltaY;if((typeof this.animationDirection!="undefined"&&this.animationDirection!=0)&&b>a){d.fireEvent("trackSwipeItemChange")}}}catch(c){console.warn("[InfiniteCarousel] \n",c)}}},0,["infinitecarousel"],["component","container","carousel","infinitecarousel"],{component:true,container:true,carousel:true,infinitecarousel:true},["widget.infinitecarousel"],0,[InfinityMobile.view,"InfiniteCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.PDFInfiniteCarousel",InfinityMobile.view.InfiniteCarousel,{initialize:function(){var a=this;InfinityMobile.view.InfiniteCarousel.prototype.initialize.apply(this,arguments);a.disable();a.isCarouselDragging=false;if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&typeof NEWPWA!="undefined"&&NEWPWA){window.addEventListener("message",function(b){console.log(b.data.type);if(b!=null&&b.data!=null&&b.data.type=="jumpToPage"){a.jumpToPage(b.data.pageNo-1)}})}},config:{indicator:false,data:false,pageNumber:0,skipActiveItemChange:true,pageTemplate:false,visiblePages:3,directionLock:true,landscapePageIncrement:1,mode:"double",zoomMode:"fit",cls:"pdfinfinitecarousel fit"},handleItemChange:function(h,g,c,e){var f=this;var j=f.getLandscapePageIncrement();if(!f._skipActiveItemChange){for(var d=0;d<h.carouselItems.length;d++){if(h.carouselItems[d].element.dom.style.transform=="translate3d(0px, 0px, 0px)"){h.carouselItems[d].element.dom.style.zIndex="10002"}else{h.carouselItems[d].element.dom.style.zIndex="10000"}}var b=g.getPageNo();var a=c.getPageNo();if(b>a){if(a==0||b==(f.getData().length-1-pageOffset)){}else{f.addCardToFront(h,h.getItems().items[0],j)}f._pageNumber+=j;f._pageNumber=Math.min(f._pageNumber,(f.getData().length-1-pageOffset))}else{if(b==0||a==(f.getData().length-1-pageOffset)){if(f._mode=="double"&&b==0){c.config.pageNo=2;if(h.getItems().items[2]!=null){h.getItems().items[2].config.pageNo=4}}}else{f.addCardToBack(h,h.getItems().items[2],j)}f._pageNumber-=j;f._pageNumber=Math.max(f._pageNumber,0)}}f.fireEvent("pagechange",f,g,c)},setOrientationChange:function(){var a=this;var b=(function(){var c=0;return function(e,d){clearTimeout(c);c=setTimeout(e,d)}})();if(currentProfile=="desktop"){$(window).on("resize",function(){b(function(){a.onResize()},250)})}else{if(Ext.os.is.Android){$(window).on("resize",function(){setTimeout(function(){a.onResize()},0)})}else{Ext.Viewport.on("orientationchange","onResize",a)}}},onResiz},disableTiling:function(){var a=this},enableTiling:function(){var a=this},toggleDPS:function(){var g=this;g.adjustOnToggle();var f=g.getActiveItem();f.toggleDPS(g._mode);if(settings.newsday!=null&&settings.newsday.showBannerOnSingle=="true"&&settings.reader.bannerAd!=null){var a=g.getExcludedPagesForBanner();var b=g.getActiveItem().getPageNo()+parseInt(1);if($.inArray(b+"",a)!=-1){g.fireEvent("loadBannerAd")}}var c=g.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo()!=f.getPageNo()){e.toggleDPSNonActive(g._mode,f)}}if(settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.type=="unique"&&g._mode=="single"&&pagesRead.length>=parseInt(settings.subscription.pageRestriction.pages)){pagesRead.length=parseInt(settings.subscription.pageRestriction.pages);if(parseInt(startpageNumber)>1){}else{this.previous()}}}g.checkAdvertReplacement();g.fireEvent("updatePageNumber",g)},checkAdvertReplacemen},checkAdvertPlacement:function(){var g=this;var f=g.getItems().items;console.log(g,f);var j=g.getLandscapePageIncrement();var b=1;var e=(g._pageNumber+b+j)-1;e=Math.min(parseInt(e),(g.getData().length-1));var h=g.getData()[e].pages[0];var a=(g._pageNumber-b-j)+1;a=Math.max(a,0);var c=g.getData()[a].pages[0];var d=g.getActiveItem();g.checkPageReplacement(c,f[0],function(){if(d!=f[0]){f[0]._skipActiveItemChange=true;g.remove(f[0],true);g.insert(0,g.createCard(g.getData()[a],a,g.getData()))}});g.checkPageReplacement(h,f[2],function(){if(d!=f[2]){f[2]._skipActiveItemChange=true;g.remove(f[2],true);g.add(g.createCard(g.getData()[e],e,g.getData()))}})},checkPageReplacemen},replaceLastCar},replaceFirstCar},getExcludedPagesForBanner:function(){var b=this;var a=[];if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.hideOnPages!=null&&settings.reader.bannerAd.hideOnPages.length>0){a=settings.reader.bannerAd.hideOnPages.split(",")}return a},adjustOnToggle:function(){var a=this;if(a._mode=="single"){a._mode="double";a._pageNumber=flatPlanData.pageMapper[a._pageNumber+1]-1;a.setLandscapePageIncrement(2)}else{a._mode="single";a._pageNumber=flatPlanData.reversePageMapper[a._pageNumber+1]-1;console.log("set to single");a.setLandscapePageIncrement(1)}},returnOrientatio},onDragStart:function(b){var a=this;if(settings.reader.enablePageSwipe=="true"){a.isCarouselDragging=true;InfinityMobile.view.InfiniteCarousel.prototype.onDragStart.apply(this,arguments)}},onDrag:function(b){var a=this;if(settings.reader.enablePageSwipe=="true"){InfinityMobile.view.InfiniteCarousel.prototype.onDrag.apply(this,arguments)}},onDragEnd:function(){var a=this;if(settings.reader.enablePageSwipe=="true"){a.isCarouselDragging=false;InfinityMobile.view.InfiniteCarousel.prototype.onDragEnd.apply(this,arguments)}},nex},previou},leftPage:function(){var a=this;a.setActiveItem(a.activeIndex)}},0,["infinitecarousel2d"],["component","container","carousel","infinitecarousel","infinitecarousel2d"],{component:true,container:true,carousel:true,infinitecarousel:true,infinitecarousel2d:true},["widget.infinitecarousel2d"],0,[InfinityMobile.view,"PDFInfiniteCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.2DInfiniteCarousel",InfinityMobile.view.InfiniteCarousel,{config:{direction:"horizontal",pageXPath:""},initialize:function(){var a=this;InfinityMobile.view.InfiniteCarousel.prototype.initialize.call(this);if(a.config.backgroundColor!=null){a.element.dom.style.background="#"+a.config.backgroundColor}a._zoomMode=a.config.zoomMode;a.on("painted",function(b){console.log(b);if(Ext.os.is.iOS&&a.element.dom.clientWidth!=a.previousSize&&a.previousSize!=null){try{a.onResize()}catch(c){console.error("[2DInfiniteCarousel]: Error resizing content\n",c)}}a.previousSize=a.element.dom.clientWidth});if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&typeof NEWPWA!="undefined"&&NEWPWA){window.addEventListener("message",function(b){console.log(b.data.type);if(b!=null&&b.data!=null&&b.data.type=="jumpToPage"){a.jumpToPage(b.data.pageNo-1)}})}},createCar},handleItemChange:function(e,c,d,a){var b=this;InfinityMobile.view.InfiniteCarousel.prototype.handleItemChange.apply(this,arguments);b.fireEvent("pagechange",b,c,d)}},0,["infinitecarousel2d"],["component","container","carousel","infinitecarousel","infinitecarousel2d"],{component:true,container:true,carousel:true,infinitecarousel:true,infinitecarousel2d:true},["widget.infinitecarousel2d"],0,[InfinityMobile.view,"2DInfiniteCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPageViewer",Ext.Container,{config:{pageNo:"",page:false,previousPage:"",nextPage:"",style:"overflow:hidden",html:'<figure><div class="scrollerDiv"><div class="zoomDiv"><img style="visibility:hidden;vertical-align:middle" /><img style="visibility:hidden;vertical-align:middle" /><div class="mediaDiv"><div class="portrait"></div><div class="landscape"></div></div><div class="tileDiv" ><div class="portrait"><canvas /></div><div class="landscape"><canvas /></div></div><div class="tileDivImage" style="position:absolute; top:0;transform-origin:0px 0px;"><div class="portrait"><div class="tileImageContainer"></div><div class="tileImageContainer"></div><div class="tileImageContainer"></div><div class="tileImageContainer"></div></div><div class="landscape"><div class="tileImageContainer"></div><div class="tileImageContainer"></div><div class="tileImageContainer"></div><div class="tileImageContainer"></div></div></div></div></div></figure>',maxScale:3,scrollable:"both",editionGuid:"",cls:"readerpage animate",mode:"double"},beforeInitialize:function(){var a=this;a.isinitialized=false;a.mediaLoaded=false;a.thumbnailLoaded=false;a.usesCanvas=true;if(settings.page.useCanvasToTile!=null&&settings.page.useCanvasToTile=="false"){a.usesCanvas=false}a.hideMediaDivsOnResize=false;if(settings.page.disableMediaOnResize!=null&&settings.page.disableMediaOnResize=="true"){a.hideMediaDivsOnResize=true}a.isDestroyed=false;a.renderedMedia=false;if(settings.page.maxZoomLevel!=null){a.setMaxScale(parseInt(settings.page.maxZoomLevel))}if(a.config.zoomMode!=null){a.zoomMode=a.config.zoomMode}a.currentZoomLevel=1;a.zoomLevels=1;if(settings.reader.doubleTapFullZoom!=null&&settings.reader.doubleTapFullZoom=="false"){a.zoomLevels=2;if(settings.reader.doubleTapZoomLevels!=null){a.zoomLevels=parseInt(settings.reader.doubleTapZoomLevels)}}},initialize:function(){var a=this;a.adCounter=0;a.zoomLevel="none";a.orientation=a.returnOrientation();a.on("painted",a.initializePage,a,{delay:10,single:true});a.mp4Objects=[];a.scroller=a.getScrollable().getScroller();a.scroller.setDisabled(true);a.figure=a.element.down("figure");a.scrollerDiv=a.figure.down("div");a.zoomDiv=a.scrollerDiv.down("div");a.image=a.zoomDiv.down("img").dom;a.landscapeimage=a.zoomDiv.down("img").next("img").dom;a.mediaDiv=a.zoomDiv.down("div");a.portraitMediaDiv=a.mediaDiv.down("div").dom;a.landscapeMediaDiv=a.mediaDiv.down("div").next("div").dom;if(a.config.pageNo==0){a.portraitMediaDiv.style.zIndex=8;a.landscapeMediaDiv.style.zIndex=10}else{a.portraitMediaDiv.style.zIndex=10;a.landscapeMediaDiv.style.zIndex=8}a.tileDiv=a.element.down(".tileDiv");a.portraitTileDiv=a.tileDiv.down(".portrait");a.landscapeTileDiv=a.tileDiv.down(".landscape");a.tileDivImage=a.element.down(".tileDivImage");a.portraitTileDivImage=a.tileDivImage.down(".portrait");a.landscapeTileDivImage=a.tileDivImage.down(".landscape");if(a.usesCanvas){a.tileDivImage.dom.style.display="none"}else{a.tileDiv.dom.style.display="none"}a.tileCanvas=a.tileDiv.down("canvas").dom;a.element.addListener({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragFinished",scope:a});a.scrollerDiv.addListener({scope:a,doubletap:a.onDoubleTap,pinchstart:a.onPinchStart,pinch:a.onPinch,pinchend:a.onPinchEnd});a.scroller.on({scope:a,scrollend:a.onScrollEnd})},returnMappedPageNumber:function(a){var b=this;if(b.returnOrientation()=="landscape"&&b._mode=="double"){return a}return(flatPlanData.pageMapper[a+1]-1)},returnReverseMappedPageNumber:function(a){var b=this;if(b.returnOrientation()=="landscape"&&b._mode=="double"){return(flatPlanData.reversePageMapper[a+1]-1)}return a},initializePage:function(){var c=this;if(!c.isDestroyed){c.hasPainted=true;c.canvasInitialized=false;c.canTile=false;c.hasLoaded=false;c.orientation=c.returnOrientation();var a=c.getPageNo();var b=c.returnAdvertOffset(a+1);c.setMappedPageNo();if(c.returnOrientation=="landscape"){a=a-pageOffset}if((c.mappedPageNumber+b)%2==0){c.imagetoload=c.landscapeimage;c.landscapeimage.onload=function(){c.imageLoaded()}}else{c.imagetoload=c.image;c.image.onload=function(){c.imageLoaded()}}c.setUpImages();c.isinitialized=true}},setMappedPageNo:function(){var c=this;var a=c.getPageNo();var b=c.returnAdvertOffset(a+1);c.mappedPageNumber=flatPlanData.reversePageMapper[a+1]-1},setUpImagesCSS:function(){var c=this;c.image.className="";c.landscapeimage.className="";c.portraitMediaDiv.className="";c.landscapeMediaDiv.className="";c.tileDivImage.dom.className="tileDivImage";c.portraitTileDivImage.dom.className="portrait";c.landscapeTileDivImage.dom.className="landscape";var a=c.getPageNo();var b=c.returnAdvertOffset(a+1+pageOffset);var d=c.returnLandscapeImageType();if(c._mode=="double"){c.tileDivImage.dom.className+=" dpsMode"}if(((c.mappedPageNumber+b)%2)==0){c.landscapeimage.portraitshow=true;c.image.portraitshow=false;c.image.className=d;c.portraitMediaDiv.className=d;c.portraitTileDivImage.dom.className+=(" "+d);if(c.getPreviousPage()==""){c.image.stayHidden=true}}else{c.image.portraitshow=true;c.landscapeimage.portraitshow=false;c.landscapeimage.className=d;c.landscapeMediaDiv.className=d;c.landscapeTileDivImage.dom.className+=(" "+d);if(c.getNextPage()==""){c.landscapeimage.stayHidden=true}}},returnAdvertOffset:function(c){var b=this;var d=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var e=settings.reader.interstitialPageFlow;var a=editionFlatplanData.pageGroups[c-1];if(a!=null&&a.pages[0]!=null){if(!isNaN(a.pages[0].advertsAdded)){d=a.pages[0].advertsAdded}}}return d},setUpImagesURL:function(){var a=this;if(((a.getPageNo())%2)==0){a.landscapeimage.pageNumber=a.getPage().pageIndex;a.getThumbnail(a.landscapeimage,a.getPage());if(a.getPreviousPage()!=""&&a.getPreviousPage().pageIndex!=-1){a.image.pageNumber=a.getPage().pageIndex-1;a.getThumbnail(a.image,a.getPreviousPage())}else{if(a.getPreviousPage()==""){a.image.pageNumber=0;a.getThumbnail(a.image,a.getPage())}else{a.image.pageNumber=-1;a.getThumbnail(a.image,a.getPreviousPage())}}}else{a.image.pageNumber=a.getPage().pageIndex;a.getThumbnail(a.image,a.getPage());if(a.getNextPage()!=""&&a.getNextPage().pageIndex!=-1){a.landscapeimage.pageNumber=a.getPage().pageIndex+1;a.getThumbnail(a.landscapeimage,a.getNextPage())}else{if(a.getNextPage()==""){a.landscapeimage.pageNumber=0;a.getThumbnail(a.landscapeimage,a.getPage())}else{a.landscapeimage.pageNumber=-1;a.getThumbnail(a.landscapeimage,a.getNextPage())}}}},setUpImages:function(){var a=this;a.setUpImagesCSS();a.setUpImagesURL()},returnLandscapeImageType:function(){var a=this;if(a._mode=="single"){return"singlepagelandscapeimage"}return"landscapeimage"},getThumbnail:function(c,b){var a=this;var d="";if(b.image!=null){d=b.image;d=d.replace("http://pages.cdn.pagesuite.com",flatPlanData.pagesDomain);if(settings.page!=null&&settings.page.jpg!=null){d=d.replace("page.jpg",settings.page.jpg)}}a.setImageSrc(c,d,b);c.type=b.type;c.adType=b.adType;if(c.type=="sectionpage"){c.direction=b.direction}c.guid=b.guid;a.checkSectionPage(c)},checkSectionPage:function(b){var a=this;if(b.type=="sectionpage"){b.style.verticalAlign="top";b.style.zIndex=100000000000000000;b.style.position="relative";b.pageViewer=a;if(b.direction=="next"){b.addEventListener("touchstart",a.sectionTouchStart);b.addEventListener("touchend",a.sectionTouchEndNext)}else{b.addEventListener("touchstart",a.sectionTouchStart);b.addEventListener("touchend",a.sectionTouchEndPrevious)}}else{b.style.verticalAlign="middle"}},sectionTouchStart:function(a){this.timeStamp=a.timeStamp},sectionTouchEndNext:function(b){var a=this;if(b.timeStamp-this.timeStamp<150){a.pageViewer.fireEvent("nextSection")}},sectionTouchEndPrevious:function(b){var a=this;if(b.timeStamp-this.timeStamp<150){a.pageViewer.fireEvent("previousSection")}},imageLoaded:function(){var b=this;var d=b.imagetoload;var a=b.image;var c=b.landscapeimage;if(b.element!=null){b.layoutImages(d,a,c);b.resetPage();b.resetZoom();b.thumbnailLoaded=true;b.fireEvent("thumbnailLoaded")}},layoutImages:function(g,h,k){var l=this;var c=l.returnOrientation();if(!!g){if(g.clientWidth==0){if(h.clientWidth!=0){g=h}else{g=k}}if(g.type=="sectionpage"){if(g==h){g=k}else{g=h}}l.pageWidth=l.element.dom.clientWidth;l.pageHeight=l.element.dom.clientHeight;l.imageWidth=g.naturalWidth;l.imageHeight=g.naturalHeight;l.imagePageWidth=l.pageWidth;l.imagePageHeight=l.pageHeight;l.initialTranslateX=0;l.initialTranslateY=0;if(c=="landscape"&&l._mode=="double"){l.layoutImagesDoublePageMode(h,k)}else{l.layoutImagesSinglePageMode(h,k)}if(g.clientWidth!=0&&g.pageNumber!=-1){l.initialImageWidth=g.clientWidth;l.initialImageHeight=g.clientHeight}else{if(h.clientWidth!=0&&h.pageNumber!=-1){if(h.clientWidth%2==1){l.initialImageWidth=h.clientWidth-0.5}else{l.initialImageWidth=h.clientWidth}if(h.clientHeight%2==1){l.initialImageHeight=h.clientHeight-0.5}else{l.initialImageHeight=h.clientHeight}}else{if(k.clientWidth!=0&&k.pageNumber!=-1){if(k.clientWidth%2==1){l.initialImageWidth=k.clientWidth-0.5}else{l.initialImageWidth=k.clientWidth}if(k.clientHeight%2==1){l.initialImageHeight=k.clientHeight-0.5}else{l.initialImageHeight=k.clientHeight}}}}if(l.initialImageHeight<l.imagePageHeight&&l.zoomMode=="fit"){var b=(l.imagePageHeight-l.initialImageHeight)/2;l.initialTranslateY=b}else{if(h.type=="leftHandAd"&&h.adType!="image"){var d=(l.imagePageWidth-l.initialImageWidth)/2;if(c=="landscape"&&l._mode=="double"&&l.zoomMode=="fit"){d=(l.imagePageWidth-l.initialImageWidth)}else{if(c=="landscape"&&l._mode=="double"&&l.zoomMode=="fill"){d=0}}l.initialTranslateX=d}}l.offsetX=0;l.offsetY=0;if(h.stayHidden==null){h.style.visibility="inherit"}else{h.style.visibility="hidden"}if(k.stayHidden==null){k.style.visibility="inherit"}else{k.style.visibility="hidden"}var e=l.portraitMediaDiv;var f=l.landscapeMediaDiv;var m=l.portraitTileDivImage.dom;var a=l.landscapeTileDivImage.dom;e.style.height=f.style.height=parseInt(l.initialImageHeight)+"px";e.style.width=f.style.width=parseInt(l.initialImageWidth)+"px";if(l.scroller!=null&&l.scroller.maxPosition!=null&&l.scroller.maxPosition.y==0&&Ext.os.is.iOS){try{l.scroller.refresh(l.scroller)}catch(j){console.error("[ReaderPageViewer]: Error Caught\n",j)}}}else{try{console.warn("No image for page "+(parseInt(l.getPageNo())+1))}catch(j){console.warn("[ReaderPageViewer] Error Caught:\n",j)}}},layoutImagesDoublePageMode:function(c,e){var d=this;if(d.zoomMode=="fill"){if($(window).width()%2==1){d.imagePageWidth=$(window).width()-0.5}else{d.imagePageWidth=$(window).width()}}else{d.imagePageWidth=(d.pageWidth/2)}d.widthRatio=d.imagePageWidth/d.imageWidth;d.heightRatio=d.imagePageHeight/d.imageHeight;d.scale=1;if(d.zoomMode=="fit"&&d.widthRatio>d.heightRatio){c.style.height=d.imagePageHeight+"px";c.style.width="auto";e.style.height=c.style.height;e.style.width=c.style.width;var b=0;if(e.type=="sectionpage"){b=c.clientWidth;e.style.width=b+"px";e.style.height="auto"}else{if(c.type=="sectionpage"){b=e.clientWidth;c.style.width=b+"px";c.style.height="auto"}else{b=Math.max(c.clientWidth,e.clientWidth)}}if(Ext.browser.is.Firefox){if(d.getPageNo()==0){d.portraitTileDiv.dom.style.display="none"}else{d.portraitTileDiv.dom.style.display=""}}if(c.type=="leftHandAd"){c.style.height="";c.style.width="";e.style.height="";e.style.width="";e.style.height=d.imagePageHeight+"px";e.style.width="auto";c.style.height="auto";c.style.width=$(e).width()+"px";d.initialTranslateX=($(document).width()-($(e).width()*2))/2}else{d.initialTranslateX=((d.pageWidth-((b*2)*d.scale))/2)}}else{if(d.zoomMode=="fit"){c.style.width=(d.imagePageWidth)+"px"}else{c.style.width=(d.imagePageWidth)/2+"px"}c.style.height="auto";e.style.width=c.style.width;e.style.height=c.style.height;if(c.type=="leftHandAd"&&c.adType!="dfp"&&c.adType!="url"&&c.adType=="adbridg"){if(c.clientHeight>e.clientHeight){c.style.width="auto";c.style.height=e.clientHeight+"px";var a=((e.clientWidth-c.clientWidth)/2);if(a>0){c.style.marginLeft=a+"px";c.style.marginRight=(a-1)+"px"}}}}if(c.type=="leftHandAd"&&c.adType=="dfp"){d.setupDfpLeftSideAdvert()}else{if(c.type=="leftHandAd"&&c.adType=="image"){d.setupImageLeftSideAdvert(c)}else{if(c.type=="leftHandAd"&&c.adType=="url"){d.setupUrlLeftSideAdvert()}else{if(c.type=="leftHandAd"&&c.adType=="adbridg"){if(d.hasAdvertLoaded){d.resizeAdbridg()}else{d.setupAdbridgLeftSideAdvert()}}}}}},setupUrlLeftSideAdvert:function(){var c=this;if(!c.hasAdvertLoaded){c.advertDiv=document.createElement("iframe");c.advertDiv.id=c.id+"leftSideAd";c.advertDiv.style["float"]="right";c.advertDiv.onload=function(){c.setupAdvertTouchEvents()};c.advertDiv.src=settings.leftSideAd.advertUrl;if(settings.leftSideAd.adSizes==null){c.resizeUrlAdvert()}c.advertDiv.style.border="none";c.advertContainer=document.createElement("div");c.advertContainer.className="urlLeftHandAd";c.advertContainer.style.display="inline-block";c.advertContainer.style.verticalAlign="middle";c.advertContainer.style.zIndex="9999999";c.advertContainer.style.position="relative";c.advertContainer.appendChild(c.advertDiv);c.image.style.width="";if(Ext.browser.is.Firefox||Ext.os.is.Android){c.image.style.marginLeft="";c.image.style.marginRight=""}c.zoomDiv.dom.insertBefore(c.advertContainer,c.image);if(settings.leftSideAd.adSizes!=null){c.adWidth=768;c.adHeight=1024;try{if(settings.leftSideAd.adSizes!=null){var b=settings.leftSideAd.adSizes.split(",");if(b!=null&&b.length==2){c.adHeight=parseInt(b[1]);c.adWidth=parseInt(b[0])}}var d=$(c.zoomDiv.dom).find("iframe");if(d[0]!=null){c.iframe=d[0];c.iframe.style.height=c.adHeight+"px";c.iframe.style.width=c.adWidth+"px";c.thisFrameContent=c.iframe.contentDocument||c.iframe.contentWindow.document;c.resizeDfp()}}catch(a){}}c.hasAdvertLoaded=true}},setupAdvertTouchEvents:function(){var e=this;var d=e.advertDiv;if(d!=null){var c=d;var a=c.contentDocument?c.contentDocument:c.contentWindow;e.info={y:0,previous:{y:0},previousTime:{y:0}};try{var f=a.getElementsByTagName("a");$(f).click(function(h){var g=$(h.target).attr("href");if(!g.startsWith("http://")&&!g.startsWith("https://")&&!g.startsWith("mailto:")&&!g.startsWith("tel:")){g="http://"+g}if(g.indexOf("mailto:")!=-1){window.location.href=g}else{window.open(g,"_blank")}});a.addEventListener("touchstart",function(g){e.dragStart(g)},{passive:false});a.addEventListener("touchmove",function(g){e.drag(g)},{passive:false});a.addEventListener("touchend",function(g){e.dragEnd(g)},{passive:false})}catch(b){console.error("ERROR: Cannot setup event listeners",b)}}},dragStart:function(b){var a=this;var d=b.changedTouches[0].screenX;var c=b.changedTouches[0].screenY;a.startX=d;a.startY=c;b.absDeltaX=1;b.absDeltaY=0;b.deltaX=1;b.deltaY=0;a.info.time=b.timeStamp;a.parent.onDragStart(b)},drag:function(b){var a=this;var d=b.changedTouches[0].screenX-a.startX;var c=b.changedTouches[0].screenY-a.startY;b.absDeltaX=d;b.absDeltaY=c;b.deltaX=d;b.deltaY=c;a.info.time=b.timeStamp;a.info.previous.x=a.info.x;a.info.previousTime.x=a.info.time;a.info.x=b.deltaX;a.parent.onDrag(b)},dragEnd:function(c){var a=this;var f=c.changedTouches[0].screenX-a.startX;var d=c.changedTouches[0].screenY-a.startY;c.absDeltaX=f;c.absDeltaY=d;c.deltaX=f;c.deltaY=d;a.info.time=c.timeStamp;var b=a.info.time-a.info.previousTime.x;c.flick={velocity:{}};if(b>0){c.flick.velocity.x=(a.info.x-a.info.previous.x)/b;c.flick.velocity.y=0}a.parent.onDragEnd(c)},resizeUrlAdvert:function(){var a=this;if(a.advertDiv!=null){if(settings.leftSideAd.adSizes!=null){a.resizeDfp()}else{if(a.returnOrientation()=="landscape"&&a._mode=="double"){a.advertDiv.style.width=$(a.landscapeimage).width()+"px";a.advertDiv.style.height=$(a.landscapeimage).height()+"px";a.advertDiv.style.display="inline-block";a.image.style.width=""}else{a.advertDiv.style.display="none"}}}},setupImageLeftSideAdvert:function(c){var b=this;if(typeof settings!="undefined"&&settings.leftSideAd!=null&&settings.leftSideAd.link!=null&&settings.leftSideAd.link!=""){b.landscapeimage.style.position="relative";b.landscapeimage.style.top=b.initialTranslateY+"px";var a=function(){window.open(settings.leftSideAd.link)};b.setupManualTapEvent(b.portraitMediaDiv,a,null)}},setupManualTapEvent:function(c,b,d){var a=typeof d!="undefined"&&d!=null?d:150;c.addEventListener("touchstart",function(f){this.timeStamp=f.timeStamp});c.addEventListener("touchend",function(f){if(f.timeStamp-this.timeStamp<a){b()}})},setupDfpLeftSideAdvert:function(){var c=this;if(!c.hasAdvertLoaded){if(c.advertContainer!=null){$(c.advertContainer).remove()}c.adWidth=768;c.adHeight=1024;if(currentProfile=="phone"){c.adWidth=320;c.adHeight=480}try{if(settings.leftSideAd.adSizes!=null){var b=settings.leftSideAd.adSizes.split(",");if(b!=null&&b.length==2){c.adHeight=parseInt(b[1]);c.adWidth=parseInt(b[0])}}}catch(a){}c.hasAdvertLoaded=true;c.advertDiv=document.createElement("div");c.advertDiv.id=c.id+c.adCounter+"leftSideAd";c.advertDiv.style["float"]="right";c.advertContainer=document.createElement("div");c.advertContainer.className="dfpLeftHandAd";c.advertContainer.style.width=$(c.landscapeimage).width()+"px";c.advertContainer.style.height=$(c.landscapeimage).height()+"px";c.advertContainer.style.display="inline-block";c.advertContainer.style.verticalAlign="middle";c.advertContainer.style.zIndex="9999999";c.advertContainer.style.position="relative";c.advertContainer.appendChild(c.advertDiv);c.image.style.width="";if(Ext.browser.is.Firefox||Ext.os.is.Android){c.image.style.marginLeft="";c.image.style.marginRight=""}c.zoomDiv.dom.insertBefore(c.advertContainer,c.image);c.setDfp();c.adCounter++}},setupAdbridgLeftSideAdvert:function(){var b=this;if(!!b.advertDiv){return}var c=function(d){if(!!b.advertDiv&&d.slot.getSlotElementId()==b.advertDiv.id){b.adbridgSize=d.size;b.resizeAdbridg();a.removeEventListener("slotRenderEnded",c)}};var a=googletag.pubads().addEventListener("slotRenderEnded",c);b.hasAdvertLoaded=true;b.advertDiv=document.createElement("div");b.advertDiv.id=b.id+b.adCounter+"leftSideAd";b.advertDiv.style["float"]="right";b.advertContainer=document.createElement("div");b.advertContainer.className="dfpLeftHandAd";b.advertContainer.style.width=b.imagePageWidth+"px";b.advertContainer.style.height="auto";b.advertContainer.style.display="inline-block";b.advertContainer.style.verticalAlign="middle";b.advertContainer.style.zIndex="9999999";b.advertContainer.style.position="relative";b.advertContainer.appendChild(b.advertDiv);b.image.style.width="";if(Ext.browser.is.Firefox||Ext.os.is.Android){b.image.style.marginLeft="";b.image.style.marginRight=""}b.zoomDiv.dom.insertBefore(b.advertContainer,b.image);console.log(b.advertDiv);b.checkAdbridg(b.advertDiv);b.resizeAdbridg()},checkAdbridg:function(b){var a=this;if(!!b&&(typeof settings!="undefined"&&settings.leftSideAd&&settings.leftSideAd.type=="adbridg")){b.setAttribute("data-adbridg-ad-class","adb-ee-sponsorship")}},setDfp:function(){var a=this;if(a.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([a.adSlot1])}googletag.cmd.push(function(){a.adSlot1=googletag.defineSlot("/"+settings.leftSideAd.networkcode+"/"+settings.leftSideAd.adunit,[a.adWidth,a.adHeight],a.advertDiv.id);a.adSlot1.addService(googletag.pubads());googletag.pubads().addEventListener("slotRenderEnded",function(c){if(c.slot==a.adSlot1){a.leftHandAdLoaded=!c.isEmpty;if(c.isEmpty&&settings.reader.bannerAd!=null&&settings.newsday!=null&&settings.newsday.showBannerOnLeftAdFailure=="true"){a.fireEvent("loadBannerAd")}a.resizeDfp()}});a.setDfpTargeting(a.adSlot1);googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDiv.id);try{if(googletag.pubads().isInitialLoadDisabled()){googletag.pubads().refresh([a.adSlot1])}}catch(c){console.warn("[ReaderPageViewer]: Error Caught\n",c)}});var b=$(a.zoomDiv.dom).find("iframe");if(b[0]!=null){a.iframe=b[0];a.thisFrameContent=a.iframe.contentDocument||a.iframe.contentWindow.document;a.resizeDfp()}},setDfpTargeting:function(f){var d=this;if(settings.leftSideAd&&settings.leftSideAd.targeting!=null&&settings.leftSideAd.targeting.length>0){var a=settings.leftSideAd.targeting.split("|");for(var c in a){var e=a[c];var b=e.split("*");if(b!=null&&b.length>=2){b[1]=b[1].replace("{{PAGE}}",d.pageNumber).replace("{{SECTION}}",d.section);f.setTargeting(b[0],b[1])}}}},setDfpTouchEvents:function(a){var b=this;if(a!=null){a.addEventListener("touchstart",function(c){b.frameDragStart(c)});a.addEventListener("touchmove",function(c){b.frameDrag(c);c.preventDefault()});a.addEventListener("touchend",function(c){b.frameDragEnd(c)})}},frameDragStart:function(b){var a=this;a.infiniteCarousel=a.returnInfiniteCarousel();a.infiniteCarousel.frameDragStart(b)},frameDrag:function(b){var a=this;a.infiniteCarousel.frameDrag(b)},frameDragEnd:function(b){var a=this;a.infiniteCarousel.frameDragEnd(b)},returnInfiniteCarousel:function(){var a=this;return a.parent},resizeAdbridg:function(){var e=this;var d=$(e.landscapeimage).height();var b=$(e.landscapeimage).width();if(!d||!b){console.log("NO WIDTH OR HEIGHT");return}if(!!e.adbridgSize){var a=e.adbridgSize[0];var c=e.adbridgSize[1]}var f=1;if(a>b){f=b/a}if((c*f)>d){f=d/c}if(e.advertContainer!=null){e.advertContainer.style.width=$(e.landscapeimage).width()+"px";e.advertContainer.style.height=$(e.landscapeimage).height()+"px";e.applyAdvertScale(f);e.image.style.width=""}},resizeDfp:function(){var c=this;var b=$(c.landscapeimage).height();var a=c.adHeight;var d=1;if(a>b){d=b/a}if(c.advertContainer!=null){c.advertContainer.style.width=$(c.landscapeimage).width()+"px";c.advertContainer.style.height=$(c.landscapeimage).height()+"px";c.applyAdvertScale(d);c.image.style.width=""}},applyAdvertScale:function(d){var a=this;var c="100% 0%";a.advertDiv.style.webkitTransformOrigin=c;a.advertDiv.style.MozTransformOrigin=c;a.advertDiv.style.msTransformOrigin=c;a.advertDiv.style.transformOrigin=c;var b="scale3d("+d+", "+d+", 1)";a.advertDiv.style.webkitTransform=b;a.advertDiv.style.MozTransform=b;a.advertDiv.style.msTransform=b;a.advertDiv.style.transform=b},layoutImagesSinglePageMode:function(a,c){var b=this;b.widthRatio=b.imagePageWidth/b.imageWidth;b.heightRatio=b.imagePageHeight/b.imageHeight;b.scale=1;if(Ext.browser.is.Firefox){b.portraitTileDiv.dom.style.display=""}if(b.zoomMode=="fit"&&b.widthRatio>b.heightRatio){a.style.height=b.imagePageHeight+"px";a.style.width="auto";c.style.height=a.style.height;c.style.width=a.style.width;var d=b.zoomDiv.dom.clientWidth;if(d==a.naturalWidth||d==c.naturalWidth||d==0){d=Math.max(a.clientWidth,c.clientWidth)}if(b._mode=="single"&&b.image!=null&&b.image.type=="leftHandAd"&&(b.image.adType=="dfp"||b.image.adType=="url"||b.image.adType!="adbridg")&&b.advertContainer!=null){d-=$(b.advertContainer).width()}b.initialTranslateX=((b.pageWidth-(d*b.scale))/2)}else{a.style.width=b.imagePageWidth+"px";a.style.height="auto";c.style.width=a.style.width;c.style.height=a.style.height}b.landscapeimage.style.position="";b.landscapeimage.style.top=""},paintCheck:function(){var a=this;if(a.hasPainted&&(a.pageWidth==0||a.initialImageWidth==null)){return false}return true},completeImageLoaded:function(b,f){var c=this;var a=c.image;var d=c.landscapeimage;mainPanel.fireEvent("removeSplash");if(c.isinitialized&&!c.isDestroyed){var e=c.imagetoload;if(c.thumbnailLoaded){c.loadTileImages(f)}else{c.on("thumbnailLoaded})}c.tryRenderMedia(b)}else{if(!c.isDestroyed){c.on("thumbnailLoaded",function(){if(!c.isDestroyed){c.loadTileImages(function(){});c.tryRenderMedia(b)}});if(f!=null){f()}}}},tryRenderMedia:function(b){var c=this;if(b&&!c.renderedMedia){var a=c.image;var d=c.landscapeimage;c.loadMediaImage("portrait",a);c.loadMediaImage("landscape",d);c.renderedMedia=true}},tryReloadGIF:function(){var b=this;if(b.renderedMedia){var a=b.image;var c=b.landscapeimage;b.reloadMediaGIF("portrait",a);b.reloadMediaGIF("landscape",c)}},reloadMediaGIF:function(b,e){var c=this;if(e.type!="sectionpage"){var a=flatPlanData.reversePageMapper[c.image.pageNumber-1]+1;var d=c.portraitMediaDiv;if(b=="landscape"){a=flatPlanData.reversePageMapper[c.landscapeimage.pageNumber];d=c.landscapeMediaDiv}if(e.type=="page"){c.fireEvent("reloadGIF",c,a-pageOffset,d)}}},loadMediaImage:function(b,e){var c=this;if(e.type!="sectionpage"){var a=flatPlanData.reversePageMapper[c.image.pageNumber-1]+1;var d=c.portraitMediaDiv;if(b=="landscape"){a=flatPlanData.reversePageMapper[c.landscapeimage.pageNumber];d=c.landscapeMediaDiv}if(e.type=="page"){c.fireEvent("loadMedia",c,a-pageOffset,d)}else{$(d).empty()}c.mediaLoaded=true}},loadTileImages:function(e){var b=this;if(!b.hasLoaded){var d=b.imagetoload;var a=b.image;var c=b.landscapeimage;if(d.pageNumber==a.pageNumber){b.loadTileImage(a,function(){b.loadTileImage(c,function(){b.hasLoaded=true;b.canTile=true;if(e!=null){e()}})})}else{b.loadTileImage(c,function(){if(a.type=="leftHandAd"){b.hasLoaded=true;b.canTile=true;if(e!=null){e()}}b.loadTileImage(a,function(){b.hasLoaded=true;b.canTile=true;if(e!=null){e()}})})}}else{if(e!=null){e()}}},loadTileImage:function(b,j){var f=this;if(f.isinitialized){if(b.pageNumber>0){if(b.src.indexOf("data:image/jpeg;base64")!=-1||(b.src.indexOf("pages.mobile.cdn.pagesuite.com")!=-1||b.src.indexOf("pages.cdn.pagesuite.com")!=-1||b.src.indexOf("pages.pagesuite.com")!=-1||b.src.indexOf("pagesn.pagesuite.com")!=-1||b.src.indexOf("pagesuite.com")!=-1)){if(b.tiled==null){b.largecached=false;var c={tiled:false,pageNumber:b.pageNumber,portraitshow:b.portraitshow,imageparts:[],guid:b.guid};if(b.portraitshow){f.portraitTileImage=c}else{f.landscapeTileImage=c}if(c.pageNumber>=1){var h=f.checkDataForTileImage(b);if(h){if(h.largecached){b.largecached=true}f.setUpTiledImage(c,h.tileImage);j()}else{var d=f.retrievePageGuidImage(b);var g=settings.page;var a=150;if(g.lowres!=null){a=g.lowres}var e=function(){j()};f.requestPage(a,b,c,f.loadedTileImage,false,e)}}}else{j()}}else{j()}}else{j()}}},loadLargeTileImage:function(e){var d=this;if(e.pageNumber>=1){if(e.src.indexOf("data:image/jpeg;base64")!=-1||(e.src.indexOf("pages.mobile.cdn.pagesuite.com")!=-1||e.src.indexOf("pages.cdn.pagesuite.com")!=-1||e.src.indexOf("pages.pagesuite.com")!=-1||e.src.indexOf("pagesn.pagesuite.com")!=-1||e.src.indexOf("pagesuite.com")!=-1)){if(!e.largecached){var c={tiled:false,pageNumber:e.pageNumber,portraitshow:e.portraitshow,imageparts:[],guid:e.guid};var a=settings.page;var b=325;if(a.highres!=null){b=a.highres}d.requestPage(b,e,c,d.loadedTileImage,true,function(){})}}}},requestPage:function(b,c,d,l,m,k){var h=this;var e=h.retrievePageGuidImage(c);var f="";if(settings.page.pdf!=null){f="&pdf="+settings.page.pdf.replace(".pdf","")}if(c.type!="leftHandAd"&&c.type!="sectionpage"){var g="https://pages.pagesuite.com/";if(flatPlanData.pagesDomain!=null){g=flatPlanData.pagesDomain+"/"}if(settings.page!=null&&settings.page.encryptionVersion=="2"){var a=g+e[0]+"/"+e[1]+"/"+e+"/tile/page_90_"+b+"_crypt.json"}else{if(settings.page!=null&&settings.page.encryptionVersion=="4"){var a=g+e[0]+"/"+e[1]+"/"+e+"/tile/page_90_"+b+"_cryptv4.json"}else{var a=g+e[0]+"/"+e[1]+"/"+e+"/tile/page_90_"+b+".json"}}var j=h.returnEditionPage(c);if(j.request==null||m){j.request=$.ajax({crossDomain:true,type:"GET",contentType:"application/json",async:true,cache:true,url:a,success:function(n){l(h,c,d,n,m,k);$(j.request).trigger("loaded")},error:function(o){if(o.statusText!="abort"){var n="https://tile.html5.pagesuite-professional.co.uk/get_image_jpg_tile.aspx";if(settings.page.customTilingURL!=null){n=settings.page.customTilingURL}var p=n+"?edid="+editionguid+"&pguid="+e+"&dpi="+b+f;$.ajax({crossDomain:true,type:"GET",contentType:"application/json",async:true,cache:true,url:p,succes}})}}});activerequest={page:j}}else{$(j.request).on("loaded})}}},loadedTileImage:function(g,h,b,f,a,e){var d=g;var c=d.createImagesArray(f,b,h);d.setCache(h,c,a);d.setUpTiledImage(b,c);if(h.portraitshow){d.portraitTileImage=b}else{d.landscapeTileImage=b}e()},createImagesArray:function(e,d,g){var h=this;var c=[];for(var f=0;f<e.images.length;f++){var b=document.createElement("img");var j=e.images[f];var a=j.url;if(window.location.protocol=="https:"){a=a.replace("http://pages.cdn.pagesuite.com",flatPlanData.pagesDomain)}d.guid=g.guid;d.type=g.type;h.setImageSrc(b,a,d);b.startX=j.startX;b.startY=j.startY;b.width=j.width;b.height=j.height;c.push(b)}return c},setCach},retrievePageGuid:function(c){var b=c.image.split("/");var a=b[b.length-2];return a},retrievePageGuidImage:function(f){var e=this;var c=editionFlatplanData.pageGroups;if(f.pageNumber>=1){var a=c[(f.pageNumber-1)].pages[0];if(a.image!=null){var d=a.image.split("/");var b=d[d.length-2];return b!=null&&b.length>20?b:""}}return""},returnEditionPag},checkDataForTileImag},setUpTiledImage:function(b,e){var d=this;var c=e;if(!d.canvasInitialized){d.setUpCanvas()}for(var a=0;a<c.length;a++){var g=c[a];if(g.naturalWidth!=0){if(!(d.returnOrientation()=="portrait"&&!b.portraitshow)){var };f(g)}}else{$(g).one("load})}}b.imageparts=c;b.tiled=true},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android||(Ext.os.is.iOS&&currentProfile!="desktop")){if(currentProfile=="phone"&&Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(window.innerWidth>window.innerHeight){a="landscape"}else{a="portrait"}}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},toggleDPS:function(){var a=this;a.disableTiling();if(a._mode=="double"){a._mode="single"}else{a._mode="double";a.hasAdvertLoaded=false}if(settings.reader.savePageMode=="true"){localStorage.setItem("pageMode_"+publicationguid,a._mode)}a.renderedMedia=false;a.adjustPageOnToggleDPS();a.resetPage();a.resetZoom();a.toggleLeftHandAdvert();a.pauseVideos();if(Ext.os.is.Phone){a.fireEvent("checkPagesBrowser")}},toggleLeftHandAdvert:function(){var a=this;if(a._mode=="single"){if(a.advertContainer!=null){a.advertContainer.style.display="none"}}else{if(a.advertContainer!=null&&a.image!=null&&a.image.type=="leftHandAd"&&(a.image.adType=="dfp"||a.image.adType=="url"||a.image.adType=="adbridg")&&a.getPageNo()<=0){a.advertContainer.style.display="inline-block"}else{if(a.advertContainer!=null){a.advertContainer.style.display="none"}}}},adjustPageOnToggleDPS:function(){var m=this;var h=m.image;var l=m.landscapeimage;var f=m.parent.getActiveItem();var n=m.getPageNo();var g=0;var j=n-f.getPageNo();var e=m.mappedPageNumber;if(e==null){m.setMappedPageNo();e=Math.min(m.mappedPageNumber,flatPlanData.pageGroups.length-1-pageOffset)}var c=f.mappedPageNumber;var k=e-c;if(f.xtype=="readeradvertpageviewer"){if(m._mode=="single"){if(e>c){if(f.config.side=="right"){m.setPageNo(f.getPageNo()+1)}else{m.setPageNo(f.getPageNo()+2)}}else{if(f.config.side=="left"){m.setPageNo(f.getPageNo()-1)}else{m.setPageNo(f.getPageNo()-2)}}}else{var d=0;if(f.config.side=="right"){if((n+d)%2==0){m.setPageNo(n)}else{m.setPageNo(n+1)}}else{if((n+d)%2==0){m.setPageNo(n)}else{m.setPageNo(n+1)}}}}else{if(((m.image.type=="sectionpage"||m.landscapeimage.type=="sectionpage")&&(k==1||k==-1))||(f.xtype=="readeradvertpageviewer")){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}if(k==0){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}else{if(k>0){if(m._mode=="single"){if(k%2==1){if(k==1){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}else{var a=j-2;var b=n-a;m.setPageNo(b)}}else{var a=j/2;var b=n-a;m.setPageNo(b)}}else{n-=g;var b=Math.min(n+j,flatPlanData.pageGroups.length-1-pageOffset);m.setPageNo(b)}}else{if(m._mode=="single"){if(k%2==-1){if(k==-1){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}else{var a=j+2;var b=n-a;m.setPageNo(b)}}else{var a=j/2;var b=n-a;m.setPageNo(b)}}else{n-=g;var b=Math.max(0,(n+j));m.setPageNo(b)}}}}m.parent.returnPage=m.parent.config.returnPage;m.setPage(m.parent.returnPage(m.getPageNo(),false));m.setPreviousPage(m.parent.returnPage(m.getPageNo()-1,true));m.setNextPage(m.parent.returnPage(m.getPageNo()+1,true));m.resetImages()},resetImages:function(){var c=this;c.image.src="";c.landscapeimage.src="";var a=Math.max(Math.min(c.getPageNo(),flatPlanData.pageGroups.length-1-pageOffset),0);c.mappedPageNumber=flatPlanData.reversePageMapper[a+1]-1;var b=c.returnAdvertOffset(a+1+pageOffset);if(c.mappedPageNumber%2==0){c.imagetoload=c.landscapeimage;c.landscapeimage.onload=function(){c.imageLoaded()};c.image.onload=function(){}}else{c.imagetoload=c.image;c.image.onload=function(){c.imageLoaded()};c.landscapeimage.onload=function(){}}if(c.portraitTileImage!=null){c.portraitTileImage.src="";c.portraitTileImage.tiled=false}if(c.landscapeTileImage!=null){c.landscapeTileImage.src="";c.landscapeTileImage.tiled=false}if(c.isinitialized){c.setUpImages()}if(c!=c.parent.getActiveItem()){$(c.landscapeMediaDiv).empty();$(c.portraitMediaDiv).empty()}c.mediaLoaded=false;c.thumbnailLoaded=false;c.hasLoaded=false;c.completeImageLoaded(c==c.parent.getActiveItem(),function(){})},onResize:function(c){var b=this;var f=0;if(b.returnOrientation()!=b.orientation){b.orientation=b.returnOrientation();b.renderedMedia=false;b.disableTiling();b.adjustPageOnResize();b.resetPage();b.resetZoom();b.fireEvent("resizeClipping");if(Ext.os.is.Phone){b.fireEvent("checkPagesBrowser")}}else{var e=b.imagetoload;var a=b.image;var d=b.landscapeimage;b.layoutImages(e,a,d);b.resetPage();b.resetZoom()}b.toggleLeftHandAdvert();if(b.image!=null&&b.image.type=="leftHandAd"&&(b.image.adType=="dfp"||b.image.adType=="adbridg")){b.image.adType=="dfp"?b.resizeDfp():b.resizeAdbridg()}else{if(b.image!=null&&b.image.type=="leftHandAd"&&b.image.adType=="url"){b.resizeUrlAdvert()}}},adjustPageOnResize:function(){var m=this;var h=m.image;var l=m.landscapeimage;var f=m.parent.getActiveItem();var n=m.getPageNo();var g=0;var j=n-f.getPageNo();var e=m.mappedPageNumber;var c=f.mappedPageNumber;var k=e-c;if(f.xtype=="readeradvertpageviewer"){if((m.returnOrientation()=="portrait"&&m._mode=="double")){if(e>c){if(f.config.side=="right"){m.setPageNo(f.getPageNo()+1)}else{m.setPageNo(f.getPageNo()+2)}}else{if(f.config.side=="left"){m.setPageNo(f.getPageNo()-1)}else{m.setPageNo(f.getPageNo()-2)}}}else{if((m.returnOrientation()=="landscape"&&m._mode=="double")){var d=0;if(f.config.side=="right"){if((n+d)%2==0){m.setPageNo(n)}else{m.setPageNo(n+1)}}else{if((n+d)%2==0){m.setPageNo(n)}else{m.setPageNo(n+1)}}}else{if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}}}else{if(m._mode=="single"){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}if(((m.image.type=="sectionpage"||m.landscapeimage.type=="sectionpage")&&(k==1||k==-1))||f.xtype=="readeradvertpageviewer"){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}if(k==0){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}else{if(k>0){if(m.returnOrientation()=="portrait"){if(k%2==1){if(k==1){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}else{var a=j-2;var b=n-a;m.setPageNo(b)}}else{var a=j/2;var b=n-a;m.setPageNo(b)}}else{n-=g;var b=Math.min(n+j,flatPlanData.pageGroups.length-1-pageOffset);m.setPageNo(b)}}else{if(m.returnOrientation()=="portrait"){if(k%2==-1){if(k==-1){if(m.isinitialized){m.setUpImagesCSS();m.layoutImages(m.imagetoload,m.image,m.landscapeimage)}return}else{var a=j+2;var b=n-a;m.setPageNo(b)}}else{var a=j/2;var b=n-a;m.setPageNo(b)}}else{n-=g;var b=Math.min(Math.max(0,(n+j)),flatPlanData.pageGroups.length-1);m.setPageNo(b)}}}}m.parent.returnPage=m.parent.config.returnPage;m.setPage(m.parent.returnPage(m.getPageNo()));m.setPreviousPage(m.parent.returnPage(m.getPageNo()-1));m.setNextPage(m.parent.returnPage(m.getPageNo()+1));m.resetImages()},onDragStart:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDrag:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDragFinished:function(c){var b=this;var a=b.scroller.position;b.zoomPosition=b.scroller.position;if(b.scale>1){c.stopPropagation()}},onDoubleTap:function(b){var m=this;var c=true;var f=(b.pageX);var e=(b.pageY)-40;if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){var d=Ext.Viewport.query("readerbannerad");if(d.length>0){e-=d[0].getHeight()}}var k=f+m.scroller.position.x;var j=e+m.scroller.position.y;var n=(m.translateX-m.initialTranslateX);m.zoomPointX=(k/m.scale)+(n);m.zoomPointY=((j)/(m.scale));m.offsetX=(f-m.zoomPointX);m.offsetY=(e-m.zoomPointY);m.offsetScrollerX=m.offsetX+m.scroller.position.x;m.offsetScrollerY=m.offsetY+m.scroller.position.y;if(settings.reader.doubleTapFullZoom!=null&&settings.reader.doubleTapFullZoom=="false"){c=false}if(c){if(m.scale==1){m.initializeTouch(m.zoomPointX,m.zoomPointY);m.scale=m.getMaxScale();if(document.getElementById("slider")!=null){document.getElementById("slider").value=m.getMaxScale();m.hideNavButtons()}}else{m.resetPage();m.showNavButtons()}}else{var a=parseFloat(m.getMaxScale().toFixed(2));var o=parseFloat(((a-1)/m.zoomLevels).toFixed(2));if(m.scale>1&&m.scale<a){for(var h=1;h<=m.zoomLevels;h++){var l=(parseFloat(o*h)+1);if(m.scale<l){m.currentZoomLevel=h;break}}}else{if(m.scale>=a){m.currentZoomLevel=m.zoomLevels+1}else{m.currentZoomLevel=1}}var g=(parseFloat(o*m.currentZoomLevel)+1);if(m.currentZoomLevel<m.zoomLevels){m.initializeTouch(m.zoomPointX,m.zoomPointY);m.translateX+=m.offsetScrollerX;m.translateY+=m.offsetScrollerY;m.scale=g;m.zoomLevel="mid";m.applyTransform(m.scale)}else{if(m.currentZoomLevel<=m.zoomLevels){m.initializeTouch(m.zoomPointX,m.zoomPointY);m.translateX+=m.offsetScrollerX;m.translateY+=m.offsetScrollerY;m.scale=a;m.zoomLevel="full";m.applyTransform(m.scale)}else{m.zoomLevel="none";m.resetPage();m.fireEvent("showWrapAds");if(m.zoomMode=="fit"&&m.mode=="double"){m.showNavButtons()}else{m.hideNavButtons()}}}}m.finishZoom();m.trackZoomLevel()},trackZoomLevel:function(){var a=this;mainPanel.fireEvent("trackZoomLevel",a)},onPinchStart:function(d){var c=this;c.disableTiling();c.tryDisableMedia();c.startDistance=d.distance;var g=((d.touches[0].pageX+d.touches[1].pageX)/2);var e=((d.touches[0].pageY+d.touches[1].pageY)/2);if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){var h=Ext.Viewport.query("readerbannerad");if(h.length>0){e-=h[0].getHeight()}}var b=g+c.scroller.position.x;var a=e+c.scroller.position.y;var f=(c.translateX-c.initialTranslateX);c.zoomPointX=((b)/(c.scale))+f;c.zoomPointY=((a)/(c.scale));c.offsetX=(g-c.zoomPointX);c.offsetY=(e-c.zoomPointY);c.offsetScrollerX=c.offsetX+c.scroller.position.x;c.offsetScrollerY=c.offsetY+c.scroller.position.y;c.initializeTouch(c.zoomPointX,c.zoomPointY);c.translateX+=c.offsetScrollerX;c.translateY+=c.offsetScrollerY;c.applyTransform(c.scale)},onPinch:function(b){var a=this;if(a.dontPinch==true){return}a.currentScale=Math.min(((b.distance/a.startDistance)*a.scale),a.getMaxScale());a.applyTransform(a.currentScale);if(a.currentScale>=1.5){}},onPinchEnd:function(b){var a=this;if(a.currentScale<=1){a.resetPage();a.finishZoom()}else{a.scale=a.currentScale;a.finishZoom()}a.tryEnableMedia();a.trackZoomLevel()},onZoomStart:function(h,d){var c=this;c.scale=d;var g=(c.pageWidth/2);var e=(c.pageHeight/2);var b=g+c.scroller.position.x;var a=e+c.scroller.position.y;var f=(c.translateX-c.initialTranslateX);c.zoomPointX=((b)/(c.scale))+f;c.zoomPointY=((a)/(c.scale));c.offsetX=0;c.offsetY=0;c.offsetScrollerX=c.offsetX+c.scroller.position.x;c.offsetScrollerY=c.offsetY+c.scroller.position.y;c.initializeTouch(c.zoomPointX,c.zoomPointY);c.translateX+=c.offsetScrollerX;c.translateY+=c.offsetScrollerY;c.applyTransform(c.scale)},onZoom:function(c,b){var a=this;a.currentScale=b.dom.valueAsNumber;a.applyTransform(a.currentScale)},onZoomEn},onChang},resetPag},initializeTouch:function(b,a){var c=this;c.elementTouchX=b-c.translateX;c.elementTouchY=a-c.translateY;c.setOrigin(c.elementTouchX,c.elementTouchY)},setOrigin:function(a,c){var b=this;b.zoomDiv.dom.style.webkitTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.MozTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.msTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.transformOrigin=a+"px "+c+"px"},applyTranslate:function(b){var a=this;a.zoomDiv.dom.style.webkitTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)";a.zoomDiv.dom.style.MozTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)";a.zoomDiv.dom.style.msTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)"},applyTransform:function(b){var a=this;a.zoomDiv.dom.style.webkitTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.MozTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.msTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.transform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)"},finishZoo},sliderZoom:function(){var d=this;if(d.mediaDiv.dom.children[0].children.length>0){for(var c=0;c<d.mediaDiv.dom.children[0].children.length;c++){try{var f=d.mediaDiv.dom.children[0].children[c].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/d.scale)+"px";f.style.padding=(5/d.scale)+"px"}}catch(g){}}}if(d.mediaDiv.dom.children[1].children.length>0){for(var c=0;c<d.mediaDiv.dom.children[1].children.length;c++){try{var f=d.mediaDiv.dom.children[1].children[c].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/d.scale)+"px";f.style.padding=(5/d.scale)+"px"}}catch(g){}}}d.scrollerDiv.dom.style.width=((d.initialImageWidth+(d.initialTranslateX/2))*d.scale)+"px";if(d.returnOrientation()=="landscape"&&d._mode=="double"){d.scrollerDiv.dom.style.width=((d.initialImageWidth+d.initialTranslateX)*d.scale*2)+"px"}d.scrollerDiv.dom.style.height=((d.initialImageHeight+d.initialTranslateY)*d.scale)+"px";d.setOrigin(0,0);d.translateX=d.initialTranslateX;d.translateY=d.initialTranslateY;d.applyTransform(d.scale);d.scroller.setDisabled(false);d.scroller.setDirection("both");var b=d.elementTouchX*d.scale;var j=b-d.zoomPointX-d.offsetX;var a=d.elementTouchY*d.scale;var h=a-d.zoomPointY-d.offsetY;d.scroller.scrollTo(j,h);if(d.canTile){d.startTiling()}d.loadLargeTileImage(d.image);d.loadLargeTileImage(d.landscapeimage)},setZoom:function(){var j=this;if(j.mediaDiv.dom.children[0].children.length>0){for(var f=0;f<j.mediaDiv.dom.children[0].children.length;f++){try{var l=j.mediaDiv.dom.children[0].children[f].children[0].children[0].children[0].children[0].children[0];if(l.className=="tool-tip"){l.style.fontSize=(12/j.scale)+"px";l.style.padding=(5/j.scale)+"px"}}catch(g){}}}if(j.mediaDiv.dom.children[1].children.length>0){for(var f=0;f<j.mediaDiv.dom.children[1].children.length;f++){try{var l=j.mediaDiv.dom.children[1].children[f].children[0].children[0].children[0].children[0].children[0];if(l.className=="tool-tip"){l.style.fontSize=(12/j.scale)+"px";l.style.padding=(5/j.scale)+"px"}}catch(g){}}}var c=Math.max(j.initialImageWidth,$(window).width());j.scrollerDiv.dom.style.width=(c*j.scale)+"px";if(j.returnOrientation()=="landscape"&&j._mode=="double"){c=Math.max(j.initialImageWidth*2,$(window).width());j.scrollerDiv.dom.style.width=(c*j.scale)+"px"}if(j.initialImageHeight==0&&j.initialImageWidth!=0){var d=j.image.clientWidth/j.image.naturalWidth;j.initialImageHeight=j.image.naturalHeight*d}j.scrollerDiv.dom.style.height=(j.initialImageHeight*j.scale)+"px";j.setOrigin(0,0);j.translateX=(j.initialTranslateX*j.scale);j.translateY=0;j.applyTransform(j.scale);j.scroller.setDisabled(false);j.scroller.setDirection("both");var k=j.elementTouchX*j.scale;var h=j.elementTouchY*j.scale;var b=k-j.zoomPointX-j.offsetX+(j.initialTranslateX*j.scale);var a=h-j.zoomPointY-j.offsetY;j.scroller.scrollTo(b,a);if(j.canTile){j.startTiling()}j.loadLargeTileImage(j.image);j.loadLargeTileImage(j.landscapeimage);j.resetScrollerOnIphone()},resetScrollerOnIphone:function(){if(Ext.os.is.iOS&&currentProfile=="phone"&&this==this.parent.getActiveItem()){this.scroller.applySize("auto");this.scroller.refresh(this.scroller)}},manuallyUpdateScrollerSize:function(){var a=this;if(Ext.os.is.iOS&&currentProfile=="phone"&&this==this.parent.getActiveItem()){this.scroller.applyContainerSize("auto");this.scroller.refresh(this.scroller)}},resetZoom:function(){var b=this;if(b.mediaDiv.dom.children[0].children.length>0){for(var a=0;a<b.mediaDiv.dom.children[0].children.length;a++){try{var c=b.mediaDiv.dom.children[0].children[a].children[0].children[0].children[0].children[0].children[0];if(c.className=="tool-tip"){c.style.fontSize="12px";c.style.padding="5px"}}catch(d){}}}if(b.mediaDiv.dom.children[1].children.length>0){for(var a=0;a<b.mediaDiv.dom.children[1].children.length;a++){try{var c=b.mediaDiv.dom.children[1].children[a].children[0].children[0].children[0].children[0].children[0];if(c.className=="tool-tip"){c.style.fontSize="12px";c.style.padding="5px"}}catch(d){}}}b.scrollerDiv.dom.style.width="";b.scrollerDiv.dom.style.height="";b.scrollTo(0,0);if(b.zoomMode=="fill"){b.scroller.setDisabled(false);b.scroller.setDirection("vertical");b.scroller.setDirectionLock(true)}else{b.scroller.setDisabled(true)}b.scroller.position.x=0;if(b.canTile){b.startTiling()}b.resetScrollerOnIphone()},stopTiling:function(){var a=this;a.disableTiling();a.canTile=false},setTiling:function(){var a=this;a.canTile=true;a.resetZoom()},enableScroller:function(){var a=this;if(a.scroller.getDisabled()&&a.scroller.manuallyDisabled!=null&&a.scroller.manuallyDisabled==true){a.scroller.setDisabled(false);a.scroller.manuallyDisabled=false}},scrollTo:function(a,c){var b=this;b.scroller.scrollTo(a,c)},onScrollEnd:function(){var a=this;a.startTiling();mainPanel.fireEvent("trackPan",a)},startTiling:function(){var a=this;if(!a.isDestroyed){if(a.canTile){a.setUpCanvas(a.portraitTileImage);a.tryTilePageImage(a.portraitTileImage);if(a.returnOrientation()=="landscape"){a.tryTilePageImage(a.landscapeTileImage)}}}},setUpCanvas:function(){var f=this;if(!f.isDestroyed){f.canvasInitialized=true;if(f.element!=null){if(f.usesCanvas){var d=Math.min(f.pageWidth,f.scrollerDiv.dom.clientWidth);var a=Math.min(f.pageHeight,f.scrollerDiv.dom.clientHeight);f.tileDiv.dom.style.width=d+"px";f.tileDiv.dom.style.height=a+"px";var e=((Math.max(f.scroller.position.x-(f.initialTranslateX*f.scale),0))/f.scale);f.tileDiv.dom.style.top=(f.scroller.position.y/f.scale)+"px";f.tileDiv.dom.style.left=e+"px";f.tileDiv.dom.style.webkitTransform="scale3d("+(1/f.scale)+","+(1/f.scale)+",1)";f.tileDiv.dom.style.MozTransform="scale("+(1/f.scale)+","+(1/f.scale)+")";f.tileDiv.dom.style.msTransform="scale3d("+(1/f.scale)+","+(1/f.scale)+",1)";var c=f.tileCanvas.getContext("2d");devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1,ratio=devicePixelRatio/backingStoreRatio;if(typeof auto==="undefined"){auto=true}if(auto&&devicePixelRatio!==backingStoreRatio){var b=d;var g=a;f.tileCanvas.width=b*ratio;f.tileCanvas.height=g*ratio;f.tileCanvas.style.width=b+"px";f.tileCanvas.style.height=g+"px";c.scale(ratio,ratio)}else{f.tileCanvas.width=d;f.tileCanvas.height=a;f.tileCanvas.style.width=d+"px";f.tileCanvas.style.height=a+"px"}f.tileCanvas.desx=(Math.max(f.scroller.position.x-(f.initialTranslateX*f.scale),0))*-1;f.tileCanvas.desxland=f.tileCanvas.desx+(f.initialImageWidth*f.scale);f.tileCanvas.desy=(f.scroller.position.y*-1);f.tileCanvas.desw=parseInt(f.initialImageWidth*f.scale);f.tileCanvas.desh=parseInt(f.initialImageHeight*f.scale)}else{if(f.tileDivImage!=null){f.tileDivImage.dom.style.webkitTransform="scale3d("+(1/f.scale)+","+(1/f.scale)+",1)";f.tileDivImage.dom.style.MozTransform="scale("+(1/f.scale)+","+(1/f.scale)+")";f.tileDivImage.dom.style.msTransform="scale3d("+(1/f.scale)+","+(1/f.scale)+",1)";f.tileDivImage.dom.style.width=(f.scale*100)+"%";f.tileDivImage.dom.style.height=(f.scale*100)+"%"}}}}},tryTilePageImage:function(d){var c=this;if(!c.isDestroyed){if(d!=null){for(var b=0;b<d.imageparts.length;b++){var a=d.imageparts[b];a.pageNumber=d.pageNumber;if(d.tiled){c.tilePageImage(a,d)}else{a.onload=function(){if(!c.isDestroyed){d.tiled=true;c.tilePageImage(this)}}}}}}},tilePageImag},tilePageImageCanvas:function(d,n){var k=this;if(!k.isDestroyed){if(k.tileCanvas!=null){var a=k.tileCanvas.getContext("2d");var o=d.naturalWidth*2;var h=d.naturalHeight*2;var c=d.startX/o;var m=d.startY/h;var b=d.naturalWidth;var l=d.naturalHeight;var g=k.tileCanvas.desx;g=g+(k.tileCanvas.desw*c);var f=k.tileCanvas.desy;f=f+(k.tileCanvas.desh*m);if(k.returnOrientation()=="landscape"){if(k._mode=="double"){if(n!=null&&(n.pageNumber-pageOffset)%2==1){g=k.tileCanvas.desxland+(k.tileCanvas.desw*c)}}}var j=k.tileCanvas.desw/2;var e=k.tileCanvas.desh/2;if(k.returnOrientation()=="landscape"&&k._mode=="single"&&(n==null||(n.pageNumber!=(k.getPageNo()+1+pageOffset)))){}else{a.drawImage(d,0,0,b,l,g,f,j,e)}}}},tilePageImageNonCanvas:function(f,c){var d=this;if(!d.isDestroyed){if(c==null||f==null){return}var a=0;if(f.startX==0){if(f.startY==0){a=0}else{a=2}}else{if(f.startY==0){a=1}else{a=3}}var e=d.portraitTileDivImage.dom;if((c.pageNumber-pageOffset)%2==1){e=d.landscapeTileDivImage.dom}var g=e.children[a];if(d.returnOrientation()=="landscape"&&d._mode=="single"&&(c==null||(c.pageNumber!=(d.getPageNo()+1+pageOffset)))){}else{if(g.children.length==0){g.appendChild(f)}else{var b=g.children[0];if(b.src!=f.src){b.src=f.src}}}}},tryDisableMedia:function(){var a=this;if(a.hideMediaDivsOnResize){a.mediaDiv.dom.style.display="none"}},tryEnableMedia:function(){var a=this;if(a.mediaDiv.dom.style.display=="none"){a.mediaDiv.dom.style.display=""}},disableTiling:function(){var a=this;console.log("DISABLING TILING");a.tileCanvas.width=0;a.tileCanvas.height=0},cleanupMediaObjectListeners:function(){var e=this;try{var f=$(e.element.dom).find(".brightcoveVideo");for(var d=0;d<f.length;d++){try{var b=f[d];if(!!b&&!!b.visibilityChangeListener){window.document.removeEventListener("visibilitychange",b.visibilityChangeListener)}}catch(a){console.warn("[ReaderPageViewer] Error Caught:\n\t",a)}}}catch(c){console.warn("[ReaderPageViewer] Error Caught:\n\t",c)}},destroy:function(){var a=this;a.isinitialized=false;a.isDestroyed=true;a.cleanupMediaObjectListeners();a.element.dom.innerHTML="";if(a.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([a.adSlot1])}delete a.figure;delete a.scrollerDiv;delete a.zoomDiv;delete a.image;delete a.landscapeimage;delete a.tileDiv;a.tileCanvas.width=0;a.tileCanvas.height=0;delete a.tileCanvas;delete a.portraitTileImage;delete a.landscapeTileImage;Ext.Container.prototype.destroy.apply(this,arguments);delete a},loadMediaImage:function(b,e){var c=this;if(e.type!="sectionpage"){var a=flatPlanData.reversePageMapper[c.image.pageNumber-1]+1;var d=c.portraitMediaDiv;if(b=="landscape"){a=flatPlanData.reversePageMapper[c.landscapeimage.pageNumber];d=c.landscapeMediaDiv}if(e.type=="page"){c.fireEvent("loadMedia",c,a-pageOffset,d)}else{$(d).empty()}c.mediaLoaded=true}},loadVideoMedia:function(b,e){var c=this;var a=c.image.pageNumber;var d=c.portraitMediaDiv;if(b=="landscape"){a=c.landscapeimage.pageNumber;d=c.landscapeMediaDiv}c.fireEvent("loadVideos",c,a-pageOffset,d);c.videosLoaded=true},returnMediaContainer:function(a){var b=this;if(a==b.image.pageNumber){return b.portraitMediaDiv}else{if(a==b.landscapeimage.pageNumber){return b.landscapeMediaDiv}}return null},returnTileDivImageContainer:function(a){var b=this;if(a==b.image.pageNumber){return b.portraitMediaDiv}else{if(a==b.landscapeimage.pageNumber){return b.landscapeMediaDiv}}return null},hideNavButtons:function(){var a=this},showNavButtons:function(){var a=this},pauseVideos:function(){var g=this;if(g.portraitMediaDiv!=null){var a=[];for(var c=0;c<g.portraitMediaDiv.children.length;c++){if(g.portraitMediaDiv.children[c].className.indexOf("readerVideo")!=-1){var e=g.portraitMediaDiv.children[c];if(g.element!=null){$(g.element.dom).removeClass("disableIframe")}if(e.className.indexOf("mp4Video")!=-1){var d=e.getElementsByTagName("iframe")[0];if(d.contentDocument!=null&&d.contentDocument.getElementsByTagName("video")[0]!=null){d.contentDocument.getElementsByTagName("video")[0].pause()}}else{if(e.className.indexOf("youtubeVideo")!=-1){var d=e.getElementsByTagName("iframe")[0];var f=YT.get(d.id);if(f!=null&&typeof f.pauseVideo==="function"){f.pauseVideo()}}else{if(e.className.indexOf("vimeoVideo")!=-1){var d=e.getElementsByClassName("vimeoPlayer")[0];d.contentWindow.postMessage({method:"pause",value:""},"*")}else{if(e.className.indexOf("brightcoveVideo")!=-1){try{bc(e.id+"_bc").pause()}catch(b){console.warn(b)}}}}}}}}if(g.landscapeMediaDiv!=null){var h=[];for(var c=0;c<g.landscapeMediaDiv.children.length;c++){if(g.landscapeMediaDiv.children[c].className.indexOf("readerVideo")!=-1){var e=g.landscapeMediaDiv.children[c];if(g.element!=null){$(g.element.dom).removeClass("disableIframe")}if(e.className.indexOf("mp4Video")!=-1){var d=e.getElementsByTagName("iframe")[0];if(d.contentDocument!=null&&d.contentDocument.getElementsByTagName("video")[0]!=null){d.contentDocument.getElementsByTagName("video")[0].pause()}}else{if(e.className.indexOf("youtubeVideo")!=-1){var d=e.getElementsByTagName("iframe")[0];var f=YT.get(d.id);if(f!=null&&typeof f.pauseVideo==="function"){try{f.pauseVideo()}catch(b){}}}else{if(e.className.indexOf("vimeoVideo")!=-1){var d=e.getElementsByClassName("vimeoPlayer")[0];if(d.contentWindow!=null){d.contentWindow.postMessage({method:"pause",value:""},"*")}}else{if(e.className.indexOf("brightcoveVideo")!=-1){try{bc(e.id+"_bc").pause()}catch(b){console.warn(b)}}}}}}}}},toggleZoomMode:function(b){var a=this;if(settings.reader.savePageMode=="true"){localStorage.setItem("zoomMode_"+publicationguid,b)}a.zoomMode=b;if(a.isinitialized==true){a.layoutImages(a.imagetoload,a.image,a.landscapeimage);a.resetPage();a.resizeDfp();a.finishZoom()}},getEncryptedImageSrc:function(b,d,a){var c=this;var e=new XMLHttpRequest();e.open("GET",b,true);e.responseType="arraybuffer";e.onload=function(g){var j=e.response;var f=new Uint8Array(j);if(settings.page.encryptionVersion=="3"){a=c.decryptV3(a)}else{if(settings.page.encryptionVersion=="4"){a=c.decryptV4(a)}}var h=c.decryptAES(f,a);$(d).attr("src",h)};e.send()},decryptV4:function(c){var d=this;c=c.replace(/-/g,"");var b=new RegExp(d.aesRegex(settings.page.checksum).replace(/\//,""));var e=new RegExp(/([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/);var a=c.replace(e,b).replace(/\//g,"");return a},aesRegex:function(b){if(typeof CryptoJS!="undefined"){var c=CryptoJS.enc.Hex.parse("02e656e46f3f441cbfa21c72b5a0bfcf");var e=CryptoJS.enc.Base64.parse(b);var a=CryptoJS.AES.decrypt({ciphertext:e},c,{keySize:16,iv:CryptoJS.enc.Hex.parse("00000000-0000-0000-0000-000000000000".replace(/-/g,"")),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});var d=CryptoJS.enc.Utf8.stringify(a);return d}},decryptV3:function(b){gString=b.replace(/-/gi,"");seed=parseInt(gString.substring(0,2),16);gChars=Array.from(gString);for(i=0;i<32;i++){seed=((3*seed+7)%32);var a=gChars[i];gChars[i]=gChars[seed];gChars[seed]=a}gString=gChars.join("");return gString},decryptAES:function(e,a){var d=this;if(typeof CryptoJS!="undefined"){var c=CryptoJS.enc.Hex.parse(a.replace(/-/g,""));var g=d.byteArrayToWordArray(e);var b=CryptoJS.AES.decrypt({ciphertext:g},c,{keySize:16,iv:CryptoJS.enc.Hex.parse("00000000-0000-0000-0000-000000000000".replace(/-/g,"")),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});var f=CryptoJS.enc.Base64.stringify(b);return"data:image/jpeg;base64,"+f}},byteArrayToWordArray:function(c){var b=[],a;for(a=0;a<c.length;a++){b[(a/4)|0]|=c[a]<<(24-8*a)}return CryptoJS.lib.WordArray.create(b,c.length)},setImageSrc:function(d,c,e){var b=this;var a=c;if(e.type=="page"&&(settings.page.encryptionVersion=="2"||settings.page.encryptionVersion=="3"||settings.page.encryptionVersion=="4")&&a!=""){b.getEncryptedImageSrc(a,d,e.guid)}else{$(d).attr("src",a)}}},0,["readerpageviewer"],["component","container","readerpageviewer"],{component:true,container:true,readerpageviewer:true},["widget.readerpageviewer"],0,[InfinityMobile.view,"ReaderPageViewer"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPageViewerPDF",Ext.Container,{config:{pageNo:"",page:false,previousPage:"",nextPage:"",style:"overflow:hidden",html:'<figure><div class="scrollerDiv"><div class="zoomDiv" ><img style="visibility:hidden;vertical-align:middle" /><img style="visibility:hidden;vertical-align:middle" /><div class="mediaDiv"><div class="portrait"></div><div class="landscape"></div></div><div class="tileDiv" ><div class="portrait"><canvas /></div><div class="landscape"><canvas /></div></div></div></div></figure>',maxScale:3,scrollable:"both",editionGuid:"",cls:"readerpage animate",mode:"double"},beforeInitialize:function(){console.log("INITIALISED");var a=this;a.isinitialized=false;a.mediaLoaded=false;a.thumbnailLoaded=false;a.pdfsLoaded=false;a.usesCanvas=true;a.canTile=false;a.zoomMode=settings.reader.zoomMode},initialize:function(){var a=this;a.zoomLevel="none";a.mp4Objects=[];a.on("painted",a.initializePage,a,{delay:10,single:true});a.scroller=a.getScrollable().getScroller();a.scroller.setDisabled(true);a.figure=a.element.down("figure");a.scrollerDiv=a.figure.down("div");a.zoomDiv=a.scrollerDiv.down("div");a.image=a.zoomDiv.down("img").dom;a.landscapeimage=a.zoomDiv.down("img").next("img").dom;a.mediaDiv=a.zoomDiv.down("div");a.portraitMediaDiv=a.mediaDiv.down("div").dom;a.landscapeMediaDiv=a.mediaDiv.down("div").next("div").dom;a.tileDiv=a.element.down(".tileDiv");a.portraitTileDiv=a.tileDiv.down(".portrait");a.image.tileCanvas=a.portraitTileDiv.down("canvas").dom;a.landscapeTileDiv=a.tileDiv.down(".landscape");a.landscapeimage.tileCanvas=a.landscapeTileDiv.down("canvas").dom;a.element.addListener({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragFinished",scope:a});a.scrollerDiv.addListener({scope:a,doubletap:a.onDoubleTap,pinchstart:a.onPinchStart,pinch:a.onPinch,pinchend:a.onPinchEnd});a.scroller.on({scope:a,scrollend:a.onScrollEnd})},initializePag},setUpImagesCS},setUpImagesUR},setUpImages:function(){var a=this;a.setUpImagesCSS();a.setUpImagesURL()},returnLandscapeImageTyp},getThumbnail:function(c,b){var a=this;var d="";if(b.image!=null){d=b.image;if(b.pageNum>1){if(b.image.indexOf("pages.cdn.pagesuite.com")!=-1){d="http://pages.mobile.cdn.pagesuite.com/images/"+a.retrievePageGuid(b)+"/tablet.jpg"}}}c.src=d;console.log("GETTING THUMBNAIL: "+d);c.type=b.type},retrievePageGuid:function(a){return a.image.split("/")[5]},imageLoade},layoutImage},layoutImagesDoublePageMod},layoutImagesSinglePageMod},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},completePDFLoade},loadPDF},loadPD},imageVisibl},returnEditionPag},requestPag},setUpTiledPDFPag},toggleDP},adjustPageOnToggleDP},resetImage},onResiz},adjustPageOnResiz},onDragStart:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDra},onDragFinishe},onDoubleTa},onPinchStar},onPinc},onPinchEn},onZoomStar},onZoo},onZoomEn},onChang},resetPag},initializeTouc},setOrigi},applyTranslat},applyTransfor},finishZoo},setZoo},resetZoo},setPDFContainer},stopTilin},setTilin},enableScrolle},scrollT},onScrollEn},startTilin},setUpCanva},disableTilin},destro},loadMediaImag},loadVideoMedi},returnMediaContaine},hideNavButtons:function(){var a=this},showNavButtons:function(){var a=this},pauseVideos:function(){var f=this;if(f.portraitMediaDiv!=null){var a=[];for(var b=0;b<f.portraitMediaDiv.children.length;b++){if(f.portraitMediaDiv.children[b].className.indexOf("readerVideo")!=-1){var d=f.portraitMediaDiv.children[b];if(f.element!=null){$(f.element.dom).removeClass("disableIframe")}if(d.className.indexOf("mp4Video")!=-1){var c=d.getElementsByTagName("iframe")[0];if(c.contentDocument){c.contentDocument.getElementsByTagName("video")[0].pause()}}else{if(d.className.indexOf("youtubeVideo")!=-1){var c=d.getElementsByTagName("iframe")[0];var e=YT.get(c.id);if(e!=null&&typeof e.pauseVideo==="function"){e.pauseVideo()}}else{if(d.className.indexOf("vimeoVideo")!=-1){var c=d.getElementsByClassName("vimeoPlayer")[0];c.contentWindow.postMessage({method:"pause",value:""},"*")}}}}}}if(f.landscapeMediaDiv!=null){var g=[];for(var b=0;b<f.landscapeMediaDiv.children.length;b++){if(f.landscapeMediaDiv.children[b].className.indexOf("readerVideo")!=-1){var d=f.landscapeMediaDiv.children[b];$(f.element.dom).removeClass("disableIframe");if(d.className.indexOf("mp4Video")!=-1){var c=d.getElementsByTagName("iframe")[0];c.contentDocument.getElementsByTagName("video")[0].pause()}else{if(d.className.indexOf("youtubeVideo")!=-1){var c=d.getElementsByTagName("iframe")[0];var e=YT.get(c.id);if(e!=null&&typeof e.pauseVideo==="function"){e.pauseVideo()}}else{if(d.className.indexOf("vimeoVideo")!=-1){var c=d.getElementsByClassName("vimeoPlayer")[0];c.contentWindow.postMessage({method:"pause",value:""},"*")}}}}}}}},0,["readerpageviewer"],["component","container","readerpageviewer"],{component:true,container:true,readerpageviewer:true},["widget.readerpageviewer"],0,[InfinityMobile.view,"ReaderPageViewerPDF"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutViewController",InfinityMobile.view.LayoutView,{config:{pageNo:""},initializ},layoutViewStyleOrientatio},loadViewController:function(){var a=this;a.fireEvent("loadViewController",a)},loadViewByI}},0,["layoutviewcontroller"],["component","container","layoutview","layoutviewcontroller"],{component:true,container:true,layoutview:true,layoutviewcontroller:true},["widget.layoutviewcontroller"],0,[InfinityMobile.view,"LayoutViewController"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutTextView",InfinityMobile.view.LayoutView,{initializ},layoutViewStyleOrientatio},initializePag},runEllipsi},ellipsi},ellipsisWord:function(a,b){}},0,["layouttextview"],["component","container","layoutview","layouttextview"],{component:true,container:true,layoutview:true,layouttextview:true},["widget.layouttextview"],0,[InfinityMobile.view,"LayoutTextView"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutTextFieldView",InfinityMobile.view.LayoutView,{config:{html:"<input style='width:100%; height:100%; border:none; background-color:rgba(0,0,0,0); color:red; padding:5px' placeholder='Searching' />"},initializ},layoutViewStyleOrientatio},checkEvent},fireCustomEven}},0,["layouttextfieldview"],["component","container","layoutview","layouttextfieldview"],{component:true,container:true,layoutview:true,layouttextfieldview:true},["widget.layouttextfieldview"],0,[InfinityMobile.view,"LayoutTextFieldView"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSearchItem",Ext.Container,{config:{height:160,style:"background-color:white; border-bottom:1px solid #ececec; min-height:160px;",layout:"hbox",cls:"searchItem",pageNumber:"",name:"",editionGuid:"",textString:"",searchType:"",items:[{itemId:"searchItemImage",width:125,margin:15,style:"border:1px solid #f0f0f0"},{itemId:"searchItemDescription",flex:1,margin:"35 15 35 15"}]},initialize:function(){var a=this;a.searchItemImage=a.getComponent("searchItemImage");a.searchItemDescription=a.getComponent("searchItemDescription");a.pageNumber=a._pageNumber;a.name=a._name;a.editionGuid=a._editionGuid;if(a.config.offsetNum!=null){a.offsetNum=a.config.offsetNum}a.textString="";if(a._textString!=null){a.textString=a._textString}a.searchType=a._searchType;a.element.on({tap:"onTap",scope:a});a.on("painted",a.initializePage,a,{delay:10,single:true})},onTap:function(b){var a=this;a.fireEvent("click",a)},initializePage:function(){var e=this;var d="Page";if(language!=null&&language.page!=null){d=language.page}var a="";var g=e.pageNumber;if(e.offsetNum!=null&&e.offsetNum!=""){g=e.offsetNum}var k=(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right");if(e.searchType=="e"){var c=d+" "+g;if(k){c=g+" "+d}a="<div style='font-size:16px'><b>"+c+"</b></div><br /><div style='font-size:14px'>"+e.textString+"</div>"}else{var c=e.name+" "+d+" "+g;if(k){c=g+"  "+d+" "+e.name}a="<div style='font-size:16px'><b>"+c+"</b></div><br /><div style='font-size:14px'>"+e.textString+"</div>"}if(currentProfile=="phone"){e.searchItemDescription.setMargin("15 15 15 15");a=a.replace("<br />","");e.searchItemDescription.addCls("fadeSearchItem")}e.searchItemDescription.setHtml(a);e.showImage();var f=e.parent.getScrollable();if(f!=null){var j=f.getScroller();j.on({scope:e,scrollend:e.showImage})}else{var b="http://edition.pagesuite.com";if(window.location.protocol=="https:"){b="https://"+location.host}var h=b+"/get_image.aspx?w=250&eid="+e.editionGuid+"&pnum="+e.pageNumber;e.searchItemImage.setHtml("<div style='height:127px; overflow:hidden'><img style='width:100%' src='"+h+"' /></div>")}},showImage:function(){var d=this;var a=d.element.dom.offsetTop;var h=d.parent;var c=h.element.dom.clientHeight;var e=d.parent.getScrollable();if(e!=null){var g=e.getScroller();var j=g.position.y;if(a<c+j||currentProfile=="desktop"){if(d.searchItemImage.getHtml()==null){var b="http://edition.pagesuite.com";if(window.location.protocol=="https:"){b="https://"+location.host}var f=b+"/get_image.aspx?w=250&eid="+d.editionGuid+"&pnum="+d.pageNumber;d.searchItemImage.setHtml("<div style='height:127px; overflow:hidden'><img style='width:100%' src='"+f+"' /></div>")}}}}},0,["searchItem"],["component","container","searchItem"],{component:true,container:true,searchItem:true},["widget.searchItem"],0,[InfinityMobile.view,"ReaderSearchItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArchiveItem",Ext.Container,{config:{style:"float:left;border:1px solid grey; overflow:hidden;",editionGuid:"",editionName:"",baseCls:"archiveItem",height:175,items:[{itemId:"archiveItemLabel",cls:"thumbInfo",bottom:0,minHeight:30,width:"100%",padding:"5px",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initialize:function(){var a=this;a.editionGuid=a._editionGuid;a.editionName=a._editionName;a.editionLabel=a.getComponent("archiveItemLabel");var b="http://edition.pagesuite.com";if(window.location.protocol=="https:"){b="https://"+location.host}var c=b+"/get_image.aspx?w=280&eid="+a.editionGuid;a.setHtml("<img style='width:100%;' src='"+c+"' />");a.editionLabel.setHtml(a.editionName);a.element.on({tap:"onTap",scope:a})},onTap:function(c){var b=this;var a="";if(qs.localhost!=null&&qs.localhost=="true"){a="&localhost=true"}window.location.href=location.protocol+"//"+location.host+"/launch.aspx?eid="+b.editionGuid}},0,["archiveItem"],["component","container","archiveItem"],{component:true,container:true,archiveItem:true},["widget.archiveItem"],0,[InfinityMobile.view,"ReaderArchiveItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderAnimationObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"readeranimationobject"},initializ},setAnimatio},setFrameDimension}},0,["readeranimationobject"],["component","container","readermediaobject","readeranimationobject"],{component:true,container:true,readermediaobject:true,readeranimationobject:true},["widget.readeranimationobject"],0,[InfinityMobile.view,"ReaderAnimationObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLinkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"readerLink",items:[{itemId:"tooltip",style:"position:absolute !important;"}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(a.mediaObject!=""){a.setMediaLinkStyle()}if(currentProfile=="desktop"){if(a.config.leftSideOverflow!=null){if(a.config.leftSideOverflow){a.mediaObject.x=100+a.mediaObject.x;a.setMediaObjectStyle()}}}},setMediaObjectStyle:function(){var a=this;a.setupFlash();InfinityMobile.view.ReaderMediaObject.prototype.setMediaObjectStyle.apply(this,arguments)},setMediaLinkStyle:function(){var a=this;if(currentProfile=="desktop"){if(a.mediaObject.description.length==0){}else{a.element.dom.onmouseenter=function(){a.fireEvent("setupArticleTooltip",a.mediaObject.description)};a.element.dom.onmouseleave=function(){a.fireEvent("hideArticleTooltip",a)};a.element.dom.onmousemove=function(b){a.fireEvent("updateArticleTooltipPosition",b)}}}if(a.mediaObject.url!=null){if(a.mediaObject.param1!=null&&a.mediaObject.param1=="POPUPURL"){a.element.on({tap:"onPopupTap",scope:a})}else{a.element.on({tap:"onTap",scope:a})}}},onTap:function(){var d=this;var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.tracking!=null){d.setGaCustomerId();if(typeof gtag!="undefined"){gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","click",{event_category:"Open URL",event_label:d.mediaObject.url,value:d.mediaObject.page,page_path:"/"+d.mediaObject.page,page_number:d.mediaObject.page})}}var a="mo";if(d.mediaObject.param1!=null&&d.mediaObject.param1=="LINKOBJECT"){a="ll"}var e="http://reports.pagesuite-professional.co.uk";if(location.protocol=="https:"){e=typeof reports!="undefined"?reports:"https://subscriber.pagesuite-professional.co.uk"}if(d.hasOneTrustConsent()){var b=e+"/track.aspx?html5=true&link="+a+"_"+d.mediaObject.guid;var f=this.getSubscriberGUID();if(f!=undefined){b+="&subscriber="+f}$.ajax({crossDomain:true,type:"GET",async:true,url:b})}mainPanel.fireEvent("readerLinkClick",d,d.mediaObject.url,d.config.pageNumber);d.fireEvent("linkClick",d,d.mediaObject.url)},hasOneTrustConsent:function(){if(typeof OneTrust!="undefined"&&settings.oneTrust!=null&&typeof OnetrustActiveGroups!="undefined"){if(settings.oneTrust.categories!=null&&OnetrustActiveGroups.indexOf(settings.oneTrust.categories.analytics)==-1){return false}}return true},getSubscriberGUID:function(){var c=getCookie("subscriber");if(!c){return undefined}var b=new RegExp("(?:^|&)guid(?:=([^&#]*)|&|#|$)","i");var a=b.exec(c,"i");if(!a){return undefined}if(!a[1]){return undefined}return decodeURIComponent(a[1].replace(/\+/g," "))},onPopupTap:function(){var f=this;var d=Ext.getStore("SettingStore");if(d.data.items[0].raw.tracking!=null){var c=d.data.items[0].raw.tracking.trackingType;f.setGaCustomerId();if(typeof gtag!="undefined"){gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","click",{event_category:"Open URL",event_label:f.mediaObject.url,value:f.mediaObject.page,page_path:"/"+f.mediaObject.page,page_number:f.mediaObject.page})}}var b=f.mediaObject.param2;var j=f.mediaObject.param3;var a=window.navigator.userAgent;var g=!!a.match(/iPhone/i);var h=!!a.match(/WebKit/i);var e=g&&h&&!a.match(/CriOS/i);if(e){window.open(f.mediaObject.url,"_self","width="+b+",height="+j)}else{window.open(f.mediaObject.url,"MyWindow","width="+b+",height="+j)}},setGaCustomerId:function(){var a="";if(typeof getCookie==="function"){a=getCookie("gatid")}if(typeof gtag!="undefined"&&a!=null&&a!=""){gtag("set",{user_id:a,send_page_view:false})}}},0,["readerlinkobject"],["component","container","readermediaobject","readerlinkobject"],{component:true,container:true,readermediaobject:true,readerlinkobject:true},["widget.readerlinkobject"],0,[InfinityMobile.view,"ReaderLinkObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArticleObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"readerArticle"},initializ},setMediaLinkStyle:function(){var b=this;if(currentProfile=="desktop"){var c="";if(settings.tooltips!=null){c=" backgroundColor:#"+settings.tooltips.backgroundColor+" !important; color:"+settings.tooltips.color+" !important"}b.add({itemId:"tooltip",style:"position:absolute !important; "+c});var a=b.mediaObject.description;if(b.article!=null&&articleDictionary[b.article]!=null){a=articleDictionary[b.article].headline}if(b.mediaObject.description.trim().length>0){b.element.dom.onmouseenter=function(){b.fireEvent("setupArticleTooltip",a)};b.element.dom.onmouseleave=function(){b.fireEvent("hideArticleTooltip",b)};$("body").on("touchstart",function(){b.fireEvent("hideArticleTooltip",b)});b.element.dom.onmousemove=function(d){b.fireEvent("updateArticleTooltipPosition",d)}}}if(b.mediaObject.guid!=null){b.element.on({singletap:"onTap",scope:b})}},onTa}},0,["readerarticleobject"],["component","container","readermediaobject","readerarticleobject"],{component:true,container:true,readermediaobject:true,readerarticleobject:true},["widget.readerarticleobject"],0,[InfinityMobile.view,"ReaderArticleObject"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleCarousel",Ext.Carousel,{initialize:function(){var a=this;Ext.carousel.Carousel.prototype.initialize.call(this);a.on("activeitemchange","handleItemChange",this);a.carouselDestroyed=false;a._visiblePages=Math.min(a._visiblePages,a.getData().length);a.setCards();a.setOrientationChange();if(settings.articlepopover!=null&&settings.articlepopover.disableArticleCarousel!=null&&settings.articlepopover.disableArticleCarousel=="true"){a.locked=true;a.onDragOrig=a.onDrag;a.onDra};a._visiblePages=1}a.showAdAt=5;if(typeof EDITIONAPP!="undefined"&&EDITIONAPP&&typeof NEWPWA!="undefined"&&NEWPWA){var b=function(c){if(c.data!=null&&c.data.type=="jumpToArticlePage"&&c.data.pageNo!=null){a.jumpToPage(c.data.pageNo-1)}};window.addEventListener("message",b)}},config:{indicator:false,data:false,pageNumber:0,skipActiveItemChange:true,pageTemplate:false,visiblePages:3,directionLock:true,landscapePageIncrement:1,mode:"single"},setPageTemplate:function(a){this.pageTemplate=a},setCards:function(){var j=this;j._skipActiveItemChange=true;if(settings.articlepopover!=null&&settings.articlepopover.disableArticleCarousel!=null&&settings.articlepopover.disableArticleCarousel=="true"){j._visiblePages=1}var k=1;if(settings.reader.disableArticleCarousel!=null&&settings.reader.disableArticleCarousel=="true"){j.add(j.createCard(j.getData()[j._pageNumber],j._pageNumber,j.getData()))}else{if(j._pageNumber==0){for(var e=0;e<j._visiblePages;e++){var b=(e*k);j.add(j.createCard(j.getData()[b],b,j.getData()))}j.setActiveItem(0)}else{if(j._pageNumber==(j.getData().length-1)){if(j._visiblePages==1){j.add(j.createCard(j.getData()[j.getData().length-1],j.getData().length-1,j.getData()));j.setActiveItem(0)}else{for(var e=Math.max((j._pageNumber-2),0);e<j.getData().length;e++){j.add(j.createCard(j.getData()[e],e,j.getData()))}j.setActiveItem(2)}}else{if(j._visiblePages==1){var f=j._pageNumber;var a=j.createCard(j.getData()[f],f,j.getData());j.add(a);j.setActiveItem(0)}else{var f=j._pageNumber;var a=j.createCard(j.getData()[f],f,j.getData());j.add(a);var c=j._pageNumber-(1*k);var d=j.createCard(j.getData()[c],c,j.getData());j.insert(0,d);var h=parseInt(j._pageNumber)+(1*k);var g=j.createCard(j.getData()[h],h,j.getData());j.add(g);j.setActiveItem(1)}}}}j.articleNo=j.getActiveItem()._pageNo;j._skipActiveItemChange=false},handleItemChang},updateItemCSS:function(f,d){var e=this;var a=f.getItems().items;for(var c=0;c<a.length;c++){var b=a[c];if(b._itemId!=d._itemId){b.setCls("")}}d.setCls("selecteditem")},createCar},addCardToFront:function(f,c,b){var d=this;c._skipActiveItemChange=true;f.remove(c,true);var a=1;var e=(d._pageNumber+b+a);e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createCard(d.getData()[e],e,d.getData()))},addInterstitialToFron},addInterstitialToBac},createInterstitia},addCardToBack:function(f,a,c){var d=this;var b=1;if(a!=null){a._skipActiveItemChange=true;f.remove(a,true);var e=(d._pageNumber-c-b);e=Math.max(e,0);f.insert(0,d.createCard(d.getData()[e],e,d.getData()))}},jumpToFirst:function(){this.jumpToPage(0)},jumpToLast:function(){this.jumpToPage((this.getData().length-1))},jumpToPage:function(b){var c=this;var a=b;var a=Math.max(a,(this.getData().length-1));a=Math.min(a,0);if(b!=c._pageNumber){if(b==(c._pageNumber+1)){c.next()}else{if(b==(c._pageNumber-1)){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}},injectInterstitia},frameDragStart:function(f){var d=this.getDirection(),b=f.changedTouches[0].screenX,a=f.changedTouches[0].pageY,c=this.getDirectionLock();this.isDragging=true;this.startXPointFrame=b;this.getTranslatable().stopAnimation();this.dragStartOffset=this.offset;this.dragDirection=0},frameDrag:function(f){var d=this.getDirection(),b=f.changedTouches[0].screenX,a=f.changedTouches[0].pageY,c=this.getDirectionLock();this.isDragging=true;this.startXPointFrame=b;this.getTranslatable().stopAnimation();this.dragStartOffset=this.offset;this.dragDirection=0},frameDragEn},carouselDragStart:function(f){var d=this.getDirection(),b=f.absDeltaX,a=f.absDeltaY,c=this.getDirectionLock();this.isDragging=true;this.startX=f.changedTouches[0].screenX;this.startY=f.changedTouches[0].screenY;this.getTranslatable().stopAnimation();this.dragStartOffset=this.offset;this.dragDirection=0;this.touchMoveCount=0},carouselDrag:function(n){if(this.touchMoveCount<1){this.touchMoveCount++;return}else{if(this.touchMoveCount==1){var p=this.getDirection(),h=Math.abs(n.changedTouches[0].screenX-this.startX),f=Math.abs(n.changedTouches[0].screenY-this.startY),m=this.getDirectionLock();if(m){if((p==="horizontal"&&h>f)||(p==="vertical"&&f>h)){n.stopPropagation();n.preventDefault();this.touchMoveCount++;return}else{this.isDragging=false;return}}}}if(!this.isDragging){return}n.preventDefault();var o=this.dragStartOffset,p=this.getDirection(),q=p==="horizontal"?n.changedTouches[0].screenX-this.startX:n.changedTouches[0].screenY-this.startY,a=this.offset,l=this.flickStartTime,c=this.dragDirection,b=Ext.Date.now(),k=this.getActiveIndex(),g=this.getMaxItemIndex(),d=c,j;this.touchMoveCount++;if((k===0&&q>0)||(k===g&&q<0)){q*=0.5}j=o+q;if(j>a){c=1}else{if(j<a){c=-1}}if(c!==d||(b-l)>300){this.flickStartOffset=a;this.flickStartTime=b}this.dragDirection=c;this.setOffset(j)},carouselDragEnd:function(k){if(!this.isDragging){return}this.carouselDrag(k);this.isDragging=false;var a=Ext.Date.now(),j=this.itemLength,g=j/4,f=this.offset,n=this.getActiveIndex(),c=this.getMaxItemIndex(),h=0,m=f-this.flickStartOffset,b=a-this.flickStartTime,l=this.getIndicator(),d;if(b>0&&Math.abs(m)>=10){d=m/b;if(Math.abs(d)>=1){if(d<0&&n<c){h=-1}else{if(d>0&&n>0){h=1}}}}if(h===0){if(n<c&&f<-g){h=-1}else{if(n>0&&f>g){h=1}}}if(l){l.setActiveIndex(n-h)}this.animationDirection=h;this.setOffsetAnimated(h*j)},setOrientationChange:function(){var a=this;var b})();if(currentProfile=="desktop"){$(window).on("resize",function(){b(function(){a.onResize()},250)})}else{if(Ext.os.is.Android){$(window).on("resize",function(){setTimeout(function(){a.onResize()},0)})}else{Ext.Viewport.on("orientationchange",function(d,f,e,c){if(currentProfile=="phone"&&Ext.os.is.iOS){setTimeout(function(){a.onResize()},800)}else{setTimeout(function(){a.onResize()},200)}},a)}}},onResiz},destroy:function(){var a=this;Ext.carousel.Carousel.prototype.destroy.apply(this,arguments);a.carouselDestroyed=true}},0,["articlecarousel"],["component","container","carousel","articlecarousel"],{component:true,container:true,carousel:true,articlecarousel:true},["widget.articlecarousel"],0,[InfinityMobile.view,"ArticleCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderVideoObject",InfinityMobile.view.ReaderMediaObject,{config:{items:[{itemId:"closeBtn",right:0,top:0,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backImage",style:'background-image:url("../assets/article view/article-close-btn.png");background-repeat:no-repeat;background-size:contain;background-position:center;'}]}],mediaObject:"",cls:"readerVideo"},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(a.mediaObject!=""){if(a.mediaObject.url.indexOf("http://www.youtube.com/watch")!=-1){a.initializeYoutube();a.videoType="youtube"}else{if(a.config.type=="brightcove"){a.initialiseBrightcove()}else{if($.isNumeric(a.mediaObject.param1)||(a.mediaObject.url.indexOf("http://")!=-1||(a.mediaObject.url.indexOf("tel://")!=-1)&&$.isNumeric(a.mediaObject.url.replace("http://","").replace("tel://","")))){a.initialiseVimeo();a.videoType="vimeo"}else{if(a.mediaObject.file!=""){a.initialiseMP4();a.videoType="mp4"}}}}}a.mediaType="video";a.closeBtn=a.getComponent("closeBtn");a.closed=false;a.closeBtn.element.on({tap:function(){var c=this;c.closed=true;if(c.mediaObject.remove=="CLOSEBTN"){if(c.videoType=="mp4"){c.video.pause()}else{if(c.videoType=="youtube"){if(c.ytplayer!=null){c.ytplayer.pauseVideo()}else{c.youtubeFrame.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}}else{if(c.videoType=="vimeo"){var b=c.element.dom.getElementsByClassName("vimeoPlayer")[0];b.contentWindow.postMessage({method:"pause",value:""},"*")}}}c.removeAnim()}else{if(c.videoType=="mp4"){c.video.pause()}else{if(c.videoType=="youtube"){if(c.ytplayer!=null){c.ytplayer.pauseVideo()}else{c.youtubeFrame.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}}else{if(c.videoType=="vimeo"){var b=c.element.dom.getElementsByClassName("vimeoPlayer")[0];b.contentWindow.postMessage({method:"pause",value:""},"*")}}}c.hide()}},scope:a});if(a.mediaObject.remove!="CLOSEBTN"){a.closeBtn.hide()}a.mp4FirstPlay=false;if(currentProfile=="desktop"){if(a.config.leftSideOverflow!=null){if(a.config.leftSideOverflow){a.mediaObject.x=100+a.mediaObject.x;a.setMediaObjectStyle()}}}$(a.element.dom.getElementsByClassName("x-innerhtml")[1]).css("height","100%");$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange})},initialiseBrightcove:function(){var e=this;var a=e.mediaObject.param2.split("|");var h="https://players.brightcove.net/"+a[0]+"/"+a[1]+"_"+a[2]+"/index.min.js";window.brightcoveScriptsLoaded=window.brightcoveScriptsLoaded||[];var g=window.brightcoveScriptsLoaded.indexOf(h)>=0;if(!g){window.brightcoveScriptsLoaded.push(h)}var f="<video-js playsinline id='"+e.id+"_bc' style='display:block; height:100%; width: 100%; position: relative;' data-account='"+a[0]+"' data-player='"+a[1]+"'data-embed='"+a[2]+"' controls='' data-video-id='"+e.mediaObject.param1+'\' data-application-id="html5-test"></video-js>';e.addCls("brightcoveVideo");e.setHtml(f);try{var c=function(){if(typeof bc!="undefined"&&!e.brightcoveVideo){e.brightcoveVideo=bc(e.id+"_bc")}if(!!e.mediaObject.autoPlay&&e.mediaObject.autoPlay.toLowerCase()=="true"&&!!e.brightcoveVideo){console.log(e);e.fireEvent("autoplayVideo",e,e.brightcoveVideo)}console.log(e.brightcoveVideo,e.element)};if(currentProfile!="desktop"){e.visibilityChangeListener=e.element.dom.visibilityChangeListener=function(j){if(currentProfile!="desktop"){switch(window.document.visibilityState){case"hidden":if(e.brightcoveVideo){e.brightcoveVideo.pause()}}}};window.document.addEventListener("visibilitychange",e.visibilityChangeListener)}if(!g){var b=document.createElement("SCRIPT");b.src=h;b.onload=c;e.element.dom.appendChild(b)}requestAnimationFrame(function(){c()})}catch(d){console.error(d,e.element.dom)}},returnYoutubeDomain:function(){if(typeof OneTrust!="undefined"&&settings.oneTrust!=null&&typeof OnetrustActiveGroups!="undefined"){if(settings.oneTrust.categories!=null&&OnetrustActiveGroups.indexOf(settings.oneTrust.categories.social)==-1){return"https://www.youtube-nocookie.com/embed/"}}return"https://www.youtube.com/embed/"},initializeYoutube:function(){var e=this;e.youtubeCode=e.mediaObject.url.substr(e.mediaObject.url.length-11);var d=e.returnYoutubeDomain()+e.youtubeCode;var c="";if(e.mediaObject.autoPlay!=null&&e.mediaObject.autoPlay=="true"&&e.mediaObject.appear!="TRIGGER"){}var a="";if(e.mediaObject.param6.length>0){if(e.mediaObject.param6.indexOf("rel")!=-1){a=e.mediaObject.param6;if(a.indexOf("&")==-1){a="&"+a}}}var b="";if(e.mediaObject.param4=="true"){b="&controls=0"}e.addCls("youtubeVideo");e.setHtml("<iframe onload='parent.youtubeplay()' src='"+d+"?enablejsapi=1"+c+a+b+"' width='100%' height='100%' frameborder='0' id='"+(e.id+"video")+"' allowfullscreen/>");e.youtubeFrame=e.element.down("iframe").dom;e.youtubeFrame.onload=function(){e.ytplayer=new YT.Player(document.getElementById((e.id+"video")),{events:{onStateChange:function(f){e.onPlayerStateChange(f)},onReady:function(){e.videoName=e.ytplayer.getVideoData().title;if(currentProfile=="desktop"){if(e.mediaObject.autoPlay=="true"&&e.mediaObject.appear!="TRIGGER"){e.ytplayer.playVideo()}}}}})}},onPlayerStateChange:function(c){var b=this;if(c.data==1){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.tracking!=null){var d=a.data.items[0].raw.tracking.trackingType;if(d=="GA"){if(typeof gtag!="undefined"){gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","play",{event_category:"Youtube",event_label:b.videoName,value:b.pageNumber,page_title:publicationName+" - "+editionName,page_path:"/"+b.pageNumber,page_number:b.pageNumber})}}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}},initialiseVimeo:function(){var b=this;b.vimeoId=b.mediaObject.param1;b.addCls("vimeoVideo");var c="https://player.vimeo.com/video/"+b.vimeoId;b.setHtml("<iframe class='vimeoPlayer' src='"+c+"?api=1&amp;player_id="+c+"' allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' width='100%' height='100%' frameborder='0' id='"+(b.id+"video")+"'/>");var a=b.element.dom.getElementsByClassName("vimeoPlayer")[0]},initialiseMP4:function(){var b=this;b.fileGuid=b.mediaObject.file;var d=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);var e=window.location.protocol+"//pages.pagesuite.com/media/"+d+"/"+a+"/"+b.fileGuid+".mp4";if(location.protocol=="https:"){e=e.replace("http:","https:")}b.addCls("mp4Video");openLink=function(){if(b.mediaObject.url.length>0&&b.mediaObject.url.indexOf("http://")!=-1){if(currentProfile=="desktop"){window.open(b.mediaObject.url)}else{if(!b.mp4FirstPlay){window.open(b.mediaObject.url);b.mp4FirstPlay=true}}}};var c="";if(b.mediaObject.autoPlay=="true"&&b.mediaObject.appear!="TRIGGER"&&currentProfile!="desktop"&&settings.reader.allowAutoplayVideoOnMobile=="true"){c="&muted=true"}if(b.mediaObject.param4=="true"){c+="&hidecontrols=true"}e="video.aspx?guid="+b.fileGuid+c;b.setHtml("<iframe allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' src='"+e+"' width='100%' height='100%' frameborder='0' scrolling='no' />");b.element.down("iframe").dom.onload=function(){if(this.contentDocument!=null){this.contentDocument.getElementsByTagName("video")[0].onclick=openLink;this.contentDocument.getElementsByTagName("video")[0].addEventListener("touchstart",openLink)}b.video=this.contentDocument.getElementsByTagName("video")[0];if(currentProfile=="desktop"||(currentProfile!="desktop"&&settings.reader.allowAutoplayVideoOnMobile=="true")){if(b.mediaObject.autoPlay=="true"&&b.mediaObject.appear!="TRIGGER"){b.fireEvent("checkActivePageVideo",b)}}};videoplay=function(){b.videoPlayListener()}},videoPlayListener:function(){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.tracking!=null){var c=a.data.items[0].raw.tracking.trackingType;if(c=="GA"){if(typeof gtag!="undefined"){b.setGaCustomerId();gtag("set",{page_title:publicationName+" - "+editionName});gtag("event","play",{event_category:"MP4",event_label:b.mediaObject.name,value:b.mediaObject.page,page_title:publicationName+" - "+editionName,page_path:"/"+b.mediaObject.page+" - "+publicationName+" - "+editionName,page_number:b.mediaObject.page})}}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})},createCustomControl},setVideoListener},playVideo:function(){var a=this;switch(a.videoType){case"youtube":if(a.ytplayer!=null){a.ytplayer.playVideo()}break;case"vimeo":break;case"mp4":if(a.video!=null){a.video.play()}break}},setGaCustomerId:function(){var a="";if(typeof getCookie==="function"){a=getCookie("gatid")}if(typeof gtag!="undefined"&&a!=null&&a!=""){gtag("set",{user_id:a,send_page_view:false})}}},0,["readervideo"],["component","container","readermediaobject","readervideo"],{component:true,container:true,readermediaobject:true,readervideo:true},["widget.readervideo"],0,[InfinityMobile.view,"ReaderVideoObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderVideoObjectControls",Ext.Container,{config:{cls:"readercontrols",layout:{type:"hbox",align:"center"},bottom:-20,style:"background-color:rgba(0, 0, 0, 0.5)",padding:7,width:"100%",height:40,html:"<div class='playbutton play'></div><div class='togglebox'><div class='currentTime'>0:00</div><div class='timeBar'></div><div class='totalTime'>0:00</div></div><div class='fullscreenbutton'></div>"},initializ},setPlayListene},fullscreenButtonListener:function(){var a=this;a.fullscreenButton.on("tap",function(){a.fireEvent("videofullscreen",a,a.video)})}},0,["readervideocontrols"],["component","container","readervideocontrols"],{component:true,container:true,readervideocontrols:true},["widget.readervideocontrols"],0,[InfinityMobile.view,"ReaderVideoObjectControls"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"backgroundImage",items:[{itemId:"closeBtn",right:0,top:0,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backImage",style:'background-image:url("../assets/article view/article-close-btn.png")'}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.setImage();a.setLinks();if(currentProfile=="desktop"){a.checkUrl()}a.closeBtn=a.getComponent("closeBtn");if(currentProfile=="desktop"){if(a.config.leftSideOverflow!=null){if(a.config.leftSideOverflow){a.mediaObject.x=100+a.mediaObject.x;a.setMediaObjectStyle()}}}a.closeBtn.element.on({ta},scope:a});if(a.mediaObject.remove!="CLOSEBTN"){a.closeBtn.hide()}},setImage:function(){var b=this;b.fileGuid=b.mediaObject.file;if(b.fileGuid!=null&&b.fileGuid.indexOf("http://")==-1&&b.fileGuid.indexOf("https://")==-1){var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);var e=".jpg";if(b.mediaObject.fileType!=null){switch(b.mediaObject.fileType){case"image/gif":e=".gif";break;case"image/png":e=".png";break;default:break}}b.imageurl="http://pages.cdn.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+e;if(e==".gif"){b.imageurl+="?cb="+Math.round((new Date()).getTime()/1000)}if(location.protocol=="https:"){b.imageurl=b.imageurl.replace("http://pages.cdn.pagesuite.com","https://pages.pagesuite.com")}b.setHtml("<img src='"+b.imageurl+"' class='media-image' style='vertical-align:top;' />")}else{if(b.fileGuid!=null&&(b.fileGuid.indexOf("http://")!=-1||b.fileGuid.indexOf("https://")!=-1)){b.imageurl=b.fileGuid;var d="";if(typeof getCookie!="undefined"){d=getCookie("subscriber");if(d==null||d==""){d=getCookie("SID")}d=d.replace("guid=","")}b.imageurl=b.imageurl.replace("{SUBSCRIBER_GUID}",d);b.setHtml("<img src='"+b.imageurl+"' class='media-image' style='vertical-align:top;' />")}}},setLinks:function(){var a=this;a.imageClickUrl=a.mediaObject.url;if(a.imageClickUrl!=null&&a.imageClickUrl!=""&&a.imageClickUrl!="NONE"&&a.imageClickUrl!="http://"&&a.mediaObject.isTrigger=="false"){a.element.on("tap",function(b){if(isNaN(a.imageClickUrl)){if(!!a.imageClickUrl&&a.imageClickUrl.toLowerCase().indexOf("liveadvert=yes")>=0){mainPanel.fireEvent("openUrlFrame",a.imageClickUrl)}else{window.open(a.imageClickUrl)}}else{mainPanel.fireEvent("readerJumpToPage",a.imageClickUrl)}})}},setFullScreenButtonListener:function(){var a=this;a.fullscreenButton.element.on("tap",function(){a.fireEvent("fullscreenImage",a);var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.tracking!=null){var c=b.data.items[0].raw.tracking.trackingType;if(c=="GA"&&typeof ga!="undefined"){ga("send","pageview")}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})})},checkUr}},0,["readerimage"],["component","container","readermediaobject","readerimage"],{component:true,container:true,readermediaobject:true,readerimage:true},["widget.readerimage"],0,[InfinityMobile.view,"ReaderImageObject"],0));(Ext.cmd.derive("InfinityMobile.view.PageRestriction",Ext.Container,{config:{style:"background-color:#FFFFFF;border: 2px solid black;border-radius:5px;",width:"500px",height:"wrap",fullscreen:true,modal:true,centered:true,hideOnMaskTap:true,zIndex:99999991,items:[{itemId:"title",items:[{id:"Close",cls:"pointerCursor",top:4,right:4,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"image",style:"text-align:center"},{itemId:"textArea"},{itemId:"BtnArea",style:"width:100%;",padding:10,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"register",cls:"pointerCursor",style:"padding:5px 10px;text-align:center;"}]},{itemId:"iframeArea",cls:"innerhtmlfullheight",width:"100%",height:"100%"}]},initialize:function(){var c=this;var e=c.getComponent("title");var d=c.getComponent("textArea");var a=c.getComponent("BtnArea");c.iframeArea=c.getComponent("iframeArea");c.image=c.getComponent("image");c.closeBtn=e.getComponent("Close");if(Ext.os.is.Phone){c.setWidth("90%")}c.keyFunc=window.onkeydown;window.onkeydown=null;c.btn=a.getComponent("register");c.btn.setHtml(language.register);if(settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.type=="url"){c.setStyle("border: none");var b={width:75,height:75};if(settings.subscription.pageRestriction.size!=null){sizeItems=settings.subscription.pageRestriction.size.split("|");if(sizeItems.length){b.width=sizeItems[0];b.height=sizeItems[1]}}c.setWidth(b.width+"%");c.setHeight(b.height+"%");c.iframeBorderRadius="5px";if(currentProfile=="phone"){c.setStyle("border-radius: 0px");c.setWidth("100%");c.setHeight("100%");c.btn.hide();a.setPadding(16);c.iframeBorderRadius="0px";c.iframeArea.setHeight("calc(100% - 32px)")}else{a.hide();c.closeBtn.setTop(-28)}c.iframeArea.setHtml("<iframe id='restriction' width='100%' height='100%' frameBorder='0' style='border-radius: "+c.iframeBorderRadius+"'></iframe>");c.iframeArea.setStyle("background:url(resources/images/loading.gif;background-position:center;background-repeat:no-repeat;background-size:container;");if(settings.subscription.pageRestriction.url!=null&&settings.subscription.pageRestriction.url!=""){c.on("painted",function(){c.restrictionHtmlRequest=$.ajax({type:"GET",contentType:"text/plain",async:true,url:settings.subscription.pageRestriction.url,success:function(f){if(f!=null){c.iframeArea.setStyle("background-image:none;");c.writeIframeContents(f)}},erro}})},c,{delay:10,single:true})}else{c.restrictionHtmlError("Empty URL")}}else{if(settings.subscription.pageRestriction.type=="standard"||settings.subscription.pageRestriction.type=="unique"){if(settings.subscription.pageRestriction.logo!=null){if(settings.subscription.pageRestriction.logo.length>0){c.image.setHtml('<img style="max-width:100%" src="'+settings.subscription.pageRestriction.logo+'" />');c.image.setPadding(20)}}if(settings.subscription.pageRestriction.title!=null){e.setHtml("<div style='padding:5px;border-top-left-radius:5px;border-top-right-radius:5px;' >"+settings.subscription.pageRestriction.title+"</div>")}else{e.setHtml("<div style='padding:5px;border-top-left-radius:5px;border-top-right-radius:5px;' >Please Subscribe</div>")}e.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});if(settings.subscription.pageRestriction.desc!=null){d.setHtml("<div style'padding:10px;'><p style='padding:10px;text-align:center;font-size:10pt;padding-bottom:10px;'>"+settings.subscription.pageRestriction.desc+"</p></div>")}else{d.setHtml("<div style'padding:10px;'><p style='padding:10px;text-align:center;font-size:10pt;padding-bottom:10px;'>Register now to gain access to the full digital edition! You'll be able to continue browsing through all of the pages of the magazine, and access all of the digital content.</p></div>")}d.element.on({scope:d,delegate:"a",tap:function(f){if(currentProfile!="desktop"){if(Ext.browser.is.Safari){window.location.href=f.target}}}})}}}register=function(){if(settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.redirectUrl!=null){var f=InfinityMobile.app.application.getController("AppController").getPageRestrictionRedirectUrl();var g=InfinityMobile.app.application.getController("AppController").hasPageRestrictionRedirectInSameTab();window.open(!!f?f:settings.subscription.pageRestriction.redirectUrl,g?"_self":"_blank")}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}};c.btn.element.on("tap",register);c.btn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});if(settings.subscription.pageRestriction.closeable==null||settings.subscription.pageRestriction.closeable=="true"){c.closeBtn.element.on({tap:function(){if(c.restrictionHtmlRequest&&typeof c.restrictionHtmlRequest.abort==="function"){c.restrictionHtmlRequest.abort()}window.onkeydown=c.keyFunc;c.destroy()}})}else{c.closeBtn.hide();c.setHideOnMaskTap(false);if(currentProfile=="phone"){a.hide();c.iframeArea.setHeight("100%")}}},restrictionHtmlError:function(a){var b=this;if(a){console.error(a)}b.iframeArea.setStyle("background:url(resources/images/error.png);background-position:center;background-repeat:no-repeat;background-size:container;")},writeIframeContents:function(c){var b=this;var a=document.getElementById("restriction");if(a!=null){var a=(a.contentWindow||a.contentDocument);if(a&&a.document){a.document.write(c)}else{b.restrictionHtmlError("Bad document object.")}}else{b.restrictionHtmlError("Can't find document object.")}},hide:function(){var a=this;if(a.restrictionHtmlRequest&&typeof a.restrictionHtmlRequest.abort==="function"){a.restrictionHtmlRequest.abort()}window.onkeydown=this.keyFunc;Ext.Container.prototype.hide.apply(this,arguments);this.destroy()}},0,["pagerestriction"],["component","container","pagerestriction"],{component:true,container:true,pagerestriction:true},["widget.pagerestriction"],0,[InfinityMobile.view,"PageRestriction"],0));(Ext.cmd.derive("InfinityMobile.view.FullscreenPrompt",Ext.Container,{config:{style:"background-color:#FFFFFF;border: 2px solid black;border-radius:5px;",width:"500px",height:"wrap",fullscreen:true,modal:true,centered:true,hideOnMaskTap:true,items:[{itemId:"title",items:[{id:"Close",cls:"pointerCursor",top:4,right:4,html:"<img src='../assets/article view/article-close-btn.png' onclick='parent.onClose()' ontouchstart='parent.onClose()' style='width:24px; height:24px' />"}]},{itemId:"textArea"},{itemId:"BtnArea",style:"width:100%;",padding:10,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"yesbtn",cls:"pointerCursor",style:"padding:5px 10px;text-align:center;"},{itemId:"nobtn",cls:"pointerCursor",style:"padding:5px 10px;text-align:center;"}]}]},initialize:function(){var b=this;var e=b.getComponent("title");var d=b.getComponent("textArea");var a=b.getComponent("BtnArea");b.image=b.getComponent("image");var c=e.getComponent("Close");if(Ext.os.is.Phone){b.setWidth("90%")}b.ybtn=a.getComponent("yesbtn");b.nbtn=a.getComponent("nobtn");b.ybtn.setHtml(language.yes);b.nbtn.setHtml(language.no);if(settings.fullscreenPrompt!=null){if(settings.fullscreenPrompt.title!=null){e.setHtml("<div style='padding:5px;border-top-left-radius:5px;border-top-right-radius:5px;' >"+settings.fullscreenPrompt.title+"</div>")}else{e.setHtml("<div style='padding:5px;border-top-left-radius:5px;border-top-right-radius:5px;' >Fullscreen Mode</div>")}e.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});if(settings.fullscreenPrompt.message!=null){d.setHtml("<div style'padding:10px;'><p style='padding:10px;text-align:center;font-size:10pt;padding-bottom:10px;'>"+settings.fullscreenPrompt.message+"</p></div>")}else{d.setHtml("<div style'padding:10px;'><p style='padding:10px;text-align:center;font-size:10pt;padding-bottom:10px;'>Would you like to start in fullscreen mode?</p></div>")}d.element.on({scope:d,delegate:"a",tap:function(f){if(currentProfile!="desktop"){if(Ext.browser.is.Safari){window.location.href=f.target}}}})}registe};b.ybtn.element.on("tap});b.nbtn.element.on("tap",function(){b.hide()});b.ybtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)",marginRight:"10px"});b.nbtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)",marginLeft:"10px"});onClose=function(f){b.hide()}}},0,["fullscreenprompt"],["component","container","fullscreenprompt"],{component:true,container:true,fullscreenprompt:true},["widget.fullscreenprompt"],0,[InfinityMobile.view,"FullscreenPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArchiveMonthItem",Ext.Container,{config:{padding:10,style:"border-bottom:1px solid black"},initializ},setUpHorizontal:function(b){var e=this;if(settings.menu.archivePaginationType!=null){switch(settings.menu.archivePaginationType){case"month":var a=b.split(" ")[0];a=e.checkTranslation(a);var c=b.split(" ")[1];var d=a.substring(0,3);if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){b=c+" - "+d}else{b=d+" - "+c}e.setWidth(100);return b;break;case"year":e.setWidth(50);return b;break;case"decade":e.setWidth(60);return b+"'s";break}}},setUpVertical:function(b){var d=this;d.setWidth(180);if(settings.menu.archivePaginationType!=null){switch(settings.menu.archivePaginationType){case"month":var a=b.split(" ")[0];var c=b.split(" ")[1];a=d.checkTranslation(a);if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){monthString=c+" - "+a}else{monthString=a+" "+c}return monthString;break;case"year":return b;break;case"decade":return b+"'s";break}}},onTap:function(){var a=this;if(settings.menu.archivePaginationType!=null){switch(settings.menu.archivePaginationType){case"month":a.fireEvent("changeMonth",a);break;case"year":a.fireEvent("changeYear",a);break;case"decade":a.fireEvent("changeDecade",a);break}}},checkTranslatio}},0,["archiveMonthItem"],["component","container","archiveMonthItem"],{component:true,container:true,archiveMonthItem:true},["widget.archiveMonthItem"],0,[InfinityMobile.view,"ReaderArchiveMonthItem"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderTopBarBtn",Ext.Container,{config:{cls:"toolbar"},initializ},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},tooltipLef}},0,["articlereadertopbarbtn"],["component","container","articlereadertopbarbtn"],{component:true,container:true,articlereadertopbarbtn:true},["widget.articlereadertopbarbtn"],0,[InfinityMobile.view,"ArticleReaderTopBarBtn"],0));(Ext.cmd.derive("InfinityMobile.view.BookmarkItem",Ext.Container,{config:{style:"float:left; max-height: 250px;",layout:"vbox",cls:"pointerCursor",items:[{maxHeight:250,style:"overflow:hidden",itemId:"bookmarkImage",html:"<img style='width:100%' />"},{itemId:"bookmarkText",cls:"thumbInfo",bottom:0,padding:5,width:"100%",style:"background-color:rgba(0, 0, 0, 0.5); color:white",html:"Page -1"},{itemId:"bookmarkDelete",top:5,right:5,width:30,height:30,padding:5,style:"background-color:rgba(0, 0, 0, 0.5); color:white",html:"<img style='width:20px; height:20px' src='../assets/article view/article-close-btn.png' />"}]},initialize:function(){var a=this;if(a.config.bookmarkItem!=null){a.bookmarkItem=a.config.bookmarkItem;a.loadBookmark();a.setPageDelete();a.setPageClick()}},loadBookmark:function(){var a=this;a.bookmarkImageContainer=a.getComponent("bookmarkImage");a.bookmarkImage=a.bookmarkImageContainer.element.down("img").dom;var b="http://edition.pagesuite.com";if(window.location.protocol=="https:"){b="https://"+location.host}a.bookmarkImage.src=b+"/get_image.aspx?w=280&eid="+a.bookmarkItem.editionguid+"&pnum="+(a.bookmarkItem.pageNumber)+"&lm="+latestLM;a.bookmarkTextContainer=a.getComponent("bookmarkText");a.bookmarkTextContainer.setHtml(a.bookmarkItem.name)},setPageDelet},setPageClick:function(){var a=this;a.element.on("tap",function(){a.fireEvent("loadPage",a)})}},0,["bookmarkitem"],["component","container","bookmarkitem"],{component:true,container:true,bookmarkitem:true},["widget.bookmarkitem"],0,[InfinityMobile.view,"BookmarkItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuShareItem",Ext.Container,{config:{cls:"readermenushareitem shareItems pointerCursor",style:"float:left"},initialize:function(){var b=this;b.message="";if(b.config.pnum!=null){b.pnum=b.config.pnum}if(b.config.articleSharing&&typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.articleShareUrl!=null){articleUrl=settings.sharing.articleShareUrl.replace("{{DOMAIN}}",window.location.hostname).replace("{{GUID}}",b.config.articleGuId);b.url=articleUrl}else{var a=window.location.href.substring(0,window.location.href.indexOf("?"));if(b.pnum!=null){b.url=a+"?pnum="+b.pnum+"&edid="+editionguid+"&isshared=true"}else{b.url=a+"?edid="+editionguid+"&isshared=true"}}if(typeof settings!="undefined"&&settings.sharing!=null&&settings.sharing.editionShareQueryString!=null&&settings.sharing.editionShareQueryString!=""){if(b.url!=null&&b.url.indexOf("?")>=0){b.url+="&"+settings.sharing.editionShareQueryString}else{b.url+="?"+settings.sharing.editionShareQueryString}}if(b.url!=null){b.url=encodeURIComponent(b.url)}if(b.config.message!=null){b.message=b.config.message}if(b.config.url!=null){b.url=b.config.url}if(b.config.icon!=null){b.icon=b.config.icon;b.loadIcon()}b.type="";if(b.config.type!=null){b.type=b.config.type}if(b.config.link!=null){b.link=b.config.link;b.setLink()}if(b.config.menu!=null){b.menu=b.config.menu}if(b.config.toolbar!=null){b.toolbar=b.config.toolbar}if(b.config.article!=null){b.article=b.config.article}if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){if(b.menu!=null){switch(b.type){case"email":b.setHtml('<i class="fa fa-envelope fa-lg pointerCursor" aria-hidden="true"></i>');break;case"facebook":b.setHtml('<i class="fa fa-facebook-official fa-lg pointerCursor" aria-hidden="true"></i>');break;case"twitter":b.setHtml('<i class="fa fa-twitter fa-lg pointerCursor" aria-hidden="true"></i>');break;case"googlePlus":b.setHtml('<i class="fa fa-google-plus fa-lg pointerCursor" aria-hidden="true"></i>');break;case"pinterest":b.setHtml('<i class="fa fa-pinterest fa-lg pointerCursor" aria-hidden="true"></i>')}}if(b.toolbar!=null||b.article!=null){b.setStyle({backgroundColor:"transparent"});switch(b.type){case"email":b.setHtml('<i class="fa fa-envelope fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break;case"facebook":case"Facebook":b.setHtml('<i class="fa fa-facebook-official fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break;case"twitter":case"Twitter":b.setHtml('<i class="fa fa-twitter fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break;case"googlePlus":case"Google+":b.setHtml('<i class="fa fa-google-plus fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break;case"pinterest":case"Pinterest":b.setHtml('<i class="fa fa-pinterest fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break}}}}},loadIco},setLink:function(){var a=this;a.element.on("tap",function(b){b.stopPropagation();a.fireEvent("shareTap",a)})},updateMessage:function(b){var a=this;a.message=b},updateUr}},0,["readermenushareitem"],["component","container","readermenushareitem"],{component:true,container:true,readermenushareitem:true},["widget.readermenushareitem"],0,[InfinityMobile.view,"ReaderMenuShareItem"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingArea",Ext.Panel,{config:{hideOnMaskTap:true,fullscreen:true,style:"position:absolute;top:-100%;",items:[{itemId:"backgroundTop",html:"<div style='position:relative;width:"+$(document).width()*2+"px;height:"+$(document).height()+"px;background-color:rgba(0, 0, 0, 0.5)'></div>"},{itemId:"clipArea",layout:{type:"hbox",align:"stretch"},height:"auto",width:"200%",items:[{itemId:"clipBox",html:'<div class="clipper" style="display:none;position:relative;top:0px;width:30px;overflow:auto;height:30px;border:4px solid rgb(69, 143, 187);"><div class="ui-resizable-handle ui-resizable-se se-handle" ></div></div>'},{itemId:"backgroundRight",flex:1,style:"background-color:rgba(0, 0, 0, 0.5)"}]},{itemId:"backgroundBottom",html:"<div style='position:relative;width:"+$(document).width()*2+"px;height:"+$(document).height()*2+"px;background-color:rgba(0, 0, 0, 0.5)'></div>",items:[{itemId:"controlPanel",width:150,height:50,style:{backgroundColor:"rgba(0,0,0,0.7)",borderRadius:"5px",position:"absolute",margin:"5px 0px 5px 0px",zIndex:"999"},hidden:true,layout:"hbox",items:[{itemId:"cancel",width:50,height:50,style:{backgroundImage:'url("resources/images/reader icons/close-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}},{itemId:"reset",height:50,width:50,style:{backgroundImage:'url("resources/images/reader icons/refresh-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}},{itemId:"confirm",height:50,width:50,style:{backgroundImage:'url("resources/images/reader icons/tick-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}}]}]},{itemId:"backgroundLeft",html:"<div style='position:absolute;left:-200%;top:0%;width:"+$(document).width()*2+"px;height:"+$(document).height()*3+"px;background-color:rgba(0, 0, 0, 0.5)'></div>"}]},initialize:function(){var b=this;var a=b.getComponent("clipArea");b.clipBox=a.getComponent("clipBox");b.leftBackground=b.getComponent("backgroundLeft").element.down("div").down("div").down("div");b.top=b.getComponent("backgroundTop").element.down("div").down("div").down("div");b.left=b.getComponent("backgroundLeft").element.down("div").down("div").down("div");b.bottom=b.getComponent("backgroundBottom").element.down("div").down("div").down("div");b.origDocH=$(document).height();b.origDocW=$(document).width();b.controlPanel=b.getComponent("backgroundBottom").getComponent("controlPanel");b.cancel=b.controlPanel.getComponent("cancel");b.reset=b.controlPanel.getComponent("reset");b.confirm=b.controlPanel.getComponent("confirm");b.confirm.element.on({tap:b.keyPress,scope:b});b.confirm.addCls("pointerCursor");b.cancel.element.on({tap:b.selfDestruct,scope:b});b.cancel.addCls("pointerCursor");b.reset.element.on({tap:b.resize,scope:b});b.reset.addCls("pointerCursor");if(b.config.reader!=null){b.reader=b.config.reader}if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}b.element.on({dragstart:function(c){c.stopPropagation()},drag:function(c){c.stopPropagation()},dragend:function(c){c.stopPropagation()}});window.onkeypres};b.clipperDrawn=false;b.element.dom.onmousedown=function(c){b.mouseDown(c)};b.element.dom.onmouseup=function(c){b.mouseUp(c)};b.element.dom.addEventListener("touchstart",function(c){b.mouseDownTouch(c)});b.element.dom.addEventListener("touchend",function(c){b.mouseUp(c)});b.draggableHandle=b.element.down(".ui-resizable-handle");b.draggableHandle.dom.addEventListener("touchstart",function(c){c.stopPropagation();var l=c.changedTouches[0].clientX;var j=c.changedTouches[0].clientY;var d=$(".clipper").width();var k=$(".clipper").height();var e="";switch(b.getPrefix().css){case"-webkit-":e=b.element.dom.style.webkitTransform;break;case"-ms-":e=b.element.dom.style.msTransform;break;default:e=b.element.dom.style.transform;break}var h=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var g=h[0].substring(0,h[0].indexOf("p"));var f=h[1].substring(0,h[1].indexOf("p"));b.move=function(m){m.stopPropagation();m.preventDefault();b.resizeClippingBox(m.changedTouches[0].clientX,m.changedTouches[0].clientY,g,f,l,j,d,k);b.checkControlsPosition()};document.addEventListener("touchmove",b.move)});b.draggableHandle.dom.addEventListener("touchend",function(c){document.removeEventListener("touchstart",null)});b.draggableHandle.dom.onmousedown=function(c){c.stopPropagation();var l=c.clientX;var j=c.clientY;var d=$(".clipper").width();var k=$(".clipper").height();var e="";switch(b.getPrefix().css){case"-webkit-":e=b.element.dom.style.webkitTransform;break;case"-ms-":e=b.element.dom.style.msTransform;break;default:e=b.element.dom.style.transform;break}var h=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var g=h[0].substring(0,h[0].indexOf("p"));var f=h[1].substring(0,h[1].indexOf("p"));document.onmousemove=function(m){m.stopPropagation();b.resizeClippingBox(m.clientX,m.clientY,g,f,l,j,d,k);b.checkControlsPosition()}};b.draggableHandle.dom.onmouseu};b.element.on("painted});b.handleKeyDown();mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},bannerAdChec},fillChec},zoomChec},keyPress:function(){var a=this;var e="";switch(a.getPrefix().css){case"-webkit-":e=a.element.dom.style.webkitTransform;break;case"-ms-":e=a.element.dom.style.msTransform;break;default:e=a.element.dom.style.transform;break}var d=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var c=d[0].substring(0,d[0].indexOf("p"));var b=d[1].substring(0,d[1].indexOf("p"));if(currentProfile=="desktop"){if(settings.newsday!=null){if(settings.newsday.extraTopBar=="true"){var f=InfinityMobile.app.getController("ClippingController").getExtratopbar();if(f!=null){f.setZIndex(2)}}}}a.fireEvent("createClip",c,b,a.readerActiveItem,a.clipBox,a)},mouseDownTouch:function(g){var d=this;g.preventDefault();if(!d.clipperDrawn){d.element.dom.style.transform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.webkitTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.mozTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.msTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";$(".clipper").css("display","");d.controlPanel.show();var k=g.changedTouches[0].clientX;var j=g.changedTouches[0].clientY;d.clipperDrawn=true;d.move=function(l){l.stopPropagation();l.preventDefault();d.drawClippingBox(k,j,l.changedTouches[0].clientX,l.changedTouches[0].clientY);d.checkControlsPosition()};document.addEventListener("touchmove",d.move)}else{var c="";switch(d.getPrefix().css){case"-webkit-":c=d.element.dom.style.webkitTransform;break;case"-ms-":c=d.element.dom.style.msTransform;break;default:c=d.element.dom.style.transform;break}var e=c.substring(c.indexOf("(")+1,c.indexOf(")")).split(",");var h=parseFloat(e[0].substring(0,e[0].indexOf("p")));var f=parseFloat(e[1].substring(0,e[1].indexOf("p")));var b=g.changedTouches[0].clientX;var a=g.changedTouches[0].clientY;d.move=function(l){l.preventDefault();var n=b-l.changedTouches[0].clientX;var m=a-l.changedTouches[0].clientY;d.moveClippingBox(h,f,n,m);d.checkControlsPosition()};document.addEventListener("touchmove",d.move)}},mouseDown:function(f){var e=this;console.log("MOVE");if(!e.clipperDrawn){e.element.dom.style.transform="translate3d("+f.clientX+"px, "+(f.clientY)+"px, 0px)";e.element.dom.style.webkitTransform="translate3d("+f.clientX+"px, "+(f.clientY)+"px, 0px)";e.element.dom.style.mozTransform="translate3d("+f.clientX+"px, "+(f.clientY)+"px, 0px)";e.element.dom.style.msTransform="translate3d("+f.clientX+"px, "+(f.clientY)+"px, 0px)";$(".clipper").css("display","");var d=f.clientX;var c=f.clientY;e.clipperDrawn=true;e.controlPanel.show();document.onmousemove=function(j){j.stopPropagation();e.drawClippingBox(d,c,j.clientX,j.clientY);e.checkControlsPosition()}}else{if(f.target.id!="se-handle"){var g="";switch(e.getPrefix().css){case"-webkit-":g=e.element.dom.style.webkitTransform;break;case"-ms-":g=e.element.dom.style.msTransform;break;default:g=e.element.dom.style.transform;break}var b=g.substring(g.indexOf("(")+1,g.indexOf(")")).split(",");var a=parseFloat(b[0].substring(0,b[0].indexOf("p")));var h=parseFloat(b[1].substring(0,b[1].indexOf("p")));document.onmousemove=function(j){var l=f.clientX-j.clientX;var k=f.clientY-j.clientY;e.moveClippingBox(a,h,l,k);e.checkControlsPosition()}}else{}}},resizeClippingBox:function(b,a,j,e,q,o,c,p){var g=this;if(b>parseFloat(j)){var n=c+b-q;var d=j}else{var d=b;var n=parseFloat(j)-b}if(a>parseFloat(e)){var f=p+a-o;var l=e}else{var l=a;var f=parseFloat(e)-a}if(d<0){var m=0-d;d=0;n-=m}if(l<0){var k=0-l;l=0;f-=k}g.element.dom.style.transform="translate3d("+d+"px, "+(l)+"px, 0px)";g.element.dom.style.webkitTransform="translate3d("+d+"px, "+(l)+"px, 0px)";g.element.dom.style.mozTransform="translate3d("+d+"px, "+(l)+"px, 0px)";g.element.dom.style.msTransform="translate3d("+d+"px, "+(l)+"px, 0px)";if(parseInt(d)+parseInt(n)>$(document).width()){n=$(document).width()-d}if(parseInt(l)+parseInt(f)>$(window).height()){f=$(window).height()-l}$(".clipper").css("height",f);$(".clipper").css("width",n)},moveClippingBox:function(e,d,j,h){var b=this;var f=e-j;var c=d-h;var g=b.clipBox.element.dom;if(f<0){f=0}if(c<0){c=0}if(f>$(document).width()-$(g).width()){f=$(document).width()-$(g).width()}if(c>$(window).height()-$(g).height()){c=$(window).height()-$(g).height()}var a="translate3d("+f+"px, "+(c)+"px, 0px)";b.element.dom.style.webkitTransform=a;b.element.dom.style.mozTransform=a;b.element.dom.style.msTransform=a;b.element.dom.style.transform=a},drawClippingBox:function(n,m,b,a){var f=this;var j;var c;if(b>n){var l=b-n;var c=n}else{var l=n-b;var c=b}if(a>m){var e=a-m;var j=m}else{var e=m-a;var j=a}if(c<0){var k=0-c;c=0;l-=k}if(j<0){var g=0-j;j=0;e-=g}var d="translate3d("+c+"px, "+(j)+"px, 0px)";f.element.dom.style.webkitTransform=d;f.element.dom.style.mozTransform=d;f.element.dom.style.msTransform=d;f.element.dom.style.transform=d;if(parseInt(c)+parseInt(l)>$(document).width()){l=$(document).width()-c}if(parseInt(j)+parseInt(e)>$(window).height()){e=$(window).height()-j}$(".clipper").css("height",e);$(".clipper").css("width",l)},checkControlsPosition:function(){var e=this;var b=e.controlPanel.element.dom;var a=e.clipBox.element.dom;var d=a.getBoundingClientRect().top;var c=a.getBoundingClientRect().right;var h=$(window).height()-$(a).height()-50;var g=$(window).width();var f="";if(d>=h){if($(a).width()-150>=0){f="translate3d(0px,-50px,0px)"}else{if(c+150>=g){f="translate3d(-100%,-50px,0px)"}else{f="translate3d("+$(a).width()+"px,-50px,0px)"}}}else{if($(a).width()-150>=0){f="translateX("+($(a).width()-150)+"px)"}else{if(c+150>=g){f="translate3d(-100%,-50px,0px)"}else{f="translateX(0px)"}}}$(b).css("-webkit-transform",f);$(b).css("-moz-transform",f);$(b).css("-ms-transform",f);$(b).css("transform",f)},mouseU},selfDestruct:function(){var a=this;window.onkeypress=null;if(!Ext.os.is.Phone){a.fireEvent("enableArticlesContainer")}if(currentProfile=="desktop"){if(settings.newsday!=null){if(settings.newsday.extraTopBar=="true"){var b=InfinityMobile.app.getController("ClippingController").getExtratopbar();if(b!=null){b.setZIndex(2)}}}}window.onkeydown=a.keyDownFunction;Ext.Viewport.remove(a);a.destroy()},resize:function(){var a=this;a.fireEvent("resetClippingArea",a)},destroy:function(){var a=this;mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["clippingarea"],["component","container","panel","clippingarea"],{component:true,container:true,panel:true,clippingarea:true},["widget.clippingarea"],0,[InfinityMobile.view,"ClippingArea"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageGallery",Ext.Carousel,{config:{modal:true,fullscreen:true,centered:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:20,items:[{itemId:"close",right:10,top:10,width:30,height:30,cls:"backgroundImage",style:"background-image:url('../assets/article view/article-close-btn.png');background-position:center;background-size:center;background-repeat:no-repeat;"}]},initializ},setUpNavigato},showNavigator:function(){var a=this;var b=a.getPrefix().css;if(a.toolbarHidden){if(a.bottomToolbar.isHidden()){a.bottomToolbar.show()}switch(b){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toolbarRaise { 0%{ -webkit-transform:translate3d(0px, 190px, 0px); } 100%{ -webkit-transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.webkitAnimation="toolbarRaise 0.3s forwards";break;case"-moz-":if(currentProfile=="desktop"){document.styleSheets[0].insertRule("@keyframes toolbarRaise { 0%{ transform:translate3d(0px, 190px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.animation="toolbarRaise 0.3s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes toolbarRaise { 0%{ -moz-transform:translate3d(0px, 190px, 0px); } 100%{ -moz-transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.mozAnimation="toolbarRaise 0.3s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toolbarRaise { 0%{ -ms-transform:translate3d(0px, 190px, 0px); } 100%{ -ms-transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.msAnimation="toolbarRaise 0.3s forwards";default:document.styleSheets[0].insertRule("@keyframes toolbarRaise { 0%{ transform:translate3d(0px, 190px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.animation="toolbarRaise 0.3s forwards"}a.toolbarHidden=false}else{if(a.bottomToolbar.isHidden()){a.bottomToolbar.show()}switch(b){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toolbarHide { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.webkitAnimation="toolbarHide 0.3s forwards";break;case"-moz-":if(currentProfile=="desktop"){document.styleSheets[0].insertRule("@keyframes toolbarHide { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.animation="toolbarHide 0.3s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes toolbarHide { 0%{ -moz-transform:translate3d(0px, 0px, 0px); } 100%{ -moz-transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.mozAnimation="toolbarHide 0.3s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toolbarHide { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.msAnimation="toolbarHide 0.3s forwards";default:document.styleSheets[0].insertRule("@keyframes toolbarHide { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.animation="toolbarHide 0.3s forwards"}a.toolbarHidden=true}},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}}},0,["readerimagegallery"],["component","container","carousel","readerimagegallery"],{component:true,container:true,carousel:true,readerimagegallery:true},["widget.readerimagegallery"],0,[InfinityMobile.view,"ReaderImageGallery"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageGalleryItem",Ext.Container,{config:{height:"100%",width:"100%",pageNo:0},initializ}},0,["readerimagegalleryitem"],["component","container","readerimagegalleryitem"],{component:true,container:true,readerimagegalleryitem:true},["widget.readerimagegalleryitem"],0,[InfinityMobile.view,"ReaderImageGalleryItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPuzzleArchiveItem",Ext.Container,{config:{layout:"vbox",items:[{itemId:"image",height:150},{itemId:"text",style:"text-align:center; font-size:18px; font-weight:bold"}]},initializ},setClickListene}},0,["readerpuzzlearchiveitem"],["component","container","readerpuzzlearchiveitem"],{component:true,container:true,readerpuzzlearchiveitem:true},["widget.readerpuzzlearchiveitem"],0,[InfinityMobile.view,"ReaderPuzzleArchiveItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArchivePageButton",Ext.Container,{config:{cls:"pointerCursor",margin:"0px 5px"},initializ},selected:function(){var a=this;a.element.dom.style.color="black"},unselected:function(){var a=this;a.element.dom.style.color=""}},0,["readerarchivepagebutton"],["component","container","readerarchivepagebutton"],{component:true,container:true,readerarchivepagebutton:true},["widget.readerarchivepagebutton"],0,[InfinityMobile.view,"ReaderArchivePageButton"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArticleHelper",Ext.Container,{config:{width:"100%",height:"100%",top:0,left:0,layout:{type:"vbox",pack:"center",align:"middle"},hideMaskOnTap:false,style:"color:white;",items:[{itemId:"space",height:40},{flex:1,width:"100%",layout:{type:"vbox",pack:"center",align:"middle"},itemId:"outerCounter",style:"background-color:rgba(0,0,0,0.7);",items:[{itemId:"headingBar",width:"100%",top:0,style:"font-size:30px;text-align:center;color:black;background-color:rgba(218,218,218,0.6);",padding:10,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"heading",style:"max-width:500px;",html:"There's a new way to view stories in today's paper"}]},{flex:1},{itemId:"container",width:"100%",style:"max-width:500px;max-height:700px;",layout:{type:"vbox",pack:"center",align:"middle"},defaults:{margin:"20 0"},items:[{itemId:"description",layout:{type:"vbox",pack:"center",align:"middle"},items:[{itemId:"icon",layout:{type:"vbox",pack:"center",align:"middle"},margin:"10 0",items:[{height:40,width:40,style:"background-image:url('resources/images/howTo/touch-screen-friendly.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"tapDesc",style:"font-size:20px;text-align:center;font-weight:bold;max-width:400px;",html:"Tap any story on any page to read it in a mobile-friendly format. Tap 'X' to return to the digital paper or swipe to the next story"}]},{itemId:"toggleSettingArea",layout:{type:"vbox",pack:"center",align:"middle"},items:[{itemId:"toggleDesc",style:"font-size:18px;text-align:center;max-width:500px;",html:"Going back to the paper? You can return to the page containing the story you just read or to the last page you viewed. Toggle your preference below",margin:"10 0"},{itemId:"toggle",cls:"pointerCursor",style:"font-size:18px;text-align:center;max-width:600px;",html:"Return to page featuring last story viewed: <input class='pointerCursor' type='checkbox' checked=\"true\" style='margin-left:5px;top:2px;position:relative;width:15px;height:15px;' onclick='if(this.checked){ this.checked = false; } else{ this.checked = true }' ></input>"}]},{itemId:"continueContainer",layout:{type:"hbox",pack:"center"},items:[{itemId:"continueBtn",cls:"pointerCursor btn",height:35,style:"background-color:#4591b8; color: white;",padding:"5 30 5 30",layout:{type:"vbox",pack:"center",align:"middle"},items:[{html:"Continue to paper"}]}]}]},{flex:1}]}]},initialize:function(){var a=this;a.space=a.getComponent("space");a.outerContainer=a.getComponent("outerCounter");a.headingBar=a.outerContainer.getComponent("headingBar");a.heading=a.headingBar.getComponent("heading");a.container=a.outerContainer.getComponent("container");a.desc=a.container.getComponent("description");a.tapDesc=a.desc.getComponent("tapDesc");a.toggleSettingArea=a.container.getComponent("toggleSettingArea");a.toggleDesc=a.toggleSettingArea.getComponent("toggleDesc");a.toggle=a.toggleSettingArea.getComponent("toggle");a.continueContainer=a.container.getComponent("continueContainer");a.continueBtn=a.continueContainer.getComponent("continueBtn");a.setupListeners();a.setupCurrentValue();if(currentProfile=="desktop"){a.tapDesc.setHtml("Tap any story on any page to read it in a desktop-friendly format. Tap 'X' to return to the digital paper or swipe to the next story");a.setDesktopFontSize()}if(Ext.os.is.Phone){a.setPhoneFontSize();Ext.Viewport.on("orientationchange",function(){a.setPhoneFontSize()})}},returnOrientation:function(){var a=Ext.Viewport.determineOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},setupListeners:function(){var a=this;a.toggle.element.on({tap:a.toggleCheck,scope:a});a.continueBtn.element.on({tap:a.continueToPaper,scope:a})},setupCurrentValu},setDesktopFontSiz},setPhoneFontSiz},continueToPape},toggleChec}},0,["articlehelper"],["component","container","articlehelper"],{component:true,container:true,articlehelper:true},["widget.articlehelper"],0,[InfinityMobile.view,"ReaderArticleHelper"],0));(Ext.cmd.derive("InfinityMobile.view.LightboxLink",Ext.Container,{config:{style:"padding:0px; border-radius:0px; background-color:white;",cls:"innerhtmlfullheight",height:"100%",width:"100%",layout:"vbox",zIndex:20,items:[{itemId:"topBar",height:40,layout:"hbox",items:[{id:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{flex:1,itemId:"content"}]},initialize:function(){var a=this;a.topBar=a.getComponent("topBar");a.topBar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});a.closeButton=a.topBar.getComponent("toolBarClose");a.setCloseButtonListenter();a.content=a.getComponent("content");if(a.config.mediaObject!=null){a.mediaObject=a.config.mediaObject;a.loadMediaObject()}},setCloseButtonListenter:function(){var a=this;a.closeButton.element.on("tap",function(){a.fireEvent("close",a)})},loadMediaObject:function(){var b=this;if(b.mediaObject.url!=null){var a=b.mediaObject.url;b.content.setHtml('<div class=\'iframeWrapper\' style=\'position:absolute; width:100%; height:100%; overflow-y:scroll; -webkit-overflow-scrolling:touch;\'><iframe style="border:none;width:100%; height:100%" class="iframePopover" src="'+a+'" /></div>')}}},0,["lightboxlink"],["component","container","lightboxlink"],{component:true,container:true,lightboxlink:true},["widget.lightboxlink"],0,[InfinityMobile.view,"LightboxLink"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPrompt",Ext.Container,{config:{modal:true,centered:true,width:"300px",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"promptToolBar",height:40,padding:8,items:[{top:10,left:10}]},{id:"promptBodyContainer",padding:"10 20",layout:"vbox",flex:1,items:[{itemId:"promptContainerText",margin:"0 0 20px 0"},{itemId:"buttonArea",padding:"0 20px",layout:"hbox",items:[{itemId:"okBtn",cls:"pointerCursor",flex:1,padding:8,style:"text-align:center;margin: 5px;border-style:solid;background-color:#458FBB;width:120px;color:white;"}]}]}]},initializ},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},checkValues:function(){var a=this;if(a.config.title!=null){a.title=a.config.title}if(a.config.message!=null){a.message=a.config.message}},setMessag},setupEvent}},0,["readerprompt"],["component","container","readerprompt"],{component:true,container:true,readerprompt:true},["widget.readerprompt"],0,[InfinityMobile.view,"ReaderPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingItems",Ext.Container,{config:{items:[{itemId:"deleteBtn",right:0,top:0,height:20,width:20,style:"background-image:url('resources/images/reader icons/close btn.png');background-size:contain;background-position:center;background-repeat:no-repeat;background-color:rgba(0,0,0,0.7);",hidden:true}]},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.image!=null){a.image=a.config.image;a.removeOriginFromUrl()}if(a.config.clicked!=null){a.clicked=a.config.clicked}a.deleteBtn=a.getComponent("deleteBtn");if(Ext.os.is.Phone){a.deleteBtn.setHeight(30);a.deleteBtn.setWidth(30)}a.setStyle({"float":"left",border:"1px solid gray",backgroundImage:"url('"+a.image+"')",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"});a.element.on("tap});a.deleteBtn.element.on({tap:a.deleteItem,scope:a});a.addCls("pointerCursor")},removeOriginFromUrl:function(){var a=this;a.image=a.image.replace("origin.","");if(location.protocol=="https:"){a.image=a.image.replace("http:","https:").replace("origin.media.cdn.pagesuite.com","media.pagesuite.com").replace("media.cdn.pagesuite.com","media.pagesuite.com")}},deleteIte}},0,["clippingitems"],["component","container","clippingitems"],{component:true,container:true,clippingitems:true},["widget.clippingitems"],0,[InfinityMobile.view,"ClippingItems"],0));(Ext.cmd.derive("InfinityMobile.view.clippingError",Ext.Container,{config:{modal:true,centered:true,width:"300px",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingPromptToolBar",height:40,items:[{top:10,left:10}]},{id:"clippingPromptBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingPromptContainerText",margin:"0 0 20px 0"},{itemId:"buttonArea",padding:"20",layout:"hbox",items:[{itemId:"okBtn",cls:"pointerCursor",flex:1,style:"text-align:center;margin: 5px;border-style:solid;height:30px;background-color:#458FBB;width:120px;color:white;"}]}]}]},initializ},onTa}},0,["clippingerror"],["component","container","clippingerror"],{component:true,container:true,clippingerror:true},["widget.clippingerror"],0,[InfinityMobile.view,"clippingError"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPrintItem",Ext.Container,{config:{style:"float:left;border:1px solid grey;overflow:hidden;",editionGuid:"2193eb4d-6dcd-42bf-a8bf-8c7ce0e0eecf",pageNo:1,pageIndex:1,displayNum:1,height:175,cls:"pointerCursor",items:[{itemId:"printItemLabel",bottom:0,minHeight:30,width:"100%",padding:"5px",style:"background-color:rgba(0,0,0,0.7); color:white; border-radius:5px; padding-left:7px",items:[{itemId:"printItemCheckBox",xtype:"checkboxfield",cls:"downloadCheckBox hideTick",disabled:true,right:0,top:-5,height:0,style:"background-color:rgba(0,0,0,0)"}]}]},initialize:function(){var b=this;var d=b.getEditionGuid();var a=b.getPageNo();var f=b.getDisplayNum();var c="http://edition.pagesuite.com";if(window.location.protocol=="https:"){c="https://"+location.host}var e=c+"/get_image.aspx?w=280&eid="+d+"&pnum="+a+"&lm="+latestLM;b.setHtml("<img style='width:100%' src='"+e+"' />");b.editionLabel=b.getComponent("printItemLabel");b.editionLabelCheckBox=b.editionLabel.getComponent("printItemCheckBox");b.editionLabel.setHtml(language.page+" "+f);if(settings.newsday!=null){b.addCls("thumbInfo");b.editionLabel.setStyle({borderRadius:"0px"})}if(!Ext.browser.is.Firefox){b.editionLabelCheckBox.setWidth(0)}b.setClickListener()},setClickListene}},0,["printitem"],["component","container","printitem"],{component:true,container:true,printitem:true},["widget.printitem"],0,[InfinityMobile.view,"ReaderPrintItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderDownloadItem",Ext.Container,{config:{style:"float:left;border:1px solid grey;overflow:hidden",editionGuid:"2193eb4d-6dcd-42bf-a8bf-8c7ce0e0eecf",pageNo:1,pageIndex:1,displayNum:1,cls:"pointerCursor",height:175,items:[{itemId:"downloadItemLabel",bottom:0,minHeight:30,width:"100%",padding:"5px",style:"background-color:rgba(0,0,0,0.7); color:white; border-radius:5px; padding-left:7px",items:[{itemId:"downloadItemCheckBox",cls:"thumbInfo",xtype:"checkboxfield",cls:"downloadCheckBox",disabled:true,right:0,top:-5,height:0,style:"background-color:rgba(0,0,0,0)"}]}]},initialize:function(){var c=this;var e=c.getEditionGuid();var b=c.getPageNo();var a=c.getPageIndex();var g=c.getDisplayNum();var d="http://edition.pagesuite.com";if(window.location.protocol=="https:"){d="https://"+location.host}var f=d+"/get_image.aspx?w=280&eid="+e+"&pnum="+b+"&lm="+latestLM;c.setHtml("<img style='width:100%' src='"+f+"' />");c.editionLabel=c.getComponent("downloadItemLabel");c.editionLabelCheckBox=c.editionLabel.getComponent("downloadItemCheckBox");c.editionLabel.setHtml(language.page+" "+g);if(settings.newsday!=null){c.addCls("thumbInfo");c.editionLabel.setStyle({borderRadius:"0px"})}if(!Ext.browser.is.Firefox){c.editionLabelCheckBox.setWidth(0)}c.setClickListener()},setClickListene}},0,["downloaditem"],["component","container","downloaditem"],{component:true,container:true,downloaditem:true},["widget.downloaditem"],0,[InfinityMobile.view,"ReaderDownloadItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPageNumber",Ext.Container,{config:{width:200,height:60,modal:true,hideOnMaskTap:true,padding:5,layout:"hbox",style:"background-color:black; border: 1px solid white",items:[{itemId:"pageNumberTextContainer",flex:1,height:48,style:"background-color:white",html:"<input type='number' style='border:none; width: 100%; height:100%; font-size: 32px; padding:5px;' />"},{width:5},{itemId:"pageNumberGo",height:48,padding:"10px 5px",style:"border: 1px solid white; font-size: 24px; color:white; text-align:center; cursor: pointer",html:"GO"}]},initialize:function(){var a=this;a.loaded=false;a.fireEvent("hideArticlesContainer");a.pageNumberTextContainer=a.getComponent("pageNumberTextContainer");a.pageNumberTextBox=a.pageNumberTextContainer.element.down("input").dom;a.pageNumberTextBox.addEventListener("touchstart",function(){a.pageNumberTextBox.focus()});a.initialiseFriendlyTextBox();a.pageNumberGoButton=a.getComponent("pageNumberGo");if(language.go!=null){a.pageNumberGoButton.setHtml(language.go.toUpperCase())}a.setGoListener();a.element.on({painted:function(){a.loaded=true;a.fixIphoneScroll()},scope:a});if(a.checkiOSVersion()||Ext.browser.is.Safari){setTimeout(function(){a.loaded=true},100)}a.handleKeyDown()},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},initialiseTextBo},initialiseFriendlyTextBo},setOnChangeListener:function(){var a=this;$(a.pageNumberTextBox).keyup(function(b){if(b.keyCode==13){try{a.pageNumberTextBox.blur()}catch(b){console.warn("blur is not a function on an input")}setTimeout(function(){a.fireEvent("jumpToPage",a)},100)}})},setGoListener:function(){var a=this;a.pageNumberGoButton.element.on("tap",function(){window.onkeydown=a.keyDownFunction;try{a.pageNumberTextBox.blur()}catch(b){console.warn("blur is not a function on an input")}a.fireEvent("jumpToPage",a)})},hide:function(){var a=this;if(a.loaded){window.onkeydown=a.keyDownFunction;a.fireEvent("showArticlesContainer");Ext.Container.prototype.hide.apply(this,arguments)}},fixIphoneScroll:function(){if(currentProfile=="phone"&&Ext.os.is.iOS&&Ext.browser.is.Safari){$("input").on("focus})}},checkiOSVersion:function(){if(Ext.os.is.iOS&&((typeof iOSVersion!="undefined"&&iOSVersion()>=13.4)||(currentProfile=="tablet"||currentProfile=="largetablet"))){return true}return false}},0,["readerpagenumber"],["component","container","readerpagenumber"],{component:true,container:true,readerpagenumber:true},["widget.readerpagenumber"],0,[InfinityMobile.view,"ReaderPageNumber"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderDownloadScreen",Ext.Container,{config:{fullscreen:true,style:"padding:0px; border-radius:0px;background-color:white;color: #4591B8; font-size:15px",layout:"vbox",pagesXml:"",items:[{itemId:"topBar",height:40,style:"background-color:#e6e6e6;",layout:"hbox",items:[{itemId:"backButton",height:"100%",width:"75px",padding:"10 10 10 5",layout:{type:"hbox",align:"center"},items:[{html:"<img src='../assets/download/back-arrow.png' style='height:20px' />",height:20},{width:5},{itemId:"backTxt",html:"Back"}]}]},{itemId:"content",flex:1,cls:"innerhtmlfullheight"}]},initialize:function(){var a=this;a.topBar=a.getComponent("topBar");a.backButton=a.topBar.getComponent("backButton");if(a.backButton!=null){a.backBtnTxt=a.backButton.getComponent("backTxt")}a.content=a.getComponent("content");a.backTxt="Back";if(typeof language!="undefined"&&language.back!=null){a.backTxt=language.back}a.pagesXml=a.getPagesXml();a.setBackListener();a.setLanguage();if(a.config.downloadUrl!=null){a.downloadUrl=a.config.downloadUrl;a.loadFrame()}mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.PAUSE)},setBackListener:function(){var a=this;a.backButton.element.on("tap",function(){a.fireEvent("back",a)})},loadFrame:function(){var b=this;var a=b.downloadUrl+"&html5="+currentProfile;b.content.setHtml("<iframe src='"+a+"' style='width:100%;height:inherit;border:none;' />")},setLanguage:function(){var a=this;if(a.backBtnTxt!=null&&a.backTxt!=null){a.backBtnTxt.setHtml(a.backTxt)}},destroy:function(){var a=this;mainPanel.fireEvent(InfinityMobile.controller.ReaderController.ADVERT.AUTO_REFRESH.EVENT.RESUME);Ext.Container.prototype.destroy.apply(this,arguments)}},0,["downloadscreen"],["component","container","downloadscreen"],{component:true,container:true,downloadscreen:true},["widget.downloadscreen"],0,[InfinityMobile.view,"ReaderDownloadScreen"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderItem",Ext.Panel,{config:{width:256,height:256,padding:5,style:"float:left;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold",padding:5,html:"This is a title"}]},initialize:function(){var a=this;a.article=a.config.article;a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.titleContainer.setHtml(a.article.headline);if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}},setBackgroundImage:function(){var c=this;var a=c.article.images;var b=a[0];c.imageContainer.element.dom.style.background="url('"+b.url+"')"},setNoImage:function(){var a=this;a.titleContainer.resetFloating();a.titleContainer.setStyle("background-color:white; color:black;");a.add({flex:1,padding:5,html:a.article.body,style:"overflow:hidden; font-size:14px"})}},0,["articlereaderitem"],["component","container","panel","articlereaderitem"],{component:true,container:true,panel:true,articlereaderitem:true},["widget.articlereaderitem"],0,[InfinityMobile.view,"ArticleReaderItem"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderLiveNewsBtn",Ext.Container,{config:{cls:"sectionBtn"},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.section!=null){a.section=a.config.section}var b="-3";if(Ext.browser.is.Firefox&&currentProfile=="phone"&&Ext.os.is.Android){b="0"}a.setHtml('<img class="sectionBtn" style="height:30px;" src="../assets/dynamicarticles/live-news-icon.gif"/><span style="margin:0px 5px;white-space:nowrap;position:relative;top:'+b+'px;font-family:Open Sans, sans-serif;font-size:14px;font-weight:bold;color:#929292;">'+language.dynamicArticles.liveNews+"</span>");a.element.on({tap:function(){a.fireEvent("liveNewsTiles",a)},painted:function(){var c=$(a.element.down("span").dom).width()+40;if(Ext.browser.is.Firefox&&currentProfile=="phone"&&Ext.os.is.Android){c+=5}a.setWidth(c)}})}},0,["articlereaderlivenewsbtn"],["component","container","articlereaderlivenewsbtn"],{component:true,container:true,articlereaderlivenewsbtn:true},["widget.articlereaderlivenewsbtn"],0,[InfinityMobile.view,"ArticleReaderLiveNewsBtn"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderSectionBtn",Ext.Container,{config:{style:"padding-left:10px;padding-right:10px;",cls:"sectionBtn"},initializ}},0,["articlereadersectionbtn"],["component","container","articlereadersectionbtn"],{component:true,container:true,articlereadersectionbtn:true},["widget.articlereadersectionbtn"],0,[InfinityMobile.view,"ArticleReaderSectionBtn"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderToggleViewOptions",Ext.Container,{config:{top:40,modal:true,hideOnMaskTap:true,zIndex:12,items:[{itemId:"paperViewBtn",top:40,height:40,width:200,layout:"hbox",style:"background-color:#d2d2d2;cursor:pointer;",items:[{height:25,top:8,width:60,style:"background-image:url('../assets/dynamicarticles/replica-paper-ic-grey@2x.png');background-position:50% 50%;background-repeat:no-repeat;background-size:contain;"},{itemId:"text",height:25,top:12.5,left:60}]},{itemId:"dynamicViewBtn",top:80,height:40,width:200,layout:"hbox",style:"background-color:#d2d2d2;cursor:pointer;",items:[{height:25,top:8,width:60,style:"background-image:url('../assets/dynamicarticles/dynamic-mode-ic-grey@2x.png');background-position:50% 50%;background-repeat:no-repeat;background-size:contain;"},{itemId:"text",height:25,top:12.5,left:60}]}]},initializ}},0,["articlereadertoggleviewoptions"],["component","container","articlereadertoggleviewoptions"],{component:true,container:true,articlereadertoggleviewoptions:true},["widget.articlereadertoggleviewoptions"],0,[InfinityMobile.view,"ArticleReaderToggleViewOptions"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderTopItem",InfinityMobile.view.ArticleReaderItem,{config:{width:768,height:512}},0,["articlereadertopitem"],["component","container","panel","articlereaderitem","articlereadertopitem"],{component:true,container:true,panel:true,articlereaderitem:true,articlereadertopitem:true},["widget.articlereadertopitem"],0,[InfinityMobile.view,"ArticleReaderTopItem"],0));(Ext.cmd.derive("InfinityMobile.view.DataCapture",Ext.Container,{config:{width:"350px",height:"wrap",fullscreen:true,modal:true,centered:true},initialize:function(){var a=this;a.setHtml("<div><div><br /><div style='padding:5px;background-color:#E6E6E6;width:100%;border-top-left-radius:5px;border-top-right-radius:5px;'><h1 style='font-size:14px;'><strong>Please Enter Your Details</strong></h1></div><div style='padding:10px;background-color:white;border-bottom-left-radius:5px;border-bottom-right-radius:5px;'><p style='font-size:12px;'>Please fill out the form below:</p><br /><form style='font-size:12px;' onkeydown='if(event.keyCode == 13){ parent.submit(); }'>Name: <input id='nameText' type='textfield' placeholder='Name'></input><br /><br />Email: <input id='emailText' type='textfield' placeholder='example@email.com'></input><br /><br /><div style='text-align:center;'><input style='margin: 5px;;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;' type='button' onclick='parent.submit()' value='Submit'></input></div></form></div></div>");submit=function(){var b=document.getElementById("nameText").value;var c=document.getElementById("emailText").value;if(b!=""&&c!=""&&c.indexOf("@")!=-1){a.fireEvent("submitDataCapture",a)}}}},0,["datacapture"],["component","container","datacapture"],{component:true,container:true,datacapture:true},["widget.datacapture"],0,[InfinityMobile.view,"DataCapture"],0));(Ext.cmd.derive("InfinityMobile.view.DataCaptureForm",Ext.Container,{config:{height:"80%",width:600,fullscreen:true,modal:true,centered:true,style:"background-color:white;border-radius:5px;",items:[{itemId:"brandingLogo",height:120,width:"calc(100% - 10px)",margin:"20 10 20 10"},{itemId:"welcomeMsg",padding:"20 60 20 60",style:"text-align:center;"},{itemId:"form",padding:"20 40 20 40",defaults:{margin:"10 0 10 0"},items:[{itemId:"firstname",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="First Name"/>'},{itemId:"surname",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Last Name"/>'},{itemId:"houseNo",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="House No/Name"/>'},{itemId:"address",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Address"/>'},{itemId:"postcode",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Postcode"/>'},{itemId:"telephone",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Telephone No"/>'},{itemId:"email",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Email Address*"/>'},{itemId:"password",width:"100%",height:50,html:'<input type="password" style="height:40px;width:100%;" placeholder="Password*"/>'},{itemId:"confirmPassword",width:"100%",height:50,html:'<input type="password" style="height:40px;width:100%;" placeholder="Confirm Password*"/>'},{itemId:"consentArea",width:"100%"},{itemId:"privacyPolicy",width:"100%",hidden:true},{itemId:"required",html:"* Required Field",style:"font-size:12px;"},{itemId:"termsCheckbox",html:"<input type='checkbox' style:'height:10px;'/><label style='padding-left:5px;font-size:14px;'></label><a style='padding-left:5px;font-size:14px;'></a>"},{itemId:"updatedCheckbox",html:"<input type='checkbox' style:'height:10px;'/><label style='padding-left:5px;font-size:14px;'>Keep me updated on the latest news</label>"},{itemId:"errorMsg",hidden:true,html:"*Please make sure the required fields above are completed.",style:"color:red;"},{itemId:"passwordErrorMsg",hidden:true,html:"*Invalid Password. Passwords either do not match or do not meet the requirements. Your password must be at least 8 characters long, include upper and lower case letters, a number, and a special character (!, @, #, $, %, ^, &, *)",style:"color:red;"}]},{itemId:"buttonContainer",width:"calc(100%-10px)",height:180,padding:"10 40 10 40",defaults:{margin:"10 0 10 0"},items:[{itemId:"registerBtn",cls:"pointerCursor",height:60,width:"calc(100%-10px)",style:"text-align:center;vertical-align: middle;line-height:60px;",html:"<p>Register</p>"},{itemId:"skipBtn",cls:"pointerCursor",height:60,width:"100%",style:"text-align:center;color:rgb(0, 0, 0);background-color:rgb(229, 229, 229);vertical-align:middle;line-height:60px;",html:"Skip"}]}]},initialize:function(){var a=this;if(a.config.logo!=null){a.logo=a.config.logo}if(a.config.welcomeText!=null){a.welcomeText=a.config.welcomeText}if(a.config.settings!=null){a.settings=a.config.settings}a.handleKeyDown();a.brandingLogo=a.getComponent("brandingLogo");a.welcomeTextArea=a.getComponent("welcomeMsg");a.form=a.getComponent("form");a.buttonContainer=a.getComponent("buttonContainer");a.registerBtn=a.buttonContainer.getComponent("registerBtn");a.skipBtn=a.buttonContainer.getComponent("skipBtn");a.errorMsg=a.form.getComponent("errorMsg");a.passwordErrorMsg=a.form.getComponent("passwordErrorMsg");a.termsCheck=a.form.getComponent("termsCheckbox");if(currentProfile=="desktop"){a.element.dom.style.overflowY="scroll";if(Ext.browser.is.IE){a.brandingLogo.element.dom.style.minHeight="120px";a.registerBtn.element.dom.style.minHeight="60px";a.skipBtn.element.dom.style.minHeight="60px"}}else{a.setScrollable({direction:"vertical"})}a.brandingLogo.setStyle({backgroundImage:"url("+a.logo+")",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"});a.welcomeTextArea.setHtml(language.dataCapture.containerText);a.setupFormFields();if(currentProfile!="desktop"){a.setupTouchDevices()}a.registerBtn.element.on({tap:a.register,scope:a});a.registerBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.skipBtn.element.on({ta},scope:a})},setupTouchDevices:function(){var a=this;var b=function(){this.focus()};a.firstname.element.on({tap:b});a.surname.element.on({tap:b});a.email.element.on({tap:b});a.houseNo.element.on({tap:b});a.address.element.on({tap:b});a.postcode.element.on({tap:b});a.telephone.element.on({tap:b});a.updatedCheckbox.element.on({tap:b});a.termsCheck.element.on({tap:b});a.passwordArea.element.on({tap:b});a.confirmPasswordArea.element.on({tap:b})},setupFormFields:function(){var a=this;a.firstname=a.form.getComponent("firstname");a.surname=a.form.getComponent("surname");a.email=a.form.getComponent("email");a.houseNo=a.form.getComponent("houseNo");a.address=a.form.getComponent("address");a.postcode=a.form.getComponent("postcode");a.telephone=a.form.getComponent("telephone");a.updatedCheckbox=a.form.getComponent("updatedCheckbox");a.consentArea=a.form.getComponent("consentArea");a.passwordArea=a.form.getComponent("password");a.confirmPasswordArea=a.form.getComponent("confirmPassword");a.privacyPolicy=a.form.getComponent("privacyPolicy");a.hasTerms=false;$(a.email.element.down("input").dom).attr("placeholder",language.dataCapture.email+"*");a.requiredText=a.form.getComponent("required");a.requiredText.setHtml(language.dataCapture.required);if(a.settings.firstname!=null){if(a.settings.firstname.hasFirstname!=null){if(a.settings.firstname.required=="true"){$(a.firstname.element.down("input").dom).attr("placeholder",language.dataCapture.firstName+"*");a.firstname.required=true}else{a.firstname.required=false;$(a.firstname.element.down("input").dom).attr("placeholder",language.dataCapture.firstName)}}else{a.firstname.hide()}}else{a.firstname.hide()}if(a.settings.surname!=null){if(a.settings.surname.hasSurname!=null){if(a.settings.surname.required=="true"){$(a.surname.element.down("input").dom).attr("placeholder",language.dataCapture.lastName+"*");a.surname.required=true}else{$(a.surname.element.down("input").dom).attr("placeholder",language.dataCapture.lastName);a.surname.required=false}}else{a.surname.hide()}}else{a.surname.hide()}if(a.settings.houseNo!=null){if(a.settings.houseNo.hasHouseNo!=null){if(a.settings.houseNo.required=="true"){$(a.houseNo.element.down("input").dom).attr("placeholder",language.dataCapture.houseNo+"*");a.houseNo.required=true}else{$(a.houseNo.element.down("input").dom).attr("placeholder",language.dataCapture.houseNo);a.houseNo.required=false}}else{a.houseNo.hide()}}else{a.houseNo.hide()}if(a.settings.address!=null){if(a.settings.address.hasAddress!=null){if(a.settings.address.required=="true"){$(a.address.element.down("input").dom).attr("placeholder",language.dataCapture.address+"*");a.address.required=true}else{$(a.address.element.down("input").dom).attr("placeholder",language.dataCapture.address);a.address.required=false}}else{a.address.hide()}}else{a.address.hide()}if(a.settings.postcode!=null){if(a.settings.postcode.hasPostcode!=null){if(a.settings.postcode.required=="true"){$(a.postcode.element.down("input").dom).attr("placeholder",language.dataCapture.postCode+"*");a.postcode.required=true}else{$(a.postcode.element.down("input").dom).attr("placeholder",language.dataCapture.postCode);a.postcode.required=false}}else{a.postcode.hide()}}else{a.postcode.hide()}if(a.settings.telephone!=null){if(a.settings.telephone.hasTelephone!=null){if(a.settings.telephone.required=="true"){$(a.telephone.element.down("input").dom).attr("placeholder",language.dataCapture.telephone+"*");a.telephone.required=true}else{$(a.telephone.element.down("input").dom).attr("placeholder",language.dataCapture.telephone);a.telephone.required=false}}else{a.telephone.hide()}}else{a.telephone.hide()}$(a.passwordArea.element.down("input").dom).attr("placeholder",language.dataCapture.password+"*");a.passwordArea.required=true;$(a.confirmPasswordArea.element.down("input").dom).attr("placeholder",language.dataCapture.confirmPassword+"*");a.confirmPasswordArea.required=true;a.passwordErrorMsg.setHtml("*"+language.dataCapture.invalidPassword);if(a.settings.hasOptIn=="true"){a.updatedCheckbox.element.down("label").dom.innerHTML=language.dataCapture.optIn}else{a.updatedCheckbox.hide()}if(a.settings.terms!=null){a.hasTerms=true;if(a.settings.terms.termsUrl!=null){a.termsCheck.element.down("a").dom.href=a.settings.terms.termsUrl;a.termsCheck.element.down("a").dom.innerHTML=language.dataCapture.terms}else{a.termsCheck.element.down("label").dom.innerHTML=language.dataCapture.terms}}else{a.termsCheck.hide()}a.registerBtn.setHtml(language.register);if(a.settings.showSkip!="true"){a.skipBtn.hide()}else{a.skipBtn.setHtml(language.skip)}a.setupConsentCheckboxes();a.setupPrivacyPolicy()},setupPrivacyPolicy:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.dataCapture!=null&&settings.reader.dataCapture.consent!=null){var c=settings.reader.dataCapture.consent;if(c.privacyPolicyUrl!=null&&c.privacyPolicyUrl.length>0){var b=typeof language!="undefined"&&language.dataCapture!=null&&language.dataCapture.privacyPolicy!=null?language.dataCapture.privacyPolicy:"Privacy Policy";a.privacyPolicy.setHtml("<a href='#'>"+b+"</a>");a.privacyPolicy.element.on("tap});a.privacyPolicy.show()}}},setupConsentCheckboxes:function(){var d=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.dataCapture!=null&&settings.reader.dataCapture.consent!=null){var e=settings.reader.dataCapture.consent;var f=e.consentItems;for(var c in f){var b=f[c];var a=Ext.create("InfinityMobile.view.ConsentField",{consentItem:b});d.consentArea.add(a)}}},register:function(){var z=this;var f=false;var n={};var v=null;var m=null;var u=null;var k=null;var g=null;var A=null;var y=null;var h=z.firstname.element.down("input").dom;var r=z.surname.element.down("input").dom;var w=z.email.element.down("input").dom;var e=z.houseNo.element.down("input").dom;var c=z.address.element.down("input").dom;var d=z.postcode.element.down("input").dom;var p=z.telephone.element.down("input").dom;var t=z.updatedCheckbox.element.down("input");var l=z.termsCheck.element.down("input");if(z.firstname.required){if(h.value.length==0){h.style.border="1px solid red";f=true}else{n.firstname=h.value;h.style.border=""}}else{if(h.value.length>0){n.firstname=h.value}}if(z.surname.required){if(r.value.length==0){r.style.border="1px solid red";f=true}else{n.surname=r.value;r.style.border=""}}else{if(r.value.length>0){n.surname=r.value}}if(z.validateEmail(w.value)){if(w.value.length==0){w.style.border="1px solid red";f=true}else{n.email=w.value;w.style.border=""}}else{w.style.border="1px solid red";f=true}if(z.houseNo.required){if(e.value.length==0){e.style.border="1px solid red";f=true}else{n.houseNo=e.value;e.style.border=""}}else{if(e.value.length>0){n.houseNo=e.value}}if(z.address.required){if(c.value.length==0){c.style.border="1px solid red";f=true}else{n.address=c.value;c.style.border=""}}else{if(c.value.length>0){n.houseNo=c.value}}if(z.postcode.required){if(d.value.length==0){d.style.border="1px solid red";f=true}else{n.postcode=d.value;d.style.border=""}}else{if(d.value.length>0){n.postcode=d.value}}if(z.telephone.required){if(p.value.length==0){p.style.border="1px solid red";f=true}else{n.telephone=p.value;p.style.border=""}}else{if(p.value.length>0){n.postcode=p.value}}if(!z.updatedCheckbox.isHidden()){if(t.is(":checked")){n.keepMeUpdated="true"}}var j=true;if(!z.termsCheck.isHidden()){console.log(l);if(l.dom.checked){j=true}else{j=false}}var b=z.passwordArea.element.down("input").dom.value;var o=z.confirmPasswordArea.element.down("input").dom.value;if(b!=o){z.passwordArea.element.down("input").dom.style.border="1px solid red";z.confirmPasswordArea.element.down("input").dom.style.border="1px solid red";f=true;z.passwordErrorMsg.show()}else{if(b.match(/(?=^.{8,}$)(?=.*\d)(?=.*[!@#$%^&*]+)(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)){n.password=b;z.passwordArea.element.down("input").dom.style.border="";z.confirmPasswordArea.element.down("input").dom.style.border="";z.passwordErrorMsg.hide()}else{z.passwordArea.element.down("input").dom.style.border="1px solid red";z.confirmPasswordArea.element.down("input").dom.style.border="1px solid red";f=true;z.passwordErrorMsg.show()}}var a=z.consentArea.getItems().items;n.consentItems=[];for(var q in a){var s=a[q];if(s.blocksSubscription&&!s.checkbox.checked){f=true;s.element.dom.style.border="1px solid red"}else{s.element.dom.style.border=""}n.consentItems.push(s)}console.log(f,j);if(f||!j){z.errorMsg.show()}else{z.fireEvent("sendData",z,n)}},validateEmai},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},revertKeyDown:function(){var a=this;window.onkeydown=a.keyDownFunction},hide:function(){this.revertKeyDown();Ext.Container.prototype.hide.apply(this,arguments)},destro}},0,["datacaptureform"],["component","container","datacaptureform"],{component:true,container:true,datacaptureform:true},["widget.datacaptureform"],0,[InfinityMobile.view,"DataCaptureForm"],0));(Ext.cmd.derive("InfinityMobile.view.FullScreenImageGallery",Ext.Container,{config:{fullscreen:true,modal:true,centered:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:20,items:[{itemId:"close",right:10,top:10,width:30,height:30,cls:"backgroundImage",style:"background-image:url('../assets/article view/article-close-btn.png');background-position:center;background-size:center;background-repeat:no-repeat;"}]},initialize:function(){var a=this;a.closeButton=a.getComponent("close");a.setCloseButtonListener();a.element.on("tap",function(){a.fireEvent("bottomToolbar",a)});a.fireEvent("initialized",a)},setCloseButtonListener:function(){var a=this;a.closeButton.element.on("tap",function(){a.destroy()})}},0,["imagegallery"],["component","container","imagegallery"],{component:true,container:true,imagegallery:true},["widget.imagegallery"],0,[InfinityMobile.view,"FullScreenImageGallery"],0));(Ext.cmd.derive("InfinityMobile.view.FullscreenImageGalleryItem",Ext.Container,{config:{pageNo:"",page:"",style:"color:white",cls:"innerhtmlfullheight"},initializ},setImag}},0,["imagegalleryitem"],["component","container","imagegalleryitem"],{component:true,container:true,imagegalleryitem:true},["widget.imagegalleryitem"],0,[InfinityMobile.view,"FullscreenImageGalleryItem"],0));(Ext.cmd.derive("InfinityMobile.view.ImageCarousel",Ext.Carousel,{initializ},config:{indicator:false,data:false,pageNumber:0,skipActiveItemChange:true,pageTemplate:false,visiblePages:3,directionLock:true,landscapePageIncrement:1,mode:"single"},setPageTemplate:function(a){this.pageTemplate=a},setCards:function(){var j=this;j._skipActiveItemChange=true;var k=1;if(j._pageNumber==0){for(var e=0;e<j._visiblePages;e++){var b=(e*k);j.add(j.createCard(j.getData()[b],b,j.getData()))}j.setActiveItem(0)}else{if(j._pageNumber==(j.getData().length-1)){for(var e=(j._pageNumber-2);e<j.getData().length;e++){if(j.getData()[e]!=null){j.add(j.createCard(j.getData()[e],e,j.getData()))}}j.setActiveItem(2)}else{var f=j._pageNumber;var a=j.createCard(j.getData()[f],f,j.getData());j.add(a);var c=parseFloat(j._pageNumber-(1*k));var d=j.createCard(j.getData()[c],c,j.getData());j.insert(0,d);var h=parseFloat(j._pageNumber)+(1*k);var g=j.createCard(j.getData()[h],h,j.getData());j.add(g);j.setActiveItem(1)}}j._skipActiveItemChange=false},handleItemChang},updateItemCS},createCar},addCardToFron},addCardToBac},jumpToFirs},jumpToLas},jumpToPag}},0,["imagecarousel"],["component","container","carousel","imagecarousel"],{component:true,container:true,carousel:true,imagecarousel:true},["widget.imagecarousel"],0,[InfinityMobile.view,"ImageCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutAdvertView",InfinityMobile.view.LayoutView,{config:{advertState:false,style:"text:align:center"},initializ},initializePag},loadDfpA},toggleA}},0,["layoutadvertview"],["component","container","layoutview","layoutadvertview"],{component:true,container:true,layoutview:true,layoutadvertview:true},["widget.layoutadvertview"],0,[InfinityMobile.view,"LayoutAdvertView"],0));(Ext.cmd.derive("InfinityMobile.view.PrintPreviewArticle",Ext.Container,{config:{height:"0px",width:"0%",modal:true,fullscreen:true,hideOnMaskTap:true,centered:true,style:"border-radius:10px",zIndex:11111},initialize:function(){var c=this;c.delayImage=500;if(c.config.delayImages!=null){c.delayImage=c.config.delayImages}if(c.config.imgCheck!=null){c.imgCheck=c.config.imgCheck}else{c.imgCheck=false}var a="0px";var b="0px";if(Ext.os.is.Android){a=$(document).height()+"px";b=$(document).width();$(c.element.dom).css("visibility","hidden")}if(currentProfile!="desktop"){c.setLeft(0)}c.element.on({painted:function(){var d=this;console.log("PAINTED");loadListener=function(e){console.log(e);console.log(d.iframeContent.document);d.print()};d.setHtml("<div id='iframeContainer'></div>");d.iframeElement=document.createElement("iframe");d.iframeContent=d.iframeElement.contentWindow?d.iframeElement.contentWindow:(d.iframeElement.contentDocument.document?d.iframeElement.contentDocument.document:d.iframeElement.contentDocument);console.log("SETTING CONTENT");d.iframeContent.document.write(d.config.doc);console.log("SET CONTENT")},scope:c})},print:function(){var a=this;console.log("PRINTING");a.iframeContent.focus();a.iframeContent.print();a.hide()},hide:function(){var a=this;a.destroy()}},0,["printpreviewarticle"],["component","container","printpreviewarticle"],{component:true,container:true,printpreviewarticle:true},["widget.printpreviewarticle"],0,[InfinityMobile.view,"PrintPreviewArticle"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageGalleryThumb",Ext.Container,{config:{width:140,margin:5},initializ}},0,["readerimagegallerythumb"],["component","container","readerimagegallerythumb"],{component:true,container:true,readerimagegallerythumb:true},["widget.readerimagegallerythumb"],0,[InfinityMobile.view,"ReaderImageGalleryThumb"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSocial",InfinityMobile.view.Overlay,{config:{},initialize:function(){var a=this;var b="<iframe style='width:100%;height:60px; border:none' src='../testsocialshare.aspx' />";a.setHtml(b)}},0,["social"],["component","container","panel","overlay","social"],{component:true,container:true,panel:true,overlay:true,social:true},["widget.social"],0,[InfinityMobile.view,"ReaderSocial"],0));(Ext.cmd.derive("InfinityMobile.view.Ticker",Ext.Container,{config:{padding:"5px",zIndex:"1000000"},initialize:function(){var b=this;var a=b.config.url;b.str="";$.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q="+encodeURIComponent(a),dataType:"json",async:true,success:function(c){if(c.responseData!=null&&c.responseData.feed&&c.responseData.feed.entries){$.each(c.responseData.feed.entrie})}b.str=b.str.substring(0,b.str.length-18);b.setHtml('<p class="marquee" style="color:white;">'+b.str+"</p>");b.element.dom.style.backgroundColor="#1e1e1e";b.element.dom.style.color="white";b.element.dom.style.overflow="hidden";try{document.styleSheets[0].insertRule("@keyframes marquee {0% { text-indent:100% ;} 100% {text-indent:"+(b.element.dom.children[0].scrollWidth*-1)+"px}}",0);if(window.navigator.appName=="Netscape"||window.navigator.appName=="Microsoft Internet Explorer"){b.element.dom.style.animation="marquee 50s linear infinite;"}}catch(d){console.log(d)}}})}},0,["ticker"],["component","container","ticker"],{component:true,container:true,ticker:true},["widget.ticker"],0,[InfinityMobile.view,"Ticker"],0));(Ext.cmd.derive("InfinityMobile.view.SectionScrollerItem",Ext.Container,{config:{height:"100%",selected:false,cls:"pointerCursor"},initialize:function(){var a=this;a.setVars();a.setStyling();a.setListeners()},setVars:function(){var a=this;if(a.config.section!=null){a.section=a.config.section}if(a.config.selected!=null){a.selected=a.config.selected}a.selectedColour="white";a.deselectedColour="gray";if(settings.menu.sectionList!=null&&settings.menu.sectionList.selectedColour!=null){a.selectedColour="rgba("+hexToRgb(settings.menu.sectionList.selectedColour)+", 1)"}if(settings.menu.sectionList!=null&&settings.menu.sectionList.deselectedColour!=null){a.deselectedColour="rgba("+hexToRgb(settings.menu.sectionList.deselectedColour)+", 1)"}a.setHtml(a.section.name)},setStyling:function(){var a=this;a.setStyle({color:a.deselectedColour,fontSize:"18px",fontWeight:"bold",margin:"10px",whiteSpace:"nowrap"})},setSelected:function(a){var b=this;b.selected=a;if(a){b.setStyle({color:b.selectedColour});b.addCls("section-selected")}else{b.setStyle({color:b.deselectedColour});b.removeCls("section-selected")}},setListeners:function(){var a=this;a.element.on({tap:a.onTap,scope:a})},onTap:function(){var a=this;a.fireEvent("jumpToSection",a.section)}},0,["sectionscrolleritem"],["component","container","sectionscrolleritem"],{component:true,container:true,sectionscrolleritem:true},["widget.sectionscrolleritem"],0,[InfinityMobile.view,"SectionScrollerItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPageThumbnail",Ext.Container,{config:{baseCls:"page-thumbnail pointerCursor",style:"float:left;border:1px solid grey; overflow:hidden;-ms-touch-action:auto;-ms-user-action:text;",editionGuid:"",editionName:"",pageIndex:"",pageNo:"",height:175,items:[{itemId:"itemLabel",cls:"thumbInfo",bottom:0,minHeight:30,width:"100%",padding:"5px",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initialize:function(){var a=this;a.setupVars();a.setupThumbnail(a.thumbType)},setupVars:function(){var a=this;a.itemLabel=a.getComponent("itemLabel");if(a.config.thumbType!=null){a.thumbType=a.config.thumbType}},setupThumbnail:function(a){var b=this;switch(a.toLowerCase()){case"edition":if(b.config.editionGuid!=null){b.editionGuid=b.config.editionGuid}if(b.config.editionName!=null){b.editionName=b.config.editionName}b.setupEditionThumbnail(b.editionGuid,b.editionName);break;case"page":if(b.config.editionGuid!=null){b.editionGuid=b.config.editionGuid}if(b.config.pageNo!=null){b.pageNo=b.config.pageNo}if(b.config.pageIndex!=null){b.pageIndex=b.config.pageIndex}if(b.config.displayNum!=null){b.displayNum=b.config.displayNum}if(b.config.toggle!=null){b.toggle=b.config.toggle}b.setupPageThumbnail(b.editionGuid,b.pageNo,b.pageIndex,b.displayNum,b.toggle);break}},setThumbnailImage:function(a){var b=this;b.setHtml("<img style='width:100%;' src='"+a+"' />")},setLabel:function(d,a){var c=this;if(c.itemLabel!=null&&d!=null&&d.trim().length>0){c.itemLabel.setHtml(d)}else{c.itemLabel.hide()}if(a&&c.itemLabel!=null){c.labelCheckfield=Ext.create("InfinityMobile.view.CustomCheckbox",{cls:"hideTick",checked:false,top:0});var b="left";if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){c.labelCheckfield.setLeft(0);c.itemLabel.insert(0,c.labelCheckfield);b="right"}else{c.labelCheckfield.setRight(0);c.itemLabel.add(c.labelCheckfield)}c.itemLabel.setStyle({backgroundColor:"rgba(0,0,0,0.7)",color:"white",borderRadius:"5px",paddingLeft:"7px",textAlign:b})}if(typeof settings!="undefined"&&settings.newsday!=null){c.addCls("thumbInfo");c.itemLabel.setStyle({borderRadius:"0px"})}},setTap:function(a){var b=this;if(((typeof isEdge!="undefined"&&isEdge())||Ext.browser.is.IE)&&currentProfile=="desktop"){b.element.dom.addEventListener("click",a)}else{b.element.on({tap:a,scope:b})}},setupEditionThumbnail:function(d,c){var a=this;var b="http://edition.pagesuite.com";if(window.location.protocol=="https:"){b="https://"+location.host}var e=b+"/get_image.aspx?w=280&eid="+a.editionGuid+"&pnum=first";a.setThumbnailImage(e);a.setLabel(c,false);a.setTap(function(){var g="";if(qs.localhost!=null&&qs.localhost=="true"){g="&localhost=true"}if(typeof EDITIONAPP!="undefined"&&EDITIONAPP){if(window.parent!=null){window.parent.postMessage({type:"openEdition",editionguid:a.editionGuid},"*")}}else{try{var h=Ext.urlDecode(window.location.search.substring(1));if(Object.keys(h).indexOf("nie")>-1&&h.nie=="true"){window.location.href=location.protocol+"//"+location.host+"/launch.aspx?eid="+a.editionGuid+"&nie=true"}else{if(Object.keys(h).indexOf("fromnie")>-1&&h.fromnie=="true"){window.location.href=location.protocol+"//"+location.host+"/launch.aspx?eid="+a.editionGuid+"&fromnie=true"}else{window.location.href=location.protocol+"//"+location.host+"/launch.aspx?eid="+a.editionGuid}}}catch(f){console.error("[ReaderPageThumbnail]:\n",f);window.location.href=location.protocol+"//"+location.host+"/launch.aspx?eid="+a.editionGuid}}})},setupPageThumbnail:function(j,a,d,c,f){var h=this;var e="http://edition.pagesuite.com";if(window.location.protocol=="https:"){e="https://"+location.host}var l=e+"/get_image.aspx?w=280&eid="+j+"&pnum="+a+"&lm="+latestLM;h.setThumbnailImage(l);var k=a;if(c!=null){k=c}var b=h.returnPageText()+" "+k;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){b=k+" "+h.returnPageText()}h.setLabel(b,f);if(f){var };h.setTap(g)}},returnPageText:function(){return typeof language!="undefined"&&language.page!=null?language.page:"Page"}},0,["readerpagethumbnail"],["component","container","readerpagethumbnail"],{component:true,container:true,readerpagethumbnail:true},["widget.readerpagethumbnail"],0,[InfinityMobile.view,"ReaderPageThumbnail"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMessagePrompt",Ext.Container,{config:{modal:{zIndex:999999998},centered:true,width:300,style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true,zIndex:999999999},initializ},setupVar},setupPromp}},0,["readerMessagePrompt"],["component","container","readerMessagePrompt"],{component:true,container:true,readerMessagePrompt:true},["widget.readerMessagePrompt"],0,[InfinityMobile.view,"ReaderMessagePrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderDpsPrompt",InfinityMobile.view.Overlay,{config:{layout:"vbox",width:350,padding:"20",style:"padding:0px;max-height:100%;",items:[{itemId:"textContainer",html:"Please select a page:"},{itemId:"pageContainer",layout:"hbox",padding:10,defaults:{width:140,margin:"0px 10px 0px 0px"}},{itemId:"pageName",html:"<input type='text' class='bookmarkName' placeholder='Name' style='width:100%; padding-left:2px;'>",padding:6,defaults:{margin:"0px 0px 0px 0px"},hidden:true},{itemId:"addPage",width:150,xtype:"readeroverlaybutton",txt:"Add",margin:"15px auto auto auto",hidden:true}]},initialize:function(){var a=this;a.setupVars();a.setupPages(a.promptType);a.setupLanguage();a.setUpListeners()},setupVars:function(){var a=this;a.textContainer=a.getComponent("textContainer");a.bookmarkName=a.getComponent("pageName");a.bookmarkNameValue=a.getComponent("pageName").element.down(".bookmarkName").dom;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){a.bookmarkNameValue.dir="rtl"}a.bookmarkAddButton=a.getComponent("addPage");if(a.config.leftPageNo!=null){a.leftPageNo=a.config.leftPageNo}if(a.config.rightPageNo!=null){a.rightPageNo=a.config.rightPageNo}if(a.config.leftDisplayNo!=null){a.leftDisplayNo=a.config.leftDisplayNo}if(a.config.rightDisplayNo!=null){a.rightDisplayNo=a.config.rightDisplayNo}if(a.config.textboxValue!=null){a.textboxValue=a.config.textboxValue}if(a.config.promptType!=null){a.promptType=a.config.promptType}a.pageContainer=a.getComponent("pageContainer");a.messageTxt="Please select a page:";if(typeof language!=null&&language.selectPagePrompt!=null){a.messageTxt=language.selectPagePrompt}a.skipAutoRefreshingAdvertsHandler=!InfinityMobile.controller.ReaderController.isNewPWA()},setupPages:function(b){var a=this;a.pageContainer.removeAll();switch(b){case"bookmarks":a.setupBookmarksPages();break;default:a.setupDpsPages(b);break}if(currentProfile=="phone"){a.setHeight("100%");a.setScrollable({direction:"vertical"})}},setupDpsPages:function(c){var a=this;var b="";switch(c){case"share":if(a.config.url!=null){a.url=a.config.url}if(a.config.shareType!=null){a.shareType=a.config.shareType}if(a.config.shareMessage!=null){a.shareMessage=a.config.shareMessage}b="sharePage";break}a.leftPage=Ext.create("InfinityMobile.view.ReaderPageThumbnail",{pageNo:a.leftPageNo,pageIndex:a.leftPageNo,displayNum:a.leftDisplayNo,editionGuid:editionguid,thumbType:"page",toggle:false});a.pageContainer.add(a.leftPage);a.setPageTap(a.leftPage,function(){this.fireEvent(b,a,a.leftPage)});a.rightPage=Ext.create("InfinityMobile.view.ReaderPageThumbnail",{pageNo:a.rightPageNo,displayNum:a.rightDisplayNo,pageIndex:a.rightPageNo,editionGuid:editionguid,thumbType:"page",toggle:false});a.pageContainer.add(a.rightPage);a.setPageTap(a.rightPage,function(){this.fireEvent(b,a,a.rightPage);this.destroy()})},setPageTap:function(c,b){var a=this;if(c!=null){c.element.on({tap:b,scope:a})}},setupBookmarksPages:function(){var b=this;if(!(typeof NEWPWA!="undefined"&&NEWPWA===true)){b.bookmarkName.show()}b.bookmarkAddButton.show();var a="Add";if(typeof language!=null&&language.bookmarks!=null&&language.bookmarks.add!=null){a=language.bookmarks.add}if(b.bookmarkAddButton!=null&&b.bookmarkAddButton.setText!=null&&a!=null){b.bookmarkAddButton.setText(a)}b.placeholderTxt="Name";if(typeof language!=null&&language.bookmarks!=null&&language.bookmarks.name!=null){b.placeholderTxt=language.bookmarks.name}$(b.bookmarkNameValue).attr("placeholder",b.placeholderTxt);b.leftPage=Ext.create("InfinityMobile.view.ReaderBookmarkThumbnail",{pageNo:b.leftPageNo,textboxValue:b.textboxValue,displayNum:b.leftDisplayNo,active:true});b.pageContainer.add(b.leftPage);b.rightPage=Ext.create("InfinityMobile.view.ReaderBookmarkThumbnail",{pageNo:b.rightPageNo,textboxValue:b.textboxValue,displayNum:b.rightDisplayNo,active:false});b.pageContainer.add(b.rightPage);if(b.rightPage.config.active!=null&&b.rightPage.config.active){b.fireEvent("toggleDpsBookmark",b.rightPage)}else{if(b.leftPage.config.active!=null&&b.leftPage.config.active){b.fireEvent("toggleDpsBookmark",b.leftPage)}}},setUpListeners:function(){var a=this;a.bookmarkAddButton.element.on({tap:a.addPressed,scope:a});if(a.bookmarkName!=null&&a.bookmarkNameValue!=null){a.bookmarkName.element.on("tap",function(){a.bookmarkNameValue.focus()})}},setupLanguage:function(){var a=this;if(a.textContainer!=null&&a.messageTxt!=null){a.setText(a.textContainer,a.messageTxt)}},addPressed:function(){var a=this;var b;if(a.leftPage.active){b=a.leftPage}else{if(a.rightPage.active){b=a.rightPage}}a.fireEvent("addToggledBookmark",b,a.bookmarkNameValue.value)},setText:function(b,a){if(b!=null){b.setHtml(a)}}},0,["readerdpsprompt"],["component","container","panel","overlay","readerdpsprompt"],{component:true,container:true,panel:true,overlay:true,readerdpsprompt:true},["widget.readerdpsprompt"],0,[InfinityMobile.view,"ReaderDpsPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderBookmarkThumbnail",Ext.Container,{config:{height:"auto",style:"cursor:pointer",items:[{itemId:"itemLabel",bottom:0,minHeight:30,width:"100%",padding:"5px",style:"background-color:rgba(0,0,0,0.7); color:white; border-radius:5px; padding-left:7px"}]},initialize:function(){var a=this;a.setupVars();a.setupPage();a.setupListeners()},setupVars:function(){var a=this;a.itemLabel=a.getComponent("itemLabel");if(a.config.pageNo!=null){a.pageNo=a.config.pageNo}if(a.config.textboxValue!=null){a.textboxValue=a.config.textboxValue}if(a.config.displayNum!=null){a.displayNum=a.config.displayNum}},setupPage:function(){var a=this;var d="http://edition.pagesuite.com";if(window.location.protocol=="https:"){d="https://"+location.host}imageUrlString=d+"/get_image.aspx?w=280&eid="+editionguid+"&pnum="+a.pageNo+"&lm="+latestLM;a.setHtml("<img style='width:100%' src='"+imageUrlString+"' />");var c="Page";if(language!=null&&language.page!=null){c=language.page}var b=c+" "+a.displayNum;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.justifyText=="right"){b=a.displayNum+" "+c}a.itemLabel.setHtml(b)},setupListeners:function(){var a=this;a.element.on({tap:a.onTap,scope:a})},onTap:function(){var a=this;a.fireEvent("toggleDpsBookmark",a)}},0,["readerbookmarkthumbnail"],["component","container","readerbookmarkthumbnail"],{component:true,container:true,readerbookmarkthumbnail:true},["widget.readerbookmarkthumbnail"],0,[InfinityMobile.view,"ReaderBookmarkThumbnail"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPrintScreen",InfinityMobile.view.Overlay,{config:{fullscreen:true,style:"padding:0px; border-radius:0px;background-color:white;color: #4591B8; font-size:15px",layout:"vbox",zIndex:2147483647,height:"100%",width:"100%",items:[{itemId:"topBar",height:40,style:"background-color:#e6e6e6;",layout:"hbox",items:[{itemId:"backButton",height:"100%",width:"75px",padding:"10 10 10 5",layout:{type:"hbox",align:"center"},items:[{html:"<img src='../assets/download/back-arrow.png' style='height:20px' />",height:20},{width:5},{itemId:"backBtnTxt",html:"Back"}]}]},{itemId:"content",flex:1,cls:"innerhtmlfullheight"}]},initialize:function(){var a=this;a.setupVars();a.setLanguage();a.setEventListeners();a.loadFrame()},setupVars:function(){var a=this;a.topbar=a.getComponent("topBar");if(a.topbar!=null){a.backBtn=a.topbar.getComponent("backButton");if(a.backBtn!=null){a.backBtnTxt=a.backBtn.getComponent("backBtnTxt")}}a.contentArea=a.getComponent("content");if(a.config.printUrl!=null){a.printUrl=a.config.printUrl}a.backTxt="Back";if(typeof language!="undefined"&&language.back!=null){a.backTxt=language.back}},setLanguage:function(){var a=this;if(a.backTxt!=null&&a.backBtnTxt!=null){a.backBtnTxt.setHtml(a.backTxt)}},setEventListener},loadFrame:function(){var b=this;if(b.printUrl!=null&&b.contentArea!=null){var a=b.printUrl;b.contentArea.setHtml("<iframe id='printf' name='printf' src='"+a+"' style='width:100%;height:100%;border:none;' scrolling='no'/>");printMe=function(c){b.fireEvent("printIframe",c)}}}},0,["printscreen"],["component","container","panel","overlay","printscreen"],{component:true,container:true,panel:true,overlay:true,printscreen:true},["widget.printscreen"],0,[InfinityMobile.view,"ReaderPrintScreen"],0));(Ext.cmd.derive("InfinityMobile.view.CustomCheckbox",Ext.Container,{config:{checked:false,height:30,width:30,html:'<i class="fa fa-check" aria-hidden="true"></i>',style:"font-size:25px;"},initializ},isChecked:function(){return this.checked},check:function(){this.checked=true;this.addCls("checkbox-checked")},unchec}},0,["customcheckbox"],["component","container","customcheckbox"],{component:true,container:true,customcheckbox:true},["widget.customcheckbox"],0,[InfinityMobile.view,"CustomCheckbox"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSearchLoadingMask",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,layout:"vbox",width:280,height:300,style:"background-color: rgba(0, 0, 0, 0.6)",items:[{padding:"90px 0 0 0"},{itemId:"loadingContainer",style:"background-color: rgba(0, 0, 0, 0) !important",xtype:"container",layout:{pack:"center",align:"middle",type:"hbox"},items:[{itemid:"loadingSpinner",html:['<div class="x-loading-spinner">','<span class="x-loading-top"></span>','<span class="x-loading-right"></span>','<span class="x-loading-bottom"></span>','<span class="x-loading-left"></span>',"</div>"].join("")}]},{padding:"20px 0 0 0"},{itemId:"textContainer",html:"Searching",margin:"auto",style:"color: white; text-align: center",padding:"0 0 50px 0"},{itemId:"cancelButton",xtype:"readeroverlaybutton",html:"Cancel",txt:"",margin:"auto",hidden:true,style:"text-align: center"}]},initialize:function(){var a=this;a.setupVars();a.setupLanguage()},setupVars:function(){var a=this;a.cancelButton=a.getComponent("cancelButton");if(a.config.cancelClick!=null){a.cancelClick=a.config.cancelClick}a.cancelButton.setTap(a.cancelClick);a.cancelButton.show()},setupLanguage:function(){var d=this;var b="Searching";if(language.search!=null&&language.search.searching!=null){b=language.search.searching}var a=d.getComponent("textContainer");d.setText(a,b);var c="Cancel";if(language.cancel!=null){c=language.cancel}d.setText(d.cancelButton,c)},setText:function(b,a){if(b!=null){b.setHtml(a)}}},0,0,["component","container"],{component:true,container:true},0,0,[InfinityMobile.view,"ReaderSearchLoadingMask"],0));(Ext.cmd.derive("InfinityMobile.view.Advert",Ext.Container,{config:{style:"text-align:center"},initialize:function(){var a=this;console.log(a);if(a.config.advert!=null){a.advert=a.config.advert;a.on("painted",a.loadAdvert,a,{delay:10,single:true})}},loadAdvert:function(){var a=this;switch(a.advert.type){case"dfp":a.loadDFPAdvert();break;case"url":a.loadUrlAdvert();break;case"image":a.loadImageAdvert();break}},loadDFPAdvert:function(){var a=this;a.getDFPDimensions();a.dfpid=a.id+"dfp";a.setHtml("<div id='"+a.dfpid+"' class='dfpDiv' ></div>");googletag.cmd.push(function(){a.adslot=googletag.defineSlot("/"+a.advert.networkCode+"/"+a.advert.adUnit,[parseInt(a.advert.width),parseInt(a.advert.height)],a.dfpid).addService(googletag.pubads().collapseEmptyDivs());a.adslot.addService(googletag.pubads().updateCorrelator());if(a.advert.targeting!=null&&a.advert.targeting.length>0){var b=a.advert.targeting.split("|");for(var d in b){var e=b[d];var c=e.split("*");if(c!=null&&c.length>=2){c[1]=c[1].replace("{{PAGE}}",a.pageNumber).replace("{{SECTION}}",a.section);a.adslot.setTargeting(c[0],c[1])}}}googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.dfpid)})},getDFPDimensions:function(){var a=this;if(a.advert.width==null&&a.advert.height==null){switch(a.advert.dfpType){case"banner":default:if(currentProfile=="phone"||(a.advert.usePhoneBanner!=null&&(a.advert.usePhoneBanner==true||a.advert.usePhoneBanner=="true"))){a.advert.width=320;a.advert.height=50}else{a.advert.width=728;a.advert.height=90}break;case"mpu":a.advert.width=300;a.advert.height=250;break}}},loadUrlAdvert:function(){var a=this;a.setHtml("<img src='"+a.advert.url+"' />");a.element.on("tap})},loadImageAdvert:function(){var a=this;a.setHtml("<iframe style='border:none;' scrolling='no' src='"+a.advert.url+"' />")},destroy:function(){var a=this;if(a.adslot!=null){googletag.destroySlots([a.adslot])}Ext.Container.prototype.destroy.apply(this,arguments)}},0,["advertview"],["component","container","advertview"],{component:true,container:true,advertview:true},["widget.advertview"],0,[InfinityMobile.view,"Advert"],0));(Ext.cmd.derive("InfinityMobile.view.ConsentField",Ext.Container,{config:{width:"100%",layout:"hbox",margin:"20px 0px",blocksSubscription:false,items:[{itemId:"checkbox",width:20,html:"<input type='checkbox'/>"},{itemId:"label",flex:1}]},initialize:function(){this.setupVars();this.setupText();var a=function(){this.focus()};this.checkboxArea.element.on({tap:a})},setupVars:function(){var a=this;if(a.config.consentItem!=null){a.consentItem=a.config.consentItem}if(a.config.blocksSubscription!=null){a.blocksSubscription=a.config.blocksSubscription}a.checkboxArea=a.getComponent("checkbox");a.checkbox=a.checkboxArea.element.down("input").dom;a.labelItem=a.getComponent("label")},setupText:function(){var a=this;if(a.consentItem!=null){var b=a.consentItem.blurb;if(a.consentItem.blocksSubscription){b+="*";a.blocksSubscription=true}a.labelItem.setHtml(b)}}},0,["consentfield"],["component","container","consentfield"],{component:true,container:true,consentfield:true},["widget.consentfield"],0,[InfinityMobile.view,"ConsentField"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderWebpopoverObject",InfinityMobile.view.ReaderMediaObject,{config:{cls:"pointerCursor"},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.on({tap:a.onTap,scope:a})},onTa}},0,["readerwebpopoverobject"],["component","container","readermediaobject","readerwebpopoverobject"],{component:true,container:true,readermediaobject:true,readerwebpopoverobject:true},["widget.readerwebpopoverobject"],0,[InfinityMobile.view,"ReaderWebpopoverObject"],0));(Ext.cmd.derive("InfinityMobile.view.PageTab",Ext.Panel,{config:{xtype:"label",width:"100%",cls:"pageTab pointerCursor",margin:"0 0 5px 0",zIndex:1e+21,items:[{itemId:"rollout",height:"100%",width:0,left:0,padding:5,style:"transition: 1s ease all;overflow:hidden;",layout:{type:"vbox"},zIndex:5,items:[{itemId:"rolloutTitle",width:"100%",style:"white-space:nowrap;font-size:18px;"},{itemId:"rolloutDesc",width:"100%",style:"white-space:nowrap: font-size: 14px;"}]},{zIndex:8,xtype:"label",itemId:"titleArea"}]},initialize:function(){var a=this;a.setupVars();a.setupAppearance();a.setupBehaviour()},setupVars:function(){var a=this;if(a.config.bgColour!=null){a.bgColour=a.config.bgColour}if(a.config.textColour!=null){a.textColour=a.config.textColour}if(a.config.pageNo!=null){a.pageNo=a.config.pageNo}if(a.config.type!=null){a.type=a.config.type}if(a.config.title!=null){a.title=a.config.title}if(a.config.rolloutTitle!=null){a.rolloutTitle=a.config.rolloutTitle}if(a.config.rolloutDesc!=null){a.rolloutDesc=a.config.rolloutDesc}if(a.config.rolloutType!=null){a.rolloutType=a.config.rolloutType}if(a.config.rolloutTarget!=null){a.rolloutTarget=a.config.rolloutTarget}if(a.config.side!=null){a.side=a.config.side}a.titleArea=a.getComponent("titleArea");a.rollout=a.getComponent("rollout");if(a.rollout!=null){a.rolloutTitleComp=a.rollout.getComponent("rolloutTitle");a.rolloutDescComp=a.rollout.getComponent("rolloutDesc")}},setupAppearance:function(){var a=this;a.setStyle({backgroundColor:a.bgColour.indexOf("#")==0?a.bgColour:"#"+a.bgColour,color:a.textColour.indexOf("#")==0?a.textColour:"#"+a.textColour});a.rollout.setStyle({backgroundColor:a.bgColour.indexOf("#")==0?a.bgColour:"#"+a.bgColour});if(a.side=="left"){a.rollout.setLeft(40)}a.setTitleText(a.title);a.setRolloutTitle(a.rolloutTitle);a.setRolloutDesc(a.rolloutDesc)},setTitleText:function(d){var b=this;if(b.titleArea!=null){var a=b.side=="left"?"anti-clockwise-rotate":"clockwise-rotate";var c='<div class="wrapper-outer"><div class="wrapper-inner"><div class="pageTabInner '+a+'">'+d+"</div></div></div>";b.titleArea.setHtml(c)}},setRolloutTitle:function(b){var a=this;if(a.rolloutTitleComp!=null){a.rolloutTitleComp.setHtml(b)}},setRolloutDesc:function(b){var a=this;if(a.rolloutDescComp!=null){a.rolloutDescComp.setHtml(b)}},setupBehaviour:function(){var a=this;a.element.on("tap",function(){if(a.type=="standard"){var b=Math.min(a.pageNo,flatPlanData.pageGroups.length);if(typeof flatPlanData!="undefined"&&flatPlanData.frontOffset!=null){b=Math.min(b+flatPlanData.frontOffset,flatPlanData.pageGroups.length)}mainPanel.fireEvent("pagejump",parseInt(b)-1)}else{if(a.type=="rollout"){a.toggleRollout()}}});a.rollout.element.on("tap",function(c){if(a.rolloutType!=null){switch(a.rolloutType.toLowerCase()){case"page":var b=Math.min(a.rolloutTarget,flatPlanData.pageGroups.length);if(typeof flatPlanData!="undefined"&&flatPlanData.frontOffset!=null){b=Math.min(b+flatPlanData.frontOffset,flatPlanData.pageGroups.length)}mainPanel.fireEvent("pagejump",parseInt(b)-1);break;case"url":window.open(a.rolloutTarget);break;case"email":window.open("mailto://"+a.rolloutTarget,"_self");break}}})},toggleRollout:function(){var b=this;if(b.rollout.getWidth()==0){var a=200;b.rollout.setWidth(a);if(b.side=="right"){b.rollout.setLeft(-a)}}else{var a=0;b.rollout.setWidth(a);if(b.side=="right"){b.rollout.setLeft(a)}}}},0,["pagetab"],["component","container","panel","pagetab"],{component:true,container:true,panel:true,pagetab:true},["widget.pagetab"],0,[InfinityMobile.view,"PageTab"],0));(Ext.cmd.derive("InfinityMobile.view.PageTabContainer",Ext.Container,{config:{height:"100%",width:40,cls:"page-tab-container",zIndex:1e+21,scrollable:{direction:"vertical",indicators:false}},initialize:function(){var a=this;a.setupVars();a.setupListeners()},setupVars:function(){var a=this;var b=a.getScrollable();if(b!=null){a.scroller=b.getScroller()}},setupListeners:function(){var b=this;var a=function(h){var g=h.deltaY>0||h.detail>0?"down":"up";var j=20;if(g=="down"){var f=b.scroller.position.y+j;var c=b.scroller.maxPosition.y;b.scroller.scrollTo(0,Math.min(f,c))}else{var f=b.scroller.position.y-j;var d=b.scroller.minPosition.y;b.scroller.scrollTo(0,Math.max(f,d))}};b.element.dom.addEventListener("mousewheel",a);b.element.dom.addEventListener("DOMMouseScroll",a)}},0,["pagetabcontainer"],["component","container","pagetabcontainer"],{component:true,container:true,pagetabcontainer:true},["widget.pagetabcontainer"],0,[InfinityMobile.view,"PageTabContainer"],0));(Ext.cmd.derive("InfinityMobile.view.AdvertPageViewer",Ext.Panel,{config:{height:"100%",width:"100%",pageNo:"",items:[{itemId:"advert"}]},statics:{isCustomAd:null,hasCustomAdSetting:function(){try{if(typeof InfinityMobile.view.AdvertPageViewer.isCustomAd==="boolean"){return InfinityMobile.view.AdvertPageViewer.isCustomAd}if(settings.reader.interstitialPageFlow!=null){var b="type" in settings.reader.interstitialPageFlow&&!!settings.reader.interstitialPageFlow.type?settings.reader.interstitialPageFlow.type:"";return b.indexOf("custom|")>=0}}catch(a){console.warn("[AdvertPageViewer]: Error Caught",a)}return false}},beforeInitializ},initialize:function(){var a=this;if(a.statics().isCustomAd===null){a.statics().isCustomAd=a.statics().hasCustomAdSetting()}this.setupVars();this.setAdvertHtml(this.advertType)},setupVars:function(){var a=this;a.advertId=this.id+"advert";if(a.config.advertType!=null){a.advertType=a.config.advertType}if(a.config.networkCode!=null){a.networkCode=a.config.networkCode}if(a.config.adUnit!=null){a.adUnit=a.config.adUnit}if(a.config.advertSize!=null){a.advertSize=a.config.advertSize.split(",")}if(a.config.adUrl!=null){a.adUrl=a.config.adUrl}if(a.config.adLink!=null){a.adLink=a.config.adLink}if(a.config.targeting!=null){a.targeting=a.config.targeting}if(a.config.section!=null){a.section=a.config.section}a.advertComponent=a.getComponent("advert");a.scale=1;a.mappedPageNumber=flatPlanData.reversePageMapper[this.getPageNo()]},setAdvertHtml:function(a){var b=this;if(!b.statics().isCustomAd){switch(a){case"dfp":b.setupDfpAdvert();break;case"image":b.setupImageAdvert();break;case"url":b.setupUrlAdvert();break}}b.hasHtmlSetup=true},setCommonHtml:function(){var b=this;var a="<div id='"+b.advertId+"-placeholder' class='not-rendered-advert empty-advert-placeholder'><div class='empty-advert-text-container'><div class='empty-advert-text-wrapper'><div class='empty-advert-text'>"+(typeof language=="object"&&"advertisement" in language&&!!language.advertisement?language.advertisement:"Advertisement")+"</div></div></div></div>";b.advertComponent.setHtml("<div id='"+b.advertId+"' class='page-flow-advert'></div>"+a);b.hasHtmlSetup=true},isCustomAd:function(){var a=this;return a.statics().hasCustomAdSetting()},getCustomAdMetaData:function(){var c=this;var a={className:null,configUrl:""};if(c.statics().isCustomAd){var b=settings.reader.interstitialPageFlow.type.split("|");a.className=b[1];a.configUrl=b[2]}return a},setupCustomAd:function(){var a=this;a.setCommonHtml();if(a.statics().isCustomAd){if(a.customAd==null&&!a.isLoadingCustomAdConfig){var c=a.getCustomAdMetaData();var b=function(){a.customAd=new window[c.className](a.id+"in-flow-ad",a.element.down("#"+a.advertId).dom,currentProfile,settings.reader.interstitialPageFlow.config);a.customAd.loadAdvert(a.mappedPageNumber,a.section);a.element.down("#"+a.advertId+"-placeholder").dom.className="empty-advert-placeholder";a.resizeAdvert();a.setDfpTouchEventListeners()};if(settings.reader.interstitialPageFlow.config==null){a.isLoadingCustomAdConfig=true;a.customAdConfigAjaxRequest=$.ajax({url:c.configUrl+(c.configUrl.indexOf("?")>=0?"&lm=":"?lm=")+latestLM,success:function(d){a.hasConfig=true;a.isLoadingCustomAdConfig=false;console.log(d);settings.reader.interstitialPageFlow.config=d;b()}})}else{b()}}else{if(this.customAd!=null){this.customAd.refreshAdvert(a.mappedPageNumber,a.section)}}}},enableCustomAdRefresh:function(){var a=this;if(a.statics().isCustomAd&&a.customAd!=null){a.customAd.enableRefreshAdvert()}},disableCustomAdRefresh:function(){var a=this;if(a.statics().isCustomAd&&a.customAd!=null){a.customAd.disableRefreshAdvert()}},setupDfpAdvert:function(){var b=this;var a="<div id='"+b.advertId+"-placeholder' class='not-rendered-advert empty-advert-placeholder'><div class='empty-advert-text-container'><div class='empty-advert-text-wrapper'><div class='empty-advert-text'>"+(typeof language=="object"&&"advertisement" in language&&!!language.advertisement?language.advertisement:"Advertisement")+"</div></div></div></div>";b.advertComponent.setHtml("<div id='"+b.advertId+"' class='page-flow-advert'></div>"+a);if(typeof googletag!="undefined"&&googletag!=null&&googletag.pubads!=null){googletag.pubads().addEventListener("slotRenderEnded",function(c){if(!c.isEmpty){if(b.adslot==c.slot){document.querySelector("#"+b.advertId+"-placeholder").className="empty-advert-placeholder";b.resizeAdvert();b.setDfpTouchEventListeners()}}else{if(b.adslot==c.slot){b.setDfpTouchEventListeners()}}})}else{}},setupDfpTargetting:function(){},setupUrlAdvert:function(){var a=this;a.on("painted",function(){a.advertComponent.setHeight("100%");a.advertComponent.setWidth("100%");var b=a.advertComponent.element.dom.getElementsByClassName("x-innerhtml")[0];if(b!=null){b.style.height="100%";b.style.width="100%";if(Ext.os.is.iOS){b.style.overflow="hidden";b.style.position="relative"}}});a.advertComponent.setHtml("<iframe id='"+a.advertId+"' class='page-flow-advert' style='position:relative;width:100%; height:100%;border:none;overflow:none;' src='"+a.adUrl+"'></iframe>")},setupImageAdvert:function(){var a=this;a.on("painted});a.advertComponent.setHtml("<div id='"+a.advertId+"' class='page-flow-advert' style='position:relative;width:100%; height:100%;cursor: pointer;background:url(\""+a.adUrl+"\");background-size:contain;background-repeat:no-repeat;background-position:center;'></div>");a.advertComponent.element.on("tap",function(){window.open(a.adLink,"_blank");mainPanel.fireEvent("trackAdvertClick","inFlow")})},loadAdvert:function(){var a=this;if(a.statics().isCustomAd){a.setupCustomAd()}else{switch(a.advertType){case"dfp":a.loadDfpAdvert();break;case"image":case"url":break}}},loadDfpAdvert:function(){var a=this;if(googletag!=null){if(a.hasLoaded){googletag.pubads().refresh([a.adslot])}else{googletag.cmd.push(function(){a.adslot=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt(a.advertSize[0]),parseInt(a.advertSize[1])],a.advertId).addService(googletag.pubads().updateCorrelator());if(a.targeting!=null&&a.targeting.length>0){var b=a.targeting.split("|");for(var d in b){var e=b[d];var c=e.split("*");if(c!=null&&c.length>=2){c[1]=c[1].replace("{{PAGE}}",a.pageNumber).replace("{{SECTION}}",a.section);a.adslot.setTargeting(c[0],c[1])}}}googletag.enableServices();googletag.display(a.advertId);a.hasLoaded=true})}}},refreshAdvert:function(){},pageResize:function(){var a=this;a.resizeAdvert()},onResize:function(){var a=this;a.resizeAdvert()},resizeAdvert:function(){var g=this;var j=g.advertComponent.element.dom.clientHeight;var a=g.advertComponent.element.dom.clientWidth;var h=g.element.dom.clientHeight;var e=g.element.dom.clientWidth;var c=g.getScale(j,h);var d=g.getScale(a,e);try{var b=g.returnTranslate(c,d);c>d?g.applyTransform(d,b):g.applyTransform(c,b)}catch(f){console.warn("[AdvertPageViewer]: Error Caught",f)}},returnTranslate:function(a,b){var q=this;var s=a>b?b:a;var d=a>b?"width":"height";var j=q.advertComponent.element.dom;var h=q.element.dom;var g=0;var e=0;if(q.statics().isCustomAd&&q.customAd!=null&&q.customAd._slot!=null&&!!q.customAd._slot.width&&!!q.customAd._slot.height){q.advertSize=q.advertSize||[];if(q.advertSize.length===2){if(q.advertSize[0]!==q.customAd._slot.width){q.advertSize[0]=q.customAd._slot.width}if(q.advertSize[1]!==q.customAd._slot.height){q.advertSize[1]=q.customAd._slot.height}}else{q.advertSize[0]=q.customAd._slot.width;q.advertSize[1]=q.customAd._slot.height}}if((s*j.clientWidth)<h.clientWidth&&(!!q.advertSize&&q.advertSize[1]>h.clientHeight)){var f=h.clientWidth;var m=(q.advertSize[0]*a);var p=(f-m)/2;var l=Math.max(0,(f-q.advertSize[0]))/2;g=p-l}if((s*j.clientHeight)<h.clientHeight&&(!!q.advertSize&&q.advertSize[0]>h.clientWidth)){var n=h.clientHeight;var r=(q.advertSize[1]*s);var o=(n-r)/2;var c=Ext.browser.is.IE?q.advertComponent.element.dom.offsetTop:0;var k=(Math.max(0,(n-q.advertSize[1]))/2)+c;e=o-k}else{if(Ext.browser.is.IE){e=(s*j.clientHeight)<h.clientHeight?0:Math.abs(q.advertComponent.element.dom.offsetTop)}}return"translate3d("+g+"px, "+e+"px, 0)"},getScal},applyTransfor},setDfpTouchEventListener},dragStar},dra},dragEn},getPageN},toggleZoomMode:function(){},toggleDPS:function(){},toggleDPSNonActive:function(){},completeImageLoaded:function(){},completePDFLoaded:function(){},stopTiling:function(){},destroy:function(){var a=this;if(a.statics().isCustomAd&&a.customAd!=null){a.customAd.destroyAdvert()}else{if(typeof googletag!="undefined"&&typeof googletag.destroySlots==="function"){googletag.destroySlots([this.adslot])}}Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["readeradvertpageviewer"],["component","container","panel","readeradvertpageviewer"],{component:true,container:true,panel:true,readeradvertpageviewer:true},["widget.readeradvertpageviewer"],0,[InfinityMobile.view,"AdvertPageViewer"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuArticleItem",Ext.Container,{config:{height:"100px",style:"overflow: hidden; border-bottom: 1px solid grey; cursor: pointer; font-size: 20px;",padding:"10px 20px",layout:"hbox",items:[{itemId:"image",width:120,height:"100%",style:"background-color: #2f2f2f; background-position: center; background-repeat: no-repeat;"},{itemId:"text",flex:1,margin:"0 0 0 10px",layout:"vbox",style:"overflow: hidden;",items:[{itemId:"headline",cls:"menu-article-headline",style:"font-size: 0.9em; line-height: 19px;",width:"100%"}]}]},initializ},setupVars:function(){this.articleMedia=this.config.articleMedia!=null?this.config.articleMedia:this.articleMedia;this.image=this.getComponent("image");this.textView=this.getComponent("text");this.headlineText=this.textView.getComponent("headline");this.articleObject=this.config.articleObject!=null?this.config.articleObject:this.articleObject;this.sectionName=this.config.sectionName!=null?this.config.sectionName:this.sectionName;this.menu=this.config.menu!=null?this.config.menu:this.menu},setImage:function(){var a=settings.topbar.logo;if(this.articleObject!=null&&this.articleObject.images!=null&&this.articleObject.images.length>0){a=this.articleObject.images[0].url;$(this.image.element.dom).css("background-size","cover")}else{$(this.image.element.dom).css("background-size","60%")}this.image.element.dom.style.backgroundImage='url("'+a+'")'},setupText:function(){var a=this.articleObject.headline!=null&&this.articleObject.headline.trim()!=""?this.articleObject.headline:this.articleObject.shortStory;this.headlineText.setHtml(a)},setupEventListeners:function(){var a=this;this.articleMedia.config=this.articleMedia.config==null?{}:this.articleMedia.config;this.articleMedia.config.articleIndex=this.articleMedia.uniquearticleindex;this.element.on("tap",function(){a.fireEvent("articleClick",a.articleMedia,a.articleMedia.file);a.menu.fireEvent("close",a.menu)})}},0,["readermenuarticleitem"],["component","container","readermenuarticleitem"],{component:true,container:true,readermenuarticleitem:true},["widget.readermenuarticleitem"],0,[InfinityMobile.view,"ReaderMenuArticleItem"],0));(Ext.cmd.derive("InfinityMobile.view.ShareSliderItem",Ext.Container,{config:{height:50,width:50,cls:"share-slider-button pointerCursor",style:"background-color: rgb(237, 237, 237); border-radius: 50%;"},initializ},setupVar},setupIcon:function(){var k=this;var a=k.shareObj.icon;var b="000000";if(currentProfile=="desktop"){var l=25;var f=30;var e={x:0,y:0};var h=this.uuidv4();var d="";try{var c=this.getBrowser()}catch(g){var c}if(c!=null&&c.name=="Safari"&&parseFloat(c.version)<12){if(typeof hexToRgb!="undefined"){var j=hexToRgb(b);d='<div class="imagemask" style="width: '+f+"px; height: "+l+"px; -webkit-mask-size: contain; mask-size: contain; -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat; -webkit-mask-position: center; mask-position: center; cursor: pointer; background-color: rgb("+j+"); -webkit-mask-image: url('"+a+"'); -o-mask-image: url('"+a+"'); -moz-mask-image: url('"+a+"'); mask-image: url('"+a+"'); \" ></div>"}}else{if(typeof hexToRgb!="undefined"){var j=hexToRgb(b);splitColour=j.split(",");var m=this.setMatrixString(parseInt(splitColour[0]),parseInt(splitColour[1]),parseInt(splitColour[2]));d='<div class="imagesvg" style=\'width: 30px; height: 30px;\' ><svg width="'+f+'" height= "'+l+'" viewBox="'+e.x+" "+e.y+" "+f+" "+l+'"><defs><filter id="filter'+h+'"><feColorMatrix id="gray" type="matrix" color-interpolation-filters="sRGB" values="'+m+'" /></filter></defs ><image x="0" y="0" width="'+f+'" height="'+l+'" filter="url(#filter'+h+')" href="'+a+'" /></svg ></div >'}}this.setHtml(d)}else{var l=this.config.iconHeight!=null?this.config.iconHeight:23;var f=this.config.iconWidth!=null?this.config.iconWidth:this.setting=="doublepageicon"?46:23;var e={x:0,y:0};var h=this.uuidv4();var d="";if(typeof hexToRgb!="undefined"){var j=hexToRgb(b);d='<div class="imagemask" style="width: '+f+"px; height: "+l+"px; -webkit-mask-size: contain; mask-size: contain; -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat; -webkit-mask-position: center; mask-position: center; cursor: pointer; background-color: rgb("+j+"); -webkit-mask-image: url('"+a+"'); -o-mask-image: url('"+a+"'); -moz-mask-image: url('"+a+"'); mask-image: url('"+a+"'); \" ></div>"}this.setHtml(d)}},getBrowser:function(){var b=navigator.userAgent,a,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(c[1])){a=/\brv[ :]+(\d+)/g.exec(b)||[];return{name:"IE",version:(a[1]||"")}}if(c[1]==="Chrome"){a=b.match(/\bOPR|Edge\/(\d+)/);if(a!=null){return{name:"Opera",version:a[1]}}}c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"];if((a=b.match(/version\/(\d+)/i))!=null){c.splice(1,1,a[1])}return{name:c[0],version:c[1]}},setMatrixString:function(d,c,a){return"0 0 0 0 "+(d/255)+" 0 0 0 0 "+(c/255)+" 0 0 0 0 "+(a/255)+" 0 0 0 1 0"},uuidv},setupEvents:function(){var a=this;a.element.on({tap:function(){console.log(a.shareObj);a.share()},scope:a})},share:function(){var b=this;var a=b.shareObj;b.fireEvent("shareFullscreenArticle",a,b.type)}},0,["shareslideritem"],["component","container","shareslideritem"],{component:true,container:true,shareslideritem:true},["widget.shareslideritem"],0,[InfinityMobile.view,"ShareSliderItem"],0));(Ext.cmd.derive("InfinityMobile.view.FullscreenArticlePopoverItem",Ext.Container,{config:{height:"100%",width:"100%",cls:"fullscreen-article-popover-item",items:[{itemId:"contentArea",cls:"fullscreen-article-popover-item-content",height:"100%",width:"100%",style:"text-align:center;"}]},initializ},setupVars:function(){var a=this;a.hasSetupContent=false;a.contentArea=a.getComponent("contentArea");if(a.config.articleItem!=null){a.articleItem=a.config.articleItem}if(a.config.pageNo!=null){a.pageNo=a.config.pageNo}if(a.config.popoverContainer!=null){a.popoverContainer=a.config.popoverContainer}},getContent:function(){var a=this;$.ajax({delay:10,url:a.articleItem.url+"&lm="+latestLM,success:function(c){var b="display: inline-block; -webkit-overflow-scrolling: touch; height: 100%; width:100%; position:relative;";if(Ext.os.is.iOS){b+="overflow-y: auto;"}else{b+="overflow: hidden"}a.contentArea.setHtml("<div class='iframe-wrapper' style='"+b+"'><iframe style='height: 100%;; width: 100%;border: none' id='"+a.id+"iframe'></iframe></div>");a.data=c;if(a.parent!=null&&a.parent.getActiveItem()==a){a.writeIframeContent()}}})},writeIframeContent:function(){var c=this;if(c.data!=null){var b=c.replacePlaceHolder(c.data.body);var a=c.iframe=document.getElementById(c.id+"iframe");if(a!=null){a.contentDocument.write(b);var d=c.popoverContainer.getTextSliderSize();setTimeout(function(){try{if(d!=null&&a.contentWindow!=null&&typeof a.contentWindow.resizeText=="function"){a.contentWindow.resizeText(d)}}catch(e){console.error("[FullscreenArticlePopoverItem]: Error Caught\n",e)}});c.setupTouchListeners();if(c.trackOnWrite){c.popoverContainer.trackPageChange(c);c.trackOnWrite=false}c.hasSetupContent=true;return true}}return false},replacePlaceHolder:function(a){a=a.replace("{{{Device.Dark}}}","");a=a.replace("{{{Device.Type}}}",currentProfile);return a},setTextSize:function(d){var c=this;var a=document.getElementById(c.id+"iframe");if(a!=null&&a.contentWindow!=null){try{if(typeof a.contentWindow.resizeText=="function"){a.contentWindow.resizeText(d)}}catch(b){console.error("caught: ",b)}}},setupTouchListeners:function(){var d=this;var a=document.getElementById(d.id+"iframe");if(a!=null){var c=a;var b=c.contentDocument||c.contentWindow.document;b.addEventListener("touchstart",function(f){d.frameTouchStart(f)});b.addEventListener("touchmove});b.addEventListener("touchend",function(f){d.frameTouchEnd(f)});b.onkeydown=function(g){try{if(d.parent!=null){switch(g.keyCode){case 37:d.parent.previous();break;case 39:d.parent.next();break}}}catch(f){console.error("[FullscreenArticlePopoverItem]: Error Caught \n",f)}}}},frameTouchStar},frameTouchMove:function(b){var a=this;a.articleCarousel.carouselDrag(b)},frameTouchEn},returnArticleCarouse},printIframe:function(){var c=this;var a=document.getElementById(c.id+"iframe");if(a!=null){var b=a;if(b.contentWindow!=null){b.contentWindow.document.close();b.contentWindow.focus();b.contentWindow.print()}}}},0,["readerarticlepopoveritem"],["component","container","readerarticlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true},["widget.readerarticlepopoveritem"],0,[InfinityMobile.view,"FullscreenArticlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.ArchiveTabSelector",Ext.Container,{config:{id:"archiveTabSelector",cls:"tabSelector",items:[{itemId:"selectorWrapper",layout:{type:"vbox",align:"middle",pack:"center"},style:"width: 100%; height: 40px; font-weight: bold;",items:[{itemId:"selectorContainer",layout:{type:"hbox",align:"middle",pack:"center"},style:"width: auto; height: auto; background-color: #eeeeef; border-radius: 7px;"}]}]},initialize:function(){var a=this;if(a.config.startName!=null){a.startName=a.config.startName}a.setupVars();a.setupTabItems()},setupVars:function(){var a=this;a.selectorContainer=a.getComponent("selectorWrapper").getComponent("selectorContainer")},setupTabItems:function(){var c=this;c.tabItems=[];if(settings.menu.hideArchive==null||settings.menu.hideArchive=="false"){c.tabItems.push({name:"Archive",archive:"mainArchive",pubid:null})}if(settings.newsday!=null&&settings.newsday.specialArchive!=null){c.tabItems.push({name:settings.newsday.specialArchive.name,archive:"specialArchive",pubid:null})}if(settings.menu!=null&&settings.menu.extraArchives!=null){for(var a=0;a<settings.menu.extraArchives.length;a++){var b=settings.menu.extraArchives[a];c.tabItems.push({name:b.name,archive:"extraArchive",pubid:b.pubid})}}c.createTabButtons()},createTabButtons:function(){var d=this;var a=d.tabItems;d.tabButtons=[];for(var b=0;b<a.length;b++){var c=a[b];var f=d.createTabButton(c,b);if(c.name===d.startName){f.addCls("selected-tab")}d.selectorContainer.add(f);if(b!=a.length-1){var e=Ext.create("Ext.Container",{html:"<hr style='width: 1px; height: 12px; margin: 0px; border: none; background-color: lightgrey'>"});d.selectorContainer.add(e)}}},createTabButton:function(c,a){var b=this;var d=Ext.create("Ext.Container",{html:'<div data-index="'+a+'">'+c.name+"</div>",style:"font-size: 0.7em; margin: 2px; padding: 5px; cursor: pointer;",index:a,pubid:c.pubid,text:c.name});d.element.on({tap:function(){var e=d.index;if(d.config.index!=null){e=d.config.index}b.itemTap(e)},scope:b});b.tabButtons.push(d);return d},itemTap:function(a){var b=this;mainPanel.fireEvent(b.tabItems[a].archive,b.tabButtons[a],"")}},0,["archivetabselector"],["component","container","archivetabselector"],{component:true,container:true,archivetabselector:true},["widget.archivetabselector"],0,[InfinityMobile.view,"ArchiveTabSelector"],0));(Ext.cmd.derive("InfinityMobile.view.UserInactivityPrompt",InfinityMobile.view.Overlay,{config:{layout:"vbox",width:300,hideOnMaskTap:false,zIndex:1000002,style:"padding:50px 30px;max-height:100%; border-radius: 5%; background-color: #ffffff; box-shadow: none;",items:[{itemId:"icon",html:"?",width:40,height:40,style:"background-color: #000000; color: #ffffff; padding: 10px; border-radius: 100%; text-align: center; margin: 0 auto; line-height: 40px;"},{itemId:"titleText",style:"font-weight:bold; font-size:14px; text-align: center; padding-top: 12px;"},{itemId:"descriptionText",style:"font-size:12px; text-align: center; padding-top: 17px;"},{itemId:"yesButton",xtype:"readeroverlaybutton",margin:"27px auto auto auto",width:"100%",style:"background-color: #009EEF; color: #fffffF; border-radius: 10px 0px 10px 0px;font-size: 12px;"}]},initialize:function(){var b=this;b.icon=b.getComponent("icon");b.titleText=b.getComponent("titleText");b.titleText.setHtml(InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptText.title);b.descriptionText=b.getComponent("descriptionText");b.descriptionText.setHtml(InfinityMobile.view.Reader.userInactivityTimeout.setting.inactivityPromptText.description);b.yesButton=b.getComponent("yesButton");if(InfinityMobile.controller.ReaderController.isNewPWA()){var a="pwaBrandColour" in settings.reader&&!!settings.reader.pwaBrandColour?"#"+settings.reader.pwaBrandColour:"#009EEF";b.yesButton.setupAppearance(a,"#ffffff")}b.yesButton.setText(typeof language=="object"&&"yes" in language&&!!language.yes?language.yes:"Yes");b.setEventListeners()},setEventListener},yes:function(){var a=this;mainPanel.fireEvent(InfinityMobile.view.Reader.userInactivityTimeout.customEvents.resetObserver);a.destroy()}},0,["userinactivityprompt"],["component","container","panel","overlay","userinactivityprompt"],{component:true,container:true,panel:true,overlay:true,userinactivityprompt:true},["widget.userinactivityprompt"],0,[InfinityMobile.view,"UserInactivityPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArticlePageThumbnail",Ext.Container,{config:{pageNumber:null,articleMediaObject:null,mediaObjectsOnPageForAnArticle:[],mediaObjectsFromAllPagesForAnArticle:[],itemIdsOfHotspots:[],additionalCss:null,editionGuid:null,cls:"reader-article-page-thumbnail",maxWidth:"100%",width:"185px",zIndex:9999999,style:"background-color: rgb(255, 255, 255); box-shadow: 1px 1px 3px 0px rgb(191, 191, 191); border-radius: 3px; cursor: pointer; overflow: hidden; ",items:[{itemId:"imageContainer",width:"100%",style:"position: relative; min-height: 200px; border: 0; transition: opacity .5s linear;",layout:"vbox",items:[{itemId:"pageImg",style:"box-shadow: 1px 0px 5px rgb(191, 191, 191);",width:"100%",height:"auto",mode:null}]},{itemId:"pageTitle",minHeight:"2em",style:"font-size: 0.7em; font-weight: bold; line-height: 2em; padding-left: 0.8em; padding-right: 1em; margin: 0.7em 0 0.5em",html:"No Page"}]},initialize:function(){var a=this;a.imageContainerCmp=a.getComponent("imageContainer");a.hotspotCmp=a.imageContainerCmp.getComponent("hotspot");a.pageImgCmp=a.imageContainerCmp.getComponent("pageImg");a.pageTitleCmp=a.getComponent("pageTitle");a.applyAdditionalCss();a.applyAdditionalCssClasses();a.initializePageImageCmp();a.element.on({singletap:"onTap",scope:a})},applyAdditionalCss:function(){var b=this;if("additionalCss" in b.config&&!!b.config.additionalCss){var a=b.getStyle();b.setStyle(a+b.config.additionalCss)}},applyAdditionalCssClasses:function(){var a=this;if("additionalCssClasses" in a.config&&!!a.config.additionalCssClasses){a.addCls(a.config.additionalCssClasses)}},initializePageImageCmp:function(){var a=this;if(typeof a.pageImgCmp!="object"){return}var b=a.pageImgCmp.element.dom.querySelector("img");if(b!=null){b.style.display="block";b.setAttribute("alt","Thumbnail Unavailable")}a.pageImgCmp.addListener("load",function(c){if(typeof a.imageContainerCmp=="object"){a.imageContainerCmp.setMinHeight(c.element.dom.clientHeight+"px")}},a,{single:true})},updateThumbnail:function(a){if(typeof a!="object"||a==null){return}var d=this;var b=null;d.eraseArticleHotspots(d.config.itemIdsOfHotspots);if(d.config.articleMediaObject==null||a.file!==d.config.articleMediaObject.file){d.config.mediaObjectsFromAllPagesForAnArticle=d.getMediaObjectsFromAllPagesForAnArticle(a);b=d.getMediaObjectWithSmallestPageNumForAnArticle(d.config.mediaObjectsFromAllPagesForAnArticle)}if(!!b){d.config.mediaObjectsOnPageForAnArticle=d.getMediaObjectsOnPageForAnArticle(b.page,d.config.mediaObjectsFromAllPagesForAnArticle);d.config.itemIdsOfHotspots=[];d.config.articleMediaObject=b}d.updatePageInfo(d.config.articleMediaObject.page);var c=d.getStitchHotspot(d.config.mediaObjectsOnPageForAnArticle);if(!!c){d.drawArticleHotspot(c,c.guid+"-0")}},updatePageInfo:function(d){if(typeof d==null){return}d=parseInt(d);if(isNaN(d)){return}var c=this;if(typeof c.pageTitleCmp=="object"&&typeof c.pageImgCmp=="object"&&!!d&&d!==c.config.pageNumber){c.config.pageNumber=d;var e=c.getPdfPage(d);if(!!e){c.pageTitleCmp.setHtml(c.getPageText()+" "+e.pageName+"<br><p style='color: grey; font-size: 11px;'>"+window.editionName+"</p>");var a=c.getPageImageUrl(d,c.config.editionGuid);c.pageImgCmp.on({loa}});var b=!!a?a:e.image;c.pageImgCmp.setHtml("<img style='transition: opacity .5s ease; opacity: 0; max-width: 100%;' onload='this.style.opacity = 1' src='"+b+"'/>")}}},getPdfPage:function(b){b=parseInt(b);if(typeof flatPlanData!="object"||flatPlanData==null||isNaN(b)){return null}if(b<1){b=1}var a=flatPlanData.pdfPages.length;if(b>a){b=a}if(settings.reader!=null&&settings.reader.reverse=="true"){b=(a-b)+1}return flatPlanData.pdfPages[b-1].pages[0]},getPageText:function(){return(typeof language=="object"&&language!=null&&"page" in language&&!!language.page)?language.page:"Page"},getMediaObjectsFromAllPagesForAnArticle:function(c){var a=[];if(typeof c!="object"||c==null){return a}var e=Ext.getStore("MediaStore");if(typeof e!="object"||e==null){return a}var b=[];try{b=Ext.getStore("MediaStore").data.items[0].raw.media.article;if(b==null||!Array.isArray(b)){b=[]}}catch(d){b=[]}var f=b.length;if(f===0){return a}a=b.filte});return a},getMediaObjectWithSmallestPageNumForAnArticle:function(b){var a=null;if(typeof b!="object"||b==null||!Array.isArray(b)){return a}a=b.reduce(function(d,c){return parseInt(d.page)<parseInt(c.page)?d:c});return a},getMediaObjectsOnPageForAnArticle:function(b,c){b=parseInt(b);var a=[];if(typeof c!="object"||c==null||!Array.isArray(c)||isNaN(b)){return a}a=c.filte});return a},drawArticleHotspots:function(a){if(typeof a!="object"||a==null||!Array.isArray(a)){return}var c=a.length;var b=this;for(var d=0;d<c;d++){b.drawArticleHotspot(a[d],a[d].guid+"-"+d)}},drawArticleHotspot:function(a,b){if(typeof a!="object"||a==null){return}var d=this;if(typeof d.imageContainerCmp!="object"||d.imageContainerCmp==null){return}if(typeof b=="undefined"||b==null){b="0"}var e="articleHotspot-"+b;d.config.itemIdsOfHotspots.push(e);d.config.itemIdsOfHotspots;var c=Ext.create("Ext.Container",{itemId:e,style:"position:absolute; background-color:rgba(0, 0, 0, 0.2); border:1px solid red;"});c.setWidth(a.width+"%");c.setHeight(a.height+"%");c.setLeft(a.x+"%");c.setTop(a.y+"%");d.imageContainerCmp.add(c)},eraseArticleHotspots:function(d){if(typeof d!="object"||d==null||!Array.isArray(d)||d.length===0){return}var e=d.length;var c=this;for(var a=0;a<e;a++){var b=c.imageContainerCmp.getComponent(d[a]);if(typeof b=="object"&&b!=null){b.destroy()}}},getStitchHotspot:function(j){if(typeof j!="object"||j==null||!Array.isArray(j)||j.length===0){return null}var d={x:null,y:null,width:null,height:null,guid:""};var g=j.length;var b=j.reduce(function(n,m){return parseFloat(n.x)<parseFloat(m.x)?n:m});var l=j.reduce(function(n,m){return parseFloat(n.y)<parseFloat(m.y)?n:m});var c=parseFloat(b.width);var e=parseFloat(l.height);for(var f=0;f<g;f++){var a=j[f];var k=parseFloat(a.x)-parseFloat(b.x);c=(parseFloat(a.width)+k)>c?(parseFloat(a.width)+k):c;var h=parseFloat(a.y)-parseFloat(l.y);e=(parseFloat(a.height)+h)>e?(parseFloat(a.height)+h):e}d.x=parseFloat(b.x);d.y=parseFloat(l.y);d.width=c;d.height=e;d.guid=b.guid;return d},getPageImageUrl:function(d,c){var a=null;if(typeof d=="undefined"||typeof c=="undefined"||c==null||!!c===false){return a}d=parseInt(d);if(isNaN(d)){return a}var b="http://edition.pagesuite.com";if(window.location.protocol=="https:"){b="https://"+location.host}a=b+"/get_image.aspx?w=185&eid="+c+"&pnum="+d+"&lm="+latestLM;return a},onTap:function(){var a=this;mainPanel.fireEvent("articlePageThumbnailClick",a)}},0,["readerarticlepagethumbnail"],["component","container","readerarticlepagethumbnail"],{component:true,container:true,readerarticlepagethumbnail:true},["widget.readerarticlepagethumbnail"],0,[InfinityMobile.view,"ReaderArticlePageThumbnail"],0));Ext.application({name:"InfinityMobile",profiles:["phone","largetablet","tablet","desktop"],models:["MyModel"],stores:["EditionFlatplan","LatestEditionFlatplan","ArchiveStore","SettingStore","SearchStore","SearchHighlightStore","MediaStore","ArticleStore","LanguageStore","PuzzleArchiveStore"],views:["ReaderSpecialSupplementsItem","ReaderPopoverMenuShare","ReaderPopoverMenuItem","ReadAloudControls","DownloadPrompt","StoryWindowPreferences","ReaderPuzzleArchive","ReaderSectionPopupItem","ReaderSectionPopup","ReaderEdgeBrowserPopup","ReaderZoomSlider","BackgroundWrapAdItem","ReaderPagesItem","PrintPreview","ClippingLoad","ClippingOptionsMenu","ReaderTicker","ReaderAudioMediaObject","ArticleSectionItemImg","ArticleSectionItem","ArticlesSectionContainer","ArticlesContainer","ClippingOptions","clippingPrompt","ClippingBox","ReaderLiveAdvertObject","LeftSideAdvertCover","ReaderLiveArticlePopoverItem","ArticleReader","NavButton","ClippingMenuEmailPrompt","ClippingMenuPreview","ClippingMenuPrompt","ClippingMenuDeletePrompt","ClippingMenuThumb","PrintMenu","ReaderAudioObject","LayoutZoomSlider","ClippingMenuImageScroller","ClippingMenu","ReaderLanguagePopup","ReaderOLinkObject","ReaderOVideo","ReaderOGallery","ReaderOGalleryItem","ReaderOGalleryLoading","ReaderOVideoObject","ReaderOGalleryObject","ReaderVideoLinkObject","ReaderLightbox","ReaderImageLinkObject","Main","Reader","ReaderToolbar","ReaderToolbarBottom","ReaderPages","Blocker","ReaderMenuItem","ReaderMenuClose","ReaderMenuSection","ReaderMenuSectionItem","2DInfiniteCarousel","InfiniteCarousel","ReaderPageViewer","ReaderPageViewerPDF","LayoutView","LayoutViewController","LayoutTextView","LayoutTextFieldView","ReaderSearchItem","ReaderArchiveItem","ReaderMediaObject","ReaderAnimationObject","ReaderLinkObject","ReaderArticleObject","ArticleCarousel","ReaderArticlePopoverItem","ReaderVideoObject","ReaderVideoObjectControls","Overlay","ReaderImageObject","PageRestriction","FullscreenPrompt","ReaderArchiveMonthItem","PDFInfiniteCarousel","ArticleReaderTopBarBtn","BookmarkItem","ReaderMenuShare","ReaderMenuShareItem","ReaderMenuTTS","ClippingArea","ReaderImageGallery","ReaderImageGalleryItem","ReaderPuzzleArchiveItem","ReaderArchivePageButton","ReaderArticleHelper","LightboxLink","ReaderPrompt","ClippingItems","clippingError","ReaderPrintItem","ReaderDownloadItem","ReaderPageNumber","ReaderDownloadScreen","ArticleReaderItem","ArticleReaderLiveNewsBtn","ArticleReaderSectionBtn","ArticleReaderToggleViewOptions","ArticleReaderTopItem","ArticlesContainer","DataCapture","DataCaptureForm","FullScreenImageGallery","FullscreenImageGalleryItem","ImageCarousel","LayoutAdvertView","liveNewsTicker","PrintPreviewArticle","ReaderImageGalleryThumb","ReaderSocial","Ticker","SectionScrollerItem","ReaderArchive","ReaderOverlayTitle","ReaderItemsContainer","ReaderPageThumbnail","ReaderOverlayButton","ReaderMessagePrompt","ReaderPrint","ReaderBookmark","ReaderSearch","ZonesOverlay","SectionListOverlay","ReaderDpsPrompt","ReaderBookmarkThumbnail","ReaderPageThumbnail","ReaderDownload","ReaderPrintScreen","CustomCheckbox","ReaderSearchLoadingMask","Advert","ConsentField","ReaderWebpopoverObject","ReaderWebpopover","PageTab","PageTabContainer","AdvertPageViewer","ReaderMenuArticleItem","TextSizeSlider","ShareSlider","ShareSliderItem","FullscreenArticlePopover","FullscreenArticlePopoverItem","PwaContentBrowser","ArchiveTabSelector","UserInactivityPrompt","ReaderPuzzlesPopup","ReaderArticlePageThumbnail"],controllers:["AppController","LayoutController","ReaderController","ArticleController","ReaderToolbarController","ReaderMenuController","ReaderSearchController","ReaderDownloadController","SubscribeController","MediaController","ArticlePopoverController","TrackingController","DataCaptureController","PrintController","ClippingController","PdfController","PageTurnController","PushController","BookmarkController","ReaderPuzzlesController"]});(Ext.cmd.derive("InfinityMobile.view.ReaderWatermarkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"watermark"},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(a.mediaObject.description.indexOf("{SUBSCRIBER_GUID}")!=-1){var b="";if(typeof getCookie!="undefined"){b=getCookie("subscriber");if(b==null||b==""){b=getCookie("SID")}}if(b!=null){a.mediaObject.description=a.mediaObject.description.replace("{SUBSCRIBER_GUID}",b)}}a.setHtml("<div>"+a.mediaObject.description+"</div>");if(currentProfile=="desktop"){if(a.config.leftSideOverflow!=null){if(a.config.leftSideOverflow){a.mediaObject.x=100+a.mediaObject.x;a.setMediaObjectStyle()}}}}},0,["readerwatermark"],["component","container","readermediaobject","readerwatermark"],{component:true,container:true,readermediaobject:true,readerwatermark:true},["widget.readerwatermark"],0,[InfinityMobile.view,"ReaderWatermarkObject"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderPanelContainer",Ext.Container,{config:{cls:"articlereaderpanelcontainer",layout:{type:"hbox"},margin:"50 5 5 5",style:"display:inline;width:1540px;"},initialize:function(){var a=this;a.setStyle("height:"+($(document).height()-120)+"px;")},onResize:function(){var a=this;if(a!=null){a.setStyle("height:"+($(document).height()-120)+"px;")}}},0,["articlereaderpanelcontainer"],["component","container","articlereaderpanelcontainer"],{component:true,container:true,articlereaderpanelcontainer:true},["widget.articlereaderpanelcontainer"],0,[InfinityMobile.view.desktop,"ArticleReaderPanelContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderLiveArticlePopoverItem",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",style:"background-color:white",layout:"card",items:[{itemId:"content",flex:1,padding:"0 0 10px 0"},{itemId:"contentIframe",layout:"fit",height:"100%"}]},initialize:function(){var a=this;a.content=a.getComponent("content");a.setContentStyle();a.isLive=true;a.painted=false;a.contentIframe=a.getComponent("contentIframe");a.on("painted",a.getContent,a,{delay:10,single:true});a.mode="html";if((a.config.highlightMode!=null&&a.config.highlightMode==true)||(a.config.readAloudMode!=null&&a.config.readAloudMode)){a.mode="frame";a.setActiveItem(a.contentIframe)}},setContentStyle:function(){var a=this;if(currentProfile=="tablet"){a.content.setPadding("0 20px 0 20px")}},getContent:function(){var e=this;e.painted=true;var d="";if(e.getPage().headdeck!=null){d="<div class='contentDeck font25'></div><br />"}var f="";if(e.getPage().images!=null){f="<div class='contentImages' >";for(var c=0;c<e.getPage().images.length;c++){f+="<div class='contentImage'><img src='"+e.getPage().images[c].url+"' /></div>"}f+="</div><br />"}var b="<div class='contentHead font35' >"+e.getPage().headline+"</div><br />"+d+f+"<div class='contentByline font15'>"+e.getPage().byline+"</div><br /><div class='contentBody font15'>"+e.getPage().content+"</div><br />";var a=b.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(a){b=a[1]}b='<div class="articleContentHtml5" >'+b+"</div>";b+="<script>setText()<\/script>";e.removeSpinner();e.content.setHtml(b);e.setImages();if(e.mode=="frame"){e.setFrame()}if(e.content.element!=null){setText(e.content.element.dom)}e.setStyle({visibility:"inherit"})},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var f=this;var d=1;var c=1;var b=f.id;if(currentProfile=="tablet"){var e=$("#"+b+" img").get(0);if(e!=null){if(e.naturalWidth==0){e.onload=function(){var g=this;if(g.naturalWidth<(screen.width/2)){var h=$("#"+b+" .articleContent")[0];h.className="articleContent float"}}}}}if($("#"+b+" .contentImage").size()>1){if(currentProfile=="phone"){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREVIOUS"}c=$("#"+b+" .contentImage").size();if(c>1){$("#"+b+" .contentImage:gt(0)").hide();$("#"+b+" .previousImage").hide();a()}else{if(c==1){$("#"+b+" .imageControls").hide()}}$("#"+b+" .nextImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").next();h.hide();d++;a();g.fadeIn();$("#"+b+" .previousImage").show();if(g.is("#"+b+" .contentImage:last")){$("#"+b+" .nextImage").hide()}});$("#"+b+" .previousImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").prev();h.hide();d--;a();g.fadeIn();$("#"+b+" .nextImage").show();if(g.is("#"+b+" .contentImage:first")){$("#"+b+" .previousImage").hide()}})}else{$("#"+b+" .imageControls").hide()}function a(){var g="Image "+d.toString()+" of "+c.toString();$("#"+b+" .imageCount").text(g)}},setFrame:function(){var a=this;a.mode=="frame";a.setIframeContent()},toggleToTextMode:function(){var a=this;if(a.mode=="html"){if(a.painted){a.setIframeContent()}a.setActiveItem(a.contentIframe);a.mode="frame"}else{a.setActiveItem(a.content);a.mode="html"}},setIframeContent:function(){var h=this;if(h.contentIframe.getHtml()==null){h.contentIframe.setHtml("<iframe class=\"articleiframe\" style='width:100%; height:100%; border:none'></iframe>");var d=h.contentIframe.element.down("iframe").dom;var k="phoneArticle";if(currentProfile=="tablet"){k="tabletArticle"}var a="<div class='"+k+"'>"+h.content.getHtml()+'</div><script>setImages("'+currentProfile+'");<\/script>';var c="";if(typeof customCSS!="undefined"){var m=customCSS.split("|");for(var e=0;e<m.length;e++){var l=atob(m[e]);c+="<link rel='stylesheet' type='text/css' href='"+l+"' />"}}var j="<script>cols[i].style.fontSize = font35Size;<\/script>";var g="<style>body { margin:0 } p { margin:0; padding:0; } .articleContentHtml5 { /*padding: 0 25px;*/ height: 100% !important; font-size:"+fontEm+"px } .imageControls{ display:none !important; } .contentImage { display:block !important; }</style><script>function setText() {}<\/script><script>function updateText(fontsize) { document.getElementsByClassName('articleContentHtml5')[0].style.fontSize = fontsize + 'px' }<\/script>";var f="<html><head>{{HEAD}}</head><body>{{BODY}}</body></html>";var b="<link rel='stylesheet' type='text/css' href='resources/css/article.css'>"+c+'<script src="resources/js/articleGallery.js?build='+buildguid+'"><\/script>'+g;f=f.replace("{{HEAD}}",b);f=f.replace("{{BODY}}",a);h.iframe=d.contentWindow?d.contentWindow:(d.contentDocument.document?d.contentDocument.document:d.contentDocument);h.iframe.document.write(f)}}},0,["readerlivearticlepopoveritem"],["component","container","readerlivearticlepopoveritem"],{component:true,container:true,readerlivearticlepopoveritem:true},["widget.readerlivearticlepopoveritem"],0,[InfinityMobile.view.desktop,"ReaderLiveArticlePopoverItem"],0));