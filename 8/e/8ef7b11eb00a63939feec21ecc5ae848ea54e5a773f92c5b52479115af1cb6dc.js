import{a6 as W,N,bd as se,aD as ne,aw as j,as as F,u as Y,aA as J,aB as ie,a1 as ae,ay as ce,b4 as le,cW as oe,aX as re,aW as ue,dV as H,az as de,bE as pe}from"./itinerary-entities.5f897bcd.js";import{l as z,r as K,c as n,G as i,P as l,Y as a,a6 as _,z as e,x as v,_ as ve,H as E,Q as b,R as Z,n as ge,w as me,I as A,a as q,F as h,$ as V,a7 as ee,an as _e,ao as ke,a3 as fe,a4 as Se,aa as he,q as xe,y as ye}from"./graphql.5cf3693b.js";import{u as be}from"./useItineraryPackageReload.fc9d3423.js";import{b as L,l as R,m as Q}from"./entry.a7cea746.js";import{B as X}from"./BoxRadio.942f0b7e.js";import"./itinerary-modules.2ea32123.js";import"./service-client.4862e840.js";import"./useReload.488398cb.js";const Ie={class:"option-container"},Pe={class:"label-container"},$e={class:"label"},Ce={class:"option-details"},Te={class:"description"},we={class:"extra-slot"},Me=z({__name:"ExtraOption",props:{item:{},priceClassIndex:{default:0},package:{}},setup(t){const I=W(),g=N(),c=j(),r=K(!1),C=n(()=>!!t.item.disabled),u=n(()=>t.item.title),k=n(()=>t.item.icon),w=n(()=>t.item.price),p=n(()=>t.item.description),P=n(()=>g.getExtraOptionValueForSelectedPrice({option:t.item,priceClassIndex:t.priceClassIndex,package:t.package})),f=()=>{const x=!r.value;c==null||c.trackEvent({event:`click add extra option ${t.item.id}`}),g.toggleExtraOptionsForSelectedPrice({option:t.item,priceClassIndex:t.priceClassIndex,enable:x,package:t.package}),ge(()=>I.loadPreInvoice(t.package)),r.value=x};return(x,S)=>(i(),l("div",Ie,[a("div",Pe,[a("span",$e,_(e(u)),1),v(L,{margin:"0"})]),a("div",{class:Z(["option",{selected:e(P)}]),onClick:f},[v(se,{size:"large","bold-label":"","model-value":e(P),disabled:e(C),label:e(u),onClick:ve(f,["prevent"])},null,8,["model-value","disabled","label","onClick"]),a("div",Ce,[e(k)?(i(),E(ne,{key:0,icon:e(k),color:"var(--yellow-600)",size:"small"},null,8,["icon"])):b("",!0),a("span",Te,_(e(p)),1),a("div",we,[e(w)?(i(),E(R,{key:0,price:e(w)},null,8,["price"])):b("",!0)])])],2)]))}});const Ve=F(Me,[["__scopeId","data-v-8a91987e"]]),Ee={class:"box"},Be={class:"box-title"},Re={key:0,class:"label-container"},Fe={class:"label"},ze={key:2,class:"label-container"},De={class:"label"},Oe=z({__name:"RaiseClass",props:{package:{},index:{}},setup(t){const I=Y(),g=W(),c=N(),r=j(),C=n(()=>c.getAvailableExtraOptionsList(t.package)),u=n(()=>c.getAvailablePriceTypes(t.package)),k=n(()=>u.value.some(s=>s.title)),w=n(()=>x.value?c.getAvailablePriceClasses(x.value):null),p=n(()=>t.package.defaultPrice),P=n(()=>t.package.raisePriceTypesTitle),f=n(()=>t.package.raisePriceClassesTitle),x=n({get(){return c.getSelectedPriceType(t.package)},set(s){if(s)c.selectPriceTypeForPackageIndex({priceType:s,index:t.index});else throw new Error("undefined not handled")}}),S=n(()=>u.value.findIndex(s=>s===x.value).toString()),T=n({get(){var s;if(t.package&&t.package.isTripPackage())return((s=t.package)==null?void 0:s.selectedPrice)||null},set(s){if(s)r==null||r.trackEvent({event:"price-class-change",reserveType:I.reserveType,value:s.title}),c.selectPriceClassForPackageIndex({priceClass:s,count:1,packageIndex:t.index});else throw new Error("value type not handled")}}),$=n(()=>{var s;return((s=p.value)==null?void 0:s.singlePayable)||null}),y=n(()=>t.package.raiseTitle),m=n(()=>{var s;return((s=w.value)==null?void 0:s.map(d=>({label:d.title,diff:Math.abs(U(d)),sign:Math.sign(U(d)),value:d,description:d.descriptionItems.join(`
`)})))||[]}),D=n(()=>u.value.map((s,d)=>({label:s.title||"",description:s.description||"",value:`${d}`,icon:s.icon}))),B=s=>{x.value=u.value[+s]},U=s=>s.singlePayable-($.value||0),o=()=>{g.loadPreInvoice(t.package)};return me(T,()=>{o()}),(s,d)=>(i(),l("div",Ee,[a("span",Be,_(e(y)),1),e(k)&&e(P)?(i(),l("div",Re,[a("span",Fe,_(e(P)),1),v(L,{margin:"0"})])):b("",!0),e(k)?(i(),E(X,{key:1,"model-value":e(S),options:e(D),"onUpdate:modelValue":B},null,8,["model-value","options"])):b("",!0),e(f)?(i(),l("div",ze,[a("span",De,_(e(f)),1),v(L,{margin:"0"})])):b("",!0),v(X,{modelValue:e(T),"onUpdate:modelValue":d[0]||(d[0]=M=>q(T)?T.value=M:null),options:e(m),"wrap-label":"",class:"price-class-options"},{extra:A(({option:M})=>[M.diff?(i(),E(R,{key:0,type:"small",price:M.diff,prefix:(M.sign??0)>0?"هزینه مازاد":"کاهش هزینه"},null,8,["price","prefix"])):b("",!0)]),_:1},8,["modelValue","options"]),(i(!0),l(h,null,V(e(C),(M,G)=>(i(),l(h,null,[(i(!0),l(h,null,V(M.list,O=>(i(),E(Ve,{key:`${O.id}-${G}`,item:O,"price-class-index":M.selectedPriceClassIndex,package:t.package},null,8,["item","price-class-index","package"]))),128))],64))),256))]))}});const Ae=F(Oe,[["__scopeId","data-v-37c0589d"]]),Le={class:"bottom-sheet-content"},Ne=z({__name:"SuggestedServiceItemDetails",props:{item:{}},emits:["close"],setup(t,{emit:I}){return(g,c)=>(i(),E(ie,{title:g.item.title,onClose:c[1]||(c[1]=r=>I("close"))},{footer:A(()=>[v(J,{"full-width":"",onClick:c[0]||(c[0]=r=>I("close"))},{default:A(()=>[ee(" متوجه شدم ")]),_:1})]),default:A(()=>[a("div",Le,_(g.item.description),1)]),_:1},8,["title"]))}});const Ue=F(Ne,[["__scopeId","data-v-30c93836"]]),qe={class:"suggested-service-item-root"},We={class:"row-container"},je=["src"],Ge={class:"title-container"},He={class:"title"},Qe={class:"description"},Xe={class:"desktop-price-section"},Ye={key:0,class:"discount-level"},Je=["src"],Ke={class:"mobile-price-section"},Ze={class:"mr-price-wrapper"},et={key:0,class:"discount-level"},tt=["src"],st={class:"prefix"},nt={key:0,class:"address-container"},it={class:"description"},at={class:"scroll-fix"},ct=z({__name:"SuggestedServiceItem",props:{item:{},packageIndex:{}},setup(t){const I=W(),g=ae(),c=N(),{selectedServicesSuggestedFieldsError:r}=ce(c),{isMobileSize:C}=le(),u=K(!1),k=n(()=>t.item.price*(m.value||1)),{open:w}=oe({component:Ue,attrs:{item:t.item}}),p=n(()=>t.item.discount*(m.value||1)),P=n(()=>Math.round(t.item.discount*100/f.value)),f=n(()=>k.value+p.value),x=n(()=>g.levelTitle),S=n(()=>`/img/club/level-${g.levelIndex+1}.png`),T=n(()=>{var O;const o=(O=t.item.levelRange)==null?void 0:O.MinApplicableLevel,s=g.level;if(!o||!s)return!1;const d=te=>+te.replace("Level",""),M=d(o);return d(s)>=M}),$=n(()=>!!t.item.needDescription&&!!m.value),y=n(()=>c.selectedPackages[t.packageIndex]),m=n({get(){var o;return((o=y.value.selectedSuggestionServices.find(s=>s.service===t.item))==null?void 0:o.count)||0},set(o){c.selectSuggestionService({service:t.item,count:o,description:B.value,packageIndex:t.packageIndex}),I.loadPreInvoice(y.value)}}),D=n(()=>{var o;return(o=r.value.find(({id:s})=>s===t.item.id))==null?void 0:o.error}),B=n({get(){var o;return((o=y.value.selectedSuggestionServices.find(s=>s.service===t.item))==null?void 0:o.description)||""},set(o){c.selectSuggestionService({service:t.item,description:o,count:m.value,packageIndex:t.packageIndex})}}),U=()=>{C.value?w():u.value=!u.value};return(o,s)=>(i(),l("div",qe,[a("div",We,[a("img",{class:"image",src:o.item.image,alt:"image"},null,8,je),a("div",Ge,[a("span",He,_(o.item.title),1),a("span",Qe,_(o.item.description),1),v(J,{type:"transparent","right-icon":e(u)?e(re):e(ue),size:"medium",onClick:U},{default:A(()=>[ee(" مطالعه "+_(e(u)?"کمتر":"بیشتر"),1)]),_:1},8,["right-icon"])]),v(L,{margin:"0",color:"transparent",vertical:"",class:"vertical-divider"}),a("div",Xe,[e(p)?(i(),l("div",Ye,[v(R,{price:e(f),percent:e(P),type:"discount",free:""},null,8,["price","percent"]),e(T)?(i(),l(h,{key:0},[a("span",null," ویژه کاربران "+_(e(x)),1),a("img",{src:e(S),alt:"level-icon"},null,8,Je)],64)):b("",!0)])):b("",!0),v(R,{price:e(k),prefix:e(m)?"مجموع":"هر نفر",free:""},null,8,["price","prefix"]),v(Q,{modelValue:e(m),"onUpdate:modelValue":s[0]||(s[0]=d=>q(m)?m.value=d:null),unit:o.item.unitTitle,size:"big","start-button":"","min-title":"خرید","start-button-icon":e(H)},null,8,["modelValue","unit","start-button-icon"])])]),v(L,{margin:"0",class:"horizontal-divider"}),a("div",Ke,[a("div",Ze,[e(p)?(i(),l("div",et,[v(R,{price:e(f),percent:e(P),type:"discount",free:""},null,8,["price","percent"]),e(T)?(i(),l(h,{key:0},[a("span",null," ویژه کاربران "+_(e(x)),1),a("img",{src:e(S),alt:"level-icon"},null,8,tt)],64)):b("",!0)])):b("",!0),a("span",st,_(e(m)?"مجموع":"هر نفر"),1),v(R,{price:e(k)},null,8,["price"])]),v(Q,{modelValue:e(m),"onUpdate:modelValue":s[1]||(s[1]=d=>q(m)?m.value=d:null),unit:o.item.unitTitle,size:"big","auto-width":"","start-button":"","min-title":"خرید","start-button-icon":e(H),"start-icon-button":""},null,8,["modelValue","unit","start-button-icon"])]),e($)?(i(),l("div",nt,[v(de,{id:o.item.id,modelValue:e(B),"onUpdate:modelValue":s[2]||(s[2]=d=>q(B)?B.value=d:null),"text-area":"",required:"","min-length":10,"full-width":"",label:"آدرس","error-text":e(D),invalid:!!e(D),"hide-description":!e(D),placeholder:"لطفاً آدرس محل اقامت خود را برای ارائه سرویس وارد کنید."},null,8,["id","modelValue","error-text","invalid","hide-description"])])):b("",!0),a("div",{class:Z(["description-full",{expanded:e(u)}])},[a("div",it,[a("div",at,_(o.item.description),1)])],2)]))}});const lt=F(ct,[["__scopeId","data-v-28839c81"]]),ot=t=>(_e("data-v-2b5c83fa"),t=t(),ke(),t),rt={key:0,class:"suggestions-container"},ut={key:0,class:"suggestion-trip-item"},dt={class:"suggestion-trip-title"},pt=ot(()=>a("span",{class:"suggestion-trip-description"}," جهت تعیین جزئیات این خدمات، همکاران ما با شما تماس برقرار می‌کنند. ",-1)),vt=z({__name:"RaiseSuggestions",setup(t){const I=N(),g=n(()=>I.selectedPackages.filter(c=>c.isTripPackage()?c.segments.some(r=>r.trips.some(C=>C.suggestionServices.length)):!0));return(c,r)=>e(g).length?(i(),l("div",rt,[(i(!0),l(h,null,V(e(g),(C,u)=>(i(),l(h,null,[(i(!0),l(h,null,V(C.segments,(k,w)=>(i(),l(h,null,[(i(!0),l(h,null,V(k.trips,(p,P)=>(i(),l(h,{key:`${u}-${w}-${P}`},[p.suggestionServices&&p.suggestionServices.length?(i(),l("div",ut,[a("span",dt,_(`خدمات پیشنهادی ${p.originCityName} به ${p.destinationCityName}`),1),pt,(i(!0),l(h,null,V(p.suggestionServices,f=>(i(),E(lt,{key:f.id,item:f,"package-index":u},null,8,["item","package-index"]))),128))])):b("",!0)],64))),128))],64))),256))],64))),256))])):b("",!0)}});const gt=F(vt,[["__scopeId","data-v-2b5c83fa"]]),mt={class:"raise-root"},_t={class:"rules-title"},kt={class:"rules"},ft=z({__name:"raise",setup(t,{expose:I}){const g=Y(),c=W(),r=N(),C=pe(),u=j(),k=fe(),w=Se(),p=n(()=>r.selectedPackages.filter(S=>S.isTripPackage())),P=()=>{if(u==null||u.trackEvent({event:"tup-next button click"}),r.suggestedServiceFormValidation(),r.selectedServicesSuggestedFieldsError.length===0)k.push("/reserve/form");else{const S=document.getElementById(r.selectedServicesSuggestedFieldsError[0].id.toString());S&&window.setTimeout(()=>S.scrollIntoView({behavior:"smooth"}),100)}};he(()=>{c.clearState()});const{start:f,stop:x}=be(()=>{C.selectedBundlePackage=null,k.back()});return xe(()=>{var T,$,y;(T=p.value)!=null&&T.length||history.back(),r.loadPreInvoiceForCurrentPackages();const S=w.query.current;S&&(g.currentSetIndex=Number(S)||0),f(),(y=($=r.currentlySelectedPackage)==null?void 0:$.selectedPrices)!=null&&y.some(m=>m.selectedExtraFormOptions.length)&&r.resetSelectedExtraFormOptions()}),ye(()=>{x()}),I({proceed:P}),(S,T)=>(i(),l("div",mt,[(i(!0),l(h,null,V(e(p),($,y)=>(i(),E(Ae,{key:y,package:$,index:y},null,8,["package","index"]))),128)),v(gt),(i(!0),l(h,null,V(e(p),($,y)=>(i(),l("div",{key:`rules-${y}`,class:"box"},[a("span",_t,_($.termsAndConditionsTitle),1),a("span",kt,_($?$.termsAndConditions:""),1)]))),128))]))}});const Ct=F(ft,[["__scopeId","data-v-1fa79ce6"]]);export{Ct as default};
