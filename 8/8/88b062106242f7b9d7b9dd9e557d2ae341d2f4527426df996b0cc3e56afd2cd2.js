(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7043,3800],{45146:83244:function(e,t,n){"use strict";n.d(t,{ZP:function(){return CapturePreviewProvider},hi:function(){return useCapturePreview}});var i,s,a=n(52322),r=n(2784),l=n(47330);(i=s||(s={})).Element="element",i.Input="input",i.Position="position";let o=(0,r.createContext)({openCapturePreview:()=>{},closeCapturePreview:()=>{}});et useCapturePreview=()=>(0,r.useContext)(o)},33800:function(e,t,n){"use strict";n.d(t,{Y:function(){return OfflinePlayerLayout},Z:function(){return LaunchpadLayout}});var i=n(52322),s=n(2784),a=n(99219),r=n(51830),l=n(53012),o=n(83122),c=n(53954),u=n(5632),d=n(43913),p=n(68810),m=n(91077),h=n(99071),f=n(39097),v=n.n(f);let BackToAppLogo_Logo=()=>(0,i.jsx)(m.H,{height:"23px"});}var x=n(98291),b=n(23848);let g=[var j=n(97729),y=n.n(j}var w=n(75435}var C=n(57473),P=n(27091),N=n(32775),S=n(97185),k=n(98786),T=n(56268),A=n(47330),F=n(96615);let LaunchpadLayout_Log),MaybeRequireTeamMessag},Na},BackButto23093:function(e,t,n){"use strict";n.d(t,{W:function(){return PresentButton},Z:function(){return OfflineBar}});var i=n(52322),s=n(2784),a=n(99219),r=n(83122),l=n(57289),o=n(29119),c=n(5632),u=n(56958);function OfflineBar(e){let{projectId:t}=e,[n,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{t&&o.w.project.findFirst({where:t}).the))},[t]);let d=(0,s.useCallback)(()=>{u.A.promise((0,l.W3)(o.w,t).then(async()=>{let e=await o.w.project.findFirst({where:t});c(!!e)}),{loading:"Downloading...",success:"Downloaded!",error:"Error downloading"})},[t]);return(0,i.jsxs)("div",{className:(0,r.AK)("hidden","pwa:flex items-center justify-between rounded-md border bg-white px-4 py-3"),children:[(0,i.jsxs)("div",{className:"grid gap-1.5",children:[(0,i.jsxs)("div",{className:"flex items-center text-sm font-medium text-gray-700",children:[(0,i.jsx)(a.wQA,{className:"mr-1 h-3.5 w-3.5"}),"Offline version"]}),(0,i.jsx)("div",{className:"flex text-sm text-gray-500",children:n?"Version available":"No downloaded versions"})]}),(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"flex gap-x-2",children:[(0,i.jsx)("button",{onClick:d,className:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50",children:"Download"}),(0,i.jsx)(PresentButton,{projectId:t,disabled:!n})]})})]})}function PresentButton(e){let{handlePresent:t,projectId:n,disabled:s}=e,a=(0,c.useRouter)();return(0,i.jsx)("button",{disabled:s,onClick:()=>{if(t){t(n);return}a.push({pathname:"/launchpad/present/offline/[id]",query:{id:n}})},className:"duration-70 flex items-center justify-between rounded-md border border-[#455CAD] bg-[#455CAD] px-3 py-1 text-sm text-white transition-all hover:bg-[#4258a6] focus:border-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-300 disabled:cursor-not-allowed disabled:opacity-75",children:"Present"})}},71660:function(e,t,n){"use strict";n.d(t,{Z:function(){return ProjectPreview}});var i=n(52322),s=n(80394);function ProjectPreview(e){let{project:t,className:n}=e;return(0,i.jsx)(i.Fragment,{children:t.initialScreenshotCapture?(0,i.jsx)(s.Z,{capture:t.initialScreenshotCapture,mode:s.p.CardPreview}):(null==t?void 0:t.screenshot)&&(0,i.jsx)("img",{src:t.screenshot,className:n})})}},2100},98786:function(e,t,n){"use strict";var i=n(52322),s=n(2784);t.}},7080},1016:function(e,t,n){"use strict";n.d(t,{Z:function(){return SelectComboboxPopover}});var i=n(52322),s=n(2784),a=n(68377),r=n(43913),l=n(68810),o=n(99219),c=n(83122),u=n(69260),d=n(71659);function CustomSearchCombobox(e){let{disabled:t,placeHolder:n="Search",items:r,selected:l,onChange:p,max:m=u.G1,allowRemove:h,renderOption:f,renderFooter:v,renderHeaderRight:x,tight:b,className:g="",highlightedClass:j="bg-blue-primary",focusClass:y="focus:outline-none focus:ring-2 focus:border-blue-primary focus:ring-blue-200",searchField:w="name",filterOptions:C,selectFirstItem:P,allowCreate:N,field:S="name",itemName:k="item",title:T,query:A,setQuery:F,close:L}=e,[I,R]=(0,s.useState)(null),[O,_]=(0,s.useState)(r),E=(0,s.useCallback},[p,P,l]);(0,s.useEffect},[r,C,E]);let Z=(0,s.useMemo},[A,O,m,w]),D=l&&l.id||l;(0,s.useEffect},[D,r]);let handleChange=e=>{e||(R(null),F("")),p(e),L()};return(0,i.jsx)(a.h,{disabled:t,value:I,onChange:handleChange,children:(0,i.jsxs)("div",{className:(0,c.AK)(g,"relative overflow-hidden rounded-md border bg-white shadow-lg"),children:[(0,i.jsxs)("div",{className:"flex items-center justify-between border-b bg-white px-3 py-2.5",children:[(0,i.jsx)("span",{className:"font-semibold text-gray-800 ",children:T}),null==x?void 0:x()]}),(0,i.jsx)("div",{className:"border-b px-2 py-1.5",children:(0,i.jsxs)("div",{className:"relative flex items-center",children:[(0,i.jsx)(a.h.Input,{autoFocus:!0,className:(0,c.AK)(y,"w-full rounded border border-gray-200 bg-transparent py-2 pl-3 pr-5 text-base"),placeholder:n,onChang)}),h&&l&&(0,i.jsx)("button",{onClick:()=>handleChange(null),className:"absolute right-3 ml-auto",children:(0,i.jsx)(o.aMB,{className:"h-3.5 w-3.5 text-gray-300 hover:text-gray-400"})})]})}),(0,i.jsxs)(a.h.Options,{static:!0,className:"z-10 max-h-60 w-full overflow-auto bg-white py-1 text-sm",children:[0===Z.length?(0,i.jsx)(i.Fragment,{children:!A&&(0,i.jsx)("div",{className:"flex items-center justify-center py-8 italic text-gray-400",children:"No results"})}):Z.ma}),A&&N&&(0,i.jsx)(a.h.Option,{className:e=>{let{active:t}=e;return"relative mx-4 cursor-pointer select-none overflow-visible rounded px-4 py-2 hover:bg-gray-100 ".concat(t?"bg-gray-100 text-gray-700":"bg-gray-50 text-gray-900")},value:{[S]:A},children:e=>{let{selected:t}=e;return(0,i.jsxs)("span",{className:"flex items-center ".concat(t?"font-semibold":"font-normal"),children:[(0,i.jsx)(o.pOD,{className:"-ml-2 mr-2 h-3 w-3"}),(0,i.jsxs)("span",{className:"trucate font-medium",children:["Create ",k,' "',A,'"']})]})}},"create")]}),v&&v()]})})}function SelectComboboxPopover(e){let{renderSelected:t,...n}=e;return(0,i.jsxs)(r.J,{children:[(0,i.jsx)(r.J.Button,{as:"div",disabled:e.disabled,children:t(e.selected)}),(0,i.jsx)(l.u,{leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",className:"relative",afterLeav),children:(0,i.jsx)(r.J.Panel,{className:(0,c.AK)(e.widthClass||"w-full","absolute bottom-full top-0 z-10 mt-1 bg-white pb-3 text-base focus:outline-none"),children:e=>{let{close:t}=e;return(0,i.jsx)(CustomSearchCombobox,{...n,close:t,tight:!0,className:"text-sm"})}})})]})}},92927:function(e,t,n){"use strict";n.d(t,{a:function(){return useCreateProjectShareLinkMutation}});var i=n(73235),s=n(66547),a=n(2835),r=n(26806);function _templateObject(){let e=(0,i._)(["\n    mutation CreateProjectShareLink($data: ProjectShareLinkCreateInput!) {\n  createProjectShareLink(data: $data) {\n    ...ProjectShareLink\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let l=(0,s.ZP)(_templateObject(),a.D}},53012:function(e,t,n){"use strict";n.d(t,{Y:function(){return useGetProjectQuery}});var i=n(73235),s=n(66547),a=n(40230),r=n(26806);function _templateObject(){let e=(0,i._)(["\n    query GetProject($id: String!) {\n  project(id: $id) {\n    ...Project\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let l=(0,s.ZP)(_templateObject(),a.q);function useGetProjectQuery(e){return r.aM({query:l,...e})}},54290:function(e,t,n){"use strict";n.d(t,{o:function(){return useIsCustomPathInWorkspaceQuery}});var i=n(73235),s=n(66547),a=n(26806}let r=(0,s.ZP)(_templateObject());function useIsCustomPathInWorkspaceQuery(e){return a.aM({query:r,...e})}},86543:function(e,t,n){"use strict";n.d(t,{o:function(){return useListProjectShareLinksQuery}});var i=n(73235),s=n(66547),a=n(2835),r=n(26806);function _templateObject(){let e=(0,i._)(["\n    query ListProjectShareLinks($data: ProjectShareLinkQueryInput!) {\n  projectShareLinks(data: $data) {\n    id\n    count\n    results {\n      ...ProjectShareLink\n    }\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let l=(0,s.ZP)(_templateObject(),a.D}},56853:function(e,t,n){"use strict";n.d(t,{JR:function(){return validWorkEmail},u$:function(){return validEmail},vR:function(){return validDomain}});let i=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,s=/@(hotmail|yahoo|gmail|protonmail|icloud|aol|outlook|zoho)\.com/,a=/[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]?(?:\.[a-zA-Z]{2,})+/,validDomain=e=>a.test(e),validEmai),validWorkEmai)},4652:function(e,t,n){"use strict";var i=n(2784);t.}},67904:function(e,t,n){"use strict";n.d(t,{F:function(){return useQueryOnFocus}});var i=n(2784);function useQueryOnFocus(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(0,i.useRef)(t);n.current=t,(0,i.useEffect)(()=>{let listener=()=>{var t;null!==(t=n.current)&&void 0!==t&&t.some)||"visible"!==document.visibilityState||e({requestPolicy:"cache-and-network"})};return document.addEventListener("visibilitychange",listener)},[e])}},57289:function(e,t,n){"use strict";n.d(t,{W3:function(){return syncProject}});var i=n(47330),s=n(24065),a=n(61543),r=n(81332),l=n(47147),o=n(73750),c=n(81525),u=n(3583),d=n(83615),p=n(20851);async function syncStaticResource(e,t,n,i){if(t.startsWith("data:"))return;let a=(0,s.m1)(t);if(a){let r=await (0,s.M2)(e,t,n,i);if(!r)return;let l=(0,o.C)(r);if(!l)return;let{mime:c,base64:u}=l;if(!c.startsWith("text/css"))return;let d=u?atob(l.body):l.body,p=(0,s.d1)(n,{staticResourceId:a});await (0,s.$_)(e,d,p);return}let r=await (0,s.Cz)(t,i);if(!r)return;let l=(0,o.C)(r);if(!l)return r;let{mime:c,base64:u}=l;if(!c.startsWith("text/css"))return r;let d=u?atob(l.body):l.body,p=d;return await (0,s.Cf)(d,async(t,i)=>{let a=i[0].includes("@import"),r=(0,s.m1)(t),l=r?(0,s.d1)(n,{staticResourceId:r}):n,o=await syncStaticResource(e,t,l,a?"text/css":void 0);o&&(p=p.replace(t,o))}),"data:text/css;base64,".concat(btoa(p))}async function syncWebCapture(e,t,n){let{id:i,published:a}=t,r=(null==a?void 0:a.captureVersionId)||(null==a?void 0:a.id);if(r&&n.allWebCaptureVersions[r])return;n.allWebCaptureVersions[r]=!0;let l={id:r,webCaptureId:i,node:await (0,s.rT)({id:r})};if(!l.node){console.error("Capture ".concat(r," not found"));return}let o=(0,s.d1)(n,{webCaptureVersionId:r});return o.webCaptureVersionToStaticResources[r]=[],await (0,c.hv)(l.node,[(0,s.Or)({filter:d.hK,operation:(0,s.rw)(e,o)}),(0,s.tZ)({filter:s.u4,operation:(0,s.GR)(e,o)}),(0,s.tZ)({filter:s.If,operation:(0,s.Xw)(e,o)}),(0,s.tZ)({filter:s.aI,operation:(0,s.kC)(e,o)}),(0,s.tZ)({filter:s.Yn,operation:(0,s.dv)(e,o)}),(0,s.tZ)({filter:s.wq,operation:(0,s.oB)(e,o)}),(0,s.tZ)({filter:s.FU,operation:(0,s.EA)(e,o)}),(0,s.tZ)({filter:s.TE,operation:(0,s.hQ)(e,o)})],!0),o.guideToWebCaptureVersions[n.guideId].push(r),await e.webCaptureVersion.upsert({data:l})}async function syncWebCaptures(e,t,n){return await Promise.all(t.map(t=>syncWebCapture(e,t,n)))}async function syncMediaCapture(e,t,n){if(n.allScreenshotCaptures[t.id])return;n.allScreenshotCaptures[t.id]=!0;let{deviceScreenshot:i,deviceTemplate:a,...l}=t,o={...l,deviceScreenshot:i,deviceTemplate:void 0};if(i&&(o.deviceScreenshot=await (0,s.Cz)(i)),a){let e=r.Ak.fin});if(null==e?void 0:e.image){let t=(0,r.Gc)(e),n=await (0,s.Cz)(t);n&&(o.deviceTemplate={...e,image:n})}}return n.guideToScreenshotCaptures[n.guideId].push(t.id),await e.screenshotCapture.upsert({data:o})}async function syncMediaCaptures(e,t,n){return await Promise.all(t.ma)))}async function syncFlow(e,t,n){if(n.allGuides[t.id])return;if(n.allGuides[t.id]=!0,!("published"in t)){let e=await (0,s.sj)(t.id);if(!e){console.error("Flow ".concat(t.id," not found"));return}e.guide&&(e.published=e.guide),t=e}let a=t,r=(0,s.d1)(n,{guideId:a.id});r.guideToWebCaptureVersions[a.id]=[],r.guideToScreenshotCaptures[a.id]=[],r.guideToStaticResources[a.id]=[];let l=[],{steps:o,...c}=a.published,u=[],d=[],m=[];if(o)for(let{webCapture:t,screenshotCapture:n,...s}of o){if(t&&u.push(t),n&&d.push(n),(s.appearance===i.XB.Modal||s.appearance===i.XB.Tooltip)&&s.content){let t=(0,p.OA)(s.content);if(t)for(let n in t.entityMap)try{let i=t.entityMap[n];i.data.src&&l.push(syncStaticResource(e,i.data.src,r))}catch(e){}}m.push({...s,webCapture:t?{id:t.id,name:t.name}:void 0})}let{published:h,...f}=a.published.theme||{};h&&l.push(syncThemeVersion(e,h,r));let v={...a,published:{...c,steps:m,theme:a.published.theme?f:void 0},type:a.type};if((null==u?void 0:u.length)&&l.push(syncWebCaptures(e,u,r)),(null==d?void 0:d.length)&&l.push(syncMediaCaptures(e,d,r)),v.published.steps.length)for(let t of v.published.steps){let{backBtn:n,nextBtn:i,beacons:s,buttons:a,triggers:o}=t;(null==n?void 0:n.actions)&&l.push(scanActionsForFlowStarts(e,n.actions,r)),(null==i?void 0:i.actions)&&l.push(scanActionsForFlowStarts(e,i.actions,r)),(null==s?void 0:s.length)&&l.push(Promise.all(s.map(async t=>{t.actions&&await scanActionsForFlowStarts(e,t.actions,r)}))),(null==a?void 0:a.length)&&l.push(Promise.all(a.map(async t=>{t.actions&&await scanActionsForFlowStarts(e,t.actions,r)}))),(null==o?void 0:o.length)&&l.push(Promise.all(o.map(async t=>{t.actions&&await scanActionsForFlowStarts(e,t.actions,r)})))}l.push(e.guide.upsert({data:v})),await Promise.all(l)}async function syncChecklist(e,t,n){if(n.allGuides[t.id])return;if(n.allGuides[t.id]=!0,!("published"in t)){let e=await (0,s.sj)(t.id);if(!e){console.error("Checklist ".concat(t.id," not found"));return}let{guide:n,...i}=e;t={...i,published:n}}let i=t,a=(0,s.d1)(n,{guideId:i.id});a.guideToWebCaptureVersions[i.id]=[],a.guideToScreenshotCaptures[i.id]=[];let r=[],{steps:l,...o}=i.published,{published:c,...u}=i.published.theme||{};c&&r.push(syncThemeVersion(e,c,a));let d={...i,published:{...o,theme:i.published.theme?u:void 0},type:i.type};if(d.published.tasks)for(let t of d.published.tasks)t.actions&&r.push(scanActionsForFlowStarts(e,t.actions,a));r.push(e.guide.upsert({data:d})),await Promise.all(r)}let scanActionsForFlowStarts=async(e,t,n)=>await Promise.all(t.map(async t=>{t.startFlowId&&await syncFlow(e,{id:t.startFlowId},n)})),syncThemeVersion=async(e,t,n)=>{if(n.allThemeVersions[t.id]){n.themeVersionToGuides[t.id].includes(n.guideId)||n.themeVersionToGuides[t.id].push(n.guideId);return}if(n.allThemeVersions[t.id]=!0,n.themeVersionToGuides[t.id]=[n.guideId],t.dialogFontUrl){let i=await syncStaticResource(e,t.dialogFontUrl,n,"text/css");i&&(t.dialogFontUrl=i)}return await e.themeVersion.upsert({data:t})};async function syncProject(e,t){let n=await (0,s.$M)(t);if(!n){console.error("Project ".concat(t," not found"));return}if((0,l.MH)(n)){console.error("Project ".concat(t," is passcode protected"));return}let{checklist:i,flow:r,...o}=n,c={...o,flowId:null==r?void 0:r.id,checklistId:null==i?void 0:i.id},u=(0,s.d1)(t),d=[];if(r&&d.push(syncFlow(e,r,u)),i&&d.push(syncChecklist(e,i,u)),d.length&&await Promise.all(d),!c.screenshot){let e="";if(r){var p,m,h;let t=null===(p=r.published.steps)||void 0===p?void 0:p.find(e=>{var t,n,i;return(null===(n=e.webCapture)||void 0===n?void 0:null===(t=n.published)||void 0===t?void 0:t.id)||(null===(i=e.screenshotCapture)||void 0===i?void 0:i.deviceScreenshot)});t&&(e=(null===(m=t.screenshotCapture)||void 0===m?void 0:m.deviceScreenshot)?null===(h=t.screenshotCapture)||void 0===h?void 0:h.deviceScreenshot:(0,a.m$)(t.webCapture.published.id))}e&&(c.screenshot=await (0,s.Cz)(e,null))}await updateItemConnections(e,u),await e.project.upsert({data:c})}async function updateItemConnections(e,t){var n,i,s;let{projectId:a,themeVersionToGuides:r,guideToScreenshotCaptures:l,guideToWebCaptureVersions:o,guideToStaticResources:c,webCaptureVersionToStaticResources:d,staticResourceToStaticResources:m}=t,h={};for(let e in r)for(let t of r[e])h[t]=e;let f={};for(let e in l)for(let t of l[e])f[t]=f[t]||[],f[t].push(e);let v={};for(let e in o)for(let t of o[e])v[t]=v[t]||[],v[t].push(e);let x={};for(let e in d)for(let t of d[e])x[t]=x[t]||[],x[t].push(e);let b={};for(let e in m)for(let t of m[e])b[t]=b[t]||[],b[t].push(e);let g={};for(let e in c)for(let t of c[e])g[t]=g[t]||[],g[t].push(e);let j=Object.keys(r),y=Object.keys(o),w=Object.keys(f),C=Object.keys(v),P=Object.keys(x),N=Object.keys(b),S=Object.keys(c),k=Object.keys(g),T=[e.projectToGuides.findFirst({where:a}),Promise.all(j.map(t=>e.themeVersionToGuideVersions.findFirst({where:t}))),Promise.all(w.map(t=>e.screenshotCaptureToGuides.findFirst({where:t}))),Promise.all(y.map(t=>Promise.all([e.guideToProjects.findFirst({where:t}),e.guideToScreenshotCaptures.findFirst({where:t}),e.guideToWebCaptureVersions.findFirst({where:t})]))),Promise.all(C.map(t=>Promise.all([e.webCaptureVersionToStaticResources.findFirst({where:t}),e.webCaptureVersionToGuides.findFirst({where:t})]))),Promise.all(P.map(t=>Promise.all([e.staticResourceToStaticResources.findFirst({where:t}),e.staticResourceToWebCaptureVersions.findFirst({where:t})]))),Promise.all(N.map(t=>e.staticResourceInStaticResources.findFirst({where:t}))),Promise.all(S.map(t=>e.guideToStaticResources.findFirst({where:t}))),Promise.all(k.ma)))],[A,F,L,I,R,O,_,E,Z]=await Promise.all(T),D=new u.ci,M=(null==A?void 0:A.guideIds)||[],V=(0,p.hp)(M,y);V.length!==M.length&&D.enqueue(e.projectToGuides.upsert({data:{projectId:a,guideIds:V}}));for(let t=0;t<j.length;++t){let n=j[t],i=F[t],s=(null==i?void 0:i.guideVersionIds)||[],a=r[n],l=(0,p.hp)(s,a);l.length!==s.length&&D.enqueue(e.themeVersionToGuideVersions.upsert({data:{themeVersionId:n,guideVersionIds:l}}))}for(let t=0;t<w.length;++t){let n=w[t],i=L[t],s=(null==i?void 0:i.guideIds)||[],a=f[n],r=(0,p.hp)(s,a);r.length!==s.length&&D.enqueue(e.screenshotCaptureToGuides.upsert({data:{screenshotCaptureId:n,guideIds:r}}))}for(let t=0;t<y.length;++t){let[n,i,s]=I[t]||[],r=y[t],c=(null==n?void 0:n.projectIds)||[],u=[a],d=(0,p.hp)(c,u);d.length!==c.length&&D.enqueue(e.guideToProjects.upsert({data:{guideId:r,projectIds:d}}));let m=(null==i?void 0:i.screenshotCaptureIds)||[],f=l[r]||[],v=(0,p.hp)(m,f);v.length!==m.length&&D.enqueue(e.guideToScreenshotCaptures.upsert({data:{guideId:r,screenshotCaptureIds:v}}));let x=(null==s?void 0:s.webCaptureVersionIds)||[],b=o[r]||[],g=(0,p.hp)(x,b);g.length!==x.length&&D.enqueue(e.guideToWebCaptureVersions.upsert({data:{guideId:r,webCaptureVersionIds:g}}));let j=h[r];j&&D.enqueue(e.guideToThemeVersion.upsert({data:{guideId:r,themeVersionId:j}}))}for(let t=0;t<C.length;++t){let[n,i]=R[t]||[],s=C[t],a=(null==n?void 0:n.staticResourceIds)||[],r=d[s]||[],l=(0,p.hp)(a,r);l.length!==a.length&&D.enqueue(e.webCaptureVersionToStaticResources.upsert({data:{webCaptureVersionId:s,staticResourceIds:l}}));let o=(null==i?void 0:i.guideIds)||[],c=v[s]||[],u=(0,p.hp)(o,c);u.length!==o.length&&D.enqueue(e.webCaptureVersionToGuides.upsert({data:{webCaptureVersionId:s,guideIds:u}}))}for(let t=0;t<P.length;++t){let[n,i]=O[t]||[],s=P[t],a=(null==n?void 0:n.staticResourceIds)||[],r=m[s]||[],l=(0,p.hp)(a,r);l.length!==a.length&&D.enqueue(e.staticResourceToStaticResources.upsert({data:{staticResourceId:s,staticResourceIds:l}}));let o=(null==i?void 0:i.webCaptureVersionIds)||[],c=x[s]||[],u=(0,p.hp)(o,c);u.length!==o.length&&D.enqueue(e.staticResourceToWebCaptureVersions.upsert({data:{staticResourceId:s,webCaptureVersionIds:u}}))}for(let t=0;t<N.length;++t){let i=(null===(n=_[t])||void 0===n?void 0:n.staticResourceIds)||[],s=b[N[t]]||[],a=(0,p.hp)(i,s);a.length!==i.length&&D.enqueue(e.staticResourceInStaticResources.upsert({data:{staticResourceId:N[t],staticResourceIds:a}}))}for(let t=0;t<S.length;++t){let n=(null===(i=E[t])||void 0===i?void 0:i.staticResourceIds)||[],s=c[S[t]]||[],a=(0,p.hp)(n,s);a.length!==n.length&&D.enqueue(e.guideToStaticResources.upsert({data:{guideId:S[t],staticResourceIds:a}}))}for(let t=0;t<k.length;++t){let n=(null===(s=Z[t])||void 0===s?void 0:s.guideIds)||[],i=g[k[t]]||[],a=(0,p.hp)(n,i);a.length!==n.length&&D.enqueue(e.staticResourceToGuides.upsert({data:{staticResourceId:k[t],guideIds:a}}))}await Promise.all(D)}},66449:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return $}});var i=n(52322),s=n(71660),a=n(86414),r=n(61543),l=n(53954),o=n(23093),c=n(2784),u=n(91170),d=n(99219),p=n(32517),m=n(78066),h=n(92927),f=n(54290),v=n(55839),x=n(50337),b=n(77512),g=n(6676),j=n.n(g),y=n(56958),w=n(2769),C=n(1016),P=n(73235),N=n(66547),S=n(43123),k=n(26806);function _templateObject(){let e=(0,P._)(["\n    query ListCompanyAccountsByDomain($data: CompanyAccountsQueryDomainInput!) {\n  companyAccountsByDomain(data: $data) {\n    ...CompanyAccount\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let T=(0,N.ZP)(_templateObject(),S.h);var A=n(56853}function SelectCompanyAccount(e){var t;let{onChange:n,selected:s,disabled:a}=e,{workspace:r}=(0,l.cF)(),[o,u]=(0,c.useState)(""),[{data:d}]=(t={variables:{data:{workspaceId:r.id,domain:o,filterByCreator:!0}},pause:!(null==r?void 0:r.id)},k.aM({query:T,...t})),m=(null==d?void 0:d.companyAccountsByDomain)||[],extractCompanyNameFromDomain=e=>{let t=e.split(".");return t.length>=2?t.length[t.length-2]:e},generateCompanyName=e=>{let t=extractCompanyNameFromDomain(e);return t.charAt(0).toUpperCase()+t.slice(1)},handleChange=async e=>{if(!e)return n({companyAccount:void 0});if(!(0,A.vR)(e.websiteDomain)){(0,p.Rn)("Invalid website domain");return}if(e.id)n({companyAccount:formatCompanyAccountToSelect(e)});else{var t;let i=await fetch("/api/enrich?domain=".concat(e.websiteDomain));if(!i.ok){(0,p.Rn)("Error enriching company account");return}let s=await i.json();n({companyAccount:{...s.companyAccount,id:j()(),name:(null===(t=s.companyAccount)||void 0===t?void 0:t.name)||generateCompanyName(e.websiteDomain),websiteDomain:e.websiteDomain}})}},h=m.ma)),f=s?{...s,websiteDomain:null==s?void 0:s.websiteDomain}:void 0;return(0,i.jsx)(C.Z,{placeHolder:"Company domain",title:"Company accounts",renderSelected:e=>(0,i.jsx)(w.R,{domain:null==e?void 0:e.websiteDomain,name:null==e?void 0:e.name,showEditMode:!0,disabled:a}),renderOption:(e,t)=>(0,i.jsx)(w.R,{domain:e.websiteDomain,name:e.name,active:t,avatarSize:"26px"}),onChange:handleChange,items:h,selected:f,query:o,setQuery:u,disabled:a,field:"websiteDomain",searchField:"websiteDomain",itemName:"with domain",allowCreate:!0})}var F=n(3526),L=n(28909}let I=(0,N.ZP)(listProspects_templateObject(),L.z);function SelectProspect(e){var t;let{workspace:n}=(0,l.cF)(),{onChange:s,selected:a}=e,[r,o]=(0,c.useState)(""),[{data:u}]=(t={variables:{data:{workspaceId:n.id,email:r,filterByCreator:!0}},pause:!(null==n?void 0:n.id)},k.aM({query:I,...t})),d=(null==u?void 0:u.prospects)||[],handleChange=async e=>{if(!e)return s({prospect:void 0,companyAccount:void 0});if(!e.email||!(0,A.u$)(e.email)){(0,p.Rn)("Invalid email address");return}if(e.id){let{companyAccount:t,...n}=e,i=(null==t?void 0:t.websiteDomain)?{companyAccount:formatCompanyAccountToSelect(t)}:{};s({prospect:n,...i})}else{var t;let n=await fetch("/api/enrich?email=".concat(e.email));if(!n.ok){(0,p.Rn)("Error enriching prospect");return}let i=await n.json(),a=(null===(t=i.companyAccount)||void 0===t?void 0:t.websiteDomain)?{companyAccount:{...i.companyAccount,id:j()()}}:{};s({prospect:{id:j()(),...i.prospect},...a})}};return(0,i.jsx)(C.Z,{renderSelected:e=>(0,i.jsx)(F.Z,{prospect:e,showEditMode:!0}),selected:a,title:"Prospects",placeHolder:"Prospect work email",searchField:"email",field:"email",itemName:"with email",items:d,onChange:handleChange,renderOption:(e,t)=>(0,i.jsx)(F.Z,{prospect:e,active:t}),query:r,setQuery:o,allowCreate:!0})}let DEFAULT_SHARE_LINK=()=>({id:"",customPath:(0,g.slug)(),passcode:"",expiresAt:null,prefilledVariables:[],isPrimary:!1,projectId:"",visits:0,archived:!1,archivedAt:null});function ShareLinkCreateModal(e){let{handleClose:t,open:n,project:s}=e,{workspace:o}=(0,l.cF)(),u=(0,r.s1)({subdomain:o.slug}),[d,g]=(0,c.useState)(!1),[j,w]=(0,c.useState)(DEFAULT_SHARE_LINK()),[C,P]=(0,c.useState)(!1),[,N]=(0,h.a)(),[{data:S},k]=(0,f.o)({variables:{customPath:"/"+(null==j?void 0:j.customPath),workspaceId:null==o?void 0:o.id}}),[{data:T,fetching:A,error:F}]=(0,v.U)({variables:{workspaceId:o.id},pause:!(null==o?void 0:o.id)}),L=null==T?void 0:T.personalizationVariables,I=(0,c.useCallback)(e=>{var t,n,i,s,a,r,l;let o={"company.name":null===(t=e.companyAccount)||void 0===t?void 0:t.name,"company.domain":null===(n=e.companyAccount)||void 0===n?void 0:n.websiteDomain,"user.fullName":"".concat(null!==(r=null===(i=e.prospect)||void 0===i?void 0:i.firstName)&&void 0!==r?r:""," ").concat(null!==(l=null===(s=e.prospect)||void 0===s?void 0:s.lastName)&&void 0!==l?l:""),"user.email":null===(a=e.prospect)||void 0===a?void 0:a.email},c=null==L?void 0:L.map(e=>({variable:e,value:o[e.attributeName]})).filtee);w({...e,prefilledVariables:c})},[L]),checkSettings=()=>(null==S?void 0:S.isCustomPathInWorkspace)?(g(!0),(0,p.Rn)("Path already exists in workspace"),!1):(g(!1),!0),onSave=async()=>{let{id:e,projectId:t,prefilledVariables:n,visits:i,archived:l,archivedAt:o,customPath:c,...u}=j,d={...u,customPath:"/"+(0,r.Lp)(c),prefilledVariables:(0,x.NQ)(n||[])};checkSettings()&&(P(!0),y.A.promise(new Promise((e,t)=>{N({data:{...d,createdInLaunchpad:!0,projectId:s.id}}).then(n=>{var i;if(P(!1),(null==n?void 0:n.error)||!(null==n?void 0:null===(i=n.data)||void 0===i?void 0:i.createProjectShareLink)){t("Error saving link");return}a.Z.track("project_link_created"),e(),onClose()})}),{success:"Created link",loading:"Creating Link...",error:p.bW}))},onSelect=e=>{let{prospect:t,companyAccount:n}=e,i={...j,prospect:t,companyAccount:n};w(i),I(i)},onClose=()=>{t(),w(DEFAULT_SHARE_LINK())};return(0,i.jsx)(m.Z,{open:n,title:"Create link",handleClose:onClose,hideFooter:!1,nextText:"Create",nextDisabled:C||d||A,handleNext:onSave,cancelButton:(0,i.jsx)("button",{className:"btn-gray-border mr-3 bg-white px-3 py-2 text-sm",onClick:onClose,children:"Cancel"}),children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("label",{className:"label-small",children:"Prospect"}),(0,i.jsx)(SelectProspect,{selected:j.prospect,onChange:onSelect}),(0,i.jsx)("label",{className:"label-small mt-3",children:"Company"}),(0,i.jsx)(SelectCompanyAccount,{disabled:!!j.prospect&&!!j.companyAccount,selected:j.companyAccount,onChange:onSelect})]}),(0,i.jsx)("div",{className:"mb-1.5 mt-3 flex items-center justify-between",children:(0,i.jsx)("label",{className:"label-small mb-0",children:"Link"})}),(0,i.jsx)(b.oi,{type:"text",name:"customPath",id:"customPath",left:"".concat((0,r.wn)(u),"/"),error:d?"Error":void 0,placeholder:"e.g. demo",value:(0,r.Lp)(j.customPath)||"",onChange:e=>{let t=/^[a-zA-Z0-9_-]*$/.test(e);g(!t),w({...j,customPath:e}),k()}})]})})}var R=n(70805),O=n(49323),_=n(86543),E=n(83122),Z=n(4652),D=n(67904),M=n(21002);let EmptyState=()=>(0,i.jsx)("div",{className:"flex items-center justify-center rounded-md border p-4 text-center text-gray-500 md:p-6",children:(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)("div",{className:"w-full max-w-2xl text-center text-gray-500",children:"This demo doesn't have any links."})})}),V=[{Header:"Link",Cell:e=>{let{cell:{row:{original:t}},linkSubdomain:n}=e,s=(0,r.fP)({linkSubdomain:n,customPath:null==t?void 0:t.customPath}),a=(0,r.wn)(s);return(0,i.jsxs)("div",{className:"flex max-w-[300px] items-center truncate",children:[(0,i.jsx)("span",{className:"truncate text-sm text-slate-600",children:a}),(0,i.jsx)("button",{onClick:()=>{(0,E.vQ)(s),(0,p.Vp)("Copied to clipboard!")},className:"group ml-2 rounded-md border p-1 shadow-sm hover:shadow",children:(0,i.jsx)(d.Kmg,{className:"h-3 w-3  text-slate-400 group-hover:text-slate-500"})})]})}},{Header:"Prospect",accessor:"prospect",Cell:e=>{let{cell:{value:t}}=e;return(0,i.jsx)(M.wq,{prospect:t})}},{Header:"Company account",accessor:"companyAccount",Cell:e=>{let{cell:{value:t}}=e;return(0,i.jsx)(M.T3,{companyAccount:t})}},{Header:"Visits",accessor:"visits",Cel}}];function ShareLinkList(e){var t,n;let{projectId:s,project:a}=e,{workspace:o}=(0,l.cF)(),{getNext:d,getPrev:p,isStart:m,isEnd:h,startIndex:f,setTotalCount:v}=(0,Z.Z)(20),[x,b]=(0,c.useState)(!1),{currentUser:g}=(0,l.xJ)(),[{data:j,fetching:y,stale:w},C]=(0,_.o)({variables:{data:{workspaceId:null==o?void 0:o.id,projectId:s,skip:f,limit:20,includesPrimary:!0,creatorId:null==g?void 0:g.id}},pause:!(null==o?void 0:o.id)||!(null==g?void 0:g.id)});(0,D.F)(C,[y,w]);let P=null!==(n=null==j?void 0:null===(t=j.projectShareLinks)||void 0===t?void 0:t.results)&&void 0!==n?n:[];(0,c.useEffect)(()=>{var e;let t=null==j?void 0:null===(e=j.projectShareLinks)||void 0===e?void 0:e.count;void 0!==t&&v(t)},[j,v]);let N=(0,r.s1)({subdomain:o.slug});return(0,i.jsxs)("section",{className:"mb-8",children:[(0,i.jsxs)("header",{className:"mb-1 flex items-center justify-between",children:[(0,i.jsx)("div",{className:"max-w-2xl",children:(0,i.jsx)("h3",{className:"text-2xl font-semibold tracking-tight",children:"Share links"})}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{onClick:()=>b(!0),className:"duration-70 flex items-center justify-between rounded-md border border-zinc-900 bg-zinc-900 px-3.5 py-2 text-base font-medium text-white transition-all hover:bg-zinc-700 focus:border-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-300",children:"Create link"})})]}),(0,i.jsx)("div",{className:"mb-3 mt-2",children:(0,i.jsx)(u.B,{filters:{Creator:["You"]}})}),y?(0,i.jsx)("div",{}):P.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(O.Z,{columns:V,cellProps:{linkSubdomain:N},data:null!=P?P:[],loading:!1}),(0,i.jsx)("div",{className:"mb-1 pt-5",children:(0,i.jsx)(R.Z,{isStart:m,isEnd:h,handleNext:d,handlePrev:p})})]}):(0,i.jsx)(EmptyState,{}),a&&(0,i.jsx)(ShareLinkCreateModal,{project:a,open:x,handleClos)})]})}function DemoDisplay(e){let{project:t,projectId:n}=e,c=null==t?void 0:t.primaryShareLink,{workspace:u}=(0,l.cF)(),d=(0,r.s1)({subdomain:u.slug}),p=(0,r.fP)({linkSubdomain:d,customPath:null==c?void 0:c.customPath}),m=(0,r.wn)(p);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("section",{className:"mb-24 xl:px-10",children:[(0,i.jsxs)("header",{className:"mb-8 pb-4",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 py-4",children:[(0,i.jsx)("div",{children:t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"mb-1 max-w-full flex-shrink-0 truncate text-3xl font-semibold tracking-tight",children:null==t?void 0:t.name}),(0,i.jsx)("a",{onClic},href:p,target:"_blank",rel:"noreferrer",className:"text-[#455CAD]",children:m})]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"mb-2 h-5 w-40 animate-pulse rounded bg-gray-100"}),(0,i.jsx)("div",{className:"h-5 w-64 animate-pulse rounded bg-gray-100"})]})}),(0,i.jsx)("div",{className:"flex",children:(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,i.jsx)("div",{className:"xs:mt-0 mt-3 h-28 w-44 overflow-hidden rounded-md border bg-gray-50",children:(0,i.jsx)("div",{className:"relative h-full w-full",children:t&&(0,i.jsx)(s.Z,{project:t,className:"h-32 object-cover object-left-top"})})})})})]}),(0,i.jsx)("div",{className:"mt-4 flex gap-8 border-t pt-4 text-sm"})]}),(0,i.jsx)("div",{className:"-mt-6 mb-8",children:(0,i.jsx)(o.Z,{projectId:n})}),(0,i.jsx)(ShareLinkList,{projectId:n,project:t})]})})}var z=n(33800),W=n(53012),q=n(39391),B=n(70689),G=n.n(B),H=n(5632);function LaunchpadPage(){let e=(0,H.useRouter)(),{id:t}=(0,E.H8)(e.query),[{data:n,fetching:s}]=(0,W.Y)({variables:{id:t},requestPolicy:"cache-first",pause:!t}),a=null==n?void 0:n.project;return t&&(a||s)?(0,i.jsx)(DemoDisplay,{projectId:t,project:a}):(0,i.jsx)(G(),{statusCode:q.W.NOT_FOUND})}LaunchpadPage.getLayou};var $=LaunchpadPage},80394:function(e,t,n){"use strict";n.d(t,{Z:function(){return MediaCapture},p:function(){return s}});var i,s,a=n(52322),r=n(2784),l=n(83244),o=n(47330),c=n(83122),u=n(23712),d=n(97015),p=n(14882),m=n(89370),h=n(20851),f=n(22112),v=n(70064),x=n(81332),b=n(77033);(i=s||(s={})).Edit="edit",i.Select="select",i.CardPreview="cardPreview",i.Present="present";let g={edit:"h-[65vh]",select:"h-[65vh]",cardPreview:"h-[150px]",present:"h-[85vh]"};function MediaCapture(e){var t,n;let{capture:i,renderEmpty:s,renderInsideTemplate:j,mode:y,onScroll:w,onLoad:C,...P}=e,{initialSelector:N}=(0,l.hi)(),{setScale:S}=(0,b.mU)(),k="object"==typeof(null==i?void 0:i.deviceTemplate)&&i.deviceTemplate?i.deviceTemplate:x.Ak.fin})||x.Ak[0],T=null==k?void 0:k.template,A=(0,r.useRef)(null),F=(0,r.useRef)(null),L=(0,r.useRef)(null),{offline:I}=(0,f.D)(),R=(null==i?void 0:i.deviceTemplate)||o.DS.None,O=g[y],_=(0,r.useMemo},[i]),{scale:E}=(0,v.qE)(),Z=(0,r.useCallback},[i,S,E]);(0,r.useLayoutEffect),[Z,S]);let D=(0,r.useCallback},[Z,C,i,y,N]),M=P.screenshot||_||(null==i?void 0:i.deviceScreenshot);(0,r.useEffect},[i,C,M,k]);let V=(0,r.useCallback},[M,null==k?void 0:k.image,D]),z=(0,r.useCallback},[D,k]),W=(null==i?void 0:i.lockHorizontalScroll)&&"select"!==y,q=(null==i?void 0:i.lockVerticalScroll)&&"select"!==y,B=null==i?void 0:null===(t=i.deviceScreenshot)||void 0===t?void 0:t.includes("/nv_static/v/"),G=(null==i?void 0:i.deviceScreenshot)||"",H=(null==i?void 0:i.customTemplateHeight)&&(null==i?void 0:i.customTemplateWidth)?{height:i.customTemplateHeight,width:i.customTemplateWidth}:void 0;return(0,a.jsx)("div",{className:"absolute left-0 top-0 h-full w-full",style:{backgroundColor:(null==i?void 0:i.deviceBgColor)||void 0},children:(0,a.jsx)("div",{className:"flex h-full translate-x-0 translate-y-0 items-center justify-center",children:(0,a.jsxs)("div",{className:(0,c.AK)("pointer-events-none relative",R===o.DS.None&&"h-full w-full"),children:[(0,a.jsxs)("div",{className:(0,c.AK)("absolute bg-white","cardPreview"===y?"no-scrollbar pointer-events-none overflow-hidden":"pointer-events-auto overflow-auto",W&&"overflow-x-hidden",q&&"overflow-y-hidden"),style:null==k?void 0:k.dimensions,ref:A,id:"nv_viewport",onScroll:w,children:[!M&&(null==s?void 0:s()),M&&(0,a.jsxs)(a.Fragment,{children:[B?(0,a.jsx)("video",{src:G,onLoadedData:V,className:"h-auto w-full",autoPlay:!0,playsInline:!0,loop:!0,muted:!0}):(0,a.jsx)("img",{src:M,onLoad:V,className:"h-auto w-full"}),null==j?void 0:j()]})]}),(null==k?void 0:k.image)?(0,a.jsx)("img",{onLoad:z,src:I?null===(n=null==i?void 0:i.deviceTemplate)||void 0===n?void 0:n.image:(0,x.Gc)(k),className:(0,c.AK)("pointer-events-none relative max-h-[1400px] ".concat(O)),style:{zIndex:m.dw-2}}):R!==o.DS.None&&T?(0,a.jsx)(T,{className:"w-auto rounded-[.25rem] ".concat(O),style:H}):(0,a.jsx)("div",{className:"w-auto ".concat(O)})]})})})}},77033:function(e,t,n){"use strict";n.d(t,{ZP:function(){return MediaCaptureProvider},mU:function(){return useMediaCapture}});var i=n(52322),s=n(2784);let a=(0,s.createContext)({scale:1,setScale:()=>{},scaleDimension}}}let useMediaCapture=()=>(0,s.useContext)(a)},22112:function(e,t,n){"use strict";n.d(t,{nF:function(){return ProjectMetadataContextProvider},D:function(){return useProjectMetadata}});var i=n(2784),s=n(47330);let a=(0,i.createContext)({id:"",showNavatticBranding:!1,workspaceSlug:"",initialFlowId:"",scaleStrategy:s.V1.Responsive,mobileStrategy:s.Sy.Optimized,hasChecklist:!1,offline:!1,projectShareLink:void 0,flows:[],checklist:void 0});var r=n(52322);let ProjectMetadataContextProvide},useProjectMetadata=()=>(0,i.useContext)(a)},70064:function(e,t,n){"use strict";n.d(t,{W2:function(){return MobileOptimizedViewProvider},qE:function(){return useMobileOptimizedView}});var i=n(52322),s=n(2784),a=n(47330),r=n(50733),l=n(97472),o=n(89370);let c=(0,s.createContext)({isMobile:!1,scale:{width:1,height:1}}),cleanupElStyle}let useMobileOptimizedVie)},4714},50733:function(e,t,n){"use strict";n.d(t,{$M:function(){return s},JH:function(){return i},SW:function(){return r},lk:function(){return a}});let i="__NAVATTIC_FLOW____CAPTURE_OPEN__",s=Symbol("nv_node_ref"),a={width:1200,height:750},r=800},97472:function(e,t,n){"use strict}n.d(t,{T:function(){return getOrientation}})},7068}},function(e){e.O(0,[3211,8426,3265,1617,4637,5837,696,7274,4974,5036,9391,3519,4054,7330,9219,5306,6870,7156,6456,7185,3712,8145,7473,9119,9774,2888,179}),_N_E=e.O()}]);
//# sourceMappingURL=[id]-1cde264f7202553e.js.map