/*! For license information please see fluidplayer.min.js.LICENSE.txt */
!function(){var e,t,n,o,i,r,a,l={410:function(e,t,n){"use strict";var o=n(81),i=n.n(o),r=n(645),a=n.n(r),l=n(667),d=n.n(l),s=new URL(n(858),n.b),u=new URL(n(924),n.b),c=new URL(n(373),n.b),p=new URL(n(212),n.b),f=new URL(n(928),n.b),y=a()(i()),v=d()(s),m=d()(u),g=d()(c),h=d()(p),b=d()(f);y.push([e.id,".fluid_video_wrapper {\n    animation: none;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-duration: 0;\n    animation-fill-mode: none;\n    animation-iteration-count: 1;\n    animation-name: none;\n    animation-play-state: running;\n    animation-timing-function: ease;\n    backface-visibility: visible;\n    background: 0;\n    background-attachment: scroll;\n    background-clip: border-box;\n    background-color: transparent;\n    background-image: none;\n    background-origin: padding-box;\n    background-position: 0 0;\n    background-position-x: 0;\n    background-position-y: 0;\n    background-repeat: repeat;\n    background-size: auto auto;\n    border: 0;\n    border-style: none;\n    border-width: medium;\n    border-color: inherit;\n    border-bottom: 0;\n    border-bottom-color: inherit;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n    border-bottom-style: none;\n    border-bottom-width: medium;\n    border-collapse: separate;\n    border-image: none;\n    border-left: 0;\n    border-left-color: inherit;\n    border-left-style: none;\n    border-left-width: medium;\n    border-radius: 0;\n    border-right: 0;\n    border-right-color: inherit;\n    border-right-style: none;\n    border-right-width: medium;\n    border-spacing: 0;\n    border-top: 0;\n    border-top-color: inherit;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n    border-top-style: none;\n    border-top-width: medium;\n    bottom: auto;\n    box-shadow: none;\n    -webkit-box-sizing: content-box;\n    -moz-box-sizing: content-box;\n    box-sizing: content-box;\n    caption-side: top;\n    clear: none;\n    clip: auto;\n    color: inherit;\n    columns: auto;\n    column-count: auto;\n    column-fill: balance;\n    column-gap: normal;\n    column-rule: medium none currentColor;\n    column-rule-color: currentColor;\n    column-rule-style: none;\n    column-rule-width: none;\n    column-span: 1;\n    column-width: auto;\n    content: normal;\n    counter-increment: none;\n    counter-reset: none;\n    cursor: auto;\n    direction: ltr;\n    display: inline;\n    empty-cells: show;\n    float: none;\n    font: normal;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-size: medium;\n    font-style: normal;\n    font-variant: normal;\n    font-weight: normal;\n    height: auto;\n    hyphens: none;\n    left: auto;\n    letter-spacing: normal;\n    line-height: normal;\n    list-style: none;\n    list-style-image: none;\n    list-style-position: outside;\n    list-style-type: disc;\n    margin: 0;\n    margin-bottom: 0;\n    margin-left: 0;\n    margin-right: 0;\n    margin-top: 0;\n    max-height: none;\n    max-width: none;\n    min-height: 0;\n    min-width: 0;\n    opacity: 1;\n    orphans: 0;\n    outline: 0;\n    outline-color: invert;\n    outline-style: none;\n    outline-width: medium;\n    overflow: visible;\n    overflow-x: visible;\n    overflow-y: visible;\n    padding: 0;\n    padding-bottom: 0;\n    padding-left: 0;\n    padding-right: 0;\n    padding-top: 0;\n    page-break-after: auto;\n    page-break-before: auto;\n    page-break-inside: auto;\n    perspective: none;\n    perspective-origin: 50% 50%;\n    position: static;\n    /* May need to alter quotes for different locales (e.g fr) */\n    quotes: '\\201C' '\\201D' '\\2018' '\\2019';\n    right: auto;\n    tab-size: 8;\n    table-layout: auto;\n    text-align: inherit;\n    text-align-last: auto;\n    text-decoration: none;\n    text-decoration-color: inherit;\n    text-decoration-line: none;\n    text-decoration-style: solid;\n    text-indent: 0;\n    text-shadow: none;\n    text-transform: none;\n    top: auto;\n    transform: none;\n    transform-style: flat;\n    transition: none;\n    transition-delay: 0s;\n    transition-duration: 0s;\n    transition-property: none;\n    transition-timing-function: ease;\n    unicode-bidi: normal;\n    vertical-align: baseline;\n    visibility: visible;\n    white-space: normal;\n    widows: 0;\n    width: auto;\n    word-spacing: normal;\n    z-index: auto;\n    -webkit-tap-highlight-color: transparent;\n}\n\n.fluid_video_wrapper canvas {\n    pointer-events: none;\n}\n\n.fluid_video_wrapper,\n.fluid_video_wrapper * {\n    -webkit-box-sizing: content-box;\n    -moz-box-sizing: content-box;\n    box-sizing: content-box;\n}\n\n.fluid_video_wrapper:after, .fluid_video_wrapper:before {\n    content: none;\n}\n\n.fluid_video_wrapper {\n    position: relative;\n    display: inline-block;\n}\n\n.fluid_video_wrapper video {\n    position: relative;\n    background-color: #000000;\n    display: block;\n}\n\n.fluid_video_wrapper .vast_video_loading {\n    display: table;\n    text-align: center;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    pointer-events: auto;\n    z-index: 1;\n}\n\n.fluid_video_wrapper .vast_video_loading:before {\n    background-image: url("+v+");\n    background-position: center, center;\n    background-repeat: no-repeat, repeat;\n    background-color: rgba(0, 0, 0, 0.2);\n    content: '';\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n}\n\n.skip_button {\n    position: absolute;\n    bottom: 50px;\n    right: 0;\n    background-color: rgba(0, 0, 0, 0.7);\n    padding: 13px 21px 13px 21px;\n}\n\n.skip_button, .skip_button a {\n    color: #ffffff;\n    text-decoration: none;\n    cursor: pointer;\n    z-index: 10;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n    text-align: start;\n}\n\n.skip_button a span.skip_button_icon {\n    display: inline-block;\n    text-align: left;\n    width: 21px;\n    position: relative;\n    bottom: 20px;\n}\n\n.skip_button a span.skip_button_icon:before {\n    background: url("+m+') no-repeat;\n    position: absolute;\n    height: 18px;\n    width: 18px;\n    top: 6px;\n    content: "";\n    opacity: 0.8;\n    -webkit-transition: opacity 0.3s ease-in-out;\n    -moz-transition: opacity 0.3s ease-in-out;\n    -ms-transition: opacity 0.3s ease-in-out;\n    -o-transition: opacity 0.3s ease-in-out;\n    transition: opacity 0.3s ease-in-out;\n    background-position: -122px -57px;\n}\n\n.skip_button a span.skip_button_icon:before:hover {\n    opacity: 1;\n}\n\n.skip_button_disabled {\n    cursor: default !important;\n    padding: 13px 21px 13px 21px;\n}\n\n.close_button {\n    position: absolute;\n    background: #000000 url('+g+") no-repeat scroll center center;\n    height: 16px;\n    width: 16px;\n    top: 0;\n    right: 0;\n    background-size: 18px 18px;\n    cursor: pointer;\n    padding: 1px;\n    z-index: 31;\n}\n\n.close_button:hover {\n    background-color: #000000;\n    border: 1px solid #ffffff;\n}\n\n.vast_clickthrough_layer {\n    /*IE Fix*/\n    background-color: white;\n    opacity: 0;\n}\n\n.fluid_ad_playing {\n    position: absolute;\n    background-color: black;\n    opacity: 0.8;\n    border-radius: 1px;\n    color: #ffffff;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n    text-align: start;\n    line-height: 18px;\n    z-index: 10;\n    padding: 13px 21px 13px 21px;\n}\n\n.fluid_ad_cta {\n    position: absolute;\n    background-color: rgba(0, 0, 0, 0.7);\n    color: #ffffff;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    text-align: right;\n    cursor: pointer;\n    z-index: 10;\n    padding: 13px 21px 13px 13px;\n    max-width: 50%;\n}\n\n.fluid_ad_cta.left {\n    text-align: left;\n}\n\n.fluid_ad_cta a {\n    text-decoration: none;\n    color: #ffffff;\n    line-height: 18px;\n}\n\n.fluid_ad_cta:hover,\n.skip_button:not(.skip_button_disabled):hover {\n    background-color: rgba(0, 0, 0, 1);\n}\n\n.fluid_html_on_pause,\n.fluid_pseudo_poster {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    margin: auto;\n    z-index: 0;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    pointer-events: none;\n}\n\n.fluid_html_on_pause * {\n    pointer-events: auto;\n}\n\n/*Mobile Layout*/\n.fluid_video_wrapper.mobile .skip_button {\n    bottom: 50px;\n}\n\n/*\n.fluid_video_wrapper.mobile .fluid_ad_cta {\n        bottom: 125px;\n}\n*/\n.fluid_initial_play {\n    width: 60px;\n    height: 60px;\n    border-radius: 50px;\n    cursor: pointer;\n}\n\n.fluid_initial_play_button {\n    margin-top: 15px;\n    margin-left: 23px;\n    border-style: solid;\n    border-width: 15px 0 15px 21px;\n    border-color: transparent transparent transparent #ffffff;\n}\n\n.fluid_initial_pause_button {\n    margin-top: 15px;\n    margin-left: 17px;\n    width: 8px;\n    height: 31px;\n    border: 9px solid white;\n    border-top: 0;\n    border-bottom: 0;\n}\n\n.fluid_timeline_preview {\n    bottom: 11px;\n    color: #ffffff;\n    font-size: 13px;\n    line-height: 18px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    text-align: start;\n    padding: 13px 21px 13px 21px;\n    background-color: rgba(0, 0, 0, 0.85);\n    border-radius: 1px;\n}\n\n/* Duration */\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_fluid_control_duration {\n    display: inline-block;\n    position: absolute;\n    left: 32px;\n    height: 24px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-size: 13px;\n    font-weight: normal;\n    font-style: normal;\n    text-align: left;\n    text-decoration: none;\n    line-height: 21px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_fluid_control_duration.cardboard_time {\n    left: 13px;\n    top: -15px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_fluid_control_duration.cardboard_time .ad_timer_prefix {\n    color: #F2C94C;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .ad_countdown .ad_timer_prefix {\n    color: #F2C94C;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .ad_countdown {\n    /*display: none;*/\n    position: absolute;\n    right: 0;\n    width: 75px;\n    bottom: 5px;\n    height: 24px;\n    color: red;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-size: 13px;\n    font-weight: normal;\n    font-style: normal;\n    text-align: left;\n    text-decoration: none;\n    line-height: 21px;\n}\n\n.initial_controls_show {\n    visibility: visible !important;\n    opacity: 1 !important;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container {\n    color: white;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: -moz-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* FF3.6-15 */\n    background: -webkit-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* Chrome10-25,Safari5.1-6 */\n    background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#ad000000', GradientType=0); /* IE6-9 */\n    height: 100%;\n    width: 100%;\n    z-index: 0;\n    pointer-events: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel {\n    height: 96px;\n    width: 72px;\n    left: 10px;\n    top: 10px;\n    position: absolute;\n    background: rgba(0, 0, 0, 0.7);\n    text-align: center;\n    border-radius: 6px;\n    overflow: hidden;\n    pointer-events: auto;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_button {\n    cursor: pointer;\n    display: inline-block;\n    text-align: left;\n    height: 24px;\n    width: 24px;\n    position: relative;\n    background: url("+m+") no-repeat;\n    opacity: 0.8;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_button:hover {\n    opacity: 1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_up {\n    background-position: -336px -55px;\n    -webkit-transform: rotate(270deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(270deg); /* IE 9 */\n    transform: rotate(270deg); /* Firefox 16+, IE 10+, Opera  */\n    display: block;\n    left: calc(50% - 12px);\n    top: 0;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_left {\n    background-position: -336px -55px;\n    -webkit-transform: rotate(180deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(1890deg); /* IE 9 */\n    transform: rotate(180deg); /* Firefox 16+, IE 10+, Opera  */\n    display: block;\n    left: 0;\n    top: 24px;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_right {\n    background-position: -336px -55px;\n    -webkit-transform: rotate(0deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(0deg); /* IE 9 */\n    transform: rotate(0deg); /* Firefox 16+, IE 10+, Opera  */\n    display: block;\n    right: 0;\n    top: 24px;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_down {\n    background-position: -336px -55px;\n    -webkit-transform: rotate(90deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(90deg); /* IE 9 */\n    transform: rotate(90deg); /* Firefox 16+, IE 10+, Opera  */\n    display: block;\n    left: calc(50% - 12px);\n    top: 48px;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_zoomdefault {\n    background-position: -336px -17px;\n    top: 72px;\n    -webkit-transform: rotate(0deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(0deg); /* IE 9 */\n    transform: rotate(0deg); /* Firefox 16+, IE 10+, Opera  */\n    position: absolute;\n    left: calc(50% - 12px);\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_zoomin {\n    background-position: -305px -55px;\n    top: 72px;\n    -webkit-transform: rotate(0deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(0deg); /* IE 9 */\n    transform: rotate(0deg); /* Firefox 16+, IE 10+, Opera  */\n    position: absolute;\n    right: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_zoomout {\n    background-position: -305px -17px;\n    top: 72px;\n    -webkit-transform: rotate(0deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(0deg); /* IE 9 */\n    transform: rotate(0deg); /* Firefox 16+, IE 10+, Opera  */\n    position: absolute;\n    left: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.fluid_vr_controls_container {\n    width: 50% !important;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.fluid_vr2_controls_container {\n    width: 50% !important;\n    left: 50%;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container {\n    color: white;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: -moz-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* FF3.6-15 */\n    background: -webkit-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* Chrome10-25,Safari5.1-6 */\n    background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#ad000000', GradientType=0); /* IE6-9 */\n    height: 53px;\n    z-index: 1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vpaid_iframe {\n    position: absolute;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    left: 0;\n    z-index: -10;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vpaid_nonlinear_slot_iframe {\n    z-index: 30;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vpaid_slot {\n    position: absolute !important;\n    top: 0 !important;\n    width: 100% !important;\n    height: 100% !important;\n    left: 0 !important;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_subtitles_container {\n    color: white;\n    position: absolute;\n    bottom: 46px;\n    left: 0;\n    right: 0;\n    height: auto;\n    z-index: 1;\n    text-align: center;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_subtitles_container div {\n    display: inline;\n    background: black;\n    color: white;\n    font-size: 1em;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    padding: 0.25em;\n    border-radius: 4px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fade_out {\n    visibility: hidden;\n    opacity: 0;\n    -webkit-transition: visibility 0.5s, opacity 0.5s; /* Safari */\n    transition: visibility 0.5s, opacity 0.5s;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fade_in {\n    visibility: visible;\n    opacity: 1;\n    -webkit-transition: visibility 0.5s, opacity 0.5s; /* Safari */\n    transition: visibility 0.5s, opacity 0.5s;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default.pseudo_fullscreen {\n    width: 100% !important;\n    height: 100% !important;\n    top: 0;\n    left: 0;\n    position: fixed;\n    z-index: 99999;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default:-webkit-full-screen {\n    width: 100% !important;\n    height: 100% !important;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default:-ms-fullscreen {\n    width: 100% !important;\n    height: 100% !important;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu {\n    background-color: #000000;\n    color: #ffffff;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n    text-align: start;\n    z-index: 11;\n    opacity: 0.8;\n    border-radius: 1px;\n}\n\n/* IE 10+ */\n_:-ms-lang(x),\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu {\n    text-align: left;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu ul {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu ul li {\n    padding: 13px 71px 13px 21px;\n    cursor: pointer;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu ul li + li {\n    border-top: 1px solid #000000;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu ul li:hover {\n    background-color: #1e1e1e;\n    color: #fbfaff;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_left {\n    width: 24px;\n    left: 20px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.skip_controls .fluid_controls_left {\n    width: 80px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button {\n    width: 24px;\n    height: 24px;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right {\n    left: 60px;\n    right: 20px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.skip_controls .fluid_controls_right {\n    left: 110px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_left,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right {\n    position: absolute;\n    height: 24px;\n    top: 23px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container {\n    height: 14px;\n    position: absolute;\n    left: 13px;\n    right: 13px;\n    z-index: 1;\n    top: 8px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress {\n    position: absolute;\n    top: 5px;\n    width: 100%;\n    height: 4px;\n    background-color: rgba(255, 255, 255, 0.25);\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_buffered {\n    position: absolute;\n    top: 5px;\n    width: 0;\n    height: 3px;\n    background-color: rgba(255, 255, 255, 0.5);\n    z-index: -1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress .fluid_controls_currentprogress {\n    position: absolute;\n    height: 3px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container:hover .fluid_controls_progress,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container:hover .fluid_controls_buffered,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container:hover .fluid_controls_ad_markers_holder {\n    margin-top: -1px;\n    height: 5px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container:hover .fluid_controls_progress .fluid_controls_currentprogress {\n    height: 5px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_timeline_preview_container {\n    border: 1px solid #262626;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_timeline_preview_container, .fluid_timeline_preview_container_shadow {\n    bottom: 14px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_slider .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos {\n    background-color: white;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_slider .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_ad_slider .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos {\n    opacity: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_slider:hover .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos {\n    opacity: 1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_slider .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos {\n    -webkit-transition: opacity 0.3s; /* Safari */\n    transition: opacity 0.3s;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_ad_markers_holder {\n    position: absolute;\n    top: 5px;\n    width: 100%;\n    height: 3px;\n    z-index: 2;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_ad_marker {\n    position: absolute;\n    background-color: #FFCC00;\n    height: 100%;\n    width: 6px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container {\n    height: 24px;\n    width: 56px;\n    left: 25px;\n    top: -1px;\n    z-index: 2;\n    opacity: 0.8;\n    -webkit-transition: opacity 0.3s ease-in-out;\n    -moz-transition: opacity 0.3s ease-in-out;\n    -ms-transition: opacity 0.3s ease-in-out;\n    -o-transition: opacity 0.3s ease-in-out;\n    transition: opacity 0.3s ease-in-out;\n    display: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container:hover {\n    opacity: 1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container .fluid_control_volume {\n    position: relative;\n    height: 3px;\n    width: 100%;\n    margin-top: 10px;\n    background-color: rgba(171, 172, 172, 0.68);\n    z-index: 3;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container .fluid_control_volume .fluid_control_currentvolume {\n    float: left;\n    background-color: white;\n    height: 3px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container .fluid_control_volume .fluid_control_currentvolume .fluid_control_volume_currentpos {\n    background-color: white;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress .fluid_controls_currentpos {\n    right: -4px;\n    z-index: 3;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container .fluid_control_volume .fluid_control_currentvolume .fluid_control_volume_currentpos,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress .fluid_controls_currentpos {\n    width: 11px;\n    height: 11px;\n    position: absolute;\n    top: -4px;\n    border-radius: 6px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress .fluid_controls_currentpos {\n    width: 13px;\n    height: 13px;\n    position: absolute;\n    top: -4px;\n    border-radius: 6px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.no_volume_bar .fluid_controls_right .fluid_control_volume_container {\n    display: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_slider {\n    cursor: pointer;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container div div {\n    display: block;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_fullscreen,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_fullscreen_exit {\n    float: right;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_cardboard {\n    font-size: 13px;\n    height: 24px;\n    line-height: 24px;\n    float: right;\n    cursor: pointer;\n    position: relative;\n    text-align: right;\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_title,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_title {\n    width: 80px;\n    overflow: hidden;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_list,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_list,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_video_playback_rates {\n    position: absolute;\n    bottom: 25px;\n    right: 3px;\n    z-index: 888888;\n    opacity: 99%;\n    background-color: rgba(0, 0, 0, 1);\n    border-radius: 2px;\n    color: #ffffff;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n    text-align: start;\n    width: max-content;\n    padding: 0.5em;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_list .fluid_subtitle_list_item,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_list .fluid_video_source_list_item {\n    padding: 12px 34px 12px 24px;\n    line-height: 15px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_list .fluid_video_source_list_item:hover,\n.fluid_video_playback_rates_item:hover,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_list .fluid_subtitle_list_item:hover {\n    background-color: #3a3a3a;\n}\n\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_volume,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_mute {\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_volume,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_mute {\n    left: -10px;\n}\n\n/* Button Icons */\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_play,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_pause,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_forward,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_volume,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mute,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen_exit,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard {\n    display: inline-block;\n    text-align: left;\n    height: 24px;\n    width: 24px;\n    position: relative;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_play:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_pause:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_forward:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_volume:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mute:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen_exit:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard:before {\n    background: url("+m+') no-repeat;\n    position: absolute;\n    height: 24px;\n    width: 24px;\n    top: 1px;\n    left: 5px;\n    content: "";\n    opacity: 0.8;\n    -webkit-transition: opacity 0.3s ease-in-out;\n    -moz-transition: opacity 0.3s ease-in-out;\n    -ms-transition: opacity 0.3s ease-in-out;\n    -o-transition: opacity 0.3s ease-in-out;\n    transition: opacity 0.3s ease-in-out;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_play:before {\n    background-position: -15px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_pause:before {\n    background-position: -15px -57px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_volume:before {\n    background-position: -52px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mute:before {\n    background-position: -52px -57px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen:before {\n    background-position: -88px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen_exit:before {\n    background-position: -88px -57px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source:before {\n    background-position: -122px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate:before {\n    background-position: -232px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download:before {\n    background-position: -194px -18px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre:before {\n    background-position: -195px -56px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles:before {\n    background-position: -269px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard:before {\n    background-position: -269px -56px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back:before {\n    background: url('+h+") no-repeat;\n    background-position: -2px -2px;\n}\n\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_forward:before {\n    background: url("+b+") no-repeat;\n    background-position: -2px -2px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back {\n    margin-left: 5px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen_exit:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mute:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_volume:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_pause:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_play:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_forward:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard:hover:before {\n    opacity: 1;\n}\n\n.fp_title {\n    position: absolute;\n    top: 10px;\n    left: 10px;\n    color: #ffffff;\n    font-size: 15px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n}\n\n/* Pulse class and keyframe animation */\n.transform-active {\n    animation: flash 1s infinite;\n    display: inline-block !important;\n    opacity: 0;\n}\n\n@-webkit-keyframes flash {\n    0% {\n        opacity: 0.6;\n        -webkit-box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.5);\n    }\n    70% {\n        -webkit-box-shadow: 0 0 0 20px rgba(255, 255, 255, 0);\n    }\n    100% {\n        opacity: 0;\n        display: none;\n        -webkit-box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);\n    }\n}\n\n@keyframes flash {\n    0% {\n        opacity: 0.6;\n        -moz-box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.5);\n        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.6);\n    }\n    70% {\n        -moz-box-shadow: 0 0 0 20px rgba(255, 255, 255, 0);\n        box-shadow: 0 0 0 20px rgba(255, 255, 255, 0);\n    }\n    100% {\n        opacity: 0;\n        display: none;\n        -moz-box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);\n        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);\n    }\n}\n\n.fluid_nonLinear_top, .fluid_nonLinear_middle, .fluid_nonLinear_bottom {\n    flex-direction: column;\n    align-items: center;\n    cursor: pointer;\n    display: flex;\n    vertical-align: middle;\n    align-content: center;\n    border: 1px solid #777777;\n    position: absolute;\n    left: 50%;\n    margin-right: -50%;\n    background-color: rgba(0, 0, 0, 0.7);\n}\n\n.fluid_nonLinear_top {\n    top: 20px;\n    transform: translate(-50%);\n}\n\n.fluid_nonLinear_middle {\n    top: 50%;\n    transform: translate(-50%, -50%);\n}\n\n.fluid_nonLinear_bottom {\n    bottom: 50px;\n    transform: translate(-50%);\n}\n\n.fluid_vpaidNonLinear_top, .fluid_vpaidNonLinear_middle, .fluid_vpaidNonLinear_bottom {\n    flex-direction: column;\n    align-items: center;\n    cursor: pointer;\n    vertical-align: middle;\n    align-content: center;\n    position: absolute;\n    display: flex;\n}\n\n.fluid_vpaidNonLinear_frame {\n    margin: auto;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fluid_vpaidNonLinear_top {\n    top: 20px;\n}\n\n.fluid_vpaidNonLinear_middle {\n    top: 50%;\n}\n\n.fluid_vpaidNonLinear_bottom {\n    bottom: 50px;\n}\n\n.add_icon_clickthrough {\n    color: #F2C94C;\n    line-height: 18px;\n    text-overflow: ellipsis;\n    max-width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n    display: inline-block;\n}\n\n.add_icon_clickthrough:before {\n    background: url("+m+') no-repeat;\n    height: 18px;\n    width: 18px;\n    top: 30px;\n    padding: 3px 22px 0 0;\n    content: "";\n    background-position: -162px -57px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard {\n    float: right;\n    padding-right: 5px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard {\n    display: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_list,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_list,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_video_playback_rates {\n    z-index: 888888 !important;\n    opacity: 0.9 !important;\n}\n\n.fluid_video_playback_rates_item {\n    padding: 9px 25px 9px 25px;\n    line-height: 15px;\n    text-align: center;\n}\n\n.fluid_theatre_mode {\n    position: fixed;\n    float: left;\n    top: 0;\n    z-index: 10;\n    box-shadow: 0px 15px 25px rgba(0, 0, 0, 0.8);\n}\n\n.source_button_icon {\n    background: url('+m+") no-repeat;\n    float: left;\n    cursor: pointer;\n    height: 18px;\n    width: 18px;\n    background-position: -164px -21px;\n    opacity: 0;\n}\n\n.subtitle_button_icon {\n    background: url("+m+") no-repeat;\n    float: left;\n    cursor: pointer;\n    height: 18px;\n    width: 18px;\n    background-position: -164px -21px;\n    opacity: 0;\n}\n\n.source_selected {\n    opacity: 1 !important;\n}\n\n.subtitle_selected {\n    opacity: 1 !important;\n}\n\n@media only screen and (min-device-width: 375px) {\n    .fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_fluid_control_duration {\n        left: 105px;\n    }\n\n    .fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.no_volume_bar .fluid_fluid_control_duration {\n        left: 32px;\n    }\n\n    .fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container {\n        display: block;\n    }\n}\n\n.fp_logo {\n    visibility: hidden;\n    opacity: 0;\n    -webkit-transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n    -moz-transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n    -ms-transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n    -o-transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n    transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n}\n\n.fp_hd_source::before {\n    font-weight: bolder;\n    font-size: 6pt;\n    content: 'HD';\n    padding-left: 3px;\n}\n",""]),t.Z=y},645:667:81:702:function(e,t,n){e.exports=function(){"use strict";ar t=Array.isArray?Array.isArray:o=0,i=void 0,r=void 0,a=l="undefined"!=typeof window?window:void 0,d=l||{},s=d.MutationObserver||d.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"===({}).toString.call(process),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;ar f=Array(1e3);ar v,m,g,h,b=void 0;u?function(){return process.nextTick(y)}:s?(m=0,g=new s(y),h=document.createTextNode(""),g.observe(h,{characterData:!0}),:c?((v=new MessageChannel).port1.onmessage=y,:void 0===l?):p();var C=Math.random().toString(36).substring(2);function A(){}var k=void 0;function I(t,n,o){var i,r,l,d,s;n.constructor===t.constructor&&o===$&&n.constructor.resolve===w?(i=t,1===(r=n)._state?P(i,r._result):2===r._state?E(i,r._result):_(r,void 0,function(e){return x(i,e)},function(e){return E(i,e)})):void 0===o?P(t,n):e(o)?(l=t,d=n,s=o,a(l)):P(t,n)}function x(e,t){if(e===t)E(e,TypeError("You cannot resolve a promise with itself"));else if(o=typeof(n=t),null===n||"object"!==o&&"function"!==o)P(e,t);else{var n,o,i=void 0;try{i=t.then}catch(r){return void E(e,r)}I(e,t,i)}}0;ar S=),N=);return N.prototype.then=$,N.all=N.race=N.resolve=w,N.reject=N._setScheduler=function(e){r=e},N._setAsap=function(e){a=e},N._asap=a,N.polyfill=N.Promise=N,N}()},379:function(e){"use strict";var t=[];nction i(e,t){var n=t.domAPI(t);return n.update(e),e.exports=,569:function(e){"use strict";var t={};e.exports=function(e,n){var o=e);if(!o)throw Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},216:565:795:function(e){"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){var o,i,r,a,l,d;o=t,i=e,a="",(r=n).supports&&(a+="@supports (".concat(r.supports,") {")),r.media&&(a+="@media ".concat(r.media," {")),(l=void 0!==r.layer)&&(a+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),a+=r.css,l&&(a+="}"),r.media&&(a+="}"),r.supports&&(a+="}"),(d=r.sourceMap)&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(d))))," */")),i.styleTagTransform(a,o,i.options)},remove:}},589:373:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGIiBoZWlnaHQ9IjI0IiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQogICAgPHBhdGggZD0iTTE5IDYuNDFMMTcuNTkgNSAxMiAxMC41OSA2LjQxIDUgNSA2LjQxIDEwLjU5IDEyIDUgMTcuNTkgNi40MSAxOSAxMiAxMy40MSAxNy41OSAxOSAxOSAxNy41OSAxMy40MSAxMnoiLz4NCiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+DQo8L3N2Zz4NCg=="},924:858:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0ibGRzLWVjbGlwc2UiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBzdHlsZT0iYmFja2dyb3VuZDowIDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIg0KICAgICB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgICA8cGF0aCBkPSJNNjguMDk1IDU5LjU3OEEyMCAyMCAwIDAwMzEuMTQgNDQuMjdhMjIgMjAtNjcuNSAwMTM2Ljk1NSAxNS4zMDgiIGZpbGw9IiNmZmYiPg0KICAgICAgICA8YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIGJlZ2luPSIwcyIgY2FsY01vZGU9ImxpbmVhciIgZHVyPSIwLjhzIiBrZXlUaW1lcz0iMDsxIg0KICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdHlwZT0icm90YXRlIiB2YWx1ZXM9IjAgNTAgNTE7MzYwIDUwIDUxIi8+DQogICAgPC9wYXRoPg0KPC9zdmc+DQo="},212:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0id2hpdGUiIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiPg0KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMFYweiIgZmlsbD0ibm9uZSIvPg0KICAgIDxwYXRoDQogICAgICAgIGQ9Ik0xMS45OSA1VjFsLTUgNSA1IDVWN2MzLjMxIDAgNiAyLjY5IDYgNnMtMi42OSA2LTYgNi02LTIuNjktNi02aC0yYzAgNC40MiAzLjU4IDggOCA4czgtMy41OCA4LTgtMy41OC04LTgtOHptLTEuMSAxMWgtLjg1di0zLjI2bC0xLjAxLjMxdi0uNjlsMS43Ny0uNjNoLjA5VjE2em00LjI4LTEuNzZjMCAuMzItLjAzLjYtLjEuODJzLS4xNy40Mi0uMjkuNTctLjI4LjI2LS40NS4zMy0uMzcuMS0uNTkuMS0uNDEtLjAzLS41OS0uMS0uMzMtLjE4LS40Ni0uMzMtLjIzLS4zNC0uMy0uNTctLjExLS41LS4xMS0uODJ2LS43NGMwLS4zMi4wMy0uNi4xLS44MnMuMTctLjQyLjI5LS41Ny4yOC0uMjYuNDUtLjMzLjM3LS4xLjU5LS4xLjQxLjAzLjU5LjEuMzMuMTguNDYuMzMuMjMuMzQuMy41Ny4xMS41LjExLjgydi43NHptLS44NS0uODZjMC0uMTktLjAxLS4zNS0uMDQtLjQ4cy0uMDctLjIzLS4xMi0uMzEtLjExLS4xNC0uMTktLjE3LS4xNi0uMDUtLjI1LS4wNS0uMTguMDItLjI1LjA1LS4xNC4wOS0uMTkuMTctLjA5LjE4LS4xMi4zMS0uMDQuMjktLjA0LjQ4di45N2MwIC4xOS4wMS4zNS4wNC40OHMuMDcuMjQuMTIuMzIuMTEuMTQuMTkuMTcuMTYuMDUuMjUuMDUuMTgtLjAyLjI1LS4wNS4xNC0uMDkuMTktLjE3LjA5LS4xOS4xMS0uMzIuMDQtLjI5LjA0LS40OHYtLjk3eiIvPg0KPC9zdmc+DQo="},928:,d={};.m=l,s.n=i=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},s.t=s.d=s.f={},s.e=s.u=s.g=),s.o=r={},a="fluid-player:",s.l=function(e,t,n,o){if(r[e])r[e].push(t);else{if(void 0!==n)for(var i,l,d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==a+n){i=c;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.setAttribute("data-webpack",a+n),i.src=e),r[e]=[t];var p=f=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),l&&document.head.appendChild(i)}},s.r=s.p="https://cdn.fluidplayer.com/v3/current/",s.b=document.baseURI||self.location.href,e={772:0},s.f.j=t=(n=self.webpackChunkfluid_player=self.webpackChunkfluid_player||[]).forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n)),s.nc=void 0,function(){"use strict";var e=s(702),t=s.n(e);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){o=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",d=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(c){u=function(e,t,n){return e[t]=n}}function p(e,t,n,o){var i,a,l,d,s=Object.create((t&&t.prototype instanceof v?t:v).prototype);return r(s,"_invoke",{value:(i=e,a=n,l=new L(o||[]),d="suspendedStart",function(e,t){if("executing"===d)throw Error("Generator is already running");if("completed"===d){if("throw"===e)throw t;return{value:void 0,done:!0}}for(l.method=e,l.arg=t;;){var n=l.delegate;if(n){var o=k(n,l);if(o){if(o===y)continue;return o}}if("next"===l.method)l.sent=l._sent=l.arg;else if("throw"===l.method){if("suspendedStart"===d)throw d="completed",l.arg;l.dispatchException(l.arg)}else"return"===l.method&&l.abrupt("return",l.arg);d="executing";var r=f(i,a,l);if("normal"===r.type){if(d=l.done?"completed":"suspendedYield",r.arg===y)continue;return{value:r.arg,done:l.done}}"throw"===r.type&&(d="completed",l.method="throw",l.arg=r.arg)}})}),s}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(o){return{type:"throw",arg:o}}}e.wrap=p;var y={};function v(){}function m(){}function g(){}var h={};u(h,l,function(){return this});var b=Object.getPrototypeOf,$=b&&b(b(P([])));$&&$!==t&&i.call($,l)&&(h=$);var w=g.prototype=v.prototype=Object.create(h);function C(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function A(e,t){var o;r(this,"_invoke",{value:function(r,a){function l(){return new t(function(o,l){(function o(r,a,l,d){var s=f(e[r],e,a);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==n(c)&&i.call(c,"__await")?t.resolve(c.__await).then(function(e){o("next",e,l,d)},function(e){o("throw",e,l,d)}):t.resolve(c).then(function(e){u.value=e,l(u)},function(e){return o("throw",e,l,d)})}d(s.arg)})(r,a,o,l)})}return o=o?o.then(l,l):l()}})}function k(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,y;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,y):r:(t.method="throw",t.arg=TypeError("iterator result is not an object"),t.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function P(e){if(e){var t=e[l];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return m.prototype=g,r(w,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:m,configurable:!0}),m.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},C(A.prototype),u(A.prototype,d,function(){return this}),e.AsyncIterator=A,e.async=function(t,n,o,i,r){void 0===r&&(r=Promise);var a=new A(p(t,n,o,i),r);return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},C(w),u(w,s,"Generator"),u(w,l,function(){return this}),u(w,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,o){return a.type="throw",a.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],a=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var l=i.call(r,"catchLoc"),d=i.call(r,"finallyLoc");if(l&&d){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!d)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var i=o.arg;x(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),y}},e}unction r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,o){var i,r;return(t=(r=i=t),"symbol"===n(r)?r:String(r)))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}unction u(e,t,n,o,i,r,a){try{var l=e[r](a),d=l.value}catch(s){return void n(s)}l.done?t(d):Promise.resolve(d).then(o,i)}unction p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function v(){v=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";ry{d({},"")}catch(s){d=function u(e,t,n,i){var r,a,l,d,s=Object.create((t&&t.prototype instanceof f?t:f).prototype);return o(s,"_invoke",{value:(r=e,a=n,l=new L(i||[]),d="suspendedStart",function(e,t){if("executing"===d)throw Error("Generator is already running");if("completed"===d){if("throw"===e)throw t;return{value:void 0,done:!0}}for(l.method=e,l.arg=t;;){var n=l.delegate;if(n){var o=k(n,l);if(o){if(o===p)continue;return o}}if("next"===l.method)l.sent=l._sent=l.arg;else if("throw"===l.method){if("suspendedStart"===d)throw d="completed",l.arg;l.dispatchException(l.arg)}else"return"===l.method&&l.abrupt("return",l.arg);d="executing";var i=c(r,a,l);if("normal"===i.type){if(d=l.done?"completed":"suspendedYield",i.arg===p)continue;return{value:i.arg,done:l.done}}"throw"===i.type&&(d="completed",l.method="throw",l.arg=i.arg)}})}),s}.wrap=u;var p={};function f(){}function y(){}function m(){}var g={};d(g,r,function(){return this});var h=Object.getPrototypeOf,$=h&&h(h(P([])));$&&$!==t&&n.call($,r)&&(g=$);var w=m.prototype=f.prototype=Object.create(g);unction A(e,t){var i;o(this,"_invoke",{value:function(o,r){function a(){return new t(function(i,a){((o,r,i,a)})}return i=i?i.then(a,a):a()}})} y.prototype=m,o(w,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:y,configurable:!0}),y.displayName=d(m,l,"GeneratorFunction"),e.isGeneratorFunction=e.mark=e.awrap=C(A.prototype),d(A.prototype,a,function(){return this}),e.AsyncIterator=A,e.async=C(w),d(w,l,"Generator"),d(w,r,,d(w,"toString",,e.keys=e.values=P,L.prototype={constructor:L,reset:stop:dispatchException:abrupt:complete:finish:catch:delegateYield:,e}unction g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}unction"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:writable:!0,configurable:!0}),),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(,t().polyfill(),"undefined"==typeof window||window.dashjs||(window.dashjs={skipAutoCreate:!0,isDefaultSubject:!0});var $=[function(e,t){var n={AdStarted:function(){return e.onStartVpaidAd},AdStopped:function(){return e.onStopVpaidAd},AdSkipped:function(){return e.onSkipVpaidAd},AdLoaded:function(){return e.onVpaidAdLoaded},AdLinearChange:function(){return e.onVpaidAdLinearChange},AdSizeChange:function(){return e.onVpaidAdSizeChange},AdExpandedChange:function(){return e.onVpaidAdExpandedChange},AdSkippableStateChange:function(){return e.onVpaidAdSkippableStateChange},AdDurationChange:function(){return e.onVpaidAdDurationChange},AdRemainingTimeChange:function(){return e.onVpaidAdRemainingTimeChange},AdVolumeChange:function(){return e.onVpaidAdVolumeChange},AdImpression:function(){return e.onVpaidAdImpression},AdClickThru:function(){return e.onVpaidAdClickThru},AdInteraction:function(){return e.onVpaidAdInteraction},AdVideoStart:function(){return e.onVpaidAdVideoStart},AdVideoFirstQuartile:function(){return e.onVpaidAdVideoFirstQuartile},AdVideoMidpoint:function(){return e.onVpaidAdVideoMidpoint},AdVideoThirdQuartile:function(){return e.onVpaidAdVideoThirdQuartile},AdVideoComplete:function(){return e.onVpaidAdVideoComplete},AdUserAcceptInvitation:function(){return e.onVpaidAdUserAcceptInvitation},AdUserMinimize:function(){return e.onVpaidAdUserMinimize},AdUserClose:function(){return e.onVpaidAdUserClose},AdPaused:function(){return e.onVpaidAdPaused},AdPlaying:function(){return e.onVpaidAdPlaying},AdError:function(){return e.onVpaidAdError},AdLog:function(){return e.onVpaidAdLog}};e.checkVPAIDInterface=e.onVpaidAdPaused=function(){e.vpaidTimeoutTimerClear(),e.debugMessage("onAdPaused")},e.onVpaidAdPlaying=e.onVpaidAdError=e.onVpaidAdLog=function(t){e.debugMessage("onAdLog: "+t)},e.onVpaidAdUserAcceptInvitation=function(){e.debugMessage("onAdUserAcceptInvitation")},e.onVpaidAdUserMinimize=function(){e.debugMessage("onAdUserMinimize")},e.onVpaidAdUserClose=function(){e.debugMessage("onAdUserClose")},e.onVpaidAdSkippableStateChange=function(){e.vpaidAdUnit&&e.debugMessage("Ad Skippable State Changed to: "+e.vpaidAdUnit.getAdSkippableState())},e.onVpaidAdExpandedChange=function(){e.vpaidAdUnit&&e.debugMessage("Ad Expanded Changed to: "+e.vpaidAdUnit.getAdExpanded())},e.getVpaidAdExpanded=function(){if(e.debugMessage("getAdExpanded"),e.vpaidAdUnit)return e.vpaidAdUnit.getAdExpanded()},e.getVpaidAdSkippableState=function(){if(e.debugMessage("getAdSkippableState"),e.vpaidAdUnit)return e.vpaidAdUnit.getAdSkippableState()},e.onVpaidAdSizeChange=e.onVpaidAdDurationChange=function(){e.vpaidAdUnit&&e.debugMessage("Ad Duration Changed to: "+e.vpaidAdUnit.getAdDuration())},e.onVpaidAdRemainingTimeChange=function(){e.vpaidAdUnit&&e.debugMessage("Ad Remaining Time Changed to: "+e.vpaidAdUnit.getAdRemainingTime())},e.getVpaidAdRemainingTime=e.onVpaidAdImpression=function(){e.debugMessage("Ad Impression"),e.trackSingleEvent("impression")},e.onVpaidAdClickThru=e.onVpaidAdInteraction=function(t){e.debugMessage("A non-clickthrough event has occured")},e.onVpaidAdVideoStart=function(){e.debugMessage("Video 0% completed"),e.trackSingleEvent("start")},e.onVpaidAdVideoFirstQuartile=function(){e.debugMessage("Video 25% completed"),e.trackSingleEvent("firstQuartile")},e.onVpaidAdVideoMidpoint=function(){e.debugMessage("Video 50% completed"),e.trackSingleEvent("midpoint")},e.onVpaidAdVideoThirdQuartile=function(){e.debugMessage("Video 75% completed"),e.trackSingleEvent("thirdQuartile")},e.onVpaidAdVideoComplete=e.onVpaidAdLinearChange=function(){var t=document.getElementsByClassName("fluid_vpaidNonLinear_ad")[0],n=document.getElementById("close_button_"+e.videoPlayerId),o=t.getAttribute("adlistid");if(e.debugMessage("Ad linear has changed: "+e.vpaidAdUnit.getAdLinear()),e.vpaidAdUnit.getAdLinear()){e.backupMainVideoContentTime(o.split("_")[0]),e.isCurrentlyPlayingAd=!0,n&&n.remove(),t.className="fluid_vpaid_slot",t.id=e.videoPlayerId+"_fluid_vpaid_slot",e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls");for(var i=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress"),r=0;r<i.length;r++)i[r].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;e.toggleLoader(!1)}},e.getVpaidAdLinear=e.startVpaidAd=e.onVpaidAdLoaded=function(){e.debugMessage("ad has been loaded"),e.vpaidTimeoutTimerClear(),e.startVpaidAd()},e.onStartVpaidAd=function(){e.debugMessage("Ad has started"),e.vpaidTimeoutTimerClear()},e.stopVpaidAd=e.hardStopVpaidAd=function(t){e.vpaidAdUnit&&(e.vpaidAdUnit.stopAd(),e.vpaidAdUnit=null);for(var n=document.getElementsByClassName("fluid_vpaid_iframe"),o=document.getElementsByClassName("fluid_vpaid_slot"),i=document.getElementsByClassName("fluid_vpaidNonLinear_ad"),r=0;r<n.length;r++)n[r].getAttribute("adListId")!==t.id&&n[r].remove();for(var a=0;a<o.length;a++)o[a].getAttribute("adListId")!==t.id&&o[a].remove();for(var l=0;l<i.length;l++)i[l].getAttribute("adListId")!==t.id&&i[l].remove()},e.onStopVpaidAd=function(){e.debugMessage("Ad has stopped"),e.vpaidTimeoutTimerClear(),e.onVpaidEnded()},e.onSkipVpaidAd=e.skipVpaidAd=e.setVpaidAdVolume=e.getVpaidAdVolume=e.onVpaidAdVolumeChange=e.resizeVpaidAuto=e.resizeVpaidAd=e.pauseVpaidAd=function(){e.vpaidTimeoutTimerStart(),e.vpaidAdUnit&&e.vpaidAdUnit.pauseAd()},e.resumeVpaidAd=e.expandVpaidAd=function(){e.vpaidAdUnit&&e.vpaidAdUnit.expandAd()},e.collapseVpaidAd=e.vpaidTimeoutTimerClear=e.vpaidTimeoutTimerStart=e.vpaidCallbackListenersAttach=e.vpaidCallbackListenersDetach=e.loadVpaid=function(t,n){var o=document.createElement("iframe");o.id=e.videoPlayerId+"_"+t.id+"_fluid_vpaid_iframe",o.className="fluid_vpaid_iframe",o.setAttribute("adListId",t.id),o.setAttribute("frameborder","0"),e.domRef.player.parentNode.insertBefore(o,e.domRef.player.nextSibling),o.contentWindow.document.write('<script src="'+n+'"></script>'),e.tempVpaidCounter=0,e.getVPAIDAdInterval=setInterval(function(){var n=o.contentWindow.getVPAIDAd;if(n&&"function"==typeof n)e.vpaidAdUnit&&e.hardStopVpaidAd(t),e.vpaidAdUnit=n(),clearInterval(e.getVPAIDAdInterval),e.checkVPAIDInterface(e.vpaidAdUnit)&&(e.getVpaidAdLinear()?(e.isCurrentlyPlayingAd=!0,e.switchPlayerToVpaidMode(t)):(e.debugMessage("non linear vpaid ad is loaded"),e.loadVpaidNonlinearAssets(t)));else{if(e.tempVpaidCounter++,e.tempVpaidCounter>=20)return clearInterval(e.getVPAIDAdInterval),e.rollsById[t.rollListId].error=!0,e.playMainVideoWhenVpaidFails(403),!1;e.debugMessage(e.tempVpaidCounter)}},100)},e.onVpaidEnded=function(t){if(t&&t.stopImmediatePropagation(),e.vpaidAdUnit){var n=document.getElementById(e.videoPlayerId+"_fluid_vpaid_slot");e.vpaidCallbackListenersDetach(),e.vpaidAdUnit=null,clearInterval(e.getVPAIDAdInterval),n&&n.remove(),e.checkForNextAd()}},e.playMainVideoWhenVpaidFails=,function(e,t){function n(e){var t,n=e);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(void 0===o.data.attributes.sequence)return[o]}}catch(i){n.e(i)}finally{n.f()}return[]}unction l(){var t;return t=o().mark(function t(l,d){var s,u,c,p,f,y,v,m,g,h,b,$,w,C,A,k,I,x,L,P=arguments;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=P.length>3&&void 0!==P[3]?P[3]:0,u=!(P.length>4&&void 0!==P[4])||P[4],c=a(a({},P.length>2&&void 0!==P[2]?P[2]:{}),{},{children:[]}),t.next=6,e.sendRequestAsync(l,!0,e.displayOptions.vastOptions.vastTimeout);case 6:y=Array.from((f=(p=t.sent).responseXML).getElementsByTagName("Ad")),v=0,m=y;case 10:if(!(v<m.length)){t.next=39;break}if(g=m[v],h=e.getVastAdTagUriFromWrapper(g),b=void 0!==g.attributes.sequence,$={data:g},!(h&&s<=d&&u)){t.next=35;break}return k=(A=(C=i(w=g.getElementsByTagName("Wrapper"),1))[0]).attributes.followAdditionalWrappers&&["false","0"].includes(A.attributes.followAdditionalWrappers.value),I=A.attributes.allowMultipleAds&&["true","1"].includes(A.attributes.allowMultipleAds.value),x=A.attributes.fallbackOnNoAd&&["true","1"].includes(A.attributes.fallbackOnNoAd.value),t.prev=20,t.next=23,r(h,d,a(a({type:"wrapper"},$),{},{fallbackOnNoAd:x}),s+1,!k);case 23:(L=t.sent).fallbackOnNoAd=x,I&&!b||(L.children=n(L.children)),c.children.push(L),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(20),c.children.push({type:"wrapper",fallbackOnNoAd:x,httpError:!0}),e.debugMessage("Error when loading Wrapper, will trigger fallback if available",t.t0);case 33:t.next=36;break;case 35:h||c.children.push(a({type:"ad"},$));case 36:v++,t.next=10;break;case 39:return t.abrupt("return",c);case 40:case"end":return t.stop()}},t,null,[[20,29]])}),(l=function(){var e=this,n=arguments;return new Promise(function(o,i){var r=t.apply(e,n);function a(e){u(r,o,i,a,l,"next",e)}function l(e){u(r,o,i,a,l,"throw",e)}a(void 0)})}).apply(this,arguments)}e.setCTAFromVast=e.getClickThroughUrlFromLinear=e.getVastAdTagUriFromWrapper=e.hasInLine=function(e){var t=e.getElementsByTagName("InLine");return void 0!==t&&t.length},e.hasVastAdTagUri=e.getClickThroughUrlFromNonLinear=e.getTrackingFromLinear=function(e){var t=e.getElementsByTagName("TrackingEvents");return t.length?t[0].getElementsByTagName("Tracking"):[]},e.getDurationFromLinear=e.getDurationFromNonLinear=e.getDimensionFromNonLinear=e.getCreativeTypeFromStaticResources=e.getMediaFilesFromLinear=e.getStaticResourcesFromNonLinear=e.extractNodeDataByTagName=e.extractNodeData=e.getAdParametersFromLinear=e.getMediaFileListFromLinear=e.getIconClickThroughFromLinear=e.getStaticResourceFromNonLinear=e.registerTrackingEvents=e.registerClickTracking=e.registerImpressionEvents=e.registerErrorEvents=e.announceError=e.getClickTrackingEvents=e.getNonLinearClickTrackingEvents=e.callUris=e.recalculateAdDimensions=e.prepareVast=e.playMainVideoWhenVastFails=e.switchPlayerToVastMode=function(){},e.processVastWithRetries=function(t){var n=t.vastTag,o=t.id;e.processUrl(n,function i(r,a){if(r&&Array.isArray(a)&&!e.displayOptions.vastOptions.allowVPAID&&a.some(function(e){return e.vpaid})&&(a=a.filter(,e.announceLocalError("103","VPAID not allowed, so skipping this VAST tag.")),r&&Array.isArray(a)&&a.length){e.adPool[o]=[],a.forEach(function(t,n){if(t.id=o+"_AD"+n,t.rollListId=o,"linear"===t.adType){void 0!==t.iconClick&&null!==t.iconClick&&t.iconClick.length&&(t.landingPage=t.iconClick);var i=e.getSupportedMediaFileObject(t.mediaFileList);i&&(t.mediaType=i.mediaType)}t.adType=t.adType?t.adType:"unknown",e.adPool[o].push(Object.assign({},t)),e.hasTitle()&&(document.getElementById(e.videoPlayerId+"_title").style.display="none"),e.rollsById[o].ads.push(t)}),e.rollsById[o].vastLoaded=!0;var l=document.createEvent("Event");l.initEvent("adId_"+o,!1,!0),e.domRef.player.dispatchEvent(l),e.displayOptions.vastOptions.vastAdvanced.vastLoadedCallback()}else e.announceLocalError("101"),t.hasOwnProperty("fallbackVastTags")&&t.fallbackVastTags.length>0?(n=t.fallbackVastTags.shift(),e.processUrl(n,i,o)):("preRoll"===t.roll&&e.preRollFail(t),e.rollsById[o].error=!0)},o)},e.processUrl=e.resolveVastTag=function(t,n,o,l,s){if(!t||""===t)return l(!1);r(t,e.displayOptions.vastOptions.maxAllowedVastTagRedirects).then(function(t){try{var n,r,u,c,p,f,y,v=t.children.some(;v&&e.debugMessage("Error on VAST Wrapper, triggering fallbackOnNoAd. Ad tree:",t);var m=(n=t=(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Array.isArray(t.children)&&t.children.length&&t.children.forEach(,"ad"===t.type&&n.push(a(a({},t),{},{wrappers:o.filter(Boolean)})),n})(t).map(function(t){var n,r,l;return (n=t,r=o,(l=a(a({},n),JSON.parse(JSON.stringify(r)))).adType=(l.data.getElementsByTagName("Linear").length?"linear":l.data.getElementsByTagName("NonLinearAds").length&&"nonLinear")||"unknown",[].concat(d(l.wrappers||[]),[l.data]).filter(Boolean).forEach(,l.sequence=l.data.attributes.sequence?Number(l.data.attributes.sequence.value):null,l.played=!1,l))}),r=e.rollsById[s].maxTotalDuration||Number.MAX_SAFE_INTEGER,u=e.rollsById[s].maxTotalQuantity||Number.MAX_SAFE_INTEGER,c=v,p=n.filter(.sort(function(e,t){return e.sequence-t.sequence}).reduce({adPod:[],totalDuration:0}).adPod,f=n.filter(,y=p.map(function(e){return e.adType}).slice(0,-1).every(,p.length>0&&!c&&y?(e.debugMessage("Playing valid adPod",p),p):(e.debugMessage("Trying to play single ad, adBuffet:",f),f.length>0?[f[0]]:[]));m&&m.length?l(!0,m):l(!1)}catch(g){l(!1)}}).catch(},e.setVastList=function(){var t,n,o={},i={preRoll:[],postRoll:[],midRoll:[],onPauseRoll:[]},r={id:null,roll:null,vastLoaded:!1,error:!1,adText:null,adTextPosition:null},a=0;if(e.displayOptions.vastOptions.hasOwnProperty("adList"))for(var l in e.displayOptions.vastOptions.adList){var d=e.displayOptions.vastOptions.adList[l];if(n=void 0,n=!1,(t=d).vastTag||(e.announceLocalError(102,'"vastTag" property is missing from adList.'),n=!0),t.roll||(e.announceLocalError(102,'"roll" is missing from adList.'),n=!0),-1===e.availableRolls.indexOf(t.roll)&&(e.announceLocalError(102,"Only "+e.availableRolls.join(",")+" rolls are supported."),n=!0),t.size&&-1===e.supportedNonLinearAd.indexOf(t.size)&&(e.announceLocalError(102,"Only "+e.supportedNonLinearAd.join(",")+" size are supported."),n=!0),n)e.announceLocalError(102,"Wrong adList parameters.");else{var s="ID"+a;o[s]=Object.assign({},r),o[s]=Object.assign(o[s],e.displayOptions.vastOptions.adList[l]),"midRoll"===d.roll&&(o[s].error="midRoll")),o[s].id=s,o[s].ads=[],a++}}Object.keys(o).map(function(e){switch(o[e].roll.toLowerCase()){case"preroll":i.preRoll.push(o[e]);break;case"midroll":i.midRoll.push(o[e]);break;case"postroll":i.postRoll.push(o[e]);break;case"onpauseroll":i.onPauseRoll.push(o[e]);break;default:console.error("".concat(o[e].roll.toLowerCase()," is not a recognized roll"))}}),e.adGroupedByRolls=i,e.rollsById=o},e.onVastAdEnded=e.vastLogoBehaviour=function(t){if(!e.displayOptions.layoutControls.logo.showOverAds){var n=document.getElementById(e.videoPlayerId+"_logo"),o=document.getElementById(e.videoPlayerId+"_logo_image");n&&o&&(n.style.display=t?"none":"inline")}},e.deleteVastAdElements=,function(e,t){e.createCardboardJoystickButton=e.cardboardRotateLeftRight=function(t){var n=e.vrROTATION_POSITION,o=-e.vrROTATION_POSITION,i={val:t<1?n:o};new TWEEN.Tween(i).to({val:0},e.vrROTATION_SPEED).easing(TWEEN.Easing.Quadratic.InOut).onUpdate(function(){e.vrViewer.OrbitControls.rotateLeft(i.val)}).start()},e.cardboardRotateUpDown=e.createCardboardJoystick=e.cardBoardResize=e.cardBoardSwitchToNormal=e.cardBoardHideDefaultControls=e.cardBoardCreateVRControls=e.cardBoardSwitchToVR=e.cardBoardMoveTimeInfo=e.cardBoardAlterDefaultControls=function(){e.cardBoardMoveTimeInfo()},e.createCardboardView=e.createCardboard=function(){e.displayOptions.layoutControls.showCardBoardView&&(document.getElementById(e.videoPlayerId+"_fluid_control_cardboard").style.display="inline-block",window.PANOLENS?e.createCardboardView():s.e(366).then(s.bind(s,372)).then()}},function(e,t){e.subtitleFetchParse=e.createSubtitlesSwitch=function(){if(e.subtitlesData=[],e.displayOptions.layoutControls.subtitlesEnabled){var t=[];t.push({label:"OFF",url:"na",lang:"OFF"});var n=e.domRef.player.querySelectorAll("track");[].forEach.call(n,,e.subtitlesTracks=t;var o=document.getElementById(e.videoPlayerId+"_fluid_control_subtitles");o.style.display="inline-block";var i=!1,r=document.createElement("div");r.id=e.videoPlayerId+"_fluid_control_subtitles_list",r.className="fluid_subtitles_list",r.style.display="none";var a=!1,l=!!e.subtitlesTracks.find(function(e){return e.default});e.subtitlesTracks.forEach(function(t){var n="",o=e.displayOptions.layoutControls.subtitlesOnByDefault;(a||(!o||!t.default)&&(l||"OFF"===t.label)&&1!==e.subtitlesTracks.length)&&(o||"OFF"!==t.label)||(n="subtitle_selected",e.subtitleFetchParse(t),a=!0);var d=document.createElement("div");d.id="subtitle_"+e.videoPlayerId+"_"+t.label,d.className="fluid_subtitle_list_item",d.innerHTML='<span class="subtitle_button_icon '+n+'"></span>'+t.label,d.addEventListener("click",,r.appendChild(d),i=!0}),i?(o.appendChild(r),o.addEventListener("click",function(){e.openCloseSubtitlesSwitch()})):document.getElementById(e.videoPlayerId+"_fluid_control_subtitles").style.display="none",e.domRef.player.addEventListener("timeupdate",}else document.getElementById(e.videoPlayerId+"_fluid_control_subtitles").style.display="none"},e.renderSubtitles=function(){var t=Math.floor(e.domRef.player.currentTime),n=!1,o=document.getElementById(e.videoPlayerId+"_fluid_subtitles_container");if(e.isCurrentlyPlayingAd)o.innerHTML="";else{for(var i=0;i<e.subtitlesData.length;i++)t>=e.subtitlesData[i].startTime&&t<=e.subtitlesData[i].endTime&&(o.innerHTML="",o.appendChild(WebVTT.convertCueToDOMTree(window,e.subtitlesData[i].text)),n=!0);n||(o.innerHTML="")}},e.openCloseSubtitlesSwitch=function(){var t=document.getElementById(e.videoPlayerId+"_fluid_control_subtitles_list");e.isCurrentlyPlayingAd?t.style.display="none":"none"===t.style.display?(t.style.display="block",t.addEventListener("mouseleave",):t.style.display="none"},e.createSubtitles=function(){var t=document.createElement("div");t.id=e.videoPlayerId+"_fluid_subtitles_container",t.className="fluid_subtitles_container",e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling),e.displayOptions.layoutControls.subtitlesEnabled&&Promise.all([s.e(407),s.e(721)]).then(s.t.bind(s,407,23)).then(function(t){window.WebVTT=t.WebVTT,e.createSubtitlesSwitch()})}},function(e,t){e.setupThumbnailPreviewVtt=function(){e.sendRequest(e.displayOptions.layoutControls.timelinePreview.file,!0,e.displayOptions.vastOptions.vastTimeout,function(){if((4!==this.readyState||200===this.status)&&4===this.readyState&&200===this.status){var t=this.responseText,n=(new window.WebVTTParser).parse(t);e.timelinePreviewData=function(t){if(void 0===t.cues||!t.cues.length)return[];for(var n=[],o=null,i=null,r=0;r<t.cues.length;r++){var a=0,l=0,d=122.5,s=69;2===(o=t.cues[r].text.split("#")).length&&0===o[1].indexOf("xywh=")&&4===(i=(i=o[1].substring(5)).split(",")).length&&(e.displayOptions.layoutControls.timelinePreview.spriteImage=!0,a=parseInt(i[0]),l=parseInt(i[1]),d=parseInt(i[2]),s=parseInt(i[3]));var u=void 0;e.displayOptions.layoutControls.timelinePreview.spriteRelativePath&&-1!==e.displayOptions.layoutControls.timelinePreview.file.indexOf("/")&&(void 0===e.displayOptions.layoutControls.timelinePreview.sprite||""===e.displayOptions.layoutControls.timelinePreview.sprite)?(u=e.displayOptions.layoutControls.timelinePreview.file.substring(0,e.displayOptions.layoutControls.timelinePreview.file.lastIndexOf("/")),u+="/"+o[0]):u=e.displayOptions.layoutControls.timelinePreview.sprite?e.displayOptions.layoutControls.timelinePreview.sprite:o[0],n.push({startTime:t.cues[r].startTime,endTime:t.cues[r].endTime,image:u,x:a,y:l,w:d,h:s})}return n}(n)}})},e.generateTimelinePreviewTags=e.getThumbnailCoordinates=function(t){if(e.timelinePreviewData.length){for(var n=0;n<e.timelinePreviewData.length;n++)if(t>=e.timelinePreviewData[n].startTime&&t<=e.timelinePreviewData[n].endTime)return e.timelinePreviewData[n]}return!1},e.drawTimelinePreview=function(t){var n=document.getElementById(e.videoPlayerId+"_fluid_timeline_preview_container"),o=document.getElementById(e.videoPlayerId+"_fluid_timeline_preview_container_shadow"),i=document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container"),r=i.clientWidth;if(e.isCurrentlyPlayingAd)"none"!==n.style.display&&(n.style.display="none");else{var a=e.getEventOffsetX(t,i),l=null;if(r){l=e.currentVideoDuration*a/r;var d=e.getThumbnailCoordinates(l),s=r-d.w,u=a-d.w/2;u<0?u=0:u>=s&&(u=s),o.style.width=r+"px",o.style.display="block",!1!==d?(n.style.width=d.w+"px",n.style.height=d.h+"px",o.style.height=d.h+"px",n.style.background="url("+d.image+") no-repeat scroll -"+d.x+"px -"+d.y+"px",n.style.left=u+"px",n.style.display="block",e.displayOptions.layoutControls.timelinePreview.spriteImage||(n.style.backgroundSize="contain")):n.style.display="none"}}},e.setupThumbnailPreview=function(){var t=e.displayOptions.layoutControls.timelinePreview;if(t&&t.type){var n="mousemove",o="mouseleave";if(e.mobileInfo.userOs&&(n="touchmove",o="touchend"),document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container").addEventListener(n,e.drawTimelinePreview.bind(e),!1),document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container").addEventListener(o,!1),e.generateTimelinePreviewTags(),"VTT"===t.type&&"string"==typeof t.file)s.e(490).then(s.bind(s,840)).then(function(t){window.WebVTTParser=t.default,e.setupThumbnailPreviewVtt()});else{if("static"!==t.type||"object"!==f(t.frames))throw"Invalid thumbnail-preview - type must be VTT or static";t.spriteImage=!0,e.timelinePreviewData=t.frames}e.showTimeOnHover=!1}}},function(e,t){e.renderLinearAd=function(t,n){e.toggleLoader(!1),e.vastOptions=t,n&&e.backupMainVideoContentTime(t.rollListId),function(t){e.switchPlayerToVpaidMode=function(t){e.debugMessage("starting function switchPlayerToVpaidMode");var n=e.videoPlayerId+"_"+t.id+"_fluid_vpaid_iframe",o={};o.AdParameters=t.adParameters;var i=document.createElement("div");i.id=e.videoPlayerId+"_fluid_vpaid_slot",i.className="fluid_vpaid_slot",i.setAttribute("adListId",t.id),e.domRef.player.parentNode.insertBefore(i,n.nextSibling);var r={slot:i,videoSlot:e.domRef.player,videoSlotCanAutoPlay:!0},a=e.vpaidAdUnit.handshakeVersion("2.0");if(1===e.compareVersion("2.0",a))return t.error=!0,e.playMainVideoWhenVpaidFails(403),!1;!1!==e.vastOptions.skipoffset&&e.addSkipButton(),e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls"),e.vpaidCallbackListenersAttach();var l=e.fullscreenMode?"fullscreen":"normal",d=e.domRef.player.offsetWidth,s=e.domRef.player.offsetHeight;e.vpaidAdUnit.initAd(d,s,l,3e3,o,r);for(var u=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress"),c=0;c<u.length;c++)u[c].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;e.toggleLoader(!1),t.played=!0,e.adFinished=!1},e.switchPlayerToVastMode=function(){e.vastOptions.duration||(e.vastOptions.duration="streaming"===n.delivery?1/0:e.domRef.player.duration),e.displayOptions.layoutControls.showCardBoardView?t.landingPage?e.addCTAButton(t.landingPage):e.addCTAButton(t.clickthroughUrl):((void 0!==t.adClickable?t.adClickable:e.displayOptions.vastOptions.adClickable)&&e.addClickthroughLayer(e.videoPlayerId),e.addCTAButton(t.landingPage)),!1!==e.vastOptions.skipoffset&&e.addSkipButton(),e.domRef.player.loop=!1,e.addAdCountdown(),e.domRef.player.removeAttribute("controls"),e.vastLogoBehaviour(!0);for(var o=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress"),i=0;i<o.length;i++)o[i].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;if(e.rollsById[t.rollListId].adText||t.adText){var r=t.adText?t.adText:e.rollsById[t.rollListId].adText;e.addAdPlayingText(r)}if(e.positionTextElements(t),e.toggleLoader(!1),t.played=!0,e.adFinished=!1,e.domRef.player.play(),e.trackSingleEvent("impression"),e.domRef.player.removeEventListener("loadedmetadata",e.switchPlayerToVastMode),e.vrMode){var a=document.getElementById("ad_countdown"+e.videoPlayerId),l=document.getElementById(e.videoPlayerId+"_fluid_cta"),d=document.getElementById(e.videoPlayerId+"_fluid_ad_playing"),s=document.getElementById("skip_button_"+e.videoPlayerId);a&&(a.style.display="none"),l&&(l.style.display="none"),d&&(d.style.display="none"),s&&(s.style.display="none")}},e.domRef.player.pause(),e.detachStreamers();var n=e.getSupportedMediaFileObject(e.vastOptions.mediaFileList);if(e.displayOptions.layoutControls.showCardBoardView&&"360"!==t.mediaType)return t.error=!0,e.playMainVideoWhenVastFails(403),!1;var o=e.vastOptions.vpaid;if(!o&&n.isUnsuportedHls)s.e(602).then(s.t.bind(s,631,23)).then(;else if(o)e.loadVpaid(t,n.src),e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarkers();else{if(!1===n.src)return t.error=!0,e.playMainVideoWhenVastFails(403),!1;e.domRef.player.addEventListener("loadedmetadata",e.switchPlayerToVastMode),e.domRef.player.src=n.src,e.isCurrentlyPlayingAd=!0,e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarkers(),e.domRef.player.load(),e.domRef.player.addEventListener("ended",e.onVastAdEnded)}}(t),e.domRef.player.addEventListener("timeupdate",},e.playRoll=e.backupMainVideoContentTime=e.getSupportedMediaFileObject=e.getMediaFileTypeSupportLevel=e.scheduleTrackingEvent=e.trackSingleEvent=e.completeNonLinearStatic=e.createNonLinearStatic=function(t){if(e.vastOptions=t,e.createBoard(t),!0!==e.rollsById[t.rollListId].error&&!0!==t.error){e.adFinished=!1;var n=!!e.rollsById[t.rollListId].nonLinearDuration&&e.rollsById[t.rollListId].nonLinearDuration;e.vastOptions.vpaid||(e.trackSingleEvent("start"),n=n||e.vastOptions.duration,e.nonLinearTracking=setInterval(400));var o=parseInt(e.getCurrentTime())+parseInt(n);e.scheduleTask({time:o,closeStaticAd:t,rollListId:t.rollListId})}else e.announceLocalError(101)},e.createVpaidNonLinearBoard=function(t){e.loadVpaidNonlinearAssets=function(t){e.debugMessage("starting function switchPlayerToVpaidMode");var n=t.vAlign?t.vAlign:e.nonLinearVerticalAlign,o=t.vpaidNonLinearCloseButton?t.vpaidNonLinearCloseButton:e.vpaidNonLinearCloseButton,i=e.videoPlayerId+"_"+t.id+"_fluid_vpaid_iframe",r={};r.AdParameters=t.adParameters;var a=document.createElement("div");a.id="fluid_vpaidNonLinear_"+t.id,a.className="fluid_vpaidNonLinear_"+n,a.className+=" fluid_vpaidNonLinear_ad",a.setAttribute("adListId",t.id);var l,d,s=Math.min(468,e.domRef.player.offsetWidth),u=Math.min(60,Math.floor(e.domRef.player.offsetHeight/4));if(void 0!==t.size){var c=t.size.split("x");s=c[0],u=c[1]}else t.dimension.width&&t.dimension.height&&(s=t.dimension.width,u=t.dimension.height);if(a.style.width="100%",a.style.height=u+"px",o){var p=document.createElement("div");p.className="fluid_vpaidNonLinear_frame",p.style.width=s+"px",p.style.height=u+"px",a.appendChild(p);var f=document.createElement("div");f.id="close_button_"+e.videoPlayerId,f.className="close_button",f.innerHTML="",f.title=e.displayOptions.layoutControls.closeButtonCaption;var v=(l=t.id.split("_"),d=1,l)||l,d)||l,d)||))[0];f.onclick=p.appendChild(f)}var m=document.createElement("iframe");m.id=e.videoPlayerId+"non_linear_vapid_slot_iframe",m.className="fluid_vpaid_nonlinear_slot_iframe",m.setAttribute("width",s+"px"),m.setAttribute("height",u+"px"),m.setAttribute("sandbox","allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"),m.setAttribute("frameborder","0"),m.setAttribute("scrolling","no"),m.setAttribute("marginwidth","0"),m.setAttribute("marginheight","0"),a.appendChild(m),e.domRef.player.parentNode.insertBefore(a,i.nextSibling);var g=m.contentWindow.document.createElement("div");m.contentWindow.document.body.appendChild(g),e.vastOptions.slotIframe=m,e.vastOptions.slotFrame=void 0;var h={slot:g,videoSlot:e.domRef.player,videoSlotCanAutoPlay:!0};e.debugMessage(t);var b=e.vpaidAdUnit.handshakeVersion("2.0");if(1===e.compareVersion("2.0",b))return t.error=!0,e.playMainVideoWhenVpaidFails(403),!1;e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls"),e.vpaidCallbackListenersAttach();var $=e.fullscreenMode?"fullscreen":"normal";e.vpaidAdUnit.initAd(s,u,$,3e3,r,h),e.toggleLoader(!1),t.played=!0,e.adFinished=!1},e.loadVpaid(t,t.staticResource),e.debugMessage("create non linear vpaid")},e.createNonLinearBoard=function(t){t.played=!0;var n=e.domRef.player.clientWidth,o=document.createElement("div"),i=e.rollsById[t.rollListId].vAlign?e.rollsById[t.rollListId].vAlign:e.nonLinearVerticalAlign,r=new Image;r.src=t.staticResource,r.id="fluid_nonLinear_imgCreative_"+t.id+"_"+e.videoPlayerId,r.onerror=r.onload=function(){void 0!==e.rollsById[t.rollListId].size?(o=e.rollsById[t.rollListId].size.split("x")[0],i=e.rollsById[t.rollListId].size.split("x")[1]):t.dimension.width&&t.dimension.height?(o=t.dimension.width,i=t.dimension.height):(o=r.width,i=r.height),o>n?l=i*(a=n-5)/o:(a=o,l=i),"onPauseRoll"!==e.rollsById[t.rollListId].roll&&(document.getElementById("fluid_nonLinear_"+t.id).style.display="");var o,i,a,l,d=document.getElementById(r.id);d.width=a,d.height=l,e.trackSingleEvent("impression")},o.id="fluid_nonLinear_"+t.id,o.className="fluid_nonLinear_"+i,o.className+=" fluid_nonLinear_ad",o.innerHTML=r.outerHTML,o.style.display="none",o.onclick=void 0!==t.clickthroughUrl&&(o.style.cursor="pointer");var a=document.createElement("div");a.id="close_button_"+e.videoPlayerId,a.className="close_button",a.innerHTML="",a.title=e.displayOptions.layoutControls.closeButtonCaption;var l=t.rollListId;a.onclick=o.appendChild(a),e.domRef.player.parentNode.insertBefore(o,e.domRef.player.nextSibling)},e.createBoard=e.closeNonLinear=function(e){var t=document.querySelector("#fluid_nonLinear_"+e+", #fluid_vpaidNonLinear_"+e);t&&t.remove()},e.rollGroupContainsLinear=e.rollGroupContainsNonlinear=e.preRollFail=function(){var t=e.preRollAdPodsLength;e.preRollVastResolved++,e.preRollVastResolved===t&&e.preRollAdsPlay()},e.preRollSuccess=e.preRollAdsPlay=e.preRoll=e.createAdMarker=e.hideAdMarker=e.showAdMarkers=e.hideAdMarkers=function(){for(var t=document.getElementById(e.videoPlayerId+"_ad_markers_holder").getElementsByClassName("fluid_controls_ad_marker"),n=0;n<t.length;++n)t[n].style.display="none"},e.midRoll=e.postRoll=e.onPauseRoll=function(t){e.domRef.player.removeEventListener(t.type,e.onPauseRoll);var n=t.type.replace("adId_","");e.rollsById[n].ads.forEach(function(t){if("nonLinear"===t.adType){if(!0===e.rollsById[t.rollListId].error||!0===t.error)return void e.announceLocalError(101);if(document.getElementsByClassName("fluid_nonLinear_ad")[0])e.onPauseRollAdPods.push(n);else{e.createBoard(t),e.currentOnPauseRollAd=n;var o=document.getElementById("fluid_nonLinear_"+n);o&&(o.style.display="none")}}})},e.hasValidOnPauseAd=e.toggleOnPauseAd=function(){if(e.toggleLoader(!1),e.hasValidOnPauseAd()&&!e.isCurrentlyPlayingAd){var t=e.findRoll("onPauseRoll"),n=e.rollsById[t].ads[0];e.vastOptions=n;var o=document.getElementById("fluid_nonLinear_"+n.id);o&&e.domRef.player.paused?setTimeout(500):o&&!e.domRef.player.paused&&(o.style.display="none",e.adFinished=!0,e.trackingOnPauseNonLinearAd(n,"complete"))}},e.trackingOnPauseNonLinearAd=e.getLinearAdsFromKeyTime=e.adKeytimePlay=function(t){if(e.timerPool[t]&&!e.isCurrentlyPlayingAd){var n=e.timerPool[t].closeStaticAd.length,o=e.timerPool[t].linear.length,i=e.timerPool[t].nonLinear.length;if(0!==n||0!==o||0!==i){if(n>0){for(var r=0;r<n;r++){var a=e.timerPool[t].closeStaticAd[r];!0===a.played&&e.completeNonLinearStatic(a)}e.timerPool[t].closeStaticAd=[]}if(o>0&&e.timerPool[t].linear.length>0)return e.playRoll(e.timerPool[t].linear),void(e.timerPool[t].linear=[]);if(i>0)for(var l=0;l<i;l++){var d=e.timerPool[t].nonLinear[l],s=d.rollListId;if(e.adPool[s],!1===d.played&&!e.displayOptions.layoutControls.showCardBoardView)return e.createNonLinearStatic(d),e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarker(d),void e.timerPool[t].nonLinear.splice(l,1)}}else delete e.timerPool[t]}},e.adTimer=e.scheduleTask=function(t){e.timerPool.hasOwnProperty(t.time)||(e.timerPool[t.time]={linear:[],nonLinear:[],closeStaticAd:[]}),e.rollsById[t.rollListId].ads.filter(.forEach(},e.switchToMainVideo=function(){e.debugMessage("starting main video"),e.domRef.player.src=e.originalSrc,e.initialiseStreamers();var t=void 0!==e.domRef.player.mainVideoCurrentTime?Math.floor(e.domRef.player.mainVideoCurrentTime):0;if(e.domRef.player.hasOwnProperty("currentTime")&&(e.domRef.player.currentTime=t),e.displayOptions.layoutControls.loop&&(e.domRef.player.loop=!0),e.setCurrentTimeAndPlay(t,e.autoplayAfterAd),e.isCurrentlyPlayingAd=!1,e.deleteVastAdElements(),e.adFinished=!0,e.displayOptions.vastOptions.vastAdvanced.vastVideoEndedCallback(),e.vastOptions=null,e.setBuffering(),null!==document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container"))for(var n=e.displayOptions.layoutControls.primaryColor?e.displayOptions.layoutControls.primaryColor:"white",o=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress"),i=0;i<o.length;i++)o[i].style.backgroundColor=n;e.domRef.player.removeEventListener("ended",e.onVastAdEnded),e.displayOptions.vastOptions.showProgressbarMarkers&&e.showAdMarkers(),e.hasTitle()&&(document.getElementById(e.videoPlayerId+"_title").style.display="inline")},e.getNextAdPod=e.checkForNextAd=e.addSkipButton=function(){var t=document.createElement("div");t.id="skip_button_"+e.videoPlayerId,t.className="skip_button skip_button_disabled",e.vastOptions.skipoffset>0&&(t.innerHTML=e.displayOptions.vastOptions.skipButtonCaption.replace("[seconds]",e.vastOptions.skipoffset)),document.getElementById("fluid_video_wrapper_"+e.videoPlayerId).appendChild(t),0===e.vastOptions.skipoffset&&e.decreaseSkipOffset(),e.domRef.player.addEventListener("timeupdate",e.decreaseSkipOffset,!1)},e.addAdCountdown=function(){if(!(e.isCurrentlyPlayingAd&&e.hlsPlayer||e.currentVideoDuration===1/0)){var t=document.getElementById("fluid_video_wrapper_"+e.videoPlayerId),n=document.createElement("div"),o=e.pad(parseInt(e.currentVideoDuration/60))+":"+e.pad(parseInt(e.currentVideoDuration%60)),i=parseInt(o);n.id="ad_countdown"+e.videoPlayerId,n.className="ad_countdown",n.innerHTML="<span class='ad_timer_prefix'>Ad - </span>"+i,t.appendChild(n),e.domRef.player.addEventListener("timeupdate",e.decreaseAdCountdown,!1),t.addEventListener("mouseover",!1)}},e.decreaseAdCountdown=function(){var t=parseInt(e.currentVideoDuration)-parseInt(e.domRef.player.currentTime),n=document.getElementById("ad_countdown"+e.videoPlayerId);n&&isNaN(t)?n.parentNode.removeChild(n):n?n.innerHTML="<span class='ad_timer_prefix'>Ad - </span> "+e.pad(parseInt(t/60))+":"+e.pad(parseInt(t%60)):e.domRef.player.removeEventListener("timeupdate",e.decreaseAdCountdown)},e.removeAdCountdown=function(){var t=document.getElementById("ad_countdown"+e.videoPlayerId);t&&t.parentElement.removeChild(t)},e.toggleAdCountdown=e.addAdPlayingText=e.positionTextElements=function(t){var n,o,i,r=["top left","top right","bottom left","bottom right"],a=document.getElementById("skip_button_"+e.videoPlayerId),l=document.getElementById(e.videoPlayerId+"_fluid_ad_playing"),d=document.getElementById(e.videoPlayerId+"_fluid_cta"),s=0,u=0,c=!1,p=0,f=[],y={top:{left:{h:34,v:34},right:{h:0,v:34}},bottom:{left:{h:34,v:50},right:{h:0,v:50}}};null!==a&&(p=a.offsetHeight+8,e.domRef.wrapper.classList.contains("mobile")&&(y.top={left:{h:0,v:8},right:{h:0,v:8}},y.bottom={left:{h:0,v:50},right:{h:0,v:50}})),null!==d&&(-1===r.indexOf(n=e.rollsById[t.rollListId].adCTATextPosition?e.rollsById[t.rollListId].adCTATextPosition.toLowerCase():e.displayOptions.vastOptions.adCTATextPosition)&&(console.log('[FP Error] Invalid position for CTAText. Reverting to "bottom right"'),n="bottom right"),d.classList.add.apply(d.classList,n.split(" ")),c="bottom"===(f=n.split(" "))[0],d.style[f[0]]=y[f[0]][f[1]].v+"px",d.style[f[1]]=y[f[0]][f[1]].h+"px",c&&"right"===f[1]&&(d.style[f[0]]=y[f[0]][f[1]].v+p+"px"),s=d.offsetHeight+8+"px"),null!==l&&(-1===r.indexOf(o=e.rollsById[t.rollListId].adTextPosition?e.rollsById[t.rollListId].adTextPosition.toLowerCase():e.displayOptions.vastOptions.adTextPosition)&&(console.log('[FP Error] Invalid position for adText. Reverting to "top left"'),o="top left"),i=o.split(" "),l.style[i[0]]=y[i[0]][i[1]].v+"px",l.style[i[1]]=y[i[0]][i[1]].h+"px",u=l.offsetHeight+8+"px"),s>0&&u>0&&n===o&&(c?"right"===f[1]?l.style.bottom=y[i[0]][i[1]].v+p+s+"px":l.style.bottom=y[i[0]][i[1]].v+s+"px":d.style.top=y[f[0]][f[1]].v+u+"px")},e.removeAdPlayingText=function(){var t=document.getElementById(e.videoPlayerId+"_fluid_ad_playing");t&&t.parentElement.removeChild(t)},e.addCTAButton=e.createAndAppendCTAButton=function(t,n,o){var i=document.createElement("div");i.id=e.videoPlayerId+"_fluid_cta",i.className="fluid_ad_cta";var r=document.createElement("span"),a=t;n&&(a+='<br/><span class="add_icon_clickthrough">'+n+"</span>"),r.innerHTML=a,i.addEventListener("click",!1),i.appendChild(r),document.getElementById("fluid_video_wrapper_"+e.videoPlayerId).appendChild(i)},e.removeCTAButton=e.decreaseSkipOffset=function(){var t=e.vastOptions.skipoffset-Math.floor(e.domRef.player.currentTime),n=document.getElementById("skip_button_"+e.videoPlayerId);if(n){if(t>=1)n.innerHTML=e.displayOptions.vastOptions.skipButtonCaption.replace("[seconds]",t);else{var o=document.createElement("a");o.href="#",o.id="skipHref_"+e.videoPlayerId,o.innerHTML=e.displayOptions.vastOptions.skipButtonClickCaption,o.onclick=n.innerHTML="",n.appendChild(o),n.className=n.className.replace(/\bskip_button_disabled\b/,""),e.domRef.player.removeEventListener("timeupdate",e.decreaseSkipOffset)}}else e.domRef.player.removeEventListener("timeupdate",e.decreaseSkipOffset)},e.pressSkipButton=e.removeSkipButton=function(){var t=document.getElementById("skip_button_"+e.videoPlayerId);t&&t.parentElement.removeChild(t)},e.addClickthroughLayer=e.removeClickthrough=,function(e,t){e.initialiseStreamers=function(){switch(e.detachStreamers(),e.displayOptions.layoutControls.mediaType){case"application/dash+xml":e.dashScriptLoaded||window.dashjs&&!window.dashjs.isDefaultSubject?e.initialiseDash():(e.dashScriptLoaded=!0,s.e(112).then(s.t.bind(s,452,23)).then(function(t){window.dashjs=t.default,e.initialiseDash()}));break;case"application/x-mpegurl":e.hlsScriptLoaded||window.Hls?e.initialiseHls():(e.hlsScriptLoaded=!0,s.e(602).then(s.t.bind(s,631,23)).then()}},e.initialiseDash=e.initialiseHls=e.detachStreamers=,function(e,t){e.isTouchDevice=e.getMobileOs=e.getBrowserVersion=e.compareVersion=function(e,t){if("string"!=typeof e||"string"!=typeof t)return!1;e=e.split("."),t=t.split(".");for(var n=Math.min(e.length,t.length),o=0;o<n;++o){if(e[o]=parseInt(e[o],10),t[o]=parseInt(t[o],10),e[o]>t[o])return 1;if(e[o]<t[o])return -1}return e.length===t.length?0:e.length<t.length?-1:1},e.convertTimeStringToSeconds=e.formatTime=e.pad=],w=0,C=function(){var e,t,n=this,o=this;o.domRef={player:null},o.version="3.15.0",o.homepage="https://fluidplayer.com/?utm_source=player&utm_medium=context_menu&utm_campaign=organic",o.destructors=[],o.init=function(e,t){for(var n,i={development:!1,debug:!1},r=0,a=$;r<a.length;r++)(0,a[r])(o,i);if(e instanceof HTMLVideoElement)n=e,e.id||(e.id="fluid_player_instance_"+(w++).toString());else{if(!("string"==typeof e||e instanceof String))throw"Invalid initializer - player target must be HTMLVideoElement or ID";n=document.getElementById(e)}if(!n)throw"Could not find a HTML node to attach to for target "+e+'"';for(var l in n.setAttribute("playsinline",""),n.setAttribute("webkit-playsinline",""),o.domRef.player=n,o.vrROTATION_POSITION=.1,o.vrROTATION_SPEED=80,o.vrMode=!1,o.vrPanorama=null,o.vrViewer=null,o.vpaidTimer=null,o.vpaidAdUnit=null,o.vastOptions=null,o.videoPlayerId=n.id,o.originalSrc=o.getCurrentSrc(),o.isCurrentlyPlayingAd=!1,o.recentWaiting=!1,o.latestVolume=1,o.currentVideoDuration=0,o.firstPlayLaunched=!1,o.suppressClickthrough=!1,o.timelinePreviewData=[],o.mainVideoCurrentTime=0,o.mainVideoDuration=0,o.isTimer=!1,o.timer=null,o.timerPool={},o.rollsById={},o.adPool={},o.adGroupedByRolls={},o.onPauseRollAdPods=[],o.currentOnPauseRollAd="",o.preRollAdsResolved=!1,o.preRollAdPods=[],o.preRollAdPodsLength=0,o.preRollVastResolved=0,o.temporaryAdPods=[],o.availableRolls=["preRoll","midRoll","postRoll","onPauseRoll"],o.supportedNonLinearAd=["300x250","468x60","728x90"],o.autoplayAfterAd=!0,o.nonLinearDuration=15,o.supportedStaticTypes=["image/gif","image/jpeg","image/png"],o.inactivityTimeout=null,o.isUserActive=null,o.nonLinearVerticalAlign="bottom",o.vpaidNonLinearCloseButton=!0,o.showTimeOnHover=!0,o.initialAnimationSet=!0,o.theatreMode=!1,o.theatreModeAdvanced=!1,o.fullscreenMode=!1,o.originalWidth=n.offsetWidth,o.originalHeight=n.offsetHeight,o.dashPlayer=!1,o.hlsPlayer=!1,o.dashScriptLoaded=!1,o.hlsScriptLoaded=!1,o.isPlayingMedia=!1,o.isSwitchingSource=!1,o.isLoading=!1,o.isInIframe=o.inIframe(),o.mainVideoReadyState=!1,o.xmlCollection=[],o.inLineFound=null,o.fluidStorage={},o.fluidPseudoPause=!1,o.mobileInfo=o.getMobileOs(),o.events={},o.displayOptions={layoutControls:{mediaType:o.getCurrentSrcType(),primaryColor:!1,posterImage:!1,posterImageSize:"contain",adProgressColor:"#f9d300",playButtonShowing:!0,playPauseAnimation:!0,closeButtonCaption:"Close",fillToContainer:!1,autoPlay:!1,preload:"auto",mute:!1,loop:null,keyboardControl:!0,allowDownload:!1,playbackRateEnabled:!1,subtitlesEnabled:!1,subtitlesOnByDefault:!0,showCardBoardView:!1,showCardBoardJoystick:!1,allowTheatre:!0,doubleclickFullscreen:!0,theatreSettings:{width:"100%",height:"60%",marginTop:0,horizontalAlign:"center",keepPosition:!1},theatreAdvanced:!1,title:null,logo:{imageUrl:null,position:"top left",clickUrl:null,opacity:1,mouseOverImageUrl:null,imageMargin:"2px",hideWithControls:!1,showOverAds:!1},controlBar:{autoHide:!1,autoHideTimeout:3,animated:!0,playbackRates:["x2","x1.5","x1","x0.5"]},timelinePreview:{spriteImage:!1,spriteRelativePath:!1},htmlOnPauseBlock:{html:null,height:null,width:null},layout:"default",playerInitCallback:function(){},persistentSettings:{volume:!0,quality:!0,speed:!0,theatre:!0},controlForwardBackward:{show:!1},contextMenu:{controls:!0,links:[]}},vastOptions:{adList:{},skipButtonCaption:"Skip ad in [seconds]",skipButtonClickCaption:'Skip Ad <span class="skip_button_icon"></span>',adText:null,adTextPosition:"top left",adCTAText:"Visit now!",adCTATextPosition:"bottom right",adCTATextVast:!1,adClickable:!0,vastTimeout:5e3,showProgressbarMarkers:!1,allowVPAID:!1,showPlayButton:!1,maxAllowedVastTagRedirects:3,vpaidTimeout:3e3,vastAdvanced:{vastLoadedCallback:function(){},noVastVideoCallback:function(){},vastVideoSkippedCallback:function(){},vastVideoEndedCallback:},captions:{play:"Play",pause:"Pause",mute:"Mute",unmute:"Unmute",fullscreen:"Fullscreen",subtitles:"Subtitles",exitFullscreen:"Exit Fullscreen"},debug:!1,modules:{configureHls:function(e){return e},onBeforeInitHls:function(e){},onAfterInitHls:function(e){},configureDash:function(e){return e},onBeforeInitDash:function(e){},onAfterInitDash:function(e){}},onBeforeXMLHttpRequestOpen:function(e){},onBeforeXMLHttpRequest:function(e){}},t.hlsjsConfig&&console.error("[FP_ERROR] player option hlsjsConfig is removed and has no effect. Use module callbacks instead!"),t)if(t.hasOwnProperty(l)){if("object"==b(t[l]))for(var d in t[l])t[l].hasOwnProperty(d)&&(o.displayOptions[l][d]=t[l][d]);else o.displayOptions[l]=t[l]}o.domRef.wrapper=o.setupPlayerWrapper(),n.addEventListener("webkitfullscreenchange",o.recalculateAdDimensions),n.addEventListener("fullscreenchange",o.recalculateAdDimensions),n.addEventListener("waiting",o.onRecentWaiting),n.addEventListener("pause",o.onFluidPlayerPause),n.addEventListener("error",o.onErrorDetection),n.addEventListener("ended",o.onMainVideoEnded),n.addEventListener("durationchange",,n.readyState>0?o.mainVideoReady():n.addEventListener("loadedmetadata",o.mainVideoReady),o.displayOptions.layoutControls.showCardBoardView&&n.setAttribute("crossOrigin","anonymous"),o.currentVideoDuration=o.getCurrentVideoDuration(),!isNaN(o.currentVideoDuration)&&isFinite(o.currentVideoDuration)||(o.currentVideoDuration=0),o.setLayout(),o.latestVolume=n.volume,o.initialAnimationSet=o.displayOptions.layoutControls.playPauseAnimation,o.handleFullscreen(),o.initLogo(),o.initTitle(),o.initMute(),o.initLoop(),o.displayOptions.layoutControls.playerInitCallback(),o.createVideoSourceSwitch(),o.createSubtitles(),o.createCardboard(),o.userActivityChecker(),o.setVastList(),o.setPersistentSettings();var s=o.findRoll("preRoll");s&&0!==s.length||o.initialiseStreamers();var u=n.play;n.play=function(){var e=null;o.displayOptions.layoutControls.showCardBoardView&&"undefined"!=typeof DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission&&DeviceOrientationEvent.requestPermission().then(.catch(console.error);try{return null!=(e=u.apply(this,arguments))&&(e.then(.catch(,o.promiseTimeout=setTimeout(5e3)),e}catch(t){console.error("[FP_ERROR] Playback error",t),o.announceLocalError(201,"Failed to play video.")}};var c=n.pause;if(n.pause=o.displayOptions.layoutControls.autoPlay&&!o.dashScriptLoaded&&!o.hlsScriptLoaded){if("Safari"===o.getBrowserVersion().browserName)return;n.play()}var p=document.getElementById("fluid_video_wrapper_"+n.id);o.mobileInfo.userOs?(o.hideControlBar(),p.addEventListener("touchstart",o.showControlBar,!1)):(o.displayOptions.layoutControls.controlBar.autoHide||p.addEventListener("mouseleave",o.handleMouseleave,!1),p.addEventListener("mouseenter",o.showControlBar,!1),p.addEventListener("mouseenter",o.showTitle,!1)),o.displayOptions.layoutControls.keyboardControl&&o.keyboardControl(),o.displayOptions.layoutControls.controlBar.autoHide&&o.linkControlBarUserActivity();try{if(o.domRef.player.textTracks){var f,y=g(o.domRef.player.textTracks);try{for(y.s();!(f=y.n()).done;)f.value.mode="hidden"}catch(v){y.e(v)}finally{y.f()}}}catch(m){}},o.getCurrentVideoDuration=o.toggleLoader=o.sendRequest=o.sendRequestAsync=(t=(e=v().mark(,,,o.announceLocalError=function(e,t){var n="[Error] ("+(void 0!==e?parseInt(e):900)+"): ";n+=t||"Failed to load Vast"},o.debugMessage=function(){if(o.displayOptions.debug){for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).log.apply(e,["%cFP DEBUG MESSAGE","color: #fff; font-weight: bold; background-color: #1a5e87; padding: 3px 6px; border-radius: 3px;"].concat(n))}},o.onMainVideoEnded=o.getCurrentTime=o.getCurrentSrc=o.getCurrentSrcType=o.onRecentWaiting=o.onFluidPlayerPause=o.checkShouldDisplayVolumeBar=o.generateCustomControlTags=o.controlPlayPauseToggle=o.playPauseAnimationToggle=o.contolProgressbarUpdate=o.controlDurationUpdate=o.contolVolumebarUpdate=o.muteToggle=o.checkFullscreenSupport=o.fullscreenOff=o.fullscreenOn=o.fullscreenToggle=function(){var e,t=o.domRef.player,n=document.getElementById("fluid_video_wrapper_"+o.videoPlayerId),i=o.checkFullscreenSupport("fluid_video_wrapper_"+o.videoPlayerId),r=t.parentNode.getElementsByClassName("fluid_control_fullscreen"),a=document.getElementById(o.videoPlayerId+"context_option_fullscreen");o.theatreMode&&o.theatreToggle(),i?"webkitEnterFullscreen"===i.goFullscreen?t[i.isFullscreen]||(e="videoPlayerTag."+i.goFullscreen+"();",o.fullscreenOn(r,a),Function("videoPlayerTag",e)(t)):(null===document[i.isFullscreen]?(e="videoPlayerTag."+i.goFullscreen+"();",o.fullscreenOn(r,a)):(e="document."+i.exitFullscreen+"();",o.fullscreenOff(r,a)),Function("videoPlayerTag",e)(n)):-1!==n.className.search(/\bpseudo_fullscreen\b/g)?(n.className=n.className.replace(/\bpseudo_fullscreen\b/g,""),o.fullscreenOff(r,a)):(n.className+=" pseudo_fullscreen",o.fullscreenOn(r,a)),o.resizeVpaidAuto()},o.findClosestParent=o.getTranslateX=o.getEventOffsetX=o.getEventOffsetY=o.onProgressbarMouseDown=function(e){var t;if(o.displayOptions.layoutControls.playPauseAnimation=!1,t=o.displayOptions.layoutControls.showCardBoardView?o.getEventOffsetX(e,e.target.parentNode):o.getEventOffsetX(e,document.getElementById(o.videoPlayerId+"_fluid_controls_progress_container")),!o.isCurrentlyPlayingAd){o.fluidPseudoPause=!0;var n=o.domRef.player.paused;n||o.domRef.player.pause();var i=r=function(e){var n=o.getEventOffsetX(e,e.target.parentNode),i=document.getElementById(o.videoPlayerId+"_fluid_controls_progress_container").clientWidth,r=o.currentVideoDuration*n/i,a=document.querySelector(".fluid_controls_currentprogress"),l=o.currentVideoDuration,d=document.querySelector(".player-wrap");d.setAttribute("data-time-skipTo",Math.round(r)),d.classList.add("skipTo");var s=(r/l*100).toFixed(2)+"%";a.style.width=s,t=NaN,o.controlDurationUpdate(o.videoPlayerId)},a=function e(a){document.removeEventListener("mousemove",r),document.removeEventListener("touchmove",r),document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e);var l=o.getEventOffsetX(a,a.target.parentNode),d=document.querySelector(".player-wrap"),s=d.getAttribute("data-time-skipTo");player.skipTo(s);var d=document.querySelector(".player-wrap");d.removeAttribute("data-time-skipTo"),d.classList.remove("skipTo"),isNaN(l)&&!isNaN(t)&&(l=t),isNaN(l)||i(l),n||o.play(),o.initialAnimationSet&&setTimeout(200),o.fluidPseudoPause=!1};document.addEventListener("mouseup",a),document.addEventListener("touchend",a),document.addEventListener("mousemove",r),document.addEventListener("touchmove",r)}},o.onVolumeBarMouseDown=function(){var e=t=function(t){e(o.getEventOffsetX(t,o.domRef.controls.volumeContainer))},n=document.addEventListener("mouseup",n),document.addEventListener("touchend",n),document.addEventListener("mousemove",t),document.addEventListener("touchmove",t)},o.findRoll=o.onKeyboardVolumeChange=o.onKeyboardSeekPosition=o.getNewCurrentTimeValueByKeyCode=function(e,t,n){var o=t;switch(e){case 37:o=(o-=5)<5?0:o;break;case 39:o=(o+=5)>n-5?n:o;break;case 35:o=n;break;case 36:o=0;break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e<58&&e>47&&(o=n*(10*(e-48))/100)}return o},o.handleMouseleave=o.handleMouseenterForKeyboard=o.keyboardControl=o.handleWindowClick=o.initialPlay=o.playPauseToggle=function(){var e=!o.firstPlayLaunched,t=o.findRoll("preRoll");if(e&&0!==t.length){o.isCurrentlyPlayingAd=!0;var n=o.getBrowserVersion(),i=!1!==o.mobileInfo.userOs&&"Android"===o.mobileInfo.userOs&&"Google Chrome"===n.browserName;("Safari"===n.browserName||i)&&(o.domRef.player.src="https://cdn.fluidplayer.com/static/blank.mp4",o.domRef.player.play(),o.playPauseAnimationToggle(!0)),o.firstPlayLaunched=!0,o.prepareVast("preRoll"),o.preRollAdPodsLength=t.length}else e&&0===t.length&&(o.firstPlayLaunched=!0,o.displayOptions.vastOptions.vastAdvanced.noVastVideoCallback()),o.domRef.player.paused?(o.isCurrentlyPlayingAd&&null!==o.vastOptions&&o.vastOptions.vpaid?o.resumeVpaidAd():(Math.floor(o.currentVideoDuration)===Math.floor(o.domRef.player.currentTime)&&(o.initialiseStreamers(),o.domRef.player.currentTime=0),o.dashPlayer?o.dashPlayer.play():o.domRef.player.play()),o.playPauseAnimationToggle(!0)):e||(o.isCurrentlyPlayingAd&&null!==o.vastOptions&&o.vastOptions.vpaid?o.pauseVpaidAd():o.domRef.player.pause(),o.playPauseAnimationToggle(!1)),o.toggleOnPauseAd();var r=if(e){var a=document.getElementById(o.videoPlayerId+"_fluid_pseudo_poster");a&&a.parentNode.removeChild(a),o.mainVideoDuration>0?r():o.domRef.player.addEventListener("mainVideoDurationSet",r)}o.adTimer();var l=document.getElementById(o.videoPlayerId+"_fluid_html_on_pause");l&&!o.isCurrentlyPlayingAd&&(o.domRef.player.paused?l.style.display="flex":l.style.display="none")},o.setCustomControls=o.createTimePositionPreview=o.setCustomContextMenu=function(){var e=o.domRef.wrapper,t=o.displayOptions.layoutControls.contextMenu.controls,n=o.displayOptions.layoutControls.contextMenu.links,i=document.createElement("div");i.id=o.videoPlayerId+"_fluid_context_menu",i.className="fluid_context_menu",i.style.display="none",i.style.position="absolute";var r=document.createElement("ul");if(i.appendChild(r),Array.isArray(n)&&n.forEach(function(e,t){var n=document.createElement("li");n.id=o.videoPlayerId+"_extra_link_"+t,n.innerHTML=e.label,n.addEventListener("click",function(){return window.open(e.href,"_blank")},!1),r.appendChild(n)}),t){var a=document.createElement("li");a.id=o.videoPlayerId+"context_option_play",a.innerHTML=o.displayOptions.captions.play,a.addEventListener("click",function(){return o.playPauseToggle()},!1),r.appendChild(a);var l=document.createElement("li");l.id=o.videoPlayerId+"context_option_mute",l.innerHTML=o.displayOptions.captions.mute,l.addEventListener("click",function(){return o.muteToggle()},!1),r.appendChild(l);var d=document.createElement("li");d.id=o.videoPlayerId+"context_option_fullscreen",d.innerHTML=o.displayOptions.captions.fullscreen,d.addEventListener("click",function(){return o.fullscreenToggle()},!1),r.appendChild(d)}var s=document.createElement("li");s.id=o.videoPlayerId+"context_option_homepage",s.innerHTML="Fluid Player "+o.version,s.addEventListener("click",!1),r.appendChild(s),o.domRef.player.parentNode.insertBefore(i,o.domRef.player.nextSibling),e.addEventListener("contextmenu",!1),document.addEventListener("click",!1)},o.setDefaultLayout=o.initSkipControls=o.checkIfVolumebarIsRendered=o.setLayout=o.handleFullscreen=o.setupPlayerWrapper=o.onErrorDetection=o.createVideoSourceSwitch=o.openCloseVideoSourceSwitch=function(){var e=document.getElementById(o.videoPlayerId+"_fluid_control_video_source_list");o.isCurrentlyPlayingAd?e.style.display="none":"none"===e.style.display?(e.style.display="block",e.addEventListener("mouseleave",function t(){e.removeEventListener("mouseleave",t),e.style.display="none"})):e.style.display="none"},o.setVideoSource=o.setCurrentTimeAndPlay=o.initTitle=o.hasTitle=o.hideTitle=function(){var e=document.getElementById(o.videoPlayerId+"_title");o.hasTitle()&&e.classList.add("fade_out")},o.showTitle=o.initLogo=function(){if(o.displayOptions.layoutControls.logo.imageUrl){var e=document.createElement("div");e.id=o.videoPlayerId+"_logo",o.displayOptions.layoutControls.logo.hideWithControls?e.classList.add("initial_controls_show","fp_logo"):e.classList.add("logo_maintain_display");var t=document.createElement("img");t.id=o.videoPlayerId+"_logo_image",o.displayOptions.layoutControls.logo.imageUrl&&(t.src=o.displayOptions.layoutControls.logo.imageUrl),t.style.position="absolute",t.style.margin=o.displayOptions.layoutControls.logo.imageMargin;var n=o.displayOptions.layoutControls.logo.position.toLowerCase();-1!==n.indexOf("bottom")?t.style.bottom=0:t.style.top=0,-1!==n.indexOf("right")?t.style.right=0:t.style.left=0,o.displayOptions.layoutControls.logo.opacity&&(t.style.opacity=o.displayOptions.layoutControls.logo.opacity),null!==o.displayOptions.layoutControls.logo.clickUrl&&(t.style.cursor="pointer",t.addEventListener("click",),o.displayOptions.layoutControls.logo.mouseOverImageUrl&&(t.addEventListener("mouseover",function(){t.src=o.displayOptions.layoutControls.logo.mouseOverImageUrl},!1),t.addEventListener("mouseout",!1)),o.domRef.player.parentNode.insertBefore(e,null),e.appendChild(t,null)}},o.initHtmlOnPauseBlock=o.initPlayButton=function(){var e=document.createElement("div");e.id=o.videoPlayerId+"_fluid_initial_play_button",e.className="fluid_html_on_pause";var t=o.displayOptions.layoutControls.primaryColor?o.displayOptions.layoutControls.primaryColor:"#333333";e.innerHTML='<div id="'+o.videoPlayerId+'_fluid_initial_play" class="fluid_initial_play" style="background-color:'+t+'"><div id="'+o.videoPlayerId+'_fluid_state_button" class="fluid_initial_play_button"></div></div>';var n=["click","touchstart"],i=n.forEach(function(t){return e.addEventListener(t,i)}),o.displayOptions.layoutControls.playButtonShowing||(document.getElementById(o.videoPlayerId+"_fluid_controls_container").classList.add("initial_controls_show"),e.style.opacity="0"),o.domRef.player.parentNode.insertBefore(e,null)},o.mainVideoReady=o.userActivityChecker=o.hasControlBar=o.isControlBarVisible=o.setVideoPreload=o.hideControlBar=o.showControlBar=function(e){if(o.isCurrentlyPlayingAd&&!o.domRef.player.paused&&o.toggleAdCountdown(!1),"mouseenter"===e.type&&(o.domRef.player.style.cursor="default"),o.hasControlBar()){for(var t=o.domRef.player.parentNode.getElementsByClassName("fluid_controls_container"),n=o.domRef.player.parentNode.getElementsByClassName("fp_logo"),i=0;i<t.length;i++)o.displayOptions.layoutControls.controlBar.animated?(t[i].classList.remove("fade_out"),t[i].classList.add("fade_in")):t[i].style.display="block";if(o.displayOptions.layoutControls.logo.hideWithControls)for(var r=0;r<n.length;r++)o.displayOptions.layoutControls.controlBar.animated?n[r]&&(n[r].classList.remove("fade_out"),n[r].classList.add("fade_in")):n[r]&&(n[r].style.display="block")}},o.linkControlBarUserActivity=o.initMute=o.initLoop=o.setBuffering=function(){for(var e,t=o.domRef.player.parentNode.getElementsByClassName("fluid_controls_buffered"),n=0;n<t.length;n++)t[n].style.width=0;e=setInterval(function(){var n=o.domRef.player.duration;if(!(n<=0)){for(var i=0;i<o.domRef.player.buffered.length;i++)if(!(o.domRef.player.buffered.start(o.domRef.player.buffered.length-1-i)>=o.domRef.player.currentTime)){for(var r=o.domRef.player.buffered.end(o.domRef.player.buffered.length-1-i)/n*100+"%",a=0;a<t.length;a++)t[a].style.width=r;e&&1==o.domRef.player.buffered.end(o.domRef.player.buffered.length-1-i)/n&&clearInterval(e);break}}},500)},o.createPlaybackList=function(){if(o.displayOptions.layoutControls.playbackRateEnabled){document.getElementById(o.videoPlayerId+"_fluid_control_playback_rate").style.display="inline-block";var e=document.getElementById(o.videoPlayerId+"_fluid_control_playback_rate"),t=document.createElement("div");t.id=o.videoPlayerId+"_fluid_control_video_playback_rate",t.className="fluid_video_playback_rates",t.style.display="none",Array.isArray(o.displayOptions.layoutControls.controlBar.playbackRates)&&!o.displayOptions.layoutControls.controlBar.playbackRates.some(||(o.displayOptions.layoutControls.controlBar.playbackRates=["x2","x1.5","x1","x0.5"]),o.displayOptions.layoutControls.controlBar.playbackRates.forEach(,e.appendChild(t),e.addEventListener("click",function(){o.openCloseVideoPlaybackRate()})}},o.openCloseVideoPlaybackRate=function(){var e=document.getElementById(o.videoPlayerId+"_fluid_control_video_playback_rate");o.isCurrentlyPlayingAd||"none"!==e.style.display?e.style.display="none":(e.style.display="block",e.addEventListener("mouseleave",)},o.createDownload=o.theatreToggle=o.defaultTheatre=function(){var e=document.getElementById("fluid_video_wrapper_"+o.videoPlayerId);if(o.theatreMode)return e.classList.remove("fluid_theatre_mode"),e.style.maxHeight="",e.style.marginTop="",e.style.left="",e.style.right="",e.style.position="",void(o.displayOptions.layoutControls.fillToContainer?(e.style.width="100%",e.style.height="100%"):(e.style.width=o.originalWidth+"px",e.style.height=o.originalHeight+"px"));e.classList.add("fluid_theatre_mode");var t=o.displayOptions.layoutControls.theatreSettings.width,n="10px";switch(e.style.width=t,e.style.height=o.displayOptions.layoutControls.theatreSettings.height,e.style.maxHeight=screen.height+"px",e.style.marginTop=o.displayOptions.layoutControls.theatreSettings.marginTop+"px",o.displayOptions.layoutControls.theatreSettings.horizontalAlign){case"center":"string"==typeof t&&"%"===t.substr(t.length-1)?n=(100-parseInt(t.substring(0,t.length-1)))/2+"%":"string"==typeof t&&"px"===t.substr(t.length-2)?n=(screen.width-parseInt(t.substring(0,t.length-2)))/screen.width*100/2+"%":console.log("[FP_ERROR] Theatre width specified invalid."),e.style.left=n;break;case"right":e.style.right=n;break;default:e.style.left=n}},o.posterImage=o.nextSource=o.inIframe=o.setPersistentSettings=function(){try{if("undefined"==typeof Storage||"undefined"==typeof localStorage)return}catch(e){return}var t="_fp_storage_enabled",n=localStorage;try{n.setItem(t,"1"),n.removeItem(t)}catch(i){return!1}if(o.fluidStorage=localStorage,void 0!==o.fluidStorage.fluidVolume&&o.displayOptions.layoutControls.persistentSettings.volume&&(o.setVolume(o.fluidStorage.fluidVolume),void 0!==o.fluidStorage.fluidMute&&"true"===o.fluidStorage.fluidMute&&o.muteToggle()),void 0!==o.fluidStorage.fluidQuality&&o.displayOptions.layoutControls.persistentSettings.quality){var r=document.getElementById("source_"+o.videoPlayerId+"_"+o.fluidStorage.fluidQuality),a=document.getElementById(o.videoPlayerId+"_fluid_control_video_source");r&&(r.click(),a.click())}void 0!==o.fluidStorage.fluidSpeed&&o.displayOptions.layoutControls.persistentSettings.speed&&o.setPlaybackSpeed(o.fluidStorage.fluidSpeed),void 0!==o.fluidStorage.fluidTheatre&&"true"===o.fluidStorage.fluidTheatre&&o.displayOptions.layoutControls.persistentSettings.theatre&&o.theatreToggle()},o.play=o.pause=o.skipTo=o.setPlaybackSpeed=o.setVolume=o.isCurrentlyPlayingVideo=o.setHtmlOnPauseBlock=o.toggleControlBar=o.on=o.toggleLogo=o.trackEvent=o.registerListener=o.copyEvents=function(e){for(var t in o.events)if(o.events.hasOwnProperty(t)){for(var n in o.events[t])if(o.events[t].hasOwnProperty(n))for(var i=0;i<o.events[t][n].length;i++)o.registerListener(e,n,t,o.events[t][n][i])}},o.destroy=,A=function(e){this.play=function(){return e.play()},this.pause=function(){return e.pause()},this.skipTo=function(t){return e.skipTo(t)},this.setPlaybackSpeed=function(t){return e.setPlaybackSpeed(t)},this.setVolume=function(t){return e.setVolume(t)},this.setHtmlOnPauseBlock=function(t){return e.setHtmlOnPauseBlock(t)},this.toggleControlBar=function(t){return e.toggleControlBar(t)},this.toggleFullScreen=function(t){return e.fullscreenToggle(t)},this.destroy=function(){return e.destroy()},this.dashInstance=function(){return e.dashPlayer?e.dashPlayer:null},this.hlsInstance=this.on=this.setDebug=,k=I=s(379),x=s.n(I),L=s(795),P=s.n(L),E=s(569),_=s.n(E),T=s(565),O=s.n(T),M=s(216),R=s.n(M),S=s(589),N=s.n(S),B=s(410),V={};V.styleTagTransform=N(),V.setAttributes=O(),V.insert=_().bind(null,"head"),V.domAPI=P(),V.insertStyleElement=R(),x()(B.Z,V),B.Z&&B.Z.locals&&B.Z.locals,window&&(window.fluidPlayer||(window.fluidPlayer=k))}()}();

//# hls.min.js
!function t(e){var i,r;i=this,r=function(){"use strict";h(t,e,i){return(h=!)?Reflect.construct.bind()).apply(null,arguments)}function f(t){var e="function"==typeof Map?new Map:void 0;return(f=function t(i){var r;if(null===i||(r=i,-1===Function.toString.call(r).indexOf("[native code]")))return i;if("function"!=typeof i)throw TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(i))return e.get(i);e.set(i,n)}eturn n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),d(n,i)})(t)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function $(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(t){var e=function t(e,i){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,i||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(t,"string");return"symbol"==typeof e?e:String(e)}var v,m,p,y,T,x,E,S,L,R={exports:{}};y=R,T=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,x=/^(?=([^\/?#]*))\1([^]*)$/,E=/(?:\/|^)\.(?=\/)/g,S=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,L={buildAbsoluteURL:parseURL:normalizePath:buildURLFromParts:,y.exports=L;var A,_,I,D=R.exports,k=Number.isFinite||b=((A={}).MEDIA_ATTACHING="hlsMediaAttaching",A.MEDIA_ATTACHED="hlsMediaAttached",A.MEDIA_DETACHING="hlsMediaDetaching",A.MEDIA_DETACHED="hlsMediaDetached",A.BUFFER_RESET="hlsBufferReset",A.BUFFER_CODECS="hlsBufferCodecs",A.BUFFER_CREATED="hlsBufferCreated",A.BUFFER_APPENDING="hlsBufferAppending",A.BUFFER_APPENDED="hlsBufferAppended",A.BUFFER_EOS="hlsBufferEos",A.BUFFER_FLUSHING="hlsBufferFlushing",A.BUFFER_FLUSHED="hlsBufferFlushed",A.MANIFEST_LOADING="hlsManifestLoading",A.MANIFEST_LOADED="hlsManifestLoaded",A.MANIFEST_PARSED="hlsManifestParsed",A.LEVEL_SWITCHING="hlsLevelSwitching",A.LEVEL_SWITCHED="hlsLevelSwitched",A.LEVEL_LOADING="hlsLevelLoading",A.LEVEL_LOADED="hlsLevelLoaded",A.LEVEL_UPDATED="hlsLevelUpdated",A.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",A.LEVELS_UPDATED="hlsLevelsUpdated",A.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",A.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",A.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",A.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",A.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",A.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",A.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",A.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",A.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",A.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",A.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",A.CUES_PARSED="hlsCuesParsed",A.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",A.INIT_PTS_FOUND="hlsInitPtsFound",A.FRAG_LOADING="hlsFragLoading",A.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",A.FRAG_LOADED="hlsFragLoaded",A.FRAG_DECRYPTED="hlsFragDecrypted",A.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",A.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",A.FRAG_PARSING_METADATA="hlsFragParsingMetadata",A.FRAG_PARSED="hlsFragParsed",A.FRAG_BUFFERED="hlsFragBuffered",A.FRAG_CHANGED="hlsFragChanged",A.FPS_DROP="hlsFpsDrop",A.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",A.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",A.ERROR="hlsError",A.DESTROYING="hlsDestroying",A.KEY_LOADING="hlsKeyLoading",A.KEY_LOADED="hlsKeyLoaded",A.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",A.BACK_BUFFER_REACHED="hlsBackBufferReached",A.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",A),C=((_={}).NETWORK_ERROR="networkError",_.MEDIA_ERROR="mediaError",_.KEY_SYSTEM_ERROR="keySystemError",_.MUX_ERROR="muxError",_.OTHER_ERROR="otherError",_),w=((I={}).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",I.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",I.KEY_SYSTEM_NO_SESSION="keySystemNoSession",I.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",I.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",I.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",I.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",I.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",I.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",I.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",I.MANIFEST_LOAD_ERROR="manifestLoadError",I.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",I.MANIFEST_PARSING_ERROR="manifestParsingError",I.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",I.LEVEL_EMPTY_ERROR="levelEmptyError",I.LEVEL_LOAD_ERROR="levelLoadError",I.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",I.LEVEL_PARSING_ERROR="levelParsingError",I.LEVEL_SWITCH_ERROR="levelSwitchError",I.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",I.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",I.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",I.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",I.FRAG_LOAD_ERROR="fragLoadError",I.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",I.FRAG_DECRYPT_ERROR="fragDecryptError",I.FRAG_PARSING_ERROR="fragParsingError",I.FRAG_GAP="fragGap",I.REMUX_ALLOC_ERROR="remuxAllocError",I.KEY_LOAD_ERROR="keyLoadError",I.KEY_LOAD_TIMEOUT="keyLoadTimeOut",I.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",I.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",I.BUFFER_APPEND_ERROR="bufferAppendError",I.BUFFER_APPENDING_ERROR="bufferAppendingError",I.BUFFER_STALLED_ERROR="bufferStalledError",I.BUFFER_FULL_ERROR="bufferFullError",I.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",I.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",I.INTERNAL_EXCEPTION="internalException",I.INTERNAL_ABORTED="aborted",I.UNKNOWN="unknown",I),P=function t(){},F={trace:P,debug:P,log:P,warn:P,info:P,error:P},O=F;function N(t,e){if(self.console&&!0===t||"object"==typeof t){!function t(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];r.forEach(function(t){var i,r;O[t]=e[t]?e[t].bind(e):(i=t,(r=self.console[i])?r.bind(self.console,"["+i+"] >"):P)})}(t,"debug","log","info","warn","error");try{O.log('Debug logs enabled for "'+e+'" in hls.js version 1.5.0-alpha.0.pr.bugfix-chrome-avc-gaps-m-ts.767b697a')}catch(i){O=F}}else O=F}var M=O,B=/^(\d+)x(\d+)$/,U=/(.+?)=(".*?"|.*?)(?:,|$)/g,G=function(){ar e=t.prototype;return e.decimalInteger=function t(e){var i=parseInt(this[e],10);return i>Number.MAX_SAFE_INTEGER?1/0:i},e.hexadecimalInteger=function t(e){if(!this[e])return null;var i=(this[e]||"0x").slice(2);i=(1&i.length?"0":"")+i;for(var r=new Uint8Array(i.length/2),n=0;n<i.length/2;n++)r[n]=parseInt(i.slice(2*n,2*n+2),16);return r},e.hexadecimalIntegerAsNumber=function t(e){var i=parseInt(this[e],16);return i>Number.MAX_SAFE_INTEGER?1/0:i},e.decimalFloatingPoint=e.optionalFloat=e.enumeratedString=e.bool=function t(e){return"YES"===this[e]},e.decimalResolution=function t(e){var i=B.exec(this[e]);if(null!==i)return{width:parseInt(i[1],10),height:parseInt(i[2],10)}},t.parseAttrList=function t(e){var i,r={};for(U.lastIndex=0;null!==(i=U.exec(e));){var n=i[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[i[1].trim()]=n}return r},t}();r V=function(){eturn a(t,[{key:"id",get:function t(){return this.attr.ID}},{key:"class",get:function t(){return this.attr.CLASS}},{key:"startDate",get:function t(){return this._startDate}},{key:"endDate",get:function t(){if(this._endDate)return this._endDate;var e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}},{key:"duration",get:function t(){if("DURATION"in this.attr){var e=this.attr.decimalFloatingPoint("DURATION");if(k(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function t(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}},{key:"endOnNext",get:,{key:"isValid",get:function t(){return!!this.id&&!this._badValueForSameId&&k(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),t}(),Y=W={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"},q=function(){eturn t.prototype.setByteRange=function t(e,i){var r=e.split("@",2),n=[];1===r.length?n[0]=i?i.byteRangeEndOffset:0:n[0]=parseInt(r[1]),n[1]=parseInt(r[0])+n[0],this._byteRange=n},a(t,[{key:"byteRange",get:,{key:"byteRangeStartOffset",get:function t(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:,{key:"url",get:function t(){return!this._url&&this.baseurl&&this.relurl&&(this._url=D.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function t(e){this._url=e}}]),t}(),X=function(t){(e,t);var i=e.prototype;return i.setKeyFormat=function t(e){if(this.levelkeys){var i=this.levelkeys[e];i&&!this._decryptdata&&(this._decryptdata=i.getDecryptData(this.sn))}},i.abortRequests=function t(){var e,i;null==(e=this.loader)||e.abort(),null==(i=this.keyLoader)||i.abort()},i.setElementaryStreamInfo=function t(e,i,r,n,a,s){void 0===s&&(s=!1);var o=this.elementaryStreams,l=o[e];if(!l){o[e]={startPTS:i,endPTS:r,startDTS:n,endDTS:a,partial:s};return}l.startPTS=Math.min(l.startPTS,i),l.endPTS=Math.max(l.endPTS,r),l.startDTS=Math.min(l.startDTS,n),l.endDTS=Math.max(l.endDTS,a)},i.clearElementaryStreamInfo=function t(){var e=this.elementaryStreams;e[W.AUDIO]=null,e[W.VIDEO]=null,e[W.AUDIOVIDEO]=null},a(e,[{key:"decryptdata",get:function t(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{var i=Object.keys(this.levelkeys);if(1===i.length)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function t(){return this.start+this.duration}},{key:"endProgramDateTime",get:function t(){if(null===this.programDateTime||!k(this.programDateTime))return null;var e=k(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function t(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){var i=Object.keys(this.levelkeys),r=i.length;if(r>1||1===r&&this.levelkeys[i[0]].encrypted)return!0}return!1}}]),e}(q),z=function(t){function e(e,i,r,n,a){(s=t.call(this,r)||this).fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.stats=new Y,s.duration=e.decimalFloatingPoint("DURATION"),s.gap=e.bool("GAP"),s.independent=e.bool("INDEPENDENT"),s.relurl=e.enumeratedString("URI"),s.fragment=i,s.index=n;var s,o=e.enumeratedString("BYTERANGE");return o&&s.setByteRange(o,a),a&&(s.fragOffset=a.fragOffset+a.duration),s}return l(e,t),a(e,[{key:"start",get:,{key:"end",get:,{key:"loaded",get:]),e}(q),j=function(){eturn t.prototype.reloaded=function t(e){if(!e){this.advanced=!0,this.updated=!0;return}var i=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!i||!this.live,this.advanced=this.endSN>e.endSN||i>0||0===i&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay},a(t,[{key:"hasProgramDateTime",get:function t(){return!!this.fragments.length&&k(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:,{key:"drift",get:,{key:"edge",get:,{key:"partEnd",get:function t(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function t(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:,{key:"lastPartIndex",get:function t(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function t(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),t}();r J={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},tt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function te(t){switch(t){case tt.FAIRPLAY:return J.FAIRPLAY;case tt.PLAYREADY:return J.PLAYREADY;case tt.WIDEVINE:return J.WIDEVINE;case tt.CLEARKEY:return J.CLEARKEY}}var ti={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};r ta="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;ar to=function t(e,i){return!!(i+10<=e.length)&&73===e[i]&&68===e[i+1]&&51===e[i+2]&&!!(e[i+3]<255)&&!!(e[i+4]<255)&&!!(e[i+6]<128)&&!!(e[i+7]<128)&&!!(e[i+8]<128)&&!!(e[i+9]<128)},tl=function t(e,i){return!!(i+10<=e.length)&&51===e[i]&&68===e[i+1]&&73===e[i+2]&&!!(e[i+3]<255)&&!!(e[i+4]<255)&&!!(e[i+6]<128)&&!!(e[i+7]<128)&&!!(e[i+8]<128)&&!!(e[i+9]<128)},tu=function t(e,i){for(var r=i,n=0;to(e,i);){n+=10;var a=td(e,i+6);n+=a,tl(e,i+10)&&(n+=10),i+=n}if(n>0)return e.subarray(r,r+n)},td=th=tf=tc=t$=tg=tv=tm=tp=ty=tT=function t(e,i){void 0===i&&(i=!1);var r,n,a,s=(v||void 0===self.TextDecoder||(v=new self.TextDecoder("utf-8")),v);if(s){var o=s.decode(e);if(i){var l=o.indexOf("\0");return -1!==l?o.substring(0,l):o}return o.replace(/\0/g,"")}for(var u=e.length,d="",h=0;h<u&&(0!==(r=e[h++])||!i);)if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:d+=String.fromCharCode(r);break;case 12:case 13:d+=String.fromCharCode((31&r)<<6|63&(n=e[h++]));break;case 14:d+=String.fromCharCode((15&r)<<12|(63&(n=e[h++]))<<6|(63&(a=e[h++]))<<0)}return d},tx={hexDump:function t(e){for(var i="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length<2&&(n="0"+n),i+=n}return i}},tE=[].push,tS={video:1,audio:2,id3:3,text:4};on tk(t){var e=[],i=t[0],r=8,n=tA(t,r);r+=4,0===i?r+=8:r+=16,r+=2;var a=t.length+0,s=tR(t,r);r+=2;for(var o=0;o<s;o++){var l=r,u=tA(t,l);l+=4;var d=2147483647&u;if(1==(2147483648&u)>>>31)return M.warn("SIDX has hierarchical references (not supported)"),null;var h=tA(t,l);l+=4,e.push({referenceSize:d,subsegmentDuration:h,info:{duration:h/n,start:a,end:a+d-1}}),a+=d,l+=4,r=l}return{earliestPresentationTime:0,timescale:n,version:i,referencesCount:s,references:e}}function tb(t){for(var e=[],i=tD(t,["moov","trak"]),n=0;n<i.length;n++){var a=i[n],s=tD(a,["tkhd"])[0];if(s){var o=s[0],l=tA(s,0===o?12:20),u=tD(a,["mdia","mdhd"])[0];if(u){o=u[0];var d=tA(u,0===o?12:20),h=tD(a,["mdia","hdlr"])[0];if(h){var f=tL(h.subarray(8,12)),c={soun:W.AUDIO,vide:W.VIDEO}[f];if(c){var $=tD(a,["mdia","minf","stbl","stsd"])[0],g=tC($);e[l]={timescale:d,type:c},e[c]=r({timescale:d,id:l},g)}}}}}return tD(t,["moov","mvex","trex"]).forEach(,e}function tC(t){var e=t.subarray(8),i=e.subarray(86),r=tL(e.subarray(4,8)),n=r,a="enca"===r||"encv"===r;if(a){var s=tD(e,[r])[0].subarray("enca"===r?28:78);tD(s,["sinf"]).forEach(}switch(n){case"avc1":case"avc2":case"avc3":case"avc4":n+="."+t8(t[111])+t8(t[112])+t8(t[113]);break;case"mp4a":var o=tD(e,[r])[0],l=tD(o.subarray(28),["esds"])[0];l&&l.length>12&&0!==l[11]&&(n+="."+t8(l[11]),n+="."+(l[12]>>>2&63).toString(16).toUpperCase());break;case"hvc1":case"hev1":var u=tD(i,["hvcC"])[0],d=u[1],h=["","A","B","C"][d>>6],f=tA(u,2),c=u[12],$=u.subarray(6,12);n+="."+h+(31&d),n+="."+f.toString(16).toUpperCase(),n+="."+((32&d)>>5?"H":"L")+c;for(var g="",v=$.length;v--;){var m=$[v];(m||g)&&(g="."+m.toString(16).toUpperCase()+g)}n+=g;break;case"dvh1":case"dvhe":var p=tD(i,["dvcC"])[0],y=p[2]>>1&127,T=p[2]<<5&32|p[3]>>3&31;n+="."+tw(y)+"."+tw(T);break;case"vp09":var x=tD(i,["vpcC"])[0],E=x[4],S=x[5],L=x[6]>>4&15;n+="."+tw(E)+"."+tw(S)+"."+tw(L);break;case"av01":var R=tD(i,["av1C"])[0],A=R[1]>>>5,_=31&R[1],I=R[2]>>>7?"H":"M",D=(64&R[2])>>6,k=(32&R[2])>>5,b=(16&R[2])>>4,C=(8&R[2])>>3,w=(4&R[2])>>2,P=3&R[2];n+="."+A+"."+tw(_)+I+"."+tw(2===A&&D?k?12:10:D?10:8)+"."+b+"."+C+w+P+"."+tw(1)+"."+tw(1)+"."+tw(1)+".0"}return{codec:n,encrypted:a}}ction tF(t){var e=tA(t,0),i=8;1&e&&(i+=4),4&e&&(i+=4);for(var r=0,n=tA(t,4),a=0;a<n;a++){if(256&e){var s=tA(t,i);r+=s,i+=4}512&e&&(i+=4),1024&e&&(i+=4),2048&e&&(i+=4)}return r}unction tN(t,e){var i=[],r=e.samples,n=e.timescale,a=e.id,s=!1;return tD(r,["moof"]).map(function(o){var l=o.byteOffset-8;tD(o,["traf"]).map(function(o){var u=tD(o,["tfdt"]).map([0];return void 0!==u&&(t=u),tD(o,["tfhd"]).map(function(u){var d=tA(u,4),h=16777215&tA(u,0),f=0,c=0,$=8;d===a&&((1&h)!=0&&($+=8),(2&h)!=0&&($+=4),(8&h)!=0&&(f=tA(u,$),$+=4),(16&h)!=0&&(c=tA(u,$),$+=4),(32&h)!=0&&($+=4),"video"===e.type&&(s=function t(e){if(!e)return!1;var i=e.indexOf("."),r=i<0?e:e.substring(0,i);return"hvc1"===r||"hev1"===r||"dvh1"===r||"dvhe"===r}(e.codec)),tD(o,["trun"]).map(function(a){var o=a[0],u=16777215&tA(a,0),d=0,h=(256&u)!=0,$=0,g=(512&u)!=0,v=0,m=(1024&u)!=0,p=(2048&u)!=0,y=0,T=tA(a,4),x=8;(1&u)!=0&&(d=tA(a,x),x+=4),(4&u)!=0&&(x+=4);for(var E=d+l,S=0;S<T;S++){if(h?($=tA(a,x),x+=4):$=f,g?(v=tA(a,x),x+=4):v=c,m&&(x+=4),p&&(y=0===o?tA(a,x):t_(a,x),x+=4),e.type===W.VIDEO)for(var L=0;L<v;){var R=tA(r,E);if(tM(s,r[E+=4])){var A=r.subarray(E,E+R);tB(A,s?2:1,t+y/n,i)}E+=R,L+=R+4}t+=$/n}}))})})}),i}function tM(t,e){if(!t)return 6==(31&e);var i=e>>1&63;return 39===i||40===i}function tB(t,e,i,r){var n=tU(t),a=0;a+=e;for(var s=0,o=0,l=!1,u=0;a<n.length;){s=0;do{if(a>=n.length)break;s+=u=n[a++]}while(255===u);o=0;do{if(a>=n.length)break;o+=u=n[a++]}while(255===u);var d=n.length-a;if(!l&&4===s&&a<n.length){if(l=!0,181===n[a++]){var h=tR(n,a);if(a+=2,49===h){var f=tA(n,a);if(a+=4,1195456820===f){var c=n[a++];if(3===c){var $=n[a++],g=31&$,v=64&$,m=v?2+3*g:0,p=new Uint8Array(m);if(v){p[0]=$;for(var y=1;y<m;y++)p[y]=n[a++]}r.push({type:c,payloadType:s,pts:i,bytes:p})}}}}}else if(5===s&&o<d){if(l=!0,o>16){for(var T=[],x=0;x<16;x++){var E=n[a++].toString(16);T.push(1==E.length?"0"+E:E),(3===x||5===x||7===x||9===x)&&T.push("-")}for(var S=o-16,L=new Uint8Array(S),R=0;R<S;R++)L[R]=n[a++];r.push({payloadType:s,pts:i,uuid:T.join(""),userData:tT(L),userDataBytes:L})}}else if(o<d)a+=o;else if(o>d)break}}ar t0={},t2=function(){.clearKeyUriToKeyIdMap=var e=t.prototype;return e.isSupported=function t(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case tt.FAIRPLAY:case tt.WIDEVINE:case tt.PLAYREADY:case tt.CLEARKEY:return -1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1},e.getDecryptData=function e(i){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof i&&("AES-128"!==this.method||this.iv||M.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),i=0);var r=function t(e){for(var i=new Uint8Array(16),r=12;r<16;r++)i[r]=e>>8*(15-r)&255;return i}(i);return new t(this.method,this.uri,"identity",this.keyFormatVersions,r)}var n=function t(e){var i=e.split(":"),r=null;if("data"===i[0]&&2===i.length){var n=i[1].split(";"),a=n[n.length-1].split(",");if(2===a.length){var s,o,l,u="base64"===a[0],d=a[1];u?(n.splice(-1,1),r=Q(d)):r=(o=Z(s=d).subarray(0,16),(l=new Uint8Array(16)).set(o,16-o.length),l)}}return r}(this.uri);if(n)switch(this.keyFormat){case tt.WIDEVINE:this.pssh=n,n.length>=22&&(this.keyId=n.subarray(n.length-22,n.length-6));break;case tt.PLAYREADY:var a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function t(e,i,r){if(16!==e.byteLength)throw RangeError("Invalid system id");if(i){n=1,a=new Uint8Array(16*i.length);for(var n,a,s,o=0;o<i.length;o++){var l=i[o];if(16!==l.byteLength)throw RangeError("Invalid key");a.set(l,16*o)}}else n=0,a=new Uint8Array;n>0?(s=new Uint8Array(4),i.length>0&&new DataView(s.buffer).setUint32(0,i.length,!1)):s=new Uint8Array;var u=new Uint8Array(4);return r&&r.byteLength>0&&new DataView(u.buffer).setUint32(0,r.byteLength,!1),function t(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];for(var a=r.length,s=8,o=a;o--;)s+=r[o].byteLength;var l=new Uint8Array(s);for(l[0]=s>>24&255,l[1]=s>>16&255,l[2]=s>>8&255,l[3]=255&s,l.set(e,4),o=0,s=8;o<a;o++)l.set(r[o],s),s+=r[o].byteLength;return l}([112,115,115,104],new Uint8Array([n,0,0,0]),e,s,a,u,r||new Uint8Array)}(a,null,n);var s=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),o=String.fromCharCode.apply(null,Array.from(s)),l=o.substring(o.indexOf("<"),o.length),u=new DOMParser().parseFromString(l,"text/xml").getElementsByTagName("KID")[0];if(u){var d=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(d){var h,f,c=Q(d).subarray(0,16);h=c,(f=function t(e,i,r){var n=e[i];e[i]=e[r],e[r]=n})(h,0,3),f(h,1,2),f(h,4,5),f(h,6,7),this.keyId=c}}break;default:var $=n.subarray(0,16);if(16!==$.length){var g=new Uint8Array(16);g.set($,16-$.length),$=g}this.keyId=$}if(!this.keyId||16!==this.keyId.byteLength){var v=t0[this.uri];if(!v){var m=Object.keys(t0).length%Number.MAX_SAFE_INTEGER;v=new Uint8Array(16),new DataView(v.buffer,12,4).setUint32(0,m),t0[this.uri]=v}this.keyId=v}return this},t}(),tG=/\{\$([a-zA-Z0-9-_]+)\}/g;nction tK(t,e){if(null!==t.variableList||t.hasVariableRefs){var i=t.variableList;return e.replace(tG,function(e){var r=e.substring(2,e.length-1),n=null==i?void 0:i[r];return void 0===n?(t.playlistParsingError||(t.playlistParsingError=Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'+r+'"')),e):n})}return e}function t4(t,e,i){var r,n,a=t.variableList;if(a||(t.variableList=a={}),"QUERYPARAM"in e){r=e.QUERYPARAM;try{var s=new self.URL(i).searchParams;if(s.has(r))n=s.get(r);else throw Error('"'+r+'" does not match any query parameter in URI: "'+i+'"')}catch(o){t.playlistParsingError||(t.playlistParsingError=Error("EXT-X-DEFINE QUERYPARAM: "+o.message))}}else r=e.NAME,n=e.VALUE;r in a?t.playlistParsingError||(t.playlistParsingError=Error('EXT-X-DEFINE duplicate Variable Name declarations: "'+r+'"')):a[r]=n||""}function t3(t,e,i){var r=e.IMPORT;if(i&&r in i){var n=t.variableList;n||(t.variableList=n={}),n[r]=i[r]}else t.playlistParsingError||(t.playlistParsingError=Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'+r+'"'))}ar tV={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};unction t7(t,e,i){void 0===i&&(i=!0);var r,n=tH(i);return null!=(r=null==n?void 0:n.isTypeSupported(tW(t,e)))&&r}r tq={},tX=/flac|opus/i;function tz(t,e){return void 0===e&&(e=!0),t.replace(tX,function(t){return function t(e,i){if(void 0===i&&(i=!0),tq[e])return tq[e];for(var r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[e],n=0;n<r.length;n++)if(t7(r[n],"audio",i))return tq[e]=r[n],r[n];return e}(t.toLowerCase(),e)})}ar tQ=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,t9=/#EXT-X-MEDIA:(.*)/g,tZ=/^#EXT(?:INF|-X-TARGETDURATION):/m,tJ=RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),et=RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),ee=function(){function t(){}return t.findGroup=function t(e,i){for(var r=0;r<e.length;r++){var n=e[r];if(n.id===i)return n}},t.convertAVC1ToAVCOTI=function t(e){var i=e.split(".");if(i.length>2){var r=i.shift()+".";return r+=parseInt(i.shift()).toString(16),r+=("000"+parseInt(i.shift()).toString(16)).slice(-4)}return e},t.resolve=t.isMediaPlaylist=function t(e){return tZ.test(e)},t.parseMasterPlaylist=function e(i,r){var n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:t1(i)},a=[];for(tQ.lastIndex=0;null!=(s=tQ.exec(i));)if(s[1]){var s,o,l=new G(s[1]);t6(n,l,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);var u=tK(n,s[2]),d={attrs:l,bitrate:l.decimalInteger("BANDWIDTH")||l.decimalInteger("AVERAGE-BANDWIDTH"),name:l.NAME,url:t.resolve(u,r)},h=l.decimalResolution("RESOLUTION");h&&(d.width=h.width,d.height=h.height),en((l.CODECS||"").split(/[ ,]+/).filter(function(t){return t}),d),d.videoCodec&&-1!==d.videoCodec.indexOf("avc1")&&(d.videoCodec=t.convertAVC1ToAVCOTI(d.videoCodec)),null!=(o=d.unknownCodecs)&&o.length||a.push(d),n.levels.push(d)}else if(s[3]){var f=s[3],c=s[4];switch(f){case"SESSION-DATA":var $=new G(c);t6(n,$,["DATA-ID","LANGUAGE","VALUE","URI"]);var g=$["DATA-ID"];g&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[g]=$);break;case"SESSION-KEY":var v=ei(c,r,n);v.encrypted&&v.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(v)):M.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+c+'"');break;case"DEFINE":var m=new G(c);t6(n,m,["NAME","VALUE","QUERYPARAM"]),t4(n,m,r);break;case"CONTENT-STEERING":var p=new G(c);t6(n,p,["SERVER-URI","PATHWAY-ID"]),n.contentSteering={uri:t.resolve(p["SERVER-URI"],r),pathwayId:p["PATHWAY-ID"]||"."};break;case"START":n.startTimeOffset=er(c)}}var y=a.length>0&&a.length<n.levels.length;return n.levels=y?a:n.levels,0===n.levels.length&&(n.playlistParsingError=Error("no levels found in manifest")),n},t.parseMasterPlaylistMedia=function e(i,r,n){var a,s={},o=n.levels,l={AUDIO:o.map(function(t){return{id:t.attrs.AUDIO,audioCodec:t.audioCodec}}),SUBTITLES:o.map(,"CLOSED-CAPTIONS":[]},u=0;for(t9.lastIndex=0;null!==(a=t9.exec(i));){var d=new G(a[1]),h=d.TYPE;if(h){var f=l[h],c=s[h]||[];s[h]=c,t6(n,d,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);var $={attrs:d,bitrate:0,id:u++,groupId:d["GROUP-ID"]||"",instreamId:d["INSTREAM-ID"],name:d.NAME||d.LANGUAGE||"",type:h,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:d.LANGUAGE,url:d.URI?t.resolve(d.URI,r):""};if(null!=f&&f.length){var g=t.findGroup(f,$.groupId)||f[0];ea($,g,"audioCodec"),ea($,g,"textCodec")}c.push($)}}return s},t.parseLevelPlaylist=function t(e,i,r,n,a,s){var l,u,d,h=new j(i),f=h.fragments,c=null,$=0,g=0,v=0,m=0,p=null,y=new X(n,i),T=-1,x=!1;for(tJ.lastIndex=0,h.m3u8=e,h.hasVariableRefs=t1(e);null!==(l=tJ.exec(e));){x&&(x=!1,(y=new X(n,i)).start=v,y.sn=$,y.cc=m,y.level=r,c&&(y.initSegment=c,y.rawProgramDateTime=c.rawProgramDateTime,c.rawProgramDateTime=null));var E=l[1];if(E){y.duration=parseFloat(E);var S=(" "+l[2]).slice(1);y.title=S||null,y.tagList.push(S?["INF",E,S]:["INF",E])}else if(l[3]){if(k(y.duration)){y.start=v,d&&el(y,d,h),y.sn=$,y.level=r,y.cc=m,y.urlId=a,f.push(y);var L=(" "+l[3]).slice(1);y.relurl=tK(h,L),es(y,p),p=y,v+=y.duration,$++,g=0,x=!0}}else if(l[4]){var R=(" "+l[4]).slice(1);p?y.setByteRange(R,p):y.setByteRange(R)}else if(l[5])y.rawProgramDateTime=(" "+l[5]).slice(1),y.tagList.push(["PROGRAM-DATE-TIME",y.rawProgramDateTime]),-1===T&&(T=f.length);else{if(!(l=l[0].match(et))){M.warn("No matches on slow regex match for level playlist!");continue}for(u=1;u<l.length&&void 0===l[u];u++);var A=(" "+l[u]).slice(1),_=(" "+l[u+1]).slice(1),I=l[u+2]?(" "+l[u+2]).slice(1):"";switch(A){case"PLAYLIST-TYPE":h.type=_.toUpperCase();break;case"MEDIA-SEQUENCE":$=h.startSN=parseInt(_);break;case"SKIP":var D=new G(_);t6(h,D,["RECENTLY-REMOVED-DATERANGES"]);var b=D.decimalInteger("SKIPPED-SEGMENTS");if(k(b)){h.skippedSegments=b;for(var C=b;C--;)f.unshift(null);$+=b}var w=D.enumeratedString("RECENTLY-REMOVED-DATERANGES");w&&(h.recentlyRemovedDateranges=w.split("	"));break;case"TARGETDURATION":h.targetduration=Math.max(parseInt(_),1);break;case"VERSION":h.version=parseInt(_);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"#":(_||I)&&y.tagList.push(I?[_,I]:[_]);break;case"DISCONTINUITY":m++,y.tagList.push(["DIS"]);break;case"GAP":y.gap=!0,y.tagList.push([A]);break;case"BITRATE":y.tagList.push([A,_]);break;case"DATERANGE":var P=new G(_);t6(h,P,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),t6(h,P,P.clientAttrs);var F=new V(P,h.dateRanges[P.ID]);F.isValid||h.skippedSegments?h.dateRanges[F.id]=F:M.warn('Ignoring invalid DATERANGE tag: "'+_+'"'),y.tagList.push(["EXT-X-DATERANGE",_]);break;case"DEFINE":var O=new G(_);t6(h,O,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in O?t3(h,O,s):t4(h,O,i);break;case"DISCONTINUITY-SEQUENCE":m=parseInt(_);break;case"KEY":var N=ei(_,i,h);if(N.isSupported()){if("NONE"===N.method){d=void 0;break}d||(d={}),d[N.keyFormat]&&(d=o({},d)),d[N.keyFormat]=N}else M.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+_+'"');break;case"START":h.startTimeOffset=er(_);break;case"MAP":var B=new G(_);if(t6(h,B,["BYTERANGE","URI"]),y.duration){var U=new X(n,i);eo(U,B,r,d),c=U,y.initSegment=c,c.rawProgramDateTime&&!y.rawProgramDateTime&&(y.rawProgramDateTime=c.rawProgramDateTime)}else eo(y,B,r,d),c=y,x=!0;break;case"SERVER-CONTROL":var K=new G(_);h.canBlockReload=K.bool("CAN-BLOCK-RELOAD"),h.canSkipUntil=K.optionalFloat("CAN-SKIP-UNTIL",0),h.canSkipDateRanges=h.canSkipUntil>0&&K.bool("CAN-SKIP-DATERANGES"),h.partHoldBack=K.optionalFloat("PART-HOLD-BACK",0),h.holdBack=K.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var H=new G(_);h.partTarget=H.decimalFloatingPoint("PART-TARGET");break;case"PART":var Y=h.partList;Y||(Y=h.partList=[]);var W=g>0?Y[Y.length-1]:void 0,q=g++,Q=new G(_);t6(h,Q,["BYTERANGE","URI"]);var Z=new z(Q,y,i,q,W);Y.push(Z),y.duration+=Z.duration;break;case"PRELOAD-HINT":var J=new G(_);t6(h,J,["URI"]),h.preloadHint=J;break;case"RENDITION-REPORT":var tt=new G(_);t6(h,tt,["URI"]),h.renditionReports=h.renditionReports||[],h.renditionReports.push(tt);break;default:M.warn("line parsed but not handled: "+l)}}}p&&!p.relurl?(f.pop(),v-=p.duration,h.partList&&(h.fragmentHint=p)):h.partList&&(es(y,p),y.cc=m,h.fragmentHint=y,d&&el(y,d,h));var te=f.length,ti=f[0],tr=f[te-1];if((v+=h.skippedSegments*h.targetduration)>0&&te&&tr){h.averagetargetduration=v/te;var tn=tr.sn;h.endSN="initSegment"!==tn?tn:0,h.live||(tr.endList=!0),ti&&(h.startCC=ti.cc)}else h.endSN=0,h.startCC=0;return h.fragmentHint&&(v+=h.fragmentHint.duration),h.totalduration=v,h.endCC=m,T>0&&function t(e,i){for(var r=e[i],n=i;n--;){var a=e[n];if(!a)return;a.programDateTime=r.programDateTime-1e3*a.duration,r=a}}(f,T),h},t}();nction en(t,e){["video","audio","text"].forEach(function(i){var r=t.filter(function(t){var e,r,n;return e=t,!!(n=tV[r=i])&&!!n[e.slice(0,4)]});r.length&&(e[i+"Codec"]=r.join(","),t=t.filter()}),e.unknownCodecs=t}eu={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ed={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function eh(t){var e=t.type;switch(e){case eu.AUDIO_TRACK:return ed.AUDIO;case eu.SUBTITLE_TRACK:return ed.SUBTITLE;default:return ed.MAIN}}ar ec=function(){ar e=t.prototype;return e.startLoad=function t(e){},e.stopLoad=function t(){this.destroyInternalLoaders()},e.registerListeners=function t(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},e.unregisterListeners=function t(){var e=this.hls;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},e.createInternalLoader=function t(e){var i=this.hls.config,r=i.pLoader,n=i.loader,a=new(r||n)(i);return this.loaders[e.type]=a,a},e.getInternalLoader=e.resetInternalLoader=function t(e){this.loaders[e]&&delete this.loaders[e]},e.destroyInternalLoaders=function t(){for(var e in this.loaders){var i=this.loaders[e];i&&i.destroy(),this.resetInternalLoader(e)}},e.destroy=function t(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()},e.onManifestLoading=function t(e,i){var r=i.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:eu.MANIFEST,url:r,deliveryDirectives:null})},e.onLevelLoading=function t(e,i){var r=i.id,n=i.level,a=i.url,s=i.deliveryDirectives;this.load({id:r,level:n,responseType:"text",type:eu.LEVEL,url:a,deliveryDirectives:s})},e.onAudioTrackLoading=function t(e,i){var r=i.id,n=i.groupId,a=i.url,s=i.deliveryDirectives;this.load({id:r,groupId:n,level:null,responseType:"text",type:eu.AUDIO_TRACK,url:a,deliveryDirectives:s})},e.onSubtitleTrackLoading=function t(e,i){var r=i.id,n=i.groupId,a=i.url,s=i.deliveryDirectives;this.load({id:r,groupId:n,level:null,responseType:"text",type:eu.SUBTITLE_TRACK,url:a,deliveryDirectives:s})},e.load=function t(e){var i,r,n,a=this,s=this.hls.config,l=this.getInternalLoader(e);if(l){var u=l.context;if(u&&u.url===e.url){M.trace("[playlist-loader]: playlist request ongoing");return}M.log("[playlist-loader]: aborting previous loader for type: "+e.type),l.abort()}if(i=e.type===eu.MANIFEST?s.manifestLoadPolicy.default:o({},s.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),l=this.createInternalLoader(e),k(null==(n=e.deliveryDirectives)?void 0:n.part)&&(e.type===eu.LEVEL&&null!==e.level?r=this.hls.levels[e.level].details:e.type===eu.AUDIO_TRACK&&null!==e.id?r=this.hls.audioTracks[e.id].details:e.type===eu.SUBTITLE_TRACK&&null!==e.id&&(r=this.hls.subtitleTracks[e.id].details),r)){var d=r.partTarget,h=r.targetduration;if(d&&h){var f=1e3*Math.max(3*d,.8*h);i=o({},i,{maxTimeToFirstByteMs:Math.min(f,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,i.maxTimeToFirstByteMs)})}}var c=i.errorRetry||i.timeoutRetry||{},$={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0};l.load(e,$,{onSuccess:function t(e,i,r,n){var s=a.getInternalLoader(r);a.resetInternalLoader(r.type);var o=e.data;if(0!==o.indexOf("#EXTM3U")){a.handleManifestParsingError(e,r,Error("no EXTM3U delimiter"),n||null,i);return}i.parsing.start=performance.now(),ee.isMediaPlaylist(o)?a.handleTrackOrLevelPlaylist(e,i,r,n||null,s):a.handleMasterPlaylist(e,i,r,n)},onError:function t(e,i,r,n){a.handleNetworkError(i,r,!1,e,n)},onTimeout:function t(e,i,r){a.handleNetworkError(i,r,!0,void 0,e)}})},e.handleMasterPlaylist=function t(e,i,r,n){var a=this.hls,s=e.data,o=ef(e,r),l=ee.parseMasterPlaylist(s,o);if(l.playlistParsingError){this.handleManifestParsingError(e,r,l.playlistParsingError,n,i);return}var u=l.contentSteering,d=l.levels,h=l.sessionData,f=l.sessionKeys,c=l.startTimeOffset,$=l.variableList;this.variableList=$;var g=ee.parseMasterPlaylistMedia(s,o,l),v=g.AUDIO,m=void 0===v?[]:v,p=g.SUBTITLES,y=g["CLOSED-CAPTIONS"];m.length&&(m.some(function(t){return!t.url})||!d[0].audioCodec||d[0].attrs.AUDIO||(M.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new G({}),bitrate:0,url:""}))),a.trigger(b.MANIFEST_LOADED,{levels:d,audioTracks:m,subtitles:p,captions:y,contentSteering:u,url:o,stats:i,networkDetails:n,sessionData:h,sessionKeys:f,startTimeOffset:c,variableList:$})},e.handleTrackOrLevelPlaylist=function t(e,i,r,n,a){var s=this.hls,o=r.id,l=r.level,u=r.type,d=ef(e,r),h=k(o)?o:0,f=k(l)?l:h,c=eh(r),$=ee.parseLevelPlaylist(e.data,d,f,c,h,this.variableList);if(u===eu.MANIFEST){var g={attrs:new G({}),bitrate:0,details:$,name:"",url:d};s.trigger(b.MANIFEST_LOADED,{levels:[g],audioTracks:[],url:d,stats:i,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}i.parsing.end=performance.now(),r.levelDetails=$,this.handlePlaylistLoaded($,e,i,r,n,a)},e.handleManifestParsingError=function t(e,i,r,n,a){this.hls.trigger(b.ERROR,{type:C.NETWORK_ERROR,details:w.MANIFEST_PARSING_ERROR,fatal:i.type===eu.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:i,networkDetails:n,stats:a})},e.handleNetworkError=function t(e,i,n,a,s){void 0===n&&(n=!1);var o="A network "+(n?"timeout":"error"+(a?" (status "+a.code+")":""))+" occurred while loading "+e.type;e.type===eu.LEVEL?o+=": "+e.level+" id: "+e.id:(e.type===eu.AUDIO_TRACK||e.type===eu.SUBTITLE_TRACK)&&(o+=" id: "+e.id+' group-id: "'+e.groupId+'"');var l=Error(o);M.warn("[playlist-loader]: "+o);var u=w.UNKNOWN,d=!1,h=this.getInternalLoader(e);switch(e.type){case eu.MANIFEST:u=n?w.MANIFEST_LOAD_TIMEOUT:w.MANIFEST_LOAD_ERROR,d=!0;break;case eu.LEVEL:u=n?w.LEVEL_LOAD_TIMEOUT:w.LEVEL_LOAD_ERROR,d=!1;break;case eu.AUDIO_TRACK:u=n?w.AUDIO_TRACK_LOAD_TIMEOUT:w.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case eu.SUBTITLE_TRACK:u=n?w.SUBTITLE_TRACK_LOAD_TIMEOUT:w.SUBTITLE_LOAD_ERROR,d=!1}h&&this.resetInternalLoader(e.type);var f={type:C.NETWORK_ERROR,details:u,fatal:d,url:e.url,loader:h,context:e,error:l,networkDetails:i,stats:s};if(a){var c=(null==i?void 0:i.url)||e.url;f.response=r({url:c,data:void 0},a)}this.hls.trigger(b.ERROR,f)},e.handlePlaylistLoaded=function t(e,i,r,n,a,s){var o=this.hls,l=n.type,u=n.level,d=n.id,h=n.groupId,f=n.deliveryDirectives,c=ef(i,n),$=eh(n),g="number"==typeof n.level&&$===ed.MAIN?u:void 0;if(!e.fragments.length){var v=Error("No Segments found in Playlist");o.trigger(b.ERROR,{type:C.NETWORK_ERROR,details:w.LEVEL_EMPTY_ERROR,fatal:!1,url:c,error:v,reason:v.message,response:i,context:n,level:g,parent:$,networkDetails:a,stats:r});return}e.targetduration||(e.playlistParsingError=Error("Missing Target Duration"));var m=e.playlistParsingError;if(m){o.trigger(b.ERROR,{type:C.NETWORK_ERROR,details:w.LEVEL_PARSING_ERROR,fatal:!1,url:c,error:m,reason:m.message,response:i,context:n,level:g,parent:$,networkDetails:a,stats:r});return}switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),(!s.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case eu.MANIFEST:case eu.LEVEL:o.trigger(b.LEVEL_LOADED,{details:e,level:g||0,id:d||0,stats:r,networkDetails:a,deliveryDirectives:f});break;case eu.AUDIO_TRACK:o.trigger(b.AUDIO_TRACK_LOADED,{details:e,id:d||0,groupId:h||"",stats:r,networkDetails:a,deliveryDirectives:f});break;case eu.SUBTITLE_TRACK:o.trigger(b.SUBTITLE_TRACK_LOADED,{details:e,id:d||0,groupId:h||"",stats:r,networkDetails:a,deliveryDirectives:f})}},t}();unction eg(t,e){var i=t.mode;if("disabled"===i&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw Error("addCue is failed for: "+e)}catch(r){M.debug("[texttrack-utils]: "+r);try{var n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,t.addCue(n)}catch(a){M.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+a)}}"disabled"===i&&(t.mode=i)}unction em(t,e,i,r){var n=t.mode;if("disabled"===n&&(t.mode="hidden"),t.cues&&t.cues.length>0)for(var a=function t(e,i,r){var n=[],a=function t(e,i){if(i<e[0].startTime)return 0;var r=e.length-1;if(i>e[r].endTime)return -1;for(var n=0,a=r;n<=a;){var s=Math.floor((a+n)/2);if(i<e[s].startTime)a=s-1;else{if(!(i>e[s].startTime)||!(n<r))return s;n=s+1}}return e[n].startTime-i<i-e[a].startTime?n:a}(e,i);if(a>-1)for(var s=a,o=e.length;s<o;s++){var l=e[s];if(l.startTime>=i&&l.endTime<=r)n.push(l);else if(l.startTime>r)break}return n}(t.cues,e,i),s=0;s<a.length;s++)(!r||r(a[s]))&&t.removeCue(a[s]);"disabled"===n&&(t.mode=n)}var ep={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};ar eT=);r eS=function(){ar e=t.prototype;return e.destroy=function t(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},e._registerListeners=function t(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this)},e._unregisterListeners=function t(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this)},e.onMediaAttached=function t(e,i){this.media=i.media},e.onMediaDetaching=function t(){this.id3Track&&(ev(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},e.onManifestLoading=e.createTrack=function t(e){var i=this.getID3Track(e.textTracks);return i.mode="hidden",i},e.getID3Track=function t(e){if(this.media){for(var i=0;i<e.length;i++){var r=e[i];if("metadata"===r.kind&&"id3"===r.label)return e$(r,this.media),r}return this.media.addTextTrack("metadata","id3")}},e.onFragParsingMetadata=function t(e,i){if(this.media){var r=this.hls.config,n=r.enableEmsgMetadataCues,a=r.enableID3MetadataCues;if(n||a){var s=i.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var o=ey(),l=0;l<s.length;l++){var u=s[l].type;if((u!==ep.emsg||n)&&a){var d=t$(s[l].data);if(d){var h=s[l].pts,f=h+s[l].duration;f>eT&&(f=eT),f-h<=0&&(f=h+.25);for(var c=0;c<d.length;c++){var $=d[c];if(!tf($)){this.updateId3CueEnds(h,u);var g=new o(h,f,"");g.value=$,u&&(g.type=u),this.id3Track.addCue(g)}}}}}}}},e.updateId3CueEnds=function t(e,i){var r,n=null==(r=this.id3Track)?void 0:r.cues;if(n)for(var a=n.length;a--;){var s=n[a];s.type===i&&s.startTime<e&&s.endTime===eT&&(s.endTime=e)}},e.onBufferFlushing=function t(e,i){var r,n=i.startOffset,a=i.endOffset,s=i.type,o=this.id3Track,l=this.hls;if(l){var u=l.config,d=u.enableEmsgMetadataCues,h=u.enableID3MetadataCues;o&&(d||h)&&(r="audio"===s?function t(e){return e.type===ep.audioId3&&h}:"video"===s?function t(e){return e.type===ep.emsg&&d}:function t(e){return e.type===ep.audioId3&&h||e.type===ep.emsg&&d},em(o,n,a,r))}},e.onLevelUpdated=function t(e,i){var r=this,n=i.details;if(this.media&&n.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var a=this.dateRangeCuesAppended,s=this.id3Track,o=n.dateRanges,l=Object.keys(o);if(s)for(var u=Object.keys(a).filter(,d=u.length;d--;)!);var h=n.fragments[n.fragments.length-1];if(0!==l.length&&k(null==h?void 0:h.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var f=h.programDateTime/1e3-h.start,c=ey(),$=0;$<l.length;$++)!function t(){var e=l[$],i=o[e],n=a[e],s=(null==n?void 0:n.cues)||{},u=(null==n?void 0:n.durationKnown)||!1,d=ex(i.startDate,f),h=eT,g=i.endDate;if(g)h=ex(g,f),u=!0;else if(i.endOnNext&&!u){var v=l.reduce([]).sort([0];v&&(h=ex(v.startDate,f),u=!0)}for(var m=Object.keys(i.attr),p=0;p<m.length;p++){var y=m[p];if(K(y)){var T=s[y];if(T)u&&!n.durationKnown&&(T.endTime=h);else{var x=i.attr[y];T=new c(d,h,""),H(y)&&(x=eE(x)),T.value={key:y,data:x},T.type=ep.dateRange,T.id=e,r.id3Track.addCue(T),s[y]=T}}}a[e]={cues:s,dateRange:i,durationKnown:u}}()}}},t}(),eL=function(){ar e=t.prototype;return e.destroy=function t(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},e.registerListeners=function t(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(b.ERROR,this.onError,this)},e.unregisterListeners=function t(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(b.ERROR,this.onError,this)},e.onMediaAttached=function t(e,i){this.media=i.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},e.onMediaDetaching=function t(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},e.onManifestLoading=e.onLevelUpdated=function t(e,i){var r=i.details;this.levelDetails=r,r.advanced&&this.timeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},e.onError=function t(e,i){var r;i.details===w.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(r=this.levelDetails)&&r.live&&M.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},e.timeupdate=function t(){var e=this.media,i=this.levelDetails;if(e&&i){this.currentTime=e.currentTime;var r=this.computeLatency();if(null!==r){this._latency=r;var n=this.config,a=n.lowLatencyMode,s=n.maxLiveSyncPlaybackRate;if(a&&1!==s){var o=this.targetLatency;if(null!==o){var l=r-o,u=Math.min(this.maxLatency,o+i.targetduration);if(i.live&&l<u&&l>.05&&this.forwardBufferLength>1){var d=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20;e.playbackRate=Math.min(Math.min(2,Math.max(1,s)),Math.max(1,d))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}}}}},e.estimateLiveEdge=function t(){var e=this.levelDetails;return null===e?null:e.edge+e.age},e.computeLatency=function t(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},a(t,[{key:"latency",get:,{key:"maxLatency",get:,{key:"targetLatency",get:function t(){var e=this.levelDetails;if(null===e)return null;var i=e.holdBack,r=e.partHoldBack,n=e.targetduration,a=this.config,s=a.liveSyncDuration,o=a.liveSyncDurationCount,l=a.lowLatencyMode,u=this.hls.userConfig,d=l&&r||i;return(u.liveSyncDuration||u.liveSyncDurationCount||0===d)&&(d=void 0!==s?s:o*n),d+Math.min(1*this.stallCount,n)}},{key:"liveSyncPosition",get:function t(){var e=this.estimateLiveEdge(),i=this.targetLatency,r=this.levelDetails;if(null===e||null===i||null===r)return null;var n,a=r.edge,s=e-i-this.edgeStalled;return Math.min(Math.max(a-r.totalduration,s),a-(this.config.lowLatencyMode&&r.partTarget||r.targetduration))}},{key:"drift",get:,{key:"edgeStalled",get:,{key:"forwardBufferLength",get:function t(){var e=this.media,i=this.levelDetails;if(!e||!i)return 0;var r=e.buffered.length;return(r?e.buffered.end(r-1):i.edge)-this.currentTime}}]),t}(),eR=["NONE","TYPE-0","TYPE-1",null],eA=["SDR","PQ","HLG"],e_={No:"",Yes:"YES",v2:"v2"},eI=function(){eturn t.prototype.addDirectives=function t(e){var i=new self.URL(e);return void 0!==this.msn&&i.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&i.searchParams.set("_HLS_part",this.part.toString()),this.skip&&i.searchParams.set("_HLS_skip",this.skip),i.href},t}(),eD=function(){function t(t){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this.supportedPromise=void 0,this.supportedResult=void 0,this._urlId=0,this._avgBitrate=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=this.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.unknownCodecs=t.unknownCodecs,this.codecSet=[t.videoCodec,t.audioCodec].filter(.map(.join(",")}return t.prototype.addFallback=a(t,[{key:"maxBitrate",get:,{key:"averageBitrate",get:function t(){return this._avgBitrate||this.realBitrate||this.bitrate}},{key:"attrs",get:,{key:"codecs",get:,{key:"pathwayId",get:function t(){return this.attrs["PATHWAY-ID"]||"."}},{key:"videoRange",get:,{key:"score",get:,{key:"uri",get:,{key:"urlId",get:function t(){return this._urlId},set:function t(e){var i=e%this.url.length;this._urlId!==i&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=i)}},{key:"audioGroupId",get:function t(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}},{key:"textGroupId",get:function t(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}}]),t}();nction eC(t,e,i,r,n,a){r-i<=0&&(M.warn("Fragment should have a positive duration",e),r=i+e.duration,a=n+e.duration);var s,o=i,l=r,u=e.startPTS,d=e.endPTS;if(k(u)){var h=Math.abs(u-i);k(e.deltaPTS)?e.deltaPTS=Math.max(h,e.deltaPTS):e.deltaPTS=h,o=Math.max(i,u),i=Math.min(i,u),n=Math.min(n,e.startDTS),l=Math.min(r,d),r=Math.max(r,d),a=Math.max(a,e.endDTS)}var f=i-e.start;0!==e.start&&(e.start=i),e.duration=r-e.start,e.startPTS=i,e.maxStartPTS=o,e.startDTS=n,e.endPTS=r,e.minEndPTS=l,e.endDTS=a;var c=e.sn;if(!t||c<t.startSN||c>t.endSN)return 0;var $=c-t.startSN,g=t.fragments;for(g[$]=e,s=$;s>0;s--)eb(g[s],g[s-1]);for(s=$;s<g.length-1;s++)eb(g[s],g[s+1]);return t.fragmentHint&&eb(g[g.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,f}function e8(t,e){var i=e.startSN+e.skippedSegments-t.startSN,r=t.fragments;!(i<0)&&!(i>=r.length)&&ew(e,r[i].start)}on eB(t,e){return Math.min(("linear"===t.backoff?1:Math.pow(2,e))*t.retryDelayMs,t.maxRetryDelayMs)}unction e0(t,e,i,r){if(!t)return!1;var n,a=null==r?void 0:r.code,s=e<t.maxNumRetry&&(n=a,0===n&&!1===navigator.onLine||!!n&&(n<400||n>499)||!!i);return t.shouldRetry?t.shouldRetry(t,e,i,r,s):s}var e2={search:;function eG(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=null;if(t){n=e[t.sn-e[0].sn+1]||null;var a=t.endDTS-i;a>0&&a<15e-7&&(i+=15e-7)}else 0===i&&0===e[0].start&&(n=e[0]);if(n&&(!t||t.level===n.level)&&0===e1(i,r,n))return n;var s=e2.search(e,e1.bind(null,i,r));return s&&(s!==t||!n)?s:n}r eK={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},e4={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4},e3=function(){ar e=t.prototype;return e.registerListeners=function t(){var e=this.hls;e.on(b.ERROR,this.onError,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this)},e.unregisterListeners=function t(){var e=this.hls;e&&(e.off(b.ERROR,this.onError,this),e.off(b.ERROR,this.onErrorOut,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this))},e.destroy=function t(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}},e.startLoad=function t(e){},e.stopLoad=function t(){this.playlistError=0},e.getVariantLevelIndex=function t(e){return(null==e?void 0:e.type)===ed.MAIN?e.level:this.hls.loadLevel},e.onManifestLoading=function t(){this.playlistError=0,this.penalizedRenditions={}},e.onLevelUpdated=function t(){this.playlistError=0},e.onError=function t(e,i){if(!i.fatal){var r=this.hls,n=i.context;switch(i.details){case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:i.errorAction=this.getFragRetryOrSwitchAction(i);return;case w.FRAG_PARSING_ERROR:if(null!=(a=i.frag)&&a.gap){i.errorAction={action:eK.DoNothing,flags:e4.None};return}case w.FRAG_GAP:case w.FRAG_DECRYPT_ERROR:i.errorAction=this.getFragRetryOrSwitchAction(i),i.errorAction.action=eK.SendAlternateToPenaltyBox;return;case w.LEVEL_EMPTY_ERROR:case w.LEVEL_PARSING_ERROR:var a,s,o,l,u=i.parent===ed.MAIN?i.level:r.loadLevel;i.details===w.LEVEL_EMPTY_ERROR&&null!=(o=i.context)&&null!=(l=o.levelDetails)&&l.live?i.errorAction=this.getPlaylistRetryOrSwitchAction(i,u):(i.levelRetry=!1,i.errorAction=this.getLevelSwitchAction(i,u));return;case w.LEVEL_LOAD_ERROR:case w.LEVEL_LOAD_TIMEOUT:"number"==typeof(null==n?void 0:n.level)&&(i.errorAction=this.getPlaylistRetryOrSwitchAction(i,n.level));return;case w.AUDIO_TRACK_LOAD_ERROR:case w.AUDIO_TRACK_LOAD_TIMEOUT:case w.SUBTITLE_LOAD_ERROR:case w.SUBTITLE_TRACK_LOAD_TIMEOUT:if(n){var d=r.levels[r.loadLevel];d&&(n.type===eu.AUDIO_TRACK&&n.groupId===d.audioGroupId||n.type===eu.SUBTITLE_TRACK&&n.groupId===d.textGroupId)&&(i.errorAction=this.getPlaylistRetryOrSwitchAction(i,r.loadLevel),i.errorAction.action=eK.SendAlternateToPenaltyBox,i.errorAction.flags=e4.MoveAllAlternatesMatchingHost)}return;case w.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var h=r.levels[r.loadLevel],f=null==h?void 0:h.attrs["HDCP-LEVEL"];f?i.errorAction={action:eK.SendAlternateToPenaltyBox,flags:e4.MoveAllAlternatesMatchingHDCP,hdcpLevel:f}:this.keySystemError(i);return;case w.BUFFER_ADD_CODEC_ERROR:case w.REMUX_ALLOC_ERROR:case w.BUFFER_APPEND_ERROR:i.errorAction=this.getLevelSwitchAction(i,null!=(s=i.level)?s:r.loadLevel);return;case w.INTERNAL_EXCEPTION:case w.BUFFER_APPENDING_ERROR:case w.BUFFER_FULL_ERROR:case w.LEVEL_SWITCH_ERROR:case w.BUFFER_STALLED_ERROR:case w.BUFFER_SEEK_OVER_HOLE:case w.BUFFER_NUDGE_ON_STALL:i.errorAction={action:eK.DoNothing,flags:e4.None};return}i.type===C.KEY_SYSTEM_ERROR&&this.keySystemError(i)}},e.keySystemError=function t(e){var i=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,i)},e.getPlaylistRetryOrSwitchAction=function t(e,i){var r=eM(this.hls.config.playlistLoadPolicy,e),n=this.playlistError++;if(e0(r,n,eN(e),e.response))return{action:eK.RetryRequest,flags:e4.None,retryConfig:r,retryCount:n};var a=this.getLevelSwitchAction(e,i);return r&&(a.retryConfig=r,a.retryCount=n),a},e.getFragRetryOrSwitchAction=function t(e){var i=this.hls,r=this.getVariantLevelIndex(e.frag),n=i.levels[r],a=i.config,s=a.fragLoadPolicy,o=a.keyLoadPolicy,l=eM(e.details.startsWith("key")?o:s,e),u=i.levels.reduce(0);if(n&&(e.details!==w.FRAG_GAP&&n.fragmentError++,e0(l,u,eN(e),e.response)))return{action:eK.RetryRequest,flags:e4.None,retryConfig:l,retryCount:u};var d=this.getLevelSwitchAction(e,r);return l&&(d.retryConfig=l,d.retryCount=u),d},e.getLevelSwitchAction=function t(e,i){var r=this.hls;null==i&&(i=r.loadLevel);var n=this.hls.levels[i];if(n){var a,s,o=e.details;n.loadError++,o===w.BUFFER_APPEND_ERROR&&n.fragmentError++;var l=-1,u=r.levels,d=r.loadLevel,h=r.minAutoLevel,f=r.maxAutoLevel;r.autoLevelEnabled||(r.loadLevel=-1);for(var c=null==(a=e.frag)?void 0:a.type,$=(c===ed.AUDIO&&o===w.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(o===w.BUFFER_ADD_CODEC_ERROR||o===w.BUFFER_APPEND_ERROR))&&u.some(,g="video"===e.sourceBufferName&&(o===w.BUFFER_ADD_CODEC_ERROR||o===w.BUFFER_APPEND_ERROR)&&u.some(,v=null!=(s=e.context)?s:{},m=v.type,p=v.groupId,y=u.length;y--;){var T=(y+d)%u.length;if(T!==d&&T>=h&&T<=f&&0===u[T].loadError){var x=u[T];if(o===w.FRAG_GAP&&e.frag){var E=u[T].details;if(E){var S=eG(e.frag,E.fragments,e.frag.start);if(null!=S&&S.gap)continue}}else if(m===eu.AUDIO_TRACK&&p===x.audioGroupId||m===eu.SUBTITLE_TRACK&&p===x.textGroupId)continue;else if(c===ed.AUDIO&&n.audioGroupId===x.audioGroupId||c===ed.SUBTITLE&&n.textGroupId===x.textGroupId||$&&n.audioCodec===x.audioCodec||g&&n.codecSet===x.codecSet||n.audioCodec!==x.audioCodec)continue;l=T;break}}if(l>-1&&r.loadLevel!==l)return e.levelRetry=!0,this.playlistError=0,{action:eK.SendAlternateToPenaltyBox,flags:e4.None,nextAutoLevel:l}}return{action:eK.SendAlternateToPenaltyBox,flags:e4.MoveAllAlternatesMatchingHost}},e.onErrorOut=function t(e,i){var r;switch(null==(r=i.errorAction)?void 0:r.action){case eK.DoNothing:break;case eK.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(i),i.errorAction.resolved||i.details===w.FRAG_GAP||(i.fatal=!0)}if(i.fatal){this.hls.stopLoad();return}},e.sendAlternateToPenaltyBox=function t(e){var i=this.hls,r=e.errorAction;if(r){var n=r.flags,a=r.hdcpLevel,s=r.nextAutoLevel;switch(n){case e4.None:this.switchLevel(e,s);break;case e4.MoveAllAlternatesMatchingHost:r.resolved||(r.resolved=this.redundantFailover(e));break;case e4.MoveAllAlternatesMatchingHDCP:a&&(i.maxHdcpLevel=eR[eR.indexOf(a)-1],r.resolved=!0),this.warn('Restricting playback to HDCP-LEVEL of "'+i.maxHdcpLevel+'" or lower')}r.resolved||this.switchLevel(e,s)}},e.switchLevel=function t(e,i){void 0!==i&&e.errorAction&&(this.warn("switching to level "+i+" after "+e.details),this.hls.nextAutoLevel=i,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)},e.redundantFailover=function t(e){var i,r=this,n=this.hls,a=this.penalizedRenditions,s=e.parent===ed.MAIN?e.level||0:n.loadLevel,o=n.levels[s],l=o.url.length,u=e.frag?e.frag.urlId:o.urlId;o.urlId===u&&(!e.frag||o.details)&&this.penalizeRendition(o,e);for(var d=1;d<l;d++)if(i=function t(){var i=(u+d)%l,h=a[i];if(!h||function t(e,i,r){if(performance.now()-e.lastErrorPerfMs>3e5)return!0;var n=e.details;if(i.details===w.FRAG_GAP&&n&&i.frag){var a=i.frag.start,s=eG(null,n.fragments,a);if(s&&!s.gap)return!0}if(r&&e.errors.length<r.errors.length){var o=e.errors[e.errors.length-1];if(n&&o.frag&&i.frag&&Math.abs(o.frag.start-i.frag.start)>3*n.targetduration)return!0}return!1}(h,e,a[u]))return r.warn("Switching to Redundant Stream "+(i+1)+"/"+l+': "'+o.url[i]+'" after '+e.details),r.playlistError=0,n.levels.forEach(,n.nextLoadLevel=s,{v:!0}}())return i.v;return!1},e.penalizeRendition=function t(e,i){var r=this.penalizedRenditions,n=r[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};n.lastErrorPerfMs=performance.now(),n.errors.push(i),n.details=e.details,r[e.urlId]=n},t}(),eH=function(){ar e=t.prototype;return e.destroy=function t(){this.clearTimer(),this.hls=this.log=this.warn=null},e.clearTimer=function t(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)},e.startLoad=function t(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()},e.stopLoad=e.switchParams=function t(e,i){var r=null==i?void 0:i.renditionReports;if(r){for(var n=-1,a=0;a<r.length;a++){var s=r[a],o=void 0;try{o=new self.URL(s.URI,i.url).href}catch(l){M.warn("Could not construct new URL for Rendition Report: "+l),o=s.URI||""}if(o===e){n=a;break}o===e.substring(0,o.length)&&(n=a)}if(-1!==n){var u=r[n],d=parseInt(u["LAST-MSN"])||(null==i?void 0:i.lastPartSn),h=parseInt(u["LAST-PART"])||(null==i?void 0:i.lastPartIndex);if(this.hls.config.lowLatencyMode){var f=Math.min(i.age-i.partTarget,i.targetduration);h>=0&&f>i.partTarget&&(h+=1)}return new eI(d,h>=0?h:void 0,e_.No)}}},e.loadPlaylist=function t(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())},e.shouldLoadPlaylist=function t(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)},e.shouldReloadPlaylist=function t(e){return -1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)},e.playlistLoaded=function t(e,i,r){var n=this,a=i.details,s=i.stats,l=self.performance.now(),u=s.loading.first?Math.max(0,l-s.loading.first):0;if(a.advancedDateTime=Date.now()-u,a.live||null!=r&&r.live){if(a.reloaded(r),r&&this.log("live playlist "+e+" "+(a.advanced?"REFRESHED "+a.lastPartSn+"-"+a.lastPartIndex:a.updated?"UPDATED":"MISSED")),r&&a.fragments.length>0&&function t(e,i){for(var r,n=null,a=e.fragments,s=a.length-1;s>=0;s--){var l=a[s].initSegment;if(l){n=l;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;var u=0;if(function t(e,i,r){for(var n=i.skippedSegments,a=Math.max(e.startSN,i.startSN)-i.startSN,s=(e.fragmentHint?1:0)+(n?i.endSN:Math.min(e.endSN,i.endSN))-i.startSN,o=i.startSN-e.startSN,l=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=a;d<=s;d++){var h=u[o+d],f=l[d];n&&!f&&d<n&&(f=i.fragments[d]=h),h&&f&&r(h,f)}}(e,i,,n&&(i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments).forEach(,i.skippedSegments){if(i.deltaUpdateFailed=i.fragments.some(,i.deltaUpdateFailed){M.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var d,h,f,c,$=i.skippedSegments;$--;)i.fragments.shift();i.startSN=i.fragments[0].sn,i.startCC=i.fragments[0].cc}else{i.canSkipDateRanges&&(i.dateRanges=(d=e.dateRanges,h=i.dateRanges,f=i.recentlyRemovedDateranges,c=o({},d),f&&f.forEach(,Object.keys(h).forEach(,c))}}var g=i.fragments;if(u){M.warn("discontinuity sliding from playlist, take drift into account");for(var v=0;v<g.length;v++)g[v].cc+=u}i.skippedSegments&&(i.startCC=i.fragments[0].cc),function t(e,i,r){if(e&&i)for(var n=0,a=0,s=e.length;a<=s;a++){var o=e[a],l=i[a+n];o&&l&&o.index===l.index&&o.fragment.sn===l.fragment.sn?r(o,l):n--}}(e.partList,i.partList,,r?eC(i,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):e8(e,i),g.length&&(i.totalduration=i.edge-g[0].start),i.driftStartTime=e.driftStartTime,i.driftStart=e.driftStart;var m=i.advancedDateTime;if(i.advanced&&m){var p=i.edge;i.driftStart||(i.driftStartTime=m,i.driftStart=p),i.driftEndTime=m,i.driftEnd=p}else i.driftEndTime=e.driftEndTime,i.driftEnd=e.driftEnd,i.advancedDateTime=e.advancedDateTime}(r,a),!this.canLoad||!a.live)return;var d,h=void 0,f=void 0;if(a.canBlockReload&&a.endSN&&a.advanced){var c=this.hls.config.lowLatencyMode,$=a.lastPartSn,g=a.endSN,v=a.lastPartIndex,m=$===g;-1!==v?(h=m?g+1:$,f=m?c?0:v:v+1):h=g+1;var p=a.age,y=Math.min(p+a.ageHeader-a.partTarget,1.5*a.targetduration);if(y>0){if(r&&y>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+y+" with playlist age: "+a.age),y=0;else{var T=Math.floor(y/a.targetduration);h+=T,void 0!==f&&(f+=Math.round(y%a.targetduration/a.partTarget)),this.log("CDN Tune-in age: "+a.ageHeader+"s last advanced "+p.toFixed(2)+"s goal: "+y+" skip sn "+T+" to part "+f)}a.tuneInGoal=y}if(d=this.getDeliveryDirectives(a,i.deliveryDirectives,h,f),c||!m){this.loadPlaylist(d);return}}else(a.canBlockReload||a.canSkipUntil)&&(d=this.getDeliveryDirectives(a,i.deliveryDirectives,h,f));var x=this.hls.mainForwardBufferInfo,E=x?x.end-x.len:0,S=(a.edge-E)*1e3,L=function t(e,i){void 0===i&&(i=1/0);var r=1e3*e.targetduration;if(e.updated){var n=e.fragments;if(n.length&&4*r>i){var a=1e3*n[n.length-1].duration;a<r&&(r=a)}}else r/=2;return Math.round(r)}(a,S);a.updated&&l>this.requestScheduled+L&&(this.requestScheduled=s.loading.start),void 0!==h&&a.canBlockReload?this.requestScheduled=s.loading.first+L-(1e3*a.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+L<l?this.requestScheduled=l:this.requestScheduled-l<=0&&(this.requestScheduled+=L);var R=this.requestScheduled-l;R=Math.max(0,R),this.log("reload live playlist "+e+" in "+Math.round(R)+" ms"),this.timer=self.setTimeout(function(){return n.loadPlaylist(d)},R)}else this.clearTimer()},e.getDeliveryDirectives=function t(e,i,r,n){var a,s,o,l,u,d=(a=e,s=r,o=a.canSkipUntil,l=a.canSkipDateRanges,u=a.endSN,o&&(void 0!==s?s-u:0)<o?l?e_.v2:e_.Yes:(0,e_.No));return null!=i&&i.skip&&e.deltaUpdateFailed&&(r=i.msn,n=i.part,d=e_.No),new eI(r,n,d)},e.checkRetry=function t(e){var i,r=this,n=e.details,a=eN(e),s=e.errorAction,o=s||{},l=o.action,u=o.retryCount,d=void 0===u?0:u,h=o.retryConfig,f=!!s&&!!h&&(l===eK.RetryRequest||!s.resolved&&l===eK.SendAlternateToPenaltyBox);if(f){if(this.requestScheduled=-1,d>=h.maxNumRetry)return!1;if(a&&null!=(i=e.context)&&i.deliveryDirectives)this.warn("Retrying playlist loading "+(d+1)+"/"+h.maxNumRetry+' after "'+n+'" without delivery-directives'),this.loadPlaylist();else{var c=eB(h,d);this.timer=self.setTimeout(function(){return r.loadPlaylist()},c),this.warn("Retrying playlist loading "+(d+1)+"/"+h.maxNumRetry+' after "'+n+'" in '+c+"ms")}e.levelRetry=!0,s.resolved=!0}return f},t}(),eV=function(){ar e=t.prototype;return e.sample=function t(e,i){var r=Math.pow(this.alpha_,e);this.estimate_=i*(1-r)+r*this.estimate_,this.totalWeight_+=e},e.getTotalWeight=function t(){return this.totalWeight_},e.getEstimate=function t(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},t}(),eY=function(){ar e=t.prototype;return e.update=function t(e,i){var r=this.slow_,n=this.fast_,a=this.ttfb_;r.halfLife!==e&&(this.slow_=new eV(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==i&&(this.fast_=new eV(i,n.getEstimate(),n.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new eV(e,a.getEstimate(),a.getTotalWeight()))},e.sample=function t(e,i){var r=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*i/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},e.sampleTTFB=function t(e){this.ttfb_.sample(Math.sqrt(2)*Math.exp(-Math.pow(e/1e3,2)/2),Math.max(e,5))},e.canEstimate=function t(){return this.fast_.getTotalWeight()>=this.minWeight_},e.getEstimate=function t(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.getEstimateTTFB=function t(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_},e.destroy=function t(){},t}(),e7={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},eW={};function e5(t,e,i,r,n,a){var s=t.audioCodec?t.audioGroupId:null,o=s?e.groups[s].channels:null;return"function"==typeof(null==i?void 0:i.decodingInfo)&&void 0!==t.videoCodec&&(t.width>1920&&t.height>1088||t.height>1920&&t.width>1088||t.frameRate>Math.max(n,30)||"SDR"!==t.videoRange&&t.videoRange!==r||t.bitrate>Math.max(a,8e6))||!!o&&Object.keys(o).length>1}function eq(t,e,i){var n,a=t.videoCodec,s=t.audioCodec;if(!a||!s)return Promise.resolve(e7);var o={width:t.width,height:t.height,bitrate:Math.ceil(Math.max(.9*t.bitrate,t.averageBitrate)),framerate:t.frameRate||30},l=t.videoRange;"SDR"!==l&&(o.transferFunction=l.toLowerCase());var u=a.split(",").map(,d=t.audioGroupId;return s&&d&&(null==(n=e.groups[d])||n.tracks.forEach(function(t){if(t.groupId===d){var e=parseFloat(t.attrs.CHANNELS||"");k(e)&&e>2&&u.push.apply(u,s.split(",").map()}})),Promise.all(u.map(function(t){var e=function t(e){var i=e.audio,r=e.video,n=r||i;if(n){var a=n.contentType.split('"')[1];if(r)return"r"+r.height+"x"+r.width+"f"+Math.ceil(r.framerate)+(r.transferFunction||"sd")+"_"+a+"_"+Math.ceil(r.bitrate/1e5);if(i)return"c"+i.channels+(i.spatialRendering?"s":"n")+"_"+a}return""}(t);return eW[e]||(eW[e]=i.decodingInfo(t))})).then(.catch(}function eX(t,e,i){for(var r=Object.keys(t),n=!0,a=!1,s=1/0,o=1/0,l=1/0,u=0,d=r.length;d--;){var h=t[r[d]];n=h.channels[2]>0,s=Math.min(s,h.minHeight),o=Math.min(o,h.minFramerate),l=Math.min(l,h.minBitrate),e&&(a||(a=h.videoRanges[e]>0))}s=k(s)?s:0;var f=Math.max(1080,s),c=Math.max(30,o=k(o)?o:0);return i=Math.max(l=k(l)?l:i,i),a||(e=void 0),{codecSet:r.reduce(void 0),videoRange:e,minFramerate:o,minBitrate:l}}unction ej(t){return t.reduce(function(t,e){var i=t.groups[e.groupId];i||(i=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(e);var r=e.attrs.CHANNELS||"2";return i.channels[r]=(i.channels[r]||0)+1,i.hasDefault=i.hasDefault||e.default,i.hasAutoSelect=i.hasAutoSelect||e.autoselect,i.hasDefault&&(t.hasDefaultAudio=!0),i.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function eQ(t,e,i,r){return t.slice(i,r+1).reduce({})}var e9=function(){ar e=t.prototype;return e.resetEstimator=function t(e){e&&(M.log("setting initial bwe to "+e),this.hls.config.abrEwmaDefaultEstimate=e),this.bwEstimator=this.initEstimator()},e.initEstimator=function t(){var e=this.hls.config;return new eY(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)},e.registerListeners=function t(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.ERROR,this.onError,this)},e.unregisterListeners=function t(){var e=this.hls;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.ERROR,this.onError,this))},e.destroy=function t(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},e.onManifestLoading=function t(e,i){this.lastLoadedFragLevel=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.audioTracksByGroup=null,this.onLevelsUpdated(),this.clearTimer()},e.onLevelsUpdated=function t(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.codecTiers=null},e.onFragLoading=function t(e,i){var r,n=i.frag;!this.ignoreFragment(n)&&(n.bitrateTest||(this.fragCurrent=n,this.partCurrent=null!=(r=i.part)?r:null),this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))},e.onLevelSwitching=e.onError=function t(e,i){if(!i.fatal)switch(i.details){case w.BUFFER_ADD_CODEC_ERROR:case w.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1}},e.getTimeToLoadFrag=function t(e,i,r,n){return e+r/i+(n?this.lastLevelLoadSec:0)},e.onLevelLoaded=function t(e,i){var r=this.hls.config,n=i.stats.loading,a=n.end-n.start;k(a)&&(this.lastLevelLoadSec=a/1e3),i.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)},e._abandonRulesCheck=function t(){var e,i=this.fragCurrent,r=this.partCurrent,n=this.hls,a=n.autoLevelEnabled,s=n.media;if(i&&s){var o=performance.now(),l=r?r.stats:i.stats,u=r?r.duration:i.duration,d=o-l.loading.start,h=n.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||i.level<=h){this.clearTimer(),this._nextAutoLevel=-1;return}if(a&&!s.paused&&s.playbackRate&&s.readyState){var f=n.mainForwardBufferInfo;if(null!==f){var c=this.bwEstimator.getEstimateTTFB(),$=Math.abs(s.playbackRate);if(!(d<=Math.max(c,1e3*(u/(2*$))))){var g=f.len/$;if(!(g>=2*u/$)){var v=l.loading.first?l.loading.first-l.loading.start:-1,m=l.loaded&&v>-1,p=this.getBwEstimate(),y=n.levels,T=y[i.level],x=l.total||Math.max(l.loaded,Math.round(u*T.maxBitrate/8)),E=m?d-v:d;E<1&&m&&(E=Math.min(d,8*l.loaded/p));var S=m?1e3*l.loaded/E:0,L=S?(x-l.loaded)/S:8*x/p+c/1e3;if(!(L<=g)){var R=S?8*S:p,A=Number.POSITIVE_INFINITY;for(e=i.level-1;e>h;e--){var _=y[e].maxBitrate;if((A=this.getTimeToLoadFrag(c/1e3,R,u*_,!y[e].details))<g)break}!(A>=L)&&!(A>10*u)&&(n.nextLoadLevel=e,m?this.bwEstimator.sample(d-Math.min(c,v),l.loaded):this.bwEstimator.sampleTTFB(d),this.clearTimer(),M.warn("[abr] Fragment "+i.sn+(r?" part "+r.index:"")+" of level "+i.level+" is loading too slowly;\n      Time to underbuffer: "+g.toFixed(3)+" s\n      Estimated load time for current fragment: "+L.toFixed(3)+" s\n      Estimated load time for down switch fragment: "+A.toFixed(3)+" s\n      TTFB estimate: "+v+"\n      Current BW estimate: "+(k(p)?(p/1024).toFixed(3):"Unknown")+" Kb/s\n      New BW estimate: "+(this.getBwEstimate()/1024).toFixed(3)+" Kb/s\n      Aborting and switching to level "+e),i.loader&&(this.fragCurrent=this.partCurrent=null,i.abortRequests()),n.trigger(b.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:r,stats:l}))}}}}}}},e.onFragLoaded=function t(e,i){var r=i.frag,n=i.part,a=n?n.stats:r.stats;if(r.type===ed.MAIN&&this.bwEstimator.sampleTTFB(a.loading.first-a.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var s=n?n.duration:r.duration,o=this.hls.levels[r.level],l=(o.loaded?o.loaded.bytes:0)+a.loaded,u=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:l,duration:u},o.realBitrate=Math.round(8*l/u)}if(r.bitrateTest){var d={stats:a,frag:r,part:n,id:r.type};this.onFragBuffered(b.FRAG_BUFFERED,d),r.bitrateTest=!1}else this.lastLoadedFragLevel=r.level}},e.onFragBuffered=function t(e,i){var r=i.frag,n=i.part,a=null!=n&&n.stats.loaded?n.stats:r.stats;if(!(a.aborted||this.ignoreFragment(r))){var s=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,a.loaded),a.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}},e.ignoreFragment=function t(e){return e.type!==ed.MAIN||"initSegment"===e.sn},e.clearTimer=function t(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)},e.getAutoLevelKey=function t(){var e;return this.getBwEstimate()+"_"+(null==(e=this.hls.mainForwardBufferInfo)?void 0:e.len)},e.getNextABRAutoLevel=function t(){var e=this.fragCurrent,i=this.partCurrent,r=this.hls,n=r.maxAutoLevel,a=r.config,s=r.minAutoLevel,o=r.media,l=i?i.duration:e?e.duration:0,u=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,d=this.getBwEstimate(),h=r.mainForwardBufferInfo,f=(h?h.len:0)/u,c=a.abrBandWidthFactor,$=a.abrBandWidthUpFactor;if(f){var g=this.findBestLevel(d,s,n,f,0,c,$);if(g>=0)return g}var v=l?Math.min(l,a.maxStarvationDelay):a.maxStarvationDelay;if(!f){var m=this.bitrateTestDelay;m&&(v=(l?Math.min(l,a.maxLoadingDelay):a.maxLoadingDelay)-m,M.info("[abr] bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*v)+" ms"),c=$=1)}var p=this.findBestLevel(d,s,n,f,v,c,$);if(M.info("[abr] "+(f?"rebuffering expected":"buffer is empty")+", optimal quality level "+p),p>-1)return p;var y=r.levels[s],T=r.levels[r.loadLevel];return(null==y?void 0:y.bitrate)<(null==T?void 0:T.bitrate)?s:r.loadLevel},e.getBwEstimate=function t(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate},e.findBestLevel=function t(e,i,r,n,a,s,o){var l,u=this,d=n+a,h=this.lastLoadedFragLevel,f=-1===h?this.hls.firstLevel:h,c=this.fragCurrent,$=this.partCurrent,g=this.hls,v=g.levels,m=g.allAudioTracks,p=g.loadLevel;if(1===v.length)return 0;var y=v[f],T=!!(null!=y&&null!=(l=y.details)&&l.live),x=-1===p||-1===h,E="SDR",S=(null==y?void 0:y.frameRate)||0,L=this.audioTracksByGroup||(this.audioTracksByGroup=ej(m));if(x){var R=this.codecTiers||(this.codecTiers=eQ(v,L,i,r)),A=eX(R,E,e),_=A.codecSet,I=A.videoRange,D=A.minFramerate,b=A.minBitrate;C=_,E=I,S=D,e=Math.max(e,b)}else C=null==y?void 0:y.codecSet,E=null==y?void 0:y.videoRange;for(var C,w,P=$?$.duration:c?c.duration:0,F=this.bwEstimator.getEstimateTTFB()/1e3,O=[],N=function t(i){var l,c,g,m=v[i],R=i>f;if(!m)return 0;if(u.hls.config.useMediaCapabilities&&!m.supportedResult&&!m.supportedPromise){var A=navigator.mediaCapabilities;e5(m,L,A,E,S,e)?(m.supportedPromise=eq(m,L,A),m.supportedPromise.then(function(t){m.supportedResult=t,t.error?M.warn('[abr] MediaCapabilities decodingInfo error: "'+t.error+'" for level '+i+" "+JSON.stringify(t)):!t.supported&&(M.warn("[abr] Removing unsupported level "+i+" after MediaCapabilities decodingInfo check failed "+JSON.stringify(t)),i>0&&u.hls.removeLevel(i))})):m.supportedResult=e7}if(C&&m.codecSet!==C||E&&m.videoRange!==E||R&&S>m.frameRate||!R&&S>0&&S<m.frameRate||!(null!=(l=m.supportedResult)&&null!=(c=l.decodingInfoResults)&&c[0].smooth))return O.push(i),0;var _=m.details,I=($?null==_?void 0:_.partTarget:null==_?void 0:_.averagetargetduration)||P;g=R?o*e:s*e;var D=P&&n>=2*P&&0===a?v[i].averageBitrate:v[i].maxBitrate,b=u.getTimeToLoadFrag(F,g,D*I,void 0===_);if(g>=D&&(i===h||0===m.loadError&&0===m.fragmentError)&&(b<=F||!k(b)||T&&!u.bitrateTestDelay||b<d))return i!==p&&(O.length&&M.trace("[abr] Skipped level(s) "+O.join(",")+" of "+r+' max with CODECS and VIDEO-RANGE:"'+v[O[0]].codecs+'" '+v[O[0]].videoRange+'; not compatible with "'+y.codecs+'" '+E),M.info("[abr] switch candidate:"+f+"->"+i+" adjustedbw("+Math.round(g)+")-bitrate="+Math.round(g-D)+" ttfb:"+F.toFixed(1)+" avgDuration:"+I.toFixed(1)+" maxFetchDuration:"+d.toFixed(1)+" fetchDuration:"+b.toFixed(1)+" firstSelection:"+x+" codecSet:"+C+" videoRange:"+E+" hls.loadLevel:"+p)),{v:i}},B=r;B>=i;B--)if(0!==(w=N(B))&&w)return w.v;return -1},a(t,[{key:"firstAutoLevel",get:function t(){var e=this.hls,i=e.maxAutoLevel,r=e.minAutoLevel,n=this.hls.config.maxStarvationDelay,a=this.findBestLevel(this.getBwEstimate(),r,i,0,n,1,1);if(a>-1)return a;var s=this.hls.firstLevel,o=Math.min(Math.max(s,r),i);return M.warn("[abr] Could not find best starting auto level. Defaulting to first in playlist "+s+" clamped to "+o),o}},{key:"forcedAutoLevel",get:function t(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}},{key:"nextAutoLevel",get:function t(){var e=this._nextAutoLevel,i=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(-1!==e&&(!i||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;var n=i&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){var a=this.hls.levels;if(a.length>Math.max(e,n)&&a[e].loadError<a[n].loadError)return e}return -1!==e&&(n=Math.min(e,n)),this._nextAutoLevel=n,this.nextAutoLevelKey=this.getAutoLevelKey(),n},set:function t(e){var i=Math.max(this.hls.minAutoLevel,e);this._nextAutoLevel!=i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}}]),t}(),eZ=function(){ar e=t.prototype;return e.destroy=function t(){this.onHandlerDestroying(),this.onHandlerDestroyed()},e.onHandlerDestroying=function t(){this.clearNextTick(),this.clearInterval()},e.onHandlerDestroyed=function t(){},e.hasInterval=function t(){return!!this._tickInterval},e.hasNextTick=e.setInterval=function t(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)},e.clearInterval=function t(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},e.clearNextTick=function t(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},e.tick=function t(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},e.tickImmediate=function t(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},e.doTick=function t(){},t}(),eJ={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},it=function(){ar e=t.prototype;return e._registerListeners=function t(){var e=this.hls;e.on(b.BUFFER_APPENDED,this.onBufferAppended,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this)},e._unregisterListeners=function t(){var e=this.hls;e.off(b.BUFFER_APPENDED,this.onBufferAppended,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this)},e.destroy=function t(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null},e.getAppendedFrag=function t(e,i){var r=this.activePartLists[i];if(r)for(var n=r.length;n--;){var a=r[n];if(!a)break;var s=a.end;if(a.start<=e&&null!==s&&e<=s)return a}return this.getBufferedFrag(e,i)},e.getBufferedFrag=function t(e,i){for(var r=this.fragments,n=Object.keys(r),a=n.length;a--;){var s=r[n[a]];if((null==s?void 0:s.body.type)===i&&s.buffered){var o=s.body;if(o.start<=e&&e<=o.end)return o}}return null},e.detectEvictedFragments=function t(e,i,r,n){var a=this;this.timeRanges&&(this.timeRanges[e]=i);var s=(null==n?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach(},e.detectPartialFragments=function t(e){var i=this,r=this.timeRanges,n=e.frag,a=e.part;if(r&&"initSegment"!==n.sn){var s=ii(n),o=this.fragments[s];if(o&&(!o.buffered||!n.gap)){var l=!n.relurl;(Object.keys(r).forEach(,o.loaded=null,Object.keys(o.range).length)?(o.buffered=!0,(o.body.endList=n.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),ie(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}}},e.removeParts=function t(e,i){var r=this.activePartLists[i];r&&(this.activePartLists[i]=r.filter()},e.fragBuffered=function t(e,i){var r=ii(e),n=this.fragments[r];!n&&i&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)},e.getBufferedTimes=function t(e,i,r,n){for(var a={time:[],partial:r},s=e.start,o=e.end,l=e.minEndPTS||o,u=e.maxStartPTS||s,d=0;d<n.length;d++){var h=n.start(d)-this.bufferPadding,f=n.end(d)+this.bufferPadding;if(u>=h&&l<=f){a.time.push({startPTS:Math.max(s,n.start(d)),endPTS:Math.min(o,n.end(d))});break}if(s<f&&o>h){var c=Math.max(s,n.start(d)),$=Math.min(o,n.end(d));$>c&&(a.partial=!0,a.time.push({startPTS:c,endPTS:$}))}else if(o<=h)break}return a},e.getPartialFragment=function t(e){var i,r,n,a=null,s=0,o=this.bufferPadding,l=this.fragments;return Object.keys(l).forEach(,a},e.isEndListAppended=function t(e){var i=this.endListFragments[e];return void 0!==i&&(i.buffered||ie(i))},e.getState=function t(e){var i=ii(e),r=this.fragments[i];return r?r.buffered?ie(r)?eJ.PARTIAL:eJ.OK:eJ.APPENDING:(0,eJ.NOT_LOADED)},e.isTimeBuffered=function t(e,i,r){for(var n,a,s=0;s<r.length;s++){if(n=r.start(s)-this.bufferPadding,a=r.end(s)+this.bufferPadding,e>=n&&i<=a)return!0;if(i<=n)break}return!1},e.onFragLoaded=function t(e,i){var r=i.frag,n=i.part;if("initSegment"!==r.sn&&!r.bitrateTest){var a=ii(r);this.fragments[a]={body:r,appendedPTS:null,loaded:n?null:i,buffered:!1,range:Object.create(null)}}},e.onBufferAppended=function t(e,i){var r=this,n=i.frag,a=i.part,s=i.timeRanges;if("initSegment"!==n.sn){var o=n.type;if(a){var l=this.activePartLists[o];l||(this.activePartLists[o]=l=[]),l.push(a)}this.timeRanges=s,Object.keys(s).forEach(}},e.onFragBuffered=e.hasFragment=e.hasParts=function t(e){var i;return!!(null!=(i=this.activePartLists[e])&&i.length)},e.removeFragmentsInRange=function t(e,i,r,n,a){var s=this;(!n||this.hasGaps)&&Object.keys(this.fragments).forEach(function(t){var o=s.fragments[t];if(o){var l=o.body;l.type===r&&(!n||l.gap)&&l.start<i&&l.end>e&&(o.buffered||a)&&s.removeFragment(l)}})},e.removeFragment=function t(e){var i=ii(e);e.stats.loaded=0,e.clearElementaryStreamInfo();var r=this.activePartLists[e.type];if(r){var n=e.sn;this.activePartLists[e.type]=r.filter(}delete this.fragments[i],e.endList&&delete this.endListFragments[e.type]},e.removeAllFragments=function t(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1},t}();r ir={length:0,start:function t(){return 0},end:function t(){return 0}},ia=function(){function t(){}return t.isBuffered=function e(i,r){try{if(i){for(var n=t.getBuffered(i),a=0;a<n.length;a++)if(r>=n.start(a)&&r<=n.end(a))return!0}}catch(s){}return!1},t.bufferInfo=function e(i,r,n){try{if(i){var a,s=t.getBuffered(i),o=[];for(a=0;a<s.length;a++)o.push({start:s.start(a),end:s.end(a)});return this.bufferedInfo(o,r,n)}}catch(l){}return{len:0,start:r,end:r,nextStart:void 0}},t.bufferedInfo=function t(e,i,r){i=Math.max(0,i),e.sort(;var n,a=[];if(r)for(var s=0;s<e.length;s++){var o=a.length;if(o){var l=a[o-1].end;e[s].start-l<r?e[s].end>l&&(a[o-1].end=e[s].end):a.push(e[s])}else a.push(e[s])}else a=e;for(var u=0,d=i,h=i,f=0;f<a.length;f++){var c=a[f].start,$=a[f].end;if(i+r>=c&&i<$)d=c,u=(h=$)-i;else if(i+r<c){n=c;break}}return{len:u,start:d||0,end:h||0,nextStart:n}},t.getBuffered=function t(e){try{return e.buffered}catch(i){return M.log("failed to get media.buffered",i),ir}},t}(),is=function t(e,i,r,n,a,s){void 0===n&&(n=0),void 0===a&&(a=-1),void 0===s&&(s=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=io(),this.buffering={audio:io(),video:io(),audiovideo:io()},this.level=e,this.sn=i,this.id=r,this.size=n,this.part=a,this.partial=s};unction il(t,e){for(var i,r=0,n=t.length;r<n;r++)if((null==(i=t[r])?void 0:i.cc)===e)return t[r];return null}nction ih(t,e){if(t.hasProgramDateTime&&e.hasProgramDateTime){var i,r,n=t.fragments,a=e.fragments;if(n.length&&a.length){var s=Math.min(e.endCC,t.endCC);e.startCC<s&&t.startCC<s&&(i=il(a,s),r=il(n,s)),i&&r||(r=il(n,(i=a[Math.floor(a.length/2)]).cc)||n[Math.floor(n.length/2)]);var o=i.programDateTime,l=r.programDateTime;o&&l&&id((l-o)/1e3-(r.start-i.start),t)}}}var ic=function(){ar e=t.prototype;return e.destroy=e.abort=e.load=function t(e,i){var n=this,a=e.url;if(!a)return Promise.reject(new iv({type:C.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:Error("Fragment does not have a "+(a?"part list":"url")),networkDetails:null}));this.abort();var s=this.config,o=s.fLoader,l=s.loader;return new Promise(function(t,u){if(n.loader&&n.loader.destroy(),e.gap){if(e.tagList.some(){u(ig(e));return}e.gap=!1}var d=n.loader=e.loader=o?new o(s):new l(s),h=i$(e),f=eU(s.fragLoadPolicy.default),c={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:131072};e.stats=d.stats,d.load(h,c,{onSuccess:function i(r,a,s,o){n.resetLoader(e,d);var l=r.data;s.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(l.slice(0,16)),l=l.slice(16)),t({frag:e,part:null,payload:l,networkDetails:o})},onError:function t(i,s,o,l){n.resetLoader(e,d),u(new iv({type:C.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:r({url:a,data:void 0},i),error:Error("HTTP Error "+i.code+" "+i.text),networkDetails:o,stats:l}))},onAbort:function t(i,r,a){n.resetLoader(e,d),u(new iv({type:C.NETWORK_ERROR,details:w.INTERNAL_ABORTED,fatal:!1,frag:e,error:Error("Aborted"),networkDetails:a,stats:i}))},onTimeout:function t(i,r,a){n.resetLoader(e,d),u(new iv({type:C.NETWORK_ERROR,details:w.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:Error("Timeout after "+c.timeout+"ms"),networkDetails:a,stats:i}))},onProgress:)})},e.loadPart=function t(e,i,n){var a=this;this.abort();var s=this.config,o=s.fLoader,l=s.loader;return new Promise(function(t,u){if(a.loader&&a.loader.destroy(),e.gap||i.gap){u(ig(e,i));return}var d=a.loader=e.loader=o?new o(s):new l(s),h=i$(e,i),f=eU(s.fragLoadPolicy.default),c={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:131072};i.stats=d.stats,d.load(h,c,{onSuccess:onError:function t(n,s,o,l){a.resetLoader(e,d),u(new iv({type:C.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:i,response:r({url:h.url,data:void 0},n),error:Error("HTTP Error "+n.code+" "+n.text),networkDetails:o,stats:l}))},onAbort:function t(r,n,s){e.stats.aborted=i.stats.aborted,a.resetLoader(e,d),u(new iv({type:C.NETWORK_ERROR,details:w.INTERNAL_ABORTED,fatal:!1,frag:e,part:i,error:Error("Aborted"),networkDetails:s,stats:r}))},onTimeout:function t(r,n,s){a.resetLoader(e,d),u(new iv({type:C.NETWORK_ERROR,details:w.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:i,error:Error("Timeout after "+c.timeout+"ms"),networkDetails:s,stats:r}))}})})},e.updateStatsFromPart=function t(e,i){var r=e.stats,n=i.stats,a=n.total;if(r.loaded+=n.loaded,a){var s=Math.round(e.duration/i.duration),o=Math.min(Math.round(r.loaded/a),s),l=(s-o)*Math.round(r.loaded/o);r.total=r.loaded+l}else r.total=Math.max(r.loaded,r.total);var u=r.loading,d=n.loading;u.start?u.first+=d.first-d.start:(u.start=d.start,u.first=d.first),u.end=d.end},e.resetLoader=function t(e,i){e.loader=null,this.loader===i&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),i.destroy()},t}();function i$(t,e){void 0===e&&(e=null);var i=e||t,r={frag:t,part:e,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},n=i.byteRangeStartOffset,a=i.byteRangeEndOffset;if(k(n)&&k(a)){var s,o=n,l=a;if("initSegment"===t.sn&&(null==(s=t.decryptdata)?void 0:s.method)==="AES-128"){var u=a-n;u%16&&(l=a+(16-u%16)),0!==n&&(r.resetIV=!0,o=n-16)}r.rangeStart=o,r.rangeEnd=l}return r}function ig(t,e){var i=Error("GAP "+(t.gap?"tag":"attribute")+" found"),r={type:C.MEDIA_ERROR,details:w.FRAG_GAP,fatal:!1,frag:t,error:i,networkDetails:null};return e&&(r.part=e),(e||t).stats.aborted=!0,new iv(r)}var iv=f(Error)),im=function(){function t(t,e){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=e}return t.prototype.decrypt=t}(),ip=function(){eturn t.prototype.expandKey=function t(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},t}(),iy=function(){ar e=t.prototype;return e.uint8ArrayToUint32Array_=function t(e){for(var i=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=i.getUint32(4*n);return r},e.initTable=function t(){var e=this.sBox,i=this.invSBox,r=this.subMix,n=r[0],a=r[1],s=r[2],o=r[3],l=this.invSubMix,u=l[0],d=l[1],h=l[2],f=l[3],c=new Uint32Array(256),$=0,g=0,v=0;for(v=0;v<256;v++)v<128?c[v]=v<<1:c[v]=v<<1^283;for(v=0;v<256;v++){var m=g^g<<1^g<<2^g<<3^g<<4;m=m>>>8^255&m^99,e[$]=m,i[m]=$;var p=c[$],y=c[p],T=c[y],x=257*c[m]^16843008*m;n[$]=x<<24|x>>>8,a[$]=x<<16|x>>>16,s[$]=x<<8|x>>>24,o[$]=x,x=16843009*T^65537*y^257*p^16843008*$,u[m]=x<<24|x>>>8,d[m]=x<<16|x>>>16,h[m]=x<<8|x>>>24,f[m]=x,$?($=p^c[c[c[T^p]]],g^=c[c[g]]):$=g=1}},e.expandKey=function t(e){for(var i,r,n,a,s=this.uint8ArrayToUint32Array_(e),o=!0,l=0;l<s.length&&o;)o=s[l]===this.key[l],l++;if(!o){this.key=s;var u=this.keySize=s.length;if(4!==u&&6!==u&&8!==u)throw Error("Invalid aes key size="+u);var d=this.ksRows=(u+6+1)*4,h=this.keySchedule=new Uint32Array(d),f=this.invKeySchedule=new Uint32Array(d),c=this.sBox,$=this.rcon,g=this.invSubMix,v=g[0],m=g[1],p=g[2],y=g[3];for(i=0;i<d;i++){if(i<u){n=h[i]=s[i];continue}a=n,i%u==0?(a=c[(a=a<<8|a>>>24)>>>24]<<24|c[a>>>16&255]<<16|c[a>>>8&255]<<8|c[255&a],a^=$[i/u|0]<<24):u>6&&i%u==4&&(a=c[a>>>24]<<24|c[a>>>16&255]<<16|c[a>>>8&255]<<8|c[255&a]),h[i]=n=(h[i-u]^a)>>>0}for(r=0;r<d;r++)i=d-r,a=3&r?h[i]:h[i-4],r<4||i<=4?f[r]=a:f[r]=v[c[a>>>24]]^m[c[a>>>16&255]]^p[c[a>>>8&255]]^y[c[255&a]],f[r]=f[r]>>>0}},e.networkToHostOrderSwap=e.decrypt=function t(e,i,r){for(var n,a,s,o,l,u,d,h,f,c,$,g,v,m,p=this.keySize+6,y=this.invKeySchedule,T=this.invSBox,x=this.invSubMix,E=x[0],S=x[1],L=x[2],R=x[3],A=this.uint8ArrayToUint32Array_(r),_=A[0],I=A[1],D=A[2],k=A[3],b=new Int32Array(e),C=new Int32Array(b.length),w=this.networkToHostOrderSwap;i<b.length;){for(m=1,f=w(b[i]),c=w(b[i+1]),$=w(b[i+2]),g=w(b[i+3]),l=f^y[0],u=g^y[1],d=$^y[2],h=c^y[3],v=4;m<p;m++)n=E[l>>>24]^S[u>>16&255]^L[d>>8&255]^R[255&h]^y[v],a=E[u>>>24]^S[d>>16&255]^L[h>>8&255]^R[255&l]^y[v+1],s=E[d>>>24]^S[h>>16&255]^L[l>>8&255]^R[255&u]^y[v+2],o=E[h>>>24]^S[l>>16&255]^L[u>>8&255]^R[255&d]^y[v+3],l=n,u=a,d=s,h=o,v+=4;n=T[l>>>24]<<24^T[u>>16&255]<<16^T[d>>8&255]<<8^T[255&h]^y[v],a=T[u>>>24]<<24^T[d>>16&255]<<16^T[h>>8&255]<<8^T[255&l]^y[v+1],s=T[d>>>24]<<24^T[h>>16&255]<<16^T[l>>8&255]<<8^T[255&u]^y[v+2],o=T[h>>>24]<<24^T[l>>16&255]<<16^T[u>>8&255]<<8^T[255&d]^y[v+3],C[i]=w(n^_),C[i+1]=w(o^I),C[i+2]=w(s^D),C[i+3]=w(a^k),_=f,I=c,D=$,k=g,i+=4}return C.buffer},t}(),iT=function(){ar e=t.prototype;return e.destroy=function t(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},e.isSync=function t(){return this.useSoftware},e.flush=function t(){var e,i,r,n=this.currentResult,a=this.remainderData;if(!n||a)return this.reset(),null;var s=new Uint8Array(n);return(this.reset(),this.removePKCS7Padding)?(r=(i=(e=s).byteLength)&&new DataView(e.buffer).getUint8(i-1))?ts(e,0,i-r):e:s},e.reset=function t(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},e.decrypt=function t(e,i,r){var n=this;return this.useSoftware?new Promise(:this.webCryptoDecrypt(new Uint8Array(e),i,r)},e.softwareDecrypt=function t(e,i,r){var n=this.currentIV,a=this.currentResult,s=this.remainderData;this.logOnce("JS AES decrypt"),s&&(e=tO(s,e),this.remainderData=null);var o=this.getValidChunk(e);if(!o.length)return null;n&&(r=n);var l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new iy),l.expandKey(i);var u=a;return(this.currentResult=l.decrypt(o.buffer,0,r),this.currentIV=ts(o,-16).buffer,u)?u:null},e.webCryptoDecrypt=function t(e,i,r){var n=this,a=this.subtle;return this.key===i&&this.fastAesKey||(this.key=i,this.fastAesKey=new ip(a,i)),this.fastAesKey.expandKey().then(function(t){return a?(n.logOnce("WebCrypto AES decrypt"),new im(a,new Uint8Array(r)).decrypt(e.buffer,t)):Promise.reject(Error("web crypto not initialized"))}).catch(},e.onWebCryptoError=function t(e,i,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,i,r);var n=this.flush();if(n)return n.buffer;throw Error("WebCrypto and softwareDecrypt: failed to decrypt data")},e.getValidChunk=function t(e){var i=e,r=e.length-e.length%16;return r!==e.length&&(i=ts(e,0,r),this.remainderData=ts(e,r)),i},e.logOnce=function t(e){this.logEnabled&&(M.log("[decrypter]: "+e),this.logEnabled=!1)},t}(),ix={toString:function t(e){for(var i="",r=e.length,n=0;n<r;n++)i+="["+e.start(n).toFixed(3)+"-"+e.end(n).toFixed(3)+"]";return i}},iE={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},iS=function(t){function e(e,i,r,n,a){var s;return(s=t.call(this)||this).hls=void 0,s.fragPrevious=null,s.fragCurrent=null,s.fragmentTracker=void 0,s.transmuxer=null,s._state=iE.STOPPED,s.playlistType=void 0,s.media=null,s.mediaBuffer=null,s.config=void 0,s.bitrateTest=!1,s.lastCurrentTime=0,s.nextLoadPosition=0,s.startPosition=0,s.startTimeOffset=null,s.loadedmetadata=!1,s.retryDate=0,s.levels=null,s.fragmentLoader=void 0,s.keyLoader=void 0,s.levelLastLoaded=null,s.startFragRequested=!1,s.decrypter=void 0,s.initPTS=[],s.onvseeking=null,s.onvended=null,s.logPrefix="",s.log=void 0,s.warn=void 0,s.playlistType=a,s.logPrefix=n,s.log=M.log.bind(M,n+":"),s.warn=M.warn.bind(M,n+":"),s.hls=e,s.fragmentLoader=new ic(e.config),s.keyLoader=r,s.fragmentTracker=i,s.config=e.config,s.decrypter=new iT(e.config),e.on(b.MANIFEST_LOADED,s.onManifestLoaded,function t(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(s)),s}l(e,t);var i=e.prototype;return i.doTick=function t(){this.onTickEnd()},i.onTickEnd=function t(){},i.startLoad=function t(e){},i.stopLoad=function t(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=iE.STOPPED},i._streamEnded=function t(e,i){if(i.live||e.nextStart||!e.end||!this.media)return!1;var r=i.partList;if(null!=r&&r.length){var n=r[r.length-1];return ia.isBuffered(this.media,n.start+n.duration/2)}var a=i.fragments[i.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(a)},i.getLevelDetails=function t(){if(this.levels&&null!==this.levelLastLoaded){var e;return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details}},i.onMediaAttached=function t(e,i){var r=this.media=this.mediaBuffer=i.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.state===iE.STOPPED&&this.startLoad(n.startPosition)},i.onMediaDetaching=function t(){var e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},i.onMediaSeeking=function t(){var e=this.config,i=this.fragCurrent,r=this.media,n=this.mediaBuffer,a=this.state,s=r?r.currentTime:0,o=ia.bufferInfo(n||r,s,e.maxBufferHole);if(this.log("media seeking to "+(k(s)?s.toFixed(3):s)+", state: "+a),this.state===iE.ENDED)this.resetLoadingState();else if(i){var l=e.maxFragLookUpTolerance,u=i.start-l,d=i.start+i.duration+l;if(!o.len||d<o.start||u>o.end){var h=s>d;(s<u||h)&&(h&&i.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),i.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}r&&(this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0),this.lastCurrentTime=s),this.loadedmetadata||o.len||(this.nextLoadPosition=this.startPosition=s),this.tickImmediate()},i.onMediaEnded=i.onManifestLoaded=function t(e,i){this.startTimeOffset=i.startTimeOffset,this.initPTS=[]},i.onHandlerDestroying=function e(){this.stopLoad(),t.prototype.onHandlerDestroying.call(this)},i.onHandlerDestroyed=function e(){this.state=iE.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,t.prototype.onHandlerDestroyed.call(this)},i.loadFragment=i._loadFragForPlayback=function t(e,i,r){var n=this,a=function t(i){if(n.fragContextChanged(e)){n.warn("Fragment "+e.sn+(i.part?" p: "+i.part.index:"")+" of level "+e.level+" was dropped during download."),n.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,n._handleFragmentLoadProgress(i)};this._doFragLoad(e,i,r,a).then(function(t){if(t){var i=n.state;if(n.fragContextChanged(e)){i!==iE.FRAG_LOADING&&(n.fragCurrent||i!==iE.PARSING)||(n.fragmentTracker.removeFragment(e),n.state=iE.IDLE);return}"payload"in t&&(n.log("Loaded fragment "+e.sn+" of level "+e.level),n.hls.trigger(b.FRAG_LOADED,t)),n._handleFragmentLoadComplete(t)}}).catch(function(t){n.state!==iE.STOPPED&&n.state!==iE.ERROR&&(n.warn(t),n.resetFragmentLoading(e))})},i.clearTrackerIfNeeded=function t(e){var i,r=this.fragmentTracker;if(r.getState(e)===eJ.APPENDING){var n=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,n),s=Math.max(e.duration,a?a.len:this.config.maxBufferLength);this.reduceMaxBufferLength(s)&&r.removeFragment(e)}else(null==(i=this.mediaBuffer)?void 0:i.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===eJ.PARTIAL&&r.removeFragment(e))},i.checkLiveUpdate=function t(e){if(e.updated&&!e.live){var i=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:i,part:null,stats:i.stats,id:i.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)},i.flushMainBuffer=function t(e,i,r){if(void 0===r&&(r=null),e-i){var n={startOffset:e,endOffset:i,type:r};this.hls.trigger(b.BUFFER_FLUSHING,n)}},i._loadInitSegment=function t(e,i){var r=this;this._doFragLoad(e,i).then(.then(function(t){var i=r.hls,n=t.payload,a=e.decryptdata;if(n&&n.byteLength>0&&a&&a.key&&a.iv&&"AES-128"===a.method){var s=self.performance.now();return r.decrypter.decrypt(new Uint8Array(n),a.key.buffer,a.iv.buffer).catch(function(t){throw i.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t}).then(}return r.completeInitSegmentLoad(t)}).catch(},i.completeInitSegmentLoad=function t(e){if(!this.levels)throw Error("init load aborted, missing levels");var i=e.frag.stats;this.state=iE.IDLE,e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()},i.fragContextChanged=function t(e){var i=this.fragCurrent;return!e||!i||e.level!==i.level||e.sn!==i.sn||e.urlId!==i.urlId},i.fragBufferedComplete=function t(e,i){var r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered "+e.type+" sn: "+e.sn+(i?" part: "+i.index:"")+" of "+(this.playlistType===ed.MAIN?"level":"track")+" "+e.level+" (frag:["+(null!=(n=e.startPTS)?n:NaN).toFixed(3)+"-"+(null!=(a=e.endPTS)?a:NaN).toFixed(3)+"] > buffer:"+(r?ix.toString(ia.getBuffered(r)):"(detached)")+")"),"initSegment"!==e.sn){if(e.type!==ed.SUBTITLE){var n,a,s,o,l,u=e.elementaryStreams;if(!Object.keys(u).some(function(t){return!!u[t]})){this.state=iE.IDLE;return}}var d=null==(l=this.levels)?void 0:l[e.level];null!=d&&d.fragmentError&&(this.log("Resetting level fragment error count of "+d.fragmentError+" on frag buffered"),d.fragmentError=0)}this.state=iE.IDLE,r&&(!this.loadedmetadata&&e.type==ed.MAIN&&r.buffered.length&&(null==(s=this.fragCurrent)?void 0:s.sn)===(null==(o=this.fragPrevious)?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},i.seekToStartPos=function t(){},i._handleFragmentLoadComplete=function t(e){var i=this.transmuxer;if(i){var r=e.frag,n=e.part,a=e.partsLoaded,s=!a||0===a.length||a.some(function(t){return!t}),o=new is(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!s);i.flush(o)}},i._handleFragmentLoadProgress=function t(e){},i._doFragLoad=function t(e,i,r,n){var a,s,o=this;void 0===r&&(r=null);var l=null==i?void 0:i.details;if(!this.levels||!l)throw Error("frag load aborted, missing level"+(l?"":" detail")+"s");var u=null;if(e.encrypted&&!(null!=(s=e.decryptdata)&&s.key)?(this.log("Loading key for "+e.sn+" of ["+l.startSN+"-"+l.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level),this.state=iE.KEY_LOADING,this.fragCurrent=e,u=this.keyLoader.load(e).then(,this.hls.trigger(b.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(u=Promise.reject(Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&l.encryptedFragments.length&&this.keyLoader.loadClear(e,l.encryptedFragments),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){var d=l.partList;if(d&&n){r>e.end&&l.fragmentHint&&(e=l.fragmentHint);var h=this.getNextPart(d,e,r);if(h>-1){var f,c=d[h];return(this.log("Loading part sn: "+e.sn+" p: "+c.index+" cc: "+e.cc+" of playlist ["+l.startSN+"-"+l.endSN+"] parts [0-"+h+"-"+(d.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=c.start+c.duration,this.state=iE.FRAG_LOADING,f=u?u.then(.catch(function(t){return o.handleFragLoadError(t)}):this.doFragPartsLoad(e,c,i,n).catch(function(t){return o.handleFragLoadError(t)}),this.hls.trigger(b.FRAG_LOADING,{frag:e,part:c,targetBufferTime:r}),null===this.fragCurrent)?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING parts")):f}if(!e.url||this.loadedEndOfParts(d,r))return Promise.resolve(null)}}this.log("Loading fragment "+e.sn+" cc: "+e.cc+" "+(l?"of ["+l.startSN+"-"+l.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),k(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=iE.FRAG_LOADING;var $=this.config.progressive;return(a=$&&u?u.then(.catch(function(t){return o.handleFragLoadError(t)}):Promise.all([this.fragmentLoader.load(e,$?n:void 0),u]).then(.catch(function(t){return o.handleFragLoadError(t)}),this.hls.trigger(b.FRAG_LOADING,{frag:e,targetBufferTime:r}),null===this.fragCurrent)?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING")):a},i.doFragPartsLoad=function t(e,i,r,n){var a=this;return new Promise(},i.handleFragLoadError=function t(e){if("data"in e){var i=e.data;e.data&&i.details===w.INTERNAL_ABORTED?this.handleFragLoadAborted(i.frag,i.part):this.hls.trigger(b.ERROR,i)}else this.hls.trigger(b.ERROR,{type:C.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null},i._handleTransmuxerFlush=function t(e){var i=this.getCurrentContext(e);if(!i||this.state!==iE.PARSING){this.fragCurrent||this.state===iE.STOPPED||this.state===iE.ERROR||(this.state=iE.IDLE);return}var r=i.frag,n=i.part,a=i.level,s=self.performance.now();r.stats.parsing.end=s,n&&(n.stats.parsing.end=s),this.updateLevelTiming(r,n,a,e.partial)},i.getCurrentContext=function t(e){var i=this.levels,r=this.fragCurrent,n=e.level,a=e.sn,s=e.part;if(!(null!=i&&i[n]))return this.warn("Levels object was unset while buffering fragment "+a+" of level "+n+". The current chunk will not be buffered."),null;var o=i[n],l=s>-1?eP(o,a,s):null,u=l?l.fragment:function t(e,i,r){if(!(null!=e&&e.details))return null;var n=e.details,a=n.fragments[i-n.startSN];return a||(a=n.fragmentHint)&&a.sn===i?a:i<n.startSN&&r&&r.sn===i?r:null}(o,a,r);return u?(r&&r!==u&&(u.stats=r.stats),{frag:u,part:l,level:o}):null},i.bufferFragmentData=function t(e,i,r,n,a){if(e&&this.state===iE.PARSING){var s,o=e.data1,l=e.data2,u=o;if(o&&l&&(u=tO(o,l)),null!=(s=u)&&s.length){var d={type:e.type,frag:i,part:r,chunkMeta:n,parent:i.type,data:u};if(this.hls.trigger(b.BUFFER_APPENDING,d),e.dropped&&e.independent&&!r){if(a)return;this.flushBufferGap(i)}}}},i.flushBufferGap=function t(e){var i=this.media;if(i){if(!ia.isBuffered(i,i.currentTime)){this.flushMainBuffer(0,e.start);return}var r=i.currentTime,n=ia.bufferInfo(i,r,0),a=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*a),o=Math.max(Math.min(e.start-s,n.end-s),r+s);e.start-o>s&&this.flushMainBuffer(o,e.start)}},i.getFwdBufferInfo=function t(e,i){var r=this.getLoadPosition();return k(r)?this.getFwdBufferInfoAtPos(e,r,i):null},i.getFwdBufferInfoAtPos=function t(e,i,r){var n=this.config.maxBufferHole,a=ia.bufferInfo(e,i,n);if(0===a.len&&void 0!==a.nextStart){var s=this.fragmentTracker.getBufferedFrag(i,r);if(s&&a.nextStart<s.end)return ia.bufferInfo(e,i,Math.max(a.nextStart,n))}return a},i.getMaxBufferLength=function t(e){var i,r=this.config;return Math.min(i=e?Math.max(8*r.maxBufferSize/e,r.maxBufferLength):r.maxBufferLength,r.maxMaxBufferLength)},i.reduceMaxBufferLength=function t(e){var i=this.config,r=e||i.maxBufferLength;return i.maxMaxBufferLength>=r&&(i.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+i.maxMaxBufferLength+"s"),!0)},i.getAppendedFrag=function t(e,i){var r=this.fragmentTracker.getAppendedFrag(e,ed.MAIN);return r&&"fragment"in r?r.fragment:r},i.getNextFragment=function t(e,i){var r,n=i.fragments,a=n.length;if(!a)return null;var s=this.config,o=n[0].start;if(i.live){var l=s.initialLiveManifestSize;if(a<l)return this.warn("Not enough fragments to start playback (have: "+a+", need: "+l+")"),null;(i.PTSKnown||this.startFragRequested||-1!==this.startPosition)&&!(e<o)||(r=this.getInitialLiveFragment(i,n),this.startPosition=this.nextLoadPosition=r?this.hls.liveSyncPosition||r.start:e)}else e<=o&&(r=n[0]);if(!r){var u=s.lowLatencyMode?i.partEnd:i.fragmentEnd;r=this.getFragmentAtPosition(e,u,i)}return this.mapToInitFragWhenRequired(r)},i.isLoopLoading=function t(e,i){var r=this.fragmentTracker.getState(e);return(r===eJ.OK||r===eJ.PARTIAL&&!!e.gap)&&this.nextLoadPosition>i},i.getNextFragmentLoopLoading=function t(e,i,r,n,a){var s=e.gap,o=this.getNextFragment(this.nextLoadPosition,i);if(null===o)return o;if(e=o,s&&e&&!e.gap&&r.nextStart){var l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n);if(null!==l&&r.len+l.len>=a)return this.log('buffer full after gaps in "'+n+'" playlist starting at sn: '+e.sn),null}return e},i.mapToInitFragWhenRequired=function t(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment},i.getNextPart=function t(e,i,r){for(var n=-1,a=!1,s=!0,o=0,l=e.length;o<l;o++){var u=e[o];if(s=s&&!u.independent,n>-1&&r<u.start)break;var d=u.loaded;d?n=-1:(a||u.independent||s)&&u.fragment===i&&(n=o),a=d}return n},i.loadedEndOfParts=i.getInitialLiveFragment=function t(e,i){var r=this.fragPrevious,n=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),n=function t(e,i,r){if(null===i||!Array.isArray(e)||!e.length||!k(i)||i<(e[0].programDateTime||0)||i>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(var n=0;n<e.length;++n){var a=e[n];if(e6(i,r,a))return a}return null}(i,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){var a,s,o=r.sn+1;if(o>=e.startSN&&o<=e.endSN){var l=i[o-e.startSN];r.cc===l.cc&&(n=l,this.log("Live playlist, switching playlist, load frag with next SN: "+n.sn))}!n&&(n=(a=i,s=r.cc,e2.search(a,))&&this.log("Live playlist, switching playlist, load frag with same CC: "+n.sn)}}else{var u=this.hls.liveSyncPosition;null!==u&&(n=this.getFragmentAtPosition(u,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n},i.getFragmentAtPosition=function t(e,i,r){var n,a=this.config,s=this.fragPrevious,o=r.fragments,l=r.endSN,u=r.fragmentHint,d=a.maxFragLookUpTolerance,h=r.partList,f=!!(a.lowLatencyMode&&null!=h&&h.length&&u);if(f&&u&&!this.bitrateTest&&(o=o.concat(u),l=u.sn),n=e<i?eG(s,o,e,e>i-d?0:d):o[o.length-1]){var c=n.sn-r.startSN,$=this.fragmentTracker.getState(n);if(($===eJ.OK||$===eJ.PARTIAL&&n.gap)&&(s=n),s&&n.sn===s.sn&&(!f||h[0].fragment.sn>n.sn)&&s&&n.level===s.level){var g=o[c+1];n=n.sn<l&&this.fragmentTracker.getState(g)!==eJ.OK?g:null}}return n},i.synchronizeToLiveEdge=function t(e){var i=this.config,r=this.media;if(r){var n=this.hls.liveSyncPosition,a=r.currentTime,s=e.fragments[0].start,o=e.edge,l=a>=s-i.maxFragLookUpTolerance&&a<=o;if(null!==n&&r.duration>n&&(a<n||!l)){var u=void 0!==i.liveMaxLatencyDuration?i.liveMaxLatencyDuration:i.liveMaxLatencyDurationCount*e.targetduration;(!l&&r.readyState<4||a<o-u)&&(this.loadedmetadata||(this.nextLoadPosition=n),r.readyState&&(this.warn("Playback: "+a.toFixed(3)+" is located too far from the end of live sliding playlist: "+o+", reset currentTime to : "+n.toFixed(3)),r.currentTime=n))}}},i.alignPlaylists=function t(e,i){var r=this.levels,n=this.levelLastLoaded,a=this.fragPrevious,s=null!==n?r[n]:null,o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;var l=e.fragments[0].start,u=e.alignedSliding&&k(l);if(!i||!u&&!l){d=a,h=s,f=e,h&&(function t(e,i,r){var n,a,s;if(n=e,a=r,s=i,a.details&&(s.endCC>s.startCC||n&&n.cc<s.startCC)){var o=r.details,i);o&&k(o.start)&&(M.log("Adjusting PTS using last level due to CC increase within current level "+i.url),id(o.start,i))}}(d,f,h),!f.alignedSliding&&h.details&&ih(f,h.details),f.alignedSliding||!h.details||f.skippedSegments||e8(h.details,f));var d,h,f,c=e.fragments[0].start;return this.log("Live playlist sliding: "+c.toFixed(2)+" start-sn: "+(i?i.startSN:"na")+"->"+e.startSN+" prev-sn: "+(a?a.sn:"na")+" fragments: "+o),c}return l},i.waitForCdnTuneIn=function t(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},i.setStartPosition=function t(e,i){var r=this.startPosition;if(r<i&&(r=-1),-1===r||-1===this.lastCurrentTime){var n=null!==this.startTimeOffset,a=n?this.startTimeOffset:e.startTimeOffset;null!==a&&k(a)?(r=i+a,a<0&&(r+=e.totalduration),r=Math.min(Math.max(i,r),i+e.totalduration),this.log("Start time offset "+a+" found in "+(n?"multivariant":"media")+" playlist, adjust startPosition to "+r),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||i:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r},i.getLoadPosition=function t(){var e=this.media,i=0;return this.loadedmetadata&&e?i=e.currentTime:this.nextLoadPosition&&(i=this.nextLoadPosition),i},i.handleFragLoadAborted=function t(e,i){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn("Fragment "+e.sn+(i?" part "+i.index:"")+" of level "+e.level+" was aborted"),this.resetFragmentLoading(e))},i.resetFragmentLoading=function t(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===iE.FRAG_LOADING_WAITING_RETRY)||(this.state=iE.IDLE)},i.onFragmentOrKeyLoadError=function t(e,i){if(i.chunkMeta&&!i.frag){var r=this.getCurrentContext(i.chunkMeta);r&&(i.frag=r.frag)}var n=i.frag;if(n&&n.type===e&&this.levels){if(this.fragContextChanged(n)){this.warn("Frag load error must match current frag to retry "+n.url+" > "+(null==(f=this.fragCurrent)?void 0:f.url));return}var a=i.details===w.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(n,!0);var s=i.errorAction,o=s||{},l=o.action,u=o.retryCount,d=void 0===u?0:u,h=o.retryConfig;if(s&&l===eK.RetryRequest&&h){this.resetStartWhenNotLoaded(null!=(c=this.levelLastLoaded)?c:n.level);var f,c,$=eB(h,d);this.warn("Fragment "+n.sn+" of "+e+" "+n.level+" errored with "+i.details+", retrying loading "+(d+1)+"/"+h.maxNumRetry+" in "+$+"ms"),s.resolved=!0,this.retryDate=self.performance.now()+$,this.state=iE.FRAG_LOADING_WAITING_RETRY}else if(h&&s){if(this.resetFragmentErrors(e),d<h.maxNumRetry)a||l===eK.RemoveAlternatePermanently||(s.resolved=!0);else{M.warn(i.details+" reached or exceeded max retry ("+d+")");return}}else(null==s?void 0:s.action)===eK.SendAlternateToPenaltyBox?this.state=iE.WAITING_LEVEL:this.state=iE.ERROR;this.tickImmediate()}},i.reduceLengthAndFlushBuffer=function t(e){if(this.state===iE.PARSING||this.state===iE.PARSED){var i=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,i),n=r&&r.len>.5;n&&this.reduceMaxBufferLength(r.len);var a=!n;return a&&this.warn("Buffer full error while media.currentTime is not buffered, flush "+i+" buffer"),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),a}return!1},i.resetFragmentErrors=function t(e){e===ed.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==iE.STOPPED&&(this.state=iE.IDLE)},i.afterBufferFlushed=function t(e,i,r){if(e){var n=ia.getBuffered(e);this.fragmentTracker.detectEvictedFragments(i,n,r),this.state===iE.ENDED&&this.resetLoadingState()}},i.resetLoadingState=function t(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=iE.IDLE},i.resetStartWhenNotLoaded=function t(e){if(!this.loadedmetadata){this.startFragRequested=!1;var i=this.levels?this.levels[e].details:null;null!=i&&i.live?(this.startPosition=-1,this.setStartPosition(i,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},i.resetWhenMissingContext=function t(e){var i;this.warn("The loading context changed while buffering fragment "+e.sn+" of level "+e.level+". This chunk will not be buffered."),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(i=this.levelLastLoaded)?i:e.level),this.resetLoadingState()},i.removeUnbufferedFrags=function t(e){void 0===e&&(e=0),this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)},i.updateLevelTiming=function t(e,i,r,n){var a,s=this,o=r.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce(!1)&&(null==(a=this.transmuxer)?void 0:a.error)===null){var l=Error("Found no media in fragment "+e.sn+" of level "+e.level+" resetting transmuxer to fallback to playlist timing");if(0===r.fragmentError&&(r.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:"Found no media in msn "+e.sn+' of level "'+r.url+'"'}),!this.hls)return;this.resetTransmuxer()}this.state=iE.PARSED,this.hls.trigger(b.FRAG_PARSED,{frag:e,part:i})},i.resetTransmuxer=function t(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},i.recoverWorkerError=function t(e){if("demuxerWorker"===e.event){var i,r,n;this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(i=null!=(r=this.levelLastLoaded)?r:null==(n=this.fragCurrent)?void 0:n.level)?i:0),this.resetLoadingState()}},a(e,[{key:"state",get:function t(){return this._state},set:]),e}(eZ),iL=function(){ar e=t.prototype;return e.push=function t(e){this.chunks.push(e),this.dataLength+=e.length},e.flush=function t(){var e,i=this.chunks,r=this.dataLength;return i.length?(e=1===i.length?i[0]:function t(e,i){for(var r=new Uint8Array(i),n=0,a=0;a<e.length;a++){var s=e[a];r.set(s,n),n+=s.length}return r}(i,r),this.reset(),e):new Uint8Array(0)},e.reset=function t(){this.chunks.length=0,this.dataLength=0},t}();ar iA=function(){ar e=t.prototype;return e.resetInitSegment=function t(e,i,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},e.resetTimeStamp=e.resetContiguity=function t(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},e.canParse=e.appendFrame=e.demux=function t(e,i){this.cachedData&&(e=tO(this.cachedData,e),this.cachedData=null);var r,n=tu(e,0),a=n?n.length:0,s=this._audioTrack,o=this._id3Track,l=n?th(n):void 0,u=e.length;for((null===this.basePTS||0===this.frameIndex&&k(l))&&(this.basePTS=i_(l,i,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:ep.audioId3,duration:Number.POSITIVE_INFINITY});a<u;){if(this.canParse(e,a)){var d,h,f=this.appendFrame(s,e,a);f?(this.frameIndex++,this.lastPTS=f.sample.pts,a+=f.length,r=a):a=u}else(d=e,h=a,to(d,h)&&td(d,h+6)+10<=d.length-h)?(n=tu(e,a),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:ep.audioId3,duration:Number.POSITIVE_INFINITY}),a+=n.length,r=a):a++;if(a===u&&r!==u){var c=ts(e,r);this.cachedData?this.cachedData=tO(this.cachedData,c):this.cachedData=c}}return{audioTrack:s,videoTrack:iR(),id3Track:o,textTrack:iR()}},e.demuxSampleAes=function t(e,i,r){return Promise.reject(Error("["+this+"] This demuxer does not support Sample-AES decryption"))},e.flush=function t(e){var i=this.cachedData;return i&&(this.cachedData=null,this.demux(i,0)),{audioTrack:this._audioTrack,videoTrack:iR(),id3Track:this._id3Track,textTrack:iR()}},e.destroy=function t(){},t}(),i_=function t(e,i,r){return k(e)?90*e:9e4*i+(r?9e4*r.baseTime/r.timescale:0)};ction ib(t,e){return e+1<t.length&&iI(t,e)}unction i8(t,e,i,r,n){if(!t.samplerate){var a=function t(e,i,r,n){var a,s,o,l,u=navigator.userAgent.toLowerCase(),d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((192&i[r+2])>>>6)+1;var h=(60&i[r+2])>>>2;if(h>d.length-1){e.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+h});return}return o=(1&i[r+2])<<2,o|=(192&i[r+3])>>>6,M.log("manifest codec:"+n+", ADTS type:"+a+", samplingIndex:"+h),/firefox/i.test(u)?h>=6?(a=5,l=[,,,,],s=h-3):(a=2,l=[,,],s=h):-1!==u.indexOf("android")?(a=2,l=[,,],s=h):(a=5,l=[,,,,],n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&h>=6?s=h-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(h>=6&&1===o||/vivaldi/i.test(u))||!n&&1===o)&&(a=2,l=[,,]),s=h)),l[0]=a<<3,l[0]|=(14&h)>>1,l[1]|=(1&h)<<7,l[1]|=o<<3,5===a&&(l[1]|=(14&s)>>1,l[2]=(1&s)<<7,l[2]|=8,l[3]=0),{config:l,samplerate:d[h],channelCount:o,codec:"mp4a.40."+a,manifestCodec:n}}(e,i,r,n);a&&(t.config=a.config,t.samplerate=a.samplerate,t.channelCount=a.channelCount,t.codec=a.codec,t.manifestCodec=a.manifestCodec,M.log("parsed codec:"+t.codec+", rate:"+a.samplerate+", channels:"+a.channelCount))}}unction iP(t,e,i,r,n){var a,s=iw(t.samplerate),o=r+n*s,l=function t(e,i){var r=iD(e,i);if(i+r<=e.length){var n=ik(e,i)-r;if(n>0)return{headerLength:r,frameLength:n}}}(e,i);if(l){var u=l.frameLength,d=l.headerLength,h=d+u,f=Math.max(0,i+h-e.length);f?(a=new Uint8Array(h-d)).set(e.subarray(i+d,e.length),0):a=e.subarray(i+d,i+h);var c={unit:a,pts:o};return f||t.samples.push(c),{sample:c,length:h,missing:f}}var $=e.length-i;return(a=new Uint8Array($)).set(e.subarray(i,e.length),0),{sample:{unit:a,pts:o},length:$,missing:-1}}var iF=null,iO=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],iN=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],iM=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],iB=[0,1,1,4];6=function(t){(e,t);var i=e.prototype;return i.resetInitSegment=function e(i,r,n,a){t.prototype.resetInitSegment.call(this,i,r,n,a),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},e.probe=function t(e){if(!e)return!1;var i=tu(e,0),r=(null==i?void 0:i.length)||0;if(i1(e,r))return!1;for(var n=e.length;r<n;r++)if(iC(e,r))return M.log("ADTS sync word found !"),!0;return!1},i.canParse=function t(e,i){var r,n,a,s;return r=e,n=i,a=r,(s=n)+5<a.length&&iI(r,n)&&ik(r,n)<=r.length-n},i.appendFrame=function t(e,i,r){i8(e,this.observer,i,r,e.manifestCodec);var n=iP(e,i,r,this.basePTS,this.frameIndex);if(n&&0===n.missing)return n},e}(iA),iK=/\/emsg[-/]ID3/i,i4=function(){ar e=t.prototype;return e.resetTimeStamp=function t(){},e.resetInitSegment=function t(e,i,r,n){var a=this.videoTrack=iR("video",1),s=this.audioTrack=iR("audio",1),o=this.txtTrack=iR("text",1);if(this.id3Track=iR("id3",1),this.timeOffset=0,null!=e&&e.byteLength){var l=tb(e);if(l.video){var u=l.video,d=u.id,h=u.timescale,f=u.codec;a.id=d,a.timescale=o.timescale=h,a.codec=f}if(l.audio){var c=l.audio,$=c.id,g=c.timescale,v=c.codec;s.id=$,s.timescale=g,s.codec=v}o.id=tS.text,a.sampleDuration=0,a.duration=s.duration=n}},e.resetContiguity=function t(){this.remainderData=null},t.probe=function t(e){return tD(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0},e.demux=function t(e,i){this.timeOffset=i;var r=e,n=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=tO(this.remainderData,e));var s=function t(e){var i={valid:null,remainder:null},r=tD(e,["moof"]);if(!r)return i;if(r.length<2)return i.remainder=e,i;var n=r[r.length-1];return i.valid=ts(e,0,n.byteOffset-8),i.remainder=ts(e,n.byteOffset-8),i}(r);this.remainderData=s.remainder,n.samples=s.valid||new Uint8Array}else n.samples=r;var o=this.extractID3Track(n,i);return a.samples=tN(i,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}},e.flush=function t(){var e=this.timeOffset,i=this.videoTrack,r=this.txtTrack;i.samples=this.remainderData||new Uint8Array,this.remainderData=null;var n=this.extractID3Track(i,this.timeOffset);return r.samples=tN(e,i),{videoTrack:i,audioTrack:iR(),id3Track:n,textTrack:iR()}},e.extractID3Track=function t(e,i){var r=this.id3Track;if(e.samples.length){var n=tD(e.samples,["emsg"]);n&&n.forEach(function(t){var e=function t(e){var i=e[0],r="",n="",a=0,s=0,o=0,l=0,u=0,d=0;if(0===i){for(;"\0"!==tL(e.subarray(d,d+1));)r+=tL(e.subarray(d,d+1)),d+=1;for(r+=tL(e.subarray(d,d+1)),d+=1;"\0"!==tL(e.subarray(d,d+1));)n+=tL(e.subarray(d,d+1)),d+=1;n+=tL(e.subarray(d,d+1)),d+=1,a=tA(e,12),s=tA(e,16),l=tA(e,20),u=tA(e,24),d=28}else if(1===i){d+=4,a=tA(e,d);var h=tA(e,d+=4),f=tA(e,d+=4);for(d+=4,Number.isSafeInteger(o=4294967296*h+f)||(o=Number.MAX_SAFE_INTEGER,M.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=tA(e,d),d+=4,u=tA(e,d),d+=4;"\0"!==tL(e.subarray(d,d+1));)r+=tL(e.subarray(d,d+1)),d+=1;for(r+=tL(e.subarray(d,d+1)),d+=1;"\0"!==tL(e.subarray(d,d+1));)n+=tL(e.subarray(d,d+1)),d+=1;n+=tL(e.subarray(d,d+1)),d+=1}var c=e.subarray(d,e.byteLength);return{schemeIdUri:r,value:n,timeScale:a,presentationTime:o,presentationTimeDelta:s,eventDuration:l,id:u,payload:c}}(t);if(iK.test(e.schemeIdUri)){var n=k(e.presentationTime)?e.presentationTime/e.timeScale:i+e.presentationTimeDelta/e.timeScale,a=4294967295===e.eventDuration?Number.POSITIVE_INFINITY:e.eventDuration/e.timeScale;a<=.001&&(a=Number.POSITIVE_INFINITY);var s=e.payload;r.samples.push({data:s,len:s.byteLength,dts:n,pts:n,type:ep.emsg,duration:a})}})}return r},e.demuxSampleAes=function t(e,i,r){return Promise.reject(Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},e.destroy=function t(){},t}(),i3=function t(e,i){var r=0,n=5;i+=n;for(var a=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);n>0;){o[0]=e[i];var l=Math.min(n,8),u=8-l;s[0]=4278190080>>>24+u<<u,a[0]=(o[0]&s[0])>>u,r=r?r<<l|a[0]:a[0],i+=1,n-=l}return r},iH=function(t){(e,t);var i=e.prototype;return i.resetInitSegment=function e(i,r,n,a){t.prototype.resetInitSegment.call(this,i,r,n,a),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},i.canParse=function t(e,i){return i+64<e.length},i.appendFrame=function t(e,i,r){var n=iV(e,i,r,this.basePTS,this.frameIndex);if(-1!==n)return{sample:e.samples[e.samples.length-1],length:n,missing:0}},e.probe=function t(e){if(!e)return!1;var i=tu(e,0);if(!i)return!1;var r=i.length;return!!(11===e[r]&&119===e[r+1]&&void 0!==th(i)&&16>i3(e,r))},e}(iA);function iV(t,e,i,r,n){if(i+8>e.length||11!==e[i]||119!==e[i+1])return -1;var a=e[i+4]>>6;if(a>=3)return -1;var s=[48e3,44100,32e3][a],o=63&e[i+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+a];if(i+l>e.length)return -1;var u=e[i+6]>>5,d=0;2===u?d+=2:(1&u&&1!==u&&(d+=2),4&u&&(d+=2));var h=(e[i+6]<<8|e[i+7])>>12-d&1,f=[2,1,2,3,3,4,4,5][u]+h,c=e[i+5]>>3,$=7&e[i+5],g=new Uint8Array([a<<6|c<<1|$>>2,(3&$)<<6|u<<3|h<<2|o>>4,o<<4&224]),v=e.subarray(i,i+l);return t.config=g,t.channelCount=f,t.samplerate=s,t.samples.push({unit:v,pts:r+n*(1536/s*9e4)}),l}var iY=function(){ar e=t.prototype;return e.createVideoSample=function t(e,i,r,n){return{key:e,frame:!1,pts:i,dts:r,units:[],debug:n,length:0}},e.getLastNalUnit=function t(e){var i,r,n=this.VideoSample;if(n&&0!==n.units.length||(n=e[e.length-1]),null!=(i=n)&&i.units){var a=n.units;r=a[a.length-1]}return r},e.pushAccessUnit=function t(e,i){if(e.units.length&&e.frame){if(void 0===e.pts){var r=i.samples,n=r.length;if(n){var a=r[n-1];e.pts=a.pts,e.dts=a.dts}else{i.dropped++;return}}i.samples.push(e)}e.debug.length&&M.log(e.pts+"/"+e.dts+":"+e.debug)},t}(),i7=function(){ar e=t.prototype;return e.loadWord=function t(){var e=this.data,i=this.bytesAvailable,r=e.byteLength-i,n=new Uint8Array(4),a=Math.min(4,i);if(0===a)throw Error("no bytes available");n.set(e.subarray(r,r+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a},e.skipBits=function t(e){var i;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,i=e>>3,e-=i<<3,this.bytesAvailable-=i,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},e.readBits=function t(e){var i=Math.min(this.bitsAvailable,e),r=this.word>>>32-i;if(e>32&&M.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=i,this.bitsAvailable>0)this.word<<=i;else if(this.bytesAvailable>0)this.loadWord();else throw Error("no bits available");return(i=e-i)>0&&this.bitsAvailable?r<<i|this.readBits(i):r},e.skipLZ=function t(){var e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!=0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.skipUEG=function t(){this.skipBits(1+this.skipLZ())},e.skipEG=e.readUEG=e.readEG=function t(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.readBoolean=e.readUByte=function t(){return this.readBits(8)},e.readUShort=function t(){return this.readBits(16)},e.readUInt=e.skipScalingList=function t(e){for(var i,r=8,n=8,a=0;a<e;a++)0!==n&&(n=(r+(i=this.readEG())+256)%256),r=0===n?r:n},e.readSPS=function t(){var e,i,r,n=0,a=0,s=0,o=0,l=this.readUByte.bind(this),u=this.readBits.bind(this),d=this.readUEG.bind(this),h=this.readBoolean.bind(this),f=this.skipBits.bind(this),c=this.skipEG.bind(this),$=this.skipUEG.bind(this),g=this.skipScalingList.bind(this);l();var v=l();if(u(5),f(3),l(),$(),100===v||110===v||122===v||244===v||44===v||83===v||86===v||118===v||128===v){var m=d();if(3===m&&f(1),$(),$(),f(1),h())for(r=0,i=3!==m?8:12;r<i;r++)h()&&g(r<6?16:64)}$();var p=d();if(0===p)d();else if(1===p)for(f(1),c(),c(),e=d(),r=0;r<e;r++)c();$(),f(1);var y=d(),T=d(),x=u(1);0===x&&f(1),f(1),h()&&(n=d(),a=d(),s=d(),o=d());var E=[1,1];if(h()&&h()){var S=l();switch(S){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[l()<<8|l(),l()<<8|l()]}}return{width:Math.ceil((y+1)*16-2*n-2*a),height:(2-x)*(T+1)*16-(x?2:4)*(s+o),pixelRatio:E}},e.readSliceType=function t(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),iW=function(t){function e(){return t.apply(this,arguments)||this}l(e,t);var i=e.prototype;return i.parseAVCPES=function t(e,i,r,n,a){var s,o=this,l=this.parseAVCNALu(e,r.data),u=this.VideoSample,d=!1;r.data=null,u&&l.length&&!e.audFound&&(this.pushAccessUnit(u,e),u=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts,"")),l.forEach(function(t){switch(t.type){case 1:var n,l,h=!1;s=!0;var f=t.data;if(d&&f.length>4){var c=new i7(f).readSliceType();(2===c||4===c||7===c||9===c)&&(h=!0)}h&&null!=(l=u)&&l.frame&&!u.key&&(o.pushAccessUnit(u,e),u=o.VideoSample=null),u||(u=o.VideoSample=o.createVideoSample(!0,r.pts,r.dts,"")),u.frame=!0,u.key=h;break;case 5:s=!0,null!=(n=u)&&n.frame&&!u.key&&(o.pushAccessUnit(u,e),u=o.VideoSample=null),u||(u=o.VideoSample=o.createVideoSample(!0,r.pts,r.dts,"")),u.key=!0,u.frame=!0;break;case 6:s=!0,tB(t.data,1,r.pts,i.samples);break;case 7:s=!0,d=!0;var $,g,v=t.data,m=new i7(v).readSPS();if(!e.sps||e.width!==m.width||e.height!==m.height||(null==($=e.pixelRatio)?void 0:$[0])!==m.pixelRatio[0]||(null==(g=e.pixelRatio)?void 0:g[1])!==m.pixelRatio[1]){e.width=m.width,e.height=m.height,e.pixelRatio=m.pixelRatio,e.sps=[v],e.duration=a;for(var p=v.subarray(1,4),y="avc1.",T=0;T<3;T++){var x=p[T].toString(16);x.length<2&&(x="0"+x),y+=x}e.codec=y}break;case 8:s=!0,e.pps=[t.data];break;case 9:s=!0,e.audFound=!0,u&&o.pushAccessUnit(u,e),u=o.VideoSample=o.createVideoSample(!1,r.pts,r.dts,"");break;case 12:s=!0;break;default:s=!1,u&&(u.debug+="unknown NAL "+t.type+" ")}u&&s&&u.units.push(t)}),n&&u&&(this.pushAccessUnit(u,e),this.VideoSample=null)},i.parseAVCNALu=function t(e,i){var r,n,a,s=i.byteLength,o=e.naluState||0,l=o,u=[],d=0,h=-1,f=0;for(-1===o&&(h=0,f=31&i[0],o=0,d=1);d<s;){if(r=i[d++],!o){o=r?0:1;continue}if(1===o){o=r?0:2;continue}if(r){if(1===r){if(n=d-o-1,h>=0){var c={data:i.subarray(h,n),type:f};u.push(c)}else{var $=this.getLastNalUnit(e.samples);$&&(l&&d<=4-l&&$.state&&($.data=$.data.subarray(0,$.data.byteLength-l)),n>0&&($.data=tO($.data,i.subarray(0,n)),$.state=0))}d<s?(a=31&i[d],h=d,f=a,o=0):o=-1}else o=0}else o=3}if(h>=0&&o>=0){var g={data:i.subarray(h,s),type:f,state:o};u.push(g)}if(0===u.length){var v=this.getLastNalUnit(e.samples);v&&(v.data=tO(v.data,i))}return e.naluState=o,u},e}(iY),i5=function(){ar e=t.prototype;return e.decryptBuffer=function t(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)},e.decryptAacSample=function t(e,i,r){var n=this,a=e[i].unit;if(!(a.length<=16)){var s=a.subarray(16,a.length-a.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(}},e.decryptAacSamples=function t(e,i,r){for(;;i++){if(i>=e.length){r();return}if(!(e[i].unit.length<32)&&(this.decryptAacSample(e,i,r),!this.decrypter.isSync()))return}},e.getAvcEncryptedData=function t(e){for(var i=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(i),n=0,a=32;a<e.length-16;a+=160,n+=16)r.set(e.subarray(a,a+16),n);return r},e.getAvcDecryptedUnit=function t(e,i){for(var r=new Uint8Array(i),n=0,a=32;a<e.length-16;a+=160,n+=16)e.set(r.subarray(n,n+16),a);return e},e.decryptAvcSample=function t(e,i,r,n,a){var s=this,o=tU(a.data),l=this.getAvcEncryptedData(o);this.decryptBuffer(l.buffer).then(},e.decryptAvcSamples=function t(e,i,r,n){if(e instanceof Uint8Array)throw Error("Cannot decrypt samples of type Uint8Array");for(;;i++,r=0){if(i>=e.length){n();return}for(var a=e[i].units;!(r>=a.length);r++){var s=a[r];if(!(s.data.length<=48)&&(1===s.type||5===s.type)&&(this.decryptAvcSample(e,i,r,n,s),!this.decrypter.isSync()))return}}},t}(),iq=function(){.probe=function e(i){var r=t.syncOffset(i);return r>0&&M.warn("MPEG2-TS detected but first sync word found @ offset "+r),-1!==r},t.syncOffset=function t(e){for(var i=e.length,r=Math.min(940,e.length-188)+1,n=0;n<r;){for(var a=!1,s=-1,o=0,l=n;l<i;l+=188)if(71===e[l]){if(o++,-1===s&&0!==(s=l)&&(r=Math.min(s+18612,e.length-188)+1),a||(a=0===iX(e,l)),a&&o>1&&(0===s&&o>2||l+188>r))return s}else if(o)return -1;else break;n++}return -1},t.createTrack=function t(e,i){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:tS[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?i:void 0}};var e=t.prototype;return e.resetInitSegment=function e(i,r,n,a){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=t.createTrack("video"),this._audioTrack=t.createTrack("audio",a),this._id3Track=t.createTrack("id3"),this._txtTrack=t.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=n,this._duration=a},e.resetTimeStamp=function t(){},e.resetContiguity=function t(){var e=this._audioTrack,i=this._videoTrack,r=this._id3Track;e&&(e.pesData=null),i&&(i.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null},e.demux=function e(i,r,n,a){void 0===n&&(n=!1),void 0===a&&(a=!1),n||(this.sampleAes=null);var s,o=this._videoTrack,l=this._audioTrack,u=this._id3Track,d=this._txtTrack,h=o.pid,f=o.pesData,c=l.pid,$=u.pid,g=l.pesData,v=u.pesData,m=null,p=this.pmtParsed,y=this._pmtId,T=i.length;if(this.remainderData&&(T=(i=tO(this.remainderData,i)).length,this.remainderData=null),T<188&&!a)return this.remainderData=i,{audioTrack:l,videoTrack:o,id3Track:u,textTrack:d};var x=Math.max(0,t.syncOffset(i));(T-=(T-x)%188)<i.byteLength&&!a&&(this.remainderData=new Uint8Array(i.buffer,T,i.buffer.byteLength-T));for(var E=0,S=x;S<T;S+=188)if(71===i[S]){var L=!!(64&i[S+1]),R=iX(i,S),A=(48&i[S+3])>>4,_=void 0;if(A>1){if((_=S+5+i[S+4])===S+188)continue}else _=S+4;switch(R){case h:L&&(f&&(s=i9(f))&&this.videoParser.parseAVCPES(o,d,s,!1,this._duration),f={data:[],size:0}),f&&(f.data.push(i.subarray(_,S+188)),f.size+=S+188-_);break;case c:if(L){if(g&&(s=i9(g)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,s);break;case"mp3":this.parseMPEGPES(l,s);break;case"ac3":this.parseAC3PES(l,s)}g={data:[],size:0}}g&&(g.data.push(i.subarray(_,S+188)),g.size+=S+188-_);break;case $:L&&(v&&(s=i9(v))&&this.parseID3PES(u,s),v={data:[],size:0}),v&&(v.data.push(i.subarray(_,S+188)),v.size+=S+188-_);break;case 0:L&&(_+=i[_]+1),y=this._pmtId=iz(i,_);break;case y:L&&(_+=i[_]+1);var I=ij(i,_,this.typeSupported,n);(h=I.videoPid)>0&&(o.pid=h,o.segmentCodec=I.segmentVideoCodec),(c=I.audioPid)>0&&(l.pid=c,l.segmentCodec=I.segmentAudioCodec),($=I.id3Pid)>0&&(u.pid=$),null===m||p||(M.warn("MPEG-TS PMT found at "+S+" after unknown PID '"+m+"'. Backtracking to sync byte @"+x+" to parse all TS packets."),m=null,S=x-188),p=this.pmtParsed=!0;break;case 17:case 8191:break;default:m=R}}else E++;if(E>0){var D=Error("Found "+E+" TS packet/s that do not start with 0x47");this.observer.emit(b.ERROR,b.ERROR,{type:C.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,error:D,reason:D.message})}o.pesData=f,l.pesData=g,u.pesData=v;var k={audioTrack:l,videoTrack:o,id3Track:u,textTrack:d};return a&&this.extractRemainingSamples(k),k},e.flush=function t(){var e,i=this.remainderData;return(this.remainderData=null,e=i?this.demux(i,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes)?this.decrypt(e,this.sampleAes):e},e.extractRemainingSamples=function t(e){var i,r=e.audioTrack,n=e.videoTrack,a=e.id3Track,s=e.textTrack,o=n.pesData,l=r.pesData,u=a.pesData;if(o&&(i=i9(o))?(this.videoParser.parseAVCPES(n,s,i,!0,this._duration),n.pesData=null):n.pesData=o,l&&(i=i9(l))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,i);break;case"mp3":this.parseMPEGPES(r,i);break;case"ac3":this.parseAC3PES(r,i)}r.pesData=null}else null!=l&&l.size&&M.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=l;u&&(i=i9(u))?(this.parseID3PES(a,i),a.pesData=null):a.pesData=u},e.demuxSampleAes=function t(e,i,r){var n=this.demux(e,r,!0,!this.config.progressive),a=this.sampleAes=new i5(this.observer,this.config,i);return this.decrypt(n,a)},e.decrypt=function t(e,i){return new Promise(},e.destroy=function t(){this._duration=0},e.parseAACPES=function t(e,i){var r,n,a=0,s=this.aacOverFlow,o=i.data;if(s){this.aacOverFlow=null;var l=s.missing,u=s.sample.unit.byteLength;-1===l?o=tO(s.sample.unit,o):(s.sample.unit.set(o.subarray(0,l),u-l),e.samples.push(s.sample),a=s.missing)}for(d=a,h=o.length;d<h-1&&!ib(o,d);d++);if(d!==a){var d,h,f,c=d<h-1,$=Error(f=c?"AAC PES did not start with ADTS header,offset:"+d:"No ADTS header found in AAC PES");if(M.warn("parsing error: "+f),this.observer.emit(b.ERROR,b.ERROR,{type:C.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,levelRetry:c,error:$,reason:f}),!c)return}if(i8(e,this.observer,o,d,this.audioCodec),void 0!==i.pts)r=i.pts;else if(s){var g=iw(e.samplerate);r=s.sample.pts+g}else{M.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var v=0;d<h;){if(n=iP(e,o,d,r,v),d+=n.length,n.missing){this.aacOverFlow=n;break}for(v++;d<h-1&&!ib(o,d);d++);}},e.parseMPEGPES=function t(e,i){var r=i.data,n=r.length,a=0,s=0,o=i.pts;if(void 0===o){M.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;s<n;)if(iG(r,s)){var l=iU(e,r,s,o,a);if(l)s+=l.length,a++;else break}else s++},e.parseAC3PES=function t(e,i){var r,n=i.data,a=i.pts;if(void 0===a){M.warn("[tsdemuxer]: AC3 PES unknown PTS");return}for(var s=n.length,o=0,l=0;l<s&&(r=iV(e,n,l,a,o++))>0;)l+=r},e.parseID3PES=function t(e,i){if(void 0===i.pts){M.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var r=o({},i,{type:this._videoTrack?ep.emsg:ep.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)},t}();nction ij(t,e,i,r){var n={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=(15&t[e+1])<<8|t[e+2],s=e+3+a-4,o=(15&t[e+10])<<8|t[e+11];for(e+=12+o;e<s;){var l=iX(t,e),u=(15&t[e+3])<<8|t[e+4];switch(t[e]){case 207:if(!r){iQ("ADTS AAC");break}case 15:-1===n.audioPid&&(n.audioPid=l);break;case 21:-1===n.id3Pid&&(n.id3Pid=l);break;case 219:if(!r){iQ("H.264");break}case 27:-1===n.videoPid&&(n.videoPid=l,n.segmentVideoCodec="avc");break;case 3:case 4:i.mpeg||i.mp3?-1===n.audioPid&&(n.audioPid=l,n.segmentAudioCodec="mp3"):M.log("MPEG audio found, not supported in this browser");break;case 193:if(!r){iQ("AC-3");break}case 129:i.ac3?-1===n.audioPid&&(n.audioPid=l,n.segmentAudioCodec="ac3"):M.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===n.audioPid&&u>0)for(var d=e+5,h=u;h>2;){106===t[d]&&(!0!==i.ac3?M.log("AC-3 audio found, not supported in this browser for now"):(n.audioPid=l,n.segmentAudioCodec="ac3"));var f=t[d+1]+2;d+=f,h-=f}break;case 194:case 135:M.warn("Unsupported EC-3 in M2TS found");break;case 36:M.warn("Unsupported HEVC in M2TS found")}e+=u+5}return n}unction i9(t){var e,i,r,n,a,s=0,o=t.data;if(!t||0===t.size)return null;for(;o[0].length<19&&o.length>1;)o[0]=tO(o[0],o[1]),o.splice(1,1);if(1===((e=o[0])[0]<<16)+(e[1]<<8)+e[2]){if((i=(e[4]<<8)+e[5])&&i>t.size-6)return null;var l=e[7];192&l&&(n=(14&e[9])*536870912+(255&e[10])*4194304+(254&e[11])*16384+(255&e[12])*128+(254&e[13])/2,64&l?n-(a=(14&e[14])*536870912+(255&e[15])*4194304+(254&e[16])*16384+(255&e[17])*128+(254&e[18])/2)>54e5&&(M.warn(Math.round((n-a)/9e4)+"s delta between PTS and DTS, align them"),n=a):a=n);var u=(r=e[8])+9;if(t.size<=u)return null;t.size-=u;for(var d=new Uint8Array(t.size),h=0,f=o.length;h<f;h++){var c=(e=o[h]).byteLength;if(u){if(u>c){u-=c;continue}e=e.subarray(u),c-=u,u=0}d.set(e,s),s+=c}return i&&(i-=r+3),{data:d,pts:n,dts:a,len:i}}return null}var iZ=function(t){(e,t);var i=e.prototype;return i.resetInitSegment=function e(i,r,n,a){t.prototype.resetInitSegment.call(this,i,r,n,a),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},e.probe=function t(e){if(!e)return!1;var i=tu(e,0),r=(null==i?void 0:i.length)||0;if(i&&11===e[r]&&119===e[r+1]&&void 0!==th(i)&&16>=i3(e,r))return!1;for(var n=e.length;r<n;r++)if(i1(e,r))return M.log("MPEG Audio sync word found !"),!0;return!1},i.canParse=function t(e,i){var r,n;return r=e,i2(r,n=i)&&4<=r.length-n},i.appendFrame=function t(e,i,r){if(null!==this.basePTS)return iU(e,i,r,this.basePTS,this.frameIndex)},e}(iA),iJ=function(){function t(){}return t.getSilentFrame=function t(e,i){if("mp4a.40.2"===e){if(1===i)return new Uint8Array([0,200,0,128,35,128]);if(2===i)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===i)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);else if(4===i)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);else if(5===i)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);else if(6===i)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===i)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===i)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===i)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},t}(),rt=function(){function t(){}return t.init=function e(){for(i in t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},t.types)t.types.hasOwnProperty(i)&&(t.types[i]=[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3)]);var i,r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:r,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=s,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,o,u,o,l),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,a))},t.box=function t(e){for(var i=8,r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];for(var s=n.length,o=s;s--;)i+=n[s].byteLength;var l=new Uint8Array(i);for(l[0]=i>>24&255,l[1]=i>>16&255,l[2]=i>>8&255,l[3]=255&i,l.set(e,4),s=0,i=8;s<o;s++)l.set(n[s],i),i+=n[s].byteLength;return l},t.hdlr=t.mdat=t.mdhd=function e(i,r){var n=Math.floor((r*=i)/4294967296),a=Math.floor(r%4294967296);return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},t.mdia=t.mfhd=function e(i){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i]))},t.minf=function e(i){return"audio"===i.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(i)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(i))},t.moof=t.moov=function e(i){for(var r=i.length,n=[];r--;)n[r]=t.trak(i[r]);return t.box.apply(null,[t.types.moov,t.mvhd(i[0].timescale,i[0].duration)].concat(n).concat(t.mvex(i)))},t.mvex=function e(i){for(var r=i.length,n=[];r--;)n[r]=t.trex(i[r]);return t.box.apply(null,[t.types.mvex].concat(n))},t.mvhd=function e(i,r){var n=Math.floor((r*=i)/4294967296),a=Math.floor(r%4294967296),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,s)},t.sdtp=function e(i){var r,n,a=i.samples||[],s=new Uint8Array(4+a.length);for(r=0;r<a.length;r++)n=a[r].flags,s[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return t.box(t.types.sdtp,s)},t.stbl=t.avc1=function e(i){var r,n,a,s=[],o=[];for(r=0;r<i.sps.length;r++)a=(n=i.sps[r]).byteLength,s.push(a>>>8&255),s.push(255&a),s=s.concat(Array.prototype.slice.call(n));for(r=0;r<i.pps.length;r++)a=(n=i.pps[r]).byteLength,o.push(a>>>8&255),o.push(255&a),o=o.concat(Array.prototype.slice.call(n));var l=t.box(t.types.avcC,new Uint8Array([1,s[3],s[4],s[5],255,224|i.sps.length].concat(s).concat([i.pps.length]).concat(o))),u=i.width,d=i.height,h=i.pixelRatio[0],f=i.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,255&h,f>>24,f>>16&255,f>>8&255,255&f])))},t.esds=t.audioStsd=function t(e){var i=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0])},t.mp4a=function e(i){return t.box(t.types.mp4a,t.audioStsd(i),t.box(t.types.esds,t.esds(i)))},t.mp3=function e(i){return t.box(t.types[".mp3"],t.audioStsd(i))},t.ac3=function e(i){return t.box(t.types["ac-3"],t.audioStsd(i),t.box(t.types.dac3,i.config))},t.stsd=function e(i){return"audio"!==i.type?t.box(t.types.stsd,t.STSD,t.avc1(i)):"mp3"===i.segmentCodec&&"mp3"===i.codec?t.box(t.types.stsd,t.STSD,t.mp3(i)):"ac3"===i.segmentCodec?t.box(t.types.stsd,t.STSD,t.ac3(i)):t.box(t.types.stsd,t.STSD,t.mp4a(i))},t.tkhd=function e(i){var r=i.id,n=i.duration*i.timescale,a=i.width,s=i.height,o=Math.floor(n/4294967296),l=Math.floor(n%4294967296);return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,s>>8&255,255&s,0,0]))},t.traf=function e(i,r){var n=t.sdtp(i),a=i.id,s=Math.floor(r/4294967296),o=Math.floor(r%4294967296);return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o])),t.trun(i,n.length+16+20+8+16+8+8),n)},t.trak=function e(i){return i.duration=i.duration||4294967295,t.box(t.types.trak,t.tkhd(i),t.mdia(i))},t.trex=function e(i){var r=i.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},t.trun=function e(i,r){var n,a,s,o,l,u,d=i.samples||[],h=d.length,f=12+16*h,c=new Uint8Array(f);for(r+=8+f,c.set(["video"===i.type?1:0,0,15,1,h>>>24&255,h>>>16&255,h>>>8&255,255&h,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<h;n++)s=(a=d[n]).duration,o=a.size,l=a.flags,u=a.cts,c.set([s>>>24&255,s>>>16&255,s>>>8&255,255&s,o>>>24&255,o>>>16&255,o>>>8&255,255&o,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.paddingValue<<1|l.isNonSync,61440&l.degradPrio,15&l.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*n);return t.box(t.types.trun,c)},t.initSegment=function e(i){t.types||t.init();var r=t.moov(i);return tO(t.FTYP,r)},t}();.types=void 0,rt.HDLR_TYPES=void 0,rt.STTS=void 0,rt.STSC=void 0,rt.STCO=void 0,rt.STSZ=void 0,rt.VMHD=void 0,rt.SMHD=void 0,rt.STSD=void 0,rt.FTYP=void 0,rt.DINF=void 0;var rr=null,rn=null,ra=function(){ar e=t.prototype;return e.destroy=function t(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null},e.resetTimeStamp=function t(e){M.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e},e.resetNextTimestamp=function t(){M.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},e.resetInitSegment=function t(){M.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0},e.getVideoStartPts=function t(e){var i=!1,r=e.reduce(e[0].pts);return i&&M.debug("PTS rollover detected"),r},e.remux=function t(e,i,r,n,a,s,o,l){var u=a,d=a,h=e.pid>-1,f=i.pid>-1,c=i.samples.length,$=e.samples.length>0,g=o&&c>0||c>1;if((!h||$)&&(!f||g)||this.ISGenerated||o){if(this.ISGenerated){var v,m,p,y,T,x,E,S,L,R,A,_=this.videoTrackConfig;_&&(i.width!==_.width||i.height!==_.height||(null==(S=i.pixelRatio)?void 0:S[0])!==(null==(L=_.pixelRatio)?void 0:L[0])||(null==(R=i.pixelRatio)?void 0:R[1])!==(null==(A=_.pixelRatio)?void 0:A[1]))&&this.resetInitSegment()}else p=this.generateIS(e,i,a,s);var I=this.isVideoContiguous,D=-1;if(g&&(D=function t(e){for(var i=0;i<e.length;i++)if(e[i].key)return i;return -1}(i.samples),!I&&this.config.forceKeyFrameOnDiscontinuity)){if(x=!0,D>0){M.warn("[mp4-remuxer]: Dropped "+D+" out of "+c+" video samples due to a missing keyframe");var k=this.getVideoStartPts(i.samples);i.samples=i.samples.slice(D),i.dropped+=D,d+=(i.samples[0].pts-k)/i.inputTimeScale,E=d}else -1===D&&(M.warn("[mp4-remuxer]: No keyframe found out of "+c+" video samples"),x=!1)}if(this.ISGenerated){if($&&g){var b=this.getVideoStartPts(i.samples),C=(rs(e.samples[0].pts,b)-b)/i.inputTimeScale;u+=Math.max(0,C),d+=Math.max(0,-C)}if($){if(e.samplerate||(M.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),p=this.generateIS(e,i,a,s)),m=this.remuxAudio(e,u,this.isAudioContiguous,s,f||g||l===ed.AUDIO?d:void 0),g){var w=m?m.endPTS-m.startPTS:0;i.inputTimeScale||(M.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),p=this.generateIS(e,i,a,s)),v=this.remuxVideo(i,d,I,w)}}else g&&(v=this.remuxVideo(i,d,I,0));v&&(v.firstKeyFrame=D,v.independent=-1!==D,v.firstKeyFramePTS=E)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(T=ro(r,a,this._initPTS,this._initDTS)),n.samples.length&&(y=rl(n,a,this._initPTS))),{audio:m,video:v,initSegment:p,independent:x,text:y,id3:T}},e.generateIS=function t(e,i,r,n){var a,s,o,l=e.samples,u=i.samples,d=this.typeSupported,h={},f=this._initPTS,c=!f||n,$="audio/mp4";if(c&&(a=s=1/0),e.config&&l.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":d.mpeg?($="audio/mpeg",e.codec=""):d.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}h.audio={id:"audio",container:$,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&d.mpeg?new Uint8Array(0):rt.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(o=e.inputTimeScale,f&&o===f.timescale?c=!1:a=s=l[0].pts-Math.round(o*r))}if(i.sps&&i.pps&&u.length){if(i.timescale=i.inputTimeScale,h.video={id:"main",container:"video/mp4",codec:i.codec,initSegment:rt.initSegment([i]),metadata:{width:i.width,height:i.height}},c){if(o=i.inputTimeScale,f&&o===f.timescale)c=!1;else{var g=this.getVideoStartPts(u),v=Math.round(o*r);s=Math.min(s,rs(u[0].dts,g)-v),a=Math.min(a,g-v)}}this.videoTrackConfig={width:i.width,height:i.height,pixelRatio:i.pixelRatio}}if(Object.keys(h).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:a,timescale:o},this._initDTS={baseTime:s,timescale:o}):a=o=void 0,{tracks:h,initPTS:a,timescale:o}},e.remuxVideo=function t(e,i,r,n){var a,s,l,u=e.inputTimeScale,d=e.samples,h=[],f=d.length,c=this._initPTS,$=this.nextAvcDts,g=8,v=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,y=!1;if(!r||null===$){var T=i*u,x=d[0].pts-rs(d[0].dts,d[0].pts);rr&&null!==$&&15e3>Math.abs(T-x-$)?r=!0:$=T-x}for(var E=c.baseTime*u/c.timescale,S=0;S<f;S++){var L=d[S];L.pts=rs(L.pts-E,$),L.dts=rs(L.dts-E,$),L.dts<d[S>0?S-1:S].dts&&(y=!0)}y&&d.sort(,a=d[0].dts;var R=(s=d[d.length-1].dts)-a,A=R?Math.round(R/(f-1)):v||e.inputTimeScale/30;if(r){var _=a-$,I=_>A,D=_<-1;if((I||D)&&(I?M.warn("AVC: "+ri(_,!0)+" ms ("+_+"dts) hole between fragments detected at "+i.toFixed(3)):M.warn("AVC: "+ri(-_,!0)+" ms ("+_+"dts) overlapping between fragments detected at "+i.toFixed(3)),!D||$>=d[0].pts||rr)){a=$;var k=d[0].pts-_;if(I)d[0].dts=a,d[0].pts=k;else for(var P=0;P<d.length&&!(d[P].dts>k);P++)d[P].dts-=_,d[P].pts-=_;M.log("Video: Initial PTS/DTS adjusted: "+ri(k,!0)+"/"+ri(a,!0)+", delta: "+ri(_,!0)+" ms")}}for(var F=0,O=0,N=a=Math.max(0,a),B=0;B<f;B++){for(var U=d[B],G=U.units,K=G.length,H=0,V=0;V<K;V++)H+=G[V].data.length;O+=H,F+=K,U.length=H,U.dts<N?(U.dts=N,N+=A/4|0||1):N=U.dts,m=Math.min(U.pts,m),p=Math.max(U.pts,p)}s=d[f-1].dts;var Y=O+4*F+8;try{l=new Uint8Array(Y)}catch(W){this.observer.emit(b.ERROR,b.ERROR,{type:C.MUX_ERROR,details:w.REMUX_ALLOC_ERROR,fatal:!1,error:W,bytes:Y,reason:"fail allocating video mdat "+Y});return}var q=new DataView(l.buffer);q.setUint32(0,Y),l.set(rt.types.mdat,4);for(var X=!1,z=Number.POSITIVE_INFINITY,j=Number.POSITIVE_INFINITY,Q=Number.NEGATIVE_INFINITY,Z=Number.NEGATIVE_INFINITY,J=0;J<f;J++){for(var tt=d[J],te=tt.units,ti=0,tr=0,tn=te.length;tr<tn;tr++){var ta=te[tr],ts=ta.data,to=ta.data.byteLength;q.setUint32(g,to),g+=4,l.set(ts,g),g+=to,ti+=4+to}var tl=void 0;if(J<f-1)v=d[J+1].dts-tt.dts,tl=d[J+1].pts-tt.pts;else{var tu=this.config,td=J>0?tt.dts-d[J-1].dts:A;if(tl=J>0?tt.pts-d[J-1].pts:A,tu.stretchShortVideoTrack&&null!==this.nextAudioPts){var th=Math.floor(tu.maxBufferHole*u),tf=(n?m+n*u:this.nextAudioPts)-tt.pts;tf>th?((v=tf-td)<0?v=td:X=!0,M.log("[mp4-remuxer]: It is approximately "+tf/90+" ms to the next segment; using duration "+v/90+" ms for the last video frame.")):v=td}else v=td}var tc=Math.round(tt.pts-tt.dts);z=Math.min(z,v),Q=Math.max(Q,v),j=Math.min(j,tl),Z=Math.max(Z,tl),h.push(new ru(tt.key,v,ti,tc))}if(h.length){if(rr){if(rr<70){var t$=h[0].flags;t$.dependsOn=2,t$.isNonSync=0}}else if(rn&&Z-j<Q-z&&A/Q<.025&&0===h[0].cts){M.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var tg=a,tv=0,tm=h.length;tv<tm;tv++){var tp=tg+h[tv].duration,ty=tg+h[tv].cts;if(tv<tm-1){var tT=tp+h[tv+1].cts;h[tv].duration=tT-ty}else h[tv].duration=tv?h[tv-1].duration:A;h[tv].cts=0,tg=tp}}}v=X||!v?A:v,this.nextAvcDts=$=s+v,this.videoSampleDuration=v,this.isVideoContiguous=!0;var tx,tE={data1:rt.moof(e.sequenceNumber++,a,o({},e,{samples:h})),data2:l,startPTS:m/u,endPTS:(p+v)/u,startDTS:a/u,endDTS:$/u,type:"video",hasAudio:!1,hasVideo:!0,nb:h.length,dropped:e.dropped};return e.samples=[],e.dropped=0,tE},e.getSamplesPerFrame=function t(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}},e.remuxAudio=function t(e,i,r,n,a){var s,l=e.inputTimeScale,u=e.samplerate?e.samplerate:l,d=l/u,h=this.getSamplesPerFrame(e),f=h*d,c=this._initPTS,$="mp3"===e.segmentCodec&&this.typeSupported.mpeg,g=[],v=void 0!==a,m=e.samples,p=$?0:8,y=this.nextAudioPts||-1,T=i*l,x=c.baseTime*l/c.timescale;if(this.isAudioContiguous=r=r||m.length&&y>0&&(n&&9e3>Math.abs(T-y)||Math.abs(rs(m[0].pts-x,T)-y)<20*f),m.forEach(,!r||y<0){if(!(m=m.filter().length)return;y=0===a?0:n&&!v?Math.max(0,T):m[0].pts}if("aac"===e.segmentCodec)for(var E=this.config.maxAudioFramesDrift,S=0,L=y;S<m.length;S++){var R=m[S],A=R.pts,_=A-L,I=Math.abs(1e3*_/l);if(_<=-E*f&&v)0===S&&(M.warn("Audio frame @ "+(A/l).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*_/l)+" ms."),this.nextAudioPts=y=L=A);else if(_>=E*f&&I<1e4&&v){var D=Math.round(_/f);(L=A-D*f)<0&&(D--,L+=f),0===S&&(this.nextAudioPts=y=L),M.warn("[mp4-remuxer]: Injecting "+D+" audio frame @ "+(L/l).toFixed(3)+"s due to "+Math.round(1e3*_/l)+" ms gap.");for(var k=0;k<D;k++){var P=Math.max(L,0),F=iJ.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);F||(M.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),F=R.unit.subarray()),m.splice(S,0,{unit:F,pts:P}),L+=f,S++}}R.pts=L,L+=f}for(var O=null,N=null,B=0,U=m.length;U--;)B+=m[U].unit.byteLength;for(var G=0,K=m.length;G<K;G++){var H=m[G],V=H.unit,Y=H.pts;if(null!==N)g[G-1].duration=Math.round((Y-N)/d);else{if(r&&"aac"===e.segmentCodec&&(Y=y),O=Y,!(B>0))return;B+=p;try{s=new Uint8Array(B)}catch(W){this.observer.emit(b.ERROR,b.ERROR,{type:C.MUX_ERROR,details:w.REMUX_ALLOC_ERROR,fatal:!1,error:W,bytes:B,reason:"fail allocating audio mdat "+B});return}!$&&(new DataView(s.buffer).setUint32(0,B),s.set(rt.types.mdat,4))}s.set(V,p);var q=V.byteLength;p+=q,g.push(new ru(!0,h,q,0)),N=Y}var X=g.length;if(X){var z=g[g.length-1];this.nextAudioPts=y=N+d*z.duration;var j=$?new Uint8Array(0):rt.moof(e.sequenceNumber++,O/d,o({},e,{samples:g}));e.samples=[];var Q=O/l,Z=y/l,J={data1:j,data2:s,startPTS:Q,endPTS:Z,startDTS:Q,endDTS:Z,type:"audio",hasAudio:!0,hasVideo:!1,nb:X};return this.isAudioContiguous=!0,J}},e.remuxEmptyAudio=function t(e,i,r,n){var a=e.inputTimeScale,s=e.samplerate?e.samplerate:a,o=this.nextAudioPts,l=this._initDTS,u=9e4*l.baseTime/l.timescale,d=(null!==o?o:n.startDTS*a)+u,h=n.endDTS*a+u,f=a/s*1024,c=Math.ceil((h-d)/f),$=iJ.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(M.warn("[mp4-remuxer]: remux empty Audio"),!$){M.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var g=[],v=0;v<c;v++){var m=d+v*f;g.push({unit:$,pts:m,dts:m})}return e.samples=g,this.remuxAudio(e,i,r,!1)},t}(); ru=function t(e,i,r,n){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=i,this.size=r,this.cts=n,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}},rd=function(){ar e=t.prototype;return e.destroy=e.resetTimeStamp=function t(e){this.initPTS=e,this.lastEndTime=null},e.resetNextTimestamp=e.resetInitSegment=function t(e,i,r,n){this.audioCodec=i,this.videoCodec=r,this.generateInitSegment(function t(e,i){if(!e||!i)return e;var r=i.keyId;return r&&i.isCommonEncryption&&tD(e,["moov","trak"]).forEach(,e}(e,n)),this.emitInitSegment=!0},e.generateInitSegment=function t(e){var i=this.audioCodec,r=this.videoCodec;if(!(null!=e&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}var n=this.initData=tb(e);n.audio&&(i=rh(n.audio,W.AUDIO)),n.video&&(r=rh(n.video,W.VIDEO));var a={};n.audio&&n.video?a.audiovideo={container:"video/mp4",codec:i+","+r,initSegment:e,id:"main"}:n.audio?a.audio={container:"audio/mp4",codec:i,initSegment:e,id:"audio"}:n.video?a.video={container:"video/mp4",codec:r,initSegment:e,id:"main"}:M.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a},e.remux=function t(e,i,r,n,a,s){var o,l,u=this.initPTS,d=this.lastEndTime,h={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};k(d)||(d=this.lastEndTime=a||0);var f=i.samples;if(!(null!=f&&f.length))return h;var c={initPTS:void 0,timescale:1},$=this.initData;if(null!=(o=$)&&o.length||(this.generateInitSegment(f),$=this.initData),!(null!=(l=$)&&l.length))return M.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),h;this.emitInitSegment&&(c.tracks=this.initTracks,this.emitInitSegment=!1);var g,v,m,p,y,T,x=function t(e,i){for(var r=0,n=0,a=0,s=tD(e,["moof","traf"]),o=0;o<s.length;o++){var l=s[o],u=tD(l,["tfhd"])[0],d=i[tA(u,4)];if(d){var h=d.default,f=tA(u,0)|(null==h?void 0:h.flags),c=null==h?void 0:h.duration;8&f&&(c=2&f?tA(u,12):tA(u,8));for(var $=d.timescale||9e4,g=tD(l,["trun"]),v=0;v<g.length;v++){if(!(r=tF(g[v]))&&c){var m=tA(g[v],4);r=c*m}d.type===W.VIDEO?n+=r/$:d.type===W.AUDIO&&(a+=r/$)}}}if(0===n&&0===a){for(var p=0,y=tD(e,["sidx"]),T=0;T<y.length;T++){var x=tk(y[T]);null!=x&&x.references&&(p+=x.references.reduce(0))}return p}return n||a}(f,$),E=(g=$,v=f,tD(v,["moof","traf"]).reduce(function(t,e){var i=tD(e,["tfdt"])[0],r=i[0],n=tD(e,["tfhd"]).reduce(function(t,e){var n=g[tA(e,4)];if(n){var a=tA(i,4);if(1===r){if(4294967295===a)return M.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;a*=4294967296,a+=tA(i,8)}var s=a/(n.timescale||9e4);if(isFinite(s)&&(null===t||s<t))return s}return t},null);return null!==n&&isFinite(n)&&(null===t||n<t)?n:t},null)),S=null===E?a:E;m=u,p=S,y=a,T=x,(null===m||Math.abs(p-m.baseTime/m.timescale-y)>Math.max(T,1)||c.timescale!==u.timescale&&s)&&(c.initPTS=S-a,u&&1===u.timescale&&M.warn("Adjusting initPTS by "+(c.initPTS-u.baseTime)),this.initPTS=u={baseTime:c.initPTS,timescale:1});var L=e?S-u.baseTime/u.timescale:d,R=L+x;(function t(e,i,r){tD(i,["moof","traf"]).forEach(function(t){tD(t,["tfhd"]).forEach(function(i){var n=e[tA(i,4)];if(n){var a=n.timescale||9e4;tD(t,["tfdt"]).forEach(function(t){var e=t[0],i=r*a;if(i){var n=tA(t,4);if(0===e)n-=i,n=Math.max(n,0),tI(t,4,n);else{n*=4294967296,n+=tA(t,8),n-=i;var s=Math.floor((n=Math.max(n,0))/4294967296),o=Math.floor(n%4294967296);tI(t,4,s),tI(t,8,o)}}})}})})})($,f,u.baseTime/u.timescale),x>0?this.lastEndTime=R:(M.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var A=!!$.audio,_=!!$.video,I="";A&&(I+="audio"),_&&(I+="video");var D={data1:f,startPTS:L,startDTS:L,endPTS:R,endDTS:R,type:I,hasAudio:A,hasVideo:_,nb:1,dropped:0};return h.audio="audio"===D.type?D:void 0,h.video="audio"!==D.type?D:void 0,h.initSegment=c,h.id3=ro(r,a,u,u),n.samples.length&&(h.text=rl(n,a,u)),h},t}();function rh(t,e){var i=null==t?void 0:t.codec;if(i&&i.length>4)return i;if(e===W.AUDIO){if("ec-3"===i||"ac-3"===i||"alac"===i)return i;if("fLaC"===i||"Opus"===i)return tz(i,!1);var r="mp4a.40.5";return M.info('Parsed audio codec "'+i+'" or audio object type not handled. Using "'+r+'"'),r}return(M.warn('Unhandled video codec "'+i+'"'),"hvc1"===i||"hev1"===i)?"hvc1.1.6.L120.90":"av01"===i?"av01.0.04M.08":"avc1.42e01e"}try{m=self.performance.now.bind(self.performance)}catch(rf){M.debug("Unable to use Performance API on this environment"),m="undefined"!=typeof self&&self.Date.now}var rc=[{demux:i4,remux:rd},{demux:iq,remux:ra},{demux:i6,remux:ra},{demux:iZ,remux:ra}];rc.splice(2,0,{demux:iH,remux:ra});var r$=function(){ar e=t.prototype;return e.configure=function t(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()},e.push=function t(e,i,r,n){var a=this,s=r.transmuxing;s.executeStart=m();var o,l,u,d=new Uint8Array(e),h=this.currentTransmuxState,f=this.transmuxConfig;n&&(this.currentTransmuxState=n);var c=n||h,$=c.contiguous,g=c.discontinuity,v=c.trackSwitch,p=c.accurateTimeOffset,y=c.timeOffset,T=c.initSegmentChange,x=f.audioCodec,E=f.videoCodec,S=f.defaultInitPts,L=f.duration,R=f.initSegmentData,A=(o=d,l=i,u=null,o.byteLength>0&&null!=l&&null!=l.key&&null!==l.iv&&null!=l.method&&(u=l),u);if(A&&"AES-128"===A.method){var _=this.getDecrypter();if(!_.isSync())return this.decryptionPromise=_.webCryptoDecrypt(d,A.key.buffer,A.iv.buffer).then(,this.decryptionPromise;var I=_.softwareDecrypt(d,A.key.buffer,A.iv.buffer);if(r.part>-1&&(I=_.flush()),!I)return s.executeEnd=m(),rg(r);d=new Uint8Array(I)}var D=this.needsProbing(g,v);if(D){var k=this.configureTransmuxer(d);if(k)return M.warn("[transmuxer] "+k.message),this.observer.emit(b.ERROR,b.ERROR,{type:C.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,error:k,reason:k.message}),s.executeEnd=m(),rg(r)}(g||v||T||D)&&this.resetInitSegment(R,x,E,L,i),(g||T||D)&&this.resetInitialTimestamp(S),$||this.resetContiguity();var P=this.transmux(d,A,y,p,r),F=this.currentTransmuxState;return F.contiguous=!0,F.discontinuity=!1,F.trackSwitch=!1,s.executeEnd=m(),P},e.flush=function t(e){var i=this,r=e.transmuxing;r.executeStart=m();var n=this.decrypter,a=this.currentTransmuxState,s=this.decryptionPromise;if(s)return s.then(;var o=[],l=a.timeOffset;if(n){var u=n.flush();u&&o.push(this.push(u,null,e))}var d=this.demuxer,h=this.remuxer;if(!d||!h)return r.executeEnd=m(),[rg(e)];var f=d.flush(l);return rv(f)?f.then(:(this.flushRemux(o,f,e),o)},e.flushRemux=function t(e,i,r){var n=i.audioTrack,a=i.videoTrack,s=i.id3Track,o=i.textTrack,l=this.currentTransmuxState,u=l.accurateTimeOffset,d=l.timeOffset;M.log("[transmuxer.ts]: Flushed fragment "+r.sn+(r.part>-1?" p: "+r.part:"")+" of level "+r.level);var h=this.remuxer.remux(n,a,s,o,d,u,!0,this.id);e.push({remuxResult:h,chunkMeta:r}),r.transmuxing.executeEnd=m()},e.resetInitialTimestamp=function t(e){var i=this.demuxer,r=this.remuxer;i&&r&&(i.resetTimeStamp(e),r.resetTimeStamp(e))},e.resetContiguity=function t(){var e=this.demuxer,i=this.remuxer;e&&i&&(e.resetContiguity(),i.resetNextTimestamp())},e.resetInitSegment=function t(e,i,r,n,a){var s=this.demuxer,o=this.remuxer;s&&o&&(s.resetInitSegment(e,i,r,n),o.resetInitSegment(e,i,r,a))},e.destroy=function t(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},e.transmux=function t(e,i,r,n,a){var s;return i&&"SAMPLE-AES"===i.method?this.transmuxSampleAes(e,i,r,n,a):this.transmuxUnencrypted(e,r,n,a)},e.transmuxUnencrypted=function t(e,i,r,n){var a=this.demuxer.demux(e,i,!1,!this.config.progressive),s=a.audioTrack,o=a.videoTrack,l=a.id3Track,u=a.textTrack;return{remuxResult:this.remuxer.remux(s,o,l,u,i,r,!1,this.id),chunkMeta:n}},e.transmuxSampleAes=function t(e,i,r,n,a){var s=this;return this.demuxer.demuxSampleAes(e,i,r).then(},e.configureTransmuxer=function t(e){for(var i,r,n=this.config,a=this.observer,s=this.typeSupported,o=this.vendor,l=0,u=rc.length;l<u;l++)if(null!=(r=rc[l].demux)&&r.probe(e)){i=rc[l];break}if(!i)return Error("Failed to find demuxer by probing fragment data");var d=this.demuxer,h=this.remuxer,f=i.remux,c=i.demux;h&&h instanceof f||(this.remuxer=new f(a,n,s,o)),d&&d instanceof c||(this.demuxer=new c(a,n,s),this.probe=c.probe)},e.needsProbing=e.getDecrypter=function t(){var e=this.decrypter;return e||(e=this.decrypter=new iT(this.config)),e},t}(),rg=ar rm,rp=function t(e,i,r,n,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=i,this.initSegmentData=r,this.duration=n,this.defaultInitPts=a||null},ry=rT={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,i="~";function r(){}ct.create&&(r.prototype=Object.create(null),new r().__proto__||(i=!1)),o.prototype.eventNames=o.prototype.listeners=function t(e){var r=i?i+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,s=n.length,o=Array(s);a<s;a++)o[a]=n[a].fn;return o},o.prototype.listenerCount=o.prototype.emit=function t(e,r,n,a,s,o){var l=i?i+e:e;if(!this._events[l])return!1;var u,d,h=this._events[l],f=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),f){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,r),!0;case 3:return h.fn.call(h.context,r,n),!0;case 4:return h.fn.call(h.context,r,n,a),!0;case 5:return h.fn.call(h.context,r,n,a,s),!0;case 6:return h.fn.call(h.context,r,n,a,s,o),!0}for(d=1,u=Array(f-1);d<f;d++)u[d-1]=arguments[d];h.fn.apply(h.context,u)}else{var c,$=h.length;for(d=0;d<$;d++)switch(h[d].once&&this.removeListener(e,h[d].fn,void 0,!0),f){case 1:h[d].fn.call(h[d].context);break;case 2:h[d].fn.call(h[d].context,r);break;case 3:h[d].fn.call(h[d].context,r,n);break;case 4:h[d].fn.call(h[d].context,r,n,a);break;default:if(!u)for(c=1,u=Array(f-1);c<f;c++)u[c-1]=arguments[c];h[d].fn.apply(h[d].context,u)}}return!0},o.prototype.on=function t(e,i,r){return a(this,e,i,r,!1)},o.prototype.once=o.prototype.removeListener=o.prototype.removeAllListeners=o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o}(rT);var rx=(rm=rT.exports)&&rm.__esModule&&Object.prototype.hasOwnProperty.call(rm,"default")?rm.default:rm;function rE(t,e){if(i=e.remuxResult,!i.audio&&!i.video&&!i.text&&!i.id3&&!i.initSegment)return!1;var i,r=[],n=e.remuxResult,a=n.audio,s=n.video;return a&&rS(r,a),s&&rS(r,s),t.postMessage({event:"transmuxComplete",data:e},r),!0}id 0!==e&&e&&function t(e){var i=new rx,r=i.on(b.FRAG_DECRYPTED,r),i.on(b.ERROR,r);var n=function t(){var e=function t(e){var i=M[e]=i};for(var i in M)e(i)};e.addEventListener("message",}(self);var rR=function(){function e(e,i,r,n){var a=this;this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var s=e.config;this.hls=e,this.id=i,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;var o=function t(e,i){(i=i||{}).frag=a.frag,i.id=a.id,e===b.ERROR&&(a.error=i.error),a.hls.trigger(e,i)};this.observer=new rx,this.observer.on(b.FRAG_DECRYPTED,o),this.observer.on(b.ERROR,o);var l=tH(s.preferManagedMediaSource)||{isTypeSupported:,u={mpeg:l.isTypeSupported("audio/mpeg"),mp3:l.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:l.isTypeSupported('audio/mp4; codecs="ac-3"')},d=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker&&(s.workerPath||"function"==typeof t)){try{s.workerPath?(M.log("loading Web Worker "+s.workerPath+' for "'+i+'"'),this.workerContext=(h=s.workerPath,f=new self.URL(h,self.location.href).href,{worker:new self.Worker(f),scriptURL:f})):(M.log('injecting Web Worker for "'+i+'"'),this.workerContext=(c=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;("+t.toString()+")(true);"],{type:"text/javascript"}),$=self.URL.createObjectURL(c),{worker:new self.Worker($),objectURL:$})),this.onwmsg=var h,f,c,$,g=this.workerContext.worker;g.addEventListener("message",this.onwmsg),g.onerror=function(t){var e=Error(t.message+"  ("+t.filename+":"+t.lineno+")");s.enableWorker=!1,M.warn('Error in "'+i+'" Web Worker, fallback to inline'),a.hls.trigger(b.ERROR,{type:C.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:e})},g.postMessage({cmd:"init",typeSupported:u,vendor:d,id:i,config:JSON.stringify(s)})}catch(v){M.warn('Error setting up "'+i+'" Web Worker, fallback to inline',v),this.resetWorker(),this.error=null,this.transmuxer=new r$(this.observer,u,s,d,i)}return}this.transmuxer=new r$(this.observer,u,s,d,i)}var i=e.prototype;return i.resetWorker=function t(){if(this.workerContext){var e=this.workerContext,i=e.worker,r=e.objectURL;r&&self.URL.revokeObjectURL(r),i.removeEventListener("message",this.onwmsg),i.onerror=null,i.terminate(),this.workerContext=null}},i.destroy=function t(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{var e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}var i=this.observer;i&&i.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},i.push=function t(e,i,r,n,a,s,o,l,u,d){var h,f,c=this;u.transmuxing.start=self.performance.now();var $=this.transmuxer,g=s?s.start:a.start,v=a.decryptdata,m=this.frag,p=!(m&&a.cc===m.cc),y=!(m&&u.level===m.level),T=m?u.sn-m.sn:-1,x=this.part?u.part-this.part.index:-1,E=0===T&&u.id>1&&u.id===(null==m?void 0:m.stats.chunkCount),S=!y&&(1===T||0===T&&(1===x||E&&x<=0)),L=self.performance.now();(y||T||0===a.stats.parsing.start)&&(a.stats.parsing.start=L),s&&(x||!S)&&(s.stats.parsing.start=L);var R=!(m&&(null==(h=a.initSegment)?void 0:h.url)===(null==(f=m.initSegment)?void 0:f.url)),A=new ry(p,S,l,y,g,R);if(!S||p||R){M.log("[transmuxer-interface, "+a.type+"]: Starting new transmux session for sn: "+u.sn+" p: "+u.part+" level: "+u.level+" id: "+u.id+"\n        discontinuity: "+p+"\n        trackSwitch: "+y+"\n        contiguous: "+S+"\n        accurateTimeOffset: "+l+"\n        timeOffset: "+g+"\n        initSegmentChange: "+R);var _=new rp(r,n,i,o,d);this.configureTransmuxer(_)}if(this.frag=a,this.part=s,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:v,chunkMeta:u,state:A},e instanceof ArrayBuffer?[e]:[]);else if($){var I=$.push(e,v,u,A);rv(I)?($.async=!0,I.then(function(t){c.handleTransmuxComplete(t)}).catch(function(t){c.transmuxerError(t,u,"transmuxer-interface push error")})):($.async=!1,this.handleTransmuxComplete(I))}},i.flush=function t(e){var i=this;e.transmuxing.start=self.performance.now();var r=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(r){var n=r.flush(e);rv(n)||r.async?(rv(n)||(n=Promise.resolve(n)),n.then(.catch():this.handleFlushResult(n,e)}},i.transmuxerError=function t(e,i,r){this.hls&&(this.error=e,this.hls.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,chunkMeta:i,fatal:!1,error:e,err:e,reason:r}))},i.handleFlushResult=function t(e,i){var r=this;e.forEach(,this.onFlush(i)},i.onWorkerMessage=function t(e){var i=e.data,r=this.hls;switch(i.event){case"init":var n,a=null==(n=this.workerContext)?void 0:n.objectURL;a&&self.URL.revokeObjectURL(a);break;case"transmuxComplete":this.handleTransmuxComplete(i.data);break;case"flush":this.onFlush(i.data);break;case"workerLog":M[i.data.logType]&&M[i.data.logType](i.data.message);break;default:i.data=i.data||{},i.data.frag=this.frag,i.data.id=this.id,r.trigger(i.event,i.data)}},i.configureTransmuxer=function t(e){var i=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):i&&i.configure(e)},i.handleTransmuxComplete=function t(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)},e}(),rA=function(t){function e(e,i,r){var n;return(n=t.call(this,e,i,r,"[audio-stream-controller]",ed.AUDIO)||this).videoBuffer=null,n.videoTrackCC=-1,n.waitingVideoCC=-1,n.bufferedTrack=null,n.switchingTrack=null,n.trackId=-1,n.waitingData=null,n.mainDetails=null,n.bufferFlushed=!1,n.cachedTrackLoadedData=null,n._registerListeners(),n}l(e,t);var i=e.prototype;return i.onHandlerDestroying=function t(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null},i._registerListeners=function t(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.ERROR,this.onError,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)},i._unregisterListeners=function t(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.ERROR,this.onError,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this)},i.onInitPtsFound=function t(e,i){var r=i.frag,n=i.id,a=i.initPTS,s=i.timescale;if("main"===n){var o=r.cc;this.initPTS[r.cc]={baseTime:a,timescale:s},this.log("InitPTS for cc: "+o+" found from main: "+a),this.videoTrackCC=o,this.state===iE.WAITING_INIT_PTS&&this.tick()}},i.startLoad=function t(e){if(!this.levels){this.startPosition=e,this.state=iE.STOPPED;return}var i=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),i>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+i.toFixed(3)),e=i,this.state=iE.IDLE):(this.loadedmetadata=!1,this.state=iE.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},i.doTick=function e(){switch(this.state){case iE.IDLE:this.doTickIdle();break;case iE.WAITING_TRACK:var i,r=this.levels,n=this.trackId,a=null==r?void 0:null==(i=r[n])?void 0:i.details;if(a){if(this.waitForCdnTuneIn(a))break;this.state=iE.WAITING_INIT_PTS}break;case iE.FRAG_LOADING_WAITING_RETRY:var s,o=performance.now(),l=this.retryDate;(!l||o>=l||null!=(s=this.media)&&s.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=iE.IDLE);break;case iE.WAITING_INIT_PTS:var u=this.waitingData;if(u){var d=u.frag,h=u.part,f=u.cache,c=u.complete;if(void 0!==this.initPTS[d.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=iE.FRAG_LOADING;var $={frag:d,part:h,payload:f.flush(),networkDetails:null};this._handleFragmentLoadProgress($),c&&t.prototype._handleFragmentLoadComplete.call(this,$)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+d.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var g=this.getLoadPosition(),v=ia.bufferInfo(this.mediaBuffer,g,this.config.maxBufferHole);0>e1(v.end,this.config.maxFragLookUpTolerance,d)&&(this.log("Waiting fragment cc ("+d.cc+") @ "+d.start+" cancelled because another fragment at "+v.end+" is needed"),this.clearWaitingFragment())}}else this.state=iE.IDLE}this.onTickEnd()},i.clearWaitingFragment=function t(){var e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=iE.IDLE)},i.resetLoadingState=i.onTickEnd=function t(){var e=this.media;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)},i.doTickIdle=function t(){var e=this.hls,i=this.levels,r=this.media,n=this.trackId,a=e.config;if(null!=i&&i[n]&&(r||!this.startFragRequested&&a.startFragPrefetch)){var s=i[n],o=s.details;if(!o||o.live&&this.levelLastLoaded!==n||this.waitForCdnTuneIn(o)){this.state=iE.WAITING_TRACK;return}var l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,W.AUDIO,ed.AUDIO));var u=this.getFwdBufferInfo(l,ed.AUDIO);if(null!==u){var d=this.bufferedTrack,h=this.switchingTrack;if(!h&&this._streamEnded(u,o)){e.trigger(b.BUFFER_EOS,{type:"audio"}),this.state=iE.ENDED;return}var f=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,ed.MAIN),c=u.len,$=this.getMaxBufferLength(null==f?void 0:f.len),g=o.fragments,v=g[0].start,m=u.end;if(h&&r){var p=this.getLoadPosition();d&&h.attrs!==d.attrs&&(m=p),o.PTSKnown&&p<v&&(u.end>v||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=v+.05)}if(!(c>=$)||h||!(m<g[g.length-1].start)){var y=this.getNextFragment(m,o),T=!1;if(y&&this.isLoopLoading(y,m)&&(T=!!y.gap,y=this.getNextFragmentLoopLoading(y,o,u,ed.MAIN,$)),!y){this.bufferFlushed=!0;return}var x=f&&y.start>f.end+o.targetduration;if(x||!(null!=f&&f.len)&&u.len){var E=this.getAppendedFrag(y.start,ed.MAIN);if(null===E||(T||(T=!!E.gap||!!x&&0===f.len),x&&!T||T&&u.nextStart&&u.nextStart<E.end))return}this.loadFragment(y,s,m)}}}},i.getMaxBufferLength=function e(i){var r=t.prototype.getMaxBufferLength.call(this);return i?Math.min(Math.max(r,i),this.config.maxMaxBufferLength):r},i.onMediaDetaching=i.onAudioTracksUpdated=function t(e,i){var r=i.audioTracks;this.resetTransmuxer(),this.levels=r.map(},i.onAudioTrackSwitching=function t(e,i){var r=!!i.url;this.trackId=i.id;var n=this.fragCurrent;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?this.setInterval(100):this.resetTransmuxer(),r?(this.switchingTrack=i,this.state=iE.IDLE,this.flushAudioIfNeeded(i)):(this.switchingTrack=null,this.bufferedTrack=i,this.state=iE.STOPPED),this.tick()},i.onManifestLoading=function t(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1},i.onLevelLoaded=function t(e,i){this.mainDetails=i.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(b.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},i.onAudioTrackLoaded=function t(e,i){if(null==this.mainDetails){this.cachedTrackLoadedData=i;return}var r,n=this.levels,a=i.details,s=i.id;if(!n){this.warn("Audio tracks were reset while loading level "+s);return}this.log("Track "+s+" loaded ["+a.startSN+","+a.endSN+"]"+(a.lastPartSn?"[part-"+a.lastPartSn+"-"+a.lastPartIndex+"]":"")+",duration:"+a.totalduration);var o=n[s],l=0;if(a.live||null!=(r=o.details)&&r.live){this.checkLiveUpdate(a);var u=this.mainDetails;if(a.deltaUpdateFailed||!u)return;!o.details&&a.hasProgramDateTime&&u.hasProgramDateTime?(ih(a,u),l=a.fragments[0].start):l=this.alignPlaylists(a,o.details)}o.details=a,this.levelLastLoaded=s,this.startFragRequested||!this.mainDetails&&a.live||this.setStartPosition(o.details,l),this.state!==iE.WAITING_TRACK||this.waitForCdnTuneIn(a)||(this.state=iE.IDLE),this.tick()},i._handleFragmentLoadProgress=function t(e){var i,r=e.frag,n=e.part,a=e.payload,s=this.config,o=this.trackId,l=this.levels;if(!l){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered");return}var u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}var d=u.details;if(!d){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}var h=s.defaultAudioCodec||u.audioCodec||"mp4a.40.2",f=this.transmuxer;f||(f=this.transmuxer=new rR(this.hls,ed.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var c=this.initPTS[r.cc],$=null==(i=r.initSegment)?void 0:i.data;if(void 0!==c){var g=n?n.index:-1,v=new is(r.level,r.sn,r.stats.chunkCount,a.byteLength,g,-1!==g);f.push(a,$,h,"",r,n,d.totalduration,!1,v,c)}else this.log("Unknown video PTS for cc "+r.cc+", waiting for video PTS before demuxing audio frag "+r.sn+" of ["+d.startSN+" ,"+d.endSN+"],track "+o),(this.waitingData=this.waitingData||{frag:r,part:n,cache:new iL,complete:!1}).cache.push(new Uint8Array(a)),this.waitingVideoCC=this.videoTrackCC,this.state=iE.WAITING_INIT_PTS},i._handleFragmentLoadComplete=function e(i){if(this.waitingData){this.waitingData.complete=!0;return}t.prototype._handleFragmentLoadComplete.call(this,i)},i.onBufferReset=function t(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},i.onBufferCreated=function t(e,i){var r=i.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),i.tracks.video&&(this.videoBuffer=i.tracks.video.buffer||null)},i.onFragBuffered=function t(e,i){var n=i.frag,a=i.part;if(n.type!==ed.AUDIO){if(!this.loadedmetadata&&n.type===ed.MAIN){var s=this.videoBuffer||this.media;s&&ia.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn("Fragment "+n.sn+(a?" p: "+a.index:"")+" of level "+n.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+(this.switchingTrack?this.switchingTrack.name:"false"));return}if("initSegment"!==n.sn){this.fragPrevious=n;var o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(b.AUDIO_TRACK_SWITCHED,r({},o)))}this.fragBufferedComplete(n,a)},i.onError=function e(i,r){var n;if(r.fatal){this.state=iE.ERROR;return}switch(r.details){case w.FRAG_GAP:case w.FRAG_PARSING_ERROR:case w.FRAG_DECRYPT_ERROR:case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ed.AUDIO,r);break;case w.AUDIO_TRACK_LOAD_ERROR:case w.AUDIO_TRACK_LOAD_TIMEOUT:case w.LEVEL_PARSING_ERROR:r.levelRetry||this.state!==iE.WAITING_TRACK||(null==(n=r.context)?void 0:n.type)!==eu.AUDIO_TRACK||(this.state=iE.IDLE);break;case w.BUFFER_APPEND_ERROR:case w.BUFFER_FULL_ERROR:if(!r.parent||"audio"!==r.parent)return;if(r.details===w.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(r)&&(this.bufferedTrack=null,t.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"));break;case w.INTERNAL_EXCEPTION:this.recoverWorkerError(r)}},i.onBufferFlushed=function t(e,i){var r=i.type;if(r===W.AUDIO){this.bufferFlushed=!0,this.state===iE.ENDED&&(this.state=iE.IDLE);var n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,r,ed.AUDIO),this.tick())}},i._handleTransmuxComplete=function t(e){var i,r="audio",n=this.hls,a=e.remuxResult,s=e.chunkMeta,l=this.getCurrentContext(s);if(!l){this.resetWhenMissingContext(s);return}var u=l.frag,d=l.part,h=l.level,f=h.details,c=a.audio,$=a.text,g=a.id3,v=a.initSegment;if(this.fragContextChanged(u)||!f){this.fragmentTracker.removeFragment(u);return}if(this.state=iE.PARSING,this.switchingTrack&&c&&this.completeAudioSwitch(this.switchingTrack),null!=v&&v.tracks){var m=u.initSegment||u;this._bufferInitSegment(h,v.tracks,m,s),n.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:r,tracks:v.tracks})}if(c){var p=c.startPTS,y=c.endPTS,T=c.startDTS,x=c.endDTS;d&&(d.elementaryStreams[W.AUDIO]={startPTS:p,endPTS:y,startDTS:T,endDTS:x}),u.setElementaryStreamInfo(W.AUDIO,p,y,T,x),this.bufferFragmentData(c,u,d,s)}if(null!=g&&null!=(i=g.samples)&&i.length){var E=o({id:r,frag:u,details:f},g);n.trigger(b.FRAG_PARSING_METADATA,E)}if($){var S=o({id:r,frag:u,details:f},$);n.trigger(b.FRAG_PARSING_USERDATA,S)}},i._bufferInitSegment=function t(e,i,r,n){if(this.state===iE.PARSING){i.video&&delete i.video;var a=i.audio;if(a){a.id="audio";var s=e.audioCodec;this.log("Init audio buffer, container:"+a.container+", codecs[level/parsed]=["+s+"/"+a.codec+"]"),s&&1===s.split(",").length&&(a.levelCodec=s),this.hls.trigger(b.BUFFER_CODECS,i);var o=a.initSegment;if(null!=o&&o.byteLength){var l={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:o};this.hls.trigger(b.BUFFER_APPENDING,l)}this.tickImmediate()}}},i.loadFragment=function e(i,r,n){var a,s=this.fragmentTracker.getState(i);if(this.fragCurrent=i,this.switchingTrack||s===eJ.NOT_LOADED||s===eJ.PARTIAL){if("initSegment"===i.sn)this._loadInitSegment(i,r);else if(null!=(a=r.details)&&a.live&&!this.initPTS[i.cc]){this.log("Waiting for video PTS in continuity counter "+i.cc+" of live stream before loading audio fragment "+i.sn+" of level "+this.trackId),this.state=iE.WAITING_INIT_PTS;var o=this.mainDetails;o&&o.fragments[0].start!==r.details.fragments[0].start&&ih(r.details,o)}else this.startFragRequested=!0,t.prototype.loadFragment.call(this,i,r,n)}else this.clearTrackerIfNeeded(i)},i.flushAudioIfNeeded=function e(i){var r=this.media,n=this.bufferedTrack,a=null==n?void 0:n.attrs,s=i.attrs;r&&a&&(a.CHANNELS!==s.CHANNELS||n.name!==i.name||n.lang!==i.lang)&&(this.log("Switching audio track : flushing all audio"),t.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)},i.completeAudioSwitch=function t(e){var i=this.hls;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,i.trigger(b.AUDIO_TRACK_SWITCHED,r({},e))},e}(iS),r_=function(t){(e,t);var i=e.prototype;return i.registerListeners=function t(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.ERROR,this.onError,this)},i.unregisterListeners=function t(){var e=this.hls;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.ERROR,this.onError,this)},i.destroy=function e(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,t.prototype.destroy.call(this)},i.onManifestLoading=function t(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0},i.onManifestParsed=i.onAudioTrackLoaded=function t(e,i){var r=i.id,n=i.groupId,a=i.details,s=this.tracksInGroup[r];if(!s||s.groupId!==n){this.warn("Track with id:"+r+" and group:"+n+" not found in active group "+s.groupId);return}var o=s.details;s.details=i.details,this.log("audio-track "+r+' "'+s.name+'" lang:'+s.lang+" group:"+n+" loaded ["+a.startSN+"-"+a.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,i,o)},i.onLevelLoading=function t(e,i){this.switchLevel(i.level)},i.onLevelSwitching=i.switchLevel=function t(e){var i=this.hls.levels[e];if(null!=i&&i.audioGroupIds){var r=i.audioGroupIds[i.urlId];if(this.groupId!==r){this.groupId=r||null;var n=this.tracks.filter(;this.selectDefaultTrack&&!n.some(&&(this.selectDefaultTrack=!1),this.tracksInGroup=n,this.log("Updating audio tracks, "+n.length+" track(s) found in group:"+r),this.hls.trigger(b.AUDIO_TRACKS_UPDATED,{audioTracks:n}),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}},i.onError=function t(e,i){!i.fatal&&i.context&&i.context.type===eu.AUDIO_TRACK&&i.context.id===this.trackId&&i.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(i))},i.setAudioTrack=function t(e){var i=this.tracksInGroup;if(e<0||e>=i.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var n=this.currentTrack;i[this.trackId];var a=i[e],s=a.groupId,o=a.name;if(this.log("Switching to audio-track "+e+' "'+o+'" lang:'+a.lang+" group:"+s),this.trackId=e,this.currentTrack=a,this.selectDefaultTrack=!1,this.hls.trigger(b.AUDIO_TRACK_SWITCHING,r({},a)),!a.details||a.details.live){var l=this.switchParams(a.url,null==n?void 0:n.details);this.loadPlaylist(l)}},i.selectInitialTrack=function t(){var e=this.tracksInGroup,i=this.findTrackId(this.currentTrack);if(-1===i&&(i=this.findTrackId(null)),-1!==i)this.setAudioTrack(i);else{var r=Error("No track found for running audio group-ID: "+this.groupId+" track count: "+e.length);this.warn(r.message),this.hls.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:r})}},i.findTrackId=function t(e){for(var i=this.tracksInGroup,r=0;r<i.length;r++){var n=i[r];if((!this.selectDefaultTrack||n.default)&&(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===n.attrs["STABLE-RENDITION-ID"]||e.name===n.name&&e.lang===n.lang))return n.id}return -1},i.loadPlaylist=function e(i){t.prototype.loadPlaylist.call(this);var r=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(r)){var n=r.id,a=r.groupId,s=r.url;if(i)try{s=i.addDirectives(s)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("loading audio-track playlist "+n+' "'+r.name+'" lang:'+r.lang+" group:"+a),this.clearTimer(),this.hls.trigger(b.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:a,deliveryDirectives:i||null})}},a(e,[{key:"allAudioTracks",get:function t(){return this.tracks}},{key:"audioTracks",get:function t(){return this.tracksInGroup}},{key:"audioTrack",get:function t(){return this.trackId},set:]),e}(eH);r rk=function(t){function e(e,i,r){var n;return(n=t.call(this,e,i,r,"[subtitle-stream-controller]",ed.SUBTITLE)||this).levels=[],n.currentTrackId=-1,n.tracksBuffered=[],n.mainDetails=null,n._registerListeners(),n}l(e,t);var i=e.prototype;return i.onHandlerDestroying=i._registerListeners=function t(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.ERROR,this.onError,this),e.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)},i._unregisterListeners=function t(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.ERROR,this.onError,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this)},i.startLoad=function t(e){this.stopLoad(),this.state=iE.IDLE,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},i.onManifestLoading=function t(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},i.onMediaDetaching=function e(){this.tracksBuffered=[],t.prototype.onMediaDetaching.call(this)},i.onLevelLoaded=function t(e,i){this.mainDetails=i.details},i.onSubtitleFragProcessed=function t(e,i){var r,n=i.frag,a=i.success;if(this.fragPrevious=n,this.state=iE.IDLE,a){var s=this.tracksBuffered[this.currentTrackId];if(s){for(var o=n.start,l=0;l<s.length;l++)if(o>=s[l].start&&o<=s[l].end){r=s[l];break}var u=n.start+n.duration;r?r.end=u:(r={start:o,end:u},s.push(r)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}}},i.onBufferFlushing=function t(e,i){var r=i.startOffset,n=i.endOffset;if(0===r&&n!==Number.POSITIVE_INFINITY){var a=n-1;if(a<=0)return;i.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(,this.fragmentTracker.removeFragmentsInRange(r,a,ed.SUBTITLE)}},i.onFragBuffered=function t(e,i){if(!this.loadedmetadata&&i.frag.type===ed.MAIN){var r;null!=(r=this.media)&&r.buffered.length&&(this.loadedmetadata=!0)}},i.onError=function t(e,i){var r=i.frag;(null==r?void 0:r.type)===ed.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==iE.STOPPED&&(this.state=iE.IDLE))},i.onSubtitleTracksUpdated=function t(e,i){var r=this,n=i.subtitleTracks;if(rI(this.levels,n)){this.levels=n.map(function(t){return new eD(t)});return}this.tracksBuffered=[],this.levels=n.map(,this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ed.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null},i.onSubtitleTrackSwitch=function t(e,i){if(this.currentTrackId=i.id,!this.levels.length||-1===this.currentTrackId){this.clearInterval();return}var r=this.levels[this.currentTrackId];null!=r&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(500)},i.onSubtitleTrackLoaded=function t(e,i){var r,n=i.details,a=i.id,s=this.currentTrackId,o=this.levels;if(o.length){var l=o[s];if(!(a>=o.length)&&a===s&&l){this.mediaBuffer=this.mediaBufferTimeRanges;var u=0;if(n.live||null!=(r=l.details)&&r.live){var d=this.mainDetails;if(n.deltaUpdateFailed||!d)return;var h=d.fragments[0];l.details?0===(u=this.alignPlaylists(n,l.details))&&h&&ew(n,u=h.start):n.hasProgramDateTime&&d.hasProgramDateTime?(ih(n,d),u=n.fragments[0].start):h&&ew(n,u=h.start)}l.details=n,this.levelLastLoaded=a,this.startFragRequested||!this.mainDetails&&n.live||this.setStartPosition(l.details,u),this.tick(),n.live&&!this.fragCurrent&&this.media&&this.state===iE.IDLE&&(eG(null,n.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0))}}},i._handleFragmentLoadComplete=function t(e){var i=this,r=e.frag,n=e.payload,a=r.decryptdata,s=this.hls;if(!this.fragContextChanged(r)&&n&&n.byteLength>0&&a&&a.key&&a.iv&&"AES-128"===a.method){var o=performance.now();this.decrypter.decrypt(new Uint8Array(n),a.key.buffer,a.iv.buffer).catch(.then(.catch(}},i.doTick=function t(){if(!this.media){this.state=iE.IDLE;return}if(this.state===iE.IDLE){var e=this.currentTrackId,i=this.levels,r=i[e];if(!i.length||!r||!r.details)return;var n=this.config,a=this.getLoadPosition(),s=ia.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,n.maxBufferHole),o=s.end,l=s.len,u=this.getFwdBufferInfo(this.media,ed.MAIN),d=r.details;if(l>this.getMaxBufferLength(null==u?void 0:u.len)+d.levelTargetDuration)return;var h=d.fragments,f=h.length,c=d.edge,$=null,g=this.fragPrevious;if(o<c){var v=n.maxFragLookUpTolerance;($=eG(g,h,Math.max(h[0].start,o),o>c-v?0:v))||!g||!(g.start<h[0].start)||($=h[0])}else $=h[f-1];if(!$)return;if("initSegment"!==($=this.mapToInitFragWhenRequired($)).sn){var m=h[$.sn-d.startSN-1];m&&m.cc===$.cc&&this.fragmentTracker.getState(m)===eJ.NOT_LOADED&&($=m)}this.fragmentTracker.getState($)===eJ.NOT_LOADED&&this.loadFragment($,r,o)}},i.getMaxBufferLength=function e(i){var r=t.prototype.getMaxBufferLength.call(this);return i?Math.max(r,i):r},i.loadFragment=function e(i,r,n){this.fragCurrent=i,"initSegment"===i.sn?this._loadInitSegment(i,r):(this.startFragRequested=!0,t.prototype.loadFragment.call(this,i,r,n))},a(e,[{key:"mediaBufferTimeRanges",get:function t(){return new rb(this.tracksBuffered[this.currentTrackId]||[])}}]),e}(iS),rb=function t(e){this.buffered=void 0;var i=function t(i,r,n){if((r>>>=0)>n-1)throw new DOMException("Failed to execute '"+i+"' on 'TimeRanges': The index provided ("+r+") is greater than the maximum bound ("+n+")");return e[r][i]};this.buffered={get lengthend:function t(r){return i("end",r,e.length)},start:function t(r){return i("start",r,e.length)}}},rC=function(t){(e,t);var i=e.prototype;return i.destroy=function e(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,t.prototype.destroy.call(this)},i.registerListeners=function t(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.ERROR,this.onError,this)},i.unregisterListeners=function t(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.ERROR,this.onError,this)},i.onMediaAttached=function t(e,i){this.media=i.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},i.pollTrackChange=function t(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)},i.onMediaDetaching=function t(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),r8(this.media.textTracks).forEach(,this.subtitleTrack=-1,this.media=null)},i.onManifestLoading=function t(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},i.onManifestParsed=i.onSubtitleTrackLoaded=function t(e,i){var r=i.id,n=i.details,a=this.trackId,s=this.tracksInGroup[a];if(!s){this.warn("Invalid subtitle track id "+r);return}var o=s.details;s.details=i.details,this.log("subtitle track "+r+" loaded ["+n.startSN+"-"+n.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,i,o)},i.onLevelLoading=function t(e,i){this.switchLevel(i.level)},i.onLevelSwitching=function t(e,i){this.switchLevel(i.level)},i.switchLevel=function t(e){var i=this.hls.levels[e];if(null!=i&&i.textGroupIds){var r=i.textGroupIds[i.urlId],n=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==r){var a=this.tracks.filter(function(t){return!r||t.groupId===r});this.tracksInGroup=a;var s=this.findTrackId(null==n?void 0:n.name)||this.findTrackId();this.groupId=r||null,this.log("Updating subtitle tracks, "+a.length+' track(s) found in "'+r+'" group-id'),this.hls.trigger(b.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:a}),-1!==s&&this.setSubtitleTrack(s,n)}else this.shouldReloadPlaylist(n)&&this.setSubtitleTrack(this.trackId,n)}},i.findTrackId=function t(e){for(var i=this.tracksInGroup,r=0;r<i.length;r++){var n=i[r];if((!this.selectDefaultTrack||n.default)&&(!e||e===n.name))return n.id}return -1},i.onError=function t(e,i){!i.fatal&&i.context&&i.context.type===eu.SUBTITLE_TRACK&&i.context.id===this.trackId&&i.context.groupId===this.groupId&&this.checkRetry(i)},i.loadPlaylist=function e(i){t.prototype.loadPlaylist.call(this);var r=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(r)){var n=r.id,a=r.groupId,s=r.url;if(i)try{s=i.addDirectives(s)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("Loading subtitle playlist for id "+n),this.hls.trigger(b.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:a,deliveryDirectives:i||null})}},i.toggleTrackModes=function t(e){var i=this,r=this.media,n=this.trackId;if(r){var a=r8(r.textTracks),s=a.filter(;if(-1===e)[].slice.call(a).forEach(;else{var o=s[n];o&&(o.mode="disabled")}var l=s[e];l&&(l.mode=this.subtitleDisplay?"showing":"hidden")}},i.setSubtitleTrack=function t(e,i){var r,n=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),(this.trackId!==e||-1!==e&&(null==(r=n[e])||!r.details))&&!(e<-1)&&!(e>=n.length)){this.clearTimer();var a=n[e];if(this.log("Switching to subtitle-track "+e+(a?' "'+a.name+'" lang:'+a.lang+" group:"+a.groupId:"")),this.trackId=e,a){var s=a.id,o=a.groupId,l=a.name,u=a.type,d=a.url;this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:s,groupId:void 0===o?"":o,name:l,type:u,url:d});var h=this.switchParams(a.url,null==i?void 0:i.details);this.loadPlaylist(h)}else this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:e})}},i.onTextTracksChanged=function t(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,i=r8(this.media.textTracks),r=0;r<i.length;r++)if("hidden"===i[r].mode)e=r;else if("showing"===i[r].mode){e=r;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},a(e,[{key:"subtitleDisplay",get:function t(){return this._subtitleDisplay},set:function t(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"allSubtitleTracks",get:function t(){return this.tracks}},{key:"subtitleTracks",get:function t(){return this.tracksInGroup}},{key:"subtitleTrack",get:function t(){return this.trackId},set:]),e}(eH);ar rw=function(){ar e=t.prototype;return e.append=function t(e,i,r){var n=this.queues[i];n.push(e),1!==n.length||r||this.executeNext(i)},e.insertAbort=function t(e,i){this.queues[i].unshift(e),this.executeNext(i)},e.appendBlocker=function t(e){var i,r=new Promise(,n={execute:i,onStart:function t(){},onComplete:function t(){},onError:function t(){}};return this.append(n,e),r},e.executeNext=function t(e){var i=this.queues[e];if(i.length){var r=i[0];try{r.execute()}catch(n){M.warn('[buffer-operation-queue]: Exception executing "'+e+'" SourceBuffer operation: '+n),r.onError(n);var a=this.buffers[e];null!=a&&a.updating||this.shiftAndExecuteNext(e)}}},e.shiftAndExecuteNext=function t(e){this.queues[e].shift(),this.executeNext(e)},e.current=t}(),rP=function(){ar e=t.prototype;return e.setStreamController=function t(e){this.streamController=e},e.destroy=function t(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},e.registerListeners=function t(){var e=this.hls;e.on(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this)},e.unregisterListener=function t(){var e=this.hls;e.off(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this)},e.onFpsDropLevelCapping=function t(e,i){var r=this.hls.levels[i.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})},e.onMediaAttaching=function t(e,i){this.media=i.media instanceof HTMLVideoElement?i.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()},e.onManifestParsed=function t(e,i){var r=this.hls;this.restrictedLevels=[],this.firstLevel=i.firstLevel,r.config.capLevelToPlayerSize&&i.video&&this.startCapping()},e.onLevelsUpdated=function t(e,i){this.timer&&k(this.autoLevelCapping)&&this.detectPlayerSize()},e.onBufferCodecs=function t(e,i){this.hls.config.capLevelToPlayerSize&&i.video&&this.startCapping()},e.onMediaDetaching=function t(){this.stopCapping()},e.detectPlayerSize=function t(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}var e=this.hls.levels;if(e.length){var i=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&M.log("Setting autoLevelCapping to "+r+": "+e[r].height+"p@"+e[r].bitrate+" for media "+this.mediaWidth+"x"+this.mediaHeight),i.autoLevelCapping=r,i.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=i.autoLevelCapping}}},e.getMaxLevel=function e(i){var r=this,n=this.hls.levels;if(!n.length)return -1;var a=n.filter(;return this.clientRect=null,t.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)},e.startCapping=function t(){!this.timer&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},e.stopCapping=function t(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},e.getDimensions=function t(){if(this.clientRect)return this.clientRect;var e=this.media,i={width:0,height:0};if(e){var r=e.getBoundingClientRect();i.width=r.width,i.height=r.height,i.width||i.height||(i.width=r.right-r.left||e.width||0,i.height=r.bottom-r.top||e.height||0)}return this.clientRect=i,i},e.isLevelAllowed=function t(e){return!this.restrictedLevels.some(},t.getMaxLevelByMediaSize=function t(e,i,r){if(!(null!=e&&e.length))return -1;for(var n=e.length-1,a=Math.max(i,r),s=0;s<e.length;s+=1){var o,l,u=e[s];if((u.width>=a||u.height>=a)&&(o=u,!(l=e[s+1])||o.width!==l.width||o.height!==l.height)){n=s;break}}return n},a(t,[{key:"mediaWidth",get:function t(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function t(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function t(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(i){}return e}}]),t}(),rF=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,rO=function(){function t(t){var e=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=this._onStartStreaming=function(t){var i=e.hls,r=e.mediaSource;i&&r&&("quality"in r&&("low"===r.quality?i.autoLevelCapping=rP.getMaxLevelByMediaSize(i.levels,1280,720):"medium"===r.quality?i.autoLevelCapping=rP.getMaxLevelByMediaSize(i.levels,1920,1080):i.autoLevelCapping=-1),i.resumeBuffering())},this._onMediaSourceOpen=this._onMediaSourceClose=function(){e.log("Media source closed")},this._onMediaSourceEnded=this._onMediaEmptied=this.hls=t;var i="[buffer-controller]";this.appendSource=t.config.preferManagedMediaSource,this.log=M.log.bind(M,i),this.warn=M.warn.bind(M,i),this.error=M.error.bind(M,i),this._initSourceBuffer(),this.registerListeners()}var e=t.prototype;return e.hasSourceTypes=function t(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},e.destroy=function t(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},e.registerListeners=function t(){var e=this.hls;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_APPENDING,this.onBufferAppending,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.BUFFER_EOS,this.onBufferEos,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.FRAG_PARSED,this.onFragParsed,this),e.on(b.FRAG_CHANGED,this.onFragChanged,this)},e.unregisterListeners=function t(){var e=this.hls;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_APPENDING,this.onBufferAppending,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.BUFFER_EOS,this.onBufferEos,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.FRAG_PARSED,this.onFragParsed,this),e.off(b.FRAG_CHANGED,this.onFragChanged,this)},e._initSourceBuffer=function t(){this.sourceBuffer={},this.operationQueue=new rw(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null},e.onManifestLoading=e.onManifestParsed=function t(e,i){var r=2;(!i.audio||i.video)&&i.altAudio||(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,this.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},e.onMediaAttaching=function t(e,i){var r=this.media=i.media,n=tH(this.appendSource);if(r&&n){var a,s,o,l,u=this.mediaSource=new n;this.log("created media source: "+(null==(l=u.constructor)?void 0:l.name)),u.addEventListener("sourceopen",this._onMediaSourceOpen),u.addEventListener("sourceended",this._onMediaSourceEnded),u.addEventListener("sourceclose",this._onMediaSourceClose),u.addEventListener("startstreaming",this._onStartStreaming),u.addEventListener("endstreaming",this._onEndStreaming);var d=this._objectUrl=self.URL.createObjectURL(u);if(this.appendSource)try{r.removeAttribute("src"),r.disableRemotePlayback=r.disableRemotePlayback||u instanceof self.ManagedMediaSource,rN(r),a=r,s=d,(o=self.document.createElement("source")).type="video/mp4",o.src=s,a.appendChild(o),r.load()}catch(h){r.src=d}else r.src=d;r.addEventListener("emptied",this._onMediaEmptied)}},e.onMediaDetaching=function t(){var e=this.media,i=this.mediaSource,r=this._objectUrl;if(i){if(this.log("media source detaching"),"open"===i.readyState)try{i.endOfStream()}catch(n){this.warn("onMediaDetaching: "+n.message+" while calling endOfStream")}this.onBufferReset(),i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming),e&&(e.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),this.mediaSrc===r?(e.removeAttribute("src"),this.appendSource&&rN(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(b.MEDIA_DETACHED,void 0)},e.onBufferReset=function t(){var e=this;this.getSourceBufferTypes().forEach(function(t){e.resetBuffer(t)}),this._initSourceBuffer()},e.resetBuffer=function t(e){var i,r=this.sourceBuffer[e];try{r&&(this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,null!=(i=this.mediaSource)&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r))}catch(n){this.warn("onBufferReset "+e,n)}},e.onBufferCodecs=function t(e,i){var r=this,n=this.getSourceBufferTypes().length;Object.keys(i).forEach(,!n&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},e.appendChangeType=function t(e,i){var r=this,n=this.operationQueue;n.append({execute:function t(){var a=r.sourceBuffer[e];a&&(r.log("changing "+e+" sourceBuffer type to "+i),a.changeType(i)),n.shiftAndExecuteNext(e)},onStart:function t(){},onComplete:function t(){},onError:function t(i){r.warn("Failed to change "+e+" SourceBuffer type",i)}},e,!!this.pendingTracks[e])},e.onBufferAppending=function t(e,i){var r=this,n=this.hls,a=this.operationQueue,s=this.tracks,o=i.data,l=i.type,u=i.frag,d=i.part,h=i.chunkMeta,f=h.buffering[l],c=self.performance.now();f.start=c;var $=u.stats.buffering,g=d?d.stats.buffering:null;0===$.start&&($.start=c),g&&0===g.start&&(g.start=c);var v=s.audio,m=!1;"audio"===l&&(null==v?void 0:v.container)==="audio/mpeg"&&(m=!this.lastMpegAudioChunk||1===h.id||this.lastMpegAudioChunk.sn!==h.sn,this.lastMpegAudioChunk=h);var p=u.start;a.append({execute:function t(){if(f.executeStart=self.performance.now(),m){var e=r.sourceBuffer[l];if(e){var i=p-e.timestampOffset;Math.abs(i)>=.1&&(r.log("Updating audio SourceBuffer timestampOffset to "+p+" (delta: "+i+") sn: "+u.sn+")"),e.timestampOffset=p)}}r.appendExecutor(o,l)},onStart:function t(){},onComplete:function t(){var e=self.performance.now();f.executeEnd=f.end=e,0===$.first&&($.first=e),g&&0===g.first&&(g.first=e);var i=r.sourceBuffer,n={};for(var a in i)n[a]=ia.getBuffered(i[a]);r.appendErrors[l]=0,"audio"===l||"video"===l?r.appendErrors.audiovideo=0:(r.appendErrors.audio=0,r.appendErrors.video=0),r.hls.trigger(b.BUFFER_APPENDED,{type:l,frag:u,part:d,chunkMeta:h,parent:u.type,timeRanges:n})},onError:function t(e){var i={type:C.MEDIA_ERROR,parent:u.type,details:w.BUFFER_APPEND_ERROR,sourceBufferName:l,frag:u,part:d,chunkMeta:h,error:e,err:e,fatal:!1};if(e.code===DOMException.QUOTA_EXCEEDED_ERR)i.details=w.BUFFER_FULL_ERROR;else{var a=++r.appendErrors[l];i.details=w.BUFFER_APPEND_ERROR,r.warn("Failed "+a+"/"+n.config.appendErrorMaxRetry+' times to append segment in "'+l+'" sourceBuffer'),a>=n.config.appendErrorMaxRetry&&(i.fatal=!0)}n.trigger(b.ERROR,i)}},l,!!this.pendingTracks[l])},e.onBufferFlushing=function t(e,i){var r=this,n=this.operationQueue,a=function t(e){return{execute:r.removeExecutor.bind(r,e,i.startOffset,i.endOffset),onStart:function t(){},onComplete:function t(){r.hls.trigger(b.BUFFER_FLUSHED,{type:e})},onError:};i.type?n.append(a(i.type),i.type):this.getSourceBufferTypes().forEach(},e.onFragParsed=function t(e,i){var r=this,n=i.frag,a=i.part,s=[],o=a?a.elementaryStreams:n.elementaryStreams;o[W.AUDIOVIDEO]?s.push("audiovideo"):(o[W.AUDIO]&&s.push("audio"),o[W.VIDEO]&&s.push("video"));var l=function t(){var e=self.performance.now();n.stats.buffering.end=e,a&&(a.stats.buffering.end=e);var i=a?a.stats:n.stats;r.hls.trigger(b.FRAG_BUFFERED,{frag:n,part:a,stats:i,id:n.type})};0===s.length&&this.warn("Fragments must have at least one ElementaryStreamType set. type: "+n.type+" level: "+n.level+" sn: "+n.sn),this.blockBuffers(l,s)},e.onFragChanged=function t(e,i){this.trimBuffers()},e.onBufferEos=function t(e,i){var r=this;this.getSourceBufferTypes().reduce(function(t,e){var n=r.sourceBuffer[e];return!n||i.type&&i.type!==e||(n.ending=!0,n.ended||(n.ended=!0,r.log(e+" sourceBuffer now EOS"))),t&&!!(!n||n.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(function(){r.getSourceBufferTypes().forEach(;var t=r.mediaSource;if(!t||"open"!==t.readyState){t&&r.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: "+t.readyState);return}r.log("Calling mediaSource.endOfStream()"),t.endOfStream()}))},e.onLevelUpdated=function t(e,i){var r=i.details;r.fragments.length&&(this.details=r,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},e.trimBuffers=function t(){var e=this.hls,i=this.details,r=this.media;if(r&&null!==i){if(this.getSourceBufferTypes().length){var n=e.config,a=r.currentTime,s=i.levelTargetDuration,o=i.live&&null!==n.liveBackBufferLength?n.liveBackBufferLength:n.backBufferLength;if(k(o)&&o>0&&this.flushBackBuffer(a,s,Math.floor(a/s)*s-Math.max(o,s)),k(n.frontBufferFlushThreshold)&&n.frontBufferFlushThreshold>0){var l=Math.max(n.maxBufferLength,n.frontBufferFlushThreshold);this.flushFrontBuffer(a,s,Math.floor(a/s)*s+Math.max(l,s))}}}},e.flushBackBuffer=function t(e,i,r){var n=this,a=this.details,s=this.sourceBuffer;this.getSourceBufferTypes().forEach(function(t){var o=s[t];if(o){var l=ia.getBuffered(o);if(l.length>0&&r>l.start(0)){if(n.hls.trigger(b.BACK_BUFFER_REACHED,{bufferEnd:r}),null!=a&&a.live)n.hls.trigger(b.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(o.ended&&l.end(l.length-1)-e<2*i){n.log("Cannot flush "+t+" back buffer while SourceBuffer is in ended state");return}n.hls.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:t})}}})},e.flushFrontBuffer=function t(e,i,r){var n=this,a=this.sourceBuffer;this.getSourceBufferTypes().forEach(function(t){var s=a[t];if(s){var o=ia.getBuffered(s),l=o.length;if(l<2)return;var u=o.start(l-1),d=o.end(l-1);if(r>u||e>=u&&e<=d)return;if(s.ended&&e-d<2*i){n.log("Cannot flush "+t+" front buffer while SourceBuffer is in ended state");return}n.hls.trigger(b.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:t})}})},e.updateMediaElementDuration=function t(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,i=this.hls,r=this.media,n=this.mediaSource,a=e.fragments[0].start+e.totalduration,s=r.duration,o=k(n.duration)?n.duration:0;e.live&&i.config.liveDurationInfinity?(n.duration=1/0,this.updateSeekableRange(e)):(a>o&&a>s||!k(s))&&(this.log("Updating Media Source duration to "+a.toFixed(3)),n.duration=a)}},e.updateSeekableRange=function t(e){var i=this.mediaSource,r=e.fragments;if(r.length&&e.live&&null!=i&&i.setLiveSeekableRange){var n=Math.max(0,r[0].start),a=Math.max(n,n+e.totalduration);this.log("Media Source duration is set to "+i.duration+". Setting seekable range to "+n+"-"+a+"."),i.setLiveSeekableRange(n,a)}},e.checkPendingTracks=function t(){var e=this.bufferCodecEventsExpected,i=this.operationQueue,r=this.pendingTracks,n=Object.keys(r).length;if(n&&!e||2===n){this.createSourceBuffers(r),this.pendingTracks={};var a=this.getSourceBufferTypes();if(a.length)this.hls.trigger(b.BUFFER_CREATED,{tracks:this.tracks}),a.forEach(function(t){i.executeNext(t)});else{var s=Error("could not create source buffer for media codec(s)");this.hls.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:s,reason:s.message})}}},e.createSourceBuffers=function t(e){var i=this,r=this.sourceBuffer,n=this.mediaSource;if(!n)throw Error("createSourceBuffers called when mediaSource was null");var a=function t(a){if(!r[a]){var s=e[a];if(!s)throw Error("source buffer exists for track "+a+", however track does not");var o=s.levelCodec||s.codec;o&&"audio"===a.slice(0,5)&&(o=tz(o,i.hls.config.preferManagedMediaSource));var l=s.container+";codecs="+o;i.log("creating sourceBuffer("+l+")");try{var u=r[a]=n.addSourceBuffer(l),d=a;i.addBufferListener(d,"updatestart",i._onSBUpdateStart),i.addBufferListener(d,"updateend",i._onSBUpdateEnd),i.addBufferListener(d,"error",i._onSBUpdateError),i.addBufferListener(d,"bufferedchange",,i.tracks[a]={buffer:u,codec:o,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(h){i.error("error while trying to add sourceBuffer: "+h.message),i.hls.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:a,mimeType:l})}}};for(var s in e)a(s)},e._onSBUpdateStart=function t(e){this.operationQueue.current(e).onStart()},e._onSBUpdateEnd=function t(e){if((null==(i=this.mediaSource)?void 0:i.readyState)==="closed"){this.resetBuffer(e);return}var i,r=this.operationQueue;r.current(e).onComplete(),r.shiftAndExecuteNext(e)},e._onSBUpdateError=function t(e,i){var r=Error(e+" SourceBuffer error");this.error(""+r,i),this.hls.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});var n=this.operationQueue.current(e);n&&n.onError(i)},e.removeExecutor=function t(e,i,r){var n=this.media,a=this.mediaSource,s=this.operationQueue,o=this.sourceBuffer[e];if(!n||!a||!o){this.warn("Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),s.shiftAndExecuteNext(e);return}var l=k(n.duration)?n.duration:1/0,u=k(a.duration)?a.duration:1/0,d=Math.max(0,i),h=Math.min(r,l,u);h>d&&(!o.ending||o.ended)?(o.ended=!1,this.log("Removing ["+d+","+h+"] from the "+e+" SourceBuffer"),o.remove(d,h)):s.shiftAndExecuteNext(e)},e.appendExecutor=function t(e,i){var r=this.sourceBuffer[i];if(!r){if(!this.pendingTracks[i])throw Error("Attempting to append to the "+i+" SourceBuffer, but it does not exist");return}r.ended=!1,r.appendBuffer(e)},e.blockBuffers=function t(e,i){var r=this;if(void 0===i&&(i=this.getSourceBufferTypes()),!i.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}var n=this.operationQueue;Promise.all(i.map(function(t){return n.appendBlocker(t)})).then(},e.getSourceBufferTypes=e.addBufferListener=function t(e,i,r){var n=this.sourceBuffer[e];if(n){var a=r.bind(this,e);this.listeners[e].push({event:i,listener:a}),n.addEventListener(i,a)}},e.removeBufferListeners=function t(e){var i=this.sourceBuffer[e];i&&this.listeners[e].forEach(},a(t,[{key:"mediaSrc",get:function t(){var e,i=(null==(e=this.media)?void 0:e.firstChild)||this.media;return null==i?void 0:i.src}}]),t}();ar rM={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},rB=rU={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},r0={17:2,18:4,21:6,22:8,23:10,19:13,20:15},r2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rG={25:2,26:4,29:6,30:8,31:10,27:13,28:15},r1=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],r6=function(){eturn t.prototype.log=function t(e,i){if(this.verboseLevel>=e){var r="function"==typeof i?i():i;M.log(this.time+" ["+e+"] "+r)}},t}(),rK=function t(e){for(var i=[],r=0;r<e.length;r++)i.push(e[r].toString(16));return i},r4=function(){ar e=t.prototype;return e.reset=function t(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.setStyles=function t(e){for(var i=["foreground","underline","italics","background","flash"],r=0;r<i.length;r++){var n=i[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},e.isDefault=function t(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.equals=e.copy=function t(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},e.toString=t}(),r3=function(){ar e=t.prototype;return e.reset=e.setChar=function t(e,i){this.uchar=e,this.penState.copy(i)},e.setPenState=function t(e){this.penState.copy(e)},e.equals=e.copy=function t(e){this.uchar=e.uchar,this.penState.copy(e.penState)},e.isEmpty=function t(){return" "===this.uchar&&this.penState.isDefault()},t}(),rH=function(){function t(t){this.chars=[],this.pos=0,this.currPenState=new r4,this.cueStartTime=null,this.logger=void 0;for(var e=0;e<100;e++)this.chars.push(new r3);this.logger=t}var e=t.prototype;return e.equals=e.copy=function t(e){for(var i=0;i<100;i++)this.chars[i].copy(e.chars[i])},e.isEmpty=function t(){for(var e=!0,i=0;i<100;i++)if(!this.chars[i].isEmpty()){e=!1;break}return e},e.setCursor=function t(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=100)},e.moveCursor=function t(e){var i=this.pos+e;if(e>1)for(var r=this.pos+1;r<i+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(i)},e.backSpace=function t(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.insertChar=function t(e){var i=this;e>=144&&this.backSpace();var r=rB(e);if(this.pos>=100){this.logger.log(0,;return}this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1)},e.clearFromPos=function t(e){var i;for(i=e;i<100;i++)this.chars[i].reset()},e.clear=function t(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.clearToEndOfRow=e.getTextString=function t(){for(var e=[],i=!0,r=0;r<100;r++){var n=this.chars[r].uchar;" "!==n&&(i=!1),e.push(n)}return i?"":e.join("")},e.setPenStyles=function t(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},t}(),rV=function(){function t(t){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(var e=0;e<15;e++)this.rows.push(new rH(t));this.logger=t}var e=t.prototype;return e.reset=function t(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},e.equals=function t(e){for(var i=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){i=!1;break}return i},e.copy=function t(e){for(var i=0;i<15;i++)this.rows[i].copy(e.rows[i])},e.isEmpty=function t(){for(var e=!0,i=0;i<15;i++)if(!this.rows[i].isEmpty()){e=!1;break}return e},e.backSpace=function t(){this.rows[this.currRow].backSpace()},e.clearToEndOfRow=function t(){this.rows[this.currRow].clearToEndOfRow()},e.insertChar=function t(e){this.rows[this.currRow].insertChar(e)},e.setPen=function t(e){this.rows[this.currRow].setPenStyles(e)},e.moveCursor=function t(e){this.rows[this.currRow].moveCursor(e)},e.setCursor=function t(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},e.setPAC=function t(e){this.logger.log(2,function(){return"pacData = "+JSON.stringify(e)});var i=e.row-1;if(this.nrRollUpRows&&i<this.nrRollUpRows-1&&(i=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==i){for(var r=0;r<15;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var s=a.rows[n].cueStartTime,o=this.logger.time;if(null!==s&&null!==o&&s<o)for(var l=0;l<this.nrRollUpRows;l++)this.rows[i-this.nrRollUpRows+l+1].copy(a.rows[n+l])}}this.currRow=i;var u=this.rows[this.currRow];if(null!==e.indent){var d=e.indent;u.setCursor(e.indent),e.color=u.chars[Math.max(d-1,0)].penState.foreground}var h={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(h)},e.setBkgData=function t(e){this.logger.log(2,,this.backSpace(),this.setPen(e),this.insertChar(32)},e.setRollUpRows=function t(e){this.nrRollUpRows=e},e.rollUp=function t(){var e=this;if(null===this.nrRollUpRows){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,;var i=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(i,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(2,"Rolling up")},e.getDisplayText=function t(e){e=e||!1;for(var i=[],r="",n=-1,a=0;a<15;a++){var s=this.rows[a].getTextString();s&&(n=a+1,e?i.push("Row "+n+": '"+s+"'"):i.push(s.trim()))}return i.length>0&&(r=e?"["+i.join(" | ")+"]":i.join("\n")),r},e.getTextAndFormat=function t(){return this.rows},t}(),rY=function(){ar e=t.prototype;return e.reset=function t(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},e.getHandler=function t(){return this.outputFilter},e.setHandler=e.setPAC=function t(e){this.writeScreen.setPAC(e)},e.setBkgData=e.setMode=function t(e){e!==this.mode&&(this.mode=e,this.logger.log(2,,"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},e.insertChars=function t(e){for(var i=this,r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,,("MODE_PAINT-ON"===this.mode||"MODE_ROLL-UP"===this.mode)&&(this.logger.log(1,,this.outputDataUpdate())},e.ccRCL=function t(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.ccBS=function t(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.ccAOF=function t(){},e.ccAON=function t(){},e.ccDER=function t(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.ccRU=function t(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},e.ccFON=function t(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.ccRDC=function t(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.ccTR=function t(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")},e.ccRTD=function t(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")},e.ccEDM=function t(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.ccCR=function t(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.ccENM=e.ccEOC=function t(){var e=this;if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var i=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=i,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,}this.outputDataUpdate(!0)},e.ccTO=function t(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},e.ccMIDROW=function t(e){var i={flash:!1};i.underline=e%2==1,i.italics=e>=46,i.italics?i.foreground="white":i.foreground=["white","green","blue","cyan","red","yellow","magenta"][Math.floor(e/2)-16],this.logger.log(2,"MIDROW: "+JSON.stringify(i)),this.writeScreen.setPen(i)},e.outputDataUpdate=function t(e){void 0===e&&(e=!1);var i=this.logger.time;null!==i&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,i,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:i):this.cueStartTime=i,this.lastOutputScreen.copy(this.displayedMemory))},e.cueSplitAtTime=function t(e){this.outputFilter&&!this.displayedMemory.isEmpty()&&(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e)},t}(),r7=function(){ar e=t.prototype;return e.getHandler=e.setHandler=e.addData=function t(e,i){var r,n,a,s=!1;this.logger.time=e;for(var o=0;o<i.length;o+=2)if(n=127&i[o],a=127&i[o+1],0!==n||0!==a){if(this.logger.log(3,"["+rK([i[o],i[o+1]])+"] -> ("+rK([n,a])+")"),(r=this.parseCmd(n,a))||(r=this.parseMidrow(n,a)),r||(r=this.parsePAC(n,a)),r||(r=this.parseBackgroundAttributes(n,a)),!r&&(s=this.parseChars(n,a))){var l=this.currentChannel;l&&l>0?this.channels[l].insertChars(s):this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,"Couldn't parse cleaned data "+rK([n,a])+" orig: "+rK([i[o],i[o+1]]))}},e.parseCmd=function t(e,i){var r=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&i>=32&&i<=47||(23===e||31===e)&&i>=33&&i<=35))return!1;if(r5(e,i,r))return rW(null,null,r),this.logger.log(3,"Repeated command ("+rK([e,i])+") is dropped"),!0;var n=20===e||21===e||23===e?1:2,a=this.channels[n];return 20===e||21===e||28===e||29===e?32===i?a.ccRCL():33===i?a.ccBS():34===i?a.ccAOF():35===i?a.ccAON():36===i?a.ccDER():37===i?a.ccRU(2):38===i?a.ccRU(3):39===i?a.ccRU(4):40===i?a.ccFON():41===i?a.ccRDC():42===i?a.ccTR():43===i?a.ccRTD():44===i?a.ccEDM():45===i?a.ccCR():46===i?a.ccENM():47===i&&a.ccEOC():a.ccTO(i-32),rW(e,i,r),this.currentChannel=n,!0},e.parseMidrow=function t(e,i){var r=0;if((17===e||25===e)&&i>=32&&i<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;var n=this.channels[r];return!!n&&(n.ccMIDROW(i),this.logger.log(3,"MIDROW ("+rK([e,i])+")"),!0)}return!1},e.parsePAC=function t(e,i){var r,n=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&i>=64&&i<=127||(16===e||24===e)&&i>=64&&i<=95))return!1;if(r5(e,i,n))return rW(null,null,n),!0;var a=e<=23?1:2;r=i>=64&&i<=95?1===a?rU[e]:r2[e]:1===a?r0[e]:rG[e];var s=this.channels[a];return!!s&&(s.setPAC(this.interpretPAC(r,i)),rW(e,i,n),this.currentChannel=a,!0)},e.interpretPAC=function t(e,i){var r,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=i>95?i-96:i-64,n.underline=(1&r)==1,r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},e.parseChars=function t(e,i){var r,n,a=null,s=null;if(e>=25?(r=2,s=e-8):(r=1,s=e),s>=17&&s<=19?(n=17===s?i+80:18===s?i+112:i+144,this.logger.log(2,"Special char '"+rB(n)+"' in channel "+r),a=[n]):e>=32&&e<=127&&(a=0===i?[e]:[e,i]),a){var o=rK(a);this.logger.log(3,"Char codes =  "+o.join(",")),rW(e,i,this.cmdHistory)}return a},e.parseBackgroundAttributes=function t(e,i){if(!((16===e||24===e)&&i>=32&&i<=47||(23===e||31===e)&&i>=45&&i<=47))return!1;var r,n={};return 16===e||24===e?(r=Math.floor((i-32)/2),n.background=r1[r],i%2==1&&(n.background=n.background+"_semi")):45===i?n.background="transparent":(n.foreground="black",47===i&&(n.underline=!0)),this.channels[e<=23?1:2].setBkgData(n),rW(e,i,this.cmdHistory),!0},e.reset=function t(){for(var e=0;e<Object.keys(this.channels).length;e++){var i=this.channels[e];i&&i.reset()}this.cmdHistory=rq()},e.cueSplitAtTime=function t(e){for(var i=0;i<this.channels.length;i++){var r=this.channels[i];r&&r.cueSplitAtTime(e)}},t}(); rX=function(){ar e=t.prototype;return e.dispatchCue=function t(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},e.newCue=function t(e,i,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=i,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e.reset=t}(),rz=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;var t=["","lr","rl"],e=["start","middle","end","left","right"];ction a(e,a,s){var o=this,l={enumerable:!0};o.hasBeenReset=!1;var u="",d=!1,h=e,f=a,c=s,$=null,g="",v=!0,m="auto",p="start",y=50,T="middle",x=50,E="middle";Object.defineProperty(o,"id",n({},l,{get:function t(){return u},set:)),Object.defineProperty(o,"pauseOnExit",n({},l,{get:function t(){return d},set:)),Object.defineProperty(o,"startTime",n({},l,{get:function t(){return h},set:function t(e){if("number"!=typeof e)throw TypeError("Start time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",n({},l,{get:function t(){return f},set:function t(e){if("number"!=typeof e)throw TypeError("End time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",n({},l,{get:function t(){return c},set:)),Object.defineProperty(o,"region",n({},l,{get:function t(){return $},set:)),Object.defineProperty(o,"vertical",n({},l,{get:function t(){return g},set:function e(r){var n,a=(n=r,i(t,n));if(!1===a)throw SyntaxError("An invalid or illegal string was specified.");g=a,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",n({},l,{get:function t(){return v},set:)),Object.defineProperty(o,"line",n({},l,{get:function t(){return m},set:function t(e){if("number"!=typeof e&&"auto"!==e)throw SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",n({},l,{get:function t(){return p},set:function t(e){var i=r(e);if(!i)throw SyntaxError("An invalid or illegal string was specified.");p=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",n({},l,{get:function t(){return y},set:function t(e){if(e<0||e>100)throw Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",n({},l,{get:function t(){return T},set:function t(e){var i=r(e);if(!i)throw SyntaxError("An invalid or illegal string was specified.");T=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",n({},l,{get:function t(){return x},set:function t(e){if(e<0||e>100)throw Error("Size must be between 0 and 100.");x=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",n({},l,{get:function t(){return E},set:function t(e){var i=r(e);if(!i)throw SyntaxError("An invalid or illegal string was specified.");E=i,this.hasBeenReset=!0}})),o.displayState=void 0}return a.prototype.getCueAsHTML=a}(),rj=function(){eturn t.prototype.decode=function t(e,i){if(!e)return"";if("string"!=typeof e)throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))},t}();ar r9=function(){ar e=t.prototype;return e.set=function t(e,i){this.get(e)||""===i||(this.values[e]=i)},e.get=function t(e,i,r){return r?this.has(e)?this.values[e]:i[r]:this.has(e)?this.values[e]:i},e.has=e.alt=function t(e,i,r){for(var n=0;n<r.length;++n)if(i===r[n]){this.set(e,i);break}},e.integer=function t(e,i){/^-?\d+$/.test(i)&&this.set(e,parseInt(i,10))},e.percent=function t(e,i){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(i)){var t=parseFloat(i);if(t>=0&&t<=100)return this.set(e,t),!0}return!1},t}();function rZ(t,e,i,r){var n=r?t.split(r):[t];for(var a in n){if("string"==typeof n[a]){var s,o=n[a].split(i);if(2===o.length){e(o[0],o[1])}}}}var rJ=new rz(0,0,""),nt="middle"===rJ.align?"middle":"center";function ne(t,e,i){var r,n,a,s,o,l=t;(d(),e.startTime=u(),d(),"-->"!==t.slice(0,3))throw Error("Malformed time stamp (time stamps must be separated by '-->'): "+l);t=t.slice(3),d(),e.endTime=u(),d(),r=t,n=e,a=new r9,rZ(r,/:/,/\s/),n.region=a.get("region",null),n.vertical=a.get("vertical",""),"auto"===(s=a.get("line","auto"))&&-1===rJ.line&&(s=-1),n.line=s,n.lineAlign=a.get("lineAlign","start"),n.snapToLines=a.get("snapToLines",!0),n.size=a.get("size",100),n.align=a.get("align",nt),"auto"===(o=a.get("position","auto"))&&50===rJ.position&&(o="start"===n.align||"left"===n.align?0:"end"===n.align||"right"===n.align?100:50),n.position=o}ar nr=function(){ar e=t.prototype;return e.parse=function t(e){var i=this;&(i.buffer+=i.decoder.decode(e,{stream:!0}));try{var a="";if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;var s=(a=r()).match(/^()?WEBVTT([ \t].*)?$/);if(!(null!=s&&s[0]))throw Error("Malformed WebVTT signature.");i.state="HEADER"}for(var o=!1;i.buffer&&/\r\n|\n/.test(i.buffer);)switch(o?o=!1:a=r(),i.state){case"HEADER":/:/.test(a)?n(a):a||(i.state="ID");continue;case"NOTE":a||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){i.state="NOTE";break}if(!a)continue;if(i.cue=new rz(0,0,""),i.state="CUE",-1===a.indexOf("-->")){i.cue.id=a;continue}case"CUE":if(!i.cue){i.state="BADCUE";continue}try{ne(a,i.cue,i.regionList)}catch(l){i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var u=-1!==a.indexOf("-->");if(!a||u&&(o=!0)){i.oncue&&i.cue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}if(null===i.cue)continue;i.cue.text&&(i.cue.text+="\n"),i.cue.text+=a;continue;case"BADCUE":a||(i.state="ID")}}catch(d){"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},e.flush=function t(){var e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw Error("Malformed WebVTT signature.")}catch(i){e.onparsingerror&&e.onparsingerror(i)}return e.onflush&&e.onflush(),this},t}(),nn=/\r\n|\n\r|\n|\r/g,na=function t(e,i,r){return void 0===r&&(r=0),e.slice(r,r+i.length)===i},ns=function t(e){var i=parseInt(e.slice(-3)),r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!k(i)||!k(r)||!k(n)||!k(a))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return i+=1e3*r,i+=6e4*n,i+=36e5*a},)}var nu=function t(e,i,r){var n,a=e[i],s=e[a.prevCC];if(!s||!s.new&&a.new){e.ccOffset=e.presentationOffset=a.start,a.new=!1;return}for(;null!=(n=s)&&n.new;)e.ccOffset+=a.start-s.start,a.new=!1,s=e[(a=s).prevCC];e.presentationOffset=r},nd="stpp.ttml.im1t",nh=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,nf=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,nc={left:"start",center:"center",right:"end",start:"start",end:"end"};function n$(t,e,i,r){var n=tD(new Uint8Array(t),["mdat"]);if(0===n.length){r(Error("Could not parse IMSC1 mdat"));return}var a,s,l,u=n.m)}),d=(a=e.baseTime,void 0===(s=e.timescale)&&(s=1),void 0===l&&(l=!1),re(a,1,1/s,l));try{u.forEach(function(t){return i(function t(e,i){var r=new DOMParser().parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!r)throw Error("Invalid ttml");var n={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(n).redut},{}),s="preserve"!==r.getAttribute("xml:space"),l=nv(ng(r,"styling","style")),u=nv(ng(r,"layout","region")),d=ng(r,"body","[begin]");return[].map.call(d,function(t){var e=function t(e,i){return[].slice.call(e.childNodes).redut},"")}(t,s);if(!e||!t.hasAttribute("begin"))return null;var r=ny(t.getAttribute("begin"),a),n=ny(t.getAttribute("dur"),a),d=ny(t.getAttribute("end"),a);if(null===r)throw np(t);if(null===d){if(null===n)throw np(t);d=r+n}var h,f,c,$,g,v,m=new rz(r-i,d-i,e);m.id=nl(m.startTime,m.endTime,m.text);var p,y=(h=u[t.getAttribute("region")],f=l[t.getAttribute("style")],c=l,$="http://www.w3.org/ns/ttml#styling",g=null,v=null!=h&&h.hasAttribute("style")?h.getAttribute("style"):null,v&&c.hasOwnProperty(v)&&(g=c[v]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].redut},{})),T=y.textAlign;if(T){var x=nc[T];x&&(m.lineAlign=x),m.align=T}return o(m,y),m}).filtt})}(t,d))})}catch(h){r(hunction ny(t,e){if(!t)return null;var i,r,n,a,s=rQ(t);return null===s&&(nh.test(t)?s=(i=t,r=e,n=nh.exec(i),a=(0|n[4])+(0|n[5])/r.subFrameRate,(0|n[1])*3600+(0|n[2])*60+(0|n[3])+a/r.frameRate):nf.test(t)&&(s=function t(e,i){var r=nf.exec(e),n=Number(r[1]),a=r[2];switch(a){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/i.frameRate;case"t":return n/i.tickRate}return n}(t,e))),s}var nT=function)}var e=t.prototype;return e.destroy=function t(){var e=this.hls;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},e.lazyInit608=function t(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){var e=new rX(this,"textTrack1"),i=new rX(this,"textTrack2"),r=new rX(this,"textTrack3"),n=new rX(this,"textTrack4");this.cea608Parser1=new r7(1,e,i),this.cea608Parser2=new r7(3,r,n)}},e.addCues=function t(e,i,r,n,a){for(var s=!1,o=a.length;o--;){var l=a[o],u=nE(l[0],l[1],i,r);if(u>=0&&(l[0]=Math.min(l[0],i),l[1]=Math.max(l[1],r),s=!0,u/(r-i)>.5))return}if(s||a.push([i,r]),this.config.renderTextTracksNatively){var d=this.captionsTracks[e];this.Cues.newCue(d,i,r,n)}else{var h=this.Cues.newCue(null,i,r,n);this.hls.trigger(b.CUES_PARSED,{type:"captions",cues:h,track:e})}},e.onInitPtsFound=function t(e,i){var r=this,n=i.frag,a=i.id,s=i.initPTS,o=i.timescale,l=this.unparsedVttFrags;"main"===a&&(this.initPTS[n.cc]={baseTime:s,timescale:o}),l.length&&(this.unparsedVttFrags=[],l.forEa)}))},e.getExistingTrack=function t(e){var i=this.media;if(i)for(var r=0;r<i.textTracks.length;r++){var n=i.textTracks[r];if(n[e])return n}return null},e.createCaptionsTrack=function t(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},e.createNativeTrack=function t(e){if(!this.captionsTracks[e]){var i=this.captionsProperties,r=this.captionsTracks,n=this.media,a=i[e],s=a.label,o=a.languageCode,l=this.getExistingTrack(e);if(l)r[e]=l,ev(r[e]),e$(r[e],n);else{var u=this.createTextTrack("captions",s,o);u&&(u[e]=!0,r[e]=u)}}},e.createNonNativeTrack=function t(e){if(!this.nonNativeCaptionsTracks[e]){var i=this.captionsProperties[e];if(i){var r={_id:e,label:i.label,kind:"captions",default:!!i.media&&!!i.media.default,closedCaptions:i.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},e.createTextTrack=function t(e,i,r){var n=this.media;if(n)return n.addTextTrack(e,i,r)},e.onMediaAttaching=function t(e,i){this.media=i.media,this._cleanTracks()},e.onMediaDetaching=function t(){var e=this.captionsTracks;Object.keys(e).forEa]}),this.nonNativeCaptionsTracks={}},e.onManifestLoading=function t(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=nS(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},e._cleanTracks=function t(){var e=this.media;if(e){var i=e.textTracks;if(i)for(var r=0;r<i.length;r++)ev(i[r])}},e.onSubtitleTracksUpdated=function t(e,i){var r=this,n=i.subtitleTracks||[],a=n.some(function(t){return t.textCodec===nd});if(this.config.enableWebVTT||a&&this.config.enableIMSC1){if(rI(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){var s=this.media?this.media.textTracks:null;this.tracks.forEa)})}else if(this.tracks.length){var o=this.tracks.m}});this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}},e._captionsOrSubtitlesFromCharacteristics=function t(e){return e.attrs.CHARACTERISTICS&&/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS)&&/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS)?"captions":"subtitles"},e.onManifestLoaded=function t(e,i){var r=this;this.config.enableCEA708Captions&&i.captions&&i.captions.forEa}})},e.closedCaptionsForLevel=function t(e){var i=this.hls.levels[e.level];return null==i?void 0:i.attrs["CLOSED-CAPTIONS"]},e.onFragLoading=function t(e,i){var r=this.cea608Parser1,n=this.cea608Parser2,a=this.lastCc,s=this.lastSn,o=this.lastPartIndex;if(this.enabled&&r&&n&&i.frag.type===ed.MAIN){var l,u,d=i.frag,h=d.cc,f=d.sn,c=null!=(l=null==i?void 0:null==(u=i.part)?void 0:u.index)?l:-1;f===s+1||f===s&&c===o+1||h===a||(r.reset(),n.reset()),this.lastCc=h,this.lastSn=f,this.lastPartIndex=c}},e.onFragLoaded=function t(e,i){var r=i.frag,n=i.payload;if(r.type===ed.SUBTITLE){if(n.byteLength){var a=r.decryptdata;if(null==a||!a.encrypted||"stats"in i){var s=this.tracks[r.level],o=this.vttCCs;o[r.cc]||(o[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),s&&s.textCodec===nd?this._parseIMSC1(r,n):this._parseVTTs(i)}}else this.hls.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:Error("Empty subtitle payload")})}},e._parseIMSC1=function t(e,i){var r=this,n=this.hls;n$(i,this.initPTS[e.cc],function(t){r._appendCues(t,e.level),n.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})})},e._parseVTTs=function t(e){var i,r=this,n=e.frag,a=e.payload,s=this.initPTS,o=this.unparsedVttFrags,l=s.length-1;if(!s[n.cc]&&-1===l){o.push(e);return}var u,d,h,f,c,$,g,v,m,p,y,T,x,E,S,L,R,A,_=this.hls;u=null!=(i=n.initSegment)&&i.data?tO(n.initSegment.data,new Uint8Array(a)):a,d=this.initPTS[n.cc],h=this.vttCCs,f=n.cc,c=n.start)},g=function(t){var i="Missing initPTS for VTT MPEGTS"===t.message;i?o.push(e):r._fallbackToIMSC1(n,a),M.log("Failed to parse VTT cue: "+t),(!i||!(l>n.cc))&&_.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})},m=new nr,p=tT(new Uint8Array(u)).trim().replace(nn,"\n").split("\n"),y=[],E=d?(T=d.baseTime,void 0===(x=d.timescale)&&(x=1),re(T,9e4,1/x)):0,S="00:00.000",L=0,R=0,A=!0,m.oncue=function(t){var e=h[f],i=h.ccOffset,r=(L-E)/9e4;if(null!=e&&e.new&&(void 0!==R?i=h.ccOffset=e.start:nu(h,f,r)),r){if(!d){v=Error("Missing initPTS for VTT MPEGTS");return}i=r-h.presentationOffset}var n=t.endTime-t.startTime,a=rs((t.startTime+i-R)*9e4,9e4*c)/9e4;t.startTime=Math.max(a,0),t.endTime=Math.max(a+n,0);var s=t.text.trim();t.text=decodeURIComponent(encodeURIComponent(s)),t.id||(t.id=nl(t.startTime,t.endTime,s)),t.endTime>0&&y.push(t)},m.onparsingerror=function(t){v=t},m.onflu)},p.forEa)}),m.flush()},e._fallbackToIMSC1=function t(e,i){var r=this,n=this.tracks[e.level];n.textCodec||n$(i,this.initPTS[e.c"})},e._appendCues=function t(e,i){var r=this.hls;if(this.config.renderTextTracksNatively){var n=this.textTracks[i];if(!n||"disabled"===n.mode)return;e.forEach(function(t){return eg(n,t)})}else{var a=this.tracks[i];if(!a)return;var s=a.default?"default":"subtitles"+i;r.trigger(b.CUES_PARSED,{type:"subtitles",cues:e,track:s})}},e.onFragDecrypted=function t(e,i){i.frag.type===ed.SUBTITLE&&this.onFragLoaded(b.FRAG_LOADED,i)},e.onSubtitleTracksCleared=function t(){this.tracks=[],this.captionsTracks={}},e.onFragParsingUserdata=function t(e,i){if(this.enabled){var r=i.frag,n=i.samples;if(r.type!==ed.MAIN||"NONE"!==this.closedCaptionsForLevel(r)){this.lazyInit608();var a=this.cea608Parser1,s=this.cea608Parser2;if(a&&s)for(var o=0;o<n.length;o++){var l=n[o].bytes;if(l){var u=this.extractCea608Data(l);a.addData(n[o].pts,u[0]),s.addData(n[o].pts,u[1])}}}}},e.onBufferFlushing=function t(e,i){var r=i.startOffset,n=i.endOffset,a=i.endOffsetSubtitles,s=i.type,o=this.media;if(o&&!(o.currentTime<n)){if(!s||"video"===s){var l=this.captionsTracks;Object.keys(l).forEach(function(t){return em(l[t],r,n)})}if(this.config.renderTextTracksNatively&&0===r&&void 0!==a){var u=this.textTracks;Object.keys(u).forEa)})}}},e.extractCea608Data=function t(e){for(var i=[[],[]],r=31&e[0],n=2,a=0;a<r;a++){var s=e[n++],o=127&e[n++],l=127&e[n++];if((0!==o||0!==l)&&(4&s)!=0){var u=3&s;(0===u||1===u)&&(i[u].push(o),i[u].push(l))}}return i},t}var nL=function)}var e=t.prototype;return e.setStreamController=function t(e){this.streamController=e},e.registerListeners=function t(){this.hls.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this)},e.unregisterListene)},e.destroy=function t(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},e.onMediaAttaching=function t(e,i){var r=this.hls.config;if(r.capLevelOnFPSDrop){var n=i.media instanceof self.HTMLVideoElement?i.media:null;this.media=n,n&&"function"==typeof n.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}},e.checkFPS=function t(e,i,r){var n=performance.now();if(i){if(this.lastTime){var a=n-this.lastTime,s=r-this.lastDroppedFrames,o=i-this.lastDecodedFrames,l=this.hls;if(l.trigger(b.FPS_DROP,{currentDropped:s,currentDecoded:o,totalDroppedFrames:r}),1e3*s/a>0&&s>l.config.fpsDroppedMonitoringThreshold*o){var u=l.currentLevel;M.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(b.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=i}},e.checkFPSInterval=function t(){var e=this.media;if(e){if(this.isVideoPlaybackQualityAvailable){var i=e.getVideoPlaybackQuality();this.checkFPS(e,i.totalVideoFrames,i.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},t}(),nR="[eme]",nA=function)}var e=t.prototype;return e.destroy=function t(){this.unregisterListeners(),this.onMediaDetached();var e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null},e.registerListeners=function t(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.MANIFEST_LOADED,this.onManifestLoaded,this)},e.unregisterListeners=function t(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.MANIFEST_LOADED,this.onManifestLoaded,this)},e.getLicenseServerUrl=function t(e){var i=this.config,r=i.drmSystems,n=i.widevineLicenseUrl,a=r[e];if(a)return a.licenseUrl;if(e===J.WIDEVINE&&n)return n;throw Error('no license server URL configured for key-system "'+e+'"')},e.getServerCertificateUrl=function t(e){var i=this.config.drmSystems[e];if(i)return i.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+e+'"]')},e.attemptKeySystemAccess=function t(e){var i=this,r=this.hls.levels,n=function t(e,i,r){return!!e&&r.indexOf(e)===i},a=r.map(function(t){return t.audioCodec}).filter(n),s=r.map(function(t){return t.videoCodec}).filter(n);return a.length+s.length===0&&s.push("avc1.42e01e"),new Promise(function(t,r){!function e(n){var o=n.shift();i.getMediaKeysPromise(o,a,s).th)}).catch(function(t){n.length?e(n):t instanceof n_?r(t):r(new n_({type:C.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})}(e)})},e.requestMediaKeySystemAccess=function t(e,i){var r=this.config.requestMediaKeySystemAccessFunc;if("function"!=typeof r){var n="Configured requestMediaKeySystemAccess is not a function "+r;return null===ta&&"http:"===self.location.protocol&&(n="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(Error(n))}return r(e,i)},e.getMediaKeysPromise=function t(e,i,r){var n=this,a=function t(e,i,r,n){var a,s,o,l,u;switch(e){case J.FAIRPLAY:a=["cenc","sinf"];break;case J.WIDEVINE:case J.PLAYREADY:a=["cenc"];break;case J.CLEARKEY:a=["cenc","keyids"];break;default:throw Error("Unknown key-system: "+e)}return s=a,o=i,l=r,u=n,[{initDataTypes:s,persistentState:u.persistentState||"optional",distinctiveIdentifier:u.distinctiveIdentifier||"optional",sessionTypes:u.sessionTypes||[u.sessionType||"temporary"],audioCapabilities:o.map(function(t){return{contentType:'audio/mp4; codecs="'+t+'"',robustness:u.audioRobustness||"",encryptionScheme:u.audioEncryptionScheme||null}}),videoCapabilities:l.m}})}]}(e,i,r,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e],o=null==s?void 0:s.keySystemAccess;if(!o){this.log('Requesting encrypted media "'+e+'" key-system access with config: '+JSON.stringify(a)),o=this.requestMediaKeySystemAccess(e,a);var l=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(function(t){n.log('Failed to obtain access to key-system "'+e+'": '+t)}),o.ths})}return o.then(function(){return s.mediaKeys})},e.createMediaKeySessionContext=function t(e){var i=e.decryptdata,r=e.keySystem,n=e.mediaKeys;this.log('Creating key-system session "'+r+'" keyId: '+tx.hexDump(i.keyId||[]));var a=n.createSession(),s={decryptdata:i,keySystem:r,mediaKeys:n,mediaKeysSession:a,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s},e.renewKeySession=function t(e){var i=e.decryptdata;if(i.pssh){var r=this.createMediaKeySessionContext(e),n=this.getKeyIdString(i);this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,"cenc",i.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)},e.getKeyIdString=function t(e){if(!e)throw Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw Error("keyId is null");return tx.hexDump(e.keyId)},e.updateKeySession=function t(e,i){var r,n=e.mediaKeysSession;return this.log('Updating key-session "'+n.sessionId+'" for keyID '+tx.hexDump((null==(r=e.decryptdata)?void 0:r.keyId)||[])+"\n      } (data length: "+(i?i.byteLength:i)+")"),n.update(i)},e.selectKeySystemFormat=function t(e){var i=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+e.sn+" "+e.type+": "+e.level+") key formats "+i.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(i)),this.keyFormatPromise},e.getKeyFormatPromise=function t(e){var i=this;return new Promise(function(t,r){var n=tn(i.config),a=e.map(te).filt)});return i.getKeySystemSelectionPromise(a).then(function(e){var i=e.keySystem,n=tr(i);n?t(n):r(Error('Unable to find format for key-system "'+i+'"'))}).catch(r)})},e.loadKey=function t(e){var i=this,r=e.keyInfo.decryptdata,n=this.getKeyIdString(r),a="(keyId: "+n+' format: "'+r.keyFormat+'" method: '+r.method+" uri: "+r.uri+")";this.log("Starting session for key "+a);var s=this.keyIdToKeySessionPromise[n];return s||(s=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(r).th)})).catch(function(t){return i.handleError(t)}),s},e.throwIfDestroyed=function t(e){if(!this.hls)throw Error("invalid state")},e.handleError=function t(e){this.hls&&(this.error(e.message),e instanceof n_?this.hls.trigger(b.ERROR,e.data):this.hls.trigger(b.ERROR,{type:C.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))},e.getKeySystemForKeyPromise=function t(e){var i=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[i];if(!r){var n=te(e.keyFormat),a=n?[n]:tn(this.config);return this.attemptKeySystemAccess(a)}return r},e.getKeySystemSelectionPromise=function t(e){if(e.length||(e=tn(this.config)),0===e.length)throw new n_({type:C.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(e)},e._onMediaEncrypted=function t(e){var i=this,r=e.initDataType,n=e.initData;if(this.debug('"'+e.type+'" event: init data type: "'+r+'"'),null!==n){if("sinf"===r&&this.config.drmSystems[J.FAIRPLAY]){var a=tL(new Uint8Array(n));try{var s=Q(JSON.parse(a).sinf),o=tP(new Uint8Array(s));if(!o)return;d=o.subarray(8,24),h=J.FAIRPLAY}catch(l){this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{var u=function t(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;var i={version:0,systemId:"",kids:null,data:null},r=new DataView(e),n=r.getUint32(0);if(e.byteLength!==n&&n>44||1886614376!==r.getUint32(4)||(i.version=r.getUint32(8)>>>24,i.version>1))return null;i.systemId=tx.hexDump(new Uint8Array(e,12,16));var a=r.getUint32(28);if(0===i.version){if(n-32<a)return null;i.data=new Uint8Array(e,32,a)}else if(1===i.version){i.kids=[];for(var s=0;s<a;s++)i.kids.push(new Uint8Array(e,32+16*s,16))}return i}(n);if(null===u)return;0===u.version&&u.systemId===ti.WIDEVINE&&u.data&&(d=u.data.subarray(8,24)),h=function t(e){if(e===ti.WIDEVINE)return J.WIDEVINE}(u.systemId)}if(h&&d){for(var d,h,f,c=tx.hexDump(d),$=this.keyIdToKeySessionPromise,g=this.mediaKeySessions,v=$[c],m=0;m<g.length&&(0===(f=function t(){var e=g[m],a=e.decryptdata;if(a.pssh||!a.keyId)return 0;var s=tx.hexDump(a.keyId);if(c===s||-1!==a.uri.replace(/-/g,"").indexOf(c))return v=$[s],delete $[s],a.pssh=new Uint8Array(n),a.keyId=d,v=$[c]=v.th)}),1}())||1!==f);m++);v||(v=$[c]=this.getKeySystemSelectionPromise([h]).th)})),v.catch(function(t){return i.handleError(t)})}}},e._onWaitingForKey=function t(e){this.log('"'+e.type+'" event')},e.attemptSetMediaKeys=function t(e,i){var r=this,n=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+e+'"');var a=Promise.all(n).th)});return this.setMediaKeysQueue.push(a),a.th)})},e.generateRequestWithPreferredKeySession=function t(e,i,r,n){var a,s,o=this,l=null==(a=this.config.drmSystems)?void 0:null==(s=a[e.keySystem])?void 0:s.generateRequest;if(l)try{var u,d=l.call(this.hls,i,r,e);if(!d)throw Error("Invalid response from configured generateRequest filter");i=d.initDataType,r=e.decryptdata.pssh=d.initData?new Uint8Array(d.initData):null}catch(h){if(this.warn(h.message),null!=(u=this.hls)&&u.config.debug)throw h}if(null===r)return this.log('Skipping key-session request for "'+n+'" (no initData)'),Promise.resolve(e);var f=this.getKeyIdString(e.decryptdata);this.log('Generating key-session request for "'+n+'": '+f+" (init data type: "+i+" length: "+(r?r.byteLength:null)+")");var c=new rx;e.mediaKeysSession.onmessage=function(t){var i=e.mediaKeysSession;if(!i){c.emit("error",Error("invalid state"));return}var r=t.messageType,n=t.message;o.log('"'+r+'" message event for session "'+i.sessionId+'" message size: '+n.byteLength),"license-request"===r||"license-renewal"===r?o.renewLicense(e,n).cat)}):"license-release"===r?e.keySystem===J.FAIRPLAY&&(o.updateKeySession(e,Z("acknowledged")),o.removeSession(e)):o.warn('unhandled media key message type "'+r+'"')},e.mediaKeysSession.onkeystatuseschan)};var $=new Promise(function(t,e){c.on("error",e),c.on("keyStatus",function(i){i.startsWith("usable")?t():"output-restricted"===i?e(new n_({type:C.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===i?e(new n_({type:C.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+i+'"')):"expired"===i?e(Error("key expired while generating request")):o.warn('unhandled key status change "'+i+'"')})});return e.mediaKeysSession.generateRequest(i,r).th)}).cat)}).th$}).catt}).the})},e.onKeyStatusChange=function t(e){var i=this;e.mediaKeysSession.keyStatuses.forEat})},e.fetchServerCertificate=function t(e){var i=this.config,n=new i.loader(i),a=this.getServerCertificateUrl(e);return a?(this.log('Fetching server certificate for "'+e+'"'),new Promise(function(t,s){var o={responseType:"arraybuffer",url:a},l=i.certLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0};n.load(o,u,{onSuccess:function e(i,r,n,a){t(i.data)},onError:function t(i,n,l,u){s(new n_({type:C.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:l,response:r({url:o.url,data:void 0},i)},'"'+e+'" certificate request failed ('+a+"). Status: "+i.code+" ("+i.text+")"))},onTimeout:function t(i,r,n){s(new n_({type:C.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:n,response:{url:o.url,data:void 0}},'"'+e+'" certificate request timed out ('+a+")"))},onAbo)}})})):Promise.resolve()},e.setMediaKeysServerCertificate=function t(e,i,r){var n=this;return new Promi)})},e.renewLicense=function t(e,i){var r=this;return this.requestLicense(e,new Uint8Array(i)).th)})},e.unpackPlayReadyKeyMessage=function t(e,i){var r=String.fromCharCode.apply(null,new Uint16Array(i.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),i;var n=new DOMParser().parseFromString(r,"application/xml"),a=n.querySelectorAll("HttpHeader");if(a.length>0)for(var s=0,o=a.length;s<o;s++){var l,u,d,h=null==(u=(l=a[s]).querySelector("name"))?void 0:u.textContent,f=null==(d=l.querySelector("value"))?void 0:d.textContent;h&&f&&e.setRequestHeader(h,f)}var c=n.querySelector("Challenge"),$=null==c?void 0:c.textContent;if(!$)throw Error("Cannot find <Challenge> in key message");return Z(atob($))},e.setupLicenseXHR=function t(e,i,r,n){var a=this,s=this.config.licenseXhrSetup;return s?Promise.resolve().th)}).cat)}).th}}):(e.open("POST",i,!0),Promise.resolve({xhr:e,licenseChallenge:n}))},e.requestLicense=function t(e,i){var r=this,n=this.config.keyLoadPolicy.default;return new Promise(function(t,a){var s=r.getLicenseServerUrl(e.keySystem);r.log("Sending license request to URL: "+s);var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=function(){if(!r.hls||!e.mediaKeysSession)return a(Error("invalid state"));if(4===o.readyState){if(200===o.status){r._requestLicenseFailureCount=0;var l=o.response;r.log("License received "+(l instanceof ArrayBuffer?l.byteLength:l));var u=r.config.licenseResponseCallback;if(u)try{l=u.call(r.hls,o,s,e)}catch(d){r.error(d)}t(l)}else{var h=n.errorRetry,f=h?h.maxNumRetry:0;if(r._requestLicenseFailureCount++,r._requestLicenseFailureCount>f||o.status>=400&&o.status<500)a(new n_({type:C.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:s,data:void 0,code:o.status,text:o.statusText}},"License Request XHR failed ("+s+"). Status: "+o.status+" ("+o.statusText+")"));else{var c=f-r._requestLicenseFailureCount+1;r.warn("Retrying license request, "+c+" attempts left"),r.requestLicense(e,i).then(t,a)}}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,r.setupLicenseXHR(o,s,e,i).th)})})},e.onMediaAttached=function t(e,i){if(this.config.emeEnabled){var r=i.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}},e.onMediaDetached=function e(){var i=this,r=this.media,n=this.mediaKeySessions;r&&(r.removeEventListener("encrypted",this.onMediaEncrypted),r.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},t2.clearKeyUriToKeyIdMap();var a=n.length;t.CDMCleanupPromise=Promise.all(n.map(function(t){return i.removeSession(t)}).concat(null==r?void 0:r.setMediaKeys(null).cat)}))).th)}).catch(function(t){i.log("Could not close sessions and clear media keys: "+t)})},e.onManifestLoading=function t(){this.keyFormatPromise=null},e.onManifestLoaded=function t(e,i){var r=i.sessionKeys;if(r&&this.config.emeEnabled&&!this.keyFormatPromise){var n=r.reduce(function(t,e){return -1===t.indexOf(e.keyFormat)&&t.push(e.keyFormat),t},[]);this.log("Selecting key-system from session-keys "+n.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(n)}},e.removeSession=function t(e){var i=this,r=e.mediaKeysSession,n=e.licenseXhr;if(r){this.log("Remove licenses and keys and close session "+r.sessionId),r.onmessage=null,r.onkeystatuseschange=null,n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;var a=this.mediaKeySessions.indexOf(e);return a>-1&&this.mediaKeySessions.splice(a,1),r.remove().catch(function(t){i.log("Could not remove session: "+t)}).then(function(){return r.close()}).catch(function(t){i.log("Could not close session: "+t)})}},t}();nA.CDMCleanupPromise=void 0;var n_=function(t){function e(e,i){var r;return(r=t.call(this,i)||this).data=void 0,e.error||(e.error=Error(i)),r.data=e,e.err=e.error,r}return l(e,t),e}(f(Error)),nI={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},nD=function(){function t(e){var i=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiti0},this.onPlayi1},this.applyPlaylistDa}},this.applyFragmentData=function(t){try{var e=t.frag,r=i.hls.levels[e.level],n=i.getObjectType(e),a={d:1e3*e.duration,ot:n};(n===nI.VIDEO||n===nI.AUDIO||n==nI.MUXED)&&(a.br=r.bitrate/1e3,a.tb=i.getTopBandwidth(n)/1e3,a.bl=i.getBufferLength(n)),i.apply(t,a)}catch(s){M.warn("Could not generate segment CMCD data.",s)}},this.hls=e;var r=this.config=e.config,n=r.cmcd;null!=n&&(r.pLoader=this.createPlaylistLoader(),r.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||t.uuid(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.registerListeners())}var e=t.prototype;return e.registerListeners=function t(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHED,this.onMediaDetached,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this)},e.unregisterListeners=function t(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHED,this.onMediaDetached,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this)},e.destroy=function t(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},e.onMediaAttached=function t(e,i){this.media=i.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},e.onMediaDetached=function t(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},e.onBufferCreated=function t(e,i){var r,n;this.audioBuffer=null==(r=i.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(n=i.tracks.video)?void 0:n.buffer},e.createData=function t(){var e;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},e.apply=function e(i,r){void 0===r&&(r={}),o(r,this.createData());var n=r.ot===nI.INIT||r.ot===nI.VIDEO||r.ot===nI.MUXED;if(this.starved&&n&&(r.bs=!0,r.su=!0,this.starved=!1),null==r.su&&(r.su=this.buffering),this.useHeaders){var a=t.toHeaders(r);if(!Object.keys(a).length)return;i.headers||(i.headers={}),o(i.headers,a)}else{var s=t.toQuery(r);if(!s)return;i.url=t.appendQueryToUri(i.url,s)}},e.getObjectType=function t(e){var i=e.type;return"subtitle"===i?nI.TIMED_TEXT:"initSegment"===e.sn?nI.INIT:"audio"===i?nI.AUDIO:"main"===i?this.hls.audioTracks.length?nI.VIDEO:nI.MUXED:void 0},e.getTopBandwidth=function t(e){var i=0,r=this.hls;if(e===nI.AUDIO)s=r.audioTracks;else{var n=r.maxAutoLevel,a=n>-1?n+1:r.levels.length;s=r.levels.slice(0,a)}for(var s,o,l=$(s);!(o=l()).done;){var u=o.value;u.bitrate>i&&(i=u.bitrate)}return i>0?i:NaN},e.getBufferLength=function t(e){var i=this.hls.media,r=e===nI.AUDIO?this.audioBuffer:this.videoBuffer;return r&&i?1e3*ia.bufferInfo(r,i.currentTime,this.config.maxBufferHole).len:NaN},e.createPlaylistLoader=function t(){var e=this.config.pLoader,i=this.applyPlaylistData,r=e||this.config.loader;return function(){function t(t){this.loader=void 0,this.loader=new r(t)}var e=t.prototype;return e.destroy=function t(){this.loader.destroy()},e.abort=function t(){this.loader.abort()},e.load=function t(e,r,n){i(e),this.loader.load(e,r,n)},a(t,[{key:"stats",get:function t(){return this.loader.stats}},{key:"context",get:function t(){return this.loader.context}}]),t}()},e.createFragmentLoader=function t(){var e=this.config.fLoader,i=this.applyFragmentData,r=e||this.config.loader;return function)}var e=t.prototype;return e.destroy=function t(){this.loader.destroy()},e.abo)},e.load=function t(e,r,n){i(e),this.loader.load(e,r,n)},a(t,[{key:"stats",get:function t(){return this.loader.stats}},{key:"context",get:function t(){return this.loader.context}}]),t}()},t.uuid=function t(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)},t.serialize=function t(e){for(var i,r=[])},a=function t(e){return 100*n(e/100)},s={br:n,d:n,bl:a,dl:a,mtp:a,n)},rtp:a,tb:n},o=Object.keys(e||{}).sort(),l=$(o);!(i=l()).done;){var u,d=i.value,h=e[d];if(!Number.isNaN(u=h)&&null!=u&&""!==u&&!1!==u&&("v"!==d||1!==h)&&("pr"!=d||1!==h)){var f=s[d];f&&(h=f(h));var c=typeof h,g=void 0;g="ot"===d||"sf"===d||"st"===d?d+"="+h:"boolean"===c?d:"number"===c?d+"="+h:d+"="+JSON.stringify(h),r.push(g)}}return r.join(",")},t.toHeaders=function e(i){for(var r=Object.keys(i),n={},a=["Object","Request","Session","Status"],s=[{},{},{},{}],o={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},l=0,u=r;l<u.length;l++){var d=u[l];s[null!=o[d]?o[d]:1][d]=i[d]}for(var h=0;h<s.length;h++){var f=t.serialize(s[h]);f&&(n["CMCD-"+a[h]]=f)}return n},t.toQue)},t.appendQueryToUri=function t(e,i){if(!i)return e;var r=e.includes("?")?"&":"?";return""+e+r+i},t}(),nk=function)}var e=t.prototype;return e.registerListeners=function t(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.ERROR,this.onError,this)},e.unregisterListeners=function t(){var e=this.hls;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.ERROR,this.onError,this))},e.startLoad=function t(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){var e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}},e.stopLoad=function t(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()},e.clearTimeout=function t(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)},e.destroy=function t(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null},e.removeLevel=function t(e){var i=this.levels;i&&(this.levels=i.filte}))},e.onManifestLoading=function t(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null},e.onManifestLoaded=function t(e,i){var r=i.contentSteering;null!==r&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())},e.onManifestParsed=function t(e,i){this.audioTracks=i.audioTracks,this.subtitleTracks=i.subtitleTracks},e.onError=function t(e,i){var r=i.errorAction;if((null==r?void 0:r.action)===eK.SendAlternateToPenaltyBox&&r.flags===e4.MoveAllAlternatesMatchingHost){var n=this.pathwayPriority,a=this.pathwayId;this.penalizedPathways[a]||(this.penalizedPathways[a]=performance.now()),!n&&this.levels&&(n=this.levels.redut},[])),n&&n.length>1&&(this.updatePathwayPriority(n),r.resolved=this.pathwayId!==a)}},e.filterParsedLevels=function t(e){this.levels=e;var i=this.getLevelsForPathway(this.pathwayId);if(0===i.length){var r=e[0].pathwayId;this.log("No levels found in Pathway "+this.pathwayId+'. Setting initial Pathway to "'+r+'"'),i=this.getLevelsForPathway(r),this.pathwayId=r}return i.length!==e.length?(this.log("Found "+i.length+"/"+e.length+' levels in Pathway "'+this.pathwayId+'"'),i):e},e.getLevelsForPathway=function t(e){return null===this.levels?[]:this.levels.filtd})},e.updatePathwayPriority=function t(e){this.pathwayPriority=e;var i,r=this.penalizedPathways,n=performance.now();Object.keys(r).forEa]});for(var a=0;a<e.length;a++){var s=e[a];if(!r[s]){if(s===this.pathwayId)return;var o=this.hls.nextLoadLevel,l=this.hls.levels[o];if((i=this.getLevelsForPathway(s)).length>0){this.log('Setting Pathway to "'+s+'"'),this.pathwayId=s,eO(i),this.hls.trigger(b.LEVELS_UPDATED,{levels:i});var u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log("Unstable Pathways change from bitrate "+l.bitrate+" to "+u.bitrate),this.hls.nextLoadLevel=o);break}}}},e.clonePathways=function t(e){var i=this,r=this.levels;if(r){var n={},a={};e.forEa}})}},e.loadSteeringManifest=function t(e){var i,r=this,n=this.hls.config,a=n.loader;this.loader&&this.loader.destroy(),this.loader=new a(n);try{i=new self.URL(e)}catch(s){this.enabled=!1,this.log("Failed to parse Steering Manifest URI: "+e);return}if("data:"!==i.protocol){var o=0|(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+o)}var l={responseType:"json",url:i.href},u=n.steeringManifestLoadPolicy.default,d=u.errorRetry||u.timeoutRetry||{},h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:d.maxNumRetry||0,retryDelay:d.retryDelayMs||0,maxRetryDelay:d.maxRetryDelayMs||0};this.log("Requesting steering manifest: "+i),this.loader.load(l,h,{onSuccess:function t(e,n,a,s){r.log('Loaded steering manifest: "'+i+'"');var o=e.data;if(1!==o.VERSION){r.log("Steering VERSION "+o.VERSION+" not supported!");return}r.updated=performance.now(),r.timeToLoad=o.TTL;var l=o["RELOAD-URI"],u=o["PATHWAY-CLONES"],d=o["PATHWAY-PRIORITY"];if(l)try{r.uri=new self.URL(l,i).href}catch(h){r.enabled=!1,r.log("Failed to parse Steering Manifest RELOAD-URI: "+l);return}r.scheduleRefresh(r.uri||a.url),u&&r.clonePathways(u);var f={steeringManifest:o,url:i.toString()};r.hls.trigger(b.STEERING_MANIFEST_LOADED,f),d&&r.updatePathwayPriority(d)},onError:function t(e,i,n,a){if(r.log("Error loading steering manifest: "+e.code+" "+e.text+" ("+i.url+")"),r.stopLoad(),410===e.code){r.enabled=!1,r.log("Steering manifest "+i.url+" no longer available");return}var s=1e3*r.timeToLoad;if(429===e.code){var o=r.loader;if("function"==typeof(null==o?void 0:o.getResponseHeader)){var l=o.getResponseHeader("Retry-After");l&&(s=1e3*parseFloat(l))}r.log("Steering manifest "+i.url+" rate limited");return}r.scheduleRefresh(r.uri||i.url,s)},onTimeout:function t(e,i,n){r.log("Timeout loading steering manifest ("+i.url+")"),r.scheduleRefresh(r.uri||i.url)}})},e.scheduleRefresh=function t(e,i){var r=this;void 0===i&&(i=1e3*this.timeToLoad),this.clearTimeout(),this.reloadTimer=self.setTimeo)},i)},t}}var n8=/^age:\s*[\d.]+\s*$/im,nw=function0}var e=t.prototype;return e.destroy=function t(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null,this.stats=null},e.abortInternal=function t(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))},e.abort=function t(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},e.load=function t(e,i,r){if(this.stats.loading.start)throw Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=i,this.callbacks=r,this.loadInternal()},e.loadInternal=function t(){var e=this,i=this.config,r=this.context;if(i&&r){var n=this.loader=new self.XMLHttpRequest,a=this.stats;a.loading.first=0,a.loaded=0,a.aborted=!1;var s=this.xhrSetup;s?Promise.resolve().th)}).cat)}).th)}).cat)}):this.openAndSendXhr(n,r,i)}},e.openAndSendXhr=function t(e,i,r){e.readyState||e.open("GET",i.url,!0);var n=i.headers,a=r.loadPolicy,s=a.maxTimeToFirstByteMs,o=a.maxLoadTimeMs;if(n)for(var l in n)e.setRequestHeader(l,n[l]);i.rangeEnd&&e.setRequestHeader("Range","bytes="+i.rangeStart+"-"+(i.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=i.responseType,self.clearTimeout(this.requestTimeout),r.timeout=s&&k(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()},e.readystatechange=function t(){var e=this.context,i=this.loader,r=this.stats;if(e&&i){var n=i.readyState,a=this.config;if(!r.aborted&&n>=2&&(0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),4===n)){self.clearTimeout(this.requestTimeout),i.onreadystatechange=null,i.onprogress=null;var s=i.status,o="text"!==i.responseType;if(s>=200&&s<300&&(o&&i.response||null!==i.responseText)){r.loading.end=Math.max(self.performance.now(),r.loading.first);var l=o?i.response:i.responseText,u="arraybuffer"===i.responseType?l.byteLength:l.length;if(r.loaded=r.total=u,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first),!this.callbacks)return;var d=this.callbacks.onProgress;if(d&&d(r,e,l,i),!this.callbacks)return;var h={url:i.responseURL,data:l,code:s};this.callbacks.onSuccess(h,r,e,i)}else{var f,c=a.loadPolicy.errorRetry,$=r.retry;e0(c,$,!1,{url:e.url,data:void 0,code:s})?this.retry(c):(M.error(s+" while loading "+e.url),this.callbacks.onError({code:s,text:i.statusText},e,i,r))}}}},e.loadtimeout=function t(){var e=null==(i=this.config)?void 0:i.loadPolicy.timeoutRetry;if(e0(e,this.stats.retry,!0))this.retry(e);else{M.warn("timeout while loading "+(null==(r=this.context)?void 0:r.url));var i,r,n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}},e.retry=function t(e){var i=this.context,r=this.stats;this.retryDelay=eB(e,r.retry),r.retry++,M.warn((status?"HTTP Status "+status:"Timeout")+" while loading "+(null==i?void 0:i.url)+", retrying "+r.retry+"/"+e.maxNumRetry+" in "+this.retryDelay+"ms"),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)},e.loadprogress=function t(e){var i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total)},e.getCacheAge=function t(){var e=null;if(this.loader&&n8.test(this.loader.getAllResponseHeaders())){var i=this.loader.getResponseHeader("age");e=i?parseFloat(i):null}return e},e.getResponseHeader=function t(e){return this.loader&&RegExp("^"+e+":\\s*[\\d.]+\\s*$","im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null},t}(),nP=/(\d+)-(\d+)\/(\d+)/,nF=functionY}var e=t.prototype;return e.destroy=function t(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null},e.abortInternal=function t(){var e=this.response;this.controller&&!(null!=e&&e.ok)&&(this.stats.aborted=!0,this.controller.abort())},e.abort=function t(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},e.load=function t(e,i,r){var n,a,s,l=this,u=this.stats;if(u.loading.start)throw Error("Loader can only be used once.");u.loading.start=self.performance.now();var d=(n=e,a=this.controller.signal,s={method:"GET",mode:"cors",credentials:"same-origin",signal:a,headers:new self.Headers(o({},n.headers))},n.rangeEnd&&s.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),s),h=r.onProgress,f="arraybuffer"===e.responseType,c=f?"byteLength":"length",$=i.loadPolicy,g=$.maxTimeToFirstByteMs,v=$.maxLoadTimeMs;this.context=e,this.config=i,this.callbacks=r,this.request=this.fetchSetup(e,d),self.clearTimeout(this.requestTimeout),i.timeout=g&&k(g)?g:v,this.requestTimeout=self.setTimeout(function(){l.abortInternal(),r.onTimeout(u,e,l.response)},i.timeout),self.fetch(this.request).then(function(t){l.response=l.loader=t;var n=Math.max(self.performance.now(),u.loading.start);if(self.clearTimeout(l.requestTimeout),i.timeout=v,l.requestTimeout=self.setTimeo)},v-(n-u.loading.start)),!t.ok){var a=t.status,s=t.statusText;throw new nN(s||"fetch, bad network response",a,t)}return(u.loading.first=n,u.total=function t(e){var i=e.get("Content-Range");if(i){var r=function t(e){var i=nP.exec(e);if(i)return parseInt(i[2])-parseInt(i[1])+1}(i);if(k(r))return r}var n=e.get("Content-Length");if(n)return parseInt(n)}(t.headers)||u.total,h&&k(i.highWaterMark))?l.loadProgressively(t,u,e,i.highWaterMark,h):f?t.arrayBuffer():"json"===e.responseType?t.json():t.text()}).then(function(t){var n=l.response;if(!n)throw Error("loader destroyed");self.clearTimeout(l.requestTimeout),u.loading.end=Math.max(self.performance.now(),u.loading.first);var a=t[c];a&&(u.loaded=u.total=a);var s={url:n.url,data:t,code:n.status};h&&!k(i.highWaterMark)&&h(u,e,t,n),r.onSuccess(s,u,e,n)}).cat}})},e.getCacheAge=function t(){var e=null;if(this.response){var i=this.response.headers.get("age");e=i?parseFloat(i):null}return e},e.getResponseHeader=function t(e){return this.response?this.response.headers.get(e):null},e.loadProgressively=function t(e,i,r,n,a){void 0===n&&(n=0);var s=new iL,o=e.body.getReader();retu)}()},t})}var e}(f(Error)),nM=/\s/,nB={newCue:function t(e,i,r,n){for(var a=[],s=self.VTTCue||self.TextTrackCue,o=0;o<n.rows.length;o++)if(l=n.rows[o],d=!0,h=0,f="",!l.isEmpty()){for(var l,u,d,h,f,c,$=0;$<l.chars.length;$++)nM.test(l.chars[$].uchar)&&d?h++:(f+=l.chars[$].uchar,d=!1);l.cueStartTime=i,i===r&&(r+=1e-4),h>=16?h--:h++;var g=ni(f.trim()),v=nl(i,r,g);null!=e&&null!=(c=e.cues)&&c.getCueById(v)||((u=new s(i,r,g)).id=v,u.line=o+1,u.align="left",u.position=10+Math.min(80,10*Math.floor(8*h/32)),a.push(u))}return e&&a.length&&(a.soe}),a.forEa)})),a}},nU=r(r({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:nw,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:e9,bufferController:rO,capLevelController:rP,errorController:e3,fpsController:nL,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:ta,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:nB,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:rk,subtitleTrackController:rC,timelineController:nT,audioStreamController:rA,audioTrackController:r_,emeController:nA,cmcdController:nD,contentSteeringController:nk}),n0=function(r}l(e,t);var i=e.prototype;return i._registerListeners=function t(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.ERROR,this.onError,this)},i._unregisterListeners=function t(){var e=this.hls;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.ERROR,this.onError,this)},i.destroy=function e(){this._unregisterListeners(),this.steering=null,this.resetLevels(),t.prototype.destroy.call(this)},i.stopLoad=function e(){this._levels.forEa0}),t.prototype.stopLoad.call(this)},i.resetLevels=function t(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1},i.onManifestLoading=function t(e,i){this.resetLevels()},i.onManifestLoaded=function t(e,i){var r,n=this,a=[],s={};i.levels.forEach(function(t){var e,i=t.attrs;(null==(e=t.audioCodec)?void 0:e.indexOf("mp4a.40.34"))!==-1&&(p||(p=/chrome|firefox/i.test(navigator.userAgent)),p&&(t.audioCodec=void 0)),t.audioCodec&&(t.audioCodec=tz(t.audioCodec,n.hls.config.preferManagedMediaSource));var o=i.AUDIO,l=i.CODECS,u=i["FRAME-RATE"],d=i["PATHWAY-ID"],h=i.RESOLUTION,f=i.SUBTITLES,c=""+(d||".")+"-"+t.bitrate+"-"+h+"-"+u+"-"+l;(r=s[c])?r.addFallback(t):(r=new eD(t),s[c]=r,a.push(r)),ek(r,"audio",o),ek(r,"text",f)}),this.filterAndSortMediaOptions(a,i)},i.filterAndSortMediaOptions=function t(e,i){var r=this,n=this.hls.config.preferManagedMediaSource,a=[],s=[],o=!1,l=!1,u=!1,d=e.filter(function(t){var e=t.audioCodec,i=t.videoCodec,r=t.width,a=t.height,s=t.unknownCodecs;return o||(o=!!(r&&a)),l||(l=!!i),u||(u=!!e),!(null!=s&&s.length)&&(!e||tY(e,"audio",n))&&(!i||tY(i,"video",n))});if((o||l)&&u&&(d=d.filter(function(t){var e,i=t.videoCodec,r=t.videoRange,n=t.width,a=t.height;return(!!i||!!(n&&a))&&!!(e=r)&&eA.indexOf(e)>-1})),0===d.length){Promise.resolve().then(function(){if(r.hls){e.length&&r.warn("One or more CODECS in variant not supported: "+JSON.stringify(e[0].attrs));var t=Error("no level with compatible codecs found in manifest");r.hls.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:i.url,error:t,reason:t.message})}});return}i.audioTracks&&(a=i.audioTracks.filt)}),n2(a)),i.subtitles&&n2(s=i.subtitles);var h=d.slice(0);d.so0});var f=h[0];if(this.steering&&(d=this.steering.filterParsedLevels(d)).length!==h.length){for(var c=0;c<h.length;c++)if(h[c].pathwayId===d[0].pathwayId){f=h[c];break}}this._levels=d;for(var $=0;$<d.length;$++)if(d[$]===f){this._firstLevel=$;var g,v=f.bitrate,m=this.hls.bandwidthEstimate;if(this.log("manifest loaded, "+d.length+" level(s) found, first bitrate: "+v),(null==(g=this.hls.userConfig)?void 0:g.abrEwmaDefaultEstimate)===void 0){var p=Math.min(v,this.hls.config.abrEwmaDefaultEstimateMax);p>m&&m===nU.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=p)}break}var y=u&&!l,T={levels:d,audioTracks:a,subtitleTracks:s,sessionData:i.sessionData,sessionKeys:i.sessionKeys,firstLevel:this._firstLevel,stats:i.stats,audio:u,video:l,altAudio:!y&&a.some(function(t){return!!t.url})};this.hls.trigger(b.MANIFEST_PARSED,T),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)},i.onError=function t(e,i){!i.fatal&&i.context&&i.context.type===eu.LEVEL&&i.context.level===this.level&&this.checkRetry(i)},i.onFragBuffered=function t(e,i){var r=i.frag;if(void 0!==r&&r.type===ed.MAIN){var n=r.elementaryStreams;if(!Object.keys(n).so]}))return;var a=this._levels[r.level];null!=a&&a.loadError&&(this.log("Resetting level error count of "+a.loadError+" on frag buffered"),a.loadError=0)}},i.onLevelLoaded=function t(e,i){var r,n,a=i.level,s=i.details,o=this._levels[a];if(!o){this.warn("Invalid level index "+a),null!=(n=i.deliveryDirectives)&&n.skip&&(s.deltaUpdateFailed=!0);return}a===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0),this.playlistLoaded(a,i,o.details)):null!=(r=i.deliveryDirectives)&&r.skip&&(s.deltaUpdateFailed=!0)},i.onAudioTrackSwitched=function t(e,i){var r=this.currentLevel;if(r){var n=this.hls.audioTracks[i.id].groupId;if(r.audioGroupIds&&r.audioGroupId!==n){for(var a=-1,s=0;s<r.audioGroupIds.length;s++)if(r.audioGroupIds[s]===n){a=s;break}-1!==a&&a!==r.urlId&&(r.urlId=a,this.canLoad&&this.startLoad())}}},i.loadPlaylist=function e(i){t.prototype.loadPlaylist.call(this);var r=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){var a=n.urlId,s=n.uri;if(i)try{s=i.addDirectives(s)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}var l=n.attrs["PATHWAY-ID"];this.log("Loading level index "+r+((null==i?void 0:i.msn)!==void 0?" at sn "+i.msn+" part "+i.part:"")+" with"+(l?" Pathway "+l:"")+" URI "+(a+1)+"/"+n.url.length+" "+s),this.clearTimer(),this.hls.trigger(b.LEVEL_LOADING,{url:s,level:r,id:a,deliveryDirectives:i||null})}},i.removeLevel=function t(e,i){var r,n=thisi},s=this._levels.filt)});eO(s),this._levels=s,this.currentLevelIndex>-1&&null!=(r=this.currentLevel)&&r.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(b.LEVELS_UPDATED,{levels:s})},i.onLevelsUpdated=function t(e,i){var r=i.levels;this._levels=r},i.checkMaxAutoUpdated=function t(){var e=this.hls,i=e.autoLevelCapping,r=e.maxAutoLevel,n=e.maxHdcpLevel;this._maxAutoLevel!==r&&(this._maxAutoLevel=r,this.hls.trigger(b.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:i,levels:this.levels,maxAutoLevel:r,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))},a(e,[{key:"levels",gs}},{key:"level",get:function t(){return this.currentLevelIndex},set:function t(e){var i=this._levels;if(0!==i.length){if(e<0||e>=i.length){var r=Error("invalid level idx"),n=e<0;if(this.hls.trigger(b.ERROR,{type:C.OTHER_ERROR,details:w.LEVEL_SWITCH_ERROR,level:e,fatal:n,error:r,reason:r.message}),n)return;e=Math.min(e,i.length-1)}var a=this.currentLevelIndex,s=this.currentLevel,l=s?s.attrs["PATHWAY-ID"]:void 0,u=i[e],d=u.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=u,a!==e||!u.details||!s||l!==d){this.log("Switching to level "+e+" ("+(u.height?u.height+"p ":"")+(u.videoRange?u.videoRange+" ":"")+(u.codecSet?u.codecSet+" ":"")+"@"+u.bitrate+")"+(d?" with Pathway "+d:"")+" from level "+a+(l?" with Pathway "+l:""));var h=o({},u,{level:e,maxBitrate:u.maxBitrate,attrs:u.attrs,uri:u.uri,urlId:u.urlId});delete h._attrs,delete h._urlId,delete h._avgBitrate,this.hls.trigger(b.LEVEL_SWITCHING,h);var f=u.details;if(!f||f.live){var c=this.switchParams(u.uri,null==s?void 0:s.details);this.loadPlaylist(c)}}}}},{key:"manualLevel",get:function t(){return this.manualLevelIndex},s)}},{key:"firstLevel",get:function t(){return this._firstLevel},set:function t(e){this._firstLevel=e}},{key:"startLevel",get:function t(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel},set:function t(e){this._startLevel=e}},{key:"nextLoadLevel",gl},s)}}]),e}(e)}var nG=functiont}var e=t.prototype;return e.abort=function t(e){for(var i in this.keyUriToKeyInfo){var r,n=this.keyUriToKeyInfo[i].loader;if(n){if(e&&e!==(null==(r=n.context)?void 0:r.frag.type))return;n.abort()}}},e.detach=function t(){for(var e in this.keyUriToKeyInfo){var i=this.keyUriToKeyInfo[e];(i.mediaKeySessionContext||i.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}},e.destroy=function t(){for(var e in this.detach(),this.keyUriToKeyInfo){var i=this.keyUriToKeyInfo[e].loader;i&&i.destroy()}this.keyUriToKeyInfo={}},e.createKeyLoadError=function t(e,i,r,n,a){return void 0===i&&(i=w.KEY_LOAD_ERROR),new iv({type:C.NETWORK_ERROR,details:i,fatal:!1,frag:e,response:a,error:r,networkDetails:n})},e.loadClear=function t(e,i){var r=this;if(this.emeController&&this.config.emeEnabled)for(var n=e.sn,a=e.cc,s=0;s<i.length&&!function t(){var e=i[s];if(a<=e.cc&&("initSegment"===n||"initSegment"===e.sn||n<e.sn))return r.emeController.selectKeySystemFormat(e).then(function(t){e.setKeyFormat(t)}),1}();s++);},e.load=function t(e){var i=this;return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).th)}):this.loadInternal(e)},e.loadInternal=function t(e,i){i&&e.setKeyFormat(i);var r,n,a,s=e.decryptdata;if(!s){var o=Error(i?"Expected frag.decryptdata to be defined after setting format "+i:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,w.KEY_LOAD_ERROR,o))}var l=s.uri;if(!l)return Promise.reject(this.createKeyLoadError(e,w.KEY_LOAD_ERROR,Error('Invalid key URI: "'+l+'"')));var u=this.keyUriToKeyInfo[l];if(null!=(r=u)&&r.decryptdata.key)return s.key=u.decryptdata.key,Promise.resolve({frag:e,keyInfo:u});if(null!=(n=u)&&n.keyLoadPromise)switch(null==(a=u.mediaKeySessionContext)?void 0:a.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return u.keyLoadPromise.th}})}switch(u=this.keyUriToKeyInfo[l]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":if("identity"===s.keyFormat)return this.loadKeyHTTP(u,e);return this.loadKeyEME(u,e);case"AES-128":return this.loadKeyHTTP(u,e);default:return Promise.reject(this.createKeyLoadError(e,w.KEY_LOAD_ERROR,Error('Key supplied with unsupported METHOD: "'+s.method+'"')))}},e.loadKeyEME=function t(e,i){var r={frag:i,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var n=this.emeController.loadKey(r);if(n)return(e.keyLoadPromise=n.thr})).catt})}return Promise.resolve(r)},e.loadKeyHTTP=function t(e,i){var n=this,a=this.config,s=new a.loader(a);return i.keyLoader=e.loader=s,e.keyLoadPromise=new Promise(function(t,o){var l={keyInfo:e,frag:i,responseType:"arraybuffer",url:e.decryptdata.uri},u=a.keyLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0};s.load(l,d,{onSuccess:function e(i,r,a,s){var l=a.frag,u=a.keyInfo,d=a.url;if(!l.decryptdata||u!==n.keyUriToKeyInfo[d])return o(n.createKeyLoadError(l,w.KEY_LOAD_ERROR,Error("after key load, decryptdata unset or changed"),s));u.decryptdata.key=l.decryptdata.key=new Uint8Array(i.data),l.keyLoader=null,u.loader=null,t({frag:l,keyInfo:u})},onError:function t(e,a,s,u){n.resetLoader(a),o(n.createKeyLoadError(i,w.KEY_LOAD_ERROR,Error("HTTP Error "+e.code+" loading key "+e.text),s,r({url:l.url,data:void 0},e)))},onTimeout:function t(e,r,a){n.resetLoader(r),o(n.createKeyLoadError(i,w.KEY_LOAD_TIMEOUT,Error("key loading timed out"),a))},onAbort:function t(e,r,a){n.resetLoader(r),o(n.createKeyLoadError(i,w.INTERNAL_ABORTED,Error("key loading aborted"),a))}})})},e.resetLoader=function t(e){var i=e.frag,r=e.keyInfo,n=e.url,a=r.loader;i.keyLoader===a&&(i.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[n],a&&a.destroy()},t}r}var n6=functionr}var e=t.prototype;return e.destroy=function t(){this.media=null,this.hls=this.fragmentTracker=null},e.poll=function t(e,i){var r=this.config,n=this.media,a=this.stalled;if(null!==n){var s=n.currentTime,o=n.seeking,l=this.seeking&&!o,u=!this.seeking&&o;if(this.seeking=o,s!==e){if(this.moved=!0,null!==a){if(this.stallReported){var d=self.performance.now()-a;M.warn("playback not stuck anymore @"+s+", after "+Math.round(d)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(u||l){this.stalled=null;return}if((!n.paused||o)&&!n.ended&&0!==n.playbackRate&&ia.getBuffered(n).length){var h=ia.bufferInfo(n,s,0),f=h.nextStart||0;if(o){var c=h.len>2,$=!f||i&&i.start<=s||f-s>2&&!this.fragmentTracker.getPartialFragment(s);if(c||$)return;this.moved=!1}if(!this.moved&&null!==this.stalled){if(!(h.len>0)&&!f)return;var g,v=Math.max(f,h.start||0)-s,m=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,p=(null==m?void 0:null==(g=m.details)?void 0:g.live)?2*m.details.targetduration:2,y=this.fragmentTracker.getPartialFragment(s);if(v>0&&(v<=p||y)){n.paused||this._trySkipBufferHole(y);return}}var T=self.performance.now();if(null===a){this.stalled=T;return}var x=T-a;if(o||!(x>=250)||(this._reportStall(h),this.media)){var E=ia.bufferInfo(n,s,r.maxBufferHole);this._tryFixBufferStall(E,x)}}}},e._tryFixBufferStall=function t(e,i){var r=this.config,n=this.fragmentTracker,a=this.media;if(null!==a){var s=a.currentTime,o=n.getPartialFragment(s);if(o&&(this._trySkipBufferHole(o)||!this.media))return;(e.len>r.maxBufferHole||e.nextStart&&e.nextStart-s<r.maxBufferHole)&&i>1e3*r.highBufferWatchdogPeriod&&(M.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},e._reportStall=function t(e){var i=this.hls,r=this.media;if(!this.stallReported&&r){this.stallReported=!0;var n=Error("Playback stalling at @"+r.currentTime+" due to low buffer ("+JSON.stringify(e)+")");M.warn(n.message),i.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.BUFFER_STALLED_ERROR,fatal:!1,error:n,buffer:e.len})}},e._trySkipBufferHole=function t(e){var i=this.config,r=this.hls,n=this.media;if(null===n)return 0;var a=n.currentTime,s=ia.bufferInfo(n,a,0),o=a<s.start?s.start:s.nextStart;if(o){var l=s.len<=i.maxBufferHole,u=s.len>0&&s.len<1&&n.readyState<3,d=o-a;if(d>0&&(l||u)){if(d>i.maxBufferHole){var h=this.fragmentTracker,f=!1;if(0===a){var c=h.getAppendedFrag(0,ed.MAIN);c&&o<c.end&&(f=!0)}if(!f){var $=e||h.getAppendedFrag(a,ed.MAIN);if($){for(var g=!1,v=$.end;v<o;){var m=h.getPartialFragment(v);if(m)v+=m.duration;else{g=!0;break}}if(g)return 0}}}var p=Math.max(o+.05,a+.1);if(M.warn("skipping hole, adjusting currentTime from "+a+" to "+p),this.moved=!0,this.stalled=null,n.currentTime=p,e&&!e.gap){var y=Error("fragment loaded with buffer holes, seeking from "+a+" to "+p);r.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,frag:e})}return p}}return 0},e._tryNudgeBuffer=function t(){var e=this.config,i=this.hls,r=this.media,n=this.nudgeRetry;if(null!==r){var a=r.currentTime;if(this.nudgeRetry++,n<e.nudgeMaxRetry){var s=a+(n+1)*e.nudgeOffset,o=Error("Nudging 'currentTime' from "+a+" to "+s);M.warn(o.message),r.currentTime=s,i.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{var l=Error("Playhead still not moving while enough data buffered @"+a+" after "+e.nudgeMaxRetry+" nudges");M.error(l.message),i.trigger(b.ERROR,{type:C.MEDIA_ERROR,details:w.BUFFER_STALLED_ERROR,error:l,fatal:!0})}}},t}(),nK=function(n}l(e,t);var i=e.prototype;return i._registerListeners=function t(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(b.ERROR,this.onError,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)},i._unregisterListeners=function t(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(b.ERROR,this.onError,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this)},i.onHandlerDestroyi)},i.startLoad=function t(e){if(this.levels){var i=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){var n=r.startLevel;-1===n&&(r.config.testBandwidth&&this.levels.length>1?(n=0,this.bitrateTest=!0):n=r.firstAutoLevel),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}i>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @"+i.toFixed(3)),e=i),this.state=iE.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=iE.STOPPED},i.stopLoad=function e(){this._forceStartLoad=!1,t.prototype.stopLoad.call(this)},i.doTick=function t(){switch(this.state){case iE.WAITING_LEVEL:var e,i=this.levels,r=this.level,n=null==i?void 0:null==(e=i[r])?void 0:e.details;if(n&&(!n.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(n))break;this.state=iE.IDLE}else this.hls.nextLoadLevel!==this.level&&(this.state=iE.IDLE);break;case iE.FRAG_LOADING_WAITING_RETRY:var a,s=self.performance.now(),o=this.retryDate;(!o||s>=o||null!=(a=this.media)&&a.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=iE.IDLE)}this.state===iE.IDLE&&this.doTickIdle(),this.onTickEnd()},i.onTickEnd=function e(){t.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},i.doTickIdle=function t(){var e=this.hls,i=this.levelLastLoaded,r=this.levels,n=this.media,a=e.config,s=e.nextLoadLevel;if(null!==i&&(n||!this.startFragRequested&&a.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&null!=r&&r[s]){var o=r[s],l=this.getMainFwdBufferInfo();if(null!==l){var u=this.getLevelDetails();if(u&&this._streamEnded(l,u)){var d={};this.altAudio&&(d.type="video"),this.hls.trigger(b.BUFFER_EOS,d),this.state=iE.ENDED;return}e.loadLevel!==s&&-1===e.manualLevel&&this.log("Adapting to level "+s+" from level "+this.level),this.level=e.nextLoadLevel=s;var h=o.details;if(!h||this.state===iE.WAITING_LEVEL||h.live&&this.levelLastLoaded!==s){this.level=s,this.state=iE.WAITING_LEVEL;return}var f=l.len,c=this.getMaxBufferLength(o.maxBitrate);if(!(f>=c)){this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);var $=this.backtrackFragment?this.backtrackFragment.start:l.end,g=this.getNextFragment($,h);if(this.couldBacktrack&&!this.fragPrevious&&g&&"initSegment"!==g.sn&&this.fragmentTracker.getState(g)!==eJ.OK){var v,m=(null!=(v=this.backtrackFragment)?v:g).sn-h.startSN,p=h.fragments[m-1];p&&g.cc===p.cc&&(g=p,this.fragmentTracker.removeFragment(p))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(g&&this.isLoopLoading(g,$)){if(!g.gap){var y=this.audioOnly&&!this.altAudio?W.AUDIO:W.VIDEO,T=(y===W.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;T&&this.afterBufferFlushed(T,y,ed.MAIN)}g=this.getNextFragmentLoopLoading(g,h,l,ed.MAIN,c)}g&&(!g.initSegment||g.initSegment.data||this.bitrateTest||(g=g.initSegment),this.loadFragment(g,o,$))}}}},i.loadFragment=function e(i,r,n){var a=this.fragmentTracker.getState(i);this.fragCurrent=i,a===eJ.NOT_LOADED||a===eJ.PARTIAL?"initSegment"===i.sn?this._loadInitSegment(i,r):this.bitrateTest?(this.log("Fragment "+i.sn+" of level "+i.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(i,r)):(this.startFragRequested=!0,t.prototype.loadFragment.call(this,i,r,n)):this.clearTrackerIfNeeded(i)},i.getBufferedFr)},i.followingBufferedFrag=function t(e){return e?this.getBufferedFrag(e.end+.5):null},i.immediateLevelSwitch=function t(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},i.nextLevelSwitch=function t(){var e=this.levels,i=this.media;if(null!=i&&i.readyState){var r,n=this.getAppendedFrag(i.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);var a=this.getLevelDetails();if(null!=a&&a.live){var s=this.getMainFwdBufferInfo();if(!s||s.len<2*a.targetduration)return}if(!i.paused&&e){var o=e[this.hls.nextLoadLevel],l=this.fragLastKbps;r=l&&this.fragCurrent?this.fragCurrent.duration*o.maxBitrate/(1e3*l)+1:0}else r=0;var u=this.getBufferedFrag(i.currentTime+r);if(u){var d=this.followingBufferedFrag(u);if(d){this.abortCurrentFrag();var h=d.maxStartPTS?d.maxStartPTS:d.start,f=d.duration,c=Math.max(u.end,h+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,f*(this.couldBacktrack?.5:.125)),f*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}},i.abortCurrentFrag=function t(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case iE.KEY_LOADING:case iE.FRAG_LOADING:case iE.FRAG_LOADING_WAITING_RETRY:case iE.PARSING:case iE.PARSED:this.state=iE.IDLE}this.nextLoadPosition=this.getLoadPosition()},i.flushMainBuff)},i.onMediaAttached=function e(i,r){t.prototype.onMediaAttached.call(this,i,r);var n=r.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new n6(this.config,n,this.fragmentTracker,this.hls)},i.onMediaDetaching=function e(){var i=this.media;i&&this.onvplaying&&this.onvseeked&&(i.removeEventListener("playing",this.onvplaying),i.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),t.prototype.onMediaDetaching.call(this)},i.onMediaPlayi)},i.onMediaSeeked=function t(){var e=this.media,i=e?e.currentTime:null;k(i)&&this.log("Media seeked to "+i.toFixed(3));var r=this.getMainFwdBufferInfo();if(null===r||0===r.len){this.warn('Main forward buffer length on "seeked" event '+(r?r.len:"empty")+")");return}this.tick()},i.onManifestLoading=function t(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(b.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1},i.onManifestParsed=function t(e,i){var r,n,a,s=!1,o=!1;i.levels.forEa)}),this.audioCodecSwitch=s&&o&&"function"!=typeof(null==(a=n1())?void 0:null==(n=a.prototype)?void 0:n.changeType),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=i.levels,this.startFragRequested=!1},i.onLevelLoading=function t(e,i){var r=this.levels;if(r&&this.state===iE.IDLE){var n=r[i.level];(!n.details||n.details.live&&this.levelLastLoaded!==i.level||this.waitForCdnTuneIn(n.details))&&(this.state=iE.WAITING_LEVEL)}},i.onLevelLoaded=function t(e,i){var r,n=this.levels,a=i.level,s=i.details,o=s.totalduration;if(!n){this.warn("Levels were reset while loading level "+a);return}this.log("Level "+a+" loaded ["+s.startSN+","+s.endSN+"]"+(s.lastPartSn?"[part-"+s.lastPartSn+"-"+s.lastPartIndex+"]":"")+", cc ["+s.startCC+", "+s.endCC+"] duration:"+o);var l=n[a],u=this.fragCurrent;u&&(this.state===iE.FRAG_LOADING||this.state===iE.FRAG_LOADING_WAITING_RETRY)&&(u.level!==i.level||u.urlId!==l.urlId)&&u.loader&&this.abortCurrentFrag();var d=0;if(s.live||null!=(r=l.details)&&r.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;d=this.alignPlaylists(s,l.details)}if(l.details=s,this.levelLastLoaded=a,this.hls.trigger(b.LEVEL_UPDATED,{details:s,level:a}),this.state===iE.WAITING_LEVEL){if(this.waitForCdnTuneIn(s))return;this.state=iE.IDLE}this.startFragRequested?s.live&&this.synchronizeToLiveEdge(s):this.setStartPosition(s,d),this.tick()},i._handleFragmentLoadProgress=function t(e){var i,r=e.frag,n=e.part,a=e.payload,s=this.levels;if(!s){this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered");return}var o=s[r.level],l=o.details;if(!l){this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset"),this.fragmentTracker.removeFragment(r);return}var u=o.videoCodec,d=l.PTSKnown||!l.live,h=null==(i=r.initSegment)?void 0:i.data,f=this._getAudioCodec(o),c=this.transmuxer=this.transmuxer||new rR(this.hls,ed.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),$=n?n.index:-1,g=new is(r.level,r.sn,r.stats.chunkCount,a.byteLength,$,-1!==$),v=this.initPTS[r.cc];c.push(a,h,f,u,r,n,l.totalduration,d,g,v)},i.onAudioTrackSwitching=function t(e,i){var r=this.altAudio;if(!i.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n&&(this.log("Switching to main audio track, cancel main fragment load"),n.abortRequests(),this.fragmentTracker.removeFragment(n)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var a=this.hls;r&&(a.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),a.trigger(b.AUDIO_TRACK_SWITCHED,i)}},i.onAudioTrackSwitched=function t(e,i){var r=i.id,n=!!this.hls.audioTracks[r].url;if(n){var a=this.videoBuffer;a&&this.mediaBuffer!==a&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=a)}this.altAudio=n,this.tick()},i.onBufferCreated=function t(e,i){var r,n,a=i.tracks,s=!1;for(var o in a){var l=a[o];if("main"===l.id){if(n=o,r=l,"video"===o){var u=a[o];u&&(this.videoBuffer=u.buffer)}}else s=!0}s&&r?(this.log("Alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},i.onFragBuffered=function t(e,i){var r=i.frag,n=i.part;if(!r||r.type===ed.MAIN){if(this.fragContextChanged(r)){this.warn("Fragment "+r.sn+(n?" p: "+n.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),this.state===iE.PARSED&&(this.state=iE.IDLE);return}var a=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),"initSegment"!==r.sn&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}},i.onError=function t(e,i){var r;if(i.fatal){this.state=iE.ERROR;return}switch(i.details){case w.FRAG_GAP:case w.FRAG_PARSING_ERROR:case w.FRAG_DECRYPT_ERROR:case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ed.MAIN,i);break;case w.LEVEL_LOAD_ERROR:case w.LEVEL_LOAD_TIMEOUT:case w.LEVEL_PARSING_ERROR:i.levelRetry||this.state!==iE.WAITING_LEVEL||(null==(r=i.context)?void 0:r.type)!==eu.LEVEL||(this.state=iE.IDLE);break;case w.BUFFER_APPEND_ERROR:case w.BUFFER_FULL_ERROR:if(!i.parent||"main"!==i.parent)return;if(i.details===w.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(i)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case w.INTERNAL_EXCEPTION:this.recoverWorkerError(i)}},i.checkBuffer=function t(){var e=this.media,i=this.gapController;if(e&&i&&e.readyState){if(this.loadedmetadata||!ia.getBuffered(e).length){var r=this.state!==iE.IDLE?this.fragCurrent:null;i.poll(this.lastCurrentTime,r)}this.lastCurrentTime=e.currentTime}},i.onFragLoadEmergencyAborted=function t(){this.state=iE.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},i.onBufferFlushed=function t(e,i){var r=i.type;if(r!==W.AUDIO||this.audioOnly&&!this.altAudio){var n=(r===W.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,r,ed.MAIN),this.tick()}},i.onLevelsUpdated=function t(e,i){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=i.levels},i.swapAudioCodp},i.seekToStartPos=function t(){var e=this.media;if(e){var i=e.currentTime,r=this.startPosition;if(r>=0&&i<r){if(e.seeking){this.log("could not seek to "+r+", already seeking at "+i);return}var n=ia.getBuffered(e),a=(n.length?n.start(0):0)-r;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+a+" to match buffer start"),r+=a,this.startPosition=r),this.log("seek to target start position "+r+" from current time "+i),e.currentTime=r}}},i._getAudioCodec=function t(e){var i=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&i&&(this.log("Swapping audio codec"),i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),i},i._loadBitrateTestFrag=function t(e,i){var r=this;e.bitrateTest=!0,this._doFragLoad(e,i).th}})},i._handleTransmuxComplete=function t(e){var i,r="main",n=this.hls,a=e.remuxResult,s=e.chunkMeta,o=this.getCurrentContext(s);if(!o){this.resetWhenMissingContext(s);return}var l=o.frag,u=o.part,d=o.level,h=a.video,f=a.text,c=a.id3,$=a.initSegment,g=d.details,v=this.altAudio?void 0:a.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=iE.PARSING,$){if(null!=$&&$.tracks){var m=l.initSegment||l;this._bufferInitSegment(d,$.tracks,m,s),n.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:r,tracks:$.tracks})}var p=$.initPTS,y=$.timescale;k(p)&&(this.initPTS[l.cc]={baseTime:p,timescale:y},n.trigger(b.INIT_PTS_FOUND,{frag:l,id:r,initPTS:p,timescale:y}))}if(h&&g&&"initSegment"!==l.sn){var T=g.fragments[l.sn-1-g.startSN],x=l.sn===g.startSN,E=!T||l.cc>T.cc;if(!1!==a.independent){var S=h.startPTS,L=h.endPTS,R=h.startDTS,A=h.endDTS;if(u)u.elementaryStreams[h.type]={startPTS:S,endPTS:L,startDTS:R,endDTS:A};else if(h.firstKeyFrame&&h.independent&&1===s.id&&!E&&(this.couldBacktrack=!0),h.dropped&&h.independent){var _=this.getMainFwdBufferInfo(),I=(_?_.end:this.getLoadPosition())+this.config.maxBufferHole,D=h.firstKeyFramePTS?h.firstKeyFramePTS:S;if(x||!(I<D-this.config.maxBufferHole)||E)E&&(l.gap=!0);else{this.backtrack(l);return}l.setElementaryStreamInfo(h.type,l.start,L,l.start,A,!0)}l.setElementaryStreamInfo(h.type,S,L,R,A),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,u,s,x||E)}else if(x||E)l.gap=!0;else{this.backtrack(l);return}}if(v){var C=v.startPTS,w=v.endPTS,P=v.startDTS,F=v.endDTS;u&&(u.elementaryStreams[W.AUDIO]={startPTS:C,endPTS:w,startDTS:P,endDTS:F}),l.setElementaryStreamInfo(W.AUDIO,C,w,P,F),this.bufferFragmentData(v,l,u,s)}if(g&&null!=c&&null!=(i=c.samples)&&i.length){var O={id:r,frag:l,details:g,samples:c.samples};n.trigger(b.FRAG_PARSING_METADATA,O)}if(g&&f){var N={id:r,frag:l,details:g,samples:f.samples};n.trigger(b.FRAG_PARSING_USERDATA,N)}},i._bufferInitSegment=function t(e,i,r,n){var a=this;if(this.state===iE.PARSING){this.audioOnly=!!i.audio&&!i.video,this.altAudio&&!this.audioOnly&&delete i.audio;var s=i.audio,o=i.video,l=i.audiovideo;if(s){var u=e.audioCodec,d=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==s.metadata.channelCount&&-1===d.indexOf("firefox")&&(u="mp4a.40.5")),u&&-1!==u.indexOf("mp4a.40.5")&&-1!==d.indexOf("android")&&"audio/mpeg"!==s.container&&(u="mp4a.40.2",this.log("Android: force audio codec to "+u)),e.audioCodec&&e.audioCodec!==u&&this.log('Swapping manifest audio codec "'+e.audioCodec+'" for "'+u+'"'),s.levelCodec=u,s.id="main",this.log("Init audio buffer, container:"+s.container+", codecs[selected/level/parsed]=["+(u||"")+"/"+(e.audioCodec||"")+"/"+s.codec+"]")}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log("Init video buffer, container:"+o.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+o.codec+"]")),l&&this.log("Init audiovideo buffer, container:"+l.container+", codecs[level/parsed]=["+e.codecs+"/"+l.codec+"]"),this.hls.trigger(b.BUFFER_CODECS,i),Object.keys(i).forEa)}),this.tickImmediate()}},i.getMainFwdBufferInfo=function t(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,ed.MAIN)},i.backtrack=function t(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=iE.IDLE},i.checkFragmentChanged=function t(){var e=this.media,i=null;if(e&&e.readyState>1&&!1===e.seeking){var r=e.currentTime;if(ia.isBuffered(e,r)?i=this.getAppendedFrag(r):ia.isBuffered(e,r+.1)&&(i=this.getAppendedFrag(r+.1)),i){this.backtrackFragment=null;var n=this.fragPlaying,a=i.level;n&&i.sn===n.sn&&n.level===a&&i.urlId===n.urlId||(this.fragPlaying=i,this.hls.trigger(b.FRAG_CHANGED,{frag:i}),n&&n.level===a||this.hls.trigger(b.LEVEL_SWITCHED,{level:a}))}}},a(e,[{key:"nextLevel",get:function t(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function t(){var e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}},{key:"currentProgramDateTime",get:function t(){var e=this.media;if(e){var i=e.currentTime,r=this.currentFrag;if(r&&k(i)&&k(r.programDateTime)){var n=r.programDateTime+(i-r.start)*1e3;return new Date(n)}}return null}},{key:"currentLevel",get:function t(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function t(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function t(){return this._forceStartLoad}}]),e}(iS),n4=function(){function t(e){void 0===e&&(e={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new rx,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,N(e.debug||!1,"Hls instance");var i,n,a=this.config=function t(e,i){if((i.liveSyncDurationCount||i.liveMaxLatencyDurationCount)&&(i.liveSyncDuration||i.liveMaxLatencyDuration))throw Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==i.liveMaxLatencyDurationCount&&(void 0===i.liveSyncDurationCount||i.liveMaxLatencyDurationCount<=i.liveSyncDurationCount))throw Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==i.liveMaxLatencyDuration&&(void 0===i.liveSyncDuration||i.liveMaxLatencyDuration<=i.liveSyncDuration))throw Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var n=function t(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(t):Object.keys(e).redui},{}):e}(e),a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEa)}),r(r({},n),i)}(t.DefaultConfig,e);this.userConfig=e,a.progressive&&(i=a,n=i.loader,n!==nF&&n!==nw?(M.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):function t(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(i.loader=nF,i.progressive=!0,i.enableSoftwareAES=!0,M.log("[config]: Progressive streaming enabled, using FetchLoader")));var s=a.abrController,o=a.bufferController,l=a.capLevelController,u=a.errorController,d=a.fpsController,h=new u(this),f=this.abrController=new s(this),c=this.bufferController=new o(this),$=this.capLevelController=new l(this),g=new d(this),v=new ec(this),m=new eS(this),p=a.contentSteeringController,y=p?new p(this):null,T=this.levelController=new n0(this,y),x=new it(this),E=new nG(this.config),S=this.streamController=new nK(this,x,E);$.setStreamController(S),g.setStreamController(S);var L=[v,T,S];y&&L.splice(1,0,y),this.networkControllers=L;var R=[f,c,$,g,m,x];this.audioTrackController=this.createController(a.audioTrackController,L);var A=a.audioStreamController;A&&L.push(new A(this,x,E)),this.subtitleTrackController=this.createController(a.subtitleTrackController,L);var _=a.subtitleStreamController;_&&L.push(new _(this,x,E)),this.createController(a.timelineController,R),E.emeController=this.emeController=this.createController(a.emeController,R),this.cmcdController=this.createController(a.cmcdController,R),this.latencyController=this.createController(eL,R),this.coreComponents=R,L.push(h);var I=h.onErrorOut;"function"==typeof I&&this.on(b.ERROR,I,h)}t.isSupported=function t(){return function t(){var e=tH();if(!e)return!1;var i=n1(),r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!i||i.prototype&&"function"==typeof i.prototype.appendBuffer&&"function"==typeof i.prototype.remove;return!!r&&!!n}()};var e=t.prototype;return e.createController=function t(e,i){if(e){var r=new e(this);return i&&i.push(r),r}return null},e.on=function t(e,i,r){void 0===r&&(r=this),this._emitter.on(e,i,r)},e.once=function t(e,i,r){void 0===r&&(r=this),this._emitter.once(e,i,r)},e.removeAllListeners=function t(e){this._emitter.removeAllListeners(e)},e.off=function t(e,i,r,n){void 0===r&&(r=this),this._emitter.off(e,i,r,n)},e.listeners=function t(e){return this._emitter.listeners(e)},e.em)},e.trigger=function t(e,i){if(this.config.debug)return this.emit(e,e,i);try{return this.emit(e,e,i)}catch(r){if(M.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;var n=e===b.ERROR;this.trigger(b.ERROR,{type:C.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,fatal:n,event:e,error:r}),this.triggeringException=!1}}return!1},e.listenerCou)},e.destroy=function t(){M.log("destroy"),this.trigger(b.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(t){return t.destroy()}),this.networkControllers.length=0,this.coreComponents.forEa)}),this.coreComponents.length=0;var e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null},e.attachMedia=function t(e){M.log("attachMedia"),this._media=e,this.trigger(b.MEDIA_ATTACHING,{media:e})},e.detachMedia=function t(){M.log("detachMedia"),this.trigger(b.MEDIA_DETACHING,void 0),this._media=null},e.loadSource=function t(e){this.stopLoad();var i=this.media,r=this.url,n=this.url=D.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,M.log("loadSource:"+n),i&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(i)),this.trigger(b.MANIFEST_LOADING,{url:e})},e.startLoad=function t(e){void 0===e&&(e=-1),M.log("startLoad("+e+")"),this.started=!0,this.networkControllers.forEach(function(t){t.startLoad(e)})},e.stopLoad=function t(){M.log("stopLoad"),this.started=!1,this.networkControllers.forEa)})},e.resumeBuffering=function t(){this.started&&this.networkControllers.forEa)})},e.pauseBuffering=function t(){this.networkControllers.forEa)})},e.swapAudioCodec=function t(){M.log("swapAudioCodec"),this.streamController.swapAudioCodec()},e.recoverMediaError=function t(){M.log("recoverMediaError");var e=this._media;this.detachMedia(),e&&this.attachMedia(e)},e.removeLevel=function t(e,i){void 0===i&&(i=0),this.levelController.removeLevel(e,i)},a(t,[{key:"levels",get:function t(){var e;return this.levelController.levels||[]}},{key:"currentLevel",get:function t(){return this.streamController.currentLevel},set:function t(e){M.log("set currentLevel:"+e),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function t(){return this.streamController.nextLevel},set:function t(e){M.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function t(){return this.levelController.level},set:function t(e){M.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function t(){return this.levelController.nextLoadLevel},set:function t(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",g)},set:function t(e){M.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function t(){var e=this.levelController.startLevel;return -1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e},set:function t(e){M.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function t(){return this.config.capLevelToPlayerSize},s)}},{key:"autoLevelCapping",get:function t(){return this._autoLevelCapping},set:function t(e){this._autoLevelCapping!==e&&(M.log("set autoLevelCapping:"+e),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}},{key:"bandwidthEstimate",get:function t(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN},set:function t(e){this.abrController.resetEstimator(e)}},{key:"ttfbEstimate",gN}},{key:"maxHdcpLevel",get:function t(){return this._maxHdcpLevel},set:function t(e){var i;i=e,eR.indexOf(i)>-1&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}},{key:"autoLevelEnabled",gl}},{key:"manualLevel",get:function t(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function t(){var e=this.levels,i=this.config.minAutoBitrate;if(!e)return 0;for(var r=e.length,n=0;n<r;n++)if(e[n].maxBitrate>=i)return n;return 0}},{key:"maxAutoLevel",get:function t(){var e,i=this.levels,r=this.autoLevelCapping,n=this.maxHdcpLevel;if(e=-1===r&&i&&i.length?i.length-1:r,n)for(var a=e;a--;){var s=i[a].attrs["HDCP-LEVEL"];if(s&&s<=n)return a}return e}},{key:"firstAutoLevel",get:function t(){return this.abrController.firstAutoLevel}},{key:"nextAutoLevel",get:function t(){return this.abrController.nextAutoLevel},set:function t(e){this.abrController.nextAutoLevel=e}},{key:"playingDate",get:function t(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",g)}},{key:"allAudioTracks",get:function t(){var e=this.audioTrackController;return e?e.allAudioTracks:[]}},{key:"audioTracks",get:function t(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function t(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function t(e){var i=this.audioTrackController;i&&(i.audioTrack=e)}},{key:"allSubtitleTracks",get:function t(){var e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}},{key:"subtitleTracks",g]}},{key:"subtitleTrack",g1},set:function t(e){var i=this.subtitleTrackController;i&&(i.subtitleTrack=e)}},{key:"media",ga}},{key:"subtitleDisplay",gy},s)}},{key:"lowLatencyMode",get:function t(){return this.config.lowLatencyMode},se}},{key:"liveSyncPosition",get:function t(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function t(){return this.latencyController.latency}},{key:"maxLatency",get:function t(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function t(){return this.latencyController.targetLatency}},{key:"drift",get:function t(){return this.latencyController.drift}},{key:"forceStartLoad",gd}}],[{key:"version",g"}},{key:"Events",get:function t(){return b}},{key:"ErrorTypes",get:function t(){return C}},{key:"ErrorDetails",gw}},{key:"DefaultConfig",gU},si}}]),t}();return n4.defaultConfig=void 0,n4},"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(i="undefined"!=typeof globalThis?globalThis:i||self).Hls=r()}(!1);
        