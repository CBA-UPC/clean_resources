(self.webpackChunktama_web=self.webpackChunktama_web||[]).push([[3771],{18958:29039:(e,t,r)=>{"use strict";r.d(t,{Nf:()=>c,Xp:()=>l,wJ:()=>o});var a=r(22006),i=r.n(a),n=r(717),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(t,r)=>{t({type:n.Op,payload:{timestamp:Date.now(),selectedTabIndex:e}});var{applicationState:a}=r();a.sidebar.isOpen&&i().on()}},l=()=>(e,t)=>{e({type:n.bH,payload:{timestamp:Date.now()}});var{applicationState:r}=t();r.sidebar.isOpen||i().off()},c=,44074:(e,t,r)=>{"use strict";r.d(t,{DP:()=>l,n1:()=>d,pA:()=>c});var a=r(18274),i=r(55752),n=r.n(i),o=r(10151),l=e=>({type:o.Iv,payload:{currentHistoryData:e}}),c=u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0;return{type:o.Lc,payload:{historyEntryIds:e,currentPageNum:t,hasMore:r,requestType:a}}},d=(0,a.H)({ttl:200},(e=>(t,r)=>{var a=r().historyState,i=n()(a,["historyArticleMap","historyArticle"],[]);if(0===i.length)return t(u([]));t({type:o.pn});var l=n()(a,["drawerHistoryMap","currentPageNum"],1),c="more"===e?l+1:l,d=i.slice(0,10*c).map((e=>e.entry_id)),f=10*c<i.length;return t(u(d,c,f,e))}))},34010:(e,t,r)=>{"use strict";r.d(t,{Kg:()=>O});var a=r(41185),i=r(66062),n=r(18274),o=r(75649),l=r.n(o),c=r(55752),u=r.n(c),d=r(5663),f=r.n(d),s=r(16176),p=r(36509),m=r(73614),y=r(33811),b=r(44074),g=r(68006),w=r(79751),h=r(70317),v=r(43077);nction S(e){return{type:v.X4,payload:{historyRecommend:e}}}var O=(0,n.H)({ttl:5e3},(()=>function(){var e=(0,i.Z)((function*(e,t,r){var{fetchr:a}=r;e({type:v.Dn});var n=(0,h.jl)(t());n&&(yield e((0,g.HZ)(s.XN.INIT)));var o=u()(t(),["historyState","historyArticleMap","historyArticle"],[]);if(0===o.length)return e(S([]));var c=u()(t(),["followFeedState","feedMap","feed"],[]).map((e=>e.amebaId));if(n&&c.length>=10)return null;var d=u()(t(),["userState","sessionUser","amebaId"],""),p=[];if(o.forEach((e=>{var t=e.ameba_id;if(-1===c.indexOf(t)&&d!==t){var r=p.findIndex((e=>e.amebaId===t));if(-1!==r){var a=p[r].viewCount;p[r].viewCount=a+1}else p.push({amebaId:t,viewCount:1})}})),0===p.length)return e(S([]));var _=l()(p,"viewCount","desc").slice(0,5);if(n)try{yield Promise.all(_.map(function(){var t=(0,i.Z)((function*(t){try{yield e((0,w.fU)(t.amebaId))}catch(r){console.warn(r,"[DEBUG] failed to fetch follow info in historyRecommend")}}));return function(e){return t.apply(this,arguments)}}()));var O=u()(t(),["followState","followMap"],{});_=_.filter((e=>!u()(O,[e.amebaId,"isFollowing"],!1)))}catch(M){console.warn(M,"[DEBUG] historyRecommendAction#fetchHistoryRecommendRequest::error")}try{var T=u()(t(),["historyRecommendState","historyRecommendMap","historyRecommend"],[]),P=yield Promise.all(_.map(function(){var r=(0,i.Z)((function*(r){var i=T.findIndex(();if(-1!==i)return T[i];yield e((0,m.Rs)(r.amebaId));var n=u()(t(),["bloggerState","bloggerMap",r.amebaId],{});if(f()(n)||!n.blog){var l=o.filter((e=>e.ameba_id!==r.amebaId));return e((0,b.pA)(l)),{}}return a.read("blogLatestEntry").params({amebaId:r.amebaId}).end().then((e=>e.data?e.data:{ameba_id:r.amebaId}))}));return function(e){return r.apply(this,arguments)}}())),A=(yield Promise.all(P.map(function(){var r=(0,i.Z)((function*(r){var{ameba_id:a,blog_id:i,entry_id:n}=r;if(!a)return{};var o=u()(t(),["bloggerState","bloggerMap",a],{}),l=u()(t(),["bloggerState","blogMap",o.blog],{});if(f()(o)||f()(l))return{};i&&n&&(yield e((0,y.x0)(i,n)));var c=u()(t(),["entryState","entryMap",n],{});return f()(c)||!c.entry_id?I(I({},r),{},{is_official:o.attribute.isOfficial,blog_title:l.blog_title,profile_image:o.profile.image_filepath}):I(I(I(I({},r),{},{is_official:o.attribute.isOfficial,blog_title:l.blog_title},c.image_url?{image_url:c.image_url}:{}),{},{profile_image:o.profile.image_filepath,reblog_flg:c.reblog_flg||!1},c.clip?{clip:c.clip}:{}),{},{entry_title:c.entry_title,publish_flg:c.publish_flg})}));return function(e){return r.apply(this,arguments)}}()))).filter((e=>!f()(e))).map(();return e(S(A))}catch(D){return e(function(e){return{type:v.R2,payload:{error:e},error:!0}}(D))}}));return function(t,r,a){return e.apply(this,arguments)}}()));unction P(e){return{type:v.WH,payload:{error:e},error:!0}}(0,n.H)({ttl:5e3},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){var t=(0,i.Z)((function*(t,r,a){var{fetchr:n}=a;if((0,h.jl)(r()))return null;var o=u()(r(),["historyState","historyArticleMap","historyArticle"],[]);if(0===o.length)return t(T([]));var c=u()(r(),["followFeedState","feedMap","feed"],[]).map((),d=[];if(o.forEach((t=>{var r=t.ameba_id;if(e!==r&&-1===c.indexOf(r)){var a=d.findIndex(();if(-1!==a){var i=d[a].viewCount;d[a].viewCount=i+1}else d.push({amebaId:r,viewCount:1})}})),0===d.length)return t(T([]));var s=l()(d.filter((),"viewCount","desc").slice(0,10);try{var g=yield Promise.all(s.map(function(){var e=(0,i.Z)((function*(e){if(yield t((0,m.Rs)(e.amebaId)),!u()(r(),["bloggerState","bloggerMap",e.amebaId,"blog"],"")){var a=o.filter(();return t((0,b.pA)(a)),{}}return n.read("blogLatestEntry").params({amebaId:e.amebaId}).end().then((t=>t.data?t.data:{ameba_id:e.amebaId}))}));return function(t){return e.apply(this,arguments)}}())),w=g.map((e=>f()(e)||e.entry_created_datetime?(0,p.oK)(e,90)?{}:e:{})).filter((e=>!f()(e))),v=(yield Promise.all(w.map(function(){var e=(0,i.Z)((function*(e){var{ameba_id:a,blog_id:i,entry_id:n}=e;if(!a)return{};var o=u()(r(),["bloggerState","bloggerMap",a],{}),l=u()(r(),["bloggerState","blogMap",o.blog],{});if(f()(o)||f()(l))return{};i&&n&&(yield t((0,y.x0)(i,n)));var c=u()(r(),["entryState","entryMap",n],{});return f()(c)||!c.entry_id?I(I({},e),{},{is_official:o.attribute.isOfficial,blog_title:l.blog_title,profile_image:o.profile.image_filepath}):I(I(I(I({},e),{},{is_official:o.attribute.isOfficial,bloggerType:o.attribute.bloggerType,blog_title:l.blog_title},c.image_url?{image_url:c.image_url}:{}),{},{profile_image:o.profile.image_filepath,reblog_flg:c.reblog_flg||!1},c.clip?{clip:c.clip}:{}),{},{entry_title:c.entry_title,publish_flg:c.publish_flg})}));return ()))).filter(();return t(T(v))}catch(_){return t(P(_))}}));return ()}))},36509:(e,t,r)=>{"use strict";r.d(t,{IT:()=>m,O4:()=>y,WW:()=>w,oK:);var a=r(5663),i=r.n(a),n=r(43177),o=r.n(n),l=r(12943),c=r.n(l),u=r(16884),d=r(75457),f=r(77948),s=r(18958),p=r(19008);function m(e,t){return"amember"===t.publish_flg||"2"===t.publish_flg?(0,u.Z)(d.Z.AmemberEntry,{amebaId:e,entryId:t.entry_id}):(0,u.Z)(d.Z.Entry,{amebaId:e,entryId:t.entry_id})}function y(e,t){var r=m(e,t);return"https://cs.ameba.jp/inq/inquiry/vio?targetAmebaId=".concat(e,"&url=").concat(r,"&service=blog")}function b(e,t){if(i()(e)||!t)return!1;if(!i()(e)&&!e.entry_created_datetime)return!1;var r=o()(new Date,f.Z.DEFAULT_DATE),a=o()(e.entry_created_datetime,f.Z.DEFAULT_DATE);return c()(r,a)>t}function g(e){!function(e){window.YT&&window.YT.Player?e():(window.onYouTubeIframeAPIReady=()=>{window.YT.loaded&&window.YT.Player?e():window.YT.ready&&"function"==typeof window.YT.ready&&window.YT.ready(()},(0,p.v)("https://www.youtube.com/iframe_api").catch((e=>{console.warn(e)})))}((()=>{!function(e){var t=e.querySelectorAll('iframe[src^="https://www.youtube.com/embed/"]'),r=[],a=e=>{e.data===window.YT.PlayerState.PLAYING&&r.forEach((t=>{t!==e.target&&t.pauseVideo()}))};t.forEach((e=>{var t=new window.YT.Player(e,{events:{onStateChange:a}});r.push(t)}))}(e)}))}function w(e){e&&(null!==e.querySelector("blockquote.twitter-tweet")&&(0,p.v)("https://platform.twitter.com/widgets.js").then((()=>{window.twttr&&window.twttr.widgets&&window.twttr.widgets.load()})).catch((e=>{console.warn(e)})),null!==e.querySelector('blockquote[class="instagram-media"]')&&(0,p.v)("https://platform.instagram.com/en_US/embeds.js").then((()=>{window.instgrm&&window.instgrm.Embeds&&window.instgrm.Embeds.process()})).catch((e=>{console.warn(e)})),null!==e.querySelector(".pickCreative_root")&&(0,p.v)("".concat(window.process.env.HTTP_PATH_STAT,"/ameblo/pick/pick_sdk-").concat(s.C,".js")).then(().catch((),null!==e.querySelector('iframe[src^="https://www.youtube.com/embed/"]')&&g(e))}},12943:]);