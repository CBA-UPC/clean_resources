"use strict";(self.webpackChunkWPS_Drive=self.webpackChunkWPS_Drive||[]).push([[1585],{51585:function(t,e,i){i.r(e),i.d(e,{default:function(){return h}});var o=i(4942),n=i(20629),r=i(69034),a=i(80862),s=i(89777),p=i(19731),c=i(47189),u=i(89602);function d(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?d(Object(i),!0).forEach((function(e){(0,o.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var l={components:{InfoShape:a.Z,CloseIcon:s.Z},data:function(){return{tipsShow:!1,currentGroupId:0,inviteLink:"",companyInfo:{groupName:"",companyName:"",companyId:0,groupId:0},groupMigratedInfo:{}}},computed:m(m({},(0,n.rn)({user:"user"})),{},{taskType:function(){return"migrate"===this.groupMigratedInfo.origin_group_type?"个人团队":"共享文件夹"},tipsText:function(){return{prefix:"当前".concat(this.taskType,"下文档已被拥有者移入"),suffix:"，可进入该企业团队查看文档"}}}),watch:{$route:{handler:function(t){var e=t.name,i=t.params,o=Number(i.tid);this.disableTips(),o&&["Team","Group"].includes(e)&&(this.currentGroupId=o,this.checkGroupMigrated(o))},deep:!0,immediate:!0}},methods:{checkGroupMigrated:function(t){var e=this,i=this.$route.params.fid;t&&!i&&this.$store.dispatch(u.pPD,{windowKey:"group_import_personal",params:{group_id:t}}).then((function(i){i.data.policy_id&&e.$store.dispatch("GET",{url:"team-migrate/api/v1/task/upgrade_record",host:"vas2t",params:{group_id:t}}).then((function(i){var o=i.data;if("ok"===o.result){var n=o.data;e.groupMigratedInfo=Object.freeze(n),"alert"!==n.show&&"top"!==n.show||e.fetchCompanyGroupInfo(n.invite_key).then((function(i){var o=i.companyName,r=i.groupName,a=e,s={groupName:r,companyName:o,groupId:n.dist_group_id,companyId:n.dist_company_id};switch(n.show){case"alert":e.getMigratedDialog().then((function(e){e.show({groupId:t,userId:a.user.userid,propsCompanyInfo:m(m({},s),{},{creator:{userid:n.op_user_id,nickname:n.op_user_name,avatar:n.op_user_avatar}}),propsInviteLink:n.invite_url,propsOriginGroupType:n.origin_group_type,closeCallback:function(){a.showTips(m(m({},s),{},{inviteLink:n.invite_url}))}})}));break;case"top":e.showTips({companyName:o,groupName:r,groupId:n.dist_group_id,companyId:n.dist_company_id,inviteLink:n.invite_url})}})).catch((function(){e.disableTips()}))}else e.disableTips()}))}))},showTips:function(t){var e=this,i=t.companyName,o=t.groupName,n=t.inviteLink,r=t.companyId,a=t.groupId;this.companyInfo={groupName:o,companyName:i,companyId:r,groupId:a},this.inviteLink=n,this.$nextTick((function(){e.tipsShow=!0,e.eventReport("tip_show")}))},fetchCompanyGroupInfo:function(t){return t?(0,c.v9i)(t).then((function(t){var e=t.corp_name,i=t.name;return{creator:(t.members||[]).find((function(t){return"creator"===t.role}))||{},companyName:e,groupName:i}})):Promise.reject()},go2CompanyGroup:function(){var t,e,i=this;this.eventReport("click");var o=!!window.cefQuery||!!window.wpsQuery,n=(null===(t=this.$ua)||void 0===t?void 0:t.docs)||(null===(e=this.$ua)||void 0===e?void 0:e.kdesktop);o||n?window.open(this.inviteLink):setTimeout((function(){location.href=i.inviteLink}),400)},hideTips:function(){this.tipsShow=!1,this.$store.dispatch("POST",{url:"team-migrate/api/v1/task/upgrade_record_hide",host:"vas2t",data:{group_id:this.currentGroupId,show:"hide"}}),this.eventReport("tip_close")},getMigratedDialog:function(){return new Promise((function(t){i.e(2038).then(i.bind(i,12038)),i.e(821).then(i.bind(i,90821)).then((function(e){var i=e.default;t(i)}))}))},disableTips:function(){this.groupMigratedInfo.dist_group_id&&(Object.assign(this.$data,this.$options.data()),this.getMigratedDialog().then((function(t){t.close()})))},eventReport:function(t){r.Z.onEvent("group_import_personal",{operate:t,user_id:"".concat(this.user.userid),source:(0,p.at)(window),personal_group_id:"".concat(this.currentGroupId),company_id:"".concat(this.companyInfo.companyId),enterprise_group_id:"".concat(this.companyInfo.groupId)})}}},f=(0,i(51900).Z)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.tipsShow?i("div",{staticClass:"group-migrated-tips"},[i("div",{staticClass:"content"},[i("info-shape",{attrs:{fill:["var(--kd-color-public-normal, #3B64FC)"]}}),i("div",{staticClass:"text"},[i("span",{staticClass:"fix"},[t._v(t._s(t.tipsText.prefix))]),i("div",{staticClass:"name"},[i("div",{staticClass:"quotes"},[t._v("「")]),i("div",{staticClass:"inner",attrs:{title:t.companyInfo.companyName}},[t._v(" "+t._s(t.companyInfo.companyName)+" ")]),i("div",{staticClass:"quotes"},[t._v("」")])]),i("strong",{staticClass:"fix"},[t._v("-")]),i("div",{staticClass:"name"},[i("div",{staticClass:"quotes"},[t._v("「")]),i("div",{staticClass:"inner",attrs:{title:t.companyInfo.groupName}},[t._v(" "+t._s(t.companyInfo.groupName)+" ")]),i("div",{staticClass:"quotes"},[t._v("」")])]),i("span",{staticClass:"fix"},[t._v(t._s(t.tipsText.suffix))])]),i("kd-button",{attrs:{type:"primary"},on:{click:t.go2CompanyGroup}},[t._v("进入企业团队")]),i("close-icon",{staticClass:"icon-close",attrs:{fill:["var(--kd-color-icon-secondary, #757575)"]},nativeOn:{click:function(e){return t.hideTips.apply(null,arguments)}}})],1)]):t._e()}),[],!1,null,"59f3aee4",null),h=f.exports}}]);
"}},[t._v("成员")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("   ∟ company_uid")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("成员 id")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("   ∟ user_name")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用户名")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("   ∟ avatar")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("头像")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v(" ∟ dept_objects")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("array")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("部门")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("   ∟ dept_id")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("部门 id")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("   ∟ dept_name")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("部门名称")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v(" ∟ perm")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("object")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("权限类型")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("   ∟ name")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("权限类型名称:visit")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("   ∟ state")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("integer")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("权限状态:1-允许")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v(" ∟ rule_id")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("权限范围对应的规则 id")])])])]),t._v(" "),a("h2",{attrs:{id:"38dc3a78"}},[t._v("响应体示例")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ranges"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"user_objects"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"company_uid"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"user_name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"avatar"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dept_objects"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dept_id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dept_name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"perm"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"state"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rule_id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);