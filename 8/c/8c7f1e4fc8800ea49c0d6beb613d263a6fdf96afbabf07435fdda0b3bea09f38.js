var ta="undefined"!=typeof window&&window.ta||{},define,require;ta.rollupAmdShim=ta.rollupAmdShim||function(){function e(e,i){var t,o,d,f;if(!window.overrideRequire){for(t=0;e&&e.length&&t<e.length;++t)w[e[t]]=!0;for(t=0;i&&i.length&&t<i.length;++t)m[i[t]]=!0;var l,u;if(y&&window._dummyDefine&&window._dummyDefine.isDummyDefine&&(l=window._dummyDefine.pendingDefinitions,window._dummyDefine=null,define=null),"undefined"!=typeof require&&require.isDummyRequire){u=require.pendingRequirements;var a=require.pendingConfigs;if(a&&a.length)for(t=0;t<a.length;t++)f=a[t],r.config.apply(null,f);require=null}if("function"==typeof define&&define.isTaRollupShim||(E="function"==typeof define?define:null,define=n),"function"==typeof require&&require.isTaRollupShim||(O="function"==typeof require?require:null,require=r),l&&l.length)for(t=0;t<l.length;t++)o=l[t],n.apply(null,o);if(u&&u.length)for(t=0;t<u.length;t++)d=u[t],r.apply(null,d)}}function n(e,r,t,d){var f,l,a=[];if("function"==typeof r&&void 0===t&&void 0===d&&(t=r,r=[]),"string"==typeof e&&"object"==typeof r&&"function"==typeof t){if(D.hasOwnProperty(e)||v[e]&&v[e].deps)return;if(l=i(r,a))try{f=t.apply(null,l),u(e,f)}catch(e){P("Error in require callback: ",e)}else o(a,{deps:r,cb:t,defname:e},n.depLoader)}else{if(E)return E(e,r,t,d);P("invalid args for AMD define: "+typeof e+", "+typeof r+", "+typeof t)}}function r(e,r,d,f){var l=null;if("string"==typeof e&&"function"!=typeof r){try{l=i([e]),!l&&O&&(l=[O(e,r,d,f)])}catch(e){}if(!l)throw t(e);return l[0]}if("object"==typeof e&&"function"==typeof r){var u=[];if(l=i(e,u))try{r.apply(null,l)}catch(e){P("Error in require callback: ",e)}else o(u,{deps:e,cb:r,eb:"function"==typeof d&&d},n.depLoader)}else{if(O)return O(e,r,d,f);P("invalid args for AMD require: "+typeof e+", "+typeof r+". Expected either a string-literal singular dependency (i.e. synchronous) or an array of dependencies with a callback function (i.e. async).")}}function i(e,n){var r,i,t,o,d=[];for(r=0;r<e.length;++r)if(i=e[r],o=null,i)if(D.hasOwnProperty(i))o=D[i],d.push(o);else if(m[i]){for(t=i.split("/"),"underscore"===t[0]&&(t[0]="_"),o="undefined"!=typeof window&&window;t.length>1&&o;o=o[t.shift()]);t.length>0&&o&&(o=o[t[0]]||o[t[0].toLowerCase()]),o?(D[i]=o,d.push(o)):n.push(i)}else n&&n.push(i);else d.push(null);if(d.length===e.length)return d}function t(e){var n,r,i,t,o="Missing immediately required dependency: "+e;for(n=0;n<10;n++){var d=v[e];if(!d){o+=" (not specified)";break}if(d.error){o+=" ("+d.error+")";break}if(e=null,t=d.deps)for(r=0;r<t.length;r++)if(i=t[r],!D.hasOwnProperty(i)){e=i;break}if(!e)break;o+=" -> "+e}var f=new Error(o);return y&&!window.IS_DEBUG||!g||y&&null===window.require.caller&&/^R|react$/.test(e)||g.error(f),f}function o(e,n,t){var u,a,s,p,c,h,y,g=[],w=[],m=[];n.deps=n.deps||[],n.defname&&(p=v[n.defname],v[n.defname]=n,p&&p!==n&&p.needers&&p.needers.length&&(n.needers=(p.needers||[]).concat(n.needers||[])));for(var c=0;c<e.length;c++)u=e[c],h=u.lastIndexOf("!"),h>=0?(g.push(u.substring(0,h)),w.push(u.substring(h+1))):(g.push(null),w.push(u));if(g=i(g,m),!g)return o(m,n);for(var c=0;c<e.length;c++)if(a=g[c],s=v[e[c]],!s&&!D.hasOwnProperty(e[c])){s={defname:e[c]},v[e[c]]=s;var E=f(s),M=l(s);E.error=M;try{if(a)a.load(w[c],r,E,{});else if(t)t(w[c],r,E,{});else{if(!O||O.taVer)throw new Error("no loader for AMD module '"+s.defname+"'");O([s.defname],E,M)}y=!0}catch(e){n.error=e,M(e)}}n.need=0;for(var c=0;c<e.length;c++)u=e[c],s=v[u],!s||D.hasOwnProperty(u)||s.error||(s.needers=s.needers||[],s.needers.push(n),n.need+=1);!n.need&&y&&(b.push(n),q||(q=setTimeout(d,0)))}function d(){var e,n,r,t;for(q=-1;b.length>0;){var d=b.shift();if(d)try{if(d.error){d.defname&&a(d.defname);continue}if(n=[],t="string"==typeof d.deps?[d.deps]:d.deps,e=i(t||[],n),n.length>0){o(n,d);continue}r=null,d.cb&&(r=d.cb.apply(null,e)),d.deps=[],d.cb=null,d.defname&&u(d.defname,r)}catch(e){P("Error propagating dependency resolutions: ",e)}}q=null}function f(e){return function l(e){return function(n){e.defname&&(e.error="Error loading '"+e.defname+"': "+n,P(e.error),e.need=0,e.deps=[],a(e.defname))}}function u(e,n){if(!D[e]){var r=v[e];if(D[e]=n,delete v[e],w[e]){var i,t=e.split("/"),o=ta;for("ta"===t[0]&&t.shift();t.length>1;)i=t.shift(),o[i]||(o[i]={}),o=o[i];t.length>0&&(i=t.shift(),i in o||i.toLowerCase()in o||(o[i]=n,o[i.toLowerCase()]=n))}if(E&&E(e,[],s(n)),r)for(;r.needers&&r.needers.length>0;){var f=r.needers.shift();f.need-=1,f.need||b.push(f)}b.length&&!q&&(q=setTimeout(d,0))}}function a(e){var n=v[e];if(n){var r=n.eb;for(n.deps=null,n.cb=null,n.eb=null,n.error||(n.error="Error loading '"+n.defname+"'");n.needers&&n.needers.length>0;){var i=n.needers.shift();i.error="Failed to load AMD module '"+e+"' which is depended upon by '"+i.defname+"'",i.need>0&&(i.need=0,b.push(i)),y&&!window.IS_DEBUG||!g||g.error(i.error)}if(null!=r)try{r(n.error)}catch(e){}}b.length&&!q&&(q=setTimeout(d,0))}unction p(e){return e&&(e.indexOf("trjs!")!==-1||e.indexOf("trcss!")!==-1||e.indexOf("trhtml!")!==-1||e.indexOf("trdust!")!==-1)}function c(){return!("undefined"!=typeof ta&&ta.page&&ta.page.loadDeferred)}function h(){var e,n,r,t,o;if(q)return void setTimeout(h,0);if(M=!0,v&&c())for(e in v)if(v.hasOwnProperty(e)){if(n=v[e],t=[],o=[],p(n.defname))continue;if(v.hasOwnProperty("trjs!"+n.defname))continue;if(n.deps&&n.deps.length){for(r=0;r<n.deps.length;r++)p(n.deps[r])||t.push(n.deps[r]);if(i(t,o),0===o.length)continue}P("Page 'load' event fired but we have not resolved the '"+n.defname+"' AMD module"+(n.deps&&n.deps.length?" due to missing dependencies: "+o:""))}}var y="undefined"!=typeof window,g=y&&window.console||"undefined"!=typeof console&&console||void 0,w={},m={},v={},b=[],q=null,D={ta:ta},E=null,O=null,M=!1,P=function(e,n){if("undefined"!=typeof __SERVER__)throw n;g&&g.error.apply&&g.error.apply(g,arguments),g&&!g.error.apply&&g.error&&g.error([].slice.apply(arguments))};n.amd=!0,n.isTaRollupShim=!0,n.depLoader=function(){},n.depLoader.isDefault=!0,r.isTaRollupShim=!0,r.undef=function(e){delete D[e];var n=v[e];n&&n.deps&&(n.deps=[],n.cb=null,n.defname=null,delete v[e])},r.config=r.defined=function(e){return!!D.hasOwnProperty(e)||!v.hasOwnProperty(e)&&(O&&O.defined&&O.defined(e))},r.parsed=function(e){return!!D.hasOwnProperty(e)||v[e]&&v[e].deps},r.specified=function(e){return!(!D.hasOwnProperty(e)&&!v[e])||O&&O.specified&&O.specified(e)},y&&window.IS_DEBUG&&(window.addEventListener?window.addEventListener("load",h,!1):window.attachEvent&&window.attachEvent("onload",h));var _={install:e,reportMissing:h,define:n,require:r,initializedModules:D,debug:function(){return{globalModuleFlags:w,shimModuleFlags:m,initializedModules:D,pendingModules:v,outer:{require:O,define:E},depLoader:n.depLoader}}};return _.install(),u("ta/rollupAmdShim",_),_}();
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["amdloaders","remoteModule"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/core-amd","files":{"js-amd":{"src":{"amdloaders":1,"remoteModule":1}}},"_":{"baseUrl":"/"}});
define("vanillajs",[],function(){return{}});
define("utils/to-array",["vanillajs"],function(){return function(n){return"number"!=typeof n.length?[n]:Array.prototype.slice.call(n)}});
define("amdloaders",["utils/to-array"],function(e){var t=[],n=[],r=[],o=[],a=[],d=null,i=null,u={},s={},c={},l={},f=null,p=!1,h=1e4,m=!1,w={},v=function(e,t,r){if("@ta/"!==e.substring(0,4)){if(u[e]){if(s[e]&&/^[-a-z]+\.[-_a-zA-Z0-9]+$/.test(e))return}else u[e]=!0,n.push(e);a.push(function(n){n||!t.parsed||t.parsed(e)||(n=new Error("Dynamic load failed to define module '"+e+"'")),n&&r.error&&r.error(n)}),S()}},g=function(e,t,r){u[e]||(u[e]=!0,s[e]||t.specified(e)||n.push(e)),a.push(function(n){var o=t.parsed(e);n||s[e]||o||(n=new Error("Dynamic load failed to define '"+e+"'")),n?r.error&&r.error(n):o||define(e,[],H(!0))}),t([e],r,r.error),S()},y=function(e,n,r){t.push(e),a.push(function(e){e?r.error&&r.error(e):r(!0)}),S()},C=function(e,t,n){r.push(e),a.push(function(r){r||t.specified("trhtml!"+e)||(r=new Error("Dynamic load failed to define content '"+e+"'")),r&&n.error&&n.error(r)}),S()},L=function(e,t,n){c[e]||(c[e]=!0,l[e]||o.push(e)),a.push(function(e){e?n.error&&n.error(e):n(!0)}),S()},L=function(e,t,n){c[e]||(c[e]=!0,l[e]||o.push(e)),a.push(function(e){e?n.error&&n.error(e):n(!0)}),S()},S=function(){!f&&p&&!m&&(a.length||t.length||n.length||r.length||o.length)&&(f=setTimeout(b,0))},E=function(e,t){var n=e.getAttribute("data-rup");if(n){var r;n=n.split(",");for(var o=0;o<n.length;o++)r=n[o].trim(),r&&t(r)}},R=w.getJSRollupsLoaded=function(){var t=i||e(document.getElementsByTagName("SCRIPT")).reduce(function(e,t){return t.hasAttribute("data-is-dust")||E(t,function(t){e.dedup[t]||(e.rups.push(t),u[t]=s[t]=e.dedup[t]=!0)}),e},{rups:[],dedup:{}}).rups;return!i&&p&&(i=t),t},A=w.getCSSRollupsLoaded=function(){var t=d||(document.head?e(document.head.querySelectorAll("LINK, STYLE")).reduce(function(e,t){return E(t,,e},{rups:[],dedup:{}}).rups:[]);return!d&&p&&(d=t),t},T=w.getLoadedFilesParams=function(){return{haveJses:String(R()),haveCsses:String(A())}},b=function(){if(f=null,p&&!m){var e=t,d=a,i=r,u=o,c=T(),l=n.filter(function(e){return e&&!s[e]&&!require.parsed(e)});if(a=[],t=[],n=[],r=[],o=[],!(l.length||e.length||i.length||u.length))return void I(d);var h="haveJses="+encodeURIComponent(c.haveJses)+"&haveCsses="+encodeURIComponent(c.haveCsses)+"&needJses="+encodeURIComponent(String(l||""))+"&needCsses="+encodeURIComponent(String(e||""))+"&needDusts="+encodeURIComponent(String(u||""));i.length>0&&(h+="&needContent="+encodeURIComponent(String(i))),window.pageServlet&&(h+="&metaReferer="+encodeURIComponent(window.pageServlet));var w=null;try{w=new XMLHttpRequest}catch(e){try{w=new ActiveXObject("MSXML2.XMLHTTP")}catch(e){try{w=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("Can't create XMLHttpRequest or similar")}}}var v=!1;w.onreadystatechange=function(){v||4!==w.readyState||(v=!0,w.status>=200&&w.status<=299?x(d,w.responseText):I(d,new Error("XHR returned "+w.status)))},w.open("POST","/DemandLoadAjax",!0);try{w.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(e){}try{w.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(e){}try{w.setRequestHeader("Accept","text/html, */*")}catch(e){}m=!0,w.send(h)}},I=function(e,t){if(m=!1,S(),e.length)for(var n=0;n<e.length;++n)try{e[n](t)}catch(e){window.IS_DEBUG&&console.error&&console.error("Error in async callback: ",e)}},D=w.installStyles=function(e){document.head.appendChild(e.reduce(function(e,t){return E(t,function(e){d.push(e),define("trcss!"+e,[],H(void 0))}),e.appendChild(t),e},document.createDocumentFragment()))},q=w.installScripts=function(e){return Promise.all(e.map(function(e){return E(e,function(t){e.hasAttribute("data-is-dust")?l[t]=!0:(i&&i.push(t),s[t]=!0)}),new Promise(function(t){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("data-rup",e.getAttribute("data-rup")),e.src?(n.src=e.src,n.async=!0,n.onload=n.onerror=t,document.head.appendChild(n)):e.text&&(n.text=e.text,document.head.appendChild(n),document.head.removeChild(n),t())})}))},x=function(t,n){if(!n||!n.substr)return void I(t,new Error("no data returned from /DemandLoadAjax"));var r,o=Promise.resolve();try{var a=document.createElement("DIV");a.innerHTML=n,D(e(a.querySelectorAll("STYLE, LINK"))),o=q(e(a.getElementsByTagName("SCRIPT")));for(var d,i;d=a.firstChild;)a.removeChild(d),1===d.nodeType&&(i=d.getAttribute("data-content"),i&&define("trhtml!"+i,[],H(d)))}catch(e){r=e}o.then(I.bind(null,t,r))},H=M=w.activate=function(){p||(p=!0,define.depLoader&&!define.depLoader.isDefault||(define.depLoader=v),S())},X=function(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++)if(e[t].hasAttribute("data-loadtrk")&&!e[t].loadtrk)return window.console&&console.warn&&console.warn(e[t].src+" is not loaded yet"),!1;return!0},P=function(){"interactive"===document.readyState&&X()&&(window.console&&console.warn&&console.warn("force activate async loading due to wait timeout"),M())};return define("trjs",[],function(){return{load:g}}),define("trcss",[],function(){return{load:y}}),define("trhtml",[],function(){return{load:C}}),define("trdust",[],,"undefined"!=typeof window&&(document.addEventListener&&!window.taRollupsAreAsync&&document.addEventListener("DOMContentLoaded",M,!1),window.addEventListener?window.addEventListener("load",M,!1):window.attachEvent&&window.attachEvent("onload",M),window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("Edge")>-1&&setTimeout(P,h)),w});
define("remoteModule",["vanillajs"],function(){"use strict";function t(t,e){return null==t?null:t.getAttribute("data-"+e)}function e(t,e){for(;t&&t!==document.body;){if(t.getAttribute(e))return t;t=t.parentNode}return null}function r(e,r,n,i,u){var a=t(e,r);return a?a.replace(/\$plc:/g,"$prp/"+n+"/").replace(/\$prw:/g,"$prw/"+i+"/").split(",").filter(function(t){return!!t.length}).reduce(function(t,e){return t.concat(u.map(function(t){var r="trdust!"===t&&e.indexOf("/")<0;return t+e+(r?"-dust":"")}))},[]):[]}var n={};return function(i,u){var a=[].slice.call(arguments),l=(t(u,"load-init")||t(u,"load-js")).split("."),s=l.shift(),d=l.shift();if(!(n[s]&&n[s].indexOf(u)>=0)){if(require.defined(s)){var c=require(s);return void(d?c[d]:c).apply(c,a)}(n[s]||(n[s]=[])).push(u);var f=e(u,"data-placement-name"),p=e(u,"data-prwidget-name"),o=t(f,"placement-name"),h=t(p,"prwidget-name"),m=[].concat(r(u,"load-all",o,h,["trjs!","trcss!","trdust!"]),r(u,"load-js",o,h,["trjs!"]),r(u,"load-css",o,h,["trcss!"]),r(u,"load-dust",o,h,["trdust!"]));/^\$plc:/.test(s)?(a.unshift(m),a.unshift(s.substr(5)+"."+d),a.unshift(f.getAttribute("id")),a.unshift("evCall"),a.unshift("ta/p13n/placements"),requireCallLast.apply(window,a)):/^\$prw:/.test(s)?(a.unshift(s.substr(5)+"."+d),a.unshift("call"),a.unshift("ta/prwidgets"),requireCallLast.apply(window,a)):require(m,function(){n[s]=n[s].filter(;var t=require(s);(d?t[d]:t).apply(t,a)})}}});
if("undefined"==typeof ta)var ta={};var api=function(){null==window.IS_DEBUG&&(window.IS_DEBUG=!1),null==window.VERSION_MAP&&(window.VERSION_MAP={}),null==window.CDNHOST&&(window.CDNHOST="");var t={overlays:window.ta.overlays||{},maps:window.ta.maps||{},bmaps:window.ta.bmaps||{},common:window.ta.common||{},phac:window.ta.phac||{},servlet:window.ta.servlet||{},support:window.ta.support||{},util:window.ta.util||{},widgets:window.ta.widgets||{},commerce:window.ta.commerce||{},mobfull:window.ta.mobfull||{},photos:window.ta.photos||{},media:window.ta.media||{},hac:{filters:{}},t4b:window.ta.t4b||{},api:{maps:{}},p13n:window.ta.p13n||{},registration:window.ta.registration||{},meta:window.ta.meta||{}};t.id=function(n){try{return document.id(n)}catch(n){t.util.error&&t.util.error.record(n,"ta.id failed")}},t.select=function(){var t=(Array.convert||Array.from)(arguments),n=t.length>1&&("string"==typeof t[0]?t.pop():t.shift())||document,e=t.shift();return Slick.search(n,e,new Elements)};var n=t;return n.extend=function(){var t,n,e,r,o,i,a=arguments[0]||{},u=1,l=arguments.length,s=!1;for("boolean"==typeof a&&(s=a,a=arguments[u]||{},u++),"object"==typeof a||isFunction(a)||(a={});u<l;u++)if(null!=(t=arguments[u]))for(n in t)e=a[n],r=t[n],a!==r&&(s&&r&&(isPlainObject(r)||(o=isArray(r)))?(o?(o=!1,i=e&&isArray(e)?e:[]):i=e&&isPlainObject(e)?e:{},a[n]=extend(s,i,r)):void 0!==r&&(a[n]=r));return a},n.fireEvent=function(t,n,e){return t&&$(t).fireEvent(n,e)},n.addEvent=function(t,n,e){return t&&$(t).addEvent(n,e)},n.removeEvent=function(t,n,e){return t&&$(t).removeEvent(n,e)},n.removeEvents=function(t,n){return t&&$(t).removeEvents(n)},n.createElement=n.getSize=n.getPosition=function(t,n){return t&&$(t).getPosition(n)},n.addClass=function(t,n){return t&&$(t).addClass(n)},n.removeClass=function(t,n){return t&&$(t).removeClass(n)},n.toggleClass=function(t,n,e){return t&&$(t).toggleClass(n,e)},n.hasClass=function(t,n){return t&&$(t).hasClass(n)},n.find=function(t,n){return $(n||document).getElement(t)},n.findAll=n.select,n.parent=function(t,n){return t&&$(t).getParent(n)},n.setStyle=function(t,n,e){return t&&$(t).setStyle(n,e)},n.mixin=function(t){return Array.prototype.slice.call(arguments,1).forEach(t),t},n.merge=function(t){for(var n=Array.prototype.slice.call(arguments,1),e=0,r=n.length;e<r;e++)for(var o in n[e])n[e].hasOwnProperty(o)&&(t[o]=n[e][o]);return t},n.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n.stopEvent=function(t){return t&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1),!1},window.define&&define("ta",[],function(){return t}),n}();api.merge(ta,api);var ifdefNN=function(t){return"undefined"!=typeof t&&null!==t};
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install([],[]);});
define("ns-exporter",["vanillajs"],function(r){function n(r){if("undefined"==typeof window)return null;if("undefined"==typeof r&&(r=window),!r)return require.defined("ta/util/Error")&&require("ta/util/Error").record(null,"Using ns-exporter:exportTo without a namespace"),null;if("string"==typeof r){var n=window;n.ta||(ta={}),r.split(".").forEach(,r=n}return r}return{exportTo:function(r,e,t){if(e=n(e),!e)return!1;for(var i in r)!r.hasOwnProperty(i)||t&&i in e||(e[i]=r[i]);return!0},createNs:function(r,e,t){return!!(e=n(e))&&void(e[t]=r)}}});
define("ta/util/Object",["vanillajs","ns-exporter"],function(t,e){var r={};return r.typeOf=r.merge=function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n){t||(t="array"===r.typeOf(n)?[]:{});for(var o in n){var a=n[o];if(n.hasOwnProperty(o)&&"undefined"!==r.typeOf(a)){var i=r.typeOf(a);if("string"===i||"number"===i||"boolean"===i||"function"===i||null===a){t[o]=a;continue}t[o]=r.merge(t[o],a)}}}}return t},e.exportTo(r,"ta.util"),r});
define("utils/resourceLoader",["vanillajs"],function(e){"use strict";function r(){function e(){try{if(navigator.userAgent.match(/ Safari[/]/)&&!navigator.userAgent.match(/ Chrom/)&&navigator.userAgent.match(/ Version\/5\./))return!1;var e=navigator.userAgent.match(/\ AppleWebKit\/(\d+)\.(\d+)/);if(e){e.shift();var r=parseInt(e[0]),t=parseInt(e[1]);if(r<535||535==r&&t<23)return!1}return"onload"in document.createElement("link")}catch(e){return!1}}function r(e,r,t){u++,(u==c.length||l)&&r(t),t?require.defined("ta/util/Error")&&require("ta/util/Error").record(new Error(e),"utils/resourceLoader: failed to load file ["+e+"]"):n[e]=1}unction a(t,n,u){var c=n||o(u);if(c){var l,s,f;"css"==c?(l=document.createElement("link"),l.rel="stylesheet",l.type="text/css",f="href",s=e()):"js"==c&&(l=document.createElement("script"),l.type="text/javascript",f="src",s="onload"in l),s?(l.onload=r.bind(null,u,t,!1),"onerror"in l&&(l.onerror=function(){i[u]?r(u,t,!0):(i[u]=!0,a(t,n,u))})):r(u,t,!1),l[f]=u;var d=document.getElementsByTagName("head")[0];d.appendChild(l)}else require.defined("ta/util/Error")&&require("ta/util/Error").record(new Error(u),"utils/resourceLoader: unknown file type for ["+u+"]"),r(u,t,!0)}var u,c,l;this.load=function(e,r,n){if("function"==typeof r&&(n=r,r={}),u=0,c=t(e||null),n=n||function(){},r=r||{},l=r.serial,0==c.length)setTimeout(n,1);else if(l){var i,o=c.slice(),s=function(e){i=i&&e,0==o.length?n&&n(i):a(s,r.forceType,o.shift())};s()}else c.forEach(a.bind(null,n,r.forceType))}}function t(e){var r=[],t=function(e){!e||e in n||(e&&e.splice?e.forEach(t):r.push(e))};return t(e),r}var n={},i={};return{Loader:r,load:function(e,t,n){"function"==typeof t&&(n=t,t={}),(new r).load(e,t,n)},loaded:});
define("common/trackingStreams",["vanillajs","amdloaders"],function(){function l(l,e,t){if(e=Array.prototype.slice.call(e),l.handler)try{l.handler.apply(null,e),t()}catch(l){}else if(l.list){l.list.length>=l.limit&&(l.list=l.list.slice(0,l.list.length-1),l.callbacks=l.callbacks.slice(0,l.callbacks.length-1)),l.list.unshift(e),l.callbacks.unshift(t);var r=l.handlerModule;r&&l.handlerMethod&&(l.handlerModule=null,require([r+""],function(e){n(l,e[l.handlerMethod],0)}))}}function e(l,e){if(e=Array.prototype.slice.call(e),l.handler)try{l.handler.apply(null,e)}catch(l){}else if(l.list&&l.list.length<l.limit&&(l.list.push(e),l.handlerModule&&l.handlerMethod)){var t=l.handlerModule;l.handlerModule=null,require([t+""],function(e){n(l,e[l.handlerMethod],0)})}}function n(l,n,t){if(t=t||0,l.handler&&l.priority>=t)return!1;l.handler=n,l.priority=t;var a=l.list;l.list=null;for(var i=0;i<a.length;++i)try{n.apply(null,a[i]),l.callbacks&&l.callbacks[i]&&l.callbacks[i]()}catch(n){l!==r&&e(r,[n,l.name+" dispatch error"])}}var t="trjs!ta/Core/TA.Record",r={name:"errorQ",limit:3,handler:null,handlerModule:"trjs!ta/util/Error",handlerMethod:"record",list:[]},a={name:"GARecordQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackEventOnPage",list:[]},i={name:"GARecordOnPageOnceQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackEventOnPageOnce",list:[]},d={name:"SetCookieQ",limit:100,handler:null,handlerModule:t,handlerMethod:"setEvtCookie",list:[]},c={name:"UnifiedUserTrackingQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackUnifiedEvent",list:[]},o={name:"redirectCallback",limit:1,handler:null,handlerModule:t,handlerMethod:"setEvtCookie",list:[],callbacks:[]};return{error:function(){e(r,arguments)},setErrorHandler:function(l,e){n(r,l,e)},trackEvent:function(){e(a,arguments)},trackEventOnPageOnce:function(){e(i,arguments)},setTrackEventHandler:function(l,e){n(a,l,e)},setEvtCookie:trackUnifiedEvent:redirectWithEvt:function(){var e=Array.prototype.slice.call(arguments);e.length>0&&"function"==typeof e[0]&&l(o,e.slice(1),e[0])}}});
define("purify",["vanillajs"],function(e){function n(e,n){return e?t(e)?(window.IS_DEBUG&&console.error("You're using a jQuery object where you shouldn't. Check the stack trace and fix it!"),n&&e.length>1?e.get():e.get(0)):e.forEach&&(e.length<=1||!n)?e[0]:e:e}eturn n});
define("utils/json-to-url",["vanillajs"],function(){"use strict";return function(n){return n?Object.keys(n).map(.join("&"):""}});
define("utils/asdf-encoder",["ns-exporter","vanillajs"],function(e){"use strict";var t={};return t.getOffset=function(e){return e>=97&&e<=122?e-61:e>=65&&e<=90?e-55:e>=48&&e<=71?e-48:-1},t.asdf=function(e){for(var t={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],"q":[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],"x":[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],"z":[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]},r="",a=0;a<e.length;a++){var n=e.charAt(a),o=n;t[n]&&a+1<e.length?(a++,o+=e.charAt(a)):n="";var s=getOffset(e.charCodeAt(a));r+=s<0||"String"==typeof t[n][s]?o:t[n][s]}return r},e.exportTo(t),t});
define("utils/urlutils",["vanillajs","utils/asdf-encoder"],function(e,t){"use strict";function n(e,t,n){var o=new RegExp("(-"+t+"([0-9]+))|([?&]"+n+"=([0-9]+))"),r=o.exec(e);if(r){if("undefined"!=typeof r[2])return Number(r[2]);if("undefined"!=typeof r[4])return Number(r[4])}}unction r(e){for(var t={},n=e.split("#")[0].split("?")[1]||"",o=n.split("&"),r=0;r<o.length;r++){var i=o[r].split("=");i[0]&&(t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]))}return t}function i(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];if(o&&"object"==typeof o)for(var r=0;o.length&&r<o.length;++r){var i=o[r];i="object"==typeof i?"":String(i),t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}else t.push(encodeURIComponent(n)+"="+encodeURIComponent(String(o)))}return t.join("&")}unction u(e){return e=e||"",e.indexOf("http")===-1&&(e=f(e)),e.replace("http://","https://")}function d(e){var t=l.exec(e);return{protocol:t?t[1]:"",host:t?t[2]:""}}var l=/^([^:]+:)\/\/([^\/\?]+)/,a="undefined"!=typeof window&&window.asdf||("undefined"!=typeof global&&global.asdf?global.asdf:t.asdf);return{asdf:a,getUrlArgNumeric:n,getUrlPageLoc:o,getUrlQueryArgs:r,toQueryString:i,https:u,getParts:d}});
define("ajax-request",["utils/json-to-url","utils/urlutils"],function(t,e){function r(t){var r=document.createElement("a");r.href=t;var s=e.getParts(r.href);return s.protocol!==window.location.protocol||s.host!==window.location.hostname}function s(t,e,s){try{r(t)||e.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(t){}try{var n=s["content-type"]||"application/x-www-form-urlencoded; charset=utf-8";e.setRequestHeader("Content-Type",n)}catch(t){}try{var o=s.accept||"text/html, */*";e.setRequestHeader("Accept",o)}catch(t){}try{var a=s["x-requested-by"];a&&e.setRequestHeader("X-Requested-By",a)}catch(t){}}function n(){try{return new XMLHttpRequest}catch(t){try{return new ActiveXObject("MSXML2.XMLHTTP")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){throw new Error("Can't create XMLHttpRequest or similar")}}}}return function(e,r){"object"==typeof e&&(r=e,e=r.url),r=r||{};var o=r.method||r.type||"GET",a="string"==typeof r.data?r.data:t(r.data);return new Promise(function(t,c){var u=n(),i=!1;u.onreadystatechange=function(){i||u.readyState!==XMLHttpRequest.DONE||(i=!0,u.status>=200&&u.status<=299?(r.success&&r.success(this.responseText,this.status,u),t(this.responseText)):u.status>0&&(r.error&&r.error(u,this.status,this.statusText),c(this.responseText)),r.complete&&r.complete(u,this.statusText))},"get"===o.toLowerCase()&&"string"==typeof a&&a.length>0&&(e+=("?"===a[0]?"":"?")+a,a=null),u.open(o,e,!r.synchronous),s(e,u,r),u.send(a)})}});
define("utils/object/set-props",["vanillajs"],function(){"use strict";return );
define("utils/object/shallow-copy",["utils/object/set-props","vanillajs"],function(t){"use strict";return function(r){var e;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){e=[];for(var n=0;n<r.length;++n)e.push(r[n])}else e=t({},r);return e}});
define("utils/objutils",["utils/object/set-props","utils/object/shallow-copy","vanillajs"],function(r,t){"use strict";function e(){var r,t,n,o,i,f,u=arguments[0]||{},c=1,l=arguments.length,a=!1;for("boolean"==typeof u&&(a=u,u=arguments[c]||{},c++),"object"==typeof u||h(u)||(u={});c<l;c++)if(null!=(r=arguments[c]))for(t in r)n=u[t],o=r[t],u!==o&&(a&&o&&(j(o)||(i=y(o)))?(i?(i=!1,f=n&&y(n)?n:[]):f=n&&j(n)?n:{},u[t]=e(a,f,o)):void 0!==o&&(u[t]=o));return u}function n(r){if("object"!=typeof r||null===r||w(r))return r;for(var t in r)r.hasOwnProperty(t)&&(r[t]=n(r[t]));return d(r)}function o(r){if("object"!=typeof r||null===r)return r;for(var t in r)if(r.hasOwnProperty(t)){var e=r[t];null===e?delete r[t]:o(e)}return r}function i(r){var t;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){t=[];for(var e=0;e<r.length;++e)t.push(i(r[e]))}else{t={};for(var n in r)r.hasOwnProperty(n)&&(t[n]=i(r[n]))}return d(t)}function f(r){var t;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){t=[];for(var e=0;e<r.length;++e)t.push(f(r[e]))}else{t={};for(var n in r)r.hasOwnProperty(n)&&(t[n]=f(r[n]))}return t}function u(r){var t;if("object"!=typeof r||null===r)return r;if(t=r,r.constructor===Array){P(r)&&(t=[],t.length=r.length);for(var e=0;e<r.length;++e)t[e]=u(r[e])}else{P(r)&&(t={});for(var n in r)r.hasOwnProperty(n)&&(t[n]=u(r[n]))}return t}function c(r,t){if(r!==t){if(!r)return!t;if(!t||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1}return!0}function l(r,t){if(r!==t){if(!r)return!t;if(!t)return!1;if(y(r)&&y(t))return c(r,t);var e=Object.keys(r);if(!c(e,Object.keys(t)))return!1;for(var n=0;n<e.length;n++)if(r[e[n]]!==t[e[n]])return!1}return!0}function a(r,t){var e,n,o={};for(e=0;e<r.length;++e)n=r[e],o[n[t]]=n;return o}function s(r,t){var e=r[t];if(!e&&!r.propertyIsEnumerable(t))throw"missing property: "+t;return e}function p(r,t){for(var e in r)r.hasOwnProperty(e)&&!t(r,r[e])&&delete r[e];return r}unction b(r,t,e){var n;if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,r,e);for(n=t.length,e=e?e<0?Math.max(0,n+e):e:0;e<n;e++)if(e in t&&t[e]===r)return e}return-1}unction j(r){var t,e;return!(!r||"[object Object]"!==Object.prototype.toString.call(r))&&(!(t=Object.getPrototypeOf(r))||(e=Object.hasOwnProperty.call(t,"constructor")&&t.constructor,"function"==typeof e&&Object.toString.call(e)===Object.toString.call(Object)))}unction O(r,t){for(var e in r)if(r.hasOwnProperty(e)&&t(r[e],e,r))return r[e]}function g(r,t,e){var n,o=0,i=r.length,f=void 0===i||h(r);if(e)if(f){for(n in r)if(t.apply(r[n],e)===!1)break}else for(;o<i&&t.apply(r[o++],e)!==!1;);else if(f){for(n in r)if(t.call(r[n],n,r[n])===!1)break}else for(;o<i&&t.call(r[o],o,r[o++])!==!1;);return r}var d=function(r){return r},w=function(r){return!0},P=return"function"==typeof Object.freeze&&(d=Object.freeze.bind(Object),P=Object.isFrozen.bind(Object),w=Object.isFrozen.bind(Object)),{setProps:r,deepFreeze:n,deepFreezeCopy:i,unfreezeForDust:u,undefineNulls:o,shallowCopy:t,deepCopy:f,shallowEquals:l,index:a,need:s,filterProps:p,keys:v,isArray:y,inArray:b,isFunction:h,isPlainObject:j,each:g,extend:e,find:O}});
define("utils/decoder",["common/trackingStreams"],function(r){function e(e){if(e=e.replace(/\-/g,"+").replace(/\_/g,"/"),e.length%4!==0)for(var n=4-e.length%4,t=0;t<n;t++)e+="=";for(var i,a,o,c,f,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g="",h="",l="",s=0;s<e.length;s+=4){if(o=d.indexOf(e.charAt(s)),c=d.indexOf(e.charAt(s+1)),f=d.indexOf(e.charAt(s+2)),l=d.indexOf(e.charAt(s+3)),o==-1||c==-1||f==-1&&l==-1)return void r.error({"string":e},"string contains invalid base64 letter");i=o<<2|c>>4,a=(15&c)<<4|f>>2,h=(3&f)<<6|l,g+=String.fromCharCode(i),64!=f&&(g+=String.fromCharCode(a)),64!=l&&(g+=String.fromCharCode(h)),i=a=h="",o=c=f=l=""}return unescape(g)}return{base64Decoder:e}});
define("utils/urlDecoder",["utils/decoder"],function(e){function t(t){if(!t)return null;var n=4;return t=e.base64Decoder(t),t=t.substring(n,t.length-n)}function n(e){return e.getAttribute("href")||t(e.getAttribute("data-params"))}function r(e,n,r,o){new Event(e).preventDefault();var u=n.getAttribute("data-params");return!!u&&(!!(u=t(u))&&(r&&(u+=r),o?window.open(u,"_blank"):window.location=u,!1))}function o(e){if(!u(e))return e;var n=e.substring(c,e.length);return t(n)}function u(e){return e&&"string"==typeof e&&0==e.indexOf(d)&&e.length>c}function i(e){var t=/TAP\|.+?(?=%2F)/.exec(e),n=t[0],r=o(n),u=e.replace(n,r);window.open(u)}var d="TAP|",c=d.length;return{decodeUrl:t,getUrl:n,goToLink:r,decodeProductCode:o,isObfuscatedProductCode:u,goToCommerceLinkWithProductCode:i}});
define("lib/jquery-amd",[],;
define("utils/browserutils",["vanillajs"],function(e){"use strict";var o={},n=window.navigator?window.navigator.userAgent.toLowerCase():"",a=window.navigator?window.navigator.platform.toLowerCase():"",r=n.match(/(opera|ie|firefox|chrome|crios|trident|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],i="ie"==r[1]&&document.documentMode;return"trident"===r[1]&&(r[1]="ie",r[2]=parseInt(r[2],10)+4),o.name="version"==r[1]?r[3]:r[1],o.version=i||parseFloat("opera"==r[1]&&r[4]?r[4]:r[2]),o.Platform={name:n.match(/ip(?:ad|od|hone)/)?"ios":(n.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]},o[o.name]=!0,o[o.name+parseInt(o.version,10)]=!0,o.Platform[o.Platform.name]=!0,o});
define("utils/stopevent",["vanillajs"],function(){return function(e){return e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1),!1}});
define("utils/form-to-json",["vanillajs"],function(){"use strict";function e(e,n,r){e in r?(Array.isArray(r[e])||(r[e]=[r[e]]),r[e].push(n)):r[e]=n}return function(n){for(var r={},i={file:1,reset:1},t={DATALIST:1,OUTPUT:1},a={checkbox:1,radio:1},o=0;o<n.elements.length;o++){var l=n.elements[o],s=l.name;if(s){var u=l.nodeName,f=l.type;if("SELECT"===u)for(var v=0;v<l.options.length;v++){var c=l.options[v];c.selected&&e(s,c.value,r)}else"INPUT"===u?f in a?l.checked&&e(s,l.value,r):f in i||e(s,l.value,r):u in t||e(s,l.value,r)}}return r}});
define("utils/is-element",["vanillajs"],function(){return );
define("api-mod",["lib/jquery-amd","utils/browserutils","utils/stopevent","utils/form-to-json","utils/to-array","utils/is-element"],function($,browser,stopEvent,formToJson,toArray,isElement){"use strict";var exports={};return exports.fn=function(fn){switch(typeof fn){case"function":return fn;case"string":var f=null;try{f=eval(fn)}catch(t){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join(".")),f=ns&&ns._magic&&ns._magic.partial(n)}catch(t){}}if(f&&"function"==typeof f)return f}return null},exports.bind=exports.inDocument=function(t){return t=exports.find(t),!!t&&!!t.parentNode&&11!==t.parentNode.nodeType},exports.addEvent=function(t,e,r){$(t).on(e,r)},exports.fireEvent=function(t,e,r){$(t).trigger(e,r)},exports.removeEvent=function(t,e,r){$(t).off(e,r)},exports.removePropertyEvent=function(t,e,r){"on"!==e.substr(0,2)&&(e="on"+e);var o=t.getAttribute(e);if(o){var n,s=r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");n=o.replace(new RegExp(s+"\\s*\\([^)]*\\);?|(ta\\.call|requireCallLast|requireCallIfReady)\\s*\\(\\s*['\"]\\s*"+s+"[^)]*\\);?"),""),t[e]=n.trim()}},exports.store=function(t,e,r){$(t).data(e,r)},exports.retrieve=exports.getSize=function(t){if(t=exports.find(t),!t)return null;if(/^(?:body|html)$/i.test(t.tagName)||t===window||t===document){var e=document.compatMode&&"CSS1Compat"!==document.compatMode?document.body:document.body.parentNode;return{x:e.clientWidth,y:e.clientHeight}}return{x:t.offsetWidth,y:t.offsetHeight}},exports.getPosition=function(t,e){if(e=$(e),t=$(t),e.length){var r=e.offset(),o=t.offset();return{left:o.left-r.left,top:o.top-r.top}}return t.offset()},exports.getCoords=function(t){if(t=exports.find(t),!t)return null;var e=this.getSize(t),r=this.getPosition(t);return{top:r.top,left:r.left,bottom:r.top+e.y,right:r.left+e.x,height:e.y,width:e.x}},exports.getOffsetParent=exports.getParent=function(t,e){if(t=exports.find(t),!t)return null;if(e){for(;t&&"html"!=t.tagName;t=t.parentNode)if(exports.hasClass(t,e))return t;return null}return t.parentNode},exports.elementOrParentMatches=function(t,e){if(e)for(;t;t=t.parentElement)if(e(t))return!0;return!1},exports.containsElement=function(t,e){if(t=exports.find(t),e=exports.find(e),!t||!e)return!1;for(;null!=e;){if(e===t)return!0;e=e.parentElement}return!1},exports.checkBrowser=function(t){var e=Array.prototype.slice.call(arguments);return e.some(function(t){return!!browser[t]})},exports.containsEvent=function(t,e){if(t=exports.find(t),!e||!t)return!1;var r=e.pageX,o=e.pageY,n=this.getCoords(t);return"fixed"!==$(this.getOffsetParent(t)||t).css("position")&&"undefined"!=typeof r&&"undefined"!=typeof o||(r=e.clientX,o=e.clientY),o>=n.top&&o<=n.bottom&&r>=n.left&&r<=n.right},exports.select=function(t,e){var r=Array.prototype.slice.call(arguments),o=r.length>1&&("string"==typeof r[0]?r.pop():r.shift())||document,n=r.shift();try{return $(n,o).get()}catch(t){return[]}},exports.addClass=function(t,e){$(t).addClass(e)},exports.removeClass=exports.toggleClass=function(t,e,r){$(t).toggleClass(e,r)},exports.hasClass=exports.destroy=exports.find=function(t,e){try{return $(t,e||document)[0]}catch(t){}},exports.scrollTop=function(){var t=void 0!==window.pageYOffset,e="CSS1Compat"===(document.compatMode||"");return t?window.pageYOffset:e?document.documentElement.scrollTop:document.body.scrollTop},exports.scrollLeft=exports.createElement=function(t,e){var r=document.createElement(t);return e&&$(r).attr(e),r},exports.isElement=isElement,exports.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},exports.adopt=function(t,e){$(t).append(Array.prototype.slice.call(arguments,1))},exports.setStyle=exports.stopEvent=stopEvent,exports.mixin=function(t,e){return Array.prototype.slice.call(arguments,1).forEach(t),t},exports.merge=function(t,e){for(var r=Array.prototype.slice.call(arguments,1),o=0,n=r.length;o<n;o++)for(var s in r[o])r[o].hasOwnProperty(s)&&(t[s]=r[o][s]);return t},exports.getFormData=exports.toFormQueryString=function(t){var e=[];t&&"FORM"===t.nodeName&&(t=exports.getFormData(t));for(var r in t)if(t.hasOwnProperty(r)){var o=t[r];if(o&&"object"==typeof o)for(var n=0;o.length&&n<o.length;++n){var s=o[n];s="object"==typeof s?"":String(s),e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}else e.push(encodeURIComponent(r)+"="+encodeURIComponent(String(o)))}return e.join("&")},exports.toArray=toArray,exports.forceReflow=function(t){$(t).each(},exports.stripTags=function(t,e,r){e=e||"";var o=r?"<"+e+"(?!\\w)[^>]*>([\\s\\S]*?)</"+e+"(?!\\w)>":"</?"+e+"([^>]+)?>";return t.replace(new RegExp(o,"gi"),"")},exports});
define("ta/Core/TA.Store",["vanillajs","ns-exporter","ta/util/Object"],function(e,r,t){"use strict";var n={},a={};return a.store=function(e,r){return n[e]=r,r},a.retrieve=function(e){return n[e]},a.has=a.retrieveOrStore=function(e,r){var t=n[e];return"undefined"==typeof t&&(n[e]=r,t=r),t},a.remove=a.keep=function(e,r){var t,n=a.retrieve(e);t=n?n instanceof Array?n:[n]:[],r instanceof Array?r.forEach(:t.push(r),a.store(e,t)},a.merge=function(e,r){a.store(e,t.merge(a.retrieve(e)||{},r))},a.asInt=function(e,r){var t=parseInt(a.retrieve(e));return isNaN(t)?r||0:t},a.asFloat=function(e,r){var t=parseFloat(a.retrieve(e));return isNaN(t)?r||0:t},a.executeCallbacks=function(e){if(a.has(e)){var r=a.retrieve(e);if(!r instanceof Array)return;for(var t=0;t<r.length;t++)r[t]()}},r.exportTo(a,"ta"),a});
define("ta/Core/TA.Record",["vanillajs","ns-exporter","ta/Core/TA.Store","purify","ajax-request","utils/objutils","utils/urlDecoder"],function(e,t,n,r,a,i,o){"use strict";var u={},l={},c=[],s=8,d="impressionTrackingTree",g=0,f=1,v=2,p="UserTracking",m="impression",h="action",k="pageview",y="search",E=[],T=60,P=function(e){return"function"==typeof e},b=function(e,t){try{if(!e||"object"!=typeof t)return;if(window.JSON&&JSON.stringify){var n=JSON.stringify(t);n&&n.length<1e5&&(E.push([e,n]),E.length>T&&E.shift())}}catch(e){}},_=function(e,t,n,r){a(e,t).then(n,r),b(e,t)},S=function(){if(require.defined("ta/util/Error")){var e=require("ta/util/Error");e.record.apply(e,arguments)}else ta&&ta.m&&P(ta.m.recordJSError)&&ta.m.recordJSError(arguments)},C=function(e){return"undefined"==typeof e||null==e?"":("string"!=typeof e&&(e=e.toString()),e.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*"))},w=function(e){var t=[];for(var n in e){var r=e[n];t.push(C(n)+"."+C(r))}return t.join("*")},A=function(e){return"undefined"==typeof e||null===e?"":("string"!=typeof e&&(e=e.toString()),e.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*").replace(/\~/g,"!~"))},N=function(e){var t=[];for(var n in e){var r=e[n];t.push(A(n)+"."+A(r))}return t.join("*")},R=function(e){var t=/(https?:\/\/[^\/]+)?\/([^#.?-]*)/,n=t.exec(e);return n&&"undefined"!=typeof n[2]?n[2]?n[2]:"Home":null},O=function(){var e=u.getPageData();if(e&&e.url)return e.url.substring(1);var t=/\/([^-]*)/.exec(window.location.pathname);return t?t[1]:null},I=function(){var e=ta.uid;if(require.defined("redux-init")){var t=require("redux-init");t&&t.tracking&&t.tracking.uid&&(e=t.tracking.uid)}return e},x=function(e,t,n){var r=new RegExp("(-"+t+"([0-9]+))|([?&]"+n+"=([0-9]+))"),a=r.exec(e);if(a){if("undefined"!=typeof a[2])return a[2];if("undefined"!=typeof a[4])return a[4]}return null},M=function(e){return x(e,"d","detail")||x(e,"g","geo")},q=function(e){var t=document.cookie.match("(?:^|;)\\s*"+e+"=([^;]*)");return!!t&&(t=t[1],0===t.indexOf("%1%")&&(t=t.substring(3)),decodeURIComponent(t))},L=function(e,t,n){try{var r;n.encode&&(t=encodeURIComponent(t)),n.domain&&(t+="; domain="+n.domain),n.path&&(t+="; path="+n.path),n.duration&&(r=new Date,r.setTime(r.getTime()+1e3*n.duration),t+="; expires="+r.toGMTString()),n.secure&&(t+="; secure"),document.cookie=e+"="+t}catch(e){S(e,"_setCookieInSeconds",null,arguments)}},D=function(){return ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")?ta.m.store.get("bookingSessionId"):null},H=function(){var e=!1;return"boolean"==typeof ta.userLoggedIn&&(e="boolean"==typeof ta.userSecurelyLoggedIn?ta.userLoggedIn?ta.userSecurelyLoggedIn?v:f:g:ta.userLoggedIn),e},U=function(e,t){var r={gac:e[1],gaa:e[2],gal:e[3],gav:e[4],gani:e[5],gass:O(),gasl:M(document.location.href),gads:R(t),gadl:M(t),gapu:I(),gams:H()},a=D();if(!r.gass)throw new Error("Src servlet undefined, gac:"+r.gac+", gaa:"+r.gaa+", gal:"+r.gal);if(!r.gads)throw new Error("Dst servlet undefined. gac:"+r.gac+", gaa:"+r.gaa+", gal:"+r.gal);n.has("gatt")&&(r.gatt=n.retrieve("gatt")),a&&(r.bsid=a),L("EVT",w(r),{domain:cookieDomain,duration:5,encode:!0,path:"/"})},j=function(e){if(!e||!e.className||!e.firstChild)return!1;var t=new RegExp("\\b"+d+"\\b"),n=e.firstChild.nodeType,r=e.firstChild.nodeValue;return t.test(e.className)&&n===s&&""!==r},J=function(){};require.defined("page-model")&&require(["page-model"],function(e){var t=e.session,r=t.analyticsInfo;r&&(n.keep("partials.pageProperties",r.pagePropertyStringForCurrentPageview),n.store("gaMemberState",r.memberState),t.analyticsInfo&&require.defined("ta/Core/TA.Prerender")&&require("ta/Core/TA.Prerender")._init(!0)),J=function(){r&&c.push(JSON.parse(r.jsonForCurrentPageview)),J=function(){}}}),u.getPageData=function(){return J(),c[c.length-1]},u.pushPageData=u._GARecordRequest=function(e,t){var r,a={gac:e[1],gaa:e[2],gal:e[3],gav:e[4],gani:e[5],gass:O(),gasl:document.location?M(document.location.href):null,gapu:I(),gams:H()},i=D();return t&&(a.gacl=t),n.has("gatt")&&(a.gatt=n.retrieve("gatt")),i&&(a.bsid=i),r=require.defined("utils/BatchRequest")?{get::{get:function(){setTimeout(function(){var e=new XMLHttpRequest;e.open("GET","/GARecord?"+W(a),!0),e.send(null)},1)}},b("/GARecord",a),r};var W=l.urlArgLookup=function(e,t){var n=new RegExp("[\\?&]"+e+"=(\\w+)"),r=n.exec(t);return r&&"undefined"!=typeof r[1]?r[1]:null},u._validatedTrackEventArray=function(e,t,n,r,a){return e&&"string"!=typeof e&&(e=e.toString()),t&&"string"!=typeof t&&(t=t.toString()),n&&"string"!=typeof n&&(n=n.toString()),r?"number"!=typeof r&&(r=parseFloat(r),isNaN(r)&&(r=0)):r=0,"boolean"!=typeof a&&(a=a===!0),["_trackEvent",e,t,n,r,a]},u._toEvtParams=function(e){try{var t={gac:e.module,gaa:e.action,gal:e.context,gav:e.value,gani:e.noninteraction};return t.gass=O(),t.gasl=M(document.location.href),t.gapu=I(),t.gams=H(),t}catch(t){S(t,"analytics._toEvtParams",null,e)}},u._trackEventAfterAjax=function(e){try{l.trackDMPBehavior(e.module,e.action,e.context,e.value,e.noninteraction)}catch(t){S(t,"analytics._trackEventAfterAjax",null,e)}},l.getEventPathOptions=function(e,t,n){try{var r=z(n,e);if(!r)return void S(null,"ta.getEventPathOptions - invalid element",null,arguments);var a=$(r);return t&&(a.noninteraction=t),a}catch(e){S(e,"ta.getEventPathOptions",null,arguments)}},u._trackEventPathAfterAjax=function(e){try{l.trackEventOnPage(e.category,e.action,e.label,e.value,e.noninteraction)}catch(e){S(e,"analytics._trackEventPathAfterAjax",null,arguments)}},l.trackPhysicalCommerce=function(e,t,n,r){try{var a=u._validatedTrackEventArray(e,"Commerce-Physical",t,n,!1);u._GARecordRequest(a,r).get()}catch(e){S(e,"ta.trackPhysicalCommerce",null,arguments)}},l.trackAttemptedCommerce=function(e,t,n){try{l.trackDMPBehavior(e,t,n,null,null)}catch(e){S(e,"ta.trackAttemptedCommerce",null,arguments)}},l.trackPhysicalAndAttemptedCommerce=function(e,t,n,r,a){l.trackPhysicalCommerce(e,t,r,a),l.trackAttemptedCommerce(e,t,n,r)},l.trackImpressionEventOnPage=function(e,t,n,r){e=e||"",t=t||"",n=n||"",r=r||0,l.trackEventOnPage(e,t,n,r,!0)},l.trackEventOnPage=function(e,t,n,r,a){o.isObfuscatedProductCode(e)&&(e=o.decodeProductCode(e)),o.isObfuscatedProductCode(t)&&(t=o.decodeProductCode(t)),o.isObfuscatedProductCode(n)&&(n=o.decodeProductCode(n));try{var i=u._validatedTrackEventArray(e,t,n,r,a);u._GARecordRequest(i).get()}catch(e){S(e,"ta.trackEventOnPage",null,arguments)}},l.trackEventOnPageOnce=function(e,t,r,a){var i,o="eventsAlreadyTracked";i="object"==typeof ta&&ta.m&&ta.m.store?ta.m.store.get(o):n.retrieve(o),i||(i={},"object"==typeof ta&&ta.m&&ta.m.store?ta.m.store.add(o,i):n.store(o,i));var u=e+"|"+t+"|"+r;i[u]||(l.trackEventOnPage(e,t,r,0,a),i[u]=!0)},l.trackDMPBehavior=l.setEvtCookie=function(e,t,n,r,a){try{var i=u._validatedTrackEventArray(e,t,n,r,!1);if(U(i,a),require.defined("ta/common/behavior/dmp/DMP")){var o=require("ta/common/behavior/dmp/DMP");o.isEnabled()&&o.sendEventBehavior(e,t,n,r,Z())}}catch(e){S(e,"ta.setEvtCookie",null,arguments)}};var G=function(e){var t;try{if(t=q("MEVT")||"",t.length>0&&(t+="~"),t+=N(e),t.length>1024)throw"MEVT Cookie is full";L("MEVT",t,{domain:cookieDomain,duration:5,encode:!0})}catch(e){return S(e,"_appendMevtCookie",null,arguments),!1}return!0},B="trk",V=B.length,F="etk",X=/^([A-Z]{1,2}:)?[A-Za-z_0-9\-\.]+$/,Z=function(){var e="undefined"!=typeof event?event:window.event;return e?e.target||e.srcElement:document.activeElement};u.getCommentTrackingPath=var z=function(e,t){if(e=r(e),!e&&(e=Z(),!e))return S(null,"_getCommentTrackingPath - no element provided or event target element",null,arguments),null;if(1!=e.nodeType)return null;var n=[];if(t&&"string"==typeof t&&""!==t&&X.test(t)){if("P:"==t.substring(0,2))return n.push(t.substring(2)),n;n.push(t)}if("undefined"==typeof e.previousSibling)return S(null,"_getCommentTrackingPath - browser does not support previousSibling",null,arguments),n;e:for(var a=e;a!=document.body;a=a.parentNode){if(null==a){S(null,"_getCommentTrackingPath - LOOP_PARENT_NODES got unexpected null node",null,arguments);break}for(var i=0,o=a.previousSibling;null!=o;o=o.previousSibling)if(o.nodeType==s){var u=o.nodeValue;if(u==F){i++;continue}if(u.substring(0,V)!=B)continue;if(i>0){i--;continue}var l=u.substring(V).split("/");l||S(null,'ta._getCommentTrackingPath - cannot split context class: "'+u+'"',null,arguments);for(var c=l.length-1;c>=0;c--){var d=l[c],g=X.exec(d);if(g){if("P:"==g[1]){var f=g[0].substring(2);n.push(f);break e}n.push(g[0])}else S(null,'ta._getCommentTrackingPath - tracking prefix used with invalid context: "'+l[c]+'"',null,arguments)}}}return n},$=function(e){if(0===e.length)return null;var t={"action":e[0],"label":"","value":"1","category":e[e.length-1]};e.shift();for(var n=e.length-2;n>=0;n--)t.label+=e[n],n>0&&(t.label+="/"),"N:"==e[n].substring(0,2)&&(t.value=e[n].substring(2));return""===t.label&&(t.label="Unknown"),t};l.trk=function(e,t,n,a){n=r(n);try{var i=n?n.getAttribute("data-trk-path"):null;if(i)i=i.replace("P:",""),i=i.split("/"),i.reverse();else if(i=z(n,e),!i||!i.length){var o="";if(n)if(n.outerHTML){var u=document.createTextNode(n.outerHTML),c=document.createElement("div");c.appendChild(u),o=c.innerHTML.substring(0,100)}else n.nodeName?o=n.nodeName:o+=n;else void 0===n?o="undefined":null===n&&(o="null");return e||(e=null===i?"null path":void 0===i?"undefined path":i.hasOwnProperty("length")?0===i.length?"empty path":i.join(","):"path: "+i),void S(null,"ta.trk - invalid element for "+e+" from "+o,null,arguments)}l.trkWithPath(i,t,a)}catch(e){S(e,"ta.trk",null,arguments)}},l.trkWithPath=function(e,t,n){try{if(!e||!e.length)return void S(null,"ta.trkWithPath - no path in arguments",null,arguments);if(n&&n.length>0&&e.length&&e.splice)for(var r=n.length-1;r>=0;r--)"string"==typeof n[r]&&e.splice(1,0,n[r]);var a=$(e);l.trackEventOnPage(a.category,a.action,a.label,a.value,t)}catch(e){S(e,"ta.trkWithPath - "+e,null,arguments)}},l.trkImpTree=function(e){try{if(!j(e))return void S(null,"ta.trkImpTree called with invalid trackTreeElem!",null,arguments);var t=e.firstChild.nodeValue;ne(t)}catch(e){S(e,"ta.trkImpTree",null,arguments)}},l.recordImpression=function(e,t){if(!e)return void(t&&t());try{ne(Y(e),t)}catch(e){S(e,"ta.recordImpression",null,arguments),t&&t()}};var K="<!--",Q="-->",Y=function(e){var t=e.indexOf(K),n=0,r=e.indexOf(Q);return t!==-1&&(n=t+K.length),r===-1&&(r=e.length),e.substring(n,r)};u.stripCommentsFromTree=Y;var ee="\\",te="/";u.appendAscendTokens=function(e){var t=0,n=0,r=0;for(t=0;t<e.length;t++)if(e[t]===te)r++;else if(e[t]===ee)for(n=t+1;n<e.length&&e[n]===ee;)r--,t=n,n++;if(r>0)for(t=0;t<r;t++)e+=ee;return e};var ne=function(e,t){var n={tTreeStr:e&&e.trim(),tTreeUid:ta.uid&&ta.uid.trim(),tTreeLastReferrer:window.location.href,tTreeIsMemberSignedIn:H()};ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")&&(n.bsid=ta.m.store.get("bookingSessionId")),n.tTreeStr?n.tTreeUid||S(new Error("tTreeUid is null/undefined/empty."),"ta._sendTreeImpression",null):S(new Error("tTreeStr is null/undefined/empty."),"ta._sendTreeImpression",null),_("/ImpressionRecord",{method:"POST",url:"/ImpressionRecord",data:n},t)};l.setEvtCookieAndPath=function(e,t,n){try{n||(n=Z());var r=z(n,e);if(!r)return void S(null,"ta.setEvtCookieAndPath - invalid element for "+e,null,arguments);var a=$(r);if(!t){for(;"A"!=n.nodeName&&n!=document.body;)n=n.parentNode;if(t=n.href,!t)return void S(null,"ta.setEvtCookieAndPath - no url parameter and cannot find a.href",null,arguments)}l.setEvtCookie(a.category,a.action,a.label,a.value,t)}catch(e){S(e,"ta.setEvtCookieAndPath",null,arguments)}},l.recordPageview=function(e,t){if(e){var n=R(e),r="/PageviewRecord",a=t?t:{};n&&(a.servletName=n,_(r,{method:"POST",data:a}))}},l.recordTabView=function(e,t,n){if(e&&t){var r=e+"-"+t,a="/PageviewRecord",i=n?n:{};i.servletName=r,_(a,{method:"POST",data:i})}},l.resetPageDataUrl=l.trackEngagementClick=function(e,t){return e&&t?P(t)?void t(e):void S(new Error("passed variable selectionFunction is not a function"),"ta.trackEngagementClick",null,t):void S(new Error("object/selectionFunction is null/undefined"),"ta.trackEngagementClick",null,arguments)},l.placementNodeSelectorTracker=function(e){if(!e||!e.element||!e.type)return void S(new Error("object/element/type is null/undefined"),"ta.placementNodeSelectorTracker",null,e);var t,n,r,a,i,o,c=e.element,s=e.type,d=u.getCommentTrackingPath(c);if(s+="_Click",!d)return void S(new Error("trackTreePath is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);if(d.length<1)return void S(new Error("trackTreePath is missing information"),"ta.placementNodeSelectorTracker",null,arguments);if(t=d[d.length-1],!t)return void S(new Error("placement is null/undefined"),"ta.placementNodeSelectorTracker",null,d);for(o=d.length-1;o>=0;o--)if(i=d[o],i&&0===i.indexOf("N:")){n=i;break}if("HH_MainList"===t||"Maps_MetaBlock"===t)n="N:1";else if(!n)return void S(new Error("positionNode is null/undefined"),"ta.placementNodeSelectorTracker",null,d);if(r=n.split(":"),!r||2!==r.length)return void S(new Error("positionSplit appears to be incorrect"),"ta.placementNodeSelectorTracker",null,arguments);if(a=r[1],!a)return void S(new Error("position is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);var g=parseInt(a,10);if(isNaN(g))return void S(new Error("position is not a number"),"ta.placementNodeSelectorTracker",null,a);var f=ae(t);if(f!==-1){a=g+f,t=re(t);var v,p=document.querySelectorAll(".ui_tab_bar .ui_tab.selected");1===p.length&&(p=p[0],v=p.getAttribute("data-currentSort")),l.trackEventOnPage(t,s,v,a)}};var re=function(e){if(!e)return e;if("Hotels"!==O())return"Clicks_"+e;var t;return"Hotels_MainList"===e||"Hotels_MainList_Sponsored"===e||"Hotels_MainList_Discovery_Sponsored_Listing"===e?t="Clicks_"+e:"sponsored_coupon_listing"===e&&(t="Clicks_Hotels_MainList_Sponsored"),document.getElementById("sponsoredCouponListingWrap")&&"Clicks_Hotels_MainList"===t&&(t+="_Sponsored"),t+=ta.widgets.calendar.getCheckRatesData()?"_PostDates":"_PreDates"},ae=function(e){if(!e)return S(new Error("placement is null/undefined"),"ta._shiftOrdinalsWithSponsoredPlacement",null,e),-1;if("Hotels"!==O())return 0;var t=0,r=n.retrieve("hac.offset");if(r&&r>0&&(t=r),!document.getElementById("sponsoredCouponListingWrap"))return t;var a,i=document.querySelector("#HAC_RESULTS .pageNumbers .current");if(i){var o=i.getAttribute("data-page-number");if(a=parseInt(o,10),isNaN(a)||!a)return S(new Error("pageNumber is not a number"),"ta._shiftOrdinalsWithSponsoredPlacement",null,o),-1}return"Hotels_MainList"===e?t+=a:(r&&r>0&&("sponsored_coupon_listing"===e||"Hotels_MainList_Sponsored"===e||"Hotels_MainList_Discovery_Sponsored_Listing"===e)&&(t+=a-1),t)};l.getRecentTARecords=function(){return E},l.addTypeAheadMevt=l.addGARecordMevt=function(e,t,r,a,i){try{var o=u._validatedTrackEventArray(e,t,r,a,!1),l={t:"ga",gac:o[1],gaa:o[2],gal:o[3],gav:o[4],gani:o[5],gass:O(),gasl:M(document.location.href),gads:R(i),gadl:M(i),gapu:I(),gams:H()},c=D();if(!l.gass)throw new Error("Src servlet undefined, gac:"+l.gac+", gaa:"+l.gaa+", gal:"+l.gal);if(!l.gads)throw new Error("Dst servlet undefined. gac:"+l.gac+", gaa:"+l.gaa+", gal:"+l.gal);if(n.has("gatt")&&(l.gatt=n.retrieve("gatt")),c&&(l.bsid=c),G(l),require.defined("ta/common/behavior/dmp/DMP")){var s=require("ta/common/behavior/dmp/DMP");s.isEnabled()&&s.sendEventBehavior(e,t,r,a,Z())}}catch(e){S(e,"ta.addGARecordMevt",null,arguments)}},l.trackInteractions=function(e,t,n){var r={"elmtSource":e,"elmtType":n};r=i.extend(r,t),_("/UserInteractionRecord",{method:"POST",url:"/UserInteractionRecord",data:r},null,},l.addInteractionsMEVT=function(e,t,n){var r={"t":"ia","ias":e,"iak":ie(t),"iat":n};G(r)};var ie=function(e){var t="";return Object.keys(e).forEach(,0==t.length?t:t.slice(0,-1)},oe=!1,ue=function(e,t){return oe||(oe=require.defined("page-model")?require("page-model").session:{}),!!oe.useERUserTracking&&!(oe.ERUserTrackingEventNames&&oe.ERUserTrackingEventNames.length>0&&oe.ERUserTrackingEventNames.indexOf(e)<0)},le=function(e,t,n){if(ue(e,t)){var r=oe.uid&&{request_uid:oe.uid}||{},a={event_name:e,event_type:t,attr:JSON.stringify(i.extend(n,r))},o={get:function(){setTimeout(function(){var e=new XMLHttpRequest;e.open("GET","/UserTrackingRecord?"+W(a),!0),e.send(null)},1)}};return o.get()}n.event_name=e,l.trackEventOnPage(p,t,JSON.stringify(n))};l.trackImpressionWithJson=function(e,t){le(e,m,t)},l.trackActionWithJson=function(e,t){le(e,h,t)},l.trackPageviewWithJson=function(e,t){le(e,k,t)},l.trackSearchWithJson=l.trackUnifiedEvent=le,t.createNs(u,"ta","analytics"),t.exportTo(l,"ta");var ce={};return t.exportTo(u,ce),t.exportTo(l,ce),ce});
define("utils/ajax",["lib/jquery-amd","ta/Core/TA.Record","utils/form-to-json"],function(e,t,i){eturn function(r,a){r.substr||(a=r);var s=e.extend({},a,{dataFilter:function(e,t){return"json"==t&&(e=e.replace(/^\s*while\s*\([^)]*\);?/,"")),a&&a.dataFilter&&a.dataFilter.call(this,e,t),e}});s.xhrFields=s.xhrFields||{},s.xhrFields.withCredentials=!0,n(s.data)&&(s.data=i(s.data));var c=s.trackEvent;return c&&(e.extend(s,t._toEvtParams(c)),s.complete=function(){t._trackEventAfterAjax(c),a&&a.complete&&a.complete.apply(this,arguments)}),s.evalScripts&&(s.success=function(t,i,n){if(t&&t.substr){var r,s;e.parseHTML?(r=e(e.parseHTML(t,document,!0)),s=r.filter("script").add(r.find("script"))):(r=e("<div>"+t+"</div>"),s=r.find("script")),s.each(function(e,t){if(t.innerHTML)if(window.execScript)window.execScript(t.innerHTML);else if(window.eval)window.eval(t.innerHTML);else{var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.text=t.innerHTML,document.head.appendChild(i),document.head.removeChild(i)}})}a&&a.success&&a.success.apply(this,arguments)}),r.substr?e.ajax(r,s):e.ajax(s)}});
define("mixins/Events",["vanillajs"],function(e){"use strict";var t=function(){this.events={},Array.prototype.slice.call(arguments).forEach(this)};return t.create=function(){eturn e.prototype=t.prototype,(),t.extend=function(e,r){var i=Object.create(t.prototype);return i.delegate=e,t.apply(i,r),i},t.prototype.on=t.prototype.addListener=function(e,t){return void 0!==this.events[e]?this.events[e].push(t):this.delegate?this.delegate.on(e,t):this.events[e]=[t],this},t.prototype.off=t.prototype.removeListener=function(e,t){if(void 0!==this.events[e])if(t){var r=this.events[e].indexOf(t);r>=0&&this.events[e].splice(r,1)}else this.events[e].length=0;else this.delegate&&this.delegate.removeListener(e,t);return this},t.prototype.removeAllListeners=function(e){if(e&&void 0!==this.events[e])this.events[e].length=0;else if(e)this.delegate&&this.delegate.removeAllListeners&&this.delegate.removeAllListeners(e);else{for(var t in this.events)this.events.hasOwnProperty(t)&&(this.events[t].length=0);this.delegate&&this.delegate.removeAllListeners&&this.delegate.removeAllListeners()}},t.prototype.hasListeners=function(e){if(e){if(this.events.hasOwnProperty(e))return this.events[e].length>0;if(this.delegate&&this.delegate.hasListeners)return this.delegate.hasListeners(e)}return!1},t.prototype.emit=function(e,t){if(this.events[e]){var r=Array.prototype.slice.call(arguments,1);this.events[e].slice(0).forEach(function(t){if(t)try{t.apply(this,r)}catch(t){"string"==typeof t&&(t=new Error(t));var i="Error in event handler for "+e;if(require.defined("ta/util/Error"))require("ta/util/Error").record(t,i);else{var s=require.defined("ta")&&require("ta");s&&s.log&&s.log.error?s.log.error(t,i):s&&s.m&&s.m.recordJSError?s.m.recordJSError([t,i]):"undefined"!=typeof console&&(console.error||console.log)(i,t)}}},this)}else this.delegate&&this.delegate.emit&&this.delegate.emit.apply(delegate,arguments);return this},t.prototype.addOrReplaceListener=t});
define("ta/util/Cookie",["vanillajs","ns-exporter"],function(e,o){var t=0,n=5e3,i={cookiePIDName:"NPID",ONE_DAY:864e5,ONE_HOUR:36e5,setPIDCookie:function(e){i.write(i.cookiePIDName,e,n,"/",window.cookieDomain)},removePIDCookie:function(){try{i.write(i.cookiePIDName,"",t,"/",window.cookieDomain)}catch(e){}},canSet:function(){return document.cookie="SessionTest=true",!!document.cookie.match("(^|;)\\s*SessionTest=true\\s*(;|$)")&&(document.cookie="SessionTest=; expires=Thu, 01 Jan 1970 00:00:01 GMT",!0)},readRaw:function(e){e=e.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1");var o=document.cookie.match(new RegExp("(?:^|;)\\s*"+e+"=([^;]*)"));return!!o&&o[1]},remove:write:function(e,o,t,n,i){"number"==typeof t&&(t=new Date(Date.now()+t)),document.cookie=e+"="+o+(t?"; expires="+t.toUTCString():"")+(n?"; path="+n:"")+(i?"; domain="+i:"")},setOneTimeCookieOnFQDN:function(e,o){return i.write(e,o,5e3),!0},setOneTimeCookie:function(e,o){return i.write(e,o,5e3,null,window.cookieDomain),!0}};return o.exportTo({setPID:i.setPIDCookie}),o.createNs(i,"ta.util","cookie"),i});
define("ta/Core/TA.LocalStorage",["vanillajs","common/trackingStreams","ns-exporter"],function(e,t,n){"use strict";var r=!1,o="taLsTest",i="1",a="TALocalStorageCurrentSessionId",u=!1,s="session-",l=!1,c=[],f=[],v=[],g=m=function(e){return!!g()||(t.error(null,"Accessing localStorage session cookie before session logic intialized: "+e),!1)},S=function(e){return d(e,"value")},y=d=function(e,t){if(!t)return null;try{var n,o=JSON.parse(r.getItem(e)||"0");return o?o.ttl&&o.ttl+o.now<(new Date).getTime()?(r.removeItem(e),null):o.hasOwnProperty(t)?(r.setItem("512",o[t]),n=r.getItem("512"),r.removeItem("512"),n):null:null}catch(e){}return null},h=function(e,t){try{var n=JSON.parse(e||"0");return n&&n.hasOwnProperty(t)?n[t]:null}catch(e){return null}},w=function(e){try{var t=JSON.parse(r.getItem(e)||"0");return t?t.ttl&&t.ttl+t.now<(new Date).getTime()?(r.removeItem(e),null):t.value:null}catch(e){}return null},I=p=function(e,t){var n=y(e);if(t&&n&&n<(new Date).getTime()-t)try{r.removeItem(e)}catch(e){}},O=function(e){try{var t=r.getItem(e);if(null!==t&&void 0!==t)return!0}catch(e){}return!1},T=function(e,t,n){try{r.setItem(e,JSON.stringify({ttl:n||0,now:(new Date).getTime(),value:t}))}catch(e){}},k=function(e){if(l=!0,!e)return t.error(null,"Attempting to initialize localStorage with invalid sesion key: "+e),!1;if(!V())return!1;if(u=S(a),!u||u!=e){u=e,T(a,u);var n=S("latestPageServlet");n&&T("sessionEntryServlet",n),E(),O(a)&&require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").store("isFirstSessionPageView",!0)}for(var r=0;r<v.length;r++)v[r]();v=[]},E=function(){try{var e=s+u,t=new RegExp("^"+s);if(r.length)for(var n=0;n<r.length;n++){var o=r.key(n);try{t.test(o)&&o!=e&&I(o)}catch(e){}}}catch(e){}},V=function(){try{if(r&&r.setItem){r.setItem(o,i);var e=r.getItem(o)!=i;return r.removeItem(o),e&&(r=!1),!!r}}catch(e){}return!1},N=function(e){try{r.setItem("session-"+u,JSON.stringify(e))}catch(e){}},b=function(){try{var e=r.getItem("session-"+u);if(e)return JSON.parse(e)}catch(e){}return{}},A=function(e){c.push(e)},C=J=function(e){"function"==typeof e&&(g()?e():v.push(e))},L={enabled:V(),get:S,getObject:w,set:T,remove:I,removeIfElapsed:p,has:O,getTimeStamp:y,updateSessionId:k,onSessionStorageChange:A,onValueChange:C,canUseSession:g,onLocalStorageSessionInit:J,getSessionKey:function(e){if(!m(e))return null;var t=b();return t?t[e]:null},setSessionKey:function(e,t){if(m(e)){var n=b();n||(n={}),n[e]=t,N(n)}},removeSessionKey:function(e){if(m(e)){var t=b();t&&(delete t[e],N(t))}},hasSessionKey:function(e){if(!m(e))return!1;var t=b();if(t){var n=t[e];if(null!==n&&void 0!==n)return!0}return!1},setStorage:function(e){r=e,L.enabled=V()}};if("undefined"!=typeof window){var j=!1;try{j=window.localStorage}catch(e){}L.setStorage(j),function(){function e(e){if(e=e||window.event,!u||e.key&&e.key!=="session-"+u)e.key&&f[e.key]&&(e.oldValueObj=e.oldValue&&h(e.oldValue,"value"),e.newValueObj=e.newValue&&h(e.newValue,"value"),f[e.key].forEach(function(t){t(e)}));else for(var t=0,n=c.length;t<n;t++)c[t](e)}window.addEventListener?window.addEventListener("storage",e,!1):window.attachEvent&&window.attachEvent("onstorage",e)}()}return n.createNs(L,"ta","localStorage"),L});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/Core/TA.Store","utils/store","ta/Core/TA.Load","ta/Core/TA.FireEvent","ta/Core/TA.Event","ta/Core/TA.Record","ta/util/Error","ta/util/Selenium","ta/util/roybatty","ta/Core/TA.LocalStorage","ta/Core/TA.Prerender","ta/projects","ta/Browser","ta/util/ScreenSizeRecord","utils/BatchRequest","utils/ceUtils"],["ta","ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/core-without-dust-or-mootools","files":{"js3_secure":{"ssl":{"ta":{"Core":{"TA.Record":1,"TA.Prerender":1}}}},"js-amd":{"src":{"utils":{"BatchRequest":1,"ceUtils":1,"store":1}}},"js3":{"src":{"ta":{"projects":1,"util":{"ScreenSizeRecord":1,"roybatty":1,"Error":1,"Selenium":1},"Browser":1,"Core":{"TA.FireEvent":1,"TA.Event":1,"TA.Load":1,"TA.LocalStorage":1,"TA.Store":1}}}}},"_":{"baseUrl":"/"}});
define("utils/store",["vanillajs","ta/Core/TA.Store"],;
define("ta/Core/TA.Load",["vanillajs","ns-exporter","ta/Core/TA.Store","utils/resourceLoader"],function(e,r,o,a){function t(e){if("string"==typeof e&&VERSION_MAP){var r=!1;if(VERSION_MAP[e])r=e;else if(VERSION_MAP[e+".js"])r=e+".js";else for(var o=e.split("."),a=0;o&&o.length>1&&a<10;){o=o.slice(0,-1);var t=o.join("-")+".js";if(t&&VERSION_MAP[t]){r=t;break}a++}return r}}var n={};return n.load=function(e,r,n){var i=!1,s=t(e);s&&(i=VERSION_MAP[s]);var l=function(){var e=o.remove(f);e&&e.forEach(function(e){e&&e()})};if(i){var f=s+"_callback";if(o.has(f)){var c=o.retrieve(f);c.push(r),o.store(f,c)}else o.store(f,[function(){delete VERSION_MAP[s],r&&r()}]),"object"==typeof i?a.load(i,{serial:!0,forceType:"js"},l):a.load(i,{forceType:"js"},l)}else n&&a.loaded(i)&&(l(),r&&r());return i},n.loadInOrder=function(e,r){a.load(e,{serial:!0},r)},r.exportTo(n,"ta"),n});
define("ta/Core/TA.FireEvent",["vanillajs"],function(){var n={},e={};return n.on=n.fireEvent=function(n,r){var i=Array.prototype.slice.call(arguments),t=e[n];i.shift(),t&&t.slice(0).forEach(function(n){try{n.apply(null,i)}catch(n){window.IS_DEBUG&&(console.error||console.log)("Exception in TA.FireEvent handler",n)}})},n.off=function(n,r){if(r){var i,t=e[n];t instanceof Array&&(i=t.indexOf(r),i>=0&&t.splice(i,1))}else delete e[n]},n.hasEventListener=function(n){return!!e[n]},n});
define("ta/Core/TA.Event",["vanillajs","common/trackingStreams","ns-exporter","ta/Core/TA.FireEvent"],function(vanilla,tracks,nsExporter,fireEvent){function _makeClosure(e,t){var n=this;return t=Array.prototype.slice.call(t),function(){e.apply(n,t)}}function QueueTimer(e,t){var n=0,r=0,o=[],a=0,u=!1;this.start=function(){n&&clearTimeout(n),a=Date.now()},this.end=function(i){var c=Date.now(),f=c-a;r+=f;var l=""+f+"ms ["+(i||"")+"]",s=e+(t?"-after":"");u?console.error("Straggler for "+s+": "+l):(o.push(l),n=setTimeout(function(){console.error("Timing for "+s+": "+r+"ms\n"+o.sort(.join("\n")),u=!0},2e3))}}var exports={on:fireEvent.on,off:fireEvent.off,fireEvent:fireEvent.fireEvent,hasEventListener:fireEvent.hasEventListener};exports.call=function(e,t,n,r){if(null==t)return IS_DEBUG&&alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);"),!1;if(null==e)return IS_DEBUG&&alert("ta.call of undefined function"),!1;var o=e;if("function"==typeof e)e="<func>";else if(!/^ta\.[\w\d\.]+$/.test(e))return IS_DEBUG&&alert("Invalid function name. Must be of the form: ta.namespace.Class.function"),!1;var a=t||window.event;["stopPropagation","preventDefault"].forEach(function(e){a[e]||(a[e]=function(){})}),a.stop||(a.stop=function(){a.preventDefault(),a.stopPropagation()}),n||(n=a.target||a.srcElement),n||tracks.error(null,"ta.call re-wrap fail (non-DOM element) - "+e,t,{"funcName":e});var u=arguments,i=Array.prototype.slice.call(u,3);i.splice(0,0,a,n);try{return i.unshift({callback:_ta_call_defer,evt:a}),i.unshift(o),exports.run.apply(null,i)}catch(n){tracks.error(n,"ta.call - "+e,t)}return!1};var _ta_call_defer=function(e,t){t&&delete t.evt,exports.run.apply(null,arguments)};exports.run=function(e,t){var n=arguments,r=Array.prototype.slice.call(n,2);try{var o=exports.fn(e);if("function"==typeof o){var a=o.apply(window,Array.prototype.slice.call(r));if(t&&t.onComplete){var u=exports.fn(t.onComplete);u&&u(a)}return a}t&&t.evt&&(t.evt.stopPropagation?t.evt.stopPropagation():t.evt.cancelBubble=!0,t.evt.preventDefault?t.evt.preventDefault():t.evt.returnValue=!1);var i=_makeClosure(t&&t.callback||exports.run,arguments);require(["trjs!ta/Core/TA.Load"],function(t){try{t.load(e,i)}catch(t){tracks.error(t,"ta.run - "+e)}})}catch(t){tracks.error(t,"ta.run - "+e)}return!1};var OneTimeFunctionQueue=function(e,t,n){ar o,a=[],u=!!n,i=function(n,r){o&&o.start();try{n()}catch(n){try{tracks.error(n,"OneTimeFunctionQueue "+e+(t?"-after":"")+(r?"-"+r:""))}catch(e){}}o&&o.end(r)},c=function(){if(a.sort(,t){var e=1;a.forEach(function(t){setTimeout(i.bind(null,t.func,t.name),e++)})}else a.forEach(;a=[]};null!=e&&(window.addEventListener?window.addEventListener(e,r,!1):window.attachEvent&&("DOMContentLoaded"==e?window.attachEvent("onload",r):"load"==e?window.attachEvent("on"+e,:window.attachEvent("on"+e,r))),this.addToQueue=function(t,n,r){return t?("string"==typeof n&&(r=n,n=!1),void(u?i(t,r):(n=n||100+a.length,a.push({func:t,priority:n,name:r,subpriority:a.length})))):void tracks.error(null,"addToQueue for "+e+" queue - no function")},this.executeQueue=function(){c()}},loaded="undefined"!=typeof document&&"complete"===document.readyState,ready="undefined"!=typeof document&&"interactive"===document.readyState||loaded,_readyQ=new OneTimeFunctionQueue("DOMContentLoaded",!1,ready),_loadQ=new OneTimeFunctionQueue("load",!1,loaded),_afterLoadQ=new OneTimeFunctionQueue("load",!0);ready||_loadQ.addToQueue(function(){_readyQ.executeQueue()},-999999999,"checkReadyQueue"),_loadQ.addToQueue(function(){_afterLoadQ.executeQueue()},999999999,"afterLoadQueue"),exports.queueForReady=function(e,t,n){_readyQ.addToQueue(e,t,n)},exports.queueForLoad=function(e,t,n){_loadQ.addToQueue(e,t,n)},exports.queueForAfterLoad=exports.fn=function(fn){switch(typeof fn){case"function":return fn;case"string":var f=!1;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join(".")),f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&"function"==typeof f)return f}return null},exports.fireClick=exports.throttle=function(e,t,n,r){function o(){delete m_throttles[t],a.cb()}var a,u=(new Date).getTime();if(t in m_throttles){if(a=m_throttles[t],u-a.lastReset<a.minResolution)return void(a.cb=e)}else a=m_throttles[t]={start:u,minResolution:Math.max(Math.floor(n/10),50)};a.cb=e,a.timeout&&clearTimeout(a.timeout),r&&u-a.start>r?o():(a.lastReset=u,a.timeout=setTimeout(o,n))};var m_throttles={};return nsExporter.exportTo(exports,ta),exports});
define("ta/util/Error",["vanillajs","api-mod","utils/ajax","ns-exporter","mixins/Events","utils/browserutils","ta/util/Cookie","ta"],function(r,e,t,o,n,a,i,c){function s(r,t){var o="_extraInfoError_:Problem storing extra info.",n={},a="";try{if(Array.isArray(t)||"[object Arguments]"===Object.prototype.toString.call(t)){for(var i={},c=0;c<t.length;c++){var s=t[c],l=typeof s;"string"===l||"number"===l||"boolean"===l?i[c]=s:i[c]=l}t=i}e.merge(n,r,t)}catch(e){n=r}try{if(a=JSON.stringify(n))return a.length>y&&(a=a.substring(0,y)),a.replace(/[\r\n]/g,"")}catch(r){}return o}function l(r){return"undefined"!=typeof r&&null!==r?r.toString().replace(/[\r\n]/g,""):"null or undefined"}function f(r,e,t){var o,n="";if(r&&r.stack)try{var a,i,c=r.stack.split("\n"),s=[],l=0;c[1]&&c[1].match(/\.record /)&&c.splice(1,1);for(var f=0;f<c.length;f++){var u=c[f];if(!(u.indexOf(r.message)>=0)){var d=!!u.match(/\/jquery-|\/mootools|\(native\)|\(native code\)|\[native code]/);u=u.replace(/^(.*)http.+\/([^\/]*)/,"$1$2").replace(/(\?.{20})[^:)]+/,"$1...").replace(/^(?:\s+\w+\s*([^\s]+)|([^\s]+)@)\s*\(?([^)]*)\)?$/,"$1$2 ($3)").replace(/\s*\(\)/,""),a&&d?i||(s.push("..."),i=!0,l++):(s.push(u),d&&l++),d||(i=!1),a=d}}s.length-l<=w&&(o=!0),n=s.join()}catch(r){h&&(console.error("Debug: error.stack handler failed "),console.error(r))}if(!n&&t)try{for(var g=[],m=t.caller,v=0;m&&v++<20;){var S=m.toString(),y=S.replace(/^function\s+([^(\s]+).*/,"$1")||"anonymous";if(!y.match(/onErrorFunc|_getErrorStack/)){var R=Math.min(S.length,100),E=S.substring(0,R).replace(/(\n|\r|\'|\")/g," ");g.push(E)}m=m.caller}g.length<5&&(o=!0),n=g.join(" :: ")}catch(r){h&&console.error("Debug: exception getting callee stack "+r)}if(!n&&r&&r.filename&&(n=r.filename.replace(/^.*\/([^/]+)$/,"$1"),r.lineno&&(n+=":"+r.lineno),r.colno&&(n+=":"+r.colno)),e&&o){var b=p.getSelectorString(e);b&&(n&&(n+=", "),n+="DOM_STACK: "+b)}return n?n:"failed to get stack"}function u(){var r=[];return[].forEach.call(document.getElementsByTagName("script"),function(e){var t=e.src;d(t)&&r.push(t.substring(t.indexOf("/js")+1))}),r.join(", ").substring(0,y)}function d(r){if(!r||!r.indexOf)return!1;var e=window.CDNHOST||"";return h&&""==e?null!=r.match(/(js3\/|js\/)/):0==r.indexOf(e)}function g(r){if(!r||!r.indexOf)return!1;var e="noPage";try{e=window.location.href}catch(r){}return r===e}function m(){var r=(a.Platform.ios||a.Platform.android)&&!window.isTabletOnFullSite,e=document.cookie.indexOf("TAmobilemode=main")>=0;return r&&!e}function v(r){if(m()){var e={eMsg:"msg",eStak:"stack",eUrl:"url"};for(var t in e){var o=e[t];r[o]=r[t]}r.file=r.url||document.URL,r.site=window.SITE_VERSION,r.loaded=O?"dom_ready":"not_loaded"}}var p={},S=new n("error","beforeSend"),h=window.IS_DEBUG,y=3e3,R=h?100:10,w=4,E="unset",b=0,O=!1;return p.record=function(r,e,o,n,a,y){y=y||{},r?"string"==typeof r&&(r=new Error(r)):r=new Error("Stub error to build stack.");var w=!1;try{var O=Object.prototype.toString.call(r);w=O===Object.prototype.toString.call(new Error)||O.match(/\[object Error[\w]*]/)}catch(r){}if(w&&!r.stack)try{throw r}catch(e){e&&e.stack&&(r=e)}o=o||window.event||{};var N=o.target;if(b>=R)return void(h&&console.error("Maximum JS errors reached. Not reporting."));b++;var j=!1;try{j=document.body.className.match(/\bjs_logging\b/)||m()}catch(r){}if(j){var _=!0;n&&n.hasOwnProperty("error_script")&&!d(n.error_script)&&!g(n.error_script)&&(_=!1);var k={};if(N)try{k.eTarg=p.getSelectorString(N)}catch(r){}"undefined"!=typeof debugCacheKey&&(k.key=debugCacheKey);var T=window.pageServlet;T||(T="unknown"),k.servlet=T,a&&"string"==typeof a||(a="ERROR"),_?!h&&b>1?(a="WARN",k.warnReason="notFirstJSError"):"object"==typeof r&&"WARN"===r.level&&(a="WARN"):(a="WARN",k.warnReason="externalError");var A={"extraInfoError":"Problem storing extra info"},x={};try{var D="",L="";N&&("function"!=typeof N.id&&(D=N.id),L=N.className);var P=window.serverPool||"",I="";window.MooTools&&(I+="MooTools "),require.defined("lib/jquery-amd")&&(I+="jQuery "),x={"TARGET_ID":D,"TARGET_CLASS":L,"PAGE_UID":c&&c.uid,"INTERNAL_JS":u(),"CLIENT_POOL":P,"COOKIES_ENABLED":i.canSet(),"JS_LIBS":I},_||(x.INTERNAL_ERROR="false"),b>1&&(x.PRIOR_JS_PAGE_ERRORS=b-1)}catch(r){n=A}k.xInfo=s(x,n);try{k.eUrl=window.location.href}catch(r){}try{var J=c.page.getDates("STAYDATES");J?k.eDates=J[0].toLocaleDateString("en-US")+" - "+J[1].toLocaleDateString("en-US"):k.eDates="No dates set"}catch(r){}var $="No Error";try{if(w)$=r.name+"-"+r.message;else if("object"==typeof r)if(r.name&&r.message)$=r.name+"-"+r.message;else{$="non-Error object "+Object.prototype.toString.call(r)+" passed, sample properties - ";var M=0;for(var C in r)if(r.hasOwnProperty(C)&&($+=C.substring(0,30)+": "+(r[C]&&r[C].toString?r[C].toString().substring(0,20):r[C])+", ",++M>4))break}else $="non-Object error passed: "+(""+r).substring(0,60);$=$.replace(/[\r\n]/g,"")}catch(r){}k.eMsg=$;try{k.eBlk=l(e).substring(0,150)}catch(r){}var U;if(!r.stack)try{U=o&&o.callee||arguments&&arguments.callee}catch(r){}var B=f(r,N,U);B&&(k.eStak=B);try{S.emit("beforeSend",k)}catch(r){}k.eLogLevel=a,v(k),h&&!y.isglobal&&(console.error("/JSErrorRecord:"),r.stack?console.error(r.stack):B?console.error(B):console.error("No stack"));try{t({url:"/JSErrorRecord",data:k,method:"POST",type:"POST"})}catch(r){k={"eBlk":"JSErrorRecord Error","servlet":T,"eLogLevel":"ERROR","eMsg":"no error retrieved"},t({url:"/JSErrorRecord",data:k})}if(h&&(window.ERRORS||(window.ERRORS=[])).push(k),S.emit("error",$,e,a,k.eStak),"unset"==E&&(E=i.readRaw("JS_ERROR_HANDLING")),E){if(E.match(/alert/)){var G="";for(var F in k)k.hasOwnProperty(F)&&(G=G+F+": "+k[F]+"\n");alert(G)}E.match(/console/)&&window.console&&console.error(k)}}},p.getSelectorString=function(r){for(var e=[];r&&"HTML"!=r.tagName&&r!=document;r=r.parentNode){var t=r.tagName;r.id&&(t+="#"+r.id),r.className&&(t+="."+r.className.trim().replace(/\s+/g,".")),e.unshift(t)}return e.join(">")},p.ajaxFailure=function(r,t,o,n){p.record(null,r,null,e.merge({status:t.status},o),n||"ERROR")},p.enableDomReadyParam=function(){O=!0},p.on=S.on.bind(S),p.off=S.off.bind(S),(a.firefox&&a.version<5||a.ie&&a.version<10)&&(p.record=function(){window.console&&console.error("Unreported error: "+[].slice.call(arguments).join(", "))}),o.createNs(p,"ta.util","error"),p});
define("ta/util/Selenium",["vanillajs","ns-exporter","mixins/Events","ta/Core/TA.LocalStorage","ta/util/Error"],function(r,t,e,n,o){var a={},i=" :: ",l="lastError";return a.lastErrorOnPage=function(){return n.getObject(l)},o.on("error",function(r,t,e,o){"ERROR"===e&&n.set(l,e+i+t+i+r+i+"Stack -> "+o)}),t.exportTo(a,"ta.util.selenium"),a});
define("ta/util/roybatty",["vanillajs","utils/ajax","ta/Core/TA.Event","ta/util/Error","ta/util/Cookie"],function(e,t,r,o,a){var i=!1;return r.queueForLoad(function(){if(window.taSecureToken)try{if(!window.taEarlyRoyBattyStatus){var e=a.readRaw("roybatty");if(e){var r=e.split(",");if(2==r.length){var n=parseInt(r[1],10);a.write("roybatty",taSecureToken+","+n,null,"/",cookieDomain)}else 1==r.length?a.write("roybatty",taSecureToken):o.record(null,"royBatty -- Bad value in cookie: "+e)}else a.write("roybatty",taSecureToken+",1",null,"/",cookieDomain),t(require.defined("ta/Browser")&&require("ta/Browser").isIEMetro()?"/CookiePingback?metroBrowser=true":"/CookiePingback")}i=!0}catch(e){o.record(e,"javascript exection bot detection error")}},"RoyBatty"),{isDone:function(){return i}}});
window.ta||(window.ta={}),define("ta/util/RecordInterruption",["vanillajs","ta/Core/TA.Record","ta/util/Error"],function(t,r,n){"use strict";var e="interruption_record",o=["popup","popunder","gate","other"],i=u=return{record:function(t,n){try{u(t)?n?r.trackEventOnPage(e,t,n.replace(",",""),0,!0):i("ta/util/RecordInterruption: Name cannot be null or blank"):i("ta/util/RecordInterruption: Invalid type")}catch(t){i("ta/util/RecordInterruption: exception tracking event",t)}}}});
define("ta/Core/TA.Prerender",["vanillajs","api-mod","ta/Core/TA.Record","ta/util/Error"],function(t,e,i,r,n){"use strict";var a={states:{PREFETCH_SENT:"prefetchSent",CLEAR:"clear"}},s=function(t,e,i,n,a){if(r._validatedTrackEventArray&&r._GARecordRequest){var s=r._validatedTrackEventArray(t,e,i,n,a);return r._GARecordRequest(s).get(),!0}return!1},d=function(){if("visibilityState"in document)return a._visibilityState="visibilityState",void(a._visibilitystatechanged="visibilitychange");for(var t=["webkit","moz","ms","o"],e=0;e<t.length;e++)t[e]+"VisibilityState"in document&&(a._visibilityState=t[e]+"VisibilityState",a._visibilitystatechanged=t[e]+"visibilitychange")},c=function(){try{a._state===a.states.PREFETCH_SENT&&"prerender"!==document[a._visibilityState]&&(s("Prerender","shown","",0,!0),a._state=a.states.CLEAR)}catch(t){n.record(t)}};return a._init=function(t){try{if(a._enabled=t,a._state=a.states.CLEAR,d(),!a.isSupported()||!a.isEnabled())return;"prerender"===document[a._visibilityState]&&s("Prerender","prefetch","",0,!0)&&(a._state=a.states.PREFETCH_SENT,document.addEventListener(a._visibilitystatechanged,c,!1))}catch(t){n.record(t)}},a.isEnabled=a.isSupported=a});
define("ta/projects",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(t,e,n){function s(t,e){return!!(t&&e&&t.className.match(new RegExp("\\b"+e+"\\b")))}function r(t,e,n){return i.has(t)||i.setIfClass(t,e,n),i.get(t)}var i={vals:{},set:setIfClass:function(t,e,n){"string"==typeof e&&(e=document.getElementById(e)),i.vals[t]=s(e,n)},get:function(t){return i.vals[t]},has:,a={};return a.isHotelsRedesign2011=function(){var t="isHotelsRedesign2011";return i.has(t)||i.setIfClass(t,"HAC_SMRY","hotels_re_2011"),i.get(t)},a.isSmartDealsFilters=function(){return r("smartDealsFilters","DEALS","sdfilters")},a.isAttractionsRedesign2012=function(){return r("isAttractionsRedesign2012","ATTRACTIONS_2012","gridA")},a.isMetaHomepageIntegration2013=function(){return r("isMetaHomepageIntegration2013","PPT","ppt_container")},a.isMetaHotels2013=a.isMetaHotelsRequest=function(){return n.has("isMetaHotelsRequest")},a.isSmartDealsHSXSortEnabled=function(){return n.has("isSmartDealsHSXSortEnabled")},a.isHRTabs2014=function(){return n.has("hr_tabs_2014")},a.isTabletAlbumViewer=function(){return n.retrieve("tabletAlbumPhotoLightbox.enabled")},a.isAirport=e.exportTo(a,"ta"),a});
define("ta/Browser",["vanillajs","ns-exporter"],function(e,n){var t,r={},i=function(){return navigator.userAgent.indexOf("MSIE 10.0")>=0},o=r.isIE11orHigher=return r.isIE9orHigher=function(){return navigator.appVersion.indexOf("MSIE 9")>=0||i()||o()},r.isIE10Metro=r.isIEMetro=function(){var e=null,n=o(),t=n?127:0,r=window.innerWidth==screen.width&&screen.height-window.innerHeight===t;try{e=!!new ActiveXObject("htmlfile")}catch(n){e=!1}return!e&&r&&(n||i())},r.isIE=r.isChrome=r.getFlashVersion=function(){if("number"!=typeof t){var e;try{e=navigator.plugins["Shockwave Flash"].description}catch(n){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){}}var n=(e||"0 r0").match(/\d+/g);t=Number(n[0]||"0."+n[1])||0}return t},r.isChromeIncognito=function(e){var n=window.RequestFileSystem||window.webkitRequestFileSystem;return n&&"function"==typeof n?void n(window.TEMPORARY,100,function(){e("normal")},function(){e("incognito")}):void e("undetermined")},n.exportTo(r,"ta.browser"),r});
define("ta/util/ScreenSizeRecord",["vanillajs","ta/Core/TA.LocalStorage","ta/Core/TA.Record","ta/Core/TA.Event"],function(e,n,t,i){function o(){var e=document.documentElement,n=document.body,t=window.innerWidth||e.clientWidth||n.clientWidth,i=window.innerHeight||e.clientHeight||n.clientHeight,o=screen.width,r=screen.height;return"s"+o+"x"+r+"b"+t+"x"+i}function r(e){var i=o(),r=n.getSessionKey(d);i!==r&&(n.setSessionKey(d,i),t.trackEventOnPage("screenSizeRecord",e,i))}function c(){function e(){t&&clearTimeout(t),t=setTimeout(function(){r("resize")},250)}if(ta.retrieve("screenSizeRecord")&&n.enabled){r("load");var t;window.addEventListener?window.addEventListener("resize",e,!1):window.attachEvent&&window.attachEvent("onresize",e)}}var d="screenSizeRecord";i.queueForLoad(c,"ScreenSizeRecord.onLoad")});
define("utils/BatchRequest",["ajax-request"],function(e){"use strict";function n(e,n){r[e]=r[e]||[],r[e].push(n),i&&clearTimeout(i),i=setTimeout(t,a)}function t(n){for(var t in r)if(r.hasOwnProperty(t)){for(var a={batched:!0},i=r[t],u=0;u<i.length;u++)for(var o in i[u])i[u].hasOwnProperty(o)&&(a["data["+u+"]["+o+"]"]=i[u][o]);e({method:"POST",url:t,data:a,synchronous:n})}r={}}var a=1500,r={},i=null;return window.addEventListener("onpagehide"in window?"pagehide":"unload",t.bind(null,!0)),{queue:n}});
define("utils/ceUtils",["ta","vanillajs","api-mod","mixins/Events"],function(n,t,e,i){function o(){e.mixin(this,new i("showExplanatoryOverlay","hideExplanatoryOverlay","beginInstall","cancelInstall","test"));var n=this;this.detectExtension=function(n,t,e){var i=new Image;i.src="chrome-extension://"+n,i.onload=function(){t&&t()},i.onerror=function(){e&&e()}},this.isChromeExtensionInstalled=return o.prototype.CHROME_EXT_ID="oiekdmlabennjdpgimlcpmphdjphlcha",o.prototype.CHROME_EXT_TAG=o.prototype.CHROME_EXT_ID+"/images/owl-48.png",new o});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install([],[]);});
define("ta/util/Deferred",["vanillajs","ns-exporter"],function(e,r){"use strict";function t(e){l.prototype[e]=function(r,t){return i(this,e,t?r.bind(t):r)}}for(var n=["success","failure","always","progress"],u={"resolved":["success","always"],"rejected":["failure","always"]},l=function(){},a=0;a<n.length;a++)t(n[a]);l.prototype.then=var o=function(e){var r="pending",t=new l;t.queue=[],t.args=null,t.aplus="boolean"==typeof e&&e,t.status=function(){return r};var n={notify:function(){if(s(r))throw new Error("Promise has already been fulfilled.");var e,n,u,l=Array.prototype.slice.call(arguments);for(n=0,u=t.queue.length;n<u;n++)e=t.queue[n],"progress"===e.hook&&e.callback.apply(null,l);return t},resolve:function(){if(s(r))throw new Error("Promise has already been fulfilled.");return r="resolved",t.args=Array.prototype.slice.call(arguments),f(t)},reject:function(){if(s(r))throw new Error("Promise has already been fulfilled.");return r="rejected",t.args=Array.prototype.slice.call(arguments),f(t)},isFulfilled:function(){return s(r)},promise:function(){return t}};return n},s=i=function(e,r,t){return e.fwd?i(e.fwd,r,t):(e.queue.push({hook:r,callback:t}),f(e))},f=function(e){if(e.fwd)return f(e.fwd);for(var r,t;s(e.status())&&(r=e.queue.shift());)~u[e.status()].indexOf(r.hook)&&(t=r.callback.apply(null,e.args),t instanceof l?(t.queue=t.queue.concat(e.queue.splice(0)),e=e.fwd=t):t&&e.aplus&&(e.args=[t]));return e};return r.createNs(o,"ta.util","Deferred"),o});
!this,function(){ mapThenable(t,e,n,r,o){return t.map(function(t){e.then(function(e){try{o(t,e)}catch(e){dust.log(e,ERROR),t.setError(e)}},function(e){dust.log("Unhandled promise rejection in `"+n.getTemplateName()+"`",INFO),t.renderError(e,n,r).end()})})}ar dust={"version":"2.7.2"},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",EMPTY_FUNC=function(){};dust.config={whitespace:!1,amd:!1,cjs:!1,cache:!0},dust._aliases={"write":"w","end":"e","map":"m","render":"r","reference":"f","section":"s","exists":"x","notexists":"nx","block":"b","partial":"p","helper":"h"},function(){var t,e,n={DEBUG:0,INFO:1,WARN:2,ERROR:3,NONE:4};"undefined"!=typeof console&&console.log?(t=console.log,e="function"==typeof t?function(){t.apply(console,arguments)}::e=EMPTY_FUNC,dust.log=function(t,r){r=r||INFO,n[r]>=n[dust.debugLevel]&&(e("[DUST:"+r+"]",t),r===ERROR&&dust.debugLevel===DEBUG&&t instanceof Error&&t.stack&&e("[DUST:"+r+"]",t.stack))},dust.debugLevel=NONE,"undefined"!=typeof process&&process.env&&/\bdust\b/.test(process.env.DEBUG)&&(dust.debugLevel=DEBUG)}(),dust.helpers={},dust.cache={},dust.register=dust.render=dust.stream=dust.loadSource=function(source){return eval(source)},Array.isArray?dust.isArray=Array.isArray:dust.isArray=dust.nextTick=),dust.isEmpty=dust.isEmptyObject=dust.isTemplateFn=dust.isThenable=function(t){return t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then},dust.isNonThenableFunction=dust.isStreamable=dust.filter=dust.filters={h:function(t){return dust.escapeHtml(t)},j:function(t){return dust.escapeJs(t)},u:encodeURI,uc:encodeURIComponent,js:function(t){return dust.escapeJSON(t)},jp:,dust.makeBase=dust.context=dust.isContext=Context.wrap=function(t,e){return dust.isContext(t)?(t.templateName=e,t):new Context(t,{},{},null,e)},Context.prototype.get=Context.prototype._get=function(t,e){var n,r,o,i,s,u=this.stack||{},a=1;if(r=e[0],o=e.length,t&&0===o)i=u,u=u.head;else{if(t)u&&(u=u.head?u.head[r]:void 0);else{for(;u&&(!u.isObject||(i=u.head,n=u.head[r],void 0===n));)u=u.tail;u=void 0!==n?n:this.global&&this.global[r]}for(;u&&a<o;){if(dust.isThenable(u))return u.then(getWithResolvedData(this,t,e.slice(a)));i=u,u=u[e[a]],a++}}return dust.isNonThenableFunction(u)?(s=s.__dustBody=!!u.__dustBody,s):(void 0===u&&dust.log("Cannot find reference `{"+e.join(".")+"}` in template `"+this.getTemplateName()+"`",INFO),u)},Context.prototype.getPath=Context.prototype.push=Context.prototype.pop=Context.prototype.rebase=Context.prototype.clone=Context.prototype.current=Context.prototype.getBlock=Context.prototype.shiftBlocks=Context.prototype.resolve=Context.prototype.getTemplateName=Stub.prototype.flush=Stream.prototype.flush=Stream.prototype.emit=Stream.prototype.on=Stream.prototype.pipe=Chunk.prototype.write=Chunk.prototype.end=Chunk.prototype.map=Chunk.prototype.tap=Chunk.prototype.untap=Chunk.prototype.render=Chunk.prototype.reference=function(t,e,n,r){return dust.isNonThenableFunction(t)?(t=t.apply(e.current(),[this,e,null,{auto:n,filters:r}]),t instanceof Chunk?t:this.reference(t,e,n,r)):dust.isThenable(t)?this.await(t,e,null,n,r):dust.isStreamable(t)?this.stream(t,e,null,n,r):dust.isEmpty(t)?this:this.write(dust.filter(t,n,r,e))},Chunk.prototype.section=function(t,e,n,r){var o,i,s,u=n.block,a=n["else"],c=this;if(dust.isNonThenableFunction(t)&&!dust.isTemplateFn(t)){try{t=t.apply(e.current(),[this,e,n,r])}catch(t){return dust.log(t,ERROR),this.setError(t)}if(t instanceof Chunk)return t}if(dust.isEmptyObject(n))return c;if(dust.isEmptyObject(r)||(e=e.push(r)),dust.isArray(t)){if(u){if(i=t.length,i>0){for(s=e.stack&&e.stack.head||{},s.$len=i,o=0;o<i;o++)s.$idx=o,c=u(c,e.push(t[o],o,i));return s.$idx=void 0,s.$len=void 0,c}if(a)return a(this,e)}}else{if(dust.isThenable(t))return this.await(t,e,n);if(dust.isStreamable(t))return this.stream(t,e,n);if(t===!0){if(u)return u(this,e)}else if(t||0===t){if(u)return u(this,e.push(t))}else if(a)return a(this,e)}return dust.log("Section without corresponding key in template `"+e.getTemplateName()+"`",DEBUG),this},Chunk.prototype.exists=function(t,e,n){var r=n.block,o=n["else"];if(dust.isThenable(t))return mapThenable(this,t,e,n,function(t,r){t.exists(r,e,n).end()});if(dust.isEmpty(t)){if(o)return o(this,e)}else{if(r)return r(this,e);dust.log("No block for exists check in template `"+e.getTemplateName()+"`",DEBUG)}return this},Chunk.prototype.notexists=function(t,e,n){var r=n.block,o=n["else"];if(dust.isThenable(t))return mapThenable(this,t,e,n,function(t,r){t.notexists(r,e,n).end()});if(dust.isEmpty(t)){if(r)return r(this,e);dust.log("No block for not-exists check in template `"+e.getTemplateName()+"`",DEBUG)}else if(o)return o(this,e);return this},Chunk.prototype.block=Chunk.prototype.partial=function(t,e,n,r){var o;return void 0===r&&(r=n,n=e),dust.isEmptyObject(r)||(n=n.clone(),o=n.pop(),n=n.push(r).push(o)),dust.isTemplateFn(t)?this.capture(t,e,function(t,e){load(t,e,n).end()}):load(t,this,n)},Chunk.prototype.helper=Chunk.prototype.await=function(t,e,n,r,o){return mapThenable(this,t,e,n,function(t,i){n?t.section(i,e,n).end():t.reference(i,e,r,o).end()})},Chunk.prototype.renderError=function(t,e,n){var r=n&&n.error;return r?this.render(r,e.push(t)):this},Chunk.prototype.stream=function(t,e,n,r,o){var i=n&&n.block;return this.map(function(s){var u=!1;t.on("data",.on("error",function(t){u||(s.renderError(t,e,n),dust.log("Unhandled stream error in `"+e.getTemplateName()+"`",INFO),u||(u=!0,s.end()))}).on("end",})},Chunk.prototype.capture=Chunk.prototype.setError=for(var f in Chunk.prototype)dust._aliases[f]&&(Chunk.prototype[dust._aliases[f]]=Chunk.prototype[f]);Tap.prototype.push=Tap.prototype.go=var HCHARS=/[&<>"']/,AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;return dust.escapeJs=dust.escapeJSON="undefined"!=typeof window&&window.define&&define("dust",[],function(){return dust}),dust});
!function(e,t){"undefined"!=typeof window&&window.define?define("dust-helpers",["dust"],t):"object"==typeof exports?(module.exports=t(require("dustjs-linkedin")),module.exports.registerWith=t):t(e.dust)}(this,function(e){tion i(e,t){var n,r=e.stack.head,s=e.rebase();e.stack&&e.stack.tail&&(s.stack=e.stack.tail);var i={isPending:!1,isResolved:!1,isDeferredComplete:!1,deferreds:[]};for(n in t)i[n]=t[n];return s.push({"__select__":i}).push(r,e.stack.index,e.stack.of)}={},f={"tap":"sep":"first":"last":"contextDump":"math":"select":"eq":c("eq",,"ne":c("ne",,"lt":c("lt",,"lte":c("lte",,"gt":c("gt",,"gte":c("gte",,"any":"none":"size":;for(var p in f)e.helpers[p]=f[p];return e});
!function(e){"undefined"!=typeof window&&window.define?define("dust-ta-helper",["dust","dust-helpers"],e):e(dust)}(function(e,r){"use strict";function t(e){return e===~~e}function n(e){if("function"!=typeof e)return e;e=e.toString();for(var r,t,n="",a=/(?:reference\((.*?)\)|write\("(.*?)"\))[.;]/g;r=a.exec(e);)r[1]?(t=r[1].match(u),t&&(t[1]?n+=" {"+t[1]:t[2]&&(n+=" {"+t[2].replace(f,".")),t[3]&&(n+="|"+t[3].replace(f,"|")),n+="} ")):r[2]&&(n+=r[2]);return n.replace(g,"")}function a(e,r){for(var t=r.split(".");e&&t.length>0;)e=e[t.shift()];return e}function i(e,r){return e&&(s.test(e)||(e="/"+e),e.match(c)||(e=r.global.CDN_HOST+e)),e}function l(e){var r=ta.retrieve&&ta.retrieve("BOOKING_FEATURES"),t=r&&r.indexOf(e.trim().toUpperCase())>=0;return t||(t=!(!ta.has||!ta.has("feature."+e))||!(!ta.retrieve||!ta.retrieve(e+".feature"))||!!(ta.m&&ta.m.feature&&ta.m.feature.enabled(e))),t}var o=/^ *(\w+) +in +([$_a-zA-Z][.$_\w]*)/,s=/^\//,c=/^[a-zA-Z:]*\/\//,u=/ctx\.(?:get\("(.*?)"\)|getPath\(false,\["(.*?)"\]\)),ctx,"h"(?:,\["(.*?)"\])?/,f=/","/g,g=/^\s|\s(?=\s|$)/g,h=e.helpers.eq.bind(e.helpers),d=e.helpers.select.bind(e.helpers),p=e.helpers.math.bind(e.helpers),b=function(r,t,n){return n.resolve?n.resolve(r):e.helpers.tap(r,t,n)},v={"pagination":["url"]};if("undefined"==typeof console&&(console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}}),e.helpers["if"]){var L=e.helpers["if"].bind(e.helpers);e.helpers["if"]=function(e,r,t,a){try{return L(e,r,t,a)}catch(t){return console.error("Error in @if statement: "+t.name+": "+t.message+".",'Condition "'+n(a.cond)+'"','evaluated to "'+b(a.cond,e,r)+'".'),e}}}e.helpers.select=function(e,r,t,n){var a=b(n.key,e,r);return 0==a?"0"===a&&(n.key=0):a==+a&&(n.key=+a),d(e,r,t,n)},e.helpers.math=function(e,r,t,n){var a=r.current();return n.inherit&&(n[n.inherit]="undefined"!=typeof a.selectKey?a.selectKey:a._dustFilterOptions.selectKey),p(e,r,t,n)},e.helpers.eq=function(e,r,t,n){var a=b(n.key,e,r),i=b(n.value,e,r);return a==+a&&(n.key=+a),i==+i&&(n.value=+i),h(e,r,t,n)},e.helpers.contains=function(e,r,t,n){if(!n.collection||!n.collection.indexOf)return console.error("@contains helper requires a valid 'collection' parameter"),e;var a=b(n.value,e,r);return"undefined"==typeof a?(console.error("@contains requires a 'value' parameter"),e):~n.collection.indexOf(a)?t.block(e,r):t["else"]?t["else"](e,r):e},e.helpers.range=function(e,r,n,a){var i=+b(a.begin,e,r);t(i)||(i=0);var l=+b(a.end,e,r);t(l)||console.error("@range requires an integral 'end' parameter");var o=+b(a.step,e,r);t(o)||(o=(l-i)/Math.abs(l-i));var s=o>0;try{for(var c=i;s?c<l:c>l;c+=o)r.stack.head.$val=c,e=n.block(e,r)}catch(e){console.error("Error in @range block",e.message)}return delete r.stack.head.$val,e},e.helpers.truncate=function(r,t,n,a){var i=e.escapeHtml(b(a.value,r,t))||"",l=b(a.length,r,t)||100,o=i.length<=l?i:i.slice(0,l-3).replace(/(?:\s*\&\S*|\s+)$/,"")+"...";return r.write(o)},e.helpers.localizeInt=function(e,r,t,n){var a=b(n.val,e,r)||0,i=a.toString().split("");if(i.length>3)if(i.reverse(),"en_IN"==r.global.LOCALE){a="";for(var l=",",o=0;o<i.length;o++)a=i[o]+a,o<i.length-1&&(o>=3&&(o-3)%2==1?a=l+a:o<3&&o%3==2&&(a=l+a))}else{a="";var l=",";"de"==r.global.LOCALE||"it"==r.global.LOCALE||"nl"==r.global.LOCALE||"br"==r.global.LOCALE||"es"==r.global.LOCALE||"es_AR"==r.global.LOCALE||"es_CL"==r.global.LOCALE||"es_CO"==r.global.LOCALE||"es_VE"==r.global.LOCALE||"fr_BE"==r.global.LOCALE||"pt"==r.global.LOCALE||"pt_BR"==r.global.LOCALE||"nl_BE"==r.global.LOCALE||"tr"==r.global.LOCALE||"da"==r.global.LOCALE||"el"==r.global.LOCALE||"id"==r.global.LOCALE||"vi"==r.global.LOCALE||"sr"==r.global.LOCALE?l=".":"fr"==r.global.LOCALE||"pl"==r.global.LOCALE||"en_ZA"==r.global.LOCALE||"de_AT"==r.global.LOCALE||"fr_CA"==r.global.LOCALE||"fr_CH"==r.global.LOCALE||"pt_PT"==r.global.LOCALE||"no"==r.global.LOCALE||"nb"==r.global.LOCALE||"ru"==r.global.LOCALE||"hu"==r.global.LOCALE||"sk"==r.global.LOCALE||"uk"==r.global.LOCALE||"cs"==r.global.LOCALE||"fi"==r.global.LOCALE||"in"==r.global.LOCALE?l=" ":"it_CH"!=r.global.LOCALE&&"de_CH"!=r.global.LOCALE||(l="'");for(var o=0;o<i.length;o++)a=i[o]+a,o%3==2&&o<i.length-1&&(a=l+a)}return e.write(a)},e.helpers.quotes=function(e,r,t,n){n=n||{};var a=b(n.italics,e,r)||"",i=r.global.IS_RTL?"&#x201d;":"&#x201c;",l=r.global.IS_RTL?"&#x201c;":"&#x201d;";return"true"==a&&(i="<i>"+i+"</i>",l="<i>"+l+"</i>"),e.write(i),e=t.block(e,r),e.write(l)},e.helpers.fbPic=function(e,r,t,n){var a=b(n.id,e,r),i=b(n.size,e,r);return e.write("<img "),a&&(e.write('src="//graph.facebook.com/'+a+"/picture?type=square"),i&&e.write("&width="+i+"&height="+i),e.write('" ')),e=t.block(e,r),e.write("/>")},e.helpers.img=function(e,r,t,n){var a=i(b(n.src,e,r),r);return e.write("<img "),a&&e.write('src="'+a+'" '),t.block&&(e=t.block(e,r)),e.write("/>")},e.helpers.maybeLazyImg=e.helpers.img,e.helpers.imgUrl=function(e,r,t,n){var a=i(b(n.src,e,r),r);return a&&e.write(a),t.block&&(e=t.block(e,r)),e},e.helpers.fittedImg=function(e,r,t,n){var a,i=b(n.src,e,r),l=b(n.height,e,r),o=b(n.width,e,r),s=i.url,c=i.height,u=i.width,f="",g="";return 0==u||0==c?f='style= "width:'+o+"px; height: "+l+'px;" ':l/c<o/u?(a=o/u,c=Math.floor(c*a),u=o,g=Math.floor((c-l)/2)*-1,f='style= "width:'+u+"px; height: "+c+"px; margin-top: "+g+'px;" '):(a=l/c,u=Math.floor(u*a),c=l,g=Math.floor((u-o)/2)*-1,f='style= "width: '+u+"px; height: "+c+"px; margin-left: "+g+'px; "'),e.write('<div style="height:'+l+"px; width:"+o+'px; overflow: hidden;" >'),s&&e.write('<img src="'+s+'" '+f+"/>"),e=t.block(e,r),e.write("</div>")},e.helpers.lazyimg=function(e,r,t,n){var a=b(n["class"],e,r),i=b(n.src,e,r);return e.write('<img class="lazy '+(a?a:"")+'" '),i&&("undefined"==typeof window?e.write('data-src="'+i+'" '):e.write('src="'+i+'" ')),e=t.block(e,r),e.write("/>")},e.helpers.avatar=function(e,r,t,n){var a=b(n.avatar,e,r),i=b(n.id,e,r),l=b(n["class"],e,r);return e.write('<div class="avatar '+l+'" '),a?e.write('style="background-image: url('+a+')">'):e.write('style="background-image: url(//graph.facebook.com/'+i+'/picture?type=square)">'),e.write("</div>")},e.helpers.pos=function(e,r,t,n){var a=n&&null!=n.start?n.start:1;return r.stack&&(r.stack.head.$pos=r.stack.index+a),t&&t.block&&(e=t.block(e,r)),e},e.helpers.bubbleRating=function(e,r,t,n){var a=b(n.value,e,r),i=b(n.ratingType,e,r)||"ss",l=a?1==a.toString().length?a.toString()+"0":10*a:null,o=b(n["class"],e,r);return a=+a,e.write('<div class="rate rate_'+i+" "+i+l+" "+(o?o:"")+'">'),e.write("<img "),e.write('src="'+r.global.CDN_HOST+'/img2/sprites/ratings-v6.png" '),e.write('class="sprite-ratings" alt="'),e.write(a+' of 5 stars" content="'+a+'" />'),e.write("</div>")},e.helpers.bubbleRatingSvg=function(e,r,t,n){var a=b(n.value,e,r),i=+b(n.multiplier,e,r)||20,l=a*i;return l=l<0?0:l>100?100:l,e.write('<div class="svgico bubblesempty">'),e.write('<div class="bubbles" style="width:'+l+'%;"><div class="svgico bubblesfull"></div></div>'),e.write("</div>")},e.helpers.bubbleNum=function(e,r,t,n){var a=b(n.value,e,r);return a=5*Math.round(2*Number(a)),a=Math.min(a,50),a=Math.max(a,0),a=String(100+a).substr(1),e.write(a)},e.helpers.removeNonDigits=function(e,r,t,n){var a=b(n.value,e,r);return e.write(a.replace(/[^0-9]/g,""))},e.helpers.digitize=function(r,n,a,i){var l=+b(i.value,r,n),o=+b(i.padding,r,n),s=t(l)?l.toString().split(""):[];t(o)||(o=0);var c=o-s.length;if(c>0)for(;c--;)s.unshift("0");for(var u=0;u<s.length;u++)r=a.block(r,e.makeBase({digit:s[u]}));return r},e.helpers.oxEach=function(e,r,n,a){if(r.stack.tail&&(!r.stack.head||!r.stack.head.__ox__))return console.error("Cannot call @oxEach within a section block"),e;var i,l=b(a.context,e,r),s=l.match(o),c=s[1],u=s[2].split("."),f=r.get(u[0]);for(i=1;f&&i<u.length;i++)f=f[u[i]];if(!f)return e;var g=b(a.name,e,r)||"each"+c.charAt(0).toUpperCase()+c.slice(1),h="begin"in a||"end"in a,d=+b(a.begin,e,r);(!t(d)||d<0)&&(d=0);var p=+b(a.end,e,r);p=isNaN(p)?null:p,null!=p&&(!t(p)||p<d)&&(console.error("Invalid @oxEach end index in collection"+u),p=null);var v=f.__offset__||0;for(e.write('<!-- @oxEach name="'+g+'" context="'+l+'"'),h&&(e.write(' begin="'+d+'"'),null!=p&&e.write(' end="'+p+'"')),e.write(" -->\n"),d-=v,p=null!=p?Math.min(p-v,f.length):f.length,i=d;i<p;i++){var L=f[i];if(!L){console.error("@oxEach requires non-null items in collection "+u);break}var w={};for(var m in r.stack.head)w[m]=r.stack.head[m];w[c]=L,w.$idx=i+v,w.$idx1=w.$idx+1,w.__ox__=!0,w=r.rebase(w),e=n.block(e,w)}return e.write("<!-- /oxEach -->\n"),e},e.helpers.oxContains=function(e,r,t,n){if(!n.collection||!n.collection.indexOf)return console.error("@oxContains helper requires a valid 'collection' parameter"),e;var i=b(n.key,e,r);if("undefined"==typeof i)return console.error("@oxContains requires a 'key' parameter"),e;var l=b(n.value,e,r);if("undefined"==typeof l)return console.error("@oxContains requires a 'value' parameter"),e;var o=function(e){return null!=e&&a(e,i)==l};return n.collection.filter(o).length>0?t.block(e,r):t["else"]?t["else"](e,r):e},e.helpers.oxSection=function(e,r,t,n){var a=b(n.namespace,e,r),i=b(n.nsid,e,r),l=b(n.tag,e,r)||"div";if("undefined"==typeof a)return console.error("@oxSection requires a valid 'namespace' parameter"),e;e.write("<"+l+' data-ox-section-name="'+a+'"'),"undefined"!=typeof i&&e.write(' data-ox-section-id="'+i+'"');for(var o in n)if("namespace"!==o&&"nsid"!==o&&"tag"!==o){var s=b(n[o],e,r);"undefined"!=typeof o&&"undefined"!=typeof s?e.write(" "+o+'="'+s+'"'):console.error("@oxSection key or value is undefined: "+o)}return e.write(" />\n"),e=t.block(e,r),e.write("</"+l+">\n"),e},e.helpers.substr=function(r,t,n,a){var i=e.escapeHtml(b(a.str,r,t))||"",l=b(a.begin,r,t)||0,o=b(a.end,r,t)||i.length,s=b(a.len,r,t)||i.length,c=b(a.underflow,r,t)||"",u=b(a.overflow,r,t)||"",f=(0==l?"":c)+(s<o-l?i.substr(l,s)+u:i.slice(l,o));return r.write(f)},e.helpers.increment=function(e,r,n,a){var i=+b(a.base,e,r),l=+b(a.addon,e,r);return t(i)||(i=0),t(l)||(l=0),r.stack.head.$increment_val=i+l,e=n.block(e,r),delete r.stack.head.$increment_val,e},e.helpers.pagination=function(e,r,n,a){var i,l=+b(a.offset,e,r),o=+b(a.limit,e,r),s=+b(a.total,e,r),c=+b(a.pageNumbers,e,r)||2,u=1+(s<=0?0:Math.floor(l/o)),f=n.url||a.url,g=Math.ceil(s/o);if(!t(l)||!t(o)||!t(s))return e;var h=[],d=[],p=function(t){var n="";if(f){var a=r.rebase({"pageNumber":t,"offset":(t-1)*o});n=b(f,e,a)}return{"pageNumber":t,"offset":(t-1)*o,"url":n}},v=if(g<=2*c+3)for(i=1;i*o<s+o;i+=1)v(i);else if(u<=Math.max(2*c,3))for(i=1;i<2*c+3;i++)v(i);else if(g-u<=2*c-1)for(i=g-2*c+1;i<=g;i++)v(i);else for(i=u-c;i<=u+c;i++)v(i);var L={previousPage:u>1?p(u-1):null,nextPage:u<g?p(u+1):null,firstPage:l<=0?null:p(1),lastPage:l+o>=s?null:p(Math.ceil(s/o)),containsFirstPage:d.indexOf(1)>=0,containsLastPage:d.indexOf(Math.ceil(s/o))>=0,currentPageNumber:u,pages:h};return L=r.rebase(L),e=n.block(e,L)},e.helpers.feature=function(e,r,t,n){var a=b(n.name,e,r),i=!n.hasOwnProperty("enabled")||b(n.enabled,e,r);if("undefined"==typeof a||!a||!a.trim())return console.error("@feature requires a 'name' parameter"),e;a=a.trim(),i&&(i="false"!==i.toString().trim());var o=l(a);return o===i?t.block(e,r):t["else"]?t["else"](e,r):e},e.helpers.dchoice=function(e,r,t,n){var a,i,l,o,s=r.global.LOCALE;return n=n||{},isNaN(parseInt(n.key),10)?e.write(""):(a=Math.abs(n.key),l=a%10,o=a%100,i="ru"===s?11!==o&&1===l?n.arg0:l>=2&&l<=4&&(o<=10||o>=20)?n.arg1:n.arg2:"cs"===s||"sk"===s?1===a?n.arg0:a>=2&&a<=4?n.arg1:n.arg2:"sr"===s||"uk"===s?a>=11&&a<=14?n.arg2:1===l?n.arg0:l>=2&&l<=4?n.arg1:n.arg2:"",e.write(i))},e.helpers.dchoice2=function(e,r,t,n){var a,i;return n=n||{},isNaN(parseInt(n.key),10)?e.write(""):(a=Math.abs(n.key),i=a%100!==11&&a%100%10===1?n.arg0:n.arg1,e.write(i))},e.helpers.localizeShowKeyOnHover=function(e,r,t,n){var a=l("DUST_LOCALIZE_SHOW_KEY_ON_HOVER");if(a){var i=b(n.key,e,r);e.write('<span class="ta-localized" title="'),i&&e.write(i),e.write('">')}return t.block&&(e=t.block(e,r)),a&&e.write("</span>"),e},e.helpers.localizeWithCopyTests=function(e,r,t,n){var a=ta&&ta.retrieve&&ta.retrieve(n.key);return a?e.write(a):(console.error("No translation found for "+n.key+" - it should be added to booking_js_strings.vm"),e.write(n.key)),e};var w=e.helpers.styleguide=function(e,r,t,n){var a={},i=b(n.component||t.component,e,r),l=v[i]||[],o={};for(var s in n)a[s]=l.indexOf(s)>=0?n[s]:b(n[s],e,r),o[s]=w(a[s]);for(var c in t)a[c]=l.indexOf(c)>=0?t[c]:b(t[c],e,r),o[c]=w(a[c]);return r=r.shiftBlocks(o).push(a),e.partial(r.global.LOCALE+"styleguide_"+i,r,a)}});
!function(e){"undefined"!=typeof exports?e(module.exports=require("dustjs-linkedin")):"undefined"!=typeof window&&window.define?define("dust-iterate-helper",["dust"],e):e(dust)}(function(e){e.helpers.iterate=function(r,n,t,o){unction s(e,t){return a(r,n.push({$key:e,$value:t,$type:typeof t}))}var l,u,f,p,d,h,a=t.block;o=o||{};var c=function(r,n,t){return t.resolve?t.resolve(r):e.helpers.tap(r,n,t)};if(o.key)if(d=c(o.key,r,n),a)if(o.sort){l=c(o.sort,r,n),u=[];for(p in d)d.hasOwnProperty(p)&&u.push(p);for(h=n.global[l],h||"desc"!==l||(h=i),h?u.sort(h):u.sort(),f=0;f<u.length;f++)r=s(u[f],d[u[f]])}else for(p in d)d.hasOwnProperty(p)&&(r=s(p,d[p]));else _console.log("Missing body block in the iter helper.");else _console.log("Missing parameter 'key' in the iter helper.");return r}});
!function(n){"undefined"!=typeof window&&window.define?define("dust-tracking-helper",["dust","dust-helpers"],n):n(dust)}(function(n,e){"use strict";e=e||n.helpers;var t=function(e,t,r){return r.resolve?r.resolve(e):n.helpers.tap(e,t,r)},r="__ttParentContext",o="dustTree",i="\\",u="/",a=/^([A-Z]{1,2}:)?[\\$-.\a-zA-Z_0-9|]+$/,l=/\\+$/,c=function(n){return n.global.__treeString},s=g=f=function(n){var e=n.global.__treeString;return n.global.__treeString=null,n.global.__incrementingCounters={},e},_=function(n){var e=c(n),t=n.global[r];null==e&&(e=n.global.__treeString=[],n.global.__incrementingCounters={},("string"==typeof t||t instanceof String)&&t.length>0&&(t[t.length-1]===i?(e.push(t.substring(0,t.length-1)),e.push(i)):e.push(t)))},h=function(n,e,t){return t&&t.block&&(n=t.block(n,e)),n},b=function(n,e,t){e&&e.block&&n&&n.write(t)},p=function(n,e,t,r){var o=c(t),a=o.length;0===a||o[a-1]===i?o.push(n):(o.push(u),o.push(n)),b(e,r,"<!--trk"+n+"-->")},d=function(n,e,t){c(e).push(i),b(n,t,"<!--etk-->")},v=function(n,e,t,r){var o=m(n);return _(t),o&&p(n,e,t,r),e=h(e,t,r),o&&d(e,t,r),e},k=m=n.helpers.track=function(n,e,r,o){try{var i=t(o&&o.noTrack,n,e);if(i)return n=h(n,e,r);var u=t(o&&o.name,n,e);return v(u,n,e,r)}catch(n){console.error(n)}},n.helpers.trackTree=function(n,e,r,i){var u,a=t(i&&i.name,n,e),l=f(e),c=o;return _(e),n=h(n,e,r),u=k(e),n&&n.write&&(a&&(c=c+" "+a),n.write("<div class='"+c+"' data-tree='"+u+"'></div>")),e.global.__treeString=l,n},n.helpers.trackWithIncrementingValue=function(n,e,r,o){var i,u,a=t(o&&o.name,n,e),l=o.hasOwnProperty("offset")&&o.offset?t(o.offset,n,e):1,c=window.ta&&ta.retrieve&&ta.store?ta.retrieve("dust.continue_inc_track"):null;return a&&a.indexOf(":")<0&&(i=s(e),i||e&&e.global&&e.global.DEBUG&&console.warn("trackWithIncrementingValue outside of a @trackTree context."),u=i&&i[a]?i[a]+1:c&&c[a]?c[a]+1:l,g(e,a,u),a=a+":"+u,c&&ta.store("dust.continue_inc_track",i)),v(a,n,e,r)},n.tracking={TREE_CLASS:o,setParentTree:cleanTree:});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/Core/TA.Dust"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-dust","files":{"js3":{"src":{"ta":{"Core":{"TA.Dust":1}}}}},"_":{"baseUrl":"/"}});
define("ta/Core/TA.Dust",["vanillajs","ns-exporter","ta/util/Error","ta/util/Deferred","ta/Core/TA.Store"],function(e,r,t,n,u){"use strict";var d={},i=null,o=function(){if(null!=i)return i;try{return i=JSON.parse(u.retrieve("DUST_GLOBAL"))}catch(e){}return i=u.retrieve("DUST_GLOBAL_CONTEXT"),i?i:"undefined"!=typeof window&&window.DUST_GLOBAL?window.DUST_GLOBAL:require.defined("page-model")?require("page-model").DUST_GLOBAL:{}};d.render=function(e,r,n,u){var d=o(),i="string"==typeof n?document.querySelector(n):n,a=dust.makeBase(d).rebase(r);return!!(i&&e&&d.LOCALE&&dust)&&(dust.render(s(e),a,function(n,d){d?i.innerHTML=d:n&&t.record(n,"Error rendering dust template "+e),u&&u(r)}),!0)},d.renderToString=function(e,r){var u=o(),d=dust.makeBase(u).rebase(r),i=n(!0);return e&&u.LOCALE&&dust?(dust.render(s(e),d,function(r,n){n?i.resolve(n):r&&(t.record(r,"Error rendering dust template "+e),i.reject(r))}),i.promise()):(i.reject("Missing dependencies"),i.promise())};var s=function(e){var r=e.replace(/\//g,"_").replace(".dust",""),t=o().LOCALE;return t+r};return r.exportTo(d,"ta.dust"),d});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/util/Cookie","ta/util/ASDF","ta/util/Doer","ta/util/Pending","ta/util/Load","ta/util/Date","ta/util/Currency","ta/util/Toggle","ta/util/URL","ta/util/I18N","ta/util/Element","ta/util/Link","ta/util/ajaxFormPopup","ta/util/LocalStorage","ta/util/SessionStorage","ta/util/Deferred","ta/util/Decoder","ta/util/Replace","ta/util/ajax","ta/util/cdn","ta/common/Search","ta/common/Flyout","ta/servlet/Reviews","ta/servlet/Popup","utils/cookieutils","utils/ceUtils","ta/util/ActionRecord","ta/util/Partials","ta/support/Facebook","lib/LazyLoad","mobile/lite/image-loader","lib/TypeAhead","ta/backbone/ModuleLoader","tamgfooter/tamgFooter","ta/maps/opener"],["ta","ta","page-model","ta","ta","ta","ta","ta","ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-core-lite","files":{"js3_secure":{"ssl":{"ta":{"util":{"LocalStorage":1,"Deferred":1}}}},"js-amd":{"src":{"utils":{"ceUtils":1,"cookieutils":1},"mobile":{"lite":{"image-loader":1}}}},"js3":{"lib":{"LazyLoad":1,"TypeAhead":1},"src":{"tamgfooter":{"tamgFooter":1},"ta":{"common":{"Flyout":1,"Search":1},"maps":{"opener":1},"util":{"Cookie":1,"Replace":1,"Load":1,"Partials":1,"ActionRecord":1,"Element":1,"ASDF":1,"ajaxFormPopup":1,"Decoder":1,"cdn":1,"ajax":1,"Date":1,"URL":1,"Currency":1,"Toggle":1,"Doer":1,"SessionStorage":1,"Link":1,"Pending":1,"I18N":1},"servlet":{"Reviews":1,"Popup":1},"backbone":{"ModuleLoader":1},"support":{"Facebook":1}}}}},"_":{"baseUrl":"/"}});
define("ta/servlet/Popup",["ns-exporter","lib/jquery-amd","ta/Browser","ta/util/Error","ta/Core/TA.Record","ta/Core/TA.Store","ta/util/Cookie","api-mod"],function(o,t,n,r,a,i,c,s){function p(e){e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}var l=0,d={open:function(e,o,t,a,i,c,s,p){try{t=isNaN(parseInt(t))?600:parseInt(t),a=isNaN(parseInt(a))?400:parseInt(a),i=isNaN(parseInt(i))?0:parseInt(i),c=isNaN(parseInt(c))?0:parseInt(c),e.indexOf("p=HotelsCom")>-1&&(t=Math.max(t,960),a=Math.max(a,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,600)),n.isChrome()&&(s=!0);var d=1;s&&(d=0);var h=1;if(n.isIE9orHigher())var h=0;var u=!1;if(o&&"string"==typeof o&&(u=o),!u){var m=l++;u="TripPop"+m}var f="";p?f="toolbar=1,resizable=1,location=1,status=1":(h=0,f="toolbar=0,resizable=1,location=0,status=0"),f+=",menubar="+h,f+=",scrollbars="+d,f+=",width="+t,f+=",height="+a,f+=",screenX="+i+",left="+i,f+=",screenY="+c+",top="+c;var w=window.open(e,u,f);if(null!=w){try{w.focus(),w.opener=self}catch(e){}return w}}catch(e){r.record(e,"Popup.open",null,{name:o,width:t,height:a,x:i,y:c,noScroll:s,allOptions:p})}},openExternalWithDefaultOptions:function(e){try{var o=475,t=390,a=210,i=5;screen.width>=1024&&screen.height>=768?(o=900,t=768,a=240):screen.width>1024?(o=800,t=600,a=240):screen.width>800&&(o=620,t=500,a=240),e.indexOf("p=HotelsCom")>-1&&(o=Math.max(o,960),t=Math.max(t,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,600));var c=!1;n.isChrome()&&(c=!0);var s=1;c&&(s=0);var p=1;if(n.isIE9orHigher())var p=0;var d=l++,h="TripPop"+d,u="toolbar=1,resizable=1,location=1,status=1";u+=",menubar="+p,u+=",scrollbars="+s,u+=",width="+o,u+=",height="+t,u+=",screenX="+a+",left="+a,u+=",screenY="+i+",top="+i;var m=window.open(e,h,u);if(null!=m){try{m.focus(),m.opener=self}catch(e){}return m}}catch(e){r.record(e,"Popup.open - openExternalWithDefaultOptions",null,{name:name,width:o,height:t,x:a,y:i,noScroll:c})}},openSizedPopup:function(e,o,t){p(e);var n=600,r=400;(sz=o.className.match(/sz(\d+)x(\d+)/))&&(n=sz[1],r=sz[2]),d.open(o.href,"photoTPW",n,r,!1,!1,"undefined"==typeof t||t,!0)},checkrates:function(e,o){p(e),o=t(o).closest("a")[0],d.open(o.href,"cr",245,610,5,5),a.trackEventOnPage("map_pin_overlay","check_rates_click")},sponsorCheckRates:function(e,o){p(e),o=t(o).closest("span")[0];var n=o.className.match(/id_(\d+)/)[1],r="/HotelDateSearch?d="+n+"&fromPop=false&sponsid="+i.retrieve("sponsor.id")+"&area=QC_Button_Map&from=HACSearchButton&returnTo=__2F__GMapsLocationController&sponsdet=mapsHacBottom";d.open(r,"cr",245,610,5,5)},termsPopup:function(e,o){return popup.apply(o,[e,"terms",300,300,30,25]),!1},openInParent:function(e,o,n){var r=!1;if(window.top&&window.top.opener?r=window.top:window.opener&&(r=window),!r)return!0;var a="";"FORM"===o.nodeName?a=o.action+"?"+s.toFormQueryString(o):(o=t(o).closest("a")[0],o&&(a=o.href)),""!==a&&(p(e),r.opener.location=a,"undefined"!=typeof n&&n?window.blur():r.close())},openInParentOrSelf:function(e,o){var n=!1;window.top&&window.top.opener?n=window.top:window.opener&&(n=window);var r="";"FORM"===o.nodeName?r=o.action+"?"+s.toFormQueryString(o):(o=t(o).closest("a")[0],o&&(r=o.href)),""!==r&&(p(e),n&&"undefined"!=typeof n.opener&&n.opener&&"undefined"!=typeof n.opener.closed&&!n.opener.closed?(n.opener.location=r,n.close()):window.location=r)},photoGallery:function(o,n){if(n=t(n).closest("a")[0],!n)return r.record(e,"photoGallery - get anchor elmt"),!1;var a="",i="1";n.className&&(a=n.className.match(/u_([^ ]*)/)[1],i=n.className.match(/#([0-9]+)/)[1]);try{if("undefined"==typeof cookieDomain){for(var s,p=window.location.hostname.split("."),l=0;p[l]&&"tripadvisor"!=p[l];)l++;s=p.slice(l).join("."),s&&(cookieDomain="."+s)}c.write("PhotoPop",i,null,null,cookieDomain)}catch(e){r.record(e,"photoGallery - cookie set")}try{var h="";a&&(h=d.open(a,"media",780,800));try{h&&h.showImage&&h.showImage(i)}catch(e){}}catch(e){r.record(e,"photoGallery - pop window")}return!1},openAIMLink:function(e,o){p(e);var n,r=t(o).closest("span.fkASDF,div.fkASDF,a")[0];if(r){n="A"===r.nodeName?r.href:o.className.match(/u_([^ ]*)/)[1];var a="navarea";ta.meta&&ta.meta.link&&ta.meta.link.getPhotoNavArea&&(a=ta.meta.link.getPhotoNavArea(o)),n=n.replace("%7Cnavarea%7C",a);var c=o.className.match(/win(.+)/);c=c&&c.length>1?c[1]:null,i.store("commerce.AIMWindow",d.open(n,c,980,800,240,5,!1,!0))}},openProviderWindow:function(e,o){p(e),d.open(o.href,"photoTPW",1260,922,!1,!1,!0,!0)}};return o.exportTo(d,"ta.servlet.Popup"),d});
define("ta/util/ASDF",["vanillajs","utils/asdf-encoder","ta/util/Cookie","ns-exporter","ta/servlet/Popup"],function(o,t,e,n,a){var s={asdf:function(o,n){n&&e.setPIDCookie(n),window.location=t.asdf(o)},asdfPopup:function(o,n,s,i,f){n&&e.setPIDCookie(n),a.open(t.asdf(o),s,i,f)},asdfPopupTerms:function(o){a.open(t.asdf(o),"terms",300,300,30,25)},asdfDcd:function(o){return t.asdf(o)}};return n.exportTo(s,"ta.util.ASDF"),s});
define("ta/util/Doer",["vanillajs"],function(e){var t={doit:function(e,t){var n="/"+e,r=0;for(var a in t)n+=0===r?"?":"&",n+=a+"="+t[a],r++;return n},aimdoit:function(e,t,n,r){var a=ta.util.Doer.doit(e,t);ta.stopEvent(n);var i=475,o=390,l=210,u=5;r?(i=980,o=800,l=240):screen.width>=1024&&screen.height>=768&&t&&(t.area.indexOf("Text")!=-1||t.area.indexOf("Thumbnail")!=-1)?(i=900,o=768,l=240):screen.width>1024?(i=800,o=600,l=240):screen.width>800&&(i=620,o=500,l=240),ta.store("commerce.AIMWindow",ta.servlet.Popup.open(a,null,i,o,l,u,!1,!0))},tadoless:function(e,t,n,r,a){var i="/"+e;for(var o in t)i+="-"+o+t[o];for(var l=n.length,u=0;u<l;u++)i+="-"+n[u];return a||(i+=".html"),r.length>0&&(i+=r),i}};return t});
define("ta/util/Pending",["vanillajs","ns-exporter","ta/Core/TA.Store","ta/Core/TA.Load"],function(vanilla,nsExporter,taStore,taLoad){var exports={},_callbacks={};return exports.waitForMore=function(t,e,n,o,r){taStore.has("pending."+t)&&exports.cancel(t),taStore.store("pending."+t,{timer:e.delay(n,r,o),"fn":e,t:"m",n:n})},exports.waitForFn=function(id,fn){try{var tmp=eval(fn),data;tmp?"function"===typeOf(tmp)?id in _callbacks?_callbacks[id]():taStore.has("pending."+id)?(data=taStore.retrieve("pending."+id),data.evnt?tmp.attempt([data.evnt,data.elmt]):tmp.attempt()):tmp.attempt():IS_DEBUG&&alert("fn is not a function: "+typeOf(tmp)):exports.waitForFnAgain(id,fn)}catch(t){exports.waitForFnAgain(id,fn)}},exports.WAIT_DELAY=100,exports.WAIT_TIMEOUT=50,exports.waitForFnAgain=function(t,e){var n=taStore.has("pending."+t)?taStore.retrieve("pending."+t):{t:"f","fn":e,count:1};n.count<exports.WAIT_TIMEOUT?(n.count++,n.timer=exports.waitForFn.invokeLater(exports.WAIT_DELAY,null,[t,e]),taStore.store("pending."+t,n)):IS_DEBUG&&!taStore.has("pending.ignore."+t)&&alert("timed out ("+exports.WAIT_TIMEOUT*exports.WAIT_DELAY+"ms) waiting for function: "+e)},exports.waitForFile=exports.waitForHandler=function(t,e,n,o){taStore.store("pending."+t,{count:0,t:"f","fn":e,"evnt":n,"elmt":o}),exports.waitForFn(t,e)},exports.cancel=function(t){var e=taStore.remove("pending."+t);e&&e.timer&&clearTimeout(e.timer)},exports.lock=function(t,e,n,o){return taStore.has("pending."+t)?[o,!1].pick():(taStore.store("pending."+t,!0),n&&exports.unlock.delay(n,null,t),e())},exports.unlock=function(t){var e=taStore.remove("pending."+t);e&&"object"==typeof e&&(e.count--,0===e.count?e.fn():taStore.store("pending."+t,e))},exports.multilock=function(t,e,n){taStore.store("pending."+t,{"count":n,"fn":e})},exports.multilockUpdate=function(t,e){var n="pending."+t,o=taStore.retrieve(n);o&&(o.count+=e)},exports.wait=function(t,e,n,o,r){taStore.store("pending."+t,{timer:e.delay(n,o,r)})},exports.waitForElement=function(t,e,n){if(!taStore.has("pending."+t)){var o=document.getElementById(e);o?(exports.cancel("pending."+t),n(o)):taStore.store("pending."+t,{timer:exports.waitForElement.delay(2,null,[t,e,n])})}},exports.waitFor=function(t,e,n){return t()?e():(setTimeout(function(){exports.waitFor(t,e,n)},n),!1)},exports.waitWithPing=function(t,e,n,o){function r(o,i,a){var p=t();p?e(p):(n&&o>0&&o%Math.ceil(1e3*a/i)==0&&n(o*i/1e3),setTimeout(i))}r(0,100,o||3)},exports.waitForSelector=function(t,e,n,o){exports.waitWithPing(e,n,o)},nsExporter.exportTo(exports,"ta.util.pending"),exports});
define("utils/tempFunction",["vanillajs"],function(){var n=0,t="__utils_tempFunction",i={create:function(e,o){var u=t+n++;return window[u]=o?e:u},destroy:function(n){n in window&&0==n.indexOf(t)&&delete window[n]}};return i});
define("ta/util/Load",["vanillajs","ns-exporter","ta/util/Error","ta/Core/TA.Event","ta/Core/TA.Store","ta/Core/TA.Load","utils/resourceLoader","utils/tempFunction"],function(o,a,e,n,t,r,l,i){function u(o,a,n){var i=t.remove("infobox_js");if(i){var u=function(){d.maps(function(){l.load([i,o],a)})};r.load(n,u)||e.record(null,"Rollup file was not found: ",n)}else e.record(null,"'infobox_js' path was not specified for this page")}var c,d={},f=!1,s=!1,p=[];return d.maps=function(o){if(f)o&&o();else{if(!s)return s=!0,ta.maps.load.library(function(){f=!0,s=!1,o&&o(),p.each(});p.push(o)}},d.mapsLazy=d.loadMapV2Lite=function(o,a){u(a,o,"ta-mapsv2-lite")},d.loadMapV2=d.GoogleLoader=function(o){if("loaded"==c)return o();if("loading"==c)return d.GoogleLoader.delay(500,this,o);c="loading";var a=i.create(function(){c="loaded",o&&o(),i.destroy(a)});l.load("//www.google.com/jsapi?callback="+a,{forceType:"js"})},d.LocalSearch=function(o){d.GoogleLoader(function(){google.load("search","1",{callback:function(){}})})},a.exportTo(d,"ta.util.load"),d});
define("ta/util/Date",["vanillajs","ns-exporter"],function(e,t){var n={};return n.MS_IN_DAY=864e5,n.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],n.HOUR_CONST=12,n.THAI_BUDDHIST_YEAR_OFFSET=543,n.MAX_STAY_DURATION_DAYS=30,n.MAX_VR_DURATION_DAYS=183,n.MAX_DAYS_BEFORE_RETURN_FLIGHT=330,n.MAX_ATTRACTION_RANGE_DAYS=330,n.inDateSet=function(e,t){if(null==e||null==t)return!1;for(var n=t.length,r=0;r<n;r++){var a=t[r];if(a.length){var i=a[0].getTime(),T=a[1].getTime();if(i<=e.getTime()&&T>=e.getTime())return!0}else if(e.getTime()==a.getTime())return!0}return!1},n.rangesIntersect=function(e,t){return Math.max(e[0].getTime(),t[0].getTime())<=Math.min(e[1].getTime(),t[1].getTime())},n.getDaysInRange=function(e,t){return Math.round((t.getTime()-e.getTime())/n.MS_IN_DAY)+1},n.getLastDayOfMonth=function(e){var t=new Date;return e&&(t=new Date(e.getTime())),t=new Date(n.normalize(t)),t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(0),t.getDate()},n.getDaysApart=function(e,t){var n=864e5;return e&&t?Math.round(Math.abs((e.getTime()-t.getTime())/n)):0},n.inSameMonth=function(e,t){return null!=e&&null!=t&&e.getMonth()==t.getMonth()&&e.getYear()==t.getYear()},n.normalize=n.create=t.exportTo(n,"ta.util.date"),n});
define("ta/util/Currency",["vanillajs","ta/util/Cookie","common/trackingStreams","ns-exporter"],function(r,n,t,e){var o={},a="‏",i="؜",u=" ",c="‎";return o.formatCurrency=function(r,n,t,e){var a=n?n:"USD",i=window.currencySymbol[a],f=r;e||(f=o.formatThousands(Math.round(r)));var s=i[0],l=i[1],y=document.body.classList;return y.contains("lang_ar")?o.isCurrencyAbbreviation(s)?f+u+s+c:s+c+u+f:t?l?f+u+s:s+u+f:l?f+s:s+f},o.formatCurrencyRange=function(r,n,t,e){var c,f=document.body.classList;return c=f.contains("lang_ar")?u+"-"+i+u:ta.util.i18n.isRtl()?u+"-"+a+u:u+"-"+u,e?(r=o.formatCurrency(r,t,!0),n=o.formatCurrency(n,t,!0),r+c+n):(r=o.formatCurrency(r,t),n=o.formatCurrency(n,t),r+c+n)},o.isCurrencyAbbrevit(r)},o.formatThousands=function(r){if("undefined"==typeof groupingSize||"undefined"==typeof groupingSeparator||groupingSize<1)return r;for(var n="",t=""+r,e=1;e<=t.length;e++)n=t.charAt(t.length-e)+n,e%groupingSize==0&&e<t.length&&(n=groupingSeparator+n);return n},o.setCurrencyAndReload=function(r,e){var o="SetCurrency";n.write(o,r,15e3),e=e?e+"|":"",t.trackEvent("CurrencyPicker","Select",e+r),location.reload(!0)},e.exportTo(o,"ta.util.currency"),o});
define("ta/util/Toggle",["api-mod","vanillajs","ns-exporter"],function(e,t,n){function i(e){for(var t=e.previousSibling;t;t=t.previousSibling)if(1==t.nodeType)return t}var l={};return l.siblings=function(t,n){e.stopEvent(t);var i=e.hasClass(n,"closed");e.toggleClass(n,"closed sprite-arrow_toggle_blu_lft"),Array.prototype.slice.call(n.parentNode.childNodes).forEach(function(t){t==n||1!=t.nodeType||e.hasClass(t,"ignore_toggle")||(t.style.display=i?"block":"none")})},l.parentClass=function(t,n){e.stopEvent(t);var i=e.getParent(n,"toggle");i&&e.toggleClass(i,"off")},l.toggleTarget=function(t,n,i){e.stopEvent(t),e.toggleClass(n,"closed"),e.toggleClass(n,"open"),i.style.display=e.hasClass(n,"closed")?"none":"block"},l.toggleLI=function(e,t,n){for(var i=0,l=e.nextSibling;l&&l.id!=t.id&&(1==l.nodeType&&(l.style.display=n?"block":"none"),!(++i>1e3));l=l.nextSibling);e.style.display=n?"none":"block",t.style.display=n?"block":"none"},l.splitHotel=function(){var t=e.find("#HOTEL_DESCRIPTION .descriptive_text"),n="textContent"in t?"textContent":"innerText",i=t[n],l=1e3;if(i&&i.length>l){var s=i.substring(0,l),o=i.substring(l,i.length);e.select("#HOTEL_DESCRIPTION .descriptive_text").forEach(function(e){e[n]=s}),e.select("#HOTEL_DESCRIPTION .description_ellipsis, #HOTEL_DESCRIPTION .more_description").foine"}),e.select("#HOTEL_DESCRIPTION .descriptive_text_last").forEach(function(e){e[n]=o})}},l.expandHotel=function(t,n){var l=e.find(".descriptive_text_last",n.parentNode),s=e.find(".less_description",n.parentNode);if(s&&(s.style.display="inline"),l){l.style.display="inline";var o=i(l);o&&(o.style.display="none")}n.style.display="none"},l.truncateHotel=function(t,n){var l=e.find(".more_description",n.parentNode),s=e.find(".descriptive_text_last",n.parentNode);if(l&&(l.style.display="inline"),s){s.style.display="none";var o=i(s);o&&(o.style.display="inline")}n.hide()},n.exportTo(l,"ta.util.Toggle"),l});
define("ta/util/URL",["vanillajs","api-mod","ns-exporter","ta/Core/TA.Store"],function(t,o,e,n){var a={parse:function(t){if(/^(\w+):(.*)/.test(t))switch(t=RegExp.$2,RegExp.$1){case"DOM":var e=o.find(t);t=e&&e.href?e.href:"#";break;case"GMapsLC":if(0==t.length)break;var n=t.split(","),a={from:pageServlet,Action:n.shift()};n.forEach(function(t){/^g(\d+)$/.test(t)?a.g=RegExp.$1:"ext"==t?a.ext="y":/^(.*)=(.*)$/.test(t)?a[RegExp.$1]=RegExp.$2:a[t]=""}),t="/GMapsLocationController?"+o.toFormQueryString(a);break;case"ABS":var r="80"==window.location.port||""==window.location.port?"":":"+window.location.port;"/"!=t.charAt(0)&&(t="/"+t),t=window.location.protocol+"//"+window.location.hostname+r+t;break;case"ABSPAGE":var r="80"==window.location.port||""==window.location.port?"":":"+window.location.port;"/"!=t.charAt(0)&&(t="/"+t),t=window.location.protocol+"//"+window.location.hostname+r+t,t.indexOf(".html")==-1&&(t+=".html");break;case"REL":var i=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"));/\/$/.test(window.location.pathname)&&(i=window.location.pathname);var r="80"==window.location.port?"":":"+window.location.port;"/"!=t.charAt(0)&&(t="/"+t),t=window.location.protocol+"//"+window.location.hostname+r+i+t;break;default:t=RegExp.$1+":"+t}return t},getParameter:function(t,o){var e=new RegExp("[?&]"+o+"=([^&]+)");return!!e.test(t)&&RegExp.$1},getAbsolume+t},https:function(t){return t=t||"",t.indexOf("http")===-1&&(t=a.getAbsoluteUrl(t)),0===t.indexOf("https://")?t:n.retrieve("access_control_headers")?t.replace("http://","https://"):t},getServletNameFromUrl:function(t){return/^(?:\w+:\/\/.*)?\/([^-?]*).*/.exec(t)&&RegExp.$1}};return e.exportTo(a,"ta.util.URL"),a});
define("ta/util/I18N",["vanillajs","ns-exporter"],function(t,n){var e={};return e.isRtl=function(){return document.body&&!!document.body.className.match(/\brtl\b/)},n.exportTo(e,"ta.util.i18n"),e});
define("lib/jquery/jquery.hoverIntent",["lib/jquery-amd"],function(e){"use strict";var t,n,i={interval:100,sensitivity:6,timeout:0},agd [e])};rtor)}});
define("utils/throttle",[],function(){return function(t,n){var e,r;return function(){r&&(clearTimeout(r),r=0);var i=e?n-(Date.now()-e):null;if(null!==i&&i>0)return void(r=setTimeout(t.apply.bind(t,this,arguments),i));var u=t.apply(this,arguments);return e=Date.now(),u}}});
define("ta/util/Element",["lib/jquery-amd","utils/ajax","ta/Core/TA.Record","ns-exporter","ta/Core/TA.Event","lib/jquery/jquery.hoverIntent","utils/throttle"],function(t,e,i,n,o,r,a){function l(e,i){var n=e.style.fontSize||t(e).css("font-size"),o=n.replace(/[\d\.]/g,""),r=c(o,parseFloat(n)*i);e.style.fontSize=r+o}function s(){function e(e,i){var r=n[e],a=t(r.e);if(a.length>0){var l=r.inView;r.inView=!1,a.each(function(){return!r.inView&&void(r.inView=o.inViewport(this,i,r.persistentElmt,r.offset))}),!l&&r.inView&&(r.cb&&r.cb(r.e),r.multiple||n.splice(e,1))}}function i(){var e=t(window),i={};return i.top=e.scrollTop(),i.left=e.scrollLeft(),i.bottom=i.top+e.height(),i.right=i.left+e.width(),i}var n=[],o=this;this.add=function(i){n.push(i),e(n.length-1),n.length>0&&t(window).on("resize scroll",r)},this.inViewport=function(e,n,o,r){if(e=t(e),!e.is(":visible"))return!1;if(r=t.extend({top:0,left:0,right:0,bottom:0},r),o){var a=o.offsetHeight;a&&(0==o.offsetTop?r.bottom-=a:r.top+=a)}var l=e.offset();return n||(n=i()),n.bottom>=Math.max(l.top+r.top,0)&&n.right>=Math.max(l.left+r.left,0)&&n.top<=Math.max(l.top+e.height()+r.bottom,0)&&n.left<=Math.max(l.left+e.width()+r.right,0)};var r=a(function(){if(n.length){for(var o=i(),a=n.length-1;a>=0;a--)e(a,o);0==n.length&&t(window).off("resize scroll",r)}},300);t(window).on("load",r)}var f={};f.replaceContent=function(i,n,o,r){if(n=t(n),!n.find(".progresstab")){var a=o+(o.indexOf("?")==-1?"?":"&")+"xhr=true";n.append('<div class="progresstab"></div>'),e({url:a,success:function(t){n.html(t),window.behavior&&window.behavior.apply(n),r&&r(n.get(0))},evalScripts:!0}).get()}},f.spinner=function(e,i){t(i).parents(".spinnerReplaceable").children()r"))})},f.limitLength=function(t,e,i){return!(e.value.length>=i)||(e.value=e.value.substr(0,i),!1)},f.updateValue=function(e,i){if(e=t(e),e.length>0&&e.val()!=i){e.val(i);var n=document.createEvent("HTMLEvents");n.initEvent("change",!1,!1),e[0].dispatchEvent(n)}},f.keepInWindow=function(e,i){function n(t,e){var i=parseInt(t.get(0).style[e]);return i||0===i}if(e){e=t(e),i||(i={top:!0,right:!0,bottom:!0,left:!0});var o=2,r=e.offset();r.right=r.left+e.width(),r.bottom=r.top+e.height();var a=t(window),l=a.width(),s=a.height(),f=a.scrollTop(),c=a.scrollLeft();i.right&&n(e,"right")?r.left<c+o?e.css("right",l+c-e.width()-o):r.right>l-c-o&&e.css("right",o):i.left&&n(e,"left")&&(r.left<c+o?e.css("left",o):r.right>l-c-o&&e.setStyle("left",l+c-r.width-o)),i.bottom&&n(e,"bottom")?r.top<f+o?e.setStyle("bottom",s+f-r.height-o):r.bottom>s-f-o&&e.setStyle("bottom",o):i.top&&n(e,"top")&&(r.top<f+o?e.setStyle("top",o):r.bottom>s-f-o&&e.setStyle("top",s+f-r.height-o))}};var c=function(t,e){var i=e;return"px"==t?i=8:"em"==t?i=.5:"pt"==t?i=6:"%"==t&&(i=50),Math.max(e,i)};f.makeTextFit=function(e,i,n,r,a){a=a||1,r=r||8;var l=!1;if(t(e).each(function(e,o){o=t(o);var a=o.find(i);if(a){var s;if("number"==typeof n)s=n;else if(s=o.find(n).outerHeight(),void 0===s)return;var f=a.height();if(s<f){var c=a.css("font-size");if(c){var u=function(t,e){return"px"==e&&t>=r||"em"==e&&t>=.5||"pt"==e&&t>6||"%"==e&&t>=50},h=c.replace(/[\d\.]/g,""),d=parseFloat(c)*Math.sqrt(s/f);"px"==h&&(d=Math.max(parseInt(d),r)),u(d,h)&&(a.css("font-size",d+h),l=!0)}}}}),l>0&&a<4){o.fireEvent("makeTextFitResizedText");var s=this;setTia+1)},1)}},function(){function e(t){var e=!1;if(!t||t.clientWidth&&t.clientWidth<=0)return!1;for(var i=t.clientWidth,n=(parseFloat(t.style.paddingLeft)||0)+(parseFloat(t.style.paddingRight)||0),o=0;o<a&&t.scrollWidth>i;o++){var r=(i-n)/(t.scrollWidth-n);l(t,r),e=!0}return t.scrollWidth>i&&(l(t,s),e=!0),e}function i(t,e){var i=t.getAttribute("data-sizegroup"),n=parseFloat(t.style.fontSize);i&&(e[i]=Math.min(e[i]||Number.MAX_VALUE,n))}function n(t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o=[];n.fo,t])}),ot[0]});for(var r=0;r<o.length&&e(o[r][1]);r++);}}function r(t){var i;for(var n in t)t.hasOwnProperty(n)&&(i={},t[n].forEach(function(t){var n=t.innerHTML,o=i[n];void 0!==o?0!=o&&(t.style.fontSize=o):e(t)?i[n]=t.style.fontSize||0:i[n]=0}))}var a=4,s=.9;f.makeTextFitOneLine=function(i,n){var o=t(i);if(oe(i)}),n){var r;o.each(function(e,i){var n=t(i).css("font-size");(!r||parseFloat(n)<parseFloat(r))&&(r=n)}),r&&o.css("font-size",r)}},f.autoResizeTextInNode=function(o){o=t(o);var a=t(".autoResize",o),l={},s={width:{},text:{}};a.filter(":visible").removeClass("autoResize").each(function(t,n){var o,r,a=n.getAttribute("data-resizeWidthGroup"),f=n.getAttribute("data-resizeTextGroup");a?(o=s.width,r=a):f&&(o=s.text,r=f),o?(o[r]||(o[r]=[]),o[r].push(n)):(e(n),i(n,l))}),n(s.width),r(s.text),a.each(function(t,e){var i=e.getAttribute("data-sizegroup");i&&(e.style.fontSize=l[i]+"px")})},o.queueForLoad(function(){require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("no-old-resize")||(o.on("refreshedDOMContent",function(t){f.autoResizeTextInNode(t)}),document.body&&f.autoResizeTextInNode(document.body))},"autoResize all targets on load")}(),f.makeSameWidth=function(e){var i=0;t(e).each(function(t,e){var n=Math.round(parseFloat(e.style.width));n&&n>i&&(i=n)}).css("width",i)},f.fitToContentsHorizontally=function(e,i,n,o){if(o=o||1,!(o<=0||i>n)){ight};t(e).each(function(t,e){e.style.width=i;for(var a=i;a<n&&r(e);a+=o)e.style.width=a;r(e)&&(e.style.width=n)})}},f.scrollIntoView=function(e,i,n,o){if(e){e=t(e);var r=e.offset().top+(i||0);if(n){for(var a=t("html, body"),l=e.parent(),s=function(t){return("auto"===t.css("overflow-y")||"scroll"===t.css("overflow-y"))&&t[0].scrollHeight>t[0].clientHeight};l.length&&!l.is(a)&&!s(l);)l=l.parent();l.length&&!l.is(a)&&s(l)?r=l.offset().top+l.scrollTop()+(i||0):l=a,l.animate({scrollTop:r},{duration:300,complete:function(){o&&o()}})}else window.scrollTo(0,r),o&&o()}};var u=f.scrollTrackers=new s;return f.isScrolledInte,i)},f.doIfElementIsVisible=function(t,e,i,n){t&&u.add({e),!0},offset:n})},f.trackWhenScrolledIntoView=function(t,e,n){if(t&&e){var o=function(){i.trackEventOnPage.apply(i,e)};u.add({e:t,cb:o,multiple:n})}},f.getTotalWidth=function(e){return t(e).outerWidth(!0)||0},f.getTotalHeight=function(e){return t(e).outerHeight(!0)||0},f.hoverIntent=function(e,i){r.bind(t(e),i)()},n.exportTo(f,"ta.util.element"),f});
define("ta/util/Link",["vanillajs","utils/object/set-props","utils/stopevent","common/trackingStreams","ajax-request","utils/asdf-encoder","ta/Browser","ns-exporter"],function(e,t,r,a,i,n,o,f){"use strict";var s,l={popResWidth:function(e,r,i){try{var n=475,o=390,f=210;screen.width>1024?(n=800,o=600,f=240):screen.width>800&&(n=620,o=500,f=240);var s=t({width:n,height:o,xOffset:f,yOffset:5},i);l.popup(e,r,s)}catch(t){a.error(t,"ta.util.link - popCustom",e,s)}},popup:function(e,i,f){try{var l=t({name:!1,width:950,height:610,xOffset:!1,yOffset:!1,noScroll:0,aHref:!1,fullOptions:!0,ensureReferrer:!1,isAsdf:!1},f);e&&r(e);var c=!1,p="",d=s;if("undefined"==typeof d&&(d=1),l.aHref||(l.aHref=i.href),l.aHref=l.aHref.replace("%7Cnavarea%7C",ta.meta.link.getPhotoNavArea(i)),l.isAsdf&&l.aHref&&(l.aHref=n.asdf(l.aHref).replace(/&amp;/g,"&")),l.aHref&&l.aHref.indexOf("p=HotelsCom")>-1){l.width=Math.max(l.width,960);try{l.height=Math.max(l.height,window.getHeight(),600)}catch(e){l.height=Math.max(l.height,600)}}if(l.width&&(p+=",width="+l.width),l.height&&(p+=",height="+l.height),l.xOffset&&(p+=",screenX="+l.xOffset+",left="+l.xOffset),l.yOffset&&(p+=",screenY="+l.yOffset+",top="+l.yOffset),o.isChrome||(l.noScroll=1),l.fullOptions){var h=1;o.isIE9orHigher()&&(h=0),p="toolbar=1,resizable=1,menubar="+h+",location=1,status=1,scrollbars="+l.noScroll+p}else p="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+l.noScroll+p;if(l.name||(l.name="p"+d++),s=d,l.ensureReferrer&&o.isIE())try{var u=document.createElement("a");u.target=l.name,u.href=l.aHref,document.body.appendChild(u),c=window.open("",l.name,p),u.click(),document.body.removeChild(u)}catch(t){a.error(t,"ta.util.link - pop ensure referrer",e,l)}else try{c=window.open(l.aHref,l.name,p)}catch(t){a.error(t,"ta.util.link - popping window",e,{"href":l.aHref,"name":l.name,"args":p})}if("undefined"!=typeof c&&null!==c)try{c.opener=self,c.focus()}catch(e){}}catch(t){a.error(t,"ta.util.link - popup",e,l)}},directionsPop:function(e,t,r,n){n&&i("/ActionRecord?action="+n),a.trackEvent("map_pin_overlay","directions_click"),l.popup(e,t,r)},directionsPopInfoCard:function(e,t,r,n){n&&i("/ActionRecord?action="+n),a.trackEvent("dynamic_large_map","map_info_window","directions_cta"),l.popup(e,t,r)},targetBlank:function(e,r,i){try{var o=t({aHref:!1,isAsdf:!1},i);o.isAsdf&&o.aHref&&(o.aHref=n.asdf(o.aHref).replace(/&amp;/g,"&")),o.newTab||navigator.appVersion.indexOf("MSIE 7.")!=-1?window.open(o.aHref,"_blank"):require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("ta.bl_calendar_lb")?ta.servlet.Popup.openExternalWithDefaultOptions(o.aHref):window.open(o.aHref,"_blank")}catch(t){a.error(t,"ta.util.link - targetBlank",e,o)}}};return f.exportTo(l,"ta.util.link"),l});
define("babel/babel-helpers",[],function(){var e={};return e["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iteof e},e.jsx=function(){var e="function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103;rull}}}(),e.asyncItele")},e.asyncGenerator=funct 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(e){return this._invoke("next",e)},r.prototype["throw"]=function(e){return this._invoke("throw",e)},r.prototype["ret",e)},s))}},"ae(r)}}}(),e.asyncGeneratorDelegate=function(n)}}var n={},o=!1;return"function"==typeof Symbol&&Symbol.iterator&&(n[Symbol.iterthis}),n",e)},"function"==typeof e["throw"]&&(n["th",e)}),"function"==typeof e["return"]&&(n["ret",e)}),n},e.asyncToGene)})}},e.classCallon")},e.create),r}}(),e.defineEnumerablePropern e},e.defrn e},e.definePro=t,e},e["extends"]=Object.asrn e},l(n)},e.inh_=r)},e["instancof r},e.interopRequireDe":e}},e.interopRequireWil=e,r},e.newArrowon")},e.objectDestructuringed")},e.objectWithoutPropern t},e.possibleConstructorR?e:r},e.selfGlobal="undefined"==typeof global?self:global,rn n},e.slicedToe")}}(),e.slicedToArrayce")},e.taggedTemplateLi}}))},e.taggedTemplateLiteral=r,e},e.temporrn e},e.temporalUndefined={},e.tom(e)},e.toConsumablem(e)},e});
define("mixins/mixin",[],function(){"use strict";return function(r){var i,n,t=Array.prototype.slice.call(arguments,1);for(var e in t)if(t.hasOwnProperty(e)){i=t[e];for(n in i)r[n]=i[n]}return r}});
define("overlays/loading-spinner",["vanillajs"],function(){"use stiv>"}function n(){for(var i='<div class="cssLoadingSpinner" style="display:block">'+e(),n=1;n<=8;n++)i+='<div class="cssLoadingSpinner_step'+n+'"></div>';return i+"</div>"}function e(){var i=window.CDNHOST||require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("CDNHOST");return'<div class="spinnerImage" style="position: absolute; top: 50%; left: 50%; width: 32px; height: 32px; margin-top: -16px; margin-left: -16px; background:url('+i+'/img2/generic/site/ajax-loader.gif)"></div>'}return function(r){var t=window.AnimationEvent?n():e();return r?t:i(t)}});
define("overlays/utils",["vanillajs","overlays/loading-spinner","api-mod"],function(t,e,n){"use strict";var r={};return r.arrowDir={above:"bottom",below:"top",left:"right",leftTop:"right",right:"left",rightTop:"left",leftEvenInRtl:"right",rightEvenInRtl:"left",bottomRight:"top",bottomLeft:"top"},r.arrowDirRtl={above:"bottom",below:"top",left:"right",leftTop:"right",right:"left",rightTop:"left",leftEvenInRtl:"left",rightEvenInRtl:"right",bottomRight:"top",bottomLeft:"top"},r.getArrowDir=function(t,e,i){var o=n.hasClass(document.body,"rtl")?r.arrowDirRtl:r.arrowDir;if("wideside"===t&&e&&i){var l=n.getSize(e),a=n.getPosition(e),f=n.getSize(i);return a.left>f.x-a.left-l.x?o.left:o.right}return o[t]},r.injectContent=function(t,e,r,i,o){n.isElement(r)?n.adopt(t,r):i?(r=n.find(i,e),n.removeClass(r,"hidden"),n.adopt(t,r)):o?(r=n.find(o),r&&(t.innerHTML+=r.innerHTML)):t.innerHTML+=r},r.injectContentWithDataAttrs=function(t,e,n,i,o){n=n||e&&e.getAttribute("data-content")||"",i=i||e&&e.getAttribute("data-element")||"",o=o||e&&e.getAttribute("data-element-copy")||"",r.injectContent(t,e,n,i,o)},r.parseOffsets=function(t){return t&&t.length?{x:t[0]&&parseInt(t[0],10)||0,y:t[1]&&parseInt(t[1],10)||0}:{x:0,y:0}},r.loadingSpinnerHtml=e,r});
define("utils/array/flatten",["vanillajs"],function(){r,[])}});
define("utils/bindAll",["babel/babel-helpers"],function(n){return function(n){for(var r=arguments.length,e=Array(r>1?r-1:0),i=1;i<r;i++)e[i-1]=arguments[i];return e.fod(n)}),n}});
define("overlays/Overlay",["babel/babel-helpers","api-mod","mixins/mixin","mixins/Events","overlays/utils","utils/array/flatten","utils/bindAll","ta/Core/TA.Store"],function(t,e,n,i,r,o,s,h){var a=function(){function a(e){var r=this;t.classCallCheck(this,a),this.sourceElement=e,this.domParent=document.body,this.container=null,this.contentElement=null,n(this,new i("show","hide","destroy","positionDirty","hover","contentsUpdated")),s(this,"show","hide","destroy");for(var h=arguments.length,l=Array(h>1?h-1:0),u=1;u<h;u++)l[u-1]=arguments[u];o(l).fof t}).fol(r)})}return t.createClass(a,[{key:"isOpen",ner)}},{key:"show",value:function(){if(e.inDocument(this.container))return this;var t=this;return require(h.retrieve("overlay.requiredAssets")||[],function(){t.domParent.appendChild(t.container),t.container.overlay=t,t.emit("append"),t.emit("show")}),this}},{key:"hide",value:function(t){return e.inDocument(this.container)?(delete this.container.overlay,this.domParent.removeChild(this.container),this.emit("hide",{trigger:t}),this):this}},{key:"destroy",value:function(t){return this.hide(t),this.emit("destroy",{trigger:t}),this.sourceElement=null,this.contentElement=null,this}},{key:"reposition",this}},{key:"updateContent",value:function(t){return this.contentElement.innerHTML="",r.injectContentWithDataAttrs(this.contentElement,this.sourceElement,t),this.emit("contentsUpdated"),this.reposition(),this}}]),a}();return a});
define("overlays/styles/modal",["vanillajs","api-mod"],function(e,t){"use strict";function i(e,i,n,s,a,h){this.container=t.createElement(a||"span",{"class":"ui_overlay ui_modal "+i}),n&&(this.header=t.createElement("div",{"class":"header_text"}),this.header.innerHTML=n,this.container.appendChild(this.header)),s&&(this.subheader=t.createElement("div",{"class":"subheader_text"}),this.subheader.innerHTML=s,this.container.appendChild(this.subheader)),this.inner=t.createElement("div",{"class":"body_text"}),this.container.appendChild(this.inner),this.contentElement=this.inner,(null==h||h)&&(this.close=t.createElement("div",{"class":"ui_close_x"}),this.container.appendChild(this.close))}var n=function(e,n,s,a,h,d,r,l){return s=s||e&&e.getAttribute("data-modal")||"",a=a||e&&e.getAttribute("data-header")||"",h=h||e&&e.getAttribute("data-subheader")||"",function(){i.call(this,n,s,a,h,r,l),this.updateContent(d),t.addEvent(this.close,"click",tnts)},this,"close-button"))}};return n});
define("overlays/position/base",[],function(){"use strict";return function(){return function i(){var o=i.onPosition&&i.onPosition.bind(this);this.on("show",function(){o&&(this.on("positionDirty",o),o())}.bind(this)),this.on("hide",function(){o&&this.off("positionDirty",o),i.offPosition&&i.offPosition.call(this)}.bind(this))}}});
define("utils/domUtils",["vanillajs"],funct===e}var t={};return t.querySelectorArray=function(e,t){if(!e)return[];for(var r=[],n=e.querySelectorAll?e.querySelectorAll(t):[],i=n.length,o=0;o<i;o++)r.push(n[o]);return r},t.isOrContainsElement=function(e,t){if(!e||!t)return!1;if(e===t)return!0;if(e.contains&&e.contains(t))return!0;for(;t;){if(e===t)return!0;t=t.parentNode}return!1},t.forceRidth},t.isTargetFixed=function(t){for(;t;){if(t.style.position&&e(t.style.position))return!0;if(window.getComputedStyle&&e(window.getComputedStyle(t).getPropertyValue("position")))return!0;t=t.parentElement}return!1},t});
define("overlays/position",["vanillajs","api-mod","overlays/utils","ta/Core/TA.Event","overlays/position/base","utils/domUtils"],function(t,n,o,e,r,i){"use strict";function l(t,e,l,u){return function(f,a,p,h){var x=r();return x.onPosition=function(){var r=n.getSize(this.arrow)||{x:0,y:0},x=c(f,this.sourceElement),y=x?n.getSize(x):{x:0,y:0},m=x?n.getPosition(x):{left:0,top:0},d=n.getSize(this.domParent),g=o.parseOffsets(s(f)),T=!x||a||i.isTargetFixed(this.sourceElement),v=o.parseOffsets(h);this.container.style.position=T&&!p?"fixed":"absolute";var b=n.getSize(this.container);x&&x.getAttribute("data-anchorWidth")&&(n.hasClass(document.body,"rtl")?(m.left+=y.x,y.x=Number(x.getAttribute("data-anchorWidth")),m.left-=y.x):y.x=Number(x.getAttribute("data-anchorWidth")));var L=function(t,n,o,e){if("function"==typeof t){var i=Math.floor(t(b,r,y,m,d,T))+n;return this.domParent===document.body&&(i=Math.max(i,o),i=Math.min(i,e)),i+"px"}return"auto"}.bind(this);t&&e&&l&&u&&!p&&(this.container.style.position="fixed");var A=Math.max(Math.min(v.x,(d.x-b.x)/2),0);this.container.style.left=L(t,g.x,A,Math.max(d.x-b.x-A,A)),this.container.style.right=L(l,g.x,A,Math.max(d.x-b.x-A,A)),this.container.style.top=L(e,g.y,-Number.MAX_VALUE,Number.MAX_VALUE),this.container.style.bottom=L(u,g.y,-Number.MAX_VALUE,Number.MAX_VALUE)},x}}function u(t,o){return function(){return function(){function e(){var e=n.getSize(this.container);this.container.style.position="fixed",t&&(n.hasClass(document.body,"rtl")?(this.container.style.right="50%",this.container.style.marginRight=-e.x/2+"px"):(this.container.style.left="50%",this.container.style.marginLeft=-e.x/2+"px")),o&&(this.container.style.top="50%",this.container.style.marginTop=-e.y/2+"px")}this.on("show",e),this.on("positionDirty",e)}}}function f(){return function(){return functed")}this.on("show",t),this.on("positionDirty",t)}}}function c(t,o){return t&&t.length&&isNaN(t[0])?n.isElement(t[0])?t[0]:o&&n.find(t[0],o):o}function s(t){return t&&t.length&&isNaN(t[0])?t.slice(1):t}var a={};if(a.above=l(function(t,o,e,r,i,l){return r.left+e.x/2-t.x/2-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top-t.y-o.y-(l?n.scrollTop():0)}),a.below=l(function(t,o,e,r,i,l){return r.left+e.x/2-t.x/2-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top+e.y+o.y-(l?n.scrollTop():0)}),a.bottomRight=l(function(t,o,e,r,i,l){return r.left-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top+e.y+o.y-(l?n.scrollTop():0)}),a.bottomLeft=l(null,function(t,o,e,r,i,l){return r.top+e.y+o.y-(l?n.scrollTop():0)},function(t,o,e,r,i,l){return i.x-(r.left+e.x)+(l?n.scrollLeft():0)}),a.left=l(function(t,o,e,r,i,l){return r.left-t.x-o.x-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top+e.y/2-t.y/2-(l?n.scrollTop():0)}),a.leftTop=l(function(t,o,e,r,i,l){return r.left-t.x-o.x-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top-(l?n.scrollTop():0)}),a.overlapLeftTop=l(function(t,o,e,r,i,l){return r.left+e.x-t.x-o.x-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top-(l?n.scrollTop():0)}),a.right=l(function(t,o,e,r,i,l){return r.left+e.x+o.x-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top+e.y/2-t.y/2-(l?n.scrollTop():0)}),a.rightTop=l(function(t,o,e,r,i,l){return r.left+e.x+o.x-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top-(l?n.scrollTop():0)}),a.overlapRightTop=l(function(t,o,e,r,i,l){return r.left+o.x-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top-(l?n.scrollTop():0)}),a.on=l(function(t,n,o,e,r){return r.x/2-t.x/2},function(t,o,e,r,i,l){return r.top+e.y/2-t.y/2-(l?n.scrollTop():0)}),a.wideside=l(function(t,o,e,r,i,l){return r.left>i.x-r.left-e.x?r.left-t.x-o.x-(l?n.scrollLeft():0):r.left+e.x+o.x-(l?n.scrollLeft():0)},function(t,o,e,r,i,l){return r.top+e.y/2-t.y/2-(l?n.scrollTop():0)}),a.center=l(function(t,n,o,e,r){return r.x/2-t.x/2},function(t,o,e,r,i,l){return i.y/2-t.y/2+(l?0:n.scrollTop())}),a.centerBelow=l(function(t,n,o,e,r){return r.x/2-t.x/2},function(t,o,e,r,i,l){return r.top+e.y+o.y-(l?n.scrollTop():0)}),a.topCenter=l(function(t,n,o,e,r){return r.x/2-trn 0}),a.topLeft=l(null,function(t,o,e,r,i,l){return r.top-t.y-o.y-(l?n.scrollTop():0)},function(t,o,e,r,i,l){return i.x-(r.left+e.x)+(l?n.scrollLeft():0)}),a.movingCenter=u(!0,!0),a.movingCenterX=u(!0,!1),a.movingCenterY=u(!1,!0),a.cssCentered=f(),a.absolute=l(function(){return 0},function(){return 0}),a.framed=l(function(){return 0},function(){return 0},function(){return 0}),a.offScreen=l(function(){return-1e4}),a(){}},a.rightEvenInRtl=a.right,a.leftEvenInRtl=a.left,"undefined"!=typeof document&&n.hasClass(document.body,"rtl")){a.left=a.rightEvenInRtl,a.right=a.leftEvenInRtl;var p=a.bottomRight;a.bottomRight=a.bottomLeft,a.bottomLeft=p,p=a.rightTop,a.rightTop=a.leftTop,a.leftTop=p,p=a.overlapRightTop,a.overlapRightTop=a.overlapLeftTop,a.overlapLeftTop=p}return a});
define("overlays/options/closeOnEscape",["vanillajs","api-mod"],function(e,n){"use strict";function t(e){27===e.keyCode&&(e.preventDefault(),this.hide("escape"))}var o=function(){var e=n.bind(t,this);this.on("show",function(){n.addEvent(document,"keyup",e)}).on("hide",function(){n.removeEvent(document,"keyup",e)})};return o});
define("overlays/options/closeOnDocClick",["vanillajs","api-mod"],function(t,e){"use strict";function n(t){this.sourceElement&&e.containsElement(this.sourceElement,t.target)||e.containsElement(this.container,t.target)||t.target&&("option"===t.target.tagName||e.hasClass(t.target,"ui_dropdown")||e.getParent(t.target,"ui_dropdown"))||e.checkBrowser("ie")&&t.target&&"select"==t.target.tagName&&e.containsEvent(t.target,t)&&e.select(this.container,"input").indexOf(t.target)||this.hide("doc-click")}function i(t){return function(){var i=e.bind(n,this);this.on("show",function(){setTimeout(function(){this.isOpen()&&(e.addEvent(document,"click",i),t&&e.addEvent(document,"touchstart",i))}.bind(this),1)}).on("hide",function(){e.removeEvent(document,"click",i),t&&e.removeEvent(document,"touchstart",i)})}}var o=i(!0);return o.withoutTouchEvents=i(!1),o});
define("overlays/options/repositionOnEvent",["vanillajs","api-mod"],function(n,i){"use strict";function t(){this.emit("positionDirty")}return function(n,o){return function(){var e=o.splice?o:[o],c=i.bind(t,this);this.on("show",function(){e.forEach(function(t){i.addEvent(n,t,c)})}).on("hide",function(){e.forEach(function(t){i.removeEvent(n,t,c)})})}}});
define("overlays/options/autoReposition",["vanillajs","overlays/options/repositionOnEvent"],function(o,n){return n(window,["resize","scroll"])});
define("overlays/styles/windowshade",["api-mod"],function(i){"use strict";var t=function(t,s,e){return function(){if(this.shade=i.createElement("div",{"class":"ui_backdrop "+(t||"dark")+" "+(e||""),"onclick":""}),"function"==typeof s){var h=function(){var i=s();this.shade.style.top=i+"px",this.shade.style.position="absolute",this.shade.style.height=document.body.clientHeight-i+"px"}.bind(this);this.on("positionDirty",h),h()}this.on("show",function(){this.domParent.appendChild(this.shade),e&&setTiin")}.bind(this),0)});var n=this.hide;this.hide=function(){i.inDocument(this.shade)&&(e?(this.shade.classList.remove("fade_in"),setTiade)}.bind(this),250)):this.domParent.removeChild(this.shade)),n.apply(this,arguments)}}};return t});
define("utils/AjaxData",["ta","mixins/Events","lib/jquery-amd"],function(t,e,n){"use sti(){}function!==l}function r(){var t=a(),e=d,n=l;if(d=null,s=null,l=null,null!==n)try{n.abort()}catch(t){}return null!==e&&clearTimeout(e),t}function o(){var t=s;if(s=null,t){var e;t.success=function(n){l==e&&(l=null,v&&(y=n),f.data=n,f.error=void 0,f.dataVersion=++p,h(f,e,t.data),u.emit("update"))},t.error=function(n,i,a){l==e&&(l=null,f.data=y,f.dataVersion=++p,f.error={type:i,error:a,status:n.status,responseText:n.responseText},h(f,e,t.data),u.emit("update"))},e=c(t),l=e,u.emit("update")}}t=t||{};var u=new e("update"),d=null,s=null,l=null,f=this,p=0,c=t.ajaxFunc||n.ajax,h=t.transformer||i,m=t.dataType||"html",v=!!t.holdData,y=void 0;this.dataVersion=0,this.on=u.on.bind(u),this.off=u.off.bind(u),this.removeListener=u.removeListener.bind(u),this.i!a()},this.i a()},this.clear=function(){var t=a()||"undefined"!=typeof this.data||"undefined"!=typeof this.error;r(),y=void 0,f.data=void 0,f.error=void 0,f.dataVersion=0,h(f),t&&u.emit("update")},this.refresh=function(t,e,n,i,a){r(),(!i||i<0)&&(i=0),s={type:t,url:e,data:n,dataType:m,xhrFields:{withCredentials:!0}},"undefined"!=typeof a&&(s.timeout=a),d=setTimeout(o,i),f.error=void 0,v||(f.data=void 0,h(f)),u.emit("update")},this.postJson=function(t,e,n,i){r(),n=n||0,n<0&&(n=0),s={beforon")},type:"POST",url:t,contentType:"application/json",data:JSON.stringify(e),dataType:m,xhrFields:{withCredentials:!0}},"undefined"!=typeof i&&(s.timeout=i),d=setTimeout(o,n),f.error=void 0,v||(f.data=void 0,h(f)),u.emit("update")}}return a});
define("overlays/ajaxUtil",["vanillajs","ta","utils/object/shallow-copy","utils/AjaxData","mixins/Events","overlays/loading-spinner","utils/resourceLoader","amdloaders"],function(e,t,a,r,n,i,o,s){"use strict";function d(e,t){var a,r=[];for(a in t)t[a]&&r.push(a);r.sort();for(var n=e,i=n.indexOf("?")>=0?"&":"?",o=0;o<r.length;++o)a=r[o],n+=i+encodeURIComponent(a)+"="+encodeURIComponent(String(t[a])),i="&";return n}function u(){for(var e=0,t={},a=[],r=p.length-1;r>=0;--r){var n=p[r],i=g[n];i&&!t[n]&&(i.hasClients()||++e<=h)&&(t[n]=i,a.push(n))}return a.reverse(),g=t,p=a,m=p.length+h,p}function l(e,i){function d(){if(T){T=!1,u();for(var e=p.length-1;e>=0;--e){var t=g[p[e]];t.needsTravelInfo&&t.invalidate()}}}function l(){u();for(var e=p.length-1;e>=0;--e){var t=g[p[e]];t.invalidateOnPricingModeUpdate&&t.invalidate()}}function c(e,a,r,n,i,s,u){if(n=n&&t.page&&t.page.usingUnifiedDates){T=!0;var c=t.page.datesToQueryString("STAYDATES");!c&&i&&(c=t.page.defaultDatesToQueryString("STAYDATES")),c&&(a+="&"+c),y||(y=!0,t.page.on("dateSelected",d),t.page.on("guestsSelected",d),require(["trjs!common/Radio"],function(e){v||(v=e("web-component-pricingMode"),v.on("up{l()}))}))}if(s>1){if(s>20)return;a+="&reqNum="+s,u>=0||(u=2e3)}else u=0;r?e.refresh("POST",a,r,u):e.refresh("GET",a,void 0,u),o.l,h()})}function h(){if(b.isBusy()||!S)return L&&clearTimeout(L),void(L=void 0);if(!b.data)return void(0!==b.dataVersion?E.error&&E.error===b.error||(E.error=b.error||"no content",L=L||setTimeout(m,0)):0!==j&&(V=q,j=b.dataVersion,U=[],P.hasListeners("update")&&(L=L||setTimeout(m,0))));if(j!==b.dataVersion){try{var e=document.createElement("div");e.innerHTML=b.data;var t=x,a=document.head||document.getElementsByTagName("head")[0];U=[],i.noScript||Array.prototype.forEach.call(e.querySelectorAll("script"),function(e){if(t){var r=document.createElement("script");r.setAttribute("type","text/javascript"),e.src&&(r.src=e.src),e.text&&(r.text=e.text),r.setAttribute("data-rup",e.getAttribute("data-rup")),a.appendChild(r),e.src||a.removeChild(r)}e.parentNode.removeChild(e)}),Array.prototype.forEach.call(e.querySelectorAll("style"),function(e){t?a.appendChild(e):e.parentNode.removeChild(e)}),Array.prototype.forEach.call(e.querySelectorAll("[data-targetEved(e)}),t&&(x=!1,f[i.inlineResourceId]=!0),V=e.innerHTML,j=b.dataVersion,b.data=void 0}catch(e){E.error="invalid HTML"}L=L||setTimeout(m,0)}}function m(){var t,a=!P.hasListeners("update");for(L=void 0,E.data=V,E.dataVersion=j,P.emit("update");t=U.shift();){var r=t.getAttribute("data-targetEvent");if("repoll-required"===r){if(a)return U=[],E.data=V=q,void(E.dataVersion=j=0);++M>1||(M=2);var n=Number(t.getAttribute("data-delay"));c(b,e,i.reqParams,I,D,M,n)}else P.emit("data-targetEvent",r,t)}}var A,S,E=this,b=new r({dataType:"html",ajaxFunc:i.ajaxFunc}),P=new n("update","data-targetEvent"),q=i.loadingContent||C,x=!1,I=!!i.sendTravelInfo,R=!!i.invalidateOnPricingModeUpdate,D=I&&i.sendDefaultDates,L=void 0,V=q,j=b.dataVersion,U=[],M=0;this.error=void 0,this.loadingData=q,this.data=V,this.dataVersion=j,this.needsTravelInfo=I,this.invalidateOnPricingModeUpdate=R,this.on=P.on.bind(P),this.off=P.off.bind(P),this.removeListener=P.removeListener.bind(P),thisis))},this.i)||L},this.isDone=function(){return!b.isBusy()&&!L},this.invalidate=function(){b.clear(),M=0,this.hasClients()?c(b,e,i.reqParams,I,D,0,0):(E.data=V=q,E.dataVersion=j=0)},this.hasClte")},this.load=function(){if(!b.isBusy()){if(0!==b.dataVersion)return void setTimeout(function(){P.emit("update")},1);var t=i.reqParams,r=!i.isWidget||!i.inlineResourceId||!f[i.inlineResourceId];if(r){var n=s.getLoadedFilesParams();x=!0,t=t?a(t):{},t.haveJses=n.haveJses,t.haveCsses=n.haveCsses,i.isWidget&&(t.Action="install")}A=i.resources,M=0,c(b,e,t,I,D,0,0)}}}function c(e,t){var a=d(e,t.reqParams);a.length<128&&(e=a,t.reqParams=void 0);var r=g[a];return r||(r=new l(e,t),r.init(),t.noCache||(g[a]=r)),t.noCache||(p.push(a),p.length>m&&u()),r}var v,f={},h=10,p=[],g={},m=h,y=!1,T=!1,C=i();return{loadData:function(e,t){!t&&(t={});var a=c(e,t);return a.load(),a},loadOverlayWidget:function(e,t,r){var n="/OverlayWidgetAjax?Mode="+e;r?n+="&metaReferer="+encodeURIComponent(r):"string"==typeof crPageServlet&&(n+="&metaReferer="+encodeURIComponent(crPageServlet)),t=t?a(t):{},t.inlineResourceId=e,t.isWidget=!0;var i=c(n,t);return i.load(),i},cleanCache:u}});
define("overlays/options/ajax",["vanillajs","overlays/ajaxUtil"],function(t,e){"use st?$/)}function n(t,n){function a(){if(this.sourceElement&&(t=t||this.sourceElement.getAttribute("data-url"),void 0===n.noCache&&(n.noCache=this.sourceElement.getAttribute("data-ajaxNoCache")),n.resources||(n.resources=this.sourceElement.getAttribute("data-resources"),n.resources&&(n.resources=n.resources.replace(/[\[\]]/g,"").split(/[ ,]+/))),n.invalidateOnPricingModeUpdate||(n.invalidateOnPricingModeUpdate=this.sourceElement.getAttribute("data-invalidateOnPricingModeUpdate"))),t){var a,s,r=0,o=function(){a.dataVersion!==r&&(this.contentElement.innerHTML=a.data,this.emit("contentsUpdated"),r=a.dataVersion,require.defined("ta/prwidgets")&&require("ta/prwidgets").initWidgets(this.contentElement)),this.reposition(),setTimeout(this.reposition.bind(this),1),this.emit("contentLoaded",a.error)}.bind(this),d=function(i){return s==t?(this.reposition(),void this.emit("contentsUnchanged")):(n.skipInvalidate||a&&a.invalidate(),s=t,a=e.loadData(t,n),i||(this.contentElement.innerHTML=a.data),this.emit("contentsUpdated"),this.reposition(),r=a.dataVersion,require.defined("ta/prwidgets")&&require("ta/prwidgets").initWidgets(this.contentElement),a.on("update",o),void a.on("data-targetEvent",u))}.bind(this),u=this.emit.bind(this,"data-targetEvent");this.on("show",d),this.on("hide",function(){a&&(a.off("update",o),a.off("data-targetEvent",u),a=void 0)});var h=this.updateContent;this.updateContent=function(e,n){return e?i(e)?(t=e,this.isOpen()&&d(n),this):(t="",h.apply(this,arguments)):(t="",e=this.sourceElement.getAttribute("data-url"),e?this.updateContent(e):h.apply(this,arguments))}}}return n||(n={}),a}return n});
define("ta/util/ajaxFormPopup",["vanillajs","api-mod","ta/util/Cookie","ta/util/Error","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax"],function(o,a,e,l,i,t,n,r,s,c,d,u){var p;return{open:function(o,v){if(v&&v.form&&(!v.validate||v.validate(v.form))){v.pid&&e.setPIDCookie(v.pid);var y=a.getFormData(v.form);"post"!=v.method&&(o+=o.indexOf("?")>=0?"&":"?",o+=a.toFormQueryString(y),y=null),p&&p.hide(),p=new i(null,[t(null,"center","small"),n.center([0,0]),r,s,c,d(),u(o,{noScript:!v.evalScripts,reqParams:y})]),p.on("contentLoaded",function(o){o?(l.ajaxFailure("link - ajaxSubmit",o),p.hide()):v.callback&&v.callback()}).on("null}),p.show()}}}});
define("ta/util/SessionStorage",["vanillajs","ns-exporter"],function(e,t){var n={};return n.canUseSessionStore=function(){try{if(window.sessionStorage){var e="taLsTest";sessionStorage.setItem(e,"1");var t=sessionStorage.getItem(e);return"1"==t}}catch(e){return!1}},n.canUseSessionStore()?(n.setO(t))},n.getOnull},n.remove=function(e){sessionStorage.removeItem(e)}):(n.setObject=function(){},n.getObject=function(){return null},n.remove=function(){}),t.exportTo(n,"ta.util.sessionStorage"),n});
define("ta/util/LocalStorage",["vanillajs","ns-exporter","ta/Core/TA.LocalStorage","ta/util/SessionStorage"],function(e,t,o,a){"use strict";var n={canUseLocalStore:function(){return o.enabled},canUseSessionStore:function(){return a.canUseSessionStore()}};return t.exportTo(n,"ta.util.localstorage"),n});
define("ta/util/Decoder",["vanillajs","ta/util/Error","ns-exporter"],function(e,r,n){var t={base64Decoder:function(e){if(e=e.replace(/\-/g,"+").replace(/\_/g,"/"),e.length%4!==0)for(var n=4-e.length%4,t=0;t<n;t++)e+="=";for(var a,o,i,d,c,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="",u="",h="",g=0;g<e.length;g+=4){if(i=l.indexOf(e.charAt(g)),d=l.indexOf(e.charAt(g+1)),c=l.indexOf(e.charAt(g+2)),h=l.indexOf(e.charAt(g+3)),i==-1||d==-1||c==-1&&h==-1)return void r.record(null,"Facebook signed request contains invalid base64 letter",null,{"code":e});a=i<<2|d>>4,o=(15&d)<<4|c>>2,u=(3&c)<<6|h,f+=String.fromCharCode(a),64!=c&&(f+=String.fromCharCode(o)),64!=h&&(f+=String.fromCharCode(u)),a=o=u="",i=d=c=h=""}return unescape(f)}};return n.exportTo(t,"ta.util.decoder"),t});
ta.util.files={reset:function(t){Browser.ie?t.clone(!1,!0).replaces(t):t.value=""},upload:function(t,e,n){function i(t,e){var n;try{n=document.createElement("<"+t+' name="'+e+'">')}catch(i){n=document.createElement(t),n.setAttribute("name",e)}return n}function r(){ta.id(o).removeEvent("load",r);var t=o.contentWindow.document;n(t),setTimeout(function(){o.parentNode.removeChild(o)},250)}var a="upload_iframe_"+(Math.random()+"").split(".")[1],o=i("iframe",a);o.setAttribute("id",a),o.setAttribute("src","about:blank"),o.setAttribute("width","0"),o.setAttribute("height","0"),o.setAttribute("border","0"),o.setAttribute("style","width:0; height:0; border:none; display:none; "),document.body.appendChild(o),t.target=a,ta.id(o).addEvent("load",r),t.submit()}};
define("ta/util/Replace",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(e,r,t){var a={img:function(e,r){try{e.src=t.retrieve(r).src}catch(e){}}};return r.exportTo(a,"ta.util.replace"),a});
define("ta/util/ajax",["vanillajs","ns-exporter","ta/Core/TA.Record","ta/util/Error","ta/util/Object","ta/util/Deferred"],function(e,t,o,n,a,r){"use strict";function s(e){if("undefined"!=typeof MooTools&&"undefined"!=typeof Request)return new Request(e).send().xhr;var t,o,n=new XMLHttpRequest,a=n.abort.bind(n),r=e.method?e.method.toUpperCase():"GET",s=e.url||"/",c=[];e.withCredentials&&n.withCredentials(!0),n.onreadystatechange=function(){4===this.readyState&&(clearTimeout(t),e.onComplete())},n.abort=function(){a(),e.onCancel()},e.timeout&&(t=setTiut()},e.timeout)),e.data||(e.data={});for(o in e.data)e.data.hasOwnProperty(o)&&null!==e.data[o]&&c.push(o+"="+encodeURIComponent(e.data[o]));/GET/.test(r)&&(s+=(/\?/.test(s)?"&":"?")+c.join("&")),/POST/.test(r)&&(e.headers||(e.headers={}),e.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8"),n.open(r,s);for(o in e.headers)n.setRequestHeader(o,e.headers[o]);return e.onRequest&&e.onRequest.call(n),n.send(/POST/.test(r)?c.join("&"):null),n}var c=function(e){e||(e={});try{if(e.trackEvent){var t=o._toEvtParams(e.trackEvent);e.data=a.merge(e.data||{},t)}}catch(e){n.record(e,"ta.util.ajax.initialize.trackEvent")}var c,u=r(e.apl(e):""},l={onComplete:"function"==typeof e.onComplete?e.onComplete:i,onSuccess:"function"==typeof e.onSuccess?e.onSuccess:i,onFailure:"function"==typeof e.onFailure?e.onFailure:i,onReadOnly:e.onReadOnly||i,onRedirect:e.onRedirect||i};return e.onComplete=function(){var t,a=c.getResponseHeader("content-type"),r=e&&e.useContentType;try{if(!r||a.indexOf("application/json")>=0){var s=d(c.responseText);t=JSON.decode?JSON.decode(s):JSON.parse(s)}}catch(e){}t||(t={text:c.responseText}),t.code||(t.code=c.status||0),t.contentType=a;try{e&&e.trackEvent&&o._trackEventAfterAjax(this.options.trackEvent)}catch(e){n.record(e,"ta.util.ajax.onComplete.trackEventAfterAjax")}t.code>=200&&t.code<300?(t.status="ok",u.resolve(t)):301===t.code||302===t.code?(t.status="redirect",u.reject(t)):(t.status||(t.status="error"),u.reject(t))},e.onCancel=function(){u.reject({code:0,status:"abort"})},e.onTit"})},delete e.onLoadStart,delete e.onProgress,delete e.onException,delete e.onSuccess,delete e.onFailure,c=s(e),"function"==typeof e.onRequestCreated&&e.onRequestCreated(c),u.promise().always(function(e){l.onComplete.call(c,e),"redirect"===e.status?l.onRedirect.call(c,e):"readonly"===e.status?l.onReadOnly.call(c,e):~["abort","timeout","error"].indexOf(e.status)?l.onFailure.call(c,e):l.onSuccess.call(c,e)})};return t.createNs(c,"ta.util","ajax"),c});
define("ta/util/cdn",["vanillajs","ns-exporter"],function(t,n){var e={};return e.imageServer=function(t){var n="string"==typeof CDNHOST&&CDNHOST||"string"==typeof cdnhost&&cdnhost;return n&&t&&(/^\//.test(t)||(t="/"+t),t=n+t),t},n.exportTo(e,"ta.util"),e});
define("common/Radio",["babel/babel-helpers"],function(e){var t={},n=/\s+/,r=function(){function t(n){e.classCallCheck(this,t),this.channel=n,this.events={},this.replies={}}return e.createClass(t,[{key:"reply",value:function(e,t,r){var i=this;return e.split(n).forEach(function(e){i.replies[e]||(i.replies[e]=[]),i.replies[e].push({callback:t,context:r||i})},this),this}},{key:"request",value:function(e){if(!this.replies[e])return null;var t=this.replies[e];t=t[t.length-1];for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.callback.apply(t.context,r)}},{key:"requestMany",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.replies[e]?this.replies[et,n)}):null}},{key:"requestAll",value:function(t,n){for(var r=arguments.length,i=Array(r>2?r-2:0),u=2;u<r;u++)i[u-2]=arguments[u];if(!this.replies[t])return!0;i=[n].concat(e.toConsumableArray(i));var s="function"==typeof n?n:function(e){return e===n};return this.replies[t].reduce(function(e,t){return e&&s(t.callback.apply(t.context,i))},!0)}},{key:"requestAny",value:function(t,n){for(var r=arguments.length,i=Array(r>2?r-2:0),u=2;u<r;u++)i[u-2]=arguments[u];if(!this.replies[t])return!1;i=[n].concat(e.toConsumableArray(i));var s="function"==typeo===n};return this.replies[t].reduce(function(e,t){return e||s(t.callback.apply(t.context,i))},!1)}},{key:"on",value:function(e,t,r){var i=this;return e.split(n).forEach(function(e){i.events[e]||(i.events[e]=[]),i.events[e].push({callback:t,context:r||i})}),this}},{key:"once",value:function(e,t,r){var i=this;return e.split(n).forEach(function(e){i.events[e]||(i.events[e]=[]),i.events[e].push({callback:t,context:r||i,single:!0})}),this}},{key:"off",value:function(e,t){var r=this;return e.split(n).forEach(function(e){r.events[e]&&(r.events[e]=r.events[e].f!==t}))}),this}},{key:"trigger",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this.events[e])return this.events[e]=this.events[e].filter(function(e){return e.callback.apply(e.callback,n),!e.single}),this}},{key:"clear",this}},{key:"requestEvery",get:function(){return this.requestAll}},{key:"requestSome",get:function(){return this.requestAny}},{key:"one",get:function(){return this.once}},{key:"emit",get:function(){return this.trigger}}]),t}();r(e))}});
;
define("ta/common/Repoll",["vanillajs","utils/objutils","utils/urlutils","common/trackingStreams","ta/Core/TA.FireEvent","common/Radio","page-model"],function(e,t,n,r,o,a,i){var l=new a("ads_repoll"),s={normal:[10,1e3,2e3,4e3,4e3,4e3],extended:[10,1e3,2e3,4e3,4e3,4e3,8e3,8e3,8e3,8e3,8e3],obsolete:[10,1e3,1e3,1e3,1e3,1500,1500,1500,2e3,2e3,2e3,5e3,9e3,1e4,11e3,12e3]},c=function(e){function a(e){if(e){var t=e.querySelectorAll("[data-targetEvent]");if(t){var n;try{n=Array.prototype.slice.call(t)}catch(e){n=[];for(var a=0;a<t.length;a++)n.push(t[a])}n.forEach(function(e){var t=e.getAttribute("data-targetEvent");if(t)try{o.fireEvent(t,e)}catch(e){r.error(e,{errorMessage:"ERROR in handler for "+t})}})}}}function c(e){if(x==this&&4===this.readyState){if(O&&O.end(e),R>0)return g=g||[],g.push(c.bind(this,e)),void(window.console&&console.log&&console.log("update held while updates are paused"));this.status>=200&&this.status<=299?ne(this.response||this.responseText):re()}}function u(){if(H>=0&&w&&w>0)return H*w>=6e4?-1:(H*(w+1)>=6e4&&(E=!0),H);var e=w||0;return 0<=e&&e<C.length?(e===C.length-1&&(E=!0),C[e]):-1}function p(){var e=N+"-changes-pending";j||x?(l.reply("polling_complete",function(){return!1}),o.fireEvent(e,t.extend({},q,S),x&&w>0?w:w+1)):(o.fireEvent(e,{},-1),l.reply("initialPollComplete",function(){return!0}),l.reply("polling_complete",function(){return!0}),l.emit("polling_complete"),o.fireEvent(N+"-polling-complete"))}function d(){R=R>0?R+1:1}function f(){if(R>1)return void(R-=1);R=0;var e=g||[];g=null;for(var t;t=e.shift();)try{t()}catch(e){}}function v(){return y}e=e||{};var h,m,g,w=1,y=0,T=!1,E=!1,P=0,x=null,S={},j=!1,A={},b={},q={},M=!!e.evaluateScripts,N=e.placement||"page",R=0,H=e.pollTimeoutOverride||-1,L=Date.now(),O=e.tracker,C=(e.inspector,s[e.pollIntervalName||"normal"]||s.norm)):e},U=function(e){var t,n;h=e.split("#")[0],m=h.split("?")[0],t=h.split("?")[1]||"",n=t.split("&");for(var r=0;r<n.length;r++){var o=n[r].split("=");o[0]&&(A[decodeURIComponent(o[0])]=X(o[1]))}},D=function(e){ee(!!e,[])},I=function(e,t){z(A,e)&&ee(!0,t)},k=function(e,t){z(A,e)&&t&&(E=!1,w=0,L=Date.now())},_=function(e){B(A,e)},F=function(){return A},W=function(e,t){z(b,e||{}),ee(!0,|{})},Q=function(e){for(var t=e.length-1;t>=0;t--){var n=e[t];delete A[n],T=!0}},z=function(e,t){if(!t)return!1;for(var n=!1,r=Object.keys(t||{}),o=r.length-1;o>=0;o--){var a=r[o];e[a]!==t[a]&&(n=!0),e[a]=t[a]}return n&&(T=!0),n},B=function(e,t){if(!t)return!1;for(var n=Object.keys(t||{}),r=n.length-1;r>=0;r--){var o=n[r];e[o]=t[o(!1)},J=function(e){var t,n,r,o=(e&&e.getAttribute("data-paramNames")||"").split(",");for(t=0;t<o.length;t++)r=o[t].trim(),r&&(n=e.getAttribute("data-"+r),n?A[r]=n:delete A[r])},V=function(){return!(!x&&!j)},Y=function(){return=!!e},$=function(){return M},ee=function(e,n){var r,a=!j;if(n?"string"==typeof n&&(n=[n]):n=e?["UNKNOWN"]:[],t.each(n,function(e,t){!q[t]&&(a=!0),q[t]=!0}),!j||e&&0!==w){e&&(w=0,L=Date.now(),E=!1);var i=u();i>=0?(j=!0,T&&y++,T=!1,r=++P,window.setTimeout(function(){te(r)},i),a&&p()):(o.fireEvent("hac-could-not-complete"),re())}},te=function(e){if(!x&&j&&e===P){if(R>0)return g=g||[],g.push(te.bind(this,e)),void(window.console&&console.log&&console.log("request held while updates are paused"));var r=++w,o=t.extend({},A,b),a=null;o.reqNum=r,o.isLastPoll=E,o.paramSeqId=y,o.waitTime=Date.now()-L,O&&O.start(r),q.UNKNOWN||(a=[],t.eh(e)}),o.changeSet=a.toString()),i.session.uid&&(o.puid=i.session.uid),j=!1,b={},S=q,q={};var l;try{l=new XMLHttpRequest}catch(e){try{l=new ActiveXObject("MSXML2.XMLHTTP")}catch(e){try{l=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("Can't create XMLHttpRequest or similar")}}}l.onreadystatechange=c.bind(l,r),l.open("POST",m,!0),"responseType"in l&&(l.responseType="document");try{l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(e){}try{l.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(e){}try{l.setRequestHeader("Accept","text/html, */*")}catch(e){}l.send(n.toQueryString(o)),x=l}},ne=function(e){if(R>0)return g=g||[],g.push(ne.bind(this,e)),void(window.console&&console.log&&console.log("update held while updates are paused"));var t;"string"==typeof e?(t=document.createElement("div"),t.innerHTML=e):t=e;var n=j;if(x=null,S={},M){var r=t.querySelectorAll("script");r=r?Array.prototype.slice.call(r):[];for(var i=0;i<r.length;++i){var l=r[i];if("application/json"!==l.type&&"application/ld+json"!==l.type&&(l.parentNode.removeChild(l),l.innerHTML))if(window.execScript)window.execScript(l.innerHTML);else if(window.eval)window.eval(l.innerHTML);else{var s=document.createElement("script");s.setAttribute("type","text/javascript"),s.text=l.innerHTML,document.head.appendChild(s),document.head.removeChild(s)}}}a(t),"page"===N&&(t.querySelector('[data-targetEvent="'+N+'-repoll-not-done"]')||o.fireEvent("MetaFetchComplete")),x=null,n&&te(++P),p()},re=function(){if(R>0)return g=g||[],g.push(re.bind(this)),void(window.console&&console.log&&console.log("error held while updates are paused"));var e=j;x=null,S={},e?te(++P):o.fireEvent(N+"-repoll-failed"),p()};return o.on(N+"-repoll-not-done",G),o.on(N+"-repoll-ajax-params",J),U(e.pageUrl||window.location.href),e.ajaxParams&&(A=t.extend(A,e.ajaxParams)),setTimeout(function(){V()||o.fireEvent(N+"-polling-complete")},0),{setPageUrl:U,repoll:D,pause:d,resume:f,getAjaxParams:F,setAjaxParams:I,setAjaxParamsNoPoll:k,setAjaxParamsNoPollForSP:_,setOneTimeParams:W,setOneTimeParamsNoPoll:K,removeAjaxParams:Q,setNotDone:G,isUpdatePending:V,getLastRequestNum:Y,setScriptsEval:Z,isScriptsEvalEnabled:$,fireTargetEvents:a,getParamSeqId:v}};return c});
define("trcore",["vanillajs","ns-exporter","ta/util/Cookie"],function(ee,n)}var i={};return i.registerOnLoad=function(e,n){require.defined("ta/Core/TA.Event")?require("ta/Core/TA.Event").queueForLoad(e,n):o("load",e)},i.registerOnUnload=function(e){o("unload",e)},i.getScrollOTop]},i.setOneTimeCookie=function(e,n){return t.write(e,n,5e3,null,cookieDomain),!0},i.setOneTimeCookieOnFQDN=function(e,n){return t.write(e,n,5e3),!0},n.exportTo(i,window||global),i});
define("ta/common/Search",["lib/jquery-amd","ta/Core/TA.Store","ta/common/Repoll","ta/util/Error","trcore","utils/ajax","ns-exporter"],function(e,a,r,t,n,o,s){var i={ta_repoll:null,getRpoll},langSelect:function(e,a){a.form.elements.q.value.length>0&&a.form.submit()},useCurrentLocen")},clearOnFocus:function(a,r){r.value==r.defaultValue&&(r.value="",e(r).removeClass("focusClear"))},defaultOnBlur:function(a,r){""==r.value&&(e(r).addClass("focusClear"),r.value=r.defaultValue)},getFormFields:function(e){for(var a={},r=0;r<e.elements.length;++r){var t=e.elements[r];""!==t.name&&"INPUT"===t.nodeName&&t.value&&(a[t.name]=t.value)}return a},getUrlFromForm:function(e){if(!e)return"";var a=e.action,r=i.getFormFields(e),t=[];for(var n in r)t.push(encodeURIComponent(n)+"="+encodeURIComponent(r[n]));return a+"?"+t.join("&")},validate:function(a,r){return""!=r.q.value.trim()&&!e(r.q).hasClass("focusClear")&&(n.setOneTimeCookie("SRCHACT","NEW"),!0)},recordAndValidate:function(r,t,n,s,l,d){if(n||i.validate(r,t)){s=s||a.retrieve("ta_typeahead_widget");var c=function(){if(s&&s.options&&s.options.onSubmit){var e=i.getUrlFromForm(t),a=r?r.type:"";s.options.onSubmit(s,e,l,a)}d?d(t,s):t.submit()};if(s&&s.options&&s.options.skipRecordAfterValidate)return s.hide(),c(),!1;var u=s&&s.options?s.options.startTime:void 0,h=s?s.lastSuccessfulQuery:void 0,m=s&&s.options&&s.options.geoId,p=s&&s.options?s.options.name:void 0,v=s&&s.historyShown;e("#MASTAHEAD_TYPEAHEAD_START_TIME").val(u),e("#MASTAHEAD_TYPEAHEAD_UI_ORIGIN").val(p),s&&s.hide();var f=s&&s.options?s.options.searchSessionId:void 0;f||(f="no_search_session_id"),l?c():o("/TypeAheadJson",{method:"GET",data:{action:"RECORD",eventType:"search_bttn",startTime:u,source:p,query:h,uiOrigin:p,scope:m>=0?m:void 0,hadHistory:v,searchSessionId:f},complete:c})}return!1},selectLang:function(a,r){try{var n=e("#SEARCH_LANG_SELECT_POPUP");if(n.hasClass("hidden"))n.removeClass("hidden");else{var o=e("#SEARCH_LANG_SELECT_INPUT"),s=e("#SEARCH_LANG_SELECTED");if(o.length){var i=r.id.match(/lang_(.+)/);if(i){var l=i[1];o.val("all"==l?"":l)}s&&i&&(e(".langSelectOption",n).removeClass("selected"),e(r).addClass("selected"))}n.addClass("hidden")}}catch(e){t.record(e,"select search lang")}},re),!1},replaceOrAddParam:function(e,a){var r=a.split("="),t=r[0],n=(r[1],new RegExp("([\\?#&])("+t+"=\\w+)")),o=n.exec(e);return o?e.replace(n,"$1"+a):e+"&"+a},extractParam:function(e,a,r){var t=new RegExp("[\\?#&]"+a+"=(\\w+)"),n=t.exec(e);return n?n[1]:r||null},selectOption:function(a,r){var n=e(r),o=n.closest("form");try{a):0},l=e(".SEARCH_SELECT_POPUP",o),d=e(".SEARCH_SELECTED",o);if(l.hasClass("hidden"))l.removeClass("hidden"),d.length&&(i.width=s(d.css("width")));else{l.addClass("hidden");var c=e(".SEARCH_SELECT_INPUT",o);if(c&&(c.val(n.hasClass("lang_all")?1:2),d.html(n.html())),d.length){var u=i.width,h=s(d.css("width")),m=Math.max(u,h);d.css("width",m+"px")}}}catch(e){t.record(e,"select search lang")}},buildSearchHref:function(e,r,t,n){var o=window.location.hash,t=t||0;e&&(o=i.replaceOrAddParam(o,"ssrc="+e)),n&&(o=i.replaceOrAddParam(o,"dist="+n)),o=i.replaceOrAddParam(o,"o="+t),window.location.hash=o;var s=a.retrieve("searchTrackingId"),l=a.retrieve("searchRefinementId"),d=a.retrieve("sessionId"),c=a.retrieve("searchSessionId"),u=window.location.href;return u=u.replace(/#.*/,""),s&&(u=i.replaceOrAddParam(u,"sid="+s)),l&&(u=i.replaceOrAddParam(u,"rf="+l)),d&&(u=i.replaceOrAddParam(u,"sessionId="+d)),c&&(u=i.replaceOrAddParam(u,"searchSessionId="+c)),e||(e=i.extractParam(o,"ssrc","a")),u=i.replaceOrAddParam(u,"actionType=updatePage"),u=i.replaceOrAddParam(u,"ssrc="+e),u=i.replaceOrAddParam(u,"dist="+n),u=i.replaceOrAddParam(u,"o="+t),u=i.replaceOrAddParam(u,"ajax=search")},loadSRPlacement:function(r){function t(){var r=0,t=e("input#searchCurrentPagePosition").val(),n=30;t&&(r=(t-1)*n);var o=e(".selected","#SEARCH_FILTERS_COLUMN"),s=o.length?o.prop("id"):"a",l=i.buildSearchHref(s,"PG",r),d=a.retrieve("resultCacheKey");return d&&(l+="&resultCacheKey="+d),l}if(a.retrieve("commerce_on_srp")&&ta.widgets.calendar.hasPageDates()){var n=e(".result.LODGING").length>0,o=0==e("#page-repoll-not-done").length;if(r||n&&!o){var s=t(),l=this.getRepoll();l.setPageUrl(s),l.setNotDone()}}}};return s.exportTo(i,"ta.common.search"),i});
define("overlays/styles/tooltip",["vanillajs","api-mod","overlays/utils"],function(t,e,i){"use strict";function n(t,n,r){this.container=e.createElement(r||"span",{"class":"ui_overlay ui_tooltip arrow_"+i.getArrowDir(t,this.sourceElement,this.domParent)+" "+n}),this.arrow=e.createElement("div",{"class":"arrow"}),this.container.appendChild(this.arrow),this.inner=e.createElement("div",{"class":"body_text"}),this.container.appendChild(this.inner),this.contentElement=this.inner}var r=function(t,e,i,r,a){return t&&(i=i||t.getAttribute("data-tooltip"),a=a||t.getAttribute("data-elementtype")),function(){n.call(this,e,i,a),this.updateContent(r)}};return r});
define("hotels/ChildAgesSerialization",["vanillajs"],function(){function n(n){return null==n||0===n.length?[]:n.split(t).map(function(n){return parseInt(n,10)}).fN(n)})}function e(n,e){if(null==e||0===e.length)return"";for(var t=Math.floor(e.length/n),l=e.length-t*n,a=[],u=0,o=0;o<n;++o){var f=0;if(f=o<l?t+1:t){var h=Math.min(u+f,e.length),s=e.slice(u,h);u=h,a.push(s.join(i))}}return a.join(r)}var i=",",r=":",t=new RegExp(i+"|"+r);return{deserialize:n,serialize:e}});
define("overlays/EmailHotelOverlay",["ta/Core/TA.Store","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","hotels/ChildAgesSerialization"],function(e,o,t,s,a,l,r,n,i,c){return function(u,v,m,y){return new Promise(function(d){require(["trjs!ta/t4b/Emailhotel","trcss!t4b/emailhotel"],function(g){function f(){O++,O>=2&&g.init(E)}var p={detail:u,isOfferEmail:v,overrideOfferEmail:m,contactColumn:y},h=ta.page&&ta.page.guests?ta.page.guests.toJson():e.retrieve("guests.rooms.object");h&&(p.rooms=h.rooms,p.guests=(h.adults||h.guests)+c.deserialize(h.child_rm_ages).length);var E=new o(null,[t(null,"center","",""),s.center([0,0]),a,l,r,n(),i("/EmailHotel",{reqParams:p})]),O=0;E.on("contentLoaded",f).on("show",f),d(E)})})}});
define("ta/common/Flyout",["vanillajs","utils/ajax","ns-exporter","ta/Core/TA.Store","overlays/Overlay","overlays/styles/modal","overlays/styles/tooltip","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","hotels/ChildAgesSerialization","overlays/EmailHotelOverlay"],function(e,o,n,t,a,l,s,i,r,c,y,u,v,m,p){var w,d={showRecentLocationSaveOverlay:function(){setPID(3832);var e=new a(null,[l(null,"center","RecentlyViewedOverlay",""),i.center([0,0]),r,c,y,u(),v("/RecentlyViewedAjax",{reqParams:{a:"save_overlay"}})]);e.on("de()}),e.show()},showEmailHotelOverlay:function(e,o,n,t){p(e,o,n,t).then(function(e){e.show()})},bestValue:function(e,o){e&&e.preventDefault(),o.onmouseover=null;var n=new a(o,[s(o,"below","",""),i.below(),v("/vpages/bestValueFly.html?log=false")]);return n.show(),!1},amenities:function(e,n,t,s){e&&e.preventDefault(),n.onclick=null,t&&t>0&&(setPID(t),o("/ActionRecord?excludeFromVS=false&action=HRAmenitiesFlyout"));var c="/LocationTab?tab=amenities&from="+location.pathname.replace(/^[/]|-.*$/g,"")+"&suppressLinks="+!!s;return 0==n.id.indexOf("amenity_")&&(c+="&d="+n.id.substring(8)),w=w||new a(n,[l(n,"center","small",""),i.center([0,0]),r,y,u(),v(c,{resources:[amenityOverlayCss]})]),w.show(),!1}};return n.exportTo(d,"ta.common.flyout"),d});
ta.common.sendmessage={getMessageCode:function(){for(var e=(new Date).getTime(),a="ABCDEFGHIJKLMNOPQRSTUVWXYZ123456",t=[],n=0;n<32;n++)t[n]=0!=(e&1<<n)?1:0;for(var s=[[],[],[],[],[],[]],n=0;n<30;n++)s[n%s.length].push(t[t.length-1-n]);for(var o="",n=0;n<s.length;n++)o+=a.substr(parseInt(s[n].reverse().join(""),2),1);return o},communityLightbox:function(e,a){if(!communityEnabled){window.callback_communityLightboxEnable=function(){communityEnabled=!0;var t=ta.retrieve("overlays.sendmessage");t&&t.hide(),ta.common.sendmessage.communityLightbox(e,a)};var t=new StringBuffer;t.append('<p id="inviteStatusField" style="display: none; color: red;"></p>'),t.append("<p>"+JS_mem_travelnet_friends_disabledM2M+".</p>"),t.append('<p><a href="javascript:void(0)" onclick="ta.common.sendmessage.enableCommunity(window[\'callback_communityLightboxEnable\'], true); return false;">'+JS_common_Clickhere+"</a> "+JS_mem_travelnet_friends_turnOn+".</p>");var n=ta.overlays.showInLightbox(t.toString(),{backdrop:ta.overlays.BACKDROP_NEVER,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});return n.container.setStyle("z-index","9997"),$("vrWideOverview")&&ta.has("vrShowCaptcha")&&n.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()}),void ta.store("overlays.sendmessage",n)}if(a)var s=function(e){var t=ta.overlays.showInLightbox(e,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:!0,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});t.container.setStyle("z-index","9997"),$("vrWideOverview")&&ta.has("vrShowCaptcha")&&t.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()}),ta.store("overlays.sendmessage",t);var n=window[a];n&&"function"==typeOf(n)&&n()};else var s=function(e){var a=ta.overlays.showInLightbox(e,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:!0,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});a.container.setStyle("z-index","9998"),$("vrWideOverview")&&ta.has("vrShowCaptcha")&&a.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()}),ta.store("overlays.sendmessage",a)};var o={url:e,onSuccess:s,evalScripts:!0,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:communityLightbox")};new Request(o).send()},enableCommunity:function(e,a){var t=e;a,e)}),"undefined"==typeof JS_SECURITY_TOKEN&&(JS_SECURITY_TOKEN=""),new Request({url:"/MemberSubscriptionsController",data:{"Action":"ChangeM2M","set":"on","token":JS_SECURITY_TOKEN},onSuccess:t,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:enableCommunity")}).send()},enableCommunityResponse:function(res,callback){if(txt.match(/^{/)){var data=eval("("+txt+")");data.ERROR&&(document.getElementById("inviteStatusField").innerHTML=data.ERROR,document.getElementById("inviteStatusField").style.display="block")}else document.getElementById("inviteStatusField").innerHTML=JS_community_on,document.getElementById("inviteStatusField").style.display="block"},submitSendMessage:function(e,a){e.stop(),a.onclick=function(e){ta.stopEvent(e)};var t=a.className.match(/LSO_(\w+)/)[1];if($("LsoId").value=footprintGetWithSet(t),$("screenWidth").value=screen.width,$("screenHeight").value=screen.height,a.className.match(/\bform_(\w+)\b/)){var n=$(RegExp.$1),s={url:a.href,data:n,evalScripts:!0,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:submitSendMessage")},o=window["callback_"+n.name];a.className.match(/method_(\w+)\b/)&&(s.method=RegExp.$1),a.className.match(/\btgt_(\w+)\b/)?s.update=RegExp.$1:s.onComplete=function(e,a){if(ta.retrieve("messaging.isiframe")&&ta.id("PAGE"))ta.id("PAGE").set("html",e),ta.id("SUCCESS")&&(window.top.location.href="/Messages?f=512&o=0&cnt=25&j=-3&oo=0&oj=-3");else{var t=ta.retrieve("overlays.sendmessage");if(t&&t.inner&&t.newOverlays)t.inner.innerHTML=e;else{var t=ta.overlays.showInLightbox(e,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:!0,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});ta.store("overlays.sendmessage",t)}}o&&"function"==typeOf(o)&&o()};var i=window["validate"+n.id];if(!i||"function"!=typeOf(i)||0!=i.apply(n)){a.className.match(/\bevalScripts\b/)&&(s.evalScripts=!0);var r=ta.retrieve("overlays.sendmessage");r&&r.options&&r.options.permanent&&(r.options.permanent=!1),new Request(s).send()}}},cancel:function(e){if(!e){var a=ta.retrieve("overlays.sendmessage");a&&ta.remove("overlays.sendmessage"),ta.has("community.needsReload")&&window.location.reload()}},closeSendMessage:function(e,a){e&&e.stop&&e.stop(),a&&(a.onclick=null);var t=ta.retrieve("overlays.sendmessage");t&&t.hide(e),$("vrWideOverview")&&ta.has("vrShowCaptcha")&&ta.vr.showRecaptcha()}};
define("overlays/styles/default",["lib/jquery-amd"],function(t){"use strict";function e(e,a,i,s){this.container=t("<"+(s||"div")+"/>").addClass("ui_overlay").addClass(e||"").get(0),a&&(this.header=t("<div/>",{"class":"header_text"}).html(a).appendTo(this.container).get(0)),i&&(this.subheader=t("<div/>").addClass("subheader_text").html(i).appendTo(this.container).get(0)),this.contentElement=t("<div/>").addClass("body_text").appendTo(this.container).get(0),this.close=t("<div/>").addClass("ui_close_x").appendTo(this.container).get(0)}var a=function(a,i,s,n,d,o){return i=(i||"")+(a&&" "+a.getAttribute("data-overlay")||""),s=s||a&&a.getAttribute("data-header")||"",n=n||a&&a.getAttribute("data-subheader")||"",function(){e.call(this,i,s,n,o),this.updateContent(d),t(this.close).on("click",function(){this.hide.apply(this,arguments.length?arguments:["close-button"])}.bind(this))}};return a});
define("overlays/position/conditional",["overlays/position/base"],function(o){"use strict";return function(i,n,t){var s=o();s.label="conditional";var f;return s.onPosition=function(){var o=i()?n:t;f&&o!==f&&f.offPosition&&f.offPosition.apply(this),(f=o).onPosition&&f.onPosition.apply(this)},s.offPosition=function(){f=null;var o=i()?n:t;o.offPosition&&o.offPosition.apply(this)},s}});
define("utils/responsive",["vanillajs"],function(){"use strict";function t(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientight}function e(n){r)>=n}}function r(n){return function(){return t()<=n}}function i(t,n){return function(){return e(t)()&&r(n)()}}var o={largeMonitor:1600,widescreen:1280,desktop:1024,tablet:768,mobile:767},u=Object.keys(o).sort(function(t,n){return o[n]-o[t]}),c={breakpoints:u,widths:o,atLeast:e,atMost:r,between:i,largeMonitor:e(o.largeMonitor),widescreen:e(o.widescreen),desktop:e(o.desktop),tablet:e(o.tablet),mobile:r(o.mobile),desktopOnly:i(o.desktop,o.widescreen-1),tabletOnly:i(o.tablet,o.desktop-1),landscape:function(){return t()>n()},por>t()},currentBreakpoints:function(){return u.ft]()})},is:function(t,n,e){var r="function"!=typeof t&&c[t]?c[t]:t;return function(t,i){return r()?"undefined"!=typeof t?t:n:"undefined"!=typeof i?i:e}}};return c});
define("overlays/options/disableBodyScroll",["babel/babel-helpers","utils/browserutils"],function(o,e){"use strict";return function(o,t){return function(){var n=this,s={},c=function(o){var e=document.querySelector(".layered_overlay");n.container===o.target||n.container.contains(o.target)||o.target===e||e&&e.contains(o.target)||o.preventDefaulttion};this.on("show",function(){document.body.classList.contains("disableScroll")||("ios"===e.Platform.name&&(o||t&&d()||(s.scrollPos=window.pageYOffset||document.documentElement.scrollTop,s.prevTop=document.body.style.top,document.body.style.top="-"+s.scrollPos+"px"),document.body.classList.add("iOS11bug")),document.body.classList.add("disableScroll"),document.body.addEventListener("touchmove",c,{passive:!1}))}),this.on("hide",function(){document.body.removeEventListener("touchmove",c,{passive:!1}),document.body.classList.contains("disableScroll")&&("ios"===e.Platform.name&&(document.body.classList.remove("iOS11bug"),o||t&&d()||(window.scrollTo(0,s.scrollPos),document.body.style.top=s.prevTop)),document.body.classList.remove("disableScroll"))})}}});
define("overlays/position/fullscreen",["lib/jquery-amd","overlays/position/base","overlays/options/disableBodyScroll"],function(o,i,t){"use strict";return functihis)}var e=i(),l=t(n);return s.onPosition=e.onPosition=function(){o(this.container).css({position:"fixed",top:0,left:0,bottom:0,right:0,height:"auto",width:"auto"}).addClass("fullscreen")},s.offPosition=e.offPosen")},s}});
define("overlays/position/center",["lib/jquery-amd","overlays/position/base"],function(t,n){"use strict";return function(){var e=n();return e.onPosition=function(){var n=document.documentElement.clientWidth,e=document.documentElement.clientHeight,i={position:"fixed",left:(n-this.container.clientWidth)/2,top:(e-this.container.clientHeight)/2,right:"auto",bottom:"auto"};t(this.container).css(i)},e}});
define("overlays/position/autosize",["lib/jquery-amd"],function(t,i){"use strict";function e(){if(document.clientWidth)return{w:document.clientWidth,h:document.clientHeight};var t=document.documentElement||document.body.parentNode;if(t&&t.clientWidth)return{w:t.clientWidth,h:t.clientHeight};var i=document.body,e=Math.max(t.clientWidth,i.clientWidth),n=Math.max(t.clientHeight,i.clientHeight);return e>self.innerWidth||n>self.innerHeight?{w:i.clientWidth,h:i.clientHeight}:{w:e,h:n}}return function(n){n===i&&(n=0);var o="function"==typeof n?n:function(){return n};return function(){var i=!1,n=!1,h=function(){if(n=!1,i){var h=t(this.container).find(".autosize")[0]||this.contentElement;if(!h.style.maxHeight){h.style.height&&(h.style.height="");var c=!1;(this.container.style.top&&this.container.style.bottom||this.container.style.height||this.container.style.maxHeight)&&(c=!0,this.container.style.bottom="auto",this.container.style.height="auto");var s=e().h-2*o(),r=this.container.clientHeight,l=h.clientHeight;r>s&&(c=!0,h.style.height=l+s-r+"px",h.style.overflow="auto"),c&&this.emit("positionDirty")}}}.bind(this),c=function(){i&&!n&&(n=!0,setTimeout(h,0))};this.on("show",function(){i=!0,t(window).on("resize",c),this.on("contentsUpdated",h),h()}.bind(this)).on("hide",function(){i=!1,t(window).off("resize",c),this.off("contentsUpdated",h)}.bind(this))}}});
define("overlays/options/closeOnWindowshadeClick",["vanillajs","api-mod"],function(i,n){"use strict";return function(){var i=this;n.addEvent(this.shade,"click",function(){i.hide("windowshade")})}});
define("overlays/options/closeOnBackButton",[],function(){"use strict";return function(n){if(!window.history||!window.history.pushState)return function(){};var t=function(t){return function(){location.hash!==n&&t&&t.isOpen()&&t.hide()}};return function(){var o=this,i=t(o);o.on("show",function(){history.pushState({showOverlayHash:n},"",location.href.replace(/#.*|$/,"#"+n)),window.addEventListener("popstate",i,!1)}).on("hide",function(){window.removeEventListener("popstate",i,!1),location.hash==="#"+n&&history.back()})}}});
define("pages/inappropriate_vote_stub",["ta","ta/util/Element","ta/Core/TA.Store","vanillajs","overlays/Overlay","overlays/styles/default","overlays/position/conditional","utils/responsive","overlays/position/fullscreen","overlays/position/center","overlays/options/closeOnEscape","overlays/position/autosize","overlays/options/autoReposition","overlays/options/closeOnWindowshadeClick","overlays/options/closeOnBackButton","overlays/styles/windowshade","overlays/options/ajax"],function(e,o,t,n,i,r,s,a,l,p,d,u,c,w,v,y,m){"use strict";function _(e){o.isScrolledIntoView(e.elmt)||o.scrollIntoView(e.elmt),window.JS_SECURITY_TOKEN=e.token||window.JS_SECURITY_TOKEN,!window.JS_SECURITY_TOKEN&&window.ta.m&&window.ta.m.secureToken&&(window.JS_SECURITY_TOKEN=window.ta.m.secureToken);var n="/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&step=START&voteContentType="+e.voteContentType;n+=e.owner?"&action=explain&reason=21&reviewid="+e.reviewid+"&isGeo="+e.isGeo+"&locationid="+e.locationid:"&action=reportIAP&contentId="+e.contentId,T?(T.updateContent(n),T.sourceElement=e.elmt,require("pages/inappropriate_vote").updateContentId(e.contentId),require("pages/inappropriate_vote").updateVoteContentType(e.voteContentType),T.show()):require(["trjs!inappropriate_vote_dlg"],function(){T=new i(e.elmt,[r(e.elmt,"iapFlyout ui_modal"),s(a.mobile,l(),p()),d,u(0),c,y("light"),w,v("ReportProblem"),m(n,{})]),T.on("contentLoaded",function(){T.sourceElement.getAttribute("data-owner")||require("pages/inappropriate_vote").initUI(T,T.sourceElement)}),T.show(),t.store("iapFlyout",T)})}var T,E={};return E.open=function(e,o,t){t.elmt=t.elmt||o;var n={flow:"CORE_COMBINED",pid:t.reg_pid||39841,userRequestedForce:!0,loggedInBypass:!0,onSuccess:_.bind(null,t)};require(["trjs!ta/registration/RegOverlay"],function(e){e.show({type:"dummy"},t.elmt,n)})},E});
define("overlays/styles/popover",["api-mod","lib/jquery-amd","overlays/utils"],function(t,e,a){"use strict";function i(e,i,n,r){this.container=t.createElement(r,{"class":"ui_overlay ui_popover arrow_"+a.getArrowDir(e,this.sourceElement,this.domParent)+" "+i,"style":n}),this.arrow=t.createElement("div",{"class":"arrow"}),this.container.appendChild(this.arrow),this.header=t.createElement("div",{"class":"header_text"}),this.container.appendChild(this.header),this.inner=t.createElement("div",{"class":"body_text"}),this.container.appendChild(this.inner),this.contentElement=this.inner,this.close=t.createElement("div",{"class":"ui_close_x"}),this.container.appendChild(this.close)}var n=function(n,r,s,o,h,d){n=e(n),s=s||n.attr("data-popover")||"",o=o||n.attr("data-header")||"",h=h||n.attr("data-content")||"";var c=n.attr("data-style")||"",l=n.attr("data-header-element"),p=n.attr("data-header-copy");return function(){i.call(this,r,s,c,d||"span"),this.updateContent(h),o&&a.injectContent(this.header,n,o,l,p),t.addEvent(this.close,"click",t.bind(function(){this.hide.apply(this,arguments)},this,"close-button"))}};return n});
define("overlays/styles/dropdown",["vanillajs","api-mod"],function(t,n){"use strict";function e(t,e,i,o){this.container=n.createElement(o||"span",{"class":"ui_overlay ui_dropdown "+e,"style":i}),this.contentElement=this.container}var i=function(t,n,i,o,r,a){i=i||t.getAttribute("data-dropdown")||"";var s=r||t.getAttribute("style")||"";return function(){e.call(this,n,i,s,a),this.updateContent(o)}};return i});
define("overlays/options/pinnable",["vanillajs","api-mod","ta/Core/TA.Event"],function(i,n,e){"use strict";return function(){function i(){if(c.pinned&&n.inDocument(c.container)&&!o){var i=c.invisibleBackdrop?"ui_backdrop":"ui_backdrop dark";o=n.createElement("div",{"class":i}),o.setAttribute("style","z-index:499"),n.addEvent(o,"click",function(){c.hide()}),c.domParent.appendChild(o)}}function t(n){c.pinned=!0,c.invisibleBackdrop=n,i()}var o,c=this;this.pinned=!1,this.invisibleBackdrop=!1,this.pin=t,this.on("show",function(){i(),e.on(c.sourceElement,"click",t)}),this.on("hide",function(){o&&(c.domParent.removeChild(o),o=void 0,e.off(c.sourceElement,"click",t))})}});
define("overlays/ux/elementToggle",["lib/jquery-amd"],function(n){"use strict";return function(t,e){e&&(e["on"+t.type]=null);var i=t.type||"click";return function(){n(this.sourceElement).on(i,function(n){n.stopPropagation(),this.isOpen()?"click"==i&&this.hide():this.show()}.bind(this))}}});
define("overlays/support/radio",["common/Radio"],function(n){"use strict";return{hide:function(o,i){return o||(o="overlays"),i||(i="shown"),function(){var t=this,u=n(o),e=function(n){n!=t&&t.hide()};this.on("show",function(){u.on(i,e)}).on("hide",function(){u.off(i,e)})}},announce:function(o,i,t){return i||(i="overlays"),t||(t="shown"),function(){var u=this,e=n(i);this.on("show",function(){e.emit(t,u,o)})}}}});
define("styleguide/overlays/Modal",["lib/jquery-amd","utils/responsive","overlays/Overlay","overlays/styles/default","overlays/styles/windowshade","overlays/position/autosize","overlays/position/conditional","overlays/position/center","overlays/position/fullscreen","overlays/options/repositionOnEvent","overlays/ux/elementToggle","overlays/options/closeOnWindowshadeClick","overlays/options/closeOnDocClick","overlays/support/radio"],function(e,o,s,i,l,r,n,a,t,y,u,v,d,p){"use strict";return function(e,c){var h=[i(c,"ui_modal"),n(o.mobile,t(),a()),r(0),y(window,"resize"),p.hide(),p.announce(),Array.prototype.slice.call(arguments,2)];e&&h.push(u(e,c));var w=c&&c.getAttribute("data-sg-overlay")||"";return w.indexOf("nobackdrop")<0?h.push(l(),v):h.push(d),new s(c,h).show()}});
define("overlays/widgetoverlays",["ta","api-mod","overlays/Overlay","overlays/styles/popover","overlays/styles/modal","overlays/styles/dropdown","overlays/styles/windowshade","overlays/position","overlays/options/ajax","overlays/options/pinnable","overlays/options/closeOnWindowshadeClick","overlays/options/repositionOnEvent","styleguide/overlays/Modal"],function(e,i,n,r,t,o,a,s,l,v,d,m,u){"use strict";function p(e,i){var n=e.prwidget_ovl||(e.prwidget_ovl={key:i});return n.key!==i&&(n.showtimer&&(clearTimeout(n.showtimer),delete n.showtimer),n.overlay&&(n.overlay.destroy(),delete n.overlay),n.key=i),n}function c(){var n=this,r=n.prwidget_ovl;if(r&&(r.showtimer&&(clearTimeout(r.showtimer),delete r.showtimer),!(e.page&&e.page.usingUnifiedDates&&i.find(".ui_modal.date_picker_modal",document.body)))){var t=r.overlay;!t||t.pinned||t.prw_leaveTimer||(t.prw_leaveTimer=setTimeout(function(){t.pinned||t.hide()},250))}}function y(){var e=this;e&&(e.prw_entered=!0,e.prw_leaveTimer&&(clearTimeout(e.prw_leaveTimer),delete e.prw_leaveTimer))}function w(){if(!(e.page&&e.page.usingUnifiedDates&&i.find(".ui_modal.date_picker_modal",document.body))){var n=this;!n||n.pinned||n.prw_leaveTimer||(n.prw_leaveTimer=setTide()},250))}}function h(e,n){var r=!e.pinned&&y.bind(e),t=!e.pinned&&w.bind(e),o=function(){r&&i.removeEvent(e.container,"mouseenter",r),t&&i.removeEvent(e.container,"mouseleave",t),e.off("hide",o),delete n.overlay};r&&i.addEvent(e.container,"mouseenter",r),t&&i.addEvent(e.container,"mouseleave",t),e.on("hide",o)}function f(e,i){var n=i.url||"/OverlayWidgetAjax?Mode="+encodeURIComponent(e);return"string"==typeof crPageServlet&&(n+="&metaReferer="+encodeURIComponent(crPageServlet)),n}function g(e,t,o,a,d){var m=p(e,o);if(m.showtimer&&(clearTimeout(m.showtimer),delete m.showtimer),!m.overlay){var u=(d.position||"wideside").split(" ").filter(function(e){return!!e.length}),c=u.shift();if("wideside"===c)try{var y=i.getPosition(e).left,w=i.getSize(e).x,g=i.getSize(document.body).x;c=y>g-y-w?"leftEvenInRtl":"rightEvenInRtl"}catch(e){c="right"}var T=""|d.classes,_=f(o,d);d.reqParams=a,d.inlineResourceId=o,d.isWidget=!0;var x=[r(e,c,T,""),l(_,d),s[c](u,!1),v];d.mixins&&d.mixins.length>0&&x.push.apply(x,d.mixins);var E=new n(e,x);"click"===t&&E.pin(d.invisibleBackdrop),E.show(),m.overlay=E,h(E,m),d.onLoad&&E.on("contentsUpdated",d.onLoad)}}function T(e,i,r){r=r||{};var o=(r.position||"center").trim().split(" ")[0],v=f(e,r);r.reqParams=i,r.inlineResourceId=e,r.isWidget=!0;var u=[t(null,null,r.classes),l(v,r),s[o](void 0,!0),a(),d,m(window,"resize")];r.mixins&&r.mixins.length>0&&u.push.apply(u,r.mixins);var p=null;r.sourceElement&&(p=r.sourceElement);var c=new n(p,u);return c.show(),c}function _(e,i,n){n=n||{};var r=f(e,n);n.reqParams=i,n.inlineResourceId=e,n.isWidget=!0;var t=[l(r,n)];return n.mixins&&n.mixins.length>0&&t.push.apply(t,n.mixins),u(null,n.sourceElement||null,t)}function x(e,n,r,t,o){e=e||window.event,n=n||e.currentTarget;var a=e&&e.type||"click";e&&i.stopEvent(e);var s=p(n,r);if("click"===a)s.overlay||g(n,a,r,t,o);else{if(s.overlay)return s.overlay.prw_leaveTimer&&(clearTimeout(s.overlay.prw_leaveTimer),delete s.overlay.prw_leaveTimer),!1;if(s.showtimer)return!1;s.hasLeaveHandler||(i.removeEvent(n,"mouseleave",c),i.addEvent(n,"mouseleave",c),s.hasLeaveHandler=!0),s.showtimer=setTit,o)},o.delay||300)}return!1}function E(e,r,t,a,v){e=e||window.event,r=r||e.currentTarget,e&&i.stopEvent(e),v=v||{};var d=(v.position||"below").trim().split(" ")[0],m=f(t,v);v.reqParams=a,v.inlineResourceId=t,v.isWidget=!0;var u=[o(r,d,v.classes,null,v.containerStyles,v.elementType||"div"),l(m,v),s[d](void 0,!0)];v.mixins&&v.mixins.length>0&&u.push.apply(u,v.mixins);var p=new n(r,u);return p.show(),p}return{triggerFlyout:x,showLightbox:T,showDropdown:E,showStyleguideModal:_}});
define("ta/registration/AuthCheck",["ta","lib/jquery-amd"],function(e,r){"use strict";var t=function(e){var t=!1;return r.ajax({url:"/AuthCheck",data:{"secure":!!(e&&"secure"in e)&&e.secure,"username":!!(e&&"username"in e)&&e.username},async:!1,type:"GET",success:function(e){"string"==typeof e&&"true"===e.trim()&&(t=!0)}}),t};return{isAuthorized:t}});
define("members/sendMessageLightbox",["ta","overlays/widgetoverlays","ta/registration/AuthCheck"],function(e,n,o){function t(r,s,i){if(e.stopEvent(r),!i)return!1;var a=e.retrieve("overlays.sendmessage");a&&("function"==typeof a.hide&&a.hide(),e.store("overlays.sendmessage",null),a=null);var l=i+"&Mode=owa",u="undefined"!=typeof footprintGet?footprintGet():null;u&&(l+="&LsoId="+u);var d={username:!0};if(!o.isAuthorized(d)){var c={flow:"CONTENT_SUBMISSION",pid:473,userRequestedForce:!0,onSus,i)}};return e.call("ta.registration.RegOverlay.show",{type:"dummy"},s,c),!1}var h;if(!communityEnabled)return window.callback_communityLightboxEnable=function(){window.callback_communityLightboxEnable=void 0,communityEnabled=!0,h&&h.hide(),t(r,s,i)},h=n.showLightbox("COMMUNITY_LIGHTBOX"),!1;var m=n.showLightbox("SEND_MESSAGE_LIGHTBOX",{},{url:l,noCache:!0});m&&(m.newOverlays=!0,e.store("overlays.sendmessage",m))}return{showSendMessage:t}});
define("common/metric-recorder",["babel/babel-helpers","ajax-request"],function(e,r){return function(e){return r({"method":"POST","url":"/MetricsAjax","x-requested-by":require("page-model").JS_SECURITY_TOKEN,"data":"metricsData="+encodeURIComponent(JSON.stringify(e))})}});
define("utils/uuid",["babel/babel-helpers"],function(x){r6)})}});
define("ta/Core/TA.PageVisibility",["vanillajs"],function(e){"use strict";function n(){a=!1;for(var e in s)s.hasOwnProperty(e)&&s[e]()}function t(){a=!0;for(var e in f)f.hasOwnProperty(e)&&f[e]()}function d(){var e=document[c]?f:s;for(var n in e)e.hasOwnProperty(n)&&e[n]()}function i(){"undefined"==typeof document[c]?document.addEventListener?(document.addEventListener("focus",n,!1),document.addEventListener("blur",t,!1)):(document.attachEvent("onfocus",n),document.attachEvent("onblur",t)):document.addEventListener(r,d),m=!0}function o(){"undefined"==typeof document[c]?document.removeEventListener?(document.removeEventListener("focus",n,!1),document.removeEventListener("blur",t,!1)):(document.detachEvent("onfocus",n),document.detachEvent("onblur",t)):document.removeEventListener(r,d),a=!1,m=!1}function u(e,n){var t=e.indexOf(n);return t>=0?e.splice(t,1):null}var c,r,f=[],s=[],m=!1,a=!1;return"undefined"!=typeof document.hidden?(c="hidden",r="visibilitychange"):"undefined"!=typeof document.mozHidden?(c="mozHidden",r="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(c="msHidden",r="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(c="webkitHidden",r="webkitvisibilitychange"),{addFocusListener:function(e){s.push(e),m||i()},addBlurLis|i()},removeFocusListener:function(e){e?u(s,e):s.length=0,0===s.length&&0===f.length&&o()},removeBlurListener:function(e){e?u(f,e):f.length=0,0===s.length&&0===f.length&&o()},hen:a}}});
define("hotels/tracking/timing",["babel/babel-helpers","common/metric-recorder","utils/uuid","ta/Core/TA.PageVisibility"],function(e,r,n,t){function i(){a||(a=!0,t.addBlurLiso={}}))}function u(e,t){if(!a)rve()};var i=n();o[i]=!0;var u=Date.now();return function(){if(!o[i])return Promise.resolve();delete o[i];var n=Date.now()-u;return r([{name:e,value:n,labels:[t]}])}}var a=!1,o={};return{enable:i,start:u}});
define("members/memberOverlay",["utils/stopevent","overlays/widgetoverlays","common/trackingStreams","utils/responsive","amdloaders","hotels/tracking/timing","common/Radio"],function(e,r,t,i,n,o,a){function m(a,m,s,d,c){if(a&&("click"===a.type||"mouseenter"===a.type||"mouseover"===a.type)){var l=i.mobile();if(l&&"click"!==a.type)return!1;"click"===a.type&&e(a);for(var v="",u="",f="",p=!1,w=!1,b=s.split("-"),y=0;y<b.length;y++){var g=b[y];g.match(/\bUID_([0-9A-F]+)\b/)?v=RegExp.$1:g.match(/\bSRC_(\d+)\b/)?u=RegExp.$1:g.match(/\bCATID_(\d+)\b/)?f=RegExp.$1:g.match("FUS")?p=!0:g.match("PATT")&&(w=!0)}var h="";if("undefined"!=typeof window.footprintGet&&(h=window.footprintGet()),l){var _=p?"https://www.tripadvisor.com":"";return window.location.href=_+"/MemberProfile-a_uid."+v,!1}var E="/MemberOverlay?Mode=owa&uid="+v+"&c="+f+"&src="+u+"&fus="+p+"&partner="+w+"&LsoId="+h,k=o.start("member_load",require("page-model").LOC_ID);return r.triggerFlyout(a,m,"MEMBER_OVERLAY",n.getLoadedFilesParams(),{url:E,mixins:[function(){d&&c&&t.trackEvent(d,"show_reviewer_info_window",c)}],invisibleBackdrop:!0,onLoad:k}),!1}}function s(e,r,t,i,n){return!r[d]&&(r[d]=!0,r.addEventListener("click",function(e){m(e||window.event,this,t,i,n)}),r.addEventListener("mouseenter",function(e){m(e||window.event,this,t,i,n)}),e&&m(e,r,t,i,n),!1)}var d="members_memberOverlay_init";return a("memberOverlay").on("initMemberOverlay",s),{initMemberOverlay:s}});
define("ta/util/ajaxPreserves",["vanillajs"],function(){function e(e,n,r){if(r&&n&&e){var a=r.querySelectorAll(".ajax_preserve");if(a.length>0){var t={},l=n.querySelectorAll(".ajax_preserve, .ajax_preserve_noreplace");Array.prototype.forEach.c]=e)}),Array.prototype.forEach.call(a,function(n){var r=t[n.getAttribute("data-ajax-preserve")];r&&e(r,n)})}}}var n={};return n.copy=e.binde,n)}),n.innerCopy=e.bindHTML}),n.replaceContent=function(e,r){for(n.copy(r,e),r.innerHTML="";e.childNodes.length>0;)r.appendChild(e.childNodes[0])},n.setContentElement=function(e,r,a){n.copy(e,r),a?e.parentNode&&e.parentNode.replaceChild(r,e):(e.innerHTML="",e.appendChild(r))},n});
define("lib/LazyLoad",["common/trackingStreams","utils/throttle","ta/Core/TA.Store","utils/browserutils"],function(t,e,n,r){"use strict";function i(n,i,a){function c(){var e,n=document.body.scrollHeight;k=k.filter(function(t){var n=l(t.id?"#"+t.id:t.selector).get(0);return!!n&&(t.elt=n,t.onReady=function(){e=e||new o,this.elt.innerHTML=e.unobfuscate(this)||this.data},N(!t.scroll,t))}),z=z.filter(function(e){var n=e.src||e.data,r=l(e.id?"#"+e.id:e.selector);return!!(r.length&&n&&(e.src=n,e.priority=e.priority||1e3,e.elt=r.get(0),e.onReady=function(){this.priority+=L.length/1e4,L.push(this)},e.logerror&&r.on("error",function(){t.error(new Error("lazy img did not load from "+e.src),null,null,null,"WARN")}),p(r)))&&N(!e.scroll,e)}),v(),n!=document.body.scrollHeight&&C.trigger("scroll"),C.on({scroll:u,resize:h})}function u(t,e){"force"==e&&(y=!0),j()}function s(t){if(!r.ie)return t.getBoundingClientRect();try{return t.getBoundingClientRect()}catch(t){return null}}function d(t){var e=s(t.elt);return!(!e||0==e.top)&&e[b]<x}function f(){k=k.filter(N.bind(null,!1)),z=z.filter(N.bind(null,!1)),v()}function h(){var t={height:C.height(),width:C.width()};t.height==q.height&&t.width==q.width||(q=t,x=q["top"==b?"height":"width"]+w,I=g(),f())}function g(){return"top"==b?C.scrollTop():C.scrollLeft()}function m(t,e){require(["@ta/platform.runtime"],function(n){n.importBundle("@ta/platform.consent")],e)})})}function v(){Lrity}),L.forEach(function(t){var e=function(){var e=t.elt;"IMG"==e.tagName?e.src=t.src:e.style.backgroundImage="url('"+t.src+"')"};t.consentCategory?m(t.consentCategory,e):e()}),L=[]}function p(t){if(!t.hasClass("hasImage2x")&&!t.hasClass("image2x"))return!0;var e=window.devicePixelRatio&&window.devicePixelRatio>=1.5,n=!e&&t.hasClass("hasImage2x")||e&&t.hasClass("image2x");return t.toggleClass("hidden",!n),n}var y,w=void 0===n.range?200:n.range,b="horizontal"==n.mode?"left":"top",C=l(n.container||window),q={height:C.height(),width:C.width()},x=q["top"==b?"height":"width"]+w,I=g(),R=0,z=i||[],k=a||[],L=[],j=e(function(){I=g(),(y||I>R)&&(f(),R=I,z.length||C.off({scroll:u,resize:h}),y=!1)},500),N=function(t,e){var n=t||d(e);return n&&e.onReady(),!n};c()}function o(){function e(){if(void 0===r){r=null;var e;if(require.defined("page-model"))try{e=JSON.parse(require("page-model").session.lazyObf)}catch(t){}else e=n.retrieve("ta.commerce.obf");if(e)try{r={given:e.given.split(""),replace:e.replace.split(""),token:e.token}}catch(e){t.error(e,"obfuscation object corrupted")}}}var r;this.unobfuscate=function(n){e();var i=r?n.data.indexOf(r.token):-1;if(r&&0==i)try{for(var o=n.data.substr(r.token.length).split(""),a=o.length;a--;){var l=o[a];i=r.replace.indexOf(l),i!=-1&&(o[a]=r.given[i])}return o.join("")}catch(e){t.error(e,"lazy html",null,{"id":n.id})}return null}}function a(t){var e=require("lib/jquery-amd");e(t).find(".onDemandImg")mg")})}var l;return{init:function(t,e,n){return require(["lib/jquery-amd"],function(r){l=r,new i(t,e,n)}),{}},demandLoadImagesInNode:a}});
define("ta/servlet/Reviews",["pages/inappropriate_vote_stub","members/sendMessageLightbox","members/memberOverlay","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","ta/util/ajaxPreserves","lib/LazyLoad","api-mod"],function(t,a,i,r,n,s,o,l,d,v,c,u,p,h){function m(e){var t=e.getElement(".usefulReviewContainer"),a=e.getElement(".usefulReviewSlider"),i=e.getElement(".userfulReviewSrc"),r=e.getElement(".userfulReviewUserId"),n=e.getElement(".usefulReviewThankYou");if(t&&a&&i&&r&&n){var s=i.innerHTML,o=new Slider(t,a,{onChange:function(e){w[s]={"userId":r.innerHTML,"rating":e+1},n.style.display="block"},steps:4,offset:0});o.setDefault(2)}}ta.keep("facebook.onAvail",function(){FB.Event.subscribe("edge.create",function(e,t){try{var a=!1;t&&(a=ta.id(t));var i="",r=e||"";if(a&&a.className){var n=!1;(n=a.className.match(/track_(\w+)/))&&(i=n[1]),a.hasClass("expanded")&&(i+="_expanded")}new Request({url:"/ActionRecordPlus?action=LIKE&from="+i+"&url="+r}).send()}catch(e){ta.util.error.record(e,"FB like review tracking error")}})});var g,f;ta.servlet.Reviews={expandCount:0,PAGING_HEIGHT:1e3,expandReview:function(e,t,a){var i=0;if(!ta.retrieve("expand_"+a)){ta.store("expand_"+a,!0),i++;var r=ta.id(a),n=new Event(e);try{if(i++,!r)return void ta.util.error.record(null,"expandReview - no container",n,{revId:a});var s,o,l=!1;if(r.getElement&&(s=r.getElement(".dyn_full_review"),o=r.getElement(".basic_review"),l=r.getElement(".revBotContent")),!o||!o.hasClass)return void ta.util.error.record(null,"expandReview - no basic_rev",n,{revId:a});i++;var d=o.hasClass("first");if(l&&l.getElement)var v=l.getElement(".fb_like_button");var c=o.getElement(".helpful");if(i++,s)s.setStyle("display","block"),v&&ta.servlet.Reviews.injectFBLikeIntoFull(v,s),ta.servlet.Reviews.translationRatings.contains(expandedReviewId)&&ta.servlet.Reviews.injectTranslationRating(o,s),o.setStyle("display","none"),ta.remove("expand_"+a);else{i++,ta.servlet.Reviews.expandCount++;var u=o.getElement(".partnerRvw span.linkItem");i++,u&&(u.getElement("img.textArrow_more").setStyle("display","none"),new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(u)),i++,new Request({url:"/SingleUserReview-g"+modelGeoId+"-d"+modelLocId+"?review="+a+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount,onSuccess:function(e,t){try{var i=0;s=new Element("div"),s.addClass("dyn_full_review"),s.set("html",e),s.inject(o,"after"),i++;var n=s.getElement(".collapse");if(n&&n.addEvent("click",function(){ta.servlet.Reviews.collapseReview(r)}),i++,d&&s.getElement(".basic_review").addClass("first"),i++,m(s),i++,"undefined"!=typeof processLinks&&processLinks(s),i++,ta.servlet.Reviews.fixMTHelpfulUrl(s,a),o){var p=o.getElement("img.anim_loop");p.dispose()}if(i++,u){var h=u.getElement("img.textArrow_more");"undefined"!=typeof h&&null!=h&&h.setStyle("display","inline")}i++;var g=ta.retrieve("facebook.data.handlers.FRIEND_NAMES"),f=ta.retrieve("facebook.data.handlers.HIGHLIGHT_FRIENDS");if(g&&"function"==typeof g&&g(),f&&"function"==typeof g&&f({expanded:!0}),v&&ta.servlet.Reviews.injectFBLikeIntoFull(v,s),c&&(helpfulVotingKey=c.id.match(/(helpful\w+)_\w+/),helpfulVotingKey&&(helpfulVotingKey=helpfulVotingKey[1],ta.retrieve(helpfulVotingKey)))){var w=s.getElement(".helpful");w&&(w.innerHTML=c.innerHTML)}i++}catch(e){ta.util.error.record(e,"expandReview - post AJAX",null,{postProg:i})}o&&o.setStyle&&o.setStyle("display","none"),l&&l.setStyle&&l.setStyle("display","none"),ta.remove("expand_"+a);var E=ta.retrieve("ta.servlet.Reviews.callback");null!=E&&E()},evalScripts:!0}).send()}}catch(e){ta.util.error.record(e,"expandReview",n,{revId:a,prog:i}),ta.remove("expand_"+a)}}},expandReviews:function(e,t,a,i,r){if(!ta.retrieve("expand_"+a)){ta.trackEventOnPage("Reviews","expand_click"),ta.store("expand_"+a,!0);var n=ta.id(a),s=new Event(e);try{if(!n)return void ta.util.error.record(null,"expandReviews - no container",s,{revId:a});var o,l,d=!1;if(n.getElement&&(o=n.getElement(".dyn_full_review"),l=n.getElement(".basic_review"),d=n.getElement(".revBotContent")),!l||!l.hasClass)return void ta.util.error.record(null,"expandReviews - no basic_rev",s,{revId:a});if(o)ta.servlet.Reviews.showExpandedReview(a,!0),ta.remove("expand_"+a);else{ta.servlet.Reviews.expandCount++;var v=l.getElement(".partnerRvw span.moreLink");if(v){var c=v.getParent().getElement("img.textArrow_more");c&&(c.setStyle("display","none"),new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(v,"after"))}for(var u,h=$$("#REVIEWS .reviewSelector"),g=0;g<h.length;g++)h[g].id==a&&(u=h.slice(g));var f=0,w=[];if(u&&u.length>0)for(var g=0;g<u.length;g++){var E=u[g].id;if(E&&0===E.indexOf("review_")){var y=u[g].getElement(".dyn_full_review");if(!y){var R=u[g].getElement(".basic_review");R?(w[w.length]=E.split("_")[1],R.getElement(".ownerFav")&&(f=w[w.length-1])):ta.util.error.record(null,"expandReviews - basic_review content missing",null,{revId:E},"WARN")}}}if(w.length>0){var _=w[0],T=0;i&&(T=i);var M=w.join(",");new Request({url:"/ExpandedUserReviews-g"+modelGeoId+"-d"+modelLocId+"?target="+_+"&context="+T+"&reviews="+M+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount+(f>0?"&favorite="+f:""),trackEvent:{module:"Reviews",action:"expand"},onSuccess:function(e,t){try{var i=[],r=new Element("div");r.set("html",e);var n=r.getChildren(),s=[];ta.fireEvent("ReviewExpanded");for(var o=0;o<n.length;o++){var d=n[o],v=d.id.split("_")[2],c=ta.id("review_"+v);if(c&&c.getElement){s.push(c.getProperty("id"));var u=c.getElement(".basic_review");if(u){i.push(v),d.erase("id").addClass(u.className.replace("basic_review","dyn_full_review")).inject(u,"after").hide();var h=d.getChildren()[0];h&&h.removeClass("review");var g=d.getElement(".collapse");if(g&&g.addEvent("click",ta.servlet.Reviews.getCollapseCallback(c)),m(d),"undefined"!=typeof processLinks&&processLinks(d),ta.servlet.Reviews.translationRatings.contains(v)&&ta.servlet.Reviews.injectTranslationRating(u,d),ta.servlet.Reviews.fixMTHelpfulUrl(d,"review_"+v),v===_){var f=u.getElement("img.anim_loop");f&&f.dispose();var w=u.getElement(".partnerRvw span.moreLink");if(w){var E=w.getParent().getElement("img.textArrow_more");"undefined"!=typeof E&&null!=E&&E.setStyle("display","inline")}}}}}for(var y=!0,o=0;o<i.length;o++){1==o&&(y=!1);var R="review_"+i[o];ta.servlet.Reviews.showExpandedReview(R,y)}null!=window.lazyImgs&&p.init({},window.lazyImgs,window.lazyHtml)}catch(e){ta.util.error.record(e,"expandReviews - post AJAX",null,{});var f=l.getElement("img.anim_loop");f&&f.dispose();var w=l.getElement(".partnerRvw span.moreLink");if(w){var E=w.getParent().getElement("img.textArrow_more");"undefined"!=typeof E&&null!=E&&E.setStyle("display","inline")}}if(Browser.ie&&Browser.version<8){var T=function(){for(var e=0;e<s.length;++e){var t=ta.id(s[e]);null!==t&&t.addClass("dummy")}};setTimeout(T,0)}ta.remove("expand_"+a)},onFailure:function(e,t){ta.util.error.record(null,"ExpandedUserReviews ajax call failed",null,{reviewIds:M},"WARN");var a=l.getElement("img.anim_loop");a&&a.dispose();var i=l.getElement(".partnerRvw span.moreLink");if(i){var r=i.getParent().getElement("img.textArrow_more");"undefined"!=typeof r&&null!=r&&r.setStyle("display","inline")}},evalScripts:!0}).send()}}}catch(e){ta.util.error.record(e,"expandReviews",s,{revId:a}),ta.remove("expand_"+a)}}},filterReviews:function(t,a){if(ta.page&&ta.page.applyReviewFiltersForm)return ta.page.applyReviewFiltersForm(t,a);var i=arguments.callee;a=a||{};var r=ta.id("REVIEWS"),n=r.getElement(".loadingContainer");if(n){var s=r.getStyle("position");"relative"!==s&&"absolute"!==s&&"fixed"!==s&&r.setStyle("position","relative");var o=0,l=a.whiteBoxTopElmt?ta.id(a.whiteBoxTopElmt):void 0;l&&(o=l.getPosition(r).y),n.setStyles({display:"block",top:o+"px",height:r.getSize().y-o+"px"});var d=n.getElement(".loadingBox");d&&d.setStyle("top",a.loadingBoxTopElmt?ta.id(a.loadingBoxTopElmt).getPosition(r).y-o+"px":void 0)}var v=location.pathname,c=!1;if(!a.ignoreOffset)if("ShowUserReviews"===window.pageServlet){var p=window.onhashchange;window.onhashchange=void 0,location.hash="ge=p}.delay(0)}else v=location.pathname.replace(/-or\d+/,""),c=location.pathname!==v;if(!history.replaceState&&c)t.submit();else{i.request&&i.request.cancel(),c&&history.replaceState(history.state,document.title,v);var h=a.scrollToElmt?ta.id(a.scrollToElmt):void 0;h&&window.scrollTo(0,h.getPosition().y),i.request=new Request({url:v,data:"mode=filterReviews&"+t.toQueryString(),evalScripts:!0,onSuccess:function(t){var a=new Element("div",{html:t}),i=a.getChildren();if(i.length>0){i[0].getElements("[data-targetEvent]")),e)});var s=r.getElement(":focus");u.replaceContent(i[0],r),s&&s.getParent(".ajax_preserve")&&s.focus(),ta.prwidgets.initWidgets(i[0]),ta.fireEvent("review-list-update",window)}else ta.util.error.record(e,"filterReviews got invalid response"),n.setStyle("display","none")},onFailure:function(){return a.reqNum?(ta.util.error.record(void 0,"filterReviews"),void n.setStyle("display","none")):i(t,Object.merge({reqNum:1},a))}}).send()}},refreshSidebarAds:function(){try{ta.common.ads.refreshSidebarAds()}catch(e){ta.util.error.record(e,"unable to refresh sidebar ads on review expansion")}},getCollapseCal(e)}},showExpandedReview:function(e,t){try{if("undefined"==typeof e)return void ta.util.error.record(null,"showExpandedReview - reviewId is undefined");var a=ta.id(e);if(!a)return void ta.util.error.record(null,"showExpandedReview - revContainer is null",null,{revId:e});var i,r,n=!1;if(!a.getElement)return void ta.util.error.record(null,"showExpandedReview - recContainer missing getElement attribute",null,{revId:e});if(i=a.getElement(".dyn_full_review"),r=a.getElement(".basic_review"),n=a.getElement(".revBotContent"),!r)return void ta.util.error.record(null,"showExpandedReview - basic_rev is null",null,{revId:e});if(!r.hasClass)return void ta.util.error.record(null,"showExpandedReview - basic_rev missing hasClass attribute",null,{revId:e});if(n&&n.getElement)var s=n.getElement(".fb_like_button");var o=r.getElement(".helpful");if(!i)return void ta.util.error.record(null,"showExpandedReview - no full");if(o){var l=o.id.match(/(helpful\w+)_\w+/);if(l&&(l=l[1],ta.retrieve(l))){var d=i.getElement(".helpful");d&&(d.innerHTML=o.innerHTML)}}s&&ta.servlet.Reviews.injectFBLikeIntoFull(s,i),i.show(),r.hide()}catch(e){ta.util.error.record(e,"showExpandedReview")}},fixMTHelpfulUrl:function(e,t){var a=e.getElement("input[name=returnTo]");if(a){var i=document.location.href;i.indexOf("#")>=0&&(i=i.substring(0,i.indexOf("#"))),a.value=i+"#mtreview_"+t}},injectFBLikeIntoFull:function(e,t){try{if(e){var a=e.getFirst();a&&a.addClass("expanded");var i=t.getElement(".helpful");i&&e.inject(i,"after")}}catch(e){ta.util.error.record(e,"expandReview - like button")}},injectTranslationRating:function(e,t){if(e&&t){var a=e.getElement(".translation"),i=t.getElement(".translation");a&&i&&i.set("html",a.get("html"))}},translationRatings:[],collapseReview:function(e){try{e=ta.id(e);var t=e.getElement(".dyn_full_review"),a=e.getElement(".basic_review"),i=e.getElement(".revBotContent"),r=t.getElement(".fb_like_button");if(a&&a.setStyle&&a.setStyle("display","block"),i&&i.setStyle&&i.setStyle("display","block"),r){var n=r.getFirst();n&&n.addClass("expanded"),i&&r.inject(i,"inside")}var s=e.id.replace("review_","");ta.servlet.Reviews.translationRatings.contains(s)&&ta.servlet.Reviews.injectTranslationRating(t,a),t.setStyle("display","none")}catch(e){ta.util.error.record(e,"collapseReview")}},findLink:function(e,t){/\bt(r[\d]+)\b/.test(t.className)&&(window.location=$(RegExp.$1).href)},mtSubmitOnClick:function(e,t){"true"===t.value?ta.util.cookie.setPIDCookie(25173):"false"===t.value&&ta.util.cookie.setPIDCookie(25172),t.form.submit()},openMTEdit:function(e,t,a){f?f.updateContent("/MachineTranslationEdit?r="+a):(f=new r(null,[n(null,"center","mtedit_overlay"),s.center([0,0]),d,o,l,v(),c("/MachineTranslationEdit?r="+a)]),ta.store("translationEditOverlay",f),f.on("contentLoaded",function(){try{var e=ta.id("mtedit_mt").getElements(".mtedit_text")[0];e.style.height=ta.id("mtedit_english").clientHeight+ta.id("mtedit_mt").offsetTop-e.offsetTop+"px"}catch(e){ta.util.error.record(e,"openMTEdit:onLoad")}})),f.show()},validateMTEdit:function(e,t){var a=ta.id("mtedit_mt"),i=a.getElements(".mtedit_orig_title")[0].value,r=a.getElements(".mtedit_title")[0].value,n=a.getElements(".mtedit_orig_text")[0].value,s=a.getElements(".mtedit_text")[0].value;return r&&s&&(r!=i||s!=n)},enableMTEditSubmit:function(e,t){var a=ta.id("mtedit_submit");a.disabled&&ta.servlet.Reviews.validateMTEdit(e,t)&&(a.disabled=!1)},submitMTEdit:function(e,t,a,i){var r=ta.id("mtedit_submit");if(r.disabled=!0,ta.select(".mtedit_error").each(function(e){e.hide()}),ta.servlet.Reviews.validateMTEdit(e,t)){var n=ta.id("mtedit_mt"),s=n.getElements(".mtedit_title")[0].value,o=n.getElements(".mtedit_text")[0].value;new Request({url:"/MachineTranslationEditSubmit?r="+a,data:{title:s,body:o,token:i},onSuccess:function(){try{ta.id("mtedit").hide(),ta.id("mtedit_received").show(),f.reposition();var e=ta.id("mtForm"+a);e.getElement(".mtRateLabel").hide(),e.getElement(".mtImproveButton").hide(),e.getElement(".mtEditThanksLabel").show()}catch(e){ta.util.error.record(e,"submitMTEdit:onSuccess")}},onFailure:function(e){try{e.status>=400&&e.status<=499?ta.id("mtedit_404").show():(r.disabled=!1,ta.id("mtedit_500").show())}catch(e){ta.util.error.record(e,"submitMTEdit:onFailure")}}}).send()}else ta.id("mtedit_nochange").show()},rateMTReview:function(e,t){var a=ta.id(t.form),i=a.getElement("input[name=translateRating]:checked");if(i){var r=i.value,n=a.elements.userId.value,s=a.elements.reviewId.value;ta.servlet.Reviews.translationRatings.push(s);var o=a.action+"?at=true&rateValue="+s+","+n+","+r;new Request({url:o}).send();var l=a.getElement(".thanks").innerHTML;a.getElement(".translationRatingForm").innerHTML=l}},rateMTReviewNew:function(e,t,a,i){var r=ta.id("mtForm"+a);if(r){var n=r.elements.userId;if(n){ta.servlet.Reviews.translationRatings.push(a);var s=r.action+"?at=true&rateValue="+a+","+n.value+","+i;new Request({url:s}).send();var o=document.getElement(".mtRatingOverlay");o&&o.hide();var l=r.getElement(".mtRatingButton");l&&l.hide();var d=r.getElement(".thanks");d&&d.show()}}},popSocialShare:function(e,t){if(e&&e.href){var a="toolbar=1,location=1,directories=1,status=1,menubar=1,resizable=1,copyhistory=1,scrollbars=1,width=800,height=400,left=40,top=40,screenx=40,screeny=40";window.open(e.href,"SocialShare",a)}return new Request({url:"/ActionRecord?action=shareOn"+t}).send(),!1},resizeHelpfulVote:function(e){var t,a,i,r=document.querySelectorAll(e),n=document.querySelector(".helpful.redesigned"),s=document.querySelector(".isHelpful"),o=document.querySelector(".tooltips"),l=(ifdefNN(n)?n.parentNode.clientWidth:336)-20;for(ifdefNN(s)&&(l-=s.clientWidth),ifdefNN(o)&&(l-=o.clientWidth),t=0;t<r.length;t++)for(a=12,i=r[t],i.style.fontSize=a+"px";i.clientWidth>l&&a>8;)i.style.fontSize=a+"px",a--},helpfulVoteHandlerOb:function(){var e={};return function(t,a,i){if(!e[a]){e[a]=!0,new Event(t).preventDefault();var r=a.className.match(/\btgt_(\w+)\b/);if(r){r=r[1];var n=r.match(/\d+/);ifdefNN(n)&&(n=n[0]),i=ta.util.ASDF.asdfDcd(i),new Request({url:i,onSuccess:function(e,t){var a=ta.id(r+"_expanded"),i=ta.id(r+"_collapsed");a&&(a.innerHTML=e),i&&(i.innerHTML=e,ta.store(r,!0));var s=ta.id("postVoteMessage_"+n);ifdefNN(s)&&setTimeout(function(){s.addClass("seen")},500)},onComplete:function(){delete e[a]}}).send()}}}}(),recordUnattached:function(e,t){new Request({url:"/ActionRecord?action=START_UNATTACHED_RVW_SEARCH"}).send(),t.removePropertyEvent("keyup","ta.servlet.Reviews.recordUnattached")},changeSearchType:function(e,t){window.searchType&&$$("span."+window.searchType.id).hide(),window.searchType=t,ta.select("span."+t.id).setStyle("display","inline");var a=t.getAttribute("data-type")||t.value;ta.find('input[name="type"]').value=a;var i=ta.id("query"),r=i.retrieve("typeahead");if(i&&r){var n=ta.servlet.Reviews.poiTypeIdMap[a];r.options.search=TypeAhead.utils.query(!1,n,null,null,!0,10),r.options.minChars="al"==n?2:3,r.search()}var s=ta.find(".poiSearch");if(s){if("type_rental"==t.id){ta.select(".poiSearchForm, #UR_SELECT, #SRCH_RSLT").hide(),ta.select(".vrSearchForm").show();var o=ta.id("reviewGeo");o&&(o.focus(),o.select())}else{var l={type_hotel:"hotel",type_attraction:"attr",type_restaurant:"eat",type_airline:"al",type_location:"geo",type_car:"car"};ta.store("tpAhdType",l[t.id]),ta.select(".vrSearchForm, #SRCH_RSLT_VR, #MAIN_COL, #POST_PHOTOS_FORM").hide(),ta.select(".poiSearchForm, #UR_SELECT").show(),i.value.length>0&&searchByType(),i.focus(),i.select();var d=ta.id("queryGeo");if(d){var v=d.retrieve("typeAhead");if(v){var c="GEO";"type_attraction"==t.id?c="ATTRGEO":"type_restaurant"==t.id&&(c="RESTGEO"),v.changeUrl("/TypeAheadJson?action="+c),v.query(),v.updateChoices()}}}ta.select("#SRCH_RSLT, .tips").hide(),ta.store("searchResultFlag",!0)}else{var u="GEO";if("type_rental"!=t.id){switch(t.id){case"type_hotel":ta.store("tpAhdType","hotel");break;case"type_attraction":ta.store("tpAhdType","attr"),u="ATTRGEO";break;case"type_restaurant":ta.store("tpAhdType","eat"),u="RESTGEO";break;case"type_location":ta.store("tpAhdType","geo");break;case"type_car":ta.store("tpAhdType","car")}$("SRCH_BOX_VR")&&$("SRCH_BOX_VR").hide(),$("SRCH_RSLT_VR")&&$("SRCH_RSLT_VR").hide(),$("MAIN_COL")&&$("MAIN_COL").hide(),$("POST_PHOTOS_FORM")&&$("POST_PHOTOS_FORM").hide(),$("SRCH_BOX").show(),$("UR_SELECT").show();var p=ta.id("query"),h=p.retrieve("typeAhead"),m=ta.id("SEARCH_GEO");if(h){var g="/TypeAheadJson?action=SINGLELOCTYPE&types="+ta.retrieve("tpAhdType")+"&global=true";ifdefNN(m)&&ifdefNN(m.value)&&(g+="&parentids="+m.value),h.changeUrl(g),ifdefNN(p.value)&&0!==p.value.trim().length&&(h.query(),h.updateChoices())}p.focus(),p.select();var d=ta.id("queryGeo");if(d){var v=d.retrieve("typeAhead");v&&(v.changeUrl("/TypeAheadJson?action="+u),v.query(),v.updateChoices())}}else{$("SRCH_BOX_VR").show(),$("SRCH_BOX").hide(),$("UR_SELECT").hide();var o=$("reviewGeo");o.focus(),o.select()}ta.store("searchResultFlag",!0),ta.id("SRCH_RSLT").hide()}},unattachedSearchOnFocus:function(e,t,a){var i=ta.retrieve("tpAhdType"),r={xargs:"&types="+i};a&&(r.geo=a),ta.run("ta.widgets.typeahead.factory.global_mutable",{},e,t,"SINGLELOCTYPE","ta.widgets.typeahead.events.onSelectUnattached",r),t.removePropertyEvent("focus","ta.servlet.Reviews.unattachedSearchOnFocus")},unattachedSearchGeoOnFocusAttach:function(e,t){var a=ta.retrieve("tpAhdType");t.retrieve("typeAhead");ta.run("ta.widgets.typeahead.factory.global_mutable",{},e,t,"GEOGRAPHICONLY","ta.widgets.typeahead.events.onSelectGeoUnattached",{xargs:"&types="+a,minLength:1,noSearchPrompt:!0}),t.removePropertyEvent("focus","ta.servlet.Reviews.unattachedSearchGeoOnFocus")},unattachedSearchGeoOnFocus:function(e,t){var a=ta.id("SEARCH_GEO");a.value=1,t.value=""},unattachedSearchGeoOnBlur:function(e,t){var a=ta.id("SEARCH_GEO"),i=ta.id("query"),r=t.retrieve("typeAhead"),n=i.retrieve("typeAhead");if(!r.selected){var s=r.choices.getFirst();""!=t.value&&s&&s.responseObj&&!s.responseObj.notFound?(a.value=s.responseObj.value,t.value=s.responseObj.name):(a.value=1,t.value=""),n.changeUrl("/TypeAheadJson?action=SINGLELOCTYPE&types="+ta.retrieve("tpAhdType")+"&global=true&parentids="+a.value)}},ratingFlyoutScroll:function(e){try{var t=e.getScroll().y,a=e.getScrollSize().y;e.retrieve("canFetchMore",!0)&&t>a-ta.servlet.Reviews.PAGING_HEIGHT&&(e.store("canFetchMore",!1),ta.servlet.Reviews.fetchRatingPage(e))}catch(e){ta.util.error.record(e,"ratingFlyoutScroll")}},fetchRatingPage:function(e){var t=e.getElement(".ratingVal").innerHTML,a=e.getElement(".locId").innerHTML,i=e.getElement(".revId"),r=i.innerHTML;0!=r&&new Request({url:"/RatingPagingAjax",data:{locId:a,ratingVal:t,revId:r},method:"get",onSuccess:function(t,a){i.destroy(),e.innerHTML+=t,e.store("canFetchMore",!0)}}).send()},toggleOnRecentReview:function(e,t,a){if(e&&t&&a){var i=ta.id(e.target||e.srcElement),r=ta.id("RECENT_REVIEW_QUOTE_"+a);if(r&&i&&i.id==t.id){var n=r.getElement(".speechBubble");n&&n.addClass("highlight");var s=r.getElement(".recentReview_meta_content");s&&s.addClass("highlight")}if(r&&r.hasClass("hidden")){var o=ta.id("RECENT_REVIEW_ATTRIBUTION_"+a);o&&(ta.select("#HR_HACKATHON_CONTENT .recentReviewQuote").each(function(e){e.get("id")!="RECENT_REVIEW_QUOTE_"+a?e.hasClass("hidden")||e.addClass("hidden"):e.removeClass("hidden")}),ta.select("#HR_HACKATHON_CONTENT .recentReviewAttribution").each(function(e){e.get("id")!="RECENT_REVIEW_ATTRIBUTION_"+a?e.hasClass("hidden")||e.addClass("hidden"):e.removeClass("hidden")}))}}},toggleOffRecentReview:function(e,t,a){if(e&&t&&a){var i=ta.id("RECENT_REVIEW_QUOTE_"+a);if(i){var r=ta.id(e.target||e.srcElement);if(r&&r.id==t.id){var n=i.getElement(".speechBubble");n&&n.removeClass("highlight");var s=i.getElement(".recentReview_meta_content");s&&s.removeClass("highlight")}}}},onClickRecentReview:function(e,t,a){if(e&&t&&a){var i=ta.id("RECENT_REVIEW_QUOTE_"+a);if(i){var r=i.getElement(".quoteLnk");r&&r.click()}}},toggleReview:function(e,t,a,i){if(e&&t&&a){var r,n=ta.id("review_"+a),s=ta.id("UR"+a);if(s)r=s;else{if(!n)return;r=n}var o=r.getElement(".col2of2"),l=r.getElement(".innerBubble");o&&l&&(i?(o.addClass("highlight"),l.addClass("highlight")):(o.removeClass("highlight"),l.removeClass("highlight")))}},scrollToReview:function(e,t,a){var i=document.getElements(".persistent_tabs_header"),r=0;i&&0!=i.length&&(r=i.getHeight());var n=ta.id("review_"+a);if(n)window.scrollTo(0,n.getPosition().y-r);else{var s=ta.retrieve("location.helpful_review_highlight.full."+a);if(s){var o=ta.select("#REVIEWS .reviewSelector"),l=Elements.from(s);o.some(function(e){return!e.getParent("#FRIENDS_LOCATION_CONTENT_SUMMARY")&&(l.inject(e,"before"),n=ta.id("review_"+a),window.scrollTo(0,n.getPosition().y-r),!0)})}}},poiTypeIdMap:{2:"hotel",7:"eat",5:"attr",15:"al",18:"car"},selectPoiType:function(e,t){ta.select(".poiTypes li").removeClass("selected"),t.addClass("selected");var a=t.id.replace("type_","");ta.ReviewTracking.trackEvent("TYPE",a);var i=ta.find(".unattachedTypeahead");i&&i.toggleClass("hidden","type_rental"==t.id),ta.servlet.Reviews.changeSearchType(e,t)},selectPoiIcon:function(e,t){ta.select(".poiTypes li").addClass("collapsed"),t.removeClass("disabled"),t.getSiblings().addClass("disabled");var a=t.id.replace("type_","");ta.ReviewTracking.trackEvent("TYPE",a);var i=ta.find(".unattachedTypeahead");i&&i.toggleClass("hidden","type_rental"==t.id),ta.servlet.Reviews.changeSearchType(e,t)},createUnattachedTypeahead:function(e,t){t.onfocus=null;var a=ta.find('input[name="type"]').value,i=ta.servlet.Reviews.poiTypeIdMap[a],r=TypeAhead.utils.query(!1,i,null,null,!0,10,null,null,null,null,["no_closed"]),n={name:"UnattachedWarLander",minChars:"al"==i?2:3,maxResults:10,containerParent:ta.id("PAGE"),containerClass:"typeaheadResults",search:r,itemTemplate:TypeAhead.views.itemTemplate(),itemSelector:"li",width:348,positionRelative:!1,selectInputText:!1,selectOnBlur:!1,assumeOnBlur:!1,cacheResults:!1,autopopulateHighlighted:!1,forceProcessResults:!0,shouldSubmit:function(){return searchByType(t),s.hide(),!1},onSelect:function(e){var t=ta.find('input[name="type"]').value;ta.trackEventOnPage("Unattached_search","action",ta.servlet.Reviews.poiTypeIdMap[t]);var a=ta.id("UR_SELECT");a&&e&&(a.appendChild(new Element("input",{type:"hidden",name:"detail",value:e.value})),a.submit())},resolveSelename},onShow:function(e){e.container.addClass("visible")},ole")}};TypeAhead.views.configureTypeAheadForSegmentedResults(n);var s=new TypeAhead(t,n);t.store("typeahead",s)},initializeMap:function(e,t,a,i){function r(){var t=new ta.servlet.Reviews.Map;t.initialize(n,s,a,i),ta.store("reviews.map."+e,t)}var n=e,s=t;"complete"===document.readyState?r():google.maps.event.addDomListener(window,"load",r)},addDraggableMarker:function(e){var t=ta.retrieve("reviews.map."+e);t&&(t.addMarker(),t.userMarker.setDraggable(!0))},makeMarkerDraggable:function(e){var t=ta.retrieve("reviews.map."+e);t&&t.userMarker&&t.userMarker.setDraggable(!0)},restoreDefaultMarker:function(e){var t=ta.retrieve("reviews.map."+e);t&&(t.resetMap(),t.userMarker&&t.userMarker.setDraggable(!1),"true"!=ta.retrieve("reviews.pinRedist")&&t.userMarker.setVisible(!1))},mapPinConfirmationOverlay:function(e,t){var a=ta.retrieve("map_pin_confirmation_overlay");a||(a=new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_NEVER,showArrow:!0,arrowClass:"arrow arrowLeft",showCloseButton:!0,style:"tooltip ttGreen small",mirrorIfRtl:!0,offsetRight:3,offsetTop:77},t),ta.store("map_pin_confirmation_overlay",a)),a.show()},trackMapPinConfirmationEvent:function(e,t){var a=ta.retrieve("reviews.map."+e);a&&ta.trackEventOnPage("WAR_Optional",a.trackingPrefix+t)},pinVoteNo:function(e,t,a){ta.servlet.Reviews.trackMapPinConfirmationEvent(a,"no"),ta.id("PIN_YES").removeClass("selected"),ta.id("PIN_NOTSURE").removeClass("selected"),ta.id("PIN_NO").addClass("selected"),ta.id("pinVote").value="no","true"==ta.retrieve("reviews.pinRedist")?(ta.servlet.Reviews.makeMarkerDraggable(a),ta.servlet.Reviews.mapPinConfirmationOverlay(e,ta.id("MAP_CONTAINER"))):ta.servlet.Reviews.restoreDefaultMarker(a)},pinVoteNotSure:function(e,t,a){ta.servlet.Reviews.trackMapPinConfirmationEvent(a,"unsure"),ta.id("PIN_YES").removeClass("selected"),ta.id("PIN_NO").removeClass("selected"),ta.id("PIN_NOTSURE").addClass("selected"),ta.id("pinVote").value="unsure",ta.servlet.Reviews.restoreDefaultMarker(a)},pinVoteYes:function(e,t,a){ta.servlet.Reviews.trackMapPinConfirmationEvent(a,"yes"),ta.id("PIN_NO").removeClass("selected"),ta.id("PIN_NOTSURE").removeClass("selected"),ta.id("PIN_YES").addClass("selected"),ta.id("pinVote").value="yes","true"!=ta.retrieve("reviews.pinRedist")?(ta.servlet.Reviews.addDraggableMarker(a),ta.servlet.Reviews.makeMarkerDraggable(a),ta.servlet.Reviews.mapPinConfirmationOverlay(e,ta.id("MAP_CONTAINER"))):ta.servlet.Reviews.restoreDefaultMarker(a)},showReviewOverlay:function(){ta.find("#TOP_REVIEW_OVERLAY_HEADING_TITLE").innerHTML=ta.find(".altHeadInline a").innerHTML;var e=ta.find("#OVERLAY_REVIEW");if(e){var t=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:!0,style:"reviewMsgOverlay"}).loadRemoteSuccess(e.innerHTML);ta.store("userreview.overlayReview",t),ta.trackEventOnPage("UserReviewSearch","overlay_open","")}},initUserReviewOnTopTracking:function(){var e=ta.find(".writeAnotherReviewCta");if(null!=e){ta.util.element.doIfElementIsVisible(e,ta.trackEventOnPage,["User_review_top","inView"]);va0,t(t)},r=function(){ta.trackEventOnPage("User_review_top","Impression",""),e.removeEvent("mouseenter",a),e.removeEvent("mouseleave",i)};e.addEvent("mouseenter",a),e.addEvent("mouseleave",i)}},initOwnersFavoriteReviewTracking:function(e){var t=function(){new Request({url:"/BLImpRecord",trackEvent:{module:servletName,action:"FAVORITE_VIEW",context:modelLocId},data:{blImps:JSON.stringify([{locationId:modelLocId,servlet:servletName,tab:"Reviews",display:"FavoriteReview",details:"REVIEW",position:1}])}}).send()},a=ta.id("review_"+e);a&&(ta.util.element.doIfElementIsVisible(a,t),ta.select(a,".helpful_text").addEvent("click",function(){ta.trackEventOnPage(servletName,"FAVORITE_HELPFUL",modelLocId)}),ta.select(a,".reportTxt").addEvent("click",function(){ta.trackEventOnPage(servletName,"FAVORITE_REPORT",modelLocId)}),ta.select(a,"#rn"+e).addEvent("click",function(){ta.setEvtCookie(servletName,"FAVORITE_REVIEW_TITLE",modelLocId,0,this.href)}),ta.select(a,".moreLink").addEvent("click",function(){ta.trackEventOnPage(servletName,"FAVORITE_MORE",modelLocId)}),ta.select(a,".ownerFavHeader").addEvent("mouseover",function(){ta.trackEventOnPage(servletName,"FAVORITE_TOOLTIP",modelLocId),ta.id(this).removeEvents("mouseover")}))},iapFlyout:function(e,a,i){t.open(e,a,{voteContentType:"USERREVIEW",contentId:i})},iapOwnerFlyout:function(e,a,i){i.owner=!0,t.open(e,a,i)},showSendMet,i)},openTranslation:function(e,t){ta.util.cookie.setPIDCookie(16009),g?(g.sourceElement=e,g.updateContent(t)):(g=new r(e,[n(e,"center",""),s.center([0,0]),d,o,l,v(),c(t,{resources:[window.conceptCss]})]),ta.store("translationOverlay",g),g.container.style.maxWidth="90%",g.container.style.width="800px"),g.show()},showRoomTips:function(e){var t=new r(null,[n(null,"center","small no_padding"),s.center(),d,o,l,c("/AccommodationTips?d="+window.modelLocId+(e?"&filterLang="+e:""))]);t.on("contentLoaded",function(){ta.find("#emptyTips",t.contentElement)&&setTimeout(t.hide.bind(t),1)}),t.show()}},ta.servlet.Reviews.Map=function(){this.mapId=null,this.isInteractive=!1,this.isZoomInitialized=!1,this.googleMap=null,this.streetField=null,this.localStreetField=null,this.street1_local=null,this.street1=null,this.city=null,this.state=null,this.country=null,this.defaultLat=null,this.defaultLng=null,this.hasDefault=!1,this.redistributable=!1,this.userMarker=null,this.userMarkerMoved=!1,this.userMarkerZoom=-1,this.resetPinButton=null,this.trackingPrefix=null,this.trackingInteractivePrefix=null,this.updateTimeout=null},ta.servlet.Reviews.Map.prototype.initialize=function(e,t,a,i){this.mapId=e,this.isInteractive=t,this.streetField=ta.id(a),this.localStreetField=ta.id(i),this.populateMapInfoFromServlet(),ta.trackEventOnPage("WAR_Optional",this.trackingPrefix+"load");var r={center:this.hasDefault?{lat:this.defaultLat,lng:this.defaultLng}:{lat:13.081,lng:80.274},zoom:this.hasDefault?this.streetLevelZoom+1:2,streetViewControl:t,draggable:t,scrollwheel:t,disableDefaultUI:!t,disableDoubleClickZoom:!t};this.googleMap=new google.maps.Map(document.getElementById(e),r);var n,s;t?(n=new google.maps.MarkerImage(CDNHOST+"/img2/maps/icons/pinSearchCustom.png"),s=new google.maps.MarkerImage(CDNHOST+"/img2/maps/icons/pinSearchCustomOver.png")):(n=new google.maps.MarkerImage(CDNHOST+"/img2/maps/icons/pin_v2_CurrentCenter.png"),s=new google.maps.MarkerImage(CDNHOST+"/img2/maps/icons/pin_v2_CurrentCenterOver.png")),this.userMarker=new google.maps.Marker({visible:!1,icon:n,zIndex:10,optimized:!1,draggable:!1,title:t?ta.retrieve("reviews.userMarkerTooltip"):""}),this.userMarker.setMap(this.googleMap),this.userMarker.setVisible(this.redistributable),this.userMarker.setPosition(this.googleMap.getCenter()),this.removeReportAnErrorButton(this.googleMap),t&&(this.addListeners(n,s),this.addMapControls()),this.clearMapWarnings();var o=this;google.maps.event.addListenerOnce(this.googleMap,"tilesloaded",function(){o.setupGeoCodes()})},ta.servlet.Reviews.Map.prototype.addListeners=function(e,t){Element.NativeEvents.input=2;var a=this.userMarker,i=this;[this.streetField,this.localStreetField].forEach(function(e){if(e){var t="mapChangeEvent."+i.mapId+"."+e.id,a=function(e){i.updateGeoCodes()},r=ta.retrieve(t);["change","input"].fot,a)}),ta.store(t,a)}}),google.maps.event.addListener(a,"mouseover",function(){a.setIcon(t)}),google.maps.event.addListener(a,"mousn(e)}),google.maps.event.addListener(this.googleMap,"bounds_changed",function(){i.isZoomInitialized&&ta.trackEventOnPage("WAR_Optional",i.trackingPrefix+"map_zoom"),i.userMarker.getVisible()&&i.googleMap.getBounds().contains(i.userMarker.getPosition())&&(i.userMarkerZoom=Math.max(i.googleMap.getZoom(),i.userMarkerZoom)),i.validateMap()}),google.maps.event.addListener(a,"dragend",function(){
ta.trackEventOnPage("WAR_Optional",i.trackingInteractivePrefix+"pin_move"),i.resetTimeout(),i.userMarkerMoved=!0,i.userMarkerZoom=i.googleMap.getZoom(),i.validateMap(),ta.id("newLat").value=a.getPosition().lat(),ta.id("newLng").value=a.getPosition().lng()})},ta.servlet.Reviews.Map.prototype.removeReportAnErrorButton=function(e){var t={name:"Dummy Style"},a=[{featureType:"road",elementType:"all",stylers:[{visibility:"on"}]}],i=new google.maps.StyledMapType(a,t);e.mapTypes.set("Dummy Style",i),e.setMapTypeId("Dummy Style")},ta.servlet.Reviews.Map.prototype.populateMapInfoFromServlet=function(){this.streetLevelZoom=parseInt(ta.retrieve("reviews.street_level_zoom"))||15,this.redistributable="true"==ta.retrieve("reviews.pinRedist"),this.defaultLat=parseFloat(ta.retrieve("reviews.pinLat")),this.defaultLng=parseFloat(ta.retrieve("reviews.pinLng")),this.hasDefault=!(!this.defaultLat||!this.defaultLng),this.city=ta.retrieve("reviews.address_city"),this.state=ta.retrieve("reviews.address_state"),this.country=ta.retrieve("reviews.address_country"),this.street1=ta.retrieve("reviews.address_street1"),this.street1_local=ta.retrieve("reviews.address_street1_local"),this.redistributable?(this.trackingPrefix="map_confirm_",this.trackingInteractivePrefix="map_confirm_no_"):this.hasDefault?(this.trackingPrefix="map_addpin_noregc_",this.trackingInteractivePrefix="map_addpin_noregc_yes_"):(this.trackingPrefix="map_addpin_nogc_",this.trackingInteractivePrefix="map_addpin_nogc_yes_")},ta.servlet.Reviews.Map.prototype.handleNewGeoCodes=function(e,t){var a=null,i=null,r=!1;if(t==google.maps.GeocoderStatus.OK){if(e&&e[0]&&e[0].geometry&&e[0].geometry.location){r=!0;var n=e[0].geometry.location;this.googleMap.fitBounds(e[0].geometry.viewport),this.userMarker.setPosition(this.googleMap.getCenter()),(this.street1||this.street1_local)&&(a=n.lat(),i=n.lng(),this.googleMap.setZoom(this.streetLevelZoom+1))}}else t==google.maps.GeocoderStatus.ZERO_RESULTS&&(r=!0);r&&(this.defaultLat=a,this.defaultLng=i,this.hasDefault=!(!a||!i),this.userMarker.setVisible(this.hasDefault),this.userMarkerMoved=!1),this.validateMap()},ta.servlet.Reviews.Map.prototype.resetTiull)},ta.servlet.Reviews.Map.prototype.updateGeoCodes=function(e){this.updateTimeout&&clearTimeout(this.updateTimeout);var t=this,a=function(){t.updateTimeout=null,t.street1=t.streetField?t.streetField.value:null,t.street1_local=t.localStreetField?t.localStreetField.value:null;var e=(t.googleMap,[]);e.push(t.street1_local||t.street1),e.push(t.city),e.push(t.state),e.push(t.country);var a=e.join(", "),i=new google.maps.Geocoder;i.geocode({"address":a},function(e,a){t.handleNewGeoCodes(e,a)})};e?a():this.updateTimeout=setTimeout(a,500)},ta.servlet.Reviews.Map.prototype.setupGeoCodes=function(){if(this.hasDefault)this.userMarker.setPosition(new google.maps.LatLng(this.defaultLat,this.defaultLng)),this.userMarker.setVisible(this.redistributable),this.googleMap.setCenter(this.userMarker.getPosition()),this.googleMap.setZoom(this.streetLevelZoom+1),this.validateMap(),this.isZoomInitialized=!0;else{this.updateGeoCodes(!0);var e=this;google.maps.event.addListenerOnce(this.googleMap,"tileslod=!0})}},ta.servlet.Reviews.Map.prototype.resetMap=function(){if(this.resetTimeout(),this.hasDefault){var e=new google.maps.LatLng(this.defaultLat,this.defaultLng);this.userMarker.setPosition(e),this.googleMap.getBounds().contains(e)||this.googleMap.setCenter(e),ta.id("newLat").value="",ta.id("newLng").value=""}else this.userMarker.setVisible(!1);this.userMarkerMoved=!1,this.validateMap()},ta.servlet.Reviews.Map.prototype.addMarker=function(){this.resetTimeout(),this.userMarker.setPosition(this.googleMap.getCenter()),this.userMarkerZoom=this.googleMap.getZoom(),this.userMarker.setVisible(!0),this.validateMap()},ta.servlet.Reviews.Map.prototype.addMapControls=function(){var e=this,t=document.createElement("div"),a=ta.retrieve("reviews.resetPinText"),i=ta.retrieve("reviews.resetPinTooltip"),r=function(){return function(){ta.trackEventOnPage("WAR_Optional",e.trackingInteractivePrefix+"pin_reset"),e.resetMap()}};e.resetPinButton=ta.servlet.Reviews.Map.prototype.createButton("resetPinButton",a,i,r()),t.appendChild(e.resetPinButton),t.index=0,this.googleMap.controls[google.maps.ControlPosition.RIGHT_TOP].push(t)},ta.servlet.Reviews.Map.prototype.createButton=function(e,t,a,i){var r=document.createElement("div");r.id=e,r.className="mapButton";var n=document.createElement("div");n.className="mapButtonBorder",n.title=a,r.appendChild(n);var s=document.createElement("div");return s.className="mapButtonText",s.innerHTML=t,n.appendChild(s),null!=i&&google.maps.event.addDomListener(n,"click",i),r},ta.servlet.Reviews.Map.prototype.addMapWarning=function(e){var t=ta.id("warningMessages"),a=ta.id("warningMessageContainer");a&&ta.id(a).show(),t&&(t.innerHTML.length>0&&(t.innerHTML+="<br />"),t.innerHTML+=e)},ta.servlet.Reviews.Map.prototype.clearMapWarnings=function(){var e=ta.id("warningMessages"),t=ta.id("warningMessageContainer");t&&ta.id(t).hide(),e&&(e.innerHTML="")},ta.servlet.Reviews.Map.prototype.validateMap=function(){this.isInteractive&&(this.clearMapWarnings(),this.checkZoom()||this.addMapWarning(ta.retrieve("reviews.zoomInWarningMsg")),this.userMarkerMoved?ta.id(this.resetPinButton).show():ta.id(this.resetPinButton).hide())},ta.servlet.Reviews.Map.prototype.checkZoom=function(){return this.userMarkerZoom>this.streetLevelZoom||!this.userMarkerMoved};var w={};window.addEvent("load",function(){setTie)})},50)})});
ta.servlet.Location={distanceUnitsCookieName:"TAdistanceCookie",showMi:function(){$$("#NEARBY .milesOption").each(function(e,t){e.checked=!0}),$$("#NEARBY .milesLabel").each(function(e,t){$(e).addClass("selected")}),$$("#NEARBY .kmLabel").each(function(e,t){$(e).removeClass("selected")}),$$("#NEARBY .distanceMiles").show(),$$("#NEARBY .distanceKm").hide(),Cookie.write(this.distanceUnitsCookieName,0)},showKm:function(){$$("#NEARBY .kmOption")d=!0}),$$("#NEARBY .milesLabel").each(function(e,t){$(e).removeClass("selected")}),$$("#NEARBY .kmLabel")ed")}),$$("#NEARBY .distanceMiles").hide(),$$("#NEARBY .distanceKm").show(),Cookie.write(this.distanceUnitsCookieName,1)},reportClosedVote:function(e,t,o){o&&o>0&&(o=encodeURIComponent(o),new Request({method:"get",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&action=geocodeclosed&id="+o,onSuccess:function(e){ta.overlays.showInLightbox(e,{style:"mg s4",delayedPosition:!0})}}).send())},reportGeoCode:function(e,t,o,n,i){o&&o>0&&(o=encodeURIComponent(o),new Request({method:"get",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&action=geocodebad&id="+o,onSuccess:function(e){ta.overlays.showInLightbox(e,{style:"mg s4",delayedPosition:!0})}}).send()),ta.trackEventOnPage&&n&&i&&ta.trackEventOnPage(n,i,o)},reportCorrectAddr:function(e,t,o,n,i,s,c,a){if(o&&o>0){o=encodeURIComponent(o);var d=document.getElementById("street").value,l=document.getElementById("city").value,r=document.getElementById("state").value,u=document.getElementById("zip").value,m=document.getElementById("country").value,h=document.getElementById("phone").value,g=document.getElementById("website").value;n==d&&i==l&&s==u&&c==h&&a==g?new Request({method:"post",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&action=geocodecorrect&updated=false&id="+o,onSuccess:function(e){ta.overlays.showInLightbox(e,{style:"mg s4",delayedPosition:!0})}}).send():(d=encodeURIComponent(d),l=encodeURIComponent(l),r=encodeURIComponent(r),u=encodeURIComponent(u),m=encodeURIComponent(m),h=encodeURIComponent(h),g=encodeURIComponent(g),new Request({method:"post",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&action=geocodecorrect&updated=true&id="+o+"&street="+d+"&city="+l+"&state="+r+"&zip="+u+"&country="+m+"&phoneNumber="+h+"&webSite="+g,onSuccess:function(e){ta.overlays.showInLightbox(e,{style:"mg s4",delayedPosition:!0})}}).send())}},reportGeoCodeDialog:function(e,t,o,n,i){"undefined"==typeof incorrectLocation||this.incorrectLocationLink||(this.incorrectLocationLink=Asset.css(incorrectLocation)),o&&o>0&&(o=encodeURIComponent(o),new Request({method:"get",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&id="+o+"&action=geocodedialog",onSuccess:function(e){ta.overlays.showInLightbox(e,{style:"mg s4",delayedPosition:!0})},evalScripts:!0}).send()),ta.trackEventOnPage&&n&&i&&ta.trackEventOnPage(n,i,o)},updateListingInformation:function(e,t,o,n,i,s,c,a){if(o&&o>0)if(a)window.location.href=a;else{var d={style:"glnew_lightbox",closeButtonClass:"innerClose",delayedPosition:!0,attachCloseEvent:!1,permanent:!0,showCloseButton:!0};new Request({url:"/GetListedUpdate"+s+"?id="+o,onSuccess:function(e){var t=ta.overlays.showInLightbox(e,Object.merge(d,{title:c}));t.closeBtn.addEvent("click",function(){ta.GetListedNew.closeOverlay()})},evalScripts:!0}).send()}ta.trackEventOnPage&&n&&i&&ta.trackEventOnPage(n,i,o)},reportClosedVoteNew:function(e,t,o,n,i,s){o&&o>0&&new Request({method:"post",url:"/"+s+"?action=closedareyousure&id="+o,onSuccess:function(e){ta.overlays.showInLightbox(e,{style:"glnew_update_areyousure mg s4",delayedPosition:!0,isChild:!0,showCloseButton:!1})},evalScripts:!0}).send()},recordOpenVote:function(e,t,o,n,i,s){o&&o>0&&new Request({method:"post",url:"/"+s+"?action=voteopen&id="+o,onSuccess:function(e){ta.overlays.showInLightbox(e,{style:"mg s4",delayedPosition:!0,showCloseButton:!1})},evalScripts:!0}).send()},requestListingWithLightbox:function(e,t,o,n,i,s,c){c=c||{};var a={},d=document.getElementById("query");d&&d.value&&(a.query=d.value);var l={style:"glnew_lightbox",closeButtonClass:"innerClose",delayedPosition:!0,attachCloseEvent:!1,permanent:!0,showCloseButton:!0},r={showthanks:i,fromWARToDo:s,placetype:o,reviewID:c.reviewID},u="/GetListedLightbox?"+Object.toQueryString(r);new Request({method:"post",url:u,data:a,onSuccess:function(e){var t=ta.overlays.showInLightbox(e,Object.merge(l,{title:n}));t.closeBtn.addEvent("click",function(){ta.GetListedNew.closeOverlay()}),c.onHide&&t.addEvent("m"})}),t.container.store("onhide",c.onHide),ta.select(".overlayBG").setStyle("height",Math.max(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight,document.body.scrollHeight))},evalScripts:!0}).send()},showReportForm:function(e,t,o){o&&o>0&&(o=encodeURIComponent(o),new Request({method:"get",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&id="+o+"&action=geocodeform",onSuccess:function(e){ta.overlays.showInLightbox(e,{style:"mg s4",delayedPosition:!0})},evalScripts:!0}).send())},setTrackPID:function(e,t,o){10022==o?ta.util.cookie.setPIDCookie(17138):10021==o&&ta.util.cookie.setPIDCookie(17137)},closeLightbox:function(){var e=ta.retrieve("overlays.current");e&&e.hide()},activateReportButton:function(){var e=ta.id("REPORT_LOCATION").getElements(".button")[0];e.removeClass("inactive"),e.removeProperty("disabled")}};
!function(){function t(t,n){function r(e,t){if(e&&(e.removeClass&&e.removeClass(t),e.childNodes))for(var o=e.childNodes,a=0;a<o.length;a++)r(o[a],t)}try{if(!o)return;a||(a=ta.id("tabRatings"));var i=document.getElementById("CONTAINER01");i||ta.util.error.record(null,"hotel tab loading - no container"),a&&!o[a.id]&&(o[a.id]=i.innerHTML),r(a,"current");var s=ta.id(n);if(!s||!s.addClass)return void ta.util.error.record(null,"hotel tab loading - trouble wrapping elmt");if(a=s.addClass("current"),o[n]){try{i.innerHTML=o[n],window.behavior&&window.behavior.apply(ta.id(i))}catch(e){ta.util.error.record(e,"showTab - existing")}return}var l=!1;try{if(l=location.pathname,l&&"string"==typeof l&&l.length>0){"/"==l.charAt(0)&&(l=l.substring(1));var c=l.indexOf("-");c>=0&&(l=l.substring(0,c))}}catch(e){ta.util.error.record(e,"hotel tab loading - servlet access",null,{"tabName":n})}i.innerHTML="";var d=(new Asset.image(CDNHOST+"/img2/generic/site/loop.gif",{"class":"anim_loop"}).inject(i,"top"),"http://"+document.domain);new Request({url:d+"/LocationTab",evalScripts:!0,data:{d:t,tab:n.replace(/tab/,"").toLowerCase(),from:l},onSuccess:function(e){try{var t=document.getElementById("CONTAINER01");t.innerHTML=e,window.behavior&&window.behavior.apply(ta.id(t)),o[this.options.data.tab]=e}catch(e){ta.util.error.record(e,"hotel tab loading - content load")}},onFailure:function(o){ta.util.error.record(e,"hotel tab loading - no content",null,{"status":o.status,"tabName":n,"detId":t,"from":l})}}).send()}catch(e){ta.util.error.record(e,"hotel tab loading",null,{"tabName":n})}}ta.servlet.Hotel={detailsTabClicked:function(e,o){t(locationId,"tabDetails")},photosTabClicked:function(e,o){t(locationId,"tabPhotos")},mapTabClicked:function(e,o){t(locationId,"tabMap")},ratingsTabClgs")},setPid:function(e){ta.util.cookie.setPIDCookie(e)},isHotelsServlet:function(e){if(ta.has("is_hotels_serv"))return ta.retrieve("is_hotels_serv");var t=ta.id("PAGE");if(t&&"undefined"!=typeof t){if(t.hasClass("hotels_like"))return ta.store("is_hotels_serv",!0),!0;if(t.hasClass("non_hotels_like"))return ta.store("is_hotels_serv",!1),!1}return"undefined"!=typeof e&&e},selectLanguage:function(e,t,o){var a=ta.id("LANG_FORM"),n=ta.id("filterLang");a&&n&&(ta.setEvtCookie("Reviews_Controls","language_sort","",0,window.location.href),n.value=o,a.submit())},selectSeason:function(e,t,o,a,n,r){function i(){var e=ta.select(".seasonList .spinner img");e.forEach(function(e){e.remove()});var o=ta.find(".spinner",t);o&&new Asset.image(CDNHOST+"/img2/spinner.gif").inject(o)}var s=ta.find("#MONTH_FORM .seasonLabel");if(ta.util.localstorage&&ta.util.localstorage.canUseLocalStore()){var l=new Date;l.setHours(l.getHours()+12),0!=n?(localStorage.setItem("season_memory_expiry_time",l),localStorage.setItem("season_memory_loc_id",o),localStorage.setItem("season_memory_geo_id",a)):(localStorage.removeItem("season_memory_expiry_time"),localStorage.removeItem("season_memory_popup_shown"),localStorage.removeItem("season_memory_loc_id"),localStorage.removeItem("season_memory_new_popup_shown"),localStorage.removeItem("season_memory_geo_id"))}s&&r&&s.set("text",r);var c=ta.id("MONTH_FORM"),d=ta.id("filterSeasons");c&&d&&(d.value=n,ta.trackEventOnPage("Reviews_Controls","season","",n),i(),c.submit())}};var o=null,a=!1;window.addEvent("load",function(){ta.id("CONTAINER01")&&(o={},a=$$("#TABS01 .current"),a&&(a=a[0]))})}();
define("mobile/lite/ajax-request",["utils/json-to-url","vanillajs"],function(t){function e(t){var e=document.createElement("a");return e.href=t,e.protocol!==window.location.protocol||e.host!==window.location.hostname}return function(s,o){"object"==typeof s&&(o=s,s=o.url),o=o||{};var n=o.method||o.type||"GET",r="string"==typeof o.data?o.data:t(o.data);return new Promise(function(t,a){var i=new XMLHttpRequest;i.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&(200===this.status?(o.success&&o.success(this.responseText,this.status,i),t(this.responseText)):(o.error&&o.error(i,this.status,this.statusText),a(this.responseText)),o.complete&&o.complete(i,this.statusText))},"get"==n.toLowerCase()&&"string"==typeof r&&r.length>0&&(s+=("?"==r[0]?"":"?")+r,r=null),i.open(n,s,!o.synchronous),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e(s)||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(r)})}});
define("utils/cookieutils",["vanillajs","mobile/lite/ajax-request"],function(t,e){"use strict";!=$1")},i=function(){var t=window.location.host.match(/\.tripadvisor\..*/);return null!=t?t=t[0]:null},a=function(t,e,n){if(o(n.doNotEscape)&&n.doNotEscape||(e=encodeURIComponent(e)),e+=n.domain?"; domain="+n.domain:"; domain="+i(),n.path&&(e+="; path="+n.path),n.duration){var a=new Date;a.setTime(a.getTime()+1e3*n.duration),e+="; expires="+a.toGMTString()}n.secure&&(e+="; secure");var r="%1%";o(n.ignoreVersion)&&n.ignoreVersion&&(r=""),document.cookie=t+"="+r+e};return{addPidToCookie:function(t){o(t)&&0!==t.length&&a("NPID",t,{path:"/",duration:5,ignoreVersion:!0})},roybatty:function(){var t,o=i(),n=window.taSecureToken;if(window.taEarlyRoyBattyStatus)window.taEarlyRoyBattyStatus>1&&ta&&ta.trackEventOnPage&&ta.trackEventOnPage("early_roy_batty","confirm","",0,!0);else if(t=this.getCookie("roybatty")){var a=t.split(",");if(a&&2==a.length){var r=parseInt(a[1],10);document.setCookie("roybatty",n+","+r,{domain:o,ignoreVersion:!0,path:"/"})}}else document.setCookie("roybatty",n+",1",{domain:o,ignoreVersion:!0,path:"/"}),e({method:"POST",url:"/CookiePingback"})},getCookie:function(t){var e=document.cookie.match("(?:^|;)\\s*"+n(t)+"=([^;]*)");return e?(e=e[1],0===e.indexOf("%1%")&&(e=e.substring(3)),decodeURIComponent(e)):null},setCookieInSeconds:a}});
ta.widgets.calendar={multiDateFormatter:function(e,t,a,r,n){var i={cname:"",contents:e.getDate()},s="";return a?e.getTime()==this.today.getTime()?s=this.newInDate&&e.getTime()==this.newInDate.getTime()?"today inDate":t?"today":"today disabled":this.newInDate&&e.getTime()==this.newInDate.getTime()&&(s=n.inDateClass):s="invalid",i.cname=s,i},calendarSingleSelect:function(e,t,a,r,n){try{ta.id(n).getParent(".overlay").overlay.calendar.singleDaySelect(e,ta.util.date.create(t,a,r),n)}catch(e){ta.util.error.record(e,"calendarSingleSelect issue")}},calendarMCSelect:function(e,t,a,r,n){try{ta.id(n).getParent(".overlay").overlay.calendar.multiCitySelect(e,ta.util.date.create(t,a,r),n)}catch(e){ta.util.error.record(e,"calendarMCSelect issue")}},dateFromString:function(e,t){e=e.replace(/\n/g,"");var a=t?t:ta.widgets.calendar.getDatePickerFormat("classic"),r=a.replace(/\w/g,"")[0];a=a.replace(/ /g,"").split(r);var n=e.replace(/ /g,"").split(r);if(a.contains("MM")&&a.contains("dd")&&a.contains("yyyy")){var i=a.indexOf("MM"),s=a.indexOf("dd"),d=a.indexOf("yyyy"),l=new Date(n[d],n[i]-1,n[s]);if(ta.retrieve("thai_buddhist_era_year")&&l.setFullYear(l.getFullYear()-ta.util.date.THAI_BUDDHIST_YEAR_OFFSET),"Invalid Date"!=l)return l}},lastDateBefore:function(e,t){if(e.multiCityFlight&&t>1){for(var a,r=t;(!a||""===a.trim())&&r>1;)--r,a=ta.id("date_picker_in_"+r).innerHTML;if(a&&""!==a.trim())return ta.widgets.calendar.dateFromString(a)}return this.getPageInDate()},calendarMultiSelect:function(e,t,a,r,n){try{ta.id(n).getParent(".overlay").overlay.calendar.multiSelect(e,ta.util.date.create(t,a,r),n)}catch(e){ta.util.error.record(e,"calendarMultiSelect issue")}},calendarMouseOver:function(e,t,a,r,n){ta.id(n).getParent(".overlay").overlay.calendar.dayOver(e,ta.util.date.create(t,a,r),n)},calendarPrev:function(e,t){var a=ta.id(t);a&&a.hasClass("sprite-date_picker-btnLeftInactive")||ta.util.i18n.isRtl()&&a&&a.hasClass("sprite-date_picker-btnRightInactive")||a.getParent(".overlay").overlay.calendar.prev()},calendarNext:function(e,t){var a=ta.id(t);a&&a.hasClass("sprite-date_picker-btnRightInactive")||ta.util.i18n.isRtl()&&a&&a.hasClass("sprite-date_picker-btnLeftInactive")||a.getParent(".overlay").overlay.calendar.next()},adultsOver:function(e,t){var a=document.getElements(".date_picker_adults_option");a&&Array.eed")}),ta.id(t).addClass("adults_selected")},removeMetaCalendarFromSync:function(e){if(ta.has("metaDatePickerEnabled")){var t="avail.data."+e+"._met",a=ta.retrieve("avail.data.objects");a&&a.erase(t),ta.store("avail.data.objects",a),ta.remove(t)}},getCalendarObjectKey:function(e,t,a){var r="avail.data";return a&&(r=r+"."+a),r=r+"."+e,t&&(r=r+"."+t),r},trackCalendarObject:function(e){var t=e.calendar?e.calendar.options.pickerOption:null,a=ta.widgets.calendar.getCalendarObjectKey(e.locId,e.ext,t);ta.store(a,e);var r=ta.retrieve("avail.data.objects");r||(r=[]),r.include(a),ta.store("avail.data.objects",r)},trackCalendarFlyout:function(e,t,a){var r="date.picker.calendarflyout",n=ta.retrieve(r);n||(n=[]);var i={};i.elmt=e,i.overlay=t,i.overlaySrc=a,n.push(i),ta.store(r,n),ta.remove("date.picker.calendarflyout.allCleared")},clearCalendarFlyouts:function(){var e="date.picker.calendarflyout",t=ta.retrieve(e);t&&(t.each(function(e){var t=e.elmt,a=e.overlay,r=e.overlaySrc;t&&a&&r&&(t.removeEvent("mouseenter",a.showWithDelay),t.removeEvent("mouseleave",a.hideWithDelay),t.removeEvent("mouseenter",a.show),t.removeEvent("mouseleave",a.hide),t.removeEvent("click",a._pin),t.adopt(r))}),ta.store("date.picker.calendarflyout.allCleared",!0))},getDateB1),t},getDate1),t},setPageInDate:function(e,t){e&&e.getDate&&ta.store("date.picker.pageInDate",e),ta.has("date.picker.pageOutDate")&&ta.store("meta.page_dates",!0),!t&&ta.page&&ta.page.setDates&&(ta.page.setDates("CHECKIN",[e]),ta.page.emit("dateSelected",null,"CHECKIN",[e]))},setPageOutDate:function(e,t){e&&e.getDate&&ta.store("date.picker.pageOutDate",e),ta.has("date.picker.pageInDate")&&ta.store("meta.page_dates",!0),ta.widgets.calendar.updateCalendarPropertiesOnDateSet(),!t&&ta.page&&ta.page.setDates&&(ta.page.setDates("CHECKOUT",[e]),ta.page.emit("dateSelected",null,"CHECKOUT",[e]))},setTimeoutPageDates:function(){var e=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDateTimeout"));e&&ta.widgets.calendar.setPageInDate(e);var t=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDateTimeout"));t&&ta.widgets.calendar.setPageOutDate(t)},clearPageDates:function(e){ta.store("data.picker.cachedDateCleared",!0),ta.remove("date.picker.pageInDate"),ta.remove("date.picker.pageOutDate"),ta.remove("multiDP.inDate"),ta.remove("multiDP.outDate"),ta.remove("meta.page_dates"),ta.remove("meta.session_dates"),ta.remove("multiDP.priorDates"),(ta.isMetaHotelsRequest()||ta.has("meta.mini_meta_on_accommodations"))&&ta.store("dates.datesCleared",!0),!e&&ta.page&&ta.page.clearDates&&(ta.page.clearDates("STAYDATES"),ta.page.emit("dateSelected",null,"STAYDATES",[null,null]))},clearPageInDate:function(e){ta.remove("date.picker.pageInDate"),ta.remove("multiDP.inDate"),ta.remove("meta.page_dates"),!e&&ta.page&&ta.page.setDates&&(ta.page.setDates("CHECKIN",[null]),ta.page.emit("dateSelected",null,"CHECKIN",[null]))},clearPageOutDate:function(e){ta.remove("date.picker.pageOutDate"),ta.remove("multiDP.outDate"),ta.remove("meta.page_dates"),!e&&ta.page&&ta.page.setDates&&(ta.page.setDates("CHECKOUT",[null]),ta.page.emit("dateSelected",null,"CHECKOUT",[null]))},updateCalendarPropertiesOnDateSet:function(){var e=ta.retrieve("avail.data.objects");e&&Array.ese()})},setPageAdults",e)},getPageInDate:function(){var e=!1;return ta.has("date.picker.pageInDate")&&(e=ta.retrieve("date.picker.pageInDate")),!e&&ta.has("multiDP.inDate")&&(e=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDate")),e&&ta.widgets.calendar.setPageInDate(e)),!!e&&new Date(e.getTime())},getPageOutDate:function(){var e=!1;if(ta.has("date.picker.pageOutDate")){if(e=ta.retrieve("date.picker.pageOutDate"),!ta.widgets.calendar.isValidStayLength(e))return ta.widgets.calendar.clearPageOutDate(),!1;if(e)return new Date(e.getTime())}if(!e&&ta.has("multiDP.outDate")){if(e=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDate")),e&&ta.widgets.calendar.setPageOutDate(e),!ta.widgets.calendar.isValidStayLength(e))return ta.widgets.calendar.clearPageDates(),!1;if(e)return new Date(e.getTime())}return!1},haveDatesChanged:function(){var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate(),a=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDate")),r=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDate"));return!a||e.getTime()!=a.getTime()||!r||t.getTime()!=r.getTime()},isValidStayLength:function(e){var t=ta.widgets.calendar.getPageInDate();if(!t||!e)return!0;var a=0,r=0;return ta.retrieve("allowLongTrips")?(a=e-new Date,r=ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT):(a=e-t,r=ta.retrieve("isVacationRentals")?ta.util.date.MAX_VR_DURATION_DAYS:ta.util.date.MAX_STAY_DURATION_DAYS),a=Math.round(a/1e3/60/60/24),!(a>r)},getPageAdultsCount:function(){return ta.has("date.picker.adultsCount")?ta.retrieve("date.picker.adultsCount"):ta.has("multiDP.adultsCount")?(ta.store("date.picker.adultsCount",ta.retrieve("multiDP.adultsCount")),ta.retrieve("multiDP.adultsCount")):"2"},getGuestsRoomsPickerData:function(){var e,t,a,r=ta.retrieve("guests.rooms.object");if(!r)try{var n=require("utils/cookieutils").getCookie("TATravelInfo"),i=ta.widgets.calendar.getGuestsRoomsValue(n,"A");i&&""!==i&&(e=parseInt(i,10));var s=ta.widgets.calendar.getGuestsRoomsValue(n,"RS");s&&""!==s&&(t=parseInt(s,10));var d=ta.widgets.calendar.getGuestsRoomsValue(n,"CA");d&&""!==d&&(a=d),e&&e>0&&t&&t>0&&(r={rooms:t,guests:e,child_rm_ages:a},ta.store("guests.rooms.object",r),ta.fireEvent("onLegacyGuestsChanged",r))}catch(e){ta.util.error.record(e,"ta.widgets.calendar.getGuestsRoomsPickerData")}return r||(r={rooms:1,guests:2,child_rm_ages:""},ta.store("guests.rooms.object",r)),r},getGuestsRoomsPickerDataForUnifiedDatesParam:function(){var e=ta.widgets.calendar.getGuestsRoomsPickerData(),t=[e.rooms,e.guests];return e.child_rm_ages&&t.push(e.child_rm_ages),{uguests:t.join("_")}},getCheckRatesData:function(){function e(){var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate();return!!(e&&t&&e.getMonth&&t.getMonth)&&{"inMonth":e.getMonth()+1+" "+e.getFullYear(),"inDay":e.getDate(),"outMonth":t.getMonth()+1+" "+t.getFullYear(),"outDay":t.getDate()}}function t(e){return e=e||"STAYDATES",ta.page.datesToQueryJson(e)}return function(a){var r=ta.page&&ta.page.datesToQueryJson?t(a):e();if(r.adults=ta.widgets.calendar.getPageAdultsCount(),ta.has("guests_rooms_picker.enabled")){var n=ta.widgets.calendar.getGuestsRoomsPickerData();r.adults=n.guests,r.rooms=n.rooms,r.child_rm_ages=n.child_rm_ages}return r}}(),_parseDatePickerDate:function(e){try{if(e&&e.split&&e.split(" ").length>1){var t=e.split(" "),a=new Date;return ta.util.date.normalize(a),a.setFullYear(t[0]),a.setDate(1),a.setMonth(parseInt(t[1],10)-1),a.setDate(t[2]),a}}catch(e){return!1}},hasPageDates:function(){return!!ta.has("metaDatePickerEnabled")&&(!!ta.has("meta.page_dates")||(ta.widgets.calendar.getPageInDate(),ta.widgets.calendar.getPageOutDate(),ta.has("meta.page_dates")))},oneDayMill:864e5,updateDateWidgetDisplay:function(e){if(e){ta.id(e).removeClass("date_picker_error");var t=ta.widgets.calendar.getPageInDate(),a=ta.widgets.calendar.getPageOutDate();ta.widgets.calendar.updateDateDisplay(e,t,a);var r=document.getElements(".adults");r&&r.each(function(e){ta.widgets.calendar.updateAdultsDisplay(e)})}},getPageInCalendarField:function(e,t){return ta.id("date_picker_in_"+e+t)},getPageOutCalendarField:function(e,t){return ta.id("date_picker_out_"+e+t)},getErrorDates:function(){var e="no dates";try{var t=ta.widgets.calendar.getDatePickerFormat("classic");ta.widgets.calendar.hasPageDates()&&(e=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),t),e=e+" - "+ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageOutDate(),t))}catch(e){}return e},updateDateDisplay:function(e,t,a){var r,n,i,s,d,l,o;t&&a&&t.getTime()>a.getTime()&&(r=t,t=a,a=r),n=ta.widgets.calendar.getDatePickerFormat("classic"),ta.id(e).getParent(".dual_date")?(e.innerHTML=t?ta.widgets.calendar.dateToString(t,n):ta.retrieve("multiDP.checkIn"),i=e.id.replace("date_picker_in","date_picker_out"),i&&ta.id(i)&&(ta.id(i).innerHTML=a?ta.widgets.calendar.dateToString(a,n):ta.retrieve("multiDP.checkOut"))):(s=e.innerHTML=ta.retrieve("multiDP.enterDatesText"),d=ta.widgets.calendar.getSingleDateFieldDatesText(t,a,n),d&&(s=d),e.innerHTML=s,l=ta.id(e).getParent(),l&&(o=l.getElement(".date_picker_calendar_nights"),ta.widgets.calendar.updateNightsDisplay(o,t,a)))},getSingleDateFieldDatesText:function(e,t,a){var r="",n=ta.retrieve("multiDP.dateSeparator")||" - ";return e&&(r=ta.widgets.calendar.dateToString(e,a)+n,t&&(r+=ta.widgets.calendar.dateToString(t,a))),r},updateNightsDisplay:function(e,t,a){if(e){if(!a)return void(e.innerHTML="");var r=ta.widgets.calendar.getNumberOfNightsFromDates(t,a);1==r?e.innerHTML=ta.retrieve("multiDP.singleNightText"):e.innerHTML=ta.retrieve("multiDP.multiNightsText").replace(/\d+/,r)}},getNumberOfNights:function(){var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate();return ta.widgets.calendar.getNumberOfNightsFromDates(e,t)},getNumberOfNightsFromDates:function(e,t){return e&&t?Math.round(Math.abs((e.getTime()-t.getTime())/ta.widgets.calendar.oneDayMill)):0},updateAdultsDisplay:function(e){if(e){var t=ta.widgets.calendar.getPageAdultsCount();"1"==t?e.innerHTML=ta.retrieve("multiDP.singleAdultsText"):e.innerHTML=ta.retrieve("multiDP.multiAdultsText").replace(/\d+/,t)}},syncAllDatePickers:function(){var e=document.getElements(".date_picker.date");e&&Array.each(e,function(e){!e||ta.id(e).hasClass("out_date")||ta.id(e).hasClass("multiCity")||ta.id(e).hasClass("oneWay")||ta.widgets.calendar.updateDateWidgetDisplay(e)});var t=$$(".tablet_date_label");if(t&&ta.widgets.calendar.hasPageDates()&&t.addClass("showLabels"),t=document.getElements(".dateLabel")){var a=ta.widgets.calendar.getDatePickerFormat("short"),r=ta.widgets.calendar.getDatePickerFormat("classic"),n=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),r);ta.has("guests_rooms_picker_3.enabled")&&(n=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),a));var i=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageOutDate(),r);Array.each(t,function(e){var t=ta.id(e);t&&(t.hasClass("inDate")?t.innerHTML=n?n:ta.retrieve("multiDP.checkIn"):t.hasClass("outDate")&&(t.innerHTML=i?i:ta.retrieve("multiDP.checkOut")))})}},getDatePickerFormat:function(e){return"classic"===e&&"undefined"!=typeof DATE_PICKER_CLASSIC_FORMAT?DATE_PICKER_CLASSIC_FORMAT:"short"===e&&"undefined"!=typeof DATE_PICKER_SHORT_FORMAT?DATE_PICKER_SHORT_FORMAT:"days_and_slashes"===e&&"undefined"!=typeof DATE_PICKER_DAY_AND_SLASHES_FORMAT?DATE_PICKER_DAY_AND_SLASHES_FORMAT:"undefined"!=typeof DATE_PICKER_META_FORMAT?DATE_PICKER_META_FORMAT:("string"!=typeof e&&(e="not_a_string"),"")},dateToString:function(e,t){var a,r,n,i,s,d,l,o,c;return e.getDate&&t&&"string"==typeof t?ta.widgets.calendar.getDatePickerFormat("classic").indexOf(t)>-1?(a=new Date(e),ta.retrieve("thai_buddhist_era_year")&&a.setFullYear(a.getFullYear()+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET),r="MM",n="yyyy",i="dd",o=a.getDate()+"",o&&1===o.length&&(o="0"+o),c=a.getMonth()+1+"",c&&1===c.length&&(c="0"+c),t=t.replace(r,c).replace(i,o).replace(n,a.getFullYear()).replace(/'/g,"")):ta.widgets.calendar.getDatePickerFormat("short").indexOf(t)>-1?(a=new Date(e),r="MM",i="dd",o=a.getDate()+"",o&&1==o.length&&(o="0"+o),c=a.getMonth()+1+"",c&&1==c.length&&(c="0"+c),t=t.replace(r,c).replace(i,o).replace(/'/g,"")):ta.widgets.calendar.getDatePickerFormat("days_and_slashes").indexOf(t)>-1?(a=new Date(e),l="EEE",r="MM",n="yyyy",i="dd",o=a.getDate()+"",t.indexOf("dd")!=-1?o&&1===o.length&&(o="0"+o):i="d",c=a.getMonth()+1+"",t.indexOf("MM")!=-1?c&&1===c.length&&(c="0"+c):r="M",d=e.getDay(),ta.retrieve("multiDP.isMondayFirstDayOfWeek")&&(d-=1),d==-1&&(d=6),t=t.indexOf(l)!=-1?t.replace(l,jsGlobalDaysAbbrev[d]):t.indexOf("EE")!=-1?t.replace("EE",jsGlobalDaysAbbrev[d]):t.replace("E",jsGlobalDaysAbbrev[d]),t=t.replace(r,c).replace(i,o).replace(n,a.getFullYear()).replace(/'/g,"")):(s=ta.retrieve("multiDP.abbrevMonthList"),d=e.getDay(),ta.retrieve("multiDP.isMondayFirstDayOfWeek")&&(d-=1),d==-1&&(d=6),l="EEE",r="MMM",t.indexOf("EEEE d MMMM")>-1&&(l="EEEE",r="MMMM"),t=t.replace(l,jsGlobalDaysAbbrev[d]).replace(r,s[e.getMonth()]).replace(/\bd\b/,e.getDate()).replace(/'/g,"")):""},showCalendarByLocId:function(e,t){if(!/^\d+$/.test(e))return void ta.util.error.record(null,"Cannot show calendar due to missing/invalid location ID: "+e);t=t||"";var a={id:"",className:"id_"+e+t,"data-date_suffix":t,toS+"]"}};ta.widgets.calendar.setErrorStyling(a)},clickCalendarEvent:function(e){if(document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}else e.click()},setErrorStyling:function(e){var t=!1,a=e["data-date_suffix"]||null,r=e.id.match(/CHECK_RATE_([a-zA-Z]+)/);r&&r.length>1&&("mnf"==r[1]||"mnl"==r[1]||"photoviewer"==r[1]||"albumMeta"==r[1])&&(a="_"+r[1]);try{t=e.className.match(/\bid_(\d+)/)[1]}catch(e){}if(t){var n=!1,i="date_picker_in_";!n&&a&&(n=ta.id(i+t+a)),n||(n=ta.id(i+t+"_met")),n||(n=ta.id(i+t+"_cro")),n||(n=ta.id(i+t+"_per")),n||(n=ta.id(i+t+"_pop")),n||(n=ta.id(i+t+"_mnl")),n||(n=ta.id(i+t+"_mnm")),n||(n=ta.id(i+t+"_smt")),n||(n=ta.id(i+t+"_pto")),n||(n=ta.id(i+t+"_pal")),n||(n=ta.id(i+t+"_amo")),n||"_inm"!=e.id.slice(-4)||(n=ta.id(i+t+"_inm")),n||(n=ta.id(i+t)),n&&setTit(n)},100)}},launchInlin",e)},launchMetaLightboxUpdate:function(){},launchCRLBUts()},_crBtnOnclick:function(e,t){ta.store("meta.calendarCR",!0);var a=document.getElement(e);a&&document.getElement(e).onclick(t),ta.remove("meta.calendarCR")},displayStayInfoPen")},closeCalendarWidgets:function(){var e=document.getElements(".date_picker_calendar");e&&Array.ede()});var t=document.getElement(".dp.overlay");t&&t.overlay&&t.overlay.hide()},getInOutTrackingKey:function(e){var t="avail.data.dateClicked";return e?t+".in":t+".out"},removeInOutCalendarSel(e))},trackInOutCalendarSelected:function(e){ta.store(ta.widgets.calendar.getInOutTrackingKey(e),!0)},inOutCalendarSel(e))},trackCalendarEvent:function(e,t,a,r){try{var n=ta.has("multiDP.priorDates")?ta.retrieve("multiDP.priorDates"):ta.widgets.calendar.hasPageDates();a+=n?"|CHANGE":"|PRE",ta.trackEventOnPage(e,t,a,r,!0)}catch(e){}},cancelAllExistingHAC:function(){ta.hac.filters&&ta.hac.filters.removeProcessingForExistingHACQuery&&ta.hac.filters.removeProcessingForExistingHACQuery(),ta.meta.update&&ta.meta.update.cancelAllMetaCurrentQuery&&ta.meta.update.cancelAllMetaCurrentQuery(),ta.commerce.metajson&&ta.commerce.metajson.cancelCurrentBulkFetch&&ta.commerce.metajson.cancelCurrentBulkFetch()},submitHacSearch:function(e,t,a){if("undefined"==typeof a&&(a=!1),ta.has("useHotelsFilterState"))return ta.widgets.calendar.submitHotelsForm(e,t,a);var r="";if(t=ta.id(t),"form"==t.get("tag")){var n=t.getElement("input[name=q]");n&&(n.name=""),r=t.action+"?"+t.toQueryString()}else"a"==t.get("tag")?r=t.href:(t=t.getParent("a"),r=t.href);if(""!==r){if(ta.widgets.calendar.hasPageDates()){r.match(/\?/)||(r+="?");var i=ta.widgets.calendar.getCheckRatesData();i&&(r=r+"&"+Object.toQueryString(i))}e&&new Event(e).preventDefault(),a?window.open(r):window.location=r}},clearSessionDates:function(e,t){new Request({url:"/UpdateSessionDatesAjax?clear=true",onSuccess:function(){ta.widgets.calendar.clearDates(),e&&(document.location.href="./"+e),t&&"function"==typeof t&&t()}}).send()},clearAllDatePickers:function(){var e=ta.retrieve("avail.data.objects");e&&Array.ear()});var t=document.getElements(".date_picker.date");t&&Array.es(e)});var a=$$(".tablet_date_label");a&&a.removeClass("showLabels")},showEnterDates:function(e){e&&(ta.id(e).getParent(".dual_date")?ta.id(e).hasClass("out_date")?e.innerHTML=ta.retrieve("multiDP.checkOut"):e.innerHTML=ta.retrieve("multiDP.checkIn"):e.innerHTML=ta.retrieve("multiDP.enterDatesText"))},clearDates:function(){ta.widgets.calendar.clearPageDates(),ta.widgets.calendar.clearAllDatePickers();var e=document.getElement(".clear_dates_button")||document.getElement(".clearDates"),t=document.getElement(".clear_dates_wrapper")||document.getElement(".clearDatesWrapper"),a=document.getElement(".showPriceButton"),r=document.getElement(".change_dates_button"),n=document.getElement(".date_picker_post_dates"),i=document.getElement(".date_picker_pre_dates"),s=document.getElement(".show_prices_button"),d=ta.id("ANIMATED_DATE_CTA"),l=ta.id("BC_PHOTOS"),o=document.getElement("#BC_PHOTOS .photo_slideshow"),c=document.getElement("#BC_PHOTOS .ug_thumbs");ta.retrieve("animate_date_reformat")&&(d=ta.id("ANIMATED_DATE_CTA_REFORMAT")),i&&i.show(),n&&n.hide(),e&&e.hide(),t&&t.hide(),r&&r.hide(),s&&s.show(),d&&ta.servlet.HACSearch.loadAnimatedDateCTA(),a&&a.hide(),l&&(l.style.opacity=1),o&&(o.style.opacity=1),c&&(c.style.opacity=1),ta.servlet.HACSearch&&ta.has("hac_timezone_awareness")&&ta.servlet.HACSearch.clearDateFieldHighlighting()},clearDatesAndRedirect:function(){var e=window.location.hash,t=!1,a=window.location.href.match(/geo=\d+/g);if(a&&a[0]&&(t=a[0]),t||(a=window.location.href.match(/-g\d+/g),a&&a[0]&&(t="geo="+a[0].substring(2))),t){var r="HACSearch?"+t+e;ta.widgets.calendar.clearSessionDates(r)}},storePriorDates:function(){ta.store("multiDP.priorDates",ta.retrieve("multiDP.priorDates")||ta.widgets.calendar.hasPageDates())},datesExist:function(){var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate();return e&&t},datesInRange:function(){var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate();if(!ta.widgets.calendar.datesExist())return!1;var a=Math.round(Math.abs((e.getTime()-t.getTime())/ta.widgets.calendar.oneDayMill));return a>=1&&a<=ta.util.date.MAX_STAY_DURATION_DAYS},openFirstDatePicker:function(e){new Event(e).stopPropagation();var t=$$(".date_picker_calendar_wrap");t&&t.length>0&&t[0].click(),ta.trackEventOnPage("price_filter_dates_link","click","")},justUpdateSessionDates:function(e,t,a){return t&&!ta.widgets.calendar.haveDatesChanged()||ta.util.date.getDaysApart(this.inDate,this.outDate)>ta.util.date.MAX_STAY_DURATION_DAYS||this.inDate&&this.outDate&&ta.util.date.normalize(this.inDate)==ta.util.date.normalize(this.outDate)?void(e&&"function"==typeof e&&e()):(new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(ta.widgets.calendar.getCheckRatesData()),method:"post",async:a!==!0,onSuccess:function(){e&&"function"==typeof e&&e(),ta.retrieve("dates.moniker.fired")||(ta.store("dates.moniker.fired",!0),ta.widgets.calendar.loadDateEnteredMonikers()),ta.fireEvent("hotels.sessionDatesUpdated")}}).send(),!0)},justUpdateSessionAdults:function(e){var t=ta.widgets.calendar.getPageAdultsCount();t<=0||new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString({"adults":t,"onlyAdults":!0}),method:"post",onSu&e()}}).send()},getGuestsRoomsValue:function(e,t){if(e)for(var a=e.split("*"),r=0;r<a.length;r++){var n=a[r].split(".");if(2==n.length&&n[0]===t)return n[1]}},updateGuestsRoomsPickerDataFromCookie:function(){var e,t,a,r,n,i,s=require("utils/cookieutils").getCookie("TATravelInfo");n=ta.widgets.calendar.getGuestsRoomsValue(s,"A"),n&&""!==n&&(a=parseInt(n,10)),i=ta.widgets.calendar.getGuestsRoomsValue(s,"RS"),i&&""!==i&&(t=parseInt(i,10));var d=ta.widgets.calendar.getGuestsRoomsValue(s,"CA");d&&""!==d&&(r=d),a>=1&&t>=1&&a.toFixed&&t.toFixed&&(e={rooms:t,guests:a,child_rm_ages:r},ta.store("guests.rooms.object",e),ta.fireEvent("onLegacyGuestsChanged",e))},updateGuestsRoomsPickerUI:function(){var e=ta.widgets.calendar.getGuestsRoomsPickerData(),t=document.getElements(".grp-rooms-value");t.each(function(t){t&&(t.innerHTML=e.rooms)}),t=document.getElements(".grp-guests-value"),tsts)})},updateGuestsRoomsButtonLabelsPluralization:function(e,t){var a=$$(e);a.each(function(e){t>1?e.addClass("multiple"):e.removeClass("multiple")})},checkDatesMakeHacCallHR:function(e){ta.widgets.calendar.hasPageDates()&&ta.widgets.calendar.handleNewDates(e)},checkDatesMakeHacCallHotels:function(e){ta.widgets.calendar.hasPageDates()&&ta.servlet.HACSearch.doMetaDateSearch(e)},updateSDCalendar:function(){new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(ta.widgets.calendar.getCheckRatesData()),method:"post",onSuccess:function(){var e,t,a=document.getElement("#STATIC_DATE_PICKER_BAR .filterControls");window.fireEvent("sd_hh_datesChanged"),ta.id("SDDatesHeaderCenter")&&(e=ta.id("SDDatesHeaderCenter"),e.addClass("hide")),ta.id("SD_DATEBAR_TOOLTIP")&&(e=ta.id("SDDatePickerBarStaticButton"),e.addClass("hide"),t=ta.id("SDDatePickerBarStaticChangeDates"),t.removeClass("hide")),a&&(ta.widgets.calendar.datesExist()?(a.removeClass("noDatesSelected"),a.addClass("datesSelected")):(a.removeClass("datesSelected"),a.addClass("noDatesSelected"))),ta.retrieve("dates.moniker.fired")||(ta.store("dates.moniker.fired",!0),ta.widgets.calendar.loadDateEnteredMonikers())}}).send()},updateHLCalendar:function(){new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(ta.widgets.calendar.getCheckRatesData()),method:"post",onSuccess:function(){var e,t,a;if(window.fireEvent("sd_hh_datesChanged"),t=ta.id("BODYCON"),t&&(e=t.getElement("#HLDatePickerBar .metaDatePicker.moreProminent"),a=t.getElement("#STATIC_DATE_PICKER_BAR .filterControls"),a&&(ta.widgets.calendar.datesExist()?(a.removeClass("noDatesSelected"),a.addClass("datesSelected")):(a.removeClass("datesSelected"),a.addClass("noDatesSelected")))),e){var r=document.getElement(".overlayBG"),n=document.getElement(".rgba_flyout.gray.overlay.relative"),i=document.getElement(".baseHotelInfoLeft"),s=document.getElement(".baseHotelInfoRight"),d=document.getElement(".HLBaseDisclaimer");r&&r.destroy(),n&&n.destroy(),i&&s&&s.inject(i,"before"),d&&d.hasClass("hide")&&d.removeClass("hide")}ta.retrieve("dates.moniker.fired")||(ta.store("dates.moniker.fired",!0),ta.widgets.calendar.loadDateEnteredMonikers())}}).send()},updateSessionDates:function(e,t){new Request({url:"/UpdateSessionDatesAjax",data:t,method:"post",onSuccess:function(){e&&(ta.retrieve("smartDealsSearchIframe")?window.open(e,"_blank"):window.location=e)},onFailure:function(){e&&(ta.retrieve("smartDealsSearchIframe")?window.open(e,"_blank"):window.location=e)}}).send()},redirectToHotelOverview:function(e){this._redirectToHotelOverview(e,function(e){window.location=e})},openTabToHotelOverview:function(e,t){this._redirectToHotelOvervus()})},_redirectToHotelOverview:function(e,t){if(e){e=JSON.decode(e);var a=e.url;ta.retrieve("is_from_sdprospect")&&a.contains("/Hotels-")&&(a=a.replace("/Hotels","/SmartDeals")),t(a)}else t("/Hotels")},submitHotelsForm:function(e,t,a){t=ta.id(t),"undefined"==typeof a&&(a=!1);var r=t.toQueryString();if(ta.widgets.calendar.hasPageDates()){var n=ta.widgets.calendar.getCheckRatesData();n&&(r=r+"&"+Object.toQueryString(n))}var i=a?window.open(""):null;return new Request({url:"/FilterState",data:r,method:"post",onSuw(e)},onFailure:function(){a?ta.widgets.calendar.openTabToHotelOverview(null,i):ta.widgets.calendar.redirectToHotelOverview(null)}}).send(),e&&new Event(e).preventDefault(),!1},getPlacement:function(e){if(!e||!e.id)return null;var t=/date_picker_[0-9]*_([a-z]*)/,a=/date_picker_in_[0-9]*_([a-z]*)/,r=/date_picker_out_[0-9]*_([a-z]*)/,n=/date_picker_adults_[0-9]*_([a-z]*)/,i=e.id,s=t.exec(i);if(s||(s=a.exec(i)),s||(s=r.exec(i)),s||(s=n.exec(i)),s&&(s=s[1]),!s){var d=e.getParent(".HotelDateSearch");if(d&&d.id){var l=d.id.split("_");l.length>1&&(s=l[l.length-1])}}return s},handleNewDates:function(e,t){if(ta.retrieve("hotel_review_low_price_message")){var a=document.getElement("#PRICE_ALERT_RIBBON");a&&(a.hide(),ta.fireEvent("priceAlertBannerHidden")),ta.remove("hidePriceAlertRibbon")}if(ta.retrieve("dates.moniker.fired")||(ta.store("dates.moniker.fired",!0),ta.widgets.calendar.loadDateEnteredMonikers()),ta.retrieve("tablet_maps_v1")&&t){var r=t.getParent(".flexCard");r&&r.addClass("withMeta")}if(ta.store("meta.requestFromArea",""),ta.retrieve("origHTMLForUserReviews")){var n=ta.id("noAvailRHS");n&&(n.innerHTML=ta.retrieve("origHTMLForUserReviews"))}var i=document.getElement(".seeMoreHotels");i&&i.hide();var s=ta.id("BC_PHOTOS");s&&(s.style.opacity=1);var d=document.getElement("#BC_PHOTOS .photo_slideshow");d&&(d.style.opacity=1);var l=document.getElement("#BC_PHOTOS .ug_thumbs");l&&(l.style.opacity=1);var o=ta.widgets.calendar.getPlacement(t);if("geo"==o)return void ta.widgets.calendar.justUpdateSessionDates();ta.retrieve("ta.commerce.suppress_commerce_impressions.enabled")&&("Hotel_Review"!=pageServlet&&"ShowUserReviews"!=pageServlet&&"LocationPhotoDirectLink"!=pageServlet||ta.store("meta.isFromDatesChange",!0)),ta.store("hotels.datesChanged",!0),ta.commerce.datepickerpersist&&ta.commerce.datepickerpersist.update();var c="property_"+e,g=ta.id(c),u=ta.retrieve("overlay.lastElmt.className"),m="pop"==o&&"Hotels"==pageServlet&&g&&u&&u.match(/custom_area_QC_Hotels_Meta/);return ta.meta&&ta.meta.update&&!m?("Hotels"===pageServlet&&ta.servlet.HACSearch.displayPostDatesLinks(),void ta.fireEvent("newInlinePageDates",e,o)):!m&&ta.util&&ta.util.error?void ta.util.error.record(null,"handleNewDates - no meta js"):(ta.store("hotels.datesChanged",!0),ta.servlet.HACSearch.displayPostDatesLinks(),ta.store("meta.redirectingToHR",!0),ta.remove("overlay.lastElmt.className"),ta.widgets.calendar.justUpdateSessionDates(!1,!1,!0),ta.hac.filters.updateResultsFromDateSearch(),window.open(g.href),void document.getElements(".overlay")de()}))},trackCRButtonClick:function(e){var t=ta.widgets.calendar.getPageInDate(),a=ta.widgets.calendar.getPageOutDate(),r=[e];t&&r.push("CHECKIN"),a&&r.push("CHECKOUT"),ta.trackEventOnPage("CRBUTTON","CLICK",r.join("|"))},onCalendarChangefo()},onCalendarRangeSelect:function(e){if(ta.commerce.metajson&&ta.commerce.metajson.refetchAll(),"undefined"!=typeof oxapp&&oxapp&&oxapp.context){var t=oxapp.context.has("TravelDates")&&oxapp.context.get("TravelDates");t&&t.save()}ta.fireEvent("onCalendarRangeSelect")},fireTravelInfoChangeAuction:function(){if(window&&window.__REDUX_STORE__){var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate();if(!e||!t)return;var a=[e.getFullYear(),e.getMonth()+1,e.getDate(),t.getFullYear(),t.getMonth()+1,t.getDate()].join("_"),r="1_2",n=ta.widgets.calendar.getGuestsRoomsPickerData(),i=n?[n.rooms,n.guests].join("_"):r,s={type:"SET_HOTELS_DATES_GUESTS",stayDates:a,guests:i};window.__REDUX_STORE__.dispatch(s)}},trackCalendarSelect:function(e){var t=document.getElement(".inline_calendar");if(t&&(t=t.getParent()),t){var a=t.getElement(".meta_date_field.first .date_picker");if(e&&(a=t.getElement('.meta_date_field:not([class="first"]) .date_picker')),a){var r=ta.id(a).get("id");r=r.substring(r.length-3,r.length);var n="START",i="DATES",s=ta.widgets.calendar.getPageInDate(),d=ta.widgets.calendar.getPageOutDate();if("upt"==r&&(i="Interrupter"),e)if(n="SELECT",ta.retrieve("ta.calendar.isPriceOverlayCalendar"))i="PRICE_CALENDAR";else if(s&&d){var l=ta.util.date.getDaysInRange(s,d)-1;l>ta.util.date.MAX_STAY_DURATION_DAYS&&(i="DATES_OVER_30_DAYS")}ta.widgets.calendar.trackCalendarEvent(ta.widgets.calendar.getTrackingString(),n,i)}}},setFirstDisplayMonth:function(e){var t=document.getElement(".month");if(!t)return!1;var a=ta.widgets.calendar.getDateFromElem(t);return a||(a=new Date(ta.util.date.normalize(new Date))),e?(a.setDate(1),a.setDate(32),a.setDate(1)):(a.setDate(1),a.setDate(-1),a.setDate(1)),a},updateCalendarMonths:function(e,t){try{if(ta.has("ta.calendar.date.clickFunction")||ta.widgets.calendar.setClickMouseOverFunctions(),!e)return;if(e=ta.id(e),t){if(ta.util.i18n.isRtl()&&!e.hasClass("sprite-date_picker-arrowButtonLeft"))return;if(!ta.util.i18n.isRtl()&&!e.hasClass("sprite-date_picker-arrowButtonRight"))return}else{if(ta.util.i18n.isRtl()&&!e.hasClass("sprite-date_picker-arrowButtonRight"))return;if(!ta.util.i18n.isRtl()&&!e.hasClass("sprite-date_picker-arrowButtonLeft"))return}var a=ta.widgets.calendar.setFirstDisplayMonth(t),r=document.getElement(".inline_calendar"),n=r.getElements(".month");n&&Array.each(n,function(e){e.dispose()});var i=ta.widgets.calendar.createMonth(a);
ta.widgets.calendar.injectMonth(i.elmt,r,!0),ta.widgets.calendar.updatePrevNext(r,i)}catch(e){ta.util.error.record(e,"update calendar months")}},updatePrevNext:function(e,t){var a=t.date,r=t.date;ta.has("ta.calendar.firstDate")||ta.widgets.calendar.setFirstLastDates();var n=ta.util.date.inSameMonth(a,ta.retrieve("ta.calendar.firstDate")),i=ta.util.date.inSameMonth(r,ta.retrieve("ta.calendar.lastDate")),s=ta.util.i18n.isRtl()?"sprite-date_picker-arrowButtonRight":"sprite-date_picker-arrowButtonLeft",d=ta.util.i18n.isRtl()?"sprite-date_picker-arrowButtonLeft":"sprite-date_picker-arrowButtonRight";e.getElement(".prev").addClass(n?"":s).removeClass(n?s:""),e.getElement(".next").addClass(i?"":d).removeClass(i?d:"");var l=e.getElement(".prevText");l&&(n||!t.date?l.innerHTML="":l.innerHTML=jsGlobalMonthsAbbrev[(t.date.getMonth()-1)%12]),l=e.getElement(".nextText"),l&&(i||!t.date?l.innerHTML="":l.innerHTML=jsGlobalMonthsAbbrev[(t.date.getMonth()+1)%12])},dayClick:function(e,t,a,r,n){try{if(n=ta.id(n),!n||n.getParent(".disabled"))return;var i=ta.util.date.create(t,a,r),s=ta.widgets.calendar.getPageOutDate();if(i){if(ta.has("ta.first.date.selected")){var d=ta.widgets.calendar.getPageInDate();if(!d)return s&&ta.widgets.calendar.isValidStayLength(s)&&ta.widgets.calendar.clearPageDates(),ta.widgets.calendar.setPageInDate(i),void ta.widgets.calendar.setFirstDateSelected(!0);if(d.getTime()==i.getTime())return;d.getTime()>i.getTime()?(ta.widgets.calendar.setPageInDate(i),ta.widgets.calendar.setPageOutDate(d)):ta.widgets.calendar.setPageOutDate(i),ta.widgets.calendar.setFirstDateSelected(!1);var l=1;"undefined"!=typeof modelLocId&&(l=modelLocId),ta.widgets.calendar.handleNewDates(l),ta.widgets.calendar.showInlineCalendar(!1),ta.widgets.calendar.trackCalendarSelect(!0,n)}else s&&ta.widgets.calendar.isValidStayLength(s)&&ta.widgets.calendar.clearPageDates(),ta.widgets.calendar.setPageInDate(i),ta.widgets.calendar.setFirstDateSelected(!0),ta.widgets.calendar.trackCalendarSelect(!1,n);ta.widgets.calendar.updateSelectedDays(e,i,n),ta.widgets.calendar.syncAllDatePickers()}}catch(e){ta.util.error.record(e,"dayClick")}},setFirstDateSelected:function(e){e?(ta.store("ta.first.date.selected",!0),ta.widgets.calendar.addFirstDateFlag()):(ta.remove("ta.first.date.selected"),ta.widgets.calendar.removeFirstDateFlag(),ta.widgets.calendar.removeHoverDateFlag()),ta.widgets.calendar.setMaxLengthOfStayStyling(),ta.widgets.calendar.setInDateInputSelectState(e)},clearCalendarSelections:function(){ta.widgets.calendar.clearSelectedDays(),ta.widgets.calendar.clearDates(),ta.widgets.calendar.setFirstDateSelected(!1)},addFirstDateFlag:function(){var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getDayElemFromDate(e),a=ta.retrieve("calendar.checkInText");if(a){var r=new ta.widgets.ArrowLabel(t,a);ta.store("ta.calendar.firstDateFlag",r)}},removeFirstDateFlag:function(){if(ta.has("ta.calendar.firstDateFlag")){var e=ta.retrieve("ta.calendar.firstDateFlag");e&&(e.remove(),ta.remove("ta.calendar.firstDateFlag"))}},addHoverDateFlag:function(e,t,a){var r=ta.widgets.calendar.getPageInDate();if(r.getTime()==e.getTime())return void ta.widgets.calendar.removeHoverDateFlag();if(ta.has("ta.calendar.hoverDateFlag")){var n=ta.retrieve("ta.calendar.hoverDateFlag");return void(n&&(n.setParentElem(t),n.setText(a)))}var i=new ta.widgets.ArrowLabel(t,a,{"labelArrowBaseClass":"calendarDateStyling hoverDateStyling"});ta.store("ta.calendar.hoverDateFlag",i)},removeHoverDateFlag:function(){if(ta.has("ta.calendar.hoverDateFlag")){var e=ta.retrieve("ta.calendar.hoverDateFlag");e&&(e.remove(),ta.remove("ta.calendar.hoverDateFlag"))}},addChooseDatesFlag:function(){if(!ta.has("ta.calendar.chooseDateFlag")){var e=ta.retrieve("calendar.enterDatesText"),t=document.getElement(".metaContentSection .largeOpenCalCRButton"),a=new ta.widgets.ArrowLabel(t,e,{"labelArrowBaseClass":"calendarDateStyling enterDatesArrowElem","arrowSpriteClass":"sprite-date_picker-orangeArrowUp"});ta.store("ta.calendar.chooseDateFlag",a)}},removeChooseDatesFlag:function(){if(ta.has("ta.calendar.chooseDateFlag")){var e=ta.retrieve("ta.calendar.chooseDateFlag");e&&(e.remove(),ta.remove("ta.calendar.chooseDateFlag"))}},onDateInputClick:function(e,t){var a=document.getElement(".inline_calendar");a&&a.hasClass("hidden")?ta.widgets.calendar.showInlineCalendar(!0,!t.getParent(".meta_date_field.first")):a&&ta.has("ta.first.date.selected")&&t&&t.getParent(".meta_date_field.first")&&ta.widgets.calendar.clearCalendarSelections()},onDateInputOver:function(){ta.widgets.calendar.hasPageDates()||ta.has("ta.first.date.selected")||ta.widgets.calendar.addChooseDatesFlag()},onDateInpag()},getDayElemFromDate:function(e){return!(!e||!e.getTime)&&document.getElement(".date_"+e.getDate()+".month_"+e.getMonth()+".year_"+e.getFullYear())},getDateFromElem:function(e){var t,a,r=1,n=!1,i=!1;return!!e&&(e=ta.id(e),!!(t=e.className)&&(a=t.match(/date_(\d+)/),a&&a[1]&&(r=a[1]),a=t.match(/month_(\d+)/),a&&a[1]&&(n=a[1]),a=t.match(/year_(\d+)/),a&&a[1]&&(i=a[1]),n!==!1&&i!==!1&&ta.util.date.create(i,n,r)))},setMaxLengthOfStayStyling:function(){var e=ta.has("ta.first.date.selected"),t=document.getElements(".month td");if(e){var a=ta.widgets.calendar.getPageInDate(),r=ta.widgets.calendar.getPageInDate();r.setDate(r.getDate()+ta.util.date.MAX_STAY_DURATION_DAYS),t&&a&&Array.each(t,function(e){var t=ta.widgets.calendar.getDateFromElem(e);t&&(t.getTime()<a.getTime()||r.getTime()<t.getTime())&&e.addClass("disabled")})}else if(t){var n=new Date(ta.util.date.normalize(new Date));ta.has("ta.calendar.lastDate")||ta.widgets.calendar.setFirstLastDates();var i=ta.retrieve("ta.calendar.lastDate");Array.each(t,function(e){var t=ta.widgets.calendar.getDateFromElem(e);t&&n.getTime()<=t.getTime()&&t.getTime()<=i.getTime()&&e.removeClass("disabled")})}},setInDateInputSelectState:function(e,t){var a=document.getElements(".metaContentSection .date_picker_calendar_wrap"),r=ta.widgets.calendar.getSelArrowElem();a&&Array.each(a,function(a){t?(a.removeClass("selectionStyle"),r.dispose()):a.getParent()&&a.getParent().hasClass("first")?e?a.removeClass("selectionStyle"):(a.addClass("selectionStyle"),a.getParent().adopt(r)):e?(a.addClass("selectionStyle"),a.getParent()&&a.getParent().adopt(r)):a.removeClass("selectionStyle")})},getSelArrowElem:function(){var e=document.getElement(".selectionUpArrow");return e||(e=document.getElement(".inline_calendar")?new Element("div",{"class":"sprite-date_picker-pointer-orange-ac selectionUpArrow"}):new Element("div",{"class":"sprite-date_picker-pointer selectionUpArrow"})),e},showInlineCalendar:function(e,t){var a=document.getElement(".inline_calendar");if(a)if(e){var r=a.hasClass("hidden");a.removeClass("hidden");var n=document.getElement("#HR_HACKATHON_CONTENT .postShowMetaCR");n&&n.dispose(),t&&(ta.has("date.picker.pageInDate")||(t=!1)),ta.widgets.calendar.setFirstDateSelected(!!t),r&&ta.widgets.calendar.trackCalendarEvent(ta.widgets.calendar.getTrackingString(),"OPEN","DATES")}else{a.addClass("hidden"),ta.widgets.calendar.setInDateInputSelectState(!1,!0);var i=document.getElement(".largeOpenCalCRButton");i&&i.dispose();var s=document.getElement(".open_calendar_legend");s&&s.addClass("miniMetaHideHdr").removeClass("miniMetaShowHdr");var d=document.getElement(".open_calendar_highlight_bg");d&&d.removeClass("open_calendar_highlight_bg")}},dayOver:function(e,t,a,r,n){return"undefined"!=typeof isIPad&&isIPad?void ta.widgets.calendar.dayClick(e,t,a,r,n):void ta.widgets.calendar.updateSelectedDays(e,ta.util.date.create(t,a,r),n)},updateSelectedDays:function(e,t,a){var r,n,i,s,d,l,o,c,g="prevSel",u="start",m="end",D=!1;if(ta.has("ta.first.date.selected")){if(!a)return void ta.widgets.calendar.removeHoverDateFlag();if(a=ta.id(a).getParent(),r=t,ta.widgets.calendar.clearSelectedDays(),n=ta.widgets.calendar.getPageInDate(),i=ta.widgets.calendar.getPageOutDate(),D=!1,s=!1,n?(D=document.getElement(".month_"+n.getMonth()+".date_"+n.getDate()),s=n):i&&(D=document.getElement(".month_"+i.getMonth()+".date_"+i.getDate()),s=i),o=D,c=a,o?o.addClass(u).addClass(g):(o=document.getElement(".month td"),o&&o.addClass(g)),r.getTime()<s.getTime())return void ta.widgets.calendar.removeHoverDateFlag();c?c.addClass(m):(c=document.getElement(".month_"+r.getMonth()+".date_"+ta.util.date.getLastDayOfMonth(r)),c.addClass(g)),ta.widgets.calendar.updateSelectedDaysHelper(o,c,!0,g),a.hasClass("disabled")?ta.widgets.calendar.removeHoverDateFlag():(d=ta.retrieve("calendar.singleNightText"),l=ta.util.date.getDaysInRange(s,r)-1,1<l&&(d=ta.retrieve("calendar.multiNightsText"),d=d.replace(/\d+/,l)),ta.widgets.calendar.addHoverDateFlag(r,a,d))}},updateSelectedDaysHelper:function(e,t,a,r){if(e&&e!=t){var n="nextSibling",i="firstChild";a||(n="previousSibling",i="lastChild");var s=!1;if(ta.widgets.calendar.isValidDateElem(e.getNext()))s=e.getNext();else{var d=ta.id(e.parentNode);if(d&&d.getNext())s=d.getNext()[i];else if(d&&ta.id(d).getParent(".month")){var l=ta.id(d).getParent(".month");ta.util.i18n.isRtl()&&(n="previousSibling"==n?"nextSibling":"previousSibling");var o=l.getNext();if(!o)return;var c=ta.id(o).getElements("td");a||c.reverse(),c.some(function(e){return!!ta.widgets.calendar.isValidDateElem(e)&&(s=e,!0)},this)}}s&&(ta.id(s).addClass(r),ta.widgets.calendar.updateSelectedDaysHelper(s,t,a,r))}},isValidDateElem:function(e){if(!e||"TD"!=e.tagName)return!1;var t=e.className;return!t.match(/other/)&&!t.match(/disabled/)},clearSelectedDays:function(){var e=["prevSel","selected","start","end","inDate","inDate_DP7"];Array.each(e,function(e){var t=document.getElements(".inline_calendar .month td."+e);t&&Array.each(t,function(t){t.removeClass(e)})})},injectMonth:function(e,t,a){var r=t,n="top",i=t.getElement(".navCal");a&&i?(r=i,n="after"):a||(n="bottom"),e.inject(r,n),ta.widgets.calendar.setMaxLengthOfStayStyling(),ta.widgets.calendar.removeFirstDateFlag(),ta.has("ta.first.date.selected")&&ta.widgets.calendar.addFirstDateFlag()},setFirstLastDates:function(){var e=11,t=new Date;t=new Date(ta.util.date.normalize(t)),ta.store("ta.calendar.firstDate",t);var a=new Date(t.getTime());a.setDate(1);var r=a.getMonth(),n=r+e;a.setFullYear(a.getFullYear()+n/12),a.setMonth(n%12),a=new Date(ta.util.date.normalize(a)),ta.store("ta.calendar.lastDate",a)},setClickMouseOverFuncer")},buildDayClass:function(e){var t="",a=ta.widgets.calendar.getPageInDate(),r=ta.widgets.calendar.getPageOutDate(),n=new Date(ta.util.date.normalize(new Date));ta.has("ta.calendar.lastDate")||ta.widgets.calendar.setFirstLastDates();var i=ta.retrieve("ta.calendar.lastDate");return a&&a.getTime()==e.getTime()?t="inDate_DP7 start prevSel":a&&r&&a.getTime()<e.getTime()&&r&&e.getTime()<r.getTime()?t="prevSel":r&&r.getTime()==e.getTime()?t="inDate_DP7 end prevSel":(e.getTime()<n.getTime()||i.getTime()<e.getTime())&&(t="disabled"),e.getTime()==n.getTime()&&(t="today "+t),t},createMonth:function(e){var t,a,r,n,i,s,d,l,o,c,g,u,m={date:e},D="",v=-1;for(ta.has("ta.calendar.firstDate")||ta.widgets.calendar.setFirstLastDates(),t=new Date(e.getTime()),t.setDate(1),ta.util.date.normalize(t),a=e.getFullYear(),r=e.getMonth(),i=new Date(ta.util.date.normalize(new Date)),s=ta.retrieve("ta.calendar.lastDate"),d=ta.widgets.calendar.getPageInDate(),d&&t.getMonth()==d.getMonth()&&(v=d.getDate()),d&&(n=new Date(d.getTime()),n.setDate(n.getDate()+ta.util.date.MAX_STAY_DURATION_DAYS+1)),l=a,ta.retrieve("thai_buddhist_era_year")&&(l+=ta.util.date.THAI_BUDDHIST_YEAR_OFFSET),D+='<table cellspacing="0" cellpadding="0" border="0"><thead><tr><th class="caption" colspan="7">',"undefined"!=typeof DATE_FORMAT_MMM_YYYY&&(D+=DATE_FORMAT_MMM_YYYY.replace(/MMM/,jsGlobalMonths[r]).replace(/YYYY/,l)),D+="</th></tr><tr>",o=0;o<jsGlobalDaysShort.length;o++)D+="<th>",D+=jsGlobalDaysShort[o],D+="</th>";for(D+="</tr></thead><tbody><tr>",c=new Date(t.getTime()),c.setDate(1),g=1-c.getDay(),c.setDate(g),o=1;o<=42;o++)0===c.getDay()&&(D+="</tr><tr>"),u=ta.widgets.calendar.buildDayClass(c)+" "+ta.widgets.calendar.buildCalendarFrameClass(o),D+='<td class="month_'+c.getMonth()+" date_"+c.getDate()+" year_"+c.getFullYear()+" "+u+'">',D+=c.getTime()<i.getTime()||s.getTime()<c.getTime()?c.getDate():ta.widgets.calendar.buildDayAnchorTag(c),D+="</td>",c.setDate(c.getDate()+1);return D+="</tr></tbody></table>",m.elmt=new Element("div",{"class":"month month_"+m.date.getMonth()+" year_"+m.date.getFullYear()}).set("html",D),m},buildCalendarFrameClass:function(e){var t="";return e%7===1?t="leftCalFrame":e%7===0&&(t="rightCalFrame"),e<8?t+=" topCalFrame":35<e&&(t+=" bottomCalFrame"),t},buildDayAnchorTag:function(e){var t="";return t+=ta.has("checkrates.add_holding_windows")?'<a href="javascript:void(0);" class="no_cpu" ':'<a href="javascript:void(0);"',ta.has("ta.calendar.date.clickFunction")&&(t+=' onmouseover="',t+=ta.retrieve("ta.calendar.date.mouseOverFunction"),t+="(event,",t+=e.getFullYear(),t+=",",t+=e.getMonth(),t+=",",t+=e.getDate(),t+=',this);"'),ta.has("ta.calendar.date.clickFunction")&&(t+=' onclick="',t+=ta.retrieve("ta.calendar.date.clickFunction"),t+="(event,",t+=e.getFullYear(),t+=",",t+=e.getMonth(),t+=",",t+=e.getDate(),t+=',this)";'),t+=">",t+=e.getDate(),t+="</a>"},addCustomDayStyleString:function(e,t,a,r,n){var i="",s=ta.widgets.calendar.getPageInDate(),d=ta.widgets.calendar.getPageOutDate(),l="";return s&&d&&(l=" inDate_DP7 prevSel",n.getTime()>s.getTime()&&n.getTime()<d.getTime()&&(i+=" prevSel")),s&&a.date.getMonth()==s.getMonth()&&r==s.getDate()&&(i=i+" start"+l),d&&a.date.getMonth()==d.getMonth()&&r==d.getDate()&&(i=i+" end"+l),i},getDateArgsObject:function(){try{var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate(),a=ta.widgets.calendar.getPageAdultsCount();if(!e||!t||!a)return null;var r=e.getDate(),n=e.getMonth()+1,i=e.getFullYear(),s=t.getDate(),d=t.getMonth()+1,l=t.getFullYear(),o={"inDay":r,"inMonth":n+" "+i,"outDay":s,"outMonth":d+" "+l,"adults":a};return o}catch(e){return ta.util.error.record(e,"Unable to create calendar date args object"),null}},loadDateEnteredMon2e3)},getTrackingSKER"},clickDatepickerThroughBackdrop:function(e,t,a){if(e){e=new Event(e);var r=e.page.x,n=e.page.y,i=!1;(Array.convert||Array.from)([t,a]).each(function(t){if(!i){var a=t.getPosition(),s=t.getSize();if(r>=a.x&&r<=a.x+s.x&&n>=a.y&&n<=a.y+s.y){i=!0;var d=new MouseEvent("click",{"view":window,"bubbles":!0,"cancelable":!0});t.dispatchEvent(d),e.stopPropagation()}}})}},datesExplicitlySetBte")},updateAllGuestsRoomsButtons:function(){var e=ta.widgets.calendar.getGuestsRoomsPickerData();ta.select(".roomsButton .grp-rooms-value").each(function(t){t.set("html",e.rooms)}),ta.select(".guestsButton .grp-guests-value")sts)}),ta.widgets.calendar.syncAllDatePickers()}},ta.queueForReady(function(){require.defined("ta/util/Error")&&require("ta/util/Error").on("beforees()})});
ta.widgets.ArrowLabel=new Class({Implements:Options,Binds:["shiftLeft","shiftRight"],options:{charWidth:7,sidePadding:0,labelArrowBaseClass:"calendarDateStyling",arrowElemClass:"defaultArrowElemStyling",textElemClass:"arrowTextElemStyling",arrowSpriteClass:"sprite-date_picker-grayDownArrow",arrowIconClass:"arrowIconStyling",arrowIconWidth:16},initialize:function(t,e,i){if(this.setOptions(i),!t||!e)return!1;this.labelText=e,this.parentElem=t;var s=e.length+1,l=s*this.options.charWidth,n=0;this.parentElem.getCoordinates&&this.parentElem.getCoordinates().width&&(n=this.parentElem.getCoordinates().width,n%2==1&&(n+=1));var r=0;l&&(l%2==1&&(l+=1),r=-1*(l/2-n/2));var a="left";ta.util.i18n.isRtl()&&(a="right"),this.inlineRelElem=new Element("div",{"class":this.options.labelArrowBaseClass+" inlineRelElemStyling"}),this.arrowElem=new Element("div",{"class":this.options.arrowElemClass,styles:{width:l,padding:"0 "+this.options.sidePadding+"px"}}),this.arrowElem.setStyle(a,r),this.arrowTextElem=new Element("div",{html:this.labelText,"class":this.options.textElemClass}),this.arrowIconElem=new Element("div",{"class":this.options.arrowSpriteClass+" "+this.options.arrowIconClass});var o=0;this.options.arrowIconWidth?o=-1*(this.options.arrowIconWidth/2-n/2):n&&(o=n/2),this.arrowIconElem.setStyle(a,o),this.arrowTextElem.inject(this.arrowElem),this.arrowElem.inject(this.inlineRelElem),this.arrowIconElem.inject(this.inlineRelElem),this.inlineRelElem.inject(t)},setParentElem:function(t){t&&this.inlineRelElem&&(this.parentElem=t,this.parentElem.adopt(this.inlineRelElem))},seText},roy()}});
ta.widgets.Calendar=new Class({Binds:["addCustomDayStyleString","getCreatorElement"],Implements:[Options,Events],options:{selectedDate:null,firstDate:null,lastDate:null,dualCalendar:!0,invalidDates:null,useLinks:!0,dayNames:!1,formatter:null,offsetOther:0,choiceLink:null,prevAction:null,nextAction:null,monthHeadingFormat:"",monthspan:11,indicateTurnoverDays:!1,monthChangeDuration:500,postContent:null,prevStyle:!1,nextStyle:!1,showRange:!1,isFirstCal:null,creatorElem:null,includeTodayInRange:!1,holidaysOnCalendar:!1,stableTableHeight:!1,treatInvalidAsOutOfRange:!1,useInoutMonth:!0},initialize:function(t){if(this.setOptions(t),!this.options.firstDate){var e=ta.retrieve("calendar.serverTime");if(ta.has("hac_timezone_awareness")&&ta.has("ta.hac.locationTimezoneOffset")){var i=ta.retrieve("ta.hac.locationTimezoneOffset"),s=e?new Date(e):new Date,a=s.getTime();a+=6e4*s.getTimezoneOffset();var n=a+i;this.options.firstDate=new Date(n)}else this.options.firstDate=e?new Date(e):new Date}this.options.lastDate||this.setLastDate(this.options.monthspan),this.today=new Date,this.selectedDate=this.options.selectedDate,t.oneWayFlight&&(this.options.choiceLink="ta.widgets.calendar.calendarSingleSelect"),t.multiCityFlight&&(this.options.choiceLink="ta.widgets.calendar.calendarMCSelect"),ta.util.date.normalize(this.today),this.options.firstDate&&ta.util.date.normalize(this.options.firstDate),this.options.lastDate&&ta.util.date.normalize(this.options.lastDate),this.selectedDate&&ta.util.date.normalize(this.selectedDate),this.container=new Element("div",{"class":"calendar"}),this.addPrevNext(),this.options.postContent&&("function"==typeof this.options.postContent&&(this.options.postContent=this.options.postContent()),this.container.adopt(this.options.postContent)),this.options.wrapper&&("function"==typeof this.options.wrapper&&(this.options.wrapper=this.options.wrapper()),this.options.wrapper.getElement(".wrapper_inner").adopt(this.container),this.container=this.options.wrapper),""==this.options.monthHeadingFormat&&DATE_FORMAT_MMM_YYYY&&(this.options.monthHeadingFormat=DATE_FORMAT_MMM_YYYY)},setLastDate:function(t){(null==t||t<1)&&(t=11);var e=new Date;e.setDate(1);var i=e.getMonth(),s=i+t;e.setFullYear(e.getFullYear()+s/12),e.setMonth(s%12),this.options.lastDate=e},getFirsoday},update:function(){this.currentMonth&&this.removeTable(null,this.currentMonth),this.nextMonth&&this.removeTable(null,this.nextMonth);var t=this.getFirstDate();if(this.options.useInoutMonth&&(ta.widgets.calendar.getPageInDate()&&(t=new Date(ta.widgets.calendar.getPageInDate()),ta.has("datepicker_autoadvance_fday")&&(t=ta.retrieve("datepicker_autoadvance_fday"))),ta.widgets.calendar.getPageOutDate()&&(!ta.widgets.calendar.getPageInDate()||this.options.flights&&!this.isIn)&&(t=new Date(ta.widgets.calendar.getPageOutDate()),t.setDate(0))),this.options.firstDate&&t<this.options.firstDate&&(t=this.options.firstDate),this.options.dualCalendar){var e=new Date(t);e.setDate(ta.util.date.DAYS_IN_MONTH[e.getMonth()]),ta.util.date.normalize(e),e>=this.options.lastDate&&(t=new Date(t),0==t.getMonth()?t.setFullYear(t.getFullYear()-1,11,1):t.setMonth(t.getMonth()-1,1))}if(this.currentMonth=this.createMonth(t),this.injectMonth(this.currentMonth.elmt,!0),this.options.dualCalendar){var i=new Date(this.currentMonth.date),s=i.getDate(),a=i.getMonth()+1;s>ta.util.date.DAYS_IN_MONTH[a]&&(s=ta.util.date.DAYS_IN_MONTH[a]),i.setMonth(a,s),this.nextMonth=this.createMonth(i),this.injectMonth(this.nextMonth.elmt,!1)}return this.updatePrevNext(),this},injectMonth:function(t,e){ta.util.i18n.isRtl()&&(e=!e);var i=this.container,s="top";!e&&ta.id(this.container).getElement(".wrapper_inner .calendar")&&(i=ta.id(this.container).getElement(".wrapper_inner .calendar")),e&&this.nav?(i=this.nav,s="after"):e||(this.options.postContent?(i=this.options.postContent,s="before"):s="bottom"),t.inject(i,s)},reposition:function(){return this.currentMonth.elmt.setStyle("left","0px"),this.options.dualCalendar&&(ta.util.i18n.isRtl()?(this.nextMonth.elmt.setStyle("left","0px"),this.currentMonth.elmt.setStyle("left",this.nextMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")):this.nextMonth.elmt.setStyle("left",this.currentMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")),this},updatePrevNext:function(){var t=this.currentMonth.date,e=this.options.dualCalendar?this.nextMonth.date:this.currentMonth.date,i=ta.util.date.inSameMonth(t,this.options.firstDate),s=ta.util.date.inSameMonth(e,this.options.lastDate),a=function(t,e,i){if(e&&0!=e.length){if(t.className&&(!i||i==t.tagName)){var s=-1;do if(s=t.className.indexOf(e,s+1),s>=0&&(0==s||32==t.className.charCodeAt(s-1))&&(s+e.length==t.className.length||32==t.className.charCodeAt(s+e.length)))return t;while(s>=0)}}else if(i==t.tagName)return t;for(var n=0;n<t.childNodes.length;n++){var o=a(t.childNodes[n],e,i);if(o)return o}return null};a(this.container,"prev").style.display=i?"none":"block",a(this.container,"next").style.display=s?"none":"block"},createPagingElan>"},addPrevNext:function(){if(this.options.prevAction&&this.options.nextAction){var t=[],e=this.nav=new Element("div",{"class":"navCal"}).inject(this.container);t.push(this.createPagingElement("prev"+(this.options.prevStyle?" "+this.options.prevStyle:""),this.options.prevAction,"Previous Month")),t.push(this.createPagingElement("next"+(this.options.nextStyle?" "+this.options.nextStyle:""),this.options.nextAction,"Next Month")),e.set("html",t.join(""))}},getHolidays:function(t,e,i,s){var a;if(t){var n=e+"-"+(i+1)+"-"+s;a=t[n]}return a},createMonth:function(t){var e={date:t},i=new Date(t);i.setDate(1),ta.util.date.normalize(i);var s=(i.getDay()-jsGlobalDayOffset+7)%7,a=new Date(t);a.setDate(0),this.prevDayValid=this.isInvalidDate(a)?0:1,(a<this.options.firstDate||a>this.options.lastDate)&&(this.prevDayValid=-1);var n=2;this.options.multiCityFlight&&this.crId>n&&(this.options.firstDate=ta.widgets.calendar.lastDateBefore(this.options,this.crId));var o,h=[],r=t.getFullYear(),l=t.getMonth(),d=new Date,p=ta.util.date.inSameMonth(d,t)?d.getDate():-1,u=-1;this.selectedDate&&this.selectedDate.getMonth()==l&&this.selectedDate.getFullYear()==r&&(u=this.selectedDate.getDate());var c;this.options.showRange&&this.theOtherCal&&this.theOtherCal.selectedDate&&(c=this.theOtherCal.selectedDate,ta.util.date.normalize(c)),this.options.singleSelect&&"out"==this.options.pickerOption&&ta.widgets.calendar.getPageInDate()&&(this.options.flights?(o=new Date,ta.util.date.normalize(o),o.setDate(o.getDate()+ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT)):(o=new Date(ta.widgets.calendar.getPageInDate()),o.setDate(o.getDate()+ta.util.date.MAX_STAY_DURATION_DAYS)));var g=r;ta.retrieve("thai_buddhist_era_year")&&(g+=ta.util.date.THAI_BUDDHIST_YEAR_OFFSET),h.push('<table cellspacing="0" cellpadding="0" border="0"><thead><tr><th class="caption" colspan="7">'),h.push(this.options.monthHeadingFormat.replace(/MMM/,jsGlobalMonths[l]).replace(/YYYY/,g)),h.push("</th></tr><tr>");for(var D=0;D<jsGlobalDaysShort.length;D++)h.push("<th>"),h.push(this.options.dayNames?jsGlobalDaysAbbrev[D]:jsGlobalDaysShort[D]),h.push("</th>");h.push("</tr></thead><tbody><tr>");for(var f=0,D=0;D<s;D++)h.push('<td class="other">&nbsp;</td>'),f++;s--;var m=0,v=ta.util.date.DAYS_IN_MONTH[e.date.getMonth()];1==e.date.getMonth()&&e.date.getYear()%4==0&&(v+=1);for(;m<v;){s=(s+1)%7,m++,i.setDate(m);var M=m,y=null,w=this.getHolidays(this.options.holidaysOnCalendar,r,l,m);if(this.options.includeTodayInRange)var T=!(i<=this.options.firstDate||i>this.options.lastDate||o&&i>o);else var T=!(i<this.options.firstDate||i>this.options.lastDate||o&&i>o);var O=!this.isInvalidDate(i),_=this.options.choiceLink,C=!(this.selectedDate&&this.selectedDate.getTime()<i.getTime()||c&&c.getTime()<i.getTime());if(this.options.formatter){this.options.selectedDay=u,this.options.otherDate=c;var x=this.options.formatter.call(this,i,T,O,s,this.options);y=x.cname,M=x.contents,_=x.link||_}else O?m==p?m==u||c&&i.getTime()===c.getTime()?(y="today selected "+(C?"start":"end"),C=!C,this.selectedDate&&c&&(y+=" rngDt")):y=T?"today":"today disabled":m==u||c&&i.getTime()===c.getTime()?(y="selected "+(C?"start":"end"),C=!C,this.selectedDate&&c&&(y+=" rngDt")):this.selectedDate&&c&&(this.selectedDate.getTime()<i.getTime()&&i.getTime()<c.getTime()||this.selectedDate.getTime()>i.getTime()&&i.getTime()>c.getTime())&&(y="rngDt"):y="invalid";if(this.options.indicateTurnoverDays&&(O?(0==this.prevDayValid&&(y?y+=" depart":y="depart"),this.prevDayValid=1):(1==this.prevDayValid&&(y?y+=" arrive":y="arrive"),this.prevDayValid=0),T||(this.prevDayValid=-1)),0==s&&h.push("</tr><tr>"),!T||this.options.treatInvalidAsOutOfRange&&!O)h.push('<td class="'),h.push(y||"disabled"),h.push('">'),w?h.push(w):h.push(M||m),h.push("</td>");else{if(this.options.singleSelect){var S=this.date;S&&S.getDate()==m&&S.getMonth()==l&&(y+=" selected")}var b=this.addCustomDayStyleString(_,r,e,m,i,M);b&&(y+=b),y?(h.push('<td class="'),h.push(y),h.push('">')):h.push("<td>"),h.push(this.buildDayAnchorTag(_,r,l,m,M,i)),h.push("</td>")}}for(;++s<7;)h.push("<td class='other'>&nbsp;</td>"),f++;if(this.options.stableTableHeight)for(;v+f<42;){h.push("</tr><tr>");var D=0;for(D=0;D<7;D++)h.push("<td class='other'>&nbsp;</td>"),f++}return h.push("</tr></tbody></table>"),e.elmt=new Element("div",{"class":"month"}).set("html",h.join("")),e},addCustomDayStyleS,n){},buildDayAnchorTag:function(t,e,i,s,a,n){var o=[];return this.options.useLinks&&t?(ta.has("checkrates.add_holding_windows")?o.push('<a href="javascript:void(0);" class="no_cpu" ondragstart="return false;" onclick="'):o.push('<a href="javascript:void(0);" ondragstart="return false;" onclick="'),o.push(t),o.push("(event,"),o.push(e),o.push(","),o.push(i),o.push(","),o.push(s),o.push(',this)"'),this.options.dayMouseOver&&(o.push(' onmouseover="'),o.push(this.options.dayMouseOver),o.push("(event,"),o.push(e),o.push(","),o.push(i),o.push(","),o.push(s),o.push(',this)"')),this.options.dayMouseOut&&(o.push(' onmouseout="'),o.push(this.options.dayMouseOut),o.push("(event,"),o.push('this)"')),o.push(">"),o.push(a),o.push("</a>")):o.push(a),o.join("")},isInvalidDate:function(t){return ta.util.date.inDateSet(t,this.options.invalidDates)},isValid:function(){return!this.selectedDate||this.selectedDate.getTime()>=this.options.firstDate.getTime()&&this.selectedDate.getTime()<=this.options.lastDate.getTime()},prev:function(){if(!this.animating){var t=this.options.dualCalendar;this.animating=!0;var e=new Date(this.currentMonth.date),i=e.getMonth()-1;i<0&&(i+=12,e.setFullYear(e.getFullYear()-1));var s=e.getDate();s>ta.util.date.DAYS_IN_MONTH[i]&&(s=ta.util.date.DAYS_IN_MONTH[i]),e.setMonth(i,s);var a=this.currentMonth.elmt.getCoordinates().width,n=a+(t?this.nextMonth.elmt.getCoordinates().width:0),o=this.createMonth(e);ta.util.i18n.isRtl()?o.elmt.style.left=n+"px":o.elmt.style.left="-"+a+"px",this.injectMonth(o.elmt,!0);var h,r=this.container.getElements("div.month");ta.util.i18n.isRtl()?(h={0:{left:[0,-a]},1:{left:[a+this.options.offsetOther,0]}},t&&(h[2]={left:[2*a+this.options.offsetOther,a+this.options.offsetOther]})):(h={0:{left:[-a,0]},1:{left:[0,a+this.options.offsetOther]}},t&&(h[2]={left:[a+this.options.offsetOther,2*a+this.options.offsetOther]}));var l=new Fx.Elements(r,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.nextMonth||this.currentMonth),duration:this.options.monthChangeDuration});t&&(this.nextMonth=this.currentMonth),this.currentMonth=o,this.updatePrevNext(),l.start(h)}},next:function(){if(!this.animating){var t=this.options.dualCalendar;this.animating=!0;var e=new Date(this.currentMonth.date),i=e.getMonth()+(t?2:1);i>11&&(i-=12,e.setFullYear(e.getFullYear()+1));var s=e.getDate();s>ta.util.date.DAYS_IN_MONTH[i]&&(s=ta.util.date.DAYS_IN_MONTH[i]),e.setMonth(i,s);var a=this.currentMonth.elmt.getCoordinates().width,n=a+(t?this.nextMonth.elmt.getCoordinates().width:0),o=this.createMonth(e);ta.util.i18n.isRtl()?o.elmt.style.left="-"+a+"px":o.elmt.style.left=n+"px",this.injectMonth(o.elmt,!1);var h,r=this.container.getElements("div.month");ta.util.i18n.isRtl()?(h={0:{left:[-a,0]},1:{left:[0,a+this.options.offsetOther]}},t&&(h[2]={left:[a+this.options.offsetOther,2*a+this.options.offsetOther]})):(h={0:{left:[0,-a]},1:{left:[a+this.options.offsetOther,0]}},t&&(h[2]={left:[2*a+this.options.offsetOther,a+this.options.offsetOther]}));var l=new Fx.Elements(r,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.currentMonth),duration:this.options.monthChangeDuration});t?(this.currentMonth=this.nextMonth,this.nextMonth=o):this.currentMonth=o,this.updatePrevNext(),l.start(h)}},removese()},doneAnimating:function(t,e){this.removeTable(t,e),this.animating=!1},select:function(t,e){this.selectedDate=e,this.fireEvent("onSelect",[this,t])},clear:function(t){this.selectedDate=null,this.fireEvent("onClear",[this,t])},nearbyMonth:function(t,e){var i=t+e;return i>11?i-=12:i<0&&(i+=12),i},getCreatorElElem}});
!function(){ta.widgets.SingleDateCalendar=new Class({Extends:ta.widgets.Calendar,Implements:[Options,Events],Binds:["onOutDateCalShow","updateInputStyling","updateDualDateInputStyling","showCalendarOverlay","setPositionElement","hashHack","getCalendarTopOffset","getCalendarLeftOffset","callOnSelect","setPageDates","getPageInDate","getPageOutDate"],options:{singleSelect:!0,pickerOption:"in",autoAdvance:!0,dualCalendar:!0,dayMouseOver:"ta.widgets.calendar.calendarMouseOver",choiceLink:"ta.widgets.calendar.calendarMultiSelect",prevAction:"ta.widgets.calendar.calendarPrev",nextAction:"ta.widgets.calendar.calendarNext",selectedHoverClass:"rngDt",previousSelectedClass:"prevSel",inDateClass:"inDate",outDateClass:"outDate",selectionStartClass:!1,selectionEndClass:!1,captureKeyEvents:!0,autoShow:!1,displayCalendarInOverlay:!0,formatter:ta.widgets.calendar.multiDateFormatter,monthChangeDuration:150,submitOnEnter:!0,useClassicSkin:!1,classicStyling:!1},inDate:!1,newInDate:!1,oldInDate:!1,startRangeElem:!1,outDate:!1,oneSelected:!1,monthOffset:0,initialize:function(t,e,a,i,s){if(this.isIn=s,this.parent(t,this.input),this.crId=e,this.setPositionElement(),"function"==typeof a&&(this.onSelect=a.bind(this)),this.argArray=i,this.options.displayCalendarInOverlay){var n=this.onCalendarOverlayShow.bind(this),r=this.onCalendarOverlayHide.bind(this),o=this.onCalendarOverlayShow.bind(this),l=this.positionElement.getParent(".overlay");l&&(this.parentOverlay=l.overlay);var d=ta.overlays.ACTIVATE_CLICK,h=this.options.offsetLeft?this.options.offsetLeft:this.getCalendarLeftOffset(),c=this.options.offsetTop?this.options.offsetTop:this.getCalendarTopOffset(),g="date_picker_calendar";this.options.useClassicSkin&&(g="typeO"),this.options.classicStyling&&(g+=" classicStyling"),this.options.oneWayStyling&&(g+=" oneWayStyling"),this.options.dualCalendar||(g+=" singleWidth"),ta.widgets.calendar.hasPageDates()||(g+=" predates");var p=ta.overlays.BACKDROP_NEVER,u=.6,v=null,m=ta.overlays.RelativeOverlayBelow,f={style:g,noPadding:!0,autoShow:!1,noCpu:!0,backdrop:p,backdropOpacity:u,onBackdropClick:v,offsetLeft:h,offsetTop:c,activate:d,onShow:n,onHide:r,onFocus:o,zIndex:1001,showCloseButton:!1,parentContainer:this.options.parentContainer,fontSize:this.options.fontSize};if(ta.has("sd_datepicker_focus")&&(f.zIndex=10001),t&&t.isGuestsRoomsCalendar&&(f.useTransparentOverlayPadding=!0,f.transparentOverlayPaddingValue=80),ta.isTabletAlbumViewer()||ta.retrieve("tablet_maps_v1")){var D=document.getElement(".footerPocketWithInsert");if(D&&D.isVisible()){this.positionElement&&this.positionElement.getParent(".footerPocketWithInsert")?f.parentContainer=D:f.positionType="fixed";var E=f.onShow;f.onShow=function(t){E&&E(t),window.addEvent("orientationchange",this.hide)};var y=f.onHide;f.onHide=function(t){y&&y(t),window.removeEvent("orientationchange",this.hide)}}}this.calendarOverlay=new m(f,this.positionElement);var C=ta.id(this.positionElement).getParent();C&&C.hasClass("date_picker_calendar_wrap")&&(C.onclick=function(){},ta.id(this.positionElement).removeEvents("click"),ta.id(this.positionElement).getParent().addEvent("click",this.showCalendarOverlay.bind(this))),C&&!window.tabletOnFullSite&&C.addEvent("focus",this.showCalendarOverlay.bind(this)),this.outDateField&&(ta.id(this.outDateField).getParent().onclick=function(){},ta.id(this.outDateField).getParent().addEvent("click",this.onOutDateCalShow.bind(this)),window.tabletOnFullSite||ta.id(this.outDateField).getParent().addEvent("focus",this.onOutDateCalShow.bind(this))),this.calendarOverlay.inner.adopt(this.container),this.calendarOverlay.calendar=this,this.calendarOverlay.container.addEvent("click",function(t){(t||window.event)&&(t=new Event(t||window.event),t.stopPropagation())}),this.update(),this.reposition()}var S=this.onDocumentClick.bind(this);document.addEvent("click",S)},addCustomDayStyleString:function(t,e,a,i,s,n){var r="",o=this.getPageInDate(),l=this.getPageOutDate(),d="";if(o&&l&&(d=" prevSel inDate_DP7",s.getTime()>o.getTime()&&s.getTime()<l.getTime()&&(r+=" prevSel")),o&&a.date.getMonth()==o.getMonth()&&i==o.getDate()&&(r=r+" inDate start"+d),l&&a.date.getMonth()==l.getMonth()&&i==l.getDate()&&(r=r+" inDate end"+d),ta.retrieve("cal_xsell")&&(this.today.getMonth()==s.getMonth()||(this.today.getMonth()+1)%12==s.getMonth())){var h=ta.util.date.getDaysInRange(this.today,s)-1;this.isIn||(h-=1);var c=ta.retrieve("cal_xsell");if(h>=0&&h<c.availability.length){var g=c.availability[h];g||(r+=" calXSellUnAvail")}}return r},buildDayAnchorTag:function(t,e,a,i,s,n){var r=[],o=this.getHolidays(this.options.holidaysOnCalendar,e,a,i);return this.options.useLinks&&t?(ta.has("checkrates.add_holding_windows")?r.push('<div href="javascript:void(0);" class="day no_cpu'):r.push('<div href="javascript:void(0);" class="day'),o&&r.push(" hld"),r.push(" day_"+i),r.push('" onclick="'),r.push(t),r.push("(event,"),r.push(e),r.push(","),r.push(a),r.push(","),r.push(i),r.push(',this)"'),window.FastClick&&(r.push(' ontouchend="'),r.push(t),r.push("(event,"),r.push(e),r.push(","),r.push(a),r.push(","),r.push(i),r.push(',this)"')),this.options.dayMouseOver&&(r.push(' onmouseover="'),r.push(this.options.dayMouseOver),r.push("(event,"),r.push(e),r.push(","),r.push(a),r.push(","),r.push(i),r.push(',this)"')),r.push(' value="'),r.push(n.valueOf()),r.push('"'),r.push(">"),o?r.push(o):r.push(s),r.push("</div>")):r.push(s),r.join("")},callOnSelect:function(){this.onSelect&&(this.fireEvent("onChangeDates"),this.argArray&&this.argArray.length>0?this.onSelect.apply(this,this.argArray):(this.onSelect.call(this,this.crId,this.positionElement),ta.has("guests_rooms_picker_3.enabled")&&ta.store("calendarClosedByDocClick",!1)))},clear:function(t){if(this.date=null,ta.widgets.calendar.clearPageDates(),this.positionElement&&(!this.positionElement.hasClass("tab0")||!this.positionElement.hasClass("header_tab"))){var e="";e=this.isIn?this.options.classicDateFormat&&"undefined"!=typeof JS_DateFormat?JS_DateFormat:ta.retrieve("multiDP.checkIn"):this.options.classicDateFormat&&"undefined"!=typeof JS_DateFormat?JS_DateFormat:ta.retrieve("multiDP.checkOut"),this.positionElement.innerHTML=e}this.fireEvent("onClear",[this,t]),this.calendarOverlay&&this.calendarOverlay.hide()},clearPrevSelectedDays:function(){this.calendarTop||(this.calendarTop=this.calendarOverlay.container.getElement(".calendar"));var t=this.calendarTop.getElements("td."+this.options.previousSelectedClass);t.removeClass(this.options.previousSelectedClass),this.options.selectionStartClass&&t.removeClass(this.options.selectionStartClass),this.options.selectionEndClass&&t.removeClass(this.options.selectionEndClass)},clearSelectedDays:function(){this.calendarTop||(this.calendarTop=this.calendarOverlay.container.getElement(".calendar"));var t=this.calendarTop.getElements("td."+this.options.selectedHoverClass);t.removeClass(this.options.selectedHoverClass),this.options.selectionStartClass&&t.removeClass(this.options.selectionStartClass),this.options.selectionEndClass&&t.removeClass(this.options.selectionEndClass)},createPagingElan>'},dayOver:function(t,e,a){return ta.util.date.normalize(e),this.oneSelected?(this.hoverDay=e,void this.updateSelectedDays(e,a)):void this.updateHoverElem(a)},ensureValidDates:function(){var t=this.getPageInDate(),e=this.getPageOutDate();if(this.options.firstDate&&t&&t<this.options.firstDate){ta.util.date.normalize(this.options.firstDate),t=this.options.firstDate,ta.widgets.calendar.setPageInDate(t),this.bypassSecondCal=!0;var a=ta.widgets.calendar.getDateAfter(t);e&&e<a&&(e=a,ta.widgets.calendar.setPageOutDate(e))}e&&!t&&(t=ta.widgets.calendar.getDateBefore(e)),t&&!e&&(e=ta.widgets.calendar.getDateAfter(t)),ta.widgets.calendar.setPageInDate(t),ta.widgets.calendar.setPageOutDate(e)},focusOtherCalendar:function(){var t;t=this.isIn?ta.widgets.calendar.getPageOutCalendarField(this.crId,this.options.ext):ta.widgets.calendar.getPageInCalendarField(this.crId,this.options.ext);var e=document.getElement("#PERSISTENT_DATE_PICKER:not(.hidden)")||document;if(null===t&&ta.has("guests_rooms_picker_3.enabled")&&(t=this.isIn?e.getElement(".stayInfoHeaderDateTrigger.outDateTrigger"):e.getElement(".stayInfoHeader.inDateTrigger")),t)if(t.click)ta.store("overlay.dontCloseOnClick",!0),t.click(),ta.store("overlay.dontCloseOnClick",!1);else if(document.createEvent&&t.dispatchEvent){var a=document.createEvent("MouseEvent");a.initEvent("click",!0,!0),t.dispatchEvent(a)}},getCalendarLeftOffset:function(){var t=1;return ta.util.i18n.isRtl()&&(t=127),ta.isMetaHomepageIntegration2013()&&(t=2,ta.util.i18n.isRtl()&&(t=121)),ta.retrieve("ta.calendar.isOutDateTrigger")&&ta.retrieve("ta.calendar.isPriceOverlayCalendar")&&(t=138),ta.has("hotels_left_filters_redesign")?0:t},getCalendarTopOffset:function(){return ta.has("hotels_left_filters_redesign")?-7:ta.isMetaHomepageIntegration2013()?-1:-4},getFirstDate:function(){var t=this.getPageInDate(),e=this.getPageOutDate();if(this.options.multiCityFlight&&this.crId>1)return ta.widgets.calendar.lastDateBefore(this.options,this.crId);if(this.isSecondCalShown()){if(!this.isIn&&t)return t;if(this.isIn&&e)return e}else{if(this.isIn&&t)return t;if(!this.isIn&&e)return e}return this.today},getPageInDate:function(){return ta.widgets.calendar.getPageInDate()},getPageOutDate:function(){return ta.widgets.calendar.getPageOutDate()},getState:function(){var t=this.inDate,e=this.outDate,a={};return t instanceof Date&&Object.append(a,{"inMonth":t.getMonth()+1+" "+t.getFullYear(),"inDay":t.getDate()}),e instanceof Date&&Object.append(a,{"outMonth":e.getMonth()+1+" "+e.getFullYear(),"outDay":e.getDate()}),a},hashHack:function(){var t=ta.id(this.positionElement).get("id");t&&(t=t.substring(t.length-3,t.length),"olb"!=t&&"bin"!=t&&"som"!=t||(window.location.hash=" ",window.location.hash="#MetaPricesTab"))},includeElemIn "+e},isSecondCalShown:function(){if(!this.options.autoAdvance)return!0;var t=ta.widgets.calendar.inOutCalendarSelected(!this.isIn);return t},isValidDateElem:function(t){if(!t||"TD"!=t.tagName)return!1;var e=t.className;return!e.match(/other/)&&!e.match(/disabled/)},initTracking:function(){if(!ta.remove("meta.datepicker_tracked")){var t=ta.id(this.positionElement).get("id")||this.options.ext||"_owl",e=t.indexOf("_persist")>0;t=t.substring(t.length-3,t.length);var a=this.isIn?"CheckIn|":"CheckOut|";switch(e&&(a+="Persistent|"),ta.retrieve("cal_xsell")&&(a+="CalXSell|"),t){case"pto":a+="PHOTOS_LIGHTBOX";break;case"amo":a+="AMENITIES_LIGHTBOX";break;case"pop":a+="DHTML_FLYOUT";break;case"cro":a+="CalendarLightbox";break;case"inm":a+="DATES_INLINE|Tabs",ta.store("isPricesTabDatePicker",!0);break;case"bin":a+="DATES_INLINE_FLEXIBLE";break;case"met":a+="DATES_LIGHTBOX";break;case"olb":a+="DATES_LIGHTBOX_FLEXIBLE";break;case"som":a+="DATES_State-Optimized-Modal_FLEXIBLE";break;case"cmp":a+="footer";break;case"hpt":a+="HOMEPAGE_PYPT";break;case"thc":a+="HAC_TOURISM";break;case"gnv":a+="GLOBAL_NAV";break;case"ond":a+="RoomTab";break;default:a+="DATES"}var i=this.getTrackingPrefix()+ta.widgets.calendar.getTrackingString();ta.widgets.calendar.trackCalendarEvent(i,"OPEN",a),ta.store("multiDP.trackString",!1)}},singleDaySelect:function(t,e,a){if(t&&new Event(t).stop(),ta.util.date.normalize(e),e&&e.getTime){this.date=e;var i=new Date(e);if(i.increment("week",1),this.options.flights){var s=(new Date).increment("day",ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT);i>s&&(i=s)}this.setPageDates(e,i),this.closedByDocOrDateClick=!0,this.bypassSecondCal=!0;var n=ta.widgets.calendar.getDatePickerFormat("classic");e=ta.widgets.calendar.dateToString(e,n);var r=ta.id(a).getParent(".overlay");r.overlay.calendar.options.creatorElem.innerHTML=e,this.calendarOverlay&&this.calendarOverlay.hide()}},multiCitySelect:function(t,e,a){if(t&&new Event(t).stop(),ta.util.date.normalize(e),e&&e.getTime){var i=ta.widgets.calendar.getDatePickerFormat("classic"),s=ta.id(a).getParent(".overlay"),n=2;if(s.overlay.calendar.crId===n){var r=void 0;if("undefined"!=typeof NE&&(r=new Date(e),r.increment("week",1),this.options.flights)){var o=(new Date).increment("day",ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT);r>o&&(r=o)}this.setPageDates(e,r),this.closedByDocOrDateClick=!0,this.bypassSecondCal=!0}if("undefined"!=typeof NE)NE.checkMultiCityFields(s.overlay.calendar.crId,e);else for(var l=parseInt(s.overlay.calendar.crId),d=4,h=l;h<=d+1;h++)if(ta.id("date_picker_in_"+h)&&ta.id("date_picker_in_"+h).innerHTML.length>1){var c=ta.widgets.calendar.dateFromString(ta.id("date_picker_in_"+h).innerHTML);e>c&&(ta.id("date_picker_in_"+h).innerHTML="")}e=ta.widgets.calendar.dateToString(e,i),s.overlay.calendar.options.creatorElem.innerHTML=e,this.calendarOverlay&&this.calendarOverlay.hide()}},multiSelect:function(t,e,a){if(t&&new Event(t).stop(),ta.util.date.normalize(e),e&&e.getTime){this.date=e;var i=null,s=null;i=this.getPageInDate(),s=this.getPageOutDate();var n=!i&&!s;this.closedByDocOrDateClick=!0;var r=!1;!ta.widgets.calendar.getPageInDate()&&!ta.widgets.calendar.getPageOutDate()||ta.retrieve("enteredDatesInPreDates")&&!ta.widgets.calendar.hasPageDates()?ta.store("enteredDatesInPreDates",!0):ta.store("enteredDatesInPreDates",!1);var o=!ta.has("hotels_left_filters_redesign")&&ta.has("guests_rooms_picker_3.enabled")&&this.isIn;if(o&&!n)ta.widgets.calendar.cancelAllExistingHAC(),this.bypassSecondCal=!1,this.isIn?(i=e,s&&e.getTime()>=s.getTime()&&(s=!1,r=!0,ta.widgets.calendar.clearPageOutDate(this.crId,this.options.ext),ta.widgets.calendar.removeInOutCalendarSelected(!1)),s||(e.getDate()<=23?ta.store("datepicker_autoadvance_fday",this.currentMonth.date):ta.remove("datepicker_autoadvance_fday"))):(s=e,i&&e.getTime()<(new Date).getTime()?(i=new Date,s=ta.widgets.calendar.getDateAfter(i)):i&&e.getTime()<=i.getTime()?(i=!1,r=!0,ta.widgets.calendar.clearPageInDate(this.crId,this.options.ext),ta.widgets.calendar.removeInOutCalendarSelected(!0)):i&&(ta.widgets.calendar.trackInOutCalendarSelected(!0),this.bypassSecondCal=!0));else if(this.isIn){var l=s&&e.getTime()==s.getTime()&&!this.options.flights;s&&(e.getTime()>s.getTime()||l)?(i=this.date,s=!1,r=!0,ta.widgets.calendar.clearPageOutDate(this.crId,this.options.ext)):(i=e,s&&(this.bypassSecondCal=!0))}else{var l=i&&e.getTime()==i.getTime()&&!this.options.flights;i&&e.getTime()<(new Date).getTime()?(i=new Date,s=ta.widgets.calendar.getDateAfter(i)):i&&(e.getTime()<i.getTime()||l)?(s=this.date,i=!1,r=!0,ta.widgets.calendar.clearPageInDate(this.crId,this.options.ext)):(s=e,i&&(this.bypassSecondCal=!0))}this.inDate=i,this.outDate=s,ta.has("guests_rooms_picker_3.enabled")&&this.setPredatesState(),this.setPageDates(i,s),ta.has("guests_rooms_picker_3.enabled")&&ta.widgets.calendar.hasPageDates()&&(ta.widgets.calendar.syncAllDatePickers(),ta.commerce.meta.updateHeaderDates()),this.hoverDay=!1,this.bypassSecondCal||this.getPageOutDate()&&this.getPageInDate()||r||(this.bypassSecondCal=!0),this.updateNumNights(),this.calendarOverlay&&this.calendarOverlay.hide(),!this.bypassSecondCal||n||this.getPageInDate()&&this.getPageOutDate()||(this.bypassSecondCal=!1),ta.overlays.Factory.destroyAnimatedDateCTA(),!this.isSecondCalShown()&&!this.bypassSecondCal||n&&ta.retrieve("metaUI.isMetaCalendarAutoadvancePredates")?(ta.widgets.calendar.trackInOutCalendarSelected(this.isIn),this.focusOtherCalendar()):this.hashHack(),this.removeErrorState(),this.getPageInDate()&&this.getPageOutDate()&&this.fireEvent("onRangeSelect",[this.crId,this.options.ext]),this.fireEvent("onSelect",[this,t])}},next:function(){this.parent(),this.resetStartRangeElem(!0);var t=this.currentMonth&&this.currentMonth.date?this.currentMonth.date.get("month"):"";ta.trackEventOnPage("DATEPICKER","NEXT_MONTH",this.isIn?"Checkin":"Checkout",t)},onCalendarOverlayKeyDown:function(t){if(this.options.submitOnEnter&&"enter"===t.key&&ta.isMetaHomepageIntegration2013()){var e=this.positionElement.getParent("form "),a="function"!=typeof this.options.submitOnEnter||this.options.submitOnEnter(t,e);a?e&&e.submit():this.calendarOverlay.hide()}("esc"==t.key||ta.isMetaHomepageIntegration2013()&&!ta.retrieve("freeform_datepicker")&&"tab"==t.key)&&this.calendarOverlay.hide()},onCalendarOverlayHide:function(t){(this.isSecondCalShown()||ta.widgets.calendar.hasPageDates())&&this.ensureValidDates(),ta.widgets.calendar.syncAllDatePickers(),this.parentOverlay&&this.tempPin&&(this.tempPin=!1,this.parentOverlay.unpin()),this.options.captureKeyEvents&&this.keyEventListener&&document.removeEvent("keydown",this.keyEventListener),this.updateInputStyling(!1);var e=this.getPageInDate(),a=this.getPageOutDate(),i=e&&e.getDate&&a&&a.getDate;this.isSecondCalShown()&&i&&(this.bypassSecondCal=!0);var s=!1;if((this.shouldFireOnSelect()||this.bypassSecondCal||this.closedByDoc&&ta.has("guests_rooms_picker_3.enabled"))&&i&&this.closedByDocOrDateClick){var n=!1;this.closedByDoc&&ta.has("guests_rooms_picker_3.enabled")&&(ta.store("calendarClosedByDocClick",!0),n=!0),this.fireEvent("onChangeDates"),n&&this.fireEvent("onRangeSelect",[this.crId,this.options.ext]),this.callOnSelect(),this.trackSelect(!0),ta.retrieve("ta.calendar.isPriceOverlayCalendar")&&(s=!0),ta.commerce.persistentdatepicker&&ta.commerce.persistentdatepicker.update()}else this.closedByDoc||this.trackSelect(!1);this.resetFireOnSelectCriteria&&this.isSecondCalShown()&&this.closedByDocOrDateClick&&this.resetFireOnSelectCriteria(),s&&this.parentOverlay.hide(),ta.has("guests_rooms_picker_3.enabled")&&!ta.has("hotels_left_filters_redesign")&&i&&ta.widgets.calendar.displayStayInfoPicker()},onCalendarOverlayShow:function(){if(ta.widgets.calendar.storePriorDates(),this.inDate=this.getPageInDate(),this.outDate=this.getPageOutDate(),this.cursorLeftInitSel=!1,this.bypassSecondCal=!1,this.date=this.isIn?this.getPageInDate():this.getPageOutDate(),ta.has("guests_rooms_picker_3.enabled")&&(this.setPredatesState(),ta.widgets.calendar.updateGuestsRoomsPickerUI()),this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK&&(this.tempPin=!this.parentOverlay.pinned,this.tempPin&&this.parentOverlay.pin()),this.update(),this.reposition(),this.closedByDocOrDateClick=!1,this.closedByDoc=!1,ta.id(this.positionElement).getParent("#PERSISTENT_DATE_PICKER, #STATIC_DATE_PICKER_BAR.sticky"))ta.commerce.persistentdatepicker&&ta.commerce.persistentdatepicker.initCalendar(this);else if(ta.id(this.positionElement).getParent("#PERSISTENT_CHECK_RATES")){var t=ta.id(this.positionElement).getCoordinates().top+29;"undefined"!=typeof isIPad&&isIPad||(t-=window.getScrollTop()),ta.id(this.calendarOverlay.container).setStyles({"position":"fixed","top":t,"zindex":9997})}else ta.id(this.calendarOverlay.container).setStyle("position","absolute");if(this.options.captureKeyEvents)try{this.keyEventListener=this.onCalendarOverlayKeyDown.bind(this),document.addEvent("keydown",this.keyEventListener)}catch(t){}ta.id(this.positionElement).removeClass("date_picker_error"),this.positionElement.blur(),this.initTracking(),this.updateInputStyling(!0),window.fireEvent("onCalendarOverlayShow",this)},onDocumentc=!0},onOutDateCalShow:function(t){ta.store("ta.calendar.isOutDateTrigger",!0),this.calendarOverlay.show(t)},prev:function(){this.parent(),this.resetStartRangeElem(!1);var t=this.currentMonth&&this.currentMonth.date?this.currentMonth.date.get("month"):"";ta.trackEventOnPage("DATEPICKER","PREV_MONTH",this.isIn?"Checkin":"Checkout",t)},removeErrorState:function(){ta.id("NO_DATES_ERROR")&&ta.id("NO_DATES_ERROR").hide(),ta.id("calPnt")&&ta.id("calPnt").removeClass("errorState");var t=ta.find("#CHECK_RATES_CONT .date_picker_calendar_wrap");t&&t.removeClass("errorState")},resetDatepickerOnHover:function(){var t=this.getPageInDate(),e=this.getPageOutDate(),a=this.positionElement;this.isIn||(a=a.id.replace("date_picker_out","date_picker_in"),a&&(a=ta.id(a))),ta.widgets.calendar.updateDateDisplay(a,t,e),this.updateHoverElem(),t&&(t=t.valueOf()),e&&(e=e.valueOf());var i=document.getElements(".date_picker_calendar.overlay .calendar .today"),s=document.getElements(".date_picker_calendar.overlay .calendar .day");s.forEach(function(a){var i=a.getAttribute("value");i&&(i=parseInt(i),a=a.getParent(),a.className="",t&&t==i?a.addClass("start"):e&&e==i&&a.addClass("end"),t&&e&&t<=i&&i<=e&&a.addClass("prevSel"))}.bind(this)),i.addClass("today")},resetFireOnSelectCriteria:function(){ta.widgets.calendar.removeInOutCalendarSelected(this.isIn),ta.widgets.calendar.removeInOutCalendarSelected(!this.isIn)},resetStartRangeElem:function(t){if(this.oneSelected){this.startRangeElem=!1,this.clearSelectedDays(),ta.util.i18n.isRtl()&&(t=!t),t?this.monthOffset++:this.monthOffset--;var e=this.calendarOverlay.container.getElements(".month");if(t?e.shift():e.pop(),e.some(function(t,e){if(t){var a=ta.id(t).getElement("."+this.options.inDateClass);if(a)return this.startRangeElem=a,!0}return!1},this),!this.startRangeElem){var a=!1;if(this.monthOffset>0){var i=0;a=ta.id(e[i]).getElements("td"),ta.util.i18n.isRtl()&&a.reverse()}else{var s=e.length-1;a=ta.id(e[s]).getElements("td"),ta.util.i18n.isRtl()||a.reverse()}a&&a.some(function(t,e){return!!this.isValidDateElem(t)&&(this.startRangeElem=t,!0)},this)}}},selectLeftRightButtons:function(){var t={};return this.options.useClassicSkin?(t.leftIdle="classicLeftBtn",t.leftInactive="",t.rightIdle="classicRightBtn",t.rightInactive=""):(t.leftIdle="sprite-date_picker-btnLeftIdle",t.leftInactive="sprite-date_picker-btnLeftInactive",t.rightIdle="sprite-date_picker-btnRightIdle",t.rightInactive="sprite-date_picker-btnRightInactive"),t},setPageDates:function(t,e){ta.widgets.calendar.storePriorDates(),t&&ta.widgets.calendar.setPageInDate(t),e&&ta.widgets.calendar.setPageOutDate(e)},setPermanentFalse:function(){this.calendarOverlay&&(this.calendarOverlay.options.permanent=!1,this.calendarOverlay.options.pinnable=ta.overlays.PINNABLE_NEVER)},setPositionElement:function(){if(!ta.has("guests_rooms_picker_3.enabled")||ta.has("guests_rooms_picker_4.enabled")||ta.has("hotels_rgpicker_outofcalendar")||ta.has("hotels_left_filters_redesign")||!this.options.creatorElem||this.options.creatorElem.getParent(".geoChkRates")||this.options.creatorElem.getParent("#PERSISTENT_DATE_PICKER")||!(this.options.creatorElem.getParent(".filterControls")||this.options.creatorElem.getParent(".jfy_header_dates_holder")||this.options.creatorElem.getParent(".meta_chevron_module_2014")||this.options.creatorElem.getParent("#HotelDateSearch")||this.options.creatorElem.getParent(".baseHotelInfoLeft"))){var t="date_picker_in_";this.isIn||(t="date_picker_out_"),this.positionElement=ta.id(t+this.crId+this.options.ext),!this.positionElement&&this.options.creatorElem.getParent("#PERSISTENT_DATE_PICKER")&&(this.positionElement=$$("#PERSISTENT_DATE_PICKER .bestPricesMsg")[0])}else this.positionElement=$$(".miniMetaShowHdr")[0],this.positionElement&&this.positionElement.isVisible()||(this.positionElement=$$(".hr_pre_date_minimalist .title")[0]),this.positionElement&&this.positionElement.isVisible()||(this.positionElement=$$(".legend.metaDatesChosen")[0]),this.positionElement&&this.positionElement.isVisible()||(this.positionElement=$$(".ShowUserReviews #DATE_FIELDS")[0]),this.positionElement&&this.positionElement.isVisible()||(this.positionElement=$$(".p13n_header_tab_wrap .tab0")[0]),this.positionElement&&this.positionElement.isVisible()||(this.positionElement=$$("#STYLE2HEADER_V3 h1")[0]),this.positionElement&&this.positionElement.isVisible()||(this.positionElement=$$("#HLDatesHeader")[0]),this.positionElement&&this.positionElement.isVisible()||(this.positionElement=$$(".change_dates_button")[0],this.positionElement&&this.positionElement.isVisible()||(this.positionElement=$$(".changeStayInfoButton")[0]));this.positionElement||ta.util.error.record(null,"ta.widgets.SingleDateCalendar.setPositionElement - this.positionElement is undefined",null,{},"WARN")},setPredatesState:function(){this.inDate&&this.outDate?this.calendarOverlay.container.removeClass("predates"):this.calendarOverlay.container.addClass("predates")},shouldFireOnSelect:function(){return!!this.onSelect&&(this.isSecondCalShown()&&this.calendarOverlay&&this.calendarOverlay.closedByDocClick)},showCalendarOverlay:function(t){this.calendarOverlay&&(this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")&&(this.calendarOverlay.options.activate=ta.overlays.ACTIVATE_CLICK),this.calendarOverlay.show(t),ta.fireEvent("calendarShown"))},trackSelect:function(t){var e=ta.id(this.positionElement).get("id");if(!e){var a="date_picker_in_";this.isIn||(a="date_picker_out_"),e=a+this.crId+this.options.ext}var i=e.indexOf("_persist")>0;e=e.substring(e.length-3,e.length);var s="START",n="DATES",r=-1;if("ond"==e&&(n="RoomTab"),t)if(s="SELECT",ta.retrieve("ta.calendar.isPriceOverlayCalendar"))n="PRICE_CALENDAR";else if(this.inDate&&this.outDate){var o=ta.util.date.getDaysInRange(this.inDate,this.outDate)-1;o>ta.util.date.MAX_STAY_DURATION_DAYS&&(n="DATES_OVER_30_DAYS")}this.isIn&&this.today&&this.inDate?r=ta.util.date.getDaysInRange(this.today,this.inDate)-1:!this.isIn&&this.inDate&&this.outDate&&(r=ta.util.date.getDaysInRange(this.inDate,this.outDate)-1),ta.retrieve("cal_xsell")&&(n="CalXSell"),n&&(n="|"+n),i&&(n="|Persistent"+n),ta.retrieve("isPricesTabDatePicker")&&(ta.remove("isPricesTabDatePicker"),n+="|Tabs"),n=this.isIn?"CheckIn"+n:"CheckOut"+n;var l=this.getTrackingPrefix()+ta.widgets.calendar.getTrackingString();ta.widgets.calendar.trackCalendarEvent(l,s,n,r)},getTrackingP":""},updateDatepickerOnHover:function(t){var e,a=this.getPageInDate(),i=this.getPageOutDate();this.isIn?(a=t,i&&t.getTime()>=i.getTime()&&(i=null),e=this.positionElement):(i=t,a&&t.getTime()<=a.getTime()&&(a=null),e=this.positionElement.id.replace("date_picker_out","date_picker_in"),e&&(e=ta.id(e))),ta.widgets.calendar.updateDateDisplay(e,a,i),a=this.getPageInDate(),a&&(a=a.valueOf()),i=this.getPageOutDate(),i&&(i=i.valueOf()),t=t.valueOf();var s=this.isIn?"end":"start",n=document.getElements(".date_picker_calendar.overlay .calendar .today"),r=document.getElements(".date_picker_calendar.overlay .calendar .day");r.forEach(function(e){var n=e.getAttribute("value");n&&(n=parseInt(n),e=e.getParent(),e.hasClass(s)?(e.className="",e.addClass(s),(this.isIn&&n<t||!this.isIn&&n>t)&&e.addClass("invalidPrevSel")):e.className="",(this.isIn&&i&&i>=n&&n>=t&&i!=t||!this.isIn&&a&&a<=n&&n<=t&&a!=t)&&e.addClass("prevSel"))}.bind(this)),n.addClass("today")},updateHoverElem:function(t){if(this.calendarOverlay){var e="msdp_hover",a=this.calendarOverlay.container.getElement("."+e);a&&a.removeClass(e),t&&t.getParent()&&t.getParent().addClass(e)}},updateInputStyling:function(t){var e=this.positionElement.getParent();e&&(t?e.addClass("dualFieldOn"):e.removeClass("dualFieldOn"))},updateNumNights:function(){if(ta.has("guests_rooms_picker_3.enabled")&&ta.widgets.calendar.hasPageDates()){var t=ta.widgets.calendar.getNumberOfNights(),e=$$(".grp-nights-value");e&&e.length>0&&(e.each(function(e){e.set("html",t)}),ta.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".stayInfoContainer.nights",t))}},updatePrevNext:function(){var t=this.currentMonth.date,e=this.options.dualCalendar?this.nextMonth.date:this.currentMonth.date,a=ta.util.date.inSameMonth(t,this.options.firstDate),i=ta.util.date.inSameMonth(e,this.options.lastDate),s=function(t,e,a){if(e&&0!=e.length){if(t.className&&(!a||a==t.tagName)){var i=-1;do if(i=t.className.indexOf(e,i+1),i>=0&&(0==i||32==t.className.charCodeAt(i-1))&&(i+e.length==t.className.length||32==t.className.charCodeAt(i+e.length)))return t;while(i>=0)}}else if(a==t.tagName)return t;for(var n=0;n<t.childNodes.length;n++){var r=s(t.childNodes[n],e,a);if(r)return r}return null},n=ta.id(s(this.container,"prev")),r=ta.id(s(this.container,"next"));ta.util.i18n.isRtl()&&(n=ta.id(s(this.container,"next")),r=ta.id(s(this.container,"prev")),a=ta.util.date.inSameMonth(e,this.options.lastDate),i=ta.util.date.inSameMonth(t,this.options.firstDate));var o=this.selectLeftRightButtons();a?n.addClass(o.leftInactive).removeClass(o.leftIdle).setStyle("cursor","default"):n.addClass(o.leftIdle).removeClass(o.leftInactive).setStyle("cursor","pointer"),i?r.addClass(o.rightInactive).removeClass(o.rightIdle).setStyle("cursor","default"):r.addClass(o.rightIdle).removeClass(o.rightInactive).setStyle("cursor","pointer")},updateSelectedDays:function(t,e){this.clearSelectedDays();var a=this.startRangeElem;this.includeElemInRange(a,this.options.selectedHoverClass),t.getTime()>this.newInDate.getTime()?(this.updateSelectedDaysHelper(a,e.parentNode,!0,this.options.selectedHoverClass),this.options.selectionStartClass&&ta.id(a).addClass(this.options.selectionStartClass),this.options.selectionEndClass&&ta.id(e.parentNode).addClass(this.options.selectionEndClass)):(this.updateSelectedDaysHelper(a,e.parentNode,!1,this.options.selectedHoverClass),this.options.selectionStartClass&&ta.id(a).addClass(this.options.selectionEndClass),this.options.selectionEndClass&&ta.id(e.parentNode).addClass(this.options.selectionStartClass))},updateSelectedDaysHelper:function(t,e,a,i){if(t&&t!=e){var s="nextSibling",n="firstChild";a||(s="previousSibling",n="lastChild");var r=!1;if(this.isValidDateElem(t[s]))r=t[s];else{var o=t.parentNode;if(o&&o[s])r=o[s][n];else if(o&&ta.id(o).getParent(".month")){var l=ta.id(o).getParent(".month");ta.util.i18n.isRtl()&&(s="previousSibling"==s?"nextSibling":"previousSibling");var d=l[s];if(!d)return;var h=ta.id(d).getElements("td");a||h.reverse(),h.some(function(t,e){return!!this.isValidDateElem(t)&&(r=t,!0)},this)}}this.includeElemInRange(r,i),this.updateSelectedDaysHelper(r,e,a,i)}}})}();
ta.widgets.tabContainer=function(t,e){var a=t.getElements(".current");if(1!=a.length)throw new Error("You must have exactly one tab with a class of 'current'.");a=a[0];var n=a.className.match(/tab(\d+)/);if(null!=n&&n.length>=2){var r=Number(n[1]);if($("HOMEPAGE")&&window.location.hash){var s=window.location.hash.match(/t(\d)/);s&&s.length>0&&(r=parseInt(s[1]),a.removeClass("current"),t.getElements(".tab")[r].addClass("current"))}var o=t.getElements(".tabContainerHead .tab");if(0!=o.length){var l=t.getElements(".tabContainerBody .tabContent");return new TabSet(o,l,{show:r,onActive:function(t,e,a){var n=e.hasClass("xhr");if(n&&!e.hasClass("xhrComplete")){var r=e.getElement("a").href;if(r){var s=e;ta.util.element.replaceContent(t,a,r,function(){s.addClass("xhrComplete")})}}e.hasClass("recordAction")&&new Request({url:"/ActionRecord?action="+e.id}).send(),e.addClass("current"),n&&t&&t.stop()},onBackgnt")}})}}};
ta.widgets.Carousel=new Class({Implements:Options,Binds:["shiftLeft","shiftRight"],options:{width:50,height:50,padding:5,num:7,offset:0,horizontal:!0},initialize:function(t,i){this.setOptions(i),this.container=t,this.viewport=this.container.getElement(".viewport"),this.leftKnob=this.container.getElement(".shiftLeft"),this.rightKnob=this.container.getElement(".shiftRight"),this.images=this.viewport.getElements("img"),this.offset=this.options.offset,this.options.horizontal?this.viewport.setStyles({width:this.options.width*this.options.num+this.options.padding*(this.options.num-1),height:this.options.height}):this.viewport.setStyles({width:this.options.width+2*this.options.padding,height:this.options.height*this.options.num+this.options.padding*(this.options.num-1)}),this.leftKnob.addEvent("click",this.shiftLeft),this.rightKnob.addEvent("click",this.shiftRight),this.render()},render:function(){for(var t=this.offset+this.options.num,i=this.images.length-1;i>=0;i--)i<this.offset||i>=t?this.images[i].setStyle("left",-999):this.options.horizontal?this.images[i].setStyle("left",(this.options.width+this.options.padding)*(i-this.offset)):this.images[i].setStyles({"top":(this.options.height+this.options.padding)*(i-this.offset),"left":0});0==this.offset?this.leftKnob.addClass("disabled"):this.leftKnob.removeClass("disabled"),this.offset==this.images.length-this.options.num?this.rightKnob.addClass("disabled"):this.rightKnob.removeClass("disabled")},shiftLeft:function(){var t=this.offset;this.offset=Math.max(0,this.offset-this.options.num),this.offset!=t&&this.render()},shiftRight:function(){var t=this.offset;this.offset=Math.min(this.offset+this.options.num,this.images.length-this.options.num),this.offset!=t&&this.render()}});
define("ta/util/ActionRecord",["vanillajs","ta/util/Deferred","utils/ajax","ns-exporter","ta/Core/TA.Record"],function(r,t,e,o,n){function a(r,o,a,i){var c=new t;a||(a={});var u={url:a.url||r,method:a.method||"get",data:{action:o},success:function(r){a.onSuccess&&a.onSuccess(r),c.resolve(r)},t(r)}};for(var d in a)if(a.hasOwnProperty(d)&&!u.hasOwnProperty(d))u[d]=a[d];else if("data"==d)for(d in a.data)a.data.hasOwnProperty(d)&&(u.data[d]=a.data[d]);if(i){var s=n._toEvtParams(i);for(d in s)s.hasOwnProperty(d)&&(u.data[d]=s[d])}return e(u),i&&n._trackEventAfterAjax(i),c.promise()}var i={record:function(r,t,e){return a("/ActionRecord",r,t,e)},recort,e)},recordPid:function(r){new e("/ActionRecord?pid="+r)}};return o.exportTo(i,"ta.util.action"),i});
define("ta/util/Partials",["ta/Core/TA.Store","ta/util/Error","ta/Browser","ta/Core/TA.Record","lib/jquery-amd","utils/ajax","utils/resourceLoader","ns-exporter"],function(e,t,a,r,i,n,o,l){"use st{x=0}function u(){var e=b.shift();e&&p.apply(this,e)}function c(e,t,a,r){b.push(arguments),0===x&&E&&u()}function p(t,a,r,l){if(x>g||0==t.length)return void v();x++,e.has("fb.partial.extraJS")&&o.load(e.remove("fb.partial.extraJS"),{forceType:"js"}),e.has("fb.partial.extraCSS")&&o.load(e.remove("fb.partial.extraCSS"),{forceType:"css"});var s=e.remove("facebook.authcode.param"),u=i.extend({parts:t.join(","),requestUrl:e.retrieve("page.urlSafe")},a||{});null!=s&&(u.FBAuthCode=s),n({url:"/MultiPartAjax",method:"POST",data:u,dataType:"html",success:function(e){f(a,t,r,l,null,null,e)}})}function d(a,r,o){var l=o||{};if(x=0,!r||null==r.href)return t.record(null,"handlePartialPaging elmt.href null:"+r,null,null),!1;/parts=([\w,]+)/.test(r.href);var s=RegExp.$1.split(",");e.store("partial.event.element",r),e.store("partial.event.params",o);var u=e.remove("facebook.authcode.param"),c=i.extend({requestUrl:e.retrieve("page.urlSafe")},l),p=i.extend({},c);return null!=u&&(c.FBAuthCode=u),n({url:r.href,method:"POST",data:c,dataType:"html",success:function(t){e.store("fb.partial.isHandlePartialPaging",!0),f(p,s,"facebook",!1,a,r,t)}}),!1}function f(t,r,n,o,l,s,u){if(o){var c=f.bind(this,t,r,n,!1,l,s,u);return void o(c,u,r,t,n,o)}if(u.match(A))return void(e.remove("fb.partial.isHandlePartialPaging")&&ta.support.Facebook.pageDataAvailable(l,s,t,u));if(u.match(y))return void(e.has(n+".onPartialsError")&&e.remove(n+".onPartialsError").forEach(function(e){e()}));var p=[],d=[];u.match(P)&&(p=RegExp.$1.split(",")),u.match(T)&&(d=RegExp.$1.split(",")),e.has(n+".onDataAvail")&&e.remove(n+".onDataAvail").forEach(function(e){e()});for(var v=[],m=null,g=/<style[^>]*>([\s\S]*?)<\/style>/gi;m=g.exec(u);)v.push(m[1]);if(v.length>0){v=v.join("\n");var x=document.createElement("style");x.type="text/css",document.getElementsByTagName("head")[0].appendChild(x),a.isIE()&&!a.isIE11orHigher()?x.styleSheet.cssText=v:x.appendChild(document.createTextNode(v))}var E=[];u=u.replace(/<script([^>]*)>([\s\S]*?)<\/script>/gi,function(e,t,a){return E.push(a+"\n"),""}),E.forEach(function(e){if(window.execScript)window.execScript(e);else{var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.text=e,document.head.appendChild(t),document.head.removeChild(t)}}),u=u.replace(/<style[^>]*>([\s\S]*?)<\/style>/gi,"");var b=i("#PARTIAL_DATA");b.length||(b=i('<div id="PARTIAL_DATA" style="display:none"></div>'),b.appendTo(document.body)),b.append(i("<div></div>").html(u).children()),setTimeout(function(){h(r,n,p,d,b[0],t)},0)}function h(t,a,r,i,n,o){t.forEach(function(t){var o=a+".data.onAvail."+t,l=r.indexOf(t),s=i.indexOf(t)>=0,u=e.remove(o);if(u){for(var c=0,p=u.length;c<p;c++)u[c](n,l>=0,s)===!1&&(u[c]=null);u=u.fn!!e}),l>=0&&(u.length>0?e.store(o,u):(r.splice(l,1),l=-1))}l<0&&!s&&e.keep("partials.pageProperties",t)});var l="partials.data.onPage",s=e.remove(l);s&&s.length&&s.forEach(function(e){e()}),r.length>0?setTimeout(p.bind(this,r,o,a),m):v()}function v(){if(!E){E=!0;var t=e.remove("partials.pageProperties");if(t&&t.length>0){var a="-"+t.sort().join("-")+"-";r.trackEventOnPage("social","show",a)}}s(),u()}var m=1e3,g=12,x=0,P=/<\!-- incomplete\: ([\w, ]*) -->/,T=/<\!-- failed\: ([\w, ]*) -->/,y=/<\!-- error -->/,A=/<\!-- no Oauth Token -->/,E=!1,b=[],S={incompleteDataRegex:P,failedDataRegex:T,partialsErrorRegex:y,noOauthTokenRegex:A,requestMorePartials:c,requestPartials:p,handlePartialPaging:d,handleLightbox:d};return l.exportTo(S,"ta.util.partials"),S});
define("ta/support/Facebook",["ta/Core/TA.Store","ta/util/Error","ta/util/ActionRecord","ta/Core/TA.Record","ta/util/Pending","ta/util/Partials","ta/util/Decoder","ta/util/Cookie","lib/jquery-amd","utils/ajax","ns-exporter"],function(e,o,a,t,n,i,r,c,s,u,l){function d(o){ue===!1&&(le=!0,ue=o);var a=e.retrieve("facebook.data.request");(de||se.length||a&&a.length)&&f()}function f(){if(de=!0,ue&&!te){window.fbAsyncInit=g;var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.src=ue,e.async=!0,document.head.appendChild(e),ue=!1}}function b(e){te?e():(se.push(e),f())}function v(){try{se.forEach(function(e){e()})}catch(e){o.record(e,"Error calling dequeueForFBReady")}se=[]}function k(e){setTi")})},e)}function h(o){e.retrieve("facebook.session.available")?o():(e.keep("facebook.onSessionAvail",o),te||f())}function p(o){e.retrieve("facebook.session.available")===!1?o():(e.keep("facebook.onSessionUnavail",o),te||f())}function g(){e.has("facebook.available")||(n.multilock("facebook.data.canDisplay",L,2),e.has("facebook.iptiming")&&(ae={timers:e.retrieve("facebook.iptiming"),sent:{}}),e.retrieve("facebook.invalidFBCreds")||A(!0),q(),FB.init({appId:e.retrieve("facebook.appId"),status:!le,cookie:!0,xfbml:!le,version:e.retrieve("facebook.apiVersion"),frictionlessRequests:!le,oauth:!0}),te=!0,v(),e.retrieve("facebook.disableLogin")?e.has("facebookuserid")||D():"true"==e.retrieve("facebook.skip.session.check")?P():FB.getLoginStatus(m))}function F(o){var a=e.retrieve("facebook.authFailed"),t=e.retrieve("facebook.authSuccess"),n=o.authResponse;return n&&"connected"===o.status?(n.uid=e.store("fb.auth.userId",n.userID),n.token=e.store("fb.auth.token",n.accessToken),t&&t(),n):(a&&a(),null)}function m(a){var t=F(a);if(t){if(e.has("cached.facebookuid")&&e.retrieve("cached.facebookuid")!==""+t.uid)return o.record(null,"Mismatched Facebook uid between cached value and authResponse. cached: "+e.retrieve("cached.facebookuid")+", response: "+t.uid),e.store("facebook.preFailed",!0),e.store("facebook.AuthCode.onAvail.needsReload",function(){window.location.reload()}),void B(R(t));e.retrieve("facebook.invalidFBCreds")&&!e.retrieve("facebook.signout.process")?(e.store("facebook.AuthCode.onAvail",P),B(R(t))):P()}else e.retrieve("facebook.invalidFBCreds")||(e.store("facebook.preFailed",!0),c.setOneTimeCookieOnFQDN("FacebookAuthCode2","NoFBSessionAvailable"),u("/ActionRecord?action=fb_cached_token_no_session")),D()}function A(o){e.remove("facebook.data.initialRequest.failed")?C({pre:o}):n.lock("facebook.data.initialRequest",C.bind({},{pre:o}))}function C(o){if(e.has("facebook.data.request")){ae&&!ae.timers.partials&&(ae.timers.partials=(new Date).getTime());var a=e.retrieve("facebook.data.request");i.requestPartials(a,s.extend({},o||{},e.retrieve("facebook.data.params")),"facebook",S)}}function B(a){var t=e.retrieve("facebook.AuthCode.onAvail");null!=t&&(e.store("facebook.authcode.param",a),c.setOneTimeCookieOnFQDN("FacebookAuthCode2",a),t());var n=e.retrieve("facebook.AuthCode.onAvail.needsReload");if(null!=n)return c.setOneTimeCookieOnFQDN("FacebookAuthCode2","ConflictedFBAccount"),"function"!=typeof n&&o.record(null,"needsReload was not a function."),void n();var i=e.retrieve("facebook.AuthCode.onAvail.paging");null!=i&&(e.store("facebook.authcode.param",a),c.setOneTimeCookieOnFQDN("FacebookAuthCode2",a),i())}function R(a){var t=w(a.signedRequest).code,n=e.remove("facebook.taServerTime"),i=n-3600,r=null;return t&&!isNaN(i)&&(r=t.split(".")),null!=r&&r.length>3&&!isNaN(r[3])&&r[3]<i&&o.record(null,"Facebook sending up expired Code: ",null,{"code":t,"serverTime":n}),t}function w(e){if(!e)return null;var a=e.split(".",2),t=a[1];if(t){var n=r.base64Decoder(t);try{return JSON.decode(n)}catch(a){o.record(null,"couldn't parse Facebook SignedRequest to JSON object after decode ",null,{"signedRequest":e,"decoded":n})}}else o.record(null,"Facebook SignedRequest TA received doesn't contain data",null,{"signedRequest":e})}function S(o,a,t,r,c,s){if(!a.match(ie)||!e.remove("facebook.preFailed")){if(a.match(re)){delete r.pre;var u=i.requestPartials.bind(i,t,r,c,s);e.store("facebook.AuthCode.onAvail",u),O()}e.store("facebook.data.handler",o),e.retrieve("facebook.data.isShowDataOnce")?L():n.unlock("facebook.data.canDisplay")}}function O(){var o=e.retrieve("fb.noOauthToken.counter");null==o&&(o=0),o<ce&&(e.store("fb.noOauthToken.counter",o+1),FB.getLoginStatus(_))}function _(a){var t=F(a);t&&(e.has("cached.facebookuid")&&e.retrieve("cached.facebookuid")!==""+t.uid&&(o.record(null,"Mismatched Facebook uid between cached value and authResponse. cached: "+e.retrieve("cached.facebookuid")+", response: "+t.uid),e.store("facebook.AuthCode.onAvail.needsReload",function(){window.location.reload()})),B(R(t)))}function T(o,a,t,n){var r=i.handlePartialPaging.bind(i,o,a,t);e.store("facebook.AuthCode.onAvail.paging",r),O()}function L(){if(e.remove("facebook.data.handler")(),!e.retrieve("facebook.data.isShowDataOnce")&&(e.store("facebook.data.isShowDataOnce",!0),ae)){var o=(new Date).getTime();oe("GetPartials",o-this.timers.partials),oe("LoadAll",o-this.timers.started)}}function q(){e.store("facebook.available",!0),e.has("facebook.onAvail")&&e.remove("facebook.onAvail").forEach(function(e){e()})}function P(){var o=e.retrieve("facebook.session.available");e.store("facebook.session.available",!0),ae&&oe("LoadPage",this.timers.loaded-this.timers.started),e.has("facebook.onSessionAvail")&&e.remove("facebook.onSessionAvail").forEach(function(e){e()}),o||n.unlock("facebook.data.canDisplay"),A(!1)}function D(){e.store("facebook.session.available",!1),ae&&oe("LoadPage",this.timers.loaded-this.timers.started),e.has("facebook.onSessionUnavail")&&e.remove("facebook.onSessionUnavail").fo{e()}),s("#HEAD .FB_login_button").on("click",function(){u("/ActionRecord?action=FBC_Masthead")}),s("#WoF_SigninLander .fbcBtnsmall").on("cer")})}function N(o,a,t){var n=e.retrieve("facebook.permissions");return n?n.indexOf(o)==-1?t?t():null:a?a():null:void FB.api("/me/permissions?fields=permission,status",function(e){var n=!1;e.data.forEach(function(e){e.permission==o&&"granted"===e.status&&(n=!0)}),n&&a?a():!n&&t&&t()})}function y(e,o,a){x([e],o,a)}function E(o,a){e.retrieve("facebook.session.available")&&o?o():a{x()}function x(o,t,n,i,r,u,l){function d(e,o){return s.extend({module:e,action:o},v&&{value:v}||{})}var u=!!u;o=o&&o.length?o:[],null!=r&&r.length>0?e.store("facebook.flow",r):e.store("facebook.flow","FBC");var f=userLoggedIn?"Connect":"Login",b="Login"==f?"":"true"==e.retrieve("facebook.isFBC")?"Upgrade":"New",v=l&&l.pid||e.retrieve("facebook.trackingpid");c.setPIDCookie(v),a.record("FacebookConnect",null,d("social",f+"Attempt"+b));var k=function(){c.setPIDCookie(v),a.record("FacebookConnect",null,d("social",f+"Success"+b));var e={action:f,userType:b};t&&t(e)};if(!userLoggedIn||!userFbConnected||i)return void M(o,k,n,i,u,l);for(var h=M.bind({},o,k,n,u,l),p=function(){k&&k()},g=o.length-1;g>=0;--g)p=N.bind({},o[g],p,h);E(p,h)}function W(e,o){var a={},t=s("."+e).prop("value");return t&&t.match(/.+\@.+\..+/)?(t&&(a.email=t),void U(null,null,!1,a)):void s("."+o).removeClass("hidden")}function j(e,a,t){if(te){var n=function(t){try{var n=F(t);if(!n||!n.token)return void(a&&a(n));var i=R(n);i?(c.setOneTimeCookieOnFQDN("FacebookAuthCode2",i),e&&e(n)):a&&a(n)}catch(e){o.record(e,"fb.basicLogin callback failed")}};try{var i=t||{scope:ne.join(",")};FB.login(n,i)}catch(e){o.record(e,"fb.basicLogin failed")}}}function M(o,a,t,n,i,r){var c=n;FB.login(function(o){var n=F(o);n&&n.token?(Q(),e.store("facebook.AuthCode.onAvail",function(){e.store("facebook.uid",n.uid),U(c,a,i,r)}),B(R(n))):t&&t()},{scope:ne.join("e(o)}function U(o,a,t,n){var i=!e.retrieve("facebook.session.available")||!userLoggedIn||!userFbConnected;n||(n={});var r=n.pid;if(null!=o&&(i=i||o),i){var c={flow:e.retrieve("facebook.flow"),noreload:t};r&&s.extend(c,{pid:r}),e.store("facebook.session.available",!0),e.store("registration.action","FB_CONNECT"),ta.run("ta.overlays.registration.logAndPost",{},c,"FBC-start",s.extend(n,{action:"FB_CONNECT"}))}a&&a()}function G(o,a){e.store("facebook.flow",o),x(null,null,null,a)}function J(){FB.logout(function(){window.location.reload()})}function V(o){FB.logout(function(a){userLoggedIn=!1,e.store("facebook.session.available",!1),e.store("facebook.isFBC",!1),o&&o(a)})}function z(){FB.lNn"})}function K(e,a,t,n,i,r,c,s,u,l,d,f,b){FB.ui({method:"feed",message:e,picture:r,link:a,name:t,to:u,caption:n,description:i,display:l,properties:d,actions:[{name:c,link:s}]},function(e){e&&e.post_id?f&&f(e):e&&!e.post_id?o.record(null,"Facebook postWall error response from facebook",null,null):b&&b(e)})}function X(e,o,a,t,n,i,r,c){FB.login(function(s){var l=F(s);l&&l.token&&(u("/ActionRecord?action=POSTTOWALL_GRANTED"),K(e,o,a,t,n,i,r,c))},{scope:"publish_stream"})}function Y(o,a,t){FB.login(function(o){var n=F(o);n&&(n.token?(e.store("facebook.AuthCode.onAl,a)}),B(R(n))):t&&t())},{scope:o})}function Z(o,a,t,n){e.store("facebook.flow",o),Y(a,t,n)}function $(){try{E(function()ad()})}catch(e){o.record(e,"signoutAction - fb signout failed"),window.location.reload()}}function ee",e)})}function oe(o,t){if(ae&&!ae.sent[o]){ae.sent[o]=!0,t=Math.round(t/1e3);var n;n=t<=10?t.toString():t>10&&t<=15?"11-15":t>15&&t<=20?"16-20":"21+",o+="_",o+=e.retrieve("facebook.session.available")?"IP_":"NonIP_",o+=n+"_"+ae.timers.servletName,ae.timers.firstPage&&(o+="_FirstPage"),a.record(o)}}var ae,te=!1,ne=["email","user_hometown","user_friends","user_likes","user_location","user_status","user_photos"],ie=/<\!-- PREEMPTIVE RESPONSE -->/,re=/<\!-- no Oauth Token -->/,ce=4,se=[],ue=!1,le=!1,de=!1,fe={loadSdkLite:d,enqueueForFBReady:b,dequeueForFBReady:v,ipRevoke:k,enqueueForFBAvailable:h,enqueueForFBUnavailable:p,init:g,transformToAuthResponse:F,receiveCode:B,getCodeFromOAuthResponse:R,parseFBSignedRequest:w,dataAvailable:S,checkStatusAndGetCode:_,pageDataAvailable:T,showData:L,sessionAvailable:P,havePermission:N,requirePermission:y,ifLoggedIn:E,loginButton:I,login:x,addEmailLogin:W,basicLogin:j,doLogin:M,fbcRegistration:U,loginWithFlow:G,logout:J,logoutNoRefresh:V,restart:z,revoke:H,postWall:K,publishStream:X,loginRequestSpecificPermission:Y,loginWithFlowAndRequest:Z,signOutComplete:$,enqueueListenForFBAuthChange:ee};return l.exportTo(fe,"ta.support.Facebook"),fe});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/util/extend"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/fb_graph","files":{"js3":{"src":{"ta":{"util":{"extend":1}}}}},"_":{"baseUrl":"/"}});
define("ta/util/extend",["vanillajs","ns-exporter"],function(t,r){"use strict";var o={},n=function(t){this.constructor=t};return o.extend=function(t,r){var o,e,p,c,u,s={};for(c=1,u=arguments.length;c<u;c++){e=arguments[c];for(p in e)e.hasOwnProperty(p)&&(s[p]=e[p]);e.hasOwnProperty("constructor")&&(s.constructor=e.constructor)}o=s.hasOwnProperty("constructor")?s.constrnts)},n.prototype=t.prototype,o.prototype=new n(o),o.prototype.__super__=t.prototype;for(p in s)o.prototype[p]=s[p];return o},r.exportTo({extend:o.extend},"ta.util"),o});
!function(r){r.fb||(r.fb={});var e=new RegExp(["User is already associated","Permissions error"].join("|")),o=new RegExp(["Timeline is not activated","Requires extended permission","An unexpected error has occurred","An unknown error has occurred","load-error: unknown","Error validating access token","Object at URL.*requires an object of og:type","Could not retrieve data from URL","^unknown error"].join("|")),t=/Temporarily Blocked/;r.fb.graph={api:function(t,s,a,n){var i=Array.prototype.slice.call(arguments),c=r.util.Deferred();return s||(s="get"),a||(a={}),n||(n={}),n.recordErrors=n.recordErrors!==!1,function r(d){FB.api(t,s,a,function(t){if(t&&!t.error)c.resolve(t);else{var s={name:"None",message:"No FB.api response"},u="ERROR";if(t&&t.error&&(s.name=t.error.type,s.message="string"==typeof t.error?t.error:t.error.message),d&&s.message.match("has og:type of '(?:tripadvisortravelmap|civ)"))return a.scrape=!0,void r(!1);o.test(s.message)&&(u="WARN"),n.recordErrors&&!e.test(s.message)&&this.recordError(s,{FB_API_ARGS:i,FB_API_RESPONSE:t,FB_AUTH_RESPONSE:FB.getAuthResponse()},u),c.reject(s)}}.bind(this))}.call(this,!0),c.promise()},remove:function(r,e){return e||(e={}),e.method="delete",this.api("/"+r,"delete",e)},recordError:function(e,o,s){var a="ta.fb.graph.api";return t.test(e.message)&&(a+=" blocked feature"),r.util.error&&r.util.error.record(e,a,null,o,s),this}}}(ta);
!function(n){n.fb.graph.Base=n.util.extend(Object,{constructor:function(n,t){this.set(n),this.options=t||{},this.connections||(this.connections={})this},api:function(t,e,i){if(!this.id||!this.accessToken){var s={name:"Missing auth credentials",message:"Facebook Graph object API calls require an id and access token"};return n.fb.graph.recordError(s,{FB_ID:this.id,FB_ACCESS_TOKEN:this.accessToken,FB_API_ARGS:arguments},"WARN"),n.util.Deferred().reject(s)}return t||(t=""),/^\//.test(t)&&(t=t.slice(1)),i||(i={}),i.access_token=this.accessToken,n.fb.graph.api("/"+this.id+"/"+t,e,i)},getConnection:function(t){return this.connections[t]?(new n.util.Deferred).resolve(this.connections[t]):this.api(t).success(function(e){return this.connections[t]=e.data,n.util.Deferred().resolve(e.data)},this)},getClientConnection:function(n){return this.connections[n]||(this.connections[n]=[],this.connections[n].all=!1,this.connections[n].clientCount=0),this.connections[n]},evictConnes[n]}})}(ta);
ta.fb.graph.Application=ta.util.extend(ta.fb.graph.Base);
!function(){"use strict";ta.fb.openFeedDialog=function(e){var t=new ta.util.Deferred;return e||(e={}),e.method="feed",FBt(e)}),t.promise()}}();
!function(t){t.fb.graph.mixin||(t.fb.graph.mixin={});var e=!0,n=!0,i=(new RegExp(["Timeline is not activated","Requires extended permission"].join("|")),300);t.fb.graph.mixin.OpenGraph={recordOpenGraph:function(t){var e=this.options.MapAction;return e&&(Math.random()>.2||e.record(t)),this},getActions:function(e,n){e=this.options.appName+":"+e;var r=this.getClientConnection(e);return r.all||!n&&r.length>r.clientCount?t.util.Deferred().resolve(r):this.api(e,"get",{offset:r.length,limit:i}).success(function(e){return Array.prototype.push.apply(r,e.data),(!e.paging||e.paging.previous&&!e.paging.next)&&(r.all=!0),t.util.Deferred(r)})},publishAction:function(e,n,i,r){return t.util.Deferred().reject("Publishing open graph actions is disabled.")},publishLocatedAction:function(t,e,n,i){return i||(i={}),i.place=(/^http/.test(n)?"":"http://"+this.options.hostname)+n,this.publishAction(t,e,n,i)},deleteActionsByObject:function(e,n,i){var r=this;+i!=i&&(i=(/^http/.test(i)?"":"http://"+this.options.hostname)+i);var o=Array.prototype.each?"each":"forEach";return function s(a){return r.getActions(e,{next:a}).success(function(e){if(!e.all)return s(!0);var r,a,p,c=t.util.Deferred(),u=[];for(p=0;p<e.length;p++)r=e[p],a=r.data[n],!a||a.url!=i&&a.id!=i||u.push(r);return u.length?(u[o](function(n){t.fb.graph.api(n.id,"delete").success(function(){u.splice(u.indexOf(n),1);var t=e.indexOf(n);e.splice(t,1),t<e.clientCount&&e.clientCount--,u.length||c.resolve()}).failure(function(){c.reject()})}),c.promise()):c.resolve()},this)}(!1)},scrape:function(e){return t.fb.graph.api("/","post",{id:e,scrape:!0})},setPublishState:function(t){e=!!t,n=!!t}}}(ta);
!function(t){"use strict";t.fb.graph.mixin||(t.fb.graph.mixin={}),t.fb.graph.mixin.Feed={postLink:function(){},postStatus:function(){},postCheckin:function(){},postPhoto:function(){},postVideo:function(){},pos",t)}}}(ta);
!function(e){"use strict";e.fb.graph.User=e.util.extend(e.fb.graph.Base,e.fb.graph.mixin.OpenGraph,e.fb.graph.mixin.Feed)}(ta);
ta.fb.graph.User.prototype.inviteFriends=function(e){function t(e,s,n,o,i){var a=e.splice(0,r);i||(i=[]),FB.ui({method:"apprequests",message:s||"",title:n||"",new_style_message:!0,to:a.join(",")},function(r){r&&r.to&&r.to.length?(i.push.apply(i,r.to),e.length?o.resolve(i,r):t(e,s,n,o,i)):o.reject(i,r)})}var r=50;return function(r,s,n){var o=e.util.Deferred();return t(r,s,n,o),o.promise()}}(ta),ta.fb.graph.User.prototype.getAppRequests=function(e){return!e&&this.appRequests?ta.util.Deferred().resolve(this.appRequests):this.api("apprequests").suts=e},this)},ta.fb.graph.User.prototype.recordAndDeleteAppRequests=function(e,t,r){function s(e){var t=[],s=0,o=ta.util.Deferred();return e.each(function(i){var a="";ta.fb.graph.api("/"+i,"get").su.id)}).always(function(){ta.fb.graph.api("/"+i,"delete",null,{recordErrors:!1}),t.push((r?r+"_":"")+"AppRequestId_"+i+"_"+a),s++,s==e.length&&(n.options.MapAction&&t.length?n.options.MapAction.record(t.join(",")).success(function(){o.resolve()}).failure(function(){o.reject()}):o.resolve())})}),o.promise()}var n=this;if(e||(e=[]),!t){var o=window.location.search.match(/[?&](?:ref|fb_source)=([^&]*)/);t=o&&o[1]}return"bookmarks"==t?this.getAppRequests().success(function(t){t.data.each(function(t){var r=t.id.split("_")[0];~e.indexOf(r)||e.push(r)})}).as(e)}):s(e)};
!function(t){var e=1e4;t.fb.graph.TAUser=t.util.extend(t.fb.graph.User,{locationToOnull},pin:function(e,i,n){n||(n={});var a,r,o,s,l=t.util.Deferred(),u=!1;if(e&&(a=this.locationToOgType(e.type),r=e.url),!(a&&e.url&&i&&i.length))return l.reject();o=!!(this.location&&this.location.latitude&&this.location.longitude),s=!!(this.hometown&&this.hometown.latitude&&this.hometown.longitude);var c=Array.prototype.each?"each":"forEach",h=0;return i[c](function(c){var p="been"==c?"pin":c,d={},f=!1;if("pin"==p){var g,v={};o?(v.lat=this.location.latitude,v.lng=this.location.longitude):s&&(v.lat=this.hometown.latitude,v.lng=this.hometown.latitude),g=t.travelmap.util.getDistance(e,v,this.locale),g&&(d.distance=g.value,d.distance_unit=g.unit,d.cur_loc_used=o)}else"going"==p&&(d.end_time="5000-01-01");(n.suppressFeed||"pin"==p&&i.length>1)&&(d.no_feed_story=1),(n.suppressMap||"city"!=a||"going"==p||!e.redistributable||"pin"==p&&i.length>1)&&(f=!0),this[f?"publishAction":"publishLocatedAction"](p,a,r,d).fau=!0}).always(function(){++h==i.length&&l[u?"reject":"resolve"]()})},this),l.promise()},visit:function(e,i,n,a){var r=t.util.Deferred(),o={},s=i.join(",");return o.tags=s,n&&(o["fb:explicitly_shared"]=!0),this.publishLocatedAction("visit","city",e,o),r.promise()},removePin:function(e,i){var n,a,r=t.util.Deferred(),o=!1;if(e&&(n=this.locationToOgType(e.type),a=e.url),!(n&&e.url&&i&&i.length))return r.reject();var s=Array.prototype.each?"each":"forEach",l=0;return i[s](function(t){var e="been"==t?"pin":t;this.deleteActionsByObject(e,n,a).failure(function(){o=!0}).always(function(){++l==i.length&&r[o?"reject":"resolve"]()})},this),r.promise()},removeBadge:function(e){var i,n;if(e)var i="badge",n="/MemberTravelMap?ns=badge&badgeId="+e.id;return i&&n?this.deleteActionsByObject("earn",i,n):(new t.util.Deferred).reject()},rate:function(t){var e="rate",i="attraction",n=t.url,a={};return this[t.redistributable?"publishLocatedAction":"publishAction"](e,i,n,a)},review:function(t,e,i){var n="review",a="";0==t.indexOf("/Attraction")?a="attraction":0==t.indexOf("/Hotel")?a="hotel":0==t.indexOf("/Restaurant")&&(a="restaurant");var r={title:e,body:i};return r["fb:explicitly_shared"]=!0,this.publishAction(n,a,t,r)},earnBadge:function(t,e,i){var n="earn",a="badge",r="/MemberTravelMap?ns=badge&badgeId="+t,o={};return e&&(o["fb:explicitly_shared"]=!0,r+="&story_type=badge_explicit_og"),i&&(o.no_feed_story=!0),this.publishAction(n,a,r,o)},endorseFriend:function(t,e){var i="endorse",n="friend",a="/MemberTravelMap?ns=friend&serial="+t,r={city:"http://"+this.options.hostname+e};return this.publishAction(i,n,a,r)},updateMap:function(i){return this._needToScrapeMap=!0,this._intervalID&&!i?t.util.Deferred().resolve():(this._intervalID||(this._intervalID=window.setInterval(this.scrapeMap.bind(this),e)),this.options.MapAction.getTravelMapMetaData().always(function(t){var e="publish",n="map",a="/MemberTravelMap?ns=map&uid="+this.options.guid,r={};return t&&t.tmTotalDistance&&(r={total_distance:Math.round(t.tmTotalDistance),distance_unit:t.tmDistanceUnit}),i&&(r["fb:explicitly_shared"]=!0,a+="&story_type=map_explicit_og"),this.publishAction(e,n,a,r)},this))},shareMapLink:function(){var t={};return t.name=tm.hub.messages.myTravelMap,t.link="http://"+this.options.hostname+"/MemberTravelMap?ns=map&uid="+this.options.guid+"&story_type=map_link",t.picture="http://"+this.options.hostname+"/img2/facebook/dlRecentPinned.jpg",this.postFeed(t)},scrapeMap:function(e){return this._needToScrapeMap||e?(this._needToScrapeMap=!1,this.scrape("http://"+this.options.hostname+"/MemberTravelMap?ns=map&uid="+this.options.guid)):t.util.Deferred().resolve()}})}(ta);
define("ta/popups/SlotSet",["vanillajs","api-mod","ta/util/Error"],function(t,s,o){function i(){this.nW=525,this.nH=460,this.nXI=24,this.nYI=24,this.totalSlots=20,this.slots=[];try{screen.width>1024?(this.nW=800,this.nH=600,this.nXI=80,this.nYI=40):screen.width>800&&(this.nW=620,this.nH=500,this.nXI=60,this.nYI=30)}catch(t){this.error=t,o.record(this.error,"slot set",null,{"slot set":"general"})}this.getOpenSlot=function(t){(!t||t<0||t>this.totalSlots)&&(t=0);var s=function(t){try{var s=!1,i=!1;try{i=this.slots[t].occupied}catch(t){}if(i)try{var r=i.windowObject;r&&!r.closed||(s=!0)}catch(t){s=!0}else s=!0}catch(s){o.record(s,"get open slot - get pop slot",null,{totalSlots:this.totalSlots,slotNumber:t})}if(s){this.slots[t].occupied=null;var l=this.slots[t];return l.slotPos=t,l}return!1}.bind(this);try{var i,r;for(i=t-1;i>=0;i-=1)if(r=s(i))return r;for(i=t;i<this.slots.length;i++)if(r=s(i))return r}catch(t){o.record(t,"get open slot",null,{totalSlots:this.totalSlots})}return!1}}return i});
define("ta/popups/Slot",["vanillajs"],functinull}return t});
define("ta/popups/PopupSlotSet",["vanillajs","api-mod","ta/util/Error","ta/popups/SlotSet","ta/popups/Slot"],function(t,s,i,n,e){function o(){s.mixin(this,new n),this.nX=500;var t=1160;try{screen.width<1660&&(screen.width>1024&&screen.width<1280?t=960:screen.width<=1024&&(t=740),this.nX=screen.width-t),this.nY=isNaN(window.screenTop)?isNaN(window.screenY)?0:window.screenY:window.screenTop}catch(t){this.error=t,this.nY=0,i.record(this.error,"slot set",null,{"slot set":"popup"})}for(var o=0;o<this.totalSlots;o++)this.slots[o]=new e(this.nX,this.nY,this.nW,this.nH),this.nX=this.nX+this.nXI,this.nY=this.nY+this.nYI}return o});
define("ta/popups/PopunderSlot",["vanillajs","api-mod","ta/popups/Slot"],function(t,i,n){function o(t,o,p,s,h,u,a,e){i.mixin(this,new n(t,o,p,s)),this.tx=h,this.ty=u,this.tw=a,this.th=e}return o});
define("ta/popups/PopunderSlotSet",["vanillajs","api-mod","ta/util/Error","utils/browserutils","ta/popups/PopupSlotSet","ta/popups/PopunderSlot"],function(t,i,s,h,n,e){function o(){i.mixin(this,new n);try{this.nX=window.screenLeft||window.screenX,this.nY=window.screenTop||window.screenY}catch(t){this.error=t,this.nX=200,this.nY=200}this.w=1,this.h=1,this.x=5e3,this.y=5e3,this.totalSlots=4;try{h.ie7&&(this.w=250,this.h=100),(h.safari||h.chrome)&&(this.w=85,this.h=100),"undefined"==typeof this.nX?(this.nX=0,this.nY=0,this.x=this.nX+window.screen.availWidth-this.w,this.y=this.nY+window.screen.availHeight-this.h):(this.x=this.nX+window.getWidth()-this.w,this.y=this.nY+window.getHeight()-this.h),h.ie7?(this.y=this.y-95,this.x=this.x+13):(h.safari||h.chrome)&&(this.y=this.y-16)}catch(t){this.error=t}this.error&&s.record(this.error,"slot set",null,{"slot set":"popunder"});for(var t=0;t<this.totalSlots;t++)this.slots[t]=new e(this.nX,this.nY,this.nW,this.nH,this.x,this.y,this.w,this.h),this.nX=this.nX+this.nXI,this.nY=this.nY+this.nYI}return o});
define("ta/popups/TAPopWindow",["vanillajs","api-mod","ta/util/Error","ta/Core/TA.Store","ta/util/Cookie","utils/browserutils","ta/Core/TA.Record","ta/Browser"],function(t,i,s,o,e,h,n,r){function w(t){this.options={name:"TAWin",url:"",windowHook:!1,customWidth:!1,customHeight:!1,toolbar:1,location:1,directories:1,status:1,menubar:r.isIE9orHigher()?0:1,resizable:1,copyhistory:1,scrollbars:1,alwaysRaised:!1,alwaysLowered:!1,widthOffset:8,heightOffset:164,delayLoad:!1},this.init=function(n,r){var w,l,a;if(i.merge(this.options,r),this.type=n,this.assignSlot(),this.options.customWidth&&(this.width=this.options.customWidth),this.options.customHeight&&(this.height=this.options.customHeight),null!=this.options.widthOffset&&(this.widthOffset=this.options.widthOffset),null!=this.options.heightOffset&&(this.heightOffset=this.options.heightOffset),this.options.delayLoad&&(this.delayLoad=this.options.delayLoad),this.options.windowHook)return this.windowObject=this.options.windowHook,o.has("checkrates.add_holding_windows")||this.windowObject.refresh(),!0;o.has("checkrates.chrome_dates_entry_holding")&&(this.options.scrollbars=0),this.url=this.options.url,this.assignWinArgs();try{if(this.type==t.windowType.HOLDING&&e.setPIDCookie(28962),h.chrome&&this.options.inTab){var d=Math.random().toString(36).substring(7);return this.options.popunder?(w=document.createElement("a"),w.href=this.url,w.target=d,document.body.appendChild(w),l=document.createEvent("MouseEvents"),l.initMouseEvent("click",!1,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),w.dispatchEvent(l),w.parentNode.removeChild(w),void(this.windowObject=window.open(this.url,d))):void(this.windowObject=window.open(this.url,d))}var p=h.chrome&&h.version>31;if(p)this.windowObject=window.open("","_blank");else if(this.options.popunder)if(h.ie8||h.ie9||h.ie10||h.ie11)this.windowObject=window.open("pages/blank.html","_blank",this.winArgs),window.document.focus();else if(h.safari&&"ios"!==h.Platform.name){if(this.windowObject=window.open("","_blank",this.winArgs),this.windowObject){var c=window.open("","_blank");c.close()}window.focus()}else h.firefox?(this.windowObject=window.open("","_blank",this.winArgs),window.open("","_self",""),window.focus()):this.windowObject=window.open("","_blank",this.winArgs);else this.windowObject=window.open("","_blank",this.winArgs);a=this.windowObject,a&&this.isTAWindow()?(this.type==t.windowType.CHECK_RATE&&t.pollForPartnerLoad(a,new Date,this.options.name,t.extractSlotFromCommerceUrl(this.options.url)),this.delayLoad||t.redirectToUrl(this.windowObject,this.url)):!a&&h.ie&&this.type===t.windowType.CHECK_RATE&&this.url&&o.has("ta.ie_commerce_popup_block_fix")&&(e.setPIDCookie(38822),window.location=this.url)}catch(t){this.errorOpening=t,s.record(this.errorOpening,"pop window opening failure",null,{type:this.type,url:this.url})}try{a=this.windowObject,a&&this.isTAWindow()&&this.type==t.windowType.HOLDING&&this.moveBehindMain(a)}catch(t){this.errorMoving=t,s.record(this.errorMoving,"popunder window moving",null,{type:this.type,url:this.url})}},this.repurpose=function(i,o,e){if(this.type==t.windowType.HOLDING){this.type=t.windowType.CHECK_RATE,this.slot.occupied=!1,this.assignSlot(),this.url=i,o&&(this.width=o,this.options.widthOffset=0),e&&(this.height=e,this.options.heightOffset=0);var h=this.windowObject;if(h&&this.isTAWindow())try{this.options.inTab||(h.moveTo(0,0),h.resizeTo(this.width+this.options.widthOffset,this.height+this.options.heightOffset),h.moveTo(this.x,this.y)),this.delayLoad||this.options.keepFocus||h.focus(),this.delayLoad||(h.location=this.url)}catch(t){s.record(this.errorMoving,"repurpose popunder fail",null,{type:this.type,url:this.url})}return this}return!1},this.assignWinArgs=function(){this.winArgs="toolbar="+this.options.toolbar,this.winArgs+=",location="+this.options.location,this.winArgs+=",directories="+this.options.directories,this.winArgs+=",status="+this.options.status,this.winArgs+=",menubar="+this.options.menubar,this.winArgs+=",resizable="+this.options.resizable,this.winArgs+=",copyhistory="+this.options.copyhistory,this.winArgs+=",scrollbars="+this.options.scrollbars,this.winArgs+=",width="+this.width,this.winArgs+=",height="+this.height,this.winArgs+=",left="+this.x,this.winArgs+=",top="+this.y,this.winArgs+=",screenx="+this.x,this.winArgs+=",screeny="+this.y,this.options.alwaysRaised&&(this.winArgs+=",alwaysRaised"),this.options.alwaysLowered&&(this.winArgs+=",alwaysLowered")},this.assignSlot=function(){this.type==t.windowType.HOLDING?(this.slot=t.getPopunderSlots().getOpenSlot(),this.width=this.slot.tw,this.height=this.slot.th,this.x=this.slot.tx,this.y=this.slot.ty):(this.slot=t.getPopupSlots().getOpenSlot(),this.width=this.slot.w+this.options.widthOffset,this.height=this.slot.h+this.options.heightOffset,this.x=this.slot.x,this.y=this.slot.y),this.slot.occupied=this},this.moveBehindMain=function(e){if(o.has("checkrates.cr_popunder_by_shift_ctrl")&&h.version>23)t.openCloseTab();else if(o.has("checkrates.chrome_dates_entry_holding"))try{var r=window.open("about:blank");r&&(r.focus(),r.close())}catch(t){s.record(t,"holdingWindow - Chrome blur failed")}e.blur(),e.opener=self,e.moveTo(this.slot.x,this.slot.y),e.resizeTo(this.slot.w,this.slot.h),this.delayLoad||(e.location=this.url),window.focus(),i.hasClass(document.activeElement,"globalNav2011_reset")||n.trackEventOnPage("checkrates","no_focus_on_main",h.version,1)},this.isTAWindow=function(){var t=!0;try{var i=this.windowObject.location;this.windowObject.status="",null!==i&&""!==i||(t=!1)}catch(i){t=!1}return t}}return w});
define("ta/util/openNewTab",["utils/browserutils","ta/Browser","ta/util/Cookie"],function(e,o,t){return function(n){var i;return o.isIE10Metro()||(i=e.ie&&!o.isIE9orHigher()?window.open(n,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+document.documentElement.clientWidth+",height="+document.documentElement.clientHeight):window.open(n,"_blank")),!i||i.closed||"undefined"==typeof i.closed?(t.setPIDCookie(38821),window.location=n,!1):i}});
define("ta/popups/PollForPartnerLoad",["common/trackingStreams"],function(t){var e=function(n,E,r,a,o){n&&setTimeout(function(){var C=null,c=(new Date).getTime()-E.getTime();try{C=n.document}catch(t){}C?c>2e4?t.trackEvent("COMMERCE_CLICK","PROVIDER_TIMEOUT",r||"",c):n.closed?t.trackEvent("COMMERCE_CLICK","PROVIDER_CLOSED",r||"",c):e(n,E,r,a,o):t.trackEvent("COMMERCE_CLICK","PROVIDER_LOADED",(o||window.pageServlet||"")+"|"+(a||"")+"|"+(r||""),c)},100)};return e});
define("ta/popups/BeforePopTargetBlankIE",["ta/Browser","ta/util/Cookie"],function(e,t){return function(o){var n;return!o||!o.href||"_blank"!==o.target||(e.isIE10Metro()||(n=e.isIE9orHigher()?window.open(o.href,"_blank"):window.open(url,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+document.documentElement.clientWidth+",height="+document.documentElement.clientHeight)),!(n&&!n.closed&&"undefined"!=typeof n.closed)&&(o.target="",t.setPIDCookie(38821),!0))}});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/popups/PopUtil"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-popups","files":{"js3":{"src":{"ta":{"popups":{"PopUtil":1}}}}},"_":{"baseUrl":"/"}});
define("ta/popups/PopUtil",["vanillajs","ns-exporter","utils/browserutils","ta/util/Cookie","ta/util/Error","ta/Core/TA.Record","ta/Browser","ta/Core/TA.Store","ta/popups/PopupSlotSet","ta/popups/PopunderSlotSet","ta/popups/TAPopWindow","ta/util/openNewTab","ta/popups/PollForPartnerLoad","ta/popups/BeforePopTargetBlankIE"],function(e,n,t,o,r,i,d,a,c,u,l,s,p,w){function h(e,n){n=n||{};var t=new l(k);if(t.init(e,n),!t.errorOpening&&!t.errorMoving&&t.windowObject)try{return a.has("checkrates.add_holding_windows")&&n.windowHook&&n.windowHook.location&&n.windowHook.location.href.test(/RuleBasedPopunder/)?f.unshift(t):f.push(t),n.windowHook||e!=k.windowType.HOLDING||this.trackPopunder(n.url,k.numPopundersCheck()),t}catch(e){r.record(e,"Window Popup - could not register new window")}return!1}var f=[],m=null,g=null,v=2,k={windowType:{CHECK_RATE:0,PROV_WIN:1,HOLDING:2,COMMERCE:3,VFM:4,COOKIE:5},maxPopunders:4,tryHoldingWindows:function(e,n){try{for(var t=!0,o=0;o<n;o++){var i=this.launchHoldingWindow(e);i.windowObject||(t=!1)}if(t)return!0}catch(e){r.record(e,"try two hw")}return!1},getPopunderSlots:function(){return null===m&&(m=new u),m},getPopupc),g},createCheckRatesWindow:function(e){return h(this.windowType.CHECK_RATE,e)},createHoldingWindow:function(e){return h(this.windowType.HOLDING,e)},createVFMWM,e)},getHoldingWindowSet:function(){for(var e=[],n=0;n<f.length;n++){var t=f[n];if(t&&t.type==this.windowType.HOLDING){var r=t.windowObject;if(r&&"closed"in r)if(r.closed){if(a.has("checkrates.add_holding_windows")&&r.closed){var i=window.cookieDomain;i&&o.write("CommercePopunder","SuppressAll",0,i)}}else e[e.length]=t}}return e},attemptHoldingWindowWNumChecked:function(){},openCloseTab:function(){var e,n;if(a.has("popunder.popunder_by_self_closing_tab"))try{n=document.createElement("a"),n.href="http://"+window.location.hostname+"/vpages/tab.html",document.body.appendChild(n),e=document.createEvent("MouseEvents"),e.initMouseEvent("click",!1,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),n.dispatchEvent(e),n.parentNode.removeChild(n)}catch(e){r.record(e,"self-closing tab blur method failed")}else if(a.has("checkrates.cr_popunder_by_shift_ctrl")&&t.version>23)try{n=document.createElement("a"),n.href="about:blank",n.target="popunderwindowhelper",document.body.appendChild(n),e=document.createEvent("MouseEvents");var o=!0,i=!0;e.initMouseEvent("click",o,i,window,0,0,0,0,0,!0,!1,!1,!0,0,null),n.dispatchEvent(e),n.parentNode.removeChild(n),window.open("about:blank","popunderwindowhelper").close()}catch(e){r.record(e,"shift-ctrl blur method failed")}},attemptHoldingWindow:function(e){if(!this.useShiftClick())if(a.has("checkrates.add_holding_windows")){var n=this.numPopundersCheck();n<this.maxPopunders&&this.launchHoldingWindow(e)}else v>this.getHoldingWindowSet().length&&this.launchHoldingWindow(e)},launchHoldingWindow:function(e){if(!e)return!1;var n=a.retrieve("checkrates.holdingWindowURI");if(n){a.store("checkrates.HWtracking","date");var t={url:n};return this.createHoldingWindow(t)}return!1},launchAddHoldingWindow:function(e,n){var t=n||{};return t.url=e,this.createHoldingWindow(t)},popunderRemw(n)},numPopundersCheck:function(){try{var e=this.getHoldingWindowSet(),n=0,t=o.readRaw("CommercePopunder"),i=t?t.match(/\d+/):null;return n=t&&i?Math.max(e.length,parseInt(i[0],10)):e.length}catch(e){r.record(e,"CommercePopunder - numPopundersCheck")}},trackPopunder:function(e,n){try{if(!n||!e)return;var t="CommerceEnhancedPopunder";if(e.match(/AlsoViewedLB/))t="AlsoViewedLB";else{var o=e.match(/RuleBasedPopunder\?Rule=\d+/);if(o){var d=o[0].match(/\d+/);t="RuleBasedPopunder_"+d[0]}}var c="OpenWindow",u=a.retrieve("checkrates.HWtracking");u&&(c="OpenWindow_"+u,a.remove("checkrates.HWtracking")),i.trackEventOnPage("CommercePopunder",c,t,n,!0)}catch(e){r.record(e,"CommercePopunder - trackPopunder")}},getProviderWindowDims:function(e,n){var o=null,r=null,i=null,d=null;return"hotels.com"==e&&(o=975),screen.width>=1280&&(o=1e3,r=897,n||(i=0,d=0,t.chrome?r-=50:t.firefox?r-=87:t.ie&&(o-=12,r-=179))),{customWidth:o,customHeight:r,widthOffset:i,heightOffset:d}},useShiftClick:function(){return!1},expandSidebarWindow:function(e,n,t){i.trackEventOnPage("traffic_acquisition_sidebar","any",n,1),"true"==t&&(window.moveTo(0,0),window.resizeTo(screen.width,screen.height)),document.getElementById("SliderHolder").style.display="none",document.getElementById("PAGE").style.marginLeft="0px"},pollForPartneo,r)},extractSlotFromCommer1]:0},redirectToUrl:function(e,n){e?e.location=n:window.location=n},beforePopTargetBlankIE:function(e){return w(e)},attemptOpenUrlNewTab:function(e){return s(e)}};return n.exportTo(k,"ta.popups.PopUtil"),k});
define("mobile/lite/image-loader",["utils/throttle","vanillajs"],function(t){"use strict";function e(e,n){n=n||document,c=e||0;var i=Array.prototype.filter.call(n.querySelectorAll("["+u+"]"),r());if(0!=i.length){var o=t(function(t){i=i.filter(r()),0==i.length&&(window.removeEventListener("scroll",o),window.removeEventListener("resize",o))},200);window.addEventListener("scroll",o),window.addEventListener("resize",o)}}function r(){return function(t){if(!document.body.contains(t))return!1;try{if(!i(t))return!0}catch(t){return!1}var e=t.getAttribute(u);if(e)return"IMG"===t.tagName?t.src=e:t.style.backgroundImage="url("+e+")",t.removeAttribute(u),!1;var r=t.getAttribute(l);return r&&"IMG"===t.tagName&&(t.srcset=r,t.removeAttribute(l)),!0}}function n(t){t=t||document;var e=t.querySelectorAll("["+u+"]");Array.prototype.filter.call(e,r())}function i(t){var e=t.getBoundingClientRect();return e.width>0&&e.height>0&&e.top+c>=0&&e.top-c<=window.innerHeight}function o(){return function(t){var e=t.getAttribute(u);return!e||("IMG"===t.tagName?t.src=e:t.style.backgroundImage="url("+e+")",t.removeAttribute(u),!1)}}function a(t){t=t||document;var e=t.querySelectorAll("["+u+"]");Array.prototype.filter.call(e,o())}var u="data-lazyurl",l="data-lazyset",c=0;return{init:e,demandLoadImages:n,forceLoadImages:a}});
define("ta/util/String",["vanillajs"],function(t){var e={getColumns:function(t){if(!t||!t.length)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n]>=8192&&t[n]<65279||t[n]>65280&&t[n]<65376?2:1;return e},abbreviate:function(t,n){if(arguments.length>2)for(var r=2;r<arguments.length;r++)n-=e.getColumns(arguments[r]);return t.length-n<3?t:t.slice(0,n)+"&#8230;"},lowerCaseNoSpace:function(t){return t&&"[object String]"===Object.prototype.toString.call(t)?t.toLowerCase().replace(/ /g,""):""},stripHTMLFrotent}};return e});
define("typeahead/TypeAhead.utils",["vanillajs","ta/util/Deferred","utils/ajax"],function(e,t,o){var n={};return n.query=function(e,n,a,r,i,l,s,u,c,_,d,g,m){return function(e){var f=t(),h={query:e,action:"API",startTime:this.startTime,uiOrigin:this.name,source:this.name,interleaved:!0,geoPages:!i,flightsToPages:!i,nearPages:!1,details:!0,types:n||"geo,hotel,eat,attr,vr",link_type:r||n||"geo,hotel,eat,attr",max:l||12,neighborhood_geos:!!u,requiredFields:s};if(""!==a?(h.nearby=!0,h.local=!0,h.parentids=a):h.global=!0,_&&""!==_&&(h.scopeFilter=_),d&&"[object Array]"===Object.prototype.toString.call(d)&&d.length>0&&(h.filter=d.join(",")),g)for(var p in g)g.hasOwnProperty(p)&&(h[p]=g[p]);if(sessionStorage&&m){var y=JSON.parse(sessionStorage.getItem("mapRect"));y&&(h.max_lat=y.max_lat,h.max_lon=y.max_lon,h.min_lat=y.min_lat,h.min_lon=y.min_lon)}return new o({method:"GET",url:"/TypeAheadJson",data:h,und)},success:function(e){c?e&&e.results&&e.results.length>0&&f.resolve(e)||f.reject(JS_location_not_found):e&&f.resolve(e)||f.reject(JS_location_not_found)}}),f.promise()}},n});
define("typeahead/TypeAhead.views",["vanillajs","ta/util/Deferred","utils/object/set-props","ta/util/I18N"],function(e,s,a,t){var i={};i.iconMap={ALL:"sprite-typeahead-all",GEO:"sprite-typeahead-destination",HOTELOVERVIEW:"sprite-typeahead-destination",HOTEL:"sprite-typeahead-hotel",ATTRACTION:"sprite-typeahead-attraction",EATERY:"sprite-typeahead-restaurant",VACATION_RENTAL:"sprite-typeahead-vr",FLIGHTS_TO:"sprite-typeahead-flight",AIRPORT:"sprite-typeahead-flight",AIRLINE:"sprite-typeahead-flight",THEME_PARK:"sprite-typeahead-themepark",VACATION_PACKAGE:"sprite-typeahead-hotel",SMART_DEAL:"sprite-typeahead-hotel",CHILD_TOP:"sprite-typeahead-connector-top",CHILD_BOTTOM:"sprite-typeahead-connector-bottom",NEIGHBORHOOD:"sprite-typeahead-neighborhood",TRAVEL_GUIDE:"sprite-typeahead-travel-guide"},i.iconFontMap={ALL:"ui_icon globe-world",GEO:"ui_icon map-pin-fill",HOTELOVERVIEW:"ui_icon map-pin-fill",HOTEL:"ui_icon hotels",ATTRACTION:"ui_icon attractions",EATERY:"ui_icon restaurants",VACATION_RENTAL:"ui_icon vacation-rentals",FLIGHTS_TO:"ui_icon flights",AIRPORT:"ui_icon flights",THEME_PARK:"ui_icon amusement-parks",VACATION_PACKAGE:"ui_icon hotels",SMART_DEAL:"ui_icon hotels",CHILD_TOP:"sprite-typeahead-connector-top",CHILD_BOTTOM:"sprite-typeahead-connector-bottom",NEIGHBORHOOD:"ui_icon neighborhoods",TRAVEL_GUIDE:"ui_icon guides",AIRLINE:"ui_icon flights",SHIP:"ui_icon cruises",CRUISE_LINE:"ui_icon cruises",CAR_RENTAL_OFFICE:"ui_icon rental-cars",KEYWORD:"ui_icon search",TAG:"ui_icon search",ACTIVITY:"ui_icon activities",NEARBY:"ui_icon nearby",NEAR_POI:"ui_icon map-pin-fill",UNIVERSITY:"ui_icon classes-workshops",TRAIN_STATION:"ui_icon train",USER_PROFILE:"ui_icon friend-fill",USER_PROFILE_VERIFIED:"ui_icon verified-checkmark",PAGE:"ui_icon search",SHOPPING:"ui_icon shopping-bag",PORT:"ui_icon ports",GENERAL_HOSPITAL:"ui_icon hospital",FERRY:"ui_icon cruises",CORPORATION:"ui_icon office"};var r={PAGE:!0,BLENDER_PAGE:!0,NEAR_POI:!0,VACATION_PACKAGE:!0,SMART_DEAL:!0,FLIGHTS_TO:!0,USER_PROFILE:!0},n={FLIGHTS_TO:!0,VACATION_PACKAGE:!0};i.escapt;")};var o=function(e,s){var a={},t=[];return e.foh(e)}),s.forEach(function(e){var s=a[e];if(s)for(var i=0;i<s.length;i++)t.push(s[i])}),t};i.configTypeAheadOptionsForSortingByPOIType=function(e,a){var t=e.postResultsFnList||[];t.push(function(e){var t=s();return e.results=o(e.results,a),t.resolve(e),t.promise()}),e.postResultsFnList=t,e.listTemplate=function(e){var s=e.results,a=[];if(s.length>0){a.push("<ul>"),s.forEach(function(){var e="";return function(s){if(e!=s.type){e=s.type;var a=[s.rendered];a.push('<span class="label">'),a.push(s.title),a.push('<img src="/img2/x.gif" class="icon hidden" alt="">'),a.push("</span>"),s.rendered=a.join("")}}}());var t=function(){var e="",s=document.createElement("div");return function(a){var t='<li class="typeahead-choice '+i.escapeHTML(a.title.toLowerCase())+'">'+a.rendered+"</li>";return e!=a.type&&(e=a.type,s.innerHTML=t,s.firstChild.className+=" first",t=s.innerHTML),t}}();a.push(s.map(t).join("")),a.push("</ul>")}return a.join("")}};var l={showChildren:!1,tagLabels:null,poiClasses:"",geoClasses:""};return i.itemTemplate=function(e){e=a(l,e);var s=e.useIconFont,o=s?i.iconFontMap:i.iconMap,p=function(e,s){var a="";if(e&&Object.keys(e).length>0){var t=e[s];a=t||e.values()[0]}return a};return function(a,l){var u,c=[],h="url_small",d="",v="";l=l||{};var _=a.details||a,g=_.highlighted_name||_.name||"",f="TAG"===a.data_type||"local_tag"===a.scope||"overview"===a.scope||e.simpleChild&&a.isChild,y=f?"":_.geo_name||"";if("NEAR_POI"===a.data_type&&(g=a.find_near_name),l.HTMLEscape&&(g=i.escapeHTML(g),y=i.escapeHTML(y)),!a.isChild){a.isNeighborhood?u=o.NEIGHBORHOOD:"NEAR_POI"===a.data_type?u=o.NEAR_POI:"USER_PROFILE"===a.data_type?(v=a.avatar?p(a.avatar,h):"",u=o.USER_PROFILE+(v?" user-avatar":""),d=v?'<span class="ui_avatar labeled-profile-icon small"><img src="'+v+'" class=""></span>':""):u="PAGE"===a.data_type?o.PAGE:"TAG"===a.data_type?o[a.data_type]:o[a.type];var E=a.icon_type||a.data_type;if(E&&n[E.toUpperCase()]&&(u=o[E.toUpperCase()]),!s&&u&&E&&r[E]&&(u+="-list"),u){var T=(s?"":"sprite-image ")+"leftIcon "+u;c.push('<div class="'+T+'">'+d+"</div>")}}var R,A=e.tagLabels;A&&(a.isChild&&a.parent&&a.parent.moved?R=A.newLocation:a.moved===!0?R=A.moved:a.closed===!0&&(R=A.closed));var L="poi-name "+e.poiClasses;y||(L+=" no-geo"),"NEAR_POI"===a.data_type&&(L+=" near_poi"),d&&(L+=" user-avatar"),R&&(L+=" tagged-poi");var I="geo-name "+e.geoClasses;c.push('<div class="main-content">');var O=a.document_id;if(O&&(O=i.escapeHTML(a.document_id)),c.push('<div class="first-row" docId="'+O+'">'),c.push('<span class="'+L+'">'),e.debug&&(c.push('<span class="debug">'),c.push("number"==typeof a.order?a.order:"??"),c.push("("+("number"==typeof a.score?a.score:"??")+")"),c.push("&nbsp;</span>")),c.push(g),"USER_PROFILE"===a.data_type&&a.details.verified===!0){var m=" detailIcon "+o.USER_PROFILE_VERIFIED;c.push("<span>&nbsp;</span>"),c.push('<span class="'+m+'"></span>')}if(c.push("</span>"),R&&c.push('<div class="tag-container"><span class="search-tagged-poi" >'+R+"</span></div>"),c.push("</div>"),c.push('<div class="second-row">'),"USER_PROFILE"===a.data_type){var b=e.geoClasses,C=d?" user-avatar":"";if(c.push('<span class="'+b+C+'">'),c.push('<span class="username">'+a.details.user_name+"</span>"),a.details.followers){c.push("<span>&nbsp;&bull;&nbsp;</span>");var H="";t.isRtl()&&(H=' dir="rtl"'),a.following?c.push("<span"+H+">"+a.following+"</span>"):c.push("<span"+H+">"+a.details.followers+"</span>")}c.push("</span>"),c.push("</div>")}else y?(c.push('<span class="'+I+'">'+y+"</span>"),c.push("</div>")):c.pop();if(c.push("</div>"),e.showChildren&&a.isChild){c.unshift('<div class="child'+(R?" tagged-poi":"")+'">'),c.push("</div>");var N=a.lastChild?o.CHILD_BOTTOM:o.CHILD_TOP,P="sprite-image childIcon leftIcon "+N;c.unshift('<div class="'+P+'"></div>')}return c.join("")}},i.configureTypeAheadForSegmentedResults=function(e,a){var t=a||{},r=t.boldSearchQuery,n=t.groupByScope,o=e.postResultsFnList||[],l="search",p="rescue",u="history",c="suggested",h="overview",d="global",v="local",_="brands",g="hotels",f=function(e){var s={},a=function(e){return e.data_type&&"SEARCH"===e.data_type.toUpperCase()?p:e.type&&"SEARCH"===e.type.toUpperCase()?l:"history"==e.scope?u:"suggested"==e.scope?c:"overview"==e.scope?h:e.scope&&0===e.scope.lastIndexOf("local",0)?v:n&&"global"==e.scope?v:e.data_type&&"ADDRESS"===e.data_type.toUpperCase()?v:"brands"==e.scope?_:"hotels"==e.scope?g:d};return e.forEach(function(e){var t=a(e);if("history"!==t||!e.isChild){var i=s[t]=s[t]||[];i.push(e)}}),s};return o.push(function(e){var a=s();return t.debug&&e.results.foer=s}),e.results=function(e){var s=[];e.forEach(function(e){if(s.push(e),e.children)for(var a=e.children.length,t=0;t<a;t++){var i=e.children[t];i.scope=e.scope,i.parent=e,s.push(i)}});for(var a=f(s),t=[],i=[h,u,c,v,d,l,_,g,p],r=0;r<i.length;r++){var n,o=i[r];n=a[o],n&&(t=t.concat(n))}return t}(e.results),a.resolve(e),a.promise()}),e.postResultsFnList=o,e.listTemplate=function(e){var s=[],a=e.results,n=f(a),o=!1,y=!1,E=!1,T=0==a.length,R=!(e.query&&e.query.query||n[v]&&0!==n[v].length||n[d]&&0!==n[d].length),A=function(e,a){var t="resultContainer"+(a?" "+a:"");s.push('<ul class="'+t+'">');for(var i=0;i<e.length;i++){var r=e[i];r&&(s.push('<li class="'+(r.wrapperCSS||"")+'">'),s.push(r.rendered),s.push("</li>"))}s.push("</ul>")};if(n[h]&&n[h].length>0&&(E=!0,t.overviewLabel&&s.push('<div class="title overview">'+t.overviewLabel+"</div>"),A(n[h],"overview")),n[u]&&n[u].length>0&&(o=!0,t.historyLabel&&s.push('<div class="title history">'+t.historyLabel+"</div>"),A(n[u],e.query?null:"history bold_names")),n[c]&&n[c].length>0&&(s.push('<div class="title history">'+t.suggestedLabel+"</div>"),A(n[c],"suggested")),!R&&t.localLabel&&(n[v]&&n[v].length>0||t.noResultsMessage&&!E)&&(y=!0),n[_]&&n[_].length>0){n[_];!e.integrated&&t.brandsLabel&&s.push('<div class="title">'+t.brandsLabel+"</div>"),A(n[_])}if(n[g]&&n[g].length>0&&(t.hotelsLabel&&s.push('<div class="title">'+t.hotelsLabel+"</div>"),A(n[g])),n[v]&&n[v].length>0?(y=!0,A(n[v],"local")):y&&t.showNoResultsMessage&&s.push('<div class="no-results">'+t.noResultsMessage+"</div>"),n[d]&&n[d].length>0&&(t.globalLabel&&(y||o||t.alwaysShowGlobal)&&s.push('<div class="title global">'+t.globalLabel+"</div>"),A(n[d],"global")),!R&&n[l]&&n[l].length>0){var L=n[l][0],I=e.query&&e.query.query||"",O="search resultContainer";L.noResults&&(O+=" noResults"),r?s.push('<ul class="'+O+'"><li class="searchRow">'+L.name.replace("%","<b>"+i.escapeHTML(I)+"</b>")+"</div></li></ul>"):s.push('<ul class="'+O+'"><li class="searchRow">'+i.escapeHTML(L.name.replace("%",I))+" &raquo;</div></li></ul>")}return n[p]&&n[p].length>0&&A(n[p],"rescue"),T&&!R&&t.showNoResultsMessage&&t.noResultsMessage&&s.push('<div class="no-results">'+t.noResultsMessage+"</div>"),s.join("")},t},i.simpleItemTemplate=function(){return function(e){return[e.details.name,'<span class="addr">',e.details.address,"</span>"].join("")}},i.simpleListTemplate=function(e){return function(s){if(!s.results||!s.results.length)return'<div class="noResults">'+e+"</div>";var a,t=s.results||[],i=["<ul>"];return t.forEach(function(e){i.push("<li>"),e.title!==a&&(a=e.title,i.push('<span class="label">',a,'<img src="/img2/icons/typeahead/',e.type.slice(0,1).toLowerCase(),'.gif"/></span>')),i.push(e.rendered),i.push("</li>")}),i.push("</ul>"),i.join("")}},i.ptptListTemplate=function(e){function s(e){var s="history"==e.scope,a=e.type?e.type.toLowerCase():"",t=s?"history":a;return{historyScope:s,choiceType:a,headerType:t}}for(var a=['<div class="typeahead-choices">'],t={},i={history:!0},r=CDNHOST+"/img2/x.gif",n=e.results,o=n.length,l=0;l<o;l++){var p=n[l],u=s(p),c="typeahead-choice "+u.choiceType,h=!1;u.headerType in t||(c+=" first",t[u.headerType]=!0,h=!0),u.historyScope&&(c+=" history"),a.push('<div class="'+c+'">'),a.push('<img src="'+r+'" class="icon" alt="">'),a.push('<span class="cutoff">'),a.push(p.rendered),a.push("</span>"),u.historyScope&&a.push('<img src="'+r+'" class="history_icon" alt="">'),a.push("</div>");var d=n[l+1],v=d&&s(d);v&&i[u.headerType]&&v.headerType!=u.headerType&&a.push('<div class="divider"></div>')}return a.push("</div>"),a.join("")},i});
define("utils/string/Tags",["babel/babel-helpers","vanillajs"],function(e,n){"use strict";function t(e){return e=e||"",new RegExp("</?"+e+"([^>]+)?>","gi")}return{getTags:function(e,n){return e.match(t(n))||[]},stri,"")}}});
define("lib/TypeAhead",["lib/jquery-amd","api-mod","ta/util/Deferred","utils/ajax","ta/common/Search","ta/Core/TA.Record","ta/Browser","utils/browserutils","ta/util/String","ns-exporter","typeahead/TypeAhead.utils","typeahead/TypeAhead.views","utils/bindAll","utils/string/Tags"],function(t,s,e,i,o,n,r,h,l,a,u,c,p,d){"use strict";var f,y={},v={results:null,showOnEmpty:!1,integrate:!1,highlight:!1,maxItems:5,types:["geo","eatery","hotel","attraction"],linkType:"url",predicate:null,minChars:null,sort:null,shouldReplace:!0,getMatchingKey:function(t){return t.value},bottom:!1},m={minChars:1,search:null,itemTemplate:function(t){return t&&t.value},listTemplate:function(t){var s=t.results?t.results:t;return'<div class="typeahead-choices">'+iv>"}).join("")+"</div>"},errorTemplate:function(t){return'<div class="message">'+t+"</div>"},resolveSelealue},alue},shouldSubmit:function(){return!0},validator:null,containerClass:"typeahead-container",itemSelector:".typeahead-choice",errorClass:"error",defaultTextClass:!1,defaultValue:null,width:!0,showOnFocus:!0,searchOnFocus:!0,onUserFocus:null,autoSelectFirst:!1,disableAutoSelectIfEmpty:!1,selectOnBlur:!0,assumeOnBlur:!0,onUserBlur:null,restoreOnFocus:!1,cycleInput:!0,autopopulateHighlighted:!0,selectInputText:!0,onSelect:null,onRestore:null,onSync:null,onRender:null,onShow:null,onHide:null,onError:null,nextField:null,offsetY:0,offsetX:0,syncro:null,containerParent:document.body,positionRelative:!1,unselectOnEscape:!1,cacheResults:!1,autoHighlightFirst:!1,ignoreKeysWhenInvisible:!1,name:"unknown",geoId:void 0,startEventOn:"focus",queryLengthLimit:100,postResultsFnList:null,jpFirefoxIME:!1,jpFirefoxIMEInterval:500,clearDefaultTextOnFocus:!0,focusOnCreation:!1,searchParams:null,errorOnSearchFailure:"error",enableQueryDelay:!1,throttleRequests:!1,doSelectionBeforeLogging:!1,highlightInputOnFocus:!1,showStaticResBeforeSearch:!1,staticResults:null,isOverlay:!0,selectFirstOnMouseOut:!1,highlightMatches:!1,includeStaticResultsInMaxItems:!1},g=9,x=13,S=16,R=17,I=18,b=20,C=27,T=37,w=38,q=39,O=40,F=91,E="click",P="enter",H="tab",k="bl_id"},D=function(){if(f){if("function"==typeof f.abort)try{f.abort()}catch(t){}f=null}},L=function(t){f=t},B=function(t){D();var s=e(),o=this.getSearchParams();o.query=t,o.action="API",o.uiOrigin=this.options.name,o.source=this.options.name,o.startTime=this.options.startTime,o.searchSessionId=A(this.options),o.isNearby?o.scope=0:o.scope=o.parentids?o.parentids:-1;var n={method:"GET",url:"/TypeAheadJson",data:o};return this.options.throttleRequests&&(n.beforeSend=function(t){L(t)}),n.success=function(e,i){if("success"===i&&e){var o=!!e.results;o||(e={results:e,query:{query:t}}),s.resolve(e)}},i(n),s.promise()},M=function(){return this.source.value},N=function(t){for(var s=0,e=this.source.value.length-1;e>=0;e--){s++;var i=this.source.value.charCodeAt(e);if((i>=19968&&i<=40959||i>=12352&&i<=12543||i>=44032&&i<=55295)&&s++,!t&&s>=this.options.minChars)return!0}return!!t&&s},z=function(){var t=this.source,s=void 0;this.hasDefaultText()?s=this.options.clearDefaultTextOnFocus===!0?t.value.length:0:this.options.highlightInputOnFocus&&(s=t.value.length),void 0!==s&&setTimeout(function(){document.activeElement==t&&t.setSelectionRange(0,s)},0)},Q=function(s){if(this.hasDefaultText()&&this.options.clearDefaultTextOnFocus!==!0&&(this.options.defaultTextClass&&t(this.source).removeClass(this.options.defaultTextClass),this.source.value=""),"type"===this.options.startEventOn&&Z.call(this),!this.options.ignoreKeysWhenInvisible||this.visible){switch(s.keyCode){case x:if(s.preventDefault(),s.stopPropagation(),this.selectedIndex>=0)this.select(!0,P,s),rt.call(this);else if(this.options.assumeOnBlur&&this.results&&this.results.length&&("function"==typeof this.options.assumeOnBlur?this.setSelectedIndex(this.options.assumeOnBlur(this)):this.setSelectedIndex(0),X.call(this),this.select(!0,P,s),rt.call(this)),this.options.shouldSubmit()&&(!this.options.validator||this.options.validator(s))){if(this.options.onSubmit){var e=o.getUrlFromForm(this.source.form),i=event?event.type:"";this.options.onSubmit(this,e,!0,i)}this.abortSearch(),this.hide(),this.source.form.submit()}break;case O:this.highlightNextChoice(),s.preventDefault(),s.stopPropagation();break;case w:this.hightlightPreviousChoice(),s.preventDefault(),s.stopPropagation();break;case C:this.restore(),this.hide();break;case g:this.options.selectOnTab&&this.selectedIndex>=0&&!this.ignoreSelectOnTab?(s.preventDefault(),s.stopPropagation(),this.select(!0,H,s),rt.call(this)):this.tabPressed=!0}this.options.onKeyDown&&this.options.onKeyDown(s,this)}},_=function(){this.source.value.length||setTimeout(G.bind(this),0)},j=function(t){setTimeout(G.bind(this),0)},U=function(t){if(t)switch(t.keyCode){case g:case S:case R:case I:case b:case T:case w:case q:case O:case F:case x:case C:return}G.call(thihis)},K=function(){var t=this.source.value;this.intervalHandler&&window.clearTimeout(this.intervalHandler),!this.options.enableQueryDelay||this.lastQueryTime+500<=(new Date).getTime()?(this.intervalHandler=null,this.search()):this.intervalHandler=setTimeout(function(){this.aborted||this.source.value!==t||this.search()}.bind(this),this.options.throttleRequests?50:300)},Y=function(){var t=this.results&&0===this.results.length;return!this.hasDefaultText()&&N.call(this)&&this.source.value!==this.query&&(this.selectedIndex<0||!this.results||t||this.source.value!==this.results[this.selectedIndex].value)},G=function(){D();var s=N.call(this,!0);if(!Y.call(this)&&s<this.options.minChars){0===s&&"function"==typeof this.options.clearquery&&this.options.clearquery(this),this.selected&&t(this.selected).removeClass("selected"),t(this.source).removeClass(this.options.errorClass),this.results=null,this.error=null,this.setSelectedIndex(-1),this.selected=null,this.query=null,this.staticResultsShown=null;var e=this.source&&(!this.source.value||0==ct(this.source.value).trim().length);this.shouldShowStaticResults()&&(e||this.hasDefaultText()||this.options.showStaticResBeforeSearch)?this.showStaticResultsIfEnabled():this.hide()}else K.call(this,this.query)},J=function(t){this.results&&this.results.length&&(this.setSelectedIndex(this.selectedIndex+t),this.selectedIndex>=this.results.length?this.setSelectedIndex(this.options.cycleInput?-1:0):this.selectedIndex<(this.options.cycleInput?-1:0)&&this.setSelectedIndex(this.results.length-1),X.call(this))},X=function(e){this.ignoreSelectOnTab=e&&this.options.selectFirstOnMouseOut,this.selected&&t(this.selected).removeClass("selected"),-1===this.selectedIndex?(this.selected=null,this.options.autopopulateHighlighted&&this.query&&(this.source.value=this.query),this.options.selectInputText&&this.source.select(!1)):(this.selected=this.items[this.selectedIndex],s.addClass(this.selected,"selected"),this.options.autopopulateHighlighted&&this.results&&(this.source.value=this.options.resolveSelection(this.results[this.selectedIndex])))},W=function(t,s){if(!s)return!1;for(var e=0;e<s.length;++e){var i=s[e];if(i&&i.match(t))return!0}return!1},$=function(t,s,e,o,n,r,h,l,a,u,c,p,d,f,y,v,m,g,x,S,R){var I,b={action:"RECORD",eventType:t,uiOrigin:a,scope:"GEOSCOPE"===a?1:l>=0?l:void 0,fromHistory:p,hadHistory:d,type:v.type,value:s,indexInType:v.indexInType?v.indexInType:0,tagId:v.tagId?v.tagId:0,source:a,startTime:u,selDepth:e,isChild:v.isChild,totalNum:o,userInteractionType:r,errors:h,query:c,dataType:v.data_type,url:v.url,searchSessionId:g,documentId:R};m&&S?("function"==typeof n&&n(),"function"==typeof y&&y(),I=function(){}):"function"==typeof n&&(m?(n(),S||"function"!=typeof y||(I=y)):I=function(){n(),S||"function"!=typeof y||y()}),"function"==typeof f&&(b=f(b,v,x));var C={method:"GET",url:"/TypeAheadJson",data:b,error:function(){I()},success:function(){I()}};i(C)},Z=function(){if(!this.startNotificationSent){this.startNotificationSent=!0,this.options.startTime=Date.now();var t=this.options.geoId,s=this.options.name,e=this.options.staticResults&&this.options.staticResults.history&&this.options.staticResults.history.results&&this.options.staticResults.history.results.length,o={method:"GET",data:{action:"RECORD",eventType:"start",uiOrigin:this.options.name,startTime:this.options.startTime,source:s,linkedTypeAhead:this.options.linkedTypeAhead?this.options.linkedTypeAhead.options.startTime:void 0,hadHistory:e,scope:t,searchSessionId:A(this.options)},url:"/TypeAheadJson"};i(o),this.options.trackingName&&0==y.entryEventRecorded&&(y.entryEventRecorded=!0,n.trackEventOnPage("desktop_typeahead","typeahead_entry",this.options.trackingName))}},tt=function(s){if(this.hasDefaultText()&&this.options.clearDefaultTextOnFocus===!0&&(t(this.source).removeClass(this.options.defaultTextClass),this.source.value=""),z.call(this),!this.autoFocusing){this.options.onUserFocus&&this.options.onUserFocus(this);var e=this.lastSuccessfulQuery!==this.query;this.options.showOnFocus&&!e&&this.show(),this.options.restoreOnFocus&&this.restore(),this.options.showOnFocus&&this.options.searchOnFocus&&this.query&&!this.results&&!this.error&&N.call(this)?this.search():this.showStaticResultsIfEnabled(),this.options.jpFirefoxIME&&st.call(this)}"focus"===this.options.startEventOn&&Z.call(this),this.autoFocusing=!1},st=function(){if(this.source==document.activeElement){var t=function(){G.call(this),this.jpTypeAheadTimerId&&clearTimeout(this.jpTypeAheadTimerId),this.jpTypeAheadTimerId=setTimeout(t.bind(this),this.options.jpFirefoxIMEInterval)};t.call(this)}},et=function(t,e){if(!this.checkMenuInteraction()){this.hide();var i=this.tabPressed;this.tabPressed=!1,this.options.restoreOnFocus&&!this.options.disableAutoSelectIfEmpty||this.query||(this.results=null,this.error=null,this.setSelectedIndex(-1),this.selected=null,this.items=[],this.container&&(this.container.innerHTML=""));var o=this.options.selectOnBlur&&-1!==this.selectedIndex;o&&this.select(i,i?H:k,t);var n=this.options.autoSelectFirst?0:-1;this.options.assumeOnBlur&&n===this.selectedIndex&&this.results&&this.results.length&&("function"==typeof this.options.assumeOnBlur?this.setSelectedIndex(this.options.assumeOnBlur(this)):this.setSelectedIndex(0),X.call(this),!o&&this.select(i,i?H:void 0,t)),this.source&&""===this.source.value&&(this.source.value=this.options.defaultValue,this.options.defaultTextClass&&s.addClass(this.source,this.options.defaultTextClass)),this.options.onUserBlur&&this.options.onUserBlur(this,t),this.jpTypeAheadTimerId&&clearTimeout(this.jpTypeAheadTimerId)}},it=function(t,e){if(!t)return null;if("string"==typeof e){for(;t&&"html"!=t.tagName;t=t.parentNode)if(s.hasClass(t,e)||"string"==typeof t.tagName&&t.tagName.toUpperCase()===e.toUpperCase())return t;return null}return t.parentNode},ot=function(t){this.options.autoHighlightFirst&&this.results&&this.results.length?this.setSelectedIndex(0):this.setSelectedIndex(-1),X.call(this)},nt=function(t,s){var e=s.target,i=it(e,this.options.itemSelector);if(i&&(e=i),!this.selected||this.selected!==e)for(var o=this.items.length-1;o>=0;o--)if(this.items[o]===e)return this.setSelectedIndex(o),void X.call(this,t)},rt=function(){var t,e=this.source.tabIndex;if(!1!==this.options.nextField&&(this.options.nextField&&("string"==typeof this.options.nextField?this.options.nextField=s.find(this.options.nextField):t="function"==typeof this.options.nextField?this.options.nextField(this):this.options.nextField),!1!==t)){if(!t&&e&&(e=parseInt(e,10)+1,t=s.find("[tabindex="+e+"]",this.source.form)),!t)for(var i=this.source.form.elements.length-1;i>=0;i--){var o=this.source.form.elements[i];if(this.source===o){t=this.source.form.elements[i+1];break}}t&&t.focus()}},ht=function(){this.options.syncro&&this.options.syncro.sync(this,{query:this.query,value:this.source.value,result:this.selectedIndex>=0&&this.results[this.selectedIndex]})},lt=function(){document.activeElement===this.source&&!this.aborted&&this.show()||et.call(this)},at=function(){for(var t,s,e,i,o=arguments[0]||{},n=1,r=arguments.length;n<r;n++)if(null!=(t=arguments[n]))for(s in t)e=o[s],i=t[s],o!==i&&(o[s]=i);return o},ut=function(e,i){if(this.setSource(e),this.lastQueryTime=0,this.disableOnBlur=!1,this.checkMenuInteraction=function(){return this.disableOnBlur},m.containerParent||(m.containerParent=document.body),this.options=at({},m,i),this.options.postResultsFnList=this.options.postResultsFnList||[],this.options.postResultsFn&&(this.options.postResultsFnList.unshift(this.options.postResultsFn),delete this.options.postResultsFn),this.options.staticResults)for(var o in this.options.staticResults)if(this.options.staticResults.hasOwnProperty(o)){var n=this.options.staticResults[o];this.addStaticResults(o,n)}this.staticResultsShown=null,this.setSelectedIndex(-1),this.selected=null,this.visible=!1,this.lastSuccessfulQuery="",this.options.defaultValue||""==this.options.defaultValue||(this.options.defaultValue=this.source.getAttribute("data-defaultValue")||this.source.defaultValue);var l={"class":this.options.containerClass};if(this.options.isOverlay){var a="position: absolute";a+=s.hasClass(document.body,"rtl")?"; right: -999em":"; left: -999em",a+="; "+("string"==typeof this.options.positionRelative?this.options.positionRelative:"top")+":-999px",l.style=a}this.container=s.createElement("div",l),this.options.containerParent.appendChild(this.container);lt()},c=function(t){this.disableOnBlur=!1,t.stopPropagation(),t.preventDefault(),this.select(!0,E,t),rt.call(this)};this.containerHandlers={mousedown:s.bind(u,this),click:s.bind(c,this)},window.FastClick&&(this.containerHandlers.touchstart=s.bind(nt,this,!1),this.containerHandlers.touchend=s.bind(c,this));for(var d in this.containerHandlers)s.addEvent(this.container,d,this.containerHandlers[d]);!0!==this.options.width||this.options.cssPositioning||(this.container.style.width=s.getSize(this.source).x+"px"),p(this,"cleanUp","show","hide","processResults","renderResults","renderError"),this.options.syncro&&this.options.syncro.add(this);var f=document.activeElement===this.source;this.options.showOnFocus&&f&&(this.hasDefaultText()&&(this.options.clearDefaultTextOnFocus===!0?(t(this.source).removeClass(this.options.defaultTextClass),this.source.value=""):s.addClass(this.source,this.options.defaultTextClass)),this.options.searchOnFocus&&this.source.value!==this.options.defaultValue&&N.call(this)&&(this.query&&(this.source.value=this.query),this.search())),r.isIE11orHigher()||("onpagehide"in window?window.addEventListener("pagehide",this.cleanUp,!1):s.addEvent(window,h.ie?"unload":"beforeunload",this.cleanUp)),this.options.jpFirefoxIME&&st.call(this),("creation"===this.options.startEventOn||"focus"===this.options.startEventOn&&f)&&Z.call(this),this.options.focusOnCreation===!0&&(this.autoFocusing=!0,this.source.focus()),z.call(this)};ut.prototype.getInputText=M,ut.prototype.getInputLength=N,ut.prototype.searchFn=B,ut.prototype.setGeoId=function(t){this.options.geoId=t,this.clearCache(),this.lastSuccessfulQuery="",this.results=null},ut.prototype.setCurrentPosition=function(t,s){this.options.position=t,this.options.nearby=s,this.clearCache(),this.lastSuccessfulQuery="",this.results=null};v" ")};ut.prototype.setSource=function(t,e){if(t&&(!this.source||e)){this.source=t,this.source.autocomplete="off",this.handlers={keyup:s.bind(U,this),focus:s.bind(tt,this),blur:s.bind(et,this),keydown:s.bind(Q,this),compositionend:s.bind(V,this)},window.FastClick&&(this.handlers.touchstart=s.bind(nt,this,!1));for(var i in this.handlers)s.addEvent(this.source,i,this.handlers[i]);this.source.addEventListener&&this.source.addEventListener("paste",j.bind(this)),this.source.addEventListener&&this.source.addEventListener("cut",j.bind(this)),this.source.addEventListener&&this.source.addEventListener("input",_.bind(this))}},ut.prototype.getNormalizeduery},ut.prototype.reset=function(){this.options.defaultTextClass&&s.addClass(this.source,this.options.defaultTextClass),t(this.source).removeClass(this.options.errorClass),this.error=null,this.container&&this.render(""),this.source.value=this.options.defaultValue||""},ut.prototype.getChosenResult=function(){var t=null;if(this.source&&this.source.value&&this.results)for(var s=this.source.value,e=0;e<this.results.length;e++){var i=this.results[e];if(s.toLowerCase()===l.stripHTMLFromText(i.name).toLowerCase()){t=i;break}}return t},ut.prototype.clearRe("")},ut.prototype.search=function(t,i){this.selected=null,this.lastQueryTime=Date.now(),this.setSelectedIndex(-1),this.query=this.source.value;var o=this.getNormalizedQuery();if(this.aborted=!1,this.options.cacheResults&&this.resultsCache&&this.resultsCache[o])this.processResults(this.resultsCache[o],!0),!1!==t&&lt.call(this),i&&i();else{var n;if(this.query.length<=this.options.queryLengthLimit)n=this.options.search?this.options.search(this.query,this):B.call(this,this.query);else{var r=e(),h={results:[],query:{query:this.query}};r.resolve(h),n=r.promise()}n=n.success(this.integrateStaticResults.bind(this));for(var l=this.options.postResultsFnList,a=0;a<l.length;a++)n=n.success(l[a]);n=n.success(this.processResults).failure(this.renderError),!1!==t&&n.always(s.bind(lt,this)),i&&n.always(i)}},ut.prototype.processResults=function(t,s){var e=this.options.itemTemplate,i=this;s=this.options.forceProcessResults||s;var o=!!t.results;o||(t={results:t,query:{query:this.query}});var n=t.combinedResults||t.results;if(this.options.highlightMatches){for(var r,h=[],l=t.query&&t.query.query||this.query,a=0;a<n.length;a++){var u=n[a];if(u&&u.details&&u.details.name&&(u.details.name=d.stripTags(u.details.name),l)){var c=u.details.name;r=new RegExp("\\b"+pt(l),"i"),(c&&c.match(r)||W(r,u.aliases))&&(u=at({},u),u.details.name=u.details.name.replace(r,dt),h.push(u))}}h.length&&(t.results=n=h)}if(this.options.preprocessResults&&(t.results=n=this.options.preprocessResults(this,n)),this.options.cacheResults&&o){var p=ct(t.query&&t.query.query?t.query.query:this.getNormalizedQuery());this.resultsCache||(this.resultsCache={}),this.resultsCache[p]=t}(s||this.getNormalizedQuery()!==ct(this.lastSuccessfulQuery))&&(this.results=n,this.error=null,this.setSelectedIndex(-1),this.options.autoHighlightFirst&&this.results&&this.results.length&&this.setSelectedIndex(0),n.forEach(function(t,s){t.index=s,t.rendered=e(t),i.options.onProcessResult&&i.options.onProcessResult(t,s,i)})),this.renderResults(t,null,s)},ut.prototype.processResults,!0)},ut.prototype.renderResults=function(e,i,o){if(o||this.getNormalizedQuery()!==ct(this.lastSuccessfulQuery)){var n=this,r=e.results?e.results:e;this.lastSuccessfulQuery=e.query&&e.query.query?e.query.query:null,t(this.container).removeClass(this.options.errorClass),t(this.source).removeClass(this.options.errorClass);var h=this.options.listTemplate(e);if(i){var l=t(this.options.errorTemplate(i)).add(t(h));h=t("<div></div>").append(l).get(0)}this.render(h),this.items=s.select(this.options.itemSelector,this.container),this.items.forEach(function(t){s.addEvent(t,"mouseover",nt.bind(n,!0)),n.options.selectFirstOnMouseOut&&s.addEvent(t,"mouseout",ot.bind(n))}),this.selectedIndex>=0?X.call(this):this.options.autoSelectFirst&&this.highlightNextChoice(),this.options.onRender&&this.options.onRender(this,r)}},ut.prototype.setSelectedIndex=function(t){this.selectedIndex=t,this.options&&this.options.onSetSelectedIndex&&this.options.onSetSelectedIndex(t,this)},ut.prototype.renderError=function(t,e){e&&this.results?this.renderResults(this.results,t):this.results=null,this.error=t,s.addClass(this.container,this.options.errorClass),s.addClass(this.source,this.options.errorClass),!e&&this.render(this.options.errorTemplate(t)),this.options.onError&&this.options.onError(this,t)},ut.prototype.render=function(t){this.container&&("string"==typeof t?this.container.innerHTML=t:"object"==typeof t&&(this.container.innerHTML="",this.container.appendChild(t)))},ut.prototype.show=function(){if(!this.container||this.visible||!this.container.childNodes.length)return this;var t=s.getPosition(this.source),e=s.getSize(this.source),i=t.x||t.left,o=t.y||t.top;if(this.options.cssPositioning)this.container.style.right="",this.container.style.left="",this.container.style.top="";else if(this.options.positionRelative)s.hasClass(document.body,"rtl")?this.container.style.right="auto":this.container.style.left=(this.options.offsetX||0)+"px","string"==typeof this.options.positionRelative?this.container.style[this.options.positionRelative]=e.y+(this.options.offsetY||0)+"px":this.container.style.top=e.y+(this.options.offsetY||0)+"px";else if(this.container.style.right="auto",this.container.style.left=i+(this.options.offsetX||0)+"px",this.options.positionAbove){var n=s.getSize(this.container);this.container.style.top=o-n.y+(this.options.offsetY||0)+"px"}else this.container.style.top=o+e.y+(this.options.offsetY||0)+"px";return this.visible=!0,this.hasBeenShown=!0,this.options.onShow&&this.options.onShow(this),this.options.onResize&&(this._resizeCb=this.options.onResize.bind(null,this),s.addEvent(window,"resize",this._resizeCb)),this},ut.prototype.hide=function(){return!(!this.visible||!this.container)&&(this.options.isOverlay&&(s.hasClass(document.body,"rtl")?this.container.style.right="-999em":this.container.style.left="-999em",this.container.style["string"==typeof this.options.positionRelative?this.options.positionRelative:"top"]=-999),this.visible=!1,this.options.onHide&&this.options.onHide(this),this._resizeCb&&(s.removeEvent(window,"resize",this._resizeCb),this._resizeCb=null),this)},ut.prototype.highlightNextCs,1)},ut.prototype.hightlightPreviousC,-1)},ut.prototype.select=function(s,e,i){if(this.hide(),!(this.selectedIndex<0)&&this.results){this.source.value=this.options.resolveSelection(this.results[this.selectedIndex]),this.error&&(t(this.container).removeClass(this.options.errorClass),t(this.source).removeClass(this.options.errorClass),this.error=null,this.renderResults(this.results));var n;if(this.options.onSelect&&(n=this.options.onSelect.bind(this.options,this.results[this.selectedIndex],this.source.value,this,s,e,i)),s){var r=this.results[this.selectedIndex],h=0;this.results&&(h=this.results.length);var l=this.lastSuccessfulQuery?this.lastSuccessfulQuery:this.query,a="history"===r.scope,u=this.options.loggingOverride;u&&(u=u.bind(this));var c=this.options.onSelectNavigate;c&&(c=c.bind(this));var p,d=this.staticResultsShown&&this.staticResultsShown.history,f=this.options.doSelectionBeforeLogging,y=A(this.options),v=o.getUrlFromForm(this.source.form),m=r.document_id;p="NEARBY"===r.type?0:"ALL"===r.type?1:r.value,"SEARCH"===r.type?$("search_bttn",void 0,void 0,void 0,n,e,null,this.options.geoId,this.options.name,this.options.startTime,l,a,d,u,c,r,f,y,v,this.options.neverRedirects,void 0):$("select",p,this.selectedIndex+1,h,n,e,null,this.options.geoId,this.options.name,this.options.startTime,l,a,d,u,c,r,f,y,v,this.options.neverRedirects,m)}else n&&n();return ht.call(this),this}},ut.prototype.restore=function(){return this.query&&this.query.length&&(this.source.value=this.query),this.setSelectedIndex(-1),this.selected&&(t(this.selected).removeClass("selected"),this.selected=null),this.options.autoSelectFirst&&this.highlightNextChoice(),this.options.onRestore&&this.options.onRestore(this.query),ht.call(this),this},ut.prototype.sync=function(e){var i=this;this.query&&this.query!==e.query&&(this.results=null,this.error=null),this.query=e.query,e.value&&(this.source.value=e.value),this.setSelectedIndex(-1),this.selected&&t(this.selected).removeClass("selected");var o=function(){if(i.results&&i.results.length){var o=i.results.some(function(t,s){return!!i.options.equal(t,e.result)&&(i.setSelectedIndex(s),!0)});!o&&i.options.assumeOnBlur&&i.setSelectedIndex(0),i.selectedIndex>=0&&(i.selected&&t(i.selected).removeClass("selected"),i.selected=i.items[i.selectedIndex],s.addClass(i.selected,"selected"),i.source.value=i.options.resolveSelection(i.results[i.selectedIndex]),i.options.onSelect&&i.options.onSelect(i.results[i.selectedIndex],i.source.value,i,!1))}i.options.onSync&&i.options.onSync(i.query,i.source.value,i.selectedIndex>=0&&i.results[i.selectedIndex])};this.results?o():(this.query&&(this.source.value=this.query),this.search(!1,o))},ut.prototype.cleanUp=function(){this.container=null,this.item=null,this.selected=null,this.source=null,this.setSelectedIndex(-1),this.query=null,this.staticResultsShown=null,this.results=null,this.error=null,this.timeoutHandler=null,this.clearCache()},ut.prototype.clearnull},ut.prototype.abortSler)},ut.prototype.hasDefaulalue},ut.prototype.integrateStaticResults=function(t){var i=t.results||t;s.isArray(i)||(i=[]);var o=t.query&&t.query.query||this.query,n=!1;t.normalized&&t.normalized.query&&(o=t.normalized.query,n=!0);var r=i.length>0&&i[i.length-1];r&&"SEARCH"==r.type&&"SEARCH"!==r.data_type?i.length-=1:r=null;var h=this.getStaticResultsMatchingQuery(o,n);if(!h||!h.length)return i;for(var l={},a=0;a<h.length;a++){for(var u=h[a],c=[],p=0;p<u.results.length;p++){var d=u.results[p],f=u.getMatchingKey(d);l.hasOwnProperty(f)||(c.push(d),l[f]=[a,c.length-1])}u.results=c}for(var y=0;y<i.length;y++)for(var v=i[y],m=!1,g=0;g<h.length&&!m;g++){var x=h[g],f=x.getMatchingKey(v),S=l[f];S&&S[0]==g&&(x.shouldReplace&&!v.isChild&&(v.scope=x.results[S[1]].scope),x.results[S[1]]=v,i[y]=null,m=!0)}for(var R=[],g=0;g<h.length;g++){var x=h[g];if(!u.bottom)for(var y=0;y<x.results.length;y++){var I=x.results[y];I&&R.push(I)}}R.push.apply(R,i.filter(function(t){return!!t}));for(var g=0;g<h.length;g++)if(u.bottom)for(var x=h[g],y=0;y<x.results.length;y++){var I=x.results[y];I&&R.push(I)}r&&R.push(r);var b;b=this.options.maxResults&&this.options.includeStaticResultsInMaxItems?R.slice(0,this.options.maxResults):R,t.results?t.results=b:t=b;var C={};for(var T in h)if(h.hasOwnProperty(T)){var u=h[T];u.results&&u.results.fl!=t}).length&&(C[T]=!0)}this.staticResultsShown=C,t.integrated=!0,t.combinedResults=b;var w=e();return w.resolve(t),w.promise()};var pt=function(t){return t.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1"/b>"};return ut.prototype.getStaticResultsMatchingQuery=function(t,s){if(!t||!t.length)return[];var e=[],i=new RegExp("\\b"+pt(t),"i"),o=this;for(var n in this.options.staticResults)if(this.options.staticResults.hasOwnProperty(n)){var r=this.options.staticResults[n];if(!(t.length<r.minChars)&&r.integrate){for(var h=r.results,l=[],a=0;a<h.length&&(!o.options.maxResults||l.length<o.options.maxResults)&&l.length<r.maxItems;a++){var u=h[a];if(u){var c=u.name;s&&u.normalized_name&&(c=u.normalized_name),(c&&c.match(i)||W(i,u.aliases))&&(r.highlight&&!this.options.highlightMatches&&(u=at({},u),u.name=u.name.replace(i,dt)),l.push(u))}}if(l.length){var p=at({},r);p.results=l,e.push(p)}}}return e},ut.prototype.shouldShowStaticResults=function(){var t=!!this.query&&this.query.length>0,s=this.lastSuccessfulQuery!==this.query;if(this.options.showOnFocus&&(!t||s))for(var e in this.options.staticResults)if(this.options.staticResults.hasOwnProperty(e)){var i=this.options.staticResults[e];if(i.showOnEmpty)return!0}return!1},ut.prototype.getSearchParams=function(){return this.options.searchParams?"function"==typeof this.options.searchParams?this.options.searchParams(this):this.options.searchParams:{}},ut.prototype.showStaticResultsIfEnabled=function(){if(this.shouldShowStaticResults()){var t={},s=[];for(var i in this.options.staticResults)if(this.options.staticResults.hasOwnProperty(i)){var o=this.options.staticResults[i];if(o.showOnEmpty){var n=o.results.slice(0,o.maxItems);o.sort&&(n=n.sort(o.sort)),t[i]=!0,s=s.concat(n)}}this.staticResultsShown=t;var r=e(!0);setTi:s})},0);for(var h=r.promise(),l=this.options.postResultsFnList,a=0;a<l.length;a++)h=h.success(l[a]);var u=this;h=h.success(this.processResultsForce.bind(this)),h.always(function(){u.show()})}},ut.prototype.addStaticResults=function(t,s){if(this.options.staticResults=this.options.staticResults||{},!s||!s.results)return void delete this.options.staticResults[t];var e=function(t,s){var e=at({},t);return t.urls&&t.urls.some(function(t){return t.url_type==s.linkType&&(e.url=t.url,!0)}),e},i=at({},v,s),o=[].concat(i.results.filter(function(t){return!i.types||!i.types.length||t.type&&i.types.indexOf(t.type.toLowerCase())>-1}t,i)}).fe(t)}));return o.length?(i.results=o,i.minChars||(i.minChars=this.options.minChars),void(this.options.staticResults[t]=i)):void delete this.options.staticResults[t]},ut.utils=u,ut.views=c,void 0==y.entryEventRecorded&&(y.entryEventRecorded=!1),a.createNs(y,"ta.tracking","typeahead"),a.exportTo({TypeAhead:ut},window),window.performance&&window.performance.mark&&window.performance.mark("typeahead-script-execute"),ut});
define("utils/errorutils",["ta/util/Error","vanillajs"],function(r,e){return{domIsReady:r.enableDomReadyParam.bind(r),record:r.record.bind(r),getSelectorString:r.getSelectorString.bind(r),on:r.on.bind(r),off:r.off.bind(r)}});
define("overlays/styles/spinnershade",["lib/jquery-amd"],function(i){"use strict";return function(n,s){return function(){this.loading=function(n){return void 0===n?i(this.container).hasClass("wait"):void i(this.container).toggleClass("wait",n)};var t='<div class="spinnerImage"></div>';if(window.AnimationEvent){t='<div class="cssLoadingSpinner">'+t;for(var e=1;e<=8;e++)t+='<div class="cssLoadingSpinner_step'+e+'"></div>';t+="</div>"}this.spinner=document.createElement("div"),i(this.spinner).attr({"class":"spinnershade "+n}).html(t),this.container.appendChild(this.spinner),s===!1||this.loading(!0)}}});
define("ta/registration/RegEvents",["mixins/Evess")});
define("ta/registration/RegOverlay",["ta","lib/jquery-amd","api-mod","ns-exporter","utils/urlutils","utils/errorutils","overlays/Overlay","overlays/position","overlays/position/center","overlays/position/autosize","overlays/options/disableBodyScroll","overlays/options/closeOnDocClick","overlays/styles/modal","overlays/styles/windowshade","overlays/styles/spinnershade","ta/registration/RegEvents","common/Radio"],function(e,r,o,i,n,t,a,s,l,c,d,u,f,p,g,v,m){"use strict";var h="https://smartlock.google.com",y=null,w=null,_=null,b=null,O=!1,k=null,R=function(){var e=r("#overlayRegFrame");e.length&&(y&&y.loading&&y.loading(!1),e.css("display",""),y&&y.emit("regFrameReady"))},x=function(){O&&(r(y.container).css("display",""),r(".second-layer").css("display",""))},F=function(e,o){var i=r(w?"#inlineRegFrame":"#overlayRegFrame");if(i.length){var n=y?y.container:w;if(!n)return void t.record("No overlay parent element found.");var a={frame:i[0],overlay:n,width:e,height:o};k(a)}},T=function(e){var o=r(window),i=o.length?o.width():981,n=e.width?e.width:0;n=n>i?i-20:n;var t=e.height?e.height:0,a=r(e.frame),s=r(e.overlay);a.css("display","block"),n>100&&(a.css("width",n),s.css("width",n)),t>100&&(a.css("height",t),s.css("height",t)),y.emit("contentsUpdated")},P=function(e){var r={};try{r=JSON.parse(e)}catch(r){return t.record("Error parsing controller result data: "+e+". "+r),{}}return"object"!=typeof r?(t.record("Parsed controller result is not an object."),{}):r},E=function(e){_&&(_(e),_=nulull)},C=function(e){window.__REDUX_STORE__&&e&&__REDUX_STORE__.dispatch({type:"SET_AUTH_STATE",loggedInUserId:e})},S=function(i){H.close();var n=i.resultData||"";if(n){var a=P(n);a.user_id&&(require.defined("page-model")&&(require("page-model").session.user_id=a.user_id),C(a.user_id)),a.hasCreatedMember&&require(["trjs!ta/common/behavior/Ads-pagemoniid})}),E(a)}else E({});i.jsCallback&&I(i.jsCallback);var s=i.fireEvent||"";e.hasEventListener&&e.hasEventListener(name)?e.fireEvent&&e.fireEvent(s):o.fireEvent(document,s),require.defined("page-model")&&(require("page-model").session.loggedIn=!0),v.emit("success");try{var l=void 0===r("#USER_PREFS")[0];if(!e.util||!e.util.partials||"function"!=typeof e.util.partials.requestPartials||l)return;var c={ifb:!0},d=e.retrieve("attractions_shopping_cart_whitelisted_servlet_flag");"undefined"!=typeof d&&(c.shoppingCartWhitelistedServlet=d),e.util.partials.requestPartials(["IP_HEADER"],c,"facebook",null)}catch(e){t.record("Could not request IP partial. "+e)}},I=function(e){if(e&&("string"==typeof e&&(e=0===e.indexOf("function")?Q(e):q(e)),"function"==typeof e))try{e()}catch(e){t.record("Unable to trigger js callback from registration overlay. "+e)}},q=function(e){for(var r,o=e.split("."),i=0,n=o.length;i<n;i++){var t=o[i];if(0!==i){if(!(r&&t in r))return null;r=r[t]}else r=window[t]}return r},Q=function(e){var r=/^function\s*\(\s*\)\s*{(.*)}/.exec(e);if(r&&r[1])try{return new Function(r[1])}catch(e){t.record("RegOverlay failed to parse js callback: "+r[1]+". "+e)}},M=function(e){var r=e||window.event;return r&&r.origin&&0===r.origin.indexOf(h)&&r.data&&r.data.type&&r.source?void r.source.postMessage({type:"verifyAck",data:r.data.data},h):null},D=function(e){var r=H.parseMessageFrom(e);if(M(e),r){var o=r.action;switch(o){case"successClose":S(r);break;case"reloadWindow":location.reload(!0);break;case"fwdToRelativeUrl":var i=r.url?r.url:"";i||t.record("No url specified to forward to."),0!==i.indexOf("/")&&t.record("Cannot forward to absolute url: "+i),window.location=i;break;case"resizeFrame":F(r.width,r.height);break;case"domReady":R();break;case"dismiss":H.close();break;case"showOverlay":x();break;default:return,!0)},U=function(){return!!e.retrieve&&e.retrieve("member_gating_cta_shown")},z=function(e,r,o,i){if(e)return void(y=e);var n="no_padding no_x mobile_reg_overlay second-layer",t='<div id="overlayRegFrameWrap"></div>',s=[f(null,"center",n,"","",t,null,r),l(),d(),p((i?i:"dark")+" second-layer"),g("light"),c(20)];(null==o||o)&&s.push(u),y=new a(null,s)},W=function(o,i,n,a,s,l,c,d){z(n,l,c,d),y.on("show",function(){O&&(r(this.container).css("display","none"),r(".second-layer").css("display","none"));var n=r("#overlayRegFrameWrap");if(!n.length)return void t.record("The registration iframe wrapper was missing.");e.trackEventOnPage("regoverlay","show_overlay",[window.modelLocId||"",s].join("|"),i,!1),m("registration-overlay").emit("shown",s,i);var a=document.createElement("iframe");r(a).prop("src",o).prop("id","overlayRegFrame").prop("class","overlayRegFrame").prop("scrolling","no").css("border","none").css("display","none"),n.append(a)}),y.on("hide",function(r){"close-button"===r.trigger&&e.trackEventOnPage("regoverlay","closed",[window.modelLocId||"",s].join("|"),i,!1),y=null,j(r)}),y.on("regFrameReady",function(){r(this.container).toggleClass("no_x",!1),"join"===a&&require(["trjs!ta/common/behavior/Ads-pagemoniker"],function(e){e.loadMonikerForMemberRegistrationForm()})}),y.show()},A=function(o,i,n){var a=i.extraQueryParams&&i.extraQueryParams.loginWrapperId?i.extraQueryParams.loginWrapperId:"booking_confirmation_inline_reg",s=r("#"+a);if(w=s,!s.length)return void t.record("The registration inline login wrapper was missing.");var l=i.extraQueryParams&&i.extraQueryParams.loginIframeId?i.extraQueryParams.loginIframeId:"inlineRegFrame",c=document.createElement("iframe");s.append(c),r(c).prop("src",o).prop("id",l).prop("class",l).prop("scrolling","no").css("border","none"),i.extraQueryParams&&i.extraQueryParams.customResizeFn?c.onload=i.extraQueryParams.customResizeFn:s.show(),e.trackEventOnPage("bc_signup_form","view_signup_form",[window.modelLocId||"",n].join("|"),i.pid,!1)},N=function(e){return e&&"object"==typeof e?e.hasOwnProperty("flow")&&e.flow?!(!e.hasOwnProperty("pid")||!e.pid)||(t.record("Options object missing required pid field."),!1):(t.record("Options object missing required flow field."),!1):(t.record("Options object is invalid."),!1)},X=function(){var e=!1;return r.ajax({url:"/AuthCheck",data:{},async:!1,type:"GET",timeout:1e3,success:function(r){"string"==typeof r&&"true"===r.trim()&&(e=!0)}}),e},B=function(e){for(var r in e)!1===e[r]||e[r]||delete e[r]},H={attachLis",D)},show:function(e,o,i){if(N(i),b=i.onClose,_=i.onSuccess,O=i.displayOnShowOverlay,i.loggedInBypass&&X())return void E({});k=i.customResizeFn?i.customResizeFn:T,H.attachListener();var t={flow:i.flow,pid:i.pid,mcid:i.mcid,locationId:i.locationId,stateToken:i.stateToken,jsCallback:i.jsCallback,requireSecure:!!i.requireSecure,expectedUser:i.expectedUser,forceDesktop:"forceDesktop"in i&&i.forceDesktop,preVerificationToken:i.preVerificationToken,hideNavigation:!0,returnTo:""};i.extraQueryParams&&(t=r.extend(t,i.extraQueryParams)),B(t);var a=r.param(t),s=n.https("/RegistrationController?"+a);return i.extraQueryParams&&i.extraQueryParams.isInlineReg?void A(s,i,t.flow):i.userRequestedForce?void W(s,i.pid,i.customOverlay,t.flowOrigin?t.flowOrigin:null,t.flow,i.closeX,i.closeOnDocClick,i.windowShadeOption):void(U()?E({}):(L(),W(s,i.pid,i.customOverlay,t.flowOrigin?t.flowOrigin:null,t.flow,i.closeX,i.closeOnDocClick,i.windowShadeOption)))},de()},showFullScreen:function(e,o,i){if(N(i),!i.hasOwnProperty("returnTo")||!i.returnTo)return void t.record("Options object missing required returnTo field.");var a={flow:i.flow,pid:i.pid,mcid:i.mcid,locationId:i.locationId,stateToken:i.stateToken,jsCallback:i.jsCallback,returnTo:i.returnTo,requireSecure:!!i.requireSecure,fullscreen:!0};i.extraQueryParams&&(a=r.extend(a,i.extraQueryParams)),B(a);var s=r.param(a);window.location=n.https("/RegistrationController?"+s)},showForMobile:function(e,i,n){if(!n.customOverlay){var t=[f(null,"center","no_padding mobile_reg_overlay","","",'<div id="overlayRegFrameWrap"></div>',void 0,n.closeX),s.framed(null,!0,null),g("light")];n.customOverlay=new a(null,t).on("ck")}).on("positionDirty",function(){this._scrollTop||(this._scrollTop=o.scrollTop()),window.scrollTo(0,0)}).on("lTop}),n.customResizeFn||(n.customResizeFn=function(e){var o=e.height,i=r("#overlayRegFrame");i.height()>o&&(o=i.height()),i.css("height",o+"px").css("width",r(window).width()),y.emit("positionDirty"),document.body.classList.contains("disableScroll")&&r("#overlayRegFrameWrap").css("-webkit-overflow-scrolling","touch").css("overflow-y","scroll").css("height",r(window).height()).addClass("fullscreen"),r(n.customOverlay.container).css("position","fixed").css("overflow","scroll")})}this.show(e,i,n)},showRegOverlayByPageModel:function(e,r,o,i){this.showRegOverlay(e,r,!!o&&o.isMobile,i)},showRegOverlay:function(e,r,o,i){y&&y.isOpen()||(o?this.showForMobile(e,r,i):this.show(e,r,i))},parseMessageFrom:function(e){var r,o=e||window.event;if(!o)return null;if(!o.origin||0!==o.origin.indexOf("https")||o.origin!==document.location.origin)return null;if(!o.data||!o.data.indexOf||-1===o.data.indexOf("action"))return null;try{r=JSON.parse(o.data)}catch(e){return null}var i=r.hasOwnProperty("action")?r.action:null;return i||(r=null),r}};return i.exportTo(H,"ta.registration.RegOverlay"),H});
define("ta/backbone/ModuleLoader",["lib/jquery-amd","ns-exporter","utils/resourceLoader","ta/Core/TA.Event","mixins/mixin","ta/util/ajax","ta/util/Error","ta/registration/RegOverlay"],function(t,e,s,i,o,n,r,a){var h=null;r,ta)}(function(e,h,p){function u(t,i){return l||e.bbapp?(t(),!0):jsDesktopBackboneAsset===p?(i(),!1):void s.load(jsDesktopBackboneAsset,{serial:!0},function(){l=!0,t()})}function c(t,e){this._module=t,this._stepIdx=0,this._pid=e||-1,this._steps=["backbone","parseParams","bootstrap","assets","checkResponse","app","login","refetch","init"],this.resolve=this.resolve.bind(this),this.reject=this.reject.bind(this)}var l=!1;c.prototype.log=function(t){var s=[].slice.call(arguments,1),o="ModuleLoader:"+this._module+":"+(t?this._steps[this._stepIdx]+":"+t:"run");s.unshift(o),e.IS_DEBUG&&console.log.apply(console,s),i.fireEvent(o,this._el)},c.prototype._backbone=function(){u(this.resolve)},c.prototype._parseParams=function(){if("function"==typeof this._params)this._params=this._params(),this.resolve();else if("string"==typeof this._params){var t=this._params.split("::"),e=t.pop();t=t.shift(),require&&require([t],function(t){t[e]&ve()}.bind(this),this._el)}.bind(this))}else this.resolve()},c.prototype._bootstrap=function(){var s=o({modules:this._module,token:JS_SECURITY_TOKEN,authenticator:"DEFAULT",d:e.modelLocId,g:e.modelGeoId},this._params);new n({method:"POST",url:"/ModuleBootstrap",data:s,aplus:!0}).then(function(e){return e&&200===e.code?e.text.indexOf("_modulesResponseData")<0?(r.ajaxFailure("Invalid ModuleBootstrap response",e,{contentLength:e.text.length}),void this.reject()):(this._root=t("<div>").html(e.text),void this.resolve()):void this.reject()}.bind(this),this.reject)},c.prototype._assets=function(){for(var e=this._root.find("script").get(),i=[],o=e.length-1;o>=0;o--){var n=e[o].getAttribute("src");n?(i.unshift(n),e[o].parentNode.removeChild(e[o])):t.globalEval(e[o].text)}s.load(i,{serial:!0},this.resolve),e=this._root.find("link").get();for(var r=e.length-1;r>=0;r--)s.load(e[r].href,{forceType:"css"})},c.prototype._checkResponse=function(){return this._appName=e._backboneAppName,this._data=e._modulesResponseData,delete e._backboneAppName,delete e._modulesResponseData,this._data?(this._needLogin=!1,this._actions={},this._data.actions.forEach(function(t){"FAILURE.AUTHORIZATION_MEMBER"==t.status&&(this._needLogin=!0,this._actions[t.resource]=t.params)},this),void this.resolve()):void this.reject()},c.prototype._app=function(){require([this._appName,"Logging"],function(t,s){s.debug("initializing app",this._appName);var i=(new Date).getTime();e.bbapp?e.bbapp.context.patch(this._data):(e.bbapp=new t,e.bbapp.init({"token":JS_SECURITY_TOKEN},this._data),s.debug("Initialized modules/backbone in "+((new Date).getTime()-i)+"ms")),this.resolve()}.bind(this))},c.prototype._login=function(){return this._needLogin?(this.log("run"),void a.show(null,null,{flow:"CORE_COMBINED",pid:this._pid,userRequestedForce:!0,onSuccess:this.resolve,onct()}.bind(this)})):void this.resolve()},c.prototype._refetch=function(){if(!this._needLogin)return void this.resolve();var t;for(var s in this._actions)t=this._actions[s],e.bbapp.context.batchAction({action:{name:"FETCH",resource:s,params:t,id:"refetch"}});e.bbapp.context.commitActions({success:this.resolve})},c.prototype._init=function(){"string"!=typeof this._entryPoint?(this._entryPoint.appendChild(this._root.get(0)),this.resolve()):require&&require([this._entryPoint],function(t){var e=this._args.slice();e.unshift(this._el),t.init&&t.init.apply(t,e),this.resolve()}.bind(this))},c.prototype.run=function(t,e,s,i){if(!this._running)return this._running=!0,this._success=[],this._failure=[],this._entryPoint=t,this._params=e,this._el=s,this._args=i,this._stepIdx>=this._steps.length&&(this._stepIdx=this._steps.length-1),this.log(),this.log("start"),this["_"+this._steps[this._stepIdx]](),this},c.prototype.success=function(t){return this._running?(this._success.push(t),this):(t(),this)},c.prototype.failure=function(t){return this._running?(this._failure.push(t),this):(t(),this)},c.prototype.resolve=function(){this.log("success"),this._stepIdx++,this._stepIdx<this._steps.length?(this.log("start"),this["_"+this._steps[this._stepIdx]]()):(this._running=!1,this._success.forEach(function(t){t()}))},c.prototype.reject=function(){this._running=!1,this.log("failure"),this._failure.forEach(function(t){t()})};var _={};return function(t,e,s,i,o,n){var r=Array.prototype.slice.call(arguments,4),a=_[t];return!o&&a||(a=_[t]=new c(t,n)),a.run(e,s,i,r)}}),e.exportTo({ModuleLoader:h},"ta.backbone"),h});
define("tamgfooter/tamgFooter",["vanillajs","ns-exporter","utils/ajax","ta/Core/TA.Record","ta/util/Error"],function(e,o,t,n,r){var a={};a.openUrl=function(e){var o=window.open(e);o.opener=null},a.getTAMGFooterViaAjax=function(e,o,r,a,i){t({url:"/TAMGFooterAjax",success:function(e){var o=document.getElementById("TAMGFooterHolder");o&&(o.innerHTML=e);var t="RuleBasedFooter_"+i;n.trackEventOnPage("Footer","OpenFooter",t,1,!0)},data:{"a":"SHOW_FOOTER","dis":e,"loc":o,"new":r,"serv":a},evalScripts:!0,method:"get"})},a.getFullDisclaimerText=function(){t({url:"/TAMGFooterAjax",success:function(e){try{document.getElementById("PDISCLAIMER").innerHTML=e}catch(e){r.record(e,"Fail to find element (id PDISCLAIMER)")}},data:{"a":"SHOW_FULL_DISCLAIMER"},evalScripts:!0,method:"get"})},a.setTAMGFooterCookie=function(e){var o=null,t=new Date(Date.now()+6048e5);document.cookie="hideTAMGFooter="+escape(e)+";expires="+t.toGMTString()+";path=/"+(o?";domain="+o:"");var n=document.getElementById("TAMGFooterHolder");n&&(n.style.display="none")},o.exportTo(a,window)});
define("ta/util/GeeTest",["ns-exporter","common/trackingStreams"],function(e,t){"use strict";var n=!1,r={},o={},a={},i=t.error,c=function(){t.trackEvent("captcha","geetest","displayed")},s={init:function(){try{if(n||"undefined"!=typeof initGeetest4&&initGeetest4)return;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.defer=!0,e.src="https://static.geetest.com/v4/gt4.js",document.getElementsByTagName("head")[0].appendChild(e),n=!0}catch(e){i(e,"Could not inject geetest script on to page.")}},reset:function(e){try{r[e]&&"function"==typeof r[e].reset&&(r[e].reset(),o[e]=null)}catch(t){i(t,"Error resetting recaptcha object: "+e)}},initCaptchaObj:function(e,t){est4};s.waitForLoad(n,"GeeTest JS was not loaded on the page.").then(function(){initGeetest4({captchaId:e,language:"zho"},function(e){r[t]=e})})},resetAll:function(){for(var e in r)r.hasOwnProperty(e)&&s.reset(e)},a={}},waitForLoad:function(e,t){return new Promise(function(n,r){var o=0,a=window.setInterval(function(){return++o>=40?(window.clearTimeout(a),i(null,t),void r()):void(e()&&(window.clearTimeout(a),n()))},250)})},getCaptchaSuccessValues:function(){return a},getCaptchaForrn e},showSync:function(e,t){s.initCaptchaObj(e,t);r[t]};return s.waitForLoad(n,"GeeTest captcha object was not loaded on the page.")e,t)})},show:function(e,t){try{if("undefined"==typeof initGeetest4||!initGeetest4)return i(null,"GeeTest JS was not loaded on the page."),Promise.reject();if(!e||!t)return i(null,"Please pass a site key and element id."),Promise.reject();var n=document.getElementById(t);return n?(r[t].appendTo(n),o[t]=new Promise(function(e){r[t].onSuccess(function(){var n=r[t].getValidate();a=n,e({captcha_id:n.captcha_id,captcha_output:n.captcha_output,gen_time:n.gen_time,lot_number:n.lot_number,pass_token:n.pass_token})})}),c(),o[t]):(i(null,"The geetest element id was not found on the page: "+t),Promise.reject())}catch(e){return i(e,"Error loading geetest captcha."),Promise.reject()}},checkGeeTestRendered:function(e){return!!r[e]}};return e.exportTo(s,"ta.util.GeeTest"),s});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/util/ReCaptcha","ta/util/ReCaptchaEnterprise","ta/util/CaptchaHandler","ta/util/GeeTest","utils/memberAudit"],["ta","ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-captcha","files":{"js-amd":{"src":{"utils":{"memberAudit":1}}},"js3":{"src":{"ta":{"util":{"GeeTest":1,"CaptchaHandler":1,"ReCaptchaEnterprise":1,"ReCaptcha":1}}}}},"_":{"baseUrl":"/"}});
define("ta/util/ReCaptcha",["vanillajs","ns-exporter","common/trackingStreams"],function(e,t,r){"use strict";var n=!1,a={},c={},o="",i=function(e){if(e<0)return 300;switch(e){case 0:return 0;case 1:return 250;case 2:return 500;case 3:return 1e3;default:return 2e3}},l=function(e,t){require.defined("ta/util/Error")?require("ta/util/Error").record(t+": "+e):ta.merror&&ta.merror.recordError&&"function"==typeof ta.merror.recordError&&ta.merror.recordError(t,null,null,null,e)},u=function(){r.trackEvent("captcha","recaptcha","displayed")},d=function(e,t){var r=document.getElementById(t);return r&&"INPUT"===r.tagName?void(r.value=e||""):void l(null,"The recaptcha input id was not found on the page: "+t)},p={init:function(e,t,r,a,i){try{if(c[r]=a,n)return;e||l(null,"No language specified for recaptcha."),t&&(o=t);var u=document.createElement("script");u.type="text/javascript",u.async=!0,u.defer=!0,u.src="https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit&hl="+e,document.getElementsByTagName("head")[0].appendChild(u),n=!0}catch(e){l(e,"Could not inject recaptcha script on to page.")}},reset:function(e){if(!e)return void l(null,"No reset key specified.");if(a[e]||0===a[e])try{"undefined"!=typeof grecaptcha&&grecaptcha&&grecaptcha.reset&&"function"==typeof grecaptcha.reset&&grecaptcha.reset(a[e])}catch(t){l(t,"Error resetting recaptcha object: "+e)}},resetAll:function(){for(var e in a)a.hasOwnProperty(e)&&p.reset(e)},clear:function(){a={}},checkGrecaptcha:function(){return!("undefined"==typeof grecaptcha||!grecaptcha||!grecaptcha.render||"function"!=typeof grecaptcha.render)},checkCaptchaRendered:function(e){return!(!a[e]&&0!==a[e])},showSync:function(e,t,r){var n=0,a=window.setInterval(function(){return++n>=40?(window.clearInterval(a),void l(null,"Recaptcha JS was not loaded on the page.")):void("undefined"!=typeof grecaptcha&&(p.show(e,t,r),window.clearInterval(a)))},250)},sh[t])},waitForElm:function(e,t,r){var n=0,a=function(){if(++n>=5)return window.clearInterval(c),void l(null,"Recaptcha element id was not loaded on the page."+t);var a=document.getElementById(t);a&&(window.clearInterval(c),p.show(e,t,r))},c=window.setInterval(a,250)},execute:function(){return"undefined"==typeof grecaptcha||"function"!=typeof grecaptcha.execute?void l(null,"Calling execute while captcha is not rendered"):void grecaptcha.execute()},show:function(e,t,r,n,c,f,h){try{if("undefined"==typeof grecaptcha||!grecaptcha||!grecaptcha.render||"function"!=typeof grecaptcha.render)return void l(null,"Recaptcha JS was not loaded on the page.");if(!e||!t||!r)return void l(null,"Please pass a site key, element id, and input id.");var s=document.getElementById(t);if(!s)return void p.waitForElm(e,t,r);if(a[t]&&"object"==typeof a[t])return;var g=0,w=i(g),y=document.getElementById("captchaSpinner"),m=function(){if(1==g&&null!==y&&(y.style.display="block"),++g>=5){window.clearTimeout(v),y&&(y.style.display="none"),l(null,"Couldn't load recaptcha"),"function"==typeof h&&h.call();var u=document.getElementById("captchaError");return void(null!==u&&(u.className="captchaError errorMsg warning wrap",u.innerHTML=o))}if("undefined"==typeof a[t]){var s=n?"compact":"normal";c&&(s="invisible"),a[t]=grecaptcha.render(t,{"sitekey":e,"theme":"light","type":"image","tabindex":0,"size":s,"callback":function(e){d(e,r),"function"==typeof f&&f(e,r)},"expired-callback":function(){p.reset(t)}}),w=i(g),v=window.setTimeout(m,w)}else window.clearTimeout(v),y&&(y.style.display="none")},v=window.setTimeout(m,w);u()}catch(e){l(e,"Error loading recaptcha.")}}};return t.exportTo(p,"ta.util.ReCaptcha"),p});
define("ta/util/ReCaptchaEnterprise",["vanillajs","ns-exporter","common/trackingStreams"],function(e,t,r){"use strict";var n=!1,a={},c={},i=null,o="",p=function(e){if(e<0)return 300;switch(e){case 0:return 0;case 1:return 250;case 2:return 500;case 3:return 1e3;default:return 2e3}},u=function(e,t){require.defined("ta/util/Error")?require("ta/util/Error").record(t+": "+e):ta.merror&&ta.merror.recordError&&"function"==typeof ta.merror.recordError&&ta.merror.recordError(t,null,null,null,ed")},l=function(e,t,r){var n=0,a=function(){if(++n>=5)return window.clearInterval(c),void u(null,"Recaptcha element id was not loaded on the page."+t);var a=document.getElementById(t);a&&(window.clearInterval(c),s.show(e,t,r))},c=window.setInterval(a,250)},s={init:function(e,t,r,a,p){try{if(c[r]=a,i=a,n)return;e||u(null,"No language specified for recaptcha."),t&&(o=t);var d=document.createElement("script");d.type="text/javascript",d.async=!0,d.defer=!0,d.src="https://www.google.com/recaptcha/enterprise.js?onload=recaptchaCallback&render="+p+"&hl="+e,document.getElementsByTagName("head")[0].appendChild(d),n=!0}catch(e){u(e,"Could not inject recaptcha script on to page.")}},reset:function(e){if(!e)return void u(null,"No reset key specified.");if(a[e]||0===a[e])try{"undefined"!=typeof grecaptcha&&"undefined"!=typeof grecaptcha.enterprise&&"function"==typeof grecaptcha.enterprise.reset&&grecaptcha.enterprise.reset(a[e])}catch(t){u(t,"Error resetting recaptcha object: "+e)}},rest(e)},a={}},checkGrecaptcha:function(){return!("undefined"==typeof grecaptcha||!grecaptcha||"undefined"==typeof grecaptcha.enterprise.render||"function"!=typeof grecaptcha.enterprise.render)},checkCaptchaRendered:function(e){return!(!a[e]&&0!==a[e])},execute:function(e,t){if("undefined"==typeof grecaptcha||"undefined"==typeof grecaptcha.enterprise||"function"!=typeof grecaptcha.enterprise.execute)return void u(null,"Calling execute while captcha is not rendered");var r=i;grecaptcha.enterprise.getResponse();grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(t,{action:"LOGIN"}).then(function(t){var n=document.getElementById(r);return n&&"INPUT"===n.tagName?(n.value=t||"",void("function"==typeof e&&e())):void u(null,"The recaptcha input id was not found on the page: "+r)})})},show:function(e,t,r,n,c,i,f){try{if("undefined"==typeof grecaptcha||"undefined"==typeof grecaptcha.enterprise||"function"!=typeof grecaptcha.enterprise.render)return void u(null,"Recaptcha JS was not loaded on the page.");if(!e||!t||!r)return void u(null,"Please pass a site key, element id, and input id.");var h=document.getElementById(t);if(!h)return void l(e,t,r);if(a[t]&&"object"==typeof a[t])return;var g=0,y=p(g),m=document.getElementById("captchaSpinner"),v=function(){if(1==g&&null!==m&&(m.style.display="block"),++g>=5){window.clearTimeout(w),m&&(m.style.display="none"),u(null,"Couldn't load recaptcha"),"function"==typeof f&&f.call();var r=document.getElementById("captchaError");return void(null!==r&&(r.className="captchaError errorMsg warning wrap",r.innerHTML=o))}if("undefined"==typeof a[t]){var i=n?"compact":"normal";c&&(i="invisible"),a[t]=grecaptcha.enterprise.render(t,{"sitekey":e,"theme":"light","type":"image","tabindex":0,"badge":"inline","expired-callback":function(){s.reset(t)}}),y=p(g),w=window.setTimeout(v,y)}else window.clearTimeout(w),m&&(m.style.display="none")},w=window.setTimeout(v,y);d()}catch(e){u(e,"Error loading recaptcha.")}}};return t.exportTo(s,"ta.util.ReCaptchaEnterprise"),s});
define("ta/util/CaptchaHandler",["ta","lib/jquery-amd","ta/util/ReCaptcha","ta/util/GeeTest","ta/util/Error","ns-exporter"],function(e,a,t,c,n,r){"use st=e)}function o(){s=null}function l(e,c,n,r,d,i){t.show(e,c,n,r,d,i),a("#captchaRecaptcha").removeClass("hidden")}function u(e,a,c){try{var r=e.data("siteKey"),d=e.data("elemId"),i=e.data("inputId"),o=e.data("lang"),u=e.data("errorText"),h=e.data("compact");a&&(d=e.data("elemIdInv"),r=e.data("siteKeyInvisible"));var p=document.getElementById("sharedCaptcha.recaptchaSiteKey");if(p&&(p.value=r),t.checkCaptchaRendered(d))return void t.reset(d);if(t.checkGrecaptcha())return void l(r,d,i,h,a,c);window.recaptchaCala,c)},t.init(o,u,d,i)}catch(e){n.record(e,"Rendering ReCaptcha failed")}}function h(e,t){try{var r=e.data("siteKey"),d=e.data("elemId");r||(e.data("siteKey",t.captchaSiteKey),r=e.data("siteKey")),c.resetAll(),c.init(),c.showSync(r,d),a("#captchaGeeTest").removeClass("hidden")}catch(e){n.record(e,"Rendering GeeTest failed")}}function p(){var e=a("#recaptcha_common_context_data");e.length&&e.data("required")&&u(e,!1,null),e=a("#recaptcha_common_invisible_context_data"),e.length&&e.data("required")&&u(e,!0,d),e=a("#geeTest_common_context_data"),e.length&&e.data("required")&&h(e)}var s,f={renderCaptchaIfNeeded:p,setCaptchaSolvedCallback:i,clearCaptchaSolvedCallback:o};return r.exportTo(f,"ta.util.CaptchaHandler"),f}),require(["lib/jquery-amd","ta/util/CaptchaHandler","ta/util/Error"],function(e,a+e)}})});
define("utils/memberAudit",["vanillajs","ta","utils/ajax","utils/urlutils","utils/errorutils"],function(t,e,r,i,o){var s=function(t,e,s,u){try{r({type:"POST",url:i.https("/MemberAuditLogger"),error:function(t){var e=t&&t.code?t.code:"",r=t&&t.status?t.status:"",i=t&&t.text?t.text:"";o.record("Ajax post request failure(recordMemberAuditLog), code: "+e+", status: "+r+", text: "+i)},data:{action:"MemberAuditLogger",token:e,recordType:t,registrationSessionUid:s,map:JSON.stringify(u)},xhrFields:{withCredentials:!0}})}catch(t){o.record("Failed to send an Ajax request to MemberAuditLogger. "+t)}};return{recordMemberAuditLog:s}});
define("ta/maps/opener",["vanillajs","api-mod","ta/Core/TA.Event","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/autoReposition","overlays/options/closeOnEscape","overlays/styles/windowshade","overlays/utils"],function(e,a,o,r,t,n,s,i,l,p){var c,e())};return o.on("mapOverlayOpened",function(){d(),y&&setTimeout(ta.mapsv2.Factory.closeFromOtherThanX,1),y=0}),o.on("mapOverlayClosed",d),{open:function(e,d,m,u){if(2==e){if(!c){var f,h=a.hasClass(document.body,"tablet_desktop"),O=0;h||(O=20,f=l()),c=new r(0,[t(0,"center",0,0,0,p.loadingSpinnerHtml()),n.framed([O,O]),s,i,f]),c.on("hide",function(){v||(y=1),v=0})}v=y=0,c.show()}if(require.defined("maps/performanceMetrics")){var F=require("maps/performanceMetrics");F.baseLayerStart(F.DRAW_TRIGGERS.LOAD)}var R=2==e?"ta.mapsv2.Factory.createPOIMapViaHashRedirect":"ta.maps.Factory.createFloatMapDelay";o.run(R,{},null,null,d,m,u)}}});
ta.servlet.Member={memberBenefitsSubscribe:function(e){return ta.servlet.Member.processMOSubscribeRequest(e),!1},memberGuideRequest:function(e){processGuideRequest(e)},memberTOGForm:function(e){processTOGForm(e)},processMOSubscribeRequest:function(e){if(!loggedIn)return new Event(e).preventDefault(),!1;var t=$("MEMONLY_SUBS_FORM");t.elements.action.value="subscribe";var n={url:"/TravelGuides",data:t,onFaext)}};n.onSuccess=ta.servlet.Member.subscribeRequestResFunc;window["validate"+t.id];new Event(e).preventDefault(),new Request(n).send()},subscribeRequestResFunc:function(e){if(""!=e){for(subtype in subtypes)if(subtyperes[subtype].test(e)){"tw"==subtype&&ta.retrieve("tcd.refresh")&&window.location.reload();var t=document.getElementById(subtype+"Optin");t.setAttribute("checked","true"),t.setAttribute("disabled","true");var n=document.getElementById(subtype+"OptinLbl");n.innerHTML="<b>"+headings[subtype]+"</b> "+tamg_thanks;var r=document.getElementById("OPTINTEXT");r.style.display="none"}var s={};for(subtype in subtypes){var a=document.getElementById(formids[subtype]);s[subtype]=a.checked}var u=!0,i=!0;for(subtype in s)subtyperes[subtype].test(e)&&(u=!1),s[subtype]||(i=!1);if(i){var o=document.getElementById("NLSUBMITDIV");o.style.display="none"}if(u){var l=document.getElementById("OPTINTEXT");l.innerHTML='<div class="alert">'+no_selection_error+"</div>",l.style.display="block"}}},addTripWatchLocation:function(event,elmt,updateTxt){var mElmt=new Element(elmt);new Event(event).stop(),new Request({url:elmt.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocation"),onSuccess:function(txt,xml){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR)return void ta.overlays.showInLightbox(data.ERROR);if(data.ALERT)return void ta.overlays.showInLightbox(data.ALERT)}var spanElt=new Element("span");spanElt.set("html",updateTxt),mElmt.hide(),spanElt.inject(mElmt,"after")}}).send()},addTripWatchLocationReload:function(e){new Request({url:e.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocationReload"),onSuccess:function(e,t){window.location.reload()}}).send()}};
ta.servlet.Tourism=function(){var e=null;return{linkClick:function(e,t,r){var a=new Event(r||window.event);if(a.target){var n=a.target;n.href||(n=n.getElement("a")||n.getParent("a")),n&&n.getAttribute("data-trk")&&(t=n.getAttribute("data-trk")),n&&n.href&&ta.setEvtCookie("Tourism",e,t,0,n.href)}},toggleWeatherUnit:function(t,r,a){a!=e&&(e=a,r.getSiblings().toggleClass("selected"),r.toggleClass("selected"),ta.select(".weatherInfo .temps").toggleClass("hidden"))},showGeoDescription:function(e,t){var r=ta.retrieve("tourism.fullDescription");r&&new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 dg descriptionLB",content:"<p>"+r+"</p>"})}}}();
function touchHandler(e){var t=e.changedTouches,a=t[0],s="";switch(e.type){case"touchmove":s="mousemove";break;case"touchend":s="mouseup";break;default:return}var i=document.createEvent("MouseEvent");i.initMouseEvent(s,!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(i),e.preventDefault()}ta.widgets.slider={handleSeparation:10,isRtl:function(){return ta.util.i18n.isRtl()},getValue:function(e,t){var a="";return a=this.isRtl()?e.style.right&&""!=e.style.right.trim()?e.style.right:t.style.left:e.style.left,""!=a?a.toFloat():0},resetHooks:function(e){var t=e.hasClass("slider_redesign")?e:e.getElement(".slider_redesign"),a=t.className,s=parseFloat(a.match(/min_(\d+)/)[1].replace("_",".")),i=parseFloat(a.match(/max_(\d+)/)[1].replace("_","."));return this.setHooks(e,s,i)},setHooks:function(e,t,a,s,i){var n=e.hasClass("slider_redesign")?e:e.getElement(".slider_redesign"),r=n.className,l=parseInt(r.match(/steps_(\d+)/)[1]),d=parseFloat(r.match(/min_(\d+)/)[1].replace("_","."));s&&d!=s&&(n.removeClass("min_"+d),n.addClass("min_"+s),d=s);var o=parseFloat(r.match(/max_(\d+)/)[1].replace("_","."));i&&o!=i&&(n.removeClass("max_"+o),n.addClass("max_"+i),o=i),t<d&&(t=d),a>o&&(a=o);var m=parseInt(r.match(/width_(\d+)/)[1])-this.handleSeparation,c=n.hasClass("maxAllInclusive"),u=m/(l-1),h=(o-d)/(l-1),p=(t-d)/h,g=(a-d)/h;this.updateEnd(n.getElement(".handle-left"),this.isRtl()?g:p,u,!0),this.updateEnd(n.getElement(".handle-right"),this.isRtl()?p:g,u,!1),this.updateBar(n.getElement(".slider-range"),p,g,u,"set");var v=c&&a>=o;"priceSelect"==n.id?this.priceUpdate(e,t,a,v):"ratingSelect"==n.id?this.ratingUpdate(e,t,a,v):"bedroomsSelect"==n.id?this.bedroomsUpdate(e,t,a,v):this.simpleUpdate(e,t,a,v);var f=e.getElement(".minMax"),S=f.value,E=this.updateMinMax(f,p,g,h,l,d);return S!=E},updateMinMax:function(e,t,a,s,i,n){var r=(t<=0?0:t*s+n)+","+(a>=i-1?999999:a*s+n);return e.value=r,r},updateEnd:function(e,t,a,s){var i=t*a+(this.isRtl()^s?0:this.handleSeparation);return this.isRtl()?(e.setStyle("right",i+"px"),e.setStyle("left","")):(e.setStyle("left",i+"px"),e.setStyle("right","")),i},updateBar:function(e,t,a,s){t>a&&(t^=a,a^=t,t^=a);var i=t*s,n=a*s+this.handleSeparation-i;n<0&&(n*=-1);this.isRtl()?"right":"left";this.isRtl()?e.setStyle("right",i):e.setStyle("left",i),e.setStyle("width",n)},initSliderInfo:function(e){var t={},a=e.className;t.width=parseInt(a.match(/width_(\d+)/)[1])-this.handleSeparation,t.steps=parseInt(a.match(/steps_(\d+)/)[1]),t.min=parseFloat(a.match(/min_(\d+)/)[1].replace("_",".")),t.max=parseFloat(a.match(/max_(\d+)/)[1].replace("_",".")),t.stepSize=(t.max-t.min)/(t.steps-1),t.maxAllInclusive=e.hasClass("maxAllInclusive"),t.snapDistance=t.width/(t.steps-1),t.rangeBar=e.getElement(".slider-range"),t.minMax=e.getElement(".minMax"),t.startMinMax=t.minMax.value,t.singleValue=e.hasClass("singleValue");var s=e.getParent().getElement(".handle-left"),i=e.getParent().getElement(".handle-right"),n=this.getValue(s,i),r=this.getValue(i,s);return this.isRtl()?n-=this.handleSeparation:r-=this.handleSeparation,t.leftStep=this.getClosestStep(n,t),t.rightStep=this.getClosestStep(r,t),t},setSliderTarget:function(e,t){return e.hasClass("handle-left")?(t.target=e.getParent().getElement(".handle-left"),this.isRtl()?t.limits=[t.rightStep+(t.singleValue?0:1),t.steps-1]:t.limits=[0,t.rightStep-(t.singleValue?0:1)],t.isLeftHook=!0):(t.target=e.getParent().getElement(".handle-right"),this.isRtl()?t.limits=[0,t.leftStep-(t.singleValue?0:1)]:t.limits=[t.leftStep+(t.singleValue?0:1),t.steps-1],t.isLeftHook=!1),t},handleMouseDown:function(e,t){var a=new Event(e);if(a){a.stop();var s=ta.id(a.target);if(s){var i=this.initSliderInfo(s.getParent());i=this.setSliderTarget(s,i),i.snapCallBack=t.bind(this),i.dragHandle=this.handleMouseMove.bind(this),i.upHandle=this.handleMouseUp.bind(this),document.addListener("mousemove",i.dragHandle),document.addListener("mouseup",i.upHandle),document.addListener("touchmove",touchHandler),document.addListener("touchend",touchHandler),i.offset=s.getParent().getCoordinates().left+10+(i.isLeftHook?0:this.handleSeparation),ta.store("slider_info",i)}}},getClosestStep:function(e,t){return Math.round(e/t.snapDistance)},handleMouseMove:function(e){e=new Event(e);var t=ta.retrieve("slider_info");if(t&&t.target){var a=e.page.x-t.offset,s=this.getClosestStep(a,t);this.isRtl()&&(s=t.steps-s-1),s<t.limits[0]?s=t.limits[0]:t.limits[1]<s&&(s=t.limits[1]),this.sliderDrag(e,s,t,a)}e.stop()},sliderDrag:function(e,t,a,s){if(e){e.stop();var i=a.isLeftHook?t:a.leftStep,n=a.isLeftHook?a.rightStep:t;if(this.updateEnd(a.target,t,a.snapDistance,a.isLeftHook),this.updateBar(a.rangeBar,i,n,a.snapDistance),this.updateMinMax(a.minMax,i,n,a.stepSize,a.steps,a.min),ta.store("slider_info",a),a.snapCallBack){var r=(this.isRtl()?n:i)*a.stepSize+a.min,l=(this.isRtl()?i:n)*a.stepSize+a.min,d=a.maxAllInclusive&&l==(a.steps-1)*a.stepSize+a.min;a.snapCallBack(a.target,r,l,d)}}},handleMouseUp:function(e){e=new Event(e),e&&e.stop();var t=ta.remove("slider_info");t&&(document.removeListener("mousemove",t.dragHandle),document.removeListener("mouseup",t.upHandle),document.removeListener("touchmove",touchHandler),document.removeListener("touchend",touchHandler),t.dragHandle=null,t.upHandle=null,t.minMax.value!=t.startMinMax&&sliderMoved())},currencyUpdate:function(){ta.util.error.record({name:"Deprecated",message:"ta.widgets.Slider.currencyUpdate will be going away soon and should not be used."},"Slider JS Cleanup",null,null,"WARN");var e=ta.id("l1currency");if(e){var t=ta.retrieve("ta.currencyHash");if(t){var a=t[parseInt(e.value)],s=ta.id("pricePeriod_w");if(null!=s&&s.checked){var i=ta.retrieve("ta.weekCurrencyHash");i&&(a=i[parseInt(e.value)])}var n=ta.id("priceSelect").getParent(),r=n.getElement(".slider_redesign"),l=r.className,d=(currencyCodes[parseInt(n.getElement("select").value)],ta.has("hacform.slider.price.min")?ta.remove("hacform.slider.price.min"):a.selMin),o=ta.has("hacform.slider.price.max")?ta.remove("hacform.slider.price.max"):a.selMax;r.className=l.replace(/steps_\d+/,"steps_"+a.steps),ta.widgets.slider.setHooks(n,d,o,a.min,a.max)}}},priceUpdate:function(e,t,a,s){e.hasClass("prcRng")||(e=e.getParent(".prcRng"));var i=ta.id("l1currency"),n=currencyCodes[parseInt(i.value)];e.getElement(".s_min").innerHTML=ta.util.currency.formatCurrency(t,n);var r=ta.util.currency.formatCurrency(a,n);s&&(r+="+"),e.getElement(".s_max").innerHTML=r},ratingUpdate:function(e,t,a,s){e.hasClass("tvrRtg")||(e=e.getParent(".tvrRtg"));var i=t.toPrecision(2),n=a.toPrecision(2);e.getElement(".s_min").innerHTML=i,e.getElement(".s_max").innerHTML=n;var r=e.getElement(".sLeft .lmtImg").src;e.getElement(".sLeft .lmtImg").src=r.replace(/\d.\d/,i);var l=e.getElement(".sRight .lmtImg").src;e.getElement(".sRight .lmtImg").src=l.replace(/\d.\d/,n)},bedroomsUpdate:function(e,t,a,s){"FIELDSET"!=e.tagName&&(e=e.getParent("FIELDSET")),e.getElement(".s_min").innerHTML=0==t?js_filter_studio:t,e.getElement(".s_max").innerHTML=0==a?js_filter_studio:a+(s?"+":"")},simpleUpdate:function(e,t,a,s){"FIELDSET"!=e.tagName&&(e=e.getParent("FIELDSET")),e.getElement(".s_min").innerHTML=t,e.getElement(".s_max").innerHTML=a+(s?"+":"")}},window.sliderMoved||(window.sliderMoved=function(){if(window.slidersReady){ta.servlet.HACSearch.adjustTopValueState();var e="LocalMapsRedesign"==window.pageServlet;filtersChanged(null,e)}});
ta.overlays||(ta.overlays={}),ta.overlays.BACKDROP_NEVER=0,ta.overlays.BACKDROP_ALWAYS=1,ta.overlays.Overlay=new Class({Implements:[Options,Events],Binds:["_hide","show","hide","destroy","hideByClickOnDocument"],options:{requestData:null,showCloseButton:!1,noPadding:!1,noCpu:!1,closeButtonClass:"ui_close_x",closeLink:"",showArrow:!1,arrowClassLeft:null,arrowClassRight:null,arrowClass:"ttarrow",style:"typeO",innerDivClass:"inner",backdrop:ta.overlays.BACKDROP_NEVER,backdropZIndex:"default",permanent:!1,permanent_except_same:!1,type:"",isChild:!1,remoteContent:null,maintainCrPageServlet:!1,keepElementInDocument:!1,requestMethod:"get",zIndex:1001,positionType:"absolute",draggable:!1,draggingClass:"dragging",title:null,onscroll:null,noScroll:!1,noScrollY:!1,backdropClickClose:!1,backdropColor:"#000",backdropOpacity:.6,offsetRight:0,offsetLeft:0,offsetTop:0,offsetBottom:0,closeOnDocumentClick:!1,track:!1,positionByOffsets:!1,useTransparentOverlayPadding:!1,transparentOverlayPaddingValue:0},initialize:function(t,e){if(this.noScroll=t.noScroll||t.noScrollY,t.noScroll?this.overflowToHide="overflow":t.noScrollY&&(this.overflowToHide="overflow-Y"),this.noScroll){var i=t.onShow;t.onShow=function(){i&&i(),ta.find("body").setStyle(this.overflowToHide,"hidden")};var s=t.onClose;t.onClose=function(){s&&s(),ta.find("body").setStyle(this.overflowToHide,"")}}this.setOptions(t),this.source=ta.id(e),this.visible=!1,this.backdropOn=!1,this.closedByDocClick=!1;var o=this.options.style+" overlay oldoly";if(o+=this.options.backdrop==ta.overlays.BACKDROP_ALWAYS?" withBackdrop":" noBackdrop",this.container=new Element("div",{styles:{position:this.options.positionType,left:"-999em",top:"-999em",fontSize:this.options.fontSize||".75em",zIndex:this.options.zIndex},"class":o}),t.blockSelect&&(this.container.onselectrn!1}),this.container.overlay=this,ta.store("overlays.current",this),this._useIframeShim=Browser.ie6,this.options.title&&(this.header=new Element("h1",{"class":"title",html:this.options.title}).inject(this.container),this.options.draggable)){var n=this.options.draggingClass,a=function(){};this._useIframeShim&&(a=this.positionShim.bind(this)),this.options.useTransparentOverlayPadding&&(a=this.transparentOverlayPadding.bind(this)),this.drag=new Drag(this.container,{handle:this.header,preventDefault:!0,stopPropagation:!0,onSnap:function(t){t.addClass(n)},onDrag:a,onComplete:function(t){t.removeClass(n)}})}this.inner=new Element("div",{"class":this.options.innerDivClass}).inject(this.container),this.inner.id="overlayInnerDiv";var r=this;r.options.onscroll&&r.inner.addEvent("scroll",function(){r.options.onscroll(r.inner)}),this._useIframeShim&&(this.shim=new IframeShim(this.container,{browsers:!0})),this.options.useTransparentOverlayPadding&&(this.transparentOverlayPadding=new Element("div",{"class":"overlayPadding",styles:{position:"absolute","z-index":this.options.zIndex-1}}),this.transparentOverlayPaddingValue=this.options.transparentOverlayPaddingValue);var h;this.options.content?this.inner.setContent(this.options.content):this.options.remoteContent?this.loadRemoteContent(this.options.remoteContent):this.source&&(h=this.source.getElement(".overlayContents"))&&h&&(this.inner.set("html",h.innerHTML),h.dispose(),this.runBehaviorOnFirstShow=!0),this.options.showCloseButton?this.addCloseButton():this.options.setCloseButton&&this.setCloseButton(),this.options.showArrow&&(this.arrow=new Element("div",{styles:{position:"absolute"},"class":this.options.arrowClass}).inject(this.container),this.header?this.container.addClass("withClose"):this.inner.addClass("withClose")),this.options.noPadding&&(this.header?this.container.addClass("noPad"):this.inner.addClass("noPad")),this.options.noCpu&&(this.header?this.container.addClass("no_cpu"):this.inner.addClass("no_cpu")),this.container.addEvent("trash",this.destroy)},addCloseButton:function(){var t=this.options.closeButtonClass;ta.has("checkrates.add_holding_windows")&&(t+=" no_cpu"),this.closeBtn=new Element("div",{styles:{position:"absolute",fontSize:"92.5%",cursor:"pointer"},"html":this.options.closeLink,"class":t,events:{his)}.bind(this)}}).inject(this.container),this.header?this.container.addClass("withClose"):this.inner.addClass("withClose")},setCloseButton:function(){this.options.closeButtonClass&&(this.closeBtn=this.container.getElement("."+this.options.closeButtonClass),this.closeBtn&&this.closeBtn.addEvents({click:function(){this.fireEvent("onClose",this),this.hide()}.bind(this)}))},destroy:function(){this.container.overlay=null,this.shim&&(this.shim.destroy(),this.shim=null),this.transparentOverlayPadding&&(this.transparentOverlayPadding.destroy(),this.transparentOverlayPadding=null)},position:function(){this.shim&&function(){this.positionShim()}.delay(10,this),this.transparentOverlayPadding&&function(){this.positionTransparentOverlayPadding()}.delay(10,this)},positionTransparentOverlayPadding:function(){var t=this.container.getCoordinates();if(t&&t.left){var e=this.transparentOverlayPaddingValue;this.transparentOverlayPadding.setStyles({left:t.left-e,top:t.top-e})}},positionShim:function(){var t=this.container.getCoordinates();t&&t.left&&this.shim.shim.setStyles({left:t.left,top:t.top})},show:function(t){"undefined"==typeof overlayCss||ta.retrieve("ta.overlayCssAsset")?this._show(t):this.options.waitForCss?ta.store("ta.overlayCssAsset",Asset.css(overlayCss,{media:"screen, print",ow(t)}.bind(this)})):(ta.store("ta.overlayCssAsset",Asset.css(overlayCss,{media:"screen, print"})),this._show(t))},_show:function(t){if(!this.visible){t&&new Event(t).preventDefault(),this.closedByDocClick=!1;var e=ta.util.URL.parse(this.options.remoteContent);!this.options.maintainCrPageServlet&&"undefined"!=typeof crPageServlet&&e&&e.test(/\/{1}(\w*)$/)&&(ta.store("crPageServlet_orig",crPageServlet),crPageServlet=RegExp.$1),$$(".overlay").each(function(e){if(e.overlay){if(e.overlay==this)return;if(this.parentOverlay&&e.overlay==this.parentOverlay)return;if(e.overlay.options.permanent)return;if(e.overlay.options.permanent_except_same&&e.overlay.options.type!=this.options.type)return;e.overlay.hide(t)}},this);var i=ta.id(this.options.parentContainer||document.body);if(i.adopt(this.container),this.shim&&this.shim.shim){i.adopt(this.shim.shim);var s=this.container.getCoordinates();s&&this.shim.shim.setStyles({"display":"block","width":s.width,"height":s.height})}if(this.transparentOverlayPadding){i.adopt(this.transparentOverlayPadding);var s=this.container.getCoordinates();if(s){var o=2*this.transparentOverlayPaddingValue;this.transparentOverlayPadding.setStyles({"display":"block","width":s.width+o,"height":s.height+o})}}return this.options.backdrop==ta.overlays.BACKDROP_ALWAYS&&this.enableBackdrop(),this.position(),this.options.closeOnDocumentClick&&document.addEvent("click",this._hide.bind(this)),this.visible=!0,this.fireEvent("onShow",this),ta.fireEvent("onOverlayShow",this),ta.has("overlay.onShow")&&ta.remove("overlay.onShow")his)},this),this}},_setPosition:function(t){if(this.options.parentContainer){var e=Math.abs(this.container.getPosition().x-this.container.offsetLeft),i=Math.abs(this.container.getPosition().y-this.container.offsetTop),s={};void 0!==t.left&&(s.left=Math.abs(t.left-e)),void 0!==t.top&&(s.top=Math.abs(t.top-i)),void 0!==t.bottom&&(s.right=Math.abs(t.right-e)),void 0!==t.right&&(s.bottom=Math.abs(t.bottom-i)),this.container.setStyles(Object.merge(t,s))}else this.container.setStyles(t)},_hide:function(t){if(this.noScroll&&ta.find("body").setStyle(this.overflowToHide,""),t&&!this.container.containsEvent(t)){if(this.options.pinnable==ta.overlays.PINNABLE_HOVER||this.options.pinnable==ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE)for(var e=t.target;e;){if(e==this.source)return;e=e.parentElement}document.removeEvent("click",this._hide),this.hide(t)}},hideByClickOnDocument:function(t){ta.retrieve("overlay.dontCloseOnClick")||(this.closedByDocClick=!0,this.hide(t))},hide:function(t){return window.flyout&&window.flyout.hide(),this.backdropOn&&this.disableBackdrop(),this.options.keepElementInDocument&&"-999em"==this.container.style.left||!this.options.keepElementInDocument&&!this.container.inDocument()?this:(this.shim&&this.shim.hide().dispose(),this.transparentOverlayPadding&&this.transparentOverlayPadding.hide().dispose(),this.container.setStyles({left:"-999em",top:"-999em"}),this.options.keepElementInDocument||this.container.dispose(),this.visible=!1,this.fireEvent("onHide",!t),ta.fireEvent("onOverlayClose",this),!this.options.maintainCrPageServlet&&ta.has("crPageServlet_orig")&&ta.run("ta.meta.linkTracking.restoreCRPageServlet"),this.options.closeFunction&&"function"==typeof this.options.closeFunction&&this.options.closeFunction(t),this.noScroll&&ta.find("body").setStyle(this.overflowToHide,""),this)},calculateBackdropHeight:function(){return Math.max(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight,document.body.scrollHeight)},configureBackdrop:function(){var t,e={"class":"overlayBG"};t="behindOverlay"===this.options.backdropZIndex?this.options.zIndex-1:this.options.isChild?1e4:9997,this.backdrop=new Element("div",e),this.backdrop.setStyles({position:"fixed",left:0,top:0,width:"100%",height:this.calculateBackdropHeight(),backgroundColor:this.options.backdropColor,zIndex:t,opacity:this.options.backdropOpacity,filter:"alpha(opacity="+Math.floor(100*this.options.backdropOpacity)+")"}),this.options.backdropClickClose&&this.backdrop.addEvent("cde()}.bind(this))},updateBackdrop:function(){this.backdrop.setStyles({width:"100%",height:this.calculateBackdropHeight()})},enableBackdrop:function(){try{if(this.backdropOn)return;if(this.backdrop||this.configureBackdrop(),Browser.ie6){var t=this.container;$$("select").each(function(e){t.contains(e)?e.setStyle("visibility","visible"):e.setStyle("visibility","hidden")})}ta.store("overlays.current",this),this.updateBackdrop(),this.container.inDocument()?this.backdrop.inject(this.container,"before"):this.backdrop.inject(document.body),this.backdropOn=!0,"behindOverlay"===this.options.backdropZIndex||(this.options.zIndexParam?this.container.setStyle("z-index",this.options.zIndexParam):this.container.setStyle("z-index",this.options.isChild?"10002":"9998")),ta.overlays.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")&&(Browser.ie7||Browser.ie8?this.container.setStyle("border","5px solid #424242"):this.container.setStyle("border","5px solid rgba(64,64,64,0.8)"))}catch(t){ta.util.error.record(t,"Error setting the border property - enableBackdrop")}},disableBackdrop:function(){try{if(!this.backdropOn)return;this.backdrop.dispose(),ta.retrieve("overlays.current")==this?(ta.remove("overlays.current"),Browser.ie6&&$$("select").setStyle("visibility","visible")):Browser.ie6&&ta.retrieve("overlays.current")&&!ta.retrieve("overlays.current").backdropOn&&$$("select").setStyle("visibility","visible"),this.backdropOn=!1,this.container.setStyle("z-index","1001"),ta.overlays.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")&&(Browser.ie7||Browser.ie8?this.container.setStyle("border","5px solid #b2b2b2"):this.container.setStyle("border","5px solid rgba(128,128,128,0.6)"))}catch(t){ta.util.error.record(t,"Error unsetting the border property - disableBackdrop")}},loadRemoteContent:function(t,e){var i={url:ta.util.URL.parse(t),method:this.options.requestMethod,data:this.options.requestData,onSuccess:this.loadRemoteSuccess.bind(this),onFailure:this.loadRemoteFailure.bind(this),evalScripts:!0};return this.options.track&&(i.trackEvent=this.options.track),e||this.options.hideSpinner||new Asset.image(CDNHOST+"/img2/generic/site/loop.gif",{onload:this.position.bind(this),"class":"anim_loop"}).inject(this.inner),new Request(i).send(),this},loadRemoteSuccess:function(t){if("string"==typeof t){var e=document.head||ta.select("head")[0];t=t.replace(new RegExp("<style.*?>((.|\n)*?)</style.*?>","g"),function(t,i){var s=document.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i)),e.appendChild(s),""})}return this.cachedWidth=null,this.inner.setContent(t),this.position(),"undefined"!=typeof behavior&&behavior&&behavior.apply&&behavior.apply(this.inner),this.fireEvent("onLoad",this),this.cachedWidth=this.container.getSize().x,this.backdropOn&&this.updateBackdrop(),this},loadRemoteFailure:function(t){this.inner.addClass("ajax_failed"),this.inner.setStyle("width","383px"),this.inner.setStyle("padding","14px 24px 14px 14px"),this.inner.set("text",JS_Ajax_failed),this.fireEvent("onLoadRemoteFailure",t)}}),ta.overlays.getCurrent=function(){var t=$$(".overlay.oldoly").shift();return t&&t.overlay},ta.overlays.safeCloseCurrent=function(){var t=ta.overlays.getCurrent();return t&&t.hide()},ta.overlays.safeCloseFromDom=function(t){t=ta.id(t);var e=t&&t.getParent(".overlay"),i=e&&e.overlay;return i&&i.hide()},ta.overlays.isDHTMLCRRedesign2012=function(){if(ta.has("overlays.isDHTMLCRRedesignBasic"))return ta.retrieve("overlays.isDHTMLCRRedesignBasic");var t=$$(".overlay"),e=t.hasClass("rgba_flyout");return ta.store("overlays.isDHTMLCRRedesignBasic",e),e};
ta.overlays.AbsoluteOverlay=new Class({Extends:ta.overlays.Overlay,options:{xOffset:0,yOffset:0,toWindow:!0,repositionOnScroll:!1,autoShow:!0,stayOpen:!1,hideOnDocumentClick:!1},initialize:function(t,i){t=t||{},t.showCloseButton=[t.showCloseButton,!0].pick(),this.parent(t,i),this.options.showCloseButton&&!this.options.stayOpen&&this.closeBtn.addEvent("click",this.hide),this.options.hideOnDocumentClick&&document.addEvent("click",this.hideByClickOnDocument.bind(this)),this.options.autoShow&&this.show()},show:function(t){this.parent(t),this.options.repositionOnScroll&&window.addEvent("scroll",this.delayedScroll.bind(this))},hide:function(t){this.parent(t),this.options.repositionOnScroll&&window.removeEvent("scroll",this.delayedScroll.bind(this)),this.options.hideOnDocumentClick&&document.removeEvent("click",this.hideByClickOnDocument.bind(this))},hideByClickOnDocument:function(t){if(!t||!t.page)return!1;t=new Event(t);var i=t.page,o=this.inner.getCoordinates(),n=i.y>=o.top&&i.y<=o.bottom&&i.x>=o.left&&i.x<=o.right;n||this.parent(t)},delayedShis)},position:function(){this.container.setStyles({left:this.options.xOffset,top:this.options.yOffset+(this.options.toWindow?window.getScrollTop():0)}),this.parent()}});
ta.overlays.AbsoluteBottomOverlay=new Class({Extends:ta.overlays.Overlay,initialize:function(t,i){this.parent(Object.merge({positionType:"fixed"},t),i),this.options.showCloseButton&&!this.options.stayOpen&&this.closeBtn.addEvent("click",this.hide),thisOverlay=this,this.options.horizontalScroll&&window.addEvent("scroll",function(){var t=window.getScroll().x*-1;thisOverlay.container.setStyle("left",t)})},posIn()},reposition:function(){this.container.setStyles({top:null,left:null}),this.options.flyFromRight?this.container.setStyles({bottom:10,right:10}):(this.options.horizontalScroll?leftValue=window.getScroll().x*-1:leftValue=window.getCoordinates().width/2-this.container.getWidth()/2,this.container.setStyles({bottom:0,left:leftValue}))},flyIn:function(){this.options.flyFromRight?this.container.setStyle("right",-window.getCoordinates().width):this.container.setStyle("bottom",-this.container.getHeight());var t=new Fx.Tween(this.container,{duration:"1000",transition:"quad:out"});this.options.flyFromRight?t.start("right",10):t.start("bottom",0)},show:function(t){this.parent(t),this.options.flyFromRight||window.addEvent("resize",this.reposition.bind(this)),this.container.removeClass("overlay"),this.reposition()}});
ta.overlays.CenteredOverlay=new Class({Extends:ta.overlays.Overlay,Binds:["hideByClickOnDocument","position","hide","show"],options:{delayedPosition:!1,autoShow:!0,attachCloseEvent:!0,xOffset:-1,yOffset:-1,absoluteOffset:!1,fixed:!1},initialize:function(t,e){if(t=t||{},t.showCloseButton=[t.showCloseButton,!0].pick(),t.fixed&&(this.options.positionType="fixed"),this.parent(t,e),this.source){var i=this.source.getParentBySelector(".overlay");i&&(this.container.setStyle("z-index",i.getStyle("z-index")+1),this.parentOverlay=i.overlay)}this.options.showCloseButton&&this.options.attachCloseEvent&&this.closeBtn.addEvent("click",this.hide),this.options.autoShow&&this.show()},position:function(t){var e=ta.retrieve("ta.overlays.CenteredOverlay.position.iters");e||(e=0);var i=this.container.getCoordinates();if(i.height<=14&&e<10)return ta.store("ta.overlays.CenteredOverlay.position.iters",e+1),void this.position.delay(100,this,!0);var o=this.options.xOffset,s=this.options.yOffset;o===-1?(o=Math.max(5,(window.tabletOnFullSite?window.innerWidth:window.getWidth())-i.width)/2,!this.options.fixed&&(o+=window.getScrollLeft())):!this.options.absoluteOffset&&(o-=i.width/2),s===-1?(s=Math.max(20,(window.tabletOnFullSite?window.innerHeight:window.getHeight())-i.height)/2,!this.options.fixed&&(s+=window.getScrollTop())):!this.options.absoluteOffset&&(s-=i.height/2),ta.util.i18n.isRtl()?this.container.setStyles({left:null,right:o,top:s}):this.container.setStyles({left:o,top:s}),this.parent()},positionShim:function(){var t=this.container.getCoordinates();t&&t.left&&this.shim.shim.setStyles({left:t.left,top:t.top,width:t.width,height:t.height})},positionTransparentOverlayPadding:function(){var t=this.container.getCoordinates();if(t&&(!ta.util.i18n.isRtl()||t.right)&&t.left){var e=this.transparentOverlayPaddingValue,i=2*this.transparentOverlayPaddingValue;ta.util.i18n.isRtl()?this.transparentOverlayPadding.setStyles({left:null,right:t.right-e,top:t.top-e,width:t.width+i,height:t.height+i}):this.transparentOverlayPadding.setStyles({left:t.left-e,top:t.top-e,width:t.width+i,height:t.height+i})}}}),ta.overlays.showInLightbox=function(t,e){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},e)).loadRemoteSuccess(t)},ta.overlays.loadInLightbox=function(t,e){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},e)).loadRemoteContent(t)};var lightbox={deactivate:function(){var t=ta.retrieve("overlays.current");t&&t.hide()}};
ta.overlays.CouponOverlay=new Class({Extends:ta.overlays.CenteredOverlay,initialize:function(t,e){this.parent(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS,fixed:!0,waitForCss:!0},t),e),this._opaqueBG=null,this._opaqueImg=null,"ie"===Browser.name&&this._enableOpaqueBG(),window.addEvent("resize",this.position.bind(this))},hide:function(t){return this._opaqueBG&&(this._opaqueBG.dispose(),this._opaqueBG=null,this._opaqueImg=null),this.parent(t),this},position:function(){if(this.parent(),this._opaqueBG){var t=this.container.getCoordinates();this._opaqueBG.setStyles({top:Math.max(20,window.getHeight()-t.height)/2+window.getScrollTop(),left:Math.max(5,window.getWidth()-t.width)/2,width:t.width,height:t.height}),this._opaqueImg.setStyles({width:t.width,height:t.height})}},_enableOpaqueBG:function(){if(!this._opaqueBG){var t=this.options.isChild?9999:9996;this._opaqueBG=new Element("div",{"class":"printCouponBackground"}),this._opaqueImg=new Element("img",{"src":"/img2/generic/site/white_1x1.png"});var e=this.container.getCoordinates();this._opaqueBG.setStyles({top:Math.max(20,window.getHeight()-e.height)/2+window.getScrollTop(),left:Math.max(5,window.getWidth()-e.width)/2,width:e.width,height:e.height,zIndex:t,position:"fixed"}),this._opaqueImg.setStyles({width:e.width,height:e.height}),this._opaqueImg.inject(this._opaqueBG),this.container.inDocument()?this._opaqueBG.inject(this.container,"before"):this._opaqueBG.inject(document.body)}}}),ta.overlays.showCouponInLightbox=function(t,e){var i=new ta.overlays.CouponOverlay(e),o=i.loadRemoteSuccess(t);return i.show(),o};
ta.overlays.ACTIVATE_NEVER=0,ta.overlays.ACTIVATE_CLICK=1,ta.overlays.ACTIVATE_HOVER=2,ta.overlays.ACTIVATE_FOCUS=3,ta.overlays.ACTIVATE_HOVER_DELAY=4,ta.overlays.ACTIVATE_BOTH=5,ta.overlays.ACTIVATE_CLICK_ALTERNATE=6,ta.overlays.ACTIVATE_BOTH_DELAY=7,ta.overlays.ACTIVATE_CLICK_TOGGLE=8,ta.overlays.PINNABLE_NEVER=0,ta.overlays.PINNABLE_ALWAYS=1,ta.overlays.PINNABLE_CLICK=2,ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE=3,ta.overlays.PINNABLE_HOVER=4,ta.overlays.BACKDROP_PINNED=2,ta.overlays.RelativeOverlay=new Class({Extends:ta.overlays.Overlay,Binds:["overrideHoverDelayOnce","overridePinnableOption","_hide","show","hide","disable","destroy","hideNow","showWithDelay","hideWithDelay","_pin","prolongVisibility","showOrHide","_bothEnter","_bothEnterWithDelay","_bothClick"],options:{activate:ta.overlays.ACTIVATE_NEVER,pinnable:ta.overlays.PINNABLE_NEVER,activateHoverDelayTime:300,hoverDelayTime:250,pointArrowToSource:!1,autoShow:!0,ignoreFirstClickAfterHover:!1,ignoreFirstClick:!1,closeFunction:!1,showFunction:!1,closeButtonFunction:!1},initialize:function(e,t){this.parent(e,t),this.debug_sticky=ta.retrieve("debug.stickyOverlays"),this.container.addClass("relative");var i=this.source&&(this.source.getParentBySelector(".overlay")||this.source.getParentBySelector(".ui_overlay"));switch(i&&(this.container.setStyle("z-index",parseInt(i.getStyle("z-index"),10)+2),this.parentOverlay=i.overlay),this.enabled=!0,this.options.showCloseButton&&this.closeBtn&&(this.closeBtn.addEvent("click",function(){try{this.options.closeButtonFunction&&"function"==typeof this.options.closeButtonFunction&&this.options.closeButtonFunction()}catch(e){}this.hideNow()}.bind(this)),this.options.smartCloseButton&&this.closeBtn.hide()),this.options.activate){case ta.overlays.ACTIVATE_CLICK:this.source.addEvent("click",this.show);break;case ta.overlays.ACTIVATE_CLICK_TOGGLE:this.source.addEvent("click",this.showOrHide);break;case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show),this.container.addEvent("mouseenter",this.show),this.source.addEvent("mouseleave",this.hide),this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay),this.source.addEvent("mouseleave",this.hideWithDelay),this.container.addEvent("mouseenter",this.show),this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_FOCUS:this.source.addEvent("focus",this.show);break;case ta.overlays.ACTIVATE_CLICK_ALTERNATE:this.source.addEvent("mouseenter",this.prolongVisibility),this.container.addEvent("mouseenter",this.prolongVisibility),this.source.addEvent("mouseleave",this.hide),this.container.addEvent("mouseleave",this.hide),this.source.addEvent("click",this.showOrHide);break;case ta.overlays.ACTIVATE_BOTH:this.source.addEvent("mouseenter",this._bothEnter),this.container.addEvent("mouseenter",this._bothEnter),this.source.addEvent("mouseleave",this.hide),this.container.addEvent("mouseleave",this.hide),this.source.addEvent("click",this._bothClick),this.ignoreNextClick=e.ignoreFirstClickAfterHover&&e.ignoreFirstClick;break;case ta.overlays.ACTIVATE_BOTH_DELAY:this.source.addEvent("mouseenter",this._bothEnterWithDelay),this.container.addEvent("mouseenter",this._bothEnter),this.source.addEvent("mouseleave",this.hideWithDelay),this.container.addEvent("mouseleave",this.hide),this.source.addEvent("click",this._bothClick),this.ignoreNextClick=e.ignoreFirstClickAfterHover&&e.ignoreFirstClick}switch(this.options.pinnable){case ta.overlays.PINNABLE_CLICK:case ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE:this.source.addEvent("click",this._pin)}if("undefined"!=typeof this.options.remoteLink&&null!=this.options.remoteLink)this.loadRemoteContent(this.options.remoteLink);else if(this.source){var s=this.source.getElement(".overlaySrc");s?"a"==s.get("tag")?this.loadRemoteContent(s.href):(this.loadRemoteContent(s.get("text")),s.dispose()):this.options.content||"a"!=this.source.get("tag")||this.loadRemoteContent(this.source.href)}var o=this.source&&ta.id(this.source.id+"_CONTENTS");o&&(this.inner.set("html",o.innerHTML),o.dispose(),this.runBehaviorOnFirstShow=!0),this.options.autoShow?this.show():this.options.delayShow&&this.showWithDelay()},enable:function(){this.enabled=!0},did=!1},overrideHoverDelayOnce:function(e){this.overriddenHoverDelayTime=e},overridePinnableOption:function(e){e===!0?(this.source.addEvent("click",this._pin),this.container.addEvent("click",this._pin)):e===!1&&(this.source.removeEvent("click",this._pin),this.container.removeEvent("click",this._pin),this.unpin())},show:function(e){if(e=e||window.event,e&&new Event(e).stop(),this.enabled){var t=this.visible;if(this.parent(e),clearTimeout(this.showTimeout),this.options.activate!=ta.overlays.ACTIVATE_HOVER&&this.options.activate!=ta.overlays.ACTIVATE_HOVER_DELAY&&this.options.activate!=ta.overlays.ACTIVATE_BOTH&&this.options.activate!=ta.overlays.ACTIVATE_BOTH_DELAY||!this.hideTimer||(clearTimeout(this.hideTimer),this.hideTimer=null),!t){switch(this.runBehaviorOnFirstShow&&(this.runBehaviorOnFirstShow=!1,"undefined"!=typeof behavior&&behavior&&behavior.apply&&behavior.apply(this.inner)),this.cachedWidth=this.container.getSize().x,this.options.pinnable){case ta.overlays.PINNABLE_HOVER:this._pin()}switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_CLICK_TOGGLE:case ta.overlays.ACTIVATE_FOCUS:this.options.pinnable==ta.overlays.PINNABLE_NEVER&&document.addEvent("click",this.hideByClickOnDocument.bind(this))}return this.options.showFunction&&this.options.showFunction(),this}}},hide:function(e){if(this.debug_sticky)return this;if(e=e||window.event,this.visible){if(window.flyout&&window.flyout.hide(),e){var t=new Event(e);if(t.target&&"option"==t.target.tagName)return;if(Browser.ie&&t.target&&"select"==t.target.tagName&&this.container.getElements("select").contains(t.target))return;if(ta.page&&ta.page.usingUnifiedDates&&ta.find&&ta.find(".ui_modal.date_picker_modal",document.body))return}switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:case ta.overlays.ACTIVATE_CLICK_ALTERNATE:case ta.overlays.ACTIVATE_BOTH:case ta.overlays.ACTIVATE_BOTH_DELAY:if(!this.hideTimer){var i=this.options.hoverDelayTime;return void 0!==this.overriddenHoverDelayTime&&(i=this.overriddenHoverDelayTime,delete this.overriddenHoverDelayTime),void(this.hideTimer=this.hide.delay(i,this))}clearTimeout(this.hideTimer),this.hideTimer=null;break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_CLICK_TOGGLE:case ta.overlays.ACTIVATE_FOCUS:if(e&&this.container.containsEvent(e))return;this.options.pinnable==ta.overlays.PINNABLE_NEVER&&document.removeEvent("click",this.hide)}return this.hideNow()}},hideNow:function(e){return this.visible?(this.backdropOn&&this.disableBackdrop(),this.shim&&this.shim.hide().dispose(),this.transparentOverlayPadding&&this.transparentOverlayPadding.hide().dispose(),this.options.positionByOffsets?this.container.dispose():this.container.setStyles({left:"-999em",top:"-999em"}).dispose(),this.visible=!1,this.options.pinnable!=ta.overlays.PINNABLE_CLICK&&this.options.pinnable!=ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE&&this.options.pinnable!=ta.overlays.PINNABLE_HOVER||this.unpin(),this.fireEvent("onHide",!e),this.options.closeFunction&&this.options.closeFunction(),this):this}(!0)},pin:function(){switch(this.source=ta.id(this.source),this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.removeEvent("mouseenter",this.show),this.source.removeEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_BOTH:this.source.removeEvent("mouseenter",this._bothEnter),this.source.removeEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.removeEvent("mouseenter",this.showWithDelay),this.source.removeEvent("mouseleave",this.hideWithDelay);break;case ta.overlays.ACTIVATE_BOTH_DELAY:this.source.removeEvent("mouseenter",this._bothEnterWithDelay),this.source.removeEvent("mouseleave",this.hideWithDelay)}return this.container.removeEvent("mouseenter",this.show),this.container.removeEvent("mouseleave",this.hide),this.pinned=!0,this.options.smartCloseButton&&this.closeBtn&&this.closeBtn.show(),this},toggleBackdrop:function(e){this.options.backdrop==ta.overlays.BACKDROP_PINNED&&this.enableBackdrop()},unpin:function(){switch(this.source=ta.id(this.source),this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show),this.source.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_BOTH:this.source.addEvent("mouseenter",this._bothEnter),this.source.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay),this.source.addEvent("mouseleave",this.hideWithDelay);break;case ta.overlays.ACTIVATE_BOTH_DELAY:this.source.addEvent("mouseenter",this._bothEnterWithDelay),this.source.addEvent("mouseleave",this.hideWithDelay)}return this.container.addEvent("mouseenter",this.show),this.container.addEvent("mouseleave",this.hide),this.options.backdrop==ta.overlays.BACKDROP_PINNED&&this.disableBackdrop(),this.pinned=!1,this.options.smartCloseButton&&this.closeBtn&&this.closeBtn.hide(),this},showWithDelay:function(e){return e=e||window.event,clearTimeout(this.showTimeout),this.visible?this.show(e):void(this.showTimeout=this.show.delay(this.options.activateHoverDelayTime,this))},hideWithDelay:function(e){return e=e||window.event,this.visible?this.hide(e):void clearTimeout(this.showTimeout)},prolongVisibility:function(){this.visible&&this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null)},showOrHide:function(e){if(!this.blockShowOrHide)return this.visible?this.hideNow(e):this.show(e)},_bothEnter:function(e){return this.ignoreNextClick=this.options.ignoreFirstClickAfterHover,this.show(e)},_bothEnterWithDelay:function(e){return this.ignoreNextClick=this.options.ignoreFirstClickAfterHover,this.showWithDelay(e)},_bothClick:function(e){return this.ignoreNextClick?(e=e||window.event,e&&new Event(e).stop(),this.ignoreNextClick=!1,this):this.showOrHide(e)}});
ta.overlays.RelativeOverlayHorizontal=new Class({Extends:ta.overlays.RelativeOverlay,options:{arrowHeight:0,arrowLeftForce:0,arrowTopForce:0,allowRightArrowPos:!1,allowBelowBottomEdge:!1,mirrorIfRtl:!1},initialize:function(t,i){return null==t.onRight?void(IS_DEBUG&&alert("ERROR: Attempting to create Horizontal Overlay without specifying direction.")):(t.mirrorIfRtl&&ta.util.i18n.isRtl()&&(t.onRight=!t.onRight,t.offsetLeft?(t.offsetRight=-t.offsetLeft,t.offsetLeft=0):t.offsetRight&&(t.offsetLeft=-t.offsetRight,t.offsetRight=0)),void this.parent(t,i))},position:function(){this.options.onRight?this.positionRight():this.positionLeft(),this.parent()},adjustTop:function(t,i){try{this.source=ta.id(this.source);var o=t+this.options.offsetTop;if(!this.options.allowBelowBottomEdge){var e=window.getScrollTop()+window.getHeight(),r=document.getElementById("tamgFooter");if(r&&(r.offsetHeight?e-=r.offsetHeight:r.clientHeight&&(e-=r.clientHeight)),o+i.height>=e&&(o=e-i.height-1,(this.crDHTML_BASIC||this.crDHTML_PNG24)&&this.options.showArrow)){var s=this.container.getElement(".check_availability"),h=this.container.getElement(".username");if(s||h)var n=s?s:h,a=n.getCoordinates().height;o=e-i.height+a-9}}return o}catch(t){ta.util.error.record(t,"adjustTop: RelativeOverlayHorizontal")}},positionLeft:function(){try{this.source=ta.id(this.source);var t=this.source.getCoordinates(),i=this.container.getStyle("margin-top").toInt(),o=ta.id("PAGE").getCoordinates(),e=this.container.getCoordinates();if(!this.flipped&&t.left-o.left-(this.cachedWidth||e.width)<0)return this.flipped=!0,this.options.onRight=!0,this.arrow&&(this.arrow.className=this.options.arrowClassLeft),void this.positionRight();if(ta.overlays.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability"))this.positionLeftOrRight(t,i,o,e,"left");else{var r=this.adjustTop(t.top,e)-i;t.left=t.left-this.options.offsetLeft,this._setPosition({left:null,right:window.getWidth()-t.left+(this.options.xoffset||0),top:r}),this.options.pointArrowToSource&&this.options.arrowHeight&&this.setArrowPosition(t,i,o,e,"left",r)}}catch(t){ta.util.error.record(t,"positionRight: RelativeOverlayHorizontal")}},positionRight:function(){try{this.source=ta.id(this.source);var t=this.source.getCoordinates(),i=this.container.getStyle("margin-top").toInt(),o=this.container.getStyle("margin-bottom").toInt(),e=ta.id("PAGE").getCoordinates(),r=this.container.getCoordinates();if(!this.flipped&&e.right-t.right-(this.cachedWidth||r.width)<0)return this.flipped=!0,this.options.onRight=!1,this.arrow&&(this.arrow.className=this.options.arrowClassRight),void this.positionLeft();if(t.right=t.right-this.options.offsetRight,ta.overlays.isDHTMLCRRedesign2012()&&(this.container.getElement(".check_availability")||this.container.getElement(".username")))this.positionLeftOrRight(t,i,e,r,"right");else{var s=this.adjustTop(t.top,r)-i;this.container.setStyles({right:null,left:t.right+(this.options.xoffset||0),top:s}),this.options.pointArrowToSource&&this.options.arrowHeight&&this.setArrowPosition(t,i+o,e,r,"right",s)}}catch(t){ta.util.error.record(t,"positionRight: RelativeOverlayHorizontal")}},setArrowPosition:function(t,i,o,e,r,s){if("left"===r){this.arrow.setStyle("left",this.options.arrowLeftForce);var h=s<t.top?t.top-s:0,n=Math.max(-1,h+(t.height/2).toInt()-this.options.arrowHeight/2),a=e.height-this.options.arrowHeight-i-3;this.arrow.setStyle("top",Math.min(n,a))}else if("right"===r&&this.options.allowRightArrowPos)if(this.options.arrowTopForce)this.arrow.setStyle("top",this.options.arrowTopForce);else{this.options.arrowRightForce&&this.arrow.setStyle("right",this.options.arrowRightForce);var h=s<t.top?t.top-s:0,n=Math.max(-1,h+(t.height/2).toInt()-this.options.arrowHeight/2),a=e.height-this.options.arrowHeight-i-3;this.arrow.setStyle("top",Math.min(n,a))}else"right"===r&&ta.util.error.record("setArrowPosition with dir === right is only supported with options.allowRightArrowPos set")},positionLeftOrRight:function(t,i,o,e,r){try{var s=this.container.getElement(".check_availability"),h=this.container.getElement(".username");if(ta.retrieve("isDaoDao"))var n=t.top;else var n=this.adjustTop(t.top,e);var a=s?s:h,l=a.getCoordinates().height,g=16,f=n-l+g/2,p=!1;if(s){var c=window.getScrollTop(),d=ta.id("PERSISTENT_CHECK_RATES");d&&(c+=d.getCoordinates().height),n-.5*e.height<c&&(f=c,t.bottom-c>32?f=c:t.bottom-c<=32&&(f=t.bottom-32),p=!0)}var w=s?f:f+5;if("undefined"==typeof dhtml_cr_redesign_basic||this.crDHTML_BASIC||(this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic,{onLoad:function(){this.position()}.bind(this)})),"undefined"==typeof dhtml_cr_redesign_png24||this.crDHTML_PNG24||(this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24,{onLoad:function(){this.position()}.bind(this)})),this.crDHTML_BASIC){var v=s?t.right+13:t.right-45;"left"==r&&(v=t.left+13);var u=-16}if(this.crDHTML_PNG24){var v=s?t.right+20:t.right-45;if("left"==r)var v=window.getWidth()-t.left+20;var u=s?-21:-24}if("left"==r?this._setPosition({right:v,left:null,top:w}):this._setPosition({right:null,left:v,top:w}),this.arrow){this.arrow.setStyle("display","block");var R=s?16:0;p?this.arrow.setStyle("top",t.bottom-w-32):this.arrow.setStyle("top",l-R),"left"==r?this.arrow.setStyle("left",e.width-13):this.arrow.setStyle("left",u);try{t=this.source.getCoordinates(),e=this.container.getCoordinates();var y=window.getScrollTop()+window.getHeight(),m=t.top-e.top-g/2,R=s?0:20;n+e.height>=y&&m>0?(this.arrow.setStyle("top",m+R),t.bottom+g/2>=e.bottom&&(this.container.setStyle("top",w+2*g),this.arrow.setStyle("top",m-2*g+R))):m<=0&&!p&&this.container.setStyle("top",w-l+g)}catch(t){ta.util.error.record(t,"bottomEdge - Reposition arrow and container: RelativeOverlayHorizontal")}}}catch(t){ta.util.error.record(t,"positionLeftOrRight: RelativeOverlayHorizontal")}}});
ta.overlays.RelativeOverlayRight=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(e,t){this.parent(Object.merge({onRight:!0},e),t)}});
ta.overlays.RelativeOverlayLeft=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(e,t){this.parent(Object.merge({onRight:!1},e),t)}});
ta.overlays.RelativeOverlayVertical=new Class({Extends:ta.overlays.RelativeOverlay,options:{flipPadding:0,allowFlip:!0,arrowWidth:0},initialize:function(t,i){return null==t.below?void(IS_DEBUG&&alert("ERROR: Attempting to create Vertical Overlay without specifying direction.")):void this.parent(t,i)},position:function(){this.options.below?this.positionBelow():this.positionAbove(),this.parent()},positionBelow:function(){if("fixed"==this.options.positionType){var t=this.source.getBoundingClientRect(),i=t.left,o=t.bottom;return this.options.positionAsPercent&&(i=i/window.innerWidth*100+"%",o=o/window.innerHeight*100+"%"),void this._setPosition({left:i,top:o})}var s,e=this.options.positionSource?this.options.positionSource.getCoordinates():this.source.getCoordinates(),n=this.container.getCoordinates(),l=this._styleValueToPixel(this.container.getStyle("margin-left")),h=this._styleValueToPixel(this.container.getStyle("margin-right")),r=this.container;s=this.options.leftEdge?this.options.leftEdge:"right"==this.options.justify?e.left+e.width-n.width:this.options.centered?e.left+e.width/2-n.width/2:e.left;var p=window.getHeight()+window.getScrollTop(),a=e.bottom;this.options.offsetTop&&(a-=this.options.offsetTop),this.options.scrollContainer&&(a-=this.options.scrollContainer.scrollTop),this.options.allowFlip&&!this.flipped&&p-n.height-a<0&&e.top-n.height>0?(this.options.below=!1,this.flipped=!0,r.addClass("relAbove").removeClass("relBelow"),a=e.top-n.height-this.options.flipPadding,this.options.scrollContainer&&(a-=this.options.scrollContainer.scrollTop)):r.addClass("relBelow").removeClass("relAbove"),s-=this.options.offsetLeft;var f=this.adjustEdge(s-l,n.width);if(this._setPosition({left:f,top:a+(this.options.yoffset||0)}),this.options.pointArrowToSource&&this.options.arrowWidth){var d=f<e.left?e.left-f:0,w=(e.width/2).toInt()-this.options.arrowWidth/2,g=d+w,c=n.width-this.options.arrowWidth-l-h;this.arrow.setStyles({right:"",left:Math.min(g,c)})}},_styleValueToPixel:function(t){var i=t&&t.toInt();return i?i:0},positionAbove:function(){var t,i=this.options.positionSource?this.options.positionSource.getCoordinates():this.source.getCoordinates(),o=this.container.getCoordinates(),s=this._styleValueToPixel(this.container.getStyle("margin-left")),e=this._styleValueToPixel(this.container.getStyle("margin-right")),n=this.container;t="right"==this.options.justify?i.left+i.width-o.width:this.options.centered?i.left+i.width/2-o.width/2:i.left;var l=window.getScrollTop(),h=i.top-o.height-this.options.flipPadding;if(this.options.offsetTop&&(h-=this.options.offsetTop),this.options.scrollContainer&&(h-=this.options.scrollContainer.scrollTop),this.options.allowFlip&&!this.flipped&&h-l<0?(this.options.below=!0,this.flipped=!0,n.addClass("relBelow").removeClass("relAbove"),h=i.bottom,this.options.scrollContainer&&(h-=this.options.scrollContainer.scrollTop)):n.addClass("relAbove").removeClass("relBelow"),t-=this.options.offsetLeft,this.options.positionByOffsets)this._setPosition({position:this.options.positionType,top:this.options.offsetTop,right:this.options.offsetRight,bottom:this.options.offsetBottom,left:this.options.offsetLeft});else{var r=this.adjustEdge(t-s,o.width);if(this._setPosition({left:r,top:h+(this.options.yoffset||0)}),this.options.pointArrowToSource&&this.options.arrowWidth){var p=r<i.left?i.left-r:0,a=(i.width/2).toInt()-this.options.arrowWidth/2,f=p+a,d=o.width-this.options.arrowWidth-s-e;this.arrow.setStyles({right:"",left:Math.min(f,d)})}}},adjustEdge:function(t,i){var o=ta.id("PAGE").getCoordinates();if(t+i>=o.right){var s=this._styleValueToPixel(this.container.getStyle("margin-right"));t=o.right-i-s-1}else t<0&&(t=0);return t},hideNow:function(t){this.parent(t),this.flipped&&(this.flipped=!1,this.options.below=!this.options.below)}});
ta.overlays.RelativeOverlayBelow=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(e,a){this.parent(Object.merge({below:!0},e),a)}});
ta.overlays.RelativeOverlayAbove=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(e,a){this.parent(Object.merge({below:!1},e),a)}});
ta.overlays.RelativeOverlayIn=function(t){return new Class({Extends:t.overlays.RelativeOverlay,options:{xOffset:0,yOffset:0,center:!1},initialize:function(t,i){this.parent(t,i)},position:function(){if(this.options.center){var t=this.source.getCoordinates(),i=this.container.getCoordinates();this._setPosition({left:t.left+t.width/2-i.width/2+this.options.xOffset,top:t.top+t.height/2-i.height/2+this.options.yOffset})}else{var e=this.source.getPosition();this._setPosition({left:e.x+this.options.xOffset,top:e.y+this.options.yOffset})}this.parent()}})}(ta);
!function(){function e(e){if(!e)return null;if("a"==e.get("tag"))return e.href;var t=e.getElement("a");return t?t.href:(t=e.getElement(".overlaySrc"),t?t.get("text"):null)}function t(t,r,o,n){(r||window.event)&&new Event(r||window.event).preventDefault();var l,i=t.hyphenate().split("-"),s=i.indexOf("h")>=0,c=i.indexOf("lb")>=0,d=i.indexOf("remote")>=0,v=i.indexOf("click")>=0,u=Object.merge({showCloseButton:!0},n),m=null;switch(i.shift()){case"rel":m=a[i.shift().toLowerCase()],c&&(u.pinnable=ta.overlays.PINNABLE_ALWAYS);break;case"center":m=ta.overlays.CenteredOverlay}return null===m?null:(s?u.activate=ta.overlays.ACTIVATE_HOVER:v&&(u.activate=ta.overlays.ACTIVATE_CLICK),c&&(u.backdrop=ta.overlays.BACKDROP_ALWAYS),d&&(u.remoteContent=e(o)),l=new m(u,o),o&&(o.overlay=l),l)}var a={left:ta.overlays.RelativeOverlayLeft,right:ta.overlays.RelativeOverlayRight,above:ta.overlays.RelativeOverlayAbove,below:ta.overlays.RelativeOverlayBelow};ta.overlays.Factory={_magic:t,relRightRemoteHLB:function(t,a){a=ta.id(a),"div"!=a.get("tag")&&(a=a.getParent());var r=e(a);null!=r&&new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay rgba_flyout",showCloseButton:!0},a)},relRightRemoteHLB_Commerce:function(t,a){(t||window.event)&&new Event(t||window.event).preventDefault(),a=ta.id(a);var r=e(a);null!=r&&(a.onmouseover=null,new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:!0},a))},relBelowRemoteHLB_Commerce:function(t,a){a=ta.id(a),(t||window.event)&&new Event(t||window.event).preventDefault();var r=e(a);null!=r&&(a.onclick=null,new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:!0},a))},relBelowRemoteHLB_CommCopy:function(t,a){a=ta.id(a),(t||window.event)&&new Event(t||window.event).preventDefault();var r=e(a);null!=r&&(a.onclick=null,new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:!0,onLoad:function(){ta.meta&&ta.meta.update?ta.meta.update.updateCRForm("_pop"):ta.commerce.checkrates.updateCRForm("_pop")}},a))},relBelowRGBA:function(e,t){e&&e.stop();var a="rgba_flyout",r=!0,o="rgba_arrow";o+=" rgba_arrow_png24",t.onclick=null,new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,style:a,showArrow:r,arrowClass:o,showCloseButton:!0},t)},relBelow:function(e,t){e&&e.stop(),t.onclick=null,new ta.overlays.RelativeOverlayBelow({showCloseButton:!0,activate:ta.overlays.ACTIVATE_CLICK},t)},relAbove:function(e,t){e&&e.stop(),t.onclick=null,new ta.overlays.RelativeOverlayAbove({showCloseButton:!0,activate:ta.overlays.ACTIVATE_CLICK},t)},relRight:function(e,t){e&&e.stop(),t.onclick=null,new ta.overlays.RelativeOverlayRight({showCloseButton:!0,activate:ta.overlays.ACTIVATE_CLICK},t)},relLeft:function(e,t){e&&e.stop(),t.onclick=null,new ta.overlays.RelativeOverlayLeft({showCloseButton:!0,activate:ta.overlays.ACTIVATE_CLICK},t)},relBelowH_Media:function(e,t){e&&e.stop(),t.onmouseover=null,new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},t)},relAboveH_Media:function(e,t){e&&e.stop(),t.onmouseover=null,new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},t)},relAboveH:function(e,t){t.onmouseover=null,new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER},t)},relAboveTAMGFooter:function(e,t){t.onmouseover=null;var a=ta.id("PAGE");a&&new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"s3 vdg ovrFooter "+t.className},t)},relRightH:function(e,t){t.onmouseover=null,new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER},t)},relLeftH:function(e,t){t.onmouseover=null,new ta.overlays.RelativeOverlayLeft({activate:ta.overlays.ACTIVATE_HOVER},t)},imageLightbox:function(e,t){t.onclick=null;var a="<div><img src="+t.getAttribute("href")+"></div>",r=new ta.overlays.CenteredOverlay({showCloseButton:!0,backdrop:ta.overlays.BACKDROP_ALWAYS}).loadRemoteSuccess(a);t.addEvent("click",r.show)},microMetaOverlay:function(e,t,a,r,o,n,l,i){try{t.onmouseover=null,t.onclick=null,e&&e.stop();var s="";if(ta.meta&&ta.meta.update)s=ta.meta.update.buildUrl("MicroMetaAjax",a,!0,!1,"QC_Meta_Micro|Button");else{if("undefined"==typeof dd||!dd.commerce||!dd.commerce.checkrates)return void ta.util.error.record(null,"microMetaOverlay : no meta js");s=dd.commerce.checkrates.getMicroMetaUrl(e,a)}s+="&lowContentID="+r,l&&(s+="&xSellPlacement="+l);var c=t.className.match(/noDelayFirst/),d=t.className.match(/delayOpen/),v=ta.retrieve("delayedFirst"),u=!d||c&&!v,m="Above Fold Also Viewed";ta.id(t).getParent("#MMXS_LIST")?m="State Opt Also Viewed":ta.id(t).getParent("#HORIZONTAL_CROSS_SELL_LIST")?m="HorizXSell":ta.id(t).getParent("#hotel_flyout")?m="Scooter":ta.id(t).getParent("#HSCS_ROW")?m="prodp13n_hr_similar_xsell":window.mapDivId&&ta.id(t).getParent("#"+window.mapDivId)&&(m="Maps"),"Scooter"==m&&(s+="&from="+m);var y={activate:n?ta.overlays.ACTIVATE_CLICK:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:n?ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE:ta.overlays.PINNABLE_CLICK,backdrop:n?ta.overlays.BACKDROP_NEVER:ta.overlays.BACKDROP_PINNED,showCloseButton:!n,closeOnDocumentClick:n,positionByOffsets:!1,positionType:"absolute",offsetTop:0,offsetRight:"",offsetBottom:"",offsetLeft:155};Object.merge(y,i);var p=new ta.overlays.RelativeOverlayBelow({style:"micro_meta_flyout gray",activate:y.activate,pinnable:y.pinnable,backdrop:y.backdrop,autoShow:u,delayShow:d,showCloseButton:y.showCloseButton,closeOnDocumentClick:y.closeOnDocumentClick,closeButtonClass:"roundOuterClose",onShow:function(){ta.util&&ta.util.element&&ta.util.element.makeTextFitOneLine(".micro_meta_price_with_fee",!0),n?ta.trk("Meta_Micro_Providers_Displayed"):ta.trackEventOnPage("Meta_Micro_Providers_Displayed",m,o),ta.overlays.Factory.logTrackingTree(),y.onshow&&y.onshow()},onHide:y.onhide,positionByOffsets:y.positionByOffsets,positionType:y.positionType,offsetTop:y.offsetTop,offsetRight:y.offsetRight,offsetBottom:y.offsetBottom,offsetLeft:y.offsetLeft,trigger:t,oad()}},t);p.loadRemoteContent(s,!1),ta.store("delayedFirst",!0)}catch(e){ta.util.error.record(e,"micro meta overlay")}},microMetaExpandedSize:0,microMetaMore:function(ele")}try{var o=ta.id("micro_meta_remaining_"+t);if(!o)return;if(o.removeClass("hidden"),a)r();else if(ta.meta.linkTracking.actionRecord("MICRO_META_EXPAND_MORE"),o.getSize().y!=ta.overlays.Factory.microMetaExpandedSize&&(o.addClass("expanding"),ta.overlays.Factory.microMetaExpandedSize=o.getSize().y,o.removeClass("expanding")),o.addClass("show"),new Fx.Tween(o,{duration:"long",property:"height"}).start(0,ta.overlays.Factory.microMetaExpandedSize),window.setTimeout(r,1e3),ta.retrieve("ibdm_impression_tracking")){var n=document.getElement(".micro_meta_first_block");n&&ta.meta&&ta.meta.treeTrack&&ta.meta.treeTrack.hasTrackingTree(n)&&ta.trk("n_more_sites",!1,n)}}catch(e){ta.util.error.record(e,"Micro meta expand failed.")}},isOverlayCreatedAlready:function(e,t){if("undefined"!=typeof t){var a=e.getElement(".overlaySrc");return!a||(a.dispose(),!1)}return!1},relRightRemoteHLB_optionalDelay_showArrow:function(t,a,r,o){try{if(a=ta.id(a),!a)return;"div"!=a.get("tag")&&(a=a.getParent());var n=null;if("undefined"!=typeof r&&(n=r),null===n&&(n=e(a)),null===n&&ta.widgets.calendar.hasPageDates()&&(ta.widgets.calendar.clearCalendarFlyouts(),n=e(a)),null==n)return;var l=a.getElement(".overlaySrc"),i=n.match(/-d(\d+)\?/);if(i&&(i=i[1]),ta.has("meta.session_dates")||ta.widgets.calendar.hasPageDates())try{if(ta.retrieve("date.picker.calendarflyout.allCleared")||ta.widgets.calendar.clearCalendarFlyouts(),t&&"mouseover"===t.type)return void(a.hasClass("datedClickAdded")||(a.addEvent("click",ta.overlays.Factory.relRightRemoteHLB_optionalDelay_showArrow.bind(this,null,a,n)),a.addClass("datedClickAdded")));var s=ta.retrieve("scooterObj");return s&&s.slideOut(),void(i&&ta.overlays.Factory.metaCheckRatesOverlay_allProviders(i,a))}catch(e){ta.util.error.record(e,"meta session dates parse issue")}if(ta.overlays.Factory.isOverlayCreatedAlready(a,r))return;var c,d=a.className.match(/noDelayFirst/),v=a.className.match(/delayOpen/),u=ta.retrieve("delayedFirst"),m=!v||d&&!u,y="rgba_flyout",p=!0,h="rgba_arrow",g="close";ta.has("daodao_noPop_single_cr_button")&&(y+=" no_cpu"),"undefined"==typeof dhtml_cr_redesign_basic||this.crDHTML_BASIC||(this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic)),"undefined"==typeof dhtml_cr_redesign_png24||this.crDHTML_PNG24||(this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24)),this.crDHTML_PNG24&&(c=h+" rgba_arrow_png24_right",h+=" rgba_arrow_png24");var f=ta.overlays.BACKDROP_PINNED;ta.has("daodao_ror_backdrop_type")&&(f=ta.retrieve("daodao_ror_backdrop_type"));var C=v?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER;(ta.retrieve("daodao_show_cr_flyout_only_on_click")||window.FastClick)&&(C=ta.overlays.ACTIVATE_CLICK);var _={metaReferer:window.pageServlet},w=new ta.overlays.RelativeOverlayRight({activate:C,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:f,style:y,showArrow:p,arrowClass:h,arrowClassLeft:h,arrowClassRight:c,closeButtonClass:g,showCloseButton:!0,autoShow:m,delayShow:!m,smartCloseButton:ta.isMetaHotels2013(),remoteLink:r,requestData:_,onLoad:function(){if(i&&o){var e=this.inner.getElementById("CHECK_RATE_FLYOUT");if(e){var t=e.get("onclick");e.set("onclick",o+";"+t)}}ta.has("metaDatePickerEnabled")||(ta.meta&&ta.meta.update?ta.meta.update.updateCRForm("_pop"):ta.commerce.checkrates.updateCRForm("_pop"))},onShow:function(){if(ta.store("metaDateSearchOverlay",this),ta.has("metaDatePickerEnabled")?ta.widgets.calendar.syncAllDatePickers():ta.meta&&ta.meta.update?ta.meta.update.updateCRForm("_pop"):(ta.commerce.checkrates.updateCRForm("_pop"),ta.commerce.checkrates.checkCRLimitsHelper(w)),ta.retrieve("meta_guests_field_v2.enabled")){var e=document.querySelector(".adultsText");e&&ta.widgets.calendar.updateAdultsDisplay&&ta.widgets.calendar.updateAdultsDisplay(e)}ta.store("ta.hlb_el",a),ta.page&&ta.page.usingUnifiedDates&&(this.haveDatesHaow()}.bind(this),ta.page.on("dateSelected",this.haveDatesHandler))},onHide:function(){ta.retrieve("metaDateSearchOverlay")==this&&ta.remove("metaDateSearchOverlay"),ta.widgets.calendar.closeCalendarWidgets(),ta.retrieve("meta_guests_field_v2.enabled")&&ta.commerce.meta.disableAdultsPicker(this),ta.store("ta.hlb_el",null),this.haveDatesHandler&&ta.page&&ta.page.off("dateSelected",this.haveDatesHandler)}},a);w.metaLocId=i,ta.store("delayedFirst",!0),ta.widgets.calendar.trackCalendarFlyout(a,w,l)}catch(e){ta.util.error.record(e,"relRightRemoteHLB_optionalDelay_showArrow: Factory")}},relLeftRemoteHLB_optionalDelay_helper:function(t,a,r,o){try{a=ta.id(a),"div"!=a.get("tag")&&(a=a.getParent());var n=null;if("undefined"!=typeof o&&(n=o),null==n&&(n=e(a)),null==n&&ta.widgets.calendar.hasPageDates()&&(ta.widgets.calendar.clearCalendarFlyouts(),n=e(a)),null==n)return;var l=a.getElement(".overlaySrc"),i=n.match(/-d(\d+)\?/);if(i&&(i=i[1]),ta.has("meta.session_dates")||ta.widgets.calendar.hasPageDates())try{if(ta.retrieve("date.picker.calendarflyout.allCleared")||ta.widgets.calendar.clearCalendarFlyouts(),t&&"mouseover"==t.type)return void(a.hasClass("datedClickAdded")||(a.addEvent("click",ta.overlays.Factory.relLeftRemoteHLB_optionalDelay_helper.bind(this,null,a,r,n)),a.addClass("datedClickAdded")));var s=ta.retrieve("scooterObj");return s&&s.slideOut(),void(i&&ta.overlays.Factory.metaCheckRatesOverlay_allProviders(i,a))}catch(e){ta.util.error.record(e,"meta session dates parse issue")}if(ta.overlays.Factory.isOverlayCreatedAlready(a,o))return;var c=a.className.match(/noDelayFirst/),d=a.className.match(/delayOpen/),v=ta.retrieve("delayedFirst"),u=!d||c&&!v,m=ta.has("daodao_ror_backdrop_type")?ta.retrieve("daodao_ror_backdrop_type"):ta.overlays.BACKDROP_PINNED,y=d?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER;(ta.retrieve("daodao_show_cr_flyout_only_on_click")||window.FastClick)&&(y=ta.overlays.ACTIVATE_CLICK);var p=new ta.overlays.RelativeOverlayLeft({activate:y,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:m,style:"rgba_flyout gray",showArrow:r,arrowClass:"rgba_arrow_gray_rgt_png24",arrowClassLeft:"rgba_arrow_gray_lft_png24",showCloseButton:!0,closeButtonClass:"roundOuterClose",autoShow:u,delayShow:!u,smartCloseButton:ta.isMetaHotels2013(),remoteLink:o,onLoad:function(){ta.has("metaDatePickerEnabled")||(ta.meta&&ta.meta.update?ta.meta.update.updateCRForm("_pop"):ta.commerce.checkrates.updateCRForm("_pop"))},onShow:function(){if(ta.store("overlay.lastElmt.className",a.className),ta.has("metaDatePickerEnabled")?ta.widgets.calendar.syncAllDatePickers():ta.meta&&ta.meta.update?ta.meta.update.updateCRForm("_pop"):(ta.commerce.checkrates.updateCRForm("_pop"),ta.commerce.checkrates.checkCRLimitsHelper(p)),ta.retrieve("meta_guests_field_v2.enabled")){var e=document.querySelector(".adultsText");e&&ta.widgets.calendar.updateAdultsDisplay&&ta.widgets.calendar.updateAdultsDisplay(e)}},onHide:function(){ta.widgets.calendar.closeCalendarWidgets(),ta.retrieve("meta_guests_field_v2.enabled")&&ta.commerce.meta.disableAdultsPicker(this)}},a);ta.store("delayedFirst",!0),ta.widgets.calendar.trackCalendarFlyout(a,p,l)}catch(e){ta.util.error.record(e,"relLeftRemoteHLB_optionalDelay_showArrow: Factory")}},relLeftRemoteHLB_optionalDelay_showArrow:function(e,t,a){ta.overlays.Factory.relLeftRemoteHLB_optionalDelay_helper(e,t,!0,a)},fbFriendOverlay:function(e){e.onclick=null,new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:!0,style:"s2 mg"},e)},albumsLB:function(e,t,a,r,o,n,l,i,s,c,d){(e||window.event)&&new Event(e||window.event).preventDefault();var v=require("ta/media/viewerScaffold");return v?v.load({detail:a,geo:r,filter:o,ff:n,albumId:l,evtDelegates:c,lbShowRac:d}):ta.util.error.record(null,"Missing ta/media/viewerScaffold for albumViewerOverlay"),!1},photosLB:function(e,t){try{(e||window.event)&&new Event(e||window.event).preventDefault(),t=ta.id(t),"a"!=t.get("tag")&&(t=!t.hasClass("fkASDF")||"span"!=t.get("tag")&&"div"!=t.get("tag")&&"li"!=t.get("tag")?t.getParent("a"):ta.id(t));var a="";t.className?a=t.className.match(/u_([^ ]*)/)[1]:t.href.match(/\/?LocationPhoto.*/)&&(a=t.href),ta.overlays.Factory._mediaLBLoadAssets();var r="QC_Meta_Mini";if(ta.has("photo.viewer.jsAssetsLoaded")){a=a.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-"),a=a.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-"),a=a.replace(/\#/,"?ff="),(screen.availHeight<768||screen.availWidth<1024)&&(a+=a.match(/\?/)?"&small=true":"?small=true"),a=a+"&area="+r;var o=a;try{a=ta.commerce.meta.tracking.updateUrlWithTiming(a,r)}catch(e){ta.util.error.record(e,"problem updating url with timing in Factory.photosLB"),a=o}ta.meta&&ta.meta.update&&window.pageServlet&&(a=a+"&metaReferer="+window.pageServlet);var n=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.photoLBHelper,t);n.loadRemoteContent(a),ta.store("photo.viewer.lightbox",n),ta.commerce.meta.tracking.resetTimingLockForNavArea(r)}else ta.util.error.record(null,"photo gallery - no assets to load"),ta.overlays.Factory.viewerFallback.delay(2e3,this,[null,t])}catch(e){ta.util.error.record(e,"photo gallery overlay",null,{photoUrl:a}),ta.commerce.meta.tracking.resetTimingLockForNavArea(r)}return!1},viewerFallback:function(e){var t=ta.remove("photo.viewer.lightbox");return t&&t.hide(),e&&e.href&&e.href.match(/LocationPhotos/)?void(window.location=e.href):ta.servlet.Popup.photoGallery(null,e)},photoLBCounter:1,photoLBHelper:function(e){var t=ta.retrieve("photo.viewer.initData");if(ta.overlays.Factory.photoLBCounter>16){ta.overlays.Factory.photoLBCounter=1;try{ta.overlays.Factory.viewerFallback.delay(2e3,this,e)}catch(e){}}else t&&ta.photos.viewer?(ta.overlays.Factory.photoLBCounter=1,ta.retrieve("ta.photos.viewer.initializeOnSecondTab")?(ta.store("photo.viewer.secondaryView",!0),ta.photos.viewer.photoViewerInit(ta.retrieve("photo.viewer.secondaryViewer.data"))):ta.photos.viewer.photoViewerInit(t)):(ta.overlays.Factory.photoLBCounter++,ta.overlays.Factory.photoLBHelper.delay(500))},mediaLBAutoOpen:function(e){try{if(ta.overlays.Factory._mediaLBLoadAssets(),ta.has("photo.viewer.jsAssetsLoaded")){e=e.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-"),e=e.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-"),e=e.replace(/\#/,"?ff="),(screen.availHeight<768||screen.availWidth<1024)&&(e+=e.match(/\?/)?"&small=true":"?small=true");var t=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.mediaLBAutoOpenHelper,e);t.loadRemoteContent(e),ta.store("photo.viewer.lightbox",t)}else ta.util.error.record(null,"auto-open media lightbox - no assets to load")}catch(t){ta.util.error.record(t,"ta.overlays.factory.autoOpenMediaLB failed",null,{photoUrl:e})}return!1},mediaLBAutoOpenHelper:function(e){var t=ta.retrieve("photo.viewer.initData"),a=16;return ta.overlays.Factory.photoLBCounter>a?(ta.overlays.Factory.photoLBCounter=1,void ta.util.error.record(null,"ta.overlays.factory.autoOpenMediaLBHelper is giving up after "+a+" attempts.",null,{photoUrl:e})):void(t&&ta.photos.viewer?(ta.overlays.Factory.photoLBCounter=1,ta.photos.viewer.photoViewerInit(t)):(ta.overlays.Factory.photoLBCounter++,ta.overlays.Factory.mediaLBAutoOpenHelper.delay(500,this,e)))},_mediaLBLoadAssets:function(){ta.has("photo.viewer.jsAssetsLoaded")||"undefined"==typeof cssPhotoViewerAsset||"undefined"==typeof jsPhotoViewerAsset||(ta.store("photo.viewer.jsAssetsLoaded",!0),Asset.css(cssPhotoViewerAsset,{media:"screen, print"}),ta.photos.viewer||Asset.javascript(jsPhotoViewerAsset),"undefined"==typeof TALSO&&Asset.javascript(jsPhotoViewerTALSOAsset),"undefined"==typeof jsPhotosAsset||ta.servlet.Photos||Asset.javascript(jsPhotosAsset))},_mediaLBCreateOverlay:function(e,t){var a={backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg",zIndexParam:"10104","backdropClickClose":!0,"onLoad":function(){this.position(),e&&e(t)},"onHide":function(){var e=ta.remove("photo.viewer.lightbox");e&&e.hide(),ta.meta.linkTracking.restoreCRPageServlet(),document.removeEvent("keydown",ta.remove("photo.viewer.keydownListener")),ta.retrieve("photo.viewer.refreshOnClose")&&(window.location=window.location),ta.has("translationOverlay")&&ta.retrieve("translationOverlay").hide(),ta.widgets.calendar.closeCalendarWidgets()},permanent:!0};ta.retrieve("checkrates.meta_ui_post_click_prices")&&(a.onShow=function(){var e=ta.retrieve("meta.baseLocationId");e&&ta.commerce.meta.updateProvAreaFromLightBox(e)});var r=new ta.overlays.CenteredOverlay(a);return r},AccDetail:function(e,t,a){e&&e.stop(),t=t.getParent();var r=location.pathname;if(r.length>0){"/"==r.charAt(0)&&(r=r.substring(1));var o=r.indexOf("-");o>=0&&(r=r.substring(0,o))}var n=a,l=function(){var e=ta.id("overlay_description").get("text");e.length>1e3&&ta.id("overlay_description").setStyle("height",210)};return memoverlayCSS&&!ta.retrieve("ta.memoverlayCSS")&&ta.store("ta.memoverlayCSS",new Asset.css(memoverlayCSS)),new ta.overlays.CoverOverlay({yOff:35,onLoad:l,style:"s3 dg rgba_gry",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showCloseButton:!0,delayShow:!0,requestData:{d:n,tab:"descript",from:r},remoteContent:"/LocationTab"},t),!1},memberOverlay:function(e,t,a){e&&e.stop(),t.onclick=null,t.onmouseover=null;var r="",o="",n="",l=!1,i=!1,s=!0,c="rgba_arrow_png24";if(t.id&&""!=t.id)for(var d=t.id.split("-"),v=0;v<d.length;v++){var u=d[v];u.match(/\bUID_([0-9A-F]+)\b/)?r=RegExp.$1:u.match(/\bSRC_(\d+)\b/)?o=RegExp.$1:u.match(/\bCATID_(\d+)\b/)?n=RegExp.$1:u.match("FUS")?l=!0:u.match("PATT")&&(i=!0)}else require.defined("ta/util/xpath")&&ta.util.error.record(null,"memberOverlay - elmt.id check",null,{"passedElement":require("ta/util/xpath").nodePath(t)});var m="";return"undefined"!=typeof footprintGet&&(m=footprintGet()),memoverlayCSS&&!ta.retrieve("ta.memoverlayCSS")&&ta.store("ta.memoverlayCSS",new Asset.css(memoverlayCSS)),new ta.overlays.RelativeOverlayRight({style:a||"typeO",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:s,arrowClass:c,showCloseButton:!0,autoShow:!1,delayShow:!0,remoteContent:"/MemberOverlay?uid="+r+"&c="+n+"&src="+o+"&fus="+l+"&partner="+i+"&LsoId="+m},t),!1},memberOverlayBelow:function(e,t,a,r,o){e&&e.stop(),t.onclick=null,t.onmouseover=null;var n="",l="",i="",s=!1,c=!1,d=!0,v="rgba_arrow_up_png24";if(t.id&&""!=t.id)for(var u=t.id.split("-"),m=0;m<u.length;m++){var y=u[m];y.match(/\bUID_([0-9A-F]+)\b/)?n=RegExp.$1:y.match(/\bSRC_(\d+)\b/)?l=RegExp.$1:y.match(/\bCATID_(\d+)\b/)?i=RegExp.$1:y.match("FUS")?s=!0:y.match("PATT")&&(c=!0)}else require.defined("ta/util/xpath")&&ta.util.error.record(null,"memberOverlay - elmt.id check",null,{"passedElement":require("ta/util/xpath").nodePath(t)});var p="";return"undefined"!=typeof footprintGet&&(p=footprintGet()),memoverlayCSS&&!ta.retrieve("ta.memoverlayCSS")&&ta.store("ta.memoverlayCSS",new Asset.css(memoverlayCSS)),new ta.overlays.RelativeOverlayBelow({style:a||"typeO",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:d,arrowClass:v,allowFlip:!1,showCloseButton:!0,autoShow:!1,delayShow:!0,offsetRight:o,offsetTop:r,remoteContent:"/MemberOverlay?uid="+n+"&c="+i+"&src="+l+"&fus="+s+"&partner="+c+"&LsoId="+p},t),!1},dropdownMiniMetaOverlayHotel:function(e,t,a,r){var o="hotel_"+r,n=ta.id(o);if(n){var l=n.getElement(".chevron");l&&(t=l);var i=n.getElement(".dropdownMiniMeta");if(i){i=i.clone(),i.set("class","dropdownMiniMeta");var s={offsetLeft:260,trigger:t};ta.util.i18n.isRtl()&&(s={offsetLeft:4}),ta.store("meta.dropdownHotelsActive",o),ta.overlays.Factory.dropdownMiniMetaOverlay(e,t,a,i,s)}}},dropdownMiniMetaOverlayHotelReview:function(e,t,a,r){var o=document.getElement(".skv3 .dropdownMiniMeta");if(o||(o=document.getElement(".dropdownMiniMeta")),!o){ta.trackEventOnPage("LP_Chevron_Dropdown_No_Data","0");var n=document.getElement(".LowestPrice.minOffer");if(n)return n.click(),!1}o=o.clone(),o.set("class","dropdownMiniMeta"),r||(r=22);var l={offsetLeft:r};ta.overlays.Factory.dropdownMiniMetaOverlay(e,t,a,o,l)},dropdownMiniMetaOverlay:function(e,t,a,r,o){return dropdownMetaCSS&&!ta.retrieve("ta.dropdownMetaCSS")&&ta.store("ta.dropdownMetaCSS",new Asset.css(dropdownMetaCSS)),e&&e.stop(),!!r&&(ta.overlays.Factory.createDropdownMiniMetaOverlay(e,t,a,r,o),ta.store("pcr.disabled",!0),!0)},loadDropdownCSS:function(){window.dropdownMetaCSS&&!ta.retrieve("ta.dropdownMetaCSS")&&ta.store("ta.dropdownMetaCSS",new Asset.css(dropdownMetaCSS))},createDropdownMiniMetaOverlay:function(e,t,a,r,o){var n="rgba_flyout gray dropdownMiniMeta",l=!0,i=-5,s=function(e){return e=ta.id(e),e.getParent(".persistentCR")?"PCR":e.getParent(".photosOverlay")||e.getParent("#LOC_PHOTO_ALBUMS")?"Photo_Lightbox":e.getParent(".amenities_lightbox")?"Amenities_Lightbox":e.getParent("#CHECK_RATES_LB")?"Photo_LB":void 0};switch(s(t)){case"PCR":l=!1,n+=" pcrLightBox",i=-45;break;case"Photo_Lightbox":l=!1,n+=" photoAmenitiesLightBox";break;case"Amenities_Lightbox":l=!1;break;default:n+=" miniMetaLightBox"}var c=0;o&&(o.offsetLeft&&(c=o.offsetLeft),o.offsetTop&&(i=o.offsetTop)),new ta.overlays.RelativeOverlayBelow(Object.merge(o,{style:n,activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:l,showCloseButton:a,closeButtonClass:"roundOuterClose",arrowClass:"rgba_gray_arrow_up",offsetTop:i,offsetLeft:c,allowFlip:!1,closeOnDocumentClick:!0,content:r}),t)},createFacebookCTACallout:function(e,t,a,r,o,n){try{t.removePropertyEvent("mouseover","ta.overlays.Factory.createFacebookCTACallout")}catch(e){t.onmouseover=function(){}}var l=Browser.ie7||Browser.ie8?" ie78":"",i={activate:ta.overlays.ACTIVATE_HOVER_DELAY,style:"s4 dg rgba_gry update2012 facebookCTAFlyout"+l,showArrow:!0,centered:!0,pointArrowToSource:!0,showCloseButton:!1,delayShow:!0,innerDivClass:"inner",hoverDelayTime:0,noPadding:!0,content:"<div class='onsite_cta_overlay_content'><b>"+a+"</b><br />"+o+"<br /><br /><b>"+r+"</b><br />"+n+"</div>"};new ta.overlays.RelativeOverlayBelow(i,t)},tcNavDetailOverlay:function(e,t,a){return e&&e.stop(),new ta.overlays.RelativeOverlayBelow({style:a||"typeO",activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:!0,arrowClass:"rgba_arrow_png24",showCloseButton:!0,content:ta.id("INLINE_NAV_DETAIL").innerHTML},t),!1},amexSettingsOverlay:function(e,t,a,r,o,n,l){e&&e.stop();var i;return ta.has(o)?(i=ta.retrieve(o),i.inner.setContent(ta.id(r).innerHTML),i.show()):(i=new ta.overlays.RelativeOverlayBelow({style:a,activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:!0,arrowClass:"rgba_arrow_png24",showCloseButton:!1,content:ta.id(r).innerHTML,offsetLeft:n,offsetTop:l,allowFlip:!1},t),ta.store(o,i)),!1},menuBLimps:function(e,t){var a=$(e);if(a&&!a.getAttribute("blimped")){var r=a.getChildren();if(r){for(var o=0;o<r.length;o++){var n=r[o].getAttribute("data-imp");n&&ta.t4b.bl_imp_tracking.queueImpression(n,t)}ta.t4b.bl_imp_tracking.flushImpressions(),a.setAttribute("blimped",!0)}}},mcNavOverlay:function(e,t,a,r,o,n,l,i,s){var c;return e&&e.stop(),ta.has(o)?(c=ta.retrieve(o),c.inner.setContent(ta.id(r).innerHTML),c.show()):ta.util.i18n.isRtl()^i?(c=new ta.overlays.RelativeOverlayRight({style:a,activate:ta.overlays.ACTIVATE_BOTH,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:!0,arrowClass:"rgba_arrow_png24",showCloseButton:!1,hoverDelayTime:250,content:ta.id(r).innerHTML,offsetRight:n,offsetTop:l,allowFlip:!1,showFunction:function(){ta.overlays.Factory.menuBLimps(r,s)}},t),ta.store(o,c)):(c=new ta.overlays.RelativeOverlayLeft({style:a,activate:ta.overlays.ACTIVATE_BOTH,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:!0,arrowClass:"rgba_arrow_png24",showCloseButton:!1,hoverDelayTime:250,content:ta.id(r).innerHTML,offsetLeft:-n,offsetTop:l,allowFlip:!1,showFunr,s)}},t),ta.store(o,c)),!1},createPairedCalt,a)},createPairedCalendarGeo:function(){},_injrn e},createDatedPairedCalendar:function(e,t,a){a||(a={}),e&&new Event(e).preventDefault(),t=ta.id(t);var r=t.getParent("form");a.validate=!0,a.overlayOptions={onShow:function(){ta.overlays.toggleOffSearchAll(r)}},new ta.overlays.PairedCalendar(t,a),ta.overlays.toggleOffSearchAll(r)},recordVRCrossSell:function(){try{var e=ta.id("VR_CROSS_SELL");if(e){var t=e.innerHTML.indexOf("setPID"),a=e.innerHTML.substr(t+7,5);new Request({url:"/ActionRecord?action=VR_CROSS_SELL_"+a}).send()}}catch(e){ta.util.error.record(e,"VR Cross Sell - ActionRecord failed")}},loadGeoCrAutoBroadenOverlay:function(e,t){var a=ta.retrieve("gcrab.cssPath");a&&!ta.retrieve("gcrab.css")&&ta.store("gcrab.css",Asset.css(a));var r=new ta.overlays.CenteredOverlay({permanent:!0,style:"gcrabLb",noPadding:!0,absoluteOffset:!0,yOffset:Math.max(20,window.getHeight()-540)/2+window.getScrollTop(),xOffset:Math.max(5,window.getWidth()-965)/2,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",content:'<div style="background-color:#EEE;"><img style="padding:150px;display:block;width:79px;margin:auto;" src="'+ta.util.imageServer("/img2/meta_sprites/loadingAnim.gif")+'"></div>',onClose:function(){ta.trackEventOnPage("MetaGeoLightBox","unload","CloseButton",0,!1)}},e);ta.commerce.meta.loadGeoCrAutoBroadenContents(r,t)},currencyPickerPopup:function(e,t,a){e&&e.stop(),t.onclick=null;var r="/StaticVelocityPage?t=currency_picker.vm";return new Asset.css(globalCurrencyPickerCSS),"true"==ta.retrieve("currency_format_using_icu4j_cldr.featureEnabled")?new ta.overlays.RelativeOverlayBelow({showCloseButton:!1,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:r,style:"global_currency_picker_overlay currency_format_using_icu4j_cldr dropMenu",onShow:function(){ta.fireEvent("mastheadFlyoutOpened")}},t):new ta.overlays.RelativeOverlayBelow({showCloseButton:!1,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:r,style:"global_currency_picker_overlay dropMenu",onShow:function(){ta.fireEvent("mastheadFlyoutOpened")}},t),ta.trackEventOnPage("CurrencyPicker","Open",a),!1},intlPopup:function(e,t){e&&e.stop(),t.onclick=null,flagsUrl=document.location.pathname;var a="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+footerFlagFormat+"&flagsURL="+encodeURIComponent(flagsUrl);if(""!=document.location.search&&(a+=encodeURIComponent(document.location.search)),""!=document.location.hash&&(a+=encodeURIComponent(document.location.hash)),window.modelGeoId&&(a+="&geo="+modelGeoId),window.flagsSettings)for(var r=0;r<flagsSettings.length;r++)a+="&"+flagsSettings[r]+"=true";return a+="&useHreflangs="+("ShowTopic"===ta.util.URL.getServletNameFromUrl(window.location.pathname)),window.pageFeature&&(a+="&pageFeature="+pageFeature),new Asset.css(flagsFlyoutCSS,{async:!0,onLoad:function(){var e="dropMenu",r=ta.overlays.ACTIVATE_CLICK;new Request({url:a,onSuccess:function(a){var o=new Element("div",{html:a});ta.overlays.Factory.fixFlagsFlyout(o),new ta.overlays.RelativeOverlayBelow({showCloseButton:!0,activate:r,content:o,style:e,onShow:function(){ta.fireEvent("mastheadFlyoutOpened")}},t)}}).send()}}),!1},fixFlagsFlyout:function(e){if(ta.retrieve("flag_links.useHrefLangs")){var t=e.getElements("a.flag_link");t.forEach(function(e){var t=document.getElement("link[hreflang="+e.get("hreflang")+"]");if(null!=t){var a=t.get("href");"string"==typeof a?e.href=a:e.parentNode.style.display="none"}else e.parentNode.style.display="none"});var a=e.getElements("li.region");a.forEach(function(e){var t=e.getElements("li.flag_item"),a=e.style.display;e.style.display="none",t.forEach(function(t){"none"!=t.style.display&&(e.style.display=a)})})}},showRecentLocationEmailOverlay:function(){setPID(3833),"undefined"==typeof recentViewedCSS||ta.retrieve("ta.recentViewedCssAsset")||ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS)),new Request({url:"/RecentlyViewedAjax",onSuccess:function(e){e.match("emptyRecentlyViewed")||ta.overlays.showInLightbox(e,{style:"dg s4 RecentlyViewedOverlay"})},data:{"a":"share_overlay"},evalScripts:!0,method:"get"}).send()},expandRecentlyViewed:function(){for(var e=4;e<7;e++){var t=ta.id("recently_viewed_"+e);t&&t.hasClass("hidden")&&t.removeClass("hidden")}var a=ta.id("RECENTLY_VIEWED_MORE");a&&a.addClass("hidden")},showSendMessage:function(e,t){var a;if(e&&e.preventDefault(),t&&(t=ta.id(t)),t){if(ta.has("overlays.sendmessage.loading"))return;ta.store("overlays.sendmessage.loading",!0),ta.remove.delay(500,null,"overlays.sendmessage.loading"),"undefined"==typeof privateMsgCSS||ta.retrieve("ta.privateMsgCssAsset")||ta.store("ta.privateMsgCssAsset",Asset.css(privateMsgCSS));var r;if(r="span"==t.get("tag")&&t.hasClass("fkASDF")?t.className.match(/u_([^ ]*)/)[1]:t.href){var o=ta.retrieve("overlays.sendmessage");if(o&&r.match(/notyou=1/))window.location="/NewsletterSignOut-e__2F__MemberSignIn";else if(o)return;var n=1==parseInt(a,10)?"cc":"cm",l="cm"==n&&"undefined"!=typeof footprintGet?footprintGet():null;l&&(r+="&LsoId="+l),a=t.get("id"),require(["trjs!ta/registration/AuthCheck"],function(e){var o={username:!0};if(!e.isAuthorized(o)){var n={flow:"CONTENT_SUBMISSION",pid:473,userRequestedForce:!0,onSuccess:function(){a&&ta.overlays.Factory.showSendMessage(null,a)}};return ta.call("ta.registration.RegOverlay.show",{type:"dummy"},t,n),
!1}ta.common.sendmessage.communityLightbox(r)})}}},showConnectOverlay:function(e,t,a,r,o){ta.overlays.registration.connect(a,r,o)},showAirlineTipsOverlay:function(e,t,a){try{var r="/AirlineTips?d="+modelLocId;a&&(r=r+"&filterLang="+a);var o=!1,n=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_NEVER,style:"s3 dg nopadding",permanent:!0,zIndex:"9997",showCloseButton:!0,remoteContent:r,onLoad:function(){if(n.inner){var e=ta.id("emptyTips");e&&(o=!0)}else o=!0;o&&n.hide()}},t)}catch(e){ta.util.error.record(e,"showTipsOverlay")}},reviewTranslate:function(e,t,a){if(ta.servlet&&ta.servlet.Reviews)ta.servlet.Reviews.openTranslation(t,a);else{ta.util.error.record(null,"reviewTranslate: Deprecated factory method"),ta.util.cookie.setPIDCookie(16009),ta.overlays.Factory._loadSummaryCss();var r=ta.has("photo.viewer.lightbox"),o=1001;r&&(o=10001);var n=new ta.overlays.CenteredOverlay({style:"dg cb_overlay withClose ui_modal flat_bottom",zIndex:o,noPadding:!0,backdropClickClose:!0,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"ui_close_x",centered:!0,showCloseButton:!0,remoteContent:a,onLoad:function(){this.show()}});ta.store("translationOverlay",n)}},createFriendActivityLightbox:function(e){return new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 mg friendActivity",content:e})},postVideoLogin:function(e,t,a){a&&ta.util.cookie.setPIDCookie(a),ta.overlays.registration.connect({flow:"POST_VIDEO"},"SIGNIN")},fbLogin:function(){ta.support.Facebook.login()},iapFa)})},iapOwnerFlyout:function(e,t,a){require(["pages/inappropriate_vote_stub"],function(r){a.owner=!0,r.open(e,t,a)})},openSavesRegflow:function(){ta.widgets.Saves.openSavesRegflow()},openSavesHoverRegflow:function(){ta.widgets.Saves.openSavesHoverRegflow()},openMastheadRegflow:function(){ta.widgets.Saves.openMastheadRegflow()},createGuideOverlay:function(){ta.overlays.registration.connect({flow:"DESTINATION_GUIDE"},"SIGNUP")},createPostPhotosOvUP")},popConditionsOverlay:function(){var e=ta.id("CONDITIONS");e&&ta.overlays.showInLightbox(e.innerHTML)},cancelCreateWARList:function(e){e.stopPropagation();var t=ta.retrieve("war.todolist.showOverlay");t&&(window.clearTimeout(t),ta.store("war.todolist.showOverlay",!1))},createHACProgressOverlay:function(){try{if(ta.has("ta.hac.progress.overlay"))return ta.retrieve("ta.hac.progress.overlay");var e=ta.id("HAC_PROGRESS_CONTAINER").dispose(),t=e.get("html"),a=new ta.overlays.CenteredOverlay({style:"s3 dg rgba_gry",showCloseButton:!1,permanent:!0,content:t});return ta.store("ta.hac.progress.overlay",a),a}catch(e){ta.util.error.record(e,"createHACProgressOverlay")}},getFilterWaitOverlay:function(){var e=ta.retrieve("filters.waitDialog");if(!e){var t="mg s1 fatNotice";ta.isHotelsRedesign2011()&&(t+=" fatNotice_2011"),e=new ta.overlays.CenteredOverlay({style:t,showCloseButton:!1,autoShow:!1,delayedPosition:!0}),e.inner.set("html","<b>"+JS_UpdatingYourResults+"</b>"),ta.store("filters.waitDialog",e)}return e},showFilterWaitOverlay:function(e){var t=ta.overlays.Factory.getFilterWaitOverlay();t&&(e?(t.show(),t.position(!1)):t.hide())},showUpdatingMessage:function(){var e=ta.overlays.Factory.getFilterWaitOverlay();if(e.show(),ta.remove("filter.map")){e.container.setStyles({left:-9999,top:-9999});var t=ta.id(ta.retrieve("maps.container")).getCoordinates(),a=e.container.getCoordinates();e.container.setStyles({left:t.left+(t.width-a.width)/2,top:t.top+(t.height-a.height)/2})}ta.remove("filter.lockout")&&e.enableBackdrop()},createIpDeauthOverlay:function(e,t){new Request({url:"/ActionRecordPlus?action=DEAUTH_IP&id="+e,onSuccess:function(e){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:!1}).loadRemoteSuccess(e),t&&ta.support.Facebook.ipRevoke(1e4)},onFailure:ta.util.error.ajaxFailure.partial("partials:ip_disable")}).send()},createHotelStyleCategoryDescriptionOverlayAbove:function(e,t,a){var r=ta.id(a);t.onmouseover=null,r&&new ta.overlays.RelativeOverlayRight({showCloseButton:!1,activate:ta.overlays.ACTIVATE_HOVER,style:"ryokanOverlay",showArrow:!0,pointArrowToSource:!0,allowRightArrowPos:!0,arrowHeight:29,arrowClass:"ryokanArrow",fontSize:".7em",offsetRight:-14,offsetTop:-10,waitForCss:!0,content:new Element("div",{style:"width:300px; padding:12px;",html:r.getChildren()[0].get("html")})},t)},loadBLSlideshowOverlay:function(e,t,a,r){window.t4bSlideshowCSS&&!ta.retrieve("ta.t4bSlideshowCSS")&&ta.store("ta.t4bSlideshowCSS",new Asset.css(t4bSlideshowCSS)),new Request({url:"/BusinessListingsAjax",onSuccess:function(e){ta.overlays.showInLightbox(e,{backdrop:ta.overlays.BACKDROP_ALWAYS,style:"g s10px np"})},data:{"act":"slideshow","detail":a,"pid":r,"servletName":pageServlet,"flash":Browser.Plugins.Flash.version>=10},evalScripts:!0,method:"get"}).send()},createFriendOfFriendOverlay:function(e,t){e.onclick=null,t&&new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_CLICK,style:"s2 mg",showCloseButton:!0,content:t},e),null!=lazyImgs&&require("lib/LazyLoad").init({},lazyImgs,window.lazyHtml)},CLOSE_BTN_RIGHT_OFFSET:15,ratingsFlyout:function(e,t,a,r){e&&e.stop();try{var o=t.get("class").match("rating(\\d)")[1],n=ta.id("ratingsFlyout"+o).get("html"),l=null,i="";a&&(l=ta.servlet.Reviews.ratingFlyoutScroll);var s="ratingOverlay dg s3 rgba_gry";r&&(i=" fixedHeight",s+=" overlayWithScroll"),new ta.overlays.RelativeOverlayAbove({showCloseButton:!0,activate:ta.overlays.ACTIVATE_CLICK,content:n,innerDivClass:"ratingFlyout inner"+i,style:s,onscroll:l},t),new Request({url:"/ActionRecord?action=ratingsFlyout&pid=4304"}).send()}catch(e){ta.util.error.record(e,"showRatingsFlyout")}},getWhiteFlyout:function(e,t,a,r,o){if(e&&e.stop(),t&&a){var n="whiteFlyOut",l=!0,i="flyout_white_arrow",s="flyout_icon_close";new ta.overlays.RelativeOverlayRight({style:n,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:l,arrowClass:i,pointArrowToSource:!0,showCloseButton:!0,closeButtonClass:s,content:a,offsetRight:r,offsetLeft:-r,onRight:!ta.util.i18n.isRtl(),offsetTop:o},t)}},firstToReviewFlyout:function(e,t,a){try{var r=ta.id("locationId"+a),o=r.getElement(".firstToReviewFlyout").innerHTML,n=r.getElement(".propName");ta.overlays.Factory.getWhiteFlyout(e,n,o,-12,-20)}catch(e){ta.util.error.record(e,"ta.overlays.factory.firstToReviewFlyout")}},openTourismDescrin(e)},memberPassportStampOverlay:function(e,t,a){ta.has("passportStampsCSS")||ta.store("passportStampsCSS",new Asset.css(passportStampsCSS)),a.geos=a.geos.join(","),new ta.overlays.RelativeOverlayRight({style:"s3 dg rgba_gry memberPassportStamps",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:!0,oow()},remoteContent:"/MemberPassportStamps",requestData:a},t),ta.trackEventOnPage("Reviews","reviews_in_cities"),new Request({url:"/ActionRecord?action="+a.actionRecord}).send()},relRightLocalContent:function(e,t,a){t.onmouseover=null,new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 og",content:ta.id(a).innerHTML},t)},loadMetaHotelsFa,r)},updateMetaHotelsFiltersFromBreadcrumbs:function(e,t,a,r){ta.hac.filters.updateMetaHotelsFiltersFromBreadcrumbs(a,r)},closeAllActiveFilters:function(){ta.hac.filters.closeAllActiveFilters()},hideFilterOverlay:function(e,t,a){var r=ta.retrieve("ta.filters.overlaySet");if(r&&r[a]){var o=r[a];o.visible&&o.hide()}},simulateDatePickerClick:function(e,t,a,r,o,n){return ta.overlays.Factory.loadDatePicker(e,t,a,r,o,n),e.stopPropagation(),e.preventDefault(),!1},loadVRDatePicker:function(e,t,a,r,o,n){n||(n={});var l=Object.merge({calendarOptions:{isVR:!0}},n);ta.overlays.Factory.loadDatePicker(e,t,a,r,o,l)},loadDatePicker:function(e,t,a,r,o,n){if(n||(n={}),ta.widgets.calendar.isShim){if(!t)return;t=ta.id(t);var l=t.getAttribute("data-dateType");return l||(t.hasClass("out_date")?(l="CHECKOUT",t.setAttribute("data-dateType",l)):(l="CHECKIN",t.setAttribute("data-dateType",l),ta.find(".out_date",t.parentNode.parentNode).setAttribute("data-dateType","CHECKOUT"))),void ta.page.gatherDates(t)}if(new Asset.image(CDNHOST+"/img2/generic/site/loading_anim_gry_sml.gif"),ta.has("isHotelsLander")||ta.isMetaHomepageIntegration2013()||ta.has("widget.customHotel")||ta.has("isDaoDaoHomePageUnforkCalendar")?((ta.has("isHotelsLander")||1==a||ta.has("isDaoDaoHomePageUnforkCalendar"))&&(n=Object.merge({calendarOptions:{selectionStartClass:"start",selectionEndClass:"end",postContent:function(){var e=Elements.from('<div id="SKIP_DATES"><span class="skip_dates_text"><span class="taLnk">'+ta.retrieve("multiDP.skipDates")+"</span></span></div>")[0];return e.getElement(".taLnk").addEvent("click",function(){var e=ta.overlays.getCurrent(),t=e&&e.calendar;t&&t.clear();var a=ta.id("SUBMIT_HOTELS");a&&a.focus(),ta.widgets.calendar.clearSessionDateses()}),ta.has("isHotelsLander")?ta.overlays.Factory.trackSkipDatesEvent("Hotels_Lander","Calendar","Skip dates",0):ta.overlays.Factory.trackSkipDatesEvent("Meta_Homepage","Calendar","Skip dates",0)}),e},onSelect:function(e){if(!e.oneSelected){var t=ta.id("SUBMIT_HOTELS");t&&t.focus()}}}},n)),1==a&&ta.has("widget.customHotel")&&(n.calendarOptions=n.calendarOptions||{},n.calendarOptions.wrapper=Elements.from('<div class="calendar_wrapper"><div class="wrapper_header">'+ta.retrieve("multiDP.header")+'</div><div class="wrapper_inner"></div><div class="wrapper_footer">'+ta.retrieve("multiDP.footer")+"</div>")[0]),1!=a&&"vr"!=a||(n.calendarOptions=n.calendarOptions||{},n.calendarOptions.submitOnEnter=ta.retrieve("widget.customHotel")?ta.widget.CustomHotelsWidget.validate:ta.pages.home.validate)):n=Object.merge({calendarOptions:{selectionStartClass:"start",selectionEndClass:"end"}},n),t=ta.id(t),ta.has("guests_rooms_picker_3.enabled")&&!ta.has("guests_rooms_picker_4.enabled")&&!ta.has("hotels_rgpicker_outofcalendar")&&!ta.has("hotels_left_filters_redesign")&&t&&!t.getParent(".geoChkRates")&&(t.getParent(".jfy_header_dates_holder")||t.getParent(".filterControls")||t.getParent(".meta_chevron_module_2014")||t.getParent("#HotelDateSearch")||t.getParent(".HotelHighlight")))try{ta.meta.update.clearDatesBumpedMessage(),n.calendarOptions=n.calendarOptions||{};var i,s,c;ta.has("guests_rooms_picker_3.enabled")&&(s=ta.id(document.getElement(".guestsRoomsDatePickerHeaderForInject.hidden")),i=s?new Element("div").adopt(s.clone()).get("html"):""),s=ta.id(document.getElement(".showPricesForInject.hidden")),c=s?new Element("div").adopt(s.clone()).get("html"):"",n.calendarOptions.wrapper=Elements.from('<div class="calendar_wrapper"><div class="wrapper_header">'+i+'</div><div class="wrapper_inner"></div><div class="wrapper_footer">'+c+"</div>")[0],n.calendarOptions.isGuestsRoomsCalendar=!0}catch(e){ta.util.error.record(e,"error building content for guests rooms datepicker wrapper")}if(n.calendarOptions||(n.calendarOptions={}),ta.has("calendar.default.postcontent")&&!n.calendarOptions.postContent&&(n.calendarOptions.postContent=ta.retrieve("calendar.default.postcontent")),n.calendarOptions.isholidayEnable&&(n.calendarOptions.holidaysOnCalendar=ta.retrieve("calendar.holidays")),n.calendarOptions.classicStyling=!0,n.calendarOptions.flights=n.flights,n.calendarOptions.oneWayFlight=n.oneWayFlight,n.calendarOptions.multiCityFlight=n.multiCityFlight,(n.oneWayFlight||n.multiCityFlight)&&(n.calendarOptions.onSelect="ta.overlays.calendar.select",n.calendarOptions.oneWayStyling=!0),n.flights){var d=new Date;d.setDate(d.getDate()+ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT),n.calendarOptions.lastDate=d}if(ta.fireEvent("onCalendarSelect",t),n.calendarOptions.onChangeDates=ta.widgets.calendar.onCalendarChangeDates,n.calendarOptions.onRangeSelect=ta.widgets.calendar.onCalendarRangeSelect,"vr"==a){var v=new Date;v.setMonth(v.getMonth()+18),v.setDate(1),n.calendarOptions.lastDate=v}if(ta.overlays.Factory.destroyAnimatedDateCTA(),ta.overlays.Factory._loadAvailDateWidget(e,a,"calendar",r,o,n),ta.retrieve("load_date_picker_buttons"))return!1},destroyAnimatedDateCTA:function(){if(ta.isMetaHotels2013()||ta.retrieve("hh_short_cell.enabled")&&ta.widgets.calendar.hasPageDates()){var e;e=ta.retrieve("animate_date_reformat")?ta.id("ANIMATED_DATE_CTA_REFORMAT"):ta.id("ANIMATED_DATE_CTA"),e&&ta.servlet.HACSearch.destroyAnimatedDateCTA()}},trackSkipDatesEvent:function(e,t,a,r){try{ta.trackEventOnPage(e,t,a,r,!1)}catch(e){}},loadAdultsField:function(e,t,a,r,o,n){n||(n={}),n.calendarOptions||(n.calendarOptions={}),ta.overlays.Factory._loadAvailDateWidget(e,a,"adults",r,o,n)},_loadAvailDateWidget:function(e,t,a,r,o,n){var l,i,s="in";if(e&&(e=new Event(e)),e&&e.target&&ta.id(e.target).hasClass&&(ta.id(e.target).hasClass("out_date")||ta.has("guests_rooms_picker_3.enabled")&&ta.id(e.target).hasClass("outDateTrigger"))&&(s="out"),n.calendarOptions.pickerOption=s,i=ta.widgets.calendar.getCalendarObjectKey(t,r,s),l=ta.retrieve(i),l&&l.calendar.positionElement&&ta.id(l.calendar.positionElement).getParent("#PAGE"))l.show(a);else try{l=new ta.commerce.AvailDataWidget(e,t,a,r,o,n)}catch(e){ta.util.error.record(e,"load availDateWidget init error")}},onClickMetaCheckRatesOverlay_allProviders:function(e,t,a,r){ta.overlays.Factory.metaCheckRatesOverlay_allProviders(a,r)},metaCheckRatesOverlay_allProviders:function(e,t){if(ta.page&&ta.page.usingUnifiedDates){var a;try{a=require("xsell/metaLightbox")}catch(e){}if(a){var r={};return void a.showMetaLightbox(e,"",r)}}if(ta.overlays.Factory._recordLBOpen(),ta.commerce.meta.clearStoredMiniData(),ta.retrieve("assisted_booking_desktop_entry.logTreePoll")&&t&&ta.id(t).getParents){var o=ta.id(t).getParents();o.each(function(e){e.hasClass("premium_offers_area")?ta.meta&&ta.meta.treeTrack&&ta.meta.treeTrack.hasTrackingTree(e)&&ta.trk("n_more_sites",!1,e):(e.hasClass("metaPriceInfo")||e.hasClass("illisting")&&ta.retrieve("servlet.smartdeals"))&&ta.meta&&ta.meta.treeTrack&&(ta.meta.treeTrack.logTreeImpression(),ta.trk("n_more_sites",!1,e))})}ta.retrieve("metaCheckRatesOverlay")&&ta.retrieve("metaCheckRatesOverlay").hide(),ta.remove("metaCheckRatesOverlay"),ta.has("metaCheckRatesCSS")||ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS));var n=ta.retrieve("pcr.overlay");n&&n.visible&&n.hide();var l="";l=ta.meta&&ta.meta.update?ta.meta.update.buildUrl("MetaCheckRatesAjax",e,!1):ta.commerce.checkrates.buildMetaHacUrl_allProviders(e,!1,"lb_allProviders",!0);var i="metaCheckRatesOverlay";i+=" metaLightBoxChevron marketingTextLightBox";var s=("#MAPVIEW"===window.location.hash||ta.id(window.mapDivId)&&""!==ta.id(window.mapDivId).innerHTML,{style:i,"backdropClickClose":!0,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",remoteContent:l,onLoad:function(){var t,a,r=!1;ta.store("isLightboxOpen",!0);try{if(!ta.meta||!ta.meta.update){var o="meta_lb_checkrates";r=new ta.commerce.CheckRatesData({type:o,evnt:null},e,e,!0),ta.store("ta.commerce.MetaHacOverlay.crData."+r.vendorSetId,r),a=r.getVendorSet().getAllVendorIds(),t=r.getVendorSet().getCheckedVendor(),ta.commerce.checkrates.updateMetaProviders(r)}var n=document.getElement(".metaCheckRatesOverlay .roundOuterClose");n&&!n.hasClass("no_cpu")&&(n.className+=" no_cpu"),this.inner&&ta.fireEvent("refreshedDOMContent",this.inner)}catch(e){ta.util.error.record(e,"meta all providers overlay load issue")}ta.meta&&ta.meta.update?ta.meta.update.overlayRequest(e):ta.commerce.checkrates.metaHacRequest(r,a,t)},evalScripts:!0,onClose:function(){ta.store("isLightboxOpen",!1);var t,a,r="meta_lightbox";if(r="meta_lightbox_chevron",ta.trackEventOnPage(r,"close",""),ta.retrieve("checkrates.meta_ui_post_click_prices")){var o=ta.retrieve("meta.baseLocationId");if(o&&e==o)ta.meta&&ta.meta.update?ta.meta.update.request(e):a&&ta.commerce.meta.updateProvAreaFromLightBox(a.vendorSetId),ta.has("metaCheckRatesUpdateDivInline")&&ta.commerce.meta.updateInlineMeta(e);else if(o){ta.has("ta.meta.navArea")&&(t=ta.retrieve("ta.meta.navArea"));var n=ta.id("MetaPricesTab"),l=!1;null!=n&&n.hasClass("sprite-tab-active")&&(l=!0);var i=ta.id("LOC_PHOTOS"),s=ta.id("AMENITY_LIGHTBOX"),c=!1;(i||s)&&(c=!0);var d=!1;if(ta.has("metaCheckRatesUpdateDivInline"))if(l)if(c){try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Inline")}catch(e){ta.util.error.record(e,"problem locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Mini")}catch(e){ta.util.error.record(e,"problem locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}ta.commerce.meta.updateNavArea("QC_Meta_Mini"),ta.meta&&ta.meta.update?ta.meta.update.request(e):(a=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+o),a&&ta.commerce.meta.miniMetaAjax(null,a,1e3)),d=!0,ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Inline"),ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Mini"),ta.commerce.meta.updateNavArea("QC_Meta_Inline"),ta.commerce.meta.updateInlineMeta(o),ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Inline"),ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Mini");try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Inline")}catch(e){ta.util.error.record(e,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Mini")}catch(e){ta.util.error.record(e,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}}else ta.commerce.meta.updateNavArea("QC_Meta_Inline"),ta.commerce.meta.updateInlineMeta(o),d=!0;else ta.meta&&ta.meta.update?ta.meta.update.request(o):(a=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+o),null!=a&&(ta.commerce.meta.updateNavArea("QC_Meta_Mini"),ta.commerce.meta.miniMetaAjax(null,a,1e3),d=!0));ta.meta&&ta.meta.update||(a=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+o),null==a||d||(ta.commerce.meta.updateNavArea("QC_Meta_Mini"),ta.commerce.meta.miniMetaAjax(null,a,1e3))),ta.commerce.meta.updateNavArea(t)}}ta.retrieve("metaCheckRatesOverlay")&&ta.retrieve("metaCheckRatesOverlay").destroy(),ta.remove("metaCheckRatesOverlay"),ta.widgets.calendar.removeMetaCalendarFromSync(e),ta.widgets.calendar.closeCalendarWidgets()}});if(s.absoluteOffset=!0,ta.retrieve("tablet_maps_v1")&&ta.retrieve("maps_v2_open")&&window.innerHeight>window.innerWidth){var c=72,d=ta.find(".flexCard");d&&(c=d.clientHeight+80),s.yOffset=c+window.getScrollTop()}else s.yOffset=72+window.getScrollTop();s.trigger=t;var v=new ta.overlays.CenteredOverlay(s,null);v.metaLocId=e,ta.store("metaCheckRatesOverlay",v),ta.has("locationPhotoAlbumOverlayResizeHack")&&ta.retrieve("locationPhotoAlbumOverlayResizeHack")()},metaCheckRatesOverlay:function(e,t,a,r){ta.overlays.Factory._recordLBOpen(),ta.commerce.meta.clearStoredMiniData(),ta.store("metaCheckRatesOverlay",null),ta.has("metaCheckRatesCSS")||ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS));var o=ta.retrieve("pcr.overlay");o&&o.visible&&o.hide();var n="";if(ta.meta&&ta.meta.update){if(!ta.has("ta.meta.request.locId"))return;n=ta.meta.update.buildUrl("MetaCheckRatesAjax",ta.retrieve("ta.meta.request.locId"),!1)}else n=ta.commerce.checkrates.buildMetaHacUrl(e,t,a,!1);var l="metaCheckRatesOverlay";l+=" metaLightBoxChevron";var i=("#MAPVIEW"===window.location.hash||ta.id(window.mapDivId)&&""!==ta.id(window.mapDivId).innerHTML,{style:l,"backdropClickClose":!0,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",remoteContent:n,onLoad:function(){if(ta.meta&&ta.meta.update){if(!ta.has("ta.meta.request.locId"))return;ta.meta.update.overlayRequest(ta.retrieve("ta.meta.request.locId"))}else ta.commerce.checkrates.updateMetaProviders(e),ta.commerce.checkrates.metaHacRequest(e,t,a);var r=document.getElement(".metaCheckRatesOverlay .roundOuterClose");r&&(r.className+=" no_cpu")},evalScripts:!0,onClose:function(){var t=this.source&&this.source.getParent(".gcrabLb"),a="meta_lightbox_chevron";if(ta.trackEventOnPage(a,"close",""),t||ta.overlays.Factory.updateMiniMetaPlacements(e),c.destroy(),!t){if(ta.store("metaCheckRatesOverlay",null),ta.meta&&ta.meta.update){if(!ta.has("ta.meta.request.locId"))return;ta.widgets.calendar.removeMetaCalendarFromSync(ta.retrieve("ta.meta.request.locId"))}else ta.widgets.calendar.removeMetaCalendarFromSync(e.vendorSetId);ta.widgets.calendar.closeCalendarWidgets()}}});if(!i.trigger){var s=ta.retrieve("ta.hlb_el");s&&(i.trigger=s)}i.absoluteOffset=!0,i.yOffset=72+window.getScrollTop();var c=new ta.overlays.CenteredOverlay(i,r);ta.store("metaCheckRatesOverlay",c),ta.has("locationPhotoAlbumOverlayResizeHack")&&ta.retrieve("locationPhotoAlbumOverlayResizeHack")()},updateMiniMetaPlacements:function(e){var t,a=ta.retrieve("meta.baseLocationId");if(!a&&ta.id("LOC_PHOTOS")){var r=ta.id("LOC_PHOTOS").getElement("#CHECK_RATE");r&&/id_(\d+)/.test(r.className)&&(a=RegExp.$1)}if(ta.has("ta.meta.navArea")&&(t=ta.retrieve("ta.meta.navArea")),a){var o=ta.id("MetaPricesTab"),n=!1;null!=o&&o.hasClass("sprite-tab-active")&&(n=!0);var l=ta.id("LOC_PHOTOS"),i=ta.id("AMENITY_LIGHTBOX"),s=ta.id("CHECK_RATES_LB"),c=!1;(l||i||s)&&(c=!0);var d=!1;if(ta.has("metaCheckRatesUpdateDivInline"))if(n)if(c){try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Inline")}catch(e){ta.util.error.record(e,"problem locking timing in Factory.metaCheckRatesOverlay for QC_Meta_Inline")}try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Mini")}catch(e){ta.util.error.record(e,"problem locking timing in Factory.metaCheckRatesOverlay for QC_Meta_Mini")}ta.commerce.meta.updateNavArea("QC_Meta_Mini"),ta.meta&&ta.meta.update?ta.meta.update.request(a):"undefined"!=typeof dd&&dd.commerce&&dd.commerce.checkrates&&dd.commerce.checkrates.checkRatesMiniMeta(null,document.getElementById("CHECK_RATE"),a,"checkrates"),d=!0,ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Inline"),ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Mini"),ta.commerce.meta.updateNavArea("QC_Meta_Inline"),ta.commerce.meta.updateInlineMeta(a),ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Inline"),ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Mini");try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Inline")}catch(e){ta.util.error.record(e,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Mini")}catch(e){ta.util.error.record(e,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}}else ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.widgets.calendar.datesExist()&&(ta.commerce.meta.updateNavArea("QC_Meta_Inline"),ta.commerce.meta.updateInlineMeta(a),d=!0);else ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.widgets.calendar.datesExist()&&(ta.commerce.meta.updateNavArea("QC_Meta_Mini"),ta.meta&&ta.meta.update?ta.meta.update.request(a):"undefined"!=typeof dd&&dd.commerce&&dd.commerce.checkrates&&dd.commerce.checkrates.checkRatesMiniMeta(null,document.getElementById("CHECK_RATE"),a,"checkrates"),d=!0);if((ta.retrieve("checkrates.meta_ui_post_click_prices")||l)&&ta.widgets.calendar.datesExist()&&!d){ta.commerce.meta.updateNavArea("QC_Meta_Mini");var v=document.getElementById("CHECK_RATE");!ta.retrieve("checkrates.meta_ui_post_click_prices")&&l&&(v=l.getElement("#CHECK_RATE")),ta.meta&&ta.meta.update?ta.meta.update.request(a):"undefined"!=typeof dd&&dd.commerce&&dd.commerce.checkrates&&dd.commerce.checkrates.checkRatesMiniMeta(null,v,a,"checkrates",!0)}}else e&&ta.commerce.meta.updateInlineMeta(e.vendorSetId);ta.commerce.meta.updateNavArea(t)},_recordLBOpen:function(){if(!ta.remove("skipLBGARecord")){var e=ta.remove("meta.lightboxOpener")||(ta.retrieve("meta.calendarCR")?"calendar":"button"),t="meta_lightbox_chevron";ta.trackEventOnPage(t,"open",e)}},createTAListingPolicyOverlay:function(e,t,a,r){var o=ta.id(a);null!=o&&new ta.overlays.CenteredOverlay({style:"s3 dg rgba_gry",backdrop:ta.overlays.BACKDROP_ALWAYS,content:o.get("html"),isChild:r},null)},miniMetaCrossSellMicroOverlay:function(e,t,a,r){try{t.onmouseover=null,t.onclick=null;var o;if(ta.meta&&ta.meta.update)o=ta.meta.update.buildUrl("MicroMetaAjax",a,!0,!1,"QC_Meta_Mini|Related_XSell");else{var n=new ta.commerce.CheckRatesData({type:"checkrates",evnt:e},t,a,!0),l=n.getVendorSet().getCheckedContentID(),i=n.getVendorSet().getCheckedVendor(),s=ta.retrieve("meta.travelData");s=ta.commerce.checkrates.getTravelDataFromDOM(),o=ta.commerce.checkrates.buildVarMetaHacUrl("MicroMetaAjax",n,l,i,!0,null,"QC_Meta_Mini|Related_XSell",s)}o+="&lowContentID="+r,o+="&drop=true";var c=t.className.match(/noDelayFirst/),d=t.className.match(/delayOpen/),v=ta.retrieve("delayedFirst"),u=!d||c&&!v,m=new ta.overlays.RelativeOverlayBelow({style:"",allowFlip:!1,activate:ta.overlays.ACTIVATE_HOVER_DELAY,autoShow:u,delayShow:d,offsetLeft:0,offsetTop:-20,showCloseButton:!1},t);m.loadRemoteContent(o,!1),ta.store("delayedFirst",!0)}catch(e){ta.util.error.record(e,"ta.overlays.factory.miniMetaCrossSellMicroOverlay")}},tripTypeSelectOverlay:function(e,t){if(t&&e){t.onclick=null,e.stop(),ta.trackEventOnPage("Reviews_Controls","filter_dropdown","");var a=document.getElement(".tripTypeOverlayContents");a&&(a.show(),new ta.overlays.RelativeOverlayBelow({style:"tripTypeSelectOverlay",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:!1,content:a,offsetTop:3},t))}},languageFilterSelectOverlay:function(e,t){if(t&&e){t.onclick=null,e.stop();var a=document.getElement(".languageList");a&&(a.show(),new ta.overlays.RelativeOverlayRight({style:"tripTypeSelectOverlay",activate:ta.overlays.ACTIVATE_HOVER,showCloseButton:!1,content:a,offsetLeft:-13},t))}},reviewLanguageOverlay:function(e,t){if(t&&e){t.onclick=null,e.stop();var a=document.getElement(".languageList");if(a){var r=t.getSize().x-16;new ta.overlays.RelativeOverlayBelow({style:"reviewLanguageOverlay",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:!1,content:a,offsetTop:1,offsetLeft:r},t)}}},reviewSeasonOverlay:function(e,t){if(t&&e){t.onclick=null,e.stop();var a=document.getElement(".seasonList");a&&new ta.overlays.RelativeOverlayBelow({style:"reviewLanguageOverlay",activate:ta.overlays.ACTIVATE_CLICK_TOGGLE,showCloseButton:!1,content:a,offsetTop:1},t)}},installExitInterrupter:function(){},ipLearnMoreMenu:function(e,t){t&&e&&(t.onclick=null,e.stop(),new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,style:"dropMenu"},t),new Request({url:"/ActionRecord?action=FBIP-PersistentHeader-Flyout"}).send())},logTrackingTree:function(){var e=document.getElement(".micro_meta_flyout");if(e){var t=e.getElement(".impressionTrackingTree");t&&ta.trkImpTree(t)}},racLBDelegates:function(){function e(){}function t(){}return{onLoad:e,onClose:t}},racGeoSearchDelegates:function(e){return{ot(e)}}},createSearchPageScopeSelect:function(e,t){if(e&&t)return new ta.overlays.RelativeOverlayBelow({style:"geo_select_flyout",closeOnDocumentClick:!0,content:t},e)},loadingMostRecentDraftOverlay:function(e,t){if(e){var a=new ta.overlays.CenteredOverlay({showCloseButton:!1,backdrop:ta.overlays.BACKDROP_ALWAYS,content:e.innerHTML,backdropColor:"#FFF",backdropOpacity:.8,style:"loadingMostRecentDraftOverlay"});t(),setTimeout(function(){a.hide()},3e3)}},restaurantFiltersOverlay:function(e){return new ta.overlays.CenteredOverlay({showCloseButton:!0,innerDivClass:"filtersOverlay",style:"filtersOverlayContainer",closeButtonClass:"filtersOverlayClose",content:e,backdrop:ta.overlays.BACKDROP_ALWAYS,fixed:!1,noScrollY:!0})}}}();
ta.overlays.CalendarOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,options:{showCloseButton:!0,activate:ta.overlays.ACTIVATE_FOCUS,style:"typeO ocal",autoShow:!1,autoShowCal:!1,calendarOptions:null,flipPadding:25,zIndex:999,extraShow:null},initialize:function(e,t){this.input=e.getElement("input[type=text]"),this.parent(t,this.input),this.input.overlay=this,this.dayField=e.getElement("input.day"),this.monthField=e.getElement("input.month"),this.source.addEvent("click",this.show),this.icn=e.getElement("span.icn"),this.icn&&(this.icn.onclick="",this.icn.addEvent("click",this.show));var a=e.className.search("first")>=0;this.calendar=new ta.widgets.Calendar(Object.merge({dualCalendar:!0,choiceLink:"ta.overlays.calendarSelect",prevAction:"ta.overlays.calendarPrev",nextAction:"ta.overlays.calendarNext",onSelect:this.select.bind(this),onClear:this.clear.bind(this),isFirstCal:a},this.options.calendarOptions)),this.inner.adopt(this.calendar.container),this.parentOverlay=e.getParent(".overlay"),this.parentOverlay&&(this.parentOverlay=this.parentOverlay.overlay,this.options.isChild=!0),this.options.autoShowCal&&this.show()},destroy:function(){this.parent(),this.input.overlay=null},show:function(e,t){this.options.extraShow&&this.options.extraShow(this),this.input.addClass("selected");var a=this.visible;if(this.parent(e),!a||t)return this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK&&(this.tempPin=!this.parentOverlay.pinned,this.tempPin&&this.parentOverlay.pin()),this.loadFields(),this.calendar.update(),this.calendar.reposition(),this},hide:function(e){this.visible&&(this.parent(e),this.parentOverlay&&this.tempPin&&(this.tempPin=!1,this.parentOverlay.unpin()))},hideNow:function(e){return this.input.removeClass("selected"),this.visible?(this.parent(e),void(this.parentOverlay&&this.tempPin&&(this.tempPin=!1,this.parentOverlay.unpin()))):this},select:function(e,t){t&&new Event(t).preventDefault(),this.updateFields(),e.options.dontHideOnSelect||this.hide(),this.fireEvent("onSelect",[this,t])},hover:function(e,t){this.fireEvent("onHover",[e,this,t])},mou,e])},clear:function(e,t){t&&new Event(t).preventDefault(),this.clearFields(),this.hide(),this.fireEvent("onClear",this)},loadFields:function(){var e=parseInt(this.dayField.value.replace(/^0/,"")),t=this.monthField.value.split(/\//);if(2==t.length){var a=parseInt(t[1]);return ta.retrieve("thai_buddhist_era_year")&&a>=(new Date).getFullYear()+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET&&(a-=ta.util.date.THAI_BUDDHIST_YEAR_OFFSET),t=parseInt(t[0].replace(/^0/,"")),this.calendar.selectedDate=ta.util.date.create(a,t-1,e),this}},updateFields:function(){if(this.calendar.selectedDate||this.loadFields(),this.calendar.selectedDate){var e=this.calendar.selectedDate.getMonth()+1;e<10&&(e="0"+e),this.dayField.value=this.calendar.selectedDate.getDate(),this.monthField.value=e+"/"+this.calendar.selectedDate.getFullYear();var t=this.calendar.selectedDate.getFullYear();ta.retrieve("thai_buddhist_era_year")&&(t+=ta.util.date.THAI_BUDDHIST_YEAR_OFFSET),this.input.value=formatDate(this.calendar.selectedDate.getDate(),this.calendar.selectedDate.getMonth(),t),this.input.defaultValue=formatDate(this.calendar.selectedDate.getDate(),this.calendar.selectedDate.getMonth(),t),this.input.removeClass&&this.input.removeClass("placeholder")}},clearFields:function(){this.options.calendarOptions&&!this.options.calendarOptions.clearToBlank?this.input.value=this.input.getAttribute("placeholderValue")||JS_DateFormat:this.input.value==this.input.defaultValue&&(this.input.value="")},clearDateFds()},resetFieldsIfBlank:function(){""==this.input.value&&(this.input.value=this.input.defaultValue)},validate:function(){var e=this.input.value.match(DATE_FORMAT.pattern);if(!e)return sInvalidDates;var t=parseInt(e[DATE_FORMAT.date].replace(/^0/,"")),a=parseInt(e[DATE_FORMAT.month].replace(/^0/,"")),i=parseInt(e[DATE_FORMAT.year].replace(/^0/,""));return t>0&&t<32&&a>0&&a<13?(t<10&&(t="0"+t),a<10&&(a="0"+a),i<100&&(i+=2e3),this.dayField.value=t,this.monthField.value=a+"/"+i,this.loadFields(),this.calendar.isValid()?null:sInvalidDates):sInvalidDates}}),ta.overlays.createCalendar=function(e,t){new Event(e).preventDefault(),t.onfocus="",new ta.overlays.CalendarOverlay($(t).getParent(".cal"),{autoShowCal:!0})},ta.overlays.createCustomCalendar=function(e,t,a){new Event(e).preventDefault(),t.onfocus="",new ta.overlays.CalendarOverlay($(t).getParent(".cal"),{autoShowCal:!0,calendarOptions:a})},ta.overlays.calendarSelect=function(e,t,a,i,n){ta.has("checkrates.calendarActionRecord")&&(ta.util.cookie.removePIDCookie(),ta.meta.linkTracking.actionRecord(ta.retrieve("checkrates.calendarActionRecord"))),ta.id(n).getParent(".overlay").overlay.calendar.select(e,ta.util.date.create(t,a,i))},ta.overlays.calendarPrev=function(e,t){ta.id(t).getParent(".overlay").overlay.calendar.prev()},ta.overlays.calendarNext=function(e,t){ta.id(t).getParent(".overlay").overlay.calendar.next()};
ta.overlays.PairedCalendar=new Class({Implements:[Options,Events],options:{validate:!1,validateFun:function(){},allowSameDay:!1,calendarOptions:null,defaultSpan:1,keepDelta:!1,clearDatesId:"clearDates",overlayOptions:{},overlayFirstOptions:null,disallowChars:!1,disableInvalidEndDates:!1,showCalIfInvalid:!1,clearOnRestart:!1,allowReverse:!1},initialize:function(e,t){this.setOptions(t),e=ta.id(e),this.form="form"==e.get("tag")?e:e.getParent("form");var a=Object.merge({onSelect:this.adjustRange.bind(this)},this.options.overlayOptions);this.options.calendarOptions&&(a.calendarOptions=this.options.calendarOptions),this.form.getElements(".cal").each(function(e){var t;if(t=e.hasClass("first")&&this.options.overlayFirstOptions?new ta.overlays.CalendarOverlay(e,Object.merge(Object.clone(a),this.options.overlayFirstOptions)):new ta.overlays.CalendarOverlay(e,a),t.input.onfocus="",this.options.disallowChars&&t.input.addEvent("keypress",this.validateInput.bind(this)),e.hasClass("first"))this.before=t;else if(this.after=t,ta.has("isDaoDaoCRRedesign")){var s=this.form.get("qc_area");this.after.qcArea=s,this.before.qcArea=s}},this),ta.retrieve("isDaoDao")&&(ta.store("cal_in",this.before),ta.store("cal_out",this.after)),this.after.theOtherCal=this.before,this.before.theOtherCal=this.after,this.after.calendar.theOtherCal=this.before.calendar,this.before.calendar.theOtherCal=this.after.calendar,e===this.before.input||e===this.before.icn?(this.after.loadFields(),this.before.options.autoShowCal&&this.before.show()):e!==this.after.input&&e!==this.after.icn||(this.before.loadFields(),this.after.options.autoShowCal&&this.after.show()),this.form&&(this.form.calendar=this,this.options.validate&&(this.form.addEvent("submit",this.validate.bind(this)),this.errorDiv=this.form.getElement(".error_msg")))},getOverlayForCalendar:function(e){return this.before.calendar==e?this.before:this.after.calendar==e?this.after:null},adjustRange:function(e){this.requireFullLoad(),this.form.searchAll&&("checkbox"==this.form.searchAll.type?this.form.searchAll.checked=!1:"hidden"==this.form.searchAll.type&&(this.form.searchAll.value="false"));var t=ta.id(this.options.clearDatesId);t&&(t.style.visibility="visible");var a=!1;if(this.options.clearOnRestart&&e===this.before)this.after.clearDateFields();else if(this.options.allowReverse&&e===this.after&&this.before.calendar.selectedDate&&this.after.calendar.selectedDate.getTime()<this.before.calendar.selectedDate.getTime()){var s=this.before.calendar.selectedDate;this.before.calendar.selectedDate=this.after.calendar.selectedDate,this.after.calendar.selectedDate=s,this.before.updateFields(),this.after.updateFields()}else{if(this.sameDayEnabled()||this.options.disableInvalidEndDates||!this.after.calendar.selectedDate||this.after.calendar.selectedDate.getTime()!=this.after.calendar.options.firstDate.getTime()){if(e==this.before){if(this.options.keepDelta||!this.isBeforeValid()){var s=new Date(this.before.calendar.selectedDate);s.setDate(s.getDate()+this.options.defaultSpan),this.after.calendar.selectedDate=s,a=!0}this.after.updateFields()}else if(e==this.after){if(!this.isAfterValid()){var s=new Date(this.after.calendar.selectedDate);s.setDate(s.getDate()-this.options.defaultSpan),s.getTime()<this.before.calendar.options.firstDate.getTime()&&(s=new Date(this.before.calendar.options.firstDate.getTime())),this.before.calendar.selectedDate=s}this.before.updateFields()}}else{this.before.calendar.selectedDate=new Date(this.before.calendar.options.firstDate),this.options.keepDelta&&(this.options.defaultSpan=1);var s=new Date(this.after.calendar.options.firstDate);s.setDate(s.getDate()+this.options.defaultSpan),this.after.calendar.selectedDate=s,this.before.updateFields(),this.after.updateFields()}this.options.keepDelta&&this.before.calendar.selectedDate&&(this.options.defaultSpan=ta.util.date.getDaysInRange(this.before.calendar.selectedDate,this.after.calendar.selectedDate)-1,this.sameDayEnabled()?this.options.defaultSpan<0&&(this.options.defaultSpan=0):this.options.defaultSpan<1&&(this.options.defaultSpan=1))}this.fireEvent("onUpdate",this);var i=ta.retrieve("calendar.onUpdateCallback");if(i)for(var r=0;r<i.length;r++)window[i[r]]&&window[i[r]](this,e);this.updateMinStay(this.before.calendar.selectedDate,this.after.calendar.selectedDate);try{var l="before";e==this.after&&(l="after")}catch(e){ta.util.error.record(e,"availability check - paired cal")}if(this.options.disableInvalidEndDates&&e==this.before){var s=new Date(this.before.calendar.selectedDate);s.setDate(s.getDate()+1),this.after.calendar.options.firstDate=s,a&&this.after.show()}},updateMinStay:function(e,t){var a=ta.id("minStay");a&&e&&t&&(a.disabled=!0,a.selectedIndex=this.getMinStayIndex(e,t))},getMinStayIndex:function(e,t){var a=ta.util.date.getDaysInRange(e,t)-1;return a<7?a:a<28?7:8},isOcked},sameDayEnay()},searchAllEnabled:function(){return this.form.searchAll&&(this.form.searchAll.checked||"hidden"==this.form.searchAll.type&&"true"==this.form.searchAll.value)},updateFields:function(){this.before.updateFields(),this.after.updateFields()},clearFields:function(){this.before.clearDateFields(),this.after.clearDateFields()},resetFieldsIfnk()},requireFullLoad:function(){this.before.calendar.selectedDate||this.before.loadFields(),this.after.calendar.selectedDate||this.after.loadFields()},isBeforeValid:function(){return this.requireFullLoad(),!this.after.calendar.selectedDate||(this.before.calendar.selectedDate<this.after.calendar.selectedDate||this.sameDayEnabled()&&this.before.calendar.selectedDate.getTime()<=this.after.calendar.selectedDate.getTime())},isAfterValid:function(){return this.requireFullLoad(),!this.before.calendar.selectedDate||(this.after.calendar.selectedDate>this.before.calendar.selectedDate||this.sameDayEnabled()&&this.after.calendar.selectedDate.getTime()>=this.before.calendar.selectedDate.getTime())},validatelt()},validate:function(e){if(this.searchAllEnabled())return!0;var t=this.before.validate(),a=this.after.validate(),s=!0;if(this.isOneWay()?null!=t&&(s=!1,this.setError(t)):null!=t||null!=a?(s=!1,this.setError(t||a)):this.isAfterValid()||(s=!1,this.setError(sInvalidDates)),!s&&e&&new Event(e).stop(),this.options.showCalIfInvalid){var i;null!=t?i=this.before:null==a&&s||(i=this.after),i&&(i.input.value="",i.selectedDate=new Date,i.updateFields(),i.show())}if(!s||!this.options.validateFun||"function"!=typeof this.options.validateFun)return s;try{return this.options.validateFun(e)}catch(t){return ta.util.error.record(t,"post-validation callback function failed in PairedCalendar",e),s}},setError:function(e){this.errorDiv&&this.errorDiv.setContent(e).show()},toggleSearchAll:function(){this.searchAllEnabled()?(this.before.clearFields(),this.after.clearFields()):(this.requireFullLoad(),this.before.updateFields(),this.after.updateFields())}}),ta.overlays.createSimplePairedCalendar=function(e,t){new Event(e).stop(),new ta.overlays.PairedCalendar(t)},ta.overlays.createPairedCalendar=function(e,t,a){a||(a={validate:!0}),new Event(e).preventDefault();var s,i=function(){if(ta.has("hotel.meta2013"))return ta.retrieve("hotel.meta2013");var e=ta.id("MAIN"),t=e&&(e.hasClass("Hotel_Review")||e.hasClass("ShowUserReviews")||e.hasClass("Hotels")||e.hasClass("HACSearch"));return ta.store("hotel.meta2013",t),t};if(ta.isMetaHomepageIntegration2013()||i()||ta.isMetaHotels2013()||ta.isAirport()){var r=a.inline,l="undefined"!=typeof a.skipHAC&&null!=a.skipHAC&&a.skipHAC;a.clearOnRestart=!0,a.allowReverse=!0,a.overlayOptions={showCloseButton:!1,style:"date_picker_calendar paired",noPadding:!0,noCpu:!0},a.calendarOptions={prevStyle:"sprite-date_picker-btnLeftIdle",nextStyle:"sprite-date_picker-btnRightIdle",showRange:!0},a.onUpdate=function(t){ta.widgets.calendar.setPageInDate(t.before.calendar.selectedDate),ta.widgets.calendar.setPageOutDate(t.after.calendar.selectedDate),t.before.calendar.selectedDate&&t.after.calendar.selectedDate&&(ta.isMetaHotels2013()&&!l?ta.servlet.HACSearch.doMetaDateSearch():r&&ta.widgets.calendar.launchInlineMeta(e))},a.clearDates&&(delete a.clearDates,a.calendarOptions.postContent=function(){var e=Elements.from('<div id="SKIP_DATES"><span class="skip_dates_text"><span class="taLnk">'+ta.retrieve("multiDP.skipDates")+"</span></span></div>")[0];return e.getElement(".taLnk").addEvent("click",function(){var e=ta.overlays.getCurrent();e&&(e.clearDateFields(),e.theOtherCal&&e.theOtherCal.clearDateFields(),e.hide());var t=ta.id("SUBMIT_HOTELS");t&&t.focus(),ta.widgets.calendar.clearPageDates(),ta.widgets.calendar.clearSessionDates(),ta.overlays.Factory.trackSkipDatesEvent("Meta_Homepage","Calendar","Skip dates",0)}),e}),s=new ta.overlays.PairedCalendar(t,a),s.before.addEvent("onSeus()})}else s=new ta.overlays.PairedCalendar(t,a);return s},ta.overlays.clearFields=function(e){e.calendar&&e.calendar.clearFields()},ta.overlays.resetFieldsIfnk()},ta.overlays.toggleOffSearchAll=function(e){e.calendar&&e.searchAll&&("checkbox"==e.searchAll.type?e.searchAll.checked=!1:"hidden"==e.searchAll.type&&(e.searchAll.value="false"),e.calendar.toggleSearchAll())},ta.overlays.toggleOnSearchAll=function(e){e=ta.id(e);var t=e.getParent("form");t.calendar||new ta.overlays.PairedCalendar(e,{validate:!0,clearDatesId:e}),t.calendar&&t.searchAll&&("checkbox"==t.searchAll.type?t.searchAll.checked=!0:"hidden"==t.searchAll.type&&(t.searchAll.value="true"),t.calendar.toggleSearchAll())},ta.overlays.toggleSearchAll=function(e,t,a){t=ta.id(t),t.onclick="";var s=t.getParent("form");a||(a={validate:!0}),s.calendar||new ta.overlays.PairedCalendar(t,a),s.calendar.toggleSearchAll(t),t.addEvent("click",s.calendar.toggleSearchAll.bind(s.calendar))},ta.overlays.clearDates=function(e,t){ta.overlays.toggleOnSearchAll(t),ta.id(t).style.visibility="hidden";var a=ta.id("minStay");null!==a&&(a.disabled=!1,a.selectedIndex=0,filtersChanged(e))};
ta.overlays.PermanentOverlay=new Class({Extends:ta.overlays.AbsoluteOverlay,initialize:function(e,a){this.parent(Object.merge({permanent:!0},e),a)}});
ta.overlays.SkinnyOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,initialize:function(t,e){this.parent(t,e),this.container.setStyle("max-width","120px"),Browser.ie6&&this.shim.setStyle("max-width","120px"),this.transparentOverlayPadding&&this.transparentOverlayPadding.setStyle("max-width","120px")}});
ta.overlays.Registration=new Class({Implements:[Options,Events],Binds:["response","failure"],options:{flow:null,url:"/Registration",isOverlay:!0,pageTarget:null,responseCallback:null,completeCallback:null,customOverlayOptions:{},noreload:!1,failureCloseHandler:null},initialize:function(e){this.setOptions(e),this.options.isOverlay&&(this.overlay=new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS,autoShow:!1,style:"s4 dg",attachCloseEvent:!1},this.options.customOverlayOptions)),this.overlay.closeBtn&&this.overlay.closeBtn.addEvent("click",this.cancel.bind(this)))},getRequestData:function(){var e={flow:this.options.flow};this.options.pid&&Object.merge(e,{pid:this.options.pid}),ta.has("registration.data")&&(e=Object.merge(e,ta.retrieve("registration.data"))),ta.has("page.geo")&&(e.geo=ta.retrieve("page.geo")),e.source=pageServlet,e=[e],(Array.convert||Array.from)(arguments).each(function(t){e.push(t)});var t=ta.id("token");if(t&&t.hasOwnProperty("value")&&(e.securityToken=t.value),ta.has("rsa")){e.push({"encrypted":ta.retrieve("rsaVersion")});var a=ta.retrieve("rsa");e.forEach(function(t){if(t.pass)try{e.push({"epass":a.encrypt(t.pass.value)})}catch(e){ta.util.error.record(e,"Encrypted Signin - encrypting sign-in/sign-up form parameters")}})}return e},_getUrl:function(){var e=ta.util.URL.https(this.options.url);return 0!==e.indexOf("https:")?(ta.util.error.record(null,"Post URL must have https protocol."),""):e},request:function(e,t){ta.store("registration.method","request");var a={url:this._getUrl(),method:"get",withCredentials:ta.retrieve("access_control_headers"),evalScripts:!0,data:this.getRequestData(t,{action:e}),onSuccess:this.response,onFailure:this.failure};return ta.has("registration.ga_module")&&(a.trackEvent={module:ta.retrieve("registration.ga_module"),action:e+"_Show",context:this.options.flow}),new Request(a).send(),this},post:function(e){var t=this;return ta.has("registration.ga_module")&&ta.trackEventOnPage(ta.retrieve("registration.ga_module"),e.action.value+"_Submit",t.options.flow,1,!1),ta.util.pending.wang")},function(){ta.has("facebook.authcode.param")&&(e=Object.merge(e,{FBAuthCode:ta.remove("facebook.authcode.param")})),ta.store("registration.method","post"),new Request({url:t._getUrl(),method:"post",withCredentials:ta.retrieve("access_control_headers"),evalScripts:!0,data:t.getRequestData(e,{noreload:t.options.noreload}),onSuccess:t.response,onFailure:t.failure}).send()},100),this},cancel:function(){return ta.store("registration.method","cancel"),new Request({url:this._getUrl(),method:"get",withCredentials:ta.retrieve("access_control_headers"),evalScripts:!0,data:this.getRequestData({CANCEL:"y",action:ta.retrieve("registration.action"),noreload:this.options.noreload}),onSuccess:this.response,onFailure:this.failure}).send(),this},log:function(e){return new Request({url:this._getUrl(),method:"get",withCredentials:ta.retrieve("access_control_headers"),evalScripts:!1,data:this.getRequestData({action:"LOG",pageAction:e})}).send(),this},response:function(e){ta.remove("registration.noop")||(this.options.isOverlay?(this.overlay.loadRemoteSuccess(e),this.overlay.visible?this.overlay.position():this.overlay.show()):this.options.pageTarget&&this.options.pageTarget.setContent(e)),this.options.responseCallback&&setTimeout(this.options.responseCallback,1),ta.has("registration.afterUpdate")&&ta.remove("registration.afterUpdate")e,1)})},close:function(){this.options.isOverlay&&this.overlay.hide(),this.fireEvent("onComplete"),this.options.completeCallback&&this.options.completeCallback()},failure:function(e){var t=0,a=ta.remove("registration.method");try{t=e.status}catch(e){}503==t?(this.overlay.loadRemoteSuccess('<div style="padding:6px;">'+JS_maintenance+"</div>"),!this.overlay.closeBtn&&this.options.failureCloseHandler&&this.overlay.addCloseButton(),this.overlay.closeBtn&&(this.overlay.closeBtn.removeEvents("click"),this.overlay.closeBtn.addEvent("click",this.options.failureCloseHandler||ta.overlays.registration.close)),this.overlay.visible?this.overlay.position():this.overlay.show()):("cancel"==a&&ta.overlays.registration.close(),ta.util.error.ajaxFailure.partial("Registration:"+a))}}),ta.overlays.registration={getInstance:function(e){var t=ta.retrieve("registration.instance");return t||("undefined"==typeof regflowCss||ta.retrieve("ta.regflowCss")||ta.store("ta.regflowCssAsset",Asset.css(regflowCss)),t=new ta.overlays.Registration(e),ta.store("registration.instance",t)),t},connect:function(e,t,a){if(ta.queueForReady(function(){"undefined"==typeof regflowCss||ta.retrieve("ta.regflowCss")||ta.store("ta.regflowCssAsset",Asset.css(regflowCss))},0,"Pre-redesigned Registration CSS"),ta.has("facebook.available")&&ta.retrieve("facebook.available"))var s={"fbAvailable":!0};else if(ta.has("registration.forceFBAvailable"))var s={"fbAvailableForce":ta.remove("registration.forceFBAvailable")};var o="SIGNIN";ta.remove("registration.data"),"undefined"==typeof e&&(e={});var r="Deprecated_Registration_connect_"+e.flow;ta.util.error.record(null,r),ta.overlays.registration.addLoadingGeeTestCaptchaOnCallBack(e),ta.overlays.registration.getInstance(e).request(t||o,Object.merge({},a,s))},post:function(e,t){var a=t||window.event;a&&new Event(a).stop(),ta.overlays.registration.getInstance().post(e)},request:function(e,t,a){"SIGNUP"!=e&&"SIGNIN"!=e||(t=Object.merge({"fbAvailable":ta.has("facebook.available")&&ta.retrieve("facebook.available")},t)),"undefined"==typeof a&&(a={}),ta.overlays.registration.addLoadingGeeTestCaptchaOnCallBack(a),ta.overlays.registration.getInstance(a).request(e,t)},deferredRequest:function(e,t,a,s,o){ta.overlays.registration.getInstance(o).request(a,s,o)},cancel:function(e){ta.overlays.registration.getInstance(e).cancel(!1)g(e)},se()},switchFlow:function(e){ta.overlays.registration.getInstance().options.flow=e},logAndPost:function(e,t,a){ta.overlays.registration.getInstance(e).log(t).post(a)},postSignupForm:function(e,t){var a=t||window.event;a&&new Event(a).stop(),ta.overlays.registration.getInstance().post(e)},addLoadingGeeTestCaptchaOnCallBack:function(e){if("function"==typeof e.responseCallback){var t=e.responseCallback;e.responseCal,t()}}else e.responseCallback=ta.overlays.registration.loadGeeTestCaptcha},loadGeeTestCaptcha:function(){if(ta.retrieve("geetest_captcha")){var e=ta.id("geetest_recaptcha_widget");if(e){var t=e.getAttribute("data-captcha-id"),a=e.getAttribute("data-captcha-type"),s=ta.select("#geetest_recaptcha_widget .gt_holder");if(window.Geetest&&0==s.length){new Geetest({gt:t,product:a,https:!0}).onReady(function(){var e=ta.select("#geetest_recaptcha_widget .gt_guide_tip");e.length>0&&(e[0].innerHTML=ta.retrieve("geetest_captcha.str_slide_to_verify"))}).appendTo(e);ta.trackEventOnPage&&ta.trackEventOnPage("reg_captcha","GEETEST","displayed")}}}}};
ta.servlet||(ta.servlet={}),ta.servlet.Registration={realNameDone:function(e){ta.id("use_real_name")&&ta.id("use_real_name").getProperty("checked")||ta.id("chooseNameFB")||ta.id("chooseNameGoogle")?ta.overlays.registration.post(ta.id("RealName"),e):ta.overlays.registration.cancel()},screenEdit:function(e){ta.id("screen").set("value",""),ta.id("screen").focus(),ta.id(e).hide()},displayLoading:function(){null!=window.CDNHOST?ta.id("buttonArea").innerHTML='<img class="loadingGif" src="'+CDNHOST+'/img2/generic/site/loading_anim_gry_sml.gif" />':ta.id("submitButton").set("disabled",!0)},trackEmailOpt:function(e,a){e&&(e.checked||ta.trackEventOnPage("register","sign_up_"+a,"email_opt_out"))},toggleProgressCircle:function(e){var a=ta.id("circleContainer_"+e);if(a){var t=a.querySelector(".circleCheckmark"),r=a.querySelector(".circleID");a.hasClass("progressCircleChecked")?(a.removeClass("progressCircleChecked"),a.addClass("progressCircle"),t&&r&&(t.classList.add("hidden"),r.classList.remove("hidden"))):(a.removeClass("progressCircle"),a.addClass("progressCircleChecked"),t&&r&&(t.classList.remove("hidden"),r.classList.add("hidden")))}},toggleProgressBar:function(e){var a=ta.id("barContainer_"+e);a&&(a.hasClass("filled")?a.removeClass("filled"):a.addClass("filled"))},toggleProgressElement:function(e,a,t){e&&e<=a&&("Bar"==t?this.toggleProgressBar(e):"Circle"==t&&this.toggleProgressCircle(e))},toggleTagged:function(e,a,t,r){if(e&&ta.id("tagContainer_"+e)){var i=ta.select(".tagSelection:checked").length,s=ta.id("tagContainer_"+e);s.hasClass("tagged")?(s.removeClass("tagged"),this.toggleProgressElement(i,a,r),ta.id("tag_"+e).checked&&(ta.id("tag_"+e).checked=!1,this.activateMemberTagSubmit(t))):(s.addClass("tagged"),this.toggleProgressElement(i+1,a,r),ta.id("tag_"+e).checked||(ta.id("tag_"+e).checked=!0,this.activateMemberTagSubmit(t)))}},activateMemberTagSubmit:function(e){var a=1,t=ta.id("submitBtn");e&&(a=0),t&&ta.select(".tagSelection:checked").length>=a?t.addClass("active"):t&&t.removeClass("active")},submitMemberTags:function(e,a){var t,r=(t=ta.select(".tagSelection:checked"))?t.length:0,i=(t=ta.id("memberTagsPlacementPid"))?t.value:0,s=(t=ta.id("memberTagsIsSecure"))&&"true"==t.value,n=(t=ta.id("memberTagsIsEditFlow"))&&"true"==t.value,g=(t=ta.id("memberTagsForceAjax"))&&"true"==t.value,d=(t=ta.id("memberTagsOnSuccess"))?t.value:"",o=ta.servlet.Registration[d],m=$(e);if(m&&m.hasClass("active")){var l=m.hasClass("skipBtn"),c=ta.id("submitBtn");c&&c.removeClass("active");var b=ta.id("skipBtn");if(b&&b.removeClass("active"),ta.trackEventOnPage("self_tags",a,i,r),n&&l&&"undefined"!=typeof oxapp&&oxapp.getSubview("modules.membercenter.MemberTag")){c&&c.addClass("active"),b&&b.addClass("active");var u=oxapp.getSubview("modules.membercenter.MemberTag");return u.context&&u.context.get("MemberCenter_MemberTags")&&u.context.get("MemberCenter_MemberTags")._items&&0==u.context.get("MemberCenter_MemberTags")._items.length&&(u.taggedItems=[]),void u.taggingOverlay.hide()}if(n&&l&&"undefined"!=typeof bbapp&&bbapp.getView("modules.membercenter.MemberTag")){c&&c.addClass("active"),b&&b.addClass("active");var u=bbapp.getView("modules.membercenter.MemberTag");return u.context&&u.context.get("MemberCenter_MemberTags")&&0==u.context.get("MemberCenter_MemberTags").length&&(u.taggedItems=[]),void u.taggingOverlay.hide()}if(l){var p=ta.id("tagCancel");p&&(p.value=!0);var v=ta.find(".overlayBG"),C=ta.find(".withBackdrop"),f=ta.id("tagPrompt");f&&v&&C&&C.hasClass("taggingOverlay")&&(f.hide(),v.hide(),C.hide())}s&&!g?ta.overlays.registration.getInstance().post(ta.id("SELF_TAG_FORM")).resve")}):new Request({url:"/MemberTagsAjax",method:"post",data:ta.id("SELF_TAG_FORM"),onSuccess:function(e){c&&c.addClass("active"),b&&b.addClass("active"),"function"==typeof o&&o(e)},onFailure:function(e){c&&c.addClass("active"),b&&b.addClass("active"),"undefined"!=typeof oxapp&&oxapp.getSubview("modules.membercenter.MemberTag")&&oxapp.getSubview("modules.membercenter.MemberTag").taggingOverlay.hide(),"undefined"!=typeof bbapp&&bbapp.getView("modules.membercenter.MemberTag")&&bbapp.getView("modules.membercenter.MemberTag").taggingOverlay.hide()}}).send();var p=ta.id("tagCancel");p&&(p.value="")}},memberTagsSuccessMemberCenter:function(e){if(("undefined"!=typeof oxapp||"undefined"!=typeof bbapp)&&e){var a,t=(a=ta.id("memberTagsIsEditFlow"))&&"true"==a.value;t&&"undefined"!=typeof oxapp&&oxapp.context.get("MemberCenter_MemberTags")&&(oxapp.context.get("MemberCenter_MemberTags").fetch().always(function(){oxapp.getSubview("modules.membercenter.MemberTag")&&oxapp.getSubview("modules.membercenter.MemberTag").render()}),oxapp.getSubview("modules.membercenter.MemberTag")&&oxapp.getSubview("modules.membercenter.MemberTag").taggingOverlay.hide()),t&&"undefined"!=typeof bbapp&&bbapp.context.get("MemberCenter_MemberTags")&&(bbapp.context.get("MemberCenter_MemberTags").fetch().aer()}),bbapp.getView("modules.membercenter.MemberTag")&&bbapp.getView("modules.membercenter.MemberTag").taggingOverlay.hide())}},memberTagsRedirectCompletionUrl:function(e){var a=ta.id("memberTagsCompletionUrl");a&&a.value&&(window.location.href=a.value)}};
ta.overlays.PopoutOverlay=new Class({Extends:ta.overlays.Overlay,options:{backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:!0},initialize:function(t,e){this.parent(t,e),this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source),this.placeholder.setStyles({marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop}),this.source.setStyles({marginBottom:0,marginTop:0}),this.options.showCloseButton&&this.closeBtn.addEvent("click",this.hide),this.show()},show:function(t){this.sourceCoords=this.source.getCoordinates(),this.placeholder.setStyles({width:this.sourceCoords.width,height:this.sourceCoords.height}),this.inner.adopt(this.source),this.parent(t)},hide:function(t){this.parent(t),this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"})},position:function(){var t=parseInt(this.container.getStyle("borderTopWidth").replace(/px/,"")),e=parseInt(this.container.getStyle("borderLeftWidth").replace(/px/,""));this.container.setStyles({left:this.sourceCoords.left-e,top:this.sourceCoords.top-t,width:this.sourceCoords.width,display:"block"}),this.parent()}});
ta.overlays.PopoutWithOverlay=new Class({Extends:ta.overlays.Overlay,options:{position:"topleft",edge:"topright",offset:{x:-10,y:0},scrollOffset:-20,backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:!0},initialize:function(t,o){this.parent(t,o),this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source),this.popout=new Element("div",{styles:{position:"absolute",zIndex:"10002",fontSize:"0.75em",display:"none"}}).inject(document.body),this.options.showCloseButton&&this.closeBtn.addEvent("click",this.hide),this.show()},show:function(t){this.parent(t);var o=this.source.getCoordinates();this.placeholder.setStyles({width:o.width,height:o.height,marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop}),this.popout.setStyles({left:o.left,top:o.top,width:o.width,display:"block"}).adopt(this.source)},hide:function(t){this.parent(t),this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"}),this.popout.setStyle("display","none")},position:function(){var t=this.source.getCoordinates();this.container.setStyles({left:null,top:t.top+this.options.offset.y,right:window.getWidth()-(t.left+this.options.offset.x)}),this.parent(),window.scrollTo(0,t.top+this.options.offset.y+this.options.scrollOffset)}});
ta.overlays.CoverOverlay=new Class({Extends:ta.overlays.Overlay,options:{autoShow:!0,xOff:0,yOff:0},initialize:function(t,o){this.parent(t,o),this.options.showCloseButton&&this.closeBtn.addEvent("click",this.hide),this.options.autoShow&&this.show()},position:function(){var t=this.source.getCoordinates(),o=this.container.getCoordinates();this.container.setStyles({left:t.left+(t.width/2-o.width/2)+this.options.xOff,top:t.top+(t.height/2-o.height/2)+this.options.yOff})},updateBackdrop:function(){var t=this.source.getCoordinates();this.backdrop.setStyles({left:t.left,top:t.top,width:t.width,height:t.height})}});
ta.overlays.SpecialDropDownWithRangeOverLay=new Class({Extends:ta.overlays.RelativeOverlayBelow,options:{onClose:!1,onShow:!1},initialize:function(t,o){var i=["vrPriceMinDropDown","vrPriceMaxDropDown","vrPricePeriodDropDown"],e="";o.id&&i.contains(o.id)&&(e="vrPriceDropDown"),this.parent(Object.merge({below:!0,innerDivClass:"",style:e,autoShow:!1},t),o),this.container.removeClass("relative"),t.onClose&&(this.options.onClose=t.onClose),t.onShow&&(this.options.onShow=t.onShow)},show:function(t){if(this.visible)return void this.hide();try{this.options.onShow()}catch(t){}var o=t.srcElement?t.srcElement:t.target;o&&(this.source=o),this.options.sourceId&&(this.source=ta.id(this.options.sourceId),this.source.addClass("selected"));for(var i=ta.select(".overlay"),e=0;e<i.length;e++){var s=i[e];if(s.contains(this.source))var n=s}n&&this.container.setStyle("z-index",n.getStyle("z-index")+1),document.addEvent("click",this.hide),this.parent(t)},hide:function(t){if(this.options.onClose)try{this.options.onClose()}catch(t){}if(this.options.rangeInputClass)try{if(this.options.closeOnlyIfClick&&!t)return;if(this.container.getElements("."+this.options.rangeInputClass)[0].contains(t.target))return}catch(t){}this.hideNow()},hideNow:function(t){this.options.sourceId&&this.source.removeClass("selected"),document.removeEvent("click",this.hide),this.parent()},position:function(){var t=this.source.getPosition();this.container.setStyles({left:t.x+this.options.xOffset?this.options.xOffset:0,top:t.y+this.options.yOffset?this.options.yOffset:0}),this.parent()}});
ta.overlays.StaticOverlay=new Class({Extends:ta.overlays.RelativeOverlay,initialize:function(t,i){this.parent(Object.merge({autoShow:!1},t),i),this.container.removeClass("relative")},position:function(t){this.container.position({position:"center",offset:{x:this.options.offsetX||0,y:this.options.offsetY||0}}),this.parent()},hide:function(t){if(null!=t){var i=t.srcElement?t.srcElement:t.target;if(!this.container.contains(i)){if(this.options.childrenOverlays)for(var e=0;e<this.options.childrenOverlays.length;e++){var n=this.options.childrenOverlays[e],s=n.container||ta.select(n)[0];if(s&&s.contains(i))return}this.parent()}}}});
ta.overlays.filters||(ta.overlays.filters={}),ta.overlays.filters.CheckboxOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,Binds:["nonSourceHide","doOnInit","buildContent"],options:{showCloseButton:!1,activate:ta.overlays.ACTIVATE_CLICK,style:"date_picker_calendar",multiSelect:!0,autoShow:!1,delayShow:!0,noPadding:!0,keepElementInDocument:!0,filterType:"",closeOnSelect:!0},initialize:function(e,t){var i=Object.merge(this.options,e);this.input=document.getElement(".hotel_filter_wrap ."+i.filterType),this.parent(i,this.input),this.source.removeEvent("click",this.show),this.setupStandardBehavior(),this.doOnInit()},setupStandardBehavior:function(){this.input.overlay=this,this.container&&(this.parentOverlay=this.container.getParent(".overlay"),this.parentOverlay&&(this.parentOverlay=this.parentOverlay.overlay,this.options.isChild=!0))},doOnInit:function(){this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType)},buildContent:function(e,t){var i=ta.retrieve("hac.data.object"),a=document.createDocumentFragment();if(i&&i.filters){var n=i.filters[t];if(n){var s=document.createElement("ul"),l=n.options.length;s.className="hacFilterItems "+n.hacName,l>8&&(s.className=s.className+" manyItems"),a.appendChild(s);var r=this;Array.each(n.opr,i)})}e.empty().appendChild(a)}},addCheckboxItem:function(e,t,i,a,n,s){var l="";n.isItemDisabled(i)&&(l="disabled");var r="";""!=l&&(r="disabled=''");var c=new Element("li");c.className="hacFilterItem";var o="",h="showUnavailable"==t;h&&(o="showUnavailable"),(l||h)&&(c.className=c.className+" "+l+" "+o),0!=i.value||h||(c.className=c.className+" default");var d=t;if(n.isItemDisabled(i)||c.addEvent("click",function(a){return function(){n.dataItemClick.call(n,c,e.hacName,d,ta.hac.filters.getItemValue(i,t))}.delay(10),!1}),h){var u=new Element("hr");a.appendChild(u)}a.appendChild(c);var m="";h?1==i.value&&(m="checked=checked"):n.isCheckboxItemSelected(s.selected,e.hacName,i.value)&&(m="checked=checked");var p=n.getItemDisplayFragment(i,t),v=e.hacName+"_"+i.value,f="";h?v=e.hacName:f="<span class='itemCount'>("+i.count+")</span>",c.innerHTML="<input type='checkbox' id='"+v+"' class='"+v+" "+l+"' "+m+" "+l+" /><span class='dataItem "+l+"'>"+p+f+"</span>"},dataItemClick:function(e,t,i,a){var n;ta.has("hac.filter.click.timeout")&&(ta.remove(ta.hac.filters.getHacFilterTimeoutKey()),clearTimeout(ta.remove("hac.filter.click.timeout"))),this.fixCheckboxesInFilter(e),n=ta.hac.filters.updateFilterHash(t,this.getFilterSelections(t));var s=ta.has("persistentFilters.showing")?i+"|persistent_bar":i;if(n){try{var l="click";e&&e.getElement("input")&&!e.getElement("input").checked&&(l="unclick"),"undefined"==typeof pageServlet||"Hotels"!=pageServlet||ta.isMetaHotelsRequest()?ta.trackEventOnPage(ta.hac.filters.getModuleString(this.options.filterType),l,s,a):ta.setEvtCookie(ta.hac.filters.getModuleString(this.options.filterType),l,s,a,"/HACSearch")}catch(e){}var r=this;ta.store("hac.filter.click.timeout",setTimeout(function(){ta.remove("hac.updates.running"),"Hotels"==window.pageServlet&&ta.hac.filters.closeAllActiveFilters(),r.updateHACResults.call(r),ta.remove(ta.hac.filters.getHacFilterTimeoutKey())},2e3)),ta.store(ta.hac.filters.getHacFilterTimeoutKey(),ta.retrieve("hac.filter.changed"))}},updateHACResults:function(){this.options&&this.options.closeOnSelect&&this.hide(),ta.hac.filters.updateResultsFromFilters()},setCloseOnSelect:function(e){this.options&&this.options.closeOnSelect&&(this.options.closeOnSelect=e)},fixCheckboxesInFilter:function(e){var e=ta.id(e);if(e&&!e.hasClass("disabled"))if(e.hasClass("hacFilterItem")&&(e.getElement("input").checked=!e.getElement("input").checked),e.hasClass("default")){var t=e.getParent(".hacFilterItems");t&&Array.each(t.getElements(".hacFilterItem"),function(e){e=ta.id(e),e.hasClass("default")?e.getElement("input").checked=!0:e.getElement("input").checked=!1})}else{var i=!1,t=e.getParent(".hacFilterItems");if(!e.getElement("input").checked){var a=t&&document.getElements(".hacFilterItems input:checked");a&&a.length||(i=!0)}if(t){var n=t.getElement(".default");n&&(n.getElement("input").checked=i)}}},getFilterSelections:function(e){var t=[];t="showUnavailable"==e?document.getElements(".hacFilterItem."+e+" input:checked"):e?document.getElements(".hacFilterItems."+e+" input:checked"):document.getElements(".hacFilterItems input:checked");var i=[];return Array.each(t,function(t){t.id!=e+"_0"?i.push(t.id):"showUnavailable"==e&&i.push("showUnavailable")}),i},addExpandableItem:function(e,t){var i=document.createDocumentFragment(),a=new Element("li");a.className=e+" expandFilterItem",i.appendChild(a);var n=document.createElement("div");n.className="nameItem sprite-filter-expand",ta.has("filterNames."+e)?n.innerHTML=ta.retrieve("filterNames."+e):ta.has("hotels.currencies")&&"currencies"==e?n.innerHTML=ta.retrieve("hotels.currencies")[0]:n.innerHTML=e;var s=new Element("div");s.className="toggleItem",a.appendChild(n),a.appendChild(s);var l=this;a.addEvent("ce,a)}),t.appendChild(i)},expandableClick:function(){},getItemDisplayFragment:function(e,t){return ta.hac.filters.getItemDisplayFragment(e,t,this.isItemDisabled(e))},isCheckboxItemSelected:function(e,t,i){if(!e)return!1;var a=t+"_"+i,n=e.cb;if(0!=i){if(n&&n.contains(a))return!0}else{var s=!1;if(n&&Array.each(n,function(e){e.indexOf(t)!=-1&&(s=!0)}),!s)return!0}return!1},isItemDist>0)},destroy:function(){this.parent(),this.input.overlay=null},nonSourcde()},show:function(e){var t=this.visible;if(this.parent(e),document.removeEvent("click",this.hide),document.addEvent("click",this.nonSourceHide),"more"!=this.options.filterType&&this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType),!t){this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK&&(this.tempPin=!this.parentOverlay.pinned,this.tempPin&&this.parentOverlay.pin()),ta.has("persistentFilters.showing")&&tabletOnFullSite&&this.container&&this.container.setStyle("position","fixed");var i=document.getElement(".hotel_filter."+this.options.filterType),a=document.getElement(".date_picker_calendar."+this.options.filterType);if(ta.util.i18n.isRtl()){var n=i.getCoordinates().width,s=a.getCoordinates().width;this.options.offsetLeft=s-n}else this.options.offsetLeft=0;return this.position(),this}},hide:function(e){this.visible&&(document.removeEvent("click",this.nonSourceHide),this.parent(e),this.parentOverlay&&this.tempPin&&(this.tempPin=!1,this.parentOverlay.unpin()))}});
ta.overlays.filters.ClassOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"hotel_class"},initialize:function(e,s){this.parent(e,s)}});
ta.overlays.filters.RatingOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"traveler_rating"},initialize:function(e,t){this.parent(e,t)}});
ta.overlays.filters.PriceOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"price"},initialize:function(e,t){this.parent(e,t)},doOnInit:function(){this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType),ta.has("hotels.currencies")&&this.addExpandableItem("currencies",this.inner.getElement(".hotelFilterContent")),this.addShowUnavailableCheckbox(this.inner.getElement(".hotelFilterContent"))},expandableClick:function(e,t){var a=t.getElement(".toggleItem");if(a&&""!=a.innerHTML)a.innerHTML="",ta.id(t).getElement(".nameItem")&&ta.id(t).getElement(".nameItem").removeClass("sprite-filter-collapse").addClass("sprite-filter-expand");else{this.buildCurrencyContent(t.getElement(".toggleItem"),"currencies");var n=ta.id(t).getParent(".expandFilterItems");if(n){var r=n.getElements("li");r&&Array.each(r,function(e){e=ta.id(e);var t=e.getElement(".nameItem");if(!e.hasClass("currencies")&&t&&t.hasClass("sprite-filter-collapse")){var a=e.getElement(".toggleItem");a&&(a.innerHTML=""),t.removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}})}ta.id(t).getElement(".nameItem")&&ta.id(t).getElement(".nameItem").removeClass("sprite-filter-expand").addClass("sprite-filter-collapse")}},show:function(){ta.has("ta.calendar.isPriceOverlayCalendar")||(this.parent(),ta.has("hotels.currencies")&&this.addExpandableItem("currencies",this.inner.getElement(".hotelFilterContent")),this.addShowUnavailableCheckbox(this.inner.getElement(".hotelFilterContent")))},nonSourceHide:function(e){this.source.containsEvent(e)||this.inner.containsEvent(e)||this.hide()},addShowUnavailableCheckbox:function(e){var t=ta.retrieve("hac.data.object");if(t&&t.filters){var a={hacName:"showUnavailable"},n=this,r=t.selected.showUnavailable,i=ta.retrieve("filterNames.showUnavailable"),l={label:i,count:1,value:r?1:0};n.addCheckboxItem(a,"showUnavailable",l,e,n,t)}},buildCurrencyContent:function(e){var t=document.createDocumentFragment(),a=document.createElement("ul"),n=ta.retrieve("hotels.currencies");if(n){var r=n.length;a.className="hacFilterItems currency",r>8&&(a.className=a.className+" manyItems"),t.appendChild(a);var i=this;Array.each(n,function(e,t){var n=new Element("li");n.className="hacFilterItem",n.addEvent("click",function(t){ri,e)}.delay(10),!1}),a.appendChild(n);var r=i.getItemDisplayFragment(e,"currencies");n.innerHTML="<span class='dataItem'>"+r+"</span>"})}e.innerHTML="",e.appendChild(t)},currencyItemClick:function(e){ta.commerce.meta.clearStoredMiniData(),e.test(/[A-Z]{3}/)&&(ta.store("ta.commerce.MetaHacOverlay.currency",e),new Request({url:"/ActionRecord?action=MetaCurrencyPicker"}).send(),ta.trackEventOnPage("MetaCurrencyPicker","selected",e,1),ta.hac.filters.changeCurrency()),this.hide&&this.hide()},showCalendarLightbox:function(e){var t=ta.hac.filters.getModuleString(this.options.filterType),a="open_calendar",n="price";ta.trackEventOnPage(t,a,n,0,!1);var r=ta.retrieve("ta.overlays.filters.PriceOverlay.showCalendarLightbox");"function"==typeof r?r():this.buildCalendarLightbox(e)},calendarLightBoxOverlay:null,buildCalendarLightbox:function(e,t){var a;if(a=ta.id("PriceFilterCalendarOverlayContent")){a.show();var n={style:"priceFilterCalendarOverlay",innerDiv:"skv3",content:a,autoShow:!1,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",onShow:function(){ta.remove("ta.calendar.isOutDateTrigger"),ta.store("ta.calendar.isPriceOverlayCalendar",!0);var e=null,t=document.getElement("date_picker_in_PriceFilterCalendar");setTimeout(function(){ta.overlays.Factory.loadDatePicker(e,t,"PriceFilterCalendar","",ta.servlet.HACSearch.doMetaDateSearch)},100),this.calendar&&this.calendar.reposition()},onClose:function(){ta.remove("ta.calendar.isOutDateTrigger"),ta.remove("ta.calendar.isPriceOverlayCalendar")},oar")}},r=ta.id("HEADING"),i=new ta.overlays.CenteredOverlay(n,r);ta.store("ta.overlays.filters.PriceOverlay.showCalendarLightbox",function(){i.show()})}},buildContent:function(e,t){ta.retrieve("meta.hotels_no_prices")&&!ta.widgets.calendar.hasPageDates()?this.showCalendarLightbox(e):this.parent(e,t)}});
ta.overlays.filters.NeighborhoodOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"neighborhood"},initialize:function(e,i){this.parent(e,i)}});
ta.overlays.filters.AmenitiesOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"amenities"},initialize:function(e,i){this.parent(e,i)}});
ta.overlays.filters.BrandOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"hotel_brand"},initialize:function(e,a){this.parent(e,a)},getItemDisplayFragment:function(e){return"undefined"!=typeof brandMappings?"<span class='itemLabel'>"+brandMappings[e.value]+"</span>":""}});
ta.overlays.filters.MoreOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"more",moreOptions:""},initialize:function(e,t){e.moreOptions&&(this.displayFilters=e.moreOptions.split(" ")),this.parent(e,t)},doOnInit:function(){var e=document.createDocumentFragment(),t=new Element("ul");t.className="expandFilterItems more",e.appendChild(t),this.inner.getElement(".hotelFilterContent").innerHTML="",this.inner.getElement(".hotelFilterContent").appendChild(e),moreOvly=this,Array.each(this.displayFilters,function(e){var i=ta.retrieve("hac.data.object");if(i&&i.filters){var n=i.filters[e];n&&n.options.length>0&&moreOvly.addExpandableItem.call(moreOvly,e,t)}})},nonSourceHide:function(e){this.source.containsEvent(e)||this.inner.containsEvent(e)||this.hide()},expandableClick:function(e,t){var i=ta.has("persistentFilters.showing")?e+"|persistent_bar":e,n=t.getElement(".toggleItem");if(n&&""!=n.innerHTML)n.innerHTML="",ta.id(t).getElement(".nameItem")&&ta.id(t).getElement(".nameItem").removeClass("sprite-filter-collapse").addClass("sprite-filter-expand"),ta.trackEventOnPage(ta.hac.filters.getModuleString(this.options.filterType),"close",i);else{this.buildContent(t.getElement(".toggleItem"),e);var a=ta.id(t).getParent(".expandFilterItems");if(a){var l=a.getElements("li");l&&Array.each(l,function(t){t=ta.id(t);var i=t.getElement(".nameItem");if(!t.hasClass(e)&&i&&i.hasClass("sprite-filter-collapse")){var n=t.getElement(".toggleItem");n&&(n.innerHTML=""),i.removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}})}ta.id(t).getElement(".nameItem")&&ta.id(t).getElement(".nameItem").removeClass("sprite-filter-expand").addClass("sprite-filter-collapse"),ta.trackEventOnPage(ta.hac.filters.getModuleString(this.options.filterType),"open",i)}}});
ta.overlays.filters.SortOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"sort"},initie,a)},addCheckboxItem:function(e,a,t,l,i,n){var r=new Element("li");r.className="hacFilterItem",0==t.value&&(r.className=r.className+" default");var s=this;r.addEvent("click",function(e){return"WidgetEmbed"==window.pageServlet?(ta.hac.filters.changeSort(t.value),ta.trackEventOnPage(ta.hac.filters.getModuleString(s.options.filterType),"click",t.value)):ta.pages.hac.hacSortChangedToValue(t.value),s.hide(),!1}),l.appendChild(r);var c=i.getItemDisplayFragment(t,a);t.value;r.innerHTML="<span class='dataItem'>"+c+"</span>"}});
var TRANSLATION_STRING_NUMBER_ROOMS_KEY="rgPicker.nRooms",TRANSLATION_STRING_NUMBER_GUESTS_KEY="rgPicker.nGuests";!function(e,t,s,r){"use strict";var a="GuestRoomSelector",n="grp-rooms",o="grp-guests",i="grp-update",l="-value",u="rooms_guests_picker_update_da",c=function(e,t,r){var n=e.replace("grp-",""),o=t+"_"+n;s.trackEventOnPage(a,o,null,r)},d=function(){s.trackEventOnPage(a,"update_click")},v=function(e){var t=e&&e.target&&$(e.target).getParent(".date_picker_calendar");return null!=t};s.overlays.GuestsRoomsOverlay=new Class({Extends:s.overlays.RelativeOverlayBelow,Binds:["nonSourceHide","hideByClickOnDocument"],options:{showCloseButton:!1,activate:s.overlays.ACTIVATE_CLICK,multiSelect:!0,autoShow:!1,delayShow:!0,noPadding:!0,keepElementInDocument:!0,closeOnSelect:!1},callback:null,selectionModified:!1,findTargetFunction:!1,initialize:function(e,t){this.callback=e.moreOptions.callback,e.guestsRoomsData&&this.saveData(e.guestsRoomsData),this.buildContent(e),this.input=e.moreOptions.input,this.findTargetFunction=e.moreOptions.findTargetFunction;var s=Object.merge(this.options,e);this.parent(s,this.input),this.source.removeEvent("click",this.show),this.setupStandardBehavior()},setupStandardBehavior:function(){this.input.getParent(".overlay")&&(this.parentOverlay=this.input.getParent(".overlay").overlay,this.options.isChild=!0)},getData:function(){return s.widgets.calendar.getGuestsRoomsPickerData()},saveData:function(e){s.store("guests.rooms.object",e),s.fireEvent("onLegacyGuestsChanged",e)},resetData:function(){var e={rooms:1,guests:2};return this.saveData(e),e},updateSessionGuestsRooms:function(e){var t;if(s.widgets.calendar.hasPageDates())t=s.widgets.calendar.getCheckRatesData();else{var r=this.getData();t={"rooms":r.rooms,"adults":r.guests}}var a=this;new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(t),method:"post",onSuccess:function(){a.runCallback(e),s.fireEvent("onLegacyGuestsChanged",s.retrieve("guests.rooms.object"))}}).send()},runCallback:function(e){this.callback&&"function"==typeof this.callback&&s.widgets.calendar.hasPageDates()&&this.callback(e)},getTranslationString:function(e){var t,r=this.getData();return e===n?(t=r.rooms,this.grabWordForLabel(t,s.retrieve(TRANSLATION_STRING_NUMBER_ROOMS_KEY))):e===o?(t=r.guests,this.grabWordForLabel(t,s.retrieve(TRANSLATION_STRING_NUMBER_GUESTS_KEY))):e===i?s.retrieve(u):void 0},getCounter:function(e){var t,s=this.getData();return e==n?t=s.rooms:e===o&&(t=s.guests),t},buildContent:function(e){var t=new Element("ul");t.className="guests_rooms_overlay";var s=this.buildButtonLine(n);t.appendChild(s);var r=this.buildButtonLine(o);t.appendChild(r);var a=this.buildUpdateLine();t.appendChild(a),e.content=t},buildButtonLine:function(e){var t=this.getCounter(e),s=this.getTranslationString(e),r=new Element("li");r.className="line",r.id=e;var a=new Element("div");a.className="signButton minusButton",1===t&&(a.className+=" disabled"),a.setContent("-");var i=this;a.addEvent("c,!0)});var l=new Element("div");l.className="numberLabelText",l.setContent(s);var u=new Element("div");return u.className="signButton plusButton",e===n&&t>7?u.className+=" disabled":e===o&&t>31&&(u.className+=" disabled"),u.setContent("+"),u.addEvent("con()}),r.appendChild(a),r.appendChild(l),r.appendChild(u),r},processDecrementCounter:function(e,t){var s,r=this.getData();if(e===n){if(r.rooms<=1)return;for(r.rooms-=1,s=r.rooms,this.saveData(r),this.updateOverlay(e);r.guests/4>r.rooms;)this.processDecrementCounter(o)}else if(e===o){if(r.guests<=1)return;r.guests-=1,s=r.guests,this.saveData(r),this.updateOverlay(e);var a=r.guests<r.rooms;a&&this.processDecrementCounter(n)}t&&c(e,"subtract",s)},processIncrementCounter:function(e,t){var s,r=this.getData();if(e===n){if(r.rooms>7)return;r.rooms+=1,s=r.rooms,this.saveData(r),this.updateOverlay(e);var a=r.rooms>r.guests;a&&this.processIncrementCounter(o)}else if(e===o){if(r.guests>31)return;r.guests+=1,s=r.guests,this.saveData(r),this.updateOverlay(e);var a=r.guests/4>r.rooms;a&&this.processIncrementCounter(n)}t&&c(e,"add",s)},updateOverlay:function(e){var t=this.buildButtonLine(e),r=s.id(e);r.parentNode.replaceChild(t,r),this.selectionModified=!0,this.updateCounterElement(e)},updateCounterElement:function(e){var t=this.getCounter(e),r=$$("."+e+l);rML=t}),e===n?(s.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".roomsGuestsButton.roomsButton",t),s.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".stayInfoContainer.rooms",t)):e===o&&(s.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".roomsGuestsButton.guestsButton",t),s.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".stayInfoContainer.guests",t))},buildUpdateLine:function(){var e=this.getTranslationString(i),t=new Element("li");t.className="line update",t.id=i;var s=new Element("div");s.className="updateButton rndBtn rndBtnGreen";var r=this;s.addEvent("click",function(e){r.processUpdate(e),r.hide(),d()});var a=new Element("div");a.className="ui-btn-inner";var n=new Element("div");return n.className="ui-btn-text",n.setContent(e),a.setContent(n),s.setContent(a),t.setContent(s),t},processUpdate:function(e){return this.selectionModified?(this.selectionModified=!1,void this.updateSessionGuestsRooms(e)):void(this&&this.parentOverlay&&this.parentOverlay.visible&&s.widgets.calendar.hasPageDates()&&this.parentOverlay.hide())},denull},nonSourceHide:function(e){this.source.containsEvent(e)||e.target.className.contains("signButton")||this.hide(e)},hideByClickOnDocument:function(e){this.parentOverlay&&this.parentOverlay.visible||this.hide(e)},show:function(t){var r,a=this.visible;if(this.parent(t),e.removeEvent("click",this.hide),e.addEvent("click",this.nonSourceHide),e.removeEvent("click",this.hideByClickOnDocument),$$(".date_picker_calendar").addEvent("click",this.nonSourceHide),r=this.findTargetFunction(t),r&&(this.source=r),s.widgets.calendar.syncAllDatePickers(),a)return void this.hide(t);this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==s.overlays.PINNABLE_CLICK&&(this.tempPin=!this.parentOverlay.pinned,this.tempPin&&this.parentOverlay.pin()),this.position();var n=$$(".roomsGuestsButtonWrap .roomsGuests");return n&&n.addClass("disabled"),this},hide:function(t){if(this.visible){e.removeEvent("click",this.nonSourceHide),$$(".date_picker_calendar").removeEvent("click",this.nonSourceHide),this.parent(t),this.parentOverlay&&this.tempPin&&(this.tempPin=!1,this.parentOverlay.unpin());var s=$$(".roomsGuestsButtonWrap .roomsGuests");s&&s.removeClass("disabled"),this.processUpdate(t)}},grabWordForLabel:function(e,t){return t[e]}}),s.overlays.GuestsRoomsOverlay.closeModalAndUpdateCount=function(e){s.trackEventOnPage("PriceFinder_PromptChange",e?"revert":"update");var t=s.find(".ui_modal.increase_rooms_modal");s.find(".ui_backdrop.increase_rooms_modal_backdrop");if(!e){var r={rooms:1,guests:2,child_rm_ages:""};r.rooms=s.overlays.GuestsRoomsOverlay.roomsNew,r.guests=s.overlays.GuestsRoomsOverlay.guestsNew,r.child_rm_ages=s.overlays.GuestsRoomsOverlay.child_rm_ages_old||"",s.store("guests.rooms.object",r),s.overlays.NumberPickerOverlay.updateHeaderMsg(".metaDatePicker",t);var a=s.find(".change_dates_button");a&&s.servlet.HACSearch.doMetaDateSearch(null,a)}},s.overlays.GuestsRoomsOverlay.trackPickerClick=function(e){v(e)?s.trackEventOnPage(a,"select_guest_room_calendar"):s.trackEventOnPage(a,"select_guest_room")};var h;s.overlays.GuestsRoomsOverlay.open=function(e,t,r,a){var n=h;if(!n){s.has("guests_rooms_picker_3.enabled")?a.input=s.find(".calendar_wrapper .guests_rooms_picker_container"):a.input=s.find(".guests_rooms_picker_container"),a.findTargetFunction=function(e){return!s.has("guests_rooms_picker_3.enabled")||s.has("guests_rooms_picker_4.enabled")||s.has("hotels_rgpicker_outofcalendar")?e&&e.target?s.id(e.target).getParent(".roomsGuests"):void 0:s.find(".date_picker_calendar.overlay .wrapper_header .roomsGuests")};var o={style:"date_picker_calendar guests_rooms_overlay",moreOptions:a};n=new s.overlays.GuestsRoomsOverlay(o,t),h=n}n.show(e)}}(document,window,ta),function(e,t,s,r){"use strict";var a={"rooms":{"max":8,"translationKey":TRANSLATION_STRING_NUMBER_ROOMS_KEY,"tracking":"RoomSelector"},"guests":{"max":32,"translationKey":TRANSLATION_STRING_NUMBER_GUESTS_KEY,"tracking":"GuestSelector"}},n=4,o=function(e,t){if(t=s.id(t)){var r=t.getWidth();e&&e.container&&r>e.container.getWidth()&&e.container.setStyle("width",r-2)}},i=function(e,t,r){var n=a[r],i={type:r,labels:s.retrieve(n.translationKey),maxValue:n.max,target:t,tracking:n.tracking},u=l(r),c=s.retrieve(u)||new s.overlays.NumberPickerOverlay(i,t);return s.store(u,c),t&&(t.getParent("#hotels_lf_header_bar")||t.getAttribute("data-matchwidth"))&&c&&c.addEvent("onShow",o.bind(this,c,t)),c.show(e),s.fireEvent("showRoomGuestPicker")_"t[ta",e)},v=function(e,t){var r=c(),a=function(e){var t=e.guests/Math.max(e.rooms,1);if(t>n){s.trackEventOnPage("PriceFinder","guest_per_room_exceeded",e.guests,e.rooms);var r=Math.ceil(e.guests/n);if(s.retrieve("priceFinder.noAutoRefresh")){s.overlays.GuestsRoomsOverlay.roomsNew=r,s.overlays.GuestsRoomsOverlay.guestsNew=e.guests;var a=s.find(".roomsAdultsModalLnk"),o=a.getAttribute("data-subheader"),i="";o&&(i=o.replace(/%ROOMS%/g,r)),a.setAttribute("data-subheader",i),a.click();var l=s.find(".increase_rooms_modal .yesUpdate"),u=s.find("#STATIC_DATE_PICKER_BAR .yesTxt");l&&u&&(l.innerHTML=u.innerHTML.replace(/%ROOM%/g,r));var c=s.find(".increase_rooms_modal .subheader_text");return c&&(c.innerHTML=a.getAttribute("data-subheader")),a.setAttribute("data-subheader",o),e.rooms=s.overlays.GuestsRoomsOverlay.roomsOld,e.guests=s.overlays.GuestsRoomsOverlay.guestsOld,e.child_rm_ages=s.overlays.GuestsRoomsOverlay.child_rm_agesOld||"",s.store("guests.rooms.object",e),void s.overlays.NumberPickerOverlay.updateHeaderMsg(".metaDatePicker")}e.rooms=r}else e.rooms>e.guests&&(e.rooms=e.guests)},o=function(e){var t=e.guests/Math.max(e.rooms,1);t>n?e.guests=e.rooms*n:e.rooms>e.guests&&(e.guests=e.rooms)};return r[e]!==t&&(r[e]=t,"rooms"===e?o(r):"guests"===e&&a(r),d(r),!0)};s.overlays.NumberPickerOverlay=new Class({Extends:s.overlays.RelativeOverlayBelow,Binds:["nonSourceHide","hideByClickOnDocument"],options:{activate:s.overlays.ACTIVATE_CLICK,style:"numberPickerOverlay",multiSelect:!1,autoShow:!1,delayShow:!1,noPadding:!0,keepElementInDocument:!0,closeOnSelect:!0,waitForCss:!0},callback:function(){if(s.retrieve("hh_short_cell.enabled"))this.source&&this.source.className&&this.source.className.indexOf("placement_hh")!=-1&&s.commerce.metajson&&s.commerce.metajson.refetchAll();else if("Hotels"==t.pageServlet)s.widgets.calendar.checkDatesMakeHacCallHotels();else{var e=s.retrieve("meta.baseLocationId");s.widgets.calendar.checkDatesMakeHacCallHR(e)}s.retrieve("priceFinder.noAutoRefresh")&&this.source&&this.source.addClass("ready_for_update")},initialize:function(e,s){this.input=e.target,this.buildContent(e),s.getParent("#hotels_lf_header_bar")&&(this.options.style+=" hotels_lf"),s.getAttribute("data-style")&&(this.options.style+=" "+s.getAttribute("data-style"));var r=Object.merge(this.options,e);this.parent(r,this.input),t.addEvent("date_bar_docked",this.position.bind(this)),t.addEvent("date_bar_undocked",this.position.bind(this)),t.addEvent("resize",this.position.bind(this))},buildContent:function(e){var t=new Element("div");t.appendChild(this.buildSelectorRows(e)),e.content=t},buildSelectorRows:function(e){var t,r,a=this,n=new Element("ul"),o=function(t,r){t.addEvent("click",function(t){if(s.retrieve("priceFinder.noAutoRefresh")){var n=c();s.overlays.GuestsRoomsOverlay.roomsOld=n.rooms,s.overlays.GuestsRoomsOverlay.guestsOld=n.guests,s.overlays.GuestsRoomsOverlay.child_rm_ages_old=n.child_rm_ages}var o=v(e.type,r);a.hide(),s.trackEventOnPage(e.tracking,"Select",null,r),o&&a.callback()})};for(n.className="list",r=1;r<=e.maxValue;r++)t=new Element("li"),t.setContent(u(r,e.labels)),t.className="item",o(t,r),n.appendChild(t);return n},resetOves"))},show:function(e){return this.visible?this.hide(e):this.parent&&(this.parent(e),this.position(),s.trackEventOnPage(this.options.tracking,"Open")),this},position:function(){var e=s.id(this.source);if(e&&e.getParent("#PERSISTENT_DATE_PICKER")){var r=e.getCoordinates().left-t.getScrollLeft()-3,a=e.getCoordinates().top-t.getScrollTop()+33;s.id(this.container).setStyles({position:"fixed",left:r+"px",top:a+"px","z-index":9991})}else this.parent()}t(e)}}),s.overlays.NumberPickerOverlay.roomsPicker=function(e,t){return i(e,t,"rooms")},s.overlays.NumberPickerOverlay.guestsPts")},s.overlays.NumberPickerOverlay.updateHeaderMsg=function(e){var t=c(),r=$$(e+" .roomsChange"),a=u(t.rooms,s.retrieve(TRANSLATION_STRING_NUMBER_ROOMS_KEY)),n=$$(e+" .guestsChange"),o=u(t.guests,s.retrieve(TRANSLATION_STRING_NUMBER_GUESTS_KEY)),i=r.getElement("img"),l=i&&i[0]&&i[0].outerHTML||"";r.set("html",a+" "+l),n.set("html",o+" "+l)},s.overlays.NumberPickerOverlay.unhideDropdowns=function(e){var t=$$(e);t&&s.widgets.calendar.hasPageDates()&&t.removeClass("hidden")}}(document,window,ta);
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["pages/inappropriate_vote_stub","ta/util/xpath","t4b/common/blImpTracking","answers/question_overlay_stub"],["ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-overlays","files":{"js3":{"build":{"es6":{"src":{"t4b":{"common":{"blImpTracking":1}}}}},"src":{"pages":{"inappropriate_vote_stub":1},"answers":{"question_overlay_stub":1},"ta":{"util":{"xpath":1}}}}},"_":{"baseUrl":"/"}});
define("ta/util/xpath",["vanillajs"],function(e){var n={};return n.nodePath=function(e){if(!e)return"";for(var n=[e];"undefined"!=typeof e&&e&&"undefined"!=typeof e.parentNode;)n.push(e=e.parentNode);return n=n.map(function(e){if(e&&e.tagName){var n=e.tagName;return e.id&&(n+="#"+e.id),e.className&&(n+="."+e.className),n}return""}),n.reverse().join(">").replace(/\s+/g,".")},n});
define("t4b/common/blImpTracking",["babel/babel-helpers","lib/jquery-amd","ta/Core/TA.Record","ns-exporter"],function(t,e,i,n){function a(t,e,i,n){if(t&&(t.hasAttribute("data-imp")||(t=t.getParent("[data-imp]")),t)){var a=t.getAttribute("data-imp");o(a,e,i,n)}}function r(t,e,i){if((!e||e<=0)&&(e=1),t){for(var n=t.querySelectorAll(".impression"),a=0;a<n.length;a++){var r=n[a];if(r&&"none"!==r.style.display&&(r.offsetHeight>0||r.offsetWidth>0||r.selected)&&r.getAttribute("data-imp")){var o=i?i(r.getAttribute("data-imp")):parseInt(r.getAttribute("data-imp"),10);o>0&&s(o,e)}}p()}}function s(t,e){t&&l.push({impressionId:t,locationId:e})}function o(t,e,n,a){a?i.setEvtCookie("IMP"+t,e,n,0,a):i.trackEventOnPage("IMP"+t,e,n)}function p(){l.length>0&&(e.post("/BLImpRecord",{blImpsById:JSON.stringify(l)}),l=[])}function c(t,e){t&&e&&t.hasClass("impression")&&t.setAttribute("data-imp",e)}function m(t,e){t in u||(u[t]=!0,s(t,e),p())}var l=[],u={},f={trackClickByImpId:a,logImpressionsInDiv:r,queueImpression:s,trackClick:o,flushImpressions:p,setDataImp:c,trackImpressionOnlyOnce:m};return n.exportTo(f,"ta.t4b.bl_imp_tracking"),f});
define("answers/question_overlay_stub",["vanillajs","api-mod","ta/util/Error","ta/Core/TA.Store","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax"],function(n,e,o,r,i,s,t,a,l,c,d){"use strict";var v={},u={};return v.open=function(n,e){e||o.record(new TypeError("pid required for questionForm overlay"),"Question and Answers - questionForm",null,null,"WARN");var v=new i(null,[s(null,"center","answersOverlay"),t.center([0,0]),a,l,c(),d("/AnswersAjax",{reqParams:{act:"saqo",lcid:n,altsessid:r.retrieve("altsessid")||""}})]);v.on("show",r.store.bind(r,"answers.pid.overlayType",e)),v.on("hide",function(){r.remove("answers.pid.overlayType"),v.destroy(),v=null}),v.show()},v.confirmDlg=function(n){var o=n.data.type,r=u[o];if(r)r.options=n,r.overlay.show();else{var a=new i(null,[s(null,"center","confirmationPrompt small"),t.center([0,0]),l,c(),d("/AnswersAjax",{reqParams:n.data})]);u[o]={overlay:a,options:n,attached:!1};var v=function(){var n=u[o];return n.options.onConfirm&&n.options.onConfirm(),n.overlay.hide(),!0},y=function(){var n=u[o];return n.options.onCancel&&n.options.onCancel(),n.overlay.hide(),!1},f=!1,p=function(){if(!f){var n=e.find(".cancelBtn",this.inner),o=e.find(".confirmBtn",this.inner);n&&(e.addEvent(n,"click",y),e.addEvent(o,"click",v),f=!0)}}.bind(a);a.on("contentLoaded",p).on("show",p).on("hide",function(){e.removeEvent(e.find(".cancelBtn",this.inner),"click",y),e.removeEvent(e.find(".confirmBtn",this.inner),"click",v),f=!1}),a.show()}},v});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/common/behavior/Ads-pagemoniker","ta/registration/RegOverlay"],["ta","ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-registration-RegOverlay","files":{"js3_secure":{"ssl":{"ta":{"common":{"behavior":{"Ads-pagemoniker":1}}}}},"js3":{"src":{"ta":{"registration":{"RegOverlay":1}}}}},"_":{"baseUrl":"/"}});
define("mixins/page-dates/DateEvents",["mixins/Events","common/Radio"],function(E,e){"use strict";var n={DATE_SELECTED:"dateSelected",CALENDAR_OPENED:"calendarOpened"},t=new E(n.DATE_SELECTED,n.CALENDAR_OPENED);return e("wcDateEventsRadio").on(n.DATE_SELECTED,function(){Array.prototype.unshift.call(arguments,n.DATE_SELECTED),t.emit.apply(t,arguments)}),t});
define("common/pixels-loader",["vanillajs","mixins/page-dates/DateEvents","ta/Core/TA.FireEvent"],function(n,o,i){"use strict";function e(){return Date.now()-r}function t(n){console.log("pixels-loader: "+e()+" "+n)}var a,r,c=2e3,l=!1;r=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:Date.now();var s=function(){l&&t("_load starting"),window.require(["trjs!ta/common/behavior/Ads-pagemoniker"],function(n){l&&t("Ads-pagemoniker starting"),n.loadMonikers(),o.on("dateSelected",function(o,i){"STAYDATES"==i&&window.setTimeout(n.loadMonikerForEnterDates,2e3)})}),a&&a.shouldInitFlightsEvents&&n(){}},u=function(){var n=new Promise(require.bind(null,["trjs!ta/common/behavior/Ads-pagemoniker"]));i.on("lcbPop",function(){n.then(function(n){n.loadMonikerForLCBPop()})}),i.on("packageClick",function(){n.then(function(n){n.loadVacationPackageMetaMonikers()})}),i.on("metaLinkClickPixelLoad",function(o){n.then(function(n){n.loadFlightsMetaMonikers(o)})}),i.on("metaLightboxo)})}),i.on("flightSearchPixel()})})};return{init:function(n){a=n,n&&n.pixelsEnabled&&(n.pixelLoadingTracing&&(l=!0),n.hotelsPixelLoadingStrategyEnabled?(l&&t("init: setting timeout of zero before running _load"),setTimeout(s,0)):(l&&t("init: setting timeout"),setTimeout(s,c)))},remarketingOprn a}}});
define("ta/common/behavior/Ads-pagemoniker",["vanillajs","ns-exporter","common/trackingStreams","ta/Core/TA.Store","common/pixels-loader","ta/util/Element","ta/Core/TA.FireEvent"],function(e,o,r,n,t()-T}function _(e){console.log("ads-pagemoniker: "+a()+" "+e)}var u={};u.remarketingOptions=t.remarketingOptions()||{};var T,s=function(){return new Promise(function(e){window.require(["@ta/platform.runte)})})})},d=function(e){return void 0===u.remarketingOptions.pixelsEnabled&&(u.remarketingOptions=t.remarketingOptions()||{}),u.remarketingOptions[e]},M={OFFER_VIEW:"Monikers_OV",HAC_PRICES_LOADED:"Monikers_HPL",RESTAURANTS_OFFLINE_ATTRIBUTION:"Monikers_ROA",RESTAURANTS_PRODUCT_SELECTION:"Monikers_RPS",RESTAURANTS_PRODUCT_PAYMENT:"Monikers_RPP",RESTAURANTS_PRODUCT_CONVERSION:"Monikers_RPC",RESTAURANTS_NEW_REG_OWNER_FORM:"Monikers_NRO",RESTAURANTS_CONF_REG_OWNER:"Monikers_CRO",MEMBER_REGISTRATION_FORM:"Monikers_MRF",HOTEL_CLAIM_FORM_SUBMISSION:"Monikers_HCFS",STARTER_PACKAGES_PAGE_VIEW:"Monikers_SPPV",STARTER_PACKAGES_PROPERTY_SELECTION:"Monikers_SPPS",HOTELS_PRODUCT_CART_INITIATE_CHECKOUT:"Monikers_HPCIC",HOTELS_PRODUCT_CART_ADD_PAYMENT_INFO:"Monikers_HPCAP",HOTELS_PRODUCT_CART_PURCHASE:"Monikers_HPCPP",UPP_HOTELS_PRODUCT_CART_INITIATE_CHECKOUT:"Monikers_UPP_HPCIC",UPP_HOTELS_PRODUCT_CART_ADD_PAYMENT_INFO:"Monikers_UPP_HPCAP",UPP_HOTELS_PRODUCT_CART_PURCHASE:"Monikers_UPP_HPCPP",FACEBOOK_MC_RETARGETING:"Monikers_FMCR",PAID_FUNNEL_LEAD_CONVERSION:"Monikers_PFLC",MEMBER_CREATE:"Monikers_MC",SAVE_TO_TRIP:"Monikers_STT",SAVE_TO_TRIP_INTENT:"Monikers_STTI",PLUS_CONFIRM:"Monikers_PLUS_Confirm",PLUS_CHECKOUT:"Monikers_PLUS_Checkout",HOTELS_RECOVERY_PACKAGE_AD_LANDER:"Monikers_HRPAL",LINKEDIN_INSIGHT_TAG:"Monikers_LII_T",RESTAURANT_PRODUCT_SELECT_LISTING:"Monikers_RPSL",RESTAURANT_PRODUCT_SELECT_PRODUCT:"Monikers_RPSP",RESTAURANT_PRODUCT_PURCHASE:"Monikers_RP_PURCHASE",MENU_CONNECT_SELECT_LISTING:"Monikers_MCSL",MENU_CONNECT_SELECT_PRODUCT:"Monikers_MCSP",MENU_CONNECT_ORDER_CONFIRMATION:"Monikers_MCOC",LINKEDIN_CALL_WITH_CONVERSION_ID:"Monikers_LICWCI",YOUTUBE_CLAIM_LISTING_HOTEL:"Monikers_YCLH",YOUTUBE_SELECT_PRODUCT:"Monikers_YSP",YOUTUBE_ORDER_CONFIRMATION:"Monikers_YOC"},C=function(e){return"RESTAURANTS_OFFLINE_ATTRIBUTION"===e?M[e]+"_"+Math.floor(Math.random()*Math.floor(1e6)):M[e]},P="dates.enter.moniker.fired",c="hotel.prices.moniker.fired",E=!1,R=30,k="loc1",O="@@@loc1@@@",S="locId",A=10,I=1e3,p=function(){function e(){var r="",t="[data-pernight][data-locationid='"+n[a]+"']",u="[data-index][data-locationid='"+n[a]+"']",T=document.body.querySelector(t),s=document.body.querySelector(u);_<A&&!T?(_++,window.setTimeout(e,I)):(_<A&&(r=T.getAttribute("data-pernight")||""),s&&s.getAttribute("data-automation")&&s.getAttribute("data-automation").startsWith("plus-hotel-offer")&&l++,i.push(r),o=!0)}var o=!1;if(d("hotelPricesEnabled")){var r=d("pixelContext");if(r){var n,t=r.servlet,i=[];"Hotel_Review"===t?n=[r.curLocId.toString()]||"":(n=r.locIds||"",n=n.split(",").slice(0,R));for(var l=0,a=0;a<n.length;a++)if(n[a]){var _=0;e()}r.locPrices=i.join(","),r.plusCount="Hotel_Review"===t||"HotelHighlight"===t?document.body.querySelector("#OPTIMUS_OFFER")?1:0:l}}else o=!0;return,!0)},N=!1;T=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:Date.now();var f=function(){if(N&&_("_loadHotelPricesPixels starting"),d("hotelPricesEnabled")){var e=3,o=function(){!F()&&e--&&setTimeout(o,1e3)};o()}};u.loadMonikerForHotelPrices=function(e){var o=!1;return e&&(N=e.pixelLoadingTracing,o=e.hotelsPixelLoadingStrategyEnabled),N&&_("loadMonikerForHotelPrices starting"),o?void setTimeout(f,0):void f()},u.loadMonikers=function(e){try{if(!d("pixelsEnabled"))return null;e=e||{},e.pixelType="PAGEVIEW";var o=d("pixelContext");!o||"HotelBookingRoomSelectionHtml"!=o.servlet&&"MobileHotelBookingRoomSelection"!=o.servlet||(e.pixelType="IB_CLICK",u._addIBPageViewContext(e));var n=u._loadMonikers(e);return d("cacheMobileClickoutResponse")&&(e.pixelType="CLICKOUT",u._cacheClickoutMonikers(e)),n}catch(o){r.error(o,"ads.loadMonikers",null,{context:e})}return null},u.loadMonikerForEnterDates=function(e){try{if(!d("pixelsEnabled"))return null;n.retrieve(P)||(n.store(P,!0),p(),e=e||{},e.pixelType="ENTER_DATES",setTimeout(u._loadMonikers.bind(null,e),2e3))}catch(e){}};var x=function(e){try{if(!d("hotelPricesEnabled"))return null;n.retrieve(c)||(n.store(c,!0),u._loadMonikersForPixelType(e,"HAC_PRICES_LOADED"))}catch(e){}};return u.loadClickoutMonikers=function(e){try{return d("pixelsEnabled")&&d("clickoutPixelsEnabled")?u._cachedClickoutMonikerTextArr?u._appendMonikersIFrameText(u._cachedClickoutMonikerTextArr,e[S]||""):(e=e||{},e.pixelType="CLICKOUT",u._loadMonikers(e)):null}catch(o){r.error(o,"ads.loadClickoutMonikers",null,{context:e})}return null},u.loadLightboxMonikers=function(e,o){try{if(!d("pixelsEnabled"))return null;e=e||{},e.pixelType="LIGHTBOX_CLICK";var n=u._mergeContexts(e,o),t=u._loadMonikers(n);return t}catch(o){r.error(o,"ads.loadLightboxMonikers",null,{context:e})}return null},u.loadLightboxClickoutMonikers=function(e){try{return d("pixelsEnabled")&&d("clickoutPixelsEnabled")?(e=e||{},e.pixelType="LIGHTBOX_CLICKOUT",u._loadMonikers(e)):null}catch(o){r.error(o,"ads.loadLightboxClickoutMonikers",null,{context:e})}return null},u.loadIBClickMonikers=function(e){if(E)return null;var o=u._loadMonikersForPixelType(e,"IB_CLICK");return E=!0,o},u.loadIBRoomSelectMonikers=function(e){return u._loadMonikersForPixelType(e,"IB_ROOM_SELECT")},u.loadIBConfirmMonikers=function(e){return u._loadMonikersForPixelType(e,"IB_CONFIRM")},u.loadVRConfirmMonikers=function(e){return u._loadMonikersForPixelType(e,"VR_CONFIRM")},u.loadFlightsMetaMonikers=function(e){return null!=u._loadMonikersForPixelType(e,"FLIGHTS_META")?u._loadMonikersForPixelType(e,"LIGHTBOX_CLICKOUT"):null},u.loadMonikerForCarsMeta=function(e){return u._loadMonikersForPixelType(e,"CARS_META")},u.loadMonikerForCarsSearchResults=function(e){return u._loadMonikersForPixelType(e,"CARS_SEARCH_RESULTS")},u.loadVacationPackageMetaMonikers=function(e){return u._loadMonikersForPixelType(e,"PACKAGE_META")},u.loadMonikerForLCBPop=function(e){return u._loadMonikersForPixelType(e,"LCB_POP")},u.loadMonikerForFlightsMetaLightbox=function(e){return u._loadMonikersForPixelType(e,"LIGHTBOX_CLICK")},u.loadMonikerForFlightSearch=function(e){return u._loadMonikersForPixelType(e,"SEARCH")},u.loadMonikerForCruiseMeta=function(e){return u._loadMonikersForPixelType(e,"CRUISE_META")},u.loadMonikerForRestaurantsOfflineAttribution=function(e){return u._loadMonikersForPixelType(e,"RESTAURANTS_OFFLINE_ATTRIBUTION")},u.loadMonikerForRestaurantsProductSelection=function(e){return u._loadMonikersForPixelType(e,"RESTAURANTS_PRODUCT_SELECTION")},u.loadMonikerForRestaurantsProductPayment=function(e){return u._loadMonikersForPixelType(e,"RESTAURANTS_PRODUCT_PAYMENT")},u.loadMonikerForRestaurantsProductConversion=function(e){return u._loadMonikersForPixelType(e,"RESTAURANTS_PRODUCT_CONVERSION")},u.loadMonikerForRestaurantsNewRegOwnerForm=function(e){return u._loadMonikersForPixelType(e,"RESTAURANTS_NEW_REG_OWNER_FORM")},u.loadMonikerForRestaurantsConfirmedRegOwner=function(e){return u._loadMonikersForPixelType(e,"RESTAURANTS_CONF_REG_OWNER")},u.loadMonikerForHotelClaimFormSubmission=function(e){return u._loadMonikersForPixelType(e,"HOTEL_CLAIM_FORM_SUBMISSION")},u.loadMonikerForMcRetargeting=function(e){return u._loadMonikersForPixelType(e,"FACEBOOK_MC_RETARGETING")},u.loadMonikerForPaidFunnelConversion=function(e){return u._loadMonikersForPixelType(e,"PAID_FUNNEL_LEAD_CONVERSION")},u.loadMonikerForStarterPackagesPageView=function(e){return u._loadMonikersForPixelType(e,"STARTER_PACKAGES_PAGE_VIEW")},u.loadMonikerForStarterPackagesPropertySelection=function(e){return u._loadMonikersForPixelType(e,"STARTER_PACKAGES_PROPERTY_SELECTION")},u.loadMonikerForHotelsProductCartCheckout=function(e){return u._loadMonikersForPixelType(e,"HOTELS_PRODUCT_CART_INITIATE_CHECKOUT")},u.loadMonikerForHotelsProductCartAddPaymentInfo=function(e){return u._loadMonikersForPixelType(e,"HOTELS_PRODUCT_CART_ADD_PAYMENT_INFO")},u.loadMonikerForHotelsProductCartPurchase=function(e){return u._loadMonikersForPixelType(e,"HOTELS_PRODUCT_CART_PURCHASE")},u.loadMonikerForHotelsRecoveryPackageAdLander=function(e){return u._loadMonikersForPixelType(e,"HOTELS_RECOVERY_PACKAGE_AD_LANDER")},u.loadMonikerForLinkedInInsightTag=function(e){return u._loadMonikersForPixelType(e,"LINKEDIN_INSIGHT_TAG")},u.loadMonikerForUPPHotelsProductCartCheckout=function(e){return u._loadMonikersForPixelType(e,"UPP_HOTELS_PRODUCT_CART_INITIATE_CHECKOUT")},u.loadMonikerForUPPHotelsProductCartAddPaymentInfo=function(e){return u._loadMonikersForPixelType(e,"UPP_HOTELS_PRODUCT_CART_ADD_PAYMENT_INFO")},u.loadMonikerForUPPHotelsProductCartPurchase=function(e){return u._loadMonikersForPixelType(e,"UPP_HOTELS_PRODUCT_CART_PURCHASE")},u.loadMonikerForMemberRegistrationForm=function(e){return u._loadMonikersForPixelType(e,"MEMBER_REGISTRATION_FORM")},u.loadMonikerForCreateMemberSuccessful=function(e){return u._loadMonikersForPixelType(e,"MEMBER_CREATE")},u.loadMonikerForSaveToTripIntent=function(e){return u._loadMonikersForPixelType(e,"SAVE_TO_TRIP_INTENT")},u.loadMonikerForSaveToTrip=function(e){return u._loadMonikersForPixelType(e,"SAVE_TO_TRIP")},u.loadMonikerForRegistration=function(e,o){var r=u._mergeContexts(e,o);return u._loadMonikersForPixelType(r,"REGISTRATION_SUCCESS")},u.loadMonikerForPlusConfirm=function(e){return u._loadMonikersForPixelType(e,"PLUS_CONFIRM")},u.loadMonikerForPlusCheckout=function(e){return u._loadMonikersForPixelType(e,"PLUS_CHECKOUT")},u.loadMonikerForPlusBookingCheckout=function(e){return u._loadMonikersForPixelType(e,"PLUS_BOOKING_CHECKOUT")},u.loadMonikerForPlusBookingConfirmation=function(e){return u._loadMonikersForPixelType(e,"PLUS_BOOKING_CONFIRMATION")},u.loadMonikerForRestaurantProductSelectListing=function(e){return u._loadMonikersForPixelType(e,"RESTAURANT_PRODUCT_SELECT_LISTING")},u.loadMonikerForRestaurantProductSelectProduct=function(e){return u._loadMonikersForPixelType(e,"RESTAURANT_PRODUCT_SELECT_PRODUCT")},u.loadMonikerForRestaurantProductPurchase=function(e){return u._loadMonikersForPixelType(e,"RESTAURANT_PRODUCT_PURCHASE")},u.loadMonikerForMenuConnectSelectListing=function(e){return u._loadMonikersForPixelType(e,"MENU_CONNECT_SELECT_LISTING")},u.loadMonikerForMenuConnectSelectProduct=function(e){return u._loadMonikersForPixelType(e,"MENU_CONNECT_SELECT_PRODUCT")},u.loadMonikerForMenuConnectOrderConfirmation=function(e){return u._loadMonikersForPixelType(e,"MENU_CONNECT_ORDER_CONFIRMATION")},u.loadMonikerForLinkedinCallWithConversionId=function(e){return u._loadMonikersForPixelType(e,"LINKEDIN_CALL_WITH_CONVERSION_ID")},u.loadMonikerForYoutubeClaimListingHotel=function(e){return u._loadMonikersForPixelType(e,"YOUTUBE_CLAIM_LISTING_HOTEL")},u.loadMonikerForYoutubeSelectProduct=function(e){return u._loadMonikersForPixelType(e,"YOUTUBE_SELECT_PRODUCT")},u.loadMonikerForYoutubeOrderConfirmON")},u._loadMonikersForPixelType=function(e,o){try{return e=e||{},e.pixelType=o,d("pixelsEnabled")&&d("ibPixelsEnabled")||e.pixelEnableOverride?u._loadMonikers(e):null}catch(o){r.error(o,"loadMonikers for pixelType, ",null,{context:e})}return null},u._cacheClickoutMonikers=function(e){var o=d("pixelContext"),r=u._mergeContexts(o,e),n=u._buildPixelUrl(r);if(n){n+="&reportOnly=true&jsReplace="+k;var t=new XMLHttpRequest;t.open("GET",n,!0),t.onreadystatechange=function(){4==this.readyState&&(u._cachedClickoutMonikerTextArr=this.response.split(O))},t.send()}},u._addIBPageViewContext=function(e){document.getElementById("roomList")&&(e.lowestPrice=document.getElementById("roomList").dataset.lowestPrice),document.getElementById("roomInfoContainer")&&(e.lowestPrice=document.getElementById("roomInfoContainer").dataset.lowestPrice)},u._buildPixelUrl=function(e){var o=d("pixelServlet")?d("pixelServlet"):e.pixelServlet;if(!o)return r.error(null,"ads._buildPixelUrl: remarketing.pixelServlet not set"),null;var n="/"+o+"?",t=d("pixelsByType");if(t){var i=t[e.pixelType];if(i){var l=i.join(",");l&&(n=n+"pixelList="+l)}}for(var a in e)e.hasOwnProperty(a)&&(n+="&"+a+"="+e[a]);return ta.uid&&(n+="&puid="+ta.uid),n},u._appendMonikersIFrame=function(e,o){return s().then(function(){var r=document.createElement("iframe");return r.setAttribute("id",o||"Monikers"),r.setAttribute("style","border:none; position:absolute; bottom:0; right:0"),r.setAttribute("width","1"),r.setAttribute("height","1"),r.setAttribute("src",e),r.setAttribute("scrolling","no"),document.body.appendChild(r),r})},u._appendMonikersIFrameText=function(e,o){return s().then(function(){var r=document.createElement("iframe");r.setAttribute("id","Monikers"),r.setAttribute("style","border:none; position:absolute; bottom:0; right:0"),r.setAttribute("width","1"),r.setAttribute("height","1"),document.body.appendChild(r);var n=r.contentDocument||r.contentWindow.document;n.open().write(e[0]);for(var t=1;t<e.length;t++)n.write(o),n.write(e[t]);return n.close(),r})},u._mergeContexts=function(e,o){if(!e)return o;if(!o)return e;var r,n={};for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);for(r in o)o.hasOwnProperty(r)&&(n[r]=o[r]);return n},u._loadMonikers=function(e){var o,n;try{o=d("pixelContext");var t=JSON.parse(localStorage.getItem("pbjs_identitylink"));o&&t&&t.value&&t.value.envelope&&(o.liveRampEnvelope=t.value.envelope.envelope),n=u._mergeContexts(o,e);var i=u._buildPixelUrl(n);return i?u._appendMonikersIFrame(i,C(n.pixelType)):null}catch(n){r.error(n,"ads._loadMonikers",null,{pixelContext:o,extraContext:e})}return null},o.exportTo(u,"ta.common.ads"),u});
!function(e,t,a,r){var n=function(a){ates},i=function(e,t,a){var r="sprite-",n=r+t,i=r+a;e.hasClass(n)&&(e.removeClass(n),e.addClass(i))},o=function(){var e=a.retrieve("meta.chevronTracking"),t=a.retrieve("meta.chevronAction"),r=a.retrieve("meta.chevronLabel");e&&t&&(r?a.trackEventOnPage(e,t,r):a.trackEventOnPage(e,t)),a.remove("meta.chevronTracking"),a.remove("meta.chevronAction"),a.remove("meta.chevronLabel")},l=function(e,t){var r,n,i,o;null!==t&&null!==e&&(a.commerce.meta.suppressCRArea(e),r=e.getElement(".metaDatesNotChosen"),n=e.getElement(".metaDatesChosen"),n&&(r&&(r.addClass("miniMetaHideHdr"),r.removeClass("miniMetaShowHdr")),n.addClass("miniMetaShowHdr"),n.removeClass("miniMetaHideHdr")),e.getElements(".minimalist_datepicker_wrap.hidden").each(function(e){e.removeClass("hidden")}),i=e.getElement(".postShowMetaCR"),null!=i&&i.destroy(),i=e.getElement(".postShowMetaCRLB"),null!=i&&i.destroy(),i=e.getElement(".postShowMetaCRLBPCR"),null!=i&&i.destroy(),o=e.getElement("fieldset"),a.commerce.meta.adoptMiniMetaElem(o,t),a.fireEvent("refreshedDOMContent",e))},s=function(e){e&&(e.getElement(".hacMiniComplete")&&!e.getElement(".anyOfferCompletedSuccessfully")?(e.getElements(".photos_lb_update_avail").each(function(e){e.addClass("hidden")}),e.getElements(".photos_lb_update_no_avail").each(function(e){e.removeClass("hidden")})):(e.getElements(".photos_lb_update_avail").each(function(e){e.removeClass("hidden")}),e.getElements(".photos_lb_update_no_avail").each(function(e){e.addClass("hidden")})))},c=function(e){e.getElements(".textLinks").each(function(e){e.addClass("hidden")}),e.getElements(".maybeCheck").each(function(e){e.addClass("hidden")}),e.getElements(".disclaimer").each(function(e){e.addClass("hidden")}),e.getElements(".photos_lb_update_links").each(function(e){e.removeClass("hidden")}),e.getElements(".taxesAndFees").each(function(e){e.addClass("hidden")}),s(e)};return{updateInlineMeta:function(e,t){if(!a.widgets.calendar.hasPageDates())return void a.commerce.meta.popInlineDatePicker(t,e);var r=a.id("CHECK_RATE")},popInlineDatePicker:function(e,t){if(t){var r,n="_inm";if(e&&e.target&&e.target.getParent("#CHECK_RATES_CONT")&&(r=a.id("date_picker_"+t)),r=r||a.id("date_picker_"+t+n)){var i=r.getParent(".date_picker_calendar_wrap");i&&i.onclick&&(i.onclick(e,i,t,n),i.fireEvent("click",e,i,t,n),function(){try{a.retrieve("avail.data."+t+n).calendar.calendarOverlay.position()}catch(e){}}.delay(200))}}},clickMetaShowPrices:function(t){var r;return t=new Event(t),a.page&&a.page.usingUnifiedDates?(a.page.gatherDatesNear(t.target),void t.stop()):a.widgets.calendar.hasPageDates()?(r=e.getElement(".cr_lb_overlay"),void(r&&r.overlay&&r.overlay.hide())):void a.widgets.calendar.setErrorStyling(t.target)},showLowestPriceCTA:function(t){var r=t?"metaLowestPriceCTAInline":"metaLowestPriceCTA";if(a.has(r)){var n=!0;if(t){var i=e.getElement(".meta_rates_content");n=i&&"block"==i.style.display}if(n){var o=a.retrieve(r);if(o.hasOwnProperty("idx")){var l=t?"Meta_LP_CTA_Display_Inline":"Meta_LP_CTA_Display",s=0===o.idx?"Not_Displayed":"Displayed",c=o.idx+"";a.trackEventOnPage(l,s,c)}var d=t?"LP_CTA_INLINE":"LP_CTA",m=a.id(d);m&&function(){m.fade("in")}.delay(1e3)}}},chevronHover:function(e,t,r,n){if(t&&r&&n){var i=a.id(t).getElement("."+n);i&&(i.removeClass(n),i.addClass(r))}},chevronBlur:function(e,t,r,n){if(t&&r&&n){var i=a.id(t).getElement("."+r);i&&(i.removeClass(r),i.addClass(n))}},hoverTopOffer:function(){var t=e.getElement(".rgba_gray_arrow_up");t&&(t.removeClass("rgba_gray_arrow_up"),t.addClass("rgba_yellow_arrow_up"))},blurTopOffer:function(){var t=e.getElement(".rgba_yellow_arrow_up");t&&(t.removeClass("rgba_yellow_arrow_up"),t.addClass("rgba_gray_arrow_up"))},hoverBookBtn:function(e){var t=a.id(e);i(t,"bookBtnOrangeIdle","bookBtnOrangeOver"),i(t,"bookBtnGreyIdle","bookBtnGreyOver"),i(t,"bookIdle","bookOver"),i(t,"goIdle","goOver"),i(t,"selectIdle","selectOver"),i(t,"bookSmallIdle","bookSmallOver"),i(t,"goSmallIdle","goSmallOver"),i(t,"selectSmallIdle","selectSmallOver"),i(t,"goBtnGrey","goBtnGreyOver"),i(t,"goBtnOrange","goBtnOrangeOver"),i(t,"chevronOrangeIdle35","chevronOrangeOver35"),i(t,"chevronGreyIdle27","chevronGreyOver27"),i(t,"chevronIdle_ylw","chevronHover_ylw")},blurBookBtn:function(e){var t=a.id(e);i(t,"bookBtnOrangeOver","bookBtnOrangeIdle"),i(t,"bookBtnGreyOver","bookBtnGreyIdle"),i(t,"bookOver","bookIdle"),i(t,"goOver","goIdle"),i(t,"selectOver","selectIdle"),i(t,"bookSmallOver","bookSmallIdle"),i(t,"goSmallOver","goSmallIdle"),i(t,"selectSmallOver","selectSmallIdle"),i(t,"goBtnGreyOver","goBtnGrey"),i(t,"goBtnOrangeOver","goBtnOrange"),i(t,"chevronOrangeOver35","chevronOrangeIdle35"),i(t,"chevronGreyOver27","chevronGreyIdle27"),i(t,"chevronHover_ylw","chevronIdle_ylw")},hoverSmallBookBtn:function(e){var t=a.id(e).getElement(".bookBtn");null!=t&&(i(t,"bookBtnOrangeIdleSmall","bookBtnOrangeIdleSmallOver"),i(t,"bookSmallIdle","bookSmallOver"),i(t,"goSmallIdle","goSmallOver"),i(t,"selectSmallIdle","selectSmallOver"))},blurSmallBookBtn:function(e){var t=a.id(e).getElement(".bookBtn");null!=t&&(i(t,"bookBtnOrangeIdleSmallOver","bookBtnOrangeIdleSmall"),i(t,"bookSmallOver","bookSmallIdle"),i(t,"goSmallOver","goSmallIdle"),i(t,"selectSmallOver","selectSmallIdle"))},providerHoverOn:function(e,t,r){var n=a.id(e);n.addClass("partnerHvr");var i=n.getElement(".price_overlay");if(i){var o=n.getElement(".perNight"),l=o.getCoordinates().width+29;i.addClass("show"),a.util.i18n.isRtl()?i.setStyles({position:"absolute",left:l,zindex:"101"}):i.setStyles({position:"absolute",right:l,zindex:"101"})}var s=e.getElement(".bookBtn");s&&a.commerce.meta.hoverBookBtn(s),a.store("meta.hoverProvider",t),a.store("meta.hoverProviderPosn",r)},providerHoverOff:function(e){var t=a.id(e);t.removeClass("partnerHvr");var r=t.getElement(".price_overlay");r&&r.removeClass("show");var n=e.getElement(".bookBtn");n&&a.commerce.meta.blurBookBtn(n),a.remove("meta.hoverProvider")},restoreProviderHover:function(){var e=a.retrieve("meta.hoverProvider"),t=a.retrieve("meta.hoverProviderPosn");if(e&&t){var r=a.id("PROVIDER_BLOCK");if(r){var n=r.getElements(".metaProvider"),i=r.getElement(".provider_"+e);n&&i&&i.hasClass("order_"+t)&&(n.each(function(e){a.commerce.meta.providerHoverOff(e)}),a.commerce.meta.providerHoverOn(i,e,t))}}},updateNavArea:function(e){var t=a.retrieve("ta.meta.navArea");(!t||t.indexOf(e)<0)&&a.store("ta.meta.navArea",e)},loadBestPriceXsell:function(e,n,i,o){try{if(a.retrieve("checkrates.one_second_xsell")!==!0)return;var l=i&&i.isInline,s="",c="";if(a.isHRTabs2014()&&l)return;var d=1e3,m="loadBestPriceXsell_numTries",g="loadBestPriceXsell_curCancelKey";l&&(m="loadBestPriceXsellInline_numTries",g="loadBestPriceXsellInline_curCancelKey");var v="meta.xsellTravelData";l&&(v="meta.xsellTravelDataInline");var u=a.retrieve(v);if(null==o){o=(new Date).getTime(),a.store(m,0),u=a.widgets.calendar.getCheckRatesData(),a.store(v,u);var h=a.id(n);if(h){h.innerHTML="",h.setStyle("height",0),h.setStyle("opacity","0");var f=a.retrieve("metaCheckRatesOverlay");f=a.id(f),!l&&f&&f.container&&f.container.getPosition&&t.scrollTo(0,f.container.getPosition().y)}l?a.commerce.meta.metaInYourMeta_resetInline():a.commerce.meta.metaInYourMeta_resetLB()}var _="loadBestPriceXsell_"+o+"_cancel";if(l&&(_="loadBestPriceXsellInline_"+o+"_cancel"),a.retrieve(_))return;if(a.has(g)){var p=a.retrieve(g);p!=_&&a.store(p,!0)}a.has(_)||(a.store(_,!1),a.store(g,_));var C=a.retrieve(m),E=C+1;if(a.store(m,E),!u)return;var y="";typeof pageServlet!==r&&pageServlet&&(y=pageServlet);var k={};a.meta&&a.meta.update&&(k=a.commerce.meta.getMetaParams());var P=Object.merge(u,{"detail":e,"try":a.retrieve(m),"reqNum":i.secondTry?"2":"1","type":s,"isInlineRequest":l?"1":"0","openedVendors":c,"origServlet":y},k),S=Object.toQueryString(P);if(!S||!S.trim())return void a.util.error.record(null,"ta.commerce.meta.loadBestPriceXsell  - toQueryString failure",null,P);var O,w=a.retrieve("ta.meta.navArea");try{O=a.commerce.meta.tracking.setTimingForNavArea(w)}catch(e){a.util.error.record(e,"problem locking timing in ta.commerce.meta.loadBestPriceXsell")}if(O&&(P.metaRequestTiming=O),a.commerce.meta.tracking.hasAnySuppressedAreas()){var T=a.commerce.meta.tracking.getSuppressedAreasAsString();T&&(P.suppressImpressionsOnComplete=T)}new Request({"url":"/MetaBestPriceCrossSellAjax?"+S,"evalScripts":!0,"onSuccess":function(t){if(!a.retrieve(_)){var r=t.contains("xsellHacStatusReady")||t.contains("xsellHacStatusSOL")||i.secondTry;if(r){var s=a.id(n);s&&(s.setStyle("height",0),s.setStyle("opacity","0"),s.setContent(t),a.commerce.meta.metaInYourMeta(n,{xsell:!0,inline:l})),a.store(m,0)}else setTimeout(function(){var t={secondTry:!0,xsell:!0,isInline:l,isHrRedesignTest:!1,openedVendors:c};a.commerce.meta.loadBestPriceXsell(e,n,t,o)},d)}},"onFailure":function(){a.store(m,0),a.util.error.record(null,"ta.commerce.meta.loadBestPriceXsell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(e){a.util.error.record(e,"ta.commerce.meta.loadBestPriceXsell")}},loadGeoCrAutoBroadenContents:function(t,r){var n=5,i=1e3,o="QC_Meta_Mini|GeoCheckRatesLightBox";try{var l=function(){c=de()},c=!0,d=a.id(t.inner);if(!d)throw new Error("Cannot find parent: "+t);var m=function(e){var t=0;et=a)}),e.each(function(e){e.setStyle("height",t)})},g=a.commerce.meta.tracking.setTimingForNavArea(o);t.addEvent("close",l);var v={"d":r,"area":o,"metaRequestTiming":g},u=a.widgets.calendar.getCheckRatesData();if(!u)throw new Error("Cannot find dates and/or adults");Object.merge(v,u),a.meta&&a.meta.update&&Object.merge(v,a.commerce.meta.getMetaParams());var h=0,f=function(){c&&(++h,v.attempt=h,new Request({"url":"/GeoCrAutoBroadenAjax","data":v,"method":"get","evalScripts":!0,"onSuccess":function(t){try{if(!c)return;var r=Elements.from(t,!0),o=r.getElement(".progress").filter(function(e){return e})[0];if(o)if(/\bfallbackUrl-(\S+)\b/.exec(o.className)){var l=RegExp.$1,g=a.util.URL.getServletNameFromUrl(l);g||(a.util.error.record(null,"geo check rate cannot get servlet name from "+l,null,v),g="UNKNOWN"),a.setEvtCookie("MetaGeoLightBox","unload","Redirect",0,"/"+g),e.location.href=l}else d.setStyles({"overflow":"hidden","height":"auto"}),d.innerHTML="",d.adopt(r),m(d.getElements("#GEO_CR_AUTO_BROADEN .recs .rec .info .distance")),m(d.getElements("#GEO_CR_AUTO_BROADEN .recs .rec .info .amenity")),!o.hasClass("isHacComplete")&&h<n?setTimeout(f,i):(d.getElements(".showUntilLast").dispose(),d.getElements(".hideUntilLast").removeClass("hidden"));else a.util.error.record(null,"geo check rate malform response missing progress",null,v),s()}catch(e){a.util.error.record(e,"cannot process geo check rate response",null,v),s()}},"onFailure":function(e){a.util.error.record(null,"geo check rate request failed: status="+(e&&e.status),null,v),s()}}).send())};f()}catch(e){a.util.error.record(e,"cannot send geo check rate initial request"),s&&s()}},xSellResponses:{lb_hac:!1,lb_xsell:!1,inline_hac:!1,inline_xsell:!1},metaInYourMeta_resetLB:function(){a.commerce.meta.xSellResponses.lb_hac=!1,a.commerce.meta.xSellResponses.lb_xsell=!1},metaInYourMeta_resetInline:function(){a.commerce.meta.xSellResponses.inline_hac=!1,a.commerce.meta.xSellResponses.inline_xsell=!1},hacIsBlockingXSell:function(e){var t=a.commerce.meta.xSellResponses;return e?t.inline_xsell:t.lb_xsell},metaInYourMeta:function(e,t){var r=t&&t.inline,i=t&&t.xsell,o=a.commerce.meta.xSellResponses;if(r?i?o.inline_xsell=!0:o.inline_hac=!0:i?o.lb_xsell=!0:o.lb_hac=!0,r&&o.inline_xsell||!r&&o.lb_xsell&&o.lb_hac){var l=a.id("META_PRICE_XSELL"),s=a.id("STATE_OPT_RESPONSE");if(r&&(l=a.id("META_PRICE_XSELL_INLINE"),s=a.id("STATE_OPT_RESPONSE_INLINE")),l&&l.hasClass&&!l.hasClass("hidden"))return;if(s&&s.hasClass&&!s.hasClass("hidden"))return;var c=l,d=0;a.meta&&a.meta.update?d=a.meta.update.getMetaPricesCount(r):n()&&(d=dd.commerce.checkrates.getMetaPricesCount(r)),null==d&&(d=0),d<1&&s&&(c=s);var m=a.id(e);if(m)if(c)a.commerce.meta.revealBestPriceXsell(m,c,r,!1);else{var g="lA";r&&(g+="_Inline");var v=a.id(g);v&&v.removeClass&&v.removeClass("hidden")}}},revealBestPriceXsell:function(e,r,i,o){if(e&&(e=a.id(e)),r&&(r=a.id(r)),!e||!r)return void a.util.error.record(null,"revealBestPriceXsell - required elements missing");r.removeClass&&r.removeClass("hidden");var l=new Fx.Tween(e,{property:"opacity"});if(o){var s=a.retrieve("metaLeaveBehindOverlay");if(s&&s.container){var c=s.container;c.hasClass&&c.hasClass("hidden")&&c.removeClass&&c.removeClass("hidden"),a.meta&&a.meta.cr?a.meta.cr.removePCR():n()&&dd.commerce.checkrates.removePCR()}}else{var d="META_MINI_META_MAYBE";i&&(d="META_MINI_META_MAYBE_INLINE");var m=a.id(d),g=!0;m&&(g=!1);var v="Displayed_Lightbox";i&&(v="Displayed_Inline");var u=r.getElements(".hotelListing").length;0===u&&(u="0",v="Not_"+v),a.trackEventOnPage("Meta_State-Optimized_XSell",v,u)}var h=r.getSize().y,f=new Fx.Tween(e,{property:"height",onCom0,1)}});f.start(h);var _=a.retrieve("metaCheckRatesOverlay");_&&_.container&&_.closeBtn&&a.id(t).getScroll().y>_.container.getPosition().y&&a.util.element.scrollIntoView(_.closeBtn)},hideBestPriceXsell:function(e){var t=a.id(e),r=a.id("META_PRICE_XSELL");if(t&&r){var n=new Fx.Tween(t,{property:"height"}),i=new Fx.Tween(t,{property:"opacity",onComen")}});i.start(1,0)}},updateProvAreaFromLightBox:function(t){var r=a.retrieve("meta.baseLocationId");if(r&&t==r){var i=a.retrieve("meta.postShowMetaCR"),o=a.retrieve("meta.postShowMetaCRLB"),l=a.retrieve("meta.postShowMetaCRLBPCR");if(i&&o&&l)return void a.commerce.meta.updateProvArea(i,o,l)}a.widgets.calendar.datesExist()&&(a.meta&&a.meta.update?a.meta.update.request(r):n()&&dd.commerce.checkrates.checkRatesMiniMeta(null,e.getElementById("CHECK_RATE"),r,"checkrates"))},updateProvArea:function(r){var n=e.getElement("#CHECK_RATES_CONT.chkRates"),i=e.getElement("#LOC_PHOTO_ALBUMS.photos_lb_update .metaCrosssell .chkRates"),d=e.getElement("#LOC_PHOTO_ALBUMS.photos_lb_update .sidebar .chkRates"),m=e.getElement("#AMENITY_LIGHTBOX.photos_lb_update .chkRates"),g=e.getElement(".similarCarousel"),v=e.getElement(".premiumTimeout");if(g&&v){var u=n.getElement("div.bc_text_content");if(u){var h=r.getChildren()[1];if(h){var f=h.clone(!1);f.innerHTML=h.innerHTML,u.innerHTML="",u.adopt(f)}}}if(i){l(i,r),c(i);var _=e.getElement(".featuredImageWrap.metaCrosssell");if(_){var p=_.getElement(".premium_offers_area");if(p){var C=p.getElements(".offer.wrap.premium"),E=_.getElement(".chkRates");C&&E&&E.toggleClass("noOffers",0===C.length)}}}d&&(l(d,r),c(d)),m&&(l(m,r),s(m)),a.has("meta.isHackathonBC")&&(a.commerce.meta.alignPriceBlocks(),a.has("meta.bc.isRevisedUnavailability")&&a.commerce.meta.truncateProviderNames()),t.fireEvent("postAjaxMetaUpdate"),r&&r.getElement(".hacMiniComplete")&&o(r)},adoptMiniMetaElem:function(e,t){if(null!=e){var a=e.getElement(".disclaimer");null==a||a.getParentBySelector("#hover_table_display_area")||a.destroy();var r=t.clone(!1);r.innerHTML=t.innerHTML,e.adopt(r)}},miniMetaAjax:function(e,t){n()&&dd.commerce.checkrates.miniMetaAjax(e,t)},suppressCRArea:function(e){var t=e.getElements(".miniMetaShow");Array.ede")})},clearStoredMiniData:function(){a.retrieve("checkrates.meta_ui_post_click_prices")&&(a.store("meta.postShowMetaCRLBPCR",null),a.store("meta.postShowMetaCR",null),a.store("meta.postShowMetaCRLB",null))},storeMiniData:function(e){if(a.retrieve("checkrates.meta_ui_post_click_prices")){var t=e.getElement(".postShowMetaCR"),r=e.getElement(".postShowMetaCRLBPCR"),n=e.getElement(".postShowMetaCRLB");t&&n&&r&&(a.store("meta.postShowMetaCRLBPCR",r),a.store("meta.postShowMetaCR",t),a.store("meta.postShowMetaCRLB",n))}},providerButtonClicked:function(e){if(e&&!a.has("hotels.hasTimeoutDates")){var t="CheckIn|provider_logo";a.trackEventOnPage("DATEPICKER","OPEN",t,e),a.store("meta.datepicker_tracked",!0)}},moreSitesLinkClicked:function(e){e&&!a.has("hotels.hasTimeoutDates")&&(a.trackEventOnPage("DATEPICKER","OPEN","more_sites_link",e),a.store("meta.datepicker_tracked",!0))},buildMetaHacParamObj:function(){var t={};try{var r=e.getElement("#HAC_FORM input[name=geo]");if(r&&r.value&&(t.geo=r.value),!t.geo){var n=e.getElement("#SEARCH_LHN input[name=geo]");n&&(t.geo=n.value)}var i=e.getElementById("searchAll");if(i&&"true"!=i.value){var o=a.widgets.calendar.getPageInDate();o&&(t.inDay=o.getDate(),t.inMonth=o.getMonth()+1+"/"+o.getFullYear());var l=a.widgets.calendar.getPageOutDate();l&&(t.outDay=l.getDate(),t.outMonth=l.getMonth()+1+"/"+l.getFullYear());var s=a.widgets.calendar.getPageAdultsCount();2!=s&&(t.adults=s),t.searchAll="false"}}catch(e){a.util.error.record(e,"buildHACUrlParams")}return Object.toQueryString(t)},getHACCategory:function(){var t=e.getElements(".tab.selected"),a="1";if(t&&t.length&&t.length>0){var r=t[0].className.match(/cat_(\d+)/);r&&(a=r[1])}return a},buildHACSearchData:function(){var r=t.ta&&a.page&&a.page.getDates&&a.page.getDates("CHECKIN")[0];r||(r=t.ta&&a.widgets&&a.widgets.calendar&&a.widgets.calendar.getPageInDate());var n=t.ta&&a.page&&a.page.getDates&&a.page.getDates("CHECKOUT")[0];n||(n=t.ta&&a.widgets&&a.widgets.calendar&&a.widgets.calendar.getPageOutDate());var i,o=a.widgets.calendar.getPageAdultsCount(),l=e.getElementById("geo");null==l&&(i=e.getElementsByName("geo"),i&&i.length>0&&(l=i[0]));var s;l&&l.value?s=l.value:t.modelGeoId&&(s=t.modelGeoId);var c=!1,d=a.commerce.meta._padZero,m=r?d(r.getDate()):null,g=n?d(n.getDate()):null,v=r?d(r.getMonth()+1)+"/"+r.getFullYear():null,u=n?d(n.getMonth()+1)+"/"+n.getFullYear():null,h={};return h.adults=o,h.geo=s,h.searchAll=c,h.inDateOfMonth=m,h.outDateOfMonth=g,h.inMonthYear=v,h.outMonthYear=u,h.category=a.commerce.meta.getHACCategory(),h},buildMetaHACUrl:function(){var e=a.commerce.meta.buildHACSearchData(),r="/HACSearch?adults="+e.adults+"&geo="+e.geo+"&searchAll="+e.searchAll;e.category&&(r=r+"&cat="+e.category),e.inDateOfMonth&&(r=r+"&inDay="+e.inDateOfMonth),e.outDateOfMonth&&(r=r+"&outDay="+e.outDateOfMonth),e.inMonthYear&&(r=r+"&inMonth="+e.inMonthYear),e.outMonthYear&&(r=r+"&outMonth="+e.outMonthYear);var n=r+t.location.hash;return n},redirectHACSearch:function(){a.setEvtCookie("Mini_meta_LP_chevron_display","Clicked","Unavailable","","/HACSearch"),t.location=a.commerce.meta.buildMetaHACUrl()},_pa(-2)},anchorToOpenTab:function(){var e=a.id("ReviewsTab"),t=a.id("MetaPricesTab");e&&e.hasClass("selected")?a.commerce.meta.scrollToReviews():t&&t.hasClass("selected")&&(e.click(),a.commerce.meta.scrollToReviews())},scrollToReviews:function(){var e=a.id("REVIEWS");null!=e?a.util.element.scrollIntoView(e):a.util.error.record(null,"couldn't find reviews element on page!")},scrollToId:function(e){e&&a.id(e)&&a.util.element.scrollIntoView(a.id(e))},initNoAvailCarousel:function(){try{var e,t=a.id("ALSO_VIEWED_LIST");if(!t)return;var r=t.getElement("ul");if(!r)return;var n=r.getElements("li").length,i=new Fx.Tween(r,{property:"left"}),o=353,l=1,s=t.getElement(".prev"),c=t.getElement(".next");if(!c||!s)return;var d=function(s){var c,d,m,g;1===l&&s<0||l===n&&s>0||(s<0?a.trackEventOnPage("Pager_Arrows","Scroll_Left","Mini_Carousel_Xsell"):s>0&&a.trackEventOnPage("Pager_Arrows","Scroll_Right","Mini_Carousel_Xsell"),l+=s,c=parseInt(r.getStyle("left"),10),d=o*s*-1,m=c+d,i.start(m),g=t.getElement(".paginator"),g&&(e=1===l&&s<0?"front":l===n&&s>0?"end":"middle",g.className="paginator "+e))};s.addEvent("c(-1)}),c.addEvent("click",function(){d(1)})}catch(e){a.util.error.record(e,"ta.commerce.meta.initNoAvailCarousel")}},showRemainingProviders:function(t,r){r=a.id(r),r&&r.destroy(),a.store("checkrates.hr_bc_see_all_click",!0),a.retrieve("ibdm_impression_tracking")&&a.trk("n_more_sites",!1,e.getElement(".premium_offers_area")),e.getElements(".remaining").removeClass("remaining"),a.fireEvent("remainingMetaProvidersShown")},showRemainingProviders_Flyout:function(t,r){r=a.id(r);var n=a.find(".show_remaining_providers_flyout",r)||a.find(".show_remaining_providers_flyout"),i=r.getParent(".chkRates")||e,o=a.select(".remaining",i);try{n&&o.length&&e.body.addEvent("click",function(t){r&&!t.target||!t.target.getParents().contains(r)||n.isDisplayed()?(n.hide(),e.body.removeEvents("click"),a.select(".remaining",n).destroy()):(o.foe())}),n.show())})}catch(e){a.util.error.record(e,"showRemainingProviders_Flyout")}},alignPriceBlocks:function(){a.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceBlock .price",!0),a.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceBlock .featuredText",!0),a.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceOutsideChevron .price",!0),a.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceOutsideChevron .featuredText",!0),a.util.element.makeTextFitOneLine(".offer.premium .priceBlock.flag_bump .price",!0),a.util.element.fitToContentsHorizontally(".offer.premium .lowest_price_folded .text",0,65),a.select(".chevron_redesign .offer.premium.unsized .loading").setStyle("display","none"),a.select(".chevron_redesign .offer.premium.unsized").removeClass("unsized"),a.util.element.makeSameWidth("#HR_HACKATHON_CONTENT > #HotelDateSearch .postShowMetaCR .priceBlock")},toggleBlueChevronLowestPriceCTA:function(t){if(a.retrieve("meta_guests_field_v2.CTAActivated")&&!e.getElements(".overlay").length){a.has("meta_guests_field_v2.CTATimer")&&clearTimeout(a.remove("meta_guests_field_v2.CTATimer"));var r=a.id("BC_LP_CTA");r&&r.fade&&(t?r.fade("in"):r.fade("out"))}},displayBlueChevronLowestPriceCTA:function(){var t,r,n,i,o,l,s,c,d,m="bcMetaLowestPriceCTA";if(a.has(m)&&!a.has("hr_chevron_redesign")){if(t=a.retrieve(m),t.hasOwnProperty("idx")&&(r=0===t.idx?"Not_Displayed":"Displayed",n=t.idx+"",a.trackEventOnPage("BlueChevron_LP_CTA_Display",r,n)),i=a.id("BC_LP_CTA"),i&&i.fade&&function(){i.fade("in"),a.retrieve("meta_guests_field_v2.enabled")&&(a.store("meta_guests_field_v2.CTATimer",function(){i.fade("out")}.delay(5e3)),a.store("meta_guests_field_v2.CTAActivated",!0))}.delay(700),o=a.id("bc_lp_cta_text")){if(l=o.getSize().y,12==l){for(;o.getSize().y<=l;)o.style.width=""+(o.getSize().x-1)+"px";o.style.width=""+(o.getSize().x+1)+"px"}t.displayTop?(s=i.parentNode.getElement(".priceBlock"),i.style.position="relative",i.style.left=345-o.getSize().x+"px",i.style.top=""+(-s.getSize().y-22)+"px"):(c=i.getElement(".bc_lp_cta_triangle"),i.style.left="-"+(o.getSize().x+20)+"px",c.style.left=""+(o.getSize().x+10)+"px"),o.style.marginTop=""+Math.round((25-o.getSize().y)/2)+"px"}if(d=5800,a.retrieve("check_width_for_CTA_fade")){var g=e.getElement(".bc_lp_cta"),v=e.getElement(".priceBlock");if(g&&v){var u=g.getSize().x+v.getSize().x,h=250;u>h&&!t.displayTop&&function(){i.fade("out")}.delay(d)}}else{var f=a.retrieve("fadeBcLpCTAout");f&&1==f&&!t.displayTop&&function(){i.fade("out")}.delay(d)}}},truncateProviderNames:function(){var t=e.getElement(".textLink");if(t){var r=t.getSize().x,n=Math.max.apply(null,e.getElements(".textLink .price").map(function(e){return e.getParent(".moreLink")?0:e.getSize().x})),i=r-n-28;a.retrieve("meta.paymentsTipText")&&(i-=20),i>0&&$$(".textLinks .providerName").each(function(e){e.getNext(".price")&&e.setStyle("width",i)})}},expandProvidersInline:function(e){if(e=a.id(e)){var t=e.getParent(".metaPriceInfo");if(t){var r=t.getElements(".provider");if(r&&(r.show(),e.hide(),a.retrieve("assisted_booking_desktop_entry"))){var n=e.getParents();n.forEach(function(e){e.hasClass("metaPriceInfo")&&a.meta&&a.meta.treeTrack&&a.meta.treeTrack.hasTrackingTree(e)&&a.trk("n_more_sites",!1,e)})}}}},flipHoverClass:function(e,t){if(e){e=a.id(e);var r=t+"Idle",n=t+"Over";e&&e.toggleClass(r).toggleClass(n)}},trackHotelRatingsInfoClickInHR:function(e){e.target=e.target||e.srcElement,e.target&&e.target.href&&a.setEvtCookie("Ratings_Info","all_hotels","",0,e.target.href)},updateHeaderMsg:function(t,a){var r=e.getElement(t);a&&r&&(r.hasClass("unifiedPickers")||(r.innerHTML=a))},updateHeaderDates:function(){try{if(a.widgets.calendar.hasPageDates()){var e=$$(".dateHeader.inDate"),t=$$(".dateHeader.outDate"),r=a.widgets.calendar.getDatePickerFormat("short"),n=a.widgets.calendar.getDatePickerFormat("classic");if(e){var i=a.widgets.calendar.dateToString(a.widgets.calendar.getPageInDate(),r);Array.each(e,function(e){var t=a.id(e);t.getParent("#meta_on_photo_viewer")||t&&(t.innerHTML=i)})}if(t){var o=a.widgets.calendar.dateToString(a.widgets.calendar.getPageOutDate(),n);Array.eL=o)})}}}catch(e){a.util.error.record(e,"ta.commerce.meta.updateHeaderDates")}},enableAdultsPicker:function(){var t=e.getElement(".adultsText");t&&t.addClass("hide");var r=e.getElement(".changeAdults");r&&r.addClass("hide");var n=e.getElement(".overlay .date_picker_adults_wrap");n&&n.removeClass("hide");var i=e.getElement(".overlay .showPriceButtonHide");i&&i.removeClass("showPriceButtonHide"),a.store("meta_guests_field_v2.originalAdults",a.retrieve("date.picker.adultsCount"))},disableAdultsPicker:function(e){if(e&&e.container){var t=e.container.getElement(".adultsText");t&&t.removeClass("hide");var a=e.container.getElement(".changeAdults");a&&a.removeClass("hide");var r=e.container.getElement(".date_picker_adults_wrap");r&&r.addClass("hide");var n=e.container.getElement(".showPriceButton");n&&n.addClass("showPriceButtonHide")}},adultsGoButtonClick:function(e,t,r,n,i){var o=a.widgets.calendar.getPageInDate(),l=a.widgets.calendar.getPageOutDate(),s=o&&o.getDate&&l&&l.getDate;if(s){var c=a.widgets.calendar.getCalendarObjectKey(r,n,"out"),d=a.retrieve(c);if(d){var m=d.calendar;m&&(m.onCalendarOverlayHide(),m.fireEvent("onRangeSelect",[m.crId,m.options.ext]),m.fireEvent("onSelect",[m,e]))}}else a.overlays.Factory.simulateDatePickerClick(e,t,r,n,i)},_hhRedirectIfNoOffers:function(){var r=e.getElements("#HotelDateSearch .offer");if(r&&!a.commerce.meta._overlayOnPage()){a.store("ta.redirectingPage",!0),a.setEvtCookie("NoOffersHH","redirect","",0,"/HotelHighlight");var n=/-r\d+-/;t.location.href=t.location.href.replace("Hotel_Review-","Hotel_Review-s1-").replace("ShowUserReviews-","Hotel_Review-s1-").replace(n,"-")}},getResponseAvailability:function(e){return!!e&&{anyAvailable:!!e.match(/\shacComplete\s.*\sanyOfferCompletedSuccessfully\s/g),allUnavailable:!!e.match(/\shacComplete\s.*\shacMiniOfferNotAvailable\s/g),maybeAvailable:!!e.match(/\shacComplete\s.*\shasDisplayUnavailability\s/g)}},_overlayOnt()},hhRemoveDatePickerForErrorMessaging:function(t){if(!a.widgets.calendar.hasPageDates())return void a.commerce.meta.clickMetaShowPrices(t);var r=a.id("GEO_CHECK_RATES_BALANCE");r&&r.hide();var n=e.getElement("#HLBASE .unavailHdr");n&&n.removeClass("hidden")},setupMiniMetaOnAccomPolling:function(e){a.pages.hac.updateHACData&&a.hac.filters.updateResults||a.util.error.record(null,"setupMiniMetaOnAccomPolling bad linkage"),a.pages.hac.startHACUpdate(),e&&a.hac.filters.updateResults()},checkRatesCreateGeoCrAutoBroadenLb:function(e,r,n){try{if(a.has("hr_to_hh_redirect_no_offers")&&t.pageServlet&&"HotelHighlight"!==t.pageServlet)return void(a.widgets.calendar.hasPageDates()?a.widgets.calendar.justUpdateSessionDates(function(){a.commerce.meta._hhRedirectIfNoOffers&&a.commerce.meta._hhRedirectIfNoOffers.delay(300)}):a.widgets.calendar.setErrorStyling(new Event(e).target));if(!a.widgets.calendar.hasPageDates())return void a.commerce.meta.clickMetaShowPrices(e);r.getParent(".meta_date_wrapper")?a.trackEventOnPage("MetaGeoLightBox","open","DatePicker",0,!1):a.trackEventOnPage("MetaGeoLightBox","open","ShowPrices",0,!1),a.run("ta.overlays.Factory.loadGeoCrAutoBroadenOverlay",{},r,n)}catch(e){a.util.error.record(e,"ta.commerce.meta.checkRatesCreateGeoCrAutoBroadenLb cannot track/create lightbox")}},metaListingClickReporting:function(e){e&&e.target&&(e.target.hasClass("photo_image")?a.trackEventOnPage("PRICE_SAVER","CLICK","THUMBNAIL"):"A"===e.target.nodeName&&e.target.parentNode.hasClass("review_stubs_item")?a.trackEventOnPage("PRICE_SAVER","CLICK","REVIEW"):e.target.hasClass("property_title")?a.trackEventOnPage("PRICE_SAVER","CLICK","PROPERTY_TITLE"):null!=e.target.getParent(".metaPriceInfo")&&a.trackEventOnPage("PRICE_SAVER","CLICK","META"))},getMetaPlet}},updateSessionDatesRedirect:function(e){a.widgets.calendar.hasPageDates()?a.widgets.calendar.justUpdateSessionDates(function(){t.location.href=e},!1,!0):t.location.href=e}}}(a);a.commerce.meta||(a.commerce.meta={});for(var i in n)n.hasOwnProperty(i)&&(a.commerce.meta[i]=n[i])}(document,window,ta);
ta.commerce.AvailDataWidget=new Class({Implements:[Options],options:{calendarOptions:{},argArray:[]},initialize:function(t,e,a,i,s,l){this.setOptions(l),(t||window.event)&&(t=new Event(t||window.event),t&&t.stop()),this.locId=e,this.ext=i;var n=null;n=this.ext?"date_picker_adults_"+this.locId+this.ext:"date_picker_adults_"+this.locId,this.adultField=ta.id(n),this.options.calendarOptions=Object.merge(this.options.calendarOptions,{"ext":this.ext?this.ext:"","creatorElem":t&&t.target});var d=!0;if(t){var r=ta.id(t.target);r&&(r.hasClass("out_date")||ta.has("guests_rooms_picker_3.enabled")&&r.hasClass("outDateTrigger"))&&(d=!1)}ta.page&&ta.page.usingUnifiedDates&&"adults"===a||(this.calendar=new ta.widgets.SingleDateCalendar(this.options.calendarOptions,this.locId,s,this.options.argArray,d));var o=ta.retrieve("adultFieldsMap");if(o||(o={}),this.adultField){this.adultsField=o[n];var c=this.adultField.getParent(".overlay");(!this.adultsField||c&&this.adultsField.parentOverlay!=c.overlay)&&(this.adultsField=new ta.widgets.AdultsField(this.adultField,this.locId,s,t),o[n]=this.adultsField,ta.store("adultFieldsMap",o))}this.show(a),ta.widgets.calendar.trackCalendarObject&&ta.widgets.calendar.trackCalendarObject(this)},show:function(t){"calendar"==t&&this.calendar&&this.calendar.calendarOverlay?this.calendar.showCalendarOverlay():"adults"==t&&this.adultsField&&this.adultsField.adultsOverlay.show(),ta.has("persistentFilters.showing")&&tabletOnFullSite&&this.calendar.calendarOverlay.container&&this.calendar.calendarOverlay.container.setStyle("position","fixed")},clear:function(){this.adultField&&(ta.retrieve("meta_guests_field_v2.enabled")||ta.widgets.calendar.setPageAdultsCount(2),ta.widgets.calendar.syncAllDatePickers()),this.calendar.clear()},getState:function(t){var e=this.calendar.getState(),a={"adults":"2"};this.adultsField?a=this.adultsField.getState():ta.widgets.calendar.getPageAdultsCount()&&(a={"adults":ta.widgets.calendar.getPageAdultsCount()+""});var i=Object.merge(e,a);return t?i:Object.toQueryString(i)}}),ta.widgets.AdultsField=new Class({adultsSelRegex:/.*_(\d)\s*$/,adultsExRegex:/.*_\d+_(.*)$/,initialize:function(t,e,a){this.adultsField=t,this.crId=e,this.selectionFunction=a;var i=this.adultsField.getParent(".overlay");i&&(this.parentOverlay=i.overlay);var s=ta.overlays.ACTIVATE_CLICK;this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")&&(s=ta.overlays.ACTIVATE_NEVER),this.guestFieldLabel=this.generateGuestFieldLabel(this.adultsField.id),this.adultsOverlay=new ta.overlays.RelativeOverlayBelow({style:"dp",showCloseButton:!1,noPadding:!0,autoShow:!1,offsetLeft:1,activate:s,onShow:this.onAdultsShow.bind(this),onHide:this.onAdultsHide.bind(this)},this.adultsField),this.adultsField.onclick=function(){},ta.id(this.adultsField).addEvent("click",this.adultsOverlay.show);var l=ta.id(this.adultsOverlay.container).getElement(".adults_pre_selected");try{this.count=ta.retrieve("date.picker.adultsCount"),this.count||(this.count=this.adultsSelRegex.exec(l.id)[1])}catch(t){}this.count||(this.count="2"),ta.widgets.calendar.setPageAdultsCount(this.count);var n=ta.id(this.adultsOverlay.container).getElements(".option"),d=this.adultSelect.bind(this);n.each(function(t,e){var a=function(a){d.pass([e+1,t,a.event])()};ta.id(t).addEvent("click",a)});var r=this.adultsField.clientWidth;r+="px",ta.id(this.adultsOverlay.container).setStyles({"width":r}),this.optionElems=n},generateGuestFieldLabel:function(t){var e=this.adultsExRegex.exec(t),a=ta.retrieve("open_guest_field.servletName");return a||(a=window.pageServlet),e?"pop"==e[1]?"Guest_Flyout":"met"==e[1]?"Guest_MetaLightbox":"pto"==e[1]?"Guest_HR_PhotoLightbox":"amo"==e[1]?"Guest_HR_AmenitiesLightbox":"":a?"Hotel_Review"==a?"Guest_HR":"Hotels"==a?"Guest_Hotels":"ShowUserReviews"==a?"Guest_Hotels":"":""},trackGuestFieldEvent:function(t,e){try{ta.trackEventOnPage("GuestPicker",t,e)}catch(t){ta.util.error.record(t,"ta.widgets.AdultsField.trackGuestFieldEvent")}},onAdultsShow:function(){try{this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK&&(this.tempPin=!this.parentOverlay.pinned,this.tempPin&&this.parentOverlay.pin()),ta.id("PERSISTENT_DATE_PICKER")&&this.optionElems[0]&&this.optionElems[0].getParent("div.relative")&&this.optionElems[0].getParent("div.relative").setStyles({"z-index":10001}),this.keyEventListener=this.onAdultsOverlayKeyDown.bind(this),document.addEvent("keydown",this.keyEventListener),this.adultsField.blur();var t=document.getElements(".date_picker_adults_option");if(t&&Array.each(t,function(t){ta.id(t).removeClass("adults_selected"),ta.id(t).removeClass("adults_pre_selected")}),ta.id(this.adultsField).getParent("#PERSISTENT_CHECK_RATES")){var e=ta.id(this.adultsField).getCoordinates().top;"undefined"!=typeof isIPad&&isIPad||(e-=window.getScrollTop()),ta.id(this.adultsOverlay.container).setStyles({"position":"fixed","top":e+29,"zindex":9997})}this.count=ta.retrieve("date.picker.adultsCount"),ta.retrieve("meta_guests_field_v2.enabled")&&(this.optionElems[this.count-1].addClass("adults_pre_selected"),this.preSelectElem=this.optionElems[this.count-1]),ta.retrieve("meta_guests_field_v2.trackingEnabled")&&this.trackGuestFieldEvent("Open",this.guestFieldLabel)}catch(t){ta.util.error.record(t,"ta.widgets.AdultsField.onAdultsShow")}},onAdultsHide:function(){try{this.parentOverlay&&this.tempPin&&(this.tempPin=!1,this.parentOverlay.unpin()),this.keyEventListener&&document.removeEvent("keydown",this.keyEventListener)}catch(t){}},onAdultsOverlayKede()},adultSelect:function(t,e,a){ta.commerce.meta.tracking.resetAllTimingLocks(),ta.commerce.meta.tracking.clearSuppressedAreas(),ta.commerce.meta.polling.clearAllPollingInfo(),this.updateValue(t,e.innerHTML),this.adultsOverlay.hide();var i=this.guestFieldLabel+"|"+this.count;if(ta.retrieve("meta_guests_field_v2.trackingEnabled")&&this.trackGuestFieldEvent("Select",i),ta.widgets.calendar.hasPageDates()){if(this.selectionFunction&&(this.selectionFunction===ta.widgets.calendar.launchInlineMeta?this.selectionFunction.call(this,a):this.selectionFunction.call(this,this.crId,this.adultsField)),ta.commerce.metajson&&ta.commerce.metajson.refetchAll(),"undefined"!=typeof oxapp&&oxapp&&oxapp.context){var s=oxapp.context.get("TravelDates");s&&s.save()}ta.widgets.calendar.trackCalendarEvent("DATEPICKER","CHANGE","GUESTS",t)}},updateValue:function(t,e){this.count=t,this.adultsField.innerHTML=e,ta.widgets.calendar.setPageAdultsCount(this.count),ta.widgets.calendar.syncAllDatePickers(),ta.widgets.calendar.justUpdateSessionAdults();var a=document.getElements(".adults");a.each(function(t){t.innerHTML=e})},getAdultsCount:function(){return this.count},get+""}}});
ta.commerce.meta.tracking={getTimingForNavArea:function(e){if(e){var r=ta.commerce.meta.tracking.processNavArea(e);return ta.retrieve(r)}},setTimingLockForNa",r)},isTimingLocked:function(e){var r=ta.commerce.meta.tracking.processNavArea(e),a=ta.retrieve(r);if(!a)return!1;var t=Date.now();return!(t-a>=2e3)||(ta.commerce.meta.tracking.resetTimingLockForNavArea(r),!1)},resetTimingLockForNavArea:function(e){var r=ta.commerce.meta.tracking.processNavArea(e);ta.retrieve(r+"-LOCK")&&ta.remove(r+"-LOCK")},resetAllTimingLocks:function(){for(var e=["QC_Meta_Inline","QC_Meta_Mini","QC_Meta_Metro","QC_Meta_Micro","QC_Meta_Lightbox"],r=0;r<e.length;r++)ta.commerce.meta.tracking.resetTimingLockForNavArea(e[r])},processNavArea:function(e){if(e)return 0===e.indexOf("QC_Meta_Inline")?"QC_Meta_Inline":0===e.indexOf("QC_Meta_Mini")?"QC_Meta_Mini":0===e.indexOf("QC_Meta_Metro")?"QC_Meta_Metro":0===e.indexOf("QC_Meta_Micro")?"QC_Meta_Micro":0===e.indexOf("QC_Meta_Lightbox")?"QC_Meta_Lightbox":void 0},setTimingForNavArea:function(e,r){if(e){r||(r=Date.now());var a=ta.commerce.meta.tracking.processNavArea(e);return ta.commerce.meta.tracking.isTimingLocked(a)?ta.commerce.meta.tracking.getTimingForNavArea(a):(ta.store(a,r),ta.commerce.meta.tracking.setTimingLockForNavArea(a,r),"QC_Meta_Inline"!=a||ta.commerce.meta.tracking.containsSuppressedArea("QC_Meta_Mini")||ta.commerce.meta.tracking.setTimingLockForNavArea("QC_Meta_Mini",r),r)}},updateUrlWithTiming:function(e,r){if(!e||!r)return e;var a=ta.commerce.meta.tracking.setTimingForNavArea(r);if(!a)return e;if(e.contains("&metaRequestTiming=")){var t=new RegExp("(&|\\?)metaRequestTiming=[^&]*");e=e.replace(t,"&metaRequestTiming="+a)}else e+="&metaRequestTiming="+a;return e},suppressImpressionsForArea:function(e){if(e){var r=ta.commerce.meta.tracking.processNavArea(e);if(!ta.commerce.meta.tracking.containsSuppressedArea(r)){var a=ta.retrieve("suppressed.areas");a.push(r),ta.store("suppressed.areas",a)}}},getSuppressedAreas:function(){var e=ta.retrieve("suppressed.areas");return e||(e=[],ta.store("suppressed.areas",e)),e},getSuppressedAreasAsString:function(){var e=ta.commerce.meta.tracking.getSuppressedAreas(),r="";if(e.length>0)for(var a=0;a<e.length;a++)r+=e[a]+";";return r},hasAnySuppressedAreas:function(){var e=ta.commerce.meta.tracking.getSuppressedAreas();return e.length>0},containsSuppressedArea:function(e){if(!e)return!1;for(var r=ta.commerce.meta.tracking.processNavArea(e),a=ta.commerce.meta.tracking.getSuppressedAreas(),t=0;t<a.length;t++)if(a[t]==r)return!0;return!1},removeSuppressedArea:function(e){if(e){var r,a,t=ta.commerce.meta.tracking.processNavArea(e);if(ta.commerce.meta.tracking.containsSuppressedArea(t))for(var n=ta.commerce.meta.tracking.getSuppressedAreas(),i=0;i<n.length;i++)n[i]==t&&(a=i,r=!0),r&&(n=ta.commerce.meta.tracking.removeElementByIndex(n,a),ta.store("suppressed.areas",n))}},removeElementByIndex:function(e,r){return e&&r>=0&&r<e.length&&e.splice(r,1),e},clearSuppressed,[])}};
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/commerce/MetaPolling","ta/meta/LinkTracking"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-commerce-meta","files":{"js3":{"src":{"ta":{"meta":{"LinkTracking":1},"commerce":{"MetaPolling":1}}}}},"_":{"baseUrl":"/"}});
define("ta/commerce/MetaPolling",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(e,t,n){var l={setPollingAttemptForRequest:function(e,t){var n=l.getPollingMap();t||(t=1),n[e]=t,l.setPollingMap(n)},getPollingAttemptForRequest:function(e){if(l.isRequestBeingPolled(e)){var t=l.getPollingMap(),n=t[e];if(n)return n}},getPollingWaitTimeForRet(t)},isRequestBeingPolled:function(e){var t=l.getPollingMap(),n=e&&t[e];return!!n},incrementPollingAttemptForRequest:function(e){var t=l.getPollingMap(),n=t[e];return n&&(n+=1,t[e]=n),l.setPollingMap(t),n},clearAllPollingInfo:function(){n.store("ta.meta.polling.map")},removePollingInfoForRequest:function(e){if(l.isRequestBeingPolled(e)){var t=l.getPollingMap();delete t[e],l.setPollingMap(t)}},getPollingMap:function(){var e=n.retrieve("ta.meta.polling.map");return e||(e={},n.store("ta.meta.polling.map",e)),e},setPollingMap:function(e){e&&n.store("ta.meta.polling.map",e)},getPollWaitTimeForPollingAttempt:function(e){if("number"!==typeOf(e)||e<0)return 1e3;switch(e){case 1:case 2:case 3:case 4:return 1e3;case 5:case 6:case 7:return 1500;case 8:case 9:case 10:return 2e3;case 11:return 5e3;case 12:return 15e3;default:return 3e4}},getMaxPollingAttemptNumber:function(){return 13}};return t.exportTo(l,"ta.commerce.meta.polling"),l});
ta.commerce.meta.horizontalXSell=function(){var e=10,t=1e3,a=!1,n=null,r=null,i=null,o=0,l=function(e){return!(!e.contains("hacComplete")||!e.contains("hacMiniOfferNotAvailable")&&!e.contains("hacMiniOfferUnavailable"))},c=function(e){return!!d()&&!e.contains("hacMiniOfferUnavailable")},s=function(a,i){try{if(ta.retrieve("ta.redirectingPage"))return;i||(o=0),n=(new Date).getTime();var l=n,c=ta.widgets.calendar.getCheckRatesData();if(!c)return;var u={metaReferer:window.pageServlet},m=Object.merge(c,{detail:a,"reqNum":i?"2":"1","type":"horizontal_hr"},u),d=Object.toQueryString(m);if(!d||!d.trim())return void ta.util.error.record(null,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell - toQueryString failure",null,m);new Request({"url":"/MetaBestPriceCrossSellAjax","data":m,"evalScripts":!0,"onSuccess":function(c){if(l==n){var u=new Element("div",{html:c}),m=u.getElement(".xsellHacStatusReady")||u.getElement(".xsellHacStatusSOL")||i;if(ta.has("meta.full_meta_photos_v3")&&(c+='<div class="gap_spacer"></div>'),!m&&o<e)setTimeout(function(){o+=1,s(a,!0)},t);else{var d=ta.id("HORIZONTAL_CROSS_SELL"),S=u.getElement(".metaMicro");if(d&&S){if(d.getElement(".metaMicro"))d.setContent(c);else{d.setStyle("opacity","0");var v=new Fx.Tween(d,{property:"opacity"});d.setStyle("height",0);var g=122,h=new Fx.Tween(d,{property:"height",onComplete:function(){d.setStyle("height","auto"),d.setContent(c),v.start(0,1)}});h.start(0,g)}r&&r(),f(!0)}}}},"onFailure":function(){ta.retrieve("ta.redirectingPage")||ta.util.error.record(null,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(e){ta.util.error.record(e,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell")}},u=function(e,t){if(e&&e.getElement(".bc_flags")){var a=e.getElement(".bc_flags").className;c(a)?m():l(a)&&s(t,!1)}},m=function(){var e=ta.id("HORIZONTAL_CROSS_SELL"),t=ta.id("HORIZONTAL_CROSS_SELL_LIST"),a=document.getElement("#HORIZONTAL_CROSS_SELL_LIST .lodging");if(e&&t&&a){var n=t.getSize().y;e.setStyle("height",n);var r=new Fx.Tween(t,{duration:200,property:"opacity",onComplete:function(){t.addClass("hidden"),o.start(n,0).L=""})}});r.start(1,0);var o=new Fx.Tween(e,{duration:"long",property:"height"});i&&i(),f(!1)}},d=function(){return a},f=function(e){a=e},S=function(e){r=e},v=function(e){i=e};return{updateHorizontalXSell:u,removeHorizontalXSell:m,isLoaded:d,setLoaded:f,setOnloadFunction:S,setOnRemoveFunction:v}}(),ta.commerce.meta.horizontalXSellExtensions={putAvafBelowMap:function(){if(!ta.commerce.meta.horizontalXSell.isLoaded()){var e=ta.id("AV_ABOVE_FOLD_META"),t=ta.id("RHS_MAP"),a=e.parentNode;if(e&&t&&a){var n=a.getElement(".bxDivider.map");n?(a.insertBefore(n,e),a.insertBefore(t,n)):a.insertBefore(t,e)}}},putAvafAboveMap:function(){if(ta.commerce.meta.horizontalXSell.isLoaded()){var e=ta.id("AV_ABOVE_FOLD_META"),t=ta.id("RHS_MAP"),a=e.parentNode;e&&t&&a&&a.insertBefore(e,t)}}};
ta.meta||(ta.meta={}),ta.meta.link||(ta.meta.link={}),function(e){function t(t,a,o,l,c,m,u,g,d,s){"use strict";var f=t,p=new RegExp("(&|\\?)area=[^&]*");if(f=f.replace(p,"$1area="+a),crPageServlet){var v=new RegExp("(&|\\?)from=[^&]*");f=f.replace(v,"$1from=HotelDateSearch_"+crPageServlet)}var _=ta.commerce.meta.tracking.setTimingForNavArea(a);if(_&&m&&!m.hasClass("bookableOffer"))if(f.contains("&metaRequestTiming=")){var h=new RegExp("(&|\\?)metaRequestTiming=[^&]*");f=f.replace(h,"&metaRequestTiming="+_)}else f+="&metaRequestTiming="+_;if(g&&(f+="&m="+g),d&&(f+="&priceShown="+d),s&&(f+="&cpn="+s),document.location&&document.location.href){var P=e.extractPageLocId(document.location.href);P&&(f+="&pageLocId="+P)}var k=f.indexOf("/StartBooking")>=0;k&&crPageServlet&&(f=f+"&from="+crPageServlet),ta.has("assisted_booking_clicks_new_tab")&&c===e.OPEN_IN_NEW_TAB&&k&&ta.browser&&ta.browser.isIE10Metro()&&(c=e.OPEN_IN_SAME_TAB),ta.has("tablet_google_search_app_open_same_tab")&&/GSA\/[0-9]{2}/.test(window.navigator.userAgent)&&(c=e.OPEN_IN_SAME_TAB),k&&ta.page&&ta.page.maybeOpenInlineBooking&&ta.page.maybeOpenInlineBooking(null,l,m,null,f)||(c===e.OPEN_IN_NEW_TAB?r(f,u,o,m):c===e.OPEN_IN_SAME_TAB?n(f,m):i(o,f,u),window.IS_DEBUG&&ta.store("ta.lastCommerceClickUrl",f))}function a(){try{document.domain=document.domain}catch(e){return!0}return!1}function r(e,t,r,o){var i=a(),l=window.open(i?e:"","_blank");return!l&&"undefined"!=typeof Browser&&Browser.ie&&ta.has("ta.ie_commerce_popup_block_fix")&&ta.has("assisted_booking_clicks_new_tab")&&e.indexOf("/StartBooking")>=0?(ta.util&&ta.util.cookie&&ta.util.cookie.setPIDCookie(38822),void n(e,o)):(!i&&ta.popups.PopUtil.redirectToUrl(l,e),void ta.popups.PopUtil.pollForPartnerLoad(l,new Date,r,ta.popups.PopUtil.extractSlotFromCommerceUrl(e),crPageServlet))}function n(e,t){if(ta.meta.treeTrack.logTrackingTreeClickEvtCookie(e,t),ta.meta&&ta.meta.treeTrack){var a=function(){o(e)};if(t&&null!=t.getParentBySelector(".metaCheckRatesOverlay"))ta.meta.treeTrack.logLightboxTreeImpression(a);else if(ta.meta.treeTrack.isInitialized())try{ta.meta.treeTrack.logTreeImpression(a)}catch(t){ta.util.error.record(t," Error in openMetaProviderSameTab"),o(e)}else ta.retrieve("allowSamePageClickWithoutTrackingTree")===!0&&o(e)}else o(e)}function o(e){ta.retrieve("ta.isIE11orHigher")?window.open(e,"_self",null,!1):window.location.href=e}function i(e,t,a){var r,n=e,o=ta.popups.PopUtil.getProviderWindowDims(n,!0),i=1;window&&window.chrome&&(i=0),r={customWidth:o.customWidth,customHeight:o.customHeight,widthOffset:o.widthOffset,heightOffset:o.heightOffset,name:n,url:t,scrollbars:i,providerLogo:a},ta.popups.PopUtil.createCheckRatesWindow(r)}function l(e){var t=ta.retrieve("ta.meta.navArea");(!t||t.indexOf(e)<0)&&ta.store("ta.meta.navArea",e)}function c(e,t,a,r){var n="";t.getParent(".persistentCR")?n=r?"|PCR":"PCR":t.getParent(".photosOverlay")||t.getParent("#LOC_PHOTO_ALBUMS")?n=r?"|Photo_Lightbox":"Photo_Lightbox":t.getParent(".amenities_lightbox")?n=r?"|Amenities_Lightbox":"Amenities_Lightbox":t.getParent("#CHECK_RATES_LB")&&(n=r?"|Photo_LB":"Photo_LB"),n=n?"|"+n:"",e=e?e:"",n=n?n:"",a=a?a:"";var o=[e,n,a].join("|").replace("||","|").replace(/(\|$)/g,"");return o}function m(e,t,a,r,n){ta.util.error.record(e,t,null,{servlet:window.pageServlet,url:a,area:r},n)}function u(e,t){var a,r={"data-navArea-metaType":null,"data-navArea-linkType":null,"data-navArea-availability":null,"data-navArea-placement":null},n=4;if(t)for(a in r)t.hasOwnProperty(a)&&(r[a]=t[a],n--);for(var o=null;e&&n>0;){for(a in r)null===r[a]&&(r[a]=e.get(a),null!==r[a]&&("@trigger"===r[a]&&(o=e),n--));e=e.getParent()}for(;"@trigger"===r["data-navArea-placement"]&&o;){for(;o&&!o.overlay;)o=o.getParent();for(o&&o.overlay.options&&o.overlay.options.trigger?o=o.overlay.options.trigger:(o=null,r["data-navArea-placement"]="null");o&&(r["data-navArea-placement"]=o.get&&o.get("data-navArea-placement"),null===r["data-navArea-placement"]);)o=o.getParent()}var i=[];for(a in r)i.push(r[a]?r[a]:"null");return window.isTabletOnFullSite?i.push(g()?"Portrait":"Landscape"):i.push("Desktop"),i.join("|")}function g(){return ta.common&&ta.common.tablet?ta.common.tablet.isPortrait():window.matchMedia&&window.matchMedia("(orientation: portrait)")&&window.matchMedia("(orientation: portrait)").matches}function d(e){if(!e||e.isVisible())return e;var t=e.get("data-locationid"),a=e.get("data-contentid"),r=".offer";r=e.hasClass("bookableOffer")?r+'.bookableOffer[data-locationid="'+t+'"]':r+'[data-locationid="'+t+'"][data-contentid="'+a+'"]';var n=document.getElement(r);return n?n:e}e.click||(e.OPEN_IN_NEW_TAB="new_tab",e.OPEN_IN_SAME_TAB="same_tab",e.OPEN_IN_NEW_WINDOW="new_window",e.getUrlFromClickElem=function(e){if(!e)return null;var t=e.get("data-commerceClickData");if(!t||!t.trim||""===t.trim()||"function"!=typeof asdf)return null;t=asdf(t).replace(/&amp;/g,"&");var a=ta.retrieve("tracking.impression.key");if(e.hasClass("inlineOffer")&&a){var r=/ik=[a-zA-Z0-9]*/;t=t.replace(r,"ik="+a)}return t},e.getPartnerFromClickElem=function(e){if(!e)return null;var t=e.get("data-offerauthor");return t&&t.trim&&""!==t.trim()?t.trim():null},e.click=function(a,r){"use strict";var n,o,i,l,c,u,g,s,f,p,v=ta.id(r);try{if(v=d(v),n=e.getUrlFromClickElem(v),!n)return;o=v.get("data-vendorName"),i=v.get("data-offerauthor")||v.get("data-offer-author"),l=v.get("data-locationId"),c=e.getNavAreaFromClickElem(v),u=v.get("data-contentId"),g=v.get("data-openBehavior"),s=v.get("data-imageUrl"),f=v.get("data-mcid"),p=v.get("data-pernight"),n&&o&&l?t(n,c,o,l,g,v,s,f,p,i):m(null,"Invalid commerce click",n,c)}catch(e){m(e,"Invalid commerce click",n,c)}setTimeout(function(){try{ta.fireEvent("metaLinkClick",v,o,c,l,u,g,ta.popups.PopUtil.extractSlotFromCommerceUrl(n))}catch(e){m(e,"Commerce click tracking failed",n,c)}},300)},e.getNavAreaFromClickElem=function(e){var t,a,r=ta.id(e),n=r.get("data-navArea");n||(t=r.get("data-navAreaPre"),a=r.get("data-navAreaPost"),n=c(t,e,a)),n&&(n=n.replace("+","|")),ta.browser.isIE10Metro()&&(n="QC_Meta_Metro_Lightbox"),e.getParent("#LOC_PHOTO_ALBUMS")?n+=e.getParent(".featuredImageWrap")?"|PHOTOS_LB|Featured_Reel":"|PHOTOS_LB":e.getParent("#AMENITY_LIGHTBOX")&&(n+="|AMENITIES_LB"),l(n);var o=n;return n=u(r),null!=n&&n.indexOf("null")==-1&&n.indexOf("Unknown")==-1||(n=o),n},e.extractPageLocId=function(t){return e.urlArgNumeric(t,"d","detail")||e.urlArgNumeric(t,"g","geo")},e.urlArgNumeric=function(e,t,a){var r=new RegExp("(-"+t+"([0-9]+))|([?&]"+a+"=([0-9]+))"),n=r.exec(e);if(n){if("undefined"!=typeof n[2])return n[2];if("undefined"!=typeof n[4])return n[4]}return null},e.photoClick=function(t,a,r,n,o){r.hasOwnProperty("area")&&(r.area=e.getPhotoNavArea(t)),require("ta/util/Doer").aimdoit(a,r,n,o)},e.getPhotoNavArea=function(e){return u(e,{"data-navArea-metaType":"Pro_Photo","data-navArea-availability":"NA"})},e.updateNavAreaInCommerceUrl=function(t,a){if(a){var r=e.getNavAreaFromClickElem(a),n=new RegExp("(&|\\?)area=[^&]*");t=t.replace(n,"$1area="+r)}return t})}(ta.meta.link);
define("ta/meta/LinkTracking",["vanillajs","api-mod","ns-exporter","ta/Core/TA.Event","ta/util/Error","utils/ajax","ta/Core/TA.Store","ta/Core/TA.Record","utils/urlutils"],function(e,t,r,a,c,i,o,n,l){"use strict";function k(e,t,r,a,i,o){try{u(t,r,a,o)}catch(e){try{c.record(e,"trackMetaClick failure")}catch(e){}}try{if(!e||!(e.className||"").match(/\bbookableOffer\b/)){var n=e&&e.getAttribute("data-pernight")||"",k=e&&e.getAttribute("data-commerceclickdata")||"",d=l.getUrlQueryArgs(l.asdf(k.trim()).replace(/&amp;/g,"&")),g=d&&d.gosox||"";s(a,!0,i,n,g)}}catch(e){try{c.record(e,"trouble loading click-out pixels")}catch(e){}}try{o!=ta.meta.link.OPEN_IN_SAME_TAB&&m(e)}catch(e){try{c.record(e,"problem in ibdmImpressionTracking")}catch(e){}}}function m(e){ta.meta&&ta.meta.treeTrack&&(t.getParent(e,"metaCheckRatesOverlay")?ta.meta.treeTrack.logLightboxTreeImpression():ta.meta.treeTrack.isInitialized()&&ta.meta.treeTrack.logTreeImpression(),ta.meta.treeTrack.logTrackingTreeClickTrk(e))}function s(e,t,r,a,i){try{var o={locId:e,isMetaCheckRates:t,contentId:r,selectedPrice:a,offerStr:i};require(["trjs!ta/common/behavior/Ads-pagemoniker"],function(e){e.loadClickoutMonikers(o)})}catch(e){c.record(e,"click out monikers failure (meta="+t+")")}}function u(e,t,r,a){var c="CheckRates",i=1;n.trackPhysicalCommerce(c,t,i,r),n.trackAttemptedCommerce(c,t,e,i);var o=a?a===ta.meta.link.OPEN_IN_NEW_TAB?"TAB_OPENED":a===ta.meta.link.OPEN_IN_NEW_WINDOW?"WINDOW_OPENED":"SAME_TAB":"";n.trackEventOnPage("COMMERCE_CLICK",o,e||"")}var d={};return d.setup=function(){try{a.on("metaLinkClick",k)}catch(e){c.record(e,"trouble building event - metaLinkClick")}},d.actionR"+e)},d.restoreCRPageSet=e)},r.exportTo(d,"ta.meta.linkTracking"),d});
ta.meta.treeTrack||(ta.meta.treeTrack={}),function(e){function t(){if(!i.hotelListSelector||!i.singleHotelSelector)return 0;var e=0,t=0,r=document.getElements(i.hotelListSelector);return r.each(function(r){r.getElements(i.singleHotelSelector).each(function(r){r.match(i.singleHotelSelector)&&(e++,r.isFullyVisible()&&(t=e))})}),t}var r=!1,i={hotelListSelector:null,singleHotelSelector:null,placementName:null,getImpressionString:null},n="ibdm_impression_tracking";e.init=function(e){return r?(ta.util.error.record(null,"ta.meta.treeTrack should be initialized only once"),!1):(i=e,void(r=!0))},e.isInitialized=function(){return r},e.hasTrackingTree=function(e){if(!e||"undefined"==typeof e.previousSibling)return!1;var t=e.previousSibling||e.nextSibling;return!!t&&(!!a(t)||a(t.previousSibling))};var a=function(e){if(e){var t=e.nodeValue;return t&&(t.contains("trk")||t.contains("etk"))}return!1};e.logImpressionTreeOnPageLoad=function(){if(ta.retrieve("assisted_booking_desktop_entry.logTreePoll")&&ta.widgets.calendar.hasPageDates()&&!ta.retrieve("vrTabOnHotels")){var t,r=1,i=4;if(!ta.retrieve("treeTrackImpressionInProgess")){ta.store("treeTrackImpressionInProgess",!0);var n=setInterval(function(){ta.retrieve("isTrackTreeFresh")&&(t=e.logTreeImpression(null,r<i)),!t&&r<i?r++:(ta.store("isTrackTreeFresh",!1),ta.store("treeTrackImpressionInProgess",!1),clearInterval(n))},2e3)}}},e.logTreeImpression=function(e,a){if(!ta.retrieve(n)||ta.retrieve("vrTabOnHotels"))return e&&e(),!1;if(!r)return ta.util.error.record(null,"ta.meta.treeTrack.logTreeImpression called before being initialized"),e&&e(),!1;var o=t(),l=i.getImpressionString(o);return!l&&o<=0?(e&&e(),!1):l&&l.indexOf("I:IllegalContext")===-1?(ta.recordImpression(l,e),!0):(a||ta.util.error.record(null,"ta.meta.treeTrack.logTreeImpression called but no tracking tree html found!",null,{},"WARN"),e&&e(),!1)},e.logLightboxTreeImpression=function(e){if(!ta.retrieve(n))return e&&e(),!1;var t=o();return t?(ta.recordImpression(t,e),!0):void(e&&e())};var o=function(){var e=$$(".metaCheckRatesOverlay .impressionTrackingTree");if(e)return e[0].innerHTML};e.getElmtPriceData=function(e){var t=[];if(!e)return t;var r="PP:";r+=e.getAttribute("data-pernight")?e.getAttribute("data-pernight"):"-1",t.push(r);var i="PN:";return i+=e.getAttribute("data-offer-author")?e.getAttribute("data-offer-author"):"None",t.push(i),t},e.logTrackingTreeClickTrk=function(t){if(ta.retrieve(n)&&e.hasTrackingTree(t))if(t.hasClass("bookableOffer"))ta.trk("sherpa_click",!1,t);else{var r=e.getElmtPriceData(t);ta.trk("meta_click",!1,t,r)}},e.logTrackingTreeClickEvtCookie=function(t,r){ta.retrieve(n)&&e.hasTrackingTree(r)&&(r.hasClass("bookableOffer")?ta.setEvtCookieAndPath("sherpa_click",t,r):ta.setEvtCookieAndPath("meta_click",t,r))},e.getElmtHight}}(ta.meta.treeTrack);
ta.meta.update||(ta.meta.update={}),ta.on("newInlinePageDe,t)}),ta.on("metaOnlyUpdate",function(e){ta.meta.update.request(e,null,!0)}),function(e){function t(e){var t=ta.id("PROVIDER_BLOCK");if(t){if("undefined"!=typeof CDNHOST){var a='<img class="provLoading" src="'+CDNHOST+'/img2/meta_sprites/loadingAnim.gif">';t.getElements(".rightBox").each(function(e){e.setContent(a)})}var r=t.get("html"),i=1e3,n="metaHacRequest_"+i+"_cancel";ta.remove(n),new Request({url:ta.meta.update.buildUrl("MetaCheckRatesAjax",e,!0),onSuccess:function(a){t.setContent(a),ta.fireEvent("refreshedDOMContent",t),ta.meta.update.overlayRequest(e)},onFailure:function(){t.setContent(r)}}).send()}}function a(e,a){"pop"==a?(ta.store("ta.meta.request.locId",e),ta.store("ta.meta.request.placement",a),ta.run("ta.overlays.Factory.metaCheckRatesOverlay")):"met"!=a&&"solb"!=a||ta.has("meta.widget")||t(e)}function r(e){var t,a,r=0,i=0;return e=ta.id(e),a=e.getChildren("#HR_HACKATHON_CONTENT .roomPrice"),t=e.getChildren("#HR_HACKATHON_CONTENT .textLinks .offer .price"),a&&(r=a.length),t&&(i=t.length),r+i}function i(t,a,r,i,n){if(!ta.retrieve("tablet_maps_v1")||!ta.retrieve("maps_v2_open")){r||(r=0),i||(i=!1);var l="miniMetaHacRequest_curCancelKey",c=13;null==a&&(a=(new Date).getTime());var s="miniMetaHacRequest_"+a+"_cancel";if(ta.retrieve(s)!==!0){if(ta.has(l)){var m=ta.retrieve(l);m!=s&&(ta.store(m,!0),ta.commerce.meta.polling.removePollingInfoForRequest(m))}ta.has(s)||(ta.store(s,!1),ta.store(l,s));var d;if(ta.commerce.meta.polling.isRequestBeingPolled(s)){if(d=ta.commerce.meta.polling.getPollingAttemptForRequest(s),!d||d>c)return void ta.commerce.meta.polling.removePollingInfoForRequest(s)}else d=1,ta.commerce.meta.polling.setPollingAttemptForRequest(s,d);var v=[];if(i)for(var g=$$("#CHECK_RATES_CONT div.premium:not(.tripConnectDemo)"),p=0;p<g.length;p++){var _=g[p].get("data-contentid");v.push(parseInt(_,10))}if(r<1){var f;ta.has(R)&&(f=ta.retrieve(R),clearTimeout(Number.from(f))),ta.has(T)&&(f=ta.retrieve(T),clearTimeout(Number.from(f))),f=setTimeout(function(){u()},6e4),ta.store(R,Number.from(f))}var h=ta.retrieve("hotels.datesChanged");h&&ta.has("hac_timezone_awareness")&&e.clearDatesBumpedMessage(),new Request({url:ta.meta.update.buildUrl("MiniMetaCRAjax",t,!0,null,"QC_Meta_Mini",r,v,i,s,h,n),onSuccess:function(e){o(!1,e,t,a,r,i,s,h)},evalScripts:!0}).send()}}}function n(e){e.getChildren()t,e)})}function o(e,t,a,r,o,s,d,u){if(ta.retrieve(d)!==!0){var v,g,p,R,k;if(e){var b=ta.select("#CHECK_RATES_CONT fieldset")[0];t=b.get("html"),v=new Element("div",{html:t}),g=!0,p=document.getElement(".similarCarousel"),R=v.getChildren()}else v=new Element("div",{html:t}),n(v),g=t.contains("hacMiniComplete"),p=document.getElement(".similarCarousel"),R=Elements.from(t);if((!p||o<1)&&(ta.commerce.meta.updateProvArea(v.getElement(".postShowMetaCR")),ta.fireEvent("miniMetaOnHRUpdate",t)),!document.getElement(".dropdownMiniMeta")){var M=document.getElement(".postShowMetaCR");M&&l(t,M)}if(c(t),ta.retrieve("hotel_review_low_price_message")&&v.getElement(".price_alert_update")){var A=document.getElement("#PRICE_ALERT_RIBBON_CONTAINER");if(A&&(k=A.getElementById("PRICE_ALERT_RIBBON"),k&&k.destroy(),k=v.getElement(".price_alert_update").getElement(".price_alert_ribbon"))){A.innerHTML=k.outerHTML,ta.util.element.makeTextFitOneLine("#PRICE_ALERT_RIBBON",!1);var O=k.getElement(".priceAlertText b");g&&O&&O.innerHTML&&O.innerHTML.length>0&&ta.trackEventOnPage("hotel_review_low_price_message","Display",O.innerHTML)}ta.fireEvent("priceAlertRibbonUpdated")}if(g&&!t.contains("bookableOffer")&&window.fireEvent("hacComplete_noBookingOffersFound"),(g||s)&&t.contains("bookableOffer")&&ta.fireEvent("hacComplete_bookingOffersFound"),!g&&ta.has("meta.isHackathonBC")&&t.contains("firstRequest")){var P=setTir,o)},5e3);ta.store(T,Number.from(P))}if(g&&ta.has(T)){var H=ta.retrieve(T);clearTimeout(Number.from(H))}var y=".metaDatesChosen",N=".metaDatesChosen",D=ta.retrieve("meta.bc.bestPricesForYourStay");if(g){if(ta.has("meta.isHackathonBC")){var I=D;if(t.contains("allNotAvailable")){var w=ta.id("priceNotAvailMsg");I=w?w.innerHTML:ta.retrieve("meta.bc.pricesTravelSitesNotAvailDates")}if(ta.commerce.meta.updateHeaderMsg(N,I),ta.has("guests_rooms_picker_3.enabled")&&ta.commerce.meta.updateHeaderDates(),ta.has("guests_rooms_picker_4.enabled")&&ta.overlays&&ta.overlays.NumberPickerOverlay&&ta.overlays.NumberPickerOverlay.updateHeaderMsg(y),ta.retrieve("meta.full_meta_photos")){var S=document.getElement(".metaDatesChosen");S&&(t.contains("allNotAvailable")?S.addClass("no_offers_available"):S.removeClass("no_offers_available"))}ta.commerce.meta.polling.removePollingInfoForRequest(d),ta.commerce.meta.displayBlueChevronLowestPriceCTA(),ta.fireEvent("HRHacComplete"),s||_(r,!1);var q=document.getElement(".similarCarousel");s&&q&&f(t),e||setTimeout(function(){h()},1e3)}}else ta.has("meta.isHackathonBC")&&t.contains("anyOfferCompletedSuccessfully")&&(ta.commerce.meta.updateHeaderMsg(N,D),ta.has("guests_rooms_picker_3.enabled")&&ta.commerce.meta.updateHeaderDates()),ta.has("guests_rooms_picker_4.enabled")&&ta.overlays&&ta.overlays.NumberPickerOverlay&&ta.overlays.NumberPickerOverlay.updateHeaderMsg(y),ta.commerce.meta.polling.incrementPollingAttemptForRequest(d),setTimeout(function(){i(a,r,o+1,s)},ta.commerce.meta.polling.getPollingWaitTimeForRequest(d));ta.fireEvent("onHACUpdate",t),!g||ta.retrieve("hotels_to_seo_hotels_redirect")||!u||s||t.contains("cancelRedirect")||(t&&t.match(/\shacComplete\s.*\shacMiniOfferNotAvailable\s/g)&&ta.trackEventOnPage("NoAvailability","redirect","",0,"/HotelHighlight"),t&&t.match(/\shacComplete\s.*\shasDisplayUnavailability\s/g)&&ta.trackEventOnPage("MaybeAvailable","redirect","",0,"/HotelHighlight")),g&&ta.fireEvent("HRHacAvailabilityDetermined",{availability:ta.commerce.meta.getResponseAvailability(t),loadingTimeoutPassed:s,cancelRedirect:t.contains("cancelRedirect"),datesChanged:u,hasBookableOffer:t.contains("bookableOffer")}),C(g,v),E(r,g,s)}}function l(e,t){var a=new Element("div",{html:e}),r=a.getElement(".dropdownMiniMeta");r&&r.inject(t)}function c(e){var t,a,r,i=document.getElement(".rgba_flyout.dropdownMiniMeta");i&&(t=new Element("div",{html:e}),r=t.getElement(".dropdownMiniMeta"),r&&(a=i.getElement(".inner"),a.innerHTML="",r.set("class","dropdownMiniMeta"),a.adopt(r)),s())}function s(){ta.retrieve("dropdownMiniMeta.hover")?ta.commerce.meta.hoverTopOffer():ta.retrieve("dropdownMiniMeta.blur")&&ta.commerce.meta.blurTopOffer()}function m(e,t,a){v(),_(t,!0),i(e,(new Date).getTime(),a+1,!0)}function d(e){var t="";return ta.browser.isIE10Metro()?t="QC_Meta_Book_Inline"==e?"QC_Meta_Metro_Inline":"QC_Meta_Metro_Lightbox":e?t=e:ta.has("ta.meta.navArea")?t=ta.retrieve("ta.meta.navArea"):(ta.retrieve("maps_v2_open")&&ta.trackEventOnPage("QC_Meta_Map_Detail","map_open"),t="QC_Meta_Lightbox"),t}function u(){var e=document.getElement("#CHECK_RATES_CONT div.hacMiniComplete"),t=document.getElement("#CHECK_RATES_CONT div.hacMiniCompleteTimeOut");if(!e&&!t){var a=document.getElement("div.bc_flags");a&&a.addClass("hacMiniCompleteTimeOut"),v(),h()}}function v(e){var t=e?"metaHacRequest_curCancelKey":"miniMetaHacRequest_curCancelKey";if(ta.has(t)){var a=ta.retrieve(t);ta.store(a,!0),ta.commerce.meta.polling.removePollingInfoForRequest(a)}}function g(){var e=document.getElements("#CHECK_RATES_CONT span.textLinkLoading"),t=document.getElements("#CHECK_RATES_CONT div.loading"),a=0;return e&&(a+=e.length),t&&(a+=t.length),a}function p(e,t){var a,r;if(e&&t){if(a=t+"_suppressCommerceImpressionState",r=ta.commerce.meta.polling.getPollingAttemptForRequest(t))if(1===r){if(ta.retrieve("meta.isFromDatesChange"))return ta.remove("meta.isFromDatesChange"),ta.store(a,!0),e+="&isFirstPageLoad=false"}else if(ta.retrieve(a))return e+="&isFirstPageLoad=false";return e}}function _(e,t){var a=0,r="unknown";if(t){a=5e3;var i=g(),n=document.getElements("#CHECK_RATES_CONT div.premium"),o=document.getElements("#CHECK_RATES_CONT span.textLink"),l=0;n&&(l+=n.length),o&&(l+=o.length);var c=l-i;if(l>0){var s=10*Math.round(c/l*10);s%10===0&&s>-1&&s<101&&(r=""+s+"percent")}}else a=(new Date).getTime()-e,r="100percent";ta.trackEventOnPage("HAC","HACComplete",r,a,!0)}function f(e){var t=Elements.from(e)[0];if(t){var a=t.getElementsByClassName("price"),r=t.getElementsByClassName("priceBlock"),i=0;a&&(i+=a.length),r&&(i+=r.length),ta.trackEventOnPage("HAC","StateCarouselDisplayed","",i,!0)}}function h(){var e=g();e>0&&ta.trackEventOnPage("HAC","HACError","LoadingAfterHACComplete",e,!0)}function C(e,t){if(e&&ta.retrieve("ibdm_impression_tracking")){var a=t.getElements(".impressionTrackingTree");if(a){var r;for(r=0;r<a.length;++r)ta.trkImpTree(a[r])}}}function E(e,t,a){if(t||a){var r="meta.lowestPricePromotionTracking.tracked"+e;if(ta.has("meta.lowestPricePromotionTracking")&&!ta.has(r)){var i=ta.retrieve("meta.lowestPricePromotionTracking");i&&i.bidDifference&&i.priceDifference&&i.bidDifference>=.43&&i.priceDifference>=10&&(ta.store(r,!0),ta.trackEventOnPage("lowest_price_promoted_impression",i.providers,i.bidDifference+"|"+i.priceDifference))}}}var R="miniMetaHacRequest_longTimeoutKey",T="miniMetaHacRequest_appearLoadedTimeoutKey";e.request=function(e,t,r){i(e,null,0,!1,r),a(e,t)},e.completeOnInitialPage=function(e){o(!0,"",e)},e.buildUrl=function(e,t,a,r,i,n,o,l,c,s,m){var u=d(i),v=ta.widgets.calendar.getCheckRatesData(),g="",_="",f="",h="",C="";v&&(g=Object.toQueryString(v)),r&&(_="&metaVersion="+r),ta.has("meta.baseLocationId")&&(f="&baseLocId="+ta.retrieve("meta.baseLocationId")),(ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")||ta.retrieve("checkrates.hr_bc_see_all_click")||ta.retrieve("checkrates.hr_bc_see_all_click.lb")&&"MetaCheckRatesAjax"===e)&&(h="&seeAllClick=true"),window.pageServlet&&(C="&imp=true&metaReferer="+window.pageServlet);var E=ta.retrieve("meta.requestFromArea");E||(E="",document.getElement("#LOC_PHOTO_ALBUMS")?E="&requestFromArea=pal":document.getElement("#AMENITY_LIGHTBOX")&&(E="&requestFromArea=amo"),ta.store("meta.requestFromArea",E));var R="/"+e+"?detail="+t+"&"+g+"&area="+u+"&returnAllOffers=true"+C+_+f+h+E,T=R;try{R=ta.commerce.meta.tracking.updateUrlWithTiming(R,u)}catch(e){ta.util.error.record(e,"problem updating url with timing in CheckRates.buildVarMetaHacUrl"),R=T}if(ta.commerce.meta.tracking.hasAnySuppressedAreas()){var k=ta.commerce.meta.tracking.getSuppressedAreasAsString();k&&(R+="&suppressImpressionsOnComplete="+k)}if(ta.retrieve("ta.commerce.suppress_commerce_impressions.enabled")){T=R;try{R=p(R,c),R||(R=T)}catch(e){ta.util.error.record(e,"problem updating url with isFirstPageLoad in CheckRates.buildVarMetaHacUrl"),R=T}}a&&(R+="&finalRequest=true"),n&&(R+="&numTries="+n),l&&(R+="&loadingTimeoutPassed="+l),s&&(R+="&isDateChangedRequest="+s);var b="ta.commerce.MetaHacOverlay.currency";ta.has(b)&&(R+="&currency="+ta.retrieve(b),ta.remove(b));var M=ta.retrieve("booking.tracking.context");return M&&(R+="&btc="+M),m&&(R+="&isMetaOnly="+m),R},e.overlayRequest=function(e,t,a,i,n){var o,l,c,s,m,d,u,v,g,p,_,f,h,C,E,R="metaHacRequest_curCancelKey",T=13;try{if(!e)return;if(ta.commerce.meta.clearStoredMiniData(),l=ta.widgets.calendar.getCheckRatesData(),null==t&&(ta.store("meta.travelData",l),t=(new Date).getTime(),c=!1,a?ta.has("metaCheckRatesUpdateDivInline")&&(c=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))):ta.has("metaCheckRatesUpdateDiv")&&(c=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))),c&&c.removeClass&&c.removeClass("hidden")),s="metaHacRequest_"+t+"_cancel",ta.has(R)&&(m=ta.retrieve(R),m!=s&&(ta.store(m,!0),ta.commerce.meta.polling.removePollingInfoForRequest(m))),a&&(d=document.getElement(".meta_rates_content .postShowMetaCR"),ta.has("checkrates.mini_meta_by_percent_cpc")&&ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")&&(u=d.getElement(".seeMore.threshold"),u&&(v=d.getElements(".postClickPrice.hide"),v.each(function(e){e.removeClass("hide")}),u.hide())),ta.commerce.meta.updateProvArea(d)),ta.has(s)||(ta.store(s,!1),ta.store(R,s)),ta.retrieve(s)===!0)return;if(g=ta.retrieve("metaCheckRatesOverlay"),!g&&!a)return;o=!1,g&&(o=g.inner),ta.has("metaCheckRatesUpdateDiv")&&(o=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))),a&&ta.has("metaCheckRatesUpdateDivInline")&&(o=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline")))}catch(e){ta.util.error.record(e,"overlayRequest setup")}if(o)try{if(ta.commerce.meta.polling.isRequestBeingPolled(s)){if(p=ta.commerce.meta.polling.getPollingAttemptForRequest(s),!p||p>T)return void ta.commerce.meta.polling.removePollingInfoForRequest(s)}else p=1,ta.commerce.meta.polling.setPollingAttemptForRequest(s,p);if(o.innerHTML.contains("hacComplete"))try{if(ta.commerce.meta.polling.removePollingInfoForRequest(s),f=ta.id("META_HAC_DATE_HEADLINE")){var k=f.getElements(".headlineLegend");k.length>=2&&(k.forEach(function(e){e.addClass("hidden")}),o.getElement(".anyOfferCompletedSuccessfully")?(k[0].removeClass("hidden"),ta.commerce.meta.hideBestPriceXsell("REC_CONT")):o.getElement(".partnersAllNotAvailable")&&k.length>2?(k[2].removeClass("hidden"),a?(ta.commerce.meta.loadBestPriceXsell(e,"REC_CONT_INLINE",{isInline:!0}),ta.commerce.meta.metaInYourMeta("REC_CONT_INLINE",{xsell:!1,inline:!0})):(ta.id("META_PRICE_XSELL")||ta.commerce.meta.loadBestPriceXsell(e,"REC_CONT",{isInline:!1}),ta.commerce.meta.metaInYourMeta("REC_CONT",{xsell:!1,inline:!1}))):(k[1].removeClass("hidden"),ta.commerce.meta.hideBestPriceXsell("REC_CONT")))}if(g&&ta.commerce.meta.storeMiniData(g.inner),ta.retrieve("assisted_booking_desktop_entry.logTreePoll")&&o){var b=o.getElement(".impressionTrackingTree");b&&ta.trkImpTree(b)}h=r(o),E="complete",a?ta.id("COMHVY")?(C="Mini-Meta",E+=ta.find(".NotShowing .postClickPrice")?"_may_be_available":ta.find("#HotelDateSearch .price .minCost")?ta.find(".strikeHigh")?"_available_lp_chevron":"_available":"_unavailable"):C="Metainline":C="meta_lightbox",o.innerHTML.contains("doneNoAvailability")?(ta.widgets.calendar.trackCalendarEvent("DATEPICKER","RESULTS_EMPTY",ta.widgets.calendar.getPageAdultsCount(),ta.widgets.calendar.getPageAdultsCount()),ta.id("MAYBE_BUTTONS_INLINE")&&a||ta.id("MAYBE_BUTTONS")&&!a&&"Mini-Meta"!=C?E+="|may_be_availabile":"Mini-Meta"!=C&&(E+="|unavailable")):ta.widgets.calendar.trackCalendarEvent("DATEPICKER","RESULTS_PRESENT",ta.widgets.calendar.getPageAdultsCount(),ta.widgets.calendar.getPageAdultsCount()),ta.trackEventOnPage(C,E,h.toString()),ta.commerce.meta.showLowestPriceCTA(a),ta.fireEvent("MetaLightboxHacComplete")}catch(e){ta.util.error.record(e,"overlayRequest - failure in complete results block")}else{_=!1,a&&(_="QC_Meta_Inline"),i||(i=1);var M=ta.meta.update.buildUrl("MetaCheckRatesAjax",e,!0,n,_,i);setTimeout(function(){new Request({url:M,onSuccess:function(r){ta.retrieve(s)||((ta.retrieve("metaCheckRatesOverlay")||ta.retrieve("metaCheckRatesUpdateDivInline"))&&(o.innerHTML=r,ta.fireEvent("refreshedDOMContent",o),ta.retrieve("checkrates.meta_ui_sk_box")&&ta.commerce.meta.restoreProviderHover()),(ta.meta.update.getMetaPricesCount(a)>0||p>9)&&ta.commerce.meta.hacIsBlockingXSell(a)&&(a?ta.commerce.meta.metaInYourMeta("REC_CONT_INLINE",{xsell:!1,inline:!0}):ta.commerce.meta.metaInYourMeta("REC_CONT",{xsell:!1,inline:!1})),ta.commerce.meta.polling.incrementPollingAttemptForRequest(s),ta.meta.update.overlayRequest(e,t,a,i+1,n))},evalScripts:!0}).send()},ta.commerce.meta.polling.getPollingWaitTimeForRequest(s))}}catch(e){ta.util.error.record(e,"meta HAC - ajax requests")}},e.displayRemainingProviders=function(e){try{for(var t=ta.id("CHECK_RATES_CONT"),a=t.getElements("li"),r=a.length;r--;)a[r].removeClass("hide");e.hide(),ta.store("checkrates.mini_meta_by_percent_cpc_see_all_click",!0)}catch(e){ta.util.error.record(e,"displayRemainingProviders")}},e.updateCRForm=function(e){try{if(ta.has("metaDatePickerEnabled"))return void ta.widgets.calendar.syncAllDatePickers();var t=ta.id("HotelDateSearch"+e),a=ta.id("HotelDateSearch"),r=["select","input[type=checkbox]","input[type=hidden]","input[type=text]"];if(t&&a)for(var i=r.length;i--;)for(var n=r[i],o=a.getElements(n),l=t.getElements(n),c=l.length;c--;)for(var s=l[c],m=s.id.split("_")[0],d=o.length;d--;){var u=o[d];if(u.id.contains(m)){if("input[type=checkbox]"==n){var v=u.getParent("li");if(v&&!v.hasClass("unavailable")){var g=s.getParent("li");g&&g.removeClass("unavailable")}}"select"==n?s.selectedIndex=u.selectedIndex:"input[type=checkbox]"==n&&"_pop"!=e?s.checked=u.checked:s.id.contains("hacPid")||(s.value=u.value)}}}catch(e){ta.util.error.record(e,"updateCRForm")}},e.getMetaPricesCount=function(e){var t,a=0,r=ta.retrieve("metaCheckRatesOverlay"),i=!1;if(r&&(i=r.inner),ta.has("metaCheckRatesUpdateDiv")&&(i=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))),e&&ta.has("metaCheckRatesUpdateDivInline")&&(i=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))),i)return t=i.getChildren("#HR_HACKATHON_CONTENT .roomPrice"),t&&(a=t.length),a},e.clearDatesBumpedMessage=function(){var e=ta.id("HAC_DATES_MOVED_FORWARD"),t=document.getElement("#CHECK_RATES_CONT .legend.metaDatesChosen");e&&t&&(e.dispose(),t.removeClass("hidden"))},e.cancelAllMetaCurrent(!0)}}(ta.meta.update);
ta.meta||(ta.meta={}),ta.meta.cross_sell||(ta.meta.cross_sell={}),function(e){function t(e,t){try{r=1,n=setTimeout(function(){a(e)},t)}catch(e){ta.util.error.record(e,"also viewed - avafWait")}}function a(e){try{ta.trk("AVAF_HOVER_EXPAND",!1,e),r=2;var t=ta.id("expand_av_on_hover");if(!t)return;t.removeClass("hidden"),t.addClass("expanding");var a=t.getSize().y;t.removeClass("expanding"),t.addClass("show");var n=t.getParent("#AV_ABOVE_FOLD_META");n&&n.setStyle("height","auto");var o=new Fx.Tween(t,{duration:"long",property:"height"});o.start(0,a)}catch(e){ta.util.error.record(e,"also viewed - avafExpand")}}var r=0,n=!1,o=0;e.relatedHoverOver=function(e,n){try{if(0!==r)return;0===n?a():t(e?e.target||e.srcElement:null,n)}catch(e){ta.util.error.record(e,"also viewed - avafIn")}},e.relatedHoverOut=function(e){try{if(1!=r||!n)return;if(e||(e=window.event),!e)return;for(var t=e.relatedTarget?e.relatedTarget:e.toElement,a=ta.id("ALSO_VIEWED_LIST");t&&t!=a&&"BODY"!=t.nodeName;)t=t.parentNode;if(t==a)return;clearTimeout(n),n=!1,r=0}catch(e){ta.util.error.record(e,"also viewed - avafOut")}},e.relatedExpand=function(e,t){var a,r;try{if(ta.trk("AVAF_EXPAND_"+(t?"MORE":"LESS"),!1,e?e.target||e.srcElement:null),t){if(a=ta.id("hideableMore"),!a)return;if(a.addClass("hidden"),a=ta.id("expand_av_on_more"),!a)return;a.removeClass("hidden"),0===o&&(a.addClass("expanding"),o=a.getSize().y,a.removeClass("expanding")),a.addClass("show"),new Fx.Tween(a,{duration:"long",property:"height"}).start(0,o)}else{if(a=ta.id("expand_av_on_more"),!a)return;new Fx.Tween(a,{duration:"long",property:"height"}).start(a.getSize().y,0).chain(function(){a.removeClass("show"),a.addClass("hidden"),r=ta.id("hideableMore"),r&&r.removeClass("hidden")})}}catch(e){ta.util.error.record(e,"also viewed - avafMore")}},e.relatedResetStateFlag=function(){r=0}}(ta.meta.cross_sell);
ta.meta.cr||(ta.meta.cr={}),function(e){function t(e){if(!ta.retrieve("checkrates.datesChanged"))try{var t=ta.id(e);t.getElements(".unavailable").each(function(e){e.removeClass("unavailable"),e.hasClass("js_ua_checked")&&e.getElements("input").set("checked",!0),ta.meta.update.updateCRFormElement(e)}),ta.store("checkrates.datesChanged",!0)}catch(e){ta.util.error.record(e,"_showSuppressedProviders")}}e.updateCRCalendar=function(a){a.form&&t(a.form),e.updateCRFormElement(this),ta.id("META_UI_INLINE")&&ta.meta.update.updateCRForm("_imt")},e.findInlineCRLocationId=function(){var e=null,t=ta.id("HotelDateSearch");if(t)for(var a=t.getElements("input[type=text]"),n=a.length;n--;){var i=a[n],r=i.id.match(/_(\d+)/);if(r.length){e=r[1];break}}return e},e.updateCRFormElement=function(e){try{e=ta.id(e);var t=e.get("tag").toLowerCase();"li"==t&&(e=e.getElement("input[type=checkbox]"));var a,n,i,r,l,c=e.id.split("_")[0],o=this.findInlineCRLocationId(),s=c+"_"+o,d=e.id,u=d.substring(d.length-4),m=[s,s+"_icr",s+"_per",s+"_imt"];if(this.crSyncExtensions.contains(u))for(a=m.length;a--;)s=m[a],s!=d&&(l=ta.id(s),l&&("li"==t&&"_pop"!=u?(l.checked=e.checked,n=e.getParent("li"),n&&!n.hasClass("unavailable")&&(i=l.getParent("li"),i&&i.removeClass("unavailable"))):"select"==t?l.selectedIndex=e.selectedIndex:"input"==t&&(r=s.substring(s.length-4),this.crSyncExtensions.contains(r)||(r=""),this.updateCRFormElement_In(o,e,u,r))))}catch(e){ta.util.error.record(e,"updateCRFormElement")}},e.getPropIdFromCRElement=function(e){if(e){var t=null;if(t=e.className.match(/id_(\d+)/))return t[1]}return null},e.removePCR=function(){var e=ta.retrieve("pcr.overlay");e&&e.hide()},e.availCheck=function(e){var t=ta.id("availability")&&"1"==ta.id("availability").value,a=ta.id(e).getElement(".overlaySrc");if(t&&a){var n=a.innerHTML;a.innerHTML=n.replace(/cid=(\w+_)?&amp;/,"")}},e.crSyncExtensions=["_pop","_icr","_pto","_per","_amo","_cro","_met","_imt","_pal","_inm"]}(ta.meta.cr);
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/util/Object"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-core-without-lite","files":{"js3":{"src":{"ta":{"util":{"Object":1}}}}},"_":{"baseUrl":"/"}});
!function(e,o){var t=function(e){var o=!1;return new Request({url:"/AuthCheck",data:{"product":e},async:!1,method:"get",onSu=!0)}}).send(),o};o.isAuthorized=function(e){return t(e)},o.register=function(o,i){var n="Deprecated_registration_register_";if(o&&o.hasOwnProperty("product")&&(n+=o.product),e.util.error.record(null,n),o.popup)return e.registration.popup.open(o,i);var r={servlet:"Register",action:"SIGNIN",data:function(){return{}}},s=e.retrieve("ta.registration.currentUrlDefaults");return o=e.util.merge(r,s,o||{},i||{}),!!o.product&&(!!t(o.product)||(o.successAction&&e.registration.setSuccessActionCookie(o.successAction),require(["utils/post"],function(e){e({url:"/"+o.servlet,https:!0,data:{product:o.product,action:o.action,url:o.url,urlKey:o.urlKey,partnerKey:o.partnerKey,data:JSON.encode(o.data())}})}),!1))},o.popup={defaultWidth:547,defaultHeight:435,options:null,urloptions:null,isPopup:null,open:function(o,i){e.registration.popup.options=o,e.registration.popup.urloptions=i;var n={servlet:"Register",action:"SIGNIN"rn{}}},r=e.retrieve("ta.registration.currentUrlDefaults");if(o=e.util.merge(n,r,o||{},i||{}),!o.product)return!1;if(t(o.product))return!0;var s=document.location,a=s.protocol+"//"+s.host;s.port&&(a+=":"+s.port);var c=a.replace("http://","https://")+"/"+o.servlet,u=[];u.push("popup=true"),u.push("product="+o.product),u.push("action="+o.action),u.push("url="+o.url),u.push("urlKey="+o.urlKey),u.push("partnerKey="+o.partnerKey),u.push("data="+JSON.encode(o.data())),c=c+"?"+u.join("&");var p=e.registration.popup.defaultWidth,l=e.registration.popup.defaultHeight,g=(screen.width-p)/2,d=(screen.height-l)/2,w=window.open(c.toString(),"registration","width="+p+", height="+l+", top="+d+", left="+g+", resizable=yes, scrollbars=yes");return w||isTabletOnFullSite||e.registration.popup.fallback(),!1},init:function(){if(null==e.registration.popup.isPopup&&(e.registration.popup.isPopup=isTabletOnFullSite||window.opener&&window.getSize().x<e.registration.popup.defaultWidth+150),e.registration.popup.isPopup){var o=e.id("REG_CON");if(o){var t=o.getElement("div.regDlg");t||(t=o.getElement("div.whyDlg")),t&&e.registration.popup.resize(t)}var i=e.id("SS_SSO");if(i){var n=i.getElement("input[type=button]");n&&n.addEvent("click",function(){e.registration.popup.resizeTo(980,560,!0)})}}else window.location="/RegisterDone?fallback=true"},done:function(o,t){if(window.opener){var i=window.opener;if(i.ta)if(t)e.registration.popup.fallback(!0);else{var n;i.ta.registration&&i.ta.registration.popup.options&&(n=i.ta.registration.popup.options.successAction),n?i.ta.registration.runSuccessAction(n):o&&(i.location=o),e.registration.popup.updateMasthead(e.registration.popup.close)}else e.registration.popup.close()}else o&&e.registration.returnTo(o)},close:function(){window.opener&&window.opener!=window&&(window.opener=window,window.close())},updateMasthead:function(o){var t=0,i=setInterval(function(){t++;var n=e.id("avatarImage");if(i>20||!n||n.get("src")){clearInterval(i);try{window.opener&&window.opener.ta&&(r(),s())}catch(o){e.util.error.record(o,"secure popup - unable to update masthead",null,{},"WARN")}o&&o()}},250),n=function(e){if(e&&window.opener){var o=new Element("div").adopt(e).innerHTML;o&&(e=window.opener.Elements.from(o))}return e},r=function(){var o=window.opener.document.getElement("head"),t=e.id("IP_HEADER_CSS");o&&t&&(t=n(t),t&&o.adopt(t))},s=function(){var e=document.getElementById("USER_PREFS"),o=window.opener.document.getElementById("USER_PREFS");e&&o&&(e=n(e),e&&e.replaces(o))}},fallback:function(o){var t=window;if(o&&window.opener&&(t=window.opener),t.focus(),t.ta&&t.ta.registration){var i=t.ta.registration.popup;i.options&&(i.options.popup=!1,t.ta.registration.register(i.options,i.urloptions))}o&&e.registration.popup.close()},resize:function(o){if(o){e.registration.popup.disableScrollBars();var t=o.getScrollSize().x,i=o.getScrollSize().y;window.onresize=function(){window.onresize=null;var o=t-window.getSize().x+1,n=i-window.getSize().y+1;0!=o||0!=n?(window.onresize=function(){window.onresize=null,e.registration.popup.center(t+o,i+n),e.registration.popup.enableScrollBars()},e.registration.popup.resizeBy(o,n)):(e.registration.popup.enableScrollBars(),e.registration.popup.center())},e.registration.popup.resizeTo(t,i)}},resizeTo:function(o,t,i){i&&(window.onresize=function(){window.onresize=null,e.registration.popup.center()}),window.resizeTo(o,t)},resizeBy:function(o,t,i){i&&(window.onrer()}),window.resizeBy(o,t)},center:function(e,o){e||(e=window.getSize().x),o||window.getSize().y;var t=(screen.width-e)/2,i=(screen.height-o)/2;window.moveTo(t,i),window.focus()},disableScrolen")},enableScrolow")}},function(e,o){function t(){e.store("registration.google.avail",!0);var o=e.remove("registration.google.onAvail");o&&o.each(function(e){e()})}function i(){if("undefined"==typeof r.scope){var o=["https://www.googleapis.com/auth/plus.login","https://www.googleapis.com/auth/userinfo.email"];e.retrieve("google_wallet_permission_desktop_signin.enabled")&&o.push("https://www.googleapis.com/auth/payments.make_payments"),r.scope=o.join(" ")}return r}var n="1070328450902.apps.googleusercontent.com",r={"cookiepolicy":"single_host_origin","requestvisibleactions":"http://schemas.google.com/AddActivity","clientid":n,"client_id":n,"immediate":!1,"apppackagename":"com.tripadvisor.tripadvisor"},s=0;o.google={init:function(e){e&&o.google.onAvail(e),new Asset.javascript("https://plus.google.com/js/client:plusone.js",{onLoad:function(){if(gapi&&gapi.auth)gapi.auth.init(t);else var e=setInterval(function(){gapi&&gapi.auth&&(clearInterval(e),gapi.auth.init(t))},100)}})},onAvail:function(o){e.retrieve("registration.google.avail")?o():e.keep("registration.google.onAvail",o)},connect:function(o,t,n){t=t||"MASTHEAD";var r={flow:t};0===t.indexOf("EMAIL_ONLY_SIGNUP")&&(Object.merge(r,{isOverlay:!1}),"function"==typeof n&&Object.merge(r,{responseCallback:n})),o&&(s=o),"undefined"==typeof gapi?e.registration.google.init(e.registration.google.connect):e.has("google.sso.sending")||(e.store("google.sso.sending",!0),gapi.auth.signIn(Object.merge({"callback":function(o){if(o&&o.status&&o.status.signed_in&&o.access_token&&!e.has("google.sso.receiving")){e.remove("google.sso.sending"),e.store("google.sso.receiving",!0);var t="/GoogleRegistration?google_token="+o.access_token+"&pid="+s;new Request.JSON({url:t,method:"get",onSuccess:function(t){e.remove("google.sso.receiving"),t.success&&(t.created?e.overlays.registration.connect(r,"GOOGLE_SIGNUP"):t.connected?e.overlays.registration.request("GOOGLE_THANKS",{"google_token":o.access_token},r):e.overlays.registration.cancel(r))},onError:function(){e.remove("google.sso.receiving")},onFailure:function(){e.remove("google.sso.receiving")}}).send()}}},i())))},ifConnected:function(o,t){gapi&&gapi.auth?gapi.auth.authorize({client_id:n,immediate:!0,scope:i().scope.split(" ")},function(i){if(i&&i.status&&i.status.signed_in){var n="/GoogleRegistration?google_token="+i.access_token+"&verify=true",r=e.retrieve("google.sso.returnTo");r&&(n+="&returnTo="+r),new Request.JSON({url:n,method:"get",onSuccess:function(e){e.success&&o?o():t&&t()},onFailure:t}).send()}else t&&t()}):t()},ifLoggedIn:function(e,o){if("undefined"!=typeof gapi&&gapi.auth){var t={"client_id":n,"session_state":null};gapi.auth.checkSessionState(t,function(t){t===!1?e():o&&o()})}}}}(e,o),function(e,o){var t=4194307,i=656,n=382,r=null;o.vkontakte={connect:function(o,s,a){if(o&&new Request({url:"/ActionRecord?action=vkAuthAttempt&pid="+o}).send(),e.retrieve("vk.sso.clicked")&&r&&r.window&&(r.window.close(),e.store("vk.sso.clicked",!1)),!e.retrieve("vk.sso.clicked")){e.store("vk.sso.clicked",!0);var c=(screen.height-n)/2,u=(screen.width-i)/2,p="https://oauth.vk.com/authorize?client_id="+a+"&scope="+t+"&redirect_uri=https%3A%2F%2F"+location.hostname+"%2FVKRegistration";if(s&&(p+="Masthead"),r=window.open(p,"registration","width="+i+", height="+n+", top="+c+", left="+u+", resizable=yes, scrollbars=yes"))var l=setInterval(function(){r.closed&&(clearInterval(l),s&&document.window.location.reload(),e.store("vk.sso.clicked",!1))},500);else e.store("vk.sso.clicked",!1),new Request({url:"/Actionrecord?action=vkAuthPopupBlocked&pid=39094"}).send(),s||this.showSSOError(e.retrieve("popupBlockerSSOError"))}},registrationSuccess:function(){e.overlays.registration.connect({flow:"MASTHEAD"},"VK_SIGNUP")},loginSuIN")},showSSOError:function(o){e.store("vk.sso.clicked",!1);var t=e.id("ssoErrorMessage");t&&(t.removeClass("hidden"),t.set("html",o))},done:function(e,o){try{window.opener.ta&&window.opener.ta.retrieve("vk.sso.clicked")&&this.performPostAuthAction(e,o)}catch(e){window.close()}window.close()},doneMasthead:function(){window.close()},performPostAuthAction:function(e,o){var t=window.opener;t.ta.store("vk.sso.clicked",!1),e&&t.ta.registration.vkontakte&&("vkLogin"===e?t.ta.registration.vkontakte.loginSuccess():"vkSignup"===e?t.ta.registration.vkontakte.registrationSuccess():"error"===e&&o&&t.ta.registration.vkontakte.showSSOError(o))},disconnect:function(){e.overlays.registration.post({action:"VK_DISCONNECT"})}}}(e,o),o.done=function(o,t){window.opener?e.registration.popup.done(o,t):e.registration.returnTo(o)},o.returnTo=function(o){window.opener?(window.opener.location=o,e.registration.popup.close()):window.location=o},o.runSuccessAction=function(o,t){var i=o.split("|");try{var n=i.slice(1);n.unshift({}),n.unshift(i[0]),t&&n.push(t),e.run.apply(null,n)}catch(o){e.util.error.record(o,"successAction",null,{"funcName":i[0]})}},o.runSuccessActionCookie=function(){var o=e.registration.getSuccessActionCookie();o&&e.registration.runSuccessAction(o,!0)},o.setSuccessActionCookie=function(e){Cookie.write("successAction",window.pageServlet+"|"+e,{domain:cookieDomain,path:"/"})},o.getSuccessActionCookie=function(){if(window==window.top){var e=Cookie.read("successAction");if(e){var o=e.split("|"),t=o[0];if(o=o.slice(1),window.pageServlet==t)return Cookie.dispose("successAction",{domain:cookieDomain,path:"/"}),o.join("|")}}},e.queueForLoad(function(){e.registration.runSuccessActionCookie()},"registration.runSuccessActionCookie")}(ta,ta.registration);
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["utils/post","ta/util/Keys"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/registration","files":{"js-amd":{"src":{"utils":{"post":1}}},"js3":{"src":{"ta":{"util":{"Keys":1}}}}},"_":{"baseUrl":"/"}});
define("utils/post",["vanillajs","utils/urlutils"],function(t,e){"use strict";return function(t){if(!t||!t.url||!t.data)return!1;t.url=t.https?e.https(t.url):e.getAbsoluteUrl(t.url);var r=document.createElement("form");r.setAttribute("method","post"),r.setAttribute("action",t.url);for(var u in t.data)if(t.data.hasOwnProperty(u)){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",u),i.setAttribute("value",t.data[u]),r.appendChild(i)}document.body.appendChild(r),r.submit()}});
define("ta/util/Keys",["lib/jquery-amd","ns-exporter"],function(n,t){var e={onEnterKey:function(n,t,e){var i;return window.event?i=window.event.keyCode:n&&(i=n.which),13==i?("function"==typeof t&&t(),!1):("function"==typeof e&&e(),!0)},onEnterKeyClickSibling:function(t,i){return e.onEnterKey(t,function(){if(t.target){var e=n(t.target).siblings(i);e.length&&e[0].click()}})},onEnterKeyClickFormChild:function(t,i){return e.onEnterKey(t,function(){if(t.target){var e=n(t.target).parent().find(i);e.length&&e[0].click()}})}};return t.exportTo(e,"ta.util.keys"),e});
ta.common.flyout=ta.common.flyout||{},ta.common.flyout.memberOverlay=ta.overlays.Factory.memberOverlay,ta.common.flyout.showRecentLocationEmailOverlay=ta.overlays.Factory.showRecentLocationEmailOverlay,ta.common.sendmessage.showSendMessage=ta.overlays.Factory.showSendMessage;
var StringBuffer=new Class({initid(n)},athis},toS("")},isngth}});
var Table=new Class({Implements:[Options],options:{properties:{cellpadding:0,cellspacing:0,border:0},rows:[]},initialize:function(t){this.setOptions(t),this.table=new Element("table").setProperties(this.options.properties),this.tbody=new Element("tbody").inject(this.table),this.options.rows.each(this.push.bind(this))},push:function(t,e,n){var i=new Element("tr").inject(e||this.tbody);return t.each(function(t){var e=new Element(n?"th":"td").inject(i);t.properties&&e.setProperties(t.properties),t.content?e.setContent(t.content):e.setContent(t)}),this},pushHead:function(t){return this.thead||(this.thead=new Element("thead").inject(this.table,"top")),this.push(t,this.thead,!0),this},pushFoot:function(t){return this.tfoot||(this.tfoot=new Element("tfoot").inject(this.table)),this.push(t,this.tfoot),this},pushCaption:function(t){return new Element("caption").setContent(t).inject(this.table,"top"),this}});
var TabSet=new Class({Implements:[Options,Events],options:{onActive:function(){},onBackground:function(){},show:0,collapsable:!1},initialize:function(){var t,s,e;Array.each(arguments,function(i,n){switch(typeOf(i)){case"object":t=i;break;default:var h=$$(i);s?e=h:s=h}}),this.togglers=s||[],this.elements=e||[],this.setOptions(t),this.elements.each(function(t,s){this.togglers[s].addEvent("click",this.display.bind(this).partial(Function._,s)),this.options.show===s?(t.show(),this.previous=s,this.fireEvent("onActive",[null,this.togglers[s],t])):t.hide()},this)},display:function(t,s){return this.options.collapsable&&s==this.previous?(this.elements[s].isHidden()?(this.fireEvent("onActive",[t,this.togglers[s],this.elements[s]]),this.elements[s].show()):(this.fireEvent("onBackground",[t,this.togglers[s],this.elements[s]]),this.elements[s].hide()),this):((this.previous||0===this.previous)&&(this.elements[this.previous].hide(),this.fireEvent("onBackground",[t,this.togglers[this.previous],this.elements[this.previous]])),this.previous=s,this.elements[s].show(),this.fireEvent("onActive",[t,this.togglers[s],this.elements[s]]),this)}});
var ToggleSet=new Class({initialize:function(s,i,t){this.index=t||0,this.togglers=s||[],this.elements=i||[],this.togglers.each(function(s,i){this.togglers[i].addEvent("click",this.display.bind(this,i)),this.elements[i].hide()},this)},add:function(s,i){var t=this.togglers.length;this.togglers.push(s),this.elements.push(i),s.addEvent("click",this.display.bind(this,t)),i.hide()},expand:function(s){return this.togglers[s].addClass("open"),this.elements[s].show(),this},collapse:function(s){return this.elements[s].hide(),this.togglers[s].removeClass("open"),this},display:function(s){return this.previous==s?this.elements[s].isHidden()?this.expand(s):this.collapse(s):((this.previous||0===this.previous)&&this.collapse(this.previous),this.previous=s,this.expand(s)),this}});
var Slider=new Class({Implements:[Options,Events],Binds:["clickedElement","draggedKnob"],options:{onChange:function(){},onComplete:function(){},op,t)},mode:"horizontal",steps:100,offset:0},initialize:function(t,s,i){this.element=$(t),this.knob=$(s),this.setOptions(i),this.previousChange=-1,this.previousEnd=-1,this.step=-1,this.element.addEvent("mousedown",this.clickedElement);var e,h;switch(this.options.mode){case"horizontal":this.z="x",this.p="left",e={"x":"left","y":!1},h="offsetWidth";break;case"vertical":this.z="y",this.p="top",e={"x":!1,"y":"top"},h="offsetHeight"}this.max=this.element[h]-this.knob[h]+2*this.options.offset,this.half=this.knob[h]/2,this.getPos=this.element["get"+this.p.capitalize()].bind(this.element),this.knob.setStyle("position","relative").setStyle(this.p,-this.options.offset);var o={};o[this.z]=[-this.options.offset,this.max-this.options.offset],this.drag=new Drag(this.knob,{limit:o,modifiers:e,snap:0,onStart:this.draggedKnob(),onDrag:this.draggedKnob(),onComnd()}.bind(this)}),this.options.initialize&&this.options.initialize.call(this)},set:function(t){return this.step=t.limit(0,this.options.steps),this.checkStep(),this.end(),this.fireEvent("onTick",this.toPosition(this.step)),this},setDefault:function(t){return t>this.options.steps?t=this.options.steps:t<0&&(t=0),this.step=t,this.end(),this.knob.setStyle(this.p,this.toPosition(this.step)+"px"),this},scrolledElement:function(t){t.wheel<0?this.set(this.step+1):t.wheel>0&&this.set(this.step-1),t.stop()},clickedElement:function(t){var s=t.page[this.z]-this.getPos()-this.half;s=s.limit(-this.options.offset,this.max-this.options.offset),this.step=this.toStep(s),this.checkStep(),this.end(),this.set(this.step)},draggedKnob:function(){this.drag&&(this.step=this.toStep(this.drag.value.now[this.z]),this.checkStep(),this.setDefault(this.step))},checkStep:function(){this.previousChange!=this.step&&(this.previousChange=this.step,this.fireEvent("onChange",this.step))},end:function(){this.previousEnd!==this.step&&(this.previousEnd=this.step,this.fireEvent("onComplete",this.step+""))},toStep:function(t){return Math.round((t+this.options.offset)/this.max*this.options.steps)},toPosition:function(t){return this.max*t/this.options.steps}});
function behaviorFunction(){if(Browser.ie&&(!$("FOOT")||!$("FOOT").readyState||"complete"!=$("FOOT").readyState)&&bfCount<10)return bfCount++,void behaviorFunction.delay(30);window.hideOnLoad&&(Array.convert||Array.from)(hideOnLoad)de()}),Browser.ie6||searchFocus(),processLinks(document),behavior.register(rules);var e=$("MAIN");"#Calculator"==window.location.hash&&($("HOMEPAGE")||e&&e.hasClass("VacationRentals")||$("HOTEL_LANDER"))&&(showDHTMLOverlayOnLoad=function(){},"undefined"!=typeof vrCalculator&&vrCalculator())}function searchFocus(){var e=ta.id("mainSearch");if(e&&e.className.match(/\b(focusOnLoad)\b/))try{e.focus()}catch(e){}}function popup(e,t,n,a,o,i,l,r,s,p){try{new Event(e).preventDefault();var u,c,d,f="",h=this.className.match(/sz(\d+)x(\d+)/),m=ta.id(document.body);if(h&&(n=h[1],a=h[2]),this.href.indexOf("p=HotelsCom")>-1&&(n=Math.max(n,960),a=Math.max(a,window.getHeight(),600)),n&&(f+=",width="+n),a&&(f+=",height="+a),o&&(f+=",screenX="+o+",left="+o),i&&(f+=",screenY="+i+",top="+i),""!==f&&(f=s?"toolbar=1,resizable=1,menubar=1,location=1,status=1,scrollbars=1"+f:"toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+(l?0:1)+f),r||(r=this.href),c=t||"p"+popupIndex++,p&&Browser.ie?(d=new Element("a",{target:c,href:r}),d.inject(m,"bottom"),u=window.open("",c,f),d.click(),d.destroy()):u=window.open(r,c,f),null!==u){try{u.opener=self}catch(e){}u.focus()}}catch(t){throw ta.util.error.record(t,"behavior popup",e),t}}function toggle(e){new Event(e).preventDefault(),this.toggleClass("off")}function enableCommunity(e,t){var n=e;t||(n=function(t){enableCommunityResponse(t,e)}),"undefined"==typeof JS_SECURITY_TOKEN&&(JS_SECURITY_TOKEN=""),new Request({url:"/MemberSubscriptionsController",data:{"Action":"ChangeM2M","set":"on","token":JS_SECURITY_TOKEN},onSuccess:n,onFailure:ta.util.error.ajaxFailure.partial("behavior:enableCommunity")}).send()}function enableCommunityResponse(res,callback){var isf=document.getElementById("inviteStatusField");if(txt.match(/^{/)){var data=eval("("+txt+")");data.ERROR&&(isf.innerHTML=data.ERROR,isf.style.display="block")}else isf.innerHTML=JS_community_on,isf.style.display="bhash}function showToggleBlock(e){$$(".js_toggleBlocks .js_toggleBlock").each(function(t,n){t.hide(),t.hasClass(e)&&t.sho,e)}var rules={},rulesN={},ajaxRules={},Behavior=new Class({register:function(e){this.rules=e;for(var t in this.rules)this.reload(t);for(var n in rulesN)this.reloadN(n);return this},reload:function(e){for(var t=$$(e),n=0;n<t.length;n++)try{this.rules[e](t[n])}catch(e){require.defined("ta/util/xpath")&&ta.util.error.record(e,"rules",null,{"element":require("ta/util/xpath").nodePath(t[n]),"ruleCount":n})}return t.length},reloadN:function(e){for(var t=0;n=ta.id(e+t++);)rulesN[e](n);return t-1},apply:function(e){processLinks(e);for(var t in this.rules)window.applyLastRule=t,e.getElements(t)](e)},this);for(var t in ajaxRules)window.applyLastRule=t,e.getElements(t).each(function(e){ajaxRules[t](e)},this)}});window.behavior=new Behavior,TAReadyEvent=window.TAReadyEvent||"domready",Browser.ie&&"undefined"!=typeof semHotelBoxFocus&&semHotelBoxFocus?ta.queueForLoad(behaviorFunction,"Behavior"):window.addEvent(TAReadyEvent,behaviorFunction);var bfCount=0;rulesN.EOBF=function(e){var t=e.innerHTML+"@tripadvisor"+e.title;new Element("a",{href:"mailto:"+t}).setContent(t).replaces(e)};var linkMap={},popupIndex=0;linkMap.js_popup=function(e,t){popup.attempt(t,e)},linkMap.js_popComm=function(e,t){popup.attempt([t,null,950,610,null,null,null,null,!0],e)},linkMap.js_popMap=function(e,t){Cookie.write("mapPopup","1",{domain:cookieDomain}),popup.attempt([t,"map",820,960],e)},linkMap.js_popNoScroll=function(e,t){popup.attempt([t,null,null,null,null,null,!0],e)},linkMap.js_popCR=function(e,t){popup.attempt([t,"cr",245,610,5,5],e)},linkMap.js_email=function(e,t){popup.attempt([t,"email",580,460,30,25],e)},linkMap.js_popReview=function(e,t){popup.attempt([t,"review",550,395,30,25],e)},linkMap.js_popPhoto=function(e,t){popup.attempt([t,"photo",650,350],e)},linkMap.js_popGallery=function(e,t){Cookie.write("PhotoPop","1",{domain:cookieDomain}),popup.attempt([t,"media",782,820],e)},linkMap.js_popGalleryComm=function(e,t){Cookie.write("PhotoPop","1",{domain:cookieDomain}),popup.attempt([t,"media",780,950],e)},linkMap.js_popDMO=function(e,t){popup.attempt([t,"dmo",400,400],e)},linkMap.js_popNxTall=function(e,t){popup.attempt([t,330,680],e)},linkMap.js_popNxWide=function(e,t){popup.attempt([t,730,380],e)},linkMap.js_popNxLogin=function(e,t){popup.attempt([t,"login",795,645],e)},linkMap.js_popFraud=function(e,t){popup.attempt([t,"fraud",640,460],e)},linkMap.js_popDestGd=function(e,t){popup.attempt([t,"dest_guide",565,700,(screen.width-700)/2,(screen.height-600)/2],e)},linkMap.js_popSmall=function(e,t){return screen.width>1024?popup.attempt([t,null,800,600,240,5,!1,!1,!0],e):screen.width>800?popup.attempt([t,null,620,500,240,5,!1,!1,!0],e):popup.attempt([t,null,475,390,210,5,!1,!1,!0],e),e},linkMap.js_popProfPhoto=function(e,t){return screen.width>1024?popup.attempt([t,null,800,500,240,5,!1,!1,!0],e):screen.width>800?popup.attempt([t,null,620,450,240,5,!1,!1,!0],e):popup.attempt([t,null,475,390,210,5,!1,!1,!0],e),e},linkMap.js_popPartner=function(e,t){return screen.width>1024?popup.attempt([t,null,980,500,240,5,!1,!1,!0],e):screen.width>800?popup.attempt([t,null,800,500,240,5,!1,!1,!0],e):popup.attempt([t,null,620,450,210,5,!1,!1,!0],e),e},linkMap.js_nin})},rules["a#TERMS"]=function(e){e.addEvent("click",popup.bind(e).partial(Function._,"terms",300,300,30,25))},linkMap.js_ajaxSubmit=function(e,t){if(e.className.match(/\bform_(\w+)\b/)){var n=$(RegExp.$1),a={url:e.href,data:n,onFailure:function(e){n&&n.removeClass("ajaxInFlight"),ta.util.error.ajaxFailure("behavior:js_ajaxSubmit",e)}},o=window["callback"+n.id];e.className.match(/method_(\w+)\b/)&&(a.method=RegExp.$1),e.className.match(/\btgt_(\w+)\b/)?a.update=RegExp.$1:a.onSuccess=function(e){n&&n.removeClass("ajaxInFlight"),ta.overlays.showInLightbox(e),o&&"function"==typeOf(o)&&o()},new Event(t).preventDefault();var i=window["validate"+n.id];i&&"function"==typeOf(i)&&0==i.apply(n)||(n.addClass("ajaxInFlight"),e.className.match(/\bevalScripts\b/)&&(a.evalScripts=!0),(a.update?new Request.HTML(a):new Request(a)).send())}},linkMap.js_ajax=function(e,t){new Event(t).preventDefault(),(tgt=e.className.match(/\btgt_(\w+)\b/))&&(tgt=$(tgt[1]),new Request.HTML({url:e.href,update:tgt,onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajax")}).send())},linkMap.js_ajaxlogin=function(e,t){if(new Event(t).preventDefault(),tgt=e.className.match(/\btgt_(\w+)\b/)){var n=e.href;tgt=$(tgt[1]),new Request({url:e.href,onSuccess:function(e,t){var a=e.indexOf("<!--nologin-->")<0;a?tgt.innerHTML=e:login(["tt","ajax","returnTo",n+"&rd=1","greeting","showuserreviews_vote_25ee"])},onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajaxLogin")}).send()}},linkMap.js_ajaxRt,e)};var ajaxReport=function(e){new Event(e).preventDefault(),ta.overlays.loadInLightbox(this.href)},toggleMeRule=function(e){0==e.hasClass("defaultOpen")&&e.addClass("off"),e.getElements(".show").addEvent("click",toggle.bind(e)),e.getElements(".hide").addEvent("click",toggle.bind(e))};rules["#TOGGLEME"]=toggleMeRule,rules["#TOGGLEME2"]=toggleMeRule,ajaxRules["div.js_swapBlocks"]=function(e){var t=e.getElement(".js_swapOut"),n=e.getElement(".js_swapIn"),a=e.getElement("a.js_swapTrigger"),o=e.getElement("a.js_swapBackTrigger");t&&n&&a&&(a.addEvent("click",function(e){new Event(e).preventDefault(),window.removedBit=t.dispose(),n.show()}),a.removeClass("js_swapTrigger")),t&&n&&o&&(o.addEvent("click",function(e){new Event(e).preventDefault(),n.hide(),$("parentOfSwapOut").appendChild(window.removedBit)}),o.removeClass("js_swapBackTrigger"))},ajaxRules["#PM_UNBLOCK"]=function(e){e.addEvent("submit",function(e){new Event(e).stop();var t=$("PM_UNBLOCK");"1"==t.unblock.value?new Request({url:"/SendMessageRD",data:t,onSuccess:ta.overlays.showInLightbox,onFailure:ta.util.error.ajaxFailure.partial("behavior:#PM_UNBLOCK")}).request():($("unblock-intercept").hide(),$("blockedreply").show(),t.unblock.value="1")})};var follow=function(e){return function(){window.location=$(e).href}};linkMap.js_toggleBlockTrigger=function(e,t){var n=e.getProperty("class");n.replace(/toggleBlock[0-9]+/g,function(e){n=e}),showToggleBlock(n)},rules["#SWAPBLOCK .js_toggleBlock"]=function(e){if(e.hasClass("js_toggleBlockSelected")){var t=e.getProperty("class");t.replace(/toggleBlock[0-9]+/g,function(e){t=e}),showToggleBlock(t)}};var showLastSavesRD=function(){var e=$("LAST_SAVES_PLACEHOLDER");if("undefined"!=typeof savesIncluded){if(!e)return renderLastSaves(SAVES_RECENT_SAVES);e.innerHTML=renderLastSaves(SAVES_RECENT_SAVES),flyout.positionCorners()}else if(!e)return new Asset.javascript(savesJS),showLastSavesRD.delay(125),new Element("div",{id:"LAST_SAVES_PLACEHOLDER"})},showSavesWidget=function(e,t,n,a,o,i,l){"undefined"!=typeof savesIncluded?showSavesWidget2(e,t,n,a,o,i,l):(new Asset.javascript(savesJS),showSavesWidget.delay(125,null,[e,t,n,a,o,i,l]))},savesInlineLoginOnClickHandler=function(e,t,n){"undefined"!=typeof savesIncluded?savesInlineLoginOnClickHandler2(e,t,n):(new Asset.javascript(savesJS),savesInlineLoginOnClickHandler.delay(125,null,[e,t,n]))};linkMap.js_trackDirPop=function(e,t){(actionToRecord=e.className.match(/ar_(\w+)/))&&(actionToRecord=actionToRecord[1],new Request({url:"/ActionRecord?action="+actionToRecord}).send())},linkMap.js_clearPopurm()},linkMap.js_popupFormAction1=function(e,t){setPopupFormAction("1")},linkMap.js_popupFormAc"2")};var replaceContent=ta.util.element.replaceContent;linkMap.js_replaceContent=function(e,t){var n=e.className.match(/id_([^\s"]*)?/);if(!n||2!=n.length)throw new Error("Links with behavior js_replaceContent must also have a style class id_??? to indicate which element's contents should be replaced");n=n[1];var a=$(n),o=e.href;o&&replaceContent(t,a,o),t.stop()};
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/common/behavior/Popups","ta/common/behavior/globalSideEffects","ta/common/behavior/Ads-pagemoniker","ta/util/xpath","ta/maps/trackpixel"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/behavior_set","files":{"js3_secure":{"ssl":{"ta":{"common":{"behavior":{"Ads-pagemoniker":1}}}}},"js3":{"src":{"ta":{"common":{"behavior":{"Popups":1,"globalSideEffects":1}},"maps":{"trackpixel":1},"util":{"xpath":1}}}}},"_":{"baseUrl":"/"}});
define("ta/common/behavior/Popups",["vanillajs","ns-exporter","api-mod","ta/util/Error","utils/ajax","ta/Core/TA.Record","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade"],function(e,o,n,t,r,i,l,a,p,s,u,c,d){function v(e,o){if(e){var r=o.options||{};if(r.forward&&window.popupForward&&(window.location=window.popupForward),n.select("#FLYOUT").forEach(function(e){e.dispose()}),window.lightbox&&window.lightbox.deactivate(),n.select(".overlay, .ui_overlay").forEach(function(e){e.overlay&&e.overlay.hide&&e.overlay.hide()}),r.loading){var v=r.loading.substr?document.getElementById(r.loading):r.loading;v.style.display="none"}var y=[u,s,c];if(o.lightbox&&y.push(d),r.center)y.unshift(p.center([0,0])),y.unshift(a(null,"center","small"));else{var m=r.daodaoPopup||!r.permanent?240:100,g=document.getElementById("PAGE");y.unshift(p.absolute([g.offsetLeft+m,g.offsetTop+220])),y.unshift(a(null,"absolute",""))}var w=new l(null,y);if(w.inner.innerHTML=e,w.container.style.padding="0px",w.show(),h=!0,o.servletUrl)try{var E="DHTMLOverlay",b=o.servletUrl.match(/RuleBasedPopup/);if(b){var O=o.servletUrl.match(/Rule=\d+/);if(O){var C=O[0].match(/\d+/);E="RuleBasedPopup_"+C[0]}}i.trackEventOnPage("Popup","OpenPopup",E,1,!0)}catch(e){t.record(e,"Popup - trackPopup")}var P=function(){n.find(".refreshOnClose",this.inner)&&document.location.reload()};if(w.on("hide",P),o.servlet){n.addClass(w.container,o.servlet),n.addClass(w.container,"np"),"RuleBasedPopup"==o.servlet&&r.cmsDisplayName&&n.addClass(w.container,r.cmsDisplayName);var k=function(e,o){var n=e.charCode?e.charCode:e.which?e.which:e.keyCode;13!=n&&10!=n||o(e)},R=function(e){k(e,D)},S=function(e){k(e,n.stopEvent.bind(n,e))},T=function(e){n.select("#POPUP_FORM #sendpass").forEach(function(e){e.value="true"}),D(e)},D=function(e){n.stopEvent(e),n.removeEvent(n.select(w.inner,".popupSubmit"),"click",D),n.removeEvent(n.select(w.inner,".popupSendForgotEmail"),"click",T);var o=n.select(w.inner,".popupSubmitOnEnter");n.removeEvent(o,"keydown",R),n.addEvent(o,"keydown",S),n.select(w.inner,".focusClear").foe=""}),r.disableOnHideForSubmit&&w.off("hide",P),f.DHTMLOverlayRequest("Submit",null,null,n.find(w.inner,"#POPUP_FORM"))};n.addEvent(n.select(w.inner,".dhtmlclose"),"click",w.hide.bind(w)),n.addEvent(n.select(w.inner,".popupSubmitOnEnter"),"keydown",R),n.addEvent(n.select(w.inner,".popupSendForgotEmail"),"click",T),n.addEvent(n.select(w.inner,".popupSubmit"),"click",D)}r.callback&&r.callback(w.container)}}var f={},h=!1;return window.popupConfig=window.popupConfig||{},f.checkDHTMLPopupShown=function(){return h},f.DHTMLOverlayRequest=function(e,o,t,i){var l=popupConfig.servletUrl+(popupConfig.servletUrl.indexOf("?")>=0?"&":"?")+"Action="+e;l.indexOf("fromServlet=")<0&&(l+="&fromServlet="+pageServlet),r({url:l,success:o||function(e){v(e,popupConfig)},error:t,data:i?n.getFormData(i):null,evalScripts:!0})},f.showDHTMLPopup=function(e,o,n,r,i){try{if(popupConfig.servlet=e,popupConfig.servletUrl=o,popupConfig.lightbox=n||r&&r.lightbox||!1,popupConfig.options=r,r&&r.loading&&i){var l=r.loading.substr?document.getElementById(r.loading):r.loading;l.style.left=i.pageX+20,l.style.top=i.pageY,l.style.display="block",document.body.appendChild(l)}f.DHTMLOverlayRequest("Open",null,null,r?r.data:null),r&&r.trackInterrupt&&require.defined("ta/util/RecordInterruption")&&require("ta/util/RecordInterruption").record("popup",r.popupName)}catch(o){t.record(o,"showDHTMLPopup - "+e,i)}},f.DHTMLOverlayResfig)},o.exportTo(f,window),f});
define("ta/common/behavior/globalSideEffects",["vanillajs","ns-exporter","api-mod","ta/util/Cookie","ta/util/Error","ta/Core/TA.Event","utils/browserutils","utils/resourceLoader","utils/ajax"],function(o,e,a,n,i,t,s,c,r){function l(o){for(var e=o?o.target:null;e&&"A"!=e.tagName&&"HTML"!=e.tagName;)e=e.parentNode;e&&"A"==e.tagName&&(/pid(\d+)/.test(e.className)&&n.setPIDCookie(RegExp.$1),window.linkMap&&(e.className.match(/(js_\w+)/g)||[]).foe,o)}))}function d(){if(window==window.top){var o=n.readRaw("ajaxAction");if(o){if(o=decodeURIComponent(o).split("|"),/^target:(\/[\w\d_-]+)/.test(o[0])){if(0!==window.location.pathname.indexOf(RegExp.$1))return;o=o.slice(1)}else if(window.opener)return;if(n.remove("ajaxAction","/",window.cookieDomain),("focus"==o[0]||"click"==o[0])&&o.length>1)for(var e=0;e<o.length;e+=2){var s=a.select(o[e+1]);if(s.length)try{s[0][o[e]]()}catch(a){i.record(a,"ajaxAction",null,{"funcName":o[e],"elmt":o[e+1]})}}else try{var c=o.slice(1);c.unshift({}),c.unshift(o[0]),t.run.apply(null,c)}catch(e){i.record(e,"ajaxAction",null,{"funcName":o[0]})}}}}function f(){if(s.firefox||s.safari||s.chrome){var o=a.find(location.hash);o&&o.offsetTop!=document.body.scrollTop&&window.scrollTo(0,o.offsetTop)}}function u(){if(/^#save/.test(location.hash)){var o=window.handleSavesPostLoginPopup;o?o():window.savesJS&&c.load(window.savesJS,u)}}var p={processLinks:function(o){a.select("a",o).forEach(function(o){o.className.match(/js_|pid/)&&(a.addEvent(o,"click",l),window.noPopClass&&o.className.match(/\bjs_pop/)&&a.addClass(o,window.noPopClass))})}};return t.queueForLoad(function(){"undefined"==typeof behavior&&p.processLinks(document),n.remove("TATypeAhead"),d(),f(),u()},1,"On_Load_Popups"),window.showPopup&&showPopup(),e.exportTo(p,window),p});
define("ta/maps/trackpixel",["vanillajs"],function(a){var r=[];return{storeTrackPixleSrc:function(a){a&&(a.splice?Array.prototype.push.apply(r,a):r.push(a))},loadSponsorTrackingPixel:function(a){r.forEach(function(a){var r=a.trim(),n=new Image;n.className="tracking",n.src=r}),a||(r=[])}}});
function alertIfEmpty(e){return!e||""!=e.value||((msg=e.className.match(/\bmsg_([\w\d]+)\b/))?alert(window[msg[1]]):alert("The field can not be empty"),!1)}function addNonMember(e,t){t||(t=this),popupConfig.clickedElement=t,new Event(e).preventDefault();var n="/MemberBenefitsPopup";/pid(\d+)/.test(t.className)&&(n+="?pid="+RegExp.$1),showDHTMLPopup("MemberBenefitsPopup",n,!0)}function clickNonMember(){if(setTimeout("window.lightbox.deactivate()",500),null!=popupConfig.clickedElement){var e=popupConfig.clickedElement;popupConfig.clickedElement=null,$$("#TRAVEL_GUIDES_LANDER .clickNonMember").each(function(e,t){e.removeEvent("click",addNonMember)}),$$("#TRAVEL_GUIDES_FLY .clickNonMember")ber)}),e.className.match(/\bclickPopDestMOGLink\b/)?processPopDestMOGLink(null,e):"a"==e.get("tag")?window.location=e.getProperty("href"):e.click()}}function processPopDestMOGLink(e,t){t||(t=this),loggedIn?processGuideLink(e,t):addNonMember(e,t)}linkMap.js_modi[t])},rules["#NEWSLETTER_CALLOUT input.memberUpdateEmail[type=text]"]=function(e){$("memberUpdatesEmailDefault").hide(),$(e.form).addEvent("submit",function(t){e.value==$("memberUpdatesEmailDefault").innerHTML&&(e.value="")})},rules["#TRAVEL_GUIDES_LANDER .clickNonMember"]=rules["#TRAVEL_GUIDES_FLY .clickNonMember"]=function(e){"a"==e.get("tag")&&e.className.match(/\bskipATag\b/)||e.addEvent("click",addNonMember)},rules["#TRAVEL_GUIDES_LANDER .clickPopDestMOGLink"]=function(e){e.addEvent("click",processPopDestMOGLink)},rules["#HELP_CENTER dl.js_toggleset"]=function(e){var t=new ToggleSet(e.getElements("dt"),e.getElements("dd"));window.location.hash&&(hash=window.location.hash.match(/c(\d+)/))&&t.display(parseInt(hash[1]))},rules["#TAB_CONTAINER"]=ta.widgets.tabContainer,linkMap.js_replaceContentSet=function(e,t){var n=e.className.match(/set_([^\s"]*)?/);if(!n||2!=n.length)throw new Error("Links with behavior js_replaceContentSet must also have a style class set_??? to indicate the set of elements the contents of which should be replaced");var o=e.className.match(/id_([^\s"]*)?/);if(!o||2!=o.length)throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced");o=o[1];var a=$(o);if(!a)throw new Error("Element of id "+o+" does not exist.");n=n[1],replaceContentSet(n,t,a.id)};var replaceContentSet=function(e,t,n){t=new Event(t);for(var o=$$("a.set_"+e),a=0;a<o.length;a++){var i=o[a],s=i.className.match(/id_([^\s"]*)?/);if(!s||2!=s.length)throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced");s=s[1];var l=$(s),c=i.href,r=function(){window.setTish=n},200)};if(c){var d=a==o.length-1&&n?r:null;replaceContent(t,l,c,d)}}t.stop()};
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["trcore","ta/p13n/placements","ta/p13n/placements-ajax","ta/prwidgets"],["ta/rollupAmdShim","page-model","ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/tripadvisor","files":{"js3":{"src":{"trcore":1,"ta":{"prwidgets":1,"p13n":{"placements":1,"placements-ajax":1}}}}},"_":{"baseUrl":"/"}});
define("overlays/options/closeOnSourceClick",["vanillajs","api-mod"],function(t,e){"use strict";function n(t){e.containsElement(this.sourceElement,t.target)&&(this.hide("source-click"),t.stopPropagation(),t.preventDefault())}function i(t){return function(){var i=n.bind(this),o=function(t){setTimeout(t.bind(this),1)}.bind(this);this.on("show",o.bind(void 0,function(){e.addEvent(this.sourceElement,"click",i),t&&e.addEvent(this.sourceElement,"touchstart",i)})).on("hide",o.bind(void 0,function(){e.removeEvent(this.sourceElement,"click",i),t&&e.removeEvent(this.sourceElement,"touchstart",i)}))}}var o=i(!0);return o.withoutTouchEvents=i(!1),o});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["masthead/header","masthead/NotificationDropdown","overlays/options/storeOverlayOnElement","overlays/options/matchWidth","overlays/options/closeOnLegacyOverlay","overlays/styles/tooltip","overlays/uiOverlay"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/common-header","files":{"js-amd":{"src":{"overlays":{"uiOverlay":1,"options":{"matchWidth":1,"closeOnLegacyOverlay":1,"storeOverlayOnElement":1},"styles":{"tooltip":1}},"masthead":{"header":1,"NotificationDropdown":1}}}},"_":{"baseUrl":"/"}});
define("masthead/header",["api-mod","lib/jquery-amd","overlays/Overlay","overlays/styles/modal","overlays/styles/dropdown","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnEscape","overlays/options/closeOnSourceClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","ta/Core/TA.Event","ta/Core/TA.Record","ta/Core/TA.Store","ta/util/Element"],function(e,o,n,t,r,i,a,l,s,u,c,d,f,h,v,p){var m,g,y={};f.queueForReady(function(){var n=o(".masthead h1");if(!(n.height()<45)){var t=n.clone().css({overflow:"hidden",visibility:"hidden",position:"absolute"});n.parent().append(t);for(var r=t.text(),i=r.length-1;i>0&&t.height()>=45;)i=r.lastIndexOf(" "),i>=0&&(r=r.substring(0,i)+"...",t.text(r),e.forceReflow(t.get(0)));t.remove(),n.text(r)}},0,"truncateLongMasthead");var w=function(){var o={},f={};return f.open=function(e,f,h,v,p,m){if(e in o)return o[e].show(),!0;p=p||{},m=m||{};var g=p.direction||"below",y="dropdown"==p.type?r:t,w=o[e]=new n(f,[y(f,g,v,""),i[g](p.offset||[0,0]),a,s,l,u,p.windowshade&&c(),p.url?d(p.url,{resources:p.resources}):null]);m.show&&w.on("show",m.show.bind(null,o[e])),m.hide&&w.on("hide",m.hide.bind(null,o[e])),p.url&&m.load&&w.on("contentLoaded",m.load.bind(null,w)),w.arrow&&w.arrow.destroy(),w.show(),h&&(w.contentElement.innerHTML=h,m.load&&m.load(w))},f.close=function(e){e in o&&o[e].hide()},f.openSubmenu=function(o,n,t,r,i,a){var l,s,u=[],c=function(e,n){u[n]=e,s&&(clearTimeout(s),s=0),u[0]||u[1]||(s=setTimeout(function(){u[0]||u[1]||w.close(o)},300))},d=c.bind(null,!0,0),f=c.bind(null,!1,0),h=c.bind(null,!0,1),v=c.bind(null,!1,1);w.open(o,n,t,r,i,{show:function(o){l=n.onmouseover,n.onmouseover=null,e.addEvent(n,{mouseover:d,mouseout:f}),e.addEvent(o.container,{mouseover:h,mouseout:v}),a&&a.show&&a.show(),setTimeout(o.reposition.bind(o),1)},hide:function(o){e.removeEvent(n,{mouseover:d,mouseout:f}),e.removeEvent(o.container,{mouseover:h,mouseout:v}),n.onmouseover=l,a&&a.hide&&a.hide()}})},f}();return y.createNavMenu=function(e,n){n=n||{};var t=!1;p.hoverIntent(e,{over:function(){var e=o(this);(e.hasClass("ownerMenu")||e.hasClass("warLink"))&&g||(n.initFn&&!t&&(n.initFn(),t=!0),o(".subNav",this).show(),n.showFn&&n.showFn.call(null,evnt),f.fireEvent("onOverlayShow"))},out:function(e){o(".subNav",this).hide(),n.hideFn&&n.hideFn.call(null,e)},timeout:n.timeout||500})},y.openAccountMenu=function(e){h.trackEventOnPage("UtilityNav","open","Signed_in_profile_dropdown");var n=o(".bizMenu.overlayContents",e);return n.length&&(m=n.html(),n.remove()),w.open("profile",e,o(".overlayContents",e).html(),"accountMenuFlyout dropMenu",{type:"dropdown"},ed")}{g=0}}),!1},y.openBizListingsMenu=function(e){return!!m&&(w.openSubmenu("bizListings",e,m,"dropMenu bizListingsMenuFlyout",{direction:"right",type:"dropdown"}),!1)},y.openCurrencyPicker=function(e,o){var n="global_currency_picker_overlay";return"true"==v.retrieve("currency_format_using_icu4j_cldr.featureEnabled")&&(n+=" currency_format_using_icu4j_cldr"),w.open("currency",e,null,n,{type:"dropdown",url:"/StaticVelocityPage?t=currency_picker.vm",resources:[globalCurrencyPickerCSS]},{show:f.fireEvent.bind(null,"mastheadFlyoutOpened"),load:h.trackEventOnPage.bind(null,"CurrencyPicker","Open",o)}),!1},y.openPosSelector=function(e){var n={modelGeoId:window.modelGeoId,pageFeature:window.pageFeature,footerFlagFormat:window.footerFlagFormat,flagsSettings:window.flagsSettings||[],localeCodes:window.localeCodes,flagsFlyoutCSS:window.flagsFlyoutCo:""},r="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+n.footerFlagFormat+"&flagsURL="+encodeURIComponent(document.location.pathname+(document.location.search||"")+(document.location.hash||""))+"&useHreflangs="+("ShowTopic"==window.pageServlet)+t("geo",n.modelGeoId)+t("pageFeature",n.pageFeature)+t("localeCodes",n.localeCodes);return n.flagsSettings.forue"}),w.open("pos",e,null,"flags_flyout_overlay",{showCloseBtn:!0,url:r,resources:[n.flagsFlyoutCSS]},{show:f.fireEvent.bind(null,"mastheadFlyoutOpened"),load:function(e){v.retrieve("flag_links.useHrefLangs")&&(o("a.flag_link",e.container).each(function(e,n){n=o(n);var t=o("link[hreflang="+n.attr("hreflang")+"]").prop("href");t?n.prop("href",t):n.parent().css("display","none")}),o("li.region",e.container).each(function(e,n){o("li.flag_item",n).is(":visible")||n.hide()}))}}),!1},y.addClearParam=function(e){"undefined"!=typeof document.cookie&&document.cookie&&document.cookie.indexOf("TASession")>=0&&(ta.hac&&ta.hac.filters&&ta.hac.filters.cancelAllExistingHAC&&ta.hac.filters.cancelAllExistingHAC(),e&&e.href&&e.href.indexOf("clearFilters=true")<=-1&&(e.href+=(e.href.indexOf("?")>-1?"&":"?")+"clearFilters=true"))},y});
define("masthead/NotificationDropdown",["api-mod","vanillajs","ta/backbone/ModuleLoader"],function(t,e,n){function i(t,e){var n=-10,i=!1,o=!1,s=!1,a=null,d=null,r=null,l=null,f=null,c=null,u=null,h="modules.engagement.NotificationDropdown",m="notification_desktop_deleted",g=function(e){if(!(!s||!d||e&&t.containsElement(f,e.target)||e&&"notif_close_button"==e.target.className)){s=!1,d.style.left=n+"px",t.addClass(d,"hidden"),t.removeClass(c,"masthead_notifctr_active");var i=window.bbapp&&bbapp.getView(h);i&&i.record("CloseNotifDropdown")}},_=function(){if(d&&!s){s=!0,t.removeClass(d,"hidden"),t.addClass(c,"masthead_notifctr_active");var e=t.getPosition(f).left,i=t.getCoords(d).width,o=window.outerWidth;e+i>o&&(d.style.left=n+(o-e)-i+"px"),w(0)}},v=function(){u||(u=setTimeout(function(){u=null,l=t.find(".notifdd_list",a),t.removeClass(r,"hidden"),l&&t.addClass(l,"hidden"),_()},250))},p=function(){u&&(clearTimeout(u),u=null),t.addClass(r,"hidden"),l=t.find(".notifdd_list",a),l&&t.removeClass(l,"hidden"),_()},w=function(e){var n=t.find(".masthead_notifctr_jewel",a);n.innerText=e,0!=e||t.hasClass(n,"hidden")?e>0&&t.hasClass(n,"hidden")&&(t.removeClass(n,"hidden"),t.addClass(c,"masthead_notifctr_unread")):(t.addClass(n,"hidden"),t.removeClass(c,"masthead_notifctr_unread"))},b={initialize:function(){this.listenTo(this.context.get("Engagement_MemberNotifications.data.notifications"),"reset",this.render),this.listenTo(this,"render",this.onRender),this.onRender()},onRender:function(){this.listEl=t.find(".notifdd_list",this.el);var e=this;require(["underscore"],function(n){var i=[];n.each(t.select(".notifdd_notif_container",e.el),function(e){t.hasClass(e,"notifdd_unread")&&i.push(+e.getAttribute("data-notif-id"))}),e.record("OpenNotifDropdown",{"context":i.length}),i.length>0&&e.context.save("modules.engagement.entity.NotificationStatusUpdate",{"set":!0,"status":["READ"],"notifs":i})})},refreshData:function(){var t=this.context.get("Engagement_MemberNotifications");if(t)return t.fetch();var e=new ta.util.Deferred,n=this;return setTier()},0),e.promise()},events:{"click a.notifdd_link":function(e,n){n=n||e.currentTarget,this.record("NotifDropdownClick",{"context":n.getAttribute("data-notif-type")});var i=this.context.save("modules.engagement.entity.NotificationStatusUpdate",{"set":!0,"status":["USED"],"notifs":[+n.getAttribute("data-notif-id")ref)};i.always(o),setTimeout(o,100),t.stopEvent(e)},"mousewheel":function(e){var n;n=e.event?e.wheel||e.event.wheelDelta||-e.event.detail:e.wheel||e.wheelDelta||-e.detail,(this.listEl.scrollTop<=0&&n>0||n<0&&this.listEl.scrollTop>=this.listEl.scrollHeight-this.listEl.offsetHeight)&&t.stopEvent(e)},"click div.notif_close_button":function(e,n){n=n||e.currentTarget,this.context.save("modules.engagement.entity.NotificationStatusUpdate",{"set":!0,"status":["DELETED"],"notifs":[+n.getAttribute("data-notif-id")]}),this.record(m,{"context":n.getAttribute("data-notif-type")});var i=t.find(".notifdd_list"),o=i.scrollTop,s=this.context.get("Engagement_MemberNotifications.data.notifications"),a=n.getAttribute("data-notif-index");s.remove(s.at(a)),this.render(),i=t.find(".notifdd_list"),i&&(i.scrollTop=o)}}},C=function(){require(["backbone/modbone/Vh,b)})};return{toggleNotifCenter:function(){if(a=t.find(".masthead_notification_enabled"),f=t.find(".masthead_notification",a),d=t.find(".masthead_notifctr_dropdown",f),r=t.find(".notifdd_loading",d),c=t.find(".masthead_notifctr_btn",f),o||(o=!0,t.addEvent(window,"click",g)),!i)return i=!0,v(),void e(h,d).success(C).success(p);if(t.hasClass(d,"hidden")){var n=window.bbapp&&bbapp.getView(h);if(!n)return;v(),n.refreshData().success(p)}else g()}}}return i(t,n)});
define("overlays/options/storeOverlayOnElement",["vanillajs","api-mod"],function(e,t){"use strict";var n=function(){this.sourceElement&&t.store(this.sourceElement,"overlay",this)};return n});
define("overlays/options/matchWidth",["vanillajs","api-mod"],function(t,i){"use strict";var n=function(t){function n(){this.container&&t&&(i.setStyle(this.container,"width",i.getSize(t).x+"px"),this.emit("positionDirty"))}return function(){this.on("show",i.bind(n,this))}};return n});
define("overlays/options/closeOnLegacyOverlay",["vanillajs","ta/Core/TA.Event"],function(n,e){"use strict";ris))}});
define("overlays/uiOverlay",["vanillajs","api-mod","utils/responsive"],function(t,e,a){"use strict";function o(t){var e=a[t.getAttribute("data-breakpoint")];return!("function"==typeof e&&!e())}var r={"tooltip":{defaultPosition:"above",defaultFade:"fade_short"},"popover":{defaultPosition:"below",defaultFade:"fade_short"},"modal":{defaultPosition:"center",defaultFixed:!0,defaultFade:"fade_short"},"dropdown":{defaultPosition:"below"},"notification":{}},i={},s=function(t,a){if(t=t||window.event,a=a||t.target||t.srcElement,o(a)){var s=t&&t.type;s&&e.removePropertyEvent(a,s,"uiOverlay"),t&&e.stopEvent(t);var n,l=(a.getAttribute("data-position")||"").split(" ").fngth}),u=l.shift(),d=["overlays/Overlay","overlays/position"];for(var v in r)if(a.hasAttribute("data-"+v)){u=u||r[v].defaultPosition,d.push("overlays/styles/"+v),n=!0;break}var c=a.getAttribute("data-options")||"";if(!n&&require.defined("ta/util/Error")){var p="uiOverlay: no style. class="+a.className+", id="+a.id;return[].forEach.call(a.attributes,function(t){/^data-/.test(t.name)&&(p+=", "+t.name+"="+t.value)}),void require("ta/util/Error").record(null,p)}d.push(a.hasAttribute("data-windowshade")?"overlays/styles/windowshade":null);var h=!1;a.hasAttribute("data-defer")&&(h=parseInt(a.getAttribute("data-defer"))),d.push(h?"overlays/options/hoverDelay":null),d.push(a.hasAttribute("data-fade")?"overlays/options/fadeInOut":null),d.push(a.getAttribute("data-url")?"overlays/options/ajax":null),d.push(a.hasAttribute("data-close-event")?"overlays/options/closeOnEvent":null),d.push(a.hasAttribute("data-close-ta-event")?"overlays/options/closeOnTaEvent":null),d.push(a.hasAttribute("data-maxWidth")?"overlays/options/maxWidth":null),d.push(a.hasAttribute("data-close-child")?"overlays/options/closeOnTargetChildClick":null);var f=a.hasAttribute("data-move-padding")||a.hasAttribute("data-move-source");d.push(f?"overlays/options/moveIntoView":null),d.push(a.hasAttribute("data-keep-in-dom")?"overlays/options/keepInDom":null),d.push("overlays/options/storeOverlayOnElement"),c&&(d=d.concat(c.split(" ").map(function(t){return"overlays/options/"+t}))),a.hasAttribute("data-tooltip")?"click"===s?d.push("overlays/options/closeOnDocClick"):"mouseover"===s&&c.indexOf("closeOnMouseAway")<0&&d.push("overlays/options/closeOnMouseOut"):a.hasAttribute("data-dropdown")&&("click"===s?(d.push("overlays/options/closeOnDocClick"),d.push("overlays/options/closeOnSourceClick")):"mouseover"===s&&d.push("overlays/options/closeOnMouseAway")),d.push(a.hasAttribute("data-zIndex")?"overlays/options/zIndex":null);var y;if(!(a.hasAttribute("data-unique")&&(y=a.getAttribute("data-unique"),y&&y in i))){var b;return a.hasAttribute("data-group")&&(b=a.getAttribute("data-group")),require(d,function(t,n,d,c,p,f,A,g,m,w,O,E){var k=[d(a,u),u&&n[u](l,r[v].defaultFixed),c&&c(a.getAttribute("data-windowshade")),p&&p(h,!0),f&&f(r[v].defaultFade),A&&A(),g&&g(a.getAttribute("data-close-event")),m&&m(a.getAttribute("data-close-ta-event")),w&&w(a.getAttribute("data-maxWidth")),O&&O(a.getAttribute("data-close-child")),E&&E(a.getAttribute("data-move-source"),parseInt(a.getAttribute("data-move-padding"),10))],x=Array.prototype.slice.call(arguments,11),I=new t(a,k.concat(x)),q=function(){e.select(".ui_tooltip").forEach(function(t){t.overlay&&t.overlay!=I&&t.overlay.hide()}),b&&(i[b]||[]).fode()}),I.show()};if(b){var C=i[b]||[];C.push(I),i[b]=C}if(s&&!h){var F=function(t){o(a)&&(q(),e.stopEvent(t))};e.addEvent(a,s,F),I.on("dess,F)})}if(y&&(i[y]=I,I.on("desi[y]})),!h&&q(),a.hasAttribute("data-callback")){var P=e.fn(a.getAttribute("data-callback"));P&&P(I)}}),!1}var A=i[y];if(A.sourceElement=a,A.updateContent(),!h&&A.show(),a.hasAttribute("data-callback")){var g=e.fn(a.getAttribute("data-callback"));g&&g(A)}}};return s}),window.uiOverlay=function(){var t=arguments;require(["overlays/uiOverlay"],function(e){e.apply(null,t)})};
define("widget/components",["babel/babel-helpers"],function(e){var t={};return t.initComponentWidgets=function(e,o){var n=t.getComponentWidgets(e,o);return 0===n.length?n:(require(["babel/babel-helpers","@ta/platform.runtime"],function(e,t){n.forEach(function(e){var o=e.getAttribute("data-component"),n=e.id,r=e.getAttribute("data-component-props"),i="page-manifest"===r?t.pageManifestComponents[n]:JSON.parse(r);t.importBundle(o).then(function(){var e=!!document.getElementById(n);e&&t.createRoot(n,o,i)})})}),n)},t.getComponentWidgets=function(e,t){var o=e&&e.querySelectorAll(".component-widget[data-component"+(t?"='"+t+"'":"")+"]");return o?Array.prototype.slice.apply(o):[]},t.contains=function(e,o,n){var r=t.getComponentWidgets(o||document.body,n);return r.some(function(t){return t.contains(e)})},t.termsOfUseGate=function(){return new Promise(function(e){require(["babel/babel-helpers","@ta/platform.runtime","redux-init"],function(t,o,n){if(!n.getState().auth.loggedInUserId)return e();var r="@ta/social.terms-of-use-gate";o.importBundle(r).then(function(){if(!document||!document.body)return e("Document or document body is not defined");var t=document.createElement("div");t.id=r,document.body.appendChild(t),o.createRoot(t.id,r,{onComplete:function(){o.destroyRoot(t.id),t.remove(),e()},onClose:function(n){n.trigger&&(o.destroyRoot(t.id),t.remove(),e("User has exited the gate without completing"))}})})})})},t.loadOverlayComponent=function(e){return new Promise(function(t){return require(["babel/babel-helpers","@ta/platform.runtime"],function(o,n){n.importBundle(e).then(function(){var r=document.createElement("div"),i=Math.random(),a=e+":"+i;r.id=a,document.body.appendChild(r);var u=function(t){[].concat(o.toConsumableArray(document.querySelectorAll(".ui_overlay"))).forEach(function(e){e.remove()}),n.createRoot(a,e,ve()};t({createRoot:u,destroyRoot:d})})})})},t.socialGate=function(e,t){return new Promise(function(o){require(["babel/babel-helpers","@ta/platform.runtime"],function(n,r){var i="@ta/social.immediate-login-gate";r.importBundle(i).then(function(){if(!document||!document.body)return o("Document or document body is not defined");var n=document.createElement("div");n.id=i,document.body.appendChild(n);var a=void 0,u=document.getElementById("contextualMessage");u&&(a={contextualMessage:u.value}),r.createRoot(n.id,i,{flowOrigin:t,onComplete:function(){return r.destroyRoot(n.id),n.remove(),o()},onClose:function(e){if(e.trigger)return r.destroyRoot(n.id),n.remove(),o("User has exited the gate without completing")},pid:e,extraRegParams:a})})})})},t});
define("ta/prwidgets",["vanillajs","ns-exporter","purify","amdloaders","widget/components"],function(t,e,r,n,i){function a(t,e){var r,n=this.element._prWidgetContext;return"string"==typeof t?(t=[t],r=o(n.widget.name,t),r=r[0]&&w(r[0]),r=r&&l(n,t,[r]),r&&r[0]):(t=t.slice(),void w(o(n.widget.name,t),function(){var r=l(n,t,arguments);e&&e.apply(null,r)}))}function o(t,e,r){var n=b[t];if(!n)return[];e=e.slice();for(var i=0;i<e.length;++i){var a=e[i],o=a.replace(/^[a-z]+!/,""),l=a.substring(0,a.length-o.length);"trhtml!"===l||("widget"===o?e[i]=null:n["trjs!"===l?o:a]&&(e[i]=l+"$prw/"+t+"/"+o))}return e}function l(t,e,r){var n,i;if(r=Array.prototype.slice.apply(r),0===e.length)return r;var a=b[t.widget.name];if(r.length<e.length)for(n=o(t.widget.name,e);(i=r.length)<e.length;)n[i]?r.push(w(n[i])):r.push(null);for(var i=0;i<e.length;++i){var l=e[i].replace(/^trjs!/,"");t[l]?r[i]=t[l]:a[l]&&"function"==typeof r[i]&&(r[i]=r[i].call(null,t))}return r}function u(t){t._prWidgetContext=this.element._prWidgetContext}function p(t){var e,r,n,i,o,l;if(t&&!t._prWidgetContext&&(e=t.getAttribute("data-prwidget-init"),"string"==typeof e&&(n=t.getAttribute("data-prwidget-name")))){e=d(e),o=d(t.getAttribute("data-scriptFlags")).r!0,t},{});var p=e.length;if(l=t.getAttribute("data-prwidget-deferred")){l=d(l);for(var i=0;i<l.length;i++)e.push(l[i])}var f=b[n];for(f||(b[n]=f={}),r={},i=0;i<e.length;i++)f[e[i]]=!0;r.widget={"name":n,"element":t,"modules":e,"flags":o,"markMine":u,"require":a},t._prWidgetContext=r,r.widget.require(e.slice(0,p),function(){if(t._prPendingClick){var e=t._prPendingClick;t._prPendingClick=void 0,e.key===v&&window.setTirgs)},0)}})}}function f(t,e){var n,i;if(!e&&(t=r(t,!0),t.forEach))return void t.forEach(function(t){y.initWidgets(t,!0)});for(n=t.querySelectorAll(".prw_rup"),i=0;i<n.length;i++)p(n[i]);for(n=t.querySelectorAll(".prw_dyn"),i=0;i<n.length;i++)p(n[i])}function d(t){return"string"!=typeof t?[]:t.match(/[^\s,]+(\s+[^\s,]+)*/g)||[]}function g(t){var e=t._prWidgetContext;if(e)return e;for(t=t.parentNode;t&&t.hasAttribute;t=t.parentNode){if(e=t._prWidgetContext)return e;if(t.hasAttribute("data-prwidget-init"))break}}function c(t){for(var e=t;e&&e.hasAttribute;e=e.parentNode)if(e.hasAttribute("data-prwidget-init"))return e}function s(t){t&&t.nodeName&&A.test(t.className||"")&&(t.className=(t.className||"").replace(A,""))}function h(t){t&&t.nodeName&&!A.test(t.className||"")&&(t.className=(t.className||"")+" handlerLoading")}var v,y={},m=define,w=require,b={},A=/\bhandlerLoading *\b/g;return y.define=function(t,e,r,n,i){if(e=e.replace(/\.js$/i,""),"[object Array]"!==Object.prototype.toString.call(n)&&(n=[]),r&&r.length){var a=b[t];a||(b[t]=a={});for(var u=0;u<r.length;u++)a[r[u]]=!0}m("$prw/"+t+"/"+e,o(t,n),function(){var t=Array.prototype.slice.apply(arguments);return function(r){return r[e]||(r[e]=i.apply(null,l(r,n,t))),r[e]}})},y.redefine=function(t,e){return w.undef&&w.undef("$prw/"+t+"/"+e),y.define.apply(this,arguments)},y.getjs=function(t,e){var r=g(t);if(r&&"string"==typeof e)return r.widget.require(e)},y.initWidgets=function(t,e){t||(t=document),("string"!=typeof t||(t=document.getElementById(t)))&&(f(t,e),i.initComponentWidgets(t))},y.getWidgetElement=function(t,e){return e=e||document.body,e.querySelector(".prw_"+t)},y.call=function(t,e,r,n){if("string"!=typeof t||!r)throw"ta.prwidgets.call() requires method, event||null, element";var i=g(r),a=e&&("click"===e.type||"submit"===e.type);if(a&&(e&&e.preventDefault&&e.preventDefault(),v=void 0),!i){if(a){var o=c(r);o&&!o._prWidgetContext&&(v={},o._prPendingClick={key:v,args:Array.prototype.slice.call(arguments,0)})}return!1}var l=t.match(/^((?:[^\/]+\/)*[^\/\.]+)\.([^\/]*)?$/),u=l[1];l=l[2].split(".");var p=Array.prototype.slice.call(arguments,1),f=function(e){s(r);for(var n=void 0;l.length>0&&e;)n=e,e=e[l.shift()];if("function"!=typeof e)throw"ta.prwidgets.call: '"+t+"' is not a function";return e.apply(n||{},p),!1};return i[u]?f(i[u]):void((a||require.defined("$prw/"+i.widget.name+"/"+u))&&(h(r),i.widget.require(["trjs!"+u],f)))},e.exportTo(y,"ta.prwidgets"),y});
define("ta/p13n/placement-store",["vanillajs","ta/rollupAmdShim"],function(e,r){"use st,"")}function n(e,r,n,l,a){if(r=t(r),"[object Array]"!==Object.prototype.toString.call(l)&&(l=[]),n&&n.length){var o=y[e];o||(y[e]=o={});for(var p=0;p<n.length;p++)o[n[p]]=!0}m("$prp/"+e+"/"+r,c(e,l),function(){var e=Array.prototype.slice.apply(arguments);return function(t){return t[r]||(t[r]=a.apply(null,i(t,l,e))),t[r]}})}function l(e,r){return d.undef&&d.undef("$prp/"+e+"/"+r),n.apply(this,arguments)}function a(e,r){var t,n=v[this.id];return"string"==typeof e?(e=[e],t=c(n.placement.dir,e,n.placement),t=t[0]&&d(t[0]),t=t&&i(n,e,[t]),t&&t[0]):(e=e.slice(),void d(c(n.placement.dir,e,n.placement),function(){var t=i(n,e,arguments);r&&r.apply(null,t)}))}function c(e,r,t){var n=y[e];if(!n)return console&&console.error&&console.error(e+" _externalizeDeps - Failed to locate module map"),[];r=r.slice();for(var l=0;l<r.length;++l){var a=r[l],c=a.replace(/^[a-z]+!/,""),i=a.substring(0,a.length-c.length);"trhtml!"===i?t&&(c+=(c.indexOf("?")>=0?"&occur=":"?occur=")+t.occurrence,r[l]=i+"$prp/"+t.name+"/"+c):"placement"===c?r[l]=null:n&&n["trjs!"===i?c:a]&&(r[l]=i+"$prp/"+e+"/"+c)}return r}function i(e,r,t){var n,l;if(t=Array.prototype.slice.apply(t),0===r.length)return t;var a=y[e.placement.dir];if(t.length<r.length)for(n=c(e.placement.dir,r);(l=t.length)<r.length;)n[l]?t.push(d(n[l])):t.push(null);for(var l=0;l<r.length;++l){var i=r[l].replace(/^trjs!/,"");e[i]?t[l]=e[i]:a[i]&&"function"==typeof t[l]&&(t[l]=t[l].call(null,e))}return t}function o(e){e&&e.nodeName&&h.test(e.className||"")&&(e.className=(e.className||"").replace(h,""))}function p(e){e&&e.nodeName&&!h.test(e.className||"")&&(e.className=(e.className||"")+" handlerLoading")}function u(e,r,t,n,l,a){var c=Array.prototype.slice.call(arguments,3);if("[object Array]"!==Object.prototype.toString.call(t)&&(c=Array.prototype.slice.call(arguments,2),l=n,n=t,t=[]),"string"!=typeof e||"string"!=typeof r)throw"placements.evCall() requires id, method, event?, element?, ...";var i=v[e],u=n&&("click"===n.type||"submit"===n.type);if(u&&(n.preventDefault&&n.preventDefault(),f=void 0),!i){if(u){var s=document.getElementById(e);s&&(f={},s._prPendingClick={key:f,args:Array.prototype.slice.call(arguments)})}return!1}var m=r.match(/^((?:[^\/]+\/)*[^\/\.]+)\.([^\/]*)?$/),d=m[1];m=m[2].split(".");var y=function(e){o(l);for(var t=void 0;m.length>0&&e;)t=e,e=e[m.shift()];if("function"!=typeof e)throw"placements.evCall: '"+r+"' is not a function";return e.apply(t||{},c),!1};return i[d]?y(i[d]):(p(l),void i.placement.require(["trjs!"+d].concat(t),y))}function s(e){return{load:function(r,n,l){n=t(n);var c=l.id,i=v[c];return i||(i=e(l),v[c]=i,l=i.placement||l,i.placement=l,l.dir=r,l.require=a),i[n]||(i[n]=null,i.placement.require(n))},define:n,redefine:l,evCall:u}}var f,m=define,d=require,v={},y={},h=/\bhandlerLoading *\b/g;return s});
define("ta/p13n/placements",["vanillajs","ns-exporter","ta/prwidgets","ta/p13n/placement-store"],function(e,n,a,t){"use strict";function r(e){var n=e;return n.indexOf(":")>0&&(n=n.substring(0,n.indexOf(":"))),n}function l(){var e=Array.prototype.slice.call(arguments);require(["trjs!ta/p13n/placements-ajax"],function(n){n.loadDynamicPlacement.apply(n,e)})}function c(){var e=Array.prototype.slice.call(arguments);require(["trjs!ta/p13n/placements-an,e)})}var i=new t(function(e){var n={};if(e)for(var a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);return n.requestAJAXPlacement||(n.requestAJAXPlacement=function(e,a,t,r){require(["trjs!ta/p13n/placements-at,r)})}),{placement:n}}),o={"define":i.define,"redefine":i.redefine,"load":i.load,"evCall":i.evCall,"loadDynamicPlacement":l,"enableAutoRefresh":c,"getTemplateBaseFromPlacementName":r};return n.exportTo(o,"ta.p13n.placements"),o});
define("ta/p13n/placements-ajax",["vanillajs","api-mod","utils/ajax","ta/util/Error","ta/Core/TA.Store","ta/Core/TA.Event","ta/prwidgets"],function(e,t,a,r,n,s,l){"use strict";function o(e,t,a,n){var s=a?a.status:-1;if(!(s<400)){var l=a?a.statusText:"?",o=a?a.getResponseHeader("content-length"):"?";r.record(null,e+" load - MetaPlacementAjax "+n+" ("+s+" "+l+", length: "+o+")"),t&&t()}}function u(e,r,n,s,l){var u={detail:""+e.location_id,placementName:e.name,servletClass:e.servletClass,servletName:e.servletName};window.pageServlet&&(u.metaReferer=window.pageServlet),s&&(u=t.merge(u,s)),a({url:"/MetaPlacementAjax",data:u,method:l||"GET",evalScripts:!0,success:r,error:o.bind(null,e.name,n)})}function i(e,r,n){var s,l,u={};e&&(R[e]=R[e]||1e3,n=n||{},s=g()||{},window.pageServlet&&(u={metaReferer:window.pageServlet}),l=t.merge(s,n,{placementName:e,assets:!p(e),wrap:!0,occOffset:R[e]},u),a({url:"/MetaPlacementAjax",data:l,evalScripts:!0,success:function(t){R[e]++,t=v(e,t),r&&r(t)},error:o.bind(null,e,null)}))}function d(e,a,r){if(!n.retrieve("ta.redirectingPage")){if(e[S]&&a<=1)return void(e[S]="requested");a<=1&&(e[S]="polling");var s=!1,o=g();o?s=!0:o={};var i={};window.pageServlet&&(i={metaReferer:window.pageServlet});var c=t.merge(o,i,{"reqNum":a});r.customRequestParams&&(c=t.merge(c,r.customRequestParams));var m=r.displayableRequestNumber||1,v=r.maxRequestNumber||5;u(e,function(n){function o(a){if(!r.displayImmediately){a&&a.target&&(t.removeEvent(a.target,"mouseout",o),t.removeEvent(a.target,"blur",o));var n=p.querySelector&&p.querySelector(":hover");if(n)return void t.addEvent(n,"mouseout",o);var s=p.querySelector&&p.querySelector(":focus");if(s)return void t.addEvent(s,"blur",o)}e.latestCrossSellResponseText&&(r.customUpdater?r.customUpdater(e.latestCrossSellResponseText):(p.innerHTML=e.latestCrossSellResponseText,l.initWidgets(p)),delete e.latestCrossSellResponseText,r.onSuccess&&r.onSuccess())}e.latestCrossSellResponseText=n;var u="requested"===e[S],i=r.readyStrings||["xsellHacStatusReady","xsellHacStatusSOL"],c=a>=v||i)>=0})||!s,g=a>=m||c,p=document.getElementById(e.id);p&&(g&&o(),!c||u?(e[S]="polling",setTimeout(d.bind(null,e,a+1,r),r.pollWaitTime||2e3)):delete e[S])},r.onFailure,c)}}function c(e,a){e.autoRefreshEnabled||(a=a||{},s.queueForLoad(function(){var r=a.customRequestParams||{};a.includePackagePrivateAssetsOnDateChange&&(r=t.merge({},r,{packagePrivateAssets:!0}));var n=t.merge({},a,{displayableRequestNumber:a.onCalendarRangeSelectDisplayableRequestNumber||2,customRequestParams:r});ta&&ta.page?ta.page.on("dateSelected",function(t,a){"STAYDATES"===a&&ta.page.hasDates("STAYDATES")&&d(e,1,n)}):s.on("onCalendarRangeSelect",d.bind(null,e,1,n));var l=t.merge({},a,{customRequestParams:r});s.on("clearDates",d.bind(null,e,1,l));var o=a.initialRequestNumber||1;(m()||a.allowUndated)&&d(e,o,a)},"initialize "+e.id),e.autoRefreshEnabled=!0)}function m(){return ta.page&&ta.page.hasDates("STAYDATES")||ta.widgets&&ta.widgets.calendar&&ta.widgets.calendar.hasPageDates()}function g(){return ta.page?ta.page.datesToQueryJson("STAYDATES"):ta.widgets&&ta.widgets.calendar?ta.widgets.calendar.getCheckRatesData():null}function v(e,t){var a,r,n=document.createElement("div");for(n.innerHTML=t,a=n.getElementsByTagName("style");a.length>0;)r=n.removeChild(a[0]),p(e)||document.head.appendChild(r);return f[e]=!0,n.innef[e]}var S="__polling",f={},R={};return{"requestAJAXPlacement":u,"loadDynamicPlacement":i,"enableAutoRefresh":c}});
define("calendars/CalendarDate",["vanillajs"],function(t){"use strict";function n(t){t=t||new Date,this.date=new Date(t.getFullYear(),t.getMonth(),t.getDate())}return n.prototype={constructor:n,daysInte()},eachDayInMonth:function(t){for(var e=1,r=this.daysInMonth();e<=r;e++)t(new n(new Date(this.year(),this.month(),e)))},thisMonth:function(){return new n(new Date(this.year(),this.month(),1))},nexth(1)},previous(-1)},relativeMonth:function(t){return new n(new Date(this.year(),this.month()+t,1))},relativeDay:function(t){return new n(new Date(this.year(),this.month(),this.day()+t))},firstOfMonth:function(){return new n(new Date(this.year(),this.month(),1))},lastOfMonth:function(){return new n(new Date(this.year(),this.month(),this.daysInMonth()))},year:function(){return this.date.getFullYear()},month:function(){return this.date.getMonth()},day:function(){return this.date.getDate()},dayOay()},firstDayOfay()},inRange:function(t,n){return!(!t||!n)&&(this.compare(t)>0&&this.compare(n)<0)},compare:function(t){for(var n,e=["getFullYear","getMonth","getDate"],r=0,i=e.length;r<i;r++){if(n=e[r],this.date[n]()<t.date[n]())return-1;if(this.date[n]()>t.date[n]())return 1}return 0},daysTo:function(t){return Math.ceil((t.date.getTime()-this.date.getTime())/864e5)},toISOS)[0]},toSay()}},n.fromString=function(t){var e=t.split("-");return new n(new Date(e[0],e[1],e[2]))},n});
define("mixins/page-dates/Utils",["vanillajs"],function(e){"use st())}function n(e,t){return t+"Year="+e.getFullYear()+"&"+t+"Month="+(e.getMonth()+1)+"&"+t+"Day="+e.getDate()}function a(e){return n(e[0],"in")+"&"+n(e[1],"out")}function i(e){if(!e)return null;var t=e.split("-");return t.length<2&&(t=e.split("_")),new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2]l(e)}function o(e,t){if((!e||!t)&&[e,t].every(u))return!1;var r=new Date(e.getTime()),n=new Date(t.getTime());return r.setHours(0,0,0,0),n.setHours(0,0,0,0),r.getTime()===n.getTime()}function s(e,t){if((!e||!t)&&[e,t].every(u))return!1;var r=new Date(e.getTime()),n=new Date(t.getTime()),a=864e5;return r.setHours(0,0,0,0),n.setHours(0,0,0,0),Math.round((n.getTime()-r.getTime())/a)}function g(e,t){for(var r;e;){if(r=e.querySelector("[data-dateType="+t+"]"))return r;e=e.parentNode}return null}function l(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var r=!0,n=0;n<e.length;n++)r=r&&o(e[n],t[n]);return r}return{pad:t,dateToIso:r,datesToCommerceUrlParams:a,fromString:i,compareDatesNoTime:o,compareDatesArrayNoTime:l,getNumNightsNoTime:s,findClosestDatepicker:g}});
define("mixins/page-dates/DateTypeStore",["vanillajs","ta/Core/TA.Store","calendars/CalendarDate","mixins/page-dates/Utils"],function(t,e,n,r){"use strict";function i(t){var e=[];for(var n in T)T.hasOwnProperty(n)&&T[n].children&&T[n].children.indexOf(t)>=0&&e.push(n);return e}function a(t){var e=ta.page.getDates(t);return e&&e[0]?new n(e[0]):null}var u="zu",T={CHECKIN:{queryString:null,pathString:null},CHECKOUT:{queryString:null,pathString:null},STAYDATES:{children:["CHECKIN","CHECKOUT"],queryString:"staydates",pathString:u+"s"},EATERY:{queryString:"eaterydate",pathString:u+"r"},DEPARTURE:{queryString:null,pathString:null},RETURN:{queryString:null,pathString:null},ROUNDTRIP:{children:["DEPARTURE","RETURN"],queryString:"rtdates",pathString:u+"t"},ONEWAYFLIGHT:{queryString:"oneway",pathString:u+"o"},LEG_1:{queryString:"leg1date",pathString:u+"1"},LEG_2:{queryString:"leg2date",pathString:u+"2"},LEG_3:{queryString:"leg3date",pathString:u+"3"},ATTRACTION:{queryString:"attrdate",pathString:u+"a"},ATTRACTION_FROM:{queryString:null,pathString:null},ATTRACTION_TO:{queryString:null,pathString:null},ATTRACTIONRANGE:{children:["ATTRACTION_FROM","ATTRACTION_TO"],queryString:"attrrange",pathString:u+"e"},VPDATES:{children:["VPDEPARTURE","VPRETURN"],queryString:"vpdates",pathString:null},VPDEPARTURE:{queryString:null,pathString:null},VPRETURN:{queryString:null,pathString:null}};return T.getStartDateType=function(t){var e=i(t);if(0==e.length){var n=T[t].children;return n&&n.length>0?n[0]:t}return T[e[0]].children[0]},T.getEndDateType=function(t){var e=i(t);if(0==e.length){var n=T[t].children;return n&&n.length>0?n[n.length-1]:t}var r=T[e[0]];return r.children[r.children.length-1]},T.isChildDatth>0},T.isSingleDateType=function(t){var e=T[t];return!(T.isChildDateType(t)||e&&e.children&&e.children.length>0)},T.getParents=i,T.isHotelDateType=function(t){return i(t).indexOf("STAYDATES")>=0},T.isRoundTripDateType=function(t){return i(t).indexOf("ROUNDTRIP")>=0},T.isAttractionRangeDateType=function(t){return i(t).indexOf("ATTRACTIONRANGE")>=0},T.isVacationPackagesDateType=function(t){return i(t).indexOf("VPDATES")>=0},T.allowsSameDaye(t)},T.isMultiCityDat"==t},T.isStartDateType=function(t){var e=i(t);return 0!=e.length&&0==T[e[0]].children.indexOf(t)},T.isEndDateType=function(t){var e=i(t);if(0==e.length)return!1;var n=T[e[0]];return n.children.indexOf(t)==n.children.length-1},T.getStartDate=function(t){var e=T.getStartDateType(t);return null==e?ta.page.getDates(t)[0]:ta.page.getDates(e)[0]},T.getEndDate=function(t){var e=T.getEndDateType(t);return null==e?ta.page.getDates(t)[0]:ta.page.getDates(e)[0]},T.getMinEnabledDate=function(t){if(T.isHotelDateType(t)||T.isRoundTripDateType(t)){var i=e.retrieve("multiDP.minCheckInDate");if(i)return new n(r.fromString(i))}else{if("LEG_1"==t)return a("ONEWAYFLIGHT");if("LEG_2"==t)return a("LEG_1")||a("ONEWAYFLIGHT");if("LEG_3"==t)return a("LEG_2")||a("LEG_1")||a("ONEWAYFLIGHT");if("ATTRACTION_TO"==t)return a("ATTRACTION_FROM")}return null},T.flattenType=function(t){var e=T[t];return e?e.children?e.children.slice(0):[t]:[]},T.getCorrespondingDatull}},T});
define("mixins/page-dates/picker-autoadvance-utils",[],function(){var e={};return e.keepOverlayOpenOnSelection=function(e){for(var n=document.querySelectorAll(".ui_overlay"),r=0;r<n.length;r++){var t=n[r].overlay,a=t&&t.sourceElement;if(a===e){t.dontHideOnSelection=!0;break}}},e});
define("ta/support/Qualtrics",["vanillajs","ns-exporter","page-model","ta/Core/TA.LocalStorage"],function(e,t,n,s){"use strict";var i={},r=function(e,t,n,s){thinull},this.set=function(e,t){var n="",n=new Date;n.setTime(n.getTime()+6048e5),n="; expires="+n.toGMTString(),document.cookie=e+"="+t+n+"; path=/; "},this.rn!0},this.go=function(){if(this.check()){var e=document.createElement("script");e.type="text/javascript",e.src=s+"&t="+(new Date).getTime(),document.body&&document.body.appendChild(e)}},this.go()}};i.displaySurvey=function(e){var t=n.session.uid,s="QSI_S_"+e,i="//znbkpczkrl5wwqzj3-tripadvisor.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_SIID="+e+"&UID="+t+"&Q_LOC="+encodeURIComponent(window.location.href);try{require(["@ta/platform.runtime"],function(e){e.importBundle("@ta/platform.consent").then(function(e){e.requestConsent(e.CategoriesEnum.ANALYTICS,function(){new r(100,"r",s,i).start()})})})}catch(e){}R(!0)};var a=2592e6,o=6048e5,u=!1,c=!1,l=4,p=3,f=2,g=Math.round(10*Math.random())%2,d=!1,h=function(){return s.get("qualtrics-debug")},v=function(){return Number(s.get("qualtrics-session-count")||0)},q=function(){return!!s.getSessionKey("qualtrics-session-count-incremented")},m=function(){var e=v(),t=s.getSessionKey("qualtrics-session-count-incremented");t||(s.set("qualtrics-session-count",e+1,o),s.setSessionKey("qualtrics-session-count-incremented",!0",e)},y=function(){return!!s.getSessionKey("qualtrics-ignorede,ed")},b=function(){return Number(s.getSessionKey("qualtrics-page-views")||0)},D=function(){return Number(s.getSessionKey("qualtrics-intercept-views")||0)},K=function(){var e=D();s.setSessionKey("qualtrics-intercept-views",++e),4===e&&S(!||0)},C=function(){var e=T();s.setSessionKey("qualtrics-intercept-reqs",e+1)},N=function(){return{d=e},L=function(){var e=!1,t=N();if(t){var n=I()||y(),s=v(),i=q(),r=b(),a=D();!n&&(s<p||s==p&&i)&&a<l&&(r===f||r>f&&0===g)&&(e=!0)}return e};i.isDebug=h,i.setResponded=w,i.hasResponded=I,i.getPageViews=b,i.getSmartSurvey=N,i.setSmartSurvey=k,i.updateInterceptViews=K,i.canDisplaySmart=L,i.getSessionCount=v,i.updateSessionCount=m,i.getInterceptViews=D,i.updateInterceptReqs=C,i.getInterceptReqs=T;var R=function(e){e?(s.set("qualtrics-last-seen",Date.now()),u=!0):s.remove("qualtrics-last-seen")},j=function(){var e=parseFloat(s.get("qualtrics-last-seen")),t=isNaN(e)?0:e,n=t<0?0:t+a;return Date.now()<n},x=function(){return u},M=function(){var e=Number(s.get("qualtrics-page-views"));return 2===e&&!i.hasShownInLastThirtyDays()||1===e&&!c&&!i.hasShownInLastThirtyDays()},V=function(){if(N()&&(v()<p||v()==p&&q())&&!I()&&!y()){var e=b();s.setSessionKey("qualtrics-page-views",e+1)}var t=s.get("qualtrics-session-id"),i=n.session.sessionId;if(t&&t===i){var e=Number(s.get("qualtrics-page-views"))+1;s.set("qualtrics-page-views",e)}else s.set("qualtrics-session-id",i),s.set("qualtrics-page-views",1);c=!0};return i.hasShownInLastThirtyDays=j,i.seenThisPageView=x,i.canDisplay=M,i.updatePageViews=V,t.exportTo(i,"ta.support.qualtrics"),i});
define("mixins/page-dates/pop-calendar",["ta","common/trackingStreams","common/Radio","ta/support/Qualtrics","ta/Core/TA.Store","ta/Core/TA.LocalStorage","ta/util/SessionStorage","utils/responsive"],function(e,t,n,r,i,a,o,s){function d(){j=!1}function u(t){b=!!t.popFromDefault,D=!!t.popFromVisibleOnly,P=t.popFromVisibleOnlyBreakpoint,k=!!t.datesWereDefaulted,y=t.popCalendarType,T=!!t.hasMetaMarketingDefaultDates,E=!!t.qualtricsSurveyEnabled,O=!!t.isDetailPage,A="Vacation_Packages"===window.pageServlet,e.page.on("datepickerRejected",d),e.page.on("dateSelected",d)}function c(e){if(a.enabled&&a.get("popCalendarAfterRedirectedFromIB"))return a.remove("popCalendarAfterRedirectedFromIB"),!0;if(!k||R)return!1;if(i.retrieve("suppressCalendarPop"))return!1;if(!y)return!1;if(E&&r&&(r.canDisplay()||r.seenThisPageView())){if(!require.defined("page-model"))return!1;if(require("page-model").isMobile)return!1}if(e&&D&&(!P||s.is(P,!0,!1)())&&!g(e))return!1;switch(y){case"doNot":return!1;case"untilClosedPerServletType":return!l();case"untilClosed":return!p();case"always":return!0}return b&&k}function p(){return o.canUseSessionStore()&&!!o.getObject(C)}function l(){var e=o.canUseSessionStore()&&o.getObject(C);return e&&!!e[A?"vp":O?"detail":"list"]}function f(){if(o.canUseSessionStore()){var e=o.getObject(C)||{};e[A?"vp":O?"detail":"list"]=!0,o.setObject("pop-calendar-dismissed",e),n("pop-calendar").emit("dismissdth)}function m(){return T}function S(n){j=!0,e.page.gatherDates(n),R=!0,t.trackEvent("DATEPICKER","auto-popped-calendar-shown",window.pageServlet),t.trackEvent("calendar","in_view","autopop")}function v(){ret=!1}var C="pop-calendar-dismissed",b=!1,D=!1,P="",k=!1,E=!1,T=!1,y="",O=!1,R=!1,j=!1,A=!1;return{init:u,shouldPop:c,shouldPopMetaMarketing:m,popCalendar:S,wasPoppedThisPageLoad:v,isShowing:h,setUserEnteredDates:w,setDismissedThisSession:f}});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["typeahead/TypeAhead.views","vanillajs","api-mod","ta/Core/TA.Event","mixins/page-dates/picker-autoadvance","mixins/page-dates/default-dates","lib/jquery-amd","ta/Core/TA.Store","typeahead/TypeAhead.views"],["ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/dual_search","files":{"js-amd":{"src":{"mixins":{"page-dates":{"default-dates":1,"picker-autoadvance":1}},"api-mod":1,"vanillajs":1}},"js3":{"lib":{"jquery-amd":1},"src":{"typeahead":{"TypeAhead.views":1},"ta":{"Core":{"TA.Event":1,"TA.Store":1}}}}},"_":{"baseUrl":"/"}});
define("mixins/page-dates/picker-autoadvance",["mixins/page-dates/DateTypeStore","mixins/page-dates/picker-autoadvance-utils","utils/domUtils"],function(e,t,a){"use strict";function i(i,r,s){var o=ta.page;o&&o.on("dateSelected",function d(l,u,p){if(!a.isOrContainsElement(document.body,i))return void o.off("dateSelected",d);if(l&&a.isOrContainsElement(i,l)){var c=e.getCorrespondingDateType(u);if(c){var f=e.isStartDateType(u),g=!o.hasDates(c)||s&&f&&u!==n;if(g){if(r&&!o.hasDates(c)&&Array.isArray(p)){var v=new Date(p[0].getFullYear(),p[0].getMonth(),p[0].getDate()+(f?1:-1));o.pushDates(null,c,[v])}var y=i.querySelector('[data-datetype="'+c+'"]');y&&(n=c,t.keepOverlayOpenOnSelection(l),setTimeout(o.gatherDates.bind(o,y)))}}}})}var n=null;return{apply:i}});
define("mixins/page-dates/default-dates",["ta","mixins/mixin","mixins/Events","mixins/page-dates/pop-calendar","mixins/page-dates/DateTypeStore","common/trackingStreams","vanillajs","ta/Core/TA.Event"],function(e,t,a,n,i,o,d,r){"use strict";function s(e){n.init(e),g=!!e.datesWereDefaulted,f=!!e.refreshLocalStorage,D=e.localStorageTTL,m=!0,S.emit("init")}function p(e){"function"==typeof e&&(m?e():S.on("init",e))}function u(t,a,d){function s(t){n.wasPoppedThisPageLoad()&&(S.emit("poppedCalendarDismissed",t),n.setDismissedThisSession(),e.page.off("datepickerRejected",s))}function p(){if(f&&(g&&o.trackEvent("DATEPICKER","undated_to_default_dated"),!a)){var t=n.shouldPop(f);(t||n.shouldPopMetaMarketing())&&(t&&S.emit("popFromDefault"),e.page.on("datepickerRejected",s),n.popCalendar(f))}}var u=d?d:"STAYDATES";if(e.page.usingUnifiedDates){e.page.hasDates(u)||e.page.clearDates(u),c=e.page.getDates(i.getStartDateType(u))[0],l=e.page.getDates(i.getEndDateType(u))[0];var f=t.querySelector('[data-datetype="'+i.getStartDateType(u)+'"]');e.page.on("dateSelected",function(a,i,d){var r,p=c&&l,f=e.page.getDates(u)[0],D=e.page.getDates(u)[1];if(t.contains(a)&&(!p&&e.page.hasDates(u)?r="undated_to_manually_dated":f==c&&D==l||(n.setUserEnteredDates(),e.page.off("datepickerRejected",s),g?(r="default_dated_to_manually_dated",g=!1):r="manually_dated_to_manually_dated"),c=f,l=D,r)){var m="";a&&a.getAttribute("data-picker-location")&&(m=a.getAttribute("data-picker-location"),document.querySelector("#PERSISTENT_TRIP_SEARCH_BAR.fixed")&&(m+="_persistent")),o.trackEvent("DATEPICKER",r,m)}}),"loading"===document.readyState?window.addEventListener("DOMContentLoaded",p):p(),r.on("specialOfferClosed",function(){a||f&&n.shouldPop(f)&&n.popCalendar(f)})}}var c,l,g=!1,f=!1,D=0,m=!1,S={init:s,onInit:p,apply:u,usingDefaults:function(){return g},shouldRefreshLocalStorage:function(){return f},getLocalStorageTTL:function(){return D}};return t(S,new a("popFromDefault"))});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"datepickers_desktop_horizontal_styleguide_icon","handlers",["handlers"]);t(["widget","vanillajs","api-mod","ta/Core/TA.Event","mixins/page-dates/picker-autoadvance","mixins/page-dates/default-dates"],function(e,t,a,n,i,r){"use strict";function d(e,t){var n,i=e.getAttribute("data-dateFormat");n=t?ta.i18n.formatDate(i,t):e.getAttribute("data-emptyText"),a.find(".picker-inner .picker-label",e).firstChild.nodeValue=n}function l(t,n,i){return a.inDocument(e.element)?void("CHECKIN"===n?d(u,i[0]):"CHECKOUT"===n?d(p,i[0]):"STAYDATES"===n&&(d(u,i[0]),d(p,i[1]))):(ta.page.removeListener("dateSelected",l),u=null,void(p=null))}function o(e,t){if(e){var a=e.getParent(".calendarFlyout");if(a){var n=a.deferred,i=a.getElement(".calendarWrapper");if(n&&i)return n.reject(),void ta.page.gatherDates(e,i,t)}ta.page.gatherDates(e,null,t)}}var u=a.find("[data-datetype=CHECKIN]",e.element),p=a.find("[data-datetype=CHECKOUT]",e.element);return n.queueForLoad(function(){ta.page.on("dateSelected",l),i.apply(e.element),r.apply(e.element)},"datepicker widget handlers"),{onDatePickerClick:o}})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"dual_search_dust","handlers",["deferred/lateHandlers","handlers"]);t(["placement","lib/jquery-amd","ta/Core/TA.Store","ta/Core/TA.Event","typeahead/TypeAhead.views"],function(e,t,r,a,o){function n(e,r){t("#"+e).on("click",function(e){0==t(e.target).closest("#"+r).length&&t("#"+r).focus()})}function i(){if(d.autoTooltip&&r.retrieve("isFirstSessionPageView")&&window.require){var e=["trjs!overlays/Overlay","trjs!overlays/position","trjs!overlays/styles/popover","trjs!overlays/options/maxWidth","trjs!overlays/options/repositionOnEvent"];require(e,function(e,t,r,a,o){var n=document.getElementById("SEARCH_BUTTON"),i=[t&&t.below&&t.below([],!1),r&&r(n,"below","dark small"," ",d.autoTooltip),a&&a(220)],s=new e(n,i);s&&s.show()})}}if(e.params&&"typeahead_to_store"in e.params){var s=e.params.typeahead_to_store;if(s)for(var l in s)s.hasOwnProperty(l)&&r.store(l,s[l])}n("GEO_SCOPE_CONTAINER","GEO_SCOPED_SEARCH_INPUT"),n("MAIN_SEARCH_CONTAINER","mainSearch");var d=r.retrieve("typeahead_dual_search_options");return document.activeElement===t("#GEO_SCOPED_SEARCH_INPUT")[0]?e.require(["trjs!deferred/lateHandlers"],function(e){e.whereFocused({type:"dummy"},document.activeElement)}):document.activeElement===t("#mainSearch")[0]?e.require(["trjs!deferred/lateHandlers"],function(e){e.whatFocused({type:"dummy"},document.activeElement)}):d&&d.autoTooltip&&a.queueForLoad(i,"dual_search auto tooltip"),{getOptions:function(){return d}}})});
!function(e){e.util.escaping={escapeHTMLSafe:function(e){return"string"==typeof e||e instanceof String?e.replace(/&/gi,"&amp;").replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;").replace(/'/gi,"&#x27;").replace(/\//gi,"&#x2F;"):""},unescapeHTMLSafe:function(e){return"string"==typeof e||e instanceof String?e.replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/gi,'"').replace(/&#x27;/gi,"'").replace(/&#x2F;/gi,"/"):""}}}(ta);
ta.servlet.TravelersChoice={arrowcounter:0,rotate_photos:function(){var e,t=$$("#TCLNDRPHOTOVIEWER .heroPhotoWrapper.active")[0],r=$$("#TCLNDRPHOTOVIEWER .heroPhotoWrapper.active")[0].getNext();e=r?r:ta.id("TCLNDRPHOTOVIEWER").getFirst(".heroPhotoWrapper"),t.removeClass("active"),e.addClass("active")},tcInit:function(){ta.store("tc.activeposn",1),ta.store("tc.numwinners",$$("#WINNERVIEWER .tcInner").length);try{var e=ta.id("TC_PREV_COUNT"),t=ta.id("TC_NEXT_COUNT");e&&ta.store("tc.ab",e.innerHTML),t&&ta.store("tc.cd",t.innerHTML)}catch(e){ta.util.error.record(e,"Error initializing paging counts - TravelersChoice.tcInit")}ta.servlet.TravelersChoice.onLoadShowWinner(window.location.toString())},tcShiftLeft:function(e,t){try{ta.trackEventOnPage("TCListPhotoViewer","PreviousArrowClick",t,++ta.servlet.TravelersChoice.arrowcounter,!1);var r,a=$$("#WINNERVIEWER .tcInner.tcActive")[0],i=$$("#WINNERVIEWER .tcInner.tcActive")[0].getPrevious(".tcInner");r=i?i:ta.id("WINNERVIEWER").getLast(".tcInner"),a.removeClass("tcActive"),r.addClass("tcActive"),ta.store("tc.activeposn",parseInt(r.getElement(".posn_inner").get("text"))),ta.servlet.TravelersChoice.updatePrevNextCounts()}catch(e){ta.util.error.record(e,"Error showing previous winner - TravelersChoice.tcShiftLeft")}},tcShiftRight:function(e,t){try{ta.trackEventOnPage("TCListPhotoViewer","NextArrowClick",t,++ta.servlet.TravelersChoice.arrowcounter,!1);var r,a=$$("#WINNERVIEWER .tcInner.tcActive")[0],i=$$("#WINNERVIEWER .tcInner.tcActive")[0].getNext(".tcInner");r=i?i:ta.id("WINNERVIEWER").getFirst(".tcInner"),a.removeClass("tcActive"),r.addClass("tcActive"),ta.store("tc.activeposn",parseInt(r.getElement(".posn_inner").get("text"))),ta.servlet.TravelersChoice.updatePrevNextCounts()}catch(e){ta.util.error.record(e,"Error showing next winner - TravelersChoice.tcShiftRight")}},showFullList:function(e){ta.id("TC_SHIFT_LEFT").hide(),ta.id("TC_PREV_COUNT").hide(),ta.id("TC_SHIFT_RIGHT").hide(),ta.id("TC_NEXT_COUNT").hide(),ta.id("WINNERVIEWER").toggleClass("expanded",!0),ta.id("WINNERVIEWER").getElements(".inline-ad").each(function(e){e.removeClass("hidden")}),ta.id("WINNERVIEWER").getElements(".tcInner").each(function(e){e.hasClass("withMeta")&&e.removeClass("withMeta"),e.addClass("tcActive")}),ta.id("TCLISTRD").getElements(".tcMetaLayer").each(function(e){e.hide()}),ta.id("SHOWLIST").hide(),ta.id("TOPCONTENT").getElements(".hidelist").each(function(e){e.show()}),ta.id("TCLISTRD").getElements(".hidelist").each(function(e){e.show()})},collapseList:function(e){var t="-a_Mode.expanded",r="#1";window.location.pathname.contains(t)?window.location=window.location.pathname.replace(t,"")+r:(window.location=window.location.pathname+r,window.location.reload(!0))},onLoadShowWinner:function(e){var t=!0,r="",a=0;try{if(e&&""!=e){var i=e.indexOf("expanded"),n=e.indexOf("#");i>-1?t=!0:n>-1&&(r=e.substr(n+1),a=Number.from(r))}}catch(t){ta.util.error.record(t,"Error parsing tcurl ("+e+") - TravelersChoice.onLoadShowWinner")}try{t&&"#1"!==window.location.hash?(ta.servlet.TravelersChoice.showFullList(),ta.id("WINNERVIEWER").toggleClass("expanded",!0)):a>0&&null!=ta.id("TC_INNER"+a)?(ta.id("WINNERVIEWER").getElements(".inline-ad")en")}),ta.id("TC_INNER"+a).addClass("tcActive"),ta.store("tc.activeposn",a),ta.id("SHOWLIST").show(),ta.id("WINNERVIEWER").toggleClass("expanded",!1),ta.servlet.TravelersChoice.updatePrevNextCounts()):(ta.id("TC_INNER1").addClass("tcActive"),ta.store("tc.activeposn",1),ta.id("SHOWLIST").show(),ta.id("WINNERVIEWER").toggleClass("expanded",!1),ta.servlet.TravelersChoice.updatePrevNextCounts())}catch(r){ta.util.error.record(r,"Error showing winner(s) (tcurl="+e+", bExpand="+t+", nHash="+a+") - TravelersChoice.onLoadShowWinner")}},updatePrevNextCounts:function(){var e,t,r=parseInt(ta.retrieve("tc.activeposn")),a=parseInt(ta.retrieve("tc.numwinners"));1==r?(e=a,t=r+1):r==a?(e=a-1,t=1):(e=r-1,t=r+1);try{var i=ta.retrieve("tc.ab"),n=ta.id("TC_PREV_COUNT");n&&i?(n.setStyle("display","block"),n.innerHTML=i.replace("@A@",e).replace("@B@",a)):ta.util.error.record(null,"prevElmt or prevCount undefined - TravelersChoice.updatePrevNextCounts")}catch(e){ta.util.error.record(e,"Error updating prev counts - TravelersChoice.updatePrevNextCounts")}try{var o=ta.retrieve("tc.cd"),c=ta.id("TC_NEXT_COUNT");c&&o?(c.setStyle("display","block"),c.innerHTML=o.replace("@C@",t).replace("@D@",a)):ta.util.error.record(null,"nextElmt or nextCount undefined - TravelersChoice.updatePrevNextCounts")}catch(e){ta.util.error.record(e,"Error updating next counts - TravelersChoice.updatePrevNextCounts")}},updateFormActionDates:function(){ta.id("WINNERVIEWER").getElements(".tcHacForm").each(function(e){if(e&&e.action){var t=e.action.replace(/&.*$/,""),r=ta.widgets.calendar.getCheckRatesData();r&&(t=t+"&"+Object.toQueryString(r)),e.action=t}})}},ta.queueForLoad(function(){ta.id("TCLNDRPHOTOVIEWER")&&setInterval("ta.servlet.TravelersChoice.rotate_photos()",5e3)}),ta.queueForLoad(function(){ta.id("WINNERVIEWER")&&(ta.servlet.TravelersChoice.tcInit(),ta.servlet.TravelersChoice.updateFormActionDates())});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["photoviewer/loader","ta/photos/oysterTracking","pages/inappropriate_vote_stub"],["ta","page-model","page-model","page-model","ta","ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/media_albums","files":{"js3":{"build":{"es6":{"src":{"photoviewer":{"loader":1}}}},"src":{"pages":{"inappropriate_vote_stub":1},"ta":{"photos":{"oysterTracking":1}}}}},"_":{"baseUrl":"/"}});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["mixins/Events","utils/browserutils","api-mod","utils/MouseAway","utils/resourceLoader","overlays/Overlay","overlays/utils","overlays/ajaxUtil","overlays/options/closeOnDocClick","overlays/options/delayedCloseOnDocClick","overlays/options/closeOnChildClick","overlays/options/closeOnSourceClick","overlays/options/closeOnWindowshadeClick","overlays/options/closeOnMouseOut","overlays/options/closeOnMouseAway","overlays/options/closeOnScroll","overlays/options/closeOnEscape","overlays/options/closeOnEvent","overlays/options/closeOnTaEvent","overlays/options/closeOnTargetEvent","overlays/options/closeOnLegacyOverlay","overlays/options/fireEventOnWindowshadeClick","overlays/options/hoverDelay","overlays/options/storeOverlayOnElement","overlays/options/fadeInOut","overlays/options/highlightElement","overlays/options/repositionOnEvent","overlays/options/repositionOnTaEvent","overlays/options/autoReposition","overlays/options/autosizePage","overlays/options/keepInDom","overlays/options/matchWidth","overlays/options/maxWidth","overlays/options/minWidth","overlays/options/ajax","overlays/options/centerArrowOnSrcElement","overlays/options/closeOnTargetChildClick","overlays/options/stickyClick","overlays/position","overlays/styles/modal","overlays/styles/popover","overlays/styles/tooltip","overlays/styles/windowshade","overlays/styles/dropdown","overlays/styles/notification","overlays/uiOverlay"],["ta","ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/uiOverlays","files":{"js-amd":{"src":{"mixins":{"Events":1},"utils":{"browserutils":1,"resourceLoader":1,"MouseAway":1},"api-mod":1,"overlays":{"ajaxUtil":1,"uiOverlay":1,"utils":1,"options":{"closeOnTargetChildClick":1,"keepInDom":1,"autoReposition":1,"closeOnTaEvent":1,"ajax":1,"closeOnDocClick":1,"closeOnMouseOut":1,"closeOnSourceClick":1,"centerArrowOnSrcElement":1,"fadeInOut":1,"highlightElement":1,"storeOverlayOnElement":1,"autosizePage":1,"closeOnScroll":1,"stickyClick":1,"maxWidth":1,"closeOnWindowshadeClick":1,"closeOnEscape":1,"closeOnMouseAway":1,"minWidth":1,"closeOnLegacyOverlay":1,"closeOnChildClick":1,"closeOnTargetEvent":1,"matchWidth":1,"repositionOnEvent":1,"fireEventOnWindowshadeClick":1,"closeOnEvent":1,"repositionOnTaEvent":1,"delayedCloseOnDocClick":1,"hoverDelay":1},"styles":{"notification":1,"popover":1,"tooltip":1,"windowshade":1,"dropdown":1,"modal":1},"position":1}}},"js3":{"build":{"es6":{"src":{"overlays":{"Overlay":1}}}}}},"_":{"baseUrl":"/"}});
define("utils/MouseAway",["vanillajs","api-mod","ta","mixins/mixin","mixins/Events","utils/throttle"],function(t,o,e,r,n,i){"use strict";function l(t,o){var e=t.right<=o.left,r=t.left>=o.right,n=t.top>=o.bottom,i=t.bottom<=o.top;if(e||r){var l=e?"left":"right",u=e?"right":"left";return[[t[l],t.top],[o[l],o.top],[o[u],o.top],[o[u],o.bottom],[o[l],o.bottom],[t[l],t.bottom]]}if(n||i){var a=n?"bottom":"top",f=n?"top":"bottom";return[[t.right,t[a]],[o.right,o[a]],[o.right,o[f]],[o.left,o[f]],[o.left,o[a]],[t.left,t[a]]]}return null}function u(t,o){if(!o)return!1;for(var e=t[0],r=t[1],n=!1,i=0,l=o.length-1;i<o.length;l=i++){var u=o[i][0],a=o[i][1],f=o[l][0],s=o[l][1],m=a>r!=s>r&&e<(f-u)*(r-a)/(s-a)+u;m&&(n=!n)}return n}function a(t,e,r){var n=r.relatedTarget||r.target;if(!t||!e)return!1;if(o.containsElement(t,n)||o.containsElement(e,n))return!0;var i=l(o.getCoords(t),o.getCoords(e)),a=u([r.clientX+o.scrollLeft(),r.clientY+o.scrollTop()],i);return a}function f(t,e){r(this,new n("mouseAway")),o.addEvent(window,"mousemove",i(function(o){var r=a(t,e,o);r||this.emit("mouseAway")}).bind(this),300)}return f});
define("overlays/options/delayedCloseOnDocClick",["api-mod"],function(t){"use strict";function e(e){if(!(this.sourceElement&&t.containsElement(this.sourceElement,e.target)||t.containsElement(this.container,e.target)||e.target&&("option"===e.target.tagName||t.hasClass(e.target,"ui_dropdown")||t.getParent(e.target,"ui_dropdown"))||t.checkBrowser("ie")&&e.target&&"select"==e.target.tagName&&t.containsEvent(e.target,e)&&t.select(this.container,"input").indexOf(e.target)))if(i&&i>0){var n=this;setTick")},i)}else this.hide("doc-click")}function n(n){return function(o){return function(){var c=t.bind(e,this);i=o,this.on("show",function(){setTimeout(function(){this.isOpen()&&(t.addEvent(document,"click",c),n&&t.addEvent(document,"touchstart",c))}.bind(this),1)}).on("hide",function(){t.removeEvent(document,"click",c),n&&t.removeEvent(document,"touchstart",c)})}}}var i=0,o=n(!0);return o.withoutTouchEvents=n(!1),o});
define("overlays/options/closeOnChildClick",["vanillajs","api-mod"],function(t,n){"use strict";function i(t){n.containsElement(this.container,t.target)&&this.hide("child-click")}function e(t){return function(){var e=n.bind(i,this);this.on("show",function(){n.addEvent(this.domParent,"click",e),t&&n.addEvent(this.domParent,"touchstart",e)}).on("hide",function(){n.removeEvent(this.domParent,"click",e),t&&n.removeEvent(this.domParent,"touchstart",e)})}}var o=e(!0);return o.withoutTouchEvents=e(!1),o});
define("overlays/options/closeOnMouseOut",["vanillajs","api-mod"],function(e,t){"use strict";function n(e){t.containsElement(this.sourceElement,e.relatedTarget)||t.containsElement(this.container,e.relatedTarget)||this.hide()}var o=function(){var e=t.bind(n,this);this.on("show",function(){t.addEvent(this.sourceElement,"mouseout",e),t.addEvent(this.container,"mouseout",e)}).on("hide",function(){t.removeEvent(this.sourceElement,"mouseout",e),t.removeEvent(this.container,"mouseout",e)})};return o});
define("overlays/options/closeOnMouseAway",["vanillajs","utils/MouseAway"],function(n,e){"use strict";var o=function(n){return function(){var o,t=new e(this.sourceElement,this.container),i=this.hide,u=i;i,n)}),this.on("",u)}).on("t(o)})}},t=o(null);return t.witho(n)},t});
define("overlays/options/closeOnScroll",["vanillajs","api-mod"],function(n,o){"use strict";var i=function(){var n=tde()};this.on("show",function(){o.addEvent(window,"scroll",i)}).on("",i)})};return i});
define("overlays/options/closeOnEvent",["vanillajs","api-mod"],function(n,t){"use strict";function i(){this.hide("on-event")}return function(n){return function(){var e=t.bind(i,this);this.on("show",function(){t.addEvent(this.domParent,n,e)}).on("hide",function(){t.removeEvent(this.domParent,n,e)})}}});
define("overlays/options/closeOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(n,t){"use strict";function o(){this.hide("on-event")}return function(n){return function(){var i=o.bind(this);this.on("show",function(){t.on(n,i)}).on("n,i)})}}});
define("overlays/options/closeOnTargetEvent",["vanillajs","api-mod"],function(n,t){"use stnt")}return function(n,o){return function(){var e=o.splice?o:[o],c=i.bind(this);this.on("show",function(){e.forEach(function(i){t.addEvent(n,i,c)})}).on("c)})})}}});
define("overlays/options/fireEventOnWindowshadeClick",["vanillajs","api-mod"],function(n,i){"use strict";var e=function(n){return function(){i.addEvent(this.shade,"c,{})})}};return e});
define("overlays/options/hoverDelay",["vanillajs","api-mod"],function(e,t){"use strict";var i=function(e,i){return function(){var n=tw,e)},this),o=tmer)},this);t.addEvent(this.sourceElement,"mouseover",n),t.addEvent(this.sourceElement,"mouseout",o),i&&n()}};return i});
define("overlays/options/fadeInOut",["api-mod","utils/bindAll"],function(i,t){"use strict";var n={"fade_none":0,"fade_short":250,"fade_normal":500,"fade_long":1e3},e="fade_in";return function(s,o){return function(){if(s&&s in n){i.addClass(this.container,s);var a=n[s],d=i.bind(this.show,this),h=i.bind(this.hide,this),u=null;this.show=function(){d&&d(),setTir,e)}.bind(this),0),clearTimeout(u),o&&(u=setTimeout(i.bind(this.hide,this),a+o))},this.hide=function(){i.removeClass(this.container,e),clearTimeout(u),u=setTi&h()},a)},t(this,"show","hide")}}}});
define("overlays/options/highlightElement",["api-mod"],function(i){"use strict";var n=function(n){function t(n){this.on("show",function(){i.addClass(n,"highlight")}).on("ht")})}return arguments.ls,n)}:void t.call(this,this.sourceElement)};return n});
define("overlays/options/repositionOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(n,i){"use strict";return function(n){return function(){var t=this.emit.bind(this,"positionDirty");this.on("show",function(){i.on(n,t)}).on("hide",function(){i.off(n,t)})}}});
define("overlays/options/autosizePage",["lib/jquery-amd","api-mod"],function(o,t){"use strict";return function(i,n){return function(){function n(){var n=t.getCoords(this.container),s=t.getSize(window);this._scrollTop||(this._scrollTop=t.scrollTop()),o(document.body).css("overflow","hidden"),n.height+2*i>s.y&&o(this.container).css({top:i,marginTop:0}),window.scrollTo(0,0)}this.domParent=o("<div></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,overflow:"auto"})[0],this.on("apent)}),this.on("show",n),this.on("positionDirty",n),this.on("hide",function(){o(document.body).css("overflow","auto"),o(this.domParent).remove(),window.scrollTo(0,this._scrollTop),delete this._scrollTop})}}});
define("overlays/options/keepInDom",["vanillajs","api-mod"],function(n,i){var t="";return function(){this.isOpen=function(){return!!i.inDocument(this.container)&&!i.hasClass(this.container,"hidden")},this.show=function(){return i.inDocument(this.container)?(this.container.style.display=t,i.removeClass(this.container,"hidden")):this.domParent.appendChild(this.container),this.emit("show"),this},this.hide=function(n){return i.inDocument(this.container)&&"none"!=this.container.style.display&&("none"!=this.container.style.display&&(t=this.container.style.display||"",this.container.style.display="none"),i.hasClass(this.container,"hidden")||i.addClass(this.container,"hidden"),this.emit("hide",{trigger:n})),this}}});
define("overlays/options/maxWidth",["vanillajs"],function(i){"use strict";var t=function(i){function t(){this.container.style.maxWidth=i+"px",this.emit("positionDirty")}return function(){this.on("show",t.bind(this))}};return t});
define("overlays/options/minWidth",["vanillajs"],function(i){"use strict";var n=function(i){function n(){this.container.style.minWidth=i+"px",this.emit("positionDirty")}ris))}};return n});
define("overlays/options/centerArrowOnSrcElement",["vanillajs","api-mod"],function(t,i){"use strict";var o=function(t){function o(){if(t=t||this.sourceElement,this.container&&t&&this.arrow){var o=i.getCoords(this.container),r=i.getCoords(t),n=i.hasClass(this.container,"arrow_top")||i.hasClass(this.container,"arrow_bottom");if(n){var s=r.left+r.width/2,e=i.getSize(this.arrow).x/2,a=Math.max(e,Math.min(o.width-e,s-o.left));i.setStyle(this.arrow,{"left":a+"px","right":"auto","margin":"0 0 0 -"+e+"px"})}else{var s=r.top+r.height/2,e=i.getSize(this.arrow).y/2,h=Math.max(e,Math.min(o.height-e,s-o.top));i.setStyle(this.arrow,{"top":h+"px","bottom":"auto","margin":"-"+e+"px 0 0 0"})}}}return function(){this.on("show",i.bind(o,this)),this.on("positionDirty",i.bind(o,this)),this.on("repositionArrow",i.bind(o,this))}};return o});
define("overlays/options/closeOnTargetChildClick",["vanillajs","api-mod"],function(i,n){"use strict";return function(i){return function(){var t,c=nck")},this);this.on("show",function(){t=n.select(i),t&&n.addEvent(t,"click",c)}).on("",c)})}}});
define("overlays/options/stickyClick",["vanillajs","api-mod","utils/MouseAway"],function(i,n,t){"use strict";var o=!1;return function(){var i=new t(this.sourceElement,this.container);n.addEvent(this.sourceElement,"click",function(){o=!0}),this.on("ay")}),this.on("show",function(){var n=this.hide.bind(this);i.on("mouseck")})})}});
define("overlays/styles/notification",["vanillajs","api-mod"],function(n,e){"use strict";function i(n,i){this.container=e.createElement("div",{"class":"ui_overlay ui_notification "+n}),this.icon=e.createElement("span",{"class":"ui_icon main_icon "+i}),this.container.appendChild(this.icon),this.close=e.createElement("span",{"class":"ui_icon times close"}),this.container.appendChild(this.close),this.inner=e.createElement("div",{"class":"message"}),this.container.appendChild(this.inner),this.contentElement=this.inner}function t(n){var i=e.find("."+u);i||(i=document.createElement("div"),i.className=u,document.body.appendChild(i)),n.domParent=i,i.appendChild(n.container),o(n),s(n)}function a(n){r(n),o(n),e.addEvent(n.container,"mousels(n)}),n.emit("hover")}function o(n){e.removeClass(n.container,"hidden"),n.container.clientHeight,e.removeClass(n.container,"transparent")}function c(n){e.addClass(n.container,"transparent"),r(n),n.__hideTimer=setTimeout(e.bind(l,null,n),m)}function s(n){r(n),n.__transitionOutTimer=setTimeout(c.bind(null,n),h)}function r(n){n.__transitionOutTimer&&clearTimeout(n.__transitionOutTimer),n.__hideTimer&&clearTimeout(n.__hideTe(e)}function d(n){n.on("show",e.bind(t,null,n)),e.addEvent(n.container,"click",e.bind(l,null,n,"click")),e.addEvent(n.container,"mouseenter",e.bind(a,null,n))}var u="ui_notification_container",m=2e3,h=1e4,_=function(n,e,t,a){return e=e||n&&n.getAttribute("data-modal")||"",a=a||n&&n.getAttribute("data-icon")||"",function(){i.call(this,e,a),this.updateContent(t),d(this)}};return _});
define("overlays/options/closeOnEmit",["babel/babel-helpers"],function(n){"use strict";return function(n,e,o){return function(){var t=this,i=function(){o&&!o.apply(void 0,arguments)||t.hide("on-event")};this.on("show",function(){return n.on(e,i)}).on("hide",function(){return n.off(e,i)})}}});
define("photoviewer/tracking",["babel/babel-helpers","common/trackingStreams","ta/Core/TA.FireEvent","lib/jquery-amd","utils/responsive","utils/throttle","page-model"],function(i,e,t,o,n,r,c){"use sto,W)}function d(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_(i)&&e.trackEvent(S,i,t,W)}function a(i){e.trackEvent(S,i,"",W)}function _(i){var e=void 0;if(i.includes("grid_view"))e=Q;else{if(!i.includes("detail_view"))return!1;e=M}return o(J).hasClass(e)}function v(){Z=o(window).height(),Y=o(window).width(),o(window).off("resize",$).on("resiz",$)}function w(){n.desktop()&&t.fireEvent("galNavClick"),l(S,D,null)}function k(){l(S,P,null,W)}function s(){l(S,H,nul,W)}function p(i){l(S,iL,W)}function g(){l(S,R,null,W)}function m(){l(S,F,null,W)}function b(){n.desktop()&&l(S,G,nuk")}function y(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;l(S,V,i+"|"+e+"|"+t+"|"+o),1===o&&i!==n&&l(S,x,i+"|"+e+"|"+t+"|"+o)}function A(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";l(S,N,i+"|"+e+"|"+o+"|"+r),n.desktop()&&t.fireEvent("galThumbClick")}function E(i,e,t){var n=o(e).closest(J).hasClass(M),r=o(e).hasClass(K),c=n?"detail":"grid",d=r?"dropdown_open":"dropdown_select";l(S,""+c+U[t],d+"_"+i)}function z(i,e,t,o){l(S,O,i+"|"+e+"|"+t+"|"+o)}var S="photoviewer",D="detail_view_image_arrow_click",P="detail_view_gallery_click",R="detail_view_caption_review_click",F="detail_view_caption_attribution_url_click",G="detail_view_desktop_image_click",H="detail_view_photostrip_arrow_click",I="detail_view_image_swipe_click",V="grid_view_thumbnail_click",x="grid_view_property_video_thumbnail_click",N="detail_view_photostrip_tile_click",O="helpful_vote_click",j="_view_album_click",q="_view_type_click",B="_view_category_click",L="dropdown_abandoned",U={"album":j,"type":q,"category":B},J=".photoviewerContainer",K="tabs_item",M="hero",Q="grid",W=c.LOC_ID,X=1e3,Y=void 0,Z=void 0,$=r(function(){setTimeout(function(){var i=o(window).width(),t=o(window).height();i===Y&&t===Z||(e.trackEvent("screenSizeRecord","resize","s"+Y+"x"+Z+"b"+i+"x"+t,""),Y=i,Z=t)},X)},X);return{attachResizeTracker:v,detachResizeTracker:u,trackPhotoViewerEvent:l,trackPhotoViewerImpression:d,trackSimpleAction:a,recordBackToGalleryClick:k,recordCaptionReviewClick:g,recordCaptionAttributionUrlClick:m,recordPhotoStripArrowClick:s,recordGridDropdownAbandonment:p,recordAlbumDropdownAbandonment:f,recordHeroClickOnDesktop:b,recordNavArrowVisibilityChange:h,recordArrowClick:w,recordPhotoSwipe:C,recordFilmstripThumbClick:T,recordGridTileClick:y,recordHeroThumbClick:A,recordFilterItemClick:E,recordHelpfulClick:z}});
define("utils/HistoryManager",[],function(){"use strict";function t(){function t(){return(new Date).getTime()+""+Math.random()}function i(t){var i=t.state;if(!a&&i&&i.id){var e=i.id,s=n[e];s&&s(i.data)}}var n={},e={},a=!1;this.pushState=function(i,e,a,s){var r=t();n[r]=s,i.id=r,history.pushState(i,e,a)},this.replaceState=function(i,e,a,s){var r=t();n[r]=s,i.id=r,history.replaceState(i,e,a)},this.addCallback=function(t,i){e[t]||(e[t]=[]),e[t].push(i)},this.removeCal,1)}},this.doCallbacks=function(t){e[t]&&e[t].each(function(t){t()})},this.isSupptory},this.disableCallbacks=function(t){a=t},window.addEventListener("popstate",i)}return t});
define("commerce/offerclickEvents",["mixins/Events","vanillajs"],function(e){"use strict";return new e("beforeClick","afterClick")});
define("photoviewer/loader",["babel/babel-helpers","lib/jquery-amd","page-model","overlays/Overlay","overlays/styles/modal","overlays/position/fullscreen","overlays/options/closeOnEmit","overlays/options/ajax","overlays/support/radio","overlays/options/closeOnEscape","common/trackingStreams","common/Radio","ta/Core/TA.FireEvent","ta/Core/TA.Store","photoviewer/tracking","utils/responsive","utils/HistoryManager","utils/urlutils","mixins/page-dates/pop-calendar","commerce/offerclickEvents"],function(e,o,t,n,i,r,a,d,l,s,c,p,u,v,h,f,w,m,g,b){"use strict";function y(e){var n=e,i=f.mobile()?2:f.desktop()?5:3;return n.heroMinWidth=o(window).width()-2*x,n.heroMinHeight=o(window).height()-2*x,n.gridItemMinWidth=n.heroMinWidth/i,n.updateType=n.updateType||"partial",n.placementRollUps="responsive-photo-viewer",n.albumid=e.albumid||e.albumId,n.puid=t.session.uid,n.geo=n.geo||t.GEO_ID,n.detail=n.detail||t.LOC_ID,n.geo&&n.detail?(e.albumViewMode||(n.albumid=n.albumid||P,n.filter=n.filter||T,e.ff||e.imageId?(n.albumViewMode="hero",n.ff=e.ff||e.imageId):e.panoId?n.albumViewMode="hero":n.albumViewMode="grid"),n.area="QC_Meta_Mini|Photo_Lightbox",window.pageServlet&&(n.metaReferer=window.pageServlet),n):(c.error(null,"photoviewer/loader.js:load missing required arguments":""}function C(){if(A.contentElement){var e=A.contentElement.querySelector(".photoviewerContainer");e&&e.parentNode&&(A.contentElement=e.parentNode),A.contentElement.id||(A.contentElement.id="photo_viewer_default_id");var o=k();o&&o.clear(),p("responsive-photoviewer").trigger("content-loaded",A.contentElement.id)}}function k(){if(A){var e=A.contentElement.id;if(e)return p(e)}return null}function M(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f="no_padding";if(e.currentHeroId=e.ff,A){var w=void 0,m=k();m&&(w=m.request("currentHeroId")),w&&(e.currentHeroId=w),A.updateContent(E(e),!0)}else A=new n(document.body,i(null,"",f),r(),s,a(b,"beforeClick",function(e){return e.isBooking}),d(E(e),{resources:[],noCache:!0,skipInvalidate:!0}),l.hide("responsive-photoviewer","close")),_(t,e),A.on("contentLoaded",C),A.on("contentsUnchanged",function(){p("responsive-photoviewer").trigger("contents-unchanged")}),A.on("data-targetEvent",u.fireEvent),A.on("hide",function(){p("responsive-photoviewer").trigger("overlay-hide"),h.trackSimpleAction("photoviewer_close_click"),h.detachResizeTracker(),j&&v.remove("suppressCalendarPop");var e=o("[data-datetype='CHECKIN']").get(0);g.shouldPop(e)&&g.popCalendar(e)}),A.on("wn")});c||t||O(e),A.show()}function O(e){var t=e.aggregationId,n=e.albumid,i=e.ff,r=e.filter,a=e.panoId,d={aggregationId:t,albumid:n,filter:r};i&&(d.ff=i),a&&(d.panoId=a);var l=H+o.param(d);p("responsive-photoviewer").trigger("addHistory",{data:d},document.ti,!0)})}function _(e,o){var t=new w;if(t.isSupported()){if(e){var n=window.location.href;window.setTimeout(function(){if(n===window.location.href){var e=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search;window.history.replaceState(null,"",e),O(o)}},0)}p("responsive-photoviewer").on("addHistory",t.pushState);var i=!1;A.on("hide",function(){window.location.hash.indexOf(S)>=0&&(i=!0,t.disableCallbacks(!0),history.back())}),window.addEventListener("popstate",function(){window.location.hash.indexOf(S)>=0?i?history.back():A.show():(i=!1,t.disableCallbacks(!1),A.hide())})}}var x=20,S="#photos",H=S+";",T=7,P=101,A=void 0,j=!1;return o(function(){if(!v.retrieve("mediaviewer")){var e=window.location.hash;if(e.indexOf(S)>=0){v.retrieve("suppressCalendarPop")||(j=!0,v.store("suppressCalendarPop","true"));var o=void 0,t=e.indexOf(H)>=0&&e.substring(e.indexOf(H)+H.length,e.length);o=t&&t.length>0?m.getUrlQueryArgs("?"+t):y({}),o.updateType="full",M(o,!0)}}}),p("responsive-photoviewer").on("load",M),{load:M,buildUrl:E,getOverlayId:I}});
define("ta/photos/oysterTracking",["vanillajs"],functis(t)}var a=["LB_OPEN","FEATURED_REEL","EOAR_SINGLE","EOAR_HERO","PHOTO_CONTENT_BLOCK","FEATURED_REEL_LR","HERO","ALBUM"];return{trackCandidateSession:function(t,a,E){n(E)&&ta.trackEventOnPage("Oyster","CANDIDATE_SESSION",E)},trackImpression:function(t,a,E){n(E)&&ta.trackEventOnPage("Oyster","IMPRESSION",E)},trackInterest:function(t,a,E){n(E)&&ta.trackEventOnPage("Oyster","INTEREST",E)},trackAction:function(t,a,E){n(E)&&ta.trackEventOnPage("Oyster","ACTION",E)}}});
