ips.templates.set('core.general.loading',"  &nbsp;<span class='ipsType_light'><i class='icon-spinner2 ipsLoading_tinyIcon'></i>&nbsp;&nbsp;&nbsp;</span> {{text}}</span>");ips.templates.set('core.general.ajax',"  <div id='elAjaxLoading'><i class='ipsLoading ipsLoading_tiny ipsLoading_dark ipsMargin_right:half'></i> &nbsp;&nbsp;{{#lang}}loading{{/lang}}...</div>");ips.templates.set('core.general.flashMsg',"  <div id='elFlashMessage'><div class='ipsFlex ipsFlex-ai:center ipsGap:3 ipsGap_row:0'><div data-role='flashMessage' class='ipsFlex-flex:11'></div><div class='ipsFlex-flex:00'><a href='#' data-action='dismissFlashMessage'>&times;</a></div></div></div>");ips.templates.set('core.hovercard.loading',"  <i class='icon-spinner2 ipsLoading_tinyIcon'></i>");ips.templates.set('core.posts.spoiler',"  <span class='ipsStyle_spoilerFancy_text'><span class='ipsButton ipsButton_verySmall ipsButton_primary ipsButton_narrow'><i class='fa fa-chevron-right'></i></span> {{#lang}}spoilerClickToReveal{{/lang}}</span>");ips.templates.set('core.posts.spoilerOpen',"  <span class='ipsStyle_spoilerFancy_text'><span class='ipsButton ipsButton_verySmall ipsButton_primary ipsButton_narrow'><i class='fa fa-chevron-down'></i></span> {{#lang}}spoilerClickToHide{{/lang}}</span>");ips.templates.set('core.posts.multiQuoteOff',"  <i class='fa fa-plus'></i>");ips.templates.set('core.posts.multiQuoteOn',"  <i class='fa fa-check'></i>");ips.templates.set('core.posts.multiQuoter',"  <div id='ipsMultiQuoter' data-commentsContainer='{{commentFeedId}}'>  <button class='ipsButton ipsButton_veryLight ipsButton_small' data-role='multiQuote_{{commentFeedId}}'><i class='fa fa-comments'></i> &nbsp;&nbsp;{{{count}}}</button> &nbsp;&nbsp;<a href='#' data-action='clearQuoted_{{commentFeedId}}'><i class='fa fa-times'></i></a> </div>");ips.templates.set('core.menus.menuItem',"  <li class='ipsMenu_item {{#checked}}ipsMenu_itemChecked{{/checked}}' data-ipsMenuValue='{{value}}'>  <a href='{{link}}'>{{title}}</a> </li>");ips.templates.set('core.menus.menuSep',"  <li class='ipsMenu_sep'><hr></li>");ips.templates.set('core.posts.quotedSpoiler',"  <p><em>{{#lang}}quotedSpoiler{{/lang}}</em></p>");ips.templates.set('core.postNotify.single',"  <span data-role='newPostNotification' class='ipsType_medium'>  <img src='{{photo}}' alt='' class='ipsUserPhoto ipsUserPhoto_tiny ipsPos_middle'> &nbsp;&nbsp;&nbsp;{{{text}}}  &nbsp;&nbsp;&nbsp;<a href='#' data-action='loadNewPosts'>{{#lang}}showReply{{/lang}}</a> </span>");ips.templates.set('core.postNotify.multiple',"  <span data-role='newPostNotification' class='ipsType_medium'>  {{text}}  &nbsp;&nbsp;&nbsp;<a href='#' data-action='loadNewPosts'>{{#lang}}showReplies{{/lang}}</a> </span>");ips.templates.set('core.postNotify.multipleSpillOver',"  <span data-role='newPostNotification' class='ipsType_medium'>  {{text}}  {{#canLoadNew}}   &nbsp;&nbsp;&nbsp;<a href='#' data-action='loadNewPosts'>{{showFirstX}}</a>   &nbsp;&nbsp;&nbsp;<span class='ipsType_light'>{{#lang}}showRepliesOr{{/lang}}</span>  {{/canLoadNew}}  &nbsp;&nbsp;&nbsp;<a href='{{spillOverUrl}}'>{{#lang}}goToNewestPage{{/lang}}</a> </span>");ips.templates.set('core.notification.flashSingle',"  <a href='{{url}}' data-role='newNotification'>  <div class='ipsFlex ipsFlex-ai:center ipsGap:3 ipsGap_row:0 ipsType_medium ipsType_blendLinks'>   {{#icon}}<div class='ipsFlex-flex:00'><img src='{{icon}}' alt='' class='ipsUserPhoto ipsUserPhoto_tiny'></div>{{/icon}}   <div class='ipsFlex-flex:11 ipsType_left'>    {{text}}    <p class='ipsType_reset ipsType_light ipsTruncate ipsTruncate_line'>{{{body}}}</p>   </div>  </div> </a>");ips.templates.set('core.notification.flashMultiple',"  <div class='ipsFlex ipsFlex-ai:center ipsGap:3 ipsGap_row:0 ipsType_medium ipsType_blendLinks' data-role='newNotification'>  <span class='ipsFlex-flex:00 ipsType_veryLarge'><i class='fa fa-bell'></i></span>  <div class='ipsFlex-flex:11 ipsType_left'>   {{text}}   <p class='ipsType_reset ipsType_light ipsTruncate ipsTruncate_line'>{{{body}}}</p>  </div> </div>");ips.templates.set('core.alert.box'," <div class='ipsAlert' style='display: none' role='alertdialog' aria-describedby='{{id}}_message'> {{{icon}}} <div class='ipsAlert_msg ipsType_break' id='{{id}}_message'>  <strong>{{{text}}}</strong>  {{{subtext}}} </div> <ul class='ipsToolList ipsToolList_horizontal ipsPos_center ipsAlert_buttonRow ipsClear ipsClearfix'>  {{{buttons}}} </ul></div>");ips.templates.set('core.alert.subText'," <div class='ipsType_light ipsType_normal'>{{text}}</div>");ips.templates.set('core.alert.subTextHtml'," <div class='ipsType_light ipsType_normal'>{{{text}}}</div>");ips.templates.set('core.alert.icon'," <i class='{{icon}} ipsAlert_icon'></i>");ips.templates.set('core.alert.button'," <li><button data-action='{{action}}' class='ipsButton ipsButton_fullWidth {{extra}}' role='button'>{{title}}</button></li>");ips.templates.set('core.alert.prompt'," <br><br><input type='text' value='{{value}}' class='ipsField_fullWidth' data-role='promptValue'><br><br>");ips.templates.set('core.lightbox.meta',"{{title}}");ips.templates.set('core.lightbox.toolsMenu'," <a href='{{url}}&amp;direction=right' class='ipsButton ipsButton_link ipsButton_small' title='Rotate Right' data-ipsTooltip data-action='rotateImage'>    <i class='fa fa-fw fa-rotate-right'></i></a><a href='{{url}}&amp;direction=left' class='ipsButton ipsButton_link ipsButton_small' title='Rotate Left' data-ipsTooltip data-action='rotateImage'>    <i class='fa fa-fw fa-rotate-left'></i></a>");ips.templates.set('core.dialog.main'," <div class='{{class}} {{#fixed}}{{class}}_fixed{{/fixed}} {{#size}}{{class}}_{{size}}{{/size}} {{extraClass}}' style='display: none' id='{{id}}' role='dialog' aria-label='{{title}}'> <div>  {{#title}}   <h3 class='{{class}}_title'>{{title}}</h3>   <hr class='ipsHr'>  {{/title}}  {{#close}}   <a href='#' class='{{class}}_close' data-action='dialogClose'>&times;</a>  {{/close}}  <div class='{{class}}_content'>   {{content}}  </div>  <div class='{{class}}_loading {{class}}_large ipsLoading ipsLoading_noAnim' style='display: none'></div> </div></div>")
ips.templates.set('core.tooltip',"  <div id='{{id}}' class='ipsTooltip' role='tooltip'>{{content}}</div>");ips.templates.set('core.search.loadingPanel',"  <div id='{{id}}' class='ipsLoading' style='min-height: 100px'>  &nbsp; </div>");ips.templates.set('core.editor.panelWrapper',"  <div id='{{id}}' class='ipsRTE_panel ipsPad'>  {{content}} </div>");ips.templates.set('core.editor.giphy'," <div class='ipsMenu ipsMenu_wide' id='{{id}}_menu' style='display: none' data-editorID='{{editor}}' data-controller='core.global.editor.giphy'> <div class='ipsMenu_headerBar'>  <div class='ipsGiphy_attribution'><img src='{{attribution_image}}'></div>  <h4 class='ipsType_sectionHead'>   {{#lang}}giphy{{/lang}}  </h4> </div> <div class='ipsMenu_innerContent ipsGiphy_content' data-role='giphyResults'>  <div data-role='giphyLoading'>     </div>  <div class='ipsGiphy_moar' data-role='giphyMore' data-offset='0'>   <div data-role='giphyMoreLoading' class='ipsType_light ipsHide ipsSpacer_bottom'>{{#lang}}giphyMore_loading{{/lang}}</div>  </div> </div> <div class='ipsMenu_footerBar'>  <input type='text' data-role='giphySearch' class='ipsField_fullWidth' placeholder='{{#lang}}giphyFind{{/lang}}'> </div></div>");ips.templates.set('core.editor.giphyThumb',"  <div class='ipsGiphy_thumb'><img src=\"{{thumb}}\" class=\"ipsGiphyImage\" data-url=\"{{url}}\" alt='{{title}}' title='{{title}}'></div>");ips.templates.set('core.editor.giphyRow',"  <div class='ipsGiphy_row'>{{{gifs}}}</div>");ips.templates.set('core.editor.pixabayThumb',"  <div class='ipsPixabay_thumb'><img src=\"{{thumb}}\" class=\"ipsPixabayImage\" data-url=\"{{url}}\" data-id=\"{{imgid}}\"></div>");ips.templates.set('core.editor.pixabayRow',"  <div class='ipsPixabay_row'>{{{images}}}</div>");ips.templates.set('core.editor.emoticons'," <div class='ipsMenu ipsMenu_wide' id='{{id}}_menu' style='display: none' data-editorID='{{editor}}' data-controller='core.global.editor.emoticons'> <div class='ipsMenu_headerBar'>  <p class='ipsType_reset ipsPos_right'>   <a href='#' class='ipsType_blendLinks ipsHide' data-role='skinToneMenu' data-ipsMenu data-ipsMenu-appendTo='#{{id}}_menu' id='{{id}}_tones'>{{#lang}}emoji_skin_tone{{/lang}} <i class='fa fa-caret-down'></i></a>   &nbsp;&nbsp;&nbsp;   <a href='#' class='ipsType_blendLinks ipsHide' data-role='categoryTrigger' data-ipsMenu data-ipsMenu-appendTo='#{{id}}_menu' id='{{id}}_more'>{{#lang}}emoticonCategories{{/lang}} <i class='fa fa-caret-down'></i></a>  </p>  <h4 class='ipsType_sectionHead'>{{#lang}}emoji{{/lang}}</h4>  <ul class='ipsMenu ipsMenu_veryNarrow ipsCursor_pointer' id='{{id}}_tones_menu' role='menu' style='display: none'>   <li class='ipsMenu_title'>{{#lang}}emoji_skin_tone{{/lang}}</li>   <li class='ipsMenu_item' role='menuitem' data-ipsMenuValue='none'><a>{{#lang}}emoji_skin_tone_default{{/lang}}</a></li>   <li class='ipsMenu_sep'><hr></li>   <li class='ipsMenu_item' role='menuitem' data-ipsMenuValue='light'><a>\uD83C\uDFFB {{#lang}}emoji_skin_tone_light{{/lang}}</a></li>   <li class='ipsMenu_item' role='menuitem' data-ipsMenuValue='medium-light'><a>\uD83C\uDFFC {{#lang}}emoji_skin_tone_medium_light{{/lang}}</a></li>   <li class='ipsMenu_item' role='menuitem' data-ipsMenuValue='medium'><a>\uD83C\uDFFD {{#lang}}emoji_skin_tone_medium{{/lang}}</a></li>   <li class='ipsMenu_item' role='menuitem' data-ipsMenuValue='medium-dark'><a>\uD83C\uDFFE {{#lang}}emoji_skin_tone_medium_dark{{/lang}}</a></li>   <li class='ipsMenu_item' role='menuitem' data-ipsMenuValue='dark'><a>\uD83C\uDFFF {{#lang}}emoji_skin_tone_dark{{/lang}}</a></li>  </ul>  <ul data-role='categoryMenu' class='ipsMenu ipsMenu_auto ipsCursor_pointer' id='{{id}}_more_menu' role='menu' style='display: none'>  </ul> </div> <div class='ipsMenu_innerContent'>  <div class='ipsEmoticons_content'>   <div class='ipsEmpty ipsType_center ipsEmoticons_contentLoading' data-role='emojiLoading'>    {{#lang}}loading{{/lang}}...   </div>  </div> </div> <div class='ipsMenu_footerBar'>  <input type='text' data-role='emoticonSearch' class='ipsField_fullWidth' placeholder='{{#lang}}emoticonFind{{/lang}}'> </div></div>");ips.templates.set('core.editor.emoticonSection',"  <div data-panel='{{id}}'>{{{content}}}</div>");ips.templates.set('core.editor.emoticonMenu',"  <li class='ipsMenu_item' role='menuitem' data-ipsMenuValue='{{categoryID}}'><a><span class='ipsMenu_itemCount'>{{count}}</span>{{title}}</a></li>");ips.templates.set('core.editor.emoticonCategory',"  <div class='ipsAreaBackground_light ipsPad_half'><strong>{{title}}</strong></div> <div class='ipsEmoticons_category' data-categoryid='{{categoryID}}'>{{{emoticons}}}</div>");ips.templates.set('core.editor.emoticonSearch',"  <div class='ipsEmoticons_category'>{{{emoticons}}}</div>");ips.templates.set('core.editor.emoticonRow',"  <div class='ipsEmoticons_row ipsEmoji'>{{{emoticons}}}</div>");ips.templates.set('core.editor.emoticonItem',"  <div class='ipsEmoticons_item' data-emoticon='{{tag}}' data-src='{{src}}' data-srcset='{{srcset}}' data-height='{{height}}' data-width='{{width}}' title='{{tag}}'>{{{img}}}</div>");ips.templates.set('core.editor.emoji',"  <div class='ipsEmoticons_item' title='{{name}}' data-emoji='{{code}}'>{{{display}}}</div>");ips.templates.set('core.editor.emojiNotNative',"  <div class='ipsEmoticons_item' title='{{name}}' data-emoji='{{code}}'>{{{img}}}</div>");ips.templates.set('core.editor.emoticonBlank',"  <div class='ipsEmoticons_item'>&nbsp;</div>");ips.templates.set('core.editor.emoticonNoResults',"  <div class='ipsPad ipsType_center ipsType_light'>{{#lang}}no_results{{/lang}}</div>");ips.templates.set('core.editor.emojiResult',"  <li class='ipsMenu_item ipsCursor_pointer' title='{{name}}' data-emoji='{{code}}'>  <a><span class='ipsEmoji_result'>{{{emoji}}}</span> <span data-role='shortCode'>{{short_code}}</span></a> </li>");ips.templates.set('core.editor.quote',"<blockquote class='ipsQuote' data-ipsQuote data-gramm='false'><div class='ipsQuote_citation'>{{citation}}</div><div class='ipsQuote_contents ipsClearfix' data-gramm='false'>{{{contents}}}</div></blockquote>");ips.templates.set('core.editor.legacyQuoteUpcast',"<div class='ipsQuote_citation'>{{citation}}</div><div class='ipsQuote_contents ipsClearfix' data-gramm='false'>{{{contents}}}</div>");ips.templates.set('core.editor.citation',"  <div class='ipsQuote_citation ipsQuote_open'>  <a href='#' data-action='toggleQuote' aria-label='{{#lang}}toggle_quote{{/lang}}'>&nbsp;</a>  {{#contenturl}}   <a class='ipsPos_right' href='{{contenturl}}'><i class='fa fa-share'></i></a>  {{/contenturl}}  {{{citation}}} </div>");ips.templates.set('core.editor.citationLink',"  <a href='{{baseURL}}?app=core&module=members&controller=profile&id={{userid}}' data-ipsHover data-ipshover-target='{{baseURL}}?app=core&module=members&controller=profile&id={{userid}}&do=hovercard'>{{username}}</a>");ips.templates.set('core.editor.spoiler',"<div class='ipsSpoiler' data-ipsSpoiler><div class='ipsSpoiler_header'><span>{{#lang}}editorSpoiler{{/lang}}</span></div><div class='ipsSpoiler_contents ipsClearfix'></div></div>");ips.templates.set('core.editor.legacySpoilerUpcast',"<div class='ipsSpoiler_header'><span>{{#lang}}editorSpoiler{{/lang}}</span></div><div class='ipsSpoiler_contents ipsClearfix' data-gramm='false'>{{{contents}}}</div>");ips.templates.set('core.editor.spoilerHeader',"  <div class='ipsSpoiler_header ipsSpoiler_closed'>  <a href='#' data-action='toggleSpoiler'>&nbsp;</a>  <span>{{#lang}}spoilerClickToReveal{{/lang}}</span> </div>");ips.templates.set('core.editor.initLoading',"  <div class='ipsLoading ipsLoading_tiny'>&nbsp;</div>");ips.templates.set('core.editor.previewLoading',"  <div data-role='previewLoading' class='ipsLoading' style='min-height: 100px'>  &nbsp; </div>");ips.templates.set('core.editor.stockReplies'," <div class='ipsMenu ipsMenu_wide' id='{{id}}_menu' style='display: none' data-editorID='{{editor}}' data-controller='core.global.editor.stockReplies'> <div class='ipsMenu_headerBar'>  <h4 class='ipsType_sectionHead'>   {{#lang}}editorStoredReplies{{/lang}}  </h4> </div> <div class='ipsStockReplies_content ipsMenu_innerContent'>  <div data-role='stockRepliesLoading' class='ipsLoading'>     </div> </div></div>");ips.templates.set('core.editor.editorStockRepliesWrap'," <div class='ipsStockReplies_menu'>{{{content}}}</div>");ips.templates.set('core.editor.editorStockRepliesRow'," <div class='ipsStockReplies_row ipsPad_half' data-templatesId='{{{id}}}'>{{{title}}}</div>");ips.templates.set('core.attachments.metaInfo',"  <span class='ipsFlex-inline ipsFlex-ai:center ipsFlex-jc:center'><span>{{size}}</span><span>&nbsp;&middot;&nbsp;</span><span>{{downloads}}</span></span> ");ips.templates.set('core.attachments.attachmentPreview',"  <span class='ipsAttachLink_title'>{{title}}</span><span class='ipsAttachLink_metaInfo'>{{#lang}}attachmentPending{{/lang}}</span> ");ips.templates.set('core.attachments.fileItemWrapper',"  <div class='ipsUploader__container ipsUploader__container--files'>{{{content}}}</div>");ips.templates.set('core.attachments.fileItem',"  <div class='ipsUploader__row ipsUploader__row--file ipsAttach ipsContained {{#done}}ipsAttach_done{{/done}}' id='{{id}}' data-role='file' data-fileid='{{id}}' data-filesize='{{sizeRaw}}' data-filekey='{{securityKey}}'>  <div class='ipsUploader__rowPreview ipsType_center' data-role='preview' {{#insertable}}data-action='insertFile'{{/insertable}}>   {{#thumb}}    {{{thumb}}}   {{/thumb}}   <div class='ipsUploader__rowPreview__generic ipsFlex ipsFlex-ai:center ipsFlex-jc:center' {{#thumb}}style='display: none'{{/thumb}}>    <i class='fa fa-{{extIcon}} ipsType_large'></i>   </div>  </div>  <div class='ipsUploader_rowMeta ipsFlex ipsFlex-flex:11 ipsFlex-fd:column ipsFlex-jc:center ipsFlex-ai:start' {{#insertable}}data-action='insertFile'{{/insertable}}>   <h2 class='ipsUploader_rowTitle ipsMargin:none ipsType_reset ipsAttach_title ipsTruncate ipsTruncate_line' data-role='title'>{{title}}</h2>   <p class='ipsDataItem_meta ipsType_medium ipsType_light'>    {{size}} {{#statusText}}&middot; <span class='ipsType_light' data-role='status'>{{statusText}}</span>{{/statusText}}   </p>   {{#status}}<span class='ipsAttachment_progress'><span data-role='progressbar'></span></span>{{/status}}   <div data-role='insert' class='ipsUploader__rowInsert' {{#insertable}}style='display: none'{{/insertable}}>    <a href='#' data-ipsTooltip title='{{#lang}}insertIntoPost{{/lang}}'>     {{#lang}}insert{{/lang}}    </a>   </div>  </div>  {{#supportsDelete}}   <div data-role='deleteFileWrapper' {{#newUpload}}style='display: none'{{/newUpload}}>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' data-role='deleteFile' class='ipsUploader__rowDelete' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'>     &times;    </a>   </div>  {{/supportsDelete}}  {{^supportsDelete}}   <div data-role='deleteFileWrapper' style='display: none'>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' class='ipsUploader__rowDelete' data-role='deleteFile' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'>&times;</a>   </div>  {{/supportsDelete}} </div>");ips.templates.set('core.attachments.imageItem',"  <div class='ipsUploader__row ipsUploader__row--image ipsAttach ipsContained {{#done}}ipsAttach_done{{/done}}' id='{{id}}' data-role='file' data-fileid='{{id}}' data-fullsizeurl='{{imagesrc}}' data-thumbnailurl='{{thumbnail}}' data-fileType='image'>  <div class='ipsUploader__rowPreview ipsType_center' data-role='preview' {{#insertable}}data-action='insertFile'{{/insertable}}>   {{#thumb}}    {{{thumb}}}   {{/thumb}}   <div class='ipsUploader__rowPreview__generic ipsFlex ipsFlex-ai:center ipsFlex-jc:center' {{#thumb}}style='display: none'{{/thumb}}>    <i class='fa fa-{{extIcon}} ipsType_large'></i>   </div>  </div>  <div class='ipsUploader_rowMeta ipsFlex ipsFlex-flex:11 ipsFlex-fd:column ipsFlex-jc:center ipsFlex-ai:start' {{#insertable}}data-action='insertFile'{{/insertable}}>   <h2 class='ipsUploader_rowTitle ipsMargin:none ipsType_reset ipsAttach_title ipsTruncate ipsTruncate_line' data-role='title'>{{title}}</h2>   <p class='ipsDataItem_meta ipsType_medium ipsType_light'>    {{size}} {{#statusText}}&middot; <span class='ipsType_light' data-role='status'>{{statusText}}</span>{{/statusText}}   </p>   {{#status}}<span class='ipsAttachment_progress'><span data-role='progressbar'></span></span>{{/status}}   <div data-role='insert' class='ipsUploader__rowInsert' {{#insertable}}style='display: none'{{/insertable}}>    <a href='#' data-ipsTooltip title='{{#lang}}insertIntoPost{{/lang}}'>     {{#lang}}insert{{/lang}}    </a>   </div>  </div>  {{#supportsDelete}}   <div data-role='deleteFileWrapper' {{#newUpload}}style='display: none'{{/newUpload}}>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' data-role='deleteFile' class='ipsUploader__rowDelete' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'>     &times;    </a>   </div>  {{/supportsDelete}}  {{^supportsDelete}}   <div data-role='deleteFileWrapper' style='display: none'>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' class='ipsUploader__rowDelete' data-role='deleteFile' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'>&times;</a>   </div>  {{/supportsDelete}} </div>");ips.templates.set('core.attachments.videoItem',"  <div class='ipsUploader__row ipsUploader__row--image ipsAttach ipsContained {{#done}}ipsAttach_done{{/done}}' id='{{id}}' data-role='file' data-fileid='{{id}}' data-fullsizeurl='{{imagesrc}}' data-thumbnailurl='{{thumbnail}}' data-fileType='video' data-mimeType='{{mime}}'>  <div class='ipsUploader__rowPreview ipsType_center' data-role='preview' {{#insertable}}data-action='insertFile'{{/insertable}}>   {{#thumb}}    <video>     <source src='{{{thumb}}}' type='{{mime}}'>    </video>   {{/thumb}}   <div class='ipsUploader__rowPreview__generic ipsFlex ipsFlex-ai:center ipsFlex-jc:center' {{#thumb}}style='display: none'{{/thumb}}>    <i class='fa fa-{{extIcon}} ipsType_large'></i>   </div>  </div>  <div class='ipsUploader_rowMeta ipsFlex ipsFlex-flex:11 ipsFlex-fd:column ipsFlex-jc:center ipsFlex-ai:start' {{#insertable}}data-action='insertFile'{{/insertable}}>   <h2 class='ipsUploader_rowTitle ipsMargin:none ipsType_reset ipsAttach_title ipsTruncate ipsTruncate_line' data-role='title'>{{title}}</h2>   <p class='ipsDataItem_meta ipsType_medium ipsType_light'>    {{size}} {{#statusText}}&middot; <span class='ipsType_light' data-role='status'>{{statusText}}</span>{{/statusText}}   </p>   {{#status}}<span class='ipsAttachment_progress'><span data-role='progressbar'></span></span>{{/status}}   <div data-role='insert' class='ipsUploader__rowInsert' {{#insertable}}style='display: none'{{/insertable}}>    <a href='#' data-ipsTooltip title='{{#lang}}insertIntoPost{{/lang}}'>     {{#lang}}insert{{/lang}}    </a>   </div>  </div>  {{#supportsDelete}}   <div data-role='deleteFileWrapper' {{#newUpload}}style='display: none'{{/newUpload}}>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' data-role='deleteFile' class='ipsUploader__rowDelete' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'>     &times;    </a>   </div>  {{/supportsDelete}}  {{^supportsDelete}}   <div data-role='deleteFileWrapper' style='display: none'>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' class='ipsUploader__rowDelete' data-role='deleteFile' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'>&times;</a>   </div>  {{/supportsDelete}} </div>");ips.templates.set('core.attachments.audioItem',"  <div class='ipsUploader__row ipsUploader__row--image ipsAttach ipsContained {{#done}}ipsAttach_done{{/done}}' id='{{id}}' data-role='file' data-fileid='{{id}}' data-fullsizeurl='{{imagesrc}}' data-thumbnailurl='{{thumbnail}}' data-fileType='audio' data-mimeType='{{mime}}'>  <div class='ipsUploader__rowPreview ipsType_center' data-role='preview' {{#insertable}}data-action='insertFile'{{/insertable}}>   {{#thumb}}    <audio src='{{{thumb}}}' type='{{mime}}'>    </audio>   {{/thumb}}   <div class='ipsUploader__rowPreview__generic ipsFlex ipsFlex-ai:center ipsFlex-jc:center' {{#thumb}}style='display: none'{{/thumb}}>    <i class='fa fa-{{extIcon}} ipsType_large'></i>   </div>  </div>  <div class='ipsUploader_rowMeta ipsFlex ipsFlex-flex:11 ipsFlex-fd:column ipsFlex-jc:center ipsFlex-ai:start' {{#insertable}}data-action='insertFile'{{/insertable}}>   <h2 class='ipsUploader_rowTitle ipsMargin:none ipsType_reset ipsAttach_title ipsTruncate ipsTruncate_line' data-role='title'>{{title}}</h2>   <p class='ipsDataItem_meta ipsType_medium ipsType_light'>    {{size}} {{#statusText}}&middot; <span class='ipsType_light' data-role='status'>{{statusText}}</span>{{/statusText}}   </p>   {{#status}}<span class='ipsAttachment_progress'><span data-role='progressbar'></span></span>{{/status}}   <div data-role='insert' class='ipsUploader__rowInsert' {{#insertable}}style='display: none'{{/insertable}}>    <a href='#' data-ipsTooltip title='{{#lang}}insertIntoPost{{/lang}}'>     {{#lang}}insert{{/lang}}    </a>   </div>  </div>  {{#supportsDelete}}   <div data-role='deleteFileWrapper' {{#newUpload}}style='display: none'{{/newUpload}}>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' data-role='deleteFile' class='ipsUploader__rowDelete' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'>     &times;    </a>   </div>  {{/supportsDelete}}  {{^supportsDelete}}   <div data-role='deleteFileWrapper' style='display: none'>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' class='ipsUploader__rowDelete' data-role='deleteFile' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'>&times;</a>   </div>  {{/supportsDelete}} </div>");ips.templates.set('core.attachments.imageItemWrapper',"  <div class='ipsGrid ipsGrid_collapsePhone' data-ipsGrid data-ipsGrid-minItemSize='150' data-ipsGrid-maxItemSize='250'>{{{content}}}</div>");ips.templates.set('core.autocomplete.field',"  <div class='ipsField_autocomplete' id='{{id}}_wrapper' role='combobox' aria-autocomplete='list' aria-owns='{{id}}_results'>  <span class='ipsField_autocomplete_loading' style='display: none' id='{{id}}_loading'></span>  <ul class='ipsList_inline' role='listbox'><li id='{{id}}_inputItem' role='option'>{{content}}</li></ul> </div>");ips.templates.set('core.autocomplete.addToken',"  <a href='#' data-action='addToken'><i class='fa fa-plus'></i> {{text}}</a> ");ips.templates.set('core.autocomplete.resultWrapper',"  <div class='ipsAutocompleteMenu' id='{{id}}_results' aria-expanded='false' style='display: none'>  <ul class='ipsAutocompleteMenu_itemWrapper ipsList_reset' role='listbox' aria-expanded='false' data-role='items'></ul> </div>");ips.templates.set('core.autocomplete.searchTypeAhead',"  <div class='ipsPad_half ipsAreaBackground' data-role='autocompleteSearch'>  <div class='ipsClearfix'>   <input type='search' name='autocompleteSearch' placeholder='{{#lang}}autocomplete_search_placeholder{{/lang}}'>  </div> </div>");ips.templates.set('core.autocomplete.resultItem',"  <li class='ipsAutocompleteMenu_item' data-value='{{value}}' role='option'>  <div class='ipsClearfix'>   {{html}}  </div> </li>");ips.templates.set('core.autocomplete.tagsResultItem',"  <li class='ipsAutocompleteMenu_item' data-value='{{value}}' role='option'>  <div class='ipsClearfix'>   {{html}}   {{#recommended}}    <span class='ipsPos_right ipsType_success'>{{#lang}}tag_recommended{{/lang}}   {{/recommended}}  </div> </li>");ips.templates.set('core.autocomplete.token',"  <li class='cToken' data-value='{{value}}' role='option'>  {{{title}}} <span class='cToken_close' data-action='delete'>&times;</span> </li>");ips.templates.set('core.autocomplete.memberItem',"  <li class='ipsAutocompleteMenu_item ipsClearfix' data-value=\"{{value}}\" role='option'>  <div class='ipsPhotoPanel ipsPhotoPanel_tiny'>   <span class='ipsUserPhoto ipsUserPhoto_tiny'><img src='{{{photo}}}' loading='lazy'></span>   <div>    <strong>{{{name}}}</strong><br>    <span class='ipsType_light'>{{{extra}}}</span>   </div>  </div> </li>");ips.templates.set('core.autocomplete.optional',"  <a href='#' data-action='showAutocomplete' class='ipsButton ipsButton_light ipsButton_verySmall'>{{langString}}...</a>");ips.templates.set('core.forms.toggle',"  <span class='ipsToggle {{className}}' id='{{id}}' tabindex='0' role='switch' aria-checked='{{status}}'>  <span data-role='status'></span> </span>");ips.templates.set('core.forms.validationWrapper',"  <ul id='{{id}}' class='ipsList_reset ipsType_small ipsForm_errorList'>{{content}}</ul>");ips.templates.set('core.forms.validationItem',"  <li class='ipsType_warning'>{{message}}</li>");ips.templates.set('core.forms.advicePopup',"<div class='ipsHovercard' data-role='advicePopup' id='elPasswordAdvice_{{id}}'> <div class='ipsPad'>  <h2 class='ipsType_sectionHead'>{{#lang}}password_advice_title{{/lang}}</h2>  <p class='ipsSpacer_top ipsSpacer_half ipsType_reset ipsType_medium'>   {{#min}}    {{min}}    {{/min}}   {{{text}}}  </p> </div> <span class='ipsHovercard_stem'></span></div>");ips.templates.set('core.forms.validateOk',"<span> <i class='fa fa-check-circle ipsType_success'></i></span>");ips.templates.set('core.forms.validateFail',"<span data-ipsTooltip data-ipsTooltip-label='{{message}}'> <i class='fa fa-times-circle ipsType_warning'></i></span>");ips.templates.set('core.forms.validateFailText',"<p class='ipsType_reset ipsSpacer_top ipsSpacer_half ipsType_warning'> <i class='fa fa-times-circle'></i> {{message}}</p>");ips.templates.set('core.truncate.expand',"  <a class='ipsTruncate_more' data-action='expandTruncate'><span>{{text}} &nbsp;<i class='fa fa-caret-down'></i></span></a>");ips.templates.set('core.selectTree.token'," <li><span class='ipsSelectTree_token cToken' data-nodeID='{{id}}'>{{title}}</span></li>");ips.templates.set('core.accessibility.border'," <div id='ipsAccessibility_border'></div>");ips.templates.set('core.accessibility.arrow'," <div id='ipsAccessibility_arrow'></div>");ips.templates.set('core.infScroll.loading',"  <li class='ipsPad ipsType_center' data-role='infScroll_loading'>  {{#lang}}loading{{/lang}}... </li>");ips.templates.set('core.infScroll.pageBreak',"  <li class='ipsPad_half ipsAreaBackground' data-role='infScroll_break' data-infScrollPage='{{page}}'>  {{#lang}}page{{/lang}} {{page}} </li>");ips.templates.set('core.pageAction.actionMenuItem',"  <li data-role='actionMenu' data-action='{{action}}' id='{{id}}_{{action}}' data-ipsMenu data-ipsMenu-above='force' data-ipsMenu-appendTo='#{{id}}_bar' data-ipsMenu-activeClass='ipsPageAction_active' data-ipsTooltip title='{{title}}' class='ipsHide'>  {{#icon}}   <i class='fa fa-{{icon}} ipsPageAction_icon'></i> <i class='fa fa-caret-up'></i>  {{/icon}}  {{^icon}}   <span class='ipsPageAction_text'>{{title}} <i class='fa fa-caret-up'></i></span>  {{/icon}}  <ul id='{{id}}_{{action}}_menu' class='ipsMenu ipsMenu_auto' style='display: none'>   {{{menucontent}}}  </ul> </li>");ips.templates.set('core.pageAction.actionItem',"  <li data-role='actionButton' data-action='{{action}}' id='{{id}}_{{action}}' data-ipsTooltip title='{{title}}'>  {{#icon}}   <i class='fa fa-{{icon}} ipsPageAction_icon' data-ipsTooltip='{{title}}'></i></i>  {{/icon}}  {{^icon}}   <span class='ipsPageAction_text'>{{title}}</span>  {{/icon}} </li>");ips.templates.set('core.pageAction.wrapper',"  <div class='ipsPageAction' data-role='actionBar' id='{{id}}_bar'>  <ul class='ipsList_inline ipsList_reset' data-role='actionItems'>   <li>{{{selectedLang}}}</li>   {{{content}}}  </ul> </div>");ips.templates.set('core.carousel.bulletWrapper'," <ul class='ipsCarousel_bullets'>{{content}}</ul>");ips.templates.set('core.carousel.bulletItem'," <li><i class='fa fa-circle'></i></li>");ips.templates.set('core.rating.wrapper'," <div class='ipsClearfix ipsRating'>  <ul class='{{className}}' data-role='ratingList'>   {{{content}}}  </ul> </div> <span data-role='ratingStatus' class='ipsType_light ipsType_medium'>{{status}}</span>")
ips.templates.set('core.rating.star'," <li class='{{className}}' data-ratingValue='{{value}}'><a href='#'><i class='fa fa-star'></i></a></li>");ips.templates.set('core.rating.halfStar'," <li class='ipsRating_half' data-ratingValue='{{value}}'><i class='fa fa-star-half'></i><i class='fa fa-star-half fa-flip-horizontal'></i></li>");ips.templates.set('core.rating.loading'," <i class='icon-spinner2 ipsLoading_tinyIcon'></span>");ips.templates.set('core.sidebar.managerWrapper',"  <div id='elSidebarManager' data-role='manager' class='ipsToolbox ipsScrollbar ipsHide'>  <div class='ipsPad'>   <h3 class='ipsToolbox_title ipsType_reset'>{{#lang}}sidebarManager{{/lang}}</h3>   <p class='ipsType_light'>{{#lang}}sidebarManagerDesc{{/lang}}</p>   <p class='ipsType_light'>{{#lang}}sidebarManagerDesc2{{/lang}}</p>   <div data-role='availableBlocks' class='ipsLoading ipsLoading_dark'></div>  </div>  <div id='elSidebarManager_submit' class='ipsPad'>   <button class='ipsButton ipsButton_important ipsButton_medium ipsButton_fullWidth' data-action='closeSidebar'>{{#lang}}finishEditing{{/lang}}</button>  </div> </div>");ips.templates.set('core.sidebar.blockManage',"  <div class='cSidebarBlock_managing ipsType_center'>  <h4>{{title}}</h4>  <a href='#' data-action='removeBlock' data-ipsTooltip title='{{#lang}}removeBlock{{/lang}}'><i class='fa fa-times'></i></a>  <button data-ipsMenu data-ipsMenu-closeOnClick='false' id='{{id}}_edit' data-action='manageBlock' class='ipsButton ipsButton_primary'>   <i class='fa fa-pencil'></i> &nbsp;{{#lang}}editBlock{{/lang}}  </button>  <div class='ipsMenu ipsMenu_wide ipsHide' id='{{id}}_edit_menu'>  </div> </div>");ips.templates.set('core.sidebar.blockManageNoConfig',"  <div class='cSidebarBlock_managing ipsType_center'>  <h4>{{title}}</h4>  <a href='#' data-action='removeBlock' data-ipsTooltip title='{{#lang}}removeBlock{{/lang}}'><i class='fa fa-times'></i></a> </div>");ips.templates.set('core.sidebar.blockIsEmpty',"  <div class='ipsWidgetBlank ipsPad'>  {{text}} </div>");ips.templates.set('core.follow.loading'," <div class='ipsLoading ipsLoading_tiny'></div>");ips.templates.set('core.statuses.loadingComments',"  <i class='icon-spinner2 ipsLoading_tinyIcon'></i> &nbsp;<span class='ipsType_light'> &nbsp;{{#lang}}loadingComments{{/lang}}</span>");ips.templates.set('core.forms.stack',"  <li class='ipsField_stackItem' data-role='stackItem'>  <span class='ipsField_stackDrag ipsDrag' data-action='stackDrag'>   <i class='fa fa-bars ipsDrag_dragHandle'></i>  </span>  <a href='#' class='ipsField_stackDelete ipsCursor_pointer' data-action='stackDelete'>   &times;  </a>  <div data-ipsStack-wrapper>   {{{field}}}  </div> </li>");ips.templates.set('core.pollEditor.question',"  <div class='ipsAreaBackground_light ipsBox ipsBox_transparent' data-role='question' data-questionID='{{questionID}}'>  <div class='ipsAreaBackground ipsPad'>   <input type='text' data-role='questionTitle' name='{{pollName}}[questions][{{questionID}}][title]' placeholder='{{#lang}}questionPlaceholder{{/lang}}' class='ipsField_fullWidth' value='{{question}}'>  </div>  <div>   <ul class='ipsDataList cPollChoices' data-role='choices'>    <li class='ipsDataItem ipsResponsive_hidePhone'>     <p class='ipsDataItem_generic ipsDataItem_size1'>&nbsp;</p>     <p class='ipsDataItem_main'><strong>{{#lang}}choicesTitle{{/lang}}</strong></p>     {{#showCounts}}      <p class='ipsDataItem_generic ipsDataItem_size4'><strong>{{#lang}}votesTitle{{/lang}}</strong></p>     {{/showCounts}}     <p class='ipsDataItem_generic ipsDataItem_size1'>&nbsp;</p>    </li>    {{{choices}}}   </ul>   <br>   <div class='ipsDataList'>    <p class='ipsDataItem_generic ipsDataItem_size1'>&nbsp;</p>    <ul class='ipsDataItem_main ipsList_inline ipsPadding_right:half'>     {{#removeQuestion}}<li class='ipsPos_right'><a href='#' data-action='removeQuestion' class='ipsButton ipsButton_verySmall ipsButton_link ipsButton_link--negative'>{{#lang}}removeQuestion{{/lang}}</a></li>{{/removeQuestion}}     <li><a href='#' data-action='addChoice' class='ipsButton ipsButton_verySmall ipsButton_link'>{{#lang}}addChoice{{/lang}}</a></li>     <li>      <span class='ipsCustomInput'>       <input type='checkbox' id='elPoll_{{pollName}}_{{questionID}}multi' name='{{pollName}}[questions][{{questionID}}][multichoice]' {{#multiChoice}}checked{{/multiChoice}}>       <span></span>      </span> <label for='elPoll_{{pollName}}_{{questionID}}multi'>{{#lang}}multipleChoiceQuestion{{/lang}}</label></li>     </li>    </ul>   </div>  </div> </div>");ips.templates.set('core.pollEditor.choice',"  <li class='ipsDataItem' data-choiceID='{{choiceID}}'>  <div class='ipsDataItem_generic ipsDataItem_size1 cPollChoiceNumber ipsType_right ipsType_normal'>   <strong data-role='choiceNumber'>{{choiceID}}</strong>  </div>  <div class='ipsDataItem_main'>   <input type='text' name='{{pollName}}[questions][{{questionID}}][answers][{{choiceID}}][value]' value='{{choiceTitle}}' class='ipsField_fullWidth'>  </div>  <div class='ipsDataItem_generic ipsDataItem_size1'>   <a href='#' data-action='removeChoice' class='ipsButton ipsButton_verySmall ipsButton_link ipsButton_link--negative ipsButton_narrow'><i class='fa fa-times'></i></a>  </div> </li>");ips.templates.set('core.coverPhoto.controls',"  <ul class='ipsList_reset ipsFlex ipsFlex-ai:center ipsGap:1' data-role='coverPhotoControls'>  <li><a href='#' class='ipsButton ipsButton_overlaid ipsButton_small' data-action='cancelPosition'><i class='fa fa-times'></i> {{#lang}}cancel{{/lang}}</a></li>  <li><a href='#' class='ipsButton ipsButton_veryLight ipsButton_small' data-action='savePosition'><i class='fa fa-check'></i> {{#lang}}save_position{{/lang}}</a></li> </ul>");ips.templates.set('core.patchwork.imageList',"  {{#showThumb}}  <li class='cGalleryPatchwork_item' style='width: {{dims.width}}px; height: {{dims.height}}px; margin: {{dims.margin}}px {{dims.marginRight}}px {{dims.margin}}px {{dims.marginLeft}}px'> {{/showThumb}} {{^showThumb}}  <li class='cGalleryPatchwork_item ipsNoThumb ipsNoThumb_video' style='width: {{dims.width}}px; height: {{dims.height}}px; margin: {{dims.margin}}px {{dims.marginRight}}px {{dims.margin}}px {{dims.marginLeft}}px'> {{/showThumb}}  <a href='{{image.url}}'>   {{#showThumb}}<img src='{{image.src}}' alt='{{image.title}}' class='cGalleryPatchwork_image'>{{/showThumb}}   <div class='ipsPhotoPanel ipsPhotoPanel_mini'>    <img src='{{image.author.photo}}' class='ipsUserPhoto ipsUserPhoto_mini'>    <div>     <span class='ipsType_normal ipsTruncate ipsTruncate_line'>{{image.caption}}</span>     <span class='ipsType_small ipsTruncate ipsTruncate_line'>{{#lang}}by{{/lang}} {{image.author.name}}</span>    </div>   </div>   <ul class='ipsList_inline cGalleryPatchwork_stats'>    {{#image.unread}}     <li class='ipsPos_left'>      <span class='ipsItemStatus ipsItemStatus_small' data-ipsTooltip title='{{image.unread}}'><i class='fa fa-circle'></i></span>     </li>    {{/image.unread}}    {{#image.hasState}}     <li class='ipsPos_left'>      {{#image.state.hidden}}       <span class='ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning' data-ipsTooltip title='{{#lang}}hidden{{/lang}}'><i class='fa fa-eye-slash'></i></span>      {{/image.state.hidden}}      {{#image.state.pending}}       <span class='ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning' data-ipsTooltip title='{{#lang}}pending{{/lang}}'><i class='fa fa-warning'></i></span>      {{/image.state.pending}}      {{#image.state.pinned}}       <span class='ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive' data-ipsTooltip title='{{#lang}}pinned{{/lang}}'><i class='fa fa-thumb-tack'></i></span>      {{/image.state.pinned}}      {{#image.state.featured}}       <span class='ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive' data-ipsTooltip title='{{#lang}}featured{{/lang}}'><i class='fa fa-star'></i></span>      {{/image.state.featured}}     </li>    {{/image.hasState}}    {{#image.allowComments}}     <li class='ipsPos_right' data-commentCount='{{image.comments}}'><i class='fa fa-comment'></i> {{image.comments}}</li>    {{/image.allowComments}}   </ul>  </a>  {{#image.modActions}}   <input type='checkbox' data-role='moderation' name='moderate[{{image.id}}]' data-actions='{{image.modActions}}' data-state='{{image.modStates}}'>  {{/image.modActions}} </li>");ips.templates.set('core.editor.preferences',"  <div id='editorPreferencesPanel' class='ipsPad'>  <div class='ipsMessage ipsMessage_info'>    {{#lang}}papt_warning{{/lang}}   </div>   <br>   <ul class='ipsForm ipsForm_vertical'>    <li class='ipsFieldRow ipsClearfix'>     <div class='ipsFieldRow_content'>      <input type='checkbox' {{#checked}}checked{{/checked}} name='papt' id='papt'>      <label for='papt'>{{#lang}}papt_label{{/lang}}</label>     </div>    </li>   </ul>   <div class='ipsPadding_top:half ipsType_center'>    <button role='button' class='ipsButton ipsButton_medium ipsButton_primary' id='papt_submit'>{{#lang}}save_preference{{/lang}}</button>   </div>  </div> ");ips.templates.set('core.pagination',"  <ul class='ipsPagination' data-ipsPagination data-ipsPagination-pages='{{pages}}'>  <li class='ipsPagination_prev'>   <a href='#' data-page='prev'><i class='fa fa-caret-left'></i> {{#lang}}prev_page{{/lang}}</a>  </li>  <li class='ipsPagination_next'>   <a href='#' data-page='next'>{{#lang}}next_page{{/lang}} <i class='fa fa-caret-right'></i></a>  </li> </ul>");ips.templates.set('core.selection.quote',"  <div class='ipsTooltip ipsTooltip_{{direction}} ipsComment_inlineQuoteTooltip' data-role='inlineQuoteTooltip'>     <a href='#' data-action='quoteSelection' class='ipsButton ipsButton_veryVerySmall ipsButton_veryLight'>   {{#lang}}quote_selected_text{{/lang}}     </a>    </div>");ips.templates.set('core.contentItem.resultItem',"  <li class='ipsAutocompleteMenu_item' data-id='{{{id}}}' role='option' role='listitem'>  <div class='ipsClearfix'>   {{{html}}}  </div> </li>");ips.templates.set('core.contentItem.field',"  <div class='ipsField_autocomplete' id='{{id}}_wrapper' role='combobox' aria-autocomplete='list' aria-owns='{{id}}_results'>  <span class='ipsField_autocomplete_loading' style='display: none' id='{{id}}_loading'></span>  <ul class='ipsList_inline'><li id='{{id}}_inputItem'>{{content}}</li></ul> </div>");ips.templates.set('core.contentItem.resultWrapper',"  <div class='ipsAutocompleteMenu' id='{{id}}_results' aria-expanded='false' style='display: none'>  <ul class='ipsAutocompleteMenu_itemWrapper ipsList_reset' data-role='items'></ul> </div>");ips.templates.set('core.contentItem.item',"  <li data-id='{{id}}'>  <span class='cContentItem_delete' data-action='delete'>&times;</span> {{{html}}}  </li>");ips.templates.set('promote.imageUpload',"  <div class='ipsGrid_span4 cPromote_attachImage' id='{{id}}' data-role='file' data-fileid='{{id}}' data-fullsizeurl='{{imagesrc}}' data-thumbnailurl='{{thumbnail}}' data-fileType='image'>  <div class='ipsThumb ipsThumb_bg' data-role='preview' {{#thumbnail}}style='background-image: url( \"{{thumbnail_for_css}}\" )'{{/thumbnail}}>   {{#thumbnail}}<img src='{{thumbnail}}' class='ipsImage'>{{/thumbnail}}  </div>  <ul class='ipsList_inline ipsImageAttach_controls'>   <li class='ipsPos_right' {{#newUpload}}style='display: none'{{/newUpload}} data-role='deleteFileWrapper'>    <input type='hidden' name='{{field_name}}_keep[{{id}}]' value='1'>    <a href='#' data-role='deleteFile' class='ipsButton ipsButton_verySmall ipsButton_light' data-ipsTooltip title='{{#lang}}attachRemove{{/lang}}'><i class='fa fa-trash-o'></i></a>   </li>  </ul>  <span class='ipsAttachment_progress'><span data-role='progressbar'></span></span> </div>");ips.templates.set('table.row.loading',"  <li class='ipsDataItem ipsDataItem_loading'>  <div>   <span></span>   <span style='margin-right: {{rnd}}%'></span>  </div> </li>");ips.templates.set('licenseRenewal.wrapper',"  <div class='acpLicenseRenewal' data-role='licenseRenewal'>  <div class='acpLicenseRenewal_wrap'>   <div class='acpLicenseRenewal_inner'>    <div class='acpLicenseRenewal_content'>     <h1 class='acpLicenseRenewal_mainTitle' data-role='mainTitle'>{{#lang}}licenseRenewalTitle{{/lang}}</h1>     <p class='ipsType_normal'>{{#lang}}licenseRenewalText{{/lang}}</p>     <span class='ipsCustomInput'><input type='checkbox' checked='checked' name='hideRenewalNotice' id='hideRenewalNotice'><span></span></span> <label for='hideRenewalNotice'>{{#lang}}licenseRenewalCheckbox{{/lang}}</label>    </div>    <ul class='ipsPad ipsToolList ipsToolList_horizontal ipsPos_center ipsList_reset ipsClearfix ipsAreaBackground'>     <li>      <a href='#' class='ipsButton ipsButton_medium ipsButton_veryLight ipsButton_fullWidth' data-action='closeLicenseRenewal'>{{#lang}}licenseRenewalNo{{/lang}}</a>     </li>     <li>      <a href='#' class='ipsButton ipsButton_medium ipsButton_primary ipsButton_fullWidth' data-role='survey' data-action='closeLicenseRenewal' target='_blank'>{{#lang}}licenseRenewalYes{{/lang}}</a>     </li>    </ul>   </div>  </div> </div>");ips.templates.set('core.browserNotification.prompt'," <div class='cNotifcationPrompt'>  <div class='ipsPadding'>   <div class='ipsPhotoPanel ipsPhotoPanel_mini'>    <span class='cNotifcationPrompt_icon ipsPos_left'></span>    <div>     <a href='#' class='cNotifcationPrompt_dismiss' data-role=\"dismissNotification\">×</a>     <h3 class='cNotifcationPrompt_title ipsType_large ipsType_sectionHead'>{{#lang}}notificationsCallout{{/lang}}</h3>     <p class='cNotifcationPrompt_text ipsType_reset ipsType_medium ipsSpacer_top ipsSpacer_half'>      {{#lang}}notificationsDefaultBlurb{{/lang}}     </p>     <div class='ipsFlex ipsFlex-ai:center ipsGap:2 ipsMargin_top'>      <button data-action='browserNotificationPrompt' class='ipsButton ipsButton_small ipsButton_veryLight ipsButton_fullWidth'>{{#lang}}notificationsAllow{{/lang}}</button>     </div>     <p class='ipsType_small ipsSpacer_both ipsSpacer_half ipsHide' data-role='promptMessage'>      {{#lang}}notificationsAllowPrompt{{/lang}}     </p>    </div>   </div>  </div> </div>");ips.templates.set('core.browserNotification.missingSubscription'," <div class='cNotifcationPrompt'>  <div class='ipsPadding'>   <div class='ipsPhotoPanel ipsPhotoPanel_mini'>    <span class='cNotifcationPrompt_icon ipsPos_left'></span>    <div>     <a href='#' class='cNotifcationPrompt_dismiss' data-role=\"dismissNotification\">×</a>     <h3 class='cNotifcationPrompt_title ipsType_large ipsType_sectionHead'>{{#lang}}notificationsCalloutPush{{/lang}}</h3>     <p class='cNotifcationPrompt_text ipsType_reset ipsType_medium ipsMargin_vertical:half'>      {{#lang}}notificationsDefaultBlurb{{/lang}}     </p>     <p class='cNotifcationPrompt_text ipsType_reset ipsType_small ipsMargin_vertical:half'>      {{#lang}}notificationsUpgradeBlurb{{/lang}}     </p>     <div class='ipsFlex ipsFlex-ai:center ipsGap:4 ipsGap_row:0 ipsMargin_top ipsType_blendLinks'>      <button data-action='browserNotificationPrompt' class='ipsButton ipsButton_small ipsButton_veryLight ipsButton_fullWidth'>{{#lang}}notificationsAllow{{/lang}}</button>      <a href='#' data-action='rejectPush' class='ipsFlex-flex:00'>{{#lang}}notificationsNoThanks{{/lang}}</a>     </div>     <p class='ipsType_small ipsSpacer_both ipsSpacer_half ipsHide' data-role='promptMessage'>      {{#lang}}notificationsAllowPrompt{{/lang}}     </p>    </div>   </div>  </div> </div>");ips.templates.set('core.notifications.pending'," <span class='ipsType_light'>{{#lang}}notificationsEnabling{{/lang}}</span>");ips.templates.set('core.notifications.success'," <span class='ipsType_success'><i class='fa fa-fw fa-check'></i> {{#lang}}notificationsEnabled{{/lang}}</span>");ips.templates.set('core.notifications.fail'," <span class='ipsType_negative'><i class='fa fa-fw fa-times'></i> {{#lang}}notificationsFailed{{/lang}}</span>");ips.templates.set('core.notifications.notSupported'," <span class='ipsType_light'><i class='fa fa-fw fa-times'></i> {{#lang}}notificationsNotSupported{{/lang}}</span>");ips.templates.set('core.notifications.checking'," <span class='ipsType_light'>{{#lang}}notificationsChecking{{/lang}}</span>");ips.templates.set('system.warningpenalty.nomodify'," <ul class='ipsList_bullets' id='elWarningPenalties'>  {{#penalties}}  <li>{{.}}</li>  {{/penalties}} </ul>");ips.templates.set('core.edittags.default'," <div class='ipsPad'>  <span><i class='icon-spinner2 ipsLoading_tinyIcon'></i>  &nbsp;{{#lang}}loading{{/lang}}</span> </div>");ips.templates.set('core.onlineUser.linked',"<li> <a href='{{memberUrl}}' data-ipsHover data-ipsHover-target='{{memberHovercardUrl}}'>{{{formattedName}}}</a></li>");;
;(function($,_,undefined){"use strict";ips.createModule('ips.loader',function(){var _loadedScripts=[],_loadingScripts=[];var ini},_getOtherScrip},_getInterfaceScrip},_getPathScript},ge},_doLoa},_insertScript=function(toLoad,cached){for(var i=0;i<toLoad.length;i++){_loadingScripts.push(toLoad[i]);}
Debug.log("Loading: "+toLoad.join(', '));var url='';if(toLoad[0].match(/^(http|\/\/)/i)){url=toLoad[0].match(/^http/)?toLoad[0].replace(/^.+?\/\/(.*)$/,'//$1'):toLoad[0];}else{url=ips.getSetting('jsURL')+'?src='+encodeURIComponent(toLoad.join(','));}
setTimeout(function(){$.ajax({dataType:'script',cache:(_.isUndefined(cached))?true:cached,url:url,data:{antiCache:ips.getSetting('jsAntiCache'),csrfKey:null,}}).fai}).alway}).don})},500);};return{init:init,get:get}});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.controller',function(){var _controllers={},_autoMixins={},_manualMixins={},_mixins={},_beingLoaded=[],_queue={},_prototypes={},instanceID=1,_controllerCaseMap={'core.front.core.autosizeiframe':'core.front.core.autoSizeIframe'};var registe},isRegistered=function(id){return!_.isUndefined(_controllers[id]);},ini},mixi},initializeController},_checkQueu},_loadController},_buildFilePath=function(controllerName){var bits=controllerName.split('.');if(ips.getSetting('useCompiledFiles')===false){return bits[0]+'/'+bits[1]+'/controllers/'+bits[2]+'/ips.'+bits[2]+'.'+bits[3]+'.js';}else{try{var url=ipsJavascriptMap[bits[0]][bits[1]+'_'+bits[2]];if(url.indexOf('?')!=-1){return url+'&v='+ips.getSetting('jsAntiCache');}else{return url+'?v='+ips.getSetting('jsAntiCache');}}catch(err){return'';}}},_findController},_getControllersAndMixins=function(controllerString){var controllers={};var pieces=controllerString.split(',');for(var i=0;i<pieces.length;i++){pieces[i]=pieces[i].trim();if(!_.isUndefined(_controllerCaseMap[pieces[i]])){pieces[i]=_controllerCaseMap[pieces[i]];}
if(pieces[i].indexOf('(')===-1){controllers[pieces[i]]=[];continue;}
var p=pieces[i].match(/([a-zA-Z0-9.]+)\((.+?)\)/i);var mixinPieces=[];_.each(p[2].split(';'});controllers[p[1]]=mixinPieces;}
return controllers;},getInstanceI},cleanContentsO},initControllerOnEle},_findSubController},getBaseController=function(){var baseControlle};baseController.method('_destroy});baseController.method('cleanContents});baseController.method('trigger});baseController.method('on',function(elem,ev,delegate,fn){var args=ips.utils.argsToArray(arguments);elem=(!_.isElement(elem)&&elem!=document&&elem!=window)?this.scope:$(args.shift());ev=args[0];fn=(args.length==3)?args[2]:args[1];delegate=(args.length==3)?args[1]:undefined;if(!_.isFunction(fn)){Debug.warn("Callback function for "+ev+" doesn't exist in "+this.controllerType
+" ("+this.controllerID+")");return;}
let _fn=_.bind(fn,this);f}
if(delegate){elem.on(ev,delegate,fn);this._eventListeners.push({elem:elem,event:ev,delegate:delegate,fn:fn});}else{elem.on(ev,fn);this._eventListeners.push({elem:elem,event:ev,fn:fn});}});baseController.method('triggerOn});return baseController;};return{initControllerOnElem:initControllerOnElem,register:register,mixin:mixin,isRegistered:isRegistered,init:init,cleanContentsOf:cleanContentsOf};});}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui',function(){var widgets={},doneInitialInit=false,ziCounter=ips.getSetting('zindex_start')||5000,ziIncrement=ips.getSetting('zindex_inc')||50;var key={BACKSPACE:8,ESCAPE:27,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,COMMA:188,SPACE:32};var registerWidge},getAcceptedOption},buildjQueryPlugi},_initializeWidget},destructAllWidget},_destructWidge},_doImmediateWidget},_doLazyWidget},_callWidge},_getWidgetOptions=function(widgetID,elem){var options={},optionKeys=widgets[widgetID].acceptedOptions;elem=$(elem);try{if(elem.attr('data-ips'+widgetID+'-options')){var optionsObj=$.parseJSON(elem.attr('data-ips'+widgetID+'-options'));if(_.isObject(optionsObj)){return optionsObj;}}}catch(err){Debug.warn("Invalid options object passed in for a "+widgetID+" widget. Must be valid JSON.");}
if(optionKeys.length){for(var i=0;i<optionKeys.length;i++){var thisOption=elem.attr('data-ips'+widgetID+'-'+optionKeys[i]);if(!_.isUndefined(thisOption)){if(thisOption.match(/^[1-9][0-9]*$/g)){thisOption=parseInt(thisOption,10);}
if(thisOption==='true'){thisOption=true;}else if(thisOption==='false'){thisOption=false;}
if(typeof thisOption==='string'&&thisOption.trim()===''){thisOption=true;}
options[optionKeys[i]]=thisOption;}}}
return options;},zIndex=function(){ziCounter+=ziIncrement;return String(ziCounter);},getModa},ini};return{registerWidget:registerWidget,init:init,zIndex:zIndex,getModal:getModal,getAcceptedOptions:getAcceptedOptions,key:key,destructAllWidgets:destructAllWidgets};});}(jQuery,_));;
;(function($,_,undefined){ips.createModule('ips.ui.menu',function(){var defaults={className:'ipsMenu',activeClass:'',closeOnClick:true,closeOnBlur:true,selectable:false,withStem:true,stemOffset:25,stopLinks:false,above:'auto'};var stems=['topLeft','topRight','topCenter','bottomLeft','bottomRight','bottomCenter'];if(!defaults.withStem){defaults.stemOffset=0;}
var _menuRegistry={};var respon},_showMen},_showSubMenu=function(elem,elemID,options,menu,e){var menuItem=$(e.currentTarget).find('> a');var subMenu=menuItem.next('.ipsMenu');$(e.currentTarget).on('mouseleave',_.bind(_hideSubMenu,this,elem,elemID,options,menu));var itemPosition=ips.utils.position.getElemPosition(menuItem);var itemSize=ips.utils.position.getElemDims(menuItem);var subMenuSize=ips.utils.position.getElemDims(subMenu);if($('html').attr('dir')=='rtl'){var left=(itemSize.outerWidth-5);var top=menuItem.position()['top']-5;if((itemPosition.viewportOffset.left-subMenuSize.outerWidth-5)<0){if((itemPosition.viewportOffset.right+5+subMenuSize.outerWidth)<=$(window).width()){left=(itemSize.outerWidth+5);}else{left=15-itemPosition.absPos.left;top=menuItem.position()['top']+itemSize.height+15;}}
subMenu.css({left:left+'px',top:top+'px'}).show();}else{var left=(itemSize.outerWidth-5);var top=menuItem.position()['top']-5;if((itemPosition.viewportOffset.left+itemSize.outerWidth+subMenuSize.outerWidth-5)>$(window).width()){if((itemPosition.viewportOffset.left+5-subMenuSize.outerWidth)>=0){left=((subMenuSize.outerWidth*-1)+5);}else{left=($(window).width()-subMenuSize.outerWidth)-itemPosition.absPos.left-15;top=menuItem.position()['top']+itemSize.height+15;}}
subMenu.css({left:left+'px',top:top+'px'}).show();}},_hideSubMen},_hideMen},_positionMenu=function(elem,elemID,options,menu,repositioning){var above=options.above;if(above=='auto'){above=false;if(($(elem).offset().top+menu.height())>$(window).height()){above=true;}}
var positionInfo={trigger:elem,target:menu,center:true,above:above,stemOffset:{left:options.stemOffset,top:-2}};menu.css({left:'auto',top:'auto',position:'static'});if(menu.attr('data-originalWidth')){menu.css({width:menu.attr('data-originalWidth')+'px'});}
if(options.appendTo){var appendTo=_getAppendContainer(elem,options.appendTo);if(appendTo.length){_.extend(positionInfo,{targetContainer:appendTo});}}
var menuPosition=ips.utils.position.positionElem(positionInfo);var menuDims=ips.utils.position.getElemDims(menu);var triggerPosition=ips.utils.position.getElemPosition($(elem));menu.css({left:menuPosition.left+'px',top:menuPosition.top+'px',position:(menuPosition.fixed)?'fixed':'absolute',});if(!repositioning){menu.css({zIndex:ips.ui.zIndex()});}
var newMenuPosition=ips.utils.position.getElemPosition(menu);if((menuDims.width>$(document).width())||newMenuPosition.viewportOffset.left<0){options.noStem=true;var left="10px";if(options.appendTo&&appendTo.length){var appendPosition=ips.utils.position.getElemPosition(appendTo);left=(10-appendPosition.viewportOffset.left)+'px';}
menu.attr('data-originalWidth',menuDims.width).css({left:left,width:($(document).width()-20)+'px'});}
_removeExistingStems(menu,options);if(!menu.hasClass(options.className+'_noStem')&&!options.noStem){var stemClass='';stemClass+=menuPosition.location.vertical;stemClass+=menuPosition.location.horizontal.charAt(0).toUpperCase();stemClass+=menuPosition.location.horizontal.slice(1);menu.addClass(options.className+'_'+stemClass);}},_removeExistingStem},_getMen},_closeOnBlu},_clickIsChildOfMen},_menuClicke},_handleSelectableClic},_getAppendContainer=function(elem,appendTo){var appends=appendTo.split(',');var elem=$(elem);for(var i=0;i<appends.length;i++){var selector=appends[i].trim();if(selector.startsWith('#')){if($(selector).length){return $(selector);}}else{if(elem.closest(selector).length){return elem.closest(selector);}}};};ips.ui.registerWidget('menu',ips.ui.menu,['className','menuID','closeOnClick','closeOnBlur','menuContent','appendTo','activeClass','selectable','withStem','stemOffset','stopLinks','above'],{lazyLoad:true,lazyEvents:'click'});return{respond:respond};});}(jQuery,_));;
;(function($,_,undefined){"use strict";var ipsUploaders=[];var iconMap={'txt':'file-text-o','rtf':'file-text-o','csv':'file-text-o','pdf':'file-pdf-o','doc':'file-word-o','docx':'file-word-o','xls':'file-excel-o','xlsx':'file-excel-o','xlsm':'file-excel-o','zip':'file-archive-o','tar':'file-archive-o','gz':'file-archive-o','ppt':'file-powerpoint-o','pptx':'file-powerpoint-o','ico':'file-image-o','gif':'file-image-o','jpeg':'file-image-o','jpg':'file-image-o','jpe':'file-image-o','png':'file-image-o','psd':'file-image-o','webp':'file-image-o','aac':'file-audio-o','mp3':'file-audio-o','ogg':'file-audio-o','ogv':'file-audio-o','wav':'file-audio-o','m4a':'file-audio-o','avi':'file-video-o','flv':'file-video-o','mkv':'file-video-o','mp4':'file-video-o','mpg':'file-video-o','mpeg':'file-video-o','3gp':'file-video-o','webm':'file-video-o','wmv':'file-video-o','avi':'file-video-o','m4v':'file-video-o','mov':'file-video-o','css':'file-code-o','html':'file-code-o','js':'file-code-o','xml':'file-code-o',};ips.createModule('ips.ui.uploader',function(){var defaults={multiple:false,allowedFileTypes:null,maxFileSize:null,maxTotalSize:null,maxChunkSize:null,action:null,name:'upload',button:'.ipsButton_primary',key:null,autoStart:true,insertable:false,template:'core.attachments.fileItem',postkey:'',supportsDelete:true,maxImageDims:null,allowStockPhotos:false,};var respon},refres},getObj=function(elem){if($(elem).data('_uploader')){return $(elem).data('_uploader');}
return undefined;},getExtensionIcon=function(filename){var extRegex=/(?:\.([^.]+))?$/;var ext=extRegex.exec(filename);if(!_.isUndefined(iconMap[ext[1]])){return iconMap[ext[1]];}
return'file-o';};ips.ui.registerWidget('uploader',ips.ui.uploader,['multiple','allowedFileTypes','maxFileSize','maxTotalSize','maxChunkSize','action','name','button','key','maxFiles','dropTarget','listContainer','autoStart','insertable','template','existingFiles','postkey','supportsDelete','maxImageDims','allowStockPhotos']);return{respond:respond,refresh:refresh,getObj:getObj,getExtensionIcon:getExtensionIcon};});var uploadObj=function(elem,options,e){var pluploadObj,runtime,listContainer,uploadCount=0,totalSize=0,injectIds={},uploaderID='',sound=null;var ini},refres},_setUpFormEvents=function(){if(!elem.closest('form').length){return;}
if(options.allowStockPhotos!==false){$(elem).find('[data-action="stockPhoto"]').on('click',function(e){e.preventDefault();e.stopPropagation();var dialogRef=ips.ui.dialog.create({title:ips.getString("stockphoto_header"),fixed:false,destructOnClose:true,url:ips.getSetting('baseURL')+'?app=core&module=system&controller=pixabay&uploader='+$(elem).attr('data-ipsUploader-name'),});dialogRef.show();});}
elem.closest('form').on('submit});},_addUploaderFile=function(e,data){if(data.uploaderID==uploaderID){data.extIcon=ips.ui.uploader.getExtensionIcon(data.title);listContainer.append(ips.templates.render(_getTemplateName(data),data));}},_getTemplateName=function(data){if(options.template!==null){return options.template;}
let type='fileItem';if(data.isImage){type='imageItem';}else if(data.isVideo){type='videoItem';}
return`core.attachments.${type}`;},_removeAllFile},_buildExistingFiles=function(files){if(!files.length){return;}
for(var i=0;i<files.length;i++){var data={id:files[i].id,imagesrc:files[i].imagesrc,thumbnail:files[i].thumbnail?files[i].thumbnail:'',thumbnail_for_css:files[i].thumbnail?files[i].thumbnail.replace('(','\\(').replace(')','\\)'):'',title:files[i].originalFileName,size:files[i].size,field_name:elem.attr('data-ipsUploader-name'),newUpload:false,insertable:!options.insertable,done:true,'default':files[i].default?files[i].default:null,supportsDelete:options.supportsDelete,extIcon:ips.ui.uploader.getExtensionIcon(files[i].originalFileName)};if(files[i].id==elem.attr('data-ipsUploader-default')){data['checked']="checked";}
if(files[i]['hasThumb']){data['thumb']="<img src='"+(files[i]['thumbnail']?files[i]['thumbnail']:files[i]['imagesrc'])+"' class='ipsImage'>";}
listContainer.append(ips.templates.render(options.template,data));$('#'+files[i].id).trigger('newItem',[$('#'+files[i].id)]);};elem.trigger('fileAdded',{count:files.length,uploader:options.name});},_setUpUploade},_getUploaderSettings=function(){var form=elem.parentsUntil('','form');if(options.action===null){options.action=form.attr('action');}
if(options.key===null){options.key=form.children("[name='plupload']").val();}
var pluploadOptions={runtimes:'html5,flash,silverlight,html4',multi_selection:options.multiple,url:encodeURI(_decodeUrl(options.action)),file_data_name:options.name,flash_swf_url:'applications/core/interface/plupload/Movie.swf',silverlight_xap_url:'applications/core/interface/plupload/Movie.xap',browse_button:elem.find(options.button).identify().attr('id'),headers:{'x-plupload':options.key},chunk_size:options.maxChunkSize+'mb'};if(options.dropTarget){pluploadOptions.drop_element=$(options.dropTarget).attr('id');}else if($(elem).hasClass('ipsAttachment_dropZone')){pluploadOptions.drop_element=$(elem).attr('id');}else if($(elem).find('.ipsAttachment_dropZone').length){pluploadOptions.drop_element=$(elem).find('.ipsAttachment_dropZone').identify().attr('id');}
if(options.maxImageDims){var maxImageDims=options.maxImageDims.split('x');pluploadOptions.resize={width:parseInt(maxImageDims[0]),height:parseInt(maxImageDims[1]),quality:parseInt(ips.getSetting('image_jpg_quality')),fit:false};}
return pluploadOptions;},_isEncode},_decodeUr},_initUploader=function(){pluploadObj.init();},_postInitEvents=function(){pluploadObj.bind('Error',events.error);pluploadObj.bind('FilesAdded',events.filesAdded);pluploadObj.bind('FilesRemoved',events.filesRemoved);pluploadObj.bind('UploadFile',events.uploadFile);pluploadObj.bind('UploadProgress',events.uploadProgress);pluploadObj.bind('FileUploaded',events.fileUploaded);pluploadObj.bind('UploadComplete',events.uploadComplete);$(elem).on('injectFile',function(e,data){var pluploadFile=new plupload.File(new moxie.file.File(getRuntimeUid(),data.file));injectIds[pluploadFile.id]=data.data;pluploadObj.addFile(pluploadFile);}).on('resetUploader',function(data){_resetUploader(e,data);});$(window).on('resize',function(){pluploadObj.refresh();});},getRuntimeUid=function(){if(!runtime){runtime=new(moxie.runtime.Runtime.getConstructor(pluploadObj.runtime))();runtime.init();}
return runtime.uid;},_resetUploader=function(data){uploadCount=0;totalSize=0;_updateCount();$(elem).trigger('removeAllFiles',{uploaderID:uploaderID});},_startUploa},_getStatu},_updateFileElement=function(file){var fileElem=_findFileElem(file);_removeStatusClasses(fileElem);_updateStatus(fileElem,file.status);_updateCount();return fileElem;},_findFileEle},_updateStatus=function(fileElem,status){fileElem.find('[data-role="status"]').html(_getStatus(status));fileElem.toggleClass('ipsAttach_error',status===plupload.FAILED);},_removeStatusClasse},_updateCoun},_setPercent=function(fileElem,percent){fileElem.find('[data-role="progressbar"]').css({width:percent+'%'});if(percent===100){fileElem.find('.ipsAttachment_progress').slideUp();}},_buildThumb=function(fileElem,file,info){var toInsert='';if(info.imagesrc){Debug.log(fileElem.find('[data-role="preview"]'));toInsert=$('<img/>').attr({src:info.thumbnail?info.thumbnail:info.imagesrc}).addClass('ipsImage');fileElem.attr('data-fullsizeurl',info.imagesrc).attr('data-thumbnailurl',info.thumbnail?info.thumbnail:info.imagesrc).find('[data-role="preview"]').html(toInsert).css('background-image','url( "'+(info.thumbnail?info.thumbnail:info.imagesrc)+'")');}else if(info.videosrc){toInsert=$('<video/>').append($('<source/>').attr({src:info.videosrc,type:fileElem.attr('data-mimeType')}));fileElem.attr('data-fullsizeurl',info.videosrc).find('[data-role="preview"]').html(toInsert);}
fileElem.attr('data-fileid',info.id);if(info.securityKey){fileElem.attr('data-filekey',info.securityKey);}},_deleteFile=function(fileElem,e){e.preventDefault();e.stopPropagation();var baseUrl=options.action;if(baseUrl.match(/\?/)){if(baseUrl.slice(-1)!='?'){baseUrl+='&';}}else{baseUrl+='?';}
ips.getAjax()(baseUrl+'postKey='+options.postkey+'&deleteFile='+encodeURIComponent(fileElem.attr('data-fileid')));uploadCount--;totalSize=totalSize-fileElem.attr('data-filesize');_updateCount();fileElem.fadeOu});},_supportsDraggabl},events={ini},filesAdded:function(up,files){if(!options.multiple){listContainer.find('[data-role="deleteFile"]').click();if(files.length>1){alert(ips.getString('uploadSingleErr'));return false;}}else if(options.maxFiles){if(files.length>options.maxFiles||(uploadCount+files.length)>options.maxFiles){ips.ui.alert.show({type:'alert',icon:'warn',message:ips.pluralize(ips.getString('uploadMaxFilesErr'),options.maxFiles),callbacks:{}});_.each(files,function(file,idx){up.removeFile(file);});return false;}}else if(options.maxTotalSize&&totalSize>(options.maxTotalSize*1048576)){ips.ui.alert.show({type:'alert',icon:'warn',message:ips.getString('uploadTotalErr',{size:parseFloat((options.maxTotalSize>=1)?options.maxTotalSize:(options.maxTotalSize*1024)).toLocaleString($('html').attr('lang')),size_suffix:(options.maxTotalSize>=1)?ips.getString('size_mb'):ips.getString('size_kb')}),callbacks:{}});_.each(files,function(file,idx){up.removeFile(file);});return false;}
var tooLarge=0;var overTotalLimit=0;var badType=0;var allowedFileTypes=(options.allowedFileTypes!==null)?$.parseJSON(options.allowedFileTypes).join(',').toLowerCase().split(','):'';var sizeAllowance=options.maxTotalSize?(options.maxTotalSize*1048576)-totalSize:null;_.each(files,function(file,idx){if(options.maxFileSize!==null&&((file.size / 1024)>(options.maxFileSize*1024))){tooLarge++;up.removeFile(file);return;}
if(!_.isNull(sizeAllowance)){if((sizeAllowance-file.size)<0){overTotalLimit++;up.removeFile(file);return;}
sizeAllowance-=file.size;}
if(allowedFileTypes&&allowedFileTypes.indexOf(file.name.substr((~-file.name.lastIndexOf(".")>>>0)+2).toLowerCase())===-1){badType++;up.removeFile(file);return;}
var size=plupload.formatSize(file.size),status=_getStatus(file.status),isImage=false,isVideo=false,isAudio=false;if(['jpg','jpeg','jpe','gif','png','webp'].indexOf(file.name.substr((~-file.name.lastIndexOf(".")>>>0)+2).toLowerCase())!==-1){isImage=true;}
if(['mp4','3gp','mov','ogg','ogv','mpg','mpeg','flv','webm','wmv','avi','m4v'].indexOf(file.name.substr((~-file.name.lastIndexOf(".")>>>0)+2).toLowerCase())!==-1){isVideo=true;}
if(['mp3','ogg','wav','m4a'].indexOf(file.name.substr((~-file.name.lastIndexOf(".")>>>0)+2).toLowerCase())!==-1){isAudio=true;}
var data={uploaderID:uploaderID,id:file.id,title:file.name,mime:file.type,size:size,sizeRaw:file.size,status:status,statusCode:file.status,statusText:ips.getString('attachStatus',{size:size,status:status}),field_name:elem.attr('data-ipsUploader-name'),newUpload:true,insertable:true,isImage:isImage,isVideo:isVideo,isAudio:isAudio,supportsDelete:options.supportsDelete};$(elem).trigger('addUploaderFile',data);$('#'+file.id).addClass('ipsAttach_queued').trigger('newItem',[$('#'+file.id)]);});if(tooLarge){var errorString=ips.getString('uploadSizeErr',{max_file_size:parseFloat((options.maxFileSize>1)?options.maxFileSize:(options.maxFileSize*1024)).toLocaleString($('html').attr('lang')),size_suffix:(options.maxFileSize>1)?ips.getString('size_mb'):ips.getString('size_kb')});ips.ui.alert.show({type:'alert',icon:'warn',message:ips.pluralize(errorString,[tooLarge,tooLarge]),callbacks:{}});}
if(overTotalLimit){var errorString=ips.getString('uploadSizeTotalErr',{max_file_size:parseFloat((options.maxTotalSize>1)?options.maxTotalSize:(options.maxTotalSize*1024)).toLocaleString($('html').attr('lang')),size_suffix:(options.maxTotalSize>1)?ips.getString('size_mb'):ips.getString('size_kb')});ips.ui.alert.show({type:'alert',icon:'warn',message:ips.pluralize(errorString,[overTotalLimit,overTotalLimit]),callbacks:{}});}
if(badType){var errorString=ips.getString('pluploaderr_-601',{allowed_extensions:allowedFileTypes.join(', ')});ips.ui.alert.show({type:'alert',icon:'warn',message:ips.pluralize(errorString,[tooLarge,tooLarge]),callbacks:{}});}
if(up.files.length){elem.trigger('fileAdded',{count:up.files.length,uploader:options.name});if(options.autoStart){_startUpload();}}},filesRemoved:function(){Debug.log('removed');},uploadFil},uploadProgres},uploadComplete:function(up,files){var success=0;var error=0;_.each(file});var total=success+error;elem.trigger('uploadComplete',{success:success,error:error,total:total,uploader:options.name});if(_.isUndefined(ips.utils.events.getVisibilityProp())||!document[ips.utils.events.getVisibilityProp()]){return;}
var text=[];if(!total){return;}
if(success){text.push(ips.pluralize(ips.getString('notifyUploadSuccess'),[success]));}
if(error){text.push(ips.pluralize(ips.getString('notifyUploadError'),[error]));}
if(ips.utils.notification.hasPermission()){ips.utils.notification.create({title:ips.pluralize(ips.getString('yourUploadsFinished'),[total]),body:text.join(' '),icon:ips.getSetting('upload_imgURL'),onClic}}).show();}
if(sound){try{sound.play();}catch(err){}}},fileUploaded:function(up,file,info){uploadCount++;totalSize+=file.size;var fileElem=_updateFileElement(file);fileElem.addClass('ipsAttach_done');if(options.insertable){ips.utils.anim.go('fadeIn',fileElem.find('[data-role="insert"]'));}
fileElem.find('[data-role="deleteFileWrapper"]').slideDown();if($(elem).find('.ipsAttachment_loading').is(':visible')){$(elem).find('.ipsAttachment_loading').hide();$(elem).find('.ipsAttachment_dropZoneSmall_info').show();}
_setPercent(fileElem,100);try{var jsonInfo=$.parseJSON(info.response);elem.before($('<input type="hidden">').attr('name',elem.attr('data-ipsUploader-name')+'_existing['+file.id+']').attr('value',jsonInfo.id));if(jsonInfo['error']){fileElem.on('click','[data-role="deleteFile"]',_.bind(_deleteFile,fileElem,fileElem));file.status=plupload.FAILED;up.trigger('error',{code:jsonInfo['error'],extra:jsonInfo['extra'],subText:jsonInfo['sub'],file:file,uploader:options.name});return;}
if(jsonInfo){_buildThumb(fileElem,file,jsonInfo);fileElem.on('click','[data-role="deleteFile"]',_.bind(_deleteFile,fileElem,fileElem));}}catch(err){fileElem.on('click','[data-role="deleteFile"]',_.bind(_deleteFile,fileElem,fileElem));file.status=plupload.FAILED;up.trigger('error',{code:'upload_error',extra:err.message,file:file,uploader:options.name});Debug.warn(err);}
if(file.id&&injectIds[file.id]){$(elem).trigger('fileInjected',{'fileElem':fileElem,'data':injectIds[file.id]});delete injectIds[file.id];}},error:function(up,err){if(err.file){_updateFileElement(err.file);}
if(err.code==-600||err.code==-601){return;}
var errorMessage=ips.getString('pluploaderr_'+err.code,{max_file_size:parseFloat((options.maxFileSize>1)?options.maxFileSize:(options.maxFileSize*1024)).toLocaleString($('html').attr('lang')),size_suffix:(options.maxFileSize>1)?ips.getString('size_mb'):ips.getString('size_kb'),allowed_extensions:(options.allowedFileTypes!==null)?$.parseJSON(options.allowedFileTypes).join(','):'',server_error_code:(err.extra!==null)?err.extra:0,});if(!errorMessage){errorMessage=ips.getString('pluploaderr_SERVER_CONFIGURATION',{server_error_code:err.code});err.subText=ips.getString('pluploaderr_error_code',{code:err.code});}
ips.ui.alert.show({type:'alert',icon:'warn',message:errorMessage,callbacks:{},subTextHtml:err.subText?err.subText:null});}};init();return{init:init,refresh:refresh};}}(jQuery,_));;
}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.passwordStrength',function(){var defaults={};var respond=function(elem,options){if(!$(elem).data('_passwordStrength')){$(elem).data('__passwordStrength',passwordStrengthObj(elem,_.defaults(options,defaults)));}},destruct=function(elem){var obj=getObj(elem);if(!_.isUndefined(obj)){obj.destruct();}},getObj=function(elem){if($(elem).data('_passwordStrength')){return $(elem).data('_passwordStrength');}
return undefined;};ips.ui.registerWidget('passwordStrength',ips.ui.passwordStrength,['enforced','enforcedStrength','checkAgainstMember','checkAgainstRequest']);return{respond:respond,getObj:getObj,destruct:destruct};});var passwordStrengthObj=function(elem,options){var _popup=null,_passwordBlurred=false,_field=null,_dirty=false,_timer=null,_ajax=ips.getAjax();var ini},destruc},_passwordFocu},_passwordBlu},_clearResul},_passwordKeyEven},_changePassword=function(){var value=_field.val();var resultElem=_field.next('[data-role="validationCheck"]');var wrapper=elem.find('[data-role="strengthInfo"]');var meter=elem.find('[data-role="strengthMeter"]');var text=elem.find('[data-role="strengthText"]');if(_ajax&&_ajax.abort){_ajax.abort();}
if(value.length){_dirty=true;}else{if(!_dirty){return;}}
if(!meter.is(':visible')){ips.utils.anim.go('fadeInDown fast',wrapper);}
_field.addClass('ipsField_loading');var alsoCheckAgainst=new Array;if(options.checkAgainstRequest){var requestNames=JSON.parse(options.checkAgainstRequest);_.each(requestNames,function(value){if(elem.closest('form').find('input[name="'+value+'"]')){alsoCheckAgainst.push(elem.closest('form').find('input[name="'+value+'"]').val());}});}
if(options.checkAgainstMember){var memberValues=JSON.parse(options.checkAgainstMember);_.each(memberValue});}
_ajax(ips.getSetting('baseURL')+'?app=core&module=system&controller=ajax&do=passwordStrength',{dataType:'json',data:{input:value,checkAgainstRequest:alsoCheckAgainst},method:'post'}).don}).fail(function(){}).always(function(){_field.removeClass('ipsField_loading');});},_buildAdvicePopu},_positionAdvicePopu};init();return{destruct:destruct};};}(jQuery,_));;
}(jQuery,_));;
}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.quote',function(){var defaults={timestamp:'',userid:0,username:'',contenttype:'',contentclass:'',contentid:0};var respond=function(elem,options){if(elem.data('quoteBuilt')||elem.parents('.cke_wysiwyg_div').length){return;}
var existingCitation=elem.children('.ipsQuote_citation');var citation=ips.utils.getCitation(options,true,existingCitation.length?existingCitation.text():ips.getString('editorQuote'));var data={citation:citation,contenturl:options.contentid&&options.contentcommentid?ips.getSetting('baseURL')+"?app=core&module=system&controller=content&do=find&content_class="+options.contentclass+"&content_id="+options.contentid+"&content_commentid="+options.contentcommentid:''};var citation=ips.templates.render('core.editor.citation',data);if(existingCitation.length){existingCitation.replaceWith(citation);}else{elem.prepend(citation);}
elem.find('> .ipsQuote_citation').on('click',_toggleQuote);elem.find('> .ipsQuote_contents').addClass('ipsClearfix').attr('data-ipsTruncate',true).attr('data-ipsTruncate-type','hide').attr('data-ipsTruncate-size','7 lines').attr('data-ipsTruncate-expandText',ips.getString('expand_quote'));if(elem.is('blockquote.ipsQuote > blockquote.ipsQuote')){elem.find('> *:not( .ipsQuote_citation )').hide().end().find('> .ipsQuote_citation').removeClass('ipsQuote_open').addClass('ipsQuote_closed');}
elem.trigger('quoteBuilt.quote');elem.data('quoteBuilt',true);$(document).trigger('contentChange',[elem]);},_toggleQuot};ips.ui.registerWidget('quote',ips.ui.quote,['timestamp','userid','username','contentapp','contenttype','contentclass','contentid','contentcommentid']);return{respond:respond};});}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.selectTree',function(){var defaults={multiple:false,selected:false,searchable:true,placeholder:ips.getString('select')};var respon},getObj=function(elem){if($(elem).data('_selecttree')){return $(elem).data('_selecttree');}
return undefined;},destruct=function(elem){var obj=getObj(elem);if(!_.isUndefined(obj)){obj.destruct();}};var selectTreeObj=function(elem,options){var results=null,elemID=null,selectedItems=[],name='';var init=function(){elemID=elem.identify().attr('id');results=elem.find('.ipsSelectTree_nodes');name=elem.attr('data-name');elem.on('click',_toggleResults);elem.on('click','[data-action="getChildren"]',_toggleChildren);elem.on('click','[data-action="nodeSelect"]',_toggleNodeSelection);elem.on('click','[data-action="nodeLoadMore"] a:not(.ipsButton_disabled)',_nodeLoadMore);if($('input[name="'+name+'-zeroVal"]')){$('input[name="'+name+'-zeroVal"]').on('change',_zeroValChange);}
if(options.selected){try{var preSelected=$.parseJSON(options.selected);}catch(err){}
if(preSelected&&_.isObject(preSelected)&&_.size(preSelected)){_buildPreSelected(preSelected);return;}}
elem.find('.ipsSelectTree_value').addClass('ipsSelectTree_placeholder').text((options.placeholder)?options.placeholder:ips.getString('select'));_zeroValChange();},destruc},_buildPreSelecte},_zeroValChang},_toggleChildre},_toggleNodeSelectio},_nodeLoadMore=function(e){var offset=results.find('[data-action="nodeLoadMore"]').attr('data-offset');var url=options.url+'&_nodeSelect=loadMore&_nodeSelectOffset='+offset;results.find('[data-action="nodeLoadMore"] span.ipsLoading').removeClass('ipsHide');results.find('[data-action="nodeLoadMore"] > a.ipsButton').addClass('ipsButton_disabled');ips.getAjax()(url).done(function(response){if(!_.isUndefined(response.globalOutput)){results.find('[data-role="globalNodeList"]').append(response.globalOutput);if(!_.isUndefined(response.clubsOutput)){results.find('[data-role="clubNodeList"]').append(response.clubsOutput);}}
else{results.find('[data-role="nodeList"]').append(response.output);}
results.find('[data-action="nodeLoadMore"] span.ipsLoading').addClass('ipsHide');if(response.loadMore){results.find('[data-action="nodeLoadMore"]').attr('data-offset',response.loadMore);}
else{results.find('[data-action="nodeLoadMore"]').addClass('ipsHide');}
results.find('[data-action="nodeLoadMore"] > a.ipsButton').removeClass('ipsButton_disabled');results.find('[data-role="nodeList"]').find('.ipsSelectTree_item').eac});_positionResults();});},_selectNod},_unselectNod},_addToken=function(title,id){var valueElem=elem.find('.ipsSelectTree_value');var elemHeight=elem.outerHeight();if(!elem.find('[data-role="tokenList"]').length){valueElem.html($('<ul/>').addClass('ipsList_inline').attr('data-role','tokenList'));}
elem.find('[data-role="tokenList"]').append(ips.templates.render('core.selectTree.token',{title:title,id:id}));elem.find('.ipsSelectTree_value').removeClass('ipsSelectTree_placeholder');if(elemHeight!=elem.outerHeight()){_positionResults();}},_removeToke},_updateSelectedValue},_setValu},_toggleResult},_maybeHideResult},_closeResult},_showResult},_positionResults=function(){var above=false;var selectWidth=elem.outerWidth();var elemTop=elem.offset().top;var elemHeight=elem.height();if((elemTop+elemHeight+results.height())>$(window).height()){above=true;var scrollParent=_getScrollParent();var scrollParentTop=$(scrollParent).offset().top;Debug.log("elemTop: "+elemTop);Debug.log("elemTop - resultsHeight: "+(elemTop-results.height()));Debug.log("scrollParentTop: "+scrollParentTop);if((elemTop-results.height())<scrollParentTop){above=false;}}
var positionInfo={trigger:elem,target:results,targetContainer:elem,above:above};var resultsPosition=ips.utils.position.positionElem(positionInfo);results.css({top:resultsPosition.top+'px',left:String(-parseFloat(results.css('borderLeftWidth'))-parseFloat(results.css('marginLeft'))),position:'absolute',zIndex:ips.ui.zIndex(),minWidth:selectWidth+'px'});results.each(function(){this.style.setProperty('--ipsSelectTree-offset',elemHeight+'px');});if(resultsPosition.location.vertical=='top'){results.removeClass('ipsSelectTree_bottom').addClass('ipsSelectTree_top');elem.removeClass('ipsSelectTree_bottom').addClass('ipsSelectTree_top');}else{results.removeClass('ipsSelectTree_top').addClass('ipsSelectTree_bottom');elem.removeClass('ipsSelectTree_top').addClass('ipsSelectTree_bottom');}},_closeResultsOnBlu},_clickIsInEle},_getScrollParen}
init();return{destruct:destruct};};ips.ui.registerWidget('selectTree',ips.ui.selectTree,['placeholder','multiple','selected','url','searchable']);return{respond:respond,destruct:destruct};});}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.spoiler',function(){var respond=function(elem,options,e){if(!elem.find('.ipsSpoiler_contents').hasClass('ipsClearfix')){elem.find('.ipsSpoiler_contents').addClass('ipsClearfix');}
if(elem.parents('.cke_wysiwyg_div').length){return;}
elem.contents().hide();var existingHeader=elem.children('.ipsSpoiler_header');var header=ips.templates.render('core.editor.spoilerHeader');if(existingHeader.length){existingHeader.replaceWith(header);}else{elem.prepend(header);}
elem.find('> .ipsSpoiler_header').on('click',_toggleSpoiler);},_toggleSpoile};ips.ui.registerWidget('spoiler',ips.ui.spoiler);return{respond:respond}});}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.sticky',function(){var defaults={stickyClass:'ipsSticky',stickTo:'top',spacing:0,disableIn:'phone'};var respon},getObj=function(elem){if($(elem).data('_sticky')){return $(elem).data('_sticky');}
return undefined;},destruct=function(elem){var obj=getObj(elem);if(!_.isUndefined(obj)){obj.destruct();}};ips.ui.registerWidget('sticky',ips.ui.sticky,['stickyClass','relativeTo','spacing','stickTo','width','disableIn']);var stickyObj=function(elem,options){var relativeTo=false,originalStyles={},originalOffsetTop,status,dummyElem,locked=false;var _init=function(){if(!$(elem).is(':visible')){Debug.warn("Can't set up a sticky element if the element is hidden when init is called.");return;}
relativeTo=options.relativeTo?$(options.relativeTo):false;if(options.disableIn){options.disableIn=_.map(options.disableIn.split(','),function(item){return item.trim()});}
originalStyles={top:$(elem).css('top'),bottom:$(elem).css('bottom'),position:$(elem).css('position'),width:$(elem).get(0).style.width};status='normal';originalOffsetTop=$(elem).offset().top;_scrollDocument();$(document).on('scroll',_scrollDocument).on('breakpointChange',_breakpointChange);$(window).on('resize',_windowResize);$(elem).trigger('stickyInit',{id:$(elem).identify().attr('id'),status:status});},destruc},_breakpointChang},_windowResiz},_scrollDocumen},_makeFixed=function(offset){if(locked){return;}
var width;if(!dummyElem&&!relativeTo){_makeDummyElem();}
if(status=='fixed'&&!_.isUndefined(offset)){$(elem).css({top:(offset)+'px'});$('#ipsStickySpacer').remove();return;}
var bottomSpacing=$(document).height()-$(window).height()-$(document).scrollTop()-10;if(options.stickTo=='top'&&bottomSpacing<$(elem).outerHeight()){_makeBottomSpacer(bottomSpacing);}
if(options.width&&(options.width.indexOf('#')===0||options.width.indexOf('.')===0)){width=$(options.width).first().outerWidth();}else if(options.width){width=parseInt(options.width);}else{width=$(elem).css('width');}
$(elem).css({position:'fixed',width:width,zIndex:ips.ui.zIndex()}).addClass(options.stickyClass);if(options.stickTo=='bottom'){$(elem).css({bottom:options.spacing+'px'}).addClass(options.stickyClass+'_bottom');}else{$(elem).css({top:options.spacing+'px'}).addClass(options.stickyClass+'_top');}
if(!relativeTo){dummyElem.css({width:String($(elem).width()),height:String($(elem).outerHeight())}).show();}
status='fixed';$(elem).trigger('stickyStatusChange.sticky',{status:'fixed'});},_makeNormal=function(){$(elem).css({position:String(originalStyles.position),width:String(originalStyles.width)}).removeClass(options.stickyClass).removeClass(options.stickyClass+'_top')
if(options.stickTo=='bottom'){$(elem).css({bottom:String(originalStyles.bottom)}).removeClass(options.stickyClass+'_bottom');}else{$(elem).css({top:String(originalStyles.bottom)}).removeClass(options.stickyClass+'_top');}
if(dummyElem){dummyElem.hide();}
_makeBottomSpacer(0);status='normal';$(elem).trigger('stickyStatusChange.sticky',{status:'normal'});},_makeDummyEle},_makeBottomSpace};_init();return{destruct:destruct};};return{respond:respond,destruct:destruct};});}(jQuery,_));;
}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.tooltip',function(){var _animating=false,_tooltip=null,_timer=[],_currentElem=null;var respon},_calculatePosition=function(elem,_tooltip){var positionInfo={trigger:elem,target:_tooltip,center:true,above:true,stemOffset:{left:10,top:0}};var tooltipPosition=ips.utils.position.positionElem(positionInfo);$(_tooltip).css({left:tooltipPosition.left+'px',top:tooltipPosition.top+'px',position:(tooltipPosition.fixed)?'fixed':'absolute',zIndex:ips.ui.zIndex()});if(tooltipPosition.location.vertical=='top'){_tooltip.addClass('ipsTooltip_top').removeClass('ipsTooltip_bottom');}else{_tooltip.addClass('ipsTooltip_bottom').removeClass('ipsTooltip_top');}
_tooltip.removeClass('ipsTooltip_left').removeClass('ipsTooltip_right');if(tooltipPosition.location.horizontal=='left'){_tooltip.addClass('ipsTooltip_left');}else if(tooltipPosition.location.horizontal=='right'){_tooltip.addClass('ipsTooltip_right');}},_show=function(elem,options,content){elem=$(elem);ips.utils.anim.cancel(_tooltip);if(options.safe){_tooltip.hide().html(content);}else{_tooltip.hide().text(content);}
if(options.ajax&&!elem.data('_tooltip')){ips.getAjax()(options.ajax).done(function(response){elem.data('_tooltip',response);if(options.safe){_tooltip.html(response);}else{_tooltip.text(response);}
_calculatePosition(elem,_tooltip);}.bind(this));}
if(elem.attr('title')){elem.attr('_title',elem.attr('title')).removeAttr('title');}
_calculatePosition(elem,_tooltip);_tooltip.show();_currentElem=elem;_timer.push(setInterval(_checkForElemPresence,100));$(elem).trigger('tooltipShown');},_hid},_checkForElemPresenc},_getContent=function(elem,options){elem=$(elem);if(elem.data('_tooltip')){return elem.data('_tooltip');}
else if(options.label){if(options.json){return $.parseJSON(options.label).join("<br>");}else{return options.label;}}else if(elem.attr('aria-label')){return elem.attr('aria-label');}else if(elem.attr('_title')){return elem.attr('_title');}else if(elem.attr('title')){return elem.attr('title');}},_createTooltipElement=function(){var tooltip=ips.templates.render('core.tooltip',{id:'ipsTooltip'});ips.getContainer().append(tooltip);_tooltip=$('#ipsTooltip');};ips.ui.registerWidget('tooltip',ips.ui.tooltip,['label','extraClass','safe','json','ajax'],{lazyLoad:true,lazyEvents:'mouseenter mouseleave focus blur'});return{respond:respond};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.truncate',function(){var defaults={type:'remove',size:100,expandText:ips.getString('show_more'),watch:true};var respon},_removeTruncat},_hideTruncate=function(elem,options){if(elem.attr('data-truncated')){return;}
var size=_getSizeValue(options.size,elem);var originalSize=elem.outerHeight();var originalPos=$(elem).css('position');if(originalSize<=size.pixels){Debug.log('Smaller than the specified size, finishing...');return;}
if(originalPos=='static'){$(elem).css('position','relative');}
$(elem).css({height:size.pixels+'px'}).addClass('ipsTruncate');var showMore=ips.templates.render('core.truncate.expand',{text:options.expandText});$(elem).after(showMore);var expander=elem.next("[data-action='expandTruncate']");elem.trigger('contentTruncated',{type:'hide'});elem.attr('data-truncated',true);expander.on('click',function(e){elem.css({position:originalPos,height:''});var newOriginalSize=elem.outerHeight();elem.css({height:size.pixels+'px',position:(originalPos==='static')?'relative':originalPos});ips.utils.anim.go('fadeOutDown fast',expander).done(function(){expander.remove();});if(newOriginalSize>size.pixels){elem.animate({'height':newOriginalSize+'px'},{done:function(){elem.css({position:originalPos,height:''});elem.trigger('truncateExpanded');elem.removeClass('ipsTruncate');}});}else{elem.removeClass('ipsTruncate');}});},_getSizeValu},_getLineHeigh};ips.ui.registerWidget('truncate',ips.ui.truncate,['type','size','expandText','watch']);return{respond:respond};});}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.wizard',function(){var respon};var refresh=function(elem,e){var target=$(e.currentTarget);_showLoading(elem);if(target.is('form')){if(target.attr('data-bypassAjax')){return true;}
e.preventDefault();var data=target.serialize()+'&_wizardHeight='+elem.find('[data-role="loading"]').outerHeight();if(e.originalEvent&&e.originalEvent.submitter&&e.originalEvent.submitter.name&&e.originalEvent.submitter.value){data+='&'+e.originalEvent.submitter.name+'='+e.originalEvent.submitter.value;}
ips.getAjax()(target.attr('action'),{data:data,type:'post'}).done(function(response){_insertHtml(response,elem);}).fai})}else{e.preventDefault();ips.getAjax()(target.attr('href')).don});}},_insertHtm},_showLoading=function(elem){var loading=elem.find('[data-role="loading"]');var formContainer=elem.find('[data-role="wizardContent"]');if(!formContainer.is(':visible')){return;}
if(!loading.length){loading=$('<div/>').attr('data-role','loading').addClass('ipsLoading').hide();elem.append(loading);}
var dims={width:formContainer.outerWidth(),height:formContainer.outerHeight()};loading.css({width:dims.width+'px',height:dims.height+'px'}).show();formContainer.hide().after(loading.show());},_hideLoadin};ips.ui.registerWidget('wizard',ips.ui.wizard);return{respond:respond};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.lightbox});var lightboxObj=function(elem,options,e){if(e){e.preventDefault();}
var imageCollection=[],commentsAjax,modal,pieces,currentImage,phoneBreakpoint=false;var ini},destruc},_setUpEvents=function(){pieces.lightbox.on('click','.'+options.className+'_next',nextImage).on('click','.'+options.className+'_prev',prevImage).on('click','.'+options.className+'_close',close).on('click',clickedLightbox).on('click','[data-action="rotateImage"]',_rotateImage);modal.on('click',close);$(window).on('resize',_resize);$(document).on('keydown',_keyPress);$(document).on('imageUpdated',_updateImage);$(document).on('imageLoading',_mainImageLoading);if(options.useEvents){$(document).on('lightboxDisable_next',function(){$('.'+options.className+'_next').hide();});$(document).on('lightboxDisable_prev',function(){$('.'+options.className+'_prev').hide();});$(document).on('lightboxEnable_next',function(){$('.'+options.className+'_next').show();});$(document).on('lightboxEnable_prev',function(){$('.'+options.className+'_prev').show();});}},_mainImageLoadin},_updateImag},_resiz},_keyPres},_loadFirstImag},_showImage=function(image){_setLoading(true);pieces.imagePanel.find('.'+options.className+'_image ').hide();if(image.imageElem){pieces.imagePanel.find('.'+options.className+'_image ').hide()
var thisImage=image.imageElem.css({opacity:"0"}).show();_imageLoaded(thisImage);}else{var thisImage=image.imageElem=$('<img/>').attr('src',image.largeImage).addClass(options.className+'_image').css({opacity:"0"}).imagesLoade});if(!_.isUndefined($(image.elem).attr('data-fileId'))){thisImage.attr('data-fileId',$(image.elem).attr('data-fileId'));}
pieces.imagePanel.find('.'+options.className+'_image ').hide().end().append(thisImage);}
var rotatedImage=$('.ipsAttachLink_image img[data-rotate][data-fileId=\''+thisImage.attr('data-fileId')+'\']');if(rotatedImage.length){thisImage.attr('data-rotate',$(rotatedImage).attr('data-rotate'));_applyRotation(thisImage,$(rotatedImage).attr('data-rotate'));}
pieces.fullSize.attr('href',image.largeImage);if(image.commentsURL){_loadComments(image);}else{_hideCommentsPanel();}
if(image.meta){pieces.metaPanel.show().html(ips.templates.render('core.lightbox.meta',{title:image.meta}));}else{pieces.metaPanel.hide();}
$(elem).trigger('lightboxImageShown',{image:image,triggerElem:elem});},_loadComment},_hideCommentsPane},_setLoadin},_imageLoaded=function(image){image.css({opacity:"1"});_positionCenter(image);_setLoading(false);_setButtons(image);if(options.useEvents){return;}
if(imageCollection.length<2){pieces.next.hide();pieces.prev.hide();}else{var curPos=_.indexOf(imageCollection,currentImage);pieces.next.show();pieces.prev.show();if(curPos==0){pieces.prev.hide();}
if(curPos==(imageCollection.length-1)){pieces.next.hide();}}},_setButtons=function(image){if(!_.isUndefined(image.attr('data-fileId'))){$(document).trigger('contentChange',[$('.'+options.className)]);}},_positionCente},clickedLightbo},nextImage=function(e){e.preventDefault();e.stopPropagation();if(options.useEvents){$(document).trigger('lightboxNextImage');return;}
currentImage=_getNextImage();_showImage(currentImage);},prevImag},_getPrevImag},_getNextImag},_rotateImage=function(e){e.preventDefault();var visibleImage=$('img.ipsLightbox_image:visible');var url=$(e.currentTarget).attr('href')+'&current='+$(visibleImage).attr('data-rotate');ips.getAjax()(url,{showLoading:true}).done(function(response){$('img[data-fileId="'+response.fileId+'"]').each(function(){$(visibleImage).attr('data-rotate',response.rotate);_applyRotation(this,response.rotate);if(response.saved==1){$(document).trigger('imageRotated',response);}});ips.ui.flashMsg.show(response.message);}).fai});},_applyRotation=function(elem,angle){$(elem).css({'transform':'rotate('+angle+'deg)'});if(angle=='90'||angle=='-90'){var panelHeight=$(elem).parents('.ipsLightbox_imagePanel').height();$(elem).css({'max-width':(panelHeight-20).toString()+'px'});}},clos},_sho},_buildWrapper=function(){pieces={lightbox:$('<div/>').addClass(options.className).css({zIndex:ips.ui.zIndex()}),imagePanel:$('<div/>').addClass(options.className+'_imagePanel'),commentsPanel:$('<div/>').addClass(options.className+'_commentsPanel').html('').hide(),toolsPanel:$('<div/>').addClass(options.className+'_toolsPanel').html('').hide(),next:$('<a/>').addClass(options.className+'_next').html("<i class='fa fa-angle-right'></i>"),prev:$('<a/>').addClass(options.className+'_prev').html("<i class='fa fa-angle-left'></i>"),close:$('<a/>').addClass(options.className+'_close').html("&times;"),fullSize:$('<a/>').attr('href','#').attr('target','_blank').addClass(options.className+'_fullSize'),metaPanel:$('<div/>').addClass(options.className+'_meta').hide()};pieces.lightbox.append(pieces.imagePanel.append(pieces.next).append(pieces.prev).append(pieces.fullSize)).append(pieces.metaPanel).append(pieces.commentsPanel).append(pieces.toolsPanel).append(pieces.close);$('body').append(pieces.lightbox);},_getAllImage},_returnImageDat},_buildModa};init();return{destruct:destruct};};}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.addressForm',function(){var defaults={minimize:false,country:"",requireFullAddress:true};var respon};var ini};var googlePlacesCallback=function(){$(window).trigger('googlePlacesLoaded');};var minimizeAddress=function(elem,options){var tempInput=$('<input/>').attr('type','text').attr('data-role','minimizedVersion').attr('placeholder',ips.getString('specifyLocation')).on('focus});var value=[];elem.find('input, select').each(function(addressPart){if($(this).val()){if($(this).is('select')){value.push($(this).find('option[value="'+$(this).val()+'"]').text().trim());}else{value.push($(this).val().trim());}}});if(value.length){tempInput.val(value.join(', '));}
elem.hide().after(tempInput);};var countryChang};var addAddressLin};var recalculateAddAddressLineButto};var googlePlacesInit=function(elem){var googlePlacesInput=$(elem).find('[data-role="addressLine"]').first();var options={types:['geocode'],componentRestrictions:{country:$(elem).find('[data-role="countrySelect"]').val()}};var autocomplete=new google.maps.places.Autocomplete(googlePlacesInput.get(0),options);googlePlacesInput.on('focus});googlePlacesInput.on('keypress});google.maps.event.addListener(autocomplete,'place_changed',function(){var place=autocomplete.getPlace();for(var i=0;i<$(elem).find('[data-role="addressLine"]').length;i++){$(elem).find('[data-role="addressLine"]').val('');}
var parsedAddress=$('<div>'+place.adr_address+'</div>');var addressLines=[];var existingAddressLines=$(elem).find('[data-role="addressLine"]').length;if(parsedAddress.find('.post-office-box').length){addressLines.push(parsedAddress.find('.post-office-box').text());}
if(parsedAddress.find('.street-address').length){addressLines.push(parsedAddress.find('.street-address').text());}
if(parsedAddress.find('.extended-address').length){addressLines.push(parsedAddress.find('.extended-address').text());}
for(var i=0;i<addressLines.length;i++){if(existingAddressLines){$(elem).find('[data-role="addressLine"]').slice(i,1).focus().val(addressLines[i]);existingAddressLines--;}else{addAddressLine(elem,addressLines[i]);}}
if(parsedAddress.find('.locality')){elem.find('[data-role="city"]').focus().val(parsedAddress.find('.locality').text());}
if(parsedAddress.find('.region')){elem.find('[data-role="regionText"]').focus().val(parsedAddress.find('.region').text());if(elem.find('[data-role="regionSelect"] option[value="'+parsedAddress.find('.region').text()+'"]').length){elem.find('[data-role="regionSelect"]').val(parsedAddress.find('.region').text());}else{var i;for(i in place.address_components){if(place.address_components[i].types[0]==='administrative_area_level_1'||place.address_components[i].types[0]==='administrative_area_level_2'){if(elem.find('[data-role="regionSelect"] option[value="'+place.address_components[i].long_name+'"]').length){elem.find('[data-role="regionSelect"]').val(place.address_components[i].long_name);break;}else if(elem.find('[data-role="regionSelect"] option[value="'+place.address_components[i].short_name+'"]').length){elem.find('[data-role="regionSelect"]').val(place.address_components[i].short_name);break;}}}}}
if(parsedAddress.find('.postal-code')){elem.find('[data-role="postalCode"]').focus().val(parsedAddress.find('.postal-code').text());}});}
ips.ui.registerWidget('addressForm',ips.ui.addressForm,['minimize','country','requireFullAddress']);return{respond:respond,googlePlacesCallback:googlePlacesCallback};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.alert});var alertObj=function(options){var alert=null,modal=null;var _defaults={type:'alert',message:ips.getString('generic_confirm'),buttons:{ok:ips.getString('ok'),cancel:ips.getString('cancel'),yes:ips.getString('yes'),no:ips.getString('no')},icon:'info',showIcon:true,callbacks:{}};var _icons={warn:'fa fa-exclamation-triangle',success:'fa fa-check-circle',info:'fa fa-info-circle',ok:'fa fa-check-circle',question:'fa fa-question-circle'};options=_.defaults(options||{},_defaults);var ini},_setUpEvent},_clickButto},_remov},_buildAlert=function(){var parts={},buttons=[];if(options.showIcon){parts.icon=ips.templates.render('core.alert.icon',{icon:_icons[options.icon]||options.icon});}
parts.id='alert_'+(Math.round(Math.random()*10000000));parts.text=options.message;if(options.subText){parts.subtext=ips.templates.render('core.alert.subText',{text:options.subText});}
if(options.subTextHtml){parts.subtext=ips.templates.render('core.alert.subTextHtml',{text:options.subTextHtml});}
switch(options.type){case'alert':buttons.push(ips.templates.render('core.alert.button',{action:'ok',title:options.buttons.ok,extra:'ipsButton_primary'}));break;case'confirm':case'prompt':buttons.push(ips.templates.render('core.alert.button',{action:'ok',title:options.buttons.ok,extra:'ipsButton_primary'}));buttons.push(ips.templates.render('core.alert.button',{action:'cancel',title:options.buttons.cancel,extra:'ipsButton_light'}));break;case'verify':buttons.push(ips.templates.render('core.alert.button',{action:'yes',title:options.buttons.yes,extra:'ipsButton_primary'}));if(options.buttons.no){buttons.push(ips.templates.render('core.alert.button',{action:'no',title:options.buttons.no,extra:'ipsButton_light'}));}
if(options.buttons.cancel){buttons.push(ips.templates.render('core.alert.button',{action:'cancel',title:options.buttons.cancel,extra:'ipsButton_light'}));}
break;}
parts.buttons=buttons.join('');if(options.type=='prompt'){parts.text+=ips.templates.render('core.alert.prompt');}
var tmpAlert=$.parseHTML(ips.templates.render('core.alert.box',parts).trim());alert=$(tmpAlert[0]);$('body').append(alert);modal=ips.ui.getModal();modal.css({zIndex:ips.ui.zIndex()}).show();alert.css({zIndex:ips.ui.zIndex()});ips.utils.anim.go('zoomIn fast',alert);if(options.focus){alert.find('[data-action="'+options.focus+'"]').focus();}else{if(options.type=='prompt'){alert.find('[data-role="promptValue"]').val(options.value||'').focus();}else{alert.find('[data-action="ok"], [data-action="yes"]').focus();}}};init();};}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.autoCheck});var autoCheckObj=function(elem,options){var initialCount=0;var init=function(){if(options.context&&$(options.context).length){elem.on('menuItemSelected',clickedMenu);$(options.context).on('change','input[type="checkbox"][data-state]',_updateCount);}
elem.on('refresh.autoCheck',refresh);elem.on('setInitialCount.autoCheck',setInitialCount);elem.find('[data-role="autoCheckCount"]').hide();},destruc},refresh=function(){_updateCount();},setInitialCoun},clickedMen},_updateCount=function(){var checkboxes=$(options.context).find(':checkbox[data-state]');var count=$(options.context).find(':checkbox[data-state]:checked');if(count.length==checkboxes.length&&checkboxes.length!==0){elem.find('.cAutoCheckIcon').html('<i class="fa fa-check-square"></i>');}else if(count.length===0){elem.find('.cAutoCheckIcon').html('<i class="fa fa-square-o"></i>');}else{elem.find('.cAutoCheckIcon').html('<i class="fa fa-minus-square"></i>');}
var countToDisplay=count.length+initialCount;if(countToDisplay){elem.find('[data-role="autoCheckCount"]').text(countToDisplay).show();}else if(elem.find('[data-role="autoCheckCount"]').is(':visible')){setTimeout(function(){if(!initialCount){ips.utils.anim.go('fadeOut',elem.find('[data-role="autoCheckCount"]'));}},300);}
return count.length;};init();return{destruct:destruct,refresh:refresh};};}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.autocomplete',function(){var defaults={multiValues:true,freeChoice:true,itemSep:{chr:',',keycode:188,charcode:44},disallowedCharacters:JSON.stringify(["<",">","'","\""]),unique:false,customValues:true,fieldTemplate:'core.autocomplete.field',resultsTemplate:'core.autocomplete.resultWrapper',resultItemTemplate:'core.autocomplete.resultItem',tokenTemplate:'core.autocomplete.token',addTokenTemplate:'core.autocomplete.addToken',addTokenText:ips.getString('add_tag'),queryParam:'q',forceLower:false,minLength:1,minAjaxLength:1,commaTrigger:true,searchFieldThreshold:20};var respond=function(elem,options){if(!$(elem).data('_autocomplete')){$(elem).data('_autocomplete',autocompleteObj(elem,_.defaults(options,defaults)));}},destruct=function(elem){var obj=getObj(elem);if(!_.isUndefined(obj)){obj.destruct();}},getObj=function(elem){elem=$(elem);if(elem.data('_autocomplete')){return elem.data('_autocomplete');}else if($('[name="'+elem.attr('name')+'_original'+'"]').length&&$('[name="'+elem.attr('name')+'_original'+'"]').data('_autocomplete')){return $('[name="'+elem.attr('name')+'_original'+'"]').data('_autocomplete');}
return undefined;};ips.ui.registerWidget('autocomplete',ips.ui.autocomplete,['multiValues','freeChoice','dataSource','maxItems','itemSep','resultsElem','unique','commaTrigger','fieldTemplate','resultsTemplate','resultItemTemplate','tokenTemplate','addTokenTemplate','addTokenText','queryParam','minLength','maxLength','forceLower','disallowedCharacters','minAjaxLength']);return{respond:respond,destruct:destruct,getObj:getObj};});var autocompleteObj=function(elem,options,e){var timer,blurTimer,lastValue='',originalTextField,valueField,textField,dataSource,elemID=$(elem).identify().attr('id'),wrapper,inputItem,resultsElem,selectedToken,disabled=false,required=false,tooltip=null,tooltipTimer=null,mouseOverResults=false,hasError=false;var init=function(){if($(elem).is('textarea, input[type="text"], input[type="search"]')){originalTextField=$(elem);}else{originalTextField=$(elem).find('textarea, input[type="text"], input[type="search"]').first();}
try{options.disallowedCharacters=$.parseJSON(options.disallowedCharacters);}catch(err){Debug.error("Couldn't parse disallowed characters option");}
_buildWrapper();_getDataSource();originalTextField.removeAttr('list');if(dataSource.type!='none'){_buildResultsList();if(dataSource.type=='local'){_initAutocomplete();}}
if(originalTextField.is(':disabled')){disabled=true;}
if(originalTextField.is('[required]')){required=true;originalTextField.removeProp('required').removeAttr('aria-required');}
textField.prop('autocomplete','off').prop('spellcheck',false).prop('disabled',disabled).attr('aria-autocomplete','list').attr('aria-haspopup','true').attr('tabindex',originalTextField.attr('tabindex')||'');if(options.maxLength){textField.attr('maxlength',options.maxLength+1);}
$(document).on('click',_documentClick);wrapper.click(function(e){e.stopPropagation();return false;});textField.on('focus',_focusField).on('blur',_blurField).on('keydown',_keydownField).on('keyup',_keyupField).on('input',_expandField).on('keypress',_keypressField);wrapper.on('click',_clickWrapper).on('click','[data-action="addToken"]',_clickAddToken).on('keydown',_keydownWrapper).on('propChanged',_propChanged).toggleClass('ipsField_autocompleteDisabled',disabled);_buildInitialTokens();elem.on('blur}).trigger('autoCompleteReady',{elemID:elemID,elem:elem,currentValues:tokens.getValues()});elem.on('reissueReady});},destruct=function(){$(document).off('click',_documentClick);},hasError},_propChanged=function(e){disabled=originalTextField.is(':disabled');wrapper.toggleClass('ipsField_autocompleteDisabled',disabled);},_buildInitialToken},_getOriginalValu},_buildResultsLis},_initAutocomplete=function(){if(dataSource.totalItems()>options.searchFieldThreshold&&!options.freeChoice){var searchField=ips.templates.render('core.autocomplete.searchTypeAhead',{});$('#'+elemID+'_results').prepend(searchField);$('#'+elemID+'_results').on('keyup','input[type="search"]',_keyupAutocomplete);}},_keyupAutocomplete=function(e){_loadResults($(this).val());return true;},_buildWrappe},_getDataSourc},_clickWrappe},_clickAddToke},focu},_focusField=function(e){if(dataSource.type=='none'){return;}
timer=setInterval(_timerFocusField,400);},_blurFiel},_timerBlurFiel},_timerFocusField=function(){if(dataSource.type=='none'){return;}
var currentValue=_getCurrentValue();if(currentValue==lastValue){return;}
lastValue=currentValue;_loadResults(currentValue);},_loadResults=function(value){_toggleLoading('show');resultsElem.attr('aria-busy','true');dataSource.getResults(value).done(function(results){_showResults(_processResults(results,value));}).fail(function(){}).always(function(){resultsElem.attr('aria-busy','false');_toggleLoading('hide');});},_toggleLoading=function(doWhat){if(doWhat=='show'){wrapper.addClass('ipsField_loading');}else{wrapper.removeClass('ipsField_loading');}},_closeResults=function(e){if(e){e.preventDefault();}
if(resultsElem&&resultsElem.length){resultsElem.hide().attr('aria-expanded','false');if(resultsElem.find('input[type="search"]').length){resultsElem.find('input[type="search"]').val('');}}
dataSource.stop();},_documentClick=function(){_closeResults();},_processResult},_showResults=function(results){var output='';$.each(results,function(idx,value){output+=ips.templates.render(options.resultItemTemplate,value);});if(resultsElem.attr('id')==(elemID+'_results')){_positionResults();}
resultsElem.find('[data-role="items"] li').remove();resultsElem.show().attr('aria-expanded','true').find('[data-role="items"]').append(output);if(resultsElem.find('input[type="search"]').length){resultsElem.find('input[type="search"]').focus();}},_positionResults=function(){$(resultsElem).css({left:"0px",top:wrapper.outerHeight()+'px',width:wrapper.outerWidth()+'px',position:'absolute',zIndex:ips.ui.zIndex()});},_getCurrentValue=function(){var value=textField.val();if(options.multiValues){if(value.indexOf(options.itemSep.chr)===-1||!options.commaTrigger){return value.trim();}else{var pieces=value.split(options.itemSep.chr);return pieces[pieces.length-1].trim();}}else{return value;}},_keydownWrapper=function(e){if(e.which==ips.ui.key.ESCAPE){keyEvents.escape(e);}},_keydownField=function(e){_expandField();var ignoreKey=false;if(!_([ips.ui.key.UP,ips.ui.key.DOWN,ips.ui.key.LEFT,ips.ui.key.RIGHT,ips.ui.key.ENTER,ips.ui.key.TAB,ips.ui.key.BACKSPACE,ips.ui.key.ESCAPE]).contains(e.which)){ignoreKey=true;}
var value=textField.val().trim();if(!value.length){hasError=false;}
if(options.maxLength&&value.length==options.maxLength&&ignoreKey){e.preventDefault();return;}
if(_([ips.ui.key.ENTER,ips.ui.key.TAB]).contains(e.which)&&options.unique&&_duplicateValue(value)){e.preventDefault();_showTooltip(ips.getString('ac_dupes'));return;}
if(ignoreKey){return;}
switch(e.which){case ips.ui.key.BACKSPACE:keyEvents.backspace(e);break;case ips.ui.key.TAB:case ips.ui.key.ENTER:keyEvents.enter(e);break;case ips.ui.key.UP:keyEvents.up(e);break;case ips.ui.key.DOWN:keyEvents.down(e);break;case ips.ui.key.ESCAPE:keyEvents.escape(e);break;}},_keyupFiel},_keypressFiel},_addToke},_deleteToken=function(token){if(disabled){return;}
tokens.remove(token);},keyEvents={backspac},ente},up:function(e){if(!resultsElem||!resultsElem.is(':visible')){return;}
e.preventDefault();var selected=results.getCurrent();if(!selected){results.selectLast();}else{var prev=results.getPrevious(selected);if(prev){results.select(prev);}else{results.selectLast();}}},down:function(e){if(!resultsElem||!resultsElem.is(':visible')){return;}
e.preventDefault();var selected=results.getCurrent();if(!selected){results.selectFirst();}else{var next=results.getNext(selected);if(next){results.select(next);}else{results.selectFirst();}}},escape:function(e){if(resultsElem&&resultsElem.is(':visible')){_closeResults();}}},results={deselectAll:function(){resultsElem.find('[data-selected]').removeAttr('data-selected');},getCurrent:function(){if(dataSource.type=='none'){return;}
var cur=resultsElem.find('[data-selected]');if(cur.length&&resultsElem.is(':visible')){return cur;}
return false;},getPrevious:function(result){var prev=$(result).prev('[data-value]');if(prev.length){return prev;}
return false;},getNext:function(result){var next=$(result).next('[data-value]');if(next.length){return next;}
return false;},selectFirst:function(){results.select(resultsElem.find('[data-value]').first());},selectLast:function(){results.select(resultsElem.find('[data-value]').last());},select:function(result){results.deselectAll();result.attr('data-selected',true);}},tokens={selected:null,add:function(value){var html='';value=_.escape(value).trim();if(options.minLength&&value.length<options.minLength){return false;}
if(options.maxLength&&value.length>options.maxLength){return false;}
if(options.forceLower){value=value.toLowerCase();}
tokens.deselectAll();inputItem.before(ips.templates.render(options.tokenTemplate,{id:elemID,value:value,title:value}));if(resultsElem){_closeResults();}
valueField.val(tokens.getValues().join("\n"));if(dataSource.type!='none'){html=resultsElem.find('[data-value="'+value.replace("\\","\\\\")+'"]').html();}else{html=value;}
elem.trigger('tokenAdded',{token:value,html:html,tokenList:tokens.getValues(),totalTokens:tokens.total()});return true;},remov},removeAl},selec},tota},getValue},getSelecte},deselectAl}},_addTokenFromCurrentInpu},_duplicateValue=function(value){var values=tokens.getValues();if(values.indexOf(value)!==-1){return true;}
return false;},_stripHTML=function(text){return text.replace(/<|>|"|'/g,'');},_showToolti},_hideToolti},_positionToolti},_buildToolti},_expandField=function(){var text=textField.val();var widthOfElem=wrapper.width();widthOfElem-=(parseInt(wrapper.css('padding-left'))+parseInt(wrapper.css('padding-right')));var span=$('<span/>').text(text).css({'font-size':textField.css('font-size'),'letter-spacing':textField.css('letter-spacing'),'position':'absolute','top':'-100px','left':'-300px','opacity':"0.1"});ips.getContainer().append(span);var width=span.width()+20;span.remove();textField.css({width:((width>=widthOfElem)?widthOfElem:width)+'px'});},_resetField=function(){textField.css({width:'15px'});};init();return{init:init,destruct:destruct,hasErrors:hasErrors,addToken:tokens.add,getTokens:tokens.getValues,removeToken:tokens.remove,removeAll:tokens.removeAll,focus:focus};};var localDat};var remoteDat};var noData=function(){return{type:'none',getResults:$.noop,totalItems:-1,stop:$.noop};};}(jQuery,_));};}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.carousel',function(){var defaults={item:".ipsCarousel_item",shadows:true};var respond=function(elem,options){if(!$(elem).data('_carousel')){$(elem).data('_carousel',carouselObj(elem,_.defaults(options,defaults)));}},destruct=function(elem){var obj=getObj(elem);if(!_.isUndefined(obj)){obj.destruct();}},getObj=function(elem){if($(elem).data('_carousel')){return $(elem).data('_carousel');}
return undefined;};var carouselObj=function(elem,options){var rtlMode=($('html').attr('dir')=='rtl');var currentItemCount=0;var currentStartPos=0;var currentFirstItem=null;var ui={};var slideshowTimer=null;var slideshowTimeout=4000;var animating=false;var init=function(){currentItemCount=elem.find(options.item);ui={itemList:elem.find('[data-role="carouselItems"]'),next:elem.find('[data-action="next"]'),prev:elem.find('[data-action="prev"]'),nextShadow:elem.find('.ipsCarousel_shadowRight'),prevShadow:elem.find('.ipsCarousel_shadowLeft')};if(!options.shadows){ui.nextShadow.hide();ui.prevShadow.hide();}
var startPos=rtlMode?parseInt(ui.itemList.css('right')):parseInt(ui.itemList.css('left'));if(!_.isNaN(startPos)){currentStartPos=startPos;}
_build();var images=elem.find('img[src]').length;elem.find('img[src]').loa});_checkNav();elem.on('click',"[data-action='next']",_navNext);elem.on('click',"[data-action='prev']",_navPrev);elem.on('contentTruncated',_updateHeight);elem.on('gridRedraw.grid',_updateHeight);_setMaxWidth();var mc=new Hammer(elem[0]);mc.on('panleft',function(e){if(!animating){if(rtlMode){_navPrev();}else{_navNext();}}});mc.on('panright});if(options.slideshow){slideshowTimer=setTimeout(_slideshowNext,slideshowTimeout);elem.on('mouseenter}).on('mouseleave});}
$(window).on('resize',_resize);},destruc},_buil},_updateHeigh},_slideshowNex},_navNext=function(e){if(e){e.preventDefault();}
var items=elem.find(options.item);var wrapperWidth=elem.outerWidth();var listWidth=_getCurrentWidth();var forceNext=false;var deferred=$.Deferred();var nextFirst=_.find(items,function(item,idx){if(forceNext){return true;}
var width=$(item).outerWidth();var adjustedStartPos=currentStartPos;var stayOnScreen=adjustedStartPos+wrapperWidth;if(rtlMode){var margin=parseInt($(item).css('marginLeft'));var startEdge=ui.itemList.outerWidth()-($(item).position().left+width)-margin;var endEdge=startEdge+width;if(startEdge<adjustedStartPos){return false;}
if((endEdge==stayOnScreen||startEdge==stayOnScreen&&endEdge>adjustedStartPos)){forceNext=true;}
if(startEdge<stayOnScreen&&endEdge>stayOnScreen){return true;}
if(startEdge>stayOnScreen){return true;}}else{var margin=parseInt($(item).css('marginRight'));var startEdge=$(item).position().left;var endEdge=startEdge+width;if(startEdge<adjustedStartPos){return false;}
if((endEdge==stayOnScreen||startEdge==currentStartPos&&endEdge>stayOnScreen)){forceNext=true;}
if(startEdge<stayOnScreen&&endEdge>stayOnScreen){return true;}
if(startEdge>stayOnScreen){return true;}}
return false;});var nextFirst=$(nextFirst);if(!nextFirst.length){deferred.resolve();return deferred.promise();}
if(rtlMode){var nextFirstMargin=parseInt($(nextFirst).css('marginLeft'));var nextFirstPos=ui.itemList.outerWidth()-(nextFirst.position().left+nextFirst.outerWidth())-nextFirstMargin;}else{var nextFirstMargin=parseInt($(nextFirst).css('marginRight'));var nextFirstPos=nextFirst.position().left;}
if((listWidth-nextFirstPos)<wrapperWidth){nextFirstPos=listWidth-wrapperWidth;}
currentStartPos=nextFirstPos;animating=true;ui.itemList.animate((rtlMode)?{right:(nextFirstPos*-1)+'px'}:{left:(nextFirstPos*-1)+'px'},'slow',function(){_checkNav();animating=false;deferred.resolve();});return deferred.promise();},_navPrev=function(e,backToBeginning){if(e){e.preventDefault();}
var items=elem.find(options.item).toArray();var wrapperWidth=elem.find('.ipsCarousel_inner').outerWidth();var listWidth=_getCurrentWidth();var stayOnScreen=currentStartPos+wrapperWidth;var forcePrev=false;var deferred=$.Deferred();var idealStartPos=(currentStartPos*-1)+wrapperWidth;if(idealStartPos>=0||backToBeginning){currentStartPos=0;animating=true;ui.itemList.animate((rtlMode)?{right:'0px'}:{left:'0px'},'slow});deferred.resolve();return deferred.promise();}
items.reverse();idealStartPos=(idealStartPos*-1)+wrapperWidth;var prevFirst=_.find(items,function(item){if(forcePrev){return true;}
var width=$(item).outerWidth();if(rtlMode){var margin=parseInt($(item).css('marginLeft'));var leftPos=$(item).position().left;var startEdge=ui.itemList.outerWidth()-(leftPos+width)-margin;var endEdge=startEdge+width;}else{var startEdge=$(item).position().left;var endEdge=startEdge+width;var margin=parseInt($(item).css('marginRight'));}
if(startEdge>idealStartPos){return false;}
if(stayOnScreen<=(endEdge+margin)||(startEdge<idealStartPos&&endEdge>idealStartPos)){forcePrev=true;return false;}
if(endEdge>idealStartPos&&startEdge<=idealStartPos){return true;}
return false;});prevFirst=$(prevFirst);if(!ips.utils.responsive.currentIs('phone')&&!options.fullSizeItems){prevFirst=$(prevFirst).next(options.item);}
currentFirstItem=prevFirst;if(prevFirst.position()!=null){currentStartPos=prevFirst.position().left+prevFirst.outerWidth()-wrapperWidth;if(rtlMode){var prevFirstMargin=parseInt($(prevFirst).css('marginLeft'));currentStartPos=ui.itemList.outerWidth()-(prevFirst.position().left)-prevFirstMargin-wrapperWidth;}}else{currentStartPos=prevFirst.outerWidth()+wrapperWidth;}
animating=true;ui.itemList.animate((rtlMode)?{right:(currentStartPos*-1)+'px'}:{left:(currentStartPos*-1)+'px'},'slow});return deferred.promise();},_getMaxHeigh},_setMaxWidth=function(){elem.get(0).style.setProperty('--carousel-maxWidth',elem.width()+'px');},_checkNa},_getCurrentWidt},_buildNav=function(){elem.find('.ipsCarousel_nav').removeClass('ipsHide');},_resize=function(){if(options.fullSizeItems){var elemWidth=elem.find('.ipsCarousel_inner').outerWidth(true);elem.find(options.item).eac});}
_setMaxWidth();};init();return{destruct:destruct};};ips.ui.registerWidget('carousel',ips.ui.carousel,['showDots','fullSizeItems','slideshow','shadows']);return{respond:respond,destruct:destruct};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.chart',function(){var defaults={};var respond=function(elem,options){var doIni};try{doInit();}catch(err){ips.loader.get(['https://www.gstatic.com/charts/loader.js']).then(function(){google.charts.load('47',{'packages':['corechart','gauge','table'],'callback':doInit});});}},destruct=function(elem){var obj=getObj(elem);if(!_.isUndefined(obj)){obj.destruct();}},getObj=function(elem){if($(elem).data('_chart')){return $(elem).data('_chart');}
return undefined;};var chartObj=function(elem,options){var data=new google.visualization.DataTable();var headerTypes={};var extraOptions={};var chartElem=$(elem).next();var chart=null;var init=function(){elem.find('thead th').eac});elem.find('tbody tr').each(function(){var row=[];$(this).find('td').each(function(idx){if(headerTypes[idx]=='number'){var val;if(val=$(this).text()){val=Number(val);}else{val=null;}}else if(headerTypes[idx]=='date'||headerTypes[idx]=='datetime'||headerTypes[idx]=='timeofday'){var val=new Date($(this).text());}else{var val=$(this).text();}
if(!_.isNaN(val)){if($(this).attr('data-key')){val={v:$(this).attr('data-key'),f:val};}
row.push(val);}});data.addRow(row);});if(options.format){var formatter=new google.visualization.NumberFormat({pattern:'# '+options.format});formatter.format(data,1);}
extraOptions=$.parseJSON(options.extraOptions);if(!_.isUndefined(extraOptions.height)){chartElem.css({height:extraOptions.height+'px'});}else{chartElem.css({minHeight:'250px'});}
elem.hide().after(chartElem);$(window).on('resize',drawChart);drawChart();google.visualization.events.addListener(chart,'ready});$(document).on('tabShown',tabShown);},drawChar},destruc},tabShow};if(_.isUndefined(google.visualization)){google.setOnLoadCallback(init);}else{init();}
return{init:init,drawChart:drawChart};};ips.ui.registerWidget('chart',ips.ui.chart,['type','extraOptions','format']);return{respond:respond,destruct:destruct,getObj:getObj};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.contentItem});var contentItemObj=function(elem,options,e){var timer,blurTimer,lastValue='',originalTextField,valueField,hiddenValueField,itemListWrapper,textField,dataSource,elemID=$(elem).identify().attr('id'),wrapper,inputItem,resultsElem,disabled=false,required=false,tooltip=null,tooltipTimer=null;var ini},destruc},_propChange},_buildResultsLis},_buildWrappe},_getDataSourc},_clickWrappe},_focusFiel},_blurFiel},_timerBlurField=function(){_closeResults();},_timerFocusFiel},_loadResult},_toggleLoadin},_closeResult},_documentClic},_processResult},_showResult},_positionResult},_getCurrentValu},_keydownWrappe},_keydownField=function(e){_expandField();var ignoreKey=false;if(!_([ips.ui.key.UP,ips.ui.key.DOWN,ips.ui.key.ESCAPE,ips.ui.key.ENTER]).contains(e.keyCode)){ignoreKey=true;}
var value=textField.val().trim();if(ignoreKey){return;}
switch(e.keyCode){case ips.ui.key.UP:keyEvents.up(e);break;case ips.ui.key.DOWN:keyEvents.down(e);break;case ips.ui.key.ESCAPE:keyEvents.escape(e);break;case ips.ui.key.ENTER:keyEvents.enter(e);break;}},_addContentIte},_deleteContentIte},keyEvents={up:function(e){if(!resultsElem||!resultsElem.is(':visible')){return;}
e.preventDefault();var selected=results.getCurrent();if(!selected){results.selectLast();}else{var prev=results.getPrevious(selected);if(prev){results.select(prev);}else{results.selectLast();}}},dow},ente},escap}},results={deselectAl},getCurren},getPrevious:function(result){var prev=$(result).prev('[data-id]');if(prev.length){return prev;}
return false;},getNex},selectFirst:function(){results.select(resultsElem.find('[data-id]').first());},selectLas},selec}},contentItems={selected:null,ad},remov},tota},getValue}},_duplicateValu},_expandFiel},_resetFiel};init();return{init:init,destruct:destruct,addContentItem:contentItems.add,getContentItem:contentItems.getValues,removeContentItem:contentItems.remove};};var remoteDat};var noDat};}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.copy',function(){var respond=function(elem,options,e){ips.loader.get(['core/interface/clipboard/clipboard.min.js']).then(function(){if(ClipboardJS.isSupported()){elem.find('[data-role="copyButton"]').show();var clipboard=new ClipboardJS(elem.find('[data-role="copyButton"]').get(0));clipboard.on('success',function(e){elem.find('[data-role="copyButton"]').text(ips.getString('copied'));});}});};ips.ui.registerWidget('copy',ips.ui.copy,[]);return{respond:respond,};});}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.editor',function(){var defaults={allbuttons:false,postKey:'',toolbars:'',extraPlugins:'',contentsCss:'',minimized:false,autoSaveKey:null,skin:'ips',autoGrow:true,pasteBehaviour:'rich',autoEmbed:true,controller:null,defaultIfNoAutoSave:false,minimizeAfterReset:false};var respond=function(elem,options){var loadTries=0;var fileToLoad=ips.getSetting('useCompiledFiles')!==true?'core/dev/ckeditor/ckeditor.js':'core/interface/ckeditor/ckeditor/ckeditor.js';if(!options.minimized||ips.getSetting('memberID')){ips.loader.get([fileToLoad]).then(bootEditor);}else{$(elem).data('_editorInit',function(callback){$(elem).find('.ipsComposeArea_dummy').html(ips.templates.render('core.editor.initLoading'));ips.loader.get([fileToLoad]).then(function(){bootEditor(callback);});});$(elem).find('.ipsComposeArea_dummy').show().on('focus',function(){$(elem).data('_editorInit')(function(instance){instance.unminimize(function(){var inputs=elem.closest('.ipsComposeArea').find('input[type="text"], input[type="email"]');if(inputs.length){inputs[0].focus();}
else{instance.focus();}});});}).end().find('[data-role="mainEditorArea"]').hide().end().closest('.ipsComposeArea').addClass('ipsComposeArea_minimized').find('[data-ipsEditor-toolList]').hide();};},destruct=function(elem){var obj=getObj(elem);if(!_.isUndefined(obj)){obj.destruct();}},getObj=function(elem){if($(elem).data('_editor')){return $(elem).data('_editor');}
return undefined;},getObjWithIni};ips.ui.registerWidget('editor',ips.ui.editor,['allbuttons','postKey','toolbars','extraPlugins','autoGrow','contentsCss','minimized','minimizeAfterReset','autoSaveKey','skin','name','pasteBehaviour','autoEmbed','controller','defaultIfNoAutoSave','ipsPlugins']);return{respond:respond,getObj:getObj,getObjWithInit:getObjWithInit,destruct:destruct};});var editorObj=function(elem,options){var changePolled=false;var instance=null;var hiddenAtStart=false;var minimized=options.minimized;var hiddenInterval=null;var size='phone';var name='';var previewIframe=null;var currentPreviewView='';var previewInitialHeight=0;var previewSizes={phone:375,tablet:780};var init=function(callback){delete CKEDITOR.dtd.$removeEmpty['ins'];delete CKEDITOR.dtd.$removeEmpty['i'];var config={allowedContent:true,contentsLangDirection:$('html').attr('dir'),disableNativeSpellChecker:false,extraPlugins:options.ipsPlugins,ipsAutoSaveKey:options.autoSaveKey,ipsDefaultIfNoAutoSave:options.defaultIfNoAutoSave,ipsPasteBehaviour:options.pasteBehaviour,ipsAutoEmbed:options.autoEmbed,removeButtons:'',skin:options.skin,height:'auto',title:window.navigator.platform=='MacIntel'?ips.getString('editorRightClickMac'):ips.getString('editorRightClick'),controller:options.controller};if(options.pasteBehaviour=='force'){config.pasteFilter='plain-text';}
else{if(CKEDITOR.env.webkit){var tags=[];for(var tag in CKEDITOR.dtd){if(tag.charAt(0)!='$'){tags.push(tag);}}
config.pasteFilter=tags.join(' ')+'[*]{background-color,border*,color,padding,text-align,vertical-align,font-size}';}
else{config.pasteFilter=null;}}
if(!/iPad|iPhone|iPod/.test(navigator.platform)){config.removePlugins='elementspath';}
if(ips.getSetting('ipb_url_filter_option')=='none'&&ips.getSetting('url_filter_any_action')=='moderate'&&ips.getSetting('bypass_profanity')==0){config.removePlugins='ipslink';}
name=$(elem).find('textarea').attr('name');$(elem).trigger('editorCompatibility',{compatible:CKEDITOR.env.isCompatible});if(options.minimized&&minimized){$(elem).find('.ipsComposeArea_dummy').show().on('focus click',function(e){$(this).off('focus click');unminimize(function(){focus();});}).end().find('[data-role="mainEditorArea"]').hide().end().closest('.ipsComposeArea').addClass('ipsComposeArea_minimized').find('[data-ipsEditor-toolList]').hide();$(document).on('initializeEditor',_initializeEditor);minimized=true;}
if(!elem.is(':visible')){hiddenAtStart=true;if(!options.minimized&&!minimized){clearInterval(hiddenInterval);hiddenInterval=setInterva},400);}}
var language=$('html').attr('lang').toLowerCase();if(!CKEDITOR.lang.languages[language]){var language=language.substr(0,2);if(CKEDITOR.lang.languages[language]){config.language=language;}}else{config.language=language;}
if(!options.allbuttons){var toolbars=$.parseJSON(options.toolbars);var width=elem.width();if(width>700){size='desktop';}else if(width>400){size='tablet';}
config.toolbar=toolbars[size];}else{config.removePlugins='sourcearea';}
if(options.extraPlugins!==true){config.extraPlugins+=','+options.extraPlugins;}
if(ips.getSetting('cloud2')){var addPlugins,i;if(options.extraPlugins!==true){addPlugins=options.extraPlugins.split(',');for(i=0;i<addPlugins.length;i++){CKEDITOR.plugins.addExternal(addPlugins[i],'/ckeditor_custom/'+addPlugins[i]+'/');}}
if(options.skin!=='ips'&&options.skin!=='moono'){config.skin=options.skin+',/ckeditor_custom/skin_'+options.skin+'/';}}
instance=CKEDITOR.replace($(elem).find('textarea').get(0),config);instance.once('instanceReady',function(){elem.trigger('editorWidgetInitialized',{id:name});ips.utils.lazyLoad.loadContent(elem);if(_.isFunction(callback)){callback(this);}}.bind(this));let focusTimeout;instance.on('focus});instance.on('blur}.bind(this));const _checkFocusState=()=>{if(!instance.focusManager.hasFocus){clearInterval(focusTimeout);return;}
_triggerFocusEvent()};const _triggerFocusEvent=()=>elem.trigger('editor.focused',{elem});const _triggerBlurEven);instance.on('afterInsertHtml});if(!options.allbuttons){$(window).on('resize',resize);}
$(document).on('fileDeleted',_deleteFile);$(document).on('insertEmoji',_insertEmoji);$(elem).on('togglePreview',_togglePreview);$(window).on('message',_previewMessage);_cleanUpStaleAutoSaves();};var _cleanUpStaleAutoSave};var destruct=function(){instance.fire('resetOrDestroy');try{if(instance.status=='ready'){instance.destroy();}else{instance.on('instanceReady',function(){instance.destroy();});}
Debug.log("Destroyed editor instance");}catch(err){Debug.error("Editor destruct error:");Debug.error(err);instance.removeAllListeners();CKEDITOR.remove(instance);}
_offEvents();};var getInstanc};var _offEvent};var resiz};var focus=function(){instance.focus();};var unminimize=function(callback){if(!_.isFunction(callback)){callback=$.noop;}
if(minimized){var _unminimize=function(){$(elem).find('.ipsComposeArea_dummy').hide().end().find('[data-role="mainEditorArea"]').show().end().closest('.ipsComposeArea').removeClass('ipsComposeArea_minimized').find('[data-ipsEditor-toolList]').show();if(instance.status=='ready'){minimized=false;callback();if(hiddenAtStart){resize(true);hiddenAtStart=false;}
instance.on('change',function(e){if(!changePolled&&_.isUndefined(ips.getSetting('isAcp'))){changePolled=true;ips.getAjax()(elem.parentsUntil('','form').attr('action'),{'data':{'usingEditor':1}});}});}else{instance.once('instanceReady});}
var minimizedUploader=$(elem).find('[data-ipsEditor-toolListMinimized]');if(minimizedUploader.length){minimizedUploader.show();ips.getAjax()(elem.parentsUntil('','form').attr('action'),{'data':{'getUploader':minimizedUploader.attr('data-name')}}).don});}};if(!/iPad|iPhone|iPod/.test(navigator.platform)){setTimeout(function(){_unminimize();},200);}else{_unminimize();}}else{callback();}};var minimize=function(){if(!minimized){$(elem).find('.ipsComposeArea_dummy').show().end().find('[data-role="mainEditorArea"]').hide().end().closest('.ipsComposeArea').addClass('ipsComposeArea_minimized').find('[data-ipsEditor-toolList]').hide();minimized=true;}};var insertQuote};var updateImag};var checkDirty=function(){return instance.checkDirty();};var resetDirty=function(){return instance.resetDirty();};var insertHtml=function(html){instance.insertHtml(html);};var reset=function(){instance.fire('resetOrDestroy');instance.setData('<p></p>');_closePreview();elem.find('[data-ipsUploader]').trigger('resetUploader');if(options.minimized&&options.minimizeAfterReset){minimize();$(elem).find('.ipsComposeArea_dummy').on('focus click',function(e){$(this).off('focus click');unminimize(function(){focus();});})}};var saveAndClearAutosav};var _belongsToThisEdito};var _initializeEdito};var _deleteFil};var _scrollToEdito};var _insertEmoj};var _togglePrevie};var _showPrevie};var _buildAndShowPrevie};var _showPreviewButton};var _resizePrevie};var _previewMessag};var _fetchPrevie};var _closePrevie};var _setPreviewHeigh};var _sendMessag};return{init:init,focus:focus,unminimize:unminimize,minimize:minimize,insertQuotes:insertQuotes,insertHtml:insertHtml,checkDirty:checkDirty,resetDirty:resetDirty,updateImage:updateImage,reset:reset,destruct:destruct,saveAndClearAutosave:saveAndClearAutosave,getInstance:getInstance};};}(jQuery,_));;
;(function($,_,undefined){ips.createModule('ips.ui.map',function(){var defaults={zoom:2,maxZoom:16,markers:'[]',contentUrl:null};var respon};var _mapbox=function(elem,options){$('head').append("<link rel='stylesheet' type='text/css' media='all' href='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css'><link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/MarkerCluster.css' rel='stylesheet' /><link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/MarkerCluster.Default.css' rel='stylesheet' />");var handlePopu};ips.loader.get(['https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.js']).then(function(){ips.loader.get(['https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/leaflet.markercluster.js']).then(function(){L.mapbox.accessToken=ips.getSetting('mapApiKey');var map=L.mapbox.map(elem.get(0)).setView([45,0],options.zoom).addLayer(L.mapbox.styleLayer('mapbox://styles/mapbox/streets-v11'));var cluster=new L.MarkerClusterGroup();map.addLayer(cluster);var markers=$.parseJSON(options.markers);for(var id in markers){var marker=L.marker([markers[id].lat,markers[id].long],{icon:L.mapbox.marker.icon({'marker-color':'#0000ff'}),clubID:id,title:markers[id].title,draggable:false});cluster.addLayer(marker);if(options.contentUrl){marker.bindPopup(ips.getString('loading'));marker.on('click',handlePopup);}}
map.fitBounds(cluster.getBounds().pad(0.5));});});};var _google=function(elem,options){if(typeof google==='undefined'||typeof google.maps==='undefined'){ips.loader.get(['https://maps.googleapis.com/maps/api/js?key='+ips.getSetting('mapApiKey')+'&libraries=places&sensor=false&callback=ips.ui.map.googleCallback']);}else{ips.ui.map.googleCallback();}
$(window).on('googleApiLoaded',function(){var mapOptions={zoom:options.zoom,maxZoom:options.maxZoom,scrollwheel:false};if(options.zoom){mapOptions.center={lat:45,lng:0};}else{mapOptions.center={lat:30,lng:0};}
var map=new google.maps.Map(elem.get(0),mapOptions);var bounds=new google.maps.LatLngBounds();var infowindow=new google.maps.InfoWindow({content:ips.getString('loading')});var markers=$.parseJSON(options.markers);for(var id in markers){var marker=new google.maps.Marker({position:{lat:markers[id].lat,lng:markers[id].long},map:map,title:markers[id].title,id:id});if(options.contentUrl){marker.addListener('click});}
bounds.extend(marker.position);}
map.fitBounds(bounds);});};var googleCallback=function(){$(window).trigger('googleApiLoaded');};ips.ui.registerWidget('map',ips.ui.map,['zoom','maxZoom','markers','contentUrl']);return{respond:respond,googleCallback:googleCallback};});}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.infiniteScroll',function(){var defaults={distance:50,loadingTpl:'core.infScroll.loading',scrollScope:window,pageParam:'page',pageBreakTpl:'core.infScroll.pageBreak',totalPages:null,disableIn:'phone'};var respond=function(elem,options){if(!$(elem).data('_infinite')){$(elem).data('_infinite',infiniteScrollObj(elem,_.defaults(options,defaults)));}},getObj=function(elem){if($(elem).data('_infinite')){return $(elem).data('_infinite');}
return undefined;};ips.ui.registerWidget('infScroll',ips.ui.infiniteScroll,['container','scrollScope','distance','url','pageParam','loadingTpl','pageBreakTpl','disableIn']);var infiniteScrollObj=function(elem,options){var state='ready',scrollScope=null,container=null,ajaxObj=null,currentPage=1;var ini},_refres},_scrollEven},_loadMoreResult},_insertNewResult},_showLoadingEle},_removeLoadingEle},_getDistance=function(){if(options.scrollScope==window){var scrollHeight=$(document).height();var distanceFromBottom=scrollHeight-$(window).height()-$(window).scrollTop();}else{var scrollHeight=scrollScope[0].scrollHeight;var distanceFromBottom=scrollHeight-scrollScope.height()-scrollScope.scrollTop();}
return distanceFromBottom;},_getPageURL=function(pageNo){var url=elem.attr('data-ipsInfScroll-url');return url+(url.match(/\?/)?'&':'?')+options.pageParam+'='+parseInt(pageNo);},_getStartPag},_getTotalPage};init();return{init:init};};return{respond:respond};});}(jQuery,_));;
}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.form',function(){var _cmInstances={};var _support={};var formTypes={'unlimited':'[data-control~="unlimited"]','selectDisable':'[data-control~="selectDisable"]','date':'input[type="date"], [data-control~="date"]','range':'input[type="range"], [data-control~="range"]','color':'input[type="color"], [data-control~="color"]','dimensions':'[data-control~="dimensions"]','dimensionsUnlimited':'[data-control~="dimensionsUnlimited"]','jsDisable':'input[data-control~="jsdisable"]','toggle':'[data-control~="toggle"]','codemirror':'[data-control~="codemirror"]','granularCheckboxset':'[data-control~="granularCheckboxset"]',};var init=function(){$(document).on('contentChange',function(e,data){if(!_.isUndefined(data)&&$(data[0]).closest('[data-ipsForm]').length){respond($(data[0]));}});$(document).on('menuOpened});$(document).on('codeMirrorInsert});$(document).on('tabChanged});},respon};var localeSor};var _controlMethods={codemirro},rang},unlimited:function(elem){elem.on('change',function(){_unlimitedCheck(elem);});if(!elem.attr('data-initialized')){elem.attr('data-initialized','1');_unlimitedCheck(elem);}},selectDisable:function(elem){elem.on('change',function(){_selectDisable(elem);});_selectDisable(elem);},dat},color:function(elem){if(elem.attr('data-ipsFormData')){return;}
ips.loader.get(['core/interface/spectrum/spectrum.js']).then(function(){elem.attr('data-ipsFormData',1);var options={type:"text",clickoutFiresChange:true,hideAfterPaletteSelect:true,preferredFormat:"hex",appendTo:$(elem).closest('li')};if(!elem.attr('data-rgba')){options.showAlpha=false;}
if(elem.attr('data-swatches')){options.showPalette=true;options.showSelectionPalette=true;options.localStorageKey='ips.ColorPicker';}
$(elem).spectrum(options);});},toggl},dimension},dimensionsUnlimite},jsDisabl},granularCheckboxset:function(elem){elem.find('[data-role="checkboxsetUnlimitedToggle"]').on('change});elem.find('[data-action="checkboxsetCustomize"]').on('click',function(){elem.find('[data-role="checkboxsetUnlimited"]').hide();elem.find('[data-role="checkboxsetUnlimitedToggle"]').prop('checked',false);if(elem.find('[data-role="checkboxsetUnlimitedToggle"]').length>0){elem.find('[data-role="checkboxsetGranular"]').slideDown();}});elem.find('[data-action="checkboxsetAll"]').on('click',function(){elem.find('[data-role="checkboxsetGranular"] input:enabled[type="checkbox"]').prop('checked',true);if(elem.find('[data-role="checkboxsetUnlimitedToggle"]').length>0){elem.find('[data-role="checkboxsetUnlimited"]').slideDown();elem.find('[data-role="checkboxsetGranular"]').slideUp();elem.find('[data-role="checkboxsetUnlimitedToggle"]').prop('checked',true).change();}});elem.find('[data-action="checkboxsetNone"]').on('click',function(){elem.find('[data-role="checkboxsetGranular"] input:enabled[type="checkbox"]').prop('checked',false);if(elem.find('[data-role="checkboxsetUnlimitedToggle"]').length>0){elem.find('[data-role="checkboxsetUnlimited"]').slideDown();elem.find('[data-role="checkboxsetGranular"]').slideUp();elem.find('[data-role="checkboxsetUnlimitedToggle"]').prop('checked',false).change();}});elem.find('[data-role="search"]').on('keydown',function(e){if(e.keyCode==13||e.keyCode==38||e.keyCode==40){e.preventDefault();}});elem.find('[data-role="search"]').off('keyup').on('keyup',function(e){var focussedCheckbox=elem.find('[data-role="result"].ipsField__checkboxOverflow__focused');switch(e.keyCode){case 13:focussedCheckbox.find('input').prop('checked',!focussedCheckbox.find('input').prop('checked'));break;case 38:var prev=focussedCheckbox.prevAll(':visible').first();if(prev.length){focussedCheckbox.removeClass('ipsField__checkboxOverflow__focused')
prev.addClass('ipsField__checkboxOverflow__focused');}
break;case 40:var next=focussedCheckbox.nextAll(':visible').first();if(next.length){focussedCheckbox.removeClass('ipsField__checkboxOverflow__focused')
next.addClass('ipsField__checkboxOverflow__focused');}
break;default:focussedCheckbox.removeClass('ipsField__checkboxOverflow__focused');var val=$(this).val().toLowerCase();if(val){elem.find('[data-role="massToggles"]').hide();elem.find('[data-role="result"]').each(function(){if($(this).find('[data-role="label"]').text().toLowerCase().includes(val)){$(this).show();}else{$(this).hide();}});elem.find('[data-role="result"]:visible').first().addClass('ipsField__checkboxOverflow__focused');}else{elem.find('[data-role="result"]:hidden').show();elem.find('[data-role="massToggles"]').show();}}});elem.find('[data-role="search"]').on('clear blur',function(e){if($(e.relatedTarget).closest('[data-role="checkboxsetGranular"]').find('[data-role="search"]').is(this)){e.preventDefault();$(this).focus();return;}
$(this).val('');elem.find('[data-role="result"].ipsField__checkboxOverflow__focused').removeClass('ipsField__checkboxOverflow__focused');elem.find('[data-role="result"]:hidden').show();elem.find('[data-role="massToggles"]').show();});var count=parseInt(elem.attr('data-count'));if(count>10){elem.find('.ipsField__checkboxOverflow').addClass('ipsField__checkboxOverflow--active');elem.find('[data-role="search"]').removeClass('ipsHide');}},diallingCod}},_toggle},_dimensionsUnlimitedChec},_toggleRadi},_toggleSelec},_toggleCheckbox=function(elem,toggleList,thisElem,form,reverse){var show=elem.is(':checked');if(reverse){show=!show;}
if(elem.is('[data-control~="unlimited"]')&&!elem.is(':checked')){var inputs=elem.closest('.ipsFieldRow_content,[data-role="unlimitedCatch"]').find('input[type="radio"],select');if(inputs.length){inputs.each(function(){var toggle=$(this);if(toggle.is('select')){var toggleList=_.difference(toggleList,toggle.find('option:selected').attr('data-toggles'));}
else if(toggle.is(':checked')){var toggleList=_.difference(toggleList,toggle.attr('data-toggles'));}});}}
if(show){_showFormRows(toggleList,form);}else{_hideFormRows(toggleList,form);}},_toggleNod},_toggleGeneri},_hideFormRow},_showFormRows=function(show,form){if(_.isArray(show)){show=show.join(',');}
$(form||document).find(show).not('[data-ipsToggle]').show().end().removeClass('ipsHide').find('[data-toggles],[data-togglesOn]').eac}).end().find('[data-ipsUploader]').each(function(i,elem){ips.ui.uploader.refresh(elem);}).end().find('[data-ipsMatrix]').eac});},_selectDisabl},_unlimitedChec},_validationErro};ips.ui.registerWidget('form',ips.ui.form);return{respond:respond,init:init};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.drawer});var drawerObj=function(elem,options){var modal,drawerElem,drawerContent;var init=function(){modal=ips.ui.getModal().addClass('ipsDrawer_modal');drawerElem=$(options.drawerElem),drawerContent=drawerElem.find('.ipsDrawer_menu');drawerElem.on('click','[data-action="close"]});drawerElem.on('click});drawerElem.on('click','.ipsDrawer_itemParent > h4',_showSubMenu).on('click','[data-action="back"]',_subMenuBack).find('.ipsDrawer_itemParent > ul').addClass('ipsDrawer_subMenu').hide();},_showSubMenu=function(e){e.preventDefault();var item=$(e.currentTarget);item.parents('.ipsDrawer_list').animate(($('html').attr('dir')==='rtl')?{marginRight:'-100%'}:{marginLeft:'-100%'}).end().siblings('.ipsDrawer_list').show();drawerElem.find('.ipsDrawer_content').animate({scrollTop:"0px"});},_subMenuBac},sho},hid};init();return{init:init,show:show,hide:hide};};}(jQuery,_));;
}(jQuery,_));;
}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.ui.flashMsg',function(){var _queue=[],_doneInit=false,_box,_content,_isShowing=false,_currentDismissHandler=null;var defaults={timeout:2,extraClasses:'',location:'top',sticky:false,escape:true};var respon},ini},show=function(message,options,update){if(!_doneInit){_initElement();}
options=_.defaults(options||{},defaults);if(options.escape){message=_.escape(message);}
if(_isShowing&&!update){_queue.push([message,options]);return;}
if(update&&_isShowing){_content.html(message);ips.utils.anim.go('pulseOnce',_box);if(!options.sticky){setTimeout(hide,options.timeout*1000);}
return;}
_currentDismissHandler=null;_isShowing=true;_content.html(message);_box.attr('class','').addClass(options.extraClasses).addClass(options.dismissable?'ipsFlashMsg_dismissable':'').addClass(options.position=='bottom'?'ipsFlashMsg_bottom':'ipsFlashMsg_top').on('click','a:not( [data-action="dismissFlashMessage"] )',function(){hide();}).animationComplet});if(_.isFunction(options.dismissable)){_currentDismissHandler=options.dismissable;}
ips.utils.anim.go('fadeInDown',_box);},hid},dismis},_initElemen};ips.ui.registerWidget('flashMsg',ips.ui.flashMsg,['text','extraClasses','timeout','position','sticky','dismissable']);init();return{respond:respond,show:show};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.utils',function(options){var argsToArra},uppercaseFirs},getIDsFromLis},getCitation=function(data,html,defaultValue){var citation=ips.getString('editorQuote');if(defaultValue){var citation=defaultValue;}
if(data.username){var username=data.username;if(html&&data.userid&&ips.getSetting('viewProfiles')){username=ips.templates.render('core.editor.citationLink',{baseURL:ips.getSetting('baseURL'),userid:data.userid,username:data.username});}else{username=_.escape(username);}
if(data.timestamp){var citation=ips.getString('editorQuoteLineWithTime',{date:ips.utils.time.readable(data.timestamp),username:username});}else{var citation=ips.getString('editorQuoteLine',{username:username});}}
return citation;},escapeRegexp=function(toEscape){return toEscape.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");},urlBase64ToUint8Arra};return{argsToArray:argsToArray,uppercaseFirst:uppercaseFirst,getIDsFromList:getIDsFromList,getCitation:getCitation,escapeRegexp:escapeRegexp,urlBase64ToUint8Array:urlBase64ToUint8Array};});}(jQuery,_));;
(function($,_,undefined){"use strict";ips.createModule("ips.utils.sockets",function(){let socketIo;let pingInterval;let refreshToken;let refreshInterval;let refreshTokenUsed=false;let connected=false;const init=function(){if(!enabled()){return;}
ips.loader.get([`${ips.getSetting('socketUrl')}/socket.io/socket.io.min.js`]).then(function(){initializeSocketIo();});},enabled=function(){let res=!!(ips.getSetting('memberID')&&ips.getSetting('socketEnabled')&&ips.getSetting('page_token'));return res;},initializeSocketIo=function(){if(connected){return;}
socketIo=io(`${ips.getSetting('socketUrl')}/site-${ips.getSetting('siteId')}`,{transports:['websocket'],forceNew:true,multiplex:false,query:{token:ips.getSetting('page_token'),ipsVersion:'v4'}});socketIo.on('connect',_eventConnect(socketIo));socketIo.on('message',_eventMessage);socketIo.on('ping',function(){socketIo.emit('pong');});socketIo.on('ping_interval',interval=>{interval=Number(interval);if(interval&&Number.isInteger(interval)&&interval>0){clearInterval(pingInterval);pingInterval=setInterva},interval*0.98);}})
socketIo.on('connect_error',_eventConnectError);socketIo.on('disconnect',_eventDisconnect);socketIo.on('refresh_token',token=>{let isJwt=true;if(typeof token!=="string"){isJwt=false;}else{let components=token.split('.');if(components.length<3){isJwt=false;}else{for(let component of components.slice(0,2)){if(typeof JSON.parse(atob(component))!=='object'){isJwt=false;break;}}}}
if(isJwt){refreshToken=token;refreshTokenUsed=false;Debug.log(`Got a refresh token from Node Services`)}else{Debug.warn(`Got a refresh token that is not a valid JWT from Node Services`)}})},useRefreshToken=function(){let attempts=120;if(refreshInterval){clearInterval(refreshInterval);}
refreshInterval=setInterval(()=>{if(!attempts--||refreshTokenUsed||typeof refreshToken!=='string'||typeof ips.getSetting('page_token')!=='string'||connected){clearInterval(refreshInterval);refreshInterval=undefined;}
ips.getAjax()(ips.getSetting('baseURL')+'?app=core&module=system&controller=ajax&do=refreshRealtimeToken',{data:{page_token:ips.getSetting('page_token'),refresh_token:refreshToken},method:"POST"}).done(function(response){if(response.page_token){refreshTokenUsed=true;ips.setSetting('page_token',response.page_token);socketIo.off();socketIo.disconnect();refreshToken=undefined;initializeSocketIo();}}).fai));},5000);},send=function(event,data={}){if(!enabled()||!socketIo){return;}
socketIo.emit(event,data);},_eventMessage=function(data={}){if(typeof data!=='object'||data.event===undefined){Debug.log('Invalid message data');return;}
const{event,type=null,...rest}=data;let eventType='';if(type!==null){eventType=`:${type}`;}
$(document).trigger(`socket.${event}${eventType}`,rest);},_eventConnect=socket=>function(){connected=true;clearInterval(refreshInterval);refreshInterval=undefined;Debug.log("Connected to socket server");$(document).trigger('socket.connected');window.ips.socket=socket;},_eventConnectError=function(){connected=false;Debug.log("Error connecting to socket server");$(document).trigger('socket.error');useRefreshToken()},_eventDisconnect=function(){connected=false;Debug.log("Disconnected from socket server");$(document).trigger('socket.disconnected');if(!refreshInterval){useRefreshToken();}};return{init,enabled,send};});})(jQuery,_);;
}(jQuery,_));var escapeRegExp}());;
;(function($,_,undefined){"use strict";ips.createModule('ips.utils.url',function(){var _skipped=['s'],_store={},_origin;var init=function(queryString){},getPara},getPageNumbe},pageParamToPat},removePara},removeParam},rebuildUriObjec},getURIObjec},getOrigi};function parseUri(str){if('URL'in window){try{if(str.indexOf('//')===0){str=location.protocol+str;}
var o=new URL(str);var uri={'source':o.href,'protocol':o.protocol.substring(0,(o.protocol.length-1)),'userInfo':(o.username?o.username:'')+((o.username&&o.password)?':':'')+(o.password?o.password:''),'user':o.username,'password':o.password,'host':o.hostname,'port':o.port,'relative':o.pathname+(o.search?o.search:''),'path':o.pathname,'directory':'','file':'','query':o.search.substring(1),'anchor':o.hash,'queryKey':{}};uri.authority=uri.userInfo+(uri.userInfo?'@':'')+uri.host;o.searchParams.forEac});var urlBits=uri.path.split('/');uri.file=urlBits.pop();uri.directory=urlBits.join('/');return uri;}catch(err){Debug.log("Failed to parse URL: "+str+" ; "+err);}}
var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--)uri[o.key[i]]=m[i]||"";uri[o.q.name]={};uri[o.key[12]].replace(o.q.parse});return uri;};parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};return{getPageNumber:getPageNumber,getParam:getParam,removeParam:removeParam,removeParams:removeParams,getURIObject:getURIObject,getOrigin:getOrigin,rebuildUriObject:rebuildUriObject,pageParamToPath:pageParamToPath};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.utils.time',function(){var _supportsLocale=null;var readable=function(timestamp){var date=new Date();var time=date.getTime()/ 1000;var dst=0;var now=time+dst;var elapsed=now-timestamp;if(ips.getSetting('relativeDates')){if(elapsed<60){return ips.getString('time_just_now');}else if(elapsed<3600){return ips.pluralize(ips.getString('time_minutes_ago'),Math.floor(elapsed / 60));}else if(elapsed<5400){return ips.getString('time_1_hour_ago');}else if(elapsed<86400){return ips.pluralize(ips.getString('time_hours_ago'),Math.floor(elapsed / 3600));}}
var dateObj=new Date(timestamp*1000);var format=localeTimeFormat($('html').attr('lang'));var time=formatTime(dateObj,format);var timeParts=ips.getString('time_at')?[localeDateString(dateObj),ips.getString('time_at')]:[localeDateString(dateObj)];timeParts.push(time);return ips.getString('time_other',{time:timeParts.join(' ')});},getDateFromInpu},removeTimezon},isDS},isValidDateOb},timestamp=function(){return Date.now();},localeDateStrin},supportsHTMLDat},formatTim},localeTimeForma},_checkLocaleSuppor},_getLocaleTimeForma'sq':{format:'%H:%M'},'sr-cyrl':{format:'%k:%M'},'sr':{format:'%k:%M'},'sv':{format:'%H:%M'},'ta':{format:'%H:%M'},'th':{format:'%k นาฬิกา %N นาที'},'tl-ph':{format:'%H:%M'},'tr':{format:'%H:%M'},'tzl':{format:'%H.%M'},'tzm-latn':{format:'%H:%M'},'tzm':{format:'%H:%M'},'uk':{format:'%H:%M'},'uz':{format:'%H:%M'},'vi':{format:'%H:%M'},'zh-cn':{format:'%p%l点%M分',meridiem:defaultMeridiem},'zh-tw':{format:'%p%l點%M分',meridiem:defaultMeridiem}}};return{readable:readable,localeDateString:localeDateString,isValidDateObj:isValidDateObj,timestamp:timestamp,supportsHTMLDate:supportsHTMLDate,localeTimeFormat:localeTimeFormat,formatTime:formatTime,getDateFromInput:getDateFromInput,removeTimezone:removeTimezone};});}(jQuery,_));;
(function($,_,undefined){"use strict";ips.createModule("ips.utils.serviceWorker",function(){const SERVIule=system&controller=ser;const supported="serviceWorker"in navigator;const registerServiceWorker=(type,loggedIn)=>{return navigator.serviceWorker.register(`${SERVICE_WORKER_URL}&type=${type}&loggedIn=${JSON.s(!_isChild(selection.getRangeAt(i).commonAncestorContainer,container)){return'';}}
if(clonedSelection){text=clonedSelection.innerHTML;}else{clonedSelection=range.cloneContents();var startNode=etSelection();if(commonAncestonge.commonAncestorContainer);if(ancestor!=container&&!$(range.commonAncestorContainer).closest(container).length){return{type:'outside',range:range};}
return{type:'inside',range:range};};var getSelection=function(){return(window.getSelection)?window.getSelection():document.getSelection();};var _isChild=function(child,parent){if(child===parent){return true;}
var current=child;while(current){if(current===parent){return true;}
curncestor:getCom($,_,undefined){"use strict";ips.createModule('ips.utils.responsive',fint=[],breakk&&currentBreakpoint[1]==pointsBySize[brea.isUndefined(enterPitPoint]['exit'].length){$.each(callbacks[exitPoint]['exit'],function(idx,thisCallback){thisCallback();});}},getCurrentBoundary=function(){var curWidth=window.innerWidth||$(window).width();var curBreak;var possibleSizKey,function(num){return curWidth>=num;});if(possibleSizes.length){curBreak=_.max(possibleSizes,function(num){return parseInt(num);});}else{curBreak=_.min(breakpointsByKey,function(num){return parseInt(num);});}
return curBreak;},init=function(){$.each(options.breakpoints,function(size,name){addBreakpoint(size,name);});$(window).on('resize',windowResize);checkForBreakpointChange();},windowResize=function(){checkForBreakpointChange();},enabled=function(){return true;};init();return{addBreakpoint:addBreakpoint,addCallback:addCallback,currentIs:currentIs,getCurrentKey:getCurrentKey,getAllBreakpoints:getAllBreakpoints,enabled:enabled}});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.utils.position',function(){var theWindow=$(window);var getElemPosition=function(elem){if(!elem){return false;}
var elem=$(elem);var props={};var hidden=!elem.is(':visible');var opacity=elem.css('opacity');if(hidden){elem.css({opacity:"0.0001"}).show();}
var offset=elem.offset();var position=elem.position();var dims=getElemDims(elem);props.absPos={left:offset.left,top:offset.tok;case'right':totop;break;case'bottom':toReturn.top=offsetParent.top+triggerDims.outerHeight-
stemOffset.top;break;}
if(!positioned&&!triggerPos.fixed){toReturn.top+=theWindow.scrollTop();}
toReturn.fixed=triggerPos.fixed;toReturn.location=bestFit;return toReturn;},hasFixedParents=function(elem,andSelf){elem=$(elem);var fixed=false;var parents=elem.parents();if(andSelf){parents=parents.addBack();}
parents.each(function(){if(this.style.position=='fixed'){fixed=true;}});return fixed;},_getBestFit=function(viewportOffset,triggerDims,targetDims,offset,posDefaults,preferBottom,attemptToFit){var position=_.defaults(posDefaults||{},{vertical:'bottom',horizontal:'left'});if(position.horizontal=='center'){var targetLeft=viewportOffset.left+(triggerDims.outerWidth / 2)-(targetDims.outerWidth / 2);var targetRight=targetLeft+targetDims.outerWidth;if(targetLeft<0||targetRight>theWindow.width()){position.horizontal='left';}}
if(position.horizontal=='left'){if((viewportOffset.left+(triggerDims.outerWidth / 2)+targetDims.outerWidth-offset.left)>theWindow.width()){position.horizontal='right';}rizontal='left';}}
if(attemptToFit){if(position.vertical=='top'||preferBottomset.top)<0)';}}}
returnnaturalWidth=function(elem){return _getNatural(elem,'Width');},naturalHeight=function(elem){return _getNatural(elem,'Height');},lineHeight=function(parent){var newElem=$('<span/>').html('abc').css({opacity:"0.1"});parent.append(newElem);var height=newElem.height();newElem.remove();return height;},_getNatural=function(elem,type){if(('natural'+type)in new Image()){return elem[0]['natural'+type];}else{var img=new Image();img.src=elem[0].src;return img['natural'+type];}};return{getElemPosition:getElemPosition,getElemDims:getElemDims,positionElem:positionElem,hasFixedParents:hasFixedParents,naturalWidth:naturalWidth,naturalHeight:naturalHeight,lineHeight:lineHeight};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createtch=navigator.userAgent.toLowerCase();let isSafari=match.match(/version\/([\d\.]+).*safari/);if(isSafari){return parseFloat(isSafari[1])>=16.4;}
if(Notification.permission=='granted'){return true;}
return true;},supported=_isSupported(),requestPermission=function(){if(supported){Notification.requestPermission(function(result){if(result=='granted'){$(document).trigger('permissionGranted.notifications');}else{$(document).trigger('permissionDenied.notifications');}});}},permissionGranted=function(){subscribeToPush();},subscribeToPush=function(){$(document).trigger('subscribePending.notifications');return ips.utils.serviceWorker.registerServiceWorker('front',true).then((registration)=>{const options={userVisibleOnly:true,applicationServerKey:ips.registration.pushManager.subscribe(options);}).then((pushSubscription)=>{Debug.log('Received PushSubscription: ',JSON.stringify(pushSubscription));ips.getAjax()(ips.getSetting('baseURL')+'index.php?app=core&module=system&controller=notifications&do=subscribeToPush',{type:'post',data:{subscription:JSON.stringify(pushSubscription),encoding:(PushManager.supportedContentEncodings||['aesgcm'])[0]}}).done((response)=>{$(document).trigger('subscribeSuccess.notifications');}).fail((jqXHR,textStatus,errorThrown)=>{$(document).trigger('subscribeFail.notsPermission=function(){if(!supported||ips.utils.cookie.get('noBrowserNotifications')||Notification.permission=='denied'||Notification.permission=='default'){return false;}
reRegistration().then((registration)=>{return registration.pushManager.getSubscription().then(subscription=>{if(!subscription){return false;}
return subscription;}).catch(err=>{Debug.log(err);});}).catch(err=>{Debug.log(err);});},needsPermission=function(){if(supported&&!ips.utils.tions.onError,false);if(this._options.timeout!==false){setTimeout(_.bind(this.hide,this),this._options.timeout*1000);}};this.hide=function(){this._notification.close();this._notification.removeEventListener('show',this._options.onShow,false);this._notification.removeEventListener('hide',this._options.onHide,false);this._notification.removeEventListener('click',this._options.onClick,false);this._notification.removeEventListener('error',this._options.onError,false);};};$(document).on('subscribeToPush.notifications',subscribeToPush);$(document).on('requestPermission.notifications',requestPermission);$(document).on('permissionGranted.notifications',permissionGranted);return{supported:supported,subscribeToPush:subscribeToPush,hasPermission:hasPermission,getSubscription:getSubscription,needsPermission:needsPermission,permissionLevel:permissionLevel,requestPermission:requestPermission,create:create,playSound:playSound};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.utils.links',function(){var updateExternalLinks=function(element){if(ips.getSetting('links_external')){if(_.isUndefined(element)){return;}
element.find('a[rel*="external"]').each(function(index,elem){elem.target="_blank";elem.rel=elem.rel.replace(" noopener","")+" noopener";});}};return{updateExternalLinks:updateExternalLinks};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.utils.geolocation',function(){const permissions={GRANTED:'granted',DENIED:'denied',PROMPT:'prompt'},type='geolocation',getGeolocatioon=ips.utils.db.get(type,`permission.${ipsSettings.memberID}`);if(permission==permissions.GRANTED)return true;return false;},setGeolocationIsAllowed=function(status){if(!_.values(permissions).includes(status))return;ips.utils.db.set(type,`permission.${ipsSettings.memberID}`,status,false);},getCurrentPosition=function(){return new Promise((res,rej)=>{navigator.geolocation.getCurrentPosition(position=>{setGeolocationIsAllowed(permissions.GRANTED);res(position.coords);},error=>{if(error.code==error.PERMISSION_DENIED){setGeolocationIsAllowed(permissions.DENIED);}
rej(error);});});},generalLocation=function(){return new Promise((res,rej)=>{if(!ipsSettings.memberID){const ipLocation=ips.utils.db.get(type,`iplocation`);if(ipLocation){res(ipLocation);}}
res({'latitude':0,'longitude':0});});}
return{getGeolocationIsAllowed,getCurrentPosition,setGeolocationIsAllowed,permissions};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.createModule('ips.utils.analytics',function(){var init=function(){},trackPageView=function(url){try{if(ips.getSetting('googleAnalyticsEnabled')){if(!_.isUndefined(window.ga)){var urlObj=ips.utils.url.getURIObject(url||document.location);Debug.log("Mame){return!_.isUndefined(_transitions[name]);},addTransition=function(name,cssAnimation,fallbackAnimation){if(_transitions[name]){Debureplace('SL(r,g,b)en=0;var s=(max+min)/ 2;if(delta==0){hue=0;saturation=0;}else{if(lightness<0.5){saturation=delta /(max+min);}else{saturation=delta /(2-max-min);}
var delta_r=(((max-r)/ 6)+(delta / 2))/ delta;var delta_g=(((max-g)/ 6)+(delta / 2))/ delta;var delta_b=(((max-b)/ 6)+(delta / 2))/ delta;if(r==max){hue=delta_b-delta_g;}else if(g==max){hue=(1 / 3)+delta_r-delta_b;}else if(b==max){hue=(2 / 3)+delta_g-delta_re('#','');if(hex.length===3){hex=hex.slice(0,1)+hex.slice(0,1)+hex.slice(1,2)+hex.slice(1,2)+hex.slice(2,3)+hex.slice(2,3);}
if(hex.length!==6){Debug.write(hex+" isn't a valid hex color");return[0,0,0];}
return[hexToRGB(hex.slice(0,2))/ 255,hexToRGB(hex.sliceB,RG";ips.createModule('ips.utils.cookie',function(){var _store={},_init=false;var init=function(){var cookies=_parseCookies(document.cookie.replace(" ",'')),cookieID=ips.getSetting('cookie_prefix')||false;$.each(cookies,function(key,cookie){if(cookieID){if(key.startsWith(cookieID)){key=key.replace(cookieID,'');_store[key]=unescape(cookie||'');}}});_init=true;},get=function(cookieKey){if(!_init){init();}
if(_store[cookieKey]){return _store[cookieKey];}
return undefined;},set=function(cookieKey,value,sticky){var expires='',path='/',domain='',ssl='',prefix='';if(!cookieKey){return;}
let allowOptional=true;if($('#elGuestTerms[data-role="cookieConsentBar"]').length>0){allowOptional=!!(ips.utils.cookie.get('cookie_consent')&&ips.utils.cookie.get('cookie_consent_optional'));}
if(!allowOptional&&ips.getSetting('essential_cookies').indexOf(cookieKey)===-1){return;}
if(!_.isUndefined(sticky)){if(sticky===true){var expirationDate=new Date();expirationDate.setFullYear(expirationDate.getFullYear()+100);expires="; expires="+expirationDate.toUTCString();}else if(sticky===-1){expires="; expires=Thu, 01-Jan-1970 00:00:01 GMT";}else if(sticky.length>10){expires="; expires="+sticky;}}
if(!_.isUndefined(ips.getSetting('cookie_domain'))&&ips.getSetting('cookie_domain')!=''){domain="; domain="+ips.getSetting('cookie_domain');}
iookie_path')!=''){path=ips.getSetting('cookie_path');}
if(!_.isUndefined(ips.getSetting('cookie_prefix'))&&ips.getSetting('cookie_prefix')!=''){prefix=ips.getSetting('cookie_prefix');}
if(!_.isUndefined(ips.getSetting('cookie_ssl'))&&ips.getSetting('cookie_ssl')!=''){ssl='; sef(!_.isUndefine(includeContent){content+='<span data-content-marker="true"></span>';}
if(afterContent){content+=afterContent;}
bqBlock.appendHtml(content);if(includeContent){var spans=bqBlock.getElementsByTag('span');for(var i=0;i<spans.count();i++){if(spans.getItem(i).hasAttribute('data-content-marker')){while(paragraphs.length>0){block=paragraphs.pop();block.insertAfter(spans.ge}}}};});return;}
if(!_.isUndefined(callbacks.loadCallback)||!_.isUndefined(callbacks.loadedCallback)||!_.isUndefined(callbacks.imgLoadedCallback)){_registry[$(rawNode).identify().attr('id')]={loadCallback:callbacks.loadCallback||null,loadedCallback:callbacks.loadedCallback||null,imgLoadedCallback:callbacks.imgLoadedCallback||null};}
if(!_.isUndefined(callbacks.preloadCallback)){callbacks.preloadCallback.call(null,rawNode);}else{preload(rawNode);}
_observer.observe(rawNode);},preload=function(rawNode){if(_isImg(rawNode)&&!rawNode.hasAttribute('data-loaded')&&!rawNode.hasAttribute('data-loading')){var lazyLoaded=[rawNode];}else{var lazyLoaded=rawNode.querySelectorAll('img[data-src]:not([data-loaded]):not([data-loading])');}
_.each(lazyLoaded,function(element){if(!element.hasAttribute('data-ratio')){return;}
var ratio=element.getAttribute('data-ratio').replace(',','.');if(((element.hasAttribute('style')&&element.style.width)||element.hasAttribute('width'))){if(element.style.height!=='auto'){var width=element.hasAttribute('style')&&element.style.width?element.style.width:element.width;element.style.height=parseInt((parseInt(width)/ 100)*parseFloat(ratio))+'px';}}else{element.style.height='0';element.style.paddingBottom=parseFloat(ratio)+'%';}});},_intersection=function(entries){for(var i=0;i<entries.length;i++){if(entries[i].isIntersecting||entries[i].intersectionRatio>0){_observer.unobserve(entries[i].target);if(!document.body.contains(entries[i].target)){continue;}
if(entries[i].target.id&&!_.isUndefined(_registry[entries[i].target.id])&&_.isFunction(_registry[entries[i].target.id].loadCallback)){_registry[entries[i].target.id].loadCallback.call(null,entries[i].target);}else{_load(entries[i].target);}}}},_load=function(rawNode,imgLoadedCallback){if(_isImg(rawNode)||_isEmbed(rawNode)||_isBackgroundImg(rawNode)||_isVideo(rawNode)){var itemsToLoad=[rawNode];}else{var itemsToLoad=rawNode.querySelectorAll(contentSelector);}
Debug.log('Loading '+itemsToLoad.length+' items...');_.each(itemsToLoad,function(element){if(_isImg(element)){if(((rawNode.id&&!_.isUndefined(_registry[rawNode.id])&&_.isFunction(_registry[rawNode.id].imgLoadedCallback))||_.isFunction(imgLoadedCallback))){replaceImg(element,imgLoadedCallback?imgLoadedCallback:_registry[rawNode.id].imgLoadedCallback);}else{replac(element);}else if(_isEmbed(element)){replaceEmbed(element);}else if(_isVideo(element)){replaceVideo(element);}});if(rawNode.Node.id].loadedCallback.call(null,rawNode);}},_isImg=function(rawNode){return rawNode.tagName.toLowerCase()=='img'&&rawNode.hasAttribute('data-src');},_isBackgroundImg=function(rawNode){return rawNode.hasAttribute('data-background-src');},_isEmbed=function(rawNode){return rawNode.tagName.toLowerCase()=='iframe'&&rawNode.hasAttribute('data-embed-src');},_isVideo=function(rawNode){return rawNode.tagName.toLowerCase()=='video'&&rawNode.hasAttribute('data-video-embed');},replaceImg=function(element,imgLoadedCallback){if(element.hasAttribute('style')&&element.style.height!=='auto'){element.style.height=element.offsetHeight+'px';}
element.style.paddingBottom='';element.addEventListener('load',function(){if(element.hasAttribute('data-ratio')&&element.hasAttribute('style')&&element.style.width&&element.st0)*element.gee();var src=element.getAttribute('data-embed-src');copy.setAttribute('src',src);copy.removeAttribute('data-embed-src');var srcWithoutProtocol=src.replace(/(^\w+:|^)\/\//,'');var baseWithoutProtocol=ips.getSetting('baseURL').replace(/(^\w+:|^)\/\//,'');if(srcWithoutProtocol.startsWith(baseWithoutProtocol)){copy.setAttribute('data-controller','core.front.core.autoSizeIframe');}
element.parentNode.replaceChild(copy,element);_document.trigger('contentChange',[$(copy)]);},replaceVideo=function(element){var sources=element.querySelectorAll('[data-video-src]');var canPlay=false;if(sources.length){for(var i=0;i<sources.length;i++){if(element.canPlayType(sources[i].getAttribute('type'))){element.setAttribute('src',sources[i].getAttribute('data-video-src'));sources[i].setAttribute('src',sources[i].getAttribute('data-video-src'));_document.trigger('contentChange',[$(element)]);canPlay=true;break;}}}
if(!canPlay){var embed=element.querySelector("embed");var link=element.querySelector(".ipsAttachLink");if(embed){element.parentNode.replaceChild(embed,element);}else if(link){element.parentNode.replaceChild(link,element);}}},loadContent=function(rawNode,imgLoadedCallback){if(typeof bypassLoadContent!=="undefined"){return;}
if(rawNode instanceof $){rawNode=rawNode.get(0);}
_load(rawNode,imgLoadedCallback);},applyLazyLoadAttributes=function(rawNode,dims,forceUpdate){if(rawNode.tagName.toLowerCase()!=='img'||((rawNode.hasAttribute('data-loaded')||rawNode.hasAttribute('data-emoticon'))&&!forceUpdate)){return;}
var _loadHandler=function(){dims=dims||{};var height=dims.height||rawNode.naturalHeight;var width=dims.width||rawNode.naturalWidth;if(height=='auto'){width=rawNode.offsetWidth;height=rawNode.offsetHeight;}
if(!_.isUndefined(ips.getSetting('maxImageDimensions'))){if(width>ips.getSetting('maxImageDimensions').width){width=ips.getSetting('maxImageDimensions').width;if(height&&height!='auto'){height=parseInt((parseInt(width)/ 100)*((height / width)*100).toFixed(2));}}
if(height>ips.getSetting('maxImageDimensions').height){height=ips.getSetting('maxImageDimensions').height;width=parseInt((parseInt(height)/ 100)*((width / height)*100).toFixed(2));}}
if(!rawNode.hasAttribute('width')&&width){rawNode.setAttribute('width',width);}
var ratio=((height / width)*100).toFixed(2);if(ratio){rawNode.set');parts=_.map(parts,function(part){return part.replace(/\]/g,'')});if(parts[0]===''){parts.shift();}
return parts;},_addValueToKey=function(output,keys,value){if(!_.isObject(output)){outpps.createModule('ips.utils.emoji',function(){var _emoji=null,_categories=null,_testingCanvasContext=null,_ajax=null,_callbacks=[],init=function(){this._invalidCharacterImageData=['0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0'];},getEmoji=function(callback){if(this._emoji&&this._categories){callback(this._emoji,this._categories);return;}
var storage=ips.utils.db.get('emoji',ips.getSetting('baseURL')+'-'+ips.getSetting('emoji_cache'));var categories=ips.utils.db.get('emojiCategories',ips.getSetting('baseURL')+'-'+ips.getSetting('emoji_cache'));if(storage&&categories){this._emoji=storage;callback(storage,categories);}else{ips.utils.db.removeByType('emoji');if(callback){if(!this._callbacks){this._callbacks=[];}
this._callbacks.push(callback);}
if(this._ajax&&this._ajax.abort){this._ajax.abort();}
this._ajax=ips.getAjax()(ips.getSetting('baseURL')+'index.php?app=core&module=system&controller=editor&do=emoji').done(function(emoji){this._emoji={};this._categories=[];var canUseTones=null;for(var category in emoji){var categoryName=emoji[category].category;this._categories.push(categoryName);this._emoji[categoryName]=[];for(var i=0;i<emoji[category].emoji.length;i++){if(this.canRender(emoji[category].emoji[i].code)){if(emoji[category].emoji[i].skinTone){if(canUseTones===null){if(!this.canRender(this.tonedCode(emoji[category].emoji[i].code,'light'))){canUseTones=false;}
else{canUseTones=true;}}
if(canUseTones===false){emoji[category].emoji[i].skinTone=false;}}
if(!emoji[category].emoji[i].shortNames.includes(ips.getString('emoji-'+emoji[category].emoji[i].name).toLowerCase())){emoji[category].e._testingCanv._testingCanvasContext.getImageData(0,0,6,6).data))!=-1){return false;}
if(Array.prototype.toString.call(this._testingCanvasContext.getImageData(7,0,1,6).data)!='0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0'){return false;}
return true;},emojiFromHex=function(hex){try{var decimals=[];var hexPoints=hex.split('-');for(var p=0;p<hexPoints.length;p++){decimals.push(parseInt(hexPoints[p],16));}
return String.fromCodePoint.apply(null,decimals);}catch(err){return null;}},emojiImage=function(codeToUse,lazyLoad){if(codeToUse.substr(0,7)=='custom-'){var parts=codeToUse.split('-');if(_.isUndefined(this._emoji[parts[1]])){return null;}
for(var i=0;i<this._emoji[parts[1]].length;i++){if(this._emoji[parts[1]][i].code==codeToUse){var imgTag='<img src="'+this._emoji[parts[1]][i].image+'" loading="lazy"';imgTag+='title="'+this._emoji[parts[1]][i].name+'" alt="'+this._emoji[parts[1]][i].name+'"';if(this._emoji[parts[1]][i].image2x){imgTag+=' srcset="'+this._emoji[parts[1]][i].image2x+' 2x"';}
if(parseInt(this._emoji[parts[1]][i].width)&&parseInt(this._emoji[parts[1]][i].height)){imgTag+=' width="'+this._emoji[parts[1]][i].width+'" height="'+this._emoji[parts[1]][i].height+'"';}
imgTag+=' data-emoticon="true">';return imgTag;}}
return null;}else{var url;var image=codeToUse.toLowerCase();if(image.indexOf('200d')==-1||['1f441-fe0f-200d-1f5e8-fe0f'].indexOf(image)!=-1){image=image.replaceode,toneium':return co){if(ip class='ipsEmoji'>"+this.emojiFromHex(code)+"</span>");}else{return CKEDITOR.dom.element.createFromHtml(this.emojiImage(code,false));}},logUse=function(code){var recentEmoji=[];if(ips.utils.cookie.get('recentEmoji')){recentEmFFF){cod failed");returwebkitHidden)){return'webkitHidden';}
return undefined;},_fireEvent=function(element,ev){if(document.createEvent){var evObj=document.createEvent('MouseEvents')entObject){var evObj=document.createEventObject();element.fireEvent('on'+evt,evObj);}};return{manualEvent:manualEvent,isTouchDevice:isTouchDevice,getVisibilityEvent:getVisibilityEvent,getVisibilityProp:getVisibilityProp};});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.controller.register('core.global.editor.censorBlock',{initialize:function(){jQuery.expr[':'].icontains=function(a,i,m){return jQuery(a).text().toUpperCase().indexOf(m[3].toUpperCase())>=0;};this._words=$.parseJSON(this.scope.attr('data-censorBlockWords'));this._editorId=$(this.scope).data('editorid');this.on(document,'editorWidgetInitialized',this.setup);},_editorId:null,_editor:null,setup:function(e){this._editor=CKEDITOR.instances[this._editorId];this._form=$(this._editor.container.$).closest('form');this._form.on('submit',this.checkCensorBlock.bind(this));},checkCensorBlock:function(e){this._editor.updateElement();var value=this._editor.getData();var found=[];this.scope.find('[data-role="editorCensorBlockMessageInternal"]').html(value);var display=this.scope.find('[data-role="editorCensorBlockMessageInternal"]');if(this._words.length){$(display).html(XRegExp.replace($(display).html(),new RegExp("<(pre|blockquote).+?</\\1>","sig"),'')).html($(display).text());found=0;var index=0;var exactWords=[];var looseWords=[];var reggie=null;for(var i in this._words){var word=this._words[i]['word'];var type=this._words[i]['type'];if($(value).is(':icontains("'+word+'")')){if(type=='exact'){exactWords.push(word);}
else{looseWords.push(word);}}}
if(looseWords.length&&exactWords.length){reggie=new Words.join('|')+"[^\\b]*)(?:\\b|\\s|$)|(?:\\b|\\s|^)("+exactWords.join('|')+")(?:\\b|\\s|$))","ig");}else if(looseWords.length){reggie=new RegExp("(?:\\b|\\s|^)([^\\b]*"+looseWords.join('|')+"[^\\b]*)(?:\\b|\\s|$)","ig");}else if(exactWords.length){reggie=new RegExp("(?:\\b|\\s|^)("+exactWords.join('|')+")(?:\\b|\\s|$)","ig");}
Debug.log(reggie);if($(value).text().match(reggie)){$(display).each(function(){$(this).contents().filter(function(){return this.nodeType===3}).each(function(){$(this).replaceWith(_.escape(XRegExp.replace($(this).text(),reggie,'<mark class="ipsMatchWarning ipsType_bold ipsType_large ipsMatch'+(index)+'">'+"$1"+'</mark>')).replace(new RegExp("&lt;mark class=&quot;ipsMatchWarning ipsType_bold ipsType_large ipsMatch"+(index)+"&quot;&gt;",'ig'),"<mark class='ipsMatchWarning ipsType_bold ipsType_large ipsMatch"+(index)+"'>").replace(new RegExp("&lt;/mark&gt;",'ig'),"</mark>").trim());});found++;});}}
if(found>0){e.preventDefault();this._form.find('input[type="submit"],button[type="submit"]').prop('disabled',false);$(display).html(XRegExp.replace($(display).html(),new RegExp("((\s+?)?(\r\n|\r|\n)(\s+?)?){1,}","g"),'<br><br>'));this.scope.show();var elemPosition=ips(var i in this.rigin:'',initialize:function(){this.on('click','[data-action="preview"]',this.fetchPreview);},fetchPreview:function(data){var scope=$(this.scope);$('#'+scope.attr('data-name')+'_preview').addClass('ipsLogetValue()}}).done(function(response){$('#'+scope.attr('data-name')+'_preview').removeClass('ipsLoading').html(response);});}});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.controller.register('core.global.editor.customtags',{editorWrap:null,editorSidebar:null,editorSidebarHeader:null,editorSidebarList:null,initialrap=this.scope.find('orSidebarL$('textarea[name="'+this.scope.attr('data-tagFieldID')+'"]').closest('[data-ipsEditor]').data('_editor').insertHtmcope.trigger('codeMirrorInsert',{elemID:$(e.currentTarget).closest('[data-codemirrorid]').attr('data-codemirrorid'),tag:content});}else{var textField=$('#'+this.scope.attr('data-tagFieldID'));textField.focus().insertText(content,textField.getSelection().start,'collapseToEnd');}},reloadTags:function(){if(this.scope.attr('data-tagSource')){ips.getAjax()(this.scope.attr('data-tagSource')).done(function(response,status,jqXHR){$('ul[data-role="tagsList"]').html(response)});}}});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.controller.register('core.global.editor.emoticons',{initialize:f','[data-rolildEmoji(emoji,ips.utils.cookie.get('emojiSkinTone'),null,categories);}.bind(this),100);}.bind(this));},insertEmoji:function(e){this.trigger($(document),'insertEmoji',{editorID:this.editorID,emoji:$(e.currentTarget).attr('data-emoji'),});this.scope.find('[data-role="emoticonSearch"]').val('');this.scope.trigger('closeMenu');ips.utils.emoji.getEmoji(function(emoji,categories){this._buildEmoji(emoji,ips.utils.cookie.get('emojiSkinTone'),null,categories);}.bind(this));},_buildEmoji:function(emoji,tone,search,categories){ips.controller.cleanContentsOf(this.scope.find('.ipsMenu_innerContent'));var finalHtml='';var categoryHtml='';var pos=0;var emojiForThisRow='';var menuContent=[];if(!search&&ips.utils.cookie.get('recentEmoji')){var recentlyUsed=ips.utils.cookie.get('recentEmoji').split(',');var newRecentlyUsed=[];if(recentlyUsed.length){for(var i=0;i<recentlyUsed.length;i++){if(ips.utils.emoji.canRender(recentlyUsed[i])){var displayHtml=ips.utils.emoji.preview(recentlyUsed[i]);if(displayHtml){newRecentlyUsed.push(recentlyUsed[i]);emojiForThisRow+=ips.templates.render('core.editor.emoji',{display:displayHtml,name:null,code:recentlyUsed[i]});if(newRecentlyUsed.length==8||newRecentlyUsed.length==16){categoryHtml+=ips.templates.render('core.editor.emoticonRow',{emoticons:emojiForThisRow});emojiForThisRow='';}}}}
if(emojiForThisRow){categoryHtml+=ips.templates.render('core.editor.emoticonRow',{emoticons:emojiForThisRow});}
if(categoryHtml){finalHtml+=ips.templates.render('core.editor.emoticonCategory',{title:ips.getString('emoji-category-recent'),categoryID:category,emoticons:categoryHtml});categoryHtml='';emojiForThisRow='';}}
if(newRecentlyUsed!=recentlyUsed){ips.utils.cookie.set('recentEmoji',newRecentlyUsed.join(','),true);}}
for(var i in categories){var category=categories[i];var categoryCount=0;for(var i=0;i<emoji[category].length;i++){if(search){var match=false;if(emoji[category][i].name.match(search)){match=true;}
if(!match&&emoji[category][i].shortNames){for(var j=0;j<emoji[category][i].shortNames.length;j++){if(emoji[category][i].shortNames[j].match(search)){match=true;}}}
if(!match&&emoji[category][i].ascii){for(var j=0;j<emoji[category][i].ascii.length;j++){if(emoji[category][i].ascii[j].match(search)){match=true;}}}
if(!match){continue;}}
var codeToUse=emoji[category][i].code;if(emoji[category][i].skinTone&&tone&&tone!='none'){codeToUse=ips.utils.emoji.tonedCode(codeToUse,tone);}
emojiForThisRow+=ips.templates.render('core.editor.emoji',{display:ips.utils.emoji.preview(codeToUse),name:ips.haveString('emoji-'+emoji[category][i].name)?ips.getString('emoji-'+emoji[category][i].name):emoji[category][i].name,code:codeToUse});pos++;categoryCount++;if(pos==8){categoryHtml+=ips.templates.render('core.editor.emoticonRow',{emoticons:emojiForThisRow});pos=0;emojiForThisRow='';}}
if(!search){if(pos){categoryHtml+=ips.templates.render('core.editor.emoticonRow',{emoticons:emojiForThisRow});}
if(categoryHtml){var categoryTitle=['smileys_emotion','people_body','animals_nature','food_drink','activities','travel_places','objects','symbols','flags'].indexOf(category)==-1?emoji[category][0].categoryName:ips.getString('emoji-category-'+category);finalHtml+=ips.templates.render('core.editor.emoticonCategory',{title:categoryTitle,categoryID:category,emoticons:categoryHtml});categoryHtml='';pos=0;emojiForThisRow='';menuContent.push(ips.templates.render('core.editor.emoticonMenu',{title:categoryTitle,count:categoryCount,categoryID:category}));}}}
if(search){this.scope.find('[data-role="categoryTrigger"]').hide();if(pos){categoryHtml+=ips.templates.render('core.editor.emoticonRow',{emoticons:emojiForThisRow});}
if(categoryHtml){finalHtml=ips.templates.render('core.editor.emoticonSearch',{emoticons:categoryHtml});}else{finalHtml=ips.templates.render('core.editor.emoticonNoResults');}}else{this.scope.find('[data-role="categoryTrigger"]').show();this.scope.find('[data-role="categoryMenu"]').get(0).innerHTML=menuContent.join('');}
this.scope.find('.ipsEmoticons_content').get(0).innerHTML=finalHtml;if(ips.getSetting('emoji_style')!='disabled'&&(ips.getSetting('emoji_style')!='native'||ips.utils.emoji.canRender('1F44D-1F3FB'))){this.scope.find("[data-role='skinToneMenu']").show();switch(tone){case'light':this.scope.find("[data-role='skinToneIndicator']").text(String.fromCodePoint(parseInt('1F44D',16))+String.fromCodePoint(parseInt('1F3FB',16)));break;case'medium-light':this.scope.find("[data-role='skinToneIndicator']").text(String.fromCodePoint(parseInt('1F44D',16))+String.fromCodePoint(parseInt('1F3FC',16)));break;case'medium':this.scope.find("[data-role='skinToneIndicator']").text(String.fromCodePoint(parseInt('1F44D',16))+String.fromCodePoint(parseInt('1F3FD',int(parseInt('1F3FF',16)));break;default:this.scope.find("[data-role='skinToneIndicator']").text(String.fromCodePoint(parseInt('1F44D',16)));break;}}},changeSkinTone:function(e,data){ips.utils.emoji.getEmoji(function(emoji,categories){this._buildEmoji(emoji,data.selectedItemID,this._lastVal?new RegExp(this._lastVal.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),'i'):null,categories);}.bind(this));ips.utils.cookie.set('emojiSkinTone',data.selectedItemID,true);},_typeTimer:null,_lastVal:'',menuOpened:function(e,data){if(data.menu.attr('data-controller')=='core.global.editor.emoticons'){setTimeout(function(){this.scope.find('.ipsEmoticons_content').show();this.scope.find('.ipsMenu_innerContent').css({height:'auto'});this.scope.find('[data-role="emoticonSearch"]').focus();}.bind(this),100);}}.outerHeight(typeTimer)_doSearch(textEthis));},_doSearch:.utils.lazyLoading"]').text(ips.getString('editorImageMaxHeight',{'maxheight':heightInput.attr('max')}));}
if(!error){var editor=$('.cke.'+this.scope.attr('data-editorUniqueId')).closest('[data-ipsEd{"use tedItems::function()aItem');if(thisw.addClass('ips').removeClitem));});thiata('_editor');varon.positionElem(p,zIndex:ips.ui.zIndeout(function(){if(selectedButton();},_checkSelectedButton:function(){var button=this.scope.find('[data-action="insertSelected"]');this.scope.find('[data-action="clearAll"]').toggleClass('ipsButton_disabled',!(_.size(this._selectedItems)>0));button.toggleClass('ipsButton_disabled',!(_.size(this._selectedItems)>0));if(!_.size(this._selectedItems)){button.text(ips.getString('insertSelected'));}else{button.text(ips.pluralize(ips.getString('insertSelectedNum'),_.size(this._selectedItems)));}},_buildInsertData:function(element){var element=element.closest('.ipsAttach');var fileID=element.attr('data-fileid');var fileKey=element.attr('data-filekey');var type=(element.attr('data-fileType'))?element.attr('data-fileType'):'file';var url='';var image='';var extension='';var mimeType='';if(type=='image'){url=(element.attr('data-thumbnailurl'))?element.attr('data-thumbnailurl'):element.attr('data-fullsizeurl');if(url!=element.attr('data-fullsizeurl')){image=element.attr('data-fullsizeurl');}}else if(type=='video'){image=element.attr('data-fullsizeurl');mimeType=element.attr('data-mimeType');}else if(type=='audio'){mimeType=element.attr('data-mimeType');}else{url=(element.attr('data-filelink'))?element.attr('data-filelink'):'';}
extension=element.closest('[data-extension]').attr('data-extension');return{fileID:fileID,fileKey:fileKey,type:type,title:(type!='image')?element.find('[data-role="title"]').html():'',link:url,fullImage:image,extension:extension,mimeType:mimeType};},_buildInsert:function(item){var element=null;if(item.type=='image'){element=$('<img/>').attr({'data-fileid':item.fileID,'src':item.link,'data-unique':Math.random().toString(36).substr(2,9)}).addClass('ipsImage ipsImage_thumbnailed');if(item.extension){element.attr('data-extension',item.extension);}
if(item.fullImage){var link=$('<a>').attr('href',item.fullImage).addClass('ipsAttachLink ipsAttachLink_image');element.addClass('ipsImage_thumbnailed');link.append(element);element=link;}}else if(item.type=='video'){var element=$('<video controls>').attr({'class':'ipsEmbeddedVideo','data-controller':'core.global.core.embeddedvideo','data-fileid':item.fileID,'data-unique':Math.random().toString(36).substr(2,9)});var sourceElement=$('<source>').attr({'src':item.fullImage,'type':item.mimeType});element.append(sourceElement);var fallbackLink=$('<a>').addClass('ipsAttachLink').attr('href',ips.getSetting('baseURL')+'applications/core/interface/file/attachment.php?id='+item.fileID+(item.fileKey?'&key='+item.fileKey:'')).html(item.title);element.append(fallbackLink);}else if(item.type=='audio'){var element=$('<audio controls>').attr({'data-controller':'core.global.core.embeddedaudio','src':ips.getSetting('baseURL')+'applications/core/interface/file/attachment.php?id='+item.fileID+(item.fileKey?'&key='+item.fileKey:''),'data-fileid':item.fileID,'data-unique':Math.random().toString(36).substr(2,9),'type':item.mimeType});var fallbackLink=$('<a>').addClass('ipsAttachLink').attr('href',ips.getSetting('baseURL')+'applications/core/interface/file/attachment.php?id='+item.fileID+(item.fileKey?'&key='+item.fileKey:'')).html(item.title);element.append(fallbackLink);}else{element=$('<a>').addClass('ipsAttachLink').html(item.title).attr('data-fileid',item.fileID).attr('data-fileext',item.extension);if(item.link){element.attr('href',item.link);}else{var url=ips.getSetting('baseURL')+'applications/core/interface/file/attachmeeo'||item.thtml;}});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.controller.register('core.global.editor.link',{_typingTimer:null,_textTypingTimer:null,_ajaxObj:null,initialize:function(){this.on('submit','form',this.formSubmit);this.on('click','.cEditorURLButtonInsert',this.formSubmit);this.on('click','[data-action="linkRemoveButton"]',this.removeLink);this.scope.find('[data-role="linkURL"]').focus();},formSubmit:function(e){e.preventDefault();this.insertLink(e);},insertLink:function(e){var url=this.scope.find('[data-role="linkURL"]').val().replace(/'/g,'%27').replace(/"/g,'%22').replace(/</g,'%3C').replace(/>/g,'%3E');if(!url){$(this.scope).find('.ipsFieldRow.ipsFieldRow_fullWidth').addClass('ipsFieldRow_error');return;}else{$(this.scope).find('.ipsFieldRow.ipsFieldRow_fullWidth').removeClass('ipsFieldRow_error');}
$(this.scope).find('.elLinkError').remove();if(!url.match(/^[a-z]+\:\/\//i)&&!url.match(/^mailto\:/i)&&!url.match(/^\#/)){url='http://'+url.replace(/^\/*/,'');}
var editor=CKEDITOR.instances[$(this.scope).data('editorid')];var selection=editor.getSelection();if(!_.isUndefined(editor._linkBookmarks)){selection.selectBookmarks(editor._linkBookmarks);delete editor._linkBookmarks;}
var selectedElement=selection.getSelectedElement();if(selectedElement&&selectedElement.is('img')){var selectedElement=$(selection.getSelectedElement().$);if(!selectedElement.parent().is('a')){var element=CKEDITOR.dom.element.createFromHtml("<a href='"+url+"'>"+selectedElement[0].outerHTML+"</a>");editor.insertElement(element);}
else{selectedElement.parent().attr('href',url).removeAttr('data-cke-saved-href');}
this.scope.find('input.cEditorURL').val('');this.trigger('closeDialog');}else if(selectedElement&&(selectedElement.is('a')&&$(selection.getSelectedElement().$).children().is('img'))){selectedElement.setAttribute('href',url).removeAttribute('data-cke-saved-href');this.scope.find('input.cEditorURL').val('');this.trigger('closeDialog');}else{if($(this.scope).data('image')){this.scope.find('[data-role="linkURL"]').addClass('ipsField_loading');this.scope.find('[data-action="linkButton"]').prop('disabled',true);var scope=this.scope;var self=this;var img=new Image();img.onerror=function(){scope.find('[data-role="linkURL"]').removeClass('ipsField_loading');scope.find('[data-action="linkButton"]').prop('disabled',false);scope.find('.ipsFieldRow.ipsFieldRow_fullWidth').addClass('ipsFieldRow_error');};img.onload=function(){var ajaxUrl=editor.config.controller+'&do=validateLink'
if($(this.scope).attr('data-image')){ajaxUrl+='&image=1';}
ips.getAjax()(ajaxUrl,{data:{url:url,width:img.width,height:img.height,image:1},type:'post'}).done(function(response){if(response.embed){scope.find('[data-role="linkURL"]').removeClass('ipsField_loading');scope.find('[data-action="linkButton"]').prop('disabled',false);scope.find('input.cEditorURL').valieldRow.ipsFieldRow_fullWidth').addClass('ipsFieldRow_error');if(!_.isUndefined(response.errorMessage)){scope.find('.ipsFieldRow.ipsFieldRow_fullWidth').append("<span class='elLinkError ipsType_warning'>"+response.errorMessage+"</span>");}}}).fail(function(){scope.find('[data-role="linkURL"]').removeClass('ipsField_loading');scope.find('[data-action="linkButton"]').prop('disabled',false);scope.find('.ipsFieldRow.ipsFieldRow_fullWidth').addClass('ipsFieldRow_error');});}
img.src=url;}else{if(this.scope.find('[data-rlt;').replace(/>/g,'ontroller.regis;if(this._ajax&ditorID}};ajaxData.data[this._editorID]=data.editorContent;ips.getAjax()(data.url,ajaxData).done(function(response){var prprevie},_sendHeight:function(){this._sendMessage({message:'previewHeight',height:$(document).height()});}});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.controller.register('core.global.editor.stockReplies',{initialize:function(){this.on('click','.ipsStockReplies_row',this.insertTemplate);this.on(document,'menuOpened',this.menuOpened);this.setup();},setup:function(){this._editorId=$(this.scope).data('editorid');this._editor=CKEDITOR.instances[this._editorId];},insertTemplate:function(e){e.stopPropagation();e.preventDefault();var template=$(e.target);var _self=this;ips.getAjax()(this._editor.config.controller+'&do=storedReplies&id='+template.attr('data-templatesId'),{type:'POST'}).done(function(response){if(!response.error){_self._editor.insertElement(CKEDITOR.dom.element.createFromHtml('<div>'+response.reply+'</div>'));}});this.scope.trigger('closeMenu');},menuOpened:function(e,data){if(data.menu.attr('data-controller')=='core.global.editor.stockReplies'){setTimeout(function(){var resultsbox=this.scope.find('[data-role="stockRepliesLoading"]');if(resultsbox.hasClass('ipsLoading')){var _self=this;ips.getAjax()(this._editor.config.controller+'&do=storedReplies',{type:'POST'}).done(function(response){var dat,{titllt}));});}}.bins.addUploaderFile);this.on('removeAllFiles',this.removeAllFiles);this.on('fileDeleted',this.fileDeleted);this.setup();},setup:function(){this.scope.find('[data-role="fileContainer"]').each(function(){if($(this).children().length>0){$(this).parent().removeClass('ipsHide');}});},removeAllFiles:function(e,data){this.scope.find('[data-role="files"], [data-role="images"], [data-role="videos"], [data-role="audio"]').hide();this.scope.find('[data-role="fileList"]').hide();},addUploaderFile:function(e,data){e.stopPropagation();var container=null;var template='core.attachments.';this.scope.find('[data-role="fileList"]').show();if(data.isImage){container=this.scope.find('[data-rol.ui.uploader.getExtensionIcon(data.title);container.show().find('[data-role="fileContainer"]').append(ips.templates.render(template,data));},fileDeleted:function(e,data){var count=0;this.scope.find('[data-role="fileContainer"]').each(function(){if(!$(this).find('.ipsAttach').length){$(this).closest('[data-role="files"], [data-role="images"], [data-role="videos"], [data-role="audio"]').hide();count++;}});if(count==4){this.scope.find('[data-role="fileList"]').hide();}}});}(jQuery,_));;
;(function($,_,undefined){"use strict";ips.controller.register('core.global.stockart.pixabay',{initialize:function(){this.on('clibaySearch"]'ollScope[0].scroll;if(thiss('ipsHide');this._doSearch(this._lastVal);}},stopSearchPixabay:function(e){if(this._typeTimer){clearInterval(this._typeTimer);this._typeTimer=null;}},_typing:function(){var textElem=this.scope.find('[data-role="pixabaySearch"]');if(this._lastVal==textElem.val()){return;}
this.scope.find('[data-role="pixabayMore"]').attr('data-offset',0);this.scope.find('.ipsMenu_innerContent').animate({scrollTop:"0"},250);this._doSearch(textElem.val());this._lastVal=textsRow});pos=0;gifsForThisRow='';}});Debug.log(data.pagination.total_count);Debug.log(offset+_self._perPage);if(offset>0||data.pagination.total_count>offset+_self._perPage){_self.scope.find('[data-role="pixabayMoreLoading"]').addClass('ipsHide');_self._status='ready';}
if(data.pagination.total_count<=offset+_self._perPage){_self.scope.find('[data-role="pixabayMoreLoading"]').addClass('ipsHide');_self._status='done';}}
resultsbox.removeClass('ipsLoading').html(result);});},selectImage:function(e){var image=$(e.target);var pluploadObj=this.uploader;pluploadObj.find('.ipsAttachment_loading').show();pluploadObj.find('.ipsAttachment_dropZoneSmall_info').hide();ips.getAjax()(ips.getSetting('baseURL')+'?app=core&module=system&controller=pixabay&do=getById&id='+image.attr('data-id')).done(function(response){var randomId=Math.random().toString(36).substring(7);var bstr=atob(response.content);var n=bstr.length;var u8arr=new Uint8Array(n);while(n--){u8arr[n]=bstr.charCodeAt(n);}
var file=new File([u8arr],response.filename,{type:response.type});pluploadObj.trigger('injectFile',{file:file});});this._status='init';this.scope.find('[data-role="pixabaySearch"]').val('');this.scope.find('[data-role="pixabayLoading"]').addClass('ipsLoading').html('');this.scope.trigger('closeDialog');}});}(jQuery,_));;