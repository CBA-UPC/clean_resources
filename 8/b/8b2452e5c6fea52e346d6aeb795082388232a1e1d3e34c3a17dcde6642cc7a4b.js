(window.wpJsonpExCoAdPlayer=window.wpJsonpExCoAdPlayer||[]).push([[0,1,2,4,5,6,7,8,9],{15:function(t,n,e){"use strict";e.r(n),e.d(n,"PLUGIN_NAME",(function(){return o}));var i=e(39);e.d(n,"API",(function(){return i.API}));var r=e(38);e.d(n,"VAST_DEMAND_TPL",(function(){return r.VAST_DEMAND_TPL})),e.d(n,"RTB_DEMAND_TPL",(function(){return r.RTB_DEMAND_TPL})),e.d(n,"MEDIA_TYPES",(function(){return r.MEDIA_TYPES}));var a=e(40);e.d(n,"PLUGIN_EVENTS",();var o="tbla"},16:function(t,n,e){"use strict";e.r(n);var i=e(44),r=e(1),a=e(15),o=e(42),c=e(41),u=e(0),s=function(t,n,e,i){return new(e||(e=Promise))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function c(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(o,c)}u((i=i.apply(t,n||[])).next())}))},_=function(t,n){var e,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(t,o)}catch(t){a=[6,t],i=0}finally{e=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},d=window.location.href.includes("exco-tbla-debug=true"),l=function(){function t(t){this.completionSent=!1,this.adList=new Map,Object(c.setCallbacks)(t.callbacks),r.b.emit(r.a.PLUGIN.ENABLED,{name:a.PLUGIN_NAME}),this._listenToAdProgress(),this._listenToAdEvents(),this._listenToStickyEvents(),this._listenToCompletionEvent(),this._handleViewabilityEvent(),this._listenToRefreshEvent()}return t.prototype.apply=function(t){var n;return s(this,void 0,void 0,(function(){var e,i,r=this;return _(this,(function(o){return e=t.find((),i=(null===(n=null==e?void 0:e.dmid)||void 0===n?void 0:n.split("-")[0])||"317149441",a.VAST_DEMAND_TPL.dmid=a.VAST_DEMAND_TPL.dmid.replace("{supplyId}",i),a.RTB_DEMAND_TPL.dmid=a.RTB_DEMAND_TPL.dmid.replace("{supplyId}",i),[2,t.filter(()]}))}))},t.prototype._isTaboolaDemand=function(t){return t.demandId?t.demandId===a.VAST_DEMAND_TPL.dmid||t.demandId===a.RTB_DEMAND_TPL.dmid:t.id===a.VAST_DEMAND_TPL.id||t.id===a.RTB_DEMAND_TPL.id},t.prototype._listenToRefreshEvent=function(){var t=this;r.b.on(r.a.PLUGIN.ACTION.AUCTION,(function(n){var e=n.players;return s(t,void 0,void 0,(function(){var t;return _(this,(function(n){switch(n.label){case 0:return t=[],0!==this.adList.size?[3,2]:(u.a.debug("[Plugin] Fetching WF"),[4,Object(i.getDemands)(e,{debug:d})]);case 1:t=n.sent(),n.label=2;case 2:return[2,t]}}))}))}))},t.prototype._handleViewabilityEvent=function(){var t=this;r.b.on(r.a.AD.IMPRESSION,(),window.addEventListener("visibilitychange",()},t.prototype._sendViewabilityEvent=function(){var t=this;setTimeout((function(){if(t.impressionData){var n=t.impressionData,e=n.demand,i=n.players;if(!i.closed&&i.isInView&&"visible"===document.visibilityState){var a=Object(o.getEventData)(e),c=Object(o.getEventName)(r.a.AD.VIEWABILITY);Object(o.sendEvent)(c,a),t.impressionData=null}}}),2e3)},t.prototype._listenToStickyEvents=function(){var t=this;r.b.on(r.a.STICKY.CLOSED,(function(){r.b.emit(r.a.PLAYER.ACTION.CLOSE),t._toggleUpNext(!0),t.impressionData=null})),r.b.on(r.a.STICKY.OPENED,()},t.prototype._listenToCompletionEvent=function(){var t=this;r.b.on(r.a.AD.STARTED,(),r.b.on(r.a.AD.CLICKED,(function(n){var e=n.demand,i=Object(o.getEventData)(e);t._sendCompletionEvent(i)})),r.b.on(r.a.AD.SKIPPED,(function(n){var e=n.demand,i=Object(o.getEventData)(e);t._sendCompletionEvent(i),t._stopTimeUpdate(),t._handleSADemand(e),t.impressionData=null})),r.b.on(r.a.AD.TIME_UPDATE,(function(n){var e=n.demand,i=n.time,r=Object(o.getEventData)(e);i>=30&&t._sendCompletionEvent(r)})),r.b.on(r.a.AD.COMPLETED,(function(n){var e=n.demand,i=e.getProgress().time;if(clearInterval(t.timeUpdateInterval),i<31){var r=Object(o.getEventData)(e);t._sendCompletionEvent(r)}t.playingDemand=null,t.completionSent=!1,t.impressionData=null,t._stopTimeUpdate(),t._handleSADemand(e)}))},t.prototype._removeFromAdList=function(t){this._isTaboolaDemand(t)&&this.adList.has(this._adUniqueId(t))&&(this.adList.delete(this._adUniqueId(t)),u.a.debug("[Plugin] Ad removed from list"),0===this.adList.size&&u.a.debug("[Plugin] Empty ad list"))},t.prototype._adUniqueId=t.prototype._listenToAdEvents=function(){var t=this;r.b.on(r.a.AD.ERROR,(),r.b.on(r.a.AD.XML_PARSED,(),r.b.on(r.a.AD.INIT,(function(n){var e=n.demand;t._isTaboolaDemand(e)&&(e.impressionData&&e.impressionData.pricing||(e.impressionData=e.apiImpressionData))})),r.b.on(r.a.INTERNAL.AD.FETCHED,(function(n){var e=n.ad;t._isTaboolaDemand(e)&&t.adList.set(t._adUniqueId(e),e)})),r.b.on(r.a.AD.STARTED,(function(n){var e,i,r=n.demand;t.playingDemand=r,void 0!==(null===(i=null===(e=null==r?void 0:r.capping)||void 0===e?void 0:e.current)||void 0===i?void 0:i.imp)&&r.capping.current.imp++,t._removeFromAdList(r),t._startTimeUpdate()})),r.b.on(r.a.AD.ANY,(function(t){if(this.event!==r.a.AD.XML_PARSED){var n=t.demand,e=Object(o.getEventData)(n),i=Object(o.getEventName)(this.event);this.event===r.a.AD.IMPRESSION&&u.a.debug("[Plugin] Ad Impression"),Object(o.sendEvent)(i,e)}}))},t.prototype._handleSADemand=t.prototype._stopTimeUpdate=t.prototype._startTimeUpdate=function(){var t=this;this._stopTimeUpdate(),this.timeUpdateInterval=setInterval((function(){if(t.playingDemand){var n=t.playingDemand.getProgress();(null==n?void 0:n.time)&&r.b.emit(r.a.AD.TIME_UPDATE,{demand:t.playingDemand,time:null==n?void 0:n.time})}}),500)},t.prototype._handleXmlPricing=function(t){var n=t.impressionData,e=t.ad.pricing;e&&(n&&n.pricing||e.value&&(t.impressionData={pricing:parseFloat(e.value),currency:e.currency}))},t.prototype._sendCompletionEvent=function(t){this.completionSent||(this.completionSent=!0,Object(o.sendEvent)(a.PLUGIN_EVENTS.COMPLETION,t))},t.prototype._toggleUpNext=function(t){var n=document.querySelector(".tbl-next-up-position-right");n&&n.classList.toggle("in-viewport",t)},t.prototype._listenToAdProgress=function(){r.b.on(r.a.AD.PROGRESS,(function(t){var n=t.quartile,e=t.demand;switch(n){case 1:r.b.emit(r.a.AD.FIRST_QUARTILE,{demand:e});break;case 2:r.b.emit(r.a.AD.MIDPOINT,{demand:e});break;case 3:r.b.emit(r.a.AD.THIRD_QUARTILE,{demand:e})}}))},t}();n.default=l},38:function(t,n,e){"use strict";e.r(n),e.d(n,"VAST_DEMAND_TPL",(function(){return i})),e.d(n,"RTB_DEMAND_TPL",(function(){return r})),e.d(n,"MEDIA_TYPES",(function(){return a}));var i={type:"vast",id:"1837283097",dmid:"{supplyId}-1837283097",domainId:"320",dp:"Taboola VAST Demand",gtag:!0},r={type:"rtb",id:"2099606595",dmid:"{supplyId}-2099606595",domainId:"320",dp:"Taboola RTB Demand",gtag:!0},a={video:1,jsvpaid:2,jsima:5,omid:6}},39:40:41:function(t,n,e){"use strict";e.r(n),e.d(n,"setCallbacks",(function(){return r})),e.d(n,"getCallback",(function(){return a}));var i=[],r=a=function(t){if(i){var n=i.find(();if(n&&n.fn)return n.fn}return function(){}}},42:function(t,n,e){"use strict";e.r(n),e.d(n,"updateEventsGlobalData",(function(){return u})),e.d(n,"getEventData",(function(){return s})),e.d(n,"getEventName",(function(){return _})),e.d(n,"sendEvent",(function(){return d}));var i=e(1),r=e(41),a=e(15),o=function(){return(o=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},c={},u=s=function(t){var n,e,i,r,u=t.extraData||{},s=o(o(o({},c),u),{viewability:t.viewability,progress:t.progress,vastPrice:parseFloat((null===(n=null==t?void 0:t.impressionData)||void 0===n?void 0:n.pricing)||(null===(e=null==t?void 0:t.extraData)||void 0===e?void 0:e.price)),url:t.mediaURL||u.url,created:u.created,waterfallTagId:u.waterfallTagId,sequenceId:u.sequenceId,mty:a.MEDIA_TYPES[t.adType]||a.MEDIA_TYPES.video,title:null===(i=u.nas)||void 0===i?void 0:i.title});return"prebid"===t.type&&(s.prebid={bidder:t.bidder,price:null===(r=null==t?void 0:t.impressionData)||void 0===r?void 0:r.pricing,campaignId:t.vastId}),s},_=function(t){return"".concat(a.PLUGIN_EVENTS.PREFIX,".").concat(t.replace(".","-"))},d=function(t,n){try{var e=window.structuredClone?window.structuredClone(n):JSON.parse(JSON.stringify(n)),a="".concat(t);Object(r.getCallback)(a)(e),i.b.emit(i.a.PLUGIN.EVENT,{eventName:a,data:e})}catch(t){}}},43:function(t,n,e){"use strict";e.r(n),e.d(n,"applyMacros",(function(){return r}));var i={"%%player-width%%":function(t){return t.width},"%%player-height%%":function(t){return t.height},"%%ua%%":"%%referrer%%":"%%cirf%%":function(){return encodeURIComponent("".concat(window.location.protocol,"//").concat(window.location.host))},"%%page-url%%":function(){return window.location.href},"%%video-url%%":"%%vidlength%%":function(t){var n,e;return null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.duration},"%%title%%":function(t){var n,e;return null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.title},"%%description%%":function(t){var n,e;return null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.description},"%%tag%%":"%%keywords%%":function(t){var n,e,i=null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.keywords;if(i&&i.length)return i.join(",")},"%%vertical%%":function(t){var n,e,i=null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.categories;if(i&&i.length)return i[0]},"%%ip%%":"%%domain%%":"%%country%%":"%%timestamp%%":"%%cb%%":"[CACHEBUSTING]":function(){return"".concat(Date.now()).substring(0,8)}},r=function(t,n){if(!t)return t;var e=t;return Object.entries(i).forEach((function(t){var i=t[0],r=(0,t[1])(n);r&&(e=e.replace(new RegExp(i),"img"),r))})),e}},44:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"getWfIndex",(function(){return getWfIndex})),__webpack_require__.d(__webpack_exports__,"getDemands",(function(){return getDemands}));var _services_ng_events__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_callbacks__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(41),_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15),_events__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(42),_macros__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(43),__assign=__awaiter=__generator=WF_COUNTER=0,updateProtocol=function(t){try{var n=new URL(t);return n.protocol!==window.location.protocol&&(n.protocol=window.location.protocol),n.toString()}catch(t){}return t},mapDemands=function(t,n){return(t||[]).map((function(t,e){var i,r=6===t.advType||8===t.advType?_constants__WEBPACK_IMPORTED_MODULE_2__.RTB_DEMAND_TPL:_constants__WEBPACK_IMPORTED_MODULE_2__.VAST_DEMAND_TPL;return __assign(__assign({},r),{url:updateProtocol(Object(_macros__WEBPACK_IMPORTED_MODULE_4__.applyMacros)(t.url,n)),vastXml:t.vast,title:null===(i=t.nas)||void 0===i?void 0:i.title,impressionData:{pricing:parseFloat(t.price||t.cpmFloor),price:parseFloat(t.price||t.cpmFloor),currency:"USD"},extraData:__assign(__assign({},t),{sequenceId:e,waterfallTagId:getWfIndex(),created:(new Date).getTime()}),capping:{imp:1,current:{imp:0}}})}))},getWfIndex=getDemands=function(players,options){return void 0===options&&(options={}),__awaiter(void 0,void 0,void 0,(function(){var url,res,raw,wf,demands,error_1;return __generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,4]),url=Object(_callbacks__WEBPACK_IMPORTED_MODULE_1__.getCallback)("_generateUrl")(),[4,fetch(url||_constants__WEBPACK_IMPORTED_MODULE_2__.API.WF.URL,{credentials:"include"})];case 1:if(res=_a.sent(),!res.ok)throw new Error("HTTP error! Status: ".concat(res.status));return[4,res.text()];case 2:return raw=_a.sent(),wf=raw,wf=wf&&wf.startsWith("(")?eval(raw):JSON.parse(wf),WF_COUNTER++,demands=mapDemands(wf.tags||[],players),wf.externalPrebidTags&&Object(_events__WEBPACK_IMPORTED_MODULE_3__.updateEventsGlobalData)({externalPrebidTags:wf.externalPrebidTags}),demands&&demands.length&&demands.forEach((function(t){_services_ng_events__WEBPACK_IMPORTED_MODULE_0__.b.emit(_services_ng_events__WEBPACK_IMPORTED_MODULE_0__.a.PLUGIN.EVENT,{eventName:_constants__WEBPACK_IMPORTED_MODULE_2__.PLUGIN_EVENTS.TAG_STARTED,data:Object(_events__WEBPACK_IMPORTED_MODULE_3__.getEventData)(t)})})),_services_ng_events__WEBPACK_IMPORTED_MODULE_0__.b.emit(_services_ng_events__WEBPACK_IMPORTED_MODULE_0__.a.PLUGIN.AUCTION,{waterFallSize:demands.length,waterFallIndex:WF_COUNTER}),[2,options.debug?[]:demands];case 3:return error_1=_a.sent(),[3,4];case 4:return[2,[]]}}))}))}}}]);