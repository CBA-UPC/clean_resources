window.insCountdown=function(e,t){return this.countInterval=null,this.totalSecond=0,this.localStorageDataKey=e.campID+"-countdown-values",this.daysSeparatorSelector=".ins-countdown-days-separator",this.isSupportedLocalStorage="undefined"!=typeof localStorage,this.init=function(){switch(e.type){case"timer":var t=this.isSupportedLocalStorage?Insider.storage.get(this.localStorageDataKey,null,!0):null;this.values=null,"0"!==e.campID.toString()&&t?this.values=t:this.values={days:0,hours:e.timerEndHour,minutes:e.timerEndMinute,seconds:0},this.hideDay(e.elements.days),e.elements.seconds.show(),this.totalSecond=60*this.values.hours*60+60*this.values.minutes+this.values.seconds;break;case"date":var s=e.endDate,a=e.endHour,n=new Date,i=n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate();if(void 0!==s){var o=s.split("/"),l=o[0],r=o[1];i=o[2]+"/"+r+"/"+l}var d=(new Date).getTime(),u=new Date(i+" "+a).getTime()-d;this.calculateTime(u),e.elements.days.removeClass("hide-element").show(),Insider.dom(this.daysSeparatorSelector).removeClass("hide-element").show(),e.elements.seconds.hide(),e.afterFinishText&&u<=0&&e.elements.finishTextElement.text(e.afterFinishText);break;case"recurring":var h=new Date,c=e.recurringEndHour.split(":"),v=new Date;if(0===e.campID){var m=e.recurringStartHour.split(":");v=new Date(h.getFullYear(),h.getMonth(),h.getDate(),m[0],m[1],0)}u=new Date(h.getFullYear(),h.getMonth(),h.getDate(),c[0],c[1],0)-v,this.calculateTime(u),this.hideDay(e.elements.days),e.elements.seconds.show()}e.hasOwnProperty("countdownSecond")&&("on"!==e.countdownSecond?e.elements.seconds.hide():e.elements.seconds.show()),"on"===e.countdownHideDays&&0===this.values.days&&e.elements.days&&this.hideDay(e.elements.days),this.count()},this.calculateTime=function(e){var t=Math.abs(e)/1e3,s=Math.floor(t/86400);t-=86400*s;var a=Math.floor(t/3600)%24;t-=3600*a;var n=Math.floor(t/60)%60;t-=60*n;var i=Math.ceil(t%60);if(e<0)return this.values={days:0,hours:0,minutes:0,seconds:0},void(this.totalSecond=0);this.values={days:s,hours:a,minutes:n,seconds:i},this.totalSecond=24*s*60*60+60*a*60+60*n+i},this.hideDay=function(e){e.addClass("hide-element").hide(),Insider.dom(this.daysSeparatorSelector).addClass("hide-element").hide()},this.count=function(){var s=this;t(s.values),this.countInterval=setInterval(function(){s.totalSecond>0?(--s.values.seconds,s.values.minutes>=0&&s.values.seconds<0&&(s.values.seconds=59,--s.values.minutes),s.values.hours>=0&&s.values.minutes<0&&(s.values.minutes=59,--s.values.hours),s.values.days>=0&&s.values.hours<0&&(s.values.hours=23,--s.values.days),--s.totalSecond,s.totalSecond<=0&&"on"===e.closeOnClick&&Insider.eventManager.dispatch("closeCampaign"+e.campID),s.totalSecond<=0&&e.afterFinishText&&e.elements.finishTextElement.text(e.afterFinishText),"on"===e.countdownHideDays&&0===s.values.days&&e.elements.days.is(":visible")&&this.hideDay(e.elements.days),t(s.values),this.isSupportedLocalStorage&&Insider.storage.set({name:s.localStorageDataKey,value:s.values,expires:90},null,!0)):clearInterval(s.countInterval)}.bind(this),1e3)},this.init(),this};