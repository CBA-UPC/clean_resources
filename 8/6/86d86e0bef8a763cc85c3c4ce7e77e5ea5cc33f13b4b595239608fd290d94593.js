!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[7456],{60085:(e,t,s)=>{s.d(t,{Z:()=>b});var o=s(50209),n=s.n(o),i=s(5754),r=s.n(i),l=s(95004),a=s(79153),u=s(93853),d=s(38740),h=s(53714),p=s(43684),c=s(94522),g=s(45051);let S={suggestionsList:"ZdQlM",isRibbon:"bRI1d"};var f=s(2629),m={[p.I2.Top]:{top:-1*h.AF},[p.I2.Bottom]:{top:3*h.AF}};class b extends l.Component{constructor(){super(...arguments),n()(this,"state",{softSelectedIndex:null,isFocused:!1}),n()(this,"getSoftSelectedSuggestion",()=>{var e=this.props,t=e.suggestions,s=e.popularSuggestions,o=this.state.softSelectedIndex;if(null!==o){if(o<t.length)return t[o];if(o<this.allSuggestionsLength())return s[o-t.length]}return null}),n()(this,"shouldRenderHotkeyComponent",()=>this.props.isShowing&&!!this.allSuggestionsLength()),n()(this,"allSuggestionsLength",()=>{var e=this.props,t=e.suggestions,s=e.popularSuggestions;return t.length+s.length}),n()(this,"renderHotkeys",()=>(0,f.jsx)(d.e.Consumer,{children:e=>{var t=e.hotkeyWrapper;return t?(0,f.jsx)(t,{shouldRenderHotkeyComponent:this.shouldRenderHotkeyComponent(),shouldDisableParentControlOfHotkeys:!0,shouldDisableEnterAsSubmit:!0,children:this.renderHotkeyComponent()}):this.renderHotkeyComponent()}})),n()(this,"renderHotkeyComponent",()=>(0,f.jsx)(u.ZP,{hotkey:this.getHotkeyCommands(),disableAllButMyHotkeys:!0})),n()(this,"getHotkeyCommands",()=>{var e=this.props,t=e.searchText,s=e.getSearchTextFromSuggestion,o=e.hotkey,n=[{key:u.SV.Escape,command:this.unfocusAndClose,allowInputs:!0},{key:u.SV.Enter,command:this.selectCurrentSoftSelection,allowInputs:!0},{key:u.SV.Tab,command:this.selectCurrentSoftSelection,allowInputs:!0},{key:u.SV.Up,command:this.softSelectPreviousOption,allowInputs:!0},{key:u.SV.Down,command:this.softSelectNextOption,allowInputs:!0},{key:u.SV.Left,command:this.unfocus,triggersDefault:!0,allowInputs:!0},{key:u.SV.Backspace,command:this.unfocus,triggersDefault:!0,allowInputs:!0},...o||[]];return s(this.getSoftSelectedSuggestion())!==t&&n.push({key:u.SV.Right,command:this.selectIfFocused,triggersDefault:!0,allowInputs:!0}),n}),n()(this,"unfocus",()=>{this.state.isFocused&&(this.setState({isFocused:!1,softSelectedIndex:null}),this.props.onUnfocus&&this.props.onUnfocus())}),n()(this,"unfocusAndClose",()=>{var e=this.props.onClose;this.unfocus(),e()}),n()(this,"renderSuggestions",e=>{var t=this.props,s=t.suggestions,o=t.popularSuggestions,n=t.popularHeader,i=t.searchText,l=t.onSelection,a=t.renderSuggestion,u=t.renderEmptySuggestions,d=this.state,h=d.softSelectedIndex,p=d.isFocused;return(!!this.allSuggestionsLength()||u)&&(0,f.jsx)("div",{contentEditable:!1,children:(0,f.jsxs)("div",{className:r()(S.suggestionsList,{[S.isRibbon]:e}),children:[s.map((e,t)=>(0,f.jsx)("span",{role:"button",onClick:this.clickSuggestion,children:a({searchText:i,suggestion:e,onSelection:l,key:t,onSoftSelection:this.onSoftSelection,isSelected:t===h,isFocused:t===h&&p})},t)),o.length>0&&n,o.map((e,t)=>(0,f.jsx)("span",{role:"button",onClick:this.clickSuggestion,children:a({searchText:i,suggestion:e,onSelection:l,key:t+s.length,onSoftSelection:this.onSoftSelection,isSelected:t+s.length===h,isFocused:!!h&&p&&t===h-s.length})},t+s.length)),!this.allSuggestionsLength()&&u&&u()]})})}),n()(this,"softSelectNothing",()=>{this.props.noSoftSelectionOnNewSuggestions?this.setState({softSelectedIndex:null}):this.onSoftSelection(null)}),n()(this,"softSelectFirstOption",()=>!this.props.suggestions.length&&this.props.popularSuggestions.length?this.onSoftSelection(this.props.popularSuggestions[0]):this.onSoftSelection(this.props.suggestions[0])),n()(this,"onSoftSelection",e=>{var t,s;this.setState({softSelectedIndex:this.getIndexFromSuggestion(e)}),null===(t=(s=this.props).onSoftSelection)||void 0===t||t.call(s,e)}),n()(this,"getIndexFromSuggestion",e=>{var t=this.props,s=t.suggestions,o=t.popularSuggestions;if(null!==e){for(var n=0;n<this.allSuggestionsLength();n+=1)if(s[n]&&(0,c.X)(s[n],e)||o[n-s.length]&&(0,c.X)(o[n-s.length],e))return n}return null}),n()(this,"softSelectPreviousOption",,n()(this,"softSelectNextOption",,n()(this,"modifySoftSelectedIndex",e=>{var t,s=null!==(t=this.state.softSelectedIndex)&&void 0!==t?t:-1,o=s+e,n=this.allSuggestionsLength();n&&(s+e>=n?o=0:s+e<0&&(o=n-1),this.setState({softSelectedIndex:o,isFocused:!0},()=>{var e,t;null===(e=(t=this.props).onSoftSelection)||void 0===e||e.call(t,this.getSoftSelectedSuggestion())}))}),n()(this,"selectIfFocused",,n()(this,"selectCurrentSoftSelection",()=>{var e=this.props.allowNullSelection,t=this.getSoftSelectedSuggestion();(t||e)&&this.props.onSelection(t),this.setState({softSelectedIndex:null})}),n()(this,"clickSuggestion",,n()(this,"isRibbon",()=>!!this.props.autocompleteContainerRef&&!!this.props.autocompleteContainerRef.current)}componentDidMount(){var e=this.props,t=e.isShowing,s=e.noSoftSelectionOnNewSuggestions;window.addEventListener("mousedown",this.unfocus),window.addEventListener("keypress",this.unfocus),t&&this.allSuggestionsLength()&&!s?this.softSelectFirstOption():this.softSelectNothing()}omponentDidUpdate(e){var t=this.props,s=t.suggestions,o=t.popularSuggestions,n=t.isShowing,i=t.noSoftSelectionOnNewSuggestions;!n||e.isShowing&&(0,c.X)(e.suggestions,s)&&(0,c.X)(e.popularSuggestions,o)||(this.allSuggestionsLength()&&!i?this.softSelectFirstOption():this.softSelectNothing())}render(){var e=this.props,t=e.autocompleteContainerRef,s=e.isShowing,o=e.shouldEscapeParentOverflow,n=e.positionBasedOffsetModifiers,i=e.popoverWidth,r=e.popoverMaxHeight,l=e.popoverPosition,u=e.toggle;return(0,f.jsxs)(f.Fragment,{children:[this.isRibbon()?s&&(null==t?void 0:t.current)&&(0,a.createPortal)(this.renderSuggestions(!0),t.current):s&&(0,f.jsx)(h.ZP,{isOpen:s,toggle:u||null,position:l||p.I2.BottomStart,positionBasedOffsetModifiers:n||m,height:"auto",component:this.renderSuggestions(),noTransitions:!0,usePortals:o,width:i,maxHeight:r,targetWrapperDisplayInline:!0,children:(0,f.jsx)("a",{tabIndex:-1})}),this.renderHotkeys()]})}}n()(b,"defaultProps",{suggestions:[],popularSuggestions:[],onSoftSelection:g.Z})},38740:(e,t,s)=>{s.d(t,{e:()=>o});var o=(0,s(95004).createContext)({hotkeyWrapper:null,isEnterAsSubmitDisabled:!1})},48341:(e,t,s)=>{s.d(t,{Z:()=>g});var o=s(54138),n=s.n(o),i=s(50209),r=s.n(i),l=s(9156),a=s(95004),u=s(93853),d=s(38740),h=s(2629);class p extends a.Component{constructor(){super(...arguments),r()(this,"state",{disableHotkeysForTextEntryOverrideCount:0,disableEnterAsSubmitOverrideCount:0}),r()(this,"isEnterAsSubmitDisabled",()=>{var e;return(null===(e=this.props.hotkeyDisablerForTextEntryContext)||void 0===e?void 0:e.isEnterAsSubmitDisabled)||!!this.state.disableEnterAsSubmitOverrideCount}),r()(this,"canModifyDisableCounter",(e,t)=>!(-1===e&&0===t)),r()(this,"disableParentControlOfHotkeys",e=>{var t=e?1:-1;this.setState(e=>({disableHotkeysForTextEntryOverrideCount:this.canModifyDisableCounter(t,e.disableHotkeysForTextEntryOverrideCount)?e.disableHotkeysForTextEntryOverrideCount+t:e.disableHotkeysForTextEntryOverrideCount}))}),r()(this,"disableEnterAsSubmit",e=>{var t=e?1:-1;this.setState(e=>({disableEnterAsSubmitOverrideCount:this.canModifyDisableCounter(t,e.disableEnterAsSubmitOverrideCount)?e.disableEnterAsSubmitOverrideCount+t:e.disableEnterAsSubmitOverrideCount}))}),r()(this,"getHotkeyWrapperMethods",,r()(this,"hotkeyWrapper",function(e){var t=e.disableParentControlOfHotkeys,s=e.disableEnterAsSubmit;return class extends a.Component{omponentWillUnmountomponentDidUpdate(e){!e.shouldRenderHotkeyComponent&&this.props.shouldRenderHotkeyComponent?this.setHotkeyOptionsOnWrapper():e.shouldRenderHotkeyComponent&&!this.props.shouldRenderHotkeyComponent&&this.setHotkeyOptionsOnWrapper({unsetValues:!0})}etHotkeyOptionsOnWrapper(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.unsetValues,n=this.props,i=n.shouldRenderHotkeyComponent,r=n.shouldDisableParentControlOfHotkeys,l=n.shouldDisableEnterAsSubmit;this.lastUnsetValues=!!o,(i||o)&&(r&&t(!o),l&&(null==s||s(!o)))}}}(this.getHotkeyWrapperMethods())),r()(this,"getContextValue",(0,l.Z)({maxSize:1}))}render(){var e=this.props,t=e.children,s=e.shouldRenderHotkeyBlocker,o=e.hotkeyDisablerForTextEntryContext,n=this.state.disableHotkeysForTextEntryOverrideCount;return null!=o&&o.hotkeyWrapper?t:(0,h.jsxs)(h.Fragment,{children:[s&&!n&&(0,h.jsx)(u.ZP,{disable:u.z9}),(0,h.jsx)(d.e.Provider,{value:this.getContextValue(!!n),children:t})]})}}class c extends a.Component{render(){return(0,h.jsx)(d.e.Consumer,{children:e=>(0,h.jsx)(p,n()(n()({},this.props),{},{ref:this.props.forwardedRef,hotkeyDisablerForTextEntryContext:e}))})}}let g=c},49457:(e,t,s)=>{s.d(t,{m:()=>p,Z:()=>c});var o=s(5754),n=s.n(o),i=s(95004),r=s(79153),l=s(36696),a=s(78093);let u={wrapper:"kjdMf",popover:"Km9JA",snackbar:"Shb25",in:"gQ7Ed",out:"tpwfT",error:"BlTwC",success:"Dsy4L",tumblrbot:"PI3er",banner:"xak8H",info:"cxq6x"};var d=s(2629),h=new l.Z,p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"notice",s=arguments.length>2?arguments[2]:void 0;return{text:e,type:t,snackbarClass:s,id:h.next()}};let c=e=>{var t=e.containerRef,s=e.snackbars,o=e.removeSnackbar,l=e.isPopover,h=(0,i.useRef)();return(0,i.useEffect)(()=>{s.length&&(h.current=setTimeout(a.toastVisibleDurationInMs)),!s.length&&h.current&&clearTimeout(h.current)},[s]),(0,r.createPortal)((0,d.jsx)("div",{className:n()("kjdMf",{Km9JA:l}),children:s.map(e=>(0,d.jsx)("div",{className:n()("Shb25",e.snackbarClass,u[e.type]),children:e.text},e.id))}),t||document.body)}},94133:(e,t,s)=>{s.d(t,{Z:);var o=s(95004),n=s(78667),i=s(2629);let r=e=>{var t=e.fallback,s=e.children;return(0,n.bp)().features,(0,i.jsx)(o.Suspense,{fallback:t,children:s})}}}]);