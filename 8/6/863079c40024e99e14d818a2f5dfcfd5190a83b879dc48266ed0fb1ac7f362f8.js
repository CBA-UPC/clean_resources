(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8725],{45901:90521:83777:function(e,t,n){"use strict";n.d(t,{A:function(){return useGetWebBasedCaptureQuery}});var r=n(73235),i=n(66547),o=n(41270),a=n(26806);et u=(0,i.ZP)(_templateObject(),o._);,46085:60944:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var r=n(52322),i=n(2784),o=n(97185),a=n(92333),u=n(35771),s=n(45103),l=n(55287),c=n(99219),d=n(56909),p=n(52294),h=n(76497),f=n(5632),v=n(68549),m=n(79633),g=n(60720);let x=d.Z;function WebCaptureEditorNav(e){let{capture:t,selectedVersionId:n,setSelectedVersionId:i,handleSave:o,viewportSize:a,setViewportSize:u,scaleStrategy:d,updateScaleStrategy:S,state:C,dispatch:w}=e,y=(0,f.useRouter)();return(0,r.jsxs)(x,{children:[(0,r.jsxs)("div",{className:"flex h-full flex-1 items-center justify-between pr-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 py-3",children:[(0,r.jsx)(c.wyc,{"aria-label":"Go back to previous page",height:"35px",width:"20px",className:"cursor-pointer text-gray-100/50 hover:text-white",onClick:y.back}),(0,r.jsx)(c.nmT,{className:"h-4 w-4 text-white"}),(0,r.jsx)(v.Z,{capture:t})]}),(0,r.jsxs)("div",{className:"flex shrink-0 items-center gap-x-4",children:[(0,r.jsx)(g.ZP,{edits:C.edits,selectedVersionId:n,setSelectedVersionId:i,capture:t}),(0,r.jsx)(s.ZP,{selected:a,onChange:u}),(0,r.jsx)(l.Z,{selected:d,onChange:S})]})]}),(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(p.NI,{state:C,dispatch:w}),(0,r.jsx)(m.Z,{buttonText:"Save & Exit",onSave:o})]})]})}var S=n(32517),C=n(65416),w=n(50146),y=n(53354),M=n(19894),j=n(53954),T=n(71104),P=n(817),k=n(96414),WebCaptureEditor_EditorMain=e=>{var t;let{capture:n,setVersionId:o}=e,l=i.useRef(null),c=e.versionId||n.version.id,[{data:d,fetching:p}]=(0,y.Z)({variables:{recordId:n.id,...g.vu}}),h=null==d?void 0:null===(t=d.listVersionsForWebCapture)||void 0===t?void 0:t.find(,{fetching:f,built:v,error:m}=(0,M.Z)({nodeKey:null==h?void 0:h.nodeKey,playerElement:l.current,pause:p}),[x,N]=i.useReducer(P.Z,new k.IT({capture:n}));i.useEffect(()=>{N(new a.Oy(v))},[v]);let[D,_]=(0,i.useState)(n.scaleStrategy),[E,B]=(0,i.useState)(s.Z5.Desktop),[V,I]=(0,i.useState)(!1),[,W]=(0,w.D)(),[,Z]=(0,C.N)(),{workspace:z}=(0,j.cF)(),G=f||!v,O=!G&&!m&&!V,F=(0,i.useCallback)(async()=>{var t;if(!(null===(t=l.current)||void 0===t?void 0:t.contentDocument)||!O)return;let r=D!==n.scaleStrategy,i=x.edits.length>0||c!==e.capture.version.id||!!localStorage.getItem("debug:navattic:editor:save"),o=r||i;if(!o){(0,S.Vp)("No changes to publish"),e.exit();return}I(!0);let a=await (0,T.i)({capture:n,playerFrame:l.current,hasDomLevelEdits:i,scaleStrategy:D,updateWebCapture:W,createWebCaptureVersion:Z,workspace:z});if(I(!1),!a.ok){(0,S.Rn)(a.error);return}(0,S.Vp)("Published capture changes"),e.exit()},[O,Z,D,n,x.edits.length,c,e,W,z]);return(0,r.jsxs)("div",{className:"fixed flex h-full w-full flex-col",children:[(0,r.jsx)(WebCaptureEditorNav,{dispatch:N,state:x,capture:n,handleSave:F,scaleStrategy:D,updateScaleStrategy:_,viewportSize:E,setViewportSize:B,selectedVersionId:c,setSelectedVersionId:o}),(0,r.jsx)(u.Z,{scaleStrategy:D,ref:l,dispatch:N,state:x,fetchingOrBuilding:G,error:m,viewportSize:E,publishing:V,versionId:c,setVersionId:o})]})},N=n(81291),D=n(83777),_=n(47330),E=n(83122),B=n(60696),V=n(39391),I=n(70689),W=n.n(I);let CaptureEditorPage=()=>{var e;let t=(0,f.useRouter)(),n=t.query.capture_id,o=(0,E.K7)(t.query.v),a=(0,j.j_)(_.KG.Projects),u=a===B.PermissionAction.EDIT,[{data:s}]=(0,D.A)({variables:{id:n},pause:!u}),l=(0,i.useCallback)([t]);return u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.Z,{title:["Edit",(null==s?void 0:null===(e=s.getWebBasedCapture)||void 0===e?void 0:e.name)||"Untitled Capture"],includeSlug:!0}),(null==s?void 0:s.getWebBasedCapture)&&(0,r.jsx)(WebCaptureEditor_EditorMain,{versionId:o,setVersionId:e=>{t.replace({query:{...t.query,v:e}})},capture:s.getWebBasedCapture,exit:)]}):(0,r.jsx)(W(),{statusCode:V.W.NOT_FOUND})};CaptureEditorPage.getLayout=var Z=CaptureEditorPage},22112:function(e,t,n){"use strict";n.d(t,{nF:function(){return ProjectMetadataContextProvider},D:function(){return useProjectMetadata}});var r=n(2784),i=n(47330);let o=(0,r.createContext)({id:"",showNavatticBranding:!1,workspaceSlug:"",initialFlowId:"",scaleStrategy:i.V1.Responsive,mobileStrategy:i.Sy.Optimized,hasChecklist:!1,offline:!1,projectShareLink:void 0,flows:[],checklist:void 0});var a=n(52322);let ProjectMetadataContextProvider=useProjectMetadata=()=>(0,r.useContext)(o)},28625:function(e,t,n){"use strict";n.d(t,{N0:function(){return StepMetadataContextProvider},pp:function(){return useStepMetadata}});var r=n(2784),i=n(47330);let o=(0,r.createContext)({anchorProgress:!0,appearance:i.XB.Invisible,backdropStyle:i.GT.Medium,modalPosition:i.z.Center,customDialogHeight:null,customModalLeftPercentage:null,customModalTopPercentage:null,tooltipSize:i.CX.Medium,hasBackBtn:!1,hasNextBtn:!1,hideNavigationBtns:!1,showBackdrop:!1,showPoweredBy:!1,captureType:i.TG.Web,lockHorizontalScroll:!1,lockVerticalScroll:!1,resetScrollToTop:!1,disableEscapeView:!1});var a=n(52322),u=n(22112),s=n(55763);let StepMetadataContextProvider=useStepMetadata=,49548:function(e,t,n){"use strict";n.d(t,{ZP:function(){return GuideViewerStateContextProvider},dN:function(){return o}});var r=n(52322),i=n(2784);let o=(0,i.createContext)({guideId:"",projectId:"",stepIndex:0});,55763:95841:function(e,t,n){"use strict";var r=n(88702);let i=new r.L;t.Z=i},88702:function(e,t,n){"use strict";var r;n.d(t,{L:);let i=null===(r=globalThis.document)||void 0===r?void 0:r.implementation;let StyleSheetManager=},function(e){e.O(0,[3211,8426,3265,1617,4637,5837,696,8834,9391,9623,1732,8842,5634,309,4054,7330,9219,5306,6870,7156,6456,7185,3712,555,7644,4082,9774,2888,179],,_N_E=e.O()}]);
//# sourceMappingURL=edit-f22928a68895dc24.js.map