!this,function(Xn){"use strict";try{(function(){Xn=Xn&&Xn.hasOwnProperty("default")?Xn.default:Xn;var r=r n={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},C=p=a=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);e[n++]=i<128?i:(e[n++]=i<2048?i>>6|192:(55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,i>>6&63|128),63&i|128)}return e},h={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFEHAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:encodeString:decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(191<i&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:init_:,u=function i(t){return function t(e,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:var r=n;return new Date(r.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return n}for(var i in n)n.hasOwnProperty(i)&&(e[i]=t(e[i],n[i]));return e}(void 0,t)}var l=);r d=Error),f=);var _=/\{\$([^}]+)}/g;function y(t){return JSON.parse(t)}ar g=E=m=w=b=function(t){return n={},w(t,,n;var n},S=T=I=N=R=P=function(){eturn t.prototype.reset=t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],h=this.chain_[1],u=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(r=0;r<80;r++){s=r<40?r<20?(o=l^h&(u^l),1518500249):(o=h^u^l,1859775393):r<60?(o=h&u|l&(h|u),2400959708):(o=h^u^l,3395469782);i=(a<<5|a>>>27)+o+c+s+n[r]&4294967295;c=l,l=u,u=4294967295&(h<<30|h>>>2),h=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+h&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},t.prototype.update=t.prototype.digest=t}(),D=function(t,e,n,r){var i;if(r<e?i="at least "+e:n<r&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}; F,t,A=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:55296<=r&&r<=56319?(e+=4,n++):e+=3}return e};(t=F||(F={}))[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT";var L,M=F.INFO,W=q=),Q=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=t.prototype.get=t.prototype.remove=t.prototype.prefixedName_=t.prototype.toString=function(){return this.domStorage_.toString()},t}(),U=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=t.prototype.get=t.prototype.remove=function(t){delete this.cache_[t]},t}(),V=H=V("localStorage"),B=V("sessionStorage"),j=new q("@firebase/database"),K=(L=1,,Y=function(t){var e=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(55296<=i&&i<=56319){var o=i-55296;C(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}e[n++]=i<128?i:(e[n++]=i<2048?i>>6|192:(e[n++]=i<65536?i>>12|224:(e[n++]=i>>18|240,i>>12&63|128),i>>6&63|128),63&i|128)}return e}(t),n=new P;n.update(e);var r=n.digest();return h.encodeByteArray(r)},z=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"==typeof t[r]&&"number"==typeof t[r].length?n+=z.apply(null,t[r]):"object"==typeof t[r]?n+=v(t[r]):n+=t[r],n+=" ";return n},G=null,X=!0,$=function(t,e){C(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(j.logLevel=F.VERBOSE,G=j.log.bind(j),e&&B.set("logging_enabled",!0)):"function"==typeof t?G=t:(G=null,B.remove("logging_enabled"))},J=Z=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];J.apply(void 0,[n].concat(t))}},tt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+z.apply(void 0,t);j.error(n)},et=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+z.apply(void 0,t);throw j.error(n),new Error(n)},nt=rt=it="[MIN_NAME]",ot="[MAX_NAME]",st=at=ht=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+v(e))},ut=function(t){if("object"!=typeof t||null===t)return v(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=v(e[i]),r+=":",r+=ut(t[e[i]]);return r+="}"},lt=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)n<i+e?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r},ct=function(t,n){if(Array.isArray(t))for(var e=0;e<t.length;++e)n(e,t[e]);else w(t,function(t,e){return n(e,t)})},pt=function(t){C(!rt(t),"Invalid JSON number");var e,n,r,i,o,s,a;for(0===t?e=1/t==-1/(r=n=0)?1:0:(e=t<0,r=(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(t/Math.pow(2,-1074)))),s=[],o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse(),a=s.join("");var h="";for(o=0;o<64;o+=8){var u=parseInt(a.substr(o,8),2).toString(16);1===u.length&&(u="0"+u),h+=u}return h.toLowerCase()},dt=new RegExp("^-?\\d{1,10}$"),ft=function(t){if(dt.test(t)){var e=Number(t);if(-2147483648<=e&&e<=2147483647)return e}return null},_t=yt=vt=function(){eturn Object.defineProperty(i,"Empty",{get:enumerable:!0,configurable:!0}),i.prototype.getFront=i.prototype.getLength=i.prototype.popFront=i.prototype.getBack=i.prototype.toString=i.prototype.toUrlEncodedString=i.prototype.slice=i.prototype.parent=i.prototype.child=function(t){for(var e=[],n=this.pieceNum_;n<this.pieces_.length;n++)e.push(this.pieces_[n]);if(t instanceof i)for(n=t.pieceNum_;n<t.pieces_.length;n++)e.push(t.pieces_[n]);else{var r=t.split("/");for(n=0;n<r.length;n++)0<r[n].length&&e.push(r[n])}return new i(e,0)},i.prototype.isEmpty=i.relativePath=i.comparePaths=i.prototype.equals=i.prototype.contains=i}(),gt=function(){eturn Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=A(t),0<this.parts_.length&&(this.byteLength_-=1)},t.prototype.checkValid_=t.prototype.toErrorString=t}(),mt="firebaseio.com",Ct="websocket",Et="long_polling",wt=function(){function t(t,e,n,r,i){void 0===i&&(i=""),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=H.get("host:"+t)||this.host}return t.prototype.needsQueryParam=t.prototype.isCacheableHost=t.prototype.isDemoHost=t.prototype.isCustomHost=t.prototype.updateHost=t.prototype.connectionURL=t.prototype.toString=t.prototype.toURLString=t}();var bt,St,Tt,It,Nt,Rt=function(t){var e=Pt(t),n=e.subdomain;"firebase"===e.domain&&et(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===e.domain||et("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&nt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new wt(e.host,e.secure,n,r),path:new vt(e.pathString)}},Pt=function(t){var e="",n="",r="",i="",o=!0,s="https",a=443;if("string"==typeof t){var h=t.indexOf("//");0<=h&&(s=t.substring(0,h-1),t=t.substring(h+2));var u=t.indexOf("/");-1===u&&(u=t.length);var l=t.indexOf("?");-1===l&&(l=t.length),e=t.substring(0,Math.min(u,l)),u<l&&(i=t.substring(u,l)));var c=function(t){var e={};"?"===t.charAt(0)&&(t=t.substring(1));for(var n=0,r=t.split("&");n<r.length;n++){var i=r[n];if(0!==i.length){var o=i.split("=");2===o.length?e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):nt("Invalid query segment '"+i+"' in query '"+t+"'")}}return e}(t.substring(Math.min(t.length,l)));0<=(h=e.indexOf(":"))?(o="https"===s||"wss"===s,a=parseInt(e.substring(h+1),10)):h=t.length;var p=e.split(".");3===p.length?(n=p[1],r=p[0].toLowerCase()):2===p.length?n=p[0]:"localhost"===p[0].slice(0,h).toLowerCase()&&(n="localhost"),""===r&&"ns"in c&&(r=c.ns)}return{host:e,port:a,domain:n,subdomain:r,secure:o,scheme:s,pathString:i}},Dt=/[\[\].#$\/\u0000-\u001F\u007F]/,Ot=/[\[\].#$\u0000-\u001F\u007F]/,kt=10485760,xt=function(t){return"string"==typeof t&&0!==t.length&&!Dt.test(t)},Ft=At=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!rt(t)||t&&"object"==typeof t&&E(t,".sv")},Lt=function(t,e,n,r,i){i&&void 0===n||Mt(O(t,e,i),n,r)},Mt=Wt=function(t,e,n,r,i){if(!i||void 0!==n){var o=O(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var s=[];w(n,,o,s)}},qt=function(t,e,n,r){if(!r||void 0!==n){if(rt(n))throw new Error(O(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!At(n))throw new Error(O(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Qt=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(O(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Ut=function(t,e,n,r){if(!(r&&void 0===n||xt(n)))throw new Error(O(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Vt=function(t,e,n,r){if(!(r&&void 0===n||Ft(n)))throw new Error(O(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ht=Bt=function(t,e,n){var r,i=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!xt(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==i.length&&((r=i)&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),!Ft(r)))throw new Error(O(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},jt=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=t.prototype.remove=t.prototype.set=t.prototype.setWithPriority=t.prototype.update=t}(),Kt=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=t}(),Yt=(bt="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",St=0,Tt=[],function(t){var e,n=t===St;St=t;var r=new Array(8);for(e=7;0<=e;e--)r[e]=bt.charAt(t%64),t=Math.floor(t/64);C(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;0<=e&&63===Tt[e];e--)Tt[e]=0;Tt[e]++}else for(e=0;e<12;e++)Tt[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=bt.charAt(Tt[e]);return C(20===i.length,"nextPushId: Length should be 20."),i}),zt=),Gt=),Xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return It},set:function(t){It=t},enumerable:!0,configurable:!0}),e.prototype.compare=e.prototype.isDefinedOn=e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return zt.MIN},e.prototype.maxPost=e.prototype.makePost=e.prototype.toString=function(){return".key"},e}(Gt),$t=new Xt;var Jt,Zt,te,ee=ne=function(t){if(t.isLeafNode()){var e=t.val();C("string"==typeof e||"number"==typeof e||"object"==typeof e&&E(e,".sv"),"Priority must be a string or number.")}else C(t===Nt||t.isEmpty(),"priority of unexpected type.");C(t===Nt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},re=function(){eturn Object.defineProperty(o,"__childrenNodeConstructor",{get:set:function(t){Jt=t},enumerable:!0,configurable:!0}),o.prototype.isLeafNode=function(){return!0},o.prototype.getPriority=function(){return this.priorityNode_},o.prototype.updatePriority=o.prototype.getImmediateChild=o.prototype.getChild=o.prototype.hasChild=function(){return!1},o.prototype.getPredecessorChildName=o.prototype.updateImmediateChild=o.prototype.updateChild=o.prototype.isEmpty=function(){return!1},o.prototype.numChildren=function(){return 0},o.prototype.forEachChild=o.prototype.val=o.prototype.hash=o.prototype.getValue=function(){return this.value_},o.prototype.compareTo=o.prototype.compareToLeafNode_=function(t){var e=typeof t.value_,n=typeof this.value_,r=o.VALUE_TYPE_ORDER.indexOf(e),i=o.VALUE_TYPE_ORDER.indexOf(n);return C(0<=r,"Unknown leaf type: "+e),C(0<=i,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:i-r},o.prototype.withIndex=function(){return this},o.prototype.isIndexed=function(){return!0},o.prototype.equals=o.VALUE_TYPE_ORDER=["object","boolean","number","string"],o}();var ie,oe,se=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=e.prototype.isDefinedOn=e.prototype.indexedValueChanged=e.prototype.minPost=function(){return zt.MIN},e.prototype.maxPost=e.prototype.makePost=e.prototype.toString=function(){return".priority"},e}(Gt)),ae=function(){eturn t.prototype.getNext=t.prototype.hasNext=t.prototype.peek=t}(),he=function(){eturn o.prototype.copy=o.prototype.count=o.prototype.isEmpty=function(){return!1},o.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},o.prototype.reverseTraversal=o.prototype.min_=o.prototype.minKey=o.prototype.maxKey=o.prototype.insert=function(t,e,n){var r,i;return(i=(r=n(t,(i=this).key))<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp_()},o.prototype.removeMin_=o.prototype.remove=o.prototype.isRed_=function(){return this.color},o.prototype.fixUp_=o.prototype.moveRedLeft_=o.prototype.moveRedRight_=o.prototype.rotateLeft_=o.prototype.rotateRight_=o.prototype.colorFlip_=o.prototype.checkMaxDepth_=o.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},o.RED=!0,o.BLACK=!1,o}(),ue=),le=function(){eturn n.prototype.insert=n.prototype.remove=n.prototype.get=n.prototype.getPredecessorKey=n.prototype.isEmpty=function(){return this.root_.isEmpty()},n.prototype.count=function(){return this.root_.count()},n.prototype.minKey=function(){return this.root_.minKey()},n.prototype.maxKey=function(){return this.root_.maxKey()},n.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},n.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},n.prototype.getIterator=function(t){return new ae(this.root_,null,this.comparator_,!1,t)},n.prototype.getIteratorFrom=function(t,e){return new ae(this.root_,t,this.comparator_,!1,e)},n.prototype.getReverseIteratorFrom=n.prototype.getReverseIterator=n.EMPTY_NODE=new ue,n}(),ce=Math.log(2),pe=),de=function(u,t,l,e){u.sort(t);var c=n=function(t){for(var e=null,n=null,a=u.length,r=h=i=0;i<t.count;++i){var o=t.nextBitIsOne(),s=Math.pow(2,t.count-(i+1));o?r(s,he.BLACK):(r(s,he.BLACK),r(s,he.RED))}return n}(new pe(u.length));return new le(e||t,n)},fe={},_e=function(){function c(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(c,"Default",{get:enumerable:!0,configurable:!0}),c.prototype.get=function(t){var e=m(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e===fe?null:e},c.prototype.hasIndex=c.prototype.addIndex=function(t,e){C(t!==$t,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,r=[],i=!1,o=e.getIterator(zt.Wrap),s=o.getNext();s;)i=i||t.isDefinedOn(s.node),r.push(s),s=o.getNext();n=i?de(r,t.getCompare()):fe;var a=t.toString(),h=b(this.indexSet_);h[a]=t;var u=b(this.indexes_);return u[a]=n,new c(u,h)},c.prototype.addToIndexes=function(h,u){var l=this;return new c(I(this.indexes_,function(t,e){var n=m(l.indexSet_,e);if(C(n,"Missing index implementation for "+e),t===fe){if(n.isDefinedOn(h.node)){for(var r=[],i=u.getIterator(zt.Wrap),o=i.getNext();o;)o.name!=h.name&&r.push(o),o=i.getNext();return r.push(h),de(r,n.getCompare())}return fe}var s=u.get(h.name),a=t;return s&&(a=a.remove(new zt(h.name,s))),a.insert(h,h.node)}),this.indexSet_)},c.prototype.removeFromIndexes=c}();r ge=function(){eturn Object.defineProperty(a,"EMPTY_NODE",{get:enumerable:!0,configurable:!0}),a.prototype.isLeafNode=function(){return!1},a.prototype.getPriority=a.prototype.updatePriority=a.prototype.getImmediateChild=a.prototype.getChild=a.prototype.hasChild=a.prototype.updateImmediateChild=function(t,e){if(C(e,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(e);var n=new zt(t,e),r=void 0,i=void 0;return i=e.isEmpty()?(r=this.children_.remove(t),this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(t,e),this.indexMap_.addToIndexes(n,this.children_)),new a(r,r.isEmpty()?oe:this.priorityNode_,i)},a.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;C(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},a.prototype.isEmpty=function(){return this.children_.isEmpty()},a.prototype.numChildren=function(){return this.children_.count()},a.prototype.val=a.prototype.hash=a.prototype.getPredecessorChildName=a.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},a.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new zt(e,this.children_.get(e)):null},a.prototype.getLastChildName=a.prototype.getLastChild=a.prototype.forEachChild=a.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},a.prototype.getIteratorFrom=a.prototype.getReverseIterator=a.prototype.getReverseIteratorFrom=a.prototype.compareTo=a.prototype.withIndex=a.prototype.isIndexed=a.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()!==e.children_.count())return!1;for(var n=this.getIterator(se),r=e.getIterator(se),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1},a.prototype.resolveIndex_=a.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,a}(),me=new(function(t){eturn s(e,t),e.prototype.compareTo=e.prototype.equals=e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return ge.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(ge));Object.defineProperties(zt,{MIN:{value:new zt(it,ge.EMPTY_NODE)},MAX:{value:new zt(ot,me)}}),Xt.__EMPTY_NODE=ge.EMPTY_NODE,re.__childrenNodeConstructor=ge,Nt=me,te=me;var Ce=!0;function Ee(t,e){if(void 0===e&&(e=null),null===t)return ge.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),C(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new re(t,Ee(e));if(t instanceof Array||!Ce){var r=ge.EMPTY_NODE,i=t;return w(i,,r.updatePriority(Ee(e))}var o=[],s=!1,a=t;if(w(a,function(t,e){if("string"!=typeof t||"."!==t.substring(0,1)){var n=Ee(a[t]);n.isEmpty()||(s=s||!n.getPriority().isEmpty(),o.push(new zt(t,n)))}}),0==o.length)return ge.EMPTY_NODE;var n=de(o,ye,function(t){return t.name},ve);if(s){var h=de(o,se.getCompare());return new ge(n,Ee(e),new _e({".priority":h},{".priority":se}))}return new ge(n,Ee(e),_e.Default)}Zt=Ee;var we,be,Se,Te=new(function(t){eturn s(e,t),e.prototype.compare=e.prototype.isDefinedOn=e.prototype.indexedValueChanged=e.prototype.minPost=function(){return zt.MIN},e.prototype.maxPost=e.prototype.makePost=e.prototype.toString=function(){return".value"},e}(Gt)),Ie=function(n){eturn s(t,n),t.prototype.extractChild=t.prototype.isDefinedOn=t.prototype.compare=t.prototype.makePost=t.prototype.maxPost=t.prototype.toString=t}(Gt),Ne=function(){function i(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return i.prototype.val=function(){return D("DataSnapshot.val",0,0,arguments.length),this.node_.val()},i.prototype.exportVal=i.prototype.toJSON=function(){return D("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},i.prototype.exists=i.prototype.child=i.prototype.hasChild=i.prototype.getPriority=i.prototype.forEach=i.prototype.hasChildren=Object.defineProperty(i.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),i.prototype.numChildren=i.prototype.getRef=Object.defineProperty(i.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),i}(),Re=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=t}(),Pe=),De=function(){function e(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return e.prototype.respondsTo=e.prototype.createEvent=e.prototype.getEventRunner=e.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Pe(this,t,e):null},e.prototype.matches=e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),Oe=function(){function i(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return i.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,E(this.callbacks_,e)},i.prototype.createCancelEvent=i.prototype.createEvent=i.prototype.getEventRunner=i.prototype.matches=function(n){if(n instanceof i){if(!this.callbacks_||!n.callbacks_)return!0;if(this.context_===n.context_){var t=T(n.callbacks_);if(t===T(this.callbacks_)){if(1!==t)return this.callbacks_,;var e=R(n.callbacks_),r=R(this.callbacks_);return!(r!==e||n.callbacks_[e]&&this.callbacks_[r]&&n.callbacks_[e]!==this.callbacks_[r])}}}return!1},i.prototype.hasAnyCallback=i}(),ke=function(){eturn Object.defineProperty(u,"__referenceConstructor",{get:function(){return C(we,"Reference.ts has not been loaded"),we},set:enumerable:!0,configurable:!0}),u.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===$t){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=it)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!=ot)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===se){if(null!=e&&!At(e)||null!=n&&!At(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(C(t.getIndex()instanceof Ie||t.getIndex()===Te,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},u.validateLimit_=u.prototype.validateNoPreviousOrderByCall_=u.prototype.getQueryParams=function(){return this.queryParams_},u.prototype.getRef=u.prototype.on=function(t,e,n,r){D("Query.on",2,4,arguments.length),Qt("Query.on",1,t,!1),k("Query.on",2,e,!1);var i=u.getCancelAndContextArgs_("Query.on",n,r);if("value"===t)this.onValueEvent(e,i.cancel,i.context);else{var o={};o[t]=e,this.onChildEvent(o,i.cancel,i.context)}return e},u.prototype.onValueEvent=u.prototype.onChildEvent=u.prototype.off=function(t,e,n){D("Query.off",0,3,arguments.length),Qt("Query.off",1,t,!0),k("Query.off",2,e,!0),x("Query.off",3,n,!0);var r=null,i=null;"value"===t?r=new De(e||null,null,n||null):t&&(e&&((i={})[t]=e),r=new Oe(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},u.prototype.once=u.prototype.limitToFirst=function(t){if(D("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new u(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},u.prototype.limitToLast=u.prototype.orderByChild=function(t){if(D("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Vt("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var e=new vt(t);if(e.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new Ie(e),r=this.queryParams_.orderBy(n);return u.validateQueryEndpoints_(r),new u(this.repo,this.path,r,!0)},u.prototype.orderByKey=function(){D("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy($t);return u.validateQueryEndpoints_(t),new u(this.repo,this.path,t,!0)},u.prototype.orderByPriority=function(){D("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(se);return u.validateQueryEndpoints_(t),new u(this.repo,this.path,t,!0)},u.prototype.orderByValue=u.prototype.startAt=u.prototype.endAt=function(t,e){void 0===t&&(t=null),D("Query.endAt",0,2,arguments.length),Lt("Query.endAt",1,t,this.path,!0),Ut("Query.endAt",2,e,!0);var n=this.queryParams_.endAt(t,e);if(u.validateLimit_(n),u.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new u(this.repo,this.path,n,this.orderByCalled_)},u.prototype.equalTo=u.prototype.toString=u.prototype.toJSON=u.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},u.prototype.queryIdentifier=u.prototype.isEqual=function(t){if(D("Query.isEqual",1,1,arguments.length),!(t instanceof u)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var e=this.repo===t.repo,n=this.path.equals(t.path),r=this.queryIdentifier()===t.queryIdentifier();return e&&n&&r},u.getCancelAndContextArgs_=Object.defineProperty(u.prototype,"ref",{get:enumerable:!0,configurable:!0}),u}(),xe=function(){function t(){this.set={}}return t.prototype.add=t.prototype.contains=t.prototype.get=t.prototype.remove=t.prototype.clear=t.prototype.isEmpty=function(){return S(this.set)},t.prototype.count=function(){return T(this.set)},t.prototype.each=function(n){w(this.set,},t.prototype.keys=function(){var e=[];return w(this.set,function(t){e.push(t)}),e},t}(),Fe=function(){eturn i.prototype.find=i.prototype.remember=function(t,e){if(t.isEmpty())this.value_=e,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(t,e);else{null==this.children_&&(this.children_=new xe);var n=t.getFront();this.children_.contains(n)||this.children_.add(n,new i);var r=this.children_.get(n);t=t.popFront(),r.remember(t,e)}},i.prototype.forget=function(t){if(t.isEmpty())return this.value_=null,!(this.children_=null);if(null!==this.value_){if(this.value_.isLeafNode())return!1;var e=this.value_;this.value_=null;var n=this;return e.forEachChild(se,,this.forget(t)}if(null===this.children_)return!0;var r=t.getFront();return t=t.popFront(),this.children_.contains(r)&&this.children_.get(r).forget(t)&&this.children_.remove(r),!!this.children_.isEmpty()&&!(this.children_=null)},i.prototype.forEachTree=i.prototype.forEachChild=i}(),Ae=function(t,e){return t&&"object"==typeof t?(C(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},Le=function(t,r){var i,e=t.getPriority().val(),n=Ae(e,r);if(t.isLeafNode()){var o=t,s=Ae(o.getValue(),r);return s!==o.getValue()||n!==o.getPriority().val()?new re(s,Ee(n)):t}var a=t;return n!==(i=a).getPriority().val()&&(i=i.updatePriority(new re(n))),a.forEachChild(se,,i};(Se=be||(be={}))[Se.OVERWRITE=0]="OVERWRITE",Se[Se.MERGE=1]="MERGE",Se[Se.ACK_USER_WRITE=2]="ACK_USER_WRITE",Se[Se.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var Me,We,qe=function(){eturn e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=e}(),Qe=function(){eturn n.prototype.operationForChild=n}(),Ue=function(){eturn o.fromObject=o.prototype.isEmpty=o.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:vt.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null===r)return null;var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null==i?null:{path:new vt(n).child(i.path),value:i.value}},o.prototype.findRootMostValueAndPath=o.prototype.subtree=o.prototype.set=o.prototype.remove=o.prototype.get=o.prototype.setTree=o.prototype.fold=o.prototype.fold_=o.prototype.findOnPath=function(t,e){return this.findOnPath_(t,vt.Empty,e)},o.prototype.findOnPath_=o.prototype.foreachOnPath=o.prototype.foreachOnPath_=o.prototype.foreach=o.prototype.foreach_=o.prototype.foreachChild=o.Empty=new o(null),o}(),Ve=),He=),Be=function(){eturn n.prototype.operationForChild=n.prototype.toString=n}(),je=),Ke=),Ye=),ze=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){C(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()==n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(Ye.childRemovedChange(e,s)):C(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(Ye.childAddedChange(e,n)):o.trackChildChange(Ye.childChangedChange(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=t.prototype.updatePriority=t.prototype.filtersNodes=t.prototype.getIndexedFilter=t.prototype.getIndex=function(){return this.index_},t}(),Ge=function(){function t(){this.changeMap_={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;C(e==Ye.CHILD_ADDED||e==Ye.CHILD_CHANGED||e==Ye.CHILD_REMOVED,"Only child changes supported for tracking"),C(".priority"!==n,"Only non-priority child changes can be tracked.");var r=m(this.changeMap_,n);if(r){var i=r.type;if(e==Ye.CHILD_ADDED&&i==Ye.CHILD_REMOVED)this.changeMap_[n]=Ye.childChangedChange(n,t.snapshotNode,r.snapshotNode);else if(e==Ye.CHILD_REMOVED&&i==Ye.CHILD_ADDED)delete this.changeMap_[n];else if(e==Ye.CHILD_REMOVED&&i==Ye.CHILD_CHANGED)this.changeMap_[n]=Ye.childRemovedChange(n,r.oldSnap);else if(e==Ye.CHILD_CHANGED&&i==Ye.CHILD_ADDED)this.changeMap_[n]=Ye.childAddedChange(n,t.snapshotNode);else{if(e!=Ye.CHILD_CHANGED||i!=Ye.CHILD_CHANGED)throw p("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap_[n]=Ye.childChangedChange(n,t.snapshotNode,r.oldSnap)}}else this.changeMap_[n]=t},t.prototype.getChanges=function(){return this.changeMap_)},t}(),Xe=new()),$e=),Je=Ze=function(){function c(t){this.filter_=t}return c.prototype.assertIndexed=c.prototype.applyOperation=function(t,e,n,r){var i,o,s=new Ge;if(e.type===be.OVERWRITE){var a=e;i=a.source.fromUser?this.applyUserOverwrite_(t,a.path,a.snap,n,r,s):(C(a.source.fromServer,"Unknown source."),o=a.source.tagged||t.getServerCache().isFiltered()&&!a.path.isEmpty(),this.applyServerOverwrite_(t,a.path,a.snap,n,r,o,s))}else if(e.type===be.MERGE){var h=e;i=h.source.fromUser?this.applyUserMerge_(t,h.path,h.children,n,r,s):(C(h.source.fromServer,"Unknown source."),o=h.source.tagged||t.getServerCache().isFiltered(),this.applyServerMerge_(t,h.path,h.children,n,r,o,s))}else if(e.type===be.ACK_USER_WRITE){var u=e;i=u.revert?this.revertUserWrite_(t,u.path,n,r,s):this.ackUserWrite_(t,u.path,u.affectedTree,n,r,s)}else{if(e.type!==be.LISTEN_COMPLETE)throw p("Unknown operation type: "+e.type);i=this.listenComplete_(t,e.path,n,s)}var l=s.getChanges();return c.maybeAddValueEvent_(t,i,l),new Je(i,l)},c.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(0<n.length||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Ye.valueChange(e.getCompleteEventSnap()))}},c.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var s=void 0,a=void 0;if(e.isEmpty())if(C(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var h=t.getCompleteServerSnap(),u=h instanceof ge?h:ge.EMPTY_NODE,l=n.calcCompleteEventChildren(u);s=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var c=n.calcCompleteEventCache(t.getCompleteServerSnap());s=this.filter_.updateFullNode(t.getEventCache().getNode(),c,i)}else{var p=e.getFront();if(".priority"==p){C(1==e.getLength(),"Can't have a priority with additional path components");var d=o.getNode();a=t.getServerCache().getNode();var f=n.calcEventCacheAfterServerOverwrite(e,d,a);s=null!=f?this.filter_.updatePriority(d,f):o.getNode()}else{var _=e.popFront(),y=void 0;if(o.isCompleteForChild(p)){a=t.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),a);y=null!=v?o.getNode().getImmediateChild(p).updateChild(_,v):o.getNode().getImmediateChild(p)}else y=n.calcCompleteChild(p,t.getServerCache());s=null!=y?this.filter_.updateChild(o.getNode(),p,y,_,r,i):o.getNode()}}return t.updateEventSnap(s,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},c.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,s){var a,h=t.getServerCache(),u=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())a=u.updateFullNode(h.getNode(),n,null);else if(u.filtersNodes()&&!h.isFiltered()){var l=h.getNode().updateChild(e,n);a=u.updateFullNode(h.getNode(),l,null)}else{var c=e.getFront();if(!h.isCompleteForPath(e)&&1<e.getLength())return t;var p=e.popFront(),d=h.getNode().getImmediateChild(c).updateChild(p,n);a=".priority"==c?u.updatePriority(h.getNode(),d):u.updateChild(h.getNode(),c,d,p,Xe,null)}var f=t.updateServerSnap(a,h.isFullyInitialized()||e.isEmpty(),u.filtersNodes()),_=new $e(r,f,i);return this.generateEventCacheAfterServerEvent_(f,e,r,_,s)},c.prototype.applyUserOverwrite_=c.cacheHasChild_=c.prototype.applyUserMerge_=c.prototype.applyMerge_=c.prototype.applyServerMerge_=c.prototype.ackUserWrite_=c.prototype.listenComplete_=c.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var s=new $e(n,t,r),a=t.getEventCache().getNode(),h=void 0;if(e.isEmpty()||".priority"===e.getFront()){var u=void 0;if(t.getServerCache().isFullyInitialized())u=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var l=t.getServerCache().getNode();C(l instanceof ge,"serverChildren would be complete if leaf node"),u=n.calcCompleteEventChildren(l)}u=u,h=this.filter_.updateFullNode(a,u,i)}else{var c=e.getFront(),p=n.calcCompleteChild(c,t.getServerCache());null==p&&t.getServerCache().isCompleteForChild(c)&&(p=a.getImmediateChild(c)),(h=null!=p?this.filter_.updateChild(a,c,p,e.popFront(),s,i):t.getEventCache().getNode().hasChild(c)?this.filter_.updateChild(a,c,ge.EMPTY_NODE,e.popFront(),s,i):a).isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(h=this.filter_.updateFullNode(h,o,i))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(vt.Empty),t.updateEventSnap(h,o,this.filter_.filtersNodes())},c}(),tn=function(){eturn t.prototype.generateEventsForChanges=t.prototype.generateEventsForType_=t.prototype.materializeSingleChange_=t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw p("Should only compare child_ events.");var n=new zt(t.childName,t.snapshotNode),r=new zt(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),en=function(){eturn t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=t.prototype.getCompleteServerCache=t.prototype.isEmpty=t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,n){var r=[];if(n){C(null==t,"A cancel should cancel all event registrations.");var i=this.query_.path;this.eventRegistrations_.forEach(}if(t){for(var e=[],o=0;o<this.eventRegistrations_.length;++o){var s=this.eventRegistrations_[o];if(s.matches(t)){if(t.hasAnyCallback()){e=e.concat(this.eventRegistrations_.slice(o+1));break}}else e.push(s)}this.eventRegistrations_=e}else this.eventRegistrations_=[];return r},t.prototype.applyOperation=t.prototype.getInitialEvents=t.prototype.generateEventsForChanges_=t}(),nn=function(){function u(){this.views_={}}return Object.defineProperty(u,"__referenceConstructor",{get:set:enumerable:!0,configurable:!0}),u.prototype.isEmpty=function(){return S(this.views_)},u.prototype.applyOperation=function(n,r,i){var t=n.source.queryId;if(null!==t){var e=m(this.views_,t);return C(null!=e,"SyncTree gave us an op for an invalid query."),e.applyOperation(n,r,i)}var o=[];return w(this.views_,,o},u.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),s=m(this.views_,o);if(!s){var a=n.calcCompleteEventCache(i?r:null),h=!1;h=!!a||(a=r instanceof ge?n.calcCompleteEventChildren(r):ge.EMPTY_NODE,!1);var u=new Ke(new je(a,h,!1),new je(r,i,!1));s=new en(t,u),this.views_[o]=s}return s.addEventRegistration(e),s.getInitialEvents(e)},u.prototype.removeEventRegistration=function(t,n,r){var e=t.queryIdentifier(),i=[],o=[],s=this.hasCompleteView();if("default"===e){var a=this;w(this.views_,}else{var h=m(this.views_,e);h&&(o=o.concat(h.removeEventRegistration(n,r)),h.isEmpty()&&(delete this.views_[e],h.getQuery().getQueryParams().loadsAllData()||i.push(h.getQuery())))}return s&&!this.hasCompleteView()&&i.push(new u.__referenceConstructor(t.repo,t.path)),{removed:i,events:o}},u.prototype.getQueryViews=u.prototype.getCompleteServerCache=function(n){var r=null;return w(this.views_,,r},u.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return m(this.views_,e)},u.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},u.prototype.hasCompleteView=u.prototype.getCompleteView=function(){var t,e,n;return(t=this.views_,(n=N(t,e))&&t[n])||null},u}(),rn=function(){function a(t){this.writeTree_=t}return a.prototype.addWrite=a.prototype.addWrites=a.prototype.removeWrite=a.prototype.hasCompleteWrite=a.prototype.getCompleteNode=a.prototype.getCompleteChildren=a.prototype.childCompoundWrite=a.prototype.isEmpty=a.prototype.apply=function(t){return a.applySubtreeWrite_(vt.Empty,this.writeTree_,t)},a.Empty=new a(new Ue(null)),a.applySubtreeWrite_=function(n,t,r){if(null!=t.value)return r.updateChild(n,t.value);var i=null;return t.children.inorderTraversal(function(t,e){".priority"===t?(C(null!==e.value,"Priority writes must always be leaf nodes"),i=e.value):r=a.applySubtreeWrite_(n.child(t),e,r)}),r.getChild(n).isEmpty()||null===i||(r=r.updateChild(n.child(".priority"),i)),r},a}(),on=function(){eturn u.prototype.childWrites=u.prototype.addOverwrite=u.prototype.addMerge=u.prototype.getWrite=u.prototype.removeWrite=function(e){var n=this,t=this.allWrites_.findIndex(;C(0<=t,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[t];this.allWrites_.splice(t,1);for(var i=r.visible,o=!1,s=this.allWrites_.length-1;i&&0<=s;){var a=this.allWrites_[s];a.visible&&(t<=s&&this.recordContainsPath_(a,r.path)?i=!1:r.path.contains(a.path)&&(o=!0)),s--}if(i){if(o)return this.resetTree_(),!0;if(r.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(r.path);else{var h=r.children;w(h,}return!0}return!1},u.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},u.prototype.calcCompleteEventCache=u.prototype.calcCompleteEventChildren=u.prototype.calcEventCacheAfterServerOverwrite=u.prototype.calcCompleteChild=u.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},u.prototype.calcIndexedSlice=u.prototype.recordContainsPath_=function(n,r){return n.snap?n.path.contains(r):!!N(n.children,},u.prototype.resetTree_=u.DefaultFilter_=u.layerTree_=function(t,e,n){for(var r=rn.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var s=o.path,a=void 0;if(o.snap)n.contains(s)?(a=vt.relativePath(n,s),r=r.addWrite(a,o.snap)):s.contains(n)&&(a=vt.relativePath(s,n),r=r.addWrite(vt.Empty,o.snap.getChild(a)));else{if(!o.children)throw p("WriteRecord should have .snap or .children");if(n.contains(s))a=vt.relativePath(n,s),r=r.addWrites(a,o.children);else if(s.contains(n))if((a=vt.relativePath(s,n)).isEmpty())r=r.addWrites(vt.Empty,o.children);else{var h=m(o.children,a.getFront());if(h){var u=h.getChild(a.popFront());r=r.addWrite(vt.Empty,u)}}}}}return r},u}(),sn=),an=function(){function v(t){this.listenProvider_=t,this.syncPointTree_=Ue.Empty,this.pendingWriteTree_=new on,this.tagToQueryMap_={},this.queryToTagMap_={}}return v.prototype.applyUserOverwrite=v.prototype.applyUserMerge=v.prototype.ackUserWrite=v.prototype.applyServerOverwrite=v.prototype.applyServerMerge=v.prototype.applyListenComplete=v.prototype.applyTaggedQueryOverwrite=function(t,e,n){var r=this.queryKeyForTag_(n);if(null==r)return[];var i=v.parseQueryKey_(r),o=i.path,s=i.queryId,a=vt.relativePath(o,t),h=new He(qe.forServerTaggedQuery(s),a,e);return this.applyTaggedOperation_(o,h)},v.prototype.applyTaggedQueryMerge=v.prototype.applyTaggedListenComplete=v.prototype.addEventRegistration=function(t,e){var r=t.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,;var n,s=this.syncPointTree_.get(r);(s?(o=o||s.hasCompleteView(),i=i||s.getCompleteServerCache(vt.Empty)):(s=new nn,this.syncPointTree_=this.syncPointTree_.set(r,s)),null!=i)?n=!0:(n=!1,i=ge.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild();var a=s.viewExistsForQuery(t);if(!a&&!t.getQueryParams().loadsAllData()){var h=v.makeQueryKey_(t);C(!(h in this.queryToTagMap_),"View does not exist, but we have a tag");var u=v.getNextQueryTag_();this.queryToTagMap_[h]=u,this.tagToQueryMap_["_"+u]=h}var l=this.pendingWriteTree_.childWrites(r),c=s.addEventRegistration(t,e,l,i,n);if(!a&&!o){var p=s.viewForQuery(t);c=c.concat(this.setupListener_(t,p))}return c},v.prototype.removeEventRegistration=function(t,e,n){var r=this,i=t.path,o=this.syncPointTree_.get(i),s=[];if(o&&("default"===t.queryIdentifier()||o.viewExistsForQuery(t))){var a=o.removeEventRegistration(t,e,n);o.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(i));var h=a.removed;s=a.events;var u=-1!==h.findIndex(,l=this.syncPointTree_.findOnPath(i,;if(u&&!l){var c=this.syncPointTree_.subtree(i);if(!c.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(c),d=0;d<p.length;++d){var f=p[d],_=f.getQuery(),y=this.createListenerForView_(f);this.listenProvider_.startListening(v.queryForListening_(_),this.tagForQuery_(_),y.hashFn,y.onComplete)}}if(!l&&0<h.length&&!n)if(u){this.listenProvider_.stopListening(v.queryForListening_(t),null)}else h.forEach(;this.removeTags_(h)}return s},v.prototype.calcCompleteEventCache=v.prototype.collectDistinctViewsForSubTree_=v.prototype.removeTags_=v.queryForListening_=v.prototype.setupListener_=v.prototype.createListenerForView_=function(t){var n=this,r=t.getQuery(),i=this.tagForQuery_(r);return{hashFn:onComplete:function(t){if("ok"===t)return i?n.applyTaggedListenComplete(r.path,i):n.applyListenComplete(r.path);var e=t,r);return n.removeEventRegistration(r,null,e)}}},v.makeQueryKey_=v.parseQueryKey_=v.prototype.queryKeyForTag_=v.prototype.tagForQuery_=function(t){var e=v.makeQueryKey_(t);return m(this.queryToTagMap_,e)},v.getNextQueryTag_=v.prototype.applyTaggedOperation_=v.prototype.applyOperationToSyncPoints_=v.prototype.applyOperationHelper_=v.prototype.applyOperationDescendantsHelper_=v.nextQueryTag_=1,v}(),hn=),un=function(){eturn t.prototype.getToken=t.prototype.addTokenChangeListener=function(t){this.app_.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=t.prototype.notifyForInvalidToken=t}(),ln=function(){eturn t.prototype.incrementCounter=t.prototype.get=t}(),cn=),pn=function(){eturn t.prototype.get=function(){var t=this.collection_.get(),n=b(t);return this.last_&&w(this.last_,,this.last_=t,n},t}(),dn=function(){eturn t.prototype.includeStat=t.prototype.reportStats_=t}(),fn=),_n=),yn=function(){eturn t.prototype.trigger=t.prototype.on=t.prototype.off=t.prototype.validateEventType_=t}(),vn=function(r){eturn s(t,r),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(t){return C("visible"===t,"Unknown event type: "+t),[this.visible_]},t}(yn),gn=function(e){eturn s(t,e),t.getInstance=t.prototype.getInitialEvent=t.prototype.currentlyOnline=t}(yn),mn=),Cn=function(){eturn t.prototype.open=function(t,e){var o=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new mn(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{var e=!1,n=document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",,window.attachEvent("onload",n))}}(function(){if(!o.isClosed_){o.scriptTagHolder=new En(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],r=t[1],i=t[2];if(o.incrementIncomingBytes_(t),o.scriptTagHolder)if(o.connectTimeoutTimer_&&(clearTimeout(o.connectTimeoutTimer_),o.connectTimeoutTimer_=null),o.everConnected_=!0,"start"==n)o.id=r,o.password=i;else{if("close"!==n)throw new Error("Unrecognized command received: "+n);r?(o.scriptTagHolder.sendNewPolls=!1,o.myPacketOrderer.closeAfter(r,function(){o.onClosed_()})):o.onClosed_()}},function(){o.onClosed_()},o.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),o.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=o.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",o.transportSessionId&&(t.s=o.transportSessionId),o.lastSessionId&&(t.ls=o.lastSessionId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(mt)&&(t.r="f");var e=o.urlFn(t);o.log_("Connecting via long-poll to "+e),o.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.UI)&&!c()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=v(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n,r=(n=a(e),h.encodeByteArray(n,!0)),i=lt(r,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=t.prototype.incrementIncomingBytes_=t}(),En=function(){function s(t,e,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new xe,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=K(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=s.createIFrame_();var i="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(i='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(t){J("frame writing exception"),t.stack&&J(t.stack),J(t)}}return s.createIFrame_=s.prototype.close=s.prototype.startLongPoll=s.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(0<this.pendingSegs.length?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;0<this.pendingSegs.length;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},s.prototype.enqueueSegment=s.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e,1);var r=i=setTimeout(r,Math.floor(25e3));this.addTag(t,},s.prototype.addTag=s}(),wn=null;"undefined"!=typeof MozWebSocket?wn=MozWebSocket:"undefined"!=typeof WebSocket&&(wn=WebSocket);var bn=function(){eturn i.connectionURL_=function(t,e,n){var r={v:"5"};return"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(mt)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL(Ct,r)},i.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,H.set("previous_websocket_failure",!0);try{this.mySock=new wn(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var r=t.message||t.data;return r&&this.log_(r),void this.onClosed_()}this.mySock.onopen=this.mySock.onclose=this.mySock.onmessage=this.mySock.onerror=,i.prototype.start=function(){},i.forceDisallow=i.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);e&&1<e.length&&parseFloat(e[1])<4.4&&(t=!0)}return!t&&null!==wn&&!i.forceDisallow_},i.previouslyFailed=i.prototype.markConnectionHealthy=i.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=y(e);this.onMessage(n)}},i.prototype.handleNewFrameCount_=i.prototype.extractFrameCount_=i.prototype.handleIncomingFrame=i.prototype.send=i.prototype.shutdown_=i.prototype.onClosed_=i.prototype.close=i.prototype.resetKeepAlive=i.prototype.sendString_=i.responsesRequiredToBeHealthy=2,i.healthyTimeout=3e4,i}(),Sn=function(){eturn Object.defineProperty(i,"ALL_TRANSPORTS",{get:enumerable:!0,configurable:!0}),i.prototype.initTransports_=function(t){var e=bn&&bn.isAvailable(),n=e&&!bn.previouslyFailed();if(t.webSocketOnly&&(e||nt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[bn];else{var r=this.transports_=[];ct(i.ALL_TRANSPORTS,}},i.prototype.initialTransport=i.prototype.upgradeTransport=i}(),Tn=function(){eturn t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(Math.floor(0));var i=e.healthyTimeout||0;0<i&&(this.healthyTimeout_=yt(Math.floor(i)))},t.prototype.nextTransportId_=t.prototype.disconnReceiver_=t.prototype.connReceiver_=t.prototype.sendRequest=t.prototype.tryCleanupConnection=t.prototype.onSecondaryControl_=t.prototype.onSecondaryMessageReceived_=t.prototype.upgradeIfSecondaryHealthy_=t.prototype.proceedWithUpgrade_=t.prototype.onPrimaryMessageReceived_=t.prototype.onDataMessage_=t.prototype.onPrimaryResponse_=t.prototype.onControl_=t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&nt("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=t.prototype.startUpgrade_=t.prototype.onReset_=t.prototype.onConnectionEstablished_=t.prototype.sendPingOnPrimaryIfNecessary_=t.prototype.onSecondaryConnectionLost_=t.prototype.onConnectionLost_=t.prototype.onConnectionShutdown_=t.prototype.sendData_=t.prototype.close=t.prototype.closeConnections_=t}(),In=),Nn=function(a){function l(t,e,n,r,i,o){var s=a.call(this)||this;if(s.repoInfo_=t,s.onDataUpdate_=e,s.onConnectStatus_=n,s.onServerInfoUpdate_=r,s.authTokenProvider_=i,s.authOverride_=o,s.id=l.nextPersistentConnectionId_++,s.log_=Z("p:"+s.id+":"),s.interruptReasons_={},s.listens_={},s.outstandingPuts_=[],s.outstandingPutCount_=0,s.onDisconnectRequestQueue_=[],s.connected_=!1,s.reconnectDelay_=1e3,s.maxReconnectDelay_=3e5,s.securityDebugCallback_=null,s.lastSessionId=null,s.establishConnectionTimer_=null,s.visible_=!1,s.requestCBHash_={},s.requestNumber_=0,s.realtime_=null,s.authToken_=null,s.forceTokenRefresh_=!1,s.invalidAuthTokenCount_=0,s.firstConnection_=!0,s.lastConnectionAttemptTime_=null,s.lastConnectionEstablishedTime_=null,o&&!c())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return s.scheduleConnect_(0),vn.getInstance().on("visible",s.onVisible_,s),-1===t.host.indexOf("fblocal")&&gn.getInstance().on("online",s.onOnline_,s),s}return s(l,a),l.prototype.sendRequest=l.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens_[o]=this.listens_[o]||{},C(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),C(!this.listens_[o][i],"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens_[o][i]=s,this.connected_&&this.sendListen_(s)},l.prototype.sendListen_=function(r){var i=this,o=r.query,s=o.path.toString(),a=o.queryIdentifier();this.log_("Listen on "+s+" for "+a);var t={p:s};r.tag&&(t.q=o.queryObject(),t.t=r.tag),t.h=r.hashFn(),this.sendRequest("q",t,},l.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&E(t,"w")){var n=m(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();nt("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},l.prototype.refreshAuthToken=l.prototype.reduceReconnectDelayIfAdminCredential_=function(t){var e;(t&&40===t.length||"object"==typeof(e=g(t).claims)&&!0===e.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},l.prototype.tryAuth=function(){var t,r=this;if(this.connected_&&this.authToken_){var i=this.authToken_,e=(t=g(i).claims)&&"object"==typeof t&&t.hasOwnProperty("iat")?"auth":"gauth",n={cred:i};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(e,n,}},l.prototype.unlisten=l.prototype.sendUnlisten_=l.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},l.prototype.onDisconnectMerge=l.prototype.onDisconnectCancel=l.prototype.sendOnDisconnect_=l.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},l.prototype.merge=l.prototype.putInternal=l.prototype.sendPut_=l.prototype.reportStats=l.prototype.onDataMessage_=l.prototype.onDataPush_=l.prototype.onReady_=l.prototype.scheduleConnect_=l.prototype.onVisible_=l.prototype.onOnline_=l.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){3e4<(new Date).getTime()-this.lastConnectionEstablishedTime_&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},l.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+l.nextConnectionId_++,o=this,s=this.lastSessionId,a=!1,h=null,u=this.realtime_={close:u,sendRequest:;var t=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(t).then(.then(null,}},l.prototype.interrupt=l.prototype.resume=l.prototype.handleTimestamp_=l.prototype.cancelSentTransactions_=l.prototype.onListenRevoked_=l.prototype.removeListen_=function(t,e){var n,r=new vt(t).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][e],delete this.listens_[r][e],0===T(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},l.prototype.onAuthRevoked_=l.prototype.onSecurityDebugPacket_=l.prototype.restoreState_=function(){var n=this;this.tryAuth(),w(this.listens_,;for(var t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){var e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}},l.prototype.sendConnectStats_=function(){var t={};t["sdk.js."+Xn.SDK_VERSION.replace(/\./g,"-")]=1,o()?t["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(t["framework.reactnative"]=1),this.reportStats(t)},l.prototype.shouldReconnect_=l.nextPersistentConnectionId_=0,l.nextConnectionId_=0,l}(In),Rn=function(i){eturn s(u,i),u.prototype.reportStats=u.getListenId_=u.prototype.listen=function(t,e,r,i){var o=this,s=t.path.toString();this.log_("Listen called for "+s+" "+t.queryIdentifier());var a=u.getListenId_(t,r),h={};this.listens_[a]=h;var n=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(s+".json",n,function(t,e){var n=e;(404===t&&(t=n=null),null===t&&o.onDataUpdate_(s,n,!1,r),m(o.listens_,a)===h)&&i(t?401==t?"permission_denied":"rest_error:"+t:"ok",null)})},u.prototype.unlisten=u.prototype.refreshAuthToken=u.prototype.restRequest_=function(o,s,a){var h=this;void 0===s&&(s={}),s.format="export",this.authTokenProvider_.getToken(!1).then(function(t){var e=t&&t.accessToken;e&&(s.auth=e);var n,r=(h.repoInfo_.secure?"https://":"http://")+h.repoInfo_.host+o+"?ns="+h.repoInfo_.namespace+(n=[],w(s,,n.length?"&"+n.join("&"):"");h.log_("Sending REST request for "+r);var i=new XMLHttpRequest;i.onreadystatechange=i.open("GET",r,!0),i.send()})},u}(In),Pn="repo_interrupt",Dn=function(){function t(t,e,n){var s=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fn,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Fe,this.persistentConnection_=null;var r=new un(n);if(this.stats_=cn.getCollection(t),e||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))this.server_=new Rn(this.repoInfo_,this.onDataUpdate_.bind(this),r),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var i=n.options.databaseAuthVariableOverride;if(null!=i){if("object"!=typeof i)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{v(i)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new Nn(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),r,i),this.server_=this.persistentConnection_}r.addTokenChangeListener(,this.statsReporter_=cn.getOrCreateReporter(t,,this.transactions_init_(),this.infoData_=new hn,this.infoSyncTree_=new an({startListening:stopListening:),this.updateInfo_("connected",!1),this.serverSyncTree_=new an({startListening:stopListening:)}return t.prototype.toString=t.prototype.name=t.prototype.serverTime=t.prototype.generateServerValues=t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new vt(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var s=I(e,function(t){return Ee(t)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,s,r)}else{var a=Ee(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,a,r)}else if(n){var h=I(e,;o=this.serverSyncTree_.applyServerMerge(i,h)}else{var u=Ee(e);o=this.serverSyncTree_.applyServerOverwrite(i,u)}var l=i;0<o.length&&(l=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(l,o)},t.prototype.interceptServerData_=t.prototype.onConnectStatus_=t.prototype.onServerInfoUpdate_=t.prototype.updateInfo_=t.prototype.getNextWriteId_=t.prototype.setWithPriority=t.prototype.update=function(o,t,s){var a=this;this.log_("update",{path:o.toString(),value:t});var r=!0,i=this.generateServerValues(),h={};if(w(t,,r)J("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(s,"ok");else{var u=this.getNextWriteId_(),e=this.serverSyncTree_.applyUserMerge(o,h,u);this.eventQueue_.queueEvents(e),this.server_.merge(o.toString(),t,function(t,e){var n="ok"===t;n||nt("update at "+o+" failed: "+t);var r=a.serverSyncTree_.ackUserWrite(u,!n),i=0<r.length?a.rerunTransactions_(o):o;a.eventQueue_.raiseEventsForChangedPath(i,r),a.callOnCompleteCallback(s,t,e)}),w(t,,this.eventQueue_.raiseEventsForChangedPath(o,[])}},t.prototype.runOnDisconnectEvents_=function(){var r=this;this.log_("onDisconnectEvents");var t,n,i,e=this.generateServerValues(),o=(t=this.onDisconnect_,n=e,i=new Fe,t.forEachTree(new vt(""),,i),s=[];o.forEachTree(vt.Empty,,this.onDisconnect_=new Fe,this.eventQueue_.raiseEventsForChangedPath(vt.Empty,s)},t.prototype.onDisconnectCancel=t.prototype.onDisconnectSet=t.prototype.onDisconnectSetWithPriority=t.prototype.onDisconnectUpdate=function(r,n,i){var o=this;if(S(n))return J("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(i,"ok");this.server_.onDisconnectMerge(r.toString(),n,},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(Pn)},t.prototype.resume=t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;e=t?(this.statsListener_||(this.statsListener_=new pn(this.stats_)),this.statsListener_.get()):this.stats_.get();var r=Object.keys(e).reduce(0);w(e,}},t.prototype.statsIncrementCounter=t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),J.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=Object.defineProperty(t.prototype,"database",{get:enumerable:!0,configurable:!0}),t}(),On=),kn=function(){eturn t.prototype.updateChild=t.prototype.updateFullNode=t.prototype.updatePriority=t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var s=this.index_.getCompare();o=function(t,e){return s(e,t)}}else o=this.index_.getCompare();var a=t;C(a.numChildren()==this.limit_,"");var h=new zt(e,n),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(h);if(a.hasChild(e)){for(var c=a.getImmediateChild(e),p=r.getChildAfterChild(this.index_,u,this.reverse_);null!=p&&(p.name==e||a.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:o(p,h);if(l&&!n.isEmpty()&&0<=d)return null!=i&&i.trackChildChange(Ye.childChangedChange(e,n,c)),a.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Ye.childRemovedChange(e,c));var f=a.updateImmediateChild(e,ge.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(Ye.childAddedChange(p.name,p.node)),f.updateImmediateChild(p.name,p.node)):f}return n.isEmpty()?t:l&&0<=o(u,h)?(null!=i&&(i.trackChildChange(Ye.childRemovedChange(u.name,u.node)),i.trackChildChange(Ye.childAddedChange(e,n))),a.updateImmediateChild(e,n).updateImmediateChild(u.name,ge.EMPTY_NODE)):t},t}(),xn=function(){eturn r.prototype.hasStart=function(){return this.startSet_},r.prototype.isViewFromLeft=r.prototype.getIndexStartValue=function(){return C(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},r.prototype.getIndexStartName=function(){return C(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:it},r.prototype.hasEnd=function(){return this.endSet_},r.prototype.getIndexEndValue=function(){return C(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},r.prototype.getIndexEndName=r.prototype.hasLimit=function(){return this.limitSet_},r.prototype.hasAnchoredLimit=r.prototype.getLimit=r.prototype.getIndex=function(){return this.index_},r.prototype.copy_=r.prototype.limit=r.prototype.limitToFirst=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_=r.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,e},r.prototype.limitToLast=r.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,n.indexStartName_=null!=e?(n.startNameSet_=!0,e):(n.startNameSet_=!1,""),n},r.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,n.indexEndName_=void 0!==e?(n.endNameSet_=!0,e):(n.endNameSet_=!1,""),n},r.prototype.orderBy=r.prototype.getQueryObject=r.prototype.loadsAllData=r.prototype.isDefault=r.prototype.getNodeFilter=r.prototype.toRestQueryStringParameters=r.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},r.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},r.DEFAULT=new r,r}(),Fn=function(n){eturn s(o,n),o.prototype.getKey=o.prototype.child=function(t){var e,n,r,i;return D("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof vt||(null===this.path.getFront()?(e="Reference.child",i=!(n=1),(r=t)&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),Vt(e,n,r,i)):Vt("Reference.child",1,t,!1)),new o(this.repo,this.path.child(t))},o.prototype.getParent=o.prototype.getRoot=o.prototype.databaseProp=function(){return this.repo.database},o.prototype.set=o.prototype.update=function(t,e){if(D("Reference.update",1,2,arguments.length),Ht("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,nt("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Wt("Reference.update",1,t,this.path,!1),k("Reference.update",2,e,!0);var i=new l;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},o.prototype.setWithPriority=o.prototype.remove=o.prototype.transaction=function(t,r,e){if(D("Reference.transaction",1,3,arguments.length),Ht("Reference.transaction",this.path),k("Reference.transaction",1,t,!1),k("Reference.transaction",2,r,!0),"Reference.transaction",3,e,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===e&&(e=!0);var i=new l;"function"==typeof r&&i.promise.catch(function(){});return this.repo.startTransaction(this.path,t,e),i.promise},o.prototype.setPriority=o.prototype.push=function(t,e){D("Reference.push",0,2,arguments.length),Ht("Reference.push",this.path),Lt("Reference.push",1,t,this.path,!0),k("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=Yt(r),o=this.child(i),s=this.child(i);return n=null!=t?o.set(t,e).then(function(){return s}):Promise.resolve(s),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),o},o.prototype.onDisconnect=Object.defineProperty(o.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),o}(ke);ke.__referenceConstructor=Fn,nn.__referenceConstructor=Fn;var An,Ln,Mn=Wn=function(){eturn i.prototype.subTree=function(t){for(var e,n=t instanceof vt?t:new vt(t),r=this;null!==(e=n.getFront());){r=new i(e,r,m(r.node_.children,e)||new Mn),n=n.popFront()}return r},i.prototype.getValue=function(){return this.node_.value},i.prototype.setValue=i.prototype.clear=i.prototype.hasChildren=function(){return 0<this.node_.childCount},i.prototype.isEmpty=i.prototype.forEachChild=i.prototype.forEachDescendant=i.prototype.forEachAncestor=i.prototype.forEachImmediateDescendantWithValue=i.prototype.path=i.prototype.name=function(){return this.name_},i.prototype.parent=function(){return this.parent_},i.prototype.updateParents_=i.prototype.updateChild_=i}();(Ln=An||(An={}))[Ln.RUN=0]="RUN",Ln[Ln.SENT=1]="SENT",Ln[Ln.COMPLETED=2]="COMPLETED",Ln[Ln.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",Ln[Ln.NEEDS_ABORT=4]="NEEDS_ABORT",Dn.MAX_TRANSACTION_RETRIES_=25,Dn.prototype.transactions_init_=Dn.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},o=new Fn(this,t);o.on("value",i);var s={path:t,update:e,onComplete:n,status:null,order:K(),applyLocally:r,retryCount:0,unwatcher:abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=this.getLatestState_(t);s.currentInputSnapshot=a;var h=s.update(a.val());if(void 0===h){if(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete){var u=new Ne(s.currentInputSnapshot,new Fn(this,s.path),se);s.onComplete(null,!1,u)}}else{Mt("transaction failed: Data returned ",h,s.path),s.status=An.RUN;var l=this.transactionQueueTree_.subTree(t),c=l.getValue()||[];c.push(s),l.setValue(c);var p=void 0;if("object"==typeof h&&null!==h&&E(h,".priority"))p=m(h,".priority"),C(At(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else p=(this.serverSyncTree_.calcCompleteEventCache(t)||ge.EMPTY_NODE).getPriority().val();p=p;var d=this.generateServerValues(),f=Ee(h,p),_=Le(f,d);s.currentOutputSnapshotRaw=f,s.currentOutputSnapshotResolved=_,s.currentWriteId=this.getNextWriteId_();var y=this.serverSyncTree_.applyUserOverwrite(t,_,s.currentWriteId,s.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,y),this.sendReadyTransactions_()}},Dn.prototype.getLatestState_=Dn.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);C(0<n.length,"Sending zero length transaction queue"),n.every(function(t){return t.status===An.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},Dn.prototype.sendTransactionQueue_=function(a,h){for(var u=this,t=h.map(function(t){return t.currentWriteId}),e=this.getLatestState_(a,t),n=e,r=e.hash(),i=0;i<h.length;i++){var o=h[i];C(o.status===An.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),o.status=An.SENT,o.retryCount++;var s=vt.relativePath(a,o.path);n=n.updateChild(s,o.currentOutputSnapshotRaw)}var l=n.val(!0),c=a;this.server_.put(c.toString(),l,r)},Dn.prototype.rerunTransactions_=Dn.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,r=[],i=[],o=t.filter(.map(function(t){return t.currentWriteId}),s=0;s<t.length;s++){var a=t[s],h=vt.relativePath(e,a.path),u=!1,l=void 0;if(C(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===An.NEEDS_ABORT)u=!0,l=a.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else if(a.status===An.RUN)if(a.retryCount>=Dn.MAX_TRANSACTION_RETRIES_)u=!0,l="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else{var c=this.getLatestState_(a.path,o);a.currentInputSnapshot=c;var p=t[s].update(c.val());if(void 0!==p){Mt("transaction failed: Data returned ",p,a.path);var d=Ee(p);"object"==typeof p&&null!=p&&E(p,".priority")||(d=d.updatePriority(c.getPriority()));var f=a.currentWriteId,_=this.generateServerValues(),y=Le(d,_);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=y,a.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(f),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(a.path,y,a.currentWriteId,a.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(f,!0))}else u=!0,l="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,i),i=[],u&&(t[s].status=An.COMPLETED,n=t[s].unwatcher,setTimeout(n,Math.floor(0)),t[s].onComplete))if("nodata"===l){var v=new Fn(this,t[s].path),g=t[s].currentInputSnapshot,m=new Ne(g,v,se);r.push(t[s].onComplete.bind(null,null,!1,m))}else r.push(t[s].onComplete.bind(null,new Error(l),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(s=0;s<r.length;s++)_t(r[s]);this.sendReadyTransactions_()}},Dn.prototype.getAncestorTransactionNode_=Dn.prototype.buildTransactionQueue_=Dn.prototype.aggregateTransactionQueuesForNode_=Dn.prototype.pruneCompletedTransactionsBelowNode_=Dn.prototype.abortTransactions_=Dn.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)if(e[o].status===An.SENT_NEEDS_ABORT);else if(e[o].status===An.SENT)C(i===o-1,"All SENT items should be at beginning of queue."),e[i=o].status=An.SENT_NEEDS_ABORT,e[o].abortReason="set";else if(C(e[o].status===An.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete){n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))}-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r);for(o=0;o<n.length;o++)_t(n[o])}};var qn,Qn="databaseURL",Un=function(){eturn t.getInstance=t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=t.prototype.databaseFromApp=function(t,e){var n=e||t.options[Qn];void 0===n&&et("Can't determine Firebase Database URL.  Be sure to include "+Qn+" option when calling firebase.initializeApp().");var r=Rt(n),i=r.repoInfo;return Bt("Invalid Firebase Database URL",1,r),r.path.isEmpty()||et("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,t).database},t.prototype.deleteRepo=t.prototype.createRepo=function(t,e){var n=m(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var r=m(n,t.toURLString());return r&&et("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Dn(t,this.useRestClient_,e),n[t.toURLString()]=r},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),Vn=function(){function t(t){(this.repo_=t)instanceof Dn||et("Don't call new Database() directly - please use firebase.database()."),this.root_=new Fn(t,vt.Empty),this.INTERNAL=new Hn(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=t.prototype.refFromURL=t.prototype.checkDeleted_=t.prototype.goOffline=function(){D("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}(),Hn=function(){function t(t){this.database=t}return t.prototype.delete=function(){return o=this,h=new((a=s=void 0)||(a=Promise))(;var o,s,a,h},t}(),Bn=Object.freeze({forceLongPolling:forceWebSockets:function(){Cn.forceDisallow()},isWebSocketsAvailable:setSecurityDebugCallback:stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:),jn=Nn;Nn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Nn.prototype.echo=var Kn=Tn,Yn=wt,zn=Object.freeze({DataConnection:jn,RealTimeConnection:Kn,hijackHash:ConnectionTarget:Yn,queryIdentifier:function(t){return t.queryIdentifier()},listens:forceRestClient:),Gn=Vn.ServerValue;Xn.INTERNAL.registerService("database",{Reference:Fn,Query:ke,Database:Vn,DataSnapshot:Ne,enableLogging:$,INTERNAL:Bn,ServerValue:Gn,TEST_ACCESS:zn},null,!0)}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-database - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-database.js.map
