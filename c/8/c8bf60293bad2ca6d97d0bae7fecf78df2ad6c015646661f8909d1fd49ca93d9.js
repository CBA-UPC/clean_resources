(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8129],{45938:function(e,t){var n,r,o;r=[t,e],void 0===(o="function"===typeof(n=?n.apply(t,r):n)||(e.exports=o)},43781:function(e,t,n){"use strict";n.r(t);var r=n(1717),o=n(6952),s=n(88742),i=n.n(s),c=n(60042),a=n.n(c),l=n(27378),d=n(45938),u=n.n(d),f=n(78392),p=n(2251),m=n(1305),v=n(37182),b=n(62882),h=n(4550),j=n(47086),g=n(36077),w=n(5273),O=n(81817),x=n(24246);.default=function(e){var t=e.poll,n=e.className,s=(0,l.useState)(null),c=s[0],d=s[1],P=(0,l.useState)(t),E=P[0],_=P[1],N=E.title,T=E.objectId,C=E.id,S=E.options,k=E.generatedAt,I=E.modifiedAt,D=0;S.forEach((),(0,f.Z)((function(){var e,t=null===(e=(0,v.Vy)(b.dm.POLL_ANSWERS,[]))||void 0===e?void 0:e.find(();t&&d(parseInt(t.split(":")[1],10)),(new Date).getTime()-new Date(k).getTime()>6e4?(new Date).getTime()-new Date(I).getTime()<1728e5&&(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.UN)();case 2:return t=e.sent,e.t0=_,e.next=6,t.getPollInfo({pollId:T,latest:!0});case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})))():t&&(0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.UN)();case 2:return t=e.sent,e.t0=_,e.next=6,t.getPollInfo({pollId:T,latest:!0});case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})))()}));var M=function(e){if(c)return null;var t="".concat(h.Z.global.submitBaseUrl,"/ci/content/submit/poll/poll_v2.json?object_id=").concat(T,"&content_id=").concat(C,"&vote=1&poll_id=").concat(e.id,"&mode=POSITIVE");u()(t,{timeout:3e3}).then(().then((function(t){(0,v.eW)(b.dm.POLL_ANSWERS,"".concat(T,":").concat(e.id)),d(e.id),_((function(e){var n={},e),o={};return n.options.forEach((),t.vote.forEach((function(e){o[e.optionId]&&(o[e.optionId].votes=e.count)})),n}))}))};return(0,x.jsxs)("div",{className:a()("ds-bg-fill-content-alternate ds-p-3",n),children:[(0,x.jsxs)("div",{className:"ds-flex ds-items-center ds-justify-between",children:[(0,x.jsxs)("div",{className:"ds-flex",children:[(0,x.jsx)(g.ZP,{name:p.v.POLL_OUTLINE,size:O.XR.SM}),(0,x.jsx)(w.Z,{variant:O.Fu.TITLE_SUBTLE_M,className:"ds-ml-1",children:N})]}),(0,x.jsxs)(w.Z,{variant:O.Fu.COMPACT_XS,className:"ds-text-typo-mid3",children:[D>=1e3?"".concat((D/1e3).toFixed(1),"K"):D," votes"]})]}),(0,x.jsx)("div",{className:a()("ds-grid ds-gap-1 ds-mt-4 ds-grid-cols-1",S.length>3?"lg:ds-grid-cols-1":"lg:ds-grid-cols-3"),children:S.map((function(e,t){var n=D>0?(0,m.Ux)(e.votes,D).toFixed(1):0;return(0,x.jsxs)("div",{className:a()("ds-bg-ui-fill ds-border ds-border-line ds-rounded-lg ds-p-2 ds-relative ds-flex ds-justify-between ds-items-center",{"ds-cursor-pointer":!c}),onClick:children:[(0,x.jsx)("div",{className:"ds-bg-raw-blue/20 ds-absolute ds-left-0 ds-top-0 ds-h-full ds-rounded-lg ds-transition-all",style:{width:c?"".concat(n,"%"):0}}),(0,x.jsx)(w.Z,{element:"div",variant:O.Fu.COMPACT_XS_MEDIUM,children:e.title}),c?(0,x.jsxs)(w.Z,{element:"div",variant:O.Fu.COMPACT_XS_MEDIUM,children:[c===e.id?"You & ":""," ",n,"%"]}):null]},t)}))})]})}}}]);